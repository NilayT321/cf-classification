2037G "Natlan Exploring" "combinatorics,dp,math,number theory" "You are exploring the stunning region of Natlan! This region consists of n cities, and each city is rated with an attractiveness ai. A directed edge exists from City i to City j if and only if i<j and gcd(ai,aj)\xe2\x89\xa01, where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y.Starting from City 1, your task is to determine the total number of distinct paths you can take to reach City n, modulo 998244353. Two paths are different if and only if the set of cities visited is different." -999
2037F "Ardent Flames" "binary search,data structures,sortings,two pointers" "You have obtained the new limited event character Xilonen. You decide to use her in combat.There are n enemies in a line. The i\'th enemy from the left has health hi and is currently at position xi. Xilonen has an attack damage of m, and you are ready to defeat the enemies with her.Xilonen has a powerful ""ground stomp"" attack. Before you perform any attacks, you select an integer p and position Xilonen there (p can be any integer position, including a position with an enemy currently). Afterwards, for each attack, she deals m damage to an enemy at position p (if there are any), m\xe2\x88\x921 damage to enemies at positions p\xe2\x88\x921 and p+1, m\xe2\x88\x922 damage to enemies at positions p\xe2\x88\x922 and p+2, and so on. Enemies that are at least a distance of m away from Xilonen take no damage from attacks.Formally, if there is an enemy at position x, she will deal max(0,m\xe2\x88\x92|p\xe2\x88\x92x|) damage to that enemy each hit. Note that you may not choose a different p for different attacks. Over all possible p, output the minimum number of attacks Xilonen must perform to defeat at least k enemies. If it is impossible to find a p such that eventually at least k enemies will be defeated, output \xe2\x88\x921 instead. Note that an enemy is considered to be defeated if its health reaches 0 or below." -999
2037E "Kachina\'s Favorite Binary String" "greedy,interactive,two pointers" "This is an interactive problem.Kachina challenges you to guess her favorite binary string\xe2\x88\x97 s of length n. She defines f(l,r) as the number of subsequences\xe2\x80\xa0 of 01 in slsl+1\xe2\x80\xa6sr. Two subsequences are considered different if they are formed by deleting characters from different positions in the original string, even if the resulting subsequences consist of the same characters.To determine s, you can ask her some questions. In each question, you can choose two indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n) and ask her for the value of f(l,r).Determine and output s after asking Kachina no more than n questions. However, it may be the case that s is impossible to be determined. In this case, you would need to report IMPOSSIBLE instead.Formally, s is impossible to be determined if after asking n questions, there are always multiple possible strings for s, regardless of what questions are asked. Note that if you report IMPOSSIBLE when there exists a sequence of at most n queries that will uniquely determine the binary string, you will get the Wrong Answer verdict.\xe2\x88\x97A binary string only contains characters 0 and 1.\xe2\x80\xa0A sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) elements. For example, subsequences of 1011101 are 0, 1, 11111, 0111, but not 000 nor 11100." -999
2037D "Sharky Surfing" "data structures,greedy,two pointers" "Mualani loves surfing on her sharky surfboard!Mualani\'s surf path can be modeled by a number line. She starts at position 1, and the path ends at position L. When she is at position x with a jump power of k, she can jump to any integer position in the interval [x,x+k]. Initially, her jump power is 1. However, her surf path isn\'t completely smooth. There are n hurdles on her path. Each hurdle is represented by an interval [l,r], meaning she cannot jump to any position in the interval [l,r]. There are also m power-ups at certain positions on the path. Power-up i is located at position xi and has a value of vi. When Mualani is at position xi, she has the option to collect the power-up to increase her jump power by vi. There may be multiple power-ups at the same position. When she is at a position with some power-ups, she may choose to take or ignore each individual power-up. No power-up is in the interval of any hurdle.What is the minimum number of power-ups she must collect to reach position L to finish the path? If it is not possible to finish the surf path, output \xe2\x88\x921." -999
2037C "Superultra\'s Favorite Permutation" "constructive algorithms,greedy,math,number theory" "Superultra, a little red panda, desperately wants primogems. In his dreams, a voice tells him that he must solve the following task to obtain a lifetime supply of primogems. Help Superultra!Construct a permutation\xe2\x88\x97 p of length n such that pi+pi+1 is composite\xe2\x80\xa0 over all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. If it\'s not possible, output \xe2\x88\x921.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).\xe2\x80\xa0An integer x is composite if it has at least one other divisor besides 1 and x. For example, 4 is composite because 2 is a divisor." -999
2037B "Intercepted Inputs" "brute force,implementation" "To help you prepare for your upcoming Codeforces contest, Citlali set a grid problem and is trying to give you a n by m grid through your input stream. Specifically, your input stream should contain the following:  The first line contains two integers n and m \xe2\x80\x94 the dimensions of the grid.  The following n lines contain m integers each \xe2\x80\x94 the values of the grid. However, someone has intercepted your input stream, shuffled all given integers, and put them all on one line! Now, there are k integers all on one line, and you don\'t know where each integer originally belongs. Instead of asking Citlali to resend the input, you decide to determine the values of n and m yourself.Output any possible value of n and m that Citlali could have provided." -999
2037A Twice implementation "Kinich wakes up to the start of a new day. He turns on his phone, checks his mailbox, and finds a mysterious present. He decides to unbox the present.Kinich unboxes an array a with n integers. Initially, Kinich\'s score is 0. He will perform the following operation any number of times:  Select two indices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) such that neither i nor j has been chosen in any previous operation and ai=aj. Then, add 1 to his score. Output the maximum score Kinich can achieve after performing the aforementioned operation any number of times." -999
2036G "Library of Magic" "binary search,constructive algorithms,divide and conquer,interactive,math,number theory" "This is an interactive problem.The Department of Supernatural Phenomena at the Oxenfurt Academy has opened the Library of Magic, which contains the works of the greatest sorcerers of Redania \xe2\x80\x94 n (3\xe2\x89\xa4n\xe2\x89\xa41018) types of books, numbered from 1 to n. Each book\'s type number is indicated on its spine. Moreover, each type of book is stored in the library in exactly two copies! And you have been appointed as the librarian.One night, you wake up to a strange noise and see a creature leaving the building through a window. Three thick tomes of different colors were sticking out of the mysterious thief\'s backpack. Before you start searching for them, you decide to compute the numbers a, b, and c written on the spines of these books. All three numbers are distinct.So, you have an unordered set of tomes, which includes one tome with each of the pairwise distinct numbers a, b, and c, and two tomes for all numbers from 1 to n, except for a, b, and c. You want to find these values a, b, and c.Since you are not working in a simple library, but in the Library of Magic, you can only use one spell in the form of a query to check the presence of books in their place:   ""xor l r"" \xe2\x80\x94 Bitwise XOR query with parameters l and r. Let k be the number of such tomes in the library whose numbers are greater than or equal to l and less than or equal to r. You will receive the result of the computation v1\xe2\x8a\x95v2\xe2\x8a\x95...\xe2\x8a\x95vk, where v1...vk are the numbers on the spines of these tomes, and \xe2\x8a\x95 denotes the operation of bitwise exclusive OR. Since your magical abilities as a librarian are severely limited, you can make no more than 150 queries." 2200
2036F "XORificator 3000" "bitmasks,dp,number theory,two pointers" "Alice has been giving gifts to Bob for many years, and she knows that what he enjoys the most is performing bitwise XOR of interesting integers. Bob considers a positive integer x to be interesting if it satisfies x\xe2\x89\xa2k(mod2i). Therefore, this year for his birthday, she gifted him a super-powerful ""XORificator 3000"", the latest model.Bob was very pleased with the gift, as it allowed him to instantly compute the XOR of all interesting integers in any range from l to r, inclusive. After all, what else does a person need for happiness? Unfortunately, the device was so powerful that at one point it performed XOR with itself and disappeared. Bob was very upset, and to cheer him up, Alice asked you to write your version of the ""XORificator""." 1900
2036E "Reverse the Rivers" "binary search,constructive algorithms,data structures,greedy" "A conspiracy of ancient sages, who decided to redirect rivers for their own convenience, has put the world on the brink. But before implementing their grand plan, they decided to carefully think through their strategy \xe2\x80\x94 that\'s what sages do.There are n countries, each with exactly k regions. For the j-th region of the i-th country, they calculated the value ai,j, which reflects the amount of water in it.The sages intend to create channels between the j-th region of the i-th country and the j-th region of the (i+1)-th country for all 1\xe2\x89\xa4i\xe2\x89\xa4(n\xe2\x88\x921) and for all 1\xe2\x89\xa4j\xe2\x89\xa4k. Since all n countries are on a large slope, water flows towards the country with the highest number. According to the sages\' predictions, after the channel system is created, the new value of the j-th region of the i-th country will be bi,j=a1,j|a2,j|...|ai,j, where | denotes the bitwise ""OR"" operation.After the redistribution of water, the sages aim to choose the most suitable country for living, so they will send you q queries for consideration.Each query will contain m requirements. Each requirement contains three parameters: the region number r, the sign o (either ""<"" or "">""), and the value c. If o = ""<"", then in the r-th region of the country you choose, the new value must be strictly less than the limit c, and if o = "">"", it must be strictly greater.In other words, the chosen country i must satisfy all m requirements. If in the current requirement o = ""<"", then it must hold that bi,r<c, and if o = "">"", then bi,r>c.In response to each query, you should output a single integer \xe2\x80\x94 the number of the suitable country. If there are multiple such countries, output the smallest one. If no such country exists, output \xe2\x88\x921." 1600
2036D "I Love 1543" "brute force,implementation,matrices" "One morning, Polycarp woke up and realized that 1543 is the most favorite number in his life.The first thing that Polycarp saw that day as soon as he opened his eyes was a large wall carpet of size n by m cells; n and m are even integers. Each cell contains one of the digits from 0 to 9.Polycarp became curious about how many times the number 1543 would appear in all layers\xe2\x88\x97 of the carpet when traversed clockwise.\xe2\x88\x97The first layer of a carpet of size n\xc3\x97m is defined as a closed strip of length 2\xe2\x8b\x85(n+m\xe2\x88\x922) and thickness of 1 element, surrounding its outer part. Each subsequent layer is defined as the first layer of the carpet obtained by removing all previous layers from the original carpet." 1300
2036C "Anya and 1100" "brute force,implementation" "While rummaging through things in a distant drawer, Anya found a beautiful string s consisting only of zeros and ones.Now she wants to make it even more beautiful by performing q operations on it.Each operation is described by two integers i (1\xe2\x89\xa4i\xe2\x89\xa4|s|) and v (v\xe2\x88\x88{0,1}) and means that the i-th character of the string is assigned the value v (that is, the assignment si=v is performed).But Anya loves the number 1100, so after each query, she asks you to tell her whether the substring ""1100"" is present in her string (i.e. there exist such 1\xe2\x89\xa4i\xe2\x89\xa4|s|\xe2\x88\x923 that sisi+1si+2si+3=1100)." 1100
2036B Startup greedy,sortings "Arseniy came up with another business plan \xe2\x80\x94 to sell soda from a vending machine! For this, he purchased a machine with n shelves, as well as k bottles, where the i-th bottle is characterized by the brand index bi and the cost ci. You can place any number of bottles on each shelf, but all bottles on the same shelf must be of the same brand.Arseniy knows that all the bottles he puts on the shelves of the machine will be sold. Therefore, he asked you to calculate the maximum amount he can earn." 800
2036A Quintomania implementation "Boris Notkin composes melodies. He represents them as a sequence of notes, where each note is encoded as an integer from 0 to 127 inclusive. The interval between two notes a and b is equal to |a\xe2\x88\x92b| semitones.Boris considers a melody perfect if the interval between each two adjacent notes is either 5 semitones or 7 semitones.After composing his latest melodies, he enthusiastically shows you his collection of works. Help Boris Notkin understand whether his melodies are perfect." 800
2035H "Peak Productivity Forces" "constructive algorithms" "I\'m peakly productive and this is deep.You are given two permutations\xe2\x88\x97 a and b, both of length n.You can perform the following three-step operation on permutation a:  Choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n). Cyclic shift a1,a2,\xe2\x80\xa6,ai\xe2\x88\x921 by 1 to the right. If you had chosen i=1, then this range doesn\'t exist, and you cyclic shift nothing. Cyclic shift ai+1,ai+2,\xe2\x80\xa6,an by 1 to the right. If you had chosen i=n, then this range doesn\'t exist, and you cyclic shift nothing.After the operation, a1,a2,\xe2\x80\xa6,ai\xe2\x88\x922,ai\xe2\x88\x921,ai,ai+1,ai+2,\xe2\x80\xa6,an\xe2\x88\x921,an is transformed into ai\xe2\x88\x921,a1,\xe2\x80\xa6,ai\xe2\x88\x923,ai\xe2\x88\x922,ai,an,ai+1,\xe2\x80\xa6,an\xe2\x88\x922,an\xe2\x88\x921.Here are some examples of operations done on the identity permutation [1,2,3,4,5,6,7] of length 7:   If we choose i=3, it will become [2,1,3,7,4,5,6].  If we choose i=1, it will become [1,7,2,3,4,5,6].  If we choose i=7, it will become [6,1,2,3,4,5,7].  Notably, position i is not shifted. Find a construction using at most 2n operations to make a equal to b or print \xe2\x88\x921 if it is impossible. The number of operations does not need to be minimized. It can be shown that if it is possible to make a equal to b, it is possible to do this within 2n operations. \xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 3500
2035G2 "Go Learn! (Hard Version)" "divide and conquer,dp" "The differences between the easy and hard versions are the constraints on n and the sum of n. In this version, n\xe2\x89\xa43\xe2\x8b\x85105 and the sum of n does not exceed 106. You can only make hacks if both versions are solved. Well, well, well, let\'s see how Bessie is managing her finances. She seems to be in the trenches! Fortunately, she is applying for a job at Moogle to resolve this issue. Moogle interviews require intensive knowledge of obscure algorithms and complex data structures, but Bessie received a tip-off from an LGM on exactly what she has to go learn.Bessie wrote the following code to binary search for a certain element k in a possibly unsorted array [a1,a2,\xe2\x80\xa6,an] with n elements.let l = 1let h = nwhile l < h:  let m = floor((l + h) / 2)  if a[m] < k:    l = m + 1  else:    h = mreturn lBessie submitted her code to Farmer John\'s problem with m (1\xe2\x89\xa4m\xe2\x89\xa4n) tests. The i-th test is of the form (xi,ki) (1\xe2\x89\xa4x,k\xe2\x89\xa4n). It is guaranteed all the xi are distinct and all the ki are distinct.Test i is correct if the following hold:  The xi-th element in the array is ki.  If Bessie calls the binary search as shown in the above code for ki, it will return xi. It might not be possible for all m tests to be correct on the same array, so Farmer John will remove some of them so Bessie can AC. Let r be the minimum of tests removed so that there exists an array [a1,a2,\xe2\x80\xa6,an] with 1\xe2\x89\xa4ai\xe2\x89\xa4n so that all remaining tests are correct. In addition to finding r, Farmer John wants you to count the number of arrays [a1,a2,\xe2\x80\xa6,an] with 1\xe2\x89\xa4ai\xe2\x89\xa4n such that there exists a way to remove exactly r tests so that all the remaining tests are correct. Since this number may be very large, please find it modulo 998244353." 3500
2035G1 "Go Learn! (Easy Version)" dp,trees "The differences between the easy and hard versions are the constraints on n and the sum of n. In this version, n\xe2\x89\xa43000 and the sum of n does not exceed 104. You can only make hacks if both versions are solved. Well, well, well, let\'s see how Bessie is managing her finances. She seems to be in the trenches! Fortunately, she is applying for a job at Moogle to resolve this issue. Moogle interviews require intensive knowledge of obscure algorithms and complex data structures, but Bessie received a tip-off from an LGM on exactly what she has to go learn.Bessie wrote the following code to binary search for a certain element k in a possibly unsorted array [a1,a2,\xe2\x80\xa6,an] with n elements.let l = 1let h = nwhile l < h:  let m = floor((l + h) / 2)  if a[m] < k:    l = m + 1  else:    h = mreturn lBessie submitted her code to Farmer John\'s problem with m (1\xe2\x89\xa4m\xe2\x89\xa4n) tests. The i-th test is of the form (xi,ki) (1\xe2\x89\xa4x,k\xe2\x89\xa4n). It is guaranteed all the xi are distinct and all the ki are distinct.Test i is correct if the following hold:  The xi-th element in the array is ki.  If Bessie calls the binary search as shown in the above code for ki, it will return xi. It might not be possible for all m tests to be correct on the same array, so Farmer John will remove some of them so Bessie can AC. Let r be the minimum of tests removed so that there exists an array [a1,a2,\xe2\x80\xa6,an] with 1\xe2\x89\xa4ai\xe2\x89\xa4n so that all remaining tests are correct. In addition to finding r, Farmer John wants you to count the number of arrays [a1,a2,\xe2\x80\xa6,an] with 1\xe2\x89\xa4ai\xe2\x89\xa4n such that there exists a way to remove exactly r tests so that all the remaining tests are correct. Since this number may be very large, please find it modulo 998244353." 3300
2035F "Tree Operations" "binary search,brute force,dfs and similar,dp,trees" "This really says a lot about our society.One day, a turtle gives you a tree with n nodes rooted at node x. Each node has an initial nonnegative value; the i-th node has starting value ai.You want to make the values of all nodes equal to 0. To do so, you will perform a series of operations on the tree, where each operation will be performed on a certain node. Define an operation on node u as choosing a single node in u\'s subtree\xe2\x88\x97 and incrementing or decrementing its value by 1. The order in which operations are performed on nodes is as follows:  For 1\xe2\x89\xa4i\xe2\x89\xa4n, the i-th operation will be performed on node i.  For i>n, the i-th operation will be performed on the same node as operation i\xe2\x88\x92n. More formally, the i-th operation will be performed on the (((i\xe2\x88\x921)modn)+1)-th node.\xe2\x80\xa0Note that you cannot skip over operations; that is, you cannot perform the i-th operation without first performing operations 1,2,\xe2\x80\xa6,i\xe2\x88\x921.Find the minimum number of operations you must perform before you can make the values of all nodes equal to 0, assuming you pick operations optimally. If it\'s impossible to make the values of all nodes equal to 0 after finite operations, output \xe2\x88\x921.\xe2\x88\x97The subtree of a node u is the set of nodes for which u lies on the shortest path from this node to the root, including u itself.\xe2\x80\xa0Here, amodb denotes the remainder from dividing a by b." 2500
2035E Monster "binary search,brute force,constructive algorithms,greedy,implementation,math,ternary search" "Man, this Genshin boss is so hard. Good thing they have a top-up of 6 coins for only $4.99. I should be careful and spend no more than I need to, lest my mom catches me...You are fighting a monster with z health using a weapon with d damage. Initially, d=0. You can perform the following operations.  Increase d \xe2\x80\x94 the damage of your weapon by 1, costing x coins.  Attack the monster, dealing d damage and costing y coins. You cannot perform the first operation for more than k times in a row.Find the minimum number of coins needed to defeat the monster by dealing at least z damage." 2300
2035D "Yet Another Real Number Problem" "binary search,data structures,divide and conquer,greedy,implementation,math" "Three r there are\'s in strawberry.You are given an array b of length m. You can perform the following operation any number of times (possibly zero):   Choose two distinct indices i and j where 1\xe2\x89\xa4i<j\xe2\x89\xa4m and bi is even, divide bi by 2 and multiply bj by 2.  Your task is to maximize the sum of the array after performing any number of such operations. Since it could be large, output this sum modulo 109+7.Since this problem is too easy, you are given an array a of length n and need to solve the problem for each prefix of a.In other words, denoting the maximum sum of b after performing any number of such operations as f(b), you need to output f([a1]), f([a1,a2]), \xe2\x80\xa6, f([a1,a2,\xe2\x80\xa6,an]) modulo 109+7 respectively." 1800
2035C "Alya and Permutation" "bitmasks,constructive algorithms,math" "Alya has been given a hard problem. Unfortunately, she is too busy running for student council. Please solve this problem for her.Given an integer n, construct a permutation p of integers 1,2,\xe2\x80\xa6,n that maximizes the value of k (which is initially 0) after the following process.Perform n operations, on the i-th operation (i=1,2,\xe2\x80\xa6,n),  If i is odd, k=k&pi, where & denotes the bitwise AND operation.  If i is even, k=k|pi, where | denotes the bitwise OR operation." 1400
2035B "Everyone Loves Tres" "constructive algorithms,greedy,math,number theory" "There are 3 heroes and 3 villains, so 6 people in total.Given a positive integer n. Find the smallest integer whose decimal representation has length n and consists only of 3s and 6s such that it is divisible by both 33 and 66. If no such integer exists, print \xe2\x88\x921." 900
2035A Sliding implementation,math "Red was ejected. They were not the imposter.There are n rows of m people. Let the position in the r-th row and the c-th column be denoted by (r,c). Number each person starting from 1 in row-major order, i.e., the person numbered (r\xe2\x88\x921)\xe2\x8b\x85m+c is initially at (r,c).The person at (r,c) decides to leave. To fill the gap, let the person who left be numbered i. Each person numbered j>i will move to the position where the person numbered j\xe2\x88\x921 is initially at. The following diagram illustrates the case where n=2, m=3, r=1, and c=2.   Calculate the sum of the Manhattan distances of each person\'s movement. If a person was initially at (r0,c0) and then moved to (r1,c1), the Manhattan distance is |r0\xe2\x88\x92r1|+|c0\xe2\x88\x92c1|." 800
2033G "Sakurako and Chefir" "data structures,dfs and similar,dp,greedy,trees" "Given a tree with n vertices rooted at vertex 1. While walking through it with her cat Chefir, Sakurako got distracted, and Chefir ran away.To help Sakurako, Kosuke recorded his q guesses. In the i-th guess, he assumes that Chefir got lost at vertex vi and had ki stamina.Also, for each guess, Kosuke assumes that Chefir could move along the edges an arbitrary number of times:  from vertex a to vertex b, if a is an ancestor\xe2\x88\x97 of b, the stamina will not change;  from vertex a to vertex b, if a is not an ancestor of b, then Chefir\'s stamina decreases by 1. If Chefir\'s stamina is 0, he cannot make a move of the second type.For each assumption, your task is to find the distance to the farthest vertex that Chefir could reach from vertex vi, having ki stamina.\xe2\x88\x97Vertex a is an ancestor of vertex b if the shortest path from b to the root passes through a." 2200
2033F "Kosuke\'s Sloth" "brute force,math,number theory" "Kosuke is too lazy. He will not give you any legend, just the task:Fibonacci numbers are defined as follows:  f(1)=f(2)=1.  f(n)=f(n\xe2\x88\x921)+f(n\xe2\x88\x922) (3\xe2\x89\xa4n)  We denote G(n,k) as an index of the n-th Fibonacci number that is divisible by k. For given n and k, compute G(n,k).As this number can be too big, output it by modulo 109+7.For example: G(3,2)=9 because the 3-rd Fibonacci number that is divisible by 2 is 34. [1,1,2,3,5,8,13,21,34]." 1800
2033E "Sakurako, Kosuke, and the Permutation" "brute force,data structures,dfs and similar,dsu,graphs,greedy,math" "Sakurako\'s exams are over, and she did excellently. As a reward, she received a permutation p. Kosuke was not entirely satisfied because he failed one exam and did not receive a gift. He decided to sneak into her room (thanks to the code for her lock) and spoil the permutation so that it becomes simple.A permutation p is considered simple if for every i (1\xe2\x89\xa4i\xe2\x89\xa4n) one of the following conditions holds:  pi=i  ppi=i For example, the permutations [1,2,3,4], [5,2,4,3,1], and [2,1] are simple, while [2,3,1] and [5,2,1,4,3] are not.In one operation, Kosuke can choose indices i,j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) and swap the elements pi and pj.Sakurako is about to return home. Your task is to calculate the minimum number of operations that Kosuke needs to perform to make the permutation simple." 1400
2033D "Kousuke\'s Assignment" "data structures,dp,dsu,greedy,math" "After a trip with Sakurako, Kousuke was very scared because he forgot about his programming assignment. In this assignment, the teacher gave him an array a of n integers and asked him to calculate the number of non-overlapping segments of the array a, such that each segment is considered beautiful.A segment [l,r] is considered beautiful if al+al+1+\xe2\x8b\xaf+ar\xe2\x88\x921+ar=0.For a fixed array a, your task is to compute the maximum number of non-overlapping beautiful segments." 1300
2033C "Sakurako\'s Field Trip" "dp,greedy,two pointers" "Even in university, students need to relax. That is why Sakurakos teacher decided to go on a field trip. It is known that all of the students will be walking in one line. The student with index i has some topic of interest which is described as ai. As a teacher, you want to minimise the disturbance of the line of students.The disturbance of the line is defined as the number of neighbouring people with the same topic of interest. In other words, disturbance is the number of indices j (1\xe2\x89\xa4j<n) such that aj=aj+1.In order to do this, you can choose index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and swap students at positions i and n\xe2\x88\x92i+1. You can perform any number of swaps.Your task is to determine the minimal amount of disturbance that you can achieve by doing the operation described above any number of times." 1400
2033B "Sakurako and Water" "brute force,constructive algorithms,greedy" "During her journey with Kosuke, Sakurako and Kosuke found a valley that can be represented as a matrix of size n\xc3\x97n, where at the intersection of the i-th row and the j-th column is a mountain with a height of ai,j. If ai,j<0, then there is a lake there.Kosuke is very afraid of water, so Sakurako needs to help him:  With her magic, she can select a square area of mountains and increase the height of each mountain on the main diagonal of that area by exactly one. More formally, she can choose a submatrix with the upper left corner located at (i,j) and the lower right corner at (p,q), such that p\xe2\x88\x92i=q\xe2\x88\x92j. She can then add one to each element at the intersection of the (i+k)-th row and the (j+k)-th column, for all k such that 0\xe2\x89\xa4k\xe2\x89\xa4p\xe2\x88\x92i.Determine the minimum number of times Sakurako must use her magic so that there are no lakes." 900
2033A "Sakurako and Kosuke" "constructive algorithms,implementation,math" "Sakurako and Kosuke decided to play some games with a dot on a coordinate line. The dot is currently located in position x=0. They will be taking turns, and Sakurako will be the one to start. On the i-th move, the current player will move the dot in some direction by 2\xe2\x8b\x85i\xe2\x88\x921 units. Sakurako will always be moving the dot in the negative direction, whereas Kosuke will always move it in the positive direction. In other words, the following will happen:  Sakurako will change the position of the dot by \xe2\x88\x921, x=\xe2\x88\x921 now  Kosuke will change the position of the dot by 3, x=2 now  Sakurako will change the position of the dot by \xe2\x88\x925, x=\xe2\x88\x923 now  \xe2\x8b\xaf They will keep on playing while the absolute value of the coordinate of the dot does not exceed n. More formally, the game continues while \xe2\x88\x92n\xe2\x89\xa4x\xe2\x89\xa4n. It can be proven that the game will always end.Your task is to determine who will be the one who makes the last turn." 800
2032F Peanuts combinatorics,dp,games,math "Having the magical beanstalk, Jack has been gathering a lot of peanuts lately. Eventually, he has obtained n pockets of peanuts, conveniently numbered 1 to n from left to right. The i-th pocket has ai peanuts.Jack and his childhood friend Alice decide to play a game around the peanuts. First, Alice divides the pockets into some boxes; each box will have a non-zero number of consecutive pockets, and each pocket will, obviously, belong to exactly one box. At the same time, Alice does not change the order of the boxes, that is, the boxes are numbered in ascending order of the indices of the pockets in them.After that, Alice and Jack will take turns alternately, with Alice going first.At each turn, the current player will remove a positive number of peanuts from exactly one pocket which belongs to the leftmost non-empty box (i.e., the leftmost box containing at least one non-empty pocket). In other words, if we number the boxes from left to right, then each player can only pick peanuts from the pocket in the j-th box (j\xe2\x89\xa52) only if the (j\xe2\x88\x921)-th box has no peanuts left. The player who cannot make a valid move loses.Alice is sure she will win since she has the advantage of dividing the pockets into boxes herself. Thus, she wanted to know how many ways there are for her to divide the peanuts into boxes at the start of the game so that she will win, assuming both players play optimally. Can you help her with the calculation?As the result can be very large, output it modulo 998244353." 2700
2032E Balanced "constructive algorithms,data structures,greedy,implementation,math" "You are given a cyclic array a with n elements, where n is odd. In each operation, you can do the following:  Choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n and increase ai\xe2\x88\x921 by 1, ai by 2, and ai+1 by 1. The element before the first element is the last element because this is a cyclic array. A cyclic array is called balanced if all its elements are equal to each other.Find any sequence of operations to make this cyclic array balanced or determine that it is impossible. Please note that you do not have to minimize the number of operations." 2400
2032D Genokraken "constructive algorithms,data structures,graphs,greedy,implementation,interactive,trees,two pointers" "This is an interactive problem.Upon clearing the Waterside Area, Gretel has found a monster named Genokraken, and she\'s keeping it contained for her scientific studies.The monster\'s nerve system can be structured as a tree\xe2\x80\xa0 of n nodes (really, everything should stop resembling trees all the time\xe2\x80\xa6), numbered from 0 to n\xe2\x88\x921, with node 0 as the root.Gretel\'s objective is to learn the exact structure of the monster\'s nerve system \xe2\x80\x94 more specifically, she wants to know the values p1,p2,\xe2\x80\xa6,pn\xe2\x88\x921 of the tree, where pi (0\xe2\x89\xa4pi<i) is the direct parent node of node i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).She doesn\'t know exactly how the nodes are placed, but she knows a few convenient facts:  If we remove root node 0 and all adjacent edges, this tree will turn into a forest consisting of only paths\xe2\x80\xa1. Each node that was initially adjacent to the node 0 will be the end of some path.  The nodes are indexed in a way that if 1\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4n\xe2\x88\x921, then px\xe2\x89\xa4py.  Node 1 has exactly two adjacent nodes (including the node 0).  The tree in this picture does not satisfy the condition, because if we remove node 0, then node 2 (which was initially adjacent to the node 0) will not be the end of the path 4\xe2\x88\x922\xe2\x88\x925.The tree in this picture does not satisfy the condition, because p3\xe2\x89\xa4p4 must hold.The tree in this picture does not satisfy the condition, because node 1 has only one adjacent node. Gretel can make queries to the containment cell:  ""? a b"" (1\xe2\x89\xa4a,b<n, a\xe2\x89\xa0b) \xe2\x80\x94 the cell will check if the simple path between nodes a and b contains the node 0. However, to avoid unexpected consequences by overstimulating the creature, Gretel wants to query at most 2n\xe2\x88\x926 times. Though Gretel is gifted, she can\'t do everything all at once, so can you give her a helping hand?\xe2\x80\xa0A tree is a connected graph where every pair of distinct nodes has exactly one simple path connecting them.\xe2\x80\xa1A path is a tree whose vertices can be listed in the order v1,v2,\xe2\x80\xa6,vk such that the edges are (vi,vi+1) (1\xe2\x89\xa4i<k)." 1800
2032C Trinity "binary search,math,sortings,two pointers" "You are given an array a of n elements a1,a2,\xe2\x80\xa6,an.You can perform the following operation any number (possibly 0) of times:  Choose two integers i and j, where 1\xe2\x89\xa4i,j\xe2\x89\xa4n, and assign ai:=aj. Find the minimum number of operations required to make the array a satisfy the condition:  For every pairwise distinct triplet of indices (x,y,z) (1\xe2\x89\xa4x,y,z\xe2\x89\xa4n, x\xe2\x89\xa0y, y\xe2\x89\xa0z, x\xe2\x89\xa0z), there exists a non-degenerate triangle with side lengths ax, ay and az, i.e. ax+ay>az, ay+az>ax and az+ax>ay." 1400
2032B Medians "constructive algorithms,greedy,implementation,math" "You are given an array a=[1,2,\xe2\x80\xa6,n], where n is odd, and an integer k.Your task is to choose an odd positive integer m and to split a into m subarrays\xe2\x80\xa0 b1,b2,\xe2\x80\xa6,bm such that:  Each element of the array a belongs to exactly one subarray.  For all 1\xe2\x89\xa4i\xe2\x89\xa4m, |bi| is odd, i.e., the length of each subarray is odd.  median([median(b1),median(b2),\xe2\x80\xa6,median(bm)])=k, i.e., the median\xe2\x80\xa1 of the array of medians of all subarrays must equal k. median(c) denotes the median of the array c. \xe2\x80\xa0A subarray of the array a of length n is the array [al,al+1,\xe2\x80\xa6,ar] for some integers 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n.\xe2\x80\xa1A median of the array of odd length is the middle element after the array is sorted in non-decreasing order. For example: median([1,2,5,4,3])=3, median([3,2,1])=2, median([2,1,2,1,2,2,2])=2." 1100
2032A Circuit "greedy,implementation,math,number theory" "Alice has just crafted a circuit with n lights and 2n switches. Each component (a light or a switch) has two states: on or off. The lights and switches are arranged in a way that:  Each light is connected to exactly two switches.  Each switch is connected to exactly one light. It\'s unknown which light each switch is connected to.  When all switches are off, all lights are also off.  If a switch is toggled (from on to off, or vice versa), the state of the light connected to it will also toggle. Alice brings the circuit, which shows only the states of the 2n switches, to her sister Iris and gives her a riddle: what is the minimum and maximum number of lights that can be turned on?Knowing her little sister\'s antics too well, Iris takes no more than a second to give Alice a correct answer. Can you do the same?" 800
2031F "Penchick and Even Medians" "binary search,constructive algorithms,interactive,probabilities" "This is an interactive problem. Returning from a restful vacation on Australia\'s Gold Coast, Penchick forgot to bring home gifts for his pet duck Duong Canh! But perhaps a beautiful problem crafted through deep thought on the scenic beaches could be the perfect souvenir.There is a hidden permutation\xe2\x88\x97 p of length n, where n is even. You are allowed to make the following query:  Choose a subsequence\xe2\x80\xa0 of the permutation p with even length 4\xe2\x89\xa4k\xe2\x89\xa4n. The interactor will return the value of the two medians\xe2\x80\xa1 in the chosen subsequence. Find the index of the two medians in permutation p using at most 80 queries.Note that the interactor is non-adaptive. This means that the permutation p is fixed at the beginning and will not change based on your queries.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array). \xe2\x80\xa0A sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) element from arbitrary positions. \xe2\x80\xa1The two medians of an array a with even length k are defined as the k2-th and (k2+1)-th smallest element in the array (1-indexed)." -999
2031E "Penchick and Chloe\'s Trees" "binary search,constructive algorithms,data structures,dfs and similar,dp,greedy,math,sortings,trees" "With just a few hours left until Penchick and Chloe leave for Singapore, they could hardly wait to see the towering trees at the Singapore Botanic Gardens! Attempting to contain their excitement, Penchick crafted a rooted tree to keep Chloe and himself busy.Penchick has a rooted tree\xe2\x88\x97 consisting of n vertices, numbered from 1 to n, with vertex 1 as the root, and Chloe can select a non-negative integer d to create a perfect binary tree\xe2\x80\xa0 of depth d.Since Penchick and Chloe are good friends, Chloe wants her tree to be isomorphic\xe2\x80\xa1 to Penchick\'s tree. To meet this condition, Chloe can perform the following operation on her own tree any number of times:  Select an edge (u,v), where u is the parent of v.  Remove vertex v and all the edges connected to v, then connect all of v\'s previous children directly to u. In particular, doing an operation on an edge (u,v) where v is a leaf will delete vertex v without adding any new edges.Since constructing a perfect binary tree can be time-consuming, Chloe wants to choose the minimum d such that a perfect binary tree of depth d can be made isomorphic to Penchick\'s tree using the above operation. Note that she can\'t change the roots of the trees.\xe2\x88\x97A tree is a connected graph without cycles.  A rooted tree is a tree where one vertex is special and called the root.  The parent of vertex v is the first vertex on the simple path from v to the root. The root has no parent.  A child of vertex v is any vertex u for which v is the parent.  A leaf is any vertex without children. \xe2\x80\xa0A full binary tree is rooted tree, in which each node has 0 or 2 children.  A perfect binary tree is a full binary tree in which every leaf is at the same distance from the root. The depth of such a tree is the distance from the root to a leaf.\xe2\x80\xa1Two rooted trees, rooted at r1 and r2 respectively, are considered isomorphic if there exists a permutation p of the vertices such that an edge (u,v) exists in the first tree if and only if the edge (pu,pv) exists in the second tree, and pr1=r2." -999
2031D "Penchick and Desert Rabbit" "binary search,data structures,dfs and similar,dp,greedy,two pointers" "Dedicated to pushing himself to his limits, Penchick challenged himself to survive the midday sun in the Arabian Desert!While trekking along a linear oasis, Penchick spots a desert rabbit preparing to jump along a line of palm trees. There are n trees, each with a height denoted by ai.The rabbit can jump from the i-th tree to the j-th tree if exactly one of the following conditions is true:  j<i and aj>ai: the rabbit can jump backward to a taller tree.  j>i and aj<ai: the rabbit can jump forward to a shorter tree. For each i from 1 to n, determine the maximum height among all trees that the rabbit can reach if it starts from the i-th tree." -999
2031C "Penchick and BBQ Buns" "constructive algorithms,math,number theory" "Penchick loves two things: square numbers and Hong Kong-style BBQ buns! For his birthday, Kohane wants to combine them with a gift: n BBQ buns arranged from left to right. There are 106 available fillings of BBQ buns, numbered from 1 to 106. To ensure that Penchick would love this gift, Kohane has a few goals:  No filling is used exactly once; that is, each filling must either not appear at all or appear at least twice.  For any two buns i and j that have the same filling, the distance between them, which is |i\xe2\x88\x92j|, must be a perfect square\xe2\x88\x97. Help Kohane find a valid way to choose the filling of the buns, or determine if it is impossible to satisfy her goals! If there are multiple solutions, print any of them.\xe2\x88\x97A positive integer x is a perfect square if there exists a positive integer y such that x=y2. For example, 49 and 1 are perfect squares because 49=72 and 1=12 respectively. On the other hand, 5 is not a perfect square as no integer squared equals 5" -999
2031B "Penchick and Satay Sticks" "brute force,greedy,sortings" "Penchick and his friend Kohane are touring Indonesia, and their next stop is in Surabaya!In the bustling food stalls of Surabaya, Kohane bought n satay sticks and arranged them in a line, with the i-th satay stick having length pi. It is given that p is a permutation\xe2\x88\x97 of length n.Penchick wants to sort the satay sticks in increasing order of length, so that pi=i for each 1\xe2\x89\xa4i\xe2\x89\xa4n. For fun, they created a rule: they can only swap neighboring satay sticks whose lengths differ by exactly 1. Formally, they can perform the following operation any number of times (including zero):  Select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) such that |pi+1\xe2\x88\x92pi|=1;  Swap pi and pi+1. Determine whether it is possible to sort the permutation p, thus the satay sticks, by performing the above operation.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." -999
2031A "Penchick and Modern Monument" "constructive algorithms,dp,greedy,math" "Amidst skyscrapers in the bustling metropolis of Metro Manila, the newest Noiph mall in the Philippines has just been completed! The construction manager, Penchick, ordered a state-of-the-art monument to be built with n pillars. The heights of the monument\'s pillars can be represented as an array h of n positive integers, where hi represents the height of the i-th pillar for all i between 1 and n.Penchick wants the heights of the pillars to be in non-decreasing order, i.e. hi\xe2\x89\xa4hi+1 for all i between 1 and n\xe2\x88\x921. However, due to confusion, the monument was built such that the heights of the pillars are in non-increasing order instead, i.e. hi\xe2\x89\xa5hi+1 for all i between 1 and n\xe2\x88\x921.Luckily, Penchick can modify the monument and do the following operation on the pillars as many times as necessary:  Modify the height of a pillar to any positive integer. Formally, choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n and a positive integer x. Then, assign hi:=x. Help Penchick determine the minimum number of operations needed to make the heights of the monument\'s pillars non-decreasing." -999
2030G2 "The Destruction of the Universe (Hard Version)" combinatorics,math "This is the hard version of the problem. In this version, n\xe2\x89\xa4106. You can only make hacks if both versions of the problem are solved.Orangutans are powerful beings\xe2\x80\x94so powerful that they only need 1 unit of time to destroy every vulnerable planet in the universe!There are n planets in the universe. Each planet has an interval of vulnerability [l,r], during which it will be exposed to destruction by orangutans. Orangutans can also expand the interval of vulnerability of any planet by 1 unit.Specifically, suppose the expansion is performed on planet p with interval of vulnerability [lp,rp]. Then, the resulting interval of vulnerability may be either [lp\xe2\x88\x921,rp] or [lp,rp+1].Given a set of planets, orangutans can destroy all planets if the intervals of vulnerability of all planets in the set intersect at least one common point. Let the score of such a set denote the minimum number of expansions that must be performed.Orangutans are interested in the sum of scores of all non-empty subsets of the planets in the universe. As the answer can be large, output it modulo 998244353." 3100
2030G1 "The Destruction of the Universe (Easy Version)" combinatorics,greedy,math "This is the easy version of the problem. In this version, n\xe2\x89\xa45000. You can only make hacks if both versions of the problem are solved.Orangutans are powerful beings\xe2\x80\x94so powerful that they only need 1 unit of time to destroy every vulnerable planet in the universe!There are n planets in the universe. Each planet has an interval of vulnerability [l,r], during which it will be exposed to destruction by orangutans. Orangutans can also expand the interval of vulnerability of any planet by 1 unit.Specifically, suppose the expansion is performed on planet p with interval of vulnerability [lp,rp]. Then, the resulting interval of vulnerability may be either [lp\xe2\x88\x921,rp] or [lp,rp+1].Given a set of planets, orangutans can destroy all planets if the intervals of vulnerability of all planets in the set intersect at least one common point. Let the score of such a set denote the minimum number of expansions that must be performed.Orangutans are interested in the sum of scores of all non-empty subsets of the planets in the universe. As the answer can be large, output it modulo 998244353." 2900
2030F "Orangutan Approved Subarrays" "binary search,data structures,dp,greedy,implementation,two pointers" "Suppose you have an array b. Initially, you also have a set S that contains all distinct elements of b. The array b is called orangutan-approved if it can be emptied by repeatedly performing the following operation:   In one operation, select indices l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|b|) such that v=bl=bl+1=\xe2\x80\xa6=br and v is present in S. Remove v from S, and simultaneously remove all bi such that l\xe2\x89\xa4i\xe2\x89\xa4r. Then, reindex the elements br+1,br+2,\xe2\x80\xa6 as bl,bl+1,\xe2\x80\xa6 accordingly. You are given an array a of length n and q queries. Each query consists of two indices l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), and you need to determine whether or not the subarray al,al+1,\xe2\x80\xa6,ar is orangutan-approved." 2400
2030E "MEXimize the Score" "combinatorics,data structures,dp,greedy,implementation,math" "Suppose we partition the elements of an array b into any number k of non-empty multisets S1,S2,\xe2\x80\xa6,Sk, where k is an arbitrary positive integer. Define the score of b as the maximum value of MEX(S1)\xe2\x88\x97+MEX(S2)+\xe2\x80\xa6+MEX(Sk) over all possible partitions of b for any integer k.Envy is given an array a of size n. Since he knows that calculating the score of a is too easy for you, he instead asks you to calculate the sum of scores of all 2n\xe2\x88\x921 non-empty subsequences of a.\xe2\x80\xa0 Since this answer may be large, please output it modulo 998244353.\xe2\x88\x97MEX of a collection of integers c1,c2,\xe2\x80\xa6,ck is defined as the smallest non-negative integer x that does not occur in the collection c. For example, MEX([0,1,2,2])=3 and MEX([1,2,2])=0\xe2\x80\xa0A sequence x is a subsequence of a sequence y if x can be obtained from y by deleting several (possibly, zero or all) elements." 2200
2030D "QED\'s Favorite Permutation" "data structures,implementation,sortings" "QED is given a permutation\xe2\x88\x97 p of length n. He also has a string s of length n containing only characters L and R. QED only likes permutations that are sorted in non-decreasing order. To sort p, he can select any of the following operations and perform them any number of times:  Choose an index i such that si=L. Then, swap pi and pi\xe2\x88\x921. It is guaranteed that s1\xe2\x89\xa0L.  Choose an index i such that si=R. Then, swap pi and pi+1. It is guaranteed that sn\xe2\x89\xa0R. He is also given q queries. In each query, he selects an index i and changes si from L to R (or from R to L). Note that the changes are persistent. After each query, he asks you if it is possible to sort p in non-decreasing order by performing the aforementioned operations any number of times. Note that before answering each query, the permutation p is reset to its original form.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1700
2030C "A TRUE Battle" "brute force,games,greedy" "Alice and Bob are playing a game. There is a list of n booleans, each of which is either true or false, given as a binary string \xe2\x88\x97 of length n (where 1 represents true, and 0 represents false). Initially, there are no operators between the booleans.Alice and Bob will take alternate turns placing and or or between the booleans, with Alice going first. Thus, the game will consist of n\xe2\x88\x921 turns since there are n booleans. Alice aims for the final statement to evaluate to true, while Bob aims for it to evaluate to false. Given the list of boolean values, determine whether Alice will win if both players play optimally.To evaluate the final expression, repeatedly perform the following steps until the statement consists of a single true or false:   If the statement contains an and operator, choose any one and replace the subexpression surrounding it with its evaluation.  Otherwise, the statement contains an or operator. Choose any one and replace the subexpression surrounding the or with its evaluation.  For example, the expression true or false and false is evaluated as true or (false and false) = true or false = true. It can be shown that the result of any compound statement is unique.\xe2\x88\x97A binary string is a string that only consists of characters 0 and 1" 1100
2030B "Minimise Oneness" "combinatorics,constructive algorithms,games,math" "For an arbitrary binary string t\xe2\x88\x97, let f(t) be the number of non-empty subsequences\xe2\x80\xa0 of t that contain only 0, and let g(t) be the number of non-empty subsequences of t that contain at least one 1. Note that for f(t) and for g(t), each subsequence is counted as many times as it appears in t. E.g., f(000)=7,g(100)=4.We define the oneness of the binary string t to be |f(t)\xe2\x88\x92g(t)|, where for an arbitrary integer z, |z| represents the absolute value of z.You are given a positive integer n. Find a binary string s of length n such that its oneness is as small as possible. If there are multiple strings, you can print any of them.\xe2\x88\x97A binary string is a string that only consists of characters 0 and 1.\xe2\x80\xa0A sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) elements. For example, subsequences of 1011101 are 0, 1, 11111, 0111, but not 000 nor 11100." 800
2030A "A Gift From Orangutan" "constructive algorithms,greedy,math,sortings" "While exploring the jungle, you have bumped into a rare orangutan with a bow tie! You shake hands with the orangutan and offer him some food and water. In return...The orangutan has gifted you an array a of length n. Using a, you will construct two arrays b and c, both containing n elements, in the following manner:  bi=min(a1,a2,\xe2\x80\xa6,ai) for each 1\xe2\x89\xa4i\xe2\x89\xa4n.  ci=max(a1,a2,\xe2\x80\xa6,ai) for each 1\xe2\x89\xa4i\xe2\x89\xa4n. Define the score of a as \xe2\x88\x91ni=1ci\xe2\x88\x92bi (i.e. the sum of ci\xe2\x88\x92bi over all 1\xe2\x89\xa4i\xe2\x89\xa4n). Before you calculate the score, you can shuffle the elements of a however you want.Find the maximum score that you can get if you shuffle the elements of a optimally." 800
2029I "Variance Challenge" flows,graphs,greedy "Kevin has recently learned the definition of variance. For an array a of length n, the variance of a is defined as follows:  Let x=1nn\xe2\x88\x91i=1ai, i.e., x is the mean of the array a;  Then, the variance of a is V(a)=1nn\xe2\x88\x91i=1(ai\xe2\x88\x92x)2. Now, Kevin gives you an array a consisting of n integers, as well as an integer k. You can perform the following operation on a:  Select an interval [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), then for each l\xe2\x89\xa4i\xe2\x89\xa4r, increase ai by k. For each 1\xe2\x89\xa4p\xe2\x89\xa4m, you have to find the minimum possible variance of a after exactly p operations are performed, independently for each p.For simplicity, you only need to output the answers multiplied by n2. It can be proven that the results are always integers." 3400
2029H "Message Spread" "bitmasks,brute force,combinatorics,dp" "Given is an undirected graph with n vertices and m edges. Each edge connects two vertices (u,v) and has a probability of pq of appearing each day.Initially, vertex 1 has a message. At the end of the day, a vertex has a message if and only if itself or at least one of the vertices adjacent to it had the message the day before. Note that each day, each edge chooses its appearance independently.Calculate the expected number of days before all the vertices have the message, modulo 998244353." 3500
2029G "Balanced Problem" "data structures,dp" "There is an array a consisting of n integers. Initially, all elements of a are equal to 0.Kevin can perform several operations on the array. Each operation is one of the following two types: Prefix addition \xe2\x80\x94 Kevin first selects an index x (1\xe2\x89\xa4x\xe2\x89\xa4n), and then for each 1\xe2\x89\xa4j\xe2\x89\xa4x, increases aj by 1;  Suffix addition \xe2\x80\x94 Kevin first selects an index x (1\xe2\x89\xa4x\xe2\x89\xa4n), and then for each x\xe2\x89\xa4j\xe2\x89\xa4n, increases aj by 1.In the country of KDOI, people think that the integer v is balanced. Thus, Iris gives Kevin an array c consisting of n integers and defines the beauty of the array a as follows: Initially, set b=0;  For each 1\xe2\x89\xa4i\xe2\x89\xa4n, if ai=v, add ci to b;  The beauty of a is the final value of b.Kevin wants to maximize the beauty of a after all the operations. However, he had already performed m operations when he was sleepy. Now, he can perform an arbitrary number (possibly zero) of new operations.You have to help Kevin find the maximum possible beauty if he optimally performs the new operations.However, to make sure that you are not just rolling the dice, Kevin gives you an integer V, and you need to solve the problem for each 1\xe2\x89\xa4v\xe2\x89\xa4V." 3000
2029F "Palindrome Everywhere" "constructive algorithms,graphs,greedy" "You are given a cycle with n vertices numbered from 0 to n\xe2\x88\x921. For each 0\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, there is an undirected edge between vertex i and vertex ((i+1)modn) with the color ci (ci=R or B).Determine whether the following condition holds for every pair of vertices (i,j) (0\xe2\x89\xa4i<j\xe2\x89\xa4n\xe2\x88\x921): There exists a palindrome route between vertex i and vertex j. Note that the route may not be simple. Formally, there must exist a sequence p=[p0,p1,p2,\xe2\x80\xa6,pm] such that: p0=i, pm=j;  For each 0\xe2\x89\xa4x\xe2\x89\xa4m\xe2\x88\x921, either px+1=(px+1)modn or px+1=(px\xe2\x88\x921)modn;  For each 0\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4m\xe2\x88\x921 satisfying x+y=m\xe2\x88\x921, the edge between px and px+1 has the same color as the edge between py and py+1." 2500
2029E "Common Generator" "brute force,constructive algorithms,math,number theory" "For two integers x and y (x,y\xe2\x89\xa52), we will say that x is a generator of y if and only if x can be transformed to y by performing the following operation some number of times (possibly zero):  Choose a divisor d (d\xe2\x89\xa52) of x, then increase x by d. For example,   3 is a generator of 8 since we can perform the following operations: 3d=3\xe2\x86\x926d=2\xe2\x86\x928;  4 is a generator of 10 since we can perform the following operations: 4d=4\xe2\x86\x928d=2\xe2\x86\x9210;  5 is not a generator of 6 since we cannot transform 5 into 6 with the operation above. Now, Kevin gives you an array a consisting of n pairwise distinct integers (ai\xe2\x89\xa52).You have to find an integer x\xe2\x89\xa52 such that for each 1\xe2\x89\xa4i\xe2\x89\xa4n, x is a generator of ai, or determine that such an integer does not exist." 2100
2029D "Cool Graph" "constructive algorithms,data structures,dfs and similar,dsu,graphs,greedy,trees" "You are given an undirected graph with n vertices and m edges.You can perform the following operation at most 2\xe2\x8b\x85max(n,m) times:  Choose three distinct vertices a, b, and c, then for each of the edges (a,b), (b,c), and (c,a), do the following:   If the edge does not exist, add it. On the contrary, if it exists, remove it.  A graph is called cool if and only if one of the following holds:  The graph has no edges, or  The graph is a tree. You have to make the graph cool by performing the above operations. Note that you can use at most 2\xe2\x8b\x85max(n,m) operations.It can be shown that there always exists at least one solution." 1900
2029C "New Rating" "binary search,data structures,dp,greedy" "Hello, Codeforces Forcescode! Kevin used to be a participant of Codeforces. Recently, the KDOI Team has developed a new Online Judge called Forcescode. Kevin has participated in n contests on Forcescode. In the i-th contest, his performance rating is ai.Now he has hacked into the backend of Forcescode and will select an interval [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), then skip all of the contests in this interval. After that, his rating will be recalculated in the following way:  Initially, his rating is x=0;  For each 1\xe2\x89\xa4i\xe2\x89\xa4n, after the i-th contest,   If l\xe2\x89\xa4i\xe2\x89\xa4r, this contest will be skipped, and the rating will remain unchanged;  Otherwise, his rating will be updated according to the following rules:   If ai>x, his rating x will increase by 1;  If ai=x, his rating x will remain unchanged;  If ai<x, his rating x will decrease by 1.   You have to help Kevin to find his maximum possible rating after the recalculation if he chooses the interval [l,r] optimally. Note that Kevin has to skip at least one contest." 1700
2029B Replacement "constructive algorithms,games,strings" "You have a binary string\xe2\x88\x97 s of length n, and Iris gives you another binary string r of length n\xe2\x88\x921.Iris is going to play a game with you. During the game, you will perform n\xe2\x88\x921 operations on s. In the i-th operation (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921):  First, you choose an index k such that 1\xe2\x89\xa4k\xe2\x89\xa4|s|\xe2\x88\x921 and sk\xe2\x89\xa0sk+1. If it is impossible to choose such an index, you lose;  Then, you replace sksk+1 with ri. Note that this decreases the length of s by 1. If all the n\xe2\x88\x921 operations are performed successfully, you win.Determine whether it is possible for you to win this game.\xe2\x88\x97A binary string is a string where each character is either 0 or 1." 1100
2029A Set greedy,math "You are given a positive integer k and a set S of all integers from l to r (inclusive).You can perform the following two-step operation any number of times (possibly zero): First, choose a number x from the set S, such that there are at least k multiples of x in S (including x itself);  Then, remove x from S (note that nothing else is removed).Find the maximum possible number of operations that can be performed." 800
2028F "Alice\'s Adventures in Addition" "bitmasks,brute force,dp,implementation" "Note that the memory limit is unusual.The Cheshire Cat has a riddle for Alice: given n integers a1,a2,\xe2\x80\xa6,an and a target m, is there a way to insert + and \xc3\x97 into the circles of the expression a1\xe2\x88\x98a2\xe2\x88\x98\xe2\x8b\xaf\xe2\x88\x98an=m to make it true? We follow the usual order of operations: \xc3\x97 is done before +.Although Alice is excellent at chess, she is not good at math. Please help her so she can find a way out of Wonderland!" 2700
2028E "Alice\'s Adventures in the Rabbit Hole" "combinatorics,dfs and similar,dp,games,greedy,math,probabilities,trees" "Alice is at the bottom of the rabbit hole! The rabbit hole can be modeled as a tree\xe2\x88\x97 which has an exit at vertex 1, and Alice starts at some vertex v. She wants to get out of the hole, but unfortunately, the Queen of Hearts has ordered her execution. Each minute, a fair coin is flipped. If it lands heads, Alice gets to move to an adjacent vertex of her current location, and otherwise, the Queen of Hearts gets to pull Alice to an adjacent vertex of the Queen\'s choosing. If Alice ever ends up on any of the non-root leaves\xe2\x80\xa0 of the tree, Alice loses.Assuming both of them move optimally, compute the probability that Alice manages to escape for every single starting vertex 1\xe2\x89\xa4v\xe2\x89\xa4n. Since these probabilities can be very small, output them modulo 998244353.Formally, let M=998244353. It can be shown that the exact answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM). \xe2\x88\x97A tree is a connected simple graph which has n vertices and n\xe2\x88\x921 edges.\xe2\x80\xa0A leaf is a vertex that is connected to exactly one edge." 2300
2028D "Alice\'s Adventures in Cards" "constructive algorithms,data structures,dp,graphs,greedy,implementation,ternary search" "Alice is playing cards with the Queen of Hearts, King of Hearts, and Jack of Hearts. There are n different types of cards in their card game. Alice currently has a card of type 1 and needs a card of type n to escape Wonderland. The other players have one of each kind of card.In this card game, Alice can trade cards with the three other players. Each player has different preferences for the n types of cards, which can be described by permutations\xe2\x88\x97 q, k, and j for the Queen, King, and Jack, respectively. A player values card a more than card b if for their permutation p, pa>pb. Then, this player is willing to trade card b to Alice in exchange for card a. Alice\'s preferences are straightforward: she values card a more than card b if a>b, and she will also only trade according to these preferences.Determine if Alice can trade up from card 1 to card n subject to these preferences, and if it is possible, give a possible set of trades to do it.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2000
2028C "Alice\'s Adventures in Cutting Cake" "binary search,dp,greedy,two pointers" "Alice is at the Mad Hatter\'s tea party! There is a long sheet cake made up of n sections with tastiness values a1,a2,\xe2\x80\xa6,an. There are m creatures at the tea party, excluding Alice. Alice will cut the cake into m+1 pieces. Formally, she will partition the cake into m+1 subarrays, where each subarray consists of some number of adjacent sections. The tastiness of a piece is the sum of tastiness of its sections. Afterwards, she will divvy these m+1 pieces up among the m creatures and herself (her piece can be empty). However, each of the m creatures will only be happy when the tastiness of its piece is v or more.Alice wants to make sure every creature is happy. Limited by this condition, she also wants to maximize the tastiness of her own piece. Can you help Alice find the maximum tastiness her piece can have? If there is no way to make sure every creature is happy, output \xe2\x88\x921." 1600
2028B "Alice\'s Adventures in Permuting" "binary search,implementation,math" "Alice mixed up the words transmutation and permutation! She has an array a specified via three integers n, b, c: the array a has length n and is given via ai=b\xe2\x8b\x85(i\xe2\x88\x921)+c for 1\xe2\x89\xa4i\xe2\x89\xa4n. For example, if n=3, b=2, and c=1, then a=[2\xe2\x8b\x850+1,2\xe2\x8b\x851+1,2\xe2\x8b\x852+1]=[1,3,5].Now, Alice really enjoys permutations of [0,\xe2\x80\xa6,n\xe2\x88\x921]\xe2\x88\x97 and would like to transform a into a permutation. In one operation, Alice replaces the maximum element of a with the MEX\xe2\x80\xa0 of a. If there are multiple maximum elements in a, Alice chooses the leftmost one to replace.Can you help Alice figure out how many operations she has to do for a to become a permutation for the first time? If it is impossible, you should report it.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 0 to n\xe2\x88\x921 in arbitrary order. Please note, this is slightly different from the usual definition of a permutation. For example, [1,2,0,4,3] is a permutation, but [0,1,1] is not a permutation (1 appears twice in the array), and [0,2,3] is also not a permutation (n=3 but there is 3 in the array).\xe2\x80\xa0The MEX of an array is the smallest non-negative integer that does not belong to the array. For example, the MEX of [0,3,1,3] is 2 and the MEX of [5] is 0." 1400
2028A "Alice\'s Adventures in \'\'Chess\'\'" "brute force,implementation,math" "Alice is trying to meet up with the Red Queen in the countryside! Right now, Alice is at position (0,0), and the Red Queen is at position (a,b). Alice can only move in the four cardinal directions (north, east, south, west). More formally, if Alice is at the point (x,y), she will do one of the following:   go north (represented by N), moving to (x,y+1);  go east (represented by E), moving to (x+1,y);  go south (represented by S), moving to (x,y\xe2\x88\x921); or  go west (represented by W), moving to (x\xe2\x88\x921,y). Alice\'s movements are predetermined. She has a string s representing a sequence of moves that she performs from left to right. Once she reaches the end of the sequence, she repeats the same pattern of moves forever.Can you help Alice figure out if she will ever meet the Red Queen?" 900
2027E2 "Bit Game (Hard Version)" bitmasks,dp,math "This is the hard version of this problem. The only difference is that you need to output the number of choices of games where Bob wins in this version, where the number of stones in each pile are not fixed. You must solve both versions to be able to hack.Alice and Bob are playing a familiar game where they take turns removing stones from n piles. Initially, there are xi stones in the i-th pile, and it has an associated value ai. A player can take d stones away from the i-th pile if and only if both of the following conditions are met:   1\xe2\x89\xa4d\xe2\x89\xa4ai, and  x&d=d, where x is the current number of stones in the i-th pile and & denotes the bitwise AND operation. The player who cannot make a move loses, and Alice goes first.You\'re given the ai values of each pile, but the number of stones in the i-th pile has not been determined yet. For the i-th pile, xi can be any integer between 1 and bi, inclusive. That is, you can choose an array x1,x2,\xe2\x80\xa6,xn such that the condition 1\xe2\x89\xa4xi\xe2\x89\xa4bi is satisfied for all piles. Your task is to count the number of games where Bob wins if both players play optimally. Two games are considered different if the number of stones in any pile is different, i.e., the arrays of x differ in at least one position.Since the answer can be very large, please output the result modulo 109+7." 3100
2027E1 "Bit Game (Easy Version)" "bitmasks,brute force,games,math" "This is the easy version of this problem. The only difference is that you need to output the winner of the game in this version, and the number of stones in each pile are fixed. You must solve both versions to be able to hack.Alice and Bob are playing a familiar game where they take turns removing stones from n piles. Initially, there are xi stones in the i-th pile, and it has an associated value ai. A player can take d stones away from the i-th pile if and only if both of the following conditions are met:   1\xe2\x89\xa4d\xe2\x89\xa4ai, and  x&d=d, where x is the current number of stones in the i-th pile and & denotes the bitwise AND operation. The player who cannot make a move loses, and Alice goes first.You\'re given the ai and xi values for each pile, please determine who will win the game if both players play optimally." 2800
2027D2 "The Endspeaker (Hard Version)" "binary search,data structures,dp,greedy,implementation,two pointers" "This is the hard version of this problem. The only difference is that you need to also output the number of optimal sequences in this version. You must solve both versions to be able to hack.You\'re given an array a of length n, and an array b of length m (bi>bi+1 for all 1\xe2\x89\xa4i<m). Initially, the value of k is 1. Your aim is to make the array a empty by performing one of these two operations repeatedly:  Type 1 \xe2\x80\x94 If the value of k is less than m and the array a is not empty, you can increase the value of k by 1. This does not incur any cost.  Type 2 \xe2\x80\x94 You remove a non-empty prefix of array a, such that its sum does not exceed bk. This incurs a cost of m\xe2\x88\x92k. You need to minimize the total cost of the operations to make array a empty. If it\'s impossible to do this through any sequence of operations, output \xe2\x88\x921. Otherwise, output the minimum total cost of the operations, and the number of sequences of operations which yield this minimum cost modulo 109+7. Two sequences of operations are considered different if you choose a different type of operation at any step, or the size of the removed prefix is different at any step." 2200
2027D1 "The Endspeaker (Easy Version)" "binary search,dp,graphs,greedy,implementation,two pointers" "This is the easy version of this problem. The only difference is that you only need to output the minimum total cost of operations in this version. You must solve both versions to be able to hack.You\'re given an array a of length n, and an array b of length m (bi>bi+1 for all 1\xe2\x89\xa4i<m). Initially, the value of k is 1. Your aim is to make the array a empty by performing one of these two operations repeatedly:  Type 1 \xe2\x80\x94 If the value of k is less than m and the array a is not empty, you can increase the value of k by 1. This does not incur any cost.  Type 2 \xe2\x80\x94 You remove a non-empty prefix of array a, such that its sum does not exceed bk. This incurs a cost of m\xe2\x88\x92k. You need to minimize the total cost of the operations to make array a empty. If it\'s impossible to do this through any sequence of operations, output \xe2\x88\x921. Otherwise, output the minimum total cost of the operations." 1700
2027C "Add Zeros" "brute force,data structures,dfs and similar,dp,graphs,greedy" "You\'re given an array a initially containing n integers. In one operation, you must do the following:  Choose a position i such that 1<i\xe2\x89\xa4|a| and ai=|a|+1\xe2\x88\x92i, where |a| is the current size of the array.  Append i\xe2\x88\x921 zeros onto the end of a. After performing this operation as many times as you want, what is the maximum possible length of the array a?" 1500
2027B "Stalin Sort" "brute force,greedy" "Stalin Sort is a humorous sorting algorithm designed to eliminate elements which are out of place instead of bothering to sort them properly, lending itself to an O(n) time complexity.It goes as follows: starting from the second element in the array, if it is strictly smaller than the previous element (ignoring those which have already been deleted), then delete it. Continue iterating through the array until it is sorted in non-decreasing order. For example, the array [1,4,2,3,6,5,5,7,7] becomes [1,4,6,7,7] after a Stalin Sort.We define an array as vulnerable if you can sort it in non-increasing order by repeatedly applying a Stalin Sort to any of its subarrays\xe2\x88\x97, as many times as is needed.Given an array a of n integers, determine the minimum number of integers which must be removed from the array to make it vulnerable.\xe2\x88\x97An array a is a subarray of an array b if a can be obtained from b by the deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 1100
2027A "Rectangle Arrangement" geometry,implementation,math "You are coloring an infinite square grid, in which all cells are initially white. To do this, you are given n stamps. Each stamp is a rectangle of width wi and height hi.You will use each stamp exactly once to color a rectangle of the same size as the stamp on the grid in black. You cannot rotate the stamp, and for each cell, the stamp must either cover it fully or not cover it at all. You can use the stamp at any position on the grid, even if some or all of the cells covered by the stamping area are already black.What is the minimum sum of the perimeters of the connected regions of black squares you can obtain after all the stamps have been used?" 800
2026F "Bermart Ice Cream" "data structures,dfs and similar,divide and conquer,dp,implementation,trees" "In the Bermart chain of stores, a variety of ice cream is sold. Each type of ice cream has two parameters: price and tastiness.Initially, there is one store numbered 1, which sells nothing. You have to process q queries of the following types:   1 x \xe2\x80\x94 a new store opens, that sells the same types of ice cream as store x. It receives the minimum available positive index. The order of the types of ice cream in the new store is the same as in store x.  2 x p t \xe2\x80\x94 a type of ice cream with price p and tastiness t becomes available in store x.  3 x \xe2\x80\x94 a type of ice cream that was available the longest (appeared the earliest) in store x is removed.  4 x p \xe2\x80\x94 for store x, find the maximum total tastiness of a subset of types of ice cream that are sold there, such that the total price does not exceed p (each type can be used in the subset no more than once)." 2700
2026E "Best Subsequence" "bitmasks,dfs and similar,flows,graph matchings,graphs" "Given an integer array a of size n.Let\'s define the value of the array as its size minus the number of set bits in the bitwise OR of all elements of the array.For example, for the array [1,0,1,2], the bitwise OR is 3 (which contains 2 set bits), and the value of the array is 4\xe2\x88\x922=2.Your task is to calculate the maximum possible value of some subsequence of the given array." 2500
2026D "Sums of Segments" "binary search,data structures,dp,implementation,math" "You are given a sequence of integers [a1,a2,\xe2\x80\xa6,an]. Let s(l,r) be the sum of elements from al to ar (i.\xe2\x80\x89e. s(l,r)=r\xe2\x88\x91i=lai).Let\'s construct another sequence b of size n(n+1)2 as follows: b=[s(1,1),s(1,2),\xe2\x80\xa6,s(1,n),s(2,2),s(2,3),\xe2\x80\xa6,s(2,n),s(3,3),\xe2\x80\xa6,s(n,n)].For example, if a=[1,2,5,10], then b=[1,3,8,18,2,7,17,5,15,10].You are given q queries. During the i-th query, you are given two integers li and ri, and you have to calculate ri\xe2\x88\x91j=libj." 1900
2026C "Action Figures" "binary search,brute force,constructive algorithms,data structures,greedy,implementation" "There is a shop that sells action figures near Monocarp\'s house. A new set of action figures will be released shortly; this set contains n figures, the i-th figure costs i coins and is available for purchase from day i to day n.For each of the n days, Monocarp knows whether he can visit the shop.Every time Monocarp visits the shop, he can buy any number of action figures which are sold in the shop (of course, he cannot buy an action figure that is not yet available for purchase). If Monocarp buys at least two figures during the same day, he gets a discount equal to the cost of the most expensive figure he buys (in other words, he gets the most expensive of the figures he buys for free). Monocarp wants to buy exactly one 1-st figure, one 2-nd figure, ..., one n-th figure from the set. He cannot buy the same figure twice. What is the minimum amount of money he has to spend?" 1500
2026B "Black Cells" "binary search,brute force,constructive algorithms,greedy" "You are given a strip divided into cells, numbered from left to right from 0 to 1018. Initially, all cells are white.You can perform the following operation: choose two white cells i and j, such that i\xe2\x89\xa0j and |i\xe2\x88\x92j|\xe2\x89\xa4k, and paint them black.A list a is given. All cells from this list must be painted black. Additionally, at most one cell that is not in this list can also be painted black. Your task is to determine the minimum value of k for which this is possible." 1300
2026A "Perpendicular Segments" "constructive algorithms,geometry,greedy,math" "You are given a coordinate plane and three integers X, Y, and K. Find two line segments AB and CD such that   the coordinates of points A, B, C, and D are integers;  0\xe2\x89\xa4Ax,Bx,Cx,Dx\xe2\x89\xa4X and 0\xe2\x89\xa4Ay,By,Cy,Dy\xe2\x89\xa4Y;  the length of segment AB is at least K;  the length of segment CD is at least K;  segments AB and CD are perpendicular: if you draw lines that contain AB and CD, they will cross at a right angle. Note that it\'s not necessary for segments to intersect. Segments are perpendicular as long as the lines they induce are perpendicular." 900
2025G "Variable Damage" "data structures,flows" "Monocarp is gathering an army to fight a dragon in a videogame.The army consists of two parts: the heroes and the defensive artifacts. Each hero has one parameter \xe2\x80\x94 his health. Each defensive artifact also has one parameter \xe2\x80\x94 its durability.Before the battle begins, Monocarp distributes artifacts to the heroes so that each hero receives at most one artifact.The battle consists of rounds that proceed as follows:   first, the dragon deals damage equal to 1a+b (a real number without rounding) to each hero, where a is the number of heroes alive and b is the number of active artifacts;  after that, all heroes with health 0 or less die;  finally, some artifacts are deactivated. An artifact with durability x is deactivated when one of the following occurs: the hero holding the artifact either dies or receives x total damage (from the start of the battle). If an artifact is not held by any hero, it is inactive from the beginning of the battle. The battle ends when there are no heroes left alive.Initially, the army is empty. There are q queries: add a hero with health x or an artifact with durability y to the army. After each query, determine the maximum number of rounds that Monocarp can survive if he distributes the artifacts optimally." 3000
2025F "Choose Your Queries" "constructive algorithms,dfs and similar,dp,graphs,greedy,trees" "You are given an array a, consisting of n integers (numbered from 1 to n). Initially, they are all zeroes.You have to process q queries. The i-th query consists of two different integers xi and yi. During the i-th query, you have to choose an integer p (which is either xi or yi) and an integer d (which is either 1 or \xe2\x88\x921), and assign ap=ap+d.After each query, every element of a should be a non-negative integer.Process all queries in such a way that the sum of all elements of a after the last query is the minimum possible." 2700
2025E "Card Game" combinatorics,dp,fft,greedy,math "In the most popular card game in Berland, a deck of n\xc3\x97m cards is used. Each card has two parameters: suit and rank. Suits in the game are numbered from 1 to n, and ranks are numbered from 1 to m. There is exactly one card in the deck for each combination of suit and rank.A card with suit a and rank b can beat a card with suit c and rank d in one of two cases:   a=1, c\xe2\x89\xa01 (a card of suit 1 can beat a card of any other suit);  a=c, b>d (a card can beat any other card of the same suit but of a lower rank). Two players play the game. Before the game starts, they receive exactly half of the deck each. The first player wins if for every card of the second player, he can choose his card that can beat it, and there is no card that is chosen twice (i.\xe2\x80\x89e. there exists a matching of the first player\'s cards with the second player\'s cards such that in each pair the first player\'s card beats the second player\'s card). Otherwise, the second player wins.Your task is to calculate the number of ways to distribute the cards so that the first player wins. Two ways are considered different if there exists a card such that in one way it belongs to the first player and in the other way it belongs to the second player. The number of ways can be very large, so print it modulo 998244353." 2200
2025D "Attribute Checks" "brute force,data structures,dp,implementation,math,two pointers" "Imagine a game where you play as a character that has two attributes: ""Strength"" and ""Intelligence"", that are at zero level initially.During the game, you\'ll acquire m attribute points that allow you to increase your attribute levels \xe2\x80\x94 one point will increase one of the attributes by one level. But sometimes, you\'ll encounter a so-called ""Attribute Checks"": if your corresponding attribute is high enough, you\'ll pass it; otherwise, you\'ll fail it.Spending some time, you finally prepared a list which contains records of all points you got and all checks you\'ve met. And now you\'re wondering: what is the maximum number of attribute checks you can pass in a single run if you\'d spend points wisely?Note that you can\'t change the order of records." 1800
2025C "New Game" "binary search,brute force,greedy,implementation,sortings,two pointers" "There\'s a new game Monocarp wants to play. The game uses a deck of n cards, where the i-th card has exactly one integer ai written on it.At the beginning of the game, on the first turn, Monocarp can take any card from the deck. During each subsequent turn, Monocarp can take exactly one card that has either the same number as on the card taken on the previous turn or a number that is one greater than the number on the card taken on the previous turn.In other words, if on the previous turn Monocarp took a card with the number x, then on the current turn he can take either a card with the number x or a card with the number x+1. Monocarp can take any card which meets that condition, regardless of its position in the deck.After Monocarp takes a card on the current turn, it is removed from the deck.According to the rules of the game, the number of distinct numbers written on the cards that Monocarp has taken must not exceed k.If, after a turn, Monocarp cannot take a card without violating the described rules, the game ends.Your task is to determine the maximum number of cards that Monocarp can take from the deck during the game, given that on the first turn he can take any card from the deck." 1300
2025B "Binomial Coefficients, Kind Of" combinatorics,dp,math "Recently, akshiM met a task that needed binomial coefficients to solve. He wrote a code he usually does that looked like this:    for (int n = 0; n < N; n++) { // loop over n from 0 to N-1 (inclusive)        C[n][0] = 1;        C[n][n] = 1;        for (int k = 1; k < n; k++) // loop over k from 1 to n-1 (inclusive)            C[n][k] = C[n][k - 1] + C[n - 1][k - 1];    }Unfortunately, he made an error, since the right formula is the following:            C[n][k] = C[n - 1][k] + C[n - 1][k - 1]But his team member keblidA is interested in values that were produced using the wrong formula. Please help him to calculate these coefficients for t various pairs (ni,ki). Note that they should be calculated according to the first (wrong) formula.Since values C[ni][ki] may be too large, print them modulo 109+7." 1100
2025A "Two Screens" "binary search,greedy,strings,two pointers" "There are two screens which can display sequences of uppercase Latin letters. Initially, both screens display nothing.In one second, you can do one of the following two actions:  choose a screen and an uppercase Latin letter, and append that letter to the end of the sequence displayed on that screen;  choose a screen and copy the sequence from it to the other screen, overwriting the sequence that was displayed on the other screen. You have to calculate the minimum number of seconds you have to spend so that the first screen displays the sequence s, and the second screen displays the sequence t." 800
2024B "Buying Lemonade" "binary search,constructive algorithms,sortings" "There is a vending machine that sells lemonade. The machine has a total of n slots. You know that initially, the i-th slot contains ai cans of lemonade. There are also n buttons on the machine, each button corresponds to a slot, with exactly one button corresponding to each slot. Unfortunately, the labels on the buttons have worn off, so you do not know which button corresponds to which slot.When you press the button corresponding to the i-th slot, one of two events occurs: If there is a can of lemonade in the i-th slot, it will drop out and you will take it. At this point, the number of cans in the i-th slot decreases by 1. If there are no cans of lemonade left in the i-th slot, nothing will drop out. After pressing, the can drops out so quickly that it is impossible to track from which slot it fell. The contents of the slots are hidden from your view, so you cannot see how many cans are left in each slot. The only thing you know is the initial number of cans in the slots: a1,a2,\xe2\x80\xa6,an.Determine the minimum number of button presses needed to guarantee that you receive at least k cans of lemonade.Note that you can adapt your strategy during the button presses based on whether you received a can or not. It is guaranteed that there are at least k cans of lemonade in total in the machine. In other words, k\xe2\x89\xa4a1+a2+\xe2\x80\xa6+an." 1100
2024A "Profitable Interest Rate" greedy,math "Alice has a coins. She can open a bank deposit called ""Profitable"", but the minimum amount required to open this deposit is b coins.There is also a deposit called ""Unprofitable"", which can be opened with any amount of coins. Alice noticed that if she opens the ""Unprofitable"" deposit with x coins, the minimum amount required to open the ""Profitable"" deposit decreases by 2x coins. However, these coins cannot later be deposited into the ""Profitable"" deposit.Help Alice determine the maximum number of coins she can deposit into the ""Profitable"" deposit if she first deposits some amount of coins (possibly 0) into the ""Unprofitable"" deposit. If Alice can never open the ""Profitable"" deposit, output 0." 800
2023F "Hills and Pits" "data structures,greedy,math,matrices" "In a desert city with a hilly landscape, the city hall decided to level the road surface by purchasing a dump truck. The road is divided into n sections, numbered from 1 to n from left to right. The height of the surface in the i-th section is equal to ai. If the height of the i-th section is greater than 0, then the dump truck must take sand from the i-th section of the road, and if the height of the i-th section is less than 0, the dump truck must fill the pit in the i-th section of the road with sand. It is guaranteed that the initial heights are not equal to 0.When the dump truck is in the i-th section of the road, it can either take away x units of sand, in which case the height of the surface in the i-th section will decrease by x, or it can fill in x units of sand (provided that it currently has at least x units of sand in its bed), in which case the height of the surface in the i-th section of the road will increase by x.The dump truck can start its journey from any section of the road. Moving to an adjacent section on the left or right takes 1 minute, and the time for loading and unloading sand can be neglected. The dump truck has an infinite capacity and is initially empty.You need to find the minimum time required for the dump truck to level the sand so that the height in each section becomes equal to 0. Note that after all movements, the dump truck may still have sand left in its bed. You need to solve this problem independently for the segments numbered from li to ri. Sand outside the segment cannot be used." 3500
2023E "Tree of Life" dp,greedy,trees "In the heart of an ancient kingdom grows the legendary Tree of Life \xe2\x80\x94 the only one of its kind and the source of magical power for the entire world. The tree consists of n nodes. Each node of this tree is a magical source, connected to other such sources through magical channels (edges). In total, there are n\xe2\x88\x921 channels in the tree, with the i-th channel connecting nodes vi and ui. Moreover, there exists a unique simple path through the channels between any two nodes in the tree.However, the magical energy flowing through these channels must be balanced; otherwise, the power of the Tree of Life may disrupt the natural order and cause catastrophic consequences. The sages of the kingdom discovered that when two magical channels converge at a single node, a dangerous ""magical resonance vibration"" occurs between them. To protect the Tree of Life and maintain its balance, it is necessary to select several paths and perform special rituals along them. A path is a sequence of distinct nodes v1,v2,\xe2\x80\xa6,vk, where each pair of adjacent nodes vi and vi+1 is connected by a channel. When the sages perform a ritual along such a path, the resonance vibration between the channels (vi,vi+1) and (vi+1,vi+2) is blocked for each 1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x922.The sages\' task is to select the minimum number of paths and perform rituals along them to block all resonance vibrations. This means that for every pair of channels emanating from a single node, there must exist at least one selected path that contains both of these channels.Help the sages find the minimum number of such paths so that the magical balance of the Tree of Life is preserved, and its power continues to nourish the entire world!" 3300
2023D "Many Games" "brute force,dp,greedy,math,probabilities" "Recently, you received a rare ticket to the only casino in the world where you can actually earn something, and you want to take full advantage of this opportunity.The conditions in this casino are as follows:   There are a total of n games in the casino.  You can play each game at most once.  Each game is characterized by two parameters: pi (1\xe2\x89\xa4pi\xe2\x89\xa4100) and wi \xe2\x80\x94 the probability of winning the game in percentage and the winnings for a win.  If you lose in any game you decide to play, you will receive nothing at all (even for the games you won). You need to choose a set of games in advance that you will play in such a way as to maximize the expected value of your winnings.In this case, if you choose to play the games with indices i1<i2<\xe2\x80\xa6<ik, you will win in all of them with a probability of k\xe2\x88\x8fj=1pij100, and in that case, your winnings will be equal to k\xe2\x88\x91j=1wij.That is, the expected value of your winnings will be (k\xe2\x88\x8fj=1pij100)\xe2\x8b\x85(k\xe2\x88\x91j=1wij).To avoid going bankrupt, the casino owners have limited the expected value of winnings for each individual game. Thus, for all i (1\xe2\x89\xa4i\xe2\x89\xa4n), it holds that wi\xe2\x8b\x85pi\xe2\x89\xa42\xe2\x8b\x85105.Your task is to find the maximum expected value of winnings that can be obtained by choosing some set of games in the casino." 2900
2023C C+K+S "constructive algorithms,dfs and similar,graphs,greedy,hashing,implementation,strings" "You are given two strongly connected\xe2\x80\xa0 directed graphs, each with exactly n vertices, but possibly different numbers of edges. Upon closer inspection, you noticed an important feature \xe2\x80\x94 the length of any cycle in these graphs is divisible by k.Each of the 2n vertices belongs to exactly one of two types: incoming or outgoing. For each vertex, its type is known to you.You need to determine whether it is possible to draw exactly n directed edges between the source graphs such that the following four conditions are met:   The ends of any added edge lie in different graphs.  From each outgoing vertex, exactly one added edge originates.  Into each incoming vertex, exactly one added edge enters.  In the resulting graph, the length of any cycle is divisible by k. \xe2\x80\xa0A strongly connected graph is a graph in which there is a path from every vertex to every other vertex." 2400
2023B Skipping "binary search,dp,graphs,shortest paths" "It is already the year 3024, ideas for problems have long run out, and the olympiad now takes place in a modified individual format. The olympiad consists of n problems, numbered from 1 to n. The i-th problem has its own score ai and a certain parameter bi (1\xe2\x89\xa4bi\xe2\x89\xa4n).Initially, the testing system gives the participant the first problem. When the participant is given the i-th problem, they have two options:   They can submit the problem and receive ai points;  They can skip the problem, in which case they will never be able to submit it. Then, the testing system selects the next problem for the participant from problems with indices j, such that:   If he submitted the i-th problem, it looks at problems with indices j<i;  If he skipped the i-th problem, it looks at problems with indices j\xe2\x89\xa4bi. Among these problems, it selects the problem with the maximum index that it has not previously given to the participant (he has neither submitted nor skipped it before). If there is no such problem, then the competition for the participant ends, and their result is equal to the sum of points for all submitted problems. In particular, if the participant submits the first problem, then the competition for them ends. Note that the participant receives each problem at most once.Prokhor has prepared thoroughly for the olympiad, and now he can submit any problem. Help him determine the maximum number of points he can achieve." 1700
2023A "Concatenation of Arrays" "constructive algorithms,greedy,math,sortings" "You are given n arrays a1, \xe2\x80\xa6, an. The length of each array is two. Thus, ai=[ai,1,ai,2]. You need to concatenate the arrays into a single array of length 2n such that the number of inversions\xe2\x80\xa0 in the resulting array is minimized. Note that you do not need to count the actual number of inversions.More formally, you need to choose a permutation\xe2\x80\xa1 p of length n, so that the array b=[ap1,1,ap1,2,ap2,1,ap2,2,\xe2\x80\xa6,apn,1,apn,2] contains as few inversions as possible.\xe2\x80\xa0The number of inversions in an array c is the number of pairs of indices i and j such that i<j and ci>cj.\xe2\x80\xa1A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1300
2022E2 "Billetes MX (Hard Version)" "binary search,combinatorics,data structures,dsu,graphs" "This is the hard version of the problem. In this version, it is guaranteed that q\xe2\x89\xa4105. You can make hacks only if both versions of the problem are solved.An integer grid A with p rows and q columns is called beautiful if:   All elements of the grid are integers between 0 and 230\xe2\x88\x921, and  For any subgrid, the XOR of the values at the corners is equal to 0. Formally, for any four integers i1, i2, j1, j2 (1\xe2\x89\xa4i1<i2\xe2\x89\xa4p; 1\xe2\x89\xa4j1<j2\xe2\x89\xa4q), Ai1,j1\xe2\x8a\x95Ai1,j2\xe2\x8a\x95Ai2,j1\xe2\x8a\x95Ai2,j2=0, where \xe2\x8a\x95 denotes the bitwise XOR operation. There is a partially filled integer grid G with n rows and m columns where only k cells are filled. Polycarp wants to know how many ways he can assign integers to the unfilled cells so that the grid is beautiful.However, Monocarp thinks that this problem is too easy. Therefore, he will perform q updates on the grid. In each update, he will choose an unfilled cell and assign an integer to it. Note that these updates are persistent. That is, changes made to the grid will apply when processing future updates.For each of the q+1 states of the grid, the initial state and after each of the q queries, determine the number of ways Polycarp can assign integers to the unfilled cells so that the grid is beautiful. Since this number can be very large, you are only required to output their values modulo 109+7." 2600
2022E1 "Billetes MX (Easy Version)" "2-sat,binary search,combinatorics,constructive algorithms,dfs and similar,dsu,graphs" "This is the easy version of the problem. In this version, it is guaranteed that q=0. You can make hacks only if both versions of the problem are solved.An integer grid A with p rows and q columns is called beautiful if:   All elements of the grid are integers between 0 and 230\xe2\x88\x921, and  For any subgrid, the XOR of the values at the corners is equal to 0. Formally, for any four integers i1, i2, j1, j2 (1\xe2\x89\xa4i1<i2\xe2\x89\xa4p; 1\xe2\x89\xa4j1<j2\xe2\x89\xa4q), Ai1,j1\xe2\x8a\x95Ai1,j2\xe2\x8a\x95Ai2,j1\xe2\x8a\x95Ai2,j2=0, where \xe2\x8a\x95 denotes the bitwise XOR operation. There is a partially filled integer grid G with n rows and m columns where only k cells are filled. Polycarp wants to know how many ways he can assign integers to the unfilled cells so that the grid is beautiful.However, Monocarp thinks that this problem is too easy. Therefore, he will perform q updates on the grid. In each update, he will choose an unfilled cell and assign an integer to it. Note that these updates are persistent. That is, changes made to the grid will apply when processing future updates.For each of the q+1 states of the grid, the initial state and after each of the q queries, determine the number of ways Polycarp can assign integers to the unfilled cells so that the grid is beautiful. Since this number can be very large, you are only required to output their values modulo 109+7." 2500
2022D2 "Asesino (Hard Version)" "constructive algorithms,dp,interactive" "This is the hard version of the problem. In this version, you must use the minimum number of queries possible. You can make hacks only if both versions of the problem are solved.This is an interactive problem.It is a tradition in Mexico\'s national IOI trainings to play the game ""Asesino"", which is similar to ""Among Us"" or ""Mafia"".Today, n players, numbered from 1 to n, will play ""Asesino"" with the following three roles:  Knight: a Knight is someone who always tells the truth.  Knave: a Knave is someone who always lies.  Impostor: an Impostor is someone everybody thinks is a Knight, but is secretly a Knave. Each player will be assigned a role in the game. There will be exactly one Impostor but there can be any (possible zero) number of Knights and Knaves.As the game moderator, you have accidentally forgotten the roles of everyone, but you need to determine the player who is the Impostor.To determine the Impostor, you will ask some questions. In each question, you will pick two players i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n; i\xe2\x89\xa0j) and ask if player i thinks that player j is a Knight. The results of the question is shown in the table below. KnightKnaveImpostorKnightYesNoYesKnaveNoYesNoImpostorNoYes\xe2\x80\x94 The response of the cell in row a and column b is the result of asking a question when i has role a and j has row b. For example, the ""Yes"" in the top right cell belongs to row ""Knight"" and column ""Impostor"", so it is the response when i is a Knight and j is an Impostor. Find the Impostor in the minimum number of queries possible. That is, let f(n) be the minimum integer such that for n players, there exists a strategy that can determine the Impostor using at most f(n) questions. Then, you should use at most f(n) questions to determine the Impostor.Note: the grader is adaptive: the roles of the players are not fixed in the beginning and may change depending on your questions. However, it is guaranteed that there exists an assignment of roles that is consistent with all previously asked questions under the constraints of this problem." 2700
2022D1 "Asesino (Easy Version)" "binary search,brute force,constructive algorithms,implementation,interactive" "This is the easy version of the problem. In this version, you can ask at most n+69 questions. You can make hacks only if both versions of the problem are solved.This is an interactive problem.It is a tradition in Mexico\'s national IOI trainings to play the game ""Asesino"", which is similar to ""Among Us"" or ""Mafia"".Today, n players, numbered from 1 to n, will play ""Asesino"" with the following three roles:  Knight: a Knight is someone who always tells the truth.  Knave: a Knave is someone who always lies.  Impostor: an Impostor is someone everybody thinks is a Knight, but is secretly a Knave. Each player will be assigned a role in the game. There will be exactly one Impostor but there can be any (possible zero) number of Knights and Knaves.As the game moderator, you have accidentally forgotten the roles of everyone, but you need to determine the player who is the Impostor.To determine the Impostor, you will ask some questions. In each question, you will pick two players i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n; i\xe2\x89\xa0j) and ask if player i thinks that player j is a Knight. The results of the question is shown in the table below. KnightKnaveImpostorKnightYesNoYesKnaveNoYesNoImpostorNoYes\xe2\x80\x94 The response of the cell in row a and column b is the result of asking a question when i has role a and j has row b. For example, the ""Yes"" in the top right cell belongs to row ""Knight"" and column ""Impostor"", so it is the response when i is a Knight and j is an Impostor. Find the Impostor in at most n+69 questions.Note: the grader is adaptive: the roles of the players are not fixed in the beginning and may change depending on your questions. However, it is guaranteed that there exists an assignment of roles that is consistent with all previously asked questions under the constraints of this problem." 1900
2022C Gerrymandering dp,implementation "We all steal a little bit. But I have only one hand, while my adversaries have two.\xc3\x81lvaro Obreg\xc3\xb3n\xc3\x81lvaro and Jos\xc3\xa9 are the only candidates running for the presidency of Tepito, a rectangular grid of 2 rows and n columns, where each cell represents a house. It is guaranteed that n is a multiple of 3.Under the voting system of Tepito, the grid will be split into districts, which consist of any 3 houses that are connected\xe2\x88\x97. Each house will belong to exactly one district.Each district will cast a single vote. The district will vote for \xc3\x81lvaro or Jos\xc3\xa9 respectively if at least 2 houses in that district select them. Therefore, a total of 2n3 votes will be cast.As \xc3\x81lvaro is the current president, he knows exactly which candidate each house will select. If \xc3\x81lvaro divides the houses into districts optimally, determine the maximum number of votes he can get.\xe2\x88\x97A set of cells is connected if there is a path between any 2 cells that requires moving only up, down, left and right through cells in the set." 1800
2022B "Kar Salesman" "binary search,greedy,math" "Karel is a salesman in a car dealership. The dealership has n different models of cars. There are ai cars of the i-th model. Karel is an excellent salesperson and can convince customers to buy up to x cars (of Karel\'s choice), as long as the cars are from different models.Determine the minimum number of customers Karel has to bring in to sell all the cars." 1300
2022A "Bus to P\xc3\xa9njamo" "constructive algorithms,greedy,implementation,math" "Ya vamos llegando a P\xc3\xa9eeenjamoo \xe2\x99\xab\xe2\x99\xab\xe2\x99\xab  There are n families travelling to P\xc3\xa9njamo to witness Mexico\'s largest-ever ""walking a chicken on a leash"" marathon. The i-th family has ai family members. All families will travel using a single bus consisting of r rows with 2 seats each.A person is considered happy if:   Another family member is seated in the same row as them, or  They are sitting alone in their row (with an empty seat next to them). Determine the maximum number of happy people in an optimal seating arrangement. Note that everyone must be seated in the bus.It is guaranteed that all family members will fit on the bus. Formally, it is guaranteed that n\xe2\x88\x91i=1ai\xe2\x89\xa42r." 800
2021E3 "Digital Village (Extreme Version)" "data structures,dfs and similar,dp,dsu,graphs,greedy,math,trees" "This is the extreme version of the problem. In the three versions, the constraints on n and m are different. You can make hacks only if all the versions of the problem are solved.Pak Chanek is setting up internet connections for the village of Khuntien. The village can be represented as a connected simple graph with n houses and m internet cables connecting house ui and house vi, each with a latency of wi.There are p houses that require internet. Pak Chanek can install servers in at most k of the houses. The houses that need internet will then be connected to one of the servers. However, since each cable has its latency, the latency experienced by house si requiring internet will be the maximum latency of the cables between that house and the server it is connected to.For each k=1,2,\xe2\x80\xa6,n, help Pak Chanek determine the minimum total latency that can be achieved for all the houses requiring internet." 2800
2021E2 "Digital Village (Hard Version)" "data structures,dp,dsu,graphs,math,trees" "This is the hard version of the problem. In the three versions, the constraints on n and m are different. You can make hacks only if all the versions of the problem are solved.Pak Chanek is setting up internet connections for the village of Khuntien. The village can be represented as a connected simple graph with n houses and m internet cables connecting house ui and house vi, each with a latency of wi.There are p houses that require internet. Pak Chanek can install servers in at most k of the houses. The houses that need internet will then be connected to one of the servers. However, since each cable has its latency, the latency experienced by house si requiring internet will be the maximum latency of the cables between that house and the server it is connected to.For each k=1,2,\xe2\x80\xa6,n, help Pak Chanek determine the minimum total latency that can be achieved for all the houses requiring internet." 2500
2021E1 "Digital Village (Easy Version)" "brute force,data structures,dfs and similar,dp,dsu,fft,graphs,greedy,implementation,math,trees" "This is the easy version of the problem. In the three versions, the constraints on n and m are different. You can make hacks only if all the versions of the problem are solved.Pak Chanek is setting up internet connections for the village of Khuntien. The village can be represented as a connected simple graph with n houses and m internet cables connecting house ui and house vi, each with a latency of wi.There are p houses that require internet. Pak Chanek can install servers in at most k of the houses. The houses that need internet will then be connected to one of the servers. However, since each cable has its latency, the latency experienced by house si requiring internet will be the maximum latency of the cables between that house and the server it is connected to.For each k=1,2,\xe2\x80\xa6,n, help Pak Chanek determine the minimum total latency that can be achieved for all the houses requiring internet." 2300
2021D "Boss, Thirsty" dp,greedy,implementation "Pak Chanek has a friend who runs a drink stall in a canteen. His friend will sell drinks for nn days, numbered from day 11 to day nn. There are also mm types of drinks, numbered from 11 to mm.The profit gained from selling a drink on a particular day can vary. On day ii, the projected profit from selling drink of type jj is Ai,jAi,j. Note that Ai,jAi,j can be negative, meaning that selling the drink would actually incur a loss.Pak Chanek wants to help his friend plan the sales over the nn days. On day ii, Pak Chanek must choose to sell at least one type of drink. Furthermore, the types of drinks sold on a single day must form a subarray. In other words, in each day, Pak Chanek will select ii and jj such that 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4m1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4m. Then all types of drinks between ii and jj (inclusive) will be sold.However, to ensure that customers from the previous day keep returning, the selection of drink types sold on day ii (i>1i>1) must meet the following conditions:  At least one drink type sold on day ii must also have been sold on day i\xe2\x88\x921i\xe2\x88\x921.  At least one drink type sold on day ii must not have been sold on day i\xe2\x88\x921i\xe2\x88\x921. The daily profit is the sum of the profits from all drink types sold on that day. The total profit from the sales plan is the sum of the profits over nn days. What is the maximum total profit that can be achieved if Pak Chanek plans the sales optimally?" 2500
2021C2 "Adjust The Presentation (Hard Version)" "constructive algorithms,data structures,greedy,implementation,sortings" "This is the hard version of the problem. In the two versions, the constraints on q and the time limit are different. In this version, 0\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x85105. You can make hacks only if all the versions of the problem are solved.A team consisting of n members, numbered from 1 to n, is set to present a slide show at a large meeting. The slide show contains m slides.There is an array a of length n. Initially, the members are standing in a line in the order of a1,a2,\xe2\x80\xa6,an from front to back. The slide show will be presented in order from slide 1 to slide m. Each section will be presented by the member at the front of the line. After each slide is presented, you can move the member at the front of the line to any position in the lineup (without changing the order of the rest of the members). For example, suppose the line of members is [3,1,2,4]. After member 3 presents the current slide, you can change the line of members into either [3,1,2,4], [1,3,2,4], [1,2,3,4] or [1,2,4,3].There is also an array b of length m. The slide show is considered good if it is possible to make member bi present slide i for all i from 1 to m under these constraints.However, your annoying boss wants to make q updates to the array b. In the i-th update, he will choose a slide si and a member ti and set bsi:=ti. Note that these updates are persistent, that is changes made to the array b will apply when processing future updates.For each of the q+1 states of array b, the initial state and after each of the q updates, determine if the slideshow is good." 1900
2021C1 "Adjust The Presentation (Easy Version)" "constructive algorithms,greedy" "This is the easy version of the problem. In the two versions, the constraints on q and the time limit are different. In this version, q=0. You can make hacks only if all the versions of the problem are solved.A team consisting of n members, numbered from 1 to n, is set to present a slide show at a large meeting. The slide show contains m slides.There is an array a of length n. Initially, the members are standing in a line in the order of a1,a2,\xe2\x80\xa6,an from front to back. The slide show will be presented in order from slide 1 to slide m. Each section will be presented by the member at the front of the line. After each slide is presented, you can move the member at the front of the line to any position in the lineup (without changing the order of the rest of the members). For example, suppose the line of members is [3,1,2,4]. After member 3 presents the current slide, you can change the line of members into either [3,1,2,4], [1,3,2,4], [1,2,3,4] or [1,2,4,3].There is also an array b of length m. The slide show is considered good if it is possible to make member bi present slide i for all i from 1 to m under these constraints.However, your annoying boss wants to make q updates to the array b. In the i-th update, he will choose a slide si and a member ti and set bsi:=ti. Note that these updates are persistent, that is changes made to the array b will apply when processing future updates.For each of the q+1 states of array b, the initial state and after each of the q updates, determine if the slideshow is good." 1300
2021B "Maximize Mex" "brute force,greedy,math,number theory" "You are given an array a of n positive integers and an integer x. You can do the following two-step operation any (possibly zero) number of times:   Choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n).  Increase ai by x, in other words ai:=ai+x. Find the maximum value of the MEX of a if you perform the operations optimally.The MEX (minimum excluded value) of an array is the smallest non-negative integer that is not in the array. For example:   The MEX of [2,2,1] is 0 because 0 is not in the array.  The MEX of [3,1,0,1] is 2 because 0 and 1 are in the array but 2 is not.  The MEX of [0,3,1,2] is 4 because 0, 1, 2 and 3 are in the array but 4 is not." 1200
2021A "Meaning Mean" "data structures,greedy,math,sortings" "Pak Chanek has an array a of n positive integers. Since he is currently learning how to calculate the floored average of two numbers, he wants to practice it on his array a.While the array a has at least two elements, Pak Chanek will perform the following three-step operation:   Pick two different indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4|a|; i\xe2\x89\xa0j), note that |a| denotes the current size of the array a.  Append \xe2\x8c\x8aai+aj2\xe2\x8c\x8b\xe2\x88\x97 to the end of the array.  Remove elements ai and aj from the array and concatenate the remaining parts of the array. For example, suppose that a=[5,4,3,2,1,1]. If we choose i=1 and j=5, the resulting array will be a=[4,3,2,1,3]. If we choose i=4 and j=3, the resulting array will be a=[5,4,1,1,2].After all operations, the array will consist of a single element x. Find the maximum possible value of x if Pak Chanek performs the operations optimally.\xe2\x88\x97\xe2\x8c\x8ax\xe2\x8c\x8b denotes the floor function of x, which is the greatest integer that is less than or equal to x. For example, \xe2\x8c\x8a6\xe2\x8c\x8b=6, \xe2\x8c\x8a2.5\xe2\x8c\x8b=2, \xe2\x8c\x8a\xe2\x88\x923.6\xe2\x8c\x8b=\xe2\x88\x924 and \xe2\x8c\x8a\xcf\x80\xe2\x8c\x8b=3" 800
2020F "Count Leaves" "dp,math,number theory" "Let n and d be positive integers. We build the the divisor tree Tn,d as follows:  The root of the tree is a node marked with number n. This is the 0-th layer of the tree.  For each i from 0 to d\xe2\x88\x921, for each vertex of the i-th layer, do the following. If the current vertex is marked with x, create its children and mark them with all possible distinct divisors\xe2\x80\xa0 of x. These children will be in the (i+1)-st layer.  The vertices on the d-th layer are the leaves of the tree. For example, T6,2 (the divisor tree for n=6 and d=2) looks like this:  Define f(n,d) as the number of leaves in Tn,d.Given integers n, k, and d, please compute n\xe2\x88\x91i=1f(ik,d), modulo 109+7.\xe2\x80\xa0 In this problem, we say that an integer y is a divisor of x if y\xe2\x89\xa51 and there exists an integer z such that x=y\xe2\x8b\x85z." 2900
2020E "Expected Power" bitmasks,dp,math,probabilities "You are given an array of n integers a1,a2,\xe2\x80\xa6,an. You are also given an array p1,p2,\xe2\x80\xa6,pn.Let S denote the random multiset (i. e., it may contain equal elements) constructed as follows:  Initially, S is empty.  For each i from 1 to n, insert ai into S with probability pi104. Note that each element is inserted independently. Denote f(S) as the bitwise XOR of all elements of S. Please calculate the expected value of (f(S))2. Output the answer modulo 109+7.Formally, let M=109+7. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 2000
2020D "Connect the Dots" "brute force,dp,dsu,graphs,math,trees" "One fine evening, Alice sat down to play the classic game ""Connect the Dots"", but with a twist.To play the game, Alice draws a straight line and marks n points on it, indexed from 1 to n. Initially, there are no arcs between the points, so they are all disjoint. After that, Alice performs m operations of the following type:  She picks three integers ai, di (1\xe2\x89\xa4di\xe2\x89\xa410), and ki.  She selects points ai,ai+di,ai+2di,ai+3di,\xe2\x80\xa6,ai+ki\xe2\x8b\x85di and connects each pair of these points with arcs. After performing all m operations, she wants to know the number of connected components\xe2\x80\xa0 these points form. Please help her find this number.\xe2\x80\xa0 Two points are said to be in one connected component if there is a path between them via several (possibly zero) arcs and other points." 1800
2020C "Bitwise Balancing" "bitmasks,hashing,implementation,math,schedules,ternary search" "You are given three non-negative integers b, c, and d.Please find a non-negative integer a\xe2\x88\x88[0,261] such that (a|b)\xe2\x88\x92(a&c)=d, where | and & denote the bitwise OR operation and the bitwise AND operation, respectively.If such an a exists, print its value. If there is no solution, print a single integer \xe2\x88\x921. If there are multiple solutions, print any of them." 1400
2020B "Brightness Begins" "binary search,math" "Imagine you have n light bulbs numbered 1,2,\xe2\x80\xa6,n. Initially, all bulbs are on. To flip the state of a bulb means to turn it off if it used to be on, and to turn it on otherwise.Next, you do the following:  for each i=1,2,\xe2\x80\xa6,n, flip the state of all bulbs j such that j is divisible by i\xe2\x80\xa0. After performing all operations, there will be several bulbs that are still on. Your goal is to make this number exactly k.Find the smallest suitable n such that after performing the operations there will be exactly k bulbs on. We can show that an answer always exists.\xe2\x80\xa0 An integer x is divisible by y if there exists an integer z such that x=y\xe2\x8b\x85z." 1200
2020A "Find Minimum Operations" "bitmasks,brute force,greedy,math,number theory" "You are given two integers n and k.In one operation, you can subtract any power of k from n. Formally, in one operation, you can replace n by (n\xe2\x88\x92kx) for any non-negative integer x.Find the minimum number of operations required to make n equal to 0." 800
2019B "All Pairs Segments" implementation,math "Shirobon - FOX\xe2\xa0\x80You are given n points on the x axis, at increasing positive integer coordinates x1<x2<\xe2\x80\xa6<xn.For each pair (i,j) with 1\xe2\x89\xa4i<j\xe2\x89\xa4n, you draw the segment [xi,xj]. The segments are closed, i.e., a segment [a,b] contains the points a,a+1,\xe2\x80\xa6,b.You are given q queries. In the i-th query, you are given a positive integer ki, and you have to determine how many points with integer coordinates are contained in exactly ki segments." 1200
2019A "Max Plus Size" "brute force,dp,greedy" "EnV - Dynasty\xe2\xa0\x80You are given an array a1,a2,\xe2\x80\xa6,an of positive integers.You can color some elements of the array red, but there cannot be two adjacent red elements (i.e., for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, at least one of ai and ai+1 must not be red).Your score is the maximum value of a red element plus the number of red elements. Find the maximum score you can get." 800
2018F3 "Speedbreaker Counting (Hard Version)" dp,greedy,math "NightHawk22 - Isolation\xe2\xa0\x80This is the hard version of the problem. In the three versions, the constraints on n and the time limit are different. You can make hacks only if all the versions of the problem are solved.This is the statement of Problem D1B:  There are n cities in a row, numbered 1,2,\xe2\x80\xa6,n left to right.  At time 1, you conquer exactly one city, called the starting city.  At time 2,3,\xe2\x80\xa6,n, you can choose a city adjacent to the ones conquered so far and conquer it. You win if, for each i, you conquer city i at a time no later than ai. A winning strategy may or may not exist, also depending on the starting city. How many starting cities allow you to win? For each 0\xe2\x89\xa4k\xe2\x89\xa4n, count the number of arrays of positive integers a1,a2,\xe2\x80\xa6,an such that  1\xe2\x89\xa4ai\xe2\x89\xa4n for each 1\xe2\x89\xa4i\xe2\x89\xa4n;  the answer to Problem D1B is k. The answer can be very large, so you have to calculate it modulo a given prime p." 3100
2018F2 "Speedbreaker Counting (Medium Version)" dp,greedy,math "NightHawk22 - Isolation\xe2\xa0\x80This is the medium version of the problem. In the three versions, the constraints on n and the time limit are different. You can make hacks only if all the versions of the problem are solved.This is the statement of Problem D1B:  There are n cities in a row, numbered 1,2,\xe2\x80\xa6,n left to right.  At time 1, you conquer exactly one city, called the starting city.  At time 2,3,\xe2\x80\xa6,n, you can choose a city adjacent to the ones conquered so far and conquer it. You win if, for each i, you conquer city i at a time no later than ai. A winning strategy may or may not exist, also depending on the starting city. How many starting cities allow you to win? For each 0\xe2\x89\xa4k\xe2\x89\xa4n, count the number of arrays of positive integers a1,a2,\xe2\x80\xa6,an such that  1\xe2\x89\xa4ai\xe2\x89\xa4n for each 1\xe2\x89\xa4i\xe2\x89\xa4n;  the answer to Problem D1B is k. The answer can be very large, so you have to calculate it modulo a given prime p." 3000
2018F1 "Speedbreaker Counting (Easy Version)" combinatorics,dp,greedy,math "NightHawk22 - Isolation\xe2\xa0\x80This is the easy version of the problem. In the three versions, the constraints on n and the time limit are different. You can make hacks only if all the versions of the problem are solved.This is the statement of Problem D1B:  There are n cities in a row, numbered 1,2,\xe2\x80\xa6,n left to right.  At time 1, you conquer exactly one city, called the starting city.  At time 2,3,\xe2\x80\xa6,n, you can choose a city adjacent to the ones conquered so far and conquer it. You win if, for each i, you conquer city i at a time no later than ai. A winning strategy may or may not exist, also depending on the starting city. How many starting cities allow you to win? For each 0\xe2\x89\xa4k\xe2\x89\xa4n, count the number of arrays of positive integers a1,a2,\xe2\x80\xa6,an such that  1\xe2\x89\xa4ai\xe2\x89\xa4n for each 1\xe2\x89\xa4i\xe2\x89\xa4n;  the answer to Problem D1B is k. The answer can be very large, so you have to calculate it modulo a given prime p." 2900
2018E2 "Complex Segments (Hard Version)" "binary search,data structures,divide and conquer,dsu,greedy,math,sortings" "Ken Arai - COMPLEX\xe2\xa0\x80This is the hard version of the problem. In this version, the constraints on n and the time limit are higher. You can make hacks only if both versions of the problem are solved.A set of (closed) segments is complex if it can be partitioned into some subsets such that   all the subsets have the same size; and  a pair of segments intersects if and only if the two segments are in the same subset. You are given n segments [l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn]. Find the maximum size of a complex subset of these segments." 3400
2018E1 "Complex Segments (Easy Version)" "binary search,data structures,divide and conquer,dsu,greedy,math,sortings" "Ken Arai - COMPLEX\xe2\xa0\x80This is the easy version of the problem. In this version, the constraints on n and the time limit are lower. You can make hacks only if both versions of the problem are solved.A set of (closed) segments is complex if it can be partitioned into some subsets such that   all the subsets have the same size; and  a pair of segments intersects if and only if the two segments are in the same subset. You are given n segments [l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn]. Find the maximum size of a complex subset of these segments." 3300
2018D "Max Plus Min Plus Size" "data structures,dp,dsu,greedy,implementation,matrices,sortings" "EnV - The Dusty Dragon Tavern\xe2\xa0\x80You are given an array a1,a2,\xe2\x80\xa6,an of positive integers.You can color some elements of the array red, but there cannot be two adjacent red elements (i.e., for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, at least one of ai and ai+1 must not be red).Your score is the maximum value of a red element, plus the minimum value of a red element, plus the number of red elements. Find the maximum score you can get." 2200
2018C "Tree Pruning" "brute force,dfs and similar,greedy,sortings,trees" "t+pazolite, ginkiha, Hommarju - Paved Garden\xe2\xa0\x80You are given a tree with n nodes, rooted at node 1. In this problem, a leaf is a non-root node with degree 1.In one operation, you can remove a leaf and the edge adjacent to it (possibly, new leaves appear). What is the minimum number of operations that you have to perform to get a tree, also rooted at node 1, where all the leaves are at the same distance from the root?" 1700
2018B Speedbreaker "binary search,data structures,dp,greedy,implementation,two pointers" "Djjaner - Speedbreaker\xe2\xa0\x80There are n cities in a row, numbered 1,2,\xe2\x80\xa6,n left to right.  At time 1, you conquer exactly one city, called the starting city.  At time 2,3,\xe2\x80\xa6,n, you can choose a city adjacent to the ones conquered so far and conquer it. You win if, for each i, you conquer city i at a time no later than ai. A winning strategy may or may not exist, also depending on the starting city. How many starting cities allow you to win?" 1900
2018A "Cards Partition" "2-sat,brute force,greedy,implementation,math" "DJ Genki vs Gram - Einherjar Joker\xe2\xa0\x80You have some cards. An integer between 1 and n is written on each card: specifically, for each i from 1 to n, you have ai cards which have the number i written on them.There is also a shop which contains unlimited cards of each type. You have k coins, so you can buy at most k new cards in total, and the cards you buy can contain any integer between 1 and n, inclusive.After buying the new cards, you must partition all your cards into decks, according to the following rules:   all the decks must have the same size;  there are no pairs of cards with the same value in the same deck. Find the maximum possible size of a deck after buying cards and partitioning them optimally." 1600
2014H "Robin Hood Archery" "data structures,divide and conquer,greedy,hashing" "At such times archery was always the main sport of the day, for the Nottinghamshire yeomen were the best hand at the longbow in all merry England, but this year the Sheriff hesitated...Sheriff of Nottingham has organized a tournament in archery. It\'s the final round and Robin Hood is playing against Sheriff!There are n targets in a row numbered from 1 to n. When a player shoots target i, their score increases by ai and the target i is destroyed. The game consists of turns and players alternate between whose turn it is. Robin Hood always starts the game, then Sheriff and so on. The game continues until all targets are destroyed. Both players start with score 0.At the end of the game, the player with most score wins and the other player loses. If both players have the same score, it\'s a tie and no one wins or loses. In each turn, the player can shoot any target that wasn\'t shot before. Both play optimally to get the most score possible.Sheriff of Nottingham has a suspicion that he might lose the game! This cannot happen, you must help Sheriff. Sheriff will pose q queries, each specifying l and r. This means that the game would be played only with targets l,l+1,\xe2\x80\xa6,r, as others would be removed by Sheriff before the game starts.For each query l, r, determine whether the Sheriff can not lose the game when only considering the targets l,l+1,\xe2\x80\xa6,r." 1900
2014G "Milky Days" "brute force,data structures,greedy,implementation" "What is done is done, and the spoilt milk cannot be helped.Little John is as little as night is day \xe2\x80\x94 he was known to be a giant, at possibly 2.1 metres tall. It has everything to do with his love for milk.His dairy diary has n entries, showing that he acquired ai pints of fresh milk on day di. Milk declines in freshness with time and stays drinkable for a maximum of k days. In other words, fresh milk acquired on day di will be drinkable between days di and di+k\xe2\x88\x921 inclusive.Every day, Little John drinks drinkable milk, up to a maximum of m pints. In other words, if there are less than m pints of milk, he will drink them all and not be satisfied; if there are at least m pints of milk, he will drink exactly m pints and be satisfied, and it\'s a milk satisfaction day.Little John always drinks the freshest drinkable milk first.Determine the number of milk satisfaction days for Little John." 2200
2014F "Sheriff\'s Defense" "dfs and similar,dp,greedy,trees" """Why, master,"" quoth Little John, taking the bags and weighing them in his hand, ""here is the chink of gold.""The folk hero Robin Hood has been troubling Sheriff of Nottingham greatly. Sheriff knows that Robin Hood is about to attack his camps and he wants to be prepared.Sheriff of Nottingham built the camps with strategy in mind and thus there are exactly n camps numbered from 1 to n and n\xe2\x88\x921 trails, each connecting two camps. Any camp can be reached from any other camp. Each camp i has initially ai gold. As it is now, all camps would be destroyed by Robin. Sheriff can strengthen a camp by subtracting exactly c gold from each of its neighboring camps and use it to build better defenses for that camp. Strengthening a camp doesn\'t change its gold, only its neighbors\' gold. A camp can have negative gold. After Robin Hood\'s attack, all camps that have been strengthened survive the attack, all others are destroyed.What\'s the maximum gold Sheriff can keep in his surviving camps after Robin Hood\'s attack if he strengthens his camps optimally? Camp a is neighboring camp b if and only if there exists a trail connecting a and b. Only strengthened camps count towards the answer, as others are destroyed." 2000
2014E "Rendez-vous de Marian et Robin" "dfs and similar,graphs,shortest paths" "In the humble act of meeting, joy doth unfold like a flower in bloom.Absence makes the heart grow fonder. Marian sold her last ware at the Market at the same time Robin finished training at the Major Oak. They couldn\'t wait to meet, so they both start without delay.The travel network is represented as n vertices numbered from 1 to n and m edges. The i-th edge connects vertices ui and vi, and takes wi seconds to travel (all wi are even). Marian starts at vertex 1 (Market) and Robin starts at vertex n (Major Oak).In addition, h of the n vertices each has a single horse available. Both Marian and Robin are capable riders, and could mount horses in no time (i.e. in 0 seconds). Travel times are halved when riding. Once mounted, a horse lasts the remainder of the travel. Meeting must take place on a vertex (i.e. not on an edge). Either could choose to wait on any vertex.Output the earliest time Robin and Marian can meet. If vertices 1 and n are disconnected, output \xe2\x88\x921 as the meeting is cancelled." 1800
2014D "Robert Hood and Mrs Hood" "brute force,data structures,greedy,sortings" "Impress thy brother, yet fret not thy mother.Robin\'s brother and mother are visiting, and Robin gets to choose the start day for each visitor.All days are numbered from 1 to n. Visitors stay for d continuous days, all of those d days must be between day 1 and n inclusive.Robin has a total of k risky \'jobs\' planned. The i-th job takes place between days li and ri inclusive, for 1\xe2\x89\xa4i\xe2\x89\xa4k. If a job takes place on any of the d days, the visit overlaps with this job (the length of overlap is unimportant).Robin wants his brother\'s visit to overlap with the maximum number of distinct jobs, and his mother\'s the minimum.Find suitable start days for the visits of Robin\'s brother and mother. If there are multiple suitable days, choose the earliest one." 1400
2014C "Robin Hood in Town" "binary search,greedy,math" "In Sherwood, we judge a man not by his wealth, but by his merit.Look around, the rich are getting richer, and the poor are getting poorer. We need to take from the rich and give to the poor. We need Robin Hood!There are n people living in the town. Just now, the wealth of the i-th person was ai gold. But guess what? The richest person has found an extra pot of gold! More formally, find an aj=max(a1,a2,\xe2\x80\xa6,an), change aj to aj+x, where x is a non-negative integer number of gold found in the pot. If there are multiple maxima, it can be any one of them.A person is unhappy if their wealth is strictly less than half of the average wealth\xe2\x88\x97. If strictly more than half of the total population n are unhappy, Robin Hood will appear by popular demand.Determine the minimum value of x for Robin Hood to appear, or output \xe2\x88\x921 if it is impossible.\xe2\x88\x97The average wealth is defined as the total wealth divided by the total population n, that is, \xe2\x88\x91ain, the result is a real number." 1100
2014B "Robin Hood and the Major Oak" math "In Sherwood, the trees are our shelter, and we are all children of the forest.The Major Oak in Sherwood is known for its majestic foliage, which provided shelter to Robin Hood and his band of merry men and women.The Major Oak grows ii new leaves in the i-th year. It starts with 1 leaf in year 1.Leaves last for k years on the tree. In other words, leaves grown in year i last between years i and i+k\xe2\x88\x921 inclusive.Robin considers even numbers lucky. Help Robin determine whether the Major Oak will have an even number of leaves in year n." 800
2014A "Robin Helps" greedy,implementation "There is a little bit of the outlaw in everyone, and a little bit of the hero too.The heroic outlaw Robin Hood is famous for taking from the rich and giving to the poor.Robin encounters n people starting from the 1-st and ending with the n-th. The i-th person has ai gold. If ai\xe2\x89\xa5k, Robin will take all ai gold, and if ai=0, Robin will give 1 gold if he has any. Robin starts with 0 gold.Find out how many people Robin gives gold to." 800
2013F2 "Game in Tree (Hard Version)" "binary search,data structures,trees" "This is the hard version of the problem. In this version, it is not guaranteed that u=v. You can make hacks only if both versions of the problem are solved.Alice and Bob are playing a fun game on a tree. This game is played on a tree with n vertices, numbered from 1 to n. Recall that a tree with n vertices is an undirected connected graph with n\xe2\x88\x921 edges.Alice and Bob take turns, with Alice going first. Each player starts at some vertex.On their turn, a player must move from the current vertex to a neighboring vertex that has not yet been visited by anyone. The first player who cannot make a move loses.You are given two vertices u and v. Represent the simple path from vertex u to v as an array p1,p2,p3,\xe2\x80\xa6,pm, where p1=u, pm=v, and there is an edge between pi and pi+1 for all i (1\xe2\x89\xa4i<m).You need to determine the winner of the game if Alice starts at vertex 1 and Bob starts at vertex pj for each j (where 1\xe2\x89\xa4j\xe2\x89\xa4m)." 3500
2013F1 "Game in Tree (Easy Version)" "binary search,brute force,data structures,dp,games,greedy,implementation,trees" "This is the easy version of the problem. In this version, u=v. You can make hacks only if both versions of the problem are solved.Alice and Bob are playing a fun game on a tree. This game is played on a tree with n vertices, numbered from 1 to n. Recall that a tree with n vertices is an undirected connected graph with n\xe2\x88\x921 edges.Alice and Bob take turns, with Alice going first. Each player starts at some vertex.On their turn, a player must move from the current vertex to a neighboring vertex that has not yet been visited by anyone. The first player who cannot make a move loses.You are given two vertices u and v. Represent the simple path from vertex u to v as an array p1,p2,p3,\xe2\x80\xa6,pm, where p1=u, pm=v, and there is an edge between pi and pi+1 for all i (1\xe2\x89\xa4i<m).You need to determine the winner of the game if Alice starts at vertex 1 and Bob starts at vertex pj for each j (where 1\xe2\x89\xa4j\xe2\x89\xa4m)." 2700
2013E "Prefix GCD" "brute force,dp,greedy,math,number theory" "Since Mansur is tired of making legends, there will be no legends for this task.You are given an array of positive integer numbers a1,a2,\xe2\x80\xa6,an. The elements of the array can be rearranged in any order. You need to find the smallest possible value of the expression gcd(a1)+gcd(a1,a2)+\xe2\x80\xa6+gcd(a1,a2,\xe2\x80\xa6,an), where gcd(a1,a2,\xe2\x80\xa6,an) denotes the greatest common divisor (GCD) of a1,a2,\xe2\x80\xa6,an." 2200
2013D "Minimize the Difference" "binary search,greedy" "Zhan, tired after the contest, gave the only task that he did not solve during the contest to his friend, Sungat. However, he could not solve it either, so we ask you to try to solve this problem.You are given an array a1,a2,\xe2\x80\xa6,an of length n. We can perform any number (possibly, zero) of operations on the array.In one operation, we choose a position i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) and perform the following action:   ai:=ai\xe2\x88\x921, and ai+1:=ai+1+1. Find the minimum possible value of max(a1,a2,\xe2\x80\xa6,an)\xe2\x88\x92min(a1,a2,\xe2\x80\xa6,an)." 1900
2013C "Password Cracking" "constructive algorithms,interactive,strings" "Dimash learned that Mansur wrote something very unpleasant about him to a friend, so he decided to find out his password at all costs and discover what exactly he wrote.Believing in the strength of his password, Mansur stated that his password \xe2\x80\x94 is a binary string of length n. He is also ready to answer Dimash\'s questions of the following type:Dimash says a binary string t, and Mansur replies whether it is true that t is a substring of his password.Help Dimash find out the password in no more than 2n operations; otherwise, Mansur will understand the trick and stop communicating with him." 1400
2013B "Battle for Survive" "constructive algorithms,greedy,math" "Eralim, being the mafia boss, manages a group of n fighters. Fighter i has a rating of ai.Eralim arranges a tournament of n\xe2\x88\x921 battles, in each of which two not yet eliminated fighters i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) are chosen, and as a result of the battle, fighter i is eliminated from the tournament, and the rating of fighter j is reduced by the rating of fighter i. That is, aj is decreased by ai. Note that fighter j\'s rating can become negative. The fighters indexes do not change.Eralim wants to know what maximum rating the last remaining fighter can preserve if he chooses the battles optimally." 900
2013A "Zhan\'s Blender" "constructive algorithms,math" "Today, a club fair was held at ""NSPhM"". In order to advertise his pastry club, Zhan decided to demonstrate the power of his blender.To demonstrate the power of his blender, Zhan has n fruits.The blender can mix up to x fruits per second.In each second, Zhan can put up to y fruits into the blender. After that, the blender will blend min(x,c) fruits, where c is the number of fruits inside the blender. After blending, blended fruits are removed from the blender.Help Zhan determine the minimum amount of time required for Zhan to blend all fruits." 800
2011I "Stack and Queue" "*special problem,data structures,divide and conquer" "There are 2 queues of patients at the doors of two doctors. The first doctor sees patients in the usual order of the queue \xe2\x80\x94 whoever arrived first will be seen first. The second doctor does the opposite \xe2\x80\x94 he sees those who arrived last first. Thus, there is a queue for the first doctor and a stack for the second doctor. A patient can be in both the queue and the stack. Each patient is characterized by the time their visit to the doctor will take (the time is the same for both doctors).When the appointments begin, the doctors will see patients in the order of the queue and stack, respectively. As soon as a doctor finishes with one patient, he will call the next one.But there is one problem: if a patient is in both the queue and the stack, and he is called to one doctor first and then to the other, while he has not yet finished with the first one, confusion will arise. It is allowed for a patient to go to the second doctor at the exact moment he finishes with the first doctor.The current configuration of the queue and stack is called good if the doctors can see all the patients without any confusion arising.Initially, both the queue and the stack are empty. There are three types of queries:   add patient x to the queue;  add patient x to the stack;  patient x, who was in the queue, realizes he is in the wrong place and moves to the stack; however, he moves to the position in the stack as if he had entered the stack at the moment of the query when he entered the queue. It is guaranteed that after each query, each patient is no more than once in the queue and no more than once in the stack.After each query, you need to determine if the current configuration is good." -999
2011H "Strange Matrix" "*special problem,graphs,greedy" "You are given a matrix a of size n\xc3\x97m, consisting of integers from 0 to 31 inclusive.Let\'s call the matrix strange if for every two distinct rows i and j, both of the following conditions hold:   for every set of k indices (x1,x2,\xe2\x80\xa6,xk), where 1\xe2\x89\xa4x1<x2<\xe2\x8b\xaf<xk\xe2\x89\xa4m, the equality ai,x1&aj,x1&ai,x2&aj,x2&\xe2\x8b\xaf&ai,xk&aj,xk=0 holds (where & \xe2\x80\x94 bitwise AND of two numbers);  for every set of k indices (x1,x2,\xe2\x80\xa6,xk), where 1\xe2\x89\xa4x1<x2<\xe2\x8b\xaf<xk\xe2\x89\xa4m, the equality ai,x1|aj,x1|ai,x2|aj,x2|\xe2\x8b\xaf|ai,xk|aj,xk=31 holds (where | \xe2\x80\x94 bitwise OR of two numbers). You can perform the following operation any number of times: take any row of the matrix and a number y from 0 to 31 inclusive; then apply the bitwise XOR with the number y to all elements of the selected row. The cost of such an operation is equal to y.Your task is to calculate the minimum cost to make the matrix strange, or report that it is impossible." -999
2011G "Removal of a Permutation" "*special problem" "You are given a permutation p of length n.You can perform operations of two types:   mark all positions i such that 1\xe2\x89\xa4i<n and pi<pi+1, and simultaneously remove the elements at these positions;  mark all positions i such that 2\xe2\x89\xa4i\xe2\x89\xa4n and pi\xe2\x88\x921>pi, and simultaneously remove the elements at these positions. For each integer from 1 to (n\xe2\x88\x921), calculate the minimum number of operations required to remove that integer from the permutation." -999
2011F "Good Subarray" "*special problem,data structures,greedy" "You are given an integer array a of size n.Let\'s call an array good if it can be obtained using the following algorithm: create an array consisting of any single integer; and then perform the following operation an arbitrary number of times: choose an element from the already existing array (let\'s call it x) and add x, (x\xe2\x88\x921), or (x+1) to the end of the array.For example, the arrays [1,2,1], [5] and [3,2,1,4] are good, while [2,4] and [3,1,2] are not.Your task is to count the number of good contiguous subarrays of the array a. Two subarrays that have the same elements but are in different positions of the array a are considered different." -999
2011E "Rock-Paper-Scissors Bot" "*special problem,greedy,strings" "Rock-Paper-Scissors is a game for two players. It is played in rounds. During each round, every player chooses one of three moves: Rock, Paper, or Scissors. Depending on the chosen moves, the following happens:  if one player chooses Rock and the other player chooses Paper, the player who chooses Paper wins and gets a point;  if one player chooses Scissors and the other player chooses Paper, the player who chooses Scissors wins and gets a point;  if one player chooses Scissors and the other player chooses Rock, the player who chooses Rock wins and gets a point;  and if both players choose the same move, nobody wins and nobody gets a point. Monocarp decided to play against a bot. During the game, Monocarp noticed that the bot\'s behavior is very predictable:   in the first round, it chooses Rock;  in every round except the first, it chooses the move that beats the opponent\'s move in the previous round (for example, if in the previous round its opponent played Scissors, then the bot chooses Rock now). Monocarp has a favorite string s, consisting of the characters R, P, and/or S. Monocarp decided to play a series of rounds against the bot. However, he wants both of the following conditions to be met:   the final score is in favor of Monocarp (i.\xe2\x80\x89e., the number of rounds he won is strictly greater than the number of rounds the bot won);  the string s appears as a contiguous substring in the sequence of the bot\'s moves (where R denotes Rock, P denotes Paper, and S denotes Scissors). Help Monocarp and calculate the minimum number of rounds he needs to play against the bot to satisfy both of the aforementioned conditions." -999
2011D "Among Wolves" "*special problem" "In a game you started playing recently, there is a field that can be represented as a rectangular grid. The field has 2 rows and n columns \xe2\x80\x94 2n cells in total.Some cells are empty, but some are occupied by wolves. In the beginning of the game, you have one sheep in some cell, and you\'d like to save it from wolves.Wolves will attack you at night, so you still have some time for preparation. You have two ways to deal with wolves:   You pay h coins to hunters and choose a cell occupied by a wolf. Hunters will clear the cell, eradicating the wolf in it.  You pay b coins to builders and choose an empty cell. Builders will dig a trench in the chosen cell that wolves can\'t cross.  You can use both methods mentioned above any number of times and in any order.Let\'s say that a wolf can reach the sheep if there is a path that starts at the wolf\'s cell and finishes at the sheep\'s cell. This path shouldn\'t contain any cells with trenches, and each two consecutive cells in the path should be neighbors (share a side).What is the minimum total amount of money you should pay to ensure that none of the wolves can reach the sheep?" -999
2011C "Split the Expression" "*special problem" "You are given a string s of the form <block of digits>+<block of digits>+...+<block of digits>. Every block of digits consists of at least 2 and at most 13 digits; every digit is from 1 to 9.You have to split this string into expressions of the form <integer>+<integer>. Every expression must be a contiguous part of the given string, and every character of the given string must belong to exactly one expression. For example, if you have a string 123+456+789+555, then:  you are allowed to split it into 123+4, 56+7 and 89+555;  you are not allowed to split it into 123+456 and +789+555, since the second part begins with a + sign;  you are not allowed to split it into 123+4, 56+7, 8 and 9+555, since the third part does not contain a + sign;  you are not allowed to split it into 123+456+78 and 9+555, since the first part contains two + signs. Among all allowed ways to split the string, find one which maximizes the sum of results of all expressions you get, and print this sum." -999
2011B Shuffle "*special problem" "Yes, this is another one of those constructive permutation problems.You are given an integer n. You have to construct a permutation p of size n, i.\xe2\x80\x89e. an array of n integers, where every integer from 1 to n appears exactly once.Every pair of adjacent elements in the permutation (pi and pi+1) must meet the following condition:  if one of them is divisible by the other, the condition pi<pi+1 must hold;  otherwise, the condition pi>pi+1 must hold." -999
2011A "Problem Solving" "*special problem" "Jane has decided to solve a list of n problems on Codeforces. The i-th problem in her list has difficulty di, and the last problem in the list is the hardest one (for every problem j<n, dj<dn).Jane\'s problem-solving skill is some integer x (unknown to you). If a problem\'s difficulty is greater than x, then Jane cannot solve it, otherwise she can solve it.Jane has solved all problems form the list, except for the last one \xe2\x80\x94 she found out that it was too difficult for her. Can you uniquely determine the value of x \xe2\x80\x94 Jane\'s problem solving skill?" -999
2010C2 "Message Transmission Error (hard version)" "hashing,string suffix structures,strings,two pointers" "This is a more difficult version of the problem. It differs from the easy one only by the constraints.At the Berland State University, the local network between servers does not always operate without errors. When transmitting two identical messages consecutively, an error may occur, resulting in the two messages merging into one. In this merging, the end of the first message coincides with the beginning of the second. Of course, the merging can only occur at identical characters. The length of the merging must be a positive number less than the length of the message text.For example, when transmitting two messages ""abrakadabra"" consecutively, it is possible that it will be transmitted with the described type of error, resulting in a message like ""abrakadabrabrakadabra"" or ""abrakadabrakadabra\' (in the first case, the merging occurred at one character, and in the second case, at four).Given the received message t, determine if it is possible that this is the result of an error of the described type in the operation of the local network, and if so, determine a possible value of s.A situation where two messages completely overlap each other should not be considered an error. For example, if the received message is ""abcd"", it should be considered that there is no error in it. Similarly, simply appending one message after another is not a sign of an error. For instance, if the received message is ""abcabc"", it should also be considered that there is no error in it." 1700
2010C1 "Message Transmission Error (easy version)" "brute force,strings" "This is a simplified version of the problem. It differs from the difficult one only in its constraints.At the Berland State University, the local network between servers does not always operate without errors. When transmitting two identical messages consecutively, an error may occur, resulting in the two messages merging into one. In this merging, the end of the first message coincides with the beginning of the second. Of course, the merging can only occur at identical characters. The length of the merging must be a positive number less than the length of the message text.For example, when transmitting two messages ""abrakadabra"" consecutively, it is possible that it will be transmitted with the described type of error, resulting in a message like ""abrakadabrabrakadabra"" or ""abrakadabrakadabra\' (in the first case, the merging occurred at one character, and in the second case, at four).Given the received message t, determine if it is possible that this is the result of an error of the described type in the operation of the local network, and if so, determine a possible value of s.A situation where two messages completely overlap each other should not be considered an error. For example, if the received message is ""abcd"", it should be considered that there is no error in it. Similarly, simply appending one message after another is not a sign of an error. For instance, if the received message is ""abcabc"", it should also be considered that there is no error in it." 1400
2010B "Three Brothers" "brute force,implementation,math" "Three brothers agreed to meet. Let\'s number the brothers as follows: the oldest brother is number 1, the middle brother is number 2, and the youngest brother is number 3.When it was time for the meeting, one of the brothers was late. Given the numbers of the two brothers who arrived on time, you need to determine the number of the brother who was late." 800
2010A "Alternating Sum of Numbers" "brute force,implementation,math" "You are given a sequence of integers. Output the alternating sum of this sequence. In other words, output a1\xe2\x88\x92a2+a3\xe2\x88\x92a4+a5\xe2\x88\x92\xe2\x80\xa6. That is, the signs of plus and minus alternate, starting with a plus." 800
2009G3 "Yunli\'s Subarray Queries (extreme version)" "data structures,dp,implementation" "This is the extreme version of the problem. In this version, the output of each query is different from the easy and hard versions. It is also guaranteed that r\xe2\x89\xa5l+k\xe2\x88\x921 for all queries.For an arbitrary array b, Yunli can perform the following operation any number of times:  Select an index i. Set bi=x where x is any integer she desires (x is not limited to the interval [1,n]). Denote f(b) as the minimum number of operations she needs to perform until there exists a consecutive subarray\xe2\x88\x97 of length at least k in b.Yunli is given an array a of size n and asks you q queries. In each query, you must output \xe2\x88\x91r\xe2\x88\x92k+1i=l\xe2\x88\x91rj=i+k\xe2\x88\x921f([ai,ai+1,\xe2\x80\xa6,aj]).\xe2\x88\x97If there exists a consecutive subarray of length k that starts at index i (1\xe2\x89\xa4i\xe2\x89\xa4|b|\xe2\x88\x92k+1), then bj=bj\xe2\x88\x921+1 for all i<j\xe2\x89\xa4i+k\xe2\x88\x921." 2700
2009G2 "Yunli\'s Subarray Queries (hard version)" "binary search,data structures,dp" "This is the hard version of the problem. In this version, it is guaranteed that r\xe2\x89\xa5l+k\xe2\x88\x921 for all queries.For an arbitrary array b, Yunli can perform the following operation any number of times:  Select an index i. Set bi=x where x is any integer she desires (x is not limited to the interval [1,n]). Denote f(b) as the minimum number of operations she needs to perform until there exists a consecutive subarray\xe2\x88\x97 of length at least k in b.Yunli is given an array a of size n and asks you q queries. In each query, you must output \xe2\x88\x91rj=l+k\xe2\x88\x921f([al,al+1,\xe2\x80\xa6,aj]).\xe2\x88\x97If there exists a consecutive subarray of length k that starts at index i (1\xe2\x89\xa4i\xe2\x89\xa4|b|\xe2\x88\x92k+1), then bj=bj\xe2\x88\x921+1 for all i<j\xe2\x89\xa4i+k\xe2\x88\x921." 2200
2009G1 "Yunli\'s Subarray Queries (easy version)" "binary search,data structures,two pointers" "This is the easy version of the problem. In this version, it is guaranteed that r=l+k\xe2\x88\x921 for all queries.For an arbitrary array b, Yunli can perform the following operation any number of times:  Select an index i. Set bi=x where x is any integer she desires (x is not limited to the interval [1,n]). Denote f(b) as the minimum number of operations she needs to perform until there exists a consecutive subarray\xe2\x88\x97 of length at least k in b.Yunli is given an array a of size n and asks you q queries. In each query, you must output \xe2\x88\x91rj=l+k\xe2\x88\x921f([al,al+1,\xe2\x80\xa6,aj]). Note that in this version, you are only required to output f([al,al+1,\xe2\x80\xa6,al+k\xe2\x88\x921]).\xe2\x88\x97If there exists a consecutive subarray of length k that starts at index i (1\xe2\x89\xa4i\xe2\x89\xa4|b|\xe2\x88\x92k+1), then bj=bj\xe2\x88\x921+1 for all i<j\xe2\x89\xa4i+k\xe2\x88\x921." 1900
2009F "Firefly\'s Queries" "bitmasks,data structures,flows,math" "Firefly is given an array a of length n. Let ci denote the i\'th cyclic shift\xe2\x88\x97 of a. She creates a new array b such that b=c1+c2+\xe2\x8b\xaf+cn where + represents concatenation\xe2\x80\xa0. Then, she asks you q queries. For each query, output the sum of all elements in the subarray of b that starts from the l-th element and ends at the r-th element, inclusive of both ends.\xe2\x88\x97The x-th (1\xe2\x89\xa4x\xe2\x89\xa4n) cyclic shift of the array a is ax,ax+1\xe2\x80\xa6an,a1,a2\xe2\x80\xa6ax\xe2\x88\x921. Note that the 1-st shift is the initial a.\xe2\x80\xa0The concatenation of two arrays p and q of length n (in other words, p+q) is p1,p2,...,pn,q1,q2,...,qn." 1700
2009E "Klee\'s SUPER DUPER LARGE Array!!!" "binary search,math,ternary search" "Klee has an array a of length n containing integers [k,k+1,...,k+n\xe2\x88\x921] in that order. Klee wants to choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that x=|a1+a2+\xe2\x8b\xaf+ai\xe2\x88\x92ai+1\xe2\x88\x92\xe2\x8b\xaf\xe2\x88\x92an| is minimized. Note that for an arbitrary integer z, |z| represents the absolute value of z. Output the minimum possible value of x." 1400
2009D "Satyam and Counting" geometry,math "Satyam is given n distinct points on the 2D coordinate plane. It is guaranteed that 0\xe2\x89\xa4yi\xe2\x89\xa41 for all given points (xi,yi). How many different nondegenerate right triangles\xe2\x88\x97 can be formed from choosing three different points as its vertices?Two triangles a and b are different if there is a point v such that v is a vertex of a but not a vertex of b.\xe2\x88\x97A nondegenerate right triangle has positive area and an interior 90\xe2\x88\x98 angle." 1400
2009C "The Legend of Freya the Frog" implementation,math "Freya the Frog is traveling on the 2D coordinate plane. She is currently at point (0,0) and wants to go to point (x,y). In one move, she chooses an integer d such that 0\xe2\x89\xa4d\xe2\x89\xa4k and jumps d spots forward in the direction she is facing. Initially, she is facing the positive x direction. After every move, she will alternate between facing the positive x direction and the positive y direction (i.e., she will face the positive y direction on her second move, the positive x direction on her third move, and so on). What is the minimum amount of moves she must perform to land on point (x,y)?" 1100
2009B osu!mania "brute force,implementation" "You are playing your favorite rhythm game, osu!mania. The layout of your beatmap consists of n rows and 4 columns. Because notes at the bottom are closer, you will process the bottommost row first and the topmost row last. Each row will contain exactly one note, represented as a \'#\'.For each note 1,2,\xe2\x80\xa6,n, in the order of processing, output the column in which the note appears." 800
2009A Minimize! "brute force,math" "You are given two integers a and b (a\xe2\x89\xa4b). Over all possible integer values of c (a\xe2\x89\xa4c\xe2\x89\xa4b), find the minimum value of (c\xe2\x88\x92a)+(b\xe2\x88\x92c)." 800
2008H "Sakurako\'s Test" "binary search,brute force,greedy,math,number theory" "Sakurako will soon take a test. The test can be described as an array of integers n and a task on it:Given an integer x, Sakurako can perform the following operation any number of times:  Choose an integer i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that ai\xe2\x89\xa5x;  Change the value of ai to ai\xe2\x88\x92x. Using this operation any number of times, she must find the minimum possible median\xe2\x88\x97 of the array a.Sakurako knows the array but does not know the integer x. Someone let it slip that one of the q values of x will be in the next test, so Sakurako is asking you what the answer is for each such x.\xe2\x88\x97The median of an array of length n is the element that stands in the middle of the sorted array (at the n+22-th position for even n, and at the n+12-th for odd)" 2100
2008G "Sakurako\'s Task" "binary search,greedy,math,number theory" "Sakurako has prepared a task for you:She gives you an array of n integers and allows you to choose i and j such that i\xe2\x89\xa0j and ai\xe2\x89\xa5aj, and then assign ai=ai\xe2\x88\x92aj or ai=ai+aj. You can perform this operation any number of times for any i and j, as long as they satisfy the conditions.Sakurako asks you what is the maximum possible value of mexk\xe2\x88\x97 of the array after any number of operations.\xe2\x88\x97mexk is the k-th non-negative integer that is absent in the array. For example, mex1({1,2,3})=0, since 0 is the first element that is not in the array, and mex2({0,2,4})=3, since 3 is the second element that is not in the array." 1800
2008F "Sakurako\'s Box" "combinatorics,math,number theory" "Sakurako has a box with n balls. Each ball has it\'s value. She wants to bet with her friend that if the friend randomly picks two balls from the box (it could be two distinct balls, but they may have the same value), the product of their values will be the same as the number that Sakurako guessed.Since Sakurako has a PhD in probability, she knows that the best number to pick is the expected value, but she forgot how to calculate it. Help Sakurako and find the expected value of the product of two elements from the array.It can be shown that the expected value has the form PQ, where P and Q are non-negative integers, and Q\xe2\x89\xa00. Report the value of P\xe2\x8b\x85Q\xe2\x88\x921(mod109+7)." 1400
2008E "Alternating String" "brute force,data structures,dp,greedy,implementation,strings" "Sakurako really loves alternating strings. She calls a string s of lowercase Latin letters an alternating string if characters in the even positions are the same, if characters in the odd positions are the same, and the length of the string is even.For example, the strings \'abab\' and \'gg\' are alternating, while the strings \'aba\' and \'ggwp\' are not.As a good friend, you decided to gift such a string, but you couldn\'t find one. Luckily, you can perform two types of operations on the string:   Choose an index i and delete the i-th character from the string, which will reduce the length of the string by 1. This type of operation can be performed no more than 1 time;  Choose an index i and replace si with any other letter. Since you are in a hurry, you need to determine the minimum number of operations required to make the string an alternating one." 1500
2008D "Sakurako\'s Hobby" dp,dsu,graphs,math "For a certain permutation p\xe2\x88\x97 Sakurako calls an integer j reachable from an integer i if it is possible to make i equal to j by assigning i=pi a certain number of times.If p=[3,5,6,1,2,4], then, for example, 4 is reachable from 1, because: i=1 \xe2\x86\x92 i=p1=3 \xe2\x86\x92 i=p3=6 \xe2\x86\x92 i=p6=4. Now i=4, so 4 is reachable from 1.Each number in the permutation is colored either black or white.Sakurako defines the function F(i) as the number of black integers that are reachable from i.Sakurako is interested in F(i) for each 1\xe2\x89\xa4i\xe2\x89\xa4n, but calculating all values becomes very difficult, so she asks you, as her good friend, to compute this.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (the number 2 appears twice in the array), and [1,3,4] is also not a permutation (n=3, but the array contains 4)." 1100
2008C "Longest Good Array" "binary search,brute force,math" "Today, Sakurako was studying arrays. An array a of length n is considered good if and only if:  the array a is increasing, meaning ai\xe2\x88\x921<ai for all 2\xe2\x89\xa4i\xe2\x89\xa4n;  the differences between adjacent elements are increasing, meaning ai\xe2\x88\x92ai\xe2\x88\x921<ai+1\xe2\x88\x92ai for all 2\xe2\x89\xa4i<n. Sakurako has come up with boundaries l and r and wants to construct a good array of maximum length, where l\xe2\x89\xa4ai\xe2\x89\xa4r for all ai.Help Sakurako find the maximum length of a good array for the given l and r." 800
2008B "Square or Not" "brute force,math,strings" "A beautiful binary matrix is a matrix that has ones on its edges and zeros inside.  Examples of four beautiful binary matrices. Today, Sakurako was playing with a beautiful binary matrix of size r\xc3\x97c and created a binary string s by writing down all the rows of the matrix, starting from the first and ending with the r-th. More formally, the element from the matrix in the i-th row and j-th column corresponds to the ((i\xe2\x88\x921)\xe2\x88\x97c+j)-th element of the string.You need to check whether the beautiful matrix from which the string s was obtained could be squared. In other words, you need to check whether the string s could have been build from a square beautiful binary matrix (i.e., one where r=c)." 800
2008A "Sakurako\'s Exam" "brute force,constructive algorithms,greedy,math" "Today, Sakurako has a math exam. The teacher gave the array, consisting of a ones and b twos.In an array, Sakurako must place either a \'+\' or a \'-\' in front of each element so that the sum of all elements in the array equals 0.Sakurako is not sure if it is possible to solve this problem, so determine whether there is a way to assign signs such that the sum of all elements in the array equals 0." 800
2007C "Dora and C++" "math,number theory" "Dora has just learned the programming language C++!However, she has completely misunderstood the meaning of C++. She considers it as two kinds of adding operations on the array c with n elements. Dora has two integers a and b. In one operation, she can choose one of the following things to do.  Choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n, and increase ci by a.  Choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n, and increase ci by b. Note that a and b are constants, and they can be the same.Let\'s define a range of array d as max(di)\xe2\x88\x92min(di). For instance, the range of the array [1,2,3,4] is 4\xe2\x88\x921=3, the range of the array [5,2,8,2,2,1] is 8\xe2\x88\x921=7, and the range of the array [3,3,3] is 3\xe2\x88\x923=0.After any number of operations (possibly, 0), Dora calculates the range of the new array. You need to help Dora minimize this value, but since Dora loves exploring all by herself, you only need to tell her the minimized value." 1500
2007B "Index and Maximum Value" "data structures,greedy" "After receiving yet another integer array a1,a2,\xe2\x80\xa6,an at her birthday party, Index decides to perform some operations on it.Formally, there are m operations that she is going to perform in order. Each of them belongs to one of the two types:  + l r. Given two integers l and r, for all 1\xe2\x89\xa4i\xe2\x89\xa4n such that l\xe2\x89\xa4ai\xe2\x89\xa4r, set ai:=ai+1.  - l r. Given two integers l and r, for all 1\xe2\x89\xa4i\xe2\x89\xa4n such that l\xe2\x89\xa4ai\xe2\x89\xa4r, set ai:=ai\xe2\x88\x921. For example, if the initial array a=[7,1,3,4,3], after performing the operation + 2 4, the array a=[7,1,4,5,4]. Then, after performing the operation - 1 10, the array a=[6,0,3,4,3].Index is curious about the maximum value in the array a. Please help her find it after each of the m operations." 900
2007A "Dora\'s Set" "greedy,math,number theory" "Dora has a set s containing integers. In the beginning, she will put all integers in [l,r] into the set s. That is, an integer x is initially contained in the set if and only if l\xe2\x89\xa4x\xe2\x89\xa4r. Then she allows you to perform the following operations:  Select three distinct integers a, b, and c from the set s, such that gcd(a,b)=gcd(b,c)=gcd(a,c)=1\xe2\x80\xa0.  Then, remove these three integers from the set s. What is the maximum number of operations you can perform?\xe2\x80\xa0Recall that gcd(x,y) means the greatest common divisor of integers x and y." 800
2006F "Dora\'s Paint" "brute force,combinatorics,constructive algorithms,graphs,implementation" "Sadly, Dora poured the paint when painting the class mural. Dora considers the mural as the matrix b of size n\xc3\x97n. Initially, bi,j=0 for all 1\xe2\x89\xa4i,j\xe2\x89\xa4n.Dora has only two brushes which have two different colors. In one operation, she can paint the matrix with one of two brushes:  The first brush has color 1 on it and can paint one column of the matrix. That is, Dora chooses 1\xe2\x89\xa4j\xe2\x89\xa4n and makes bi,j:=1 for all 1\xe2\x89\xa4i\xe2\x89\xa4n;  The second brush has color 2 on it and can paint one row of the matrix. That is, Dora chooses 1\xe2\x89\xa4i\xe2\x89\xa4n and makes bi,j:=2 for all 1\xe2\x89\xa4j\xe2\x89\xa4n. Dora paints the matrix so that the resulting matrix b contains only 1 and 2.For a matrix b, let f(b) denote the minimum number of operations needed to turn the initial matrix (containing only 0) into b. The beauty of a matrix b is the number of ways to paint the initial matrix in exactly f(b) operations to turn it into b. If there\'s no way to turn the initial matrix into b, the beauty of b is 0.However, Dora made a uniformly random mistake; there\'s exactly one element different in the matrix a given to you from the real matrix b. That is, there is exactly one pair (i,j) such that ai,j=3\xe2\x88\x92bi,j.Please help Dora compute the expected beauty of the real matrix b modulo 998244353 (all possible n2 mistakes have equal probability).Since the size of the matrix is too large, Dora will only tell you the positions of m elements of color 1, and the remaining n2\xe2\x88\x92m elements have color 2." 3500
2006E "Iris\'s Full Binary Tree" "brute force,data structures,dfs and similar,trees" "Iris likes full binary trees.Let\'s define the depth of a rooted tree as the maximum number of vertices on the simple paths from some vertex to the root. A full binary tree of depth d is a binary tree of depth d with exactly 2d\xe2\x88\x921 vertices.Iris calls a tree a d-binary tree if some vertices and edges can be added to it to make it a full binary tree of depth d. Note that any vertex can be chosen as the root of a full binary tree.Since performing operations on large trees is difficult, she defines the binary depth of a tree as the minimum d satisfying that the tree is d-binary. Specifically, if there is no integer d\xe2\x89\xa51 such that the tree is d-binary, the binary depth of the tree is \xe2\x88\x921.Iris now has a tree consisting of only vertex 1. She wants to add n\xe2\x88\x921 more vertices to form a larger tree. She will add the vertices one by one. When she adds vertex i (2\xe2\x89\xa4i\xe2\x89\xa4n), she\'ll give you an integer pi (1\xe2\x89\xa4pi<i), and add a new edge connecting vertices i and pi.Iris wants to ask you the binary depth of the tree formed by the first i vertices for each 1\xe2\x89\xa4i\xe2\x89\xa4n. Can you tell her the answer?" 3100
2006D "Iris and Adjacent Products" "data structures,greedy,implementation,math" "Iris has just learned multiplication in her Maths lessons. However, since her brain is unable to withstand too complex calculations, she could not multiply two integers with the product greater than k together. Otherwise, her brain may explode!Her teacher sets a difficult task every day as her daily summer holiday homework. Now she is given an array a consisting of n elements, and she needs to calculate the product of each two adjacent elements (that is, a1\xe2\x8b\x85a2, a2\xe2\x8b\x85a3, and so on). Iris wants her brain to work safely, and in order to do that, she would like to modify the array a in such a way that ai\xe2\x8b\x85ai+1\xe2\x89\xa4k holds for every 1\xe2\x89\xa4i<n. There are two types of operations she can perform:  She can rearrange the elements of the array a in an arbitrary way. She can select an arbitrary element of the array a and change its value to an arbitrary integer from 1 to k. Iris wants to minimize the number of operations of type 2 that she uses.However, that\'s completely not the end of the summer holiday! Summer holiday lasts for q days, and on the i-th day, Iris is asked to solve the Math homework for the subarray bli,bli+1,\xe2\x80\xa6,bri. Help Iris and tell her the minimum number of type 2 operations she needs to perform for each day. Note that the operations are independent for each day, i.e. the array b is not changed." 2600
2006C "Eri and Expanded Sets" "data structures,divide and conquer,math,number theory,two pointers" "Let there be a set that contains distinct positive integers. To expand the set to contain as many integers as possible, Eri can choose two integers x\xe2\x89\xa0y from the set such that their average x+y2 is still a positive integer and isn\'t contained in the set, and add it to the set. The integers x and y remain in the set.Let\'s call the set of integers consecutive if, after the elements are sorted, the difference between any pair of adjacent elements is 1. For example, sets {2}, {2,5,4,3}, {5,6,8,7} are consecutive, while {2,4,5,6}, {9,7} are not.Eri likes consecutive sets. Suppose there is an array b, then Eri puts all elements in b into the set. If after a finite number of operations described above, the set can become consecutive, the array b will be called brilliant.Note that if the same integer appears in the array multiple times, we only put it into the set once, as a set always contains distinct positive integers.Eri has an array a of n positive integers. Please help him to count the number of pairs of integers (l,r) such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and the subarray al,al+1,\xe2\x80\xa6,ar is brilliant." 2300
2006B "Iris and the Tree" "brute force,data structures,dfs and similar,dsu,math,trees" "Given a rooted tree with the root at vertex 1. For any vertex i (1<i\xe2\x89\xa4n) in the tree, there is an edge connecting vertices i and pi (1\xe2\x89\xa4pi<i), with a weight equal to ti.Iris does not know the values of ti, but she knows that n\xe2\x88\x91i=2ti=w and each of the ti is a non-negative integer.The vertices of the tree are numbered in a special way: the numbers of the vertices in each subtree are consecutive integers. In other words, the vertices of the tree are numbered in the order of a depth-first search.  The tree in this picture satisfies the condition. For example, in the subtree of vertex 2, the vertex numbers are 2,3,4,5, which are consecutive integers.   The tree in this picture does not satisfy the condition, as in the subtree of vertex 2, the vertex numbers 2 and 4 are not consecutive integers. We define dist(u,v) as the length of the simple path between vertices u and v in the tree.Next, there will be n\xe2\x88\x921 events:  Iris is given integers x and y, indicating that tx=y. After each event, Iris wants to know the maximum possible value of dist(i,imodn+1) independently for each i (1\xe2\x89\xa4i\xe2\x89\xa4n). She only needs to know the sum of these n values. Please help Iris quickly get the answers.Note that when calculating the maximum possible values of dist(i,imodn+1) and dist(j,jmodn+1) for i\xe2\x89\xa0j, the unknown edge weights may be different." 1800
2006A "Iris and Game on the Tree" "constructive algorithms,dfs and similar,games,graphs,greedy,trees" "Iris has a tree rooted at vertex 1. Each vertex has a value of 0 or 1.Let\'s consider a leaf of the tree (the vertex 1 is never considered a leaf) and define its weight. Construct a string formed by the values of the vertices on the path starting at the root and ending in this leaf. Then the weight of the leaf is the difference between the number of occurrences of 10 and 01 substrings in it.Take the following tree as an example. Green vertices have a value of 1 while white vertices have a value of 0.   Let\'s calculate the weight of the leaf 5: the formed string is 10110. The number of occurrences of substring 10 is 2, the number of occurrences of substring 01 is 1, so the difference is 2\xe2\x88\x921=1. Let\'s calculate the weight of the leaf 6: the formed string is 101. The number of occurrences of substring 10 is 1, the number of occurrences of substring 01 is 1, so the difference is 1\xe2\x88\x921=0.The score of a tree is defined as the number of leaves with non-zero weight in the tree.But the values of some vertices haven\'t been decided and will be given to you as ?. Filling the blanks would be so boring, so Iris is going to invite Dora to play a game. On each turn, one of the girls chooses any of the remaining vertices with value ? and changes its value to 0 or 1, with Iris going first. The game continues until there are no vertices with value ? left in the tree. Iris aims to maximize the score of the tree, while Dora aims to minimize that.Assuming that both girls play optimally, please determine the final score of the tree." 1700
2005E2 "Subtangle Game (Hard Version)" "data structures,dp,games,greedy,implementation" "This is the hard version of the problem. The differences between the two versions are the constraints on all the variables. You can make hacks only if both versions of the problem are solved.Tsovak and Narek are playing a game. They have an array a and a matrix b of integers with n rows and m columns, numbered from 1. The cell in the i-th row and the j-th column is (i,j).They are looking for the elements of a in turns; Tsovak starts first. Each time a player looks for a cell in the matrix containing the current element of a (Tsovak looks for the first, then Narek looks for the second, etc.). Let\'s say a player has chosen the cell (r,c). The next player has to choose his cell in the submatrix starting at (r+1,c+1) and ending in (n,m) (the submatrix can be empty if r=n or c=m). If a player cannot find such a cell (or the remaining submatrix is empty) or the array ends (the previous player has chosen the last element), then he loses.Your task is to determine the winner if the players play optimally.Note: since the input is large, you may need to optimize input/output for this problem.For example, in C++, it is enough to use the following lines at the start of the main() function: int main() {    ios_base::sync_with_stdio(false);    cin.tie(NULL); cout.tie(NULL);}" 2500
2005E1 "Subtangle Game (Easy Version)" dp,games,greedy,implementation "This is the easy version of the problem. The differences between the two versions are the constraints on all the variables. You can make hacks only if both versions of the problem are solved.Tsovak and Narek are playing a game. They have an array a and a matrix b of integers with n rows and m columns, numbered from 1. The cell in the i-th row and the j-th column is (i,j).They are looking for the elements of a in turns; Tsovak starts first. Each time a player looks for a cell in the matrix containing the current element of a (Tsovak looks for the first, then Narek looks for the second, etc.). Let\'s say a player has chosen the cell (r,c). The next player has to choose his cell in the submatrix starting at (r+1,c+1) and ending in (n,m) (the submatrix can be empty if r=n or c=m). If a player cannot find such a cell (or the remaining submatrix is empty) or the array ends (the previous player has chosen the last element), then he loses.Your task is to determine the winner if the players play optimally." 2100
2005D "Alter the GCD" "binary search,brute force,data structures,divide and conquer,implementation,number theory" "You are given two arrays a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn.You must perform the following operation exactly once:  choose any indices l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n;  swap ai and bi for all i such that l\xe2\x89\xa4i\xe2\x89\xa4r. Find the maximum possible value of gcd(a1,a2,\xe2\x80\xa6,an)+gcd(b1,b2,\xe2\x80\xa6,bn) after performing the operation exactly once. Also find the number of distinct pairs (l,r) which achieve the maximum value." 2400
2005C "Lazy Narek" dp,implementation,strings "Narek is too lazy to create the third problem of this contest. His friend Artur suggests that he should use ChatGPT. ChatGPT creates n problems, each consisting of m letters, so Narek has n strings. To make the problem harder, he combines the problems by selecting some of the n strings possibly none and concatenating them without altering their order. His chance of solving the problem is defined as scoren\xe2\x88\x92scorec, where scoren is Narek\'s score and scorec is ChatGPT\'s score.Narek calculates scoren by examining the selected string (he moves from left to right). He initially searches for the letter ""n"", followed by ""a"", ""r"", ""e"", and ""k"". Upon finding all occurrences of these letters, he increments scoren by 5 and resumes searching for ""n"" again (he doesn\'t go back, and he just continues from where he left off). After Narek finishes, ChatGPT scans through the array and increments scorec by 1 for each letter ""n"", ""a"", ""r"", ""e"", or ""k"" that Narek fails to utilize (note that if Narek fails to complete the last occurrence by finding all of the 5 letters, then all of the letters he used are counted in ChatGPT\'s score scorec, and Narek doesn\'t get any points if he doesn\'t finish finding all the 5 letters).Narek aims to maximize the value of scoren\xe2\x88\x92scorec by selecting the most optimal subset of the initial strings." 1800
2005B2 "The Strict Teacher (Hard Version)" "binary search,greedy,math,sortings" "This is the hard version of the problem. The only differences between the two versions are the constraints on m and q. In this version, m,q\xe2\x89\xa4105. You can make hacks only if both versions of the problem are solved.Narek and Tsovak were busy preparing this round, so they have not managed to do their homework and decided to steal David\'s homework. Their strict teacher noticed that David has no homework and now wants to punish him. She hires other teachers to help her catch David. And now m teachers together are chasing him. Luckily, the classroom is big, so David has many places to hide.The classroom can be represented as a one-dimensional line with cells from 1 to n, inclusive.At the start, all m teachers and David are in distinct cells. Then they make moves. During each move   David goes to an adjacent cell or stays at the current one.  Then, each of the m teachers simultaneously goes to an adjacent cell or stays at the current one. This continues until David is caught. David is caught if any of the teachers (possibly more than one) is located in the same cell as David. Everyone sees others\' moves, so they all act optimally.Your task is to find how many moves it will take for the teachers to catch David if they all act optimally.Acting optimally means the student makes his moves in a way that maximizes the number of moves the teachers need to catch him; and the teachers coordinate with each other to make their moves in a way that minimizes the number of moves they need to catch the student.Also, as Narek and Tsovak think this task is easy, they decided to give you q queries on David\'s position." 1200
2005B1 "The Strict Teacher (Easy Version)" greedy,math,sortings "This is the easy version of the problem. The only differences between the two versions are the constraints on m and q. In this version, m=2 and q=1. You can make hacks only if both versions of the problem are solved.Narek and Tsovak were busy preparing this round, so they have not managed to do their homework and decided to steal David\'s homework. Their strict teacher noticed that David has no homework and now wants to punish him. She hires other teachers to help her catch David. And now m teachers together are chasing him. Luckily, the classroom is big, so David has many places to hide.The classroom can be represented as a one-dimensional line with cells from 1 to n, inclusive.At the start, all m teachers and David are in distinct cells. Then they make moves. During each move   David goes to an adjacent cell or stays at the current one.  Then, each of the m teachers simultaneously goes to an adjacent cell or stays at the current one. This continues until David is caught. David is caught if any of the teachers (possibly more than one) is located in the same cell as David. Everyone sees others\' moves, so they all act optimally.Your task is to find how many moves it will take for the teachers to catch David if they all act optimally.Acting optimally means the student makes his moves in a way that maximizes the number of moves the teachers need to catch him; and the teachers coordinate with each other to make their moves in a way that minimizes the number of moves they need to catch the student.Also, as Narek and Tsovak think this task is easy, they decided to give you q queries on David\'s position. Note: this is the easy version, and you are given only one query." 1000
2005A "Simple Palindrome" "combinatorics,constructive algorithms,greedy,math" "Narek has to spend 2 hours with some 2-year-old kids at the kindergarten. He wants to teach them competitive programming, and their first lesson is about palindromes.Narek found out that the kids only know the vowels of the English alphabet (the letters a, e, i, o, and u), so Narek needs to make a string that consists of vowels only. After making the string, he\'ll ask the kids to count the number of subsequences that are palindromes. Narek wants to keep it simple, so he\'s looking for a string such that the amount of palindrome subsequences is minimal.Help Narek find a string of length n, consisting of lowercase English vowels only (letters a, e, i, o, and u), which minimizes the amount of palindrome\xe2\x80\xa0 subsequences\xe2\x80\xa1 in it.\xe2\x80\xa0 A string is called a palindrome if it reads the same from left to right and from right to left.\xe2\x80\xa1 String t is a subsequence of string s if t can be obtained from s by removing several (possibly, zero or all) characters from s and concatenating the remaining ones, without changing their order. For example, odocs is a subsequence of codeforces." 900
2004G "Substring Compression" "data structures,dp,matrices" "Let\'s define the operation of compressing a string t, consisting of at least 2 digits from 1 to 9, as follows:   split it into an even number of non-empty substrings \xe2\x80\x94 let these substrings be t1,t2,\xe2\x80\xa6,tm (so, t=t1+t2+\xe2\x8b\xaf+tm, where + is the concatenation operation);  write the string t2 t1 times, then the string t4 t3 times, and so on. For example, for a string ""12345"", one could do the following: split it into (""1"", ""23"", ""4"", ""5""), and write ""235555"".Let the function f(t) for a string t return the minimum length of the string that can be obtained as a result of that process.You are given a string s, consisting of n digits from 1 to 9, and an integer k. Calculate the value of the function f for all contiguous substrings of s of length exactly k." 3200
2004F "Make a Palindrome" "binary search,brute force,data structures,greedy,math" "You are given an array a consisting of n integers.Let the function f(b) return the minimum number of operations needed to make an array b a palindrome. The operations you can make are:  choose two adjacent elements bi and bi+1, remove them, and replace them with a single element equal to (bi+bi+1);  or choose an element bi>1, remove it, and replace it with two positive integers x and y (x>0 and y>0) such that x+y=bi. For example, from an array b=[2,1,3], you can obtain the following arrays in one operation: [1,1,1,3], [2,1,1,2], [3,3], [2,4], or [2,1,2,1].Calculate (\xe2\x88\x911\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4nf(a[l..r])), where a[l..r] is the subarray of a from index l to index r, inclusive. In other words, find the sum of the values of the function f for all subarrays of the array a." 2600
2004E "Not a Nim Problem" "brute force,games,math,number theory" "Two players, Alice and Bob, are playing a game. They have n piles of stones, with the i-th pile initially containing ai stones.On their turn, a player can choose any pile of stones and take any positive number of stones from it, with one condition:  let the current number of stones in the pile be x. It is not allowed to take from the pile a number of stones y such that the greatest common divisor of x and y is not equal to 1. The player who cannot make a move loses. Both players play optimally (that is, if a player has a strategy that allows them to win, no matter how the opponent responds, they will win). Alice goes first.Determine who will win." 2100
2004D "Colored Portals" "binary search,brute force,data structures,graphs,greedy,implementation,shortest paths" "There are n cities located on a straight line. The cities are numbered from 1 to n.Portals are used to move between cities. There are 4 colors of portals: blue, green, red, and yellow. Each city has portals of two different colors. You can move from city i to city j if they have portals of the same color (for example, you can move between a ""blue-red"" city and a ""blue-green"" city). This movement costs |i\xe2\x88\x92j| coins.Your task is to answer q independent queries: calculate the minimum cost to move from city x to city y." 1600
2004C "Splitting Items" games,greedy,sortings "Alice and Bob have n items they\'d like to split between them, so they decided to play a game. All items have a cost, and the i-th item costs ai. Players move in turns starting from Alice.In each turn, the player chooses one of the remaining items and takes it. The game goes on until no items are left.Let\'s say that A is the total cost of items taken by Alice and B is the total cost of Bob\'s items. The resulting score of the game then will be equal to A\xe2\x88\x92B.Alice wants to maximize the score, while Bob wants to minimize it. Both Alice and Bob will play optimally.But the game will take place tomorrow, so today Bob can modify the costs a little. He can increase the costs ai of several (possibly none or all) items by an integer value (possibly, by the same value or by different values for each item). However, the total increase must be less than or equal to k. Otherwise, Alice may suspect something. Note that Bob can\'t decrease costs, only increase.What is the minimum possible score Bob can achieve?" 1100
2004B "Game with Doors" "brute force,greedy" "There are 100 rooms arranged in a row and 99 doors between them; the i-th door connects rooms i and i+1. Each door can be either locked or unlocked. Initially, all doors are unlocked.We say that room x is reachable from room y if all doors between them are unlocked.You know that:   Alice is in some room from the segment [l,r];  Bob is in some room from the segment [L,R];  Alice and Bob are in different rooms. However, you don\'t know the exact rooms they are in.You don\'t want Alice and Bob to be able to reach each other, so you are going to lock some doors to prevent that. What\'s the smallest number of doors you have to lock so that Alice and Bob cannot meet, regardless of their starting positions inside the given segments?" 1000
2004A "Closest Point" implementation,math "Consider a set of points on a line. The distance between two points i and j is |i\xe2\x88\x92j|.The point i from the set is the closest to the point j from the set, if there is no other point k in the set such that the distance from j to k is strictly less than the distance from j to i. In other words, all other points from the set have distance to j greater or equal to |i\xe2\x88\x92j|.For example, consider a set of points {1,3,5,8}:  for the point 1, the closest point is 3 (other points have distance greater than |1\xe2\x88\x923|=2);  for the point 3, there are two closest points: 1 and 5;  for the point 5, the closest point is 3 (but not 8, since its distance is greater than |3\xe2\x88\x925|);  for the point 8, the closest point is 5. You are given a set of points. You have to add an integer point into this set in such a way that it is different from every existing point in the set, and it becomes the closest point to every point in the set. Is it possible?" 800
2003F "Turtle and Three Sequences" "brute force,data structures,dp,greedy,math,probabilities,two pointers" "Piggy gives Turtle three sequences a1,a2,\xe2\x80\xa6,an, b1,b2,\xe2\x80\xa6,bn, and c1,c2,\xe2\x80\xa6,cn.Turtle will choose a subsequence of 1,2,\xe2\x80\xa6,n of length m, let it be p1,p2,\xe2\x80\xa6,pm. The subsequence should satisfy the following conditions:  ap1\xe2\x89\xa4ap2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4apm;  All bpi for all indices i are pairwise distinct, i.e., there don\'t exist two different indices i, j such that bpi=bpj. Help him find the maximum value of m\xe2\x88\x91i=1cpi, or tell him that it is impossible to choose a subsequence of length m that satisfies the conditions above.Recall that a sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) elements." 2800
2003E2 "Turtle and Inversions (Hard Version)" "brute force,data structures,divide and conquer,dp,greedy,math,two pointers" "This is a hard version of this problem. The differences between the versions are the constraint on m and ri<li+1 holds for each i from 1 to m\xe2\x88\x921 in the easy version. You can make hacks only if both versions of the problem are solved.Turtle gives you m intervals [l1,r1],[l2,r2],\xe2\x80\xa6,[lm,rm]. He thinks that a permutation p is interesting if there exists an integer ki for every interval (li\xe2\x89\xa4ki<ri), and if he lets ai=kimaxj=lipj,bi=riminj=ki+1pj for every integer i from 1 to m, the following condition holds:mmaxi=1ai<mmini=1biTurtle wants you to calculate the maximum number of inversions of all interesting permutations of length n, or tell him if there is no interesting permutation.An inversion of a permutation p is a pair of integers (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) such that pi>pj." 2700
2003E1 "Turtle and Inversions (Easy Version)" "brute force,divide and conquer,dp,greedy,math" "This is an easy version of this problem. The differences between the versions are the constraint on m and ri<li+1 holds for each i from 1 to m\xe2\x88\x921 in the easy version. You can make hacks only if both versions of the problem are solved.Turtle gives you m intervals [l1,r1],[l2,r2],\xe2\x80\xa6,[lm,rm]. He thinks that a permutation p is interesting if there exists an integer ki for every interval (li\xe2\x89\xa4ki<ri), and if he lets ai=kimaxj=lipj,bi=riminj=ki+1pj for every integer i from 1 to m, the following condition holds:mmaxi=1ai<mmini=1biTurtle wants you to calculate the maximum number of inversions of all interesting permutations of length n, or tell him if there is no interesting permutation.An inversion of a permutation p is a pair of integers (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) such that pi>pj." 2600
2003D2 "Turtle and a MEX Problem (Hard Version)" "dfs and similar,dp,graphs,greedy,implementation,math" "The two versions are different problems. In this version of the problem, you can\'t choose the same integer twice or more. You can make hacks only if both versions are solved.One day, Turtle was playing with n sequences. Let the length of the i-th sequence be li. Then the i-th sequence was ai,1,ai,2,\xe2\x80\xa6,ai,li.Piggy gave Turtle a problem to solve when Turtle was playing. The statement of the problem was:  There was a non-negative integer x at first. Turtle would perform an arbitrary number (possibly zero) of operations on the integer.  In each operation, Turtle could choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n and i wasn\'t chosen before, and set x to mex\xe2\x80\xa0(x,ai,1,ai,2,\xe2\x80\xa6,ai,li).  Turtle was asked to find the answer, which was the maximum value of x after performing an arbitrary number of operations. Turtle solved the above problem without difficulty. He defined f(k) as the answer to the above problem when the initial value of x was k.Then Piggy gave Turtle a non-negative integer m and asked Turtle to find the value of m\xe2\x88\x91i=0f(i) (i.e., the value of f(0)+f(1)+\xe2\x80\xa6+f(m)). Unfortunately, he couldn\'t solve this problem. Please help him!\xe2\x80\xa0mex(c1,c2,\xe2\x80\xa6,ck) is defined as the smallest non-negative integer x which does not occur in the sequence c. For example, mex(2,2,0,3) is 1, mex(1,2) is 0." 2100
2003D1 "Turtle and a MEX Problem (Easy Version)" greedy,math "The two versions are different problems. In this version of the problem, you can choose the same integer twice or more. You can make hacks only if both versions are solved.One day, Turtle was playing with n sequences. Let the length of the i-th sequence be li. Then the i-th sequence was ai,1,ai,2,\xe2\x80\xa6,ai,li.Piggy gave Turtle a problem to solve when Turtle was playing. The statement of the problem was:  There was a non-negative integer x at first. Turtle would perform an arbitrary number (possibly zero) of operations on the integer.  In each operation, Turtle could choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n, and set x to mex\xe2\x80\xa0(x,ai,1,ai,2,\xe2\x80\xa6,ai,li).  Turtle was asked to find the answer, which was the maximum value of x after performing an arbitrary number of operations. Turtle solved the above problem without difficulty. He defined f(k) as the answer to the above problem when the initial value of x was k.Then Piggy gave Turtle a non-negative integer m and asked Turtle to find the value of m\xe2\x88\x91i=0f(i) (i.e., the value of f(0)+f(1)+\xe2\x80\xa6+f(m)). Unfortunately, he couldn\'t solve this problem. Please help him!\xe2\x80\xa0mex(c1,c2,\xe2\x80\xa6,ck) is defined as the smallest non-negative integer x which does not occur in the sequence c. For example, mex(2,2,0,3) is 1, mex(1,2) is 0." 1500
2003C "Turtle and Good Pairs" "constructive algorithms,greedy,sortings,strings" "Turtle gives you a string s, consisting of lowercase Latin letters.Turtle considers a pair of integers (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) to be a pleasant pair if and only if there exists an integer k such that i\xe2\x89\xa4k<j and both of the following two conditions hold:  sk\xe2\x89\xa0sk+1;  sk\xe2\x89\xa0si or sk+1\xe2\x89\xa0sj. Besides, Turtle considers a pair of integers (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) to be a good pair if and only if si=sj or (i,j) is a pleasant pair.Turtle wants to reorder the string s so that the number of good pairs is maximized. Please help him!" 1200
2003B "Turtle and Piggy Are Playing a Game 2" games,greedy,sortings "Turtle and Piggy are playing a game on a sequence. They are given a sequence a1,a2,\xe2\x80\xa6,an, and Turtle goes first. Turtle and Piggy alternate in turns (so, Turtle does the first turn, Piggy does the second, Turtle does the third, etc.).The game goes as follows:  Let the current length of the sequence be m. If m=1, the game ends.  If the game does not end and it\'s Turtle\'s turn, then Turtle must choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4m\xe2\x88\x921, set ai to max(ai,ai+1), and remove ai+1.  If the game does not end and it\'s Piggy\'s turn, then Piggy must choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4m\xe2\x88\x921, set ai to min(ai,ai+1), and remove ai+1. Turtle wants to maximize the value of a1 in the end, while Piggy wants to minimize the value of a1 in the end. Find the value of a1 in the end if both players play optimally.You can refer to notes for further clarification." 800
2003A "Turtle and Good Strings" greedy,strings "Turtle thinks a string s is a good string if there exists a sequence of strings t1,t2,\xe2\x80\xa6,tk (k is an arbitrary integer) such that:  k\xe2\x89\xa52.  s=t1+t2+\xe2\x80\xa6+tk, where + represents the concatenation operation. For example, abc=a+bc.  For all 1\xe2\x89\xa4i<j\xe2\x89\xa4k, the first character of ti isn\'t equal to the last character of tj. Turtle is given a string s consisting of lowercase Latin letters. Please tell him whether the string s is a good string!" 800
2002H "Counting 101" greedy "It\'s been a long summer\'s day, with the constant chirping of cicadas and the heat which never seemed to end. Finally, it has drawn to a close. The showdown has passed, the gates are open, and only a gentle breeze is left behind.Your predecessors had taken their final bow; it\'s your turn to take the stage.Sorting through some notes that were left behind, you found a curious statement named Problem 101:  Given a positive integer sequence a1,a2,\xe2\x80\xa6,an, you can operate on it any number of times. In an operation, you choose three consecutive elements ai,ai+1,ai+2, and merge them into one element max(ai+1,ai+1,ai+2+1). Please calculate the maximum number of operations you can do without creating an element greater than m. After some thought, you decided to propose the following problem, named Counting 101:  Given n and m. For each k=0,1,\xe2\x80\xa6,\xe2\x8c\x8an\xe2\x88\x9212\xe2\x8c\x8b, please find the number of integer sequences a1,a2,\xe2\x80\xa6,an with elements in [1,m], such that when used as input for Problem 101, the answer is k. As the answer can be very large, please print it modulo 109+7." 3500
2002G "Lattice Optimizing" "bitmasks,brute force,hashing,meet-in-the-middle" "Consider a grid graph with n rows and n columns. Let the cell in row x and column y be (x,y). There exists a directed edge from (x,y) to (x+1,y), with non-negative integer value dx,y, for all 1\xe2\x89\xa4x<n,1\xe2\x89\xa4y\xe2\x89\xa4n, and there also exists a directed edge from (x,y) to (x,y+1), with non-negative integer value rx,y, for all 1\xe2\x89\xa4x\xe2\x89\xa4n,1\xe2\x89\xa4y<n.Initially, you are at (1,1), with an empty set S. You need to walk along the edges and eventually reach (n,n). Whenever you pass an edge, its value will be inserted into S. Please maximize the MEX\xe2\x88\x97 of S when you reach (n,n).\xe2\x88\x97The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:   The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0,1,2, and 3 belong to the array, but 4 does not." 3400
2002F2 "Court Blue (Hard Version)" "brute force,dp,math,number theory" "This is the hard version of the problem. In this version, it is not guaranteed that n=m, and the time limit is higher. You can make hacks only if both versions of the problem are solved.In the court of the Blue King, Lelle and Flamm are having a performance match. The match consists of several rounds. In each round, either Lelle or Flamm wins.Let WL and WF denote the number of wins of Lelle and Flamm, respectively. The Blue King considers a match to be successful if and only if:  after every round, gcd(WL,WF)\xe2\x89\xa41;  at the end of the match, WL\xe2\x89\xa4n,WF\xe2\x89\xa4m. Note that gcd(0,x)=gcd(x,0)=x for every non-negative integer x.Lelle and Flamm can decide to stop the match whenever they want, and the final score of the performance is l\xe2\x8b\x85WL+f\xe2\x8b\x85WF.Please help Lelle and Flamm coordinate their wins and losses such that the performance is successful, and the total score of the performance is maximized." 2800
2002F1 "Court Blue (Easy Version)" "brute force,dfs and similar,dp,math,number theory" "This is the easy version of the problem. In this version, n=m and the time limit is lower. You can make hacks only if both versions of the problem are solved.In the court of the Blue King, Lelle and Flamm are having a performance match. The match consists of several rounds. In each round, either Lelle or Flamm wins.Let WL and WF denote the number of wins of Lelle and Flamm, respectively. The Blue King considers a match to be successful if and only if:  after every round, gcd(WL,WF)\xe2\x89\xa41;  at the end of the match, WL\xe2\x89\xa4n,WF\xe2\x89\xa4m. Note that gcd(0,x)=gcd(x,0)=x for every non-negative integer x.Lelle and Flamm can decide to stop the match whenever they want, and the final score of the performance is l\xe2\x8b\x85WL+f\xe2\x8b\x85WF.Please help Lelle and Flamm coordinate their wins and losses such that the performance is successful, and the total score of the performance is maximized." 2600
2002E "Cosmic Rays" "brute force,data structures,dp" "Given an array of integers s1,s2,\xe2\x80\xa6,sl, every second, cosmic rays will cause all si such that i=1 or si\xe2\x89\xa0si\xe2\x88\x921 to be deleted simultaneously, and the remaining parts will be concatenated together in order to form the new array s1,s2,\xe2\x80\xa6,sl\xe2\x80\xb2.Define the strength of an array as the number of seconds it takes to become empty.You are given an array of integers compressed in the form of n pairs that describe the array left to right. Each pair (ai,bi) represents ai copies of bi, i.e. bi,bi,\xe2\x8b\xaf,bi\xe2\x8f\x9fai times.For each i=1,2,\xe2\x80\xa6,n, please find the strength of the sequence described by the first i pairs." 2300
2002D2 "DFS Checker (Hard Version)" "binary search,data structures,dfs and similar,graphs,hashing,trees" "This is the hard version of the problem. In this version, you are given a generic tree and the constraints on n and q are higher. You can make hacks only if both versions of the problem are solved.You are given a rooted tree consisting of n vertices. The vertices are numbered from 1 to n, and the root is the vertex 1. You are also given a permutation p1,p2,\xe2\x80\xa6,pn of [1,2,\xe2\x80\xa6,n].You need to answer q queries. For each query, you are given two integers x, y; you need to swap px and py and determine if p1,p2,\xe2\x80\xa6,pn is a valid DFS order\xe2\x80\xa0 of the given tree.Please note that the swaps are persistent through queries.\xe2\x80\xa0 A DFS order is found by calling the following dfs function on the given tree.dfs_order = []function dfs(v):    append v to the back of dfs_order    pick an arbitrary permutation s of children of v    for child in s:        dfs(child)dfs(1)Note that the DFS order is not unique." 2300
2002D1 "DFS Checker (Easy Version)" "brute force,data structures,dfs and similar,graphs,hashing,trees" "This is the easy version of the problem. In this version, the given tree is a perfect binary tree and the constraints on n and q are lower. You can make hacks only if both versions of the problem are solved.You are given a perfect binary tree\xe2\x80\xa0 consisting of n vertices. The vertices are numbered from 1 to n, and the root is the vertex 1. You are also given a permutation p1,p2,\xe2\x80\xa6,pn of [1,2,\xe2\x80\xa6,n].You need to answer q queries. For each query, you are given two integers x, y; you need to swap px and py and determine if p1,p2,\xe2\x80\xa6,pn is a valid DFS order\xe2\x80\xa1 of the given tree.Please note that the swaps are persistent through queries.\xe2\x80\xa0 A perfect binary tree is a tree with vertex 1 as its root, with size n=2k\xe2\x88\x921 for a positive integer k, and where the parent of each vertex i (1<i\xe2\x89\xa4n) is \xe2\x8c\x8ai2\xe2\x8c\x8b. Thus, all leaves of this tree are at a distance k\xe2\x88\x921 from the root.\xe2\x80\xa1 A DFS order is found by calling the following dfs function on the given tree.dfs_order = []function dfs(v):    append v to the back of dfs_order    pick an arbitrary permutation s of children of v    for child in s:        dfs(child)dfs(1)Note that the DFS order is not unique." 1900
2002C "Black Circles" "brute force,geometry,greedy,math" "There are n circles on a two-dimensional plane. The i-th circle is centered at (xi,yi). Initially, all circles have a radius of 0.The circles\' radii increase at a rate of 1 unit per second.You are currently at (xs,ys); your goal is to reach (xt,yt) without touching the circumference of any circle (including the moment you reach (xt,yt)). You can move in any direction you want. However, your speed is limited to 1 unit per second.Please determine whether this is possible." 1200
2002B "Removals Game" "constructive algorithms,games" "Alice got a permutation a1,a2,\xe2\x80\xa6,an of [1,2,\xe2\x80\xa6,n], and Bob got another permutation b1,b2,\xe2\x80\xa6,bn of [1,2,\xe2\x80\xa6,n]. They are going to play a game with these arrays.In each turn, the following events happen in order:  Alice chooses either the first or the last element of her array and removes it from the array;  Bob chooses either the first or the last element of his array and removes it from the array. The game continues for n\xe2\x88\x921 turns, after which both arrays will have exactly one remaining element: x in the array a and y in the array b.If x=y, Bob wins; otherwise, Alice wins. Find which player will win if both players play optimally." 1000
2002A "Distanced Coloring" "constructive algorithms,implementation,math" "You received an n\xc3\x97m grid from a mysterious source. The source also gave you a magic positive integer constant k.The source told you to color the grid with some colors, satisfying the following condition:  If (x1,y1), (x2,y2) are two distinct cells with the same color, then max(|x1\xe2\x88\x92x2|,|y1\xe2\x88\x92y2|)\xe2\x89\xa5k. You don\'t like using too many colors. Please find the minimum number of colors needed to color the grid." 800
2001E2 "Deterministic Heap (Hard Version)" combinatorics,dp,trees "This is the hard version of the problem. The difference between the two versions is the definition of deterministic max-heap, time limit, and constraints on n and t. You can make hacks only if both versions of the problem are solved.Consider a perfect binary tree with size 2n\xe2\x88\x921, with nodes numbered from 1 to 2n\xe2\x88\x921 and rooted at 1. For each vertex v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921\xe2\x88\x921), vertex 2v is its left child and vertex 2v+1 is its right child. Each node v also has a value av assigned to it.Define the operation pop as follows:  initialize variable v as 1;  repeat the following process until vertex v is a leaf (i.e. until 2n\xe2\x88\x921\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921);   among the children of v, choose the one with the larger value on it and denote such vertex as x; if the values on them are equal (i.e. a2v=a2v+1), you can choose any of them;  assign ax to av (i.e. av:=ax);  assign x to v (i.e. v:=x);   assign \xe2\x88\x921 to av (i.e. av:=\xe2\x88\x921). Then we say the pop operation is deterministic if there is a unique way to do such operation. In other words, a2v\xe2\x89\xa0a2v+1 would hold whenever choosing between them.A binary tree is called a max-heap if for every vertex v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921\xe2\x88\x921), both av\xe2\x89\xa5a2v and av\xe2\x89\xa5a2v+1 hold.A max-heap is deterministic if the pop operation is deterministic to the heap when we do it for the first and the second time.Initially, av:=0 for every vertex v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921), and your goal is to count the number of different deterministic max-heaps produced by applying the following operation add exactly k times:  Choose an integer v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921) and, for every vertex x on the path between 1 and v, add 1 to ax. Two heaps are considered different if there is a node which has different values in the heaps. Since the answer might be large, print it modulo p." 2900
2001E1 "Deterministic Heap (Easy Version)" combinatorics,dp,math,trees "This is the easy version of the problem. The difference between the two versions is the definition of deterministic max-heap, time limit, and constraints on n and t. You can make hacks only if both versions of the problem are solved.Consider a perfect binary tree with size 2n\xe2\x88\x921, with nodes numbered from 1 to 2n\xe2\x88\x921 and rooted at 1. For each vertex v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921\xe2\x88\x921), vertex 2v is its left child and vertex 2v+1 is its right child. Each node v also has a value av assigned to it.Define the operation pop as follows:  initialize variable v as 1;  repeat the following process until vertex v is a leaf (i.e. until 2n\xe2\x88\x921\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921);   among the children of v, choose the one with the larger value on it and denote such vertex as x; if the values on them are equal (i.e. a2v=a2v+1), you can choose any of them;  assign ax to av (i.e. av:=ax);  assign x to v (i.e. v:=x);   assign \xe2\x88\x921 to av (i.e. av:=\xe2\x88\x921). Then we say the pop operation is deterministic if there is a unique way to do such operation. In other words, a2v\xe2\x89\xa0a2v+1 would hold whenever choosing between them.A binary tree is called a max-heap if for every vertex v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921\xe2\x88\x921), both av\xe2\x89\xa5a2v and av\xe2\x89\xa5a2v+1 hold.A max-heap is deterministic if the pop operation is deterministic to the heap when we do it for the first time.Initially, av:=0 for every vertex v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921), and your goal is to count the number of different deterministic max-heaps produced by applying the following operation add exactly k times:  Choose an integer v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921) and, for every vertex x on the path between 1 and v, add 1 to ax. Two heaps are considered different if there is a node which has different values in the heaps. Since the answer might be large, print it modulo p." 2400
2001D "Longest Max Min Subsequence" "brute force,constructive algorithms,data structures,greedy,implementation" "You are given an integer sequence a1,a2,\xe2\x80\xa6,an. Let S be the set of all possible non-empty subsequences of a without duplicate elements. Your goal is to find the longest sequence in S. If there are multiple of them, find the one that minimizes lexicographical order after multiplying terms at odd positions by \xe2\x88\x921.For example, given a=[3,2,3,1], S={[1],[2],[3],[2,1],[2,3],[3,1],[3,2],[2,3,1],[3,2,1]}. Then [2,3,1] and [3,2,1] would be the longest, and [3,2,1] would be the answer since [\xe2\x88\x923,2,\xe2\x88\x921] is lexicographically smaller than [\xe2\x88\x922,3,\xe2\x88\x921].A sequence c is a subsequence of a sequence d if c can be obtained from d by the deletion of several (possibly, zero or all) elements.A sequence c is lexicographically smaller than a sequence d if and only if one of the following holds: c is a prefix of d, but c\xe2\x89\xa0d; in the first position where c and d differ, the sequence c has a smaller element than the corresponding element in d." 1900
2001C "Guess The Tree" "binary search,brute force,dfs and similar,divide and conquer,dsu,greedy,interactive,trees" "This is an interactive problem.Misuki has chosen a secret tree with n nodes, indexed from 1 to n, and asked you to guess it by using queries of the following type:   ""? a b"" \xe2\x80\x94 Misuki will tell you which node x minimizes |d(a,x)\xe2\x88\x92d(b,x)|, where d(x,y) is the distance between nodes x and y. If more than one such node exists, Misuki will tell you the one which minimizes d(a,x). Find out the structure of Misuki\'s secret tree using at most 15n queries!" 1500
2001B "Generate Permutation" "constructive algorithms" "There is an integer sequence a of length n, where each element is initially \xe2\x88\x921.Misuki has two typewriters where the first one writes letters from left to right, with a pointer initially pointing to 1, and another writes letters from right to left with a pointer initially pointing to n.Misuki would choose one of the typewriters and use it to perform the following operations until a becomes a permutation of [1,2,\xe2\x80\xa6,n]  write number: write the minimum positive integer that isn\'t present in the array a to the element ai, i is the position where the pointer points at. Such operation can be performed only when ai=\xe2\x88\x921.  carriage return: return the pointer to its initial position (i.e. 1 for the first typewriter, n for the second)  move pointer: move the pointer to the next position, let i be the position the pointer points at before this operation, if Misuki is using the first typewriter, i:=i+1 would happen, and i:=i\xe2\x88\x921 otherwise. Such operation can be performed only if after the operation, 1\xe2\x89\xa4i\xe2\x89\xa4n holds. Your task is to construct any permutation p of length n, such that the minimum number of carriage return operations needed to make a=p is the same no matter which typewriter Misuki is using." 800
2001A "Make All Equal" greedy,implementation "You are given a cyclic array a1,a2,\xe2\x80\xa6,an.You can perform the following operation on a at most n\xe2\x88\x921 times:  Let m be the current size of a, you can choose any two adjacent elements where the previous one is no greater than the latter one (In particular, am and a1 are adjacent and am is the previous one), and delete exactly one of them. In other words, choose an integer i (1\xe2\x89\xa4i\xe2\x89\xa4m) where ai\xe2\x89\xa4a(imodm)+1 holds, and delete exactly one of ai or a(imodm)+1 from a. Your goal is to find the minimum number of operations needed to make all elements in a equal." 800
2000H "Ksyusha and the Loaded Set" "binary search,brute force,data structures,implementation" "Ksyusha decided to start a game development company. To stand out among competitors and achieve success, she decided to write her own game engine. The engine must support a set initially consisting of n distinct integers a1,a2,\xe2\x80\xa6,an.The set will undergo m operations sequentially. The operations can be of the following types:   Insert element x into the set;  Remove element x from the set;  Report the k-load of the set. The k-load of the set is defined as the minimum positive integer d such that the integers d,d+1,\xe2\x80\xa6,d+(k\xe2\x88\x921) do not appear in this set. For example, the 3-load of the set {3,4,6,11} is 7, since the integers 7,8,9 are absent from the set, and no smaller value fits.Ksyusha is busy with management tasks, so you will have to write the engine. Implement efficient support for the described operations." 2200
2000G "Call During the Journey" "binary search,brute force,graphs,greedy,shortest paths" "You live in a city consisting of n intersections and m streets connecting some pairs of intersections. You can travel in either direction on each street. No two streets connect the same pair of intersections, and no street connects an intersection to itself. You can reach any intersection from any other, possibly passing through some other intersections.Every minute, you can board a bus at intersection ui and travel for li1 minutes to intersection vi. Conversely, you can travel from intersection vi to intersection ui in li1 minutes. You can only board and exit the bus at intersections. You can only board the bus at an intersection if you are currently there.You can also walk along each street, which takes li2>li1 minutes.You can make stops at intersections.You live at intersection number 1. Today you woke up at time 0, and you have an important event scheduled at intersection number n, which you must reach no later than time t0. You also have a phone call planned that will last from t1 to t2 minutes (t1<t2<t0). During the phone call, you cannot ride the bus, but you can walk along any streets, make stops, or stay at home. You can exit the bus at minute t1 and board the bus again at minute t2.Since you want to get enough sleep, you became curious \xe2\x80\x94 how late can you leave home to have time to talk on the phone and still not be late for the event?" 2100
2000F "Color Rows and Columns" dp,greedy,implementation,math "You have n rectangles, the i-th of which has a width of ai and a height of bi.You can perform the following operation an unlimited number of times: choose a rectangle and a cell in it, and then color it.Each time you completely color any row or column, you earn 1 point. Your task is to score at least k points with as few operations as possible.Suppose you have a rectangle with a width of 6 and a height of 3. You can score 4 points by coloring all the cells in any 4 columns, thus performing 12 operations." 1900
2000E "Photoshoot for Gorillas" "combinatorics,data structures,greedy,math" "You really love gorillas, so you decided to organize a photoshoot for them. Gorillas live in the jungle. The jungle is represented as a grid of n rows and m columns. w gorillas agreed to participate in the photoshoot, and the gorilla with index i (1\xe2\x89\xa4i\xe2\x89\xa4w) has a height of ai. You want to place all the gorillas in the cells of the grid such that there is no more than one gorilla in each cell.The spectacle of the arrangement is equal to the sum of the spectacles of all sub-squares of the grid with a side length of k.The spectacle of a sub-square is equal to the sum of the heights of the gorillas in it.From all suitable arrangements, choose the arrangement with the maximum spectacle." 1400
2000D "Right Left Wrong" "greedy,implementation,two pointers" "Vlad found a strip of n cells, numbered from left to right from 1 to n. In the i-th cell, there is a positive integer ai and a letter si, where all si are either \'L\' or \'R\'.Vlad invites you to try to score the maximum possible points by performing any (possibly zero) number of operations.In one operation, you can choose two indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n) such that sl = \'L\' and sr = \'R\' and do the following:  add al+al+1+\xe2\x8b\xaf+ar\xe2\x88\x921+ar points to the current score;  replace si with \'.\' for all l\xe2\x89\xa4i\xe2\x89\xa4r, meaning you can no longer choose these indices. For example, consider the following strip: 351432LRLLLR You can first choose l=1, r=2 and add 3+5=8 to your score. 351432..LLLR Then choose l=3, r=6 and add 1+4+3+2=10 to your score. 351432...... As a result, it is impossible to perform another operation, and the final score is 18.What is the maximum score that can be achieved?" 1200
2000C "Numeric String Template" "data structures,strings" "Kristina has an array a, called a template, consisting of n integers. She also has m strings, each consisting only of lowercase Latin letters. The strings are numbered from 1 to m. She wants to check which strings match the template.A string s is considered to match the template if all of the following conditions are simultaneously satisfied:  The length of the string s is equal to the number of elements in the array a. The same numbers from a correspond to the same symbols from s. So, if ai=aj, then si=sj for (1\xe2\x89\xa4i,j\xe2\x89\xa4n). The same symbols from s correspond to the same numbers from a. So, if si=sj, then ai=aj for (1\xe2\x89\xa4i,j\xe2\x89\xa4n). In other words, there must be a one-to-one correspondence between the characters of the string and the elements of the array.For example, if a = [3,5,2,1,3], then the string ""abfda"" matches the template, while the string ""afbfa"" does not, since the character ""f"" corresponds to both numbers 1 and 5." 1000
2000B "Seating in a Bus" "two pointers" "In Berland, a bus consists of a row of n seats numbered from 1 to n. Passengers are advised to always board the bus following these rules:   If there are no occupied seats in the bus, a passenger can sit in any free seat; Otherwise, a passenger should sit in any free seat that has at least one occupied neighboring seat. In other words, a passenger can sit in a seat with index i (1\xe2\x89\xa4i\xe2\x89\xa4n) only if at least one of the seats with indices i\xe2\x88\x921 or i+1 is occupied. Today, n passengers boarded the bus. The array a chronologically records the seat numbers they occupied. That is, a1 contains the seat number where the first passenger sat, a2 \xe2\x80\x94 the seat number where the second passenger sat, and so on.You know the contents of the array a. Determine whether all passengers followed the recommendations.For example, if n=5, and a = [5,4,2,1,3], then the recommendations were not followed, as the 3-rd passenger sat in seat number 2, while the neighboring seats with numbers 1 and 3 were free." 800
2000A "Primary Task" implementation,math,strings "Dmitry wrote down t integers on the board, and that is good. He is sure that he lost an important integer n among them, and that is bad.The integer n had the form 10^x (x\xe2\x89\xa52), where the symbol \'^\' denotes exponentiation.. Something went wrong, and Dmitry missed the symbol \'^\' when writing the important integer. For example, instead of the integer 105, he would have written 105, and instead of 1019, he would have written 1019.Dmitry wants to understand which of the integers on the board could have been the important integer and which could not." 800
1999G2 "Ruler (hard version)" "binary search,interactive,ternary search" "This is the hard version of the problem. The only difference between the two versions is that in this version, you can make at most 7 queries.This is an interactive problem. If you are unsure how interactive problems work, then it is recommended to read the guide for participants.We have a secret ruler that is missing one number x (2\xe2\x89\xa4x\xe2\x89\xa4999). When you measure an object of length y, the ruler reports the following values:   If y<x, the ruler (correctly) measures the object as having length y.  If y\xe2\x89\xa5x, the ruler incorrectly measures the object as having length y+1.  The ruler above is missing the number 4, so it correctly measures the first segment as length 3 but incorrectly measures the second segment as length 6 even though it is actually 5. You need to find the value of x. To do that, you can make queries of the following form:  ? a b \xe2\x80\x94 in response, we will measure the side lengths of an a\xc3\x97b rectangle with our ruler and multiply the results, reporting the measured area of the rectangle back to you. For example, if x=4 and you query a 3\xc3\x975 rectangle, we will measure its side lengths as 3\xc3\x976 and report 18 back to you. Find the value of x. You can ask at most 7 queries." 1700
1999G1 "Ruler (easy version)" "binary search,interactive" "This is the easy version of the problem. The only difference between the two versions is that in this version, you can make at most 10 queries.This is an interactive problem. If you are unsure how interactive problems work, then it is recommended to read the guide for participants.We have a secret ruler that is missing one number x (2\xe2\x89\xa4x\xe2\x89\xa4999). When you measure an object of length y, the ruler reports the following values:   If y<x, the ruler (correctly) measures the object as having length y.  If y\xe2\x89\xa5x, the ruler incorrectly measures the object as having length y+1.  The ruler above is missing the number 4, so it correctly measures the first segment as length 3 but incorrectly measures the second segment as length 6 even though it is actually 5. You need to find the value of x. To do that, you can make queries of the following form:  ? a b \xe2\x80\x94 in response, we will measure the side lengths of an a\xc3\x97b rectangle with our ruler and multiply the results, reporting the measured area of the rectangle back to you. For example, if x=4 and you query a 3\xc3\x975 rectangle, we will measure its side lengths as 3\xc3\x976 and report 18 back to you. Find the value of x. You can ask at most 10 queries." 1500
1999F "Expected Median" combinatorics,math "Arul has a binary array\xe2\x88\x97 a of length n.He will take all subsequences\xe2\x80\xa0 of length k (k is odd) of this array and find their median.\xe2\x80\xa1What is the sum of all these values?As this sum can be very large, output it modulo 109+7. In other words, print the remainder of this sum when divided by 109+7.\xe2\x88\x97A binary array is an array consisting only of zeros and ones.\xe2\x80\xa0An array b is a subsequence of an array a if b can be obtained from a by the deletion of several (possibly, zero or all) elements. Subsequences don\'t have to be contiguous.\xe2\x80\xa1The median of an array of odd length k is the k+12-th element when sorted." 1500
1999E "Triple Operations" dp,implementation,math "On the board Ivy wrote down all integers from l to r, inclusive.In an operation, she does the following:   pick two numbers x and y on the board, erase them, and in their place write the numbers 3x and \xe2\x8c\x8ay3\xe2\x8c\x8b. (Here \xe2\x8c\x8a\xe2\x88\x99\xe2\x8c\x8b denotes rounding down to the nearest integer). What is the minimum number of operations Ivy needs to make all numbers on the board equal 0? We have a proof that this is always possible." 1300
1999D "Slavic\'s Exam" greedy,implementation,strings "Slavic has a very tough exam and needs your help in order to pass it. Here is the question he is struggling with:There exists a string s, which consists of lowercase English letters and possibly zero or more ""?"". Slavic is asked to change each ""?"" to a lowercase English letter such that string t becomes a subsequence (not necessarily continuous) of the string s. Output any such string, or say that it is impossible in case no string that respects the conditions exists." 1100
1999C Showering greedy,implementation "As a computer science student, Alex faces a hard challenge \xe2\x80\x94 showering. He tries to shower daily, but despite his best efforts there are always challenges. He takes s minutes to shower and a day only has m minutes! He already has n tasks planned for the day. Task i is represented as an interval (li, ri), which means that Alex is busy and can not take a shower in that time interval (at any point in time strictly between li and ri). No two tasks overlap.Given all n time intervals, will Alex be able to shower that day? In other words, will Alex have a free time interval of length at least s? In the first test case, Alex can shower for the first 3 minutes of the day and not miss any of the tasks." 800
1999B "Card Game" "brute force,constructive algorithms,implementation" "Suneet and Slavic play a card game. The rules of the game are as follows:  Each card has an integer value between 1 and 10.  Each player receives 2 cards which are face-down (so a player doesn\'t know their cards).  The game is turn-based and consists exactly of two turns. In a round, both players pick a random unflipped card and flip it. The player who flipped a card with a strictly greater number wins the round. In case of equality, no one wins the round.  A player wins a game if he wins the most number of rounds (i.e. strictly greater than the other player). In case of equality, no one wins the game. Since Suneet and Slavic aren\'t best friends, you need to calculate the number of ways the game could happen that Suneet would end up as the winner.For a better understanding, please check the notes section." 1000
1999A "A+B Again?" implementation,math "Given a two-digit positive integer n, find the sum of its digits." 800
1998E2 "Eliminating Balls With Merging (Hard Version)" "binary search,brute force,data structures,divide and conquer,greedy,implementation" "Drink water.\xe2\x80\x94 Sun Tzu, The Art of Becoming a Healthy ProgrammerThis is the hard version of the problem. The only difference is that x=1 in this version. You must solve both versions to be able to hack.You are given two integers n and x (x=1). There are n balls lined up in a row, numbered from 1 to n from left to right. Initially, there is a value ai written on the i-th ball.For each integer i from 1 to n, we define a function f(i) as follows:   Suppose you have a set S={1,2,\xe2\x80\xa6,i}.  In each operation, you have to select an integer l (1\xe2\x89\xa4l<i) from S such that l is not the largest element of S. Suppose r is the smallest element in S which is greater than l.   If al>ar, you set al=al+ar and remove r from S.  If al<ar, you set ar=al+ar and remove l from S.  If al=ar, you choose either the integer l or r to remove from S:   If you choose to remove l from S, you set ar=al+ar and remove l from S.  If you choose to remove r from S, you set al=al+ar and remove r from S.    f(i) denotes the number of integers j (1\xe2\x89\xa4j\xe2\x89\xa4i) such that it is possible to obtain S={j} after performing the above operations exactly i\xe2\x88\x921 times. For each integer i from x to n, you need to find f(i)." 2500
1998E1 "Eliminating Balls With Merging (Easy Version)" "binary search,brute force,data structures,divide and conquer,greedy" "Drink water.\xe2\x80\x94 Sun Tzu, The Art of Becoming a Healthy ProgrammerThis is the easy version of the problem. The only difference is that x=n in this version. You must solve both versions to be able to hack.You are given two integers n and x (x=n). There are n balls lined up in a row, numbered from 1 to n from left to right. Initially, there is a value ai written on the i-th ball.For each integer i from 1 to n, we define a function f(i) as follows:   Suppose you have a set S={1,2,\xe2\x80\xa6,i}.  In each operation, you have to select an integer l (1\xe2\x89\xa4l<i) from S such that l is not the largest element of S. Suppose r is the smallest element in S which is greater than l.   If al>ar, you set al=al+ar and remove r from S.  If al<ar, you set ar=al+ar and remove l from S.  If al=ar, you choose either the integer l or r to remove from S:   If you choose to remove l from S, you set ar=al+ar and remove l from S.  If you choose to remove r from S, you set al=al+ar and remove r from S.    f(i) denotes the number of integers j (1\xe2\x89\xa4j\xe2\x89\xa4i) such that it is possible to obtain S={j} after performing the above operations exactly i\xe2\x88\x921 times. For each integer i from x to n, you need to find f(i)." 2200
1998D "Determine Winning Islands in Race" "data structures,dp,graphs,greedy,shortest paths" "MOOOOOOOOOOOOOOOOO\xe2\x80\x94 Bessie the Cow, The Art of Racing on IslandsTwo of Farmer John\'s cows, Bessie and Elsie, are planning to race on n islands. There are n\xe2\x88\x921 main bridges, connecting island i to island i+1 for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. Additionally, there are m alternative bridges. Elsie can use both main and alternative bridges, while Bessie can only use main bridges. All bridges are one way and can only be used to travel from an island with a lower index to an island with a higher index.Initially, Elsie starts on island 1, and Bessie starts on island s. The cows alternate turns, with Bessie making the first turn. Suppose the cow is on island i. During a cow\'s turn, if there are any bridges connecting island i to island j, then the cow can move to island j. Then, island i collapses, and all bridges connecting to island i also collapse. Also, note the following:  If there are no bridges connecting island i to another island, then island i collapses, and this cow is eliminated from the race.  If the other cow is also on island i, then after this cow moves to another island, the island collapses, and the other cow is eliminated from the race.  After an island or bridge collapses, no cows may use them.  If a cow is eliminated, their turn is skipped for the rest of the race. The race ends once either cow reaches island n. It can be shown that regardless of the cows\' strategies, at least one cow reaches island n. Bessie wins if and only if she reaches island n first.For each 1\xe2\x89\xa4s\xe2\x89\xa4n\xe2\x88\x921, determine whether Bessie wins if she starts the race on island s. Assume both cows follow optimal strategies to ensure their own respective victories." 2100
1998C "Perform Operations to Maximize Score" "binary search,brute force,constructive algorithms,greedy,implementation" "I see satyam343. I\'m shaking. Please more median problems this time. I love those. Please satyam343 we believe in you.\xe2\x80\x94 satyam343\'s biggest fanYou are given an array a of length n and an integer k. You are also given a binary array b of length n. You can perform the following operation at most k times:   Select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that bi=1. Set ai=ai+1 (i.e., increase ai by 1). Your score is defined to be nmaxi=1(ai+median(ci)), where ci denotes the array of length n\xe2\x88\x921 that you get by deleting ai from a. In other words, your score is the maximum value of ai+median(ci) over all i from 1 to n.Find the maximum score that you can achieve if you perform the operations optimally.For an arbitrary array p, median(p) is defined as the \xe2\x8c\x8a|p|+12\xe2\x8c\x8b-th smallest element of p. For example, median([3,2,1,3])=2 and median([6,2,4,5,1])=4." 1900
1998B "Minimize Equal Sum Subarrays" "constructive algorithms,math,number theory" "It is known that Farmer John likes Permutations, but I like them too!\xe2\x80\x94 Sun Tzu, The Art of Constructing PermutationsYou are given a permutation\xe2\x88\x97 p of length n.Find a permutation q of length n that minimizes the number of pairs (i,j) (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n) such that pi+pi+1+\xe2\x80\xa6+pj=qi+qi+1+\xe2\x80\xa6+qj.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1000
1998A "Find K Distinct Points with Fixed Center" "constructive algorithms,implementation,math" "I couldn\'t think of a good title for this problem, so I decided to learn from LeetCode.\xe2\x80\x94 Sun Tzu, The Art of WarYou are given three integers xc, yc, and k (\xe2\x88\x92100\xe2\x89\xa4xc,yc\xe2\x89\xa4100, 1\xe2\x89\xa4k\xe2\x89\xa41000). You need to find k distinct points (x1,y1), (x2,y2), \xe2\x80\xa6, (xk,yk), having integer coordinates, on the 2D coordinate plane such that:   their center\xe2\x88\x97 is (xc,yc)  \xe2\x88\x92109\xe2\x89\xa4xi,yi\xe2\x89\xa4109 for all i from 1 to k  It can be proven that at least one set of k distinct points always exists that satisfies these conditions.\xe2\x88\x97The center of k points (x1,y1), (x2,y2), \xe2\x80\xa6, (xk,yk) is (x1+x2+\xe2\x80\xa6+xkk,y1+y2+\xe2\x80\xa6+ykk)." 800
1997F "Chips on a Line" "brute force,combinatorics,dp,greedy,math" "You have n chips, and you are going to place all of them in one of x points, numbered from 1 to x. There can be multiple chips in each point.After placing the chips, you can perform the following four operations (in any order, any number of times):  choose a chip in point i\xe2\x89\xa53, remove it and place two chips: one in i\xe2\x88\x921, one in i\xe2\x88\x922;  choose two chips in adjacent points i and i+1, remove them and place a new chip in i+2;  choose a chip in point 1 and move it to 2;  choose a chip in point 2 and move it to 1. Note that the coordinates of the chips you place during the operations cannot be less than 1, but can be greater than x.Denote the cost of chip placement as the minimum number of chips which can be present on the line after you perform these operations, starting from the placement you\'ve chosen.For example, the cost of placing two chips in points 3 and one chip in point 5 is 2, because you can reduce the number of chips to 2 as follows:  choose a chip in point 3, remove it, place a chip in 1 and another chip in 2;  choose the chips in points 2 and 3, remove them and place a chip in 4;  choose the chips in points 4 and 5, remove them and place a chip in 6. You are given three integers n, x and m. Calculate the number of placements of exactly n chips in points from 1 to x having cost equal to m, and print it modulo 998244353. Two placements are considered different if the number of chips in some point differs between these placements." 2700
1997E "Level Up" "binary search,brute force,data structures,divide and conquer,implementation" "Monocarp is playing a computer game. He starts the game being level 1. He is about to fight n monsters, in order from 1 to n. The level of the i-th monster is ai.For each monster in the given order, Monocarp\'s encounter goes as follows:  if Monocarp\'s level is strictly higher than the monster\'s level, the monster flees (runs away);  otherwise, Monocarp fights the monster. After every k-th fight with a monster (fleeing monsters do not count), Monocarp\'s level increases by 1. So, his level becomes 2 after k monsters he fights, 3 after 2k monsters, 4 after 3k monsters, and so on.You need to process q queries of the following form:  i x: will Monocarp fight the i-th monster (or will this monster flee) if the parameter k is equal to x?" 2200
1997D "Maximize the Root" "binary search,dfs and similar,dp,greedy,trees" "You are given a rooted tree, consisting of n vertices. The vertices in the tree are numbered from 1 to n, and the root is the vertex 1. The value ai is written at the i-th vertex.You can perform the following operation any number of times (possibly zero): choose a vertex v which has at least one child; increase av by 1; and decrease au by 1 for all vertices u that are in the subtree of v (except v itself). However, after each operation, the values on all vertices should be non-negative.Your task is to calculate the maximum possible value written at the root using the aforementioned operation." 1500
1997C "Even Positions" "constructive algorithms,data structures,greedy" "Monocarp had a regular bracket sequence s of length n (n is even). He even came up with his own way to calculate its cost.He knows that in a regular bracket sequence (RBS), each opening bracket is paired up with the corresponding closing bracket. So he decided to calculate the cost of RBS as the sum of distances between pairs of corresponding bracket pairs.For example, let\'s look at RBS (())(). It has three pairs of brackets:   (__)__: the distance between brackets at position 1 and at 4 is 4\xe2\x88\x921=3;  _()___: the distance is 3\xe2\x88\x922=1;  ____(): the distance is 6\xe2\x88\x925=1.  So the cost of (())() is 3+1+1=5.Unfortunately, due to data corruption, Monocarp lost all characters on odd positions s1,s3,\xe2\x80\xa6,sn\xe2\x88\x921. Only characters on even positions (s2,s4,\xe2\x80\xa6,sn) remain. For example, (())() turned to _(_)_).Monocarp wants to restore his RBS by placing brackets on the odd positions. But since the restored RBS may not be unique, he wants to choose one with minimum cost. It\'s too hard to do for Monocarp alone, so can you help him?Reminder: A regular bracket sequence is a string consisting of only brackets, such that this sequence, when inserted 1-s and +-s, gives a valid mathematical expression. For example, (), (()) or (()())() are RBS, while ), ()( or ())(() are not." 1100
1997B "Make Three Regions" "constructive algorithms,two pointers" "There is a grid, consisting of 2 rows and n columns. Each cell of the grid is either free or blocked.A free cell y is reachable from a free cell x if at least one of these conditions holds:   x and y share a side;  there exists a free cell z such that z is reachable from x and y is reachable from z. A connected region is a set of free cells of the grid such that all cells in it are reachable from one another, but adding any other free cell to the set violates this rule.For example, consider the following layout, where white cells are free, and dark grey cells are blocked:   There are 3 regions in it, denoted with red, green and blue color respectively:   The given grid contains at most 1 connected region. Your task is to calculate the number of free cells meeting the following constraint:  if this cell is blocked, the number of connected regions becomes exactly 3." 1100
1997A "Strong Password" "brute force,implementation,strings" "Monocarp\'s current password on Codeforces is a string s, consisting of lowercase Latin letters. Monocarp thinks that his current password is too weak, so he wants to insert exactly one lowercase Latin letter into the password to make it stronger. Monocarp can choose any letter and insert it anywhere, even before the first character or after the last character.Monocarp thinks that the password\'s strength is proportional to the time it takes him to type the password. The time it takes to type the password is calculated as follows:  the time to type the first character is 2 seconds;  for each character other than the first, the time it takes to type it is 1 second if it is the same as the previous character, or 2 seconds otherwise. For example, the time it takes to type the password abacaba is 14; the time it takes to type the password a is 2; the time it takes to type the password aaabacc is 11.You have to help Monocarp \xe2\x80\x94 insert a lowercase Latin letter into his password so that the resulting password takes the maximum possible amount of time to type." 800
1996G Penacony "brute force,data structures,graphs,greedy,hashing" "On Penacony, The Land of the Dreams, there exists n houses and n roads. There exists a road between house i and i+1 for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 and a road between house n and house 1. All roads are bidirectional. However, due to the crisis on Penacony, the overseeing family has gone into debt and may not be able to maintain all roads.There are m pairs of friendships between the residents of Penacony. If the resident living in house a is friends with the resident living in house b, there must be a path between houses a and b through maintained roads. What is the minimum number of roads that must be maintained?" 2200
1996F Bomb "binary search,greedy,math" "Sparkle gives you two arrays a and b of length n. Initially, your score is 0. In one operation, you can choose an integer i and add ai to your score. Then, you must set ai = max(0,ai\xe2\x88\x92bi).You only have time to perform k operations before Sparkle sets off a nuclear bomb! What is the maximum score you can acquire after k operations?" 1900
1996E Decode "combinatorics,data structures,implementation,math" "In a desperate attempt to obtain your waifu favorite character, you have hacked into the source code of the game. After days of struggling, you finally find the binary string that encodes the gacha system of the game. In order to decode it, you must first solve the following problem. You are given a binary string s of length n. For each pair of integers (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), count the number of pairs (x,y) (l\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4r) such that the amount of 0 equals the amount of 1 in the substring sxsx+1...sy. Output the sum of counts over all possible (l,r) modulo 109+7." 1600
1996D Fun "binary search,brute force,combinatorics,math,number theory" "Counting is Fun!\xe2\x80\x94 satyam343Given two integers n and x, find the number of triplets (a,b,c) of positive integers such that ab+ac+bc\xe2\x89\xa4n and a+b+c\xe2\x89\xa4x. Note that order matters (e.g. (1,1,2) and (1,2,1) are treated as different) and a, b, c must be strictly greater than 0." 1500
1996C Sort dp,greedy,sortings,strings "You are given two strings a and b of length n. Then, you are (forced against your will) to answer q queries.For each query, you are given a range bounded by l and r. In one operation, you can choose an integer i (l\xe2\x89\xa4i\xe2\x89\xa4r) and set ai=x where x is any character you desire. Output the minimum number of operations you must perform such that sorted(a[l..r])=sorted(b[l..r]). The operations you perform on one query does not affect other queries.For an arbitrary string c, sorted(c[l..r]) denotes the substring consisting of characters cl,cl+1,...,cr sorted in lexicographical order." 1200
1996B Scale greedy,implementation "Tina has a square grid with n rows and n columns. Each cell in the grid is either 0 or 1. Tina wants to reduce the grid by a factor of k (k is a divisor of n). To do this, Tina splits the grid into k\xc3\x97k nonoverlapping blocks of cells such that every cell belongs to exactly one block.Tina then replaces each block of cells with a single cell equal to the value of the cells in the block. It is guaranteed that every cell in the same block has the same value. For example, the following demonstration shows a grid being reduced by factor of 3. Original grid 000111000111000111111000111000111000  Reduced grid 0110 Help Tina reduce the grid by a factor of k." 800
1996A Legs "binary search,math,ternary search" "It\'s another beautiful day on Farmer John\'s farm.After Farmer John arrived at his farm, he counted n legs. It is known only chickens and cows live on the farm, and a chicken has 2 legs while a cow has 4. What is the minimum number of animals Farmer John can have on his farm assuming he counted the legs of all animals?" 800
1995E2 "Let Me Teach You a Lesson (Hard Version)" "data structures,dp,matrices,two pointers" "This is the hard version of a problem. The only difference between an easy and a hard version is the constraints on t and n. You can make hacks only if both versions of the problem are solved.Arthur is giving a lesson to his famous 2n knights. Like any other students, they\'re sitting at the desks in pairs, but out of habit in a circle. The knight 2i\xe2\x88\x921 is sitting at the desk with the knight 2i.Each knight has intelligence, which can be measured by an integer. Let\'s denote the intelligence of the i-th knight as ai. Arthur wants the maximal difference in total intelligence over all pairs of desks to be as small as possible. More formally, he wants to minimize max1\xe2\x89\xa4i\xe2\x89\xa4n(a2i\xe2\x88\x921+a2i)\xe2\x88\x92min1\xe2\x89\xa4i\xe2\x89\xa4n(a2i\xe2\x88\x921+a2i).However, the Code of Chivalry only allows swapping the opposite knights in the circle, i.e., Arthur can simultaneously perform ai:=ai+n, ai+n:=ai for any 1\xe2\x89\xa4i\xe2\x89\xa4n. Arthur can make any number of such swaps. What is the best result he can achieve?" 2900
1995E1 "Let Me Teach You a Lesson (Easy Version)" "2-sat,data structures,dp,matrices,two pointers" "This is the easy version of a problem. The only difference between an easy and a hard version is the constraints on t and n. You can make hacks only if both versions of the problem are solved.Arthur is giving a lesson to his famous 2n knights. Like any other students, they\'re sitting at the desks in pairs, but out of habit in a circle. The knight 2i\xe2\x88\x921 is sitting at the desk with the knight 2i.Each knight has intelligence, which can be measured by an integer. Let\'s denote the intelligence of the i-th knight as ai. Arthur wants the maximal difference in total intelligence over all pairs of desks to be as small as possible. More formally, he wants to minimize max1\xe2\x89\xa4i\xe2\x89\xa4n(a2i\xe2\x88\x921+a2i)\xe2\x88\x92min1\xe2\x89\xa4i\xe2\x89\xa4n(a2i\xe2\x88\x921+a2i).However, the Code of Chivalry only allows swapping the opposite knights in the circle, i.e., Arthur can simultaneously perform ai:=ai+n, ai+n:=ai for any 1\xe2\x89\xa4i\xe2\x89\xa4n. Arthur can make any number of such swaps. What is the best result he can achieve?" 2700
1995D Cases "bitmasks,brute force,dp,strings" "You\'re a linguist studying a mysterious ancient language. You know that   Its words consist only of the first c letters of the Latin alphabet.  Each word has a case which can be unambiguously determined by its last letter (different letters correspond to different cases). For example, words ""ABACABA"" and ""ABA"" (if they exist) have the same case in this language because they both have the same ending \'A\', whereas ""ALICE"" and ""BOB"" have different cases. If the language does not have a case corresponding to some letter, it means that the word cannot end with this letter.  The length of each word is k or less. You have a single text written in this language. Unfortunately, as the language is really ancient, spaces between words are missing and all letters are uppercase. You wonder what is the minimum number of cases the language can have. Can you find this out?" 2300
1995C Squaring "brute force,constructive algorithms,greedy,implementation,math,number theory" "ikrpprpp found an array a consisting of integers. He likes justice, so he wants to make a fair \xe2\x80\x94 that is, make it non-decreasing. To do that, he can perform an act of justice on an index 1\xe2\x89\xa4i\xe2\x89\xa4n of the array, which will replace ai with a2i (the element at position i with its square). For example, if a=[2,4,3,3,5,3] and ikrpprpp chooses to perform an act of justice on i=4, a becomes [2,4,3,9,5,3].What is the minimum number of acts of justice needed to make the array non-decreasing?" 1800
1995B2 "Bouquet (Hard Version)" "binary search,data structures,greedy,math,sortings,two pointers" "This is the hard version of the problem. The only difference is that in this version, instead of listing the number of petals for each flower, the number of petals and the quantity of flowers in the store is set for all types of flowers.A girl is preparing for her birthday and wants to buy the most beautiful bouquet. There are a total of n different types of flowers in the store, each of which is characterized by the number of petals and the quantity of this type of flower. A flower with k petals costs k coins. The girl has decided that the difference in the number of petals between any two flowers she will use to decorate her cake should not exceed one. At the same time, the girl wants to assemble a bouquet with the maximum possible number of petals. Unfortunately, she only has m coins, and she cannot spend more. What is the maximum total number of petals she can assemble in the bouquet?" 1700
1995B1 "Bouquet (Easy Version)" "binary search,brute force,greedy,sortings,two pointers" "This is the easy version of the problem. The only difference is that in this version, the flowers are specified by enumeration.A girl is preparing for her birthday and wants to buy the most beautiful bouquet. There are a total of n flowers in the store, each of which is characterized by the number of petals, and a flower with k petals costs k coins. The girl has decided that the difference in the number of petals between any two flowers she will use in her bouquet should not exceed one. At the same time, the girl wants to assemble a bouquet with the maximum possible number of petals. Unfortunately, she only has m coins, and she cannot spend more. What is the maximum total number of petals she can assemble in the bouquet?" 1100
1995A Diagonals "brute force,greedy,implementation,math" "Vitaly503 is given a checkered board with a side of n and k chips. He realized that all these k chips need to be placed on the cells of the board (no more than one chip can be placed on a single cell).Let\'s denote the cell in the i-th row and j-th column as (i,j). A diagonal is the set of cells for which the value i+j is the same. For example, cells (3,1), (2,2), and (1,3) lie on the same diagonal, but (1,2) and (2,3) do not. A diagonal is called occupied if it contains at least one chip. Determine what is the minimum possible number of occupied diagonals among all placements of k chips." 800
1994H Fortnite "combinatorics,constructive algorithms,games,greedy,hashing,interactive,math,number theory,strings" "This is an interactive problem!Timofey is writing a competition called Capture the Flag (or CTF for short). He has one task left, which involves hacking a security system. The entire system is based on polynomial hashes\xe2\x88\x97.Timofey can input a string consisting of lowercase Latin letters into the system, and the system will return its polynomial hash. To hack the system, Timofey needs to find the polynomial hash parameters (p and m) that the system uses.Timofey doesn\'t have much time left, so he will only be able to make 3 queries. Help him solve the task.\xe2\x88\x97 The polynomial hash of a string s, consisting of lowercase Latin letters of length n, based on p and modulo m is (ord(s1)\xe2\x8b\x85p0+ord(s2)\xe2\x8b\x85p1+ord(s3)\xe2\x8b\x85p2+\xe2\x80\xa6+ord(sn)\xe2\x8b\x85pn\xe2\x88\x921)modm. Where si denotes the i-th character of the string s, ord(chr) denotes the ordinal number of the character chr in the English alphabet, and xmodm is the remainder of x when divided by m." 3500
1994G Minecraft "bitmasks,brute force,dp,graphs,math" "After winning another Bed Wars game, Masha and Olya wanted to relax and decided to play a new game. Masha gives Olya an array a of length n and a number s. Now Olya\'s task is to find a non-negative number x such that n\xe2\x88\x91i=1ai\xe2\x8a\x95x=s. But she is very tired after a tight round, so please help her with this.But this task seemed too simple to them, so they decided to make the numbers larger (up to 2k) and provide you with their binary representation." 2600
1994F "Stardew Valley" "constructive algorithms,dfs and similar,graphs,trees" "Pelican Town represents n houses connected by m bidirectional roads. Some roads have NPCs standing on them. Farmer Buba needs to walk on each road with an NPC and talk to them.Help the farmer find a route satisfying the following properties:   The route starts at some house, follows the roads, and ends at the same house.  The route does not follow any road more than once (in both directions together).  The route follows each road with an NPC exactly once.  Note that the route can follow roads without NPCs, and you do not need to minimize the length of the route.It is guaranteed that you can reach any house from any other by walking on the roads with NPCs only." 2500
1994E "Wooden Game" bitmasks,greedy,math,trees "You are given a forest of k rooted trees\xe2\x88\x97. Lumberjack Timofey wants to cut down the entire forest by applying the following operation:   Select a subtree\xe2\x80\xa0 of any vertex of one of the trees and remove it from the tree. Timofey loves bitwise operations, so he wants the bitwise OR of the sizes of the subtrees he removed to be maximum. Help him and find the maximum result he can obtain.\xe2\x88\x97 A tree is a connected graph without cycles, loops, or multiple edges. In a rooted tree, a selected vertex is called a root. A forest is a collection of one or more trees.\xe2\x80\xa0 The subtree of a vertex v is the set of vertices for which v lies on the shortest path from this vertex to the root, including v itself." 2000
1994D "Funny Game" "constructive algorithms,dsu,graphs,greedy,math,number theory,trees" "Vanya has a graph with n vertices (numbered from 1 to n) and an array a of n integers; initially, there are no edges in the graph. Vanya got bored, and to have fun, he decided to perform n\xe2\x88\x921 operations.Operation number x (operations are numbered in order starting from 1) is as follows:  Choose 2 different numbers 1\xe2\x89\xa4u,v\xe2\x89\xa4n, such that |au\xe2\x88\x92av| is divisible by x.  Add an undirected edge between vertices u and v to the graph. Help Vanya get a connected\xe2\x88\x97 graph using the n\xe2\x88\x921 operations, or determine that it is impossible.\xe2\x88\x97A graph is called connected if it is possible to reach any vertex from any other by moving along the edges." 1900
1994C "Hungry Games" "binary search,dp,two pointers" "Yaroslav is playing a computer game, and at one of the levels, he encountered n mushrooms arranged in a row. Each mushroom has its own level of toxicity; the i-th mushroom from the beginning has a toxicity level of ai. Yaroslav can choose two integers 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, and then his character will take turns from left to right to eat mushrooms from this subsegment one by one, i.e., the mushrooms with numbers l,l+1,l+2,\xe2\x80\xa6,r.The character has a toxicity level g, initially equal to 0. The computer game is defined by the number x \xe2\x80\x94 the maximum toxicity level at any given time. When eating a mushroom with toxicity level k, the following happens:  The toxicity level of the character is increased by k.  If g\xe2\x89\xa4x, the process continues; otherwise, g becomes zero and the process continues. Yaroslav became interested in how many ways there are to choose the values of l and r such that the final value of g is not zero. Help Yaroslav find this number!" 1600
1994B "Fun Game" "bitmasks,constructive algorithms,greedy,math" "Vova really loves the XOR operation (denoted as \xe2\x8a\x95). Recently, when he was going to sleep, he came up with a fun game.At the beginning of the game, Vova chooses two binary sequences s and t of length n and gives them to Vanya. A binary sequence is a sequence consisting only of the numbers 0 and 1. Vanya can choose integers l,r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, and for all l\xe2\x89\xa4i\xe2\x89\xa4r simultaneously replace si with si\xe2\x8a\x95si\xe2\x88\x92l+1, where si is the i-th element of the sequence s.In order for the game to be interesting, there must be a possibility to win. Vanya wins if, with an unlimited number of actions, he can obtain the sequence t from the sequence s. Determine if the game will be interesting for the sequences s and t." 1100
1994A "Diverse Game" "constructive algorithms,greedy,implementation" "Petr, watching Sergey\'s stream, came up with a matrix a, consisting of n rows and m columns (the number in the i-th row and j-th column is denoted as ai,j), which contains all integers from 1 to n\xe2\x8b\x85m. But he didn\'t like the arrangement of the numbers, and now he wants to come up with a new matrix b, consisting of n rows and m columns, which will also contain all integers from 1 to n\xe2\x8b\x85m, such that for any 1\xe2\x89\xa4i\xe2\x89\xa4n,1\xe2\x89\xa4j\xe2\x89\xa4m it holds that ai,j\xe2\x89\xa0bi,j.You are given the matrix a, construct any matrix b that meets Petr\'s requirements, or determine that it is impossible.Hurry up! Otherwise, he will donate all his money to the stream in search of an answer to his question." 800
1993F2 "Dyn-scripted Robot (Hard Version)" "chinese remainder theorem,math,number theory" "This is the hard version of the problem. The only difference is that in this version k\xe2\x89\xa41012. You can make hacks only if both versions of the problem are solved.Given a w\xc3\x97h rectangle on the Oxy plane, with points (0,0) at the bottom-left and (w,h) at the top-right of the rectangle.You also have a robot initially at point (0,0) and a script s of n characters. Each character is either L, R, U, or D, which tells the robot to move left, right, up, or down respectively.The robot can only move inside the rectangle; otherwise, it will change the script s as follows:  If it tries to move outside a vertical border, it changes all L characters to R\'s (and vice versa, all R\'s to L\'s).  If it tries to move outside a horizontal border, it changes all U characters to D\'s (and vice versa, all D\'s to U\'s). Then, it will execute the changed script starting from the character which it couldn\'t execute.  An example of the robot\'s movement process, s=""ULULURD"" The script s will be executed for k times continuously. All changes to the string s will be retained even when it is repeated. During this process, how many times will the robot move to the point (0,0) in total? Note that the initial position does NOT count." 2800
1993F1 "Dyn-scripted Robot (Easy Version)" "brute force,chinese remainder theorem,constructive algorithms,math,number theory" "This is the easy version of the problem. The only difference is that in this version k\xe2\x89\xa4n. You can make hacks only if both versions of the problem are solved.Given a w\xc3\x97h rectangle on the Oxy plane, with points (0,0) at the bottom-left and (w,h) at the top-right of the rectangle.You also have a robot initially at point (0,0) and a script s of n characters. Each character is either L, R, U, or D, which tells the robot to move left, right, up, or down respectively.The robot can only move inside the rectangle; otherwise, it will change the script s as follows:  If it tries to move outside a vertical border, it changes all L characters to R\'s (and vice versa, all R\'s to L\'s).  If it tries to move outside a horizontal border, it changes all U characters to D\'s (and vice versa, all D\'s to U\'s). Then, it will execute the changed script starting from the character which it couldn\'t execute.  An example of the robot\'s movement process, s=""ULULURD"" The script s will be executed for k times continuously. All changes to the string s will be retained even when it is repeated. During this process, how many times will the robot move to the point (0,0) in total? Note that the initial position does NOT count." 2400
1993E "Xor-Grid Problem" "bitmasks,constructive algorithms,dp,implementation" "Given a matrix a of size n\xc3\x97m, each cell of which contains a non-negative integer. The integer lying at the intersection of the i-th row and the j-th column of the matrix is called ai,j.Let\'s define f(i) and g(j) as the XOR of all integers in the i-th row and the j-th column, respectively. In one operation, you can either:   Select any row i, then assign ai,j:=g(j) for each 1\xe2\x89\xa4j\xe2\x89\xa4m; or  Select any column j, then assign ai,j:=f(i) for each 1\xe2\x89\xa4i\xe2\x89\xa4n.   An example of applying an operation on column 2 of the matrix. In this example, as we apply an operation on column 2, all elements in this column are changed:   a1,2:=f(1)=a1,1\xe2\x8a\x95a1,2\xe2\x8a\x95a1,3\xe2\x8a\x95a1,4=1\xe2\x8a\x951\xe2\x8a\x951\xe2\x8a\x951=0  a2,2:=f(2)=a2,1\xe2\x8a\x95a2,2\xe2\x8a\x95a2,3\xe2\x8a\x95a2,4=2\xe2\x8a\x953\xe2\x8a\x955\xe2\x8a\x957=3  a3,2:=f(3)=a3,1\xe2\x8a\x95a3,2\xe2\x8a\x95a3,3\xe2\x8a\x95a3,4=2\xe2\x8a\x950\xe2\x8a\x953\xe2\x8a\x950=1  a4,2:=f(4)=a4,1\xe2\x8a\x95a4,2\xe2\x8a\x95a4,3\xe2\x8a\x95a4,4=10\xe2\x8a\x9511\xe2\x8a\x9512\xe2\x8a\x9516=29 You can apply the operations any number of times. Then, we calculate the beauty of the final matrix by summing the absolute differences between all pairs of its adjacent cells.More formally, beauty(a)=\xe2\x88\x91|ax,y\xe2\x88\x92ar,c| for all cells (x,y) and (r,c) if they are adjacent. Two cells are considered adjacent if they share a side.Find the minimum beauty among all obtainable matrices." 2700
1993D Med-imize "binary search,dp,greedy" "Given two positive integers n and k, and another array a of n integers.In one operation, you can select any subarray of size k of a, then remove it from the array without changing the order of other elements. More formally, let (l,r) be an operation on subarray al,al+1,\xe2\x80\xa6,ar such that r\xe2\x88\x92l+1=k, then performing this operation means replacing a with [a1,\xe2\x80\xa6,al\xe2\x88\x921,ar+1,\xe2\x80\xa6,an].For example, if a=[1,2,3,4,5] and we perform operation (3,5) on this array, it will become a=[1,2]. Moreover, operation (2,4) results in a=[1,5], and operation (1,3) results in a=[4,5]. You have to repeat the operation while the length of a is greater than k (which means |a|>k). What is the largest possible median\xe2\x80\xa0 of all remaining elements of the array a after the process?\xe2\x80\xa0The median of an array of length n is the element whose index is \xe2\x8c\x8a(n+1)/2\xe2\x8c\x8b after we sort the elements in non-decreasing order. For example: median([2,1,5,4,3])=3, median([5])=5, and median([6,8,2,4])=4." 2200
1993C "Light Switches" implementation,math "There is an apartment consisting of n rooms, each with its light initially turned off.To control the lights in these rooms, the owner of the apartment decided to install chips in the rooms so that each room has exactly one chip, and the chips are installed at different times. Specifically, these times are represented by the array a1,a2,\xe2\x80\xa6,an, where ai is the time (in minutes) at which a chip is installed in the i-th room.As soon as a chip is installed, it changes the room\'s light status every k minutes \xe2\x80\x94 it turns on the light for k minutes, then turns it off for the next k minutes, then turns it back on for the next k minutes, and so on. In other words, the light status is changed by the chip at minute ai, ai+k, ai+2k, ai+3k, \xe2\x80\xa6 for the i-th room.What is the earliest moment when all rooms in the apartment have their lights turned on?" 1400
1993B "Parity and Sum" "constructive algorithms,greedy" "Given an array a of n positive integers.In one operation, you can pick any pair of indexes (i,j) such that ai and aj have distinct parity, then replace the smaller one with the sum of them. More formally:   If ai<aj, replace ai with ai+aj;  Otherwise, replace aj with ai+aj. Find the minimum number of operations needed to make all elements of the array have the same parity." 1100
1993A "Question Marks" greedy,implementation "Tim is doing a test consisting of 4n questions; each question has 4 options: \'A\', \'B\', \'C\', and \'D\'. For each option, there are exactly n correct answers corresponding to that option \xe2\x80\x94 meaning there are n questions with the answer \'A\', n questions with the answer \'B\', n questions with the answer \'C\', and n questions with the answer \'D\'.For each question, Tim wrote his answer on the answer sheet. If he could not figure out the answer, he would leave a question mark \'?\' for that question.You are given his answer sheet of 4n characters. What is the maximum number of correct answers Tim can get?" 800
1992G Ultra-Meow combinatorics,dp,math "K1o0n gave you an array a of length n, consisting of numbers 1,2,\xe2\x80\xa6,n. Accept it? Of course! But what to do with it? Of course, calculate MEOW(a).Let MEX(S,k) be the k-th positive (strictly greater than zero) integer in ascending order that is not present in the set S. Denote MEOW(a) as the sum of MEX(b,|b|+1), over all distinct subsets b of the array a.Examples of MEX(S,k) values for sets:   MEX({3,2},1)=1, because 1 is the first positive integer not present in the set;  MEX({4,2,1},2)=5, because the first two positive integers not present in the set are 3 and 5;  MEX({},4)=4, because there are no numbers in the empty set, so the first 4 positive integers not present in it are 1,2,3,4." 2000
1992F "Valuable Cards" "brute force,dp,greedy,number theory,two pointers" "In his favorite cafe Kmes once again wanted to try the herring under a fur coat. Previously, it would not have been difficult for him to do this, but the cafe recently introduced a new purchasing policy.Now, in order to make a purchase, Kmes needs to solve the following problem: n cards with prices for different positions are laid out in front of him, on the i-th card there is an integer ai, among these prices there is no whole positive integer x.Kmes is asked to divide these cards into the minimum number of bad segments (so that each card belongs to exactly one segment). A segment is considered bad if it is impossible to select a subset of cards with a product equal to x. All segments, in which Kmes will divide the cards, must be bad.Formally, the segment (l,r) is bad if there are no indices i1<i2<\xe2\x80\xa6<ik such that l\xe2\x89\xa4i1,ik\xe2\x89\xa4r, and ai1\xe2\x8b\x85ai2\xe2\x80\xa6\xe2\x8b\x85aik=x.Help Kmes determine the minimum number of bad segments in order to enjoy his favorite dish." 1900
1992E "Novice\'s Mistake" "brute force,constructive algorithms,implementation,math,strings" "One of the first programming problems by K1o0n looked like this: ""Noobish_Monk has n (1\xe2\x89\xa4n\xe2\x89\xa4100) friends. Each of them gave him a (1\xe2\x89\xa4a\xe2\x89\xa410000) apples for his birthday. Delighted with such a gift, Noobish_Monk returned b (1\xe2\x89\xa4b\xe2\x89\xa4min(10000,a\xe2\x8b\x85n)) apples to his friends. How many apples are left with Noobish_Monk?""K1o0n wrote a solution, but accidentally considered the value of n as a string, so the value of n\xe2\x8b\x85a\xe2\x88\x92b was calculated differently. Specifically:   when multiplying the string n by the integer a, he will get the string s=n+n+\xe2\x8b\xaf+n+n\xe2\x8f\x9fa times  when subtracting the integer b from the string s, the last b characters will be removed from it. If b is greater than or equal to the length of the string s, it will become empty. Learning about this, ErnKor became interested in how many pairs (a,b) exist for a given n, satisfying the constraints of the problem, on which K1o0n\'s solution gives the correct answer.""The solution gives the correct answer"" means that it outputs a non-empty string, and this string, when converted to an integer, equals the correct answer, i.e., the value of n\xe2\x8b\x85a\xe2\x88\x92b." 1700
1992D "Test of Love" dp,greedy,implementation "ErnKor is ready to do anything for Julen, even to swim through crocodile-infested swamps. We decided to test this love. ErnKor will have to swim across a river with a width of 1 meter and a length of n meters.The river is very cold. Therefore, in total (that is, throughout the entire swim from 0 to n+1) ErnKor can swim in the water for no more than k meters. For the sake of humanity, we have added not only crocodiles to the river, but also logs on which he can jump. Our test is as follows:Initially, ErnKor is on the left bank and needs to reach the right bank. They are located at the 0 and n+1 meters respectively. The river can be represented as n segments, each with a length of 1 meter. Each segment contains either a log \'L\', a crocodile \'C\', or just water \'W\'. ErnKor can move as follows:   If he is on the surface (i.e., on the bank or on a log), he can jump forward for no more than m (1\xe2\x89\xa4m\xe2\x89\xa410) meters (he can jump on the bank, on a log, or in the water).  If he is in the water, he can only swim to the next river segment (or to the bank if he is at the n-th meter).  ErnKor cannot land in a segment with a crocodile in any way. Determine if ErnKor can reach the right bank." 1200
1992C "Gorilla and Permutation" "constructive algorithms,math" "Gorilla and Noobish_Monk found three numbers n, m, and k (m<k). They decided to construct a permutation\xe2\x80\xa0 of length n.For the permutation, Noobish_Monk came up with the following function: g(i) is the sum of all the numbers in the permutation on a prefix of length i that are not greater than m. Similarly, Gorilla came up with the function f, where f(i) is the sum of all the numbers in the permutation on a prefix of length i that are not less than k. A prefix of length i is a subarray consisting of the first i elements of the original array.For example, if n=5, m=2, k=5, and the permutation is [5,3,4,1,2], then:  f(1)=5, because 5\xe2\x89\xa55; g(1)=0, because 5>2;  f(2)=5, because 3<5; g(2)=0, because 3>2;  f(3)=5, because 4<5; g(3)=0, because 4>2;  f(4)=5, because 1<5; g(4)=1, because 1\xe2\x89\xa42;  f(5)=5, because 2<5; g(5)=1+2=3, because 2\xe2\x89\xa42. Help them find a permutation for which the value of (\xe2\x88\x91ni=1f(i)\xe2\x88\x92\xe2\x88\x91ni=1g(i)) is maximized.\xe2\x80\xa0A permutation of length n is an array consisting of n distinct integers from 1 to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (as 2 appears twice in the array) and [1,3,4] is also not a permutation (as n=3, but 4 appears in the array)." 900
1992B "Angry Monk" greedy,math,sortings "To celebrate his recovery, k1o0n has baked an enormous n metres long potato casserole.Turns out, Noobish_Monk just can\'t stand potatoes, so he decided to ruin k1o0n\'s meal. He has cut it into k pieces, of lengths a1,a2,\xe2\x80\xa6,ak meters.k1o0n wasn\'t keen on that. Luckily, everything can be fixed. In order to do that, k1o0n can do one of the following operations:   Pick a piece with length ai\xe2\x89\xa52 and divide it into two pieces with lengths 1 and ai\xe2\x88\x921. As a result, the number of pieces will increase by 1;  Pick a slice ai and another slice with length aj=1 (i\xe2\x89\xa0j) and merge them into one piece with length ai+1. As a result, the number of pieces will decrease by 1. Help k1o0n to find the minimum number of operations he needs to do in order to merge the casserole into one piece with length n.For example, if n=5, k=2 and a=[3,2], it is optimal to do the following:  Divide the piece with length 2 into two pieces with lengths 2\xe2\x88\x921=1 and 1, as a result a=[3,1,1].  Merge the piece with length 3 and the piece with length 1, as a result a=[4,1].  Merge the piece with length 4 and the piece with length 1, as a result a=[5]." 800
1992A "Only Pluses" "brute force,constructive algorithms,greedy,math,sortings" "Kmes has written three integers a, b and c in order to remember that he has to give Noobish_Monk a\xc3\x97b\xc3\x97c bananas.Noobish_Monk has found these integers and decided to do the following at most 5 times:  pick one of these integers;  increase it by 1. For example, if a=2, b=3 and c=4, then one can increase a three times by one and increase b two times. After that a=5, b=5, c=4. Then the total number of bananas will be 5\xc3\x975\xc3\x974=100.What is the maximum value of a\xc3\x97b\xc3\x97c Noobish_Monk can achieve with these operations?" 800
1991I "Grid Game" "constructive algorithms,games,graph matchings,greedy,interactive" "This is an interactive problem.You are given a grid with n rows and m columns. You need to fill each cell with a unique integer from 1 to n\xe2\x8b\x85m.After filling the grid, you will play a game on this grid against the interactor. Players take turns selecting one of the previously unselected cells from the grid, with the interactor going first.On the first turn, the interactor can choose any cell from the grid. After that, any chosen cell must be orthogonally adjacent to at least one previously selected cell. Two cells are considered orthogonally adjacent if they share an edge. The game continues until all cells have been selected.Your goal is to let the sum of numbers in the cells selected by you be strictly less than the sum of numbers in the cells selected by the interactor." 3500
1991H "Prime Split Game" "bitmasks,dp,fft,games,math,number theory" "Alice and Bob are playing a game with n piles of stones, where the i-th pile has ai stones. Players take turns making moves, with Alice going first.On each move, the player does the following three-step process:   Choose an integer k (1\xe2\x89\xa4k\xe2\x89\xa4n2). Note that the value of k can be different for different moves.  Remove k piles of stones.  Choose another k piles of stones and split each pile into two piles. The number of stones in each new pile must be a prime number. The player who is unable to make a move loses.Determine who will win if both players play optimally." 3300
1991G "Grid Reset" "constructive algorithms,greedy,implementation" "You are given a grid consisting of n rows and m columns, where each cell is initially white. Additionally, you are given an integer k, where 1\xe2\x89\xa4k\xe2\x89\xa4min(n,m).You will process q operations of two types:   H (horizontal operation) \xe2\x80\x94 You choose a 1\xc3\x97k rectangle completely within the grid, where all cells in this rectangle are white. Then, all cells in this rectangle are changed to black.  V (vertical operation) \xe2\x80\x94 You choose a k\xc3\x971 rectangle completely within the grid, where all cells in this rectangle are white. Then, all cells in this rectangle are changed to black. After each operation, if any rows or columns become completely black, all cells in these rows and columns are simultaneously reset to white. Specifically, if all cells in the row and column a cell is contained in become black, all cells in both the row and column will be reset to white.Choose the rectangles in a way that you can perform all given operations, or determine that it is impossible." 2700
1991F "Triangle Formation" "brute force,greedy,implementation,math,sortings" "You are given n sticks, numbered from 1 to n. The length of the i-th stick is ai.You need to answer q queries. In each query, you are given two integers l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n, r\xe2\x88\x92l+1\xe2\x89\xa56). Determine whether it is possible to choose 6 distinct sticks from the sticks numbered l to r, to form 2 non-degenerate triangles\xe2\x88\x97.\xe2\x88\x97A triangle with side lengths a, b, and c is called non-degenerate if:   a<b+c,  b<a+c, and  c<a+b." 2200
1991E "Coloring Game" "constructive algorithms,dfs and similar,games,graphs,greedy,interactive" "This is an interactive problem.Consider an undirected connected graph consisting of n vertices and m edges. Each vertex can be colored with one of three colors: 1, 2, or 3. Initially, all vertices are uncolored.Alice and Bob are playing a game consisting of n rounds. In each round, the following two-step process happens:   Alice chooses two different colors.  Bob chooses an uncolored vertex and colors it with one of the two colors chosen by Alice. Alice wins if there exists an edge connecting two vertices of the same color. Otherwise, Bob wins.You are given the graph. Your task is to decide which player you wish to play as and win the game." 1900
1991D "Prime XOR Coloring" "bitmasks,constructive algorithms,graphs,greedy,math,number theory" "You are given an undirected graph with n vertices, numbered from 1 to n. There is an edge between vertices u and v if and only if u\xe2\x8a\x95v is a prime number, where \xe2\x8a\x95 denotes the bitwise XOR operator.Color all vertices of the graph using the minimum number of colors, such that no two vertices directly connected by an edge have the same color." 1900
1991C "Absolute Zero" "constructive algorithms,greedy,math" "You are given an array a of n integers.In one operation, you will perform the following two-step move:   Choose an integer x (0\xe2\x89\xa4x\xe2\x89\xa4109).  Replace each ai with |ai\xe2\x88\x92x|, where |v| denotes the absolute value of v. For example, by choosing x=8, the array [5,7,10] will be changed into [|5\xe2\x88\x928|,|7\xe2\x88\x928|,|10\xe2\x88\x928|]=[3,1,2].Construct a sequence of operations to make all elements of a equal to 0 in at most 40 operations or determine that it is impossible. You do not need to minimize the number of operations." 1300
1991B "AND Reconstruction" "bitmasks,constructive algorithms,greedy" "You are given an array b of n\xe2\x88\x921 integers.An array a of n integers is called good if bi=ai&ai+1 for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, where & denotes the bitwise AND operator.Construct a good array, or report that no good arrays exist." 1100
1991A "Maximize the Last Element" greedy,implementation "You are given an array a of n integers, where n is odd.In one operation, you will remove two adjacent elements from the array a, and then concatenate the remaining parts of the array. For example, given the array [4,7,4,2,9], we can obtain the arrays [4,2,9] and [4,7,9] by the operations [4,7_,4,2,9]\xe2\x86\x92[4,2,9] and [4,7,4,2_,9]\xe2\x86\x92[4,7,9] respectively. However, we cannot obtain the array [7,2,9] as it requires deleting non-adjacent elements [4_,7,4_,2,9].You will repeatedly perform this operation until exactly one element remains in a.Find the maximum possible value of the remaining element in a." 800
1990F "Polygonal Segments" "brute force,data structures,divide and conquer,dp,greedy,two pointers" "You are given an array a of size n.A segment [l,r](1\xe2\x89\xa4l<r\xe2\x89\xa4n) is called a polygonal segment only if the following conditions hold:  (r\xe2\x88\x92l+1)\xe2\x89\xa53;  Considering al,al+1,\xe2\x80\xa6,ar as side lengths, these sides can form a polygon with (r\xe2\x88\x92l+1) sides. Process q queries of two types:  ""1 l r"": find the length of the longest segment among all polygonal segments [l0,r0] satisfying l\xe2\x89\xa4l0\xe2\x89\xa4r0\xe2\x89\xa4r. If there is no such polygonal segment, output \xe2\x88\x921 instead;  ""2 i x"": assign ai:=x." 2800
1990E2 "Catch the Mole(Hard Version)" "binary search,data structures,dfs and similar,divide and conquer,interactive,trees" "This is the hard version of the problem. The only difference is the limit on the number of queries.This is an interactive problem.You are given a tree of n nodes with node 1 as its root node.There is a hidden mole in one of the nodes. To find its position, you can pick an integer x (1\xe2\x89\xa4x\xe2\x89\xa4n) to make an inquiry to the jury. Next, the jury will return 1 when the mole is in subtree x. Otherwise, the judge will return 0. If the judge returns 0 and the mole is not in root node 1, the mole will move to the parent node of the node it is currently on.Use at most 160 operations to find the current node where the mole is located." 2600
1990E1 "Catch the Mole(Easy Version)" "binary search,data structures,dfs and similar,interactive,trees" "This is the easy version of the problem. The only difference is the limit on the number of queries.This is an interactive problem.You are given a tree of n nodes with node 1 as its root node.There is a hidden mole in one of the nodes. To find its position, you can pick an integer x (1\xe2\x89\xa4x\xe2\x89\xa4n) to make an inquiry to the jury. Next, the jury will return 1 when the mole is in subtree x. Otherwise, the judge will return 0. If the judge returns 0 and the mole is not in root node 1, the mole will move to the parent node of the node it is currently on.Use at most 300 operations to find the current node where the mole is located." 2500
1990D "Grid Puzzle" "bitmasks,brute force,dp,greedy,implementation" "You are given an array a of size n.There is an n\xc3\x97n grid. In the i-th row, the first ai cells are black and the other cells are white. In other words, note (i,j) as the cell in the i-th row and j-th column, cells (i,1),(i,2),\xe2\x80\xa6,(i,ai) are black, and cells (i,ai+1),\xe2\x80\xa6,(i,n) are white.You can do the following operations any number of times in any order:   Dye a 2\xc3\x972 subgrid white;  Dye a whole row white. Note you can not dye a whole column white. Find the minimum number of operations to dye all cells white." 1800
1990C "Mad MAD Sum" "brute force,greedy,math" "We define the MAD (Maximum Appearing Duplicate) in an array as the largest number that appears at least twice in the array. Specifically, if there is no number that appears at least twice, the MAD value is 0.For example, MAD([1,2,1])=1, MAD([2,2,3,3])=3, MAD([1,2,3,4])=0.You are given an array a of size n. Initially, a variable sum is set to 0.The following process will be executed in a sequential loop until all numbers in a become 0:  Set sum:=sum+\xe2\x88\x91ni=1ai;  Let b be an array of size n. Set bi:= MAD([a1,a2,\xe2\x80\xa6,ai]) for all 1\xe2\x89\xa4i\xe2\x89\xa4n, and then set ai:=bi for all 1\xe2\x89\xa4i\xe2\x89\xa4n. Find the value of sum after the process." 1500
1990B "Array Craft" "constructive algorithms,greedy" "For an array b of size m, we define: the maximum prefix position of b is the smallest index i that satisfies b1+\xe2\x80\xa6+bi=maxmj=1(b1+\xe2\x80\xa6+bj); the maximum suffix position of b is the largest index i that satisfies bi+\xe2\x80\xa6+bm=maxmj=1(bj+\xe2\x80\xa6+bm).You are given three integers n, x, and y (x>y). Construct an array a of size n satisfying: ai is either 1 or \xe2\x88\x921 for all 1\xe2\x89\xa4i\xe2\x89\xa4n; the maximum prefix position of a is x; the maximum suffix position of a is y.If there are multiple arrays that meet the conditions, print any. It can be proven that such an array always exists under the given conditions." 1200
1990A "Submission Bait" "brute force,games,greedy,sortings" "Alice and Bob are playing a game in an array a of size n.They take turns to do operations, with Alice starting first. The player who can not operate will lose. At first, a variable mx is set to 0.In one operation, a player can do: Choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that ai\xe2\x89\xa5mx and set mx to ai. Then, set ai to 0.Determine whether Alice has a winning strategy." 900
1989F "Simultaneous Coloring" "dfs and similar,divide and conquer,graphs" "You are given a matrix, consisting of n rows and m columns.You can perform two types of actions on it:   paint the entire column in blue;  paint the entire row in red. Note that you cannot choose which color to paint the row or column.In one second, you can perform either one action or multiple actions at the same time. If you perform one action, it will be free. If you perform k>1 actions at the same time, it will cost k2 coins. When multiple actions are performed at the same time, for each cell affected by actions of both types, the color can be chosen independently.You are asked to process q queries. Before each query, all cells become colorless. Initially, there are no restrictions on the color of any cells. In the i-th query, a restriction of the following form is added:   xi yi ci \xe2\x80\x94 the cell in row xi in column yi should be painted in color ci. Thus, after i queries, there are i restrictions on the required colors of the matrix cells. After each query, output the minimum cost of painting the matrix according to the restrictions." 3000
1989E "Distance to Different" combinatorics,dp,math "Consider an array a of n integers, where every element is from 1 to k, and every integer from 1 to k appears at least once.Let the array b be constructed as follows: for the i-th element of a, bi is the distance to the closest element in a which is not equal to ai. In other words, bi=minj\xe2\x88\x88[1,n],aj\xe2\x89\xa0ai|i\xe2\x88\x92j|.For example, if a=[1,1,2,3,3,3,3,1], then b=[2,1,1,1,2,2,1,1].Calculate the number of different arrays b you can obtain if you consider all possible arrays a, and print it modulo 998244353." 2300
1989D "Smithing Skill" "brute force,data structures,dp,greedy,math,sortings,two pointers" "You are playing a famous computer game (that just works) where you have various skills you can level up. Today, you focused on the ""Smithing"" skill. Your tactic is obvious: forging weapons from ingots and then melting them back to return the materials partially. For simplicity, every time you create an item, you get 1 experience point, and every time you melt an item, you also get 1 experience point.There are n classes of weapons you can forge and m types of metal ingots.You can create one weapon of the i-th class, spending ai ingots of metal of the same type. Melting a weapon of the i-th class (which you crafted earlier) returns you bi ingots of the type of metal it was made of.You have cj metal ingots of the j-th type, and you know that you can craft a weapon of any class from any metal type. Each combination of a weapon class and a metal type can be used any number of times.What is the maximum total amount of experience you can earn by crafting and melting weapons?" 1900
1989C "Two Movies" greedy,math "A movie company has released 2 movies. These 2 movies were watched by n people. For each person, we know their attitude towards the first movie (liked it, neutral, or disliked it) and towards the second movie.If a person is asked to leave a review for the movie, then:   if that person liked the movie, they will leave a positive review, and the movie\'s rating will increase by 1;  if that person disliked the movie, they will leave a negative review, and the movie\'s rating will decrease by 1;  otherwise, they will leave a neutral review, and the movie\'s rating will not change. Every person will review exactly one movie \xe2\x80\x94 and for every person, you can choose which movie they will review.The company\'s rating is the minimum of the ratings of the two movies. Your task is to calculate the maximum possible rating of the company." 1400
1989B "Substring and Subsequence" "brute force,greedy,strings" "You are given two strings a and b, both consisting of lowercase Latin letters. A subsequence of a string is a string which can be obtained by removing several (possibly zero) characters from the original string. A substring of a string is a contiguous subsequence of that string.For example, consider the string abac:  a, b, c, ab, aa, ac, ba, bc, aba, abc, aac, bac and abac are its subsequences;  a, b, c, ab, ba, ac, aba, bac and abac are its substrings. Your task is to calculate the minimum possible length of the string that contains a as a substring and b as a subsequence." 1200
1989A "Catch the Coin" implementation "Monocarp visited a retro arcade club with arcade cabinets. There got curious about the ""Catch the Coin"" cabinet.The game is pretty simple. The screen represents a coordinate grid such that:   the X-axis is directed from left to right;  the Y-axis is directed from bottom to top;  the center of the screen has coordinates (0,0). At the beginning of the game, the character is located in the center, and n coins appear on the screen \xe2\x80\x94 the i-th coin is at coordinates (xi,yi). The coordinates of all coins are different and not equal to (0,0).In one second, Monocarp can move the character in one of eight directions. If the character is at coordinates (x,y), then it can end up at any of the coordinates (x,y+1), (x+1,y+1), (x+1,y), (x+1,y\xe2\x88\x921), (x,y\xe2\x88\x921), (x\xe2\x88\x921,y\xe2\x88\x921), (x\xe2\x88\x921,y), (x\xe2\x88\x921,y+1).If the character ends up at the coordinates with a coin, then Monocarp collects that coin.After Monocarp makes a move, all coins fall down by 1, that is, they move from (x,y) to (x,y\xe2\x88\x921). You can assume that the game field is infinite in all directions.Monocarp wants to collect at least one coin, but cannot decide which coin to go for. Help him determine, for each coin, whether he can collect it." 800
1988F Heartbeat combinatorics,dp,fft,math "For an array u1,u2,\xe2\x80\xa6,un, define   a prefix maximum as an index i such that ui>uj for all j<i;  a suffix maximum as an index i such that ui>uj for all j>i;  an ascent as an index i (i>1) such that ui>ui\xe2\x88\x921. You are given three cost arrays: [a1,a2,\xe2\x80\xa6,an], [b1,b2,\xe2\x80\xa6,bn], and [c0,c1,\xe2\x80\xa6,cn\xe2\x88\x921].Define the cost of an array that has x prefix maximums, y suffix maximums, and z ascents as ax\xe2\x8b\x85by\xe2\x8b\x85cz.Let the sum of costs of all permutations of 1,2,\xe2\x80\xa6,n be f(n). Find f(1), f(2), ..., f(n) modulo 998244353." 3000
1988E "Range Minimum Sum" "binary search,brute force,data structures,divide and conquer,implementation" "For an array [a1,a2,\xe2\x80\xa6,an] of length n, define f(a) as the sum of the minimum element over all subsegments. That is, f(a)=n\xe2\x88\x91l=1n\xe2\x88\x91r=lminl\xe2\x89\xa4i\xe2\x89\xa4rai.A permutation is a sequence of integers from 1 to n of length n containing each number exactly once. You are given a permutation [a1,a2,\xe2\x80\xa6,an]. For each i, solve the following problem independently:  Erase ai from a, concatenating the remaining parts, resulting in b=[a1,a2,\xe2\x80\xa6,ai\xe2\x88\x921,ai+1,\xe2\x80\xa6,an].  Calculate f(b)." 2300
1988D "The Omnipotent Monster Killer" "brute force,dfs and similar,dp,trees" "You, the monster killer, want to kill a group of monsters. The monsters are on a tree with n vertices. On vertex with number i (1\xe2\x89\xa4i\xe2\x89\xa4n), there is a monster with ai attack points. You want to battle with monsters for 10100 rounds. In each round, the following happens in order:  All living monsters attack you. Your health decreases by the sum of attack points of all living monsters.  You select some (possibly all or none) monsters and kill them. After being killed, the monster will not be able to do any attacks in the future. There is a restriction: in one round, you cannot kill two monsters that are directly connected by an edge.If you choose what monsters to attack optimally, what is the smallest health decrement you can have after all rounds?" 2000
1988C "Increasing Sequence with Fixed OR" "bitmasks,constructive algorithms,greedy" "You are given a positive integer n. Find the longest sequence of positive integers a=[a1,a2,\xe2\x80\xa6,ak] that satisfies the following conditions, and print the sequence:  ai\xe2\x89\xa4n for all 1\xe2\x89\xa4i\xe2\x89\xa4k.  a is strictly increasing. That is, ai>ai\xe2\x88\x921 for all 2\xe2\x89\xa4i\xe2\x89\xa4k.  ai|ai\xe2\x88\x921=n for all 2\xe2\x89\xa4i\xe2\x89\xa4k, where | denotes the bitwise OR operation." 1300
1988B "Make Majority" greedy,implementation "You are given a sequence [a1,\xe2\x80\xa6,an] where each element ai is either 0 or 1. You can apply several (possibly zero) operations to the sequence. In each operation, you select two integers 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|a| (where |a| is the current length of a) and replace [al,\xe2\x80\xa6,ar] with a single element x, where x is the majority of [al,\xe2\x80\xa6,ar].Here, the majority of a sequence consisting of 0 and 1 is defined as follows: suppose there are c0 zeros and c1 ones in the sequence, respectively.   If c0\xe2\x89\xa5c1, the majority is 0.  If c0<c1, the majority is 1. For example, suppose a=[1,0,0,0,1,1]. If we select l=1,r=2, the resulting sequence will be [0,0,0,1,1]. If we select l=4,r=6, the resulting sequence will be [1,0,0,1]. Determine if you can make a=[1] with a finite number of operations." 900
1988A "Split the Multiset" "brute force,greedy,implementation,math" "A multiset is a set of numbers in which there can be equal elements, and the order of the numbers does not matter. For example, {2,2,4} is a multiset.You have a multiset S. Initially, the multiset contains only one positive integer n. That is, S={n}. Additionally, there is a given positive integer k.In one operation, you can select any positive integer u in S and remove one copy of u from S. Then, insert no more than k positive integers into S so that the sum of all inserted integers is equal to u.Find the minimum number of operations to make S contain n ones." 900
1987H "Fumo Temple" interactive "This temple only magnifies the mountain\'s power.BadelineThis is an interactive problem.You are given two positive integers n and m (n\xe2\x89\xa4m).The jury has hidden from you a rectangular matrix a with n rows and m columns, where ai,j\xe2\x88\x88{\xe2\x88\x921,0,1} for all 1\xe2\x89\xa4i\xe2\x89\xa4n and 1\xe2\x89\xa4j\xe2\x89\xa4m. The jury has also selected a cell (i0,j0). Your goal is to find (i0,j0).In one query, you give a cell (i,j), then the jury will reply with an integer.   If (i,j)=(i0,j0), the jury will reply with 0.  Else, let S be the sum of ax,y over all x and y such that min(i,i0)\xe2\x89\xa4x\xe2\x89\xa4max(i,i0) and min(j,j0)\xe2\x89\xa4y\xe2\x89\xa4max(j,j0). Then, the jury will reply with |i\xe2\x88\x92i0|+|j\xe2\x88\x92j0|+|S|. Find (i0,j0) by making at most n+225 queries.Note: the grader is not adaptive: a and (i0,j0) are fixed before any queries are made." 3500
1987G2 "Spinning Round (Hard Version)" "divide and conquer,dp,trees" "This is the hard version of the problem. The only difference between the two versions are the allowed characters in s. You can make hacks only if both versions of the problem are solved.You are given a permutation p of length n. You are also given a string s of length n, where each character is either L, R, or ?.For each i from 1 to n:   Define li as the largest index j<i such that pj>pi. If there is no such index, li:=i.  Define ri as the smallest index j>i such that pj>pi. If there is no such index, ri:=i. Initially, you have an undirected graph with n vertices (numbered from 1 to n) and no edges. Then, for each i from 1 to n, add one edge to the graph:   If si= L, add the edge (i,li) to the graph.  If si= R, add the edge (i,ri) to the graph.  If si= ?, either add the edge (i,li) or the edge (i,ri) to the graph at your choice. Find the maximum possible diameter over all connected\xe2\x88\x97 graphs that you can form. Output \xe2\x88\x921 if it is not possible to form any connected graphs.\xe2\x88\x97 Let d(s,t) denote the smallest number of edges on any path between s and t.The diameter of the graph is defined as the maximum value of d(s,t) over all pairs of vertices s and t." 3500
1987G1 "Spinning Round (Easy Version)" "divide and conquer,dp,trees" "This is the easy version of the problem. The only difference between the two versions are the allowed characters in s. In the easy version, s only contains the character ?. You can make hacks only if both versions of the problem are solved.You are given a permutation p of length n. You are also given a string s of length n, consisting only of the character ?.For each i from 1 to n:   Define li as the largest index j<i such that pj>pi. If there is no such index, li:=i.  Define ri as the smallest index j>i such that pj>pi. If there is no such index, ri:=i. Initially, you have an undirected graph with n vertices (numbered from 1 to n) and no edges. Then, for each i from 1 to n, add one edge to the graph:   If si= L, add the edge (i,li) to the graph.  If si= R, add the edge (i,ri) to the graph.  If si= ?, either add the edge (i,li) or the edge (i,ri) to the graph at your choice. Find the maximum possible diameter\xe2\x88\x97 over all connected graphs that you can form. Output \xe2\x88\x921 if it is not possible to form any connected graphs.\xe2\x88\x97 Let d(s,t) denote the smallest number of edges on any path between s and t.The diameter of the graph is defined as the maximum value of d(s,t) over all pairs of vertices s and t." 2900
1987F2 "Interesting Problem (Hard Version)" dp "This is the hard version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if both versions of the problem are solved.You are given an array of integers a of length n. In one operation, you will perform the following two-step process:   Choose an index i such that 1\xe2\x89\xa4i<|a| and ai=i.  Remove ai and ai+1 from the array and concatenate the remaining parts. Find the maximum number of times that you can perform the operation above." 2600
1987F1 "Interesting Problem (Easy Version)" dp "This is the easy version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if both versions of the problem are solved.You are given an array of integers a of length n. In one operation, you will perform the following two-step process:   Choose an index i such that 1\xe2\x89\xa4i<|a| and ai=i.  Remove ai and ai+1 from the array and concatenate the remaining parts. Find the maximum number of times that you can perform the operation above." 2500
1987E "Wonderful Tree!" "brute force,data structures,dfs and similar,dsu,greedy,trees" "God\'s Blessing on This ArrayForces!A Random PebbleYou are given a tree with n vertices, rooted at vertex 1. The i-th vertex has an integer ai written on it.Let L be the set of all direct children\xe2\x88\x97 of v. A tree is called wonderful, if for all vertices v where L is not empty, av\xe2\x89\xa4\xe2\x88\x91u\xe2\x88\x88Lau. In one operation, you choose any vertex v and increase av by 1.Find the minimum number of operations needed to make the given tree wonderful!\xe2\x88\x97 Vertex u is called a direct child of vertex v if:   u and v are connected by an edge, and  v is on the (unique) path from u to the root of the tree." 2000
1987D "World is Mine" dp,games "Alice and Bob are playing a game. Initially, there are n cakes, with the i-th cake having a tastiness value of ai.Alice and Bob take turns eating them, with Alice starting first:   In her turn, Alice chooses and eats any remaining cake whose tastiness is strictly greater than the maximum tastiness of any of the cakes she\'s eaten before that. Note that on the first turn, she can choose any cake.  In his turn, Bob chooses any remaining cake and eats it. The game ends when the current player can\'t eat a suitable cake. Let x be the number of cakes that Alice ate. Then, Alice wants to maximize x, while Bob wants to minimize x.Find out how many cakes Alice will eat if both players play optimally." 1800
1987C "Basil\'s Garden" dp,greedy "There are n flowers in a row, the i-th of them initially has a positive height of hi meters.Every second, the wind will blow from the left, causing the height of some flowers to decrease.Specifically, every second, for each i from 1 to n, in this order, the following happens:   If i=n or hi>hi+1, the value of hi changes to max(0,hi\xe2\x88\x921). How many seconds will pass before hi=0 for all 1\xe2\x89\xa4i\xe2\x89\xa4n for the first time?" 1200
1987B K-Sort greedy "You are given an array of integers a of length n. You can apply the following operation any number of times (maybe, zero):   First, choose an integer k such that 1\xe2\x89\xa4k\xe2\x89\xa4n and pay k+1 coins.  Then, choose exactly k indices such that 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n.  Then, for each x from 1 to k, increase aix by 1. Find the minimum number of coins needed to make a non-decreasing. That is, a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an." 1000
1987A "Upload More RAM" greedy,math "Oh no, the ForceCodes servers are running out of memory! Luckily, you can help them out by uploading some of your RAM!You want to upload n GBs of RAM. Every second, you will upload either 0 or 1 GB of RAM. However, there is a restriction on your network speed: in any k consecutive seconds, you can upload only at most 1 GB of RAM in total.Find the minimum number of seconds needed to upload n GBs of RAM!" 800
1986G2 "Permutation Problem (Hard Version)" "brute force,data structures,hashing,math,number theory" "This is the hard version of the problem. The only difference is that in this version n\xe2\x89\xa45\xe2\x8b\x85105 and the sum of n for all sets of input data does not exceed 5\xe2\x8b\x85105.You are given a permutation p of length n. Calculate the number of index pairs 1\xe2\x89\xa4i<j\xe2\x89\xa4n such that pi\xe2\x8b\x85pj is divisible by i\xe2\x8b\x85j without remainder.A permutation is a sequence of n integers, in which each integer from 1 to n occurs exactly once. For example, [1], [3,5,2,1,4], [1,3,2] are permutations, while [2,3,2], [4,3,1], [0] are not." 2500
1986G1 "Permutation Problem (Simple Version)" "binary search,brute force,combinatorics,data structures,math,number theory" "This is a simple version of the problem. The only difference is that in this version n\xe2\x89\xa4105 and the sum of n for all sets of input data does not exceed 105.You are given a permutation p of length n. Calculate the number of index pairs 1\xe2\x89\xa4i<j\xe2\x89\xa4n such that pi\xe2\x8b\x85pj is divisible by i\xe2\x8b\x85j without remainder.A permutation is a sequence of n integers, where each integer from 1 to n occurs exactly once. For example, [1], [3,5,2,1,4], [1,3,2] are permutations, while [2,3,2], [4,3,1], [0] are not." 2200
1986F "Non-academic Problem" "dfs and similar,graphs,trees" "You are given a connected undirected graph, the vertices of which are numbered with integers from 1 to n. Your task is to minimize the number of pairs of vertices 1\xe2\x89\xa4u<v\xe2\x89\xa4n between which there exists a path in this graph. To achieve this, you can remove exactly one edge from the graph.Find the smallest number of pairs of vertices!" 1900
1986E "Beautiful Array" "greedy,math,number theory,sortings" "You are given an array of integers a1,a2,\xe2\x80\xa6,an and an integer k. You need to make it beautiful with the least amount of operations.Before applying operations, you can shuffle the array elements as you like. For one operation, you can do the following: Choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n, Make ai=ai+k.The array b1,b2,\xe2\x80\xa6,bn is beautiful if bi=bn\xe2\x88\x92i+1 for all 1\xe2\x89\xa4i\xe2\x89\xa4n.Find the minimum number of operations needed to make the array beautiful, or report that it is impossible." 1700
1986D "Mathematical Problem" "brute force,dp,greedy,implementation,math,two pointers" "You are given a string s of length n>1, consisting of digits from 0 to 9. You must insert exactly n\xe2\x88\x922 symbols + (addition) or \xc3\x97 (multiplication) into this string to form a valid arithmetic expression.In this problem, the symbols cannot be placed before the first or after the last character of the string s, and two symbols cannot be written consecutively. Also, note that the order of the digits in the string cannot be changed. Let\'s consider s=987009: From this string, the following arithmetic expressions can be obtained: 9\xc3\x978+70\xc3\x970+9=81, 98\xc3\x977\xc3\x970+0\xc3\x979=0, 9+8+7+0+09=9+8+7+0+9=33. Note that the number 09 is considered valid and is simply transformed into 9. From this string, the following arithmetic expressions cannot be obtained: +9\xc3\x978\xc3\x9770+09 (symbols should only be placed between digits), 98\xc3\x9770+0+9 (since there are 6 digits, there must be exactly 4 symbols).The result of the arithmetic expression is calculated according to the rules of mathematics \xe2\x80\x94 first all multiplication operations are performed, then addition. You need to find the minimum result that can be obtained by inserting exactly n\xe2\x88\x922 addition or multiplication symbols into the given string s." 1400
1986C "Update Queries" "data structures,greedy,sortings" "Let\'s consider the following simple problem. You are given a string s of length n, consisting of lowercase Latin letters, as well as an array of indices ind of length m (1\xe2\x89\xa4indi\xe2\x89\xa4n) and a string c of length m, consisting of lowercase Latin letters. Then, in order, you perform the update operations, namely, during the i-th operation, you set sindi=ci. Note that you perform all m operations from the first to the last.Of course, if you change the order of indices in the array ind and/or the order of letters in the string c, you can get different results. Find the lexicographically smallest string s that can be obtained after m update operations, if you can rearrange the indices in the array ind and the letters in the string c as you like.A string a is lexicographically less than a string b if and only if one of the following conditions is met: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the symbol in string a is earlier in the alphabet than the corresponding symbol in string b." 1100
1986B "Matrix Stabilization" "brute force,data structures,greedy,sortings" "You are given a matrix of size n\xc3\x97m, where the rows are numbered from 1 to n from top to bottom, and the columns are numbered from 1 to m from left to right. The element at the intersection of the i-th row and the j-th column is denoted by aij.Consider the algorithm for stabilizing matrix a: Find the cell (i,j) such that its value is strictly greater than the values of all its neighboring cells. If there is no such cell, terminate the algorithm. If there are multiple such cells, choose the cell with the smallest value of i, and if there are still multiple cells, choose the one with the smallest value of j. Set aij=aij\xe2\x88\x921.  Go to step 1. In this problem, cells (a,b) and (c,d) are considered neighbors if they share a common side, i.e., |a\xe2\x88\x92c|+|b\xe2\x88\x92d|=1.Your task is to output the matrix a after the stabilization algorithm has been executed. It can be shown that this algorithm cannot run for an infinite number of iterations." 1000
1986A "X Axis" "brute force,geometry,math,sortings" "You are given three points with integer coordinates x1, x2, and x3 on the X axis (1\xe2\x89\xa4xi\xe2\x89\xa410). You can choose any point with an integer coordinate a on the X axis. Note that the point a may coincide with x1, x2, or x3. Let f(a) be the total distance from the given points to the point a. Find the smallest value of f(a).The distance between points a and b is equal to |a\xe2\x88\x92b|. For example, the distance between points a=5 and b=2 is 3." 800
1985H2 "Maximize the Largest Component (Hard Version)" "data structures,dfs and similar,dp,dsu,implementation" "Easy and hard versions are actually different problems, so read statements of both problems completely and carefully. The only difference between the two versions is the operation.Alex has a grid with n rows and m columns consisting of \'.\' and \'#\' characters. A set of \'#\' cells forms a connected component if from any cell in this set, it is possible to reach any other cell in this set by only moving to another cell in the set that shares a common side. The size of a connected component is the number of cells in the set.In one operation, Alex selects any row r (1\xe2\x89\xa4r\xe2\x89\xa4n) and any column c (1\xe2\x89\xa4c\xe2\x89\xa4m), then sets every cell in row r and column c to be \'#\'. Help Alex find the maximum possible size of the largest connected component of \'#\' cells that he can achieve after performing the operation at most once." 2200
1985H1 "Maximize the Largest Component (Easy Version)" "brute force,data structures,dfs and similar,dsu,graphs,implementation" "Easy and hard versions are actually different problems, so read statements of both problems completely and carefully. The only difference between the two versions is the operation.Alex has a grid with n rows and m columns consisting of \'.\' and \'#\' characters. A set of \'#\' cells forms a connected component if from any cell in this set, it is possible to reach any other cell in this set by only moving to another cell in the set that shares a common side. The size of a connected component is the number of cells in the set.In one operation, Alex selects any row r (1\xe2\x89\xa4r\xe2\x89\xa4n) or any column c (1\xe2\x89\xa4c\xe2\x89\xa4m), then sets every cell in row r or column c to be \'#\'. Help Alex find the maximum possible size of the largest connected component of \'#\' cells that he can achieve after performing the operation at most once." 1700
1985G D-Function "combinatorics,math,number theory" "Let D(n) represent the sum of digits of n. For how many integers n where 10l\xe2\x89\xa4n<10r satisfy D(k\xe2\x8b\x85n)=k\xe2\x8b\x85D(n)? Output the answer modulo 109+7." 1600
1985F "Final Boss" "binary search,data structures" "You are facing the final boss in your favorite video game. The boss enemy has h health. Your character has n attacks. The i\'th attack deals ai damage to the boss but has a cooldown of ci turns, meaning the next time you can use this attack is turn x+ci if your current turn is x. Each turn, you can use all attacks that are not currently on cooldown, all at once. If all attacks are on cooldown, you do nothing for the turn and skip to the next turn.Initially, all attacks are not on cooldown. How many turns will you take to beat the boss? The boss is beaten when its health is 0 or less." 1500
1985E "Secret Box" "brute force,combinatorics,math" "Ntarsis has a box B with side lengths x, y, and z. It lies in the 3D coordinate plane, extending from (0,0,0) to (x,y,z). Ntarsis has a secret box S. He wants to choose its dimensions such that all side lengths are positive integers, and the volume of S is k. He can place S somewhere within B such that:   S is parallel to all axes.  every corner of S lies on an integer coordinate. S is magical, so when placed at an integer location inside B, it will not fall to the ground. Among all possible ways to choose the dimensions of S, determine the maximum number of distinct locations he can choose to place his secret box S inside B. Ntarsis does not rotate S once its side lengths are selected." 1200
1985D "Manhattan Circle" implementation,math "Given a n by m grid consisting of \'.\' and \'#\' characters, there exists a whole manhattan circle on the grid. The top left corner of the grid has coordinates (1,1), and the bottom right corner has coordinates (n,m).Point (a,b) belongs to the manhattan circle centered at (h,k) if |h\xe2\x88\x92a|+|k\xe2\x88\x92b|<r, where r is a positive constant.On the grid, the set of points that are part of the manhattan circle is marked as \'#\'. Find the coordinates of the center of the circle." 900
1985C "Good Prefixes" greedy "Alex thinks some array is good if there exists some element that can be represented as the sum of all other elements (the sum of all other elements is 0 if there are no other elements). For example, the array [1,6,3,2] is good since 1+3+2=6. Furthermore, the array [0] is also good. However, the arrays [1,2,3,4] and [1] are not good.Alex has an array a1,a2,\xe2\x80\xa6,an. Help him count the number of good non-empty prefixes of the array a. In other words, count the number of integers i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that the length i prefix (i.e. a1,a2,\xe2\x80\xa6,ai) is good." 1000
1985B "Maximum Multiple Sum" "brute force,math,number theory" "Given an integer n, find an integer x such that:   2\xe2\x89\xa4x\xe2\x89\xa4n.  The sum of multiples of x that are less than or equal to n is maximized. Formally, x+2x+3x+\xe2\x8b\xaf+kx where kx\xe2\x89\xa4n is maximized over all possible values of x." 800
1985A "Creating Words" implementation,strings "Matthew is given two strings a and b, both of length 3. He thinks it\'s particularly funny to create two new words by swapping the first character of a with the first character of b. He wants you to output a and b after the swap.Note that the new words may not necessarily be different." 800
1984H "Tower Capturing" combinatorics,dp,geometry "There are n towers at n distinct points (x1,y1),(x2,y2),\xe2\x80\xa6,(xn,yn), such that no three are collinear and no four are concyclic. Initially, you own towers (x1,y1) and (x2,y2), and you want to capture all of them. To do this, you can do the following operation any number of times:   Pick two towers P and Q you own and one tower R you don\'t own, such that the circle through P, Q, and R contains all n towers inside of it.  Afterwards, capture all towers in or on triangle \xe2\x96\xb3PQR, including R itself.  An attack plan is a series of choices of R (R1,R2,\xe2\x80\xa6,Rk) using the above operations after which you capture all towers. Note that two attack plans are considered different only if they differ in their choice of R in some operation; in particular, two attack plans using the same choices of R but different choices of P and Q are considered the same.Count the number of attack plans of minimal length. Note that it might not be possible to capture all towers, in which case the answer is 0. Since the answer may be large, output it modulo 998244353." 3300
1984G "Magic Trick II" "constructive algorithms,implementation,sortings" "The secret behind Oscar\'s first magic trick has been revealed! Because he still wants to impress Lura, he comes up with a new idea: he still wants to sort a permutation p1,p2,\xe2\x80\xa6,pn of [1,2,\xe2\x80\xa6,n].This time, he chooses an integer k. He wants to sort the permutation in non-decreasing order using the following operation several times:   Pick a continuous subarray of length k and remove it from p.  Insert the continuous subarray back into p at any position (perhaps, in the very front or the very back). To be as impressive as possible, Oscar would like to choose the maximal value of k such that he can sort his permutation. Please help him find the maximal k as well as a sequence of operations that will sort the permutation. You don\'t need to minimize the number of operations, but you are allowed to use at most 5n2 operations.We have a proof that, for the maximal k such that you can sort the permutation in any number of operations, you can also sort it in at most 5n2 operations." 3200
1984F Reconstruction "brute force,dp,math" "There is a hidden array a1,a2,\xe2\x80\xa6,an of length n whose elements are integers between \xe2\x88\x92m and m, inclusive.You are given an array b1,b2,\xe2\x80\xa6,bn of length n and a string s of length n consisting of the characters P, S, and ?.For each i from 1 to n inclusive, we must have:   If si=P, bi is the sum of a1 through ai.  If si=S, bi is the sum of ai through an. Output the number of ways to replace all ? in s with either P or S such that there exists an array a1,a2,\xe2\x80\xa6,an with elements not exceeding m by absolute value satisfying the constraints given by the array b1,b2,\xe2\x80\xa6,bn and the string s.Since the answer may be large, output it modulo 998244353." 2500
1984E Shuffle dp,greedy,trees "Two hungry red pandas, Oscar and Lura, have a tree T with n nodes. They are willing to perform the following shuffle procedure on the whole tree T exactly once. With this shuffle procedure, they will create a new tree out of the nodes of the old tree.   Choose any node V from the original tree T. Create a new tree T2, with V as the root.  Remove V from T, such that the original tree is split into one or more subtrees (or zero subtrees, if V is the only node in T).  Shuffle each subtree with the same procedure (again choosing any node as the root), then connect all shuffled subtrees\' roots back to V to finish constructing T2. After this, Oscar and Lura are left with a new tree T2. They can only eat leaves and are very hungry, so please find the maximum number of leaves over all trees that can be created in exactly one shuffle.Note that leaves are all nodes with degree 1. Thus, the root may be considered as a leaf if it has only one child." 2400
1984D "\'\'a\'\' String Problem" "brute force,hashing,implementation,math,string suffix structures,strings" "You are given a string s consisting of lowercase Latin characters. Count the number of nonempty strings t\xe2\x89\xa0 ""a"" such that it is possible to partition\xe2\x80\xa0 s into some substrings satisfying the following conditions:   each substring either equals t or ""a"", and  at least one substring equals t.  \xe2\x80\xa0 A partition of a string s is an ordered sequence of some k strings t1,t2,\xe2\x80\xa6,tk (called substrings) such that t1+t2+\xe2\x80\xa6+tk=s, where + represents the concatenation operation." 2000
1984C2 "Magnitude (Hard Version)" combinatorics,dp,greedy,math "The two versions of the problem are different. You may want to read both versions. You can make hacks only if both versions are solved.You are given an array a of length n. Start with c=0. Then, for each i from 1 to n (in increasing order) do exactly one of the following:   Option 1: set c to c+ai.  Option 2: set c to |c+ai|, where |x| is the absolute value of x. Let the maximum final value of c after the procedure described above be equal to k. Find the number of unique procedures that result in c=k. Two procedures are different if at any index i, one procedure chose option 1 and another chose option 2, even if the value of c is equal for both procedures after that turn.Since the answer may be large, output it modulo 998244353." 1700
1984C1 "Magnitude (Easy Version)" dp,greedy,math "The two versions of the problem are different. You may want to read both versions. You can make hacks only if both versions are solved.You are given an array a of length n. Start with c=0. Then, for each i from 1 to n (in increasing order) do exactly one of the following:   Option 1: set c to c+ai.  Option 2: set c to |c+ai|, where |x| is the absolute value of x. Let the maximum final value of c after the procedure described above be equal to k. Find k." 1300
1984B "Large Addition" implementation,math "A digit is large if it is between 5 and 9, inclusive. A positive integer is large if all of its digits are large.You are given an integer x. Can it be the sum of two large positive integers with the same number of digits?" 1100
1984A "Strange Splitting" "constructive algorithms" "Define the range of a non-empty array to be the maximum value minus the minimum value. For example, the range of [1,4,2] is 4\xe2\x88\x921=3.You are given an array a1,a2,\xe2\x80\xa6,an of length n\xe2\x89\xa53. It is guaranteed a is sorted.You have to color each element of a red or blue so that:   the range of the red elements does not equal the range of the blue elements, and  there is at least one element of each color. If there does not exist any such coloring, you should report it. If there are multiple valid colorings, you can print any of them." 800
1983G "Your Loss" "bitmasks,brute force,dp,trees" "You are given a tree with n nodes numbered from 1 to n, along with an array of size n. The value of i-th node is ai. There are q queries. In each query, you are given 2 nodes numbered as x and y. Consider the path from the node numbered as x to the node numbered as y. Let the path be represented by x=p0,p1,p2,\xe2\x80\xa6,pr=y, where pi are the intermediate nodes. Compute the sum of api\xe2\x8a\x95i for each i such that 0\xe2\x89\xa4i\xe2\x89\xa4r where \xe2\x8a\x95 is the XOR operator. More formally, compute r\xe2\x88\x91i=0api\xe2\x8a\x95i." 3000
1983F array-value "binary search,bitmasks,data structures,greedy,two pointers" "You have an array of non-negative integers a1,a2,\xe2\x80\xa6,an.The value of a sub-array of length \xe2\x89\xa52, a[l,r]=[al,al+1,\xe2\x80\xa6,ar] is the minimum value of ai\xe2\x8a\x95aj such that l\xe2\x89\xa4i<j\xe2\x89\xa4r, where \xe2\x8a\x95 is the xor (exclusive-or) operator.You have to find the k-th smallest value over all sub-arrays of length \xe2\x89\xa52." 2500
1983E "I Love Balls" combinatorics,math,probabilities "Alice and Bob are playing a game. There are n balls, out of which k are special. Each ball has a value associated with it. The players play turn by turn. In each turn, the player randomly picks a ball and adds the value of the ball to their score, which is 0 at the beginning of the game. The selected ball is removed from the game. If the ball was special, the same player takes the next turn if at least one ball is remaining. If the ball picked was not special, the next player plays their turn.They play this game until no balls are remaining in the game. Alice plays first.Find the expected score that both the players have at the end of the game modulo 109+7. Formally, let M=109+7. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 2300
1983D "Swap Dilemma" "constructive algorithms,data structures,divide and conquer,greedy,math,sortings" "Given two arrays of distinct positive integers a and b of length n, we would like to make both the arrays the same. Two arrays x and y of length k are said to be the same when for all 1\xe2\x89\xa4i\xe2\x89\xa4k, xi=yi.Now in one move, you can choose some index l and r in a (l\xe2\x89\xa4r) and swap al and ar, then choose some p and q (p\xe2\x89\xa4q) in b such that r\xe2\x88\x92l=q\xe2\x88\x92p and swap bp and bq.Is it possible to make both arrays the same?" 1700
1983C "Have Your Cake and Eat It Too" "binary search,brute force,greedy,implementation" "Alice, Bob and Charlie want to share a rectangular cake cut into n pieces. Each person considers every piece to be worth a different value. The i-th piece is considered to be of value ai by Alice, bi by Bob and ci by Charlie.The sum over all ai, all bi and all ci individually is the same, equal to tot.Given the values of each piece of the cake for each person, you need to give each person a contiguous slice of cake. In other words, the indices at the left and right ends of these subarrays (the slices given to each person) can be represented as (la,ra), (lb,rb) and (lc,rc) respectively for Alice, Bob and Charlie. The division needs to satisfy the following constraints:  No piece is assigned to more than one person, i.e., no two subarrays among [la,\xe2\x80\xa6,ra], [lb,\xe2\x80\xa6,rb] and [lc,\xe2\x80\xa6,rc] intersect. \xe2\x88\x91rai=laai,\xe2\x88\x91rbi=lbbi,\xe2\x88\x91rci=lcci\xe2\x89\xa5\xe2\x8c\x88tot3\xe2\x8c\x89. Here, the notation \xe2\x8c\x88ab\xe2\x8c\x89 represents ceiling division. It is defined as the smallest integer greater than or equal to the exact division of a by b. In other words, it rounds up the division result to the nearest integer. For instance \xe2\x8c\x88103\xe2\x8c\x89=4 and \xe2\x8c\x88153\xe2\x8c\x89=5." 1400
1983B "Corner Twist" "constructive algorithms,greedy,implementation,math" "You are given two grids of numbers a and b, with n rows and m columns. All the values in the grid are 0, 1 or 2.You can perform the following operation on a any number of times:   Pick any subrectangle in the grid with length and width \xe2\x89\xa52. You are allowed to choose the entire grid as a subrectangle.  The subrectangle has four corners. Take any pair of diagonally opposite corners of the chosen subrectangle and add 1 to their values modulo 3.  For the pair of corners not picked, add 2 to their values modulo 3. Note that the operation only changes the values of the corners of the picked subrectangle.Is it possible to convert the grid a into grid b by applying the above operation any number of times (possibly zero)?" 1200
1983A "Array Divisibility" "constructive algorithms,math" "An array of integers a1,a2,\xe2\x8b\xaf,an is beautiful subject to an integer k if it satisfies the following:   The sum of aj over all j such that j is a multiple of k and 1\xe2\x89\xa4j\xe2\x89\xa4n, itself, is a multiple of k.  More formally, if \xe2\x88\x91k|jaj is divisible by k for all 1\xe2\x89\xa4j\xe2\x89\xa4n then the array a is beautiful subject to k. Here, the notation k|j means k divides j, that is, j is a multiple of k.  Given n, find an array of positive nonzero integers, with each element less than or equal to 105 that is beautiful subject to all 1\xe2\x89\xa4k\xe2\x89\xa4n.It can be shown that an answer always exists." 800
1982F "Sorting Problem Again" "binary search,data structures,sortings" "You have an array a of n elements. There are also q modifications of the array. Before the first modification and after each modification, you would like to know the following:What is the minimum length subarray that needs to be sorted in non-decreasing order in order for the array a to be completely sorted in non-decreasing order?More formally, you want to select a subarray of the array (l,r) with the minimum value of r\xe2\x88\x92l+1. After that, you will sort the elements al,al+1,\xe2\x80\xa6,ar and want the condition ai\xe2\x89\xa4ai+1 to hold for all 1\xe2\x89\xa4i<n. If the array is already sorted in non-decreasing order, then l and r should be considered as equal to \xe2\x88\x921.Note that finding such (l,r) does not change the array in any way. The modifications themselves take the form: assign apos=x for given pos and x." 2600
1982E "Number of k-good subarrays" "bitmasks,brute force,combinatorics,divide and conquer,dp,math,meet-in-the-middle" "Let bit(x) denote the number of ones in the binary representation of a non-negative integer x.A subarray of an array is called k-good if it consists only of numbers with no more than k ones in their binary representation, i.e., a subarray (l,r) of array a is good if for any i such that l\xe2\x89\xa4i\xe2\x89\xa4r condition bit(ai)\xe2\x89\xa4k is satisfied.You are given an array a of length n, consisting of consecutive non-negative integers starting from 0, i.e., ai=i for 0\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 (in 0-based indexing). You need to count the number of k-good subarrays in this array.As the answer can be very large, output it modulo 109+7." 2300
1982D "Beauty of the mountains" "brute force,data structures,implementation,math,number theory" "Nikita loves mountains and has finally decided to visit the Berlyand mountain range! The range was so beautiful that Nikita decided to capture it on a map. The map is a table of n rows and m columns, with each cell containing a non-negative integer representing the height of the mountain.He also noticed that mountains come in two types:  With snowy caps.  Without snowy caps. Nikita is a very pragmatic person. He wants the sum of the heights of the mountains with snowy caps to be equal to the sum of the heights of the mountains without them. He has arranged with the mayor of Berlyand, Polikarp Polikarpovich, to allow him to transform the landscape.Nikita can perform transformations on submatrices of size k\xc3\x97k as follows: he can add an integer constant c to the heights of the mountains within this area, but the type of the mountain remains unchanged. Nikita can choose the constant c independently for each transformation. Note that c can be negative.Before making the transformations, Nikita asks you to find out if it is possible to achieve equality of the sums, or if it is impossible. It doesn\'t matter at what cost, even if the mountains turn into canyons and have negative heights.If only one type of mountain is represented on the map, then the sum of the heights of the other type of mountain is considered to be zero." 1700
1982C "Boring Day" "binary search,data structures,dp,greedy,two pointers" "On another boring day, Egor got bored and decided to do something. But since he has no friends, he came up with a game to play.Egor has a deck of n cards, the i-th card from the top has a number ai written on it. Egor wants to play a certain number of rounds until the cards run out. In each round, he takes a non-zero number of cards from the top of the deck and finishes the round. If the sum of the numbers on the cards collected during the round is between l and r, inclusive, the round is won; otherwise, it is lost. Egor knows by heart the order of the cards. Help Egor determine the maximum number of rounds he can win in such a game. Note that Egor is not required to win rounds consecutively." 1200
1982B "Collatz Conjecture" "brute force,implementation,math,number theory" "Recently, the first-year student Maxim learned about the Collatz conjecture, but he didn\'t pay much attention during the lecture, so he believes that the following process is mentioned in the conjecture:There is a variable x and a constant y. The following operation is performed k times:   increase x by 1, then  while the number x is divisible by y, divide it by y.  Note that both of these actions are performed sequentially within one operation.For example, if the number x=16, y=3, and k=2, then after one operation x becomes 17, and after another operation x becomes 2, because after adding one, x=18 is divisible by 3 twice.Given the initial values of x, y, and k, Maxim wants to know what is the final value of x." 1200
1982A Soccer greedy,implementation,math,sortings "Dima loves watching soccer. In such a game, the score on the scoreboard is represented as x : y, where x is the number of goals of the first team, and y is the number of goals of the second team. At any given time, only one team can score a goal, so the score x : y can change to either (x+1) : y, or x : (y+1).While watching a soccer game, Dima was distracted by very important matters, and after some time, he returned to watching the game. Dima remembers the score right before he was distracted, and the score right after he returned. Given these two scores, he wonders the following question. Is it possible that, while Dima was not watching the game, the teams never had an equal score?It is guaranteed that at neither of the two time points Dima remembers the teams had equal scores. However, it is possible that the score did not change during his absence.Help Dima and answer the question!" 800
1981F "Turtle and Paths on a Tree" "data structures,dp,trees" "Note the unusual definition of MEX in this problem.Piggy gave Turtle a binary tree\xe2\x80\xa0 with n vertices and a sequence a1,a2,\xe2\x80\xa6,an on his birthday. The binary tree is rooted at vertex 1.If a set of paths P={(xi,yi)} in the tree covers each edge exactly once, then Turtle will think that the set of paths is good. Note that a good set of paths can cover a vertex twice or more.Turtle defines the value of a set of paths as \xe2\x88\x91(x,y)\xe2\x88\x88Pf(x,y), where f(x,y) denotes the MEX\xe2\x80\xa1 of all au such that vertex u is on the simple path from x to y in the tree (including the starting vertex x and the ending vertex y).Turtle wonders the minimum value over all good sets of paths. Please help him calculate the answer!\xe2\x80\xa0A binary tree is a tree where every non-leaf vertex has at most 2 sons.\xe2\x80\xa1MEX of a collection of integers c1,c2,\xe2\x80\xa6,ck is defined as the smallest positive integer x which does not occur in the collection c. For example, MEX of [3,3,1,4] is 2, MEX of [2,3] is 1." 3000
1981E "Turtle and Intersected Segments" "data structures,dsu,graphs,greedy" "Turtle just received n segments and a sequence a1,a2,\xe2\x80\xa6,an. The i-th segment is [li,ri].Turtle will create an undirected graph G. If segment i and segment j intersect, then Turtle will add an undirected edge between i and j with a weight of |ai\xe2\x88\x92aj|, for every i\xe2\x89\xa0j.Turtle wants you to calculate the sum of the weights of the edges of the minimum spanning tree of the graph G, or report that the graph G has no spanning tree.We say two segments [l1,r1] and [l2,r2] intersect if and only if max(l1,l2)\xe2\x89\xa4min(r1,r2)." 2600
1981D "Turtle and Multiplication" "constructive algorithms,dfs and similar,graphs,number theory" "Turtle just learned how to multiply two integers in his math class, and he was very excited.Then Piggy gave him an integer n, and asked him to construct a sequence a1,a2,\xe2\x80\xa6,an consisting of integers which satisfied the following conditions:  For all 1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4ai\xe2\x89\xa43\xe2\x8b\x85105.  For all 1\xe2\x89\xa4i<j\xe2\x89\xa4n\xe2\x88\x921, ai\xe2\x8b\x85ai+1\xe2\x89\xa0aj\xe2\x8b\x85aj+1. Of all such sequences, Piggy asked Turtle to find the one with the minimum number of distinct elements.Turtle definitely could not solve the problem, so please help him!" 2400
1981C "Turtle and an Incomplete Sequence" "bitmasks,brute force,constructive algorithms,greedy,implementation,math" "Turtle was playing with a sequence a1,a2,\xe2\x80\xa6,an consisting of positive integers. Unfortunately, some of the integers went missing while playing.Now the sequence becomes incomplete. There may exist an arbitrary number of indices i such that ai becomes \xe2\x88\x921. Let the new sequence be a\xe2\x80\xb2.Turtle is sad. But Turtle remembers that for every integer i from 1 to n\xe2\x88\x921, either ai=\xe2\x8c\x8aai+12\xe2\x8c\x8b or ai+1=\xe2\x8c\x8aai2\xe2\x8c\x8b holds for the original sequence a.Turtle wants you to help him complete the sequence. But sometimes Turtle makes mistakes, so you need to tell him if you can\'t complete the sequence.Formally, you need to find another sequence b1,b2,\xe2\x80\xa6,bn consisting of positive integers such that:  For every integer i from 1 to n, if a\xe2\x80\xb2i\xe2\x89\xa0\xe2\x88\x921, then bi=a\xe2\x80\xb2i.  For every integer i from 1 to n\xe2\x88\x921, either bi=\xe2\x8c\x8abi+12\xe2\x8c\x8b or bi+1=\xe2\x8c\x8abi2\xe2\x8c\x8b holds.  For every integer i from 1 to n, 1\xe2\x89\xa4bi\xe2\x89\xa4109. If there is no sequence b1,b2,\xe2\x80\xa6,bn that satisfies all of the conditions above, you need to report \xe2\x88\x921." 1800
1981B "Turtle and an Infinite Sequence" bitmasks,math "There is a sequence a0,a1,a2,\xe2\x80\xa6 of infinite length. Initially ai=i for every non-negative integer i.After every second, each element of the sequence will simultaneously change. ai will change to ai\xe2\x88\x921\xe2\x88\xa3ai\xe2\x88\xa3ai+1 for every positive integer i. a0 will change to a0\xe2\x88\xa3a1. Here, | denotes bitwise OR.Turtle is asked to find the value of an after m seconds. In particular, if m=0, then he needs to find the initial value of an. He is tired of calculating so many values, so please help him!" 1300
1981A "Turtle and Piggy Are Playing a Game" "brute force,greedy,math" "Turtle and Piggy are playing a number game.First, Turtle will choose an integer x, such that l\xe2\x89\xa4x\xe2\x89\xa4r, where l,r are given. It\'s also guaranteed that 2l\xe2\x89\xa4r.Then, Piggy will keep doing the following operation until x becomes 1:  Choose an integer p such that p\xe2\x89\xa52 and p\xe2\x88\xa3x (i.e. x is a multiple of p).  Set x to xp, and the score will increase by 1. The score is initially 0. Both Turtle and Piggy want to maximize the score. Please help them to calculate the maximum score." 800
1980G "Yasya and the Mysterious Tree" "bitmasks,data structures,dfs and similar,graphs,greedy,strings,trees" "Yasya was walking in the forest and accidentally found a tree with n vertices. A tree is a connected undirected graph with no cycles.Next to the tree, the girl found an ancient manuscript with m queries written on it. The queries can be of two types.The first type of query is described by the integer y. The weight of each edge in the tree is replaced by the bitwise exclusive OR of the weight of that edge and the integer y.The second type is described by the vertex v and the integer x. Yasya chooses a vertex u (1\xe2\x89\xa4u\xe2\x89\xa4n, u\xe2\x89\xa0v) and mentally draws a bidirectional edge of weight x from v to u in the tree.Then Yasya finds a simple cycle in the resulting graph and calculates the bitwise exclusive OR of all the edges in it. She wants to choose a vertex u such that the calculated value is maximum. This calculated value will be the answer to the query. It can be shown that such a cycle exists and is unique under the given constraints (independent of the choice of u). If an edge between v and u already existed, a simple cycle is the path v\xe2\x86\x92u\xe2\x86\x92v.Note that the second type of query is performed mentally, meaning the tree does not change in any way after it.Help Yasya answer all the queries." 2300
1980F2 "Field Division (hard version)" math,sortings "This is a hard version of the problem; it differs from the easy version only by the question. The easy version only needs you to print whether some values are non-zero or not. The hard version needs you to print the exact values.Alice and Bob are dividing the field. The field is a rectangle of size n\xc3\x97m (2\xe2\x89\xa4n,m\xe2\x89\xa4109); the rows are numbered from 1 to n from top to bottom, and the columns are numbered from 1 to m from left to right. The cell at the intersection of row r and column c is denoted as (r,c).Bob has k (2\xe2\x89\xa4k\xe2\x89\xa42\xe2\x8b\x85105) fountains, all of them are located in different cells of the field. Alice is responsible for dividing the field, but she must meet several conditions:  To divide the field, Alice will start her path in any free (without a fountain) cell on the left or top side of the field and will move, each time moving to the adjacent cell down or right. Her path will end on the right or bottom side of the field.  Alice\'s path will divide the field into two parts \xe2\x80\x94 one part will belong to Alice (this part includes the cells of her path), the other part \xe2\x80\x94 to Bob.  Alice will own the part that includes the cell (n,1).  Bob will own the part that includes the cell (1,m). Alice wants to divide the field in such a way as to get as many cells as possible.Bob wants to keep ownership of all the fountains, but he can give one of them to Alice. First, output the integer \xce\xb1 \xe2\x80\x94 the maximum possible size of Alice\'s plot, if Bob does not give her any fountain (i.e., all fountains will remain on Bob\'s plot).Then output k non-negative integers a1,a2,\xe2\x80\xa6,ak, where ai is a value such that after Bob gives Alice the i-th fountain, the maximum size of her plot will be \xce\xb1+ai." 2400
1980F1 "Field Division (easy version)" "data structures,math,sortings" "This is an easy version of the problem; it differs from the hard version only by the question. The easy version only needs you to print whether some values are non-zero or not. The hard version needs you to print the exact values.Alice and Bob are dividing the field. The field is a rectangle of size n\xc3\x97m (2\xe2\x89\xa4n,m\xe2\x89\xa4109), the rows are numbered from 1 to n from top to bottom, and the columns are numbered from 1 to m from left to right. The cell at the intersection of row r and column c is denoted as (r,c).Bob has k (2\xe2\x89\xa4k\xe2\x89\xa42\xe2\x8b\x85105) fountains, all of them are located in different cells of the field. Alice is responsible for dividing the field, but she must meet several conditions:  To divide the field, Alice will start her path in any free (without a fountain) cell on the left or top side of the field and will move, each time moving to the adjacent cell down or right. Her path will end on the right or bottom side of the field.  Alice\'s path will divide the field into two parts \xe2\x80\x94 one part will belong to Alice (this part includes the cells of her path), the other part \xe2\x80\x94 to Bob.  Alice will own the part that includes the cell (n,1).  Bob will own the part that includes the cell (1,m). Alice wants to divide the field in such a way as to get as many cells as possible.Bob wants to keep ownership of all the fountains, but he can give one of them to Alice. First, output the integer \xce\xb1 \xe2\x80\x94 the maximum possible size of Alice\'s plot, if Bob does not give her any fountain (i.e., all fountains will remain on Bob\'s plot). Then output k non-negative integers a1,a2,\xe2\x80\xa6,ak, where:  ai=0, if after Bob gives Alice the i-th fountain, the maximum possible size of Alice\'s plot does not increase (i.e., remains equal to \xce\xb1);  ai=1, if after Bob gives Alice the i-th fountain, the maximum possible size of Alice\'s plot increases (i.e., becomes greater than \xce\xb1)." 1900
1980E "Permutation of Rows and Columns" "constructive algorithms,data structures,greedy,hashing,implementation,math,matrices,sortings" "You have been given a matrix a of size n by m, containing a permutation of integers from 1 to n\xe2\x8b\x85m.A permutation of n integers is an array containing all numbers from 1 to n exactly once. For example, the arrays [1], [2,1,3], [5,4,3,2,1] are permutations, while the arrays [1,1], [100], [1,2,4,5] are not.A matrix contains a permutation if, when all its elements are written out, the resulting array is a permutation. Matrices [[1,2],[3,4]], [[1]], [[1,5,3],[2,6,4]] contain permutations, while matrices [[2]], [[1,1],[2,2]], [[1,2],[100,200]] do not.You can perform one of the following two actions in one operation:  choose columns c and d (1\xe2\x89\xa4c,d\xe2\x89\xa4m, c\xe2\x89\xa0d) and swap these columns;  choose rows c and d (1\xe2\x89\xa4c,d\xe2\x89\xa4n, c\xe2\x89\xa0d) and swap these rows. You can perform any number of operations.You are given the original matrix a and the matrix b. Your task is to determine whether it is possible to transform matrix a into matrix b using the given operations." 1600
1980D GCD-sequence "greedy,implementation,math,number theory" "GCD (Greatest Common Divisor) of two integers x and y is the maximum integer z by which both x and y are divisible. For example, GCD(36,48)=12, GCD(5,10)=5, and GCD(7,11)=1.Kristina has an array a consisting of exactly n positive integers. She wants to count the GCD of each neighbouring pair of numbers to get a new array b, called GCD-sequence. So, the elements of the GCD-sequence b will be calculated using the formula bi=GCD(ai,ai+1) for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921.Determine whether it is possible to remove exactly one number from the array a so that the GCD sequence b is non-decreasing (i.e., bi\xe2\x89\xa4bi+1 is always true).For example, let Khristina had an array a = [20,6,12,3,48,36]. If she removes a4=3 from it and counts the GCD-sequence of b, she gets:  b1=GCD(20,6)=2  b2=GCD(6,12)=6  b3=GCD(12,48)=12  b4=GCD(48,36)=12  The resulting GCD sequence b = [2,6,12,12] is non-decreasing because b1\xe2\x89\xa4b2\xe2\x89\xa4b3\xe2\x89\xa4b4." 1400
1980C "Sofia and the Lost Operations" "constructive algorithms,greedy" "Sofia had an array of n integers a1,a2,\xe2\x80\xa6,an. One day she got bored with it, so she decided to sequentially apply m modification operations to it.Each modification operation is described by a pair of numbers \xe2\x9f\xa8cj,dj\xe2\x9f\xa9 and means that the element of the array with index cj should be assigned the value dj, i.e., perform the assignment acj=dj. After applying all modification operations sequentially, Sofia discarded the resulting array.Recently, you found an array of n integers b1,b2,\xe2\x80\xa6,bn. You are interested in whether this array is Sofia\'s array. You know the values of the original array, as well as the values d1,d2,\xe2\x80\xa6,dm. The values c1,c2,\xe2\x80\xa6,cm turned out to be lost.Is there a sequence c1,c2,\xe2\x80\xa6,cm such that the sequential application of modification operations \xe2\x9f\xa8c1,d1,\xe2\x9f\xa9,\xe2\x9f\xa8c2,d2,\xe2\x9f\xa9,\xe2\x80\xa6,\xe2\x9f\xa8cm,dm\xe2\x9f\xa9 to the array a1,a2,\xe2\x80\xa6,an transforms it into the array b1,b2,\xe2\x80\xa6,bn?" 1300
1980B "Choosing Cubes" sortings,sortings "Dmitry has n cubes, numbered from left to right from 1 to n. The cube with index f is his favorite.Dmitry threw all the cubes on the table, and the i-th cube showed the value ai (1\xe2\x89\xa4ai\xe2\x89\xa4100). After that, he arranged the cubes in non-increasing order of their values, from largest to smallest. If two cubes show the same value, they can go in any order.After sorting, Dmitry removed the first k cubes. Then he became interested in whether he removed his favorite cube (note that its position could have changed after sorting).For example, if n=5, f=2, a=[4,3,3,2,3] (the favorite cube is highlighted in green), and k=2, the following could have happened:  After sorting a=[4,3,3,3,2], since the favorite cube ended up in the second position, it will be removed.  After sorting a=[4,3,3,3,2], since the favorite cube ended up in the third position, it will not be removed." 800
1980A "Problem Generator" math "Vlad is planning to hold m rounds next month. Each round should contain one problem of difficulty levels \'A\', \'B\', \'C\', \'D\', \'E\', \'F\', and \'G\'.Vlad already has a bank of n problems, where the i-th problem has a difficulty level of ai. There may not be enough of these problems, so he may have to come up with a few more problems.Vlad wants to come up with as few problems as possible, so he asks you to find the minimum number of problems he needs to come up with in order to hold m rounds.For example, if m=1, n=10, a= \'BGECDCBDED\', then he needs to come up with two problems: one of difficulty level \'A\' and one of difficulty level \'F\'." 800
1979F "Kostyanych\'s Theorem" "brute force,constructive algorithms,graphs,interactive" "This is an interactive problem.Kostyanych has chosen a complete undirected graph\xe2\x80\xa0 with n vertices, and then removed exactly (n\xe2\x88\x922) edges from it. You can ask queries of the following type:  ""? d"" \xe2\x80\x94 Kostyanych tells you the number of vertex v with a degree at least d. Among all possible such vertices, he selects the vertex with the minimum degree, and if there are several such vertices, he selects the one with the minimum number. He also tells you the number of another vertex in the graph, with which v is not connected by an edge (if none is found, then 0 is reported). Among all possible such vertices, he selects the one with the minimum number. Then he removes the vertex v and all edges coming out of it. If the required vertex v is not found, then ""0 0"" is reported. Find a Hamiltonian path\xe2\x80\xa1 in the original graph in at most n queries. It can be proven that under these constraints, a Hamiltonian path always exists.\xe2\x80\xa0A complete undirected graph is a graph in which there is exactly one undirected edge between any pair of distinct vertices. Thus, a complete undirected graph with n vertices contains n(n\xe2\x88\x921)2 edges.\xe2\x80\xa1A Hamiltonian path in a graph is a path that passes through each vertex exactly once." 2900
1979E "Manhattan Triangle" "binary search,constructive algorithms,data structures,geometry,implementation,two pointers" "The Manhattan distance between two points (x1,y1) and (x2,y2) is defined as: |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|.We call a Manhattan triangle three points on the plane, the Manhattan distances between each pair of which are equal.You are given a set of pairwise distinct points and an even integer d. Your task is to find any Manhattan triangle, composed of three distinct points from the given set, where the Manhattan distance between any pair of vertices is equal to d." 2400
1979D "Fixing a Binary String" "bitmasks,brute force,constructive algorithms,dp,greedy,hashing,strings" "You are given a binary string s of length n, consisting of zeros and ones. You can perform the following operation exactly once:  Choose an integer p (1\xe2\x89\xa4p\xe2\x89\xa4n).  Reverse the substring s1s2\xe2\x80\xa6sp. After this step, the string s1s2\xe2\x80\xa6sn will become spsp\xe2\x88\x921\xe2\x80\xa6s1sp+1sp+2\xe2\x80\xa6sn.  Then, perform a cyclic shift of the string s to the left p times. After this step, the initial string s1s2\xe2\x80\xa6sn will become sp+1sp+2\xe2\x80\xa6snspsp\xe2\x88\x921\xe2\x80\xa6s1. For example, if you apply the operation to the string 110001100110 with p=3, after the second step, the string will become 011001100110, and after the third step, it will become 001100110011.A string s is called k-proper if two conditions are met:  s1=s2=\xe2\x80\xa6=sk;  si+k\xe2\x89\xa0si for any i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k). For example, with k=3, the strings 000, 111000111, and 111000 are k-proper, while the strings 000000, 001100, and 1110000 are not.You are given an integer k, which is a divisor of n. Find an integer p (1\xe2\x89\xa4p\xe2\x89\xa4n) such that after performing the operation, the string s becomes k-proper, or determine that it is impossible. Note that if the string is initially k-proper, you still need to apply exactly one operation to it." 1800
1979C "Earning on Bets" "binary search,combinatorics,constructive algorithms,number theory" "You have been offered to play a game. In this game, there are n possible outcomes, and for each of them, you must bet a certain integer amount of coins. In the event that the i-th outcome turns out to be winning, you will receive back the amount of coins equal to your bet on that outcome, multiplied by ki. Note that exactly one of the n outcomes will be winning.Your task is to determine how to distribute the coins in such a way that you will come out ahead in the event of any winning outcome. More formally, the total amount of coins you bet on all outcomes must be strictly less than the number of coins received back for each possible winning outcome." 1200
1979B "XOR Sequences" bitmasks,greedy "You are given two distinct non-negative integers x and y. Consider two infinite sequences a1,a2,a3,\xe2\x80\xa6 and b1,b2,b3,\xe2\x80\xa6, where  an=n\xe2\x8a\x95x;  bn=n\xe2\x8a\x95y. Here, x\xe2\x8a\x95y denotes the bitwise XOR operation of integers x and y.For example, with x=6, the first 8 elements of sequence a will look as follows: [7,4,5,2,3,0,1,14,\xe2\x80\xa6]. Note that the indices of elements start with 1.Your task is to find the length of the longest common subsegment\xe2\x80\xa0 of sequences a and b. In other words, find the maximum integer m such that ai=bj,ai+1=bj+1,\xe2\x80\xa6,ai+m\xe2\x88\x921=bj+m\xe2\x88\x921 for some i,j\xe2\x89\xa51.\xe2\x80\xa0A subsegment of sequence p is a sequence pl,pl+1,\xe2\x80\xa6,pr, where 1\xe2\x89\xa4l\xe2\x89\xa4r." 1000
1979A "Guess the Maximum" "brute force,greedy,implementation" "Alice and Bob came up with a rather strange game. They have an array of integers a1,a2,\xe2\x80\xa6,an. Alice chooses a certain integer k and tells it to Bob, then the following happens:  Bob chooses two integers i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n), and then finds the maximum among the integers ai,ai+1,\xe2\x80\xa6,aj;  If the obtained maximum is strictly greater than k, Alice wins, otherwise Bob wins. Help Alice find the maximum k at which she is guaranteed to win." 800
1978F "Large Graph" "data structures,dfs and similar,dsu,graphs,number theory,two pointers" "Given an array a of length n. Let\'s construct a square matrix b of size n\xc3\x97n, in which the i-th row contains the array a cyclically shifted to the right by (i\xe2\x88\x921). For example, for the array a=[3,4,5], the obtained matrix isb=[345534453]Let\'s construct the following graph:  The graph contains n2 vertices, each of which corresponds to one of the elements of the matrix. Let\'s denote the vertex corresponding to the element bi,j as (i,j). We will draw an edge between vertices (i1,j1) and (i2,j2) if |i1\xe2\x88\x92i2|+|j1\xe2\x88\x92j2|\xe2\x89\xa4k and gcd(bi1,j1,bi2,j2)>1, where gcd(x,y) denotes the greatest common divisor of integers x and y. Your task is to calculate the number of connected components\xe2\x80\xa0 in the obtained graph.\xe2\x80\xa0A connected component of a graph is a set of vertices in which any vertex is reachable from any other via edges, and adding any other vertex to the set violates this rule." 2400
1978E "Computing Machine" "brute force,data structures,dp,greedy,implementation" "Sasha has two binary strings s and t of the same length n, consisting of the characters 0 and 1.There is also a computing machine that can perform two types of operations on binary strings a and b of the same length k:  If ai=ai+2= 0, then you can assign bi+1:= 1 (1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x922).  If bi=bi+2= 1, then you can assign ai+1:= 1 (1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x922). Sasha became interested in the following: if we consider the string a=slsl+1\xe2\x80\xa6sr and the string b=tltl+1\xe2\x80\xa6tr, what is the maximum number of 1 characters in the string a that can be obtained using the computing machine. Since Sasha is very curious but lazy, it is up to you to answer this question for several pairs (li,ri) that interest him." 2000
1978D Elections "data structures,greedy,implementation,math" "Elections are taking place in Berland. There are n candidates participating in the elections, numbered from 1 to n. The i-th candidate has ai fans who will vote for him. Additionally, there are c people who are undecided about their favorite candidate, let\'s call them undecided. Undecided people will vote for the candidate with the lowest number.The candidate who receives the maximum number of votes wins the elections, and if multiple candidates receive the same maximum number of votes, the candidate with the lowest number among them wins.You found these elections too boring and predictable, so you decided to exclude some candidates from them. If you do not allow candidate number i to participate in the elections, all ai of his fans will become undecided, and will vote for the candidate with the lowest number.You are curious to find, for each i from 1 to n, the minimum number of candidates that need to be excluded from the elections for candidate number i to win the elections." 1600
1978C "Manhattan Permutations" "constructive algorithms,data structures,greedy,implementation,math" "Let\'s call the Manhattan value of a permutation\xe2\x80\xa0 p the value of the expression |p1\xe2\x88\x921|+|p2\xe2\x88\x922|+\xe2\x80\xa6+|pn\xe2\x88\x92n|.For example, for the permutation [1,2,3], the Manhattan value is |1\xe2\x88\x921|+|2\xe2\x88\x922|+|3\xe2\x88\x923|=0, and for the permutation [3,1,2], the Manhattan value is |3\xe2\x88\x921|+|1\xe2\x88\x922|+|2\xe2\x88\x923|=2+1+1=4.You are given integers n and k. Find a permutation p of length n such that its Manhattan value is equal to k, or determine that no such permutation exists.\xe2\x80\xa0A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1300
1978B "New Bakery" "binary search,greedy,math,ternary search" "Bob decided to open a bakery. On the opening day, he baked n buns that he can sell. The usual price of a bun is a coins, but to attract customers, Bob organized the following promotion: Bob chooses some integer k (0\xe2\x89\xa4k\xe2\x89\xa4min(n,b)). Bob sells the first k buns at a modified price. In this case, the price of the i-th (1\xe2\x89\xa4i\xe2\x89\xa4k) sold bun is (b\xe2\x88\x92i+1) coins. The remaining (n\xe2\x88\x92k) buns are sold at a coins each.Note that k can be equal to 0. In this case, Bob will sell all the buns at a coins each.Help Bob determine the maximum profit he can obtain by selling all n buns." 800
1978A "Alice and Books" "constructive algorithms,greedy,sortings" "Alice has n books. The 1-st book contains a1 pages, the 2-nd book contains a2 pages, \xe2\x80\xa6, the n-th book contains an pages. Alice does the following: She divides all the books into two non-empty piles. Thus, each book ends up in exactly one of the two piles. Alice reads one book with the highest number in each pile.Alice loves reading very much. Help her find the maximum total number of pages she can read by dividing the books into two piles." 800
1977E Tensor "constructive algorithms,graphs,interactive" "This is an interactive problem.You are given an integer n.The jury has hidden from you a directed graph with n vertices (numbered from 1 to n) and some number of edges. You additionally know that:   The graph only contains edges of the form i\xe2\x86\x90j, where 1\xe2\x89\xa4i<j\xe2\x89\xa4n.  For any three vertices 1\xe2\x89\xa4i<j<k\xe2\x89\xa4n, at least one of the following holds\xe2\x80\xa0:   Vertex i is reachable from vertex j, or  Vertex i is reachable from vertex k, or  Vertex j is reachable from vertex k.  You want to color each vertex in either black or white such that for any two vertices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) of the same color, vertex i is reachable from vertex j.To do that, you can ask queries of the following type:   ?  i  j \xe2\x80\x94 is vertex i reachable from vertex j (1\xe2\x89\xa4i<j\xe2\x89\xa4n)? Find any valid vertex coloring of the hidden graph in at most 2\xe2\x8b\x85n queries. It can be proven that such a coloring always exists.Note that the grader is not adaptive: the graph is fixed before any queries are made.\xe2\x80\xa0 Vertex a is reachable from vertex b if there exists a path from vertex b to vertex a in the graph." 2600
1977D XORificator "bitmasks,brute force,greedy,hashing" "You are given a binary (consisting only of 0s and 1s) n\xc3\x97m matrix. You are also given a XORificator, using which you can invert all the values in a chosen row (i.e. replace 0 with 1 and 1 with 0).A column in the matrix is considered special if it contains exactly one 1. Your task is to find the maximum number of columns that can be made special at the same time, and the set of rows the XORificator should be used on to achieve that." 2300
1977C "Nikita and LCM" "brute force,data structures,dp,greedy,math,number theory,sortings" "Nikita is a student passionate about number theory and algorithms. He faces an interesting problem related to an array of numbers.Suppose Nikita has an array of integers a of length n. He will call a subsequence\xe2\x80\xa0 of the array special if its least common multiple (LCM) is not contained in a. The LCM of an empty subsequence is equal to 0.Nikita wonders: what is the length of the longest special subsequence of a? Help him answer this question!\xe2\x80\xa0 A sequence b is a subsequence of a if b can be obtained from a by the deletion of several (possibly, zero or all) elements, without changing the order of the remaining elements. For example, [5,2,3] is a subsequence of [1,5,7,8,2,4,3]." 1900
1977B "Binary Colouring" "bitmasks,constructive algorithms,greedy,math" "You are given a positive integer x. Find any array of integers a0,a1,\xe2\x80\xa6,an\xe2\x88\x921 for which the following holds:   1\xe2\x89\xa4n\xe2\x89\xa432,  ai is 1, 0, or \xe2\x88\x921 for all 0\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921,  x=n\xe2\x88\x921\xe2\x88\x91i=0ai\xe2\x8b\x852i,  There does not exist an index 0\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922 such that both ai\xe2\x89\xa00 and ai+1\xe2\x89\xa00. It can be proven that under the constraints of the problem, a valid array always exists." 1100
1977A "Little Nikita" math "The little boy Nikita was given some cubes as a present. He decided to build a tower out of them.Initially, the tower doesn\'t have any cubes. In one move, Nikita either puts exactly 1 cube on top of the tower or removes exactly 1 cube from the top of the tower. Is it possible that after n moves, the resulting tower has exactly m cubes?" 800
1976F "Remove Bridges" "data structures,dfs and similar,dp,greedy,sortings,trees" "You are given a rooted tree, consisting of n vertices, numbered from 1 to n. Vertex 1 is the root. Additionally, the root only has one child.You are asked to add exactly k edges to the tree (possibly, multiple edges and/or edges already existing in the tree).Recall that a bridge is such an edge that, after you remove it, the number of connected components in the graph increases. So, initially, all edges of the tree are bridges.After k edges are added, some original edges of the tree are still bridges and some are not anymore. You want to satisfy two conditions:   for every bridge, all tree edges in the subtree of the lower vertex of that bridge should also be bridges;  the number of bridges is as small as possible. Solve the task for all values of k from 1 to n\xe2\x88\x921 and output the smallest number of bridges." 2800
1976E "Splittable Permutations" "combinatorics,data structures,dfs and similar,greedy,math,trees" "Initially, we had one array, which was a permutation of size n (an array of size n where each integer from 1 to n appears exactly once).We performed q operations. During the i-th operation, we did the following:  choose any array we have with at least 2 elements;  split it into two non-empty arrays (prefix and suffix);  write two integers li and ri, where li is the maximum element in the left part which we get after the split, and ri is the maximum element in the right part;  remove the array we\'ve chosen from the pool of arrays we can use, and add the two resulting parts into the pool. For example, suppose the initial array was [6,3,4,1,2,5], and we performed the following operations:  choose the array [6,3,4,1,2,5] and split it into [6,3] and [4,1,2,5]. Then we write l1=6 and r1=5, and the arrays we have are [6,3] and [4,1,2,5];  choose the array [4,1,2,5] and split it into [4,1,2] and [5]. Then we write l2=4 and r2=5, and the arrays we have are [6,3], [4,1,2] and [5];  choose the array [4,1,2] and split it into [4] and [1,2]. Then we write l3=4 and r3=2, and the arrays we have are [6,3], [4], [1,2] and [5]. You are given two integers n and q, and two sequences [l1,l2,\xe2\x80\xa6,lq] and [r1,r2,\xe2\x80\xa6,rq]. A permutation of size n is called valid if we can perform q operations and produce the given sequences [l1,l2,\xe2\x80\xa6,lq] and [r1,r2,\xe2\x80\xa6,rq].Calculate the number of valid permutations." 2500
1976D "Invertible Bracket Sequences" "binary search,combinatorics,data structures,divide and conquer,implementation,two pointers" "A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters \'1\' and \'+\' between the original characters of the sequence. For example:  bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)"");  bracket sequences "")("", ""("" and "")"" are not. Let\'s define the inverse of the bracket sequence as follows: replace all brackets \'(\' with \')\', and vice versa (all brackets \')\' with \'(\'). For example, strings ""()(("" and "")())"" are inverses of each other.You are given a regular bracket sequence s. Calculate the number of pairs of integers (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|s|) such that if you replace the substring of s from the l-th character to the r-th character (inclusive) with its inverse, s will still be a regular bracket sequence." 2000
1976C "Job Interview" "binary search,dp,greedy,implementation,two pointers" "Monocarp is opening his own IT company. He wants to hire n programmers and m testers. There are n+m+1 candidates, numbered from 1 to n+m+1 in chronological order of their arriving time. The i-th candidate has programming skill ai and testing skill bi (a person\'s programming skill is different from their testing skill). The skill of the team is the sum of the programming skills of all candidates hired as programmers, and the sum of the testing skills of all candidates hired as testers.When a candidate arrives to interview, Monocarp tries to assign them to the most suitable position for them (if their programming skill is higher, then he hires them as a programmer, otherwise as a tester). If all slots for that position are filled, Monocarp assigns them to the other position.Your task is, for each candidate, calculate the skill of the team if everyone except them comes to interview. Note that it means that exactly n+m candidates will arrive, so all n+m positions in the company will be filled." 1600
1976B Increase/Decrease/Copy greedy,implementation "You are given two integer arrays: array a of length n and array b of length n+1.You can perform the following operations any number of times in any order:   choose any element of the array a and increase it by 1;  choose any element of the array a and decrease it by 1;  choose any element of the array a, copy it and append the copy to the end of the array a. Your task is to calculate the minimum number of aforementioned operations (possibly zero) required to transform the array a into the array b. It can be shown that under the constraints of the problem, it is always possible." 1100
1976A "Verify Password" implementation,sortings,strings "Monocarp is working on his new site, and the current challenge is to make the users pick strong passwords.Monocarp decided that strong passwords should satisfy the following conditions:   password should consist only of lowercase Latin letters and digits;  there should be no digit that comes after a letter (so, after each letter, there is either another letter or the string ends);  all digits should be sorted in the non-decreasing order;  all letters should be sorted in the non-decreasing order. Note that it\'s allowed for the password to have only letters or only digits.Monocarp managed to implement the first condition, but he struggles with the remaining ones. Can you help him to verify the passwords?" 800
1975I "Mind Bloom" dp "This is the way it always was. This is the way it always will be. All will be forgotten again soon...Jellyfish is playing a one-player card game called ""Slay the Spire"". There are n cards in total numbered from 1 to n. The i-th card has power ci.There is a binary string s of length n. If si=0, the i-th card is initially in the draw pile. If si=1, the i-th card is initially in Jellyfish\'s hand.Jellyfish will repeat the following process until either her hand or the draw pile is empty.   Let x be the power of the card with the largest power in her hand.  Place a single card with power x back into the draw pile.  Randomly draw x cards from the draw pile. All subsets of x cards from the draw pile have an equal chance of being drawn. If there are fewer than x cards in the draw pile, Jellyfish will draw all cards. At the end of this process, find the probability that Jellyfish can empty the draw pile, modulo 1000000007.Formally, let M=1000000007. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 3500
1975H "378QAQ and Core" greedy,strings "378QAQ has a string s of length n. Define the core of a string as the substring\xe2\x80\xa0 with maximum lexicographic\xe2\x80\xa1 order.For example, the core of ""bazoka"" is ""zoka"", and the core of ""aaa"" is ""aaa"".378QAQ wants to rearrange the string s so that the core is lexicographically minimum. Find the lexicographically minimum possible core over all rearrangements of s.\xe2\x80\xa0 A substring of string s is a continuous segment of letters from s. For example, ""defor"", ""code"" and ""o"" are all substrings of ""codeforces"" while ""codes"" and ""aaa"" are not.\xe2\x80\xa1 A string p is lexicographically smaller than a string q if and only if one of the following holds:   p is a prefix of q, but p\xe2\x89\xa0q; or  in the first position where p and q differ, the string p has a smaller element than the corresponding element in q (when compared by their ASCII code). For example, ""code"" and ""coda"" are both lexicographically smaller than ""codeforces"" while ""codeforceston"" and ""z"" are not." 3500
1975G "Zimpha Fan Club" fft,greedy,math,strings "One day, Zimpha casually came up with a problem. As a member of ""Zimpha fan club"", you decided to solve that problem.You are given two strings s and t of length n and m, respectively. Both strings only consist of lowercase English letters, - and *.You need to replace all occurrences of * and -, observing the following rules:  For each -, you must replace it with any lowercase English letter.  For each *, you must replace it with a string of any (possibly, zero) length which only consists of lowercase English letters. Note that you can replace two different instances of - with different characters. You can also replace each two different instances of * with different strings.Suppose s and t have been transformed into s\xe2\x80\xb2 and t\xe2\x80\xb2. Now you\'re wondering if there\'s a replacement that makes s\xe2\x80\xb2=t\xe2\x80\xb2." 3000
1975F Set "bitmasks,brute force,combinatorics,dfs and similar,divide and conquer,dp,math" "Define the binary encoding of a finite set of natural numbers T\xe2\x8a\x86{0,1,2,\xe2\x80\xa6} as f(T)=\xe2\x88\x91i\xe2\x88\x88T2i. For example, f({0,2})=20+22=5 and f({})=0. Notice that f is a bijection from all such sets to all non-negative integers. As such, f\xe2\x88\x921 is also defined.You are given an integer n along with 2n\xe2\x88\x921 sets V1,V2,\xe2\x80\xa6,V2n\xe2\x88\x921.Find all sets S that satisfy the following constraint:   S\xe2\x8a\x86{0,1,\xe2\x80\xa6,n\xe2\x88\x921}. Note that S can be empty.  For all non-empty subsets T\xe2\x8a\x86{0,1,\xe2\x80\xa6,n\xe2\x88\x921}, |S\xe2\x88\xa9T|\xe2\x88\x88Vf(T). Due to the large input and output, both input and output will be given in terms of binary encodings of the sets." 2600
1975E "Chain Queries" "binary search,data structures,dfs and similar,implementation,trees" "You are given a tree of n vertices numbered from 1 to n. Initially, all vertices are colored white or black.You are asked to perform q queries:  ""u"" \xe2\x80\x94 toggle the color of vertex u (if it was white, change it to black and vice versa). After each query, you should answer whether all the black vertices form a chain. That is, there exist two black vertices such that the simple path between them passes through all the black vertices and only the black vertices. Specifically, if there is only one black vertex, they form a chain. If there are no black vertices, they do not form a chain." 2100
1975D "Paint the Tree" "brute force,dfs and similar,dp,greedy,shortest paths,trees" "378QAQ has a tree with n vertices. Initially, all vertices are white. There are two chess pieces called PA and PB on the tree. PA and PB are initially located on vertices a and b respectively. In one step, 378QAQ will do the following in order:  Move PA to a neighboring vertex. If the target vertex is white, this vertex will be painted red.  Move PB to a neighboring vertex. If the target vertex is colored in red, this vertex will be painted blue. Initially, the vertex a is painted red. If a=b, the vertex a is painted blue instead. Note that both the chess pieces must be moved in each step. Two pieces can be on the same vertex at any given time.378QAQ wants to know the minimum number of steps to paint all vertices blue." 1700
1975C "Chamo and Mocha\'s Array" "binary search,brute force,greedy" "Mocha likes arrays, so before her departure, Chamo gave her an array a consisting of n positive integers as a gift.Mocha doesn\'t like arrays containing different numbers, so Mocha decides to use magic to change the array. Mocha can perform the following three-step operation some (possibly, zero) times:   Choose indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n)  Let x be the median\xe2\x80\xa0 of the subarray [al,al+1,\xe2\x80\xa6,ar]  Set all values al,al+1,\xe2\x80\xa6,ar to x Suppose a=[1,2,3,4,5] initially:   If Mocha chooses (l,r)=(3,4) in the first operation, then x=3, the array will be changed into a=[1,2,3,3,5].  If Mocha chooses (l,r)=(1,3) in the first operation, then x=2, the array will be changed into a=[2,2,2,4,5]. Mocha will perform the operation until the array contains only the same number. Mocha wants to know what is the maximum possible value of this number.\xe2\x80\xa0 The median in an array b of length m is an element that occupies position number \xe2\x8c\x8am+12\xe2\x8c\x8b after we sort the elements in non-decreasing order. For example, the median of [3,1,4,1,5] is 3 and the median of [5,25,20,24] is 20." 1200
1975B "378QAQ and Mocha\'s Array" "brute force,greedy,math,sortings" "Mocha likes arrays, so before her departure, 378QAQ gave her an array a consisting of n positive integers as a gift.Mocha thinks that a is beautiful if there exist two numbers i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j) such that for all k (1\xe2\x89\xa4k\xe2\x89\xa4n), ak is divisible\xe2\x80\xa0 by either ai or aj.Determine whether a is beautiful.\xe2\x80\xa0 x is divisible by y if there exists an integer z such that x=y\xe2\x8b\x85z." 1000
1975A "Bazoka and Mocha\'s Array" "brute force,greedy,implementation,sortings" "Mocha likes arrays, so before her departure, Bazoka gave her an array a consisting of n positive integers as a gift.Now Mocha wants to know whether array a could become sorted in non-decreasing order after performing the following operation some (possibly, zero) times:  Split the array into two parts \xe2\x80\x94 a prefix and a suffix, then swap these two parts. In other words, let a=x+y. Then, we can set a:=y+x. Here + denotes the array concatenation operation. For example, if a=[3,1,4,1,5], we can choose x=[3,1] and y=[4,1,5], satisfying a=x+y. Then, we can set a:=y+x=[4,1,5,3,1]. We can also choose x=[3,1,4,1,5] and y=[], satisfying a=x+y. Then, we can set a:=y+x=[3,1,4,1,5]. Note that we are not allowed to choose x=[3,1,1] and y=[4,5], neither are we allowed to choose x=[1,3] and y=[5,1,4], as both these choices do not satisfy a=x+y." 800
1974G "Money Buys Less Happiness Now" "data structures,greedy,sortings" "You can never buy enough happiness, so here we go again! In this version, you can only buy hi=1 unit of happiness each month, but the number of months is hugely increased. We are in the realm of quantum happiness and time dilation.Being a physicist, Charlie likes to plan his life in simple and precise terms. For the next m months, starting with no money, Charlie will work hard and earn x pounds per month. For the i-th month (1\xe2\x89\xa4i\xe2\x89\xa4m), there\'ll be a single opportunity of paying cost ci pounds to obtain one unit of happiness. You cannot buy more than one unit each month.Borrowing is not allowed. Money earned in the i-th month can only be spent in a later j-th month (j>i).Since physicists don\'t code, help Charlie find the maximum reachable units of happiness." 2000
1974F "Cutting Game" "binary search,brute force,data structures,implementation,sortings,two pointers" "Alice and Bob were playing a game again. They have a grid of size a\xc3\x97b (1\xe2\x89\xa4a,b\xe2\x89\xa4109), on which there are n chips, with at most one chip in each cell. The cell at the intersection of the x-th row and the y-th column has coordinates (x,y).Alice made the first move, and the players took turns. On each move, a player could cut several (but not all) rows or columns from the beginning or end of the remaining grid and earn a point for each chip that was on the cut part of the grid. Each move can be described by the character \'U\', \'D\', \'L\', or \'R\' and an integer k:  If the character is \'U\', then the first k remaining rows will be cut;  If the character is \'D\', then the last k remaining rows will be cut;  If the character is \'L\', then the first k remaining columns will be cut;  If the character is \'R\', then the last k remaining columns will be cut. Based on the initial state of the grid and the players\' moves, determine the number of points earned by Alice and Bob, respectively." 1900
1974E "Money Buys Happiness" dp "Being a physicist, Charlie likes to plan his life in simple and precise terms. For the next m months, starting with no money, Charlie will work hard and earn x pounds per month. For the i-th month (1\xe2\x89\xa4i\xe2\x89\xa4m), there\'ll be a single opportunity of paying cost ci pounds to obtain happiness hi.Borrowing is not allowed. Money earned in the i-th month can only be spent in a later j-th month (j>i).Since physicists don\'t code, help Charlie find the maximum obtainable sum of happiness." 1800
1974D Ingenuity-2 "constructive algorithms,greedy,implementation" "Let\'s imagine the surface of Mars as an infinite coordinate plane. Initially, the rover Perseverance-2 and the helicopter Ingenuity-2 are located at the point with coordinates (0,0). A set of instructions s consisting of n instructions of the following types was specially developed for them:  N: move one meter north (from point (x,y) to (x,y+1));  S: move one meter south (from point (x,y) to (x,y\xe2\x88\x921));  E: move one meter east (from point (x,y) to (x+1,y));  W: move one meter west (from point (x,y) to (x\xe2\x88\x921,y)). Each instruction must be executed either by the rover or by the helicopter. Moreover, each device must execute at least one instruction. Your task is to distribute the instructions in such a way that after executing all n instructions, the helicopter and the rover end up at the same point, or determine that this is impossible." 1400
1974C "Beautiful Triple Pairs" "combinatorics,data structures" "Polycarp was given an array a of n integers. He really likes triples of numbers, so for each j (1\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x922) he wrote down a triple of elements [aj,aj+1,aj+2].Polycarp considers a pair of triples b and c beautiful if they differ in exactly one position, that is, one of the following conditions is satisfied:  b1\xe2\x89\xa0c1 and b2=c2 and b3=c3;  b1=c1 and b2\xe2\x89\xa0c2 and b3=c3;  b1=c1 and b2=c2 and b3\xe2\x89\xa0c3. Find the number of beautiful pairs of triples among the written triples [aj,aj+1,aj+2]." 1400
1974B "Symmetric Encoding" implementation,sortings,strings "Polycarp has a string s, which consists of lowercase Latin letters. He encodes this string using the following algorithm:  first, he constructs a new auxiliary string r, which consists of all distinct letters of the string s, written in alphabetical order;  then the encoding happens as follows: each character in the string s is replaced by its symmetric character from the string r (the first character of the string r will be replaced by the last, the second by the second from the end, and so on). For example, encoding the string s=""codeforces"" happens as follows:  the string r is obtained as ""cdefors"";  the first character s1=\'c\' is replaced by \'s\';  the second character s2=\'o\' is replaced by \'e\';  the third character s3=\'d\' is replaced by \'r\';  ...  the last character s10=\'s\' is replaced by \'c\'.   The string r and replacements for s=""codeforces"". Thus, the result of encoding the string s=""codeforces"" is the string ""serofedsoc"".Write a program that performs decoding \xe2\x80\x94 that is, restores the original string s from the encoding result." 800
1974A "Phone Desktop" greedy,math "Little Rosie has a phone with a desktop (or launcher, as it is also called). The desktop can consist of several screens. Each screen is represented as a grid of size 5\xc3\x973, i.e., five rows and three columns.There are x applications with an icon size of 1\xc3\x971 cells; such an icon occupies only one cell of the screen. There are also y applications with an icon size of 2\xc3\x972 cells; such an icon occupies a square of 4 cells on the screen. Each cell of each screen can be occupied by no more than one icon.Rosie wants to place the application icons on the minimum number of screens. Help her find the minimum number of screens needed." 800
1973F "Maximum GCD Sum Queries" "bitmasks,brute force,dp,implementation,number theory" "For k positive integers x1,x2,\xe2\x80\xa6,xk, the value gcd(x1,x2,\xe2\x80\xa6,xk) is the greatest common divisor of the integers x1,x2,\xe2\x80\xa6,xk \xe2\x80\x94 the largest integer z such that all the integers x1,x2,\xe2\x80\xa6,xk are divisible by z.You are given three arrays a1,a2,\xe2\x80\xa6,an, b1,b2,\xe2\x80\xa6,bn and c1,c2,\xe2\x80\xa6,cn of length n, containing positive integers. You also have a machine that allows you to swap ai and bi for any i (1\xe2\x89\xa4i\xe2\x89\xa4n). Each swap costs you ci coins.Find the maximum possible value of gcd(a1,a2,\xe2\x80\xa6,an)+gcd(b1,b2,\xe2\x80\xa6,bn) that you can get by paying in total at most d coins for swapping some elements. The amount of coins you have changes a lot, so find the answer to this question for each of the q possible values d1,d2,\xe2\x80\xa6,dq." 3100
1973E "Cat, Fox and Swaps" graphs,math,sortings "Fox has found an array p1,p2,\xe2\x80\xa6,pn, that is a permutation of length n\xe2\x80\xa0 of the numbers 1,2,\xe2\x80\xa6,n. She wants to sort the elements in increasing order. Cat wants to help her \xe2\x80\x94 he is able to swap any two numbers x and y in the array, but only if l\xe2\x89\xa4x+y\xe2\x89\xa4r (note that the constraint is imposed on the values of the elements, not their positions). He can make such swaps any number of times.They don\'t know the numbers l, r yet, they only know that it\'s true that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa42\xe2\x8b\x85n. You are given the number n and the array p1,p2,\xe2\x80\xa6,pn. Determine how many pairs (l,r) satisfying the conditions are there such that you can sort the permutation if you can only swap two number (x,y) such that l\xe2\x89\xa4x+y\xe2\x89\xa4r (arbitrary number of times, possibly 0).\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2500
1973D "Cat, Fox and Maximum Array Split" "brute force,interactive,math" "This is an interactive problem.Fox gave Cat two positive integers n and k. She has a hidden array a1,\xe2\x80\xa6,an of length n, such that 1\xe2\x89\xa4ai\xe2\x89\xa4n for every i. Now they are going to play the following game:For any two integers l,r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, define f(l,r)=(r\xe2\x88\x92l+1)\xe2\x8b\x85rmaxx=lax. In other words, f(l,r) is equal to the maximum of the subarray al,\xe2\x80\xa6,ar multiplied by its size.Cat can ask Fox at most 2n questions about the array. He will tell her two integers l and x (1\xe2\x89\xa4l\xe2\x89\xa4n,1\xe2\x89\xa4x\xe2\x89\xa4109), and she will tell him one integer p as the answer \xe2\x80\x94 the smallest positive integer r such that f(l,r)=x, or n+1 if no such r exists.Now, Cat needs to find the largest value m such that there exists a sequence c1,\xe2\x80\xa6,ck\xe2\x88\x921 such that 1\xe2\x89\xa4c1<\xe2\x80\xa6<ck\xe2\x88\x921<n and f(1,c1)=f(c1+1,c2)=\xe2\x80\xa6=f(ck\xe2\x88\x921+1,n)=m. If no such m exists, he should indicate this and take \xe2\x88\x921 as the answer. Note that for k=1, m is always equal to f(1,n).In other words, the goal is to find the largest m such that you can split the array into exactly k subarrays (k is the constant given to you in the beginning of the interaction) so that all the subarrays have the product of their length and their maximum equal to m, or determine that no such m exists. Every element should belong in exactly one of the subarrays.Cat doesn\'t know what he should do, so he asked you to play the game for him." 2400
1973C "Cat, Fox and Double Maximum" "constructive algorithms,greedy,implementation,math,sortings" "Fox loves permutations! She came up with the following problem and asked Cat to solve it:You are given an even positive integer n and a permutation\xe2\x80\xa0 p of length n. The score of another permutation q of length n is the number of local maximums in the array a of length n, where ai=pi+qi for all i (1\xe2\x89\xa4i\xe2\x89\xa4n). In other words, the score of q is the number of i such that 1<i<n (note the strict inequalities), ai\xe2\x88\x921<ai, and ai>ai+1 (once again, note the strict inequalities). Find the permutation q that achieves the maximum score for given n and p. If there exist multiple such permutations, you can pick any of them.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1700
1973B "Cat, Fox and the Lonely Array" "binary search,bitmasks,data structures,greedy,math,two pointers" "Today, Cat and Fox found an array a consisting of n non-negative integers. Define the loneliness of a as the smallest positive integer k (1\xe2\x89\xa4k\xe2\x89\xa4n) such that for any two positive integers i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n\xe2\x88\x92k+1), the following holds: ai|ai+1|\xe2\x80\xa6|ai+k\xe2\x88\x921=aj|aj+1|\xe2\x80\xa6|aj+k\xe2\x88\x921, where x|y denotes the bitwise OR of x and y. In other words, for every k consecutive elements, their bitwise OR should be the same. Note that the loneliness of a is well-defined, because for k=n the condition is satisfied.Cat and Fox want to know how lonely the array a is. Help them calculate the loneliness of the found array." 1300
1973A "Chess For Three" "brute force,dp,implementation,math" "Three friends gathered to play a few games of chess together.In every game, two of them play against each other. The winner gets 2 points while the loser gets 0, and in case of a draw, both players get 1 point each. Note that the same pair of players could have played any non-negative number of times (possibly zero). It is also possible that no games were played at all. You\'ve been told that their scores after all the games were played were p1, p2 and p3. Additionally, it is guaranteed that p1\xe2\x89\xa4p2\xe2\x89\xa4p3 holds.Find the maximum number of draws that could have happened and print it. If there isn\'t any way to obtain p1, p2 and p3 as a result of a non-negative number of games between the three players, print \xe2\x88\x921 instead." 900
1972B "Coin Games" games "There are n coins on the table forming a circle, and each coin is either facing up or facing down. Alice and Bob take turns to play the following game, and Alice goes first.In each operation, the player chooses a facing-up coin, removes the coin, and flips the two coins that are adjacent to it. If (before the operation) there are only two coins left, then one will be removed and the other won\'t be flipped (as it would be flipped twice). If (before the operation) there is only one coin left, no coins will be flipped. If (before the operation) there are no facing-up coins, the player loses.Decide who will win the game if they both play optimally. It can be proved that the game will end in a finite number of operations, and one of them will win." 900
1972A "Contest Proposal" "brute force,greedy,two pointers" "A contest contains n problems and the difficulty of the i-th problem is expected to be at most bi. There are already n problem proposals and the difficulty of the i-th problem is ai. Initially, both a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn are sorted in non-decreasing order.Some of the problems may be more difficult than expected, so the writers must propose more problems. When a new problem with difficulty w is proposed, the most difficult problem will be deleted from the contest, and the problems will be sorted in a way that the difficulties are non-decreasing.In other words, in each operation, you choose an integer w, insert it into the array a, sort array a in non-decreasing order, and remove the last element from it.Find the minimum number of new problems to make ai\xe2\x89\xa4bi for all i." 800
1971H \xc2\xb11 "2-sat,dfs and similar,graphs" "Bob has a grid with 3 rows and n columns, each of which contains either ai or \xe2\x88\x92ai for some integer 1\xe2\x89\xa4i\xe2\x89\xa4n. For example, one possible grid for n=4 is shown below:[a1\xe2\x88\x92a2\xe2\x88\x92a3\xe2\x88\x92a2\xe2\x88\x92a4a4\xe2\x88\x92a1\xe2\x88\x92a3a1a2\xe2\x88\x92a2a4]Alice and Bob play a game as follows:   Bob shows Alice his grid.  Alice gives Bob an array a1,a2,\xe2\x80\xa6,an of her choosing, whose elements are all \xe2\x88\x921 or 1.  Bob substitutes these values into his grid to make a grid of \xe2\x88\x921s and 1s.  Bob sorts the elements of each column in non-decreasing order.  Alice wins if all the elements in the middle row are 1; otherwise, Bob wins. For example, suppose Alice gives Bob the array [1,\xe2\x88\x921,\xe2\x88\x921,1] for the grid above. Then the following will happen (colors are added for clarity):[a1\xe2\x88\x92a2\xe2\x88\x92a3\xe2\x88\x92a2\xe2\x88\x92a4a4\xe2\x88\x92a1\xe2\x88\x92a3a1a2\xe2\x88\x92a2a4][1,\xe2\x88\x921,\xe2\x88\x921,1]\xe2\x86\x92[1111\xe2\x88\x9211\xe2\x88\x92111\xe2\x88\x92111]sort each column\xe2\x86\x92[\xe2\x88\x921\xe2\x88\x921\xe2\x88\x921111111111]. Since the middle row is all 1, Alice wins.Given Bob\'s grid, determine whether or not Alice can choose the array a to win the game." 2100
1971G XOUR "data structures,dsu,sortings" "You are given an array a consisting of n nonnegative integers. You can swap the elements at positions i and j if ai XOR aj<4, where XOR is the bitwise XOR operation.Find the lexicographically smallest array that can be made with any number of swaps.An array x is lexicographically smaller than an array y if in the first position where x and y differ, xi<yi." 1700
1971F "Circle Perimeter" "binary search,brute force,dfs and similar,geometry,implementation,math" "Given an integer r, find the number of lattice points that have a Euclidean distance from (0,0) greater than or equal to r but strictly less than r+1.A lattice point is a point with integer coordinates. The Euclidean distance from (0,0) to the point (x,y) is \xe2\x88\x9ax2+y2." 1600
1971E "Find the Car" "binary search,math,sortings" "Timur is in a car traveling on the number line from point 0 to point n. The car starts moving from point 0 at minute 0.There are k+1 signs on the line at points 0,a1,a2,\xe2\x80\xa6,ak, and Timur knows that the car will arrive there at minutes 0,b1,b2,\xe2\x80\xa6,bk, respectively. The sequences a and b are strictly increasing with ak=n.  Between any two adjacent signs, the car travels with a constant speed. Timur has q queries: each query will be an integer d, and Timur wants you to output how many minutes it takes the car to reach point d, rounded down to the nearest integer." 1500
1971D "Binary Cut" dp,greedy,implementation,sortings,strings "You are given a binary string\xe2\x80\xa0. Please find the minimum number of pieces you need to cut it into, so that the resulting pieces can be rearranged into a sorted binary string.  Note that:   each character must lie in exactly one of the pieces;  the pieces must be contiguous substrings of the original string;  you must use all the pieces in the rearrangement. \xe2\x80\xa0 A binary string is a string consisting of characters 0 and 1. A sorted binary string is a binary string such that all characters 0 come before all characters 1." 1100
1971C "Clock and Strings" implementation "There is a clock labeled with the numbers 1 through 12 in clockwise order, as shown below. In this example, (a,b,c,d)=(2,9,10,6), and the strings intersect. Alice and Bob have four distinct integers a, b, c, d not more than 12. Alice ties a red string connecting a and b, and Bob ties a blue string connecting c and d. Do the strings intersect? (The strings are straight line segments.)" 900
1971B "Different String" implementation,strings "You are given a string s consisting of lowercase English letters.Rearrange the characters of s to form a new string r that is not equal to s, or report that it\'s impossible." 800
1971A "My First Sorting Problem" implementation,sortings "You are given two integers x and y. Output two integers: the minimum of x and y, followed by the maximum of x and y." 800
1970G3 "Min-Fund Prison (Hard)" "bitmasks,dfs and similar,dp,graphs,trees" "In the hard version, 2\xe2\x89\xa4\xe2\x88\x91n\xe2\x89\xa4105 and 1\xe2\x89\xa4\xe2\x88\x91m\xe2\x89\xa45\xc3\x97105After a worker\'s strike organized by the Dementors asking for equal rights, the prison of Azkaban has suffered some damage. After settling the spirits, the Ministry of Magic is looking to renovate the prison to ensure that the Dementors are kept in check. The prison consists of n prison cells and m bi-directional corridors. The ith corridor is from cells ui to vi. A subset of these cells S is called a complex if any cell in S is reachable from any other cell in S. Formally, a subset of cells S is a complex if x and y are reachable from each other for all x,y\xe2\x88\x88S, using only cells from S on the way. The funding required for a complex S consisting of k cells is defined as k2.As part of your Intro to Magical Interior Design course at Hogwarts, you have been tasked with designing the prison. The Ministry of Magic has asked that you divide the prison into 2 complexes with exactly one corridor connecting them, so that the Dementors can\'t organize union meetings. For this purpose, you are allowed to build bi-directional corridors. The funding required to build a corridor between any 2 cells is c. Due to budget cuts and the ongoing fight against the Death Eaters, you must find the minimum total funding required to divide the prison as per the Ministry\'s requirements or \xe2\x88\x921 if no division is possible.Note: The total funding is the sum of the funding required for the 2 complexes and the corridors built. If after the division, the two complexes have x and y cells respectively and you have built a total of a corridors, the total funding will be x2+y2+c\xc3\x97a. Note that x+y=n." 2400
1970G2 "Min-Fund Prison (Medium)" "brute force,dfs and similar,dp,graphs,trees" "In the medium version, 2\xe2\x89\xa4\xe2\x88\x91n\xe2\x89\xa4300 and 1\xe2\x89\xa4\xe2\x88\x91m\xe2\x89\xa4300After a worker\'s strike organized by the Dementors asking for equal rights, the prison of Azkaban has suffered some damage. After settling the spirits, the Ministry of Magic is looking to renovate the prison to ensure that the Dementors are kept in check. The prison consists of n prison cells and m bi-directional corridors. The ith corridor is from cells ui to vi. A subset of these cells S is called a complex if any cell in S is reachable from any other cell in S. Formally, a subset of cells S is a complex if x and y are reachable from each other for all x,y\xe2\x88\x88S, using only cells from S on the way. The funding required for a complex S consisting of k cells is defined as k2.As part of your Intro to Magical Interior Design course at Hogwarts, you have been tasked with designing the prison. The Ministry of Magic has asked that you divide the prison into 2 complexes with exactly one corridor connecting them, so that the Dementors can\'t organize union meetings. For this purpose, you are allowed to build bi-directional corridors. The funding required to build a corridor between any 2 cells is c. Due to budget cuts and the ongoing fight against the Death Eaters, you must find the minimum total funding required to divide the prison as per the Ministry\'s requirements or \xe2\x88\x921 if no division is possible.Note: The total funding is the sum of the funding required for the 2 complexes and the corridors built. If after the division, the two complexes have x and y cells respectively and you have built a total of a corridors, the total funding will be x2+y2+c\xc3\x97a. Note that x+y=n." 2200
1970G1 "Min-Fund Prison (Easy)" "dfs and similar,trees" "In the easy version, m=n\xe2\x88\x921 and there exists a path between u and v for all u,v (1\xe2\x89\xa4u,v\xe2\x89\xa4n).After a worker\'s strike organized by the Dementors asking for equal rights, the prison of Azkaban has suffered some damage. After settling the spirits, the Ministry of Magic is looking to renovate the prison to ensure that the Dementors are kept in check. The prison consists of n prison cells and m bi-directional corridors. The ith corridor is from cells ui to vi. A subset of these cells S is called a complex if any cell in S is reachable from any other cell in S. Formally, a subset of cells S is a complex if x and y are reachable from each other for all x,y\xe2\x88\x88S, using only cells from S on the way. The funding required for a complex S consisting of k cells is defined as k2.As part of your Intro to Magical Interior Design course at Hogwarts, you have been tasked with designing the prison. The Ministry of Magic has asked that you divide the prison into 2 complexes with exactly one corridor connecting them, so that the Dementors can\'t organize union meetings. For this purpose, you are allowed to build bi-directional corridors. The funding required to build a corridor between any 2 cells is c. Due to budget cuts and the ongoing fight against the Death Eaters, you must find the minimum total funding required to divide the prison as per the Ministry\'s requirements or \xe2\x88\x921 if no division is possible.Note: The total funding is the sum of the funding required for the 2 complexes and the corridors built. If after the division, the two complexes have x and y cells respectively and you have built a total of a corridors, the total funding will be x2+y2+c\xc3\x97a. Note that x+y=n." 1900
1970F3 "Playing Quidditch (Hard)" implementation "This afternoon, you decided to enjoy the first days of Spring by taking a walk outside. As you come near the Quidditch field, you hear screams. Once again, there is a conflict about the score: the two teams are convinced that they won the game! To prevent this problem from happening one more time, you decide to get involved in the refereeing of the matches.Now, you will stay in the stadium to watch the game and count the score. At the end of the game, you will decide the winner.Today, two teams are competing: the red Gryffindor (R) and the blue Ravenclaw (B) team. Each team is composed of P players (1\xe2\x89\xa4P\xe2\x89\xa410).The field is a rectangle of N lines and M columns (3\xe2\x89\xa4N,M\xe2\x89\xa499, N and M are odd). All the positions are integers, and several entities are allowed to be at the same position in the field. At the beginning of the game, the field contains goals for the two teams (each team can own between one and five goals), the players, and exactly one Quaffle. In this version of the problem, one Bludger and a Golden Snitch can be present.A game is composed of T steps (0\xe2\x89\xa4T\xe2\x89\xa410000). At each step, one entity on the field (a player or a ball) performs one action. All entities can move. A player can also catch a ball or throw the Quaffle that it is carrying. To catch a ball, a player must be located on the same cell as it. The Quaffle does not perform any action while it is being carried; it only follows the movements of the player. If a player carrying the Quaffle decides to throw it, the Quaffle is simply put at the current position of the player. If a player is on the same cell as a Bludger (either after a movement from the player or the Bludger), the player is eliminated. If the player is eliminated while it is carrying the Quaffle, the Quaffle remains on the cell containing both the player and the Bludger after the move. It is guaranteed that this never occurs while the player is in a cell containing a goal.To win a point, a player must leave the Quaffle at a goal of the other team. When it does, the team of the player wins one point, and the Quaffle instantly moves to the middle of the field (the cell at the (M+1)/2-th column of the (N+1)/2-th line of the field, starting from 1). There is no goal in the middle of the field. If a player puts the ball in its own goal, the other team wins the point. If a player catches the Golden Snitch, their team wins 10 points and the game is over." 2300
1970F2 "Playing Quidditch (Medium)" implementation "This afternoon, you decided to enjoy the first days of Spring by taking a walk outside. As you come near the Quidditch field, you hear screams. Once again, there is a conflict about the score: the two teams are convinced that they won the game! To prevent this problem from happening one more time, you decide to get involved in the refereeing of the matches.Now, you will stay in the stadium to watch the game and count the score. At the end of the game, you will decide the winner.Today, two teams are competing: the red Gryffindor (R) and the blue Ravenclaw (B) team. Each team is composed of P players (1\xe2\x89\xa4P\xe2\x89\xa410).The field is a rectangle of N lines and M columns (3\xe2\x89\xa4N,M\xe2\x89\xa499, N and M are odd). All the positions are integers, and several entities are allowed to be at the same position in the field. At the beginning of the game, the field contains goals for the two teams (each team can own between one and five goals), the players, and exactly one Quaffle. In this version of the problem, one Bludger can be present. An other type of ball will be available in the harder version of the problem.A game is composed of T steps (0\xe2\x89\xa4T\xe2\x89\xa410000). At each step, one entity on the field (a player or a ball) performs one action. All entities can move. A player can also catch a ball or throw the Quaffle that it is carrying. To catch a ball, a player must be located on the same cell as it. The Quaffle does not perform any action while it is being carried; it only follows the movements of the player. If a player carrying the Quaffle decides to throw it, the Quaffle is simply put at the current position of the player. If a player is on the same cell as a Bludger (either after a movement from the player or the Bludger), the player is eliminated. If the player is eliminated while it is carrying the Quaffle, the Quaffle remains on the cell containing both the player and the Bludger after the move. It is guaranteed that this never occurs while the player is in a cell containing a goal.To win a point, a player must leave the Quaffle at a goal of the other team. When it does, the team of the player wins one point, and the Quaffle instantly moves to the middle of the field (the cell at the (M+1)/2-th column of the (N+1)/2-th line of the field, starting from 1). There is no goal in the middle of the field. If a player puts the ball in its own goal, the other team wins the point." 2300
1970F1 "Playing Quidditch (Easy)" implementation "This afternoon, you decided to enjoy the first days of Spring by taking a walk outside. As you come near the Quidditch field, you hear screams. Once again, there is a conflict about the score: the two teams are convinced that they won the game! To prevent this problem from happening one more time, you decide to get involved in the refereeing of the matches.Now, you will stay in the stadium to watch the game and count the score. At the end of the game, you will decide the winner.Today, two teams are competing: the red Gryffindor (R) and the blue Ravenclaw (B) team. Each team is composed of P players (1\xe2\x89\xa4P\xe2\x89\xa410).The field is a rectangle of N lines and M columns (3\xe2\x89\xa4N,M\xe2\x89\xa499, N and M are odd). All the positions are integers, and several entities are allowed to be at the same position in the field. At the beginning of the game, the field contains goals for the two teams (each team can own between one and five goals), the players, and exactly one Quaffle. Other types of balls will be available in the harder versions of the problem.A game is composed of T steps (0\xe2\x89\xa4T\xe2\x89\xa410000). At each step, one entity on the field (a player or a ball) performs one action. All entities can move. A player can also catch a ball or throw the Quaffle that it is carrying. To catch a ball, a player must be located on the same cell as it. The Quaffle does not perform any action while it is being carried; it only follows the movements of the player. If a player carrying the Quaffle decides to throw it, the Quaffle is simply put at the current position of the player.To win a point, a player must leave the Quaffle at a goal of the other team. When it does, the team of the player wins one point, and the Quaffle instantly moves to the middle of the field (the cell at the (M+1)/2-th column of the (N+1)/2-th line of the field, starting from 1). There is no goal in the middle of the field. If a player puts the ball in its own goal, the other team wins the point." 2300
1970E3 "Trails (Hard)" dp,matrices "Harry Potter is hiking in the Alps surrounding Lake Geneva. In this area there are m cabins, numbered 1 to m. Each cabin is connected, with one or more trails, to a central meeting point next to the lake. Each trail is either short or long. Cabin i is connected with si short trails and li long trails to the lake.Each day, Harry walks a trail from the cabin where he currently is to Lake Geneva, and then from there he walks a trail to any of the m cabins (including the one he started in). However, as he has to finish the hike in a day, at least one of the two trails has to be short.How many possible combinations of trails can Harry take if he starts in cabin 1 and walks for n days?Give the answer modulo 109+7." 2200
1970E2 "Trails (Medium)" dp,matrices "Harry Potter is hiking in the Alps surrounding Lake Geneva. In this area there are m cabins, numbered 1 to m. Each cabin is connected, with one or more trails, to a central meeting point next to the lake. Each trail is either short or long. Cabin i is connected with si short trails and li long trails to the lake.Each day, Harry walks a trail from the cabin where he currently is to Lake Geneva, and then from there he walks a trail to any of the m cabins (including the one he started in). However, as he has to finish the hike in a day, at least one of the two trails has to be short.How many possible combinations of trails can Harry take if he starts in cabin 1 and walks for n days?Give the answer modulo 109+7." 2000
1970E1 "Trails (Easy)" dp "Harry Potter is hiking in the Alps surrounding Lake Geneva. In this area there are m cabins, numbered 1 to m. Each cabin is connected, with one or more trails, to a central meeting point next to the lake. Each trail is either short or long. Cabin i is connected with si short trails and li long trails to the lake.Each day, Harry walks a trail from the cabin where he currently is to Lake Geneva, and then from there he walks a trail to any of the m cabins (including the one he started in). However, as he has to finish the hike in a day, at least one of the two trails has to be short.How many possible combinations of trails can Harry take if he starts in cabin 1 and walks for n days?Give the answer modulo 109+7." 1800
1970D3 "Arithmancy (Hard)" interactive "The only difference between the versions of this problem is the maximum value of n.Professor Vector is preparing to teach her Arithmancy class. She needs to prepare n distinct magic words for the class. Each magic word is a string consisting of characters X and O. A spell is a string created by concatenating two magic words together. The power of a spell is equal to the number of its different non-empty substrings. For example, the power of the spell XOXO is equal to 7, because it has 7 different substrings: X, O, XO, OX, XOX, OXO and XOXO.Each student will create their own spell by concatenating two magic words. Since the students are not very good at magic yet, they will choose each of the two words independently and uniformly at random from the n words provided by Professor Vector. It is therefore also possible that the two words a student chooses are the same. Each student will then compute the power of their spell, and tell it to Professor Vector. In order to check their work, and of course to impress the students, Professor Vector needs to find out which two magic words and in which order were concatenated by each student.Your program needs to perform the role of Professor Vector: first, create n distinct magic words, and then handle multiple requests where it is given the spell power and needs to determine the indices of the two magic words, in the correct order, that were used to create the corresponding spell." 3100
1970D2 "Arithmancy (Medium)" "constructive algorithms,interactive,probabilities,strings" "The only difference between the versions of this problem is the maximum value of n.Professor Vector is preparing to teach her Arithmancy class. She needs to prepare n distinct magic words for the class. Each magic word is a string consisting of characters X and O. A spell is a string created by concatenating two magic words together. The power of a spell is equal to the number of its different non-empty substrings. For example, the power of the spell XOXO is equal to 7, because it has 7 different substrings: X, O, XO, OX, XOX, OXO and XOXO.Each student will create their own spell by concatenating two magic words. Since the students are not very good at magic yet, they will choose each of the two words independently and uniformly at random from the n words provided by Professor Vector. It is therefore also possible that the two words a student chooses are the same. Each student will then compute the power of their spell, and tell it to Professor Vector. In order to check their work, and of course to impress the students, Professor Vector needs to find out which two magic words and in which order were concatenated by each student.Your program needs to perform the role of Professor Vector: first, create n distinct magic words, and then handle multiple requests where it is given the spell power and needs to determine the indices of the two magic words, in the correct order, that were used to create the corresponding spell." 2600
1970D1 "Arithmancy (Easy)" "brute force,constructive algorithms,interactive,strings" "Professor Vector is preparing to teach her Arithmancy class. She needs to prepare n distinct magic words for the class. Each magic word is a string consisting of characters X and O. A spell is a string created by concatenating two magic words together. The power of a spell is equal to the number of its different non-empty substrings. For example, the power of the spell XOXO is equal to 7, because it has 7 different substrings: X, O, XO, OX, XOX, OXO and XOXO.Each student will create their own spell by concatenating two magic words. Since the students are not very good at magic yet, they will choose each of the two words independently and uniformly at random from the n words provided by Professor Vector. It is therefore also possible that the two words a student chooses are the same. Each student will then compute the power of their spell, and tell it to Professor Vector. In order to check their work, and of course to impress the students, Professor Vector needs to find out which two magic words and in which order were concatenated by each student.Your program needs to perform the role of Professor Vector: first, create n distinct magic words, and then handle multiple requests where it is given the spell power and needs to determine the indices of the two magic words, in the correct order, that were used to create the corresponding spell." 2100
1970C3 "Game on Tree (Hard)" "dfs and similar,dp,games,trees" "This is the hard version of the problem. The only difference in this version is the constraint on t.Ron and Hermione are playing a game on a tree of n nodes that are initially inactive. The game consists of t rounds, each of which starts with a stone on exactly one node, which is considered as activated. A move consists of picking an inactive neighbor of the node with a stone on it and moving the stone there (thus activating this neighbor). Ron makes the first move, after which he alternates with Hermione until no valid move is available. The player that cannot make a move loses the round. If both players play optimally, who wins each round of this game? Note that all the rounds are played with the same tree; only the starting node changes. Moreover, after each round, all active nodes are considered inactive again." 1900
1970C2 "Game on Tree (Medium)" "dfs and similar,dp,games,trees" "This is the medium version of the problem. The difference in this version is that t=1 and we work on trees.Ron and Hermione are playing a game on a tree of n nodes that are initially inactive. The game consists of t rounds, each of which starts with a stone on exactly one node, which is considered as activated. A move consists of picking an inactive neighbor of the node with a stone on it and moving the stone there (thus activating this neighbor). Ron makes the first move, after which he alternates with Hermione until no valid move is available. The player that cannot make a move loses the round. If both players play optimally, who wins each round of this game? Note that all the rounds are played with the same tree; only the starting node changes. Moreover, after each round, all active nodes are considered inactive again." 1700
1970C1 "Game on Tree (Easy)" games "This is the easy version of the problem. The difference in this version is that t=1 and we work on an array-like tree.Ron and Hermione are playing a game on a tree of n nodes that are initially inactive. This tree is special because it has exactly two leaves. It can thus be seen as an array. The game consists of t rounds, each of which starts with a stone on exactly one node, which is considered as activated. A move consists of picking an inactive neighbor of the node with a stone on it and moving the stone there (thus activating this neighbor). Ron makes the first move, after which he alternates with Hermione until no valid move is available. The player that cannot make a move loses the round. If both players play optimally, who wins each round of this game? Note that all the rounds are played with the same tree; only the starting node changes. Moreover, after each round, all active nodes are considered inactive again." 1400
1970B3 "Exact Neighbours (Hard)" "constructive algorithms" "After some recent attacks on Hogwarts Castle by the Death Eaters, the Order of the Phoenix has decided to station n members in Hogsmead Village. The houses will be situated on a picturesque n\xc3\x97n square field. Each wizard will have their own house, and every house will belong to some wizard. Each house will take up the space of one square.However, as you might know wizards are very superstitious. During the weekends, each wizard i will want to visit the house that is exactly ai (0\xe2\x89\xa4ai\xe2\x89\xa4n) away from their own house. The roads in the village are built horizontally and vertically, so the distance between points (xi,yi) and (xj,yj) on the n\xc3\x97n field is |xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|. The wizards know and trust each other, so one wizard can visit another wizard\'s house when the second wizard is away. The houses to be built will be big enough for all n wizards to simultaneously visit any house.Apart from that, each wizard is mandated to have a view of the Hogwarts Castle in the north and the Forbidden Forest in the south, so the house of no other wizard should block the view. In terms of the village, it means that in each column of the n\xc3\x97n field, there can be at most one house, i.e. if the i-th house has coordinates (xi,yi), then xi\xe2\x89\xa0xj for all i\xe2\x89\xa0j.The Order of the Phoenix doesn\'t yet know if it is possible to place n houses in such a way that will satisfy the visit and view requirements of all n wizards, so they are asking for your help in designing such a plan.If it is possible to have a correct placement, where for the i-th wizard there is a house that is ai away from it and the house of the i-th wizard is the only house in their column, output YES, the position of houses for each wizard, and to the house of which wizard should each wizard go during the weekends.If it is impossible to have a correct placement, output NO." 2300
1970B2 "Exact Neighbours (Medium)" "constructive algorithms" "The only difference between this and the hard version is that a1=0.After some recent attacks on Hogwarts Castle by the Death Eaters, the Order of the Phoenix has decided to station n members in Hogsmead Village. The houses will be situated on a picturesque n\xc3\x97n square field. Each wizard will have their own house, and every house will belong to some wizard. Each house will take up the space of one square.However, as you might know wizards are very superstitious. During the weekends, each wizard i will want to visit the house that is exactly ai (0\xe2\x89\xa4ai\xe2\x89\xa4n) away from their own house. The roads in the village are built horizontally and vertically, so the distance between points (xi,yi) and (xj,yj) on the n\xc3\x97n field is |xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|. The wizards know and trust each other, so one wizard can visit another wizard\'s house when the second wizard is away. The houses to be built will be big enough for all n wizards to simultaneously visit any house.Apart from that, each wizard is mandated to have a view of the Hogwarts Castle in the north and the Forbidden Forest in the south, so the house of no other wizard should block the view. In terms of the village, it means that in each column of the n\xc3\x97n field, there can be at most one house, i.e. if the i-th house has coordinates (xi,yi), then xi\xe2\x89\xa0xj for all i\xe2\x89\xa0j.The Order of the Phoenix doesn\'t yet know if it is possible to place n houses in such a way that will satisfy the visit and view requirements of all n wizards, so they are asking for your help in designing such a plan.If it is possible to have a correct placement, where for the i-th wizard there is a house that is ai away from it and the house of the i-th wizard is the only house in their column, output YES, the position of houses for each wizard, and to the house of which wizard should each wizard go during the weekends.If it is impossible to have a correct placement, output NO." 2100
1970B1 "Exact Neighbours (Easy)" "constructive algorithms" "The only difference between this and the hard version is that all ai are even.After some recent attacks on Hogwarts Castle by the Death Eaters, the Order of the Phoenix has decided to station n members in Hogsmead Village. The houses will be situated on a picturesque n\xc3\x97n square field. Each wizard will have their own house, and every house will belong to some wizard. Each house will take up the space of one square.However, as you might know wizards are very superstitious. During the weekends, each wizard i will want to visit the house that is exactly ai (0\xe2\x89\xa4ai\xe2\x89\xa4n) away from their own house. The roads in the village are built horizontally and vertically, so the distance between points (xi,yi) and (xj,yj) on the n\xc3\x97n field is |xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|. The wizards know and trust each other, so one wizard can visit another wizard\'s house when the second wizard is away. The houses to be built will be big enough for all n wizards to simultaneously visit any house.Apart from that, each wizard is mandated to have a view of the Hogwarts Castle in the north and the Forbidden Forest in the south, so the house of no other wizard should block the view. In terms of the village, it means that in each column of the n\xc3\x97n field, there can be at most one house, i.e. if the i-th house has coordinates (xi,yi), then xi\xe2\x89\xa0xj for all i\xe2\x89\xa0j.The Order of the Phoenix doesn\'t yet know if it is possible to place n houses in such a way that will satisfy the visit and view requirements of all n wizards, so they are asking for your help in designing such a plan.If it is possible to have a correct placement, where for the i-th wizard there is a house that is ai away from it and the house of the i-th wizard is the only house in their column, output YES, the position of houses for each wizard, and to the house of which wizard should each wizard go during the weekends.If it is impossible to have a correct placement, output NO." 1900
1970A3 "Balanced Unshuffle (Hard)" "constructive algorithms,trees" "The only difference with the medium version is the maximum length of the input.A parentheses sequence is a string consisting of characters ""("" and "")"", for example ""(()(("".A balanced parentheses sequence is a parentheses sequence which can become a valid mathematical expression after inserting numbers and operations into it, for example ""(()(()))"".The balance of a parentheses sequence is defined as the number of opening parentheses ""("" minus the number of closing parentheses "")"". For example, the balance of the sequence ""(()(("" is 3.A balanced parentheses sequence can also be defined as a parentheses sequence with balance 0 such that each of its prefixes has a non-negative balance.We define the balanced shuffle operation that takes a parentheses sequence and returns a parentheses sequence as follows: first, for every character of the input sequence, we compute the balance of the prefix of the sequence before that character and write those down in a table together with the positions of the characters in the input sequence, for example:Prefix balance01212321Position12345678Character(()(()))Then, we sort the columns of this table in increasing order of prefix balance, breaking ties in decreasing order of position. In the above example, we get:Prefix balance01112223Position18427536Character()(()())The last row of this table forms another parentheses sequence, in this case ""()(()())"". This sequence is called the result of applying the balanced shuffle operation to the input sequence, or in short just the balanced shuffle of the input sequence.Surprisingly, it turns out that the balanced shuffle of any balanced parentheses sequence is always another balanced parentheses sequence (we will omit the proof for brevity). Even more surprisingly, the balanced shuffles of two different balanced parentheses sequences are always different, therefore the balanced shuffle operation is a bijection on the set of balanced parentheses sequences of any given length (we will omit this proof, too).You are given a balanced parentheses sequence. Find its preimage: the balanced parentheses sequence the balanced shuffle of which is equal to the given sequence." 2400
1970A2 "Balanced Unshuffle (Medium)" "brute force,constructive algorithms,trees" "The differences with the easy version of this problem are highlighted in bold.A parentheses sequence is a string consisting of characters ""("" and "")"", for example ""(()(("".A balanced parentheses sequence is a parentheses sequence which can become a valid mathematical expression after inserting numbers and operations into it, for example ""(()(()))"".The balance of a parentheses sequence is defined as the number of opening parentheses ""("" minus the number of closing parentheses "")"". For example, the balance of the sequence ""(()(("" is 3.A balanced parentheses sequence can also be defined as a parentheses sequence with balance 0 such that each of its prefixes has a non-negative balance.We define the balanced shuffle operation that takes a parentheses sequence and returns a parentheses sequence as follows: first, for every character of the input sequence, we compute the balance of the prefix of the sequence before that character and write those down in a table together with the positions of the characters in the input sequence, for example:Prefix balance01212321Position12345678Character(()(()))Then, we sort the columns of this table in increasing order of prefix balance, breaking ties in decreasing order of position. In the above example, we get:Prefix balance01112223Position18427536Character()(()())The last row of this table forms another parentheses sequence, in this case ""()(()())"". This sequence is called the result of applying the balanced shuffle operation to the input sequence, or in short just the balanced shuffle of the input sequence.Surprisingly, it turns out that the balanced shuffle of any balanced parentheses sequence is always another balanced parentheses sequence (we will omit the proof for brevity). Even more surprisingly, the balanced shuffles of two different balanced parentheses sequences are always different, therefore the balanced shuffle operation is a bijection on the set of balanced parentheses sequences of any given length (we will omit this proof, too).You are given a balanced parentheses sequence. Find its preimage: the balanced parentheses sequence the balanced shuffle of which is equal to the given sequence." 2400
1970A1 "Balanced Shuffle (Easy)" implementation,sortings "A parentheses sequence is a string consisting of characters ""("" and "")"", for example ""(()(("".A balanced parentheses sequence is a parentheses sequence which can become a valid mathematical expression after inserting numbers and operations into it, for example ""(()(()))"".The balance of a parentheses sequence is defined as the number of opening parentheses ""("" minus the number of closing parentheses "")"". For example, the balance of the sequence ""(()(("" is 3.A balanced parentheses sequence can also be defined as a parentheses sequence with balance 0 such that each of its prefixes has a non-negative balance.We define the balanced shuffle operation that takes a parentheses sequence and returns a parentheses sequence as follows: first, for every character of the input sequence, we compute the balance of the prefix of the sequence before that character and write those down in a table together with the positions of the characters in the input sequence, for example:Prefix balance01212321Position12345678Character(()(()))Then, we sort the columns of this table in increasing order of prefix balance, breaking ties in decreasing order of position. In the above example, we get:Prefix balance01112223Position18427536Character()(()())The last row of this table forms another parentheses sequence, in this case ""()(()())"". This sequence is called the result of applying the balanced shuffle operation to the input sequence, or in short just the balanced shuffle of the input sequence.You are given a balanced parentheses sequence. Print its balanced shuffle." 1000
1969F "Card Pairing" dp,greedy,hashing,implementation "There is a deck of n cards, each card has one of k types. You are given the sequence a1,a2,\xe2\x80\xa6,an denoting the types of cards in the deck from top to bottom. Both n and k are even numbers.You play a game with these cards. First, you draw k topmost cards from the deck. Then, the following happens each turn of the game:  you choose exactly two cards from your hand and play them. If these cards have the same type, you earn a coin;  then, if the deck is not empty, you draw exactly two top cards from it;  then, if both your hand and your deck are empty, the game ends. Otherwise, the new turn begins. You have to calculate the maximum number of coins you can earn during the game." 3000
1969E "Unique Array" "binary search,data structures,divide and conquer,dp,greedy" "You are given an integer array a of length n. A subarray of a is one of its contiguous subsequences (i.\xe2\x80\x89e. an array [al,al+1,\xe2\x80\xa6,ar] for some integers l and r such that 1\xe2\x89\xa4l<r\xe2\x89\xa4n). Let\'s call a subarray unique if there is an integer that occurs exactly once in the subarray.You can perform the following operation any number of times (possibly zero): choose an element of the array and replace it with any integer.Your task is to calculate the minimum number of aforementioned operation in order for all the subarrays of the array a to be unique." 2400
1969D "Shop Game" "data structures,greedy,math,sortings" "Alice and Bob are playing a game in the shop. There are n items in the shop; each item has two parameters: ai (item price for Alice) and bi (item price for Bob).Alice wants to choose a subset (possibly empty) of items and buy them. After that, Bob does the following:   if Alice bought less than k items, Bob can take all of them for free;  otherwise, he will take k items for free that Alice bought (Bob chooses which k items it will be), and for the rest of the chosen items, Bob will buy them from Alice and pay bi for the i-th item. Alice\'s profit is equal to \xe2\x88\x91i\xe2\x88\x88Sbi\xe2\x88\x92\xe2\x88\x91j\xe2\x88\x88Taj, where S is the set of items Bob buys from Alice, and T is the set of items Alice buys from the shop. In other words, Alice\'s profit is the difference between the amount Bob pays her and the amount she spends buying the items.Alice wants to maximize her profit, Bob wants to minimize Alice\'s profit. Your task is to calculate Alice\'s profit if both Alice and Bob act optimally." 1900
1969C "Minimizing the Sum" dp,implementation "You are given an integer array a of length n.You can perform the following operation: choose an element of the array and replace it with any of its neighbor\'s value.For example, if a=[3,1,2], you can get one of the arrays [3,3,2], [3,2,2] and [1,1,2] using one operation, but not [2,1,2] or [3,4,2]. Your task is to calculate the minimum possible total sum of the array if you can perform the aforementioned operation at most k times." 1700
1969B "Shifts and Sorting" "constructive algorithms,greedy" "Let\'s define a cyclic shift of some string s as a transformation from s1s2\xe2\x80\xa6sn\xe2\x88\x921sn into sns1s2\xe2\x80\xa6sn\xe2\x88\x921. In other words, you take one last character sn and place it before the first character while moving all other characters to the right.You are given a binary string s (a string consisting of only 0-s and/or 1-s).In one operation, you can choose any substring slsl+1\xe2\x80\xa6sr (1\xe2\x89\xa4l<r\xe2\x89\xa4|s|) and cyclically shift it. The cost of such operation is equal to r\xe2\x88\x92l+1 (or the length of the chosen substring).You can perform the given operation any number of times. What is the minimum total cost to make s sorted in non-descending order?" 1000
1969A "Two Friends" "constructive algorithms,implementation,math" "Monocarp wants to throw a party. He has n friends, and he wants to have at least 2 of them at his party.The i-th friend\'s best friend is pi. All pi are distinct, and for every i\xe2\x88\x88[1,n], pi\xe2\x89\xa0i.Monocarp can send invitations to friends. The i-th friend comes to the party if both the i-th friend and the pi-th friend receive an invitation (note that the pi-th friend doesn\'t have to actually come to the party). Each invitation is sent to exactly one of the friends.For example, if p=[3,1,2,5,4], and Monocarp sends invitations to the friends [1,2,4,5], then the friends [2,4,5] will come to the party. The friend 1 won\'t come since his best friend didn\'t receive an invitation; the friend 3 won\'t come since he didn\'t receive an invitation.Calculate the minimum number of invitations Monocarp has to send so that at least 2 friends come to the party." 800
1968G2 "Division + LCP (hard version)" "binary search,brute force,data structures,dp,hashing,math,string suffix structures,strings" "This is the hard version of the problem. In this version l\xe2\x89\xa4r.You are given a string s. For a fixed k, consider a division of s into exactly k continuous substrings w1,\xe2\x80\xa6,wk. Let fk be the maximal possible LCP(w1,\xe2\x80\xa6,wk) among all divisions.LCP(w1,\xe2\x80\xa6,wm) is the length of the Longest Common Prefix of the strings w1,\xe2\x80\xa6,wm.For example, if s=abababcab and k=4, a possible division is abababcab. The LCP(ab,ab,abc,ab) is 2, since ab is the Longest Common Prefix of those four strings. Note that each substring consists of a continuous segment of characters and each character belongs to exactly one substring.Your task is to find fl,fl+1,\xe2\x80\xa6,fr." 2200
1968G1 "Division + LCP (easy version)" "binary search,data structures,dp,hashing,string suffix structures,strings" "This is the easy version of the problem. In this version l=r.You are given a string s. For a fixed k, consider a division of s into exactly k continuous substrings w1,\xe2\x80\xa6,wk. Let fk be the maximal possible LCP(w1,\xe2\x80\xa6,wk) among all divisions.LCP(w1,\xe2\x80\xa6,wm) is the length of the Longest Common Prefix of the strings w1,\xe2\x80\xa6,wm.For example, if s=abababcab and k=4, a possible division is abababcab. The LCP(ab,ab,abc,ab) is 2, since ab is the Longest Common Prefix of those four strings. Note that each substring consists of a continuous segment of characters and each character belongs to exactly one substring.Your task is to find fl,fl+1,\xe2\x80\xa6,fr. In this version l=r." 1900
1968F "Equal XOR Segments" "binary search,data structures" "Let us call an array x1,\xe2\x80\xa6,xm interesting if it is possible to divide the array into k>1 parts so that bitwise XOR of values from each part are equal. More formally, you must split array x into k consecutive segments, each element of x must belong to exactly 1 segment. Let y1,\xe2\x80\xa6,yk be the XOR of elements from each part respectively. Then y1=y2=\xe2\x8b\xaf=yk must be fulfilled.For example, if x=[1,1,2,3,0], you can split it as follows: [1],[1],[2,3,0]. Indeed 1=1=2\xe2\x8a\x953\xe2\x8a\x950.You are given an array a1,\xe2\x80\xa6,an. Your task is to answer q queries:   For fixed l, r, determine whether the subarray al,al+1,\xe2\x80\xa6,ar is interesting." 1800
1968E "Cells Arrangement" "constructive algorithms" "You are given an integer n. You choose n cells (x1,y1),(x2,y2),\xe2\x80\xa6,(xn,yn) in the grid n\xc3\x97n where 1\xe2\x89\xa4xi\xe2\x89\xa4n and 1\xe2\x89\xa4yi\xe2\x89\xa4n.Let H be the set of distinct Manhattan distances between any pair of cells. Your task is to maximize the size of H. Examples of sets and their construction are given in the notes.If there exists more than one solution, you are allowed to output any.Manhattan distance between cells (x1,y1) and (x2,y2) equals |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|." 1600
1968D "Permutation Game" "brute force,dfs and similar,games,graphs,greedy,math" "Bodya and Sasha found a permutation p1,\xe2\x80\xa6,pn and an array a1,\xe2\x80\xa6,an. They decided to play a well-known ""Permutation game"".A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).Both of them chose a starting position in the permutation.The game lasts k turns. The players make moves simultaneously. On each turn, two things happen to each player:   If the current position of the player is x, his score increases by ax.  Then the player either stays at his current position x or moves from x to px.  The winner of the game is the player with the higher score after exactly k turns.Knowing Bodya\'s starting position PB and Sasha\'s starting position PS, determine who wins the game if both players are trying to win." 1300
1968C "Assembly via Remainders" "constructive algorithms,number theory" "You are given an array x2,x3,\xe2\x80\xa6,xn. Your task is to find any array a1,\xe2\x80\xa6,an, where:   1\xe2\x89\xa4ai\xe2\x89\xa4109 for all 1\xe2\x89\xa4i\xe2\x89\xa4n.  xi=aimodai\xe2\x88\x921 for all 2\xe2\x89\xa4i\xe2\x89\xa4n. Here cmodd denotes the remainder of the division of the integer c by the integer d. For example 5mod2=1, 72mod3=0, 143mod14=3.Note that if there is more than one a which satisfies the statement, you are allowed to find any." 1000
1968B Prefiquence "greedy,two pointers" "You are given two binary strings a and b. A binary string is a string consisting of the characters \'0\' and \'1\'.Your task is to determine the maximum possible number k such that a prefix of string a of length k is a subsequence of string b.A sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) elements." 800
1968A Maximize? "brute force,math,number theory" "You are given an integer x. Your task is to find any integer y (1\xe2\x89\xa4y<x) such that gcd(x,y)+y is maximum possible.Note that if there is more than one y which satisfies the statement, you are allowed to find any.gcd(a,b) is the Greatest Common Divisor of a and b. For example, gcd(6,4)=2." 800
1967F "Next and Prev" "brute force,data structures,implementation" "Let p1,\xe2\x80\xa6,pn be a permutation of [1,\xe2\x80\xa6,n].Let the q-subsequence of p be a permutation of [1,q], whose elements are in the same relative order as in p1,\xe2\x80\xa6,pn. That is, we extract all elements not exceeding q together from p in the original order, and they make the q-subsequence of p.For a given array a, let pre(i) be the largest value satisfying pre(i)<i and apre(i)>ai. If it does not exist, let pre(i)=\xe2\x88\x9210100. Let nxt(i) be the smallest value satisfying nxt(i)>i and anxt(i)>ai. If it does not exist, let nxt(i)=10100.For each q such that 1\xe2\x89\xa4q\xe2\x89\xa4n, let a1,\xe2\x80\xa6,aq be the q-subsequence of p. For each i such that 1\xe2\x89\xa4i\xe2\x89\xa4q, pre(i) and nxt(i) will be calculated as defined. Then, you will be given some integer values of x, and for each of them you have to calculate q\xe2\x88\x91i=1min(nxt(i)\xe2\x88\x92pre(i),x)." 3200
1967E2 "Again Counting Arrays (Hard Version)" combinatorics,dp,math "This is the hard version of the problem. The differences between the two versions are the constraints on n,m,b0 and the time limit. You can make hacks only if both versions are solved.Little R has counted many sets before, and now she decides to count arrays.Little R thinks an array b0,\xe2\x80\xa6,bn consisting of non-negative integers is continuous if and only if, for each i such that 1\xe2\x89\xa4i\xe2\x89\xa4n, |bi\xe2\x88\x92bi\xe2\x88\x921|=1 is satisfied. She likes continuity, so she only wants to generate continuous arrays.If Little R is given b0 and a1,\xe2\x80\xa6,an, she will try to generate a non-negative continuous array b, which has no similarity with a. More formally, for all 1\xe2\x89\xa4i\xe2\x89\xa4n, ai\xe2\x89\xa0bi holds.However, Little R does not have any array a. Instead, she gives you n, m and b0. She wants to count the different integer arrays a1,\xe2\x80\xa6,an satisfying:  1\xe2\x89\xa4ai\xe2\x89\xa4m;  At least one non-negative continuous array b0,\xe2\x80\xa6,bn can be generated. Note that bi\xe2\x89\xa50, but the bi can be arbitrarily large.Since the actual answer may be enormous, please just tell her the answer modulo 998244353." 3500
1967E1 "Again Counting Arrays (Easy Version)" combinatorics,dp,fft,math "This is the easy version of the problem. The differences between the two versions are the constraints on n,m,b0 and the time limit. You can make hacks only if both versions are solved.Little R has counted many sets before, and now she decides to count arrays.Little R thinks an array b0,\xe2\x80\xa6,bn consisting of non-negative integers is continuous if and only if, for each i such that 1\xe2\x89\xa4i\xe2\x89\xa4n, |bi\xe2\x88\x92bi\xe2\x88\x921|=1 is satisfied. She likes continuity, so she only wants to generate continuous arrays.If Little R is given b0 and a1,\xe2\x80\xa6,an, she will try to generate a non-negative continuous array b, which has no similarity with a. More formally, for all 1\xe2\x89\xa4i\xe2\x89\xa4n, ai\xe2\x89\xa0bi holds.However, Little R does not have any array a. Instead, she gives you n, m and b0. She wants to count the different integer arrays a1,\xe2\x80\xa6,an satisfying:  1\xe2\x89\xa4ai\xe2\x89\xa4m;  At least one non-negative continuous array b0,\xe2\x80\xa6,bn can be generated. Note that bi\xe2\x89\xa50, but the bi can be arbitrarily large.Since the actual answer may be enormous, please just tell her the answer modulo 998244353." 3100
1967D "Long Way to be Non-decreasing" "binary search,dfs and similar,graphs,implementation,shortest paths,two pointers" "Little R is a magician who likes non-decreasing arrays. She has an array of length n, initially as a1,\xe2\x80\xa6,an, in which each element is an integer between [1,m]. She wants it to be non-decreasing, i.e., a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an.To do this, she can perform several magic tricks. Little R has a fixed array b1\xe2\x80\xa6bm of length m. Formally, let\'s define a trick as a procedure that does the following things in order:  Choose a set S\xe2\x8a\x86{1,2,\xe2\x80\xa6,n}.  For each u\xe2\x88\x88S, assign au with bau. Little R wonders how many tricks are needed at least to make the initial array non-decreasing. If it is not possible with any amount of tricks, print \xe2\x88\x921 instead." 2800
1967C "Fenwick Tree" "bitmasks,brute force,combinatorics,data structures,dp,math,trees" "Let lowbit(x) denote the value of the lowest binary bit of x, e.g. lowbit(12)=4, lowbit(8)=8.For an array a of length n, if an array s of length n satisfies sk=(k\xe2\x88\x91i=k\xe2\x88\x92lowbit(k)+1ai)mod998244353 for all k, then s is called the Fenwick Tree of a. Let\'s denote it as s=f(a).For a positive integer k and an array a, fk(a) is defined as follows:fk(a)={f(a)if k=1f(fk\xe2\x88\x921(a))otherwise.You are given an array b of length n and a positive integer k. Find an array a that satisfies 0\xe2\x89\xa4ai<998244353 and fk(a)=b. It can be proved that an answer always exists. If there are multiple possible answers, you may print any of them." 2300
1967B2 "Reverse Card (Hard Version)" "brute force,math,number theory" "The two versions are different problems. You may want to read both versions. You can make hacks only if both versions are solved.You are given two positive integers n, m.Calculate the number of ordered pairs (a,b) satisfying the following conditions:  1\xe2\x89\xa4a\xe2\x89\xa4n, 1\xe2\x89\xa4b\xe2\x89\xa4m;  b\xe2\x8b\x85gcd(a,b) is a multiple of a+b." 2200
1967B1 "Reverse Card (Easy Version)" "brute force,math,number theory" "The two versions are different problems. You may want to read both versions. You can make hacks only if both versions are solved.You are given two positive integers n, m.Calculate the number of ordered pairs (a,b) satisfying the following conditions:  1\xe2\x89\xa4a\xe2\x89\xa4n, 1\xe2\x89\xa4b\xe2\x89\xa4m;  a+b is a multiple of b\xe2\x8b\x85gcd(a,b)." 1400
1967A "Permutation Counting" "binary search,greedy,implementation,math,sortings" "You have some cards. An integer between 11 and n is written on each card: specifically, for each i from 1 to n, you have ai cards which have the number i written on them.There is also a shop which contains unlimited cards of each type. You have k coins, so you can buy k new cards in total, and the cards you buy can contain any integer between 1 and n.After buying the new cards, you rearrange all your cards in a line. The score of a rearrangement is the number of (contiguous) subarrays of length n which are a permutation of [1,2,\xe2\x80\xa6,n]. What\'s the maximum score you can get?" 1400
1966B "Rectangle Filling" "constructive algorithms,implementation" "There is an n\xc3\x97m grid of white and black squares. In one operation, you can select any two squares of the same color, and color all squares in the subrectangle between them that color.Formally, if you select positions (x1,y1) and (x2,y2), both of which are currently the same color c, set the color of all (x,y) where min(x1,x2)\xe2\x89\xa4x\xe2\x89\xa4max(x1,x2) and min(y1,y2)\xe2\x89\xa4y\xe2\x89\xa4max(y1,y2) to c.This diagram shows a sequence of two possible operations on a grid:  Is it possible for all squares in the grid to be the same color, after performing any number of operations (possibly zero)?" 1100
1966A "Card Exchange" "constructive algorithms,games,greedy" "You have a hand of n cards, where each card has a number written on it, and a fixed integer k. You can perform the following operation any number of times:  Choose any k cards from your hand that all have the same number.  Exchange these cards for k\xe2\x88\x921 cards, each of which can have any number you choose (including the number written on the cards you just exchanged). Here is one possible sequence of operations for the first example case, which has k=3:  What is the minimum number of cards you can have in your hand at the end of this process?" 800
1965F Conference "data structures,flows" "You have been asked to organize a very important art conference. The first step is to choose the dates.The conference must last for a certain number of consecutive days. Each day, one lecturer must perform, and the same lecturer cannot perform more than once.You asked n potential lecturers if they could participate in the conference. Lecturer i indicated that they could perform on any day from li to ri inclusive.A certain segment of days can be chosen as the conference dates if there is a way to assign an available lecturer to each day of the segment, assigning each lecturer to no more than one day.For each k from 1 to n, find how many ways there are to choose a segment of k consecutive days as the conference dates." 3300
1965E "Connected Cubes" "constructive algorithms,games" "There are n\xe2\x8b\x85m unit cubes currently in positions (1,1,1) through (n,m,1). Each of these cubes is one of k colors. You want to add additional cubes at any integer coordinates such that the subset of cubes of each color is connected, where two cubes are considered connected if they share a face.In other words, for every pair of cubes of the same color c, it should be possible to travel from one to the other, moving only through cubes of color c that share a face.The existing cubes are currently in the corner of a room. There are colorless cubes completely filling the planes x=0, y=0, and z=0, preventing you from placing additional cubes there or at any negative coordinates.  Find a solution that uses at most 4\xe2\x8b\x85105 additional cubes (not including the cubes that are currently present), or determine that there is no solution. It can be shown that under the given constraints, if there is a solution, there is one using at most 4\xe2\x8b\x85105 additional cubes." 3100
1965D "Missing Subarray Sum" "constructive algorithms" "There is a hidden array a of n positive integers. You know that a is a palindrome, or in other words, for all 1\xe2\x89\xa4i\xe2\x89\xa4n, ai=an+1\xe2\x88\x92i. You are given the sums of all but one of its distinct subarrays, in arbitrary order. The subarray whose sum is not given can be any of the n(n+1)2 distinct subarrays of a.Recover any possible palindrome a. The input is chosen such that there is always at least one array a that satisfies the conditions.An array b is a subarray of a if b can be obtained from a by the deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 2900
1965C "Folding Strip" "constructive algorithms,greedy,strings" "You have a strip of paper with a binary string s of length n. You can fold the paper in between any pair of adjacent digits.A set of folds is considered valid if after the folds, all characters that are on top of or below each other match. Note that all folds are made at the same time, so the characters don\'t have to match in between folds.For example, these are valid foldings of s=110110110011 and s=01110:  The length of the folded strip is the length seen from above after all folds are made. So for the two above examples, after the folds shown above, the lengths would be 7 and 3, respectively.Notice that for the above folding of s=01110, if we made either of the two folds on their own, that would not be a valid folding. However, because we don\'t check for validity until all folds are made, this folding is valid.After performing a set of valid folds, what is the minimum length strip you can form?" 2300
1965B "Missing Subsequence Sum" "bitmasks,constructive algorithms,greedy,number theory" "You are given two integers n and k. Find a sequence a of non-negative integers of size at most 25 such that the following conditions hold.  There is no subsequence of a with a sum of k.  For all 1\xe2\x89\xa4v\xe2\x89\xa4n where v\xe2\x89\xa0k, there is a subsequence of a with a sum of v. A sequence b is a subsequence of a if b can be obtained from a by the deletion of several (possibly, zero or all) elements, without changing the order of the remaining elements. For example, [5,2,3] is a subsequence of [1,5,7,8,2,4,3].It can be shown that under the given constraints, a solution always exists." 1800
1965A "Everything Nim" games,greedy,math,sortings "Alice and Bob are playing a game on n piles of stones. On each player\'s turn, they select a positive integer k that is at most the size of the smallest nonempty pile and remove k stones from each nonempty pile at once. The first player who is unable to make a move (because all piles are empty) loses.Given that Alice goes first, who will win the game if both players play optimally?" 1400
1958J Necromancer "*special problem" "Monocarp is playing a computer game. In this game, his character is a necromancer. He is fighting n monsters numbered from 1 to n. Each monster has two parameters: health and strength.Monocarp considers q scenarios of the battle. In each scenario, he chooses some segment [l,r] of monsters and calculates the number of moves it takes to defeat all these monsters.Each scenario proceeds as follows. First, Monocarp kills monster l and revives it as a zombie (this does not count as a move). Then each move the following happens: let i be the index of the first monster in the segment [l,r] that is still alive. All zombies attack monster i, reducing its health by their total strength. After that, if monster i has 0 or less health, it dies and Monocarp revives it as a zombie.When the monster is revived, the zombie\'s strength is equal to the monster\'s strength.Help Monocarp for each scenario to calculate how many moves it will take to kill all the monsters in the segment." 3200
1958I "Equal Trees" "*special problem,graphs,meet-in-the-middle" "You are given two rooted trees, consisting of n vertices each. The vertices in the trees are numbered from 1 to n, and the root is the vertex 1.You can perform the following operation: choose the tree and the vertex v (except the root of the tree) in it; connect the child nodes of v to the parent of v and remove v from the tree.Let\'s say that two trees are equal if both of the following conditions hold:   the sets of remaining vertices in both trees are the same;  for every vertex v which is not deleted, its parent in the first tree is the same as its parent in the second tree. Your task is to calculate the minimum number of aforementioned operation in order to make the trees equal." 3100
1958H "Composite Spells" "*special problem,dp" "Monocarp plays a fantasy RPG. His character is a mage, so he casts spells. There are two types of spells he knows \xe2\x80\x94 basic spells and composite spells.There are n basic spells in Monocarp\'s spell book, numbered from 1 to n. Each basic spell simply changes the health of the target: either decreases it or increases it. The i-th basic spell changes the target\'s health value by bi (increases by bi if bi is non-negative, or decreases by |bi| if bi is negative). If the target\'s health value goes to 0 or below, it dies, and all next spells cast at it do nothing.There are also m composite spells in the spell book, numbered from n+1 to n+m. Each composite spell is a sequence of other spells, cast in specific order. A composite spell can consist both of basic spells and composite spells; the i-th spell consists of si other spells, and each of those spells has index strictly less than i (so there is no situation that composite spells infinitely cast each other). So, actually, each composite spell can be considered a finite sequence of basic spells, although its length might be huge. Note that the same spell can appear in a composite spell multiple times.Monocarp has decided to cast the (n+m)-th spell from his spell book. The target of this spell is a monster with an initial health value of hp. Monocarp wants to know whether the monster will be killed or not, and if it will be killed, which basic spell will kill it." 2600
1958G "Observation Towers" "*special problem" "Consider a segment of an OX axis from 1 to n. There are k observation towers on this segment.Each tower has two parameters \xe2\x80\x94 the coordinate xi and the height hi. The coordinates of all towers are distinct. From tower i, you can see point j if |xi\xe2\x88\x92j|\xe2\x89\xa4hi (where |a| is an absolute value of a).You can increase the height of any tower by 1 for one coin. The height of each tower can be increased any number of times (including zero).You need to process q independent queries. In the i-th query, two different points l and r are given. You need to calculate the minimum number of coins required to be able to see both of these points (from one tower or from different towers)." 2400
1958F "Narrow Paths" "*special problem,combinatorics" "Monocarp is wandering through a matrix consisting of 2 rows and n columns. Let\'s denote the cell in the i-th row and j-th column as (i,j). Monocarp starts at cell (1,1) and wants to reach cell (2,n).In one move, Monocarp can move in one of two directions:   right \xe2\x80\x94 from cell (i,j) to cell (i,j+1);  down \xe2\x80\x94 from cell (i,j) to cell (i+1,j). Monocarp can\'t go outside the matrix.Polycarp wants to prevent Monocarp from freely wandering through the matrix. To do this, he wants to choose exactly k different cells in the matrix and block them. He cannot choose cells (1,1) and (2,n).For each i from 0 to n, Polycarp wants to know how many ways he can block exactly k cells, so that Monocarp has exactly i different paths from (1,1) to (2,n). Two paths are considered different if there exists a cell that Monocarp visits in one path but not in the other.As the number of ways can be quite large, output it modulo 109+7." 2000
1958E "Yet Another Permutation Constructive" "*special problem,constructive algorithms" "Suppose you have a permutation p of n integers \xe2\x80\x94 an array where each element is an integer from 1 to n, and every integer from 1 to n appears exactly once.In one operation, you remove every element of this permutation which is less than at least one of its neighbors. For example, when you apply the operation to [3,1,2,5,4], you get [3,5]. If you apply an operation again, you get [5].It\'s easy to see that after applying a finite number of operations, you get an array consisting of a single integer n.You are given two integers n and k. Find a permutation of n integers such that it becomes an array consisting of a single element n after exactly k operations (and not earlier)." 1900
1958D Staircase "*special problem" "There is a staircase consisting of n steps. Each step is either intact, or broken. For each broken step, an integer ai is given denoting the difficulty of repairing it.Every day, you can either:  repair an arbitrary broken step. The effort it takes to repair the i-th step is equal to ai;  or repair two adjacent broken steps. The effort it takes to repair both the i-th step and the (i+1)-th step is equal to 2\xe2\x8b\x85(ai+ai+1). You want to repair all broken steps of the staircase, and you want to do it in the minimum possible number of days. What is the minimum total effort it will take to repair all broken steps in the minimum number of days?" 1600
1958C Firewood "*special problem" "It\'s pretty cold in Berland (yes, even in May). So Monocarp has to light his fireplace.Monocarp has a big log of wood, which weighs 2n grams. Monocarp has watched the weather forecast and decided that he has to burn k grams of wood in the fireplace today, and the remaining 2n\xe2\x88\x92k grams of wood will be used tomorrow.In one minute, Monocarp can use his saw to split one of his logs in half. Initially he has only one log, but of course, after splitting a log, he gets two new logs. If the weight of the log is x, then each of the resulting logs has weight equal to x2. Monocarp can\'t split logs of weight 1 gram.Monocarp has to cut his log in such a way that some of the resulting logs weigh exactly k grams in total (and since the total weight of wood doesn\'t change, the remaining logs will have a total weight equal to exactly 2n\xe2\x88\x92k). Help him to calculate the minimum number of minutes he has to spend cutting the logs." 1500
1958B "Clock in the Pool" "*special problem,math" "You are swimming in the pool, and you need to control the time of swimming.The pool has a clock that cycles between three different modes: showing water temperature, showing air temperature, and showing time. At the start of the 0-th second it starts showing water temperature, at the start of the k-th second it switches to air temperature. At the start of the 2k-th second, it switches to showing time.At the start of the 3k-th second the clock starts showing water temperature again, at the start of the 4k-th second \xe2\x80\x94 air temperature, and so on.You looked at the clock during the m-th second to check the time, but it may be that the clock is not showing time right now. How much time do you have to wait to see the time on the clock?Answer t independent test cases." 1400
1958A 1-3-5 "*special problem,dp" "In Berland, coins of worth 1, 3 and 5 burles are commonly used (burles are local currency).Eva has to pay exactly n burles in a shop. She has an infinite amount of coins of all three types. However, she doesn\'t like to pay using coins worth 1 burle \xe2\x80\x94 she thinks they are the most convenient to use.Help Eva to calculate the minimum number of coins worth 1 burle she has to use, if she has to pay exactly n burles. Note that she can spend any number of coins worth 3 and/or 5 burles." 1100
1957F2 "Frequency Mismatch (Hard Version)" "binary search,data structures,dfs and similar,hashing,probabilities,trees" "This is the hard version of the problem. The difference between the two versions of this problem is the constraint on k. You can make hacks only if all versions of the problem are solved.You are given an undirected tree of n nodes. Each node v has a value av written on it. You have to answer queries related to the tree.You are given q queries. In each query, you are given 5 integers, u1,v1,u2,v2,k. Denote the count of nodes with value c on path u1\xe2\x86\x92v1 with xc, and the count of nodes with value c on path u2\xe2\x86\x92v2 with yc. If there are z such values of c such that xc\xe2\x89\xa0yc, output any min(z,k) such values in any order." 2700
1957F1 "Frequency Mismatch (Easy Version)" "binary search,data structures,divide and conquer,hashing,probabilities,trees" "This is the easy version of the problem. The difference between the two versions of this problem is the constraint on k. You can make hacks only if all versions of the problem are solved.You are given an undirected tree of n nodes. Each node v has a value av written on it. You have to answer queries related to the tree.You are given q queries. In each query, you are given 5 integers, u1,v1,u2,v2,k. Denote the count of nodes with value c on path u1\xe2\x86\x92v1 with xc, and the count of nodes with value c on path u2\xe2\x86\x92v2 with yc. If there are z such values of c such that xc\xe2\x89\xa0yc, output any min(z,k) such values in any order." 2600
1957E "Carousel of Combinations" "brute force,combinatorics,dp,math,number theory" "You are given an integer n. The function C(i,k) represents the number of distinct ways you can select k distinct numbers from the set {1,2,\xe2\x80\xa6,i} and arrange them in a circle\xe2\x80\xa0.Find the value of n\xe2\x88\x91i=1i\xe2\x88\x91j=1(C(i,j)modj). Here, the operation xmody denotes the remainder from dividing x by y.Since this value can be very large, find it modulo 109+7.\xe2\x80\xa0 In a circular arrangement, sequences are considered identical if one can be rotated to match the other. For instance, [1,2,3] and [2,3,1] are equivalent in a circle." 2400
1957D "A BIT of an Inequality" "bitmasks,brute force,dp,math" "You are given an array a1,a2,\xe2\x80\xa6,an. Find the number of tuples (x,y,z) such that:   1\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4z\xe2\x89\xa4n, and  f(x,y)\xe2\x8a\x95f(y,z)>f(x,z). We define f(l,r)=al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar, where \xe2\x8a\x95 denotes the bitwise XOR operation." 1900
1957C "How Does the Rook Move?" combinatorics,dp,math "You are given an n\xc3\x97n chessboard where you and the computer take turns alternatingly to place white rooks & black rooks on the board respectively. While placing rooks, you have to ensure that no two rooks attack each other. Two rooks attack each other if they share the same row or column regardless of color.A valid move is placing a rook on a position (r, c) such that it doesn\'t attack any other rook.You start first, and when you make a valid move in your turn, placing a white rook at position (r, c), the computer will mirror you and place a black rook at position (c, r) in its turn. If r=c, then the computer can\'t mirror your move, and skips its turn.You have already played k moves with the computer (the computer tries to mirror these moves too), and you must continue playing the game until there are no valid moves remaining. How many different final configurations are possible when you continue the game after the k moves? It is guaranteed that the k moves and the implied computer moves are valid. Since the answer may be large, print it modulo 109+7.Two configurations are considered different if there exists a coordinate (r, c) which has a rook in one configuration, but not in the other or the color of the rook on the coordinate is different." 1600
1957B "A BIT of a Construction" "bitmasks,constructive algorithms,greedy,implementation" "Given integers n and k, construct a sequence of n non-negative (i.e. \xe2\x89\xa50) integers a1,a2,\xe2\x80\xa6,an such that   n\xe2\x88\x91i=1ai=k  The number of 1s in the binary representation of a1|a2|\xe2\x80\xa6|an is maximized, where | denotes the bitwise OR operation." 1100
1957A Stickogon "constructive algorithms,greedy" "You are given n sticks of lengths a1,a2,\xe2\x80\xa6,an. Find the maximum number of regular (equal-sided) polygons you can construct simultaneously, such that:   Each side of a polygon is formed by exactly one stick.  No stick is used in more than 1 polygon. Note: Sticks cannot be broken." 800
1956F "Nene and the Passing Game" "constructive algorithms,data structures,dsu,graphs,sortings" "Nene is training her team as a basketball coach. Nene\'s team consists of n players, numbered from 1 to n. The i-th player has an arm interval [li,ri]. Two players i and j (i\xe2\x89\xa0j) can pass the ball to each other if and only if |i\xe2\x88\x92j|\xe2\x88\x88[li+lj,ri+rj] (here, |x| denotes the absolute value of x).Nene wants to test the cooperation ability of these players. In order to do this, she will hold several rounds of assessment.  In each round, Nene will select a sequence of players p1,p2,\xe2\x80\xa6,pm such that players pi and pi+1 can pass the ball to each other for all 1\xe2\x89\xa4i<m. The length of the sequence m can be chosen by Nene. Each player can appear in the sequence p1,p2,\xe2\x80\xa6,pm multiple times or not appear in it at all.  Then, Nene will throw a ball to player p1, player p1 will pass the ball to player p2 and so on... Player pm will throw a ball away from the basketball court so it can no longer be used. As a coach, Nene wants each of n players to appear in at least one round of assessment. Since Nene has to go on a date after school, Nene wants you to calculate the minimum number of rounds of assessment needed to complete the task." 3000
1956E2 "Nene vs. Monsters (Hard Version)" "brute force,greedy,implementation,math" "This is the hard version of the problem. The only difference between the versions is the constraints on ai. You can make hacks only if both versions of the problem are solved.Nene is fighting with n monsters, located in a circle. These monsters are numbered from 1 to n, and the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) monster\'s current energy level is ai.Since the monsters are too strong, Nene decided to fight with them using the Attack Your Neighbour spell. When Nene uses this spell, the following actions happen in the following order one by one:   The 1-st monster attacks the 2-nd monster;  The 2-nd monster attacks the 3-rd monster;  \xe2\x80\xa6  The (n\xe2\x88\x921)-th monster attacks the n-th monster;  The n-th monster attacks the 1-st monster. When the monster with energy level x attacks the monster with the energy level y, the energy level of the defending monster becomes max(0,y\xe2\x88\x92x) (the energy level of the attacking monster remains equal to x).Nene is going to use this spell 10100 times and deal with the monsters that will still have a non-zero energy level herself. She wants you to determine which monsters will have a non-zero energy level once she will use the described spell 10100 times." 2700
1956E1 "Nene vs. Monsters (Easy Version)" "brute force,implementation,math" "This is the easy version of the problem. The only difference between the versions is the constraints on ai. You can make hacks only if both versions of the problem are solved.Nene is fighting with n monsters, located in a circle. These monsters are numbered from 1 to n, and the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) monster\'s current energy level is ai.Since the monsters are too strong, Nene decided to fight with them using the Attack Your Neighbour spell. When Nene uses this spell, the following actions happen in the following order one by one:   The 1-st monster attacks the 2-nd monster;  The 2-nd monster attacks the 3-rd monster;  \xe2\x80\xa6  The (n\xe2\x88\x921)-th monster attacks the n-th monster;  The n-th monster attacks the 1-st monster. When the monster with energy level x attacks the monster with the energy level y, the energy level of the defending monster becomes max(0,y\xe2\x88\x92x) (the energy level of the attacking monster remains equal to x).Nene is going to use this spell 10100 times and deal with the monsters that will still have a non-zero energy level herself. She wants you to determine which monsters will have a non-zero energy level once she will use the described spell 10100 times." 2500
1956D "Nene and the Mex Operator" "bitmasks,brute force,constructive algorithms,divide and conquer,dp,greedy,implementation,math" "Nene gave you an array of integers a1,a2,\xe2\x80\xa6,an of length n.You can perform the following operation no more than 5\xe2\x8b\x85105 times (possibly zero):  Choose two integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, compute x as MEX({al,al+1,\xe2\x80\xa6,ar}), and simultaneously set al:=x,al+1:=x,\xe2\x80\xa6,ar:=x. Here, MEX of a set of integers {c1,c2,\xe2\x80\xa6,ck} is defined as the smallest non-negative integer m which does not occur in the set c.Your goal is to maximize the sum of the elements of the array a. Find the maximum sum and construct a sequence of operations that achieves this sum. Note that you don\'t need to minimize the number of operations in this sequence, you only should use no more than 5\xe2\x8b\x85105 operations in your solution." 2000
1956C "Nene\'s Magical Matrix" "constructive algorithms,greedy,math" "The magical girl Nene has an n\xc3\x97n matrix a filled with zeroes. The j-th element of the i-th row of matrix a is denoted as ai,j.She can perform operations of the following two types with this matrix:  Type 1 operation: choose an integer i between 1 and n and a permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n. Assign ai,j:=pj for all 1\xe2\x89\xa4j\xe2\x89\xa4n simultaneously.  Type 2 operation: choose an integer i between 1 and n and a permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n. Assign aj,i:=pj for all 1\xe2\x89\xa4j\xe2\x89\xa4n simultaneously. Nene wants to maximize the sum of all the numbers in the matrix n\xe2\x88\x91i=1n\xe2\x88\x91j=1ai,j. She asks you to find the way to perform the operations so that this sum is maximized. As she doesn\'t want to make too many operations, you should provide a solution with no more than 2n operations.A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1600
1956B "Nene and the Card Game" games,greedy "You and Nene are playing a card game. The deck with 2n cards is used to play this game. Each card has an integer from 1 to n on it, and each of integers 1 through n appears exactly on 2 cards. Additionally, there is a table where cards are placed during the game (initially, the table is empty).In the beginning of the game, these 2n cards are distributed between you and Nene so that each player receives n cards. After it, you and Nene alternatively take 2n turns, i.e. each person takes n turns, starting with you. On each turn:  The player whose turn is it selects one of the cards in his hand. Let x be the number on it.  The player whose turn is it receives 1 point if there is already a card with the integer x on the table (otherwise, he receives no points). After it, he places the selected card with the integer x on the table. Note that turns are made publicly: each player can see all the cards on the table at each moment.Nene is very smart so she always selects cards optimally in order to maximize her score in the end of the game (after 2n rounds). If she has several optimal moves, she selects the move that minimizes your score in the end of the game.More formally, Nene always takes turns optimally in order to maximize her score in the end of the game in the first place and to minimize your score in the end of the game in the second place.Assuming that the cards are already distributed and cards in your hand have integers a1,a2,\xe2\x80\xa6,an written on them, what is the maximum number of points you can get by taking your turns optimally?" 800
1956A "Nene\'s Game" "binary search,brute force,data structures,games,greedy" "Nene invented a new game based on an increasing sequence of integers a1,a2,\xe2\x80\xa6,ak.In this game, initially n players are lined up in a row. In each of the rounds of this game, the following happens:  Nene finds the a1-th, a2-th, \xe2\x80\xa6, ak-th players in a row. They are kicked out of the game simultaneously. If the i-th player in a row should be kicked out, but there are fewer than i players in a row, they are skipped. Once no one is kicked out of the game in some round, all the players that are still in the game are declared as winners.For example, consider the game with a=[3,5] and n=5 players. Let the players be named player A, player B, \xe2\x80\xa6, player E in the order they are lined up initially. Then,   Before the first round, players are lined up as ABCDE. Nene finds the 3-rd and the 5-th players in a row. These are players C and E. They are kicked out in the first round.  Now players are lined up as ABD. Nene finds the 3-rd and the 5-th players in a row. The 3-rd player is player D and there is no 5-th player in a row. Thus, only player D is kicked out in the second round.  In the third round, no one is kicked out of the game, so the game ends after this round.  Players A and B are declared as the winners. Nene has not yet decided how many people would join the game initially. Nene gave you q integers n1,n2,\xe2\x80\xa6,nq and you should answer the following question for each 1\xe2\x89\xa4i\xe2\x89\xa4q independently:  How many people would be declared as winners if there are ni players in the game initially?" 800
1955H "The Most Reckless Defense" "bitmasks,brute force,constructive algorithms,dp,flows,graph matchings,shortest paths" "You are playing a very popular Tower Defense game called ""Runnerfield 2"". In this game, the player sets up defensive towers that attack enemies moving from a certain starting point to the player\'s base.You are given a grid of size n\xc3\x97m, on which k towers are already placed and a path is laid out through which enemies will move. The cell at the intersection of the x-th row and the y-th column is denoted as (x,y).Each second, a tower deals pi units of damage to all enemies within its range. For example, if an enemy is located at cell (x,y) and a tower is at (xi,yi) with a range of r, then the enemy will take damage of pi if (x\xe2\x88\x92xi)2+(y\xe2\x88\x92yi)2\xe2\x89\xa4r2.Enemies move from cell (1,1) to cell (n,m), visiting each cell of the path exactly once. An enemy instantly moves to an adjacent cell horizontally or vertically, but before doing so, it spends one second in the current cell. If its health becomes zero or less during this second, the enemy can no longer move. The player loses if an enemy reaches cell (n,m) and can make one more move.By default, all towers have a zero range, but the player can set a tower\'s range to an integer r (r>0), in which case the health of all enemies will increase by 3r. However, each r can only be used for at most one tower.Suppose an enemy has a base health of h units. If the tower ranges are 2, 4, and 5, then the enemy\'s health at the start of the path will be h+32+34+35=h+9+81+243=h+333. The choice of ranges is made once before the appearance of enemies and cannot be changed after the game starts.Find the maximum amount of base health h for which it is possible to set the ranges so that the player does not lose when an enemy with health h passes through (without considering the additions for tower ranges)." 2300
1955G "GCD on a grid" "brute force,dfs and similar,dp,implementation,math,number theory" "Not long ago, Egor learned about the Euclidean algorithm for finding the greatest common divisor of two numbers. The greatest common divisor of two numbers a and b is the largest number that divides both a and b without leaving a remainder. With this knowledge, Egor can solve a problem that he once couldn\'t.Vasily has a grid with n rows and m columns, and the integer aij is located at the intersection of the i-th row and the j-th column. Egor wants to go from the top left corner (at the intersection of the first row and the first column) to the bottom right corner (at the intersection of the last row and the last column) and find the greatest common divisor of all the numbers along the path. He is only allowed to move down and to the right. Egor has written down several paths and obtained different GCD values. He became interested in finding the maximum possible GCD.Unfortunately, Egor is tired of calculating GCDs, so he asks for your help in finding the maximum GCD of the integers along the path from the top left corner to the bottom right corner of the grid." 1900
1955F "Unfair Game" dp,games,greedy,math,schedules "Alice and Bob gathered in the evening to play an exciting game on a sequence of n integers, each integer of the sequence doesn\'t exceed 4. The rules of the game are too complex to describe, so let\'s just describe the winning condition \xe2\x80\x94 Alice wins if the bitwise XOR of all the numbers in the sequence is non-zero; otherwise, Bob wins.The guys invited Eve to act as a judge. Initially, Alice and Bob play with n numbers. After one game, Eve removes one of the numbers from the sequence, then Alice and Bob play with n\xe2\x88\x921 numbers. Eve removes one number again, after which Alice and Bob play with n\xe2\x88\x922 numbers. This continues until the sequence of numbers is empty.Eve seems to think that in such a game, Alice almost always wins, so she wants Bob to win as many times as possible. Determine the maximum number of times Bob can win against Alice if Eve removes the numbers optimally." 1800
1955E "Long Inversions" "brute force,greedy,implementation,sortings" "A binary string s of length n is given. A binary string is a string consisting only of the characters \'1\' and \'0\'.You can choose an integer k (1\xe2\x89\xa4k\xe2\x89\xa4n) and then apply the following operation any number of times: choose k consecutive characters of the string and invert them, i.e., replace all \'0\' with \'1\' and vice versa.Using these operations, you need to make all the characters in the string equal to \'1\'.For example, if n=5, s=00100, you can choose k=3 and proceed as follows:   choose the substring from the 1-st to the 3-rd character and obtain s=11000;  choose the substring from the 3-rd to the 5-th character and obtain s=11111; Find the maximum value of k for which it is possible to make all the characters in the string equal to \'1\' using the described operations. Note that the number of operations required to achieve this is not important." 1700
1955D "Inaccurate Subsequence Search" "data structures,two pointers" "Maxim has an array a of n integers and an array b of m integers (m\xe2\x89\xa4n).Maxim considers an array c of length m to be good if the elements of array c can be rearranged in such a way that at least k of them match the elements of array b. For example, if b=[1,2,3,4] and k=3, then the arrays [4,1,2,3] and [2,3,4,5] are good (they can be reordered as follows: [1,2,3,4] and [5,2,3,4]), while the arrays [3,4,5,6] and [3,4,3,4] are not good.Maxim wants to choose every subsegment of array a of length m as the elements of array c. Help Maxim count how many selected arrays will be good.In other words, find the number of positions 1\xe2\x89\xa4l\xe2\x89\xa4n\xe2\x88\x92m+1 such that the elements al,al+1,\xe2\x80\xa6,al+m\xe2\x88\x921 form a good array." 1400
1955C "Inhabitant of the Deep Sea" greedy,implementation,math "n ships set out to explore the depths of the ocean. The ships are numbered from 1 to n and follow each other in ascending order; the i-th ship has a durability of ai.The Kraken attacked the ships k times in a specific order. First, it attacks the first of the ships, then the last, then the first again, and so on.Each attack by the Kraken reduces the durability of the ship by 1. When the durability of the ship drops to 0, it sinks and is no longer subjected to attacks (thus the ship ceases to be the first or last, and the Kraken only attacks the ships that have not yet sunk). If all the ships have sunk, the Kraken has nothing to attack and it swims away.For example, if n=4, k=5, and a=[1,2,4,3], the following will happen:  The Kraken attacks the first ship, its durability becomes zero and now a=[2,4,3];  The Kraken attacks the last ship, now a=[2,4,2];  The Kraken attacks the first ship, now a=[1,4,2];  The Kraken attacks the last ship, now a=[1,4,1];  The Kraken attacks the first ship, its durability becomes zero and now a=[4,1]. How many ships were sunk after the Kraken\'s attack?" 1300
1955B "Progressive Square" "constructive algorithms,data structures,implementation,sortings" "A progressive square of size n is an n\xc3\x97n matrix. Maxim chooses three integers a1,1, c, and d and constructs a progressive square according to the following rules:ai+1,j=ai,j+cai,j+1=ai,j+dFor example, if n=3, a1,1=1, c=2, and d=3, then the progressive square looks as follows:(1473695811)Last month Maxim constructed a progressive square and remembered the values of n, c, and d. Recently, he found an array b of n2 integers in random order and wants to make sure that these elements are the elements of that specific square.It can be shown that for any values of n, a1,1, c, and d, there exists exactly one progressive square that satisfies all the rules." 1000
1955A "Yogurt Sale" math "The price of one yogurt at the ""Vosmiorochka"" store is a burles, but there is a promotion where you can buy two yogurts for b burles.Maxim needs to buy exactly n yogurts. When buying two yogurts, he can choose to buy them at the regular price or at the promotion price.What is the minimum amount of burles Maxim should spend to buy n yogurts?" 800
1954F "Unique Strings" combinatorics,dp,math "Let\'s say that two strings a and b are equal if you can get the string b by cyclically shifting string a. For example, the strings 0100110 and 1100100 are equal, while 1010 and 1100 are not.You are given a binary string s of length n. Its first c characters are 1-s, and its last n\xe2\x88\x92c characters are 0-s.In one operation, you can replace one 0 with 1.Calculate the number of unique strings you can get using no more than k operations. Since the answer may be too large, print it modulo 109+7." 3100
1954E "Chain Reaction" "binary search,data structures,dsu,greedy,implementation,math,number theory" "There are n monsters standing in a row. The i-th monster has ai health points.Every second, you can choose one alive monster and launch a chain lightning at it. The lightning deals k damage to it, and also spreads to the left (towards decreasing i) and to the right (towards increasing i) to alive monsters, dealing k damage to each. When the lightning reaches a dead monster or the beginning/end of the row, it stops. A monster is considered alive if its health points are strictly greater than 0.For example, consider the following scenario: there are three monsters with health equal to [5,2,7], and k=3. You can kill them all in 4 seconds:  launch a chain lightning at the 3-rd monster, then their health values are [2,\xe2\x88\x921,4];  launch a chain lightning at the 1-st monster, then their health values are [\xe2\x88\x921,\xe2\x88\x921,4];  launch a chain lightning at the 3-rd monster, then their health values are [\xe2\x88\x921,\xe2\x88\x921,1];  launch a chain lightning at the 3-th monster, then their health values are [\xe2\x88\x921,\xe2\x88\x921,\xe2\x88\x922]. For each k from 1 to max(a1,a2,\xe2\x80\xa6,an), calculate the minimum number of seconds it takes to kill all the monsters." 2200
1954D "Colored Balls" combinatorics,dp,math,sortings "There are balls of n different colors; the number of balls of the i-th color is ai.The balls can be combined into groups. Each group should contain at most 2 balls, and no more than 1 ball of each color.Consider all 2n sets of colors. For a set of colors, let\'s denote its value as the minimum number of groups the balls of those colors can be distributed into. For example, if there are three colors with 3, 1 and 7 balls respectively, they can be combined into 7 groups (and not less than 7), so the value of that set of colors is 7.Your task is to calculate the sum of values over all 2n possible sets of colors. Since the answer may be too large, print it modulo 998244353." 1800
1954C "Long Multiplication" "greedy,math,number theory" "You are given two integers x and y of the same length, consisting of digits from 1 to 9.You can perform the following operation any number of times (possibly zero): swap the i-th digit in x and the i-th digit in y.For example, if x=73 and y=31, you can swap the 2-nd digits and get x=71 and y=33.Your task is to maximize the product of x and y using the aforementioned operation any number of times. If there are multiple answers, print any of them." 1200
1954B "Make It Ugly" implementation,math "Let\'s call an array a beautiful if you can make all its elements the same by using the following operation an arbitrary number of times (possibly, zero):   choose an index i (2\xe2\x89\xa4i\xe2\x89\xa4|a|\xe2\x88\x921) such that ai\xe2\x88\x921=ai+1, and replace ai with ai\xe2\x88\x921. You are given a beautiful array a1,a2,\xe2\x80\xa6,an. What is the minimum number of elements you have to remove from it in order for it to stop being beautiful? Swapping elements is prohibited. If it is impossible to do so, then output -1." 1200
1954A "Painting the Ribbon" "constructive algorithms,greedy,math" "Alice and Bob have bought a ribbon consisting of n parts. Now they want to paint it.First, Alice will paint every part of the ribbon into one of m colors. For each part, she can choose its color arbitrarily.Then, Bob will choose at most k parts of the ribbon and repaint them into the same color (he chooses the affected parts and the color arbitrarily).Bob would like all parts to have the same color. However, Alice thinks that this is too dull, so she wants to paint the ribbon in such a way that Bob cannot make all parts have the same color.Is it possible to paint the ribbon in such a way?" 900
1953A "Accuracy-Preserving Summation Algorithm" "*special problem" "In the classic high-performance computing domain (HPC), the vast majority of computations are conducted in double-precision 64-bit floating-point numbers (fp64, double-precision, IEEE-754 binary64). The rise of Deep Neural Networks (DNNs) resulted in hardware (HW) capable of processing 16-bit floating point numbers (fp16, half precision, IEEE-754 binary16) up to 16 times faster in terms of floating-point operations per second (flops) and up to 4 times faster in terms of memory bandwidth (BW). At the same time, the short mantissa and exponent for fp16 numbers lead to a very fast loss of precision of computations, producing wrong computational results without any option to recover them in reduction operations of size greater than approximately 2000. As the typical problem size in HPC is much larger than 2000, this makes fp16 computations almost useless. To surmount this major roadblock, smarter algorithms for reduction operations are needed.Description. There is a sequence of floating-point numbers stored in IEEE-754 binary64 (double precision, fp64) format xi of length N. The sequence needs to be summed up to S=x1+x2+\xe2\x80\xa6+xN. As professional computer equipment with native support for fp16 is usually unavailable to the general audience, we propose to do operations in a simplified simulated environment, that is, we do computations in fp64 format with mantissa and exponent cut to the range admissible in fp16. In particular, small values that do not fit fp16 admissible range turn into zeros, while excessively large values turn into infinities. Objective. Your objective is to sum up as many sequences as possible as fast as possible and as accurately as possible. Please note that you may do summation in fp64 format, but the summation process would be slow though accurate. If you do plain summation in fp16 format, it can be fast, but inaccurate, especially for larger sequences." -999
1952J "Help, what does it mean to be ""Based""" "brute force,constructive algorithms,expression parsing,implementation,sortings" "InputSup, gimme a single integer x (1\xe2\x89\xa4x\xe2\x89\xa44) homie uwu :3OutputIf x=1, spit out some based code that, like when ya feed it two integers a and b, it hands over their sum.If x=2, slap some based code that takes an integer a and returns its absolute value like magic, no cap.If x=3, check this out: blaze some based code that grabs an integer n (1\xe2\x89\xa4n\xe2\x89\xa450) and an array a of n distinct integers, then flexes the maximum value real quick.If x=4, toss me some based code that snatches an integer n (1\xe2\x89\xa4n\xe2\x89\xa450), an array a of n distinct integers and an integer k (1\xe2\x89\xa4k\xe2\x89\xa4n), then nails down that k-th largest value in the array. Get it, fam!ExamplesInputCopy1OutputCopyyoink ayoink b*slaps a on top of b*yeet bgo touch some grassInputCopy2OutputCopyyoink abruh b is lowkey just 0rip this b fell off by avibe check a ratios bsimp for 7bruh a is lowkey just byeet ago touch some grassInputCopy3OutputCopyyoink nyoink abruh m is lowkey just a[0]bruh i is lowkey just 1vibe check n ratios isimp for 9yeet mgo touch some grassvibe check a[i] ratios mbruh m is lowkey just a[i]*slaps 1 on top of i*simp for 5InputCopy4OutputCopy NoteSlide into the ""My Submissions"" page and vibe check ur code by clicking on its ID. You\'ll see just how based or cringe it is." -999
1952I "Dark Matter" bitmasks,geometry "View the statement as a PDF." -999
1952H Palindrome implementation,strings "A palindrome is a string that reads the same in both directions, for example z, uwu, or moom." -999
1952G "Mathematician Takeover" "binary search,dfs and similar,math" "A mathematician grabbed my computer as I was preparing this problem, deleted the statement, and changed the samples to fit his liking. The model solution and input/output format are still correct, but the samples are wrong. I\'ve partially fixed the problem so that when you submit, it will be tested against the correct version of the problem. However, I can\'t fix the samples below. As a computer scientist, can you solve the correct problem?" -999
1952F Grid "brute force" "InputThe input contains 21 lines, each containing 21 characters 0 or 1.ExampleInputCopy111111101011101111111100000100011001000001101110101101001011101101110101100101011101101110101001001011101100000100111101000001111111101010101111111000000000001100000000111100101111110011101000111010101100110101111101101101001000011001001000001000011000111101110000111001011000000001001001111100111111100001101010000100000100010010100111101110100110110011100101110101100000100010101110101010110000100100000101000011001001111111101011111111100OutputCopy12" -999
1952E "Sweep Line" combinatorics,games,math "Be careful not to make a mistake. You might have to start all over again.\xe2\x80\x94 Someone, probably" -999
1952D "Are You a Procrastinator?" implementation ! -999
1952C "They Have Fooled" "brute force,schedules"  -999
1952B "Is it stated?" strings "InputThe first line contains an integer t (1\xe2\x89\xa4t\xe2\x89\xa4100) \xe2\x80\x94 the number of testcases.The following t lines each contain a string of length at most 100 consisting of lowercase English letters. OutputFor each test case, output ""YES"" or ""NO"", denoting the answer.ExampleInputCopy10isitstatedsubmitacacceptedwawronganswertletimelimitexceededOutputCopyNOYESNOYESNONONONONOYES" -999
1952A "Are You a Robot, Again?" strings  -999
1951I "Growing Trees" "binary search,constructive algorithms,flows,graphs,greedy" "wowaka ft. Hatsune Miku - Ura-Omote Lovers\xe0\xb6\x9eYou are given an undirected connected simple graph with n nodes and m edges, where edge i connects node ui and vi, with two positive parameters ai and bi attached to it. Additionally, you are also given an integer k.A non-negative array x with size m is called a k-spanning-tree generator if it satisfies the following:   Consider the undirected multigraph with n nodes where edge i is cloned xi times (i.e. there are xi edges connecting ui and vi). It is possible to partition the edges of this graph into k spanning trees, where each edge belongs to exactly one spanning tree\xe2\x80\xa0. The cost of such array x is defined as \xe2\x88\x91mi=1aix2i+bixi. Find the minimum cost of a k-spanning-tree generator.\xe2\x80\xa0 A spanning tree of a (multi)graph is a subset of the graph\'s edges that form a tree connecting all vertices of the graph." 3200
1951H "Thanos Snap" "binary search,dp,games,greedy,trees" "Piotr Rubik - Psalm dla Ciebie\xe0\xb6\x9eThere is an array a of size 2k for some positive integer k, which is initially a permutation of values from 1 to 2k. Alice and Bob play the following game on the array a. First, a value t between 1 and k is shown to both Alice and Bob. Then, for exactly t turns, the following happens:   Alice either does nothing, or chooses two distinct elements of the array a and swaps them.  Bob chooses either the left half or the right half of the array a and erases it. The score of the game is defined as the maximum value in a after all t turns have been played. Alice wants to maximize this score, while Bob wants to minimize it.You need to output k numbers: the score of the game if both Alice and Bob play optimally for t from 1 to k." 3200
1951G "Clacking Balls" combinatorics,math,probabilities "Rammstein - Ausl\xc3\xa4nder\xe0\xb6\x9eThere are m baskets placed along a circle, numbered from 1 to m in clockwise order (basket m is next to basket 1). Furthermore, there are n balls, where ball i is initially placed in basket ai, and no basket contains more than one ball.Alice is allowed to perform the following operation, which always takes exactly one second whether you move/throw a ball or not:   Alice chooses an integer i between 1 and n uniformly at random.  If ball i was thrown away before, do nothing.  Otherwise, ball i is moved from the basket currently containing it to the next basket (in clockwise order). If the target basket currently contains another ball j, throw ball j away. She repeats this operation until there is exactly one ball left. Calculate the expected time needed (in seconds) for Alice to end the process.It can be proven that the answer can be represented as a rational number pq with coprime p and q. You need to output p\xe2\x8b\x85q\xe2\x88\x921mod109+7. It can be proven that 109+7\xe2\x88\xa4q." 3100
1951F "Inversion Composition" "constructive algorithms,data structures,greedy" "My Chemical Romance - Disenchanted\xe0\xb6\x9eYou are given a permutation p of size n, as well as a non-negative integer k. You need to construct a permutation q of size n such that inv(q)+inv(q\xe2\x8b\x85p)=k\xe2\x80\xa0\xe2\x80\xa1, or determine if it is impossible to do so.\xe2\x80\xa0 For two permutations p and q of the same size n, the permutation w=q\xe2\x8b\x85p is such that wi=qpi for all 1\xe2\x89\xa4i\xe2\x89\xa4n.\xe2\x80\xa1 For a permutation p of size n, the function inv(p) returns the number of inversions of p, i.e. the number of pairs of indices 1\xe2\x89\xa4i<j\xe2\x89\xa4n such that pi>pj." 2500
1951E "No Palindromes" "brute force,constructive algorithms,divide and conquer,greedy,hashing,implementation,math,strings" "Christopher Tin ft. Soweto Gospel Choir - Baba Yetu\xe0\xb6\x9eYou are given a string s consisting of lowercase Latin characters. You need to partition\xe2\x80\xa0 this string into some substrings, such that each substring is not a palindrome\xe2\x80\xa1.\xe2\x80\xa0 A partition of a string s is an ordered sequence of some k strings t1,t2,\xe2\x80\xa6,tk, such that t1+t2+\xe2\x80\xa6+tk=s, where + here represents the concatenation operation.\xe2\x80\xa1 A string s is considered a palindrome if it reads the same backwards as forwards. For example, racecar, abccba, and a are palindromes, but ab, dokibird, and kurosanji are not." 2000
1951D "Buying Jewels" "constructive algorithms,greedy,math" "Nightwish feat. Jonsu - Er\xc3\xa4maan Viimeinen\xe0\xb6\x9eAlice has n coins and wants to shop at Bob\'s jewelry store. Today, although Bob has not set up the store yet, Bob wants to make sure Alice will buy exactly k jewels. To set up the store, Bob can erect at most 60 stalls (each containing an unlimited amount of jewels) and set the price per jewel for each stall to be an integer number of coins between 1 and 1018.Fortunately, Bob knows that Alice buys greedily: and she will go to stall 1, buy as many jewels as possible, then go to stall 2, buy as many jewels as possible, and so on until the last stall. Knowing this, Bob can choose the number of stalls to set up, as well as set the price for each stall so that Alice buys exactly k jewels. Help Bob fulfill the task, or determine if it is impossible to do so.Note that Alice does not need to spend all her coins." 2000
1951C "Ticket Hoarding" greedy,math,sortings "Ma\xc3\xaetre Gims - Est-ce que tu m\'aimes ?\xe0\xb6\x9eAs the CEO of a startup company, you want to reward each of your k employees with a ticket to the upcoming concert. The tickets will be on sale for n days, and by some time travelling, you have predicted that the price per ticket at day i will be ai. However, to prevent ticket hoarding, the concert organizers have implemented the following measures:  A person may purchase no more than m tickets per day.  If a person purchases x tickets on day i, all subsequent days (i.e. from day i+1 onwards) will have their prices per ticket increased by x. For example, if a=[1,3,8,4,5] and you purchase 2 tickets on day 1, they will cost 2 in total, and the prices from day 2 onwards will become [5,10,6,7]. If you then purchase 3 more tickets on day 2, they will cost in total an additional 15, and the prices from day 3 onwards will become [13,9,10].Find the minimum spending to purchase k tickets." 1400
1951B "Battle Cows" "binary search,data structures,greedy" "The HU - Shireg Shireg\xe0\xb6\x9eThere are n cows participating in a coding tournament. Cow i has a Cowdeforces rating of ai (all distinct), and is initially in position i. The tournament consists of n\xe2\x88\x921 matches as follows:   The first match is between the cow in position 1 and the cow in position 2.  Subsequently, each match i is between the cow in position i+1 and the winner of match i\xe2\x88\x921.  In each match, the cow with the higher Cowdeforces rating wins and proceeds to the next match. You are the owner of cow k. For you, winning the tournament is not important; rather, you want your cow to win in as many matches as possible. As an acquaintance of the tournament organizers, you can ask them to swap the position of your cow with another cow only once, or you can choose to do nothing.Find the maximum number of wins your cow can achieve." 1200
1951A "Dual Trigger" "constructive algorithms,greedy,math" "Ng\xe1\xbb\x8dt - L\xe1\xba\xa6N CU\xe1\xbb\x90I (\xc4\x91i b\xc3\xaan em x\xc3\xb3t xa ng\xc6\xb0\xe1\xbb\x9di \xc6\xa1i)\xe0\xb6\x9eThere are n lamps numbered 1 to n lined up in a row, initially turned off. You can perform the following operation any number of times (possibly zero):   Choose two non-adjacent\xe2\x80\xa0 lamps that are currently turned off, then turn them on. Determine whether you can reach configuration s, where si=1 means the i-th lamp is turned on, and si=0 otherwise.\xe2\x80\xa0 Only lamp i and i+1 are adjacent for all 1\xe2\x89\xa4i<n. Note that lamp n and 1 are not adjacent when n\xe2\x89\xa02." 900
1950G "Shuffling Songs" "bitmasks,dfs and similar,dp,graphs,hashing,implementation,strings" "Vladislav has a playlist consisting of n songs, numbered from 1 to n. Song i has genre gi and writer wi. He wants to make a playlist in such a way that every pair of adjacent songs either have the same writer or are from the same genre (or both). He calls such a playlist exciting. Both gi and wi are strings of length no more than 104.It might not always be possible to make an exciting playlist using all the songs, so the shuffling process occurs in two steps. First, some amount (possibly zero) of the songs are removed, and then the remaining songs in the playlist are rearranged to make it exciting.Since Vladislav doesn\'t like when songs get removed from his playlist, he wants the making playlist to perform as few removals as possible. Help him find the minimum number of removals that need to be performed in order to be able to rearrange the rest of the songs to make the playlist exciting." 1900
1950F "0, 1, 2, Tree!" "bitmasks,brute force,greedy,implementation,trees" "Find the minimum height of a rooted tree\xe2\x80\xa0 with a+b+c vertices that satisfies the following conditions:   a vertices have exactly 2 children,  b vertices have exactly 1 child, and  c vertices have exactly 0 children.  If no such tree exists, you should report it. The tree above is rooted at the top vertex, and each vertex is labeled with the number of children it has. Here a=2, b=1, c=3, and the height is 2. \xe2\x80\xa0 A rooted tree is a connected graph without cycles, with a special vertex called the root. In a rooted tree, among any two vertices connected by an edge, one vertex is a parent (the one closer to the root), and the other one is a child. The distance between two vertices in a tree is the number of edges in the shortest path between them. The height of a rooted tree is the maximum distance from a vertex to the root." 1700
1950E "Nearly Shortest Repeating Substring" "brute force,implementation,number theory,strings" "You are given a string s of length n consisting of lowercase Latin characters. Find the length of the shortest string k such that several (possibly one) copies of k can be concatenated together to form a string with the same length as s and, at most, one different character.More formally, find the length of the shortest string k such that c=k+\xe2\x8b\xaf+k\xe2\x8f\x9fx times for some positive integer x, strings s and c has the same length and ci\xe2\x89\xa0si for at most one i (i.e. there exist 0 or 1 such positions)." 1500
1950D "Product of Binary Decimals" "brute force,dp,implementation,number theory" "Let\'s call a number a binary decimal if it is a positive integer and all digits in its decimal notation are either 0 or 1. For example, 1010111 is a binary decimal, while 10201 and 787788 are not.Given a number n, you are asked whether or not it is possible to represent n as a product of some (not necessarily distinct) binary decimals." 1100
1950C "Clock Conversion" implementation,math "Given the time in 24-hour format, output the equivalent time in 12-hour format.   24-hour format divides the day into 24 hours from 00 to 23, each of which has 60 minutes from 00 to 59.  12-hour format divides the day into two halves: the first half is AM, and the second half is PM. In each half, the hours are numbered in the order 12,01,02,03,\xe2\x80\xa6,11. Each hour has 60 minutes numbered from 00 to 59." 800
1950B Upscaling implementation "You are given an integer n. Output a 2n\xc3\x972n checkerboard made of 2\xc3\x972 squares alternating \'#\' and \'.\', with the top-left cell being \'#\'.  The picture above shows the answers for n=1,2,3,4." 800
1950A "Stair, Peak, or Neither?" implementation "You are given three digits a, b, and c. Determine whether they form a stair, a peak, or neither.   A stair satisfies the condition a<b<c.  A peak satisfies the condition a<b>c." 800
1949K "Make Triangle" "constructive algorithms,math" "You are given n positive integers x1,x2,\xe2\x80\xa6,xn and three positive integers na,nb,nc satisfying na+nb+nc=n. You want to split the n positive integers into three groups, so that: The first group contains na numbers, the second group contains nb numbers, the third group contains nc numbers. Let sa be the sum of the numbers in the first group, sb be the sum in the second group, and sc be the sum in the third group. Then sa,sb,sc are the sides of a triangle with positive area.Determine if this is possible. If this is possible, find one way to do so." 2800
1949J "Amanda the Amoeba" "graphs,implementation,trees,two pointers" "This problem has an attachment. You can use it to simulate and visualize the movements of the amoeba.Amoeba Amanda lives inside a rectangular grid of square pixels. Her body occupies some of these pixels. Other pixels may be either free or blocked. Amanda moves across the grid using the so-called amoeboid movement. In each step of such a movement, her body first shrinks by one pixel (one pixel of the body is removed and becomes free), and then grows at a different place (one previously-free pixel is added to the body).To prevent structural damage, Amanda\'s body always occupies a connected region of pixels, which means that any pair of pixels forming the body can be connected by a sequence of adjacent pixels without ever leaving the body. Two pixels are considered adjacent if they share a common side (each pixel has at most 4 neighbours). The body remains connected even during the movement, including the moment after removing a pixel and before adding another one.Your task is to help Amanda find her way around. Given her initial position and desired final position, suggest a sequence of valid moves leading from the former to the latter.  Illustration of sample 1: The filled shape is the initial position, the dotted region is the final position." 2600
1949I Disks "dfs and similar,geometry,graph matchings,graphs" "You are given n disks in the plane. The center of each disk has integer coordinates, and the radius of each disk is a positive integer. No two disks overlap in a region of positive area, but it is possible for disks to be tangent to each other.Your task is to determine whether it is possible to change the radii of the disks in such a way that:   Disks that were tangent to each other remain tangent to each other.  No two disks overlap in a region of positive area.  The sum of all radii strictly decreases.  The new radii are allowed to be arbitrary positive real numbers. The centers of the disks cannot be changed." 1800
1949H "Division Avoidance" greedy,math "A newly discovered organism can be represented as a set of cells on an infinite grid. There is a coordinate system on the grid such that each cell has two integer coordinates x and y. A cell with coordinates x=a and y=b will be denoted as (a,b).Initially, the organism consists of a single cell (0,0). Then zero or more divisions can happen. In one division, a cell (a,b) is removed and replaced by two cells (a+1,b) and (a,b+1).For example, after the first division, the organism always consists of two cells (1,0) and (0,1), and after the second division, it is either the three cells (2,0), (1,1) and (0,1), or the three cells (1,0), (1,1) and (0,2).A division of a cell (a,b) can only happen if the cells (a+1,b) and (a,b+1) are not yet part of the organism. For example, the cell (1,0) cannot divide if the organism currently consists of the three cells (1,0), (1,1) and (0,2), since the cell (1,1) that would be one of the results of this division is already part of the organism.You are given a set of forbidden cells (ci,di). Is it possible for the organism to contain none of those cells after zero or more divisions?" 3100
1949G Scooter graphs,greedy "The Czech Technical University campus consists of n buildings, indexed from 1 to n. In each building, there can be a math class scheduled, or a computer science class, or neither (but not both). Additionally, in each building, there is at most one professor, and each professor is either an expert in mathematics or in computer science.As an intern at University Express Inc., your job is to quickly transport the professors to their classes. For this, you have been granted a brand new two-person scooter, able to accommodate yourself, plus at most one passenger.Initially, you are the only person on the scooter. When you arrive at a building, you may drop off or pick up professors to/from that building. However, in order to improve the efficiency of your task, you are allowed to drive to each of the n buildings at most once, in the order of your choice (you can also decide where to start the itinerary). After the end of your itinerary, in each building where a math class is scheduled, there must be a professor expert in math, and in each building where a computer science class is scheduled, there must be a professor expert in computer science.Devise an itinerary that makes it possible to teach all classes." 2300
1949F Dating greedy,sortings,trees "You are the developer of a dating app which ignores gender completely. The app has n users, indexed from 1 to n. Each user\'s profile features a list of the activities they enjoy doing. There are m possible activities, indexed from 1 to m.A match between two users is good if they share at least one activity and, at the same time, both of them like at least one activity that the other user does not like.Find a good match if it exists." 2200
1949E "Damage per Second" "brute force,math" "You just created a new character in your favourite role-playing game and now have to decide how to skill him.  The two skill attributes to be chosen are: damage per hit and hits per second. Damage per hit is the amount of damage you deal with a single hit, while hits per second is the number of hits you can make in one second. Initially, both skill attributes are set at 0. You have k skill points to distribute as you want; in other words, you can choose the values of the two skills so that they are positive integers with sum at most k. The tutorial of the game (the boring part you want to finish as soon as possible) consists of n monsters to be killed one after the other. The i-th monster has hi health points, i.e., it dies after you have inflicted at least hi damage.How can you assign the two skill attributes to minimize the time necessary to kill all the n monsters?" 2900
1949D "Funny or Scary?" "constructive algorithms" "You are designing a new video game. It has n scenarios, which the player may play in any order, but each scenario must be played exactly once. When a player switches from a scenario to another scenario, the game shows a specially crafted transition video to make it all feel part of one big story. This video is specific to a pair of scenarios, but not to their order, in other words, the video playing when switching from scenario a to scenario b is the same as the video playing when switching from scenario b to scenario a. Therefore, you need to create n(n\xe2\x88\x921)2 different transition videos, one for each possible pair of different scenarios.Each transition video can be either funny or scary. It is boring to see too many funny videos or too many scary videos in a row. Therefore, your goal is to create the videos in such a way that no matter in which order does the player approach the scenarios, they will never see more than \xe2\x8c\x883n4\xe2\x8c\x89 transition videos of the same type in a row.You have already come up with ideas for at most \xe2\x8c\x8an2\xe2\x8c\x8b of the transition videos, and therefore already know if those will be funny or scary. Now you need to choose funny or scary for all other transition videos in such a way that the above requirement is satisfied." 2600
1949C "Annual Ants\' Gathering" "dfs and similar,dp,greedy,trees" "Deep within a forest lies an ancient tree, home to nn ants living in nn tiny houses, indexed from 11 to nn, connected by the branches of the tree.  Once a year, all the ants need to gather to watch the EUC. For this, all ants move along the n\xe2\x88\x921n\xe2\x88\x921 branches of the tree they live on to meet at the home of one ant.However, this year the ants could not agree on where to meet and need your help to gather up. You can tell all the ants currently at house uu to move to house vv if there is a branch directly connecting those two houses. However, the ants ignore your command if there are fewer ants gathered in house vv than in house uu, i.e., if it would be easier for the ants from house vv to move. This even holds true if no ant at all is currently in house vv. You can give this kind of commands as many times as you want.Is it possible for you to gather all the ants in a single house?" 1900
1949B "Charming Meals" "binary search,brute force,greedy,sortings" "The Czech cuisine features n appetizers and n main dishes. The i-th appetizer has spiciness ai, and the i-th main dish has spiciness bi.A typical Czech meal consists of exactly one appetizer and one main dish. You want to pair up the n appetizers and n main dishes into n meals with each appetizer and each main dish being included in exactly one meal.Your meals shall surprise the diners, so you want the spiciness levels of the two parts of the same meal to be as different as possible. The charm of a meal is the difference (in absolute value) between the spiciness of the appetizer and the spiciness of the main dish. So, a meal consisting of an appetizer with spiciness x and a main dish with spiciness y has charm equal to |x\xe2\x88\x92y|.You want to maximize the minimum charm of the resulting n meals. What is the largest possible value of the minimum charm that you can achieve?" 1500
1949A Grove "brute force,dfs and similar,dp,geometry,probabilities" "You want to plant trees in a square lawn of size n\xc3\x97n whose corners have Cartesian coordinates (0,0), (n,0), (0,n), and (n,n). Trees can only be planted at locations with integer coordinates. Every tree will grow roots within a disk of radius r centered at the location where the tree was planted; such disks must be fully contained in the lawn (possibly touching the boundary of the lawn) and can only intersect each other on their boundaries.Find a configuration that maximizes the number of trees." 3300
1948G "MST with Matching" "bitmasks,brute force,dsu,graph matchings,trees" "You are given an undirected connected graph on n vertices. Each edge of this graph has a weight; the weight of the edge connecting vertices i and j is wi,j (or wi,j=0 if there is no edge between i and j). All weights are positive integers.You are also given a positive integer c.You have to build a spanning tree of this graph; i.\xe2\x80\x89e. choose exactly (n\xe2\x88\x921) edges of this graph in such a way that every vertex can be reached from every other vertex by traversing some of the chosen edges. The cost of the spanning tree is the sum of two values:  the sum of weights of all chosen edges;  the maximum matching in the spanning tree (i.\xe2\x80\x89e. the maximum size of a set of edges such that they all belong to the chosen spanning tree, and no vertex has more than one incident edge in this set), multiplied by the given integer c. Find any spanning tree with the minimum cost. Since the graph is connected, there exists at least one spanning tree." 3100
1948F "Rare Coins" combinatorics,math,probabilities "There are n bags numbered from 1 to n, the i-th bag contains ai golden coins and bi silver coins.The value of a gold coin is 1. The value of a silver coin is either 0 or 1, determined for each silver coin independently (0 with probability 12, 1 with probability 12).You have to answer q independent queries. Each query is the following:   l r \xe2\x80\x94 calculate the probability that the total value of coins in bags from l to r is strictly greater than the total value in all other bags." 2500
1948E "Clique Partition" "brute force,constructive algorithms,graphs,greedy,implementation" "You are given two integers, n and k. There is a graph on n vertices, numbered from 1 to n, which initially has no edges.You have to assign each vertex an integer; let ai be the integer on the vertex i. All ai should be distinct integers from 1 to n.After assigning integers, for every pair of vertices (i,j), you add an edge between them if |i\xe2\x88\x92j|+|ai\xe2\x88\x92aj|\xe2\x89\xa4k.Your goal is to create a graph which can be partitioned into the minimum possible (for the given values of n and k) number of cliques. Each vertex of the graph should belong to exactly one clique. Recall that a clique is a set of vertices such that every pair of vertices in it are connected with an edge.Since BledDest hasn\'t really brushed his programming skills up, he can\'t solve the problem ""given a graph, partition it into the minimum number of cliques"". So we also ask you to print the partition itself." 2100
1948D "Tandem Repeats?" "brute force,strings,two pointers" "You are given a string s, consisting of lowercase Latin letters and/or question marks.A tandem repeat is a string of an even length such that its first half is equal to its second half.A string a is a substring of a string b if a can be obtained from b by the deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.Your goal is to replace each question mark with some lowercase Latin letter in such a way that the length of the longest substring that is a tandem repeat is maximum possible." 1700
1948C "Arrow Path" "brute force,constructive algorithms,dfs and similar,dp,graphs,shortest paths" "There is a grid, consisting of 2 rows and n columns. The rows are numbered from 1 to 2 from top to bottom. The columns are numbered from 1 to n from left to right. Each cell of the grid contains an arrow pointing either to the left or to the right. No arrow points outside the grid.There is a robot that starts in a cell (1,1). Every second, the following two actions happen one after another:   Firstly, the robot moves left, right, down or up (it can\'t try to go outside the grid, and can\'t skip a move);  then it moves along the arrow that is placed in the current cell (the cell it ends up after its move). Your task is to determine whether the robot can reach the cell (2,n)." 1300
1948B "Array Fix" "brute force,dp,greedy,implementation" "You are given an integer array a of length n.You can perform the following operation any number of times (possibly zero): take any element of the array a, which is at least 10, delete it, and instead insert the digits that element consisted of in the same position, in order they appear in that element.For example:  if we apply this operation to the 3-rd element of the array [12,3,45,67], then the array becomes [12,3,4,5,67].  if we apply this operation to the 2-nd element of the array [2,10], then the array becomes [2,1,0]. Your task is to determine whether it is possible to make a sorted in non-descending order using the aforementioned operation any number of times (possibly zero). In other words, you have to determine if it is possible to transform the array a in such a way that a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4ak, where k is the current length of the array a." 1100
1948A "Special Characters" "brute force,constructive algorithms" "You are given an integer n.Your task is to build a string of uppercase Latin letters. There must be exactly n special characters in this string. Let\'s call a character special if it is equal to exactly one of its neighbors.For example, there are 6 special characters in the AAABAACC string (at positions: 1, 3, 5, 6, 7 and 8).Print any suitable string or report that there is no such string." 800
1946F "Nobody is needed" "2-sat,data structures,dfs and similar,dp" "Oleg received a permutation a of length n as a birthday present.Oleg\'s friend Nechipor asks Oleg q questions, each question is characterized by two numbers l and r, in response to the question Oleg must say the number of sets of indices (t1,t2,\xe2\x80\xa6,tk) of any length k\xe2\x89\xa51 such that:   l\xe2\x89\xa4ti\xe2\x89\xa4r for each i from 1 to k.  ti<ti+1 for each i from 1 to k\xe2\x88\x921.  ati+1 is divisible by ati for each i from 1 to k\xe2\x88\x921. Help Oleg and answer all of Nechipor\'s questions." 2500
1946E "Girl Permutation" "combinatorics,dp,math,number theory" "Some permutation of length n is guessed.You are given the indices of its prefix maximums and suffix maximums.Recall that a permutation of length k is an array of size k such that each integer from 1 to k occurs exactly once.Prefix maximums are the elements that are the maximum on the prefix ending at that element. More formally, the element ai is a prefix maximum if ai>aj for every j<i.Similarly, suffix maximums are defined, the element ai is a suffix maximum if ai>aj for every j>i.You need to output the number of different permutations that could have been guessed.As this number can be very large, output the answer modulo 109+7." 2200
1946D "Birthday Gift" "bitmasks,brute force,constructive algorithms,greedy,implementation" "Yarik\'s birthday is coming soon, and Mark decided to give him an array a of length n.Mark knows that Yarik loves bitwise operations very much, and he also has a favorite number x, so Mark wants to find the maximum number k such that it is possible to select pairs of numbers [l1,r1], [l2,r2], \xe2\x80\xa6 [lk,rk], such that:   l1=1.  rk=n.  li\xe2\x89\xa4ri for all i from 1 to k.  ri+1=li+1 for all i from 1 to k\xe2\x88\x921.  (al1\xe2\x8a\x95al1+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar1)|(al2\xe2\x8a\x95al2+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar2)|\xe2\x80\xa6|(alk\xe2\x8a\x95alk+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ark)\xe2\x89\xa4x, where \xe2\x8a\x95 denotes the operation of bitwise XOR, and | denotes the operation of bitwise OR. If such k does not exist, then output \xe2\x88\x921." 1900
1946C "Tree Cutting" "binary search,dp,greedy,implementation,trees" "You are given a tree with n vertices.Your task is to find the maximum number x such that it is possible to remove exactly k edges from this tree in such a way that the size of each remaining connected component\xe2\x80\xa0 is at least x.\xe2\x80\xa0 Two vertices v and u are in the same connected component if there exists a sequence of numbers t1,t2,\xe2\x80\xa6,tk of arbitrary length k, such that t1=v, tk=u, and for each i from 1 to k\xe2\x88\x921, vertices ti and ti+1 are connected by an edge." 1600
1946B "Maximum Sum" dp,greedy,math "You have an array a of n integers.You perform exactly k operations on it. In one operation, you select any contiguous subarray of the array a (possibly empty) and insert the sum of this subarray anywhere in the array.Your task is to find the maximum possible sum of the array after k such operations.As this number can be very large, output the answer modulo 109+7.Reminder: the remainder of a number x modulo p is the smallest non-negative y such that there exists an integer q and x=p\xe2\x8b\x85q+y." 1100
1946A "Median of an Array" greedy,implementation,sortings "You are given an array a of n integers.The median of an array q1,q2,\xe2\x80\xa6,qk is the number p\xe2\x8c\x88k2\xe2\x8c\x89, where p is the array q sorted in non-decreasing order. For example, the median of the array [9,5,1,2,6] is 5, as in the sorted array [1,2,5,6,9], the number at index \xe2\x8c\x8852\xe2\x8c\x89=3 is 5, and the median of the array [9,2,8,3] is 3, as in the sorted array [2,3,8,9], the number at index \xe2\x8c\x8842\xe2\x8c\x89=2 is 3.You are allowed to choose an integer i (1\xe2\x89\xa4i\xe2\x89\xa4n) and increase ai by 1 in one operation.Your task is to find the minimum number of operations required to increase the median of the array.Note that the array a may not necessarily contain distinct numbers." 800
1945H "GCD is Greater" "brute force,data structures,math,number theory" "In the evenings during the hike, Kirill and Anton decided to take out an array of integers a of length n from their backpack and play a game with it. The rules are as follows: Kirill chooses from 2 to (n\xe2\x88\x922) numbers and encircles them in red. Anton encircles all the remaining numbers in blue. Kirill calculates the greatest common divisor (GCD) of all the red numbers. Anton calculates the bitwise AND of all the blue numbers and adds the number x to the result. If the GCD of all the red numbers is strictly greater than the sum of the bitwise AND of all the blue numbers and the number x, then Kirill wins; otherwise, Anton wins.Help Kirill to beat Anton or tell if it\'s impossible." 2600
1945G "Cook and Porridge" "binary search,constructive algorithms,data structures,implementation" "Finally, lunchtime!n schoolchildren have lined up in a long queue at the cook\'s tent for porridge. The cook will be serving porridge for D minutes. The schoolchild standing in the i-th position in the queue has a priority of ki and eats one portion of porridge in si minutes.At the beginning of each minute of the break, the cook serves the first schoolchild in the queue one portion of porridge, after which the schoolchild goes to eat their portion. If the i-th schoolchild is served a portion at the beginning of the x-th minute, then they will return to the queue at the end of the (x+si)-th minute.When the i-th schoolchild returns to the queue, the schoolchildren at the end of the queue whose priority is strictly lower than that of the i-th schoolchild must let them pass. Thus, they will stand in the queue behind the last schoolchild whose priority is not lower than their own. That is, behind the last schoolchild j with kj\xe2\x89\xa5ki. If there is no such schoolchild in the queue, the i-th schoolchild will stand at the front of the queue.If several schoolchildren return at the same time, they will return to the queue in ascending order of their si.For example, if n=3, D=3, k=[2,3,2], and s=[2,1,3], the serving will occur as follows:  At the beginning of minute 1, the students in the queue are [1,2,3], and student 1 is served porridge;  at the beginning of minute 2, the students in the queue are [2,3], and student 2 is served porridge;  at the beginning of minute 3, the student in the queue is [3], and student 3 is served porridge;  at the end of minute 3, student 2 returns to the queue, and the queue becomes [2];  at the end of minute 3, student 1 returns to the queue, and the queue becomes [2,1], as his priority is lower. Determine the minimum number of minutes after the start of the break that each schoolchild will receive porridge at least once, or report that this will not happen within D minutes." 2500
1945F "Kirill and Mushrooms" "data structures,sortings" "As soon as everyone in the camp fell asleep, Kirill sneaked out of the tent and went to the Wise Oak to gather mushrooms.It is known that there are n mushrooms growing under the Oak, each of which has magic power vi. Kirill really wants to make a magical elixir of maximum strength from the mushrooms.The strength of the elixir is equal to the product of the number of mushrooms in it and the minimum magic power among these mushrooms. To prepare the elixir, Kirill will sequentially pick one mushroom growing under the Oak. Kirill can gather mushrooms in any order.However, it\'s not that simple. The Wise Oak informed Kirill of a permutation of numbers p from 1 to n. If Kirill picks only k mushrooms, then the magic power of all mushrooms with indices p1,p2,\xe2\x80\xa6,pk\xe2\x88\x921 will become 0. Kirill will not use mushrooms with zero magic power to prepare the elixir.Your task is to help Kirill gather mushrooms in such a way that he can brew the elixir of maximum possible strength. However, Kirill is a little scared to stay near the oak for too long, so out of all the suitable options for gathering mushrooms, he asks you to find the one with the minimum number of mushrooms.A permutation of length n is an array consisting of n different integers from 1 to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears in the array twice) and [1,3,4] is also not a permutation (n=3, but 4 appears in the array)." 1900
1945E "Binary Search" "binary search,constructive algorithms,greedy" "Anton got bored during the hike and wanted to solve something. He asked Kirill if he had any new problems, and of course, Kirill had one.You are given a permutation p of size n, and a number x that needs to be found. A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).You decided that you are a cool programmer, so you will use an advanced algorithm for the search \xe2\x80\x94 binary search. However, you forgot that for binary search, the array must be sorted.You did not give up and decided to apply this algorithm anyway, and in order to get the correct answer, you can perform the following operation no more than 2 times before running the algorithm: choose the indices i, j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) and swap the elements at positions i and j.After that, the binary search is performed. At the beginning of the algorithm, two variables l=1 and r=n+1 are declared. Then the following loop is executed:  If r\xe2\x88\x92l=1, end the loop  m=\xe2\x8c\x8ar+l2\xe2\x8c\x8b  If pm\xe2\x89\xa4x, assign l=m, otherwise r=m. The goal is to rearrange the numbers in the permutation before the algorithm so that after the algorithm is executed, pl is equal to x. It can be shown that 2 operations are always sufficient." 1700
1945D "Seraphim the Owl" dp,greedy "The guys lined up in a queue of n people, starting with person number i=1, to ask Serafim the Owl about the meaning of life. Unfortunately, Kirill was very busy writing the legend for this problem, so he arrived a little later and stood at the end of the line after the n-th person. Kirill is completely dissatisfied with this situation, so he decided to bribe some people ahead of him.For the i-th person in the queue, Kirill knows two values: ai and bi. If at the moment Kirill is standing at position i, then he can choose any position j such that j<i and exchange places with the person at position j. In this case, Kirill will have to pay him aj coins. And for each k such that j<k<i, Kirill will have to pay bk coins to the person at position k. Kirill can perform this action any number of times.Kirill is thrifty, so he wants to spend as few coins as possible, but he doesn\'t want to wait too long, so Kirill believes he should be among the first m people in line.Help Kirill determine the minimum number of coins he will have to spend in order to not wait too long." 1300
1945C "Left and Right Houses" "brute force" "In the village of Letovo, there are n houses. The villagers decided to build a big road that will divide the village into left and right sides. Each resident wants to live on either the right or the left side of the street, which is described as a sequence a1,a2,\xe2\x80\xa6,an, where aj=0 if the resident of the j-th house wants to live on the left side of the street; otherwise, aj=1.The road will pass between two houses. The houses to the left of it will be declared the left-side, and the houses to the right will be declared the right-side. More formally, let the road pass between houses i and i+1. Then the houses at positions between 1 and i will be on the left side of the street, and at positions between i+1 and n will be on the right side. The road also may pass before the first and after the last house; in this case, the entire village is declared to be either the right or left side, respectively.To make the design fair, it was decided to lay the road so that at least half of the residents on each side of the village are satisfied with the choice. That is, among x residents on one side, at least \xe2\x8c\x88x2\xe2\x8c\x89 should want to live on that side, where \xe2\x8c\x88x\xe2\x8c\x89 denotes rounding up a real number x.  To the left of the road, there will be i houses, among the corresponding aj there must be at least \xe2\x8c\x88i2\xe2\x8c\x89 zeros. To the right of the road, there will be n\xe2\x88\x92i houses, among the corresponding aj there must be at least \xe2\x8c\x88n\xe2\x88\x92i2\xe2\x8c\x89 ones. Determine after which house i the road should be laid in order to satisfy the described condition and be as close to the middle of the village as possible. Formally, among all suitable positions i, minimize |n2\xe2\x88\x92i|.If there are multiple suitable positions i with the minimum |n2\xe2\x88\x92i|, output the smaller one." 1200
1945B Fireworks "math,number theory" "One of the days of the hike coincided with a holiday, so in the evening at the camp, it was decided to arrange a festive fireworks display. For this purpose, the organizers of the hike bought two installations for launching fireworks and a huge number of shells for launching.Both installations are turned on simultaneously. The first installation launches fireworks every a minutes (i.e., after a,2\xe2\x8b\x85a,3\xe2\x8b\x85a,\xe2\x80\xa6 minutes after launch). The second installation launches fireworks every b minutes (i.e., after b,2\xe2\x8b\x85b,3\xe2\x8b\x85b,\xe2\x80\xa6 minutes after launch).Each firework is visible in the sky for m+1 minutes after launch, i.e., if a firework was launched after x minutes after the installations were turned on, it will be visible every minute from x to x+m, inclusive. If one firework was launched m minutes after another, both fireworks will be visible for one minute.What is the maximum number of fireworks that could be seen in the sky at the same time?" 900
1945A "Setting up Camp" greedy,math "The organizing committee plans to take the participants of the Olympiad on a hike after the tour. Currently, the number of tents needed to be taken is being calculated. It is known that each tent can accommodate up to 3 people.Among the participants, there are a introverts, b extroverts, and c universals:  Each introvert wants to live in a tent alone. Thus, a tent with an introvert must contain exactly one person \xe2\x80\x94 only the introvert himself.  Each extrovert wants to live in a tent with two others. Thus, the tent with an extrovert must contain exactly three people.  Each universal is fine with any option (living alone, with one other person, or with two others). The organizing committee respects the wishes of each participant very much, so they want to fulfill all of them.Tell us the minimum number of tents needed to be taken so that all participants can be accommodated according to their preferences. If it is impossible to accommodate the participants in a way that fulfills all the wishes, output \xe2\x88\x921." 800
1944B "Equal XOR" "bitmasks,constructive algorithms" "You are given an array a of length 2n, consisting of each integer from 1 to n exactly twice.You are also given an integer k (1\xe2\x89\xa4k\xe2\x89\xa4\xe2\x8c\x8an2\xe2\x8c\x8b).You need to find two arrays l and r each of length 2k such that:   l is a subset\xe2\x80\xa0 of [a1,a2,\xe2\x80\xa6an]  r is a subset of [an+1,an+2,\xe2\x80\xa6a2n]  bitwise XOR of elements of l is equal to the bitwise XOR of elements of r; in other words, l1\xe2\x8a\x95l2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95l2k=r1\xe2\x8a\x95r2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95r2k It can be proved that at least one pair of l and r always exists. If there are multiple solutions, you may output any one of them.\xe2\x80\xa0 A sequence x is a subset of a sequence y if x can be obtained by deleting several (possibly none or all) elements of y and rearranging the elements in any order. For example, [3,1,2,1], [1,2,3], [1,1] and [3,2] are subsets of [1,1,2,3] but [4] and [2,2] are not subsets of [1,1,2,3]." 1100
1944A "Destroying Bridges" graphs,greedy,math "There are n islands, numbered 1,2,\xe2\x80\xa6,n. Initially, every pair of islands is connected by a bridge. Hence, there are a total of n(n\xe2\x88\x921)2 bridges. Everule lives on island 1 and enjoys visiting the other islands using bridges. Dominater has the power to destroy at most k bridges to minimize the number of islands that Everule can reach using (possibly multiple) bridges.Find the minimum number of islands (including island 1) that Everule can visit if Dominater destroys bridges optimally." 800
1943F "Minimum Hamming Distance" dp "You are given a binary string\xe2\x80\xa0 s of length n.A binary string p of the same length n is called good if for every i (1\xe2\x89\xa4i\xe2\x89\xa4n), there exist indices l and r such that:   1\xe2\x89\xa4l\xe2\x89\xa4i\xe2\x89\xa4r\xe2\x89\xa4n  si is a mode\xe2\x80\xa1 of the string plpl+1\xe2\x80\xa6pr You are given another binary string t of length n. Find the minimum Hamming distance\xc2\xa7 between t and any good string g.\xe2\x80\xa0 A binary string is a string that only consists of characters 0 and 1.\xe2\x80\xa1 Character c is a mode of string p of length m if the number of occurrences of c in p is at least \xe2\x8c\x88m2\xe2\x8c\x89. For example, 0 is a mode of 010, 1 is not a mode of 010, and both 0 and 1 are modes of 011010.\xc2\xa7 The Hamming distance of strings a and b of length m is the number of indices i such that 1\xe2\x89\xa4i\xe2\x89\xa4m and ai\xe2\x89\xa0bi." 3500
1943E2 "MEX Game 2 (Hard Version)" "binary search,greedy,two pointers" "This is the hard version of the problem. The only difference between the two versions is the constraint on t, m and the sum of m. You can make hacks only if both versions of the problem are solved.Alice and Bob play yet another game on an array a of size n. Alice starts with an empty array c. Both players take turns playing, with Alice starting first.On Alice\'s turn, she picks one element from a, appends that element to c, and then deletes it from a.On Bob\'s turn, he picks at most k elements from a, and then deletes it from a. The game ends when the array a is empty. Alice\'s score is defined to be the MEX\xe2\x80\xa0 of c. Alice wants to maximize her score while Bob wants to minimize it. Find Alice\'s final score if both players play optimally.The array will be given in compressed format. Instead of giving the elements present in the array, we will be giving their frequencies. Formally, you will be given m, the maximum element in the array, and then m+1 integers f0,f1,\xe2\x80\xa6,fm, where fi represents the number of times i occurs in the array a.\xe2\x80\xa0 The MEX (minimum excludant) of an array of integers is defined as the smallest non-negative integer which does not occur in the array. For example:   The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0, 1, 2 and 3 belong to the array, but 4 does not." 3300
1943E1 "MEX Game 2 (Easy Version)" "binary search,brute force,greedy" "This is the easy version of the problem. The only difference between the two versions is the constraint on t, m and the sum of m. You can make hacks only if both versions of the problem are solved.Alice and Bob play yet another game on an array a of size n. Alice starts with an empty array c. Both players take turns playing, with Alice starting first.On Alice\'s turn, she picks one element from a, appends that element to c, and then deletes it from a.On Bob\'s turn, he picks at most k elements from a, and then deletes it from a. The game ends when the array a is empty. Alice\'s score is defined to be the MEX\xe2\x80\xa0 of c. Alice wants to maximize her score while Bob wants to minimize it. Find Alice\'s final score if both players play optimally.The array will be given in compressed format. Instead of giving the elements present in the array, we will be giving their frequencies. Formally, you will be given m, the maximum element in the array, and then m+1 integers f0,f1,\xe2\x80\xa6,fm, where fi represents the number of times i occurs in the array a.\xe2\x80\xa0 The MEX (minimum excludant) of an array of integers is defined as the smallest non-negative integer which does not occur in the array. For example:   The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0, 1, 2 and 3 belong to the array, but 4 does not." 2900
1943D2 "Counting Is Fun (Hard Version)" combinatorics,dp "This is the hard version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if both versions of the problem are solved.An array b of m non-negative integers is said to be good if all the elements of b can be made equal to 0 using the following operation some (possibly, zero) times:   Select two distinct indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4m) and subtract 1 from all bi such that l\xe2\x89\xa4i\xe2\x89\xa4r. You are given two positive integers n, k and a prime number p.Over all (k+1)n arrays of length n such that 0\xe2\x89\xa4ai\xe2\x89\xa4k for all 1\xe2\x89\xa4i\xe2\x89\xa4n, count the number of good arrays.Since the number might be too large, you are only required to find it modulo p." 2800
1943D1 "Counting Is Fun (Easy Version)" "brute force,combinatorics,dp,math" "This is the easy version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if both versions of the problem are solved.An array b of m non-negative integers is said to be good if all the elements of b can be made equal to 0 using the following operation some (possibly, zero) times:   Select two distinct indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4m) and subtract 1 from all bi such that l\xe2\x89\xa4i\xe2\x89\xa4r. You are given two positive integers n, k and a prime number p.Over all (k+1)n arrays of length n such that 0\xe2\x89\xa4ai\xe2\x89\xa4k for all 1\xe2\x89\xa4i\xe2\x89\xa4n, count the number of good arrays.Since the number might be too large, you are only required to find it modulo p." 2400
1943C "Tree Compass" "constructive algorithms,dfs and similar,greedy,trees" "You are given a tree with n vertices numbered 1,2,\xe2\x80\xa6,n. Initially, all vertices are colored white.You can perform the following two-step operation:   Choose a vertex v (1\xe2\x89\xa4v\xe2\x89\xa4n) and a distance d (0\xe2\x89\xa4d\xe2\x89\xa4n\xe2\x88\x921).  For all vertices u (1\xe2\x89\xa4u\xe2\x89\xa4n) such that dist\xe2\x80\xa0(u,v)=d, color u black. Construct a sequence of operations to color all the nodes in the tree black using the minimum possible number of operations. It can be proven that it is always possible to do so using at most n operations.\xe2\x80\xa0 dist(x,y) denotes the number of edges on the (unique) simple path between vertices x and y on the tree." 2300
1943B "Non-Palindromic Substring" hashing,implementation,math,strings "A string t is said to be k-good if there exists at least one substring\xe2\x80\xa0 of length k which is not a palindrome\xe2\x80\xa1. Let f(t) denote the sum of all values of k such that the string t is k-good.You are given a string s of length n. You will have to answer q of the following queries:  Given l and r (l<r), find the value of f(slsl+1\xe2\x80\xa6sr). \xe2\x80\xa0 A substring of a string z is a contiguous segment of characters from z. For example, ""defor"", ""code"" and ""o"" are all substrings of ""codeforces"" while ""codes"" and ""aaa"" are not.\xe2\x80\xa1 A palindrome is a string that reads the same backwards as forwards. For example, the strings ""z"", ""aa"" and ""tacocat"" are palindromes while ""codeforces"" and ""ab"" are not." 2000
1943A "MEX Game 1" games,greedy "Alice and Bob play yet another game on an array a of size n. Alice starts with an empty array c. Both players take turns playing, with Alice starting first.On Alice\'s turn, she picks one element from a, appends that element to c, and then deletes it from a.On Bob\'s turn, he picks one element from a, and then deletes it from a. The game ends when the array a is empty. Game\'s score is defined to be the MEX\xe2\x80\xa0 of c. Alice wants to maximize the score while Bob wants to minimize it. Find game\'s final score if both players play optimally.\xe2\x80\xa0 The MEX (minimum excludant) of an array of integers is defined as the smallest non-negative integer which does not occur in the array. For example:   The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0, 1, 2 and 3 belong to the array, but 4 does not." 1300
1942H "Farmer John\'s Favorite Intern" "data structures,dp,flows,trees" "Peaches...\xe2\xa0\x80Ruby just won an internship position at Farmer John\'s farm by winning a coding competition! As the newly recruited intern, Ruby is tasked with maintaining Farmer John\'s peach tree, a tree consisting of n nodes rooted at node 1. Each node initially contains ai=0 peaches, and there are two types of events that can happen:   Growth event at some node x: Ruby must choose either the parent of x or any node in the subtree of x and increase the amount of peaches it contains by one.  Harvest event at some node x: Ruby must choose a single node that is in the subtree of x and decrease the amount of peaches it contains by one. Note that this is not the same set of nodes as the growth event.  Note that the subtree of x includes the node x as well.Ruby is also given an array b of length n. The peach tree is deemed healthy if ai\xe2\x89\xa5bi for every node i.Ruby is asked to perform q operations of two types:   1 x v \xe2\x80\x94 Perform v growth events on node x. Ruby does not have to choose the same node to increase in every growth event.  2 x v \xe2\x80\x94 Perform v harvest events on node x. Ruby does not have to choose the same node to decrease in every harvest event. For every prefix of operations, Ruby asks you to find if she can perform these operations in some order such that the resulting peach tree (at the end of these operations) is healthy. Note that Ruby can\'t perform a harvest event that makes any ai negative.Every prefix is independent, meaning that for a given operation, Ruby may choose different nodes to perform events on for every prefix that contains that operation." 3500
1942G "Bessie and Cards" combinatorics,dp,math "Second Dark Matter Battle - Pokemon Super Mystery Dungeon\xe2\xa0\x80Bessie has recently started playing a famous card game. In the game, there is only one deck of cards, consisting of a ""draw 0"" cards, b ""draw 1"" cards, c ""draw 2"" cards, and 5 special cards. At the start of the game, all cards are in the randomly shuffled deck.Bessie starts the game by drawing the top 5 cards of the deck. She may then play ""draw x"" cards from the hand to draw the next x cards from the top of the deck. Note that every card can only be played once, special cards cannot be played, and if Bessie uses a ""draw 2"" card when there is only 1 card remaining in the deck, then she simply draws that remaining card. Bessie wins if she draws all 5 special cards. Since Bessie is not very good at math problems, she wants you to find the probability that she wins, given that the deck is shuffled randomly over all (a+b+c+5)! possible orderings. It can be shown that this answer can always be expressed as a fraction pq where p and q are coprime integers. Output p\xe2\x8b\x85q\xe2\x88\x921 modulo 998244353." 2800
1942F "Farmer John\'s Favorite Function" "brute force,data structures,implementation,math" "\xce\xa9\xce\xa9PARTS - Camellia\xe2\xa0\x80Farmer John has an array a of length n. He also has a function f with the following recurrence:   f(1)=\xe2\x88\x9aa1;  For all i>1, f(i)=\xe2\x88\x9af(i\xe2\x88\x921)+ai. Note that f(i) is not necessarily an integer.He plans to do q updates to the array. Each update, he gives you two integers k and x and he wants you to set ak=x. After each update, he wants to know \xe2\x8c\x8af(n)\xe2\x8c\x8b, where \xe2\x8c\x8at\xe2\x8c\x8b denotes the value of t rounded down to the nearest integer." 2700
1942E "Farm Game" combinatorics,games "Lunatic Princess - Touhou\xe2\xa0\x80Farmer Nhoj has brought his cows over to Farmer John\'s farm to play a game! FJ\'s farm can be modeled by a number line with walls at points 0 and l+1. On the farm, there are 2n cows, with n of the cows belonging to FJ and the other n belonging to FN. They place each of their cows at a distinct point, and no two FJ\'s cows nor FN\'s cows are adjacent. Two cows are adjacent if there are no other cows between them. Formally, if a1,a2,\xe2\x80\xa6,an represents the positions of FJ\'s cows and b1,b2,\xe2\x80\xa6,bn represents the positions of FN\'s cows, then either 0<a1<b1<a2<b2<\xe2\x80\xa6<an<bn<l+1 or 0<b1<a1<b2<a2<\xe2\x80\xa6<bn<an<l+1.In one move, a farmer chooses a number k (1\xe2\x89\xa4k\xe2\x89\xa4n) and a direction (left or right). Then, that farmer chooses k of his cows and moves them one position towards the chosen direction. A farmer cannot move any of his cows onto the walls or onto another farmer\'s cow. If a farmer cannot move any cows, then that farmer loses. FJ starts the game, making the first turn.Given l and n, find the number of possible game configurations for Farmer John to win if both farmers play optimally. It may be the case that the game will continue indefinitely, in which no farmer wins. A configuration is different from another if there is any i such that ai or bi is different. Output the answer modulo 998244353." 2300
1942D "Learning to Paint" "binary search,data structures,dfs and similar,dp,greedy,implementation,sortings" "Pristine Beat - Touhou\xe2\xa0\x80Elsie is learning how to paint. She has a canvas of n cells numbered from 1 to n and can paint any (potentially empty) subset of cells.  Elsie has a 2D array a which she will use to evaluate paintings. Let the maximal contiguous intervals of painted cells in a painting be [l1,r1],[l2,r2],\xe2\x80\xa6,[lx,rx]. The beauty of the painting is the sum of ali,ri over all 1\xe2\x89\xa4i\xe2\x89\xa4x. In the image above, the maximal contiguous intervals of painted cells are [2,4],[6,6],[8,9] and the beauty of the painting is a2,4+a6,6+a8,9.There are 2n ways to paint the strip. Help Elsie find the k largest possible values of the beauty of a painting she can obtain, among all these ways. Note that these k values do not necessarily have to be distinct. It is guaranteed that there are at least k different ways to paint the canvas." 2100
1942C2 "Bessie\'s Birthday Cake (Hard Version)" geometry,greedy,math "Proof Geometric Construction Can Solve All Love Affairs - manbo-p\xe2\xa0\x80This is the hard version of the problem. The only difference between the two versions is the constraint on y. In this version 0\xe2\x89\xa4y\xe2\x89\xa4n\xe2\x88\x92x. You can make hacks only if both versions are solved.Bessie has received a birthday cake from her best friend Elsie, and it came in the form of a regular polygon with n sides. The vertices of the cake are numbered from 1 to n clockwise. You and Bessie are going to choose some of those vertices to cut non-intersecting diagonals into the cake. In other words, the endpoints of the diagonals must be part of the chosen vertices.Bessie would only like to give out pieces of cake which result in a triangle to keep consistency. The size of the pieces doesn\'t matter, and the whole cake does not have to be separated into all triangles (other shapes are allowed in the cake, but those will not be counted). Bessie has already chosen x of those vertices that can be used to form diagonals. She wants you to choose no more than y other vertices such that the number of triangular pieces of cake she can give out is maximized.What is the maximum number of triangular pieces of cake Bessie can give out?" 1700
1942C1 "Bessie\'s Birthday Cake (Easy Version)" geometry,greedy,math "Proof Geometric Construction Can Solve All Love Affairs - manbo-p\xe2\xa0\x80This is the easy version of the problem. The only difference between the two versions is the constraint on y. In this version y=0. You can make hacks only if both versions are solved.Bessie has received a birthday cake from her best friend Elsie, and it came in the form of a regular polygon with n sides. The vertices of the cake are numbered from 1 to n clockwise. You and Bessie are going to choose some of those vertices to cut non-intersecting diagonals into the cake. In other words, the endpoints of the diagonals must be part of the chosen vertices.Bessie would only like to give out pieces of cake which result in a triangle to keep consistency. The size of the pieces doesn\'t matter, and the whole cake does not have to be separated into all triangles (other shapes are allowed in the cake, but those will not be counted). Bessie has already chosen x of those vertices that can be used to form diagonals. She wants you to choose no more than y other vertices such that the number of triangular pieces of cake she can give out is maximized.What is the maximum number of triangular pieces of cake Bessie can give out?" 1300
1942B "Bessie and MEX" "constructive algorithms,math" "MOOO! - Doja Cat\xe2\xa0\x80Farmer John has a permutation p1,p2,\xe2\x80\xa6,pn, where every integer from 0 to n\xe2\x88\x921 occurs exactly once. He gives Bessie an array a of length n and challenges her to construct p based on a. The array a is constructed so that ai = MEX(p1,p2,\xe2\x80\xa6,pi)\xe2\x88\x92pi, where the MEX of an array is the minimum non-negative integer that does not appear in that array. For example, MEX(1,2,3)=0 and MEX(3,1,0)=2.Help Bessie construct any valid permutation p that satisfies a. The input is given in such a way that at least one valid p exists. If there are multiple possible p, it is enough to print one of them." 1100
1942A "Farmer John\'s Challenge" "constructive algorithms,math" "Trade Winds - Patrick Deng\xe2\xa0\x80Let\'s call an array a sorted if a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an\xe2\x88\x921\xe2\x89\xa4an.You are given two of Farmer John\'s favorite integers, n and k. He challenges you to find any array a1,a2,\xe2\x80\xa6,an satisfying the following requirements:  1\xe2\x89\xa4ai\xe2\x89\xa4109 for each 1\xe2\x89\xa4i\xe2\x89\xa4n;  Out of the n total cyclic shifts of a, exactly k of them are sorted.\xe2\x80\xa0 If there is no such array a, output \xe2\x88\x921.\xe2\x80\xa0The x-th (1\xe2\x89\xa4x\xe2\x89\xa4n) cyclic shift of the array a is ax,ax+1\xe2\x80\xa6an,a1,a2\xe2\x80\xa6ax\xe2\x88\x921. If cx,i denotes the i\'th element of the x\'th cyclic shift of a, exactly k such x should satisfy cx,1\xe2\x89\xa4cx,2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4cx,n\xe2\x88\x921\xe2\x89\xa4cx,n.For example, the cyclic shifts for a=[1,2,3,3] are the following:  x=1: [1,2,3,3] (sorted);  x=2: [2,3,3,1] (not sorted);  x=3: [3,3,1,2] (not sorted);  x=4: [3,1,2,3] (not sorted)." 800
1941G "Rudolf and Subway" "constructive algorithms,dfs and similar,graphs,shortest paths" "Building bridges did not help Bernard, and he continued to be late everywhere. Then Rudolf decided to teach him how to use the subway.Rudolf depicted the subway map as an undirected connected graph, without self-loops, where the vertices represent stations. There is at most one edge between any pair of vertices.Two vertices are connected by an edge if it is possible to travel directly between the corresponding stations, bypassing other stations. The subway in the city where Rudolf and Bernard live has a color notation. This means that any edge between stations has a specific color. Edges of a specific color together form a subway line. A subway line cannot contain unconnected edges and forms a connected subgraph of the given subway graph.An example of the subway map is shown in the figure.  Rudolf claims that the route will be optimal if it passes through the minimum number of subway lines.Help Bernard determine this minimum number for the given departure and destination stations." 2000
1941F "Rudolf and Imbalance" "binary search,greedy,sortings,two pointers" "Rudolf has prepared a set of n problems with complexities a1<a2<a3<\xe2\x8b\xaf<an. He is not entirely satisfied with the balance, so he wants to add at most one problem to fix it.For this, Rudolf came up with m models of problems and k functions. The complexity of the i-th model is di, and the complexity of the j-th function is fj. To create a problem, he selects values i and j (1\xe2\x89\xa4i\xe2\x89\xa4m, 1\xe2\x89\xa4j\xe2\x89\xa4k) and by combining the i-th model with the j-th function, he obtains a new problem with complexity di+fj (a new element is inserted into the array a).To determine the imbalance of the set, Rudolf sorts the complexities of the problems in ascending order and finds the largest value of ai\xe2\x88\x92ai\xe2\x88\x921 (i>1).What is the minimum value of imbalance that Rudolf can achieve by adding at most one problem, created according to the described rules?" 1800
1941E "Rudolf and k Bridges" "binary search,data structures,dp,two pointers" "Bernard loves visiting Rudolf, but he is always running late. The problem is that Bernard has to cross the river on a ferry. Rudolf decided to help his friend solve this problem.The river is a grid of n rows and m columns. The intersection of the i-th row and the j-th column contains the number ai,j \xe2\x80\x94 the depth in the corresponding cell. All cells in the first and last columns correspond to the river banks, so the depth for them is 0.  The river may look like this. Rudolf can choose the row (i,1),(i,2),\xe2\x80\xa6,(i,m) and build a bridge over it. In each cell of the row, he can install a support for the bridge. The cost of installing a support in the cell (i,j) is ai,j+1. Supports must be installed so that the following conditions are met:  A support must be installed in cell (i,1);  A support must be installed in cell (i,m);  The distance between any pair of adjacent supports must be no more than d. The distance between supports (i,j1) and (i,j2) is |j1\xe2\x88\x92j2|\xe2\x88\x921. Building just one bridge is boring. Therefore, Rudolf decided to build k bridges on consecutive rows of the river, that is, to choose some i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k+1) and independently build a bridge on each of the rows i,i+1,\xe2\x80\xa6,i+k\xe2\x88\x921. Help Rudolf minimize the total cost of installing supports." 1600
1941D "Rudolf and the Ball Game" "dfs and similar,dp,implementation" "Rudolf and Bernard decided to play a game with their friends. n people stand in a circle and start throwing a ball to each other. They are numbered from 1 to n in the clockwise order.Let\'s call a transition a movement of the ball from one player to his neighbor. The transition can be made clockwise or counterclockwise.Let\'s call the clockwise (counterclockwise) distance from player y1 to player y2 the number of transitions clockwise (counterclockwise) that need to be made to move from player y1 to player y2. For example, if n=7 then the clockwise distance from 2 to 5 is 3, and the counterclockwise distance from 2 to 5 is 4.Initially, the ball is with the player number x (players are numbered clockwise). On the i-th move the person with the ball throws it at a distance of ri (1\xe2\x89\xa4ri\xe2\x89\xa4n\xe2\x88\x921) clockwise or counterclockwise. For example, if there are 7 players, and the 2nd player, after receiving the ball, throws it a distance of 5, then the ball will be caught by either the 7th player (throwing clockwise) or the 4th player (throwing counterclockwise). An illustration of this example is shown below.  The game was interrupted after m throws due to unexpected rain. When the rain stopped, the guys gathered again to continue. However, no one could remember who had the ball. As it turned out, Bernard remembered the distances for each of the throws and the direction for some of the throws (clockwise or counterclockwise).Rudolf asks you to help him and based on the information from Bernard, calculate the numbers of the players who could have the ball after m throws." 1200
1941C "Rudolf and the Ugly String" dp,greedy,strings "Rudolf has a string s of length n. Rudolf considers the string s to be ugly if it contains the substring\xe2\x80\xa0 ""pie"" or the substring ""map"", otherwise the string s will be considered beautiful.For example, ""ppiee"", ""mmap"", ""dfpiefghmap"" are ugly strings, while ""mathp"", ""ppiiee"" are beautiful strings.Rudolf wants to shorten the string s by removing some characters to make it beautiful.The main character doesn\'t like to strain, so he asks you to make the string beautiful by removing the minimum number of characters. He can remove characters from any positions in the string (not just from the beginning or end of the string).\xe2\x80\xa0 String a is a substring of b if there exists a consecutive segment of characters in string b equal to a." 900
1941B "Rudolf and 121" "brute force,dp,greedy,math" "Rudolf has an array a of n integers, the elements are numbered from 1 to n.In one operation, he can choose an index i (2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) and assign:  ai\xe2\x88\x921=ai\xe2\x88\x921\xe2\x88\x921  ai=ai\xe2\x88\x922  ai+1=ai+1\xe2\x88\x921 Rudolf can apply this operation any number of times. Any index i can be used zero or more times.Can he make all the elements of the array equal to zero using this operation?" 1000
1941A "Rudolf and the Ticket" "brute force,math" "Rudolf is going to visit Bernard, and he decided to take the metro to get to him. The ticket can be purchased at a machine that accepts exactly two coins, the sum of which does not exceed k.Rudolf has two pockets with coins. In the left pocket, there are n coins with denominations b1,b2,\xe2\x80\xa6,bn. In the right pocket, there are m coins with denominations c1,c2,\xe2\x80\xa6,cm. He wants to choose exactly one coin from the left pocket and exactly one coin from the right pocket (two coins in total).Help Rudolf determine how many ways there are to select indices f and s such that bf+cs\xe2\x89\xa4k." 800
1937B "Binary Path" dp,greedy,implementation "You are given a 2\xc3\x97n grid filled with zeros and ones. Let the number at the intersection of the i-th row and the j-th column be aij.There is a grasshopper at the top-left cell (1,1) that can only jump one cell right or downwards. It wants to reach the bottom-right cell (2,n). Consider the binary string of length n+1 consisting of numbers written in cells of the path without changing their order.Your goal is to:   Find the lexicographically smallest\xe2\x80\xa0 string you can attain by choosing any available path;  Find the number of paths that yield this lexicographically smallest string. \xe2\x80\xa0 If two strings s and t have the same length, then s is lexicographically smaller than t if and only if in the first position where s and t differ, the string s has a smaller element than the corresponding element in t." 1300
1937A "Shuffle Party" implementation,math "You are given an array a1,a2,\xe2\x80\xa6,an. Initially, ai=i for each 1\xe2\x89\xa4i\xe2\x89\xa4n.The operation swap(k) for an integer k\xe2\x89\xa52 is defined as follows:   Let d be the largest divisor\xe2\x80\xa0 of k which is not equal to k itself. Then swap the elements ad and ak. Suppose you perform swap(i) for each i=2,3,\xe2\x80\xa6,n in this exact order. Find the position of 1 in the resulting array. In other words, find such j that aj=1 after performing these operations.\xe2\x80\xa0 An integer x is a divisor of y if there exists an integer z such that y=x\xe2\x8b\x85z." 800
1936F "Grand Finale: Circles" "binary search,geometry" "You are given n circles on the plane. The i-th of these circles is given by a tuple of integers (xi,yi,ri), where (xi,yi) are the coordinates of its center, and ri is the radius of the circle.Please find a circle C which meets the following conditions:  C is contained inside all n circles given in the input.  Among all circles C that meet the first condition, the radius of the circle is maximum. Let the largest suitable circle have the radius of a.Your output C, described as (x,y,r), will be accepted if it meets the following conditions:  For each i, \xe2\x88\x9a(xi\xe2\x88\x92x)2+(yi\xe2\x88\x92y)2+r\xe2\x89\xa4ri+max(a,1)\xe2\x8b\x8510\xe2\x88\x927.  The absolute or relative error of r does not exceed 10\xe2\x88\x927. Formally, your answer is accepted if and only if |r\xe2\x88\x92a|max(1,a)\xe2\x89\xa410\xe2\x88\x927." 3300
1936E "Yet Yet Another Permutation Problem" "divide and conquer,fft,math" "You are given a permutation p of length n.Please count the number of permutations q of length n which satisfy the following: for each 1\xe2\x89\xa4i<n, max(q1,\xe2\x80\xa6,qi)\xe2\x89\xa0max(p1,\xe2\x80\xa6,pi).Since the answer may be large, output the answer modulo 998244353." 3400
1936D "Bitwise Paradox" "binary search,bitmasks,data structures,greedy,two pointers" "You are given two arrays a and b of size n along with a fixed integer v.An interval [l,r] is called a good interval if (bl\xe2\x88\xa3bl+1\xe2\x88\xa3\xe2\x80\xa6\xe2\x88\xa3br)\xe2\x89\xa5v, where | denotes the bitwise OR operation. The beauty of a good interval is defined as max(al,al+1,\xe2\x80\xa6,ar).You are given q queries of two types:  ""1 i x"": assign bi:=x;  ""2 l r"": find the minimum beauty among all good intervals [l0,r0] satisfying l\xe2\x89\xa4l0\xe2\x89\xa4r0\xe2\x89\xa4r. If there is no suitable good interval, output \xe2\x88\x921 instead. Please process all queries." 3100
1936C "Pok\xc3\xa9mon Arena" "data structures,graphs,greedy,implementation,shortest paths,sortings" "You are at a dueling arena. You also possess n Pok\xc3\xa9mons. Initially, only the 1-st Pok\xc3\xa9mon is standing in the arena.Each Pok\xc3\xa9mon has m attributes. The j-th attribute of the i-th Pok\xc3\xa9mon is ai,j. Each Pok\xc3\xa9mon also has a cost to be hired: the i-th Pok\xc3\xa9mon\'s cost is ci.You want to have the n-th Pok\xc3\xa9mon stand in the arena. To do that, you can perform the following two types of operations any number of times in any order:   Choose three integers i, j, k (1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4j\xe2\x89\xa4m, k>0), increase ai,j by k permanently. The cost of this operation is k.  Choose two integers i, j (1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4j\xe2\x89\xa4m) and hire the i-th Pok\xc3\xa9mon to duel with the current Pok\xc3\xa9mon in the arena based on the j-th attribute. The i-th Pok\xc3\xa9mon will win if ai,j is greater than or equal to the j-th attribute of the current Pok\xc3\xa9mon in the arena (otherwise, it will lose). After the duel, only the winner will stand in the arena. The cost of this operation is ci. Find the minimum cost you need to pay to have the n-th Pok\xc3\xa9mon stand in the arena." 2400
1936B Pinball "binary search,data structures,implementation,math,two pointers" "There is a one-dimensional grid of length n. The i-th cell of the grid contains a character si, which is either \'<\' or \'>\'.When a pinball is placed on one of the cells, it moves according to the following rules:   If the pinball is on the i-th cell and si is \'<\', the pinball moves one cell to the left in the next second. If si is \'>\', it moves one cell to the right.  After the pinball has moved, the character si is inverted (i. e. if si used to be \'<\', it becomes \'>\', and vice versa).  The pinball stops moving when it leaves the grid: either from the left border or from the right one. You need to answer n independent queries. In the i-th query, a pinball will be placed on the i-th cell. Note that we always place a pinball on the initial grid.For each query, calculate how many seconds it takes the pinball to leave the grid. It can be shown that the pinball will always leave the grid within a finite number of steps." 2000
1936A "Bitwise Operation Wizard" "bitmasks,constructive algorithms,greedy,interactive,math" "This is an interactive problem.There is a secret sequence p0,p1,\xe2\x80\xa6,pn\xe2\x88\x921, which is a permutation of {0,1,\xe2\x80\xa6,n\xe2\x88\x921}.You need to find any two indices i and j such that pi\xe2\x8a\x95pj is maximized, where \xe2\x8a\x95 denotes the bitwise XOR operation.To do this, you can ask queries. Each query has the following form: you pick arbitrary indices a, b, c, and d (0\xe2\x89\xa4a,b,c,d<n). Next, the jury calculates x=(pa\xe2\x88\xa3pb) and y=(pc\xe2\x88\xa3pd), where | denotes the bitwise OR operation. Finally, you receive the result of comparison between x and y. In other words, you are told if x<y, x>y, or x=y.Please find any two indices i and j (0\xe2\x89\xa4i,j<n) such that pi\xe2\x8a\x95pj is maximum among all such pairs, using at most 3n queries. If there are multiple pairs of indices satisfying the condition, you may output any one of them." 1700
1935F "Andrey\'s Tree" "binary search,constructive algorithms,data structures,dfs and similar,dsu,greedy,implementation,trees" "Master Andrey loves trees\xe2\x80\xa0 very much, so he has a tree consisting of n vertices.But it\'s not that simple. Master Timofey decided to steal one vertex from the tree. If Timofey stole vertex v from the tree, then vertex v and all edges with one end at vertex v are removed from the tree, while the numbers of other vertices remain unchanged. To prevent Andrey from getting upset, Timofey decided to make the resulting graph a tree again. To do this, he can add edges between any vertices a and b, but when adding such an edge, he must pay |a\xe2\x88\x92b| coins to the Master\'s Assistance Center.Note that the resulting tree does not contain vertex v.Timofey has not yet decided which vertex v he will remove from the tree, so he wants to know for each vertex 1\xe2\x89\xa4v\xe2\x89\xa4n, the minimum number of coins needed to be spent to make the graph a tree again after removing vertex v, as well as which edges need to be added.\xe2\x80\xa0A tree is an undirected connected graph without cycles." 2800
1935E "Distance Learning Courses in MAC" "bitmasks,brute force,data structures,greedy,math" "The New Year has arrived in the Master\'s Assistance Center, which means it\'s time to introduce a new feature!Now students are given distance learning courses, with a total of n courses available. For the i-th distance learning course, a student can receive a grade ranging from xi to yi.However, not all courses may be available to each student. Specifically, the j-th student is only given courses with numbers from lj to rj, meaning the distance learning courses with numbers lj,lj+1,\xe2\x80\xa6,rj.The creators of the distance learning courses have decided to determine the final grade in a special way. Let the j-th student receive grades clj,clj+1,\xe2\x80\xa6,crj for their distance learning courses. Then their final grade will be equal to clj | clj+1 | \xe2\x80\xa6 | crj, where | denotes the bitwise OR operation.Since the chatbot for solving distance learning courses is broken, the students have asked for your help. For each of the q students, tell them the maximum final grade they can achieve." 2400
1935D "Exam in MAC" "binary search,combinatorics,implementation,math" "The Master\'s Assistance Center has announced an entrance exam, which consists of the following.The candidate is given a set s of size n and some strange integer c. For this set, it is needed to calculate the number of pairs of integers (x,y) such that 0\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4c, x+y is not contained in the set s, and also y\xe2\x88\x92x is not contained in the set s.Your friend wants to enter the Center. Help him pass the exam!" 1800
1935C "Messenger in MAC" "binary search,brute force,constructive algorithms,data structures,dp,greedy,sortings" "In the new messenger for the students of the Master\'s Assistance Center, Keftemerum, an update is planned, in which developers want to optimize the set of messages shown to the user. There are a total of n messages. Each message is characterized by two integers ai and bi. The time spent reading the set of messages with numbers p1,p2,\xe2\x80\xa6,pk (1\xe2\x89\xa4pi\xe2\x89\xa4n, all pi are distinct) is calculated by the formula:k\xe2\x88\x91i=1api+k\xe2\x88\x921\xe2\x88\x91i=1|bpi\xe2\x88\x92bpi+1|Note that the time to read a set of messages consisting of one message with number p1 is equal to ap1. Also, the time to read an empty set of messages is considered to be 0.The user can determine the time l that he is willing to spend in the messenger. The messenger must inform the user of the maximum possible size of the set of messages, the reading time of which does not exceed l. Note that the maximum size of the set of messages can be equal to 0.The developers of the popular messenger failed to implement this function, so they asked you to solve this problem." 1800
1935B "Informatics in MAC" "constructive algorithms" "In the Master\'s Assistance Center, Nyam-Nyam was given a homework assignment in informatics.There is an array a of length n, and you want to divide it into k>1 subsegments\xe2\x80\xa0 in such a way that the MEX\xe2\x80\xa1 on each subsegment is equal to the same integer.Help Nyam-Nyam find any suitable division, or determine that it does not exist.\xe2\x80\xa0A division of an array into k subsegments is defined as k pairs of integers (l1,r1),(l2,r2),\xe2\x80\xa6,(lk,rk) such that li\xe2\x89\xa4ri and for each 1\xe2\x89\xa4j\xe2\x89\xa4k\xe2\x88\x921, lj+1=rj+1, and also l1=1 and rk=n. These pairs represent the subsegments themselves.\xe2\x80\xa1MEX of an array is the smallest non-negative integer that does not belong to the array.For example:   MEX of the array [2,2,1] is 0, because 0 does not belong to the array.  MEX of the array [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  MEX of the array [0,3,1,2] is 4, because 0, 1, 2, and 3 belong to the array, but 4 does not." 1200
1935A "Entertainment in MAC" "constructive algorithms,strings" "Congratulations, you have been accepted to the Master\'s Assistance Center! However, you were extremely bored in class and got tired of doing nothing, so you came up with a game for yourself.You are given a string s and an even integer n. There are two types of operations that you can apply to it:  Add the reversed string s to the end of the string s (for example, if s= cpm, then after applying the operation s= cpmmpc).  Reverse the current string s (for example, if s= cpm, then after applying the operation s= mpc). It is required to determine the lexicographically smallest\xe2\x80\xa0 string that can be obtained after applying exactly n operations. Note that you can apply operations of different types in any order, but you must apply exactly n operations in total.\xe2\x80\xa0A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 800
1934E "Weird LCM Operations" "brute force,constructive algorithms,number theory" "Given an integer n, you construct an array a of n integers, where ai=i for all integers i in the range [1,n]. An operation on this array is defined as follows:  Select three distinct indices i, j, and k from the array, and let x=ai, y=aj, and z=ak.  Update the array as follows: ai=lcm(y,z), aj=lcm(x,z), and ak=lcm(x,y), where lcm represents the least common multiple.  Your task is to provide a possible sequence of operations, containing at most \xe2\x8c\x8an6\xe2\x8c\x8b+5 operations such that after executing these operations, if you create a set containing the greatest common divisors (GCDs) of all subsequences with a size greater than 1, then all numbers from 1 to n should be present in this set.After all the operations ai\xe2\x89\xa41018 should hold for all 1\xe2\x89\xa4i\xe2\x89\xa4n.We can show that an answer always exists." 3000
1934D2 "XOR Break --- Game Version" bitmasks,games,greedy,interactive "This is an interactive problem.This is the game version of the problem. Note that the solution of this problem may or may not share ideas with the solution of the solo version. You can solve and get points for both versions independently.Alice and Bob are playing a game. The game starts with a positive integer n, with players taking turns. On each turn of the game, the following sequence of events takes place:  The player having the integer p breaks it into two integers p1 and p2, where 0<p1<p, 0<p2<p and p1\xe2\x8a\x95p2=p.  If no such p1, p2 exist, the player loses.  Otherwise, the opponent does either select the integer p1 or p2.  The game continues with the selected integer. The opponent will try to break it. As Alice, your goal is to win. You can execute a maximum of 63 break operations. You have the choice to play first or second. The system will act for Bob.Here \xe2\x8a\x95 denotes the bitwise XOR operation." 2400
1934D1 "XOR Break --- Solo Version" "bitmasks,constructive algorithms,greedy" "This is the solo version of the problem. Note that the solution of this problem may or may not share ideas with the solution of the game version. You can solve and get points for both versions independently.You can make hacks only if both versions of the problem are solved.Given an integer variable x with the initial value of n. A single break operation consists of the following steps:   Choose a value y such that 0<y<x and 0<(x\xe2\x8a\x95y)<x.  Update x by either setting x=y or setting x=x\xe2\x8a\x95y.  Determine whether it is possible to transform x into m using a maximum of 63 break operations. If it is, provide the sequence of operations required to achieve x=m.You don\'t need to minimize the number of operations.Here \xe2\x8a\x95 denotes the bitwise XOR operation." 2100
1934C "Find a Mine" "binary search,constructive algorithms,geometry,greedy,interactive,math" "This is an interactive problem.You are given a grid with n rows and m columns. The coordinates (x,y) represent the cell on the grid, where x (1\xe2\x89\xa4x\xe2\x89\xa4n) is the row number counting from the top and y (1\xe2\x89\xa4y\xe2\x89\xa4m) is the column number counting from the left. It is guaranteed that there are exactly 2 mines in the grid at distinct cells, denoted as (x1,y1) and (x2,y2). You are allowed to make no more than 4 queries to the interactor, and after these queries, you need to provide the location of one of the mines.In each query, you can choose any grid cell (x,y), and in return, you will receive the minimum Manhattan distance from both the mines to the chosen cell, i.e., you will receive the value min(|x\xe2\x88\x92x1|+|y\xe2\x88\x92y1|,|x\xe2\x88\x92x2|+|y\xe2\x88\x92y2|).Your task is to determine the location of one of the mines after making the queries." 1700
1934B "Yet Another Coin Problem" "brute force,dp,greedy,math" "You have 5 different types of coins, each with a value equal to one of the first 5 triangular numbers: 1, 3, 6, 10, and 15. These coin types are available in abundance. Your goal is to find the minimum number of these coins required such that their total value sums up to exactly n.We can show that the answer always exists." 1200
1934A "Too Min Too Max" greedy,math "Given an array a of n elements, find the maximum value of the expression:|ai\xe2\x88\x92aj|+|aj\xe2\x88\x92ak|+|ak\xe2\x88\x92al|+|al\xe2\x88\x92ai|where i, j, k, and l are four distinct indices of the array a, with 1\xe2\x89\xa4i,j,k,l\xe2\x89\xa4n.Here |x| denotes the absolute value of x." 800
1933G "Turtle Magic: Royal Turtle Shell Pattern" "bitmasks,brute force,combinatorics,constructive algorithms,dfs and similar,math" "Turtle Alice is currently designing a fortune cookie box, and she would like to incorporate the theory of LuoShu into it.The box can be seen as an n\xc3\x97m grid (n,m\xe2\x89\xa55), where the rows are numbered 1,2,\xe2\x80\xa6,n and columns are numbered 1,2,\xe2\x80\xa6,m. Each cell can either be empty or have a single fortune cookie of one of the following shapes: circle or square. The cell at the intersection of the a-th row and the b-th column is denoted as (a,b).Initially, the entire grid is empty. Then, Alice performs q operations on the fortune cookie box. The i-th operation (1\xe2\x89\xa4i\xe2\x89\xa4q) is as follows: specify a currently empty cell (ri,ci) and a shape (circle or square), then put a fortune cookie of the specified shape on cell (ri,ci). Note that after the i-th operation, the cell (ri,ci) is no longer empty.Before all operations and after each of the q operations, Alice wonders what the number of ways to place fortune cookies in all remaining empty cells is, such that the following condition is satisfied:No three consecutive cells (in horizontal, vertical, and both diagonal directions) contain cookies of the same shape. Formally:  There does not exist any (i,j) satisfying 1\xe2\x89\xa4i\xe2\x89\xa4n,1\xe2\x89\xa4j\xe2\x89\xa4m\xe2\x88\x922, such that there are cookies of the same shape in cells (i,j),(i,j+1),(i,j+2).  There does not exist any (i,j) satisfying 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922,1\xe2\x89\xa4j\xe2\x89\xa4m, such that there are cookies of the same shape in cells (i,j),(i+1,j),(i+2,j).  There does not exist any (i,j) satisfying 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922,1\xe2\x89\xa4j\xe2\x89\xa4m\xe2\x88\x922, such that there are cookies of the same shape in cells (i,j),(i+1,j+1),(i+2,j+2).  There does not exist any (i,j) satisfying 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922,1\xe2\x89\xa4j\xe2\x89\xa4m\xe2\x88\x922, such that there are cookies of the same shape in cells (i,j+2),(i+1,j+1),(i+2,j). You should output all answers modulo 998244353. Also note that it is possible that after some operations, the condition is already not satisfied with the already placed candies, in this case you should output 0." 2300
1933F "Turtle Mission: Robot and the Earthquake" "dfs and similar,dp,graphs,shortest paths" "The world is a grid with n rows and m columns. The rows are numbered 0,1,\xe2\x80\xa6,n\xe2\x88\x921, while the columns are numbered 0,1,\xe2\x80\xa6,m\xe2\x88\x921. In this world, the columns are cyclic (i.e. the top and the bottom cells in each column are adjacent). The cell on the i-th row and the j-th column (0\xe2\x89\xa4i<n,0\xe2\x89\xa4j<m) is denoted as (i,j). At time 0, the cell (i,j) (where 0\xe2\x89\xa4i<n,0\xe2\x89\xa4j<m) contains either a rock or nothing. The state of cell (i,j) can be described using the integer ai,j:   If ai,j=1, there is a rock at (i,j).  If ai,j=0, there is nothing at (i,j). As a result of aftershocks from the earthquake, the columns follow tectonic plate movements: each column moves cyclically upwards at a velocity of 1 cell per unit of time. Formally, for some 0\xe2\x89\xa4i<n,0\xe2\x89\xa4j<m, if (i,j) contains a rock at the moment, it will move from (i,j) to (i\xe2\x88\x921,j) (or to (n\xe2\x88\x921,j) if i=0). The robot called RT is initially positioned at (0,0). It has to go to (n\xe2\x88\x921,m\xe2\x88\x921) to carry out an earthquake rescue operation (to the bottom rightmost cell). The earthquake doesn\'t change the position of the robot, they only change the position of rocks in the world.Let RT\'s current position be (x,y) (0\xe2\x89\xa4x<n,0\xe2\x89\xa4y<m), it can perform the following operations:   Go one cell cyclically upwards, i.e. from (x,y) to ((x+n\xe2\x88\x921)modn,y) using 1 unit of time.  Go one cell cyclically downwards, i.e. (x,y) to ((x+1)modn,y) using 1 unit of time.  Go one cell to the right, i.e. (x,y) to (x,y+1) using 1 unit of time. (RT may perform this operation only if y<m\xe2\x88\x921.) Note that RT cannot go left using the operations nor can he stay at a position.Unfortunately, RT will explode upon colliding with a rock. As such, when RT is at (x,y) and there is a rock at ((x+1)modn,y) or ((x+2)modn,y), RT cannot move down or it will be hit by the rock.   Similarly, if y+1<m and there is a rock at ((x+1)modn,y+1), RT cannot move right or it will be hit by the rock.  However, it is worth noting that if there is a rock at (xmodn,y+1) and ((x+1)modn,y), RT can still move right safely.  Find the minimum amount of time RT needs to reach (n\xe2\x88\x921,m\xe2\x88\x921) without colliding with any rocks. If it is impossible to do so, output \xe2\x88\x921." 2100
1933E "Turtle vs. Rabbit Race: Optimal Trainings" "binary search,implementation,math,ternary search" "Isaac begins his training. There are n running tracks available, and the i-th track (1\xe2\x89\xa4i\xe2\x89\xa4n) consists of ai equal-length sections. Given an integer u (1\xe2\x89\xa4u\xe2\x89\xa4109), finishing each section can increase Isaac\'s ability by a certain value, described as follows:   Finishing the 1-st section increases Isaac\'s performance by u.  Finishing the 2-nd section increases Isaac\'s performance by u\xe2\x88\x921.  Finishing the 3-rd section increases Isaac\'s performance by u\xe2\x88\x922.  \xe2\x80\xa6  Finishing the k-th section (k\xe2\x89\xa51) increases Isaac\'s performance by u+1\xe2\x88\x92k. (The value u+1\xe2\x88\x92k can be negative, which means finishing an extra section decreases Isaac\'s performance.)  You are also given an integer l. You must choose an integer r such that l\xe2\x89\xa4r\xe2\x89\xa4n and Isaac will finish each section of each track l,l+1,\xe2\x80\xa6,r (that is, a total of \xe2\x88\x91ri=lai=al+al+1+\xe2\x80\xa6+ar sections).Answer the following question: what is the optimal r you can choose that the increase in Isaac\'s performance is maximum possible? If there are multiple r that maximize the increase in Isaac\'s performance, output the smallest r.To increase the difficulty, you need to answer the question for q different values of l and u." 1500
1933D "Turtle Tenacity: Continual Mods" "constructive algorithms,greedy,math,number theory,sortings" "Given an array a1,a2,\xe2\x80\xa6,an, determine whether it is possible to rearrange its elements into b1,b2,\xe2\x80\xa6,bn, such that b1modb2mod\xe2\x80\xa6modbn\xe2\x89\xa00.Here xmody denotes the remainder from dividing x by y. Also, the modulo operations are calculated from left to right. That is, xmodymodz=(xmody)modz. For example, 2024mod1000mod8=(2024mod1000)mod8=24mod8=0." 1200
1933C "Turtle Fingers: Count the Values of k" "brute force,implementation,math,number theory" "You are given three positive integers a, b and l (a,b,l>0). It can be shown that there always exists a way to choose non-negative (i.e. \xe2\x89\xa50) integers k, x, and y such that l=k\xe2\x8b\x85ax\xe2\x8b\x85by. Your task is to find the number of distinct possible values of k across all such ways." 1100
1933B "Turtle Math: Fast Three Task" "implementation,math,number theory" "You are given an array a1,a2,\xe2\x80\xa6,an.In one move, you can perform either of the following two operations:  Choose an element from the array and remove it from the array. As a result, the length of the array decreases by 1; Choose an element from the array and increase its value by 1. You can perform any number of moves. If the current array becomes empty, then no more moves can be made.Your task is to find the minimum number of moves required to make the sum of the elements of the array a divisible by 3. It is possible that you may need 0 moves.Note that the sum of the elements of an empty array (an array of length 0) is equal to 0." 800
1933A "Turtle Puzzle: Rearrange and Negate" greedy,math,sortings "You are given an array a of n integers. You must perform the following two operations on the array (the first, then the second):  Arbitrarily rearrange the elements of the array or leave the order of its elements unchanged.  Choose at most one contiguous segment of elements and replace the signs of all elements in this segment with their opposites. Formally, you can choose a pair of indices l,r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and assign ai=\xe2\x88\x92ai for all l\xe2\x89\xa4i\xe2\x89\xa4r (negate elements). Note that you may choose not to select a pair of indices and leave all the signs of the elements unchanged. What is the maximum sum of the array elements after performing these two operations (the first, then the second)?" 800
1932G "Moving Platforms" "graphs,math,number theory,shortest paths" "There is a game where you need to move through a labyrinth. The labyrinth consists of n platforms, connected by m passages. Each platform is at some level li, an integer number from 0 to H\xe2\x88\x921. In a single step, if you are currently on platform i, you can stay on it, or move to another platform j. To move to platform j they have to be connected by the passage, and their levels have to be the same, namely li=lj.After each step, the levels of all platforms change. The new level of platform i is calculated as l\xe2\x80\xb2i=(li+si)modH, for all i. You start on platform 1. Find the minimum number of steps you need to get to platform n." 2300
1932F "Feed Cats" "data structures,dp,sortings" "There is a fun game where you need to feed cats that come and go. The level of the game consists of n steps. There are m cats; the cat i is present in steps from li to ri, inclusive. In each step, you can feed all the cats that are currently present or do nothing. If you feed the same cat more than once, it will overeat, and you will immediately lose the game. Your goal is to feed as many cats as possible without causing any cat to overeat. Find the maximum number of cats you can feed.Formally, you need to select several integer points from the segment from 1 to n in such a way that among given segments, none covers two or more of the selected points, and as many segments as possible cover one of the selected points." 1900
1932E "Final Countdown" "implementation,math,number theory" "You are in a nuclear laboratory that is about to explode and destroy the Earth. You must save the Earth before the final countdown reaches zero. The countdown consists of n (1\xe2\x89\xa4n\xe2\x89\xa44\xe2\x8b\x85105) mechanical indicators, each showing one decimal digit. You noticed that when the countdown changes its state from x to x\xe2\x88\x921, it doesn\'t happen in one move. Instead, each change of a single digit takes one second. So, for example, if the countdown shows 42, then it will change to 41 in one second, because only one digit is changed, but if the countdown shows 2300, then it will change to 2299 in three seconds, because the three last digits are changed.Find out how much time is left before the countdown reaches zero." 1600
1932D "Card Game" greedy,implementation "Two players are playing an online card game. The game is played using a 32-card deck. Each card has a suit and a rank. There are four suits: clubs, diamonds, hearts, and spades. We will encode them with characters \'C\', \'D\', \'H\', and \'S\', respectively. And there are 8 ranks, in increasing order: \'2\', \'3\', \'4\', \'5\', \'6\', \'7\', \'8\', \'9\'.Each card is denoted by two letters: its rank and its suit. For example, the 8 of Hearts is denoted as 8H.At the beginning of the game, one suit is chosen as the trump suit.In each round, players make moves like this: the first player places one of his cards on the table, and the second player must beat this card with one of their cards. After that, both cards are moved to the discard pile.A card can beat another card if both cards have the same suit and the first card has a higher rank than the second. For example, 8S can beat 4S. Additionally, a trump card can beat any non-trump card, regardless of the rank of the cards, for example, if the trump suit is clubs (\'C\'), then 3C can beat 9D. Note that trump cards can be beaten only by the trump cards of higher rank.There were n rounds played in the game, so the discard pile now contains 2n cards. You want to reconstruct the rounds played in the game, but the cards in the discard pile are shuffled. Find any possible sequence of n rounds that might have been played in the game." 1400
1932C LR-remainders "brute force,data structures,implementation,math,two pointers" "You are given an array a of length n, a positive integer m, and a string of commands of length n. Each command is either the character \'L\' or the character \'R\'.Process all n commands in the order they are written in the string s. Processing a command is done as follows:  First, output the remainder of the product of all elements of the array a when divided by m.  Then, if the command is \'L\', remove the leftmost element from the array a, if the command is \'R\', remove the rightmost element from the array a. Note that after each move, the length of the array a decreases by 1, and after processing all commands, it will be empty.Write a program that will process all commands in the order they are written in the string s (from left to right)." 1400
1932B "Chaya Calendar" "number theory" "The Chaya tribe believes that there are n signs of the apocalypse. Over time, it has been found out that the i-th sign occurs every ai years (in years ai, 2\xe2\x8b\x85ai, 3\xe2\x8b\x85ai, \xe2\x80\xa6).According to the legends, for the apocalypse to happen, the signs must occur sequentially. That is, first they wait for the first sign to occur, then strictly after it, the second sign will occur, and so on. That is, if the i-th sign occurred in the year x, the tribe starts waiting for the occurrence of the (i+1)-th sign, starting from the year x+1.In which year will the n-th sign occur and the apocalypse will happen?" 1100
1932A "Thorns and Coins" dp,greedy,implementation "During your journey through computer universes, you stumbled upon a very interesting world. It is a path with n consecutive cells, each of which can either be empty, contain thorns, or a coin. In one move, you can move one or two cells along the path, provided that the destination cell does not contain thorns (and belongs to the path). If you move to the cell with a coin, you pick it up.  Here, green arrows correspond to legal moves, and the red arrow corresponds to an illegal move. You want to collect as many coins as possible. Find the maximum number of coins you can collect in the discovered world if you start in the leftmost cell of the path." 800
1931G "One-Dimensional Puzzle" "combinatorics,math,number theory" "You have a one-dimensional puzzle, all the elements of which need to be put in one row, connecting with each other. All the puzzle elements are completely white and distinguishable from each other only if they have different shapes. Each element has straight borders at the top and bottom, and on the left and right it has connections, each of which can be a protrusion or a recess. You cannot rotate the elements.You can see that there are exactly 4 types of elements. Two elements can be connected if the right connection of the left element is opposite to the left connection of the right element.  All possible types of elements. The puzzle contains c1,c2,c3,c4 elements of each type. The puzzle is considered complete if you have managed to combine all elements into one long chain. You want to know how many ways this can be done." 2000
1931F "Chat Screenshots" "combinatorics,dfs and similar,graphs" "There are n people in the programming contest chat. Chat participants are ordered by activity, but each person sees himself at the top of the list.For example, there are 4 participants in the chat, and their order is [2,3,1,4]. Then   1-st user sees the order [1,2,3,4].  2-nd user sees the order [2,3,1,4].  3-rd user sees the order [3,2,1,4].  4-th user sees the order [4,2,3,1]. k people posted screenshots in the chat, which show the order of participants shown to this user. The screenshots were taken within a short period of time, and the order of participants has not changed. Your task is to determine whether there is a certain order that all screenshots correspond to." 1700
1931E "Anna and the Valentine\'s Day Gift" games,greedy,math,sortings "Sasha gave Anna a list a of n integers for Valentine\'s Day. Anna doesn\'t need this list, so she suggests destroying it by playing a game.Players take turns. Sasha is a gentleman, so he gives Anna the right to make the first move. On her turn, Anna must choose an element ai from the list and reverse the sequence of its digits. For example, if Anna chose the element with a value of 42, it would become 24; if Anna chose the element with a value of 1580, it would become 851. Note that leading zeros are removed. After such a turn, the number of elements in the list does not change. On his turn, Sasha must extract two elements ai and aj (i\xe2\x89\xa0j) from the list, concatenate them in any order and insert the result back into the list. For example, if Sasha chose the elements equal to 2007 and 19, he would remove these two elements from the list and add the integer 200719 or 192007. After such a turn, the number of elements in the list decreases by 1.Players can\'t skip turns. The game ends when Sasha can\'t make a move, i.e. after Anna\'s move there is exactly one number left in the list. If this integer is not less than 10m (i.e., \xe2\x89\xa510m), Sasha wins. Otherwise, Anna wins.It can be shown that the game will always end. Determine who will win if both players play optimally." 1400
1931D "Divisible Pairs" "combinatorics,math,number theory" "Polycarp has two favorite integers x and y (they can be equal), and he has found an array a of length n.Polycarp considers a pair of indices \xe2\x9f\xa8i,j\xe2\x9f\xa9 (1\xe2\x89\xa4i<j\xe2\x89\xa4n) beautiful if:   ai+aj is divisible by x;  ai\xe2\x88\x92aj is divisible by y. For example, if x=5, y=2, n=6, a=[1,2,7,4,9,6], then the only beautiful pairs are:   \xe2\x9f\xa81,5\xe2\x9f\xa9: a1+a5=1+9=10 (10 is divisible by 5) and a1\xe2\x88\x92a5=1\xe2\x88\x929=\xe2\x88\x928 (\xe2\x88\x928 is divisible by 2);  \xe2\x9f\xa84,6\xe2\x9f\xa9: a4+a6=4+6=10 (10 is divisible by 5) and a4\xe2\x88\x92a6=4\xe2\x88\x926=\xe2\x88\x922 (\xe2\x88\x922 is divisible by 2).  Find the number of beautiful pairs in the array a." 1300
1931C "Make Equal Again" "brute force,greedy,math" "You have an array a of n integers. You can no more than once apply the following operation: select three integers i, j, x (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n) and assign all elements of the array with indexes from i to j the value x. The price of this operation depends on the selected indices and is equal to (j\xe2\x88\x92i+1) burles. For example, the array is equal to [1,2,3,4,5,1]. If we choose i=2,j=4,x=8, then after applying this operation, the array will be equal to [1,8,8,8,5,1].What is the least amount of burles you need to spend to make all the elements of the array equal?" 1000
1931B "Make Equal" greedy "There are n containers of water lined up, numbered from left to right from 1 to n. Each container can hold any amount of water; initially, the i-th container contains ai units of water. The sum of ai is divisible by n.You can apply the following operation any (possibly zero) number of times: pour any amount of water from the i-th container to the j-th container, where i must be less than j (i.e. i<j). Any index can be chosen as i or j any number of times.Determine whether it is possible to make the amount of water in all containers the same using this operation." 800
1931A "Recovering a Small String" "brute force,strings" "Nikita had a word consisting of exactly 3 lowercase Latin letters. The letters in the Latin alphabet are numbered from 1 to 26, where the letter ""a"" has the index 1, and the letter ""z"" has the index 26.He encoded this word as the sum of the positions of all the characters in the alphabet. For example, the word ""cat"" he would encode as the integer 3+1+20=24, because the letter ""c"" has the index 3 in the alphabet, the letter ""a"" has the index 1, and the letter ""t"" has the index 20.However, this encoding turned out to be ambiguous! For example, when encoding the word ""ava"", the integer 1+22+1=24 is also obtained.Determine the lexicographically smallest word of 3 letters that could have been encoded.A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 800
1930I "Counting Is Fun" combinatorics "You are given a binary\xe2\x80\xa0 pattern p of length n.A binary string q of the same length n is called good if for every i (1\xe2\x89\xa4i\xe2\x89\xa4n), there exist indices l and r such that:   1\xe2\x89\xa4l\xe2\x89\xa4i\xe2\x89\xa4r\xe2\x89\xa4n, and  pi is a mode\xe2\x80\xa1 of the string qlql+1\xe2\x80\xa6qr. Count the number of good binary strings modulo 998244353.\xe2\x80\xa0 A binary string is a string that only consists of characters 0 and 1.\xe2\x80\xa1 Character c is a mode of string t of length m if the number of occurrences of c in t is at least \xe2\x8c\x88m2\xe2\x8c\x89. For example, 0 is a mode of 010, 1 is not a mode of 010, and both 0 and 1 are modes of 011010." 3500
1930H "Interactive Mex Tree" "constructive algorithms,dfs and similar,interactive,trees" "This is an interactive problem.Alice has a tree T consisting of n nodes, numbered from 1 to n. Alice will show T to Bob. After observing T, Bob needs to tell Alice two permutations p1 and p2 of [1,2,\xe2\x80\xa6,n].Then, Alice will play q rounds of the following game.  Alice will create an array a that is a permutation of [0,1,\xe2\x80\xa6,n\xe2\x88\x921]. The value of node v will be av.  Alice will choose two nodes u and v (1\xe2\x89\xa4u,v\xe2\x89\xa4n, u\xe2\x89\xa0v) of T and tell them to Bob. Bob will need to find the MEX\xe2\x80\xa0 of the values on the unique simple path between nodes u and v.  To find this value, Bob can ask Alice at most 5 queries. In each query, Bob should give three integers t, l and r to Alice such that t is either 1 or 2, and 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. Alice will then tell Bob the value equal to rmini=la[pt,i]. Note that all rounds are independent of each other. In particular, the values of a, u and v can be different in different rounds.Bob is puzzled as he only knows the HLD solution, which requires O(log(n)) queries per round. So he needs your help to win the game. \xe2\x80\xa0 The MEX (minimum excludant) of a collection of integers c1,c2,\xe2\x80\xa6,ck is defined as the smallest non-negative integer x which does not occur in the collection c." 3300
1930G "Prefix Max Set Counting" "data structures,dp,trees" "Define a function f such that for an array b, f(b) returns the array of prefix maxima of b. In other words, f(b) is an array containing only those elements bi, for which bi=max(b1,b2,\xe2\x80\xa6,bi), without changing their order. For example, f([3,10,4,10,15,1])=[3,10,10,15].You are given a tree consisting of n nodes rooted at 1.A permutation\xe2\x80\xa0 p of is considered a pre-order of the tree if for all i the following condition holds:   Let k be the number of proper descendants\xe2\x80\xa1 of node pi.  For all x such that i<x\xe2\x89\xa4i+k, px is a proper descendant of node pi. Find the number of distinct values of f(a) over all possible pre-orders a. Since this value might be large, you only need to find it modulo 998244353.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).\xe2\x80\xa1 Node t is a proper descendant of node s if s\xe2\x89\xa0t and s is on the unique simple path from t to 1." 3100
1930F "Maximize the Difference" "bitmasks,brute force,dfs and similar" "For an array b of m non-negative integers, define f(b) as the maximum value of mmaxi=1(bi|x)\xe2\x88\x92mmini=1(bi|x) over all possible non-negative integers x, where | is bitwise OR operation.You are given integers n and q. You start with an empty array a. Process the following q queries:  v: append v to the back of a and then output f(a). It is guaranteed that 0\xe2\x89\xa4v<n. The queries are given in a modified way." 2700
1930E "2..3...4.... Wonderful! Wonderful!" combinatorics,dp,math "Stack has an array a of length n such that ai=i for all i (1\xe2\x89\xa4i\xe2\x89\xa4n). He will select a positive integer k (1\xe2\x89\xa4k\xe2\x89\xa4\xe2\x8c\x8an\xe2\x88\x9212\xe2\x8c\x8b) and do the following operation on a any number (possibly 0) of times.  Select a subsequence\xe2\x80\xa0 s of length 2\xe2\x8b\x85k+1 from a. Now, he will delete the first k elements of s from a. To keep things perfectly balanced (as all things should be), he will also delete the last k elements of s from a. Stack wonders how many arrays a can he end up with for each k (1\xe2\x89\xa4k\xe2\x89\xa4\xe2\x8c\x8an\xe2\x88\x9212\xe2\x8c\x8b). As Stack is weak at counting problems, he needs your help. Since the number of arrays might be too large, please print it modulo 998244353.\xe2\x80\xa0 A sequence x is a subsequence of a sequence y if x can be obtained from y by deleting several (possibly, zero or all) elements. For example, [1,3], [1,2,3] and [2,3] are subsequences of [1,2,3]. On the other hand, [3,1] and [2,1,3] are not subsequences of [1,2,3]." 2400
1930D2 "Sum over all Substrings (Hard Version)" "bitmasks,divide and conquer,dp,dsu,greedy,implementation,strings" "This is the hard version of the problem. The only difference between the two versions is the constraint on t and n. You can make hacks only if both versions of the problem are solved.For a binary\xe2\x80\xa0 pattern p and a binary string q, both of length m, q is called p-good if for every i (1\xe2\x89\xa4i\xe2\x89\xa4m), there exist indices l and r such that:   1\xe2\x89\xa4l\xe2\x89\xa4i\xe2\x89\xa4r\xe2\x89\xa4m, and  pi is a mode\xe2\x80\xa1 of the string qlql+1\xe2\x80\xa6qr. For a pattern p, let f(p) be the minimum possible number of 1s in a p-good binary string (of the same length as the pattern).You are given a binary string s of size n. Find n\xe2\x88\x91i=1n\xe2\x88\x91j=if(sisi+1\xe2\x80\xa6sj). In other words, you need to sum the values of f over all n(n+1)2 substrings of s.\xe2\x80\xa0 A binary pattern is a string that only consists of characters 0 and 1.\xe2\x80\xa1 Character c is a mode of string t of length m if the number of occurrences of c in t is at least \xe2\x8c\x88m2\xe2\x8c\x89. For example, 0 is a mode of 010, 1 is not a mode of 010, and both 0 and 1 are modes of 011010." 2100
1930D1 "Sum over all Substrings (Easy Version)" "brute force,dp,greedy,strings" "This is the easy version of the problem. The only difference between the two versions is the constraint on t and n. You can make hacks only if both versions of the problem are solved.For a binary\xe2\x80\xa0 pattern p and a binary string q, both of length m, q is called p-good if for every i (1\xe2\x89\xa4i\xe2\x89\xa4m), there exist indices l and r such that:   1\xe2\x89\xa4l\xe2\x89\xa4i\xe2\x89\xa4r\xe2\x89\xa4m, and  pi is a mode\xe2\x80\xa1 of the string qlql+1\xe2\x80\xa6qr. For a pattern p, let f(p) be the minimum possible number of 1s in a p-good binary string (of the same length as the pattern).You are given a binary string s of size n. Find n\xe2\x88\x91i=1n\xe2\x88\x91j=if(sisi+1\xe2\x80\xa6sj). In other words, you need to sum the values of f over all n(n+1)2 substrings of s.\xe2\x80\xa0 A binary pattern is a string that only consists of characters 0 and 1.\xe2\x80\xa1 Character c is a mode of string t of length m if the number of occurrences of c in t is at least \xe2\x8c\x88m2\xe2\x8c\x89. For example, 0 is a mode of 010, 1 is not a mode of 010, and both 0 and 1 are modes of 011010." 1800
1930C "Lexicographically Largest" "binary search,constructive algorithms,data structures,greedy,sortings" "Stack has an array a of length n. He also has an empty set S. Note that S is not a multiset.He will do the following three-step operation exactly n times:  Select an index i such that 1\xe2\x89\xa4i\xe2\x89\xa4|a|.  Insert\xe2\x80\xa0 ai+i into S.  Delete ai from a. Note that the indices of all elements to the right of ai will decrease by 1. Note that after n operations, a will be empty.Stack will now construct a new array b which is S sorted in decreasing order. Formally, b is an array of size |S| where bi is the i-th largest element of S for all 1\xe2\x89\xa4i\xe2\x89\xa4|S|.Find the lexicographically largest\xe2\x80\xa1 b that Stack can make.\xe2\x80\xa0 A set can only contain unique elements. Inserting an element that is already present in a set will not change the elements of the set.\xe2\x80\xa1 An array p is lexicographically larger than a sequence q if and only if one of the following holds:   q is a prefix of p, but p\xe2\x89\xa0q; or  in the first position where p and q differ, the array p has a larger element than the corresponding element in q. Note that [3,1,4,1,5] is lexicographically larger than [3,1,3], [], and [3,1,4,1] but not [3,1,4,1,5,9], [3,1,4,1,5], and [4]." 1700
1930B "Permutation Printing" "brute force,constructive algorithms,math" "You are given a positive integer n.Find a permutation\xe2\x80\xa0 p of length n such that there do not exist two distinct indices i and j (1\xe2\x89\xa4i,j<n; i\xe2\x89\xa0j) such that pi divides pj and pi+1 divides pj+1.Refer to the Notes section for some examples.Under the constraints of this problem, it can be proven that at least one p exists.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1000
1930A "Maximise The Score" greedy,sortings "There are 2n positive integers written on a whiteboard. Being bored, you decided to play a one-player game with the numbers on the whiteboard.You start with a score of 0. You will increase your score by performing the following move exactly n times:   Choose two integers x and y that are written on the whiteboard.  Add min(x,y) to your score.  Erase x and y from the whiteboard.  Note that after performing the move n times, there will be no more integers written on the whiteboard.Find the maximum final score you can achieve if you optimally perform the n moves." 800
1929F "Sasha and the Wedding Binary Search Tree" "brute force,combinatorics,data structures,dfs and similar,math,trees" "Having overcome all the difficulties and hardships, Sasha finally decided to marry his girlfriend. To do this, he needs to give her an engagement ring. However, his girlfriend does not like such romantic gestures, but she does like binary search trees\xe2\x80\xa0. So Sasha decided to give her such a tree.After spending a lot of time on wedding websites for programmers, he found the perfect binary search tree with the root at vertex 1. In this tree, the value at vertex v is equal to valv.But after some time, he forgot the values in some vertices. Trying to remember the found tree, Sasha wondered \xe2\x80\x94 how many binary search trees could he have found on the website, if it is known that the values in all vertices are integers in the segment [1,C]. Since this number can be very large, output it modulo 998244353.\xe2\x80\xa0A binary search tree is a rooted binary tree in which for any vertex x, the following property holds: the values of all vertices in the left subtree of vertex x (if it exists) are less than or equal to the value at vertex x, and the values of all vertices in the right subtree of vertex x (if it exists) are greater than or equal to the value at vertex x." 2300
1929E "Sasha and the Happy Tree Cutting" "bitmasks,brute force,dfs and similar,dp,graphs,greedy,math,trees" "Sasha was given a tree\xe2\x80\xa0 with n vertices as a prize for winning yet another competition. However, upon returning home after celebrating his victory, he noticed that some parts of the tree were missing. Sasha remembers that he colored some of the edges of this tree. He is certain that for any of the k pairs of vertices (a1,b1),\xe2\x80\xa6,(ak,bk), he colored at least one edge on the simple path\xe2\x80\xa1 between vertices ai and bi.Sasha does not remember how many edges he exactly colored, so he asks you to tell him the minimum number of edges he could have colored to satisfy the above condition.\xe2\x80\xa0A tree is an undirected connected graph without cycles.\xe2\x80\xa1A simple path is a path that passes through each vertex at most once." 2300
1929D "Sasha and a Walk in the City" combinatorics,dp,math,trees "Sasha wants to take a walk with his girlfriend in the city. The city consists of n intersections, numbered from 1 to n. Some of them are connected by roads, and from any intersection, there is exactly one simple path\xe2\x80\xa0 to any other intersection. In other words, the intersections and the roads between them form a tree.Some of the intersections are considered dangerous. Since it is unsafe to walk alone in the city, Sasha does not want to visit three or more dangerous intersections during the walk.Sasha calls a set of intersections good if the following condition is satisfied: If in the city only the intersections contained in this set are dangerous, then any simple path in the city contains no more than two dangerous intersections.However, Sasha does not know which intersections are dangerous, so he is interested in the number of different good sets of intersections in the city. Since this number can be very large, output it modulo 998244353.\xe2\x80\xa0A simple path is a path that passes through each intersection at most once." 1900
1929C "Sasha and the Casino" "binary search,brute force,constructive algorithms,games,greedy,math" "Sasha decided to give his girlfriend the best handbag, but unfortunately for Sasha, it is very expensive. Therefore, Sasha wants to earn it. After looking at earning tips on the internet, he decided to go to the casino.Sasha knows that the casino operates under the following rules. If Sasha places a bet of y coins (where y is a positive integer), then in case of winning, he will receive y\xe2\x8b\x85k coins (i.e., his number of coins will increase by y\xe2\x8b\x85(k\xe2\x88\x921)). And in case of losing, he will lose the entire bet amount (i.e., his number of coins will decrease by y).Note that the bet amount must always be a positive (>0) integer and cannot exceed Sasha\'s current number of coins.Sasha also knows that there is a promotion at the casino: he cannot lose more than x times in a row.Initially, Sasha has a coins. He wonders whether he can place bets such that he is guaranteed to win any number of coins. In other words, is it true that for any integer n, Sasha can make bets so that for any outcome that does not contradict the rules described above, at some moment of time he will have at least n coins." 1400
1929B "Sasha and the Drawing" "constructive algorithms,greedy,math" "Even in kindergarten, Sasha liked a girl. Therefore, he wanted to give her a drawing and attract her attention.As a drawing, he decided to draw a square grid of size n\xc3\x97n, in which some cells are colored. But coloring the cells is difficult, so he wants to color as few cells as possible. But at the same time, he wants at least k diagonals to have at least one colored cell. Note that the square grid of size n\xc3\x97n has a total of 4n\xe2\x88\x922 diagonals.Help little Sasha to make the girl fall in love with him and tell him the minimum number of cells he needs to color." 800
1929A "Sasha and the Beautiful Array" "constructive algorithms,greedy,math,sortings" "Sasha decided to give his girlfriend an array a1,a2,\xe2\x80\xa6,an. He found out that his girlfriend evaluates the beauty of the array as the sum of the values (ai\xe2\x88\x92ai\xe2\x88\x921) for all integers i from 2 to n.Help Sasha and tell him the maximum beauty of the array a that he can obtain, if he can rearrange its elements in any way." 800
1928F "Digital Patterns" "combinatorics,data structures,implementation,math" "Anya is engaged in needlework. Today she decided to knit a scarf from semi-transparent threads. Each thread is characterized by a single integer \xe2\x80\x94 the transparency coefficient.The scarf is made according to the following scheme: horizontal threads with transparency coefficients a1,a2,\xe2\x80\xa6,an and vertical threads with transparency coefficients b1,b2,\xe2\x80\xa6,bm are selected. Then they are interwoven as shown in the picture below, forming a piece of fabric of size n\xc3\x97m, consisting of exactly nm nodes:  Example of a piece of fabric for n=m=4. After the interweaving tightens and there are no gaps between the threads, each node formed by a horizontal thread with number i and a vertical thread with number j will turn into a cell, which we will denote as (i,j). Cell (i,j) will have a transparency coefficient of ai+bj.The interestingness of the resulting scarf will be the number of its sub-squares\xe2\x80\xa0 in which there are no pairs of neighboring\xe2\x80\xa0\xe2\x80\xa0 cells with the same transparency coefficients.Anya has not yet decided which threads to use for the scarf, so you will also be given q queries to increase/decrease the coefficients for the threads on some ranges. After each query of which you need to output the interestingness of the resulting scarf.\xe2\x80\xa0A sub-square of a piece of fabric is defined as the set of all its cells (i,j), such that x0\xe2\x89\xa4i\xe2\x89\xa4x0+d and y0\xe2\x89\xa4j\xe2\x89\xa4y0+d for some integers x0, y0, and d (1\xe2\x89\xa4x0\xe2\x89\xa4n\xe2\x88\x92d, 1\xe2\x89\xa4y0\xe2\x89\xa4m\xe2\x88\x92d, d\xe2\x89\xa50).\xe2\x80\xa0\xe2\x80\xa0. Cells (i1,j1) and (i2,j2) are neighboring if and only if |i1\xe2\x88\x92i2|+|j1\xe2\x88\x92j2|=1." 2900
1928E "Modular Sequence" "brute force,constructive algorithms,dp,graphs,greedy,math,number theory" "You are given two integers x and y. A sequence a of length n is called modular if a1=x, and for all 1<i\xe2\x89\xa4n the value of ai is either ai\xe2\x88\x921+y or ai\xe2\x88\x921mody. Here xmody denotes the remainder from dividing x by y.Determine if there exists a modular sequence of length n with the sum of its elements equal to S, and if it exists, find any such sequence." 2300
1928D "Lonely Mountain Dungeons" "brute force,data structures,greedy,math,ternary search" "Once, the people, elves, dwarves, and other inhabitants of Middle-earth gathered to reclaim the treasures stolen from them by Smaug. In the name of this great goal, they rallied around the powerful elf Timothy and began to plan the overthrow of the ruler of the Lonely Mountain.The army of Middle-earth inhabitants will consist of several squads. It is known that each pair of creatures of the same race, which are in different squads, adds b units to the total strength of the army. But since it will be difficult for Timothy to lead an army consisting of a large number of squads, the total strength of an army consisting of k squads is reduced by (k\xe2\x88\x921)\xe2\x8b\x85x units. Note that the army always consists of at least one squad.It is known that there are n races in Middle-earth, and the number of creatures of the i-th race is equal to ci. Help the inhabitants of Middle-earth determine the maximum strength of the army they can assemble." 1900
1928C "Physical Education Lesson" "brute force,math,number theory" "In a well-known school, a physical education lesson took place. As usual, everyone was lined up and asked to settle in ""the first\xe2\x80\x93k-th"" position.As is known, settling in ""the first\xe2\x80\x93k-th"" position occurs as follows: the first k people have numbers 1,2,3,\xe2\x80\xa6,k, the next k\xe2\x88\x922 people have numbers k\xe2\x88\x921,k\xe2\x88\x922,\xe2\x80\xa6,2, the next k people have numbers 1,2,3,\xe2\x80\xa6,k, and so on. Thus, the settling repeats every 2k\xe2\x88\x922 positions. Examples of settling are given in the ""Note"" section.The boy Vasya constantly forgets everything. For example, he forgot the number k described above. But he remembers the position he occupied in the line, as well as the number he received during the settling. Help Vasya understand how many natural numbers k fit under the given constraints.Note that the settling exists if and only if k>1. In particular, this means that the settling does not exist for k=1." 1600
1928B Equalize "binary search,greedy,sortings,two pointers" "Vasya has two hobbies \xe2\x80\x94 adding permutations\xe2\x80\xa0 to arrays and finding the most frequently occurring element. Recently, he found an array a and decided to find out the maximum number of elements equal to the same number in the array a that he can obtain after adding some permutation to the array a.More formally, Vasya must choose exactly one permutation p1,p2,p3,\xe2\x80\xa6,pn of length n, and then change the elements of the array a according to the rule ai:=ai+pi. After that, Vasya counts how many times each number occurs in the array a and takes the maximum of these values. You need to determine the maximum value he can obtain.\xe2\x80\xa0A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1200
1928A "Rectangle Cutting" geometry,math "Bob has a rectangle of size a\xc3\x97b. He tries to cut this rectangle into two rectangles with integer sides by making a cut parallel to one of the sides of the original rectangle. Then Bob tries to form some other rectangle from the two resulting rectangles, and he can rotate and move these two rectangles as he wishes.Note that if two rectangles differ only by a 90\xe2\x88\x98 rotation, they are considered the same. For example, the rectangles 6\xc3\x974 and 4\xc3\x976 are considered the same.Thus, from the 2\xc3\x976 rectangle, another rectangle can be formed, because it can be cut into two 2\xc3\x973 rectangles, and then these two rectangles can be used to form the 4\xc3\x973 rectangle, which is different from the 2\xc3\x976 rectangle.  However, from the 2\xc3\x971 rectangle, another rectangle cannot be formed, because it can only be cut into two rectangles of 1\xc3\x971, and from these, only the 1\xc3\x972 and 2\xc3\x971 rectangles can be formed, which are considered the same.  Help Bob determine if he can obtain some other rectangle, or if he is just wasting his time." 800
1927G "Paint Charges" "data structures,dp,greedy,math" "A horizontal grid strip of n cells is given. In the i-th cell, there is a paint charge of size ai. This charge can be:  either used to the left \xe2\x80\x94 then all cells to the left at a distance less than ai (from max(i\xe2\x88\x92ai+1,1) to i inclusive) will be painted,  or used to the right \xe2\x80\x94 then all cells to the right at a distance less than ai (from i to min(i+ai\xe2\x88\x921,n) inclusive) will be painted,  or not used at all. Note that a charge can be used no more than once (that is, it cannot be used simultaneously to the left and to the right). It is allowed for a cell to be painted more than once.What is the minimum number of times a charge needs to be used to paint all the cells of the strip?" 2300
1927F Microcycle "data structures,dfs and similar,dsu,graphs,greedy,implementation,sortings,trees" "Given an undirected weighted graph with n vertices and m edges. There is at most one edge between each pair of vertices in the graph, and the graph does not contain loops (edges from a vertex to itself). The graph is not necessarily connected.A cycle in the graph is called simple if it doesn\'t pass through the same vertex twice and doesn\'t contain the same edge twice.Find any simple cycle in this graph in which the weight of the lightest edge is minimal." 1900
1927E "Klever Permutation" "constructive algorithms,math,two pointers" "You are given two integers n and k (k\xe2\x89\xa4n), where k is even.A permutation of length n is an array consisting of n distinct integers from 1 to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (as 2 appears twice in the array) and [0,1,2] is also not a permutation (as n=3, but 3 is not present in the array).Your task is to construct a k-level permutation of length n.A permutation is called k-level if, among all the sums of continuous segments of length k (of which there are exactly n\xe2\x88\x92k+1), any two sums differ by no more than 1.More formally, to determine if the permutation p is k-level, first construct an array s of length n\xe2\x88\x92k+1, where si=\xe2\x88\x91i+k\xe2\x88\x921j=ipj, i.e., the i-th element is equal to the sum of pi,pi+1,\xe2\x80\xa6,pi+k\xe2\x88\x921.A permutation is called k-level if max(s)\xe2\x88\x92min(s)\xe2\x89\xa41.Find any k-level permutation of length n." 1400
1927D "Find the Different Ones!" "binary search,brute force,data structures,dp,dsu,greedy,two pointers" "You are given an array a of n integers, and q queries.Each query is represented by two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). Your task is to find, for each query, two indices i and j (or determine that they do not exist) such that:  l\xe2\x89\xa4i\xe2\x89\xa4r;  l\xe2\x89\xa4j\xe2\x89\xa4r;  ai\xe2\x89\xa0aj. In other words, for each query, you need to find a pair of different elements among al,al+1,\xe2\x80\xa6,ar, or report that such a pair does not exist." 1300
1927C "Choose the Different Ones!" "brute force,greedy,math" "Given an array a of n integers, an array b of m integers, and an even number k.Your task is to determine whether it is possible to choose exactly k2 elements from both arrays in such a way that among the chosen elements, every integer from 1 to k is included.For example:  If a=[2,3,8,5,6,5], b=[1,3,4,10,5], k=6, then it is possible to choose elements with values 2,3,6 from array a and elements with values 1,4,5 from array b. In this case, all numbers from 1 to k=6 will be included among the chosen elements. If a=[2,3,4,5,6,5], b=[1,3,8,10,3], k=6, then it is not possible to choose elements in the required way. Note that you are not required to find a way to choose the elements \xe2\x80\x94 your program should only check whether it is possible to choose the elements in the required way." 1000
1927B "Following the String" "constructive algorithms,greedy,strings" "Polycarp lost the string s of length n consisting of lowercase Latin letters, but he still has its trace.The trace of the string s is an array a of n integers, where ai is the number of such indices j (j<i) that si=sj. For example, the trace of the string abracadabra is the array [0,0,0,1,0,2,0,3,1,1,4].Given a trace of a string, find any string s from which it could have been obtained. The string s should consist only of lowercase Latin letters a-z." 900
1927A "Make it White" greedy,strings "You have a horizontal strip of n cells. Each cell is either white or black.You can choose a continuous segment of cells once and paint them all white. After this action, all the black cells in this segment will become white, and the white ones will remain white.What is the minimum length of the segment that needs to be painted white in order for all n cells to become white?" 800
1926G "Vlad and Trouble at MIT" "dfs and similar,dp,flows,graphs,greedy,implementation,trees" "Vladislav has a son who really wanted to go to MIT. The college dormitory at MIT (Moldova Institute of Technology) can be represented as a tree with n vertices, each vertex being a room with exactly one student. A tree is a connected undirected graph with n vertices and n\xe2\x88\x921 edges.Tonight, there are three types of students:   students who want to party and play music (marked with P),  students who wish to sleep and enjoy silence (marked with S), and  students who don\'t care (marked with C). Initially, all the edges are thin walls which allow music to pass through, so when a partying student puts music on, it will be heard in every room. However, we can place some thick walls on any edges \xe2\x80\x94 thick walls don\'t allow music to pass through them.The university wants to install some thick walls so that every partying student can play music, and no sleepy student can hear it.Because the university lost a lot of money in a naming rights lawsuit, they ask you to find the minimum number of thick walls they will need to use." 1900
1926F "Vlad and Avoiding X" "bitmasks,brute force,dfs and similar,dp,implementation" "Vladislav has a grid of size 7\xc3\x977, where each cell is colored black or white. In one operation, he can choose any cell and change its color (black \xe2\x86\x94 white).Find the minimum number of operations required to ensure that there are no black cells with four diagonal neighbors also being black. The left image shows that initially there are two black cells violating the condition. By flipping one cell, the grid will work." 2200
1926E "Vlad and an Odd Ordering" "binary search,bitmasks,data structures,dp,implementation,math,number theory" "Vladislav has n cards numbered 1,2,\xe2\x80\xa6,n. He wants to lay them down in a row as follows:   First, he lays down all the odd-numbered cards from smallest to largest.  Next, he lays down all cards that are twice an odd number from smallest to largest (i.e. 2 multiplied by an odd number).  Next, he lays down all cards that are 3 times an odd number from smallest to largest (i.e. 3 multiplied by an odd number).  Next, he lays down all cards that are 4 times an odd number from smallest to largest (i.e. 4 multiplied by an odd number).  And so on, until all cards are laid down.  What is the k-th card he lays down in this process? Once Vladislav puts a card down, he cannot use that card again." 1500
1926D "Vlad and Division" bitmasks,greedy "Vladislav has n non-negative integers, and he wants to divide all of them into several groups so that in any group, any pair of numbers does not have matching bit values among bits from 1-st to 31-st bit (i.e., considering the 31 least significant bits of the binary representation).For an integer k, let k2(i) denote the i-th bit in its binary representation (from right to left, indexing from 1). For example, if k=43, since 43=1010112, then 432(1)=1, 432(2)=1, 432(3)=0, 432(4)=1, 432(5)=0, 432(6)=1, 432(7)=0, 432(8)=0,\xe2\x80\xa6,432(31)=0.Formally, for any two numbers x and y in the same group, the condition x2(i)\xe2\x89\xa0y2(i) must hold for all 1\xe2\x89\xa4i<32.What is the minimum number of groups Vlad needs to achieve his goal? Each number must fall into exactly one group." 1300
1926C "Vlad and a Sum of Sum of Digits" dp,implementation "Please note that the time limit for this problem is only 0.5 seconds per test.Vladislav wrote the integers from 1 to n, inclusive, on the board. Then he replaced each integer with the sum of its digits.What is the sum of the numbers on the board now?For example, if n=12 then initially the numbers on the board are: 1,2,3,4,5,6,7,8,9,10,11,12. Then after the replacement, the numbers become: 1,2,3,4,5,6,7,8,9,1,2,3. The sum of these numbers is 1+2+3+4+5+6+7+8+9+1+2+3=51. Thus, for n=12 the answer is 51." 1200
1926B "Vlad and Shapes" geometry,implementation "Vladislav has a binary square grid of n\xc3\x97n cells. A triangle or a square is drawn on the grid with symbols 1. As he is too busy being cool, he asks you to tell him which shape is drawn on the grid. A triangle is a shape consisting of k (k>1) consecutive rows, where the i-th row has 2\xe2\x8b\x85i\xe2\x88\x921 consecutive characters 1, and the central 1s are located in one column. An upside down triangle is also considered a valid triangle (but not rotated by 90 degrees).  Two left pictures contain examples of triangles: k=4, k=3. The two right pictures don\'t contain triangles.  A square is a shape consisting of k (k>1) consecutive rows, where the i-th row has k consecutive characters 1, which are positioned at an equal distance from the left edge of the grid.  Examples of two squares: k=2, k=4. For the given grid, determine the type of shape that is drawn on it." 800
1926A "Vlad and the Best of Five" implementation "Vladislav has a string of length 5, whose characters are each either A or B.Which letter appears most frequently: A or B?" 800
1925D "Good Trip" combinatorics,dp,math,probabilities "There are n children in a class, m pairs among them are friends. The i-th pair who are friends have a friendship value of fi. The teacher has to go for k excursions, and for each of the excursions she chooses a pair of children randomly, equiprobably and independently. If a pair of children who are friends is chosen, their friendship value increases by 1 for all subsequent excursions (the teacher can choose a pair of children more than once). The friendship value of a pair who are not friends is considered 0, and it does not change for subsequent excursions. Find the expected value of the sum of friendship values of all k pairs chosen for the excursions (at the time of being chosen). It can be shown that this answer can always be expressed as a fraction pq where p and q are coprime integers. Calculate p\xe2\x8b\x85q\xe2\x88\x921mod(109+7)." 1900
1925B "A Balanced Problemset?" "brute force,greedy,math,number theory" "Jay managed to create a problem of difficulty x and decided to make it the second problem for Codeforces Round #921. But Yash fears that this problem will make the contest highly unbalanced, and the coordinator will reject it. So, he decided to break it up into a problemset of n sub-problems such that the difficulties of all the sub-problems are a positive integer and their sum is equal to x. The coordinator, Aleksey, defines the balance of a problemset as the GCD of the difficulties of all sub-problems in the problemset. Find the maximum balance that Yash can achieve if he chooses the difficulties of the sub-problems optimally." 1200
1925A "We Got Everything Covered!" "constructive algorithms,greedy,strings" "You are given two positive integers n and k. Your task is to find a string s such that all possible strings of length n that can be formed using the first k lowercase English alphabets occur as a subsequence of s. If there are multiple answers, print the one with the smallest length. If there are still multiple answers, you may print any of them.Note: A string a is called a subsequence of another string b if a can be obtained by deleting some (possibly zero) characters from b without changing the order of the remaining characters." 800
1924F "Anti-Proxy Attendance" "constructive algorithms,dp,interactive,ternary search" "This is an interactive problem!Mr. 1048576 is one of those faculty who hates wasting his time in taking class attendance. Instead of taking attendance the old-fashioned way, he decided to try out something new today.There are n students in his class, having roll numbers 1 to n. He knows that exactly 1 student is absent today. In order to determine who is absent, he can ask some queries to the class. In each query, he can provide two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and all students whose roll numbers are between l and r (inclusive) will raise their hands. He then counts them to determine if the roll number of the absent student lies between these values.Things seemed fine until his teaching assistant noticed something \xe2\x80\x94 the students are dishonest! Some students whose roll numbers lie in the given range may not raise their hands, while some other students whose roll number does not lie in the given range may raise their hands. But the students don\'t want to raise much suspicion. So, only the following 4 cases are possible for a particular query (l,r) \xe2\x80\x94   True Positive: r\xe2\x88\x92l+1 students are present and r\xe2\x88\x92l+1 students raised their hands.  True Negative: r\xe2\x88\x92l students are present and r\xe2\x88\x92l students raised their hands.  False Positive: r\xe2\x88\x92l students are present but r\xe2\x88\x92l+1 students raised their hands.  False Negative: r\xe2\x88\x92l+1 students are present but r\xe2\x88\x92l students raised their hands. In the first two cases, the students are said to be answering honestly, while in the last two cases, the students are said to be answering dishonestly. The students can mutually decide upon their strategy, not known to Mr. 1048576. Also, the students do not want to raise any suspicion and at the same time, want to create a lot of confusion. So, their strategy always meets the following two conditions \xe2\x80\x94   The students will never answer honestly 3 times in a row.  The students will never answer dishonestly 3 times in a row. Mr. 1048576 is frustrated by this act of students. So, he is willing to mark at most 2 students as absent (though he knows that only one is). The attendance is said to be successful if the student who is actually absent is among those two. Also, due to limited class time, he can only ask up to \xe2\x8c\x88log1.116n\xe2\x8c\x89\xe2\x88\x921 queries (weird numbers but okay). Help him complete a successful attendance." 3500
1924E "Paper Cutting Again" combinatorics,probabilities "There is a rectangular sheet of paper with initial height n and width m. Let the current height and width be h and w respectively. We introduce a xy-coordinate system so that the four corners of the sheet are (0,0),(w,0),(0,h), and (w,h). The sheet can then be cut along the lines x=1,2,\xe2\x80\xa6,w\xe2\x88\x921 and the lines y=1,2,\xe2\x80\xa6,h\xe2\x88\x921. In each step, the paper is cut randomly along any one of these h+w\xe2\x88\x922 lines. After each vertical and horizontal cut, the right and bottom piece of paper respectively are discarded.Find the expected number of steps required to make the area of the sheet of paper strictly less than k. It can be shown that this answer can always be expressed as a fraction pq where p and q are coprime integers. Calculate p\xe2\x8b\x85q\xe2\x88\x921mod(109+7)." 3100
1924D "Balanced Subsequences" combinatorics,dp,math "A sequence of brackets is called balanced if one can turn it into a valid math expression by adding characters \'+\' and \'1\'. For example, sequences \'(())()\', \'()\', and \'(()(()))\' are balanced, while \')(\', \'(()\', and \'(()))(\' are not.A subsequence is a sequence that can be derived from the given sequence by deleting zero or more elements without changing the order of the remaining elements.You are given three integers n, m and k. Find the number of sequences consisting of n \'(\' and m \')\', such that the longest balanced subsequence is of length 2\xe2\x8b\x85k. Since the answer can be large calculate it modulo 1000000007 (109+7)." 2700
1924C "Fractal Origami" geometry,math,matrices "You have a square piece of paper with a side length equal to 1 unit. In one operation, you fold each corner of the square to the center of the paper, thus forming another square with a side length equal to 12\xe2\x80\x93\xe2\x88\x9a units. By taking this square as a new square, you do the operation again and repeat this process a total of N times.  Performing operations for N=2. After performing the set of operations, you open the paper with the same side up you started with and see some crease lines on it. Every crease line is one of two types: a mountain or a valley. A mountain is when the paper folds outward, and a valley is when the paper folds inward.You calculate the sum of the length of all mountain crease lines on the paper and call it M. Similarly, you calculate for valley crease lines and call it V. You want to find the value of MV.It can be proved that this value can be represented in the form of A+B2\xe2\x80\x93\xe2\x88\x9a, where A and B are rational numbers. Let this B be represented as an irreducible fraction pq, your task is to print p\xe2\x88\x97inv(q) modulo 999999893 (note the unusual modulo), where inv(q) is the modular inverse of q." 2400
1924B "Space Harbour" "data structures,implementation,math,sortings" "There are n points numbered 1 to n on a straight line. Initially, there are m harbours. The i-th harbour is at point Xi and has a value Vi. It is guaranteed that there are harbours at the points 1 and n. There is exactly one ship on each of the n points. The cost of moving a ship from its current location to the next harbour is the product of the value of the nearest harbour to its left and the distance from the nearest harbour to its right. Specifically, if a ship is already at a harbour, the cost of moving it to the next harbour is 0. Additionally, there are q queries, each of which is either of the following 2 types:  1 x v \xe2\x80\x94 Add a harbour at point x with value v. It is guaranteed that before adding the harbour, there is no harbour at point x.  2 l r \xe2\x80\x94 Print the sum of the cost of moving all ships at points from l to r to their next harbours. Note that you just need to calculate the cost of moving the ships but not actually move them." 2100
1924A "Did We Get Everything Covered?" "constructive algorithms,dp,greedy,shortest paths,strings" "You are given two integers n and k along with a string s.Your task is to check whether all possible strings of length n that can be formed using the first k lowercase English alphabets occur as a subsequence of s. If the answer is NO, you also need to print a string of length n that can be formed using the first k lowercase English alphabets which does not occur as a subsequence of s.If there are multiple answers, you may print any of them.Note: A string a is called a subsequence of another string b if a can be obtained by deleting some (possibly zero) characters from b without changing the order of the remaining characters." 1500
1923F Shrink-Reverse "binary search,brute force,greedy,hashing,implementation,string suffix structures,strings" "You are given a binary string s of length n (a string consisting of n characters, and each character is either 0 or 1).Let\'s look at s as at a binary representation of some integer, and name that integer as the value of string s. For example, the value of 000 is 0, the value of 01101 is 13, ""100000"" is 32 and so on.You can perform at most k operations on s. Each operation should have one of the two following types:   SWAP: choose two indices i<j in s and swap si with sj;  SHRINK-REVERSE: delete all leading zeroes from s and reverse s.  For example, after you perform SHRINK-REVERSE on 000101100, you\'ll get 001101.What is the minimum value of s you can achieve by performing at most k operations on s?" 2800
1923E "Count Paths" "data structures,dfs and similar,dp,dsu,graphs,trees" "You are given a tree, consisting of n vertices, numbered from 1 to n. Every vertex is colored in some color, denoted by an integer from 1 to n.A simple path of the tree is called beautiful if:   it consists of at least 2 vertices;  the first and the last vertices of the path have the same color;  no other vertex on the path has the same color as the first vertex. Count the number of the beautiful simple paths of the tree. Note that paths are considered undirected (i. e. the path from x to y is the same as the path from y to x)." 2000
1923D Slimes "binary search,constructive algorithms,data structures,greedy,two pointers" "There are n slimes placed in a line. The slimes are numbered from 1 to n in order from left to right. The size of the i-th slime is ai.Every second, the following happens: exactly one slime eats one of its neighbors and increases its size by the eaten neighbor\'s size. A slime can eat its neighbor only if it is strictly bigger than this neighbor. If there is no slime which is strictly bigger than one of its neighbors, the process ends.For example, suppose n=5, a=[2,2,3,1,4]. The process can go as follows:  first, the 3-rd slime eats the 2-nd slime. The size of the 3-rd slime becomes 5, the 2-nd slime is eaten.  then, the 3-rd slime eats the 1-st slime (they are neighbors since the 2-nd slime is already eaten). The size of the 3-rd slime becomes 7, the 1-st slime is eaten.  then, the 5-th slime eats the 4-th slime. The size of the 5-th slime becomes 5, the 4-th slime is eaten.  then, the 3-rd slime eats the 5-th slime (they are neighbors since the 4-th slime is already eaten). The size of the 3-rd slime becomes 12, the 5-th slime is eaten. For each slime, calculate the minimum number of seconds it takes for this slime to be eaten by another slime (among all possible ways the process can go), or report that it is impossible." 1800
1923C "Find B" "constructive algorithms,greedy" "An array a of length m is considered good if there exists an integer array b of length m such that the following conditions hold:   m\xe2\x88\x91i=1ai=m\xe2\x88\x91i=1bi;   ai\xe2\x89\xa0bi for every index i from 1 to m;   bi>0 for every index i from 1 to m. You are given an array c of length n. Each element of this array is greater than 0.You have to answer q queries. During the i-th query, you have to determine whether the subarray cli,cli+1,\xe2\x80\xa6,cri is good." 1400
1923B "Monsters Attack!" dp,greedy,implementation "You are playing a computer game. The current level of this game can be modeled as a straight line. Your character is in point 0 of this line. There are n monsters trying to kill your character; the i-th monster has health equal to ai and is initially in the point xi.Every second, the following happens:  first, you fire up to k bullets at monsters. Each bullet targets exactly one monster and decreases its health by 1. For each bullet, you choose its target arbitrary (for example, you can fire all bullets at one monster, fire all bullets at different monsters, or choose any other combination). Any monster can be targeted by a bullet, regardless of its position and any other factors;  then, all alive monsters with health 0 or less die;  then, all alive monsters move 1 point closer to you (monsters to the left of you increase their coordinates by 1, monsters to the right of you decrease their coordinates by 1). If any monster reaches your character (moves to the point 0), you lose. Can you survive and kill all n monsters without letting any of them reach your character?" 1100
1923A "Moving Chips" greedy,implementation "There is a ribbon divided into n cells, numbered from 1 to n from left to right. Each cell either contains a chip or is free.You can perform the following operation any number of times (possibly zero): choose a chip and move it to the closest free cell to the left. You can choose any chip that you want, provided that there is at least one free cell to the left of it. When you move the chip, the cell where it was before the operation becomes free.Your goal is to move the chips in such a way that they form a single block, without any free cells between them. What is the minimum number of operations you have to perform?" 800
1922F "Replace on Segment" "dp,graph matchings" "You are given an array a1,a2,\xe2\x80\xa6,an, where each element is an integer from 1 to x.You can perform the following operation with it any number of times:  choose three integers l, r and k such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4k\xe2\x89\xa4x and each element ai such that l\xe2\x89\xa4i\xe2\x89\xa4r is different from k. Then, for each i\xe2\x88\x88[l,r], replace ai with k. In other words, you choose a subsegment of the array and an integer from 1 to x which does not appear in that subsegment, and replace every element in the subsegment with that chosen integer.Your goal is to make all elements in the array equal. What is the minimum number of operations that you have to perform?" 2500
1922E "Increasing Subsequences" "bitmasks,constructive algorithms,divide and conquer,greedy,math" "Let\'s recall that an increasing subsequence of the array a is a sequence that can be obtained from it by removing some elements without changing the order of the remaining elements, and the remaining elements are strictly increasing (i.\xe2\x80\x89e ab1<ab2<\xe2\x8b\xaf<abk and b1<b2<\xe2\x8b\xaf<bk). Note that an empty subsequence is also increasing.You are given a positive integer X. Your task is to find an array of integers of length at most 200, such that it has exactly X increasing subsequences, or report that there is no such array. If there are several answers, you can print any of them.If two subsequences consist of the same elements, but correspond to different positions in the array, they are considered different (for example, the array [2,2] has two different subsequences equal to [2])." 1800
1922D "Berserk Monsters" "brute force,data structures,dsu,implementation,math" "Monocarp is playing a computer game (yet again). Guess what is he doing? That\'s right, killing monsters.There are n monsters in a row, numbered from 1 to n. The i-th monster has two parameters: attack value equal to ai and defense value equal to di. In order to kill these monsters, Monocarp put a berserk spell on them, so they\'re attacking each other instead of Monocarp\'s character.The fight consists of n rounds. Every round, the following happens:  first, every alive monster i deals ai damage to the closest alive monster to the left (if it exists) and the closest alive monster to the right (if it exists);  then, every alive monster j which received more than dj damage during this round dies. I.\xe2\x80\x89e. the j-th monster dies if and only if its defense value dj is strictly less than the total damage it received this round. For each round, calculate the number of monsters that will die during that round." 1900
1922C "Closest Cities" greedy,implementation,math "There are n cities located on the number line, the i-th city is in the point ai. The coordinates of the cities are given in ascending order, so a1<a2<\xe2\x8b\xaf<an.The distance between two cities x and y is equal to |ax\xe2\x88\x92ay|.For each city i, let\'s define the closest city j as the city such that the distance between i and j is not greater than the distance between i and each other city k. For example, if the cities are located in points [0,8,12,15,20], then:  the closest city to the city 1 is the city 2;  the closest city to the city 2 is the city 3;  the closest city to the city 3 is the city 4;  the closest city to the city 4 is the city 3;  the closest city to the city 5 is the city 4. The cities are located in such a way that for every city, the closest city is unique. For example, it is impossible for the cities to be situated in points [1,2,3], since this would mean that the city 2 has two closest cities (1 and 3, both having distance 1).You can travel between cities. Suppose you are currently in the city x. Then you can perform one of the following actions:  travel to any other city y, paying |ax\xe2\x88\x92ay| coins;  travel to the city which is the closest to x, paying 1 coin. You are given m queries. In each query, you will be given two cities, and you have to calculate the minimum number of coins you have to spend to travel from one city to the other city." 1300
1922B "Forming Triangles" "combinatorics,constructive algorithms,math,sortings" "You have n sticks, numbered from 1 to n. The length of the i-th stick is 2ai.You want to choose exactly 3 sticks out of the given n sticks, and form a non-degenerate triangle out of them, using the sticks as the sides of the triangle. A triangle is called non-degenerate if its area is strictly greater than 0.You have to calculate the number of ways to choose exactly 3 sticks so that a triangle can be formed out of them. Note that the order of choosing sticks does not matter (for example, choosing the 1-st, 2-nd and 4-th stick is the same as choosing the 2-nd, 4-th and 1-st stick)." 1200
1922A "Tricky Template" "constructive algorithms,implementation,strings" "You are given an integer n and three strings a,b,c, each consisting of n lowercase Latin letters.Let a template be a string t consisting of n lowercase and/or uppercase Latin letters. The string s matches the template t if the following conditions hold for all i from 1 to n:   if the i-th letter of the template is lowercase, then si must be the same as ti;  if the i-th letter of the template is uppercase, then si must be different from the lowercase version of ti. For example, if there is a letter \'A\' in the template, you cannot use the letter \'a\' in the corresponding position of the string. Accordingly, the string doesn\'t match the template if the condition doesn\'t hold for at least one i.Determine whether there exists a template t such that the strings a and b match it, while the string c does not." 800
1921G "Mischievous Shooter" "brute force,data structures,divide and conquer,dp,implementation" "Once the mischievous and wayward shooter named Shel found himself on a rectangular field of size n\xc3\x97m, divided into unit squares. Each cell either contains a target or not.Shel only had a lucky shotgun with him, with which he can shoot in one of the four directions: right-down, left-down, left-up, or right-up. When fired, the shotgun hits all targets in the chosen direction, the Manhattan distance to which does not exceed a fixed constant k. The Manhattan distance between two points (x1,y1) and (x2,y2) is equal to |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|.  Possible hit areas for k=3. Shel\'s goal is to hit as many targets as possible. Please help him find this value." 2200
1921F "Sum of Progression" "brute force,data structures,dp,implementation,math" "You are given an array a of n numbers. There are also q queries of the form s,d,k.For each query q, find the sum of elements as+as+d\xe2\x8b\x852+\xe2\x8b\xaf+as+d\xe2\x8b\x85(k\xe2\x88\x921)\xe2\x8b\x85k. In other words, for each query, it is necessary to find the sum of k elements of the array with indices starting from the s-th, taking steps of size d, multiplying it by the serial number of the element in the resulting sequence." 1900
1921E "Eat the Chip" "brute force,games,greedy,math" "Alice and Bob are playing a game on a checkered board. The board has h rows, numbered from top to bottom, and w columns, numbered from left to right. Both players have a chip each. Initially, Alice\'s chip is located at the cell with coordinates (xa,ya) (row xa, column ya), and Bob\'s chip is located at (xb,yb). It is guaranteed that the initial positions of the chips do not coincide. Players take turns making moves, with Alice starting.On her turn, Alice can move her chip one cell down or one cell down-right or down-left (diagonally). Bob, on the other hand, moves his chip one cell up, up-right, or up-left. It is not allowed to make moves that go beyond the board boundaries.More formally, if at the beginning of Alice\'s turn she is in the cell with coordinates (xa,ya), then she can move her chip to one of the cells (xa+1,ya), (xa+1,ya\xe2\x88\x921), or (xa+1,ya+1). Bob, on his turn, from the cell (xb,yb) can move to (xb\xe2\x88\x921,yb), (xb\xe2\x88\x921,yb\xe2\x88\x921), or (xb\xe2\x88\x921,yb+1). The new chip coordinates (x\xe2\x80\xb2,y\xe2\x80\xb2) must satisfy the conditions 1\xe2\x89\xa4x\xe2\x80\xb2\xe2\x89\xa4h and 1\xe2\x89\xa4y\xe2\x80\xb2\xe2\x89\xa4w.   Example game state. Alice plays with the white chip, Bob with the black one. Arrows indicate possible moves. A player immediately wins if they place their chip in a cell occupied by the other player\'s chip. If either player cannot make a move (Alice\xe2\x80\x94if she is in the last row, i.e. xa=h, Bob\xe2\x80\x94if he is in the first row, i.e. xb=1), the game immediately ends in a draw.What will be the outcome of the game if both opponents play optimally?" 1600
1921D "Very Different Array" "data structures,greedy,sortings,two pointers" "Petya has an array ai of n integers. His brother Vasya became envious and decided to make his own array of n integers.To do this, he found m integers bi (m\xe2\x89\xa5n), and now he wants to choose some n integers of them and arrange them in a certain order to obtain an array ci of length n.To avoid being similar to his brother, Vasya wants to make his array as different as possible from Petya\'s array. Specifically, he wants the total difference D=\xe2\x88\x91ni=1|ai\xe2\x88\x92ci| to be as large as possible.Help Vasya find the maximum difference D he can obtain." 1100
1921C "Sending Messages" greedy,math "Stepan is a very busy person. Today he needs to send n messages at moments m1,m2,\xe2\x80\xa6mn (mi<mi+1). Unfortunately, by the moment 0, his phone only has f units of charge left. At the moment 0, the phone is turned on.The phone loses a units of charge for each unit of time it is on. Also, at any moment, Stepan can turn off the phone and turn it on later. This action consumes b units of energy each time. Consider turning on and off to be instantaneous, so you can turn it on at moment x and send a message at the same moment, and vice versa, send a message at moment x and turn off the phone at the same moment.If at any point the charge level drops to 0 (becomes \xe2\x89\xa40), it is impossible to send a message at that moment.Since all messages are very important to Stepan, he wants to know if he can send all the messages without the possibility of charging the phone." 900
1921B "Arranging Cats" greedy,implementation "In order to test the hypothesis about the cats, the scientists must arrange the cats in the boxes in a specific way. Of course, they would like to test the hypothesis and publish a sensational article as quickly as possible, because they are too engrossed in the next hypothesis about the phone\'s battery charge.Scientists have n boxes in which cats may or may not sit. Let the current state of the boxes be denoted by the sequence b1,\xe2\x80\xa6,bn: bi=1 if there is a cat in box number i, and bi=0 otherwise. Fortunately, the unlimited production of cats has already been established, so in one day, the scientists can perform one of the following operations:  Take a new cat and place it in a box (for some i such that bi=0, assign bi=1).  Remove a cat from a box and send it into retirement (for some i such that bi=1, assign bi=0).  Move a cat from one box to another (for some i,j such that bi=1,bj=0, assign bi=0,bj=1). It has also been found that some boxes were immediately filled with cats. Therefore, the scientists know the initial position of the cats in the boxes s1,\xe2\x80\xa6,sn and the desired position f1,\xe2\x80\xa6,fn.Due to the large amount of paperwork, the scientists do not have time to solve this problem. Help them for the sake of science and indicate the minimum number of days required to test the hypothesis." 800
1921A Square greedy,math "A square of positive (strictly greater than 0) area is located on the coordinate plane, with sides parallel to the coordinate axes. You are given the coordinates of its corners, in random order. Your task is to find the area of the square." 800
1920F2 "Smooth Sailing (Hard Version)" "binary search,data structures,dsu,geometry,graphs,trees" "The only difference between the two versions of this problem is the constraint on q. You can make hacks only if both versions of the problem are solved.Thomas is sailing around an island surrounded by the ocean. The ocean and island can be represented by a grid with n rows and m columns. The rows are numbered from 1 to n from top to bottom, and the columns are numbered from 1 to m from left to right. The position of a cell at row r and column c can be represented as (r,c). Below is an example of a valid grid.  Example of a valid grid There are three types of cells: island, ocean and underwater volcano. Cells representing the island are marked with a \'#\', cells representing the ocean are marked with a \'.\', and cells representing an underwater volcano are marked with a \'v\'. It is guaranteed that there is at least one island cell and at least one underwater volcano cell. It is also guaranteed that the set of all island cells forms a single connected component\xe2\x80\xa0 and the set of all ocean cells and underwater volcano cells forms a single connected component. Additionally, it is guaranteed that there are no island cells at the edge of the grid (that is, at row 1, at row n, at column 1, and at column m).Define a round trip starting from cell (x,y) as a path Thomas takes which satisfies the following conditions:  The path starts and ends at (x,y).  If Thomas is at cell (i,j), he can go to cells (i+1,j), (i\xe2\x88\x921,j), (i,j\xe2\x88\x921), and (i,j+1) as long as the destination cell is an ocean cell or an underwater volcano cell and is still inside the grid. Note that it is allowed for Thomas to visit the same cell multiple times in the same round trip.  The path must go around the island and fully encircle it. Some path p fully encircles the island if it is impossible to go from an island cell to a cell on the grid border by only traveling to adjacent on a side or diagonal cells without visiting a cell on path p. In the image below, the path starting from (2,2), going to (1,3), and going back to (2,2) the other way does not fully encircle the island and is not considered a round trip.   Example of a path that does not fully encircle the island The safety of a round trip is the minimum Manhattan distance\xe2\x80\xa1 from a cell on the round trip to an underwater volcano (note that the presence of island cells does not impact this distance).You have q queries. A query can be represented as (x,y) and for every query, you want to find the maximum safety of a round trip starting from (x,y). It is guaranteed that (x,y) is an ocean cell or an underwater volcano cell.\xe2\x80\xa0A set of cells forms a single connected component if from any cell of this set it is possible to reach any other cell of this set by moving only through the cells of this set, each time going to a cell with a common side.\xe2\x80\xa1Manhattan distance between cells (r1,c1) and (r2,c2) is equal to |r1\xe2\x88\x92r2|+|c1\xe2\x88\x92c2|." 3000
1920F1 "Smooth Sailing (Easy Version)" "binary search,brute force,data structures,dfs and similar,dsu,graphs,shortest paths" "The only difference between the two versions of this problem is the constraint on q. You can make hacks only if both versions of the problem are solved.Thomas is sailing around an island surrounded by the ocean. The ocean and island can be represented by a grid with n rows and m columns. The rows are numbered from 1 to n from top to bottom, and the columns are numbered from 1 to m from left to right. The position of a cell at row r and column c can be represented as (r,c). Below is an example of a valid grid.  Example of a valid grid There are three types of cells: island, ocean and underwater volcano. Cells representing the island are marked with a \'#\', cells representing the ocean are marked with a \'.\', and cells representing an underwater volcano are marked with a \'v\'. It is guaranteed that there is at least one island cell and at least one underwater volcano cell. It is also guaranteed that the set of all island cells forms a single connected component\xe2\x80\xa0 and the set of all ocean cells and underwater volcano cells forms a single connected component. Additionally, it is guaranteed that there are no island cells at the edge of the grid (that is, at row 1, at row n, at column 1, and at column m).Define a round trip starting from cell (x,y) as a path Thomas takes which satisfies the following conditions:  The path starts and ends at (x,y).  If Thomas is at cell (i,j), he can go to cells (i+1,j), (i\xe2\x88\x921,j), (i,j\xe2\x88\x921), and (i,j+1) as long as the destination cell is an ocean cell or an underwater volcano cell and is still inside the grid. Note that it is allowed for Thomas to visit the same cell multiple times in the same round trip.  The path must go around the island and fully encircle it. Some path p fully encircles the island if it is impossible to go from an island cell to a cell on the grid border by only traveling to adjacent on a side or diagonal cells without visiting a cell on path p. In the image below, the path starting from (2,2), going to (1,3), and going back to (2,2) the other way does not fully encircle the island and is not considered a round trip.   Example of a path that does not fully encircle the island The safety of a round trip is the minimum Manhattan distance\xe2\x80\xa1 from a cell on the round trip to an underwater volcano (note that the presence of island cells does not impact this distance).You have q queries. A query can be represented as (x,y) and for every query, you want to find the maximum safety of a round trip starting from (x,y). It is guaranteed that (x,y) is an ocean cell or an underwater volcano cell.\xe2\x80\xa0A set of cells forms a single connected component if from any cell of this set it is possible to reach any other cell of this set by moving only through the cells of this set, each time going to a cell with a common side.\xe2\x80\xa1Manhattan distance between cells (r1,c1) and (r2,c2) is equal to |r1\xe2\x88\x92r2|+|c1\xe2\x88\x92c2|." 2500
1920E "Counting Binary Strings" combinatorics,dp,math "Patrick calls a substring\xe2\x80\xa0 of a binary string\xe2\x80\xa1 good if this substring contains exactly one 1. Help Patrick count the number of binary strings s such that s contains exactly n good substrings and has no good substring of length strictly greater than k. Note that substrings are differentiated by their location in the string, so if s= 1010 you should count both occurrences of 10.\xe2\x80\xa0 A string a is a substring of a string b if a can be obtained from b by the deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.\xe2\x80\xa1 A binary string is a string that only contains the characters 0 and 1." 2100
1920D "Array Repetition" "binary search,brute force,dsu,implementation,math" "Jayden has an array a which is initially empty. There are n operations of two types he must perform in the given order.  Jayden appends an integer x (1\xe2\x89\xa4x\xe2\x89\xa4n) to the end of array a.  Jayden appends x copies of array a to the end of array a. In other words, array a becomes [a,a,\xe2\x80\xa6,a\xe2\x8f\x9fx]. It is guaranteed that he has done at least one operation of the first type before this. Jayden has q queries. For each query, you must tell him the k-th element of array a. The elements of the array are numbered from 1." 1900
1920C "Partitioning the Array" "brute force,math,number theory" "Allen has an array a1,a2,\xe2\x80\xa6,an. For every positive integer k that is a divisor of n, Allen does the following:  He partitions the array into nk disjoint subarrays of length k. In other words, he partitions the array into the following subarrays: [a1,a2,\xe2\x80\xa6,ak],[ak+1,ak+2,\xe2\x80\xa6,a2k],\xe2\x80\xa6,[an\xe2\x88\x92k+1,an\xe2\x88\x92k+2,\xe2\x80\xa6,an]  Allen earns one point if there exists some positive integer m (m\xe2\x89\xa52) such that if he replaces every element in the array with its remainder when divided by m, then all subarrays will be identical. Help Allen find the number of points he will earn." 1600
1920B "Summation Game" games,greedy,math,sortings "Alice and Bob are playing a game. They have an array a1,a2,\xe2\x80\xa6,an. The game consists of two steps:  First, Alice will remove at most k elements from the array.  Second, Bob will multiply at most x elements of the array by \xe2\x88\x921. Alice wants to maximize the sum of elements of the array while Bob wants to minimize it. Find the sum of elements of the array after the game if both players play optimally." 1100
1920A "Satisfying Constraints" "brute force,greedy,math" "Alex is solving a problem. He has n constraints on what the integer k can be. There are three types of constraints:  k must be greater than or equal to some integer x;  k must be less than or equal to some integer x;  k must be not equal to some integer x. Help Alex find the number of integers k that satisfy all n constraints. It is guaranteed that the answer is finite (there exists at least one constraint of type 1 and at least one constraint of type 2). Also, it is guaranteed that no two constraints are the exact same." 800
1919H "Tree Diameter" interactive,trees "There is a hidden tree with nn vertices. The n\xe2\x88\x921n\xe2\x88\x921 edges of the tree are numbered from 11 to n\xe2\x88\x921n\xe2\x88\x921. You can ask the following queries of two types:  Give the grader an array aa with n\xe2\x88\x921n\xe2\x88\x921 positive integers. For each edge from 11 to n\xe2\x88\x921n\xe2\x88\x921, the weight of edge ii is set to aiai. Then, the grader will return the length of the diameter\xe2\x80\xa0\xe2\x80\xa0.  Give the grader two indices 1\xe2\x89\xa4a,b\xe2\x89\xa4n\xe2\x88\x9211\xe2\x89\xa4a,b\xe2\x89\xa4n\xe2\x88\x921. The grader will return the number of edges between edges aa and bb. In other words, if edge aa connects uaua and vava while edge bb connects ubub and vbvb, the grader will return min(dist(ua,ub),dist(va,ub),dist(ua,vb),dist(va,vb))min(dist(ua,ub),dist(va,ub),dist(ua,vb),dist(va,vb)), where dist(u,v)dist(u,v) represents the number of edges on the path between vertices uu and vv. Find any tree isomorphic\xe2\x80\xa1\xe2\x80\xa1 to the hidden tree after at most nn queries of type 1 and nn queries of type 2 in any order.\xe2\x80\xa0\xe2\x80\xa0 The distance between two vertices is the sum of the weights on the unique simple path that connects them. The diameter is the largest of all those distances.\xe2\x80\xa1\xe2\x80\xa1 Two trees, consisting of nn vertices each, are called isomorphic if there exists a permutation pp containing integers from 11 to nn such that edge (uu, vv) is present in the first tree if and only if the edge (pupu, pvpv) is present in the second tree." 2000
1919G "Tree LGM" "constructive algorithms,divide and conquer,games,trees" "In TreeWorld, there is a popular two-player game played on a tree with n vertices labelled from 1 to n. In this game, the tournament leaders first choose a vertex to be the root of the tree and choose another vertex (possibly the same vertex as the root) to place a coin on. Then, each player will take turns moving the coin to any child\xe2\x80\xa0 of the vertex that the coin is currently on. The first player who is unable to make a move loses.Alice wants to be a tree LGM, so she spends a lot of time studying the game. She wrote down an n by n matrix s, where si,j=1 if the first player can win with the root of the tree chosen to be vertex i, and the coin was initially placed on vertex j. Otherwise, si,j=0. Alice is a perfectionist, so she assumes that both players play perfectly in the game.However, she accidentally knocked her head on the way to the tournament and forgot what the tree looked like. Determine whether there exists a tree that satisfies the winning and losing states represented by matrix s, and if it exists, construct a valid tree.\xe2\x80\xa0 A vertex c is a child of vertex u if there is an edge between c and u, and c does not lie on the unique simple path from the root to vertex u." 3500
1919F2 "Wine Factory (Hard Version)" "data structures,dp,flows,greedy,matrices" "This is the hard version of the problem. The only difference between the two versions is the constraint on ci and z. You can make hacks only if both versions of the problem are solved.There are three arrays a, b and c. a and b have length n and c has length n\xe2\x88\x921. Let W(a,b,c) denote the liters of wine created from the following process.Create n water towers. The i-th water tower initially has ai liters of water and has a wizard with power bi in front of it. Furthermore, for each 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, there is a valve connecting water tower i to i+1 with capacity ci.For each i from 1 to n in this order, the following happens:   The wizard in front of water tower i removes at most bi liters of water from the tower and turns the removed water into wine.  If i\xe2\x89\xa0n, at most ci liters of the remaining water left in water tower i flows through the valve into water tower i+1. There are q updates. In each update, you will be given integers p, x, y and z and you will update ap:=x, bp:=y and cp:=z. After each update, find the value of W(a,b,c). Note that previous updates to arrays a, b and c persist throughout future updates." 2800
1919F1 "Wine Factory (Easy Version)" "data structures,greedy" "This is the easy version of the problem. The only difference between the two versions is the constraint on ci and z. You can make hacks only if both versions of the problem are solved.There are three arrays a, b and c. a and b have length n and c has length n\xe2\x88\x921. Let W(a,b,c) denote the liters of wine created from the following process.Create n water towers. The i-th water tower initially has ai liters of water and has a wizard with power bi in front of it. Furthermore, for each 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, there is a valve connecting water tower i to i+1 with capacity ci.For each i from 1 to n in this order, the following happens:   The wizard in front of water tower i removes at most bi liters of water from the tower and turns the removed water into wine.  If i\xe2\x89\xa0n, at most ci liters of the remaining water left in water tower i flows through the valve into water tower i+1. There are q updates. In each update, you will be given integers p, x, y and z and you will update ap:=x, bp:=y and cp:=z. After each update, find the value of W(a,b,c). Note that previous updates to arrays a, b and c persist throughout future updates." 2300
1919E "Counting Prefixes" "combinatorics,constructive algorithms,dp,implementation,math" "There is a hidden array a of size n consisting of only 1 and \xe2\x88\x921. Let p be the prefix sums of array a. More formally, p is an array of length n defined as pi=a1+a2+\xe2\x80\xa6+ai. Afterwards, array p is sorted in non-decreasing order. For example, if a=[1,\xe2\x88\x921,\xe2\x88\x921,1,1], then p=[1,0,\xe2\x88\x921,0,1] before sorting and p=[\xe2\x88\x921,0,0,1,1] after sorting.You are given the prefix sum array p after sorting, but you do not know what array a is. Your task is to count the number of initial arrays a such that the above process results in the given sorted prefix sum array p. As this number can be large, you are only required to find it modulo 998244353." 2600
1919D "01 Tree" "constructive algorithms,data structures,dsu,greedy,sortings,trees" "There is an edge-weighted complete binary tree with n leaves. A complete binary tree is defined as a tree where every non-leaf vertex has exactly 2 children. For each non-leaf vertex, we label one of its children as the left child and the other as the right child.The binary tree has a very strange property. For every non-leaf vertex, one of the edges to its children has weight 0 while the other edge has weight 1. Note that the edge with weight 0 can be connected to either its left or right child.You forgot what the tree looks like, but luckily, you still remember some information about the leaves in the form of an array a of size n. For each i from 1 to n, ai represents the distance\xe2\x80\xa0 from the root to the i-th leaf in dfs order\xe2\x80\xa1. Determine whether there exists a complete binary tree which satisfies array a. Note that you do not need to reconstruct the tree.\xe2\x80\xa0 The distance from vertex u to vertex v is defined as the sum of weights of the edges on the path from vertex u to vertex v.\xe2\x80\xa1 The dfs order of the leaves is found by calling the following dfs function on the root of the binary tree. dfs_order = []function dfs(v):    if v is leaf:        append v to the back of dfs_order    else:        dfs(left child of v)        dfs(right child of v)dfs(root)" 2100
1919C "Grouping Increases" "data structures,dp,greedy" "You are given an array a of size n. You will do the following process to calculate your penalty:   Split array a into two (possibly empty) subsequences\xe2\x80\xa0 s and t such that every element of a is either in s or t\xe2\x80\xa1.  For an array b of size m, define the penalty p(b) of an array b as the number of indices i between 1 and m\xe2\x88\x921 where bi<bi+1.  The total penalty you will receive is p(s)+p(t). If you perform the above process optimally, find the minimum possible penalty you will receive.\xe2\x80\xa0 A sequence x is a subsequence of a sequence y if x can be obtained from y by the deletion of several (possibly, zero or all) elements.\xe2\x80\xa1 Some valid ways to split array a=[3,1,4,1,5] into (s,t) are ([3,4,1,5],[1]), ([1,1],[3,4,5]) and ([],[3,1,4,1,5]) while some invalid ways to split a are ([3,4,5],[1]), ([3,1,4,1],[1,5]) and ([1,3,4],[5,1])." 1400
1919B "Plus-Minus Split" greedy "You are given a string s of length n consisting of characters ""+"" and ""-"". s represents an array a of length n defined by ai=1 if si= ""+"" and ai=\xe2\x88\x921 if si= ""-"".You will do the following process to calculate your penalty:   Split a into non-empty arrays b1,b2,\xe2\x80\xa6,bk such that b1+b2+\xe2\x80\xa6+bk=a\xe2\x80\xa0, where + denotes array concatenation.  The penalty of a single array is the absolute value of its sum multiplied by its length. In other words, for some array c of length m, its penalty is calculated as p(c)=|c1+c2+\xe2\x80\xa6+cm|\xe2\x8b\x85m.  The total penalty that you will receive is p(b1)+p(b2)+\xe2\x80\xa6+p(bk). If you perform the above process optimally, find the minimum possible penalty you will receive.\xe2\x80\xa0 Some valid ways to split a=[3,1,4,1,5] into (b1,b2,\xe2\x80\xa6,bk) are ([3],[1],[4],[1],[5]), ([3,1],[4,1,5]) and ([3,1,4,1,5]) while some invalid ways to split a are ([3,1],[1,5]), ([3],[],[1,4],[1,5]) and ([3,4],[5,1,1])." 800
1919A "Wallet Exchange" games,math "Alice and Bob are bored, so they decide to play a game with their wallets. Alice has a coins in her wallet, while Bob has b coins in his wallet.Both players take turns playing, with Alice making the first move. In each turn, the player will perform the following steps in order:  Choose to exchange wallets with their opponent, or to keep their current wallets.  Remove 1 coin from the player\'s current wallet. The current wallet cannot have 0 coins before performing this step. The player who cannot make a valid move on their turn loses. If both Alice and Bob play optimally, determine who will win the game." 800
1918G "Permutation of Given" "constructive algorithms,math" "You were given only one number, n. It didn\'t seem interesting to you, so you wondered if it\'s possible to come up with an array of length n consisting of non-zero integers, such that if each element of the array is replaced by the sum of its neighbors (the elements on the ends are replaced by their only neighbors), you obtain a permutation of the numbers in the original array." 2700
1918F "Caterpillar on a Tree" "dfs and similar,graphs,greedy,implementation,sortings,trees" "The caterpillar decided to visit every node of the tree. Initially, it is sitting at the root.The tree is represented as a rooted tree with the root at the node 1. Each crawl to a neighboring node takes 1 minute for the caterpillar. And there is a trampoline under the tree. If the caterpillar detaches from the tree and falls onto the trampoline, it will end up at the root of the tree in 0 seconds. But the trampoline is old and can withstand no more than k caterpillar\'s falls.What is the minimum time the caterpillar can take to visit all the nodes of the tree?More formally, we need to find the minimum time required to visit all the nodes of the tree, if the caterpillar starts at the root (node 1) and moves using two methods.   Crawl along an edge to one of the neighboring nodes: takes 1 minute.   Teleport to the root: takes no time,  no new nodes become visited. The second method (teleportation) can be used at most k times. The caterpillar can finish the journey at any node." 2500
1918E "ace5 and Task Order" "constructive algorithms,divide and conquer,implementation,interactive,probabilities,sortings" "This is an interactive problem!In the new round, there were n tasks with difficulties from 1 to n. The coordinator, who decided to have the first round with tasks in unsorted order of difficulty, rearranged the tasks, resulting in a permutation of difficulties from 1 to n. After that, the coordinator challenged ace5 to guess the permutation in the following way.Initially, the coordinator chooses a number x from 1 to n.ace5 can make queries of the form: ? i. The answer will be:   >, if ai>x, after which x increases by 1.  <, if ai<x, after which x decreases by 1.  =, if ai=x, after which x remains unchanged. The task for ace5 is to guess the permutation in no more than 40n queries. Since ace5 is too busy writing the announcement, he has entrusted this task to you." 2200
1918D "Blocking Elements" "binary search,data structures,dp,implementation,two pointers" "You are given an array of numbers a1,a2,\xe2\x80\xa6,an. Your task is to block some elements of the array in order to minimize its cost. Suppose you block the elements with indices 1\xe2\x89\xa4b1<b2<\xe2\x80\xa6<bm\xe2\x89\xa4n. Then the cost of the array is calculated as the maximum of:   the sum of the blocked elements, i.e., ab1+ab2+\xe2\x80\xa6+abm.  the maximum sum of the segments into which the array is divided when the blocked elements are removed. That is, the maximum sum of the following (m+1) subarrays: [1,b1\xe2\x88\x921], [b1+1,b2\xe2\x88\x921], [\xe2\x80\xa6], [bm\xe2\x88\x921+1,bm\xe2\x88\x921], [bm+1,n] (the sum of numbers in a subarray of the form [x,x\xe2\x88\x921] is considered to be 0). For example, if n=6, the original array is [1,4,5,3,3,2], and you block the elements at positions 2 and 5, then the cost of the array will be the maximum of the sum of the blocked elements (4+3=7) and the sums of the subarrays (1, 5+3=8, 2), which is max(7,1,8,2)=8. You need to output the minimum cost of the array after blocking." 1900
1918C XOR-distance bitmasks,greedy,implementation,math "You are given integers a, b, r. Find the smallest value of |(a\xe2\x8a\x95x)\xe2\x88\x92(b\xe2\x8a\x95x)| among all 0\xe2\x89\xa4x\xe2\x89\xa4r.\xe2\x8a\x95 is the operation of bitwise XOR, and |y| is absolute value of y." 1400
1918B "Minimize Inversions" "constructive algorithms,data structures,greedy,implementation,sortings" "You are given two permutations a and b of length n. A permutation is an array of n elements from 1 to n where all elements are distinct. For example, an array [2,1,3] is a permutation, but [0,1] and [1,3,1] aren\'t.You can (as many times as you want) choose two indices i and j, then swap ai with aj and bi with bj simultaneously. You hate inversions, so you want to minimize the total number of inversions in both permutations.An inversion in a permutation p is a pair of indices (i,j) such that i<j and pi>pj. For example, if p=[3,1,4,2,5] then there are 3 inversions in it (the pairs of indices are (1,2), (1,4) and (3,4))." 900
1918A "Brick Wall" "constructive algorithms,greedy,implementation,math" "A brick is a strip of size 1\xc3\x97k, placed horizontally or vertically, where k can be an arbitrary number that is at least 2 (k\xe2\x89\xa52).A brick wall of size n\xc3\x97m is such a way to place several bricks inside a rectangle n\xc3\x97m, that all bricks lie either horizontally or vertically in the cells, do not cross the border of the rectangle, and that each cell of the n\xc3\x97m rectangle belongs to exactly one brick. Here n is the height of the rectangle n\xc3\x97m and m is the width. Note that there can be bricks with different values of k in the same brick wall.The wall stability is the difference between the number of horizontal bricks and the number of vertical bricks. Note that if you used 0 horizontal bricks and 2 vertical ones, then the stability will be \xe2\x88\x922, not 2.What is the maximal possible stability of a wall of size n\xc3\x97m?It is guaranteed that under restrictions in the statement at least one n\xc3\x97m wall exists." 800
1917F "Construct Tree" "bitmasks,constructive algorithms,dp,trees" "You are given an array of integers l1,l2,\xe2\x80\xa6,ln and an integer d. Is it possible to construct a tree satisfying the following three conditions?  The tree contains n+1 nodes.  The length of the i-th edge is equal to li.  The (weighted) diameter of the tree is equal to d." 2500
1917E "Construct Matrix" "constructive algorithms,math" "You are given an even integer n and an integer k. Your task is to construct a matrix of size n\xc3\x97n consisting of numbers 0 and 1 in such a way that the following conditions are true, or report that it is impossible:  the sum of all the numbers in the matrix is exactly k;  the bitwise XOR of all the numbers in the row i is the same for each i;  the bitwise XOR of all the numbers in the column j is the same for each j." 2500
1917D "Yet Another Inversions Problem" "combinatorics,data structures,dp,implementation,math,number theory" "You are given a permutation p0,p1,\xe2\x80\xa6,pn\xe2\x88\x921 of odd integers from 1 to 2n\xe2\x88\x921 and a permutation q0,q1,\xe2\x80\xa6,qk\xe2\x88\x921 of integers from 0 to k\xe2\x88\x921.An array a0,a1,\xe2\x80\xa6,ank\xe2\x88\x921 of length nk is defined as follows: ai\xe2\x8b\x85k+j=pi\xe2\x8b\x852qj for all 0\xe2\x89\xa4i<n and all 0\xe2\x89\xa4j<k For example, if p=[3,5,1] and q=[0,1], then a=[3,6,5,10,1,2].Note that all arrays in the statement are zero-indexed. Note that each element of the array a is uniquely determined.Find the number of inversions in the array a. Since this number can be very large, you should find only its remainder modulo 998244353.An inversion in array a is a pair (i,j) (0\xe2\x89\xa4i<j<nk) such that ai>aj." 2300
1917C "Watering an Array" "brute force,greedy,implementation,math" "You have an array of integers a1,a2,\xe2\x80\xa6,an of length n. On the i-th of the next d days you are going to do exactly one of the following two actions:  Add 1 to each of the first bi elements of the array a (i.e., set aj:=aj+1 for each 1\xe2\x89\xa4j\xe2\x89\xa4bi).  Count the elements which are equal to their position (i.e., the aj=j). Denote the number of such elements as c. Then, you add c to your score, and reset the entire array a to a 0-array of length n (i.e., set [a1,a2,\xe2\x80\xa6,an]:=[0,0,\xe2\x80\xa6,0]). Your score is equal to 0 in the beginning. Note that on each day you should perform exactly one of the actions above: you cannot skip a day or perform both actions on the same day.What is the maximum score you can achieve at the end?Since d can be quite large, the sequence b is given to you in the compressed format:   You are given a sequence of integers v1,v2,\xe2\x80\xa6,vk. The sequence b is a concatenation of infinitely many copies of v: b=[v1,v2,\xe2\x80\xa6,vk,v1,v2,\xe2\x80\xa6,vk,\xe2\x80\xa6]." 1600
1917B "Erase First or Second Letter" "brute force,combinatorics,data structures,dp,strings" "You are given a string s of length n. Let\'s define two operations you can apply on the string:  remove the first character of the string;  remove the second character of the string. Your task is to find the number of distinct non-empty strings that can be generated by applying the given operations on the initial string any number of times (possibly zero), in any order." 1100
1917A "Least Product" "constructive algorithms,math" "You are given an array of integers a1,a2,\xe2\x80\xa6,an. You can perform the following operation any number of times (possibly zero):  Choose any element ai from the array and change its value to any integer between 0 and ai (inclusive). More formally, if ai<0, replace ai with any integer in [ai,0], otherwise replace ai with any integer in [0,ai]. Let r be the minimum possible product of all the ai after performing the operation any number of times.Find the minimum number of operations required to make the product equal to r. Also, print one such shortest sequence of operations. If there are multiple answers, you can print any of them." 800
1916H2 "Matrix Rank (Hard Version)" "combinatorics,dp,math,matrices,string suffix structures" "This is the hard version of the problem. The only differences between the two versions of this problem are the constraints on k. You can make hacks only if all versions of the problem are solved.You are given integers n, p and k. p is guaranteed to be a prime number. For each r from 0 to k, find the number of n\xc3\x97n matrices A of the field\xe2\x80\xa0 of integers modulo p such that the rank\xe2\x80\xa1 of A is exactly r. Since these values are big, you are only required to output them modulo 998244353.\xe2\x80\xa0 https://en.wikipedia.org/wiki/Field_(mathematics)\xe2\x80\xa1 https://en.wikipedia.org/wiki/Rank_(linear_algebra)" 2700
1916H1 "Matrix Rank (Easy Version)" "brute force,combinatorics,dp,math,matrices" "This is the easy version of the problem. The only differences between the two versions of this problem are the constraints on k. You can make hacks only if all versions of the problem are solved.You are given integers n, p and k. p is guaranteed to be a prime number. For each r from 0 to k, find the number of n\xc3\x97n matrices A of the field\xe2\x80\xa0 of integers modulo p such that the rank\xe2\x80\xa1 of A is exactly r. Since these values are big, you are only required to output them modulo 998244353.\xe2\x80\xa0 https://en.wikipedia.org/wiki/Field_(mathematics)\xe2\x80\xa1 https://en.wikipedia.org/wiki/Rank_(linear_algebra)" 2700
1916G "Optimizations From Chelsu" "divide and conquer,dp,number theory,trees" "You are given a tree with n vertices, whose vertices are numbered from 1 to n. Each edge is labeled with some integer wi.Define len(u,v) as the number of edges in the simple path between vertices u and v, and gcd(u,v) as the Greatest Common Divisor of all numbers written on the edges of the simple path between vertices u and v. For example, len(u,u)=0 and gcd(u,u)=0 for any 1\xe2\x89\xa4u\xe2\x89\xa4n.You need to find the maximum value of len(u,v)\xe2\x8b\x85gcd(u,v) over all pairs of vertices in the tree." 3500
1916F "Group Division" "constructive algorithms,dfs and similar,graphs,greedy" "In the 31st lyceum, there were two groups of olympiad participants: computer science and mathematics. The number of computer scientists was n1, and the number of mathematicians was n2. It is not known for certain who belonged to which group, but it is known that there were friendly connections between some pairs of people (these connections could exist between a pair of people from the same group or from different groups).The connections were so strong that even if one person is removed along with all their friendly connections, any pair of people still remains acquainted either directly or through mutual friends.\xe2\x80\xa0 More formally, two people (x,y) are acquainted in the following case: there are people a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4n1+n2) such that the following conditions are simultaneously met:\xe2\x88\x99 Person x is directly acquainted with a1.\xe2\x88\x99 Person an is directly acquainted with y.\xe2\x88\x99 Person ai is directly acquainted with ai+1 for any (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).The teachers were dissatisfied with the fact that computer scientists were friends with mathematicians and vice versa, so they decided to divide the students into two groups in such a way that the following two conditions are met:\xe2\x88\x99 There were n1 people in the computer science group, and n2 people in the mathematics group.\xe2\x88\x99 Any pair of computer scientists should be acquainted (acquaintance involving mutual friends, who must be from the same group as the people in the pair, is allowed), the same should be true for mathematicians.Help them solve this problem and find out who belongs to which group." 2900
1916E "Happy Life in University" "data structures,dfs and similar,greedy,trees" "Egor and his friend Arseniy are finishing school this year and will soon enter university. And since they are very responsible guys, they have started preparing for admission already.First of all, they decided to take care of where they will live for the long four years of study, and after visiting the university\'s website, they found out that the university dormitory can be represented as a root tree with n vertices with the root at vertex 1. In the tree, each vertex represents a recreation with some type of activity ai. The friends need to choose 2 recreations (not necessarily different) in which they will settle. The guys are convinced that the more the value of the following function f(u,v)=diff(u,lca(u,v))\xe2\x8b\x85diff(v,lca(u,v)), the more fun their life will be. Help Egor and Arseniy and find the maximum value of f(u,v) among all pairs of recreations!\xe2\x80\xa0diff(u,v) \xe2\x80\x94 the number of different activities listed on the simple path from vertex u to vertex v.\xe2\x80\xa0lca(u,v) \xe2\x80\x94 a vertex p such that it is at the maximum distance from the root and is a parent of both vertex u and vertex v." 2300
1916D "Mathematical Problem" "brute force,constructive algorithms,geometry,math" "The mathematicians of the 31st lyceum were given the following task:You are given an odd number n, and you need to find n different numbers that are squares of integers. But it\'s not that simple. Each number should have a length of n (and should not have leading zeros), and the multiset of digits of all the numbers should be the same. For example, for 234 and 432, and 11223 and 32211, the multisets of digits are the same, but for 123 and 112233, they are not.The mathematicians couldn\'t solve this problem. Can you?" 1700
1916C "Training Before the Olympiad" "constructive algorithms,games,greedy,implementation,math" "Masha and Olya have an important team olympiad coming up soon. In honor of this, Masha, for warm-up, suggested playing a game with Olya:There is an array a of size n. Masha goes first, and the players take turns. Each move is described by the following sequence of actions:\xe2\x88\x99 If the size of the array is 1, the game ends.\xe2\x88\x99 The player who is currently playing chooses two different indices i, j (1\xe2\x89\xa4i,j\xe2\x89\xa4|a|), and performs the following operation \xe2\x80\x94 removes ai and aj from the array and adds to the array a number equal to \xe2\x8c\x8aai+aj2\xe2\x8c\x8b\xe2\x8b\x852. In other words, first divides the sum of the numbers ai, aj by 2 rounding down, and then multiplies the result by 2.Masha aims to maximize the final number, while Olya aims to minimize it.Masha and Olya decided to play on each non-empty prefix of the initial array a, and asked for your help.For each k=1,2,\xe2\x80\xa6,n, answer the following question. Let only the first k elements of the array a be present in the game, with indices 1,2,\xe2\x80\xa6,k respectively. What number will remain at the end with optimal play by both players?" 1200
1916B "Two Divisors" "constructive algorithms,math,number theory" "A certain number 1\xe2\x89\xa4x\xe2\x89\xa4109 is chosen. You are given two integers a and b, which are the two largest divisors of the number x. At the same time, the condition 1\xe2\x89\xa4a<b<x is satisfied.For the given numbers a, b, you need to find the value of x.\xe2\x80\xa0 The number y is a divisor of the number x if there is an integer k such that x=y\xe2\x8b\x85k." 1000
1916A 2023 "constructive algorithms,implementation,math,number theory" "In a sequence a, whose product was equal to 2023, k numbers were removed, leaving a sequence b of length n. Given the resulting sequence b, find any suitable sequence a and output which k elements were removed from it, or state that such a sequence could not have existed.Notice that you are not guaranteed that such array exists." 800
1915G Bicycles "graphs,greedy,implementation,shortest paths,sortings" "All of Slavic\'s friends are planning to travel from the place where they live to a party using their bikes. And they all have a bike except Slavic. There are n cities through which they can travel. They all live in the city 1 and want to go to the party located in the city n. The map of cities can be seen as an undirected graph with n nodes and m edges. Edge i connects cities ui and vi and has a length of wi.Slavic doesn\'t have a bike, but what he has is money. Every city has exactly one bike for sale. The bike in the i-th city has a slowness factor of si. Once Slavic buys a bike, he can use it whenever to travel from the city he is currently in to any neighboring city, by taking wi\xe2\x8b\x85sj time, considering he is traversing edge i using a bike j he owns.Slavic can buy as many bikes as he wants as money isn\'t a problem for him. Since Slavic hates traveling by bike, he wants to get from his place to the party in the shortest amount of time possible. And, since his informatics skills are quite rusty, he asks you for help.What\'s the shortest amount of time required for Slavic to travel from city 1 to city n? Slavic can\'t travel without a bike. It is guaranteed that it is possible for Slavic to travel from city 1 to any other city." 1800
1915F Greetings "data structures,divide and conquer,sortings" "There are n people on the number line; the i-th person is at point ai and wants to go to point bi. For each person, ai<bi, and the starting and ending points of all people are distinct. (That is, all of the 2n numbers a1,a2,\xe2\x80\xa6,an,b1,b2,\xe2\x80\xa6,bn are distinct.) All the people will start moving simultaneously at a speed of 1 unit per second until they reach their final point bi. When two people meet at the same point, they will greet each other once. How many greetings will there be?Note that a person can still greet other people even if they have reached their final point." 1500
1915E "Romantic Glasses" "data structures,greedy,math" "Iulia has n glasses arranged in a line. The i-th glass has ai units of juice in it. Iulia drinks only from odd-numbered glasses, while her date drinks only from even-numbered glasses.To impress her date, Iulia wants to find a contiguous subarray of these glasses such that both Iulia and her date will have the same amount of juice in total if only the glasses in this subarray are considered. Please help her to do that.More formally, find out if there exists two indices l, r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, and al+al+2+al+4+\xe2\x8b\xaf+ar=al+1+al+3+\xe2\x8b\xaf+ar\xe2\x88\x921 if l and r have the same parity and al+al+2+al+4+\xe2\x8b\xaf+ar\xe2\x88\x921=al+1+al+3+\xe2\x8b\xaf+ar otherwise." 1300
1915D "Unnatural Language Processing" greedy,implementation,strings "Lura was bored and decided to make a simple language using the five letters a, b, c, d, e. There are two types of letters:   vowels \xe2\x80\x94 the letters a and e. They are represented by V.  consonants \xe2\x80\x94 the letters b, c, and d. They are represented by C.  There are two types of syllables in the language: CV (consonant followed by vowel) or CVC (vowel with consonant before and after). For example, ba, ced, bab are syllables, but aa, eda, baba are not.A word in the language is a sequence of syllables. Lura has written a word in the language, but she doesn\'t know how to split it into syllables. Help her break the word into syllables.For example, given the word bacedbab, it would be split into syllables as ba.ced.bab (the dot . represents a syllable boundary)." 900
1915C "Can I Square?" "binary search,implementation" "Calin has n buckets, the i-th of which contains ai wooden squares of side length 1.Can Calin build a square using all the given squares?" 800
1915B "Not Quite Latin Square" "bitmasks,brute force,implementation" "A Latin square is a 3\xc3\x973 grid made up of the letters A, B, and C such that:   in each row, the letters A, B, and C each appear once, and  in each column, the letters A, B, and C each appear once.  For example, one possible Latin square is shown below. [ABCCABBCA]You are given a Latin square, but one of the letters was replaced with a question mark ?. Find the letter that was replaced." 800
1915A "Odd One Out" bitmasks,implementation "You are given three digits a, b, c. Two of them are equal, but the third one is different from the other two. Find the value that occurs exactly once." 800
1914G2 "Light Bulbs (Hard Version)" "combinatorics,data structures,dfs and similar,dp,graphs,hashing" "The easy and hard versions of this problem differ only in the constraints on n. In the hard version, the sum of values of n over all test cases does not exceed 2\xe2\x8b\x85105. Furthermore, there are no additional constraints on the value of n in a single test case.There are 2n light bulbs arranged in a row. Each light bulb has a color from 1 to n (exactly two light bulbs for each color).Initially, all light bulbs are turned off. You choose a set of light bulbs S that you initially turn on. After that, you can perform the following operations in any order any number of times:  choose two light bulbs i and j of the same color, exactly one of which is on, and turn on the second one;  choose three light bulbs i,j,k, such that both light bulbs i and k are on and have the same color, and the light bulb j is between them (i<j<k), and turn on the light bulb j. You want to choose a set of light bulbs S that you initially turn on in such a way that by performing the described operations, you can ensure that all light bulbs are turned on.Calculate two numbers:  the minimum size of the set S that you initially turn on;  the number of sets S of minimum size (taken modulo 998244353)." 2300
1914G1 "Light Bulbs (Easy Version)" "brute force,combinatorics,dfs and similar,dp,dsu,graphs,math,trees" "The easy and hard versions of this problem differ only in the constraints on n. In the easy version, the sum of values of n2 over all test cases does not exceed 106. Furthermore, n does not exceed 1000 in each test case.There are 2n light bulbs arranged in a row. Each light bulb has a color from 1 to n (exactly two light bulbs for each color).Initially, all light bulbs are turned off. You choose a set of light bulbs S that you initially turn on. After that, you can perform the following operations in any order any number of times:  choose two light bulbs i and j of the same color, exactly one of which is on, and turn on the second one;  choose three light bulbs i,j,k, such that both light bulbs i and k are on and have the same color, and the light bulb j is between them (i<j<k), and turn on the light bulb j. You want to choose a set of light bulbs S that you initially turn on in such a way that by performing the described operations, you can ensure that all light bulbs are turned on.Calculate two numbers:  the minimum size of the set S that you initially turn on;  the number of sets S of minimum size (taken modulo 998244353)." 2100
1914F "Programming Competition" "dfs and similar,dp,graph matchings,greedy,trees" "BerSoft is the biggest IT corporation in Berland. There are n employees at BerSoft company, numbered from 1 to n. The first employee is the head of the company, and he does not have any superiors. Every other employee i has exactly one direct superior pi.Employee x is considered to be a superior (direct or indirect) of employee y if one of the following conditions holds:   employee x is the direct superior of employee y;  employee x is a superior of the direct superior of employee y. The structure of BerSoft is organized in such a way that the head of the company is superior of every employee.A programming competition is going to be held soon. Two-person teams should be created for this purpose. However, if one employee in a team is the superior of another, they are uncomfortable together. So, teams of two people should be created so that no one is the superior of the other. Note that no employee can participate in more than one team.Your task is to calculate the maximum possible number of teams according to the aforementioned rules." 1900
1914E2 "Game with Marbles (Hard Version)" games,greedy,sortings "The easy and hard versions of this problem differ only in the constraints on the number of test cases and n. In the hard version, the number of test cases does not exceed 104, and the sum of values of n over all test cases does not exceed 2\xe2\x8b\x85105. Furthermore, there are no additional constraints on n in a single test case.Recently, Alice and Bob were given marbles of n different colors by their parents. Alice has received a1 marbles of color 1, a2 marbles of color 2,..., an marbles of color n. Bob has received b1 marbles of color 1, b2 marbles of color 2, ..., bn marbles of color n. All ai and bi are between 1 and 109.After some discussion, Alice and Bob came up with the following game: players take turns, starting with Alice. On their turn, a player chooses a color i such that both players have at least one marble of that color. The player then discards one marble of color i, and their opponent discards all marbles of color i. The game ends when there is no color i such that both players have at least one marble of that color.The score in the game is the difference between the number of remaining marbles that Alice has and the number of remaining marbles that Bob has at the end of the game. In other words, the score in the game is equal to (A\xe2\x88\x92B), where A is the number of marbles Alice has and B is the number of marbles Bob has at the end of the game. Alice wants to maximize the score, while Bob wants to minimize it.Calculate the score at the end of the game if both players play optimally." 1400
1914E1 "Game with Marbles (Easy Version)" "brute force,games,greedy,sortings" "The easy and hard versions of this problem differ only in the constraints on the number of test cases and n. In the easy version, the number of test cases does not exceed 103, and n does not exceed 6.Recently, Alice and Bob were given marbles of n different colors by their parents. Alice has received a1 marbles of color 1, a2 marbles of color 2,..., an marbles of color n. Bob has received b1 marbles of color 1, b2 marbles of color 2, ..., bn marbles of color n. All ai and bi are between 1 and 109.After some discussion, Alice and Bob came up with the following game: players take turns, starting with Alice. On their turn, a player chooses a color i such that both players have at least one marble of that color. The player then discards one marble of color i, and their opponent discards all marbles of color i. The game ends when there is no color i such that both players have at least one marble of that color.The score in the game is the difference between the number of remaining marbles that Alice has and the number of remaining marbles that Bob has at the end of the game. In other words, the score in the game is equal to (A\xe2\x88\x92B), where A is the number of marbles Alice has and B is the number of marbles Bob has at the end of the game. Alice wants to maximize the score, while Bob wants to minimize it.Calculate the score at the end of the game if both players play optimally." 1400
1914D "Three Activities" "brute force,dp,greedy,implementation,sortings" "Winter holidays are coming up. They are going to last for n days.During the holidays, Monocarp wants to try all of these activities exactly once with his friends:   go skiing;  watch a movie in a cinema;  play board games. Monocarp knows that, on the i-th day, exactly ai friends will join him for skiing, bi friends will join him for a movie and ci friends will join him for board games.Monocarp also knows that he can\'t try more than one activity in a single day.Thus, he asks you to help him choose three distinct days x,y,z in such a way that the total number of friends to join him for the activities (ax+by+cz) is maximized." 1200
1914C Quests greedy,math "Monocarp is playing a computer game. In order to level up his character, he can complete quests. There are n quests in the game, numbered from 1 to n.Monocarp can complete quests according to the following rules:   the 1-st quest is always available for completion;  the i-th quest is available for completion if all quests j<i have been completed at least once. Note that Monocarp can complete the same quest multiple times.For each completion, the character gets some amount of experience points:   for the first completion of the i-th quest, he gets ai experience points;  for each subsequent completion of the i-th quest, he gets bi experience points. Monocarp is a very busy person, so he has free time to complete no more than k quests. Your task is to calculate the maximum possible total experience Monocarp can get if he can complete no more than k quests." 1100
1914B "Preparing for the Contest" "constructive algorithms,math" "Monocarp is practicing for a big contest. He plans to solve n problems to make sure he\'s prepared. Each of these problems has a difficulty level: the first problem has a difficulty level of 1, the second problem has a difficulty level of 2, and so on, until the last (n-th) problem, which has a difficulty level of n.Monocarp will choose some order in which he is going to solve all n problems. Whenever he solves a problem which is more difficult than the last problem he solved, he gets excited because he feels like he\'s progressing. He doesn\'t get excited when he solves the first problem in his chosen order.For example, if Monocarp solves the problems in the order [3,5_,4,1,6_,2], he gets excited twice (the corresponding problems are underlined).Monocarp wants to get excited exactly k times during his practicing session. Help him to choose the order in which he has to solve the problems!" 800
1914A "Problemsolving Log" implementation,strings "Monocarp is participating in a programming contest, which features 26 problems, named from \'A\' to \'Z\'. The problems are sorted by difficulty. Moreover, it\'s known that Monocarp can solve problem \'A\' in 1 minute, problem \'B\' in 2 minutes, ..., problem \'Z\' in 26 minutes.After the contest, you discovered his contest log \xe2\x80\x94 a string, consisting of uppercase Latin letters, such that the i-th letter tells which problem Monocarp was solving during the i-th minute of the contest. If Monocarp had spent enough time in total on a problem to solve it, he solved it. Note that Monocarp could have been thinking about a problem after solving it.Given Monocarp\'s contest log, calculate the number of problems he solved during the contest." 800
1913F "Palindromic Problem" "binary search,data structures,hashing,string suffix structures,strings" "You are given a string s of length n, consisting of lowercase Latin letters.You are allowed to replace at most one character in the string with an arbitrary lowercase Latin letter.Print the lexicographically minimal string that can be obtained from the original string and contains the maximum number of palindromes as substrings. Note that if a palindrome appears more than once as a substring, it is counted the same number of times it appears.The string a is lexicographically smaller than the string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b are different, the string a contains a letter that appears earlier in the alphabet than the corresponding letter in b." 2800
1913E "Matrix Problem" flows,graphs "You are given a matrix a, consisting of n rows by m columns. Each element of the matrix is equal to 0 or 1.You can perform the following operation any number of times (possibly zero): choose an element of the matrix and replace it with either 0 or 1.You are also given two arrays A and B (of length n and m respectively). After you perform the operations, the matrix should satisfy the following conditions:  the number of ones in the i-th row of the matrix should be exactly Ai for every i\xe2\x88\x88[1,n].  the number of ones in the j-th column of the matrix should be exactly Bj for every j\xe2\x88\x88[1,m]. Calculate the minimum number of operations you have to perform." 2400
1913D "Array Collapse" "data structures,divide and conquer,dp,trees" "You are given an array [p1,p2,\xe2\x80\xa6,pn], where all elements are distinct.You can perform several (possibly zero) operations with it. In one operation, you can choose a contiguous subsegment of p and remove all elements from that subsegment, except for the minimum element on that subsegment. For example, if p=[3,1,4,7,5,2,6] and you choose the subsegment from the 3-rd element to the 6-th element, the resulting array is [3,1,2,6].An array a is called reachable if it can be obtained from p using several (maybe zero) aforementioned operations. Calculate the number of reachable arrays, and print it modulo 998244353." 2100
1913C "Game with Multiset" "binary search,bitmasks,brute force,greedy" "In this problem, you are initially given an empty multiset. You have to process two types of queries:  ADD x \xe2\x80\x94 add an element equal to 2x to the multiset;  GET w \xe2\x80\x94 say whether it is possible to take the sum of some subset of the current multiset and get a value equal to w." 1300
1913B "Swap and Delete" strings "You are given a binary string s (a string consisting only of 0-s and 1-s).You can perform two types of operations on s:   delete one character from s. This operation costs 1 coin;  swap any pair of characters in s. This operation is free (costs 0 coins). You can perform these operations any number of times and in any order.Let\'s name a string you\'ve got after performing operations above as t. The string t is good if for each i from 1 to |t| ti\xe2\x89\xa0si (|t| is the length of the string t). The empty string is always good. Note that you are comparing the resulting string t with the initial string s.What is the minimum total cost to make the string t good?" 1000
1913A "Rating Increase" implementation "Monocarp is a great solver of adhoc problems. Recently, he participated in an Educational Codeforces Round, and gained rating!Monocarp knew that, before the round, his rating was a. After the round, it increased to b (b>a). He wrote both values one after another to not forget them.However, he wrote them so close to each other, that he can\'t tell now where the first value ends and the second value starts.Please, help him find some values a and b such that:   neither of them has a leading zero;  both of them are strictly greater than 0;  b>a;  they produce the given value ab when written one after another. If there are multiple answers, you can print any of them." 800
1912L "LOL Lovers" strings "There are n food items lying in a row on a long table. Each of these items is either a loaf of bread (denoted as a capital Latin letter \'L\' with ASCII code 76) or an onion (denoted as a capital Latin letter \'O\' with ASCII code 79). There is at least one loaf of bread and at least one onion on the table.You and your friend want to divide the food on the table: you will take a prefix of this row (several leftmost items), and the friend will take the rest. However, there are several restrictions:   Each person should have at least one item.  The number of your loaves should differ from the number of your friend\'s loaves.  The number of your onions should differ from the number of your friend\'s onions.  Find any correct division and print the number of items you take or report that there is no answer." 800
1912K "Kim\'s Quest" bitmasks,combinatorics,dp "In the long-forgotten halls of Kombinatoria\'s ancient academy, a gifted mathematician named Kim is faced with an unusual challenge. They found an old sequence of integers, which is believed to be a cryptic message from the legendary Kombinatoria\'s Oracle, and Kim wants to decipher its hidden meaning.Kim\'s mission is to find specific patterns within the sequence, known as Harmonious Subsequences. These are extraordinary subsequences where the sum of every three consecutive numbers is even, and each subsequence must be at least three numbers in length. Given a sequence ai (1\xe2\x89\xa4i\xe2\x89\xa4n) of length n, its subsequence of length m is equal to ab1,ab2,\xe2\x80\xa6,abm and is uniquely defined by a set of m indices bj, such that 1\xe2\x89\xa4b1<b2<\xe2\x80\xa6<bm\xe2\x89\xa4n. Subsequences given by different sets of indices bj are considered different.There\'s a twist in Kim\'s quest: the number of these Harmonious Subsequences could be overwhelming. To report the findings effectively, Kim must calculate the total number of these subsequences, presenting the answer as a remainder after dividing by the number 998244353." 1800
1912H "Hypercatapult Commute" graphs "A revolutionary new transport system is currently operating in Byteland. This system requires neither roads nor sophisticated mechanisms, only giant catapults. The system works as follows. There are n cities in Byteland. In every city there is a catapult, right in the city center. People who want to travel are put in a special capsule, and a catapult throws this capsule to the center of some other city. Every catapult is powerful enough to throw the capsule to any other city, with any number of passengers inside the capsule. The only problem is that it takes a long time to charge the catapult, so it is only possible to use it once a day.The passenger may need to use the catapults multiple times. For example, if the passenger wants to travel from city A to city B, they can first use one catapult to move from A to C, and then transfer to another catapult to move from C to B.Today there are m passengers. Passenger i wants to travel from city ai to city bi. Your task is to find the way to deliver all the passengers to their destinations in a single day, using the minimal possible number of catapults, or say that it is impossible." 2400
1912F "Fugitive Frenzy" math,probabilities "The city of F. can be represented as a tree. A famous fugitive is hiding in it, and today a faithful police officer decided to catch him at all costs. The police officer is stronger than the fugitive, but the fugitive is much faster than the former. That is why the pursuit proceeds as follows. At the moment t=0 the police officer appears at the vertex with number s, and the fugitive spawns at any other vertex of his choice. After that, they take turns, starting with the police officer.  During the police officer\'s move, she selects any vertex adjacent to the one where she is currently located and moves there. The police officer spends one minute moving. Also, the police officer may decide to stand still instead, in which case she waits one minute at the vertex at which she started her move. If at the end of the turn the police officer ends up at the same vertex as the fugitive, she instantly catches him and the chase ends.  The fugitive\'s move is as follows. Let him be at vertex b, and the police officer at vertex p. Then the fugitive chooses any vertex b\xe2\x80\xb2\xe2\x89\xa0p such that the path between the vertices b and b\xe2\x80\xb2 does not contain vertex p and instantly moves there. In particular, he can always choose b\xe2\x80\xb2=b to stay where he is. The fugitive\'s move takes no time. Note that the fugitive managed to attach a radio bug to the police officer\'s badge a week ago, so the fugitive knows the location of the police officer at every moment (in particular, he knows the number s). On the contrary, the police officer knows nothing about the fugitive\'s movements and will only be able to detect him at the very moment she catches him.The police officer aims to catch the fugitive as fast as possible, and the fugitive aims to be caught as late as possible. Since the chase can be thought of as a game with incomplete information, participants can use mixed (probabilistic) strategies \xe2\x80\x94 thus, the police officer acts to minimize the expected duration of the chase, and the fugitive \xe2\x80\x94 to maximize it.Find the mathematical expectation of the duration of the chase with optimal actions of the police officer and the fugitive. It can be proven that it is always finite. In particular, with optimal strategies, the probability that the chase continues indefinitely is equal to zero." 3100
1912E "Evaluate It and Back Again" "constructive algorithms,implementation,math" "Aidan and Nadia are long-time friends with a shared passion for mathematics. Each of them has a favorite number: Aidan\'s favorite number is p, and Nadia\'s is q. To commemorate their friendship, their friends want to make a present: a plaque with an arithmetic expression whose value is equal to their favorite numbers. At first glance, it sounds impossible, but the answer is simple: Aidan reads left-to-right, while Nadia reads right-to-left, so the same expression can have different values for them.For example, if 2023-12-13 is written on the plaque, then Aidan would calculate the result as 2023\xe2\x88\x9212\xe2\x88\x9213=1998, and Nadia would calculate it as 31\xe2\x88\x9221\xe2\x88\x923202=\xe2\x88\x923192.Find an arithmetic expression that, when read left-to-right, evaluates to p, and, when read right-to-left, evaluates to q. Its length must be at most 1000 characters. It\'s guaranteed that such an expression exists for all valid inputs." 2200
1912D "Divisibility Test" math "Daisy has recently learned divisibility rules for integers and she is fascinated by them. One of the tests she learned is a divisibility test by 3. You can find a sum of all digits of a decimal number and check if the resulting sum is divisible by 3. Moreover, the resulting sum of digits is congruent modulo 3 to the original number \xe2\x80\x94 the remainder modulo 3 is preserved. For example, 75\xe2\x89\xa17+5(mod3). Daisy is specifically interested in such remainder preserving divisibility tests.There are more examples like that that she learned for decimal integers (integers base 10):  To test divisibility modulo 11, find an alternating sum of digits. Counting digits from the last (least significant) digit, add digits on odd positions (the last, 3rd to the last, etc) and subtract digits on even positions (2nd to the last, 4th to the last, etc) to get the sum that is congruent modulo 11 to the original number. For example, 123\xe2\x89\xa11\xe2\x88\x922+3(mod11).  To test divisibility modulo 4, keep the last two digits. Their value is congruent modulo 4 to the original number. For example, 876543\xe2\x89\xa143(mod4).  To test divisibility modulo 7, find an alternating sum of groups of three digits. For example, 4389328\xe2\x89\xa14\xe2\x88\x92389+328(mod7). Similar tests can be found in other bases. For example, to test divisibility modulo 5 for octal numbers (base 8), find an alternating sum of groups of two digits. For example, 12348\xe2\x89\xa1\xe2\x88\x92128+348(mod5).Daisy wants to find such rules for a given base b. She is interested in three kinds of divisibility rules:  Kind 1 \xe2\x80\x94 take the last k digits of an integer in base b.  Kind 2 \xe2\x80\x94 take a sum of groups of k digits of an integer in base b.  Kind 3 \xe2\x80\x94 take an alternating sum of groups of k digits of an integer in base b. It is not always possible to find such a divisibility rule. For example, in base 10 there is no such test for divisibility modulo 6, even though different approaches to testing divisibility by 6 exist.Given base b and modulo n, Daisy wants to know the smallest group size k for which such a divisibility test exits." 1900
1912B "Blueprint for Seating" "combinatorics,divide and conquer,math" "An aircraft manufacturing company wants to optimize their products for passenger airlines. The company\'s latest research shows that most of the delays happen because of slow boarding.Most of the medium-sized aircraft are designed with 3-3 seat layout, meaning each row has 6 seats: 3 seats on the left side, a single aisle, and 3 seats on the right side. At each of the left and right sides there is a window seat, a middle seat, and an aisle seat. A passenger that boards an aircraft assigned to an aisle seat takes significantly less time than a passenger assigned to a window seat even when there is no one else in the aircraft.The company decided to compute an inconvenience of a layout as the total sum of distances from each of the seats of a single row to the closest aisle. The distance from a seat to an aisle is the number of seats between them. For a 3-3 layout, a window seat has a distance of 2, a middle seat \xe2\x80\x94 1, and an aisle seat \xe2\x80\x94 0. The inconvenience of a 3-3 layout is (2+1+0)+(0+1+2)=6. The inconvenience of a 3-5-3 layout is (2+1+0)+(0+1+2+1+0)+(0+1+2)=10.Formally, a layout is a sequence of positive integers a1,a2,\xe2\x80\xa6,ak+1 \xe2\x80\x94 group i having ai seats, with k aisles between groups, the i-th aisle being between groups i and i+1. This means that in a layout each aisle must always be between two seats, so no aisle can be next to a window, and no two aisles can be next to each other.The company decided to design a layout with a row of n seats, k aisles and having the minimum inconvenience possible. Help them find the minimum inconvenience among all layouts of n seats and k aisles, and count the number of such layouts modulo 998244353." 2100
1912A "Accumulator Apex" "data structures,implementation,sortings" "Allyn is playing a new strategy game called ""Accumulator Apex"". In this game, Allyn is given the initial value of an integer x, referred to as the accumulator, and k lists of integers. Allyn can make multiple turns. On each turn, Allyn can withdraw the leftmost element from any non-empty list and add it to the accumulator x if the resulting x is non-negative. Allyn can end the game at any moment. The goal of the game is to get the largest possible value of the accumulator x. Please help Allyn find the largest possible value of the accumulator x they can get in this game." 1900
1910J "Two Colors" "*special problem" "You are given a tree consisting of n vertices. Some vertices of the tree are red, all other vertices are blue.Each edge of the tree has a positive weight. Let\'s define d(x,y) as the distance between the vertices x and y, i.\xe2\x80\x89e. the sum of weights of edges belonging to the simple path between x and y.For each vertex, you have to choose an integer vi. These integers should meet the following constraint: for every blue vertex b and every red vertex r, d(b,r)\xe2\x89\xa5vb+vr. You have to maximize the value of n\xe2\x88\x91i=1vi.Note that the values of vi are not necessarily positive." 2900
1910I "Inverse Problem" "*special problem,combinatorics,dp" "Consider the following problem.You are given a string s, consisting of n lowercase Latin letters, and an integer k (n is not divisible by k). Each letter is one of the first c letters of the alphabet.You apply the following operation until the length of the string is less than k: choose a contiguous substring of the string of length exactly k, remove it from the string and glue the resulting parts together without changing the order.Let the resulting string of length smaller than k be t. What is lexicographically smallest string t that can obtained?You are asked the inverse of this problem. Given two integers n and k (n is not divisible by k) and a string t, consisting of (nmodk) lowercase Latin letters, count the number of strings s that produce t as the lexicographically smallest solution.Print that number modulo 998244353." 2700
1910H "Sum of Digits of Sums" "*special problem,binary search,data structures" "You are given an array [a1,a2,\xe2\x80\xa6,an], consisting of positive integers.For every i from 1 to n, calculate n\xe2\x88\x91j=1F(ai+aj), where F(x) is the sum of digits of x." 2400
1910G "Pool Records" "*special problem,greedy" "Alice and Bob are swimming in the pool under the guidance of their instructor Monocarp.The pool can be represented as a segment on the OX-axis from 0 to 50. Both Alice and Bob started at moment 0 at point 0 with positive real speeds vA and vB correspondingly.Both Alice and Bob swim from 0 to point 50, then instantly turn back and swim from 50 to 0. At 0 they turn back again and swim to 50 and so on.Monocarp logged all valuable info about Alice and Bob, including moments of time when they met at the same point (Alice and Bob swim on parallel lanes, so they don\'t bother each other). Let\'s name that moments of time as sequence t1,t2,\xe2\x80\xa6,tn.Due to some incident, Monocarp lost almost all data he recorded, and all he has now is array t. Monocarp remembers that Alice and Bob had distinct positive real swimming speeds vA and vB (vA>0; vB>0; vA\xe2\x89\xa0vB) and that sequence t contains the first n meeting moments.But looking at sequence t he noticed that all ti are integer values, and now he doubts is sequence t valid or there are some errors in it. Help Monocarp to check array t!" 2700
1910F "Build Railway Stations" "*special problem,greedy,trees" "Monocarp is playing a computer game where he\'s controlling an empire. An empire consists of n cities, connected by n\xe2\x88\x921 roads. The cities are numbered from 1 to n. It\'s possible to reach every city from every other one using the roads.Traversing every road takes 2 hours. However, that can be improved. Monocarp can build railway stations in no more than k cities. After they are built, all existing roads that connect two cities with railway stations get converted to railroads and become 1 hour to traverse.Let f(x,y) be the total time it takes to traverse the roads on the shortest path between cities x and y.Monocarp wants to build at most k railway stations in such a way that the following value is minimized: n\xe2\x88\x91v=1v\xe2\x88\x921\xe2\x88\x91u=1f(v,u) (the total time it takes to travel from every city to every other one). What the smallest value he can achieve?" 2000
1910E "Maximum Sum Subarrays" "*special problem,dp" "You are given two integer arrays a and b, both of length n.You can perform the following operation any number of times (possibly zero): swap ai and bi.Let f(c) be the maximum sum of a contiguous subarray of the array c (including the empty subsegment, which sum is 0).Your task is to calculate the maximum possible value of f(a)+f(b), using the aforementioned operation any number of times." 2100
1910D "Remove and Add" "*special problem,greedy" "You are given an array a1,a2,\xe2\x80\xa6,an, consisting of n integers.You goal is to make is strictly increasing. To achieve that, you perform each of the following operations exactly once:   first, remove any element;  second, select any number of elements (possibly, none or all n\xe2\x88\x921) and add 1 to them. Note that you are not allowed to rearrange the elements of the array.For the resulting array a\xe2\x80\xb2, a\xe2\x80\xb21<a\xe2\x80\xb22<\xe2\x8b\xaf<a\xe2\x80\xb2n\xe2\x88\x921 should hold. Determine if it\'s possible to achieve that." 1800
1910C "Poisonous Swamp" "*special problem,*special problem,implementation,implementation" "The first location in the brand new critically acclaimed fantasy action RPG ""Ancient Staff"" is a poisonous swamp. The swamp has some lily pads growing in it. It can be represented as a 2\xc3\x97n grid (2 rows and n columns), where each cell is either empty or has a lily pad in it.There are exactly n lily pads in a swamp \xe2\x80\x94 one in each column. A frog is sitting on top of every lily pad. In one move, every frog must jump to an adjacent by a side cell.After the move, no frog can be outside the grid and no two frogs can share the same lily pad. Two frogs from adjacent cells can\'t jump towards each other (i.e. swap cells).If a frog jumps to a lily pad, it survives. Otherwise, it falls into a poisonous swamp and gets devoured by an eldritch creature living on its bottom.You can choose the direction each frogs jumps at. Determine the maximum number of frogs that can survive after one move." 1600
1910B "Security Guard" "*special problem,greedy" "Monocarp is a security guard in Berland State University. Every day, he tracks how many people and at what time enter and leave the university. He writes this information down as follows:   when someone enters the university, Monocarp writes a plus sign \'+\';  when someone leaves the university, Monocarp writes a minus sign \'-\'. At the beginning of the current day, there are no people at the university, except for Monocarp. During the day, Monocarp wrote out a sequence s. The characters in s are listed in the order Monocarp wrote them.Suddenly, Monocarp\'s boss decided to check his work. Unfortunately, Monocarp is a bit careless. So, the sequence s that he wrote might be impossible. For example, the sequence ""+--"" can\'t happen, since it represents a scenario when one person enters the university and two leave.Before his boss starts checking the sequence, Monocarp has the time to swap at most one pair of characters in it. Can he do it in such a way that the resulting sequence is plausible? Note that if the given sequence is already plausible, Monocarp doesn\'t have to swap anything." 1600
1910A Username "*special problem,implementation" "On the official website of Berland, each account has two parameters: username and ID.Username is a string consisting of lowercase Latin letters and/or digits, which contains at least one letter. For example, user0, 1fox1, zzzz are correct usernames, but 1337 and User22 are not. The ID of the account for a given username is generated as follows: a positive integer without leading zeroes is appended to the end of the username. For example, the ID user0125 can be generated by the following usernames: user012, user01, user0; but neither by user nor us.You are given a string s \xe2\x80\x94 a valid ID. Your task is to determine any valid username that can generate the given ID. If there are several correct usernames, you can print any of them." 1100
1909I "Short Permutation Problem" combinatorics,dp,fft,math "Xomu - Last Dance\xe2\xa0\x80You are given an integer n.For each (m,k) such that 3\xe2\x89\xa4m\xe2\x89\xa4n+1 and 0\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x921, count the permutations of [1,2,...,n] such that pi+pi+1\xe2\x89\xa5m for exactly k indices i, modulo 998244353." 1900
1909H "Parallel Swaps Sort" "constructive algorithms,data structures" "Dubmood - Keygen 8\xe2\xa0\x80You are given a permutation p1,p2,\xe2\x80\xa6,pn of [1,2,\xe2\x80\xa6,n]. You can perform the following operation some (possibly 0) times:  choose a subarray [l,r] of even length;  swap al, al+1;  swap al+2, al+3 (if l+3\xe2\x89\xa4r);  \xe2\x80\xa6  swap ar\xe2\x88\x921, ar. Sort the permutation in at most 106 operations. You do not need to minimize the number of operations." 3500
1909G "Pumping Lemma" hashing,strings "Tanchiky & Siromaru - Crystal Gravity\xe2\xa0\x80You are given two strings s, t of length n, m, respectively. Both strings consist of lowercase letters of the English alphabet.Count the triples (x,y,z) of strings such that the following conditions are true:  s=x+y+z (the symbol + represents the concatenation);  t=x+y+\xe2\x8b\xaf+y\xe2\x8f\x9fk times+z for some integer k." 3000
1909F2 "Small Permutation Problem (Hard Version)" combinatorics,dp,math "Andy Tunstall - MiniBoss\xe2\xa0\x80In the easy version, the ai are in the range [0,n]; in the hard version, the ai are in the range [\xe2\x88\x921,n] and the definition of good permutation is slightly different. You can make hacks only if all versions of the problem are solved.You are given an integer n and an array a1,a2,\xe2\x80\xa6,an of integers in the range [\xe2\x88\x921,n].A permutation p1,p2,\xe2\x80\xa6,pn of [1,2,\xe2\x80\xa6,n] is good if, for each i, the following condition is true:   if ai\xe2\x89\xa0\xe2\x88\x921, the number of values \xe2\x89\xa4i in [p1,p2,\xe2\x80\xa6,pi] is exactly ai. Count the good permutations of [1,2,\xe2\x80\xa6,n], modulo 998244353." 2500
1909F1 "Small Permutation Problem (Easy Version)" "brute force,combinatorics,dp,math" "Andy Tunstall - MiniBoss\xe2\xa0\x80In the easy version, the ai are in the range [0,n]; in the hard version, the ai are in the range [\xe2\x88\x921,n] and the definition of good permutation is slightly different. You can make hacks only if all versions of the problem are solved.You are given an integer n and an array a1,a2\xe2\x80\xa6,an of integers in the range [0,n].A permutation p1,p2,\xe2\x80\xa6,pn of [1,2,\xe2\x80\xa6,n] is good if, for each i, the following condition is true:   the number of values \xe2\x89\xa4i in [p1,p2,\xe2\x80\xa6,pi] is exactly ai. Count the good permutations of [1,2,\xe2\x80\xa6,n], modulo 998244353." 2200
1909E "Multiple Lamps" "bitmasks,brute force,constructive algorithms,math,number theory" "Kid2Will - Fire Aura\xe2\xa0\x80You have n lamps, numbered from 1 to n. Initially, all the lamps are turned off.You also have n buttons. The i-th button toggles all the lamps whose index is a multiple of i. When a lamp is toggled, if it was off it turns on, and if it was on it turns off.You have to press some buttons according to the following rules.  You have to press at least one button.  You cannot press the same button multiple times.  You are given m pairs (ui,vi). If you press the button ui, you also have to press the button vi (at any moment, not necessarily after pressing the button ui). Note that, if you press the button vi, you don\'t need to press the button ui. You don\'t want to waste too much electricity. Find a way to press buttons such that at the end at most \xe2\x8c\x8an/5\xe2\x8c\x8b lamps are on, or print \xe2\x88\x921 if it is impossible." 2400
1909D "Split Plus K" "greedy,math,number theory" "eliteLAQ - Desert Ruins\xe2\xa0\x80There are n positive integers a1,a2,\xe2\x80\xa6,an on a blackboard. You are also given a positive integer k. You can perform the following operation some (possibly 0) times:  choose a number x on the blackboard;  erase one occurrence of x;  write two positive integers y, z such that y+z=x+k on the blackboard. Is it possible to make all the numbers on the blackboard equal? If yes, what is the minimum number of operations you need?" 1900
1909C "Heavy Intervals" "constructive algorithms,data structures,dsu,greedy,math,sortings" "Shiki - Pure Ruby\xe2\xa0\x80You have n intervals [l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn], such that li<ri for each i, and all the endpoints of the intervals are distinct.The i-th interval has weight ci per unit length. Therefore, the weight of the i-th interval is ci\xe2\x8b\x85(ri\xe2\x88\x92li).You don\'t like large weights, so you want to make the sum of weights of the intervals as small as possible. It turns out you can perform all the following three operations:  rearrange the elements in the array l in any order;  rearrange the elements in the array r in any order;  rearrange the elements in the array c in any order. However, after performing all of the operations, the intervals must still be valid (i.e., for each i, li<ri must hold).What\'s the minimum possible sum of weights of the intervals after performing the operations?" 1400
1909B "Make Almost Equal With Mod" "bitmasks,constructive algorithms,math,number theory" "xi - Solar Storm\xe2\xa0\x80You are given an array a1,a2,\xe2\x80\xa6,an of distinct positive integers. You have to do the following operation exactly once:  choose a positive integer k;  for each i from 1 to n, replace ai with ai mod k\xe2\x80\xa0. Find a value of k such that 1\xe2\x89\xa4k\xe2\x89\xa41018 and the array a1,a2,\xe2\x80\xa6,an contains exactly 2 distinct values at the end of the operation. It can be shown that, under the constraints of the problem, at least one such k always exists. If there are multiple solutions, you can print any of them.\xe2\x80\xa0 a mod b denotes the remainder after dividing a by b. For example:   7 mod 3=1 since 7=3\xe2\x8b\x852+1  15 mod 4=3 since 15=4\xe2\x8b\x853+3  21 mod 1=0 since 21=21\xe2\x8b\x851+0" 1200
1909A "Distinct Buttons" implementation,math "Deemo - Entrance\xe2\xa0\x80You are located at the point (0,0) of an infinite Cartesian plane. You have a controller with 4 buttons which can perform one of the following operations:  U: move from (x,y) to (x,y+1);  R: move from (x,y) to (x+1,y);  D: move from (x,y) to (x,y\xe2\x88\x921);  L: move from (x,y) to (x\xe2\x88\x921,y). Unfortunately, the controller is broken. If you press all the 4 buttons (in any order), the controller stops working. It means that, during the whole trip, you can only press at most 3 distinct buttons (any number of times, in any order).There are n special points in the plane, with integer coordinates (xi,yi).Can you visit all the special points (in any order) without breaking the controller?" 800
1907G Lights "brute force,constructive algorithms,dfs and similar,graphs,greedy,implementation" "In the end of the day, Anna needs to turn off the lights in the office. There are n lights and n light switches, but their operation scheme is really strange. The switch i changes the state of light i, but it also changes the state of some other light ai (change the state means that if the light was on, it goes off and vice versa).Help Anna to turn all the lights off using minimal number of switches, or say it is impossible." 2200
1907F "Shift and Reverse" greedy,sortings "Given an array of integers a1,a2,\xe2\x80\xa6,an. You can make two types of operations with this array:   Shift: move the last element of array to the first place, and shift all other elements to the right, so you get the array an,a1,a2,\xe2\x80\xa6,an\xe2\x88\x921.  Reverse: reverse the whole array, so you get the array an,an\xe2\x88\x921,\xe2\x80\xa6,a1. Your task is to sort the array in non-decreasing order using the minimal number of operations, or say that it is impossible." 1800
1907E "Good Triples" "brute force,combinatorics,number theory" "Given a non-negative integer number n (n\xe2\x89\xa50). Let\'s say a triple of non-negative integers (a,b,c) is good if a+b+c=n, and digsum(a)+digsum(b)+digsum(c)=digsum(n), where digsum(x) is the sum of digits of number x.For example, if n=26, then the pair (4,12,10) is good, because 4+12+10=26, and (4)+(1+2)+(1+0)=(2+6).Your task is to find the number of good triples for the given number n. The order of the numbers in a triple matters. For example, the triples (4,12,10) and (10,12,4) are two different triples." 1600
1907D "Jumping Through Segments" "binary search,constructive algorithms" "Polycarp is designing a level for a game. The level consists of n segments on the number line, where the i-th segment starts at the point with coordinate li and ends at the point with coordinate ri.The player starts the level at the point with coordinate 0. In one move, they can move to any point that is within a distance of no more than k. After their i-th move, the player must land within the i-th segment, that is, at a coordinate x such that li\xe2\x89\xa4x\xe2\x89\xa4ri. This means:  After the first move, they must be inside the first segment (from l1 to r1);  After the second move, they must be inside the second segment (from l2 to r2);  ...  After the n-th move, they must be inside the n-th segment (from ln to rn). The level is considered completed if the player reaches the n-th segment, following the rules described above. After some thought, Polycarp realized that it is impossible to complete the level with some values of k.Polycarp does not want the level to be too easy, so he asks you to determine the minimum integer k with which it is possible to complete the level." 1400
1907C "Removal of Unattractive Pairs" "constructive algorithms,greedy,math,strings" "Vlad found a string s consisting of n lowercase Latin letters, and he wants to make it as short as possible.To do this, he can remove any pair of adjacent characters from s any number of times, provided they are different. For example, if s=racoon, then by removing one pair of characters he can obtain the strings coon, roon, raon, and raco, but he cannot obtain racn (because the removed letters were the same) or rcon (because the removed letters were not adjacent).What is the minimum length Vlad can achieve by applying any number of deletions?" 1200
1907B YetnotherrokenKeoard "data structures,implementation,strings" "Polycarp has a problem \xe2\x80\x94 his laptop keyboard is broken.Now, when he presses the \'b\' key, it acts like an unusual backspace: it deletes the last (rightmost) lowercase letter in the typed string. If there are no lowercase letters in the typed string, then the press is completely ignored.Similarly, when he presses the \'B\' key, it deletes the last (rightmost) uppercase letter in the typed string. If there are no uppercase letters in the typed string, then the press is completely ignored.In both cases, the letters \'b\' and \'B\' are not added to the typed string when these keys are pressed.Consider an example where the sequence of key presses was ""ARaBbbitBaby"". In this case, the typed string will change as follows: """" A\xe2\x86\x92 ""A"" R\xe2\x86\x92 ""AR"" a\xe2\x86\x92 ""ARa"" B\xe2\x86\x92 ""Aa"" b\xe2\x86\x92 ""A"" b\xe2\x86\x92 ""A"" i\xe2\x86\x92 ""Ai"" t\xe2\x86\x92 ""Ait"" B\xe2\x86\x92 ""it"" a\xe2\x86\x92 ""ita"" b\xe2\x86\x92 ""it"" y\xe2\x86\x92 ""ity"".Given a sequence of pressed keys, output the typed string after processing all key presses." 1000
1907A Rook implementation "As you probably know, chess is a game that is played on a board with 64 squares arranged in an 8\xc3\x978 grid. Columns of this board are labeled with letters from a to h, and rows are labeled with digits from 1 to 8. Each square is described by the row and column it belongs to.  The rook is a piece in the game of chess. During its turn, it may move any non-zero number of squares horizontally or vertically. Your task is to find all possible moves for a rook on an empty chessboard." 800
1906M "Triangle Construction" greedy,math "You are given a regular N-sided polygon. Label one arbitrary side as side 1, then label the next sides in clockwise order as side 2, 3, \xe2\x80\xa6, N. There are Ai special points on side i. These points are positioned such that side i is divided into Ai+1 segments with equal length.For instance, suppose that you have a regular 4-sided polygon, i.e., a square. The following illustration shows how the special points are located within each side when A=[3,1,4,6]. The uppermost side is labelled as side 1.  You want to create as many non-degenerate triangles as possible while satisfying the following requirements. Each triangle consists of 3 distinct special points (not necessarily from different sides) as its corners. Each special point can only become the corner of at most 1 triangle. All triangles must not intersect with each other.Determine the maximum number of non-degenerate triangles that you can create.A triangle is non-degenerate if it has a positive area." 1700
1906L "Palindromic Parentheses" "constructive algorithms" "Construct a parentheses sequence consisting of N characters such that it is balanced and the length of its longest palindromic subsequence (LPS) is exactly K. Determine whether such a construction is possible. If there are several possible sequences, construct any of them.A parentheses sequence consists of only character ( and ). A parentheses sequence is balanced if each character ( has a corresponding character ) and the pairs of parentheses are properly nested. For example, (), (()), (())(), and ((())()) are balanced. However, )(, ((), and ()) are not balanced.A sequence is palindromic if it reads the same backwards as forwards. For example, ((, ), ())(, and (()(( are palindromic. However, (), )(, and (()) are not palindromic.A subsequence can be derived from another sequence by removing zero or more characters without changing the order of the remaining characters. For example, (, ))), ())(, and (())() are subsequence of (())(). However, )(( and ((())) are not subsequence of (())().The longest palindromic subsequence (LPS) of a sequence is a subsequence with the maximum number of characters, derived from that sequence and it is palindromic. For example, the LPS of sequence (())() is ())(, which can be obtained by removing the second and sixth characters. Therefore, the length of the LPS of (())() is 4." 2500
1906K "Deck-Building Game" "divide and conquer,math" "You are playing a deck-building game with your friend. There are N cards, numbered from 1 to N. Card i has the value of Ai.You want to build two decks; one for you and one for your friend. A card cannot be inside both decks, and it is allowed to not use all N cards. It is also allowed for a deck to be empty, i.e. does not contain any cards.The power of a deck is represented as the bitwise XOR of the value of the cards in the deck. The power of an empty deck is 0.The game is balanced if both decks have the same power.Determine the number of ways to build two decks such that the game is balanced. Two ways are considered different if one of the decks contains at least one different card. Since the answer can be very large, calculate the answer modulo 998244353." 2500
1906J "Count BFS Graph" combinatorics,dp "You are currently researching a graph traversal algorithm called the Breadth First Search (BFS). Suppose you have an input graph of N nodes (numbered from 1 to N). The graph is represented by an adjacency matrix M, for which node u can traverse to node v if Mu,v is 1, otherwise it is 0. Your algorithm will output the order the nodes are visited in the BFS. The pseudocode of the algorithm is presented as follows.    BFS(M[1..N][1..N]):        let A be an empty array        let Q be an empty queue        append 1 to A        push 1 to Q        while Q is not empty:            pop the front element of Q into u            for v = 1 to N:                if M[u][v] == 1 and v is not in A:                    append v to A                    push v to Q        return ADuring your research, you are interested in the following problem. Given an array A such that A is a permutation of 1 to N and A1=1. How many simple undirected graph with N nodes and adjacency matrix M such that BFS(M)=A? Since the answer can be very large, calculate the answer modulo 998244353.A simple graph has no self-loop (Mi,i=0 for 1\xe2\x89\xa4i\xe2\x89\xa4N) and there is at most one edge that connects a pair of nodes. In an undirected graph, if node u is adjacent to node v, then node v is also adjacent to node u; formally, Mu,v=Mv,u for 1\xe2\x89\xa4u<v\xe2\x89\xa4N.Two graphs are considered different if there is an edge that exists in one graph but not the other. In other words, two graphs are considered different if their adjacency matrices are different." 2100
1906I "Contingency Plan 2" "graph matchings" "You are working as a manager in The ICPC Company. In the company building, there are N computers (numbered from 1 to N). There are N\xe2\x88\x921 cables, numbered from 1 to N\xe2\x88\x921, that connect all the computers into a single network. Cable i connects computer Ui and Vi. Each cable can be set into emergency mode, where cable i only transfers data from computer Ui to computer Vi, but not the other way around. During a disaster, it is mandatory for all cables to be in emergency mode.Through your research, you discover a new way to determine the vulnerability of a network. You want to add zero or more new cables to the current network such that it is not vulnerable during a disaster. Your network is not vulnerable if and only if there is exactly one permutation of 1 to N such that u appears before v in the permutation for all cables that connect computer u and v. In other words, it should have exactly one topological order.The following illustration shows examples of not vulnerable networks and vulnerable networks.  For the not vulnerable networks, the only permutation that satisfies the requirement for the networks on the left and on the right are [1,2,3] and [3,1,2], respectively. Meanwhile, for the vulnerable networks, there are 2 permutations that satisfy the requirement for the network on the left: [1,2,3] and [3,1,2]; while there is no permutation that satisfies the requirement for the network on the right.You are interested in the minimum number of new cables that should be added to the current network such that it is not vulnerable during a disaster. Furthermore, you want to know, which pairs of computers should be connected by using the minimum number of cables. If there are several ways to connect, you can connect in any way of your choice. Under the given constraints, it can be proven that there exists a way to make the network not vulnerable." 2900
1906H "Twin Friends" combinatorics,dp "You meet two new friends who are twins. The name of the elder twin is A, which consists of N characters. While the name of the younger twin is B, which consists of M characters. It is known that N\xe2\x89\xa4M.You want to call each of them with a nickname. For the elder twin, you want to pick any permutation of A as the nickname. For the younger twin, you want to remove exactly M\xe2\x88\x92N characters from any permutation of B. Denote the nicknames of the elder twin and the younger twin as A\xe2\x80\xb2 and B\xe2\x80\xb2, respectively.You want the nicknames to satisfy the following requirement. For each i that satisfies 1\xe2\x89\xa4i\xe2\x89\xa4N, B\xe2\x80\xb2i must be equal to either A\xe2\x80\xb2i or the next letter that follows alphabetically after A\xe2\x80\xb2i (if such a next letter exists).Determine the number of different pairs of nicknames (A\xe2\x80\xb2,B\xe2\x80\xb2) that satisfy the requirement. Two pairs of nicknames are considered different if at least one of the nicknames are different. As the result might be large, find the answer modulo 998244353." 2200
1906G "Grid Game 2" "games,number theory" "You are playing ""Grid Game 2"" with your friend. There is a grid with 109 rows (numbered from 1 to 109) and 109 columns (numbered from 1 to 109). The cell at row r and column c is denoted as (r,c).Each cell can have a colour of either black or white. Initially, there are exactly N black cells (numbered from 1 to N). Black cell i is located at (Ri,Ci). The rest of the cells are white.You and your friend will alternately take turn playing on this grid, and you are playing in the first turn. In one turn, a player will choose a black cell (r,c), then toggle cells (r\xe2\x88\x92x,c\xe2\x88\x92y) for all 0\xe2\x89\xa4x,y<min(r,c). If a cell is toggled, then the cell becomes black if it was a white cell, and the cell becomes white if it was a black cell.For example, the following illustration shows how the grid changes after a player chooses a black cell (5,4) in their turn.  A player who is unable to play on their turn, i.e. no remaining black cells, loses the game, and the opposing player wins the game. If you and your friend are playing optimally, determine who will win the game." 2900
1906F "Maximize The Value" "data structures,sortings" "You are given a one-based array consisting of N integers: A1,A2,\xe2\x8b\xaf,AN. Initially, the value of each element is set to 0.There are M operations (numbered from 1 to M). Operation i is represented by \xe2\x9f\xa8Li,Ri,Xi\xe2\x9f\xa9. If operation i is executed, all elements Aj for Li\xe2\x89\xa4j\xe2\x89\xa4Ri will be increased by Xi.You have to answer Q independent queries. Each query is represented by \xe2\x9f\xa8K,S,T\xe2\x9f\xa9 which represents the following task. Choose a range [l,r] satisfying S\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4T, and execute operations l,l+1,\xe2\x80\xa6,r. The answer to the query is the maximum value of AK after the operations are executed among all possible choices of l and r." 2100
1906E "Merge Not Sort" "constructive algorithms,dp" "You are currently researching the Merge Sort algorithm. Merge Sort is a sorting algorithm that is based on the principle of Divide and Conquer. It works by dividing an array into two subarrays of equal length, sorting each subarrays, then merging the sorted subarrays back together to form the final sorted array.You are particularly interested in the merging routine. Common merge implementation will combine two subarrays by iteratively comparing their first elements, and move the smaller one to a new merged array. More precisely, the merge algorithm can be presented by the following pseudocode.    Merge(A[1..N], B[1..N]):        C = []        i = 1        j = 1        while i <= N AND j <= N:            if A[i] < B[j]:                append A[i] to C                i = i + 1            else:                append B[j] to C                j = j + 1         while i <= N:            append A[i] to C            i = i + 1         while j <= N:            append B[j] to C            j = j + 1         return CDuring your research, you are keen to understand the behaviour of the merge algorithm when arrays A and B are not necessarily sorted. For example, if A=[3,1,6] and B=[4,5,2], then Merge(A,B)=[3,1,4,5,2,6].To further increase the understanding of the merge algorithm, you decided to work on the following problem. You are given an array C of length 2\xe2\x8b\x85N such that it is a permutation of 1 to 2\xe2\x8b\x85N. Construct any two arrays A and B of the same length N, such that Merge(A,B)=C, or determine if it is impossible to do so." 1900
1906D "Spaceship Exploration" "binary search,geometry" "In The ICPC Galaxy, there exists a zone filled with asteroids that is unsafe to enter. The map of the galaxy is represented in a 2D Cartesian coordinate system. The zone is in the shape of an N-sided convex polygon. Each corner is numbered from 1 to N; corner i is located at (Xi,Yi). At any moment, you should not be inside this polygon; however, it is safe to touch the side of the polygon.There are Q scenarios (numbered from 1 to Q). In scenario j, you want to go from a starting point at (Aj,Bj) to an ending point at (Cj,Dj). You will be riding on a special spaceship that can only travel in a straight line. First, you set the direction of the spaceship, then the spaceship will start traveling in that direction. During the travel, you are only allowed to change direction at most once. Changing direction means you stop the spaceship, set a new direction, and then start traveling again in the new direction.For each scenario, determine the minimum distance required to travel without being inside of the zone at any moment, or report if it is impossible to reach the ending point." 2800
1906C "Cursed Game" interactive "You found an antique box in your warehouse and decided to open it. The moment you open the box, it traps you into a cursed game where you are playing against a demon. The game consists of 333 rounds and you have to win all rounds in order to escape. The demon also gives you 999 coins that you can use throughout all rounds.Note that in this problem, denote cell (r,c) of a grid as the cell in row r and column c of the grid.Before the start of each round, the demon will prepare a secret paper, which can be represented as a grid with 3 rows and 3 columns, both numbered from 1 to 3. The demon will secretly put a hole in one or more cells, and you are not aware which cells have a hole in it. Then, the round starts with the demon giving you an odd integer N (3\xe2\x89\xa4N\xe2\x89\xa433).Within each round, you can ask the demon several queries, each costing you one coin. For each query, you are allowed to give the demon your paper, which can be represented as a grid with N rows and N columns, both numbered from 1 to N. Each cell is coloured either black or white by you.For each of your query, the demon will calculate a binary result grid with N\xe2\x88\x922 rows and N\xe2\x88\x922 columns, both numbered from 1 to N\xe2\x88\x922. The value on cell (r,c) of the result grid is filled as follows.  The demon will put the secret paper on top of your paper such that the cell (r+i\xe2\x88\x921,c+j\xe2\x88\x921) of your paper aligns with the cell (i,j) of the secret paper, for 1\xe2\x89\xa4i,j\xe2\x89\xa43.  The demon can only see the colour of the cell in your paper if the corresponding cell in the secret paper has a hole in it.  The value on cell (r,c) of the result grid is 1 if there is an odd number of black cells that it can see through the holes, or 0 otherwise. You win the round if the result grid consists of only the values 1. Otherwise, the demon will give you the result grid as a feedback, and the round continues.If you have spent all the coins and still did not win all the rounds, then you will be trapped forever. Escape the cursed game!" 3000
1906B "Button Pressing" "bitmasks,constructive algorithms,hashing" "You are given N buttons (numbered from 1 to N) and N lamps (numbered from 1 to N). Each lamp can either be on or off. Initially, lamp i is on if Ai=1, and off if Ai=0.Button i is connected to lamp i\xe2\x88\x921 (if i>1) and lamp i+1 (if i<N). In one move, you can press a button i only if lamp i is on. When a button is pressed, the state of the lamps connected to this button is toggled. Formally, the lamps will be on if it was off previously, and the lamps will be off if it was on previously. Note that lamp i is not connected to button i, thus, the state of lamp i does not change if button i is pressed.After zero or more moves, you want lamp i to be on if Bi=1, and off if Bi=0. Determine if it is possible to achieve this task." 2600
1906A "Easy As ABC" "brute force" "You are playing a word puzzle. The puzzle starts with a 3 by 3 grid, where each cell contains either the letter A, B, or C.The goal of this puzzle is to find the lexicographically smallest possible word of length 3. The word can be formed by choosing three different cells where the cell containing the first letter is adjacent to the cell containing the second letter, and the cell containing the second letter is adjacent to the cell containing the third letter.Two cells are adjacent to each other if they share a border or a corner, as shown in the following illustration. Formally, if (r,c) denotes the cell in the r-th row and c-th column, then cell (r,c) is adjacent to cell (r,c+1), (r\xe2\x88\x921,c+1), (r\xe2\x88\x921,c), (r\xe2\x88\x921,c\xe2\x88\x921), (r,c\xe2\x88\x921), (r+1,c\xe2\x88\x921), (r+1,c), and (r+1,c+1).  Determine the lexicographically smallest possible word of length 3 that you can find within the grid.A string s of length n is lexicographically smaller than string t of the same length if there exists an integer 1\xe2\x89\xa4i\xe2\x89\xa4n such that sj=tj for all 1\xe2\x89\xa4j<i, and si<ti in alphabetical order. The following illustration shows some examples on some grids and their the lexicographically smallest possible word of length 3 that you can find within the grids." 1000
1905F "Field Should Not Be Empty" "brute force,data structures,divide and conquer" "You are given a permutation\xe2\x80\xa0 p of length n.We call index x good if for all y<x it holds that py<px and for all y>x it holds that py>px. We call f(p) the number of good indices in p. You can perform the following operation: pick 2 distinct indices i and j and swap elements pi and pj. Find the maximum value of f(p) after applying the aforementioned operation exactly once.\xe2\x80\xa0A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2600
1905E One-X "combinatorics,dfs and similar,dp,math,trees" "In this sad world full of imperfections, ugly segment trees exist.A segment tree is a tree where each node represents a segment and has its number. A segment tree for an array of n elements can be built in a recursive manner. Let\'s say function build(v,l,r) builds the segment tree rooted in the node with number v and it corresponds to the segment [l,r].Now let\'s define build(v,l,r):   If l=r, this node v is a leaf so we stop adding more edges  Else, we add the edges (v,2v) and (v,2v+1). Let m=\xe2\x8c\x8al+r2\xe2\x8c\x8b. Then we call build(2v,l,m) and build(2v+1,m+1,r). So, the whole tree is built by calling build(1,1,n).Now Ibti will construct a segment tree for an array with n elements. He wants to find the sum of lca\xe2\x80\xa0(S), where S is a non-empty subset of leaves. Notice that there are exactly 2n\xe2\x88\x921 possible subsets. Since this sum can be very large, output it modulo 998244353.\xe2\x80\xa0lca(S) is the number of the least common ancestor for the nodes that are in S." 2400
1905D "Cyclic MEX" "data structures,implementation,math,two pointers" "For an array a, define its cost as \xe2\x88\x91ni=1mex\xe2\x80\xa0([a1,a2,\xe2\x80\xa6,ai]).You are given a permutation\xe2\x80\xa1 p of the set {0,1,2,\xe2\x80\xa6,n\xe2\x88\x921}. Find the maximum cost across all cyclic shifts of p.\xe2\x80\xa0mex([b1,b2,\xe2\x80\xa6,bm]) is the smallest non-negative integer x such that x does not occur among b1,b2,\xe2\x80\xa6,bm.\xe2\x80\xa1A permutation of the set {0,1,2,...,n\xe2\x88\x921} is an array consisting of n distinct integers from 0 to n\xe2\x88\x921 in arbitrary order. For example, [1,2,0,4,3] is a permutation, but [0,1,1] is not a permutation (1 appears twice in the array), and [0,2,3] is also not a permutation (n=3 but there is 3 in the array)." 2000
1905C "Largest Subsequence" greedy,strings "Given is a string s of length n. In one operation you can select the lexicographically largest\xe2\x80\xa0 subsequence of string s and cyclic shift it to the right\xe2\x80\xa1. Your task is to calculate the minimum number of operations it would take for s to become sorted, or report that it never reaches a sorted state.\xe2\x80\xa0A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; In the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b.\xe2\x80\xa1By cyclic shifting the string t1t2\xe2\x80\xa6tm to the right, we get the string tmt1\xe2\x80\xa6tm\xe2\x88\x921." 1400
1905B "Begginer\'s Zelda" greedy,trees "You are given a tree\xe2\x80\xa0\xe2\x80\xa0. In one zelda-operation you can do follows: Choose two vertices of the tree uu and vv; Compress all the vertices on the path from uu to vv into one vertex. In other words, all the vertices on path from uu to vv will be erased from the tree, a new vertex ww will be created. Then every vertex ss that had an edge to some vertex on the path from uu to vv will have an edge to the vertex ww.  Illustration of a zelda-operation performed for vertices 11 and 55. Determine the minimum number of zelda-operations required for the tree to have only one vertex.\xe2\x80\xa0\xe2\x80\xa0A tree is a connected acyclic undirected graph." 1100
1905A "Constructive Problems" "constructive algorithms,math" "Gridlandia has been hit by flooding and now has to reconstruct all of it\'s cities. Gridlandia can be described by an n\xc3\x97m matrix.Initially, all of its cities are in economic collapse. The government can choose to rebuild certain cities. Additionally, any collapsed city which has at least one vertically neighboring rebuilt city and at least one horizontally neighboring rebuilt city can ask for aid from them and become rebuilt without help from the government. More formally, collapsed city positioned in (i,j) can become rebuilt if both of the following conditions are satisfied:  At least one of cities with positions (i+1,j) and (i\xe2\x88\x921,j) is rebuilt;  At least one of cities with positions (i,j+1) and (i,j\xe2\x88\x921) is rebuilt. If the city is located on the border of the matrix and has only one horizontally or vertically neighbouring city, then we consider only that city.   Illustration of two possible ways cities can be rebuilt by adjacent aid. White cells are collapsed cities, yellow cells are initially rebuilt cities (either by the government or adjacent aid), and orange cells are rebuilt cities after adjacent aid. The government wants to know the minimum number of cities it has to rebuild such that after some time all the cities can be rebuild." 800
1904F "Beautiful Tree" "data structures,dfs and similar,graphs,implementation,trees" "Lunchbox has a tree of size n rooted at node 1. Each node is then assigned a value. Lunchbox considers the tree to be beautiful if each value is distinct and ranges from 1 to n. In addition, a beautiful tree must also satisfy m requirements of 2 types:  ""1 a b c"" \xe2\x80\x94 The node with the smallest value on the path between nodes a and b must be located at c.  ""2 a b c"" \xe2\x80\x94 The node with the largest value on the path between nodes a and b must be located at c. Now, you must assign values to each node such that the resulting tree is beautiful. If it is impossible to do so, output \xe2\x88\x921." 2800
1904E "Tree Queries" "data structures,dfs and similar,graphs,implementation,trees" "Those who don\'t work don\'t eat. Get the things you want with your own power. But believe, the earnest and serious people are the ones who have the last laugh... But even then, I won\'t give you a present.\xe2\x80\x94Santa, Hayate no Gotoku!Since Hayate didn\'t get any Christmas presents from Santa, he is instead left solving a tree query problem.Hayate has a tree with n nodes.Hayate now wants you to answer q queries. Each query consists of a node x and k other additional nodes a1,a2,\xe2\x80\xa6,ak. These k+1 nodes are guaranteed to be all distinct.For each query, you must find the length of the longest simple path starting at node x\xe2\x80\xa0 after removing nodes a1,a2,\xe2\x80\xa6,ak along with all edges connected to at least one of nodes a1,a2,\xe2\x80\xa6,ak.\xe2\x80\xa0 A simple path of length k starting at node x is a sequence of distinct nodes x=u0,u1,\xe2\x80\xa6,uk such that there exists a edge between nodes ui\xe2\x88\x921 and ui for all 1\xe2\x89\xa4i\xe2\x89\xa4k." 2500
1904D2 "Set To Max (Hard Version)" "constructive algorithms,data structures,divide and conquer,greedy,implementation,sortings" "This is the hard version of the problem. The only differences between the two versions of this problem are the constraints on n and the time limit. You can make hacks only if all versions of the problem are solved.You are given two arrays a and b of length n.You can perform the following operation some (possibly zero) times:   choose l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n.  let x=max(al,al+1,\xe2\x80\xa6,ar).  for all l\xe2\x89\xa4i\xe2\x89\xa4r, set ai:=x. Determine if you can make array a equal to array b." 1800
1904D1 "Set To Max (Easy Version)" "brute force,constructive algorithms,greedy" "This is the easy version of the problem. The only differences between the two versions of this problem are the constraints on n and the time limit. You can make hacks only if all versions of the problem are solved.You are given two arrays a and b of length n.You can perform the following operation some (possibly zero) times:   choose l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n.  let x=max(al,al+1,\xe2\x80\xa6,ar).  for all l\xe2\x89\xa4i\xe2\x89\xa4r, set ai:=x. Determine if you can make array a equal to array b." 1600
1904C "Array Game" "binary search,brute force,data structures,sortings,two pointers" "You are given an array a of n positive integers. In one operation, you must pick some (i,j) such that 1\xe2\x89\xa4i<j\xe2\x89\xa4|a| and append |ai\xe2\x88\x92aj| to the end of the a (i.e. increase n by 1 and set an to |ai\xe2\x88\x92aj|). Your task is to minimize and print the minimum value of a after performing k operations." 1400
1904B "Collecting Game" "binary search,dp,greedy,sortings,two pointers" "You are given an array a of n positive integers and a score. If your score is greater than or equal to ai, then you can increase your score by ai and remove ai from the array. For each index i, output the maximum number of additional array elements that you can remove if you remove ai and then set your score to ai. Note that the removal of ai should not be counted in the answer." 1100
1904A Forked! "brute force,implementation" "Lunchbox is done with playing chess! His queen and king just got forked again!In chess, a fork is when a knight attacks two pieces of higher value, commonly the king and the queen. Lunchbox knows that knights can be tricky, and in the version of chess that he is playing, knights are even trickier: instead of moving 1 tile in one direction and 2 tiles in the other, knights in Lunchbox\'s modified game move a tiles in one direction and b tiles in the other.Lunchbox is playing chess on an infinite chessboard which contains all cells (x,y) where x and y are (possibly negative) integers. Lunchbox\'s king and queen are placed on cells (xK,yK) and (xQ,yQ) respectively. Find the number of positions such that if a knight was placed on that cell, it would attack both the king and queen." 900
1903F Babysitting "2-sat,binary search,data structures,graphs,trees" "Theofanis wants to play video games, however he should also take care of his sister. Since Theofanis is a CS major, he found a way to do both. He will install some cameras in his house in order to make sure his sister is okay.His house is an undirected graph with n nodes and m edges. His sister likes to play at the edges of the graph, so he has to install a camera to at least one endpoint of every edge of the graph. Theofanis wants to find a vertex cover that maximizes the minimum difference between indices of the chosen nodes.More formally, let a1,a2,\xe2\x80\xa6,ak be a vertex cover of the graph. Let the minimum difference between indices of the chosen nodes be the minimum |ai\xe2\x88\x92aj| (where i\xe2\x89\xa0j) out of the nodes that you chose. If k=1 then we assume that the minimum difference between indices of the chosen nodes is n. Can you find the maximum possible minimum difference between indices of the chosen nodes over all vertex covers?" 2500
1903E "Geo Game" greedy,interactive,math "This is an interactive problem.Theofanis and his sister are playing the following game. They have n points in a 2D plane and a starting point (sx,sy). Each player (starting from the first player) chooses one of the n points that wasn\'t chosen before and adds to the sum (which is initially 0) the square of the Euclidean distance from the previous point (which is either the starting point or it was chosen by the other person) to the new point (that the current player selected).The game ends after exactly n moves (after all the points are chosen). The first player wins if the sum is even in the end. Otherwise, the second player wins.Theofanis is a very competitive person and he hates losing. Thus, he wants to choose whether he should play first or second. Can you show him, which player to choose, and how he should play to beat his sister?" 2000
1903D2 "Maximum And Queries (hard version)" "bitmasks,divide and conquer,dp,greedy" "This is the hard version of the problem. The only difference between the two versions is the constraint on n and q, the memory and time limits. You can make hacks only if all versions of the problem are solved.Theofanis really likes to play with the bits of numbers. He has an array a of size n and an integer k. He can make at most k operations in the array. In each operation, he picks a single element and increases it by 1.He found the maximum bitwise AND that array a can have after at most k operations.Theofanis has put a lot of work into finding this value and was very happy with his result. Unfortunately, Ada\xc5\x9b, being the evil person that he is, decided to bully him by repeatedly changing the value of k.Help Theofanis by calculating the maximum possible bitwise AND for q different values of k. Note that queries are independent." 2500
1903D1 "Maximum And Queries (easy version)" "binary search,bitmasks,brute force,greedy" "This is the easy version of the problem. The only difference between the two versions is the constraint on n and q, the memory and time limits. You can make hacks only if all versions of the problem are solved.Theofanis really likes to play with the bits of numbers. He has an array a of size n and an integer k. He can make at most k operations in the array. In each operation, he picks a single element and increases it by 1.He found the maximum bitwise AND that array a can have after at most k operations.Theofanis has put a lot of work into finding this value and was very happy with his result. Unfortunately, Ada\xc5\x9b, being the evil person that he is, decided to bully him by repeatedly changing the value of k.Help Theofanis by calculating the maximum possible bitwise AND for q different values of k. Note that queries are independent." 1700
1903C "Theofanis\' Nightmare" "constructive algorithms,greedy" "Theofanis easily gets obsessed with problems before going to sleep and often has nightmares about them. To deal with his obsession he visited his doctor, Dr. Emix.In his latest nightmare, he has an array a of size n and wants to divide it into non-empty subarrays\xe2\x80\xa0 such that every element is in exactly one of the subarrays.For example, the array [1,\xe2\x88\x923,7,\xe2\x88\x926,2,5] can be divided to [1][\xe2\x88\x923,7][\xe2\x88\x926,2][5]. The Cypriot value of such division is equal to \xce\xa3ki=1i\xe2\x8b\x85sumi where k is the number of subarrays that we divided the array into and sumi is the sum of the i-th subarray.The Cypriot value of this division of the array [1][\xe2\x88\x923,7][\xe2\x88\x926,2][5]=1\xe2\x8b\x851+2\xe2\x8b\x85(\xe2\x88\x923+7)+3\xe2\x8b\x85(\xe2\x88\x926+2)+4\xe2\x8b\x855=17. Theofanis is wondering what is the maximum Cypriot value of any division of the array.\xe2\x80\xa0 An array b is a subarray of an array a if b can be obtained from a by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end. In particular, an array is a subarray of itself." 1400
1903B "StORage room" "bitmasks,brute force,constructive algorithms,greedy" "In Cyprus, the weather is pretty hot. Thus, Theofanis saw this as an opportunity to create an ice cream company. He keeps the ice cream safe from other ice cream producers by locking it inside big storage rooms. However, he forgot the password. Luckily, the lock has a special feature for forgetful people! It gives you a table M with n rows and n columns of non-negative integers, and to open the lock, you need to find an array a of n elements such that:  0\xe2\x89\xa4ai<230, and  Mi,j=ai|aj for all i\xe2\x89\xa0j, where | denotes the bitwise OR operation. The lock has a bug, and sometimes it gives tables without any solutions. In that case, the ice cream will remain frozen for the rest of eternity.Can you find an array to open the lock?" 1200
1903A "Halloumi Boxes" "brute force,greedy,sortings" "Theofanis is busy after his last contest, as now, he has to deliver many halloumis all over the world. He stored them inside n boxes and each of which has some number ai written on it. He wants to sort them in non-decreasing order based on their number, however, his machine works in a strange way. It can only reverse any subarray\xe2\x80\xa0 of boxes with length at most k.Find if it\'s possible to sort the boxes using any number of reverses.\xe2\x80\xa0 Reversing a subarray means choosing two indices i and j (where 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n) and changing the array a1,a2,\xe2\x80\xa6,an to a1,a2,\xe2\x80\xa6,ai\xe2\x88\x921,aj,aj\xe2\x88\x921,\xe2\x80\xa6,ai,aj+1,\xe2\x80\xa6,an\xe2\x88\x921,an. The length of the subarray is then j\xe2\x88\x92i+1." 800
1902F "Trees and XOR Queries Again" "data structures,dfs and similar,divide and conquer,graphs,implementation,math,trees" "You are given a tree consisting of n vertices. There is an integer written on each vertex; the i-th vertex has integer ai written on it.You have to process q queries. The i-th query consists of three integers xi, yi and ki. For this query, you have to answer if it is possible to choose a set of vertices v1,v2,\xe2\x80\xa6,vm (possibly empty) such that:  every vertex vj is on the simple path between xi and yi (endpoints can be used as well);  av1\xe2\x8a\x95av2\xe2\x8a\x95\xe2\x8b\xaf\xe2\x8a\x95avm=ki, where \xe2\x8a\x95 denotes the bitwise XOR operator." 2400
1902E "Collapsing Strings" "data structures,strings,trees" "You are given n strings s1,s2,\xe2\x80\xa6,sn, consisting of lowercase Latin letters. Let |x| be the length of string x.Let a collapse C(a,b) of two strings a and b be the following operation:   if a is empty, C(a,b)=b;  if b is empty, C(a,b)=a;  if the last letter of a is equal to the first letter of b, then C(a,b)=C(a1,|a|\xe2\x88\x921,b2,|b|), where sl,r is the substring of s from the l-th letter to the r-th one;  otherwise, C(a,b)=a+b, i.\xe2\x80\x89e. the concatenation of two strings. Calculate n\xe2\x88\x91i=1n\xe2\x88\x91j=1|C(si,sj)|." 1900
1902D "Robot Queries" "binary search,data structures,dp,implementation" "There is an infinite 2-dimensional grid. Initially, a robot stands in the point (0,0). The robot can execute four commands:  U \xe2\x80\x94 move from point (x,y) to (x,y+1);  D \xe2\x80\x94 move from point (x,y) to (x,y\xe2\x88\x921);  L \xe2\x80\x94 move from point (x,y) to (x\xe2\x88\x921,y);  R \xe2\x80\x94 move from point (x,y) to (x+1,y). You are given a sequence of commands s of length n. Your task is to answer q independent queries: given four integers x, y, l and r; determine whether the robot visits the point (x,y), while executing a sequence s, but the substring from l to r is reversed (i.\xe2\x80\x89e. the robot performs commands in order s1s2s3\xe2\x80\xa6sl\xe2\x88\x921srsr\xe2\x88\x921sr\xe2\x88\x922\xe2\x80\xa6slsr+1sr+2\xe2\x80\xa6sn)." 1900
1902C "Insert and Equalize" "brute force,constructive algorithms,greedy,math,number theory" "You are given an integer array a1,a2,\xe2\x80\xa6,an, all its elements are distinct.First, you are asked to insert one more integer an+1 into this array. an+1 should not be equal to any of a1,a2,\xe2\x80\xa6,an.Then, you will have to make all elements of the array equal. At the start, you choose a positive integer x (x>0). In one operation, you add x to exactly one element of the array. Note that x is the same for all operations.What\'s the smallest number of operations it can take you to make all elements equal, after you choose an+1 and x?" 1300
1902B "Getting Points" "binary search,brute force,greedy" "Monocarp is a student at Berland State University. Due to recent changes in the Berland education system, Monocarp has to study only one subject \xe2\x80\x94 programming.The academic term consists of n days, and in order not to get expelled, Monocarp has to earn at least P points during those n days. There are two ways to earn points \xe2\x80\x94 completing practical tasks and attending lessons. For each practical task Monocarp fulfills, he earns t points, and for each lesson he attends, he earns l points.Practical tasks are unlocked ""each week"" as the term goes on: the first task is unlocked on day 1 (and can be completed on any day from 1 to n), the second task is unlocked on day 8 (and can be completed on any day from 8 to n), the third task is unlocked on day 15, and so on.Every day from 1 to n, there is a lesson which can be attended by Monocarp. And every day, Monocarp chooses whether to study or to rest the whole day. When Monocarp decides to study, he attends a lesson and can complete no more than 2 tasks, which are already unlocked and not completed yet. If Monocarp rests the whole day, he skips a lesson and ignores tasks.Monocarp wants to have as many days off as possible, i. e. he wants to maximize the number of days he rests. Help him calculate the maximum number of days he can rest!" 1100
1902A "Binary Imbalance" "constructive algorithms" "You are given a string s, consisting only of characters \'0\' and/or \'1\'.In one operation, you choose a position i from 1 to |s|\xe2\x88\x921, where |s| is the current length of string s. Then you insert a character between the i-th and the (i+1)-st characters of s. If si=si+1, you insert \'1\'. If si\xe2\x89\xa0si+1, you insert \'0\'.Is it possible to make the number of zeroes in the string strictly greater than the number of ones, using any number of operations (possibly, none)?" 800
1901F Landscaping "binary search,geometry,two pointers" "You are appointed to a very important task: you are in charge of flattening one specific road.The road can be represented as a polygonal line starting at (0,0), ending at (n\xe2\x88\x921,0) and consisting of n vertices (including starting and ending points). The coordinates of the i-th vertex of the polyline are (i,ai).""Flattening"" road is equivalent to choosing some line segment from (0,y0) to (n\xe2\x88\x921,y1) such that all points of the polyline are below the chosen segment (or on the same height). Values y0 and y1 may be real.You can imagine that the road has some dips and pits, and you start pouring pavement onto it until you make the road flat. Points 0 and n\xe2\x88\x921 have infinitely high walls, so pavement doesn\'t fall out of segment [0,n\xe2\x88\x921].  The cost of flattening the road is equal to the area between the chosen segment and the polyline. You want to minimize the cost, that\'s why the flattened road is not necessary horizontal.But there is a problem: your data may be too old, so you sent a person to measure new heights. The person goes from 0 to n\xe2\x88\x921 and sends you new heights bi of each vertex i of the polyline.Since measuring new heights may take a while, and you don\'t know when you\'ll be asked, calculate the minimum cost (and corresponding y0 and y1) to flatten the road after each new height bi you get." 2900
1901E "Compressed Tree" "dfs and similar,dp,graphs,greedy,sortings,trees" "You are given a tree consisting of n vertices. A number is written on each vertex; the number on vertex i is equal to ai.You can perform the following operation any number of times (possibly zero):   choose a vertex which has at most 1 incident edge and remove this vertex from the tree. Note that you can delete all vertices.After all operations are done, you\'re compressing the tree. The compression process is done as follows. While there is a vertex having exactly 2 incident edges in the tree, perform the following operation:   delete this vertex, connect its neighbors with an edge. It can be shown that if there are multiple ways to choose a vertex to delete during the compression process, the resulting tree is still the same.Your task is to calculate the maximum possible sum of numbers written on vertices after applying the aforementioned operation any number of times, and then compressing the tree." 2200
1901D "Yet Another Monster Fight" "binary search,dp,greedy,implementation,math" "Vasya is a sorcerer that fights monsters. Again. There are n monsters standing in a row, the amount of health points of the i-th monster is ai.Vasya is a very powerful sorcerer who knows many overpowered spells. In this fight, he decided to use a chain lightning spell to defeat all the monsters. Let\'s see how this spell works.Firstly, Vasya chooses an index i of some monster (1\xe2\x89\xa4i\xe2\x89\xa4n) and the initial power of the spell x. Then the spell hits monsters exactly n times, one hit per monster. The first target of the spell is always the monster i. For every target except for the first one, the chain lightning will choose a random monster who was not hit by the spell and is adjacent to one of the monsters that already was hit. So, each monster will be hit exactly once. The first monster hit by the spell receives x damage, the second monster receives (x\xe2\x88\x921) damage, the third receives (x\xe2\x88\x922) damage, and so on.Vasya wants to show how powerful he is, so he wants to kill all the monsters with a single chain lightning spell. The monster is considered dead if the damage he received is not less than the amount of its health points. On the other hand, Vasya wants to show he doesn\'t care that much, so he wants to choose the minimum initial power of the spell x such that it kills all monsters, no matter which monster (among those who can get hit) gets hit on each step.Of course, Vasya is a sorcerer, but the amount of calculations required to determine the optimal spell setup is way above his possibilities, so you have to help him find the minimum spell power required to kill all the monsters.Note that Vasya chooses the initial target and the power of the spell, other things should be considered random and Vasya wants to kill all the monsters even in the worst possible scenario." 1700
1901C "Add, Divide and Floor" "constructive algorithms,greedy,math" "You are given an integer array a1,a2,\xe2\x80\xa6,an (0\xe2\x89\xa4ai\xe2\x89\xa4109). In one operation, you can choose an integer x (0\xe2\x89\xa4x\xe2\x89\xa41018) and replace ai with \xe2\x8c\x8aai+x2\xe2\x8c\x8b (\xe2\x8c\x8ay\xe2\x8c\x8b denotes rounding y down to the nearest integer) for all i from 1 to n. Pay attention to the fact that all elements of the array are affected on each operation. Print the smallest number of operations required to make all elements of the array equal.If the number of operations is less than or equal to n, then print the chosen x for each operation. If there are multiple answers, print any of them." 1400
1901B "Chip and Ribbon" greedy,math "There is a ribbon divided into n cells, numbered from 1 to n from left to right. Initially, an integer 0 is written in each cell.Monocarp plays a game with a chip. The game consists of several turns. During the first turn, Monocarp places the chip in the 1-st cell of the ribbon. During each turn except for the first turn, Monocarp does exactly one of the two following actions:  move the chip to the next cell (i.\xe2\x80\x89e. if the chip is in the cell i, it is moved to the cell i+1). This action is impossible if the chip is in the last cell;  choose any cell x and teleport the chip into that cell. It is possible to choose the cell where the chip is currently located. At the end of each turn, the integer written in the cell with the chip is increased by 1.Monocarp\'s goal is to make some turns so that the 1-st cell contains the integer c1, the 2-nd cell contains the integer c2, ..., the n-th cell contains the integer cn. He wants to teleport the chip as few times as possible.Help Monocarp calculate the minimum number of times he has to teleport the chip." 1100
1901A "Line Trip" greedy,math "There is a road, which can be represented as a number line. You are located in the point 0 of the number line, and you want to travel from the point 0 to the point x, and back to the point 0.You travel by car, which spends 1 liter of gasoline per 1 unit of distance travelled. When you start at the point 0, your car is fully fueled (its gas tank contains the maximum possible amount of fuel).There are n gas stations, located in points a1,a2,\xe2\x80\xa6,an. When you arrive at a gas station, you fully refuel your car. Note that you can refuel only at gas stations, and there are no gas stations in points 0 and x.You have to calculate the minimum possible volume of the gas tank in your car (in liters) that will allow you to travel from the point 0 to the point x and back to the point 0." 800
1900F "Local Deletions" "binary search,data structures,implementation" "For an array b1,b2,\xe2\x80\xa6,bm, for some i (1<i<m), element bi is said to be a local minimum if bi<bi\xe2\x88\x921 and bi<bi+1. Element b1 is said to be a local minimum if b1<b2. Element bm is said to be a local minimum if bm<bm\xe2\x88\x921.For an array b1,b2,\xe2\x80\xa6,bm, for some i (1<i<m), element bi is said to be a local maximum if bi>bi\xe2\x88\x921 and bi>bi+1. Element b1 is said to be a local maximum if b1>b2. Element bm is said to be a local maximum if bm>bm\xe2\x88\x921.Let x be an array of distinct elements. We define two operations on it:  1 \xe2\x80\x94 delete all elements from x that are not local minima.  2 \xe2\x80\x94 delete all elements from x that are not local maxima. Define f(x) as follows. Repeat operations 1,2,1,2,\xe2\x80\xa6 in that order until you get only one element left in the array. Return that element.For example, take an array [1,3,2]. We will first do type 1 operation and get [1,2]. Then we will perform type 2 operation and get [2]. Therefore, f([1,3,2])=2.You are given a permutation\xe2\x80\xa0 a of size n and q queries. Each query consists of two integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. The query asks you to compute f([al,al+1,\xe2\x80\xa6,ar]). \xe2\x80\xa0 A permutation of length n is an array of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3, but there is 4 in the array)." 2800
1900E "Transitive Graph" "dfs and similar,dp,dsu,graphs,implementation" "You are given a directed graph G with n vertices and m edges between them.Initially, graph H is the same as graph G. Then you decided to perform the following actions:   If there exists a triple of vertices a, b, c of H, such that there is an edge from a to b and an edge from b to c, but there is no edge from a to c, add an edge from a to c.  Repeat the previous step as long as there are such triples. Note that the number of edges in H can be up to n2 after performing the actions.You also wrote some values on vertices of graph H. More precisely, vertex i has the value of ai written on it.Consider a simple path consisting of k distinct vertices with indexes v1,v2,\xe2\x80\xa6,vk. The length of such a path is k. The value of that path is defined as \xe2\x88\x91ki=1avi.A simple path is considered the longest if there is no other simple path in the graph with greater length.Among all the longest simple paths in H, find the one with the smallest value." 2100
1900D "Small GCD" "bitmasks,brute force,dp,math,number theory" "Let a, b, and c be integers. We define function f(a,b,c) as follows:Order the numbers a, b, c in such a way that a\xe2\x89\xa4b\xe2\x89\xa4c. Then return gcd(a,b), where gcd(a,b) denotes the greatest common divisor (GCD) of integers a and b.So basically, we take the gcd of the 2 smaller values and ignore the biggest one. You are given an array a of n elements. Compute the sum of f(ai,aj,ak) for each i, j, k, such that 1\xe2\x89\xa4i<j<k\xe2\x89\xa4n. More formally, compute n\xe2\x88\x91i=1n\xe2\x88\x91j=i+1n\xe2\x88\x91k=j+1f(ai,aj,ak)." 2000
1900C "Anji\'s Binary Tree" "dfs and similar,dp,trees" "Keksic keeps getting left on seen by Anji. Through a mutual friend, he\'s figured out that Anji really likes binary trees and decided to solve her problem in order to get her attention.Anji has given Keksic a binary tree with n vertices. Vertex 1 is the root and does not have a parent. All other vertices have exactly one parent. Each vertex can have up to 2 children, a left child, and a right child. For each vertex, Anji tells Keksic index of both its left and its right child or tells him that they do not exist. Additionally, each of the vertices has a letter si on it, which is either \'U\', \'L\' or \'R\'.Keksic begins his journey on the root, and in each move he does the following:   If the letter on his current vertex is \'U\', he moves to its parent. If it doesn\'t exist, he does nothing.  If the letter on his current vertex is \'L\', he moves to its left child. If it doesn\'t exist, he does nothing.  If the letter on his current vertex is \'R\', he moves to its right child. If it doesn\'t exist, he does nothing.  Before his journey, he can perform the following operations: choose any node, and replace the letter written on it with another one. You are interested in the minimal number of operations he needs to do before his journey, such that when he starts his journey, he will reach a leaf at some point. A leaf is a vertex that has no children. It does not matter which leaf he reaches. Note that it does not matter whether he will stay in the leaf, he just needs to move to it. Additionally, note that it does not matter how many times he needs to move before reaching a leaf.Help Keksic solve Anji\'s tree so that he can win her heart, and make her come to \xc4\x8ca\xc4\x8dak." 1300
1900B "Laura and Operations" dp,math "Laura is a girl who does not like combinatorics. Nemanja will try to convince her otherwise.Nemanja wrote some digits on the board. All of them are either 1, 2, or 3. The number of digits 1 is a. The number of digits 2 is b and the number of digits 3 is c. He told Laura that in one operation she can do the following:  Select two different digits and erase them from the board. After that, write the digit (1, 2, or 3) different from both erased digits. For example, let the digits be 1, 1, 1, 2, 3, 3. She can choose digits 1 and 3 and erase them. Then the board will look like this 1, 1, 2, 3. After that, she has to write another digit 2, so at the end of the operation, the board will look like 1, 1, 2, 3, 2.Nemanja asked her whether it was possible for only digits of one type to remain written on the board after some operations. If so, which digits can they be?Laura was unable to solve this problem and asked you for help. As an award for helping her, she will convince Nemanja to give you some points." 900
1900A "Cover in Water" "constructive algorithms,greedy,implementation,strings" "Filip has a row of cells, some of which are blocked, and some are empty. He wants all empty cells to have water in them. He has two actions at his disposal:  1 \xe2\x80\x94 place water in an empty cell.  2 \xe2\x80\x94 remove water from a cell and place it in any other empty cell. If at some moment cell i (2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) is empty and both cells i\xe2\x88\x921 and i+1 contains water, then it becomes filled with water.Find the minimum number of times he needs to perform action 1 in order to fill all empty cells with water. Note that you don\'t need to minimize the use of action 2. Note that blocked cells neither contain water nor can Filip place water in them." 800
1899G "Unusual Entertainment" "data structures,dfs and similar,dsu,shortest paths,sortings,trees,two pointers" "A tree is a connected graph without cycles.A permutation is an array consisting of n distinct integers from 1 to n in any order. For example, [5,1,3,2,4] is a permutation, but [2,1,1] is not a permutation (as 1 appears twice in the array) and [1,3,2,5] is also not a permutation (as n=4, but 5 is present in the array).After a failed shoot in the BrMeast video, Alex fell into depression. Even his birthday did not make him happy. However, after receiving a gift from Timofey, Alex\'s mood suddenly improved. Now he spent days playing with the gifted constructor. Recently, he came up with an unusual entertainment.Alex builds a tree from his constructor, consisting of n vertices numbered from 1 to n, with the root at vertex 1. Then he writes down each integer from 1 to n in some order, obtaining a permutation p. After that, Alex comes up with q triples of integers l,r,x. For each triple, he tries to determine if there is at least one descendant of vertex x among the vertices pl,pl+1,\xe2\x80\xa6,pr.A vertex u is a descendant of vertex v if and only if dist(1,v)+dist(v,u)=dist(1,u), where dist(a,b) is the distance between vertices a and b. In other words, vertex v must be on the path from the root to vertex u.Alex told Zakhar about this entertainment. Now Alex tells his friend q triples as described above, hoping that Zakhar can check for the presence of a descendant. Zakhar is very sleepy, so he turned to you for help. Help Zakhar answer all of Alex\'s questions and finally go to sleep." 1900
1899F "Alex\'s whims" "constructive algorithms,graphs,greedy,shortest paths,trees" "Tree is a connected graph without cycles. It can be shown that any tree of nn vertices has exactly n\xe2\x88\x921n\xe2\x88\x921 edges.Leaf is a vertex in the tree with exactly one edge connected to it.Distance between two vertices uu and vv in a tree is the minimum number of edges that must be passed to come from vertex uu to vertex vv.Alex\'s birthday is coming up, and Timofey would like to gift him a tree of nn vertices. However, Alex is a very moody boy. Every day for qq days, he will choose an integer, denoted by the integer chosen on the ii-th day by didi. If on the ii-th day there are not two leaves in the tree at a distance exactly didi, Alex will be disappointed.Timofey decides to gift Alex a designer so that he can change his tree as he wants. Timofey knows that Alex is also lazy (a disaster, not a human being), so at the beginning of every day, he can perform no more than one operation of the following kind: Choose vertices uu, v1v1, and v2v2 such that there is an edge between uu and v1v1 and no edge between uu and v2v2. Then remove the edge between uu and v1v1 and add an edge between uu and v2v2. This operation cannot be performed if the graph is no longer a tree after it.Somehow Timofey managed to find out all the didi. After that, he had another brilliant idea \xe2\x80\x94 just in case, make an instruction manual for the set, one that Alex wouldn\'t be disappointed.Timofey is not as lazy as Alex, but when he saw the integer nn, he quickly lost the desire to develop the instruction and the original tree, so he assigned this task to you. It can be shown that a tree and a sequence of operations satisfying the described conditions always exist.Here is an example of an operation where vertices were selected: uu \xe2\x80\x94 66, v1v1 \xe2\x80\x94 11, v2v2 \xe2\x80\x94 44." 1600
1899E "Queue Sort" greedy,implementation,sortings "Vlad found an array a of n integers and decided to sort it in non-decreasing order.To do this, Vlad can apply the following operation any number of times:  Extract the first element of the array and insert it at the end;  Swap that element with the previous one until it becomes the first or until it becomes strictly greater than the previous one. Note that both actions are part of the operation, and for one operation, you must apply both actions.For example, if you apply the operation to the array [4,3,1,2,6,4], it will change as follows: [4,3,1,2,6,4]; [3,1,2,6,4,4]; [3,1,2,6,4,4]; [3,1,2,4,6,4].Vlad doesn\'t have time to perform all the operations, so he asks you to determine the minimum number of operations required to sort the array or report that it is impossible." 1300
1899D "Yarik and Musical Notes" "hashing,math,number theory" "Yarik is a big fan of many kinds of music. But Yarik loves not only listening to music but also writing it. He likes electronic music most of all, so he has created his own system of music notes, which, in his opinion, is best for it.Since Yarik also likes informatics, in his system notes are denoted by integers of 2k, where k\xe2\x89\xa51 \xe2\x80\x94 a positive integer. But, as you know, you can\'t use just notes to write music, so Yarik uses combinations of two notes. The combination of two notes (a,b), where a=2k and b=2l, he denotes by the integer ab.For example, if a=8=23, b=4=22, then the combination (a,b) is denoted by the integer ab=84=4096. Note that different combinations can have the same notation, e.g., the combination (64,2) is also denoted by the integer 4096=642.Yarik has already chosen n notes that he wants to use in his new melody. However, since their integers can be very large, he has written them down as an array a of length n, then the note i is bi=2ai. The integers in array a can be repeated.The melody will consist of several combinations of two notes. Yarik was wondering how many pairs of notes bi,bj (i<j) exist such that the combination (bi,bj) is equal to the combination (bj,bi). In other words, he wants to count the number of pairs (i,j) (i<j) such that bbji=bbij. Help him find the number of such pairs." 1300
1899C "Yarik and Array" "dp,greedy,two pointers" "A subarray is a continuous part of array.Yarik recently found an array a of n elements and became very interested in finding the maximum sum of a non empty subarray. However, Yarik doesn\'t like consecutive integers with the same parity, so the subarray he chooses must have alternating parities for adjacent elements.For example, [1,2,3] is acceptable, but [1,2,4] is not, as 2 and 4 are both even and adjacent.You need to help Yarik by finding the maximum sum of such a subarray." 1100
1899B "250 Thousand Tons of TNT" "brute force,implementation,number theory" "Alex is participating in the filming of another video of BrMeast, and BrMeast asked Alex to prepare 250 thousand tons of TNT, but Alex didn\'t hear him well, so he prepared n boxes and arranged them in a row waiting for trucks. The i-th box from the left weighs ai tons.All trucks that Alex is going to use hold the same number of boxes, denoted by k. Loading happens the following way:  The first k boxes goes to the first truck,  The second k boxes goes to the second truck,  \xe2\x8b\xaf  The last k boxes goes to the nk-th truck. Upon loading is completed, each truck must have exactly k boxes. In other words, if at some point it is not possible to load exactly k boxes into the truck, then the loading option with that k is not possible.Alex hates justice, so he wants the maximum absolute difference between the total weights of two trucks to be as great as possible. If there is only one truck, this value is 0.Alex has quite a lot of connections, so for every 1\xe2\x89\xa4k\xe2\x89\xa4n, he can find a company such that each of its trucks can hold exactly k boxes. Print the maximum absolute difference between the total weights of any two trucks." 1100
1899A "Game with Integers" "games,math,number theory" "Vanya and Vova are playing a game. Players are given an integer n. On their turn, the player can add 1 to the current integer or subtract 1. The players take turns; Vanya starts. If after Vanya\'s move the integer is divisible by 3, then he wins. If 10 moves have passed and Vanya has not won, then Vova wins.Write a program that, based on the integer n, determines who will win if both players play optimally." 800
1898F "Vova Escapes the Matrix" "brute force,dfs and similar,divide and conquer,shortest paths" "Following a world tour, Vova got himself trapped inside an n\xc3\x97m matrix. Rows of this matrix are numbered by integers from 1 to n from top to bottom, and the columns are numbered by integers from 1 to m from left to right. The cell (i,j) is the cell on the intersection of row i and column j for 1\xe2\x89\xa4i\xe2\x89\xa4n and 1\xe2\x89\xa4j\xe2\x89\xa4m.Some cells of this matrix are blocked by obstacles, while all other cells are empty. Vova occupies one of the empty cells. It is guaranteed that cells (1,1), (1,m), (n,1), (n,m) (that is, corners of the matrix) are blocked.Vova can move from one empty cell to another empty cell if they share a side. Vova can escape the matrix from any empty cell on the boundary of the matrix; these cells are called exits.Vova defines the type of the matrix based on the number of exits he can use to escape the matrix:   The 1-st type: matrices with no exits he can use to escape.  The 2-nd type: matrices with exactly one exit he can use to escape.  The 3-rd type: matrices with multiple (two or more) exits he can use to escape. Before Vova starts moving, Misha can create more obstacles to block more cells. However, he cannot change the type of the matrix. What is the maximum number of cells Misha can block, so that the type of the matrix remains the same? Misha cannot block the cell Vova is currently standing on." 2600
1898E "Sofia and Strings" "data structures,greedy,sortings,strings,two pointers" "Sofia has a string s of length n, consisting only of lowercase English letters. She can perform operations of the following types with this string.  Select an index 1\xe2\x89\xa4i\xe2\x89\xa4|s| and remove the character si from the string.  Select a pair of indices (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|s|) and sort the substring slsl+1\xe2\x80\xa6sr in alphabetical order.  Here, |s| denotes the current length of s. In particular, |s|=n before the first operation. For example, if s=sofia, then performing the operation of the first type with i=4 results in s becoming sofa, and performing the operation of the second type with (l,r)=(2,4) after that results in s becoming safo.Sofia wants to obtain the string t of length m after performing zero or more operations on string s as described above. Please determine whether it is possible or not." 2200
1898D "Absolute Beauty" greedy,math "Kirill has two integer arrays a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn of length n. He defines the absolute beauty of the array b as n\xe2\x88\x91i=1|ai\xe2\x88\x92bi|. Here, |x| denotes the absolute value of x.Kirill can perform the following operation at most once:   select two indices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) and swap the values of bi and bj. Help him find the maximum possible absolute beauty of the array b after performing at most one swap." 1900
1898C "Colorful Grid" "constructive algorithms" "Elena has a grid formed by n horizontal lines and m vertical lines. The horizontal lines are numbered by integers from 1 to n from top to bottom. The vertical lines are numbered by integers from 1 to m from left to right. For each x and y (1\xe2\x89\xa4x\xe2\x89\xa4n, 1\xe2\x89\xa4y\xe2\x89\xa4m), the notation (x,y) denotes the point at the intersection of the x-th horizontal line and y-th vertical line.Two points (x1,y1) and (x2,y2) are adjacent if and only if |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|=1.  The grid formed by n=4 horizontal lines and m=5 vertical lines. Elena calls a sequence of points p1,p2,\xe2\x80\xa6,pg of length g a walk if and only if all the following conditions hold:   The first point p1 in this sequence is (1,1).  The last point pg in this sequence is (n,m).  For each 1\xe2\x89\xa4i<g, the points pi and pi+1 are adjacent. Note that the walk may contain the same point more than once. In particular, it may contain point (1,1) or (n,m) multiple times.There are n(m\xe2\x88\x921)+(n\xe2\x88\x921)m segments connecting the adjacent points in Elena\'s grid. Elena wants to color each of these segments in blue or red color so that there exists a walk p1,p2,\xe2\x80\xa6,pk+1 of length k+1 such that   out of k segments connecting two consecutive points in this walk, no two consecutive segments have the same color (in other words, for each 1\xe2\x89\xa4i<k, the color of the segment between points pi and pi+1 differs from the color of the segment between points pi+1 and pi+2). Please find any such coloring or report that there is no such coloring." 1700
1898B "Milena and Admirer" greedy,math "Milena has received an array of integers a1,a2,\xe2\x80\xa6,an of length n from a secret admirer. She thinks that making it non-decreasing should help her identify the secret admirer.She can use the following operation to make this array non-decreasing:  Select an element ai of array a and an integer x such that 1\xe2\x89\xa4x<ai. Then, replace ai by two elements x and ai\xe2\x88\x92x in array a. New elements (x and ai\xe2\x88\x92x) are placed in the array a in this order instead of ai.More formally, let a1,a2,\xe2\x80\xa6,ai,\xe2\x80\xa6,ak be an array a before the operation. After the operation, it becomes equal to a1,a2,\xe2\x80\xa6,ai\xe2\x88\x921,x,ai\xe2\x88\x92x,ai+1,\xe2\x80\xa6,ak. Note that the length of a increases by 1 on each operation. Milena can perform this operation multiple times (possibly zero). She wants you to determine the minimum number of times she should perform this operation to make array a non-decreasing.An array x1,x2,\xe2\x80\xa6,xk of length k is called non-decreasing if xi\xe2\x89\xa4xi+1 for all 1\xe2\x89\xa4i<k." 1500
1898A "Milica and String" "brute force,implementation,strings" "Milica has a string s of length n, consisting only of characters A and B. She wants to modify s so it contains exactly k instances of B. In one operation, she can do the following:  Select an integer i (1\xe2\x89\xa4i\xe2\x89\xa4n) and a character c (c is equal to either A or B).  Then, replace each of the first i characters of string s (that is, characters s1,s2,\xe2\x80\xa6,si) with c. Milica does not want to perform too many operations in order not to waste too much time on them.She asks you to find the minimum number of operations required to modify s so it contains exactly k instances of B. She also wants you to find these operations (that is, integer i and character c selected in each operation)." 800
1896H2 "Cyclic Hamming (Hard Version)" "brute force,dp,fft,math,number theory" "This is the hard version of the problem. The only difference between the two versions is the constraint on k. You can make hacks only if all versions of the problem are solved.In this statement, all strings are 0-indexed.For two strings a, b of the same length p, we define the following definitions:  The hamming distance between a and b, denoted as h(a,b), is defined as the number of positions i such that 0\xe2\x89\xa4i<p and ai\xe2\x89\xa0bi.  b is a cyclic shift of a if there exists some 0\xe2\x89\xa4k<p such that b(i+k)modp=ai for all 0\xe2\x89\xa4i<p. Here xmody denotes the remainder from dividing x by y. You are given two binary strings s and t of length 2k+1 each. Both strings may contain missing characters (denoted by the character \'?\'). Your task is to count the number of ways to replace the missing characters in both strings with the characters \'0\' or \'1\' such that:   Each string s and t contains exactly 2k occurrences of each character \'0\' and \'1\'  h(s,c)\xe2\x89\xa52k for all strings c that is a cyclic shift of t. As the result can be very large, you should print the value modulo 998244353." 3500
1896H1 "Cyclic Hamming (Easy Version)" "brute force,divide and conquer,dp,fft,math,number theory" "This is the easy version of the problem. The only difference between the two versions is the constraint on k. You can make hacks only if all versions of the problem are solved.In this statement, all strings are 0-indexed.For two strings a, b of the same length p, we define the following definitions:  The hamming distance between a and b, denoted as h(a,b), is defined as the number of positions i such that 0\xe2\x89\xa4i<p and ai\xe2\x89\xa0bi.  b is a cyclic shift of a if there exists some 0\xe2\x89\xa4k<p such that b(i+k)modp=ai for all 0\xe2\x89\xa4i<p. Here xmody denotes the remainder from dividing x by y. You are given two binary strings s and t of length 2k+1 each. Both strings may contain missing characters (denoted by the character \'?\'). Your task is to count the number of ways to replace the missing characters in both strings with the characters \'0\' or \'1\' such that:   Each string s and t contains exactly 2k occurrences of each character \'0\' and \'1\'  h(s,c)\xe2\x89\xa52k for all strings c that is a cyclic shift of t. As the result can be very large, you should print the value modulo 998244353." 3400
1896G "Pepe Racing" "constructive algorithms,implementation,interactive,sortings" "This is an interactive problem.There are n2 pepes labeled 1,2,\xe2\x80\xa6,n2 with pairwise distinct speeds. You would like to set up some races to find out the relative speed of these pepes.In one race, you can choose exactly n distinct pepes and make them race against each other. After each race, you will only know the fastest pepe of these n pepes.Can you order the n2\xe2\x88\x92n+1 fastest pepes in at most 2n2\xe2\x88\x922n+1 races? Note that the slowest n\xe2\x88\x921 pepes are indistinguishable from each other.Note that the interactor is adaptive. That is, the relative speeds of the pepes are not fixed in the beginning and may depend on your queries. But it is guaranteed that at any moment there is at least one initial configuration of pepes such that all the answers to the queries are consistent." 3200
1896F "Bracket Xoring" "constructive algorithms,greedy,implementation,math" "You are given a binary string s of length 2n where each element is 0 or 1. You can do the following operation: Choose a balanced bracket sequence\xe2\x80\xa0 b of length 2n.  For every index i from 1 to 2n in order, where bi is an open bracket, let pi denote the minimum index such that b[i,pi] is a balanced bracket sequence. Then, we perform a range toggle operation\xe2\x80\xa1 from i to pi on s. Note that since a balanced bracket sequence of length 2n will have n open brackets, we will do n range toggle operations on s. Your task is to find a sequence of no more than 10 operations that changes all elements of s to 0, or determine that it is impossible to do so. Note that you do not have to minimize the number of operations.Under the given constraints, it can be proven that if it is possible to change all elements of s to 0, there exists a way that requires no more than 10 operations.\xe2\x80\xa0 A sequence of brackets is called balanced if one can turn it into a valid math expression by adding characters + and 1. For example, sequences ""(())()"", ""()"", and ""(()(()))"" are balanced, while "")("", ""(()"", and ""(()))("" are not.\xe2\x80\xa1 If we perform a range toggle operation from l to r on a binary string s, then we toggle all values of si such that l\xe2\x89\xa4i\xe2\x89\xa4r. If si is toggled, we will set si:=0 if si=1 or vice versa. For example, if s=1000101 and we perform a range toggle operation from 3 to 5, s will be changed to s=1011001." 2600
1896E "Permutation Sorting" "data structures,sortings" "You are given a permutation\xe2\x80\xa0 a of size n. We call an index i good if ai=i is satisfied. After each second, we rotate all indices that are not good to the right by one position. Formally,  Let s1,s2,\xe2\x80\xa6,sk be the indices of a that are not good in increasing order. That is, sj<sj+1 and if index i is not good, then there exists j such that sj=i.  For each i from 1 to k, we assign as(i%k+1):=asi all at once. For each i from 1 to n, find the first time that index i becomes good. \xe2\x80\xa0 A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2100
1896D "Ones and Twos" "binary search,data structures,divide and conquer,math,two pointers" "You are given a 1-indexed array a of length n where each element is 1 or 2.Process q queries of the following two types:   ""1 s"": check if there exists a subarray\xe2\x80\xa0 of a whose sum equals to s.  ""2 i v"": change ai to v. \xe2\x80\xa0 An array b is a subarray of an array a if b can be obtained from a by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end. In particular, an array is a subarray of itself." 1700
1896C "Matching Arrays" "binary search,constructive algorithms,greedy,sortings" "You are given two arrays a and b of size n. The beauty of the arrays a and b is the number of indices i such that ai>bi.You are also given an integer x. Determine whether it is possible to rearrange the elements of b such that the beauty of the arrays becomes x. If it is possible, output one valid rearrangement of b." 1400
1896B "AB Flipping" "greedy,strings,two pointers" "You are given a string s of length n consisting of characters A and B. You are allowed to do the following operation:  Choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 such that si=A and si+1=B. Then, swap si and si+1. You are only allowed to do the operation at most once for each index 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. However, you can do it in any order you want. Find the maximum number of operations that you can carry out." 900
1896A "Jagged Swaps" sortings "You are given a permutation\xe2\x80\xa0 a of size n. You can do the following operation   Select an index i from 2 to n\xe2\x88\x921 such that ai\xe2\x88\x921<ai and ai>ai+1. Swap ai and ai+1. Determine whether it is possible to sort the permutation after a finite number of operations.\xe2\x80\xa0 A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 800
1895G "Two Characters, Two Colors" "binary search,data structures,dp,flows,greedy" "You are given a string consisting of characters 0 and/or 1. You have to paint every character of this string into one of two colors, red or blue.If you paint the i-th character red, you get ri coins. If you paint it blue, you get bi coins.After coloring the string, you remove every blue character from it, and count the number of inversions in the resulting string (i.\xe2\x80\x89e. the number of pairs of characters such that the left character in the pair is 1, and the right character in the pair is 0). For each inversion, you have to pay 1 coin.What is the maximum number of coins you can earn?" 3100
1895F "Fancy Arrays" combinatorics,dp,math,matrices "Let\'s call an array a of n non-negative integers fancy if the following conditions hold:   at least one from the numbers x, x+1, ..., x+k\xe2\x88\x921 appears in the array;  consecutive elements of the array differ by at most k (i.e. |ai\xe2\x88\x92ai\xe2\x88\x921|\xe2\x89\xa4k for each i\xe2\x88\x88[2,n]). You are given n, x and k. Your task is to calculate the number of fancy arrays of length n. Since the answer can be large, print it modulo 109+7." 2600
1895E "Infinite Card Game" "binary search,brute force,data structures,dfs and similar,dp,dsu,games,graphs,greedy,sortings,two pointers" "Monocarp and Bicarp are playing a card game. Each card has two parameters: an attack value and a defence value. A card s beats another card t if the attack of s is strictly greater than the defence of t.Monocarp has n cards, the i-th of them has an attack value of axi and a defence value of ayi. Bicarp has m cards, the j-th of them has an attack value of bxj and a defence value of byj.On the first move, Monocarp chooses one of his cards and plays it. Bicarp has to respond with his own card that beats that card. After that, Monocarp has to respond with a card that beats Bicarp\'s card. After that, it\'s Bicarp\'s turn, and so forth.After a card is beaten, it returns to the hand of the player who played it. It implies that each player always has the same set of cards to play as at the start of the game. The game ends when the current player has no cards that beat the card which their opponent just played, and the current player loses.If the game lasts for 100500 moves, it\'s declared a draw.Both Monocarp and Bicarp play optimally. That is, if a player has a winning strategy regardless of his opponent\'s moves, he plays for a win. Otherwise, if he has a drawing strategy, he plays for a draw.You are asked to calculate three values:   the number of Monocarp\'s starting moves that result in a win for Monocarp;  the number of Monocarp\'s starting moves that result in a draw;  the number of Monocarp\'s starting moves that result in a win for Bicarp." 2300
1895D "XOR Construction" "bitmasks,constructive algorithms,data structures,math,string suffix structures,trees" "You are given n\xe2\x88\x921 integers a1,a2,\xe2\x80\xa6,an\xe2\x88\x921.Your task is to construct an array b1,b2,\xe2\x80\xa6,bn such that:  every integer from 0 to n\xe2\x88\x921 appears in b exactly once;  for every i from 1 to n\xe2\x88\x921, bi\xe2\x8a\x95bi+1=ai (where \xe2\x8a\x95 denotes the bitwise XOR operator)." 1900
1895C "Torn Lucky Ticket" "brute force,dp,hashing,implementation,math" "A ticket is a non-empty string of digits from 1 to 9.A lucky ticket is such a ticket that:   it has an even length;  the sum of digits in the first half is equal to the sum of digits in the second half. You are given n ticket pieces s1,s2,\xe2\x80\xa6,sn. How many pairs (i,j) (for 1\xe2\x89\xa4i,j\xe2\x89\xa4n) are there such that si+sj is a lucky ticket? Note that it\'s possible that i=j.Here, the + operator denotes the concatenation of the two strings. For example, if si is 13, and sj is 37, then si+sj is 1337." 1400
1895B "Points and Minimum Distance" greedy,math,sortings "You are given a sequence of integers a of length 2n. You have to split these 2n integers into n pairs; each pair will represent the coordinates of a point on a plane. Each number from the sequence a should become the x or y coordinate of exactly one point. Note that some points can be equal.After the points are formed, you have to choose a path s that starts from one of these points, ends at one of these points, and visits all n points at least once.The length of path s is the sum of distances between all adjacent points on the path. In this problem, the distance between two points (x1,y1) and (x2,y2) is defined as |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|.Your task is to form n points and choose a path s in such a way that the length of path s is minimized." 800
1895A "Treasure Chest" math "Monocarp has found a treasure map. The map represents the treasure location as an OX axis. Monocarp is at 0, the treasure chest is at x, the key to the chest is at y.Obviously, Monocarp wants to open the chest. He can perform the following actions:   go 1 to the left or 1 to the right (spending 1 second);  pick the key or the chest up if he is in the same point as that object (spending 0 seconds);  put the chest down in his current point (spending 0 seconds);  open the chest if he\'s in the same point as the chest and has picked the key up (spending 0 seconds). Monocarp can carry the chest, but the chest is pretty heavy. He knows that he can carry it for at most k seconds in total (putting it down and picking it back up doesn\'t reset his stamina).What\'s the smallest time required for Monocarp to open the chest?" 800
1894B "Two Out of Three" "constructive algorithms" "You are given an array a1,a2,\xe2\x80\xa6,an. You need to find an array b1,b2,\xe2\x80\xa6,bn consisting of numbers 1, 2, 3 such that exactly two out of the following three conditions are satisfied: There exist indices 1\xe2\x89\xa4i,j\xe2\x89\xa4n such that ai=aj, bi=1, bj=2. There exist indices 1\xe2\x89\xa4i,j\xe2\x89\xa4n such that ai=aj, bi=1, bj=3. There exist indices 1\xe2\x89\xa4i,j\xe2\x89\xa4n such that ai=aj, bi=2, bj=3.If such an array does not exist, you should report it." 1000
1894A "Secret Sport" implementation,strings "Let\'s consider a game in which two players, A and B, participate. This game is characterized by two positive integers, X and Y.The game consists of sets, and each set consists of plays. In each play, exactly one of the players, either A or B, wins. A set ends exactly when one of the players reaches X wins in the plays of that set. This player is declared the winner of the set. The players play sets until one of them reaches Y wins in the sets. After that, the game ends, and this player is declared the winner of the entire game.You have just watched a game but didn\'t notice who was declared the winner. You remember that during the game, n plays were played, and you know which player won each play. However, you do not know the values of X and Y. Based on the available information, determine who won the entire game \xe2\x80\x94 A or B. If there is not enough information to determine the winner, you should also report it." 800
1893E "Cacti Symphony" "combinatorics,dfs and similar,dp,graphs" "You are given an undirected connected graph in which any two distinct simple cycles do not have common vertices. Since the graph can be very large, it is given to you in a compressed form: for each edge, you are also given a number d, which indicates that there are d additional vertices on this edge.You need to assign a weight to each vertex and each edge of the graph \xe2\x80\x94 an integer from 1 to 3.An edge of the graph is called good if the bitwise XOR of the weights of its adjacent vertices is not equal to 0 and not equal to the weight of that edge.Similarly, a vertex of the graph is called good if the bitwise XOR of the weights of its adjacent edges is not equal to 0 and not equal to the weight of that vertex.You need to determine how many ways there are to assign weights to the vertices and edges of the graph so that all vertices and edges are good. Since the answer can be quite large, you need to calculate the remainder of the answer divided by 998244353." 3500
1893D "Colorful Constructive" "constructive algorithms,data structures,greedy" "You have n colored cubes, the i-th cube has color ai.You need to distribute all the cubes on shelves. There are a total of m shelves, the i-th shelf can hold si cubes. Also, s1+s2+\xe2\x80\xa6+sm=n.Suppose on a shelf of size k there are cubes of colors c1,c2,\xe2\x80\xa6,ck, in this order. Then we define the colorfulness of the shelf as the minimum distance between two different cubes of the same color on the shelf. If all the cubes on the shelf have different colors, then the colorfulness is considered to be equal to the size of the shelf, that is, the number k.More formally, the colorfulness of c1,c2,\xe2\x80\xa6,ck is defined as follows: If all the colors c1,c2,\xe2\x80\xa6,ck are different, the colorfulness is considered to be k. Otherwise, the colorfulness is considered to be the smallest integer x\xe2\x89\xa51 such that there exists an index i (1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x92x) such that ci=ci+x.For each shelf, you are given the minimum required colorfulness, that is, you are given numbers d1,d2,\xe2\x80\xa6,dm, which mean that shelf i must have a colorfulness \xe2\x89\xa5di for all i.Distribute the available cubes among the shelves to ensure the required colorfulness, or report that it is impossible." 2600
1893C "Freedom of Choice" "brute force,greedy,implementation" "Let\'s define the anti-beauty of a multiset {b1,b2,\xe2\x80\xa6,blen} as the number of occurrences of the number len in the multiset.You are given m multisets, where the i-th multiset contains ni distinct elements, specifically: ci,1 copies of the number ai,1, ci,2 copies of the number ai,2,\xe2\x80\xa6,ci,ni copies of the number ai,ni. It is guaranteed that ai,1<ai,2<\xe2\x80\xa6<ai,ni. You are also given numbers l1,l2,\xe2\x80\xa6,lm and r1,r2,\xe2\x80\xa6,rm such that 1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4ci,1+\xe2\x80\xa6+ci,ni.Let\'s create a multiset X, initially empty. Then, for each i from 1 to m, you must perform the following action exactly once: Choose some vi such that li\xe2\x89\xa4vi\xe2\x89\xa4ri Choose any vi numbers from the i-th multiset and add them to the multiset X.You need to choose v1,\xe2\x80\xa6,vm and the added numbers in such a way that the resulting multiset X has the minimum possible anti-beauty." 2000
1893B "Neutral Tonality" "constructive algorithms,greedy,sortings,two pointers" "You are given an array a consisting of n integers, as well as an array b consisting of m integers.Let LIS(c) denote the length of the longest increasing subsequence of array c. For example, LIS([2,1_,1,3_]) = 2, LIS([1_,7_,9_]) = 3, LIS([3,1_,2_,4_]) = 3.You need to insert the numbers b1,b2,\xe2\x80\xa6,bm into the array a, at any positions, in any order. Let the resulting array be c1,c2,\xe2\x80\xa6,cn+m. You need to choose the positions for insertion in order to minimize LIS(c).Formally, you need to find an array c1,c2,\xe2\x80\xa6,cn+m that simultaneously satisfies the following conditions: The array a1,a2,\xe2\x80\xa6,an is a subsequence of the array c1,c2,\xe2\x80\xa6,cn+m. The array c1,c2,\xe2\x80\xa6,cn+m consists of the numbers a1,a2,\xe2\x80\xa6,an,b1,b2,\xe2\x80\xa6,bm, possibly rearranged. The value of LIS(c) is the minimum possible among all suitable arrays c." 1700
1893A "Anonymous Informant" "brute force,dfs and similar,graphs,implementation" "You are given an array b1,b2,\xe2\x80\xa6,bn.An anonymous informant has told you that the array b was obtained as follows: initially, there existed an array a1,a2,\xe2\x80\xa6,an, after which the following two-component operation was performed k times: A fixed point\xe2\x80\xa0 x of the array a was chosen. Then, the array a was cyclically shifted to the left\xe2\x80\xa1 exactly x times.As a result of k such operations, the array b1,b2,\xe2\x80\xa6,bn was obtained. You want to check if the words of the anonymous informant can be true or if they are guaranteed to be false.\xe2\x80\xa0A number x is called a fixed point of the array a1,a2,\xe2\x80\xa6,an if 1\xe2\x89\xa4x\xe2\x89\xa4n and ax=x.\xe2\x80\xa1A cyclic left shift of the array a1,a2,\xe2\x80\xa6,an is the array a2,\xe2\x80\xa6,an,a1." 1400
1891F "A Growing Tree" "data structures,dfs and similar,trees" "You are given a rooted tree with the root at vertex 1, initially consisting of a single vertex. Each vertex has a numerical value, initially set to 0. There are also q queries of two types:   The first type: add a child vertex with the number sz+1 to vertex v, where sz is the current size of the tree. The numerical value of the new vertex will be 0.  The second type: add x to the numerical values of all vertices in the subtree of vertex v. After all queries, output the numerical value of all of the vertices in the final tree." 2000
1891E "Brukhovich and Exams" "brute force,greedy,implementation,math,sortings" "The boy Smilo is learning algorithms with a teacher named Brukhovich.Over the course of the year, Brukhovich will administer n exams. For each exam, its difficulty ai is known, which is a non-negative integer.Smilo doesn\'t like when the greatest common divisor of the difficulties of two consecutive exams is equal to 1. Therefore, he considers the sadness of the academic year to be the number of such pairs of exams. More formally, the sadness is the number of indices i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) such that gcd(ai,ai+1)=1, where gcd(x,y) is the greatest common divisor of integers x and y.Brukhovich wants to minimize the sadness of the year of Smilo. To do this, he can set the difficulty of any exam to 0. However, Brukhovich doesn\'t want to make his students\' lives too easy. Therefore, he will perform this action no more than k times.Help Smilo determine the minimum sadness that Brukhovich can achieve if he performs no more than k operations.As a reminder, the greatest common divisor (GCD) of two non-negative integers x and y is the maximum integer that is a divisor of both x and y and is denoted as gcd(x,y). In particular, gcd(x,0)=gcd(0,x)=x for any non-negative integer x." 2500
1891D "Suspicious logarithms" "binary search,brute force,math" "Let f(x) be the floor of the binary logarithm of x. In other words, f(x) is largest non-negative integer y, such that 2y does not exceed x.Let g(x) be the floor of the logarithm of x with base f(x). In other words, g(x) is the largest non-negative integer z, such that f(x)z does not exceed x.You are given q queries. The i-th query consists of two integers li and ri. The answer to the query is the sum of g(k) across all integers k, such that li\xe2\x89\xa4k\xe2\x89\xa4ri. Since the answers might be large, print them modulo 109+7." 1900
1891C "Smilo and Monsters" "binary search,constructive algorithms,greedy,sortings,two pointers" "A boy called Smilo is playing a new game! In the game, there are n hordes of monsters, and the i-th horde contains ai monsters. The goal of the game is to destroy all the monsters. To do this, you have two types of attacks and a combo counter x, initially set to 0:  The first type: you choose a number i from 1 to n, such that there is at least one monster left in the horde with the number i. Then, you kill one monster from horde number i, and the combo counter x increases by 1.  The second type: you choose a number i from 1 to n, such that there are at least x monsters left in the horde with number i. Then, you use an ultimate attack and kill x monsters from the horde with number i. After that, x is reset to zero.Your task is to destroy all of the monsters, meaning that there should be no monsters left in any of the hordes. Smilo wants to win as quickly as possible, so he wants to the minimum number of attacks required to win the game." 1500
1891B "Deja Vu" "brute force,math,sortings" "You are given an array a of length n, consisting of positive integers, and an array x of length q, also consisting of positive integers.There are q modification. On the i-th modification (1\xe2\x89\xa4i\xe2\x89\xa4q), for each j (1\xe2\x89\xa4j\xe2\x89\xa4n), such that aj is divisible by 2xi, you add 2xi\xe2\x88\x921 to aj. Note that xi (1\xe2\x89\xa4xi\xe2\x89\xa430) is a positive integer not exceeding 30.After all modification queries, you need to output the final array." 1100
1891A "Sorting with Twos" "constructive algorithms,sortings" "You are given an array of integers a1,a2,\xe2\x80\xa6,an. In one operation, you do the following:   Choose a non-negative integer m, such that 2m\xe2\x89\xa4n.  Subtract 1 from ai for all integers i, such that 1\xe2\x89\xa4i\xe2\x89\xa42m. Can you sort the array in non-decreasing order by performing some number (possibly zero) of operations?An array is considered non-decreasing if ai\xe2\x89\xa4ai+1 for all integers i such that 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921." 800
1890B "Qingshan Loves Strings" "constructive algorithms,implementation" "Qingshan has a string s, while Daniel has a string t. Both strings only contain 0 and 1.A string a of length k is good if and only if  ai\xe2\x89\xa0ai+1 for all i=1,2,\xe2\x80\xa6,k\xe2\x88\x921. For example, 1, 101, 0101 are good, while 11, 1001, 001100 are not good.Qingshan wants to make s good. To do this, she can do the following operation any number of times (possibly, zero):  insert t to any position of s (getting a new s). Please tell Qingshan if it is possible to make s good." 800
1890A "Doremy\'s Paint 3" "constructive algorithms" "An array b1,b2,\xe2\x80\xa6,bn of positive integers is good if all the sums of two adjacent elements are equal to the same value. More formally, the array is good if there exists a k such that b1+b2=b2+b3=\xe2\x80\xa6=bn\xe2\x88\x921+bn=k.Doremy has an array a of length n. Now Doremy can permute its elements (change their order) however she wants. Determine if she can make the array good." 800
1889F "Doremy\'s Average Tree" "data structures,dp,greedy,trees" "Doremy has a rooted tree of size nn whose root is vertex rr. Initially there is a number wiwi written on vertex ii. Doremy can use her power to perform this operation at most kk times:  Choose a vertex xx (1\xe2\x89\xa4x\xe2\x89\xa4n1\xe2\x89\xa4x\xe2\x89\xa4n).  Let s=1|T|\xe2\x88\x91i\xe2\x88\x88Twis=1|T|\xe2\x88\x91i\xe2\x88\x88Twi where TT is the set of all vertices in xx\'s subtree.  For all i\xe2\x88\x88Ti\xe2\x88\x88T, assign wi:=swi:=s. Doremy wants to know what is the lexicographically smallest\xe2\x80\xa0\xe2\x80\xa0 array ww after performing all the operations. Can you help her?If there are multiple answers, you may output any one.\xe2\x80\xa0\xe2\x80\xa0 For arrays aa and bb both of length nn, aa is lexicographically smaller than bb if and only if there exist an index ii (1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n) such that ai<biai<bi and for all indices jj such that j<ij<i, aj=bjaj=bj is satisfied." 3500
1889E "Doremy\'s Swapping Trees" "dfs and similar,graphs,trees" "Consider two undirected graphs G1 and G2. Every node in G1 and in G2 has a label. Doremy calls G1 and G2 similar if and only if:  The labels in G1 are distinct, and the labels in G2 are distinct.  The set S of labels in G1 coincides with the set of labels in G2.  For every pair of two distinct labels u and v in S, the corresponding nodes are in the same connected component in G1 if and only if they are in the same connected component in G2. Now Doremy gives you two trees T1 and T2 with n nodes, labeled from 1 to n. You can do the following operation any number of times:  Choose an edge set E1 from T1 and an edge set E2 from T2, such that E1\xc2\xaf\xc2\xaf\xc2\xaf\xc2\xaf\xc2\xaf\xc2\xaf and E2\xc2\xaf\xc2\xaf\xc2\xaf\xc2\xaf\xc2\xaf\xc2\xaf are similar. Here E\xc2\xaf\xc2\xaf\xc2\xaf\xc2\xaf represents the graph which is given by only reserving the edge set E from T (i.e., the edge-induced subgraph). In other words, E\xc2\xaf\xc2\xaf\xc2\xaf\xc2\xaf is obtained from T by removing all edges not included in E and further removing all isolated vertices.  Swap the edge set E1 in T1 with the edge set E2 in T2. Now Doremy is wondering how many distinct T1 you can get after any number of operations. Can you help her find the answer? Output the answer modulo 109+7." 3500
1889D "Game of Stacks" "brute force,dfs and similar,graphs,implementation,trees" "You have n stacks r1,r2,\xe2\x80\xa6,rn. Each stack contains some positive integers ranging from 1 to n.Define the following functions:function init(pos):    stacks := an array that contains n stacks r[1], r[2], ..., r[n]    return get(stacks, pos)function get(stacks, pos):    if stacks[pos] is empty:        return pos    else:        new_pos := the top element of stacks[pos]        pop the top element of stacks[pos]        return get(stacks, new_pos)You want to know the values returned by init(1),init(2),\xe2\x80\xa6,init(n).Note that, during these calls, the stacks r1,r2,\xe2\x80\xa6,rn don\'t change, so the calls init(1),init(2),\xe2\x80\xa6,init(n) are independent." 3000
1889C2 "Doremy\'s Drying Plan (Hard Version)" "data structures,dp" "The only differences between the two versions of this problem are the constraint on k, the time limit and the memory limit. You can make hacks only if all versions of the problem are solved.Doremy lives in a rainy country consisting of n cities numbered from 1 to n.The weather broadcast predicted the distribution of rain in the next m days. In the i-th day, it will rain in the cities in the interval [li,ri]. A city is called dry if it will never rain in that city in the next m days.It turns out that Doremy has a special power. She can choose k days, and during these days it will not rain. Doremy wants to calculate the maximum number of dry cities after using the special power." 2600
1889C1 "Doremy\'s Drying Plan (Easy Version)" "brute force,data structures,dp,greedy,sortings" "The only differences between the two versions of this problem are the constraint on k, the time limit and the memory limit. You can make hacks only if all versions of the problem are solved.Doremy lives in a rainy country consisting of n cities numbered from 1 to n.The weather broadcast predicted the distribution of rain in the next m days. In the i-th day, it will rain in the cities in the interval [li,ri]. A city is called dry if it will never rain in that city in the next m days.It turns out that Doremy has a special power. She can choose k days (in the easy version, k=2), and during these days it will not rain. Doremy wants to calculate the maximum number of dry cities after using the special power." 2000
1889B "Doremy\'s Connecting Plan" "constructive algorithms,greedy,math,sortings" "Doremy lives in a country consisting of n cities numbered from 1 to n, with ai people living in the i-th city. It can be modeled as an undirected graph with n nodes.Initially, there are no edges in the graph. Now Doremy wants to make the graph connected. To do this, she can add an edge between i and j if \xe2\x88\x91k\xe2\x88\x88Sak\xe2\x89\xa5i\xe2\x8b\x85j\xe2\x8b\x85c,where S is the set of all the nodes that are currently in the same connected component of either i or j, and c is a given constant.Can Doremy make the graph connected?Two nodes (i,j) are in the same connected component if there exists a path from i to j. A graph is connected if all its nodes are in the same connected component." 1700
1889A "Qingshan Loves Strings 2" "constructive algorithms,greedy,implementation" "Qingshan has a string s which only contains 0 and 1.A string a of length k is good if and only if  ai\xe2\x89\xa0ak\xe2\x88\x92i+1 for all i=1,2,\xe2\x80\xa6,k. For Div. 2 contestants, note that this condition is different from the condition in problem B.For example, 10, 1010, 111000 are good, while 11, 101, 001, 001100 are not good.Qingshan wants to make s good. To do this, she can do the following operation at most 300 times (possibly, zero):   insert 01 to any position of s (getting a new s). Please tell Qingshan if it is possible to make s good. If it is possible, print a sequence of operations that makes s good." 1300
1887F "Minimum Segments" "constructive algorithms" "You had a sequence a1,a2,\xe2\x80\xa6,an consisting of integers from 1 to n, not necessarily distinct. For some unknown reason, you decided to calculate the following characteristic of the sequence:   Let ri (1\xe2\x89\xa4i\xe2\x89\xa4n) be the smallest j\xe2\x89\xa5i such that on the subsegment ai,ai+1,\xe2\x80\xa6,aj all distinct numbers from the sequence a appear. More formally, for any k\xe2\x88\x88[1,n], there exists l\xe2\x88\x88[i,j] such that ak=al. If such j does not exist, ri is considered to be equal to n+1.  The characteristic of the sequence a is defined as the sequence r1,r2,\xe2\x80\xa6,rn.  Unfortunately, the sequence a got lost, but you still have its characteristic r. You want to reconstruct any sequence a that matches the characteristic, or determine that there is an error in the characteristic and such a sequence does not exist." 3400
1887E "Good Colorings" "binary search,constructive algorithms,graphs,interactive" "Alice suggested Bob to play a game. Bob didn\'t like this idea, but he couldn\'t refuse Alice, so he asked you to write a program that would play instead of him.The game starts with Alice taking out a grid sheet of size n\xc3\x97nn\xc3\x97n, the cells of which are initially not colored. After that she colors some 2n2n cells with colors 1,2,\xe2\x80\xa6,2n1,2,\xe2\x80\xa6,2n, respectively, and informs Bob about these cells.In one move, Bob can point to a cell that has not been colored yet and ask Alice to color that cell. Alice colors that cell with one of the 2n2n colors of her choice, informing Bob of the chosen color. Bob can make no more than 1010 moves, after which he needs to find a good set of four cells.A set of four cells is considered good if the following conditions are met:  All the cells in the set are colored;  No two cells in the set are colored with the same color;  The centers of the cells form a rectangle with sides parallel to the grid lines." 3100
1887D Split "binary search,data structures,divide and conquer,dsu,math,trees,two pointers" "Let\'s call an array b1,b2,\xe2\x80\xa6,bm (m\xe2\x89\xa52) good if it can be split into two parts such that all elements in the left part are strictly smaller than all elements in the right part. In other words, there must exist an index 1\xe2\x89\xa4i<m such that every element from b1,\xe2\x80\xa6,bi is strictly smaller than every element from bi+1,\xe2\x80\xa6,bm.Given an array a1,a2,\xe2\x80\xa6an consisting of distinct integers from 1 to n. There are q queries. Each query consists of two numbers l and r. For each query, determine whether the array al,al+1,\xe2\x80\xa6,ar is good." 2700
1887C "Minimum Array" "binary search,brute force,constructive algorithms,data structures,greedy,hashing,two pointers" "Given an array a of length n consisting of integers. Then the following operation is sequentially applied to it q times: Choose indices l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and an integer x; Add x to all elements of the array a in the segment [l,r]. More formally, assign ai:=ai+x for all l\xe2\x89\xa4i\xe2\x89\xa4r.Let bj be the array a obtained after applying the first j operations (0\xe2\x89\xa4j\xe2\x89\xa4q). Note that b0 is the array a before applying any operations.You need to find the lexicographically minimum\xe2\x80\xa0 array among all arrays bj.\xe2\x80\xa0An array x is lexicographically smaller than array y if there is an index i such that xi<yi, and xj=yj for all j<i. In other words, for the first index i where the arrays differ, xi<yi." 2400
1887B "Time Travel" "binary search,graphs,shortest paths" "Berland is a country with ancient history, where roads were built and destroyed for centuries. It is known that there always were n cities in Berland. You also have records of t key moments in the history of the country, numbered from 1 to t. Each record contains a list of bidirectional roads between some pairs of cities, which could be used for travel in Berland at a specific moment in time.You have discovered a time machine that transports you between key moments. Unfortunately, you cannot choose what point in time to end up at, but you know the order consisting of k moments in time ai, in which the machine will transport you. Since there is little time between the travels, when you find yourself in the next key moment in time (including after the last time travel), you can travel on at most one existing road at that moment, coming out from the city you were in before time travel.Currently, you are in city 1, and the time machine has already transported you to moment a1. You want to reach city n as quickly as possible. Determine the minimum number of time travels, including the first one, that you need to make in order to reach city n." 1900
1886F "Diamond Theft" "data structures,greedy" "Monocarp is the most famous thief in Berland. This time, he decided to steal two diamonds. Unfortunately for Monocarp, there are n cameras monitoring the diamonds. Each camera has two parameters, ti and si. The first parameter determines whether the camera is monitoring the first diamond only (ti=1), the second diamond only (ti=2), or both diamonds (ti=3). The second parameter determines the number of seconds the camera will be disabled after it is hacked.Every second, Monocarp can perform one of the following three actions:   do nothing;  choose a camera and hack it; if Monocarp hacks the i-th camera, it will be disabled for the next si seconds (if the current second is the T-th one, the camera will be disabled from the (T+1)-th to the (T+si)-th second, inclusive);  steal a diamond if all cameras monitoring it are currently disabled. Monocarp cannot steal the second diamond if he hasn\'t stolen the first diamond yet. Note that Monocarp can hack a camera multiple times, even if it is currently disabled.Your task is to determine the minimum time it will take Monocarp to steal both diamonds, beginning with the first diamond, or report that it is impossible." 3300
1886E "I Wanna be the Team Leader" "bitmasks,constructive algorithms,dp,greedy,math,sortings,two pointers" "Monocarp is a team leader in a massive IT company.There are m projects his team of programmers has to complete, numbered from 1 to m. The i-th project has a difficulty level bi.There are n programmers in the team, numbered from 1 to n. The j-th programmer has a stress tolerance level aj.Monocarp wants to assign the programmers to the projects in such a way that:   each programmer is assigned to no more than one project;  each project has at least one programmer assigned to it;  let k programmers be assigned to the i-th project; then all the assigned programmers have to have a stress tolerance level greater than or equal to bik. Help Monocarp to find a valid assignment. If there are multiple answers, print any of them." 2400
1886D "Monocarp and the Set" "combinatorics,data structures,math" "Monocarp has n numbers 1,2,\xe2\x80\xa6,n and a set (initially empty). He adds his numbers to this set n times in some order. During each step, he adds a new number (which has not been present in the set before). In other words, the sequence of added numbers is a permutation of length n.Every time Monocarp adds an element into the set except for the first time, he writes out a character:  if the element Monocarp is trying to insert becomes the maximum element in the set, Monocarp writes out the character >;  if the element Monocarp is trying to insert becomes the minimum element in the set, Monocarp writes out the character <;  if none of the above, Monocarp writes out the character ?. You are given a string s of n\xe2\x88\x921 characters, which represents the characters written out by Monocarp (in the order he wrote them out). You have to process m queries to the string. Each query has the following format:  i c \xe2\x80\x94 replace si with the character c. Both before processing the queries and after each query, you have to calculate the number of different ways to order the integers 1,2,3,\xe2\x80\xa6,n such that, if Monocarp inserts the integers into the set in that order, he gets the string s. Since the answers might be large, print them modulo 998244353." 2100
1886C "Decreasing String" implementation,strings "Recall that string a is lexicographically smaller than string b if a is a prefix of b (and a\xe2\x89\xa0b), or there exists an index i (1\xe2\x89\xa4i\xe2\x89\xa4min(|a|,|b|)) such that ai<bi, and for any index j (1\xe2\x89\xa4j<i) aj=bj.Consider a sequence of strings s1,s2,\xe2\x80\xa6,sn, each consisting of lowercase Latin letters. String s1 is given explicitly, and all other strings are generated according to the following rule: to obtain the string si, a character is removed from string si\xe2\x88\x921 in such a way that string si is lexicographically minimal.For example, if s1=dacb, then string s2=acb, string s3=ab, string s4=a.After that, we obtain the string S=s1+s2+\xe2\x8b\xaf+sn (S is the concatenation of all strings s1,s2,\xe2\x80\xa6,sn).You need to output the character in position pos of the string S (i.\xe2\x80\x89e. the character Spos)." 1600
1886B "Fear of the Dark" "binary search,geometry,math" "Monocarp tries to get home from work. He is currently at the point O=(0,0) of a two-dimensional plane; his house is at the point P=(Px,Py).Unfortunately, it is late in the evening, so it is very dark. Monocarp is afraid of the darkness. He would like to go home along a path illuminated by something.Thankfully, there are two lanterns, located in the points A=(Ax,Ay) and B=(Bx,By). You can choose any non-negative number w and set the power of both lanterns to w. If a lantern\'s power is set to w, it illuminates a circle of radius w centered at the lantern location (including the borders of the circle).You have to choose the minimum non-negative value w for the power of the lanterns in such a way that there is a path from the point O to the point P which is completely illuminated. You may assume that the lanterns don\'t interfere with Monocarp\'s movement.  The picture for the first two test cases" 1200
1886A "Sum of Three" "brute force,constructive algorithms,math" "Monocarp has an integer n.He wants to represent his number as a sum of three distinct positive integers x, y, and z. Additionally, Monocarp wants none of the numbers x, y, and z to be divisible by 3.Your task is to help Monocarp to find any valid triplet of distinct positive integers x, y, and z, or report that such a triplet does not exist." 800
1885A "Deterministic Scheduling for Extended Reality over 5G and Beyond" "*special problem" "Background Extended reality (XR) service is a promising application for future communications. In wireless communications, XR data are transmitted over radio between base stations and mobile terminals. A region is usually divided into multiple cells, each of which is equipped with a base station to serve users. One base station usually serves multiple users, and multiple base stations may serve one user at the same time.TaskThe task of this competition is to design a scheduling algorithm for XR service. By properly allocating radio resources, we want to maximize the number of XR data frames that are successfully transmitted. A diagram is provided below for illustration: The transmission of a data frame is failed when it cannot be completely transmitted during the permitted transmission time window.    Therefore, the objective of this task can be modeled as: P:max\xe2\x88\x91jfj fj={1,gj\xe2\x89\xa5TBSj0,gj<TBSj Here, fj represents the transmission result of the j-th frame: when the actual transmitted bits gj (computed via (5)) is not less than the size of the frame, i.e., TBSj (transport block size), the frame would be successfully transmitted so that fj=1. Otherwise, fj=0.To achieve better user experience, scheduling algorithm should be proposed to efficiently assign the limited radio resources:   Time domain resource, which is divided into several transmission time intervals (TTIs), each TTI corresponds to a transmission time of 0.5ms.  Frequency domain resource, which is divided into several resource block groups (Resource Block Group, RBG), each RBG corresponds to a transmission bandwidth of 5760 kHz.  Power domain resource: each cell has a fixed maximum transmission power to serve users. Summarily, two optimization variables are introduced to represent the scheduling result: b(k)rnt\xe2\x88\x88{0,1} p(k)rnt\xe2\x89\xa50,\xe2\x88\x91r\xe2\x88\x91np(k)rnt\xe2\x89\xa4R,\xe2\x88\x91np(k)rnt\xe2\x89\xa44 Here, b(k)rnt is a Boolean variable denoting whether the r-th RBG of cell k is allocated to user n at TTI t, and p(k)rnt is a nonnegative continuous variable denoting the power allocated to user n in the r-th RBG of cell k at TTI t. For each TTI of each cell, the power range of each RBG is between 0 and 4, and the total power of all RBGs can not be larger than R.When the radio resources are allocated to the users, the XR data transmission can be provided for them. Assume that the j-th frame belongs to the n-th user, the actual transmitted bits for the frame, i.e., gj can be given by:gj=W\xc3\x97t1,j\xe2\x88\x91t=t0,j\xe2\x88\x91k\xe2\x88\x91rb(k)rnt\xc3\x97log2(1+s(k)nt). Note that W\xc3\x97log2(1+s(k)nt) is the well-known Shannon formula, which represents the transmitted data volume, where s(k)nt represents the transmission SINR (Signal-to-Interference-plus-Noise-Ratio) of user n in cell k at TTI t, and W=192 is the constant number of available frequency resounce elements of one RBG. t0,j and t1,j denote the start TTI and the end TTI of frame j, respectively. The physical meaning of Formula (5) is that the number of bits transmitted within the valid time period, t0,j\xe2\x88\xbct1,j, will be counted as valid transmission bits for the j-th frame. Finally, we give the expression of SINR, which may be complicated but corresponds to the actual physical transmission:s(k)nt=(\xe2\x88\x8fr,b(k)rnt=1s(k)rnt)1\xe2\x88\x91rb(k)rnt s(k)rnt=s(k)0,rnt\xc3\x97p(k)rnt\xc3\x97\xe2\x88\x8fm\xe2\x89\xa0ned(k)mrn\xc3\x97b(k)rmt1+\xe2\x88\x91k\xe2\x80\xb2\xe2\x89\xa0k,n\xe2\x80\xb2\xe2\x89\xa0ns(k\xe2\x80\xb2)0,rnt\xc3\x97p(k\xe2\x80\xb2)rn\xe2\x80\xb2t\xc3\x97e\xe2\x88\x92d(k\xe2\x80\xb2)n\xe2\x80\xb2rnFormula (6) shows the computation of user-level effective SINR: the transmission SINR of user n, i.e., s(k)nt, is the geometric mean of the SINRs of scheduled RBGs. Then, formula (7) shows the computation of RBG-level effective SINR. s(k)0,rnt is a given constant denoting the initial SINR on RBG r of cell k at TTI t, which indicates the quality of the channel. Another given constant value d(k)mrn represents the interference factor between user m and user n on RBG r, when user m is scheduled on cell k. Note that d(k)mrn=d(k)nrm\xe2\x89\xa40, which reveals that scheduling multiple users on the same RBG-TTI resource will cause a decrease in the SINR of each user.To sum up, participants are required to find an efficient radio resource allocation, so that more XR data frames can be successfully transmitted." -999
1884E "Hard Design" greedy,implementation,math "Consider an array of integers b0,b1,\xe2\x80\xa6,bn\xe2\x88\x921. Your goal is to make all its elements equal. To do so, you can perform the following operation several (possibly, zero) times: Pick a pair of indices 0\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n\xe2\x88\x921, then for each l\xe2\x89\xa4i\xe2\x89\xa4r increase bi by 1 (i. e. replace bi with bi+1). After performing this operation you receive (r\xe2\x88\x92l+1)2 coins. The value f(b) is defined as a pair of integers (cnt,cost), where cnt is the smallest number of operations required to make all elements of the array equal, and cost is the largest total number of coins you can receive among all possible ways to make all elements equal within cnt operations. In other words, first, you need to minimize the number of operations, second, you need to maximize the total number of coins you receive.You are given an array of integers a0,a1,\xe2\x80\xa6,an\xe2\x88\x921. Please, find the value of f for all cyclic shifts of a.Formally, for each 0\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 you need to do the following: Let cj=a(j+i)(modn) for each 0\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x921. Find f(c). Since cost can be very large, output it modulo (109+7).Please note that under a fixed cnt you need to maximize the total number of coins cost, not its remainder modulo (109+7)." 2800
1884D "Counting Rhyme" "dp,math,number theory" "You are given an array of integers a1,a2,\xe2\x80\xa6,an.A pair of integers (i,j), such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n, is called good, if there does not exist an integer k (1\xe2\x89\xa4k\xe2\x89\xa4n) such that ai is divisible by ak and aj is divisible by ak at the same time.Please, find the number of good pairs." 2100
1884C "Medium Design" "brute force,data structures,dp,greedy,sortings" "The array a1,a2,\xe2\x80\xa6,am is initially filled with zeroes. You are given n pairwise distinct segments 1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4m. You have to select an arbitrary subset of these segments (in particular, you may select an empty set). Next, you do the following:  For each i=1,2,\xe2\x80\xa6,n, if the segment (li,ri) has been selected to the subset, then for each index li\xe2\x89\xa4j\xe2\x89\xa4ri you increase aj by 1 (i. e. aj is replaced by aj+1). If the segment (li,ri) has not been selected, the array does not change.  Next (after processing all values of i=1,2,\xe2\x80\xa6,n), you compute max(a) as the maximum value among all elements of a. Analogously, compute min(a) as the minimum value.  Finally, the cost of the selected subset of segments is declared as max(a)\xe2\x88\x92min(a).Please, find the maximum cost among all subsets of segments." 1700
1884B "Haunted House" "binary search,greedy,math,two pointers" "You are given a number in binary representation consisting of exactly n bits, possibly, with leading zeroes. For example, for n=5 the number 6 will be given as 00110, and for n=4 the number 9 will be given as 1001.Let\'s fix some integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n. In one operation you can swap any two adjacent bits in the binary representation. Your goal is to find the smallest number of operations you are required to perform to make the number divisible by 2i, or say that it is impossible.Please note that for each 1\xe2\x89\xa4i\xe2\x89\xa4n you are solving the problem independently." 1100
1884A "Simple Design" "brute force,greedy,math" "A positive integer is called k-beautiful, if the digit sum of the decimal representation of this number is divisible by k\xe2\x80\xa0. For example, 9272 is 5-beautiful, since the digit sum of 9272 is 9+2+7+2=20.You are given two integers x and k. Please find the smallest integer y\xe2\x89\xa5x which is k-beautiful.\xe2\x80\xa0 An integer n is divisible by k if there exists an integer m such that n=k\xe2\x8b\x85m." 800
1883G2 "Dances (Hard Version)" "binary search,greedy,sortings,two pointers" "This is the hard version of the problem. The only difference is that in this version m\xe2\x89\xa4109.You are given two arrays of integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn. Before applying any operations, you can reorder the elements of each array as you wish. Then, in one operation, you will perform both of the following actions, if the arrays are not empty: Choose any element from array a and remove it (all remaining elements are shifted to a new array a), Choose any element from array b and remove it (all remaining elements are shifted to a new array b).Let k be the final size of both arrays. You need to find the minimum number of operations required to satisfy ai<bi for all 1\xe2\x89\xa4i\xe2\x89\xa4k.This problem was too easy, so the problem author decided to make it more challenging. You are also given a positive integer m. Now, you need to find the sum of answers to the problem for m pairs of arrays (c[i],b), where 1\xe2\x89\xa4i\xe2\x89\xa4m. Array c[i] is obtained from a as follows: c[i]1=i, c[i]j=aj, for 2\xe2\x89\xa4j\xe2\x89\xa4n." 1900
1883G1 "Dances (Easy version)" "binary search,greedy,two pointers" "This is the easy version of the problem. The only difference is that in this version m=1.You are given two arrays of integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn. Before applying any operations, you can reorder the elements of each array as you wish. Then, in one operation, you will perform both of the following actions, if the arrays are not empty: Choose any element from array a and remove it (all remaining elements are shifted to a new array a), Choose any element from array b and remove it (all remaining elements are shifted to a new array b).Let k be the final size of both arrays. You need to find the minimum number of operations required to satisfy ai<bi for all 1\xe2\x89\xa4i\xe2\x89\xa4k.This problem was too easy, so the problem author decided to make it more challenging. You are also given a positive integer m. Now, you need to find the sum of answers to the problem for m pairs of arrays (c[i],b), where 1\xe2\x89\xa4i\xe2\x89\xa4m. Array c[i] is obtained from a as follows: c[i]1=i, c[i]j=aj, for 2\xe2\x89\xa4j\xe2\x89\xa4n." 1400
1883F "You Are So Beautiful" "data structures" "You are given an array of integers a1,a2,\xe2\x80\xa6,an. Calculate the number of subarrays of this array 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, such that: The array b=[al,al+1,\xe2\x80\xa6,ar] occurs in the array a as a subsequence exactly once. In other words, there is exactly one way to select a set of indices 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ir\xe2\x88\x92l+1\xe2\x89\xa4n, such that bj=aij for all 1\xe2\x89\xa4j\xe2\x89\xa4r\xe2\x88\x92l+1." 1400
1883E "Look Back" bitmasks,greedy "You are given an array of integers a1,a2,\xe2\x80\xa6,an. You need to make it non-decreasing with the minimum number of operations. In one operation, you do the following: Choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n, Set ai=ai\xe2\x8b\x852.An array b1,b2,\xe2\x80\xa6,bn is non-decreasing if bi\xe2\x89\xa4bi+1 for all 1\xe2\x89\xa4i<n." 1700
1883D "In Love" "data structures,greedy" "Initially, you have an empty multiset of segments. You need to process q operations of two types: + l r \xe2\x80\x94 Add the segment (l,r) to the multiset, \xe2\x88\x92 l r \xe2\x80\x94 Remove exactly one segment (l,r) from the multiset. It is guaranteed that this segment exists in the multiset.After each operation, you need to determine if there exists a pair of segments in the multiset that do not intersect. A pair of segments (l,r) and (a,b) do not intersect if there does not exist a point x such that l\xe2\x89\xa4x\xe2\x89\xa4r and a\xe2\x89\xa4x\xe2\x89\xa4b." 1500
1883C Raspberries dp,math "You are given an array of integers a1,a2,\xe2\x80\xa6,an and a number k (2\xe2\x89\xa4k\xe2\x89\xa45). In one operation, you can do the following: Choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n, Set ai=ai+1.Find the minimum number of operations needed to make the product of all the numbers in the array a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85an divisible by k." 1000
1883B Chemistry strings "You are given a string s of length n, consisting of lowercase Latin letters, and an integer k.You need to check if it is possible to remove exactly k characters from the string s in such a way that the remaining characters can be rearranged to form a palindrome. Note that you can reorder the remaining characters in any way.A palindrome is a string that reads the same forwards and backwards. For example, the strings ""z"", ""aaa"", ""aba"", ""abccba"" are palindromes, while the strings ""codeforces"", ""reality"", ""ab"" are not." 900
1883A Morning math "You are given a four-digit pin code consisting of digits from 0 to 9 that needs to be entered. Initially, the cursor points to the digit 1. In one second, you can perform exactly one of the following two actions: Press the cursor to display the current digit, Move the cursor to any adjacent digit.  The image above shows the device you are using to enter the pin code. For example, for the digit 5, the adjacent digits are 4 and 6, and for the digit 0, there is only one adjacent digit, 9.Determine the minimum number of seconds required to enter the given four-digit pin code." 800
1882E2 "Two Permutations (Hard Version)" "constructive algorithms" "This is the hard version of the problem. The difference between the two versions is that you have to minimize the number of operations in this version. You can make hacks only if both versions of the problem are solved.You have two permutations\xe2\x80\xa0 p1,p2,\xe2\x80\xa6,pn (of integers 1 to n) and q1,q2,\xe2\x80\xa6,qm (of integers 1 to m). Initially pi=ai for i=1,2,\xe2\x80\xa6,n, and qj=bj for j=1,2,\xe2\x80\xa6,m. You can apply the following operation on the permutations several (possibly, zero) times.In one operation, p and q will change according to the following three steps:  You choose integers i, j which satisfy 1\xe2\x89\xa4i\xe2\x89\xa4n and 1\xe2\x89\xa4j\xe2\x89\xa4m.  Permutation p is partitioned into three parts using pi as a pivot: the left part is formed by elements p1,p2,\xe2\x80\xa6,pi\xe2\x88\x921 (this part may be empty), the middle part is the single element pi, and the right part is pi+1,pi+2,\xe2\x80\xa6,pn (this part may be empty). To proceed, swap the left and the right parts of this partition. Formally, after this step, p will become pi+1,pi+2,\xe2\x80\xa6,pn,pi,p1,p2,\xe2\x80\xa6,pi\xe2\x88\x921. The elements of the newly formed p will be reindexed starting from 1.  Perform the same transformation on q with index j. Formally, after this step, q will become qj+1,qj+2,\xe2\x80\xa6,qm,qj,q1,q2,\xe2\x80\xa6,qj\xe2\x88\x921. The elements of the newly formed q will be reindexed starting from 1. Your goal is to simultaneously make pi=i for i=1,2,\xe2\x80\xa6,n, and qj=j for j=1,2,\xe2\x80\xa6,m.Find any way to achieve the goal using the minimum number of operations possible, or say that none exists. Please note that you have to minimize the number of operations.\xe2\x80\xa0 A permutation of length k is an array consisting of k distinct integers from 1 to k in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (k=3 but there is 4 in the array)." 3100
1882E1 "Two Permutations (Easy Version)" "brute force,constructive algorithms,greedy,number theory" "This is the easy version of the problem. The difference between the two versions is that you do not have to minimize the number of operations in this version. You can make hacks only if both versions of the problem are solved.You have two permutations\xe2\x80\xa0 p1,p2,\xe2\x80\xa6,pn (of integers 1 to n) and q1,q2,\xe2\x80\xa6,qm (of integers 1 to m). Initially pi=ai for i=1,2,\xe2\x80\xa6,n, and qj=bj for j=1,2,\xe2\x80\xa6,m. You can apply the following operation on the permutations several (possibly, zero) times.In one operation, p and q will change according to the following three steps:  You choose integers i, j which satisfy 1\xe2\x89\xa4i\xe2\x89\xa4n and 1\xe2\x89\xa4j\xe2\x89\xa4m.  Permutation p is partitioned into three parts using pi as a pivot: the left part is formed by elements p1,p2,\xe2\x80\xa6,pi\xe2\x88\x921 (this part may be empty), the middle part is the single element pi, and the right part is pi+1,pi+2,\xe2\x80\xa6,pn (this part may be empty). To proceed, swap the left and the right parts of this partition. Formally, after this step, p will become pi+1,pi+2,\xe2\x80\xa6,pn,pi,p1,p2,\xe2\x80\xa6,pi\xe2\x88\x921. The elements of the newly formed p will be reindexed starting from 1.  Perform the same transformation on q with index j. Formally, after this step, q will become qj+1,qj+2,\xe2\x80\xa6,qm,qj,q1,q2,\xe2\x80\xa6,qj\xe2\x88\x921. The elements of the newly formed q will be reindexed starting from 1. Your goal is to simultaneously make pi=i for i=1,2,\xe2\x80\xa6,n, and qj=j for j=1,2,\xe2\x80\xa6,m.Find any valid way to achieve the goal using at most 10000 operations, or say that none exists. Please note that you do not have to minimize the number of operations.It can be proved that if it is possible to achieve the goal, then there exists a way to do so using at most 10000 operations.\xe2\x80\xa0 A permutation of length k is an array consisting of k distinct integers from 1 to k in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (k=3 but there is 4 in the array)." 2400
1882D "Tree XOR" "bitmasks,dfs and similar,dp,greedy,trees" "You are given a tree with n vertices labeled from 1 to n. An integer ai is written on vertex i for i=1,2,\xe2\x80\xa6,n. You want to make all ai equal by performing some (possibly, zero) spells.Suppose you root the tree at some vertex. On each spell, you can select any vertex v and any non-negative integer c. Then for all vertices i in the subtree\xe2\x80\xa0 of v, replace ai with ai\xe2\x8a\x95c. The cost of this spell is s\xe2\x8b\x85c, where s is the number of vertices in the subtree. Here \xe2\x8a\x95 denotes the bitwise XOR operation.Let mr be the minimum possible total cost required to make all ai equal, if vertex r is chosen as the root of the tree. Find m1,m2,\xe2\x80\xa6,mn.\xe2\x80\xa0 Suppose vertex r is chosen as the root of the tree. Then vertex i belongs to the subtree of v if the simple path from i to r contains v." 1900
1882C "Card Game" "brute force,greedy" "There are n cards stacked in a deck. Initially, ai is written on the i-th card from the top. The value written on a card does not change.You will play a game. Initially your score is 0. In each turn, you can do one of the following operations:   Choose an odd\xe2\x80\xa0 positive integer i, which is not greater than the number of cards left in the deck. Remove the i-th card from the top of the deck and add the number written on the card to your score. The remaining cards will be reindexed starting from the top.  Choose an even\xe2\x80\xa1 positive integer i, which is not greater than the number of cards left in the deck. Remove the i-th card from the top of the deck. The remaining cards will be reindexed starting from the top.  End the game. You can end the game whenever you want, you do not have to remove all cards from the initial deck. What is the maximum score you can get when the game ends?\xe2\x80\xa0 An integer i is odd, if there exists an integer k such that i=2k+1.\xe2\x80\xa1 An integer i is even, if there exists an integer k such that i=2k." 1500
1882B "Sets and Union" "bitmasks,brute force,constructive algorithms,greedy" "You have n sets of integers S1,S2,\xe2\x80\xa6,Sn. We call a set S attainable, if it is possible to choose some (possibly, none) of the sets S1,S2,\xe2\x80\xa6,Sn so that S is equal to their union\xe2\x80\xa0. If you choose none of S1,S2,\xe2\x80\xa6,Sn, their union is an empty set.Find the maximum number of elements in an attainable S such that S\xe2\x89\xa0S1\xe2\x88\xaaS2\xe2\x88\xaa\xe2\x80\xa6\xe2\x88\xaaSn.\xe2\x80\xa0 The union of sets A1,A2,\xe2\x80\xa6,Ak is defined as the set of elements present in at least one of these sets. It is denoted by A1\xe2\x88\xaaA2\xe2\x88\xaa\xe2\x80\xa6\xe2\x88\xaaAk. For example, {2,4,6}\xe2\x88\xaa{2,3}\xe2\x88\xaa{3,6,7}={2,3,4,6,7}." 1300
1882A "Increasing Sequence" greedy "You are given a sequence a1,a2,\xe2\x80\xa6,an. A sequence b1,b2,\xe2\x80\xa6,bn is called good, if it satisfies all of the following conditions:   bi is a positive integer for i=1,2,\xe2\x80\xa6,n;  bi\xe2\x89\xa0ai for i=1,2,\xe2\x80\xa6,n;  b1<b2<\xe2\x80\xa6<bn.  Find the minimum value of bn among all good sequences b1,b2,\xe2\x80\xa6,bn." 800
1881G "Anya and the Mysterious String" "binary search,data structures" "Anya received a string s of length n brought from Rome. The string s consists of lowercase Latin letters and at first glance does not raise any suspicions. An instruction was attached to the string.Start of the instruction.A palindrome is a string that reads the same from left to right and right to left. For example, the strings ""anna"", ""aboba"", ""level"" are palindromes, while the strings ""gorilla"", ""banan"", ""off"" are not.A substring [l\xe2\x80\xa6r] of string s is a string slsl+1\xe2\x80\xa6sr\xe2\x88\x921sr. For example, the substring [4\xe2\x80\xa66] of the string ""generation"" is the string ""era"".A string is called beautiful if it does not contain a substring of length at least two that is a palindrome. For example, the strings ""fox"", ""abcdef"", and ""yioy"" are beautiful, while the strings ""xyxx"", ""yikjkitrb"" are not.When an integer x is added to the character si, it is replaced x times with the next character in the alphabet, with ""z"" being replaced by ""a"".When an integer x is added to the substring [l,r] of string s, it becomes the string s1s2\xe2\x80\xa6sl\xe2\x88\x921(sl+x)(sl+1+x)\xe2\x80\xa6(sr\xe2\x88\x921+x)(sr+x)sr+1\xe2\x80\xa6sn. For example, when the substring [2,4] of the string ""abazaba"" is added with the number 6, the resulting string is ""ahgfaba"".End of the instruction.After reading the instruction, Anya resigned herself to the fact that she has to answer m queries. The queries can be of two types:  Add the number x to the substring [l\xe2\x80\xa6r] of string s.  Determine whether the substring [l\xe2\x80\xa6r] of string s is beautiful." 2000
1881F "Minimum Maximum Distance" "dfs and similar,dp,graphs,shortest paths,trees" "You have a tree with n vertices, some of which are marked. A tree is a connected undirected graph without cycles.Let fi denote the maximum distance from vertex i to any of the marked vertices.Your task is to find the minimum value of fi among all vertices.  For example, in the tree shown in the example, vertices 2, 6, and 7 are marked. Then the array f(i)=[2,3,2,4,4,3,3]. The minimum fi is for vertices 1 and 3." 1700
1881E "Block Sequence" dp "Given a sequence of integers a of length n.A sequence is called beautiful if it has the form of a series of blocks, each starting with its length, i.e., first comes the length of the block, and then its elements. For example, the sequences [3, 3, 4, 5, 2, 6, 1] and [1, 8, 4, 5, 2, 6, 1] are beautiful (different blocks are colored differently), while [1], [1, 4, 3], [3, 2, 1] are not.In one operation, you can remove any element from the sequence. What is the minimum number of operations required to make the given sequence beautiful?" 1500
1881D "Divide and Equalize" "math,number theory" "You are given an array a consisting of n positive integers. You can perform the following operation on it:   Choose a pair of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n and i\xe2\x89\xa0j);  Choose one of the divisors of the integer ai, i.e., an integer x such that aimodx=0;  Replace ai with aix and aj with aj\xe2\x8b\x85x.  Determine whether it is possible to make all elements in the array the same by applying the operation a certain number of times (possibly zero).For example, let\'s consider the array a = [100,2,50,10,1] with 5 elements. Perform two operations on it:   Choose a3=50 and a2=2, x=5. Replace a3 with a3x=505=10, and a2 with a2\xe2\x8b\x85x=2\xe2\x8b\x855=10. The resulting array is a = [100,10,10,10,1];  Choose a1=100 and a5=1, x=10. Replace a1 with a1x=10010=10, and a5 with a5\xe2\x8b\x85x=1\xe2\x8b\x8510=10. The resulting array is a = [10,10,10,10,10].  After performing these operations, all elements in the array a become equal to 10." 1300
1881C "Perfect Square" "brute force,implementation" "Kristina has a matrix of size n by n, filled with lowercase Latin letters. The value of n is even.She wants to change some characters so that her matrix becomes a perfect square. A matrix is called a perfect square if it remains unchanged when rotated 90\xe2\x88\x98 clockwise once.Here is an example of rotating a matrix by 90\xe2\x88\x98:  In one operation, Kristina can choose any cell and replace its value with the next character in the alphabet. If the character is equal to ""z"", its value does not change.Find the minimum number of operations required to make the matrix a perfect square.For example, if the 4 by 4 matrix looks like this:abbabcbbbccbabbathen it is enough to apply 1 operation to the letter b, highlighted in bold." 1200
1881B "Three Threadlets" math "Once upon a time, bartender Decim found three threadlets and a pair of scissors.In one operation, Decim chooses any threadlet and cuts it into two threadlets, whose lengths are positive integers and their sum is equal to the length of the threadlet being cut.For example, he can cut a threadlet of length 5 into threadlets of lengths 2 and 3, but he cannot cut it into threadlets of lengths 2.5 and 2.5, or lengths 0 and 5, or lengths 3 and 4.Decim can perform at most three operations. He is allowed to cut the threadlets obtained from previous cuts. Will he be able to make all the threadlets of equal length?" 900
1881A "Don\'t Try to Count" "brute force,strings" "Given a string x of length n and a string s of length m (n\xe2\x8b\x85m\xe2\x89\xa425), consisting of lowercase Latin letters, you can apply any number of operations to the string x.In one operation, you append the current value of x to the end of the string x. Note that the value of x will change after this.For example, if x=""aba"", then after applying operations, x will change as follows: ""aba"" \xe2\x86\x92 ""abaaba"" \xe2\x86\x92 ""abaabaabaaba"".After what minimum number of operations s will appear in x as a substring? A substring of a string is defined as a contiguous segment of it." 800
1879F "Last Man Standing" "brute force,data structures,number theory" "There are n heroes in a videogame. Each hero has some health value h and initial armor value a. Let the current value of armor be acur, initially equal to a.When x points of damage are inflicted on a hero, the following happens: if x<acur, then x gets subtracted from acur; otherwise, 1 gets subtracted from h and acur gets assigned back to a.In the start of the game, you choose the value x (an integer strictly greater than 0, arbitrarily large). Then you keep attacking all heroes in rounds: in one round, you inflict x points of damage to all alive heroes. A hero dies when his health becomes 0. The game ends when all heroes are dead.The last hero to die earns the number of points, equal to the number of rounds he was the only hero alive. The other heroes get 0 points. In particular, if the last round ends with multiple heroes dying, then every hero gets 0 points.The game is played for every possible x (from 1 to infinity). The points are reset between the games. What\'s the maximum number of points each hero has had?" 2800
1879E "Interactive Game with Coloring" "brute force,constructive algorithms,dfs and similar,graphs,implementation,interactive,trees" "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.You are given a tree on n vertices; vertex 1 is the root of the tree. For every i\xe2\x88\x88[2,n], the parent of the i-th vertex is pi, and pi<i.You have to color all edges of the tree using the minimum possible number of colors such that you can win the game on that tree (every edge should be painted into exactly one color).The game we\'re going to play will be conducted as follows. After you paint the edges and print their colors, the jury will place a chip into one of the vertices of the tree (except for the root). Your goal is to move this chip to the root in exactly d moves, where d is the distance from the root to that vertex (the distance is equal to the number of edges on the path). If the chip reaches the root in d moves, you win. Otherwise, you lose.The jury won\'t tell you where the chip is located. You won\'t even know the value of d in advance. However, at the start of each move, you will be told how many edges of each color are incident to the current vertex (this includes both the edge leading up the tree and the edges leading away from the root). You have to choose one of these colors, and the chip will be moved along the edge of the chosen color (if there are multiple edges with that color incident to the current vertex, the jury gets to choose one of them). After the chip is moved, you will be told the same information about the current vertex again, and the game continues, until you either reach the root, or you make d moves without reaching the root.The interactor for this problem is adaptive. It means that both the starting vertex and the current vertex are not fixed and may change ""on the run"" depending on the output of your program. However, the state of the game will always be consistent with the information you are given: there will always be at least one starting vertex and at least one path of your chip from that vertex consistent with both the information about the colors you receive and the colors you\'ve chosen during the moves." 2400
1879D "Sum of XOR Functions" "bitmasks,combinatorics,divide and conquer,dp,math" "You are given an array a of length n consisting of non-negative integers.You have to calculate the value of \xe2\x88\x91nl=1\xe2\x88\x91nr=lf(l,r)\xe2\x8b\x85(r\xe2\x88\x92l+1), where f(l,r) is al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x8b\xaf\xe2\x8a\x95ar\xe2\x88\x921\xe2\x8a\x95ar (the character \xe2\x8a\x95 denotes bitwise XOR).Since the answer can be very large, print it modulo 998244353." 1700
1879C "Make it Alternating" combinatorics,dp,greedy "You are given a binary string s. A binary string is a string consisting of characters 0 and/or 1.You can perform the following operation on s any number of times (even zero):  choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4|s|, then erase the character si. You have to make s alternating, i.\xe2\x80\x89e. after you perform the operations, every two adjacent characters in s should be different.Your goal is to calculate two values:  the minimum number of operations required to make s alternating;  the number of different shortest sequences of operations that make s alternating. Two sequences of operations are different if in at least one operation, the chosen integer i is different in these two sequences." 1300
1879B "Chips on the Board" "constructive algorithms,greedy" "You are given a board of size n\xc3\x97n (n rows and n colums) and two arrays of positive integers a and b of size n.Your task is to place the chips on this board so that the following condition is satisfied for every cell (i,j):  there exists at least one chip in the same column or in the same row as the cell (i,j). I.\xe2\x80\x89e. there exists a cell (x,y) such that there is a chip in that cell, and either x=i or y=j (or both). The cost of putting a chip in the cell (i,j) is equal to ai+bj. For example, for n=3, a=[1,4,1] and b=[3,2,2]. One of the possible chip placements is as follows:  White squares are empty The total cost of that placement is (1+3)+(1+2)+(1+2)=10.Calculate the minimum possible total cost of putting chips according to the rules above." 900
1879A Rigged! greedy "Monocarp organizes a weightlifting competition. There are n athletes participating in the competition, the i-th athlete has strength si and endurance ei. The 1-st athlete is Monocarp\'s friend Polycarp, and Monocarp really wants Polycarp to win.The competition will be conducted as follows. The jury will choose a positive (greater than zero) integer w, which denotes the weight of the barbell that will be used in the competition. The goal for each athlete is to lift the barbell as many times as possible. The athlete who lifts the barbell the most amount of times will be declared the winner (if there are multiple such athletes \xe2\x80\x94 there\'s no winner).If the barbell\'s weight w is strictly greater than the strength of the i-th athlete si, then the i-th athlete will be unable to lift the barbell even one single time. Otherwise, the i-th athlete will be able to lift the barbell, and the number of times he does it will be equal to his endurance ei.For example, suppose there are 4 athletes with parameters s1=7,e1=4; s2=9,e2=3; s3=4,e3=6; s4=2,e4=2. If the weight of the barbell is 5, then:  the first athlete will be able to lift the barbell 4 times;  the second athlete will be able to lift the barbell 3 times;  the third athlete will be unable to lift the barbell;  the fourth athlete will be unable to lift the barbell. Monocarp wants to choose w in such a way that Polycarp (the 1-st athlete) wins the competition. Help him to choose the value of w, or report that it is impossible." 800
1878G "wxhtzdy ORO Tree" "binary search,bitmasks,brute force,data structures,dfs and similar,implementation,trees" "After (finally) qualifying for the IOI 2023, wxhtzdy was very happy, so he decided to do what most competitive programmers do: trying to guess the problems that will be on IOI. During this process, he accidentally made a problem, which he thought was really cool.You are given a tree (a connected acyclic graph) with n vertices and n\xe2\x88\x921 edges. Vertex i (1\xe2\x89\xa4i\xe2\x89\xa4n) has a value ai. Lets\' define g(u,v) as the bitwise or of the values of all vertices on the shortest path from u to v. For example, let\'s say that we want to calculate g(3,4), on the tree from the first test case in the example. On the path from 3 to 4 are vertices 3, 1, 4. Then, g(3,4)=a3 | a1 | a4 (here, | represents the bitwise OR operation).Also, you are given q queries, and each query looks like this:You are given x and y. Let\'s consider all vertices z such that z is on the shortest path from x to y (inclusive).Lets define the niceness of a vertex z as the sum of the number of non-zero bits in g(x,z) and the number of non-zero bits in g(y,z). You need to find the maximum niceness among all vertices z on the shortest path from x to y.Since his brain is really tired after solving an output only problem on SIO (he had to do it to qualify for the IOI), he wants your help with this problem." 2300
1878F "Vasilije Loves Number Theory" "brute force,math,number theory" "Vasilije is a smart student and his discrete mathematics teacher Sonja taught him number theory very well.He gave Ognjen a positive integer n.Denote d(n) as the number of positive integer divisors of n, and denote gcd(a,b) as the largest integer g such that a is divisible by g and b is divisible by g.After that, he gave Ognjen q queries, and there are 2 types of queries.   1, x \xe2\x80\x94 set n to n\xe2\x8b\x85x, and then answer the following question: does there exist a positive integer a such that gcd(a,n)=1, and d(n\xe2\x8b\x85a)=n?  2 \xe2\x80\x94 reset n to its initial value (before any queries). Note that n does not get back to its initial value after the type 1 query.Since Ognjen is afraid of number theory, Vasilije promised him that after each query, d(n)\xe2\x89\xa4109, however, even with that constraint, he still needs your help with this problem." 1900
1878E "Iva & Pav" "binary search,bitmasks,data structures,greedy" "Iva and Pav are a famous Serbian competitive programming couple. In Serbia, they call Pav ""papuca"" and that\'s why he will make all of Iva\'s wishes come true.Iva gave Pav an array a of n elements.Let\'s define f(l,r)=al & al+1 &\xe2\x80\xa6& ar (here & denotes the bitwise AND operation). Note that f(l,r) is not defined when l>r.Iva also gave Pav q queries.Each query consists of 2 numbers, k and l, and she wants Pav to find the largest index r (l\xe2\x89\xa4r\xe2\x89\xa4n), such that f(l,r)\xe2\x89\xa5k. Pav wants to solve this problem fast because he doesn\'t want to upset Iva. He needs your help." 1400
1878D "Reverse Madness" "data structures,greedy" "You are given a string s of length n, containing lowercase Latin letters. Next you will be given a positive integer k and two arrays, l and r of length k.It is guaranteed that the following conditions hold for these 2 arrays:   l1=1;  rk=n;  li\xe2\x89\xa4ri, for each positive integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4k;  li=ri\xe2\x88\x921+1, for each positive integer i such that 2\xe2\x89\xa4i\xe2\x89\xa4k; Now you will be given a positive integer q which represents the number of modifications you need to do on s.Each modification is defined with one positive integer x:   Find an index i such that li\xe2\x89\xa4x\xe2\x89\xa4ri (notice that such i is unique).  Let a=min(x,ri+li\xe2\x88\x92x) and let b=max(x,ri+li\xe2\x88\x92x).  Reverse the substring of s from index a to index b. Reversing the substring [a,b] of a string s means to make s equal to s1,s2,\xe2\x80\xa6,sa\xe2\x88\x921, sb,sb\xe2\x88\x921,\xe2\x80\xa6,sa+1,sa, sb+1,sb+2,\xe2\x80\xa6,sn\xe2\x88\x921,sn.Print s after the last modification is finished." 1600
1878C "Vasilije in Cacak" math "Aca and Milovan, two fellow competitive programmers, decided to give Vasilije a problem to test his skills.Vasilije is given three positive integers: n, k, and x, and he has to determine if he can choose k distinct integers between 1 and n, such that their sum is equal to x.Since Vasilije is now in the weirdest city in Serbia where Aca and Milovan live, Cacak, the problem seems weird to him. So he needs your help with this problem." 900
1878B "Aleksa and Stack" "constructive algorithms,math" "After the Serbian Informatics Olympiad, Aleksa was very sad, because he didn\'t win a medal (he didn\'t know stack), so Vasilije came to give him an easy problem, just to make his day better.Vasilije gave Aleksa a positive integer n (n\xe2\x89\xa53) and asked him to construct a strictly increasing array of size n of positive integers, such that   3\xe2\x8b\x85ai+2 is not divisible by ai+ai+1 for each i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922).  Note that a strictly increasing array a of size n is an array where ai<ai+1 for each i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).Since Aleksa thinks he is a bad programmer now, he asked you to help him find such an array." 800
1878A "How Much Does Daytona Cost?" greedy "We define an integer to be the most common on a subsegment, if its number of occurrences on that subsegment is larger than the number of occurrences of any other integer in that subsegment. A subsegment of an array is a consecutive segment of elements in the array a.Given an array a of size n, and an integer k, determine if there exists a non-empty subsegment of a where k is the most common element." 800
1877C Joyboard "math,number theory" "Chaneka, a gamer kid, invented a new gaming controller called joyboard. Interestingly, the joyboard she invented can only be used to play one game.The joyboard has a screen containing n+1 slots numbered from 1 to n+1 from left to right. The n+1 slots are going to be filled with an array of non-negative integers [a1,a2,a3,\xe2\x80\xa6,an+1]. Chaneka, as the player, must assign an+1 with an integer between 0 and m inclusive. Then, for each i from n to 1, the value of ai will be equal to the remainder of dividing ai+1 (the adjacent value to the right) by i. In other words, ai=ai+1modi.Chaneka wants it such that after every slot is assigned with an integer, there are exactly k distinct values in the entire screen (among all n+1 slots). How many valid ways are there for assigning a non-negative integer into slot n+1?" 1200
1877A "Goals of Victory" math "There are n teams in a football tournament. Each pair of teams match up once. After every match, Pak Chanek receives two integers as the result of the match, the number of goals the two teams score during the match. The efficiency of a team is equal to the total number of goals the team scores in each of its matches minus the total number of goals scored by the opponent in each of its matches.After the tournament ends, Pak Dengklek counts the efficiency of every team. Turns out that he forgot about the efficiency of one of the teams. Given the efficiency of n\xe2\x88\x921 teams a1,a2,a3,\xe2\x80\xa6,an\xe2\x88\x921. What is the efficiency of the missing team? It can be shown that the efficiency of the missing team can be uniquely determined." 800
1876G Clubstep "binary search,brute force,data structures,greedy,trees" "There is an extremely hard video game that is one of Chaneka\'s favourite video games. One of the hardest levels in the game is called Clubstep. Clubstep consists of n parts, numbered from 1 to n. Chaneka has practised the level a good amount, so currently, her familiarity value with each part i is ai.After this, Chaneka can do several (possibly zero) attempts on Clubstep. In each attempt, she dies on one of the n parts. If an attempt dies on part p, that means it only successfully passes through every part k for all 1\xe2\x89\xa4k\xe2\x89\xa4p\xe2\x88\x921 and it does not reach any part k for all p+1\xe2\x89\xa4k\xe2\x89\xa4n. An attempt that dies on part p takes p seconds.It is known that Chaneka improves much more on the part she dies on than anything else. It is also known that during an attempt, Chaneka does not get to practise that much on the parts she does not reach. So, the effect of an attempt that dies on part p is as follows:   Chaneka\'s familiarity value with part p increases by 2.  Chaneka\'s familiarity value with each part k for all 1\xe2\x89\xa4k\xe2\x89\xa4p\xe2\x88\x921 increases by 1.  There will be q questions. For the j-th question, you are given three integers lj, rj, and xj. Then, you are asked to find out the minimum time (in seconds) for Chaneka to make it such that the familiarity value for every part p (lj\xe2\x89\xa4p\xe2\x89\xa4rj) is at least xj.Note that each question is independent, so the attempt Chaneka does on a question does not affect the familiarity values of any other questions." 3500
1876F "Indefinite Clownfish" "binary search,graphs" "Pak Chanek has just bought an empty fish tank and he has been dreaming to fill it with his favourite kind of fish, clownfish. Pak Chanek likes clownfish because of their ability to change their genders on demand. Because of the size of his fish tank, Pak Chanek wants to buy exactly k clownfish to fill the tank.Pak Chanek goes to the local fish shop. The shop provides n clownfish numbered from 1 to n, with clownfish i having a size of ai. Initially, every clownfish in the store does not have an assigned gender, but has the ability to be assigned to two possible clownfish genders, female or male.The store has a procedure which Pak Chanek should follow to buy clownfish. The shop owner will point at each clownfish sequentially from 1 to n and for each clownfish, she asks Pak Chanek whether to buy it or not. Each time Pak Chanek is asked, he must declare whether to buy the currently asked clownfish or not, before the shop owner moves on to the next clownfish. If Pak Chanek declares to buy the currently asked clownfish, he must also declare the gender to be assigned to that clownfish immediately. When assigning the gender for the currently asked clownfish, the following conditions must be satisfied:   If Pak Chanek assigns it to be female and he has bought a female clownfish before, then the size of the current one must be exactly 1 bigger than the last female one.  If Pak Chanek assigns it to be male and he has bought a male clownfish before, then the size of the current one must be exactly 1 smaller than the last male one. Pak Chanek wants to buy exactly k clownfish such that:   There is at least one female clownfish and one male clownfish.  Among the k clownfish Pak Chanek buys, the mean size of the female clownfish is equal to the mean size of the male clownfish. Let l and r respectively be the minimum and maximum index of a clownfish Pak Chanek buys. What is the minimum possible value of r\xe2\x88\x92l?" 3500
1876E Ball-Stackable "constructive algorithms,data structures,dp,trees" "With a problem title like that, there is no way this is going to be a graph problem.Chaneka has a graph with n vertices and n\xe2\x88\x921 edges. Some of the edges are directed and some of the edges are undirected. Edge i connects vertex ui to vertex vi. If ti=0, edge i is undirected. If ti=1, edge i is directed in the direction from ui to vi. It is known that if you make all edges undirected, the graph becomes a tree\xe2\x80\xa0.Chaneka wants to direct all undirected edges and colour each edge (different edges can have the same colour).After doing that, suppose Chaneka starts a walk from an arbitrary vertex x to an arbitrary vertex y (it is possible that x=y) going through one or more edges. She is allowed to go through each edge either following the direction or opposite to the direction of the edge. She is also allowed to visit a vertex or an edge more than once. During the walk, Chaneka maintains a stack of balls that is initially empty before the walk. Each time Chaneka goes through an edge, she does the following:   If Chaneka goes through it in the right direction, she puts a new ball with a colour that is the same as the edge\'s colour to the top of the stack.  If Chaneka goes through it in the opposite direction, she removes the ball that is on the top of the stack. A walk is stackable if and only if the stack is not empty before each time Chaneka goes through an edge in the opposite direction.A walk is ball-stackable if and only if it is stackable and each time Chaneka goes through an edge in the opposite direction, the colour of the ball removed from the stack is the same as the colour of the edge traversed.Is it possible to direct all undirected edges and colour each edge such that all stackable walks are also ball-stackable? If it is possible, find a construction example that uses the maximum number of different colours among all valid ways of directing and colouring. If there are multiple such solutions, output any of them.\xe2\x80\xa0 A tree is a connected graph with no cycles." 3300
1876D Lexichromatography "combinatorics,dfs and similar,dsu,graphs,two pointers" "Pak Chanek loves his faculty, the Faculty of Computer Science, University of Indonesia (Fasilkom). He wants to play with the colours of the faculty\'s logo, blue and red.There is an array a consisting of n elements, element i has a value of ai. Pak Chanek wants to colour each element in the array blue or red such that these following conditions are satisfied:   If all blue elements are formed into a subsequence\xe2\x80\xa0 and so are all the red elements, the blue subsequence is strictly less than the red subsequence lexicographically\xe2\x80\xa1.  Array a does not have any subarray that is imbalanced. A subarray is imbalanced if and only if there is a value k such that the absolute difference between the number of blue elements with value k and the number of red elements with value k in this subarray is 2 or more.  Note that it is possible to colour every element of the array the same colour. How many different colourings satisfy all those conditions? Since the answer can be very big, print the answer modulo 998244353. Two colourings are different if and only if there is at least one element that is blue in one colouring, but red in the other.\xe2\x80\xa0 A subsequence of an array is a sequence that can be obtained from the array by deleting some elements (possibly none), without changing the order of the remaining elements.\xe2\x80\xa1 Let p and q be two different sequences. Sequence p is said to be lexicographically less than sequence q if and only if p is a prefix of q or there is an index i such that pj=qj holds for every 1\xe2\x89\xa4j<i, and pi<qi. In particular, an empty sequence is always lexicographically less than any non-empty sequence." 2500
1876C Autosynthesis "constructive algorithms,dfs and similar,graphs,greedy,sortings" "Chaneka writes down an array a of n positive integer elements. Initially, all elements are not circled. In one operation, Chaneka can circle an element. It is possible to circle the same element more than once.After doing all operations, Chaneka makes a sequence r consisting of all uncircled elements of a following the order of their indices.Chaneka also makes another sequence p such that its length is equal to the number of operations performed and pi is the index of the element that is circled in the i-th operation.Chaneka wants to do several operations such that sequence r is equal to sequence p. Help her achieve this, or report if it is impossible! Note that if there are multiple solutions, you can print any of them." 2100
1876B "Effects of Anti Pimples" "combinatorics,number theory,sortings" "Chaneka has an array [a1,a2,\xe2\x80\xa6,an]. Initially, all elements are white. Chaneka will choose one or more different indices and colour the elements at those chosen indices black. Then, she will choose all white elements whose indices are multiples of the index of at least one black element and colour those elements green. After that, her score is the maximum value of ai out of all black and green elements.There are 2n\xe2\x88\x921 ways for Chaneka to choose the black indices. Find the sum of scores for all possible ways Chaneka can choose the black indices. Since the answer can be very big, print the answer modulo 998244353." 1500
1876A "Helmets in Night Light" greedy,sortings "Pak Chanek is the chief of a village named Khuntien. On one night filled with lights, Pak Chanek has a sudden and important announcement that needs to be notified to all of the n residents in Khuntien.First, Pak Chanek shares the announcement directly to one or more residents with a cost of p for each person. After that, the residents can share the announcement to other residents using a magical helmet-shaped device. However, there is a cost for using the helmet-shaped device. For each i, if the i-th resident has got the announcement at least once (either directly from Pak Chanek or from another resident), he/she can share the announcement to at most ai other residents with a cost of bi for each share.If Pak Chanek can also control how the residents share the announcement to other residents, what is the minimum cost for Pak Chanek to notify all n residents of Khuntien about the announcement?" 1000
1875D "Jellyfish and Mex" dp "You are given an array of n nonnegative integers a1,a2,\xe2\x80\xa6,an. Let m be a variable that is initialized to 0, Jellyfish will perform the following operation n times:  select an index i (1\xe2\x89\xa4i\xe2\x89\xa4|a|) and delete ai from a.  add MEX(a)\xe2\x80\xa0 to m. Now Jellyfish wants to know the minimum possible final value of m if he performs all the operations optimally.\xe2\x80\xa0 The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:  The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4 because 0, 1, 2, and 3 belong to the array, but 4 does not." 1600
1875C "Jellyfish and Green Apple" "bitmasks,greedy,math,number theory" "Jellyfish has n green apple pieces. Each green apple piece weighs 1 kg. Jellyfish wants to divide these green apple pieces equally among m people.Jellyfish has a magic knife. Each time Jellyfish can choose one piece of green apple and divide it into two smaller pieces, with each piece having half the weight of the original piece.Jellyfish wants to know the minimum number of operations needed such that she can divide the green apple pieces such that the total weight of apple pieces received by each person is the same." 1400
1875A "Jellyfish and Undertale" "brute force,greedy" "Flowey has planted a bomb in Snowdin!The bomb has a timer that is initially set to b. Every second, the timer will decrease by 1. When the timer reaches 0, the bomb will explode! To give the residents of Snowdin enough time to evacuate, you will need to delay the bomb from exploding for as long as possible.You have n tools. Each tool can only be used at most once. If you use the i-th tool, the timer will increase by xi. However, if the timer is changed to an integer larger than a, the timer will be set to a due to a bug.More specifically, the following events will happen every second in the following order:  You will choose some (possibly none) of your tools that have not been used before. If you choose the i-th tool, and the bomb\'s timer is currently set to c, the timer will be changed to min(c+xi,a).  The timer decreases by 1.  If the timer reaches 0, the bomb explodes. Jellyfish now wants to know the maximum time in seconds until the bomb explodes if the tools are used optimally." 900
1874G "Jellyfish and Inscryption" dp "Jellyfish loves playing a game called ""Inscryption"" which is played on a directed acyclic graph with n vertices and m edges. All edges a\xe2\x86\x92b satisfy a<b.You need to move from vertex 1 to vertex n along the directed edges, and then fight with the final boss.You will collect cards and props in the process.Each card has two attributes: HP and damage. If a card\'s HP is a and its damage is b, then the power of the card is a\xc3\x97b.Each prop has only one attribute: power.In addition to vertex 1 and vertex n, there are some vertices that trigger special events. The special events are:  You will get a card with a HP, and b damage.  If you have at least one card, choose one of your cards and increase its HP by x.  If you have at least one card, choose one of your cards and increase its damage by y.  You will get a prop with w power. When you get to vertex n, you can choose at most one of your cards and multiply its damage by 109.The final boss is very strong, so you want to maximize the sum of the power of all your cards and props. Find the maximum possible sum of power of all your cards and props if you play the game optimally." 3500
1874F "Jellyfish and OEIS" dp "Jellyfish always uses OEIS to solve math problems, but now she finds a problem that cannot be solved by OEIS:Count the number of permutations p of [1,2,\xe2\x80\xa6,n] such that for all (l,r) such that l\xe2\x89\xa4r\xe2\x89\xa4ml, the subarray [pl,pl+1,\xe2\x80\xa6,pr] is not a permutation of [l,l+1,\xe2\x80\xa6,r].Since the answer may be large, you only need to find the answer modulo 109+7." 3500
1874E "Jellyfish and Hack" dp,math "It is well known that quick sort works by randomly selecting a \'pivot\' element from the array and partitioning the other elements into two sub-arrays, according to whether they are less than or greater than the pivot. But Jellyfish thinks that choosing a random element is just a waste of time, so she always chooses the first element to be the pivot. The time her code needs to run can be calculated by the following pseudocode:function fun(A)    if A.length > 0        let L[1 ... L.length] and R[1 ... R.length] be new arrays        L.length = R.length = 0        for i = 2 to A.length            if A[i] < A[1]                L.length = L.length + 1                L[L.length] = A[i]            else                R.length = R.length + 1                R[R.length] = A[i]        return A.length + fun(L) + fun(R)    else        return 0Now you want to show her that her code is slow. When the function fun(A) is greater than or equal to lim, her code will get Time Limit Exceeded. You want to know how many distinct permutations P of [1,2,\xe2\x80\xa6,n] satisfies fun(P)\xe2\x89\xa5lim. Because the answer may be large, you will only need to find the answer modulo 109+7." 3000
1874D "Jellyfish and Miku" "divide and conquer,dp,math,probabilities" "There are n+1 cities with numbers from 0 to n, connected by n roads. The i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) road connects city i\xe2\x88\x921 and city i bi-directionally. After Jellyfish flew back to city 0, she found out that she had left her Miku fufu in city n.Each road has a positive integer level of beauty. Denote the beauty of the i-th road as ai.Jellyfish is trying to find her fufu. Because of her poor sense of direction, she doesn\'t know which way to go. Every day, she randomly chooses a road connected to the city she currently is in and traverses it. Let s be the sum of the beauty of the roads connected to the current city. For each road connected to the current city, Jellyfish will traverse the road with a probability of xs, where x is the beauty of the road, reaching the city on the other side of the road.Jellyfish will start at city 0, and she will get only her fufu back when she reaches city n.You want to choose the beauty of the roads such that the expected number of days Jellyfish takes to find her fufu will be the minimum possible. However, due to limited funding, the sum of beauties of all roads must be less than or equal to m. Find the minimum expected number of days Jellyfish needs to get her fufu back if the beauty of the roads is chosen optimally." 2800
1874C "Jellyfish and EVA" dp,graphs,greedy,math,probabilities "Monsters have invaded the town again! Asuka invites her good friend, Jellyfish, to drive EVA with her.There are n cities in the town. All the monsters are in city n. Jellyfish and Asuka are currently in city 1 and need to move to city n to defeat the monsters.There are m roads. The i-th road allows one to travel from city ai to city bi. All the roads are directed. That is, one cannot travel from city bi to ai using the i-th road. Interestingly, all roads satisfy ai<bi.Driving EVA requires two people to work together. However, Asuka and Jellyfish have not done any training together before.Suppose that EVA is currently in city u. Jellyfish and Asuka will both choose an undestroyed road that starts at city u. Suppose Jellyfish and Asuka choose roads that end at cities v1 and v2 respectively. If v1=v2, EVA moves to city v1 successfully. Otherwise, EVA stays in city u and both roads that they have chosen will be destroyed.It is possible that EVA is currently in city u (u\xe2\x89\xa0n) and there are no undestroyed roads that start at city u. In that case, the mission will be a failure. Otherwise, if they reach city n in the end, the mission is considered a success.Every time they choose the roads, Jellyfish knows that Asuka will choose a road randomly. Now, Jellyfish wants to know, if she chooses the roads optimally, what is the maximum probability of the mission being successful." 2300
1874B "Jellyfish and Math" "bitmasks,brute force,dfs and similar,dp,graphs,shortest paths" "Jellyfish is given the non-negative integers a, b, c, d and m. Initially (x,y)=(a,b). Jellyfish wants to do several operations so that (x,y)=(c,d).For each operation, she can do one of the following:  x:=x&y,  x:=x|y,  y:=x\xe2\x8a\x95y,  y:=y\xe2\x8a\x95m. Here & denotes the bitwise AND operation, | denotes the bitwise OR operation and \xe2\x8a\x95 denotes the bitwise XOR operation.Now Jellyfish asks you for the minimum number of operations such that (x,y)=(c,d)." 2400
1874A "Jellyfish and Game" "brute force,games,greedy,implementation" "Jellyfish has n green apples with values a1,a2,\xe2\x80\xa6,an and Gellyfish has m green apples with values b1,b2,\xe2\x80\xa6,bm.They will play a game with k rounds. For i=1,2,\xe2\x80\xa6,k in this order, they will perform the following actions:   If i is odd, Jellyfish can choose to swap one of her apples with one of Gellyfish\'s apples or do nothing.  If i is even, Gellyfish can choose to swap one of his apples with one of Jellyfish\'s apples or do nothing. Both players want to maximize the sum of the values of their apples.Since you are one of the smartest people in the world, Jellyfish wants you to tell her the final sum of the value of her apples after all k rounds of the game. Assume that both Jellyfish and Gellyfish play optimally to maximize the sum of values of their apples." 1200
1873H "Mad City" "dfs and similar,dsu,games,graphs,shortest paths,trees" "Marcel and Valeriu are in the mad city, which is represented by n buildings with n two-way roads between them. Marcel and Valeriu start at buildings a and b respectively. Marcel wants to catch Valeriu, in other words, be in the same building as him or meet on the same road. During each move, they choose to go to an adjacent building of their current one or stay in the same building. Because Valeriu knows Marcel so well, Valeriu can predict where Marcel will go in the next move. Valeriu can use this information to make his move. They start and end the move at the same time.It is guaranteed that any pair of buildings is connected by some path and there is at most one road between any pair of buildings.Assuming both players play optimally, answer if Valeriu has a strategy to indefinitely escape Marcel." 1700
1873G "ABBC or BACB" "constructive algorithms,greedy" "You are given a string s made up of characters A and B. Initially you have no coins. You can perform two types of operations:   Pick a substring\xe2\x80\xa0 AB, change it to BC, and get a coin.  Pick a substring\xe2\x80\xa0 BA, change it to CB, and get a coin.  What is the most number of coins you can obtain?\xe2\x80\xa0 A substring of length 2 is a sequence of two adjacent characters of a string." 1500
