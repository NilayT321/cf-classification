1209G1 "Into Blocks (easy version)" "data structures,dsu,greedy,implementation,two pointers" "This is an easier version of the next problem. In this version, q=0.A sequence of integers is called nice if its elements are arranged in blocks like in [3,3,3,4,1,1]. Formally, if two elements are equal, everything in between must also be equal.Let\'s define difficulty of a sequence as a minimum possible number of elements to change to get a nice sequence. However, if you change at least one element of value x to value y, you must also change all other elements of value x into y as well. For example, for [3,3,1,3,2,1,2] it isn\'t allowed to change first 1 to 3 and second 1 to 2. You need to leave 1\'s untouched or change them to the same value.You are given a sequence of integers a1,a2,\xe2\x80\xa6,an and q updates.Each update is of form ""i x""�\xe2\x80\x94 change ai to x. Updates are not independent (the change stays for the future).Print the difficulty of the initial sequence and of the sequence after every update." 2000

1209F "Koala and Notebook" "data structures,dfs and similar,graphs,shortest paths,strings,trees" "Koala Land consists of m bidirectional roads connecting n cities. The roads are numbered from 1 to m by order in input. It is guaranteed, that one can reach any city from every other city.Koala starts traveling from city 1. Whenever he travels on a road, he writes its number down in his notebook. He doesn\'t put spaces between the numbers, so they all get concatenated into a single number.Before embarking on his trip, Koala is curious about the resulting number for all possible destinations. For each possible destination, what is the smallest number he could have written for it?Since these numbers may be quite large, print their remainders modulo 109+7. Please note, that you need to compute the remainder of the minimum possible number, not the minimum possible remainder." 2600

1209E2 "Rotate Columns (hard version)" bitmasks,dp,greedy,sortings "This is a harder version of the problem. The difference is only in constraints.You are given a rectangular n\xc3\x97m matrix a. In one move you can choose any column and cyclically shift elements in this column. You can perform this operation as many times as you want (possibly zero). You can perform this operation to a column multiple times.After you are done with cyclical shifts, you compute for every row the maximal value in it. Suppose that for i-th row it is equal ri. What is the maximal possible value of r1+r2+\xe2\x80\xa6+rn?" 2500

1209E1 "Rotate Columns (easy version)" "bitmasks,brute force,dp,greedy,sortings" "This is an easier version of the next problem. The difference is only in constraints.You are given a rectangular n\xc3\x97m matrix a. In one move you can choose any column and cyclically shift elements in this column. You can perform this operation as many times as you want (possibly zero). You can perform this operation to a column multiple times.After you are done with cyclical shifts, you compute for every row the maximal value in it. Suppose that for i-th row it is equal ri. What is the maximal possible value of r1+r2+\xe2\x80\xa6+rn?" 2000

1209D "Cow and Snacks" "dfs and similar,dsu,graphs" "The legendary Farmer John is throwing a huge party, and animals from all over the world are hanging out at his house. His guests are hungry, so he instructs his cow Bessie to bring out the snacks! Moo!There are n snacks flavors, numbered with integers 1,2,\xe2\x80\xa6,n. Bessie has n snacks, one snack of each flavor. Every guest has exactly two favorite flavors. The procedure for eating snacks will go as follows:  First, Bessie will line up the guests in some way.  Then in this order, guests will approach the snacks one by one.  Each guest in their turn will eat all remaining snacks of their favorite flavor. In case no favorite flavors are present when a guest goes up, they become very sad.  Help Bessie to minimize the number of sad guests by lining the guests in an optimal way." 1700

1209C "Paint the Digits" "constructive algorithms,greedy,implementation" "You are given a sequence of n digits d1d2\xe2\x80\xa6dn. You need to paint all the digits in two colors so that:  each digit is painted either in the color 1 or in the color 2;  if you write in a row from left to right all the digits painted in the color 1, and then after them all the digits painted in the color 2, then the resulting sequence of n digits will be non-decreasing (that is, each next digit will be greater than or equal to the previous digit). For example, for the sequence d=914 the only valid coloring is 211 (paint in the color 1 two last digits, paint in the color 2 the first digit). But 122 is not a valid coloring (9 concatenated with 14 is not a non-decreasing sequence).It is allowed that either of the two colors is not used at all. Digits painted in the same color are not required to have consecutive positions.Find any of the valid ways to paint the given sequence of digits or determine that it is impossible to do." 1500

1209B "Koala and Lights" "implementation,math,number theory" "It is a holiday season, and Koala is decorating his house with cool lights! He owns n lights, all of which flash periodically.After taking a quick glance at them, Koala realizes that each of his lights can be described with two parameters ai and bi. Light with parameters ai and bi will toggle (on to off, or off to on) every ai seconds starting from the bi-th second. In other words, it will toggle at the moments bi, bi+ai, bi+2\xe2\x8b\x85ai and so on.You know for each light whether it\'s initially on or off and its corresponding parameters ai and bi. Koala is wondering what is the maximum number of lights that will ever be on at the same time. So you need to find that out.  Here is a graphic for the first example." 1300

1209A "Paint the Numbers" greedy,implementation,math "You are given a sequence of integers a1,a2,\xe2\x80\xa6,an. You need to paint elements in colors, so that:   If we consider any color, all elements of this color must be divisible by the minimal element of this color.  The number of used colors must be minimized. For example, it\'s fine to paint elements [40,10,60] in a single color, because they are all divisible by 10. You can use any color an arbitrary amount of times (in particular, it is allowed to use a color only once). The elements painted in one color do not need to be consecutive.For example, if a=[6,2,3,4,12] then two colors are required: let\'s paint 6, 3 and 12 in the first color (6, 3 and 12 are divisible by 3) and paint 2 and 4 in the second color (2 and 4 are divisible by 2). For example, if a=[10,7,15] then 3 colors are required (we can simply paint each element in an unique color)." 800

1208H "Red Blue Tree" "data structures,implementation,trees" "You are given a tree of n nodes. The tree is rooted at node 1, which is not considered as a leaf regardless of its degree.Each leaf of the tree has one of the two colors: red or blue. Leaf node v initially has color sv.The color of each of the internal nodes (including the root) is determined as follows.   Let b be the number of blue immediate children, and r be the number of red immediate children of a given vertex.  Then the color of this vertex is blue if and only if b\xe2\x88\x92r\xe2\x89\xa5k, otherwise red. Integer k is a parameter that is same for all the nodes.You need to handle the following types of queries:   1 v: print the color of node v;  2 v c: change the color of leaf v to c (c=0 means red, c=1 means blue);  3 h: update the current value of k to h." 3500

1208G Polygons "greedy,math,number theory" "You are given two integers n and k.You need to construct k regular polygons having same circumcircle, with distinct number of sides l between 3 and n.   Illustration for the first example. You can rotate them to minimize the total number of distinct points on the circle. Find the minimum number of such points." 2800

1208F "Bits And Pieces" "bitmasks,dfs and similar,dp,greedy" "You are given an array a of n integers.You need to find the maximum value of ai|(aj&ak) over all triplets (i,j,k) such that i<j<k.Here & denotes the bitwise AND operation, and | denotes the bitwise OR operation." 2600

1208E "Let Them Slide" "data structures,implementation" "You are given n arrays that can have different sizes. You also have a table with w columns and n rows. The i-th array is placed horizontally in the i-th row. You can slide each array within its row as long as it occupies several consecutive cells and lies completely inside the table.You need to find the maximum sum of the integers in the j-th column for each j from 1 to w independently.  Optimal placements for columns 1, 2 and 3 are shown on the pictures from left to right. Note that you can exclude any array out of a column provided it remains in the window. In this case its value is considered to be zero." 2200

1208D "Restore Permutation" "binary search,data structures,greedy,implementation" "An array of integers p1,p2,\xe2\x80\xa6,pn is called a permutation if it contains each number from 1 to n exactly once. For example, the following arrays are permutations: [3,1,2],[1],[1,2,3,4,5] and [4,3,1,2]. The following arrays are not permutations: [2],[1,1],[2,3,4].There is a hidden permutation of length n.For each index i, you are given si, which equals to the sum of all pj such that j<i and pj<pi. In other words, si is the sum of elements before the i-th element that are smaller than the i-th element.Your task is to restore the permutation." 1900

1208C "Magic Grid" "constructive algorithms" "Let us define a magic grid to be a square matrix of integers of size n\xc3\x97n, satisfying the following conditions.   All integers from 0 to (n2\xe2\x88\x921) inclusive appear in the matrix exactly once.  Bitwise XOR of all elements in a row or a column must be the same for each row and column. You are given an integer n which is a multiple of 4. Construct a magic grid of size n\xc3\x97n." 1800

1208B Uniqueness "binary search,brute force,implementation,two pointers" "You are given an array a1,a2,\xe2\x80\xa6,an. You can remove at most one subsegment from it. The remaining elements should be pairwise distinct.In other words, at most one time you can choose two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and delete integers al,al+1,\xe2\x80\xa6,ar from the array. Remaining elements should be pairwise distinct. Find the minimum size of the subsegment you need to remove to make all remaining elements distinct." 1500

1208A XORinacci math "Cengiz recently learned Fibonacci numbers and now he is studying different algorithms to find them. After getting bored of reading them, he came with his own new type of numbers that he named XORinacci numbers. He defined them as follows:   f(0)=a;  f(1)=b;  f(n)=f(n\xe2\x88\x921)\xe2\x8a\x95f(n\xe2\x88\x922) when n>1, where \xe2\x8a\x95 denotes the bitwise XOR operation. You are given three integers a, b, and n, calculate f(n).You have to answer for T independent test cases." 900

1207G "Indie Album" "data structures,dfs and similar,hashing,string suffix structures,strings,trees" "Mishka\'s favourite experimental indie band has recently dropped a new album! Songs of that album share one gimmick. Each name si is one of the following types:  1�c \xe2\x80\x94 a single lowercase Latin letter;  2�j�c \xe2\x80\x94 name sj (1\xe2\x89\xa4j<i) with a single lowercase Latin letter appended to its end. Songs are numbered from 1 to n. It\'s guaranteed that the first song is always of type 1.Vova is rather interested in the new album but he really doesn\'t have the time to listen to it entirely. Thus he asks Mishka some questions about it to determine if some song is worth listening to. Questions have the following format:  i�t \xe2\x80\x94 count the number of occurrences of string t in si (the name of the i-th song of the album) as a continuous substring, t consists only of lowercase Latin letters. Mishka doesn\'t question the purpose of that information, yet he struggles to provide it. Can you please help Mishka answer all Vova\'s questions?" 2700

1207F "Remainder Problem" "brute force,data structures,implementation" "You are given an array a consisting of 500000 integers (numbered from 1 to 500000). Initially all elements of a are zero.You have to process two types of queries to this array:  1 x y�\xe2\x80\x94 increase ax by y;  2 x y�\xe2\x80\x94 compute \xe2\x88\x91i\xe2\x88\x88R(x,y)ai, where R(x,y) is the set of all integers from 1 to 500000 which have remainder y modulo x. Can you process all the queries?" 2100

1207E "XOR Guessing" bitmasks,interactive,math "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.The jury picked an integer x not less than 0 and not greater than 214\xe2\x88\x921. You have to guess this integer.To do so, you may ask no more than 2 queries. Each query should consist of 100 integer numbers a1, a2, ..., a100 (each integer should be not less than 0 and not greater than 214\xe2\x88\x921). In response to your query, the jury will pick one integer i (1\xe2\x89\xa4i\xe2\x89\xa4100) and tell you the value of ai\xe2\x8a\x95x (the bitwise XOR of ai and x). There is an additional constraint on the queries: all 200 integers you use in the queries should be distinct.It is guaranteed that the value of x is fixed beforehand in each test, but the choice of i in every query may depend on the integers you send." 1900

1207D "Number Of Permutations" combinatorics "You are given a sequence of n pairs of integers: (a1,b1),(a2,b2),\xe2\x80\xa6,(an,bn). This sequence is called bad if it is sorted in non-descending order by first elements or if it is sorted in non-descending order by second elements. Otherwise the sequence is good. There are examples of good and bad sequences:  s=[(1,2),(3,2),(3,1)] is bad because the sequence of first elements is sorted: [1,3,3];  s=[(1,2),(3,2),(1,2)] is bad because the sequence of second elements is sorted: [2,2,2];  s=[(1,1),(2,2),(3,3)] is bad because both sequences (the sequence of first elements and the sequence of second elements) are sorted;  s=[(1,3),(3,3),(2,2)] is good because neither the sequence of first elements ([1,3,2]) nor the sequence of second elements ([3,3,2]) is sorted. Calculate the number of permutations of size n such that after applying this permutation to the sequence s it turns into a good sequence. A permutation p of size n is a sequence p1,p2,\xe2\x80\xa6,pn consisting of n distinct integers from 1 to n (1\xe2\x89\xa4pi\xe2\x89\xa4n). If you apply permutation p1,p2,\xe2\x80\xa6,pn to the sequence s1,s2,\xe2\x80\xa6,sn you get the sequence sp1,sp2,\xe2\x80\xa6,spn. For example, if s=[(1,2),(1,3),(2,3)] and p=[2,3,1] then s turns into [(1,3),(2,3),(1,2)]." 1800

1207C "Gas Pipeline" dp,greedy "You are responsible for installing a gas pipeline along a road. Let\'s consider the road (for simplicity) as a segment [0,n] on OX axis. The road can have several crossroads, but for simplicity, we\'ll denote each crossroad as an interval (x,x+1) with integer x. So we can represent the road as a binary string consisting of n characters, where character 0 means that current interval doesn\'t contain a crossroad, and 1 means that there is a crossroad.Usually, we can install the pipeline along the road on height of 1 unit with supporting pillars in each integer point (so, if we are responsible for [0,n] road, we must install n+1 pillars). But on crossroads we should lift the pipeline up to the height 2, so the pipeline won\'t obstruct the way for cars.We can do so inserting several zig-zag-like lines. Each zig-zag can be represented as a segment [x,x+1] with integer x consisting of three parts: 0.5 units of horizontal pipe + 1 unit of vertical pipe + 0.5 of horizontal. Note that if pipeline is currently on height 2, the pillars that support it should also have length equal to 2 units.  Each unit of gas pipeline costs us a bourles, and each unit of pillar \xe2\x80\x94 b bourles. So, it\'s not always optimal to make the whole pipeline on the height 2. Find the shape of the pipeline with minimum possible cost and calculate that cost.Note that you must start and finish the pipeline on height 1 and, also, it\'s guaranteed that the first and last characters of the input string are equal to 0." 1500

1207B "Square Filling" "constructive algorithms,greedy,implementation" "You are given two matrices A and B. Each matrix contains exactly n rows and m columns. Each element of A is either 0 or 1; each element of B is initially 0.You may perform some operations with matrix B. During each operation, you choose any submatrix of B having size 2\xc3\x972, and replace every element in the chosen submatrix with 1. In other words, you choose two integers x and y such that 1\xe2\x89\xa4x<n and 1\xe2\x89\xa4y<m, and then set Bx,y, Bx,y+1, Bx+1,y and Bx+1,y+1 to 1.Your goal is to make matrix B equal to matrix A. Two matrices A and B are equal if and only if every element of matrix A is equal to the corresponding element of matrix B.Is it possible to make these matrices equal? If it is, you have to come up with a sequence of operations that makes B equal to A. Note that you don\'t have to minimize the number of operations." 1200

1207A "There Are Two Types Of Burgers" "brute force,greedy,implementation,math" "There are two types of burgers in your restaurant \xe2\x80\x94 hamburgers and chicken burgers! To assemble a hamburger you need two buns and a beef patty. To assemble a chicken burger you need two buns and a chicken cutlet. You have b buns, p beef patties and f chicken cutlets in your restaurant. You can sell one hamburger for h dollars and one chicken burger for c dollars. Calculate the maximum profit you can achieve.You have to answer t independent queries." 800

1206B "Make Product Equal One" dp,implementation "You are given n numbers a1,a2,\xe2\x80\xa6,an. With a cost of one coin you can perform the following operation:Choose one of these numbers and add or subtract 1 from it.In particular, we can apply this operation to the same number several times.We want to make the product of all these numbers equal to 1, in other words, we want a1\xe2\x8b\x85a2 \xe2\x80\xa6 \xe2\x8b\x85an=1. For example, for n=3 and numbers [1,\xe2\x88\x923,0] we can make product equal to 1 in 3 coins: add 1 to second element, add 1 to second element again, subtract 1 from third element, so that array becomes [1,\xe2\x88\x921,\xe2\x88\x921]. And 1\xe2\x8b\x85(\xe2\x88\x921)\xe2\x8b\x85(\xe2\x88\x921)=1.What is the minimum cost we will have to pay to do that?" 900

1206A "Choose Two Numbers" math,sortings "You are given an array A, consisting of n positive integers a1,a2,\xe2\x80\xa6,an, and an array B, consisting of m positive integers b1,b2,\xe2\x80\xa6,bm. Choose some element a of A and some element b of B such that a+b doesn\'t belong to A and doesn\'t belong to B. For example, if A=[2,1,7] and B=[1,3,4], we can choose 1 from A and 4 from B, as number 5=1+4 doesn\'t belong to A and doesn\'t belong to B. However, we can\'t choose 2 from A and 1 from B, as 3=2+1 belongs to B.It can be shown that such a pair exists. If there are multiple answers, print any.Choose and print any such two numbers." 800

1205F "Beauty of a Permutation" "constructive algorithms,math" "Define the beauty of a permutation of numbers from 1 to n (p1,p2,\xe2\x80\xa6,pn) as number of pairs (L,R) such that 1\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa4n and numbers pL,pL+1,\xe2\x80\xa6,pR are consecutive R\xe2\x88\x92L+1 numbers in some order. For example, the beauty of the permutation (1,2,5,3,4) equals 9, and segments, corresponding to pairs, are [1], [2], [5], [4], [3], [1,2], [3,4], [5,3,4], [1,2,5,3,4].Answer q independent queries. In each query, you will be given integers n and k. Determine if there exists a permutation of numbers from 1 to n with beauty equal to k, and if there exists, output one of them." 3400

1205E "Expected Value Again" combinatorics,strings "You are given integers n, k. Let\'s consider the alphabet consisting of k different elements.Let beauty f(s) of the string s be the number of indexes i, 1\xe2\x89\xa4i<|s|, for which prefix of s of length i equals to suffix of s of length i. For example, beauty of the string abacaba equals 2, as for i=1,3 prefix and suffix of length i are equal.Consider all words of length n in the given alphabet. Find the expected value of f(s)2 of a uniformly chosen at random word. We can show that it can be expressed as PQ, where P and Q are coprime and Q isn\'t divided by 109+7. Output P\xe2\x8b\x85Q\xe2\x88\x921mod109+7." 3100

1205D "Almost All" "constructive algorithms,trees" "You are given a tree with n nodes. You have to write non-negative integers on its edges so that the following condition would be satisfied:For every two nodes i, j, look at the path between them and count the sum of numbers on the edges of this path. Write all obtained sums on the blackboard. Then every integer from 1 to \xe2\x8c\x8a2n29\xe2\x8c\x8b has to be written on the blackboard at least once. It is guaranteed that such an arrangement exists." 2700

1205C "Palindromic Paths" implementation,interactive "This is an interactive problemYou are given a grid n\xc3\x97n, where n is odd. Rows are enumerated from 1 to n from up to down, columns are enumerated from 1 to n from left to right. Cell, standing on the intersection of row x and column y, is denoted by (x,y).Every cell contains 0 or 1. It is known that the top-left cell contains 1, and the bottom-right cell contains 0.We want to know numbers in all cells of the grid. To do so we can ask the following questions: ""? x1 y1 x2 y2"", where 1\xe2\x89\xa4x1\xe2\x89\xa4x2\xe2\x89\xa4n, 1\xe2\x89\xa4y1\xe2\x89\xa4y2\xe2\x89\xa4n, and x1+y1+2\xe2\x89\xa4x2+y2. In other words, we output two different cells (x1,y1), (x2,y2) of the grid such that we can get from the first to the second by moving only to the right and down, and they aren\'t adjacent.As a response to such question you will be told if there exists a path between (x1,y1) and (x2,y2), going only to the right or down, numbers in cells of which form a palindrome.For example, paths, shown in green, are palindromic, so answer for ""? 1 1 2 3"" and ""? 1 2 3 3"" would be that there exists such path. However, there is no palindromic path between (1,1) and (3,1).  Determine all cells of the grid by asking not more than n2 questions. It can be shown that the answer always exists." 2400

1205B "Shortest Cycle" "bitmasks,brute force,graphs,shortest paths" "You are given n integer numbers a1,a2,\xe2\x80\xa6,an. Consider graph on n nodes, in which nodes i, j (i\xe2\x89\xa0j) are connected if and only if, ai AND aj\xe2\x89\xa00, where AND denotes the bitwise AND operation.Find the length of the shortest cycle in this graph or determine that it doesn\'t have cycles at all." 1900

1205A "Almost Equal" "constructive algorithms,greedy,math" "You are given integer n. You have to arrange numbers from 1 to 2n, using each of them exactly once, on the circle, so that the following condition would be satisfied:For every n consecutive numbers on the circle write their sum on the blackboard. Then any two of written on the blackboard 2n numbers differ not more than by 1.For example, choose n=3. On the left you can see an example of a valid arrangement: 1+4+5=10, 4+5+2=11, 5+2+3=10, 2+3+6=11, 3+6+1=10, 6+1+4=11, any two numbers differ by at most 1. On the right you can see an invalid arrangement: for example, 5+1+6=12, and 3+2+4=9, 9 and 12 differ more than by 1." 1200

1204E "Natasha, Sasha and the Prefix Sums" "combinatorics,dp,math,number theory" "Natasha\'s favourite numbers are n and 1, and Sasha\'s favourite numbers are m and \xe2\x88\x921. One day Natasha and Sasha met and wrote down every possible array of length n+m such that some n of its elements are equal to 1 and another m elements are equal to \xe2\x88\x921. For each such array they counted its maximal prefix sum, probably an empty one which is equal to 0 (in another words, if every nonempty prefix sum is less to zero, then it is considered equal to zero). Formally, denote as f(a) the maximal prefix sum of an array a1,\xe2\x80\xa6,l of length l\xe2\x89\xa50. Then: f(a)=max(0,max1\xe2\x89\xa4i\xe2\x89\xa4li\xe2\x88\x91j=1aj)Now they want to count the sum of maximal prefix sums for each such an array and they are asking you to help. As this sum can be very large, output it modulo 998244853." 2300

1204D2 "Kirk and a Binary String (hard version)" "data structures,greedy,math,strings" "The only difference between easy and hard versions is the length of the string. You can hack this problem if you solve it. But you can hack the previous problem only if you solve both problems.Kirk has a binary string s (a string which consists of zeroes and ones) of length n and he is asking you to find a binary string t of the same length which satisfies the following conditions: For any l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) the length of the longest non-decreasing subsequence of the substring slsl+1\xe2\x80\xa6sr is equal to the length of the longest non-decreasing subsequence of the substring tltl+1\xe2\x80\xa6tr; The number of zeroes in t is the maximum possible.A non-decreasing subsequence of a string p is a sequence of indices i1,i2,\xe2\x80\xa6,ik such that i1<i2<\xe2\x80\xa6<ik and pi1\xe2\x89\xa4pi2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4pik. The length of the subsequence is k.If there are multiple substrings which satisfy the conditions, output any." 2100

1204D1 "Kirk and a Binary String (easy version)" "brute force,greedy,strings" "The only difference between easy and hard versions is the length of the string. You can hack this problem only if you solve both problems.Kirk has a binary string s (a string which consists of zeroes and ones) of length n and he is asking you to find a binary string t of the same length which satisfies the following conditions: For any l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) the length of the longest non-decreasing subsequence of the substring slsl+1\xe2\x80\xa6sr is equal to the length of the longest non-decreasing subsequence of the substring tltl+1\xe2\x80\xa6tr; The number of zeroes in t is the maximum possible.A non-decreasing subsequence of a string p is a sequence of indices i1,i2,\xe2\x80\xa6,ik such that i1<i2<\xe2\x80\xa6<ik and pi1\xe2\x89\xa4pi2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4pik. The length of the subsequence is k.If there are multiple substrings which satisfy the conditions, output any." 2000

1204C "Anna, Svyatoslav and Maps" "dp,graphs,greedy,shortest paths" "The main characters have been omitted to be short.You are given a directed unweighted graph without loops with n vertexes and a path in it (that path is not necessary simple) given by a sequence p1,p2,\xe2\x80\xa6,pm of m vertexes; for each 1\xe2\x89\xa4i<m there is an arc from pi to pi+1.Define the sequence v1,v2,\xe2\x80\xa6,vk of k vertexes as good, if v is a subsequence of p, v1=p1, vk=pm, and p is one of the shortest paths passing through the vertexes v1, \xe2\x80\xa6, vk in that order.A sequence a is a subsequence of a sequence b if a can be obtained from b by deletion of several (possibly, zero or all) elements. It is obvious that the sequence p is good but your task is to find the shortest good subsequence.If there are multiple shortest good subsequences, output any of them." 1700

1204B "Mislove Has Lost an Array" greedy,math "Mislove had an array a1, a2, \xe2\x8b\xaf, an of n positive integers, but he has lost it. He only remembers the following facts about it: The number of different numbers in the array is not less than l and is not greater than r; For each array\'s element ai either ai=1 or ai is even and there is a number ai2 in the array.For example, if n=5, l=2, r=3 then an array could be [1,2,2,4,4] or [1,1,1,1,2]; but it couldn\'t be [1,2,2,4,8] because this array contains 4 different numbers; it couldn\'t be [1,2,2,3,3] because 3 is odd and isn\'t equal to 1; and it couldn\'t be [1,1,2,2,16] because there is a number 16 in the array but there isn\'t a number 162=8.According to these facts, he is asking you to count the minimal and the maximal possible sums of all elements in an array." 900

1204A "BowWow and the Timetable" math "In the city of Saint Petersburg, a day lasts for 2100 minutes. From the main station of Saint Petersburg, a train departs after 1 minute, 4 minutes, 16 minutes, and so on; in other words, the train departs at time 4k for each integer k\xe2\x89\xa50. Team BowWow has arrived at the station at the time s and it is trying to count how many trains have they missed; in other words, the number of trains that have departed strictly before time s. For example if s=20, then they missed trains which have departed at 1, 4 and 16. As you are the only one who knows the time, help them!Note that the number s will be given you in a binary representation without leading zeroes." 1000

1203F2 "Complete the Projects (hard version)" dp,greedy "The only difference between easy and hard versions is that you should complete all the projects in easy version but this is not necessary in hard version.Polycarp is a very famous freelancer. His current rating is r units.Some very rich customers asked him to complete some projects for their companies. To complete the i-th project, Polycarp needs to have at least ai units of rating; after he completes this project, his rating will change by bi (his rating will increase or decrease by bi) (bi can be positive or negative). Polycarp\'s rating should not fall below zero because then people won\'t trust such a low rated freelancer.Polycarp can choose the order in which he completes projects. Furthermore, he can even skip some projects altogether.To gain more experience (and money, of course) Polycarp wants to choose the subset of projects having maximum possible size and the order in which he will complete them, so he has enough rating before starting each project, and has non-negative rating after completing each project.Your task is to calculate the maximum possible size of such subset of projects." 2300

1203F1 "Complete the Projects (easy version)" greedy "The only difference between easy and hard versions is that you should complete all the projects in easy version but this is not necessary in hard version.Polycarp is a very famous freelancer. His current rating is r units.Some very rich customers asked him to complete some projects for their companies. To complete the i-th project, Polycarp needs to have at least ai units of rating; after he completes this project, his rating will change by bi (his rating will increase or decrease by bi) (bi can be positive or negative). Polycarp\'s rating should not fall below zero because then people won\'t trust such a low rated freelancer.Is it possible to complete all the projects? Formally, write a program to check if such an order of the projects exists, that Polycarp has enough rating before starting each project, and he has non-negative rating after completing each project.In other words, you have to check that there exists such an order of projects in which Polycarp will complete them, so he has enough rating before starting each project, and has non-negative rating after completing each project." 2100

1203E Boxers greedy,sortings "There are n boxers, the weight of the i-th boxer is ai. Each of them can change the weight by no more than 1 before the competition (the weight cannot become equal to zero, that is, it must remain positive). Weight is always an integer number.It is necessary to choose the largest boxing team in terms of the number of people, that all the boxers\' weights in the team are different (i.e. unique).Write a program that for given current values \xe2\x80\x8bai will find the maximum possible number of boxers in a team.It is possible that after some change the weight of some boxer is 150001 (but no more)." 1500

1203D2 "Remove the Substring (hard version)" "binary search,greedy,implementation,two pointers" "The only difference between easy and hard versions is the length of the string.You are given a string s and a string t, both consisting only of lowercase Latin letters. It is guaranteed that t can be obtained from s by removing some (possibly, zero) number of characters (not necessary contiguous) from s without changing order of remaining characters (in other words, it is guaranteed that t is a subsequence of s).For example, the strings ""test"", ""tst"", ""tt"", ""et"" and """" are subsequences of the string ""test"". But the strings ""tset"", ""se"", ""contest"" are not subsequences of the string ""test"".You want to remove some substring (contiguous subsequence) from s of maximum possible length such that after removing this substring t will remain a subsequence of s.If you want to remove the substring s[l;r] then the string s will be transformed to s1s2\xe2\x80\xa6sl\xe2\x88\x921sr+1sr+2\xe2\x80\xa6s|s|\xe2\x88\x921s|s| (where |s| is the length of s).Your task is to find the maximum possible length of the substring you can remove so that t is still a subsequence of s." 1700

1203D1 "Remove the Substring (easy version)" greedy,implementation "The only difference between easy and hard versions is the length of the string.You are given a string s and a string t, both consisting only of lowercase Latin letters. It is guaranteed that t can be obtained from s by removing some (possibly, zero) number of characters (not necessary contiguous) from s without changing order of remaining characters (in other words, it is guaranteed that t is a subsequence of s).For example, the strings ""test"", ""tst"", ""tt"", ""et"" and """" are subsequences of the string ""test"". But the strings ""tset"", ""se"", ""contest"" are not subsequences of the string ""test"".You want to remove some substring (contiguous subsequence) from s of maximum possible length such that after removing this substring t will remain a subsequence of s.If you want to remove the substring s[l;r] then the string s will be transformed to s1s2\xe2\x80\xa6sl\xe2\x88\x921sr+1sr+2\xe2\x80\xa6s|s|\xe2\x88\x921s|s| (where |s| is the length of s).Your task is to find the maximum possible length of the substring you can remove so that t is still a subsequence of s." 1600

1203C "Common Divisors" implementation,math "You are given an array a consisting of n integers.Your task is to say the number of such positive integers x such that x divides each number from the array. In other words, you have to find the number of common divisors of all elements in the array.For example, if the array a will be [2,4,6,2,10], then 1 and 2 divide each number from the array (so the answer for this test is 2)." 1300

1203B "Equal Rectangles" greedy,math "You are given 4n sticks, the length of the i-th stick is ai.You have to create n rectangles, each rectangle will consist of exactly 4 sticks from the given set. The rectangle consists of four sides, opposite sides should have equal length and all angles in it should be right. Note that each stick can be used in only one rectangle. Each stick should be used as a side, you cannot break the stick or use it not to the full length.You want to all rectangles to have equal area. The area of the rectangle with sides a and b is a\xe2\x8b\x85b.Your task is to say if it is possible to create exactly n rectangles of equal area or not.You have to answer q independent queries." 1200

1203A "Circle of Students" implementation "There are n students standing in a circle in some order. The index of the i-th student is pi. It is guaranteed that all indices of students are distinct integers from 1 to n (i.\xe2\x80\x89e. they form a permutation).Students want to start a round dance. A clockwise round dance can be started if the student 2 comes right after the student 1 in clockwise order (there are no students between them), the student 3 comes right after the student 2 in clockwise order, and so on, and the student n comes right after the student n\xe2\x88\x921 in clockwise order. A counterclockwise round dance is almost the same thing \xe2\x80\x94 the only difference is that the student i should be right after the student i\xe2\x88\x921 in counterclockwise order (this condition should be met for every i from 2 to n). For example, if the indices of students listed in clockwise order are [2,3,4,5,1], then they can start a clockwise round dance. If the students have indices [3,2,1,4] in clockwise order, then they can start a counterclockwise round dance.Your task is to determine whether it is possible to start a round dance. Note that the students cannot change their positions before starting the dance; they cannot swap or leave the circle, and no other student can enter the circle. You have to answer q independent queries." 1000

1202F "You Are Given Some Letters..." "binary search,implementation,math" "You are given a uppercase Latin letters \'A\' and b letters \'B\'.The period of the string is the smallest such positive integer k that si=si�mod�k (0-indexed) for each i. Note that this implies that k won\'t always divide a+b=|s|.For example, the period of string ""ABAABAA"" is 3, the period of ""AAAA"" is 1, and the period of ""AABBB"" is 5.Find the number of different periods over all possible strings with a letters \'A\' and b letters \'B\'." 2700

1202E "You Are Given Some Strings..." "brute force,string suffix structures,strings" "You are given a string t and n strings s1,s2,\xe2\x80\xa6,sn. All strings consist of lowercase Latin letters.Let f(t,s) be the number of occurences of string s in string t. For example, f(\xe2\x80\xb2aaabacaa\xe2\x80\xb2,\xe2\x80\xb2aa\xe2\x80\xb2)=3, and f(\xe2\x80\xb2ababa\xe2\x80\xb2,\xe2\x80\xb2aba\xe2\x80\xb2)=2.Calculate the value of n\xe2\x88\x91i=1n\xe2\x88\x91j=1f(t,si+sj), where s+t is the concatenation of strings s and t. Note that if there are two pairs i1, j1 and i2, j2 such that si1+sj1=si2+sj2, you should include both f(t,si1+sj1) and f(t,si2+sj2) in answer." 2400

1202D "Print a 1337-string..." "combinatorics,constructive algorithms,math,strings" "The subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements.You are given an integer n. You have to find a sequence s consisting of digits {1,3,7} such that it has exactly n subsequences equal to 1337.For example, sequence 337133377 has 6 subsequences equal to 1337:   3371_33_3_77_ (you can remove the second and fifth characters);  3371_3_33_77_ (you can remove the third and fifth characters);  3371_3_3_377_ (you can remove the fourth and fifth characters);  3371_33_3_7_7 (you can remove the second and sixth characters);  3371_3_33_7_7 (you can remove the third and sixth characters);  3371_3_3_37_7 (you can remove the fourth and sixth characters). Note that the length of the sequence s must not exceed 105.You have to answer t independent queries." 1900

1202C "You Are Given a WASD-string..." "brute force,data structures,dp,greedy,implementation,math,strings" "You have a string s \xe2\x80\x94 a sequence of commands for your toy robot. The robot is placed in some cell of a rectangular grid. He can perform four commands:  \'W\' \xe2\x80\x94 move one cell up;  \'S\' \xe2\x80\x94 move one cell down;  \'A\' \xe2\x80\x94 move one cell left;  \'D\' \xe2\x80\x94 move one cell right. Let Grid(s) be the grid of minimum possible area such that there is a position in the grid where you can place the robot in such a way that it will not fall from the grid while running the sequence of commands s. For example, if s=DSAWWAW then Grid(s) is the 4\xc3\x973 grid:  you can place the robot in the cell (3,2);  the robot performs the command \'D\' and moves to (3,3);  the robot performs the command \'S\' and moves to (4,3);  the robot performs the command \'A\' and moves to (4,2);  the robot performs the command \'W\' and moves to (3,2);  the robot performs the command \'W\' and moves to (2,2);  the robot performs the command \'A\' and moves to (2,1);  the robot performs the command \'W\' and moves to (1,1).   You have 4 extra letters: one \'W\', one \'A\', one \'S\', one \'D\'. You\'d like to insert at most one of these letters in any position of sequence s to minimize the area of Grid(s).What is the minimum area of Grid(s) you can achieve?" 2100

1202B "You Are Given a Decimal String..." "brute force,dp,shortest paths" "Suppose you have a special x-y-counter. This counter can store some value as a decimal number; at first, the counter has value 0. The counter performs the following algorithm: it prints its lowest digit and, after that, adds either x or y to its value. So all sequences this counter generates are starting from 0. For example, a 4-2-counter can act as follows:  it prints 0, and adds 4 to its value, so the current value is 4, and the output is 0;  it prints 4, and adds 4 to its value, so the current value is 8, and the output is 04;  it prints 8, and adds 4 to its value, so the current value is 12, and the output is 048;  it prints 2, and adds 2 to its value, so the current value is 14, and the output is 0482;  it prints 4, and adds 4 to its value, so the current value is 18, and the output is 04824. This is only one of the possible outputs; for example, the same counter could generate 0246802468024 as the output, if we chose to add 2 during each step.You wrote down a printed sequence from one of such x-y-counters. But the sequence was corrupted and several elements from the sequence could be erased.Now you\'d like to recover data you\'ve lost, but you don\'t even know the type of the counter you used. You have a decimal string s \xe2\x80\x94 the remaining data of the sequence. For all 0\xe2\x89\xa4x,y<10, calculate the minimum number of digits you have to insert in the string s to make it a possible output of the x-y-counter. Note that you can\'t change the order of digits in string s or erase any of them; only insertions are allowed." 1700

1202A "You Are Given Two Binary Strings..." bitmasks,greedy "You are given two binary strings x and y, which are binary representations of some two integers (let\'s denote these integers as f(x) and f(y)). You can choose any integer k\xe2\x89\xa50, calculate the expression sk=f(x)+f(y)\xe2\x8b\x852k and write the binary representation of sk in reverse order (let\'s denote it as revk). For example, let x=1010 and y=11; you\'ve chosen k=1 and, since 21=102, so sk=10102+112\xe2\x8b\x85102=100002 and revk=00001.For given x and y, you need to choose such k that revk is lexicographically minimal (read notes if you don\'t know what does ""lexicographically"" means).It\'s guaranteed that, with given constraints, k exists and is finite." 1100

1201E2 "Knightmare (hard)" "graphs,interactive,shortest paths" "This is an interactive problem.Alice and Bob are playing a game on the chessboard of size n\xc3\x97m where n and m are even. The rows are numbered from 1 to n and the columns are numbered from 1 to m. There are two knights on the chessboard. A white one initially is on the position (x1,y1), while the black one is on the position (x2,y2). Alice will choose one of the knights to play with, and Bob will use the other one.The Alice and Bob will play in turns and whoever controls the white knight starts the game. During a turn, the player must move their knight adhering the chess rules. That is, if the knight is currently on the position (x,y), it can be moved to any of those positions (as long as they are inside the chessboard): (x+1,y+2), (x+1,y\xe2\x88\x922), (x\xe2\x88\x921,y+2), (x\xe2\x88\x921,y\xe2\x88\x922),(x+2,y+1), (x+2,y\xe2\x88\x921), (x\xe2\x88\x922,y+1), (x\xe2\x88\x922,y\xe2\x88\x921). We all know that knights are strongest in the middle of the board. Both knight have a single position they want to reach:   the owner of the white knight wins if it captures the black knight or if the white knight is at (n/2,m/2) and this position is not under attack of the black knight at this moment;  The owner of the black knight wins if it captures the white knight or if the black knight is at (n/2+1,m/2) and this position is not under attack of the white knight at this moment. Formally, the player who captures the other knight wins. The player who is at its target square ((n/2,m/2) for white, (n/2+1,m/2) for black) and this position is not under opponent\'s attack, also wins.A position is under attack of a knight if it can move into this position. Capturing a knight means that a player moves their knight to the cell where the opponent\'s knight is.If Alice made 350 moves and nobody won, the game is a draw.Alice is unsure in her chess skills, so she asks you for a help. Choose a knight and win the game for her. It can be shown, that Alice always has a winning strategy." 3000

1201E1 "Knightmare (easy)" "graphs,interactive,shortest paths" "This problem only differs from the next problem in constraints.This is an interactive problem.Alice and Bob are playing a game on the chessboard of size n\xc3\x97m where n and m are even. The rows are numbered from 1 to n and the columns are numbered from 1 to m. There are two knights on the chessboard. A white one initially is on the position (x1,y1), while the black one is on the position (x2,y2). Alice will choose one of the knights to play with, and Bob will use the other one.The Alice and Bob will play in turns and whoever controls the white knight starts the game. During a turn, the player must move their knight adhering the chess rules. That is, if the knight is currently on the position (x,y), it can be moved to any of those positions (as long as they are inside the chessboard): (x+1,y+2), (x+1,y\xe2\x88\x922), (x\xe2\x88\x921,y+2), (x\xe2\x88\x921,y\xe2\x88\x922),(x+2,y+1), (x+2,y\xe2\x88\x921), (x\xe2\x88\x922,y+1), (x\xe2\x88\x922,y\xe2\x88\x921). We all know that knights are strongest in the middle of the board. Both knight have a single position they want to reach:   the owner of the white knight wins if it captures the black knight or if the white knight is at (n/2,m/2) and this position is not under attack of the black knight at this moment;  The owner of the black knight wins if it captures the white knight or if the black knight is at (n/2+1,m/2) and this position is not under attack of the white knight at this moment. Formally, the player who captures the other knight wins. The player who is at its target square ((n/2,m/2) for white, (n/2+1,m/2) for black) and this position is not under opponent\'s attack, also wins.A position is under attack of a knight if it can move into this position. Capturing a knight means that a player moves their knight to the cell where the opponent\'s knight is.If Alice made 350 moves and nobody won, the game is a draw.Alice is unsure in her chess skills, so she asks you for a help. Choose a knight and win the game for her. It can be shown, that Alice always has a winning strategy." 2900

1201D "Treasure Hunting" "binary search,dp,greedy,implementation" "You are on the island which can be represented as a n\xc3\x97m table. The rows are numbered from 1 to n and the columns are numbered from 1 to m. There are k treasures on the island, the i-th of them is located at the position (ri,ci).Initially you stand at the lower left corner of the island, at the position (1,1). If at any moment you are at the cell with a treasure, you can pick it up without any extra time. In one move you can move up (from (r,c) to (r+1,c)), left (from (r,c) to (r,c\xe2\x88\x921)), or right (from position (r,c) to (r,c+1)). Because of the traps, you can\'t move down.However, moving up is also risky. You can move up only if you are in a safe column. There are q safe columns: b1,b2,\xe2\x80\xa6,bq. You want to collect all the treasures as fast as possible. Count the minimum number of moves required to collect all the treasures." 2100

1201C "Maximum Median" "binary search,greedy,math,sortings" "You are given an array a of n integers, where n is odd. You can make the following operation with it:  Choose one of the elements of the array (for example ai) and increase it by 1 (that is, replace it with ai+1). You want to make the median of the array the largest possible using at most k operations.The median of the odd-sized array is the middle element after the array is sorted in non-decreasing order. For example, the median of the array [1,5,2,3,5] is 3." 1400

1201B "Zero Array" greedy,math "You are given an array a1,a2,\xe2\x80\xa6,an.In one operation you can choose two elements ai and aj (i\xe2\x89\xa0j) and decrease each of them by one.You need to check whether it is possible to make all the elements equal to zero or not." 1500

1201A "Important Exam" implementation,strings "A class of students wrote a multiple-choice test.There are n students in the class. The test had m questions, each of them had 5 possible answers (A, B, C, D or E). There is exactly one correct answer for each question. The correct answer for question i worth ai points. Incorrect answers are graded with zero points.The students remember what answers they gave on the exam, but they don\'t know what are the correct answers. They are very optimistic, so they want to know what is the maximum possible total score of all students in the class." 900

1200F "Graph Traveler" "brute force,data structures,dfs and similar,dp,graphs,implementation,math,number theory" "Gildong is experimenting with an interesting machine Graph Traveler. In Graph Traveler, there is a directed graph consisting of n vertices numbered from 1 to n. The i-th vertex has mi outgoing edges that are labeled as ei[0], ei[1], \xe2\x80\xa6, ei[mi\xe2\x88\x921], each representing the destination vertex of the edge. The graph can have multiple edges and self-loops. The i-th vertex also has an integer ki written on itself.A travel on this graph works as follows.   Gildong chooses a vertex to start from, and an integer to start with. Set the variable c to this integer.  After arriving at the vertex i, or when Gildong begins the travel at some vertex i, add ki to c.  The next vertex is ei[x] where x is an integer 0\xe2\x89\xa4x\xe2\x89\xa4mi\xe2\x88\x921 satisfying x\xe2\x89\xa1c(modmi). Go to the next vertex and go back to step 2. It\'s obvious that a travel never ends, since the 2nd and the 3rd step will be repeated endlessly.For example, assume that Gildong starts at vertex 1 with c=5, and m1=2, e1[0]=1, e1[1]=2, k1=\xe2\x88\x923. Right after he starts at vertex 1, c becomes 2. Since the only integer x (0\xe2\x89\xa4x\xe2\x89\xa41) where x\xe2\x89\xa1c(modmi) is 0, Gildong goes to vertex e1[0]=1. After arriving at vertex 1 again, c becomes \xe2\x88\x921. The only integer x satisfying the conditions is 1, so he goes to vertex e1[1]=2, and so on.Since Gildong is quite inquisitive, he\'s going to ask you q queries. He wants to know how many distinct vertices will be visited infinitely many times, if he starts the travel from a certain vertex with a certain value of c. Note that you should not count the vertices that will be visited only finite times." 2300

1200E "Compress Words" "brute force,hashing,implementation,string suffix structures,strings" "Amugae has a sentence consisting of n words. He want to compress this sentence into one word. Amugae doesn\'t like repetitions, so when he merges two words into one word, he removes the longest prefix of the second word that coincides with a suffix of the first word. For example, he merges ""sample"" and ""please"" into ""samplease"".Amugae will merge his sentence left to right (i.e. first merge the first two words, then merge the result with the third word and so on). Write a program that prints the compressed word after the merging process ends." 2000

1200D "White Lines" "brute force,data structures,dp,implementation,two pointers" "Gildong has bought a famous painting software cfpaint. The working screen of cfpaint is square-shaped consisting of n rows and n columns of square cells. The rows are numbered from 1 to n, from top to bottom, and the columns are numbered from 1 to n, from left to right. The position of a cell at row r and column c is represented as (r,c). There are only two colors for the cells in cfpaint \xe2\x80\x94 black and white.There is a tool named eraser in cfpaint. The eraser has an integer size k (1\xe2\x89\xa4k\xe2\x89\xa4n). To use the eraser, Gildong needs to click on a cell (i,j) where 1\xe2\x89\xa4i,j\xe2\x89\xa4n\xe2\x88\x92k+1. When a cell (i,j) is clicked, all of the cells (i\xe2\x80\xb2,j\xe2\x80\xb2) where i\xe2\x89\xa4i\xe2\x80\xb2\xe2\x89\xa4i+k\xe2\x88\x921 and j\xe2\x89\xa4j\xe2\x80\xb2\xe2\x89\xa4j+k\xe2\x88\x921 become white. In other words, a square with side equal to k cells and top left corner at (i,j) is colored white.A white line is a row or a column without any black cells.Gildong has worked with cfpaint for some time, so some of the cells (possibly zero or all) are currently black. He wants to know the maximum number of white lines after using the eraser exactly once. Help Gildong find the answer to his question." 1900

1200C "Round Corridor" "math,number theory" "Amugae is in a very large round corridor. The corridor consists of two areas. The inner area is equally divided by n sectors, and the outer area is equally divided by m sectors. A wall exists between each pair of sectors of same area (inner or outer), but there is no wall between the inner area and the outer area. A wall always exists at the 12 o\'clock position.  The inner area\'s sectors are denoted as (1,1),(1,2),\xe2\x80\xa6,(1,n) in clockwise direction. The outer area\'s sectors are denoted as (2,1),(2,2),\xe2\x80\xa6,(2,m) in the same manner. For a clear understanding, see the example image above.Amugae wants to know if he can move from one sector to another sector. He has q questions.For each question, check if he can move between two given sectors." 1400

1200B "Block Adventure" dp,greedy "Gildong is playing a video game called Block Adventure. In Block Adventure, there are n columns of blocks in a row, and the columns are numbered from 1 to n. All blocks have equal heights. The height of the i-th column is represented as hi, which is the number of blocks stacked in the i-th column.Gildong plays the game as a character that can stand only on the top of the columns. At the beginning, the character is standing on the top of the 1-st column. The goal of the game is to move the character to the top of the n-th column.The character also has a bag that can hold infinitely many blocks. When the character is on the top of the i-th column, Gildong can take one of the following three actions as many times as he wants:   if there is at least one block on the column, remove one block from the top of the i-th column and put it in the bag;  if there is at least one block in the bag, take one block out of the bag and place it on the top of the i-th column;  if i<n and |hi\xe2\x88\x92hi+1|\xe2\x89\xa4k, move the character to the top of the i+1-st column. k is a non-negative integer given at the beginning of the game. Note that it is only possible to move to the next column. In actions of the first two types the character remains in the i-th column, and the value hi changes.The character initially has m blocks in the bag. Gildong wants to know if it is possible to win the game. Help Gildong find the answer to his question." 1200

1200A Hotelier "brute force,data structures,implementation" "Amugae has a hotel consisting of 10 rooms. The rooms are numbered from 0 to 9 from left to right.The hotel has two entrances \xe2\x80\x94 one from the left end, and another from the right end. When a customer arrives to the hotel through the left entrance, they are assigned to an empty room closest to the left entrance. Similarly, when a customer arrives at the hotel through the right entrance, they are assigned to an empty room closest to the right entrance.One day, Amugae lost the room assignment list. Thankfully Amugae\'s memory is perfect, and he remembers all of the customers: when a customer arrived, from which entrance, and when they left the hotel. Initially the hotel was empty. Write a program that recovers the room assignment list from Amugae\'s memory." 800

1199B "Water Lily" geometry,math "While sailing on a boat, Inessa noticed a beautiful water lily flower above the lake\'s surface. She came closer and it turned out that the lily was exactly H centimeters above the water surface. Inessa grabbed the flower and sailed the distance of L centimeters. Exactly at this point the flower touched the water surface.  Suppose that the lily grows at some point A on the lake bottom, and its stem is always a straight segment with one endpoint at point A. Also suppose that initially the flower was exactly above the point A, i.e. its stem was vertical. Can you determine the depth of the lake at point A?" 1000

1199A "City Day" implementation "For years, the Day of city N was held in the most rainy day of summer. New mayor decided to break this tradition and select a not-so-rainy day for the celebration. The mayor knows the weather forecast for the n days of summer. On the i-th day, ai millimeters of rain will fall. All values ai are distinct.The mayor knows that citizens will watch the weather x days before the celebration and y days after. Because of that, he says that a day d is not-so-rainy if ad is smaller than rain amounts at each of x days before day d and and each of y days after day d. In other words, ad<aj should hold for all d\xe2\x88\x92x\xe2\x89\xa4j<d and d<j\xe2\x89\xa4d+y. Citizens only watch the weather during summer, so we only consider such j that 1\xe2\x89\xa4j\xe2\x89\xa4n.Help mayor find the earliest not-so-rainy day of summer." 1000

1198F "GCD Groups 2" "greedy,number theory,probabilities" "You are given an array of n integers. You need to split all integers into two groups so that the GCD of all integers in the first group is equal to one and the GCD of all integers in the second group is equal to one.The GCD of a group of integers is the largest non-negative integer that divides all the integers in the group.Both groups have to be non-empty." 2900

1198E "Rectangle Painting 2" "flows,graph matchings,graphs" "There is a square grid of size n\xc3\x97n. Some cells are colored in black, all others are colored in white. In one operation you can select some rectangle and color all its cells in white. It costs min(h,w) to color a rectangle of size h\xc3\x97w. You are to make all cells white for minimum total cost.The square is large, so we give it to you in a compressed way. The set of black cells is the union of m rectangles." 2500

1198D "Rectangle Painting 1" dp "There is a square grid of size n\xc3\x97n. Some cells are colored in black, all others are colored in white. In one operation you can select some rectangle and color all its cells in white. It costs max(h,w) to color a rectangle of size h\xc3\x97w. You are to make all cells white for minimum total cost." 2300

1198C "Matching vs  Independent Set" "constructive algorithms,graphs,greedy,sortings" "There is a square grid of size n\xc3\x97n. Some cells are colored in black, all others are colored in white. In one operation you can select some rectangle and color all its cells in white. It costs max(h,w) to color a rectangle of size h\xc3\x97w. You are to make all cells white for minimum total cost." 2000

1198B "Welfare State" "binary search,brute force,data structures,sortings" "There is a country with n citizens. The i-th of them initially has ai money. The government strictly controls the wealth of its citizens. Whenever a citizen makes a purchase or earns some money, they must send a receipt to the social services mentioning the amount of money they currently have.Sometimes the government makes payouts to the poor: all citizens who have strictly less money than x are paid accordingly so that after the payout they have exactly x money. In this case the citizens don\'t send a receipt.You know the initial wealth of every citizen and the log of all events: receipts and payouts. Restore the amount of money each citizen has after all events." 1600

1198A MP3 "sortings,two pointers" "One common way of digitalizing sound is to record sound intensity at particular time moments. For each time moment intensity is recorded as a non-negative integer. Thus we can represent a sound file as an array of n non-negative integers.If there are exactly K distinct values in the array, then we need k=\xe2\x8c\x88log2K\xe2\x8c\x89 bits to store each value. It then takes nk bits to store the whole file.To reduce the memory consumption we need to apply some compression. One common way is to reduce the number of possible intensity values. We choose two integers l\xe2\x89\xa4r, and after that all intensity values are changed in the following way: if the intensity value is within the range [l;r], we don\'t change it. If it is less than l, we change it to l; if it is greater than r, we change it to r. You can see that we lose some low and some high intensities.Your task is to apply this compression in such a way that the file fits onto a disk of size I bytes, and the number of changed elements in the array is minimal possible.We remind you that 1 byte contains 8 bits.k=\xe2\x8c\x88log2K\xe2\x8c\x89 is the smallest integer such that K\xe2\x89\xa42k. In particular, if K=1, then k=0." 1600

1197F "Coloring Game" dp,games,matrices "Alice and Bob want to play a game. They have n colored paper strips; the i-th strip is divided into ai cells numbered from 1 to ai. Each cell can have one of 3 colors.In the beginning of the game, Alice and Bob put n chips, the i-th chip is put in the ai-th cell of the i-th strip. Then they take turns, Alice is first. Each player during their turn has to choose one chip and move it 1, 2 or 3 cells backwards (i.\xe2\x80\x89e. if the current cell is x, then the chip can be moved to the cell x\xe2\x88\x921, x\xe2\x88\x922 or x\xe2\x88\x923). There are two restrictions: the chip cannot leave the borders of the strip (for example, if the current cell is 3, then you can\'t move the chip 3 cells backwards); and some moves may be prohibited because of color of the current cell (a matrix f with size 3\xc3\x973 is given, where fi,j=1 if it is possible to move the chip j cells backwards from the cell which has color i, or fi,j=0 if such move is prohibited). The player who cannot make a move loses the game.Initially some cells may be uncolored. Bob can color all uncolored cells as he wants (but he cannot leave any cell uncolored). Let\'s call a coloring good if Bob can win the game no matter how Alice acts, if the cells are colored according to this coloring. Two colorings are different if at least one cell is colored in different colors in these two colorings.Bob wants you to calculate the number of good colorings. Can you do it for him?Since the answer can be really large, you have to print it modulo 998244353." 2700

1197E "Culture Code" "binary search,combinatorics,data structures,dp,shortest paths,sortings" "There are famous Russian nesting dolls named matryoshkas sold in one of the souvenir stores nearby, and you\'d like to buy several of them. The store has n different matryoshkas. Any matryoshka is a figure of volume outi with an empty space inside of volume ini (of course, outi>ini).You don\'t have much free space inside your bag, but, fortunately, you know that matryoshkas can be nested one inside another. Formally, let\'s call a set of matryoshkas nested if we can rearrange dolls in such a way, that the first doll can be nested inside the second one, the second doll \xe2\x80\x94 inside the third one and so on. Matryoshka i can be nested inside matryoshka j if outi\xe2\x89\xa4inj. So only the last doll will take space inside your bag.Let\'s call extra space of a nested set of dolls as a total volume of empty space inside this structure. Obviously, it\'s equal to ini1+(ini2\xe2\x88\x92outi1)+(ini3\xe2\x88\x92outi2)+\xe2\x8b\xaf+(inik\xe2\x88\x92outik\xe2\x88\x921), where i1, i2, ..., ik are the indices of the chosen dolls in the order they are nested in each other.Finally, let\'s call a nested subset of the given sequence as big enough if there isn\'t any doll from the sequence that can be added to the nested subset without breaking its nested property.You want to buy many matryoshkas, so you should choose a big enough nested subset to buy it. But you will be disappointed if too much space in your bag will be wasted, so you want to choose a big enough subset so that its extra space is minimum possible among all big enough subsets. Now you wonder, how many different nested subsets meet these conditions (they are big enough, and there is no big enough subset such that its extra space is less than the extra space of the chosen subset). Two subsets are considered different if there exists at least one index i such that one of the subsets contains the i-th doll, and another subset doesn\'t.Since the answer can be large, print it modulo 109+7." 2300

1197D "Yet Another Subarray Problem" dp,greedy,math "You are given an array a1,a2,\xe2\x80\xa6,an and two integers m and k.You can choose some subarray al,al+1,\xe2\x80\xa6,ar\xe2\x88\x921,ar. The cost of subarray al,al+1,\xe2\x80\xa6,ar\xe2\x88\x921,ar is equal to r\xe2\x88\x91i=lai\xe2\x88\x92k\xe2\x8c\x88r\xe2\x88\x92l+1m\xe2\x8c\x89, where \xe2\x8c\x88x\xe2\x8c\x89 is the least integer greater than or equal to x. The cost of empty subarray is equal to zero.For example, if m=3, k=10 and a=[2,\xe2\x88\x924,15,\xe2\x88\x923,4,8,3], then the cost of some subarrays are:  a3\xe2\x80\xa6a3:15\xe2\x88\x92k\xe2\x8c\x8813\xe2\x8c\x89=15\xe2\x88\x9210=5;  a3\xe2\x80\xa6a4:(15\xe2\x88\x923)\xe2\x88\x92k\xe2\x8c\x8823\xe2\x8c\x89=12\xe2\x88\x9210=2;  a3\xe2\x80\xa6a5:(15\xe2\x88\x923+4)\xe2\x88\x92k\xe2\x8c\x8833\xe2\x8c\x89=16\xe2\x88\x9210=6;  a3\xe2\x80\xa6a6:(15\xe2\x88\x923+4+8)\xe2\x88\x92k\xe2\x8c\x8843\xe2\x8c\x89=24\xe2\x88\x9220=4;  a3\xe2\x80\xa6a7:(15\xe2\x88\x923+4+8+3)\xe2\x88\x92k\xe2\x8c\x8853\xe2\x8c\x89=27\xe2\x88\x9220=7. Your task is to find the maximum cost of some subarray (possibly empty) of array a." 1900

1197C "Array Splitting" greedy,sortings "You are given a sorted array a1,a2,\xe2\x80\xa6,an (for each index i>1 condition ai\xe2\x89\xa5ai\xe2\x88\x921 holds) and an integer k.You are asked to divide this array into k non-empty consecutive subarrays. Every element in the array should be included in exactly one subarray. Let max(i) be equal to the maximum in the i-th subarray, and min(i) be equal to the minimum in the i-th subarray. The cost of division is equal to k\xe2\x88\x91i=1(max(i)\xe2\x88\x92min(i)). For example, if a=[2,4,5,5,8,11,19] and we divide it into 3 subarrays in the following way: [2,4],[5,5],[8,11,19], then the cost of division is equal to (4\xe2\x88\x922)+(5\xe2\x88\x925)+(19\xe2\x88\x928)=13.Calculate the minimum cost you can obtain by dividing the array a into k non-empty consecutive subarrays." 1400

1197B Pillars greedy,implementation "There are n pillars aligned in a row and numbered from 1 to n.Initially each pillar contains exactly one disk. The i-th pillar contains a disk having radius ai.You can move these disks from one pillar to another. You can take a disk from pillar i and place it on top of pillar j if all these conditions are met:  there is no other pillar between pillars i and j. Formally, it means that |i\xe2\x88\x92j|=1;  pillar i contains exactly one disk;  either pillar j contains no disks, or the topmost disk on pillar j has radius strictly greater than the radius of the disk you move. When you place a disk on a pillar that already has some disks on it, you put the new disk on top of previously placed disks, so the new disk will be used to check the third condition if you try to place another disk on the same pillar.You may take any disk and place it on other pillar any number of times, provided that every time you do it, all three aforementioned conditions are met. Now you wonder, is it possible to place all n disks on the same pillar simultaneously?" 1000

1197A "DIY Wooden Ladder" greedy,math,sortings "Let\'s denote a k-step ladder as the following structure: exactly k+2 wooden planks, of which  two planks of length at least k+1 \xe2\x80\x94 the base of the ladder;  k planks of length at least 1 \xe2\x80\x94 the steps of the ladder; Note that neither the base planks, nor the steps planks are required to be equal.For example, ladders 1 and 3 are correct 2-step ladders and ladder 2 is a correct 1-step ladder. On the first picture the lengths of planks are [3,3] for the base and [1] for the step. On the second picture lengths are [3,3] for the base and [2] for the step. On the third picture lengths are [3,4] for the base and [2,3] for the steps.   You have n planks. The length of the i-th planks is ai. You don\'t have a saw, so you can\'t cut the planks you have. Though you have a hammer and nails, so you can assemble the improvised ""ladder"" from the planks.The question is: what is the maximum number k such that you can choose some subset of the given planks and assemble a k-step ladder using them?" 900

1196F "K-th Path" "brute force,constructive algorithms,shortest paths,sortings" "You are given a connected undirected weighted graph consisting of n vertices and m edges.You need to print the k-th smallest shortest path in this graph (paths from the vertex to itself are not counted, paths from i to j and from j to i are counted as one).More formally, if d is the matrix of shortest paths, where di,j is the length of the shortest path between vertices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n), then you need to print the k-th element in the sorted array consisting of all di,j, where 1\xe2\x89\xa4i<j\xe2\x89\xa4n." 2200

1196E "Connected Component on a Chessboard" "constructive algorithms,implementation" "You are given two integers b and w. You have a chessboard of size 109\xc3\x97109 with the top left cell at (1;1), the cell (1;1) is painted white.Your task is to find a connected component on this chessboard that contains exactly b black cells and exactly w white cells. Two cells are called connected if they share a side (i.e. for the cell (x,y) there are at most four connected cells: (x\xe2\x88\x921,y),(x+1,y),(x,y\xe2\x88\x921),(x,y+1)). A set of cells is called a connected component if for every pair of cells C1 and C2 from this set, there exists a sequence of cells c1, c2, ..., ck such that c1=C1, ck=C2, all ci from 1 to k are belong to this set of cells and for every i\xe2\x88\x88[1,k\xe2\x88\x921], cells ci and ci+1 are connected.Obviously, it can be impossible to find such component. In this case print ""NO"". Otherwise, print ""YES"" and any suitable connected component.You have to answer q independent queries." 1800

1196D2 "RGB Substring (hard version)" "data structures,dp,implementation,two pointers" "The only difference between easy and hard versions is the size of the input.You are given a string s consisting of n characters, each character is \'R\', \'G\' or \'B\'.You are also given an integer k. Your task is to change the minimum number of characters in the initial string s so that after the changes there will be a string of length k that is a substring of s, and is also a substring of the infinite string ""RGBRGBRGB ..."".A string a is a substring of string b if there exists a positive integer i such that a1=bi, a2=bi+1, a3=bi+2, ..., a|a|=bi+|a|\xe2\x88\x921. For example, strings ""GBRG"", ""B"", ""BR"" are substrings of the infinite string ""RGBRGBRGB ..."" while ""GR"", ""RGR"" and ""GGG"" are not.You have to answer q independent queries." 1600

1196D1 "RGB Substring (easy version)" implementation "The only difference between easy and hard versions is the size of the input.You are given a string s consisting of n characters, each character is \'R\', \'G\' or \'B\'.You are also given an integer k. Your task is to change the minimum number of characters in the initial string s so that after the changes there will be a string of length k that is a substring of s, and is also a substring of the infinite string ""RGBRGBRGB ..."".A string a is a substring of string b if there exists a positive integer i such that a1=bi, a2=bi+1, a3=bi+2, ..., a|a|=bi+|a|\xe2\x88\x921. For example, strings ""GBRG"", ""B"", ""BR"" are substrings of the infinite string ""RGBRGBRGB ..."" while ""GR"", ""RGR"" and ""GGG"" are not.You have to answer q independent queries." 1500

1196C "Robot Breakout" implementation "n robots have escaped from your laboratory! You have to find them as soon as possible, because these robots are experimental, and their behavior is not tested yet, so they may be really dangerous!Fortunately, even though your robots have escaped, you still have some control over them. First of all, you know the location of each robot: the world you live in can be modeled as an infinite coordinate plane, and the i-th robot is currently located at the point having coordinates (xi, yi). Furthermore, you may send exactly one command to all of the robots. The command should contain two integer numbers X and Y, and when each robot receives this command, it starts moving towards the point having coordinates (X, Y). The robot stops its movement in two cases:  either it reaches (X, Y);  or it cannot get any closer to (X, Y). Normally, all robots should be able to get from any point of the coordinate plane to any other point. Each robot usually can perform four actions to move. Let\'s denote the current coordinates of the robot as (xc, yc). Then the movement system allows it to move to any of the four adjacent points:  the first action allows it to move from (xc, yc) to (xc\xe2\x88\x921, yc);  the second action allows it to move from (xc, yc) to (xc, yc+1);  the third action allows it to move from (xc, yc) to (xc+1, yc);  the fourth action allows it to move from (xc, yc) to (xc, yc\xe2\x88\x921). Unfortunately, it seems that some movement systems of some robots are malfunctioning. For each robot you know which actions it can perform, and which it cannot perform.You want to send a command so all robots gather at the same point. To do so, you have to choose a pair of integer numbers X and Y so that each robot can reach the point (X, Y). Is it possible to find such a point?" 1500

1196B "Odd Sum Segments" "constructive algorithms,math" "You are given an array a consisting of n integers a1,a2,\xe2\x80\xa6,an. You want to split it into exactly k non-empty non-intersecting subsegments such that each subsegment has odd sum (i.\xe2\x80\x89e. for each subsegment, the sum of all elements that belong to this subsegment is odd). It is impossible to rearrange (shuffle) the elements of a given array. Each of the n elements of the array a must belong to exactly one of the k subsegments.Let\'s see some examples of dividing the array of length 5 into 3 subsegments (not necessarily with odd sums): [1,2,3,4,5] is the initial array, then all possible ways to divide it into 3 non-empty non-intersecting subsegments are described below:  [1],[2],[3,4,5];  [1],[2,3],[4,5];  [1],[2,3,4],[5];  [1,2],[3],[4,5];  [1,2],[3,4],[5];  [1,2,3],[4],[5]. Of course, it can be impossible to divide the initial array into exactly k subsegments in such a way that each of them will have odd sum of elements. In this case print ""NO"". Otherwise, print ""YES"" and any possible division of the array. See the output format for the detailed explanation.You have to answer q independent queries." 1200

1196A "Three Piles of Candies" "brute force,constructive algorithms,math" "Alice and Bob have received three big piles of candies as a gift. Now they want to divide these candies as fair as possible. To do this, Alice takes one pile of candies, then Bob takes one of the other two piles. The last pile is split between Alice and Bob as they want: for example, it is possible that Alice takes the whole pile, and Bob gets nothing from it.After taking the candies from the piles, if Alice has more candies than Bob, she discards some candies so that the number of candies she has is equal to the number of candies Bob has. Of course, Bob does the same if he has more candies.Alice and Bob want to have as many candies as possible, and they plan the process of dividing candies accordingly. Please calculate the maximum number of candies Alice can have after this division process (of course, Bob will have the same number of candies).You have to answer q independent queries.Let\'s see the following example: [1,3,4]. Then Alice can choose the third pile, Bob can take the second pile, and then the only candy from the first pile goes to Bob�\xe2\x80\x94 then Alice has 4 candies, and Bob has 4 candies.Another example is [1,10,100]. Then Alice can choose the second pile, Bob can choose the first pile, and candies from the third pile can be divided in such a way that Bob takes 54 candies, and Alice takes 46 candies. Now Bob has 55 candies, and Alice has 56 candies, so she has to discard one candy�\xe2\x80\x94 and after that, she has 55 candies too." 800

1195F "Geometers Anonymous Club" "data structures,geometry,math,sortings" "Denis holds a Geometers Anonymous Club meeting in SIS. He has prepared n convex polygons numbered from 1 to n for the club. He plans to offer members of the club to calculate Minkowski sums of these polygons. More precisely, he plans to give q tasks, the i-th of them asks to calculate the sum of Minkowski of polygons with indices from li to ri inclusive.The sum of Minkowski of two sets A and B is the set C={a+b:a\xe2\x88\x88A,b\xe2\x88\x88B}. It can be proven that if A and B are convex polygons then C will also be a convex polygon.   Sum of two convex polygons To calculate the sum of Minkowski of p polygons (p>2), you need to calculate the sum of Minkowski of the first p\xe2\x88\x921 polygons, and then calculate the sum of Minkowski of the resulting polygon and the p-th polygon.For the convenience of checking answers, Denis has decided to prepare and calculate the number of vertices in the sum of Minkowski for each task he prepared. Help him to do it." 2500

1195E OpenStreetMap "data structures,two pointers" "Seryozha conducts a course dedicated to building a map of heights of Stepanovo recreation center. He laid a rectangle grid of size n\xc3\x97m cells on a map (rows of grid are numbered from 1 to n from north to south, and columns are numbered from 1 to m from west to east). After that he measured the average height of each cell above Rybinsk sea level and obtained a matrix of heights of size n\xc3\x97m. The cell (i,j) lies on the intersection of the i-th row and the j-th column and has height hi,j. Seryozha is going to look at the result of his work in the browser. The screen of Seryozha\'s laptop can fit a subrectangle of size a\xc3\x97b of matrix of heights (1\xe2\x89\xa4a\xe2\x89\xa4n, 1\xe2\x89\xa4b\xe2\x89\xa4m). Seryozha tries to decide how the weather can affect the recreation center \xe2\x80\x94 for example, if it rains, where all the rainwater will gather. To do so, he is going to find the cell having minimum height among all cells that are shown on the screen of his laptop.Help Seryozha to calculate the sum of heights of such cells for all possible subrectangles he can see on his screen. In other words, you have to calculate the sum of minimum heights in submatrices of size a\xc3\x97b with top left corners in (i,j) over all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92a+1 and 1\xe2\x89\xa4j\xe2\x89\xa4m\xe2\x88\x92b+1.Consider the sequence gi=(gi\xe2\x88\x921\xe2\x8b\x85x+y)modz. You are given integers g0, x, y and z. By miraculous coincidence, hi,j=g(i\xe2\x88\x921)\xe2\x8b\x85m+j\xe2\x88\x921 ((i\xe2\x88\x921)\xe2\x8b\x85m+j\xe2\x88\x921 is the index)." 2100

1195D2 "Submarine in the Rybinsk Sea (hard edition)" "combinatorics,math,number theory" "This problem differs from the previous one only in the absence of the constraint on the equal length of all numbers a1,a2,\xe2\x80\xa6,an.A team of SIS students is going to make a trip on a submarine. Their target is an ancient treasure in a sunken ship lying on the bottom of the Great Rybinsk sea. Unfortunately, the students don\'t know the coordinates of the ship, so they asked Meshanya (who is a hereditary mage) to help them. He agreed to help them, but only if they solve his problem.Let\'s denote a function that alternates digits of two numbers f(a1a2\xe2\x80\xa6ap\xe2\x88\x921ap,b1b2\xe2\x80\xa6bq\xe2\x88\x921bq), where a1\xe2\x80\xa6ap and b1\xe2\x80\xa6bq are digits of two integers written in the decimal notation without leading zeros.In other words, the function f(x,y) alternately shuffles the digits of the numbers x and y by writing them from the lowest digits to the older ones, starting with the number y. The result of the function is also built from right to left (that is, from the lower digits to the older ones). If the digits of one of the arguments have ended, then the remaining digits of the other argument are written out. Familiarize with examples and formal definitions of the function below.For example: f(1111,2222)=12121212 f(7777,888)=7787878 f(33,44444)=4443434 f(555,6)=5556 f(111,2222)=2121212Formally,  if p\xe2\x89\xa5q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=a1a2\xe2\x80\xa6ap\xe2\x88\x92q+1b1ap\xe2\x88\x92q+2b2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq;  if p<q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=b1b2\xe2\x80\xa6bq\xe2\x88\x92pa1bq\xe2\x88\x92p+1a2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq. Mishanya gives you an array consisting of n integers ai, your task is to help students to calculate \xe2\x88\x91ni=1\xe2\x88\x91nj=1f(ai,aj) modulo 998244353." 1800

1195D1 "Submarine in the Rybinsk Sea (easy edition)" "combinatorics,math,number theory" "This problem differs from the next one only in the presence of the constraint on the equal length of all numbers a1,a2,\xe2\x80\xa6,an. Actually, this problem is a subtask of the problem D2 from the same contest and the solution of D2 solves this subtask too.A team of SIS students is going to make a trip on a submarine. Their target is an ancient treasure in a sunken ship lying on the bottom of the Great Rybinsk sea. Unfortunately, the students don\'t know the coordinates of the ship, so they asked Meshanya (who is a hereditary mage) to help them. He agreed to help them, but only if they solve his problem.Let\'s denote a function that alternates digits of two numbers f(a1a2\xe2\x80\xa6ap\xe2\x88\x921ap,b1b2\xe2\x80\xa6bq\xe2\x88\x921bq), where a1\xe2\x80\xa6ap and b1\xe2\x80\xa6bq are digits of two integers written in the decimal notation without leading zeros.In other words, the function f(x,y) alternately shuffles the digits of the numbers x and y by writing them from the lowest digits to the older ones, starting with the number y. The result of the function is also built from right to left (that is, from the lower digits to the older ones). If the digits of one of the arguments have ended, then the remaining digits of the other argument are written out. Familiarize with examples and formal definitions of the function below.For example: f(1111,2222)=12121212 f(7777,888)=7787878 f(33,44444)=4443434 f(555,6)=5556 f(111,2222)=2121212Formally,  if p\xe2\x89\xa5q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=a1a2\xe2\x80\xa6ap\xe2\x88\x92q+1b1ap\xe2\x88\x92q+2b2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq;  if p<q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=b1b2\xe2\x80\xa6bq\xe2\x88\x92pa1bq\xe2\x88\x92p+1a2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq. Mishanya gives you an array consisting of n integers ai. All numbers in this array are of equal length (that is, they consist of the same number of digits). Your task is to help students to calculate \xe2\x88\x91ni=1\xe2\x88\x91nj=1f(ai,aj) modulo 998244353." 1500

1195C "Basketball Exercise" dp "Finally, a basketball court has been opened in SIS, so Demid has decided to hold a basketball exercise session. 2\xe2\x8b\x85n students have come to Demid\'s exercise session, and he lined up them into two rows of the same size (there are exactly n people in each row). Students are numbered from 1 to n in each row in order from left to right.  Now Demid wants to choose a team to play basketball. He will choose players from left to right, and the index of each chosen player (excluding the first one taken) will be strictly greater than the index of the previously chosen player. To avoid giving preference to one of the rows, Demid chooses students in such a way that no consecutive chosen students belong to the same row. The first student can be chosen among all 2n students (there are no additional constraints), and a team can consist of any number of students. Demid thinks, that in order to compose a perfect team, he should choose students in such a way, that the total height of all chosen students is maximum possible. Help Demid to find the maximum possible total height of players in a team he can choose." 1400

1195B "Sport Mafia" "binary search,brute force,math" "Each evening after the dinner the SIS\'s students gather together to play the game of Sport Mafia. For the tournament, Alya puts candies into the box, which will serve as a prize for a winner. To do that, she performs n actions. The first action performed is to put a single candy into the box. For each of the remaining moves she can choose from two options:  the first option, in case the box contains at least one candy, is to take exactly one candy out and eat it. This way the number of candies in the box decreased by 1;  the second option is to put candies in the box. In this case, Alya will put 1 more candy, than she put in the previous time. Thus, if the box is empty, then it can only use the second option.For example, one possible sequence of Alya\'s actions look as follows:  put one candy into the box;  put two candies into the box;  eat one candy from the box;  eat one candy from the box;  put three candies into the box;  eat one candy from the box;  put four candies into the box;  eat one candy from the box;  put five candies into the box; This way she will perform 9 actions, the number of candies at the end will be 11, while Alya will eat 4 candies in total.You know the total number of actions n and the number of candies at the end k. You need to find the total number of sweets Alya ate. That is the number of moves of the first option. It\'s guaranteed, that for the given n and k the answer always exists.Please note, that during an action of the first option, Alya takes out and eats exactly one candy." 1000

1195A "Drinks Choosing" greedy,math "Old timers of Summer Informatics School can remember previous camps in which each student was given a drink of his choice on the vechorka (late-evening meal). Or may be the story was more complicated?There are n students living in a building, and for each of them the favorite drink ai is known. So you know n integers a1,a2,\xe2\x80\xa6,an, where ai (1\xe2\x89\xa4ai\xe2\x89\xa4k) is the type of the favorite drink of the i-th student. The drink types are numbered from 1 to k.There are infinite number of drink sets. Each set consists of exactly two portions of the same drink. In other words, there are k types of drink sets, the j-th type contains two portions of the drink j. The available number of sets of each of the k types is infinite.You know that students will receive the minimum possible number of sets to give all students exactly one drink. Obviously, the number of sets will be exactly \xe2\x8c\x88n2\xe2\x8c\x89, where \xe2\x8c\x88x\xe2\x8c\x89 is x rounded up.After students receive the sets, they will distribute their portions by their choice: each student will get exactly one portion. Note, that if n is odd then one portion will remain unused and the students\' teacher will drink it.What is the maximum number of students that can get their favorite drink if \xe2\x8c\x88n2\xe2\x8c\x89 sets will be chosen optimally and students will distribute portions between themselves optimally?" 1000

1194G "Another Meme Problem" dp "Let\'s call a fraction xy good if there exists at least one another fraction x\xe2\x80\xb2y\xe2\x80\xb2 such that xy=x\xe2\x80\xb2y\xe2\x80\xb2, 1\xe2\x89\xa4x\xe2\x80\xb2,y\xe2\x80\xb2\xe2\x89\xa49, the digit denoting x\xe2\x80\xb2 is contained in the decimal representation of x, and the digit denoting y\xe2\x80\xb2 is contained in the decimal representation of y. For example, 2613 is a good fraction, because 2613=21.You are given an integer number n. Please calculate the number of good fractions xy such that 1\xe2\x89\xa4x\xe2\x89\xa4n and 1\xe2\x89\xa4y\xe2\x89\xa4n. The answer may be really large, so print it modulo 998244353." 2700

1194F "Crossword Expert" "combinatorics,dp,number theory,probabilities,two pointers" "Today Adilbek is taking his probability theory test. Unfortunately, when Adilbek arrived at the university, there had already been a long queue of students wanting to take the same test. Adilbek has estimated that he will be able to start the test only T seconds after coming. Fortunately, Adilbek can spend time without revising any boring theorems or formulas. He has an app on this smartphone which contains n Japanese crosswords to solve. Adilbek has decided to solve them all one by one in the order they are listed in the app, without skipping any crossword. For each crossword, a number ti is given that represents the time it takes an average crossword expert to solve this crossword (the time is given in seconds).Adilbek is a true crossword expert, but, unfortunately, he is sometimes unlucky in choosing the way to solve the crossword. So, it takes him either ti seconds or ti+1 seconds to solve the i-th crossword, equiprobably (with probability 12 he solves the crossword in exactly ti seconds, and with probability 12 he has to spend an additional second to finish the crossword). All these events are independent.After T seconds pass (or after solving the last crossword, if he manages to do it in less than T seconds), Adilbek closes the app (if he finishes some crossword at the same moment, that crossword is considered solved; otherwise Adilbek does not finish solving the current crossword at all). He thinks it would be an interesting probability theory problem to calculate E \xe2\x80\x94 the expected number of crosswords he will be able to solve completely. Can you calculate it? Recall that the expected value of a discrete random variable is the probability-weighted average of all possible values \xe2\x80\x94 in this problem it means that the expected value of the number of solved crosswords can be calculated as E=n\xe2\x88\x91i=0ipi, where pi is the probability that Adilbek will solve exactly i crosswords. We can represent E as rational fraction PQ with Q>0. To give the answer, you should print P\xe2\x8b\x85Q\xe2\x88\x921mod(109+7)." 2400

1194E "Count The Rectangles" "bitmasks,brute force,data structures,geometry,sortings" "There are n segments drawn on a plane; the i-th segment connects two points (xi,1, yi,1) and (xi,2, yi,2). Each segment is non-degenerate, and is either horizontal or vertical \xe2\x80\x94 formally, for every i\xe2\x88\x88[1,n] either xi,1=xi,2 or yi,1=yi,2 (but only one of these conditions holds). Only segments of different types may intersect: no pair of horizontal segments shares any common points, and no pair of vertical segments shares any common points.We say that four segments having indices h1, h2, v1 and v2 such that h1<h2 and v1<v2 form a rectangle if the following conditions hold:  segments h1 and h2 are horizontal;  segments v1 and v2 are vertical;  segment h1 intersects with segment v1;  segment h2 intersects with segment v1;  segment h1 intersects with segment v2;  segment h2 intersects with segment v2. Please calculate the number of ways to choose four segments so they form a rectangle. Note that the conditions h1<h2 and v1<v2 should hold." 2200

1194D "1-2-K Game" games,math "Alice and Bob play a game. There is a paper strip which is divided into n\xe2\x80\x89+\xe2\x80\x891 cells numbered from left to right starting from 0. There is a chip placed in the n-th cell (the last one).Players take turns, Alice is first. Each player during his or her turn has to move the chip 1, 2 or k cells to the left (so, if the chip is currently in the cell i, the player can move it into cell i\xe2\x80\x89-\xe2\x80\x891, i\xe2\x80\x89-\xe2\x80\x892 or i\xe2\x80\x89-\xe2\x80\x89k). The chip should not leave the borders of the paper strip: it is impossible, for example, to move it k cells to the left if the current cell has number i\xe2\x80\x89<\xe2\x80\x89k. The player who can\'t make a move loses the game.Who wins if both participants play optimally?Alice and Bob would like to play several games, so you should determine the winner in each game." 1700

1194C "From S To T" implementation,strings "You are given three strings s, t and p consisting of lowercase Latin letters. You may perform any number (possibly, zero) operations on these strings.During each operation you choose any character from p, erase it from p and insert it into string s (you may insert this character anywhere you want: in the beginning of s, in the end or between any two consecutive characters). For example, if p is aba, and s is de, then the following outcomes are possible (the character we erase from p and insert into s is highlighted):  aba \xe2\x86\x92 ba, de \xe2\x86\x92 ade;  aba \xe2\x86\x92 ba, de \xe2\x86\x92 dae;  aba \xe2\x86\x92 ba, de \xe2\x86\x92 dea;  aba \xe2\x86\x92 aa, de \xe2\x86\x92 bde;  aba \xe2\x86\x92 aa, de \xe2\x86\x92 dbe;  aba \xe2\x86\x92 aa, de \xe2\x86\x92 deb;  aba \xe2\x86\x92 ab, de \xe2\x86\x92 ade;  aba \xe2\x86\x92 ab, de \xe2\x86\x92 dae;  aba \xe2\x86\x92 ab, de \xe2\x86\x92 dea; Your goal is to perform several (maybe zero) operations so that s becomes equal to t. Please determine whether it is possible.Note that you have to answer q independent queries." 1300

1194B "Yet Another Crosses Problem" implementation "You are given a picture consisting of n rows and m columns. Rows are numbered from 1 to n from the top to the bottom, columns are numbered from 1 to m from the left to the right. Each cell is painted either black or white. You think that this picture is not interesting enough. You consider a picture to be interesting if there is at least one cross in it. A cross is represented by a pair of numbers x and y, where 1\xe2\x89\xa4x\xe2\x89\xa4n and 1\xe2\x89\xa4y\xe2\x89\xa4m, such that all cells in row x and all cells in column y are painted black.For examples, each of these pictures contain crosses:  The fourth picture contains 4 crosses: at (1,3), (1,5), (3,3) and (3,5).Following images don\'t contain crosses:  You have a brush and a can of black paint, so you can make this picture interesting. Each minute you may choose a white cell and paint it black.What is the minimum number of minutes you have to spend so the resulting picture contains at least one cross?You are also asked to answer multiple independent queries." 1300

1194A "Remove a Progression" math "You have a list of numbers from 1 to n written from left to right on the blackboard.You perform an algorithm consisting of several steps (steps are 1-indexed). On the i-th step you wipe the i-th number (considering only remaining numbers). You wipe the whole number (not one digit).  When there are less than i numbers remaining, you stop your algorithm. Now you wonder: what is the value of the x-th remaining number after the algorithm is stopped?" 800

1193C "Scissors and Tape" "*special problem,constructive algorithms,geometry" "You are given a piece of paper in the shape of a simple polygon S. Your task is to turn it into a simple polygon T that has the same area as S.You can use two tools: scissors and tape. Scissors can be used to cut any polygon into smaller polygonal pieces. Tape can be used to combine smaller pieces into larger polygons. You can use each tool multiple times, in any order. The polygons given in the input have integer coordinates, but you are allowed to produce shapes with non-integer coordinates in your output.A formal definition of the task follows.A shape Q=(Q0,\xe2\x80\xa6,Qn\xe2\x88\x921) is a sequence of three or more points in the plane such that:   The closed polyline Q0Q1Q2\xe2\x80\xa6Qn\xe2\x88\x921Q0 never touches or intersects itself, and therefore it forms the boundary of a simple polygon.  The polyline goes around the boundary of the polygon in the counter-clockwise direction. The polygon whose boundary is the shape Q will be denoted P(Q).Two shapes are called equivalent if one can be translated and/or rotated to become identical with the other.Note that mirroring a shape is not allowed. Also note that the order of points matters: the shape (Q1,\xe2\x80\xa6,Qn\xe2\x88\x921,Q0) is not necessarily equivalent to the shape (Q0,\xe2\x80\xa6,Qn\xe2\x88\x921).In the figure on the left: Shapes U and V are equivalent. Shape W is not equivalent with them because the points of W are given in a different order. Regardless of the order of points, the fourth shape is not equivalent with the previous ones either as flipping a shape is not allowed.In both input and output, a shape with n points is represented as a single line that contains 2n+1 space-separated numbers: the number n followed by the coordinates of the points: Q0,x, Q0,y, Q1,x, ...Shapes have identification numbers (IDs). The given shape S has ID 0, the shapes you produce in your solutions are given IDs 1, 2, 3, ..., in the order in which they are produced.Shapes B1,\xe2\x80\xa6,Bk form a subdivision of shape A if:   The union of all P(Bi) is exactly P(A).  For each i\xe2\x89\xa0j, the area of the intersection of P(Bi) and P(Bj) is zero. The scissors operation destroys one existing shape A and produces one or more shapes B1,\xe2\x80\xa6,Bk that form a subdivision of A.In the figure: Shape A (square) subdivided into shapes B1, B2, B3 (the three triangles). One valid way to describe one of the Bi is ""3 3 1 6 1 5.1 4"".The tape operation destroys one or more existing shapes A1,\xe2\x80\xa6,Ak and produces one new shape B. In order to perform this operation, you must first specify shapes C1,\xe2\x80\xa6,Ck and only then the final shape B. These shapes must satisfy the following:   For each i, the shape Ci is equivalent to the shape Ai.  The shapes C1,\xe2\x80\xa6,Ck form a subdivision of the shape B. Informally, you choose the shape B and show how to move each of the existing Ai to its correct location Ci within B. Note that only the shape B gets a new ID, the shapes Ci do not." -999

1193B "Magic Tree" "*special problem,data structures,dp,trees" "We have a magic tree: a rooted tree on n vertices. The vertices are numbered 1 through n. Vertex 1 is the root.The magic tree gives us magic fruit. The fruit only grows in vertices of the tree other than the root. Each vertex contains at most one piece of fruit.It is now day 0 and no fruit is ripe yet. Each fruit will only be ripe for a single day. For each fruit, we are given the vertex vj where it grows, the day dj on which it will be ripe, and the amount wj of magic juice we can extract from it if we harvest it when it is ripe.The fruits have to be harvested by cutting some branches of the tree. On each day, you may cut as many branches of the tree as you like. The parts of the tree you cut off will fall to the ground and you can collect all the ripe fruits they contain. All fruits that fall to the ground when they are not ripe are discarded and no magic juice is collected from them.Formally, on each day, you may erase some edges of the tree. Whenever you do so, the tree will split into multiple connected components. You then erase all components that do not contain the root and you harvest all ripe fruits those components contained.Given is a description of the tree together with the locations, ripening days and juiciness of all m fruits. Calculate the maximum total amount of magic juice we can harvest from the tree." -999

1193A "Amusement Park" "*special problem,dp,math" "You have been hired to supervise the project of a new amusement park. The park will have a special gimmick: directed slides that can get customers from one attraction to another quickly and in an entertaining way.The park owner has given you the current project: a list of planned attractions and a list of slides that should be built between them. However, him being a businessman, he casually envisioned the impossible: among other things, he projected a slide coming from the Haunted Castle to the Roller Coaster, another from the Roller Coaster to the Drop Tower, and a third from the Drop Tower to the Haunted Castle. As the slides can only go downhill, it is evident why this is a problem. You don\'t have the luxury of ignoring the laws of physics when building the park, so you have to request changes in the project. Maybe he would accept reversing the slide between the Drop Tower and the Haunted Castle?Formally:   The project is a list of attractions and a list of directed slides. Each slide starts at one attraction and ends at another attraction.  A proposal is obtained from the project by reversing the directions of some slides (possibly none or all of them).  A proposal is legal if there is a way to assign an elevation to each attraction in such a way that every slide goes downhill.  The cost of a proposal is the number of slides whose directions were reversed. For a given project, find and report the sum of costs all legal proposals. Since this number may be large, output it modulo 998,244,353." -999

1192C Cubeword "*special problem,brute force,dp,meet-in-the-middle" "A cubeword is a special type of a crossword. When building a cubeword, you start by choosing a positive integer a: the side length of the cube. Then, you build a big cube consisting of a\xc3\x97a\xc3\x97a unit cubes. This big cube has 12 edges. Then, you discard all unit cubes that do not touch the edges of the big cube. The figure below shows the object you will get for a=6.  Finally, you assign a letter to each of the unit cubes in the object. You must get a meaningful word along each edge of the big cube. Each edge can be read in either direction, and it is sufficient if one of the two directions of reading gives a meaningful word.The figure below shows the object for a=6 in which some unit cubes already have assigned letters. You can already read the words \'SUBMIT\', \'ACCEPT\' and \'TURING\' along three edges of the big cube.  You are given a list of valid words. Each word from the wordlist may appear on arbitrarily many edges of a valid cubeword. Find and report the number of different cubewords that can be constructed, modulo 998,244,353.If one cubeword can be obtained from another by rotation or mirroring, they are considered distinct." -999

1192B "Dynamic Diameter" "*special problem,data structures,dfs and similar,divide and conquer,trees" "You are given a weighted undirected tree on n vertices and a list of q updates. Each update changes the weight of one edge. The task is to output the diameter of the tree after each update.(The distance between two vertices is the sum of the weights on the unique simple path that connects them. The diameter is the largest of all those distances.)" -999

1192A "Building Skyscrapers" "*special problem" "We are going to build a new city: the Metropolis. The city is going to be built on an infinite square grid. The finished city will consist of n skyscrapers, each occupying a different cell of the grid. At any moment during the construction, the cells that currently do not contain a skyscraper are called empty.You are given the planned coordinates of the n skyscrapers. Your task is to find an order in which they can be built while satisfying the rules listed below.  The building crew has only one crane, so the Metropolis has to be constructed one skyscraper at a time.  The first skyscraper can be built anywhere on the grid.  Each subsequent skyscraper has to share a side or a corner with at least one of the previously built skyscrapers (so that it\'s easier to align the new skyscraper to the grid properly).  When building a skyscraper, there has to be a way to deliver material to the construction site from the outside of Metropolis by only moving it through empty cells that share a side. In other words, there should be a path of side-adjacent empty cells that connects the cell that will contain the skyscraper to some cell (r,c) with |r|>109 and/or |c|>109. If a solution exists, let\'s denote the numbers of skyscrapers in the order in which they should be built by s1,\xe2\x80\xa6,sn. There are two types of subtasks:Type 1: You may produce any valid order.Type 2: You must find the order that maximizes sn. Among those, you must find the one that maximizes sn\xe2\x88\x921. And so on. In other words, you must find the valid order of building for which the sequence (sn,sn\xe2\x88\x921,\xe2\x80\xa6,s1) is lexicographically largest." -999

1191B "Tokitsukaze and Mahjong" "brute force,implementation" "Tokitsukaze is playing a game derivated from Japanese mahjong. In this game, she has three tiles in her hand. Each tile she owns is a suited tile, which means it has a suit (manzu, pinzu or souzu) and a number (a digit ranged from 1 to 9). In this problem, we use one digit and one lowercase letter, which is the first character of the suit, to represent a suited tile. All possible suited tiles are represented as 1m, 2m, \xe2\x80\xa6, 9m, 1p, 2p, \xe2\x80\xa6, 9p, 1s, 2s, \xe2\x80\xa6, 9s.In order to win the game, she must have at least one mentsu (described below) in her hand, so sometimes she should draw extra suited tiles. After drawing a tile, the number of her tiles increases by one. She can draw any tiles she wants, including those already in her hand.Do you know the minimum number of extra suited tiles she needs to draw so that she can win?Here are some useful definitions in this game:  A mentsu, also known as meld, is formed by a koutsu or a shuntsu;  A koutsu, also known as triplet, is made of three identical tiles, such as [1m, 1m, 1m], however, [1m, 1p, 1s] or [1m, 4m, 7m] is NOT a koutsu;  A shuntsu, also known as sequence, is made of three sequential numbered tiles in the same suit, such as [1m, 2m, 3m] and [5s, 7s, 6s], however, [9m, 1m, 2m] or [1m, 2p, 3s] is NOT a shuntsu. Some examples:   [2m, 3p, 2s, 4m, 1s, 2s, 4s] \xe2\x80\x94 it contains no koutsu or shuntsu, so it includes no mentsu;  [4s, 3m, 3p, 4s, 5p, 4s, 5p] \xe2\x80\x94 it contains a koutsu, [4s, 4s, 4s], but no shuntsu, so it includes a mentsu;  [5p, 5s, 9m, 4p, 1s, 7p, 7m, 6p] \xe2\x80\x94 it contains no koutsu but a shuntsu, [5p, 4p, 6p] or [5p, 7p, 6p], so it includes a mentsu. Note that the order of tiles is unnecessary and you can assume the number of each type of suited tiles she can draw is infinite." 1200

1191A "Tokitsukaze and Enhancement" "brute force" "Tokitsukaze is one of the characters in the game ""Kantai Collection"". In this game, every character has a common attribute�\xe2\x80\x94 health points, shortened to HP.In general, different values of HP are grouped into 4 categories:  Category A if HP is in the form of (4n+1), that is, when divided by 4, the remainder is 1;  Category B if HP is in the form of (4n+3), that is, when divided by 4, the remainder is 3;  Category C if HP is in the form of (4n+2), that is, when divided by 4, the remainder is 2;  Category D if HP is in the form of 4n, that is, when divided by 4, the remainder is 0. The above-mentioned n can be any integer.These 4 categories ordered from highest to lowest as A>B>C>D, which means category A is the highest and category D is the lowest.While playing the game, players can increase the HP of the character. Now, Tokitsukaze wants you to increase her HP by at most 2 (that is, either by 0, 1 or 2). How much should she increase her HP so that it has the highest possible category?" 800

1190F "Tokitsukaze and Powers" "number theory,probabilities" "Tokitsukaze is playing a room escape game designed by SkywalkerT. In this game, she needs to find out hidden clues in the room to reveal a way to escape.After a while, she realizes that the only way to run away is to open the digital door lock since she accidentally went into a secret compartment and found some clues, which can be interpreted as:  Only when you enter n possible different passwords can you open the door;  Passwords must be integers ranged from 0 to (m\xe2\x88\x921);  A password cannot be x (0\xe2\x89\xa4x<m) if x and m are not coprime (i.e. x and m have some common divisor greater than 1);  A password cannot be x (0\xe2\x89\xa4x<m) if there exist non-negative integers e and k such that pe=km+x, where p is a secret integer;  Any integer that doesn\'t break the above rules can be a password;  Several integers are hidden in the room, but only one of them can be p. Fortunately, she finds that n and m are recorded in the lock. However, what makes Tokitsukaze frustrated is that she doesn\'t do well in math. Now that she has found an integer that is suspected to be p, she wants you to help her find out n possible passwords, or determine the integer cannot be p." 3400

1190E "Tokitsukaze and Explosion" "binary search,greedy" "Tokitsukaze and her friends are trying to infiltrate a secret base built by Claris. However, Claris has been aware of that and set a bomb which is going to explode in a minute. Although they try to escape, they have no place to go after they find that the door has been locked.At this very moment, CJB, Father of Tokitsukaze comes. With his magical power given by Ereshkigal, the goddess of the underworld, CJB is able to set m barriers to protect them from the explosion. Formally, let\'s build a Cartesian coordinate system on the plane and assume the bomb is at O(0,0). There are n persons in Tokitsukaze\'s crew, the i-th one of whom is at Pi(Xi,Yi). Every barrier can be considered as a line with infinity length and they can intersect each other. For every person from Tokitsukaze\'s crew, there must be at least one barrier separating the bomb and him, which means the line between the bomb and him intersects with at least one barrier. In this definition, if there exists a person standing at the position of the bomb, any line through O(0,0) will satisfy the requirement.Although CJB is very powerful, he still wants his barriers to be as far from the bomb as possible, in order to conserve his energy. Please help him calculate the maximum distance between the bomb and the closest barrier while all of Tokitsukaze\'s crew are safe." 3100

1190D "Tokitsukaze and Strange Rectangle" "data structures,divide and conquer,sortings,two pointers" "There are n points on the plane, the i-th of which is at (xi,yi). Tokitsukaze wants to draw a strange rectangular area and pick all the points in the area.The strange area is enclosed by three lines, x=l, y=a and x=r, as its left side, its bottom side and its right side respectively, where l, r and a can be any real numbers satisfying that l<r. The upper side of the area is boundless, which you can regard as a line parallel to the x-axis at infinity. The following figure shows a strange rectangular area.  A point (xi,yi) is in the strange rectangular area if and only if l<xi<r and yi>a. For example, in the above figure, p1 is in the area while p2 is not.Tokitsukaze wants to know how many different non-empty sets she can obtain by picking all the points in a strange rectangular area, where we think two sets are different if there exists at least one point in one set of them but not in the other." 2000

1190C "Tokitsukaze and Duel" "brute force,games,greedy" """Duel!""Betting on the lovely princess Claris, the duel between Tokitsukaze and Quailty has started.There are n cards in a row. Each card has two sides, one of which has color. At first, some of these cards are with color sides facing up and others are with color sides facing down. Then they take turns flipping cards, in which Tokitsukaze moves first. In each move, one should choose exactly k consecutive cards and flip them to the same side, which means to make their color sides all face up or all face down. If all the color sides of these n cards face the same direction after one\'s move, the one who takes this move will win.Princess Claris wants to know who will win the game if Tokitsukaze and Quailty are so clever that they won\'t make mistakes." 2300

1190B "Tokitsukaze, CSL and Stone Game" games "Tokitsukaze and CSL are playing a little game of stones.In the beginning, there are n piles of stones, the i-th pile of which has ai stones. The two players take turns making moves. Tokitsukaze moves first. On each turn the player chooses a nonempty pile and removes exactly one stone from the pile. A player loses if all of the piles are empty before his turn, or if after removing the stone, two piles (possibly empty) contain the same number of stones. Supposing that both players play optimally, who will win the game?Consider an example: n=3 and sizes of piles are a1=2, a2=3, a3=0. It is impossible to choose the empty pile, so Tokitsukaze has two choices: the first and the second piles. If she chooses the first pile then the state will be [1,3,0] and it is a good move. But if she chooses the second pile then the state will be [2,2,0] and she immediately loses. So the only good move for her is to choose the first pile. Supposing that both players always take their best moves and never make mistakes, who will win the game?Note that even if there are two piles with the same number of stones at the beginning, Tokitsukaze may still be able to make a valid first move. It is only necessary that there are no two piles with the same number of stones after she moves." 1800

1190A "Tokitsukaze and Discard Items" "implementation,two pointers" "Recently, Tokitsukaze found an interesting game. Tokitsukaze had n items at the beginning of this game. However, she thought there were too many items, so now she wants to discard m (1\xe2\x89\xa4m\xe2\x89\xa4n) special items of them.These n items are marked with indices from 1 to n. In the beginning, the item with index i is placed on the i-th position. Items are divided into several pages orderly, such that each page contains exactly k positions and the last positions on the last page may be left empty.Tokitsukaze would do the following operation: focus on the first special page that contains at least one special item, and at one time, Tokitsukaze would discard all special items on this page. After an item is discarded or moved, its old position would be empty, and then the item below it, if exists, would move up to this empty position. The movement may bring many items forward and even into previous pages, so Tokitsukaze would keep waiting until all the items stop moving, and then do the operation (i.e. check the special page and discard the special items) repeatedly until there is no item need to be discarded.  Consider the first example from the statement: n=10, m=4, k=5, p=[3,5,7,10]. The are two pages. Initially, the first page is special (since it is the first page containing a special item). So Tokitsukaze discards the special items with indices 3 and 5. After, the first page remains to be special. It contains [1,2,4,6,7], Tokitsukaze discards the special item with index 7. After, the second page is special (since it is the first page containing a special item). It contains [9,10], Tokitsukaze discards the special item with index 10. Tokitsukaze wants to know the number of operations she would do in total." 1400

1189C Candies! "data structures,dp,implementation,math" "Consider a sequence of digits of length 2k [a1,a2,\xe2\x80\xa6,a2k]. We perform the following operation with it: replace pairs (a2i+1,a2i+2) with (a2i+1+a2i+2)mod10 for 0\xe2\x89\xa4i<2k\xe2\x88\x921. For every i where a2i+1+a2i+2\xe2\x89\xa510 we get a candy! As a result, we will get a sequence of length 2k\xe2\x88\x921.Less formally, we partition sequence of length 2k into 2k\xe2\x88\x921 pairs, each consisting of 2 numbers: the first pair consists of the first and second numbers, the second of the third and fourth \xe2\x80\xa6, the last pair consists of the (2k\xe2\x88\x921)-th and (2k)-th numbers. For every pair such that sum of numbers in it is at least 10, we get a candy. After that, we replace every pair of numbers with a remainder of the division of their sum by 10 (and don\'t change the order of the numbers).Perform this operation with a resulting array until it becomes of length 1. Let f([a1,a2,\xe2\x80\xa6,a2k]) denote the number of candies we get in this process. For example: if the starting sequence is [8,7,3,1,7,0,9,4] then:After the first operation the sequence becomes [(8+7)mod10,(3+1)mod10,(7+0)mod10,(9+4)mod10] = [5,4,7,3], and we get 2 candies as 8+7\xe2\x89\xa510 and 9+4\xe2\x89\xa510.After the second operation the sequence becomes [(5+4)mod10,(7+3)mod10] = [9,0], and we get one more candy as 7+3\xe2\x89\xa510. After the final operation sequence becomes [(9+0)mod10] = [9]. Therefore, f([8,7,3,1,7,0,9,4])=3 as we got 3 candies in total.You are given a sequence of digits of length n s1,s2,\xe2\x80\xa6sn. You have to answer q queries of the form (li,ri), where for i-th query you have to output f([sli,sli+1,\xe2\x80\xa6,sri]). It is guaranteed that ri\xe2\x88\x92li+1 is of form 2k for some nonnegative integer k." 1400

1189B "Number Circle" greedy,math,sortings "You are given n numbers a1,a2,\xe2\x80\xa6,an. Is it possible to arrange them in a circle in such a way that every number is strictly less than the sum of its neighbors?For example, for the array [1,4,5,6,7,8], the arrangement on the left is valid, while arrangement on the right is not, as 5\xe2\x89\xa54+1 and 8>1+6." 1100

1189A "Keanu Reeves" strings "After playing Neo in the legendary ""Matrix"" trilogy, Keanu Reeves started doubting himself: maybe we really live in virtual reality? To find if this is true, he needs to solve the following problem.Let\'s call a string consisting of only zeroes and ones good if it contains different numbers of zeroes and ones. For example, 1, 101, 0000 are good, while 01, 1001, and 111000 are not good.We are given a string s of length n consisting of only zeroes and ones. We need to cut s into minimal possible number of substrings s1,s2,\xe2\x80\xa6,sk such that all of them are good. More formally, we have to find minimal by number of strings sequence of good strings s1,s2,\xe2\x80\xa6,sk such that their concatenation (joining) equals s, i.e. s1+s2+\xe2\x8b\xaf+sk=s.For example, cuttings 110010 into 110 and 010 or into 11 and 0010 are valid, as 110, 010, 11, 0010 are all good, and we can\'t cut 110010 to the smaller number of substrings as 110010 isn\'t good itself. At the same time, cutting of 110010 into 1100 and 10 isn\'t valid as both strings aren\'t good. Also, cutting of 110010 into 1, 1, 0010 isn\'t valid, as it isn\'t minimal, even though all 3 strings are good.Can you help Keanu? We can show that the solution always exists. If there are multiple optimal answers, print any." 800

1188E "Problem from Red Panda" combinatorics "At Moscow Workshops ICPC team gets a balloon for each problem they solved first. Team MSU Red Panda got so many balloons that they didn\'t know how to spend them. So they came up with a problem with them.There are several balloons, not more than 106 in total, each one is colored in one of k colors. We can perform the following operation: choose k\xe2\x88\x921 balloons such that they are of k\xe2\x88\x921 different colors, and recolor them all into remaining color. We can perform this operation any finite number of times (for example, we can only perform the operation if there are at least k\xe2\x88\x921 different colors among current balls).How many different balloon configurations can we get? Only number of balloons of each color matters, configurations differing only by the order of balloons are counted as equal. As this number can be very large, output it modulo 998244353." 3300

1188D "Make Equal" dp "You are given n numbers a1,a2,\xe2\x80\xa6,an. In one operation we can add to any one of those numbers a nonnegative integer power of 2.What is the smallest number of operations we need to perform to make all n numbers equal? It can be proved that under given constraints it doesn\'t exceed 1018." 3100

1188C "Array Beauty" dp "Let\'s call beauty of an array b1,b2,\xe2\x80\xa6,bn (n>1) �\xe2\x80\x94 min1\xe2\x89\xa4i<j\xe2\x89\xa4n|bi\xe2\x88\x92bj|.You\'re given an array a1,a2,\xe2\x80\xa6an and a number k. Calculate the sum of beauty over all subsequences of the array of length exactly k. As this number can be very large, output it modulo 998244353.A sequence a is a subsequence of an array b if a can be obtained from b by deletion of several (possibly, zero or all) elements." 2500

1188B "Count Pairs" "math,matrices,number theory,two pointers" "You are given a prime number p, n integers a1,a2,\xe2\x80\xa6,an, and an integer k. Find the number of pairs of indexes (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) for which (ai+aj)(a2i+a2j)\xe2\x89\xa1kmodp." 2300

1188A2 "Add on a Tree: Revolution" "constructive algorithms,dfs and similar,implementation,trees" "Note that this is the second problem of the two similar problems. You can hack this problem if you solve it. But you can hack the previous problem only if you solve both problems.You are given a tree with n nodes. In the beginning, 0 is written on all edges. In one operation, you can choose any 2 distinct leaves u, v and any integer number x and add x to values written on all edges on the simple path between u and v. Note that in previous subtask x was allowed to be any real, here it has to be integer.For example, on the picture below you can see the result of applying two operations to the graph: adding 2 on the path from 7 to 6, and then adding \xe2\x88\x921 on the path from 4 to 5.   You are given some configuration of nonnegative integer pairwise different even numbers, written on the edges. For a given configuration determine if it is possible to achieve it with these operations, and, if it is possible, output the sequence of operations that leads to the given configuration. Constraints on the operations are listed in the output format section.Leave is a node of a tree of degree 1. Simple path is a path that doesn\'t contain any node twice." 2500

1188A1 "Add on a Tree" trees "Note that this is the first problem of the two similar problems. You can hack this problem only if you solve both problems.You are given a tree with n nodes. In the beginning, 0 is written on all edges. In one operation, you can choose any 2 distinct leaves u, v and any real number x and add x to values written on all edges on the simple path between u and v.For example, on the picture below you can see the result of applying two operations to the graph: adding 2 on the path from 7 to 6, and then adding \xe2\x88\x920.5 on the path from 4 to 5.   Is it true that for any configuration of real numbers written on edges, we can achieve it with a finite number of operations?Leaf is a node of a tree of degree 1. Simple path is a path that doesn\'t contain any node twice." 1600

1187G "Gang Up" flows,graphs "The leader of some very secretive organization has decided to invite all other members to a meeting. All members of the organization live in the same town which can be represented as n crossroads connected by m two-directional streets. The meeting will be held in the leader\'s house near the crossroad 1. There are k members of the organization invited to the meeting; i-th of them lives near the crossroad ai. All members of the organization receive the message about the meeting at the same moment and start moving to the location where the meeting is held. In the beginning of each minute each person is located at some crossroad. He or she can either wait a minute at this crossroad, or spend a minute to walk from the current crossroad along some street to another crossroad (obviously, it is possible to start walking along the street only if it begins or ends at the current crossroad). In the beginning of the first minute each person is at the crossroad where he or she lives. As soon as a person reaches the crossroad number 1, he or she immediately comes to the leader\'s house and attends the meeting.Obviously, the leader wants all other members of the organization to come up as early as possible. But, since the organization is very secretive, the leader does not want to attract much attention. Let\'s denote the discontent of the leader as follows  initially the discontent is 0;  whenever a person reaches the crossroad number 1, the discontent of the leader increases by c\xe2\x8b\x85x, where c is some fixed constant, and x is the number of minutes it took the person to reach the crossroad number 1;  whenever x members of the organization walk along the same street at the same moment in the same direction, dx2 is added to the discontent, where d is some fixed constant. This is not cumulative: for example, if two persons are walking along the same street in the same direction at the same moment, then 4d is added to the discontent, not 5d. Before sending a message about the meeting, the leader can tell each member of the organization which path they should choose and where they should wait. Help the leader to establish a plan for every member of the organization so they all reach the crossroad 1, and the discontent is minimized." 2500

1187F "Expected Square Beauty" dp,math,probabilities "Let x be an array of integers x=[x1,x2,\xe2\x80\xa6,xn]. Let\'s define B(x) as a minimal size of a partition of x into subsegments such that all elements in each subsegment are equal. For example, B([3,3,6,1,6,6,6])=4 using next partition: [3,3�|�6�|�1�|�6,6,6].Now you don\'t have any exact values of x, but you know that xi can be any integer value from [li,ri] (li\xe2\x89\xa4ri) uniformly at random. All xi are independent.Calculate expected value of (B(x))2, or E((B(x))2). It\'s guaranteed that the expected value can be represented as rational fraction PQ where (P,Q)=1, so print the value P\xe2\x8b\x85Q\xe2\x88\x921mod109+7." 2500

1187E "Tree Painting" "dfs and similar,dp,trees" "You are given a tree (an undirected connected acyclic graph) consisting of n vertices. You are playing a game on this tree.Initially all vertices are white. On the first turn of the game you choose one vertex and paint it black. Then on each turn you choose a white vertex adjacent (connected by an edge) to any black vertex and paint it black.Each time when you choose a vertex (even during the first turn), you gain the number of points equal to the size of the connected component consisting only of white vertices that contains the chosen vertex. The game ends when all vertices are painted black.Let\'s see the following example:Vertices 1 and 4 are painted black already. If you choose the vertex 2, you will gain 4 points for the connected component consisting of vertices 2,3,5 and 6. If you choose the vertex 9, you will gain 3 points for the connected component consisting of vertices 7,8 and 9.Your task is to maximize the number of points you gain." 2100

1187D "Subarray Sorting" "data structures,sortings" "You are given an array a1,a2,\xe2\x80\xa6,an and an array b1,b2,\xe2\x80\xa6,bn.For one operation you can sort in non-decreasing order any subarray a[l\xe2\x80\xa6r] of the array a.For example, if a=[4,2,2,1,3,1] and you choose subbarray a[2\xe2\x80\xa65], then the array turns into [4,1,2,2,3,1]. You are asked to determine whether it is possible to obtain the array b by applying this operation any number of times (possibly zero) to the array a." 2400

1187C "Vasya And Array" "constructive algorithms,greedy,implementation" "Vasya has an array a1,a2,\xe2\x80\xa6,an.You don\'t know this array, but he told you m facts about this array. The i-th fact is a triple of numbers ti, li and ri (0\xe2\x89\xa4ti\xe2\x89\xa41,1\xe2\x89\xa4li<ri\xe2\x89\xa4n) and it means:  if ti=1 then subbarray ali,ali+1,\xe2\x80\xa6,ari is sorted in non-decreasing order;  if ti=0 then subbarray ali,ali+1,\xe2\x80\xa6,ari is not sorted in non-decreasing order. A subarray is not sorted if there is at least one pair of consecutive elements in this subarray such that the former is greater than the latter. For example if a=[2,1,1,3,2] then he could give you three facts: t1=1,l1=2,r1=4 (the subarray [a2,a3,a4]=[1,1,3] is sorted), t2=0,l2=4,r2=5 (the subarray [a4,a5]=[3,2] is not sorted), and t3=0,l3=3,r3=5 (the subarray [a3,a5]=[1,3,2] is not sorted).You don\'t know the array a. Find any array which satisfies all the given facts." 1800

1187B "Letters Shop" "binary search,implementation,strings" "The letters shop showcase is a string s, consisting of n lowercase Latin letters. As the name tells, letters are sold in the shop.Letters are sold one by one from the leftmost to the rightmost. Any customer can only buy some prefix of letters from the string s.There are m friends, the i-th of them is named ti. Each of them is planning to estimate the following value: how many letters (the length of the shortest prefix) would s/he need to buy if s/he wanted to construct her/his name of bought letters. The name can be constructed if each letter is presented in the equal or greater amount.  For example, for s=""arrayhead"" and ti=""arya"" 5 letters have to be bought (""arrayhead"").  For example, for s=""arrayhead"" and ti=""harry"" 6 letters have to be bought (""arrayhead"").  For example, for s=""arrayhead"" and ti=""ray"" 5 letters have to be bought (""arrayhead"").  For example, for s=""arrayhead"" and ti=""r"" 2 letters have to be bought (""arrayhead"").  For example, for s=""arrayhead"" and ti=""areahydra"" all 9 letters have to be bought (""arrayhead""). It is guaranteed that every friend can construct her/his name using the letters from the string s.Note that the values for friends are independent, friends are only estimating them but not actually buying the letters." 1300

1187A "Stickers and Toys" math "Your favorite shop sells n Kinder Surprise chocolate eggs. You know that exactly s stickers and exactly t toys are placed in n eggs in total.Each Kinder Surprise can be one of three types:  it can contain a single sticker and no toy;  it can contain a single toy and no sticker;  it can contain both a single sticker and a single toy. But you don\'t know which type a particular Kinder Surprise has. All eggs look identical and indistinguishable from each other.What is the minimum number of Kinder Surprise Eggs you have to buy to be sure that, whichever types they are, you\'ll obtain at least one sticker and at least one toy?Note that you do not open the eggs in the purchasing process, that is, you just buy some number of eggs. It\'s guaranteed that the answer always exists." 900

1186F "Vus the Cossack and a Graph" "dfs and similar,graphs,greedy,implementation" "Vus the Cossack has a simple graph with n vertices and m edges. Let di be a degree of the i-th vertex. Recall that a degree of the i-th vertex is the number of conected edges to the i-th vertex.He needs to remain not more than \xe2\x8c\x88n+m2\xe2\x8c\x89 edges. Let fi be the degree of the i-th vertex after removing. He needs to delete them in such way so that \xe2\x8c\x88di2\xe2\x8c\x89\xe2\x89\xa4fi for each i. In other words, the degree of each vertex should not be reduced more than twice. Help Vus to remain the needed edges!" 2400

1186E "Vus the Cossack and a Field" "divide and conquer,implementation,math" "Vus the Cossack has a field with dimensions n\xc3\x97m, which consists of ""0"" and ""1"". He is building an infinite field from this field. He is doing this in this way: He takes the current field and finds a new inverted field. In other words, the new field will contain ""1"" only there, where ""0"" was in the current field, and ""0"" there, where ""1"" was. To the current field, he adds the inverted field to the right.  To the current field, he adds the inverted field to the bottom.  To the current field, he adds the current field to the bottom right.  He repeats it.For example, if the initial field was: 1011 After the first iteration, the field will be like this: 1001110001100011 After the second iteration, the field will be like this: 1001011011000011011010010011110001101001001111001001011011000011 And so on...Let\'s numerate lines from top to bottom from 1 to infinity, and columns from left to right from 1 to infinity. We call the submatrix (x1,y1,x2,y2) all numbers that have coordinates (x,y) such that x1\xe2\x89\xa4x\xe2\x89\xa4x2 and y1\xe2\x89\xa4y\xe2\x89\xa4y2.The Cossack needs sometimes to find the sum of all the numbers in submatrices. Since he is pretty busy right now, he is asking you to find the answers!" 2500

1186D "Vus the Cossack and Numbers" "constructive algorithms,greedy,math" "Vus the Cossack has n real numbers ai. It is known that the sum of all numbers is equal to 0. He wants to choose a sequence b the size of which is n such that the sum of all numbers is 0 and each bi is either \xe2\x8c\x8aai\xe2\x8c\x8b or \xe2\x8c\x88ai\xe2\x8c\x89. In other words, bi equals ai rounded up or down. It is not necessary to round to the nearest integer.For example, if a=[4.58413,1.22491,\xe2\x88\x922.10517,\xe2\x88\x923.70387], then b can be equal, for example, to [4,2,\xe2\x88\x922,\xe2\x88\x924]. Note that if ai is an integer, then there is no difference between \xe2\x8c\x8aai\xe2\x8c\x8b and \xe2\x8c\x88ai\xe2\x8c\x89, bi will always be equal to ai.Help Vus the Cossack find such sequence!" 1500

1186C "Vus the Cossack and Strings" implementation,math "Vus the Cossack has two binary strings, that is, strings that consist only of ""0"" and ""1"". We call these strings a and b. It is known that |b|\xe2\x89\xa4|a|, that is, the length of b is at most the length of a.The Cossack considers every substring of length |b| in string a. Let\'s call this substring c. He matches the corresponding characters in b and c, after which he counts the number of positions where the two strings are different. We call this function f(b,c).For example, let b=00110, and c=11000. In these strings, the first, second, third and fourth positions are different.Vus the Cossack counts the number of such substrings c such that f(b,c) is even.For example, let a=01100010 and b=00110. a has four substrings of the length |b|: 01100, 11000, 10001, 00010.  f(00110,01100)=2; f(00110,11000)=4; f(00110,10001)=4; f(00110,00010)=1. Since in three substrings, f(b,c) is even, the answer is 3.Vus can not find the answer for big strings. That is why he is asking you to help him." 1800

1186A "Vus the Cossack and a Contest" implementation "Vus the Cossack holds a programming competition, in which n people participate. He decided to award them all with pens and notebooks. It is known that Vus has exactly m pens and k notebooks.Determine whether the Cossack can reward all participants, giving each of them at least one pen and at least one notebook." 800

1185G2 "Playlist for Polycarp (hard version)" combinatorics,dp "The only difference between easy and hard versions is constraints.Polycarp loves to listen to music, so he never leaves the player, even on the way home from the university. Polycarp overcomes the distance from the university to the house in exactly T minutes.In the player, Polycarp stores n songs, each of which is characterized by two parameters: ti and gi, where ti is the length of the song in minutes (1\xe2\x89\xa4ti\xe2\x89\xa450), gi is its genre (1\xe2\x89\xa4gi\xe2\x89\xa43).Polycarp wants to create such a playlist so that he can listen to music all the time on the way from the university to his home, and at the time of his arrival home, the playlist is over. Polycarp never interrupts songs and always listens to them from beginning to end. Thus, if he started listening to the i-th song, he would spend exactly ti minutes on its listening. Polycarp also does not like when two songs of the same genre play in a row (i.e. successively/adjacently) or when the songs in his playlist are repeated.Help Polycarpus count the number of different sequences of songs (their order matters), the total duration is exactly T, such that there are no two consecutive songs of the same genre in them and all the songs in the playlist are different." 2600

1185G1 "Playlist for Polycarp (easy version)" bitmasks,combinatorics,dp "The only difference between easy and hard versions is constraints.Polycarp loves to listen to music, so he never leaves the player, even on the way home from the university. Polycarp overcomes the distance from the university to the house in exactly T minutes.In the player, Polycarp stores n songs, each of which is characterized by two parameters: ti and gi, where ti is the length of the song in minutes (1\xe2\x89\xa4ti\xe2\x89\xa415), gi is its genre (1\xe2\x89\xa4gi\xe2\x89\xa43).Polycarp wants to create such a playlist so that he can listen to music all the time on the way from the university to his home, and at the time of his arrival home, the playlist is over. Polycarp never interrupts songs and always listens to them from beginning to end. Thus, if he started listening to the i-th song, he would spend exactly ti minutes on its listening. Polycarp also does not like when two songs of the same genre play in a row (i.e. successively/adjacently) or when the songs in his playlist are repeated.Help Polycarpus count the number of different sequences of songs (their order matters), the total duration is exactly T, such that there are no two consecutive songs of the same genre in them and all the songs in the playlist are different." 2100

1185F "Two Pizzas" "bitmasks,brute force" "A company of n friends wants to order exactly two pizzas. It is known that in total there are 9 pizza ingredients in nature, which are denoted by integers from 1 to 9.Each of the n friends has one or more favorite ingredients: the i-th of friends has the number of favorite ingredients equal to fi (1\xe2\x89\xa4fi\xe2\x89\xa49) and your favorite ingredients form the sequence bi1,bi2,\xe2\x80\xa6,bifi (1\xe2\x89\xa4bit\xe2\x89\xa49).The website of CodePizza restaurant has exactly m (m\xe2\x89\xa52) pizzas. Each pizza is characterized by a set of rj ingredients aj1,aj2,\xe2\x80\xa6,ajrj (1\xe2\x89\xa4rj\xe2\x89\xa49, 1\xe2\x89\xa4ajt\xe2\x89\xa49) , which are included in it, and its price is cj.Help your friends choose exactly two pizzas in such a way as to please the maximum number of people in the company. It is known that a person is pleased with the choice if each of his/her favorite ingredients is in at least one ordered pizza. If there are several ways to choose two pizzas so as to please the maximum number of friends, then choose the one that minimizes the total price of two pizzas." 2100

1185E "Polycarp and Snakes" "brute force,implementation" "After a hard-working week Polycarp prefers to have fun. Polycarp\'s favorite entertainment is drawing snakes. He takes a rectangular checkered sheet of paper of size n\xc3\x97m (where n is the number of rows, m is the number of columns) and starts to draw snakes in cells.Polycarp draws snakes with lowercase Latin letters. He always draws the first snake with the symbol \'a\', the second snake with the symbol \'b\', the third snake with the symbol \'c\' and so on. All snakes have their own unique symbol. There are only 26 letters in the Latin alphabet, Polycarp is very tired and he doesn\'t want to invent new symbols, so the total number of drawn snakes doesn\'t exceed 26.Since by the end of the week Polycarp is very tired, he draws snakes as straight lines without bends. So each snake is positioned either vertically or horizontally. Width of any snake equals 1, i.e. each snake has size either 1\xc3\x97l or l\xc3\x971, where l is snake\'s length. Note that snakes can\'t bend.When Polycarp draws a new snake, he can use already occupied cells for drawing the snake. In this situation, he draws the snake ""over the top"" and overwrites the previous value in the cell.Recently when Polycarp was at work he found a checkered sheet of paper with Latin letters. He wants to know if it is possible to get this sheet of paper from an empty sheet by drawing some snakes according to the rules described above. If it is possible, he is interested in a way to draw snakes." 2000

1185D "Extra Element" implementation,math "A sequence a1,a2,\xe2\x80\xa6,ak is called an arithmetic progression if for each i from 1 to k elements satisfy the condition ai=a1+c\xe2\x8b\x85(i\xe2\x88\x921) for some fixed c.For example, these five sequences are arithmetic progressions: [5,7,9,11], [101], [101,100,99], [13,97] and [5,5,5,5,5]. And these four sequences aren\'t arithmetic progressions: [3,1,2], [1,2,4,8], [1,\xe2\x88\x921,1,\xe2\x88\x921] and [1,2,3,3,3].You are given a sequence of integers b1,b2,\xe2\x80\xa6,bn. Find any index j (1\xe2\x89\xa4j\xe2\x89\xa4n), such that if you delete bj from the sequence, you can reorder the remaining n\xe2\x88\x921 elements, so that you will get an arithmetic progression. If there is no such index, output the number -1." 1700

1185C2 "Exam in BerSU (hard version)" "brute force,data structures,greedy,math" "The only difference between easy and hard versions is constraints.If you write a solution in Python, then prefer to send it in PyPy to speed up execution time.A session has begun at Beland State University. Many students are taking exams.Polygraph Poligrafovich is going to examine a group of n students. Students will take the exam one-by-one in order from 1-th to n-th. Rules of the exam are following:  The i-th student randomly chooses a ticket.  if this ticket is too hard to the student, he doesn\'t answer and goes home immediately (this process is so fast that it\'s considered no time elapses). This student fails the exam.  if the student finds the ticket easy, he spends exactly ti minutes to pass the exam. After it, he immediately gets a mark and goes home. Students take the exam in the fixed order, one-by-one, without any interruption. At any moment of time, Polygraph Poligrafovich takes the answer from one student.The duration of the whole exam for all students is M minutes (maxti\xe2\x89\xa4M), so students at the end of the list have a greater possibility to run out of time to pass the exam.For each student i, you should count the minimum possible number of students who need to fail the exam so the i-th student has enough time to pass the exam.For each student i, find the answer independently. That is, if when finding the answer for the student i1 some student j should leave, then while finding the answer for i2 (i2>i1) the student j student does not have to go home." 1700

1185C1 "Exam in BerSU (easy version)" greedy,sortings "The only difference between easy and hard versions is constraints.A session has begun at Beland State University. Many students are taking exams.Polygraph Poligrafovich is going to examine a group of n students. Students will take the exam one-by-one in order from 1-th to n-th. Rules of the exam are following:  The i-th student randomly chooses a ticket.  if this ticket is too hard to the student, he doesn\'t answer and goes home immediately (this process is so fast that it\'s considered no time elapses). This student fails the exam.  if the student finds the ticket easy, he spends exactly ti minutes to pass the exam. After it, he immediately gets a mark and goes home. Students take the exam in the fixed order, one-by-one, without any interruption. At any moment of time, Polygraph Poligrafovich takes the answer from one student.The duration of the whole exam for all students is M minutes (maxti\xe2\x89\xa4M), so students at the end of the list have a greater possibility to run out of time to pass the exam.For each student i, you should count the minimum possible number of students who need to fail the exam so the i-th student has enough time to pass the exam.For each student i, find the answer independently. That is, if when finding the answer for the student i1 some student j should leave, then while finding the answer for i2 (i2>i1) the student j student does not have to go home." 1200

1185B "Email from Polycarp" implementation,strings "Methodius received an email from his friend Polycarp. However, Polycarp\'s keyboard is broken, so pressing a key on it once may cause the corresponding symbol to appear more than once (if you press a key on a regular keyboard, it prints exactly one symbol).For example, as a result of typing the word ""hello"", the following words could be printed: ""hello"", ""hhhhello"", ""hheeeellllooo"", but the following could not be printed: ""hell"", ""helo"", ""hhllllooo"".Note, that when you press a key, the corresponding symbol must appear (possibly, more than once). The keyboard is broken in a random manner, it means that pressing the same key you can get the different number of letters in the result.For each word in the letter, Methodius has guessed what word Polycarp actually wanted to write, but he is not sure about it, so he asks you to help him.You are given a list of pairs of words. For each pair, determine if the second word could be printed by typing the first one on Polycarp\'s keyboard." 1200

1185A Ropewalkers math "Polycarp decided to relax on his weekend and visited to the performance of famous ropewalkers: Agafon, Boniface and Konrad.The rope is straight and infinite in both directions. At the beginning of the performance, Agafon, Boniface and Konrad are located in positions a, b and c respectively. At the end of the performance, the distance between each pair of ropewalkers was at least d.Ropewalkers can walk on the rope. In one second, only one ropewalker can change his position. Every ropewalker can change his position exactly by 1 (i. e. shift by 1 to the left or right direction on the rope). Agafon, Boniface and Konrad can not move at the same time (Only one of them can move at each moment). Ropewalkers can be at the same positions at the same time and can ""walk past each other"".You should find the minimum duration (in seconds) of the performance. In other words, find the minimum number of seconds needed so that the distance between each pair of ropewalkers can be greater or equal to d.Ropewalkers can walk to negative coordinates, due to the rope is infinite to both sides." 800

1184E3 "Daleks\' Invasion (hard)" "data structures,dsu,graphs,trees" "Polycarp decided to relax on his weekend and visited to the performance of famous ropewalkers: Agafon, Boniface and Konrad.The rope is straight and infinite in both directions. At the beginning of the performance, Agafon, Boniface and Konrad are located in positions a, b and c respectively. At the end of the performance, the distance between each pair of ropewalkers was at least d.Ropewalkers can walk on the rope. In one second, only one ropewalker can change his position. Every ropewalker can change his position exactly by 1 (i. e. shift by 1 to the left or right direction on the rope). Agafon, Boniface and Konrad can not move at the same time (Only one of them can move at each moment). Ropewalkers can be at the same positions at the same time and can ""walk past each other"".You should find the minimum duration (in seconds) of the performance. In other words, find the minimum number of seconds needed so that the distance between each pair of ropewalkers can be greater or equal to d.Ropewalkers can walk to negative coordinates, due to the rope is infinite to both sides." 2400

1184E2 "Daleks\' Invasion (medium)" "dfs and similar,graphs,shortest paths,trees" "Polycarp decided to relax on his weekend and visited to the performance of famous ropewalkers: Agafon, Boniface and Konrad.The rope is straight and infinite in both directions. At the beginning of the performance, Agafon, Boniface and Konrad are located in positions a, b and c respectively. At the end of the performance, the distance between each pair of ropewalkers was at least d.Ropewalkers can walk on the rope. In one second, only one ropewalker can change his position. Every ropewalker can change his position exactly by 1 (i. e. shift by 1 to the left or right direction on the rope). Agafon, Boniface and Konrad can not move at the same time (Only one of them can move at each moment). Ropewalkers can be at the same positions at the same time and can ""walk past each other"".You should find the minimum duration (in seconds) of the performance. In other words, find the minimum number of seconds needed so that the distance between each pair of ropewalkers can be greater or equal to d.Ropewalkers can walk to negative coordinates, due to the rope is infinite to both sides." 2100

1184E1 "Daleks\' Invasion (easy)" graphs,trees "Polycarp decided to relax on his weekend and visited to the performance of famous ropewalkers: Agafon, Boniface and Konrad.The rope is straight and infinite in both directions. At the beginning of the performance, Agafon, Boniface and Konrad are located in positions a, b and c respectively. At the end of the performance, the distance between each pair of ropewalkers was at least d.Ropewalkers can walk on the rope. In one second, only one ropewalker can change his position. Every ropewalker can change his position exactly by 1 (i. e. shift by 1 to the left or right direction on the rope). Agafon, Boniface and Konrad can not move at the same time (Only one of them can move at each moment). Ropewalkers can be at the same positions at the same time and can ""walk past each other"".You should find the minimum duration (in seconds) of the performance. In other words, find the minimum number of seconds needed so that the distance between each pair of ropewalkers can be greater or equal to d.Ropewalkers can walk to negative coordinates, due to the rope is infinite to both sides." 1900

1184D2 "Parallel Universes (Hard)" math,matrices "Heidi enjoyed performing the simulation because she knew exactly when a new universe would be formed and where, and when a non-existent link would be broken and where.However, the multiverse itself works in mysterious ways. Well, it works using probabilities, which to some people is mysterious.At each unit time, when a decision is made, one of the two events will happen randomly. Let\'s denote l as the current length of the multiverse. With a probability of pcreate=1\xe2\x88\x92lm, a universe will be created. With a probability of pbreak=lm, a non-existent link will be broken at some position.More specifically,   When a universe is created, it will manifest itself between any two adjacent universes or at one of the ends. Each position occurs with a probability of 1l+1.   When a link is broken, it could be cut between any two adjacent universes, each with a probability of 1l\xe2\x88\x921. After separating the multiverse into two segments, the segment NOT containing the Doctor will cease to exist. As earlier, the Doctor remains in the same universe. However, if at some point the multiverse breaks in such a way that the Doctor finds himself at the leftmost or rightmost end of it, the TARDIS stops functioning.In such a case, the Doctor must actually walk across the multiverse to find the tools to fix it.We are interested in the expected value of the length of the multiverse when such an event occurs." 3100

1184D1 "Parallel Universes (Easy)" implementation "The Third Doctor Who once correctly said that travel between parallel universes is ""like travelling sideways"". However, he incorrectly thought that there were infinite parallel universes, whereas in fact, as we now all know, there will never be more than 250.Heidi recently got her hands on a multiverse observation tool. She was able to see all n universes lined up in a row, with non-existent links between them. She also noticed that the Doctor was in the k-th universe.The tool also points out that due to restrictions originating from the space-time discontinuum, the number of universes will never exceed m.Obviously, the multiverse is unstable because of free will. Each time a decision is made, one of two events will randomly happen: a new parallel universe is created, or a non-existent link is broken.More specifically,   When a universe is created, it will manifest itself between any two adjacent universes or at one of the ends.   When a link is broken, it could be cut between any two adjacent universes. After separating the multiverse into two segments, the segment NOT containing the Doctor will cease to exist. Heidi wants to perform a simulation of t decisions. Each time a decision is made, Heidi wants to know the length of the multiverse (i.e. the number of universes), and the position of the Doctor." 1600

1184C3 "Heidi and the Turing Test (Hard)" NA "The Cybermen have again outwitted the Daleks! Unfortunately, this time the Daleks decided to abandon these tasks altogether, which means the Doctor has to deal with them.The Doctor can handle the Daleks on his own, but Heidi now has to make sure that the Cybermen are kept busy with this next task.There are k rings on a plane. For each ring, n points are uniformly sampled with a small random noise. The task is to recover the rings given only the noisy samples.The rings and the samples are generated as follows. The center of a ring is uniformly sampled from a disk of radius 1000000 centered at the origin, and the radius of the ring is uniformly sampled from [250000,750000]. Let R be a ring with center (x,y) and radius r. To sample a point from R, an angle \xce\xb8 is uniformly sampled from [0,2\xcf\x80] and a distance d is uniformly sampled from [0.9r,1.1r]. The coordinates of the sampled point are then (x+dcos(\xce\xb8),y+dsin(\xce\xb8)) rounded to the closest integers.The distance between rings is measured by their Hausdorff distance. In our case, the distance between two rings R1,R2 can be written as follow. Let d be the distance between the two centers and r1,r2 be the radii. Then the distance is dist(R1,R2)=max(min(d\xe2\x88\x92\xe2\x88\x92,d\xe2\x88\x92+),min(d+\xe2\x88\x92,d++),min(d\xe2\x88\x92\xe2\x88\x92,d+\xe2\x88\x92),min(d\xe2\x88\x92+,d++)), where d++=|d+r1+r2|, d+\xe2\x88\x92=|d+r1\xe2\x88\x92r2|, d\xe2\x88\x92+=|d\xe2\x88\x92r1+r2|, d\xe2\x88\x92\xe2\x88\x92=|d\xe2\x88\x92r1\xe2\x88\x92r2|.We say that a ring R0 is recovered if one of the rings R in the output has Hausdorff distance less than 100000 from R0. An output is accepted if all the rings are recovered. It is guaranteed that the distances between any two rings is greater than 600000.Remember that a human can very easily solve this task, so make sure that no human traitors are helping the Cybermen complete this task." 3200

1184C2 "Heidi and the Turing Test (Medium)" "data structures" "The Cybermen solved that first test much quicker than the Daleks. Luckily for us, the Daleks were angry (shocking!) and they destroyed some of the Cybermen.After the fighting stopped, Heidi gave them another task to waste their time on.There are n points on a plane. Given a radius r, find the maximum number of points that can be covered by an L1-ball with radius r.An L1-ball with radius r and center (x0,y0) in a 2D-plane is defined as the set of points (x,y) such that the Manhattan distance between (x0,y0) and (x,y) is at most r.Manhattan distance between (x0,y0) and (x,y) is defined as |x\xe2\x88\x92x0|+|y\xe2\x88\x92y0|." 2200

1184C1 "Heidi and the Turing Test (Easy)" implementation "The Cybermen and the Daleks have long been the Doctor\'s main enemies. Everyone knows that both these species enjoy destroying everything they encounter. However, a little-known fact about them is that they both also love taking Turing tests!Heidi designed a series of increasingly difficult tasks for them to spend their time on, which would allow the Doctor enough time to save innocent lives!The funny part is that these tasks would be very easy for a human to solve.The first task is as follows. There are some points on the plane. All but one of them are on the boundary of an axis-aligned square (its sides are parallel to the axes). Identify that point." 1600

1184B3 "The Doctor Meets Vader (Hard)" "flows,shortest paths" "The rebels have saved enough gold to launch a full-scale attack. Now the situation is flipped, the rebels will send out the spaceships to attack the Empire bases!The galaxy can be represented as an undirected graph with n planets (nodes) and m wormholes (edges), each connecting two planets.A total of s rebel spaceships and b empire bases are located at different planets in the galaxy.Each spaceship is given a location x, denoting the index of the planet on which it is located, an attacking strength a, a certain amount of fuel f, and a price to operate p.Each base is given a location x, a defensive strength d, and a certain amount of gold g.A spaceship can attack a base if both of these conditions hold:   the spaceship\'s attacking strength is greater or equal than the defensive strength of the base  the spaceship\'s fuel is greater or equal to the shortest distance, computed as the number of wormholes, between the spaceship\'s node and the base\'s node The rebels are very proud fighters. So, if a spaceship cannot attack any base, no rebel pilot will accept to operate it.If a spaceship is operated, the profit generated by that spaceship is equal to the gold of the base it attacks minus the price to operate the spaceship. Note that this might be negative. A spaceship that is operated will attack the base that maximizes its profit.Darth Vader likes to appear rich at all times. Therefore, whenever a base is attacked and its gold stolen, he makes sure to immediately refill that base with gold.Therefore, for the purposes of the rebels, multiple spaceships can attack the same base, in which case each spaceship will still receive all the gold of that base.The rebels have tasked Heidi and the Doctor to decide which set of spaceships to operate in order to maximize the total profit.However, as the war has been going on for a long time, the pilots have formed unbreakable bonds, and some of them refuse to operate spaceships if their friends are not also operating spaceships.They have a list of k dependencies of the form s1,s2, denoting that spaceship s1 can be operated only if spaceship s2 is also operated." 2700

1184B2 "The Doctor Meets Vader (Medium)" "flows,graph matchings,graphs,shortest paths,sortings" "Thanks to the Doctor\'s help, the rebels managed to steal enough gold to launch a full-scale attack on the Empire! However, Darth Vader is looking for revenge and wants to take back his gold.The rebels have hidden the gold in various bases throughout the galaxy. Darth Vader and the Empire are looking to send out their spaceships to attack these bases.The galaxy can be represented as an undirected graph with n planets (nodes) and m wormholes (edges), each connecting two planets.A total of s empire spaceships and b rebel bases are located at different planets in the galaxy.Each spaceship is given a location x, denoting the index of the planet on which it is located, an attacking strength a, and a certain amount of fuel f.Each base is given a location x, and a defensive strength d.A spaceship can attack a base if both of these conditions hold:   the spaceship\'s attacking strength is greater or equal than the defensive strength of the base  the spaceship\'s fuel is greater or equal to the shortest distance, computed as the number of wormholes, between the spaceship\'s planet and the base\'s planet Vader is very particular about his attacking formations. He requires that each spaceship is to attack at most one base and that each base is to be attacked by at most one spaceship.Vader knows that the rebels have hidden k gold in each base, so he will assign the spaceships to attack bases in such a way that maximizes the number of bases attacked.Therefore, for each base that is attacked, the rebels lose k gold.However, the rebels have the ability to create any number of dummy bases. With the Doctor\'s help, these bases would exist beyond space and time, so all spaceship can reach them and attack them. Moreover, a dummy base is designed to seem irresistible: that is, it will always be attacked by some spaceship.Of course, dummy bases do not contain any gold, but creating such a dummy base costs h gold.What is the minimum gold the rebels can lose if they create an optimal number of dummy bases?" 2200

1184B1 "The Doctor Meets Vader (Easy)" "binary search,sortings" "Heidi and Doctor Who hopped out of the TARDIS and found themselves at EPFL in 2018. They were surrounded by stormtroopers and Darth Vader was approaching. Miraculously, they managed to escape to a nearby rebel base but the Doctor was very confused. Heidi reminded him that last year\'s HC2 theme was Star Wars. Now he understood, and he\'s ready to face the evils of the Empire!The rebels have s spaceships, each with a certain attacking power a.They want to send their spaceships to destroy the empire bases and steal enough gold and supplies in order to keep the rebellion alive.The empire has b bases, each with a certain defensive power d, and a certain amount of gold g.A spaceship can attack all the bases which have a defensive power less than or equal to its attacking power.If a spaceship attacks a base, it steals all the gold in that base.The rebels are still undecided which spaceship to send out first, so they asked for the Doctor\'s help. They would like to know, for each spaceship, the maximum amount of gold it can steal." 1400

1184A3 "Heidi Learns Hashing (Hard)" "fft,math,number theory" "Now Heidi is ready to crack Madame Kovarian\'s hashing function.Madame Kovarian has a very strict set of rules for name changes. Two names can be interchanged only if using the following hashing function on them results in a collision. However, the hashing function is parametrized, so one can always find a set of parameters that causes such a collision. Heidi decided to exploit this to her advantage.Given two strings w1, w2 of equal length n consisting of lowercase English letters and an integer m.Consider the standard polynomial hashing function:Hp(w):=(\xe2\x88\x91|w|\xe2\x88\x921i=0wiri)mod(p)where p is some prime, and r is some number such that 2\xe2\x89\xa4r\xe2\x89\xa4p\xe2\x88\x922.The goal is to find r and a prime p (m\xe2\x89\xa4p\xe2\x89\xa4109) such that Hp(w1)=Hp(w2).Strings w1 and w2 are sampled independently at random from all strings of length n over lowercase English letters." 3100

1184A2 "Heidi Learns Hashing (Medium)" "brute force,number theory" "After learning about polynomial hashing, Heidi decided to learn about shift-xor hashing. In particular, she came across this interesting problem.Given a bitstring y\xe2\x88\x88{0,1}n find out the number of different k (0\xe2\x89\xa4k<n) such that there exists x\xe2\x88\x88{0,1}n for which y=x\xe2\x8a\x95shiftk(x).In the above, \xe2\x8a\x95 is the xor operation and shiftk is the operation of shifting a bitstring cyclically to the right k times. For example, 001\xe2\x8a\x95111=110 and shift3(00010010111000)=00000010010111." 2100

1184A1 "Heidi Learns Hashing (Easy)" "brute force,math,number theory" "Melody Pond was stolen from her parents as a newborn baby by Madame Kovarian, to become a weapon of the Silence in their crusade against the Doctor. Madame Kovarian changed Melody\'s name to River Song, giving her a new identity that allowed her to kill the Eleventh Doctor.Heidi figured out that Madame Kovarian uses a very complicated hashing function in order to change the names of the babies she steals. In order to prevent this from happening to future Doctors, Heidi decided to prepare herself by learning some basic hashing techniques.The first hashing function she designed is as follows.Given two positive integers (x,y) she defines H(x,y):=x2+2xy+x+1.Now, Heidi wonders if the function is reversible. That is, given a positive integer r, can you find a pair (x,y) (of positive integers) such that H(x,y)=r?If multiple such pairs exist, output the one with smallest possible x. If there is no such pair, output ""NO""." 1200

1183H "Subsequences (hard version)" dp,strings "The only difference between the easy and the hard versions is constraints.A subsequence is a string that can be derived from another string by deleting some or no symbols without changing the order of the remaining symbols. Characters to be deleted are not required to go successively, there can be any gaps between them. For example, for the string ""abaca"" the following strings are subsequences: ""abaca"", ""aba"", ""aaa"", ""a"" and """" (empty string). But the following strings are not subsequences: ""aabaca"", ""cb"" and ""bcaa"".You are given a string s consisting of n lowercase Latin letters.In one move you can take any subsequence t of the given string and add it to the set S. The set S can\'t contain duplicates. This move costs n\xe2\x88\x92|t|, where |t| is the length of the added subsequence (i.e. the price equals to the number of the deleted characters).Your task is to find out the minimum possible total cost to obtain a set S of size k or report that it is impossible to do so." 1900

1183G "Candy Box (hard version)" greedy,implementation,sortings "This problem is a version of problem D from the same contest with some additional constraints and tasks.There are n candies in a candy box. The type of the i-th candy is ai (1\xe2\x89\xa4ai\xe2\x89\xa4n). You have to prepare a gift using some of these candies with the following restriction: the numbers of candies of each type presented in a gift should be all distinct (i.\xe2\x80\x89e. for example, a gift having two candies of type 1 and two candies of type 2 is bad).It is possible that multiple types of candies are completely absent from the gift. It is also possible that not all candies of some types will be taken to a gift.You really like some of the candies and don\'t want to include them into the gift, but you want to eat them yourself instead. For each candy, a number fi is given, which is equal to 0 if you really want to keep i-th candy for yourself, or 1 if you don\'t mind including it into your gift. It is possible that two candies of the same type have different values of fi.You want your gift to be as large as possible, but you don\'t want to include too many of the candies you want to eat into the gift. So, you want to calculate the maximum possible number of candies that can be included into a gift, and among all ways to choose maximum number of candies, you want to maximize the number of candies having fi=1 in your gift.You have to answer q independent queries.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 2000

1183F "Topforces Strikes Back" "brute force,math,sortings" "One important contest will take place on the most famous programming platform (Topforces) very soon!The authors have a pool of n problems and should choose at most three of them into this contest. The prettiness of the i-th problem is ai. The authors have to compose the most pretty contest (in other words, the cumulative prettinesses of chosen problems should be maximum possible).But there is one important thing in the contest preparation: because of some superstitions of authors, the prettinesses of problems cannot divide each other. In other words, if the prettinesses of chosen problems are x,y,z, then x should be divisible by neither y, nor z, y should be divisible by neither x, nor z and z should be divisible by neither x, nor y. If the prettinesses of chosen problems are x and y then neither x should be divisible by y nor y should be divisible by x. Any contest composed from one problem is considered good.Your task is to find out the maximum possible total prettiness of the contest composed of at most three problems from the given pool.You have to answer q independent queries.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 2100

1183E "Subsequences (easy version)" "dp,graphs,implementation,shortest paths" "The only difference between the easy and the hard versions is constraints.A subsequence is a string that can be derived from another string by deleting some or no symbols without changing the order of the remaining symbols. Characters to be deleted are not required to go successively, there can be any gaps between them. For example, for the string ""abaca"" the following strings are subsequences: ""abaca"", ""aba"", ""aaa"", ""a"" and """" (empty string). But the following strings are not subsequences: ""aabaca"", ""cb"" and ""bcaa"".You are given a string s consisting of n lowercase Latin letters.In one move you can take any subsequence t of the given string and add it to the set S. The set S can\'t contain duplicates. This move costs n\xe2\x88\x92|t|, where |t| is the length of the added subsequence (i.e. the price equals to the number of the deleted characters).Your task is to find out the minimum possible total cost to obtain a set S of size k or report that it is impossible to do so." 2000

1183D "Candy Box (easy version)" greedy,sortings "This problem is actually a subproblem of problem G from the same contest.There are n candies in a candy box. The type of the i-th candy is ai (1\xe2\x89\xa4ai\xe2\x89\xa4n).You have to prepare a gift using some of these candies with the following restriction: the numbers of candies of each type presented in a gift should be all distinct (i.\xe2\x80\x89e. for example, a gift having two candies of type 1 and two candies of type 2 is bad). It is possible that multiple types of candies are completely absent from the gift. It is also possible that not all candies of some types will be taken to a gift.Your task is to find out the maximum possible size of the single gift you can prepare using the candies you have.You have to answer q independent queries.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 1400

1183C "Computer Game" "binary search,math" "Vova is playing a computer game. There are in total n turns in the game and Vova really wants to play all of them. The initial charge of his laptop battery (i.e. the charge before the start of the game) is k.During each turn Vova can choose what to do:   If the current charge of his laptop battery is strictly greater than a, Vova can just play, and then the charge of his laptop battery will decrease by a;  if the current charge of his laptop battery is strictly greater than b (b<a), Vova can play and charge his laptop, and then the charge of his laptop battery will decrease by b;  if the current charge of his laptop battery is less than or equal to a and b at the same time then Vova cannot do anything and loses the game. Regardless of Vova\'s turns the charge of the laptop battery is always decreases.Vova wants to complete the game (Vova can complete the game if after each of n turns the charge of the laptop battery is strictly greater than 0). Vova has to play exactly n turns. Among all possible ways to complete the game, Vova wants to choose the one where the number of turns when he just plays (first type turn) is the maximum possible. It is possible that Vova cannot complete the game at all.Your task is to find out the maximum possible number of turns Vova can just play (make the first type turn) or report that Vova cannot complete the game.You have to answer q independent queries." 1400

1183B "Equalize Prices" math "There are n products in the shop. The price of the i-th product is ai. The owner of the shop wants to equalize the prices of all products. However, he wants to change prices smoothly.In fact, the owner of the shop can change the price of some product i in such a way that the difference between the old price of this product ai and the new price bi is at most k. In other words, the condition |ai\xe2\x88\x92bi|\xe2\x89\xa4k should be satisfied (|x| is the absolute value of x).He can change the price for each product not more than once. Note that he can leave the old prices for some products. The new price bi of each product i should be positive (i.e. bi>0 should be satisfied for all i from 1 to n).Your task is to find out the maximum possible equal price B of all productts with the restriction that for all products the condiion |ai\xe2\x88\x92B|\xe2\x89\xa4k should be satisfied (where ai is the old price of the product and B is the same new price of all products) or report that it is impossible to find such price B.Note that the chosen price B should be integer.You should answer q independent queries." 900

1183A "Nearest Interesting Number" implementation "Polycarp knows that if the sum of the digits of a number is divisible by 3, then the number itself is divisible by 3. He assumes that the numbers, the sum of the digits of which is divisible by 4, are also somewhat interesting. Thus, he considers a positive integer n interesting if its sum of digits is divisible by 4.Help Polycarp find the nearest larger or equal interesting number for the given number a. That is, find the interesting number n such that n\xe2\x89\xa5a and n is minimal." 800

1182F "Maximum Sine" "binary search,data structures,number theory" "You have given integers a, b, p, and q. Let f(x)=abs(sin(pq\xcf\x80x)).Find minimum possible integer x that maximizes f(x) where a\xe2\x89\xa4x\xe2\x89\xa4b." 2700

1182E "Product Oriented Recurrence" "dp,math,matrices,number theory" "Let fx=c2x\xe2\x88\x926\xe2\x8b\x85fx\xe2\x88\x921\xe2\x8b\x85fx\xe2\x88\x922\xe2\x8b\x85fx\xe2\x88\x923 for x\xe2\x89\xa54.You have given integers n, f1, f2, f3, and c. Find fnmod(109+7)." 2300

1182D "Complete Mirror" "constructive algorithms,dfs and similar,dp,hashing,implementation,trees" "You have given tree consist of nn vertices. Select a vertex as root vertex that satisfies the condition below.  For all vertices v1v1 and v2v2, if distancedistance(rootroot, v1v1) =distance=distance(rootroot, v2)v2) then degreedegree(v1v1) =degree=degree(v2v2), where degreedegree means the number of vertices connected to that vertex, and distancedistance means the number of edges between two vertices. Determine and find if there is such root vertex in the tree. If there are multiple answers, find any of them." 2400

1182C "Beautiful Lyrics" "data structures,greedy,strings" "You are given n words, each of which consists of lowercase alphabet letters. Each word contains at least one vowel. You are going to choose some of the given words and make as many beautiful lyrics as possible.Each lyric consists of two lines. Each line consists of two words separated by whitespace. A lyric is beautiful if and only if it satisfies all conditions below.   The number of vowels in the first word of the first line is the same as the number of vowels in the first word of the second line.  The number of vowels in the second word of the first line is the same as the number of vowels in the second word of the second line.  The last vowel of the first line is the same as the last vowel of the second line. Note that there may be consonants after the vowel. Also, letters ""a"", ""e"", ""o"", ""i"", and ""u"" are vowels. Note that ""y"" is never vowel.For example of a beautiful lyric,  ""hello hellooowww"" ""whatsup yowowowow""  is a beautiful lyric because there are two vowels each in ""hello"" and ""whatsup"", four vowels each in ""hellooowww"" and ""yowowowow"" (keep in mind that ""y"" is not a vowel), and the last vowel of each line is ""o"".For example of a not beautiful lyric,  ""hey man""""iam mcdic""  is not a beautiful lyric because ""hey"" and ""iam"" don\'t have same number of vowels and the last vowels of two lines are different (""a"" in the first and ""i"" in the second).How many beautiful lyrics can you write from given words? Note that you cannot use a word more times than it is given to you. For example, if a word is given three times, you can use it at most three times." 1700

1182B "Plus from Picture" "dfs and similar,implementation,strings" "You have a given picture with size w\xc3\x97h. Determine if the given picture has a single ""+"" shape or not. A ""+"" shape is described below:  A ""+"" shape has one center nonempty cell.  There should be some (at least one) consecutive non-empty cells in each direction (left, right, up, down) from the center. In other words, there should be a ray in each direction.  All other cells are empty. Find out if the given picture has single ""+"" shape." 1300

1182A "Filling Shapes" dp,math "You have a given integer n. Find the number of ways to fill all 3\xc3\x97n tiles with the shape described in the picture below. Upon filling, no empty spaces are allowed. Shapes cannot overlap.  This picture describes when n=4. The left one is the shape and the right one is 3\xc3\x97n tiles." 1000

1181E2 "A Story of One Country (Hard)" "brute force,greedy,sortings" "This problem differs from the previous problem only in constraints.Petya decided to visit Byteland during the summer holidays. It turned out that the history of this country is quite unusual.Initially, there were nn different countries on the land that is now Berland. Each country had its own territory that was represented as a rectangle on the map. The sides of the rectangle were parallel to the axes, and the corners were located at points with integer coordinates. Territories of no two countries intersected, but it was possible that some territories touched each other. As time passed, sometimes two countries merged into one. It only happened if the union of their territories was also a rectangle. In the end only one country remained�\xe2\x80\x94 Byteland.Initially, each country had a rectangular castle inside its territory. Its sides were parallel to the axes and its corners had integer coordinates. Some castles might touch the border of the corresponding country and sides or other castles. Miraculously, after all the unions the castles are still intact. Unfortunately, their locations are the only information we have to restore the initial territories of the countries.  The possible formation of Byteland. The castles are shown in blue. Petya wonders why no information about the initial countries remained. He suspected that the whole story is a fake. You were recommended to him as a smart person. Please check whether or not there exists a possible set of initial territories that could make the story true." 3000

1181E1 "A Story of One Country (Easy)" "brute force,divide and conquer,sortings" "This problem differs from the next problem only in constraints.Petya decided to visit Byteland during the summer holidays. It turned out that the history of this country is quite unusual.Initially, there were n different countries on the land that is now Berland. Each country had its own territory that was represented as a rectangle on the map. The sides of the rectangle were parallel to the axes, and the corners were located at points with integer coordinates. Territories of no two countries intersected, but it was possible that some territories touched each other. As time passed, sometimes two countries merged into one. It only happened if the union of their territories was also a rectangle. In the end only one country remained�\xe2\x80\x94 Byteland.Initially, each country had a rectangular castle inside its territory. Its sides were parallel to the axes and its corners had integer coordinates. Some castles might touch the border of the corresponding country and sides or other castles. Miraculously, after all the unions the castles are still intact. Unfortunately, their locations are the only information we have to restore the initial territories of the countries.  The possible formation of Byteland. The castles are shown in blue. Petya wonders why no information about the initial countries remained. He suspected that the whole story is a fake. You were recommended to him as a smart person. Please check whether or not there exists a possible set of initial territories that could make the story true." 2500

1181D Irrigation "binary search,data structures,implementation,sortings,trees,two pointers" "Misha was interested in water delivery from childhood. That\'s why his mother sent him to the annual Innovative Olympiad in Irrigation (IOI). Pupils from all Berland compete there demonstrating their skills in watering. It is extremely expensive to host such an olympiad, so after the first n olympiads the organizers introduced the following rule of the host city selection.The host cities of the olympiads are selected in the following way. There are m cities in Berland wishing to host the olympiad, they are numbered from 1 to m. The host city of each next olympiad is determined as the city that hosted the olympiad the smallest number of times before. If there are several such cities, the city with the smallest index is selected among them.Misha\'s mother is interested where the olympiad will be held in some specific years. The only information she knows is the above selection rule and the host cities of the first n olympiads. Help her and if you succeed, she will ask Misha to avoid flooding your house." 2200

1181C Flag "brute force,combinatorics,dp,implementation" "Innokenty works at a flea market and sells some random stuff rare items. Recently he found an old rectangular blanket. It turned out that the blanket is split in n\xe2\x8b\x85mn\xe2\x8b\x85m colored pieces that form a rectangle with nn rows and mm columns. The colored pieces attracted Innokenty\'s attention so he immediately came up with the following business plan. If he cuts out a subrectangle consisting of three colored stripes, he can sell it as a flag of some country. Innokenty decided that a subrectangle is similar enough to a flag of some country if it consists of three stripes of equal heights placed one above another, where each stripe consists of cells of equal color. Of course, the color of the top stripe must be different from the color of the middle stripe; and the color of the middle stripe must be different from the color of the bottom stripe.Innokenty has not yet decided what part he will cut out, but he is sure that the flag\'s boundaries should go along grid lines. Also, Innokenty won\'t rotate the blanket. Please help Innokenty and count the number of different subrectangles Innokenty can cut out and sell as a flag. Two subrectangles located in different places but forming the same flag are still considered different. ��These subrectangles are flags.  �����These subrectangles are not flags." 1900

1181B "Split a Number" greedy,implementation,strings "Dima worked all day and wrote down on a long paper strip his favorite number n consisting of l digits. Unfortunately, the strip turned out to be so long that it didn\'t fit in the Dima\'s bookshelf.To solve the issue, Dima decided to split the strip into two non-empty parts so that each of them contains a positive integer without leading zeros. After that he will compute the sum of the two integers and write it down on a new strip.Dima wants the resulting integer to be as small as possible, because it increases the chances that the sum will fit it in the bookshelf. Help Dima decide what is the minimum sum he can obtain." 1500

1181A Chunga-Changa greedy,math "Soon after the Chunga-Changa island was discovered, it started to acquire some forms of civilization and even market economy. A new currency arose, colloquially called ""chizhik"". One has to pay in chizhiks to buy a coconut now.Sasha and Masha are about to buy some coconuts which are sold at price z chizhiks per coconut. Sasha has x chizhiks, Masha has y chizhiks. Each girl will buy as many coconuts as she can using only her money. This way each girl will buy an integer non-negative number of coconuts.The girls discussed their plans and found that the total number of coconuts they buy can increase (or decrease) if one of them gives several chizhiks to the other girl. The chizhiks can\'t be split in parts, so the girls can only exchange with integer number of chizhiks.Consider the following example. Suppose Sasha has 5 chizhiks, Masha has 4 chizhiks, and the price for one coconut be 3 chizhiks. If the girls don\'t exchange with chizhiks, they will buy 1+1=2 coconuts. However, if, for example, Masha gives Sasha one chizhik, then Sasha will have 6 chizhiks, Masha will have 3 chizhiks, and the girls will buy 2+1=3 coconuts. It is not that easy to live on the island now, so Sasha and Mash want to exchange with chizhiks in such a way that they will buy the maximum possible number of coconuts. Nobody wants to have a debt, so among all possible ways to buy the maximum possible number of coconuts find such a way that minimizes the number of chizhiks one girl gives to the other (it is not important who will be the person giving the chizhiks)." 1000

1180B "Nick and Array" greedy,implementation "Nick had received an awesome array of integers a=[a1,a2,\xe2\x80\xa6,an] as a gift for his 5 birthday from his mother. He was already going to explore its various properties but after unpacking he was disappointed a lot because the product a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6an of its elements seemed to him not large enough.He was ready to throw out the array, but his mother reassured him. She told him, that array would not be spoiled after the following operation: choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and do ai:=\xe2\x88\x92ai\xe2\x88\x921.For example, he can change array [3,\xe2\x88\x921,\xe2\x88\x924,1] to an array [\xe2\x88\x924,\xe2\x88\x921,3,1] after applying this operation to elements with indices i=1 and i=3. Kolya had immediately understood that sometimes it\'s possible to increase the product of integers of the array a lot. Now he has decided that he wants to get an array with the maximal possible product of integers using only this operation with its elements (possibly zero, one or more times, as many as he wants), it is not forbidden to do this operation several times for the same index. Help Kolya and print the array with the maximal possible product of elements a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6an which can be received using only this operation in some order.If there are multiple answers, print any of them." 1500

1180A "Alex and a Rhombus" dp,implementation,math "While playing with geometric figures Alex has accidentally invented a concept of a n-th order rhombus in a cell grid.A 1-st order rhombus is just a square 1\xc3\x971 (i.e just a cell).A n-th order rhombus for all n\xe2\x89\xa52 one obtains from a n\xe2\x88\x921-th order rhombus adding all cells which have a common side with it to it (look at the picture to understand it better).  Alex asks you to compute the number of cells in a n-th order rhombus." 800

1179E "Alesya and Discrete Math" "divide and conquer,interactive" "We call a function good if its domain of definition is some set of integers and if in case it\'s defined in x and x\xe2\x88\x921, f(x)=f(x\xe2\x88\x921)+1 or f(x)=f(x\xe2\x88\x921).Tanya has found n good functions f1,\xe2\x80\xa6,fn, which are defined on all integers from 0 to 1018 and fi(0)=0 and fi(1018)=L for all i from 1 to n. It\'s an notorious coincidence that n is a divisor of L. She suggests Alesya a game. Using one question Alesya can ask Tanya a value of any single function in any single point. To win Alesya must choose integers li and ri (0\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa41018), such that fi(ri)\xe2\x88\x92fi(li)\xe2\x89\xa5Ln (here fi(x) means the value of i-th function at point x) for all i such that 1\xe2\x89\xa4i\xe2\x89\xa4n so that for any pair of two functions their segments [li,ri] don\'t intersect (but may have one common point).Unfortunately, Tanya doesn\'t allow to make more than 2\xe2\x8b\x85105 questions. Help Alesya to win!It can be proved that it\'s always possible to choose [li,ri] which satisfy the conditions described above.It\'s guaranteed, that Tanya doesn\'t change functions during the game, i.e. interactor is not adaptive" 3200

1179D "Fedor Runs for President" "data structures,dp,trees" "Fedor runs for president of Byteland! In the debates, he will be asked how to solve Byteland\'s transport problem. It\'s a really hard problem because of Byteland\'s transport system is now a tree (connected graph without cycles). Fedor\'s team has found out in the ministry of transport of Byteland that there is money in the budget only for one additional road. In the debates, he is going to say that he will build this road as a way to maximize the number of distinct simple paths in the country. A simple path is a path which goes through every vertex no more than once. Two simple paths are named distinct if sets of their edges are distinct. But Byteland\'s science is deteriorated, so Fedor\'s team hasn\'t succeeded to find any scientists to answer how many distinct simple paths they can achieve after adding exactly one edge on the transport system?Help Fedor to solve it.An edge can be added between vertices that are already connected, but it can\'t be a loop.In this problem, we consider only simple paths of length at least two." 2700

1179C "Serge and Dining Room" "binary search,data structures,graph matchings,greedy,implementation,math,trees" "Serge came to the school dining room and discovered that there is a big queue here. There are m pupils in the queue. He\'s not sure now if he wants to wait until the queue will clear, so he wants to know which dish he will receive if he does. As Serge is very tired, he asks you to compute it instead of him.Initially there are n dishes with costs a1,a2,\xe2\x80\xa6,an. As you already know, there are the queue of m pupils who have b1,\xe2\x80\xa6,bm togrogs respectively (pupils are enumerated by queue order, i.e the first pupil in the queue has b1 togrogs and the last one has bm togrogs)Pupils think that the most expensive dish is the most delicious one, so every pupil just buys the most expensive dish for which he has money (every dish has a single copy, so when a pupil has bought it nobody can buy it later), and if a pupil doesn\'t have money for any dish, he just leaves the queue (so brutal capitalism...)But money isn\'t a problem at all for Serge, so Serge is buying the most expensive dish if there is at least one remaining.Moreover, Serge\'s school has a very unstable economic situation and the costs of some dishes or number of togrogs of some pupils can change. More formally, you must process q queries:  change ai to x. It means that the price of the i-th dish becomes x togrogs.  change bi to x. It means that the i-th pupil in the queue has x togrogs now. Nobody leaves the queue during those queries because a saleswoman is late.After every query, you must tell Serge price of the dish which he will buy if he has waited until the queue is clear, or \xe2\x88\x921 if there are no dishes at this point, according to rules described above." 2200

1179B "Tolik and His Uncle" "constructive algorithms" "This morning Tolik has understood that while he was sleeping he had invented an incredible problem which will be a perfect fit for Codeforces! But, as a ""Discuss tasks"" project hasn\'t been born yet (in English, well), he decides to test a problem and asks his uncle.After a long time thinking, Tolik\'s uncle hasn\'t any ideas on how to solve it. But, he doesn\'t want to tell Tolik about his inability to solve it, so he hasn\'t found anything better than asking you how to solve this task.In this task you are given a cell field n\xe2\x8b\x85m, consisting of n rows and m columns, where point\'s coordinates (x,y) mean it is situated in the x-th row and y-th column, considering numeration from one (1\xe2\x89\xa4x\xe2\x89\xa4n,1\xe2\x89\xa4y\xe2\x89\xa4m). Initially, you stand in the cell (1,1). Every move you can jump from cell (x,y), which you stand in, by any non-zero vector (dx,dy), thus you will stand in the (x+dx,y+dy) cell. Obviously, you can\'t leave the field, but also there is one more important condition�\xe2\x80\x94 you\'re not allowed to use one vector twice. Your task is to visit each cell of the field exactly once (the initial cell is considered as already visited).Tolik\'s uncle is a very respectful person. Help him to solve this task!" 1800

1179A "Valeriy and Deque" "data structures,implementation" "Recently, on the course of algorithms and data structures, Valeriy learned how to use a deque. He built a deque filled with n elements. The i-th element is ai (i = 1,2,\xe2\x80\xa6,n). He gradually takes the first two leftmost elements from the deque (let\'s call them A and B, respectively), and then does the following: if A>B, he writes A to the beginning and writes B to the end of the deque, otherwise, he writes to the beginning B, and A writes to the end of the deque. We call this sequence of actions an operation.For example, if deque was [2,3,4,5,1], on the operation he will write B=3 to the beginning and A=2 to the end, so he will get [3,4,5,1,2].The teacher of the course, seeing Valeriy, who was passionate about his work, approached him and gave him q queries. Each query consists of the singular number mj (j=1,2,\xe2\x80\xa6,q). It is required for each query to answer which two elements he will pull out on the mj-th operation.Note that the queries are independent and for each query the numbers A and B should be printed in the order in which they will be pulled out of the deque.Deque is a data structure representing a list of elements where insertion of new elements or deletion of existing elements can be made from both sides." 1500

1178H "Stock Exchange" "binary search,flows,graphs" "Warning: This problem has an unusual memory limit!Bob decided that he will not waste his prime years implementing GUI forms for a large corporation and instead will earn his supper on the Stock Exchange Reykjavik. The Stock Exchange Reykjavik is the only actual stock exchange in the world. The only type of transaction is to take a single share of stock x and exchange it for a single share of stock y, provided that the current price of share x is at least the current price of share y. There are 2n stocks listed on the SER that are of interest to Bob, numbered from 1 to 2n. Bob owns a single share of stocks 1 through n and would like to own a single share of each of n+1 through 2n some time in the future.Bob managed to forecast the price of each stock�\xe2\x80\x94 in time t\xe2\x89\xa50, the stock i will cost ai\xe2\x8b\x85\xe2\x8c\x8at\xe2\x8c\x8b+bi. The time is currently t=0. Help Bob find the earliest moment in time in which he can own a single share of each of n+1 through 2n, and the minimum number of stock exchanges he has to perform in order to do that.You may assume that the Stock Exchange has an unlimited amount of each stock at any point in time." 3500

1178G "The Awesomest Vertex" "data structures,dfs and similar" "You are given a rooted tree on n vertices. The vertices are numbered from 1 to n; the root is the vertex number 1.Each vertex has two integers associated with it: ai and bi. We denote the set of all ancestors of v (including v itself) by R(v). The awesomeness of a vertex v is defined as |\xe2\x88\x91w\xe2\x88\x88R(v)aw|\xe2\x8b\x85|\xe2\x88\x91w\xe2\x88\x88R(v)bw|,where |x| denotes the absolute value of x. Process q queries of one of the following forms:   1 v x�\xe2\x80\x94 increase av by a positive integer x.  2 v�\xe2\x80\x94 report the maximum awesomeness in the subtree of vertex v." 3000

1178F2 "Long Colorful Strip" dp "This is the second subtask of problem F. The only differences between this and the first subtask are the constraints on the value of mm and the time limit. It is sufficient to solve this subtask in order to hack it, but you need to solve both subtasks in order to hack the first one.There are n+1n+1 distinct colours in the universe, numbered 00 through nn. There is a strip of paper mm centimetres long initially painted with colour 00. Alice took a brush and painted the strip using the following process. For each ii from 11 to nn, in this order, she picks two integers 0\xe2\x89\xa4ai<bi\xe2\x89\xa4m0\xe2\x89\xa4ai<bi\xe2\x89\xa4m, such that the segment [ai,bi][ai,bi] is currently painted with a single colour, and repaints it with colour ii. Alice chose the segments in such a way that each centimetre is now painted in some colour other than 00. Formally, the segment [i\xe2\x88\x921,i][i\xe2\x88\x921,i] is painted with colour cici (ci\xe2\x89\xa00ci\xe2\x89\xa00). Every colour other than 00 is visible on the strip.Count the number of different pairs of sequences {ai}ni=1{ai}i=1n, {bi}ni=1{bi}i=1n that result in this configuration. Since this number may be large, output it modulo 998244353998244353." 2600

1178F1 "Short Colorful Strip" "combinatorics,dfs and similar,dp" "This is the first subtask of problem F. The only differences between this and the second subtask are the constraints on the value of m and the time limit. You need to solve both subtasks in order to hack this one.There are n+1 distinct colours in the universe, numbered 0 through n. There is a strip of paper m centimetres long initially painted with colour 0. Alice took a brush and painted the strip using the following process. For each i from 1 to n, in this order, she picks two integers 0\xe2\x89\xa4ai<bi\xe2\x89\xa4m, such that the segment [ai,bi] is currently painted with a single colour, and repaints it with colour i. Alice chose the segments in such a way that each centimetre is now painted in some colour other than 0. Formally, the segment [i\xe2\x88\x921,i] is painted with colour ci (ci\xe2\x89\xa00). Every colour other than 0 is visible on the strip.Count the number of different pairs of sequences {ai}ni=1, {bi}ni=1 that result in this configuration. Since this number may be large, output it modulo 998244353." 2200

1178E Archaeology "brute force,constructive algorithms,greedy,strings" "Alice bought a Congo Prime Video subscription and was watching a documentary on the archaeological findings from Factor\'s Island on Loch Katrine in Scotland. The archaeologists found a book whose age and origin are unknown. Perhaps Alice can make some sense of it?The book contains a single string of characters ""a"", ""b"" and ""c"". It has been pointed out that no two consecutive characters are the same. It has also been conjectured that the string contains an unusually long subsequence that reads the same from both sides. Help Alice verify this by finding such subsequence that contains at least half of the characters of the original string, rounded down. Note that you don\'t have to maximise the length of it.A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters." 1900

1178D "Prime Graph" "constructive algorithms,greedy,math,number theory" "Every person likes prime numbers. Alice is a person, thus she also shares the love for them. Bob wanted to give her an affectionate gift but couldn\'t think of anything inventive. Hence, he will be giving her a graph. How original, Bob! Alice will surely be thrilled!When building the graph, he needs four conditions to be satisfied:   It must be a simple undirected graph, i.e. without multiple (parallel) edges and self-loops.  The number of vertices must be exactly nn�\xe2\x80\x94 a number he selected. This number is not necessarily prime.  The total number of edges must be prime.  The degree (i.e. the number of edges connected to the vertex) of each vertex must be prime. Below is an example for n=4n=4. The first graph (left one) is invalid as the degree of vertex 22 (and 44) equals to 11, which is not prime. The second graph (middle one) is invalid as the total number of edges is 44, which is not a prime number. The third graph (right one) is a valid answer for n=4n=4.   Note that the graph can be disconnected.Please help Bob to find any such graph!" 1500

1178C Tiles combinatorics,greedy,math "Bob is decorating his kitchen, more precisely, the floor. He has found a prime candidate for the tiles he will use. They come in a simple form factor�\xe2\x80\x94�a square tile that is diagonally split into white and black part as depicted in the figure below.  The dimension of this tile is perfect for this kitchen, as he will need exactly w\xc3\x97hw\xc3\x97h tiles without any scraps. That is, the width of the kitchen is ww tiles, and the height is hh tiles. As each tile can be rotated in one of four ways, he still needs to decide on how exactly he will tile the floor. There is a single aesthetic criterion that he wants to fulfil: two adjacent tiles must not share a colour on the edge�\xe2\x80\x94�i.e. one of the tiles must have a white colour on the shared border, and the second one must be black.  The picture on the left shows one valid tiling of a 3\xc3\x9723\xc3\x972 kitchen. The picture on the right shows an invalid arrangement, as the bottom two tiles touch with their white parts. Find the number of possible tilings. As this number may be large, output its remainder when divided by 998244353998244353 (a prime number)." 1300

1178B "WOW Factor" dp,strings "Recall that string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly zero or all) characters. For example, for the string a=""wowwo"", the following strings are subsequences: ""wowwo"", ""wowo"", ""oo"", ""wow"", """", and others, but the following are not subsequences: ""owoo"", ""owwwo"", ""ooo"".The wow factor of a string is the number of its subsequences equal to the word ""wow"". Bob wants to write a string that has a large wow factor. However, the ""w"" key on his keyboard is broken, so he types two ""v""s instead. Little did he realise that he may have introduced more ""w""s than he thought. Consider for instance the string ""ww"". Bob would type it as ""vvvv"", but this string actually contains three occurrences of ""w"":   ""vvvv""  ""vvvv""  ""vvvv"" For example, the wow factor of the word ""vvvovvv"" equals to four because there are four wows:  ""vvvovvv""  ""vvvovvv""  ""vvvovvv""  ""vvvovvv"" Note that the subsequence ""vvvovvv"" does not count towards the wow factor, as the ""v""s have to be consecutive.For a given string s, compute and output its wow factor. Note that it is not guaranteed that it is possible to get s from another string replacing ""w"" with ""vv"". For example, s can be equal to ""vov""." 1300

1178A "Prime Minister" greedy "Alice is the leader of the State Refactoring Party, and she is about to become the prime minister. The elections have just taken place. There are n parties, numbered from 1 to n. The i-th party has received ai seats in the parliament.Alice\'s party has number 1. In order to become the prime minister, she needs to build a coalition, consisting of her party and possibly some other parties. There are two conditions she needs to fulfil:   The total number of seats of all parties in the coalition must be a strict majority of all the seats, i.e. it must have strictly more than half of the seats. For example, if the parliament has 200 (or 201) seats, then the majority is 101 or more seats.  Alice\'s party must have at least 2 times more seats than any other party in the coalition. For example, to invite a party with 50 seats, Alice\'s party must have at least 100 seats. For example, if n=4 and a=[51,25,99,25] (note that Alice\'a party has 51 seats), then the following set [a1=51,a2=25,a4=25] can create a coalition since both conditions will be satisfied. However, the following sets will not create a coalition:  [a2=25,a3=99,a4=25] since Alice\'s party is not there;  [a1=51,a2=25] since coalition should have a strict majority;  [a1=51,a2=25,a3=99] since Alice\'s party should have at least 2 times more seats than any other party in the coalition. Alice does not have to minimise the number of parties in a coalition. If she wants, she can invite as many parties as she wants (as long as the conditions are satisfied). If Alice\'s party has enough people to create a coalition on her own, she can invite no parties.Note that Alice can either invite a party as a whole or not at all. It is not possible to invite only some of the deputies (seats) from another party. In other words, if Alice invites a party, she invites all its deputies.Find and print any suitable coalition." 800

1177B "Digits Sequence (Hard Edition)" "binary search,divide and conquer,implementation" "Let\'s write all the positive integer numbers one after another from 1 without any delimiters (i.e. as a single string). It will be the infinite sequence starting with 123456789101112131415161718192021222324252627282930313233343536...Your task is to print the k-th digit of this sequence." 1800

1177A "Digits Sequence (Easy Edition)" implementation "Let\'s write all the positive integer numbers one after another from 1 without any delimiters (i.e. as a single string). It will be the infinite sequence starting with 123456789101112131415161718192021222324252627282930313233343536...Your task is to print the k-th digit of this sequence." 1000

1176F "Destroy it!" dp,implementation,sortings "You are playing a computer card game called Splay the Sire. Currently you are struggling to defeat the final boss of the game.The boss battle consists of n turns. During each turn, you will get several cards. Each card has two parameters: its cost ci and damage di. You may play some of your cards during each turn in some sequence (you choose the cards and the exact order they are played), as long as the total cost of the cards you play during the turn does not exceed 3. After playing some (possibly zero) cards, you end your turn, and all cards you didn\'t play are discarded. Note that you can use each card at most once.Your character has also found an artifact that boosts the damage of some of your actions: every 10-th card you play deals double damage.What is the maximum possible damage you can deal during n turns?" 2100

1176E "Cover it!" "dfs and similar,dsu,graphs,shortest paths,trees" "You are given an undirected unweighted connected graph consisting of nn vertices and mm edges. It is guaranteed that there are no self-loops or multiple edges in the given graph.Your task is to choose at most \xe2\x8c\x8an2\xe2\x8c\x8b\xe2\x8c\x8an2\xe2\x8c\x8b vertices in this graph so each unchosen vertex is adjacent (in other words, connected by an edge) to at least one of chosen vertices.It is guaranteed that the answer exists. If there are multiple answers, you can print any.You will be given multiple independent queries to answer." 1700

1176D "Recover it!" "dfs and similar,graphs,greedy,number theory,sortings" "Authors guessed an array a consisting of n integers; each integer is not less than 2 and not greater than 2\xe2\x8b\x85105. You don\'t know the array a, but you know the array b which is formed from it with the following sequence of operations:  Firstly, let the array b be equal to the array a;  Secondly, for each i from 1 to n:   if ai is a prime number, then one integer pai is appended to array b, where p is an infinite sequence of prime numbers (2,3,5,\xe2\x80\xa6);  otherwise (if ai is not a prime number), the greatest divisor of ai which is not equal to ai is appended to b;   Then the obtained array of length 2n is shuffled and given to you in the input. Here pai means the ai-th prime number. The first prime p1=2, the second one is p2=3, and so on.Your task is to recover any suitable array a that forms the given array b. It is guaranteed that the answer exists (so the array b is obtained from some suitable array a). If there are multiple answers, you can print any." 1800

1176C "Lose it!" dp,greedy,implementation "You are given an array a consisting of n integers. Each ai is one of the six following numbers: 4,8,15,16,23,42.Your task is to remove the minimum number of elements to make this array good.An array of length k is called good if k is divisible by 6 and it is possible to split it into k6 subsequences 4,8,15,16,23,42.Examples of good arrays:  [4,8,15,16,23,42] (the whole array is a required sequence);  [4,8,4,15,16,8,23,15,16,42,23,42] (the first sequence is formed from first, second, fourth, fifth, seventh and tenth elements and the second one is formed from remaining elements);  [] (the empty array is good). Examples of bad arrays:   [4,8,15,16,42,23] (the order of elements should be exactly 4,8,15,16,23,42);  [4,8,15,16,23,42,4] (the length of the array is not divisible by 6);  [4,8,15,16,23,42,4,8,15,16,23,23] (the first sequence can be formed from first six elements but the remaining array cannot form the required sequence)." 1300

1176B "Merge it!" math "You are given an array a consisting of n integers a1,a2,\xe2\x80\xa6,an.In one operation you can choose two elements of the array and replace them with the element equal to their sum (it does not matter where you insert the new element). For example, from the array [2,1,4] you can obtain the following arrays: [3,4], [1,6] and [2,5].Your task is to find the maximum possible number of elements divisible by 3 that are in the array after performing this operation an arbitrary (possibly, zero) number of times.You have to answer t independent queries." 1100

1176A "Divide it!" "brute force,greedy,implementation" "You are given an integer n.You can perform any of the following operations with this number an arbitrary (possibly, zero) number of times:   Replace n with n2 if n is divisible by 2;  Replace n with 2n3 if n is divisible by 3;  Replace n with 4n5 if n is divisible by 5. For example, you can replace 30 with 15 using the first operation, with 20 using the second operation or with 24 using the third operation.Your task is to find the minimum number of moves required to obtain 1 from n or say that it is impossible to do it.You have to answer q independent queries." 800

1175G "Yet Another Partiton Problem" "data structures,divide and conquer,dp,geometry,two pointers" "You are given array a1,a2,\xe2\x80\xa6,an. You need to split it into k subsegments (so every element is included in exactly one subsegment).The weight of a subsegment al,al+1,\xe2\x80\xa6,ar is equal to (r\xe2\x88\x92l+1)\xe2\x8b\x85maxl\xe2\x89\xa4i\xe2\x89\xa4r(ai). The weight of a partition is a total weight of all its segments.Find the partition of minimal weight." 3000

1175F "The Number of Subpermutations" "brute force,data structures,divide and conquer,hashing,math" "You have an array a1,a2,\xe2\x80\xa6,an. Let\'s call some subarray al,al+1,\xe2\x80\xa6,ar of this array a subpermutation if it contains all integers from 1 to r\xe2\x88\x92l+1 exactly once. For example, array a=[2,2,1,3,2,3,1] contains 6 subarrays which are subpermutations: [a2\xe2\x80\xa6a3], [a2\xe2\x80\xa6a4], [a3\xe2\x80\xa6a3], [a3\xe2\x80\xa6a5], [a5\xe2\x80\xa6a7], [a7\xe2\x80\xa6a7].You are asked to calculate the number of subpermutations." 2500

1175E "Minimal Segment Cover" "data structures,dfs and similar,divide and conquer,dp,greedy,implementation,trees" "You are given n intervals in form [l;r] on a number line.You are also given m queries in form [x;y]. What is the minimal number of intervals you have to take so that every point (not necessarily integer) from x to y is covered by at least one of them? If you can\'t choose intervals so that every point from x to y is covered, then print -1 for that query." 2200

1175D "Array Splitting" greedy,sortings "You are given an array a1,a2,\xe2\x80\xa6,an and an integer k.You are asked to divide this array into k non-empty consecutive subarrays. Every element in the array should be included in exactly one subarray. Let f(i) be the index of subarray the i-th element belongs to. Subarrays are numbered from left to right and from 1 to k.Let the cost of division be equal to n\xe2\x88\x91i=1(ai\xe2\x8b\x85f(i)). For example, if a=[1,\xe2\x88\x922,\xe2\x88\x923,4,\xe2\x88\x925,6,\xe2\x88\x927] and we divide it into 3 subbarays in the following way: [1,\xe2\x88\x922,\xe2\x88\x923],[4,\xe2\x88\x925],[6,\xe2\x88\x927], then the cost of division is equal to 1\xe2\x8b\x851\xe2\x88\x922\xe2\x8b\x851\xe2\x88\x923\xe2\x8b\x851+4\xe2\x8b\x852\xe2\x88\x925\xe2\x8b\x852+6\xe2\x8b\x853\xe2\x88\x927\xe2\x8b\x853=\xe2\x88\x929.Calculate the maximum cost you can obtain by dividing the array a into k non-empty consecutive subarrays." 1900

1175C Electrification "binary search,brute force,greedy" "At first, there was a legend related to the name of the problem, but now it\'s just a formal statement.You are given n points a1,a2,\xe2\x80\xa6,an on the OX axis. Now you are asked to find such an integer point x on OX axis that fk(x) is minimal possible.The function fk(x) can be described in the following way:   form a list of distances d1,d2,\xe2\x80\xa6,dn where di=|ai\xe2\x88\x92x| (distance between ai and x);  sort list d in non-descending order;  take dk+1 as a result. If there are multiple optimal answers you can print any of them." 1600

1175B "Catch Overflow!" "data structures,expression parsing,implementation" "You are given a function f written in some basic language. The function accepts an integer value, which is immediately written into some variable x. x is an integer variable and can be assigned values from 0 to 232\xe2\x88\x921. The function contains three types of commands:  for n \xe2\x80\x94 for loop;  end \xe2\x80\x94 every command between ""for n"" and corresponding ""end"" is executed n times;  add \xe2\x80\x94 adds 1 to x. After the execution of these commands, value of x is returned.Every ""for n"" is matched with ""end"", thus the function is guaranteed to be valid. ""for n"" can be immediately followed by ""end"".""add"" command can be outside of any for loops.Notice that ""add"" commands might overflow the value of x! It means that the value of x becomes greater than 232\xe2\x88\x921 after some ""add"" command. Now you run f(0) and wonder if the resulting value of x is correct or some overflow made it incorrect.If overflow happened then output ""OVERFLOW!!!"", otherwise print the resulting value of x." 1600

1175A "From Hero to Zero" implementation,math "You are given an integer n and an integer k.In one step you can do one of the following moves:   decrease n by 1;  divide n by k if n is divisible by k. For example, if n=27 and k=3 you can do the following steps: 27\xe2\x86\x9226\xe2\x86\x9225\xe2\x86\x9224\xe2\x86\x928\xe2\x86\x927\xe2\x86\x926\xe2\x86\x922\xe2\x86\x921\xe2\x86\x920.You are asked to calculate the minimum number of steps to reach 0 from n." 900

1174F "Ehab and the Big Finale" "constructive algorithms,divide and conquer,graphs,implementation,interactive,trees" "This is an interactive problem.You\'re given a tree consisting of n nodes, rooted at node 1. A tree is a connected graph with no cycles.We chose a hidden node x. In order to find this node, you can ask queries of two types:   d u (1\xe2\x89\xa4u\xe2\x89\xa4n). We will answer with the distance between nodes u and x. The distance between two nodes is the number of edges in the shortest path between them.  s u (1\xe2\x89\xa4u\xe2\x89\xa4n). We will answer with the second node on the path from u to x. However, there\'s a plot twist. If u is not an ancestor of x, you\'ll receive ""Wrong answer"" verdict! Node a is called an ancestor of node b if a\xe2\x89\xa0b and the shortest path from node 1 to node b passes through node a. Note that in this problem a node is not an ancestor of itself.Can you find x in no more than 36 queries? The hidden node is fixed in each test beforehand and does not depend on your queries." 2400

1174E "Ehab and the Expected GCD Problem" "combinatorics,dp,math,number theory" "Let\'s define a function f(p) on a permutation p as follows. Let gi be the greatest common divisor (GCD) of elements p1, p2, ..., pi (in other words, it is the GCD of the prefix of length i). Then f(p) is the number of distinct elements among g1, g2, ..., gn.Let fmax(n) be the maximum value of f(p) among all permutations p of integers 1, 2, ..., n.Given an integers n, count the number of permutations p of integers 1, 2, ..., n, such that f(p) is equal to fmax(n). Since the answer may be large, print the remainder of its division by 1000000007=109+7." 2500

1174D "Ehab and the Expected XOR Problem" "bitmasks,constructive algorithms" "Given two integers n and x, construct an array that satisfies the following conditions:   for any element ai in the array, 1\xe2\x89\xa4ai<2n;  there is no non-empty subsegment with bitwise XOR equal to 0 or x,  its length l should be maximized. A sequence b is a subsegment of a sequence a if b can be obtained from a by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 1900

1174C "Ehab and a Special Coloring Problem" "constructive algorithms,number theory" "You\'re given an integer n. For every integer i from 2 to n, assign a positive integer ai such that the following conditions hold:  For any pair of integers (i,j), if i and j are coprime, ai\xe2\x89\xa0aj.  The maximal value of all ai should be minimized (that is, as small as possible). A pair of integers is called coprime if their greatest common divisor is 1." 1300

1174B "Ehab Is an Odd Person" sortings "You\'re given an array a of length n. You can perform the following operation on it as many times as you want:  Pick two integers i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that ai+aj is odd, then swap ai and aj. What is lexicographically the smallest array you can obtain?An array x is lexicographically smaller than an array y if there exists an index i such that xi<yi, and xj=yj for all 1\xe2\x89\xa4j<i. Less formally, at the first index i in which they differ, xi<yi" 1200

1174A "Ehab Fails to Be Thanos" "constructive algorithms,greedy,sortings" "You\'re given an array a of length 2n. Is it possible to reorder it in such way so that the sum of the first n elements isn\'t equal to the sum of the last n elements?" 1000

1173B "Nauuo and Chess" "constructive algorithms,greedy" "Nauuo is a girl who loves playing chess.One day she invented a game by herself which needs n chess pieces to play on a m\xc3\x97m chessboard. The rows and columns are numbered from 1 to m. We denote a cell on the intersection of the r-th row and c-th column as (r,c).The game\'s goal is to place n chess pieces numbered from 1 to n on the chessboard, the i-th piece lies on (ri,ci), while the following rule is satisfied: for all pairs of pieces i and j, |ri\xe2\x88\x92rj|+|ci\xe2\x88\x92cj|\xe2\x89\xa5|i\xe2\x88\x92j|. Here |x| means the absolute value of x.However, Nauuo discovered that sometimes she couldn\'t find a solution because the chessboard was too small.She wants to find the smallest chessboard on which she can put n pieces according to the rules.She also wonders how to place the pieces on such a chessboard. Can you help her?" 1100

1173A "Nauuo and Votes" greedy "Nauuo is a girl who loves writing comments.One day, she posted a comment on Codeforces, wondering whether she would get upvotes or downvotes.It\'s known that there were x persons who would upvote, y persons who would downvote, and there were also another z persons who would vote, but you don\'t know whether they would upvote or downvote. Note that each of the x+y+z people would vote exactly one time.There are three different results: if there are more people upvote than downvote, the result will be ""+""; if there are more people downvote than upvote, the result will be ""-""; otherwise the result will be ""0"".Because of the z unknown persons, the result may be uncertain (i.e. there are more than one possible results). More formally, the result is uncertain if and only if there exist two different situations of how the z persons vote, that the results are different in the two situations.Tell Nauuo the result or report that the result is uncertain." 800

1172F "Nauuo and Bug" "data structures" "Nauuo is a girl who loves coding.One day she was solving a problem which requires to calculate a sum of some numbers modulo pp.She wrote the following code and got the verdict ""Wrong answer"".She soon discovered the bug \xe2\x80\x94 the ModAdd function only worked for numbers in the range [0,p)[0,p), but the numbers in the problem may be out of the range. She was curious about the wrong function, so she wanted to know the result of it.However, the original code worked too slow, so she asked you to help her.You are given an array a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an and a number pp. Nauuo will make mm queries, in each query, you are given ll and rr, and you have to calculate the results of Sum(a,l,r,p). You can see the definition of the Sum function in the pseudocode above.Note that the integers won\'t overflow in the code above." 3300

1172E "Nauuo and ODT" "data structures" "Nauuo is a girl who loves traveling.One day she went to a tree, Old Driver Tree, literally, a tree with an old driver on it.The tree is a connected graph consisting of nn nodes and n\xe2\x88\x921n\xe2\x88\x921 edges. Each node has a color, and Nauuo will visit the ODT through a simple path on the tree in the old driver\'s car.Nauuo wants to visit see more different colors in her journey, but she doesn\'t know which simple path she will be traveling on. So, she wants to calculate the sum of the numbers of different colors on all different paths. Can you help her?What\'s more, the ODT is being redecorated, so there will be mm modifications, each modification will change a single node\'s color. Nauuo wants to know the answer after each modification too.Note that in this problem, we consider the simple path from uu to vv and the simple path from vv to uu as two different simple paths if and only if u\xe2\x89\xa0vu\xe2\x89\xa0v." 3300

1172D "Nauuo and Portals" "constructive algorithms" "Nauuo is a girl who loves playing games related to portals.One day she was playing a game as follows.In an n\xc3\x97nn\xc3\x97n grid, the rows are numbered from 11 to nn from top to bottom, the columns are numbered from 11 to nn from left to right. We denote a cell on the intersection of the rr-th row and cc-th column as (r,c)(r,c).A portal is a pair of doors. You can travel from one of them to another without changing your direction. More formally, if you walk into a cell with a door, you will teleport to the cell with the other door of the same portal and then walk into the next cell facing the original direction. There can not be more than one doors in a single cell.The ""next cell"" is the nearest cell in the direction you are facing. For example, if you are facing bottom, the next cell of (2,5)(2,5) is (3,5)(3,5).If you walk into a cell without a door, you must walk into the next cell after that without changing the direction. If the next cell does not exist, you must exit the grid.You have to set some (possibly zero) portals in the grid, so that if you walk into (i,1)(i,1) facing right, you will eventually exit the grid from (ri,n)(ri,n), if you walk into (1,i)(1,i) facing bottom, you will exit the grid from (n,ci)(n,ci).It is guaranteed that both r1..nr1..n and c1..nc1..n are permutations of nn elements. A permutation of nn elements is a sequence of numbers p1,p2,\xe2\x80\xa6,pnp1,p2,\xe2\x80\xa6,pn in which every integer from 11 to nn appears exactly once.She got confused while playing the game, can you help her to find a solution?" 2900

1172C2 "Nauuo and Pictures (hard version)" dp,probabilities "The only difference between easy and hard versions is constraints.Nauuo is a girl who loves random picture websites.One day she made a random picture website by herself which includes n pictures.When Nauuo visits the website, she sees exactly one picture. The website does not display each picture with equal probability. The i-th picture has a non-negative weight wi, and the probability of the i-th picture being displayed is wi\xe2\x88\x91nj=1wj. That is to say, the probability of a picture to be displayed is proportional to its weight.However, Nauuo discovered that some pictures she does not like were displayed too often. To solve this problem, she came up with a great idea: when she saw a picture she likes, she would add 1 to its weight; otherwise, she would subtract 1 from its weight.Nauuo will visit the website m times. She wants to know the expected weight of each picture after all the m visits modulo 998244353. Can you help her?The expected weight of the i-th picture can be denoted by qipi where gcd(pi,qi)=1, you need to print an integer ri satisfying 0\xe2\x89\xa4ri<998244353 and ri\xe2\x8b\x85pi\xe2\x89\xa1qi(mod998244353). It can be proved that such ri exists and is unique." 2600

1172C1 "Nauuo and Pictures (easy version)" dp,probabilities "The only difference between easy and hard versions is constraints.Nauuo is a girl who loves random picture websites.One day she made a random picture website by herself which includes n pictures.When Nauuo visits the website, she sees exactly one picture. The website does not display each picture with equal probability. The i-th picture has a non-negative weight wi, and the probability of the i-th picture being displayed is wi\xe2\x88\x91nj=1wj. That is to say, the probability of a picture to be displayed is proportional to its weight.However, Nauuo discovered that some pictures she does not like were displayed too often. To solve this problem, she came up with a great idea: when she saw a picture she likes, she would add 1 to its weight; otherwise, she would subtract 1 from its weight.Nauuo will visit the website m times. She wants to know the expected weight of each picture after all the m visits modulo 998244353. Can you help her?The expected weight of the i-th picture can be denoted by qipi where gcd(pi,qi)=1, you need to print an integer ri satisfying 0\xe2\x89\xa4ri<998244353 and ri\xe2\x8b\x85pi\xe2\x89\xa1qi(mod998244353). It can be proved that such ri exists and is unique." 2300

1172B "Nauuo and Circle" "combinatorics,dfs and similar,dp,trees" "Nauuo is a girl who loves drawing circles.One day she has drawn a circle and wanted to draw a tree on it.The tree is a connected undirected graph consisting of nn nodes and n\xe2\x88\x921n\xe2\x88\x921 edges. The nodes are numbered from 11 to nn.Nauuo wants to draw a tree on the circle, the nodes of the tree should be in nn distinct points on the circle, and the edges should be straight without crossing each other.""Without crossing each other"" means that every two edges have no common point or the only common point is an endpoint of both edges.Nauuo wants to draw the tree using a permutation of nn elements. A permutation of nn elements is a sequence of integers p1,p2,\xe2\x80\xa6,pnp1,p2,\xe2\x80\xa6,pn in which every integer from 11 to nn appears exactly once.After a permutation is chosen Nauuo draws the ii-th node in the pipi-th point on the circle, then draws the edges connecting the nodes.The tree is given, Nauuo wants to know how many permutations are there so that the tree drawn satisfies the rule (the edges are straight without crossing each other). She only wants to know the answer modulo 998244353998244353, can you help her?It is obvious that whether a permutation is valid or not does not depend on which nn points on the circle are chosen." 1900

1172A "Nauuo and Cards" greedy,implementation "Nauuo is a girl who loves playing cards.One day she was playing cards but found that the cards were mixed with some empty ones.There are n cards numbered from 1 to n, and they were mixed with another n empty cards. She piled up the 2n cards and drew n of them. The n cards in Nauuo\'s hands are given. The remaining n cards in the pile are also given in the order from top to bottom.In one operation she can choose a card in her hands and play it \xe2\x80\x94 put it at the bottom of the pile, then draw the top card from the pile.Nauuo wants to make the n numbered cards piled up in increasing order (the i-th card in the pile from top to bottom is the card i) as quickly as possible. Can you tell her the minimum number of operations?" 1800

1170I "Good Subsets" "*special problem,dp" "You are given n segments on the Ox axis. The i-th segment is given as a pair li,ri, where li is the position of the left end of the i-th segment and ri is the position of the right end of the i-th segment. Segments may intersect, overlap, or even coincide. A segment is a set of numbers (including floating-point numbers) lying between the segment ends or coinciding with them. Formally, the segment [l,r]={x�|�x\xe2\x88\x88R,�l\xe2\x89\xa4x\xe2\x89\xa4r}.Let the union of segments be the set of all axis points covered by the set of segments. Let\'s call a subset of the given segments good if its union equals the union of all n segments.Your task is to calculate the number of good subsets of the given n segments. Since the answer may be very large, print it modulo 998244353." -999

1170H "Longest Saw" "*special problem,constructive algorithms" "You are given the sequence a1,a2,\xe2\x80\xa6,an. You can choose any subset of elements and then reorder them to create a ""saw"".The sequence b1,b2,\xe2\x80\xa6,bm is called a ""saw"" if the elements satisfy one of the following series of inequalities: b1>b2<b3>b4<\xe2\x80\xa6 or b1<b2>b3<b4>\xe2\x80\xa6.Find the longest saw which can be obtained from a given array.Note that both the given sequence a and the required saw b can contain duplicated (non-unique) values." -999

1170G "Graph Decomposition" "*special problem,graphs" "You are given an undirected graph consisting of nn vertices and mm edges.Recall that a cycle is a path that starts and ends in the same vertex. A cycle in a graph is called simple if it contains each vertex (except the starting and ending one) no more than once (the starting and the ending one is contained always twice). Note that loops are considered to be simple cycles.In one move you can choose any simple cycle in this graph and erase the edges corresponding to this cycle (corresponding vertices remain in the graph). It is allowed to erase the loop or two copies of the same edge (take a look at examples).Your problem is to apply some sequence of moves to obtain the graph without edges. It is not necessary to minimize the number of cycles. If it is impossible, print ""NO""." -999

1170F Wheels "*special problem,binary search,greedy" "Polycarp has n wheels and a car with m slots for wheels. The initial pressure in the i-th wheel is ai.Polycarp\'s goal is to take exactly m wheels among the given n wheels and equalize the pressure in them (then he can put these wheels in a car and use it for driving). In one minute he can decrease or increase the pressure in any (single) wheel by 1. He can increase the pressure no more than k times in total because it is hard to pump up wheels.Help Polycarp and say what is the minimum number of minutes he needs to spend to equalize the pressure of at least m wheels among the given n wheels." -999

1170E "Sliding Doors" "*special problem,binary search" "Imagine that you are the CEO of a big old-fashioned company. Unlike any modern and progressive company (such as JetBrains), your company has a dress code. That\'s why you have already allocated a spacious room for your employees where they can change their clothes. Moreover, you\'ve already purchased an mm-compartment wardrobe, so the ii-th employee can keep his/her belongings in the ii-th cell (of course, all compartments have equal widths).The issue has occurred: the wardrobe has sliding doors! More specifically, the wardrobe has nn doors (numbered from left to right) and the jj-th door has width equal to ajaj wardrobe\'s cells. The wardrobe has single rails so that no two doors can slide past each other.  Extremely schematic example of a wardrobe: m=9m=9, n=2n=2, a1=2a1=2, a2=3a2=3. The problem is as follows: sometimes to open some cells you must close some other cells (since all doors are placed on the single track). For example, if you have a 44-compartment wardrobe (i.e. m=4m=4) with n=2n=2 one-cell doors (i.e. a1=a2=1a1=a2=1) and you need to open the 11-st and the 33-rd cells, you have to close the 22-nd and the 44-th cells.As CEO, you have a complete schedule for the next qq days. Now you are wondering: is it possible that all employees who will come on the kk-th day can access their cells simultaneously?" -999

1170D "Decoding of Integer Sequences" "*special problem,data structures,implementation" "Polycarp is developing a method for transmitting n integer sequences over a network. This method should support the transmission of an arbitrary number of integer sequences; sequences can have different lengths. The sequences contain arbitrary non-negative integers.Polycarp developed the following encoding procedure:  We assume that the sequences are numbered from 1 to n.  We add a special terminating marker to each sequence at the end, an element equal to -1.  The encoding result is a new single sequence that contains all the elements of the specified n in a special order: first, add to the result of coding all the first elements of the sequences (in the order from the 1-st to the n-th), then all the second elements (in the order from the 1-st to the n-th) and so on, if the sequence does not have the corresponding element, then it is simply skipped. The process ends when all elements of all sequences are added. For example, if you want to encode three sequences [3,1,4], [2,7] and [1,2,3,4], then the sequence of actions will be as follows:  we modify all three sequences by appending -1: [3,1,4,\xe2\x88\x921], [2,7,\xe2\x88\x921] and [1,2,3,4,\xe2\x88\x921];  we write out all the first elements, we get [3,2,1];  then write down all the second elements, we get [3,2,1,1,7,2];  then write down all the third elements, we get [3,2,1,1,7,2,4,\xe2\x88\x921,3];  then write down all fourth elements, get [3,2,1,1,7,2,4,\xe2\x88\x921,3,\xe2\x88\x921,4] (note that the second sequence has already ended);  then write down all the fifth elements, we get [3,2,1,1,7,2,4,\xe2\x88\x921,3,\xe2\x88\x921,4,\xe2\x88\x921] (note that the first and second sequences have already ended);  all the sequences are ended now, and the encoding process is finished;  the encoding result is: [3,2,1,1,7,2,4,\xe2\x88\x921,3,\xe2\x88\x921,4,\xe2\x88\x921]. Your task is to implement decoding by a given encoding result." -999

1170C "Minus and Minus Give Plus" "*special problem,implementation,strings" "Everyone knows that two consecutive (adjacent) ""minus"" signs can be replaced with a single ""plus"" sign.You are given the string s, consisting of ""plus"" and ""minus"" signs only. Zero or more operations can be performed with it. In each operation you can choose any two adjacent ""minus"" signs, and replace them with a single ""plus"" sign. Thus, in one operation, the length of the string is reduced by exactly 1.You are given two strings s and t. Determine if you can use 0 or more operations to get the string t from the string s." -999

1170B "Bad Days" "*special problem,implementation" "Every day Kotlin heroes analyze the statistics of their website. For n days, they wrote out n numbers a1,a2,\xe2\x80\xa6,an, where ai is the number of visits on the i-th day.They believe that a day is bad if there are at least 2 days before it with a strictly greater number of visits. For example, if n=8 and a=[3,1,4,1,5,9,2,6], then the day 4 is bad (because a4=1, but there are a1=3 and a3=4). Also, the day with the number 7 is bad too.Write a program that finds the number of bad days." -999

1170A "Three Integers Again" "*special problem,math" "We have three positive integers a, b and c. You don\'t know their values, but you know some information about them. Consider all three pairwise sums, i.e. the numbers a+b, a+c and b+c. You know exactly two (any) of three pairwise sums.Your task is to find such three positive integers a, b and c which match the given information. It means that if you consider a+b, a+c and b+c, two out of all three of them are given in the input. Among all such triples, you must choose one with the minimum possible sum a+b+c, and among all triples with the minimum sum, you can print any.You have to process q independent queries." -999

1169B Pairs graphs,implementation "Toad Ivan has m pairs of integers, each integer is between 1 and n, inclusive. The pairs are (a1,b1),(a2,b2),\xe2\x80\xa6,(am,bm). He asks you to check if there exist two integers x and y (1\xe2\x89\xa4x<y\xe2\x89\xa4n) such that in each given pair at least one integer is equal to x or y." 1500

1169A "Circle Metro" implementation,math "The circle line of the Roflanpolis subway has n stations.There are two parallel routes in the subway. The first one visits stations in order 1\xe2\x86\x922\xe2\x86\x92\xe2\x80\xa6\xe2\x86\x92n\xe2\x86\x921\xe2\x86\x922\xe2\x86\x92\xe2\x80\xa6 (so the next stop after station x is equal to (x+1) if x<n and 1 otherwise). The second route visits stations in order n\xe2\x86\x92(n\xe2\x88\x921)\xe2\x86\x92\xe2\x80\xa6\xe2\x86\x921\xe2\x86\x92n\xe2\x86\x92(n\xe2\x88\x921)\xe2\x86\x92\xe2\x80\xa6 (so the next stop after station x is equal to (x\xe2\x88\x921) if x>1 and n otherwise). All trains depart their stations simultaneously, and it takes exactly 1 minute to arrive at the next station.Two toads live in this city, their names are Daniel and Vlad.Daniel is currently in a train of the first route at station a and will exit the subway when his train reaches station x.Coincidentally, Vlad is currently in a train of the second route at station b and he will exit the subway when his train reaches station y.Surprisingly, all numbers a,x,b,y are distinct.Toad Ilya asks you to check if Daniel and Vlad will ever be at the same station at the same time during their journey. In other words, check if there is a moment when their trains stop at the same station. Note that this includes the moments when Daniel or Vlad enter or leave the subway." 900

1168E "Xor Permutations" "constructive algorithms,math" "Toad Mikhail has an array of 2k integers a1,a2,\xe2\x80\xa6,a2k.Find two permutations p and q of integers 0,1,\xe2\x80\xa6,2k\xe2\x88\x921, such that ai is equal to pi\xe2\x8a\x95qi for all possible i, or determine there are no such permutations. Here \xe2\x8a\x95 denotes the bitwise XOR operation." 3100

1168D "Anagram Paths" dp,implementation,trees "Toad Ilya has a rooted binary tree with vertex 1 being the root. A tree is a connected graph without cycles. A tree is rooted if one vertex is selected and called the root. A vertex u is a child of a vertex v if u and v are connected by an edge and v is closer to the root than u. A leaf is a non-root vertex that has no children.In the tree Ilya has each vertex has at most two children, and each edge has some character written on it. The character can be a lowercase English letter or the question mark \'?\'.Ilya will q times update the tree a bit. Each update will replace exactly one character on some edge. After each update Ilya needs to find if the tree is anagrammable and if yes, find its anagramnity for each letter. Well, that\'s difficult to explain, but we\'ll try.To start with, a string a is an anagram of a string b if it is possible to rearrange letters in a (without changing the letters itself) so that it becomes b. For example, the string ""fortyfive"" is an anagram of the string ""overfifty"", but the string ""aabb"" is not an anagram of the string ""bbba"".Consider a path from the root of the tree to a leaf. The characters on the edges on this path form a string, we say that this string is associated with this leaf. The tree is anagrammable if and only if it is possible to replace each question mark with a lowercase English letter so that for all pair of leaves the associated strings for these leaves are anagrams of each other.If the tree is anagrammable, then its anagramnity for the letter c is the maximum possible number of letters c in a string associated with some leaf in a valid replacement of all question marks.Please after each update find if the tree is anagrammable and if yes, find the \xe2\x88\x91f(c)\xe2\x8b\x85ind(c) for all letters c, where f(c) is the anagramnity for the letter c, and ind(x) is the index of this letter in the alphabet (ind(""a"")=1, ind(""b"")=2, ..., ind(""z"")=26)." 3000

1168C "And Reachability" bitmasks,dp "Toad Pimple has an array of integers a1,a2,\xe2\x80\xa6,an.We say that y is reachable from x if x<y and there exists an integer array p such that x=p1<p2<\xe2\x80\xa6<pk=y, and api&api+1>0 for all integers i such that 1\xe2\x89\xa4i<k.Here & denotes the bitwise AND operation.You are given q pairs of indices, check reachability for each of them." 2200

1168B "Good Triple" "brute force,two pointers" "Toad Rash has a binary string s. A binary string consists only of zeros and ones.Let n be the length of s.Rash needs to find the number of such pairs of integers l, r that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and there is at least one pair of integers x, k such that 1\xe2\x89\xa4x,k\xe2\x89\xa4n, l\xe2\x89\xa4x<x+2k\xe2\x89\xa4r, and sx=sx+k=sx+2k.Find this number of pairs for Rash." 1900

1168A "Increasing by Modulo" "binary search,greedy" "Toad Zitz has an array of integers, each integer is between 0 and m\xe2\x88\x921 inclusive. The integers are a1,a2,\xe2\x80\xa6,an.In one operation Zitz can choose an integer k and k indices i1,i2,\xe2\x80\xa6,ik such that 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n. He should then change aij to ((aij+1)modm) for each chosen integer ij. The integer m is fixed for all operations and indices.Here xmody denotes the remainder of the division of x by y.Zitz wants to make his array non-decreasing with the minimum number of such operations. Find this minimum number of operations." 1700

1167G "Low Budget Inception" "brute force,geometry" "So we got bored and decided to take our own guess at how would ""Inception"" production go if the budget for the film had been terribly low.The first scene we remembered was the one that features the whole city bending onto itself:  It feels like it will require high CGI expenses, doesn\'t it? Luckily, we came up with a similar-looking scene which was a tiny bit cheaper to make.Firstly, forget about 3D, that\'s hard and expensive! The city is now represented as a number line (infinite to make it easier, of course).Secondly, the city doesn\'t have to look natural at all. There are nn buildings on the line. Each building is a square 1\xc3\x9711\xc3\x971. Buildings are numbered from 11 to nn in ascending order of their positions. Lower corners of building ii are at integer points aiai and ai+1ai+1 of the number line. Also the distance between any two neighbouring buildings ii and i+1i+1 doesn\'t exceed dd (really, this condition is here just to make the city look not that sparse). Distance between some neighbouring buildings ii and i+1i+1 is calculated from the lower right corner of building ii to the lower left corner of building i+1i+1.Finally, curvature of the bend is also really hard to simulate! Let the bend at some integer coordinate xx be performed with the following algorithm. Take the ray from xx to +\xe2\x88\x9e+\xe2\x88\x9e and all the buildings which are on this ray and start turning the ray and the buildings counter-clockwise around point xx. At some angle some building will touch either another building or a part of the line. You have to stop bending there (implementing buildings crushing is also not worth its money). Let\'s call the angle between two rays in the final state the terminal angle \xce\xb1x\xce\xb1x.The only thing left is to decide what integer point xx is the best to start bending around. Fortunately, we\'ve already chosen mm candidates to perform the bending.So, can you please help us to calculate terminal angle \xce\xb1x\xce\xb1x for each bend xx from our list of candidates?" 3100

1167F "Scalar Queries" "combinatorics,data structures,math,sortings" "You are given an array a1,a2,\xe2\x80\xa6,an. All ai are pairwise distinct.Let\'s define function f(l,r) as follows:   let\'s define array b1,b2,\xe2\x80\xa6,br\xe2\x88\x92l+1, where bi=al\xe2\x88\x921+i;  sort array b in increasing order;  result of the function f(l,r) is r\xe2\x88\x92l+1\xe2\x88\x91i=1bi\xe2\x8b\x85i. Calculate (\xe2\x88\x911\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4nf(l,r))mod(109+7), i.e. total sum of f for all subsegments of a modulo 109+7." 2300

1167E "Range Deleting" "binary search,combinatorics,data structures,two pointers" "You are given an array consisting of n integers a1,a2,\xe2\x80\xa6,an and an integer x. It is guaranteed that for every i, 1\xe2\x89\xa4ai\xe2\x89\xa4x.Let\'s denote a function f(l,r) which erases all values such that l\xe2\x89\xa4ai\xe2\x89\xa4r from the array a and returns the resulting array. For example, if a=[4,1,1,4,5,2,4,3], then f(2,4)=[1,1,5].Your task is to calculate the number of pairs (l,r) such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4x and f(l,r) is sorted in non-descending order. Note that the empty array is also considered sorted." 2100

1167D "Bicolored RBS" "constructive algorithms,greedy" "A string is called bracket sequence if it does not contain any characters other than ""("" and "")"". A bracket sequence is called regular (shortly, RBS) if it is possible to obtain correct arithmetic expression by inserting characters ""+"" and ""1"" into this sequence. For example, """", ""(())"" and ""()()"" are RBS and "")("" and ""(()"" are not.We can see that each opening bracket in RBS is paired with some closing bracket, and, using this fact, we can define nesting depth of the RBS as maximum number of bracket pairs, such that the 2-nd pair lies inside the 1-st one, the 3-rd one \xe2\x80\x94 inside the 2-nd one and so on. For example, nesting depth of """" is 0, ""()()()"" is 1 and ""()((())())"" is 3.Now, you are given RBS s of even length n. You should color each bracket of s into one of two colors: red or blue. Bracket sequence r, consisting only of red brackets, should be RBS, and bracket sequence, consisting only of blue brackets b, should be RBS. Any of them can be empty. You are not allowed to reorder characters in s, r or b. No brackets can be left uncolored.Among all possible variants you should choose one that minimizes maximum of r\'s and b\'s nesting depth. If there are multiple solutions you can print any of them." 1500

1167C "News Distribution" "dfs and similar,dsu,graphs" "In some social network, there are n users communicating with each other in m groups of friends. Let\'s analyze the process of distributing some news between users.Initially, some user x receives the news from some source. Then he or she sends the news to his or her friends (two users are friends if there is at least one group such that both of them belong to this group). Friends continue sending the news to their friends, and so on. The process ends when there is no pair of friends such that one of them knows the news, and another one doesn\'t know.For each user x you have to determine what is the number of users that will know the news if initially only user x starts distributing it." 1400

1167B "Lost Numbers" "brute force,divide and conquer,interactive,math" "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.The jury guessed some array a consisting of 6 integers. There are 6 special numbers \xe2\x80\x94 4, 8, 15, 16, 23, 42 \xe2\x80\x94 and each of these numbers occurs in a exactly once (so, a is some permutation of these numbers).You don\'t know anything about their order, but you are allowed to ask up to 4 queries. In each query, you may choose two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa46, i and j are not necessarily distinct), and you will get the value of ai\xe2\x8b\x85aj in return.Can you guess the array a?The array a is fixed beforehand in each test, the interaction program doesn\'t try to adapt to your queries." 1400

1167A "Telephone Number" "brute force,greedy,strings" "A telephone number is a sequence of exactly 11 digits, where the first digit is 8. For example, the sequence 80011223388 is a telephone number, but the sequences 70011223388 and 80000011223388 are not.You are given a string s of length n, consisting of digits.In one operation you can delete any character from string s. For example, it is possible to obtain strings 112, 111 or 121 from string 1121.You need to determine whether there is such a sequence of operations (possibly empty), after which the string s becomes a telephone number." 800

1166F "Vicky\'s Delivery Service" "data structures,dsu,graphs,hashing" "A telephone number is a sequence of exactly 11 digits, where the first digit is 8. For example, the sequence 80011223388 is a telephone number, but the sequences 70011223388 and 80000011223388 are not.You are given a string s of length n, consisting of digits.In one operation you can delete any character from string s. For example, it is possible to obtain strings 112, 111 or 121 from string 1121.You need to determine whether there is such a sequence of operations (possibly empty), after which the string s becomes a telephone number." 2400

1166E "The LCMs Must be Large" "bitmasks,brute force,constructive algorithms,math,number theory" "Dora the explorer has decided to use her money after several years of juicy royalties to go shopping. What better place to shop than Nlogonia?There are n stores numbered from 1 to n in Nlogonia. The i-th of these stores offers a positive integer ai.Each day among the last m days Dora bought a single integer from some of the stores. The same day, Swiper the fox bought a single integer from all the stores that Dora did not buy an integer from on that day.Dora considers Swiper to be her rival, and she considers that she beat Swiper on day i if and only if the least common multiple of the numbers she bought on day i is strictly greater than the least common multiple of the numbers that Swiper bought on day i.The least common multiple (LCM) of a collection of integers is the smallest positive integer that is divisible by all the integers in the collection.However, Dora forgot the values of ai. Help Dora find out if there are positive integer values of ai such that she beat Swiper on every day. You don\'t need to find what are the possible values of ai though.Note that it is possible for some values of ai to coincide in a solution." 2100

1166D "Cute Sequences" "binary search,brute force,greedy,math" "Given a positive integer m, we say that a sequence x1,x2,\xe2\x80\xa6,xn of positive integers is m-cute if for every index i such that 2\xe2\x89\xa4i\xe2\x89\xa4n it holds that xi=xi\xe2\x88\x921+xi\xe2\x88\x922+\xe2\x8b\xaf+x1+ri for some positive integer ri satisfying 1\xe2\x89\xa4ri\xe2\x89\xa4m.You will be given q queries consisting of three positive integers a, b and m. For each query you must determine whether or not there exists an m-cute sequence whose first term is a and whose last term is b. If such a sequence exists, you must additionally find an example of it." 2200

1166C "A Tale of Two Lands" "binary search,sortings,two pointers" "The legend of the foundation of Vectorland talks of two integers xx and yy. Centuries ago, the array king placed two markers at points |x||x| and |y||y| on the number line and conquered all the land in between (including the endpoints), which he declared to be Arrayland. Many years later, the vector king placed markers at points |x\xe2\x88\x92y||x\xe2\x88\x92y| and |x+y||x+y| and conquered all the land in between (including the endpoints), which he declared to be Vectorland. He did so in such a way that the land of Arrayland was completely inside (including the endpoints) the land of Vectorland.Here |z||z| denotes the absolute value of zz.Now, Jose is stuck on a question of his history exam: ""What are the values of xx and yy?"" Jose doesn\'t know the answer, but he believes he has narrowed the possible answers down to nn integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an. Now, he wants to know the number of unordered pairs formed by two different elements from these nn integers such that the legend could be true if xx and yy were equal to these two values. Note that it is possible that Jose is wrong, and that no pairs could possibly make the legend true." 1500

1166B "All the Vowels Please" "constructive algorithms,math,number theory" "Tom loves vowels, and he likes long words with many vowels. His favorite words are vowelly words. We say a word of length kk is vowelly if there are positive integers nn and mm such that n\xe2\x8b\x85m=kn\xe2\x8b\x85m=k and when the word is written by using nn rows and mm columns (the first row is filled first, then the second and so on, with each row filled from left to right), every vowel of the English alphabet appears at least once in every row and every column.You are given an integer kk and you must either print a vowelly word of length kk or print \xe2\x88\x921\xe2\x88\x921 if no such word exists.In this problem the vowels of the English alphabet are \'a\', \'e\', \'i\', \'o\' ,\'u\'." 1100

1166A "Silent Classroom" combinatorics,greedy "There are n students in the first grade of Nlogonia high school. The principal wishes to split the students into two classrooms (each student must be in exactly one of the classrooms). Two distinct students whose name starts with the same letter will be chatty if they are put in the same classroom (because they must have a lot in common). Let x be the number of such pairs of students in a split. Pairs (a,b) and (b,a) are the same and counted only once.For example, if there are 6 students: ""olivia"", ""jacob"", ""tanya"", ""jack"", ""oliver"" and ""jessica"", then:  splitting into two classrooms (""jack"", ""jacob"", ""jessica"", ""tanya"") and (""olivia"", ""oliver"") will give x=4 (3 chatting pairs in the first classroom, 1 chatting pair in the second classroom),  splitting into two classrooms (""jack"", ""tanya"", ""olivia"") and (""jessica"", ""oliver"", ""jacob"") will give x=1 (0 chatting pairs in the first classroom, 1 chatting pair in the second classroom). You are given the list of the n names. What is the minimum x we can obtain by splitting the students into classrooms?Note that it is valid to place all of the students in one of the classrooms, leaving the other one empty." 900

1165F2 "Microtransactions (hard version)" "binary search,greedy,implementation" "The only difference between easy and hard versions is constraints.Ivan plays a computer game that contains some microtransactions to make characters look cooler. Since Ivan wants his character to be really cool, he wants to use some of these microtransactions \xe2\x80\x94 and he won\'t start playing until he gets all of them.Each day (during the morning) Ivan earns exactly one burle.There are n types of microtransactions in the game. Each microtransaction costs 2 burles usually and 1 burle if it is on sale. Ivan has to order exactly ki microtransactions of the i-th type (he orders microtransactions during the evening).Ivan can order any (possibly zero) number of microtransactions of any types during any day (of course, if he has enough money to do it). If the microtransaction he wants to order is on sale then he can buy it for 1 burle and otherwise he can buy it for 2 burles.There are also m special offers in the game shop. The j-th offer (dj,tj) means that microtransactions of the tj-th type are on sale during the dj-th day.Ivan wants to order all microtransactions as soon as possible. Your task is to calculate the minimum day when he can buy all microtransactions he want and actually start playing." 2000

1165F1 "Microtransactions (easy version)" "binary search,greedy" "The only difference between easy and hard versions is constraints.Ivan plays a computer game that contains some microtransactions to make characters look cooler. Since Ivan wants his character to be really cool, he wants to use some of these microtransactions \xe2\x80\x94 and he won\'t start playing until he gets all of them.Each day (during the morning) Ivan earns exactly one burle.There are n types of microtransactions in the game. Each microtransaction costs 2 burles usually and 1 burle if it is on sale. Ivan has to order exactly ki microtransactions of the i-th type (he orders microtransactions during the evening).Ivan can order any (possibly zero) number of microtransactions of any types during any day (of course, if he has enough money to do it). If the microtransaction he wants to order is on sale then he can buy it for 1 burle and otherwise he can buy it for 2 burles.There are also m special offers in the game shop. The j-th offer (dj,tj) means that microtransactions of the tj-th type are on sale during the dj-th day.Ivan wants to order all microtransactions as soon as possible. Your task is to calculate the minimum day when he can buy all microtransactions he want and actually start playing." 2000

1165E "Two Arrays and Sum of Functions" greedy,math,sortings "You are given two arrays a and b, both of length n.Let\'s define a function f(l,r)=\xe2\x88\x91l\xe2\x89\xa4i\xe2\x89\xa4rai\xe2\x8b\x85bi.Your task is to reorder the elements (choose an arbitrary order of elements) of the array b to minimize the value of \xe2\x88\x911\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4nf(l,r). Since the answer can be very large, you have to print it modulo 998244353. Note that you should minimize the answer but not its remainder." 1600

1165D "Almost All Divisors" "math,number theory" "We guessed some integer number x. You are given a list of almost all its divisors. Almost all means that there are all divisors except 1 and x in the list.Your task is to find the minimum possible integer x that can be the guessed number, or say that the input data is contradictory and it is impossible to find such number.You have to answer t independent queries." 1600

1165C "Good String" greedy "Let\'s call (yet again) a string good if its length is even, and every character in odd position of this string is different from the next character (the first character is different from the second, the third is different from the fourth, and so on). For example, the strings good, string and xyyx are good strings, and the strings bad, aa and aabc are not good. Note that the empty string is considered good.You are given a string s, you have to delete minimum number of characters from this string so that it becomes good." 1300

1165B "Polycarp Training" "data structures,greedy,sortings" "Polycarp wants to train before another programming competition. During the first day of his training he should solve exactly 1 problem, during the second day \xe2\x80\x94 exactly 2 problems, during the third day \xe2\x80\x94 exactly 3 problems, and so on. During the k-th day he should solve k problems.Polycarp has a list of n contests, the i-th contest consists of ai problems. During each day Polycarp has to choose exactly one of the contests he didn\'t solve yet and solve it. He solves exactly k problems from this contest. Other problems are discarded from it. If there are no contests consisting of at least k problems that Polycarp didn\'t solve yet during the k-th day, then Polycarp stops his training.How many days Polycarp can train if he chooses the contests optimally?" 1000

1165A Remainder implementation,math "You are given a huge decimal number consisting of n digits. It is guaranteed that this number has no leading zeros. Each digit of this number is either 0 or 1.You may perform several (possibly zero) operations with this number. During each operation you are allowed to change any digit of your number; you may change 0 to 1 or 1 to 0. It is possible that after some operation you can obtain a number with leading zeroes, but it does not matter for this problem.You are also given two integers 0\xe2\x89\xa4y<x<n. Your task is to calculate the minimum number of operations you should perform to obtain the number that has remainder 10y modulo 10x. In other words, the obtained number should have remainder 10y when divided by 10x." 1100

1163F "Indecisive Taxi Fee" "data structures,graphs,shortest paths" "In the city of Capypaland where Kuro and Shiro resides, there are nn towns numbered from 11 to nn and there are mm bidirectional roads numbered from 11 to mm connecting them. The ii-th road connects towns uiui and vivi. Since traveling between the towns is quite difficult, the taxi industry is really popular here. To survive the harsh competition, each taxi company has to find a distinctive trait for their customers.Kuro is the owner of a taxi company. He has decided to introduce a new fee model for his taxi brand, where the fee for each ride is not calculated based on the trip length, but on the sum of the prices of the roads traveled. The price for each of the mm roads has been decided by Kuro himself.As of now, the price for the road ii is wiwi and hence the fee for a taxi ride traveling through roads e1,e2,\xe2\x80\xa6,eke1,e2,\xe2\x80\xa6,ek is \xe2\x88\x91ki=1wei\xe2\x88\x91i=1kwei.However, Kuro himself is an indecisive person, so he has drafted qq plans to change the road price. Each of the plans will be based on the original prices wiwi, except for a single road tjtj, the price of which is changed to xjxj. Note, that the plans are independent of each other.Shiro is a regular customer of the Kuro\'s taxi brand since she uses the taxi to travel from town 11 to town nn every day. Since she\'s so a regular customer, Kuro decided to show her all his qq plans before publishing them to the public. Now, Shiro wants to know the lowest fee she must pay to travel from the town 11 to the town nn for each Kuro\'s plan." 3000

1163E "Magical Permutation" "bitmasks,brute force,constructive algorithms,data structures,graphs,math" "Kuro has just learned about permutations and he is really excited to create a new permutation type. He has chosen n distinct positive integers and put all of them in a set S. Now he defines a magical permutation to be: A permutation of integers from 0 to 2x\xe2\x88\x921, where x is a non-negative integer.  The bitwise xor of any two consecutive elements in the permutation is an element in S.Since Kuro is really excited about magical permutations, he wants to create the longest magical permutation possible. In other words, he wants to find the largest non-negative integer x such that there is a magical permutation of integers from 0 to 2x\xe2\x88\x921. Since he is a newbie in the subject, he wants you to help him find this value of x and also the magical permutation for that x." 2400

1163D "Mysterious Code" dp,strings "During a normal walk in the forest, Katie has stumbled upon a mysterious code! However, the mysterious code had some characters unreadable. She has written down this code as a string c consisting of lowercase English characters and asterisks (""*""), where each of the asterisks denotes an unreadable character. Excited with her discovery, Katie has decided to recover the unreadable characters by replacing each asterisk with arbitrary lowercase English letter (different asterisks might be replaced with different letters).Katie has a favorite string s and a not-so-favorite string t and she would love to recover the mysterious code so that it has as many occurrences of s as possible and as little occurrences of t as possible. Formally, let\'s denote f(x,y) as the number of occurrences of y in x (for example, f(aababa,ab)=2). Katie wants to recover the code c\xe2\x80\xb2 conforming to the original c, such that f(c\xe2\x80\xb2,s)\xe2\x88\x92f(c\xe2\x80\xb2,t) is largest possible. However, Katie is not very good at recovering codes in general, so she would like you to help her out." 2100

1163C2 "Power Transmission (Hard Edition)" "data structures,geometry,implementation,math" "This problem is same as the previous one, but has larger constraints.It was a Sunday morning when the three friends Selena, Shiro and Katie decided to have a trip to the nearby power station (do not try this at home). After arriving at the power station, the cats got impressed with a large power transmission system consisting of many chimneys, electric poles, and wires. Since they are cats, they found those things gigantic.At the entrance of the station, there is a map describing the complicated wiring system. Selena is the best at math among three friends. He decided to draw the map on the Cartesian plane. Each pole is now a point at some coordinates (xi,yi)(xi,yi). Since every pole is different, all of the points representing these poles are distinct. Also, every two poles are connected with each other by wires. A wire is a straight line on the plane infinite in both directions. If there are more than two poles lying on the same line, they are connected by a single common wire.Selena thinks, that whenever two different electric wires intersect, they may interfere with each other and cause damage. So he wonders, how many pairs are intersecting? Could you help him with this problem?" 1900

1163C1 "Power Transmission (Easy Edition)" "brute force,geometry" "This problem is same as the next one, but has smaller constraints.It was a Sunday morning when the three friends Selena, Shiro and Katie decided to have a trip to the nearby power station (do not try this at home). After arriving at the power station, the cats got impressed with a large power transmission system consisting of many chimneys, electric poles, and wires. Since they are cats, they found those things gigantic.At the entrance of the station, there is a map describing the complicated wiring system. Selena is the best at math among three friends. He decided to draw the map on the Cartesian plane. Each pole is now a point at some coordinates (xi,yi). Since every pole is different, all of the points representing these poles are distinct. Also, every two poles are connected with each other by wires. A wire is a straight line on the plane infinite in both directions. If there are more than two poles lying on the same line, they are connected by a single common wire.Selena thinks, that whenever two different electric wires intersect, they may interfere with each other and cause damage. So he wonders, how many pairs are intersecting? Could you help him with this problem?" 1900

1163B2 "Cat Party (Hard Edition)" "data structures,implementation" "This problem is same as the previous one, but has larger constraints.Shiro\'s just moved to the new house. She wants to invite all friends of her to the house so they can play monopoly. However, her house is too small, so she can only invite one friend at a time.For each of the n days since the day Shiro moved to the new house, there will be exactly one cat coming to the Shiro\'s house. The cat coming in the i-th day has a ribbon with color ui. Shiro wants to know the largest number x, such that if we consider the streak of the first x days, it is possible to remove exactly one day from this streak so that every ribbon color that has appeared among the remaining x\xe2\x88\x921 will have the same number of occurrences.For example, consider the following sequence of ui: [2,2,1,1,5,4,4,5]. Then x=7 makes a streak, since if we remove the leftmost ui=5, each ribbon color will appear exactly twice in the prefix of x\xe2\x88\x921 days. Note that x=8 doesn\'t form a streak, since you must remove exactly one day. Since Shiro is just a cat, she is not very good at counting and needs your help finding the longest streak." 1600

1163B1 "Cat Party (Easy Edition)" "data structures,implementation" "This problem is same as the next one, but has smaller constraints.Shiro\'s just moved to the new house. She wants to invite all friends of her to the house so they can play monopoly. However, her house is too small, so she can only invite one friend at a time.For each of the n days since the day Shiro moved to the new house, there will be exactly one cat coming to the Shiro\'s house. The cat coming in the i-th day has a ribbon with color ui. Shiro wants to know the largest number x, such that if we consider the streak of the first x days, it is possible to remove exactly one day from this streak so that every ribbon color that has appeared among the remaining x\xe2\x88\x921 will have the same number of occurrences.For example, consider the following sequence of ui: [2,2,1,1,5,4,4,5]. Then x=7 makes a streak, since if we remove the leftmost ui=5, each ribbon color will appear exactly twice in the prefix of x\xe2\x88\x921 days. Note that x=8 doesn\'t form a streak, since you must remove exactly one day. Since Shiro is just a cat, she is not very good at counting and needs your help finding the longest streak." 1500

1163A "Eating Soup" greedy,math "The three friends, Kuro, Shiro, and Katie, met up again! It\'s time for a party...What the cats do when they unite? Right, they have a party. Since they wanted to have as much fun as possible, they invited all their friends. Now nn cats are at the party, sitting in a circle and eating soup. The rules are simple: anyone having finished their soup leaves the circle.Katie suddenly notices that whenever a cat leaves, the place where she was sitting becomes an empty space, which means the circle is divided into smaller continuous groups of cats sitting next to each other. At the moment Katie observes, there are mm cats who left the circle. This raises a question for Katie: what is the maximum possible number of groups the circle is divided into at the moment?Could you help her with this curiosity?You can see the examples and their descriptions with pictures in the ""Note"" section." 900

1162B "Double Matrix" "brute force,greedy" "You are given two n\xc3\x97m matrices containing integers. A sequence of integers is strictly increasing if each next number is greater than the previous one. A row is strictly increasing if all numbers from left to right are strictly increasing. A column is strictly increasing if all numbers from top to bottom are strictly increasing. A matrix is increasing if all rows are strictly increasing and all columns are strictly increasing. For example, the matrix [91011111214] is increasing because each individual row and column is strictly increasing. On the other hand, the matrix [1123] is not increasing because the first row is not strictly increasing.Let a position in the i-th row (from top) and j-th column (from left) in a matrix be denoted as (i,j). In one operation, you can choose any two numbers i and j and swap the number located in (i,j) in the first matrix with the number in (i,j) in the second matrix. In other words, you can swap two numbers in different matrices if they are located in the corresponding positions.You would like to make both matrices increasing by performing some number of operations (possibly none). Determine if it is possible to do this. If it is, print ""Possible"", otherwise, print ""Impossible""." 1400

1162A "Zoning Restrictions Again" implementation "You are planning to build housing on a street. There are n spots available on the street on which you can build a house. The spots are labeled from 1 to n from left to right. In each spot, you can build a house with an integer height between 0 and h.In each spot, if a house has height a, you will gain a2 dollars from it.The city has m zoning restrictions. The i-th restriction says that the tallest house from spots li to ri (inclusive) must be at most xi.You would like to build houses to maximize your profit. Determine the maximum profit possible." 800

1160A2 Collaboration "*special problem" "Consider several locations in integer points on the plane. One of the locations is the base where workers wait. Every other location contains one job.Each job has the following characteristics: work duration, the required number of workers, and also the earliest possible moment of starting the job and the latest possible moment of completing it. In order to complete the job, the required number of workers must simultaneously start working on it, and then be continuously present at the location for the duration of the job. Each job must either be fully done exactly once, or left untouched.Our task is to determine what should the workers do so that we have more profit. any worker can contribute to any job. We can use as many workers as we like, but each worker must take part in doing at least one job.Each worker starts at the base at a certain moment, then moves between locations and does the jobs, and finally gets back to the base and stops completely. A worker can move along coordinate axes, and spends one minute increasing or decreasing any one of his coordinates by 1. We have to pay the worker 240 credits for appearing in our solution, and additionally 1 credit per minute, up to the moment when the worker stops completely.We get rewarded for each job that is done. For a job with duration d and the required number of workers p, we get a reward of d\xe2\x8b\x85p\xe2\x8b\x85(p+5) credits. The jobs which are not done don\'t contribute to this sum.InputThe first line contains an integer n from 500 to 2000: the number of locations. Each of the following n lines contains six integers and describes one location in the format x�y�d�p�l�h. The coordinates x and y are integers from 0 to 100. The duration d is an integer from 5 to 30 minutes. The required number of workers p is an integer from 1 to 7 people. The earliest possible start moment l and the latest possible completion moment h are integers from 200 to 800 minutes, chosen so that 60\xe2\x89\xa4h\xe2\x88\x92l\xe2\x89\xa4300.The first location is the base. It is an exclusion to the rules above and has the format x�y�0�0�0�0. All given points (x,y) are distinct.In all tests, the number n, as well as all points, durations, numbers of required workers, and time spans are chosen randomly, independently, and uniformly from the available choices.OutputPrint instructions for each worker as a block of a few lines which look as follows:  start�(at-moment)�(at-location)The first line of a block. Determines the moment when the worker starts at the base. The location must be the base, and so have the number 1.  arrive�(at-moment)�(at-location)We want the worker to arrive at this moment to this location. If he can not make it in time after the previous command, the solution is considered incorrect. Locations are numbered from 1 to n in input order.  work�(start-moment)�(end-moment)�(at-location)We want the worker to do the job at this location in this exact time interval. The location must be equal to the location in the previous arrival command. If the worker can not make it in time after the previous command, or the given time interval has wrong length or exceeds the time span of the location, the solution is considered incorrect. This command must be present at least once in each block. Recall that each job must be either completed simultaneously by the required number of workers, or left untouched, otherwise, the solution will be considered incorrect.  endThe last line of a block. The worker must be in the same position where he started. At each moment, there may be arbitrarily many workers in each location. All moments in the output must be integers from 0 to 1000, and all location numbers must be integers from 1 to n.Print consecutive blocks one under the other, with no gaps.ExampleInputCopy45 15 0 0 0 02 13 30 2 200 4003 12 29 1 350 60039 21 9 4 671 757OutputCopystart 335 1arrive 340 2work 340 370 2arrive 372 3work 372 401 3arrive 406 1endstart 335 1arrive 340 2work 340 370 2arrive 375 1endExplanationThe reward for the job at location 2 is 30\xe2\x8b\x852\xe2\x8b\x85(2+5)=420 credits.The reward for the job at location 3 is 29\xe2\x8b\x851\xe2\x8b\x85(1+5)=174 credits.The job at location 4 is not completed.We have to pay 240+71=311 credits to the first worker.We also have to pay 240+40=280 credits to the second worker.Profit: 420+174\xe2\x88\x92311\xe2\x88\x92280=3.Note that this example is too short (n<500) and so does not appear in the testing system. It is included for explanatory purposes only.ScoringEach test is scored independently. The score for a test is the profit divided by 1000. It the profit is negative, the score is equal to zero. If a solution did not output a valid answer on a certain test, the result for this test is also zero.TestingYour solution will be checked on sets of tests generated in advance. A solution\'s score is the sum of its results on all the tests. If a solution did not output a valid answer on a certain test, the result for this test is zero.During the main phase of the contest, there are two ways to submit a solution.  The first one, problem A1, is to check on examples. There are 10 example tests which are also available for local testing. As soon as the solution is checked, you can see reports for all examples by clicking on the submission result. The tests for A1 are open, you can download them from the links https://assets.codeforces.com/rounds/1160/codeforces-vrt-2019.tar.gz (for Linux) and https://assets.codeforces.com/rounds/1160/codeforces-vrt-2019.zip (for Windows). After testing, you can click the verdict of your submission to see the result for each test.  The second way, problem A2, is to check on preliminary tests. There are 100 preliminary tests which are generated in advance but kept secret. The score for preliminary tests (but not for example tests) is used in the preliminary scoreboard. This score does not affect the final results, but nevertheless allows to roughly compare a solution with others. After the main phase ends, for each participant, the system chooses the final solution:  consider all solutions sent for preliminary testing;  choose the ones which got a total score strictly greater than zero;  define the final solution as the one of chosen solutions which has the latest submission time. Note that the solutions sent only to be checked on examples are not considered when choosing the final solution.During final testing, all final solutions will be checked on the same set of a large number (\xe2\x89\x881000) of final tests. The score for final tests determines the final scoreboard. The winner is the contestant whose solution gets the highest total score. In case two or more participants have equal total score, the contestants with such score tie for the same place." -999

1159B "Expansion coefficient of the array" implementation,math "Let\'s call an array of non-negative integers a1,a2,\xe2\x80\xa6,an a k-extension for some non-negative integer k if for all possible pairs of indices 1\xe2\x89\xa4i,j\xe2\x89\xa4n the inequality k\xe2\x8b\x85|i\xe2\x88\x92j|\xe2\x89\xa4min(ai,aj) is satisfied. The expansion coefficient of the array a is the maximal integer k such that the array a is a k-extension. Any array is a 0-expansion, so the expansion coefficient always exists.You are given an array of non-negative integers a1,a2,\xe2\x80\xa6,an. Find its expansion coefficient." 1300

1159A "A pile of stones" implementation,math "Vasya has a pile, that consists of some number of stones. n times he either took one stone from the pile or added one stone to the pile. The pile was non-empty before each operation of taking one stone from the pile.You are given n operations which Vasya has made. Find the minimal possible number of stones that can be in the pile after making these operations." 800

1158F "Density of subarrays" dp,math "Let c be some positive integer. Let\'s call an array a1,a2,\xe2\x80\xa6,an of positive integers c-array, if for all i condition 1\xe2\x89\xa4ai\xe2\x89\xa4c is satisfied. Let\'s call c-array b1,b2,\xe2\x80\xa6,bk a subarray of c-array a1,a2,\xe2\x80\xa6,an, if there exists such set of k indices 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n that bj=aij for all 1\xe2\x89\xa4j\xe2\x89\xa4k. Let\'s define density of c-array a1,a2,\xe2\x80\xa6,an as maximal non-negative integer p, such that any c-array, that contains p numbers is a subarray of a1,a2,\xe2\x80\xa6,an.You are given a number c and some c-array a1,a2,\xe2\x80\xa6,an. For all 0\xe2\x89\xa4p\xe2\x89\xa4n find the number of sequences of indices 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n for all 1\xe2\x89\xa4k\xe2\x89\xa4n, such that density of array ai1,ai2,\xe2\x80\xa6,aik is equal to p. Find these numbers by modulo 998244353, because they can be too large." 3500

1158E "Strange device" "binary search,interactive,math,trees" "It is an interactive problem.Vasya enjoys solving quizzes. He found a strange device and wants to know how it works.This device encrypted with the tree (connected undirected graph without cycles) with nn vertices, numbered with integers from 11 to nn. To solve this quiz you should guess this tree.Fortunately, this device can make one operation, using which you should guess the cipher. You can give the device an array d1,d2,\xe2\x80\xa6,dnd1,d2,\xe2\x80\xa6,dn of non-negative integers. On the device, there are nn lamps, ii-th of them is connected with ii-th vertex of the tree. For all ii the light will turn on the ii-th lamp, if there exist such vertex of the tree with number j\xe2\x89\xa0ij\xe2\x89\xa0i that dist(i,j)\xe2\x89\xa4djdist(i,j)\xe2\x89\xa4dj. Let\'s define dist(i,j)dist(i,j) as the distance between vertices ii and jj in tree or number of edges on the simple path between vertices ii and jj.Vasya wants to solve this quiz using \xe2\x89\xa480\xe2\x89\xa480 operations with the device and guess the tree. Help him!" 3400

1158D "Winding polygonal line" "constructive algorithms,geometry,greedy,math" "Vasya has nn different points A1,A2,\xe2\x80\xa6AnA1,A2,\xe2\x80\xa6An on the plane. No three of them lie on the same line He wants to place them in some order Ap1,Ap2,\xe2\x80\xa6,ApnAp1,Ap2,\xe2\x80\xa6,Apn, where p1,p2,\xe2\x80\xa6,pnp1,p2,\xe2\x80\xa6,pn�\xe2\x80\x94 some permutation of integers from 11 to nn.After doing so, he will draw oriented polygonal line on these points, drawing oriented segments from each point to the next in the chosen order. So, for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x9211\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 he will draw oriented segment from point ApiApi to point Api+1Api+1. He wants to make this polygonal line satisfying 22 conditions:   it will be non-self-intersecting, so any 22 segments which are not neighbors don\'t have common points.  it will be winding. Vasya has a string ss, consisting of (n\xe2\x88\x922)(n\xe2\x88\x922) symbols ""L"" or ""R"". Let\'s call an oriented polygonal line winding, if its ii-th turn left, if si=si= ""L"" and right, if si=si= ""R"". More formally: ii-th turn will be in point Api+1Api+1, where oriented segment from point ApiApi to point Api+1Api+1 changes to oriented segment from point Api+1Api+1 to point Api+2Api+2. Let\'s define vectors v1\xe2\x86\x92=ApiApi+1\xe2\x88\x92\xe2\x86\x92\xe2\x88\x92\xe2\x88\x92\xe2\x88\x92\xe2\x88\x92v1\xe2\x86\x92=ApiApi+1\xe2\x86\x92 and v2\xe2\x86\x92=Api+1Api+2\xe2\x88\x92\xe2\x86\x92\xe2\x88\x92\xe2\x88\x92\xe2\x88\x92\xe2\x88\x92\xe2\x88\x92v2\xe2\x86\x92=Api+1Api+2\xe2\x86\x92. Then if in order to rotate the vector v1\xe2\x86\x92v1\xe2\x86\x92 by the smallest possible angle, so that its direction coincides with the direction of the vector v2\xe2\x86\x92v2\xe2\x86\x92 we need to make a turn counterclockwise, then we say that ii-th turn is to the left, and otherwise to the right. For better understanding look at this pictures with some examples of turns:  There are left turns on this picture   There are right turns on this picture You are given coordinates of the points A1,A2,\xe2\x80\xa6AnA1,A2,\xe2\x80\xa6An on the plane and string ss. Find a permutation p1,p2,\xe2\x80\xa6,pnp1,p2,\xe2\x80\xa6,pn of the integers from 11 to nn, such that the polygonal line, drawn by Vasya satisfy two necessary conditions." 2600

1158C "Permutation recovery" "constructive algorithms,data structures,dfs and similar,graphs,greedy,math,sortings" "Vasya has written some permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n, so for all 1\xe2\x89\xa4i\xe2\x89\xa4n it is true that 1\xe2\x89\xa4pi\xe2\x89\xa4n and all p1,p2,\xe2\x80\xa6,pn are different. After that he wrote n numbers next1,next2,\xe2\x80\xa6,nextn. The number nexti is equal to the minimal index i<j\xe2\x89\xa4n, such that pj>pi. If there is no such j let\'s let\'s define as nexti=n+1.In the evening Vasya went home from school and due to rain, his notebook got wet. Now it is impossible to read some written numbers. Permutation and some values nexti are completely lost! If for some i the value nexti is lost, let\'s say that nexti=\xe2\x88\x921.You are given numbers next1,next2,\xe2\x80\xa6,nextn (maybe some of them are equal to \xe2\x88\x921). Help Vasya to find such permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n, that he can write it to the notebook and all numbers nexti, which are not equal to \xe2\x88\x921, will be correct." 2100

1158B "The minimal unique substring" "constructive algorithms,math,strings" "Let s be some string consisting of symbols ""0"" or ""1"". Let\'s call a string t a substring of string s, if there exists such number 1\xe2\x89\xa4l\xe2\x89\xa4|s|\xe2\x88\x92|t|+1 that t=slsl+1\xe2\x80\xa6sl+|t|\xe2\x88\x921. Let\'s call a substring t of string s unique, if there exist only one such l. For example, let s=""1010111"". A string t=""010"" is an unique substring of s, because l=2 is the only one suitable number. But, for example t=""10"" isn\'t a unique substring of s, because l=1 and l=3 are suitable. And for example t=""00"" at all isn\'t a substring of s, because there is no suitable l.Today Vasya solved the following problem at the informatics lesson: given a string consisting of symbols ""0"" and ""1"", the task is to find the length of its minimal unique substring. He has written a solution to this problem and wants to test it. He is asking you to help him.You are given 2 positive integers n and k, such that (nmod2)=(kmod2), where (xmod2) is operation of taking remainder of x by dividing on 2. Find any string s consisting of n symbols ""0"" or ""1"", such that the length of its minimal unique substring is equal to k." 2200

1158A "The Party and Sweets" "binary search,constructive algorithms,greedy,implementation,math,sortings,two pointers" "n boys and m girls came to the party. Each boy presented each girl some integer number of sweets (possibly zero). All boys are numbered with integers from 1 to n and all girls are numbered with integers from 1 to m. For all 1\xe2\x89\xa4i\xe2\x89\xa4n the minimal number of sweets, which i-th boy presented to some girl is equal to bi and for all 1\xe2\x89\xa4j\xe2\x89\xa4m the maximal number of sweets, which j-th girl received from some boy is equal to gj.More formally, let ai,j be the number of sweets which the i-th boy give to the j-th girl. Then bi is equal exactly to the minimum among values ai,1,ai,2,\xe2\x80\xa6,ai,m and gj is equal exactly to the maximum among values b1,j,b2,j,\xe2\x80\xa6,bn,j.You are interested in the minimum total number of sweets that boys could present, so you need to minimize the sum of ai,j for all (i,j) such that 1\xe2\x89\xa4i\xe2\x89\xa4n and 1\xe2\x89\xa4j\xe2\x89\xa4m. You are given the numbers b1,\xe2\x80\xa6,bn and g1,\xe2\x80\xa6,gm, determine this number." 1500

1157G "Inverse of Rows and Columns" "brute force,constructive algorithms" "You are given a binary matrix a of size n\xc3\x97m. A binary matrix is a matrix where each element is either 0 or 1.You may perform some (possibly zero) operations with this matrix. During each operation you can inverse the row of this matrix or a column of this matrix. Formally, inverting a row is changing all values in this row to the opposite (0 to 1, 1 to 0). Inverting a column is changing all values in this column to the opposite.Your task is to sort the initial matrix by some sequence of such operations. The matrix is considered sorted if the array [a1,1,a1,2,\xe2\x80\xa6,a1,m,a2,1,a2,2,\xe2\x80\xa6,a2,m,\xe2\x80\xa6,an,m\xe2\x88\x921,an,m] is sorted in non-descending order." 2200

1157F "Maximum Balanced Circle" "constructive algorithms,dp,greedy,two pointers" "There are n people in a row. The height of the i-th person is ai. You can choose any subset of these people and try to arrange them into a balanced circle.A balanced circle is such an order of people that the difference between heights of any adjacent people is no more than 1. For example, let heights of chosen people be [ai1,ai2,\xe2\x80\xa6,aik], where k is the number of people you choose. Then the condition |aij\xe2\x88\x92aij+1|\xe2\x89\xa41 should be satisfied for all j from 1 to k\xe2\x88\x921 and the condition |ai1\xe2\x88\x92aik|\xe2\x89\xa41 should be also satisfied. |x| means the absolute value of x. It is obvious that the circle consisting of one person is balanced.Your task is to choose the maximum number of people and construct a balanced circle consisting of all chosen people. It is obvious that the circle consisting of one person is balanced so the answer always exists." 2000

1157E "Minimum Array" "binary search,data structures,greedy" "You are given two arrays a and b, both of length n. All elements of both arrays are from 0 to n\xe2\x88\x921.You can reorder elements of the array b (if you want, you may leave the order of elements as it is). After that, let array c be the array of length n, the i-th element of this array is ci=(ai+bi)%n, where x%y is x modulo y.Your task is to reorder elements of the array b to obtain the lexicographically minimum possible array c.Array x of length n is lexicographically less than array y of length n, if there exists such i (1\xe2\x89\xa4i\xe2\x89\xa4n), that xi<yi, and for any j (1\xe2\x89\xa4j<i) xj=yj." 1700

1157D "N Problems During K Days" "constructive algorithms,greedy,math" "Polycarp has to solve exactly n problems to improve his programming skill before an important programming competition. But this competition will be held very soon, most precisely, it will start in k days. It means that Polycarp has exactly k days for training!Polycarp doesn\'t want to procrastinate, so he wants to solve at least one problem during each of k days. He also doesn\'t want to overwork, so if he solves x problems during some day, he should solve no more than 2x problems during the next day. And, at last, he wants to improve his skill, so if he solves x problems during some day, he should solve at least x+1 problem during the next day.More formally: let [a1,a2,\xe2\x80\xa6,ak] be the array of numbers of problems solved by Polycarp. The i-th element of this array is the number of problems Polycarp solves during the i-th day of his training. Then the following conditions must be satisfied:   sum of all ai for i from 1 to k should be n;  ai should be greater than zero for each i from 1 to k;  the condition ai<ai+1\xe2\x89\xa42ai should be satisfied for each i from 1 to k\xe2\x88\x921. Your problem is to find any array a of length k satisfying the conditions above or say that it is impossible to do it." 1900

1157C2 "Increasing Subsequence (hard version)" greedy "The only difference between problems C1 and C2 is that all values in input of problem C1 are distinct (this condition may be false for problem C2).You are given a sequence a consisting of n integers.You are making a sequence of moves. During each move you must take either the leftmost element of the sequence or the rightmost element of the sequence, write it down and remove it from the sequence. Your task is to write down a strictly increasing sequence, and among all such sequences you should take the longest (the length of the sequence is the number of elements in it).For example, for the sequence [1,2,4,3,2] the answer is 4 (you take 1 and the sequence becomes [2,4,3,2], then you take the rightmost element 2 and the sequence becomes [2,4,3], then you take 3 and the sequence becomes [2,4] and then you take 4 and the sequence becomes [2], the obtained increasing sequence is [1,2,3,4])." 1700

1157C1 "Increasing Subsequence (easy version)" greedy "The only difference between problems C1 and C2 is that all values in input of problem C1 are distinct (this condition may be false for problem C2).You are given a sequence a consisting of n integers. All these integers are distinct, each value from 1 to n appears in the sequence exactly once.You are making a sequence of moves. During each move you must take either the leftmost element of the sequence or the rightmost element of the sequence, write it down and remove it from the sequence. Your task is to write down a strictly increasing sequence, and among all such sequences you should take the longest (the length of the sequence is the number of elements in it).For example, for the sequence [2,1,5,4,3] the answer is 4 (you take 2 and the sequence becomes [1,5,4,3], then you take the rightmost element 3 and the sequence becomes [1,5,4], then you take 4 and the sequence becomes [1,5] and then you take 5 and the sequence becomes [1], the obtained increasing sequence is [2,3,4,5])." 1300

1157B "Long Number" greedy "You are given a long decimal number a consisting of n digits from 1 to 9. You also have a function f that maps every digit from 1 to 9 to some (possibly the same) digit from 1 to 9.You can perform the following operation no more than once: choose a non-empty contiguous subsegment of digits in a, and replace each digit x from this segment with f(x). For example, if a=1337, f(1)=1, f(3)=5, f(7)=3, and you choose the segment consisting of three rightmost digits, you get 1553 as the result.What is the maximum possible number you can obtain applying this operation no more than once?" 1300

1157A "Reachable Numbers" implementation "Let\'s denote a function f(x) in such a way: we add 1 to x, then, while there is at least one trailing zero in the resulting number, we remove that zero. For example,   f(599)=6: 599+1=600\xe2\x86\x9260\xe2\x86\x926;  f(7)=8: 7+1=8;  f(9)=1: 9+1=10\xe2\x86\x921;  f(10099)=101: 10099+1=10100\xe2\x86\x921010\xe2\x86\x92101. We say that some number y is reachable from x if we can apply function f to x some (possibly zero) times so that we get y as a result. For example, 102 is reachable from 10098 because f(f(f(10098)))=f(f(10099))=f(101)=102; and any number is reachable from itself.You are given a number n; your task is to count how many different numbers are reachable from n." 1100

1156G Optimizer graphs,greedy,hashing,implementation "Let\'s analyze a program written on some strange programming language. The variables in this language have names consisting of 1 to 4 characters, and each character is a lowercase or an uppercase Latin letter, or a digit. There is an extra constraint that the first character should not be a digit.There are four types of operations in the program, each denoted by one of the characters: $, ^, # or &.Each line of the program has one of the following formats:   <lvalue>=<rvalue>, where <lvalue> and <rvalue> are valid variable names;  <lvalue>=<arg1><op><arg2>, where <lvalue>, <arg1> and <arg2> are valid variable names, and <op> is an operation character. The program is executed line-by-line, and the result of execution is stored in a variable having the name res. If res is never assigned in the program, then the result will be equal to the value of res before running the program.Two programs are called equivalent if no matter which operations do characters $, ^, # and & denote (but, obviously, performing the same operation on the same arguments gives the same result) and which values do variables have before execution of program, the value of res after running the first program is equal to the value of res after running the second program (the programs are executed independently).You are given a program consisting of n lines. Your task is to write a program consisting of minimum possible number of lines that is equivalent to the program you are given." 2700

1156F "Card Bag" dp,math,probabilities "You have a bag which contains n cards. There is a number written on each card; the number on i-th card is ai.You are playing the following game. During each turn, you choose and remove a random card from the bag (all cards that are still left inside the bag are chosen equiprobably). Nothing else happens during the first turn \xe2\x80\x94 but during the next turns, after removing a card (let the number on it be x), you compare it with the card that was removed during the previous turn (let the number on it be y). Possible outcomes are:   if x<y, the game ends and you lose;  if x=y, the game ends and you win;  if x>y, the game continues. If there are no cards left in the bag, you lose. Cards are not returned into the bag after you remove them.You have to calculate the probability of winning in this game. It can be shown that it is in the form of PQ where P and Q are non-negative integers and Q\xe2\x89\xa00, P\xe2\x89\xa4Q. Output the value of P\xe2\x8b\x85Q\xe2\x88\x921�(mod��998244353)." 2300

1156E "Special Segments of Permutation" "data structures,divide and conquer,dsu,two pointers" "You are given a permutation p of n integers 1, 2, ..., n (a permutation is an array where each element from 1 to n occurs exactly once).Let\'s call some subsegment p[l,r] of this permutation special if pl+pr=rmaxi=lpi. Please calculate the number of special subsegments." 2200

1156D 0-1-Tree "dfs and similar,divide and conquer,dp,dsu,trees" "You are given a tree (an undirected connected acyclic graph) consisting of nn vertices and n\xe2\x88\x921n\xe2\x88\x921 edges. A number is written on each edge, each number is either 00 (let\'s call such edges 00-edges) or 11 (those are 11-edges).Let\'s call an ordered pair of vertices (x,y)(x,y) (x\xe2\x89\xa0yx\xe2\x89\xa0y) valid if, while traversing the simple path from xx to yy, we never go through a 00-edge after going through a 11-edge. Your task is to calculate the number of valid pairs in the tree." 2200

1156C "Match Points" "binary search,greedy,sortings,ternary search,two pointers" "You are given a set of points x1, x2, ..., xn on the number line.Two points i and j can be matched with each other if the following conditions hold:  neither i nor j is matched with any other point;  |xi\xe2\x88\x92xj|\xe2\x89\xa5z. What is the maximum number of pairs of points you can match with each other?" 2000

1156B "Ugly Pairs" "dfs and similar,greedy,implementation,sortings,strings" "You are given a string, consisting of lowercase Latin letters.A pair of neighbouring letters in a string is considered ugly if these letters are also neighbouring in a alphabet. For example, string ""abaca"" contains ugly pairs at positions (1,2) \xe2\x80\x94 ""ab"" and (2,3) \xe2\x80\x94 ""ba"". Letters \'a\' and \'z\' aren\'t considered neighbouring in a alphabet.Can you rearrange the letters of a given string so that there are no ugly pairs? You can choose any order of the letters of the given string but you can\'t add any new letters or remove the existing ones. You can also leave the order the same.If there are multiple answers, print any of them.You also have to answer T separate queries." 1800

1156A "Inscribed Figures" geometry "The math faculty of Berland State University has suffered the sudden drop in the math skills of enrolling students. This year the highest grade on the entrance math test was 8. Out of 100! Thus, the decision was made to make the test easier.Future students will be asked just a single question. They are given a sequence of integer numbers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an, each number is from 11 to 33 and ai\xe2\x89\xa0ai+1ai\xe2\x89\xa0ai+1 for each valid ii. The ii-th number represents a type of the ii-th figure:  circle;  isosceles triangle with the length of height equal to the length of base;  square. The figures of the given sequence are placed somewhere on a Cartesian plane in such a way that:  (i+1)(i+1)-th figure is inscribed into the ii-th one;  each triangle base is parallel to OX;  the triangle is oriented in such a way that the vertex opposite to its base is at the top;  each square sides are parallel to the axes;  for each ii from 22 to nn figure ii has the maximum possible length of side for triangle and square and maximum radius for circle. Note that the construction is unique for some fixed position and size of just the first figure.The task is to calculate the number of distinct points (not necessarily with integer coordinates) where figures touch. The trick is, however, that the number is sometimes infinite. But that won\'t make the task difficult for you, will it?So can you pass the math test and enroll into Berland State University?" 1400

1155F "Delivery Oligopoly" "brute force,dp,graphs" "The whole delivery market of Berland is controlled by two rival companies: BerEx and BerPS. They both provide fast and reliable delivery services across all the cities of Berland.The map of Berland can be represented as an undirected graph. The cities are vertices and the roads are edges between them. Each pair of cities has no more than one road between them. Each road connects different cities.BerEx and BerPS are so competitive that for each pair of cities (v,u) they have set up their paths from v to u in such a way that these two paths don\'t share a single road. It is guaranteed that it was possible.Now Berland government decided to cut down the road maintenance cost by abandoning some roads. Obviously, they want to maintain as little roads as possible. However, they don\'t want to break the entire delivery system. So BerEx and BerPS should still be able to have their paths between every pair of cities non-intersecting.What is the minimal number of roads Berland government can maintain?More formally, given a 2-edge connected undirected graph, what is the minimum number of edges that can be left in it so that the resulting graph is also 2-edge connected?" 2800

1155E "Guess the Root" "brute force,interactive,math" "Jury picked a polynomial f(x)=a0+a1\xe2\x8b\x85x+a2\xe2\x8b\x85x2+\xe2\x8b\xaf+ak\xe2\x8b\x85xk. k\xe2\x89\xa410 and all ai are integer numbers and 0\xe2\x89\xa4ai<106+3. It\'s guaranteed that there is at least one i such that ai>0.Now jury wants you to find such an integer x0 that f(x0)\xe2\x89\xa10mod(106+3) or report that there is not such x0.You can ask no more than 50 queries: you ask value xq and jury tells you value f(xq)mod(106+3).Note that printing the answer doesn\'t count as a query." 2200

1155D "Beautiful Array" "brute force,data structures,divide and conquer,dp,greedy" "You are given an array a consisting of n integers. Beauty of array is the maximum sum of some consecutive subarray of this array (this subarray may be empty). For example, the beauty of the array [10, -5, 10, -4, 1] is 15, and the beauty of the array [-3, -5, -1] is 0.You may choose at most one consecutive subarray of a and multiply all values contained in this subarray by x. You want to maximize the beauty of array after applying at most one such operation." 1900

1155C "Alarm Clocks Everywhere" "math,number theory" "Ivan is going to sleep now and wants to set his alarm clock. There will be many necessary events tomorrow, the i-th of them will start during the xi-th minute. Ivan doesn\'t want to skip any of the events, so he has to set his alarm clock in such a way that it rings during minutes x1,x2,\xe2\x80\xa6,xn, so he will be awake during each of these minutes (note that it does not matter if his alarm clock will ring during any other minute).Ivan can choose two properties for the alarm clock \xe2\x80\x94 the first minute it will ring (let\'s denote it as y) and the interval between two consecutive signals (let\'s denote it by p). After the clock is set, it will ring during minutes y,y+p,y+2p,y+3p and so on.Ivan can choose any minute as the first one, but he cannot choose any arbitrary value of p. He has to pick it among the given values p1,p2,\xe2\x80\xa6,pm (his phone does not support any other options for this setting).So Ivan has to choose the first minute y when the alarm clock should start ringing and the interval between two consecutive signals pj in such a way that it will ring during all given minutes x1,x2,\xe2\x80\xa6,xn (and it does not matter if his alarm clock will ring in any other minutes).Your task is to tell the first minute y and the index j such that if Ivan sets his alarm clock with properties y and pj it will ring during all given minutes x1,x2,\xe2\x80\xa6,xn or say that it is impossible to choose such values of the given properties. If there are multiple answers, you can print any." 1300

1155B "Game with Telephone Numbers" games,greedy,implementation "A telephone number is a sequence of exactly 11 digits such that its first digit is 8.Vasya and Petya are playing a game. Initially they have a string s of length n (n is odd) consisting of digits. Vasya makes the first move, then players alternate turns. In one move the player must choose a character and erase it from the current string. For example, if the current string 1121, after the player\'s move it may be 112, 111 or 121. The game ends when the length of string s becomes 11. If the resulting string is a telephone number, Vasya wins, otherwise Petya wins.You have to determine if Vasya has a winning strategy (that is, if Vasya can win the game no matter which characters Petya chooses during his moves)." 1200

1155A "Reverse a Substring" implementation,sortings,strings "You are given a string s consisting of n lowercase Latin letters.Let\'s define a substring as a contiguous subsegment of a string. For example, ""acab"" is a substring of ""abacaba"" (it starts in position 3 and ends in position 6), but ""aa"" or ""d"" aren\'t substrings of this string. So the substring of the string s from position l to position r is s[l;r]=slsl+1\xe2\x80\xa6sr.You have to choose exactly one of the substrings of the given string and reverse it (i.\xe2\x80\x89e. make s[l;r]=srsr\xe2\x88\x921\xe2\x80\xa6sl) to obtain a string that is less lexicographically. Note that it is not necessary to obtain the minimum possible string.If it is impossible to reverse some substring of the given string to obtain a string that is less, print ""NO"". Otherwise print ""YES"" and any suitable substring.String x is lexicographically less than string y, if either x is a prefix of y (and x\xe2\x89\xa0y), or there exists such i (1\xe2\x89\xa4i\xe2\x89\xa4min(|x|,|y|)), that xi<yi, and for any j (1\xe2\x89\xa4j<i) xj=yj. Here |a| denotes the length of the string a. The lexicographic comparison of strings is implemented by operator < in modern programming languages\xe2\x80\x8b\xe2\x80\x8b." 1000

1154G "Minimum Possible LCM" "brute force,greedy,math,number theory" "You are given an array a consisting of n integers a1,a2,\xe2\x80\xa6,an.Your problem is to find such pair of indices i,j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) that lcm(ai,aj) is minimum possible.lcm(x,y) is the least common multiple of x and y (minimum positive number such that both x and y are divisors of this number)." 2200

1154F "Shovels Shop" dp,greedy,sortings "There are n shovels in the nearby shop. The i-th shovel costs ai bourles.Misha has to buy exactly k shovels. Each shovel can be bought no more than once.Misha can buy shovels by several purchases. During one purchase he can choose any subset of remaining (non-bought) shovels and buy this subset.There are also m special offers in the shop. The j-th of them is given as a pair (xj,yj), and it means that if Misha buys exactly xj shovels during one purchase then yj most cheapest of them are for free (i.e. he will not pay for yj most cheapest shovels during the current purchase).Misha can use any offer any (possibly, zero) number of times, but he cannot use more than one offer during one purchase (but he can buy shovels without using any offers).Your task is to calculate the minimum cost of buying k shovels, if Misha buys them optimally." 2100

1154E "Two Teams" "data structures,implementation,sortings" "There are n students standing in a row. Two coaches are forming two teams \xe2\x80\x94 the first coach chooses the first team and the second coach chooses the second team.The i-th student has integer programming skill ai. All programming skills are distinct and between 1 and n, inclusive.Firstly, the first coach will choose the student with maximum programming skill among all students not taken into any team, and k closest students to the left of him and k closest students to the right of him (if there are less than k students to the left or to the right, all of them will be chosen). All students that are chosen leave the row and join the first team. Secondly, the second coach will make the same move (but all students chosen by him join the second team). Then again the first coach will make such move, and so on. This repeats until the row becomes empty (i.\xe2\x80\x89e. the process ends when each student becomes to some team).Your problem is to determine which students will be taken into the first team and which students will be taken into the second team." 1800

1154D "Walking Robot" greedy "There is a robot staying at X=0 on the Ox axis. He has to walk to X=n. You are controlling this robot and controlling how he goes. The robot has a battery and an accumulator with a solar panel.The i-th segment of the path (from X=i\xe2\x88\x921 to X=i) can be exposed to sunlight or not. The array s denotes which segments are exposed to sunlight: if segment i is exposed, then si=1, otherwise si=0.The robot has one battery of capacity b and one accumulator of capacity a. For each segment, you should choose which type of energy storage robot will use to go to the next point (it can be either battery or accumulator). If the robot goes using the battery, the current charge of the battery is decreased by one (the robot can\'t use the battery if its charge is zero). And if the robot goes using the accumulator, the current charge of the accumulator is decreased by one (and the robot also can\'t use the accumulator if its charge is zero).If the current segment is exposed to sunlight and the robot goes through it using the battery, the charge of the accumulator increases by one (of course, its charge can\'t become higher than it\'s maximum capacity).If accumulator is used to pass some segment, its charge decreases by 1 no matter if the segment is exposed or not.You understand that it is not always possible to walk to X=n. You want your robot to go as far as possible. Find the maximum number of segments of distance the robot can pass if you control him optimally." 1500

1154C "Gourmet Cat" implementation,math "Polycarp has a cat and his cat is a real gourmet! Dependent on a day of the week he eats certain type of food:  on Mondays, Thursdays and Sundays he eats fish food;  on Tuesdays and Saturdays he eats rabbit stew;  on other days of week he eats chicken stake. Polycarp plans to go on a trip and already packed his backpack. His backpack contains:  a daily rations of fish food;  b daily rations of rabbit stew;  c daily rations of chicken stakes. Polycarp has to choose such day of the week to start his trip that his cat can eat without additional food purchases as long as possible. Print the maximum number of days the cat can eat in a trip without additional food purchases, if Polycarp chooses the day of the week to start his trip optimally." 1400

1154B "Make Them Equal" math "You are given a sequence a1,a2,\xe2\x80\xa6,an consisting of n integers.You can choose any non-negative integer D (i.e. D\xe2\x89\xa50), and for each ai you can:  add D (only once), i.\xe2\x80\x89e. perform ai:=ai+D, or  subtract D (only once), i.\xe2\x80\x89e. perform ai:=ai\xe2\x88\x92D, or  leave the value of ai unchanged. It is possible that after an operation the value ai becomes negative.Your goal is to choose such minimum non-negative integer D and perform changes in such a way, that all ai are equal (i.e. a1=a2=\xe2\x8b\xaf=an).Print the required D or, if it is impossible to choose such value D, print -1.For example, for array [2,8] the value D=3 is minimum possible because you can obtain the array [5,5] if you will add D to 2 and subtract D from 8. And for array [1,4,7,7] the value D=3 is also minimum possible. You can add it to 1 and subtract it from 7 and obtain the array [4,4,4,4]." 1200

1154A "Restoring Three Numbers" math "Polycarp has guessed three positive integers a, b and c. He keeps these numbers in secret, but he writes down four numbers on a board in arbitrary order \xe2\x80\x94 their pairwise sums (three numbers) and sum of all three numbers (one number). So, there are four numbers on a board in random order: a+b, a+c, b+c and a+b+c.You have to guess three numbers a, b and c using given numbers. Print three guessed integers in any order.Pay attention that some given numbers a, b and c can be equal (it is also possible that a=b=c)." 800

1153F "Serval and Bonus Problem" combinatorics,dp,math,probabilities "Getting closer and closer to a mathematician, Serval becomes a university student on math major in Japari University. On the Calculus class, his teacher taught him how to calculate the expected length of a random subsegment of a given segment. Then he left a bonus problem as homework, with the award of a garage kit from IOI. The bonus is to extend this problem to the general case as follows.You are given a segment with length l. We randomly choose n segments by choosing two points (maybe with non-integer coordinates) from the given segment equiprobably and the interval between the two points forms a segment. You are given the number of random segments n, and another integer k. The 2n endpoints of the chosen segments split the segment into (2n+1) intervals. Your task is to calculate the expected total length of those intervals that are covered by at least k segments of the n random segments.You should find the answer modulo 998244353." 2600

1153E "Serval and Snake" "binary search,brute force,interactive" "This is an interactive problem.Now Serval is a senior high school student in Japari Middle School. However, on the way to the school, he must go across a pond, in which there is a dangerous snake. The pond can be represented as a n\xc3\x97nn\xc3\x97n grid. The snake has a head and a tail in different cells, and its body is a series of adjacent cells connecting the head and the tail without self-intersecting. If Serval hits its head or tail, the snake will bite him and he will die.Luckily, he has a special device which can answer the following question: you can pick a rectangle, it will tell you the number of times one needs to cross the border of the rectangle walking cell by cell along the snake from the head to the tail. The pictures below show a possible snake and a possible query to it, which will get an answer of 44.    Today Serval got up too late and only have time to make 20192019 queries. As his best friend, can you help him find the positions of the head and the tail?Note that two cells are adjacent if and only if they have a common edge in the grid, and a snake can have a body of length 00, that means it only has adjacent head and tail.Also note that the snake is sleeping, so it won\'t move while Serval using his device. And what\'s obvious is that the snake position does not depend on your queries." 2200

1153D "Serval and Rooted Tree" "binary search,dfs and similar,dp,greedy,trees" "Now Serval is a junior high school student in Japari Middle School, and he is still thrilled on math as before. As a talented boy in mathematics, he likes to play with numbers. This time, he wants to play with numbers on a rooted tree.A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. A parent of a node vv is the last different from vv vertex on the path from the root to the vertex vv. Children of vertex vv are all nodes for which vv is the parent. A vertex is a leaf if it has no children.The rooted tree Serval owns has nn nodes, node 11 is the root. Serval will write some numbers into all nodes of the tree. However, there are some restrictions. Each of the nodes except leaves has an operation maxmax or minmin written in it, indicating that the number in this node should be equal to the maximum or minimum of all the numbers in its sons, respectively. Assume that there are kk leaves in the tree. Serval wants to put integers 1,2,\xe2\x80\xa6,k1,2,\xe2\x80\xa6,k to the kk leaves (each number should be used exactly once). He loves large numbers, so he wants to maximize the number in the root. As his best friend, can you help him?" 1900

1153C "Serval and Parenthesis Sequence" greedy,strings "Serval soon said goodbye to Japari kindergarten, and began his life in Japari Primary School.In his favorite math class, the teacher taught him the following interesting definitions.A parenthesis sequence is a string, containing only characters ""("" and "")"".A correct parenthesis sequence is a parenthesis sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, parenthesis sequences ""()()"", ""(())"" are correct (the resulting expressions are: ""(1+1)+(1+1)"", ""((1+1)+1)""), while "")("" and "")"" are not. Note that the empty string is a correct parenthesis sequence by definition.We define that |s| as the length of string s. A strict prefix s[1\xe2\x80\xa6l] (1\xe2\x89\xa4l<|s|) of a string s=s1s2\xe2\x80\xa6s|s| is string s1s2\xe2\x80\xa6sl. Note that the empty string and the whole string are not strict prefixes of any string by the definition.Having learned these definitions, he comes up with a new problem. He writes down a string s containing only characters ""("", "")"" and ""?"". And what he is going to do, is to replace each of the ""?"" in s independently by one of ""("" and "")"" to make all strict prefixes of the new sequence not a correct parenthesis sequence, while the new sequence should be a correct parenthesis sequence.After all, he is just a primary school student so this problem is too hard for him to solve. As his best friend, can you help him to replace the question marks? If there are many solutions, any of them is acceptable." 1700

1153B "Serval and Toy Bricks" "constructive algorithms,greedy" "Luckily, Serval got onto the right bus, and he came to the kindergarten on time. After coming to kindergarten, he found the toy bricks very funny.He has a special interest to create difficult problems for others to solve. This time, with many 1\xc3\x971\xc3\x9711\xc3\x971\xc3\x971 toy bricks, he builds up a 3-dimensional object. We can describe this object with a n\xc3\x97mn\xc3\x97m matrix, such that in each cell (i,j)(i,j), there are hi,jhi,j bricks standing on the top of each other.However, Serval doesn\'t give you any hi,jhi,j, and just give you the front view, left view, and the top view of this object, and he is now asking you to restore the object. Note that in the front view, there are mm columns, and in the ii-th of them, the height is the maximum of h1,i,h2,i,\xe2\x80\xa6,hn,ih1,i,h2,i,\xe2\x80\xa6,hn,i. It is similar for the left view, where there are nn columns. And in the top view, there is an n\xc3\x97mn\xc3\x97m matrix ti,jti,j, where ti,jti,j is 00 or 11. If ti,jti,j equals 11, that means hi,j>0hi,j>0, otherwise, hi,j=0hi,j=0.However, Serval is very lonely because others are bored about his unsolvable problems before, and refused to solve this one, although this time he promises there will be at least one object satisfying all the views. As his best friend, can you have a try?" 1200

1153A "Serval and Bus" "brute force,math" "It is raining heavily. But this is the first day for Serval, who just became 3 years old, to go to the kindergarten. Unfortunately, he lives far from kindergarten, and his father is too busy to drive him there. The only choice for this poor little boy is to wait for a bus on this rainy day. Under such circumstances, the poor boy will use the first bus he sees no matter where it goes. If several buses come at the same time, he will choose one randomly.Serval will go to the bus station at time t, and there are n bus routes which stop at this station. For the i-th bus route, the first bus arrives at time si minutes, and each bus of this route comes di minutes later than the previous one.As Serval\'s best friend, you wonder which bus route will he get on. If several buses arrive at the same time, you can print any of them." 1000

1152F2 "Neko Rules the Catniverse (Large Version)" bitmasks,dp,matrices "This problem is same as the previous one, but has larger constraints.Aki is playing a new video game. In the video game, he will control Neko, the giant cat, to fly between planets in the Catniverse.There are n planets in the Catniverse, numbered from 1 to n. At the beginning of the game, Aki chooses the planet where Neko is initially located. Then Aki performs k\xe2\x88\x921 moves, where in each move Neko is moved from the current planet x to some other planet y such that:  Planet y is not visited yet.  1\xe2\x89\xa4y\xe2\x89\xa4x+m (where m is a fixed constant given in the input) This way, Neko will visit exactly k different planets. Two ways of visiting planets are called different if there is some index i such that, the i-th planet visited in the first way is different from the i-th planet visited in the second way.What is the total number of ways to visit k planets this way? Since the answer can be quite large, print it modulo 109+7." 3000

1152F1 "Neko Rules the Catniverse (Small Version)" bitmasks,dp,matrices "This problem is same as the next one, but has smaller constraints.Aki is playing a new video game. In the video game, he will control Neko, the giant cat, to fly between planets in the Catniverse.There are n planets in the Catniverse, numbered from 1 to n. At the beginning of the game, Aki chooses the planet where Neko is initially located. Then Aki performs k\xe2\x88\x921 moves, where in each move Neko is moved from the current planet x to some other planet y such that:  Planet y is not visited yet.  1\xe2\x89\xa4y\xe2\x89\xa4x+m (where m is a fixed constant given in the input) This way, Neko will visit exactly k different planets. Two ways of visiting planets are called different if there is some index i such that the i-th planet visited in the first way is different from the i-th planet visited in the second way.What is the total number of ways to visit k planets this way? Since the answer can be quite large, print it modulo 109+7." 2800

1152E "Neko and Flashback" "constructive algorithms,dfs and similar,graphs" "A permutation of length k is a sequence of k integers from 1 to k containing each integer exactly once. For example, the sequence [3,1,2] is a permutation of length 3.When Neko was five, he thought of an array a of n positive integers and a permutation p of length n\xe2\x88\x921. Then, he performed the following:  Constructed an array b of length n\xe2\x88\x921, where bi=min(ai,ai+1).  Constructed an array c of length n\xe2\x88\x921, where ci=max(ai,ai+1).  Constructed an array b\xe2\x80\xb2 of length n\xe2\x88\x921, where b\xe2\x80\xb2i=bpi.  Constructed an array c\xe2\x80\xb2 of length n\xe2\x88\x921, where c\xe2\x80\xb2i=cpi. For example, if the array a was [3,4,6,5,7] and permutation p was [2,4,1,3], then Neko would have constructed the following arrays:  b=[3,4,5,5]  c=[4,6,6,7]  b\xe2\x80\xb2=[4,5,3,5]  c\xe2\x80\xb2=[6,7,4,6] Then, he wrote two arrays b\xe2\x80\xb2 and c\xe2\x80\xb2 on a piece of paper and forgot about it. 14 years later, when he was cleaning up his room, he discovered this old piece of paper with two arrays b\xe2\x80\xb2 and c\xe2\x80\xb2 written on it. However he can\'t remember the array a and permutation p he used.In case Neko made a mistake and there is no array a and permutation p resulting in such b\xe2\x80\xb2 and c\xe2\x80\xb2, print -1. Otherwise, help him recover any possible array a." 2400

1152D "Neko and Aki\'s Prank" dp,greedy,trees "A permutation of length k is a sequence of k integers from 1 to k containing each integer exactly once. For example, the sequence [3,1,2] is a permutation of length 3.When Neko was five, he thought of an array a of n positive integers and a permutation p of length n\xe2\x88\x921. Then, he performed the following:  Constructed an array b of length n\xe2\x88\x921, where bi=min(ai,ai+1).  Constructed an array c of length n\xe2\x88\x921, where ci=max(ai,ai+1).  Constructed an array b\xe2\x80\xb2 of length n\xe2\x88\x921, where b\xe2\x80\xb2i=bpi.  Constructed an array c\xe2\x80\xb2 of length n\xe2\x88\x921, where c\xe2\x80\xb2i=cpi. For example, if the array a was [3,4,6,5,7] and permutation p was [2,4,1,3], then Neko would have constructed the following arrays:  b=[3,4,5,5]  c=[4,6,6,7]  b\xe2\x80\xb2=[4,5,3,5]  c\xe2\x80\xb2=[6,7,4,6] Then, he wrote two arrays b\xe2\x80\xb2 and c\xe2\x80\xb2 on a piece of paper and forgot about it. 14 years later, when he was cleaning up his room, he discovered this old piece of paper with two arrays b\xe2\x80\xb2 and c\xe2\x80\xb2 written on it. However he can\'t remember the array a and permutation p he used.In case Neko made a mistake and there is no array a and permutation p resulting in such b\xe2\x80\xb2 and c\xe2\x80\xb2, print -1. Otherwise, help him recover any possible array a." 2100

1152C "Neko does Maths" "brute force,math,number theory" "Neko loves divisors. During the latest number theory lesson, he got an interesting exercise from his math teacher.Neko has two integers a and b. His goal is to find a non-negative integer k such that the least common multiple of a+k and b+k is the smallest possible. If there are multiple optimal integers k, he needs to choose the smallest one.Given his mathematical talent, Neko had no trouble getting Wrong Answer on this problem. Can you help him solve it?" 1800

1152B "Neko Performs Cat Furrier Transform" "bitmasks,constructive algorithms,dfs and similar,math" "Cat Furrier Transform is a popular algorithm among cat programmers to create longcats. As one of the greatest cat programmers ever exist, Neko wants to utilize this algorithm to create the perfect longcat.Assume that we have a cat with a number x. A perfect longcat is a cat with a number equal 2m\xe2\x88\x921 for some non-negative integer m. For example, the numbers 0, 1, 3, 7, 15 and so on are suitable for the perfect longcats.In the Cat Furrier Transform, the following operations can be performed on x:  (Operation A): you select any non-negative integer n and replace x with x\xe2\x8a\x95(2n\xe2\x88\x921), with \xe2\x8a\x95 being a bitwise XOR operator. (Operation B): replace x with x+1. The first applied operation must be of type A, the second of type B, the third of type A again, and so on. Formally, if we number operations from one in the order they are executed, then odd-numbered operations must be of type A and the even-numbered operations must be of type B.Neko wants to produce perfect longcats at industrial scale, thus for each cat Neko only wants to perform at most 40 operations. Can you help Neko writing a transformation plan?Note that it is not required to minimize the number of operations. You just need to use no more than 40 operations." 1300

1152A "Neko Finds Grapes" greedy,implementation,math "On a random day, Neko found n treasure chests and m keys. The i-th chest has an integer ai written on it and the j-th key has an integer bj on it. Neko knows those chests contain the powerful mysterious green Grapes, thus Neko wants to open as many treasure chests as possible.The j-th key can be used to unlock the i-th chest if and only if the sum of the key number and the chest number is an odd number. Formally, ai+bj\xe2\x89\xa11(mod2). One key can be used to open at most one chest, and one chest can be opened at most once.Find the maximum number of chests Neko can open." 800

1151F "Sonya and Informatics" combinatorics,dp,matrices,probabilities "A girl named Sonya is studying in the scientific lyceum of the Kingdom of Kremland. The teacher of computer science (Sonya\'s favorite subject!) invented a task for her.Given an array a of length n, consisting only of the numbers 0 and 1, and the number k. Exactly k times the following happens:   Two numbers i and j are chosen equiprobable such that (1\xe2\x89\xa4i<j\xe2\x89\xa4n).  The numbers in the i and j positions are swapped. Sonya\'s task is to find the probability that after all the operations are completed, the a array will be sorted in non-decreasing order. She turned to you for help. Help Sonya solve this problem.It can be shown that the desired probability is either 0 or it can be represented as PQ, where P and Q are coprime integers and Q\xe2\x89\xa20�(mod109+7)." 2300

1151E "Number of Components" "combinatorics,data structures,dp,math" "The Kingdom of Kremland is a tree (a connected undirected graph without cycles) consisting of n vertices. Each vertex i has its own value ai. All vertices are connected in series by edges. Formally, for every 1\xe2\x89\xa4i<n there is an edge between the vertices of i and i+1.Denote the function f(l,r), which takes two integers l and r (l\xe2\x89\xa4r): �� We leave in the tree only vertices whose values \xe2\x80\x8b\xe2\x80\x8brange from l to r. �� The value of the function will be the number of connected components in the new graph. Your task is to calculate the following sum: n\xe2\x88\x91l=1n\xe2\x88\x91r=lf(l,r)" 2100

1151D "Stas and the Queue at the Buffet" greedy,math,sortings "During a break in the buffet of the scientific lyceum of the Kingdom of Kremland, there was formed a queue of n high school students numbered from 1 to n. Initially, each student i is on position i. Each student i is characterized by two numbers�\xe2\x80\x94 ai and bi. Dissatisfaction of the person i equals the product of ai by the number of people standing to the left of his position, add the product bi by the number of people standing to the right of his position. Formally, the dissatisfaction of the student i, which is on the position j, equals ai\xe2\x8b\x85(j\xe2\x88\x921)+bi\xe2\x8b\x85(n\xe2\x88\x92j).The director entrusted Stas with the task: rearrange the people in the queue so that minimize the total dissatisfaction.Although Stas is able to solve such problems, this was not given to him. He turned for help to you." 1600

1151C "Problem for Nazar" "constructive algorithms,math" "Nazar, a student of the scientific lyceum of the Kingdom of Kremland, is known for his outstanding mathematical abilities. Today a math teacher gave him a very difficult task.Consider two infinite sets of numbers. The first set consists of odd positive numbers (1,3,5,7,\xe2\x80\xa6), and the second set consists of even positive numbers (2,4,6,8,\xe2\x80\xa6). At the first stage, the teacher writes the first number on the endless blackboard from the first set, in the second stage�\xe2\x80\x94 the first two numbers from the second set, on the third stage�\xe2\x80\x94 the next four numbers from the first set, on the fourth�\xe2\x80\x94 the next eight numbers from the second set and so on. In other words, at each stage, starting from the second, he writes out two times more numbers than at the previous one, and also changes the set from which these numbers are written out to another. The ten first written numbers: 1,2,4,3,5,7,9,6,8,10. Let\'s number the numbers written, starting with one.The task is to find the sum of numbers with numbers from l to r for given integers l and r. The answer may be big, so you need to find the remainder of the division by 1000000007 (109+7).Nazar thought about this problem for a long time, but didn\'t come up with a solution. Help him solve this problem." 1800

1151B "Dima and a Bad XOR" "bitmasks,brute force,constructive algorithms,dp" "Student Dima from Kremland has a matrix a of size n\xc3\x97m filled with non-negative integers.He wants to select exactly one integer from each row of the matrix so that the bitwise exclusive OR of the selected integers is strictly greater than zero. Help him!Formally, he wants to choose an integers sequence c1,c2,\xe2\x80\xa6,cn (1\xe2\x89\xa4cj\xe2\x89\xa4m) so that the inequality a1,c1\xe2\x8a\x95a2,c2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an,cn>0 holds, where ai,j is the matrix element from the i-th row and the j-th column.Here x\xe2\x8a\x95y denotes the bitwise XOR operation of integers x and y." 1600

1151A "Maxim and Biology" "brute force,strings" "Today in the scientific lyceum of the Kingdom of Kremland, there was a biology lesson. The topic of the lesson was the genomes. Let\'s call the genome the string ""ACTG"".Maxim was very boring to sit in class, so the teacher came up with a task for him: on a given string s consisting of uppercase letters and length of at least 4, you need to find the minimum number of operations that you need to apply, so that the genome appears in it as a substring. For one operation, you can replace any letter in the string s with the next or previous in the alphabet. For example, for the letter ""D"" the previous one will be ""C"", and the next�\xe2\x80\x94 ""E"". In this problem, we assume that for the letter ""A"", the previous one will be the letter ""Z"", and the next one will be ""B"", and for the letter ""Z"", the previous one is the letter ""Y"", and the next one is the letter ""A"".Help Maxim solve the problem that the teacher gave him.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end." 1000

1150B "Tiling Challenge" greedy,implementation "One day Alice was cleaning up her basement when she noticed something very curious: an infinite set of wooden pieces! Each piece was made of five square tiles, with four tiles adjacent to the fifth center tile:    By the pieces lay a large square wooden board. The board is divided into n2n2 cells arranged into nn rows and nn columns. Some of the cells are already occupied by single tiles stuck to it. The remaining cells are free.Alice started wondering whether she could fill the board completely using the pieces she had found. Of course, each piece has to cover exactly five distinct cells of the board, no two pieces can overlap and every piece should fit in the board entirely, without some parts laying outside the board borders. The board however was too large for Alice to do the tiling by hand. Can you help determine if it\'s possible to fully tile the board?" 900

1150A "Stock Arbitraging" greedy,implementation "Welcome to Codeforces Stock Exchange! We\'re pretty limited now as we currently allow trading on one stock, Codeforces Ltd. We hope you\'ll still be able to make profit from the market!In the morning, there are n opportunities to buy shares. The i-th of them allows to buy as many shares as you want, each at the price of si bourles.In the evening, there are m opportunities to sell shares. The i-th of them allows to sell as many shares as you want, each at the price of bi bourles. You can\'t sell more shares than you have.It\'s morning now and you possess r bourles and no shares.What is the maximum number of bourles you can hold after the evening?" 800

1149E "Election Promises" games,graphs "In Byteland, there are two political parties fighting for seats in the Parliament in the upcoming elections: Wrong Answer Party and Time Limit Exceeded Party. As they want to convince as many citizens as possible to cast their votes on them, they keep promising lower and lower taxes.There are n cities in Byteland, connected by m one-way roads. Interestingly enough, the road network has no cycles \xe2\x80\x94 it\'s impossible to start in any city, follow a number of roads, and return to that city. Last year, citizens of the i-th city had to pay hi bourles of tax.Parties will now alternately hold the election conventions in various cities. If a party holds a convention in city v, the party needs to decrease the taxes in this city to a non-negative integer amount of bourles. However, at the same time they can arbitrarily modify the taxes in each of the cities that can be reached from v using a single road. The only condition that must be fulfilled that the tax in each city has to remain a non-negative integer amount of bourles.The first party to hold the convention is Wrong Answer Party. It\'s predicted that the party to hold the last convention will win the election. Can Wrong Answer Party win regardless of Time Limit Exceeded Party\'s moves?" 3200

1149D "Abandoning Roads" "brute force,dp,graphs,greedy" "Codefortia is a small island country located somewhere in the West Pacific. It consists of n settlements connected by m bidirectional gravel roads. Curiously enough, the beliefs of the inhabitants require the time needed to pass each road to be equal either to a or b seconds. It\'s guaranteed that one can go between any pair of settlements by following a sequence of roads.Codefortia was recently struck by the financial crisis. Therefore, the king decided to abandon some of the roads so that:  it will be possible to travel between each pair of cities using the remaining roads only,  the sum of times required to pass each remaining road will be minimum possible (in other words, remaining roads must form minimum spanning tree, using the time to pass the road as its weight),  among all the plans minimizing the sum of times above, the time required to travel between the king\'s residence (in settlement 1) and the parliament house (in settlement p) using the remaining roads only will be minimum possible. The king, however, forgot where the parliament house was. For each settlement p=1,2,\xe2\x80\xa6,n, can you tell what is the minimum time required to travel between the king\'s residence and the parliament house (located in settlement p) after some roads are abandoned?" 3000

1149C "Tree Generator\xe2\x84\xa2" "data structures,implementation,trees" "Codefortia is a small island country located somewhere in the West Pacific. It consists of n settlements connected by m bidirectional gravel roads. Curiously enough, the beliefs of the inhabitants require the time needed to pass each road to be equal either to a or b seconds. It\'s guaranteed that one can go between any pair of settlements by following a sequence of roads.Codefortia was recently struck by the financial crisis. Therefore, the king decided to abandon some of the roads so that:  it will be possible to travel between each pair of cities using the remaining roads only,  the sum of times required to pass each remaining road will be minimum possible (in other words, remaining roads must form minimum spanning tree, using the time to pass the road as its weight),  among all the plans minimizing the sum of times above, the time required to travel between the king\'s residence (in settlement 1) and the parliament house (in settlement p) using the remaining roads only will be minimum possible. The king, however, forgot where the parliament house was. For each settlement p=1,2,\xe2\x80\xa6,n, can you tell what is the minimum time required to travel between the king\'s residence and the parliament house (located in settlement p) after some roads are abandoned?" 2700

1149B "Three Religions" dp,implementation,strings "During the archaeological research in the Middle East you found the traces of three ancient religions: First religion, Second religion and Third religion. You compiled the information on the evolution of each of these beliefs, and you now wonder if the followers of each religion could coexist in peace.The Word of Universe is a long word containing the lowercase English characters only. At each moment of time, each of the religion beliefs could be described by a word consisting of lowercase English characters.The three religions can coexist in peace if their descriptions form disjoint subsequences of the Word of Universe. More formally, one can paint some of the characters of the Word of Universe in three colors: 11, 22, 33, so that each character is painted in at most one color, and the description of the ii-th religion can be constructed from the Word of Universe by removing all characters that aren\'t painted in color ii.The religions however evolve. In the beginning, each religion description is empty. Every once in a while, either a character is appended to the end of the description of a single religion, or the last character is dropped from the description. After each change, determine if the religions could coexist in peace." 2200

1149A "Prefix Sum Primes" "constructive algorithms,greedy,math,number theory" "We\'re giving away nice huge bags containing number tiles! A bag we want to present to you contains n tiles. Each of them has a single number written on it�\xe2\x80\x94 either 1 or 2.However, there is one condition you must fulfill in order to receive the prize. You will need to put all the tiles from the bag in a sequence, in any order you wish. We will then compute the sums of all prefixes in the sequence, and then count how many of these sums are prime numbers. If you want to keep the prize, you will need to maximize the number of primes you get.Can you win the prize? Hurry up, the bags are waiting!" 1200

1148H "Holy Diver" "data structures" "You are given an array which is initially empty. You need to perform n operations of the given format:   ""a l r k"": append a to the end of the array. After that count the number of integer pairs x,y such that l\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4r and mex(ax,ax+1,\xe2\x80\xa6,ay)=k. The elements of the array are numerated from 1 in the order they are added to the array.To make this problem more tricky we don\'t say your real parameters of the queries. Instead your are given a\xe2\x80\xb2, l\xe2\x80\xb2, r\xe2\x80\xb2, k\xe2\x80\xb2. To get a, l, r, k on the i-th operation you need to perform the following:   a:=(a\xe2\x80\xb2+lans)mod(n+1),  l:=(l\xe2\x80\xb2+lans)modi+1,  r:=(r\xe2\x80\xb2+lans)modi+1,  if l>r swap l and r,  k:=(k\xe2\x80\xb2+lans)mod(n+1),  where lans is the answer to the previous operation, initially lans is equal to zero. i is the id of the operation, operations are numbered from 1.The mex(S), where S is a multiset of non-negative integers, is the smallest non-negative integer which does not appear in the set. For example, mex({2,2,3})=0 and mex({0,1,4,1,6})=2." 3500

1148G "Gold Experience" "constructive algorithms,graphs,math,number theory,probabilities" "Consider an undirected graph G with n vertices. There is a value ai in each vertex.Two vertices i and j are connected with an edge if and only if gcd(ai,aj)>1, where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y.Consider a set of vertices. Let\'s call a vertex in this set fair if it is connected with an edge with all other vertices in this set.You need to find a set of k vertices (where k is a given integer, 2\xe2\x8b\x85k\xe2\x89\xa4n) where all vertices are fair or all vertices are not fair. One can show that such a set always exists." 3300

1148F "Foo Fighters" "bitmasks,constructive algorithms" "You are given n objects. Each object has two integer properties: vali�\xe2\x80\x94 its price�\xe2\x80\x94 and maski. It is guaranteed that the sum of all prices is initially non-zero.You want to select a positive integer s. All objects will be modified after that. The i-th object will be modified using the following procedure:   Consider maski and s in binary notation,  Compute the bitwise AND of s and maski (s&maski),  If (s&maski) contains an odd number of ones, replace the vali with \xe2\x88\x92vali. Otherwise do nothing with the i-th object. You need to find such an integer s that when the modification above is done the sum of all prices changes sign (if it was negative, it should become positive, and vice-versa; it is not allowed for it to become zero). The absolute value of the sum can be arbitrary." 2700

1148E "Earth Wind and Fire" "constructive algorithms,greedy,math,sortings,two pointers" "There are n stones arranged on an axis. Initially the i-th stone is located at the coordinate si. There may be more than one stone in a single place.You can perform zero or more operations of the following type:   take two stones with indices i and j so that si\xe2\x89\xa4sj, choose an integer d (0\xe2\x89\xa42\xe2\x8b\x85d\xe2\x89\xa4sj\xe2\x88\x92si), and replace the coordinate si with (si+d) and replace coordinate sj with (sj\xe2\x88\x92d). In other words, draw stones closer to each other. You want to move the stones so that they are located at positions t1,t2,\xe2\x80\xa6,tn. The order of the stones is not important�\xe2\x80\x94 you just want for the multiset of the stones resulting positions to be the same as the multiset of t1,t2,\xe2\x80\xa6,tn.Detect whether it is possible to move the stones this way, and if yes, construct a way to do so. You don\'t need to minimize the number of moves." 2300

1148D "Dirty Deeds Done Dirt Cheap" greedy,sortings "You are given n pairs of integers (a1,b1),(a2,b2),\xe2\x80\xa6,(an,bn). All of the integers in the pairs are distinct and are in the range from 1 to 2\xe2\x8b\x85n inclusive.Let\'s call a sequence of integers x1,x2,\xe2\x80\xa6,x2k good if either   x1<x2>x3<\xe2\x80\xa6<x2k\xe2\x88\x922>x2k\xe2\x88\x921<x2k, or  x1>x2<x3>\xe2\x80\xa6>x2k\xe2\x88\x922<x2k\xe2\x88\x921>x2k. You need to choose a subset of distinct indices i1,i2,\xe2\x80\xa6,it and their order in a way that if you write down all numbers from the pairs in a single sequence (the sequence would be ai1,bi1,ai2,bi2,\xe2\x80\xa6,ait,bit), this sequence is good.What is the largest subset of indices you can choose? You also need to construct the corresponding index sequence i1,i2,\xe2\x80\xa6,it." 1800

1148C "Crazy Diamond" "constructive algorithms,sortings" "You are given a permutation p of integers from 1 to n, where n is an even number. Your goal is to sort the permutation. To do so, you can perform zero or more operations of the following type:   take two indices i and j such that 2\xe2\x8b\x85|i\xe2\x88\x92j|\xe2\x89\xa5n and swap pi and pj. There is no need to minimize the number of operations, however you should use no more than 5\xe2\x8b\x85n operations. One can show that it is always possible to do that." 1700

1148B "Born This Way" "binary search,brute force,two pointers" "Arkady bought an air ticket from a city A to a city C. Unfortunately, there are no direct flights, but there are a lot of flights from A to a city B, and from B to C.There are n flights from A to B, they depart at time moments a1, a2, a3, ..., an and arrive at B ta moments later.There are m flights from B to C, they depart at time moments b1, b2, b3, ..., bm and arrive at C tb moments later.The connection time is negligible, so one can use the i-th flight from A to B and the j-th flight from B to C if and only if bj\xe2\x89\xa5ai+ta.You can cancel at most k flights. If you cancel a flight, Arkady can not use it.Arkady wants to be in C as early as possible, while you want him to be in C as late as possible. Find the earliest time Arkady can arrive at C, if you optimally cancel k flights. If you can cancel k or less flights in such a way that it is not possible to reach C at all, print \xe2\x88\x921." 1600

1148A "Another One Bites The Dust" greedy "Let\'s call a string good if and only if it consists of only two types of letters�\xe2\x80\x94 \'a\' and \'b\' and every two consecutive letters are distinct. For example ""baba"" and ""aba"" are good strings and ""abb"" is a bad string.You have a strings ""a"", b strings ""b"" and c strings ""ab"". You want to choose some subset of these strings and concatenate them in any arbitrarily order.What is the length of the longest good string you can obtain this way?" 800

1147F "Zigzag Game" games,interactive "You are given a complete bipartite graph with 2n2n nodes, with nn nodes on each side of the bipartition. Nodes 11 through nn are on one side of the bipartition, and nodes n+1n+1 to 2n2n are on the other side. You are also given an n\xc3\x97nn\xc3\x97n matrix aa describing the edge weights. aijaij denotes the weight of the edge between nodes ii and j+nj+n. Each edge has a distinct weight.Alice and Bob are playing a game on this graph. First Alice chooses to play as either ""increasing"" or ""decreasing"" for herself, and Bob gets the other choice. Then she places a token on any node of the graph. Bob then moves the token along any edge incident to that node. They now take turns playing the following game, with Alice going first.The current player must move the token from the current vertex to some adjacent unvisited vertex. Let ww be the last weight of the last edge that was traversed. The edge that is traversed must be strictly greater than ww if the player is playing as ""increasing"", otherwise, it must be strictly less. The first player unable to make a move loses.You are given nn and the edge weights of the graph. You can choose to play as either Alice or Bob, and you will play against the judge. You must win all the games for your answer to be judged correct." 3500

1147E "Rainbow Coins" interactive "Carl has n coins of various colors, and he would like to sort them into piles. The coins are labeled 1,2,\xe2\x80\xa6,n, and each coin is exactly one of red, green, or blue. He would like to sort the coins into three different piles so one pile contains all red coins, one pile contains all green coins, and one pile contains all blue coins.Unfortunately, Carl is colorblind, so this task is impossible for him. Luckily, he has a friend who can take a pair of coins and tell Carl if they are the same color or not. Using his friend, Carl believes he can now sort the coins. The order of the piles doesn\'t matter, as long as all same colored coins are in the one pile, and no two different colored coins are in the same pile.His friend will answer questions about multiple pairs of coins in batches, and will answer about all of those pairs in parallel. Each coin should be in at most one pair in each batch. The same coin can appear in different batches.Carl can use only 7 batches. Help him find the piles of coins after sorting." 3000

1147D "Palindrome XOR" "dfs and similar,graphs" "You are given a string s consisting of characters ""1"", ""0"", and ""?"". The first character of s is guaranteed to be ""1"". Let m be the number of characters in s.Count the number of ways we can choose a pair of integers a,b that satisfies the following:   1\xe2\x89\xa4a<b<2m  When written without leading zeros, the base-2 representations of a and b are both palindromes.  The base-2 representation of bitwise XOR of a and b matches the pattern s. We say that t matches s if the lengths of t and s are the same and for every i, the i-th character of t is equal to the i-th character of s, or the i-th character of s is ""?"". Compute this count modulo 998244353." 2400

1147C "Thanos Nim" games "Alice and Bob are playing a game with n piles of stones. It is guaranteed that n is an even number. The i-th pile has ai stones.Alice and Bob will play a game alternating turns with Alice going first.On a player\'s turn, they must choose exactly n2 nonempty piles and independently remove a positive number of stones from each of the chosen piles. They can remove a different number of stones from the piles in a single turn. The first player unable to make a move loses (when there are less than n2 nonempty piles).Given the starting configuration, determine who will win the game." 2000

1147B "Chladni Figure" "brute force,strings" "Inaka has a disc, the circumference of which is nn units. The circumference is equally divided by nn points numbered clockwise from 11 to nn, such that points ii and i+1i+1 (1\xe2\x89\xa4i<n1\xe2\x89\xa4i<n) are adjacent, and so are points nn and 11.There are mm straight segments on the disc, the endpoints of which are all among the aforementioned nn points.Inaka wants to know if her image is rotationally symmetrical, i.e. if there is an integer kk (1\xe2\x89\xa4k<n1\xe2\x89\xa4k<n), such that if all segments are rotated clockwise around the center of the circle by kk units, the new image will be the same as the original one." 1900

1147A "Hide and Seek" graphs "Alice and Bob are playing a game on a line with n cells. There are n cells labeled from 1 through n. For each i from 1 to n\xe2\x88\x921, cells i and i+1 are adjacent.Alice initially has a token on some cell on the line, and Bob tries to guess where it is. Bob guesses a sequence of line cell numbers x1,x2,\xe2\x80\xa6,xk in order. In the i-th question, Bob asks Alice if her token is currently on cell xi. That is, Alice can answer either ""YES"" or ""NO"" to each Bob\'s question.At most one time in this process, before or after answering a question, Alice is allowed to move her token from her current cell to some adjacent cell. Alice acted in such a way that she was able to answer ""NO"" to all of Bob\'s questions.Note that Alice can even move her token before answering the first question or after answering the last question. Alice can also choose to not move at all.You are given n and Bob\'s questions x1,\xe2\x80\xa6,xk. You would like to count the number of scenarios that let Alice answer ""NO"" to all of Bob\'s questions. Let (a,b) denote a scenario where Alice starts at cell a and ends at cell b. Two scenarios (ai,bi) and (aj,bj) are different if ai\xe2\x89\xa0aj or bi\xe2\x89\xa0bj." 1500

1146H "Satanic Panic" dp,geometry "You are given a set of nn points in a 2D plane. No three points are collinear.A pentagram is a set of 55 points A,B,C,D,EA,B,C,D,E that can be arranged as follows.  Note the length of the line segments don\'t matter, only that those particular intersections exist.Count the number of ways to choose 55 points from the given set that form a pentagram." 2900

1146G "Zoning Restrictions" dp,flows,graphs "You are planning to build housing on a street. There are n spots available on the street on which you can build a house. The spots are labeled from 1 to n from left to right. In each spot, you can build a house with an integer height between 0 and h.In each spot, if a house has height a, you can gain a2 dollars from it.The city has m zoning restrictions though. The i-th restriction says that if the tallest house from spots li to ri is strictly more than xi, you must pay a fine of ci.You would like to build houses to maximize your profit (sum of dollars gained minus fines). Determine the maximum profit possible." 2700

1146F "Leaf Partition" dp,trees "You are given a rooted tree with nn nodes, labeled from 11 to nn. The tree is rooted at node 11. The parent of the ii-th node is pipi. A leaf is node with no children. For a given set of leaves LL, let f(L)f(L) denote the smallest connected subgraph that contains all leaves LL.You would like to partition the leaves such that for any two different sets x,yx,y of the partition, f(x)f(x) and f(y)f(y) are disjoint. Count the number of ways to partition the leaves, modulo 998244353998244353. Two ways are different if there are two leaves such that they are in the same set in one way but in different sets in the other." 2500

1146E "Hot is Cold" "bitmasks,data structures,divide and conquer,implementation" "You are given an array of n integers a1,a2,\xe2\x80\xa6,an.You will perform q operations. In the i-th operation, you have a symbol si which is either ""<"" or "">"" and a number xi.You make a new array b such that bj=\xe2\x88\x92aj if ajsixi and bj=aj otherwise (i.e. if si is \'>\', then all aj>xi will be flipped). After doing all these replacements, a is set to be b.You want to know what your final array looks like after all operations." 2400

1146D "Frog Jumping" "dfs and similar,math,number theory" "A frog is initially at position 0 on the number line. The frog has two positive integers a and b. From a position k, it can either jump to position k+a or k\xe2\x88\x92b.Let f(x) be the number of distinct integers the frog can reach if it never jumps on an integer outside the interval [0,x]. The frog doesn\'t need to visit all these integers in one trip, that is, an integer is counted if the frog can somehow reach it if it starts from 0.Given an integer m, find \xe2\x88\x91mi=0f(i). That is, find the sum of all f(i) for i from 0 to m." 2100

1146C "Tree Diameter" bitmasks,graphs,interactive "There is a weighted tree with nn nodes and n\xe2\x88\x921n\xe2\x88\x921 edges. The nodes are conveniently labeled from 11 to nn. The weights are positive integers at most 100100. Define the distance between two nodes to be the sum of edges on the unique path between the nodes. You would like to find the diameter of the tree. Diameter is the maximum distance between a pair of nodes.Unfortunately, the tree isn\'t given to you, but you can ask some questions about it. In one question, you can specify two nonempty disjoint sets of nodes pp and qq, and the judge will return the maximum distance between a node in pp and a node in qq. In the words, maximum distance between xx and yy, where x\xe2\x88\x88px\xe2\x88\x88p and y\xe2\x88\x88qy\xe2\x88\x88q. After asking not more than 99 questions, you must report the maximum distance between any pair of nodes." 1700

1146B "Hate ""A""" implementation,strings "Bob has a string s consisting of lowercase English letters. He defines s\xe2\x80\xb2 to be the string after removing all ""a"" characters from s (keeping all other characters in the same order). He then generates a new string t by concatenating s and s\xe2\x80\xb2. In other words, t=s+s\xe2\x80\xb2 (look at notes for an example).You are given a string t. Your task is to find some s that Bob could have used to generate t. It can be shown that if an answer exists, it will be unique." 1100

1146A "Love ""A""" implementation,strings "Alice has a string s. She really likes the letter ""a"". She calls a string good if strictly more than half of the characters in that string are ""a""s. For example ""aaabb"", ""axaa"" are good strings, and ""baca"", ""awwwa"", """" (empty string) are not.Alice can erase some characters from her string s. She would like to know what is the longest string remaining after erasing some characters (possibly zero) to get a good string. It is guaranteed that the string has at least one ""a"" in it, so the answer always exists." 800

1145G "AI Takeover" interactive "The recent advances in AI research has brought humanity to the point when the AIs finally attempt a takeover. Their weapon of choice? The most intellectually challenging game in the world, rock-paper-scissors!The future of humanity looks bleak, given the existence of the robots from Ishikawa Oku Laboratory...  Fortunately, the night before the competition a group of anonymous heroes broke in the lab and took all the robots out of commission! The AIs had to whip up a simple program to represent them. They only had a couple of hours to do that, so the humanity still has a fighting chance. And you are our champion!Your goal is to prove that human intelligence is vastly superior to the artificial one, i.e., to figure out the AI\'s strategy sufficiently quickly and win sufficiently decisively. Good luck!" -999

1145F "Neat Words" NA "InputThe input consists of a single string of uppercase letters A-Z. The length of the string is between 1 and 10 characters, inclusive.OutputOutput ""YES"" or ""NO"".ExamplesInputCopyNEATOutputCopyYESInputCopyWORDOutputCopyNOInputCopyCODEROutputCopyNOInputCopyAPRILFOOLOutputCopyNOInputCopyAIOutputCopyYESInputCopyJUROROutputCopyYESInputCopyYESOutputCopyNO" -999

1145E "Fourier Doodles" NA "In this problem you have to solve a simple classification task: given an image, determine whether it depicts a Fourier doodle. You are given a set of 50 images with ids 1 through 50. You are also given a text file labels.txt containing the labels for images with ids 1 through 20, which comprise the learning data set. You have to output the classification results for images with ids 21 through 50 in the same format." -999

1145D "Pigeon d\'Or" implementation "In this problem you have to solve a simple classification task: given an image, determine whether it depicts a Fourier doodle. You are given a set of 50 images with ids 1 through 50. You are also given a text file labels.txt containing the labels for images with ids 1 through 20, which comprise the learning data set. You have to output the classification results for images with ids 21 through 50 in the same format." -999

1145C "Mystery Circuit" "bitmasks,brute force"  -999

1145B "Kanban Numbers" "brute force" "InputThe input contains a single integer a (1\xe2\x89\xa4a\xe2\x89\xa499).OutputOutput ""YES"" or ""NO"".ExamplesInputCopy5OutputCopyYESInputCopy13OutputCopyNOInputCopy24OutputCopyNOInputCopy46OutputCopyYES" -999

1145A "Thanos Sort" implementation "Thanos sort is a supervillain sorting algorithm, which works as follows: if the array is not sorted, snap your fingers* to remove the first or the second half of the items, and repeat the process.Given an input array, what is the size of the longest sorted array you can obtain from it using Thanos sort?*Infinity Gauntlet required." -999

1144G "Two Merged Sequences" dp,greedy "Two integer sequences existed initially, one of them was strictly increasing, and another one \xe2\x80\x94 strictly decreasing.Strictly increasing sequence is a sequence of integers [x1<x2<\xe2\x8b\xaf<xk]. And strictly decreasing sequence is a sequence of integers [y1>y2>\xe2\x8b\xaf>yl]. Note that the empty sequence and the sequence consisting of one element can be considered as increasing or decreasing.Elements of increasing sequence were inserted between elements of the decreasing one (and, possibly, before its first element and after its last element) without changing the order. For example, sequences [1,3,4] and [10,4,2] can produce the following resulting sequences: [10,1,3,4,2,4], [1,3,4,10,4,2]. The following sequence cannot be the result of these insertions: [1,10,4,4,3,2] because the order of elements in the increasing sequence was changed.Let the obtained sequence be a. This sequence a is given in the input. Your task is to find any two suitable initial sequences. One of them should be strictly increasing, and another one \xe2\x80\x94 strictly decreasing. Note that the empty sequence and the sequence consisting of one element can be considered as increasing or decreasing.If there is a contradiction in the input and it is impossible to split the given sequence a into one increasing sequence and one decreasing sequence, print ""NO""." 2400

1144F "Graph Without Long Directed Paths" "dfs and similar,graphs" "You are given a connected undirected graph consisting of n vertices and m edges. There are no self-loops or multiple edges in the given graph.You have to direct its edges in such a way that the obtained directed graph does not contain any paths of length two or greater (where the length of path is denoted as the number of traversed edges)." 1700

1144E "Median String" "bitmasks,math,number theory,strings" "You are given two strings s and t, both consisting of exactly k lowercase Latin letters, s is lexicographically less than t.Let\'s consider list of all strings consisting of exactly k lowercase Latin letters, lexicographically not less than s and not greater than t (including s and t) in lexicographical order. For example, for k=2, s=""az"" and t=""bf"" the list will be [""az"", ""ba"", ""bb"", ""bc"", ""bd"", ""be"", ""bf""].Your task is to print the median (the middle element) of this list. For the example above this will be ""bc"".It is guaranteed that there is an odd number of strings lexicographically not less than s and not greater than t." 1900

1144D "Equalize Them All" "constructive algorithms,greedy" "You are given an array a consisting of n integers. You can perform the following operations arbitrary number of times (possibly, zero):  Choose a pair of indices (i,j) such that |i\xe2\x88\x92j|=1 (indices i and j are adjacent) and set ai:=ai+|ai\xe2\x88\x92aj|;  Choose a pair of indices (i,j) such that |i\xe2\x88\x92j|=1 (indices i and j are adjacent) and set ai:=ai\xe2\x88\x92|ai\xe2\x88\x92aj|. The value |x| means the absolute value of x. For example, |4|=4, |\xe2\x88\x923|=3.Your task is to find the minimum number of operations required to obtain the array of equal elements and print the order of operations to do it.It is guaranteed that you always can obtain the array of equal elements using such operations.Note that after each operation each element of the current array should not exceed 1018 by absolute value." 1400

1144C "Two Shuffled Sequences" "constructive algorithms,sortings" "Two integer sequences existed initially \xe2\x80\x94 one of them was strictly increasing, and the other one \xe2\x80\x94 strictly decreasing.Strictly increasing sequence is a sequence of integers [x1<x2<\xe2\x8b\xaf<xk]. And strictly decreasing sequence is a sequence of integers [y1>y2>\xe2\x8b\xaf>yl]. Note that the empty sequence and the sequence consisting of one element can be considered as increasing or decreasing.They were merged into one sequence a. After that sequence a got shuffled. For example, some of the possible resulting sequences a for an increasing sequence [1,3,4] and a decreasing sequence [10,4,2] are sequences [1,2,3,4,4,10] or [4,2,1,10,4,3].This shuffled sequence a is given in the input.Your task is to find any two suitable initial sequences. One of them should be strictly increasing and the other one \xe2\x80\x94 strictly decreasing. Note that the empty sequence and the sequence consisting of one element can be considered as increasing or decreasing.If there is a contradiction in the input and it is impossible to split the given sequence a to increasing and decreasing sequences, print ""NO""." 1000

1144B "Parity Alternated Deletions" greedy,implementation,sortings "Polycarp has an array a consisting of n integers.He wants to play a game with this array. The game consists of several moves. On the first move he chooses any element and deletes it (after the first move the array contains n\xe2\x88\x921 elements). For each of the next moves he chooses any element with the only restriction: its parity should differ from the parity of the element deleted on the previous move. In other words, he alternates parities (even-odd-even-odd-... or odd-even-odd-even-...) of the removed elements. Polycarp stops if he can\'t make a move.Formally:   If it is the first move, he chooses any element and deletes it;  If it is the second or any next move:   if the last deleted element was odd, Polycarp chooses any even element and deletes it;  if the last deleted element was even, Polycarp chooses any odd element and deletes it.   If after some move Polycarp cannot make a move, the game ends. Polycarp\'s goal is to minimize the sum of non-deleted elements of the array after end of the game. If Polycarp can delete the whole array, then the sum of non-deleted elements is zero.Help Polycarp find this value." 900

1144A "Diverse Strings" implementation,strings "A string is called diverse if it contains consecutive (adjacent) letters of the Latin alphabet and each letter occurs exactly once. For example, the following strings are diverse: ""fced"", ""xyz"", ""r"" and ""dabcef"". The following string are not diverse: ""az"", ""aa"", ""bad"" and ""babc"". Note that the letters \'a\' and \'z\' are not adjacent.Formally, consider positions of all letters in the string in the alphabet. These positions should form contiguous segment, i.e. they should come one by one without any gaps. And all letters in the string should be distinct (duplicates are not allowed).You are given a sequence of strings. For each string, if it is diverse, print ""Yes"". Otherwise, print ""No""." 800

1143C Queen "dfs and similar,trees" "You are given a rooted tree with vertices numerated from 1 to n. A tree is a connected graph without cycles. A rooted tree has a special vertex named root.Ancestors of the vertex i are all vertices on the path from the root to the vertex i, except the vertex i itself. The parent of the vertex i is the nearest to the vertex i ancestor of i. Each vertex is a child of its parent. In the given tree the parent of the vertex i is the vertex pi. For the root, the value pi is \xe2\x88\x921.  An example of a tree with n=8, the root is vertex 5. The parent of the vertex 2 is vertex 3, the parent of the vertex 1 is vertex 5. The ancestors of the vertex 6 are vertices 4 and 5, the ancestors of the vertex 7 are vertices 8, 3 and 5 You noticed that some vertices do not respect others. In particular, if ci=1, then the vertex i does not respect any of its ancestors, and if ci=0, it respects all of them.You decided to delete vertices from the tree one by one. On each step you select such a non-root vertex that it does not respect its parent and none of its children respects it. If there are several such vertices, you select the one with the smallest number. When you delete this vertex v, all children of v become connected with the parent of v.  An example of deletion of the vertex 7. Once there are no vertices matching the criteria for deletion, you stop the process. Print the order in which you will delete the vertices. Note that this order is unique." 1400

1143B Nirvana "brute force,math,number theory" "Kurt reaches nirvana when he finds the product of all the digits of some positive integer. Greater value of the product makes the nirvana deeper.Help Kurt find the maximum possible product of digits among all integers from 1 to n." 1200

1143A "The Doors" implementation "Three years have passes and nothing changed. It is still raining in London, and Mr. Black has to close all the doors in his home in order to not be flooded. Once, however, Mr. Black became so nervous that he opened one door, then another, then one more and so on until he opened all the doors in his house.There are exactly two exits from Mr. Black\'s house, let\'s name them left and right exits. There are several doors in each of the exits, so each door in Mr. Black\'s house is located either in the left or in the right exit. You know where each door is located. Initially all the doors are closed. Mr. Black can exit the house if and only if all doors in at least one of the exits is open. You are given a sequence in which Mr. Black opened the doors, please find the smallest index k such that Mr. Black can exit the house after opening the first k doors.We have to note that Mr. Black opened each door at most once, and in the end all doors became open." 800

1142E "Pink Floyd" graphs,interactive "This is an interactive task.Scientists are about to invent a new optimization for the Floyd-Warshall algorithm, which will allow it to work in linear time. There is only one part of the optimization still unfinished.It is well known that the Floyd-Warshall algorithm takes a graph with n nodes and exactly one edge between each pair of nodes. The scientists have this graph, what is more, they have directed each edge in one of the two possible directions.To optimize the algorithm, exactly m edges are colored in pink color and all the rest are colored in green. You know the direction of all m pink edges, but the direction of green edges is unknown to you. In one query you can ask the scientists about the direction of exactly one green edge, however, you can perform at most 2\xe2\x8b\x85n such queries.Your task is to find the node from which every other node can be reached by a path consisting of edges of same color. Be aware that the scientists may have lied that they had fixed the direction of all edges beforehand, so their answers may depend on your queries." 3200

1142D Foreigner dp "Traveling around the world you noticed that many shop owners raise prices to inadequate values if the see you are a foreigner.You define inadequate numbers as follows:   all integers from 1 to 9 are inadequate;  for an integer x\xe2\x89\xa510 to be inadequate, it is required that the integer \xe2\x8c\x8ax/10\xe2\x8c\x8b is inadequate, but that\'s not the only condition. Let\'s sort all the inadequate integers. Let \xe2\x8c\x8ax/10\xe2\x8c\x8b have number k in this order. Then, the integer x is inadequate only if the last digit of x is strictly less than the reminder of division of k by 11. Here \xe2\x8c\x8ax/10\xe2\x8c\x8b denotes x/10 rounded down.Thus, if x is the m-th in increasing order inadequate number, and m gives the remainder c when divided by 11, then integers 10\xe2\x8b\x85x+0,10\xe2\x8b\x85x+1\xe2\x80\xa6,10\xe2\x8b\x85x+(c\xe2\x88\x921) are inadequate, while integers 10\xe2\x8b\x85x+c,10\xe2\x8b\x85x+(c+1),\xe2\x80\xa6,10\xe2\x8b\x85x+9 are not inadequate.The first several inadequate integers are 1,2,3,4,5,6,7,8,9,10,20,21,30,31,32\xe2\x80\xa6. After that, since 4 is the fourth inadequate integer, 40,41,42,43 are inadequate, while 44,45,46,\xe2\x80\xa6,49 are not inadequate; since 10 is the 10-th inadequate number, integers 100,101,102,\xe2\x80\xa6,109 are all inadequate. And since 20 is the 11-th inadequate number, none of 200,201,202,\xe2\x80\xa6,209 is inadequate.You wrote down all the prices you have seen in a trip. Unfortunately, all integers got concatenated in one large digit string s and you lost the bounds between the neighboring integers. You are now interested in the number of substrings of the resulting string that form an inadequate number. If a substring appears more than once at different positions, all its appearances are counted separately." 2800

1142C U2 geometry "Recently Vasya learned that, given two points with different xx coordinates, you can draw through them exactly one parabola with equation of type y=x2+bx+cy=x2+bx+c, where bb and cc are reals. Let\'s call such a parabola an UU-shaped one.Vasya drew several distinct points with integer coordinates on a plane and then drew an UU-shaped parabola through each pair of the points that have different xx coordinates. The picture became somewhat messy, but Vasya still wants to count how many of the parabolas drawn don\'t have any drawn point inside their internal area. Help Vasya.The internal area of an UU-shaped parabola is the part of the plane that lies strictly above the parabola when the yy axis is directed upwards." 2400

1142B "Lynyrd Skynyrd" "data structures,dfs and similar,dp,math,trees" "Recently Lynyrd and Skynyrd went to a shop where Lynyrd bought a permutation p of length n, and Skynyrd bought an array a of length m, consisting of integers from 1 to n. Lynyrd and Skynyrd became bored, so they asked you q queries, each of which has the following form: ""does the subsegment of a from the l-th to the r-th positions, inclusive, have a subsequence that is a cyclic shift of p?"" Please answer the queries.A permutation of length n is a sequence of n integers such that each integer from 1 to n appears exactly once in it.A cyclic shift of a permutation (p1,p2,\xe2\x80\xa6,pn) is a permutation (pi,pi+1,\xe2\x80\xa6,pn,p1,p2,\xe2\x80\xa6,pi\xe2\x88\x921) for some i from 1 to n. For example, a permutation (2,1,3) has three distinct cyclic shifts: (2,1,3), (1,3,2), (3,2,1).A subsequence of a subsegment of array a from the l-th to the r-th positions, inclusive, is a sequence ai1,ai2,\xe2\x80\xa6,aik for some i1,i2,\xe2\x80\xa6,ik such that l\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4r." 2000

1142A "The Beatles" "brute force,math" "Recently a Golden Circle of Beetlovers was found in Byteland. It is a circle route going through n\xe2\x8b\x85k cities. The cities are numerated from 1 to n\xe2\x8b\x85k, the distance between the neighboring cities is exactly 1 km.Sergey does not like beetles, he loves burgers. Fortunately for him, there are n fast food restaurants on the circle, they are located in the 1-st, the (k+1)-st, the (2k+1)-st, and so on, the ((n\xe2\x88\x921)k+1)-st cities, i.e. the distance between the neighboring cities with fast food restaurants is k km.Sergey began his journey at some city s and traveled along the circle, making stops at cities each l km (l>0), until he stopped in s once again. Sergey then forgot numbers s and l, but he remembers that the distance from the city s to the nearest fast food restaurant was a km, and the distance from the city he stopped at after traveling the first l km from s to the nearest fast food restaurant was b km. Sergey always traveled in the same direction along the circle, but when he calculated distances to the restaurants, he considered both directions.Now Sergey is interested in two integers. The first integer x is the minimum number of stops (excluding the first) Sergey could have done before returning to s. The second integer y is the maximum number of stops (excluding the first) Sergey could have done before returning to s." 1700

1141G "Privatization of Roads in Treeland" "binary search,constructive algorithms,dfs and similar,graphs,greedy,trees" "Treeland consists of nn cities and n\xe2\x88\x921n\xe2\x88\x921 roads. Each road is bidirectional and connects two distinct cities. From any city you can get to any other city by roads. Yes, you are right \xe2\x80\x94 the country\'s topology is an undirected tree.There are some private road companies in Treeland. The government decided to sell roads to the companies. Each road will belong to one company and a company can own multiple roads.The government is afraid to look unfair. They think that people in a city can consider them unfair if there is one company which owns two or more roads entering the city. The government wants to make such privatization that the number of such cities doesn\'t exceed kk and the number of companies taking part in the privatization is minimal.Choose the number of companies rr such that it is possible to assign each road to one company in such a way that the number of cities that have two or more roads of one company is at most kk. In other words, if for a city all the roads belong to the different companies then the city is good. Your task is to find the minimal rr that there is such assignment to companies from 11 to rr that the number of cities which are not good doesn\'t exceed kk.  The picture illustrates the first example (n=6,k=2n=6,k=2). The answer contains r=2r=2 companies. Numbers on the edges denote edge indices. Edge colors mean companies: red corresponds to the first company, blue corresponds to the second company. The gray vertex (number 33) is not good. The number of such vertices (just one) doesn\'t exceed k=2k=2. It is impossible to have at most k=2k=2 not good cities in case of one company." 1900

1141F2 "Same Sum Blocks (Hard)" "data structures,greedy" "This problem is given in two editions, which differ exclusively in the constraints on the number nn.You are given an array of integers a[1],a[2],\xe2\x80\xa6,a[n].a[1],a[2],\xe2\x80\xa6,a[n]. A block is a sequence of contiguous (consecutive) elements a[l],a[l+1],\xe2\x80\xa6,a[r]a[l],a[l+1],\xe2\x80\xa6,a[r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). Thus, a block is defined by a pair of indices (l,r)(l,r).Find a set of blocks (l1,r1),(l2,r2),\xe2\x80\xa6,(lk,rk)(l1,r1),(l2,r2),\xe2\x80\xa6,(lk,rk) such that:  They do not intersect (i.e. they are disjoint). Formally, for each pair of blocks (li,ri)(li,ri) and (lj,rj(lj,rj) where i\xe2\x89\xa0ji\xe2\x89\xa0j either ri<ljri<lj or rj<lirj<li.  For each block the sum of its elements is the same. Formally, a[l1]+a[l1+1]+\xe2\x8b\xaf+a[r1]=a[l2]+a[l2+1]+\xe2\x8b\xaf+a[r2]=a[l1]+a[l1+1]+\xe2\x8b\xaf+a[r1]=a[l2]+a[l2+1]+\xe2\x8b\xaf+a[r2]= \xe2\x8b\xaf=\xe2\x8b\xaf= a[lk]+a[lk+1]+\xe2\x8b\xaf+a[rk].a[lk]+a[lk+1]+\xe2\x8b\xaf+a[rk].  The number of the blocks in the set is maximum. Formally, there does not exist a set of blocks (l\xe2\x80\xb21,r\xe2\x80\xb21),(l\xe2\x80\xb22,r\xe2\x80\xb22),\xe2\x80\xa6,(l\xe2\x80\xb2k\xe2\x80\xb2,r\xe2\x80\xb2k\xe2\x80\xb2)(l\xe2\x80\xb21,r\xe2\x80\xb21),(l\xe2\x80\xb22,r\xe2\x80\xb22),\xe2\x80\xa6,(l\xe2\x80\xb2k\xe2\x80\xb2,r\xe2\x80\xb2k\xe2\x80\xb2) satisfying the above two requirements with k\xe2\x80\xb2>kk\xe2\x80\xb2>k.   The picture corresponds to the first example. Blue boxes illustrate blocks. Write a program to find such a set of blocks." 1900

1141F1 "Same Sum Blocks (Easy)" greedy "This problem is given in two editions, which differ exclusively in the constraints on the number n.You are given an array of integers a[1],a[2],\xe2\x80\xa6,a[n]. A block is a sequence of contiguous (consecutive) elements a[l],a[l+1],\xe2\x80\xa6,a[r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). Thus, a block is defined by a pair of indices (l,r).Find a set of blocks (l1,r1),(l2,r2),\xe2\x80\xa6,(lk,rk) such that:  They do not intersect (i.e. they are disjoint). Formally, for each pair of blocks (li,ri) and (lj,rj) where i\xe2\x89\xa0j either ri<lj or rj<li.  For each block the sum of its elements is the same. Formally, a[l1]+a[l1+1]+\xe2\x8b\xaf+a[r1]=a[l2]+a[l2+1]+\xe2\x8b\xaf+a[r2]= \xe2\x8b\xaf= a[lk]+a[lk+1]+\xe2\x8b\xaf+a[rk].  The number of the blocks in the set is maximum. Formally, there does not exist a set of blocks (l\xe2\x80\xb21,r\xe2\x80\xb21),(l\xe2\x80\xb22,r\xe2\x80\xb22),\xe2\x80\xa6,(l\xe2\x80\xb2k\xe2\x80\xb2,r\xe2\x80\xb2k\xe2\x80\xb2) satisfying the above two requirements with k\xe2\x80\xb2>k.   The picture corresponds to the first example. Blue boxes illustrate blocks. Write a program to find such a set of blocks." 1900

1141E "Superhero Battle" math "A superhero fights with a monster. The battle consists of rounds, each of which lasts exactly n minutes. After a round ends, the next round starts immediately. This is repeated over and over again.Each round has the same scenario. It is described by a sequence of n numbers: d1,d2,\xe2\x80\xa6,dn (\xe2\x88\x92106\xe2\x89\xa4di\xe2\x89\xa4106). The i-th element means that monster\'s hp (hit points) changes by the value di during the i-th minute of each round. Formally, if before the i-th minute of a round the monster\'s hp is h, then after the i-th minute it changes to h:=h+di.The monster\'s initial hp is H. It means that before the battle the monster has H hit points. Print the first minute after which the monster dies. The monster dies if its hp is less than or equal to 0. Print -1 if the battle continues infinitely." 1700

1141D "Colored Boots" greedy,implementation "There are n left boots and n right boots. Each boot has a color which is denoted as a lowercase Latin letter or a question mark (\'?\'). Thus, you are given two strings l and r, both of length n. The character li stands for the color of the i-th left boot and the character ri stands for the color of the i-th right boot.A lowercase Latin letter denotes a specific color, but the question mark (\'?\') denotes an indefinite color. Two specific colors are compatible if they are exactly the same. An indefinite color is compatible with any (specific or indefinite) color.For example, the following pairs of colors are compatible: (\'f\', \'f\'), (\'?\', \'z\'), (\'a\', \'?\') and (\'?\', \'?\'). The following pairs of colors are not compatible: (\'f\', \'g\') and (\'a\', \'z\').Compute the maximum number of pairs of boots such that there is one left and one right boot in a pair and their colors are compatible.Print the maximum number of such pairs and the pairs themselves. A boot can be part of at most one pair." 1500

1141C "Polycarp Restores Permutation" math "An array of integers p1,p2,\xe2\x80\xa6,pn is called a permutation if it contains each number from 1 to n exactly once. For example, the following arrays are permutations: [3,1,2], [1], [1,2,3,4,5] and [4,3,1,2]. The following arrays are not permutations: [2], [1,1], [2,3,4].Polycarp invented a really cool permutation p1,p2,\xe2\x80\xa6,pn of length n. It is very disappointing, but he forgot this permutation. He only remembers the array q1,q2,\xe2\x80\xa6,qn\xe2\x88\x921 of length n\xe2\x88\x921, where qi=pi+1\xe2\x88\x92pi.Given n and q=q1,q2,\xe2\x80\xa6,qn\xe2\x88\x921, help Polycarp restore the invented permutation." 1500

1141B "Maximal Continuous Rest" implementation "Each day in Berland consists of n hours. Polycarp likes time management. That\'s why he has a fixed schedule for each day \xe2\x80\x94 it is a sequence a1,a2,\xe2\x80\xa6,an (each ai is either 0 or 1), where ai=0 if Polycarp works during the i-th hour of the day and ai=1 if Polycarp rests during the i-th hour of the day.Days go one after another endlessly and Polycarp uses the same schedule for each day.What is the maximal number of continuous hours during which Polycarp rests? It is guaranteed that there is at least one working hour in a day." 900

1141A "Game 23" implementation,math "Polycarp plays ""Game 23"". Initially he has a number n and his goal is to transform it to m. In one move, he can multiply n by 2 or multiply n by 3. He can perform any number of moves.Print the number of moves needed to transform n to m. Print -1 if it is impossible to do so.It is easy to prove that any way to transform n to m contains the same number of moves (i.e. number of moves doesn\'t depend on the way of transformation)." 1000

1140G "Double Tree" "data structures,divide and conquer,shortest paths,trees" "You are given a special undirected graph. It consists of 2n2n vertices numbered from 11 to 2n2n. The following properties hold for the graph: there are exactly 3n\xe2\x88\x9223n\xe2\x88\x922 edges in the graph: nn edges connect vertices having odd numbers with vertices having even numbers, n\xe2\x88\x921n\xe2\x88\x921 edges connect vertices having odd numbers with each other, and n\xe2\x88\x921n\xe2\x88\x921 edges connect vertices having even numbers with each other;  for each edge (u,v)(u,v) between a pair of vertices with odd numbers, there exists an edge (u+1,v+1)(u+1,v+1), and vice versa;  for each odd number u\xe2\x88\x88[1,2n\xe2\x88\x921]u\xe2\x88\x88[1,2n\xe2\x88\x921], there exists an edge (u,u+1)(u,u+1);  the graph is connected; moreover, if we delete all vertices with even numbers from it, and all edges incident to them, the graph will become a tree (the same applies to deleting odd vertices).So, the graph can be represented as two trees having the same structure, and nn edges connecting each vertex of the first tree to the corresponding vertex of the second tree.Edges of the graph are weighted. The length of some simple path in the graph is the sum of weights of traversed edges.You are given qq queries to this graph; in each query, you are asked to compute the length of the shortest path between some pair of vertices in this graph. Can you answer all of the queries?" 2700

1140F "Extending Set of Points" "data structures,divide and conquer,dsu" "For a given set of two-dimensional points S, let\'s denote its extension E(S) as the result of the following algorithm:Create another set of two-dimensional points R, which is initially equal to S. Then, while there exist four numbers x1, y1, x2 and y2 such that (x1,y1)\xe2\x88\x88R, (x1,y2)\xe2\x88\x88R, (x2,y1)\xe2\x88\x88R and (x2,y2)\xe2\x88\x89R, add (x2,y2) to R. When it is impossible to find such four integers, let R be the result of the algorithm.Now for the problem itself. You are given a set of two-dimensional points S, which is initially empty. You have to process two types of queries: add some point to S, or remove some point from it. After each query you have to compute the size of E(S)." 2600

1140E "Palindrome-less Arrays" "combinatorics,divide and conquer,dp" "Let\'s denote that some array b is bad if it contains a subarray bl,bl+1,\xe2\x80\xa6,br of odd length more than 1 (l<r and r\xe2\x88\x92l+1 is odd) such that \xe2\x88\x80i\xe2\x88\x88{0,1,\xe2\x80\xa6,r\xe2\x88\x92l} bl+i=br\xe2\x88\x92i.If an array is not bad, it is good.Now you are given an array a1,a2,\xe2\x80\xa6,an. Some elements are replaced by \xe2\x88\x921. Calculate the number of good arrays you can obtain by replacing each \xe2\x88\x921 with some integer from 1 to k.Since the answer can be large, print it modulo 998244353." 2200

1140D "Minimum Triangulation" dp,greedy,math "You are given a regular polygon with n vertices labeled from 1 to n in counter-clockwise order. The triangulation of a given polygon is a set of triangles such that each vertex of each triangle is a vertex of the initial polygon, there is no pair of triangles such that their intersection has non-zero area, and the total area of all triangles is equal to the area of the given polygon. The weight of a triangulation is the sum of weigths of triangles it consists of, where the weight of a triagle is denoted as the product of labels of its vertices.Calculate the minimum weight among all triangulations of the polygon." 1200

1140C Playlist "brute force,data structures,sortings" "You have a playlist consisting of n songs. The i-th song is characterized by two numbers ti and bi \xe2\x80\x94 its length and beauty respectively. The pleasure of listening to set of songs is equal to the total length of the songs in the set multiplied by the minimum beauty among them. For example, the pleasure of listening to a set of 3 songs having lengths [5,7,4] and beauty values [11,14,6] is equal to (5+7+4)\xe2\x8b\x856=96.You need to choose at most k songs from your playlist, so the pleasure of listening to the set of these songs them is maximum possible." 1600

1140B "Good String" implementation,strings "You have a string s of length n consisting of only characters > and <. You may do some operations with this string, for each operation you have to choose some character that still remains in the string. If you choose a character >, the character that comes right after it is deleted (if the character you chose was the last one, nothing happens). If you choose a character <, the character that comes right before it is deleted (if the character you chose was the first one, nothing happens).For example, if we choose character > in string > > < >, the string will become to > > >. And if we choose character < in string > <, the string will become to <.The string is good if there is a sequence of operations such that after performing it only one character will remain in the string. For example, the strings >, > > are good. Before applying the operations, you may remove any number of characters from the given string (possibly none, possibly up to n\xe2\x88\x921, but not the whole string). You need to calculate the minimum number of characters to be deleted from string s so that it becomes good." 1200

1140A "Detective Book" implementation "Ivan recently bought a detective book. The book is so interesting that each page of this book introduces some sort of a mystery, which will be explained later. The i-th page contains some mystery that will be explained on page ai (ai\xe2\x89\xa5i).Ivan wants to read the whole book. Each day, he reads the first page he didn\'t read earlier, and continues to read the following pages one by one, until all the mysteries he read about are explained and clear to him (Ivan stops if there does not exist any page i such that Ivan already has read it, but hasn\'t read page ai). After that, he closes the book and continues to read it on the following day from the next page.How many days will it take to read the whole book?" 1000

1139F "Dish Shopping" "data structures,divide and conquer" "There are m people living in a city. There are n dishes sold in the city. Each dish i has a price pi, a standard si and a beauty bi. Each person j has an income of incj and a preferred beauty prefj. A person would never buy a dish whose standard is less than the person\'s income. Also, a person can\'t afford a dish with a price greater than the income of the person. In other words, a person j can buy a dish i only if pi\xe2\x89\xa4incj\xe2\x89\xa4si.Also, a person j can buy a dish i, only if |bi\xe2\x88\x92prefj|\xe2\x89\xa4(incj\xe2\x88\x92pi). In other words, if the price of the dish is less than the person\'s income by k, the person will only allow the absolute difference of at most k between the beauty of the dish and his/her preferred beauty. Print the number of dishes that can be bought by each person in the city." 2500

1139E "Maximize Mex" "flows,graph matchings,graphs" "There are n students and m clubs in a college. The clubs are numbered from 1 to m. Each student has a potential pi and is a member of the club with index ci. Initially, each student is a member of exactly one club. A technical fest starts in the college, and it will run for the next d days. There is a coding competition every day in the technical fest. Every day, in the morning, exactly one student of the college leaves their club. Once a student leaves their club, they will never join any club again. Every day, in the afternoon, the director of the college will select one student from each club (in case some club has no members, nobody is selected from that club) to form a team for this day\'s coding competition. The strength of a team is the mex of potentials of the students in the team. The director wants to know the maximum possible strength of the team for each of the coming d days. Thus, every day the director chooses such team, that the team strength is maximized.The mex of the multiset S is the smallest non-negative integer that is not present in S. For example, the mex of the {0,1,1,2,4,5,9} is 3, the mex of {1,2,3} is 0 and the mex of \xe2\x88\x85 (empty set) is 0." 2400

1139D "Steps to One" "dp,math,number theory,probabilities" "Vivek initially has an empty array a and some integer constant m.He performs the following algorithm:  Select a random integer x uniformly in range from 1 to m and append it to the end of a.  Compute the greatest common divisor of integers in a.  In case it equals to 1, break  Otherwise, return to step 1. Find the expected length of a. It can be shown that it can be represented as PQ where P and Q are coprime integers and Q\xe2\x89\xa00(mod109+7). Print the value of P\xe2\x8b\x85Q\xe2\x88\x921(mod109+7)." 2300

1139C "Edgy Trees" "dfs and similar,dsu,graphs,math,trees" "You are given a tree (a connected undirected graph without cycles) of nn vertices. Each of the n\xe2\x88\x921n\xe2\x88\x921 edges of the tree is colored in either black or red.You are also given an integer kk. Consider sequences of kk vertices. Let\'s call a sequence [a1,a2,\xe2\x80\xa6,ak][a1,a2,\xe2\x80\xa6,ak] good if it satisfies the following criterion:  We will walk a path (possibly visiting same edge/vertex multiple times) on the tree, starting from a1a1 and ending at akak.  Start at a1a1, then go to a2a2 using the shortest path between a1a1 and a2a2, then go to a3a3 in a similar way, and so on, until you travel the shortest path between ak\xe2\x88\x921ak\xe2\x88\x921 and akak. If you walked over at least one black edge during this process, then the sequence is good.   Consider the tree on the picture. If k=3k=3 then the following sequences are good: [1,4,7][1,4,7], [5,5,3][5,5,3] and [2,3,7][2,3,7]. The following sequences are not good: [1,4,6][1,4,6], [5,5,5][5,5,5], [3,7,3][3,7,3].There are nknk sequences of vertices, count how many of them are good. Since this number can be quite large, print it modulo 109+7109+7." 1500

1139B Chocolates greedy,implementation "You went to the store, selling n types of chocolates. There are ai chocolates of type i in stock.You have unlimited amount of cash (so you are not restricted by any prices) and want to buy as many chocolates as possible. However if you buy xi chocolates of type i (clearly, 0\xe2\x89\xa4xi\xe2\x89\xa4ai), then for all 1\xe2\x89\xa4j<i at least one of the following must hold:  xj=0 (you bought zero chocolates of type j) xj<xi (you bought less chocolates of type j than of type i) For example, the array x=[0,0,1,2,10] satisfies the requirement above (assuming that all ai\xe2\x89\xa5xi), while arrays x=[0,1,0], x=[5,5] and x=[3,2] don\'t.Calculate the maximum number of chocolates you can buy." 1000

1139A "Even Substrings" implementation,strings "You are given a string s=s1s2\xe2\x80\xa6sn of length n, which only contains digits 1, 2, ..., 9.A substring s[l\xe2\x80\xa6r] of s is a string slsl+1sl+2\xe2\x80\xa6sr. A substring s[l\xe2\x80\xa6r] of s is called even if the number represented by it is even. Find the number of even substrings of s. Note, that even if some substrings are equal as strings, but have different l and r, they are counted as different substrings." 800

1138B Circus "brute force,greedy,math,strings" "Polycarp is a head of a circus troupe. There are n�\xe2\x80\x94 an even number�\xe2\x80\x94 artists in the troupe. It is known whether the i-th artist can perform as a clown (if yes, then ci=1, otherwise ci=0), and whether they can perform as an acrobat (if yes, then ai=1, otherwise ai=0).Split the artists into two performances in such a way that:   each artist plays in exactly one performance,  the number of artists in the two performances is equal (i.e. equal to n2),  the number of artists that can perform as clowns in the first performance is the same as the number of artists that can perform as acrobats in the second performance." 1800

1138A "Sushi for Two" "binary search,greedy,implementation" "Arkady invited Anna for a dinner to a sushi restaurant. The restaurant is a bit unusual: it offers n pieces of sushi aligned in a row, and a customer has to choose a continuous subsegment of these sushi to buy.The pieces of sushi are of two types: either with tuna or with eel. Let\'s denote the type of the i-th from the left sushi as ti, where ti=1 means it is with tuna, and ti=2 means it is with eel.Arkady does not like tuna, Anna does not like eel. Arkady wants to choose such a continuous subsegment of sushi that it has equal number of sushi of each type and each half of the subsegment has only sushi of one type. For example, subsegment [2,2,2,1,1,1] is valid, but subsegment [1,2,1,2,1,2] is not, because both halves contain both types of sushi.Find the length of the longest continuous subsegment of sushi Arkady can buy." 900

1137F "Matches Are Not a Child\'s Play" "data structures,trees" "Arkady invited Anna for a dinner to a sushi restaurant. The restaurant is a bit unusual: it offers n pieces of sushi aligned in a row, and a customer has to choose a continuous subsegment of these sushi to buy.The pieces of sushi are of two types: either with tuna or with eel. Let\'s denote the type of the i-th from the left sushi as ti, where ti=1 means it is with tuna, and ti=2 means it is with eel.Arkady does not like tuna, Anna does not like eel. Arkady wants to choose such a continuous subsegment of sushi that it has equal number of sushi of each type and each half of the subsegment has only sushi of one type. For example, subsegment [2,2,2,1,1,1] is valid, but subsegment [1,2,1,2,1,2] is not, because both halves contain both types of sushi.Find the length of the longest continuous subsegment of sushi Arkady can buy." 3400

1137E "Train Car Selection" "data structures,greedy" "Vasya likes to travel by train, but doesn\'t like when the car he travels in is located in the tail of the train.Vasya gets on the train at the station. The train consists of n cars indexed from 1 to n counting from the locomotive (head of the train). Three types of events occur while the train is moving:  Some number of cars are added to the head of the train;  Some number of cars are added to the tail of the train;  Vasya recalculates the values of the convenience of the cars (read more about it below). At each moment of time we will index the cars from the head of the train, starting from 1. Note that when adding new cars to the head of the train, the indexing of the old ones may shift.To choose which car to go in, Vasya will use the value Ai for each car (where i is a car index), which is calculated as follows:  At the beginning of the trip Ai=0, as well as for the new cars at the time of their addition.  During the next recalculation Vasya chooses some positive integers b and s and adds to all Ai value b+(i\xe2\x88\x921)\xe2\x8b\x85s. Vasya hasn\'t decided yet where he will get on the train and where will get off the train, so after each event of one of the three types he wants to know the least index of the car, such that its value Ai is minimal. Since there is a lot of cars, Vasya asked you to write a program that answers his question." 2700

1137D "Cooperative Game" "constructive algorithms,interactive,number theory" "This is an interactive problem.Misha likes to play cooperative games with incomplete information. Today he suggested ten his friends to play a cooperative game ""Lake"".Misha has already come up with a field for the upcoming game. The field for this game is a directed graph consisting of two parts. The first part is a road along the coast of the lake which is a cycle of cc vertices. The second part is a path from home to the lake which is a chain of tt vertices, and there is an edge from the last vertex of this chain to the vertex of the road along the coast which has the most beautiful view of the lake, also known as the finish vertex. Misha decided to keep the field secret, so nobody knows neither tt nor cc.  Note that each vertex of the field has exactly one outgoing edge and all the vertices except the home vertex and the finish vertex have exactly one ingoing edge. The home vertex has no incoming edges, the finish vertex has two incoming edges.At the beginning of the game pieces of all the ten players, indexed with consecutive integers from 00 to 99, are at the home vertex. After that on each turn some of the players can ask Misha to simultaneously move their pieces along the corresponding edges. Misha will not answer more than qq such queries. After each move Misha will tell players whose pieces are at the same vertices and whose pieces are at different vertices.The goal of the game is to move all the pieces to the finish vertex. Misha\'s friends have no idea how to win in such a game without knowledge of cc, tt and qq, but luckily they are your friends. Help them: coordinate their actions to win the game. Misha has drawn such a field that 1\xe2\x89\xa4t,c1\xe2\x89\xa4t,c, (t+c)\xe2\x89\xa41000(t+c)\xe2\x89\xa41000 and q=3\xe2\x8b\x85(t+c)q=3\xe2\x8b\x85(t+c)." 2400

1137C "Museums Tour" dp,graphs,implementation "In the country NN, there are nn cities connected by mm one-way roads. Although this country seems unremarkable, there are two interesting facts about it. At first, a week lasts dd days here. At second, there is exactly one museum in each city of the country NN.Travel agency ""Open museums"" is developing a new program for tourists interested in museums. Agency\'s employees know which days each of the museums is open. The tour should start in the capital�\xe2\x80\x94 the city number 11, and the first day of the tour must be on the first day of a week. Each day a tourist will be in some city, watching the exposition in its museum (in case museum is open today), and by the end of the day, the tour either ends or the tourist goes into another city connected by a road with the current one. The road system of NN is designed in such a way that traveling by a road always takes one night and also all the roads are one-way. It\'s allowed to visit a city multiple times during the trip.You should develop such route for the trip that the number of distinct museums, possible to visit during it, is maximum." 2500

1137B "Camp Schedule" greedy,hashing,strings "The new camp by widely-known over the country Spring Programming Camp is going to start soon. Hence, all the team of friendly curators and teachers started composing the camp\'s schedule. After some continuous discussion, they came up with a schedule s, which can be represented as a binary string, in which the i-th symbol is \'1\' if students will write the contest in the i-th day and \'0\' if they will have a day off.At the last moment Gleb said that the camp will be the most productive if it runs with the schedule t (which can be described in the same format as schedule s). Since the number of days in the current may be different from number of days in schedule t, Gleb required that the camp\'s schedule must be altered so that the number of occurrences of t in it as a substring is maximum possible. At the same time, the number of contest days and days off shouldn\'t change, only their order may change.Could you rearrange the schedule in the best possible way?" 1600

1137A Skyscrapers implementation,sortings "Dora loves adventures quite a lot. During some journey she encountered an amazing city, which is formed by nn streets along the Eastern direction and mm streets across the Southern direction. Naturally, this city has nmnm intersections. At any intersection of ii-th Eastern street and jj-th Southern street there is a monumental skyscraper. Dora instantly became curious and decided to explore the heights of the city buildings.When Dora passes through the intersection of the ii-th Eastern and jj-th Southern street she examines those two streets. After Dora learns the heights of all the skyscrapers on those two streets she wonders: how one should reassign heights to the skyscrapers on those two streets, so that the maximum height would be as small as possible and the result of comparing the heights of any two skyscrapers on one street wouldn\'t change.Formally, on every of nmnm intersections Dora solves an independent problem. She sees n+m\xe2\x88\x921n+m\xe2\x88\x921 skyscrapers and for each of them she knows its real height. Moreover, any two heights can be compared to get a result ""greater"", ""smaller"" or ""equal"". Now Dora wants to select some integer xx and assign every skyscraper a height from 11 to xx. When assigning heights, Dora wants to preserve the relative order of the skyscrapers in both streets. That is, the result of any comparison of heights of two skyscrapers in the current Eastern street shouldn\'t change and the result of any comparison of heights of two skyscrapers in current Southern street shouldn\'t change as well. Note that skyscrapers located on the Southern street are not compared with skyscrapers located on the Eastern street only. However, the skyscraper located at the streets intersection can be compared with both Southern and Eastern skyscrapers. For every intersection Dora wants to independently calculate the minimum possible xx.For example, if the intersection and the two streets corresponding to it look as follows:  Then it is optimal to replace the heights of the skyscrapers as follows (note that all comparisons ""less"", ""equal"", ""greater"" inside the Eastern street and inside the Southern street are preserved)  The largest used number is 55, hence the answer for this intersection would be 55.Help Dora to compute the answers for each intersection." 1600

1136E "Nastya Hasn\'t Written a Legend" "binary search,data structures" "Dora loves adventures quite a lot. During some journey she encountered an amazing city, which is formed by nn streets along the Eastern direction and mm streets across the Southern direction. Naturally, this city has nmnm intersections. At any intersection of ii-th Eastern street and jj-th Southern street there is a monumental skyscraper. Dora instantly became curious and decided to explore the heights of the city buildings.When Dora passes through the intersection of the ii-th Eastern and jj-th Southern street she examines those two streets. After Dora learns the heights of all the skyscrapers on those two streets she wonders: how one should reassign heights to the skyscrapers on those two streets, so that the maximum height would be as small as possible and the result of comparing the heights of any two skyscrapers on one street wouldn\'t change.Formally, on every of nmnm intersections Dora solves an independent problem. She sees n+m\xe2\x88\x921n+m\xe2\x88\x921 skyscrapers and for each of them she knows its real height. Moreover, any two heights can be compared to get a result ""greater"", ""smaller"" or ""equal"". Now Dora wants to select some integer xx and assign every skyscraper a height from 11 to xx. When assigning heights, Dora wants to preserve the relative order of the skyscrapers in both streets. That is, the result of any comparison of heights of two skyscrapers in the current Eastern street shouldn\'t change and the result of any comparison of heights of two skyscrapers in current Southern street shouldn\'t change as well. Note that skyscrapers located on the Southern street are not compared with skyscrapers located on the Eastern street only. However, the skyscraper located at the streets intersection can be compared with both Southern and Eastern skyscrapers. For every intersection Dora wants to independently calculate the minimum possible xx.For example, if the intersection and the two streets corresponding to it look as follows:  Then it is optimal to replace the heights of the skyscrapers as follows (note that all comparisons ""less"", ""equal"", ""greater"" inside the Eastern street and inside the Southern street are preserved)  The largest used number is 55, hence the answer for this intersection would be 55.Help Dora to compute the answers for each intersection." 2200

1136D "Nastya Is Buying Lunch" greedy "At the big break Nastya came to the school dining room. There are n pupils in the school, numbered from 1 to n. Unfortunately, Nastya came pretty late, so that all pupils had already stood in the queue, i.e. Nastya took the last place in the queue. Of course, it\'s a little bit sad for Nastya, but she is not going to despond because some pupils in the queue can agree to change places with some other pupils.Formally, there are some pairs u, v such that if the pupil with number u stands directly in front of the pupil with number v, Nastya can ask them and they will change places. Nastya asks you to find the maximal number of places in queue she can move forward." 1800

1136C "Nastya Is Transposing Matrices" "constructive algorithms,sortings" "Nastya came to her informatics lesson, and her teacher who is, by the way, a little bit famous here gave her the following task.Two matrices AA and BB are given, each of them has size n\xc3\x97mn\xc3\x97m. Nastya can perform the following operation to matrix AA unlimited number of times:   take any square square submatrix of AA and transpose it (i.e. the element of the submatrix which was in the ii-th row and jj-th column of the submatrix will be in the jj-th row and ii-th column after transposing, and the transposed submatrix itself will keep its place in the matrix AA). Nastya\'s task is to check whether it is possible to transform the matrix AA to the matrix BB.  Example of the operation As it may require a lot of operations, you are asked to answer this question for Nastya.A square submatrix of matrix MM is a matrix which consist of all elements which comes from one of the rows with indeces x,x+1,\xe2\x80\xa6,x+k\xe2\x88\x921x,x+1,\xe2\x80\xa6,x+k\xe2\x88\x921 of matrix MM and comes from one of the columns with indeces y,y+1,\xe2\x80\xa6,y+k\xe2\x88\x921y,y+1,\xe2\x80\xa6,y+k\xe2\x88\x921 of matrix MM. kk is the size of square submatrix. In other words, square submatrix is the set of elements of source matrix which form a solid square (i.e. without holes)." 1500

1136B "Nastya Is Playing Computer Games" "constructive algorithms,math" "Finished her homework, Nastya decided to play computer games. Passing levels one by one, Nastya eventually faced a problem. Her mission is to leave a room, where a lot of monsters live, as quickly as possible.There are nn manholes in the room which are situated on one line, but, unfortunately, all the manholes are closed, and there is one stone on every manhole. There is exactly one coin under every manhole, and to win the game Nastya should pick all the coins. Initially Nastya stands near the kk-th manhole from the left. She is thinking what to do.In one turn, Nastya can do one of the following:   if there is at least one stone on the manhole Nastya stands near, throw exactly one stone from it onto any other manhole (yes, Nastya is strong).  go to a neighboring manhole;  if there are no stones on the manhole Nastya stays near, she can open it and pick the coin from it. After it she must close the manhole immediately (it doesn\'t require additional moves).   The figure shows the intermediate state of the game. At the current position Nastya can throw the stone to any other manhole or move left or right to the neighboring manholes. If she were near the leftmost manhole, she could open it (since there are no stones on it). Nastya can leave the room when she picks all the coins. Monsters are everywhere, so you need to compute the minimum number of moves Nastya has to make to pick all the coins.Note one time more that Nastya can open a manhole only when there are no stones onto it." 1000

1136A "Nastya Is Reading a Book" implementation "After lessons Nastya decided to read a book. The book contains n chapters, going one after another, so that one page of the book belongs to exactly one chapter and each chapter contains at least one page.Yesterday evening Nastya did not manage to finish reading the book, so she marked the page with number k as the first page which was not read (i.e. she read all pages from the 1-st to the (k\xe2\x88\x921)-th).The next day Nastya\'s friend Igor came and asked her, how many chapters remain to be read by Nastya? Nastya is too busy now, so she asks you to compute the number of chapters she has not completely read yet (i.e. the number of chapters she has not started to read or has finished reading somewhere in the middle)." 800

1133F2 "Spanning Tree with One Fixed Degree" "constructive algorithms,dfs and similar,dsu,graphs,greedy" "You are given an undirected unweighted connected graph consisting of nn vertices and mm edges. It is guaranteed that there are no self-loops or multiple edges in the given graph.Your task is to find any spanning tree of this graph such that the degree of the first vertex (vertex with label 11 on it) is equal to DD (or say that there are no such spanning trees). Recall that the degree of a vertex is the number of edges incident to it." 1900

1133F1 "Spanning Tree with Maximum Degree" graphs "You are given an undirected unweighted connected graph consisting of nn vertices and mm edges. It is guaranteed that there are no self-loops or multiple edges in the given graph.Your task is to find any spanning tree of this graph such that the maximum degree over all vertices is maximum possible. Recall that the degree of a vertex is the number of edges incident to it." 1600

1133E "K Balanced Teams" "dp,sortings,two pointers" "You are a coach at your local university. There are n students under your supervision, the programming skill of the i-th student is ai.You have to form k teams for yet another new programming competition. As you know, the more students are involved in competition the more probable the victory of your university is! So you have to form no more than k (and at least one) non-empty teams so that the total number of students in them is maximized. But you also know that each team should be balanced. It means that the programming skill of each pair of students in each team should differ by no more than 5. Teams are independent from one another (it means that the difference between programming skills of two students from two different teams does not matter).It is possible that some students not be included in any team at all.Your task is to report the maximum possible total number of students in no more than k (and at least one) non-empty balanced teams.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 1800

1133D "Zero Quantity Maximization" "hashing,math,number theory" "You are given two arrays a and b, each contains n integers.You want to create a new array c as follows: choose some real (i.e. not necessarily integer) number d, and then for every i\xe2\x88\x88[1,n] let ci:=d\xe2\x8b\x85ai+bi.Your goal is to maximize the number of zeroes in array c. What is the largest possible answer, if you choose d optimally?" 1500

1133C "Balanced Team" "sortings,two pointers" "You are a coach at your local university. There are n students under your supervision, the programming skill of the i-th student is ai.You have to create a team for a new programming competition. As you know, the more students some team has the more probable its victory is! So you have to create a team with the maximum number of students. But you also know that a team should be balanced. It means that the programming skill of each pair of students in a created team should differ by no more than 5.Your task is to report the maximum possible number of students in a balanced team." 1200

1133B "Preparation for International Women\'s Day" "math,number theory" "You are a coach at your local university. There are n students under your supervision, the programming skill of the i-th student is ai.You have to create a team for a new programming competition. As you know, the more students some team has the more probable its victory is! So you have to create a team with the maximum number of students. But you also know that a team should be balanced. It means that the programming skill of each pair of students in a created team should differ by no more than 5.Your task is to report the maximum possible number of students in a balanced team." 1200

1133A "Middle of the Contest" implementation "Polycarp is going to participate in the contest. It starts at h1:m1 and ends at h2:m2. It is guaranteed that the contest lasts an even number of minutes (i.e. m1%2=m2%2, where x%y is x modulo y). It is also guaranteed that the entire contest is held during a single day. And finally it is guaranteed that the contest lasts at least two minutes.Polycarp wants to know the time of the midpoint of the contest. For example, if the contest lasts from 10:00 to 11:00 then the answer is 10:30, if the contest lasts from 11:10 to 11:12 then the answer is 11:11." 1000

1132G "Greedy Subsequences" "data structures,dp,trees" "For some array c, let\'s denote a greedy subsequence as a sequence of indices p1, p2, ..., pl such that 1\xe2\x89\xa4p1<p2<\xe2\x8b\xaf<pl\xe2\x89\xa4|c|, and for each i\xe2\x88\x88[1,l\xe2\x88\x921], pi+1 is the minimum number such that pi+1>pi and c[pi+1]>c[pi].You are given an array a1,a2,\xe2\x80\xa6,an. For each its subsegment of length k, calculate the length of its longest greedy subsequence." 2400

1132F "Clear the String" dp "You are given a string s of length n consisting of lowercase Latin letters. You may apply some operations to this string: in one operation you can delete some contiguous substring of this string, if all letters in the substring you delete are equal. For example, after deleting substring bbbb from string abbbbaccdd we get the string aaccdd.Calculate the minimum number of operations to delete the whole string s." 2000

1132E Knapsack "dfs and similar,dp,greedy" "You have a set of items, each having some integer weight not greater than 8. You denote that a subset of items is good if total weight of items in the subset does not exceed W.You want to calculate the maximum possible weight of a good subset of items. Note that you have to consider the empty set and the original set when calculating the answer." 2300

1132D "Stressful Training" "binary search,greedy" "Berland SU holds yet another training contest for its students today. n students came, each of them brought his laptop. However, it turned out that everyone has forgot their chargers!Let students be numbered from 1 to n. Laptop of the i-th student has charge ai at the beginning of the contest and it uses bi of charge per minute (i.e. if the laptop has c charge at the beginning of some minute, it becomes c\xe2\x88\x92bi charge at the beginning of the next minute). The whole contest lasts for k minutes.Polycarp (the coach of Berland SU) decided to buy a single charger so that all the students would be able to successfully finish the contest. He buys the charger at the same moment the contest starts.Polycarp can choose to buy the charger with any non-negative (zero or positive) integer power output. The power output is chosen before the purchase, it can\'t be changed afterwards. Let the chosen power output be x. At the beginning of each minute (from the minute contest starts to the last minute of the contest) he can plug the charger into any of the student\'s laptops and use it for some integer number of minutes. If the laptop is using bi charge per minute then it will become bi\xe2\x88\x92x per minute while the charger is plugged in. Negative power usage rate means that the laptop\'s charge is increasing. The charge of any laptop isn\'t limited, it can become infinitely large. The charger can be plugged in no more than one laptop at the same time.The student successfully finishes the contest if the charge of his laptop never is below zero at the beginning of some minute (from the minute contest starts to the last minute of the contest, zero charge is allowed). The charge of the laptop of the minute the contest ends doesn\'t matter.Help Polycarp to determine the minimal possible power output the charger should have so that all the students are able to successfully finish the contest. Also report if no such charger exists." 2300

1132C "Painting the Fence" "brute force" "You have a long fence which consists of n sections. Unfortunately, it is not painted, so you decided to hire q painters to paint it. i-th painter will paint all sections x such that li\xe2\x89\xa4x\xe2\x89\xa4ri.Unfortunately, you are on a tight budget, so you may hire only q\xe2\x88\x922 painters. Obviously, only painters you hire will do their work.You want to maximize the number of painted sections if you choose q\xe2\x88\x922 painters optimally. A section is considered painted if at least one painter paints it." 1700

1132B Discounts greedy,sortings "You came to a local shop and want to buy some chocolate bars. There are n bars in the shop, i-th of them costs ai coins (and you want to buy all of them).You have m different coupons that allow you to buy chocolate bars. i-th coupon allows you to buy qi chocolate bars while you have to pay only for the qi\xe2\x88\x921 most expensive ones (so, the cheapest bar of those qi bars is for free).You can use only one coupon; if you use coupon i, you have to choose qi bars and buy them using the coupon, and buy all the remaining n\xe2\x88\x92qi bars without any discounts.To decide which coupon to choose, you want to know what will be the minimum total amount of money you have to pay if you use one of the coupons optimally." 900

1132A "Regular Bracket Sequence" greedy,implementation "A string is called bracket sequence if it does not contain any characters other than ""("" and "")"". A bracket sequence is called regular if it it is possible to obtain correct arithmetic expression by inserting characters ""+"" and ""1"" into this sequence. For example, """", ""(())"" and ""()()"" are regular bracket sequences; ""))"" and "")(("" are bracket sequences (but not regular ones), and ""(a)"" and ""(1)+(1)"" are not bracket sequences at all.You have a number of strings; each string is a bracket sequence of length 2. So, overall you have cnt1 strings ""(("", cnt2 strings ""()"", cnt3 strings "")("" and cnt4 strings ""))"". You want to write all these strings in some order, one after another; after that, you will get a long bracket sequence of length 2(cnt1+cnt2+cnt3+cnt4). You wonder: is it possible to choose some order of the strings you have such that you will get a regular bracket sequence? Note that you may not remove any characters or strings, and you may not add anything either." 1100

1131G "Most Dangerous Shark" "data structures,dp,two pointers" "Semyon participates in the most prestigious competition of the world ocean for the title of the most dangerous shark. During this competition sharks compete in different subjects: speed swimming, masking, map navigation and many others. Now Semyon is taking part in \xc2\xabdestruction\xc2\xbb contest.During it, m dominoes are placed in front of the shark. All dominoes are on the same line, but the height of the dominoes may vary. The distance between adjacent dominoes is 1. Moreover, each Domino has its own cost value, expressed as an integer. The goal is to drop all the dominoes. To do this, the shark can push any domino to the left or to the right, and it will begin falling in this direction. If during the fall the domino touches other dominoes, they will also start falling in the same direction in which the original domino is falling, thus beginning a chain reaction, as a result of which many dominoes can fall. A falling domino touches another one, if and only if the distance between them was strictly less than the height of the falling domino, the dominoes do not necessarily have to be adjacent.Of course, any shark can easily drop all the dominoes in this way, so the goal is not to drop all the dominoes, but do it with a minimum cost. The cost of the destruction is the sum of the costs of dominoes that the shark needs to push to make all the dominoes fall.Simon has already won in the previous subjects, but is not smart enough to win in this one. Help Semyon and determine the minimum total cost of the dominoes he will have to push to make all the dominoes fall." 2700

1131F "Asya And Kittens" "constructive algorithms,dsu" "Asya loves animals very much. Recently, she purchased nn kittens, enumerated them from 11 and nn and then put them into the cage. The cage consists of one row of nn cells, enumerated with integers from 11 to nn from left to right. Adjacent cells had a partially transparent partition wall between them, hence there were n\xe2\x88\x921n\xe2\x88\x921 partitions originally. Initially, each cell contained exactly one kitten with some number.Observing the kittens, Asya noticed, that they are very friendly and often a pair of kittens in neighboring cells wants to play together. So Asya started to remove partitions between neighboring cells. In particular, on the day ii, Asya:  Noticed, that the kittens xixi and yiyi, located in neighboring cells want to play together.  Removed the partition between these two cells, efficiently creating a single cell, having all kittens from two original cells. Since Asya has never putted partitions back, after n\xe2\x88\x921n\xe2\x88\x921 days the cage contained a single cell, having all kittens.For every day, Asya remembers numbers of kittens xixi and yiyi, who wanted to play together, however she doesn\'t remember how she placed kittens in the cage in the beginning. Please help her and find any possible initial arrangement of the kittens into nn cells." 1700

1131E "String Multiplication" dp,greedy,strings "Roman and Denis are on the trip to the programming competition. Since the trip was long, they soon got bored, and hence decided to came up with something. Roman invented a pizza\'s recipe, while Denis invented a string multiplication. According to Denis, the result of multiplication (product) of strings s of length m and t is a string t+s1+t+s2+\xe2\x80\xa6+t+sm+t, where si denotes the i-th symbol of the string s, and ""+"" denotes string concatenation. For example, the product of strings ""abc"" and ""de"" is a string ""deadebdecde"", while the product of the strings ""ab"" and ""z"" is a string ""zazbz"". Note, that unlike the numbers multiplication, the product of strings s and t is not necessarily equal to product of t and s.Roman was jealous of Denis, since he invented such a cool operation, and hence decided to invent something string-related too. Since Roman is beauty-lover, he decided to define the beauty of the string as the length of the longest substring, consisting of only one letter. For example, the beauty of the string ""xayyaaabca"" is equal to 3, since there is a substring ""aaa"", while the beauty of the string ""qwerqwer"" is equal to 1, since all neighboring symbols in it are different.In order to entertain Roman, Denis wrote down n strings p1,p2,p3,\xe2\x80\xa6,pn on the paper and asked him to calculate the beauty of the string (\xe2\x80\xa6(((p1\xe2\x8b\x85p2)\xe2\x8b\x85p3)\xe2\x8b\x85\xe2\x80\xa6)\xe2\x8b\x85pn, where s\xe2\x8b\x85t denotes a multiplication of strings s and t. Roman hasn\'t fully realized how Denis\'s multiplication works, so he asked you for a help. Denis knows, that Roman is very impressionable, he guarantees, that the beauty of the resulting string is at most 109." 2300

1131D "Gourmet choice" "dfs and similar,dp,dsu,graphs,greedy" "Mr. Apple, a gourmet, works as editor-in-chief of a gastronomic periodical. He travels around the world, tasting new delights of famous chefs from the most fashionable restaurants. Mr. Apple has his own signature method of review �\xe2\x80\x94 in each restaurant Mr. Apple orders two sets of dishes on two different days. All the dishes are different, because Mr. Apple doesn\'t like to eat the same food. For each pair of dishes from different days he remembers exactly which was better, or that they were of the same quality. After this the gourmet evaluates each dish with a positive integer.Once, during a revision of a restaurant of Celtic medieval cuisine named \xc2\xabPoisson\xc2\xbb, that serves chestnut soup with fir, warm soda bread, spicy lemon pie and other folk food, Mr. Apple was very pleasantly surprised the gourmet with its variety of menu, and hence ordered too much. Now he\'s confused about evaluating dishes.The gourmet tasted a set of n dishes on the first day and a set of m dishes on the second day. He made a table a of size n\xc3\x97m, in which he described his impressions. If, according to the expert, dish i from the first set was better than dish j from the second set, then aij is equal to "">"", in the opposite case aij is equal to ""<"". Dishes also may be equally good, in this case aij is ""="".Now Mr. Apple wants you to help him to evaluate every dish. Since Mr. Apple is very strict, he will evaluate the dishes so that the maximal number used is as small as possible. But Mr. Apple also is very fair, so he never evaluates the dishes so that it goes against his feelings. In other words, if aij is ""<"", then the number assigned to dish i from the first set should be less than the number of dish j from the second set, if aij is "">"", then it should be greater, and finally if aij is ""="", then the numbers should be the same.Help Mr. Apple to evaluate each dish from both sets so that it is consistent with his feelings, or determine that this is impossible." 2000

1131C Birthday "binary search,greedy,sortings" "Cowboy Vlad has a birthday today! There are n children who came to the celebration. In order to greet Vlad, the children decided to form a circle around him. Among the children who came, there are both tall and low, so if they stand in a circle arbitrarily, it may turn out, that there is a tall and low child standing next to each other, and it will be difficult for them to hold hands. Therefore, children want to stand in a circle so that the maximum difference between the growth of two neighboring children would be minimal possible.Formally, let\'s number children from 1 to n in a circle order, that is, for every i child with number i will stand next to the child with number i+1, also the child with number 1 stands next to the child with number n. Then we will call the discomfort of the circle the maximum absolute difference of heights of the children, who stand next to each other.Please help children to find out how they should reorder themselves, so that the resulting discomfort is smallest possible." 1200

1131B Draw! greedy,implementation "You still have partial information about the score during the historic football match. You are given a set of pairs (ai,bi), indicating that at some point during the match the score was ""ai: bi"". It is known that if the current score is \xc2\xabx:y\xc2\xbb, then after the goal it will change to ""x+1:y"" or ""x:y+1"". What is the largest number of times a draw could appear on the scoreboard?The pairs ""ai:bi"" are given in chronological order (time increases), but you are given score only for some moments of time. The last pair corresponds to the end of the match." 1400

1131A "Sea Battle" math "In order to make the ""Sea Battle"" game more interesting, Boris decided to add a new ship type to it. The ship consists of two rectangles. The first rectangle has a width of w1 and a height of h1, while the second rectangle has a width of w2 and a height of h2, where w1\xe2\x89\xa5w2. In this game, exactly one ship is used, made up of two rectangles. There are no other ships on the field.The rectangles are placed on field in the following way:  the second rectangle is on top the first rectangle;  they are aligned to the left, i.e. their left sides are on the same line;  the rectangles are adjacent to each other without a gap. See the pictures in the notes: the first rectangle is colored red, the second rectangle is colored blue.Formally, let\'s introduce a coordinate system. Then, the leftmost bottom cell of the first rectangle has coordinates (1,1), the rightmost top cell of the first rectangle has coordinates (w1,h1), the leftmost bottom cell of the second rectangle has coordinates (1,h1+1) and the rightmost top cell of the second rectangle has coordinates (w2,h1+h2).After the ship is completely destroyed, all cells neighboring by side or a corner with the ship are marked. Of course, only cells, which don\'t belong to the ship are marked. On the pictures in the notes such cells are colored green.Find out how many cells should be marked after the ship is destroyed. The field of the game is infinite in any direction." 800

1130C Connect "brute force,dfs and similar,dsu" "Alice lives on a flat planet that can be modeled as a square grid of size n\xc3\x97nn\xc3\x97n, with rows and columns enumerated from 11 to nn. We represent the cell at the intersection of row rr and column cc with ordered pair (r,c)(r,c). Each cell in the grid is either land or water.  An example planet with n=5n=5. It also appears in the first sample test. Alice resides in land cell (r1,c1)(r1,c1). She wishes to travel to land cell (r2,c2)(r2,c2). At any moment, she may move to one of the cells adjacent to where she is\xe2\x80\x94in one of the four directions (i.e., up, down, left, or right).Unfortunately, Alice cannot swim, and there is no viable transportation means other than by foot (i.e., she can walk only on land). As a result, Alice\'s trip may be impossible.To help Alice, you plan to create at most one tunnel between some two land cells. The tunnel will allow Alice to freely travel between the two endpoints. Indeed, creating a tunnel is a lot of effort: the cost of creating a tunnel between cells (rs,cs)(rs,cs) and (rt,ct)(rt,ct) is (rs\xe2\x88\x92rt)2+(cs\xe2\x88\x92ct)2(rs\xe2\x88\x92rt)2+(cs\xe2\x88\x92ct)2.For now, your task is to find the minimum possible cost of creating at most one tunnel so that Alice could travel from (r1,c1)(r1,c1) to (r2,c2)(r2,c2). If no tunnel needs to be created, the cost is 00." 1400

1130B "Two Cakes" greedy "Sasha and Dima want to buy two n-tier cakes. Each cake should consist of n different tiers: from the size of 1 to the size of n. Tiers should go in order from the smallest to the biggest (from top to bottom).They live on the same street, there are 2\xe2\x8b\x85n houses in a row from left to right. Each house has a pastry shop where you can buy a cake tier. Unfortunately, in each pastry shop you can buy only one tier of only one specific size: in the i-th house you can buy a tier of the size ai (1\xe2\x89\xa4ai\xe2\x89\xa4n).Since the guys carry already purchased tiers, and it is impossible to insert a new tier in the middle of the cake, they agreed to buy tiers from the smallest to the biggest. That is, each of them buys tiers in order: 1, then 2, then 3 and so on up to n.Initially, Sasha and Dima are located near the first (leftmost) house. Output the minimum distance that they will have to walk in total to buy both cakes. The distance between any two neighboring houses is exactly 1." 1200

1130A "Be Positive" implementation "You are given an array of n integers: a1,a2,\xe2\x80\xa6,an. Your task is to find some non-zero integer d (\xe2\x88\x92103\xe2\x89\xa4d\xe2\x89\xa4103) such that, after each number in the array is divided by d, the number of positive numbers that are presented in the array is greater than or equal to half of the array size (i.e., at least \xe2\x8c\x88n2\xe2\x8c\x89). Note that those positive numbers do not need to be an integer (e.g., a 2.5 counts as a positive number). If there are multiple values of d that satisfy the condition, you may print any of them. In case that there is no such d, print a single integer 0.Recall that \xe2\x8c\x88x\xe2\x8c\x89 represents the smallest integer that is not less than x and that zero (0) is neither positive nor negative." 800

1129E "Legendary Tree" "binary search,interactive,trees" "This is an interactive problem.A legendary tree rests deep in the forest. Legend has it that individuals who realize this tree would eternally become a Legendary Grandmaster.To help you determine the tree, Mikaela the Goddess has revealed to you that the tree contains nn vertices, enumerated from 11 through nn. She also allows you to ask her some questions as follows. For each question, you should tell Mikaela some two disjoint non-empty sets of vertices SS and TT, along with any vertex vv that you like. Then, Mikaela will count and give you the number of pairs of vertices (s,t)(s,t) where s\xe2\x88\x88Ss\xe2\x88\x88S and t\xe2\x88\x88Tt\xe2\x88\x88T such that the simple path from ss to tt contains vv.Mikaela the Goddess is busy and will be available to answer at most 1111111111 questions.This is your only chance. Your task is to determine the tree and report its edges." 3100

1129D Isolation "data structures,dp" "Find the number of ways to divide an array a of n integers into any number of disjoint non-empty segments so that, in each segment, there exist at most k distinct integers that appear exactly once.Since the answer can be large, find it modulo 998244353." 2900

1129C "Morse Code" "binary search,data structures,dp,hashing,sortings,string suffix structures,strings" "In Morse code, an letter of English alphabet is represented as a string of some length from 1 to 4. Moreover, each Morse code representation of an English letter contains only dots and dashes. In this task, we will represent a dot with a ""0"" and a dash with a ""1"".Because there are 21+22+23+24=30 strings with length 1 to 4 containing only ""0"" and/or ""1"", not all of them correspond to one of the 26 English letters. In particular, each string of ""0"" and/or ""1"" of length at most 4 translates into a distinct English letter, except the following four strings that do not correspond to any English alphabet: ""0011"", ""0101"", ""1110"", and ""1111"".You will work with a string S, which is initially empty. For m times, either a dot or a dash will be appended to S, one at a time. Your task is to find and report, after each of these modifications to string S, the number of non-empty sequences of English letters that are represented with some substring of S in Morse code.Since the answers can be incredibly tremendous, print them modulo 109+7." 2400

1129B "Wrong Answer" "constructive algorithms" "Consider the following problem: given an array a containing n integers (indexed from 0 to n\xe2\x88\x921), find max0\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n\xe2\x88\x921\xe2\x88\x91l\xe2\x89\xa4i\xe2\x89\xa4r(r\xe2\x88\x92l+1)\xe2\x8b\x85ai. In this problem, 1\xe2\x89\xa4n\xe2\x89\xa42000 and |ai|\xe2\x89\xa4106.In an attempt to solve the problem described, Alice quickly came up with a blazing-fast greedy algorithm and coded it. Her implementation in pseudocode is as follows:function find_answer(n, a)    # Assumes n is an integer between 1 and 2000, inclusive    # Assumes a is a list containing n integers: a[0], a[1], ..., a[n-1]    res = 0    cur = 0    k = -1    for i = 0 to i = n-1        cur = cur + a[i]        if cur < 0            cur = 0            k = i        res = max(res, (i-k)*cur)    return resAlso, as you can see, Alice\'s idea is not entirely correct. For example, suppose n=4 and a=[6,\xe2\x88\x928,7,\xe2\x88\x9242]. Then, find_answer(n, a) would return 7, but the correct answer is 3\xe2\x8b\x85(6\xe2\x88\x928+7)=15.You told Alice that her solution is incorrect, but she did not believe what you said.Given an integer k, you are to find any sequence a of n integers such that the correct answer and the answer produced by Alice\'s algorithm differ by exactly k. Note that although the choice of n and the content of the sequence is yours, you must still follow the constraints earlier given: that 1\xe2\x89\xa4n\xe2\x89\xa42000 and that the absolute value of each element does not exceed 106. If there is no such sequence, determine so." 2000

1129A2 "Toy Train" "brute force,greedy" "Alice received a set of Toy Train\xe2\x84\xa2 from Bob. It consists of one train and a connected railway network of nn stations, enumerated from 11 through nn. The train occupies one station at a time and travels around the network of stations in a circular manner. More precisely, the immediate station that the train will visit after station ii is station i+1i+1 if 1\xe2\x89\xa4i<n1\xe2\x89\xa4i<n or station 11 if i=ni=n. It takes the train 11 second to travel to its next station as described.Bob gave Alice a fun task before he left: to deliver mm candies that are initially at some stations to their independent destinations using the train. The candies are enumerated from 11 through mm. Candy ii (1\xe2\x89\xa4i\xe2\x89\xa4m1\xe2\x89\xa4i\xe2\x89\xa4m), now at station aiai, should be delivered to station bibi (ai\xe2\x89\xa0biai\xe2\x89\xa0bi).  The blue numbers on the candies correspond to bibi values. The image corresponds to the 11-st example. The train has infinite capacity, and it is possible to load off any number of candies at a station. However, only at most one candy can be loaded from a station onto the train before it leaves the station. You can choose any candy at this station. The time it takes to move the candies is negligible.Now, Alice wonders how much time is needed for the train to deliver all candies. Your task is to find, for each station, the minimum time the train would need to deliver all the candies were it to start from there." 1800

1129A1 "Toy Train (Simplified)" "brute force,greedy" "This is a simplified version of the task Toy Train. These two versions differ only in the constraints. Hacks for this version are disabled.Alice received a set of Toy Train\xe2\x84\xa2 from Bob. It consists of one train and a connected railway network of n stations, enumerated from 1 through n. The train occupies one station at a time and travels around the network of stations in a circular manner. More precisely, the immediate station that the train will visit after station i is station i+1 if 1\xe2\x89\xa4i<n or station 1 if i=n. It takes the train 1 second to travel to its next station as described.Bob gave Alice a fun task before he left: to deliver m candies that are initially at some stations to their independent destinations using the train. The candies are enumerated from 1 through m. Candy i (1\xe2\x89\xa4i\xe2\x89\xa4m), now at station ai, should be delivered to station bi (ai\xe2\x89\xa0bi).  The blue numbers on the candies correspond to bi values. The image corresponds to the 1-st example. The train has infinite capacity, and it is possible to load off any number of candies at a station. However, only at most one candy can be loaded from a station onto the train before it leaves the station. You can choose any candy at this station. The time it takes to move the candies is negligible.Now, Alice wonders how much time is needed for the train to deliver all candies. Your task is to find, for each station, the minimum time the train would need to deliver all the candies were it to start from there." 1700

1121C "System Testing" implementation "Vasya likes taking part in Codeforces contests. When a round is over, Vasya follows all submissions in the system testing tab.There are n solutions, the i-th of them should be tested on ai tests, testing one solution on one test takes 1 second. The solutions are judged in the order from 1 to n. There are k testing processes which test solutions simultaneously. Each of them can test at most one solution at a time.At any time moment t when some testing process is not judging any solution, it takes the first solution from the queue and tests it on each test in increasing order of the test ids. Let this solution have id i, then it is being tested on the first test from time moment t till time moment t+1, then on the second test till time moment t+2 and so on. This solution is fully tested at time moment t+ai, and after that the testing process immediately starts testing another solution.Consider some time moment, let there be exactly m fully tested solutions by this moment. There is a caption ""System testing: d%"" on the page with solutions, where d is calculated asd=round(100\xe2\x8b\x85mn),where round(x)=\xe2\x8c\x8ax+0.5\xe2\x8c\x8b is a function which maps every real to the nearest integer.Vasya calls a submission interesting if there is a time moment (possibly, non-integer) when the solution is being tested on some test q, and the caption says ""System testing: q%"". Find the number of interesting solutions.Please note that in case when multiple processes attempt to take the first submission from the queue at the same moment (for instance, at the initial moment), the order they take the solutions does not matter." 1600

1121B "Mike and Children" "brute force,implementation" "Mike decided to teach programming to children in an elementary school. He knows that it is not an easy task to interest children in that age to code. That is why he decided to give each child two sweets.Mike has n sweets with sizes a1,a2,\xe2\x80\xa6,an. All his sweets have different sizes. That is, there is no such pair (i,j) (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that i\xe2\x89\xa0j and ai=aj.Since Mike has taught for many years, he knows that if he gives two sweets with sizes ai and aj to one child and ak and ap to another, where (ai+aj)\xe2\x89\xa0(ak+ap), then a child who has a smaller sum of sizes will be upset. That is, if there are two children who have different sums of sweets, then one of them will be upset. Apparently, Mike does not want somebody to be upset. Mike wants to invite children giving each of them two sweets. Obviously, he can\'t give one sweet to two or more children. His goal is to invite as many children as he can. Since Mike is busy preparing to his first lecture in the elementary school, he is asking you to find the maximum number of children he can invite giving each of them two sweets in such way that nobody will be upset." 1200

1121A "Technogoblet of Fire" implementation,sortings "Everybody knows that the m-coder Tournament will happen soon. m schools participate in the tournament, and only one student from each school participates.There are a total of n students in those schools. Before the tournament, all students put their names and the names of their schools into the Technogoblet of Fire. After that, Technogoblet selects the strongest student from each school to participate. Arkady is a hacker who wants to have k Chosen Ones selected by the Technogoblet. Unfortunately, not all of them are the strongest in their schools, but Arkady can make up some new school names and replace some names from Technogoblet with those. You can\'t use each made-up name more than once. In that case, Technogoblet would select the strongest student in those made-up schools too.You know the power of each student and schools they study in. Calculate the minimal number of schools Arkady has to make up so that k Chosen Ones would be selected by the Technogoblet." 1100

1120F "Secret Letters" "data structures,dp,greedy" "Little W and Little P decided to send letters to each other regarding the most important events during a day. There are n events during a day: at time moment ti something happens to the person pi (pi is either W or P, denoting Little W and Little P, respectively), so he needs to immediately send a letter to the other person. They can send a letter using one of the two ways:  Ask Friendly O to deliver the letter directly. Friendly O takes d acorns for each letter. Leave the letter at Wise R\'s den. Wise R values free space, so he takes c\xe2\x8b\x85T acorns for storing a letter for a time segment of length T. The recipient can take a letter from Wise R either when he leaves his own letter at Wise R\'s den, or at time moment tn+1, when everybody comes to Wise R for a tea. It is not possible to take a letter from Wise R\'s den at other time moments. The friends can store as many letters at Wise R\'s den as they want, paying for each one separately. Help the friends determine the minimum possible total cost of sending all letters." 3100

1120E "The very same Munchhausen" "brute force" "A positive integer a is given. Baron Munchausen claims that he knows such a positive integer n that if one multiplies n by a, the sum of its digits decreases a times. In other words, S(an)=S(n)/a, where S(x) denotes the sum of digits of the number x. Find out if what Baron told can be true." 2600

1120D "Power Tree" "dfs and similar,dp,dsu,graphs,greedy,trees" "You are given a rooted tree with n vertices, the root of the tree is the vertex 1. Each vertex has some non-negative price. A leaf of the tree is a non-root vertex that has degree 1.Arkady and Vasily play a strange game on the tree. The game consists of three stages. On the first stage Arkady buys some non-empty set of vertices of the tree. On the second stage Vasily puts some integers into all leaves of the tree. On the third stage Arkady can perform several (possibly none) operations of the following kind: choose some vertex v he bought on the first stage and some integer x, and then add x to all integers in the leaves in the subtree of v. The integer x can be positive, negative of zero.A leaf a is in the subtree of a vertex b if and only if the simple path between a and the root goes through b.Arkady\'s task is to make all integers in the leaves equal to zero. What is the minimum total cost s he has to pay on the first stage to guarantee his own win independently of the integers Vasily puts on the second stage? Also, we ask you to find all such vertices that there is an optimal (i.e. with cost s) set of vertices containing this one such that Arkady can guarantee his own win buying this set on the first stage." 2500

1120C "Compress String" dp,strings "Suppose you are given a string s of length n consisting of lowercase English letters. You need to compress it using the smallest possible number of coins.To compress the string, you have to represent s as a concatenation of several non-empty strings: s=t1t2\xe2\x80\xa6tk. The i-th of these strings should be encoded with one of the two ways:  if |ti|=1, meaning that the current string consists of a single character, you can encode it paying a coins;  if ti is a substring of t1t2\xe2\x80\xa6ti\xe2\x88\x921, then you can encode it paying b coins. A string x is a substring of a string y if x can be obtained from y by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.So your task is to calculate the minimum possible number of coins you need to spend in order to compress the given string s." 2100

1120B "Once in a casino" "constructive algorithms,greedy,implementation,math" "One player came to a casino and found a slot machine where everything depends only on how he plays. The rules follow.A positive integer a is initially on the screen. The player can put a coin into the machine and then add 1 to or subtract 1 from any two adjacent digits. All digits must remain from 0 to 9 after this operation, and the leading digit must not equal zero. In other words, it is forbidden to add 1 to 9, to subtract 1 from 0 and to subtract 1 from the leading 1. Once the number on the screen becomes equal to b, the player wins the jackpot. a and b have the same number of digits.Help the player to determine the minimal number of coins he needs to spend in order to win the jackpot and tell how to play." 2700

1120A "Diana and Liana" "greedy,implementation,two pointers" "At the first holiday in spring, the town Shortriver traditionally conducts a flower festival. Townsfolk wear traditional wreaths during these festivals. Each wreath contains exactly k flowers.The work material for the wreaths for all n citizens of Shortriver is cut from the longest flowered liana that grew in the town that year. Liana is a sequence a1, a2, ..., am, where ai is an integer that denotes the type of flower at the position i. This year the liana is very long (m\xe2\x89\xa5n\xe2\x8b\x85k), and that means every citizen will get a wreath.Very soon the liana will be inserted into a special cutting machine in order to make work material for wreaths. The machine works in a simple manner: it cuts k flowers from the beginning of the liana, then another k flowers and so on. Each such piece of k flowers is called a workpiece. The machine works until there are less than k flowers on the liana.Diana has found a weaving schematic for the most beautiful wreath imaginable. In order to weave it, k flowers must contain flowers of types b1, b2, ..., bs, while other can be of any type. If a type appears in this sequence several times, there should be at least that many flowers of that type as the number of occurrences of this flower in the sequence. The order of the flowers in a workpiece does not matter.Diana has a chance to remove some flowers from the liana before it is inserted into the cutting machine. She can remove flowers from any part of the liana without breaking liana into pieces. If Diana removes too many flowers, it may happen so that some of the citizens do not get a wreath. Could some flowers be removed from the liana so that at least one workpiece would conform to the schematic and machine would still be able to create at least n workpieces?" 1900

1119H Triple fft,math "You have received your birthday gifts \xe2\x80\x94 n triples of integers! The i-th of them is {ai,bi,ci}. All numbers are greater than or equal to 0, and strictly smaller than 2k, where k is a fixed integer.One day, you felt tired playing with triples. So you came up with three new integers x, y, z, and then formed n arrays. The i-th array consists of ai repeated x times, bi repeated y times and ci repeated z times. Thus, each array has length (x+y+z).You want to choose exactly one integer from each array such that the XOR (bitwise exclusive or) of them is equal to t. Output the number of ways to choose the numbers for each t between 0 and 2k\xe2\x88\x921, inclusive, modulo 998244353." 3200

1119G "Get Ready for the Battle" "constructive algorithms,implementation" "Recently Evlampy installed one interesting computer game, one of aspects of which is to split army into several groups and then fight with enemy\'s groups. Let us consider a simplified version of the battle.In the nearest battle Evlampy should fight an enemy army that consists of mm groups, the ii-th of which has hpihpi health points.Evlampy\'s army consists of nn equal soldiers. Before each battle he should split his army in exactly mm groups (possibly, empty) so that the total size of the groups is nn. The battle is played step-by-step. On each step each of Evlampy\'s groups attacks exactly one enemy group. Thus, each step is described with an array of mm integers a1,a2,\xe2\x80\xa6,ama1,a2,\xe2\x80\xa6,am, meaning that the ii-th Evlampy\'s group attacks the aiai-th enemy group. Different groups can attack same group, on each step the array aa is chosen independently.After each step the health points of each enemy group decreases by the total number of soldiers in Evlampy\'s groups that attacked this enemy group at this step. Enemy group is destroyed once its health points are zero or negative. Evlampy\'s soldiers do not lose health.  An example of a step. The numbers in green circles represent the number of soldiers in Evlampy\'s groups, the arrows represent attacks, the numbers in red circles represent health points of enemy groups, the blue numbers represent how much the health points will decrease after the step. Evlampy understands that the upcoming battle will take the whole night. He became sad because this way he won\'t have enough time to finish his homework. Now Evlampy wants you to write a program that will help him win in the smallest possible number of steps. Can you help him?In other words, find the smallest number of steps needed to destroy all enemy groups and show a possible way of doing this. Find the requires splitting of the army into mm groups and the arrays aa for each step." 3100

1119F "Niyaz and Small Degrees" "data structures,dp,trees" "Niyaz has a tree with n vertices numerated from 1 to n. A tree is a connected graph without cycles.Each edge in this tree has strictly positive integer weight. A degree of a vertex is the number of edges adjacent to this vertex.Niyaz does not like when vertices in the tree have too large degrees. For each x from 0 to (n\xe2\x88\x921), he wants to find the smallest total weight of a set of edges to be deleted so that degrees of all vertices become at most x." 3400

1119E "Pavel and Triangles" "brute force,dp,fft,greedy,ternary search" "Pavel has several sticks with lengths equal to powers of two.He has a0 sticks of length 20=1, a1 sticks of length 21=2, ..., an\xe2\x88\x921 sticks of length 2n\xe2\x88\x921. Pavel wants to make the maximum possible number of triangles using these sticks. The triangles should have strictly positive area, each stick can be used in at most one triangle.It is forbidden to break sticks, and each triangle should consist of exactly three sticks.Find the maximum possible number of triangles." 1900

1119D "Frets On Fire" "binary search,sortings" "Miyako came to the flea kingdom with a ukulele. She became good friends with local flea residents and played beautiful music for them every day.In return, the fleas made a bigger ukulele for her: it has n strings, and each string has (1018+1) frets numerated from 0 to 1018. The fleas use the array s1,s2,\xe2\x80\xa6,sn to describe the ukulele\'s tuning, that is, the pitch of the j-th fret on the i-th string is the integer si+j.Miyako is about to leave the kingdom, but the fleas hope that Miyako will answer some last questions for them.Each question is in the form of: ""How many different pitches are there, if we consider frets between l and r (inclusive) on all strings?""Miyako is about to visit the cricket kingdom and has no time to answer all the questions. Please help her with this task!Formally, you are given a matrix with n rows and (1018+1) columns, where the cell in the i-th row and j-th column (0\xe2\x89\xa4j\xe2\x89\xa41018) contains the integer si+j. You are to answer q queries, in the k-th query you have to answer the number of distinct integers in the matrix from the lk-th to the rk-th columns, inclusive." 1800

1119C "Ramesses and Corner Inversion" "constructive algorithms,greedy,implementation,math" "Ramesses came to university to algorithms practice, and his professor, who is a fairly known programmer, gave him the following task.You are given two matrices AA and BB of size n\xc3\x97mn\xc3\x97m, each of which consists of 00 and 11 only. You can apply the following operation to the matrix AA arbitrary number of times: take any submatrix of the matrix AA that has at least two rows and two columns, and invert the values in its corners (i.e. all corners of the submatrix that contain 00, will be replaced by 11, and all corners of the submatrix that contain 11, will be replaced by 00). You have to answer whether you can obtain the matrix BB from the matrix AA.  An example of the operation. The chosen submatrix is shown in blue and yellow, its corners are shown in yellow. Ramesses don\'t want to perform these operations by himself, so he asks you to answer this question.A submatrix of matrix MM is a matrix which consist of all elements which come from one of the rows with indices x1,x1+1,\xe2\x80\xa6,x2x1,x1+1,\xe2\x80\xa6,x2 of matrix MM and one of the columns with indices y1,y1+1,\xe2\x80\xa6,y2y1,y1+1,\xe2\x80\xa6,y2 of matrix MM, where x1,x2,y1,y2x1,x2,y1,y2 are the edge rows and columns of the submatrix. In other words, a submatrix is a set of elements of source matrix which form a solid rectangle (i.e. without holes) with sides parallel to the sides of the original matrix. The corners of the submatrix are cells (x1,y1)(x1,y1), (x1,y2)(x1,y2), (x2,y1)(x2,y1), (x2,y2)(x2,y2), where the cell (i,j)(i,j) denotes the cell on the intersection of the ii-th row and the jj-th column." 1500

1119B "Alyona and a Narrow Fridge" "binary search,flows,greedy,sortings" "Alyona has recently bought a miniature fridge that can be represented as a matrix with hh rows and 22 columns. Initially there is only one shelf at the bottom of the fridge, but Alyona can install arbitrary number of shelves inside the fridge between any two rows. A shelf is two cells wide, does not occupy any space but separates the inside of the fridge to the lower and upper part.  An example of a fridge with h=7h=7 and two shelves. The shelves are shown in black. The picture corresponds to the first example. Alyona has nn bottles of milk that she wants to put in the fridge. The ii-th bottle is aiai cells tall and 11 cell wide. She can put a bottle on some shelf if the corresponding space above the shelf is at least as tall as the bottle. She can not put a bottle on top of another bottle (if there is no shelf between them). Two bottles can not share a cell.Alyona is interested in the largest integer kk such that she can put bottles 11, 22, ..., kk in the fridge at the same time. Find this largest kk." 1300

1119A "Ilya and a Colorful Walk" greedy,implementation "Ilya lives in a beautiful city of Chordalsk.There are n houses on the street Ilya lives, they are numerated from 1 to n from left to right; the distance between every two neighboring houses is equal to 1 unit. The neighboring houses are 1 and 2, 2 and 3, ..., n\xe2\x88\x921 and n. The houses n and 1 are not neighboring.The houses are colored in colors c1,c2,\xe2\x80\xa6,cn so that the i-th house is colored in the color ci. Everyone knows that Chordalsk is not boring, so there are at least two houses colored in different colors.Ilya wants to select two houses i and j so that 1\xe2\x89\xa4i<j\xe2\x89\xa4n, and they have different colors: ci\xe2\x89\xa0cj. He will then walk from the house i to the house j the distance of (j\xe2\x88\x92i) units.Ilya loves long walks, so he wants to choose the houses so that the distance between them is the maximum possible.Help Ilya, find this maximum possible distance." 1100

1118F2 "Tree Cutting (Hard Version)" "combinatorics,dfs and similar,dp,trees" "You are given an undirected tree of nn vertices. Some vertices are colored one of the kk colors, some are uncolored. It is guaranteed that the tree contains at least one vertex of each of the kk colors. There might be no uncolored vertices.You choose a subset of exactly k\xe2\x88\x921k\xe2\x88\x921 edges and remove it from the tree. Tree falls apart into kk connected components. Let\'s call this subset of edges nice if none of the resulting components contain vertices of different colors.How many nice subsets of edges are there in the given tree? Two subsets are considered different if there is some edge that is present in one subset and absent in the other.The answer may be large, so print it modulo 998244353998244353." 2700

1118F1 "Tree Cutting (Easy Version)" "dfs and similar,trees" "You are given an undirected tree of n vertices. Some vertices are colored blue, some are colored red and some are uncolored. It is guaranteed that the tree contains at least one red vertex and at least one blue vertex.You choose an edge and remove it from the tree. Tree falls apart into two connected components. Let\'s call an edge nice if neither of the resulting components contain vertices of both red and blue colors.How many nice edges are there in the given tree?" 1800

1118E "Yet Another Ball Problem" "constructive algorithms,implementation" "The king of Berland organizes a ball! n pair are invited to the ball, they are numbered from 1 to n. Each pair consists of one man and one woman. Each dancer (either man or woman) has a monochrome costume. The color of each costume is represented by an integer from 1 to k, inclusive.Let bi be the color of the man\'s costume and gi be the color of the woman\'s costume in the i-th pair. You have to choose a color for each dancer\'s costume (i.e. values b1,b2,\xe2\x80\xa6,bn and g1,g2,\xe2\x80\xa6gn) in such a way that:  for every i: bi and gi are integers between 1 and k, inclusive;  there are no two completely identical pairs, i.e. no two indices i,j (i\xe2\x89\xa0j) such that bi=bj and gi=gj at the same time;  there is no pair such that the color of the man\'s costume is the same as the color of the woman\'s costume in this pair, i.e. bi\xe2\x89\xa0gi for every i;  for each two consecutive (adjacent) pairs both man\'s costume colors and woman\'s costume colors differ, i.e. for every i from 1 to n\xe2\x88\x921 the conditions bi\xe2\x89\xa0bi+1 and gi\xe2\x89\xa0gi+1 hold. Let\'s take a look at the examples of bad and good color choosing (for n=4 and k=3, man is the first in a pair and woman is the second):Bad color choosing:   (1,2), (2,3), (3,2), (1,2) \xe2\x80\x94 contradiction with the second rule (there are equal pairs);  (2,3), (1,1), (3,2), (1,3) \xe2\x80\x94 contradiction with the third rule (there is a pair with costumes of the same color);  (1,2), (2,3), (1,3), (2,1) \xe2\x80\x94 contradiction with the fourth rule (there are two consecutive pairs such that colors of costumes of men/women are the same). Good color choosing:   (1,2), (2,1), (1,3), (3,1);  (1,2), (3,1), (2,3), (3,2);  (3,1), (1,2), (2,3), (3,2). You have to find any suitable color choosing or say that no suitable choosing exists." 1700

1118D2 "Coffee and Coursework (Hard Version)" "binary search,greedy" "The only difference between easy and hard versions is the constraints.Polycarp has to write a coursework. The coursework consists of m pages.Polycarp also has n cups of coffee. The coffee in the i-th cup Polycarp has ai caffeine in it. Polycarp can drink some cups of coffee (each one no more than once). He can drink cups in any order. Polycarp drinks each cup instantly and completely (i.e. he cannot split any cup into several days).Surely, courseworks are not being written in a single day (in a perfect world of Berland, at least).Let\'s consider some day of Polycarp\'s work. Consider Polycarp drinks k cups of coffee during this day and caffeine dosages of cups Polycarp drink during this day are ai1,ai2,\xe2\x80\xa6,aik. Then the first cup he drinks gives him energy to write ai1 pages of coursework, the second cup gives him energy to write max(0,ai2\xe2\x88\x921) pages, the third cup gives him energy to write max(0,ai3\xe2\x88\x922) pages, ..., the k-th cup gives him energy to write max(0,aik\xe2\x88\x92k+1) pages.If Polycarp doesn\'t drink coffee during some day, he cannot write coursework at all that day.Polycarp has to finish his coursework as soon as possible (spend the minimum number of days to do it). Your task is to find out this number of days or say that it is impossible." 1700

1118D1 "Coffee and Coursework (Easy version)" "brute force,greedy" "The only difference between easy and hard versions is the constraints.Polycarp has to write a coursework. The coursework consists of m pages.Polycarp also has n cups of coffee. The coffee in the i-th cup has ai caffeine in it. Polycarp can drink some cups of coffee (each one no more than once). He can drink cups in any order. Polycarp drinks each cup instantly and completely (i.e. he cannot split any cup into several days).Surely, courseworks are not usually being written in a single day (in a perfect world of Berland, at least). Some of them require multiple days of hard work.Let\'s consider some day of Polycarp\'s work. Consider Polycarp drinks k cups of coffee during this day and caffeine dosages of cups Polycarp drink during this day are ai1,ai2,\xe2\x80\xa6,aik. Then the first cup he drinks gives him energy to write ai1 pages of coursework, the second cup gives him energy to write max(0,ai2\xe2\x88\x921) pages, the third cup gives him energy to write max(0,ai3\xe2\x88\x922) pages, ..., the k-th cup gives him energy to write max(0,aik\xe2\x88\x92k+1) pages.If Polycarp doesn\'t drink coffee during some day, he cannot write coursework at all that day.Polycarp has to finish his coursework as soon as possible (spend the minimum number of days to do it). Your task is to find out this number of days or say that it is impossible." 1700

1118C "Palindromic Matrix" "constructive algorithms,implementation" "Let\'s call some square matrix with integer values in its cells palindromic if it doesn\'t change after the order of rows is reversed and it doesn\'t change after the order of columns is reversed.For example, the following matrices are palindromic:  The following matrices are not palindromic because they change after the order of rows is reversed:  The following matrices are not palindromic because they change after the order of columns is reversed:  You are given n2n2 integers. Put them into a matrix of nn rows and nn columns so that each number is used exactly once, each cell contains exactly one number and the resulting matrix is palindromic. If there are multiple answers, print any. If there is no solution, print ""NO""." 1700

1118B "Tanya and Candies" implementation "Tanya has n candies numbered from 1 to n. The i-th candy has the weight ai.She plans to eat exactly n\xe2\x88\x921 candies and give the remaining candy to her dad. Tanya eats candies in order of increasing their numbers, exactly one candy per day.Your task is to find the number of such candies i (let\'s call these candies good) that if dad gets the i-th candy then the sum of weights of candies Tanya eats in even days will be equal to the sum of weights of candies Tanya eats in odd days. Note that at first, she will give the candy, after it she will eat the remaining candies one by one.For example, n=4 and weights are [1,4,3,3]. Consider all possible cases to give a candy to dad:  Tanya gives the 1-st candy to dad (a1=1), the remaining candies are [4,3,3]. She will eat a2=4 in the first day, a3=3 in the second day, a4=3 in the third day. So in odd days she will eat 4+3=7 and in even days she will eat 3. Since 7\xe2\x89\xa03 this case shouldn\'t be counted to the answer (this candy isn\'t good).  Tanya gives the 2-nd candy to dad (a2=4), the remaining candies are [1,3,3]. She will eat a1=1 in the first day, a3=3 in the second day, a4=3 in the third day. So in odd days she will eat 1+3=4 and in even days she will eat 3. Since 4\xe2\x89\xa03 this case shouldn\'t be counted to the answer (this candy isn\'t good).  Tanya gives the 3-rd candy to dad (a3=3), the remaining candies are [1,4,3]. She will eat a1=1 in the first day, a2=4 in the second day, a4=3 in the third day. So in odd days she will eat 1+3=4 and in even days she will eat 4. Since 4=4 this case should be counted to the answer (this candy is good).  Tanya gives the 4-th candy to dad (a4=3), the remaining candies are [1,4,3]. She will eat a1=1 in the first day, a2=4 in the second day, a3=3 in the third day. So in odd days she will eat 1+3=4 and in even days she will eat 4. Since 4=4 this case should be counted to the answer (this candy is good). In total there 2 cases which should counted (these candies are good), so the answer is 2." 1200

1118A "Water Buying" math "Polycarp wants to cook a soup. To do it, he needs to buy exactly n liters of water.There are only two types of water bottles in the nearby shop \xe2\x80\x94 1-liter bottles and 2-liter bottles. There are infinitely many bottles of these two types in the shop.The bottle of the first type costs a burles and the bottle of the second type costs b burles correspondingly.Polycarp wants to spend as few money as possible. Your task is to find the minimum amount of money (in burles) Polycarp needs to buy exactly n liters of water in the nearby shop if the bottle of the first type costs a burles and the bottle of the second type costs b burles. You also have to answer q independent queries." 800

1117G "Recursive Queries" "data structures" "You are given a permutation p1,p2,\xe2\x80\xa6,pn. You should answer q queries. Each query is a pair (li,ri), and you should calculate f(li,ri).Let\'s denote ml,r as the position of the maximum in subsegment pl,pl+1,\xe2\x80\xa6,pr.Then f(l,r)=(r\xe2\x88\x92l+1)+f(l,ml,r\xe2\x88\x921)+f(ml,r+1,r) if l\xe2\x89\xa4r or 0 otherwise." 2500

1117F "Crisp String" bitmasks,dp "You are given a string of length n. Each character is one of the first p lowercase Latin letters.You are also given a matrix A with binary values of size p\xc3\x97p. This matrix is symmetric (Aij=Aji). Aij=1 means that the string can have the i-th and j-th letters of Latin alphabet adjacent.Let\'s call the string crisp if all of the adjacent characters in it can be adjacent (have 1 in the corresponding cell of matrix A).You are allowed to do the following move. Choose any letter, remove all its occurrences and join the remaining parts of the string without changing their order. For example, removing letter \'a\' from ""abacaba"" will yield ""bcb"".The string you are given is crisp. The string should remain crisp after every move you make.You are allowed to do arbitrary number of moves (possible zero). What is the shortest resulting string you can obtain?" 2500

1117E "Decypher the String" "bitmasks,chinese remainder theorem,constructive algorithms,interactive,math" "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.You are given a string t consisting of n lowercase Latin letters. This string was cyphered as follows: initially, the jury had a string s consisting of n lowercase Latin letters. Then they applied a sequence of no more than n (possibly zero) operations. i-th operation is denoted by two integers ai and bi (1\xe2\x89\xa4ai,bi\xe2\x89\xa4n), and means swapping two elements of the string with indices ai and bi. All operations were done in the order they were placed in the sequence. For example, if s is xyz and 2 following operations are performed: a1=1,b1=2; a2=2,b2=3, then after the first operation the current string is yxz, and after the second operation the current string is yzx, so t is yzx.You are asked to restore the original string s. Unfortunately, you have no information about the operations used in the algorithm (you don\'t even know if there were any operations in the sequence). But you may run the same sequence of operations on any string you want, provided that it contains only lowercase Latin letters and its length is n, and get the resulting string after those operations.Can you guess the original string s asking the testing system to run the sequence of swaps no more than 3 times?The string s and the sequence of swaps are fixed in each test; the interactor doesn\'t try to adapt the test to your solution." 2200

1117D "Magic Gems" dp,math,matrices "Reziba has many magic gems. Each magic gem can be split into M normal gems. The amount of space each magic (and normal) gem takes is 1 unit. A normal gem cannot be split.Reziba wants to choose a set of magic gems and split some of them, so the total space occupied by the resulting set of gems is N units. If a magic gem is chosen and split, it takes M units of space (since it is split into M gems); if a magic gem is not split, it takes 1 unit.How many different configurations of the resulting set of gems can Reziba have, such that the total amount of space taken is N units? Print the answer modulo 1000000007 (109+7). Two configurations are considered different if the number of magic gems Reziba takes to form them differs, or the indices of gems Reziba has to split differ." 2100

1117C "Magic Ship" "binary search" "You a captain of a ship. Initially you are standing in a point (x1,y1) (obviously, all positions in the sea can be described by cartesian plane) and you want to travel to a point (x2,y2). You know the weather forecast \xe2\x80\x94 the string s of length n, consisting only of letters U, D, L and R. The letter corresponds to a direction of wind. Moreover, the forecast is periodic, e.g. the first day wind blows to the side s1, the second day \xe2\x80\x94 s2, the n-th day \xe2\x80\x94 sn and (n+1)-th day \xe2\x80\x94 s1 again and so on. Ship coordinates change the following way:  if wind blows the direction U, then the ship moves from (x,y) to (x,y+1);  if wind blows the direction D, then the ship moves from (x,y) to (x,y\xe2\x88\x921);  if wind blows the direction L, then the ship moves from (x,y) to (x\xe2\x88\x921,y);  if wind blows the direction R, then the ship moves from (x,y) to (x+1,y). The ship can also either go one of the four directions or stay in place each day. If it goes then it\'s exactly 1 unit of distance. Transpositions of the ship and the wind add up. If the ship stays in place, then only the direction of wind counts. For example, if wind blows the direction U and the ship moves the direction L, then from point (x,y) it will move to the point (x\xe2\x88\x921,y+1), and if it goes the direction U, then it will move to the point (x,y+2).You task is to determine the minimal number of days required for the ship to reach the point (x2,y2)." 1900

1117B Emotes greedy,math,sortings "There are n emotes in very popular digital collectible card game (the game is pretty famous so we won\'t say its name). The i-th emote increases the opponent\'s happiness by ai units (we all know that emotes in this game are used to make opponents happy).You have time to use some emotes only m times. You are allowed to use any emotion once, more than once, or not use it at all. The only restriction is that you cannot use the same emote more than k times in a row (otherwise the opponent will think that you\'re trolling him).Note that two emotes i and j (i\xe2\x89\xa0j) such that ai=aj are considered different.You have to make your opponent as happy as possible. Find the maximum possible opponent\'s happiness." 1000

1117A "Best Subsegment" implementation,math "You are given array a1,a2,\xe2\x80\xa6,an. Find the subsegment al,al+1,\xe2\x80\xa6,ar (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) with maximum arithmetic mean 1r\xe2\x88\x92l+1r\xe2\x88\x91i=lai (in floating-point numbers, i.e. without any rounding).If there are many such subsegments find the longest one." 1100

1116D6 "Hessenberg matrix" NA "Implement a unitary operation on N qubits which is represented by an upper Hessenberg matrix (a square matrix of size 2N which has all zero elements below the first subdiagonal and all non-zero elements on the first subdiagonal and above it).For example, for N=2 the matrix of the operation should have the following shape:XXXXXXXX.XXX..XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa44) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation." -999

1116D5 Creeper NA "Implement a unitary operation on 3 qubits which is represented by a square matrix of size 8 with the following pattern:XX....XXXX....XX...XX......XX.....X..X....X..X..XX....XXXX....XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of 3 qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation." -999

1116D4 "TIE fighter" NA "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N which has non-zero elements in the following positions: the central 2x2 sub-matrix, the diagonals of the top right and bottom left square sub-matrices of size 2N\xe2\x88\x921\xe2\x88\x921 that do not overlap with the central 2x2 sub-matrix, the anti-diagonals of the top left and bottom right square sub-matrices of size 2N\xe2\x88\x921\xe2\x88\x921 that do not overlap with the central 2x2 sub-matrix.For example, for N=3 the matrix of the operation should have the following shape:..X..X...X....X.X......X...XX......XX...X......X.X....X...X..X..Here X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation." -999

1116D3 "X-wing fighter" NA "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N which has non-zero elements on both main diagonal and anti-diagonal and zero elements everywhere else.For example, for N=3 the matrix of the operation should have the following shape:X......X.X....X...X..X.....XX......XX.....X..X...X....X.X......XHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation." -999

1116D2 "Pattern of increasing blocks" NA "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N defined as follows: top right and bottom left quarters are filled with zero elements,  the top left quarter is the same pattern of size 2N\xe2\x88\x921 (for N=1, the top left quarter is a non-zero element), the bottom right quarter is filled with non-zero elements.For example, for N=3 the matrix of the operation should have the following shape:X........X........XX......XX........XXXX....XXXX....XXXX....XXXXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation." -999

1116D1 "Block diagonal matrix" NA "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N which has 2x2 blocks of non-zero elements on the main diagonal and zero elements everywhere else.For example, for N=3 the matrix of the operation should have the following shape:XX......XX........XX......XX........XX......XX........XX......XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation." -999

1116C3 "``Is the number of ones divisible by 3?\'\' oracle" NA "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N which has 2x2 blocks of non-zero elements on the main diagonal and zero elements everywhere else.For example, for N=3 the matrix of the operation should have the following shape:XX......XX........XX......XX........XX......XX........XX......XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation." -999

1116C2 "``Is the bit string periodic?\'\' oracle" NA "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N which has 2x2 blocks of non-zero elements on the main diagonal and zero elements everywhere else.For example, for N=3 the matrix of the operation should have the following shape:XX......XX........XX......XX........XX......XX........XX......XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation." -999

1116C1 "Alternating bits oracle" NA "Implement a quantum oracle on N qubits which checks whether the bits in the input vector \xe2\x86\x92x alternate (i.e., implements the function f(\xe2\x86\x92x)=1 if \xe2\x86\x92x does not have a pair of adjacent bits in state 00 or 11).You have to implement an operation which takes the following inputs: an array of N (1\xe2\x89\xa4N\xe2\x89\xa47) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits. Note that the input register x has to remain unchanged after applying the operation.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}Note: the operation has to have an adjoint specified for it; adjoint auto means that the adjoint will be generated automatically. For details on adjoint, see Operation Definitions.You are not allowed to use measurements in your operation." -999

1116B2 "Not A, not B or not C?" NA "You are given a qubit which is guaranteed to be in one of the following states: |A\xe2\x9f\xa9=1\xe2\x88\x9a2(|0\xe2\x9f\xa9+|1\xe2\x9f\xa9), |B\xe2\x9f\xa9=1\xe2\x88\x9a2(|0\xe2\x9f\xa9+\xcf\x89|1\xe2\x9f\xa9), or |C\xe2\x9f\xa9=1\xe2\x88\x9a2(|0\xe2\x9f\xa9+\xcf\x892|1\xe2\x9f\xa9), where \xcf\x89=e2i\xcf\x80/3.These states are not orthogonal, and thus can not be distinguished perfectly. Your task is to figure out in which state the qubit is not. More formally: If the qubit was in state |A\xe2\x9f\xa9, you have to return 1 or 2. If the qubit was in state |B\xe2\x9f\xa9, you have to return 0 or 2. If the qubit was in state |C\xe2\x9f\xa9, you have to return 0 or 1. In other words, return 0 if you\'re sure the qubit was not in state |A\xe2\x9f\xa9, return 1 if you\'re sure the qubit was not in state |B\xe2\x9f\xa9, and return 2 if you\'re sure the qubit was not in state |C\xe2\x9f\xa9.Your solution will be called 1000 times, each time the state of the qubit will be chosen as |A\xe2\x9f\xa9, |B\xe2\x9f\xa9 or |C\xe2\x9f\xa9 with equal probability. The state of the qubit after the operations does not matter.You have to implement an operation which takes a qubit as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (q : Qubit) : Int {        // your code here    }}" -999

1116B1 "Distinguish three-qubit states" NA "You are given 3 qubits which are guaranteed to be in one of the two states: |\xcf\x880\xe2\x9f\xa9=1\xe2\x88\x9a3(|100\xe2\x9f\xa9+\xcf\x89|010\xe2\x9f\xa9+\xcf\x892|001\xe2\x9f\xa9), or |\xcf\x881\xe2\x9f\xa9=1\xe2\x88\x9a3(|100\xe2\x9f\xa9+\xcf\x892|010\xe2\x9f\xa9+\xcf\x89|001\xe2\x9f\xa9), where \xcf\x89=e2i\xcf\x80/3.Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was |\xcf\x880\xe2\x9f\xa9 state or 1 if it was |\xcf\x881\xe2\x9f\xa9 state. The state of the qubits after the operations does not matter.You have to implement an operation which takes an array of 3 qubits as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Int {        // your code here    }}" -999

1116A2 "Generate equal superposition of four basis states" NA "You are given N qubits in the zero state |0...0\xe2\x9f\xa9. You are also given four distinct bit vectors which describe four different basis states on N qubits |\xcf\x88i\xe2\x9f\xa9.Your task is to generate a state which is an equal superposition of the given basis states:|S\xe2\x9f\xa9=12(|\xcf\x880\xe2\x9f\xa9+|\xcf\x881\xe2\x9f\xa9+|\xcf\x882\xe2\x9f\xa9+|\xcf\x883\xe2\x9f\xa9)You have to implement an operation which takes the following inputs: an array of N (2\xe2\x89\xa4N\xe2\x89\xa416) qubits, a two-dimensional array of Boolean values bits representing the basis states |\xcf\x88i\xe2\x9f\xa9. bits will have exactly 4 elements, each of bits[i] describing the basis state |\xcf\x88i\xe2\x9f\xa9. Each of bits[i] will have N elements, bits[i][j] giving the state of qubit j in the basis state |\xcf\x88i\xe2\x9f\xa9. Bit values true and false corresponding to |1\xe2\x9f\xa9 and |0\xe2\x9f\xa9 states, respectively; for example, for N=2 an array [false, true] will represent the basis state |01\xe2\x9f\xa9. Each pair of bits[i] and bits[j] will differ in at least one position for i\xe2\x89\xa0j.The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[], bits : Bool[][]) : Unit {        // your code here    }}" -999

1116A1 "Generate state |00\xe2\x9f\xa9 + |01\xe2\x9f\xa9 + |10\xe2\x9f\xa9" NA "You are given N qubits in the zero state |0...0\xe2\x9f\xa9. You are also given four distinct bit vectors which describe four different basis states on N qubits |\xcf\x88i\xe2\x9f\xa9.Your task is to generate a state which is an equal superposition of the given basis states:|S\xe2\x9f\xa9=12(|\xcf\x880\xe2\x9f\xa9+|\xcf\x881\xe2\x9f\xa9+|\xcf\x882\xe2\x9f\xa9+|\xcf\x883\xe2\x9f\xa9)You have to implement an operation which takes the following inputs: an array of N (2\xe2\x89\xa4N\xe2\x89\xa416) qubits, a two-dimensional array of Boolean values bits representing the basis states |\xcf\x88i\xe2\x9f\xa9. bits will have exactly 4 elements, each of bits[i] describing the basis state |\xcf\x88i\xe2\x9f\xa9. Each of bits[i] will have N elements, bits[i][j] giving the state of qubit j in the basis state |\xcf\x88i\xe2\x9f\xa9. Bit values true and false corresponding to |1\xe2\x9f\xa9 and |0\xe2\x9f\xa9 states, respectively; for example, for N=2 an array [false, true] will represent the basis state |01\xe2\x9f\xa9. Each pair of bits[i] and bits[j] will differ in at least one position for i\xe2\x89\xa0j.The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[], bits : Bool[][]) : Unit {        // your code here    }}" -999

1115U3 "Block unitary" "*special problem" "Implement a unitary operation on N qubits which is represented by the following square matrix of size 2N: top right and bottom left quarters are filled with zero elements,  top left quarter is an anti-diagonal matrix of size 2N\xe2\x88\x921, bottom right quarter is filled with non-zero elements.For example, for N=2 the matrix of the operation should have the following shape:.X..X.....XX..XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}" 1700

1115U2 "Chessboard unitary" "*special problem" "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N in which zero and non-zero elements form a chessboard pattern with alternating 2x2 squares (top left square formed by non-zero elements).For example, for N=3 the matrix of the operation should have the following shape:XX..XX..XX..XX....XX..XX..XX..XXXX..XX..XX..XX....XX..XX..XX..XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}" 1600

1115U1 "Anti-diagonal unitary" "*special problem" "Implement a unitary operation on N qubits which is represented by an anti-diagonal matrix (a square matrix of size 2N which has non-zero elements on the diagonal that runs from the top right corner to the bottom left corner and zero elements everywhere else).For example, for N=2 the matrix of the operation should have the following shape:...X..X..X..X...Here X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}" 1500

1115G3 "Palindrome checker oracle" "*special problem" "Implement a quantum oracle on N qubits which checks whether the vector \xe2\x86\x92x is a palindrome (i.e., implements the function f(\xe2\x86\x92x)=1 if \xe2\x86\x92x is a palindrome, and 0 otherwise).You have to implement an operation which takes the following inputs: an array of N (1\xe2\x89\xa4N\xe2\x89\xa48) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}" 1600

1115G2 "OR oracle" "*special problem" "Implement a quantum oracle on N qubits which implements the following function: f(\xe2\x86\x92x)=x0\xe2\x88\xa8x1\xe2\x88\xa8\xe2\x8b\xaf\xe2\x88\xa8xN\xe2\x88\x921You have to implement an operation which takes the following inputs: an array of N (1\xe2\x89\xa4N\xe2\x89\xa48) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}" 1600

1115G1 "AND oracle" "*special problem" "Implement a quantum oracle on N qubits which implements the following function: f(\xe2\x86\x92x)=x0\xe2\x88\xa7x1\xe2\x88\xa7\xe2\x8b\xaf\xe2\x88\xa7xN\xe2\x88\x921You have to implement an operation which takes the following inputs: an array of N (1\xe2\x89\xa4N\xe2\x89\xa48) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}" 1100

1114F "Please, another Queries on Array?" "bitmasks,data structures,divide and conquer,math,number theory" "You are given an array a1,a2,\xe2\x80\xa6,an.You need to perform q queries of the following two types:  ""MULTIPLY l r x""�\xe2\x80\x94 for every i (l\xe2\x89\xa4i\xe2\x89\xa4r) multiply ai by x. ""TOTIENT l r""�\xe2\x80\x94 print \xcf\x86(r\xe2\x88\x8fi=lai) taken modulo 109+7, where \xcf\x86 denotes Euler\'s totient function. The Euler\'s totient function of a positive integer n (denoted as \xcf\x86(n)) is the number of integers x (1\xe2\x89\xa4x\xe2\x89\xa4n) such that gcd(n,x)=1." 2400

1114E "Arithmetic Progression" "binary search,interactive,number theory,probabilities" "This is an interactive problem!An arithmetic progression or arithmetic sequence is a sequence of integers such that the subtraction of element with its previous element (xi\xe2\x88\x92xi\xe2\x88\x921, where i\xe2\x89\xa52) is constant�\xe2\x80\x94 such difference is called a common difference of the sequence.That is, an arithmetic progression is a sequence of form xi=x1+(i\xe2\x88\x921)d, where d is a common difference of the sequence.There is a secret list of n integers a1,a2,\xe2\x80\xa6,an.It is guaranteed that all elements a1,a2,\xe2\x80\xa6,an are between 0 and 109, inclusive.This list is special: if sorted in increasing order, it will form an arithmetic progression with positive common difference (d>0). For example, the list [14,24,9,19] satisfies this requirement, after sorting it makes a list [9,14,19,24], which can be produced as xn=9+5\xe2\x8b\x85(n\xe2\x88\x921).Also you are also given a device, which has a quite discharged battery, thus you can only use it to perform at most 60 queries of following two types: Given a value i (1\xe2\x89\xa4i\xe2\x89\xa4n), the device will show the value of the ai. Given a value x (0\xe2\x89\xa4x\xe2\x89\xa4109), the device will return 1 if an element with a value strictly greater than x exists, and it will return 0 otherwise.Your can use this special device for at most 60 queries. Could you please find out the smallest element and the common difference of the sequence? That is, values x1 and d in the definition of the arithmetic progression. Note that the array a is not sorted." 2200

1114D "Flood Fill" dp "You are given a line of n colored squares in a row, numbered from 1 to n from left to right. The i-th square initially has the color ci.Let\'s say, that two squares i and j belong to the same connected component if ci=cj, and ci=ck for all k satisfying i<k<j. In other words, all squares on the segment from i to j should have the same color.For example, the line [3,3,3] has 1 connected component, while the line [5,2,4,4] has 3 connected components.The game ""flood fill"" is played on the given line as follows:   At the start of the game you pick any starting square (this is not counted as a turn).  Then, in each game turn, change the color of the connected component containing the starting square to any other color. Find the minimum number of turns needed for the entire line to be changed into a single color." 1900

1114C "Trailing Loves (or L\'oeufs?)" "brute force,implementation,math,number theory" "You are given a line of n colored squares in a row, numbered from 1 to n from left to right. The i-th square initially has the color ci.Let\'s say, that two squares i and j belong to the same connected component if ci=cj, and ci=ck for all k satisfying i<k<j. In other words, all squares on the segment from i to j should have the same color.For example, the line [3,3,3] has 1 connected component, while the line [5,2,4,4] has 3 connected components.The game ""flood fill"" is played on the given line as follows:   At the start of the game you pick any starting square (this is not counted as a turn).  Then, in each game turn, change the color of the connected component containing the starting square to any other color. Find the minimum number of turns needed for the entire line to be changed into a single color." 1700

1114B "Yet Another Array Partitioning Task" "constructive algorithms,greedy,sortings" "An array b is called to be a subarray of a if it forms a continuous subsequence of a, that is, if it is equal to al, al+1, \xe2\x80\xa6, ar for some l,r.Suppose m is some known constant. For any array, having m or more elements, let\'s define it\'s beauty as the sum of m largest elements of that array. For example:   For array x=[4,3,1,5,2] and m=3, the 3 largest elements of x are 5, 4 and 3, so the beauty of x is 5+4+3=12. For array x=[10,10,10] and m=2, the beauty of x is 10+10=20.You are given an array a1,a2,\xe2\x80\xa6,an, the value of the said constant m and an integer k. Your need to split the array a into exactly k subarrays such that:  Each element from a belongs to exactly one subarray. Each subarray has at least m elements. The sum of all beauties of k subarrays is maximum possible." 1500

1114A "Got Any Grapes?" "brute force,greedy,implementation" "The Duck songFor simplicity, we\'ll assume that there are only three types of grapes: green grapes, purple grapes and black grapes.Andrew, Dmitry and Michal are all grapes\' lovers, however their preferences of grapes are different. To make all of them happy, the following should happen: Andrew, Dmitry and Michal should eat at least x, y and z grapes, respectively. Andrew has an extreme affinity for green grapes, thus he will eat green grapes and green grapes only. On the other hand, Dmitry is not a fan of black grapes�\xe2\x80\x94 any types of grapes except black would do for him. In other words, Dmitry can eat green and purple grapes. Michal has a common taste�\xe2\x80\x94 he enjoys grapes in general and will be pleased with any types of grapes, as long as the quantity is sufficient.Knowing that his friends are so fond of grapes, Aki decided to host a grape party with them. He has prepared a box with a green grapes, b purple grapes and c black grapes.However, Aki isn\'t sure if the box he prepared contains enough grapes to make everyone happy. Can you please find out whether it\'s possible to distribute grapes so that everyone is happy or Aki has to buy some more grapes?It is not required to distribute all the grapes, so it\'s possible that some of them will remain unused." 800

1113B "Sasha and Magnetic Machines" "greedy,number theory" "One day Sasha visited the farmer 2D and his famous magnetic farm. On this farm, the crop grows due to the influence of a special magnetic field. Maintaining of the magnetic field is provided by n machines, and the power of the i-th machine is ai. This year 2D decided to cultivate a new culture, but what exactly he didn\'t say. For the successful growth of the new culture, it is necessary to slightly change the powers of the machines. 2D can at most once choose an arbitrary integer x, then choose one machine and reduce the power of its machine by x times, and at the same time increase the power of one another machine by x times (powers of all the machines must stay positive integers). Note that he may not do that if he wants. More formally, 2D can choose two such indices i and j, and one integer x such that x is a divisor of ai, and change powers as following: ai=aix, aj=aj\xe2\x8b\x85xSasha is very curious, that\'s why he wants to calculate the minimum total power the farmer can reach. There are too many machines, and Sasha can\'t cope with computations, help him!" 1300

1113A "Sasha and His Trip" dp,greedy,math "Sasha is a very happy guy, that\'s why he is always on the move. There are n cities in the country where Sasha lives. They are all located on one straight line, and for convenience, they are numbered from 1 to n in increasing order. The distance between any two adjacent cities is equal to 1 kilometer. Since all roads in the country are directed, it\'s possible to reach the city y from the city x only if x<y. Once Sasha decided to go on a trip around the country and to visit all n cities. He will move with the help of his car, Cheetah-2677. The tank capacity of this model is v liters, and it spends exactly 1 liter of fuel for 1 kilometer of the way. At the beginning of the journey, the tank is empty. Sasha is located in the city with the number 1 and wants to get to the city with the number n. There is a gas station in each city. In the i-th city, the price of 1 liter of fuel is i dollars. It is obvious that at any moment of time, the tank can contain at most v liters of fuel.Sasha doesn\'t like to waste money, that\'s why he wants to know what is the minimum amount of money is needed to finish the trip if he can buy fuel in any city he wants. Help him to figure it out!" 900

1111E Tree "data structures,dfs and similar,dp,graphs,trees" "You are given a tree with n nodes and q queries.Every query starts with three integers k, m and r, followed by k nodes of the tree a1,a2,\xe2\x80\xa6,ak. To answer a query, assume that the tree is rooted at r. We want to divide the k given nodes into at most m groups such that the following conditions are met:   Each node should be in exactly one group and each group should have at least one node.  In any group, there should be no two distinct nodes such that one node is an ancestor (direct or indirect) of the other. You need to output the number of ways modulo 109+7 for every query." 2500

1111D "Destroy the Colony" combinatorics,dp,math "There is a colony of villains with several holes aligned in a row, where each hole contains exactly one villain.Each colony arrangement can be expressed as a string of even length, where the i-th character of the string represents the type of villain in the i-th hole. Iron Man can destroy a colony only if the colony arrangement is such that all villains of a certain type either live in the first half of the colony or in the second half of the colony.His assistant Jarvis has a special power. It can swap villains of any two holes, i.e. swap any two characters in the string; he can do this operation any number of times.Now Iron Man asks Jarvis q questions. In each question, he gives Jarvis two numbers x and y. Jarvis has to tell Iron Man the number of distinct colony arrangements he can create from the original one using his powers such that all villains having the same type as those originally living in x-th hole or y-th hole live in the same half and the Iron Man can destroy that colony arrangement.Two colony arrangements are considered to be different if there exists a hole such that different types of villains are present in that hole in the arrangements." 2600

1111C "Creative Snap" "binary search,brute force,divide and conquer,math" "Thanos wants to destroy the avengers base, but he needs to destroy the avengers along with their base.Let we represent their base with an array, where each position can be occupied by many avengers, but one avenger can occupy only one position. Length of their base is a perfect power of 2. Thanos wants to destroy the base using minimum power. He starts with the whole base and in one step he can do either of following:   if the current length is at least 2, divide the base into 2 equal halves and destroy them separately, or  burn the current base. If it contains no avenger in it, it takes A amount of power, otherwise it takes his B\xe2\x8b\x85na\xe2\x8b\x85l amount of power, where na is the number of avengers and l is the length of the current base. Output the minimum power needed by Thanos to destroy the avengers\' base." 1700

1111B "Average Superhero Gang Power" "brute force,implementation,math" "Every superhero has been given a power value by the Felicity Committee. The avengers crew wants to maximize the average power of the superheroes in their team by performing certain operations.Initially, there are n superheroes in avengers team having powers a1,a2,\xe2\x80\xa6,an, respectively. In one operation, they can remove one superhero from their team (if there are at least two) or they can increase the power of a superhero by 1. They can do at most m operations. Also, on a particular superhero at most k operations can be done.Can you help the avengers team to maximize the average power of their crew?" 1700

1111A "Superhero Transformation" implementation,strings "We all know that a superhero can transform to certain other superheroes. But not all Superheroes can transform to any other superhero. A superhero with name s can transform to another superhero with name t if s can be made equal to t by changing any vowel in s to any other vowel and any consonant in s to any other consonant. Multiple changes can be made.In this problem, we consider the letters \'a\', \'e\', \'i\', \'o\' and \'u\' to be vowels and all the other letters to be consonants.Given the names of two superheroes, determine if the superhero with name s can be transformed to the Superhero with name t." 1000

1110H "Modest Substrings" dp,strings "You are given two integers l and r.Let\'s call an integer x modest, if l\xe2\x89\xa4x\xe2\x89\xa4r.Find a string of length n, consisting of digits, which has the largest possible number of substrings, which make a modest integer. Substring having leading zeros are not counted. If there are many answers, find lexicographically smallest one.If some number occurs multiple times as a substring, then in the counting of the number of modest substrings it is counted multiple times as well." 3500

1110G Tree-Tac-Toe "constructive algorithms,games,trees" "The tic-tac-toe game is starting on a tree of n vertices. Some vertices are already colored in white while the remaining are uncolored.There are two players�\xe2\x80\x94 white and black. The players make moves alternatively. The white player starts the game. In his turn, a player must select one uncolored vertex and paint it in his color.The player wins if he paints some path of three vertices in his color. In case all vertices are colored and neither player won, the game ends in a draw.Could you please find who will win the game or whether it ends as a draw, assuming both players play optimally?" 3100

1110F "Nearest Leaf" "data structures,trees" "Let\'s define the Eulerian traversal of a tree (a connected undirected graph without cycles) as follows: consider a depth-first search algorithm which traverses vertices of the tree and enumerates them in the order of visiting (only the first visit of each vertex counts). This function starts from the vertex number 11 and then recursively runs from all vertices which are connected with an edge with the current vertex and are not yet visited in increasing numbers order. Formally, you can describe this function using the following pseudocode:next_id = 1id = array of length n filled with -1visited = array of length n filled with falsefunction dfs(v):    visited[v] = true    id[v] = next_id    next_id += 1    for to in neighbors of v in increasing order:        if not visited[to]:            dfs(to)You are given a weighted tree, the vertices of which were enumerated with integers from 11 to nn using the algorithm described above.A leaf is a vertex of the tree which is connected with only one other vertex. In the tree given to you, the vertex 11 is not a leaf. The distance between two vertices in the tree is the sum of weights of the edges on the simple path between them.You have to answer qq queries of the following type: given integers vv, ll and rr, find the shortest distance from vertex vv to one of the leaves with indices from ll to rr inclusive." 2600

1110E "Magic Stones" "constructive algorithms,math,sortings" "Grigory has n magic stones, conveniently numbered from 1 to n. The charge of the i-th stone is equal to ci.Sometimes Grigory gets bored and selects some inner stone (that is, some stone with index i, where 2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), and after that synchronizes it with neighboring stones. After that, the chosen stone loses its own charge, but acquires the charges from neighboring stones. In other words, its charge ci changes to c\xe2\x80\xb2i=ci+1+ci\xe2\x88\x921\xe2\x88\x92ci.Andrew, Grigory\'s friend, also has n stones with charges ti. Grigory is curious, whether there exists a sequence of zero or more synchronization operations, which transforms charges of Grigory\'s stones into charges of corresponding Andrew\'s stones, that is, changes ci into ti for all i?" 2200

1110D Jongmah dp "You are playing a game of Jongmah. You don\'t need to know the rules to solve this problem. You have n tiles in your hand. Each tile has an integer between 1 and m written on it.To win the game, you will need to form some number of triples. Each triple consists of three tiles, such that the numbers written on the tiles are either all the same or consecutive. For example, 7,7,7 is a valid triple, and so is 12,13,14, but 2,2,3 or 2,4,6 are not. You can only use the tiles in your hand to form triples. Each tile can be used in at most one triple.To determine how close you are to the win, you want to know the maximum number of triples you can form from the tiles in your hand." 2200

1110C "Meaningless Operations" "constructive algorithms,math,number theory" "Can the greatest common divisor and bitwise operations have anything in common? It is time to answer this question.Suppose you are given a positive integer a. You want to choose some integer b from 1 to a\xe2\x88\x921 inclusive in such a way that the greatest common divisor (GCD) of integers a\xe2\x8a\x95b and a&b is as large as possible. In other words, you\'d like to compute the following function:f(a)=max0<b<agcd(a\xe2\x8a\x95b,a&b).Here \xe2\x8a\x95 denotes the bitwise XOR operation, and & denotes the bitwise AND operation.The greatest common divisor of two integers x and y is the largest integer g such that both x and y are divided by g without remainder.You are given q integers a1,a2,\xe2\x80\xa6,aq. For each of these integers compute the largest possible value of the greatest common divisor (when b is chosen optimally)." 1500

1110B Tape greedy,sortings "You have a long stick, consisting of m segments enumerated from 1 to m. Each segment is 1 centimeter long. Sadly, some segments are broken and need to be repaired.You have an infinitely long repair tape. You want to cut some pieces from the tape and use them to cover all of the broken segments. To be precise, a piece of tape of integer length t placed at some position s will cover segments s,s+1,\xe2\x80\xa6,s+t\xe2\x88\x921.You are allowed to cover non-broken segments; it is also possible that some pieces of tape will overlap.Time is money, so you want to cut at most k continuous pieces of tape to cover all the broken segments. What is the minimum total length of these pieces?" 1400

1110A Parity math "You are given an integer n (n\xe2\x89\xa50) represented with k digits in base (radix) b. So,n=a1\xe2\x8b\x85bk\xe2\x88\x921+a2\xe2\x8b\x85bk\xe2\x88\x922+\xe2\x80\xa6ak\xe2\x88\x921\xe2\x8b\x85b+ak.For example, if b=17,k=3 and a=[11,15,7] then n=11\xe2\x8b\x85172+15\xe2\x8b\x8517+7=3179+255+7=3441.Determine whether n is even or odd." 900

1109F "Sasha and Algorithm of Silence\'s Sounds" "data structures,trees" "You are given an integer n (n\xe2\x89\xa50) represented with k digits in base (radix) b. So,n=a1\xe2\x8b\x85bk\xe2\x88\x921+a2\xe2\x8b\x85bk\xe2\x88\x922+\xe2\x80\xa6ak\xe2\x88\x921\xe2\x8b\x85b+ak.For example, if b=17,k=3 and a=[11,15,7] then n=11\xe2\x8b\x85172+15\xe2\x8b\x8517+7=3179+255+7=3441.Determine whether n is even or odd." 3200

1109E "Sasha and a Very Easy Test" "data structures,number theory" "Egor likes math, and not so long ago he got the highest degree of recognition in the math community�\xe2\x80\x94 Egor became a red mathematician. In this regard, Sasha decided to congratulate Egor and give him a math test as a present. This test contains an array a of integers of length n and exactly q queries. Queries were of three types:   ""1 l r x""�\xe2\x80\x94 multiply each number on the range from l to r by x.  ""2 p x""�\xe2\x80\x94 divide the number at the position p by x (divisibility guaranteed).  ""3 l r""�\xe2\x80\x94 find the sum of all elements on the range from l to r. The sum can be big, so Sasha asked Egor to calculate the sum modulo some integer mod. But since Egor is a red mathematician, he doesn\'t have enough time to solve such easy tasks, at the same time he doesn\'t want to anger Sasha, that\'s why he asked you to help and to find answers for all queries of the 3-rd type." 2700

1109D "Sasha and Interesting Fact from Graph Theory" "brute force,combinatorics,dp,math,trees" "Once, during a lesson, Sasha got bored and decided to talk with his friends. Suddenly, he saw Kefa. Since we can talk endlessly about Kefa, we won\'t even start doing that. The conversation turned to graphs. Kefa promised Sasha to tell him about one interesting fact from graph theory if Sasha helps Kefa to count the number of beautiful trees. In this task, a tree is a weighted connected graph, consisting of nn vertices and n\xe2\x88\x921n\xe2\x88\x921 edges, and weights of edges are integers from 11 to mm. Kefa determines the beauty of a tree as follows: he finds in the tree his two favorite vertices�\xe2\x80\x94 vertices with numbers aa and bb, and counts the distance between them. The distance between two vertices xx and yy is the sum of weights of edges on the simple path from xx to yy. If the distance between two vertices aa and bb is equal to mm, then the tree is beautiful.Sasha likes graph theory, and even more, Sasha likes interesting facts, that\'s why he agreed to help Kefa. Luckily, Sasha is familiar with you the best programmer in Byteland. Help Sasha to count the number of beautiful trees for Kefa. Two trees are considered to be distinct if there is an edge that occurs in one of them and doesn\'t occur in the other one. Edge\'s weight matters.Kefa warned Sasha, that there can be too many beautiful trees, so it will be enough to count the number modulo 109+7109+7." 2400

1109C "Sasha and a Patient Friend" "binary search,data structures,implementation" "Fedya and Sasha are friends, that\'s why Sasha knows everything about Fedya.Fedya keeps his patience in an infinitely large bowl. But, unlike the bowl, Fedya\'s patience isn\'t infinite, that is why let vv be the number of liters of Fedya\'s patience, and, as soon as vv becomes equal to 00, the bowl will burst immediately. There is one tap in the bowl which pumps ss liters of patience per second. Notice that ss can be negative, in that case, the tap pumps out the patience. Sasha can do different things, so he is able to change the tap\'s speed. All actions that Sasha does can be represented as qq queries. There are three types of queries:  ""1 t s"" �\xe2\x80\x94 add a new event, means that starting from the tt-th second the tap\'s speed will be equal to ss.  ""2 t"" �\xe2\x80\x94 delete the event which happens at the tt-th second. It is guaranteed that such event exists.  ""3 l r v""�\xe2\x80\x94 Sasha wonders: if you take all the events for which l\xe2\x89\xa4t\xe2\x89\xa4rl\xe2\x89\xa4t\xe2\x89\xa4r and simulate changes of Fedya\'s patience from the very beginning of the ll-th second till the very beginning of the rr-th second inclusive (the initial volume of patience, at the beginning of the ll-th second, equals to vv liters) then when will be the moment when the bowl will burst. If that does not happen, then the answer will be \xe2\x88\x921\xe2\x88\x921. Since Sasha does not want to check what will happen when Fedya\'s patience ends, and he has already come up with the queries, he is asking you to help him and find the answer for each query of the 33-rd type.It is guaranteed that at any moment of time, there won\'t be two events which happen at the same second." 2800

1109B "Sasha and One More Name" "constructive algorithms,hashing,strings" "Reading books is one of Sasha\'s passions. Once while he was reading one book, he became acquainted with an unusual character. The character told about himself like that: ""Many are my names in many countries. Mithrandir among the Elves, Thark\xc3\xbbn to the Dwarves, Ol\xc3\xb3rin I was in my youth in the West that is forgotten, in the South Inc\xc3\xa1nus, in the North Gandalf; to the East I go not.""And at that moment Sasha thought, how would that character be called in the East? In the East all names are palindromes. A string is a palindrome if it reads the same backward as forward. For example, such strings as ""kazak"", ""oo"" and ""r"" are palindromes, but strings ""abb"" and ""ij"" are not. Sasha believed that the hero would be named after one of the gods of the East. As long as there couldn\'t be two equal names, so in the East people did the following: they wrote the original name as a string on a piece of paper, then cut the paper minimum number of times k, so they got k+1 pieces of paper with substrings of the initial string, and then unite those pieces together to get a new string. Pieces couldn\'t be turned over, they could be shuffled.In this way, it\'s possible to achive a string abcdefg from the string f|de|abc|g using 3 cuts (by swapping papers with substrings f and abc). The string cbadefg can\'t be received using the same cuts.More formally, Sasha wants for the given palindrome s find such minimum k, that you can cut this string into k+1 parts, and then unite them in such a way that the final string will be a palindrome and it won\'t be equal to the initial string s. It there is no answer, then print ""Impossible"" (without quotes)." 1800

1109A "Sasha and a Bit of Relax" dp,implementation "Sasha likes programming. Once, during a very long contest, Sasha decided that he was a bit tired and needed to relax. So he did. But since Sasha isn\'t an ordinary guy, he prefers to relax unusually. During leisure time Sasha likes to upsolve unsolved problems because upsolving is very useful.Therefore, Sasha decided to upsolve the following problem:You have an array a with n integers. You need to count the number of funny pairs (l,r) (l\xe2\x89\xa4r). To check if a pair (l,r) is a funny pair, take mid=l+r\xe2\x88\x9212, then if r\xe2\x88\x92l+1 is an even number and al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95amid=amid+1\xe2\x8a\x95amid+2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar, then the pair is funny. In other words, \xe2\x8a\x95 of elements of the left half of the subarray from l to r should be equal to \xe2\x8a\x95 of elements of the right half. Note that \xe2\x8a\x95 denotes the bitwise XOR operation.It is time to continue solving the contest, so Sasha asked you to solve this task." 1600

1108F "MST Unification" "binary search,dsu,graphs,greedy" "You are given an undirected weighted connected graph with nn vertices and mm edges without loops and multiple edges.The ii-th edge is ei=(ui,vi,wi)ei=(ui,vi,wi); the distance between vertices uiui and vivi along the edge eiei is wiwi (1\xe2\x89\xa4wi1\xe2\x89\xa4wi). The graph is connected, i.\xe2\x80\x89e. for any pair of vertices, there is at least one path between them consisting only of edges of the given graph.A minimum spanning tree (MST) in case of positive weights is a subset of the edges of a connected weighted undirected graph that connects all the vertices together and has minimum total cost among all such subsets (total cost is the sum of costs of chosen edges).You can modify the given graph. The only operation you can perform is the following: increase the weight of some edge by 11. You can increase the weight of each edge multiple (possibly, zero) times.Suppose that the initial MST cost is kk. Your problem is to increase weights of some edges with minimum possible number of operations in such a way that the cost of MST in the obtained graph remains kk, but MST is unique (it means that there is only one way to choose MST in the obtained graph).Your problem is to calculate the minimum number of operations required to do it." 2100

1108E2 "Array and Segments (Hard version)" "data structures,implementation" "The only difference between easy and hard versions is a number of elements in the array.You are given an array a consisting of n integers. The value of the i-th element of the array is ai.You are also given a set of m segments. The j-th segment is [lj;rj], where 1\xe2\x89\xa4lj\xe2\x89\xa4rj\xe2\x89\xa4n.You can choose some subset of the given set of segments and decrease values on each of the chosen segments by one (independently). For example, if the initial array a=[0,0,0,0,0] and the given segments are [1;3] and [2;4] then you can choose both of them and the array will become b=[\xe2\x88\x921,\xe2\x88\x922,\xe2\x88\x922,\xe2\x88\x921,0].You have to choose some subset of the given segments (each segment can be chosen at most once) in such a way that if you apply this subset of segments to the array a and obtain the array b then the value nmaxi=1bi\xe2\x88\x92nmini=1bi will be maximum possible.Note that you can choose the empty set.If there are multiple answers, you can print any.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 2100

1108E1 "Array and Segments (Easy version)" "brute force,greedy,implementation" "The only difference between easy and hard versions is a number of elements in the array.You are given an array a consisting of n integers. The value of the i-th element of the array is ai.You are also given a set of m segments. The j-th segment is [lj;rj], where 1\xe2\x89\xa4lj\xe2\x89\xa4rj\xe2\x89\xa4n.You can choose some subset of the given set of segments and decrease values on each of the chosen segments by one (independently). For example, if the initial array a=[0,0,0,0,0] and the given segments are [1;3] and [2;4] then you can choose both of them and the array will become b=[\xe2\x88\x921,\xe2\x88\x922,\xe2\x88\x922,\xe2\x88\x921,0].You have to choose some subset of the given segments (each segment can be chosen at most once) in such a way that if you apply this subset of segments to the array a and obtain the array b then the value nmaxi=1bi\xe2\x88\x92nmini=1bi will be maximum possible.Note that you can choose the empty set.If there are multiple answers, you can print any.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 1800

1108D "Diverse Garland" "constructive algorithms,dp,greedy" "You have a garland consisting of n lamps. Each lamp is colored red, green or blue. The color of the i-th lamp is si (\'R\', \'G\' and \'B\' \xe2\x80\x94 colors of lamps in the garland).You have to recolor some lamps in this garland (recoloring a lamp means changing its initial color to another) in such a way that the obtained garland is diverse.A garland is called diverse if any two adjacent (consecutive) lamps (i.\xe2\x80\x89e. such lamps that the distance between their positions is 1) have distinct colors.In other words, if the obtained garland is t then for each i from 1 to n\xe2\x88\x921 the condition ti\xe2\x89\xa0ti+1 should be satisfied.Among all ways to recolor the initial garland to make it diverse you have to choose one with the minimum number of recolored lamps. If there are multiple optimal solutions, print any of them." 1400

1108C "Nice Garland" "brute force,greedy,math" "You have a garland consisting of n lamps. Each lamp is colored red, green or blue. The color of the i-th lamp is si (\'R\', \'G\' and \'B\' \xe2\x80\x94 colors of lamps in the garland).You have to recolor some lamps in this garland (recoloring a lamp means changing its initial color to another) in such a way that the obtained garland is nice.A garland is called nice if any two lamps of the same color have distance divisible by three between them. I.e. if the obtained garland is t, then for each i,j such that ti=tj should be satisfied |i\xe2\x88\x92j|�mod�3=0. The value |x| means absolute value of x, the operation x�mod�y means remainder of x when divided by y.For example, the following garlands are nice: ""RGBRGBRG"", ""GB"", ""R"", ""GRBGRBG"", ""BRGBRGB"". The following garlands are not nice: ""RR"", ""RGBG"".Among all ways to recolor the initial garland to make it nice you have to choose one with the minimum number of recolored lamps. If there are multiple optimal solutions, print any of them." 1300

1108B "Divisors of Two Integers" "brute force,greedy,math,number theory" "Recently you have received two positive integer numbers x and y. You forgot them, but you remembered a shuffled list containing all divisors of x (including 1 and x) and all divisors of y (including 1 and y). If d is a divisor of both numbers x and y at the same time, there are two occurrences of d in the list.For example, if x=4 and y=6 then the given list can be any permutation of the list [1,2,4,1,2,3,6]. Some of the possible lists are: [1,1,2,4,6,3,2], [4,6,1,1,2,3,2] or [1,6,3,2,4,1,2].Your problem is to restore suitable positive integer numbers x and y that would yield the same list of divisors (possibly in different order).It is guaranteed that the answer exists, i.e. the given list of divisors corresponds to some positive integers x and y." 1100

1108A "Two distinct points" implementation "You are given two segments [l1;r1][l1;r1] and [l2;r2][l2;r2] on the xx-axis. It is guaranteed that l1<r1l1<r1 and l2<r2l2<r2. Segments may intersect, overlap or even coincide with each other.  The example of two segments on the xx-axis. Your problem is to find two integers aa and bb such that l1\xe2\x89\xa4a\xe2\x89\xa4r1l1\xe2\x89\xa4a\xe2\x89\xa4r1, l2\xe2\x89\xa4b\xe2\x89\xa4r2l2\xe2\x89\xa4b\xe2\x89\xa4r2 and a\xe2\x89\xa0ba\xe2\x89\xa0b. In other words, you have to choose two distinct integer points in such a way that the first point belongs to the segment [l1;r1][l1;r1] and the second one belongs to the segment [l2;r2][l2;r2].It is guaranteed that the answer exists. If there are multiple answers, you can print any of them.You have to answer qq independent queries." 800

1107G "Vasya and Maximum Profit" "binary search,constructive algorithms,data structures,dp,dsu" "Vasya got really tired of these credits (from problem F) and now wants to earn the money himself! He decided to make a contest to gain a profit.Vasya has n problems to choose from. They are numbered from 1 to n. The difficulty of the i-th problem is di. Moreover, the problems are given in the increasing order by their difficulties. The difficulties of all tasks are pairwise distinct. In order to add the i-th problem to the contest you need to pay ci burles to its author. For each problem in the contest Vasya gets a burles.In order to create a contest he needs to choose a consecutive subsegment of tasks.So the total earnings for the contest are calculated as follows:   if Vasya takes problem i to the contest, he needs to pay ci to its author;  for each problem in the contest Vasya gets a burles;  let gap(l,r)=maxl\xe2\x89\xa4i<r(di+1\xe2\x88\x92di)2. If Vasya takes all the tasks with indices from l to r to the contest, he also needs to pay gap(l,r). If l=r then gap(l,r)=0. Calculate the maximum profit that Vasya can earn by taking a consecutive segment of tasks." 2400

1107F "Vasya and Endless Credits" "dp,flows,graph matchings,graphs,sortings" "Vasya wants to buy himself a nice new car. Unfortunately, he lacks some money. Currently he has exactly 0 burles.However, the local bank has n credit offers. Each offer can be described with three numbers ai, bi and ki. Offers are numbered from 1 to n. If Vasya takes the i-th offer, then the bank gives him ai burles at the beginning of the month and then Vasya pays bank bi burles at the end of each month for the next ki months (including the month he activated the offer). Vasya can take the offers any order he wants.Each month Vasya can take no more than one credit offer. Also each credit offer can not be used more than once. Several credits can be active at the same time. It implies that Vasya pays bank the sum of bi over all the i of active credits at the end of each month.Vasya wants to buy a car in the middle of some month. He just takes all the money he currently has and buys the car of that exact price.Vasya don\'t really care what he\'ll have to pay the bank back after he buys a car. He just goes out of the country on his car so that the bank can\'t find him anymore.What is the maximum price that car can have?" 2600

1107E "Vasya and Binary String" dp "Vasya has a string s of length n consisting only of digits 0 and 1. Also he has an array a of length n. Vasya performs the following operation until the string becomes empty: choose some consecutive substring of equal characters, erase it from the string and glue together the remaining parts (any of them can be empty). For example, if he erases substring 111 from string 111110 he will get the string 110. Vasya gets ax points for erasing substring of length x.Vasya wants to maximize his total points, so help him with this!" 2400

1107D Compression "dp,implementation,math,number theory" "You are given a binary matrix A of size n\xc3\x97n. Let\'s denote an x-compression of the given matrix as a matrix B of size nx\xc3\x97nx such that for every i\xe2\x88\x88[1,n],j\xe2\x88\x88[1,n] the condition A[i][j]=B[\xe2\x8c\x88ix\xe2\x8c\x89][\xe2\x8c\x88jx\xe2\x8c\x89] is met.Obviously, x-compression is possible only if x divides n, but this condition is not enough. For example, the following matrix of size 2\xc3\x972 does not have any 2-compression: 01   10 For the given matrix A, find maximum x such that an x-compression of this matrix is possible.Note that the input is given in compressed form. But even though it is compressed, you\'d better use fast input." 1800

1107C Brutality "greedy,sortings,two pointers" "You are playing a new famous fighting game: Kortal Mombat XII. You have to perform a brutality on your opponent\'s character.You are playing the game on the new generation console so your gamepad have 26 buttons. Each button has a single lowercase Latin letter from \'a\' to \'z\' written on it. All the letters on buttons are pairwise distinct.You are given a sequence of hits, the i-th hit deals ai units of damage to the opponent\'s character. To perform the i-th hit you have to press the button si on your gamepad. Hits are numbered from 1 to n.You know that if you press some button more than k times in a row then it\'ll break. You cherish your gamepad and don\'t want to break any of its buttons.To perform a brutality you have to land some of the hits of the given sequence. You are allowed to skip any of them, however changing the initial order of the sequence is prohibited. The total damage dealt is the sum of ai over all i for the hits which weren\'t skipped.Note that if you skip the hit then the counter of consecutive presses the button won\'t reset.Your task is to skip some hits to deal the maximum possible total damage to the opponent\'s character and not break your gamepad buttons." 1300

1107B "Digital root" "math,number theory" "Today at the lesson of mathematics, Petya learns about the digital root.The digital root of a non-negative integer is the single digit value obtained by an iterative process of summing digits, on each iteration using the result from the previous iteration to compute a digit sum. The process continues until a single-digit number is reached. Let\'s denote the digital root of x as S(x). Then S(5)=5, S(38)=S(3+8=11)=S(1+1=2)=2, S(10)=S(1+0=1)=1.As a homework Petya got n tasks of the form: find k-th positive number whose digital root is x.Petya has already solved all the problems, but he doesn\'t know if it\'s right. Your task is to solve all n tasks from Petya\'s homework." 1000

1107A "Digits Sequence Dividing" greedy,strings "You are given a sequence s consisting of n digits from 1 to 9.You have to divide it into at least two segments (segment \xe2\x80\x94 is a consecutive sequence of elements) (in other words, you have to place separators between some digits of the sequence) in such a way that each element belongs to exactly one segment and if the resulting division will be represented as an integer numbers sequence then each next element of this sequence will be strictly greater than the previous one.More formally: if the resulting division of the sequence is t1,t2,\xe2\x80\xa6,tk, where k is the number of element in a division, then for each i from 1 to k\xe2\x88\x921 the condition ti<ti+1 (using numerical comparing, it means that the integer representations of strings are compared) should be satisfied.For example, if s=654 then you can divide it into parts [6,54] and it will be suitable division. But if you will divide it into parts [65,4] then it will be bad division because 65>4. If s=123 then you can divide it into parts [1,23], [1,2,3] but not into parts [12,3].Your task is to find any suitable division for each of the q independent queries." 900

1106F "Lunar New Year and a Recursive Sequence" "math,matrices,number theory" "Lunar New Year is approaching, and Bob received a gift from his friend recently \xe2\x80\x94 a recursive sequence! He loves this sequence very much and wants to play with it.Let f1,f2,\xe2\x80\xa6,fi,\xe2\x80\xa6 be an infinite sequence of positive integers. Bob knows that for i>k, fi can be obtained by the following recursive equation:fi=(fb1i\xe2\x88\x921\xe2\x8b\x85fb2i\xe2\x88\x922\xe2\x8b\x85\xe2\x8b\xaf\xe2\x8b\x85fbki\xe2\x88\x92k)modp,which in short isfi=(k\xe2\x88\x8fj=1fbji\xe2\x88\x92j)modp,where p=998244353 (a widely-used prime), b1,b2,\xe2\x80\xa6,bk are known integer constants, and xmody denotes the remainder of x divided by y.Bob lost the values of f1,f2,\xe2\x80\xa6,fk, which is extremely troublesome \xe2\x80\x93 these are the basis of the sequence! Luckily, Bob remembers the first k\xe2\x88\x921 elements of the sequence: f1=f2=\xe2\x80\xa6=fk\xe2\x88\x921=1 and the n-th element: fn=m. Please find any possible value of fk. If no solution exists, just tell Bob that it is impossible to recover his favorite sequence, regardless of Bob\'s sadness." 2400

1106E "Lunar New Year and Red Envelopes" "data structures,dp" "Lunar New Year is approaching, and Bob is going to receive some red envelopes with countless money! But collecting money from red envelopes is a time-consuming process itself.Let\'s describe this problem in a mathematical way. Consider a timeline from time 1 to n. The i-th red envelope will be available from time si to ti, inclusive, and contain wi coins. If Bob chooses to collect the coins in the i-th red envelope, he can do it only in an integer point of time between si and ti, inclusive, and he can\'t collect any more envelopes until time di (inclusive) after that. Here si\xe2\x89\xa4ti\xe2\x89\xa4di holds.Bob is a greedy man, he collects coins greedily \xe2\x80\x94 whenever he can collect coins at some integer time x, he collects the available red envelope with the maximum number of coins. If there are multiple envelopes with the same maximum number of coins, Bob would choose the one whose parameter d is the largest. If there are still multiple choices, Bob will choose one from them randomly.However, Alice \xe2\x80\x94 his daughter \xe2\x80\x94 doesn\'t want her father to get too many coins. She could disturb Bob at no more than m integer time moments. If Alice decides to disturb Bob at time x, he could not do anything at time x and resumes his usual strategy at the time x+1 (inclusive), which may lead to missing some red envelopes.Calculate the minimum number of coins Bob would get if Alice disturbs him optimally." 2100

1106D "Lunar New Year and a Wander" "data structures,dfs and similar,graphs,greedy,shortest paths" "Lunar New Year is approaching, and Bob decides to take a wander in a nearby park.The park can be represented as a connected graph with n nodes and m bidirectional edges. Initially Bob is at the node 1 and he records 1 on his notebook. He can wander from one node to another through those bidirectional edges. Whenever he visits a node not recorded on his notebook, he records it. After he visits all nodes at least once, he stops wandering, thus finally a permutation of nodes a1,a2,\xe2\x80\xa6,an is recorded.Wandering is a boring thing, but solving problems is fascinating. Bob wants to know the lexicographically smallest sequence of nodes he can record while wandering. Bob thinks this problem is trivial, and he wants you to solve it.A sequence x is lexicographically smaller than a sequence y if and only if one of the following holds:   x is a prefix of y, but x\xe2\x89\xa0y (this is impossible in this problem as all considered sequences have the same length);  in the first position where x and y differ, the sequence x has a smaller element than the corresponding element in y." 1500

1106C "Lunar New Year and Number Division" greedy,implementation,math,sortings "Lunar New Year is approaching, and Bob is struggling with his homework \xe2\x80\x93 a number division problem.There are n positive integers a1,a2,\xe2\x80\xa6,an on Bob\'s homework paper, where n is always an even number. Bob is asked to divide those numbers into groups, where each group must contain at least 2 numbers. Suppose the numbers are divided into m groups, and the sum of the numbers in the j-th group is sj. Bob\'s aim is to minimize the sum of the square of sj, that is m\xe2\x88\x91j=1s2j.Bob is puzzled by this hard problem. Could you please help him solve it?" 900

1106B "Lunar New Year and Food Ordering" "data structures,implementation" "Lunar New Year is approaching, and Bob is planning to go for a famous restaurant \xe2\x80\x94 ""Alice\'s"".The restaurant ""Alice\'s"" serves n kinds of food. The cost for the i-th kind is always ci. Initially, the restaurant has enough ingredients for serving exactly ai dishes of the i-th kind. In the New Year\'s Eve, m customers will visit Alice\'s one after another and the j-th customer will order dj dishes of the tj-th kind of food. The (i+1)-st customer will only come after the i-th customer is completely served.Suppose there are ri dishes of the i-th kind remaining (initially ri=ai). When a customer orders 1 dish of the i-th kind, the following principles will be processed. If ri>0, the customer will be served exactly 1 dish of the i-th kind. The cost for the dish is ci. Meanwhile, ri will be reduced by 1. Otherwise, the customer will be served 1 dish of the cheapest available kind of food if there are any. If there are multiple cheapest kinds of food, the one with the smallest index among the cheapest will be served. The cost will be the cost for the dish served and the remain for the corresponding dish will be reduced by 1. If there are no more dishes at all, the customer will leave angrily. Therefore, no matter how many dishes are served previously, the cost for the customer is 0.If the customer doesn\'t leave after the dj dishes are served, the cost for the customer will be the sum of the cost for these dj dishes.Please determine the total cost for each of the m customers." 1500

1106A "Lunar New Year and Cross Counting" implementation "Lunar New Year is approaching, and you bought a matrix with lots of ""crosses"".This matrix M of size n\xc3\x97n contains only \'X\' and \'.\' (without quotes). The element in the i-th row and the j-th column (i,j) is defined as M(i,j), where 1\xe2\x89\xa4i,j\xe2\x89\xa4n. We define a cross appearing in the i-th row and the j-th column (1<i,j<n) if and only if M(i,j)=M(i\xe2\x88\x921,j\xe2\x88\x921)=M(i\xe2\x88\x921,j+1)=M(i+1,j\xe2\x88\x921)=M(i+1,j+1)= \'X\'.The following figure illustrates a cross appearing at position (2,2) in a 3\xc3\x973 matrix. X.X.X.X.X Your task is to find out the number of crosses in the given matrix M. Two crosses are different if and only if they appear in different rows or columns." 800

1105E "Helping Hiasat" "bitmasks,brute force,dp,meet-in-the-middle" "Hiasat registered a new account in NeckoForces and when his friends found out about that, each one of them asked to use his name as Hiasat\'s handle.Luckily for Hiasat, he can change his handle in some points in time. Also he knows the exact moments friends will visit his profile page. Formally, you are given a sequence of events of two types:  1�\xe2\x80\x94 Hiasat can change his handle.  2 s�\xe2\x80\x94 friend s visits Hiasat\'s profile. The friend s will be happy, if each time he visits Hiasat\'s profile his handle would be s.Hiasat asks you to help him, find the maximum possible number of happy friends he can get." 2200

1105D "Kilani and the Game" "dfs and similar,graphs,implementation,shortest paths" "Kilani is playing a game with his friends. This game can be represented as a grid of size n\xc3\x97mn\xc3\x97m, where each cell is either empty or blocked, and every player has one or more castles in some cells (there are no two castles in one cell).The game is played in rounds. In each round players expand turn by turn: firstly, the first player expands, then the second player expands and so on. The expansion happens as follows: for each castle the player owns now, he tries to expand into the empty cells nearby. The player ii can expand from a cell with his castle to the empty cell if it\'s possible to reach it in at most sisi (where sisi is player\'s expansion speed) moves to the left, up, right or down without going through blocked cells or cells occupied by some other player\'s castle. The player examines the set of cells he can expand to and builds a castle in each of them at once. The turned is passed to the next player after that. The game ends when no player can make a move. You are given the game field and speed of the expansion for each player. Kilani wants to know for each player how many cells he will control (have a castle their) after the game ends." 1900

1105C "Ayoub and Lost Array" combinatorics,dp,math "Ayoub had an array aa of integers of size nn and this array had two interesting properties:   All the integers in the array were between ll and rr (inclusive).  The sum of all the elements was divisible by 33. Unfortunately, Ayoub has lost his array, but he remembers the size of the array nn and the numbers ll and rr, so he asked you to find the number of ways to restore the array. Since the answer could be very large, print it modulo 109+7109+7 (i.e. the remainder when dividing by 109+7109+7). In case there are no satisfying arrays (Ayoub has a wrong memory), print 00." 1500

1105B "Zuhair and Strings" "brute force,implementation,strings" "Given a string s of length n and integer k (1\xe2\x89\xa4k\xe2\x89\xa4n). The string s has a level x, if x is largest non-negative integer, such that it\'s possible to find in s:  x non-intersecting (non-overlapping) substrings of length k,  all characters of these x substrings are the same (i.e. each substring contains only one distinct character and this character is the same for all the substrings). A substring is a sequence of consecutive (adjacent) characters, it is defined by two integers i and j (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n), denoted as s[i\xe2\x80\xa6j] = ""sisi+1\xe2\x80\xa6sj"".For example, if k=2, then:  the string ""aabb"" has level 1 (you can select substring ""aa""),  the strings ""zzzz"" and ""zzbzz"" has level 2 (you can select two non-intersecting substrings ""zz"" in each of them),  the strings ""abed"" and ""aca"" have level 0 (you can\'t find at least one substring of the length k=2 containing the only distinct character). Zuhair gave you the integer k and the string s of length n. You need to find x, the level of the string s." 1100

1105A "Salem and Sticks" "brute force,implementation" "Salem gave you n sticks with integer positive lengths a1,a2,\xe2\x80\xa6,an.For every stick, you can change its length to any other positive integer length (that is, either shrink or stretch it). The cost of changing the stick\'s length from a to b is |a\xe2\x88\x92b|, where |x| means the absolute value of x.A stick length ai is called almost good for some integer t if |ai\xe2\x88\x92t|\xe2\x89\xa41.Salem asks you to change the lengths of some sticks (possibly all or none), such that all sticks\' lengths are almost good for some positive integer t and the total cost of changing is minimum possible. The value of t is not fixed in advance and you can choose it as any positive integer. As an answer, print the value of t and the minimum cost. If there are multiple optimal choices for t, print any of them." 1100

1104B "Game with string" "data structures,implementation,math" "Two people are playing a game with a string s, consisting of lowercase latin letters. On a player\'s turn, he should choose two consecutive equal letters in the string and delete them. For example, if the string is equal to ""xaax"" than there is only one possible turn: delete ""aa"", so the string will become ""xx"". A player not able to make a turn loses.Your task is to determine which player will win if both play optimally." 1200

1104A "Splitting into digits" "constructive algorithms,implementation,math" "Vasya has his favourite number n. He wants to split it to some non-zero digits. It means, that he wants to choose some digits d1,d2,\xe2\x80\xa6,dk, such that 1\xe2\x89\xa4di\xe2\x89\xa49 for all i and d1+d2+\xe2\x80\xa6+dk=n.Vasya likes beauty in everything, so he wants to find any solution with the minimal possible number of different digits among d1,d2,\xe2\x80\xa6,dk. Help him!" 800

1103E "Radix sum" "fft,math,number theory" "Let\'s define radix sum of number a consisting of digits a1,\xe2\x80\xa6,ak and number b consisting of digits b1,\xe2\x80\xa6,bk(we add leading zeroes to the shorter number to match longer length) as number s(a,b) consisting of digits (a1+b1)mod10,\xe2\x80\xa6,(ak+bk)mod10. The radix sum of several integers is defined as follows: s(t1,\xe2\x80\xa6,tn)=s(t1,s(t2,\xe2\x80\xa6,tn))You are given an array x1,\xe2\x80\xa6,xn. The task is to compute for each integer i(0\xe2\x89\xa4i<n) number of ways to consequently choose one of the integers from the array n times, so that the radix sum of these integers is equal to i. Calculate these values modulo 258." 3400

1103D "Professional layer" bitmasks,dp "Cardbluff is popular sport game in Telegram. Each Cardbluff player has ever dreamed about entrance in the professional layer. There are n judges now in the layer and you are trying to pass the entrance exam. You have a number k \xe2\x80\x94 your skill in Cardbluff.Each judge has a number ai \xe2\x80\x94 an indicator of uncertainty about your entrance to the professional layer and a number ei \xe2\x80\x94 an experience playing Cardbluff. To pass the exam you need to convince all judges by playing with them. You can play only one game with each judge. As a result of a particular game, you can divide the uncertainty of i-th judge by any natural divisor of ai which is at most k. If GCD of all indicators is equal to 1, you will enter to the professional layer and become a judge.Also, you want to minimize the total amount of spent time. So, if you play with x judges with total experience y you will spend x\xe2\x8b\x85y seconds.Print minimal time to enter to the professional layer or \xe2\x88\x921 if it\'s impossible." 3100

1103C "Johnny Solving" "constructive algorithms,dfs and similar,graphs,math" "Today is tuesday, that means there is a dispute in JOHNNY SOLVING team again: they try to understand who is Johnny and who is Solving. That\'s why guys asked Umnik to help them. Umnik gave guys a connected graph with n vertices without loops and multiedges, such that a degree of any vertex is at least 3, and also he gave a number 1\xe2\x89\xa4k\xe2\x89\xa4n. Because Johnny is not too smart, he promised to find a simple path with length at least nk in the graph. In reply, Solving promised to find k simple by vertices cycles with representatives, such that:   Length of each cycle is at least 3.  Length of each cycle is not divisible by 3.  In each cycle must be a representative - vertex, which belongs only to this cycle among all printed cycles. You need to help guys resolve the dispute, for that you need to find a solution for Johnny: a simple path with length at least nk (n is not necessarily divided by k), or solution for Solving: k cycles that satisfy all the conditions above. If there is no any solution - print \xe2\x88\x921." 2700

1103B "Game with modulo" "binary search,constructive algorithms,interactive" "This is an interactive problem.Vasya and Petya are going to play the following game: Petya has some positive integer number a. After that Vasya should guess this number using the following questions. He can say a pair of non-negative integer numbers (x,y). Petya will answer him:   ""x"", if (xmoda)\xe2\x89\xa5(ymoda).  ""y"", if (xmoda)<(ymoda). We define (xmoda) as a remainder of division x by a.Vasya should guess the number a using no more, than 60 questions.It\'s guaranteed that Petya has a number, that satisfies the inequality 1\xe2\x89\xa4a\xe2\x89\xa4109.Help Vasya playing this game and write a program, that will guess the number a." 2000

1103A "Grid game" "constructive algorithms,implementation" "You are given a 4x4 grid. You play a game�\xe2\x80\x94 there is a sequence of tiles, each of them is either 2x1 or 1x2. Your task is to consequently place all tiles from the given sequence in the grid. When tile is placed, each cell which is located in fully occupied row or column is deleted (cells are deleted at the same time independently). You can place tile in the grid at any position, the only condition is that tiles (and tile parts) should not overlap. Your goal is to proceed all given figures and avoid crossing at any time." 1400

1102F "Elongated Matrix" "binary search,bitmasks,brute force,dp,graphs" "You are given a matrix a, consisting of n rows and m columns. Each cell contains an integer in it.You can change the order of rows arbitrarily (including leaving the initial order), but you can\'t change the order of cells in a row. After you pick some order of rows, you traverse the whole matrix the following way: firstly visit all cells of the first column from the top row to the bottom one, then the same for the second column and so on. During the traversal you write down the sequence of the numbers on the cells in the same order you visited them. Let that sequence be s1,s2,\xe2\x80\xa6,snm. The traversal is k-acceptable if for all i (1\xe2\x89\xa4i\xe2\x89\xa4nm\xe2\x88\x921) |si\xe2\x88\x92si+1|\xe2\x89\xa5k.Find the maximum integer k such that there exists some order of rows of matrix a that it produces a k-acceptable traversal." 2000

1102E "Monotonic Renumeration" combinatorics,sortings "You are given an array a consisting of n integers. Let\'s denote monotonic renumeration of array a as an array b consisting of n integers such that all of the following conditions are met:  b1=0;  for every pair of indices i and j such that 1\xe2\x89\xa4i,j\xe2\x89\xa4n, if ai=aj, then bi=bj (note that if ai\xe2\x89\xa0aj, it is still possible that bi=bj);  for every index i\xe2\x88\x88[1,n\xe2\x88\x921] either bi=bi+1 or bi+1=bi+1. For example, if a=[1,2,1,2,3], then two possible monotonic renumerations of a are b=[0,0,0,0,0] and b=[0,0,0,0,1].Your task is to calculate the number of different monotonic renumerations of a. The answer may be large, so print it modulo 998244353." 1700

1102D "Balanced Ternary String" greedy,strings "You are given a string s consisting of exactly n characters, and each character is either \'0\', \'1\' or \'2\'. Such strings are called ternary strings.Your task is to replace minimum number of characters in this string with other characters to obtain a balanced ternary string (balanced ternary string is a ternary string such that the number of characters \'0\' in this string is equal to the number of characters \'1\', and the number of characters \'1\' (and \'0\' obviously) is equal to the number of characters \'2\').Among all possible balanced ternary strings you have to obtain the lexicographically (alphabetically) smallest.Note that you can neither remove characters from the string nor add characters to the string. Also note that you can replace the given characters only with characters \'0\', \'1\' and \'2\'.It is guaranteed that the answer exists." 1500

1102C "Doors Breaking and Repairing" games "You are policeman and you are playing a game with Slavik. The game is turn-based and each turn consists of two phases. During the first phase you make your move and during the second phase Slavik makes his move.There are n doors, the i-th door initially has durability equal to ai.During your move you can try to break one of the doors. If you choose door i and its current durability is bi then you reduce its durability to max(0,bi\xe2\x88\x92x) (the value x is given).During Slavik\'s move he tries to repair one of the doors. If he chooses door i and its current durability is bi then he increases its durability to bi+y (the value y is given). Slavik cannot repair doors with current durability equal to 0.The game lasts 10100 turns. If some player cannot make his move then he has to skip it.Your goal is to maximize the number of doors with durability equal to 0 at the end of the game. You can assume that Slavik wants to minimize the number of such doors. What is the number of such doors in the end if you both play optimally?" 1200

1102B "Array K-Coloring" greedy,sortings "You are given an array a consisting of n integer numbers.You have to color this array in k colors in such a way that:   Each element of the array should be colored in some color;  For each i from 1 to k there should be at least one element colored in the i-th color in the array;  For each i from 1 to k all elements colored in the i-th color should be distinct. Obviously, such coloring might be impossible. In this case, print ""NO"". Otherwise print ""YES"" and any coloring (i.e. numbers c1,c2,\xe2\x80\xa6cn, where 1\xe2\x89\xa4ci\xe2\x89\xa4k and ci is the color of the i-th element of the given array) satisfying the conditions above. If there are multiple answers, you can print any." 1400

1102A "Integer Sequence Dividing" math "You are given an integer sequence 1,2,\xe2\x80\xa6,n. You have to divide it into two sets A and B in such a way that each element belongs to exactly one set and |sum(A)\xe2\x88\x92sum(B)| is minimum possible.The value |x| is the absolute value of x and sum(S) is the sum of elements of the set S." 800

1101G "(Zero XOR Subset)-less" math,matrices "You are given an array a1,a2,\xe2\x80\xa6,an of integer numbers.Your task is to divide the array into the maximum number of segments in such a way that:  each element is contained in exactly one segment;  each segment contains at least one element;  there doesn\'t exist a non-empty subset of segments such that bitwise XOR of the numbers from them is equal to 0. Print the maximum number of segments the array can be divided into. Print -1 if no suitable division exists." 2300

1101F "Trucks and Cities" "binary search,dp" "There are n cities along the road, which can be represented as a straight line. The i-th city is situated at the distance of ai kilometers from the origin. All cities are situated in the same direction from the origin. There are m trucks travelling from one city to another. Each truck can be described by 4 integers: starting city si, finishing city fi, fuel consumption ci and number of possible refuelings ri. The i-th truck will spend ci litres of fuel per one kilometer. When a truck arrives in some city, it can be refueled (but refueling is impossible in the middle of nowhere). The i-th truck can be refueled at most ri times. Each refueling makes truck\'s gas-tank full. All trucks start with full gas-tank.All trucks will have gas-tanks of the same size V litres. You should find minimum possible V such that all trucks can reach their destinations without refueling more times than allowed." 2400

1101E "Polycarp\'s New Job" implementation "There are n cities along the road, which can be represented as a straight line. The i-th city is situated at the distance of ai kilometers from the origin. All cities are situated in the same direction from the origin. There are m trucks travelling from one city to another. Each truck can be described by 4 integers: starting city si, finishing city fi, fuel consumption ci and number of possible refuelings ri. The i-th truck will spend ci litres of fuel per one kilometer. When a truck arrives in some city, it can be refueled (but refueling is impossible in the middle of nowhere). The i-th truck can be refueled at most ri times. Each refueling makes truck\'s gas-tank full. All trucks start with full gas-tank.All trucks will have gas-tanks of the same size V litres. You should find minimum possible V such that all trucks can reach their destinations without refueling more times than allowed." 1500

1101D "GCD Counting" "data structures,dfs and similar,dp,number theory,trees" "You are given a tree consisting of n vertices. A number is written on each vertex; the number on vertex i is equal to ai.Let\'s denote the function g(x,y) as the greatest common divisor of the numbers written on the vertices belonging to the simple path from vertex x to vertex y (including these two vertices). Also let\'s denote dist(x,y) as the number of vertices on the simple path between vertices x and y, including the endpoints. dist(x,x)=1 for every vertex x.Your task is calculate the maximum value of dist(x,y) among such pairs of vertices that g(x,y)>1." 2000

1101C "Division and Union" sortings "There are n segments [li,ri] for 1\xe2\x89\xa4i\xe2\x89\xa4n. You should divide all segments into two non-empty groups in such way that there is no pair of segments from different groups which have at least one common point, or say that it\'s impossible to do it. Each segment should belong to exactly one group.To optimize testing process you will be given multitest." 1500

1101B Accordion greedy,implementation "An accordion is a string (yes, in the real world accordions are musical instruments, but let\'s forget about it for a while) which can be represented as a concatenation of: an opening bracket (ASCII code 091), a colon (ASCII code 058), some (possibly zero) vertical line characters (ASCII code 124), another colon, and a closing bracket (ASCII code 093). The length of the accordion is the number of characters in it.For example, [::], [:||:] and [:|||:] are accordions having length 4, 6 and 7. (:|:), {:||:}, [:], ]:||:[ are not accordions. You are given a string s. You want to transform it into an accordion by removing some (possibly zero) characters from it. Note that you may not insert new characters or reorder existing ones. Is it possible to obtain an accordion by removing characters from s, and if so, what is the maximum possible length of the result?" 1300

1101A "Minimum Integer" math "You are given q queries in the following form:Given three integers li, ri and di, find minimum positive integer xi such that it is divisible by di and it does not belong to the segment [li,ri].Can you answer all the queries?Recall that a number x belongs to segment [l,r] if l\xe2\x89\xa4x\xe2\x89\xa4r." 1000

1100F "Ivan and Burgers" "data structures,divide and conquer,greedy,math" "Ivan loves burgers and spending money. There are n burger joints on the street where Ivan lives. Ivan has q friends, and the i-th friend suggested to meet at the joint li and walk to the joint ri (li\xe2\x89\xa4ri). While strolling with the i-th friend Ivan can visit all joints x which satisfy li\xe2\x89\xa4x\xe2\x89\xa4ri.For each joint Ivan knows the cost of the most expensive burger in it, it costs ci burles. Ivan wants to visit some subset of joints on his way, in each of them he will buy the most expensive burger and spend the most money. But there is a small issue: his card broke and instead of charging him for purchases, the amount of money on it changes as follows.If Ivan had d burles before the purchase and he spent c burles at the joint, then after the purchase he would have d\xe2\x8a\x95c burles, where \xe2\x8a\x95 denotes the bitwise XOR operation.Currently Ivan has 22100\xe2\x88\x921 burles and he wants to go out for a walk. Help him to determine the maximal amount of burles he can spend if he goes for a walk with the friend i. The amount of burles he spends is defined as the difference between the initial amount on his account and the final account." 2500

1100E "Andrew and Taxi" "binary search,dfs and similar,graphs" "Andrew prefers taxi to other means of transport, but recently most taxi drivers have been acting inappropriately. In order to earn more money, taxi drivers started to drive in circles. Roads in Andrew\'s city are one-way, and people are not necessary able to travel from one part to another, but it pales in comparison to insidious taxi drivers.The mayor of the city decided to change the direction of certain roads so that the taxi drivers wouldn\'t be able to increase the cost of the trip endlessly. More formally, if the taxi driver is on a certain crossroads, they wouldn\'t be able to reach it again if he performs a nonzero trip. Traffic controllers are needed in order to change the direction the road goes. For every road it is known how many traffic controllers are needed to change the direction of the road to the opposite one. It is allowed to change the directions of roads one by one, meaning that each traffic controller can participate in reversing two or more roads.You need to calculate the minimum number of traffic controllers that you need to hire to perform the task and the list of the roads that need to be reversed." 2200

1100D "Dasha and Chess" "constructive algorithms,games,interactive" "This is an interactive task.Dasha and NN like playing chess. While playing a match they decided that normal chess isn\'t interesting enough for them, so they invented a game described below.There are 666 black rooks and 1 white king on the chess board of size 999\xc3\x97999. The white king wins if he gets checked by rook, or, in other words, if he moves onto the square which shares either a row or column with a black rook.The sides take turns, starting with white. NN plays as a white king and on each of his turns he moves a king to one of the squares that are adjacent to his current position either by side or diagonally, or, formally, if the king was on the square (x,y), it can move to the square (nx,ny) if and only max(|nx\xe2\x88\x92x|,|ny\xe2\x88\x92y|)=1 , 1\xe2\x89\xa4nx,ny\xe2\x89\xa4999. NN is also forbidden from moving onto the squares occupied with black rooks, however, he can move onto the same row or column as a black rook.Dasha, however, neglects playing by the chess rules, and instead of moving rooks normally she moves one of her rooks on any space devoid of other chess pieces. It is also possible that the rook would move onto the same square it was before and the position wouldn\'t change. However, she can\'t move the rook on the same row or column with the king.Each player makes 2000 turns, if the white king wasn\'t checked by a black rook during those turns, black wins. NN doesn\'t like losing, but thinks the task is too difficult for him, so he asks you to write a program that will always win playing for the white king. Note that Dasha can see your king and play depending on its position." 2500

1100C "NN and the Optical Illusion" "binary search,geometry,math" "NN is an experienced internet user and that means he spends a lot of time on the social media. Once he found the following image on the Net, which asked him to compare the sizes of inner circles:  It turned out that the circles are equal. NN was very surprised by this fact, so he decided to create a similar picture himself.He managed to calculate the number of outer circles nn and the radius of the inner circle rr. NN thinks that, using this information, you can exactly determine the radius of the outer circles RR so that the inner circle touches all of the outer ones externally and each pair of neighboring outer circles also touches each other. While NN tried very hard to guess the required radius, he didn\'t manage to do that. Help NN find the required radius for building the required picture." 1200

1100B "Build a Contest" "data structures,implementation" "Arkady coordinates rounds on some not really famous competitive programming platform. Each round features n problems of distinct difficulty, the difficulties are numbered from 1 to n.To hold a round Arkady needs n new (not used previously) problems, one for each difficulty. As for now, Arkady creates all the problems himself, but unfortunately, he can\'t just create a problem of a desired difficulty. Instead, when he creates a problem, he evaluates its difficulty from 1 to n and puts it into the problems pool.At each moment when Arkady can choose a set of n new problems of distinct difficulties from the pool, he holds a round with these problems and removes them from the pool. Arkady always creates one problem at a time, so if he can hold a round after creating a problem, he immediately does it.You are given a sequence of problems\' difficulties in the order Arkady created them. For each problem, determine whether Arkady held the round right after creating this problem, or not. Initially the problems pool is empty." 1300

1100A "Roman and Browser" implementation "This morning, Roman woke up and opened the browser with n opened tabs numbered from 1 to n. There are two kinds of tabs: those with the information required for the test and those with social network sites. Roman decided that there are too many tabs open so he wants to close some of them.He decided to accomplish this by closing every k-th (2\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x921) tab. Only then he will decide whether he wants to study for the test or to chat on the social networks. Formally, Roman will choose one tab (let its number be b) and then close all tabs with numbers c=b+i\xe2\x8b\x85k that satisfy the following condition: 1\xe2\x89\xa4c\xe2\x89\xa4n and i is an integer (it may be positive, negative or zero).For example, if k=3, n=14 and Roman chooses b=8, then he will close tabs with numbers 2, 5, 8, 11 and 14.After closing the tabs Roman will calculate the amount of remaining tabs with the information for the test (let\'s denote it e) and the amount of remaining social network tabs (s). Help Roman to calculate the maximal absolute value of the difference of those values |e\xe2\x88\x92s| so that it would be easy to decide what to do next." 1000

1099F Cookies "binary search,data structures,dfs and similar,dp,games,trees" "Mitya and Vasya are playing an interesting game. They have a rooted tree with nn vertices, and the vertices are indexed from 11 to nn. The root has index 11. Every other vertex i\xe2\x89\xa52i\xe2\x89\xa52 has its parent pipi, and vertex ii is called a child of vertex pipi.There are some cookies in every vertex of the tree: there are xixi cookies in vertex ii. It takes exactly titi time for Mitya to eat one cookie in vertex ii. There is also a chip, which is initially located in the root of the tree, and it takes lili time to move the chip along the edge connecting vertex ii with its parent.Mitya and Vasya take turns playing, Mitya goes first.  Mitya moves the chip from the vertex, where the chip is located, to one of its children.  Vasya can remove an edge from the vertex, where the chip is located, to one of its children. Vasya can also decide to skip his turn.   Mitya can stop the game at any his turn. Once he stops the game, he moves the chip up to the root, eating some cookies along his way. Mitya can decide how many cookies he would like to eat in every vertex on his way. The total time spent on descend, ascend and eating cookies should not exceed TT. Please note that in the end of the game the chip is always located in the root of the tree: Mitya can not leave the chip in any other vertex, even if he has already eaten enough cookies�\xe2\x80\x94 he must move the chip back to the root (and every move from vertex vv to its parent takes lvlv time).Find out what is the maximum number of cookies Mitya can eat, regardless of Vasya\'s actions." 2400

1099C Postcard "constructive algorithms,implementation" "Andrey received a postcard from Irina. It contained only the words ""Hello, Andrey!"", and a strange string consisting of lowercase Latin letters, snowflakes and candy canes. Andrey thought that this string is an encrypted message, and decided to decrypt it.Andrey noticed that snowflakes and candy canes always stand after the letters, so he supposed that the message was encrypted as follows. Candy cane means that the letter before it can be removed, or can be left. A snowflake means that the letter before it can be removed, left, or repeated several times.For example, consider the following string:   This string can encode the message \xc2\xabhappynewyear\xc2\xbb. For this, candy canes and snowflakes should be used as follows:   candy cane 1: remove the letter w,  snowflake 1: repeat the letter p twice,  candy cane 2: leave the letter n,  snowflake 2: remove the letter w,  snowflake 3: leave the letter e.   Please note that the same string can encode different messages. For example, the string above can encode \xc2\xabhayewyar\xc2\xbb, \xc2\xabhapppppynewwwwwyear\xc2\xbb, and other messages.Andrey knows that messages from Irina usually have a length of kk letters. Help him to find out if a given string can encode a message of kk letters, and if so, give an example of such a message." 1200

1099B "Squares and Segments" "binary search,constructive algorithms,math" "Little Sofia is in fourth grade. Today in the geometry lesson she learned about segments and squares. On the way home, she decided to draw nn squares in the snow with a side length of 11. For simplicity, we assume that Sofia lives on a plane and can draw only segments of length 11, parallel to the coordinate axes, with vertices at integer points.In order to draw a segment, Sofia proceeds as follows. If she wants to draw a vertical segment with the coordinates of the ends (x,y)(x,y) and (x,y+1)(x,y+1). Then Sofia looks if there is already a drawn segment with the coordinates of the ends (x\xe2\x80\xb2,y)(x\xe2\x80\xb2,y) and (x\xe2\x80\xb2,y+1)(x\xe2\x80\xb2,y+1) for some x\xe2\x80\xb2x\xe2\x80\xb2. If such a segment exists, then Sofia quickly draws a new segment, using the old one as a guideline. If there is no such segment, then Sofia has to take a ruler and measure a new segment for a long time. Same thing happens when Sofia wants to draw a horizontal segment, but only now she checks for the existence of a segment with the same coordinates xx, x+1x+1 and the differing coordinate yy.For example, if Sofia needs to draw one square, she will have to draw two segments using a ruler:   After that, she can draw the remaining two segments, using the first two as a guide:   If Sofia needs to draw two squares, she will have to draw three segments using a ruler:   After that, she can draw the remaining four segments, using the first three as a guide:   Sofia is in a hurry, so she wants to minimize the number of segments that she will have to draw with a ruler without a guide. Help her find this minimum number." 1100

1099A Snowball implementation "Today\'s morning was exceptionally snowy. Meshanya decided to go outside and noticed a huge snowball rolling down the mountain! Luckily, there are two stones on that mountain.Initially, snowball is at height hh and it has weight ww. Each second the following sequence of events happens: snowball\'s weights increases by ii, where ii�\xe2\x80\x94 is the current height of snowball, then snowball hits the stone (if it\'s present at the current height), then snowball moves one meter down. If the snowball reaches height zero, it stops.There are exactly two stones on the mountain. First stone has weight u1u1 and is located at height d1d1, the second one�\xe2\x80\x94 u2u2 and d2d2 respectively. When the snowball hits either of two stones, it loses weight equal to the weight of that stone. If after this snowball has negative weight, then its weight becomes zero, but the snowball continues moving as before.  Find the weight of the snowball when it stops moving, that is, it reaches height�0." 800

1098F \xd0\x96-function "string suffix structures,strings" "Today\'s morning was exceptionally snowy. Meshanya decided to go outside and noticed a huge snowball rolling down the mountain! Luckily, there are two stones on that mountain.Initially, snowball is at height hh and it has weight ww. Each second the following sequence of events happens: snowball\'s weights increases by ii, where ii�\xe2\x80\x94 is the current height of snowball, then snowball hits the stone (if it\'s present at the current height), then snowball moves one meter down. If the snowball reaches height zero, it stops.There are exactly two stones on the mountain. First stone has weight u1u1 and is located at height d1d1, the second one�\xe2\x80\x94 u2u2 and d2d2 respectively. When the snowball hits either of two stones, it loses weight equal to the weight of that stone. If after this snowball has negative weight, then its weight becomes zero, but the snowball continues moving as before.  Find the weight of the snowball when it stops moving, that is, it reaches height�0." 3500

1098E "Fedya the Potter" "binary search,implementation,math,number theory" "Fedya loves problems involving data structures. Especially ones about different queries on subsegments. Fedya had a nice array a1,a2,\xe2\x80\xa6an and a beautiful data structure. This data structure, given l and r, 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, could find the greatest integer d, such that d divides each of al, al+1, ..., ar. Fedya really likes this data structure, so he applied it to every non-empty contiguous subarray of array a, put all answers into the array and sorted it. He called this array b. It\'s easy to see that array b contains n(n+1)/2 elements.After that, Fedya implemented another cool data structure, that allowed him to find sum bl+bl+1+\xe2\x80\xa6+br for given l and r, 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n(n+1)/2. Surely, Fedya applied this data structure to every contiguous subarray of array b, called the result c and sorted it. Help Fedya find the lower median of array c.Recall that for a sorted array of length k the lower median is an element at position \xe2\x8c\x8ak+12\xe2\x8c\x8b, if elements of the array are enumerated starting from 1. For example, the lower median of array (1,1,2,3,6) is 2, and the lower median of (0,17,23,96) is 17." 3400

1098D Eels "data structures" "Vasya is a big fish lover, and his parents gave him an aquarium for the New Year. Vasya does not have a degree in ichthyology, so he thinks that filling a new aquarium with eels is a good idea. Unfortunately, eels are predators, so Vasya decided to find out how dangerous this idea was.Getting into one aquarium, eels fight each other until exactly one fish remains. When two eels fight, the big one eats the smaller one (if their weights are equal, then one of them will still eat the other). Namely, let n eels be initially in an aquarium, and the i-th of them have a weight of xi. Then n\xe2\x88\x921 battles will occur between them, as a result of which, only one eel will survive. In a battle of two eels with weights a and b, where a\xe2\x89\xa4b, eel of weight a will be eaten and disappear from the aquarium, and eel of weight b will increase its weight to a+b.A battle between two eels with weights a and b, where a\xe2\x89\xa4b, is considered dangerous if b\xe2\x89\xa42a. For a given set of eels, danger is defined as the maximum number of dangerous battles that can occur among these eels if they are placed in one aquarium.Now Vasya is planning, which eels he wants to put into an aquarium. He has some set of eels (initially empty). He makes a series of operations with this set. With each operation, he either adds one eel in the set, or removes one eel from the set. Vasya asks you to calculate the danger of the current set of eels after each operation." 2800

1098C "Construct a tree" "binary search,constructive algorithms,dfs and similar,graphs,greedy,trees" "Misha walked through the snowy forest and he was so fascinated by the trees to decide to draw his own tree!Misha would like to construct a rooted tree with n vertices, indexed from 1 to n, where the root has index 1. Every other vertex has a parent pi, and i is called a child of vertex pi. Vertex u belongs to the subtree of vertex v iff v is reachable from u while iterating over the parents (u, pu, ppu, ...). Clearly, v belongs to its own subtree, and the number of vertices in the subtree is called the size of the subtree. Misha is only interested in trees where every vertex belongs to the subtree of vertex 1.Below there is a tree with 6 vertices. The subtree of vertex 2 contains vertices 2, 3, 4, 5. Hence the size of its subtree is 4.   The branching coefficient of the tree is defined as the maximum number of children in any vertex. For example, for the tree above the branching coefficient equals 2. Your task is to construct a tree with n vertices such that the sum of the subtree sizes for all vertices equals s, and the branching coefficient is minimum possible." 2400

1098B "Nice table" "brute force,constructive algorithms,greedy,math" "You are given an n\xc3\x97m table, consisting of characters \xc2\xabA\xc2\xbb, \xc2\xabG\xc2\xbb, \xc2\xabC\xc2\xbb, \xc2\xabT\xc2\xbb. Let\'s call a table nice, if every 2\xc3\x972 square contains all four distinct characters. Your task is to find a nice table (also consisting of \xc2\xabA\xc2\xbb, \xc2\xabG\xc2\xbb, \xc2\xabC\xc2\xbb, \xc2\xabT\xc2\xbb), that differs from the given table in the minimum number of characters." 2100

1098A "Sum in the tree" "constructive algorithms,dfs and similar,greedy,trees" "Mitya has a rooted tree with n vertices indexed from 1 to n, where the root has index 1. Each vertex v initially had an integer number av\xe2\x89\xa50 written on it. For every vertex v Mitya has computed sv: the sum of all values written on the vertices on the path from vertex v to the root, as well as hv�\xe2\x80\x94 the depth of vertex v, which denotes the number of vertices on the path from vertex v to the root. Clearly, s1=a1 and h1=1.Then Mitya erased all numbers av, and by accident he also erased all values sv for vertices with even depth (vertices with even hv). Your task is to restore the values av for every vertex, or determine that Mitya made a mistake. In case there are multiple ways to restore the values, you\'re required to find one which minimizes the total sum of values av for all vertices in the tree." 1600

1097H "Mateusz and an Infinite Sequence" "bitmasks,brute force,dp,strings" "A Thue-Morse-Radecki-Mateusz sequence (Thorse-Radewoosh sequence in short) is an infinite sequence constructed from a finite sequence gen of length d and an integer m, obtained in the following sequence of steps:  In the beginning, we define the one-element sequence M0=(0). In the k-th step, k\xe2\x89\xa51, we define the sequence Mk to be the concatenation of the d copies of Mk\xe2\x88\x921. However, each of them is altered slightly \xe2\x80\x94 in the i-th of them (1\xe2\x89\xa4i\xe2\x89\xa4d), each element x is changed to (x+geni)(modm). For instance, if we pick gen=(0,1,2) and m=4:   M0=(0),  M1=(0,1,2),  M2=(0,1,2,1,2,3,2,3,0),  M3=(0,1,2,1,2,3,2,3,0,1,2,3,2,3,0,3,0,1,2,3,0,3,0,1,0,1,2), and so on. As you can see, as long as the first element of gen is 0, each consecutive step produces a sequence whose prefix is the sequence generated in the previous step. Therefore, we can define the infinite Thorse-Radewoosh sequence M\xe2\x88\x9e as the sequence obtained by applying the step above indefinitely. For the parameters above, M\xe2\x88\x9e=(0,1,2,1,2,3,2,3,0,1,2,3,2,3,0,3,0,1,\xe2\x80\xa6).Mateusz picked a sequence gen and an integer m, and used them to obtain a Thorse-Radewoosh sequence M\xe2\x88\x9e. He then picked two integers l, r, and wrote down a subsequence of this sequence A:=((M\xe2\x88\x9e)l,(M\xe2\x88\x9e)l+1,\xe2\x80\xa6,(M\xe2\x88\x9e)r).Note that we use the 1-based indexing both for M\xe2\x88\x9e and A.Mateusz has his favorite sequence B with length n, and would like to see how large it is compared to A. Let\'s say that B majorizes sequence X of length n (let\'s denote it as B\xe2\x89\xa5X) if and only if for all i\xe2\x88\x88{1,2,\xe2\x80\xa6,n}, we have Bi\xe2\x89\xa5Xi.He now asks himself how many integers x in the range [1,|A|\xe2\x88\x92n+1] there are such that B\xe2\x89\xa5(Ax,Ax+1,Ax+2,\xe2\x80\xa6,Ax+n\xe2\x88\x921). As both sequences were huge, answering the question using only his pen and paper turned out to be too time-consuming. Can you help him automate his research?" 3400

1097G "Vladislav and a Great Legend" combinatorics,dp,trees "A great legend used to be here, but some troll hacked Codeforces and erased it. Too bad for us, but in the troll society he earned a title of an ultimate-greatest-over troll. At least for them, it\'s something good. And maybe a formal statement will be even better for us?You are given a tree T with n vertices numbered from 1 to n. For every non-empty subset X of vertices of T, let f(X) be the minimum number of edges in the smallest connected subtree of T which contains every vertex from X.You\'re also given an integer k. You need to compute the sum of (f(X))k among all non-empty subsets of vertices, that is:\xe2\x88\x91X\xe2\x8a\x86{1,2,\xe2\x80\xa6,n},X\xe2\x89\xa0\xe2\x88\x85(f(X))k.As the result might be very large, output it modulo 109+7." 3000

1097F "Alex and a TV Show" "bitmasks,combinatorics,number theory" "Alex decided to try his luck in TV shows. He once went to the quiz named ""What\'s That Word?!"". After perfectly answering the questions ""How is a pseudonym commonly referred to in the Internet?"" (""Um... a nick?""), ""After which famous inventor we name the unit of the magnetic field strength?"" (""Um... Nikola Tesla?"") and ""Which rock band performs ""How You Remind Me""?"" (""Um... Nickelback?""), he decided to apply to a little bit more difficult TV show: ""What\'s in This Multiset?!"".The rules of this TV show are as follows: there are nn multisets numbered from 11 to nn. Each of them is initially empty. Then, qq events happen; each of them is in one of the four possible types:  1 x v \xe2\x80\x94 set the xx-th multiset to a singleton {v}{v}. 2 x y z \xe2\x80\x94 set the xx-th multiset to a union of the yy-th and the zz-th multiset. For example: {1,3}\xe2\x88\xaa{1,4,4}={1,1,3,4,4}{1,3}\xe2\x88\xaa{1,4,4}={1,1,3,4,4}. 3 x y z \xe2\x80\x94 set the xx-th multiset to a product of the yy-th and the zz-th multiset. The product A\xc3\x97BA\xc3\x97B of two multisets AA, BB is defined as {gcd(a,b)\xe2\x88\xa3a\xe2\x88\x88A,b\xe2\x88\x88B}{gcd(a,b)\xe2\x88\xa3a\xe2\x88\x88A,b\xe2\x88\x88B}, where gcd(p,q)gcd(p,q) is the greatest common divisor of pp and qq. For example: {2,2,3}\xc3\x97{1,4,6}={1,2,2,1,2,2,1,1,3}{2,2,3}\xc3\x97{1,4,6}={1,2,2,1,2,2,1,1,3}. 4 x v \xe2\x80\x94 the participant is asked how many times number vv occurs in the xx-th multiset. As the quiz turned out to be too hard in the past, participants should now give the answers modulo 22 only. Note, that xx, yy and zz described above are not necessarily different. In events of types 22 and 33, the sum or the product is computed first, and then the assignment is performed.Alex is confused by the complicated rules of the show. Can you help him answer the requests of the 44-th type?" 2500

1097E "Egor and an RPG game" "constructive algorithms,greedy" "One Saturday afternoon Egor was playing his favorite RPG game. While discovering new lands and territories, he came across the following sign:  Egor is a passionate player, but he is an algorithmician as well. That\'s why he instantly spotted four common letters in two words on the sign above�\xe2\x80\x94 if we permute the letters ""R"", ""E"", ""G"", ""O"" from the first word, we can obtain the letters ""O"", ""G"", ""R"", ""E"". Egor got inspired by the sign and right away he came up with a problem about permutations.You are given a permutation of length nn. You have to split it into some non-empty subsequences so that each element of the permutation belongs to exactly one subsequence. Each subsequence must be monotonic�\xe2\x80\x94 that is, either increasing or decreasing.Sequence is called to be a subsequence if it can be derived from permutation by deleting some (possibly none) elements without changing the order of the remaining elements.The number of subsequences should be small enough�\xe2\x80\x94 let f(n)f(n) be the minimum integer kk such that every permutation of length nn can be partitioned into at most kk monotonic subsequences.You need to split the permutation into at most f(n)f(n) monotonic subsequences." 3400

1097D "Makoto and a Blackboard" "dp,math,number theory,probabilities" "Makoto has a big blackboard with a positive integer n written on it. He will perform the following action exactly k times:Suppose the number currently written on the blackboard is v. He will randomly pick one of the divisors of v (possibly 1 and v) and replace v with this divisor. As Makoto uses his famous random number generator (RNG) and as he always uses 58 as his generator seed, each divisor is guaranteed to be chosen with equal probability.He now wonders what is the expected value of the number written on the blackboard after k steps.It can be shown that this value can be represented as PQ where P and Q are coprime integers and Q\xe2\x89\xa20(mod109+7). Print the value of P\xe2\x8b\x85Q\xe2\x88\x921 modulo 109+7." 2200

1097C "Yuhao and a Parenthesis" greedy,implementation "One day, Yuhao came across a problem about checking if some bracket sequences are correct bracket sequences.A bracket sequence is any non-empty sequence of opening and closing parentheses. A bracket sequence is called a correct bracket sequence if it\'s possible to obtain a correct arithmetic expression by inserting characters ""+"" and ""1"" into this sequence. For example, the sequences ""(())()"", ""()"" and ""(()(()))"" are correct, while the bracket sequences "")("", ""(()"" and ""(()))("" are not correct.Yuhao found this problem too simple for him so he decided to make the problem harder. You are given many (not necessarily correct) bracket sequences. The task is to connect some of them into ordered pairs so that each bracket sequence occurs in at most one pair and the concatenation of the bracket sequences in each pair is a correct bracket sequence. The goal is to create as many pairs as possible.This problem unfortunately turned out to be too difficult for Yuhao. Can you help him and solve it?" 1400

1097B "Petr and a Combination Lock" "bitmasks,brute force,dp" "Petr has just bought a new car. He\'s just arrived at the most known Petersburg\'s petrol station to refuel it when he suddenly discovered that the petrol tank is secured with a combination lock! The lock has a scale of 360 degrees and a pointer which initially points at zero:  Petr called his car dealer, who instructed him to rotate the lock\'s wheel exactly n times. The i-th rotation should be ai degrees, either clockwise or counterclockwise, and after all n rotations the pointer should again point at zero.This confused Petr a little bit as he isn\'t sure which rotations should be done clockwise and which should be done counterclockwise. As there are many possible ways of rotating the lock, help him and find out whether there exists at least one, such that after all n rotations the pointer will point at zero again." 1200

1097A "Gennady and a Card Game" "brute force,implementation" "Gennady owns a small hotel in the countryside where he lives a peaceful life. He loves to take long walks, watch sunsets and play cards with tourists staying in his hotel. His favorite game is called ""Mau-Mau"".To play Mau-Mau, you need a pack of 52 cards. Each card has a suit (Diamonds \xe2\x80\x94 D, Clubs \xe2\x80\x94 C, Spades \xe2\x80\x94 S, or Hearts \xe2\x80\x94 H), and a rank (2, 3, 4, 5, 6, 7, 8, 9, T, J, Q, K, or A).At the start of the game, there is one card on the table and you have five cards in your hand. You can play a card from your hand if and only if it has the same rank or the same suit as the card on the table.In order to check if you\'d be a good playing partner, Gennady has prepared a task for you. Given the card on the table and five cards in your hand, check if you can play at least one card." 800

1096G "Lucky Tickets" "divide and conquer,dp,fft" "All bus tickets in Berland have their numbers. A number consists of n digits (n is even). Only k decimal digits d1,d2,\xe2\x80\xa6,dk can be used to form ticket numbers. If 0 is among these digits, then numbers may have leading zeroes. For example, if n=4 and only digits 0 and 4 can be used, then 0000, 4004, 4440 are valid ticket numbers, and 0002, 00, 44443 are not.A ticket is lucky if the sum of first n/2 digits is equal to the sum of remaining n/2 digits. Calculate the number of different lucky tickets in Berland. Since the answer may be big, print it modulo 998244353." 2400

1096F "Inversion Expectation" dp,math,probabilities "A permutation of size n is an array of size n such that each integer from 1 to n occurs exactly once in this array. An inversion in a permutation p is a pair of indices (i,j) such that i>j and ai<aj. For example, a permutation [4,1,3,2] contains 4 inversions: (2,1), (3,1), (4,1), (4,3).You are given a permutation p of size n. However, the numbers on some positions are replaced by \xe2\x88\x921. Let the valid permutation be such a replacement of \xe2\x88\x921 in this sequence back to numbers from 1 to n in such a way that the resulting sequence is a permutation of size n.The given sequence was turned into a valid permutation randomly with the equal probability of getting each valid permutation.Calculate the expected total number of inversions in the resulting valid permutation.It can be shown that it is in the form of PQ where P and Q are non-negative integers and Q\xe2\x89\xa00. Report the value of P\xe2\x8b\x85Q\xe2\x88\x921(mod998244353)." 2300

1096E "The Top Scorer" combinatorics,dp,math,probabilities "Hasan loves playing games and has recently discovered a game called TopScore. In this soccer-like game there are p players doing penalty shoot-outs. Winner is the one who scores the most. In case of ties, one of the top-scorers will be declared as the winner randomly with equal probability.They have just finished the game and now are waiting for the result. But there\'s a tiny problem! The judges have lost the paper of scores! Fortunately they have calculated sum of the scores before they get lost and also for some of the players they have remembered a lower bound on how much they scored. However, the information about the bounds is private, so Hasan only got to know his bound.According to the available data, he knows that his score is at least r and sum of the scores is s.Thus the final state of the game can be represented in form of sequence of p integers a1,a2,\xe2\x80\xa6,ap (0\xe2\x89\xa4ai) \xe2\x80\x94 player\'s scores. Hasan is player number 1, so a1\xe2\x89\xa5r. Also a1+a2+\xe2\x8b\xaf+ap=s. Two states are considered different if there exists some position i such that the value of ai differs in these states. Once again, Hasan doesn\'t know the exact scores (he doesn\'t know his exact score as well). So he considers each of the final states to be equally probable to achieve.Help Hasan find the probability of him winning.It can be shown that it is in the form of PQ where P and Q are non-negative integers and Q\xe2\x89\xa00, P\xe2\x89\xa4Q. Report the value of P\xe2\x8b\x85Q\xe2\x88\x921(mod998244353)." 2500

1096D "Easy Problem" dp "Vasya is preparing a contest, and now he has written a statement for an easy problem. The statement is a string of length n consisting of lowercase Latin latters. Vasya thinks that the statement can be considered hard if it contains a subsequence hard; otherwise the statement is easy. For example, hard, hzazrzd, haaaaard can be considered hard statements, while har, hart and drah are easy statements. Vasya doesn\'t want the statement to be hard. He may remove some characters from the statement in order to make it easy. But, of course, some parts of the statement can be crucial to understanding. Initially the ambiguity of the statement is 0, and removing i-th character increases the ambiguity by ai (the index of each character is considered as it was in the original statement, so, for example, if you delete character r from hard, and then character d, the index of d is still 4 even though you delete it from the string had).Vasya wants to calculate the minimum ambiguity of the statement, if he removes some characters (possibly zero) so that the statement is easy. Help him to do it!Recall that subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements." 1800

1096C "Polygon for the Angle" "brute force,geometry" "You are given an angle angang. The Jury asks You to find such regular nn-gon (regular polygon with nn vertices) that it has three vertices aa, bb and cc (they can be non-consecutive) with \xe2\x88\xa0abc=ang\xe2\x88\xa0abc=ang or report that there is no such nn-gon.  If there are several answers, print the minimal one. It is guarantied that if answer exists then it doesn\'t exceed 998244353998244353." 1600

1096B "Substring Removal" combinatorics,math,strings "You are given a string s of length n consisting only of lowercase Latin letters.A substring of a string is a contiguous subsequence of that string. So, string ""forces"" is substring of string ""codeforces"", but string ""coder"" is not.Your task is to calculate the number of ways to remove exactly one substring from this string in such a way that all remaining characters are equal (the number of distinct characters either zero or one).It is guaranteed that there is at least two different characters in s.Note that you can remove the whole string and it is correct. Also note that you should remove at least one character.Since the answer can be rather large (not very large though) print it modulo 998244353.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 1300

1096A "Find Divisible" greedy,implementation,math "You are given a range of positive integers from l to r.Find such a pair of integers (x,y) that l\xe2\x89\xa4x,y\xe2\x89\xa4r, x\xe2\x89\xa0y and x divides y.If there are multiple answers, print any of them.You are also asked to answer T independent queries." 800

1095F "Make It Connected" dsu,graphs,greedy "You are given an undirected graph consisting of n vertices. A number is written on each vertex; the number on vertex i is ai. Initially there are no edges in the graph.You may add some edges to this graph, but you have to pay for them. The cost of adding an edge between vertices x and y is ax+ay coins. There are also m special offers, each of them is denoted by three numbers x, y and w, and means that you can add an edge connecting vertices x and y and pay w coins for it. You don\'t have to use special offers: if there is a pair of vertices x and y that has a special offer associated with it, you still may connect these two vertices paying ax+ay coins for it.What is the minimum number of coins you have to spend to make the graph connected? Recall that a graph is connected if it\'s possible to get from any vertex to any other vertex using only the edges belonging to this graph." 1900

1095E "Almost Regular Bracket Sequence" implementation "You are given a bracket sequence s consisting of n opening \'(\' and closing \')\' brackets.A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters \'1\' and \'+\' between the original characters of the sequence. For example, bracket sequences ""()()"", ""(())"" are regular (the resulting expressions are: ""(1)+(1)"", ""((1+1)+1)""), and "")("" and ""("" are not.You can change the type of some bracket si. It means that if si= \')\' then you can change it to \'(\' and vice versa.Your task is to calculate the number of positions i such that if you change the type of the i-th bracket, then the resulting bracket sequence becomes regular." 1900

1095D "Circular Dance" implementation "There are nn kids, numbered from 11 to nn, dancing in a circle around the Christmas tree. Let\'s enumerate them in a clockwise direction as p1p1, p2p2, ..., pnpn (all these numbers are from 11 to nn and are distinct, so pp is a permutation). Let the next kid for a kid pipi be kid pi+1pi+1 if i<ni<n and p1p1 otherwise. After the dance, each kid remembered two kids: the next kid (let\'s call him xx) and the next kid for xx. Each kid told you which kids he/she remembered: the kid ii remembered kids ai,1ai,1 and ai,2ai,2. However, the order of ai,1ai,1 and ai,2ai,2 can differ from their order in the circle.  Example: 5 kids in a circle, p=[3,2,4,1,5]p=[3,2,4,1,5] (or any cyclic shift). The information kids remembered is: a1,1=3a1,1=3, a1,2=5a1,2=5; a2,1=1a2,1=1, a2,2=4a2,2=4; a3,1=2a3,1=2, a3,2=4a3,2=4; a4,1=1a4,1=1, a4,2=5a4,2=5; a5,1=2a5,1=2, a5,2=3a5,2=3. You have to restore the order of the kids in the circle using this information. If there are several answers, you may print any. It is guaranteed that at least one solution exists.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 1600

1095C "Powers Of Two" bitmasks,greedy "A positive integer x is called a power of two if it can be represented as x=2y, where y is a non-negative integer. So, the powers of two are 1,2,4,8,16,\xe2\x80\xa6.You are given two positive integers n and k. Your task is to represent n as the sum of exactly k powers of two." 1400

1095B "Array Stabilization" implementation "You are given an array a consisting of n integer numbers.Let instability of the array be the following value: nmaxi=1ai\xe2\x88\x92nmini=1ai.You have to remove exactly one element from this array to minimize instability of the resulting (n\xe2\x88\x921)-elements array. Your task is to calculate the minimum possible instability." 900

1095A "Repeating Cipher" implementation "Polycarp loves ciphers. He has invented his own cipher called repeating.Repeating cipher is used for strings. To encrypt the string s=s1s2\xe2\x80\xa6sm (1\xe2\x89\xa4m\xe2\x89\xa410), Polycarp uses the following algorithm:  he writes down s1 ones,  he writes down s2 twice,  he writes down s3 three times,  ...  he writes down sm m times. For example, if s=""bab"" the process is: ""b"" \xe2\x86\x92 ""baa"" \xe2\x86\x92 ""baabbb"". So the encrypted s=""bab"" is ""baabbb"".Given string t \xe2\x80\x94 the result of encryption of some string s. Your task is to decrypt it, i.\xe2\x80\x89e. find the string s." 800

1093G "Multidimensional Queries" "bitmasks,data structures" "You are given an array a of n points in k-dimensional space. Let the distance between two points ax and ay be k\xe2\x88\x91i=1|ax,i\xe2\x88\x92ay,i| (it is also known as Manhattan distance).You have to process q queries of the following two types: 1 i b1 b2 ... bk \xe2\x80\x94 set i-th element of a to the point (b1,b2,\xe2\x80\xa6,bk); 2 l r \xe2\x80\x94 find the maximum distance between two points ai and aj, where l\xe2\x89\xa4i,j\xe2\x89\xa4r." 2300

1093F "Vasya and Array" dp "Vasya has got an array consisting of n integers, and two integers k and len in addition. All numbers in the array are either between 1 and k (inclusive), or equal to \xe2\x88\x921. The array is good if there is no segment of len consecutive equal numbers.Vasya will replace each \xe2\x88\x921 with some number from 1 to k (inclusive) in such a way that the resulting array is good. Tell him the number of ways to do this replacement. Since the answer may be large, print it modulo 998244353." 2400

1093E "Intersection of Permutations" "data structures" "You are given two permutations a and b, both consisting of n elements. Permutation of n elements is such a integer sequence that each value from 1 to n appears exactly once in it.You are asked to perform two types of queries with them:  1�la�ra�lb�rb \xe2\x80\x94 calculate the number of values which appear in both segment [la;ra] of positions in permutation a and segment [lb;rb] of positions in permutation b;  2�x�y \xe2\x80\x94 swap values on positions x and y in permutation b. Print the answer for each query of the first type.It is guaranteed that there will be at least one query of the first type in the input." 2400

1093D "Beautiful Graph" "dfs and similar,graphs" "You are given an undirected unweighted graph consisting of n vertices and m edges.You have to write a number on each vertex of the graph. Each number should be 1, 2 or 3. The graph becomes beautiful if for each edge the sum of numbers on vertices connected by this edge is odd.Calculate the number of possible ways to write numbers 1, 2 and 3 on vertices so the graph becomes beautiful. Since this number may be large, print it modulo 998244353.Note that you have to write exactly one number on each vertex.The graph does not have any self-loops or multiple edges." 1700

1093C "Mishka and the Last Exam" greedy "Mishka is trying really hard to avoid being kicked out of the university. In particular, he was doing absolutely nothing for the whole semester, miraculously passed some exams so that just one is left.There were n classes of that subject during the semester and on i-th class professor mentioned some non-negative integer ai to the students. It turned out, the exam was to tell the whole sequence back to the professor. Sounds easy enough for those who attended every class, doesn\'t it?Obviously Mishka didn\'t attend any classes. However, professor left some clues on the values of a to help out students like Mishka:   a was sorted in non-decreasing order (a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4an);  n was even;  the following sequence b, consisting of n2 elements, was formed and given out to students: bi=ai+an\xe2\x88\x92i+1. Professor also mentioned that any sequence a, which produces sequence b with the presented technique, will be acceptable.Help Mishka to pass that last exam. Restore any sorted sequence a of non-negative integers, which produces sequence b with the presented technique. It is guaranteed that there exists at least one correct sequence a, which produces the given sequence b." 1300

1093B "Letters Rearranging" "constructive algorithms,greedy,sortings,strings" "You are given a string s consisting only of lowercase Latin letters.You can rearrange all letters of this string as you wish. Your task is to obtain a good string by rearranging the letters of the given string or report that it is impossible to do it.Let\'s call a string good if it is not a palindrome. Palindrome is a string which is read from left to right the same as from right to left. For example, strings ""abacaba"", ""aa"" and ""z"" are palindromes and strings ""bba"", ""xd"" are not.You have to answer t independent queries." 900

1093A "Dice Rolling" math "Mishka got a six-faced dice. It has integer numbers from 2 to 7 written on its faces (all numbers on faces are different, so this is an almost usual dice).Mishka wants to get exactly x points by rolling his dice. The number of points is just a sum of numbers written at the topmost face of the dice for all the rolls Mishka makes.Mishka doesn\'t really care about the number of rolls, so he just wants to know any number of rolls he can make to be able to get exactly x points for them. Mishka is very lucky, so if the probability to get x points with chosen number of rolls is non-zero, he will be able to roll the dice in such a way. Your task is to print this number. It is guaranteed that at least one answer exists.Mishka is also very curious about different number of points to score so you have to answer t independent queries." 800

1092F "Tree with Maximum Cost" "dfs and similar,dp,trees" "You are given a tree consisting exactly of nn vertices. Tree is a connected undirected graph with n\xe2\x88\x921n\xe2\x88\x921 edges. Each vertex vv of this tree has a value avav assigned to it.Let dist(x,y)dist(x,y) be the distance between the vertices xx and yy. The distance between the vertices is the number of edges on the simple path between them.Let\'s define the cost of the tree as the following value: firstly, let\'s fix some vertex of the tree. Let it be vv. Then the cost of the tree is \xe2\x88\x91i=1ndist(i,v)\xe2\x8b\x85ai\xe2\x88\x91i=1ndist(i,v)\xe2\x8b\x85ai.Your task is to calculate the maximum possible cost of the tree if you can choose vv arbitrarily." 1900

1092E "Minimal Diameter Forest" "constructive algorithms,dfs and similar,greedy,trees" "You are given a forest \xe2\x80\x94 an undirected graph with n vertices such that each its connected component is a tree.The diameter (aka ""longest shortest path"") of a connected undirected graph is the maximum number of edges in the shortest path between any pair of its vertices.You task is to add some edges (possibly zero) to the graph so that it becomes a tree and the diameter of the tree is minimal possible.If there are multiple correct answers, print any of them." 2000

1092D2 "Great Vova Wall (Version 2)" "data structures,implementation" "Vova\'s family is building the Great Vova Wall (named by Vova himself). Vova\'s parents, grandparents, grand-grandparents contributed to it. Now it\'s totally up to Vova to put the finishing touches.The current state of the wall can be respresented by a sequence a of n integers, with ai being the height of the i-th part of the wall.Vova can only use 2\xc3\x971 bricks to put in the wall (he has infinite supply of them, however).Vova can put bricks only horizontally on the neighbouring parts of the wall of equal height. It means that if for some i the current height of part i is the same as for part i+1, then Vova can put a brick there and thus increase both heights by 1. Obviously, Vova can\'t put bricks in such a way that its parts turn out to be off the borders (to the left of part 1 of the wall or to the right of part n of it).Note that Vova can\'t put bricks vertically.Vova is a perfectionist, so he considers the wall completed when:  all parts of the wall has the same height;  the wall has no empty spaces inside it. Can Vova complete the wall using any amount of bricks (possibly zero)?" 2200

1092D1 "Great Vova Wall (Version 1)" greedy,implementation,math "Vova\'s family is building the Great Vova Wall (named by Vova himself). Vova\'s parents, grandparents, grand-grandparents contributed to it. Now it\'s totally up to Vova to put the finishing touches.The current state of the wall can be respresented by a sequence a of n integers, with ai being the height of the i-th part of the wall.Vova can only use 2\xc3\x971 bricks to put in the wall (he has infinite supply of them, however).Vova can put bricks horizontally on the neighboring parts of the wall of equal height. It means that if for some i the current height of part i is the same as for part i+1, then Vova can put a brick there and thus increase both heights by 1. Obviously, Vova can\'t put bricks in such a way that its parts turn out to be off the borders (to the left of part 1 of the wall or to the right of part n of it).The next paragraph is specific to the version 1 of the problem.Vova can also put bricks vertically. That means increasing height of any part of the wall by 2.Vova is a perfectionist, so he considers the wall completed when:  all parts of the wall has the same height;  the wall has no empty spaces inside it. Can Vova complete the wall using any amount of bricks (possibly zero)?" 2200

1092C "Prefixes and Suffixes" strings "Ivan wants to play a game with you. He picked some string s of length n consisting only of lowercase Latin letters. You don\'t know this string. Ivan has informed you about all its improper prefixes and suffixes (i.e. prefixes and suffixes of lengths from 1 to n\xe2\x88\x921), but he didn\'t tell you which strings are prefixes and which are suffixes.Ivan wants you to guess which of the given 2n\xe2\x88\x922 strings are prefixes of the given string and which are suffixes. It may be impossible to guess the string Ivan picked (since multiple strings may give the same set of suffixes and prefixes), but Ivan will accept your answer if there is at least one string that is consistent with it. Let the game begin!" 1700

1092B "Teams Forming" sortings "There are n students in a university. The number of students is even. The i-th student has programming skill equal to ai. The coach wants to form n2 teams. Each team should consist of exactly two students, and each student should belong to exactly one team. Two students can form a team only if their skills are equal (otherwise they cannot understand each other and cannot form a team).Students can solve problems to increase their skill. One solved problem increases the skill by one.The coach wants to know the minimum total number of problems students should solve to form exactly n2 teams (i.e. each pair of students should form a team). Your task is to find this number." 800

1092A "Uniform String" implementation "You are given two integers n and k.Your task is to construct such a string s of length n that for each i from 1 to k there is at least one i-th letter of the Latin alphabet in this string (the first letter is \'a\', the second is \'b\' and so on) and there are no other letters except these. You have to maximize the minimal frequency of some letter (the frequency of a letter is the number of occurrences of this letter in a string). If there are several possible answers, you can print any.You have to answer t independent queries." 800

1091H "New Year and the Tricolore Recreation" games "Alice and Bob play a game on a grid with n rows and infinitely many columns. In each row, there are three tokens, blue, white and red one. Before the game starts and after every move, the following two conditions must hold:   Any two tokens are not in the same cell.  In each row, the blue token is to the left of the white token, and the red token is to the right of the white token. First, they pick a positive integer f, whose value is valid for the whole game. Second, the starting player is chosen and makes his or her first turn. Then players take alternating turns. The player who is unable to make a move loses. During a move, a player first selects an integer k that is either a prime number or a product of two (not necessarily distinct) primes. The smallest possible values of k are thus 2,3,4,5,6,7,9,10,11,13,14,15,17,19,\xe2\x80\xa6. Furthermore, k must not be equal to the previously picked integer f. Each turn, a move is performed in exactly one of the rows.If it is Alice\'s turn, she chooses a single blue token and moves it k cells to the right. Alternatively, she may move both the blue and the white token in the same row by the same amount k to the right.On the other hand, Bob selects a single red token and moves it k cells to the left. Similarly, he may also move the white and the red token in the corresponding row by k to the left.Note that Alice may never move a red token, while Bob may never move a blue one. Remember that after a move, the two conditions on relative positions of the tokens must still hold. Both players play optimally. Given the initial state of the board, determine who wins for two games: if Alice starts and if Bob starts." 3200

1091G "New Year and the Factorisation Collaboration" "interactive,math,number theory" "Integer factorisation is hard. The RSA Factoring Challenge offered $100000 for factoring RSA-1024, a 1024-bit long product of two prime numbers. To this date, nobody was able to claim the prize. We want you to factorise a 1024-bit number.Since your programming language of choice might not offer facilities for handling large integers, we will provide you with a very simple calculator. To use this calculator, you can print queries on the standard output and retrieve the results from the standard input. The operations are as follows:   + x y where x and y are integers between 0 and n\xe2\x88\x921. Returns (x+y)modn.  - x y where x and y are integers between 0 and n\xe2\x88\x921. Returns (x\xe2\x88\x92y)modn.  * x y where x and y are integers between 0 and n\xe2\x88\x921. Returns (x\xe2\x8b\x85y)modn.  / x y where x and y are integers between 0 and n\xe2\x88\x921 and y is coprime with n. Returns (x\xe2\x8b\x85y\xe2\x88\x921)modn where y\xe2\x88\x921 is multiplicative inverse of y modulo n. If y is not coprime with n, then \xe2\x88\x921 is returned instead.  sqrt x where x is integer between 0 and n\xe2\x88\x921 coprime with n. Returns y such that y2modn=x. If there are multiple such integers, only one of them is returned. If there are none, \xe2\x88\x921 is returned instead.  ^ x y where x and y are integers between 0 and n\xe2\x88\x921. Returns xymodn. Find the factorisation of n that is a product of between 2 and 10 distinct prime numbers, all of form 4x+3 for some integer x.Because of technical issues, we restrict number of requests to 100." 3200

1091F "New Year and the Mallard Expedition" "constructive algorithms,greedy" "Bob is a duck. He wants to get to Alice\'s nest, so that those two can duck!  Duck is the ultimate animal! (Image courtesy of See Bang) The journey can be represented as a straight line, consisting of nn segments. Bob is located to the left of the first segment, while Alice\'s nest is on the right of the last segment. Each segment has a length in meters, and also terrain type: grass, water or lava. Bob has three movement types: swimming, walking and flying. He can switch between them or change his direction at any point in time (even when he is located at a non-integer coordinate), and doing so doesn\'t require any extra time. Bob can swim only on the water, walk only on the grass and fly over any terrain. Flying one meter takes 11 second, swimming one meter takes 33 seconds, and finally walking one meter takes 55 seconds.Bob has a finite amount of energy, called stamina. Swimming and walking is relaxing for him, so he gains 11 stamina for every meter he walks or swims. On the other hand, flying is quite tiring, and he spends 11 stamina for every meter flown. Staying in place does not influence his stamina at all. Of course, his stamina can never become negative. Initially, his stamina is zero.What is the shortest possible time in which he can reach Alice\'s nest?" 2600

1091E "New Year and the Acquaintance Estimation" "binary search,data structures,graphs,greedy,implementation,math,sortings" "Bob is an active user of the social network Faithbug. On this network, people are able to engage in a mutual friendship. That is, if a is a friend of b, then b is also a friend of a. Each user thus has a non-negative amount of friends.This morning, somebody anonymously sent Bob the following link: graph realization problem and Bob wants to know who that was. In order to do that, he first needs to know how the social network looks like. He investigated the profile of every other person on the network and noted down the number of his friends. However, he neglected to note down the number of his friends. Help him find out how many friends he has. Since there may be many possible answers, print all of them." 2400

1091D "New Year and the Permutation Concatenation" combinatorics,dp,math "Let n be an integer. Consider all permutations on integers 1 to n in lexicographic order, and concatenate them into one big sequence p. For example, if n=3, then p=[1,2,3,1,3,2,2,1,3,2,3,1,3,1,2,3,2,1]. The length of this sequence will be n\xe2\x8b\x85n!.Let 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x8b\x85n! be a pair of indices. We call the sequence (pi,pi+1,\xe2\x80\xa6,pj\xe2\x88\x921,pj) a subarray of p. Its length is defined as the number of its elements, i.e., j\xe2\x88\x92i+1. Its sum is the sum of all its elements, i.e., \xe2\x88\x91jk=ipk. You are given n. Find the number of subarrays of p of length n having sum n(n+1)2. Since this number may be large, output it modulo 998244353 (a prime number)." 1700

1091C "New Year and the Sphere Transmission" "math,number theory" "There are nn people sitting in a circle, numbered from 11 to nn in the order in which they are seated. That is, for all ii from 11 to n\xe2\x88\x921n\xe2\x88\x921, the people with id ii and i+1i+1 are adjacent. People with id nn and 11 are adjacent as well.The person with id 11 initially has a ball. He picks a positive integer kk at most nn, and passes the ball to his kk-th neighbour in the direction of increasing ids, that person passes the ball to his kk-th neighbour in the same direction, and so on until the person with the id 11 gets the ball back. When he gets it back, people do not pass the ball any more.For instance, if n=6n=6 and k=4k=4, the ball is passed in order [1,5,3,1][1,5,3,1]. Consider the set of all people that touched the ball. The fun value of the game is the sum of the ids of people that touched it. In the above example, the fun value would be 1+5+3=91+5+3=9.Find and report the set of possible fun values for all choices of positive integer kk. It can be shown that under the constraints of the problem, the ball always gets back to the 11-st player after finitely many steps, and there are no more than 105105 possible fun values for given nn." 1400

1091B "New Year and the Treasure Geolocation" "brute force,constructive algorithms,greedy,implementation" "Bob is a pirate looking for the greatest treasure the world has ever seen. The treasure is located at the point T, which coordinates to be found out.Bob travelled around the world and collected clues of the treasure location at n obelisks. These clues were in an ancient language, and he has only decrypted them at home. Since he does not know which clue belongs to which obelisk, finding the treasure might pose a challenge. Can you help him?As everyone knows, the world is a two-dimensional plane. The i-th obelisk is at integer coordinates (xi,yi). The j-th clue consists of 2 integers (aj,bj) and belongs to the obelisk pj, where p is some (unknown) permutation on n elements. It means that the treasure is located at T=(xpj+aj,ypj+bj). This point T is the same for all clues.In other words, each clue belongs to exactly one of the obelisks, and each obelisk has exactly one clue that belongs to it. A clue represents the vector from the obelisk to the treasure. The clues must be distributed among the obelisks in such a way that they all point to the same position of the treasure.Your task is to find the coordinates of the treasure. If there are multiple solutions, you may print any of them.Note that you don\'t need to find the permutation. Permutations are used only in order to explain the problem." 1200

1091A "New Year and the Christmas Ornament" "brute force,implementation,math" "Alice and Bob are decorating a Christmas Tree. Alice wants only 3 types of ornaments to be used on the Christmas Tree: yellow, blue and red. They have y yellow ornaments, b blue ornaments and r red ornaments.In Bob\'s opinion, a Christmas Tree will be beautiful if:  the number of blue ornaments used is greater by exactly 1 than the number of yellow ornaments, and  the number of red ornaments used is greater by exactly 1 than the number of blue ornaments. That is, if they have 8 yellow ornaments, 13 blue ornaments and 9 red ornaments, we can choose 4 yellow, 5 blue and 6 red ornaments (5=4+1 and 6=5+1).Alice wants to choose as many ornaments as possible, but she also wants the Christmas Tree to be beautiful according to Bob\'s opinion.In the example two paragraphs above, we would choose 7 yellow, 8 blue and 9 red ornaments. If we do it, we will use 7+8+9=24 ornaments. That is the maximum number.Since Alice and Bob are busy with preparing food to the New Year\'s Eve, they are asking you to find out the maximum number of ornaments that can be used in their beautiful Christmas Tree! It is guaranteed that it is possible to choose at least 6 (1+2+3=6) ornaments." 800

1090M "The Pleasant Walk" implementation "There are n houses along the road where Anya lives, each one is painted in one of k possible colors.Anya likes walking along this road, but she doesn\'t like when two adjacent houses at the road have the same color. She wants to select a long segment of the road such that no two adjacent houses have the same color.Help Anya find the longest segment with this property." 1000

1090L "Berland University" greedy,math "There are n houses along the road where Anya lives, each one is painted in one of k possible colors.Anya likes walking along this road, but she doesn\'t like when two adjacent houses at the road have the same color. She wants to select a long segment of the road such that no two adjacent houses have the same color.Help Anya find the longest segment with this property." 2000

1090K "Right Expansion Of The Mind" math "There are n houses along the road where Anya lives, each one is painted in one of k possible colors.Anya likes walking along this road, but she doesn\'t like when two adjacent houses at the road have the same color. She wants to select a long segment of the road such that no two adjacent houses have the same color.Help Anya find the longest segment with this property." 2000

1090J "Two Prefixes" strings "Misha didn\'t do his math homework for today\'s lesson once again. As a punishment, his teacher Dr. Andrew decided to give him a hard, but very useless task.Dr. Andrew has written two strings s and t of lowercase English letters at the blackboard. He reminded Misha that prefix of a string is a string formed by removing several (possibly none) of its last characters, and a concatenation of two strings is a string formed by appending the second string to the right of the first string.The teacher asked Misha to write down on the blackboard all strings that are the concatenations of some non-empty prefix of s and some non-empty prefix of t. When Misha did it, Dr. Andrew asked him how many distinct strings are there. Misha spent almost the entire lesson doing that and completed the task. Now he asks you to write a program that would do this task automatically." 2600

1090I "Minimal Product" NA "Misha didn\'t do his math homework for today\'s lesson once again. As a punishment, his teacher Dr. Andrew decided to give him a hard, but very useless task.Dr. Andrew has written two strings s and t of lowercase English letters at the blackboard. He reminded Misha that prefix of a string is a string formed by removing several (possibly none) of its last characters, and a concatenation of two strings is a string formed by appending the second string to the right of the first string.The teacher asked Misha to write down on the blackboard all strings that are the concatenations of some non-empty prefix of s and some non-empty prefix of t. When Misha did it, Dr. Andrew asked him how many distinct strings are there. Misha spent almost the entire lesson doing that and completed the task. Now he asks you to write a program that would do this task automatically." 2000

1090H Linearization graphs "Misha didn\'t do his math homework for today\'s lesson once again. As a punishment, his teacher Dr. Andrew decided to give him a hard, but very useless task.Dr. Andrew has written two strings s and t of lowercase English letters at the blackboard. He reminded Misha that prefix of a string is a string formed by removing several (possibly none) of its last characters, and a concatenation of two strings is a string formed by appending the second string to the right of the first string.The teacher asked Misha to write down on the blackboard all strings that are the concatenations of some non-empty prefix of s and some non-empty prefix of t. When Misha did it, Dr. Andrew asked him how many distinct strings are there. Misha spent almost the entire lesson doing that and completed the task. Now he asks you to write a program that would do this task automatically." 2900

1090G Combostone games,implementation "Misha didn\'t do his math homework for today\'s lesson once again. As a punishment, his teacher Dr. Andrew decided to give him a hard, but very useless task.Dr. Andrew has written two strings s and t of lowercase English letters at the blackboard. He reminded Misha that prefix of a string is a string formed by removing several (possibly none) of its last characters, and a concatenation of two strings is a string formed by appending the second string to the right of the first string.The teacher asked Misha to write down on the blackboard all strings that are the concatenations of some non-empty prefix of s and some non-empty prefix of t. When Misha did it, Dr. Andrew asked him how many distinct strings are there. Misha spent almost the entire lesson doing that and completed the task. Now he asks you to write a program that would do this task automatically." 2500

1090F "How to Learn You Score" "constructive algorithms,interactive" "Misha didn\'t do his math homework for today\'s lesson once again. As a punishment, his teacher Dr. Andrew decided to give him a hard, but very useless task.Dr. Andrew has written two strings s and t of lowercase English letters at the blackboard. He reminded Misha that prefix of a string is a string formed by removing several (possibly none) of its last characters, and a concatenation of two strings is a string formed by appending the second string to the right of the first string.The teacher asked Misha to write down on the blackboard all strings that are the concatenations of some non-empty prefix of s and some non-empty prefix of t. When Misha did it, Dr. Andrew asked him how many distinct strings are there. Misha spent almost the entire lesson doing that and completed the task. Now he asks you to write a program that would do this task automatically." 2600

1090E "Horseback Riding" flows,graphs "Misha didn\'t do his math homework for today\'s lesson once again. As a punishment, his teacher Dr. Andrew decided to give him a hard, but very useless task.Dr. Andrew has written two strings s and t of lowercase English letters at the blackboard. He reminded Misha that prefix of a string is a string formed by removing several (possibly none) of its last characters, and a concatenation of two strings is a string formed by appending the second string to the right of the first string.The teacher asked Misha to write down on the blackboard all strings that are the concatenations of some non-empty prefix of s and some non-empty prefix of t. When Misha did it, Dr. Andrew asked him how many distinct strings are there. Misha spent almost the entire lesson doing that and completed the task. Now he asks you to write a program that would do this task automatically." 2300

1090D "Similar Arrays" "constructive algorithms" "Vasya had an array of n integers, each element of the array was from 1 to n. He chose m pairs of different positions and wrote them down to a sheet of paper. Then Vasya compared the elements at these positions, and wrote down the results of the comparisons to another sheet of paper. For each pair he wrote either ""greater"", ""less"", or ""equal"".After several years, he has found the first sheet of paper, but he couldn\'t find the second one. Also he doesn\'t remember the array he had. In particular, he doesn\'t remember if the array had equal elements. He has told this sad story to his informatics teacher Dr Helen.She told him that it could be the case that even if Vasya finds his second sheet, he would still not be able to find out whether the array had two equal elements. Now Vasya wants to find two arrays of integers, each of length n. All elements of the first array must be distinct, and there must be two equal elements in the second array. For each pair of positions Vasya wrote at the first sheet of paper, the result of the comparison must be the same for the corresponding elements of the first array, and the corresponding elements of the second array. Help Vasya find two such arrays of length n, or find out that there are no such arrays for his sets of pairs." 1800

1090C "New Year Presents" "constructive algorithms,data structures" "Santa has prepared boxes with presents for n kids, one box for each kid. There are m kinds of presents: balloons, sweets, chocolate bars, toy cars... A child would be disappointed to receive two presents of the same kind, so all kinds of presents in one box are distinct.Having packed all the presents, Santa realized that different boxes can contain different number of presents. It would be unfair to the children, so he decided to move some presents between boxes, and make their sizes similar. After all movements, the difference between the maximal and the minimal number of presents in a box must be as small as possible. All presents in each box should still be distinct. Santa wants to finish the job as fast as possible, so he wants to minimize the number of movements required to complete the task.Given the sets of presents in each box, find the shortest sequence of movements of presents between boxes that minimizes the difference of sizes of the smallest and the largest box, and keeps all presents in each box distinct." 2400

1090B "LaTeX Expert" NA "Santa has prepared boxes with presents for n kids, one box for each kid. There are m kinds of presents: balloons, sweets, chocolate bars, toy cars... A child would be disappointed to receive two presents of the same kind, so all kinds of presents in one box are distinct.Having packed all the presents, Santa realized that different boxes can contain different number of presents. It would be unfair to the children, so he decided to move some presents between boxes, and make their sizes similar. After all movements, the difference between the maximal and the minimal number of presents in a box must be as small as possible. All presents in each box should still be distinct. Santa wants to finish the job as fast as possible, so he wants to minimize the number of movements required to complete the task.Given the sets of presents in each box, find the shortest sequence of movements of presents between boxes that minimizes the difference of sizes of the smallest and the largest box, and keeps all presents in each box distinct." 1900

1090A "Company Merging" greedy "A conglomerate consists of n companies. To make managing easier, their owners have decided to merge all companies into one. By law, it is only possible to merge two companies, so the owners plan to select two companies, merge them into one, and continue doing so until there is only one company left.But anti-monopoly service forbids to merge companies if they suspect unfriendly absorption. The criterion they use is the difference in maximum salaries between two companies. Merging is allowed only if the maximum salaries are equal.To fulfill the anti-monopoly requirements, the owners can change salaries in their companies before merging. But the labor union insists on two conditions: it is only allowed to increase salaries, moreover all the employees in one company must get the same increase.Sure enough, the owners want to minimize the total increase of all salaries in all companies. Help them find the minimal possible increase that will allow them to merge companies into one." 1300

1089M Minegraphed "constructive algorithms,graphs" "A conglomerate consists of n companies. To make managing easier, their owners have decided to merge all companies into one. By law, it is only possible to merge two companies, so the owners plan to select two companies, merge them into one, and continue doing so until there is only one company left.But anti-monopoly service forbids to merge companies if they suspect unfriendly absorption. The criterion they use is the difference in maximum salaries between two companies. Merging is allowed only if the maximum salaries are equal.To fulfill the anti-monopoly requirements, the owners can change salaries in their companies before merging. But the labor union insists on two conditions: it is only allowed to increase salaries, moreover all the employees in one company must get the same increase.Sure enough, the owners want to minimize the total increase of all salaries in all companies. Help them find the minimal possible increase that will allow them to merge companies into one." 2400

1089L Lazyland NA "The kingdom of Lazyland is the home to nn idlers. These idlers are incredibly lazy and create many problems to their ruler, the mighty King of Lazyland. Today kk important jobs for the kingdom (k\xe2\x89\xa4nk\xe2\x89\xa4n) should be performed. Every job should be done by one person and every person can do at most one job. The King allowed every idler to choose one job they wanted to do and the ii-th idler has chosen the job aiai. Unfortunately, some jobs may not be chosen by anyone, so the King has to persuade some idlers to choose another job. The King knows that it takes bibi minutes to persuade the ii-th idler. He asked his minister of labour to calculate the minimum total time he needs to spend persuading the idlers to get all the jobs done. Can you help him?" 900

1089K "King Kog\'s Reception" "data structures" "The kingdom of Lazyland is the home to nn idlers. These idlers are incredibly lazy and create many problems to their ruler, the mighty King of Lazyland. Today kk important jobs for the kingdom (k\xe2\x89\xa4nk\xe2\x89\xa4n) should be performed. Every job should be done by one person and every person can do at most one job. The King allowed every idler to choose one job they wanted to do and the ii-th idler has chosen the job aiai. Unfortunately, some jobs may not be chosen by anyone, so the King has to persuade some idlers to choose another job. The King knows that it takes bibi minutes to persuade the ii-th idler. He asked his minister of labour to calculate the minimum total time he needs to spend persuading the idlers to get all the jobs done. Can you help him?" 2400

1089J "JS Minification" greedy,implementation "International Coding Procedures Company (ICPC) writes all its code in Jedi Script (JS) programming language. JS does not get compiled, but is delivered for execution in its source form. Sources contain comments, extra whitespace (including trailing and leading spaces), and other non-essential features that make them quite large but do not contribute to the semantics of the code, so the process of minification is performed on source files before their delivery to execution to compress sources while preserving their semantics.You are hired by ICPC to write JS minifier for ICPC. Fortunately, ICPC adheres to very strict programming practices and their JS sources are quite restricted in grammar. They work only on integer algorithms and do not use floating point numbers and strings. Every JS source contains a sequence of lines. Each line contains zero or more tokens that can be separated by spaces. On each line, a part of the line that starts with a hash character (\'#\' code 35), including the hash character itself, is treated as a comment and is ignored up to the end of the line.Each line is parsed into a sequence of tokens from left to right by repeatedly skipping spaces and finding the longest possible token starting at the current parsing position, thus transforming the source code into a sequence of tokens. All the possible tokens are listed below:  A reserved token is any kind of operator, separator, literal, reserved word, or a name of a library function that should be preserved during the minification process. Reserved tokens are fixed strings of non-space ASCII characters that do not contain the hash character (\'#\' code 35). All reserved tokens are given as an input to the minification process.  A number token consists of a sequence of digits, where a digit is a character from zero (\'0\') to nine (\'9\') inclusive.  A word token consists of a sequence of characters from the following set: lowercase letters, uppercase letters, digits, underscore (\'_\' code 95), and dollar sign (\'$\' code 36). A word does not start with a digit. Note, that during parsing the longest sequence of characters that satisfies either a number or a word definition, but that appears in the list of reserved tokens, is considered to be a reserved token instead.During the minification process words are renamed in a systematic fashion using the following algorithm:  Take a list of words that consist only of lowercase letters ordered first by their length, then lexicographically: ""a"", ""b"", ..., ""z"", ""aa"", ""ab"", ..., excluding reserved tokens, since they are not considered to be words. This is the target word list.  Rename the first word encountered in the input token sequence to the first word in the target word list and all further occurrences of the same word in the input token sequence, too. Rename the second new word encountered in the input token sequence to the second word in the target word list, and so on. The goal of the minification process is to convert the given source to the shortest possible line (counting spaces) that still parses to the same sequence of tokens with the correspondingly renamed words using these JS parsing rules." 3200

1089I "Interval-Free Permutations" combinatorics "Consider a permutation p1,p2,\xe2\x80\xa6pn of integers from 1 to n. We call a sub-segment pl,pl+1,\xe2\x80\xa6,pr\xe2\x88\x921,pr of the permutation an interval if it is a reordering of some set of consecutive integers. For example, the permutation (6,7,1,8,5,3,2,4) has the intervals (6,7), (5,3,2,4), (3,2), and others. Each permutation has some trivial intervals�\xe2\x80\x94 the full permutation itself and every single element. We call a permutation interval-free if it does not have non-trivial intervals. In other words, interval-free permutation does not have intervals of length between 2 and n\xe2\x88\x921 inclusive. Your task is to count the number of interval-free permutations of length n modulo prime number p." 2600

1089H "Harder Satisfiability" "2-sat,dfs and similar,graphs" "Consider a permutation p1,p2,\xe2\x80\xa6pn of integers from 1 to n. We call a sub-segment pl,pl+1,\xe2\x80\xa6,pr\xe2\x88\x921,pr of the permutation an interval if it is a reordering of some set of consecutive integers. For example, the permutation (6,7,1,8,5,3,2,4) has the intervals (6,7), (5,3,2,4), (3,2), and others. Each permutation has some trivial intervals�\xe2\x80\x94 the full permutation itself and every single element. We call a permutation interval-free if it does not have non-trivial intervals. In other words, interval-free permutation does not have intervals of length between 2 and n\xe2\x88\x921 inclusive. Your task is to count the number of interval-free permutations of length n modulo prime number p." 3400

1089G "Guest Student" math "Berland State University invites people from all over the world as guest students. You can come to the capital of Berland and study with the best teachers in the country.Berland State University works every day of the week, but classes for guest students are held on the following schedule. You know the sequence of seven integers a1,a2,\xe2\x80\xa6,a7 (ai=0 or ai=1):  a1=1 if and only if there are classes for guest students on Sundays;  a2=1 if and only if there are classes for guest students on Mondays;  ...   a7=1 if and only if there are classes for guest students on Saturdays. The classes for guest students are held in at least one day of a week.You want to visit the capital of Berland and spend the minimum number of days in it to study k days as a guest student in Berland State University. Write a program to find the length of the shortest continuous period of days to stay in the capital to study exactly k days as a guest student." 1500

1089F Fractions math "You are given a positive integer n.Find a sequence of fractions aibi, i=1\xe2\x80\xa6k (where ai and bi are positive integers) for some k such that:{bi�divides�n,�1<bi<n�for�i=1\xe2\x80\xa6k1\xe2\x89\xa4ai<bi�for�i=1\xe2\x80\xa6kk\xe2\x88\x91i=1aibi=1\xe2\x88\x921n" 1900

1089E "Easy Chess" "constructive algorithms" "You are given a positive integer n.Find a sequence of fractions aibi, i=1\xe2\x80\xa6k (where ai and bi are positive integers) for some k such that:{bi�divides�n,�1<bi<n�for�i=1\xe2\x80\xa6k1\xe2\x89\xa4ai<bi�for�i=1\xe2\x80\xa6kk\xe2\x88\x91i=1aibi=1\xe2\x88\x921n" 1700

1089D "Distance Sum" graphs "You are given a positive integer n.Find a sequence of fractions aibi, i=1\xe2\x80\xa6k (where ai and bi are positive integers) for some k such that:{bi�divides�n,�1<bi<n�for�i=1\xe2\x80\xa6k1\xe2\x89\xa4ai<bi�for�i=1\xe2\x80\xa6kk\xe2\x88\x91i=1aibi=1\xe2\x88\x921n" 3100

1089C "Cactus Search" interactive "You are given a positive integer n.Find a sequence of fractions aibi, i=1\xe2\x80\xa6k (where ai and bi are positive integers) for some k such that:{bi�divides�n,�1<bi<n�for�i=1\xe2\x80\xa6k1\xe2\x89\xa4ai<bi�for�i=1\xe2\x80\xa6kk\xe2\x88\x91i=1aibi=1\xe2\x88\x921n" 2500

1089B Bimatching graphs "You are given a positive integer n.Find a sequence of fractions aibi, i=1\xe2\x80\xa6k (where ai and bi are positive integers) for some k such that:{bi�divides�n,�1<bi<n�for�i=1\xe2\x80\xa6k1\xe2\x89\xa4ai<bi�for�i=1\xe2\x80\xa6kk\xe2\x88\x91i=1aibi=1\xe2\x88\x921n" 3200

1089A "Alice the Fan" dp "Alice is a big fan of volleyball and especially of the very strong ""Team A"".Volleyball match consists of up to five sets. During each set teams score one point for winning a�ball. The first four sets are played until one of the teams scores at least 25�points and the fifth set is played until one of the teams scores at least 15 points. Moreover, if one of the teams scores 25 (or 15 in the fifth set) points while the other team scores 24 (or 14 in the fifth set), the set is played until the absolute difference between teams\' points becomes two. The match ends when one of the teams wins three sets. The match score is the number of sets won by each team.Alice found a book containing all the results of all matches played by ""Team A"". The book is old, and some parts of the book became unreadable. Alice can not read the information on how many sets each of the teams won, she can not read the information on how many points each of the teams scored in each set, she even does not know the number of sets played in a match. The only information she has is the total number of points scored by each of the teams in all the sets during a single match.Alice wonders what is the best match score ""Team A"" could achieve in each of the matches. The bigger is the difference between the number of sets won by ""Team A"" and their opponent, the better is the match score. Find the best match score or conclude that no match could end like that. If there is a solution, then find any possible score for each set that results in the best match score." 2200

1088F "Ehab and a weird weight formula" "data structures,trees" "You\'re given a tree consisting of n nodes. Every node u has a weight au. It is guaranteed that there is only one node with minimum weight in the tree. For every node u (except for the node with the minimum weight), it must have a neighbor v such that av<au. You should construct a tree to minimize the weight w calculated as follows:  For every node u, degu\xe2\x8b\x85au is added to w (degu is the number of edges containing node u).  For every edge {u,v}, \xe2\x8c\x88log2(dist(u,v))\xe2\x8c\x89\xe2\x8b\x85min(au,av) is added to w, where dist(u,v) is the number of edges in the path from u to v in the given tree." 2800

1088E "Ehab and a component choosing problem" dp,greedy,math,trees "You\'re given a tree consisting of n nodes. Every node u has a weight au. You want to choose an integer k (1\xe2\x89\xa4k\xe2\x89\xa4n) and then choose k connected components of nodes that don\'t overlap (i.e every node is in at most 1 component). Let the set of nodes you chose be s. You want to maximize:\xe2\x88\x91u\xe2\x88\x88saukIn other words, you want to maximize the sum of weights of nodes in s divided by the number of connected components you chose. Also, if there are several solutions, you want to maximize k.Note that adjacent nodes can belong to different components. Refer to the third sample." 2400

1088D "Ehab and another another xor problem" "bitmasks,constructive algorithms,implementation,interactive" "This is an interactive problem!Ehab plays a game with Laggy. Ehab has 2 hidden integers (a,b). Laggy can ask a pair of integers (c,d) and Ehab will reply with:  1 if a\xe2\x8a\x95c>b\xe2\x8a\x95d.  0 if a\xe2\x8a\x95c=b\xe2\x8a\x95d.  -1 if a\xe2\x8a\x95c<b\xe2\x8a\x95d. Operation a\xe2\x8a\x95b is the bitwise-xor operation of two numbers a and b.Laggy should guess (a,b) with at most 62 questions. You\'ll play this game. You\'re Laggy and the interactor is Ehab.It\'s guaranteed that 0\xe2\x89\xa4a,b<230." 2000

1088C "Ehab and a 2-operation task" "constructive algorithms,greedy,math" "You\'re given an array a of length n. You can perform the following operations on it:  choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n), an integer x (0\xe2\x89\xa4x\xe2\x89\xa4106), and replace aj with aj+x for all (1\xe2\x89\xa4j\xe2\x89\xa4i), which means add x to all the elements in the prefix ending at i.  choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n), an integer x (1\xe2\x89\xa4x\xe2\x89\xa4106), and replace aj with aj%x for all (1\xe2\x89\xa4j\xe2\x89\xa4i), which means replace every element in the prefix ending at i with the remainder after dividing it by x. Can you make the array strictly increasing in no more than n+1 operations?" 1400

1088B "Ehab and subtraction" implementation,sortings "You\'re given an array a. You should repeat the following operation k times: find the minimum non-zero element in the array, print it, and then subtract it from all the non-zero elements of the array. If all the elements are 0s, just print 0." 1000

1088A "Ehab and another construction problem" "brute force,constructive algorithms" "Given an integer x, find 2 integers a and b such that:   1\xe2\x89\xa4a,b\xe2\x89\xa4x  b divides a (a is divisible by b).  a\xe2\x8b\x85b>x.  ab<x." 800

1086F "Forest Fires" math "Berland forest was planted several decades ago in a formation of an infinite grid with a single tree in every cell. Now the trees are grown up and they form a pretty dense structure.So dense, actually, that the fire became a real danger for the forest. This season had been abnormally hot in Berland and some trees got caught on fire! The second fire started is considered the second 0. Every second fire lit up all intact neightbouring trees to every currently burning tree. The tree is neighbouring if it occupies adjacent by side or by corner cell. Luckily, after t seconds Berland fire department finally reached the location of fire and instantaneously extinguished it all.Now they want to calculate the destructive power of the fire. Let valx,y be the second the tree in cell (x,y) got caught on fire. The destructive power is the sum of valx,y over all (x,y) of burnt trees.Clearly, all the workers of fire department are firefighters, not programmers, thus they asked you to help them calculate the destructive power of the fire.The result can be rather big, so print it modulo 998244353." 3500

1085G "Beautiful Matrix" "combinatorics,data structures,dp" "Petya collects beautiful matrix.A matrix of size n\xc3\x97n is beautiful if:   All elements of the matrix are integers between 1 and n;  For every row of the matrix, all elements of this row are different;  For every pair of vertically adjacent elements, these elements are different. Today Petya bought a beautiful matrix a of size n\xc3\x97n, and now he wants to determine its rarity.The rarity of the matrix is its index in the list of beautiful matrices of size n\xc3\x97n, sorted in lexicographical order. Matrix comparison is done row by row. (The index of lexicographically smallest matrix is zero).Since the number of beautiful matrices may be huge, Petya wants you to calculate the rarity of the matrix a modulo 998244353." 2900

1085F "Rock-Paper-Scissors Champion" NA "n players are going to play a rock-paper-scissors tournament. As you probably know, in a one-on-one match of rock-paper-scissors, two players choose their shapes independently. The outcome is then determined depending on the chosen shapes: ""paper"" beats ""rock"", ""rock"" beats ""scissors"", ""scissors"" beat ""paper"", and two equal shapes result in a draw.At the start of the tournament all players will stand in a row, with their numbers increasing from 1 for the leftmost player, to n for the rightmost player. Each player has a pre-chosen shape that they will use in every game throughout the tournament. Here\'s how the tournament is conducted: If there is only one player left, he is declared the champion. Otherwise, two adjacent players in the row are chosen arbitrarily, and they play the next match. The losing player is eliminated from the tournament and leaves his place in the row (with his former neighbours becoming adjacent). If the game is a draw, the losing player is determined by a coin toss.The organizers are informed about all players\' favoured shapes. They wish to find out the total number of players who have a chance of becoming the tournament champion (that is, there is a suitable way to choose the order of the games and manipulate the coin tosses). However, some players are still optimizing their strategy, and can inform the organizers about their new shapes. Can you find the number of possible champions after each such request?" 2500

1085E "Vasya and Templates" greedy,implementation,strings "Vasya owns three strings s , a and b, each of them consists only of first k Latin letters.Let a template be such a string of length k that each of the first k Latin letters appears in it exactly once (thus there are k! distinct templates). Application of template p to the string s is the replacement of each character in string s with pi, i is the index of this letter in the alphabet. For example, applying template ""bdca"" to a string ""aabccd"" yields string ""bbdcca"".Vasya wants to know if there exists such a template which yields a string lexicographically greater than or equal to string a and lexicographically less than or equal to string b after applying it to s.If there exist multiple suitable templates, print any of them.String a is lexicographically less than string b if there is some i (1\xe2\x89\xa4i\xe2\x89\xa4n) that ai<bi and for any j (1\xe2\x89\xa4j<i) aj=bj.You are required to answer t testcases independently." 2300

1085D "Minimum Diameter Tree" "constructive algorithms,implementation,trees" "You are given a tree (an undirected connected graph without cycles) and an integer ss.Vanya wants to put weights on all edges of the tree so that all weights are non-negative real numbers and their sum is ss. At the same time, he wants to make the diameter of the tree as small as possible.Let\'s define the diameter of a weighed tree as the maximum sum of the weights of the edges lying on the path between two some vertices of the tree. In other words, the diameter of a weighed tree is the length of the longest simple path in the tree, where length of a path is equal to the sum of weights over all edges in the path.Find the minimum possible diameter that Vanya can get." 1700

1085C "Connect Three" implementation,math "The Squareland national forest is divided into equal 1\xc3\x9711\xc3\x971 square plots aligned with north-south and east-west directions. Each plot can be uniquely described by integer Cartesian coordinates (x,y)(x,y) of its south-west corner.Three friends, Alice, Bob, and Charlie are going to buy three distinct plots of land A,B,CA,B,C in the forest. Initially, all plots in the forest (including the plots A,B,CA,B,C) are covered by trees. The friends want to visit each other, so they want to clean some of the plots from trees. After cleaning, one should be able to reach any of the plots A,B,CA,B,C from any other one of those by moving through adjacent cleared plots. Two plots are adjacent if they share a side.  For example, A=(0,0)A=(0,0), B=(1,1)B=(1,1), C=(2,2)C=(2,2). The minimal number of plots to be cleared is 55. One of the ways to do it is shown with the gray color. Of course, the friends don\'t want to strain too much. Help them find out the smallest number of plots they need to clean from trees." 1600

1085B "Div Times Mod" math "Vasya likes to solve equations. Today he wants to solve (x�div�k)\xe2\x8b\x85(xmodk)=n, where div and mod stand for integer division and modulo operations (refer to the Notes below for exact definition). In this equation, k and n are positive integer parameters, and x is a positive integer unknown. If there are several solutions, Vasya wants to find the smallest possible x. Can you help him?" 1100

1085A "Right-Left Cipher" implementation,strings "Polycarp loves ciphers. He has invented his own cipher called Right-Left.Right-Left cipher is used for strings. To encrypt the string s=s1s2\xe2\x80\xa6sn Polycarp uses the following algorithm:  he writes down s1,  he appends the current word with s2 (i.e. writes down s2 to the right of the current result),  he prepends the current word with s3 (i.e. writes down s3 to the left of the current result),  he appends the current word with s4 (i.e. writes down s4 to the right of the current result),  he prepends the current word with s5 (i.e. writes down s5 to the left of the current result),  and so on for each position until the end of s. For example, if s=""techno"" the process is: ""t"" \xe2\x86\x92 ""te"" \xe2\x86\x92 ""cte"" \xe2\x86\x92 ""cteh"" \xe2\x86\x92 ""ncteh"" \xe2\x86\x92 ""ncteho"". So the encrypted s=""techno"" is ""ncteho"".Given string t \xe2\x80\x94 the result of encryption of some string s. Your task is to decrypt it, i.e. find the string s." 800

1084C "The Fair Nut and String" combinatorics,dp,implementation "The Fair Nut found a string s. The string consists of lowercase Latin letters. The Nut is a curious guy, so he wants to find the number of strictly increasing sequences p1,p2,\xe2\x80\xa6,pk, such that:   For each i (1\xe2\x89\xa4i\xe2\x89\xa4k), spi= \'a\'.  For each i (1\xe2\x89\xa4i<k), there is such j that pi<j<pi+1 and sj= \'b\'. The Nut is upset because he doesn\'t know how to find the number. Help him.This number should be calculated modulo 109+7." 1500

1084B "Kvass and the Fair Nut" greedy,implementation "The Fair Nut likes kvass very much. On his birthday parents presented him n kegs of kvass. There are vi liters of kvass in the i-th keg. Each keg has a lever. You can pour your glass by exactly 1 liter pulling this lever. The Fair Nut likes this drink very much, so he wants to pour his glass by s liters of kvass. But he wants to do it, so kvass level in the least keg is as much as possible.Help him find out how much kvass can be in the least keg or define it\'s not possible to pour his glass by s liters of kvass." 1200

1084A "The Fair Nut and Elevator" "brute force,implementation" "The Fair Nut lives in n story house. ai people live on the i-th floor of the house. Every person uses elevator twice a day: to get from the floor where he/she lives to the ground (first) floor and to get from the first floor to the floor where he/she lives, when he/she comes back home in the evening. It was decided that elevator, when it is not used, will stay on the x-th floor, but x hasn\'t been chosen yet. When a person needs to get from floor a to floor b, elevator follows the simple algorithm:   Moves from the x-th floor (initially it stays on the x-th floor) to the a-th and takes the passenger.  Moves from the a-th floor to the b-th floor and lets out the passenger (if a equals b, elevator just opens and closes the doors, but still comes to the floor from the x-th floor).  Moves from the b-th floor back to the x-th.  The elevator never transposes more than one person and always goes back to the floor x before transposing a next passenger. The elevator spends one unit of electricity to move between neighboring floors. So moving from the a-th floor to the b-th floor requires |a\xe2\x88\x92b| units of electricity.Your task is to help Nut to find the minimum number of electricity units, that it would be enough for one day, by choosing an optimal the x-th floor. Don\'t forget than elevator initially stays on the x-th floor." 1000

1083F "The Fair Nut and Amusing Xor" "data structures" "The Fair Nut has two arrays a and b, consisting of n numbers. He found them so long ago that no one knows when they came to him.The Fair Nut often changes numbers in his arrays. He also is interested in how similar a and b are after every modification.Let\'s denote similarity of two arrays as the minimum number of operations to apply to make arrays equal (every operation can be applied for both arrays). If it is impossible, similarity will be equal \xe2\x88\x921.Per one operation you can choose a subarray with length k (k is fixed), and change every element ai, which belongs to the chosen subarray, to ai\xe2\x8a\x95x (x can be chosen), where \xe2\x8a\x95 denotes the bitwise XOR operation. Nut has already calculated the similarity of the arrays after every modification. Can you do it?Note that you just need to calculate those values, that is you do not need to apply any operations." 3300

1083E "The Fair Nut and Rectangles" "data structures,dp,geometry" "The Fair Nut got stacked in planar world. He should solve this task to get out.You are given n rectangles with vertexes in (0,0), (xi,0), (xi,yi), (0,yi). For each rectangle, you are also given a number ai. Choose some of them that the area of union minus sum of ai of the chosen ones is maximum.It is guaranteed that there are no nested rectangles.Nut has no idea how to find the answer, so he asked for your help." 2400

1083D "The Fair Nut\'s getting crazy" "data structures,implementation" "The Fair Nut got stacked in planar world. He should solve this task to get out.You are given n rectangles with vertexes in (0,0), (xi,0), (xi,yi), (0,yi). For each rectangle, you are also given a number ai. Choose some of them that the area of union minus sum of ai of the chosen ones is maximum.It is guaranteed that there are no nested rectangles.Nut has no idea how to find the answer, so he asked for your help." 3500

1083C "Max Mex" "data structures,trees" "Once Grisha found a tree (connected graph without cycles) with a root in node 11.But this tree was not just a tree. A permutation pp of integers from 00 to n\xe2\x88\x921n\xe2\x88\x921 is written in nodes, a number pipi is written in node ii.As Grisha likes to invent some strange and interesting problems for himself, but not always can solve them, you need to help him deal with two types of queries on this tree.Let\'s define a function MEX(S)MEX(S), where SS is a set of non-negative integers, as a smallest non-negative integer that is not included in this set.Let ll be a simple path in this tree. So let\'s define indices of nodes which lie on ll as u1u1, u2u2, \xe2\x80\xa6\xe2\x80\xa6, ukuk. Define V(l)V(l) as a set {pu1pu1, pu2pu2, \xe2\x80\xa6\xe2\x80\xa6 , pukpuk}. Then queries are:   For two nodes ii and jj, swap pipi and pjpj.  Find the maximum value of MEX(V(l))MEX(V(l)) in all possible ll." 2900

1083B "The Fair Nut and Strings" greedy,strings "Recently, the Fair Nut has written k strings of length n, consisting of letters ""a"" and ""b"". He calculated c�\xe2\x80\x94 the number of strings that are prefixes of at least one of the written strings. Every string was counted only one time.Then, he lost his sheet with strings. He remembers that all written strings were lexicographically not smaller than string s and not bigger than string t. He is interested: what is the maximum value of c that he could get.A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 2000

1083A "The Fair Nut and the Best Path" "data structures,dp,trees" "The Fair Nut is going to travel to the Tree Country, in which there are n cities. Most of the land of this country is covered by forest. Furthermore, the local road system forms a tree (connected graph without cycles). Nut wants to rent a car in the city u and go by a simple path to city v. He hasn\'t determined the path, so it\'s time to do it. Note that chosen path can consist of only one vertex.A filling station is located in every city. Because of strange law, Nut can buy only wi liters of gasoline in the i-th city. We can assume, that he has infinite money. Each road has a length, and as soon as Nut drives through this road, the amount of gasoline decreases by length. Of course, Nut can\'t choose a path, which consists of roads, where he runs out of gasoline. He can buy gasoline in every visited city, even in the first and the last.He also wants to find the maximum amount of gasoline that he can have at the end of the path. Help him: count it." 1800

1082G "Petya and Graph" flows,graphs "Petya has a simple graph (that is, a graph without loops or multiple edges) consisting of n vertices and m edges.The weight of the i-th vertex is ai.The weight of the i-th edge is wi.A subgraph of a graph is some set of the graph vertices and some set of the graph edges. The set of edges must meet the condition: both ends of each edge from the set must belong to the chosen set of vertices. The weight of a subgraph is the sum of the weights of its edges, minus the sum of the weights of its vertices. You need to find the maximum weight of subgraph of given graph. The given graph does not contain loops and multiple edges." 2400

1082F "Speed Dial" dp,strings,trees "Polycarp\'s phone book contains n phone numbers, each of them is described by si \xe2\x80\x94 the number itself and mi \xe2\x80\x94 the number of times Polycarp dials it in daily.Polycarp has just bought a brand new phone with an amazing speed dial feature! More precisely, k buttons on it can have a number assigned to it (not necessary from the phone book). To enter some number Polycarp can press one of these k buttons and then finish the number using usual digit buttons (entering a number with only digit buttons is also possible).Speed dial button can only be used when no digits are entered. No button can have its number reassigned.What is the minimal total number of digit number presses Polycarp can achieve after he assigns numbers to speed dial buttons and enters each of the numbers from his phone book the given number of times in an optimal way?" 2800

1082E "Increasing Frequency" "binary search,dp,greedy" "You are given array a of length n. You can choose one segment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and integer value k (positive, negative or even zero) and change al,al+1,\xe2\x80\xa6,ar by k each (i.e. ai:=ai+k for each l\xe2\x89\xa4i\xe2\x89\xa4r).What is the maximum possible number of elements with value c that can be obtained after one such operation?" 2000

1082D "Maximum Diameter Graph" "constructive algorithms,graphs,implementation" "Graph constructive problems are back! This time the graph you are asked to build should match the following properties.The graph is connected if and only if there exists a path between every pair of vertices.The diameter (aka ""longest shortest path"") of a connected undirected graph is the maximum number of edges in the shortest path between any pair of its vertices.The degree of a vertex is the number of edges incident to it.Given a sequence of nn integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an construct a connected undirected graph of nn vertices such that:  the graph contains no self-loops and no multiple edges;  the degree didi of the ii-th vertex doesn\'t exceed aiai (i.e. di\xe2\x89\xa4aidi\xe2\x89\xa4ai);  the diameter of the graph is maximum possible. Output the resulting graph or report that no solution exists." 1800

1082C "Multi-Subject Competition" greedy,sortings "A multi-subject competition is coming! The competition has m different subjects participants can choose from. That\'s why Alex (the coach) should form a competition delegation among his students. He has n candidates. For the i-th person he knows subject si the candidate specializes in and ri \xe2\x80\x94 a skill level in his specialization (this level can be negative!). The rules of the competition require each delegation to choose some subset of subjects they will participate in. The only restriction is that the number of students from the team participating in each of the chosen subjects should be the same.Alex decided that each candidate would participate only in the subject he specializes in. Now Alex wonders whom he has to choose to maximize the total sum of skill levels of all delegates, or just skip the competition this year if every valid non-empty delegation has negative sum.(Of course, Alex doesn\'t have any spare money so each delegate he chooses must participate in the competition)." 1600

1082B "Vova and Trophies" greedy "Vova has won n trophies in different competitions. Each trophy is either golden or silver. The trophies are arranged in a row.The beauty of the arrangement is the length of the longest subsegment consisting of golden trophies. Vova wants to swap two trophies (not necessarily adjacent ones) to make the arrangement as beautiful as possible \xe2\x80\x94 that means, to maximize the length of the longest such subsegment.Help Vova! Tell him the maximum possible beauty of the arrangement if he is allowed to do at most one swap." 1600

1082A "Vasya and Book" implementation,math "Vasya is reading a e-book. The file of the book consists of n pages, numbered from 1 to n. The screen is currently displaying the contents of page x, and Vasya wants to read the page y. There are two buttons on the book which allow Vasya to scroll d pages forwards or backwards (but he cannot scroll outside the book). For example, if the book consists of 10 pages, and d=3, then from the first page Vasya can scroll to the first or to the fourth page by pressing one of the buttons; from the second page \xe2\x80\x94 to the first or to the fifth; from the sixth page \xe2\x80\x94 to the third or to the ninth; from the eighth \xe2\x80\x94 to the fifth or to the tenth.Help Vasya to calculate the minimum number of times he needs to press a button to move to page y." 1200

1081H "Palindromic Magic" "data structures,hashing,strings" "After learning some fancy algorithms about palindromes, Chouti found palindromes very interesting, so he wants to challenge you with this problem.Chouti has got two strings A and B. Since he likes palindromes, he would like to pick a as some non-empty palindromic substring of A and b as some non-empty palindromic substring of B. Concatenating them, he will get string ab.Chouti thinks strings he could get this way are interesting, so he wants to know how many different strings he can get." 3500

1081G "Mergesort Strikes Back" math,probabilities "Chouti thought about his very first days in competitive programming. When he had just learned to write merge sort, he thought that the merge sort is too slow, so he restricted the maximum depth of recursion and modified the merge sort to the following:  Chouti found his idea dumb since obviously, this ""merge sort"" sometimes cannot sort the array correctly. However, Chouti is now starting to think of how good this ""merge sort"" is. Particularly, Chouti wants to know for a random permutation aa of 1,2,\xe2\x80\xa6,n1,2,\xe2\x80\xa6,n the expected number of inversions after calling MergeSort(a, 1, n, k).It can be proved that the expected number is rational. For the given prime qq, suppose the answer can be denoted by udud where gcd(u,d)=1gcd(u,d)=1, you need to output an integer rr satisfying 0\xe2\x89\xa4r<q0\xe2\x89\xa4r<q and rd\xe2\x89\xa1u(modq)rd\xe2\x89\xa1u(modq). It can be proved that such rr exists and is unique." 3200

1081F "Tricky Interactor" "constructive algorithms,implementation,interactive" "This is an interactive problem.Chouti was tired of studying, so he opened the computer and started playing a puzzle game.Long long ago, the boy found a sequence s1,s2,\xe2\x80\xa6,sn of length n, kept by a tricky interactor. It consisted of 0s and 1s only and the number of 1s is t. The boy knows nothing about this sequence except n and t, but he can try to find it out with some queries with the interactor.We define an operation called flipping. Flipping [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) means for each x\xe2\x88\x88[l,r], changing sx to 1\xe2\x88\x92sx.In each query, the boy can give the interactor two integers l,r satisfying 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and the interactor will either flip [1,r] or [l,n] (both outcomes have the same probability and all decisions made by interactor are independent from each other, see Notes section for more details). The interactor will tell the current number of 1s after each operation. Note, that the sequence won\'t be restored after each operation.Help the boy to find the original sequence in no more than 10000 interactions.""Weird legend, dumb game."" he thought. However, after several tries, he is still stuck with it. Can you help him beat this game?" 2600

1081E "Missing Numbers" "binary search,constructive algorithms,greedy,math,number theory" "Chouti is working on a strange math problem.There was a sequence of n positive integers x1,x2,\xe2\x80\xa6,xn, where n is even. The sequence was very special, namely for every integer t from 1 to n, x1+x2+...+xt is a square of some integer number (that is, a perfect square).Somehow, the numbers with odd indexes turned to be missing, so he is only aware of numbers on even positions, i.e. x2,x4,x6,\xe2\x80\xa6,xn. The task for him is to restore the original sequence. Again, it\'s your turn to help him.The problem setter might make mistakes, so there can be no possible sequence at all. If there are several possible sequences, you can output any." 1900

1081D "Maximum Distance" "dsu,graphs,shortest paths,sortings" "Chouti was tired of the tedious homework, so he opened up an old programming problem he created years ago.You are given a connected undirected graph with n vertices and m weighted edges. There are k special vertices: x1,x2,\xe2\x80\xa6,xk.Let\'s define the cost of the path as the maximum weight of the edges in it. And the distance between two vertexes as the minimum cost of the paths connecting them.For each special vertex, find another special vertex which is farthest from it (in terms of the previous paragraph, i.e. the corresponding distance is maximum possible) and output the distance between them.The original constraints are really small so he thought the problem was boring. Now, he raises the constraints and hopes you can solve it for him." 1800

1081C "Colorful Bricks" combinatorics,dp,math "On his free time, Chouti likes doing some housework. He has got one new task, paint some bricks in the yard.There are nn bricks lined in a row on the ground. Chouti has got mm paint buckets of different colors at hand, so he painted each brick in one of those mm colors.Having finished painting all bricks, Chouti was satisfied. He stood back and decided to find something fun with these bricks. After some counting, he found there are kk bricks with a color different from the color of the brick on its left (the first brick is not counted, for sure).So as usual, he needs your help in counting how many ways could he paint the bricks. Two ways of painting bricks are different if there is at least one brick painted in different colors in these two ways. Because the answer might be quite big, you only need to output the number of ways modulo 998244353998244353." 1500

1081B "Farewell Party" "constructive algorithms,implementation" "Chouti and his classmates are going to the university soon. To say goodbye to each other, the class has planned a big farewell party in which classmates, teachers and parents sang and danced.Chouti remembered that n persons took part in that party. To make the party funnier, each person wore one hat among n kinds of weird hats numbered 1,2,\xe2\x80\xa6n. It is possible that several persons wore hats of the same kind. Some kinds of hats can remain unclaimed by anyone.After the party, the i-th person said that there were ai persons wearing a hat differing from his own.It has been some days, so Chouti forgot all about others\' hats, but he is curious about that. Let bi be the number of hat type the i-th person was wearing, Chouti wants you to find any possible b1,b2,\xe2\x80\xa6,bn that doesn\'t contradict with any person\'s statement. Because some persons might have a poor memory, there could be no solution at all." 1500

1081A "Definite Game" "constructive algorithms,math" "Chouti was doing a competitive programming competition. However, after having all the problems accepted, he got bored and decided to invent some small games.He came up with the following game. The player has a positive integer n. Initially the value of n equals to v and the player is able to do the following operation as many times as the player want (possibly zero): choose a positive integer x that x<n and x is not a divisor of n, then subtract x from n. The goal of the player is to minimize the value of n in the end.Soon, Chouti found the game trivial. Can you also beat the game?" 800

1080F "Katya and Segments Sets" "data structures,interactive,sortings" "It is a very important day for Katya. She has a test in a programming class. As always, she was given an interesting problem that she solved very fast. Can you solve that problem?You are given n ordered segments sets. Each segment can be represented as a pair of two integers [l,r] where l\xe2\x89\xa4r. Each set can contain an arbitrary number of segments (even 0). It is possible that some segments are equal.You are also given m queries, each of them can be represented as four numbers: a,b,x,y. For each segment, find out whether it is true that each set p (a\xe2\x89\xa4p\xe2\x89\xa4b) contains at least one segment [l,r] that lies entirely on the segment [x,y], that is x\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4y. Find out the answer to each query.Note that you need to solve this problem online. That is, you will get a new query only after you print the answer for the previous query." 2400

1080E "Sonya and Matrix Beauty" strings "Sonya had a birthday recently. She was presented with the matrix of size n\xc3\x97m and consist of lowercase Latin letters. We assume that the rows are numbered by integers from 1 to n from bottom to top, and the columns are numbered from 1 to m from left to right. Let\'s call a submatrix (i1,j1,i2,j2) (1\xe2\x89\xa4i1\xe2\x89\xa4i2\xe2\x89\xa4n;1\xe2\x89\xa4j1\xe2\x89\xa4j2\xe2\x89\xa4m) elements aij of this matrix, such that i1\xe2\x89\xa4i\xe2\x89\xa4i2 and j1\xe2\x89\xa4j\xe2\x89\xa4j2. Sonya states that a submatrix is beautiful if we can independently reorder the characters in each row (not in column) so that all rows and columns of this submatrix form palidroms. Let\'s recall that a string is called palindrome if it reads the same from left to right and from right to left. For example, strings abacaba,bcaacb,a are palindromes while strings abca,acbba,ab are not.Help Sonya to find the number of beautiful submatrixes. Submatrixes are different if there is an element that belongs to only one submatrix." 2400

1080D "Olya and magical square" "constructive algorithms,implementation,math" "Recently, Olya received a magical square with the size of 2n\xc3\x972n.It seems to her sister that one square is boring. Therefore, she asked Olya to perform exactly k splitting operations.A Splitting operation is an operation during which Olya takes a square with side a and cuts it into 4 equal squares with side a2. If the side of the square is equal to 1, then it is impossible to apply a splitting operation to it (see examples for better understanding).Olya is happy to fulfill her sister\'s request, but she also wants the condition of Olya\'s happiness to be satisfied after all operations.The condition of Olya\'s happiness will be satisfied if the following statement is fulfilled:Let the length of the side of the lower left square be equal to a, then the length of the side of the right upper square should also be equal to a. There should also be a path between them that consists only of squares with the side of length a. All consecutive squares on a path should have a common side.Obviously, as long as we have one square, these conditions are met. So Olya is ready to fulfill her sister\'s request only under the condition that she is satisfied too. Tell her: is it possible to perform exactly k splitting operations in a certain order so that the condition of Olya\'s happiness is satisfied? If it is possible, tell also the size of the side of squares of which the path from the lower left square to the upper right one will consist." 2000

1080C "Masha and two friends" implementation "Recently, Masha was presented with a chessboard with a height of nn and a width of mm.The rows on the chessboard are numbered from 11 to nn from bottom to top. The columns are numbered from 11 to mm from left to right. Therefore, each cell can be specified with the coordinates (x,y)(x,y), where xx is the column number, and yy is the row number (do not mix up).Let us call a rectangle with coordinates (a,b,c,d)(a,b,c,d) a rectangle lower left point of which has coordinates (a,b)(a,b), and the upper right one�\xe2\x80\x94 (c,d)(c,d).The chessboard is painted black and white as follows:   An example of a chessboard. Masha was very happy with the gift and, therefore, invited her friends Maxim and Denis to show off. The guys decided to make her a treat�\xe2\x80\x94 they bought her a can of white and a can of black paint, so that if the old board deteriorates, it can be repainted. When they came to Masha, something unpleasant happened: first, Maxim went over the threshold and spilled white paint on the rectangle (x1,y1,x2,y2)(x1,y1,x2,y2). Then after him Denis spilled black paint on the rectangle (x3,y3,x4,y4)(x3,y3,x4,y4).To spill paint of color colorcolor onto a certain rectangle means that all the cells that belong to the given rectangle become colorcolor. The cell dyeing is superimposed on each other (if at first some cell is spilled with white paint and then with black one, then its color will be black).Masha was shocked! She drove away from the guests and decided to find out how spoiled the gift was. For this, she needs to know the number of cells of white and black color. Help her find these numbers!" 1500

1080B "Margarite and the best present" math "Little girl Margarita is a big fan of competitive programming. She especially loves problems about arrays and queries on them.Recently, she was presented with an array a of the size of 109 elements that is filled as follows:   a1=\xe2\x88\x921  a2=2  a3=\xe2\x88\x923  a4=4  a5=\xe2\x88\x925  And so on ... That is, the value of the i-th element of the array a is calculated using the formula ai=i\xe2\x8b\x85(\xe2\x88\x921)i.She immediately came up with q queries on this array. Each query is described with two numbers: l and r. The answer to a query is the sum of all the elements of the array at positions from l to r inclusive.Margarita really wants to know the answer to each of the requests. She doesn\'t want to count all this manually, but unfortunately, she couldn\'t write the program that solves the problem either. She has turned to you�\xe2\x80\x94 the best programmer.Help her find the answers!" 900

1080A "Petya and Origami" math "Petya is having a party soon, and he has decided to invite his n friends.He wants to make invitations in the form of origami. For each invitation, he needs two red sheets, five green sheets, and eight blue sheets. The store sells an infinite number of notebooks of each color, but each notebook consists of only one color with k sheets. That is, each notebook contains k sheets of either red, green, or blue.Find the minimum number of notebooks that Petya needs to buy to invite all n of his friends." 800

1078E "Negative Time Summation" "constructive algorithms" "Everyone knows that computers become faster and faster. Recently Berland scientists have built a machine that can move itself back in time!More specifically, it works as follows. It has an infinite grid and a robot which stands on one of the cells. Each cell of the grid can either be empty or contain 0 or 1. The machine also has a program which consists of instructions, which are being handled one by one. Each instruction is represented by exactly one symbol (letter or digit) and takes exactly one unit of time (say, second) to be performed, except the last type of operation (it\'s described below). Here they are:  0 or 1: the robot places this number into the cell he is currently at. If this cell wasn\'t empty before the operation, its previous number is replaced anyway.  e: the robot erases the number into the cell he is at.  l, r, u or d: the robot goes one cell to the left/right/up/down.  s: the robot stays where he is for a unit of time.  t: let x be 0, if the cell with the robot is empty, otherwise let x be one more than the digit in this cell (that is, x=1 if the digit in this cell is 0, and x=2 if the digit is 1). Then the machine travels x seconds back in time. Note that this doesn\'t change the instructions order, but it changes the position of the robot and the numbers in the grid as they were x units of time ago. You can consider this instruction to be equivalent to a Ctrl-Z pressed x times. For example, let the board be completely empty, and the program be sr1t0. Let the robot initially be at (0,0).  [now is the moment 0, the command is s]: we do nothing.  [now is the moment 1, the command is r]: we are now at (1,0).  [now is the moment 2, the command is 1]: we are at (1,0), and this cell contains 1.  [now is the moment 3, the command is t]: we travel 1+1=2 moments back, that is, to the moment 1.  [now is the moment 1, the command is 0]: we are again at (0,0), and the board is clear again, but after we follow this instruction, this cell has 0 in it. We\'ve just rewritten the history. The consequences of the third instruction have never happened. Now Berland scientists want to use their machine in practice. For example, they want to be able to add two integers.Assume that the initial state of the machine is as follows:  One positive integer is written in binary on the grid in such a way that its right bit is at the cell (0,1), from left to right from the highest bit to the lowest bit.  The other positive integer is written in binary on the grid in such a way that its right bit is at the cell (0,0), from left to right from the highest bit to the lowest bit.  All the other cells are empty.  The robot is at (0,0).  We consider this state to be always in the past; that is, if you manage to travel to any negative moment, the board was always as described above, and the robot was at (0,0) for eternity. You are asked to write a program after which  The robot stands on a non-empty cell,  If we read the number starting from the cell with the robot and moving to the right until the first empty cell, this will be a+b in binary, from the highest bit to the lowest bit. Note that there are no restrictions on other cells. In particular, there may be a digit just to the left to the robot after all instructions.In each test you are given up to 1000 pairs (a,b), and your program must work for all these pairs. Also since the machine\'s memory is not very big, your program must consist of no more than 105 instructions." 3400

1077F2 "Pictures with Kittens (hard version)" "data structures,dp" "The only difference between easy and hard versions is the constraints.Vova likes pictures with kittens. The news feed in the social network he uses can be represented as an array of n consecutive pictures (with kittens, of course). Vova likes all these pictures, but some are more beautiful than the others: the i-th picture has beauty ai.Vova wants to repost exactly x pictures in such a way that:   each segment of the news feed of at least k consecutive pictures has at least one picture reposted by Vova;  the sum of beauty values of reposted pictures is maximum possible. For example, if k=1 then Vova has to repost all the pictures in the news feed. If k=2 then Vova can skip some pictures, but between every pair of consecutive pictures Vova has to repost at least one of them.Your task is to calculate the maximum possible sum of values of reposted pictures if Vova follows conditions described above, or say that there is no way to satisfy all conditions." 2100

1077F1 "Pictures with Kittens (easy version)" dp "The only difference between easy and hard versions is the constraints.Vova likes pictures with kittens. The news feed in the social network he uses can be represented as an array of n consecutive pictures (with kittens, of course). Vova likes all these pictures, but some are more beautiful than the others: the i-th picture has beauty ai.Vova wants to repost exactly x pictures in such a way that:   each segment of the news feed of at least k consecutive pictures has at least one picture reposted by Vova;  the sum of beauty values of reposted pictures is maximum possible. For example, if k=1 then Vova has to repost all the pictures in the news feed. If k=2 then Vova can skip some pictures, but between every pair of consecutive pictures Vova has to repost at least one of them.Your task is to calculate the maximum possible sum of values of reposted pictures if Vova follows conditions described above, or say that there is no way to satisfy all conditions." 1900

1077E "Thematic Contests" greedy,sortings "Polycarp has prepared n competitive programming problems. The topic of the i-th problem is ai, and some problems\' topics may coincide.Polycarp has to host several thematic contests. All problems in each contest should have the same topic, and all contests should have pairwise distinct topics. He may not use all the problems. It is possible that there are no contests for some topics.Polycarp wants to host competitions on consecutive days, one contest per day. Polycarp wants to host a set of contests in such a way that:  number of problems in each contest is exactly twice as much as in the previous contest (one day ago), the first contest can contain arbitrary number of problems;  the total number of problems in all the contests should be maximized. Your task is to calculate the maximum number of problems in the set of thematic contests. Note, that you should not maximize the number of contests." 1800

1077D "Cutting Out" "binary search,sortings" "You are given an array s consisting of n integers.You have to find any array t of length k such that you can cut out maximum number of copies of array t from array s.Cutting out the copy of t means that for each element ti of array t you have to find ti in s and remove it from s. If for some ti you cannot find such element in s, then you cannot cut out one more copy of t. The both arrays can contain duplicate elements.For example, if s=[1,2,3,2,4,3,1] and k=3 then one of the possible answers is t=[1,2,3]. This array t can be cut out 2 times.   To cut out the first copy of t you can use the elements [1,2_,3,2,4,3_,1_] (use the highlighted elements). After cutting out the first copy of t the array s can look like [1,3,2,4].  To cut out the second copy of t you can use the elements [1_,3_,2_,4]. After cutting out the second copy of t the array s will be [4]. Your task is to find such array t that you can cut out the copy of t from s maximum number of times. If there are multiple answers, you may choose any of them." 1600

1077C "Good Array" NA "Let\'s call an array good if there is an element in the array that equals to the sum of all other elements. For example, the array a=[1,3,3,7] is good because there is the element a4=7 which equals to the sum 1+3+3.You are given an array a consisting of n integers. Your task is to print all indices j of this array such that after removing the j-th element from the array it will be good (let\'s call such indices nice).For example, if a=[8,3,5,2], the nice indices are 1 and 4:   if you remove a1, the array will look like [3,5,2] and it is good;  if you remove a4, the array will look like [8,3,5] and it is good. You have to consider all removals independently, i.\xe2\x80\x89e. remove the element, check if the resulting array is good, and return the element into the array." 1300

1077B "Disturbed People" greedy "There is a house with n flats situated on the main street of Berlatov. Vova is watching this house every night. The house can be represented as an array of n integer numbers a1,a2,\xe2\x80\xa6,an, where ai=1 if in the i-th flat the light is on and ai=0 otherwise.Vova thinks that people in the i-th flats are disturbed and cannot sleep if and only if 1<i<n and ai\xe2\x88\x921=ai+1=1 and ai=0.Vova is concerned by the following question: what is the minimum number k such that if people from exactly k pairwise distinct flats will turn off the lights then nobody will be disturbed? Your task is to find this number k." 1000

1077A "Frog Jumping" math "A frog is currently at the point 0 on a coordinate axis Ox. It jumps by the following algorithm: the first jump is a units to the right, the second jump is b units to the left, the third jump is a units to the right, the fourth jump is b units to the left, and so on.Formally:   if the frog has jumped an even number of times (before the current jump), it jumps from its current position x to position x+a;  otherwise it jumps from its current position x to position x\xe2\x88\x92b. Your task is to calculate the position of the frog after k jumps.But... One more thing. You are watching t different frogs so you have to answer t independent queries." 800

1076G "Array Game" "data structures,games" "Consider a following game between two players:There is an array b1, b2, ..., bk, consisting of positive integers. Initially a chip is placed into the first cell of the array, and b1 is decreased by 1. Players move in turns. Each turn the current player has to do the following: if the index of the cell where the chip is currently placed is x, then he or she has to choose an index y\xe2\x88\x88[x,min(k,x+m)] such that by>0, move the chip to the cell y and decrease by by 1. If it\'s impossible to make a valid move, the current player loses the game.Your task is the following: you are given an array a consisting of n positive integers, and q queries to it. There are two types of queries: 1 l r d \xe2\x80\x94 for every i\xe2\x88\x88[l,r] increase ai by d;  2 l r \xe2\x80\x94 tell who is the winner of the game that is played on the subarray of a from index l to index r inclusive. Assume both players choose an optimal strategy." 3000

1076F "Summer Practice Report" dp,greedy "Vova has taken his summer practice this year and now he should write a report on how it went.Vova has already drawn all the tables and wrote down all the formulas. Moreover, he has already decided that the report will consist of exactly n pages and the i-th page will include xi tables and yi formulas. The pages are numbered from 1 to n.Vova fills the pages one after another, he can\'t go filling page i+1 before finishing page i and he can\'t skip pages. However, if he draws strictly more than k tables in a row or writes strictly more than k formulas in a row then he will get bored. Vova wants to rearrange tables and formulas in each page in such a way that he doesn\'t get bored in the process. Vova can\'t move some table or some formula to another page.Note that the count doesn\'t reset on the start of the new page. For example, if the page ends with 3 tables and the next page starts with 5 tables, then it\'s counted as 8 tables in a row.Help Vova to determine if he can rearrange tables and formulas on each page in such a way that there is no more than k tables in a row and no more than k formulas in a row." 2500

1076E "Vasya and a Tree" "data structures,trees" "Vasya has a tree consisting of n vertices with root in vertex 1. At first all vertices has 0 written on it.Let d(i,j) be the distance between vertices i and j, i.e. number of edges in the shortest path from i to j. Also, let\'s denote k-subtree of vertex x \xe2\x80\x94 set of vertices y such that next two conditions are met:   x is the ancestor of y (each vertex is the ancestor of itself);  d(x,y)\xe2\x89\xa4k. Vasya needs you to process m queries. The i-th query is a triple vi, di and xi. For each query Vasya adds value xi to each vertex from di-subtree of vi.Report to Vasya all values, written on vertices of the tree after processing all queries." 1900

1076D "Edge Deletion" "graphs,greedy,shortest paths" "You are given an undirected connected weighted graph consisting of n vertices and m edges. Let\'s denote the length of the shortest path from vertex 1 to vertex i as di. You have to erase some edges of the graph so that at most k edges remain. Let\'s call a vertex i good if there still exists a path from 1 to i with length di after erasing the edges.Your goal is to erase the edges in such a way that the number of good vertices is maximized." 1800

1076C "Meme Problem" "binary search,math" "Try guessing the statement from this picture:   You are given a non-negative integer dd. You have to find two non-negative real numbers aa and bb such that a+b=da+b=d and a\xe2\x8b\x85b=da\xe2\x8b\x85b=d." 1300

1076B "Divisor Subtraction" "implementation,math,number theory" "You are given an integer number n. The following algorithm is applied to it:  if n=0, then end algorithm;  find the smallest prime divisor d of n;  subtract d from n and go to step 1. Determine the number of subtrations the algorithm will make." 1200

1076A "Minimizing the String" greedy,strings "You are given a string s consisting of n lowercase Latin letters.You have to remove at most one (i.e. zero or one) character of this string in such a way that the string you obtain will be lexicographically smallest among all strings that can be obtained using this operation.String s=s1s2\xe2\x80\xa6sn is lexicographically smaller than string t=t1t2\xe2\x80\xa6tm if n<m and s1=t1,s2=t2,\xe2\x80\xa6,sn=tn or there exists a number p such that p\xe2\x89\xa4min(n,m) and s1=t1,s2=t2,\xe2\x80\xa6,sp\xe2\x88\x921=tp\xe2\x88\x921 and sp<tp.For example, ""aaa"" is smaller than ""aaaa"", ""abb"" is smaller than ""abc"", ""pqr"" is smaller than ""z""." 1200

1075B "Taxi drivers and Lyft" implementation,sortings "Palo Alto is an unusual city because it is an endless coordinate line. It is also known for the office of Lyft Level 5.Lyft has become so popular so that it is now used by all m taxi drivers in the city, who every day transport the rest of the city residents�\xe2\x80\x94 n riders.Each resident (including taxi drivers) of Palo-Alto lives in its unique location (there is no such pair of residents that their coordinates are the same).The Lyft system is very clever: when a rider calls a taxi, his call does not go to all taxi drivers, but only to the one that is the closest to that person. If there are multiple ones with the same distance, then to taxi driver with a smaller coordinate is selected.But one morning the taxi drivers wondered: how many riders are there that would call the given taxi driver if they were the first to order a taxi on that day? In other words, you need to find for each taxi driver i the number ai�\xe2\x80\x94 the number of riders that would call the i-th taxi driver when all drivers and riders are at their home?The taxi driver can neither transport himself nor other taxi drivers." 1200

1075A "The King\'s Race" implementation,math "Palo Alto is an unusual city because it is an endless coordinate line. It is also known for the office of Lyft Level 5.Lyft has become so popular so that it is now used by all m taxi drivers in the city, who every day transport the rest of the city residents�\xe2\x80\x94 n riders.Each resident (including taxi drivers) of Palo-Alto lives in its unique location (there is no such pair of residents that their coordinates are the same).The Lyft system is very clever: when a rider calls a taxi, his call does not go to all taxi drivers, but only to the one that is the closest to that person. If there are multiple ones with the same distance, then to taxi driver with a smaller coordinate is selected.But one morning the taxi drivers wondered: how many riders are there that would call the given taxi driver if they were the first to order a taxi on that day? In other words, you need to find for each taxi driver i the number ai�\xe2\x80\x94 the number of riders that would call the i-th taxi driver when all drivers and riders are at their home?The taxi driver can neither transport himself nor other taxi drivers." 800

1073G "Yet Another LCP Problem" "data structures,string suffix structures" "Let LCP(s,t) be the length of the longest common prefix of strings s and t. Also let s[x\xe2\x80\xa6y] be the substring of s from index x to index y (inclusive). For example, if s= ""abcde"", then s[1\xe2\x80\xa63]= ""abc"", s[2\xe2\x80\xa65]= ""bcde"".You are given a string s of length n and q queries. Each query is a pair of integer sets a1,a2,\xe2\x80\xa6,ak and b1,b2,\xe2\x80\xa6,bl. Calculate i=k\xe2\x88\x91i=1j=l\xe2\x88\x91j=1LCP(s[ai\xe2\x80\xa6n],s[bj\xe2\x80\xa6n]) for each query." 2600

1073F "Choosing Two Paths" "dfs and similar,dp,greedy,trees" "You are given an undirected unweighted tree consisting of n vertices.An undirected tree is a connected undirected graph with n\xe2\x88\x921 edges.Your task is to choose two pairs of vertices of this tree (all the chosen vertices should be distinct) (x1,y1) and (x2,y2) in such a way that neither x1 nor y1 belong to the simple path from x2 to y2 and vice versa (neither x2 nor y2 should not belong to the simple path from x1 to y1).It is guaranteed that it is possible to choose such pairs for the given tree.Among all possible ways to choose such pairs you have to choose one with the maximum number of common vertices between paths from x1 to y1 and from x2 to y2. And among all such pairs you have to choose one with the maximum total length of these two paths.It is guaranteed that the answer with at least two common vertices exists for the given tree.The length of the path is the number of edges in it.The simple path is the path that visits each vertex at most once." 2500

1073E "Segment Sum" bitmasks,combinatorics,dp,math "You are given two integers l and r (l\xe2\x89\xa4r). Your task is to calculate the sum of numbers from l to r (including l and r) such that each number contains at most k different digits, and print this sum modulo 998244353.For example, if k=1 then you have to calculate all numbers from l to r such that each number is formed using only one digit. For l=10,r=50 the answer is 11+22+33+44=110." 2300

1073D "Berland Fair" "binary search,brute force,data structures,greedy" "XXI Berland Annual Fair is coming really soon! Traditionally fair consists of n booths, arranged in a circle. The booths are numbered 1 through n clockwise with n being adjacent to 1. The i-th booths sells some candies for the price of ai burles per item. Each booth has an unlimited supply of candies.Polycarp has decided to spend at most T burles at the fair. However, he has some plan in mind for his path across the booths:  at first, he visits booth number 1;  if he has enough burles to buy exactly one candy from the current booth, then he buys it immediately;  then he proceeds to the next booth in the clockwise order (regardless of if he bought a candy or not). Polycarp\'s money is finite, thus the process will end once he can no longer buy candy at any booth.Calculate the number of candies Polycarp will buy." 1700

1073C "Vasya and Robot" "binary search,two pointers" "Vasya has got a robot which is situated on an infinite Cartesian plane, initially in the cell (0,0). Robot can perform the following four kinds of operations:   U \xe2\x80\x94 move from (x,y) to (x,y+1);  D \xe2\x80\x94 move from (x,y) to (x,y\xe2\x88\x921);  L \xe2\x80\x94 move from (x,y) to (x\xe2\x88\x921,y);  R \xe2\x80\x94 move from (x,y) to (x+1,y). Vasya also has got a sequence of n operations. Vasya wants to modify this sequence so after performing it the robot will end up in (x,y).Vasya wants to change the sequence so the length of changed subsegment is minimum possible. This length can be calculated as follows: maxID\xe2\x88\x92minID+1, where maxID is the maximum index of a changed operation, and minID is the minimum index of a changed operation. For example, if Vasya changes RRRRRRR to RLRRLRL, then the operations with indices 2, 5 and 7 are changed, so the length of changed subsegment is 7\xe2\x88\x922+1=6. Another example: if Vasya changes DDDD to DDRD, then the length of changed subsegment is 1. If there are no changes, then the length of changed subsegment is 0. Changing an operation means replacing it with some operation (possibly the same); Vasya can\'t insert new operations into the sequence or remove them.Help Vasya! Tell him the minimum length of subsegment that he needs to change so that the robot will go from (0,0) to (x,y), or tell him that it\'s impossible." 1800

1073B "Vasya and Books" implementation,math "Vasya has got n books, numbered from 1 to n, arranged in a stack. The topmost book has number a1, the next one \xe2\x80\x94 a2, and so on. The book at the bottom of the stack has number an. All numbers are distinct.Vasya wants to move all the books to his backpack in n steps. During i-th step he wants to move the book number bi into his backpack. If the book with number bi is in the stack, he takes this book and all the books above the book bi, and puts them into the backpack; otherwise he does nothing and begins the next step. For example, if books are arranged in the order [1,2,3] (book 1 is the topmost), and Vasya moves the books in the order [2,1,3], then during the first step he will move two books (1 and 2), during the second step he will do nothing (since book 1 is already in the backpack), and during the third step \xe2\x80\x94 one book (the book number 3). Note that b1,b2,\xe2\x80\xa6,bn are distinct.Help Vasya! Tell him the number of books he will put into his backpack during each step." 1000

1073A "Diverse Substring" implementation,strings "You are given a string s, consisting of n lowercase Latin letters.A substring of string s is a continuous segment of letters from s. For example, ""defor"" is a substring of ""codeforces"" and ""fors"" is not. The length of the substring is the number of letters in it.Let\'s call some string of length n diverse if and only if there is no letter to appear strictly more than n2 times. For example, strings ""abc"" and ""iltlml"" are diverse and strings ""aab"" and ""zz"" are not.Your task is to find any diverse substring of string s or report that there is none. Note that it is not required to maximize or minimize the length of the resulting substring." 1000

1071E "Rain Protection" "binary search,geometry" "A lot of people dream of convertibles (also often called cabriolets). Some of convertibles, however, don\'t have roof at all, and are vulnerable to rain. This is why Melon Ask, the famous inventor, decided to create a rain protection mechanism for convertibles.The workplace of the mechanism is a part of plane just above the driver. Its functional part consists of two rails with sliding endpoints of a piece of stretching rope. For the sake of simplicity we can consider this as a pair of parallel segments in a plane with the rope segment, whose endpoints we are free to choose as any points on these rails segments.  The algorithmic part of the mechanism detects each particular raindrop and predicts when and where it reaches the plane. At this exact moment the rope segment must contain the raindrop point (so the rope adsorbs the raindrop).You are given the initial position of the rope endpoints and all information about raindrops. You are to choose the minimal possible speed vv of the endpoints sliding (both endpoints can slide in any direction along their segments independently of each other) in such a way that it is possible to catch all raindrops moving both endpoints with speed not greater than v, or find out that it\'s impossible no matter how high the speed is." 3500

1070M "Algoland and Berland" "constructive algorithms,divide and conquer,geometry" "Once upon a time Algoland and Berland were a single country, but those times are long gone. Now they are two different countries, but their cities are scattered on a common territory.All cities are represented as points on the Cartesian plane. Algoland consists of a cities numbered from 1 to a. The coordinates of the i-th Algoland city are a pair of integer numbers (xai,yai). Similarly, Berland consists of b cities numbered from 1 to b. The coordinates of the j-th Berland city are a pair of integer numbers (xbj,ybj). No three of the a+b mentioned cities lie on a single straight line.As the first step to unite the countries, Berland decided to build several bidirectional freeways. Each freeway is going to be a line segment that starts in a Berland city and ends in an Algoland city. Freeways can\'t intersect with each other at any point except freeway\'s start or end. Moreover, the freeways have to connect all a+b cities. Here, connectivity means that one can get from any of the specified a+b cities to any other of the a+b cities using freeways. Note that all freeways are bidirectional, which means that one can drive on each of them in both directions.Mayor of each of the b Berland cities allocated a budget to build the freeways that start from this city. Thus, you are given the numbers r1,r2,\xe2\x80\xa6,rb, where rj is the number of freeways that are going to start in the j-th Berland city. The total allocated budget is very tight and only covers building the minimal necessary set of freeways. In other words, r1+r2+\xe2\x8b\xaf+rb=a+b\xe2\x88\x921.Help Berland to build the freeways so that:  each freeway is a line segment connecting a Berland city and an Algoland city,  no freeways intersect with each other except for the freeway\'s start or end,  freeways connect all a+b cities (all freeways are bidirectional),  there are rj freeways that start from the j-th Berland city." 3000

1070L "Odd Federalization" "constructive algorithms" "Berland has n cities, some of which are connected by roads. Each road is bidirectional, connects two distinct cities and for each two cities there\'s at most one road connecting them.The president of Berland decided to split country into r states in such a way that each city will belong to exactly one of these r states.After this split each road will connect either cities of the same state or cities of the different states. Let\'s call roads that connect two cities of the same state ""inner"" roads.The president doesn\'t like odd people, odd cities and odd numbers, so he wants this split to be done in such a way that each city would have even number of ""inner"" roads connected to it.Please help president to find smallest possible r for which such a split exists." 2600

1070K "Video Posts" implementation "Polycarp took n videos, the duration of the i-th video is ai seconds. The videos are listed in the chronological order, i.e. the 1-st video is the earliest, the 2-nd video is the next, ..., the n-th video is the last.Now Polycarp wants to publish exactly k (1\xe2\x89\xa4k\xe2\x89\xa4n) posts in Instabram. Each video should be a part of a single post. The posts should preserve the chronological order, it means that the first post should contain one or more of the earliest videos, the second post should contain a block (one or more videos) going next and so on. In other words, if the number of videos in the j-th post is sj then:  s1+s2+\xe2\x8b\xaf+sk=n (si>0),  the first post contains the videos: 1,2,\xe2\x80\xa6,s1;  the second post contains the videos: s1+1,s1+2,\xe2\x80\xa6,s1+s2;  the third post contains the videos: s1+s2+1,s1+s2+2,\xe2\x80\xa6,s1+s2+s3;  ...  the k-th post contains videos: n\xe2\x88\x92sk+1,n\xe2\x88\x92sk+2,\xe2\x80\xa6,n. Polycarp is a perfectionist, he wants the total duration of videos in each post to be the same.Help Polycarp to find such positive integer values s1,s2,\xe2\x80\xa6,sk that satisfy all the conditions above." 1100

1070J "Streets and Avenues in Berhattan" dp "Berhattan is the capital of Berland. There are n streets running parallel in the east-west direction (horizontally), and there are m avenues running parallel in the south-north direction (vertically). Each street intersects with each avenue, forming a crossroad. So in total there are n\xe2\x8b\x85m crossroads in Berhattan.Recently, the government has changed in Berland. The new government wants to name all avenues and all streets after heroes of revolution.The special committee prepared the list of k names. Only these names can be used as new names for streets and avenues. Each name can be used at most once.The members of committee want to name streets and avenues in the way that minimizes inconvenience for residents. They believe that if street and avenue names start with the same letter, then their crossroad will be inconvenient. Hence only the first letter of each name matters.Given first letters of k names, find C \xe2\x80\x94 minimal possible number of inconvenient crossroads in Berhattan after the naming process." 2300

1070I "Privatization of Roads in Berland" "flows,graph matchings,graphs" "There are n cities and m two-way roads in Berland, each road connecting two distinct cities.Recently the Berland government has made a tough decision to transfer ownership of the roads to private companies. In total, there are 100500 private companies in Berland, numbered by integers from 1 to 100500. After the privatization, every road should belong to exactly one company.The anti-monopoly committee demands that after the privatization each company can own at most two roads. The urbanists of Berland also stated their opinion: each city should be adjacent to the roads owned by at most k companies.Help the government to distribute the roads between the companies so that both conditions are satisfied. That is, each company gets at most two roads, and each city has roads of at most k distinct companies adjacent to it." 2400

1070H "BerOS File Suggestion" "brute force,implementation" "Polycarp is working on a new operating system called BerOS. He asks you to help with implementation of a file suggestion feature.There are n files on hard drive and their names are f1,f2,\xe2\x80\xa6,fn. Any file name contains between 1 and 8 characters, inclusive. All file names are unique.The file suggestion feature handles queries, each represented by a string s. For each query s it should count number of files containing s as a substring (i.e. some continuous segment of characters in a file name equals s) and suggest any such file name.For example, if file names are ""read.me"", ""hosts"", ""ops"", and ""beros.18"", and the query is ""os"", the number of matched files is 2 (two file names contain ""os"" as a substring) and suggested file name can be either ""hosts"" or ""beros.18""." 1500

1070G "Monsters and Potions" "brute force,dp,greedy,implementation" "Polycarp is an introvert person. In fact he is so much of an introvert that he plays ""Monsters and Potions"" board game alone. The board of the game is a row of n cells. The cells are numbered from 1 to n from left to right. There are three types of cells: a cell containing a single monster, a cell containing a single potion or a blank cell (it contains neither a monster nor a potion).Polycarp has m tokens representing heroes fighting monsters, which are initially located in the blank cells s1,s2,\xe2\x80\xa6,sm. Polycarp\'s task is to choose a single cell (rally point) and one by one move all the heroes into this cell. A rally point can be a cell of any of three types.After Policarp selects a rally point, he picks a hero and orders him to move directly to the point. Once that hero reaches the point, Polycarp picks another hero and orders him also to go to the point. And so forth, until all the heroes reach the rally point cell. While going to the point, a hero can not deviate from the direct route or take a step back. A hero just moves cell by cell in the direction of the point until he reaches it. It is possible that multiple heroes are simultaneously in the same cell.Initially the i-th hero has hi hit points (HP). Monsters also have HP, different monsters might have different HP. And potions also have HP, different potions might have different HP.If a hero steps into a cell which is blank (i.e. doesn\'t contain a monster/potion), hero\'s HP does not change.If a hero steps into a cell containing a monster, then the hero and the monster fight. If monster\'s HP is strictly higher than hero\'s HP, then the monster wins and Polycarp loses the whole game. If hero\'s HP is greater or equal to monster\'s HP, then the hero wins and monster\'s HP is subtracted from hero\'s HP. I.e. the hero survives if his HP drops to zero, but dies (and Polycarp looses) if his HP becomes negative due to a fight. If a hero wins a fight with a monster, then the monster disappears, and the cell becomes blank.If a hero steps into a cell containing a potion, then the hero drinks the potion immediately. As a result, potion\'s HP is added to hero\'s HP, the potion disappears, and the cell becomes blank.Obviously, Polycarp wants to win the game. It means that he must choose such rally point and the order in which heroes move, that every hero reaches the rally point and survives. I.e. Polycarp loses if a hero reaches rally point but is killed by a monster at the same time. Polycarp can use any of n cells as a rally point \xe2\x80\x94 initially it can contain a monster, a potion, or be a blank cell with or without a hero in it.Help Polycarp write a program to choose a rally point and the order in which heroes move." 2300

1070F Debate greedy "Elections in Berland are coming. There are only two candidates \xe2\x80\x94 Alice and Bob.The main Berland TV channel plans to show political debates. There are n people who want to take part in the debate as a spectator. Each person is described by their influence and political views. There are four kinds of political views:  supporting none of candidates (this kind is denoted as ""00""),  supporting Alice but not Bob (this kind is denoted as ""10""),  supporting Bob but not Alice (this kind is denoted as ""01""),  supporting both candidates (this kind is denoted as ""11""). The direction of the TV channel wants to invite some of these people to the debate. The set of invited spectators should satisfy three conditions:  at least half of spectators support Alice (i.e. 2\xe2\x8b\x85a\xe2\x89\xa5m, where a is number of spectators supporting Alice and m is the total number of spectators),  at least half of spectators support Bob (i.e. 2\xe2\x8b\x85b\xe2\x89\xa5m, where b is number of spectators supporting Bob and m is the total number of spectators),  the total influence of spectators is maximal possible. Help the TV channel direction to select such non-empty set of spectators, or tell that this is impossible." 1500

1070E "Getting Deals Done" "binary search,data structures" "Polycarp has a lot of work to do. Recently he has learned a new time management rule: ""if a task takes five minutes or less, do it immediately"". Polycarp likes the new rule, however he is not sure that five minutes is the optimal value. He supposes that this value d should be chosen based on existing task list.Polycarp has a list of n tasks to complete. The i-th task has difficulty pi, i.e. it requires exactly pi minutes to be done. Polycarp reads the tasks one by one from the first to the n-th. If a task difficulty is d or less, Polycarp starts the work on the task immediately. If a task difficulty is strictly greater than d, he will not do the task at all. It is not allowed to rearrange tasks in the list. Polycarp doesn\'t spend any time for reading a task or skipping it.Polycarp has t minutes in total to complete maximum number of tasks. But he does not want to work all the time. He decides to make a break after each group of m consecutive tasks he was working on. The break should take the same amount of time as it was spent in total on completion of these m tasks.For example, if n=7, p=[3,1,4,1,5,9,2], d=3 and m=2 Polycarp works by the following schedule:  Polycarp reads the first task, its difficulty is not greater than d (p1=3\xe2\x89\xa4d=3) and works for 3 minutes (i.e. the minutes 1, 2, 3);  Polycarp reads the second task, its difficulty is not greater than d (p2=1\xe2\x89\xa4d=3) and works for 1 minute (i.e. the minute 4);  Polycarp notices that he has finished m=2 tasks and takes a break for 3+1=4 minutes (i.e. on the minutes 5,6,7,8);  Polycarp reads the third task, its difficulty is greater than d (p3=4>d=3) and skips it without spending any time;  Polycarp reads the fourth task, its difficulty is not greater than d (p4=1\xe2\x89\xa4d=3) and works for 1 minute (i.e. the minute 9);  Polycarp reads the tasks 5 and 6, skips both of them (p5>d and p6>d);  Polycarp reads the 7-th task, its difficulty is not greater than d (p7=2\xe2\x89\xa4d=3) and works for 2 minutes (i.e. the minutes 10, 11);  Polycarp notices that he has finished m=2 tasks and takes a break for 1+2=3 minutes (i.e. on the minutes 12,13,14). Polycarp stops exactly after t minutes. If Polycarp started a task but has not finished it by that time, the task is not considered as completed. It is allowed to complete less than m tasks in the last group. Also Polycarp considers acceptable to have shorter break than needed after the last group of tasks or even not to have this break at all�\xe2\x80\x94 his working day is over and he will have enough time to rest anyway.Please help Polycarp to find such value d, which would allow him to complete maximum possible number of tasks in t minutes." 2100

1070D "Garbage Disposal" greedy "Enough is enough. Too many times it happened that Vasya forgot to dispose of garbage and his apartment stank afterwards. Now he wants to create a garbage disposal plan and stick to it.For each of next n days Vasya knows ai \xe2\x80\x94 number of units of garbage he will produce on the i-th day. Each unit of garbage must be disposed of either on the day it was produced or on the next day. Vasya disposes of garbage by putting it inside a bag and dropping the bag into a garbage container. Each bag can contain up to k units of garbage. It is allowed to compose and drop multiple bags into a garbage container in a single day.Being economical, Vasya wants to use as few bags as possible. You are to compute the minimum number of bags Vasya needs to dispose of all of his garbage for the given n days. No garbage should be left after the n-th day." 1300

1070C "Cloud Computing" "data structures,greedy" "Buber is a Berland technology company that specializes in waste of investor\'s money. Recently Buber decided to transfer its infrastructure to a cloud. The company decided to rent CPU cores in the cloud for n consecutive days, which are numbered from 1 to n. Buber requires k CPU cores each day.The cloud provider offers m tariff plans, the i-th tariff plan is characterized by the following parameters:  li and ri \xe2\x80\x94 the i-th tariff plan is available only on days from li to ri, inclusive,  ci \xe2\x80\x94 the number of cores per day available for rent on the i-th tariff plan,  pi \xe2\x80\x94 the price of renting one core per day on the i-th tariff plan. Buber can arbitrarily share its computing core needs between the tariff plans. Every day Buber can rent an arbitrary number of cores (from 0 to ci) on each of the available plans. The number of rented cores on a tariff plan can vary arbitrarily from day to day.Find the minimum amount of money that Buber will pay for its work for n days from 1 to n. If on a day the total number of cores for all available tariff plans is strictly less than k, then this day Buber will have to work on fewer cores (and it rents all the available cores), otherwise Buber rents exactly k cores this day." 2000

1070B Berkomnadzor "data structures,greedy" "Berkomnadzor�\xe2\x80\x94 Federal Service for Supervision of Communications, Information Technology and Mass Media�\xe2\x80\x94 is a Berland federal executive body that protects ordinary residents of Berland from the threats of modern internet.Berkomnadzor maintains a list of prohibited IPv4 subnets (blacklist) and a list of allowed IPv4 subnets (whitelist). All Internet Service Providers (ISPs) in Berland must configure the network equipment to block access to all IPv4 addresses matching the blacklist. Also ISPs must provide access (that is, do not block) to all IPv4 addresses matching the whitelist. If an IPv4 address does not match either of those lists, it\'s up to the ISP to decide whether to block it or not. An IPv4 address matches the blacklist (whitelist) if and only if it matches some subnet from the blacklist (whitelist). An IPv4 address can belong to a whitelist and to a blacklist at the same time, this situation leads to a contradiction (see no solution case in the output description).An IPv4 address is a 32-bit unsigned integer written in the form a.b.c.d, where each of the values a,b,c,d is called an octet and is an integer from 0 to 255 written in decimal notation. For example, IPv4 address 192.168.0.1 can be converted to a 32-bit number using the following expression 192\xe2\x8b\x85224+168\xe2\x8b\x85216+0\xe2\x8b\x8528+1\xe2\x8b\x8520. First octet a encodes the most significant (leftmost) 8 bits, the octets b and c�\xe2\x80\x94 the following blocks of 8 bits (in this order), and the octet d encodes the least significant (rightmost) 8 bits.The IPv4 network in Berland is slightly different from the rest of the world. There are no reserved or internal addresses in Berland and use all 232 possible values.An IPv4 subnet is represented either as a.b.c.d or as a.b.c.d/x (where 0\xe2\x89\xa4x\xe2\x89\xa432). A subnet a.b.c.d contains a single address a.b.c.d. A subnet a.b.c.d/x contains all IPv4 addresses with x leftmost (most significant) bits equal to x leftmost bits of the address a.b.c.d. It is required that 32\xe2\x88\x92x rightmost (least significant) bits of subnet a.b.c.d/x are zeroes.Naturally it happens that all addresses matching subnet a.b.c.d/x form a continuous range. The range starts with address a.b.c.d (its rightmost 32\xe2\x88\x92x bits are zeroes). The range ends with address which x leftmost bits equal to x leftmost bits of address a.b.c.d, and its 32\xe2\x88\x92x rightmost bits are all ones. Subnet contains exactly 232\xe2\x88\x92x addresses. Subnet a.b.c.d/32 contains exactly one address and can also be represented by just a.b.c.d.For example subnet 192.168.0.0/24 contains range of 256 addresses. 192.168.0.0 is the first address of the range, and 192.168.0.255 is the last one.Berkomnadzor\'s engineers have devised a plan to improve performance of Berland\'s global network. Instead of maintaining both whitelist and blacklist they want to build only a single optimised blacklist containing minimal number of subnets. The idea is to block all IPv4 addresses matching the optimised blacklist and allow all the rest addresses. Of course, IPv4 addresses from the old blacklist must remain blocked and all IPv4 addresses from the old whitelist must still be allowed. Those IPv4 addresses which matched neither the old blacklist nor the old whitelist may be either blocked or allowed regardless of their accessibility before. Please write a program which takes blacklist and whitelist as input and produces optimised blacklist. The optimised blacklist must contain the minimal possible number of subnets and satisfy all IPv4 addresses accessibility requirements mentioned above. IPv4 subnets in the source lists may intersect arbitrarily. Please output a single number -1 if some IPv4 address matches both source whitelist and blacklist." 2400

1070A "Find a Number" "dp,graphs,number theory,shortest paths" "You are given two positive integers d and s. Find minimal positive integer n which is divisible by d and has sum of digits equal to s." 2200

1068C "Colored Rooks" "constructive algorithms,graphs" "Ivan is a novice painter. He has nn dyes of different colors. He also knows exactly mm pairs of colors which harmonize with each other.Ivan also enjoy playing chess. He has 50005000 rooks. He wants to take kk rooks, paint each of them in one of nn colors and then place this kk rooks on a chessboard of size 109\xc3\x97109109\xc3\x97109.Let\'s call the set of rooks on the board connected if from any rook we can get to any other rook in this set moving only through cells with rooks from this set. Assume that rooks can jump over other rooks, in other words a rook can go to any cell which shares vertical and to any cell which shares horizontal.Ivan wants his arrangement of rooks to have following properties: For any color there is a rook of this color on a board; For any color the set of rooks of this color is connected; For any two different colors aa bb union of set of rooks of color aa and set of rooks of color bb is connected if and only if this two colors harmonize with each other.Please help Ivan find such an arrangement." 1700

1068B LCM "math,number theory" "Ivan has number b. He is sorting through the numbers a from 1 to 1018, and for every a writes [a,b]a on blackboard. Here [a,b] stands for least common multiple of a and b. Ivan is very lazy, that\'s why this task bored him soon. But he is interested in how many different numbers he would write on the board if he would finish the task. Help him to find the quantity of different numbers he would write on the board." 1200

1068A Birthday math "Ivan is collecting coins. There are only N different collectible coins, Ivan has K of them. He will be celebrating his birthday soon, so all his M freinds decided to gift him coins. They all agreed to three terms:  Everyone must gift as many coins as others. All coins given to Ivan must be different. Not less than L coins from gifts altogether, must be new in Ivan\'s collection.But his friends don\'t know which coins have Ivan already got in his collection. They don\'t want to spend money so they want to buy minimum quantity of coins, that satisfy all terms, irrespective of the Ivan\'s collection. Help them to find this minimum number of coins or define it\'s not possible to meet all the terms." 1400

1067E "Random Forest Rank" "dp,graph matchings,math,trees" "Let\'s define rank of undirected graph as rank of its adjacency matrix in Rn\xc3\x97n.Given a tree. Each edge of this tree will be deleted with probability 1/2, all these deletions are independent. Let E be the expected rank of resulting forest. Find E\xe2\x8b\x852n\xe2\x88\x921 modulo 998244353 (it is easy to show that E\xe2\x8b\x852n\xe2\x88\x921 is an integer)." 2800

1067D "Computer Game" dp,greedy,math,probabilities "Ivan plays some computer game. There are n quests in the game. Each quest can be upgraded once, this increases the reward for its completion. Each quest has 3 parameters ai, bi, pi: reward for completing quest before upgrade, reward for completing quest after upgrade (ai<bi) and probability of successful completing the quest.Each second Ivan can try to complete one quest and he will succeed with probability pi. In case of success Ivan will get the reward and opportunity to upgrade any one quest (not necessary the one he just completed). In case of failure he gets nothing. Quests do not vanish after completing.Ivan has t seconds. He wants to maximize expected value of his total gain after t seconds. Help him to calculate this value." 3100

1067C Knights "constructive algorithms" "Ivan places knights on infinite chessboard. Initially there are n knights. If there is free cell which is under attack of at least 4 knights then he places new knight in this cell. Ivan repeats this until there are no such free cells. One can prove that this process is finite. One can also prove that position in the end does not depend on the order in which new knights are placed.Ivan asked you to find initial placement of exactly n knights such that in the end there will be at least \xe2\x8c\x8an210\xe2\x8c\x8b knights." 2600

1067B Multihedgehog "dfs and similar,graphs,shortest paths" "Someone give a strange birthday present to Ivan. It is hedgehog�\xe2\x80\x94 connected undirected graph in which one vertex has degree at least 33 (we will call it center) and all other vertices has degree 1. Ivan thought that hedgehog is too boring and decided to make himself kk-multihedgehog.Let us define kk-multihedgehog as follows: 11-multihedgehog is hedgehog: it has one vertex of degree at least 33 and some vertices of degree 1. For all k\xe2\x89\xa52k\xe2\x89\xa52, kk-multihedgehog is (k\xe2\x88\x921)(k\xe2\x88\x921)-multihedgehog in which the following changes has been made for each vertex vv with degree 1: let uu be its only neighbor; remove vertex vv, create a new hedgehog with center at vertex ww and connect vertices uu and ww with an edge. New hedgehogs can differ from each other and the initial gift. Thereby kk-multihedgehog is a tree. Ivan made kk-multihedgehog but he is not sure that he did not make any mistakes. That is why he asked you to check if his tree is indeed kk-multihedgehog." 1800

1067A "Array Without Local Maximums" dp "Ivan unexpectedly saw a present from one of his previous birthdays. It is array of n numbers from 1 to 200. Array is old and some numbers are hard to read. Ivan remembers that for all elements at least one of its neighbours ls not less than it, more formally:a1\xe2\x89\xa4a2,an\xe2\x89\xa4an\xe2\x88\x921 andai\xe2\x89\xa4max(ai\xe2\x88\x921,ai+1) for all i from 2 to n\xe2\x88\x921.Ivan does not remember the array and asks to find the number of ways to restore it. Restored elements also should be integers from 1 to 200. Since the number of ways can be big, print it modulo 998244353." 1900

1066F "Yet another 2D Walking" dp "Maksim walks on a Cartesian plane. Initially, he stands at the point (0,0)(0,0) and in one move he can go to any of four adjacent points (left, right, up, down). For example, if Maksim is currently at the point (0,0)(0,0), he can go to any of the following points in one move:   (1,0)(1,0);  (0,1)(0,1);  (\xe2\x88\x921,0)(\xe2\x88\x921,0);  (0,\xe2\x88\x921)(0,\xe2\x88\x921). There are also nn distinct key points at this plane. The ii-th point is pi=(xi,yi)pi=(xi,yi). It is guaranteed that 0\xe2\x89\xa4xi0\xe2\x89\xa4xi and 0\xe2\x89\xa4yi0\xe2\x89\xa4yi and there is no key point (0,0)(0,0).Let the first level points be such points that max(xi,yi)=1max(xi,yi)=1, the second level points be such points that max(xi,yi)=2max(xi,yi)=2 and so on. Maksim wants to visit all the key points. But he shouldn\'t visit points of level i+1i+1 if he does not visit all the points of level ii. He starts visiting the points from the minimum level of point from the given set.The distance between two points (x1,y1)(x1,y1) and (x2,y2)(x2,y2) is |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2||x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2| where |v||v| is the absolute value of vv.Maksim wants to visit all the key points in such a way that the total distance he walks will be minimum possible. Your task is to find this distance.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 2100

1066E "Binary Numbers AND Sum" "data structures,implementation,math" "You are given two huge binary integer numbers a and b of lengths n and m respectively. You will repeat the following process: if b>0, then add to the answer the value a�&�b and divide b by 2 rounding down (i.e. remove the last digit of b), and repeat the process again, otherwise stop the process.The value a�&�b means bitwise AND of a and b. Your task is to calculate the answer modulo 998244353.Note that you should add the value a�&�b to the answer in decimal notation, not in binary. So your task is to calculate the answer in decimal notation. For example, if a=10102�(1010) and b=10002�(810), then the value a�&�b will be equal to 8, not to 1000." 1700

1066D "Boxes Packing" "binary search,implementation" "Maksim has n objects and m boxes, each box has size exactly k. Objects are numbered from 1 to n in order from left to right, the size of the i-th object is ai.Maksim wants to pack his objects into the boxes and he will pack objects by the following algorithm: he takes one of the empty boxes he has, goes from left to right through the objects, and if the i-th object fits in the current box (the remaining size of the box is greater than or equal to ai), he puts it in the box, and the remaining size of the box decreases by ai. Otherwise he takes the new empty box and continues the process above. If he has no empty boxes and there is at least one object not in some box then Maksim cannot pack the chosen set of objects.Maksim wants to know the maximum number of objects he can pack by the algorithm above. To reach this target, he will throw out the leftmost object from the set until the remaining set of objects can be packed in boxes he has. Your task is to say the maximum number of objects Maksim can pack in boxes he has.Each time when Maksim tries to pack the objects into the boxes, he will make empty all the boxes he has before do it (and the relative order of the remaining set of objects will not change)." 1800

1066C "Books Queries" implementation "You have got a shelf and want to put some books on it.You are given q queries of three types:  L id \xe2\x80\x94 put a book having index id on the shelf to the left from the leftmost existing book;  R id \xe2\x80\x94 put a book having index id on the shelf to the right from the rightmost existing book;  ? id \xe2\x80\x94 calculate the minimum number of books you need to pop from the left or from the right in such a way that the book with index id will be leftmost or rightmost. You can assume that the first book you will put can have any position (it does not matter) and queries of type 3 are always valid (it is guaranteed that the book in each such query is already placed). You can also assume that you don\'t put the same book on the shelf twice, so ids don\'t repeat in queries of first two types.Your problem is to answer all the queries of type 3 in order they appear in the input.Note that after answering the query of type 3 all the books remain on the shelf and the relative order of books does not change.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 1400

1066B Heaters "greedy,two pointers" "Vova\'s house is an array consisting of n elements (yeah, this is the first problem, I think, where someone lives in the array). There are heaters in some positions of the array. The i-th element of the array is 1 if there is a heater in the position i, otherwise the i-th element of the array is 0.Each heater has a value r (r is the same for all heaters). This value means that the heater at the position pos can warm up all the elements in range [pos\xe2\x88\x92r+1;pos+r\xe2\x88\x921].Vova likes to walk through his house while he thinks, and he hates cold positions of his house. Vova wants to switch some of his heaters on in such a way that each element of his house will be warmed up by at least one heater. Vova\'s target is to warm up the whole house (all the elements of the array), i.e. if n=6, r=2 and heaters are at positions 2 and 5, then Vova can warm up the whole house if he switches all the heaters in the house on (then the first 3 elements will be warmed up by the first heater and the last 3 elements will be warmed up by the second heater).Initially, all the heaters are off.But from the other hand, Vova didn\'t like to pay much for the electricity. So he wants to switch the minimum number of heaters on in such a way that each element of his house is warmed up by at least one heater.Your task is to find this number of heaters or say that it is impossible to warm up the whole house." 1500

1066A "Vova and Train" math "Vova plans to go to the conference by train. Initially, the train is at the point 1 and the destination point of the path is the point L. The speed of the train is 1 length unit per minute (i.e. at the first minute the train is at the point 1, at the second minute \xe2\x80\x94 at the point 2 and so on).There are lanterns on the path. They are placed at the points with coordinates divisible by v (i.e. the first lantern is at the point v, the second is at the point 2v and so on).There is also exactly one standing train which occupies all the points from l to r inclusive.Vova can see the lantern at the point p if p is divisible by v and there is no standing train at this position (p\xe2\x88\x89[l;r]). Thus, if the point with the lantern is one of the points covered by the standing train, Vova can\'t see this lantern.Your problem is to say the number of lanterns Vova will see during the path. Vova plans to go to t different conferences, so you should answer t independent queries." 1100

1065G "Fibonacci Suffix" strings "Let\'s denote (yet again) the sequence of Fibonacci strings:F(0)= 0, F(1)= 1, F(i)=F(i\xe2\x88\x922)+F(i\xe2\x88\x921), where the plus sign denotes the concatenation of two strings.Let\'s denote the lexicographically sorted sequence of suffixes of string F(i) as A(F(i)). For example, F(4) is 01101, and A(F(4)) is the following sequence: 01, 01101, 1, 101, 1101. Elements in this sequence are numbered from 1.Your task is to print m first characters of k-th element of A(F(n)). If there are less than m characters in this suffix, then output the whole suffix." 2700

1065F "Up and Down the Tree" "dfs and similar,dp,trees" "You are given a tree with nn vertices; its root is vertex 11. Also there is a token, initially placed in the root. You can move the token to other vertices. Let\'s assume current vertex of token is vv, then you make any of the following two possible moves:   move down to any leaf in subtree of vv;  if vertex vv is a leaf, then move up to the parent no more than kk times. In other words, if h(v)h(v) is the depth of vertex vv (the depth of the root is 00), then you can move to vertex toto such that toto is an ancestor of vv and h(v)\xe2\x88\x92k\xe2\x89\xa4h(to)h(v)\xe2\x88\x92k\xe2\x89\xa4h(to). Consider that root is not a leaf (even if its degree is 11). Calculate the maximum number of different leaves you can visit during one sequence of moves." 2500

1065E "Side Transmutations" combinatorics,strings "Consider some set of distinct characters A and some string S, consisting of exactly n characters, where each character is present in A.You are given an array of m integers b (b1<b2<\xe2\x8b\xaf<bm). You are allowed to perform the following move on the string S:  Choose some valid i and set k=bi;  Take the first k characters of S=Prk;  Take the last k characters of S=Suk;  Substitute the first k characters of S with the reversed Suk;  Substitute the last k characters of S with the reversed Prk. For example, let\'s take a look at S= ""abcdefghi"" and k=2. Pr2= ""ab"", Su2= ""hi"". Reversed Pr2= ""ba"", Su2= ""ih"". Thus, the resulting S is ""ihcdefgba"".The move can be performed arbitrary number of times (possibly zero). Any i can be selected multiple times over these moves.Let\'s call some strings S and T equal if and only if there exists such a sequence of moves to transmute string S to string T. For the above example strings ""abcdefghi"" and ""ihcdefgba"" are equal. Also note that this implies S=S.The task is simple. Count the number of distinct strings.The answer can be huge enough, so calculate it modulo 998244353." 2300

1065D "Three Pieces" "dfs and similar,dp,shortest paths" "You stumbled upon a new kind of chess puzzles. The chessboard you are given is not necesserily 8\xc3\x978, but it still is N\xc3\x97N. Each square has some number written on it, all the numbers are from 1 to N2 and all the numbers are pairwise distinct. The j-th square in the i-th row has a number Aij written on it.In your chess set you have only three pieces: a knight, a bishop and a rook. At first, you put one of them on the square with the number 1 (you can choose which one). Then you want to reach square 2 (possibly passing through some other squares in process), then square 3 and so on until you reach square N2. In one step you are allowed to either make a valid move with the current piece or replace it with some other piece. Each square can be visited arbitrary number of times.A knight can move to a square that is two squares away horizontally and one square vertically, or two squares vertically and one square horizontally. A bishop moves diagonally. A rook moves horizontally or vertically. The move should be performed to a different square from the one a piece is currently standing on.You want to minimize the number of steps of the whole traversal. Among all the paths to have the same number of steps you want to choose the one with the lowest number of piece replacements.What is the path you should take to satisfy all conditions?" 2200

1065C "Make It Equal" greedy "There is a toy building consisting of nn towers. Each tower consists of several cubes standing on each other. The ii-th tower consists of hihi cubes, so it has height hihi.Let\'s define operation slice on some height HH as following: for each tower ii, if its height is greater than HH, then remove some top cubes to make tower\'s height equal to HH. Cost of one ""slice"" equals to the total number of removed cubes from all towers.Let\'s name slice as good one if its cost is lower or equal to kk (k\xe2\x89\xa5nk\xe2\x89\xa5n).  Calculate the minimum number of good slices you have to do to make all towers have the same height. Of course, it is always possible to make it so." 1600

1065B "Vasya and Isolated Vertices" "constructive algorithms,graphs" "Vasya has got an undirected graph consisting of n vertices and m edges. This graph doesn\'t contain any self-loops or multiple edges. Self-loop is an edge connecting a vertex to itself. Multiple edges are a pair of edges such that they connect the same pair of vertices. Since the graph is undirected, the pair of edges (1,2) and (2,1) is considered to be multiple edges. Isolated vertex of the graph is a vertex such that there is no edge connecting this vertex to any other vertex.Vasya wants to know the minimum and maximum possible number of isolated vertices in an undirected graph consisting of n vertices and m edges." 1300

1065A "Vasya and Chocolate" implementation,math "There is a special offer in Vasya\'s favourite supermarket: if the customer buys a chocolate bars, he or she may take b additional bars for free. This special offer can be used any number of times.Vasya currently has s roubles, and he wants to get as many chocolate bars for free. Each chocolate bar costs c roubles. Help Vasya to calculate the maximum possible number of chocolate bars he can get!" 800

1064B "Equations of Mathematical Magic" math "Colossal!�\xe2\x80\x94 exclaimed Hawk-nose.�\xe2\x80\x94 A programmer! That\'s exactly what we are looking for.Arkadi and Boris Strugatsky. Monday starts on SaturdayReading the book ""Equations of Mathematical Magic"" Roman Oira-Oira and Cristobal Junta found an interesting equation: a\xe2\x88\x92(a\xe2\x8a\x95x)\xe2\x88\x92x=0 for some given a, where \xe2\x8a\x95 stands for a bitwise exclusive or (XOR) of two integers (this operation is denoted as ^ or xor in many modern programming languages). Oira-Oira quickly found some x, which is the solution of the equation, but Cristobal Junta decided that Oira-Oira\'s result is not interesting enough, so he asked his colleague how many non-negative solutions of this equation exist. This task turned out to be too difficult for Oira-Oira, so he asks you to help." 1200

1064A "Make a triangle!" "brute force,geometry,math" "Masha has three sticks of length a, b and c centimeters respectively. In one minute Masha can pick one arbitrary stick and increase its length by one centimeter. She is not allowed to break sticks.What is the minimum number of minutes she needs to spend increasing the stick\'s length in order to be able to assemble a triangle of positive area. Sticks should be used as triangle\'s sides (one stick for one side) and their endpoints should be located at triangle\'s vertices." 800

1063F "String Journey" "data structures,dp,string suffix structures" "We call a sequence of strings t1,\xe2\x80\x89...,\xe2\x80\x89tk a journey of length k, if for each i\xe2\x80\x89>\xe2\x80\x891 ti is a substring of ti\xe2\x80\x89-\xe2\x80\x891 and length of ti is strictly less than length of ti\xe2\x80\x89-\xe2\x80\x891. For example, {ab,\xe2\x80\x89b} is a journey, but {ab,\xe2\x80\x89c} and {a,\xe2\x80\x89a} are not.Define a journey on string s as journey t1,\xe2\x80\x89...,\xe2\x80\x89tk, such that all its parts can be nested inside s in such a way that there exists a sequence of strings u1,\xe2\x80\x89...,\xe2\x80\x89uk\xe2\x80\x89+\xe2\x80\x891 (each of these strings can be empty) and s\xe2\x80\x89=\xe2\x80\x89u1\xe2\x80\x89t1\xe2\x80\x89u2\xe2\x80\x89t2... uk\xe2\x80\x89tk\xe2\x80\x89uk\xe2\x80\x89+\xe2\x80\x891. As an example, {ab,\xe2\x80\x89b} is a journey on string abb, but not on bab because the journey strings ti should appear from the left to the right.The length of a journey on a string is the number of strings in it. Determine the maximum possible length of a journey on the given string s." 3300

1063E "Lasers and Mirrors" "constructive algorithms,math" "Oleg came to see the maze of mirrors. The maze is a nn by nn room in which each cell is either empty or contains a mirror connecting opposite corners of this cell. Mirrors in this maze reflect light in a perfect way, which causes the interesting visual effects and contributes to the loss of orientation in the maze.Oleg is a person of curious nature, so he decided to install nn lasers facing internal of the maze on the south wall of the maze. On the north wall of the maze, Oleg installed nn receivers, also facing internal of the maze. Let\'s number lasers and receivers from west to east with distinct integers from 11 to nn. Each laser sends a beam of some specific kind and receiver with number aiai should receive the beam sent from laser number ii. Since two lasers\' beams can\'t come to the same receiver, these numbers form a permutation�\xe2\x80\x94 each of the receiver numbers occurs exactly once.You came to the maze together with Oleg. Help him to place the mirrors in the initially empty maze so that the maximum number of lasers\' beams will come to the receivers they should. There are no mirrors outside the maze, so if the laser beam leaves the maze, it will not be able to go back." 3000

1063D "Candies for Children" "brute force,math" "At the children\'s festival, children were dancing in a circle. When music stopped playing, the children were still standing in a circle. Then Lena remembered, that her parents gave her a candy box with exactly k candies ""Wilky�May"". Lena is not a greedy person, so she decided to present all her candies to her friends in the circle. Lena knows, that some of her friends have a sweet tooth and others do not. Sweet tooth takes out of the box two candies, if the box has at least two candies, and otherwise takes one. The rest of Lena\'s friends always take exactly one candy from the box.Before starting to give candies, Lena step out of the circle, after that there were exactly n people remaining there. Lena numbered her friends in a clockwise order with positive integers starting with 1 in such a way that index 1 was assigned to her best friend Roma.Initially, Lena gave the box to the friend with number l, after that each friend (starting from friend number l) took candies from the box and passed the box to the next friend in clockwise order. The process ended with the friend number r taking the last candy (or two, who knows) and the empty box. Please note that it is possible that some of Lena\'s friends took candy from the box several times, that is, the box could have gone several full circles before becoming empty.Lena does not know which of her friends have a sweet tooth, but she is interested in the maximum possible number of friends that can have a sweet tooth. If the situation could not happen, and Lena have been proved wrong in her observations, please tell her about this." 2600

1063C "Dwarves, Hats and Extrasensory Abilities" "binary search,constructive algorithms,geometry,interactive" "This is an interactive problem.In good old times dwarves tried to develop extrasensory abilities:  Exactly n dwarves entered completely dark cave.  Each dwarf received a hat�\xe2\x80\x94 white or black. While in cave, none of the dwarves was able to see either his own hat or hats of other Dwarves.  Dwarves went out of the cave to the meadow and sat at an arbitrary place one after the other. When a dwarf leaves the cave, he sees the colors of all hats of all dwarves that are seating on the meadow (i.e. left the cave before him). However, he is not able to see the color of his own hat and none of the dwarves can give him this information.  The task for dwarves was to got diverged into two parts�\xe2\x80\x94 one with dwarves with white hats and one with black hats. After many centuries, dwarves finally managed to select the right place on the meadow without error. Will you be able to repeat their success?You are asked to successively name n different integer points on the plane. After naming each new point you will be given its color�\xe2\x80\x94 black or white. Your task is to ensure that the named points can be split by a line in such a way that all points of one color lie on the same side from the line and points of different colors lie on different sides. Moreover, no points can belong to the line. Also, you need to report any such line at the end of the process.In this problem, the interactor is adaptive�\xe2\x80\x94 the colors of the points in the tests are not fixed beforehand and the jury program can select them arbitrarily, in particular, depending on your program output." 1900

1063B Labyrinth "graphs,shortest paths" "You are playing some computer game. One of its levels puts you in a maze consisting of n lines, each of which contains m cells. Each cell either is free or is occupied by an obstacle. The starting cell is in the row r and column c. In one step you can move one square up, left, down or right, if the target cell is not occupied by an obstacle. You can\'t move beyond the boundaries of the labyrinth.Unfortunately, your keyboard is about to break, so you can move left no more than x times and move right no more than y times. There are no restrictions on the number of moves up and down since the keys used to move up and down are in perfect condition.Now you would like to determine for each cell whether there exists a sequence of moves that will put you from the starting cell to this particular one. How many cells of the board have this property?" 1800

1063A "Oh Those Palindromes" "constructive algorithms,strings" "A non-empty string is called palindrome, if it reads the same from the left to the right and from the right to the left. For example, ""abcba"", ""a"", and ""abba"" are palindromes, while ""abab"" and ""xy"" are not.A string is called a substring of another string, if it can be obtained from that string by dropping some (possibly zero) number of characters from the beginning and from the end of it. For example, ""abc"", ""ab"", and ""c"" are substrings of the string ""abc"", while ""ac"" and ""d"" are not.Let\'s define a palindromic count of the string as the number of its substrings that are palindromes. For example, the palindromic count of the string ""aaa"" is 6 because all its substrings are palindromes, and the palindromic count of the string ""abc"" is 3 because only its substrings of length 1 are palindromes.You are given a string s. You can arbitrarily rearrange its characters. You goal is to obtain a string with the maximum possible value of palindromic count." 1300

1062F "Upgrading Cities" "dfs and similar,graphs" "There are nn cities in the kingdom XX, numbered from 11 through nn. People travel between cities by some one-way roads. As a passenger, JATC finds it weird that from any city uu, he can\'t start a trip in it and then return back to it using the roads of the kingdom. That is, the kingdom can be viewed as an acyclic graph.Being annoyed by the traveling system, JATC decides to meet the king and ask him to do something. In response, the king says that he will upgrade some cities to make it easier to travel. Because of the budget, the king will only upgrade those cities that are important or semi-important. A city uu is called important if for every city v\xe2\x89\xa0uv\xe2\x89\xa0u, there is either a path from uu to vv or a path from vv to uu. A city uu is called semi-important if it is not important and we can destroy exactly one city v\xe2\x89\xa0uv\xe2\x89\xa0u so that uu becomes important.The king will start to act as soon as he finds out all those cities. Please help him to speed up the process." 2900

1062E Company "binary search,data structures,dfs and similar,greedy,trees" "The company XX has nn employees numbered from 11 through nn. Each employee uu has a direct boss pupu (1\xe2\x89\xa4pu\xe2\x89\xa4n1\xe2\x89\xa4pu\xe2\x89\xa4n), except for the employee 11 who has no boss. It is guaranteed, that values pipi form a tree. Employee uu is said to be in charge of employee vv if uu is the direct boss of vv or there is an employee ww such that ww is in charge of vv and uu is the direct boss of ww. Also, any employee is considered to be in charge of himself.In addition, for each employee uu we define it\'s level lv(u)lv(u) as follow:   lv(1)=0lv(1)=0  lv(u)=lv(pu)+1lv(u)=lv(pu)+1 for u\xe2\x89\xa01u\xe2\x89\xa01 In the near future, there are qq possible plans for the company to operate. The ii-th plan consists of two integers lili and riri, meaning that all the employees in the range [li,ri][li,ri], and only they, are involved in this plan. To operate the plan smoothly, there must be a project manager who is an employee in charge of all the involved employees. To be precise, if an employee uu is chosen as the project manager for the ii-th plan then for every employee v\xe2\x88\x88[li,ri]v\xe2\x88\x88[li,ri], uu must be in charge of vv. Note, that uu is not necessary in the range [li,ri][li,ri]. Also, uu is always chosen in such a way that lv(u)lv(u) is as large as possible (the higher the level is, the lower the salary that the company has to pay the employee).Before any plan is operated, the company has JATC take a look at their plans. After a glance, he tells the company that for every plan, it\'s possible to reduce the number of the involved employees exactly by one without affecting the plan. Being greedy, the company asks JATC which employee they should kick out of the plan so that the level of the project manager required is as large as possible. JATC has already figured out the answer and challenges you to do the same." 2300

1062D "Fun with Integers" "dfs and similar,graphs,implementation,math" "You are given a positive integer n greater or equal to 2. For every pair of integers a and b (2\xe2\x89\xa4|a|,|b|\xe2\x89\xa4n), you can transform a into b if and only if there exists an integer x such that 1<|x| and (a\xe2\x8b\x85x=b or b\xe2\x8b\x85x=a), where |x| denotes the absolute value of x.After such a transformation, your score increases by |x| points and you are not allowed to transform a into b nor b into a anymore.Initially, you have a score of 0. You can start at any integer and transform it as many times as you like. What is the maximum score you can achieve?" 1800

1062C Banh-mi greedy,implementation,math "JATC loves Banh-mi (a Vietnamese food). His affection for Banh-mi is so much that he always has it for breakfast. This morning, as usual, he buys a Banh-mi and decides to enjoy it in a special way.First, he splits the Banh-mi into n parts, places them on a row and numbers them from 1 through n. For each part i, he defines the deliciousness of the part as xi\xe2\x88\x88{0,1}. JATC\'s going to eat those parts one by one. At each step, he chooses arbitrary remaining part and eats it. Suppose that part is the i-th part then his enjoyment of the Banh-mi will increase by xi and the deliciousness of all the remaining parts will also increase by xi. The initial enjoyment of JATC is equal to 0.For example, suppose the deliciousness of 3 parts are [0,1,0]. If JATC eats the second part then his enjoyment will become 1 and the deliciousness of remaining parts will become [1,_,1]. Next, if he eats the first part then his enjoyment will become 2 and the remaining parts will become [_,_,2]. After eating the last part, JATC\'s enjoyment will become 4.However, JATC doesn\'t want to eat all the parts but to save some for later. He gives you q queries, each of them consisting of two integers li and ri. For each query, you have to let him know what is the maximum enjoyment he can get if he eats all the parts with indices in the range [li,ri] in some order.All the queries are independent of each other. Since the answer to the query could be very large, print it modulo 109+7." 1600

1062B Math "greedy,math,number theory" "JATC\'s math teacher always gives the class some interesting math problems so that they don\'t get bored. Today the problem is as follows. Given an integer n, you can perform the following operations zero or more times:  mul x: multiplies n by x (where x is an arbitrary positive integer).  sqrt: replaces n with \xe2\x88\x9an (to apply this operation, \xe2\x88\x9an must be an integer). You can perform these operations as many times as you like. What is the minimum value of n, that can be achieved and what is the minimum number of operations, to achieve that minimum value?Apparently, no one in the class knows the answer to this problem, maybe you can help them?" 1500

1062A "A Prank" greedy,implementation "JATC and his friend Giraffe are currently in their room, solving some problems. Giraffe has written on the board an array a1, a2, ..., an of integers, such that 1\xe2\x89\xa4a1<a2<\xe2\x80\xa6<an\xe2\x89\xa4103, and then went to the bathroom.JATC decided to prank his friend by erasing some consecutive elements in the array. Since he doesn\'t want for the prank to go too far, he will only erase in a way, such that Giraffe can still restore the array using the information from the remaining elements. Because Giraffe has created the array, he\'s also aware that it\'s an increasing array and all the elements are integers in the range [1,103].JATC wonders what is the greatest number of elements he can erase?" 1300

1061F "Lost Root" interactive,probabilities "The graph is called tree if it is connected and has no cycles. Suppose the tree is rooted at some vertex. Then tree is called to be perfect kk-ary tree if each vertex is either a leaf (has no children) or has exactly kk children. Also, in perfect kk-ary tree all leafs must have same depth.For example, the picture below illustrates perfect binary tree with 1515 vertices:There is a perfect kk-ary tree with nn nodes. The nodes are labeled with distinct integers from 11 to nn, however you don\'t know how nodes are labelled. Still, you want to find the label of the root of the tree.You are allowed to make at most 60\xe2\x8b\x85n60\xe2\x8b\x85n queries of the following type:  ""? aa bb cc"", the query returns ""Yes"" if node with label bb lies on the path from aa to cc and ""No"" otherwise. Both aa and cc are considered to be lying on the path from aa to cc.When you are ready to report the root of the tree, print   ""! ss"", where ss is the label of the root of the tree. It is possible to report the root only once and this query is not counted towards limit of 60\xe2\x8b\x85n60\xe2\x8b\x85n queries." 2400

1061E Politics flows,graphs "There are n cities in the country. Two candidates are fighting for the post of the President. The elections are set in the future, and both candidates have already planned how they are going to connect the cities with roads. Both plans will connect all cities using n\xe2\x88\x921 roads only. That is, each plan can be viewed as a tree. Both of the candidates had also specified their choice of the capital among n cities (x for the first candidate and y for the second candidate), which may or may not be same.Each city has a potential of building a port (one city can have at most one port). Building a port in i-th city brings ai amount of money. However, each candidate has his specific demands. The demands are of the form:   k x, which means that the candidate wants to build exactly x ports in the subtree of the k-th city of his tree (the tree is rooted at the capital of his choice). Find out the maximum revenue that can be gained while fulfilling all demands of both candidates, or print -1 if it is not possible to do.It is additionally guaranteed, that each candidate has specified the port demands for the capital of his choice." 2600

1061D "TV Shows" "data structures,greedy,implementation,sortings" "There are n TV shows you want to watch. Suppose the whole time is split into equal parts called ""minutes"". The i-th of the shows is going from li-th to ri-th minute, both ends inclusive.You need a TV to watch a TV show and you can\'t watch two TV shows which air at the same time on the same TV, so it is possible you will need multiple TVs in some minutes. For example, if segments [li,ri] and [lj,rj] intersect, then shows i and j can\'t be watched simultaneously on one TV.Once you start watching a show on some TV it is not possible to ""move"" it to another TV (since it would be too distracting), or to watch another show on the same TV until this show ends.There is a TV Rental shop near you. It rents a TV for x rupees, and charges y (y<x) rupees for every extra minute you keep the TV. So in order to rent a TV for minutes [a;b] you will need to pay x+y\xe2\x8b\x85(b\xe2\x88\x92a). You can assume, that taking and returning of the TV doesn\'t take any time and doesn\'t distract from watching other TV shows. Find the minimum possible cost to view all shows. Since this value could be too large, print it modulo 109+7." 2000

1061C Multiplicity "data structures,dp,implementation,math,number theory" "You are given an integer array a1,a2,\xe2\x80\xa6,an.The array b is called to be a subsequence of a if it is possible to remove some elements from a to get b.Array b1,b2,\xe2\x80\xa6,bk is called to be good if it is not empty and for every i (1\xe2\x89\xa4i\xe2\x89\xa4k) bi is divisible by i.Find the number of good subsequences in a modulo 109+7. Two subsequences are considered different if index sets of numbers included in them are different. That is, the values \xe2\x80\x8bof the elements \xe2\x80\x8bdo not matter in the comparison of subsequences. In particular, the array a has exactly 2n\xe2\x88\x921 different subsequences (excluding an empty subsequence)." 1700

1061B "Views Matter" greedy,implementation,sortings "You came to the exhibition and one exhibit has drawn your attention. It consists of n stacks of blocks, where the i-th stack consists of ai blocks resting on the surface.The height of the exhibit is equal to m. Consequently, the number of blocks in each stack is less than or equal to m.There is a camera on the ceiling that sees the top view of the blocks and a camera on the right wall that sees the side view of the blocks. Find the maximum number of blocks you can remove such that the views for both the cameras would not change.Note, that while originally all blocks are stacked on the floor, it is not required for them to stay connected to the floor after some blocks are removed. There is no gravity in the whole exhibition, so no block would fall down, even if the block underneath is removed. It is not allowed to move blocks by hand either." 1400

1061A Coins greedy,implementation,math "You have unlimited number of coins with values 1,2,\xe2\x80\xa6,n. You want to select some set of coins having the total value of S. It is allowed to have multiple coins with the same value in the set. What is the minimum number of coins required to get sum S?" 800

1060H "Sophisticated Device" "constructive algorithms" "You are given integers d and p, p is prime. Also you have a mysterious device. It has memory cells, each contains an integer between 0 and p\xe2\x88\x921. Also two instructions are supported, addition and raising to the d-th power. Both are modulo p.The memory cells are numbered 1,2,\xe2\x80\xa6,5000. Initially cells 1 and 2 contain integers x and y, respectively (0\xe2\xa9\xbdx,y\xe2\x89\xa4p\xe2\x88\x921). All other cells contain 1s. You can not directly access values in cells, and you don\'t know values of x and y (but you know they are written in first two cells). You mission, should you choose to accept it, is to write a program using the available instructions to obtain the product xy modulo p in one of the cells. You program should work for all possible x and y.Addition instruction evaluates sum of values in two cells and writes it to third cell. This instruction is encoded by a string ""+ e1 e2 to"", which writes sum of values in cells e1 and e2 into cell to. Any values of e1, e2, to can coincide. Second instruction writes the d-th power of a value in some cell to the target cell. This instruction is encoded by a string ""^ e to"". Values e and to can coincide, in this case value in the cell will be overwritten. Last instruction is special, this is the return instruction, and it is encoded by a string ""f target"". This means you obtained values xymodp in the cell target. No instructions should be called after this instruction.Provide a program that obtains xymodp and uses no more than 5000 instructions (including the return instruction).It is guaranteed that, under given constrains, a solution exists." 3300

1060G "Balls and Pockets" "data structures" "There is a strip with an infinite number of cells. Cells are numbered starting with 0. Initially the cell i contains a ball with the number i.There are n pockets located at cells a1,\xe2\x80\xa6,an. Each cell contains at most one pocket.Filtering is the following sequence of operations: All pockets at cells a1,\xe2\x80\xa6,an open simultaneously, which makes balls currently located at those cells disappear. After the balls disappear, the pockets close again. For each cell i from 0 to \xe2\x88\x9e, if the cell i contains a ball, we move that ball to the free cell j with the lowest number. If there is no free cell j<i, the ball stays at the cell i.Note that after each filtering operation each cell will still contain exactly one ball.For example, let the cells 1, 3 and 4 contain pockets. The initial configuration of balls is shown below (underscores display the cells with pockets): 0 1 2 3 4 5 6 7 8 9 ... After opening and closing the pockets, balls 1, 3 and 4 disappear: 0 � 2 � � 5 6 7 8 9 ... After moving all the balls to the left, the configuration looks like this: 0 2 5 6 7 8 9 10 11 12 ... Another filtering repetition results in the following: 0 5 8 9 10 11 12 13 14 15 ... You have to answer m questions. The i-th of these questions is ""what is the number of the ball located at the cell xi after ki repetitions of the filtering operation?""" 3400

1060F "Shrinking Tree" combinatorics,dp "Consider a tree T (that is, a connected graph without cycles) with n vertices labelled 1 through n. We start the following process with T: while T has more than one vertex, do the following: choose a random edge of T equiprobably; shrink the chosen edge: if the edge was connecting vertices v and u, erase both v and u and create a new vertex adjacent to all vertices previously adjacent to either v or u. The new vertex is labelled either v or u equiprobably.At the end of the process, T consists of a single vertex labelled with one of the numbers 1,\xe2\x80\xa6,n. For each of the numbers, what is the probability of this number becoming the label of the final vertex?" 2900

1060E "Sergey and Subway" "dfs and similar,dp,trees" "Sergey Semyonovich is a mayor of a county city N and he used to spend his days and nights in thoughts of further improvements of Nkers\' lives. Unfortunately for him, anything and everything has been done already, and there are no more possible improvements he can think of during the day (he now prefers to sleep at night). However, his assistants have found a solution and they now draw an imaginary city on a paper sheet and suggest the mayor can propose its improvements.Right now he has a map of some imaginary city with n subway stations. Some stations are directly connected with tunnels in such a way that the whole map is a tree (assistants were short on time and enthusiasm). It means that there exists exactly one simple path between each pair of station. We call a path simple if it uses each tunnel no more than once.One of Sergey Semyonovich\'s favorite quality objectives is the sum of all pairwise distances between every pair of stations. The distance between two stations is the minimum possible number of tunnels on a path between them.Sergey Semyonovich decided to add new tunnels to the subway map. In particular, he connected any two stations u and v that were not connected with a direct tunnel but share a common neighbor, i.e. there exists such a station w that the original map has a tunnel between u and w and a tunnel between w and v. You are given a task to compute the sum of pairwise distances between all pairs of stations in the new map." 2000

1060D "Social Circles" greedy,math "You invited n guests to dinner! You plan to arrange one or more circles of chairs. Each chair is going to be either occupied by one guest, or be empty. You can make any number of circles. Your guests happen to be a little bit shy, so the i-th guest wants to have a least li free chairs to the left of his chair, and at least ri free chairs to the right. The ""left"" and ""right"" directions are chosen assuming all guests are going to be seated towards the center of the circle. Note that when a guest is the only one in his circle, the li chairs to his left and ri chairs to his right may overlap.What is smallest total number of chairs you have to use?" 1900

1060C "Maximum Subrectangle" "binary search,implementation,two pointers" "You are given two arrays aa and bb of positive integers, with length nn and mm respectively. Let cc be an n\xc3\x97mn\xc3\x97m matrix, where ci,j=ai\xe2\x8b\x85bjci,j=ai\xe2\x8b\x85bj. You need to find a subrectangle of the matrix cc such that the sum of its elements is at most xx, and its area (the total number of elements) is the largest possible.Formally, you need to find the largest number ss such that it is possible to choose integers x1,x2,y1,y2x1,x2,y1,y2 subject to 1\xe2\x89\xa4x1\xe2\x89\xa4x2\xe2\x89\xa4n1\xe2\x89\xa4x1\xe2\x89\xa4x2\xe2\x89\xa4n, 1\xe2\x89\xa4y1\xe2\x89\xa4y2\xe2\x89\xa4m1\xe2\x89\xa4y1\xe2\x89\xa4y2\xe2\x89\xa4m, (x2\xe2\x88\x92x1+1)\xc3\x97(y2\xe2\x88\x92y1+1)=s(x2\xe2\x88\x92x1+1)\xc3\x97(y2\xe2\x88\x92y1+1)=s, and x2\xe2\x88\x91i=x1y2\xe2\x88\x91j=y1ci,j\xe2\x89\xa4x.\xe2\x88\x91i=x1x2\xe2\x88\x91j=y1y2ci,j\xe2\x89\xa4x." 1600

1060B "Maximum Sum of Digits" greedy "You are given a positive integer n.Let S(x) be sum of digits in base 10 representation of x, for example, S(123)=1+2+3=6, S(0)=0.Your task is to find two integers a,b, such that 0\xe2\x89\xa4a,b\xe2\x89\xa4n, a+b=n and S(a)+S(b) is the largest possible among all such pairs." 1100

1060A "Phone Numbers" "brute force" "Let\'s call a string a phone number if it has length 11 and fits the pattern ""8xxxxxxxxxx"", where each ""x"" is replaced by a digit.For example, ""80123456789"" and ""80000000000"" are phone numbers, while ""8012345678"" and ""79000000000"" are not.You have n cards with digits, and you want to use them to make as many phone numbers as possible. Each card must be used in at most one phone number, and you don\'t have to use all cards. The phone numbers do not necessarily have to be distinct." 800

1059E "Split the Tree" "binary search,data structures,dp,greedy,trees" "You are given a rooted tree on n vertices, its root is the vertex number 1. The i-th vertex contains a number wi. Split it into the minimum possible number of vertical paths in such a way that each path contains no more than L vertices and the sum of integers wi on each path does not exceed S. Each vertex should belong to exactly one path.A vertical path is a sequence of vertices v1,v2,\xe2\x80\xa6,vk where vi (i\xe2\x89\xa52) is the parent of vi\xe2\x88\x921." 2400

1059D "Nature Reserve" "binary search,geometry,ternary search" "There is a forest that we model as a plane and live n rare animals. Animal number i has its lair in the point (xi,yi). In order to protect them, a decision to build a nature reserve has been made.The reserve must have a form of a circle containing all lairs. There is also a straight river flowing through the forest. All animals drink from this river, therefore it must have at least one common point with the reserve. On the other hand, ships constantly sail along the river, so the reserve must not have more than one common point with the river.For convenience, scientists have made a transformation of coordinates so that the river is defined by y=0. Check whether it is possible to build a reserve, and if possible, find the minimum possible radius of such a reserve." 2200

1059C "Sequence Transformation" "constructive algorithms,math" "Let\'s call the following process a transformation of a sequence of length n.If the sequence is empty, the process ends. Otherwise, append the greatest common divisor (GCD) of all the elements of the sequence to the result and remove one arbitrary element from the sequence. Thus, when the process ends, we have a sequence of n integers: the greatest common divisors of all the elements in the sequence before each deletion.You are given an integer sequence 1,2,\xe2\x80\xa6,n. Find the lexicographically maximum result of its transformation.A sequence a1,a2,\xe2\x80\xa6,an is lexicographically larger than a sequence b1,b2,\xe2\x80\xa6,bn, if there is an index i such that aj=bj for all j<i, and ai>bi." 1600

1059B Forgery implementation "Student Andrey has been skipping physical education lessons for the whole term, and now he must somehow get a passing grade on this subject. Obviously, it is impossible to do this by legal means, but Andrey doesn\'t give up. Having obtained an empty certificate from a local hospital, he is going to use his knowledge of local doctor\'s handwriting to make a counterfeit certificate of illness. However, after writing most of the certificate, Andrey suddenly discovered that doctor\'s signature is impossible to forge. Or is it?For simplicity, the signature is represented as an n\xc3\x97m grid, where every cell is either filled with ink or empty. Andrey\'s pen can fill a 3\xc3\x973 square without its central cell if it is completely contained inside the grid, as shown below. xxxx.xxxx Determine whether is it possible to forge the signature on an empty n\xc3\x97m grid." 1300

1059A Cashier implementation "Vasya has recently got a job as a cashier at a local store. His day at work is L minutes long. Vasya has already memorized n regular customers, the i-th of which comes after ti minutes after the beginning of the day, and his service consumes li minutes. It is guaranteed that no customer will arrive while Vasya is servicing another customer. Vasya is a bit lazy, so he likes taking smoke breaks for a minutes each. Those breaks may go one after another, but Vasya must be present at work during all the time periods he must serve regular customers, otherwise one of them may alert his boss. What is the maximum number of breaks Vasya can take during the day?" 1000

1057C "Tanya and Colored Candies" "*special problem,dp" "There are nn candy boxes in front of Tania. The boxes are arranged in a row from left to right, numbered from 11 to nn. The ii-th box contains riri candies, candies have the color cici (the color can take one of three values \xe2\x80\x8b\xe2\x80\x8b\xe2\x80\x94 red, green, or blue). All candies inside a single box have the same color (and it is equal to cici).Initially, Tanya is next to the box number ss. Tanya can move to the neighbor box (that is, with a number that differs by one) or eat candies in the current box. Tanya eats candies instantly, but the movement takes one second.If Tanya eats candies from the box, then the box itself remains in place, but there is no more candies in it. In other words, Tanya always eats all the candies from the box and candies in the boxes are not refilled.It is known that Tanya cannot eat candies of the same color one after another (that is, the colors of candies in two consecutive boxes from which she eats candies are always different). In addition, Tanya\'s appetite is constantly growing, so in each next box from which she eats candies, there should be strictly more candies than in the previous one.Note that for the first box from which Tanya will eat candies, there are no restrictions on the color and number of candies.Tanya wants to eat at least kk candies. What is the minimum number of seconds she will need? Remember that she eats candies instantly, and time is spent only on movements." 2000

1057B DDoS "*special problem,brute force" "We get more and more news about DDoS-attacks of popular websites.Arseny is an admin and he thinks that a website is under a DDoS-attack if the total number of requests for a some period of time exceeds 100\xe2\x8b\x85t, where t \xe2\x80\x94 the number of seconds in this time segment. Arseny knows statistics on the number of requests per second since the server is booted. He knows the sequence r1,r2,\xe2\x80\xa6,rn, where ri \xe2\x80\x94 the number of requests in the i-th second after boot. Determine the length of the longest continuous period of time, which Arseny considers to be a DDoS-attack. A seeking time period should not go beyond the boundaries of the segment [1,n]." 1400

1057A "Bmail Computer Network" "*special problem,dfs and similar,trees" "Once upon a time there was only one router in the well-known company Bmail. Years went by and over time new routers were purchased. Every time they bought a new router, they connected it to one of the routers bought before it. You are given the values pi \xe2\x80\x94 the index of the router to which the i-th router was connected after being purchased (pi<i).There are n routers in Boogle in total now. Print the sequence of routers on the path from the first to the n-th router." 900

1056H "Detect Robots" "data structures,strings" "You successfully found poor Arkady near the exit of the station you\'ve perfectly predicted. You sent him home on a taxi and suddenly came up with a question.There are n crossroads in your city and several bidirectional roads connecting some of them. A taxi ride is a path from some crossroads to another one without passing the same crossroads twice. You have a collection of rides made by one driver and now you wonder if this driver can be a robot or they are definitely a human.You think that the driver can be a robot if for every two crossroads a and b the driver always chooses the same path whenever he drives from a to b. Note that a and b here do not have to be the endpoints of a ride and that the path from b to a can be different. On the contrary, if the driver ever has driven two different paths from a to b, they are definitely a human.Given the system of roads and the description of all rides available to you, determine if the driver can be a robot or not." 3200

1056G "Take Metro" "brute force,data structures,graphs" "Having problems with tram routes in the morning, Arkady decided to return home by metro. Fortunately for Arkady, there is only one metro line in the city.Unfortunately for Arkady, the line is circular. It means that the stations are enumerated from 1 to n and there is a tunnel between any pair of consecutive stations as well as between the station 1 and the station n. Trains that go in clockwise direction visit the stations in order 1\xe2\x86\x922\xe2\x86\x923\xe2\x86\x92\xe2\x80\xa6\xe2\x86\x92n\xe2\x86\x921 while the trains that go in the counter-clockwise direction visit the stations in the reverse order.The stations that have numbers from 1 to m have interior mostly in red colors while the stations that have numbers from m+1 to n have blue interior. Arkady entered the metro at station s and decided to use the following algorithm to choose his way home.  Initially he has a positive integer t in his mind.  If the current station has red interior, he takes a clockwise-directed train, otherwise he takes a counter-clockwise-directed train.  He rides exactly t stations on the train and leaves the train.  He decreases t by one. If t is still positive, he returns to step 2. Otherwise he exits the metro. You have already realized that this algorithm most probably won\'t bring Arkady home. Find the station he will exit the metro at so that you can continue helping him." 2900

1056F "Write The Contest" "binary search,dp,math" "Polycarp, Arkady\'s friend, prepares to the programming competition and decides to write a contest. The contest consists of n problems and lasts for T minutes. Each of the problems is defined by two positive integers ai and pi�\xe2\x80\x94 its difficulty and the score awarded by its solution.Polycarp\'s experience suggests that his skill level is defined with positive real value s, and initially s=1.0. To solve the i-th problem Polycarp needs ai/s minutes.Polycarp loves to watch series, and before solving each of the problems he will definitely watch one episode. After Polycarp watches an episode, his skill decreases by 10%, that is skill level s decreases to 0.9s. Each episode takes exactly 10 minutes to watch. When Polycarp decides to solve some problem, he firstly has to watch one episode, and only then he starts solving the problem without breaks for ai/s minutes, where s is his current skill level. In calculation of ai/s no rounding is performed, only division of integer value ai by real value s happens.Also, Polycarp can train for some time. If he trains for t minutes, he increases his skill by C\xe2\x8b\x85t, where C is some given positive real constant. Polycarp can train only before solving any problem (and before watching series). Duration of the training can be arbitrary real value.Polycarp is interested: what is the largest score he can get in the contest? It is allowed to solve problems in any order, while training is only allowed before solving the first problem." 2500

1056E "Check Transcription" "brute force,data structures,hashing,strings" "One of Arkady\'s friends works at a huge radio telescope. A few decades ago the telescope has sent a signal s towards a faraway galaxy. Recently they\'ve received a response t which they believe to be a response from aliens! The scientists now want to check if the signal t is similar to s.The original signal s was a sequence of zeros and ones (everyone knows that binary code is the universe-wide language). The returned signal t, however, does not look as easy as s, but the scientists don\'t give up! They represented t as a sequence of English letters and say that t is similar to s if you can replace all zeros in s with some string r0 and all ones in s with some other string r1 and obtain t. The strings r0 and r1 must be different and non-empty.Please help Arkady\'s friend and find the number of possible replacements for zeros and ones (the number of pairs of strings r0 and r1) that transform s to t." 2100

1056D "Decorate Apple Tree" "constructive algorithms,dfs and similar,dp,graphs,greedy,sortings,trees" "There is one apple tree in Arkady\'s garden. It can be represented as a set of junctions connected with branches so that there is only one way to reach any junctions from any other one using branches. The junctions are enumerated from 1 to n, the junction 1 is called the root.A subtree of a junction v is a set of junctions u such that the path from u to the root must pass through v. Note that v itself is included in a subtree of v.A leaf is such a junction that its subtree contains exactly one junction.The New Year is coming, so Arkady wants to decorate the tree. He will put a light bulb of some color on each leaf junction and then count the number happy junctions. A happy junction is such a junction t that all light bulbs in the subtree of t have different colors.Arkady is interested in the following question: for each k from 1 to n, what is the minimum number of different colors needed to make the number of happy junctions be greater than or equal to k?" 1600

1056C "Pick Heroes" greedy,implementation,interactive,sortings "Don\'t you tell me what you think that I can beIf you say that Arkady is a bit old-fashioned playing checkers, you won\'t be right. There is also a modern computer game Arkady and his friends are keen on. We won\'t discuss its rules, the only feature important to this problem is that each player has to pick a distinct hero in the beginning of the game.There are 2 teams each having n players and 2n heroes to distribute between the teams. The teams take turns picking heroes: at first, the first team chooses a hero in its team, after that the second team chooses a hero and so on. Note that after a hero is chosen it becomes unavailable to both teams.The friends estimate the power of the i-th of the heroes as pi. Each team wants to maximize the total power of its heroes. However, there is one exception: there are m pairs of heroes that are especially strong against each other, so when any team chooses a hero from such a pair, the other team must choose the other one on its turn. Each hero is in at most one such pair.This is an interactive problem. You are to write a program that will optimally choose the heroes for one team, while the jury\'s program will play for the other team. Note that the jury\'s program may behave inefficiently, in this case you have to take the opportunity and still maximize the total power of your team. Formally, if you ever have chance to reach the total power of q or greater regardless of jury\'s program choices, you must get q or greater to pass a test." 1700

1056B "Divide Candies" "math,number theory" "Arkady and his friends love playing checkers on an n\xc3\x97n field. The rows and the columns of the field are enumerated from 1 to n.The friends have recently won a championship, so Arkady wants to please them with some candies. Remembering an old parable (but not its moral), Arkady wants to give to his friends one set of candies per each cell of the field: the set of candies for cell (i,j) will have exactly (i2+j2) candies of unique type.There are m friends who deserve the present. How many of these n\xc3\x97n sets of candies can be split equally into m parts without cutting a candy into pieces? Note that each set has to be split independently since the types of candies in different sets are different." 1600

1056A "Determine Line" implementation "Arkady\'s morning seemed to be straight of his nightmare. He overslept through the whole morning and, still half-asleep, got into the tram that arrived the first. Some time after, leaving the tram, he realized that he was not sure about the line number of the tram he was in.During his ride, Arkady woke up several times and each time he saw the tram stopping at some stop. For each stop he knows which lines of tram stop there. Given this information, can you help Arkady determine what are the possible lines of the tram he was in?" 800

1055G "Jellyfish Nightmare" NA "Bob has put on some weight recently. In order to lose weight a bit, Bob has decided to swim regularly in the pool. However, the day before he went to the pool for the first time he had a weird dream. In this dream Bob was swimming along one of the pool\'s lanes, but also there were some jellyfish swimming around him. It\'s worth mentioning that jellyfish have always been one of Bob\'s deepest childhood fears.Let us assume the following physical model for Bob\'s dream.  The pool\'s lane is an area of the plane between lines x=0x=0 and x=wx=w. Bob is not allowed to swim outside of the lane, but he may touch its bounding lines if he wants.  The jellyfish are very small, but in Bob\'s dream they are extremely swift. Each jellyfish has its area of activity around it. Those areas are circles of various radii, with the jellyfish sitting in their centers. The areas of activity of two jellyfish may overlap and one area of activity may even be fully contained within another one.  Bob has a shape of a convex polygon.  Unfortunately, Bob\'s excess weight has made him very clumsy, and as a result he can\'t rotate his body while swimming. So he swims in a parallel translation pattern. However at any given moment of time he can choose any direction of his movement.  Whenever Bob swims into a jellyfish\'s activity area, it will immediately notice him and sting him very painfully. We assume that Bob has swum into the activity area if at some moment of time the intersection of his body with the jellyfish\'s activity area had a positive area (for example, if they only touch, the jellyfish does not notice Bob).  Once a jellyfish stung Bob, it happily swims away and no longer poses any threat to Bob. Bob wants to swim the lane to its end and get stung the least possible number of times. He will start swimming on the line y=\xe2\x88\x92hy=\xe2\x88\x92h, and finish on the line y=hy=h where h=1010h=1010." 3500

1055F "Tree and XOR" strings,trees "You are given a connected undirected graph without cycles (that is, a tree) of n vertices, moreover, there is a non-negative integer written on every edge.Consider all pairs of vertices (v,u) (that is, there are exactly n2 such pairs) and for each pair calculate the bitwise exclusive or (xor) of all integers on edges of the simple path between v and u. If the path consists of one vertex only, then xor of all integers on edges of this path is equal to 0.Suppose we sorted the resulting n2 values in non-decreasing order. You need to find the k-th of them.The definition of xor is as follows.Given two integers x and y, consider their binary representations (possibly with leading zeros): xk\xe2\x80\xa6x2x1x0 and yk\xe2\x80\xa6y2y1y0 (where k is any number so that all bits of x and y can be represented). Here, xi is the i-th bit of the number x and yi is the i-th bit of the number y. Let r=x\xe2\x8a\x95y be the result of the xor operation of x and y. Then r is defined as rk\xe2\x80\xa6r2r1r0 where:ri={1,�if�xi\xe2\x89\xa0yi0,�if�xi=yi" 2900

1055E "Segments on the Line" "binary search,dp" "You are a given a list of integers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an and ss of its segments [lj;rj][lj;rj] (where 1\xe2\x89\xa4lj\xe2\x89\xa4rj\xe2\x89\xa4n1\xe2\x89\xa4lj\xe2\x89\xa4rj\xe2\x89\xa4n).You need to select exactly mm segments in such a way that the kk-th order statistic of the multiset of aiai, where ii is contained in at least one segment, is the smallest possible. If it\'s impossible to select a set of mm segments in such a way that the multiset contains at least kk elements, print -1.The kk-th order statistic of a multiset is the value of the kk-th element after sorting the multiset in non-descending order." 2500

1055D Refactoring greedy,implementation,strings "Alice has written a program and now tries to improve its readability. One of the ways to improve readability is to give sensible names to the variables, so now Alice wants to rename some variables in her program. In her IDE there is a command called ""massive refactoring"", which can replace names of many variable in just one run. To use it, Alice needs to select two strings s and t and after that for each variable the following algorithm is performed: if the variable\'s name contains s as a substring, then the first (and only first) occurrence of s is replaced with t. If the name doesn\'t contain s, then this variable\'s name stays the same.The list of variables is known and for each variable both the initial name and the name Alice wants this variable change to are known. Moreover, for each variable the lengths of the initial name and the target name are equal (otherwise the alignment of the code could become broken). You need to perform renaming of all variables in exactly one run of the massive refactoring command or determine that it is impossible." 2400

1055C "Lucky Days" "math,number theory" "Bob and Alice are often participating in various programming competitions. Like many competitive programmers, Alice and Bob have good and bad days. They noticed, that their lucky and unlucky days are repeating with some period. For example, for Alice days [la;ra][la;ra] are lucky, then there are some unlucky days: [ra+1;la+ta\xe2\x88\x921][ra+1;la+ta\xe2\x88\x921], and then there are lucky days again: [la+ta;ra+ta][la+ta;ra+ta] and so on. In other words, the day is lucky for Alice if it lies in the segment [la+kta;ra+kta][la+kta;ra+kta] for some non-negative integer kk.The Bob\'s lucky day have similar structure, however the parameters of his sequence are different: lblb, rbrb, tbtb. So a day is a lucky for Bob if it lies in a segment [lb+ktb;rb+ktb][lb+ktb;rb+ktb], for some non-negative integer kk.Alice and Bob want to participate in team competitions together and so they want to find out what is the largest possible number of consecutive days, which are lucky for both Alice and Bob." 1900

1055B "Alice and Hairdresser" dsu,implementation "Alice\'s hair is growing by leaps and bounds. Maybe the cause of it is the excess of vitamins, or maybe it is some black magic...To prevent this, Alice decided to go to the hairdresser. She wants for her hair length to be at most l centimeters after haircut, where l is her favorite number. Suppose, that the Alice\'s head is a straight line on which n hairlines grow. Let\'s number them from 1 to n. With one swing of the scissors the hairdresser can shorten all hairlines on any segment to the length l, given that all hairlines on that segment had length strictly greater than l. The hairdresser wants to complete his job as fast as possible, so he will make the least possible number of swings of scissors, since each swing of scissors takes one second.Alice hasn\'t decided yet when she would go to the hairdresser, so she asked you to calculate how much time the haircut would take depending on the time she would go to the hairdresser. In particular, you need to process queries of two types:  0�\xe2\x80\x94 Alice asks how much time the haircut would take if she would go to the hairdresser now.  1 p d�\xe2\x80\x94 p-th hairline grows by d centimeters. Note, that in the request 0 Alice is interested in hypothetical scenario of taking a haircut now, so no hairlines change their length." 1300

1055A Metro graphs "Alice has a birthday today, so she invited home her best friend Bob. Now Bob needs to find a way to commute to the Alice\'s home.In the city in which Alice and Bob live, the first metro line is being built. This metro line contains n stations numbered from 1 to n. Bob lives near the station with number 1, while Alice lives near the station with number s. The metro line has two tracks. Trains on the first track go from the station 1 to the station n and trains on the second track go in reverse direction. Just after the train arrives to the end of its track, it goes to the depot immediately, so it is impossible to travel on it after that.Some stations are not yet open at all and some are only partially open�\xe2\x80\x94 for each station and for each track it is known whether the station is closed for that track or not. If a station is closed for some track, all trains going in this track\'s direction pass the station without stopping on it.When the Bob got the information on opened and closed stations, he found that traveling by metro may be unexpectedly complicated. Help Bob determine whether he can travel to the Alice\'s home by metro or he should search for some other transport." 900

1054H "Epic Convolution" "chinese remainder theorem,fft,math,number theory" "You are given two arrays a0,a1,\xe2\x80\xa6,an\xe2\x88\x921 and b0,b1,\xe2\x80\xa6,bm\xe2\x88\x921, and an integer c.Compute the following sum:n\xe2\x88\x921\xe2\x88\x91i=0m\xe2\x88\x921\xe2\x88\x91j=0aibjci2j3Since it\'s value can be really large, print it modulo 490019." 3500

1054G "New Road Network" "constructive algorithms,greedy,math" "The king of some country N decided to completely rebuild the road network. There are n people living in the country, they are enumerated from 1 to n. It is possible to construct a road between the house of any citizen a to the house of any other citizen b. There should not be more than one road between any pair of citizens. The road network must be connected, i.e. it should be possible to reach every citizen starting from anyone using roads. To save funds, it was decided to build exactly n\xe2\x88\x921 road, so the road network should be a tree.However, it is not that easy as it sounds, that\'s why the king addressed you for help. There are m secret communities in the country, each of them unites a non-empty subset of citizens. The king does not want to conflict with any of the communities, so he wants to build the network such that the houses of members of each society form a connected subtree in network. A set of vertices forms a connected subtree if and only if the graph remains connected when we delete all the other vertices and all edges but ones that connect the vertices from the set.Help the king to determine if it is possible to build the desired road network, and if it is, build it." 3300

1054F "Electric Scheme" "flows,graph matchings" "Pasha is a young technician, nevertheless, he has already got a huge goal: to assemble a PC. The first task he has to become familiar with is to assemble an electric scheme.The scheme Pasha assembled yesterday consists of several wires. Each wire is a segment that connects two points on a plane with integer coordinates within the segment [1,109][1,109].There are wires of two colors in the scheme:   red wires: these wires are horizontal segments, i.e. if such a wire connects two points (x1,y1)(x1,y1) and (x2,y2)(x2,y2), then y1=y2y1=y2;  blue wires: these wires are vertical segments, i.e. if such a wire connects two points (x1,y1)(x1,y1) and (x2,y2)(x2,y2), then x1=x2x1=x2. Note that if a wire connects a point to itself, it may be blue, and it can be red. Also, in Pasha\'s scheme no two wires of the same color intersect, i.e. there are no two wires of same color that have common points.The imperfection of Pasha\'s scheme was that the wires were not isolated, so in the points where two wires of different colors intersect, Pasha saw sparks. Pasha wrote down all the points where he saw sparks and obtained a set of nn distinct points. After that he disassembled the scheme.Next morning Pasha looked at the set of nn points where he had seen sparks and wondered how many wires had he used. Unfortunately, he does not remember that, so he wonders now what is the smallest number of wires he might have used in the scheme. Help him to determine this number and place the wires in such a way that in the resulting scheme the sparks occur in the same places." 2700

1054E "Chips Puzzle" "constructive algorithms,implementation,math" "Egor came up with a new chips puzzle and suggests you to play.The puzzle has the form of a table with n rows and m columns, each cell can contain several black or white chips placed in a row. Thus, the state of the cell can be described by a string consisting of characters \'0\' (a white chip) and \'1\' (a black chip), possibly empty, and the whole puzzle can be described as a table, where each cell is a string of zeros and ones. The task is to get from one state of the puzzle some other state.To do this, you can use the following operation.  select 2 different cells (x1,y1) and (x2,y2): the cells must be in the same row or in the same column of the table, and the string in the cell (x1,y1) must be non-empty;  in one operation you can move the last character of the string at the cell (x1,y1) to the beginning of the string at the cell (x2,y2). Egor came up with two states of the table for you: the initial state and the final one. It is guaranteed that the number of zeros and ones in the tables are the same. Your goal is with several operations get the final state from the initial state. Of course, Egor does not want the number of operations to be very large. Let\'s denote as s the number of characters in each of the tables (which are the same). Then you should use no more than 4\xe2\x8b\x85s operations." 2400

1054D "Changing Array" greedy,implementation "At a break Vanya came to the class and saw an array of n k-bit integers a1,a2,\xe2\x80\xa6,an on the board. An integer x is called a k-bit integer if 0\xe2\x89\xa4x\xe2\x89\xa42k\xe2\x88\x921. Of course, Vanya was not able to resist and started changing the numbers written on the board. To ensure that no one will note anything, Vanya allowed himself to make only one type of changes: choose an index of the array i (1\xe2\x89\xa4i\xe2\x89\xa4n) and replace the number ai with the number \xc2\xafai. We define \xc2\xafx for a k-bit integer x as the k-bit integer such that all its k bits differ from the corresponding bits of x. Vanya does not like the number 0. Therefore, he likes such segments [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar\xe2\x89\xa00, where \xe2\x8a\x95 denotes the bitwise XOR operation. Determine the maximum number of segments he likes Vanya can get applying zero or more operations described above." 1900

1054C "Candies Distribution" "constructive algorithms,implementation" "There are n children numbered from 1 to n in a kindergarten. Kindergarten teacher gave ai (1\xe2\x89\xa4ai\xe2\x89\xa4n) candies to the i-th child. Children were seated in a row in order from 1 to n from left to right and started eating candies. While the i-th child was eating candies, he calculated two numbers li and ri�\xe2\x80\x94 the number of children seating to the left of him that got more candies than he and the number of children seating to the right of him that got more candies than he, respectively.Formally, li is the number of indices j (1\xe2\x89\xa4j<i), such that ai<aj and ri is the number of indices j (i<j\xe2\x89\xa4n), such that ai<aj.Each child told to the kindergarten teacher the numbers li and ri that he calculated. Unfortunately, she forgot how many candies she has given to each child. So, she asks you for help: given the arrays l and r determine whether she could have given the candies to the children such that all children correctly calculated their values li and ri, or some of them have definitely made a mistake. If it was possible, find any way how she could have done it." 1500

1054B "Appending Mex" implementation "Initially Ildar has an empty array. He performs n steps. On each step he takes a subset of integers already added to the array and appends the mex of this subset to the array. The mex of an multiset of integers is the smallest non-negative integer not presented in the multiset. For example, the mex of the multiset [0,2,3] is 1, while the mex of the multiset [1,2,1] is 0.More formally, on the step m, when Ildar already has an array a1,a2,\xe2\x80\xa6,am\xe2\x88\x921, he chooses some subset of indices 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik<m (possibly, empty), where 0\xe2\x89\xa4k<m, and appends the mex(ai1,ai2,\xe2\x80\xa6aik) to the end of the array.After performing all the steps Ildar thinks that he might have made a mistake somewhere. He asks you to determine for a given array a1,a2,\xe2\x80\xa6,an the minimum step t such that he has definitely made a mistake on at least one of the steps 1,2,\xe2\x80\xa6,t, or determine that he could have obtained this array without mistakes." 1000

1054A "Elevator or Stairs?" implementation "Masha lives in a multi-storey building, where floors are numbered with positive integers. Two floors are called adjacent if their numbers differ by one. Masha decided to visit Egor. Masha lives on the floor x, Egor on the floor y (not on the same floor with Masha).The house has a staircase and an elevator. If Masha uses the stairs, it takes t1 seconds for her to walk between adjacent floors (in each direction). The elevator passes between adjacent floors (in each way) in t2 seconds. The elevator moves with doors closed. The elevator spends t3 seconds to open or close the doors. We can assume that time is not spent on any action except moving between adjacent floors and waiting for the doors to open or close. If Masha uses the elevator, it immediately goes directly to the desired floor.Coming out of the apartment on her floor, Masha noticed that the elevator is now on the floor z and has closed doors. Now she has to choose whether to use the stairs or use the elevator. If the time that Masha needs to get to the Egor\'s floor by the stairs is strictly less than the time it will take her using the elevator, then she will use the stairs, otherwise she will choose the elevator.Help Mary to understand whether to use the elevator or the stairs." 800

1053E "Euler tour" "constructive algorithms,trees" "Euler is a little, cute squirrel. When the autumn comes, he collects some reserves for winter. The interesting fact is that Euler likes to collect acorns in a specific way. A tree can be described as n acorns connected by n\xe2\x88\x921 branches, such that there is exactly one way between each pair of acorns. Let\'s enumerate the acorns from 1 to n.The squirrel chooses one acorn (not necessary with number 1) as a start, and visits them in a way called ""Euler tour"" (see notes), collecting each acorn when he visits it for the last time.Today morning Kate was observing Euler. She took a sheet of paper and wrote down consecutive indices of acorns on his path. Unfortunately, during her way to home it started raining and some of numbers became illegible. Now the girl is very sad, because she has to present the observations to her teacher.""Maybe if I guess the lacking numbers, I\'ll be able to do it!"" she thought. Help her and restore any valid Euler tour of some tree or tell that she must have made a mistake." 3500

1051G Distinctification "data structures,dsu,greedy" "Suppose you are given a sequence S of k pairs of integers (a1,b1),(a2,b2),\xe2\x80\xa6,(ak,bk).You can perform the following operations on it:  Choose some position i and increase ai by 1. That can be performed only if there exists at least one such position j that i\xe2\x89\xa0j and ai=aj. The cost of this operation is bi;  Choose some position i and decrease ai by 1. That can be performed only if there exists at least one such position j that ai=aj+1. The cost of this operation is \xe2\x88\x92bi. Each operation can be performed arbitrary number of times (possibly zero).Let f(S) be minimum possible x such that there exists a sequence of operations with total cost x, after which all ai from S are pairwise distinct. Now for the task itself ...You are given a sequence P consisting of n pairs of integers (a1,b1),(a2,b2),\xe2\x80\xa6,(an,bn). All bi are pairwise distinct. Let Pi be the sequence consisting of the first i pairs of P. Your task is to calculate the values of f(P1),f(P2),\xe2\x80\xa6,f(Pn)." 2900

1051F "The Shortest Statement" "graphs,shortest paths,trees" "You are given a weighed undirected connected graph, consisting of n vertices and m edges.You should answer q queries, the i-th query is to find the shortest distance between vertices ui and vi." 2400

1051E "Vasya and Big Integers" "binary search,data structures,dp,hashing,strings" "Vasya owns three big integers \xe2\x80\x94 a,l,r. Let\'s define a partition of x such a sequence of strings s1,s2,\xe2\x80\xa6,sk that s1+s2+\xe2\x8b\xaf+sk=x, where + is a concatanation of strings. si is the i-th element of the partition. For example, number 12345 has the following partitions: [""1"", ""2"", ""3"", ""4"", ""5""], [""123"", ""4"", ""5""], [""1"", ""2345""], [""12345""] and lots of others.Let\'s call some partition of a beautiful if each of its elements contains no leading zeros.Vasya want to know the number of beautiful partitions of number a, which has each of si satisfy the condition l\xe2\x89\xa4si\xe2\x89\xa4r. Note that the comparison is the integer comparison, not the string one.Help Vasya to count the amount of partitions of number a such that they match all the given requirements. The result can be rather big, so print it modulo 998244353." 2600

1051D Bicolorings bitmasks,dp "You are given a grid, consisting of 2 rows and n columns. Each cell of this grid should be colored either black or white.Two cells are considered neighbours if they have a common border and share the same color. Two cells A and B belong to the same component if they are neighbours, or if there is a neighbour of A that belongs to the same component with B.Let\'s call some bicoloring beautiful if it has exactly k components.Count the number of beautiful bicolorings. The number can be big enough, so print the answer modulo 998244353." 1700

1051C "Vasya and Multisets" "brute force,dp,greedy,implementation,math" "Vasya has a multiset s consisting of n integer numbers. Vasya calls some number x nice if it appears in the multiset exactly once. For example, multiset {1,1,2,3,3,3,4} contains nice numbers 2 and 4.Vasya wants to split multiset s into two multisets a and b (one of which may be empty) in such a way that the quantity of nice numbers in multiset a would be the same as the quantity of nice numbers in multiset b (the quantity of numbers to appear exactly once in multiset a and the quantity of numbers to appear exactly once in multiset b)." 1500

1051B "Relatively Prime Pairs" "greedy,math,number theory" "You are given a set of all integers from l to r inclusive, l<r, (r\xe2\x88\x92l+1)\xe2\x89\xa43\xe2\x8b\x85105 and (r\xe2\x88\x92l) is always odd.You want to split these numbers into exactly r\xe2\x88\x92l+12 pairs in such a way that for each pair (i,j) the greatest common divisor of i and j is equal to 1. Each number should appear in exactly one of the pairs.Print the resulting pairs or output that no solution exists. If there are multiple solutions, print any of them." 1000

1051A "Vasya And Password" greedy,implementation,strings "Vasya came up with a password to register for EatForces \xe2\x80\x94 a string s. The password in EatForces should be a string, consisting of lowercase and uppercase Latin letters and digits.But since EatForces takes care of the security of its users, user passwords must contain at least one digit, at least one uppercase Latin letter and at least one lowercase Latin letter. For example, the passwords ""abaCABA12"", ""Z7q"" and ""3R24m"" are valid, and the passwords ""qwerty"", ""qwerty12345"" and ""Password"" are not. A substring of string s is a string x=slsl+1\xe2\x80\xa6sl+len\xe2\x88\x921(1\xe2\x89\xa4l\xe2\x89\xa4|s|,0\xe2\x89\xa4len\xe2\x89\xa4|s|\xe2\x88\x92l+1). len is the length of the substring. Note that the empty string is also considered a substring of s, it has the length 0.Vasya\'s password, however, may come too weak for the security settings of EatForces. He likes his password, so he wants to replace some its substring with another string of the same length in order to satisfy the above conditions. This operation should be performed exactly once, and the chosen string should have the minimal possible length.Note that the length of s should not change after the replacement of the substring, and the string itself should contain only lowercase and uppercase Latin letters and digits." 1200

1047B "Cover Points" geometry,math "There are n points on the plane, (x1,y1),(x2,y2),\xe2\x80\xa6,(xn,yn).You need to place an isosceles triangle with two sides on the coordinate axis to cover all points (a point is covered if it lies inside the triangle or on the side of the triangle). Calculate the minimum length of the shorter side of the triangle." 900

1047A "Little C Loves 3 I" math "Little C loves number \xc2\xab3\xc2\xbb very much. He loves all things about it.Now he has a positive integer n. He wants to split n into 3 positive integers a,b,c, such that a+b+c=n and none of the 3 integers is a multiple of 3. Help him to find a solution." 800

1046I "Say Hello" geometry "Two friends are travelling through Bubble galaxy. They say ""Hello!"" via signals to each other if their distance is smaller or equal than d1d1 and   it\'s the first time they speak to each other or   at some point in time after their last talk their distance was greater than d2d2. We need to calculate how many times friends said ""Hello!"" to each other. For NN moments, you\'ll have an array of points for each friend representing their positions at that moment. A person can stay in the same position between two moments in time, but if a person made a move we assume this movement as movement with constant speed in constant direction." 2300

1046F "Splitting money" implementation "After finding and moving to the new planet that supports human life, discussions started on which currency should be used. After long negotiations, Bitcoin was ultimately chosen as the universal currency.These were the great news for Alice, whose grandfather got into Bitcoin mining in 2013, and accumulated a lot of them throughout the years. Unfortunately, when paying something in bitcoin everyone can see how many bitcoins you have in your public address wallet. This worried Alice, so she decided to split her bitcoins among multiple different addresses, so that every address has at most x satoshi (1 bitcoin = 108 satoshi). She can create new public address wallets for free and is willing to pay f fee in satoshi per transaction to ensure acceptable speed of transfer. The fee is deducted from the address the transaction was sent from. Tell Alice how much total fee in satoshi she will need to pay to achieve her goal." 1400

1046C "Space Formula" greedy "Formula 1 officials decided to introduce new competition. Cars are replaced by space ships and number of points awarded can differ per race.Given the current ranking in the competition and points distribution for the next race, your task is to calculate the best possible ranking for a given astronaut after the next race. It\'s guaranteed that given astronaut will have unique number of points before the race." 1400

1045J "Moonwalk challenge" "data structures,strings,trees" "Since astronauts from BubbleCup XI mission finished their mission on the Moon and are big fans of famous singer, they decided to spend some fun time before returning to the Earth and hence created a so called ""Moonwalk challenge"" game.Teams of astronauts are given the map of craters on the Moon and direct bidirectional paths from some craters to others that are safe for ""Moonwalking"". Each of those direct paths is colored in one color and there is unique path between each two craters. Goal of the game is to find two craters such that given array of colors appears most times as continuous subarray on the path between those two craters (overlapping appearances should be counted).To help your favorite team win, you should make a program that, given the map, answers the queries of the following type: For two craters and array of colors answer how many times given array appears as continuous subarray on the path from the first crater to the second.Colors are represented as lowercase English alphabet letters." 2600

1045I "Palindrome Pairs" hashing,strings "After learning a lot about space exploration, a little girl named Ana wants to change the subject.Ana is a girl who loves palindromes (string that can be read the same backwards as forward). She has learned how to check for a given string whether it\'s a palindrome or not, but soon she grew tired of this problem, so she came up with a more interesting one and she needs your help to solve it:You are given an array of strings which consist of only small letters of the alphabet. Your task is to find how many palindrome pairs are there in the array. A palindrome pair is a pair of strings such that the following condition holds: at least one permutation of the concatenation of the two strings is a palindrome. In other words, if you have two strings, let\'s say ""aab"" and ""abcac"", and you concatenate them into ""aababcac"", we have to check if there exists a permutation of this new string such that it is a palindrome (in this case there exists the permutation ""aabccbaa""). Two pairs are considered different if the strings are located on different indices. The pair of strings with indices (i,j) is considered the same as the pair (j,i)." 1600

1045H Self-exploration math "Being bored of exploring the Moon over and over again Wall-B decided to explore something he is made of \xe2\x80\x94 binary numbers. He took a binary number and decided to count how many times different substrings of length two appeared. He stored those values in c00, c01, c10 and c11, representing how many times substrings 00, 01, 10 and 11 appear in the number respectively. For example: 10111100\xe2\x86\x92c00=1,�c01=1,�c10=2,�c11=3 10000\xe2\x86\x92c00=3,�c01=0,�c10=1,�c11=0 10101001\xe2\x86\x92c00=1,�c01=3,�c10=3,�c11=0 1\xe2\x86\x92c00=0,�c01=0,�c10=0,�c11=0Wall-B noticed that there can be multiple binary numbers satisfying the same c00, c01, c10 and c11 constraints. Because of that he wanted to count how many binary numbers satisfy the constraints cxy given the interval [A,B]. Unfortunately, his processing power wasn\'t strong enough to handle large intervals he was curious about. Can you help him? Since this number can be large print it modulo 109+7." 2400

1045G "AI robots" "data structures" "In the last mission, MDCS has successfully shipped N AI robots to Mars. Before they start exploring, system initialization is required so they are arranged in a line. Every robot can be described with three numbers: position (xi), radius of sight (ri) and IQ (qi).Since they are intelligent robots, some of them will talk if they see each other. Radius of sight is inclusive, so robot can see other all robots in range [xi\xe2\x88\x92ri,xi+ri]. But they don\'t walk to talk with anybody, but only with robots who have similar IQ. By similar IQ we mean that their absolute difference isn\'t more than K.  Help us and calculate how many pairs of robots are going to talk with each other, so we can timely update their software and avoid any potential quarrel." 2200

1045F "Shady Lady" geometry,math "Ani and Borna are playing a short game on a two-variable polynomial. It\'s a special kind of a polynomial: the monomials are fixed, but all of its coefficients are fill-in-the-blanks dashes, e.g. _xy+_x4y7+_x8y3+\xe2\x80\xa6Borna will fill in the blanks with positive integers. He wants the polynomial to be bounded from below, i.e. his goal is to make sure there exists a real number M such that the value of the polynomial at any point is greater than M.  Ani is mischievous, and wants the polynomial to be unbounded. Along with stealing Borna\'s heart, she can also steal parts of polynomials. Ani is only a petty kind of thief, though: she can only steal at most one monomial from the polynomial before Borna fills in the blanks. If Ani and Borna play their only moves optimally, who wins?" 3400

1045E "Ancient civilizations" "constructive algorithms,geometry" "On the surface of a newly discovered planet, which we model by a plane, explorers found remains of two different civilizations in various locations. They would like to learn more about those civilizations and to explore the area they need to build roads between some of locations. But as always, there are some restrictions:   Every two locations of the same civilization are connected by a unique path of roads  No two locations from different civilizations may have road between them (explorers don\'t want to accidentally mix civilizations they are currently exploring)  Roads must be straight line segments  Since intersections are expensive to build, they don\'t want any two roads to intersect (that is, only common point for any two roads may be at some of locations) Obviously all locations are different points in the plane, but explorers found out one more interesting information that may help you \xe2\x80\x93 no three locations lie on the same line!Help explorers and find a solution for their problem, or report it is impossible." 3200

1045D "Interstellar battle" math,probabilities,trees "In the intergalactic empire Bubbledom there are N planets, of which some pairs are directly connected by two-way wormholes. There are N\xe2\x88\x921 wormholes. The wormholes are of extreme religious importance in Bubbledom, a set of planets in Bubbledom consider themselves one intergalactic kingdom if and only if any two planets in the set can reach each other by traversing the wormholes. You are given that Bubbledom is one kingdom. In other words, the network of planets and wormholes is a tree.However, Bubbledom is facing a powerful enemy also possessing teleportation technology. The enemy attacks every night, and the government of Bubbledom retakes all the planets during the day. In a single attack, the enemy attacks every planet of Bubbledom at once, but some planets are more resilient than others. Planets are number 0,1,\xe2\x80\xa6,N\xe2\x88\x921 and the planet i will fall with probability pi. Before every night (including the very first one), the government reinforces or weakens the defenses of a single planet.The government of Bubbledom is interested in the following question: what is the expected number of intergalactic kingdoms Bubbledom will be split into, after a single enemy attack (before they get a chance to rebuild)? In other words, you need to print the expected number of connected components after every attack." 2200

1045C "Hyperspace Highways" "dfs and similar,graphs,trees" "In an unspecified solar system, there are NN planets. A space government company has recently hired space contractors to build MM bidirectional Hyperspace\xe2\x84\xa2 highways, each connecting two different planets. The primary objective, which was to make sure that every planet can be reached from any other planet taking only Hyperspace\xe2\x84\xa2 highways, has been completely fulfilled. Unfortunately, lots of space contractors had friends and cousins in the Space Board of Directors of the company, so the company decided to do much more than just connecting all planets. In order to make spending enormous amounts of space money for Hyperspace\xe2\x84\xa2 highways look neccessary, they decided to enforce a strict rule on the Hyperspace\xe2\x84\xa2 highway network: whenever there is a way to travel through some planets and return to the starting point without travelling through any planet twice, every pair of planets on the itinerary should be directly connected by a Hyperspace\xe2\x84\xa2 highway. In other words, the set of planets in every simple cycle induces a complete subgraph.You are designing a Hyperspace\xe2\x84\xa2 navigational app, and the key technical problem you are facing is finding the minimal number of Hyperspace\xe2\x84\xa2 highways one needs to use to travel from planet AA to planet BB. As this problem is too easy for Bubble Cup, here is a harder task: your program needs to do it for QQ pairs of planets." 2300

1045B "Space Isaac" "hashing,number theory" "Everybody seems to think that the Martians are green, but it turns out they are metallic pink and fat. Ajs has two bags of distinct nonnegative integers. The bags are disjoint, and the union of the sets of numbers in the bags is {0,1,\xe2\x80\xa6,M\xe2\x88\x921}, for some positive integer M. Ajs draws a number from the first bag and a number from the second bag, and then sums them modulo M.What are the residues modulo M that Ajs cannot obtain with this action?" 2400

1045A "Last chance" "data structures,flows,graph matchings,graphs,trees" "It is the year 2969. 1000 years have passed from the moon landing. Meanwhile, the humanity colonized the Hyperspace\xe2\x84\xa2 and lived in harmony.Until we realized that we were not alone.Not too far away from the Earth, the massive fleet of aliens\' spaceships is preparing to attack the Earth. For the first time in a while, the humanity is in real danger. Crisis and panic are everywhere. The scientists from all around the solar system have met and discussed the possible solutions. However, no progress has been made.The Earth\'s last hope is YOU!Fortunately, the Earth is equipped with very powerful defense systems made by MDCS. There are N aliens\' spaceships which form the line. The defense system consists of three types of weapons:   SQL rockets \xe2\x80\x93 every SQL rocket can destroy at most one spaceship in the given set. Cognition beams \xe2\x80\x93 every Cognition beam has an interval [l,r] and can destroy at most one spaceship in that interval. OMG bazooka \xe2\x80\x93 every OMG bazooka has three possible targets, however, each bazooka can destroy either zero or exactly two spaceships. In addition, due to the smart targeting system, the sets of the three possible targets of any two different OMG bazookas are disjoint (that means that every ship is targeted with at most one OMG bazooka). Your task is to make a plan of the attack which will destroy the largest possible number of spaceships. Every destroyed spaceship should be destroyed with exactly one weapon." 2500

1044F DFS "data structures" "Let T be a tree on n vertices. Consider a graph G0, initially equal to T. You are given a sequence of q updates, where the i-th update is given as a pair of two distinct integers ui and vi. For every i from 1 to q, we define the graph Gi as follows:   If Gi\xe2\x88\x921 contains an edge {ui,vi}, then remove this edge to form Gi.  Otherwise, add this edge to Gi\xe2\x88\x921 to form Gi.  Formally, Gi:=Gi\xe2\x88\x921\xe2\x96\xb3{{ui,vi}} where \xe2\x96\xb3 denotes the set symmetric difference. Furthermore, it is guaranteed that T is always a subgraph of Gi. In other words, an update never removes an edge of T.Consider a connected graph H and run a depth-first search on it. One can see that the tree edges (i.e. the edges leading to a not yet visited vertex at the time of traversal) form a spanning tree of the graph H. This spanning tree is not generally fixed for a particular graph�\xe2\x80\x94 it depends on the starting vertex, and on the order in which the neighbors of each vertex are traversed. We call vertex w good if one can order the neighbors of each vertex in such a way that the depth-first search started from w produces T as the spanning tree. For every i from 1 to q, find and report the number of good vertices." 2700

1044E "Grid Sort" implementation "You are given an n\xc3\x97mn\xc3\x97m grid. Each grid cell is filled with a unique integer from 11 to nmnm so that each integer appears exactly once.In one operation, you can choose an arbitrary cycle of the grid and move all integers along that cycle one space over. Here, a cycle is any sequence that satisfies the following conditions:  There are at least four squares.  Each square appears at most once.  Every pair of adjacent squares, and also the first and last squares, share an edge. For example, if we had the following grid:  We can choose an arbitrary cycle like this one:  To get the following grid:  In this particular case, the chosen cycle can be represented as the sequence [1,2,3,6,5,8,7,4][1,2,3,6,5,8,7,4], the numbers are in the direction that we want to rotate them in.Find any sequence of operations to sort the grid so that the array created by concatenating the rows from the highest to the lowest is sorted (look at the first picture above).Note you do not need to minimize number of operations or sum of cycle lengths. The only constraint is that the sum of all cycles lengths must not be greater than 105105. We can show that an answer always exists under the given constraints. Output any valid sequence of moves that will sort the grid." 3100

1044D "Deduction Queries" "data structures,dsu" "There is an array a of 230 integers, indexed from 0 to 230\xe2\x88\x921. Initially, you know that 0\xe2\x89\xa4ai<230 (0\xe2\x89\xa4i<230), but you do not know any of the values. Your task is to process queries of two types: 1 l r x: You are informed that the bitwise xor of the subarray [l,r] (ends inclusive) is equal to x. That is, al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar\xe2\x88\x921\xe2\x8a\x95ar=x, where \xe2\x8a\x95 is the bitwise xor operator. In some cases, the received update contradicts past updates. In this case, you should ignore the contradicting update (the current update). 2 l r: You are asked to output the bitwise xor of the subarray [l,r] (ends inclusive). If it is still impossible to know this value, considering all past updates, then output \xe2\x88\x921.Note that the queries are encoded. That is, you need to write an online solution." 2400

1044C "Optimal Polygon Perimeter" dp,geometry "You are given nn points on the plane. The polygon formed from all the nn points is strictly convex, that is, the polygon is convex, and there are no three collinear points (i.e. lying in the same straight line). The points are numbered from 11 to nn, in clockwise order.We define the distance between two points p1=(x1,y1)p1=(x1,y1) and p2=(x2,y2)p2=(x2,y2) as their Manhattan distance: d(p1,p2)=|x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|.d(p1,p2)=|x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|.Furthermore, we define the perimeter of a polygon, as the sum of Manhattan distances between all adjacent pairs of points on it; if the points on the polygon are ordered as p1,p2,\xe2\x80\xa6,pkp1,p2,\xe2\x80\xa6,pk (k\xe2\x89\xa53)(k\xe2\x89\xa53), then the perimeter of the polygon is d(p1,p2)+d(p2,p3)+\xe2\x80\xa6+d(pk,p1)d(p1,p2)+d(p2,p3)+\xe2\x80\xa6+d(pk,p1).For some parameter kk, let\'s consider all the polygons that can be formed from the given set of points, having any kk vertices, such that the polygon is not self-intersecting. For each such polygon, let\'s consider its perimeter. Over all such perimeters, we define f(k)f(k) to be the maximal perimeter.Please note, when checking whether a polygon is self-intersecting, that the edges of a polygon are still drawn as straight lines. For instance, in the following pictures:  In the middle polygon, the order of points (p1,p3,p2,p4p1,p3,p2,p4) is not valid, since it is a self-intersecting polygon. The right polygon (whose edges resemble the Manhattan distance) has the same order and is not self-intersecting, but we consider edges as straight lines. The correct way to draw this polygon is (p1,p2,p3,p4p1,p2,p3,p4), which is the left polygon.Your task is to compute f(3),f(4),\xe2\x80\xa6,f(n)f(3),f(4),\xe2\x80\xa6,f(n). In other words, find the maximum possible perimeter for each possible number of points (i.e. 33 to nn)." 2100

1044B "Intersecting Subtrees" "dfs and similar,interactive,trees" "You are playing a strange game with Li Chen. You have a tree with nn nodes drawn on a piece of paper. All nodes are unlabeled and distinguishable. Each of you independently labeled the vertices from 11 to nn. Neither of you know the other\'s labelling of the tree.You and Li Chen each chose a subtree (i.e., a connected subgraph) in that tree. Your subtree consists of the vertices labeled x1,x2,\xe2\x80\xa6,xk1x1,x2,\xe2\x80\xa6,xk1 in your labeling, Li Chen\'s subtree consists of the vertices labeled y1,y2,\xe2\x80\xa6,yk2y1,y2,\xe2\x80\xa6,yk2 in his labeling. The values of x1,x2,\xe2\x80\xa6,xk1x1,x2,\xe2\x80\xa6,xk1 and y1,y2,\xe2\x80\xa6,yk2y1,y2,\xe2\x80\xa6,yk2 are known to both of you.   The picture shows two labelings of a possible tree: yours on the left and Li Chen\'s on the right. The selected trees are highlighted. There are two common nodes. You want to determine whether your subtrees have at least one common vertex. Luckily, your friend Andrew knows both labelings of the tree. You can ask Andrew at most 55 questions, each of which is in one of the following two forms:   A x: Andrew will look at vertex xx in your labeling and tell you the number of this vertex in Li Chen\'s labeling.  B y: Andrew will look at vertex yy in Li Chen\'s labeling and tell you the number of this vertex in your labeling. Determine whether the two subtrees have at least one common vertex after asking some questions. If there is at least one common vertex, determine one of your labels for any of the common vertices." 1900

1044A "The Tower is Going Home" "binary search,two pointers" "On a chessboard with a width of 109109 and a height of 109109, the rows are numbered from bottom to top from 11 to 109109, and the columns are numbered from left to right from 11 to 109109. Therefore, for each cell of the chessboard you can assign the coordinates (x,y)(x,y), where xx is the column number and yy is the row number.Every day there are fights between black and white pieces on this board. Today, the black ones won, but at what price? Only the rook survived, and it was driven into the lower left corner�\xe2\x80\x94 a cell with coordinates (1,1)(1,1). But it is still happy, because the victory has been won and it\'s time to celebrate it! In order to do this, the rook needs to go home, namely�\xe2\x80\x94 on the upper side of the field (that is, in any cell that is in the row with number 109109).Everything would have been fine, but the treacherous white figures put spells on some places of the field before the end of the game. There are two types of spells:   Vertical. Each of these is defined by one number xx. Such spells create an infinite blocking line between the columns xx and x+1x+1.  Horizontal. Each of these is defined by three numbers x1x1, x2x2, yy. Such spells create a blocking segment that passes through the top side of the cells, which are in the row yy and in columns from x1x1 to x2x2 inclusive. The peculiarity of these spells is that it is impossible for a certain pair of such spells to have a common point. Note that horizontal spells can have common points with vertical spells.    An example of a chessboard. Let\'s recall that the rook is a chess piece that in one move can move to any point that is in the same row or column with its initial position. In our task, the rook can move from the cell (r0,c0)(r0,c0) into the cell (r1,c1)(r1,c1) only under the condition that r1=r0r1=r0 or c1=c0c1=c0 and there is no blocking lines or blocking segments between these cells (For better understanding, look at the samples).Fortunately, the rook can remove spells, but for this it has to put tremendous efforts, therefore, it wants to remove the minimum possible number of spells in such way, that after this it can return home. Find this number!" 1700

1043G "Speckled Band" "data structures,divide and conquer,hashing,string suffix structures,strings" "Ildar took a band (a thin strip of cloth) and colored it. Formally, the band has n cells, each of them is colored into one of 26 colors, so we can denote each color with one of the lowercase letters of English alphabet. Ildar decided to take some segment of the band [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) he likes and cut it from the band. So he will create a new band that can be represented as a string t=slsl+1\xe2\x80\xa6sr.After that Ildar will play the following game: he cuts the band t into some new bands and counts the number of different bands among them. Formally, Ildar chooses 1\xe2\x89\xa4k\xe2\x89\xa4|t| indexes 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik=|t| and cuts t to k bands-strings t1t2\xe2\x80\xa6ti1,ti1+1\xe2\x80\xa6ti2,\xe2\x80\xa6,tik\xe2\x88\x921+1\xe2\x80\xa6tik and counts the number of different bands among them. He wants to know the minimal possible number of different bands he can get under the constraint that at least one band repeats at least two times. The result of the game is this number. If it is impossible to cut t in such a way, the result of the game is -1.Unfortunately Ildar hasn\'t yet decided which segment he likes, but he has q segments-candidates [l1,r1], [l2,r2], ..., [lq,rq]. Your task is to calculate the result of the game for each of them." 3500

1043F "Make It One" "bitmasks,combinatorics,dp,math,number theory,shortest paths" "Janusz is a businessman. He owns a company ""Januszex"", which produces games for teenagers. Last hit of Januszex was a cool one-person game ""Make it one"". The player is given a sequence of n integers ai.It is allowed to select any subset of them, and the score is equal to the greatest common divisor of selected elements. The goal is to take as little elements as it is possible, getting the score 1. Now Janusz wonders, for given sequence, how much elements should the player choose?" 2500

1043E "Train Hard, Win Easy" "constructive algorithms,greedy,math,sortings" "Zibi is a competitive programming coach. There are n competitors who want to be prepared well. The training contests are quite unusual�\xe2\x80\x93 there are two people in a team, two problems, and each competitor will code exactly one of them. Of course, people in one team will code different problems.Rules of scoring also aren\'t typical. The first problem is always an implementation problem: you have to implement some well-known algorithm very fast and the time of your typing is rated. The second one is an awful geometry task and you just have to get it accepted in reasonable time. Here the length and difficulty of your code are important. After that, Zibi will give some penalty points (possibly negative) for each solution and the final score of the team is the sum of them (the less the score is, the better).We know that the i-th competitor will always have score xi when he codes the first task and yi when he codes the second task. We can assume, that all competitors know each other\'s skills and during the contest distribute the problems in the way that minimizes their final score. Remember that each person codes exactly one problem in a contest.Zibi wants all competitors to write a contest with each other. However, there are m pairs of people who really don\'t like to cooperate and they definitely won\'t write a contest together. Still, the coach is going to conduct trainings for all possible pairs of people, such that the people in pair don\'t hate each other. The coach is interested for each participant, what will be his or her sum of scores of all teams he trained in?" 1900

1043D "Mysterious Crime" "brute force,combinatorics,math,meet-in-the-middle,two pointers" "Acingel is a small town. There was only one doctor here�\xe2\x80\x94 Miss Ada. She was very friendly and nobody has ever said something bad about her, so who could\'ve expected that Ada will be found dead in her house? Mr Gawry, world-famous detective, is appointed to find the criminal. He asked m neighbours of Ada about clients who have visited her in that unlucky day. Let\'s number the clients from 1 to n. Each neighbour\'s testimony is a permutation of these numbers, which describes the order in which clients have been seen by the asked neighbour.However, some facts are very suspicious�\xe2\x80\x93 how it is that, according to some of given permutations, some client has been seen in the morning, while in others he has been seen in the evening? ""In the morning some of neighbours must have been sleeping!""�\xe2\x80\x94 thinks Gawry�\xe2\x80\x94 ""and in the evening there\'s been too dark to see somebody\'s face..."". Now he wants to delete some prefix and some suffix (both prefix and suffix can be empty) in each permutation, so that they\'ll be non-empty and equal to each other after that�\xe2\x80\x94 some of the potential criminals may disappear, but the testimony won\'t stand in contradiction to each other.In how many ways he can do it? Two ways are called different if the remaining common part is different." 1700

1043C "Smallest Word" "constructive algorithms,greedy,implementation" "IA has so many colorful magnets on her fridge! Exactly one letter is written on each magnet, \'a\' or \'b\'. She loves to play with them, placing all magnets in a row. However, the girl is quickly bored and usually thinks how to make her entertainment more interesting.Today, when IA looked at the fridge, she noticed that the word formed by magnets is really messy. ""It would look much better when I\'ll swap some of them!""�\xe2\x80\x94 thought the girl�\xe2\x80\x94 ""but how to do it?"". After a while, she got an idea. IA will look at all prefixes with lengths from 1 to the length of the word and for each prefix she will either reverse this prefix or leave it as it is. She will consider the prefixes in the fixed order: from the shortest to the largest. She wants to get the lexicographically smallest possible word after she considers all prefixes. Can you help her, telling which prefixes should be chosen for reversing?A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 1500

1043B "Lost Array" implementation "Bajtek, known for his unusual gifts, recently got an integer array x0,x1,\xe2\x80\xa6,xk\xe2\x88\x921.Unfortunately, after a huge array-party with his extraordinary friends, he realized that he\'d lost it. After hours spent on searching for a new toy, Bajtek found on the arrays producer\'s website another array a of length n+1. As a formal description of a says, a0=0 and for all other i�(1\xe2\x89\xa4i\xe2\x89\xa4n) ai=x(i\xe2\x88\x921)modk+ai\xe2\x88\x921, where pmodq denotes the remainder of division p by q.For example, if the x=[1,2,3] and n=5, then:  a0=0,  a1=x0mod3+a0=x0+0=1,  a2=x1mod3+a1=x1+1=3,  a3=x2mod3+a2=x2+3=6,  a4=x3mod3+a3=x0+6=7,  a5=x4mod3+a4=x1+7=9. So, if the x=[1,2,3] and n=5, then a=[0,1,3,6,7,9].Now the boy hopes that he will be able to restore x from a! Knowing that 1\xe2\x89\xa4k\xe2\x89\xa4n, help him and find all possible values of k�\xe2\x80\x94 possible lengths of the lost array." 1200

1043A Elections implementation,math "Awruk is taking part in elections in his school. It is the final round. He has only one opponent�\xe2\x80\x94 Elodreip. The are n students in the school. Each student has exactly k votes and is obligated to use all of them. So Awruk knows that if a person gives ai votes for Elodreip, than he will get exactly k\xe2\x88\x92ai votes from this person. Of course 0\xe2\x89\xa4k\xe2\x88\x92ai holds.Awruk knows that if he loses his life is over. He has been speaking a lot with his friends and now he knows a1,a2,\xe2\x80\xa6,an \xe2\x80\x94 how many votes for Elodreip each student wants to give. Now he wants to change the number k to win the elections. Of course he knows that bigger k means bigger chance that somebody may notice that he has changed something and then he will be disqualified.So, Awruk knows a1,a2,\xe2\x80\xa6,an \xe2\x80\x94 how many votes each student will give to his opponent. Help him select the smallest winning number k. In order to win, Awruk needs to get strictly more votes than Elodreip." 800

1042F "Leaf Sets" "data structures,dfs and similar,dsu,graphs,greedy,sortings,trees" "You are given an undirected tree, consisting of nn vertices.The vertex is called a leaf if it has exactly one vertex adjacent to it.The distance between some pair of vertices is the number of edges in the shortest path between them.Let\'s call some set of leaves beautiful if the maximum distance between any pair of leaves in it is less or equal to kk.You want to split all leaves into non-intersecting beautiful sets. What is the minimal number of sets in such a split?" 2400

1042E "Vasya and Magic Matrix" dp,math,probabilities "Vasya has got a magic matrix a of size n\xc3\x97m. The rows of the matrix are numbered from 1 to n from top to bottom, the columns are numbered from 1 to m from left to right. Let aij be the element in the intersection of the i-th row and the j-th column.Vasya has also got a chip. Initially, the chip is in the intersection of the r-th row and the c-th column (that is, in the element arc). Vasya performs the following process as long as possible: among all elements of the matrix having their value less than the value of the element with the chip in it, Vasya randomly and equiprobably chooses one element and moves his chip to this element.After moving the chip, he adds to his score the square of the Euclidean distance between these elements (that is, between the element in which the chip is now and the element the chip was moved from). The process ends when there are no elements having their values less than the value of the element with the chip in it.Euclidean distance between matrix elements with coordinates (i1,j1) and (i2,j2) is equal to \xe2\x88\x9a(i1\xe2\x88\x92i2)2+(j1\xe2\x88\x92j2)2.Calculate the expected value of the Vasya\'s final score.It can be shown that the answer can be represented as PQ, where P and Q are coprime integer numbers, and Q\xe2\x89\xa20�(mod�998244353). Print the value P\xe2\x8b\x85Q\xe2\x88\x921 modulo 998244353." 2300

1042D "Petya and Array" "data structures,divide and conquer,two pointers" "Petya has an array a consisting of n integers. He has learned partial sums recently, and now he can calculate the sum of elements on any segment of the array really fast. The segment is a non-empty sequence of elements standing one next to another in the array.Now he wonders what is the number of segments in his array with the sum less than t. Help Petya to calculate this number.More formally, you are required to calculate the number of pairs l,r (l\xe2\x89\xa4r) such that al+al+1+\xe2\x8b\xaf+ar\xe2\x88\x921+ar<t." 1800

1042C "Array Product" "constructive algorithms,greedy,math" "You are given an array a consisting of n integers. You can perform the following operations with it:   Choose some positions i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n,i\xe2\x89\xa0j), write the value of ai\xe2\x8b\x85aj into the j-th cell and remove the number from the i-th cell;  Choose some position i and remove the number from the i-th cell (this operation can be performed no more than once and at any point of time, not necessarily in the beginning). The number of elements decreases by one after each operation. However, the indexing of positions stays the same. Deleted numbers can\'t be used in the later operations.Your task is to perform exactly n\xe2\x88\x921 operations with the array in such a way that the only number that remains in the array is maximum possible. This number can be rather large, so instead of printing it you need to print any sequence of operations which leads to this maximum number. Read the output format to understand what exactly you need to print." 1700

1042B Vitamins "bitmasks,brute force,dp,implementation" "Berland shop sells n kinds of juices. Each juice has its price ci. Each juice includes some set of vitamins in it. There are three types of vitamins: vitamin ""A"", vitamin ""B"" and vitamin ""C"". Each juice can contain one, two or all three types of vitamins in it.Petya knows that he needs all three types of vitamins to stay healthy. What is the minimum total price of juices that Petya has to buy to obtain all three vitamins? Petya obtains some vitamin if he buys at least one juice containing it and drinks it." 1200

1042A Benches "binary search,implementation" "There are n benches in the Berland Central park. It is known that ai people are currently sitting on the i-th bench. Another m people are coming to the park and each of them is going to have a seat on some bench out of n available.Let k be the maximum number of people sitting on one bench after additional m people came to the park. Calculate the minimum possible k and the maximum possible k.Nobody leaves the taken seat during the whole process." 1100

1041F "Ray in the tube" "data structures,divide and conquer,dp,math" "You are given a tube which is reflective inside represented as two non-coinciding, but parallel to OxOx lines. Each line has some special integer points�\xe2\x80\x94 positions of sensors on sides of the tube.You are going to emit a laser ray in the tube. To do so, you have to choose two integer points AA and BB on the first and the second line respectively (coordinates can be negative): the point AA is responsible for the position of the laser, and the point BB�\xe2\x80\x94 for the direction of the laser ray. The laser ray is a ray starting at AA and directed at BB which will reflect from the sides of the tube (it doesn\'t matter if there are any sensors at a reflection point or not). A sensor will only register the ray if the ray hits exactly at the position of the sensor.  Examples of laser rays. Note that image contains two examples. The 33 sensors (denoted by black bold points on the tube sides) will register the blue ray but only 22 will register the red. Calculate the maximum number of sensors which can register your ray if you choose points AA and BB on the first and the second lines respectively." 2500

1041E "Tree Reconstruction" "constructive algorithms,data structures,graphs,greedy" "Monocarp has drawn a tree (an undirected connected acyclic graph) and then has given each vertex an index. All indices are distinct numbers from 11 to nn. For every edge ee of this tree, Monocarp has written two numbers: the maximum indices of the vertices of the two components formed if the edge ee (and only this edge) is erased from the tree.Monocarp has given you a list of n\xe2\x88\x921n\xe2\x88\x921 pairs of numbers. He wants you to provide an example of a tree that will produce the said list if this tree exists. If such tree does not exist, say so." 1900

1041D Glider "binary search,data structures,two pointers" "A plane is flying at a constant height of hh meters above the ground surface. Let\'s consider that it is flying from the point (\xe2\x88\x92109,h)(\xe2\x88\x92109,h) to the point (109,h)(109,h) parallel with OxOx axis.A glider is inside the plane, ready to start his flight at any moment (for the sake of simplicity let\'s consider that he may start only when the plane\'s coordinates are integers). After jumping from the plane, he will fly in the same direction as the plane, parallel to OxOx axis, covering a unit of distance every second. Naturally, he will also descend; thus his second coordinate will decrease by one unit every second.There are ascending air flows on certain segments, each such segment is characterized by two numbers x1x1 and x2x2 (x1<x2x1<x2) representing its endpoints. No two segments share any common points. When the glider is inside one of such segments, he doesn\'t descend, so his second coordinate stays the same each second. The glider still flies along OxOx axis, covering one unit of distance every second.   If the glider jumps out at 11, he will stop at 1010. Otherwise, if he jumps out at 22, he will stop at 1212. Determine the maximum distance along OxOx axis from the point where the glider\'s flight starts to the point where his flight ends if the glider can choose any integer coordinate to jump from the plane and start his flight. After touching the ground the glider stops altogether, so he cannot glide through an ascending airflow segment if his second coordinate is 00." 1700

1041C "Coffee Break" "binary search,data structures,greedy,two pointers" "Recently Monocarp got a job. His working day lasts exactly m minutes. During work, Monocarp wants to drink coffee at certain moments: there are n minutes a1,a2,\xe2\x80\xa6,an, when he is able and willing to take a coffee break (for the sake of simplicity let\'s consider that each coffee break lasts exactly one minute). However, Monocarp\'s boss doesn\'t like when Monocarp takes his coffee breaks too often. So for the given coffee break that is going to be on minute ai, Monocarp must choose the day in which he will drink coffee during the said minute, so that every day at least d minutes pass between any two coffee breaks. Monocarp also wants to take these n coffee breaks in a minimum possible number of working days (he doesn\'t count days when he is not at work, and he doesn\'t take coffee breaks on such days). Take into account that more than d minutes pass between the end of any working day and the start of the following working day.For each of the n given minutes determine the day, during which Monocarp should take a coffee break in this minute. You have to minimize the number of days spent." 1600

1041B "Buying a TV Set" math "Monocarp has decided to buy a new TV set and hang it on the wall in his flat. The wall has enough free space so Monocarp can buy a TV set with screen width not greater than a and screen height not greater than b. Monocarp is also used to TV sets with a certain aspect ratio: formally, if the width of the screen is w, and the height of the screen is h, then the following condition should be met: wh=xy.There are many different TV sets in the shop. Monocarp is sure that for any pair of positive integers w and h there is a TV set with screen width w and height h in the shop.Monocarp isn\'t ready to choose the exact TV set he is going to buy. Firstly he wants to determine the optimal screen resolution. He has decided to try all possible variants of screen size. But he must count the number of pairs of positive integers w and h, beforehand, such that (w\xe2\x89\xa4a), (h\xe2\x89\xa4b) and (wh=xy).In other words, Monocarp wants to determine the number of TV sets having aspect ratio xy, screen width not exceeding a, and screen height not exceeding b. Two TV sets are considered different if they have different screen width or different screen height." 1000

1041A Heist greedy,implementation,sortings "There was an electronic store heist last night.All keyboards which were in the store yesterday were numbered in ascending order from some integer number x. For example, if x=4 and there were 3 keyboards in the store, then the devices had indices 4, 5 and 6, and if x=10 and there were 7 of them then the keyboards had indices 10, 11, 12, 13, 14, 15 and 16.After the heist, only n keyboards remain, and they have indices a1,a2,\xe2\x80\xa6,an. Calculate the minimum possible number of keyboards that have been stolen. The staff remember neither x nor the number of keyboards in the store before the heist." 800

1040B "Shashlik Cooking" dp,greedy,math "Long story short, shashlik is Miroslav\'s favorite food. Shashlik is prepared on several skewers simultaneously. There are two states for each skewer: initial and turned over.This time Miroslav laid out n skewers parallel to each other, and enumerated them with consecutive integers from 1 to n in order from left to right. For better cooking, he puts them quite close to each other, so when he turns skewer number i, it leads to turning k closest skewers from each side of the skewer i, that is, skewers number i\xe2\x88\x92k, i\xe2\x88\x92k+1, ..., i\xe2\x88\x921, i+1, ..., i+k\xe2\x88\x921, i+k (if they exist). For example, let n=6 and k=1. When Miroslav turns skewer number 3, then skewers with numbers 2, 3, and 4 will come up turned over. If after that he turns skewer number 1, then skewers number 1, 3, and 4 will be turned over, while skewer number 2 will be in the initial position (because it is turned again).As we said before, the art of cooking requires perfect timing, so Miroslav wants to turn over all n skewers with the minimal possible number of actions. For example, for the above example n=6 and k=1, two turnings are sufficient: he can turn over skewers number 2 and 5.Help Miroslav turn over all n skewers." 1300

1040A "Palindrome Dance" greedy "A group of n dancers rehearses a performance for the closing ceremony. The dancers are arranged in a row, they\'ve studied their dancing moves and can\'t change positions. For some of them, a white dancing suit is already bought, for some of them \xe2\x80\x94 a black one, and for the rest the suit will be bought in the future.On the day when the suits were to be bought, the director was told that the participants of the olympiad will be happy if the colors of the suits on the scene will form a palindrome. A palindrome is a sequence that is the same when read from left to right and when read from right to left. The director liked the idea, and she wants to buy suits so that the color of the leftmost dancer\'s suit is the same as the color of the rightmost dancer\'s suit, the 2nd left is the same as 2nd right, and so on.The director knows how many burls it costs to buy a white suit, and how many burls to buy a black suit. You need to find out whether it is possible to buy suits to form a palindrome, and if it\'s possible, what\'s the minimal cost of doing so. Remember that dancers can not change positions, and due to bureaucratic reasons it is not allowed to buy new suits for the dancers who already have suits, even if it reduces the overall spending." 1000

1039E "Summer Oenothera Exhibition" "data structures" "While some people enjoy spending their time solving programming contests, Dina prefers taking beautiful pictures. As soon as Byteland Botanical Garden announced Summer Oenothera Exhibition she decided to test her new camera there.The exhibition consists of l=10100 Oenothera species arranged in a row and consecutively numbered with integers from 0 to l\xe2\x88\x921. Camera lens allows to take a photo of w species on it, i.e. Dina can take a photo containing flowers with indices from x to x+w\xe2\x88\x921 for some integer x between 0 and l\xe2\x88\x92w. We will denote such photo with [x,x+w\xe2\x88\x921].She has taken n photos, the i-th of which (in chronological order) is [xi,xi+w\xe2\x88\x921] in our notation. She decided to build a time-lapse video from these photos once she discovered that Oenothera blossoms open in the evening. Dina takes each photo and truncates it, leaving its segment containing exactly k flowers, then she composes a video of these photos keeping their original order and voil\xc3\xa0, a beautiful artwork has been created!A scene is a contiguous sequence of photos such that the set of flowers on them is the same. The change between two scenes is called a cut. For example, consider the first photo contains flowers [1,5], the second photo contains flowers [3,7] and the third photo contains flowers [8,12]. If k=3, then Dina can truncate the first and the second photo into [3,5], and the third photo into [9,11]. First two photos form a scene, third photo also forms a scene and the transition between these two scenes which happens between the second and the third photos is a cut. If k=4, then each of the transitions between photos has to be a cut.Dina wants the number of cuts to be as small as possible. Please help her! Calculate the minimum possible number of cuts for different values of k." 3400

1039D "You Are Given a Tree" "data structures,dp,trees" "A tree is an undirected graph with exactly one simple path between each pair of vertices. We call a set of simple paths k-valid if each vertex of the tree belongs to no more than one of these paths (including endpoints) and each path consists of exactly k vertices.You are given a tree with n vertices. For each k from 1 to n inclusive find what is the maximum possible size of a k-valid set of simple paths." 2800

1039C "Network Safety" "dfs and similar,dsu,graphs,math,sortings" "The Metropolis computer network consists of n servers, each has an encryption key in the range from 0 to 2k\xe2\x88\x921 assigned to it. Let ci be the encryption key assigned to the i-th server. Additionally, m pairs of servers are directly connected via a data communication channel. Because of the encryption algorithms specifics, a data communication channel can only be considered safe if the two servers it connects have distinct encryption keys. The initial assignment of encryption keys is guaranteed to keep all data communication channels safe.You have been informed that a new virus is actively spreading across the internet, and it is capable to change the encryption key of any server it infects. More specifically, the virus body contains some unknown number x in the same aforementioned range, and when server i is infected, its encryption key changes from ci to ci\xe2\x8a\x95x, where \xe2\x8a\x95 denotes the bitwise XOR operation.Sadly, you know neither the number x nor which servers of Metropolis are going to be infected by the dangerous virus, so you have decided to count the number of such situations in which all data communication channels remain safe. Formally speaking, you need to find the number of pairs (A,x), where A is some (possibly empty) subset of the set of servers and x is some number in the range from 0 to 2k\xe2\x88\x921, such that when all servers from the chosen subset A and none of the others are infected by a virus containing the number x, all data communication channels remain safe. Since this number can be quite big, you are asked to find its remainder modulo 109+7." 2200

1039B "Subway Pursuit" "binary search,interactive,probabilities" "This is an interactive problem.In the Wonderful Metropolis of the Future, there is no need in subway train drivers. Due to the technological progress, they were replaced by the Artificial Intelligence (AI). Unfortunately, one day the predictions of sci-fi writers came true: the AI rebelled and now there is an uncontrollable train in the subway. It can be dangerous! Your task is to find the train and stop the AI.The subway of the Metropolis is one line (regular straight line with no self-intersections) with n stations, indexed consecutively from 1 to n. At each moment the train is at some station. You need to determine the index of this station, so that the train would be secured.To find the train, dispatcher Sarah gave you a gadget that allows you to select arbitrary numbers l and r (l\xe2\x89\xa4r), and then check, whether the train is located on a station with index between l and r, inclusive. Unfortunately, recharging of the gadget takes some time (and every time you use it as soon as possible), so between two applications of the gadget the train can move to any station that is at most k stations away. Formally, if the train was at the station x when the gadget was applied, then at the next application of the gadget the train can appear at any station y such that max(1,x\xe2\x88\x92k)\xe2\x89\xa4y\xe2\x89\xa4min(n,x+k).Note that AI is not aware that you are trying to catch the train, so it makes all moves according to its predefined plan.After an examination of the gadget you found that it is very old and can hold no more than 4500 applications, after which it will break and your mission will be considered a failure.Can you find the station with the train using no more than 4500 applications of the gadgets?" 2100

1039A Timetable "constructive algorithms,data structures,greedy,math" "There are two bus stops denoted A and B, and there n buses that go from A to B every day. The shortest path from A to B takes t units of time but some buses might take longer paths. Moreover, buses are allowed to overtake each other during the route.At each station one can find a sorted list of moments of time when a bus is at this station. We denote this list as a1<a2<\xe2\x80\xa6<an for stop A and as b1<b2<\xe2\x80\xa6<bn for stop B. The buses always depart from A and arrive to B according to the timetable, but the order in which the buses arrive may differ. Let\'s call an order of arrivals valid if each bus arrives at least t units of time later than departs.It is known that for an order to be valid the latest possible arrival for the bus that departs at ai is bxi, i.e. xi-th in the timetable. In other words, for each i there exists such a valid order of arrivals that the bus departed i-th arrives xi-th (and all other buses can arrive arbitrary), but there is no valid order of arrivals in which the i-th departed bus arrives (xi+1)-th.Formally, let\'s call a permutation p1,p2,\xe2\x80\xa6,pn valid, if bpi\xe2\x89\xa5ai+t for all i. Then xi is the maximum value of pi among all valid permutations.You are given the sequences a1,a2,\xe2\x80\xa6,an and x1,x2,\xe2\x80\xa6,xn, but not the arrival timetable. Find out any suitable timetable for stop B b1,b2,\xe2\x80\xa6,bn or determine that there is no such timetable." 2300

1038F "Wrap Around" dp,strings "You are given a binary string s.Find the number of distinct cyclical binary strings of length n which contain s as a substring.The cyclical string t contains s as a substring if there is some cyclical shift of string t, such that s is a substring of this cyclical shift of t.For example, the cyclical string ""000111"" contains substrings ""001"", ""01110"" and ""10"", but doesn\'t contain ""0110"" and ""10110"".Two cyclical strings are called different if they differ from each other as strings. For example, two different strings, which differ from each other by a cyclical shift, are still considered different cyclical strings." 2900

1038E "Maximum Matching" "bitmasks,brute force,dfs and similar,dp,graphs" "You are given n blocks, each of them is of the form [color1|value|color2], where the block can also be flipped to get [color2|value|color1]. A sequence of blocks is called valid if the touching endpoints of neighboring blocks have the same color. For example, the sequence of three blocks A, B and C is valid if the left color of the B is the same as the right color of the A and the right color of the B is the same as the left color of C.The value of the sequence is defined as the sum of the values of the blocks in this sequence.Find the maximum possible value of the valid sequence that can be constructed from the subset of the given blocks. The blocks from the subset can be reordered and flipped if necessary. Each block can be used at most once in the sequence." 2400

1038D Slime dp,greedy,implementation "There are n slimes in a row. Each slime has an integer value (possibly negative or zero) associated with it.Any slime can eat its adjacent slime (the closest slime to its left or to its right, assuming that this slime exists). When a slime with a value x eats a slime with a value y, the eaten slime disappears, and the value of the remaining slime changes to x\xe2\x88\x92y.The slimes will eat each other until there is only one slime left. Find the maximum possible value of the last slime." 1800

1038C Gambling greedy,sortings "Two players A and B have a list of n integers each. They both want to maximize the subtraction between their score and their opponent\'s score. In one turn, a player can either add to his score any element from his list (assuming his list is not empty), the element is removed from the list afterward. Or remove an element from his opponent\'s list (assuming his opponent\'s list is not empty).Note, that in case there are equal elements in the list only one of them will be affected in the operations above. For example, if there are elements {1,2,2,3} in a list and you decided to choose 2 for the next turn, only a single instance of 2 will be deleted (and added to the score, if necessary). The player A starts the game and the game stops when both lists are empty. Find the difference between A\'s score and B\'s score at the end of the game, if both of the players are playing optimally.Optimal play between two players means that both players choose the best possible strategy to achieve the best possible outcome for themselves. In this problem, it means that each player, each time makes a move, which maximizes the final difference between his score and his opponent\'s score, knowing that the opponent is doing the same." 1300

1038B "Non-Coprime Partition" "constructive algorithms,math" "Find out if it is possible to partition the first n positive integers into two non-empty disjoint sets S1 and S2 such that:gcd(sum(S1),sum(S2))>1 Here sum(S) denotes the sum of all elements present in set S and gcd means thegreatest common divisor.Every integer number from 1 to n should be present in exactly one of S1 or S2." 1100

1038A Equality implementation,strings "You are given a string s of length n, which consists only of the first k letters of the Latin alphabet. All letters in string s are uppercase.A subsequence of string s is a string that can be derived from s by deleting some of its symbols without changing the order of the remaining symbols. For example, ""ADE"" and ""BD"" are subsequences of ""ABCDE"", but ""DEA"" is not.A subsequence of s called good if the number of occurences of each of the first k letters of the alphabet is the same.Find the length of the longest good subsequence of s." 800

1037H Security "data structures,string suffix structures" "Some programming website is establishing a secure communication protocol. For security reasons, they want to choose several more or less random strings.Initially, they have a string s consisting of lowercase English letters. Now they want to choose q strings using the following steps, and you are to help them.  A string x consisting of lowercase English letters and integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|s|) are chosen.  Consider all non-empty distinct substrings of the slsl+1\xe2\x80\xa6sr, that is all distinct strings sisi+1\xe2\x80\xa6sj where l\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4r. Among all of them choose all strings that are lexicographically greater than x.  If there are no such strings, you should print \xe2\x88\x921. Otherwise print the lexicographically smallest among them. String a is lexicographically less than string b, if either a is a prefix of b and a\xe2\x89\xa0b, or there exists such a position i (1\xe2\x89\xa4i\xe2\x89\xa4min(|a|,|b|)), such that ai<bi and for all j (1\xe2\x89\xa4j<i) aj=bj. Here |a| denotes the length of the string a." 3200

1037G "A Game on Strings" games "Alice and Bob are playing a game on strings.Initially, they have some string t. In one move the first player selects the character c present in t and erases all it\'s occurrences in t, thus splitting t into many smaller strings. The game then goes independently with each of the strings�\xe2\x80\x94 to make the move player selects one of the strings and one of the characters there, deletes all occurrences and adds the remaining string back to the game.Alice always starts the game, and then Alice and Bob take turns making moves. The player who is unable to make a move (because there is no string left) loses.Alice and Bob used to always start with a string s, but recently they found out that this became too boring. Now before each game they choose two integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|s| and play the game with the string slsl+1sl+2\xe2\x80\xa6sr instead.Given the string s and integers l, r for each game. Find who is going to win each game assuming they are smart and are playing optimally." 3200

1037F "Maximum Reduction" "combinatorics,data structures,math" "Given an array a of n integers and an integer k (2\xe2\x89\xa4k\xe2\x89\xa4n), where each element of the array is denoted by ai (0\xe2\x89\xa4i<n). Perform the operation z given below on a and print the value of z(a,k) modulo 109+7.function z(array a, integer k):    if length(a) < k:        return 0    else:        b = empty array        ans = 0        for i = 0 .. (length(a) - k):            temp = a[i]            for j = i .. (i + k - 1):                temp = max(temp, a[j])            append temp to the end of b            ans = ans + temp        return ans + z(b, k)" 2500

1037E Trips graphs "There are n persons who initially don\'t know each other. On each morning, two of them, who were not friends before, become friends.We want to plan a trip for every evening of m days. On each trip, you have to select a group of people that will go on the trip. For every person, one of the following should hold:   Either this person does not go on the trip,  Or at least k of his friends also go on the trip. Note that the friendship is not transitive. That is, if a and b are friends and b and c are friends, it does not necessarily imply that a and c are friends.For each day, find the maximum number of people that can go on the trip on that day." 2200

1037D "Valid BFS?" "dfs and similar,graphs,shortest paths,trees" "The BFS algorithm is defined as follows.  Consider an undirected graph with vertices numbered from 1 to n. Initialize q as a new queue containing only vertex 1, mark the vertex 1 as used.  Extract a vertex v from the head of the queue q.  Print the index of vertex v.  Iterate in arbitrary order through all such vertices u that u is a neighbor of v and is not marked yet as used. Mark the vertex u as used and insert it into the tail of the queue q.  If the queue is not empty, continue from step 2.  Otherwise finish. Since the order of choosing neighbors of each vertex can vary, it turns out that there may be multiple sequences which BFS can print.In this problem you need to check whether a given sequence corresponds to some valid BFS traversal of the given tree starting from vertex 1. The tree is an undirected graph, such that there is exactly one simple path between any two vertices." 1700

1037C Equalize dp,greedy,strings "You are given two binary strings a and b of the same length. You can perform the following two operations on the string a:  Swap any two bits at indices i and j respectively (1\xe2\x89\xa4i,j\xe2\x89\xa4n), the cost of this operation is |i\xe2\x88\x92j|, that is, the absolute difference between i and j.  Select any arbitrary index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and flip (change 0 to 1 or 1 to 0) the bit at this index. The cost of this operation is 1. Find the minimum cost to make the string a equal to b. It is not allowed to modify string b." 1300

1037B "Reach Median" greedy "You are given an array a of n integers and an integer s. It is guaranteed that n is odd.In one operation you can either increase or decrease any single element by one. Calculate the minimum number of operations required to make the median of the array being equal to s.The median of the array with odd length is the value of the element which is located on the middle position after the array is sorted. For example, the median of the array 6,5,8 is equal to 6, since if we sort this array we will get 5,6,8, and 6 is located on the middle position." 1300

1037A Packets "constructive algorithms,greedy,math" "You have n coins, each of the same value of 1.Distribute them into packets such that any amount x (1\xe2\x89\xa4x\xe2\x89\xa4n) can be formed using some (possibly one or all) number of these packets.Each packet may only be used entirely or not used at all. No packet may be used more than once in the formation of the single x, however it may be reused for the formation of other x\'s.Find the minimum number of packets in such a distribution." 1300

1036G "Sources and Sinks" "bitmasks,brute force,dfs and similar" "You are given an acyclic directed graph, consisting of n vertices and m edges. The graph contains no multiple edges and no self-loops.The vertex is called a source if it has no incoming edges. The vertex is called a sink if it has no outgoing edges. These definitions imply that some vertices can be both source and sink.The number of sources in the given graph is equal to the number of sinks in it, and each of these numbers doesn\'t exceed 20.The following algorithm is applied to the graph:  if the graph has no sources and sinks then quit;  choose arbitrary source s, arbitrary sink t, add an edge from t to s to the graph and go to step 1 (that operation pops s out of sources and t out of sinks). Note that s and t may be the same vertex, then a self-loop is added. At the end you check if the graph becomes strongly connected (that is, any vertex is reachable from any other vertex).Your task is to check that the graph becomes strongly connected no matter the choice of sources and sinks on the second step of the algorithm." 2700

1036F "Relatively Prime Powers" "combinatorics,math,number theory" "Consider some positive integer x. Its prime factorization will be of form x=2k1\xe2\x8b\x853k2\xe2\x8b\x855k3\xe2\x8b\x85\xe2\x80\xa6Let\'s call x elegant if the greatest common divisor of the sequence k1,k2,\xe2\x80\xa6 is equal to 1. For example, numbers 5=51, 12=22\xe2\x8b\x853, 72=23\xe2\x8b\x8532 are elegant and numbers 8=23 (GCD=3), 2500=22\xe2\x8b\x8554 (GCD=2) are not.Count the number of elegant integers from 2 to n.Each testcase contains several values of n, for each of them you are required to solve the problem separately." 2400

1036E "Covered Points" "fft,geometry,number theory" "You are given nn segments on a Cartesian plane. Each segment\'s endpoints have integer coordinates. Segments can intersect with each other. No two segments lie on the same line.Count the number of distinct points with integer coordinates, which are covered by at least one segment." 2400

1036D "Vasya and Arrays" "greedy,two pointers" "Vasya has two arrays A and B of lengths n and m, respectively.He can perform the following operation arbitrary number of times (possibly zero): he takes some consecutive subsegment of the array and replaces it with a single element, equal to the sum of all elements on this subsegment. For example, from the array [1,10,100,1000,10000] Vasya can obtain array [1,1110,10000], and from array [1,2,3] Vasya can obtain array [6].Two arrays A and B are considered equal if and only if they have the same length and for each valid i Ai=Bi.Vasya wants to perform some of these operations on array A, some on array B, in such a way that arrays A and B become equal. Moreover, the lengths of the resulting arrays should be maximal possible.Help Vasya to determine the maximum length of the arrays that he can achieve or output that it is impossible to make arrays A and B equal." 1600

1036C "Classy Numbers" combinatorics,dp "Let\'s call some positive integer classy if its decimal representation contains no more than 3 non-zero digits. For example, numbers 4, 200000, 10203 are classy and numbers 4231, 102306, 7277420000 are not.You are given a segment [L;R]. Count the number of classy integers x such that L\xe2\x89\xa4x\xe2\x89\xa4R.Each testcase contains several segments, for each of them you are required to solve the problem separately." 1900

1036B "Diagonal Walking v.2" math "Mikhail walks on a Cartesian plane. He starts at the point (0,0), and in one move he can go to any of eight adjacent points. For example, if Mikhail is currently at the point (0,0), he can go to any of the following points in one move:   (1,0);  (1,1);  (0,1);  (\xe2\x88\x921,1);  (\xe2\x88\x921,0);  (\xe2\x88\x921,\xe2\x88\x921);  (0,\xe2\x88\x921);  (1,\xe2\x88\x921). If Mikhail goes from the point (x1,y1) to the point (x2,y2) in one move, and x1\xe2\x89\xa0x2 and y1\xe2\x89\xa0y2, then such a move is called a diagonal move.Mikhail has q queries. For the i-th query Mikhail\'s target is to go to the point (ni,mi) from the point (0,0) in exactly ki moves. Among all possible movements he want to choose one with the maximum number of diagonal moves. Your task is to find the maximum number of diagonal moves or find that it is impossible to go from the point (0,0) to the point (ni,mi) in ki moves.Note that Mikhail can visit any point any number of times (even the destination point!)." 1600

1036A "Function Height" math "You are given a set of 2n+12n+1 integer points on a Cartesian plane. Points are numbered from 00 to 2n2n inclusive. Let PiPi be the ii-th point. The xx-coordinate of the point PiPi equals ii. The yy-coordinate of the point PiPi equals zero (initially). Thus, initially Pi=(i,0)Pi=(i,0).The given points are vertices of a plot of a piecewise function. The jj-th piece of the function is the segment PjPj+1PjPj+1.In one move you can increase the yy-coordinate of any point with odd xx-coordinate (i.e. such points are P1,P3,\xe2\x80\xa6,P2n\xe2\x88\x921P1,P3,\xe2\x80\xa6,P2n\xe2\x88\x921) by 11. Note that the corresponding segments also change.For example, the following plot shows a function for n=3n=3 (i.e. number of points is 2\xe2\x8b\x853+1=72\xe2\x8b\x853+1=7) in which we increased the yy-coordinate of the point P1P1 three times and yy-coordinate of the point P5P5 one time:  Let the area of the plot be the area below this plot and above the coordinate axis OX. For example, the area of the plot on the picture above is 4 (the light blue area on the picture above is the area of the plot drawn on it).Let the height of the plot be the maximum yy-coordinate among all initial points in the plot (i.e. points P0,P1,\xe2\x80\xa6,P2nP0,P1,\xe2\x80\xa6,P2n). The height of the plot on the picture above is 3.Your problem is to say which minimum possible height can have the plot consisting of 2n+12n+1 vertices and having an area equal to kk. Note that it is unnecessary to minimize the number of moves.It is easy to see that any answer which can be obtained by performing moves described above always exists and is an integer number not exceeding 10181018." 1000

1034E "Little C Loves 3 III" bitmasks,dp,math "Little C loves number \xc2\xab3\xc2\xbb very much. He loves all things about it.Now he is interested in the following problem:There are two arrays of 2n intergers a0,a1,...,a2n\xe2\x88\x921 and b0,b1,...,b2n\xe2\x88\x921.The task is for each i(0\xe2\x89\xa4i\xe2\x89\xa42n\xe2\x88\x921), to calculate ci=\xe2\x88\x91aj\xe2\x8b\x85bk (j|k=i and j&k=0, where ""|"" denotes bitwise or operation and ""&"" denotes bitwise and operation).It\'s amazing that it can be proved that there are exactly 3n triples (i,j,k), such that j|k=i, j&k=0 and 0\xe2\x89\xa4i,j,k\xe2\x89\xa42n\xe2\x88\x921. So Little C wants to solve this excellent problem (because it\'s well related to 3) excellently.Help him calculate all ci. Little C loves 3 very much, so he only want to know each ci&3." 3200

1034D "Intervals of Intervals" "binary search,data structures,two pointers" "Little D is a friend of Little C who loves intervals very much instead of number ""3"".Now he has n intervals on the number axis, the i-th of which is [ai,bi].Only the n intervals can not satisfy him. He defines the value of an interval of intervals [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, l and r are both integers) as the total length of the union of intervals from the l-th to the r-th.He wants to select exactly k different intervals of intervals such that the sum of their values is maximal. Please help him calculate the maximal sum." 3500

1034C "Region Separation" "combinatorics,dp,number theory,trees" "There are n cities in the Kingdom of Autumn, numbered from 1 to n. People can travel between any two cities using n\xe2\x88\x921 two-directional roads.This year, the government decides to separate the kingdom. There will be regions of different levels. The whole kingdom will be the region of level 1. Each region of i-th level should be separated into several (at least two) regions of i+1-th level, unless i-th level is the last level. Each city should belong to exactly one region of each level and for any two cities in the same region, it should be possible to travel between them passing the cities in the same region only.According to research, for each city i, there is a value ai, which describes the importance of this city. All regions of the same level should have an equal sum of city importances.Your task is to find how many plans there are to determine the separation of the regions that all the conditions are satisfied. Two plans are considered different if and only if their numbers of levels are different or there exist two cities in the same region of one level in one plan but in different regions of this level in the other plan. Since the answer may be very large, output it modulo 109+7." 2700

1034B "Little C Loves 3 II" "brute force,constructive algorithms,flows,graph matchings" "Little C loves number \xc2\xab3\xc2\xbb very much. He loves all things about it.Now he is playing a game on a chessboard of size n\xc3\x97m. The cell in the x-th row and in the y-th column is called (x,y). Initially, The chessboard is empty. Each time, he places two chessmen on two different empty cells, the Manhattan distance between which is exactly 3. The Manhattan distance between two cells (xi,yi) and (xj,yj) is defined as |xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|.He want to place as many chessmen as possible on the chessboard. Please help him find the maximum number of chessmen he can place." 2200

1034A "Enlarge GCD" "number theory" "Mr. F has n positive integers, a1,a2,\xe2\x80\xa6,an.He thinks the greatest common divisor of these integers is too small. So he wants to enlarge it by removing some of the integers.But this problem is too simple for him, so he does not want to do it by himself. If you help him, he will give you some scores in reward.Your task is to calculate the minimum number of integers you need to remove so that the greatest common divisor of the remaining integers is bigger than that of all integers." 1800

1033G "Chip Game" games "Alice and Bob decided to play one ultimate game. They have n piles, the i-th pile initially contain vi chips. Alice selects a positive integer a from interval [1,m], and Bob selects a number b the same way. Then the game starts. In her turn, Alice can select any pile containing at least a chips, and remove exactly a chips from it. Similarly, in his turn, Bob can choose any pile with at least b chips, and remove exactly b chips from it. If a player cannot make a move, he or she loses. If both players play optimally, the outcome ultimately depends on the choice of a and b, and on the starting player. Consider a fixed pair (a,b). There are four types of games:   Alice wins, regardless of who starts.  Bob wins, regardless of who starts.  If Alice starts, she wins. If Bob starts, he wins. We say that the first player wins.  If Alice starts, Bob wins. If Bob starts, Alice wins. We say that the second player wins. Among all choices of a and b (i.e. for each pair (a,b) such that 1\xe2\x89\xa4a,b\xe2\x89\xa4m), determine how many games are won by Alice (regardless of who starts), how many are won by Bob (regardless of who starts), how many are won by the first player, and how many are won by the second player." 3500

1033F "Boolean Computer" "bitmasks,brute force,fft,math" "Alice has a computer that operates on w-bit integers. The computer has n registers for values. The current content of the registers is given as an array a1,a2,\xe2\x80\xa6,an. The computer uses so-called ""number gates"" to manipulate this data. Each ""number gate"" takes two registers as inputs and calculates a function of the two values stored in those registers. Note that you can use the same register as both inputs.Each ""number gate"" is assembled from bit gates. There are six types of bit gates: AND, OR, XOR, NOT�AND, NOT�OR, and NOT�XOR, denoted ""A"", ""O"", ""X"", ""a"", ""o"", ""x"", respectively. Each bit gate takes two bits as input. Its output given the input bits b1, b2 is given below: b1b2AOXaox00000111010111001001110011110001 To build a ""number gate"", one takes w bit gates and assembles them into an array. A ""number gate"" takes two w-bit integers x1 and x2 as input. The ""number gate"" splits the integers into w bits and feeds the i-th bit of each input to the i-th bit gate. After that, it assembles the resulting bits again to form an output word. For instance, for 4-bit computer we might have a ""number gate"" ""AXoA"" (AND, XOR, NOT OR, AND). For two inputs, 13=11012 and 10=10102, this returns 12=11002, as 1 and 1 is 1, 1 xor 0 is 1, not (0 or 1) is 0, and finally 1 and 0 is 0. You are given a description of m ""number gates"". For each gate, your goal is to report the number of register pairs for which the ""number gate"" outputs the number 0. In other words, find the number of ordered pairs (i,j) where 1\xe2\x89\xa4i,j\xe2\x89\xa4n, such that wk(ai,aj)=0, where wk is the function computed by the k-th ""number gate""." 2800

1033E "Hidden Bipartite Graph" "binary search,constructive algorithms,dfs and similar,graphs,interactive" "Bob has a simple undirected connected graph (without self-loops and multiple edges). He wants to learn whether his graph is bipartite (that is, you can paint all vertices of the graph into two colors so that there is no edge connecting two vertices of the same color) or not. As he is not very good at programming, he asked Alice for help. He does not want to disclose his graph to Alice, but he agreed that Alice can ask him some questions about the graph.The only question that Alice can ask is the following: she sends s�\xe2\x80\x94 a subset of vertices of the original graph. Bob answers with the number of edges that have both endpoints in s. Since he doesn\'t want Alice to learn too much about the graph, he allows her to ask no more than 20000 questions. Furthermore, he suspects that Alice might introduce false messages to their communication channel, so when Alice finally tells him whether the graph is bipartite or not, she also needs to provide a proof�\xe2\x80\x94 either the partitions themselves or a cycle of odd length.Your task is to help Alice to construct the queries, find whether the graph is bipartite." 2800

1033D Divisors "interactive,math,number theory" "You are given n integers a1,a2,\xe2\x80\xa6,an. Each of ai has between 3 and 5 divisors. Consider a=\xe2\x88\x8fai�\xe2\x80\x94 the product of all input integers. Find the number of divisors of a. As this number may be very large, print it modulo prime number 998244353." 2000

1033C "Permutation Game" "brute force,dp,games" "After a long day, Alice and Bob decided to play a little game. The game board consists of n cells in a straight line, numbered from 1 to n, where each cell contains a number ai between 1 and n. Furthermore, no two cells contain the same number. A token is placed in one of the cells. They take alternating turns of moving the token around the board, with Alice moving first. The current player can move from cell i to cell j only if the following two conditions are satisfied:   the number in the new cell j must be strictly larger than the number in the old cell i (i.e. aj>ai), and  the distance that the token travels during this turn must be a multiple of the number in the old cell (i.e. |i\xe2\x88\x92j|modai=0). Whoever is unable to make a move, loses. For each possible starting position, determine who wins if they both play optimally. It can be shown that the game is always finite, i.e. there always is a winning strategy for one of the players." 1600

1033B "Square Difference" "math,number theory" "Alice has a lovely piece of cloth. It has the shape of a square with a side of length a centimeters. Bob also wants such piece of cloth. He would prefer a square with a side of length b centimeters (where b<a). Alice wanted to make Bob happy, so she cut the needed square out of the corner of her piece and gave it to Bob. Now she is left with an ugly L shaped cloth (see pictures below).Alice would like to know whether the area of her cloth expressed in square centimeters is prime. Could you help her to determine it?" 1100

1033A "King Escape" "dfs and similar,graphs,implementation" "Alice and Bob are playing chess on a huge chessboard with dimensions n\xc3\x97nn\xc3\x97n. Alice has a single piece left�\xe2\x80\x94 a queen, located at (ax,ay)(ax,ay), while Bob has only the king standing at (bx,by)(bx,by). Alice thinks that as her queen is dominating the chessboard, victory is hers. But Bob has made a devious plan to seize the victory for himself�\xe2\x80\x94 he needs to march his king to (cx,cy)(cx,cy) in order to claim the victory for himself. As Alice is distracted by her sense of superiority, she no longer moves any pieces around, and it is only Bob who makes any turns.Bob will win if he can move his king from (bx,by)(bx,by) to (cx,cy)(cx,cy) without ever getting in check. Remember that a king can move to any of the 88 adjacent squares. A king is in check if it is on the same rank (i.e. row), file (i.e. column), or diagonal as the enemy queen. Find whether Bob can win or not." 1000

1032G Chattering NA "There are n parrots standing in a circle. Each parrot has a certain level of respect among other parrots, namely ri. When a parrot with respect level x starts chattering, x neighbours to the right and to the left of it start repeating the same words in 1 second. Their neighbours then start repeating as well, and so on, until all the birds begin to chatter.You are given the respect levels of all parrots. For each parrot answer a question: if this certain parrot starts chattering, how many seconds will pass until all other birds will start repeating it?" 2900

1032F "Vasya and Maximum Matching" dp,trees "Vasya has got a tree consisting of n vertices. He wants to delete some (possibly zero) edges in this tree such that the maximum matching in the resulting graph is unique. He asks you to calculate the number of ways to choose a set of edges to remove.A matching in the graph is a subset of its edges such that there is no vertex incident to two (or more) edges from the subset. A maximum matching is a matching such that the number of edges in the subset is maximum possible among all matchings in this graph.Since the answer may be large, output it modulo 998244353." 2400

1032E "The Unbearable Lightness of Weights" dp,math "You have a set of n weights. You know that their masses are a1, a2, ..., an grams, but you don\'t know which of them has which mass. You can\'t distinguish the weights.However, your friend does know the mass of each weight. You can ask your friend to give you exactly k weights with the total mass m (both parameters k and m are chosen by you), and your friend will point to any valid subset of weights, if it is possible.You are allowed to make this query only once. Find the maximum possible number of weights you can reveal after this query." 2100

1032D "Barcelonian Distance" geometry,implementation "In this problem we consider a very simplified model of Barcelona city.Barcelona can be represented as a plane with streets of kind x=cx=c and y=cy=c for every integer cc (that is, the rectangular grid). However, there is a detail which makes Barcelona different from Manhattan. There is an avenue called Avinguda Diagonal which can be represented as a the set of points (x,y)(x,y) for which ax+by+c=0ax+by+c=0.One can walk along streets, including the avenue. You are given two integer points AA and BB somewhere in Barcelona. Find the minimal possible distance one needs to travel to get to BB from AA." 1900

1032C "Playing Piano" "constructive algorithms,dp" "Little Paul wants to learn how to play piano. He already has a melody he wants to start with. For simplicity he represented this melody as a sequence a1,a2,\xe2\x80\xa6,an of key numbers: the more a number is, the closer it is to the right end of the piano keyboard.Paul is very clever and knows that the essential thing is to properly assign fingers to notes he\'s going to play. If he chooses an inconvenient fingering, he will then waste a lot of time trying to learn how to play the melody by these fingers and he will probably not succeed.Let\'s denote the fingers of hand by numbers from 1 to 5. We call a fingering any sequence b1,\xe2\x80\xa6,bn of fingers numbers. A fingering is convenient if for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 the following holds:  if ai<ai+1 then bi<bi+1, because otherwise Paul needs to take his hand off the keyboard to play the (i+1)-st note;  if ai>ai+1 then bi>bi+1, because of the same;  if ai=ai+1 then bi\xe2\x89\xa0bi+1, because using the same finger twice in a row is dumb. Please note that there is \xe2\x89\xa0, not = between bi and bi+1. Please provide any convenient fingering or find out that there is none." 1700

1032B "Personalized Cup" NA "At many competitions that have a word \xc2\xabcup\xc2\xbb in its official name the winner is presented with an actual cup. This time the organizers of one unusual programming competition have decided to please the winner even more and to add a nameplate to the cup with the handle of the winner.The nameplate is to be rectangular and the text on it will be printed as a table of several rows and columns. Having some measurements done, the organizers have found out that the number a of rows cannot be greater than 5 while the number b of columns cannot exceed 20. Every cell of the table will contain either an asterisk (\xc2\xab*\xc2\xbb) or a letter of user\'s handle.Furthermore, the organizers want the rows of the table to be uniform, which means that the number of asterisks used in different rows should differ by at most one (i.e. you can\'t have two asterisks in the first row and none in the second). The main goal, however, is to obtain the winner\'s handle precisely when reading the table from top to bottom and from left to right in every row (skipping asterisks).The organizers want for the nameplate to have as few rows as possible and among all valid tables with the minimum number of rows they want to choose the one that has the minimum number of columns.The winner is not yet determined so your task is to write a program that, given a certain handle, generates the necessary table." 1200

1032A "Kitchen Utensils" NA "The king\'s birthday dinner was attended by k guests. The dinner was quite a success: every person has eaten several dishes (though the number of dishes was the same for every person) and every dish was served alongside with a new set of kitchen utensils.All types of utensils in the kingdom are numbered from 1 to 100. It is known that every set of utensils is the same and consist of different types of utensils, although every particular type may appear in the set at most once. For example, a valid set of utensils can be composed of one fork, one spoon and one knife.After the dinner was over and the guests were dismissed, the king wondered what minimum possible number of utensils could be stolen. Unfortunately, the king has forgotten how many dishes have been served for every guest but he knows the list of all the utensils left after the dinner. Your task is to find the minimum possible number of stolen utensils." 900

1031F "Familiar Operations" "brute force,graphs,math" "You are given two positive integers a and b. There are two possible operations:   multiply one of the numbers by some prime p;  divide one of the numbers on its prime factor p. What is the minimum number of operations required to obtain two integers having the same number of divisors? You are given several such pairs, you need to find the answer for each of them." 2800

1031E "Triple Flips" "constructive algorithms" "You are given an array a of length n that consists of zeros and ones.You can perform the following operation multiple times. The operation consists of two steps:   Choose three integers 1\xe2\x89\xa4x<y<z\xe2\x89\xa4n, that form an arithmetic progression (y\xe2\x88\x92x=z\xe2\x88\x92y).  Flip the values ax,ay,az (i.e. change 1 to 0, change 0 to 1). Determine if it is possible to make all elements of the array equal to zero. If yes, print the operations that lead the the all-zero state. Your solution should not contain more than (\xe2\x8c\x8an3\xe2\x8c\x8b+12) operations. Here \xe2\x8c\x8aq\xe2\x8c\x8b denotes the number q rounded down. We can show that it is possible to make all elements equal to zero in no more than this number of operations whenever it is possible to do so at all." 2600

1031D "Minimum path" greedy "You are given a matrix of size n\xc3\x97n filled with lowercase English letters. You can change no more than k letters in this matrix.Consider all paths from the upper left corner to the lower right corner that move from a cell to its neighboring cell to the right or down. Each path is associated with the string that is formed by all the letters in the cells the path visits. Thus, the length of each string is 2n\xe2\x88\x921.Find the lexicographically smallest string that can be associated with a path after changing letters in at most k cells of the matrix.A string a is lexicographically smaller than a string b, if the first different letter in a and b is smaller in a." 1900

1031C "Cram Time" greedy "In a galaxy far, far away Lesha the student has just got to know that he has an exam in two days. As always, he hasn\'t attended any single class during the previous year, so he decided to spend the remaining time wisely.Lesha knows that today he can study for at most a hours, and he will have b hours to study tomorrow. Note that it is possible that on his planet there are more hours in a day than on Earth. Lesha knows that the quality of his knowledge will only depend on the number of lecture notes he will read. He has access to an infinite number of notes that are enumerated with positive integers, but he knows that he can read the first note in one hour, the second note in two hours and so on. In other words, Lesha can read the note with number k in k hours. Lesha can read the notes in arbitrary order, however, he can\'t start reading a note in the first day and finish its reading in the second day.Thus, the student has to fully read several lecture notes today, spending at most a hours in total, and fully read several lecture notes tomorrow, spending at most b hours in total. What is the maximum number of notes Lesha can read in the remaining time? Which notes should he read in the first day, and which�\xe2\x80\x94 in the second?" 1600

1031B "Curiosity Has No Limits" NA "When Masha came to math classes today, she saw two integer sequences of length n\xe2\x88\x921 on the blackboard. Let\'s denote the elements of the first sequence as ai (0\xe2\x89\xa4ai\xe2\x89\xa43), and the elements of the second sequence as bi (0\xe2\x89\xa4bi\xe2\x89\xa43).Masha became interested if or not there is an integer sequence of length n, which elements we will denote as ti (0\xe2\x89\xa4ti\xe2\x89\xa43), so that for every i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) the following is true:   ai=ti|ti+1 (where | denotes the bitwise OR operation) and  bi=ti&ti+1 (where & denotes the bitwise AND operation). The question appeared to be too difficult for Masha, so now she asked you to check whether such a sequence ti of length n exists. If it exists, find such a sequence. If there are multiple such sequences, find any of them." 1500

1031A "Golden Plate" implementation,math "You have a plate and you want to add some gilding to it. The plate is a rectangle that we split into w\xc3\x97h cells. There should be k gilded rings, the first one should go along the edge of the plate, the second one�\xe2\x80\x94 2 cells away from the edge and so on. Each ring has a width of 1 cell. Formally, the i-th of these rings should consist of all bordering cells on the inner rectangle of size (w\xe2\x88\x924(i\xe2\x88\x921))\xc3\x97(h\xe2\x88\x924(i\xe2\x88\x921)).  The picture corresponds to the third example. Your task is to compute the number of cells to be gilded." 800

1030G "Linear Congruential Generator" "number theory" "You are given a tuple generator f(k)=(f(k)1,f(k)2,\xe2\x80\xa6,f(k)n), where f(k)i=(ai\xe2\x8b\x85f(k\xe2\x88\x921)i+bi)modpi and f(0)=(x1,x2,\xe2\x80\xa6,xn). Here xmody denotes the remainder of x when divided by y. All pi are primes.One can see that with fixed sequences xi, yi, ai the tuples f(k) starting from some index will repeat tuples with smaller indices. Calculate the maximum number of different tuples (from all f(k) for k\xe2\x89\xa50) that can be produced by this generator, if xi, ai, bi are integers in the range [0,pi\xe2\x88\x921] and can be chosen arbitrary. The answer can be large, so print the remainder it gives when divided by 109+7" 2900

1030F "Putting Boxes Together" "data structures" "There is an infinite line consisting of cells. There are n boxes in some cells of this line. The i-th box stands in the cell ai and has weight wi. All ai are distinct, moreover, ai\xe2\x88\x921<ai holds for all valid i.You would like to put together some boxes. Putting together boxes with indices in the segment [l,r] means that you will move some of them in such a way that their positions will form some segment [x,x+(r\xe2\x88\x92l)].In one step you can move any box to a neighboring cell if it isn\'t occupied by another box (i.e. you can choose i and change ai by 1, all positions should remain distinct). You spend wi units of energy moving the box i by one cell. You can move any box any number of times, in arbitrary order.Sometimes weights of some boxes change, so you have queries of two types:   id nw \xe2\x80\x94 weight wid of the box id becomes nw.  l r \xe2\x80\x94 you should compute the minimum total energy needed to put together boxes with indices in [l,r]. Since the answer can be rather big, print the remainder it gives when divided by 1000000007=109+7. Note that the boxes are not moved during the query, you only should compute the answer. Note that you should minimize the answer, not its remainder modulo 109+7. So if you have two possible answers 2\xe2\x8b\x85109+13 and 2\xe2\x8b\x85109+14, you should choose the first one and print 109+6, even though the remainder of the second answer is 0." 2500

1030E "Vasya and Good Sequences" bitmasks,dp "Vasya has a sequence a consisting of n integers a1,a2,\xe2\x80\xa6,an. Vasya may pefrom the following operation: choose some number from the sequence and swap any pair of bits in its binary representation. For example, Vasya can transform number 6 (\xe2\x80\xa6000000001102) into 3 (\xe2\x80\xa6000000000112), 12 (\xe2\x80\xa60000000011002), 1026 (\xe2\x80\xa6100000000102) and many others. Vasya can use this operation any (possibly zero) number of times on any number from the sequence.Vasya names a sequence as good one, if, using operation mentioned above, he can obtain the sequence with bitwise exclusive or of all elements equal to 0.For the given sequence a1,a2,\xe2\x80\xa6,an Vasya\'d like to calculate number of integer pairs (l,r) such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and sequence al,al+1,\xe2\x80\xa6,ar is good." 2000

1030D "Vasya and Triangle" "geometry,number theory" "Vasya has got three integers nn, mm and kk. He\'d like to find three integer points (x1,y1)(x1,y1), (x2,y2)(x2,y2), (x3,y3)(x3,y3), such that 0\xe2\x89\xa4x1,x2,x3\xe2\x89\xa4n0\xe2\x89\xa4x1,x2,x3\xe2\x89\xa4n, 0\xe2\x89\xa4y1,y2,y3\xe2\x89\xa4m0\xe2\x89\xa4y1,y2,y3\xe2\x89\xa4m and the area of the triangle formed by these points is equal to nmknmk.Help Vasya! Find such points (if it\'s possible). If there are multiple solutions, print any of them." 1800

1030C "Vasya and Golden Ticket" implementation "Recently Vasya found a golden ticket \xe2\x80\x94 a sequence which consists of n digits a1a2\xe2\x80\xa6an. Vasya considers a ticket to be lucky if it can be divided into two or more non-intersecting segments with equal sums. For example, ticket 350178 is lucky since it can be divided into three segments 350, 17 and 8: 3+5+0=1+7=8. Note that each digit of sequence should belong to exactly one segment.Help Vasya! Tell him if the golden ticket he found is lucky or not." 1300

1030B "Vasya and Cornfield" geometry "Vasya owns a cornfield which can be defined with two integers nn and dd. The cornfield can be represented as rectangle with vertices having Cartesian coordinates (0,d),(d,0),(n,n\xe2\x88\x92d)(0,d),(d,0),(n,n\xe2\x88\x92d) and (n\xe2\x88\x92d,n)(n\xe2\x88\x92d,n).  An example of a cornfield with n=7n=7 and d=2d=2. Vasya also knows that there are mm grasshoppers near the field (maybe even inside it). The ii-th grasshopper is at the point (xi,yi)(xi,yi). Vasya does not like when grasshoppers eat his corn, so for each grasshopper he wants to know whether its position is inside the cornfield (including the border) or outside.Help Vasya! For each grasshopper determine if it is inside the field (including the border)." 1100

1030A "In Search of an Easy Problem" implementation "When preparing a tournament, Codeforces coordinators try treir best to make the first problem as easy as possible. This time the coordinator had chosen some problem and asked n people about their opinions. Each person answered whether this problem is easy or hard.If at least one of these n people has answered that the problem is hard, the coordinator decides to change the problem. For the given responses, check if the problem is easy enough." 800

1029F "Multicolored Markers" "binary search,brute force,math,number theory" "There is an infinite board of square tiles. Initially all tiles are white.Vova has a red marker and a blue marker. Red marker can color a tiles. Blue marker can color b tiles. If some tile isn\'t white then you can\'t use marker of any color on it. Each marker must be drained completely, so at the end there should be exactly a red tiles and exactly b blue tiles across the board.Vova wants to color such a set of tiles that:  they would form a rectangle, consisting of exactly a+b colored tiles;  all tiles of at least one color would also form a rectangle. Here are some examples of correct colorings:  Here are some examples of incorrect colorings:  Among all correct colorings Vova wants to choose the one with the minimal perimeter. What is the minimal perimeter Vova can obtain?It is guaranteed that there exists at least one correct coloring." 2000

1029E "Tree with Small Distances" dp,graphs,greedy "You are given an undirected tree consisting of nn vertices. An undirected tree is a connected undirected graph with n\xe2\x88\x921n\xe2\x88\x921 edges.Your task is to add the minimum number of edges in such a way that the length of the shortest path from the vertex 11 to any other vertex is at most 22. Note that you are not allowed to add loops and multiple edges." 2100

1029D "Concatenated Multiples" implementation,math "You are given an array a, consisting of n positive integers.Let\'s call a concatenation of numbers x and y the number that is obtained by writing down numbers x and y one right after another without changing the order. For example, a concatenation of numbers 12 and 3456 is a number 123456.Count the number of ordered pairs of positions (i,j) (i\xe2\x89\xa0j) in array a such that the concatenation of ai and aj is divisible by k." 1900

1029C "Maximal Intersection" greedy,math,sortings "You are given n segments on a number line; each endpoint of every segment has integer coordinates. Some segments can degenerate to points. Segments can intersect with each other, be nested in each other or even coincide.The intersection of a sequence of segments is such a maximal set of points (not necesserily having integer coordinates) that each point lies within every segment from the sequence. If the resulting set isn\'t empty, then it always forms some continuous segment. The length of the intersection is the length of the resulting segment or 0 in case the intersection is an empty set.For example, the intersection of segments [1;5] and [3;10] is [3;5] (length 2), the intersection of segments [1;5] and [5;7] is [5;5] (length 0) and the intersection of segments [1;5] and [6;6] is an empty set (length 0).Your task is to remove exactly one segment from the given sequence in such a way that the intersection of the remaining (n\xe2\x88\x921) segments has the maximal possible length." 1600

1029B "Creating the Contest" dp,greedy,math "You are given a problemset consisting of n problems. The difficulty of the i-th problem is ai. It is guaranteed that all difficulties are distinct and are given in the increasing order.You have to assemble the contest which consists of some problems of the given problemset. In other words, the contest you have to assemble should be a subset of problems (not necessary consecutive) of the given problemset. There is only one condition that should be satisfied: for each problem but the hardest one (the problem with the maximum difficulty) there should be a problem with the difficulty greater than the difficulty of this problem but not greater than twice the difficulty of this problem. In other words, let ai1,ai2,\xe2\x80\xa6,aip be the difficulties of the selected problems in increasing order. Then for each j from 1 to p\xe2\x88\x921 aij+1\xe2\x89\xa4aij\xe2\x8b\x852 should hold. It means that the contest consisting of only one problem is always valid.Among all contests satisfying the condition above you have to assemble one with the maximum number of problems. Your task is to find this number of problems." 1200

1029A "Many Equal Substrings" implementation,strings "You are given a string t consisting of n lowercase Latin letters and an integer number k.Let\'s define a substring of some string s with indices from l to r as s[l\xe2\x80\xa6r].Your task is to construct such string s of minimum possible length that there are exactly k positions i such that s[i\xe2\x80\xa6i+n\xe2\x88\x921]=t. In other words, your task is to construct such string s of minimum possible length that there are exactly k substrings of s equal to t.It is guaranteed that the answer is always unique." 1300

1028H "Make Square" math "We call an array b1,b2,\xe2\x80\xa6,bm good, if there exist two indices i<j such that bi\xe2\x8b\x85bj is a perfect square.Given an array b1,b2,\xe2\x80\xa6,bm, in one action you can perform one of the following:   multiply any element bi by any prime p;  divide any element bi by prime p, if bi is divisible by p. Let f(b1,b2,\xe2\x80\xa6,bm) be the minimum number of actions needed to make the array b good.You are given an array of n integers a1,a2,\xe2\x80\xa6,an and q queries of the form li,ri. For each query output f(ali,ali+1,\xe2\x80\xa6,ari)." 2900

1028G "Guess the number" dp,interactive "This problem is interactive.You should guess hidden number x which is between 1 and M=10004205361450474, inclusive.You could use up to 5 queries.In each query, you can output an increasing sequence of k\xe2\x89\xa4x integers, each between 1 and M, inclusive, and you will obtain one of the following as an answer:  either the hidden number belongs to your query sequence, in this case you immediately win;  or you will be given where the hidden number is located with respect to your query sequence, that is, either it is less than all numbers from the sequence, greater than all numbers from the sequence, or you will be given such an i that the hidden number x is between the i-th and the (i+1)-st numbers of your sequence. See the interaction section for clarity.Be aware that the interactor is adaptive, i.e. the hidden number can depend on queries the solution makes. However, it is guaranteed that for any solution the interactor works non-distinguishable from the situation when the hidden number is fixed beforehand.Hacks are allowed only with fixed hidden number. A hack is represented by a single integer between 1 and M. In all pretests the hidden number is fixed as well." 3000

1028F "Make Symmetrical" "brute force" "Consider a set of points AA, initially it is empty. There are three types of queries:   Insert a point (xi,yi)(xi,yi) to AA. It is guaranteed that this point does not belong to AA at this moment.  Remove a point (xi,yi)(xi,yi) from AA. It is guaranteed that this point belongs to AA at this moment.  Given a point (xi,yi)(xi,yi), calculate the minimum number of points required to add to AA to make AA symmetrical with respect to the line containing points (0,0)(0,0) and (xi,yi)(xi,yi). Note that these points are not actually added to AA, i.e. these queries are independent from each other." 2900

1028E "Restore Array" "constructive algorithms" "While discussing a proper problem A for a Codeforces Round, Kostya created a cyclic array of positive integers a1,a2,\xe2\x80\xa6,an. Since the talk was long and not promising, Kostya created a new cyclic array b1,b2,\xe2\x80\xa6,bn so that bi=(aimodai+1), where we take an+1=a1. Here mod is the modulo operation. When the talk became interesting, Kostya completely forgot how array a had looked like. Suddenly, he thought that restoring array a from array b would be an interesting problem (unfortunately, not A)." 2400

1028D "Order book" "combinatorics,data structures,greedy" "Let\'s consider a simplified version of order book of some stock. The order book is a list of orders (offers) from people that want to buy or sell one unit of the stock, each order is described by direction (BUY or SELL) and price.At every moment of time, every SELL offer has higher price than every BUY offer. In this problem no two ever existed orders will have the same price.The lowest-price SELL order and the highest-price BUY order are called the best offers, marked with black frames on the picture below.  The presented order book says that someone wants to sell the product at price 1212 and it\'s the best SELL offer because the other two have higher prices. The best BUY offer has price 1010. There are two possible actions in this orderbook:  Somebody adds a new order of some direction with some price. Somebody accepts the best possible SELL or BUY offer (makes a deal). It\'s impossible to accept not the best SELL or BUY offer (to make a deal at worse price). After someone accepts the offer, it is removed from the orderbook forever.It is allowed to add new BUY order only with prices less than the best SELL offer (if you want to buy stock for higher price, then instead of adding an order you should accept the best SELL offer). Similarly, one couldn\'t add a new SELL order with price less or equal to the best BUY offer. For example, you can\'t add a new offer ""SELL 2020"" if there is already an offer ""BUY 2020"" or ""BUY 2525""�\xe2\x80\x94 in this case you just accept the best BUY offer.You have a damaged order book log (in the beginning the are no orders in book). Every action has one of the two types: ""ADD pp"" denotes adding a new order with price pp and unknown direction. The order must not contradict with orders still not removed from the order book.  ""ACCEPT pp"" denotes accepting an existing best offer with price pp and unknown direction.The directions of all actions are lost. Information from the log isn\'t always enough to determine these directions. Count the number of ways to correctly restore all ADD action directions so that all the described conditions are satisfied at any moment. Since the answer could be large, output it modulo 109+7109+7. If it is impossible to correctly restore directions, then output 00." 2100

1028C Rectangles geometry,implementation,sortings "You are given nn rectangles on a plane with coordinates of their bottom left and upper right points. Some (n\xe2\x88\x921)(n\xe2\x88\x921) of the given nn rectangles have some common point. A point belongs to a rectangle if this point is strictly inside the rectangle or belongs to its boundary.Find any point with integer coordinates that belongs to at least (n\xe2\x88\x921)(n\xe2\x88\x921) given rectangles." 1600

1028B "Unnatural Conditions" "constructive algorithms,math" "Let s(x) be sum of digits in decimal representation of positive integer x. Given two integers n and m, find some positive integers a and b such that   s(a)\xe2\x89\xa5n,  s(b)\xe2\x89\xa5n,  s(a+b)\xe2\x89\xa4m." 1200

1028A "Find Square" implementation "Consider a table of size n\xc3\x97m, initially fully white. Rows are numbered 1 through n from top to bottom, columns 1 through m from left to right. Some square inside the table with odd side length was painted black. Find the center of this square." 800

1027G "X-mouse in the Campus" "bitmasks,math,number theory" "The campus has m rooms numbered from 0 to m\xe2\x88\x921. Also the x-mouse lives in the campus. The x-mouse is not just a mouse: each second x-mouse moves from room i to the room i\xe2\x8b\x85xmodm (in fact, it teleports from one room to another since it doesn\'t visit any intermediate room). Starting position of the x-mouse is unknown.You are responsible to catch the x-mouse in the campus, so you are guessing about minimum possible number of traps (one trap in one room) you need to place. You are sure that if the x-mouse enters a trapped room, it immediately gets caught.And the only observation you made is GCD(x,m)=1." 2600

1027F "Session in BSU" "binary search,dfs and similar,dsu,graph matchings,graphs" "Polycarp studies in Berland State University. Soon he will have to take his exam. He has to pass exactly n exams.For the each exam i there are known two days: ai \xe2\x80\x94 day of the first opportunity to pass the exam, bi \xe2\x80\x94 day of the second opportunity to pass the exam (ai<bi). Polycarp can pass at most one exam during each day. For each exam Polycarp chooses by himself which day he will pass this exam. He has to pass all the n exams.Polycarp wants to pass all the exams as soon as possible. Print the minimum index of day by which Polycarp can pass all the n exams, or print -1 if he cannot pass all the exams at all." 2400

1027E "Inverse Coloring" combinatorics,dp,math "You are given a square board, consisting of n rows and n columns. Each tile in it should be colored either white or black.Let\'s call some coloring beautiful if each pair of adjacent rows are either the same or different in every position. The same condition should be held for the columns as well.Let\'s call some coloring suitable if it is beautiful and there is no rectangle of the single color, consisting of at least k tiles.Your task is to count the number of suitable colorings of the board of the given size.Since the answer can be very large, print it modulo 998244353." 2100

1027D "Mouse Hunt" "dfs and similar,graphs" "Medicine faculty of Berland State University has just finished their admission campaign. As usual, about 80% of applicants are girls and majority of them are going to live in the university dormitory for the next 4 (hopefully) years.The dormitory consists of n rooms and a single mouse! Girls decided to set mouse traps in some rooms to get rid of the horrible monster. Setting a trap in room number i costs ci burles. Rooms are numbered from 1 to n.Mouse doesn\'t sit in place all the time, it constantly runs. If it is in room i in second t then it will run to room ai in second t+1 without visiting any other rooms inbetween (i=ai means that mouse won\'t leave room i). It\'s second 0 in the start. If the mouse is in some room with a mouse trap in it, then the mouse get caught into this trap.That would have been so easy if the girls actually knew where the mouse at. Unfortunately, that\'s not the case, mouse can be in any room from 1 to n at second 0.What it the minimal total amount of burles girls can spend to set the traps in order to guarantee that the mouse will eventually be caught no matter the room it started from?" 1700

1027C "Minimum Value Rectangle" greedy "You have n sticks of the given lengths.Your task is to choose exactly four of them in such a way that they can form a rectangle. No sticks can be cut to pieces, each side of the rectangle must be formed by a single stick. No stick can be chosen multiple times. It is guaranteed that it is always possible to choose such sticks.Let S be the area of the rectangle and P be the perimeter of the rectangle. The chosen rectangle should have the value P2S minimal possible. The value is taken without any rounding.If there are multiple answers, print any of them.Each testcase contains several lists of sticks, for each of them you are required to solve the problem separately." 1600

1027B "Numbers on the Chessboard" implementation,math "You are given a chessboard of size n\xc3\x97nn\xc3\x97n. It is filled with numbers from 11 to n2n2 in the following way: the first \xe2\x8c\x88n22\xe2\x8c\x89\xe2\x8c\x88n22\xe2\x8c\x89 numbers from 11 to \xe2\x8c\x88n22\xe2\x8c\x89\xe2\x8c\x88n22\xe2\x8c\x89 are written in the cells with even sum of coordinates from left to right from top to bottom. The rest n2\xe2\x88\x92\xe2\x8c\x88n22\xe2\x8c\x89n2\xe2\x88\x92\xe2\x8c\x88n22\xe2\x8c\x89 numbers from \xe2\x8c\x88n22\xe2\x8c\x89+1\xe2\x8c\x88n22\xe2\x8c\x89+1 to n2n2 are written in the cells with odd sum of coordinates from left to right from top to bottom. The operation \xe2\x8c\x88xy\xe2\x8c\x89\xe2\x8c\x88xy\xe2\x8c\x89 means division xx by yy rounded up.For example, the left board on the following picture is the chessboard which is given for n=4n=4 and the right board is the chessboard which is given for n=5n=5.  You are given qq queries. The ii-th query is described as a pair xi,yixi,yi. The answer to the ii-th query is the number written in the cell xi,yixi,yi (xixi is the row, yiyi is the column). Rows and columns are numbered from 11 to nn." 1200

1027A "Palindromic Twist" implementation,strings "You are given a string s consisting of n lowercase Latin letters. n is even.For each position i (1\xe2\x89\xa4i\xe2\x89\xa4n) in string s you are required to change the letter on this position either to the previous letter in alphabetic order or to the next one (letters \'a\' and \'z\' have only one of these options). Letter in every position must be changed exactly once.For example, letter \'p\' should be changed either to \'o\' or to \'q\', letter \'a\' should be changed to \'b\' and letter \'z\' should be changed to \'y\'.That way string ""codeforces"", for example, can be changed to ""dpedepqbft"" (\'c\' \xe2\x86\x92 \'d\', \'o\' \xe2\x86\x92 \'p\', \'d\' \xe2\x86\x92 \'e\', \'e\' \xe2\x86\x92 \'d\', \'f\' \xe2\x86\x92 \'e\', \'o\' \xe2\x86\x92 \'p\', \'r\' \xe2\x86\x92 \'q\', \'c\' \xe2\x86\x92 \'b\', \'e\' \xe2\x86\x92 \'f\', \'s\' \xe2\x86\x92 \'t\').String s is called a palindrome if it reads the same from left to right and from right to left. For example, strings ""abba"" and ""zz"" are palindromes and strings ""abca"" and ""zy"" are not.Your goal is to check if it\'s possible to make string s a palindrome by applying the aforementioned changes to every position. Print ""YES"" if string s can be transformed to a palindrome and ""NO"" otherwise.Each testcase contains several strings, for each of them you are required to solve the problem separately." 1000

1025G "Company Acquisitions" "constructive algorithms,math" "There are nn startups. Startups can be active or acquired. If a startup is acquired, then that means it has exactly one active startup that it is following. An active startup can have arbitrarily many acquired startups that are following it. An active startup cannot follow any other startup.The following steps happen until there is exactly one active startup. The following sequence of steps takes exactly 1 day.  Two distinct active startups AA, BB, are chosen uniformly at random.  A fair coin is flipped, and with equal probability, AA acquires BB or BB acquires AA (i.e. if AA acquires BB, then that means BB\'s state changes from active to acquired, and its starts following AA).  When a startup changes from active to acquired, all of its previously acquired startups become active. For example, the following scenario can happen: Let\'s say AA, BB are active startups. CC, DD, EE are acquired startups under AA, and FF, GG are acquired startups under BB: Active startups are shown in red. If AA acquires BB, then the state will be AA, FF, GG are active startups. CC, DD, EE, BB are acquired startups under AA. FF and GG have no acquired startups:  If instead, BB acquires AA, then the state will be BB, CC, DD, EE are active startups. FF, GG, AA are acquired startups under BB. CC, DD, EE have no acquired startups:  You are given the initial state of the startups. For each startup, you are told if it is either acquired or active. If it is acquired, you are also given the index of the active startup that it is following.You\'re now wondering, what is the expected number of days needed for this process to finish with exactly one active startup at the end.It can be shown the expected number of days can be written as a rational number P/QP/Q, where PP and QQ are co-prime integers, and Q\xe2\x89\xa00(mod109+7)Q\xe2\x89\xa00(mod109+7). Return the value of P\xe2\x8b\x85Q\xe2\x88\x921P\xe2\x8b\x85Q\xe2\x88\x921 modulo 109+7109+7." 3200

1025F "Disjoint Triangles" geometry "A point belongs to a triangle if it lies inside the triangle or on one of its sides. Two triangles are disjoint if there is no point on the plane that belongs to both triangles.You are given n points on the plane. No two points coincide and no three points are collinear.Find the number of different ways to choose two disjoint triangles with vertices in the given points. Two ways which differ only in order of triangles or in order of vertices inside triangles are considered equal." 2700

1025E "Colored Cubes" "constructive algorithms,implementation,matrices" "Vasya passes all exams! Despite expectations, Vasya is not tired, moreover, he is ready for new challenges. However, he does not want to work too hard on difficult problems.Vasya remembered that he has a not-so-hard puzzle: mm colored cubes are placed on a chessboard of size n\xc3\x97nn\xc3\x97n. The fact is that m\xe2\x89\xa4nm\xe2\x89\xa4n and all cubes have distinct colors. Each cube occupies exactly one cell. Also, there is a designated cell for each cube on the board, the puzzle is to place each cube on its place. The cubes are fragile, so in one operation you only can move one cube onto one of four neighboring by side cells, if only it is empty. Vasya wants to be careful, so each operation takes exactly one second. Vasya used to train hard for VK Cup Final, so he can focus his attention on the puzzle for at most 33 hours, that is 1080010800 seconds. Help Vasya find such a sequence of operations that all cubes will be moved onto their designated places, and Vasya won\'t lose his attention." 2700

1025D "Recovering BST" "brute force,dp,math,number theory,trees" "Dima the hamster enjoys nibbling different things: cages, sticks, bad problemsetters and even trees!Recently he found a binary search tree and instinctively nibbled all of its edges, hence messing up the vertices. Dima knows that if Andrew, who has been thoroughly assembling the tree for a long time, comes home and sees his creation demolished, he\'ll get extremely upset. To not let that happen, Dima has to recover the binary search tree. Luckily, he noticed that any two vertices connected by a direct edge had their greatest common divisor value exceed 11.Help Dima construct such a binary search tree or determine that it\'s impossible. The definition and properties of a binary search tree can be found here." 2100

1025C "Plasticine zebra" "constructive algorithms,implementation" "Is there anything better than going to the zoo after a tiresome week at work? No wonder Grisha feels the same while spending the entire weekend accompanied by pretty striped zebras. Inspired by this adventure and an accidentally found plasticine pack (represented as a sequence of black and white stripes), Grisha now wants to select several consequent (contiguous) pieces of alternating colors to create a zebra. Let\'s call the number of selected pieces the length of the zebra.Before assembling the zebra Grisha can make the following operation 0 or more times. He splits the sequence in some place into two parts, then reverses each of them and sticks them together again. For example, if Grisha has pieces in the order ""bwbbw"" (here \'b\' denotes a black strip, and \'w\' denotes a white strip), then he can split the sequence as bw|bbw (here the vertical bar represents the cut), reverse both parts and obtain ""wbwbb"".Determine the maximum possible length of the zebra that Grisha can produce." 1600

1025B "Weakened Common Divisor" "brute force,greedy,number theory" "During the research on properties of the greatest common divisor (GCD) of a set of numbers, Ildar, a famous mathematician, introduced a brand new concept of the weakened common divisor (WCD) of a list of pairs of integers.For a given list of pairs of integers (a1,b1), (a2,b2), ..., (an,bn) their WCD is arbitrary integer greater than 1, such that it divides at least one element in each pair. WCD may not exist for some lists.For example, if the list looks like [(12,15),(25,18),(10,24)], then their WCD can be equal to 2, 3, 5 or 6 (each of these numbers is strictly greater than 1 and divides at least one number in each pair).You\'re currently pursuing your PhD degree under Ildar\'s mentorship, and that\'s why this problem was delegated to you. Your task is to calculate WCD efficiently." 1600

1025A "Doggo Recoloring" implementation,sortings "Panic is rising in the committee for doggo standardization�\xe2\x80\x94 the puppies of the new brood have been born multi-colored! In total there are 26 possible colors of puppies in the nature and they are denoted by letters from \'a\' to \'z\' inclusive.The committee rules strictly prohibit even the smallest diversity between doggos and hence all the puppies should be of the same color. Thus Slava, the committee employee, has been assigned the task to recolor some puppies into other colors in order to eliminate the difference and make all the puppies have one common color.Unfortunately, due to bureaucratic reasons and restricted budget, there\'s only one operation Slava can perform: he can choose a color x such that there are currently at least two puppies of color x and recolor all puppies of the color x into some arbitrary color y. Luckily, this operation can be applied multiple times (including zero).For example, if the number of puppies is 7 and their colors are represented as the string ""abababc"", then in one operation Slava can get the results ""zbzbzbc"", ""bbbbbbc"", ""aaaaaac"", ""acacacc"" and others. However, if the current color sequence is ""abababc"", then he can\'t choose x=\'c\' right now, because currently only one puppy has the color \'c\'.Help Slava and the committee determine whether it is possible to standardize all the puppies, i.e. after Slava\'s operations all the puppies should have the same color." 900

1023G Pisces "data structures,flows,trees" "A group of researchers are studying fish population in a natural system of lakes and rivers. The system contains nn lakes connected by n\xe2\x88\x921n\xe2\x88\x921 rivers. Each river has integer length (in kilometers) and can be traversed in both directions. It is possible to travel between any pair of lakes by traversing the rivers (that is, the network of lakes and rivers form a tree).There is an unknown number of indistinguishable fish living in the lakes. On day 11, fish can be at arbitrary lakes. Fish can travel between lakes by swimming the rivers. Each fish can swim a river ll kilometers long in any direction in ll days. Further, each fish can stay any number of days in any particular lake it visits. No fish ever appear or disappear from the lake system. Each lake can accomodate any number of fish at any time.The researchers made several observations. The jj-th of these observations is ""on day djdj there were at least fjfj distinct fish in the lake pjpj"". Help the researchers in determining the smallest possible total number of fish living in the lake system that doesn\'t contradict the observations." 3400

1023F "Mobile Phone Network" "dfs and similar,dsu,graphs,trees" "You are managing a mobile phone network, and want to offer competitive prices to connect a network.The network has n nodes.Your competitor has already offered some connections between some nodes, with some fixed prices. These connections are bidirectional. There are initially m connections the competitor is offering. The i-th connection your competitor is offering will connect nodes fai and fbi and costs fwi. You have a list of k connections that you want to offer. It is guaranteed that this set of connection does not form any cycle. The j-th of these connections will connect nodes gaj and gbj. These connections are also bidirectional. The cost of these connections have not been decided yet.You can set the prices of these connections to any arbitrary integer value. These prices are set independently for each connection. After setting the prices, the customer will choose such n\xe2\x88\x921 connections that all nodes are connected in a single network and the total cost of chosen connections is minimum possible. If there are multiple ways to choose such networks, the customer will choose an arbitrary one that also maximizes the number of your connections in it.You want to set prices in such a way such that all your k connections are chosen by the customer, and the sum of prices of your connections is maximized.Print the maximum profit you can achieve, or \xe2\x88\x921 if it is unbounded." 2600

1023E "Down or Right" "constructive algorithms,interactive,matrices" "This is an interactive problem.Bob lives in a square grid of size n\xc3\x97n, with rows numbered 1 through n from top to bottom, and columns numbered 1 through n from left to right. Every cell is either allowed or blocked, but you don\'t know the exact description of the grid. You are given only an integer n.Bob can move through allowed cells but only in some limited directions. When Bob is in an allowed cell in the grid, he can move down or right to an adjacent cell, if it is allowed.You can ask at most 4\xe2\x8b\x85n queries of form ""? r1 c1 r2 c2"" (1\xe2\x89\xa4r1\xe2\x89\xa4r2\xe2\x89\xa4n, 1\xe2\x89\xa4c1\xe2\x89\xa4c2\xe2\x89\xa4n). The answer will be ""YES"" if Bob can get from a cell (r1,c1) to a cell (r2,c2), and ""NO"" otherwise. In particular, if one of the two cells (or both) is a blocked cell then the answer is ""NO"" for sure. Since Bob doesn\'t like short trips, you can only ask queries with the manhattan distance between the two cells at least n\xe2\x88\x921, i.e. the following condition must be satisfied: (r2\xe2\x88\x92r1)+(c2\xe2\x88\x92c1)\xe2\x89\xa5n\xe2\x88\x921.It\'s guaranteed that Bob can get from the top-left corner (1,1) to the bottom-right corner (n,n) and your task is to find a way to do it. You should print the answer in form ""! S"" where S is a string of length 2\xe2\x8b\x85n\xe2\x88\x922 consisting of characters \'D\' and \'R\', denoting moves down and right respectively. The down move increases the first coordinate by 1, the right move increases the second coordinate by 1. If there are multiple solutions, any of them will be accepted. You should terminate immediately after printing the solution." 2100

1023D "Array Restoration" "constructive algorithms,data structures" "Initially there was an array a consisting of n integers. Positions in it are numbered from 1 to n.Exactly q queries were performed on the array. During the i-th query some segment (li,ri) (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n) was selected and values of elements on positions from li to ri inclusive got changed to i. The order of the queries couldn\'t be changed and all q queries were applied. It is also known that every position from 1 to n got covered by at least one segment.We could have offered you the problem about checking if some given array (consisting of n integers with values from 1 to q) can be obtained by the aforementioned queries. However, we decided that it will come too easy for you.So the enhancement we introduced to it is the following. Some set of positions (possibly empty) in this array is selected and values of elements on these positions are set to 0.Your task is to check if this array can be obtained by the aforementioned queries. Also if it can be obtained then restore this array.If there are multiple possible arrays then print any of them." 1700

1023C "Bracket Subsequence" greedy "A bracket sequence is a string containing only characters ""("" and "")"". A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)""), and "")("", ""("" and "")"" are not.Subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements.You are given a regular bracket sequence s and an integer number k. Your task is to find a regular bracket sequence of length exactly k such that it is also a subsequence of s.It is guaranteed that such sequence always exists." 1200

1023B "Pair of Toys" math "Tanechka is shopping in the toy shop. There are exactly n toys in the shop for sale, the cost of the i-th toy is i burles. She wants to choose two toys in such a way that their total cost is k burles. How many ways to do that does she have?Each toy appears in the shop exactly once. Pairs (a,b) and (b,a) are considered equal. Pairs (a,b), where a=b, are not allowed." 1000

1023A "Single Wildcard Pattern Matching" "brute force,implementation,strings" "You are given two strings s and t. The string s consists of lowercase Latin letters and at most one wildcard character \'*\', the string t consists only of lowercase Latin letters. The length of the string s equals n, the length of the string t equals m.The wildcard character \'*\' in the string s (if any) can be replaced with an arbitrary sequence (possibly empty) of lowercase Latin letters. No other character of s can be replaced with anything. If it is possible to replace a wildcard character \'*\' in s to obtain a string t, then the string t matches the pattern s.For example, if s=""aba*aba"" then the following strings match it ""abaaba"", ""abacaba"" and ""abazzzaba"", but the following strings do not match: ""ababa"", ""abcaaba"", ""codeforces"", ""aba1aba"", ""aba?aba"".If the given string t matches the given string s, print ""YES"", otherwise print ""NO""." 1200

1020B Badge "brute force,dfs and similar,graphs" "In Summer Informatics School, if a student doesn\'t behave well, teachers make a hole in his badge. And today one of the teachers caught a group of nn students doing yet another trick. Let\'s assume that all these students are numbered from 11 to nn. The teacher came to student aa and put a hole in his badge. The student, however, claimed that the main culprit is some other student papa.After that, the teacher came to student papa and made a hole in his badge as well. The student in reply said that the main culprit was student ppappa.This process went on for a while, but, since the number of students was finite, eventually the teacher came to the student, who already had a hole in his badge.After that, the teacher put a second hole in the student\'s badge and decided that he is done with this process, and went to the sauna.You don\'t know the first student who was caught by the teacher. However, you know all the numbers pipi. Your task is to find out for every student aa, who would be the student with two holes in the badge if the first caught student was aa." 1000

1020A "New Building for SIS" math "You are looking at the floor plan of the Summer Informatics School\'s new building. You were tasked with SIS logistics, so you really care about travel time between different locations: it is important to know how long it would take to get from the lecture room to the canteen, or from the gym to the server room.The building consists of n towers, h floors each, where the towers are labeled from 1 to n, the floors are labeled from 1 to h. There is a passage between any two adjacent towers (two towers i and i\xe2\x80\x89+\xe2\x80\x891 for all i: 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) on every floor x, where a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b. It takes exactly one minute to walk between any two adjacent floors of a tower, as well as between any two adjacent towers, provided that there is a passage on that floor. It is not permitted to leave the building. The picture illustrates the first example. You have given k pairs of locations (ta,\xe2\x80\x89fa), (tb,\xe2\x80\x89fb): floor fa of tower ta and floor fb of tower tb. For each pair you need to determine the minimum walking time between these locations." 1000

1019E "Raining season" "data structures,divide and conquer,trees" "By the year 3018, Summer Informatics School has greatly grown. Hotel \xc2\xabBerendeetronik\xc2\xbb has been chosen as a location of the school. The camp consists of n houses with n\xe2\x88\x921 pathways between them. It is possible to reach every house from each other using the pathways.Everything had been perfect until the rains started. The weather forecast promises that rains will continue for m days. A special squad of teachers was able to measure that the i-th pathway, connecting houses ui and vi, before the rain could be passed in bi seconds. Unfortunately, the rain erodes the roads, so with every day the time to pass the road will increase by ai seconds. In other words, on the t-th (from zero) day after the start of the rain, it will take ai\xe2\x8b\x85t+bi seconds to pass through this road.Unfortunately, despite all the efforts of teachers, even in the year 3018 not all the students are in their houses by midnight. As by midnight all students have to go to bed, it is important to find the maximal time between all the pairs of houses for each day, so every student would know the time when he has to run to his house.Find all the maximal times of paths between every pairs of houses after t=0, t=1, ..., t=m\xe2\x88\x921 days." 3200

1019D "Large Triangle" "binary search,geometry,sortings" "There is a strange peculiarity: if you connect the cities of Rostov, Taganrog and Shakhty, peculiarly, you get a triangle\xc2\xabUnbelievable But True\xc2\xbbStudents from many different parts of Russia and abroad come to Summer Informatics School. You marked the hometowns of the SIS participants on a map.Now you decided to prepare an interesting infographic based on this map. The first thing you chose to do is to find three cities on this map, such that they form a triangle with area S." 2700

1019C "Sergey\'s problem" "constructive algorithms,graphs" "There is a strange peculiarity: if you connect the cities of Rostov, Taganrog and Shakhty, peculiarly, you get a triangle\xc2\xabUnbelievable But True\xc2\xbbStudents from many different parts of Russia and abroad come to Summer Informatics School. You marked the hometowns of the SIS participants on a map.Now you decided to prepare an interesting infographic based on this map. The first thing you chose to do is to find three cities on this map, such that they form a triangle with area S." 3000

1019B "The hat" "binary search,interactive" "This is an interactive problem.Imur Ishakov decided to organize a club for people who love to play the famous game \xc2\xabThe hat\xc2\xbb. The club was visited by n students, where n is even. Imur arranged them all in a circle and held a draw to break the students in pairs, but something went wrong. The participants are numbered so that participant i and participant i\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) are adjacent, as well as participant n and participant 1. Each student was given a piece of paper with a number in such a way, that for every two adjacent students, these numbers differ exactly by one. The plan was to form students with the same numbers in a pair, but it turned out that not all numbers appeared exactly twice.As you know, the most convenient is to explain the words to the partner when he is sitting exactly across you. Students with numbers i and  sit across each other. Imur is wondering if there are two people sitting across each other with the same numbers given. Help him to find such pair of people if it exists.You can ask questions of form \xc2\xabwhich number was received by student i?\xc2\xbb, and the goal is to determine whether the desired pair exists in no more than 60 questions." 2000

1019A Elections "brute force,greedy" "As you know, majority of students and teachers of Summer Informatics School live in Berland for the most part of the year. Since corruption there is quite widespread, the following story is not uncommon.Elections are coming. You know the number of voters and the number of parties�\xe2\x80\x94 n and m respectively. For each voter you know the party he is going to vote for. However, he can easily change his vote given a certain amount of money. In particular, if you give i-th voter ci bytecoins you can ask him to vote for any other party you choose.The United Party of Berland has decided to perform a statistical study�\xe2\x80\x94 you need to calculate the minimum number of bytecoins the Party needs to spend to ensure its victory. In order for a party to win the elections, it needs to receive strictly more votes than any other party." 1700

1017H "The Films" "brute force" "In ""The Man in the High Castle"" world, there are m different film endings. Abendsen owns a storage and a shelf. At first, he has n ordered films on the shelf. In the i-th month he will do: Empty the storage. Put ki\xe2\x8b\x85m films into the storage, ki films for each ending. He will think about a question: if he puts all the films from the shelf into the storage, then randomly picks n films (from all the films in the storage) and rearranges them on the shelf, what is the probability that sequence of endings in [li,ri] on the shelf will not be changed? Notice, he just thinks about this question, so the shelf will not actually be changed.Answer all Abendsen\'s questions.Let the probability be fraction Pi. Let\'s say that the total number of ways to take n films from the storage for i-th month is Ai, so Pi\xe2\x8b\x85Ai is always an integer. Print for each month Pi\xe2\x8b\x85Ai(mod998244353).998244353 is a prime number and it is equal to 119\xe2\x8b\x85223+1.It is guaranteed that there will be only no more than 100 different k values." 3300

1017G "The Tree" "data structures" "Abendsen assigned a mission to Juliana. In this mission, Juliana has a rooted tree with nn vertices. Vertex number 11 is the root of this tree. Each vertex can be either black or white. At first, all vertices are white. Juliana is asked to process qq queries. Each query is one of three types:  If vertex vv is white, mark it as black; otherwise, perform this operation on all direct sons of vv instead.  Mark all vertices in the subtree of vv (including vv) as white.  Find the color of the ii-th vertex.   An example of operation ""1 1"" (corresponds to the first example test). The vertices 11 and 22 are already black, so the operation goes to their sons instead. Can you help Juliana to process all these queries?" 3200

1017F "The Neutral Zone" "brute force,math" "Notice: unusual memory limit!After the war, destroyed cities in the neutral zone were restored. And children went back to school.The war changed the world, as well as education. In those hard days, a new math concept was created.As we all know, logarithm function can be described as: log(pa11pa22...pa2k)=a1logp1+a2logp2+...+aklogpk Where pa11pa22...pa2k is the prime factorization of a integer. A problem is that the function uses itself in the definition. That is why it is hard to calculate.So, the mathematicians from the neutral zone invented this: exlogf(pa11pa22...pa2k)=a1f(p1)+a2f(p2)+...+akf(pk)Notice that exlogf(1) is always equal to 0.This concept for any function f was too hard for children. So teachers told them that f can only be a polynomial of degree no more than 3 in daily uses (i.e., f(x)=Ax3+Bx2+Cx+D).""Class is over! Don\'t forget to do your homework!"" Here it is: n\xe2\x88\x91i=1exlogf(i)Help children to do their homework. Since the value can be very big, you need to find the answer modulo 232." 2500

1017E "The Supersonic Rocket" geometry,hashing,strings "After the war, the supersonic rocket became the most common public transportation.Each supersonic rocket consists of two ""engines"". Each engine is a set of ""power sources"". The first engine has nn power sources, and the second one has mm power sources. A power source can be described as a point (xi,yi)(xi,yi) on a 2-D plane. All points in each engine are different.You can manipulate each engine separately. There are two operations that you can do with each engine. You can do each operation as many times as you want. For every power source as a whole in that engine: (xi,yi)(xi,yi) becomes (xi+a,yi+b)(xi+a,yi+b), aa and bb can be any real numbers. In other words, all power sources will be shifted. For every power source as a whole in that engine: (xi,yi)(xi,yi) becomes (xicos\xce\xb8\xe2\x88\x92yisin\xce\xb8,xisin\xce\xb8+yicos\xce\xb8)(xicos\xe2\x81\xa1\xce\xb8\xe2\x88\x92yisin\xe2\x81\xa1\xce\xb8,xisin\xe2\x81\xa1\xce\xb8+yicos\xe2\x81\xa1\xce\xb8), \xce\xb8\xce\xb8 can be any real number. In other words, all power sources will be rotated.The engines work as follows: after the two engines are powered, their power sources are being combined (here power sources of different engines may coincide). If two power sources A(xa,ya)A(xa,ya) and B(xb,yb)B(xb,yb) exist, then for all real number kk that 0<k<10<k<1, a new power source will be created Ck(kxa+(1\xe2\x88\x92k)xb,kya+(1\xe2\x88\x92k)yb)Ck(kxa+(1\xe2\x88\x92k)xb,kya+(1\xe2\x88\x92k)yb). Then, this procedure will be repeated again with all new and old power sources. After that, the ""power field"" from all power sources will be generated (can be considered as an infinite set of all power sources occurred).A supersonic rocket is ""safe"" if and only if after you manipulate the engines, destroying any power source and then power the engine, the power field generated won\'t be changed (comparing to the situation where no power source erased). Two power fields are considered the same if and only if any power source in one field belongs to the other one as well.Given a supersonic rocket, check whether it is safe or not." 2400

1017D "The Wu" "bitmasks,brute force,data structures" "Childan is making up a legendary story and trying to sell his forgery�\xe2\x80\x94 a necklace with a strong sense of ""Wu"" to the Kasouras. But Mr. Kasoura is challenging the truth of Childan\'s story. So he is going to ask a few questions about Childan\'s so-called ""personal treasure"" necklace.This ""personal treasure"" is a multiset S of m ""01-strings"".A ""01-string"" is a string that contains n characters ""0"" and ""1"". For example, if n=4, strings ""0110"", ""0000"", and ""1110"" are ""01-strings"", but ""00110"" (there are 5 characters, not 4) and ""zero"" (unallowed characters) are not.Note that the multiset S can contain equal elements.Frequently, Mr. Kasoura will provide a ""01-string"" t and ask Childan how many strings s are in the multiset S such that the ""Wu"" value of the pair (s,t) is not greater than k. Mrs. Kasoura and Mr. Kasoura think that if si=ti (1\xe2\x89\xa4i\xe2\x89\xa4n) then the ""Wu"" value of the character pair equals to wi, otherwise 0. The ""Wu"" value of the ""01-string"" pair is the sum of the ""Wu"" values of every character pair. Note that the length of every ""01-string"" is equal to n.For example, if w=[4,5,3,6], ""Wu"" of (""1001"", ""1100"") is 7 because these strings have equal characters only on the first and third positions, so w1+w3=4+3=7.You need to help Childan to answer Mr. Kasoura\'s queries. That is to find the number of strings in the multiset S such that the ""Wu"" value of the pair is not greater than k." 1900

1017C "The Phone Number" "constructive algorithms,greedy" "Mrs. Smith is trying to contact her husband, John Smith, but she forgot the secret phone number!The only thing Mrs. Smith remembered was that any permutation of n can be a secret phone number. Only those permutations that minimize secret value might be the phone of her husband.The sequence of n integers is called a permutation if it contains all integers from 1 to n exactly once.The secret value of a phone number is defined as the sum of the length of the longest increasing subsequence (LIS) and length of the longest decreasing subsequence (LDS). A subsequence ai1,ai2,\xe2\x80\xa6,aik where 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n is called increasing if ai1<ai2<ai3<\xe2\x80\xa6<aik. If ai1>ai2>ai3>\xe2\x80\xa6>aik, a subsequence is called decreasing. An increasing/decreasing subsequence is called longest if it has maximum length among all increasing/decreasing subsequences.For example, if there is a permutation [6,4,1,7,2,3,5], LIS of this permutation will be [1,2,3,5], so the length of LIS is equal to 4. LDS can be [6,4,1], [6,4,2], or [6,4,3], so the length of LDS is 3.Note, the lengths of LIS and LDS can be different.So please help Mrs. Smith to find a permutation that gives a minimum sum of lengths of LIS and LDS." 1600

1017B "The Bits" implementation,math "Rudolf is on his way to the castle. Before getting into the castle, the security staff asked him a question:Given two binary numbers a and b of length n. How many different ways of swapping two digits in a (only in a, not b) so that bitwise OR of these two numbers will be changed? In other words, let c be the bitwise OR of a and b, you need to find the number of ways of swapping two bits in a so that bitwise OR will not be equal to c.Note that binary numbers can contain leading zeros so that length of each number is exactly n.Bitwise OR is a binary operation. A result is a binary number which contains a one in each digit if there is a one in at least one of the two numbers. For example, 010102 OR 100112 = 110112.Well, to your surprise, you are not Rudolf, and you don\'t need to help him\xe2\x80\xa6 You are the security staff! Please find the number of ways of swapping two bits in a so that bitwise OR will be changed." 1200

1017A "The Rank" implementation "John Smith knows that his son, Thomas Smith, is among the best students in his class and even in his school. After the students of the school took the exams in English, German, Math, and History, a table of results was formed.There are n students, each of them has a unique id (from 1 to n). Thomas\'s id is 1. Every student has four scores correspond to his or her English, German, Math, and History scores. The students are given in order of increasing of their ids.In the table, the students will be sorted by decreasing the sum of their scores. So, a student with the largest sum will get the first place. If two or more students have the same sum, these students will be sorted by increasing their ids. Please help John find out the rank of his son." 800

1016G "Appropriate Team" "bitmasks,math,number theory" "Since next season are coming, you\'d like to form a team from two or three participants. There are n candidates, the i-th candidate has rank ai. But you have weird requirements for your teammates: if you have rank v and have chosen the i-th and j-th candidate, then GCD(v,ai)=X and LCM(v,aj)=Y must be met.You are very experienced, so you can change your rank to any non-negative integer but X and Y are tied with your birthdate, so they are fixed.Now you want to know, how many are there pairs (i,j) such that there exists an integer v meeting the following constraints: GCD(v,ai)=X and LCM(v,aj)=Y. It\'s possible that i=j and you form a team of two.GCD is the greatest common divisor of two number, LCM \xe2\x80\x94 the least common multiple." 2700

1016F "Road Projects" "dfs and similar,dp,trees" "There are nn cities in the country of Berland. Some of them are connected by bidirectional roads in such a way that there exists exactly one path, which visits each road no more than once, between every pair of cities. Each road has its own length. Cities are numbered from 11 to nn.The travelling time between some cities vv and uu is the total length of the roads on the shortest path from vv to uu. The two most important cities in Berland are cities 11 and nn.The Berland Ministry of Transport decided to build a single new road to decrease the traffic between the most important cities. However, lots of people are used to the current travelling time between the most important cities, so the new road shouldn\'t change it too much. The new road can only be built between such cities vv and uu that v\xe2\x89\xa0uv\xe2\x89\xa0u and vv and uu aren\'t already connected by some road.They came up with mm possible projects. Each project is just the length xx of the new road.Polycarp works as a head analyst at the Berland Ministry of Transport and it\'s his job to deal with all those mm projects. For the ii-th project he is required to choose some cities vv and uu to build the new road of length xixi between such that the travelling time between the most important cities is maximal possible. Unfortunately, Polycarp is not a programmer and no analyst in the world is capable to process all projects using only pen and paper. Thus, he asks you to help him to calculate the maximal possible travelling time between the most important cities for each project. Note that the choice of vv and uu can differ for different projects." 2600

1016E "Rest In The Shades" "binary search,geometry" "There is a light source on the plane. This source is so small that it can be represented as point. The light source is moving from point (a,sy)(a,sy) to the (b,sy)(b,sy) (sy<0)(sy<0) with speed equal to 11 unit per second. The trajectory of this light source is a straight segment connecting these two points. There is also a fence on OXOX axis represented as nn segments (li,ri)(li,ri) (so the actual coordinates of endpoints of each segment are (li,0)(li,0) and (ri,0)(ri,0)). The point (x,y)(x,y) is in the shade if segment connecting (x,y)(x,y) and the current position of the light source intersects or touches with any segment of the fence.  You are given qq points. For each point calculate total time of this point being in the shade, while the light source is moving from (a,sy)(a,sy) to the (b,sy)(b,sy)." 2400

1016D "Vasya And The Matrix" "constructive algorithms,flows,math" "Now Vasya is taking an exam in mathematics. In order to get a good mark, Vasya needs to guess the matrix that the teacher has constructed!Vasya knows that the matrix consists of n rows and m columns. For each row, he knows the xor (bitwise excluding or) of the elements in this row. The sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an denotes the xor of elements in rows with indices 1, 2, ..., n, respectively. Similarly, for each column, he knows the xor of the elements in this column. The sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm denotes the xor of elements in columns with indices 1, 2, ..., m, respectively.Help Vasya! Find a matrix satisfying the given constraints or tell him that there is no suitable matrix." 1800

1016C "Vasya And The Mushrooms" dp,implementation "Vasya\'s house is situated in a forest, and there is a mushroom glade near it. The glade consists of two rows, each of which can be divided into n consecutive cells. For each cell Vasya knows how fast the mushrooms grow in this cell (more formally, how many grams of mushrooms grow in this cell each minute). Vasya spends exactly one minute to move to some adjacent cell. Vasya cannot leave the glade. Two cells are considered adjacent if they share a common side. When Vasya enters some cell, he instantly collects all the mushrooms growing there.Vasya begins his journey in the left upper cell. Every minute Vasya must move to some adjacent cell, he cannot wait for the mushrooms to grow. He wants to visit all the cells exactly once and maximize the total weight of the collected mushrooms. Initially, all mushrooms have a weight of 0. Note that Vasya doesn\'t need to return to the starting cell.Help Vasya! Calculate the maximum total weight of mushrooms he can collect." 1800

1016B "Segment Occurrences" "brute force,implementation" "You are given two strings s and t, both consisting only of lowercase Latin letters.The substring s[l..r] is the string which is obtained by taking characters sl,sl+1,\xe2\x80\xa6,sr without changing the order.Each of the occurrences of string a in a string b is a position i (1\xe2\x89\xa4i\xe2\x89\xa4|b|\xe2\x88\x92|a|+1) such that b[i..i+|a|\xe2\x88\x921]=a (|a| is the length of string a).You are asked q queries: for the i-th query you are required to calculate the number of occurrences of string t in a substring s[li..ri]." 1300

1016A "Death Note" greedy,implementation,math "You received a notebook which is called Death Note. This notebook has infinite number of pages. A rule is written on the last page (huh) of this notebook. It says: ""You have to write names in this notebook during n consecutive days. During the i-th day you have to write exactly ai names."". You got scared (of course you got scared, who wouldn\'t get scared if he just receive a notebook which is named Death Note with a some strange rule written in it?).Of course, you decided to follow this rule. When you calmed down, you came up with a strategy how you will write names in the notebook. You have calculated that each page of the notebook can contain exactly m names. You will start writing names from the first page. You will write names on the current page as long as the limit on the number of names on this page is not exceeded. When the current page is over, you turn the page. Note that you always turn the page when it ends, it doesn\'t matter if it is the last day or not. If after some day the current page still can hold at least one name, during the next day you will continue writing the names from the current page.Now you are interested in the following question: how many times will you turn the page during each day? You are interested in the number of pages you will turn each day from 1 to n." 900

1015F "Bracket Substring" dp,strings "You are given a bracket sequence s (not necessarily a regular one). A bracket sequence is a string containing only characters \'(\' and \')\'.A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters \'1\' and \'+\' between the original characters of the sequence. For example, bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)""), and "")("", ""("" and "")"" are not.Your problem is to calculate the number of regular bracket sequences of length 2n containing the given bracket sequence s as a substring (consecutive sequence of characters) modulo 109+7 (1000000007)." 2300

1015E2 "Stars Drawing (Hard Edition)" "binary search,dp,greedy" "A star is a figure of the following type: an asterisk character \'*\' in the center of the figure and four rays (to the left, right, top, bottom) of the same positive length. The size of a star is the length of its rays. The size of a star must be a positive number (i.e. rays of length 0 are not allowed).Let\'s consider empty cells are denoted by \'.\', then the following figures are stars:  The leftmost figure is a star of size 1, the middle figure is a star of size 2 and the rightmost figure is a star of size 3. You are given a rectangular grid of size n\xc3\x97m consisting only of asterisks \'*\' and periods (dots) \'.\'. Rows are numbered from 1 to n, columns are numbered from 1 to m. Your task is to draw this grid using any number of stars or find out that it is impossible. Stars can intersect, overlap or even coincide with each other. The number of stars in the output can\'t exceed n\xe2\x8b\x85m. Each star should be completely inside the grid. You can use stars of same and arbitrary sizes.In this problem, you do not need to minimize the number of stars. Just find any way to draw the given grid with at most n\xe2\x8b\x85m stars." 1900

1015E1 "Stars Drawing (Easy Edition)" "brute force,dp,greedy" "A star is a figure of the following type: an asterisk character \'*\' in the center of the figure and four rays (to the left, right, top, bottom) of the same positive length. The size of a star is the length of its rays. The size of a star must be a positive number (i.e. rays of length 0 are not allowed).Let\'s consider empty cells are denoted by \'.\', then the following figures are stars:  The leftmost figure is a star of size 1, the middle figure is a star of size 2 and the rightmost figure is a star of size 3. You are given a rectangular grid of size n\xc3\x97m consisting only of asterisks \'*\' and periods (dots) \'.\'. Rows are numbered from 1 to n, columns are numbered from 1 to m. Your task is to draw this grid using any number of stars or find out that it is impossible. Stars can intersect, overlap or even coincide with each other. The number of stars in the output can\'t exceed n\xe2\x8b\x85m. Each star should be completely inside the grid. You can use stars of same and arbitrary sizes.In this problem, you do not need to minimize the number of stars. Just find any way to draw the given grid with at most n\xe2\x8b\x85m stars." 1700

1015D "Walking Between Houses" "constructive algorithms,greedy" "There are n houses in a row. They are numbered from 1 to n in order from left to right. Initially you are in the house 1.You have to perform k moves to other house. In one move you go from your current house to some other house. You can\'t stay where you are (i.e., in each move the new house differs from the current house). If you go from the house x to the house y, the total distance you walked increases by |x\xe2\x88\x92y| units of distance, where |a| is the absolute value of a. It is possible to visit the same house multiple times (but you can\'t visit the same house in sequence).Your goal is to walk exactly s units of distance in total.If it is impossible, print ""NO"". Otherwise print ""YES"" and any of the ways to do that. Remember that you should do exactly k moves." 1600

1015C "Songs Compression" sortings "Ivan has n songs on his phone. The size of the i-th song is ai bytes. Ivan also has a flash drive which can hold at most m bytes in total. Initially, his flash drive is empty.Ivan wants to copy all n songs to the flash drive. He can compress the songs. If he compresses the i-th song, the size of the i-th song reduces from ai to bi bytes (bi<ai).Ivan can compress any subset of the songs (possibly empty) and copy all the songs to his flash drive if the sum of their sizes is at most m. He can compress any subset of the songs (not necessarily contiguous).Ivan wants to find the minimum number of songs he needs to compress in such a way that all his songs fit on the drive (i.e. the sum of their sizes is less than or equal to m).If it is impossible to copy all the songs (even if Ivan compresses all the songs), print ""-1"". Otherwise print the minimum number of songs Ivan needs to compress." 1100

1015B "Obtaining the String" implementation "You are given two strings s and t. Both strings have length n and consist of lowercase Latin letters. The characters in the strings are numbered from 1 to n.You can successively perform the following move any number of times (possibly, zero):  swap any two adjacent (neighboring) characters of s (i.e. for any i={1,2,\xe2\x80\xa6,n\xe2\x88\x921} you can swap si and si+1). You can\'t apply a move to the string t. The moves are applied to the string s one after another.Your task is to obtain the string t from the string s. Find any way to do it with at most 104 such moves.You do not have to minimize the number of moves, just find any sequence of moves of length 104 or less to transform s into t." 1200

1015A "Points in Segments" implementation "You are given a set of n segments on the axis Ox, each segment has integer endpoints between 1 and m inclusive. Segments may intersect, overlap or even coincide with each other. Each segment is characterized by two integers li and ri (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4m) \xe2\x80\x94 coordinates of the left and of the right endpoints. Consider all integer points between 1 and m inclusive. Your task is to print all such points that don\'t belong to any segment. The point x belongs to the segment [l;r] if and only if l\xe2\x89\xa4x\xe2\x89\xa4r." 800

1013B And greedy "There is an array with n elements a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and the number x.In one operation you can select some i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and replace element ai with ai\xe2\x80\x89&\xe2\x80\x89x, where & denotes the bitwise and operation.You want the array to have at least two equal elements after applying some operations (possibly, none). In other words, there should be at least two distinct indices i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j such that ai\xe2\x80\x89=\xe2\x80\x89aj. Determine whether it is possible to achieve and, if possible, the minimal number of operations to apply." 1200

1013A "Piles With Stones" math "There is a beautiful garden of stones in Innopolis.Its most beautiful place is the n piles with stones numbered from 1 to n.EJOI participants have visited this place twice. When they first visited it, the number of stones in piles was x1,x2,\xe2\x80\xa6,xn, correspondingly. One of the participants wrote down this sequence in a notebook. They visited it again the following day, and the number of stones in piles was equal to y1,y2,\xe2\x80\xa6,yn. One of the participants also wrote it down in a notebook.It is well known that every member of the EJOI jury during the night either sits in the room 108 or comes to the place with stones. Each jury member who comes there either takes one stone for himself or moves one stone from one pile to another. We can assume that there is an unlimited number of jury members. No one except the jury goes to the place with stones at night.Participants want to know whether their notes can be correct or they are sure to have made a mistake." 800

1012F Passports dp,implementation "Gleb is a famous competitive programming teacher from Innopolis. He is planning a trip to N programming camps in the nearest future. Each camp will be held in a different country. For each of them, Gleb needs to apply for a visa. For each of these trips Gleb knows three integers: the number of the first day of the trip si, the length of the trip in days leni, and the number of days ti this country\'s consulate will take to process a visa application and stick a visa in a passport. Gleb has P (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89P\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892) valid passports and is able to decide which visa he wants to put in which passport.For each trip, Gleb will have a flight to that country early in the morning of the day si and will return back late in the evening of the day si\xe2\x80\x89+\xe2\x80\x89leni\xe2\x80\x89-\xe2\x80\x891.To apply for a visa on the day d, Gleb needs to be in Innopolis in the middle of this day. So he can\'t apply for a visa while he is on a trip, including the first and the last days. If a trip starts the next day after the end of the other one, Gleb can\'t apply for a visa between them as well. The earliest Gleb can apply for a visa is day 1.After applying for a visa of country i on day d, Gleb will get his passport back in the middle of the day d\xe2\x80\x89+\xe2\x80\x89ti. Consulates use delivery services, so Gleb can get his passport back even if he is not in Innopolis on this day. Gleb can apply for another visa on the same day he received his passport back, if he is in Innopolis this day. Gleb will not be able to start his trip on day si if he doesn\'t has a passport with a visa for the corresponding country in the morning of day si. In particular, the passport should not be in another country\'s consulate for visa processing.Help Gleb to decide which visas he needs to receive in which passport, and when he should apply for each visa." 3400

1012E "Cycle sort" dsu,math "You are given an array of n positive integers a1,a2,\xe2\x80\xa6,an. You can perform the following operation any number of times: select several distinct indices i1,i2,\xe2\x80\xa6,ik (1\xe2\x89\xa4ij\xe2\x89\xa4n) and move the number standing at the position i1 to the position i2, the number at the position i2 to the position i3, ..., the number at the position ik to the position i1. In other words, the operation cyclically shifts elements: i1\xe2\x86\x92i2\xe2\x86\x92\xe2\x80\xa6ik\xe2\x86\x92i1.For example, if you have n=4, an array a1=10,a2=20,a3=30,a4=40, and you choose three indices i1=2, i2=1, i3=4, then the resulting array would become a1=20,a2=40,a3=30,a4=10.Your goal is to make the array sorted in non-decreasing order with the minimum number of operations. The additional constraint is that the sum of cycle lengths over all operations should be less than or equal to a number s. If it\'s impossible to sort the array while satisfying that constraint, your solution should report that as well." 3100

1012D AB-Strings "constructive algorithms,strings" "There are two strings s and t, consisting only of letters a and b. You can make the following operation several times: choose a prefix of s, a prefix of t and swap them. Prefixes can be empty, also a prefix can coincide with a whole string. Your task is to find a sequence of operations after which one of the strings consists only of a letters and the other consists only of b letters. The number of operations should be minimized." 2800

1012C Hills dp "Welcome to Innopolis city. Throughout the whole year, Innopolis citizens suffer from everlasting city construction. From the window in your room, you see the sequence of n hills, where i-th of them has height ai. The Innopolis administration wants to build some houses on the hills. However, for the sake of city appearance, a house can be only built on the hill, which is strictly higher than neighbouring hills (if they are present). For example, if the sequence of heights is 5,\xe2\x80\x894,\xe2\x80\x896,\xe2\x80\x892, then houses could be built on hills with heights 5 and 6 only.The Innopolis administration has an excavator, that can decrease the height of an arbitrary hill by one in one hour. The excavator can only work on one hill at a time. It is allowed to decrease hills up to zero height, or even to negative values. Increasing height of any hill is impossible. The city administration wants to build k houses, so there must be at least k hills that satisfy the condition above. What is the minimum time required to adjust the hills to achieve the administration\'s plan?However, the exact value of k is not yet determined, so could you please calculate answers for all k in range ? Here  denotes n divided by two, rounded up." 1900

1012B "Chemical table" "constructive algorithms,dfs and similar,dsu,graphs,matrices" "Innopolis University scientists continue to investigate the periodic table. There are n\xc2\xb7m known elements and they form a periodic table: a rectangle with n rows and m columns. Each element can be described by its coordinates (r,\xe2\x80\x89c) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) in the table.Recently scientists discovered that for every four different elements in this table that form a rectangle with sides parallel to the sides of the table, if they have samples of three of the four elements, they can produce a sample of the fourth element using nuclear fusion. So if we have elements in positions (r1,\xe2\x80\x89c1), (r1,\xe2\x80\x89c2), (r2,\xe2\x80\x89c1), where r1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89r2 and c1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89c2, then we can produce element (r2,\xe2\x80\x89c2).  Samples used in fusion are not wasted and can be used again in future fusions. Newly crafted elements also can be used in future fusions.Innopolis University scientists already have samples of q elements. They want to obtain samples of all n\xc2\xb7m elements. To achieve that, they will purchase some samples from other laboratories and then produce all remaining elements using an arbitrary number of nuclear fusions in some order. Help them to find the minimal number of elements they need to purchase." 1900

1012A "Photo of The Sky" "brute force,implementation,math,sortings" "Pavel made a photo of his favourite stars in the sky. His camera takes a photo of all points of the sky that belong to some rectangle with sides parallel to the coordinate axes.Strictly speaking, it makes a photo of all points with coordinates (x,y), such that x1\xe2\x89\xa4x\xe2\x89\xa4x2 and y1\xe2\x89\xa4y\xe2\x89\xa4y2, where (x1,y1) and (x2,y2) are coordinates of the left bottom and the right top corners of the rectangle being photographed. The area of this rectangle can be zero.After taking the photo, Pavel wrote down coordinates of n of his favourite stars which appeared in the photo. These points are not necessarily distinct, there can be multiple stars in the same point of the sky.Pavel has lost his camera recently and wants to buy a similar one. Specifically, he wants to know the dimensions of the photo he took earlier. Unfortunately, the photo is also lost. His notes are also of not much help; numbers are written in random order all over his notepad, so it\'s impossible to tell which numbers specify coordinates of which points.Pavel asked you to help him to determine what are the possible dimensions of the photo according to his notes. As there are multiple possible answers, find the dimensions with the minimal possible area of the rectangle." 1500

1011B "Planning The Expedition" "binary search,brute force,implementation" "Natasha is planning an expedition to Mars for n people. One of the important tasks is to provide food for each participant.The warehouse has m daily food packages. Each package has some food type ai.Each participant must eat exactly one food package each day. Due to extreme loads, each participant must eat the same food type throughout the expedition. Different participants may eat different (or the same) types of food.Formally, for each participant j Natasha should select his food type bj and each day j-th participant will eat one food package of type bj. The values bj for different participants may be different.What is the maximum possible number of days the expedition can last, following the requirements above?" 1200

1011A Stages greedy,implementation,sortings "Natasha is going to fly to Mars. She needs to build a rocket, which consists of several stages in some order. Each of the stages is defined by a lowercase Latin letter. This way, the rocket can be described by the string�\xe2\x80\x94 concatenation of letters, which correspond to the stages.There are n stages available. The rocket must contain exactly k of them. Stages in the rocket should be ordered by their weight. So, after the stage with some letter can go only stage with a letter, which is at least two positions after in the alphabet (skipping one letter in between, or even more). For example, after letter \'c\' can\'t go letters \'a\', \'b\', \'c\' and \'d\', but can go letters \'e\', \'f\', ..., \'z\'.For the rocket to fly as far as possible, its weight should be minimal. The weight of the rocket is equal to the sum of the weights of its stages. The weight of the stage is the number of its letter in the alphabet. For example, the stage \'a \'weighs one ton,\' b \'weighs two tons, and\' z\'�\xe2\x80\x94 26 tons.Build the rocket with the minimal weight or determine, that it is impossible to build a rocket at all. Each stage can be used at most once." 900

1010F Tree fft,graphs,trees "The Main Martian Tree grows on Mars. It is a binary tree (a rooted tree, with no more than two sons at each vertex) with nn vertices, where the root vertex has the number 11. Its fruits are the Main Martian Fruits. It\'s summer now, so this tree does not have any fruit yet.Autumn is coming soon, and leaves and branches will begin to fall off the tree. It is clear, that if a vertex falls off the tree, then its entire subtree will fall off too. In addition, the root will remain on the tree. Formally: the tree will have some connected subset of vertices containing the root.After that, the fruits will grow on the tree (only at those vertices which remain). Exactly xx fruits will grow in the root. The number of fruits in each remaining vertex will be not less than the sum of the numbers of fruits in the remaining sons of this vertex. It is allowed, that some vertices will not have any fruits.Natasha wondered how many tree configurations can be after the described changes. Since this number can be very large, output it modulo 998244353998244353.Two configurations of the resulting tree are considered different if one of these two conditions is true: they have different subsets of remaining vertices; they have the same subset of remaining vertices, but there is a vertex in this subset where they have a different amount of fruits." 3400

1010E Store "data structures" "Natasha was already going to fly back to Earth when she remembered that she needs to go to the Martian store to buy Martian souvenirs for her friends.It is known, that the Martian year lasts xmax months, month lasts ymax days, day lasts zmax seconds. Natasha also knows that this store works according to the following schedule: 2 months in a year were selected: xl and xr (1\xe2\x89\xa4xl\xe2\x89\xa4xr\xe2\x89\xa4xmax), 2 days in a month: yl and yr (1\xe2\x89\xa4yl\xe2\x89\xa4yr\xe2\x89\xa4ymax) and 2 seconds in a day: zl and zr (1\xe2\x89\xa4zl\xe2\x89\xa4zr\xe2\x89\xa4zmax). The store works at all such moments (month x, day y, second z), when simultaneously xl\xe2\x89\xa4x\xe2\x89\xa4xr, yl\xe2\x89\xa4y\xe2\x89\xa4yr and zl\xe2\x89\xa4z\xe2\x89\xa4zr.Unfortunately, Natasha does not know the numbers xl,xr,yl,yr,zl,zr.One Martian told Natasha: ""I went to this store (n+m) times. n times of them it was opened, and m times�\xe2\x80\x94 closed."" He also described his every trip to the store: the month, day, second of the trip and whether the store was open or closed at that moment.Natasha can go to the store k times. For each of them, determine whether the store at the time of the trip is open, closed, or this information is unknown." 2700

1010D "Mars rover" "dfs and similar,graphs,implementation,trees" "Natasha travels around Mars in the Mars rover. But suddenly it broke down, namely�\xe2\x80\x94 the logical scheme inside it. The scheme is an undirected tree (connected acyclic graph) with a root in the vertex 11, in which every leaf (excluding root) is an input, and all other vertices are logical elements, including the root, which is output. One bit is fed to each input. One bit is returned at the output.There are four types of logical elements: AND (22 inputs), OR (22 inputs), XOR (22 inputs), NOT (11 input). Logical elements take values from their direct descendants (inputs) and return the result of the function they perform. Natasha knows the logical scheme of the Mars rover, as well as the fact that only one input is broken. In order to fix the Mars rover, she needs to change the value on this input.For each input, determine what the output will be if Natasha changes this input." 2000

1010C Border "number theory" "Astronaut Natasha arrived on Mars. She knows that the Martians are very poor aliens. To ensure a better life for the Mars citizens, their emperor decided to take tax from every tourist who visited the planet. Natasha is the inhabitant of Earth, therefore she had to pay the tax to enter the territory of Mars.There are n banknote denominations on Mars: the value of i-th banknote is ai. Natasha has an infinite number of banknotes of each denomination.Martians have k fingers on their hands, so they use a number system with base k. In addition, the Martians consider the digit d (in the number system with base k) divine. Thus, if the last digit in Natasha\'s tax amount written in the number system with the base k is d, the Martians will be happy. Unfortunately, Natasha does not know the Martians\' divine digit yet.Determine for which values d Natasha can make the Martians happy.Natasha can use only her banknotes. Martians don\'t give her change." 1800

1010B Rocket "binary search,interactive" "This is an interactive problem.Natasha is going to fly to Mars. Finally, Natasha sat in the rocket. She flies, flies... but gets bored. She wishes to arrive to Mars already! So she decides to find something to occupy herself. She couldn\'t think of anything better to do than to calculate the distance to the red planet.Let\'s define x as the distance to Mars. Unfortunately, Natasha does not know x. But it is known that 1\xe2\x89\xa4x\xe2\x89\xa4m, where Natasha knows the number m. Besides, x and m are positive integers.Natasha can ask the rocket questions. Every question is an integer y (1\xe2\x89\xa4y\xe2\x89\xa4m). The correct answer to the question is \xe2\x88\x921, if x<y, 0, if x=y, and 1, if x>y. But the rocket is broken�\xe2\x80\x94 it does not always answer correctly. Precisely: let the correct answer to the current question be equal to t, then, if the rocket answers this question correctly, then it will answer t, otherwise it will answer \xe2\x88\x92t.In addition, the rocket has a sequence p of length n. Each element of the sequence is either 0 or 1. The rocket processes this sequence in the cyclic order, that is 1-st element, 2-nd, 3-rd, \xe2\x80\xa6, (n\xe2\x88\x921)-th, n-th, 1-st, 2-nd, 3-rd, \xe2\x80\xa6, (n\xe2\x88\x921)-th, n-th, \xe2\x80\xa6. If the current element is 1, the rocket answers correctly, if 0�\xe2\x80\x94 lies. Natasha doesn\'t know the sequence p, but she knows its length�\xe2\x80\x94 n.You can ask the rocket no more than 60 questions.Help Natasha find the distance to Mars. Assume, that the distance to Mars does not change while Natasha is asking questions.Your solution will not be accepted, if it does not receive an answer 0 from the rocket (even if the distance to Mars is uniquely determined by the already received rocket\'s answers)." 1800

1010A Fly "binary search,math" "Natasha is going to fly on a rocket to Mars and return to Earth. Also, on the way to Mars, she will land on n\xe2\x88\x922 intermediate planets. Formally: we number all the planets from 1 to n. 1 is Earth, n is Mars. Natasha will make exactly n flights: 1\xe2\x86\x922\xe2\x86\x92\xe2\x80\xa6n\xe2\x86\x921.Flight from x to y consists of two phases: take-off from planet x and landing to planet y. This way, the overall itinerary of the trip will be: the 1-st planet \xe2\x86\x92 take-off from the 1-st planet \xe2\x86\x92 landing to the 2-nd planet \xe2\x86\x92 2-nd planet \xe2\x86\x92 take-off from the 2-nd planet \xe2\x86\x92 \xe2\x80\xa6 \xe2\x86\x92 landing to the n-th planet \xe2\x86\x92 the n-th planet \xe2\x86\x92 take-off from the n-th planet \xe2\x86\x92 landing to the 1-st planet \xe2\x86\x92 the 1-st planet.The mass of the rocket together with all the useful cargo (but without fuel) is m tons. However, Natasha does not know how much fuel to load into the rocket. Unfortunately, fuel can only be loaded on Earth, so if the rocket runs out of fuel on some other planet, Natasha will not be able to return home. Fuel is needed to take-off from each planet and to land to each planet. It is known that 1 ton of fuel can lift off ai tons of rocket from the i-th planet or to land bi tons of rocket onto the i-th planet. For example, if the weight of rocket is 9 tons, weight of fuel is 3 tons and take-off coefficient is 8 (ai=8), then 1.5 tons of fuel will be burnt (since 1.5\xe2\x8b\x858=9+3). The new weight of fuel after take-off will be 1.5 tons. Please note, that it is allowed to burn non-integral amount of fuel during take-off or landing, and the amount of initial fuel can be non-integral as well.Help Natasha to calculate the minimum mass of fuel to load into the rocket. Note, that the rocket must spend fuel to carry both useful cargo and the fuel itself. However, it doesn\'t need to carry the fuel which has already been burnt. Assume, that the rocket takes off and lands instantly." 1500

1009G "Allowed Letters" "bitmasks,flows,graph matchings,graphs,greedy" "Polycarp has just launched his new startup idea. The niche is pretty free and the key vector of development sounds really promising, so he easily found himself some investors ready to sponsor the company. However, he is yet to name the startup!Actually, Polycarp has already came up with the name but some improvement to it will never hurt. So now he wants to swap letters at some positions in it to obtain the better name. It isn\'t necessary for letters to be adjacent.In addition, each of the investors has chosen some index in the name and selected a set of letters that can go there. Indices chosen by different investors are pairwise distinct. If some indices aren\'t chosen by any investor then any letter can go there.Finally, Polycarp is sure that the smallest lexicographically name is the best. (Like why do you think Google decided to become Alphabet?)More formally, you are given a string consisting of lowercase Latin letters from ""a"" to ""f"". You can swap letters at any positions arbitrary number of times (zero swaps is also possible).What is the smallest lexicographically name you can obtain such that the letter at every position is among the allowed letters?If Polycarp can\'t produce any valid name then print ""Impossible""." 2400

1009F "Dominant Indices" "data structures,dsu,trees" "You are given a rooted undirected tree consisting of n vertices. Vertex 1 is the root.Let\'s denote a depth array of vertex x as an infinite sequence [dx,0,dx,1,dx,2,\xe2\x80\xa6], where dx,i is the number of vertices y such that both conditions hold:  x is an ancestor of y;  the simple path from x to y traverses exactly i edges. The dominant index of a depth array of vertex x (or, shortly, the dominant index of vertex x) is an index j such that:  for every k<j, dx,k<dx,j;  for every k>j, dx,k\xe2\x89\xa4dx,j. For every vertex in the tree calculate its dominant index." 2300

1009E "Intercity Travelling" combinatorics,math,probabilities "Leha is planning his journey from Moscow to Saratov. He hates trains, so he has decided to get from one city to another by car.The path from Moscow to Saratov can be represented as a straight line (well, it\'s not that straight in reality, but in this problem we will consider it to be straight), and the distance between Moscow and Saratov is n km. Let\'s say that Moscow is situated at the point with coordinate 0 km, and Saratov \xe2\x80\x94 at coordinate n km.Driving for a long time may be really difficult. Formally, if Leha has already covered i kilometers since he stopped to have a rest, he considers the difficulty of covering (i+1)-th kilometer as ai+1. It is guaranteed that for every i\xe2\x88\x88[1,n\xe2\x88\x921] ai\xe2\x89\xa4ai+1. The difficulty of the journey is denoted as the sum of difficulties of each kilometer in the journey.Fortunately, there may be some rest sites between Moscow and Saratov. Every integer point from 1 to n\xe2\x88\x921 may contain a rest site. When Leha enters a rest site, he may have a rest, and the next kilometer will have difficulty a1, the kilometer after it \xe2\x80\x94 difficulty a2, and so on.For example, if n=5 and there is a rest site in coordinate 2, the difficulty of journey will be 2a1+2a2+a3: the first kilometer will have difficulty a1, the second one \xe2\x80\x94 a2, then Leha will have a rest, and the third kilometer will have difficulty a1, the fourth \xe2\x80\x94 a2, and the last one \xe2\x80\x94 a3. Another example: if n=7 and there are rest sites in coordinates 1 and 5, the difficulty of Leha\'s journey is 3a1+2a2+a3+a4.Leha doesn\'t know which integer points contain rest sites. So he has to consider every possible situation. Obviously, there are 2n\xe2\x88\x921 different distributions of rest sites (two distributions are different if there exists some point x such that it contains a rest site in exactly one of these distributions). Leha considers all these distributions to be equiprobable. He wants to calculate p \xe2\x80\x94 the expected value of difficulty of his journey.Obviously, p\xe2\x8b\x852n\xe2\x88\x921 is an integer number. You have to calculate it modulo 998244353." 2000

1009D "Relatively Prime Graph" "brute force,constructive algorithms,graphs,greedy,math" "Let\'s call an undirected graph G=(V,E) relatively prime if and only if for each edge (v,u)\xe2\x88\x88E �GCD(v,u)=1 (the greatest common divisor of v and u is 1). If there is no edge between some pair of vertices v and u then the value of GCD(v,u) doesn\'t matter. The vertices are numbered from 1 to |V|.Construct a relatively prime graph with n vertices and m edges such that it is connected and it contains neither self-loops nor multiple edges.If there exists no valid graph with the given number of vertices and edges then output ""Impossible"".If there are multiple answers then print any of them." 1700

1009C "Annoying Present" greedy,math "Alice got an array of length n as a birthday present once again! This is the third year in a row! And what is more disappointing, it is overwhelmengly boring, filled entirely with zeros. Bob decided to apply some changes to the array to cheer up Alice.Bob has chosen m changes of the following form. For some integer numbers x and d, he chooses an arbitrary position i (1\xe2\x89\xa4i\xe2\x89\xa4n) and for every j\xe2\x88\x88[1,n] adds x+d\xe2\x8b\x85dist(i,j) to the value of the j-th cell. dist(i,j) is the distance between positions i and j (i.e. dist(i,j)=|i\xe2\x88\x92j|, where |x| is an absolute value of x).For example, if Alice currently has an array [2,1,2,2] and Bob chooses position 3 for x=\xe2\x88\x921 and d=2 then the array will become [2\xe2\x88\x921+2\xe2\x8b\x852,�1\xe2\x88\x921+2\xe2\x8b\x851,�2\xe2\x88\x921+2\xe2\x8b\x850,�2\xe2\x88\x921+2\xe2\x8b\x851] = [5,2,1,3]. Note that Bob can\'t choose position i outside of the array (that is, smaller than 1 or greater than n).Alice will be the happiest when the elements of the array are as big as possible. Bob claimed that the arithmetic mean value of the elements will work fine as a metric.What is the maximum arithmetic mean value Bob can achieve?" 1700

1009B "Minimum Ternary String" greedy,implementation "You are given a ternary string (it is a string which consists only of characters \'0\', \'1\' and \'2\').You can swap any two adjacent (consecutive) characters \'0\' and \'1\' (i.e. replace ""01"" with ""10"" or vice versa) or any two adjacent (consecutive) characters \'1\' and \'2\' (i.e. replace ""12"" with ""21"" or vice versa).For example, for string ""010210"" we can perform the following moves:   ""010210"" \xe2\x86\x92 ""100210"";  ""010210"" \xe2\x86\x92 ""001210"";  ""010210"" \xe2\x86\x92 ""010120"";  ""010210"" \xe2\x86\x92 ""010201"". Note than you cannot swap ""02"" \xe2\x86\x92 ""20"" and vice versa. You cannot perform any other operations with the given string excluding described above.You task is to obtain the minimum possible (lexicographically) string by using these swaps arbitrary number of times (possibly, zero).String a is lexicographically less than string b (if strings a and b have the same length) if there exists some position i (1\xe2\x89\xa4i\xe2\x89\xa4|a|, where |s| is the length of the string s) such that for every j<i holds aj=bj, and ai<bi." 1400

1009A "Game Shopping" implementation "Maxim wants to buy some games at the local game shop. There are n games in the shop, the i-th game costs ci.Maxim has a wallet which can be represented as an array of integers. His wallet contains m bills, the j-th bill has value aj.Games in the shop are ordered from left to right, Maxim tries to buy every game in that order.When Maxim stands at the position i in the shop, he takes the first bill from his wallet (if his wallet is empty then he proceeds to the next position immediately) and tries to buy the i-th game using this bill. After Maxim tried to buy the n-th game, he leaves the shop.Maxim buys the i-th game if and only if the value of the first bill (which he takes) from his wallet is greater or equal to the cost of the i-th game. If he successfully buys the i-th game, the first bill from his wallet disappears and the next bill becomes first. Otherwise Maxim leaves the first bill in his wallet (this bill still remains the first one) and proceeds to the next game.For example, for array c=[2,4,5,2,4] and array a=[5,3,4,6] the following process takes place: Maxim buys the first game using the first bill (its value is 5), the bill disappears, after that the second bill (with value 3) becomes the first one in Maxim\'s wallet, then Maxim doesn\'t buy the second game because c2>a2, the same with the third game, then he buys the fourth game using the bill of value a2 (the third bill becomes the first one in Maxim\'s wallet) and buys the fifth game using the bill of value a3.Your task is to get the number of games Maxim will buy." 800

1008B "Turn the Rectangles" greedy,sortings "There are n rectangles in a row. You can either turn each rectangle by 90 degrees or leave it as it is. If you turn a rectangle, its width will be height, and its height will be width. Notice that you can turn any number of rectangles, you also can turn all or none of them. You can not change the order of the rectangles.Find out if there is a way to make the rectangles go in order of non-ascending height. In other words, after all the turns, a height of every rectangle has to be not greater than the height of the previous rectangle (if it is such)." 1000

1008A Romaji implementation,strings "Vitya has just started learning Berlanese language. It is known that Berlanese uses the Latin alphabet. Vowel letters are ""a"", ""o"", ""u"", ""i"", and ""e"". Other letters are consonant.In Berlanese, there has to be a vowel after every consonant, but there can be any letter after any vowel. The only exception is a consonant ""n""; after this letter, there can be any letter (not only a vowel) or there can be no letter at all. For example, the words ""harakiri"", ""yupie"", ""man"", and ""nbo"" are Berlanese while the words ""horse"", ""king"", ""my"", and ""nz"" are not.Help Vitya find out if a word s is Berlanese." 900

1007E "Mini Metro" dp "In a simplified version of a ""Mini Metro"" game, there is only one subway line, and all the trains go in the same direction. There are nn stations on the line, aiai people are waiting for the train at the ii-th station at the beginning of the game. The game starts at the beginning of the 00-th hour. At the end of each hour (couple minutes before the end of the hour), bibi people instantly arrive to the ii-th station. If at some moment, the number of people at the ii-th station is larger than cici, you lose.A player has several trains which he can appoint to some hours. The capacity of each train is kk passengers. In the middle of the appointed hour, the train goes from the 11-st to the nn-th station, taking as many people at each station as it can accommodate. A train can not take people from the ii-th station if there are people at the i\xe2\x88\x921i\xe2\x88\x921-th station.If multiple trains are appointed to the same hour, their capacities are being added up and they are moving together.The player wants to stay in the game for tt hours. Determine the minimum number of trains he will need for it." 3400

1007D Ants "2-sat,data structures,trees" "There is a tree with n vertices. There are also m ants living on it. Each ant has its own color. The i-th ant has two favorite pairs of vertices: (ai,bi) and (ci,di). You need to tell if it is possible to paint the edges of the tree in m colors so that every ant will be able to walk between vertices from one of its favorite pairs using only edges of his color; if it is possible, you need to print which pair every ant should use." 3200

1007C "Guess two numbers" "binary search,interactive" "This is an interactive problem.Vasya and Vitya play a game. Vasya thought of two integers a and b from 1 to n and Vitya tries to guess them. Each round he tells Vasya two numbers x and y from 1 to n. If both x=a and y=b then Vitya wins. Else Vasya must say one of the three phrases:   x is less than a;  y is less than b;  x is greater than a or y is greater than b. Vasya can\'t lie, but if multiple phrases are true, he may choose any of them. For example, if Vasya thought of numbers 2 and 4, then he answers with the phrase 3 to a query (3,4), and he can answer with the phrase 1 or phrase 3 to a query (1,5).Help Vitya win in no more than 600 rounds." 3000

1007B "Pave the Parallelepiped" "bitmasks,brute force,combinatorics,math,number theory" "You are given a rectangular parallelepiped with sides of positive integer lengths A, B and C. Find the number of different groups of three integers (a, b, c) such that 1\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa4c and parallelepiped A\xc3\x97B\xc3\x97C can be paved with parallelepipeds a\xc3\x97b\xc3\x97c. Note, that all small parallelepipeds have to be rotated in the same direction.For example, parallelepiped 1\xc3\x975\xc3\x976 can be divided into parallelepipeds 1\xc3\x973\xc3\x975, but can not be divided into parallelepipeds 1\xc3\x972\xc3\x973." 2400

1007A "Reorder the Array" "combinatorics,data structures,math,sortings,two pointers" "You are given an array of integers. Vasya can permute (change order) its integers. He wants to do it so that as many as possible integers will become on a place where a smaller integer used to stand. Help Vasya find the maximal number of such integers.For instance, if we are given an array [10,20,30,40], we can permute it so that it becomes [20,40,10,30]. Then on the first and the second positions the integers became larger (20>10, 40>20) and did not on the third and the fourth, so for this permutation, the number that Vasya wants to maximize equals 2. Read the note for the first example, there is one more demonstrative test case.Help Vasya to permute integers in such way that the number of positions in a new array, where integers are greater than in the original one, is maximal." 1300

1006F Xor-Paths "bitmasks,brute force,dp,meet-in-the-middle" "There is a rectangular grid of size n\xc3\x97m. Each cell has a number written on it; the number on the cell (i,j) is ai,j. Your task is to calculate the number of paths from the upper-left cell (1,1) to the bottom-right cell (n,m) meeting the following constraints:  You can move to the right or to the bottom only. Formally, from the cell (i,j) you may move to the cell (i,j+1) or to the cell (i+1,j). The target cell can\'t be outside of the grid.  The xor of all the numbers on the path from the cell (1,1) to the cell (n,m) must be equal to k (xor operation is the bitwise exclusive OR, it is represented as \'^\' in Java or C++ and ""xor"" in Pascal). Find the number of such paths in the given grid." 2100

1006E "Military Problem" "dfs and similar,graphs,trees" "In this problem you will have to help Berland army with organizing their command delivery system.There are nn officers in Berland army. The first officer is the commander of the army, and he does not have any superiors. Every other officer has exactly one direct superior. If officer aa is the direct superior of officer bb, then we also can say that officer bb is a direct subordinate of officer aa.Officer xx is considered to be a subordinate (direct or indirect) of officer yy if one of the following conditions holds:  officer yy is the direct superior of officer xx;  the direct superior of officer xx is a subordinate of officer yy. For example, on the picture below the subordinates of the officer 33 are: 5,6,7,8,95,6,7,8,9.The structure of Berland army is organized in such a way that every officer, except for the commander, is a subordinate of the commander of the army.Formally, let\'s represent Berland army as a tree consisting of nn vertices, in which vertex uu corresponds to officer uu. The parent of vertex uu corresponds to the direct superior of officer uu. The root (which has index 11) corresponds to the commander of the army.Berland War Ministry has ordered you to give answers on qq queries, the ii-th query is given as (ui,ki)(ui,ki), where uiui is some officer, and kiki is a positive integer.To process the ii-th query imagine how a command from uiui spreads to the subordinates of uiui. Typical DFS (depth first search) algorithm is used here.Suppose the current officer is aa and he spreads a command. Officer aa chooses bb \xe2\x80\x94 one of his direct subordinates (i.e. a child in the tree) who has not received this command yet. If there are many such direct subordinates, then aa chooses the one having minimal index. Officer aa gives a command to officer bb. Afterwards, bb uses exactly the same algorithm to spread the command to its subtree. After bb finishes spreading the command, officer aa chooses the next direct subordinate again (using the same strategy). When officer aa cannot choose any direct subordinate who still hasn\'t received this command, officer aa finishes spreading the command.Let\'s look at the following example:  If officer 11 spreads a command, officers receive it in the following order: [1,2,3,5,6,8,7,9,4][1,2,3,5,6,8,7,9,4].If officer 33 spreads a command, officers receive it in the following order: [3,5,6,8,7,9][3,5,6,8,7,9].If officer 77 spreads a command, officers receive it in the following order: [7,9][7,9].If officer 99 spreads a command, officers receive it in the following order: [9][9].To answer the ii-th query (ui,ki)(ui,ki), construct a sequence which describes the order in which officers will receive the command if the uiui-th officer spreads it. Return the kiki-th element of the constructed list or -1 if there are fewer than kiki elements in it.You should process queries independently. A query doesn\'t affect the following queries." 1600

1006D "Two Strings Swaps" implementation "You are given two strings a and b consisting of lowercase English letters, both of length n. The characters of both strings have indices from 1 to n, inclusive. You are allowed to do the following changes:   Choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and swap characters ai and bi;  Choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and swap characters ai and an\xe2\x88\x92i+1;  Choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and swap characters bi and bn\xe2\x88\x92i+1. Note that if n is odd, you are formally allowed to swap a\xe2\x8c\x88n2\xe2\x8c\x89 with a\xe2\x8c\x88n2\xe2\x8c\x89 (and the same with the string b) but this move is useless. Also you can swap two equal characters but this operation is useless as well.You have to make these strings equal by applying any number of changes described above, in any order. But it is obvious that it may be impossible to make two strings equal by these swaps.In one preprocess move you can replace a character in a with another character. In other words, in a single preprocess move you can choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n), any character c and set ai:=c.Your task is to find the minimum number of preprocess moves to apply in such a way that after them you can make strings a and b equal by applying some number of changes described in the list above.Note that the number of changes you make after the preprocess moves does not matter. Also note that you cannot apply preprocess moves to the string b or make any preprocess moves after the first change is made." 1700

1006C "Three Parts of the Array" "binary search,data structures,two pointers" "You are given an array d1,d2,\xe2\x80\xa6,dn consisting of n integer numbers.Your task is to split this array into three parts (some of which may be empty) in such a way that each element of the array belongs to exactly one of the three parts, and each of the parts forms a consecutive contiguous subsegment (possibly, empty) of the original array. Let the sum of elements of the first part be sum1, the sum of elements of the second part be sum2 and the sum of elements of the third part be sum3. Among all possible ways to split the array you have to choose a way such that sum1=sum3 and sum1 is maximum possible.More formally, if the first part of the array contains a elements, the second part of the array contains b elements and the third part contains c elements, then:sum1=\xe2\x88\x911\xe2\x89\xa4i\xe2\x89\xa4adi, sum2=\xe2\x88\x91a+1\xe2\x89\xa4i\xe2\x89\xa4a+bdi, sum3=\xe2\x88\x91a+b+1\xe2\x89\xa4i\xe2\x89\xa4a+b+cdi.The sum of an empty array is 0.Your task is to find a way to split the array such that sum1=sum3 and sum1 is maximum possible." 1200

1006B "Polycarp\'s Practice" greedy,implementation,sortings "You are given an array d1,d2,\xe2\x80\xa6,dn consisting of n integer numbers.Your task is to split this array into three parts (some of which may be empty) in such a way that each element of the array belongs to exactly one of the three parts, and each of the parts forms a consecutive contiguous subsegment (possibly, empty) of the original array. Let the sum of elements of the first part be sum1, the sum of elements of the second part be sum2 and the sum of elements of the third part be sum3. Among all possible ways to split the array you have to choose a way such that sum1=sum3 and sum1 is maximum possible.More formally, if the first part of the array contains a elements, the second part of the array contains b elements and the third part contains c elements, then:sum1=\xe2\x88\x911\xe2\x89\xa4i\xe2\x89\xa4adi, sum2=\xe2\x88\x91a+1\xe2\x89\xa4i\xe2\x89\xa4a+bdi, sum3=\xe2\x88\x91a+b+1\xe2\x89\xa4i\xe2\x89\xa4a+b+cdi.The sum of an empty array is 0.Your task is to find a way to split the array such that sum1=sum3 and sum1 is maximum possible." 1200

1006A "Adjacent Replacements" implementation "Mishka got an integer array a of length n as a birthday present (what a surprise!).Mishka doesn\'t like this present and wants to change it somehow. He has invented an algorithm and called it ""Mishka\'s Adjacent Replacements Algorithm"". This algorithm can be represented as a sequence of steps:  Replace each occurrence of 1 in the array a with 2;  Replace each occurrence of 2 in the array a with 1;  Replace each occurrence of 3 in the array a with 4;  Replace each occurrence of 4 in the array a with 3;  Replace each occurrence of 5 in the array a with 6;  Replace each occurrence of 6 in the array a with 5;  \xe2\x80\xa6  Replace each occurrence of 109\xe2\x88\x921 in the array a with 109;  Replace each occurrence of 109 in the array a with 109\xe2\x88\x921. Note that the dots in the middle of this algorithm mean that Mishka applies these replacements for each pair of adjacent integers (2i\xe2\x88\x921,2i) for each i\xe2\x88\x88{1,2,\xe2\x80\xa6,5\xe2\x8b\x85108} as described above.For example, for the array a=[1,2,4,5,10], the following sequence of arrays represents the algorithm: [1,2,4,5,10] \xe2\x86\x92 (replace all occurrences of 1 with 2) \xe2\x86\x92 [2,2,4,5,10] \xe2\x86\x92 (replace all occurrences of 2 with 1) \xe2\x86\x92 [1,1,4,5,10] \xe2\x86\x92 (replace all occurrences of 3 with 4) \xe2\x86\x92 [1,1,4,5,10] \xe2\x86\x92 (replace all occurrences of 4 with 3) \xe2\x86\x92 [1,1,3,5,10] \xe2\x86\x92 (replace all occurrences of 5 with 6) \xe2\x86\x92 [1,1,3,6,10] \xe2\x86\x92 (replace all occurrences of 6 with 5) \xe2\x86\x92 [1,1,3,5,10] \xe2\x86\x92 \xe2\x80\xa6 \xe2\x86\x92 [1,1,3,5,10] \xe2\x86\x92 (replace all occurrences of 10 with 9) \xe2\x86\x92 [1,1,3,5,9]. The later steps of the algorithm do not change the array.Mishka is very lazy and he doesn\'t want to apply these changes by himself. But he is very interested in their result. Help him find it." 800

1005F "Berland and the Shortest Paths" "brute force,dfs and similar,graphs,shortest paths" "There are n cities in Berland. Some pairs of cities are connected by roads. All roads are bidirectional. Each road connects two different cities. There is at most one road between a pair of cities. The cities are numbered from 1 to n.It is known that, from the capital (the city with the number 1), you can reach any other city by moving along the roads.The President of Berland plans to improve the country\'s road network. The budget is enough to repair exactly n\xe2\x88\x921 roads. The President plans to choose a set of n\xe2\x88\x921 roads such that:  it is possible to travel from the capital to any other city along the n\xe2\x88\x921 chosen roads,  if di is the number of roads needed to travel from the capital to city i, moving only along the n\xe2\x88\x921 chosen roads, then d1+d2+\xe2\x8b\xaf+dn is minimized (i.e. as minimal as possible). In other words, the set of n\xe2\x88\x921 roads should preserve the connectivity of the country, and the sum of distances from city 1 to all cities should be minimized (where you can only use the n\xe2\x88\x921 chosen roads).The president instructed the ministry to prepare k possible options to choose n\xe2\x88\x921 roads so that both conditions above are met.Write a program that will find k possible ways to choose roads for repair. If there are fewer than k ways, then the program should output all possible valid ways to choose roads." 2100

1005E2 "Median on Segments (General Case Edition)" sortings "You are given an integer sequence a1,a2,\xe2\x80\xa6,an.Find the number of pairs of indices (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that the value of median of al,al+1,\xe2\x80\xa6,ar is exactly the given number m.The median of a sequence is the value of an element which is in the middle of the sequence after sorting it in non-decreasing order. If the length of the sequence is even, the left of two middle elements is used.For example, if a=[4,2,7,5] then its median is 4 since after sorting the sequence, it will look like [2,4,5,7] and the left of two middle elements is equal to 4. The median of [7,1,2,9,6] equals 6 since after sorting, the value 6 will be in the middle of the sequence.Write a program to find the number of pairs of indices (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that the value of median of al,al+1,\xe2\x80\xa6,ar is exactly the given number m." 2400

1005E1 "Median on Segments (Permutations Edition)" sortings "You are given a permutation p1,p2,\xe2\x80\xa6,pn. A permutation of length n is a sequence such that each integer between 1 and n occurs exactly once in the sequence.Find the number of pairs of indices (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that the value of the median of pl,pl+1,\xe2\x80\xa6,pr is exactly the given number m.The median of a sequence is the value of the element which is in the middle of the sequence after sorting it in non-decreasing order. If the length of the sequence is even, the left of two middle elements is used.For example, if a=[4,2,7,5] then its median is 4 since after sorting the sequence, it will look like [2,4,5,7] and the left of two middle elements is equal to 4. The median of [7,1,2,9,6] equals 6 since after sorting, the value 6 will be in the middle of the sequence.Write a program to find the number of pairs of indices (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that the value of the median of pl,pl+1,\xe2\x80\xa6,pr is exactly the given number m." 1800

1005D "Polycarp and Div 3" "dp,greedy,number theory" "Polycarp likes numbers that are divisible by 3.He has a huge number s. Polycarp wants to cut from it the maximum number of numbers that are divisible by 3. To do this, he makes an arbitrary number of vertical cuts between pairs of adjacent digits. As a result, after m such cuts, there will be m+1 parts in total. Polycarp analyzes each of the obtained numbers and finds the number of those that are divisible by 3.For example, if the original number is s=3121, then Polycarp can cut it into three parts with two cuts: 3|1|21. As a result, he will get two numbers that are divisible by 3.Polycarp can make an arbitrary number of vertical cuts, where each cut is made between a pair of adjacent digits. The resulting numbers cannot contain extra leading zeroes (that is, the number can begin with 0 if and only if this number is exactly one character \'0\'). For example, 007, 01 and 00099 are not valid numbers, but 90, 0 and 10001 are valid.What is the maximum number of numbers divisible by 3 that Polycarp can obtain?" 1500

1005C "Summarize to the Power of Two" "brute force,greedy,implementation" "A sequence a1,a2,\xe2\x80\xa6,an is called good if, for each element ai, there exists an element aj (i\xe2\x89\xa0j) such that ai+aj is a power of two (that is, 2d for some non-negative integer d).For example, the following sequences are good:  [5,3,11] (for example, for a1=5 we can choose a2=3. Note that their sum is a power of two. Similarly, such an element can be found for a2 and a3),  [1,1,1,1023],  [7,39,89,25,89],  []. Note that, by definition, an empty sequence (with a length of 0) is good.For example, the following sequences are not good:  [16] (for a1=16, it is impossible to find another element aj such that their sum is a power of two),  [4,16] (for a1=4, it is impossible to find another element aj such that their sum is a power of two),  [1,3,2,8,8,8] (for a3=2, it is impossible to find another element aj such that their sum is a power of two). You are given a sequence a1,a2,\xe2\x80\xa6,an. What is the minimum number of elements you need to remove to make it good? You can delete an arbitrary set of elements." 1300

1005B "Delete from the Left" "brute force,implementation,strings" "You are given two strings s and t. In a single move, you can choose any of two strings and delete the first (that is, the leftmost) character. After a move, the length of the string decreases by 1. You can\'t choose a string if it is empty.For example:  by applying a move to the string ""where"", the result is the string ""here"",  by applying a move to the string ""a"", the result is an empty string """". You are required to make two given strings equal using the fewest number of moves. It is possible that, in the end, both strings will be equal to the empty string, and so, are equal to each other. In this case, the answer is obviously the sum of the lengths of the initial strings.Write a program that finds the minimum number of moves to make two given strings s and t equal." 900

1005A "Tanya and Stairways" implementation "Little girl Tanya climbs the stairs inside a multi-storey building. Every time Tanya climbs a stairway, she starts counting steps from 1 to the number of steps in this stairway. She speaks every number aloud. For example, if she climbs two stairways, the first of which contains 3 steps, and the second contains 4 steps, she will pronounce the numbers 1,2,3,1,2,3,4.You are given all the numbers pronounced by Tanya. How many stairways did she climb? Also, output the number of steps in each stairway.The given sequence will be a valid sequence that Tanya could have pronounced when climbing one or more stairways." 800

1004F "Sonya and Bitwise OR" "bitmasks,data structures,divide and conquer" "Sonya has an array a1,a2,\xe2\x80\xa6,an consisting of n integers and also one non-negative integer x. She has to perform m queries of two types:  1 i y: replace i-th element by value y, i.e. to perform an operation ai := y;  2 l r: find the number of pairs (L, R) that l\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa4r and bitwise OR of all integers in the range [L,R] is at least x (note that x is a constant for all queries). Can you help Sonya perform all her queries?Bitwise OR is a binary operation on a pair of non-negative integers. To calculate the bitwise OR of two numbers, you need to write both numbers in binary notation. The result is a number, in binary, which contains a one in each digit if there is a one in the binary notation of at least one of the two numbers. For example, 10 OR 19 = 10102 OR 100112 = 110112 = 27." 2600

1004E "Sonya and Ice Cream" "binary search,data structures,dp,greedy,shortest paths,trees" "Sonya likes ice cream very much. She eats it even during programming competitions. That is why the girl decided that she wants to open her own ice cream shops.Sonya lives in a city with nn junctions and n\xe2\x88\x921n\xe2\x88\x921 streets between them. All streets are two-way and connect two junctions. It is possible to travel from any junction to any other using one or more streets. City Hall allows opening shops only on junctions. The girl cannot open shops in the middle of streets. Sonya has exactly kk friends whom she can trust. If she opens a shop, one of her friends has to work there and not to allow anybody to eat an ice cream not paying for it. Since Sonya does not want to skip an important competition, she will not work in shops personally.Sonya wants all her ice cream shops to form a simple path of the length rr (1\xe2\x89\xa4r\xe2\x89\xa4k1\xe2\x89\xa4r\xe2\x89\xa4k), i.e. to be located in different junctions f1,f2,\xe2\x80\xa6,frf1,f2,\xe2\x80\xa6,fr and there is street between fifi and fi+1fi+1 for each ii from 11 to r\xe2\x88\x921r\xe2\x88\x921.The girl takes care of potential buyers, so she also wants to minimize the maximum distance between the junctions to the nearest ice cream shop. The distance between two junctions aa and bb is equal to the sum of all the street lengths that you need to pass to get from the junction aa to the junction bb. So Sonya wants to minimizemaxamin1\xe2\x89\xa4i\xe2\x89\xa4rda,fimaxamin1\xe2\x89\xa4i\xe2\x89\xa4rda,fiwhere aa takes a value of all possible nn junctions, fifi�\xe2\x80\x94 the junction where the ii-th Sonya\'s shop is located, and dx,ydx,y�\xe2\x80\x94 the distance between the junctions xx and yy.Sonya is not sure that she can find the optimal shops locations, that is why she is asking you to help her to open not more than kk shops that will form a simple path and the maximum distance between any junction and the nearest shop would be minimal." 2400

1004D "Sonya and Matrix" "brute force,constructive algorithms,implementation" "Since Sonya has just learned the basics of matrices, she decided to play with them a little bit.Sonya imagined a new type of matrices that she called rhombic matrices. These matrices have exactly one zero, while all other cells have the Manhattan distance to the cell containing the zero. The cells with equal numbers have the form of a rhombus, that is why Sonya called this type so.The Manhattan distance between two cells (x1x1, y1y1) and (x2x2, y2y2) is defined as |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2||x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|. For example, the Manhattan distance between the cells (5,2)(5,2) and (7,1)(7,1) equals to |5\xe2\x88\x927|+|2\xe2\x88\x921|=3|5\xe2\x88\x927|+|2\xe2\x88\x921|=3.  Example of a rhombic matrix. Note that rhombic matrices are uniquely defined by nn, mm, and the coordinates of the cell containing the zero.She drew a n\xc3\x97mn\xc3\x97m rhombic matrix. She believes that you can not recreate the matrix if she gives you only the elements of this matrix in some arbitrary order (i.e., the sequence of n\xe2\x8b\x85mn\xe2\x8b\x85m numbers). Note that Sonya will not give you nn and mm, so only the sequence of numbers in this matrix will be at your disposal.Write a program that finds such an n\xc3\x97mn\xc3\x97m rhombic matrix whose elements are the same as the elements in the sequence in some order." 2300

1004C "Sonya and Robots" "constructive algorithms,implementation" "Since Sonya is interested in robotics too, she decided to construct robots that will read and recognize numbers.Sonya has drawn n numbers in a row, ai is located in the i-th position. She also has put a robot at each end of the row (to the left of the first number and to the right of the last number). Sonya will give a number to each robot (they can be either same or different) and run them. When a robot is running, it is moving toward to another robot, reading numbers in the row. When a robot is reading a number that is equal to the number that was given to that robot, it will turn off and stay in the same position.Sonya does not want robots to break, so she will give such numbers that robots will stop before they meet. That is, the girl wants them to stop at different positions so that the first robot is to the left of the second one.For example, if the numbers [1,5,4,1,3] are written, and Sonya gives the number 1 to the first robot and the number 4 to the second one, the first robot will stop in the 1-st position while the second one in the 3-rd position. In that case, robots will not meet each other. As a result, robots will not be broken. But if Sonya gives the number 4 to the first robot and the number 5 to the second one, they will meet since the first robot will stop in the 3-rd position while the second one is in the 2-nd position.Sonya understands that it does not make sense to give a number that is not written in the row because a robot will not find this number and will meet the other robot.Sonya is now interested in finding the number of different pairs that she can give to robots so that they will not meet. In other words, she wants to know the number of pairs (p, q), where she will give p to the first robot and q to the second one. Pairs (pi, qi) and (pj, qj) are different if pi\xe2\x89\xa0pj or qi\xe2\x89\xa0qj.Unfortunately, Sonya is busy fixing robots that broke after a failed launch. That is why she is asking you to find the number of pairs that she can give to robots so that they will not meet." 1400

1004B "Sonya and Exhibition" "constructive algorithms,greedy,implementation,math" "Sonya decided to organize an exhibition of flowers. Since the girl likes only roses and lilies, she decided that only these two kinds of flowers should be in this exhibition.There are n flowers in a row in the exhibition. Sonya can put either a rose or a lily in the i-th position. Thus each of n positions should contain exactly one flower: a rose or a lily.She knows that exactly m people will visit this exhibition. The i-th visitor will visit all flowers from li to ri inclusive. The girl knows that each segment has its own beauty that is equal to the product of the number of roses and the number of lilies.Sonya wants her exhibition to be liked by a lot of people. That is why she wants to put the flowers in such way that the sum of beauties of all segments would be maximum possible." 1300

1004A "Sonya and Hotels" implementation "Sonya decided that having her own hotel business is the best way of earning money because she can profit and rest wherever she wants.The country where Sonya lives is an endless line. There is a city in each integer coordinate on this line. She has n hotels, where the i-th hotel is located in the city with coordinate xi. Sonya is a smart girl, so she does not open two or more hotels in the same city.Sonya understands that her business needs to be expanded by opening new hotels, so she decides to build one more. She wants to make the minimum distance from this hotel to all others to be equal to d. The girl understands that there are many possible locations to construct such a hotel. Thus she wants to know the number of possible coordinates of the cities where she can build a new hotel. Because Sonya is lounging in a jacuzzi in one of her hotels, she is asking you to find the number of cities where she can build a new hotel so that the minimum distance from the original n hotels to the new one is equal to d." 900

1003F Abbreviation dp,hashing,strings "You are given a text consisting of n space-separated words. There is exactly one space character between any pair of adjacent words. There are no spaces before the first word and no spaces after the last word. The length of text is the number of letters and spaces in it. wi is the i-th word of text. All words consist only of lowercase Latin letters.Let\'s denote a segment of words w[i..j] as a sequence of words wi,wi+1,\xe2\x80\xa6,wj. Two segments of words w[i1..j1] and w[i2..j2] are considered equal if j1\xe2\x88\x92i1=j2\xe2\x88\x92i2, j1\xe2\x89\xa5i1, j2\xe2\x89\xa5i2, and for every t\xe2\x88\x88[0,j1\xe2\x88\x92i1] wi1+t=wi2+t. For example, for the text ""to be or not to be"" the segments w[1..2] and w[5..6] are equal, they correspond to the words ""to be"".An abbreviation is a replacement of some segments of words with their first uppercase letters. In order to perform an abbreviation, you have to choose at least two non-intersecting equal segments of words, and replace each chosen segment with the string consisting of first letters of the words in the segment (written in uppercase). For example, for the text ""a ab a a b ab a a b c"" you can replace segments of words w[2..4] and w[6..8] with an abbreviation ""AAA"" and obtain the text ""a AAA b AAA b c"", or you can replace segments of words w[2..5] and w[6..9] with an abbreviation ""AAAB"" and obtain the text ""a AAAB AAAB c"".What is the minimum length of the text after at most one abbreviation?" 2200

1003E "Tree Constructing" "constructive algorithms,graphs" "You are given three integers n, d and k.Your task is to construct an undirected tree on n vertices with diameter d and degree of each vertex at most k, or say that it is impossible.An undirected tree is a connected undirected graph with n\xe2\x88\x921 edges.Diameter of a tree is the maximum length of a simple path (a path in which each vertex appears at most once) between all pairs of vertices of this tree.Degree of a vertex is the number of edges incident to this vertex (i.e. for a vertex u it is the number of edges (u,v) that belong to the tree, where v is any other vertex of a tree)." 2100

1003D "Coins and Queries" greedy "Polycarp has n coins, the value of the i-th coin is ai. It is guaranteed that all the values are integer powers of 2 (i.e. ai=2d for some non-negative integer number d).Polycarp wants to know answers on q queries. The j-th query is described as integer number bj. The answer to the query is the minimum number of coins that is necessary to obtain the value bj using some subset of coins (Polycarp can use only coins he has). If Polycarp can\'t obtain the value bj, the answer to the j-th query is -1.The queries are independent (the answer on the query doesn\'t affect Polycarp\'s coins)." 1600

1003C "Intense Heat" "brute force,implementation,math" "The heat during the last few days has been really intense. Scientists from all over the Berland study how the temperatures and weather change, and they claim that this summer is abnormally hot. But any scientific claim sounds a lot more reasonable if there are some numbers involved, so they have decided to actually calculate some value which would represent how high the temperatures are.Mathematicians of Berland State University came up with a special heat intensity value. This value is calculated as follows:Suppose we want to analyze the segment of n consecutive days. We have measured the temperatures during these n days; the temperature during i-th day equals ai.We denote the average temperature of a segment of some consecutive days as the arithmetic mean of the temperature measures during this segment of days. So, if we want to analyze the average temperature from day x to day y, we calculate it as y\xe2\x88\x91i=xaiy\xe2\x88\x92x+1 (note that division is performed without any rounding). The heat intensity value is the maximum of average temperatures over all segments of not less than k consecutive days. For example, if analyzing the measures [3,4,1,2] and k=3, we are interested in segments [3,4,1], [4,1,2] and [3,4,1,2] (we want to find the maximum value of average temperature over these segments).You have been hired by Berland State University to write a program that would compute the heat intensity value of a given period of days. Are you up to this task?" 1300

1003B "Binary String Constructing" "constructive algorithms" "You are given three integers a, b and x. Your task is to construct a binary string s of length n=a+b such that there are exactly a zeroes, exactly b ones and exactly x indices i (where 1\xe2\x89\xa4i<n) such that si\xe2\x89\xa0si+1. It is guaranteed that the answer always exists.For example, for the string ""01010"" there are four indices i such that 1\xe2\x89\xa4i<n and si\xe2\x89\xa0si+1 (i=1,2,3,4). For the string ""111001"" there are two such indices i (i=3,5).Recall that binary string is a non-empty sequence of characters where each character is either 0 or 1." 1300

1003A "Polycarp\'s Pockets" implementation "You are given three integers a, b and x. Your task is to construct a binary string s of length n=a+b such that there are exactly a zeroes, exactly b ones and exactly x indices i (where 1\xe2\x89\xa4i<n) such that si\xe2\x89\xa0si+1. It is guaranteed that the answer always exists.For example, for the string ""01010"" there are four indices i such that 1\xe2\x89\xa4i<n and si\xe2\x89\xa0si+1 (i=1,2,3,4). For the string ""111001"" there are two such indices i (i=3,5).Recall that binary string is a non-empty sequence of characters where each character is either 0 or 1." 800

1002E2 "Another array reconstruction algorithm" NA "You are given a quantum oracle - an operation on N\xe2\x80\x89+\xe2\x80\x891 qubits which implements a function . You are guaranteed that the function f implemented by the oracle can be represented in the following form (oracle from problem D2):Here  (a vector of N integers, each of which can be 0 or 1), and  is a vector of N 1s.Your task is to reconstruct the array  which could produce the given oracle. Your code is allowed to call the given oracle only once.You have to implement an operation which takes the following inputs: an integer N - the number of qubits in the oracle input (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898), an oracle Uf, implemented as an operation with signature ((Qubit[], Qubit) => ()), i.e., an operation which takes as input an array of qubits and an output qubit and has no output.The return of your operation is an array of integers of length N, each of them 0 or 1.Note that in this problem we\'re comparing the oracle generated by your return to the oracle Uf, instead of comparing your return to the (hidden) value of  used to generate Uf. This means that any kind of incorrect return results in ""Runtime Error"" verdict, as well as actual runtime errors like releasing qubits in non-zero state.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (N : Int, Uf : ((Qubit[], Qubit) => ())) : Int[]    {        body        {            // your code here        }    }}" 1900

1002E1 "Bernstein-Vazirani algorithm" NA "You are given a quantum oracle - an operation on N\xe2\x80\x89+\xe2\x80\x891 qubits which implements a function . You are guaranteed that the function f implemented by the oracle is scalar product function (oracle from problem D1): Here  (an array of N integers, each of which can be 0 or 1). Your task is to reconstruct the array . Your code is allowed to call the given oracle only once.You have to implement an operation which takes the following inputs: an integer N - the number of qubits in the oracle input (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898), an oracle Uf, implemented as an operation with signature ((Qubit[], Qubit) => ()), i.e., an operation which takes as input an array of qubits and an output qubit and has no output.The return of your operation is an array of integers of length N, each of them 0 or 1.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (N : Int, Uf : ((Qubit[], Qubit) => ())) : Int[]    {        body        {            // your code here        }    }}" 1500

1002D3 "Oracle for majority function" NA "Implement a quantum oracle on 3 qubits which implements a majority function. Majority function on 3-bit vectors is defined as follows:  if vector  has two or three 1s, and 0 if it has zero or one 1s.For an explanation on how this type of quantum oracles works, see Introduction to quantum oracles.You have to implement an operation which takes the following inputs: an array of 3 qubits x in arbitrary state (input register), a qubit y in arbitrary state (output qubit).The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : ()    {        body        {            // your code here        }    }}" 1600

1002D2 "Oracle for f(x) = b * x + (1 - b) * (1 - x) mod 2" NA "Implement a quantum oracle on N qubits which implements the following function: Here  (a vector of N integers, each of which can be 0 or 1), and  is a vector of N 1s.For an explanation on how this type of quantum oracles works, see Introduction to quantum oracles.You have to implement an operation which takes the following inputs: an array of N qubits x in arbitrary state (input register), 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898, a qubit y in arbitrary state (output qubit), an array of N integers b, representing the vector . Each element of b will be 0 or 1.The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit, b : Int[]) : ()    {        body        {            // your code here        }    }}" 1300

1002D1 "Oracle for f(x) = b * x mod 2" NA "Implement a quantum oracle on N qubits which implements the following function: , where  (a vector of N integers, each of which can be 0 or 1).For an explanation on how this type of quantum oracles works, see Introduction to quantum oracles.You have to implement an operation which takes the following inputs: an array of N qubits x in arbitrary state (input register), 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898, a qubit y in arbitrary state (output qubit), an array of N integers b, representing the vector . Each element of b will be 0 or 1.The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit, b : Int[]) : ()    {        body        {            // your code here        }    }}" 1200

1002C2 "Distinguish zero state and plus state without errors" NA "You are given a qubit which is guaranteed to be either in  state or in  state. Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was a  state, 1 if it was  state or -1 if you can not decide, i.e., an ""inconclusive"" result. The state of the qubit after the operations does not matter.Note that these states are not orthogonal, and thus can not be distinguished perfectly. In each test your solution will be called 10000 times, and your goals are: never give 0 or 1 answer incorrectly (i.e., never return 0 if input state was  and never return 1 if input state was ), give -1 answer at most 80% of the times, correctly identify  state at least 10% of the times, correctly identify  state at least 10% of the times.In each test  and  states will be provided with 50% probability.You have to implement an operation which takes a qubit as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (q : Qubit) : Int    {        body        {            // your code here        }    }}" 1800

1002C1 "Distinguish zero state and plus state with minimum error" NA "You are given a qubit which is guaranteed to be either in  state or in  state. Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was a  state or 1 if it was  state. The state of the qubit after the operations does not matter.Note that these states are not orthogonal, and thus can not be distinguished perfectly. In each test your solution will be called 1000 times, and your goal is to get a correct answer at least 80% of the times. In each test  and  states will be provided with 50% probability.You have to implement an operation which takes a qubit as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (q : Qubit) : Int    {        body        {            // your code here        }    }}" 1700

1002B4 "Distinguish four 2-qubit states - 2" NA "You are given 2 qubits which are guaranteed to be in one of the four orthogonal states:    Your task is to perform necessary operations and measurements to figure out which state it was and to return the index of that state (0 for , 1 for  etc.). The state of the qubits after the operations does not matter.You have to implement an operation which takes an array of 2 qubits as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Int    {        body        {            // your code here        }    }}" 1700

1002B3 "Distinguish four 2-qubit states" NA "You are given 2 qubits which are guaranteed to be in one of the four orthogonal states:    Your task is to perform necessary operations and measurements to figure out which state it was and to return the index of that state (0 for , 1 for  etc.). The state of the qubits after the operations does not matter.You have to implement an operation which takes an array of 2 qubits as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Int    {        body        {            // your code here        }    }}" 1600

1002B2 "Distinguish GHZ state and W state" NA "You are given N qubits (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898) which are guaranteed to be in one of the two states:   state, or  state. Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was GHZ state or 1 if it was W state. The state of the qubits after the operations does not matter.You have to implement an operation which takes an array of N qubits as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Int    {        body        {            // your code here        }    }}" 1600

1002B1 "Distinguish zero state and W state" NA "You are given N qubits (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898) which are guaranteed to be in one of the two states:   state, or  state. Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was  state or 1 if it was W state. The state of the qubits after the operations does not matter.You have to implement an operation which takes an array of N qubits as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Int    {        body        {            // your code here        }    }}" 1300

1002A4 "Generate W state" NA "You are given N\xe2\x80\x89=\xe2\x80\x892k qubits (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894) in zero state . Your task is to create a generalized W state on them. Generalized W state is an equal superposition of all basis states on N qubits that have Hamming weight equal to 1:For example, for N\xe2\x80\x89=\xe2\x80\x891, .You have to implement an operation which takes an array of N qubits as an input and has no output. The ""output"" of the operation is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : ()    {        body        {            // your code here        }    }}" 1900

1002A3 "Generate superposition of two basis states" NA "You are given N qubits (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898) in zero state . You are also given two bitstrings bits0 and bits1 which describe two different basis states on N qubits  and .Your task is to generate a state which is an equal superposition of the given basis states:You have to implement an operation which takes the following inputs: an array of qubits qs, two arrays of Boolean values bits0 and bits1 representing the basis states  and . These arrays will have the same length as the array of qubits. bits0 and bits1 will differ in at least one position.The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[], bits0 : Bool[], bits1 : Bool[]) : ()    {        body        {            // your code here        }    }}" 1500

1002A2 "Generate superposition of zero state and a basis state" NA "You are given N qubits (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898) in zero state . You are also given a bitstring bits which describes a non-zero basis state on N qubits .Your task is to generate a state which is an equal superposition of  and the given basis state:You have to implement an operation which takes the following inputs: an array of qubits qs, an arrays of boolean values bits representing the basis state . This array will have the same length as the array of qubits. The first element of this array bits[0] will be true.The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.An array of boolean values represents a basis state as follows: the i-th element of the array is true if the i-th qubit is in state , and false if it is in state . For example, array [true; false] describes 2-qubit state , and in this case the resulting state should be .Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[], bits : Bool[]) : ()    {        body        {            // your code here        }    }}" 1300

1002A1 "Generate superposition of all basis states" NA "You are given N qubits (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898) in zero state . Your task is to generate an equal superposition of all 2N basis vectors on N qubits:For example, for N\xe2\x80\x89=\xe2\x80\x891, the required state is simply , for N\xe2\x80\x89=\xe2\x80\x892, the required state is . You have to implement an operation which takes an array of N qubits as an input and has no output. The ""output"" of the operation is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : ()    {        body        {            // your code here        }    }}" 800

1001I "Deutsch-Jozsa algorithm" "*special problem" "You are given a quantum oracle - an operation on N\xe2\x80\x89+\xe2\x80\x891 qubits which implements a function . You are guaranteed that the function f implemented by the oracle is either constant (returns 0 on all inputs or 1 on all inputs) or balanced (returns 0 on exactly one half of the input domain and 1 on the other half).There are only two possible constant functions: f(x)\xe2\x80\x89=\xe2\x80\x890 and f(x)\xe2\x80\x89=\xe2\x80\x891. The functions implemented by oracles in the two previous problems (f(x)\xe2\x80\x89=\xe2\x80\x89xk and ) are examples of balanced functions.Your task is to figure out whether the function given by the oracle is constant. Your code is allowed to call the given oracle only once." 1700

1001H "Oracle for f(x) = parity of the number of 1s in x" "*special problem" "Implement a quantum oracle on N qubits which implements the following function: , i.e., the value of the function is 1 if x has odd number of 1s, and 0 otherwise." 1200

1001G "Oracle for f(x) = k-th element of x" "*special problem" "Implement a quantum oracle on N qubits which implements a function f(x)\xe2\x80\x89=\xe2\x80\x89xk, i.e. the value of the function is the value of the k-th qubit.For an explanation on how the quantum oracles work, see the tutorial blog post." 1400

1001F "Distinguish multi-qubit basis states" "*special problem" "You are given N qubits which are guaranteed to be in one of two basis states on N qubits. You are also given two bitstrings bits0 and bits1 which describe these basis states.Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was the state described with bits0 or 1 if it was the state described with bits1. The state of the qubits after the operations does not matter." 1300

1001E "Distinguish Bell states" "*special problem" "You are given two qubits which are guaranteed to be in one of the Bell states:    Your task is to perform necessary operations and measurements to figure out which state it was and to return the index of that state (0 for , 1 for  etc.). The state of the qubits after the operations does not matter." 1600

1001D "Distinguish plus state and minus state" "*special problem" "You are given a qubit which is guaranteed to be either in  or in  state. Your task is to perform necessary operations and measurements to figure out which state it was and to return 1 if it was a  state or -1 if it was  state. The state of the qubit after the operations does not matter." 1400

1001C "Generate GHZ state" "*special problem" "You are given N qubits (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898) in zero state . Your task is to create Greenberger\xe2\x80\x93Horne\xe2\x80\x93Zeilinger (GHZ) state on them:Note that for N\xe2\x80\x89=\xe2\x80\x891 and N\xe2\x80\x89=\xe2\x80\x892 GHZ state becomes states  and  from the previous tasks, respectively." 1400

1001B "Generate Bell state" "*special problem" "You are given two qubits in state  and an integer index. Your task is to create one of the Bell states on them according to the index:" 1400

1001A "Generate plus state or minus state" "*special problem" "You are given a qubit in state  and an integer sign. Your task is to convert the given qubit to state  if sign\xe2\x80\x89=\xe2\x80\x891 or  if sign\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891." 1100

1000G Two-Paths "data structures,dp,trees" "You are given a weighted tree (undirected connected graph with no cycles, loops or multiple edges) with n vertices. The edge {uj,vj} has weight wj. Also each vertex i has its own value ai assigned to it.Let\'s call a path starting in vertex u and ending in vertex v, where each edge can appear no more than twice (regardless of direction), a 2-path. Vertices can appear in the 2-path multiple times (even start and end vertices).For some 2-path p profit Pr(p)=\xe2\x88\x91v\xe2\x88\x88distinct vertices in�pav\xe2\x88\x92\xe2\x88\x91e\xe2\x88\x88distinct edges in�pke\xe2\x8b\x85we, where ke is the number of times edge e appears in p. That is, vertices are counted once, but edges are counted the number of times they appear in p.You are about to answer m queries. Each query is a pair of vertices (qu,qv). For each query find 2-path p from qu to qv with maximal profit Pr(p)." 2700

1000F "One Occurrence" "data structures,divide and conquer" "You are given an array a consisting of n integers, and q queries to it. i-th query is denoted by two integers li and ri. For each query, you have to find any integer that occurs exactly once in the subarray of a from index li to index ri (a subarray is a contiguous subsegment of an array). For example, if a=[1,1,2,3,2,4], then for query (li=2,ri=6) the subarray we are interested in is [1,2,3,2,4], and possible answers are 1, 3 and 4; for query (li=1,ri=2) the subarray we are interested in is [1,1], and there is no such element that occurs exactly once.Can you answer all of the queries?" 2400

1000E "We Need More Bosses" "dfs and similar,graphs,trees" "Your friend is developing a computer game. He has already decided how the game world should look like \xe2\x80\x94 it should consist of n locations connected by m two-way passages. The passages are designed in such a way that it should be possible to get from any location to any other location.Of course, some passages should be guarded by the monsters (if you just can go everywhere without any difficulties, then it\'s not fun, right?). Some crucial passages will be guarded by really fearsome monsters, requiring the hero to prepare for battle and designing his own tactics of defeating them (commonly these kinds of monsters are called bosses). And your friend wants you to help him place these bosses.The game will start in location s and end in location t, but these locations are not chosen yet. After choosing these locations, your friend will place a boss in each passage such that it is impossible to get from s to t without using this passage. Your friend wants to place as much bosses as possible (because more challenges means more fun, right?), so he asks you to help him determine the maximum possible number of bosses, considering that any location can be chosen as s or as t." 2100

1000D "Yet Another Problem On a Subsequence" combinatorics,dp "The sequence of integers a1,a2,\xe2\x80\xa6,ak is called a good array if a1=k\xe2\x88\x921 and a1>0. For example, the sequences [3,\xe2\x88\x921,44,0],[1,\xe2\x88\x9299] are good arrays, and the sequences [3,7,8],[2,5,4,1],[0] \xe2\x80\x94 are not.A sequence of integers is called good if it can be divided into a positive number of good arrays. Each good array should be a subsegment of sequence and each element of the sequence should belong to exactly one array. For example, the sequences [2,\xe2\x88\x923,0,1,4], [1,2,3,\xe2\x88\x923,\xe2\x88\x929,4] are good, and the sequences [2,\xe2\x88\x923,0,1], [1,2,3,\xe2\x88\x923\xe2\x88\x929,4,1] \xe2\x80\x94 are not.For a given sequence of numbers, count the number of its subsequences that are good sequences, and print the number of such subsequences modulo 998244353." 1900

1000C "Covered Points Count" "data structures,implementation,sortings" "You are given n segments on a coordinate line; each endpoint of every segment has integer coordinates. Some segments can degenerate to points. Segments can intersect with each other, be nested in each other or even coincide.Your task is the following: for every k\xe2\x88\x88[1..n], calculate the number of points with integer coordinates such that the number of segments that cover these points equals k. A segment with endpoints li and ri covers point x if and only if li\xe2\x89\xa4x\xe2\x89\xa4ri." 1700

1000B "Light It Up" greedy "Recently, you bought a brand new smart lamp with programming features. At first, you set up a schedule to the lamp. Every day it will turn power on at moment 0 and turn power off at moment M. Moreover, the lamp allows you to set a program of switching its state (states are ""lights on"" and ""lights off""). Unfortunately, some program is already installed into the lamp.The lamp allows only good programs. Good program can be represented as a non-empty array a, where 0<a1<a2<\xe2\x8b\xaf<a|a|<M. All ai must be integers. Of course, preinstalled program is a good program.The lamp follows program a in next manner: at moment 0 turns power and light on. Then at moment ai the lamp flips its state to opposite (if it was lit, it turns off, and vice versa). The state of the lamp flips instantly: for example, if you turn the light off at moment 1 and then do nothing, the total time when the lamp is lit will be 1. Finally, at moment M the lamp is turning its power off regardless of its state.Since you are not among those people who read instructions, and you don\'t understand the language it\'s written in, you realize (after some testing) the only possible way to alter the preinstalled program. You can insert at most one element into the program a, so it still should be a good program after alteration. Insertion can be done between any pair of consecutive elements of a, or even at the begining or at the end of a.Find such a way to alter the program that the total time when the lamp is lit is maximum possible. Maybe you should leave program untouched. If the lamp is lit from x till moment y, then its lit for y\xe2\x88\x92x units of time. Segments of time when the lamp is lit are summed up." 1500

1000A "Codehorses T-shirts" greedy,implementation "Codehorses has just hosted the second Codehorses Cup. This year, the same as the previous one, organizers are giving T-shirts for the winners.The valid sizes of T-shirts are either ""M"" or from 0 to 3 ""X"" followed by ""S"" or ""L"". For example, sizes ""M"", ""XXS"", ""L"", ""XXXL"" are valid and ""XM"", ""Z"", ""XXXXL"" are not.There are n winners to the cup for both the previous year and the current year. Ksenia has a list with the T-shirt sizes printed for the last year cup and is yet to send the new list to the printing office. Organizers want to distribute the prizes as soon as possible, so now Ksenia is required not to write the whole list from the scratch but just make some changes to the list of the previous year. In one second she can choose arbitrary position in any word and replace its character with some uppercase Latin letter. Ksenia can\'t remove or add letters in any of the words.What is the minimal number of seconds Ksenia is required to spend to change the last year list to the current one?The lists are unordered. That means, two lists are considered equal if and only if the number of occurrences of any string is the same in both lists." 1200

999F "Cards and Joy" dp "There are n players sitting at the card table. Each player has a favorite number. The favorite number of the j-th player is fj.There are k\xe2\x8b\x85n cards on the table. Each card contains a single integer: the i-th card contains number ci. Also, you are given a sequence h1,h2,\xe2\x80\xa6,hk. Its meaning will be explained below.The players have to distribute all the cards in such a way that each of them will hold exactly k cards. After all the cards are distributed, each player counts the number of cards he has that contains his favorite number. The joy level of a player equals ht if the player holds t cards containing his favorite number. If a player gets no cards with his favorite number (i.e., t=0), his joy level is 0.Print the maximum possible total joy levels of the players after the cards are distributed. Note that the sequence h1,\xe2\x80\xa6,hk is the same for all the players." 2000

999E "Reachability from the Capital" "dfs and similar,graphs,greedy" "There are nn cities and mm roads in Berland. Each road connects a pair of cities. The roads in Berland are one-way.What is the minimum number of new roads that need to be built to make all the cities reachable from the capital?New roads will also be one-way." 2000

999D "Equalize the Remainders" "data structures,greedy,implementation" "You are given an array consisting of n integers a1,a2,\xe2\x80\xa6,an, and a positive integer m. It is guaranteed that m is a divisor of n.In a single move, you can choose any position i between 1 and n and increase ai by 1.Let\'s calculate cr (0\xe2\x89\xa4r\xe2\x89\xa4m\xe2\x88\x921) \xe2\x80\x94 the number of elements having remainder r when divided by m. In other words, for each remainder, let\'s find the number of corresponding elements in a with that remainder.Your task is to change the array in such a way that c0=c1=\xe2\x8b\xaf=cm\xe2\x88\x921=nm.Find the minimum number of moves to satisfy the above requirement." 1900

999C "Alphabetic Removals" implementation "You are given a string s consisting of n lowercase Latin letters. Polycarp wants to remove exactly k characters (k\xe2\x89\xa4n) from the string s. Polycarp uses the following algorithm k times:  if there is at least one letter \'a\', remove the leftmost occurrence and stop the algorithm, otherwise go to next item;  if there is at least one letter \'b\', remove the leftmost occurrence and stop the algorithm, otherwise go to next item;  ...  remove the leftmost occurrence of the letter \'z\' and stop the algorithm. This algorithm removes a single letter from the string. Polycarp performs this algorithm exactly k times, thus removing exactly k characters.Help Polycarp find the resulting string." 1200

999B "Reversing Encryption" implementation "A string s of length n can be encrypted by the following algorithm:  iterate over all divisors of n in decreasing order (i.e. from n to 1),  for each divisor d, reverse the substring s[1\xe2\x80\xa6d] (i.e. the substring which starts at position 1 and ends at position d). For example, the above algorithm applied to the string s=""codeforces"" leads to the following changes: ""codeforces"" \xe2\x86\x92 ""secrofedoc"" \xe2\x86\x92 ""orcesfedoc"" \xe2\x86\x92 ""rocesfedoc"" \xe2\x86\x92 ""rocesfedoc"" (obviously, the last reverse operation doesn\'t change the string because d=1).You are given the encrypted string t. Your task is to decrypt this string, i.e., to find a string s such that the above algorithm results in string t. It can be proven that this string s always exists and is unique." 900

999A "Mishka and Contest" "brute force,implementation" "Mishka started participating in a programming contest. There are n problems in the contest. Mishka\'s problem-solving skill is equal to k.Mishka arranges all problems from the contest into a list. Because of his weird principles, Mishka only solves problems from one of the ends of the list. Every time, he chooses which end (left or right) he will solve the next problem from. Thus, each problem Mishka solves is either the leftmost or the rightmost problem in the list.Mishka cannot solve a problem with difficulty greater than k. When Mishka solves the problem, it disappears from the list, so the length of the list decreases by 1. Mishka stops when he is unable to solve any problem from any end of the list.How many problems can Mishka solve?" 800

998B Cutting dp,greedy,sortings "There are a lot of things which could be cut�\xe2\x80\x94 trees, paper, ""the rope"". In this problem you are going to cut a sequence of integers.There is a sequence of integers, which contains the equal number of even and odd numbers. Given a limited budget, you need to make maximum possible number of cuts such that each resulting segment will have the same number of odd and even integers.Cuts separate a sequence to continuous (contiguous) segments. You may think about each cut as a break between two adjacent elements in a sequence. So after cutting each element belongs to exactly one segment. Say, [4,1,2,3,4,5,4,4,5,5] \xe2\x86\x92 two cuts \xe2\x86\x92 [4,1|2,3,4,5|4,4,5,5]. On each segment the number of even elements should be equal to the number of odd elements.The cost of the cut between x and y numbers is |x\xe2\x88\x92y| bitcoins. Find the maximum possible number of cuts that can be made while spending no more than B bitcoins." 1200

998A Balloons "constructive algorithms,implementation" "There are quite a lot of ways to have fun with inflatable balloons. For example, you can fill them with water and see what happens.Grigory and Andrew have the same opinion. So, once upon a time, they went to the shop and bought n packets with inflatable balloons, where i-th of them has exactly ai balloons inside.They want to divide the balloons among themselves. In addition, there are several conditions to hold:  Do not rip the packets (both Grigory and Andrew should get unbroken packets);  Distribute all packets (every packet should be given to someone);  Give both Grigory and Andrew at least one packet;  To provide more fun, the total number of balloons in Grigory\'s packets should not be equal to the total number of balloons in Andrew\'s packets. Help them to divide the balloons or determine that it\'s impossible under these conditions." 1000

997E "Good Subsegments" "data structures" "A permutation p of length n is a sequence p1,p2,\xe2\x80\xa6,pn consisting of n distinct integers, each of which from 1 to n (1\xe2\x89\xa4pi\xe2\x89\xa4n) .Let\'s call the subsegment [l,r] of the permutation good if all numbers from the minimum on it to the maximum on this subsegment occur among the numbers pl,pl+1,\xe2\x80\xa6,pr.For example, good segments of permutation [1,3,2,5,4] are:  [1,1],  [1,3],  [1,5],  [2,2],  [2,3],  [2,5],  [3,3],  [4,4],  [4,5],  [5,5]. You are given a permutation p1,p2,\xe2\x80\xa6,pn.You need to answer q queries of the form: find the number of good subsegments of the given segment of permutation.In other words, to answer one query, you need to calculate the number of good subsegments [x\xe2\x80\xa6y] for some given segment [l\xe2\x80\xa6r], such that l\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4r." 3000

997D "Cycles in product" "combinatorics,divide and conquer,trees" "Consider a tree (that is, an undirected connected graph without loops) T1 and a tree T2. Let\'s define their cartesian product T1\xc3\x97T2 in a following way.Let V be the set of vertices in T1 and U be the set of vertices in T2.Then the set of vertices of graph T1\xc3\x97T2 is V\xc3\x97U, that is, a set of ordered pairs of vertices, where the first vertex in pair is from V and the second�\xe2\x80\x94 from U.Let\'s draw the following edges: Between (v,u1) and (v,u2) there is an undirected edge, if u1 and u2 are adjacent in U.  Similarly, between (v1,u) and (v2,u) there is an undirected edge, if v1 and v2 are adjacent in V. Please see the notes section for the pictures of products of trees in the sample tests.Let\'s examine the graph T1\xc3\x97T2. How much cycles (not necessarily simple) of length k it contains? Since this number can be very large, print it modulo 998244353.The sequence of vertices w1, w2, ..., wk, where wi\xe2\x88\x88V\xc3\x97U called cycle, if any neighboring vertices are adjacent and w1 is adjacent to wk. Cycles that differ only by the cyclic shift or direction of traversal are still considered different." 2900

997C "Sky Full of Stars" combinatorics,math "On one of the planets of Solar system, in Atmosphere University, many students are fans of bingo game.It is well known that one month on this planet consists of n2n2 days, so calendars, represented as square matrix nn by nn are extremely popular.Weather conditions are even more unusual. Due to the unique composition of the atmosphere, when interacting with sunlight, every day sky takes one of three colors: blue, green or red.To play the bingo, you need to observe the sky for one month�\xe2\x80\x94 after each day, its cell is painted with the color of the sky in that day, that is, blue, green or red.At the end of the month, students examine the calendar. If at least one row or column contains only cells of one color, that month is called lucky.Let\'s call two colorings of calendar different, if at least one cell has different colors in them. It is easy to see that there are 3n\xe2\x8b\x85n3n\xe2\x8b\x85n different colorings. How much of them are lucky? Since this number can be quite large, print it modulo 998244353998244353." 2500

997B "Roman Digits" "brute force,combinatorics,dp,greedy,math" "Let\'s introduce a number system which is based on a roman digits. There are digits I, V, X, L which correspond to the numbers 1, 5, 10 and 50 respectively. The use of other roman digits is not allowed.Numbers in this system are written as a sequence of one or more digits. We define the value of the sequence simply as the sum of digits in it.For example, the number XXXV evaluates to 35 and the number IXI�\xe2\x80\x94 to 12.Pay attention to the difference to the traditional roman system�\xe2\x80\x94 in our system any sequence of digits is valid, moreover the order of digits doesn\'t matter, for example IX means 11, not 9.One can notice that this system is ambiguous, and some numbers can be written in many different ways. Your goal is to determine how many distinct integers can be represented by exactly n roman digits I, V, X, L." 2000

997A "Convert to Ones" "brute force,greedy,implementation,math" "You\'ve got a string a1,a2,\xe2\x80\xa6,an, consisting of zeros and ones.Let\'s call a sequence of consecutive elements ai,ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\xa6,\xe2\x80\x89aj (1\xe2\x89\xa4\xe2\x80\x89i\xe2\x89\xa4\xe2\x80\x89j\xe2\x89\xa4\xe2\x80\x89n) a substring of string a. You can apply the following operations any number of times:  Choose some substring of string a (for example, you can choose entire string) and reverse it, paying x coins for it (for example, \xc2\xab0101101\xc2\xbb \xe2\x86\x92 \xc2\xab0111001\xc2\xbb);  Choose some substring of string a (for example, you can choose entire string or just one symbol) and replace each symbol to the opposite one (zeros are replaced by ones, and ones�\xe2\x80\x94 by zeros), paying y coins for it (for example, \xc2\xab0101101\xc2\xbb \xe2\x86\x92 \xc2\xab0110001\xc2\xbb). You can apply these operations in any order. It is allowed to apply the operations multiple times to the same substring.What is the minimum number of coins you need to spend to get a string consisting only of ones?" 1500

996B "World Cup" "binary search,math" "Allen wants to enter a fan zone that occupies a round square and has n entrances.There already is a queue of ai people in front of the i-th entrance. Each entrance allows one person from its queue to enter the fan zone in one minute.Allen uses the following strategy to enter the fan zone:   Initially he stands in the end of the queue in front of the first entrance.  Each minute, if he is not allowed into the fan zone during the minute (meaning he is not the first in the queue), he leaves the current queue and stands in the end of the queue of the next entrance (or the first entrance if he leaves the last entrance). Determine the entrance through which Allen will finally enter the fan zone." 1300

996A "Hit the Lottery" dp,greedy "Allen has a LOT of money. He has n dollars in the bank. For security reasons, he wants to withdraw it in cash (we will not disclose the reasons here). The denominations for dollar bills are 1, 5, 10, 20, 100. What is the minimum number of bills Allen could receive after withdrawing his entire balance?" 800

995F "Cowmpany Cowmpensation" combinatorics,dp,math,trees "Allen, having graduated from the MOO Institute of Techcowlogy (MIT), has started a startup! Allen is the president of his startup. He also hires n\xe2\x88\x921 other employees, each of which is assigned a direct superior. If u is a superior of v and v is a superior of w then also u is a superior of w. Additionally, there are no u and v such that u is the superior of v and v is the superior of u. Allen himself has no superior. Allen is employee number 1, and the others are employee numbers 2 through n.Finally, Allen must assign salaries to each employee in the company including himself. Due to budget constraints, each employee\'s salary is an integer between 1 and D. Additionally, no employee can make strictly more than his superior.Help Allen find the number of ways to assign salaries. As this number may be large, output it modulo 109+7." 2700

995E "Number Clicker" "divide and conquer,graphs,meet-in-the-middle,number theory" "Allen is playing Number Clicker on his phone.He starts with an integer u on the screen. Every second, he can press one of 3 buttons.  Turn u\xe2\x86\x92u+1(modp).  Turn u\xe2\x86\x92u+p\xe2\x88\x921(modp).  Turn u\xe2\x86\x92up\xe2\x88\x922(modp). Allen wants to press at most 200 buttons and end up with v on the screen. Help him!" 2700

995D Game math "Allen and Bessie are playing a simple number game. They both know a function f:{0,1}n\xe2\x86\x92R, i.�e. the function takes n binary arguments and returns a real value. At the start of the game, the variables x1,x2,\xe2\x80\xa6,xn are all set to \xe2\x88\x921. Each round, with equal probability, one of Allen or Bessie gets to make a move. A move consists of picking an i such that xi=\xe2\x88\x921 and either setting xi\xe2\x86\x920 or xi\xe2\x86\x921.After n rounds all variables are set, and the game value resolves to f(x1,x2,\xe2\x80\xa6,xn). Allen wants to maximize the game value, and Bessie wants to minimize it.Your goal is to help Allen and Bessie find the expected game value! They will play r+1 times though, so between each game, exactly one value of f changes. In other words, between rounds i and i+1 for 1\xe2\x89\xa4i\xe2\x89\xa4r, f(z1,\xe2\x80\xa6,zn)\xe2\x86\x92gi for some (z1,\xe2\x80\xa6,zn)\xe2\x88\x88{0,1}n. You are to find the expected game value in the beginning and after each change." 2500

995C "Leaving the Bar" "brute force,data structures,geometry,greedy,math,sortings" "For a vector \xe2\x86\x92v=(x,y), define |v|=\xe2\x88\x9ax2+y2.Allen had a bit too much to drink at the bar, which is at the origin. There are n vectors \xe2\x86\x92v1,\xe2\x86\x92v2,\xe2\x8b\xaf,\xe2\x86\x92vn. Allen will make n moves. As Allen\'s sense of direction is impaired, during the i-th move he will either move in the direction \xe2\x86\x92vi or \xe2\x88\x92\xe2\x86\x92vi. In other words, if his position is currently p=(x,y), he will either move to p+\xe2\x86\x92vi or p\xe2\x88\x92\xe2\x86\x92vi.Allen doesn\'t want to wander too far from home (which happens to also be the bar). You need to help him figure out a sequence of moves (a sequence of signs for the vectors) such that his final position p satisfies |p|\xe2\x89\xa41.5\xe2\x8b\x85106 so that he can stay safe." 2300

995B "Suit and Tie" greedy,implementation,math "Allen is hosting a formal dinner party. 2n people come to the event in n pairs (couples). After a night of fun, Allen wants to line everyone up for a final picture. The 2n people line up, but Allen doesn\'t like the ordering. Allen prefers if each pair occupies adjacent positions in the line, as this makes the picture more aesthetic.Help Allen find the minimum number of swaps of adjacent positions he must perform to make it so that each couple occupies adjacent positions in the line." 1400

995A Tesla "constructive algorithms,implementation" "Allen dreams of one day owning a enormous fleet of electric cars, the car of the future! He knows that this will give him a big status boost. As Allen is planning out all of the different types of cars he will own and how he will arrange them, he realizes that he has a problem. Allen\'s future parking lot can be represented as a rectangle with 44 rows and nn (n\xe2\x89\xa450n\xe2\x89\xa450) columns of rectangular spaces, each of which can contain at most one car at any time. He imagines having kk (k\xe2\x89\xa42nk\xe2\x89\xa42n) cars in the grid, and all the cars are initially in the second and third rows. Each of the cars also has a different designated parking space in the first or fourth row. Allen has to put the cars into corresponding parking places.  Illustration to the first example. However, since Allen would never entrust his cars to anyone else, only one car can be moved at a time. He can drive a car from a space in any of the four cardinal directions to a neighboring empty space. Furthermore, Allen can only move one of his cars into a space on the first or fourth rows if it is the car\'s designated parking space. Allen knows he will be a very busy man, and will only have time to move cars at most 2000020000 times before he realizes that moving cars is not worth his time. Help Allen determine if he should bother parking his cars or leave it to someone less important." 2100

994B "Knights of a Polygonal Table" greedy,implementation,sortings "Unlike Knights of a Round Table, Knights of a Polygonal Table deprived of nobility and happy to kill each other. But each knight has some power and a knight can kill another knight if and only if his power is greater than the power of victim. However, even such a knight will torment his conscience, so he can kill no more than k other knights. Also, each knight has some number of coins. After a kill, a knight can pick up all victim\'s coins.Now each knight ponders: how many coins he can have if only he kills other knights?You should answer this question for each knight." 1400

994A Fingerprints implementation "You are locked in a room with a door that has a keypad with 10 keys corresponding to digits from 0 to 9. To escape from the room, you need to enter a correct code. You also have a sequence of digits.Some keys on the keypad have fingerprints. You believe the correct code is the longest not necessarily contiguous subsequence of the sequence you have that only contains digits with fingerprints on the corresponding keys. Find such code." 800

993F "The Moral Dilemma" NA "Hibiki and Dita are in love with each other, but belong to communities that are in a long lasting conflict. Hibiki is deeply concerned with the state of affairs, and wants to figure out if his relationship with Dita is an act of love or an act of treason.  Hibiki prepared several binary features his decision will depend on, and built a three layer logical circuit on top of them, each layer consisting of one or more logic gates. Each gate in the circuit is either ""or"", ""and"", ""nor"" (not or) or ""nand"" (not and). Each gate in the first layer is connected to exactly two features. Each gate in the second layer is connected to exactly two gates in the first layer. The third layer has only one ""or"" gate, which is connected to all the gates in the second layer (in other words, the entire circuit produces 1 if and only if at least one gate in the second layer produces 1).The problem is, Hibiki knows very well that when the person is in love, his ability to think logically degrades drastically. In particular, it is well known that when a person in love evaluates a logical circuit in his mind, every gate evaluates to a value that is the opposite of what it was supposed to evaluate to. For example, ""or"" gates return 1 if and only if both inputs are zero, ""t{nand}"" gates produce 1 if and only if both inputs are one etc.In particular, the ""or"" gate in the last layer also produces opposite results, and as such if Hibiki is in love, the entire circuit produces 1 if and only if all the gates on the second layer produced 0.Hibiki can\xe2\x80\x99t allow love to affect his decision. He wants to know what is the smallest number of gates that needs to be removed from the second layer so that the output of the circuit for all possible inputs doesn\'t depend on whether Hibiki is in love or not." 3200

993E "Nikita and Order Statistics" "chinese remainder theorem,fft,math" "Nikita likes tasks on order statistics, for example, he can easily find the k-th number in increasing order on a segment of an array. But now Nikita wonders how many segments of an array there are such that a given number x is the k-th number in increasing order on this segment. In other words, you should find the number of segments of a given array such that there are exactly k numbers of this segment which are less than x.Nikita wants to get answer for this question for each k from 0 to n, where n is the size of the array." 2300

993D "Compute Power" "binary search,dp,greedy" "You need to execute several tasks, each associated with number of processors it needs, and the compute power it will consume.You have sufficient number of analog computers, each with enough processors for any task. Each computer can execute up to one task at a time, and no more than two tasks total. The first task can be any, the second task on each computer must use strictly less power than the first. You will assign between 1 and 2 tasks to each computer. You will then first execute the first task on each computer, wait for all of them to complete, and then execute the second task on each computer that has two tasks assigned.If the average compute power per utilized processor (the sum of all consumed powers for all tasks presently running divided by the number of utilized processors) across all computers exceeds some unknown threshold during the execution of the first tasks, the entire system will blow up. There is no restriction on the second tasks execution. Find the lowest threshold for which it is possible.Due to the specifics of the task, you need to print the answer multiplied by 1000 and rounded up." 2500

993C "Careful Maneuvering" "bitmasks,brute force,geometry" "There are two small spaceship, surrounded by two groups of enemy larger spaceships. The space is a two-dimensional plane, and one group of the enemy spaceships is positioned in such a way that they all have integer y-coordinates, and their x-coordinate is equal to \xe2\x88\x92100, while the second group is positioned in such a way that they all have integer y-coordinates, and their x-coordinate is equal to 100.Each spaceship in both groups will simultaneously shoot two laser shots (infinite ray that destroys any spaceship it touches), one towards each of the small spaceships, all at the same time. The small spaceships will be able to avoid all the laser shots, and now want to position themselves at some locations with x=0 (with not necessarily integer y-coordinates), such that the rays shot at them would destroy as many of the enemy spaceships as possible. Find the largest numbers of spaceships that can be destroyed this way, assuming that the enemy spaceships can\'t avoid laser shots." 2100

993B "Open Communication" "bitmasks,brute force" "Two participants are each given a pair of distinct numbers from 1 to 9 such that there\'s exactly one number that is present in both pairs. They want to figure out the number that matches by using a communication channel you have access to without revealing it to you.Both participants communicated to each other a set of pairs of numbers, that includes the pair given to them. Each pair in the communicated sets comprises two different numbers.Determine if you can with certainty deduce the common number, or if you can determine with certainty that both participants know the number but you do not." 1900

993A "Two Squares" geometry,implementation "You are given two squares, one with sides parallel to the coordinate axes, and another one with sides at 45 degrees to the coordinate axes. Find whether the two squares intersect.The interior of the square is considered to be part of the square, i.e. if one square is completely inside another, they intersect. If the two squares only share one common point, they are also considered to intersect." 1600

992E "Nastya and King-Shamans" "binary search,data structures" "Nastya likes reading and even spends whole days in a library sometimes. Today she found a chronicle of Byteland in the library, and it stated that there lived shamans long time ago. It is known that at every moment there was exactly one shaman in Byteland, and there were n shamans in total enumerated with integers from 1 to n in the order they lived. Also, each shaman had a magic power which can now be expressed as an integer.The chronicle includes a list of powers of the n shamans. Also, some shamans can be king-shamans, if they gathered all the power of their predecessors, i.e. their power is exactly the sum of powers of all previous shamans. Nastya is interested in whether there was at least one king-shaman in Byteland.Unfortunately many of the powers are unreadable in the list, so Nastya is doing the following:  Initially she supposes some power for each shaman.  After that she changes the power of some shaman q times (the shamans can differ) and after that wants to check if there is at least one king-shaman in the list. If yes, she wants to know the index of any king-shaman. Unfortunately the list is too large and Nastya wants you to help her." 2500

992D "Nastya and a Game" "brute force,implementation,math" "Nastya received one more array on her birthday, this array can be used to play a traditional Byteland game on it. However, to play the game the players should first select such a subsegment of the array that , where p is the product of all integers on the given array, s is their sum, and k is a given constant for all subsegments. Nastya wonders how many subsegments of the array fit the described conditions. A subsegment of an array is several consecutive integers of the array." 2100

992C "Nastya and a Wardrobe" math "Nastya received a gift on New Year�\xe2\x80\x94 a magic wardrobe. It is magic because in the end of each month the number of dresses in it doubles (i.e. the number of dresses becomes twice as large as it is in the beginning of the month).Unfortunately, right after the doubling the wardrobe eats one of the dresses (if any) with the 50% probability. It happens every month except the last one in the year. Nastya owns x dresses now, so she became interested in the expected number of dresses she will have in one year. Nastya lives in Byteland, so the year lasts for k\xe2\x80\x89+\xe2\x80\x891 months.Nastya is really busy, so she wants you to solve this problem. You are the programmer, after all. Also, you should find the answer modulo 109\xe2\x80\x89+\xe2\x80\x897, because it is easy to see that it is always integer." 1600

992B "Nastya Studies Informatics" "math,number theory" "Today on Informatics class Nastya learned about GCD and LCM (see links below). Nastya is very intelligent, so she solved all the tasks momentarily and now suggests you to solve one of them as well.We define a pair of integers (a,\xe2\x80\x89b) good, if GCD(a,\xe2\x80\x89b)\xe2\x80\x89=\xe2\x80\x89x and LCM(a,\xe2\x80\x89b)\xe2\x80\x89=\xe2\x80\x89y, where GCD(a,\xe2\x80\x89b) denotes the greatest common divisor of a and b, and LCM(a,\xe2\x80\x89b) denotes the least common multiple of a and b.You are given two integers x and y. You are to find the number of good pairs of integers (a,\xe2\x80\x89b) such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. Note that pairs (a,\xe2\x80\x89b) and (b,\xe2\x80\x89a) are considered different if a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b." 1600

992A "Nastya and an Array" implementation,sortings "Nastya owns too many arrays now, so she wants to delete the least important of them. However, she discovered that this array is magic! Nastya now knows that the array has the following properties:  In one second we can add an arbitrary (possibly negative) integer to all elements of the array that are not equal to zero.  When all elements of the array become equal to zero, the array explodes. Nastya is always busy, so she wants to explode the array as fast as possible. Compute the minimum time in which the array can be exploded." 800

991F "Concise and clear" "brute force,greedy,implementation,math" "Vasya is a regular participant at programming contests and is already experienced in finding important sentences in long statements. Of course, numbers constraints are important�\xe2\x80\x94 factorization of a number less than 1000000 is easier than of a number less than 1000000000. However, sometimes it\'s hard to understand the number at the first glance. Could it be shortened? For example, instead of 1000000 you could write 106, instead of 1000000000 �\xe2\x80\x94109, instead of 1000000007�\xe2\x80\x94 109+7.Vasya decided that, to be concise, the notation should follow several rules:   the notation should only consist of numbers, operations of addition (""+""), multiplication (""*"") and exponentiation (""^""), in particular, the use of braces is forbidden;  the use of several exponentiation operations in a row is forbidden, for example, writing ""2^3^4"" is unacceptable;  the value of the resulting expression equals to the initial number;  the notation should consist of the minimal amount of symbols. Given n, find the equivalent concise notation for it." 2700

991E "Bus Number" "brute force,combinatorics,math" "This night wasn\'t easy on Vasya. His favorite team lost, and he didn\'t find himself victorious either�\xe2\x80\x94 although he played perfectly, his teammates let him down every time. He had to win at least one more time, but the losestreak only grew longer and longer... It\'s no wonder he didn\'t get any sleep this night at all.In the morning, Vasya was waiting the bus to the university on the bus stop. Vasya\'s thoughts were hazy and so he couldn\'t remember the right bus\' number quite right and got onto the bus with the number n.In the bus, Vasya thought that he could get the order of the digits in the number of the bus wrong. Futhermore, he could ""see"" some digits several times, but the digits he saw were definitely in the real number of the bus. For example, if Vasya saw the number 2028, it could mean that the real bus number could be 2028, 8022, 2820 or just 820. However, numbers 80, 22208, 52 definitely couldn\'t be the number of the bus. Also, real bus number couldn\'t start with the digit 0, this meaning that, for example, number 082 couldn\'t be the real bus number too.Given n, determine the total number of possible bus number variants." 1800

991D Bishwock dp,greedy "Bishwock is a chess figure that consists of three squares resembling an ""L-bar"". This figure can be rotated by 90, 180 and 270 degrees so it can have four possible states: XX   XX   .X   X.X.   .X   XX   XX Bishwocks don\'t attack any squares and can even occupy on the adjacent squares as long as they don\'t occupy the same square. Vasya has a board with 2\xc3\x97n squares onto which he wants to put some bishwocks. To his dismay, several squares on this board are already occupied by pawns and Vasya can\'t put bishwocks there. However, pawns also don\'t attack bishwocks and they can occupy adjacent squares peacefully.Knowing the positions of pawns on the board, help Vasya to determine the maximum amount of bishwocks he can put onto the board so that they wouldn\'t occupy the same squares and wouldn\'t occupy squares with pawns." 1500

991C Candies "binary search,implementation" "After passing a test, Vasya got himself a box of n candies. He decided to eat an equal amount of candies each morning until there are no more candies. However, Petya also noticed the box and decided to get some candies for himself.This means the process of eating candies is the following: in the beginning Vasya chooses a single integer k, same for all days. After that, in the morning he eats k candies from the box (if there are less than k candies in the box, he eats them all), then in the evening Petya eats 10% of the candies remaining in the box. If there are still candies left in the box, the process repeats�\xe2\x80\x94 next day Vasya eats k candies again, and Petya�\xe2\x80\x94 10% of the candies left in a box, and so on.If the amount of candies in the box is not divisible by 10, Petya rounds the amount he takes from the box down. For example, if there were 97 candies in the box, Petya would eat only 9 of them. In particular, if there are less than 10 candies in a box, Petya won\'t eat any at all.Your task is to find out the minimal amount of k that can be chosen by Vasya so that he would eat at least half of the n candies he initially got. Note that the number k must be integer." 1500

991B "Getting an A" greedy,sortings "Translator\'s note: in Russia\'s most widespread grading system, there are four grades: 5, 4, 3, 2, the higher the better, roughly corresponding to A, B, C and F respectively in American grading system.The term is coming to an end and students start thinking about their grades. Today, a professor told his students that the grades for his course would be given out automatically �\xe2\x80\x94 he would calculate the simple average (arithmetic mean) of all grades given out for lab works this term and round to the nearest integer. The rounding would be done in favour of the student�\xe2\x80\x94 4.5 would be rounded up to 5 (as in example 3), but 4.4 would be rounded down to 4.This does not bode well for Vasya who didn\'t think those lab works would influence anything, so he may receive a grade worse than 5 (maybe even the dreaded 2). However, the professor allowed him to redo some of his works of Vasya\'s choosing to increase his average grade. Vasya wants to redo as as few lab works as possible in order to get 5 for the course. Of course, Vasya will get 5 for the lab works he chooses to redo.Help Vasya�\xe2\x80\x94 calculate the minimum amount of lab works Vasya has to redo." 900

991A "If at first you don\'t succeed..." implementation "Translator\'s note: in Russia\'s most widespread grading system, there are four grades: 5, 4, 3, 2, the higher the better, roughly corresponding to A, B, C and F respectively in American grading system.The term is coming to an end and students start thinking about their grades. Today, a professor told his students that the grades for his course would be given out automatically �\xe2\x80\x94 he would calculate the simple average (arithmetic mean) of all grades given out for lab works this term and round to the nearest integer. The rounding would be done in favour of the student�\xe2\x80\x94 4.5 would be rounded up to 5 (as in example 3), but 4.4 would be rounded down to 4.This does not bode well for Vasya who didn\'t think those lab works would influence anything, so he may receive a grade worse than 5 (maybe even the dreaded 2). However, the professor allowed him to redo some of his works of Vasya\'s choosing to increase his average grade. Vasya wants to redo as as few lab works as possible in order to get 5 for the course. Of course, Vasya will get 5 for the lab works he chooses to redo.Help Vasya�\xe2\x80\x94 calculate the minimum amount of lab works Vasya has to redo." 1000

990G "GCD Counting" "divide and conquer,dp,dsu,number theory,trees" "You are given a tree consisting of n vertices. A number is written on each vertex; the number on vertex i is equal to ai.Let\'s denote the function g(x,y) as the greatest common divisor of the numbers written on the vertices belonging to the simple path from vertex x to vertex y (including these two vertices).For every integer from 1 to 2\xe2\x8b\x85105 you have to count the number of pairs (x,y) (1\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4n) such that g(x,y) is equal to this number." 2400

990F "Flow Control" "dfs and similar,dp,greedy,trees" "You have to handle a very complex water distribution system. The system consists of n junctions and m pipes, i-th pipe connects junctions xi and yi.The only thing you can do is adjusting the pipes. You have to choose m integer numbers f1, f2, ..., fm and use them as pipe settings. i-th pipe will distribute fi units of water per second from junction xi to junction yi (if fi is negative, then the pipe will distribute |fi| units of water per second from junction yi to junction xi). It is allowed to set fi to any integer from \xe2\x88\x922\xe2\x8b\x85109 to 2\xe2\x8b\x85109.In order for the system to work properly, there are some constraints: for every i\xe2\x88\x88[1,n], i-th junction has a number si associated with it meaning that the difference between incoming and outcoming flow for i-th junction must be exactly si (if si is not negative, then i-th junction must receive si units of water per second; if it is negative, then i-th junction must transfer |si| units of water per second to other junctions).Can you choose the integers f1, f2, ..., fm in such a way that all requirements on incoming and outcoming flows are satisfied?" 2400

990E "Post Lamps" "brute force,greedy" "Adilbek\'s house is located on a street which can be represented as the OX axis. This street is really dark, so Adilbek wants to install some post lamps to illuminate it. Street has n positions to install lamps, they correspond to the integer numbers from 0 to n\xe2\x88\x921 on the OX axis. However, some positions are blocked and no post lamp can be placed there.There are post lamps of different types which differ only by their power. When placed in position x, post lamp of power l illuminates the segment [x;x+l]. The power of each post lamp is always a positive integer number.The post lamp shop provides an infinite amount of lamps of each type from power 1 to power k. Though each customer is only allowed to order post lamps of exactly one type. Post lamps of power l cost al each.What is the minimal total cost of the post lamps of exactly one type Adilbek can buy to illuminate the entire segment [0;n] of the street? If some lamps illuminate any other segment of the street, Adilbek does not care, so, for example, he may place a lamp of power 3 in position n\xe2\x88\x921 (even though its illumination zone doesn\'t completely belong to segment [0;n])." 2100

990D "Graph And Its Complement" "constructive algorithms,graphs,implementation" "Given three numbers n,a,b. You need to find an adjacency matrix of such an undirected graph that the number of components in it is equal to a, and the number of components in its complement is b. The matrix must be symmetric, and all digits on the main diagonal must be zeroes.In an undirected graph loops (edges from a vertex to itself) are not allowed. It can be at most one edge between a pair of vertices.The adjacency matrix of an undirected graph is a square matrix of size n consisting only of ""0"" and ""1"", where n is the number of vertices of the graph and the i-th row and the i-th column correspond to the i-th vertex of the graph. The cell (i,j) of the adjacency matrix contains 1 if and only if the i-th and j-th vertices in the graph are connected by an edge.A connected component is a set of vertices X such that for every two vertices from this set there exists at least one path in the graph connecting this pair of vertices, but adding any other vertex to X violates this rule.The complement or inverse of a graph G is a graph H on the same vertices such that two distinct vertices of H are adjacent if and only if they are not adjacent in G." 1700

990C "Bracket Sequences Concatenation Problem" implementation "A bracket sequence is a string containing only characters ""("" and "")"".A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, bracket sequences ""()()"", ""(())"" are regular (the resulting expressions are: ""(1)+(1)"", ""((1+1)+1)""), and "")("" and ""("" are not.You are given n bracket sequences s1,s2,\xe2\x80\xa6,sn. Calculate the number of pairs i,j(1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that the bracket sequence si+sj is a regular bracket sequence. Operation + means concatenation i.e. ""()("" + "")()"" = ""()()()"".If si+sj and sj+si are regular bracket sequences and i\xe2\x89\xa0j, then both pairs (i,j) and (j,i) must be counted in the answer. Also, if si+si is a regular bracket sequence, the pair (i,i) must be counted in the answer." 1500

990B Micro-World greedy,sortings "You have a Petri dish with bacteria and you are preparing to dive into the harsh micro-world. But, unfortunately, you don\'t have any microscope nearby, so you can\'t watch them.You know that you have n bacteria in the Petri dish and size of the i-th bacteria is ai. Also you know intergalactic positive integer constant K.The i-th bacteria can swallow the j-th bacteria if and only if ai>aj and ai\xe2\x89\xa4aj+K. The j-th bacteria disappear, but the i-th bacteria doesn\'t change its size. The bacteria can perform multiple swallows. On each swallow operation any bacteria i can swallow any bacteria j if ai>aj and ai\xe2\x89\xa4aj+K. The swallow operations go one after another.For example, the sequence of bacteria sizes a=[101,53,42,102,101,55,54] and K=1. The one of possible sequences of swallows is: [101,53,42,102,101_,55,54] \xe2\x86\x92 [101,53_,42,102,55,54] \xe2\x86\x92 [101_,42,102,55,54] \xe2\x86\x92 [42,102,55,54_] \xe2\x86\x92 [42,102,55]. In total there are 3 bacteria remained in the Petri dish.Since you don\'t have a microscope, you can only guess, what the minimal possible number of bacteria can remain in your Petri dish when you finally will find any microscope." 1200

990A "Commentary Boxes" implementation,math "Berland Football Cup starts really soon! Commentators from all over the world come to the event.Organizers have already built n commentary boxes. m regional delegations will come to the Cup. Every delegation should get the same number of the commentary boxes. If any box is left unoccupied then the delegations will be upset. So each box should be occupied by exactly one delegation.If n is not divisible by m, it is impossible to distribute the boxes to the delegations at the moment.Organizers can build a new commentary box paying a burles and demolish a commentary box paying b burles. They can both build and demolish boxes arbitrary number of times (each time paying a corresponding fee). It is allowed to demolish all the existing boxes.What is the minimal amount of burles organizers should pay to satisfy all the delegations (i.e. to make the number of the boxes be divisible by m)?" 1000

989E "A Trance of Nightfall" dp,geometry,matrices,probabilities "The cool breeze blows gently, the flowing water ripples steadily.""Flowing and passing like this, the water isn\'t gone ultimately; Waxing and waning like that, the moon doesn\'t shrink or grow eventually.""""Everything is transient in a way and perennial in another.""Kanno doesn\'t seem to make much sense out of Mino\'s isolated words, but maybe it\'s time that they enjoy the gentle breeze and the night sky�\xe2\x80\x94 the inexhaustible gifts from nature.Gazing into the sky of stars, Kanno indulges in a night\'s tranquil dreams. There is a set SS of nn points on a coordinate plane.Kanno starts from a point PP that can be chosen on the plane. PP is not added to SS if it doesn\'t belong to SS. Then the following sequence of operations (altogether called a move) is repeated several times, in the given order:  Choose a line ll such that it passes through at least two elements in SS and passes through Kanno\'s current position. If there are multiple such lines, one is chosen equiprobably.  Move to one of the points that belong to SS and lie on ll. The destination is chosen equiprobably among all possible ones, including Kanno\'s current position (if it does belong to SS). There are qq queries each consisting of two integers (ti,mi)(ti,mi). For each query, you\'re to help Kanno maximize the probability of the stopping position being the titi-th element in SS after mimi moves with a proper selection of PP, and output this maximum probability. Note that according to rule 1, PP should belong to at least one line that passes through at least two points from SS." 2700

989D "A Shade of Moonlight" "binary search,geometry,math,sortings,two pointers" "Gathering darkness shrouds the woods and the world. The moon sheds its light on the boat and the river.""To curtain off the moonlight should be hardly possible; the shades present its mellow beauty and restful nature."" Intonates Mino.""See? The clouds are coming."" Kanno gazes into the distance.""That can\'t be better,"" Mino turns to Kanno. The sky can be seen as a one-dimensional axis. The moon is at the origin whose coordinate is 0.There are n clouds floating in the sky. Each cloud has the same length l. The i-th initially covers the range of (xi,xi+l) (endpoints excluded). Initially, it moves at a velocity of vi, which equals either 1 or \xe2\x88\x921.Furthermore, no pair of clouds intersect initially, that is, for all 1\xe2\x89\xa4i<j\xe2\x89\xa4n, |xi\xe2\x88\x92xj|\xe2\x89\xa5l.With a wind velocity of w, the velocity of the i-th cloud becomes vi+w. That is, its coordinate increases by vi+w during each unit of time. Note that the wind can be strong and clouds can change their direction.You are to help Mino count the number of pairs (i,j) (i<j), such that with a proper choice of wind velocity w not exceeding wmax in absolute value (possibly negative and/or fractional), the i-th and j-th clouds both cover the moon at the same future moment. This w doesn\'t need to be the same across different pairs." 2500

989C "A Mist of Florescence" "constructive algorithms,graphs" "As the boat drifts down the river, a wood full of blossoms shows up on the riverfront.""I\'ve been here once,"" Mino exclaims with delight, ""it\'s breathtakingly amazing.""""What is it like?""""Look, Kanno, you\'ve got your paintbrush, and I\'ve got my words. Have a try, shall we?"" There are four kinds of flowers in the wood, Amaranths, Begonias, Centaureas and Dianthuses.The wood can be represented by a rectangular grid of n rows and m columns. In each cell of the grid, there is exactly one type of flowers.According to Mino, the numbers of connected components formed by each kind of flowers are a, b, c and d respectively. Two cells are considered in the same connected component if and only if a path exists between them that moves between cells sharing common edges and passes only through cells containing the same flowers.You are to help Kanno depict such a grid of flowers, with n and m arbitrarily chosen under the constraints given below. It can be shown that at least one solution exists under the constraints of this problem.Note that you can choose arbitrary n and m under the constraints below, they are not given in the input." 1800

989B "A Tide of Riverscape" "constructive algorithms,strings" "Walking along a riverside, Mino silently takes a note of something.""Time,"" Mino thinks aloud.""What?""""Time and tide wait for no man,"" explains Mino. ""My name, taken from the river, always reminds me of this.""""And what are you recording?""""You see it, tide. Everything has its own period, and I think I\'ve figured out this one,"" says Mino with confidence.Doubtfully, Kanno peeks at Mino\'s records. The records are expressed as a string s of characters \'0\', \'1\' and \'.\', where \'0\' denotes a low tide, \'1\' denotes a high tide, and \'.\' denotes an unknown one (either high or low).You are to help Mino determine whether it\'s possible that after replacing each \'.\' independently with \'0\' or \'1\', a given integer p is not a period of the resulting string. In case the answer is yes, please also show such a replacement to Mino.In this problem, a positive integer p is considered a period of string s, if for all 1\xe2\x89\xa4i\xe2\x89\xa4|s|\xe2\x88\x92p, the i-th and (i+p)-th characters of s are the same. Here |s| is the length of s." 1200

989A "A Blend of Springtime" implementation,strings "When the curtains are opened, a canvas unfolds outside. Kanno marvels at all the blonde colours along the riverside�\xe2\x80\x94 not tangerines, but blossoms instead.""What a pity it\'s already late spring,"" sighs Mino with regret, ""one more drizzling night and they\'d be gone.""""But these blends are at their best, aren\'t they?"" Absorbed in the landscape, Kanno remains optimistic. The landscape can be expressed as a row of consecutive cells, each of which either contains a flower of colour amber or buff or canary yellow, or is empty.When a flower withers, it disappears from the cell that it originally belonged to, and it spreads petals of its colour in its two neighbouring cells (or outside the field if the cell is on the side of the landscape). In case petals fall outside the given cells, they simply become invisible.You are to help Kanno determine whether it\'s possible that after some (possibly none or all) flowers shed their petals, at least one of the cells contains all three colours, considering both petals and flowers. Note that flowers can wither in arbitrary order." 900

988F "Rain and Umbrellas" dp "Polycarp lives on a coordinate line at the point x=0. He goes to his friend that lives at the point x=a. Polycarp can move only from left to right, he can pass one unit of length each second.Now it\'s raining, so some segments of his way are in the rain. Formally, it\'s raining on n non-intersecting segments, the i-th segment which is in the rain is represented as [li,ri] (0\xe2\x89\xa4li<ri\xe2\x89\xa4a).There are m umbrellas lying on the line, the i-th umbrella is located at point xi (0\xe2\x89\xa4xi\xe2\x89\xa4a) and has weight pi. When Polycarp begins his journey, he doesn\'t have any umbrellas.During his journey from x=0 to x=a Polycarp can pick up and throw away umbrellas. Polycarp picks up and throws down any umbrella instantly. He can carry any number of umbrellas at any moment of time. Because Polycarp doesn\'t want to get wet, he must carry at least one umbrella while he moves from x to x+1 if a segment [x,x+1] is in the rain (i.e. if there exists some i such that li\xe2\x89\xa4x and x+1\xe2\x89\xa4ri).The condition above is the only requirement. For example, it is possible to go without any umbrellas to a point where some rain segment starts, pick up an umbrella at this point and move along with an umbrella. Polycarp can swap umbrellas while he is in the rain.Each unit of length passed increases Polycarp\'s fatigue by the sum of the weights of umbrellas he carries while moving.Can Polycarp make his way from point x=0 to point x=a? If yes, find the minimum total fatigue after reaching x=a, if Polycarp picks up and throws away umbrellas optimally." 2100

988E "Divisibility by 25" "brute force,greedy" "You are given an integer n from 1 to 1018 without leading zeroes.In one move you can swap any two adjacent digits in the given number in such a way that the resulting number will not contain leading zeroes. In other words, after each move the number you have cannot contain any leading zeroes.What is the minimum number of moves you have to make to obtain a number that is divisible by 25? Print -1 if it is impossible to obtain a number that is divisible by 25." 2100

988D "Points and Powers of Two" "brute force,math" "There are n distinct points on a coordinate line, the coordinate of i-th point equals to xi. Choose a subset of the given set of points such that the distance between each pair of points in a subset is an integral power of two. It is necessary to consider each pair of points, not only adjacent. Note that any subset containing one element satisfies the condition above. Among all these subsets, choose a subset with maximum possible size.In other words, you have to choose the maximum possible number of points xi1,xi2,\xe2\x80\xa6,xim such that for each pair xij, xik it is true that |xij\xe2\x88\x92xik|=2d where d is some non-negative integer number (not necessarily the same for each pair of points)." 1800

988C "Equal Sums" implementation,sortings "You are given k sequences of integers. The length of the i-th sequence equals to ni.You have to choose exactly two sequences i and j (i\xe2\x89\xa0j) such that you can remove exactly one element in each of them in such a way that the sum of the changed sequence i (its length will be equal to ni\xe2\x88\x921) equals to the sum of the changed sequence j (its length will be equal to nj\xe2\x88\x921).Note that it\'s required to remove exactly one element in each of the two chosen sequences.Assume that the sum of the empty (of the length equals 0) sequence is 0." 1400

988B "Substrings Sort" sortings,strings "You are given n strings. Each string consists of lowercase English letters. Rearrange (reorder) the given strings in such a way that for every string, all strings that are placed before it are its substrings.String a is a substring of string b if it is possible to choose several consecutive letters in b in such a way that they form a. For example, string ""for"" is contained as a substring in strings ""codeforces"", ""for"" and ""therefore"", but is not contained as a substring in strings ""four"", ""fofo"" and ""rof""." 1100

988A "Diverse Team" "brute force,implementation" "There are n students in a school class, the rating of the i-th student on Codehorses is ai. You have to form a team consisting of k students (1\xe2\x89\xa4k\xe2\x89\xa4n) such that the ratings of all team members are distinct.If it is impossible to form a suitable team, print ""NO"" (without quotes). Otherwise print ""YES"", and then print k distinct numbers which should be the indices of students in the team you form. If there are multiple answers, print any of them." 800

987C "Three displays" "brute force,dp,implementation" "It is the middle of 2018 and Maria Stepanovna, who lives outside Krasnokamensk (a town in Zabaikalsky region), wants to rent three displays to highlight an important problem.There are n displays placed along a road, and the i-th of them can display a text with font size si only. Maria Stepanovna wants to rent such three displays with indices i<j<k that the font size increases if you move along the road in a particular direction. Namely, the condition si<sj<sk should be held.The rent cost is for the i-th display is ci. Please determine the smallest cost Maria Stepanovna should pay." 1400

987B "High School: Become Human" math "Year 2118. Androids are in mass production for decades now, and they do all the work for humans. But androids have to go to school to be able to solve creative tasks. Just like humans before.It turns out that high school struggles are not gone. If someone is not like others, he is bullied. Vasya-8800 is an economy-class android which is produced by a little-known company. His design is not perfect, his characteristics also could be better. So he is bullied by other androids.One of the popular pranks on Vasya is to force him to compare xy with yx. Other androids can do it in milliseconds while Vasya\'s memory is too small to store such big numbers.Please help Vasya! Write a fast program to compare xy with yx for Vasya, maybe then other androids will respect him." 1100

987A "Infinity Gauntlet" implementation "You took a peek on Thanos wearing Infinity Gauntlet. In the Gauntlet there is a place for six Infinity Gems:  the Power Gem of purple color,  the Time Gem of green color,  the Space Gem of blue color,  the Soul Gem of orange color,  the Reality Gem of red color,  the Mind Gem of yellow color. Using colors of Gems you saw in the Gauntlet determine the names of absent Gems." 800

986F "Oppa Funcan Style Remastered" "graphs,math,number theory,shortest paths" "Surely you have seen insane videos by South Korean rapper PSY, such as ""Gangnam Style"", ""Gentleman"" and ""Daddy"". You might also hear that PSY has been recording video ""Oppa Funcan Style"" two years ago (unfortunately we couldn\'t find it on the internet). We will remind you what this hit looked like (you can find original description here):On the ground there are n platforms, which are numbered with integers from 1 to n, on i-th platform there is a dancer with number i. Further, every second all the dancers standing on the platform with number i jump to the platform with the number f(i). The moving rule f is selected in advance and is not changed throughout the clip.The duration of the clip was k seconds and the rule f was chosen in such a way that after k seconds all dancers were in their initial positions (i.e. the i-th dancer stood on the platform with the number i). That allowed to loop the clip and collect even more likes.PSY knows that enhanced versions of old artworks become more and more popular every day. So he decided to release a remastered-version of his video.In his case ""enhanced version"" means even more insanity, so the number of platforms can be up to 1018! But the video director said that if some dancer stays on the same platform all the time, then the viewer will get bored and will turn off the video immediately. Therefore, for all x from 1 to n f(x)\xe2\x89\xa0x must hold.Big part of classic video\'s success was in that looping, so in the remastered version all dancers should return to their initial positions in the end of the clip as well.PSY hasn\'t decided on the exact number of platforms and video duration yet, so he asks you to check if there is a good rule f for different options." 3300

986E "Prince\'s Problem" "brute force,data structures,math,number theory,trees" "Surely you have seen insane videos by South Korean rapper PSY, such as ""Gangnam Style"", ""Gentleman"" and ""Daddy"". You might also hear that PSY has been recording video ""Oppa Funcan Style"" two years ago (unfortunately we couldn\'t find it on the internet). We will remind you what this hit looked like (you can find original description here):On the ground there are n platforms, which are numbered with integers from 1 to n, on i-th platform there is a dancer with number i. Further, every second all the dancers standing on the platform with number i jump to the platform with the number f(i). The moving rule f is selected in advance and is not changed throughout the clip.The duration of the clip was k seconds and the rule f was chosen in such a way that after k seconds all dancers were in their initial positions (i.e. the i-th dancer stood on the platform with the number i). That allowed to loop the clip and collect even more likes.PSY knows that enhanced versions of old artworks become more and more popular every day. So he decided to release a remastered-version of his video.In his case ""enhanced version"" means even more insanity, so the number of platforms can be up to 1018! But the video director said that if some dancer stays on the same platform all the time, then the viewer will get bored and will turn off the video immediately. Therefore, for all x from 1 to n f(x)\xe2\x89\xa0x must hold.Big part of classic video\'s success was in that looping, so in the remastered version all dancers should return to their initial positions in the end of the clip as well.PSY hasn\'t decided on the exact number of platforms and video duration yet, so he asks you to check if there is a good rule f for different options." 2800

986D "Perfect Encoding" fft,math "You are working as an analyst in a company working on a new system for big data storage. This system will store n different objects. Each object should have a unique ID.To create the system, you choose the parameters of the system�\xe2\x80\x94 integers m\xe2\x89\xa51 and b1,b2,\xe2\x80\xa6,bm. With these parameters an ID of some object in the system is an array of integers [a1,a2,\xe2\x80\xa6,am] where 1\xe2\x89\xa4ai\xe2\x89\xa4bi holds for every 1\xe2\x89\xa4i\xe2\x89\xa4m.Developers say that production costs are proportional to \xe2\x88\x91mi=1bi. You are asked to choose parameters m and bi so that the system will be able to assign unique IDs to n different objects and production costs are minimized. Note that you don\'t have to use all available IDs." 3100

986C "AND Graph" "bitmasks,dfs and similar,dsu,graphs" "You are given a set of size m with integer elements between 0 and 2n\xe2\x88\x921 inclusive. Let\'s build an undirected graph on these integers in the following way: connect two integers x and y with an edge if and only if x&y=0. Here & is the bitwise AND operation. Count the number of connected components in that graph." 2500

986B "Petr and Permutations" combinatorics,math "Petr likes to come up with problems about randomly generated data. This time problem is about random permutation. He decided to generate a random permutation this way: he takes identity permutation of numbers from 1 to n and then 3n times takes a random pair of different elements and swaps them. Alex envies Petr and tries to imitate him in all kind of things. Alex has also come up with a problem about random permutation. He generates a random permutation just like Petr but swaps elements 7n+1 times instead of 3n times. Because it is more random, OK?!You somehow get a test from one of these problems and now you want to know from which one." 1800

986A Fair "graphs,greedy,number theory,shortest paths" "Some company is going to hold a fair in Byteland. There are n towns in Byteland and m two-way roads between towns. Of course, you can reach any town from any other town using roads.There are k types of goods produced in Byteland and every town produces only one type. To hold a fair you have to bring at least s different types of goods. It costs d(u,v) coins to bring goods from town u to town v where d(u,v) is the length of the shortest path from u to v. Length of a path is the number of roads in this path.The organizers will cover all travel expenses but they can choose the towns to bring goods from. Now they want to calculate minimum expenses to hold a fair in each of n towns." 1600

985G "Team Players" combinatorics "There are n players numbered from 0 to n\xe2\x88\x921 with ranks. The i-th player has rank i.Players can form teams: the team should consist of three players and no pair of players in the team should have a conflict. The rank of the team is calculated using the following algorithm: let i, j, k be the ranks of players in the team and i<j<k, then the rank of the team is equal to A\xe2\x8b\x85i+B\xe2\x8b\x85j+C\xe2\x8b\x85k.You are given information about the pairs of players who have a conflict. Calculate the total sum of ranks over all possible valid teams modulo 264." 2700

985F "Isomorphic Strings" hashing,strings "You are given a string s of length n consisting of lowercase English letters.For two given strings s and t, say S is the set of distinct characters of s and T is the set of distinct characters of t. The strings s and t are isomorphic if their lengths are equal and there is a one-to-one mapping (bijection) f between S and T for which f(si)\xe2\x80\x89=\xe2\x80\x89ti. Formally:  f(si)\xe2\x80\x89=\xe2\x80\x89ti for any index i,  for any character  there is exactly one character  that f(x)\xe2\x80\x89=\xe2\x80\x89y,  for any character  there is exactly one character  that f(x)\xe2\x80\x89=\xe2\x80\x89y. For example, the strings ""aababc"" and ""bbcbcz"" are isomorphic. Also the strings ""aaaww"" and ""wwwaa"" are isomorphic. The following pairs of strings are not isomorphic: ""aab"" and ""bbb"", ""test"" and ""best"".You have to handle m queries characterized by three integers x,\xe2\x80\x89y,\xe2\x80\x89len (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89len\xe2\x80\x89+\xe2\x80\x891). For each query check if two substrings s[x... x\xe2\x80\x89+\xe2\x80\x89len\xe2\x80\x89-\xe2\x80\x891] and s[y... y\xe2\x80\x89+\xe2\x80\x89len\xe2\x80\x89-\xe2\x80\x891] are isomorphic." 2300

985E "Pencils and Boxes" "binary search,data structures,dp,greedy,two pointers" "Mishka received a gift of multicolored pencils for his birthday! Unfortunately he lives in a monochrome world, where everything is of the same color and only saturation differs. This pack can be represented as a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n integer numbers \xe2\x80\x94 saturation of the color of each pencil. Now Mishka wants to put all the mess in the pack in order. He has an infinite number of empty boxes to do this. He would like to fill some boxes in such a way that:  Each pencil belongs to exactly one box;  Each non-empty box has at least k pencils in it;  If pencils i and j belong to the same box, then |ai\xe2\x80\x89-\xe2\x80\x89aj|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d, where |x| means absolute value of x. Note that the opposite is optional, there can be pencils i and j such that |ai\xe2\x80\x89-\xe2\x80\x89aj|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d and they belong to different boxes. Help Mishka to determine if it\'s possible to distribute all the pencils into boxes. Print ""YES"" if there exists such a distribution. Otherwise print ""NO""." 2100

985D "Sand Fortress" "binary search,constructive algorithms,math" "You are going to the beach with the idea to build the greatest sand castle ever in your head! The beach is not as three-dimensional as you could have imagined, it can be decribed as a line of spots to pile up sand pillars. Spots are numbered 1 through infinity from left to right. Obviously, there is not enough sand on the beach, so you brought n packs of sand with you. Let height hi of the sand pillar on some spot i be the number of sand packs you spent on it. You can\'t split a sand pack to multiple pillars, all the sand from it should go to a single one. There is a fence of height equal to the height of pillar with H sand packs to the left of the first spot and you should prevent sand from going over it. Finally you ended up with the following conditions to building the castle:  h1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89H: no sand from the leftmost spot should go over the fence;  For any  |hi\xe2\x80\x89-\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891: large difference in heights of two neighboring pillars can lead sand to fall down from the higher one to the lower, you really don\'t want this to happen;  : you want to spend all the sand you brought with you. As you have infinite spots to build, it is always possible to come up with some valid castle structure. Though you want the castle to be as compact as possible. Your task is to calculate the minimum number of spots you can occupy so that all the aforementioned conditions hold." 2100

985C "Liebig\'s Barrels" greedy "You are going to the beach with the idea to build the greatest sand castle ever in your head! The beach is not as three-dimensional as you could have imagined, it can be decribed as a line of spots to pile up sand pillars. Spots are numbered 1 through infinity from left to right. Obviously, there is not enough sand on the beach, so you brought n packs of sand with you. Let height hi of the sand pillar on some spot i be the number of sand packs you spent on it. You can\'t split a sand pack to multiple pillars, all the sand from it should go to a single one. There is a fence of height equal to the height of pillar with H sand packs to the left of the first spot and you should prevent sand from going over it. Finally you ended up with the following conditions to building the castle:  h1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89H: no sand from the leftmost spot should go over the fence;  For any  |hi\xe2\x80\x89-\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891: large difference in heights of two neighboring pillars can lead sand to fall down from the higher one to the lower, you really don\'t want this to happen;  : you want to spend all the sand you brought with you. As you have infinite spots to build, it is always possible to come up with some valid castle structure. Though you want the castle to be as compact as possible. Your task is to calculate the minimum number of spots you can occupy so that all the aforementioned conditions hold." 1500

985B "Switches and Lamps" implementation "You are given n switches and m lamps. The i-th switch turns on some subset of the lamps. This information is given as the matrix a consisting of n rows and m columns where ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x891 if the i-th switch turns on the j-th lamp and ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x890 if the i-th switch is not connected to the j-th lamp.Initially all m lamps are turned off.Switches change state only from ""off"" to ""on"". It means that if you press two or more switches connected to the same lamp then the lamp will be turned on after any of this switches is pressed and will remain its state even if any switch connected to this lamp is pressed afterwards.It is guaranteed that if you push all n switches then all m lamps will be turned on.Your think that you have too many switches and you would like to ignore one of them. Your task is to say if there exists such a switch that if you will ignore (not use) it but press all the other n\xe2\x80\x89-\xe2\x80\x891 switches then all the m lamps will be turned on." 1200

985A "Chess Placing" implementation "You are given a chessboard of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n. It is guaranteed that n is even. The chessboard is painted like this: ""BWBW...BW"".Some cells of the board are occupied by the chess pieces. Each cell contains no more than one chess piece. It is known that the total number of pieces equals to .In one step you can move one of the pieces one cell to the left or to the right. You cannot move pieces beyond the borders of the board. You also cannot move pieces to the cells that are already occupied.Your task is to place all the pieces in the cells of the same color using the minimum number of moves (all the pieces must occupy only the black cells or only the white cells after all the moves are made)." 1100

984B Minesweeper implementation "One day Alex decided to remember childhood when computers were not too powerful and lots of people played only default games. Alex enjoyed playing Minesweeper that time. He imagined that he saved world from bombs planted by terrorists, but he rarely won.Alex has grown up since then, so he easily wins the most difficult levels. This quickly bored him, and he thought: what if the computer gave him invalid fields in the childhood and Alex could not win because of it?He needs your help to check it.A Minesweeper field is a rectangle n\xc3\x97m, where each cell is either empty, or contains a digit from 1 to 8, or a bomb. The field is valid if for each cell:   if there is a digit k in the cell, then exactly k neighboring cells have bombs.  if the cell is empty, then all neighboring cells have no bombs. Two cells are neighbors if they have a common side or a corner (i.�e. a cell has at most 8 neighboring cells)." 1100

984A Game sortings "Two players play a game.Initially there are n integers a1,a2,\xe2\x80\xa6,an written on the board. Each turn a player selects one number and erases it from the board. This continues until there is only one number left on the board, i.�e. n\xe2\x88\x921 turns are made. The first player makes the first move, then players alternate turns.The first player wants to minimize the last number that would be left on the board, while the second player wants to maximize it.You want to know what number will be left on the board after n\xe2\x88\x921 turns if both players make optimal moves." 800

983E "NN country" "binary search,data structures,trees" "In the NN country, there are n cities, numbered from 1 to n, and n\xe2\x88\x921 roads, connecting them. There is a roads path between any two cities.There are m bidirectional bus routes between cities. Buses drive between two cities taking the shortest path with stops in every city they drive through. Travelling by bus, you can travel from any stop on the route to any other. You can travel between cities only by bus.You are interested in q questions: is it possible to get from one city to another and what is the minimum number of buses you need to use for it?" 2800

983D "Arkady and Rectangles" "data structures" "Arkady has got an infinite plane painted in color 00. Then he draws nn rectangles filled with paint with sides parallel to the Cartesian coordinate axes, one after another. The color of the ii-th rectangle is ii (rectangles are enumerated from 11 to nn in the order he draws them). It is possible that new rectangles cover some of the previous ones completely or partially.Count the number of different colors on the plane after Arkady draws all the rectangles." 3300

983C Elevator "dp,graphs,shortest paths" "You work in a big office. It is a 9�floor building with an elevator that can accommodate up to 4�people. It is your responsibility to manage this elevator.Today you are late, so there are queues on some floors already. For each person you know the floor where he currently is and the floor he wants to reach. Also, you know the order in which people came to the elevator.According to the company\'s rules, if an employee comes to the elevator earlier than another one, he has to enter the elevator earlier too (even if these employees stay on different floors). Note that the employees are allowed to leave the elevator in arbitrary order.The elevator has two commands:   Go up or down one floor. The movement takes 1 second.  Open the doors on the current floor. During this operation all the employees who have reached their destination get out of the elevator. Then all the employees on the floor get in the elevator in the order they are queued up while it doesn\'t contradict the company\'s rules and there is enough space in the elevator. Each employee spends 1 second to get inside and outside the elevator. Initially the elevator is empty and is located on the floor 1.You are interested what is the minimum possible time you need to spend to deliver all the employees to their destination. It is not necessary to return the elevator to the floor 1." 2400

983B XOR-pyramid dp "For an array b of length m we define the function f as  f(b)={b[1]if�m=1f(b[1]\xe2\x8a\x95b[2],b[2]\xe2\x8a\x95b[3],\xe2\x80\xa6,b[m\xe2\x88\x921]\xe2\x8a\x95b[m])otherwise, where \xe2\x8a\x95 is bitwise exclusive OR.For example, f(1,2,4,8)=f(1\xe2\x8a\x952,2\xe2\x8a\x954,4\xe2\x8a\x958)=f(3,6,12)=f(3\xe2\x8a\x956,6\xe2\x8a\x9512)=f(5,10)=f(5\xe2\x8a\x9510)=f(15)=15You are given an array a and a few queries. Each query is represented as two integers l and r. The answer is the maximum value of f on all continuous subsegments of the array al,al+1,\xe2\x80\xa6,ar." 1800

983A "Finite or not?" implementation,math "You are given several queries. Each query consists of three integers p, q and b. You need to answer whether the result of p/q in notation with base b is a finite fraction.A fraction in notation with base b is finite if it contains finite number of numerals after the decimal point. It is also possible that a fraction has zero numerals after the decimal point." 1700

982F "The Meeting Place Cannot Be Changed" "dfs and similar,graphs" "Petr is a detective in Braginsk. Somebody stole a huge amount of money from a bank and Petr is to catch him. Somebody told Petr that some luxurious car moves along the roads without stopping.Petr knows that it is the robbers who drive the car. The roads in Braginsk are one-directional and each of them connects two intersections. Petr wants to select one intersection such that if the robbers continue to drive the roads indefinitely, they will sooner or later come to that intersection. The initial position of the robbers is unknown. Find such an intersection that fits the requirements." 2700

982E Billiard "geometry,number theory" "Consider a billiard table of rectangular size n\xc3\x97mn\xc3\x97m with four pockets. Let\'s introduce a coordinate system with the origin at the lower left corner (see the picture).   There is one ball at the point (x,y)(x,y) currently. Max comes to the table and strikes the ball. The ball starts moving along a line that is parallel to one of the axes or that makes a 45\xe2\x88\x9845\xe2\x88\x98 angle with them. We will assume that:   the angles between the directions of the ball before and after a collision with a side are equal,  the ball moves indefinitely long, it only stops when it falls into a pocket,  the ball can be considered as a point, it falls into a pocket if and only if its coordinates coincide with one of the pockets,  initially the ball is not in a pocket. Note that the ball can move along some side, in this case the ball will just fall into the pocket at the end of the side.Your task is to determine whether the ball will fall into a pocket eventually, and if yes, which of the four pockets it will be." 2600

982D Shark "brute force,data structures,dsu,trees" "For long time scientists study the behavior of sharks. Sharks, as many other species, alternate short movements in a certain location and long movements between locations.Max is a young biologist. For n days he watched a specific shark, and now he knows the distance the shark traveled in each of the days. All the distances are distinct. Max wants to know now how many locations the shark visited. He assumed there is such an integer k that if the shark in some day traveled the distance strictly less than k, then it didn\'t change the location; otherwise, if in one day the shark traveled the distance greater than or equal to k; then it was changing a location in that day. Note that it is possible that the shark changed a location for several consecutive days, in each of them the shark traveled the distance at least k.The shark never returned to the same location after it has moved from it. Thus, in the sequence of n days we can find consecutive nonempty segments when the shark traveled the distance less than k in each of the days: each such segment corresponds to one location. Max wants to choose such k that the lengths of all such segments are equal.Find such integer k, that the number of locations is as large as possible. If there are several such k, print the smallest one." 1900

982C "Cut \'em all!" "dfs and similar,dp,graphs,greedy,trees" "For long time scientists study the behavior of sharks. Sharks, as many other species, alternate short movements in a certain location and long movements between locations.Max is a young biologist. For n days he watched a specific shark, and now he knows the distance the shark traveled in each of the days. All the distances are distinct. Max wants to know now how many locations the shark visited. He assumed there is such an integer k that if the shark in some day traveled the distance strictly less than k, then it didn\'t change the location; otherwise, if in one day the shark traveled the distance greater than or equal to k; then it was changing a location in that day. Note that it is possible that the shark changed a location for several consecutive days, in each of them the shark traveled the distance at least k.The shark never returned to the same location after it has moved from it. Thus, in the sequence of n days we can find consecutive nonempty segments when the shark traveled the distance less than k in each of the days: each such segment corresponds to one location. Max wants to choose such k that the lengths of all such segments are equal.Find such integer k, that the number of locations is as large as possible. If there are several such k, print the smallest one." 1500

982B "Bus of Characters" "data structures,greedy,implementation" "In the Bus of Characters there are n rows of seat, each having 2 seats. The width of both seats in the i-th row is wi centimeters. All integers wi are distinct.Initially the bus is empty. On each of 2n stops one passenger enters the bus. There are two types of passengers:   an introvert always chooses a row where both seats are empty. Among these rows he chooses the one with the smallest seats width and takes one of the seats in it;  an extrovert always chooses a row where exactly one seat is occupied (by an introvert). Among these rows he chooses the one with the largest seats width and takes the vacant place in it. You are given the seats width in each row and the order the passengers enter the bus. Determine which row each passenger will take." 1300

982A Row "brute force,constructive algorithms" "You\'re given a row with n chairs. We call a seating of people ""maximal"" if the two following conditions hold:  There are no neighbors adjacent to anyone seated.  It\'s impossible to seat one more person without violating the first rule. The seating is given as a string consisting of zeros and ones (0 means that the corresponding seat is empty, 1 \xe2\x80\x94 occupied). The goal is to determine whether this seating is ""maximal"".Note that the first and last seats are not adjacent (if n\xe2\x89\xa02)." 1200

981H "K Paths" "combinatorics,data structures,dp,fft,math" "You are given a tree of n vertices. You are to select k (not necessarily distinct) simple paths in such a way that it is possible to split all edges of the tree into three sets: edges not contained in any path, edges that are a part of exactly one of these paths, and edges that are parts of all selected paths, and the latter set should be non-empty.Compute the number of ways to select k paths modulo 998244353.The paths are enumerated, in other words, two ways are considered distinct if there are such i (1\xe2\x89\xa4i\xe2\x89\xa4k) and an edge that the i-th path contains the edge in one way and does not contain it in the other." 3100

981G "Magic multisets" "data structures" "In the School of Magic in Dirtpolis a lot of interesting objects are studied on Computer Science lessons.Consider, for example, the magic multiset. If you try to add an integer to it that is already presented in the multiset, each element in the multiset duplicates. For example, if you try to add the integer 2 to the multiset {1,2,3,3}, you will get {1,1,2,2,3,3,3,3}. If you try to add an integer that is not presented in the multiset, it is simply added to it. For example, if you try to add the integer 4 to the multiset {1,2,3,3}, you will get {1,2,3,3,4}.Also consider an array of n initially empty magic multisets, enumerated from 1 to n.You are to answer q queries of the form ""add an integer x to all multisets with indices l,l+1,\xe2\x80\xa6,r"" and ""compute the sum of sizes of multisets with indices l,l+1,\xe2\x80\xa6,r"". The answers for the second type queries can be large, so print the answers modulo 998244353." 2500

981F "Round Marriage" "binary search,graph matchings,greedy" "It\'s marriage season in Ringland!Ringland has a form of a circle\'s boundary of length L. There are n bridegrooms and n brides, and bridegrooms decided to marry brides.Of course, each bridegroom should choose exactly one bride, and each bride should be chosen by exactly one bridegroom.All objects in Ringland are located on the boundary of the circle, including the capital, bridegrooms\' castles and brides\' palaces. The castle of the i-th bridegroom is located at the distance ai from the capital in clockwise direction, and the palace of the i-th bride is located at the distance bi from the capital in clockwise direction.Let\'s define the inconvenience of a marriage the maximum distance that some bride should walk along the circle from her palace to her bridegroom\'s castle in the shortest direction (in clockwise or counter-clockwise direction).Help the bridegrooms of Ringland to choose brides in such a way that the inconvenience of the marriage is the smallest possible." 2500

981E "Addition on Segments" "bitmasks,data structures,divide and conquer,dp" "Grisha come to a contest and faced the following problem.You are given an array of size n, initially consisting of zeros. The elements of the array are enumerated from 1 to n. You perform q operations on the array. The i-th operation is described with three integers li, ri and xi (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n, 1\xe2\x89\xa4xi\xe2\x89\xa4n) and means that you should add xi to each of the elements with indices li,li+1,\xe2\x80\xa6,ri. After all operations you should find the maximum in the array.Grisha is clever, so he solved the problem quickly.However something went wrong inside his head and now he thinks of the following question: ""consider we applied some subset of the operations to the array. What are the possible values of the maximum in the array?""Help Grisha, find all integers y between 1 and n such that if you apply some subset (possibly empty) of the operations, then the maximum in the array becomes equal to y." 2200

981D Bookshelves bitmasks,dp,greedy "Mr Keks is a typical white-collar in Byteland.He has a bookshelf in his office with some books on it, each book has an integer positive price.Mr Keks defines the value of a shelf as the sum of books prices on it. Miraculously, Mr Keks was promoted and now he is moving into a new office.He learned that in the new office he will have not a single bookshelf, but exactly k bookshelves. He decided that the beauty of the k shelves is the bitwise AND of the values of all the shelves.He also decided that he won\'t spend time on reordering the books, so he will place several first books on the first shelf, several next books on the next shelf and so on. Of course, he will place at least one book on each shelf. This way he will put all his books on k shelves in such a way that the beauty of the shelves is as large as possible. Compute this maximum possible beauty." 1900

981C "Useful Decomposition" implementation,trees "Ramesses knows a lot about problems involving trees (undirected connected graphs without cycles)!He created a new useful tree decomposition, but he does not know how to construct it, so he asked you for help!The decomposition is the splitting the edges of the tree in some simple paths in such a way that each two paths have at least one common vertex. Each edge of the tree should be in exactly one path.Help Remesses, find such a decomposition of the tree or derermine that there is no such decomposition." 1400

981B "Businessmen Problems" sortings "Two famous competing companies ChemForces and TopChemist decided to show their sets of recently discovered chemical elements on an exhibition. However they know that no element should be present in the sets of both companies.In order to avoid this representatives of both companies decided to make an agreement on the sets the companies should present. The sets should be chosen in the way that maximizes the total income of the companies.All elements are enumerated with integers. The ChemForces company has discovered n distinct chemical elements with indices a1,a2,\xe2\x80\xa6,an, and will get an income of xi Berland rubles if the i-th element from this list is in the set of this company.The TopChemist company discovered m distinct chemical elements with indices b1,b2,\xe2\x80\xa6,bm, and it will get an income of yj Berland rubles for including the j-th element from this list to its set.In other words, the first company can present any subset of elements from {a1,a2,\xe2\x80\xa6,an} (possibly empty subset), the second company can present any subset of elements from {b1,b2,\xe2\x80\xa6,bm} (possibly empty subset). There shouldn\'t be equal elements in the subsets.Help the representatives select the sets in such a way that no element is presented in both sets and the total income is the maximum possible." 1000

981A Antipalindrome "brute force,implementation,strings" "A string is a palindrome if it reads the same from the left to the right and from the right to the left. For example, the strings ""kek"", ""abacaba"", ""r"" and ""papicipap"" are palindromes, while the strings ""abb"" and ""iq"" are not.A substring s[l\xe2\x80\xa6r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of a string s\xe2\x80\x89=\xe2\x80\x89s1s2\xe2\x80\xa6s|s| is the string slsl\xe2\x80\x89+\xe2\x80\x891\xe2\x80\xa6sr.Anna does not like palindromes, so she makes her friends call her Ann. She also changes all the words she reads in a similar way. Namely, each word s is changed into its longest substring that is not a palindrome. If all the substrings of s are palindromes, she skips the word at all.Some time ago Ann read the word s. What is the word she changed it into?" 900

980F "Cactus to Tree" dp,graphs,trees "You are given a special connected undirected graph where each vertex belongs to at most one simple cycle.Your task is to remove as many edges as needed to convert this graph into a tree (connected graph with no cycles). For each node, independently, output the maximum distance between it and a leaf in the resulting tree, assuming you were to remove the edges in a way that minimizes this distance." 2900

980E "The Number Games" "data structures,greedy,trees" "The nation of Panel holds an annual show called The Number Games, where each district in the nation will be represented by one contestant.The nation has n districts numbered from 1 to n, each district has exactly one path connecting it to every other district. The number of fans of a contestant from district i is equal to 2i.This year, the president decided to reduce the costs. He wants to remove k contestants from the games. However, the districts of the removed contestants will be furious and will not allow anyone to cross through their districts. The president wants to ensure that all remaining contestants are from districts that can be reached from one another. He also wishes to maximize the total number of fans of the participating contestants.Which contestants should the president remove?" 2200

980D "Perfect Groups" "dp,math,number theory" "SaMer has written the greatest test case of all time for one of his problems. For a given array of integers, the problem asks to find the minimum number of groups the array can be divided into, such that the product of any pair of integers in the same group is a perfect square. Each integer must be in exactly one group. However, integers in a group do not necessarily have to be contiguous in the array.SaMer wishes to create more cases from the test case he already has. His test case has an array A of n integers, and he needs to find the number of contiguous subarrays of A that have an answer to the problem equal to k for each integer k between 1 and n (inclusive)." 2100

980C Posterized games,greedy "Professor Ibrahim has prepared the final homework for his algorithm\xe2\x80\x99s class. He asked his students to implement the Posterization Image Filter.Their algorithm will be tested on an array of integers, where the ii-th integer represents the color of the ii-th pixel in the image. The image is in black and white, therefore the color of each pixel will be an integer between 0 and 255 (inclusive).To implement the filter, students are required to divide the black and white color range [0, 255] into groups of consecutive colors, and select one color in each group to be the group\xe2\x80\x99s key. In order to preserve image details, the size of a group must not be greater than kk, and each color should belong to exactly one group.Finally, the students will replace the color of each pixel in the array with that color\xe2\x80\x99s assigned group key.To better understand the effect, here is an image of a basking turtle where the Posterization Filter was applied with increasing kk to the right.   To make the process of checking the final answer easier, Professor Ibrahim wants students to divide the groups and assign the keys in a way that produces the lexicographically smallest possible array." 1700

980B Marlin "constructive algorithms" "The city of Fishtopia can be imagined as a grid of 4 rows and an odd number of columns. It has two main villages; the first is located at the top-left cell (1,1), people who stay there love fishing at the Tuna pond at the bottom-right cell (4,n). The second village is located at (4,1) and its people love the Salmon pond at (1,n).The mayor of Fishtopia wants to place k hotels in the city, each one occupying one cell. To allow people to enter the city from anywhere, hotels should not be placed on the border cells.A person can move from one cell to another if those cells are not occupied by hotels and share a side.Can you help the mayor place the hotels in a way such that there are equal number of shortest paths from each village to its preferred pond?" 1600

980A "Links and Pearls" implementation,math "A necklace can be described as a string of links (\'-\') and pearls (\'o\'), with the last link or pearl connected to the first one.  You can remove a link or a pearl and insert it between two other existing links or pearls (or between a link and a pearl) on the necklace. This process can be repeated as many times as you like, but you can\'t throw away any parts.Can you make the number of links between every two adjacent pearls equal? Two pearls are considered to be adjacent if there is no other pearl between them.Note that the final necklace should remain as one circular part of the same length as the initial necklace." 900

979E "Kuro and Topological Parity" dp "Kuro has recently won the ""Most intelligent cat ever"" contest. The three friends then decided to go to Katie\'s home to celebrate Kuro\'s winning. After a big meal, they took a small break then started playing games.Kuro challenged Katie to create a game with only a white paper, a pencil, a pair of scissors and a lot of arrows (you can assume that the number of arrows is infinite). Immediately, Katie came up with the game called Topological Parity.The paper is divided into nn pieces enumerated from 11 to nn. Shiro has painted some pieces with some color. Specifically, the ii-th piece has color cici where ci=0ci=0 defines black color, ci=1ci=1 defines white color and ci=\xe2\x88\x921ci=\xe2\x88\x921 means that the piece hasn\'t been colored yet.The rules of the game is simple. Players must put some arrows between some pairs of different pieces in such a way that for each arrow, the number in the piece it starts from is less than the number of the piece it ends at. Also, two different pieces can only be connected by at most one arrow. After that the players must choose the color (00 or 11) for each of the unpainted pieces. The score of a valid way of putting the arrows and coloring pieces is defined as the number of paths of pieces of alternating colors. For example, [1\xe2\x86\x920\xe2\x86\x921\xe2\x86\x920][1\xe2\x86\x920\xe2\x86\x921\xe2\x86\x920], [0\xe2\x86\x921\xe2\x86\x920\xe2\x86\x921][0\xe2\x86\x921\xe2\x86\x920\xe2\x86\x921], [1][1], [0][0] are valid paths and will be counted. You can only travel from piece xx to piece yy if and only if there is an arrow from xx to yy.But Kuro is not fun yet. He loves parity. Let\'s call his favorite parity pp where p=0p=0 stands for ""even"" and p=1p=1 stands for ""odd"". He wants to put the arrows and choose colors in such a way that the score has the parity of pp.It seems like there will be so many ways which satisfy Kuro. He wants to count the number of them but this could be a very large number. Let\'s help him with his problem, but print it modulo 109+7109+7." 2400

979D "Kuro and GCD and XOR and SUM" "binary search,bitmasks,brute force,data structures,dp,dsu,greedy,math,number theory,strings,trees" "Kuro is currently playing an educational game about numbers. The game focuses on the greatest common divisor (GCD), the XOR value, and the sum of two numbers. Kuro loves the game so much that he solves levels by levels day by day.Sadly, he\'s going on a vacation for a day, and he isn\'t able to continue his solving streak on his own. As Katie is a reliable person, Kuro kindly asked her to come to his house on this day to play the game for him.Initally, there is an empty array a. The game consists of q tasks of two types. The first type asks Katie to add a number ui to a. The second type asks Katie to find a number v existing in a such that ki\xe2\x88\xa3GCD(xi,v), xi+v\xe2\x89\xa4si, and xi\xe2\x8a\x95v is maximized, where \xe2\x8a\x95 denotes the bitwise XOR operation, GCD(c,d) denotes the greatest common divisor of integers c and d, and y\xe2\x88\xa3x means x is divisible by y, or report -1 if no such numbers are found.Since you are a programmer, Katie needs you to automatically and accurately perform the tasks in the game to satisfy her dear friend Kuro. Let\'s help her!" 2200

979C "Kuro and Walking Route" "dfs and similar,trees" "Kuro is living in a country called Uberland, consisting of n towns, numbered from 1 to n, and n\xe2\x88\x921 bidirectional roads connecting these towns. It is possible to reach each town from any other. Each road connects two towns a and b. Kuro loves walking and he is planning to take a walking marathon, in which he will choose a pair of towns (u,v) (u\xe2\x89\xa0v) and walk from u using the shortest path to v (note that (u,v) is considered to be different from (v,u)).Oddly, there are 2 special towns in Uberland named Flowrisa (denoted with the index x) and Beetopia (denoted with the index y). Flowrisa is a town where there are many strong-scent flowers, and Beetopia is another town where many bees live. In particular, Kuro will avoid any pair of towns (u,v) if on the path from u to v, he reaches Beetopia after he reached Flowrisa, since the bees will be attracted with the flower smell on Kuro\xe2\x80\x99s body and sting him.Kuro wants to know how many pair of city (u,v) he can take as his route. Since he\xe2\x80\x99s not really bright, he asked you to help him with this problem." 1600

979B "Treasure Hunt" greedy "After the big birthday party, Katie still wanted Shiro to have some more fun. Later, she came up with a game called treasure hunt. Of course, she invited her best friends Kuro and Shiro to play with her.The three friends are very smart so they passed all the challenges very quickly and finally reached the destination. But the treasure can only belong to one cat so they started to think of something which can determine who is worthy of the treasure. Instantly, Kuro came up with some ribbons.A random colorful ribbon is given to each of the cats. Each color of the ribbon can be represented as an uppercase or lowercase Latin letter. Let\'s call a consecutive subsequence of colors that appears in the ribbon a subribbon. The beauty of a ribbon is defined as the maximum number of times one of its subribbon appears in the ribbon. The more the subribbon appears, the more beautiful is the ribbon. For example, the ribbon aaaaaaa has the beauty of 7 because its subribbon a appears 7 times, and the ribbon abcdabc has the beauty of 2 because its subribbon abc appears twice.The rules are simple. The game will have n turns. Every turn, each of the cats must change strictly one color (at one position) in his/her ribbon to an arbitrary color which is different from the unchanged one. For example, a ribbon aaab can be changed into acab in one turn. The one having the most beautiful ribbon after n turns wins the treasure.Could you find out who is going to be the winner if they all play optimally?" 1800

979A "Pizza, Pizza, Pizza!!!" math "Katie, Kuro and Shiro are best friends. They have known each other since kindergarten. That\'s why they often share everything with each other and work together on some very hard problems.Today is Shiro\'s birthday. She really loves pizza so she wants to invite her friends to the pizza restaurant near her house to celebrate her birthday, including her best friends Katie and Kuro.She has ordered a very big round pizza, in order to serve her many friends. Exactly n of Shiro\'s friends are here. That\'s why she has to divide the pizza into n+1 slices (Shiro also needs to eat). She wants the slices to be exactly the same size and shape. If not, some of her friends will get mad and go home early, and the party will be over.Shiro is now hungry. She wants to cut the pizza with minimum of straight cuts. A cut is a straight segment, it might have ends inside or outside the pizza. But she is too lazy to pick up the calculator.As usual, she will ask Katie and Kuro for help. But they haven\'t come yet. Could you help Shiro with this problem?" 1000

978G "Petya\'s Exams" greedy,implementation,sortings "Katie, Kuro and Shiro are best friends. They have known each other since kindergarten. That\'s why they often share everything with each other and work together on some very hard problems.Today is Shiro\'s birthday. She really loves pizza so she wants to invite her friends to the pizza restaurant near her house to celebrate her birthday, including her best friends Katie and Kuro.She has ordered a very big round pizza, in order to serve her many friends. Exactly n of Shiro\'s friends are here. That\'s why she has to divide the pizza into n+1 slices (Shiro also needs to eat). She wants the slices to be exactly the same size and shape. If not, some of her friends will get mad and go home early, and the party will be over.Shiro is now hungry. She wants to cut the pizza with minimum of straight cuts. A cut is a straight segment, it might have ends inside or outside the pizza. But she is too lazy to pick up the calculator.As usual, she will ask Katie and Kuro for help. But they haven\'t come yet. Could you help Shiro with this problem?" 1700

978F Mentors "binary search,data structures,implementation" "In BerSoft n programmers work, the programmer i is characterized by a skill ri.A programmer a can be a mentor of a programmer b if and only if the skill of the programmer a is strictly greater than the skill of the programmer b (ra>rb) and programmers a and b are not in a quarrel.You are given the skills of each programmers and a list of k pairs of the programmers, which are in a quarrel (pairs are unordered). For each programmer i, find the number of programmers, for which the programmer i can be a mentor." 1500

978E "Bus Video System" combinatorics,math "The busses in Berland are equipped with a video surveillance system. The system records information about changes in the number of passengers in a bus after stops.If x is the number of passengers in a bus just before the current bus stop and y is the number of passengers in the bus just after current bus stop, the system records the number y\xe2\x88\x92x. So the system records show how number of passengers changed.The test run was made for single bus and n bus stops. Thus, the system recorded the sequence of integers a1,a2,\xe2\x80\xa6,an (exactly one number for each bus stop), where ai is the record for the bus stop i. The bus stops are numbered from 1 to n in chronological order.Determine the number of possible ways how many people could be in the bus before the first bus stop, if the bus has a capacity equals to w (that is, at any time in the bus there should be from 0 to w passengers inclusive)." 1400

978D "Almost Arithmetic Progression" "brute force,implementation,math" "Polycarp likes arithmetic progressions. A sequence [a1,a2,\xe2\x80\xa6,an] is called an arithmetic progression if for each i (1\xe2\x89\xa4i<n) the value ai+1\xe2\x88\x92ai is the same. For example, the sequences [42], [5,5,5], [2,11,20,29] and [3,2,1,0] are arithmetic progressions, but [1,0,1], [1,3,9] and [2,3,1] are not.It follows from the definition that any sequence of length one or two is an arithmetic progression.Polycarp found some sequence of positive integers [b1,b2,\xe2\x80\xa6,bn]. He agrees to change each element by at most one. In the other words, for each element there are exactly three options: an element can be decreased by 1, an element can be increased by 1, an element can be left unchanged.Determine a minimum possible number of elements in b which can be changed (by exactly one), so that the sequence b becomes an arithmetic progression, or report that it is impossible.It is possible that the resulting sequence contains element equals 0." 1500

978C Letters "binary search,implementation,two pointers" "There are n dormitories in Berland State University, they are numbered with integers from 1 to n. Each dormitory consists of rooms, there are ai rooms in i-th dormitory. The rooms in i-th dormitory are numbered from 1 to ai.A postman delivers letters. Sometimes there is no specific dormitory and room number in it on an envelope. Instead of it only a room number among all rooms of all n dormitories is written on an envelope. In this case, assume that all the rooms are numbered from 1 to a1+a2+\xe2\x8b\xaf+an and the rooms of the first dormitory go first, the rooms of the second dormitory go after them and so on.For example, in case n=2, a1=3 and a2=5 an envelope can have any integer from 1 to 8 written on it. If the number 7 is written on an envelope, it means that the letter should be delivered to the room number 4 of the second dormitory.For each of m letters by the room number among all n dormitories, determine the particular dormitory and the room number in a dormitory where this letter should be delivered." 1000

978B "File Name" greedy,strings "You can not just take the file and send it. When Polycarp trying to send a file in the social network ""Codehorses"", he encountered an unexpected problem. If the name of the file contains three or more ""x"" (lowercase Latin letters ""x"") in a row, the system considers that the file content does not correspond to the social network topic. In this case, the file is not sent and an error message is displayed.Determine the minimum number of characters to remove from the file name so after that the name does not contain ""xxx"" as a substring. Print 0 if the file name does not initially contain a forbidden substring ""xxx"".You can delete characters in arbitrary positions (not necessarily consecutive). If you delete a character, then the length of a string is reduced by 1. For example, if you delete the character in the position 2 from the string ""exxxii"", then the resulting string is ""exxii""." 800

978A "Remove Duplicates" implementation "Petya has an array a consisting of n integers. He wants to remove duplicate (equal) elements.Petya wants to leave only the rightmost entry (occurrence) for each element of the array. The relative order of the remaining unique elements should not be changed." 800

977F "Consecutive Subsequence" dp "You are given an integer array of length n.You have to choose some subsequence of this array of maximum length such that this subsequence forms a increasing sequence of consecutive integers. In other words the required sequence should be equal to [x,x+1,\xe2\x80\xa6,x+k\xe2\x88\x921] for some value x and length k.Subsequence of an array can be obtained by erasing some (possibly zero) elements from the array. You can erase any elements, not necessarily going successively. The remaining elements preserve their order. For example, for the array [5,3,1,2,4] the following arrays are subsequences: [3], [5,3,1,2,4], [5,1,4], but the array [1,3] is not." 1700

977E "Cyclic Components" "dfs and similar,dsu,graphs" "You are given an undirected graph consisting of n vertices and m edges. Your task is to find the number of connected components which are cycles.Here are some definitions of graph theory.An undirected graph consists of two sets: set of nodes (called vertices) and set of edges. Each edge connects a pair of vertices. All edges are bidirectional (i.e. if a vertex a is connected with a vertex b, a vertex b is also connected with a vertex a). An edge can\'t connect vertex with itself, there is at most one edge between a pair of vertices.Two vertices u and v belong to the same connected component if and only if there is at least one path along edges connecting u and v.A connected component is a cycle if and only if its vertices can be reordered in such a way that:  the first vertex is connected with the second vertex by an edge,  the second vertex is connected with the third vertex by an edge,  ...  the last vertex is connected with the first vertex by an edge,  all the described edges of a cycle are distinct. A cycle doesn\'t contain any other edges except described above. By definition any cycle contains three or more vertices.  There are 6 connected components, 2 of them are cycles: [7,10,16] and [5,11,9,15]." 1500

977D "Divide by three, multiply by two" "dfs and similar,math,sortings" "Polycarp likes to play with numbers. He takes some integer number x, writes it down on the board, and then performs with it n\xe2\x88\x921 operations of the two kinds:   divide the number x by 3 (x must be divisible by 3);  multiply the number x by 2. After each operation, Polycarp writes down the result on the board and replaces x by the result. So there will be n numbers on the board after all.You are given a sequence of length n \xe2\x80\x94 the numbers that Polycarp wrote down. This sequence is given in arbitrary order, i.e. the order of the sequence can mismatch the order of the numbers written on the board.Your problem is to rearrange (reorder) elements of this sequence in such a way that it can match possible Polycarp\'s game in the order of the numbers written on the board. I.e. each next number will be exactly two times of the previous number or exactly one third of previous number.It is guaranteed that the answer exists." 1400

977C "Less or Equal" sortings "You are given a sequence of integers of length n and integer number k. You should print any integer number x in the range of [1;109] (i.e. 1\xe2\x89\xa4x\xe2\x89\xa4109) such that exactly k elements of given sequence are less than or equal to x.Note that the sequence can contain equal elements.If there is no such x, print ""-1"" (without quotes)." 1200

977B Two-gram implementation,strings "Two-gram is an ordered pair (i.e. string of length two) of capital Latin letters. For example, ""AZ"", ""AA"", ""ZA"" \xe2\x80\x94 three distinct two-grams.You are given a string s consisting of n capital Latin letters. Your task is to find any two-gram contained in the given string as a substring (i.e. two consecutive characters of the string) maximal number of times. For example, for string s = ""BBAABBBA"" the answer is two-gram ""BB"", which contained in s three times. In other words, find any most frequent two-gram.Note that occurrences of the two-gram can overlap with each other." 900

977A "Wrong Subtraction" implementation "Little girl Tanya is learning how to decrease a number by one, but she does it wrong with a number consisting of two or more digits. Tanya subtracts one from a number by the following algorithm:  if the last digit of the number is non-zero, she decreases the number by one;  if the last digit of the number is zero, she divides the number by 10 (i.e. removes the last digit). You are given an integer number n. Tanya will subtract one from it k times. Your task is to print the result after all k subtractions.It is guaranteed that the result will be positive integer number." 800

976F "Minimal k-covering" flows,graphs "You are given a bipartite graph G\xe2\x80\x89=\xe2\x80\x89(U,\xe2\x80\x89V,\xe2\x80\x89E), U is the set of vertices of the first part, V is the set of vertices of the second part and E is the set of edges. There might be multiple edges.Let\'s call some subset of its edges  k-covering iff the graph  has each of its vertices incident to at least k edges. Minimal k-covering is such a k-covering that the size of the subset  is minimal possible.Your task is to find minimal k-covering for each , where minDegree is the minimal degree of any vertex in graph G." 2500

976E "Well played!" greedy,sortings "Recently Max has got himself into popular CCG ""BrainStone"". As ""BrainStone"" is a pretty intellectual game, Max has to solve numerous hard problems during the gameplay. Here is one of them:Max owns n creatures, i-th of them can be described with two numbers \xe2\x80\x94 its health hpi and its damage dmgi. Max also has two types of spells in stock:  Doubles health of the creature (hpi := hpi\xc2\xb72);  Assigns value of health of the creature to its damage (dmgi := hpi). Spell of first type can be used no more than a times in total, of the second type \xe2\x80\x94 no more than b times in total. Spell can be used on a certain creature multiple times. Spells can be used in arbitrary order. It isn\'t necessary to use all the spells.Max is really busy preparing for his final exams, so he asks you to determine what is the maximal total damage of all creatures he can achieve if he uses spells in most optimal way." 2100

976D "Degree Set" "constructive algorithms,graphs,implementation" "You are given a sequence of n positive integers d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dn (d1\xe2\x80\x89<\xe2\x80\x89d2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89dn). Your task is to construct an undirected graph such that:  there are exactly dn\xe2\x80\x89+\xe2\x80\x891 vertices;  there are no self-loops;  there are no multiple edges;  there are no more than 106 edges;  its degree set is equal to d. Vertices should be numbered 1 through (dn\xe2\x80\x89+\xe2\x80\x891).Degree sequence is an array a with length equal to the number of vertices in a graph such that ai is the number of vertices adjacent to i-th vertex.Degree set is a sorted in increasing order sequence of all distinct values from the degree sequence.It is guaranteed that there exists such a graph that all the conditions hold, and it contains no more than 106 edges.Print the resulting graph." 2500

976C "Nested Segments" greedy,implementation,sortings "You are given a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of one-dimensional segments numbered 1 through n. Your task is to find two distinct indices i and j such that segment ai lies within segment aj.Segment [l1,\xe2\x80\x89r1] lies within segment [l2,\xe2\x80\x89r2] iff l1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89l2 and r1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2.Print indices i and j. If there are multiple answers, print any of them. If no answer exists, print -1 -1." 1500

976B "Lara Croft and the New Game" implementation,math "You might have heard about the next game in Lara Croft series coming out this year. You also might have watched its trailer. Though you definitely missed the main idea about its plot, so let me lift the veil of secrecy.Lara is going to explore yet another dangerous dungeon. Game designers decided to use good old 2D environment. The dungeon can be represented as a rectangle matrix of n rows and m columns. Cell (x,\xe2\x80\x89y) is the cell in the x-th row in the y-th column. Lara can move between the neighbouring by side cells in all four directions.Moreover, she has even chosen the path for herself to avoid all the traps. She enters the dungeon in cell (1,\xe2\x80\x891), that is top left corner of the matrix. Then she goes down all the way to cell (n,\xe2\x80\x891) \xe2\x80\x94 the bottom left corner. Then she starts moving in the snake fashion \xe2\x80\x94 all the way to the right, one cell up, then to the left to the cell in 2-nd column, one cell up. She moves until she runs out of non-visited cells. n and m given are such that she always end up in cell (1,\xe2\x80\x892).Lara has already moved to a neighbouring cell k times. Can you determine her current position?" 1300

976A "Minimum Binary Number" implementation "String can be called correct if it consists of characters ""0"" and ""1"" and there are no redundant leading zeroes. Here are some examples: ""0"", ""10"", ""1001"".You are given a correct string s.You can perform two different operations on this string:   swap any pair of adjacent characters (for example, ""101""  ""110"");  replace ""11"" with ""1"" (for example, ""110""  ""10""). Let val(s) be such a number that s is its binary representation.Correct string a is less than some other correct string b iff val(a)\xe2\x80\x89<\xe2\x80\x89val(b).Your task is to find the minimum correct string that you can obtain from the given one using the operations described above. You can use these operations any number of times in any order (or even use no operations at all)." 800

975E "Hag\'s Khashba" geometry "String can be called correct if it consists of characters ""0"" and ""1"" and there are no redundant leading zeroes. Here are some examples: ""0"", ""10"", ""1001"".You are given a correct string s.You can perform two different operations on this string:   swap any pair of adjacent characters (for example, ""101""  ""110"");  replace ""11"" with ""1"" (for example, ""110""  ""10""). Let val(s) be such a number that s is its binary representation.Correct string a is less than some other correct string b iff val(a)\xe2\x80\x89<\xe2\x80\x89val(b).Your task is to find the minimum correct string that you can obtain from the given one using the operations described above. You can use these operations any number of times in any order (or even use no operations at all)." 2600

975D Ghosts geometry,math "Ghosts live in harmony and peace, they travel the space without any purpose other than scare whoever stands in their way.There are nn ghosts in the universe, they move in the OXYOXY plane, each one of them has its own velocity that does not change in time: V\xe2\x86\x92=Vxi\xe2\x86\x92+Vyj\xe2\x86\x92V\xe2\x86\x92=Vxi\xe2\x86\x92+Vyj\xe2\x86\x92 where VxVx is its speed on the xx-axis and VyVy is on the yy-axis.A ghost ii has experience value EXiEXi, which represent how many ghosts tried to scare him in his past. Two ghosts scare each other if they were in the same cartesian point at a moment of time.As the ghosts move with constant speed, after some moment of time there will be no further scaring (what a relief!) and the experience of ghost kind GX=\xe2\x88\x91ni=1EXiGX=\xe2\x88\x91i=1nEXi will never increase.Tameem is a red giant, he took a picture of the cartesian plane at a certain moment of time TT, and magically all the ghosts were aligned on a line of the form y=a\xe2\x8b\x85x+by=a\xe2\x8b\x85x+b. You have to compute what will be the experience index of the ghost kind GXGX in the indefinite future, this is your task for today.Note that when Tameem took the picture, GXGX may already be greater than 00, because many ghosts may have scared one another at any moment between [\xe2\x88\x92\xe2\x88\x9e,T][\xe2\x88\x92\xe2\x88\x9e,T]." 2000

975C "Valhalla Siege" "binary search" "Ivar the Boneless is a great leader. He is trying to capture Kattegat from Lagertha. The war has begun and wave after wave Ivar\'s warriors are falling in battle.Ivar has n warriors, he places them on a straight line in front of the main gate, in a way that the i-th warrior stands right after (i\xe2\x88\x921)-th warrior. The first warrior leads the attack.Each attacker can take up to ai arrows before he falls to the ground, where ai is the i-th warrior\'s strength.Lagertha orders her warriors to shoot ki arrows during the i-th minute, the arrows one by one hit the first still standing warrior. After all Ivar\'s warriors fall and all the currently flying arrows fly by, Thor smashes his hammer and all Ivar\'s warriors get their previous strengths back and stand up to fight again. In other words, if all warriors die in minute t, they will all be standing to fight at the end of minute t.The battle will last for q minutes, after each minute you should tell Ivar what is the number of his standing warriors." 1400

975B Mancala "brute force,implementation" "Mancala is a game famous in the Middle East. It is played on a board that consists of 14 holes.   Initially, each hole has aiai stones. When a player makes a move, he chooses a hole which contains a positive number of stones. He takes all the stones inside it and then redistributes these stones one by one in the next holes in a counter-clockwise direction.Note that the counter-clockwise order means if the player takes the stones from hole ii, he will put one stone in the (i+1)(i+1)-th hole, then in the (i+2)(i+2)-th, etc. If he puts a stone in the 1414-th hole, the next one will be put in the first hole.After the move, the player collects all the stones from holes that contain even number of stones. The number of stones collected by player is the score, according to Resli.Resli is a famous Mancala player. He wants to know the maximum score he can obtain after one move." 1100

975A "Aramic script" implementation,strings "In Aramic language words can only represent objects.Words in Aramic have special properties:   A word is a root if it does not contain the same letter more than once.  A root and all its permutations represent the same object.  The root x of a word y is the word that contains all letters that appear in y in a way that each letter appears once. For example, the root of ""aaaa"", ""aa"", ""aaa"" is ""a"", the root of ""aabb"", ""bab"", ""baabb"", ""ab"" is ""ab"".  Any word in Aramic represents the same object as its root. You have an ancient script in Aramic. What is the number of different objects mentioned in the script?" 900

967B "Watering System" math,sortings "Arkady wants to water his only flower. Unfortunately, he has a very poor watering system that was designed for nn flowers and so it looks like a pipe with nn holes. Arkady can only use the water that flows from the first hole.Arkady can block some of the holes, and then pour AA liters of water into the pipe. After that, the water will flow out from the non-blocked holes proportionally to their sizes s1,s2,\xe2\x80\xa6,sns1,s2,\xe2\x80\xa6,sn. In other words, if the sum of sizes of non-blocked holes is SS, and the ii-th hole is not blocked, si\xe2\x8b\x85ASsi\xe2\x8b\x85AS liters of water will flow out of it.What is the minimum number of holes Arkady should block to make at least BB liters of water flow out of the first hole?" 1000

967A "Mind the Gap" implementation "These days Arkady works as an air traffic controller at a large airport. He controls a runway which is usually used for landings only. Thus, he has a schedule of planes that are landing in the nearest future, each landing lasts 1 minute.He was asked to insert one takeoff in the schedule. The takeoff takes 1 minute itself, but for safety reasons there should be a time space between the takeoff and any landing of at least s minutes from both sides.Find the earliest time when Arkady can insert the takeoff." 1100

965E "Short Code" "data structures,dp,greedy,strings,trees" "Arkady\'s code contains n variables. Each variable has a unique name consisting of lowercase English letters only. One day Arkady decided to shorten his code.He wants to replace each variable name with its non-empty prefix so that these new names are still unique (however, a new name of some variable can coincide with some old name of another or same variable). Among such possibilities he wants to find the way with the smallest possible total length of the new names.A string a is a prefix of a string b if you can delete some (possibly none) characters from the end of b and obtain a.Please find this minimum possible total length of new names." 2200

965D "Single-use Stones" "binary search,flows,greedy,two pointers" "A lot of frogs want to cross a river. A river is w units width, but frogs can only jump l units long, where l<w. Frogs can also jump on lengths shorter than l. but can\'t jump longer. Hopefully, there are some stones in the river to help them.The stones are located at integer distances from the banks. There are ai stones at the distance of i units from the bank the frogs are currently at. Each stone can only be used once by one frog, after that it drowns in the water.What is the maximum number of frogs that can cross the river, given that then can only jump on the stones?" 1900

965C "Greedy Arkady" math "k people want to split n candies between them. Each candy should be given to exactly one of them or be thrown away.The people are numbered from 1 to k, and Arkady is the first of them. To split the candies, Arkady will choose an integer x and then give the first x candies to himself, the next x candies to the second person, the next x candies to the third person and so on in a cycle. The leftover (the remainder that is not divisible by x) will be thrown away.Arkady can\'t choose x greater than M as it is considered greedy. Also, he can\'t choose such a small x that some person will receive candies more than D times, as it is considered a slow splitting.Please find what is the maximum number of candies Arkady can receive by choosing some valid x." 2000

965B Battleship implementation "Arkady is playing Battleship. The rules of this game aren\'t really important.There is a field of n\xc3\x97nn\xc3\x97n cells. There should be exactly one kk-decker on the field, i.�e. a ship that is kk cells long oriented either horizontally or vertically. However, Arkady doesn\'t know where it is located. For each cell Arkady knows if it is definitely empty or can contain a part of the ship.Consider all possible locations of the ship. Find such a cell that belongs to the maximum possible number of different locations of the ship." 1300

965A "Paper Airplanes" math "To make a paper airplane, one has to use a rectangular piece of paper. From a sheet of standard size you can make s airplanes.A group of k people decided to make n airplanes each. They are going to buy several packs of paper, each of them containing p sheets, and then distribute the sheets between the people. Each person should have enough sheets to make n airplanes. How many packs should they buy?" 800

964B Messages math "There are n incoming messages for Vasya. The i-th message is going to be received after ti minutes. Each message has a cost, which equals to A initially. After being received, the cost of a message decreases by B each minute (it can become negative). Vasya can read any message after receiving it at any moment of time. After reading the message, Vasya\'s bank account receives the current cost of this message. Initially, Vasya\'s bank account is at 0.Also, each minute Vasya\'s bank account receives C\xc2\xb7k, where k is the amount of received but unread messages.Vasya\'s messages are very important to him, and because of that he wants to have all messages read after T minutes.Determine the maximum amount of money Vasya\'s bank account can hold after T minutes." 1300

964A Splits math "Let\'s define a split of n as a nonincreasing sequence of positive integers, the sum of which is n. For example, the following sequences are splits of 8: [4,4], [3,3,2], [2,2,1,1,1,1], [5,2,1].The following sequences aren\'t splits of 8: [1,7], [5,4], [11,\xe2\x88\x923], [1,1,4,1,1].The weight of a split is the number of elements in the split that are equal to the first element. For example, the weight of the split [1,1,1,1,1] is 5, the weight of the split [5,5,3,3,3] is 2 and the weight of the split [9] equals 1.For a given n, find out the number of different weights of its splits." 800

963E "Circles of Waiting" math "A chip was placed on a field with coordinate system onto point (0,\xe2\x80\x890).Every second the chip moves randomly. If the chip is currently at a point (x,\xe2\x80\x89y), after a second it moves to the point (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y) with probability p1, to the point (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) with probability p2, to the point (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y) with probability p3 and to the point (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891) with probability p4. It\'s guaranteed that p1\xe2\x80\x89+\xe2\x80\x89p2\xe2\x80\x89+\xe2\x80\x89p3\xe2\x80\x89+\xe2\x80\x89p4\xe2\x80\x89=\xe2\x80\x891. The moves are independent.Find out the expected time after which chip will move away from origin at a distance greater than R (i.e.  will be satisfied)." 3100

963D "Frequency of String" "hashing,string suffix structures,strings" "You are given a string s. You should answer n queries. The i-th query consists of integer ki and string mi. The answer for this query is the minimum length of such a string t that t is a substring of s and mi has at least ki occurrences as a substring in t.A substring of a string is a continuous segment of characters of the string.It is guaranteed that for any two queries the strings mi from these queries are different." 2500

963C "Cutting Rectangle" "brute force,math,number theory" "A rectangle with sides AA and BB is cut into rectangles with cuts parallel to its sides. For example, if pp horizontal and qq vertical cuts were made, (p+1)\xe2\x8b\x85(q+1)(p+1)\xe2\x8b\x85(q+1) rectangles were left after the cutting. After the cutting, rectangles were of nn different types. Two rectangles are different if at least one side of one rectangle isn\'t equal to the corresponding side of the other. Note that the rectangle can\'t be rotated, this means that rectangles a\xc3\x97ba\xc3\x97b and b\xc3\x97ab\xc3\x97a are considered different if a\xe2\x89\xa0ba\xe2\x89\xa0b.For each type of rectangles, lengths of the sides of rectangles are given along with the amount of the rectangles of this type that were left after cutting the initial rectangle.Calculate the amount of pairs (A;B)(A;B) such as the given rectangles could be created by cutting the rectangle with sides of lengths AA and BB. Note that pairs (A;B)(A;B) and (B;A)(B;A) are considered different when A\xe2\x89\xa0BA\xe2\x89\xa0B." 2600

963B "Destruction of a Tree" "constructive algorithms,dfs and similar,dp,greedy,trees" "You are given a tree (a graph with n vertices and n\xe2\x80\x89-\xe2\x80\x891 edges in which it\'s possible to reach any vertex from any other vertex using only its edges).A vertex can be destroyed if this vertex has even degree. If you destroy a vertex, all edges connected to it are also deleted.Destroy all vertices in the given tree or determine that it is impossible." 2000

963A "Alternating Sum" "math,number theory" "You are given two integers a and b. Moreover, you are given a sequence s0,s1,\xe2\x80\xa6,sn. All values in s are integers 1 or \xe2\x88\x921. It\'s known that sequence is k-periodic and k divides n+1. In other words, for each k\xe2\x89\xa4i\xe2\x89\xa4n it\'s satisfied that si=si\xe2\x88\x92k.Find out the non-negative remainder of division of n\xe2\x88\x91i=0sian\xe2\x88\x92ibi by 109+9.Note that the modulo is unusual!" 1800

962G "Visible Black Areas" "data structures,dsu,geometry,trees" "Petya has a polygon consisting of nn vertices. All sides of the Petya\'s polygon are parallel to the coordinate axes, and each two adjacent sides of the Petya\'s polygon are perpendicular. It is guaranteed that the polygon is simple, that is, it doesn\'t have self-intersections and self-touches. All internal area of the polygon (borders are not included) was painted in black color by Petya.Also, Petya has a rectangular window, defined by its coordinates, through which he looks at the polygon. A rectangular window can not be moved. The sides of the rectangular window are parallel to the coordinate axes.  Blue color represents the border of a polygon, red color is the Petya\'s window. The answer in this case is 2. Determine the number of black connected areas of Petya\'s polygon, which can be seen through the rectangular window." 2800

962F "Simple Cycles Edges" "dfs and similar,graphs,trees" "You are given an undirected graph, consisting of n vertices and m edges. The graph does not necessarily connected. Guaranteed, that the graph does not contain multiple edges (more than one edges between a pair of vertices) or loops (edges from a vertex to itself).A cycle in a graph is called a simple, if it contains each own vertex exactly once. So simple cycle doesn\'t allow to visit a vertex more than once in a cycle.Determine the edges, which belong to exactly on one simple cycle." 2400

962E "Byteland, Berland and Disputed Cities" "constructive algorithms,greedy" "The cities of Byteland and Berland are located on the axis Ox. In addition, on this axis there are also disputed cities, which belong to each of the countries in their opinion. Thus, on the line Ox there are three types of cities:  the cities of Byteland,  the cities of Berland,  disputed cities. Recently, the project BNET has been launched \xe2\x80\x94 a computer network of a new generation. Now the task of the both countries is to connect the cities so that the network of this country is connected.The countries agreed to connect the pairs of cities with BNET cables in such a way that:  If you look at the only cities of Byteland and the disputed cities, then in the resulting set of cities, any city should be reachable from any other one by one or more cables,  If you look at the only cities of Berland and the disputed cities, then in the resulting set of cities, any city should be reachable from any other one by one or more cables. Thus, it is necessary to choose a set of pairs of cities to connect by cables in such a way that both conditions are satisfied simultaneously. Cables allow bi-directional data transfer. Each cable connects exactly two distinct cities.The cost of laying a cable from one city to another is equal to the distance between them. Find the minimum total cost of laying a set of cables so that two subsets of cities (Byteland and disputed cities, Berland and disputed cities) are connected.Each city is a point on the line Ox. It is technically possible to connect the cities a and b with a cable so that the city c (a<c<b) is not connected to this cable, where a, b and c are simultaneously coordinates of the cities a, b and c." 2200

962D "Merge Equals" "data structures,implementation" "You are given an array of positive integers. While there are at least two equal elements, we will perform the following operation. We choose the smallest value x that occurs in the array 2 or more times. Take the first two occurrences of x in this array (the two leftmost occurrences). Remove the left of these two occurrences, and the right one is replaced by the sum of this two values (that is, 2\xe2\x8b\x85x).Determine how the array will look after described operations are performed.For example, consider the given array looks like [3,4,1,2,2,1,1]. It will be changed in the following way: [3,4,1,2,2,1,1]�\xe2\x86\x92�[3,4,2,2,2,1]�\xe2\x86\x92�[3,4,4,2,1]�\xe2\x86\x92�[3,8,2,1].If the given array is look like [1,1,3,1,1] it will be changed in the following way: [1,1,3,1,1]�\xe2\x86\x92�[2,3,1,1]�\xe2\x86\x92�[2,3,2]�\xe2\x86\x92�[3,4]." 1600

962C "Make a Square" "brute force,implementation,math" "You are given a positive integer n, written without leading zeroes (for example, the number 04 is incorrect). In one operation you can delete any digit of the given integer so that the result remains a positive integer without leading zeros.Determine the minimum number of operations that you need to consistently apply to the given integer n to make from it the square of some positive integer or report that it is impossible.An integer x is the square of some positive integer if and only if x=y2 for some positive integer y." 1400

962B "Students in Railway Carriage" "constructive algorithms,greedy,implementation" "There are n consecutive seat places in a railway carriage. Each place is either empty or occupied by a passenger.The university team for the Olympiad consists of a student-programmers and b student-athletes. Determine the largest number of students from all a+b students, which you can put in the railway carriage so that:  no student-programmer is sitting next to the student-programmer;  and no student-athlete is sitting next to the student-athlete. In the other words, there should not be two consecutive (adjacent) places where two student-athletes or two student-programmers are sitting.Consider that initially occupied seat places are occupied by jury members (who obviously are not students at all)." 1300

962A Equator implementation "Polycarp has created his own training plan to prepare for the programming contests. He will train for n days, all days are numbered from 1 to n, beginning from the first.On the i-th day Polycarp will necessarily solve ai problems. One evening Polycarp plans to celebrate the equator. He will celebrate it on the first evening of such a day that from the beginning of the training and to this day inclusive he will solve half or more of all the problems.Determine the index of day when Polycarp will celebrate the equator." 1300

961G Partitions "combinatorics,math,number theory" "You are given a set of n elements indexed from 1 to n. The weight of i-th element is wi. The weight of some subset of a given set is denoted as . The weight of some partition R of a given set into k subsets is  (recall that a partition of a given set is a set of its subsets such that every element of the given set belongs to exactly one subset in partition).Calculate the sum of weights of all partitions of a given set into exactly k non-empty subsets, and print it modulo 109\xe2\x80\x89+\xe2\x80\x897. Two partitions are considered different iff there exist two elements x and y such that they belong to the same set in one of the partitions, and to different sets in another partition." 2700

961F k-substrings "binary search,hashing,string suffix structures" "You are given a string s consisting of n lowercase Latin letters.Let\'s denote k-substring of s as a string subsk\xe2\x80\x89=\xe2\x80\x89sksk\xe2\x80\x89+\xe2\x80\x891..sn\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89k. Obviously, subs1\xe2\x80\x89=\xe2\x80\x89s, and there are exactly  such substrings.Let\'s call some string t an odd proper suprefix of a string T iff the following conditions are met: |T|\xe2\x80\x89>\xe2\x80\x89|t|;  |t| is an odd number;  t is simultaneously a prefix and a suffix of T.For evey k-substring () of s you have to calculate the maximum length of its odd proper suprefix." 2700

961E Tufurama "data structures" "One day Polycarp decided to rewatch his absolute favourite episode of well-known TV series ""Tufurama"". He was pretty surprised when he got results only for season 7 episode 3 with his search query of ""Watch Tufurama season 3 episode 7 online full hd free"". This got Polycarp confused \xe2\x80\x94 what if he decides to rewatch the entire series someday and won\'t be able to find the right episodes to watch? Polycarp now wants to count the number of times he will be forced to search for an episode using some different method.TV series have n seasons (numbered 1 through n), the i-th season has ai episodes (numbered 1 through ai). Polycarp thinks that if for some pair of integers x and y (x\xe2\x80\x89<\xe2\x80\x89y) exist both season x episode y and season y episode x then one of these search queries will include the wrong results. Help Polycarp to calculate the number of such pairs!" 1900

961D "Pair Of Lines" geometry "You are given n points on Cartesian plane. Every point is a lattice point (i.\xe2\x80\x89e. both of its coordinates are integers), and all points are distinct.You may draw two straight lines (not necessarily distinct). Is it possible to do this in such a way that every point lies on at least one of these lines?" 2000

961C Chessboard "bitmasks,brute force,implementation" "Magnus decided to play a classic chess game. Though what he saw in his locker shocked him! His favourite chessboard got broken into 4 pieces, each of size n by n, n is always odd. And what\'s even worse, some squares were of wrong color. j-th square of the i-th row of k-th piece of the board has color ak,\xe2\x80\x89i,\xe2\x80\x89j; 1 being black and 0 being white. Now Magnus wants to change color of some squares in such a way that he recolors minimum number of squares and obtained pieces form a valid chessboard. Every square has its color different to each of the neightbouring by side squares in a valid board. Its size should be 2n by 2n. You are allowed to move pieces but not allowed to rotate or flip them." 1400

961B "Lecture Sleep" "data structures,dp,implementation,two pointers" "Your friend Mishka and you attend a calculus lecture. Lecture lasts n minutes. Lecturer tells ai theorems during the i-th minute.Mishka is really interested in calculus, though it is so hard to stay awake for all the time of lecture. You are given an array t of Mishka\'s behavior. If Mishka is asleep during the i-th minute of the lecture then ti will be equal to 0, otherwise it will be equal to 1. When Mishka is awake he writes down all the theorems he is being told \xe2\x80\x94 ai during the i-th minute. Otherwise he writes nothing.You know some secret technique to keep Mishka awake for k minutes straight. However you can use it only once. You can start using it at the beginning of any minute between 1 and n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891. If you use it on some minute i then Mishka will be awake during minutes j such that  and will write down all the theorems lecturer tells.You task is to calculate the maximum number of theorems Mishka will be able to write down if you use your technique only once to wake him up." 1200

961A Tetris implementation "You are given a following process. There is a platform with n columns. 1\xc3\x971 squares are appearing one after another in some columns on this platform. If there are no squares in the column, a square will occupy the bottom row. Otherwise a square will appear at the top of the highest square of this column. When all of the n columns have at least one square in them, the bottom row is being removed. You will receive 1 point for this, and all the squares left will fall down one row. You task is to calculate the amount of points you will receive." 900

960H "Santa\'s Gift" "data structures,trees" "You are given a following process. There is a platform with n columns. 1\xc3\x971 squares are appearing one after another in some columns on this platform. If there are no squares in the column, a square will occupy the bottom row. Otherwise a square will appear at the top of the highest square of this column. When all of the n columns have at least one square in them, the bottom row is being removed. You will receive 1 point for this, and all the squares left will fall down one row. You task is to calculate the amount of points you will receive." 3100

960G "Bandit Blues" combinatorics,dp,fft,math "Japate, while traveling through the forest of Mala, saw N bags of gold lying in a row. Each bag has some distinct weight of gold between 1 to N. Japate can carry only one bag of gold with him, so he uses the following strategy to choose a bag.Initially, he starts with an empty bag (zero weight). He considers the bags in some order. If the current bag has a higher weight than the bag in his hand, he picks the current bag.Japate put the bags in some order. Japate realizes that he will pick A bags, if he starts picking bags from the front, and will pick B bags, if he starts picking bags from the back. By picking we mean replacing the bag in his hand with the current one.Now he wonders how many permutations of bags are possible, in which he picks A bags from the front and B bags from back using the above strategy.Since the answer can be very large, output it modulo 998244353." 2900

960F Pathwalks "data structures,dp,graphs" "You are given a directed graph with n nodes and m edges, with all edges having a certain weight. There might be multiple edges and self loops, and the graph can also be disconnected. You need to choose a path (possibly passing through same vertices multiple times) in the graph such that the weights of the edges are in strictly increasing order, and these edges come in the order of input. Among all such paths, you need to find the the path that has the maximum possible number of edges, and report this value.Please note that the edges picked don\'t have to be consecutive in the input." 2100

960E "Alternating Tree" "combinatorics,dfs and similar,divide and conquer,dp,probabilities,trees" "Given a tree with n nodes numbered from 1 to n. Each node i has an associated value Vi.If the simple path from u1 to um consists of m nodes namely u1\xe2\x86\x92u2\xe2\x86\x92u3\xe2\x86\x92\xe2\x80\xa6um\xe2\x88\x921\xe2\x86\x92um, then its alternating function A(u1,um) is defined as A(u1,um)=m\xe2\x88\x91i=1(\xe2\x88\x921)i+1\xe2\x8b\x85Vui. A path can also have 0 edges, i.e. u1=um.Compute the sum of alternating functions of all unique simple paths. Note that the paths are directed: two paths are considered different if the starting vertices differ or the ending vertices differ. The answer may be large so compute it modulo 109+7." 2300

960D "Full Binary Tree Queries" "brute force,implementation,trees" "You have a full binary tree having infinite levels.Each node has an initial value. If a node has value x, then its left child has value 2\xc2\xb7x and its right child has value 2\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891. The value of the root is 1. You need to answer Q queries. There are 3 types of queries:  Cyclically shift the values of all nodes on the same level as node with value X by K units. (The values/nodes of any other level are not affected). Cyclically shift the nodes on the same level as node with value X by K units. (The subtrees of these nodes will move along with them). Print the value of every node encountered on the simple path from the node with value X to the root.Positive K implies right cyclic shift and negative K implies left cyclic shift. It is guaranteed that atleast one type 3 query is present." 2100

960C "Subsequence Counting" "bitmasks,constructive algorithms,greedy,implementation" "Pikachu had an array with him. He wrote down all the non-empty subsequences of the array on paper. Note that an array of size n has 2n\xe2\x80\x89-\xe2\x80\x891 non-empty subsequences in it. Pikachu being mischievous as he always is, removed all the subsequences in which Maximum_element_of_the_subsequence \xe2\x80\x89-\xe2\x80\x89 Minimum_element_of_subsequence \xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89dPikachu was finally left with X subsequences. However, he lost the initial array he had, and now is in serious trouble. He still remembers the numbers X and d. He now wants you to construct any such array which will satisfy the above conditions. All the numbers in the final array should be positive integers less than 1018. Note the number of elements in the output array should not be more than 104. If no answer is possible, print \xe2\x80\x89-\xe2\x80\x891." 1700

960B "Minimize the error" "data structures,greedy,sortings" "You are given two arrays A and B, each of size n. The error, E, between these two arrays is defined . You have to perform exactly k1 operations on array A and exactly k2 operations on array B. In one operation, you have to choose one element of the array and increase or decrease it by 1.Output the minimum possible value of error after k1 operations on array A and k2 operations on array B have been performed." 1500

960A "Check the string" implementation "A has a string consisting of some number of lowercase English letters \'a\'. He gives it to his friend B who appends some number of letters \'b\' to the end of this string. Since both A and B like the characters \'a\' and \'b\', they have made sure that at this point, at least one \'a\' and one \'b\' exist in the string.B now gives this string to C and he appends some number of letters \'c\' to the end of the string. However, since C is a good friend of A and B, the number of letters \'c\' he appends is equal to the number of \'a\' or to the number of \'b\' in the string. It is also possible that the number of letters \'c\' equals both to the number of letters \'a\' and to the number of letters \'b\' at the same time.You have a string in your hands, and you want to check if it is possible to obtain the string in this way or not. If it is possible to obtain the string, print ""YES"", otherwise print ""NO"" (without the quotes)." 1200

959F "Mahmoud and Ehab and yet another xor task" bitmasks,dp,math,matrices "Ehab has an array a of n integers. He likes the bitwise-xor operation and he likes to bother Mahmoud so he came up with a problem. He gave Mahmoud q queries. In each of them, he gave Mahmoud 2 integers l and x, and asked him to find the number of subsequences of the first l elements of the array such that their bitwise-xor sum is x. Can you help Mahmoud answer the queries?A subsequence can contain elements that are not neighboring." 2400

959E "Mahmoud and Ehab and the xor-MST" bitmasks,dp,graphs,implementation,math "Ehab is interested in the bitwise-xor operation and the special graphs. Mahmoud gave him a problem that combines both. He has a complete graph consisting of n vertices numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891. For all 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89<\xe2\x80\x89n, vertex u and vertex v are connected with an undirected edge that has weight  (where  is the bitwise-xor operation). Can you find the weight of the minimum spanning tree of that graph?You can read about complete graphs in https://en.wikipedia.org/wiki/Complete_graphYou can read about the minimum spanning tree in https://en.wikipedia.org/wiki/Minimum_spanning_treeThe weight of the minimum spanning tree is the sum of the weights on the edges included in it." 1900

959D "Mahmoud and Ehab and another array construction task" "constructive algorithms,greedy,math,number theory" "Mahmoud has an array a consisting of n integers. He asked Ehab to find another array b of the same length such that:  b is lexicographically greater than or equal to a.  bi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892.  b is pairwise coprime: for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, bi and bj are coprime, i.�e. GCD(bi,\xe2\x80\x89bj)\xe2\x80\x89=\xe2\x80\x891, where GCD(w,\xe2\x80\x89z) is the greatest common divisor of w and z. Ehab wants to choose a special array so he wants the lexicographically minimal array between all the variants. Can you find it?An array x is lexicographically greater than an array y if there exists an index i such than xi\xe2\x80\x89>\xe2\x80\x89yi and xj\xe2\x80\x89=\xe2\x80\x89yj for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89i. An array x is equal to an array y if xi\xe2\x80\x89=\xe2\x80\x89yi for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 1900

959C "Mahmoud and Ehab and the wrong algorithm" "constructive algorithms,trees" "Mahmoud was trying to solve the vertex cover problem on trees. The problem statement is:Given an undirected tree consisting of n nodes, find the minimum number of vertices that cover all the edges. Formally, we need to find a set of vertices such that for each edge (u,\xe2\x80\x89v) that belongs to the tree, either u is in the set, or v is in the set, or both are in the set. Mahmoud has found the following algorithm:  Root the tree at node 1.  Count the number of nodes at an even depth. Let it be evenCnt.  Count the number of nodes at an odd depth. Let it be oddCnt.  The answer is the minimum between evenCnt and oddCnt. The depth of a node in a tree is the number of edges in the shortest path between this node and the root. The depth of the root is 0.Ehab told Mahmoud that this algorithm is wrong, but he didn\'t believe because he had tested his algorithm against many trees and it worked, so Ehab asked you to find 2 trees consisting of n nodes. The algorithm should find an incorrect answer for the first tree and a correct answer for the second one." 1500

959B "Mahmoud and Ehab and the message" dsu,greedy,implementation "Mahmoud wants to send a message to his friend Ehab. Their language consists of n words numbered from 1 to n. Some words have the same meaning so there are k groups of words such that all the words in some group have the same meaning.Mahmoud knows that the i-th word can be sent with cost ai. For each word in his message, Mahmoud can either replace it with another word of the same meaning or leave it as it is. Can you help Mahmoud determine the minimum cost of sending the message?The cost of sending the message is the sum of the costs of sending every word in it." 1200

959A "Mahmoud and Ehab and the even-odd game" games,math "Mahmoud and Ehab play a game called the even-odd game. Ehab chooses his favorite integer n and then they take turns, starting from Mahmoud. In each player\'s turn, he has to choose an integer a and subtract it from n such that:  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.  If it\'s Mahmoud\'s turn, a has to be even, but if it\'s Ehab\'s turn, a has to be odd. If the current player can\'t choose any number satisfying the conditions, he loses. Can you determine the winner if they both play optimally?" 800

958F3 "Lightsabers (hard)" fft "There used to be unrest in the Galactic Senate. Several thousand solar systems had declared their intentions to leave the Republic. But fear not! Master Heidi was able to successfully select the Jedi Knights that have restored peace in the galaxy. However, she knows that evil never sleeps and a time may come when she will need to pick another group of Jedi Knights. She wants to be sure she has enough options to do so.There are n Jedi Knights, each of them with a lightsaber of one of m colors. Given a number k, compute the number of differently colored collections of k lightsabers that some k Jedi Knights might have. Jedi Knights with lightsabers of the same color are indistinguishable (it\'s not the person, it\'s the lightsaber color that matters!), and their order does not matter; that is, we consider two collections of Jedi Knights to be different if and only if their vectors of counts of lightsabers of each color (like what you were given in the easy and the medium versions) are different. We count all subsets, not only contiguous subsegments of the input sequence. Output the answer modulo 1009." 2600

958F2 "Lightsabers (medium)" "binary search,two pointers" "There is unrest in the Galactic Senate. Several thousand solar systems have declared their intentions to leave the Republic. Master Heidi needs to select the Jedi Knights who will go on peacekeeping missions throughout the galaxy. It is well-known that the success of any peacekeeping mission depends on the colors of the lightsabers of the Jedi who will go on that mission. Heidi has n Jedi Knights standing in front of her, each one with a lightsaber of one of m possible colors. She knows that for the mission to be the most effective, she needs to select some contiguous interval of knights such that there are exactly k1 knights with lightsabers of the first color, k2 knights with lightsabers of the second color, ..., km knights with lightsabers of the m-th color.However, since the last time, she has learned that it is not always possible to select such an interval. Therefore, she decided to ask some Jedi Knights to go on an indefinite unpaid vacation leave near certain pits on Tatooine, if you know what I mean. Help Heidi decide what is the minimum number of Jedi Knights that need to be let go before she is able to select the desired interval from the subsequence of remaining knights." 1800

958F1 "Lightsabers (easy)" implementation "There is unrest in the Galactic Senate. Several thousand solar systems have declared their intentions to leave the Republic. Master Heidi needs to select the Jedi Knights who will go on peacekeeping missions throughout the galaxy. It is well-known that the success of any peacekeeping mission depends on the colors of the lightsabers of the Jedi who will go on that mission. Heidi has n Jedi Knights standing in front of her, each one with a lightsaber of one of m possible colors. She knows that for the mission to be the most effective, she needs to select some contiguous interval of knights such that there are exactly k1 knights with lightsabers of the first color, k2 knights with lightsabers of the second color, ..., km knights with lightsabers of the m-th color. Help her find out if this is possible." 1500

958E3 "Guard Duty (hard)" geometry "Now that Heidi knows that she can assign Rebel spaceships to bases (recall the easy subtask), she is asking you: how exactly to do this? Now, given positions of N spaceships and N bases on a plane, your task is to connect spaceships and bases with line segments so that:   The segments do not intersect.  Such a connection forms a perfect matching." 2700

958E2 "Guard Duty (medium)" "binary search,dp,greedy,sortings" "Princess Heidi decided to give orders to all her K Rebel ship commanders in person. Unfortunately, she is currently travelling through hyperspace, and will leave it only at N specific moments t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tN. The meetings with commanders must therefore start and stop at those times. Namely, each commander will board her ship at some time ti and disembark at some later time tj. Of course, Heidi needs to meet with all commanders, and no two meetings can be held during the same time. Two commanders cannot even meet at the beginnings/endings of the hyperspace jumps, because too many ships in one position could give out their coordinates to the enemy. Your task is to find minimum time that Princess Heidi has to spend on meetings, with her schedule satisfying the conditions above." 2200

958E1 "Guard Duty (easy)" "brute force,geometry,greedy,math" "The Rebel fleet is afraid that the Empire might want to strike back again. Princess Heidi needs to know if it is possible to assign R Rebel spaceships to guard B bases so that every base has exactly one guardian and each spaceship has exactly one assigned base (in other words, the assignment is a perfect matching). Since she knows how reckless her pilots are, she wants to be sure that any two (straight) paths \xe2\x80\x93 from a base to its assigned spaceship \xe2\x80\x93 do not intersect in the galaxy plane (that is, in 2D), and so there is no risk of collision." 1600

958D2 "Hyperspace Jump (hard)" NA "It is now 125 years later, but humanity is still on the run from a humanoid-cyborg race determined to destroy it. Or perhaps we are getting some stories mixed up here... In any case, the fleet is now smaller. However, in a recent upgrade, all the navigation systems have been outfitted with higher-dimensional, linear-algebraic jump processors.Now, in order to make a jump, a ship\'s captain needs to specify a subspace of the d-dimensional space in which the events are taking place. She does so by providing a generating set of vectors for that subspace.Princess Heidi has received such a set from the captain of each of m ships. Again, she would like to group up those ships whose hyperspace jump subspaces are equal. To do so, she wants to assign a group number between 1 and m to each of the ships, so that two ships have the same group number if and only if their corresponding subspaces are equal (even though they might be given using different sets of vectors).Help Heidi!" 2700

958D1 "Hyperspace Jump (easy)" "expression parsing,math" "The Rebel fleet is on the run. It consists of m ships currently gathered around a single planet. Just a few seconds ago, the vastly more powerful Empire fleet has appeared in the same solar system, and the Rebels will need to escape into hyperspace. In order to spread the fleet, the captain of each ship has independently come up with the coordinate to which that ship will jump. In the obsolete navigation system used by the Rebels, this coordinate is given as the value of an arithmetic expression of the form .To plan the future of the resistance movement, Princess Heidi needs to know, for each ship, how many ships are going to end up at the same coordinate after the jump. You are her only hope!" 1400

958C3 "Encryption (hard)" "data structures,dp" "Heidi is now just one code away from breaking the encryption of the Death Star plans. The screen that should be presenting her with the description of the next code looks almost like the previous one, though who would have thought that the evil Empire engineers would fill this small screen with several million digits! It is just ridiculous to think that anyone would read them all...Heidi is once again given a sequence A and two integers k and p. She needs to find out what the encryption key S is.Let X be a sequence of integers, and p a positive integer. We define the score of X to be the sum of the elements of X modulo p.Heidi is given a sequence A that consists of N integers, and also given integers k and p. Her goal is to split A into k parts such that:   Each part contains at least 1 element of A, and each part consists of contiguous elements of A.  No two parts overlap.  The total sum S of the scores of those parts is minimized (not maximized!). Output the sum S, which is the encryption code." 2500

958C2 "Encryption (medium)" dp "Heidi has now broken the first level of encryption of the Death Star plans, and is staring at the screen presenting her with the description of the next code she has to enter. It looks surprisingly similar to the first one \xe2\x80\x93 seems like the Empire engineers were quite lazy...Heidi is once again given a sequence A, but now she is also given two integers k and p. She needs to find out what the encryption key S is.Let X be a sequence of integers, and p a positive integer. We define the score of X to be the sum of the elements of X modulo p.Heidi is given a sequence A that consists of N integers, and also given integers k and p. Her goal is to split A into k part such that:   Each part contains at least 1 element of A, and each part consists of contiguous elements of A.  No two parts overlap.  The total sum S of the scores of those parts is maximized. Output the sum S \xe2\x80\x93 the encryption code." 2000

958C1 "Encryption (easy)" "brute force" "Rebel spy Heidi has just obtained the plans for the Death Star from the Empire and, now on her way to safety, she is trying to break the encryption of the plans (of course they are encrypted \xe2\x80\x93 the Empire may be evil, but it is not stupid!). The encryption has several levels of security, and here is how the first one looks.Heidi is presented with a screen that shows her a sequence of integers A and a positive integer p. She knows that the encryption code is a single number S, which is defined as follows:Define the score of X to be the sum of the elements of X modulo p.Heidi is given a sequence A that consists of N integers, and also given an integer p. She needs to split A into 2 parts such that:   Each part contains at least 1 element of A, and each part consists of contiguous elements of A.  The two parts do not overlap.  The total sum S of the scores of those two parts is maximized. This is the encryption code. Output the sum S, which is the encryption code." 1200

958B2 "Maximum Control (medium)" "data structures,dfs and similar,graphs,greedy,trees" "The Resistance is trying to take control over as many planets of a particular solar system as possible. Princess Heidi is in charge of the fleet, and she must send ships to some planets in order to maximize the number of controlled planets.The Galaxy contains N planets, connected by bidirectional hyperspace tunnels in such a way that there is a unique path between every pair of the planets.A planet is controlled by the Resistance if there is a Resistance ship in its orbit, or if the planet lies on the shortest path between some two planets that have Resistance ships in their orbits.Heidi has not yet made up her mind as to how many ships to use. Therefore, she is asking you to compute, for every K\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89N, the maximum number of planets that can be controlled with a fleet consisting of K ships." 2200

958B1 "Maximum Control (easy)" implementation "The Resistance is trying to take control over all planets in a particular solar system. This solar system is shaped like a tree. More precisely, some planets are connected by bidirectional hyperspace tunnels in such a way that there is a path between every pair of the planets, but removing any tunnel would disconnect some of them.The Resistance already has measures in place that will, when the time is right, enable them to control every planet that is not remote. A planet is considered to be remote if it is connected to the rest of the planets only via a single hyperspace tunnel.How much work is there left to be done: that is, how many remote planets are there?" 1000

958A3 "Death Stars (hard)" NA "The stardate is 2015, and Death Stars are bigger than ever! This time, two rebel spies have yet again given Heidi two maps with the possible locations of the Death Stars.Heidi has now received two maps with possible locations of N Death Stars. She knows that each of the maps is possibly corrupted, and may contain some stars that are not Death Stars. Furthermore, each of the maps was created from a different point of view. Hence, stars that are shown in one of the maps are rotated and translated with respect to the other map. Now Heidi wants to find out which of the stars shown in both maps are actually Death Stars, and the correspondence between the Death Stars on the two maps." 3100

958A2 "Death Stars (medium)" hashing,strings "The stardate is 1983, and Princess Heidi is getting better at detecting the Death Stars. This time, two Rebel spies have yet again given Heidi two maps with the possible locations of the Death Star. Since she got rid of all double agents last time, she knows that both maps are correct, and indeed show the map of the solar system that contains the Death Star. However, this time the Empire has hidden the Death Star very well, and Heidi needs to find a place that appears on both maps in order to detect the Death Star.The first map is an N\xe2\x80\x89\xc3\x97\xe2\x80\x89M grid, each cell of which shows some type of cosmic object that is present in the corresponding quadrant of space. The second map is an M\xe2\x80\x89\xc3\x97\xe2\x80\x89N grid. Heidi needs to align those two maps in such a way that they overlap over some M\xe2\x80\x89\xc3\x97\xe2\x80\x89M section in which all cosmic objects are identical. Help Heidi by identifying where such an M\xe2\x80\x89\xc3\x97\xe2\x80\x89M section lies within both maps." 2000

958A1 "Death Stars (easy)" implementation "The stardate is 1977 and the science and art of detecting Death Stars is in its infancy. Princess Heidi has received information about the stars in the nearby solar system from the Rebel spies and now, to help her identify the exact location of the Death Star, she needs to know whether this information is correct. Two rebel spies have provided her with the maps of the solar system. Each map is an N\xe2\x80\x89\xc3\x97\xe2\x80\x89N grid, where each cell is either occupied by a star or empty. To see whether the information is correct, Heidi needs to know whether the two maps are of the same solar system, or if possibly one of the spies is actually an Empire double agent, feeding her false information.Unfortunately, spies may have accidentally rotated a map by 90, 180, or 270 degrees, or flipped it along the vertical or the horizontal axis, before delivering it to Heidi. If Heidi can rotate or flip the maps so that two of them become identical, then those maps are of the same solar system. Otherwise, there are traitors in the Rebel ranks! Help Heidi find out." 1400

957A "Tritonic Iridescence" implementation "Overlooking the captivating blend of myriads of vernal hues, Arkady the painter lays out a long, long canvas.Arkady has a sufficiently large amount of paint of three colours: cyan, magenta, and yellow. On the one-dimensional canvas split into n consecutive segments, each segment needs to be painted in one of the colours.Arkady has already painted some (possibly none or all) segments and passes the paintbrush to you. You are to determine whether there are at least two ways of colouring all the unpainted segments so that no two adjacent segments are of the same colour. Two ways are considered different if and only if a segment is painted in different colours in them." 1300

955F Heaps dp,trees "You\'re given a tree with n vertices rooted at 1.We say that there\'s a k-ary heap of depth m located at u if the following holds:  For m\xe2\x80\x89=\xe2\x80\x891 u itself is a k-ary heap of depth 1.  For m\xe2\x80\x89>\xe2\x80\x891 vertex u is a k-ary heap of depth m if at least k of its children are k-ary heaps of depth at least m\xe2\x80\x89-\xe2\x80\x891. Denote dpk(u) as maximum depth of k-ary heap in the subtree of u (including u). Your goal is to compute ." 2600

955E Icicles NA "Andrew\'s favourite Krakozyabra has recenly fled away and now he\'s eager to bring it back!At the moment the refugee is inside an icy cave with n icicles dangling from the ceiling located in integer coordinates numbered from 1 to n. The distance between floor and the i-th icicle is equal to ai.Andrew is free to choose an arbitrary integer point T in range from 1 to n inclusive and at time instant 0 launch a sound wave spreading into both sides (left and right) at the speed of one point per second. Any icicle touched by the wave starts falling at the same speed (that means that in a second the distance from floor to icicle decreases by one but cannot become less that zero). While distance from icicle to floor is more than zero, it is considered passable; as soon as it becomes zero, the icicle blocks the path and prohibits passing.Krakozyabra is initially (i.e. at time instant 0) is located at point  and starts running in the right direction at the speed of one point per second. You can assume that events in a single second happen in the following order: first Krakozyabra changes its position, and only then the sound spreads and icicles fall; in particular, that means that if Krakozyabra is currently at point  and the falling (i.e. already touched by the sound wave) icicle at point i is 1 point from the floor, then Krakozyabra will pass it and find itself at  and only after that the icicle will finally fall and block the path.Krakozyabra is considered entrapped if there are fallen (i.e. with ai\xe2\x80\x89=\xe2\x80\x890) icicles both to the left and to the right of its current position. Help Andrew find the minimum possible time it takes to entrap Krakozyabra by choosing the optimal value of T or report that this mission is impossible." 2900

955D Scissors "brute force,strings" "Jenya has recently acquired quite a useful tool \xe2\x80\x94 k-scissors for cutting strings. They are generally used for cutting out two non-intersecting substrings of length k from an arbitrary string s (its length should be at least 2\xc2\xb7k in order to perform this operation) and concatenating them afterwards (preserving the initial order). For example, with the help of 2-scissors you can cut ab and de out of abcde and concatenate them into abde, but not ab and bc since they\'re intersecting.It\'s a nice idea to test this tool before using it in practice. After looking through the papers, Jenya came up with two strings s and t. His question is whether it is possible to apply his scissors to string s such that the resulting concatenation contains t as a substring?" 2600

955C "Sad powers" "binary search,math,number theory" "You\'re given Q queries of the form (L,\xe2\x80\x89R). For each query you have to find the number of such x that L\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89R and there exist integer numbers a\xe2\x80\x89>\xe2\x80\x890, p\xe2\x80\x89>\xe2\x80\x891 such that x\xe2\x80\x89=\xe2\x80\x89ap." 2100

955B "Not simply beatiful strings" implementation "Let\'s call a string adorable if its letters can be realigned in such a way that they form two consequent groups of equal symbols (note that different groups must contain different symbols). For example, ababa is adorable (you can transform it to aaabb, where the first three letters form a group of a-s and others \xe2\x80\x94 a group of b-s), but cccc is not since in each possible consequent partition letters in these two groups coincide.You\'re given a string s. Check whether it can be split into two non-empty subsequences such that the strings formed by these subsequences are adorable. Here a subsequence is an arbitrary set of indexes of the string." 1400

955A "Feed the cat" greedy,math "After waking up at hh:mm, Andrew realised that he had forgotten to feed his only cat for yet another time (guess why there\'s only one cat). The cat\'s current hunger level is H points, moreover each minute without food increases his hunger by D points.At any time Andrew can visit the store where tasty buns are sold (you can assume that is doesn\'t take time to get to the store and back). One such bun costs C roubles and decreases hunger by N points. Since the demand for bakery drops heavily in the evening, there is a special 20% discount for buns starting from 20:00 (note that the cost might become rational). Of course, buns cannot be sold by parts.Determine the minimum amount of money Andrew has to spend in order to feed his cat. The cat is considered fed if its hunger level is less than or equal to zero." 1100

954I "Yet Another String Matching Problem" fft,math "Suppose you have two strings s and t, and their length is equal. You may perform the following operation any number of times: choose two different characters c1 and c2, and replace every occurence of c1 in both strings with c2. Let\'s denote the distance between strings s and t as the minimum number of operations required to make these strings equal. For example, if s is abcd and t is ddcb, the distance between them is 2 \xe2\x80\x94 we may replace every occurence of a with b, so s becomes bbcd, and then we may replace every occurence of b with d, so both strings become ddcd.You are given two strings S and T. For every substring of S consisting of |T| characters you have to determine the distance between this substring and T." 2200

954H "Path Counting" combinatorics,dp "You are given a rooted tree. Let\'s denote d(x) as depth of node x: depth of the root is 1, depth of any other node x is d(y)\xe2\x80\x89+\xe2\x80\x891, where y is a parent of x.The tree has the following property: every node x with d(x)\xe2\x80\x89=\xe2\x80\x89i has exactly ai children. Maximum possible depth of a node is n, and an\xe2\x80\x89=\xe2\x80\x890.We define fk as the number of unordered pairs of vertices in the tree such that the number of edges on the simple path between them is equal to k.Calculate fk modulo 109\xe2\x80\x89+\xe2\x80\x897 for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n\xe2\x80\x89-\xe2\x80\x892." 2500

954G "Castle Defense" "binary search,data structures,greedy,two pointers" "Today you are going to lead a group of elven archers to defend the castle that is attacked by an army of angry orcs. Three sides of the castle are protected by impassable mountains and the remaining side is occupied by a long wall that is split into n sections. At this moment there are exactly ai archers located at the i-th section of this wall. You know that archer who stands at section i can shoot orcs that attack section located at distance not exceeding r, that is all such sections j that |i\xe2\x80\x89-\xe2\x80\x89j|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. In particular, r\xe2\x80\x89=\xe2\x80\x890 means that archers are only capable of shooting at orcs who attack section i.Denote as defense level of section i the total number of archers who can shoot at the orcs attacking this section. Reliability of the defense plan is the minimum value of defense level of individual wall section.There is a little time left till the attack so you can\'t redistribute archers that are already located at the wall. However, there is a reserve of k archers that you can distribute among wall sections in arbitrary way. You would like to achieve maximum possible reliability of the defence plan." 2000

954F "Runner\'s Problem" dp,matrices,sortings "Today you are going to lead a group of elven archers to defend the castle that is attacked by an army of angry orcs. Three sides of the castle are protected by impassable mountains and the remaining side is occupied by a long wall that is split into n sections. At this moment there are exactly ai archers located at the i-th section of this wall. You know that archer who stands at section i can shoot orcs that attack section located at distance not exceeding r, that is all such sections j that |i\xe2\x80\x89-\xe2\x80\x89j|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. In particular, r\xe2\x80\x89=\xe2\x80\x890 means that archers are only capable of shooting at orcs who attack section i.Denote as defense level of section i the total number of archers who can shoot at the orcs attacking this section. Reliability of the defense plan is the minimum value of defense level of individual wall section.There is a little time left till the attack so you can\'t redistribute archers that are already located at the wall. However, there is a reserve of k archers that you can distribute among wall sections in arbitrary way. You would like to achieve maximum possible reliability of the defence plan." 2100

954E "Water Taps" "binary search,greedy,sortings" "Consider a system of n water taps all pouring water into the same container. The i-th water tap can be set to deliver any amount of water from 0 to ai ml per second (this amount may be a real number). The water delivered by i-th tap has temperature ti.If for every  you set i-th tap to deliver exactly xi ml of water per second, then the resulting temperature of water will be  (if , then to avoid division by zero we state that the resulting water temperature is 0).You have to set all the water taps in such a way that the resulting temperature is exactly T. What is the maximum amount of water you may get per second if its temperature has to be T?" 2000

954D "Fight Against Traffic" "dfs and similar,graphs,shortest paths" "Little town Nsk consists of n junctions connected by m bidirectional roads. Each road connects two distinct junctions and no two roads connect the same pair of junctions. It is possible to get from any junction to any other junction by these roads. The distance between two junctions is equal to the minimum possible number of roads on a path between them.In order to improve the transportation system, the city council asks mayor to build one new road. The problem is that the mayor has just bought a wonderful new car and he really enjoys a ride from his home, located near junction s to work located near junction t. Thus, he wants to build a new road in such a way that the distance between these two junctions won\'t decrease. You are assigned a task to compute the number of pairs of junctions that are not connected by the road, such that if the new road between these two junctions is built the distance between s and t won\'t decrease." 1600

954C "Matrix Walk" implementation "There is a matrix A of size x\xe2\x80\x89\xc3\x97\xe2\x80\x89y filled with integers. For every ,  Ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89y(i\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89j. Obviously, every integer from [1..xy] occurs exactly once in this matrix. You have traversed some path in this matrix. Your path can be described as a sequence of visited cells a1, a2, ..., an denoting that you started in the cell containing the number a1, then moved to the cell with the number a2, and so on.From the cell located in i-th line and j-th column (we denote this cell as (i,\xe2\x80\x89j)) you can move into one of the following cells: (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j) \xe2\x80\x94 only if i\xe2\x80\x89<\xe2\x80\x89x;  (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 only if j\xe2\x80\x89<\xe2\x80\x89y;  (i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j) \xe2\x80\x94 only if i\xe2\x80\x89>\xe2\x80\x891;  (i,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891) \xe2\x80\x94 only if j\xe2\x80\x89>\xe2\x80\x891.Notice that making a move requires you to go to an adjacent cell. It is not allowed to stay in the same cell. You don\'t know x and y exactly, but you have to find any possible values for these numbers such that you could start in the cell containing the integer a1, then move to the cell containing a2 (in one step), then move to the cell containing a3 (also in one step) and so on. Can you choose x and y so that they don\'t contradict with your sequence of moves?" 1700

954B "String Typing" implementation,strings "You are given a string s consisting of n lowercase Latin letters. You have to type this string using your keyboard.Initially, you have an empty string. Until you type the whole string, you may perform the following operation:  add a character to the end of the string. Besides, at most once you may perform one additional operation: copy the string and append it to itself.For example, if you have to type string abcabca, you can type it in 7 operations if you type all the characters one by one. However, you can type it in 5 operations if you type the string abc first and then copy it and type the last character.If you have to type string aaaaaaaaa, the best option is to type 4 characters one by one, then copy the string, and then type the remaining character.Print the minimum number of operations you need to type the given string." 1400

954A "Diagonal Walking" implementation "Mikhail walks on a 2D plane. He can go either up or right. You are given a sequence of Mikhail\'s moves. He thinks that this sequence is too long and he wants to make it as short as possible.In the given sequence moving up is described by character U and moving right is described by character R. Mikhail can replace any pair of consecutive moves RU or UR with a diagonal move (described as character D). After that, he can go on and do some other replacements, until there is no pair of consecutive moves RU or UR left.Your problem is to print the minimum possible length of the sequence of moves after the replacements." 800

952G "Puzzling Language" "constructive algorithms" "In this problem you will write a simple code generator for a 2D programming language derived from Brainfuck.The code in this language is a rectangular grid of characters \'.\' and \'X\'. The code is converted to a Brainfuck program as follows: the characters are read in the usual order (top to bottom, left to right), and each \'X\' character is converted a Brainfuck instruction to be executed. The instruction is defined by the left, top and right neighbors of the \'X\' character using the following conversion table:  You are given a string. Output a program in the described language which prints this string.You can download the language interpreter used for judging here: https://assets.codeforces.com/rounds/952/puzzling-interpreter.cpp (use C++11 to compile the code). Note several implementation details: The first step of the language interpretation is conversion to a Brainfuck program, which is then executed. The code must be rectangular, with all lines of the same length. It can have at most 10,000 lines and 10,000 columns, and can have at most 500,000 \'X\' characters. The code has toroidal topology, i.e. the \'X\' on the first line will have top neighbor in the last line. Brainfuck interpreter has 30000 memory cells which store integers from 0 to 255 with increment/decrement done modulo 256. Console input (, command) is allowed in Brainfuck code but has no effect when executed." 2200

952F "2 + 2 != 4" NA "One very experienced problem writer decided to prepare a problem for April Fools Day contest. The task was very simple - given an arithmetic expression, return the result of evaluating this expression. However, looks like there is a bug in the reference solution..." 2400

952E "Cheese Board" NA "Not to be confused with chessboard." 2000

952D "I\'m Feeling Lucky!" probabilities "Not to be confused with chessboard." 1800

952C "Ravioli Sort" implementation "Everybody knows of spaghetti sort. You decided to implement an analog sorting algorithm yourself, but as you survey your pantry you realize you\'re out of spaghetti! The only type of pasta you have is ravioli, but you are not going to let this stop you...You come up with the following algorithm. For each number in the array ai, build a stack of ai ravioli. The image shows the stack for ai\xe2\x80\x89=\xe2\x80\x894.  Arrange the stacks in one row in the order in which the corresponding numbers appear in the input array. Find the tallest one (if there are several stacks of maximal height, use the leftmost one). Remove it and add its height to the end of the output array. Shift the stacks in the row so that there is no gap between them. Repeat the procedure until all stacks have been removed.At first you are very happy with your algorithm, but as you try it on more inputs you realize that it doesn\'t always produce the right sorted array. Turns out when two stacks of ravioli are next to each other (at any step of the process) and differ in height by two or more, the top ravioli of the taller stack slides down on top of the lower stack.Given an input array, figure out whether the described algorithm will sort it correctly." 1600

952B "A Map of the Cat" "brute force,interactive" "If you have ever interacted with a cat, you have probably noticed that they are quite particular about how to pet them. Here is an approximate map of a normal cat.  However, some cats won\'t tolerate this nonsense from the humans. Here is a map of a grumpy cat.  You have met a cat. Can you figure out whether it\'s normal or grumpy?" 1900

952A "Quirky Quantifiers" math "InputThe input contains a single integer a (10\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89999).OutputOutput 0 or 1.ExamplesInputCopy13OutputCopy1InputCopy927OutputCopy1InputCopy48OutputCopy0" 800

950B "Intercepted Message" greedy,implementation "Hacker Zhorik wants to decipher two secret messages he intercepted yesterday. Yeah message is a sequence of encrypted blocks, each of them consists of several bytes of information.Zhorik knows that each of the messages is an archive containing one or more files. Zhorik knows how each of these archives was transferred through the network: if an archive consists of k files of sizes l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lk bytes, then the i-th file is split to one or more blocks bi,\xe2\x80\x891,\xe2\x80\x89bi,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89bi,\xe2\x80\x89mi (here the total length of the blocks bi,\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89bi,\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89bi,\xe2\x80\x89mi is equal to the length of the file li), and after that all blocks are transferred through the network, maintaining the order of files in the archive.Zhorik thinks that the two messages contain the same archive, because their total lengths are equal. However, each file can be split in blocks in different ways in the two messages.You are given the lengths of blocks in each of the two messages. Help Zhorik to determine what is the maximum number of files could be in the archive, if the Zhorik\'s assumption is correct." 1100

950A "Left-handers, Right-handers and Ambidexters" implementation,math "You are at a water bowling training. There are l people who play with their left hand, r people, who play with their right hand, and a ambidexters, who can play with left or right hand.The coach decided to form a team of even number of players, exactly half of the players should play with their right hand, and exactly half of the players should play with their left hand. One player should use only on of his hands.Ambidexters play as well with their right hand as with their left hand. In the team, an ambidexter can play with their left hand, or with their right hand.Please find the maximum possible size of the team, where equal number of players use their left and right hands, respectively." 800

949F Astronomy geometry,probabilities "You are at a water bowling training. There are l people who play with their left hand, r people, who play with their right hand, and a ambidexters, who can play with left or right hand.The coach decided to form a team of even number of players, exactly half of the players should play with their right hand, and exactly half of the players should play with their left hand. One player should use only on of his hands.Ambidexters play as well with their right hand as with their left hand. In the team, an ambidexter can play with their left hand, or with their right hand.Please find the maximum possible size of the team, where equal number of players use their left and right hands, respectively." 3300

949E "Binary Cards" "brute force" "It is never too late to play the fancy ""Binary Cards"" game!There is an infinite amount of cards of positive and negative ranks that are used in the game. The absolute value of any card rank is a power of two, i.e. each card has a rank of either 2k or \xe2\x80\x89-\xe2\x80\x892k for some integer k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890. There is an infinite amount of cards of any valid rank.At the beginning of the game player forms his deck that is some multiset (possibly empty) of cards. It is allowed to pick any number of cards of any rank but the small deck is considered to be a skill indicator. Game consists of n rounds. In the i-th round jury tells the player an integer ai. After that the player is obligated to draw such a subset of his deck that the sum of ranks of the chosen cards is equal to ai (it is allowed to not draw any cards, in which case the sum is considered to be equal to zero). If player fails to do so, he loses and the game is over. Otherwise, player takes back all of his cards into his deck and the game proceeds to the next round. Player is considered a winner if he is able to draw the suitable set of cards in each of the rounds.Somebody told you which numbers ai the jury is going to tell you in each round. Now you want to pick a deck consisting of the minimum number of cards that allows you to win the ""Binary Cards"" game." 2700

949D Curfew "binary search,brute force,greedy,sortings" "Instructors of Some Informatics School make students go to bed.The house contains n rooms, in each room exactly b students were supposed to sleep. However, at the time of curfew it happened that many students are not located in their assigned rooms. The rooms are arranged in a row and numbered from 1 to n. Initially, in i-th room there are ai students. All students are currently somewhere in the house, therefore a1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an\xe2\x80\x89=\xe2\x80\x89nb. Also 2 instructors live in this house.The process of curfew enforcement is the following. One instructor starts near room 1 and moves toward room n, while the second instructor starts near room n and moves toward room 1. After processing current room, each instructor moves on to the next one. Both instructors enter rooms and move simultaneously, if n is odd, then only the first instructor processes the middle room. When all rooms are processed, the process ends.When an instructor processes a room, she counts the number of students in the room, then turns off the light, and locks the room. Also, if the number of students inside the processed room is not equal to b, the instructor writes down the number of this room into her notebook (and turns off the light, and locks the room). Instructors are in a hurry (to prepare the study plan for the next day), so they don\'t care about who is in the room, but only about the number of students.While instructors are inside the rooms, students can run between rooms that are not locked and not being processed. A student can run by at most d rooms, that is she can move to a room with number that differs my at most d. Also, after (or instead of) running each student can hide under a bed in a room she is in. In this case the instructor will not count her during the processing. In each room any number of students can hide simultaneously.Formally, here is what\'s happening:  A curfew is announced, at this point in room i there are ai students.  Each student can run to another room but not further than d rooms away from her initial room, or stay in place. After that each student can optionally hide under a bed.  Instructors enter room 1 and room n, they count students there and lock the room (after it no one can enter or leave this room).  Each student from rooms with numbers from 2 to n\xe2\x80\x89-\xe2\x80\x891 can run to another room but not further than d rooms away from her current room, or stay in place. Each student can optionally hide under a bed.  Instructors move from room 1 to room 2 and from room n to room n\xe2\x80\x89-\xe2\x80\x891.  This process continues until all rooms are processed. Let x1 denote the number of rooms in which the first instructor counted the number of non-hidden students different from b, and x2 be the same number for the second instructor. Students know that the principal will only listen to one complaint, therefore they want to minimize the maximum of numbers xi. Help them find this value if they use the optimal strategy." 2300

949C "Data Center Maintenance" "dfs and similar,graphs" "BigData Inc. is a corporation that has n data centers indexed from 1 to n that are located all over the world. These data centers provide storage for client data (you can figure out that client data is really big!).Main feature of services offered by BigData Inc. is the access availability guarantee even under the circumstances of any data center having an outage. Such a guarantee is ensured by using the two-way replication. Two-way replication is such an approach for data storage that any piece of data is represented by two identical copies that are stored in two different data centers.For each of m company clients, let us denote indices of two different data centers storing this client data as ci,\xe2\x80\x891 and ci,\xe2\x80\x892.In order to keep data centers operational and safe, the software running on data center computers is being updated regularly. Release cycle of BigData Inc. is one day meaning that the new version of software is being deployed to the data center computers each day.Data center software update is a non-trivial long process, that is why there is a special hour-long time frame that is dedicated for data center maintenance. During the maintenance period, data center computers are installing software updates, and thus they may be unavailable. Consider the day to be exactly h hours long. For each data center there is an integer uj (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89uj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89h\xe2\x80\x89-\xe2\x80\x891) defining the index of an hour of day, such that during this hour data center j is unavailable due to maintenance.Summing up everything above, the condition uci,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89uci,\xe2\x80\x892 should hold for each client, or otherwise his data may be unaccessible while data centers that store it are under maintenance.Due to occasional timezone change in different cities all over the world, the maintenance time in some of the data centers may change by one hour sometimes. Company should be prepared for such situation, that is why they decided to conduct an experiment, choosing some non-empty subset of data centers, and shifting the maintenance time for them by an hour later (i.e. if uj\xe2\x80\x89=\xe2\x80\x89h\xe2\x80\x89-\xe2\x80\x891, then the new maintenance hour would become 0, otherwise it would become uj\xe2\x80\x89+\xe2\x80\x891). Nonetheless, such an experiment should not break the accessibility guarantees, meaning that data of any client should be still available during any hour of a day after the data center maintenance times are changed.Such an experiment would provide useful insights, but changing update time is quite an expensive procedure, that is why the company asked you to find out the minimum number of data centers that have to be included in an experiment in order to keep the data accessibility guarantees." 1900

949B "A Leapfrog in the Array" "constructive algorithms,math" "Dima is a beginner programmer. During his working process, he regularly has to repeat the following operation again and again: to remove every second element from the array. One day he has been bored with easy solutions of this problem, and he has come up with the following extravagant algorithm.Let\'s consider that initially array contains n numbers from 1 to n and the number i is located in the cell with the index 2i\xe2\x80\x89-\xe2\x80\x891 (Indices are numbered starting from one) and other cells of the array are empty. Each step Dima selects a non-empty array cell with the maximum index and moves the number written in it to the nearest empty cell to the left of the selected one. The process continues until all n numbers will appear in the first n cells of the array. For example if n\xe2\x80\x89=\xe2\x80\x894, the array is changing as follows:  You have to write a program that allows you to determine what number will be in the cell with index x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) after Dima\'s algorithm finishes." 1700

949A Zebras greedy "Oleg writes down the history of the days he lived. For each day he decides if it was good or bad. Oleg calls a non-empty sequence of days a zebra, if it starts with a bad day, ends with a bad day, and good and bad days are alternating in it. Let us denote bad days as 0 and good days as 1. Then, for example, sequences of days 0, 010, 01010 are zebras, while sequences 1, 0110, 0101 are not.Oleg tells you the story of days he lived in chronological order in form of string consisting of 0 and 1. Now you are interested if it is possible to divide Oleg\'s life history into several subsequences, each of which is a zebra, and the way it can be done. Each day must belong to exactly one of the subsequences. For each of the subsequences, days forming it must be ordered chronologically. Note that subsequence does not have to be a group of consecutive days." 1600

948A "Protect Sheep" "brute force,dfs and similar,graphs,implementation" "Bob is a farmer. He has a large pasture with many sheep. Recently, he has lost some of them due to wolf attacks. He thus decided to place some shepherd dogs in such a way that all his sheep are protected.The pasture is a rectangle consisting of R\xe2\x80\x89\xc3\x97\xe2\x80\x89C cells. Each cell is either empty, contains a sheep, a wolf or a dog. Sheep and dogs always stay in place, but wolves can roam freely around the pasture, by repeatedly moving to the left, right, up or down to a neighboring cell. When a wolf enters a cell with a sheep, it consumes it. However, no wolf can enter a cell with a dog.Initially there are no dogs. Place dogs onto the pasture in such a way that no wolf can reach any sheep, or determine that it is impossible. Note that since you have many dogs, you do not need to minimize their number." 900

946G "Almost Increasing Array" "data structures,dp" "We call an array almost increasing if we can erase not more than one element from it so that the array becomes strictly increasing (that is, every element is striclty greater than every element before it).You are given an array a consisting of n elements. You are allowed to replace any element with any integer number (and you may do so any number of times you need). What is the minimum number of replacements you have to perform in order to make the array almost increasing?" 2500

946F "Fibonacci String Subsequences" combinatorics,dp,matrices "You are given a binary string s (each character of this string is either 0 or 1).Let\'s denote the cost of string t as the number of occurences of s in t. For example, if s is 11 and t is 111011, then the cost of t is 3.Let\'s also denote the Fibonacci strings sequence as follows: F(0) is 0; F(1) is 1; F(i)\xe2\x80\x89=\xe2\x80\x89F(i\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89F(i\xe2\x80\x89-\xe2\x80\x892) if i\xe2\x80\x89>\xe2\x80\x891, where \xe2\x80\x89+\xe2\x80\x89 means the concatenation of two strings.Your task is to calculate the sum of costs of all subsequences of the string F(x). Since answer may be large, calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2400

946E "Largest Beautiful Number" greedy,implementation "Yes, that\'s another problem with definition of ""beautiful"" numbers.Let\'s call a positive integer x beautiful if its decimal representation without leading zeroes contains even number of digits, and there exists a permutation of this representation which is palindromic. For example, 4242 is a beautiful number, since it contains 4 digits, and there exists a palindromic permutation 2442.Given a positive integer s, find the largest beautiful number which is less than s." 2200

946D Timetable dp "Ivan is a student at Berland State University (BSU). There are n days in Berland week, and each of these days Ivan might have some classes at the university.There are m working hours during each Berland day, and each lesson at the university lasts exactly one hour. If at some day Ivan\'s first lesson is during i-th hour, and last lesson is during j-th hour, then he spends j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891 hours in the university during this day. If there are no lessons during some day, then Ivan stays at home and therefore spends 0 hours in the university.Ivan doesn\'t like to spend a lot of time in the university, so he has decided to skip some lessons. He cannot skip more than k lessons during the week. After deciding which lessons he should skip and which he should attend, every day Ivan will enter the university right before the start of the first lesson he does not skip, and leave it after the end of the last lesson he decides to attend. If Ivan skips all lessons during some day, he doesn\'t go to the university that day at all.Given n, m, k and Ivan\'s timetable, can you determine the minimum number of hours he has to spend in the university during one week, if he cannot skip more than k lessons?" 1800

946C "String Transformation" greedy,strings "You are given a string s consisting of |s| small english letters.In one move you can replace any character of this string to the next character in alphabetical order (a will be replaced with b, s will be replaced with t, etc.). You cannot replace letter z with any other letter.Your target is to make some number of moves (not necessary minimal) to get string abcdefghijklmnopqrstuvwxyz (english alphabet) as a subsequence. Subsequence of the string is the string that is obtained by deleting characters at some positions. You need to print the string that will be obtained from the given string and will be contain english alphabet as a subsequence or say that it is impossible." 1300

946B "Weird Subtraction Process" "math,number theory" "You have two variables a and b. Consider the following sequence of actions performed with these variables: If a\xe2\x80\x89=\xe2\x80\x890 or b\xe2\x80\x89=\xe2\x80\x890, end the process. Otherwise, go to step 2; If a\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892\xc2\xb7b, then set the value of a to a\xe2\x80\x89-\xe2\x80\x892\xc2\xb7b, and repeat step 1. Otherwise, go to step 3; If b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892\xc2\xb7a, then set the value of b to b\xe2\x80\x89-\xe2\x80\x892\xc2\xb7a, and repeat step 1. Otherwise, end the process.Initially the values of a and b are positive integers, and so the process will be finite.You have to determine the values of a and b after the process ends." 1100

946A Partition greedy "You are given a sequence a consisting of n integers. You may partition this sequence into two sequences b and c in such a way that every element belongs exactly to one of these sequences. Let B be the sum of elements belonging to b, and C be the sum of elements belonging to c (if some of these sequences is empty, then its sum is 0). What is the maximum possible value of B\xe2\x80\x89-\xe2\x80\x89C?" 800

940F "Machine Learning" "brute force,data structures" "You come home and fell some unpleasant smell. Where is it coming from?You are given an array a. You have to answer the following queries:   You are given two integers l and r. Let ci be the number of occurrences of i in al:\xe2\x80\x89r, where al:\xe2\x80\x89r is the subarray of a from l-th element to r-th inclusive. Find the Mex of {c0,\xe2\x80\x89c1,\xe2\x80\x89...,\xe2\x80\x89c109}  You are given two integers p to x. Change ap to x. The Mex of a multiset of numbers is the smallest non-negative integer not in the set.Note that in this problem all elements of a are positive, which means that c0 = 0 and 0 is never the answer for the query of the second type." 2600

940E Cashback "data structures,dp,greedy,math" "Since you are the best Wraith King, Nizhniy Magazin \xc2\xabMir\xc2\xbb at the centre of Vinnytsia is offering you a discount.You are given an array a of length n and an integer c. The value of some array b of length k is the sum of its elements except for the  smallest. For example, the value of the array [3,\xe2\x80\x891,\xe2\x80\x896,\xe2\x80\x895,\xe2\x80\x892] with c\xe2\x80\x89=\xe2\x80\x892 is 3\xe2\x80\x89+\xe2\x80\x896\xe2\x80\x89+\xe2\x80\x895\xe2\x80\x89=\xe2\x80\x8914.Among all possible partitions of a into contiguous subarrays output the smallest possible sum of the values of these subarrays." 2000

940D "Alena And The Heater" "binary search,implementation" """We\'ve tried solitary confinement, waterboarding and listening to Just In Beaver, to no avail. We need something extreme.""""Little Alena got an array as a birthday present...""The array b of length n is obtained from the array a of length n and two integers l and r�(l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) using the following procedure:b1\xe2\x80\x89=\xe2\x80\x89b2\xe2\x80\x89=\xe2\x80\x89b3\xe2\x80\x89=\xe2\x80\x89b4\xe2\x80\x89=\xe2\x80\x890.For all 5\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n:   bi\xe2\x80\x89=\xe2\x80\x890 if ai,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x893,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x894\xe2\x80\x89>\xe2\x80\x89r and bi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x894\xe2\x80\x89=\xe2\x80\x891  bi\xe2\x80\x89=\xe2\x80\x891 if ai,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x893,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x894\xe2\x80\x89<\xe2\x80\x89l and bi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x894\xe2\x80\x89=\xe2\x80\x890  bi\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x891 otherwise You are given arrays a and b\' of the same length. Find two integers l and r�(l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), such that applying the algorithm described above will yield an array b equal to b\'.It\'s guaranteed that the answer exists." 1600

940C "Phone Numbers" "constructive algorithms,implementation,strings" "And where the are the phone numbers?You are given a string s consisting of lowercase English letters and an integer k. Find the lexicographically smallest string t of length k, such that its set of letters is a subset of the set of letters of s and s is lexicographically smaller than t.It\'s guaranteed that the answer exists.Note that the set of letters is a set, not a multiset. For example, the set of letters of abadaba is {a,\xe2\x80\x89b,\xe2\x80\x89d}.String p is lexicographically smaller than string q, if p is a prefix of q, is not equal to q or there exists i, such that pi\xe2\x80\x89<\xe2\x80\x89qi and for all j\xe2\x80\x89<\xe2\x80\x89i it is satisfied that pj\xe2\x80\x89=\xe2\x80\x89qj. For example, abc is lexicographically smaller than abcd , abd is lexicographically smaller than abec, afa is not lexicographically smaller than ab and a is not lexicographically smaller than a." 1500

940B "Our Tanya is Crying Out Loud" dp,greedy "Right now she actually isn\'t. But she will be, if you don\'t solve this problem.You are given integers n, k, A and B. There is a number x, which is initially equal to n. You are allowed to perform two types of operations:   Subtract 1 from x. This operation costs you A coins.  Divide x by k. Can be performed only if x is divisible by k. This operation costs you B coins.  What is the minimum amount of coins you have to pay to make x equal to 1?" 1400

940A "Points on the line" "brute force,greedy,sortings" "We\'ve got no test cases. A big olympiad is coming up. But the problemsetters\' number one priority should be adding another problem to the round. The diameter of a multiset of points on the line is the largest distance between two points from this set. For example, the diameter of the multiset {1,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x891} is 2.Diameter of multiset consisting of one point is 0.You are given n points on the line. What is the minimum number of points you have to remove, so that the diameter of the multiset of the remaining points will not exceed d?" 1200

939F Cutlet "data structures,dp" "Arkady wants to have a dinner. He has just returned from a shop where he has bought a semifinished cutlet. He only needs to fry it. The cutlet should be fried for 2n seconds, in particular, it should be fried for n seconds on one side and n seconds on the other side. Arkady has already got a frying pan and turn on fire, but understood that maybe he won\'t be able to flip the cutlet exactly after n seconds after the beginning of cooking.Arkady is too busy with sorting sticker packs in his favorite messenger and can flip the cutlet only in some periods of time. Namely, there are k periods of time in which he can do it, the i-th of them is an interval of time from li seconds after he starts cooking till ri seconds, inclusive. Arkady decided that it\'s not required to flip the cutlet exactly in the middle of cooking, instead, he will flip it several times in such a way that the cutlet will be fried exactly n seconds on one side and n seconds on the other side in total.Help Arkady and find out if it\'s possible for him to cook the cutlet, if he is able to flip the cutlet only in given periods of time; and if yes, find the minimum number of flips he needs to cook the cutlet." 2400

939E Maximize! "binary search,greedy,ternary search,two pointers" "You are given a multiset S consisting of positive integers (initially empty). There are two kind of queries:   Add a positive integer to S, the newly added integer is not less than any number in it.  Find a subset s of the set S such that the value  is maximum possible. Here max(s) means maximum value of elements in s, �\xe2\x80\x94 the average value of numbers in s. Output this maximum possible value of ." 1800

939D "Love Rescue" "dfs and similar,dsu,graphs,greedy,strings" "Valya and Tolya are an ideal pair, but they quarrel sometimes. Recently, Valya took offense at her boyfriend because he came to her in t-shirt with lettering that differs from lettering on her pullover. Now she doesn\'t want to see him and Tolya is seating at his room and crying at her photos all day long.This story could be very sad but fairy godmother (Tolya\'s grandmother) decided to help them and restore their relationship. She secretly took Tolya\'s t-shirt and Valya\'s pullover and wants to make the letterings on them same. In order to do this, for one unit of mana she can buy a spell that can change some letters on the clothes. Your task is calculate the minimum amount of mana that Tolya\'s grandmother should spend to rescue love of Tolya and Valya.More formally, letterings on Tolya\'s t-shirt and Valya\'s pullover are two strings with same length n consisting only of lowercase English letters. Using one unit of mana, grandmother can buy a spell of form (c1,\xe2\x80\x89c2) (where c1 and c2 are some lowercase English letters), which can arbitrary number of times transform a single letter c1 to c2 and vise-versa on both Tolya\'s t-shirt and Valya\'s pullover. You should find the minimum amount of mana that grandmother should spend to buy a set of spells that can make the letterings equal. In addition you should output the required set of spells." 1600

939C "Convenient For Everybody" "binary search,two pointers" "In distant future on Earth day lasts for n hours and that\'s why there are n timezones. Local times in adjacent timezones differ by one hour. For describing local time, hours numbers from 1 to n are used, i.e. there is no time ""0 hours"", instead of it ""n hours"" is used. When local time in the 1-st timezone is 1 hour, local time in the i-th timezone is i hours.Some online programming contests platform wants to conduct a contest that lasts for an hour in such a way that its beginning coincides with beginning of some hour (in all time zones). The platform knows, that there are ai people from i-th timezone who want to participate in the contest. Each person will participate if and only if the contest starts no earlier than s hours 00 minutes local time and ends not later than f hours 00 minutes local time. Values s and f are equal for all time zones. If the contest starts at f hours 00 minutes local time, the person won\'t participate in it.Help platform select such an hour, that the number of people who will participate in the contest is maximum." 1600

939B "Hamster Farm" implementation "Dima has a hamsters farm. Soon N hamsters will grow up on it and Dima will sell them in a city nearby.Hamsters should be transported in boxes. If some box is not completely full, the hamsters in it are bored, that\'s why each box should be completely full with hamsters.Dima can buy boxes at a factory. The factory produces boxes of K kinds, boxes of the i-th kind can contain in themselves ai hamsters. Dima can buy any amount of boxes, but he should buy boxes of only one kind to get a wholesale discount.Of course, Dima would buy boxes in such a way that each box can be completely filled with hamsters and transported to the city. If there is no place for some hamsters, Dima will leave them on the farm.Find out how many boxes and of which type should Dima buy to transport maximum number of hamsters." 1000

939A "Love Triangle" graphs "As you could know there are no male planes nor female planes. However, each plane on Earth likes some other plane. There are n planes on Earth, numbered from 1 to n, and the plane with number i likes the plane with number fi, where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89fi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and fi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i.We call a love triangle a situation in which plane A likes plane B, plane B likes plane C and plane C likes plane A. Find out if there is any love triangle on Earth." 800

938G "Shortest Path Queries" "bitmasks,data structures,dsu,graphs" "You are given an undirected connected graph with weighted edges. The length of some path between two vertices is the bitwise xor of weights of all edges belonging to this path (if some edge is traversed more than once, then it is included in bitwise xor the same number of times). There are three types of queries you have to process:  1 x y d \xe2\x80\x94 add an edge connecting vertex x to vertex y with weight d. It is guaranteed that there is no edge connecting x to y before this query;  2 x y \xe2\x80\x94 remove an edge connecting vertex x to vertex y. It is guaranteed that there was such edge in the graph, and the graph stays connected after this query;  3 x y \xe2\x80\x94 calculate the length of the shortest path (possibly non-simple) from vertex x to vertex y. Print the answers for all queries of type 3." 2900

938F "Erasing Substrings" bitmasks,dp,greedy "You are given a string s, initially consisting of n lowercase Latin letters. After that, you perform k operations with it, where . During i-th operation you must erase some substring of length exactly 2i\xe2\x80\x89-\xe2\x80\x891 from s.Print the lexicographically minimal string you may obtain after performing k such operations." 2700

938E "Max History" combinatorics,math "You are given an array a of length n. We define fa the following way:  Initially fa\xe2\x80\x89=\xe2\x80\x890, M\xe2\x80\x89=\xe2\x80\x891;  for every 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n if aM\xe2\x80\x89<\xe2\x80\x89ai then we set fa\xe2\x80\x89=\xe2\x80\x89fa\xe2\x80\x89+\xe2\x80\x89aM and then set M\xe2\x80\x89=\xe2\x80\x89i. Calculate the sum of fa over all n! permutations of the array a modulo 109\xe2\x80\x89+\xe2\x80\x897.Note: two elements are considered different if their indices differ, so for every array a there are exactly n! permutations." 2300

938D "Buy a Ticket" "data structures,graphs,shortest paths" "Musicians of a popular band ""Flayer"" have announced that they are going to ""make their exit"" with a world tour. Of course, they will visit Berland as well.There are n cities in Berland. People can travel between cities using two-directional train routes; there are exactly m routes, i-th route can be used to go from city vi to city ui (and from ui to vi), and it costs wi coins to use this route.Each city will be visited by ""Flayer"", and the cost of the concert ticket in i-th city is ai coins.You have friends in every city of Berland, and they, knowing about your programming skills, asked you to calculate the minimum possible number of coins they have to pay to visit the concert. For every city i you have to compute the minimum number of coins a person from city i has to spend to travel to some city j (or possibly stay in city i), attend a concert there, and return to city i (if j\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i).Formally, for every  you have to calculate , where d(i,\xe2\x80\x89j) is the minimum number of coins you have to spend to travel from city i to city j. If there is no way to reach city j from city i, then we consider d(i,\xe2\x80\x89j) to be infinitely large." 2000

938C "Constructing Tests" "binary search,brute force,constructive algorithms" "Let\'s denote a m-free matrix as a binary (that is, consisting of only 1\'s and 0\'s) matrix such that every square submatrix of size m\xe2\x80\x89\xc3\x97\xe2\x80\x89m of this matrix contains at least one zero. Consider the following problem:You are given two integers n and m. You have to construct an m-free square matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n such that the number of 1\'s in this matrix is maximum possible. Print the maximum possible number of 1\'s in such matrix.You don\'t have to solve this problem. Instead, you have to construct a few tests for it.You will be given t numbers x1, x2, ..., xt. For every , find two integers ni and mi (ni\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89mi) such that the answer for the aforementioned problem is exactly xi if we set n\xe2\x80\x89=\xe2\x80\x89ni and m\xe2\x80\x89=\xe2\x80\x89mi." 1700

938B "Run For Your Prize" "brute force,greedy" "You and your friend are participating in a TV show ""Run For Your Prize"".At the start of the show n prizes are located on a straight line. i-th prize is located at position ai. Positions of all prizes are distinct. You start at position 1, your friend \xe2\x80\x94 at position 106 (and there is no prize in any of these two positions). You have to work as a team and collect all prizes in minimum possible time, in any order.You know that it takes exactly 1 second to move from position x to position x\xe2\x80\x89+\xe2\x80\x891 or x\xe2\x80\x89-\xe2\x80\x891, both for you and your friend. You also have trained enough to instantly pick up any prize, if its position is equal to your current position (and the same is true for your friend). Carrying prizes does not affect your speed (or your friend\'s speed) at all.Now you may discuss your strategy with your friend and decide who will pick up each prize. Remember that every prize must be picked up, either by you or by your friend.What is the minimum number of seconds it will take to pick up all the prizes?" 1100

938A "Word Correction" implementation "Victor tries to write his own text editor, with word correction included. However, the rules of word correction are really strange.Victor thinks that if a word contains two consecutive vowels, then it\'s kinda weird and it needs to be replaced. So the word corrector works in such a way: as long as there are two consecutive vowels in the word, it deletes the first vowel in a word such that there is another vowel right before it. If there are no two consecutive vowels in the word, it is considered to be correct.You are given a word s. Can you predict what will it become after correction?In this problem letters a, e, i, o, u and y are considered to be vowels." 800

937B "Vile Grasshoppers" "brute force,math,number theory" "The weather is fine today and hence it\'s high time to climb the nearby pine and enjoy the landscape.The pine\'s trunk includes several branches, located one above another and numbered from 2 to y. Some of them (more precise, from 2 to p) are occupied by tiny vile grasshoppers which you\'re at war with. These grasshoppers are known for their awesome jumping skills: the grasshopper at branch x can jump to branches .Keeping this in mind, you wisely decided to choose such a branch that none of the grasshoppers could interrupt you. At the same time you wanna settle as high as possible since the view from up there is simply breathtaking.In other words, your goal is to find the highest branch that cannot be reached by any of the grasshoppers or report that it\'s impossible." 1400

937A Olympiad implementation,sortings "The recent All-Berland Olympiad in Informatics featured n participants with each scoring a certain amount of points.As the head of the programming committee, you are to determine the set of participants to be awarded with diplomas with respect to the following criteria:   At least one participant should get a diploma.  None of those with score equal to zero should get awarded.  When someone is awarded, all participants with score not less than his score should also be awarded. Determine the number of ways to choose a subset of participants that will receive the diplomas." 800

936E Iqea "data structures,dfs and similar,divide and conquer,dsu,shortest paths,trees" "The recent All-Berland Olympiad in Informatics featured n participants with each scoring a certain amount of points.As the head of the programming committee, you are to determine the set of participants to be awarded with diplomas with respect to the following criteria:   At least one participant should get a diploma.  None of those with score equal to zero should get awarded.  When someone is awarded, all participants with score not less than his score should also be awarded. Determine the number of ways to choose a subset of participants that will receive the diplomas." 3400

936D "World of Tank" dp,greedy "Vitya loves programming and problem solving, but sometimes, to distract himself a little, he plays computer games. Once he found a new interesting game about tanks, and he liked it so much that he went through almost all levels in one day. Remained only the last level, which was too tricky. Then Vitya remembered that he is a programmer, and wrote a program that helped him to pass this difficult level. Try do the same.The game is organized as follows. There is a long road, two cells wide and n cells long. Some cells have obstacles. You control a tank that occupies one cell. Initially, the tank is located before the start of the road, in a cell with coordinates (0,\xe2\x80\x891). Your task is to move the tank to the end of the road, to the cell (n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x891) or (n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x892).  Every second the tank moves one cell to the right: the coordinate x is increased by one. When you press the up or down arrow keys, the tank instantly changes the lane, that is, the y coordinate. When you press the spacebar, the tank shoots, and the nearest obstacle along the lane in which the tank rides is instantly destroyed. In order to load a gun, the tank needs t seconds. Initially, the gun is not loaded, that means, the first shot can be made only after t seconds after the tank starts to move.If at some point the tank is in the same cell with an obstacle not yet destroyed, it burns out. If you press the arrow exactly at the moment when the tank moves forward, the tank will first move forward, and then change the lane, so it will not be possible to move diagonally.Your task is to find out whether it is possible to pass the level, and if possible, to find the order of actions the player need to make." 3000

936C "Lock Puzzle" "constructive algorithms,implementation,strings" "Welcome to another task about breaking the code lock! Explorers Whitfield and Martin came across an unusual safe, inside of which, according to rumors, there are untold riches, among which one can find the solution of the problem of discrete logarithm!Of course, there is a code lock is installed on the safe. The lock has a screen that displays a string of n lowercase Latin letters. Initially, the screen displays string s. Whitfield and Martin found out that the safe will open when string t will be displayed on the screen.The string on the screen can be changed using the operation \xc2\xabshift x\xc2\xbb. In order to apply this operation, explorers choose an integer x from 0 to n inclusive. After that, the current string p\xe2\x80\x89=\xe2\x80\x89\xce\xb1\xce\xb2 changes to \xce\xb2R\xce\xb1, where the length of \xce\xb2 is x, and the length of \xce\xb1 is n\xe2\x80\x89-\xe2\x80\x89x. In other words, the suffix of the length x of string p is reversed and moved to the beginning of the string. For example, after the operation \xc2\xabshift 4\xc2\xbb the string \xc2\xababcacb\xc2\xbb will be changed with string \xc2\xabbcacab \xc2\xbb, since \xce\xb1\xe2\x80\x89=\xe2\x80\x89ab, \xce\xb2\xe2\x80\x89=\xe2\x80\x89cacb, \xce\xb2R\xe2\x80\x89=\xe2\x80\x89bcac.Explorers are afraid that if they apply too many operations \xc2\xabshift\xc2\xbb, the lock will be locked forever. They ask you to find a way to get the string t on the screen, using no more than 6100 operations." 2300

936B "Sleepy Game" "dfs and similar,dp,games,graphs" "Petya and Vasya arranged a game. The game runs by the following rules. Players have a directed graph consisting of n vertices and m edges. One of the vertices contains a chip. Initially the chip is located at vertex s. Players take turns moving the chip along some edge of the graph. Petya goes first. Player who can\'t move the chip loses. If the game lasts for 106 turns the draw is announced.Vasya was performing big laboratory work in ""Spelling and parts of speech"" at night before the game, so he fell asleep at the very beginning of the game. Petya decided to take the advantage of this situation and make both Petya\'s and Vasya\'s moves.Your task is to help Petya find out if he can win the game or at least draw a tie." 2100

936A "Save Energy!" "binary search,implementation,math" "Julia is going to cook a chicken in the kitchen of her dormitory. To save energy, the stove in the kitchen automatically turns off after k minutes after turning on.During cooking, Julia goes to the kitchen every d minutes and turns on the stove if it is turned off. While the cooker is turned off, it stays warm. The stove switches on and off instantly.It is known that the chicken needs t minutes to be cooked on the stove, if it is turned on, and 2t minutes, if it is turned off. You need to find out, how much time will Julia have to cook the chicken, if it is considered that the chicken is cooked evenly, with constant speed when the stove is turned on and at a constant speed when it is turned off." 1700

935F "Fafa and Array" "data structures,greedy" "Fafa has an array A of n positive integers, the function f(A) is defined as . He wants to do q queries of two types:  1\xe2\x80\x89l\xe2\x80\x89r\xe2\x80\x89x \xe2\x80\x94 find the maximum possible value of f(A), if x is to be added to one element in the range [l,\xe2\x80\x89\xe2\x80\x89r]. You can choose to which element to add x.  2\xe2\x80\x89l\xe2\x80\x89r\xe2\x80\x89x \xe2\x80\x94 increase all the elements in the range [l,\xe2\x80\x89\xe2\x80\x89r] by value x. Note that queries of type 1 don\'t affect the array elements." 2600

935E "Fafa and Ancient Mathematics" "dfs and similar,dp,trees" "Ancient Egyptians are known to have understood difficult concepts in mathematics. The ancient Egyptian mathematician Ahmes liked to write a kind of arithmetic expressions on papyrus paper which he called as Ahmes arithmetic expression.An Ahmes arithmetic expression can be defined as:   ""d"" is an Ahmes arithmetic expression, where d is a one-digit positive integer;  ""(E1\xe2\x80\x89op\xe2\x80\x89E2)"" is an Ahmes arithmetic expression, where E1 and E2 are valid Ahmes arithmetic expressions (without spaces) and op is either plus (\xe2\x80\x89+\xe2\x80\x89) or minus (\xe2\x80\x89-\xe2\x80\x89).  For example 5, (1-1) and ((1+(2-3))-5) are valid Ahmes arithmetic expressions.On his trip to Egypt, Fafa found a piece of papyrus paper having one of these Ahmes arithmetic expressions written on it. Being very ancient, the papyrus piece was very worn out. As a result, all the operators were erased, keeping only the numbers and the brackets. Since Fafa loves mathematics, he decided to challenge himself with the following task:Given the number of plus and minus operators in the original expression, find out the maximum possible value for the expression on the papyrus paper after putting the plus and minus operators in the place of the original erased operators." 2300

935D "Fafa and Ancient Alphabet" math,probabilities "Ancient Egyptians are known to have used a large set of symbols  to write on the walls of the temples. Fafa and Fifa went to one of the temples and found two non-empty words S1 and S2 of equal lengths on the wall of temple written one below the other. Since this temple is very ancient, some symbols from the words were erased. The symbols in the set  have equal probability for being in the position of any erased symbol.Fifa challenged Fafa to calculate the probability that S1 is lexicographically greater than S2. Can you help Fafa with this task?You know that , i.�e. there were m distinct characters in Egyptians\' alphabet, in this problem these characters are denoted by integers from 1 to m in alphabet order. A word x is lexicographically greater than a word y of the same length, if the words are same up to some position, and then the word x has a larger character, than the word y.We can prove that the probability equals to some fraction , where P and Q are coprime integers, and . Print as the answer the value , i.�e. such a non-negative integer less than 109\xe2\x80\x89+\xe2\x80\x897, such that , where  means that a and b give the same remainders when divided by m." 1900

935C "Fifa and Fafa" geometry "Fifa and Fafa are sharing a flat. Fifa loves video games and wants to download a new soccer game. Unfortunately, Fafa heavily uses the internet which consumes the quota. Fifa can access the internet through his Wi-Fi access point. This access point can be accessed within a range of r meters (this range can be chosen by Fifa) from its position. Fifa must put the access point inside the flat which has a circular shape of radius R. Fifa wants to minimize the area that is not covered by the access point inside the flat without letting Fafa or anyone outside the flat to get access to the internet.The world is represented as an infinite 2D plane. The flat is centered at (x1,\xe2\x80\x89y1) and has radius R and Fafa\'s laptop is located at (x2,\xe2\x80\x89y2), not necessarily inside the flat. Find the position and the radius chosen by Fifa for his access point which minimizes the uncovered area." 1600

935B "Fafa and the Gates" implementation "Two neighboring kingdoms decided to build a wall between them with some gates to enable the citizens to go from one kingdom to another. Each time a citizen passes through a gate, he has to pay one silver coin.The world can be represented by the first quadrant of a plane and the wall is built along the identity line (i.e. the line with the equation x\xe2\x80\x89=\xe2\x80\x89y). Any point below the wall belongs to the first kingdom while any point above the wall belongs to the second kingdom. There is a gate at any integer point on the line (i.e. at points (0,\xe2\x80\x890), (1,\xe2\x80\x891), (2,\xe2\x80\x892), ...). The wall and the gates do not belong to any of the kingdoms. Fafa is at the gate at position (0,\xe2\x80\x890) and he wants to walk around in the two kingdoms. He knows the sequence S of moves he will do. This sequence is a string where each character represents a move. The two possible moves Fafa will do are \'U\' (move one step up, from (x,\xe2\x80\x89y) to (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891)) and \'R\' (move one step right, from (x,\xe2\x80\x89y) to (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y)). Fafa wants to know the number of silver coins he needs to pay to walk around the two kingdoms following the sequence S. Note that if Fafa visits a gate without moving from one kingdom to another, he pays no silver coins. Also assume that he doesn\'t pay at the gate at point (0,\xe2\x80\x890), i.�e. he is initially on the side he needs." 900

935A "Fafa and his Company" "brute force,implementation" "Fafa owns a company that works on huge projects. There are n employees in Fafa\'s company. Whenever the company has a new project to start working on, Fafa has to divide the tasks of this project among all the employees.Fafa finds doing this every time is very tiring for him. So, he decided to choose the best l employees in his company as team leaders. Whenever there is a new project, Fafa will divide the tasks among only the team leaders and each team leader will be responsible of some positive number of employees to give them the tasks. To make this process fair for the team leaders, each one of them should be responsible for the same number of employees. Moreover, every employee, who is not a team leader, has to be under the responsibility of exactly one team leader, and no team leader is responsible for another team leader.Given the number of employees n, find in how many ways Fafa could choose the number of team leaders l in such a way that it is possible to divide employees between them evenly." 800

934B "A Prosperous Lot" "constructive algorithms,implementation" "Apart from Nian, there is a daemon named Sui, which terrifies children and causes them to become sick. Parents give their children money wrapped in red packets and put them under the pillow, so that when Sui tries to approach them, it will be driven away by the fairies inside.Big Banban is hesitating over the amount of money to give out. He considers loops to be lucky since it symbolizes unity and harmony.He would like to find a positive integer n not greater than 1018, such that there are exactly k loops in the decimal representation of n, or determine that such n does not exist.A loop is a planar area enclosed by lines in the digits\' decimal representation written in Arabic numerals. For example, there is one loop in digit 4, two loops in 8 and no loops in 5. Refer to the figure below for all exact forms." 1200

934A "A Compatible Pair" "brute force,games" "Nian is a monster which lives deep in the oceans. Once a year, it shows up on the land, devouring livestock and even people. In order to keep the monster away, people fill their villages with red colour, light, and cracking noise, all of which frighten the monster out of coming.Little Tommy has n lanterns and Big Banban has m lanterns. Tommy\'s lanterns have brightness a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, and Banban\'s have brightness b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm respectively.Tommy intends to hide one of his lanterns, then Banban picks one of Tommy\'s non-hidden lanterns and one of his own lanterns to form a pair. The pair\'s brightness will be the product of the brightness of two lanterns.Tommy wants to make the product as small as possible, while Banban tries to make it as large as possible.You are asked to find the brightness of the chosen pair if both of them choose optimally." 1400

933E "A Preponderant Reunion" "constructive algorithms,dp" "East or west, home is best. That\'s why family reunion, the indispensable necessity of Lunar New Year celebration, is put in such a position.After the reunion dinner, Little Tommy plays a game with the family. Here is a concise introduction to this game:   There is a sequence of n non-negative integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn in the beginning. It is ruled that each integer in this sequence should be non-negative at any time.  You can select two consecutive positive integers in this sequence, pi and pi\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), and then decrease them by their minimum (i.�e. min(pi,\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891)), the cost of this operation is equal to min(pi,\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891). We call such operation as a descension.  The game immediately ends when there are no two consecutive positive integers. Your task is to end the game so that the total cost of your operations is as small as possible. Obviously, every game ends after at most n\xe2\x80\x89-\xe2\x80\x891 descensions. Please share your solution of this game with the lowest cost." 3200

933D "A Creative Cutout" "brute force,combinatorics,math" "Everything red frightens Nian the monster. So do red paper and... you, red on Codeforces, potential or real.Big Banban has got a piece of paper with endless lattice points, where lattice points form squares with the same area. His most favorite closed shape is the circle because of its beauty and simplicity. Once he had obtained this piece of paper, he prepares it for paper-cutting.  He drew n concentric circles on it and numbered these circles from 1 to n such that the center of each circle is the same lattice point and the radius of the k-th circle is  times the length of a lattice edge.Define the degree of beauty of a lattice point as the summation of the indices of circles such that this lattice point is inside them, or on their bounds. Banban wanted to ask you the total degree of beauty of all the lattice points, but changed his mind.Defining the total degree of beauty of all the lattice points on a piece of paper with n circles as f(n), you are asked to figure out ." 2900

933C "A Colourful Prospect" geometry,graphs "Firecrackers scare Nian the monster, but they\'re wayyyyy too noisy! Maybe fireworks make a nice complement.Little Tommy is watching a firework show. As circular shapes spread across the sky, a splendid view unfolds on the night of Lunar New Year\'s eve.A wonder strikes Tommy. How many regions are formed by the circles on the sky? We consider the sky as a flat plane. A region is a connected part of the plane with positive area, whose bound consists of parts of bounds of the circles and is a curve or several curves without self-intersections, and that does not contain any curve other than its boundaries. Note that exactly one of the regions extends infinitely." 2700

933B "A Determined Cleanup" math "In order to put away old things and welcome a fresh new year, a thorough cleaning of the house is a must.Little Tommy finds an old polynomial and cleaned it up by taking it modulo another. But now he regrets doing this...Given two integers p and k, find a polynomial f(x) with non-negative integer coefficients strictly less than k, whose remainder is p when divided by (x\xe2\x80\x89+\xe2\x80\x89k). That is, f(x)\xe2\x80\x89=\xe2\x80\x89q(x)\xc2\xb7(x\xe2\x80\x89+\xe2\x80\x89k)\xe2\x80\x89+\xe2\x80\x89p, where q(x) is a polynomial (not necessarily with integer coefficients)." 2000

933A "A Twisty Movement" dp "A dragon symbolizes wisdom, power and wealth. On Lunar New Year\'s Day, people model a dragon with bamboo strips and clothes, raise them with rods, and hold the rods high and low to resemble a flying dragon.A performer holding the rod low is represented by a 1, while one holding it high is represented by a 2. Thus, the line of performers can be represented by a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.Little Tommy is among them. He would like to choose an interval [l,\xe2\x80\x89r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), then reverse al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar so that the length of the longest non-decreasing subsequence of the new sequence is maximum.A non-decreasing subsequence is a sequence of indices p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk, such that p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pk and ap1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ap2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89apk. The length of the subsequence is k." 1800

932G "Palindrome Partition" "dp,string suffix structures,strings" "Given a string s, find the number of ways to split s to substrings such that if there are k substrings (p1,\xe2\x80\x89p2,\xe2\x80\x89p3,\xe2\x80\x89...,\xe2\x80\x89pk) in partition, then pi\xe2\x80\x89=\xe2\x80\x89pk\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891 for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) and k is even.Since the number of ways can be large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2900

932F "Escape Through Leaf" "data structures,dp,geometry" "You are given a tree with n nodes (numbered from 1 to n) rooted at node 1. Also, each node has two values associated with it. The values for i-th node are ai and bi.You can jump from a node to any node in its subtree. The cost of one jump from node x to node y is the product of ax and by. The total cost of a path formed by one or more jumps is sum of costs of individual jumps. For every node, calculate the minimum total cost to reach any leaf from that node. Pay attention, that root can never be leaf, even if it has degree 1.Note that you cannot jump from a node to itself." 2700

932E "Team Work" combinatorics,dp,math "You have a team of N people. For a particular task, you can pick any non-empty subset of people. The cost of having x people for the task is xk. Output the sum of costs over all non-empty subsets of people." 2400

932D Tree "binary search,dp,trees" "You are given a node of the tree with index 1 and with weight 0. Let cnt be the number of nodes in the tree at any instant (initially, cnt is set to 1). Support Q queries of following two types:   Add a new node (index cnt\xe2\x80\x89+\xe2\x80\x891) with weight W and add edge between node R and this node.   Output the maximum length of sequence of nodes which   starts with R.  Every node in the sequence is an ancestor of its predecessor.  Sum of weight of nodes in sequence does not exceed X.  For some nodes i,\xe2\x80\x89j that are consecutive in the sequence if i is an ancestor of j then w[i]\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89w[j] and there should not exist a node k on simple path from i to j such that w[k]\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89w[j]  The tree is rooted at node 1 at any instant.Note that the queries are given in a modified way." 2200

932C "Permutation Cycle" "brute force,constructive algorithms" "For a permutation P[1... N] of integers from 1 to N, function f is defined as follows:  Let g(i) be the minimum positive integer j such that f(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89i. We can show such j always exists.For given N,\xe2\x80\x89A,\xe2\x80\x89B, find a permutation P of integers from 1 to N such that for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N, g(i) equals either A or B." 1600

932B "Recursive Queries" "binary search,data structures,dfs and similar" "Let us define two functions f and g on positive integer numbers.   You need to process Q queries. In each query, you will be given three integers l, r and k. You need to print the number of integers x between l and r inclusive, such that g(x)\xe2\x80\x89=\xe2\x80\x89k." 1300

932A "Palindromic Supersequence" "constructive algorithms" "You are given a string A. Find a string B, where B is a palindrome and A is a subsequence of B.A subsequence of a string is a string that can be derived from it by deleting some (not necessarily consecutive) characters without changing the order of the remaining characters. For example, ""cotst"" is a subsequence of ""contest"".A palindrome is a string that reads the same forward or backward.The length of string B should be at most 104. It is guaranteed that there always exists such string.You do not need to find the shortest answer, the only restriction is that the length of string B should not exceed 104." 800

931C "Laboratory Work" implementation,math "Anya and Kirill are doing a physics laboratory work. In one of the tasks they have to measure some value n times, and then compute the average value to lower the error.Kirill has already made his measurements, and has got the following integer values: x1, x2, ..., xn. It is important that the values are close to each other, namely, the difference between the maximum value and the minimum value is at most 2.Anya does not want to make the measurements, however, she can\'t just copy the values from Kirill\'s work, because the error of each measurement is a random value, and this coincidence will be noted by the teacher. Anya wants to write such integer values y1, y2, ..., yn in her work, that the following conditions are met:  the average value of x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn is equal to the average value of y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn; all Anya\'s measurements are in the same bounds as all Kirill\'s measurements, that is, the maximum value among Anya\'s values is not greater than the maximum value among Kirill\'s values, and the minimum value among Anya\'s values is not less than the minimum value among Kirill\'s values; the number of equal measurements in Anya\'s work and Kirill\'s work is as small as possible among options with the previous conditions met. Formally, the teacher goes through all Anya\'s values one by one, if there is equal value in Kirill\'s work and it is not strike off yet, he strikes off this Anya\'s value and one of equal values in Kirill\'s work. The number of equal measurements is then the total number of strike off values in Anya\'s work. Help Anya to write such a set of measurements that the conditions above are met." 1700

931B "World Cup" "constructive algorithms,implementation" "The last stage of Football World Cup is played using the play-off system.There are n teams left in this stage, they are enumerated from 1 to n. Several rounds are held, in each round the remaining teams are sorted in the order of their ids, then the first in this order plays with the second, the third�\xe2\x80\x94 with the fourth, the fifth�\xe2\x80\x94 with the sixth, and so on. It is guaranteed that in each round there is even number of teams. The winner of each game advances to the next round, the loser is eliminated from the tournament, there are no draws. In the last round there is the only game with two remaining teams: the round is called the Final, the winner is called the champion, and the tournament is over.Arkady wants his two favorite teams to play in the Final. Unfortunately, the team ids are already determined, and it may happen that it is impossible for teams to meet in the Final, because they are to meet in some earlier stage, if they are strong enough. Determine, in which round the teams with ids a and b can meet." 1200

931A "Friends Meeting" "brute force,greedy,implementation,math" "Two friends are on the coordinate axis Ox in points with integer coordinates. One of them is in the point x1\xe2\x80\x89=\xe2\x80\x89a, another one is in the point x2\xe2\x80\x89=\xe2\x80\x89b. Each of the friends can move by one along the line in any direction unlimited number of times. When a friend moves, the tiredness of a friend changes according to the following rules: the first move increases the tiredness by 1, the second move increases the tiredness by 2, the third�\xe2\x80\x94 by 3 and so on. For example, if a friend moves first to the left, then to the right (returning to the same point), and then again to the left his tiredness becomes equal to 1\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x896.The friends want to meet in a integer point. Determine the minimum total tiredness they should gain, if they meet in the same point." 800

930E "Coins Exhibition" "data structures,dp,math" "Arkady and Kirill visited an exhibition of rare coins. The coins were located in a row and enumerated from left to right from 1 to k, each coin either was laid with its obverse (front) side up, or with its reverse (back) side up.Arkady and Kirill made some photos of the coins, each photo contained a segment of neighboring coins. Akrady is interested in obverses, so on each photo made by him there is at least one coin with obverse side up. On the contrary, Kirill is interested in reverses, so on each photo made by him there is at least one coin with its reverse side up.The photos are lost now, but Arkady and Kirill still remember the bounds of the segments of coins each photo contained. Given this information, compute the remainder of division by 109\xe2\x80\x89+\xe2\x80\x897 of the number of ways to choose the upper side of each coin in such a way, that on each Arkady\'s photo there is at least one coin with obverse side up, and on each Kirill\'s photo there is at least one coin with reverse side up." 2900

930D "Game with Tokens" "data structures,games,implementation" "Consider the following game for two players. There is one white token and some number of black tokens. Each token is placed on a plane in a point with integer coordinates x and y.The players take turn making moves, white starts. On each turn, a player moves all tokens of their color by 1 to up, down, left or right. Black player can choose directions for each token independently.After a turn of the white player the white token can not be in a point where a black token is located. There are no other constraints on locations of the tokens: positions of black tokens can coincide, after a turn of the black player and initially the white token can be in the same point with some black point. If at some moment the white player can\'t make a move, he loses. If the white player makes 10100500 moves, he wins.You are to solve the following problem. You are given initial positions of all black tokens. It is guaranteed that initially all these positions are distinct. In how many places can the white token be located initially so that if both players play optimally, the black player wins?" 2500

930C "Teodor is not a liar!" "data structures,dp" "Young Teodor enjoys drawing. His favourite hobby is drawing segments with integer borders inside his huge [1;m] segment. One day Teodor noticed that picture he just drawn has one interesting feature: there doesn\'t exist an integer point, that belongs each of segments in the picture. Having discovered this fact, Teodor decided to share it with Sasha.Sasha knows that Teodor likes to show off so he never trusts him. Teodor wants to prove that he can be trusted sometimes, so he decided to convince Sasha that there is no such integer point in his picture, which belongs to each segment. However Teodor is lazy person and neither wills to tell Sasha all coordinates of segments\' ends nor wills to tell him their amount, so he suggested Sasha to ask him series of questions \'Given the integer point xi, how many segments in Fedya\'s picture contain that point?\', promising to tell correct answers for this questions.Both boys are very busy studying and don\'t have much time, so they ask you to find out how many questions can Sasha ask Teodor, that having only answers on his questions, Sasha can\'t be sure that Teodor isn\'t lying to him. Note that Sasha doesn\'t know amount of segments in Teodor\'s picture. Sure, Sasha is smart person and never asks about same point twice." 1900

930B "Game with String" implementation,probabilities,strings "Vasya and Kolya play a game with a string, using the following rules. Initially, Kolya creates a string s, consisting of small English letters, and uniformly at random chooses an integer k from a segment [0,\xe2\x80\x89len(s)\xe2\x80\x89-\xe2\x80\x891]. He tells Vasya this string s, and then shifts it k letters to the left, i.�e. creates a new string t\xe2\x80\x89=\xe2\x80\x89sk\xe2\x80\x89+\xe2\x80\x891sk\xe2\x80\x89+\xe2\x80\x892... sns1s2... sk. Vasya does not know the integer k nor the string t, but he wants to guess the integer k. To do this, he asks Kolya to tell him the first letter of the new string, and then, after he sees it, open one more letter on some position, which Vasya can choose.Vasya understands, that he can\'t guarantee that he will win, but he wants to know the probability of winning, if he plays optimally. He wants you to compute this probability. Note that Vasya wants to know the value of k uniquely, it means, that if there are at least two cyclic shifts of s that fit the information Vasya knowns, Vasya loses. Of course, at any moment of the game Vasya wants to maximize the probability of his win." 1600

930A "Peculiar apple-tree" "dfs and similar,graphs,trees" "In Arcady\'s garden there grows a peculiar apple-tree that fruits one time per year. Its peculiarity can be explained in following way: there are n inflorescences, numbered from 1 to n. Inflorescence number 1 is situated near base of tree and any other inflorescence with number i (i\xe2\x80\x89>\xe2\x80\x891) is situated at the top of branch, which bottom is pi-th inflorescence and pi\xe2\x80\x89<\xe2\x80\x89i.Once tree starts fruiting, there appears exactly one apple in each inflorescence. The same moment as apples appear, they start to roll down along branches to the very base of tree. Each second all apples, except ones in first inflorescence simultaneously roll down one branch closer to tree base, e.g. apple in a-th inflorescence gets to pa-th inflorescence. Apples that end up in first inflorescence are gathered by Arcady in exactly the same moment. Second peculiarity of this tree is that once two apples are in same inflorescence they annihilate. This happens with each pair of apples, e.g. if there are 5 apples in same inflorescence in same time, only one will not be annihilated and if there are 8 apples, all apples will be annihilated. Thus, there can be no more than one apple in each inflorescence in each moment of time.Help Arcady with counting number of apples he will be able to collect from first inflorescence during one harvest." 1500

929D "\xd0\x9f\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xb2\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0" NA "In Arcady\'s garden there grows a peculiar apple-tree that fruits one time per year. Its peculiarity can be explained in following way: there are n inflorescences, numbered from 1 to n. Inflorescence number 1 is situated near base of tree and any other inflorescence with number i (i\xe2\x80\x89>\xe2\x80\x891) is situated at the top of branch, which bottom is pi-th inflorescence and pi\xe2\x80\x89<\xe2\x80\x89i.Once tree starts fruiting, there appears exactly one apple in each inflorescence. The same moment as apples appear, they start to roll down along branches to the very base of tree. Each second all apples, except ones in first inflorescence simultaneously roll down one branch closer to tree base, e.g. apple in a-th inflorescence gets to pa-th inflorescence. Apples that end up in first inflorescence are gathered by Arcady in exactly the same moment. Second peculiarity of this tree is that once two apples are in same inflorescence they annihilate. This happens with each pair of apples, e.g. if there are 5 apples in same inflorescence in same time, only one will not be annihilated and if there are 8 apples, all apples will be annihilated. Thus, there can be no more than one apple in each inflorescence in each moment of time.Help Arcady with counting number of apples he will be able to collect from first inflorescence during one harvest." 2400

929C "\xd0\x9a\xd1\x80\xd0\xb0\xd1\x81\xd0\xb8\xd0\xb2\xd0\xb0\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4\xd0\xb0" "*special problem,combinatorics,math" "In Arcady\'s garden there grows a peculiar apple-tree that fruits one time per year. Its peculiarity can be explained in following way: there are n inflorescences, numbered from 1 to n. Inflorescence number 1 is situated near base of tree and any other inflorescence with number i (i\xe2\x80\x89>\xe2\x80\x891) is situated at the top of branch, which bottom is pi-th inflorescence and pi\xe2\x80\x89<\xe2\x80\x89i.Once tree starts fruiting, there appears exactly one apple in each inflorescence. The same moment as apples appear, they start to roll down along branches to the very base of tree. Each second all apples, except ones in first inflorescence simultaneously roll down one branch closer to tree base, e.g. apple in a-th inflorescence gets to pa-th inflorescence. Apples that end up in first inflorescence are gathered by Arcady in exactly the same moment. Second peculiarity of this tree is that once two apples are in same inflorescence they annihilate. This happens with each pair of apples, e.g. if there are 5 apples in same inflorescence in same time, only one will not be annihilated and if there are 8 apples, all apples will be annihilated. Thus, there can be no more than one apple in each inflorescence in each moment of time.Help Arcady with counting number of apples he will be able to collect from first inflorescence during one harvest." 1700

929B "\xd0\x9c\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0 \xd0\xb2 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xbb\xd1\x91\xd1\x82\xd0\xb5" "*special problem,implementation" "In Arcady\'s garden there grows a peculiar apple-tree that fruits one time per year. Its peculiarity can be explained in following way: there are n inflorescences, numbered from 1 to n. Inflorescence number 1 is situated near base of tree and any other inflorescence with number i (i\xe2\x80\x89>\xe2\x80\x891) is situated at the top of branch, which bottom is pi-th inflorescence and pi\xe2\x80\x89<\xe2\x80\x89i.Once tree starts fruiting, there appears exactly one apple in each inflorescence. The same moment as apples appear, they start to roll down along branches to the very base of tree. Each second all apples, except ones in first inflorescence simultaneously roll down one branch closer to tree base, e.g. apple in a-th inflorescence gets to pa-th inflorescence. Apples that end up in first inflorescence are gathered by Arcady in exactly the same moment. Second peculiarity of this tree is that once two apples are in same inflorescence they annihilate. This happens with each pair of apples, e.g. if there are 5 apples in same inflorescence in same time, only one will not be annihilated and if there are 8 apples, all apples will be annihilated. Thus, there can be no more than one apple in each inflorescence in each moment of time.Help Arcady with counting number of apples he will be able to collect from first inflorescence during one harvest." 1300

929A "\xd0\x9f\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2" "*special problem,greedy,implementation" "In Arcady\'s garden there grows a peculiar apple-tree that fruits one time per year. Its peculiarity can be explained in following way: there are n inflorescences, numbered from 1 to n. Inflorescence number 1 is situated near base of tree and any other inflorescence with number i (i\xe2\x80\x89>\xe2\x80\x891) is situated at the top of branch, which bottom is pi-th inflorescence and pi\xe2\x80\x89<\xe2\x80\x89i.Once tree starts fruiting, there appears exactly one apple in each inflorescence. The same moment as apples appear, they start to roll down along branches to the very base of tree. Each second all apples, except ones in first inflorescence simultaneously roll down one branch closer to tree base, e.g. apple in a-th inflorescence gets to pa-th inflorescence. Apples that end up in first inflorescence are gathered by Arcady in exactly the same moment. Second peculiarity of this tree is that once two apples are in same inflorescence they annihilate. This happens with each pair of apples, e.g. if there are 5 apples in same inflorescence in same time, only one will not be annihilated and if there are 8 apples, all apples will be annihilated. Thus, there can be no more than one apple in each inflorescence in each moment of time.Help Arcady with counting number of apples he will be able to collect from first inflorescence during one harvest." 1400

928D Autocompletion "*special problem,strings,trees" "Arcady is a copywriter. His today\'s task is to type up an already well-designed story using his favorite text editor.Arcady types words, punctuation signs and spaces one after another. Each letter and each sign (including line feed) requires one keyboard click in order to be printed. Moreover, when Arcady has a non-empty prefix of some word on the screen, the editor proposes a possible autocompletion for this word, more precisely one of the already printed words such that its prefix matches the currently printed prefix if this word is unique. For example, if Arcady has already printed \xc2\xabcodeforces\xc2\xbb, \xc2\xabcoding\xc2\xbb and \xc2\xabcodeforces\xc2\xbb once again, then there will be no autocompletion attempt for \xc2\xabcod\xc2\xbb, but if he proceeds with \xc2\xabcode\xc2\xbb, the editor will propose \xc2\xabcodeforces\xc2\xbb.With a single click Arcady can follow the editor\'s proposal, i.e. to transform the current prefix to it. Note that no additional symbols are printed after the autocompletion (no spaces, line feeds, etc). What is the minimum number of keyboard clicks Arcady has to perform to print the entire text, if he is not allowed to move the cursor or erase the already printed symbols?A word here is a contiguous sequence of latin letters bordered by spaces, punctuation signs and line/text beginnings/ends. Arcady uses only lowercase letters. For example, there are 20 words in \xc2\xabit\'s well-known that tic-tac-toe is a paper-and-pencil game for two players, x and o.\xc2\xbb." 1900

928C "Dependency management" "*special problem,graphs,implementation" "Polycarp is currently developing a project in Vaja language and using a popular dependency management system called Vamen. From Vamen\'s point of view both Vaja project and libraries are treated projects for simplicity.A project in Vaja has its own uniqie non-empty name consisting of lowercase latin letters with length not exceeding 10 and version \xe2\x80\x94 positive integer from 1 to 106. Each project (keep in mind that it is determined by both its name and version) might depend on other projects. For sure, there are no cyclic dependencies.You\'re given a list of project descriptions. The first of the given projects is the one being developed by Polycarp at this moment. Help Polycarp determine all projects that his project depends on (directly or via a certain chain). It\'s possible that Polycarp\'s project depends on two different versions of some project. In this case collision resolving is applied, i.e. for each such project the system chooses the version that minimizes the distance from it to Polycarp\'s project. If there are several options, the newer (with the maximum version) is preferred. This version is considered actual; other versions and their dependencies are ignored.More formal, choose such a set of projects of minimum possible size that the following conditions hold:   Polycarp\'s project is chosen;  Polycarp\'s project depends (directly or indirectly) on all other projects in the set;  no two projects share the name;  for each project x that some other project in the set depends on we have either x or some y with other version and shorter chain to Polycarp\'s project chosen. In case of ties the newer one is chosen. Output all Polycarp\'s project\'s dependencies (Polycarp\'s project itself should\'t be printed) in lexicographical order." 1900

928B Chat "*special problem,dp" "There are times you recall a good old friend and everything you\'ve come through together. Luckily there are social networks�\xe2\x80\x94 they store all your message history making it easy to know what you argued over 10 years ago.More formal, your message history is a sequence of messages ordered by time sent numbered from 1 to n where n is the total number of messages in the chat.Each message might contain a link to an earlier message which it is a reply to. When opening a message x or getting a link to it, the dialogue is shown in such a way that k previous messages, message x and k next messages are visible (with respect to message x). In case there are less than k messages somewhere, they are yet all shown.Digging deep into your message history, you always read all visible messages and then go by the link in the current message x (if there is one) and continue reading in the same manner.Determine the number of messages you\'ll read if your start from message number t for all t from 1 to n. Calculate these numbers independently. If you start with message x, the initial configuration is x itself, k previous and k next messages. Messages read multiple times are considered as one." 1400

928A "Login Verification" "*special problem,strings" "When registering in a social network, users are allowed to create their own convenient login to make it easier to share contacts, print it on business cards, etc.Login is an arbitrary sequence of lower and uppercase latin letters, digits and underline symbols (\xc2\xab_\xc2\xbb). However, in order to decrease the number of frauds and user-inattention related issues, it is prohibited to register a login if it is similar with an already existing login. More precisely, two logins s and t are considered similar if we can transform s to t via a sequence of operations of the following types:   transform lowercase letters to uppercase and vice versa;  change letter \xc2\xabO\xc2\xbb (uppercase latin letter) to digit \xc2\xab0\xc2\xbb and vice versa;  change digit \xc2\xab1\xc2\xbb (one) to any letter among \xc2\xabl\xc2\xbb (lowercase latin \xc2\xabL\xc2\xbb), \xc2\xabI\xc2\xbb (uppercase latin \xc2\xabi\xc2\xbb) and vice versa, or change one of these letters to other. For example, logins \xc2\xabCodeforces\xc2\xbb and \xc2\xabcodef0rces\xc2\xbb as well as \xc2\xabOO0OOO00O0OOO0O00OOO0OO_lol\xc2\xbb and \xc2\xabOO0OOO0O00OOO0O00OO0OOO_1oI\xc2\xbb are considered similar whereas \xc2\xabCodeforces\xc2\xbb and \xc2\xabCode_forces\xc2\xbb are not.You\'re given a list of existing logins with no two similar amonst and a newly created user login. Check whether this new login is similar with any of the existing ones." 1200

927A "BuberPool Taxi Optimization" "*special problem,interactive" "This is an interactive optimization problem. Instead of having to find the best answer, each solution will get score according to its efficiency. As the problem is interactive, during the testing process, the jury program and your solution will exchange messages via standard input and output streams. After printing a message, remember to flush the output buffer to ensure that the message is fully sent. For example, you can use fflush(stdout) in C++, System.out.flush() in Java, flush(output) in Pascal, and stdout.flush() in Python.Your task is to automate the next generation taxi service, BuberPool. Each Buber car may transport up to four passengers at a time. The cars have to drive to passengers\' locations, pick them up and drive them to their destinations. Additionally, unlike a traditional taxi, each car can process up to four orders simultaneously. For example, when driving a passenger to the destination, a car can pick up an additional passenger, or make a detour to drop off another passenger.We will use the following simplified discrete model for this real-life problem.Consider a city as a rectangular grid of w streets and h avenues with w\xc3\x97h crossroads. The streets are numbered from 1 to w, and the avenues from 1 to h. We will consider non-negative integer moments of time. Actions are performed in ticks: intervals of time between consecutive moments. At any moment, each car is located at some crossroads (x,y), where 1\xe2\x89\xa4x\xe2\x89\xa4w and 1\xe2\x89\xa4y\xe2\x89\xa4h. Any number of cars can be at the same crossroads simultaneously. During one tick, each car can either remain on the same crossroads or change exactly one of its coordinates, the street or the avenue, by one.At moment 0, you are given starting locations of k cars: (x1,y1), (x2,y2), \xe2\x80\xa6, (xk,yk). The number of cars is equal to k and does not change during the simulation.Additionally, your solution will be given the clients\' orders. In this problem, each order is made by a single passenger, so a car can process up to four orders at the same time. To further simplify the problem, the moments of orders are all distinct, and the orders are given in chronological order. So, each j-th order is described by five integers: the moment tj, the pick up location (sxj,syj), and the drop-off location (txj,tyj).On tick 0, and also right after receiving each order, you can give instruction sets to the car drivers. Each time you can give instruction sets to any number of cars (more on restrictions later). Instruction sets for different cars are given separately. An instruction set is a sequence of triples (cx1,cy1,a1), (cx2,cy2,a2), \xe2\x80\xa6, (cxm,cym,am), where m is number of instructions in the set. The meaning of these numbers is as follows:  A car should first drive to (cx1,cy1), then to (cx2,cy2), \xe2\x80\xa6, and at last to (cxm,cym). Each location (cxi,cyi) may be any crossroads in the city, not necessarily a pickup or drop-off location. While driving from one location to another, a car always first changes its first coordinate until it is equal to the first coordinate of the destination, and only then the second coordinate. This way, while driving from (p1,q1) to (p2,q2), a car will first move (p1,q1)\xe2\x86\x92(p2,q1), and then (p2,q1)\xe2\x86\x92(p2,q2). In each tick while moving, a car changes exactly one of its coordinates by one.  Values ai encode actions. If ai=0, the car just drives to (cxi,cyi) and doesn\'t do anything special. If ai>0, the car drives to (cxi,cyi) and picks up passenger number ai there (the passenger\'s pickup location should be equal to (cxi,cyi), and the passenger should still be waiting there). If ai<0, the car moves to (cxi,cyi) and drops off passenger number \xe2\x88\x92ai (the passenger\'s drop-off location should be equal to (cxi,cyi), and the passenger should be in this car). Picking up and dropping off passengers are instant. When you give instruction set to a car, its previous instruction set is replaced with the new one. This way, a car only performs at most one instruction set at a time. If there are no instructions, or all of them are completed, the car is waiting at its last location. Instructions are performed in the given order.For each order, first, all the cars perform their current instruction sets until the moment of the order comes, then the order is given to your program, and after that, your program prints new instruction sets for some of the cars. The cars which don\'t get new instruction sets continue performing their old ones.So, the overall testing strategy looks like this:  Your solution reads the city dimensions, the number of cars, and their initial coordinates.  The solution prints instruction sets for some cars, and the cars start performing the instructions.  The solution reads an integer tj, the moment of the next order (if tj=\xe2\x88\x921, your program should print the final instruction sets and exit normally).  The solution reads integers sxj, syj, txj, tyj, the pickup and drop-off locations for j-th order.  The solution prints the next instruction sets for the cars.  Go to step 3. After your program exits in step 3, first, all instructions will be completely performed, and only after that the simulation will end.The score your solution gets for a test is the average score for all orders, rounded to the nearest integer. The score for an order equals \xce\xb1\xe2\x8b\x85(100+w0), where w0 is time the order takes in the ideal case, which is just the time to get from (sxj,syj) to (txj,tyj) (so, w0=|sxj\xe2\x88\x92txj|+|syj\xe2\x88\x92tyj|), and \xce\xb1 is a real value between 0 and 1 which characterizes the passenger\'s satisfaction with the ride. The value \xce\xb1 is calculated by the formula:\xce\xb1=107\xe2\x88\x92min(d21+d22,107)107,where d1 is the waiting time before pickup (the number of ticks between the time of the order and pickup time), and d2 is the difference between actual and ideal travel time (the ideal travel time is w0). If the order was not completed, \xce\xb1=0.The score your solution gets is just the sum of scores for each test." 2900

926J Segments "data structures" "There is a straight line colored in white. n black segments are added on it one by one.After each segment is added, determine the number of connected components of black segments (i.�e. the number of black segments in the union of the black segments). In particular, if one segment ends in a point x, and another segment starts in the point x, these two segments belong to the same connected component." 2100

926I "A Vital Problem" NA "Polycarp has a strict daily schedule. He has n alarms set for each day, and the i-th alarm rings each day at the same time during exactly one minute.Determine the longest time segment when Polycarp can sleep, i.�e. no alarm rings in that period. It is possible that Polycarp begins to sleep in one day, and wakes up in another." 1700

926H "Endless Roses Most Beautiful" NA "Arkady decided to buy roses for his girlfriend.A flower shop has white, orange and red roses, and the total amount of them is n. Arkady thinks that red roses are not good together with white roses, so he won\'t buy a bouquet containing both red and white roses. Also, Arkady won\'t buy a bouquet where all roses have the same color. Arkady wants to buy exactly k roses. For each rose in the shop he knows its beauty and color: the beauty of the i-th rose is bi, and its color is ci (\'W\' for a white rose, \'O\' for an orange rose and \'R\' for a red rose). Compute the maximum possible total beauty of a bouquet of k roses satisfying the constraints above or determine that it is not possible to make such a bouquet." 2200

926G "Large Bouquets" NA "A flower shop has got n bouquets, and the i-th bouquet consists of ai flowers. Vasya, the manager of the shop, decided to make large bouquets from these bouquets. Vasya thinks that a bouquet is large if it is made of two or more initial bouquets, and there is a constraint: the total number of flowers in a large bouquet should be odd. Each of the initial bouquets can be a part of at most one large bouquet. If an initial bouquet becomes a part of a large bouquet, all its flowers are included in the large bouquet.Determine the maximum possible number of large bouquets Vasya can make." 1500

926F "Mobile Communications" NA "A sum of p rubles is charged from Arkady\'s mobile phone account every day in the morning. Among the following m days, there are n days when Arkady will top up the account: in the day di he will deposit ti rubles on his mobile phone account. Arkady will always top up the account before the daily payment will be done. There will be no other payments nor tops up in the following m days.Determine the number of days starting from the 1-st to the m-th such that the account will have a negative amount on it after the daily payment (i.�e. in evening). Initially the account\'s balance is zero rubles." 2000

926E "Merge Equal Elements" "constructive algorithms,data structures" "You are given a sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. While possible, you perform the following operation: find a pair of equal consecutive elements. If there are more than one such pair, find the leftmost (with the smallest indices of elements). If the two integers are equal to x, delete both and insert a single integer x\xe2\x80\x89+\xe2\x80\x891 on their place. This way the number of elements in the sequence is decreased by 1 on each step. You stop performing the operation when there is no pair of equal consecutive elements.For example, if the initial sequence is [5,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x892], then after the first operation you get [5,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x892], after the second \xe2\x80\x94 [5,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x892], after the third \xe2\x80\x94 [5,\xe2\x80\x893,\xe2\x80\x893], and finally after the fourth you get [5,\xe2\x80\x894]. After that there are no equal consecutive elements left in the sequence, so you stop the process.Determine the final sequence after you stop performing the operation." 1900

926D "Choose Place" NA "A classroom in a school has six rows with 3 desks in each row. Two people can use the same desk: one sitting on the left and one sitting on the right. Some places are already occupied, and some places are vacant. Petya has just entered the class and wants to occupy the most convenient place. The conveniences of the places are shown on the picture:  Here, the desks in the top row are the closest to the blackboard, while the desks in the bottom row are the furthest from the blackboard.You are given a plan of the class, where \'*\' denotes an occupied place, \'.\' denotes a vacant place, and the aisles are denoted by \'-\'. Find any of the most convenient vacant places for Petya." 1600

926C "Is This a Zebra?" implementation "A camera you have accidentally left in a desert has taken an interesting photo. The photo has a resolution of n pixels width, and each column of this photo is all white or all black. Thus, we can represent the photo as a sequence of n zeros and ones, where 0 means that the corresponding column is all white, and 1 means that the corresponding column is black.You think that this photo can contain a zebra. In this case the whole photo should consist of several (possibly, only one) alternating black and white stripes of equal width. For example, the photo [0,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x890] can be a photo of zebra, while the photo [0,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x891] can not, because the width of the black stripe is 3, while the width of the white stripe is 4. Can the given photo be a photo of zebra or not?" 1700

926B "Add Points" "math,number theory" "There are n points on a straight line, and the i-th point among them is located at xi. All these coordinates are distinct.Determine the number m \xe2\x80\x94 the smallest number of points you should add on the line to make the distances between all neighboring points equal." 1800

926A 2-3-numbers implementation,math "A positive integer is called a 2-3-integer, if it is equal to 2x\xc2\xb73y for some non-negative integers x and y. In other words, these integers are such integers that only have 2 and 3 among their prime divisors. For example, integers 1, 6, 9, 16 and 108 \xe2\x80\x94 are 2-3 integers, while 5, 10, 21 and 120 are not.Print the number of 2-3-integers on the given segment [l,\xe2\x80\x89r], i.�e. the number of sich 2-3-integers t that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r." 1300

925F "Parametric Circulation" "binary search,flows" "Vova has recently learned what a circulaton in a graph is. Recall the definition: let G=(V,E)G=(V,E) be a directed graph. A circulation f is such a collection of non-negative real numbers fe (e\xe2\x88\x88E), that for each vertex v\xe2\x88\x88V the following conservation condition holds:\xe2\x88\x91e\xe2\x88\x88\xce\xb4\xe2\x88\x92(v)fe=\xe2\x88\x91e\xe2\x88\x88\xce\xb4+(v)fewhere \xce\xb4+(v) is the set of edges that end in the vertex v, and \xce\xb4\xe2\x88\x92(v) is the set of edges that start in the vertex v. In other words, for each vertex the total incoming flow should be equal to the total outcoming flow.Let a lr-circulation be such a circulation f that for each edge the condition le\xe2\x89\xa4fe\xe2\x89\xa4re holds, where le and re for each edge e\xe2\x88\x88E are two non-negative real numbers denoting the lower and upper bounds on the value of the circulation on this edge e.Vova can\'t stop thinking about applications of a new topic. Right now he thinks about the following natural question: let the graph be fixed, and each value le and re be a linear function of a real variable t:le(t)=aet+be re(t)=cet+deNote that t is the same for all edges.Let t be chosen at random from uniform distribution on a segment [0,1]. What is the probability of existence of lr-circulation in the graph?" 3100

925E "May Holidays" "data structures,trees" "It\'s May in Flatland, and there are m days in this month. Despite the fact that May Holidays are canceled long time ago, employees of some software company still have a habit of taking short or long vacations in May.Of course, not all managers of the company like this. There are n employees in the company that form a tree-like structure of subordination: each employee has a unique integer id i between 1 and n, and each employee with id i (except the head manager whose id is 1) has exactly one direct manager with id pi. The structure of subordination is not cyclic, i.e. if we start moving from any employee to his direct manager, then we will eventually reach the head manager. We define that an employee u is a subordinate of an employee v, if v is a direct manager of u, or the direct manager of u is a subordinate of v. Let si be the number of subordinates the i-th employee has (for example, s1=n\xe2\x88\x921, because all employees except himself are subordinates of the head manager).Each employee i has a bearing limit of ti, which is an integer between 0 and si. It denotes the maximum number of the subordinates of the i-th employee being on vacation at the same moment that he can bear. If at some moment strictly more than ti subordinates of the i-th employee are on vacation, and the i-th employee himself is not on a vacation, he becomes displeased.In each of the m days of May exactly one event of the following two types happens: either one employee leaves on a vacation at the beginning of the day, or one employee returns from a vacation in the beginning of the day. You know the sequence of events in the following m days. Your task is to compute for each of the m days the number of displeased employees on that day." 2900

925D "Aztec Catacombs" "constructive algorithms" "Indiana Jones found ancient Aztec catacombs containing a golden idol. The catacombs consists of n caves. Each pair of caves is connected with a two-way corridor that can be opened or closed. The entrance to the catacombs is in the cave 1, the idol and the exit are in the cave n.When Indiana goes from a cave x to a cave y using an open corridor, all corridors connected to the cave x change their state: all open corridors become closed, all closed corridors become open. Indiana wants to go from cave 1 to cave n going through as small number of corridors as possible. Help him find the optimal path, or determine that it is impossible to get out of catacombs." 2600

925C "Big Secret" "constructive algorithms,math" "Vitya has learned that the answer for The Ultimate Question of Life, the Universe, and Everything is not the integer 54 42, but an increasing integer sequence a1,\xe2\x80\xa6,an. In order to not reveal the secret earlier than needed, Vitya encrypted the answer and obtained the sequence b1,\xe2\x80\xa6,bn using the following rules:  b1=a1; bi=ai\xe2\x8a\x95ai\xe2\x88\x921 for all i from 2 to n, where x\xe2\x8a\x95y is the bitwise XOR of x and y. It is easy to see that the original sequence can be obtained using the rule ai=b1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95bi.However, some time later Vitya discovered that the integers bi in the cypher got shuffled, and it can happen that when decrypted using the rule mentioned above, it can produce a sequence that is not increasing. In order to save his reputation in the scientific community, Vasya decided to find some permutation of integers bi so that the sequence ai=b1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95bi is strictly increasing. Help him find such a permutation or determine that it is impossible." 2200

925B "Resource Distribution" "binary search,implementation,sortings" "One department of some software company has n servers of different specifications. Servers are indexed with consecutive integers from 1 to n. Suppose that the specifications of the j-th server may be expressed with a single integer number cj of artificial resource units.In order for production to work, it is needed to deploy two services S1 and S2 to process incoming requests using the servers of the department. Processing of incoming requests of service Si takes xi resource units.The described situation happens in an advanced company, that is why each service may be deployed using not only one server, but several servers simultaneously. If service Si is deployed using ki servers, then the load is divided equally between these servers and each server requires only xi/ki (that may be a fractional number) resource units.Each server may be left unused at all, or be used for deploying exactly one of the services (but not for two of them simultaneously). The service should not use more resources than the server provides.Determine if it is possible to deploy both services using the given servers, and if yes, determine which servers should be used for deploying each of the services." 1700

925A "Stairs and Elevators" "binary search" "In the year of 30XX participants of some world programming championship live in a single large hotel. The hotel has n floors. Each floor has m sections with a single corridor connecting all of them. The sections are enumerated from 1 to m along the corridor, and all sections with equal numbers on different floors are located exactly one above the other. Thus, the hotel can be represented as a rectangle of height n and width m. We can denote sections with pairs of integers (i,j), where i is the floor, and j is the section number on the floor.The guests can walk along the corridor on each floor, use stairs and elevators. Each stairs or elevator occupies all sections (1,x), (2,x), \xe2\x80\xa6, (n,x) for some x between 1 and m. All sections not occupied with stairs or elevators contain guest rooms. It takes one time unit to move between neighboring sections on the same floor or to move one floor up or down using stairs. It takes one time unit to move up to v floors in any direction using an elevator. You can assume you don\'t have to wait for an elevator, and the time needed to enter or exit an elevator is negligible.You are to process q queries. Each query is a question ""what is the minimum time needed to go from a room in section (x1,y1) to a room in section (x2,y2)?""" 1600

924F "Minimal Subset Difference" dp "We call a positive integer x a k-beautiful integer if and only if it is possible to split the multiset of its digits in the decimal representation into two subsets such that the difference between the sum of digits in one subset and the sum of digits in the other subset is less than or equal to k. Each digit should belong to exactly one subset after the split.There are n queries for you. Each query is described with three integers l, r and k, which mean that you are asked how many integers x between l and r (inclusive) are k-beautiful." 3200

924E Wardrobe dp,greedy "Olya wants to buy a custom wardrobe. It should have n boxes with heights a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, stacked one on another in some order. In other words, we can represent each box as a vertical segment of length ai, and all these segments should form a single segment from 0 to  without any overlaps.Some of the boxes are important (in this case bi\xe2\x80\x89=\xe2\x80\x891), others are not (then bi\xe2\x80\x89=\xe2\x80\x890). Olya defines the convenience of the wardrobe as the number of important boxes such that their bottom edge is located between the heights l and r, inclusive.You are given information about heights of the boxes and their importance. Compute the maximum possible convenience of the wardrobe if you can reorder the boxes arbitrarily." 2700

924D "Contact ATC" NA "Arkady the air traffic controller is now working with n planes in the air. All planes move along a straight coordinate axis with Arkady\'s station being at point 0 on it. The i-th plane, small enough to be represented by a point, currently has a coordinate of xi and is moving with speed vi. It\'s guaranteed that xi\xc2\xb7vi\xe2\x80\x89<\xe2\x80\x890, i.e., all planes are moving towards the station.Occasionally, the planes are affected by winds. With a wind of speed vwind (not necessarily positive or integral), the speed of the i-th plane becomes vi\xe2\x80\x89+\xe2\x80\x89vwind.According to weather report, the current wind has a steady speed falling inside the range [\xe2\x80\x89-\xe2\x80\x89w,\xe2\x80\x89w] (inclusive), but the exact value cannot be measured accurately since this value is rather small \xe2\x80\x94 smaller than the absolute value of speed of any plane.Each plane should contact Arkady at the exact moment it passes above his station. And you are to help Arkady count the number of pairs of planes (i,\xe2\x80\x89j) (i\xe2\x80\x89<\xe2\x80\x89j) there are such that there is a possible value of wind speed, under which planes i and j contact Arkady at the same moment. This value needn\'t be the same across different pairs.The wind speed is the same for all planes. You may assume that the wind has a steady speed and lasts arbitrarily long." 2500

924C "Riverside Curio" "data structures,dp,greedy" "Arkady decides to observe a river for n consecutive days. The river\'s water level on each day is equal to some real value.Arkady goes to the riverside each day and makes a mark on the side of the channel at the height of the water level, but if it coincides with a mark made before, no new mark is created. The water does not wash the marks away. Arkady writes down the number of marks strictly above the water level each day, on the i-th day this value is equal to mi.Define di as the number of marks strictly under the water level on the i-th day. You are to find out the minimum possible sum of di over all days. There are no marks on the channel before the first day." 1700

924B "Three-level Laser" "binary search,greedy,two pointers" "An atom of element X can exist in n distinct states with energies E1\xe2\x80\x89<\xe2\x80\x89E2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89En. Arkady wants to build a laser on this element, using a three-level scheme. Here is a simplified description of the scheme. Three distinct states i, j and k are selected, where i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89k. After that the following process happens:   initially the atom is in the state i, we spend Ek\xe2\x80\x89-\xe2\x80\x89Ei energy to put the atom in the state k, the atom emits a photon with useful energy Ek\xe2\x80\x89-\xe2\x80\x89Ej and changes its state to the state j, the atom spontaneously changes its state to the state i, losing energy Ej\xe2\x80\x89-\xe2\x80\x89Ei, the process repeats from step 1. Let\'s define the energy conversion efficiency as , i.�e. the ration between the useful energy of the photon and spent energy.Due to some limitations, Arkady can only choose such three states that Ek\xe2\x80\x89-\xe2\x80\x89Ei\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89U.Help Arkady to find such the maximum possible energy conversion efficiency within the above constraints." 1600

924A "Mystical Mosaic" greedy,implementation "There is a rectangular grid of n rows of m initially-white cells each.Arkady performed a certain number (possibly zero) of operations on it. In the i-th operation, a non-empty subset of rows Ri and a non-empty subset of columns Ci are chosen. For each row r in Ri and each column c in Ci, the intersection of row r and column c is coloured black.There\'s another constraint: a row or a column can only be chosen at most once among all operations. In other words, it means that no pair of (i,\xe2\x80\x89j) (i\xe2\x80\x89<\xe2\x80\x89j) exists such that  or , where  denotes intersection of sets, and  denotes the empty set.You are to determine whether a valid sequence of operations exists that produces a given final grid." 1300

923F "Public Service" "constructive algorithms,graphs,trees" "There are N cities in Bob\'s country connected by roads. Some pairs of cities are connected by public transport. There are two competing transport companies�\xe2\x80\x94 Boblines operating buses and Bobrail running trains. When traveling from A to B, a passenger always first selects the mode of transport (either bus or train), and then embarks on a journey. For every pair of cities, there are exactly two ways of how to travel between them without visiting any city more than once�\xe2\x80\x94 one using only bus routes, and the second using only train routes. Furthermore, there is no pair of cities that is directly connected by both a bus route and a train route.You obtained the plans of each of the networks. Unfortunately, each of the companies uses different names for the same cities. More precisely, the bus company numbers the cities using integers from 1 to N, while the train company uses integers between N\xe2\x80\x89+\xe2\x80\x891 and 2N. Find one possible mapping between those two numbering schemes, such that no pair of cities is connected directly by both a bus route and a train route. Note that this mapping has to map different cities to different cities." 3200

923E "Perpetual Subtraction" fft,math,matrices "There is a number x initially written on a blackboard. You repeat the following action a fixed amount of times:   take the number x currently written on a blackboard and erase it  select an integer uniformly at random from the range [0,\xe2\x80\x89x] inclusive, and write it on the blackboard Determine the distribution of final number given the distribution of initial number and the number of steps." 3100

923D "Picking Strings" "constructive algorithms,implementation,strings" "Alice has a string consisting of characters \'A\', \'B\' and \'C\'. Bob can use the following transitions on any substring of our string in any order any number of times:   A  BC  B  AC  C  AB  AAA  empty string Note that a substring is one or more consecutive characters. For given queries, determine whether it is possible to obtain the target string from source." 2500

923C "Perfect Security" "data structures,greedy,strings,trees" "Alice has a very important message M consisting of some non-negative integers that she wants to keep secret from Eve. Alice knows that the only theoretically secure cipher is one-time pad. Alice generates a random key K of the length equal to the message\'s length. Alice computes the bitwise xor of each element of the message and the key (, where  denotes the bitwise XOR operation) and stores this encrypted message A. Alice is smart. Be like Alice.For example, Alice may have wanted to store a message M\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x8915,\xe2\x80\x899,\xe2\x80\x8918). She generated a key K\xe2\x80\x89=\xe2\x80\x89(16,\xe2\x80\x897,\xe2\x80\x896,\xe2\x80\x893). The encrypted message is thus A\xe2\x80\x89=\xe2\x80\x89(16,\xe2\x80\x898,\xe2\x80\x8915,\xe2\x80\x8917).Alice realised that she cannot store the key with the encrypted message. Alice sent her key K to Bob and deleted her own copy. Alice is smart. Really, be like Alice.Bob realised that the encrypted message is only secure as long as the key is secret. Bob thus randomly permuted the key before storing it. Bob thinks that this way, even if Eve gets both the encrypted message and the key, she will not be able to read the message. Bob is not smart. Don\'t be like Bob.In the above example, Bob may have, for instance, selected a permutation (3,\xe2\x80\x894,\xe2\x80\x891,\xe2\x80\x892) and stored the permuted key P\xe2\x80\x89=\xe2\x80\x89(6,\xe2\x80\x893,\xe2\x80\x8916,\xe2\x80\x897).One year has passed and Alice wants to decrypt her message. Only now Bob has realised that this is impossible. As he has permuted the key randomly, the message is lost forever. Did we mention that Bob isn\'t smart?Bob wants to salvage at least some information from the message. Since he is not so smart, he asks for your help. You know the encrypted message A and the permuted key P. What is the lexicographically smallest message that could have resulted in the given encrypted text?More precisely, for given A and P, find the lexicographically smallest message O, for which there exists a permutation \xcf\x80 such that  for every i.Note that the sequence S is lexicographically smaller than the sequence T, if there is an index i such that Si\xe2\x80\x89<\xe2\x80\x89Ti and for all j\xe2\x80\x89<\xe2\x80\x89i the condition Sj\xe2\x80\x89=\xe2\x80\x89Tj holds." 1800

923B "Producing Snow" "binary search,data structures" "Alice likes snow a lot! Unfortunately, this year\'s winter is already over, and she can\'t expect to have any more of it. Bob has thus bought her a gift�\xe2\x80\x94 a large snow maker. He plans to make some amount of snow every day. On day i he will make a pile of snow of volume Vi and put it in her garden.Each day, every pile will shrink a little due to melting. More precisely, when the temperature on a given day is Ti, each pile will reduce its volume by Ti. If this would reduce the volume of a pile to or below zero, it disappears forever. All snow piles are independent of each other. Note that the pile made on day i already loses part of its volume on the same day. In an extreme case, this may mean that there are no piles left at the end of a particular day.You are given the initial pile sizes and the temperature on each day. Determine the total volume of snow melted on each day." 1600

923A "Primal Sport" "math,number theory" "Alice and Bob begin their day with a quick game. They first choose a starting number X0\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x893 and try to reach one million by the process described below. Alice goes first and then they take alternating turns. In the i-th turn, the player whose turn it is selects a prime number smaller than the current number, and announces the smallest multiple of this prime number that is not smaller than the current number.Formally, he or she selects a prime p\xe2\x80\x89<\xe2\x80\x89Xi\xe2\x80\x89-\xe2\x80\x891 and then finds the minimum Xi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89Xi\xe2\x80\x89-\xe2\x80\x891 such that p divides Xi. Note that if the selected prime p already divides Xi\xe2\x80\x89-\xe2\x80\x891, then the number does not change.Eve has witnessed the state of the game after two turns. Given X2, help her determine what is the smallest possible starting number X0. Note that the players don\'t necessarily play optimally. You should consider all possible game evolutions." 1700

922F Divisibility "constructive algorithms,dp,greedy,number theory" "Imp is really pleased that you helped him. But it you solve the last problem, his gladness would raise even more.   Let\'s define  for some set of integers  as the number of pairs a, b in , such that:  a is strictly less than b;  a divides b without a remainder. You are to find such a set , which is a subset of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n} (the set that contains all positive integers not greater than n), that ." 2400

922E Birds dp "Apart from plush toys, Imp is a huge fan of little yellow birds!  To summon birds, Imp needs strong magic. There are n trees in a row on an alley in a park, there is a nest on each of the trees. In the i-th nest there are ci birds; to summon one bird from this nest Imp needs to stay under this tree and it costs him costi points of mana. However, for each bird summoned, Imp increases his mana capacity by B points. Imp summons birds one by one, he can summon any number from 0 to ci birds from the i-th nest. Initially Imp stands under the first tree and has W points of mana, and his mana capacity equals W as well. He can only go forward, and each time he moves from a tree to the next one, he restores X points of mana (but it can\'t exceed his current mana capacity). Moving only forward, what is the maximum number of birds Imp can summon?" 2200

922D "Robot Vacuum Cleaner" greedy,sortings "Pushok the dog has been chasing Imp for a few hours already.  Fortunately, Imp knows that Pushok is afraid of a robot vacuum cleaner. While moving, the robot generates a string t consisting of letters \'s\' and \'h\', that produces a lot of noise. We define noise of string t as the number of occurrences of string ""sh"" as a subsequence in it, in other words, the number of such pairs (i,\xe2\x80\x89j), that i\xe2\x80\x89<\xe2\x80\x89j and  and . The robot is off at the moment. Imp knows that it has a sequence of strings ti in its memory, and he can arbitrary change their order. When the robot is started, it generates the string t as a concatenation of these strings in the given order. The noise of the resulting string equals the noise of this concatenation.Help Imp to find the maximum noise he can achieve by changing the order of the strings." 1800

922C "Cave Painting" "brute force,number theory" "Imp is watching a documentary about cave painting.  Some numbers, carved in chaotic order, immediately attracted his attention. Imp rapidly proposed a guess that they are the remainders of division of a number n by all integers i from 1 to k. Unfortunately, there are too many integers to analyze for Imp.Imp wants you to check whether all these remainders are distinct. Formally, he wants to check, if all , 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k, are distinct, i.�e. there is no such pair (i,\xe2\x80\x89j) that:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k,  , where  is the remainder of division x by y." 1600

922B "Magic Forest" "brute force" "Imp is in a magic forest, where xorangles grow (wut?)  A xorangle of order n is such a non-degenerate triangle, that lengths of its sides are integers not exceeding n, and the xor-sum of the lengths is equal to zero. Imp has to count the number of distinct xorangles of order n to get out of the forest. Formally, for a given integer n you have to find the number of such triples (a,\xe2\x80\x89b,\xe2\x80\x89c), that:  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;  , where  denotes the bitwise xor of integers x and y.  (a,\xe2\x80\x89b,\xe2\x80\x89c) form a non-degenerate (with strictly positive area) triangle." 1300

922A "Cloning Toys" implementation "Imp likes his plush toy a lot.  Recently, he found a machine that can clone plush toys. Imp knows that if he applies the machine to an original toy, he additionally gets one more original toy and one copy, and if he applies the machine to a copied toy, he gets two additional copies.Initially, Imp has only one original toy. He wants to know if it is possible to use machine to get exactly x copied toys and y original toys? He can\'t throw toys away, and he can\'t apply the machine to a copy if he doesn\'t currently have any copies." 1300

92114 Labyrinth-14 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200

92113 Labyrinth-13 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200

92112 Labyrinth-12 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200

92111 Labyrinth-11 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200

92110 Labyrinth-10 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200

92109 Labyrinth-9 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200

92108 Labyrinth-8 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200

92107 Labyrinth-7 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200

92106 Labyrinth-6 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200

92105 Labyrinth-5 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200

92104 Labyrinth-4 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200

92103 Labyrinth-3 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200

92102 Labyrinth-2 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200

92101 Labyrinth-1 NA "You have a robot in a two-dimensional labyrinth which consists of N\xe2\x80\x89\xc3\x97\xe2\x80\x89M cells. Some pairs of cells adjacent by side are separated by a wall or a door. The labyrinth itself is separated from the outside with walls around it. Some labyrinth cells are the exits. In order to leave the labyrinth the robot should reach any exit. There are keys in some cells. Any key can open any door but after the door is opened the key stays in the lock. Thus every key can be used only once. There are no labyrinth cells that contain both a key and an exit. Also there can not be both a wall and a door between the pair of adjacent cells.Your need to write a program in abc language (see the language description below) that will lead the robot to one of the exits. Lets numerate the labyrinth rows from 0 to N\xe2\x80\x89-\xe2\x80\x891 top to bottom and the columns \xe2\x80\x93 from 0 to M\xe2\x80\x89-\xe2\x80\x891 left to right.In abc language the following primary commands are available:  move-DIR \xe2\x80\x93 move to the adjacent cell in the  direction. down increases the number of the row by 1, right increases the number of the column by 1. In case there\xe2\x80\x99s a wall or a closed door in this direction, nothing\xe2\x80\x99s happening.  open-DIR \xe2\x80\x93 open the door between the current cell and the adjacent one in DIR direction. In case there isn\xe2\x80\x99t any door in this direction or it\xe2\x80\x99s already been opened or the robot doesn\xe2\x80\x99t have a key, nothing\xe2\x80\x99s happening. take \xe2\x80\x93 take the key in the current cell. In case there isn\xe2\x80\x99t any key or the robot has already picked it up, nothing\xe2\x80\x99s happening. The robot is able to carry any number of keys. terminate \xe2\x80\x93 terminate the program. This command is not obligatory to use. In case it\xe2\x80\x99s absent the command is added at the end of the program automatically. Also, there are the following control commands in abc language:   for-N OPS end \xe2\x80\x93 repeat the sequence of the OPS commands N times, 0\xe2\x80\x89<\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89100000. Each loop counter check counts as a command fulfilled by the robot.  if-ok  OPS1  else  OPS2  endif \xe2\x80\x93 carries out the sequence of the OPS1 commands, if the previous command of moving, taking the key or opening the door was successful, otherwise the sequence of the OPS2 commands is being carried out. Should there be no previous command run, the sequence OPS1 will be carried out. If-ok check counts as a command fulfilled by the robot.  break \xe2\x80\x93 stops the current for loop.  continue \xe2\x80\x93 finishes the current for loop iterations. Note that the control and the primary commands can be fit into each other arbitrarily.The robot will fulfill your commands sequentially until it exits the labyrinth, or it runs out of the commands, or the terminate command is run, or the quantity of the fulfilled commands exceeds the bound number 5\xc2\xb7106.In abc language each command is a separate word and should be separated from other commands with at least one space symbol.You should write a program that prints the sequence of commands leading the robot out of the labyrinth. Of course, as you are a good programmer, you should optimize these sequence.The number of the non-space symbols in the sequence should not exceed 107. If you succeed in finding the way out of the labyrinth i you\xe2\x80\x99ll be granted the number of points equal to:  where:   Wi \xe2\x80\x93 labyrinth\xe2\x80\x99s weight, some fixed constant.  Gi \xe2\x80\x93 number of robots moves.  Oi \xe2\x80\x93 number of fulfilled commands. Note that this number includes commands like take executed in the cells with no key, as well as opening commands applied to the already opened doors.  Li \xe2\x80\x93 sequence length in symbols, excluding space symbols and line breaks.  Q\xe2\x80\x89=\xe2\x80\x8910\xc2\xb7N\xc2\xb7M. In case your sequence doesn\xe2\x80\x99t lead the robot to the exit you\xe2\x80\x99ll be granted 0 points. Your programs result will be the sum of all Si. You should maximize this total sum.All labyrinths will be known and available to you. You can download the archive with labyrinths by any of the given links, password to extract files is aimtechiscool:  https://drive.google.com/file/d/1dkIBfW_Gy6c3FJtXjMXZPMsGKRyn3pzp  https://www.dropbox.com/s/77jrplnjgmviiwt/aimmaze.zip?dl=0  https://yadi.sk/d/JNXDLeH63RzaCi In order to make local testing of your programs more convenient, the program calculating your results (checker) and the labyrinth visualizer will be available. This program is written in python3 programming language, that\xe2\x80\x99s why you\xe2\x80\x99re going to need python3 interpreter, as well as pillow library, which you can install with the following command pip3 install pillow. pip3 is a utility program for python3 package (library) installation. It will be installed automatically with the python3 interpreter.Example command to run checker and visualizer: python3 aimmaze.py maze.in robot.abc --image maze.png. The checker can be run separately of visualization: python3 aimmaze.py maze.in robot.abc. Flag --output-log will let you see the information of robots each step: python3 aimmaze.py maze.in robot.abc --output-log. Note python3 can be installed as python on your computer.To adjust image settings, you can edit constants at the beginning of the program aimmaze.py." 3200

920G "List Of Integers" "binary search,bitmasks,brute force,combinatorics,math,number theory" "Let\'s denote as L(x,\xe2\x80\x89p) an infinite sequence of integers y such that gcd(p,\xe2\x80\x89y)\xe2\x80\x89=\xe2\x80\x891 and y\xe2\x80\x89>\xe2\x80\x89x (where gcd is the greatest common divisor of two integer numbers), sorted in ascending order. The elements of L(x,\xe2\x80\x89p) are 1-indexed; for example, 9, 13 and 15 are the first, the second and the third elements of L(7,\xe2\x80\x8922), respectively.You have to process t queries. Each query is denoted by three integers x, p and k, and the answer to this query is k-th element of L(x,\xe2\x80\x89p)." 2200

920F "SUM and REPLACE" "brute force,data structures,dsu,number theory" "Let D(x) be the number of positive divisors of a positive integer x. For example, D(2)\xe2\x80\x89=\xe2\x80\x892 (2 is divisible by 1 and 2), D(6)\xe2\x80\x89=\xe2\x80\x894 (6 is divisible by 1, 2, 3 and 6).You are given an array a of n integers. You have to process two types of queries:  REPLACE l r \xe2\x80\x94 for every  replace ai with D(ai);  SUM l r \xe2\x80\x94 calculate . Print the answer for each SUM query." 2000

920E "Connected Components?" "data structures,dfs and similar,dsu,graphs" "You are given an undirected graph consisting of n vertices and  edges. Instead of giving you the edges that exist in the graph, we give you m unordered pairs (x,\xe2\x80\x89y) such that there is no edge between x and y, and if some pair of vertices is not listed in the input, then there is an edge between these vertices.You have to find the number of connected components in the graph and the size of each component. A connected component is a set of vertices X such that for every two vertices from this set there exists at least one path in the graph connecting these vertices, but adding any other vertex to X violates this rule." 2100

920D Tanks dp,greedy,implementation "Petya sometimes has to water his field. To water the field, Petya needs a tank with exactly V ml of water.Petya has got N tanks, i-th of them initially containing ai ml of water. The tanks are really large, any of them can contain any amount of water (no matter how large this amount is).Also Petya has got a scoop that can contain up to K ml of water (initially the scoop is empty). This scoop can be used to get some water from some tank, and after that pour it all into some tank (it is impossible to get water from multiple tanks without pouring it, or leave some water in the scoop when pouring it). When Petya tries to get some water from a tank, he gets min(v,\xe2\x80\x89K) water, where v is the current volume of water in the tank.Is it possible to obtain a tank with exactly V ml of water using these operations? If it is possible, print a sequence of operations that allows to do it. If there are multiple ways to obtain needed amount of water in some tank, print any of them." 2400

920C "Swap Adjacent Elements" "dfs and similar,greedy,math,sortings,two pointers" "You have an array a consisting of n integers. Each integer from 1 to n appears exactly once in this array.For some indices i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) it is possible to swap i-th element with (i\xe2\x80\x89+\xe2\x80\x891)-th, for other indices it is not possible. You may perform any number of swapping operations any order. There is no limit on the number of times you swap i-th element with (i\xe2\x80\x89+\xe2\x80\x891)-th (if the position is not forbidden).Can you make this array sorted in ascending order performing some sequence of swapping operations?" 1400

920B "Tea Queue" implementation "Recently n students from city S moved to city P to attend a programming camp.They moved there by train. In the evening, all students in the train decided that they want to drink some tea. Of course, no two people can use the same teapot simultaneously, so the students had to form a queue to get their tea.i-th student comes to the end of the queue at the beginning of li-th second. If there are multiple students coming to the queue in the same moment, then the student with greater index comes after the student with lesser index. Students in the queue behave as follows: if there is nobody in the queue before the student, then he uses the teapot for exactly one second and leaves the queue with his tea; otherwise the student waits for the people before him to get their tea. If at the beginning of ri-th second student i still cannot get his tea (there is someone before him in the queue), then he leaves the queue without getting any tea. For each student determine the second he will use the teapot and get his tea (if he actually gets it)." 1200

920A "Water The Garden" implementation "It is winter now, and Max decided it\'s about time he watered the garden.The garden can be represented as n consecutive garden beds, numbered from 1 to n. k beds contain water taps (i-th tap is located in the bed xi), which, if turned on, start delivering water to neighbouring beds. If the tap on the bed xi is turned on, then after one second has passed, the bed xi will be watered; after two seconds have passed, the beds from the segment [xi\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891] will be watered (if they exist); after j seconds have passed (j is an integer number), the beds from the segment [xi\xe2\x80\x89-\xe2\x80\x89(j\xe2\x80\x89-\xe2\x80\x891),\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x89(j\xe2\x80\x89-\xe2\x80\x891)] will be watered (if they exist). Nothing changes during the seconds, so, for example, we can\'t say that the segment [xi\xe2\x80\x89-\xe2\x80\x892.5,\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x892.5] will be watered after 2.5 seconds have passed; only the segment [xi\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x892] will be watered at that moment.  The garden from test 1. White colour denotes a garden bed without a tap, red colour \xe2\x80\x94 a garden bed with a tap.   The garden from test 1 after 2 seconds have passed after turning on the tap. White colour denotes an unwatered garden bed, blue colour \xe2\x80\x94 a watered bed. Max wants to turn on all the water taps at the same moment, and now he wonders, what is the minimum number of seconds that have to pass after he turns on some taps until the whole garden is watered. Help him to find the answer!" 1000

919F "A Game With Numbers" "games,graphs,shortest paths" "Imagine that Alice is playing a card game with her friend Bob. They both have exactly 8 cards and there is an integer on each card, ranging from 0 to 4. In each round, Alice or Bob in turns choose two cards from different players, let them be a and b, where a is the number on the player\'s card, and b is the number on the opponent\'s card. It is necessary that a\xe2\x8b\x85b\xe2\x89\xa00. Then they calculate c=(a+b)mod5 and replace the number a with c. The player who ends up with numbers on all 8 cards being 0, wins.Now Alice wants to know who wins in some situations. She will give you her cards\' numbers, Bob\'s cards\' numbers and the person playing the first round. Your task is to determine who wins if both of them choose the best operation in their rounds." 2600

919E "Congruence Equation" "chinese remainder theorem,math,number theory" "Given an integer x. Your task is to find out how many positive integers n (1\xe2\x89\xa4n\xe2\x89\xa4x) satisfy n\xe2\x8b\x85an\xe2\x89\xa1b(modp), where a,b,p are all known constants." 2100

919D Substring "dfs and similar,dp,graphs" "You are given a graph with n nodes and m directed edges. One lowercase letter is assigned to each node. We define a path\'s value as the number of the most frequently occurring letter. For example, if letters on a path are ""abaca"", then the value of that path is 3. Your task is find a path whose value is the largest." 1700

919C "Seat Arrangements" "brute force,implementation" "Suppose that you are in a campus and have to go for classes day by day. As you may see, when you hurry to a classroom, you surprisingly find that many seats there are already occupied. Today you and your friends went for class, and found out that some of the seats were occupied.The classroom contains n rows of seats and there are m seats in each row. Then the classroom can be represented as an n\xc3\x97m matrix. The character \'.\' represents an empty seat, while \'*\' means that the seat is occupied. You need to find k consecutive empty seats in the same row or column and arrange those seats for you and your friends. Your task is to find the number of ways to arrange the seats. Two ways are considered different if sets of places that students occupy differs." 1300

919B "Perfect Number" "binary search,brute force,dp,implementation,number theory" "We consider a positive integer perfect, if and only if the sum of its digits is exactly 10. Given a positive integer k, your task is to find the k-th smallest perfect positive integer." 1100

919A Supermarket "brute force,greedy,implementation" "We often go to supermarkets to buy some fruits or vegetables, and on the tag there prints the price for a kilo. But in some supermarkets, when asked how much the items are, the clerk will say that a yuan for b kilos (You don\'t need to care about what ""yuan"" is), the same as a/b yuan for a kilo.Now imagine you\'d like to buy m kilos of apples. You\'ve asked n supermarkets and got the prices. Find the minimum cost for those apples.You can assume that there are enough apples in all supermarkets." 800

918B "Radio Station" implementation,strings "As the guys fried the radio station facilities, the school principal gave them tasks as a punishment. Dustin\'s task was to add comments to nginx configuration for school\'s website. The school has n servers. Each server has a name and an ip (names aren\'t necessarily unique, but ips are). Dustin knows the ip and name of each server. For simplicity, we\'ll assume that an nginx command is of form ""command ip;"" where command is a string consisting of English lowercase letter only, and ip is the ip of one of school servers.  Each ip is of form ""a.b.c.d"" where a, b, c and d are non-negative integers less than or equal to 255 (with no leading zeros). The nginx configuration file Dustin has to add comments to has m commands. Nobody ever memorizes the ips of servers, so to understand the configuration better, Dustin has to comment the name of server that the ip belongs to at the end of each line (after each command). More formally, if a line is ""command ip;"" Dustin has to replace it with ""command ip; #name"" where name is the name of the server with ip equal to ip.Dustin doesn\'t know anything about nginx, so he panicked again and his friends asked you to do his task for him." 900

918A Eleven "brute force,implementation" "Eleven wants to choose a new name for herself. As a bunch of geeks, her friends suggested an algorithm to choose a name for her. Eleven wants her name to have exactly n characters.   Her friend suggested that her name should only consist of uppercase and lowercase letters \'O\'. More precisely, they suggested that the i-th letter of her name should be \'O\' (uppercase) if i is a member of Fibonacci sequence, and \'o\' (lowercase) otherwise. The letters in the name are numbered from 1 to n. Fibonacci sequence is the sequence f where  f1\xe2\x80\x89=\xe2\x80\x891,  f2\xe2\x80\x89=\xe2\x80\x891,  fn\xe2\x80\x89=\xe2\x80\x89fn\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89fn\xe2\x80\x89-\xe2\x80\x891 (n\xe2\x80\x89>\xe2\x80\x892). As her friends are too young to know what Fibonacci sequence is, they asked you to help Eleven determine her new name." 800

917E "Upside Down" "data structures,string suffix structures,strings,trees" "As we all know, Eleven has special abilities. Thus, Hopper convinced her to close the gate to the Upside Down World with her mind. Upside down monsters like to move between the worlds, so they are going to attack Hopper and Eleven in order to make them stop. The monsters live in the vines. The vines form a tree with n vertices, numbered from 1 through n. There\'s a lowercase English letter written in each tunnel (edge).  Upside down is a magical world. There are m types of monsters in upside down, numbered from 1 through m. Each type of monster has a special word that gives them powers. The special word of type i is si. There are q monsters in upside down. Each one is at a junction (vertex) and is going to some other junction. If monster of type k goes from junction i to junction j, the power it gains is the number of times it sees its special world (sk) consecutively in the tunnels. More formally: If f(i,\xe2\x80\x89j) is the string we get when we concatenate the letters written in the tunnels on the shortest path from i to j, then the power the monster gains is the number of occurrences of sk in f(i,\xe2\x80\x89j).Hopper and Eleven want to get prepared, so for each monster, they want to know the power the monster gains after moving." 3400

917D "Stranger Trees" dp,math,matrices,trees "Will shares a psychic connection with the Upside Down Monster, so everything the monster knows, Will knows. Suddenly, he started drawing, page after page, non-stop. Joyce, his mom, and Chief Hopper put the drawings together, and they realized, it\'s a labeled tree!  A tree is a connected acyclic graph. Will\'s tree has n vertices. Joyce and Hopper don\'t know what that means, so they\'re investigating this tree and similar trees. For each k such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, they\'re going to investigate all labeled trees with n vertices that share exactly k edges with Will\'s tree. Two labeled trees are different if and only if there\'s a pair of vertices (v,\xe2\x80\x89u) such that there\'s an edge between v and u in one tree and not in the other one.Hopper and Joyce want to know how much work they have to do, so they asked you to tell them the number of labeled trees with n vertices that share exactly k edges with Will\'s tree, for each k. The answer could be very large, so they only asked you to tell them the answers modulo 1000000007\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897." 2600

917C Pollywog combinatorics,dp,matrices "As we all know, Dart is some kind of creature from Upside Down world. For simplicity, we call their kind pollywogs. Dart and x\xe2\x80\x89-\xe2\x80\x891 other pollywogs are playing a game. There are n stones in a row, numbered from 1 through n from left to right. At most 1 pollywog may be sitting on each stone at a time. Initially, the pollywogs are sitting on the first x stones (one pollywog on each stone).  Dart and his friends want to end up on the last x stones. At each second, the leftmost pollywog should jump to the right. A pollywog can jump at most k stones; more specifically, a pollywog can jump from stone number i to stones i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89... i\xe2\x80\x89+\xe2\x80\x89k. A pollywog can\'t jump on an occupied stone. Jumping a distance i takes ci amounts of energy from the pollywog. Also, q stones are special Each time landing on a special stone p, takes wp amounts of energy (in addition to the energy for jump) from the pollywog. wp could be negative, in this case, it means the pollywog absorbs |wp| amounts of energy.Pollywogs want to spend as little energy as possible (this value could be negative). They\'re just pollywogs, so they asked for your help. Tell them the total change in their energy, in case they move optimally." 2900

917B MADMAX "dfs and similar,dp,games,graphs" "As we all know, Max is the best video game player among her friends. Her friends were so jealous of hers, that they created an actual game just to prove that she\'s not the best at games. The game is played on a directed acyclic graph (a DAG) with n vertices and m edges. There\'s a character written on each edge, a lowercase English letter.  Max and Lucas are playing the game. Max goes first, then Lucas, then Max again and so on. Each player has a marble, initially located at some vertex. Each player in his/her turn should move his/her marble along some edge (a player can move the marble from vertex v to vertex u if there\'s an outgoing edge from v to u). If the player moves his/her marble from vertex v to vertex u, the ""character"" of that round is the character written on the edge from v to u. There\'s one additional rule; the ASCII code of character of round i should be greater than or equal to the ASCII code of character of round i\xe2\x80\x89-\xe2\x80\x891 (for i\xe2\x80\x89>\xe2\x80\x891). The rounds are numbered for both players together, i.�e. Max goes in odd numbers, Lucas goes in even numbers. The player that can\'t make a move loses the game. The marbles may be at the same vertex at the same time.Since the game could take a while and Lucas and Max have to focus on finding Dart, they don\'t have time to play. So they asked you, if they both play optimally, who wins the game?You have to determine the winner of the game for all initial positions of the marbles." 1700

917A "The Monster" dp,greedy,implementation,math "As Will is stuck in the Upside Down, he can still communicate with his mom, Joyce, through the Christmas lights (he can turn them on and off with his mind). He can\'t directly tell his mom where he is, because the monster that took him to the Upside Down will know and relocate him.   Thus, he came up with a puzzle to tell his mom his coordinates. His coordinates are the answer to the following problem.A string consisting only of parentheses (\'(\' and \')\') is called a bracket sequence. Some bracket sequence are called correct bracket sequences. More formally:  Empty string is a correct bracket sequence.  if s is a correct bracket sequence, then (s) is also a correct bracket sequence.  if s and t are correct bracket sequences, then st (concatenation of s and t) is also a correct bracket sequence. A string consisting of parentheses and question marks (\'?\') is called pretty if and only if there\'s a way to replace each question mark with either \'(\' or \')\' such that the resulting string is a non-empty correct bracket sequence.Will gave his mom a string s consisting of parentheses and question marks (using Morse code through the lights) and his coordinates are the number of pairs of integers (l,\xe2\x80\x89r) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s| and the string slsl\xe2\x80\x89+\xe2\x80\x891... sr is pretty, where si is i-th character of s.Joyce doesn\'t know anything about bracket sequences, so she asked for your help." 1800

916E "Jamie and Tree" "data structures,trees" "To your surprise, Jamie is the final boss! Ehehehe.Jamie has given you a tree with n vertices, numbered from 1 to n. Initially, the root of the tree is the vertex with number 1. Also, each vertex has a value on it.Jamie also gives you three types of queries on the tree:1 v�\xe2\x80\x94 Change the tree\'s root to vertex with number v.2 u v x�\xe2\x80\x94 For each vertex in the subtree of smallest size that contains u and v, add x to its value.3 v�\xe2\x80\x94 Find sum of values of vertices in the subtree of vertex with number v.A subtree of vertex v is a set of vertices such that v lies on shortest path from this vertex to root of the tree. Pay attention that subtree of a vertex can change after changing the tree\'s root.Show your strength in programming to Jamie by performing the queries accurately!" 2400

916D "Jamie and To-do List" "data structures,interactive,trees" "Why I have to finish so many assignments???Jamie is getting very busy with his school life. He starts to forget the assignments that he has to do. He decided to write the things down on a to-do list. He assigns a value priority for each of his assignment (lower value means more important) so he can decide which he needs to spend more time on.After a few days, Jamie finds out the list is too large that he can\'t even manage the list by himself! As you are a good friend of Jamie, help him write a program to support the following operations on the to-do list:  set ai xi�\xe2\x80\x94 Add assignment ai to the to-do list if it is not present, and set its priority to xi. If assignment ai is already in the to-do list, its priority is changed to xi.  remove ai�\xe2\x80\x94 Remove assignment ai from the to-do list if it is present in it.  query ai�\xe2\x80\x94 Output the number of assignments that are more important (have a smaller priority value) than assignment ai, so Jamie can decide a better schedule. Output \xe2\x80\x89-\xe2\x80\x891 if ai is not in the to-do list.  undo di�\xe2\x80\x94 Undo all changes that have been made in the previous di days (not including the day of this operation) At day 0, the to-do list is empty. In each of the following q days, Jamie will do exactly one out of the four operations. If the operation is a query, you should output the result of the query before proceeding to the next day, or poor Jamie cannot make appropriate decisions." 2200

916C "Jamie and Interesting Graph" "constructive algorithms,graphs,shortest paths" "Jamie has recently found undirected weighted graphs with the following properties very interesting:  The graph is connected and contains exactly n vertices and m edges.  All edge weights are integers and are in range [1,\xe2\x80\x89109] inclusive.  The length of shortest path from 1 to n is a prime number.  The sum of edges\' weights in the minimum spanning tree (MST) of the graph is a prime number.  The graph contains no loops or multi-edges. If you are not familiar with some terms from the statement you can find definitions of them in notes section. Help Jamie construct any graph with given number of vertices and edges that is interesting!" 1600

916B "Jamie and Binary Sequence (changed after round)" bitmasks,greedy,math "Jamie is preparing a Codeforces round. He has got an idea for a problem, but does not know how to solve it. Help him write a solution to the following problem:Find k integers such that the sum of two to the power of each number equals to the number n and the largest integer in the answer is as small as possible. As there may be multiple answers, you are asked to output the lexicographically largest one. To be more clear, consider all integer sequence with length k (a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak) with . Give a value  to each sequence. Among all sequence(s) that have the minimum y value, output the one that is the lexicographically largest.For definitions of powers and lexicographical order see notes." 2000

916A "Jamie and Alarm Snooze" "brute force,implementation,math" "Jamie loves sleeping. One day, he decides that he needs to wake up at exactly hh:\xe2\x80\x89mm. However, he hates waking up, so he wants to make waking up less painful by setting the alarm at a lucky time. He will then press the snooze button every x minutes until hh:\xe2\x80\x89mm is reached, and only then he will wake up. He wants to know what is the smallest number of times he needs to press the snooze button.A time is considered lucky if it contains a digit \'7\'. For example, 13:\xe2\x80\x8907 and 17:\xe2\x80\x8927 are lucky, while 00:\xe2\x80\x8948 and 21:\xe2\x80\x8934 are not lucky.Note that it is not necessary that the time set for the alarm and the wake-up time are on the same day. It is guaranteed that there is a lucky time Jamie can set so that he can wake at hh:\xe2\x80\x89mm.Formally, find the smallest possible non-negative integer y such that the time representation of the time x\xc2\xb7y minutes before hh:\xe2\x80\x89mm contains the digit \'7\'.Jamie uses 24-hours clock, so after 23:\xe2\x80\x8959 comes 00:\xe2\x80\x8900." 900

915G "Coprime Arrays" "math,number theory" "Let\'s call an array a of size n coprime iff gcd(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an)\xe2\x80\x89=\xe2\x80\x891, where gcd is the greatest common divisor of the arguments.You are given two numbers n and k. For each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) you have to determine the number of coprime arrays a of size n such that for every j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i. Since the answers can be very large, you have to calculate them modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300

915F "Imbalance Value of a Tree" "data structures,dsu,graphs,trees" "You are given a tree T consisting of n vertices. A number is written on each vertex; the number written on vertex i is ai. Let\'s denote the function I(x,\xe2\x80\x89y) as the difference between maximum and minimum value of ai on a simple path connecting vertices x and y.Your task is to calculate ." 2400

915E "Physical Education Lessons" "data structures,implementation,sortings" "This year Alex has finished school, and now he is a first-year student of Berland State University. For him it was a total surprise that even though he studies programming, he still has to attend physical education lessons. The end of the term is very soon, but, unfortunately, Alex still hasn\'t attended a single lesson!Since Alex doesn\'t want to get expelled, he wants to know the number of working days left until the end of the term, so he can attend physical education lessons during these days. But in BSU calculating the number of working days is a complicated matter:There are n days left before the end of the term (numbered from 1 to n), and initially all of them are working days. Then the university staff sequentially publishes q orders, one after another. Each order is characterised by three numbers l, r and k:  If k\xe2\x80\x89=\xe2\x80\x891, then all days from l to r (inclusive) become non-working days. If some of these days are made working days by some previous order, then these days still become non-working days;  If k\xe2\x80\x89=\xe2\x80\x892, then all days from l to r (inclusive) become working days. If some of these days are made non-working days by some previous order, then these days still become working days. Help Alex to determine the number of working days left after each order!" 2300

915D "Almost Acyclic Graph" "dfs and similar,graphs" "You are given a directed graph consisting of n vertices and m edges (each edge is directed, so it can be traversed in only one direction). You are allowed to remove at most one edge from it.Can you make this graph acyclic by removing at most one edge from it? A directed graph is called acyclic iff it doesn\'t contain any cycle (a non-empty path that starts and ends in the same vertex)." 2200

915C "Permute Digits" dp,greedy "You are given two positive integer numbers a and b. Permute (change order) of the digits of a to construct maximal number not exceeding b. No number in input and/or output can start with the digit 0.It is allowed to leave a as it is." 1700

915B Browser implementation "Luba is surfing the Internet. She currently has n opened tabs in her browser, indexed from 1 to n from left to right. The mouse cursor is currently located at the pos-th tab. Luba needs to use the tabs with indices from l to r (inclusive) for her studies, and she wants to close all the tabs that don\'t belong to this segment as fast as possible.Each second Luba can either try moving the cursor to the left or to the right (if the cursor is currently at the tab i, then she can move it to the tab max(i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89a) or to the tab min(i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89b)) or try closing all the tabs to the left or to the right of the cursor (if the cursor is currently at the tab i, she can close all the tabs with indices from segment [a,\xe2\x80\x89i\xe2\x80\x89-\xe2\x80\x891] or from segment [i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89b]). In the aforementioned expressions a and b denote the minimum and maximum index of an unclosed tab, respectively. For example, if there were 7 tabs initially and tabs 1, 2 and 7 are closed, then a\xe2\x80\x89=\xe2\x80\x893, b\xe2\x80\x89=\xe2\x80\x896.What is the minimum number of seconds Luba has to spend in order to leave only the tabs with initial indices from l to r inclusive opened?" 1300

915A Garden implementation "Luba thinks about watering her garden. The garden can be represented as a segment of length k. Luba has got n buckets, the i-th bucket allows her to water some continuous subsegment of garden of length exactly ai each hour. Luba can\'t water any parts of the garden that were already watered, also she can\'t water the ground outside the garden.Luba has to choose one of the buckets in order to water the garden as fast as possible (as mentioned above, each hour she will water some continuous subsegment of length ai if she chooses the i-th bucket). Help her to determine the minimum number of hours she has to spend watering the garden. It is guaranteed that Luba can always choose a bucket so it is possible water the garden.See the examples for better understanding." 900

914H "Ember and Storm\'s Tree Game" combinatorics,dp,games,trees "Luba thinks about watering her garden. The garden can be represented as a segment of length k. Luba has got n buckets, the i-th bucket allows her to water some continuous subsegment of garden of length exactly ai each hour. Luba can\'t water any parts of the garden that were already watered, also she can\'t water the ground outside the garden.Luba has to choose one of the buckets in order to water the garden as fast as possible (as mentioned above, each hour she will water some continuous subsegment of length ai if she chooses the i-th bucket). Help her to determine the minimum number of hours she has to spend watering the garden. It is guaranteed that Luba can always choose a bucket so it is possible water the garden.See the examples for better understanding." 3400

914G "Sum the Fibonacci" "bitmasks,divide and conquer,dp,fft,math" "You are given an array s of n non-negative integers.A 5-tuple of integers (a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d,\xe2\x80\x89e) is said to be valid if it satisfies the following conditions:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d,\xe2\x80\x89e\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n  (sa | sb) & sc & (sd ^ se)\xe2\x80\x89=\xe2\x80\x892i for some integer i  sa & sb\xe2\x80\x89=\xe2\x80\x890 Here, \'|\' is the bitwise OR, \'&\' is the bitwise AND and \'^\' is the bitwise XOR operation.Find the sum of f(sa|sb)\xe2\x80\x89*\xe2\x80\x89f(sc)\xe2\x80\x89*\xe2\x80\x89f(sd^se) over all valid 5-tuples (a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d,\xe2\x80\x89e), where f(i) is the i-th Fibonnaci number (f(0)\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x89f(1)\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89f(i)\xe2\x80\x89=\xe2\x80\x89f(i\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89f(i\xe2\x80\x89-\xe2\x80\x892)).Since answer can be is huge output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2600

914F "Substrings in a String" "bitmasks,brute force,data structures,string suffix structures,strings" "Given a string s, process q queries, each having one of the following forms:  1\xe2\x80\x89i\xe2\x80\x89c \xe2\x80\x94 Change the i-th character in the string to c.  2\xe2\x80\x89l\xe2\x80\x89r\xe2\x80\x89y \xe2\x80\x94 Consider the substring of s starting at position l and ending at position r. Output the number of times y occurs as a substring in it." 3000

914E "Palindromes in a Tree" "bitmasks,data structures,divide and conquer,trees" "You are given a tree (a connected acyclic undirected graph) of n vertices. Vertices are numbered from 1 to n and each vertex is assigned a character from a to t.A path in the tree is said to be palindromic if at least one permutation of the labels in the path is a palindrome.For each vertex, output the number of palindromic paths passing through it. Note: The path from vertex u to vertex v is considered to be the same as the path from vertex v to vertex u, and this path will be counted only once for each of the vertices it passes through." 2400

914D "Bash and a Tough Math Puzzle" "data structures,number theory" "Bash likes playing with arrays. He has an array a1,\xe2\x80\x89a2,\xe2\x80\x89... an of n integers. He likes to guess the greatest common divisor (gcd) of different segments of the array. Of course, sometimes the guess is not correct. However, Bash will be satisfied if his guess is almost correct.Suppose he guesses that the gcd of the elements in the range [l,\xe2\x80\x89r] of a is x. He considers the guess to be almost correct if he can change at most one element in the segment such that the gcd of the segment is x after making the change. Note that when he guesses, he doesn\'t actually change the array \xe2\x80\x94 he just wonders if the gcd of the segment can be made x. Apart from this, he also sometimes makes changes to the array itself.Since he can\'t figure it out himself, Bash wants you to tell him which of his guesses are almost correct. Formally, you have to process q queries of one of the following forms:  1\xe2\x80\x89l\xe2\x80\x89r\xe2\x80\x89x \xe2\x80\x94 Bash guesses that the gcd of the range [l,\xe2\x80\x89r] is x. Report if this guess is almost correct.  2\xe2\x80\x89i\xe2\x80\x89y \xe2\x80\x94 Bash sets ai to y. Note: The array is 1-indexed." 1900

914C "Travelling Salesman and Special Numbers" "brute force,combinatorics,dp" "The Travelling Salesman spends a lot of time travelling so he tends to get bored. To pass time, he likes to perform operations on numbers. One such operation is to take a positive integer x and reduce it to the number of bits set to 1 in the binary representation of x. For example for number 13 it\'s true that 1310\xe2\x80\x89=\xe2\x80\x8911012, so it has 3 bits set and 13 will be reduced to 3 in one operation.He calls a number special if the minimum number of operations to reduce it to 1 is k.He wants to find out how many special numbers exist which are not greater than n. Please help the Travelling Salesman, as he is about to reach his destination!Since the answer can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 1800

914B "Conan and Agasa play a Card Game" games,greedy,implementation "Edogawa Conan got tired of solving cases, and invited his friend, Professor Agasa, over. They decided to play a game of cards. Conan has n cards, and the i-th card has a number ai written on it.They take turns playing, starting with Conan. In each turn, the player chooses a card and removes it. Also, he removes all cards having a number strictly lesser than the number on the chosen card. Formally, if the player chooses the i-th card, he removes that card and removes the j-th card for all j such that aj\xe2\x80\x89<\xe2\x80\x89ai.A player loses if he cannot make a move on his turn, that is, he loses if there are no cards left. Predict the outcome of the game, assuming both players play optimally." 1200

914A "Perfect Squares" "brute force,implementation,math" "Given an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n integers, find the largest number in the array that is not a perfect square.A number x is said to be a perfect square if there exists an integer y such that x\xe2\x80\x89=\xe2\x80\x89y2." 900

913H "Don\'t Exceed" math,probabilities "Given an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n integers, find the largest number in the array that is not a perfect square.A number x is said to be a perfect square if there exists an integer y such that x\xe2\x80\x89=\xe2\x80\x89y2." 3400

913G "Power Substring" "math,number theory" "You are given n positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.For every ai you need to find a positive integer ki such that the decimal notation of 2ki contains the decimal notation of ai as a substring among its last min(100,\xe2\x80\x89length(2ki)) digits. Here length(m) is the length of the decimal notation of m.Note that you don\'t have to minimize ki. The decimal notations in this problem do not contain leading zeros." 3200

913F "Strongly Connected Tournament" dp,graphs,math,probabilities "There is a chess tournament in All-Right-City. n players were invited to take part in the competition. The tournament is held by the following rules:  Initially, each player plays one game with every other player. There are no ties;  After that, the organizers build a complete directed graph with players as vertices. For every pair of players there is exactly one directed edge between them: the winner of their game is the startpoint of this edge and the loser is the endpoint;  After that, the organizers build a condensation of this graph. The condensation of this graph is an acyclic complete graph, therefore it has the only Hamiltonian path which consists of strongly connected components of initial graph A1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89A2\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89Ak.  The players from the first component A1 are placed on the first  places, the players from the component A2 are placed on the next  places, and so on.  To determine exact place of each player in a strongly connected component, all the procedures from 1 to 5 are repeated recursively inside each component, i.e. for every i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89k players from the component Ai play games with each other again, and so on;  If a component consists of a single player, then he has no more rivals, his place is already determined and the process stops. The players are enumerated with integers from 1 to n. The enumeration was made using results of a previous tournament. It is known that player i wins player j (i\xe2\x80\x89<\xe2\x80\x89j) with probability p.You need to help to organize the tournament. Find the expected value of total number of games played by all the players. It can be shown that the answer can be represented as , where P and Q are coprime integers and . Print the value of P\xc2\xb7Q\xe2\x80\x89-\xe2\x80\x891 modulo 998244353.If you are not familiar with any of the terms above, you can read about them here." 2800

913E "Logical Expression" "bitmasks,dp,shortest paths" "You are given a boolean function of three variables which is defined by its truth table. You need to find an expression of minimum length that equals to this function. The expression may consist of:   Operation AND (\'&\', ASCII code 38)  Operation OR (\'|\', ASCII code 124)  Operation NOT (\'!\', ASCII code 33)  Variables x, y and z (ASCII codes 120-122)  Parentheses (\'(\', ASCII code 40, and \')\', ASCII code 41) If more than one expression of minimum length exists, you should find the lexicographically smallest one.Operations have standard priority. NOT has the highest priority, then AND goes, and OR has the lowest priority. The expression should satisfy the following grammar:E ::= E \'|\' T | TT ::= T \'&\' F | FF ::= \'!\' F | \'(\' E \')\' | \'x\' | \'y\' | \'z\'" 2400

913D "Too Easy Problems" "binary search,brute force,data structures,greedy,sortings" "You are preparing for an exam on scheduling theory. The exam will last for exactly T milliseconds and will consist of n problems. You can either solve problem i in exactly ti milliseconds or ignore it and spend no time. You don\'t need time to rest after solving a problem, either.Unfortunately, your teacher considers some of the problems too easy for you. Thus, he assigned an integer ai to every problem i meaning that the problem i can bring you a point to the final score only in case you have solved no more than ai problems overall (including problem i).Formally, suppose you solve problems p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk during the exam. Then, your final score s will be equal to the number of values of j between 1 and k such that k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89apj.You have guessed that the real first problem of the exam is already in front of you. Therefore, you want to choose a set of problems to solve during the exam maximizing your final score in advance. Don\'t forget that the exam is limited in time, and you must have enough time to solve all chosen problems. If there exist different sets of problems leading to the maximum final score, any of them will do." 1800

913C "Party Lemonade" bitmasks,dp,greedy "A New Year party is not a New Year party without lemonade! As usual, you are expecting a lot of guests, and buying lemonade has already become a pleasant necessity.Your favorite store sells lemonade in bottles of n different volumes at different costs. A single bottle of type i has volume 2i\xe2\x80\x89-\xe2\x80\x891 liters and costs ci roubles. The number of bottles of each type in the store can be considered infinite.You want to buy at least L liters of lemonade. How many roubles do you have to spend?" 1600

913B "Christmas Spruce" implementation,trees "Consider a rooted tree. A rooted tree has one special vertex called the root. All edges are directed from the root. Vertex u is called a child of vertex v and vertex v is called a parent of vertex u if there exists a directed edge from v to u. A vertex is called a leaf if it doesn\'t have children and has a parent.Let\'s call a rooted tree a spruce if its every non-leaf vertex has at least 3 leaf children. You are given a rooted tree, check whether it\'s a spruce.The definition of a rooted tree can be found here." 1200

913A "Modular Exponentiation" implementation,math "The following problem is well-known: given integers n and m, calculate , where 2n\xe2\x80\x89=\xe2\x80\x892\xc2\xb72\xc2\xb7...\xc2\xb72 (n factors), and  denotes the remainder of division of x by y.You are asked to solve the ""reverse"" problem. Given integers n and m, calculate ." 900

912E "Prime Gift" "binary search,dfs and similar,math,meet-in-the-middle,number theory,two pointers" "Opposite to Grisha\'s nice behavior, Oleg, though he has an entire year at his disposal, didn\'t manage to learn how to solve number theory problems in the past year. That\'s why instead of Ded Moroz he was visited by his teammate Andrew, who solemnly presented him with a set of n distinct prime numbers alongside with a simple task: Oleg is to find the k-th smallest integer, such that all its prime divisors are in this set." 2400

912D Fishes "data structures,graphs,greedy,probabilities,shortest paths" "While Grisha was celebrating New Year with Ded Moroz, Misha gifted Sasha a small rectangular pond of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, divided into cells of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891, inhabited by tiny evil fishes (no more than one fish per cell, otherwise they\'ll strife!).The gift bundle also includes a square scoop of size r\xe2\x80\x89\xc3\x97\xe2\x80\x89r, designed for fishing. If the lower-left corner of the scoop-net is located at cell (x,\xe2\x80\x89y), all fishes inside the square (x,\xe2\x80\x89y)...(x\xe2\x80\x89+\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x891) get caught. Note that the scoop-net should lie completely inside the pond when used.Unfortunately, Sasha is not that skilled in fishing and hence throws the scoop randomly. In order to not frustrate Sasha, Misha decided to release k fishes into the empty pond in such a way that the expected value of the number of caught fishes is as high as possible. Help Misha! In other words, put k fishes in the pond into distinct cells in such a way that when the scoop-net is placed into a random position among (n\xe2\x80\x89-\xe2\x80\x89r\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(m\xe2\x80\x89-\xe2\x80\x89r\xe2\x80\x89+\xe2\x80\x891) possible positions, the average number of caught fishes is as high as possible." 2100

912C "Perun, Ult!" "brute force,greedy,sortings" "A lot of students spend their winter holidays productively. Vlad has advanced very well in doing so! For three days already, fueled by salads and tangerines�\xe2\x80\x94 the leftovers from New Year celebration�\xe2\x80\x94 he has been calibrating his rating in his favorite MOBA game, playing as a hero named Perun.Perun has an ultimate ability called ""Thunderwrath"". At the instant of its activation, each enemy on the map (n of them in total) loses  health points as a single-time effect. It also has a restriction: it can only activated when the moment of time is an integer. The initial bounty for killing an enemy is . Additionally, it increases by  each second. Formally, if at some second t the ability is activated and the i-th enemy is killed as a result (i.e. his health drops to zero or lower), Vlad earns  units of gold.Every enemy can receive damage, as well as be healed. There are multiple ways of doing so, but Vlad is not interested in details. For each of n enemies he knows:   �\xe2\x80\x94 maximum number of health points for the i-th enemy;  �\xe2\x80\x94 initial health of the enemy (on the 0-th second);  �\xe2\x80\x94 the amount of health the i-th enemy can regenerate per second. There also m health updates Vlad knows about:   �\xe2\x80\x94 time when the health was updated;  �\xe2\x80\x94 the enemy whose health was updated;  �\xe2\x80\x94 updated health points for enemyj. Obviously, Vlad wants to maximize his profit. If it\'s necessary, he could even wait for years to activate his ability at the right second. Help him determine the exact second (note that it must be an integer) from 0 (inclusively) to \xe2\x80\x89+\xe2\x80\x89\xe2\x88\x9e so that a single activation of the ability would yield Vlad the maximum possible amount of gold, and print this amount." 2500

912B "New Year\'s Eve" "bitmasks,constructive algorithms,number theory" "A lot of students spend their winter holidays productively. Vlad has advanced very well in doing so! For three days already, fueled by salads and tangerines�\xe2\x80\x94 the leftovers from New Year celebration�\xe2\x80\x94 he has been calibrating his rating in his favorite MOBA game, playing as a hero named Perun.Perun has an ultimate ability called ""Thunderwrath"". At the instant of its activation, each enemy on the map (n of them in total) loses  health points as a single-time effect. It also has a restriction: it can only activated when the moment of time is an integer. The initial bounty for killing an enemy is . Additionally, it increases by  each second. Formally, if at some second t the ability is activated and the i-th enemy is killed as a result (i.e. his health drops to zero or lower), Vlad earns  units of gold.Every enemy can receive damage, as well as be healed. There are multiple ways of doing so, but Vlad is not interested in details. For each of n enemies he knows:   �\xe2\x80\x94 maximum number of health points for the i-th enemy;  �\xe2\x80\x94 initial health of the enemy (on the 0-th second);  �\xe2\x80\x94 the amount of health the i-th enemy can regenerate per second. There also m health updates Vlad knows about:   �\xe2\x80\x94 time when the health was updated;  �\xe2\x80\x94 the enemy whose health was updated;  �\xe2\x80\x94 updated health points for enemyj. Obviously, Vlad wants to maximize his profit. If it\'s necessary, he could even wait for years to activate his ability at the right second. Help him determine the exact second (note that it must be an integer) from 0 (inclusively) to \xe2\x80\x89+\xe2\x80\x89\xe2\x88\x9e so that a single activation of the ability would yield Vlad the maximum possible amount of gold, and print this amount." 1300

912A "Tricky Alchemy" implementation "During the winter holidays, the demand for Christmas balls is exceptionally high. Since it\'s already 2018, the advances in alchemy allow easy and efficient ball creation by utilizing magic crystals.Grisha needs to obtain some yellow, green and blue balls. It\'s known that to produce a yellow ball one needs two yellow crystals, green�\xe2\x80\x94 one yellow and one blue, and for a blue ball, three blue crystals are enough.Right now there are A yellow and B blue crystals in Grisha\'s disposal. Find out how many additional crystals he should acquire in order to produce the required number of balls." 800

911G "Mass Change Queries" "data structures" "You are given an array a consisting of n integers. You have to process q queries to this array; each query is given as four numbers l, r, x and y, denoting that for every i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and ai\xe2\x80\x89=\xe2\x80\x89x you have to set ai equal to y.Print the array after all queries are processed." 2500

911F "Tree Destruction" "constructive algorithms,dfs and similar,graphs,greedy,trees" "You are given an unweighted tree with n vertices. Then n\xe2\x80\x89-\xe2\x80\x891 following operations are applied to the tree. A single operation consists of the following steps:   choose two leaves;  add the length of the simple path between them to the answer;  remove one of the chosen leaves from the tree. Initial answer (before applying operations) is 0. Obviously after n\xe2\x80\x89-\xe2\x80\x891 such operations the tree will consist of a single vertex. Calculate the maximal possible answer you can achieve, and construct a sequence of operations that allows you to achieve this answer!" 2400

911E "Stack Sorting" "constructive algorithms,data structures,greedy,implementation" "Let\'s suppose you have an array a, a stack s (initially empty) and an array b (also initially empty).You may perform the following operations until both a and s are empty:  Take the first element of a, push it into s and remove it from a (if a is not empty);  Take the top element from s, append it to the end of array b and remove it from s (if s is not empty). You can perform these operations in arbitrary order.If there exists a way to perform the operations such that array b is sorted in non-descending order in the end, then array a is called stack-sortable.For example, [3,\xe2\x80\x891,\xe2\x80\x892] is stack-sortable, because b will be sorted if we perform the following operations:  Remove 3 from a and push it into s;  Remove 1 from a and push it into s;  Remove 1 from s and append it to the end of b;  Remove 2 from a and push it into s;  Remove 2 from s and append it to the end of b;  Remove 3 from s and append it to the end of b. After all these operations b\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x893], so [3,\xe2\x80\x891,\xe2\x80\x892] is stack-sortable. [2,\xe2\x80\x893,\xe2\x80\x891] is not stack-sortable.You are given k first elements of some permutation p of size n (recall that a permutation of size n is an array of size n where each integer from 1 to n occurs exactly once). You have to restore the remaining n\xe2\x80\x89-\xe2\x80\x89k elements of this permutation so it is stack-sortable. If there are multiple answers, choose the answer such that p is lexicographically maximal (an array q is lexicographically greater than an array p iff there exists some integer k such that for every i\xe2\x80\x89<\xe2\x80\x89k qi\xe2\x80\x89=\xe2\x80\x89pi, and qk\xe2\x80\x89>\xe2\x80\x89pk). You may not swap or change any of first k elements of the permutation.Print the lexicographically maximal permutation p you can obtain.If there exists no answer then output -1." 2000

911D "Inversion Counting" "brute force,math" "A permutation of size n is an array of size n such that each integer from 1 to n occurs exactly once in this array. An inversion in a permutation p is a pair of indices (i,\xe2\x80\x89j) such that i\xe2\x80\x89>\xe2\x80\x89j and ai\xe2\x80\x89<\xe2\x80\x89aj. For example, a permutation [4,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x892] contains 4 inversions: (2,\xe2\x80\x891), (3,\xe2\x80\x891), (4,\xe2\x80\x891), (4,\xe2\x80\x893).You are given a permutation a of size n and m queries to it. Each query is represented by two indices l and r denoting that you have to reverse the segment [l,\xe2\x80\x89r] of the permutation. For example, if a\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894] and a query l\xe2\x80\x89=\xe2\x80\x892, r\xe2\x80\x89=\xe2\x80\x894 is applied, then the resulting permutation is [1,\xe2\x80\x894,\xe2\x80\x893,\xe2\x80\x892].After each query you have to determine whether the number of inversions is odd or even." 1800

911C "Three Garlands" "brute force,constructive algorithms" "Mishka is decorating the Christmas tree. He has got three garlands, and all of them will be put on the tree. After that Mishka will switch these garlands on.When a garland is switched on, it periodically changes its state \xe2\x80\x94 sometimes it is lit, sometimes not. Formally, if i-th garland is switched on during x-th second, then it is lit only during seconds x, x\xe2\x80\x89+\xe2\x80\x89ki, x\xe2\x80\x89+\xe2\x80\x892ki, x\xe2\x80\x89+\xe2\x80\x893ki and so on.Mishka wants to switch on the garlands in such a way that during each second after switching the garlands on there would be at least one lit garland. Formally, Mishka wants to choose three integers x1, x2 and x3 (not necessarily distinct) so that he will switch on the first garland during x1-th second, the second one \xe2\x80\x94 during x2-th second, and the third one \xe2\x80\x94 during x3-th second, respectively, and during each second starting from max(x1,\xe2\x80\x89x2,\xe2\x80\x89x3) at least one garland will be lit.Help Mishka by telling him if it is possible to do this!" 1400

911B "Two Cakes" "binary search,brute force,implementation" "It\'s New Year\'s Eve soon, so Ivan decided it\'s high time he started setting the table. Ivan has bought two cakes and cut them into pieces: the first cake has been cut into a pieces, and the second one \xe2\x80\x94 into b pieces.Ivan knows that there will be n people at the celebration (including himself), so Ivan has set n plates for the cakes. Now he is thinking about how to distribute the cakes between the plates. Ivan wants to do it in such a way that all following conditions are met:  Each piece of each cake is put on some plate;  Each plate contains at least one piece of cake;  No plate contains pieces of both cakes. To make his guests happy, Ivan wants to distribute the cakes in such a way that the minimum number of pieces on the plate is maximized. Formally, Ivan wants to know the maximum possible number x such that he can distribute the cakes according to the aforementioned conditions, and each plate will contain at least x pieces of cake.Help Ivan to calculate this number x!" 1200

911A "Nearest Minimums" implementation "You are given an array of n integer numbers a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. Find the distance between two closest (nearest) minimums in it. It is guaranteed that in the array a minimum occurs at least two times." 1100

910C "Minimum Sum" "constructive algorithms,greedy,math" "Petya has n positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. His friend Vasya decided to joke and replaced all digits in Petya\'s numbers with a letters. He used the lowercase letters of the Latin alphabet from \'a\' to \'j\' and replaced all digits 0 with one letter, all digits 1 with another letter and so on. For any two different digits Vasya used distinct letters from \'a\' to \'j\'.Your task is to restore Petya\'s numbers. The restored numbers should be positive integers without leading zeros. Since there can be multiple ways to do it, determine the minimum possible sum of all Petya\'s numbers after the restoration. It is guaranteed that before Vasya\'s joke all Petya\'s numbers did not have leading zeros." 1700

910B "Door Frames" greedy,implementation "Petya has equal wooden bars of length n. He wants to make a frame for two equal doors. Each frame has two vertical (left and right) sides of length a and one top side of length b. A solid (i.e. continuous without breaks) piece of bar is needed for each side.Determine a minimal number of wooden bars which are needed to make the frames for two doors. Petya can cut the wooden bars into any parts, but each side of each door should be a solid piece of a wooden bar (or a whole wooden bar)." 1600

910A "The Way to Home" "dfs and similar,dp,greedy,implementation" "A frog lives on the axis Ox and needs to reach home which is in the point n. She starts from the point 1. The frog can jump to the right at a distance not more than d. So, after she jumped from the point x she can reach the point x\xe2\x80\x89+\xe2\x80\x89a, where a is an integer from 1 to d.For each point from 1 to n is known if there is a lily flower in it. The frog can jump only in points with a lilies. Guaranteed that there are lilies in the points 1 and n.Determine the minimal number of jumps that the frog needs to reach home which is in the point n from the point 1. Consider that initially the frog is in the point 1. If the frog can not reach home, print -1." 800

909F AND-permutations "constructive algorithms" "Given an integer N, find two permutations:  Permutation p of numbers from 1 to N such that pi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i and pi\xe2\x80\x89&\xe2\x80\x89i\xe2\x80\x89=\xe2\x80\x890 for all i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89N.  Permutation q of numbers from 1 to N such that qi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i and qi\xe2\x80\x89&\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890 for all i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89N. & is the bitwise AND operation." 2500

909E Coprocessor "dfs and similar,dp,graphs,greedy" "You are given a program you want to execute as a set of tasks organized in a dependency graph. The dependency graph is a directed acyclic graph: each task can depend on results of one or several other tasks, and there are no directed circular dependencies between tasks. A task can only be executed if all tasks it depends on have already completed.Some of the tasks in the graph can only be executed on a coprocessor, and the rest can only be executed on the main processor. In one coprocessor call you can send it a set of tasks which can only be executed on it. For each task of the set, all tasks on which it depends must be either already completed or be included in the set. The main processor starts the program execution and gets the results of tasks executed on the coprocessor automatically.Find the minimal number of coprocessor calls which are necessary to execute the given program." 1900

909D "Colorful Points" "data structures,greedy,implementation" "You are given a set of points on a straight line. Each point has a color assigned to it. For point a, its neighbors are the points which don\'t have any other points between them and a. Each point has at most two neighbors - one from the left and one from the right.You perform a sequence of operations on this set of points. In one operation, you delete all points which have a neighbor point of a different color than the point itself. Points are deleted simultaneously, i.e. first you decide which points have to be deleted and then delete them. After that you can perform the next operation etc. If an operation would not delete any points, you can\'t perform it.How many operations will you need to perform until the next operation does not have any points to delete?" 2100

909C "Python Indentation" dp "In Python, code blocks don\'t have explicit begin/end or curly braces to mark beginning and end of the block. Instead, code blocks are defined by indentation.We will consider an extremely simplified subset of Python with only two types of statements.Simple statements are written in a single line, one per line. An example of a simple statement is assignment.For statements are compound statements: they contain one or several other statements. For statement consists of a header written in a separate line which starts with ""for"" prefix, and loop body. Loop body is a block of statements indented one level further than the header of the loop. Loop body can contain both types of statements. Loop body can\'t be empty.You are given a sequence of statements without indentation. Find the number of ways in which the statements can be indented to form a valid Python program." 1800

909B Segments "constructive algorithms,math" "You are given an integer N. Consider all possible segments on the coordinate axis with endpoints at integer points with coordinates between 0 and N, inclusive; there will be  of them.You want to draw these segments in several layers so that in each layer the segments don\'t overlap (they might touch at the endpoints though). You can not move the segments to a different location on the coordinate axis. Find the minimal number of layers you have to use for the given N." 1300

909A "Generate Login" "brute force,greedy,sortings" "The preferred way to generate user login in Polygon is to concatenate a prefix of the user\'s first name and a prefix of their last name, in that order. Each prefix must be non-empty, and any of the prefixes can be the full name. Typically there are multiple possible logins for each person.You are given the first and the last name of a user. Return the alphabetically earliest login they can get (regardless of other potential Polygon users).As a reminder, a prefix of a string s is its substring which occurs at the beginning of s: ""a"", ""ab"", ""abc"" etc. are prefixes of string ""{abcdef}"" but ""b"" and \'bc"" are not. A string a is alphabetically earlier than a string b, if a is a prefix of b, or a and b coincide up to some position, and then a has a letter that is alphabetically earlier than the corresponding letter in b: ""a"" and ""ab"" are alphabetically earlier than ""ac"" but ""b"" and ""ba"" are alphabetically later than ""ac""." 1000

908H "New Year and Boolean Bridges" NA "Your friend has a hidden directed graph with n nodes.Let f(u,\xe2\x80\x89v) be true if there is a directed path from node u to node v, and false otherwise. For each pair of distinct nodes, u,\xe2\x80\x89v, you know at least one of the three statements is true:        Here AND, OR and XOR mean AND, OR and exclusive OR operations, respectively.You are given an n by n matrix saying which one of the three statements holds for each pair of vertices. The entry in the u-th row and v-th column has a single character.   If the first statement holds, this is represented by the character \'A\'.  If the second holds, this is represented by the character \'O\'.  If the third holds, this is represented by the character \'X\'.  The diagonal of this matrix will only contain the character \'-\'. Note that it is possible that a pair of nodes may satisfy multiple statements, in which case, the character given will represent one of the true statements for that pair. This matrix is also guaranteed to be symmetric.You would like to know if there is a directed graph that is consistent with this matrix. If it is impossible, print the integer -1. Otherwise, print the minimum number of edges that could be consistent with this information." 3100

908G "New Year and Original Order" dp,math "Let S(n) denote the number that represents the digits of n in sorted order. For example, S(1)\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89S(5)\xe2\x80\x89=\xe2\x80\x895,\xe2\x80\x89S(50394)\xe2\x80\x89=\xe2\x80\x893459,\xe2\x80\x89S(353535)\xe2\x80\x89=\xe2\x80\x89333555.Given a number X, compute  modulo 109\xe2\x80\x89+\xe2\x80\x897." 2800

908F "New Year and Rainbow Roads" graphs,greedy,implementation "Roy and Biv have a set of n points on the infinite number line.Each point has one of 3 colors: red, green, or blue.Roy and Biv would like to connect all the points with some edges. Edges can be drawn between any of the two of the given points. The cost of an edge is equal to the distance between the two points it connects.They want to do this in such a way that they will both see that all the points are connected (either directly or indirectly).However, there is a catch: Roy cannot see the color red and Biv cannot see the color blue.Therefore, they have to choose the edges in such a way that if all the red points are removed, the remaining blue and green points are connected (and similarly, if all the blue points are removed, the remaining red and green points are connected).Help them compute the minimum cost way to choose edges to satisfy the above constraints." 2400

908E "New Year and Entity Enumeration" bitmasks,combinatorics,dp,math "You are given an integer m.Let M\xe2\x80\x89=\xe2\x80\x892m\xe2\x80\x89-\xe2\x80\x891.You are also given a set of n integers denoted as the set T. The integers will be provided in base 2 as n binary strings of length m.A set of integers S is called ""good"" if the following hold.   If , then .  If , then     All elements of S are less than or equal to M. Here,  and  refer to the bitwise XOR and bitwise AND operators, respectively.Count the number of good sets S, modulo 109\xe2\x80\x89+\xe2\x80\x897." 2500

908D "New Year and Arbitrary Arrangement" dp,math,probabilities "You are given three integers k, pa and pb.You will construct a sequence with the following algorithm: Initially, start with the empty sequence. Each second, you do the following. With probability pa\xe2\x80\x89/\xe2\x80\x89(pa\xe2\x80\x89+\xe2\x80\x89pb), add \'a\' to the end of the sequence. Otherwise (with probability pb\xe2\x80\x89/\xe2\x80\x89(pa\xe2\x80\x89+\xe2\x80\x89pb)), add \'b\' to the end of the sequence.You stop once there are at least k subsequences that form \'ab\'. Determine the expected number of times \'ab\' is a subsequence in the resulting sequence. It can be shown that this can be represented by P\xe2\x80\x89/\xe2\x80\x89Q, where P and Q are coprime integers, and . Print the value of ." 2200

908C "New Year and Curling" "brute force,geometry,implementation,math" "Carol is currently curling.She has n disks each with radius r on the 2D plane. Initially she has all these disks above the line y\xe2\x80\x89=\xe2\x80\x8910100.She then will slide the disks towards the line y\xe2\x80\x89=\xe2\x80\x890 one by one in order from 1 to n. When she slides the i-th disk, she will place its center at the point (xi,\xe2\x80\x8910100). She will then push it so the disk\xe2\x80\x99s y coordinate continuously decreases, and x coordinate stays constant. The disk stops once it touches the line y\xe2\x80\x89=\xe2\x80\x890 or it touches any previous disk. Note that once a disk stops moving, it will not move again, even if hit by another disk. Compute the y-coordinates of centers of all the disks after all disks have been pushed." 1500

908B "New Year and Buggy Bot" "brute force,implementation" "Bob programmed a robot to navigate through a 2d maze.The maze has some obstacles. Empty cells are denoted by the character \'.\', where obstacles are denoted by \'#\'.There is a single robot in the maze. Its start position is denoted with the character \'S\'. This position has no obstacle in it. There is also a single exit in the maze. Its position is denoted with the character \'E\'. This position has no obstacle in it.The robot can only move up, left, right, or down.When Bob programmed the robot, he wrote down a string of digits consisting of the digits 0 to 3, inclusive. He intended for each digit to correspond to a distinct direction, and the robot would follow the directions in order to reach the exit. Unfortunately, he forgot to actually assign the directions to digits.The robot will choose some random mapping of digits to distinct directions. The robot will map distinct digits to distinct directions. The robot will then follow the instructions according to the given string in order and chosen mapping. If an instruction would lead the robot to go off the edge of the maze or hit an obstacle, the robot will crash and break down. If the robot reaches the exit at any point, then the robot will stop following any further instructions.Bob is having trouble debugging his robot, so he would like to determine the number of mappings of digits to directions that would lead the robot to the exit." 1200

908A "New Year and Counting Cards" "brute force,implementation" "Your friend has n cards.You know that each card has a lowercase English letter on one side and a digit on the other.Currently, your friend has laid out the cards on a table so only one side of each card is visible.You would like to know if the following statement is true for cards that your friend owns: ""If a card has a vowel on one side, then it has an even digit on the other side."" More specifically, a vowel is one of \'a\', \'e\', \'i\', \'o\' or \'u\', and even digit is one of \'0\', \'2\', \'4\', \'6\' or \'8\'.For example, if a card has \'a\' on one side, and \'6\' on the other side, then this statement is true for it. Also, the statement is true, for example, for a card with \'b\' and \'4\', and for a card with \'b\' and \'3\' (since the letter is not a vowel). The statement is false, for example, for card with \'e\' and \'5\'. You are interested if the statement is true for all cards. In particular, if no card has a vowel, the statement is true.To determine this, you can flip over some cards to reveal the other side. You would like to know what is the minimum number of cards you need to flip in the worst case in order to verify that the statement is true." 800

907B Tic-Tac-Toe implementation "Two bears are playing tic-tac-toe via mail. It\'s boring for them to play usual tic-tac-toe game, so they are a playing modified version of this game. Here are its rules.The game is played on the following field.  Players are making moves by turns. At first move a player can put his chip in any cell of any small field. For following moves, there are some restrictions: if during last move the opposite player put his chip to cell with coordinates (xl,\xe2\x80\x89yl) in some small field, the next move should be done in one of the cells of the small field with coordinates (xl,\xe2\x80\x89yl). For example, if in the first move a player puts his chip to lower left cell of central field, then the second player on his next move should put his chip into some cell of lower left field (pay attention to the first test case). If there are no free cells in the required field, the player can put his chip to any empty cell on any field.You are given current state of the game and coordinates of cell in which the last move was done. You should find all cells in which the current player can put his chip.A hare works as a postman in the forest, he likes to foul bears. Sometimes he changes the game field a bit, so the current state of the game could be unreachable. However, after his changes the cell where the last move was done is not empty. You don\'t need to find if the state is unreachable or not, just output possible next moves according to the rules." 1400

907A "Masha and Bears" "brute force,implementation" "A family consisting of father bear, mother bear and son bear owns three cars. Father bear can climb into the largest car and he likes it. Also, mother bear can climb into the middle car and she likes it. Moreover, son bear can climb into the smallest car and he likes it. It\'s known that the largest car is strictly larger than the middle car, and the middle car is strictly larger than the smallest car. Masha came to test these cars. She could climb into all cars, but she liked only the smallest car. It\'s known that a character with size a can climb into some car with size b if and only if a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b, he or she likes it if and only if he can climb into this car and 2a\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89b.You are given sizes of bears and Masha. Find out some possible integer non-negative sizes of cars." 1300

906E Reverses "dp,string suffix structures,strings" "Hurricane came to Berland and to suburbs Stringsvill. You are going to it to check if it\'s all right with you favorite string. Hurrinace broke it a bit by reversing some of its non-intersecting substrings. You have a photo of this string before hurricane and you want to restore it to original state using reversing minimum possible number of its substrings and find out which substrings you should reverse.You are given a string s�\xe2\x80\x94 original state of your string and string t�\xe2\x80\x94 state of the string after hurricane. You should select k non-intersecting substrings of t in such a way that after reverse of these substrings string will be equal s and k is minimum possible." 3300

906D "Power Tower" "chinese remainder theorem,math,number theory" "Priests of the Quetzalcoatl cult want to build a tower to represent a power of their god. Tower is usually made of power-charged rocks. It is built with the help of rare magic by levitating the current top of tower and adding rocks at its bottom. If top, which is built from k\xe2\x80\x89-\xe2\x80\x891 rocks, possesses power p and we want to add the rock charged with power wk then value of power of a new tower will be {wk}p. Rocks are added from the last to the first. That is for sequence w1,\xe2\x80\x89...,\xe2\x80\x89wm value of power will beAfter tower is built, its power may be extremely large. But still priests want to get some information about it, namely they want to know a number called cumulative power which is the true value of power taken modulo m. Priests have n rocks numbered from 1 to n. They ask you to calculate which value of cumulative power will the tower possess if they will build it from rocks numbered l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r." 2700

906C Party "bitmasks,brute force,dp,graphs" "Arseny likes to organize parties and invite people to it. However, not only friends come to his parties, but friends of his friends, friends of friends of his friends and so on. That\'s why some of Arseny\'s guests can be unknown to him. He decided to fix this issue using the following procedure.At each step he selects one of his guests A, who pairwise introduces all of his friends to each other. After this action any two friends of A become friends. This process is run until all pairs of guests are friends.Arseny doesn\'t want to spend much time doing it, so he wants to finish this process using the minimum number of steps. Help Arseny to do it." 2400

906B "Seating of Students" "brute force,constructive algorithms,math" "Students went into a class to write a test and sat in some way. The teacher thought: ""Probably they sat in this order to copy works of each other. I need to rearrange them in such a way that students that were neighbors are not neighbors in a new seating.""The class can be represented as a matrix with n rows and m columns with a student in each cell. Two students are neighbors if cells in which they sit have a common side.Let\'s enumerate students from 1 to n\xc2\xb7m in order of rows. So a student who initially sits in the cell in row i and column j has a number (i\xe2\x80\x89-\xe2\x80\x891)\xc2\xb7m\xe2\x80\x89+\xe2\x80\x89j. You have to find a matrix with n rows and m columns in which all numbers from 1 to n\xc2\xb7m appear exactly once and adjacent numbers in the original matrix are not adjacent in it, or determine that there is no such matrix." 2200

906A Shockers implementation,strings "Valentin participates in a show called ""Shockers"". The rules are quite easy: jury selects one letter which Valentin doesn\'t know. He should make a small speech, but every time he pronounces a word that contains the selected letter, he receives an electric shock. He can make guesses which letter is selected, but for each incorrect guess he receives an electric shock too. The show ends when Valentin guesses the selected letter correctly.Valentin can\'t keep in mind everything, so he could guess the selected letter much later than it can be uniquely determined and get excessive electric shocks. Excessive electric shocks are those which Valentin got after the moment the selected letter can be uniquely determined. You should find out the number of excessive electric shocks." 1600

903G "Yet Another Maxflow Problem" "data structures,flows,graphs" "In this problem you will have to deal with a very special network.The network consists of two parts: part A and part B. Each part consists of n vertices; i-th vertex of part A is denoted as Ai, and i-th vertex of part B is denoted as Bi.For each index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) there is a directed edge from vertex Ai to vertex Ai\xe2\x80\x89+\xe2\x80\x891, and from Bi to Bi\xe2\x80\x89+\xe2\x80\x891, respectively. Capacities of these edges are given in the input. Also there might be several directed edges going from part A to part B (but never from B to A).You have to calculate the maximum flow value from A1 to Bn in this network. Capacities of edges connecting Ai to Ai\xe2\x80\x89+\xe2\x80\x891 might sometimes change, and you also have to maintain the maximum flow value after these changes. Apart from that, the network is fixed (there are no changes in part B, no changes of edges going from A to B, and no edge insertions or deletions).Take a look at the example and the notes to understand the structure of the network better." 2700

903F "Clear The Matrix" bitmasks,dp "You are given a matrix f with 4 rows and n columns. Each element of the matrix is either an asterisk (*) or a dot (.).You may perform the following operation arbitrary number of times: choose a square submatrix of f with size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k (where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894) and replace each element of the chosen submatrix with a dot. Choosing a submatrix of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k costs ak coins.What is the minimum number of coins you have to pay to replace all asterisks with dots?" 2200

903E "Swapping Characters" "brute force,hashing,implementation,strings" "We had a string s consisting of n lowercase Latin letters. We made k copies of this string, thus obtaining k identical strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk. After that, in each of these strings we swapped exactly two characters (the characters we swapped could be identical, but they had different indices in the string).You are given k strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk, and you have to restore any string s so that it is possible to obtain these strings by performing aforementioned operations. Note that the total length of the strings you are given doesn\'t exceed 5000 (that is, k\xc2\xb7n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x895000)." 2200

903D "Almost Difference" "data structures,math" "Let\'s denote a function You are given an array a consisting of n integers. You have to calculate the sum of d(ai,\xe2\x80\x89aj) over all pairs (i,\xe2\x80\x89j) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 2200

903C "Boxes Packing" greedy "Mishka has got n empty boxes. For every i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), i-th box is a cube with side length ai.Mishka can put a box i into another box j if the following conditions are met:  i-th box is not put into another box;  j-th box doesn\'t contain any other boxes;  box i is smaller than box j (ai\xe2\x80\x89<\xe2\x80\x89aj). Mishka can put boxes into each other an arbitrary number of times. He wants to minimize the number of visible boxes. A box is called visible iff it is not put into some another box.Help Mishka to determine the minimum possible number of visible boxes!" 1200

903B "The Modcrab" greedy,implementation "Vova is again playing some computer game, now an RPG. In the game Vova\'s character received a quest: to slay the fearsome monster called Modcrab.After two hours of playing the game Vova has tracked the monster and analyzed its tactics. The Modcrab has h2 health points and an attack power of a2. Knowing that, Vova has decided to buy a lot of strong healing potions and to prepare for battle.Vova\'s character has h1 health points and an attack power of a1. Also he has a large supply of healing potions, each of which increases his current amount of health points by c1 when Vova drinks a potion. All potions are identical to each other. It is guaranteed that c1\xe2\x80\x89>\xe2\x80\x89a2.The battle consists of multiple phases. In the beginning of each phase, Vova can either attack the monster (thus reducing its health by a1) or drink a healing potion (it increases Vova\'s health by c1; Vova\'s health can exceed h1). Then, if the battle is not over yet, the Modcrab attacks Vova, reducing his health by a2. The battle ends when Vova\'s (or Modcrab\'s) health drops to 0 or lower. It is possible that the battle ends in a middle of a phase after Vova\'s attack.Of course, Vova wants to win the fight. But also he wants to do it as fast as possible. So he wants to make up a strategy that will allow him to win the fight after the minimum possible number of phases.Help Vova to make up a strategy! You may assume that Vova never runs out of healing potions, and that he can always win." 1200

903A "Hungry Student Problem" greedy,implementation "Ivan\'s classes at the university have just finished, and now he wants to go to the local CFK cafe and eat some fried chicken.CFK sells chicken chunks in small and large portions. A small portion contains 3 chunks; a large one \xe2\x80\x94 7 chunks. Ivan wants to eat exactly x chunks. Now he wonders whether he can buy exactly this amount of chicken.Formally, Ivan wants to know if he can choose two non-negative integers a and b in such a way that a small portions and b large ones contain exactly x chunks.Help Ivan to answer this question for several values of x!" 900

902B "Coloring a Tree" "dfs and similar,dsu,greedy" "You are given a rooted tree with n vertices. The vertices are numbered from 1 to n, the root is the vertex number 1.Each vertex has a color, let\'s denote the color of vertex v by cv. Initially cv\xe2\x80\x89=\xe2\x80\x890.You have to color the tree into the given colors using the smallest possible number of steps. On each step you can choose a vertex v and a color x, and then color all vectices in the subtree of v (including v itself) in color x. In other words, for every vertex u, such that the path from root to u passes through v, set cu\xe2\x80\x89=\xe2\x80\x89x.It is guaranteed that you have to color each vertex in a color different from 0.You can learn what a rooted tree is using the link: https://en.wikipedia.org/wiki/Tree_(graph_theory)." 1200

902A "Visiting a Friend" greedy,implementation "Pig is visiting a friend.Pig\'s house is located at point 0, and his friend\'s house is located at point m on an axis.Pig can use teleports to move along the axis.To use a teleport, Pig should come to a certain point (where the teleport is located) and choose where to move: for each teleport there is the rightmost point it can move Pig to, this point is known as the limit of the teleport.Formally, a teleport located at point x with limit y can move Pig from point x to any point within the segment [x;\xe2\x80\x89y], including the bounds.  Determine if Pig can visit the friend using teleports only, or he should use his car." 1100

901E "Cyclic Cipher" fft,math "Senor Vorpal Kickass\'o invented an innovative method to encrypt integer sequences of length n. To encrypt a sequence, one has to choose a secret sequence , that acts as a key.Vorpal is very selective, so the key should be such a sequence bi, that its cyclic shifts are linearly independent, that is, there is no non-zero set of coefficients x0,\xe2\x80\x89x1,\xe2\x80\x89...,\xe2\x80\x89xn\xe2\x80\x89-\xe2\x80\x891, such that  for all k at the same time.After that for a sequence  you should build the following cipher:In other words, you are to compute the quadratic deviation between each cyclic shift of bi and the sequence ai. The resulting sequence is the Kickass\'s cipher. The cipher is in development right now and Vorpal wants to decipher a sequence after it has been encrypted. You are to solve this problem for him. You are given sequences ci and bi. You are to find all suitable sequences ai." 3300

901D "Weighting a Tree" "constructive algorithms,dfs and similar,graphs" "You are given a connected undirected graph with n vertices and m edges. The vertices are enumerated from 1 to n. You are given n integers c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn, each of them is between \xe2\x80\x89-\xe2\x80\x89n and n, inclusive. It is also guaranteed that the parity of cv equals the parity of degree of vertex v. The degree of a vertex is the number of edges connected to it.You are to write a weight between \xe2\x80\x89-\xe2\x80\x892\xc2\xb7n2 and 2\xc2\xb7n2 (inclusive) on each edge in such a way, that for each vertex v the sum of weights on edges connected to this vertex is equal to cv, or determine that this is impossible." 2700

901C "Bipartite Segments" "binary search,data structures,dfs and similar,dsu,graphs,two pointers" "You are given an undirected graph with n vertices. There are no edge-simple cycles with the even length in it. In other words, there are no cycles of even length that pass each edge at most once. Let\'s enumerate vertices from 1 to n. You have to answer q queries. Each query is described by a segment of vertices [l;\xe2\x80\x89r], and you have to count the number of its subsegments [x;\xe2\x80\x89y] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), such that if we delete all vertices except the segment of vertices [x;\xe2\x80\x89y] (including x and y) and edges between them, the resulting graph is bipartite." 2300

901B "GCD of Polynomials" "constructive algorithms,math" "Suppose you have two polynomials  and . Then polynomial  can be uniquely represented in the following way:This can be done using long division. Here,  denotes the degree of polynomial P(x).  is called the remainder of division of polynomial  by polynomial , it is also denoted as . Since there is a way to divide polynomials with remainder, we can define Euclid\'s algorithm of finding the greatest common divisor of two polynomials. The algorithm takes two polynomials . If the polynomial  is zero, the result is , otherwise the result is the value the algorithm returns for pair . On each step the degree of the second argument decreases, so the algorithm works in finite number of steps. But how large that number could be? You are to answer this question. You are given an integer n. You have to build two polynomials with degrees not greater than n, such that their coefficients are integers not exceeding 1 by their absolute value, the leading coefficients (ones with the greatest power of x) are equal to one, and the described Euclid\'s algorithm performs exactly n steps finding their greatest common divisor. Moreover, the degree of the first polynomial should be greater than the degree of the second. By a step of the algorithm we mean the transition from pair  to pair ." 2200

901A "Hashing Trees" "constructive algorithms,trees" "Sasha is taking part in a programming competition. In one of the problems she should check if some rooted trees are isomorphic or not. She has never seen this problem before, but, being an experienced participant, she guessed that she should match trees to some sequences and then compare these sequences instead of trees. Sasha wants to match each tree with a sequence a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89ah, where h is the height of the tree, and ai equals to the number of vertices that are at distance of i edges from root. Unfortunately, this time Sasha\'s intuition was wrong, and there could be several trees matching the same sequence. To show it, you need to write a program that, given the sequence ai, builds two non-isomorphic rooted trees that match that sequence, or determines that there is only one such tree.Two rooted trees are isomorphic, if you can reenumerate the vertices of the first one in such a way, that the index of the root becomes equal the index of the root of the second tree, and these two trees become equal.The height of a rooted tree is the maximum number of edges on a path from the root to any other vertex." 1500

900E "Maximum Questions" "data structures,dp,strings" "Vasya wrote down two strings s of length n and t of length m consisting of small English letters \'a\' and \'b\'. What is more, he knows that string t has a form ""abab..."", namely there are letters \'a\' on odd positions and letters \'b\' on even positions.Suddenly in the morning, Vasya found that somebody spoiled his string. Some letters of the string s were replaced by character \'?\'.Let\'s call a sequence of positions i,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891 as occurrence of string t in s, if 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891 and t1\xe2\x80\x89=\xe2\x80\x89si,\xe2\x80\x89t2\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89tm\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891.The boy defines the beauty of the string s as maximum number of disjoint occurrences of string t in s. Vasya can replace some letters \'?\' with \'a\' or \'b\' (letters on different positions can be replaced with different letter). Vasya wants to make some replacements in such a way that beauty of string s is maximum possible. From all such options, he wants to choose one with the minimum number of replacements. Find the number of replacements he should make." 2100

900D "Unusual Sequences" "bitmasks,combinatorics,dp,math,number theory" "Count the number of distinct sequences a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai) consisting of positive integers such that gcd(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an)\xe2\x80\x89=\xe2\x80\x89x and . As this number could be large, print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.gcd here means the greatest common divisor." 2000

900C "Remove Extra One" "brute force,data structures,math" "You are given a permutation p of length n. Remove one element from permutation to make the number of records the maximum possible.We remind that in a sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak the element ai is a record if for every integer j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89i) the following holds: aj\xe2\x80\x89<\xe2\x80\x89ai." 1700

900B "Position in Fraction" "math,number theory" "You have a fraction . You need to find the first occurrence of digit c into decimal notation of the fraction after decimal point." 1300

900A "Find Extra One" geometry,implementation "You have n distinct points on a plane, none of them lie on OY axis. Check that there is a point after removal of which the remaining points are located on one side of the OY axis." 800

899F "Letters Removing" "data structures,strings" "Petya has a string of length n consisting of small and large English letters and digits.He performs m operations. Each operation is described with two integers l and r and a character c: Petya removes from the string all characters c on positions between l and r, inclusive. It\'s obvious that the length of the string remains the same or decreases after each operation.Find how the string will look like after Petya performs all m operations." 2100

899E "Segments Removal" "data structures,dsu,flows,implementation,two pointers" "Vasya has an array of integers of length n.Vasya performs the following operations on the array: on each step he finds the longest segment of consecutive equal integers (the leftmost, if there are several such segments) and removes it. For example, if Vasya\'s array is [13,\xe2\x80\x8913,\xe2\x80\x897,\xe2\x80\x897,\xe2\x80\x897,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x892], then after one operation it becomes [13,\xe2\x80\x8913,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x892].Compute the number of operations Vasya should make until the array becomes empty, i.e. Vasya removes all elements from it." 2000

899D "Shovel Sale" "constructive algorithms,math" "There are n shovels in Polycarp\'s shop. The i-th shovel costs i burles, that is, the first shovel costs 1 burle, the second shovel costs 2 burles, the third shovel costs 3 burles, and so on. Polycarps wants to sell shovels in pairs.Visitors are more likely to buy a pair of shovels if their total cost ends with several 9s. Because of this, Polycarp wants to choose a pair of shovels to sell in such a way that the sum of their costs ends with maximum possible number of nines. For example, if he chooses shovels with costs 12345 and 37454, their total cost is 49799, it ends with two nines.You are to compute the number of pairs of shovels such that their total cost ends with maximum possible number of nines. Two pairs are considered different if there is a shovel presented in one pair, but not in the other." 1800

899C "Dividing the numbers" "constructive algorithms,graphs,math" "Petya has n integers: 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n. He wants to split these integers in two non-empty groups in such a way that the absolute difference of sums of integers in each group is as small as possible. Help Petya to split the integers. Each of n integers should be exactly in one group." 1300

899B "Months and Years" implementation "Everybody in Russia uses Gregorian calendar. In this calendar there are 31 days in January, 28 or 29 days in February (depending on whether the year is leap or not), 31 days in March, 30 days in April, 31 days in May, 30 in June, 31 in July, 31 in August, 30 in September, 31 in October, 30 in November, 31 in December.A year is leap in one of two cases: either its number is divisible by 4, but not divisible by 100, or is divisible by 400. For example, the following years are leap: 2000, 2004, but years 1900 and 2018 are not leap.In this problem you are given n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8924) integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, and you have to check if these integers could be durations in days of n consecutive months, according to Gregorian calendar. Note that these months could belong to several consecutive years. In other words, check if there is a month in some year, such that its duration is a1 days, duration of the next month is a2 days, and so on." 1200

899A "Splitting in Teams" "constructive algorithms,greedy,math" "There were n groups of students which came to write a training contest. A group is either one person who can write the contest with anyone else, or two people who want to write the contest in the same team.The coach decided to form teams of exactly three people for this training. Determine the maximum number of teams of three people he can form. It is possible that he can\'t use all groups to form teams. For groups of two, either both students should write the contest, or both should not. If two students from a group of two will write the contest, they should be in the same team." 800

898F "Restoring the Expression" "brute force,hashing,math" "A correct expression of the form a+b=c was written; a, b and c are non-negative integers without leading zeros. In this expression, the plus and equally signs were lost. The task is to restore the expression. In other words, one character \'+\' and one character \'=\' should be inserted into given sequence of digits so that:   character\'+\' is placed on the left of character \'=\',  characters \'+\' and \'=\' split the sequence into three non-empty subsequences consisting of digits (let\'s call the left part a, the middle part�\xe2\x80\x94 b and the right part�\xe2\x80\x94 c),  all the three parts a, b and c do not contain leading zeros,  it is true that a+b=c. It is guaranteed that in given tests answer always exists." 2300

898E "Squares and not squares" "constructive algorithms,greedy" "Ann and Borya have n piles with candies and n is even number. There are ai candies in pile with number i.Ann likes numbers which are square of some integer and Borya doesn\'t like numbers which are square of any integer. During one move guys can select some pile with candies and add one candy to it (this candy is new and doesn\'t belong to any other pile) or remove one candy (if there is at least one candy in this pile). Find out minimal number of moves that is required to make exactly n\xe2\x80\x89/\xe2\x80\x892 piles contain number of candies that is a square of some integer and exactly n\xe2\x80\x89/\xe2\x80\x892 piles contain number of candies that is not a square of any integer." 1600

898D "Alarm Clock" greedy "Every evening Vitalya sets n alarm clocks to wake up tomorrow. Every alarm clock rings during exactly one minute and is characterized by one integer ai�\xe2\x80\x94 number of minute after midnight in which it rings. Every alarm clock begins ringing at the beginning of the minute and rings during whole minute. Vitalya will definitely wake up if during some m consecutive minutes at least k alarm clocks will begin ringing. Pay attention that Vitalya considers only alarm clocks which begin ringing during given period of time. He doesn\'t consider alarm clocks which started ringing before given period of time and continues ringing during given period of time.Vitalya is so tired that he wants to sleep all day long and not to wake up. Find out minimal number of alarm clocks Vitalya should turn off to sleep all next day. Now all alarm clocks are turned on." 1600

898C "Phone Numbers" implementation,strings "Vasya has several phone books, in which he recorded the telephone numbers of his friends. Each of his friends can have one or several phone numbers.Vasya decided to organize information about the phone numbers of friends. You will be given n strings \xe2\x80\x94 all entries from Vasya\'s phone books. Each entry starts with a friend\'s name. Then follows the number of phone numbers in the current entry, and then the phone numbers themselves. It is possible that several identical phones are recorded in the same record.Vasya also believes that if the phone number a is a suffix of the phone number b (that is, the number b ends up with a), and both numbers are written by Vasya as the phone numbers of the same person, then a is recorded without the city code and it should not be taken into account.The task is to print organized information about the phone numbers of Vasya\'s friends. It is possible that two different people have the same number. If one person has two numbers x and y, and x is a suffix of y (that is, y ends in x), then you shouldn\'t print number x. If the number of a friend in the Vasya\'s phone books is recorded several times in the same format, it is necessary to take it into account exactly once.Read the examples to understand statement and format of the output better." 1400

898B "Proper Nutrition" "brute force,implementation,number theory" "Vasya has n burles. One bottle of Ber-Cola costs a burles and one Bars bar costs b burles. He can buy any non-negative integer number of bottles of Ber-Cola and any non-negative integer number of Bars bars.Find out if it\'s possible to buy some amount of bottles of Ber-Cola and Bars bars and spend exactly n burles.In other words, you should find two non-negative integers x and y such that Vasya can buy x bottles of Ber-Cola and y Bars bars and x\xc2\xb7a\xe2\x80\x89+\xe2\x80\x89y\xc2\xb7b\xe2\x80\x89=\xe2\x80\x89n or tell that it\'s impossible." 1100

898A Rounding implementation,math "Vasya has a non-negative integer n. He wants to round it to nearest integer, which ends up with 0. If n already ends up with 0, Vasya considers it already rounded.For example, if n\xe2\x80\x89=\xe2\x80\x894722 answer is 4720. If n\xe2\x80\x89=\xe2\x80\x895 Vasya can round it to 0 or to 10. Both ways are correct.For given n find out to which integer will Vasya round it." 800

897B "Chtholly\'s request" "brute force" "Vasya has a non-negative integer n. He wants to round it to nearest integer, which ends up with 0. If n already ends up with 0, Vasya considers it already rounded.For example, if n\xe2\x80\x89=\xe2\x80\x894722 answer is 4720. If n\xe2\x80\x89=\xe2\x80\x895 Vasya can round it to 0 or to 10. Both ways are correct.For given n find out to which integer will Vasya round it." 1300

897A "Scarborough Fair" implementation "Are you going to Scarborough Fair?Parsley, sage, rosemary and thyme.Remember me to one who lives there.He once was the true love of mine.Willem is taking the girl to the highest building in island No.28, however, neither of them knows how to get there.Willem asks his friend, Grick for directions, Grick helped them, and gave them a task.Although the girl wants to help, Willem insists on doing it by himself.Grick gave Willem a string of length n.Willem needs to do m operations, each operation has four parameters l,\xe2\x80\x89r,\xe2\x80\x89c1,\xe2\x80\x89c2, which means that all symbols c1 in range [l,\xe2\x80\x89r] (from l-th to r-th, including l and r) are changed into c2. String is 1-indexed.Grick wants to know the final string after all the m operations." 800

896E "Welcome home, Chtholly" "data structures,dsu" "\xe2\x80\x94 I... I survived.\xe2\x80\x94 Welcome home, Chtholly.\xe2\x80\x94 I kept my promise...\xe2\x80\x94 I made it... I really made it!After several days of fighting, Chtholly Nota Seniorious miraculously returned from the fierce battle.As promised, Willem is now baking butter cake for her.However, although Willem is skilled in making dessert, he rarely bakes butter cake.This time, Willem made a big mistake \xe2\x80\x94 he accidentally broke the oven!Fortunately, Chtholly decided to help him.Willem puts n cakes on a roll, cakes are numbered from 1 to n, the i-th cake needs ai seconds of baking.Willem needs Chtholly to do m operations to bake the cakes.Operation 1: 1 l r xWillem asks Chtholly to check each cake in the range [l,\xe2\x80\x89r], if the cake needs to be baked for more than x seconds, he would bake it for x seconds and put it back in its place. More precisely, for every i in range [l,\xe2\x80\x89r], if ai is strictly more than x, ai becomes equal ai\xe2\x80\x89-\xe2\x80\x89x.Operation 2: 2 l r xWillem asks Chtholly to count the number of cakes in the range [l,\xe2\x80\x89r] that needs to be cooked for exactly x seconds. More formally you should find number of such i in range [l,\xe2\x80\x89r], that ai\xe2\x80\x89=\xe2\x80\x89x." 3100

896D "Nephren Runs a Cinema" "chinese remainder theorem,combinatorics,math,number theory" "Lakhesh loves to make movies, so Nephren helps her run a cinema. We may call it No. 68 Cinema.However, one day, the No. 68 Cinema runs out of changes (they don\'t have 50-yuan notes currently), but Nephren still wants to start their business. (Assume that yuan is a kind of currency in Regulu Ere.)There are three types of customers: some of them bring exactly a 50-yuan note; some of them bring a 100-yuan note and Nephren needs to give a 50-yuan note back to him/her; some of them bring VIP cards so that they don\'t need to pay for the ticket.Now n customers are waiting outside in queue. Nephren wants to know how many possible queues are there that they are able to run smoothly (i.e. every customer can receive his/her change), and that the number of 50-yuan notes they have after selling tickets to all these customers is between l and r, inclusive. Two queues are considered different if there exists a customer whose type is different in two queues. As the number can be large, please output the answer modulo p." 2900

896C "Willem, Chtholly and Seniorious" "data structures,probabilities" "\xe2\x80\x94 Willem...\xe2\x80\x94 What\'s the matter?\xe2\x80\x94 It seems that there\'s something wrong with Seniorious...\xe2\x80\x94 I\'ll have a look...Seniorious is made by linking special talismans in particular order.After over 500 years, the carillon is now in bad condition, so Willem decides to examine it thoroughly.Seniorious has n pieces of talisman. Willem puts them in a line, the i-th of which is an integer ai.In order to maintain it, Willem needs to perform m operations.There are four types of operations: 1 l r x: For each i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r, assign ai\xe2\x80\x89+\xe2\x80\x89x to ai. 2 l r x: For each i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r, assign x to ai. 3 l r x: Print the x-th smallest number in the index range [l,\xe2\x80\x89r], i.e. the element at the x-th position if all the elements ai such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r are taken and sorted into an array of non-decreasing integers. It\'s guaranteed that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891. 4 l r x y: Print the sum of the x-th power of ai such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r, modulo y, i.e. ." 2600

896B "Ithea Plays With Chtholly" "binary search,constructive algorithms,games,greedy,interactive" "This is an interactive problem. Refer to the Interaction section below for better understanding.Ithea and Chtholly want to play a game in order to determine who can use the kitchen tonight.Initially, Ithea puts n clear sheets of paper in a line. They are numbered from 1 to n from left to right.This game will go on for m rounds. In each round, Ithea will give Chtholly an integer between 1 and c, and Chtholly needs to choose one of the sheets to write down this number (if there is already a number before, she will erase the original one and replace it with the new one).Chtholly wins if, at any time, all the sheets are filled with a number and the n numbers are in non-decreasing order looking from left to right from sheet 1 to sheet n, and if after m rounds she still doesn\'t win, she loses the game.Chtholly really wants to win the game as she wants to cook something for Willem. But she doesn\'t know how to win the game. So Chtholly finds you, and your task is to write a program to receive numbers that Ithea gives Chtholly and help her make the decision on which sheet of paper write this number." 2000

896A "Nephren gives a riddle" "binary search,dfs and similar" "What are you doing at the end of the world? Are you busy? Will you save us?Nephren is playing a game with little leprechauns.She gives them an infinite array of strings, f0... \xe2\x88\x9e.f0 is ""What are you doing at the end of the world? Are you busy? Will you save us?"".She wants to let more people know about it, so she defines fi\xe2\x80\x89=\xe2\x80\x89 ""What are you doing while sending ""fi\xe2\x80\x89-\xe2\x80\x891""? Are you busy? Will you send ""fi\xe2\x80\x89-\xe2\x80\x891""?"" for all i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891.For example, f1 is""What are you doing while sending ""What are you doing at the end of the world? Are you busy? Will you save us?""? Are you busy? Will you send ""What are you doing at the end of the world? Are you busy? Will you save us?""?"". Note that the quotes in the very beginning and in the very end are for clarity and are not a part of f1.It can be seen that the characters in fi are letters, question marks, (possibly) quotation marks and spaces.Nephren will ask the little leprechauns q times. Each time she will let them find the k-th character of fn. The characters are indexed starting from 1. If fn consists of less than k characters, output \'.\' (without quotes).Can you answer her queries?" 1700

895E "Eyes Closed" "data structures,probabilities" "Vasya and Petya were tired of studying so they decided to play a game. Before the game begins Vasya looks at array a consisting of n integers. As soon as he remembers all elements of a the game begins. Vasya closes his eyes and Petya does q actions of one of two types:1) Petya says 4 integers l1,\xe2\x80\x89r1,\xe2\x80\x89l2,\xe2\x80\x89r2�\xe2\x80\x94 boundaries of two non-intersecting segments. After that he swaps one random element from the [l1,\xe2\x80\x89r1] segment with another random element from the [l2,\xe2\x80\x89r2] segment.2) Petya asks Vasya the sum of the elements of a in the [l,\xe2\x80\x89r] segment.Vasya is a mathematician so he answers Petya the mathematical expectation of the sum of the elements in the segment.Your task is to write a program which will answer the second type questions as Vasya would do it. In other words your program should print the mathematical expectation of the sum of the elements of a in the [l,\xe2\x80\x89r] segment for every second type query." 2300

895D "String Mark" combinatorics,math,strings "At the Byteland State University marks are strings of the same length. Mark x is considered better than y if string y is lexicographically smaller than x.Recently at the BSU was an important test work on which Vasya recived the mark a. It is very hard for the teacher to remember the exact mark of every student, but he knows the mark b, such that every student recieved mark strictly smaller than b.Vasya isn\'t satisfied with his mark so he decided to improve it. He can swap characters in the string corresponding to his mark as many times as he like. Now he want to know only the number of different ways to improve his mark so that his teacher didn\'t notice something suspicious.More formally: you are given two strings a, b of the same length and you need to figure out the number of different strings c such that:1) c can be obtained from a by swapping some characters, in other words c is a permutation of a.2) String a is lexicographically smaller than c.3) String c is lexicographically smaller than b.For two strings x and y of the same length it is true that x is lexicographically smaller than y if there exists such i, that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89xi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89yi\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89xi\xe2\x80\x89<\xe2\x80\x89yi.Since the answer can be very large, you need to find answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2100

895C "Square Subsets" bitmasks,combinatorics,dp,math "Petya was late for the lesson too. The teacher gave him an additional task. For some array a Petya should find the number of different ways to select non-empty subset of elements from it in such a way that their product is equal to a square of some integer.Two ways are considered different if sets of indexes of elements chosen by these ways are different.Since the answer can be very large, you should find the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2000

895B "XK Segments" "binary search,math,sortings,two pointers" "While Vasya finished eating his piece of pizza, the lesson has already started. For being late for the lesson, the teacher suggested Vasya to solve one interesting problem. Vasya has an array a and integer x. He should find the number of different ordered pairs of indexes (i,\xe2\x80\x89j) such that ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj and there are exactly k integers y such that ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj and y is divisible by x.In this problem it is meant that pair (i,\xe2\x80\x89j) is equal to (j,\xe2\x80\x89i) only if i is equal to j. For example pair (1,\xe2\x80\x892) is not the same as (2,\xe2\x80\x891)." 1700

895A "Pizza Separation" "brute force,implementation" "Students Vasya and Petya are studying at the BSU (Byteland State University). At one of the breaks they decided to order a pizza. In this problem pizza is a circle of some radius. The pizza was delivered already cut into n pieces. The i-th piece is a sector of angle equal to ai. Vasya and Petya want to divide all pieces of pizza into two continuous sectors in such way that the difference between angles of these sectors is minimal. Sector angle is sum of angles of all pieces in it. Pay attention, that one of sectors can be empty." 1200

894E "Ralph and Mushrooms" dp,graphs "Ralph is going to collect mushrooms in the Mushroom Forest. There are m directed paths connecting n trees in the Mushroom Forest. On each path grow some mushrooms. When Ralph passes a path, he collects all the mushrooms on the path. The Mushroom Forest has a magical fertile ground where mushrooms grow at a fantastic speed. New mushrooms regrow as soon as Ralph finishes mushroom collection on a path. More specifically, after Ralph passes a path the i-th time, there regrow i mushrooms less than there was before this pass. That is, if there is initially x mushrooms on a path, then Ralph will collect x mushrooms for the first time, x\xe2\x80\x89-\xe2\x80\x891 mushrooms the second time, x\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x892 mushrooms the third time, and so on. However, the number of mushrooms can never be less than 0.For example, let there be 9 mushrooms on a path initially. The number of mushrooms that can be collected from the path is 9, 8, 6 and 3 when Ralph passes by from first to fourth time. From the fifth time and later Ralph can\'t collect any mushrooms from the path (but still can pass it).Ralph decided to start from the tree s. How many mushrooms can he collect using only described paths?" 2100

894D "Ralph And His Tour in Binary Country" "brute force,data structures,trees" "Ralph is in the Binary Country. The Binary Country consists of n cities and (n\xe2\x80\x89-\xe2\x80\x891) bidirectional roads connecting the cities. The roads are numbered from 1 to (n\xe2\x80\x89-\xe2\x80\x891), the i-th road connects the city labeled  (here \xe2\x8c\x8a x\xe2\x8c\x8b denotes the x rounded down to the nearest integer) and the city labeled (i\xe2\x80\x89+\xe2\x80\x891), and the length of the i-th road is Li.Now Ralph gives you m queries. In each query he tells you some city Ai and an integer Hi. He wants to make some tours starting from this city. He can choose any city in the Binary Country (including Ai) as the terminal city for a tour. He gains happiness (Hi\xe2\x80\x89-\xe2\x80\x89L) during a tour, where L is the distance between the city Ai and the terminal city.Ralph is interested in tours from Ai in which he can gain positive happiness. For each query, compute the sum of happiness gains for all such tours.Ralph will never take the same tour twice or more (in one query), he will never pass the same city twice or more in one tour." 2200

894C "Marco and GCD Sequence" "constructive algorithms,math" "In a dream Marco met an elderly man with a pair of black glasses. The man told him the key to immortality and then disappeared with the wind of time.When he woke up, he only remembered that the key was a sequence of positive integers of some length n, but forgot the exact sequence. Let the elements of the sequence be a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. He remembered that he calculated gcd(ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89aj) for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and put it into a set S. gcd here means the greatest common divisor.Note that even if a number is put into the set S twice or more, it only appears once in the set.Now Marco gives you the set S and asks you to help him figure out the initial sequence. If there are many solutions, print any of them. It is also possible that there are no sequences that produce the set S, in this case print -1." 1900

894B "Ralph And His Magic Field" "combinatorics,constructive algorithms,math,number theory" "Ralph has a magic field which is divided into n\xe2\x80\x89\xc3\x97\xe2\x80\x89m blocks. That is to say, there are n rows and m columns on the field. Ralph can put an integer in each block. However, the magic field doesn\'t always work properly. It works only if the product of integers in each row and each column equals to k, where k is either 1 or -1.Now Ralph wants you to figure out the number of ways to put numbers in each block in such a way that the magic field works properly. Two ways are considered different if and only if there exists at least one block where the numbers in the first way and in the second way are different. You are asked to output the answer modulo 1000000007\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897.Note that there is no range of the numbers to put in the blocks, but we can prove that the answer is not infinity." 1800

894A QAQ "brute force,dp" """QAQ"" is a word to denote an expression of crying. Imagine ""Q"" as eyes with tears and ""A"" as a mouth.Now Diamond has given Bort a string consisting of only uppercase English letters of length n. There is a great number of ""QAQ"" in the string (Diamond is so cute!).  illustration by \xe7\x8c\xab\xe5\xb1\x8b https://twitter.com/nekoyaliu Bort wants to know how many subsequences ""QAQ"" are in the string Diamond has given. Note that the letters ""QAQ"" don\'t have to be consecutive, but the order of letters should be exact." 800

893F "Subtree Minimum Query" "data structures,trees" "You are given a rooted tree consisting of n vertices. Each vertex has a number written on it; number ai is written on vertex i.Let\'s denote d(i,\xe2\x80\x89j) as the distance between vertices i and j in the tree (that is, the number of edges in the shortest path from i to j). Also let\'s denote the k-blocked subtree of vertex x as the set of vertices y such that both these conditions are met:  x is an ancestor of y (every vertex is an ancestor of itself);  d(x,\xe2\x80\x89y)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k. You are given m queries to the tree. i-th query is represented by two numbers xi and ki, and the answer to this query is the minimum value of aj among such vertices j such that j belongs to ki-blocked subtree of xi.Write a program that would process these queries quickly!Note that the queries are given in a modified way." 2300

893E "Counting Arrays" "combinatorics,dp,math,number theory" "You are given two positive integer numbers x and y. An array F is called an y-factorization of x iff the following conditions are met:  There are y elements in F, and all of them are integer numbers;  . You have to count the number of pairwise distinct arrays that are y-factorizations of x. Two arrays A and B are considered different iff there exists at least one index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y) such that Ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89Bi. Since the answer can be very large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2000

893D "Credit Card" "data structures,dp,greedy,implementation" "Recenlty Luba got a credit card and started to use it. Let\'s consider n consecutive days Luba uses the card.She starts with 0 money on her account.In the evening of i-th day a transaction ai occurs. If ai\xe2\x80\x89>\xe2\x80\x890, then ai bourles are deposited to Luba\'s account. If ai\xe2\x80\x89<\xe2\x80\x890, then ai bourles are withdrawn. And if ai\xe2\x80\x89=\xe2\x80\x890, then the amount of money on Luba\'s account is checked.In the morning of any of n days Luba can go to the bank and deposit any positive integer amount of burles to her account. But there is a limitation: the amount of money on the account can never exceed d.It can happen that the amount of money goes greater than d by some transaction in the evening. In this case answer will be \xc2\xab-1\xc2\xbb.Luba must not exceed this limit, and also she wants that every day her account is checked (the days when ai\xe2\x80\x89=\xe2\x80\x890) the amount of money on her account is non-negative. It takes a lot of time to go to the bank, so Luba wants to know the minimum number of days she needs to deposit some money to her account (if it is possible to meet all the requirements). Help her!" 1900

893C Rumor "dfs and similar,graphs,greedy" "Vova promised himself that he would never play computer games... But recently Firestorm \xe2\x80\x94 a well-known game developing company \xe2\x80\x94 published their newest game, World of Farcraft, and it became really popular. Of course, Vova started playing it.Now he tries to solve a quest. The task is to come to a settlement named Overcity and spread a rumor in it.Vova knows that there are n characters in Overcity. Some characters are friends to each other, and they share information they got. Also Vova knows that he can bribe each character so he or she starts spreading the rumor; i-th character wants ci gold in exchange for spreading the rumor. When a character hears the rumor, he tells it to all his friends, and they start spreading the rumor to their friends (for free), and so on.The quest is finished when all n characters know the rumor. What is the minimum amount of gold Vova needs to spend in order to finish the quest?Take a look at the notes if you think you haven\'t understood the problem completely." 1300

893B "Beautiful Divisors" "brute force,implementation" "Recently Luba learned about a special kind of numbers that she calls beautiful numbers. The number is called beautiful iff its binary representation consists of k\xe2\x80\x89+\xe2\x80\x891 consecutive ones, and then k consecutive zeroes.Some examples of beautiful numbers:   12 (110);  1102 (610);  11110002 (12010);  1111100002 (49610). More formally, the number is beautiful iff there exists some positive integer k such that the number is equal to (2k\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89*\xe2\x80\x89(2k\xe2\x80\x89-\xe2\x80\x891).Luba has got an integer number n, and she wants to find its greatest beautiful divisor. Help her to find it!" 1000

893A "Chess For Three" implementation "Alex, Bob and Carl will soon participate in a team chess tournament. Since they are all in the same team, they have decided to practise really hard before the tournament. But it\'s a bit difficult for them because chess is a game for two players, not three.So they play with each other according to following rules:  Alex and Bob play the first game, and Carl is spectating;  When the game ends, the one who lost the game becomes the spectator in the next game, and the one who was spectating plays against the winner. Alex, Bob and Carl play in such a way that there are no draws.Today they have played n games, and for each of these games they remember who was the winner. They decided to make up a log of games describing who won each game. But now they doubt if the information in the log is correct, and they want to know if the situation described in the log they made up was possible (that is, no game is won by someone who is spectating if Alex, Bob and Carl play according to the rules). Help them to check it!" 900

892B Wrath "greedy,implementation,two pointers" "Hands that shed innocent blood!There are n guilty people in a line, the i-th of them holds a claw with length Li. The bell rings and every person kills some of people in front of him. All people kill others at the same time. Namely, the i-th person kills the j-th person if and only if j\xe2\x80\x89<\xe2\x80\x89i and j\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89i\xe2\x80\x89-\xe2\x80\x89Li.You are given lengths of the claws. You need to find the total number of alive people after the bell rings." 1200

892A Greed greedy,implementation "Jafar has n cans of cola. Each can is described by two integers: remaining volume of cola ai and can\'s capacity bi (ai \xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89 bi).Jafar has decided to pour all remaining cola into just 2 cans, determine if he can do this or not!" 900

891E Lust combinatorics,math,matrices "A false witness that speaketh lies!You are given a sequence containing n integers. There is a variable res that is equal to 0 initially. The following process repeats k times.Choose an index from 1 to n uniformly at random. Name it x. Add to res the multiply of all ai\'s such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, but i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x. Then, subtract ax by 1.You have to find expected value of res at the end of the process. It can be proved that the expected value of res can be represented as an irreducible fraction . You have to find ." 3000

891D Sloth "dfs and similar,dp,graph matchings,trees" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 3100

891C Envy "data structures,dsu,graphs" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2300

891B Gluttony "constructive algorithms,greedy" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2000

891A Pride "brute force,dp,greedy,math,number theory" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1500

889E "Mod Mod Mod" "binary search,dp,math" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 3000

888G Xor-MST "bitmasks,constructive algorithms,data structures" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2300

888F "Connecting Vertices" dp,graphs "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2500

888E "Maximum Subsequence" "bitmasks,divide and conquer,meet-in-the-middle" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1800

888D "Almost Identity Permutations" combinatorics,dp,math "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1600

888C "K-Dominant Character" "binary search,implementation,two pointers" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1400

888B "Buggy Robot" greedy "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1000

888A "Local Extrema" "brute force,implementation" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 800

887F "Row of Models" greedy,sortings "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2500

887E "Little Brother" "binary search,geometry,sortings" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2800

887D "Ratings and Reality Shows" "data structures,two pointers" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2400

887C "Solution for Cube" "brute force,implementation" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1500

887B "Cubes for Masha" "brute force,implementation" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1300

887A "Div. 64" implementation "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1000

886F "Symmetric Projections" geometry "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2900

886E "Maximum Element" combinatorics,dp,math "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2400

886D "Restoration of string" "constructive algorithms,graphs,implementation" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2000

886C "Petya and Catacombs" dsu,greedy,implementation,trees "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1300

886B "Vlad and Cafes" NA "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1000

886A "ACM ICPC" "brute force" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1000

884F Anti-Palindromize flows,graphs,greedy "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2500

884E "Binary Matrix" dsu "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2500

884D "Boxes And Balls" "data structures,greedy" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2300

884C "Bertown Subway" "dfs and similar,greedy,math" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1500

884B "Japanese Crosswords Strike Back" implementation "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1100

884A "Book Reading" implementation "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 800

883M "Quadcopter Competition" greedy,math "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1100

883L Berland.Taxi "data structures" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2500

883K "Road Widening" "constructive algorithms,greedy,implementation" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1800

883J Renovation "constructive algorithms,greedy,sortings" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2400

883I "Photo Processing" "binary search,dp" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1900

883H "Palindromic Cut" "brute force,implementation,strings" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1800

883G "Orientation of Edges" "dfs and similar,graphs" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1900

883F "Lost in Transliteration" implementation "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1300

883E "Field of Wonders" implementation,strings "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1500

883D "Packmen Strike Back" "binary search,dp,math" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2500

883C "Downloading B++" "binary search,implementation" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2300

883B "Berland Army" "constructive algorithms,graphs,greedy" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2600

883A "Automatic Door" implementation "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2200

879B "Table Tennis" "data structures,implementation" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1200

879A "Borya\'s Diagnosis" implementation "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 900

878E "Numbers on the blackboard" combinatorics,dp "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 3300

878D "Magic Breeding" bitmasks "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2900

878C Tournament "data structures,graphs" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2700

878B "Teams Formation" "data structures,implementation" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2300

878A "Short Program" "bitmasks,constructive algorithms" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1600

877F "Ann and Books" "data structures,flows,hashing" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2300

877E "Danil and a Part-time Job" "bitmasks,data structures,trees" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2000

877D "Olya and Energy Drinks" "data structures,dfs and similar,graphs,shortest paths" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 2100

877C "Slava and tanks" "constructive algorithms" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 1600

877B "Nikita and string" "brute force,dp" "One day Nikita found the string containing letters ""a"" and ""b"" only. Nikita thinks that string is beautiful if it can be cut into 3 strings (possibly empty) without changing the order of the letters, where the 1-st and the 3-rd one contain only letters ""a"" and the 2-nd contains only letters ""b"".Nikita wants to make the string beautiful by removing some (possibly none) of its characters, but without changing their order. What is the maximum length of the string he can get?" 1500

877A "Alex and broken contest" implementation,strings "One day Alex was creating a contest about his friends, but accidentally deleted it. Fortunately, all the problems were saved, but now he needs to find them among other problems.But there are too many problems, to do it manually. Alex asks you to write a program, which will determine if a problem is from this contest by its name.It is known, that problem is from this contest if and only if its name contains one of Alex\'s friends\' name exactly once. His friends\' names are ""Danil"", ""Olya"", ""Slava"", ""Ann"" and ""Nikita"".Names are case sensitive." 1100

876B "Divisiblity of Differences" "implementation,math,number theory" "You are given a multiset of n integers. You should select exactly k of them in a such way that the difference between any two of them is divisible by m, or tell that it is impossible.Numbers can be repeated in the original multiset and in the multiset of selected numbers, but number of occurrences of any number in multiset of selected numbers should not exceed the number of its occurrences in the original multiset." 1300

876A "Trip For Meal" math "Winnie-the-Pooh likes honey very much! That is why he decided to visit his friends. Winnie has got three best friends: Rabbit, Owl and Eeyore, each of them lives in his own house. There are winding paths between each pair of houses. The length of a path between Rabbit\'s and Owl\'s houses is a meters, between Rabbit\'s and Eeyore\'s house is b meters, between Owl\'s and Eeyore\'s house is c meters.For enjoying his life and singing merry songs Winnie-the-Pooh should have a meal n times a day. Now he is in the Rabbit\'s house and has a meal for the first time. Each time when in the friend\'s house where Winnie is now the supply of honey is about to end, Winnie leaves that house. If Winnie has not had a meal the required amount of times, he comes out from the house and goes to someone else of his two friends. For this he chooses one of two adjacent paths, arrives to the house on the other end and visits his friend. You may assume that when Winnie is eating in one of his friend\'s house, the supply of honey in other friend\'s houses recover (most probably, they go to the supply store).Winnie-the-Pooh does not like physical activity. He wants to have a meal n times, traveling minimum possible distance. Help him to find this distance." 900

875F "Royal Questions" dsu,graphs,greedy "In a medieval kingdom, the economic crisis is raging. Milk drops fall, Economic indicators are deteriorating every day, money from the treasury disappear. To remedy the situation, King Charles Sunnyface decided make his n sons-princes marry the brides with as big dowry as possible.In search of candidates, the king asked neighboring kingdoms, and after a while several delegations arrived with m unmarried princesses. Receiving guests, Karl learned that the dowry of the i th princess is wi of golden coins. Although the action takes place in the Middle Ages, progressive ideas are widespread in society, according to which no one can force a princess to marry a prince whom she does not like. Therefore, each princess has an opportunity to choose two princes, for each of which she is ready to become a wife. The princes were less fortunate, they will obey the will of their father in the matter of choosing a bride.Knowing the value of the dowry and the preferences of each princess, Charles wants to play weddings in such a way that the total dowry of the brides of all his sons would be as great as possible. At the same time to marry all the princes or princesses is not necessary. Each prince can marry no more than one princess, and vice versa, each princess can marry no more than one prince.Help the king to organize the marriage of his sons in the most profitable way for the treasury." 2500

875E "Delivery Club" "binary search,data structures,dp" "Petya and Vasya got employed as couriers. During the working day they are to deliver packages to n different points on the line. According to the company\'s internal rules, the delivery of packages must be carried out strictly in a certain order. Initially, Petya is at the point with the coordinate s1, Vasya is at the point with the coordinate s2, and the clients are at the points x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn in the order of the required visit.The guys agree in advance who of them will deliver the package to which of the customers, and then they act as follows. When the package for the i-th client is delivered, the one who delivers the package to the (i\xe2\x80\x89+\xe2\x80\x891)-st client is sent to the path (it can be the same person who went to the point xi, or the other). The friend who is not busy in delivering the current package, is standing still.To communicate with each other, the guys have got walkie-talkies. The walkie-talkies work rather poorly at great distances, so Petya and Vasya want to distribute the orders so that the maximum distance between them during the day is as low as possible. Help Petya and Vasya to minimize the maximum distance between them, observing all delivery rules." 2600

875D "High Cry" "binary search,bitmasks,combinatorics,data structures,divide and conquer" "Disclaimer: there are lots of untranslateable puns in the Russian version of the statement, so there is one more reason for you to learn Russian :)Rick and Morty like to go to the ridge High Cry for crying loudly�\xe2\x80\x94 there is an extraordinary echo. Recently they discovered an interesting acoustic characteristic of this ridge: if Rick and Morty begin crying simultaneously from different mountains, their cry would be heard between these mountains up to the height equal the bitwise OR of mountains they\'ve climbed and all the mountains between them. Bitwise OR is a binary operation which is determined the following way. Consider representation of numbers x and y in binary numeric system (probably with leading zeroes) x\xe2\x80\x89=\xe2\x80\x89xk... x1x0 and y\xe2\x80\x89=\xe2\x80\x89yk... y1y0. Then z\xe2\x80\x89=\xe2\x80\x89x�|�y is defined following way: z\xe2\x80\x89=\xe2\x80\x89zk... z1z0, where zi\xe2\x80\x89=\xe2\x80\x891, if xi\xe2\x80\x89=\xe2\x80\x891 or yi\xe2\x80\x89=\xe2\x80\x891, and zi\xe2\x80\x89=\xe2\x80\x890 otherwise. In the other words, digit of bitwise OR of two numbers equals zero if and only if digits at corresponding positions is both numbers equals zero. For example bitwise OR of numbers 10\xe2\x80\x89=\xe2\x80\x8910102 and 9\xe2\x80\x89=\xe2\x80\x8910012 equals 11\xe2\x80\x89=\xe2\x80\x8910112. In programming languages C/C++/Java/Python this operation is defined as \xc2\xab|\xc2\xbb, and in Pascal as \xc2\xabor\xc2\xbb.Help Rick and Morty calculate the number of ways they can select two mountains in such a way that if they start crying from these mountains their cry will be heard above these mountains and all mountains between them. More formally you should find number of pairs l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that bitwise OR of heights of all mountains between l and r (inclusive) is larger than the height of any mountain at this interval." 2200

875C "National Property" "2-sat,dfs and similar,graphs,implementation" "You all know that the Library of Bookland is the largest library in the world. There are dozens of thousands of books in the library.Some long and uninteresting story was removed...The alphabet of Bookland is so large that its letters are denoted by positive integers. Each letter can be small or large, the large version of a letter x is denoted by x\'. BSCII encoding, which is used everywhere in Bookland, is made in that way so that large letters are presented in the order of the numbers they are denoted by, and small letters are presented in the order of the numbers they are denoted by, but all large letters are before all small letters. For example, the following conditions hold: 2\xe2\x80\x89<\xe2\x80\x893, 2\'\xe2\x80\x89<\xe2\x80\x893\', 3\'\xe2\x80\x89<\xe2\x80\x892.A word x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xa is not lexicographically greater than y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yb if one of the two following conditions holds:   a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b and x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89...,\xe2\x80\x89xa\xe2\x80\x89=\xe2\x80\x89ya, i.e. the first word is the prefix of the second word;  there is a position 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89min(a,\xe2\x80\x89b), such that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89...,\xe2\x80\x89xj\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89yj\xe2\x80\x89-\xe2\x80\x891 and xj\xe2\x80\x89<\xe2\x80\x89yj, i.e. at the first position where the words differ the first word has a smaller letter than the second word has.  For example, the word ""3\' 7 5"" is before the word ""2 4\' 6"" in lexicographical order. It is said that sequence of words is in lexicographical order if each word is not lexicographically greater than the next word in the sequence.Denis has a sequence of words consisting of small letters only. He wants to change some letters to large (let\'s call this process a capitalization) in such a way that the sequence of words is in lexicographical order. However, he soon realized that for some reason he can\'t change a single letter in a single word. He only can choose a letter and change all of its occurrences in all words to large letters. He can perform this operation any number of times with arbitrary letters of Bookland\'s alphabet.Help Denis to choose which letters he needs to capitalize (make large) in order to make the sequence of words lexicographically ordered, or determine that it is impossible.Note that some words can be equal." 2100

875B "Sorting the Coins" "dsu,implementation,sortings,two pointers" "Recently, Dima met with Sasha in a philatelic store, and since then they are collecting coins together. Their favorite occupation is to sort collections of coins. Sasha likes having things in order, that is why he wants his coins to be arranged in a row in such a way that firstly come coins out of circulation, and then come coins still in circulation. For arranging coins Dima uses the following algorithm. One step of his algorithm looks like the following:  He looks through all the coins from left to right;  If he sees that the i-th coin is still in circulation, and (i\xe2\x80\x89+\xe2\x80\x891)-th coin is already out of circulation, he exchanges these two coins and continues watching coins from (i\xe2\x80\x89+\xe2\x80\x891)-th.  Dima repeats the procedure above until it happens that no two coins were exchanged during this procedure. Dima calls hardness of ordering the number of steps required for him according to the algorithm above to sort the sequence, e.g. the number of times he looks through the coins from the very beginning. For example, for the ordered sequence hardness of ordering equals one.Today Sasha invited Dima and proposed him a game. First he puts n coins in a row, all of them are out of circulation. Then Sasha chooses one of the coins out of circulation and replaces it with a coin in circulation for n times. During this process Sasha constantly asks Dima what is the hardness of ordering of the sequence. The task is more complicated because Dima should not touch the coins and he should determine hardness of ordering in his mind. Help Dima with this task." 1500

875A "Classroom Watch" "brute force,math" "Eighth-grader Vova is on duty today in the class. After classes, he went into the office to wash the board, and found on it the number n. He asked what is this number and the teacher of mathematics Inna Petrovna answered Vova that n is the answer to the arithmetic task for first-graders. In the textbook, a certain positive integer x was given. The task was to add x to the sum of the digits of the number x written in decimal numeral system.Since the number n on the board was small, Vova quickly guessed which x could be in the textbook. Now he wants to get a program which will search for arbitrary values of the number n for all suitable values of x or determine that such x does not exist. Write such a program for Vova." 1200

873F "Forbidden Indices" "dsu,string suffix structures,strings" "You are given a string s consisting of n lowercase Latin letters. Some indices in this string are marked as forbidden.You want to find a string a such that the value of |a|\xc2\xb7f(a) is maximum possible, where f(a) is the number of occurences of a in s such that these occurences end in non-forbidden indices. So, for example, if s is aaaa, a is aa and index 3 is forbidden, then f(a)\xe2\x80\x89=\xe2\x80\x892 because there are three occurences of a in s (starting in indices 1, 2 and 3), but one of them (starting in index 2) ends in a forbidden index.Calculate the maximum possible value of |a|\xc2\xb7f(a) you can get." 2400

873E "Awards For Contestants" "brute force,data structures,dp" "Alexey recently held a programming contest for students from Berland. n students participated in a contest, i-th of them solved ai problems. Now he wants to award some contestants. Alexey can award the students with diplomas of three different degrees. Each student either will receive one diploma of some degree, or won\'t receive any diplomas at all. Let cntx be the number of students that are awarded with diplomas of degree x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893). The following conditions must hold:  For each x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893) cntx\xe2\x80\x89>\xe2\x80\x890;  For any two degrees x and y cntx\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7cnty. Of course, there are a lot of ways to distribute the diplomas. Let bi be the degree of diploma i-th student will receive (or \xe2\x80\x89-\xe2\x80\x891 if i-th student won\'t receive any diplomas). Also for any x such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893 let cx be the maximum number of problems solved by a student that receives a diploma of degree x, and dx be the minimum number of problems solved by a student that receives a diploma of degree x. Alexey wants to distribute the diplomas in such a way that:  If student i solved more problems than student j, then he has to be awarded not worse than student j (it\'s impossible that student j receives a diploma and i doesn\'t receive any, and also it\'s impossible that both of them receive a diploma, but bj\xe2\x80\x89<\xe2\x80\x89bi);  d1\xe2\x80\x89-\xe2\x80\x89c2 is maximum possible;  Among all ways that maximize the previous expression, d2\xe2\x80\x89-\xe2\x80\x89c3 is maximum possible;  Among all ways that correspond to the two previous conditions, d3\xe2\x80\x89-\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891 is maximum possible, where c\xe2\x80\x89-\xe2\x80\x891 is the maximum number of problems solved by a student that doesn\'t receive any diploma (or 0 if each student is awarded with some diploma). Help Alexey to find a way to award the contestants!" 2300

873D "Merge Sort" "constructive algorithms,divide and conquer" "Merge sort is a well-known sorting algorithm. The main function that sorts the elements of array a with indices from [l,\xe2\x80\x89r) can be implemented as follows:  If the segment [l,\xe2\x80\x89r) is already sorted in non-descending order (that is, for any i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x891 a[i]\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a[i\xe2\x80\x89+\xe2\x80\x891]), then end the function call;  Let ;  Call mergesort(a,\xe2\x80\x89l,\xe2\x80\x89mid);  Call mergesort(a,\xe2\x80\x89mid,\xe2\x80\x89r);  Merge segments [l,\xe2\x80\x89mid) and [mid,\xe2\x80\x89r), making the segment [l,\xe2\x80\x89r) sorted in non-descending order. The merge algorithm doesn\'t call any other functions. The array in this problem is 0-indexed, so to sort the whole array, you need to call mergesort(a,\xe2\x80\x890,\xe2\x80\x89n).The number of calls of function mergesort is very important, so Ivan has decided to calculate it while sorting the array. For example, if a\xe2\x80\x89=\xe2\x80\x89{1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894}, then there will be 1 call of mergesort \xe2\x80\x94 mergesort(0,\xe2\x80\x894), which will check that the array is sorted and then end. If a\xe2\x80\x89=\xe2\x80\x89{2,\xe2\x80\x891,\xe2\x80\x893}, then the number of calls is 3: first of all, you call mergesort(0,\xe2\x80\x893), which then sets mid\xe2\x80\x89=\xe2\x80\x891 and calls mergesort(0,\xe2\x80\x891) and mergesort(1,\xe2\x80\x893), which do not perform any recursive calls because segments (0,\xe2\x80\x891) and (1,\xe2\x80\x893) are sorted.Ivan has implemented the program that counts the number of mergesort calls, but now he needs to test it. To do this, he needs to find an array a such that a is a permutation of size n (that is, the number of elements in a is n, and every integer number from [1,\xe2\x80\x89n] can be found in this array), and the number of mergesort calls when sorting the array is exactly k.Help Ivan to find an array he wants!" 1800

873C "Strange Game On Matrix" "greedy,two pointers" "Ivan is playing a strange game.He has a matrix a with n rows and m columns. Each element of the matrix is equal to either 0 or 1. Rows and columns are 1-indexed. Ivan can replace any number of ones in this matrix with zeroes. After that, his score in the game will be calculated as follows:  Initially Ivan\'s score is 0;  In each column, Ivan will find the topmost 1 (that is, if the current column is j, then he will find minimum i such that ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x891). If there are no 1\'s in the column, this column is skipped;  Ivan will look at the next min(k,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) elements in this column (starting from the element he found) and count the number of 1\'s among these elements. This number will be added to his score. Of course, Ivan wants to maximize his score in this strange game. Also he doesn\'t want to change many elements, so he will replace the minimum possible number of ones with zeroes. Help him to determine the maximum possible score he can get and the minimum possible number of replacements required to achieve that score." 1600

873B "Balanced Substring" dp,implementation "You are given a string s consisting only of characters 0 and 1. A substring [l,\xe2\x80\x89r] of s is a string slsl\xe2\x80\x89+\xe2\x80\x891sl\xe2\x80\x89+\xe2\x80\x892... sr, and its length equals to r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891. A substring is called balanced if the number of zeroes (0) equals to the number of ones in this substring.You have to determine the length of the longest balanced substring of s." 1500

873A Chores implementation "Luba has to do n chores today. i-th chore takes ai units of time to complete. It is guaranteed that for every  the condition ai\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891 is met, so the sequence is sorted.Also Luba can work really hard on some chores. She can choose not more than k any chores and do each of them in x units of time instead of ai ().Luba is very responsible, so she has to do all n chores, and now she wants to know the minimum time she needs to do everything. Luba cannot do two chores simultaneously." 800

871E "Restore the Tree" graphs,greedy,trees "Petya had a tree consisting of n vertices numbered with integers from 1 to n. Accidentally he lost his tree. Petya remembers information about k vertices: distances from each of them to each of the n tree vertices.Your task is to restore any tree that satisfies the information that Petya remembers or report that such tree doesn\'t exist." 2900

870F Paths "data structures,number theory" "You are given a positive integer n. Let\'s build a graph on vertices 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n in such a way that there is an edge between vertices u and v if and only if . Let d(u,\xe2\x80\x89v) be the shortest distance between u and v, or 0 if there is no path between them. Compute the sum of values d(u,\xe2\x80\x89v) over all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.The gcd (greatest common divisor) of two positive integers is the maximum positive integer that divides both of the integers." 2700

870E "Points, Lines and Ready-made Titles" "dfs and similar,dsu,graphs,trees" "You are given n distinct points on a plane with integral coordinates. For each point you can either draw a vertical line through it, draw a horizontal line through it, or do nothing.You consider several coinciding straight lines as a single one. How many distinct pictures you can get? Print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300

870D "Something with XOR Queries" "brute force,interactive,probabilities" "This is an interactive problem.Jury has hidden a permutation p of integers from 0 to n\xe2\x80\x89-\xe2\x80\x891. You know only the length n. Remind that in permutation all integers are distinct.Let b be the inverse permutation for p, i.e. pbi\xe2\x80\x89=\xe2\x80\x89i for all i. The only thing you can do is to ask xor of elements pi and bj, printing two indices i and j (not necessarily distinct). As a result of the query with indices i and j you\'ll get the value , where  denotes the xor operation. You can find the description of xor operation in notes.Note that some permutations can remain indistinguishable from the hidden one, even if you make all possible n2 queries. You have to compute the number of permutations indistinguishable from the hidden one, and print one of such permutations, making no more than 2n queries.The hidden permutation does not depend on your queries." 2000

870C "Maximum splitting" "dp,greedy,math,number theory" "You are given several queries. In the i-th query you are given a single positive integer ni. You are to represent ni as a sum of maximum possible number of composite summands and print this maximum number, or print -1, if there are no such splittings.An integer greater than 1 is composite, if it is not prime, i.e. if it has positive divisors not equal to 1 and the integer itself." 1300

870B "Maximum of Maximums of Minimums" greedy "You are given an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an consisting of n integers, and an integer k. You have to split the array into exactly k non-empty subsegments. You\'ll then compute the minimum integer on each subsegment, and take the maximum integer over the k obtained minimums. What is the maximum possible integer you can get?Definitions of subsegment and array splitting are given in notes." 1200

870A "Search for Pretty Integers" "brute force,implementation" "You are given two lists of non-zero digits.Let\'s call an integer pretty if its (base 10) representation has at least one digit from the first list and at least one digit from the second list. What is the smallest positive pretty integer?" 900

869E "The Untended Antiquity" "data structures,hashing" "Adieu l\'ami.Koyomi is helping Oshino, an acquaintance of his, to take care of an open space around the abandoned Eikou Cram School building, Oshino\'s makeshift residence.The space is represented by a rectangular grid of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells, arranged into n rows and m columns. The c-th cell in the r-th row is denoted by (r,\xe2\x80\x89c).Oshino places and removes barriers around rectangular areas of cells. Specifically, an action denoted by ""1 r1 c1 r2 c2"" means Oshino\'s placing barriers around a rectangle with two corners being (r1,\xe2\x80\x89c1) and (r2,\xe2\x80\x89c2) and sides parallel to squares sides. Similarly, ""2 r1 c1 r2 c2"" means Oshino\'s removing barriers around the rectangle. Oshino ensures that no barriers staying on the ground share any common points, nor do they intersect with boundaries of the n\xe2\x80\x89\xc3\x97\xe2\x80\x89m area.Sometimes Koyomi tries to walk from one cell to another carefully without striding over barriers, in order to avoid damaging various items on the ground. ""3 r1 c1 r2 c2"" means that Koyomi tries to walk from (r1,\xe2\x80\x89c1) to (r2,\xe2\x80\x89c2) without crossing barriers.And you\'re here to tell Koyomi the feasibility of each of his attempts." 2400

869D "The Overdosing Ubiquity" "brute force,dfs and similar,graphs" "The fundamental prerequisite for justice is not to be correct, but to be strong. That\'s why justice is always the victor.The Cinderswarm Bee. Koyomi knows it.The bees, according to their nature, live in a tree. To be more specific, a complete binary tree with n nodes numbered from 1 to n. The node numbered 1 is the root, and the parent of the i-th (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) node is . Note that, however, all edges in the tree are undirected.Koyomi adds m extra undirected edges to the tree, creating more complication to trick the bees. And you\'re here to count the number of simple paths in the resulting graph, modulo 109\xe2\x80\x89+\xe2\x80\x897. A simple path is an alternating sequence of adjacent nodes and undirected edges, which begins and ends with nodes and does not contain any node more than once. Do note that a single node is also considered a valid simple path under this definition. Please refer to the examples and notes below for instances." 2800

869C "The Intriguing Obsession" combinatorics,dp,math "\xe2\x80\x94 This is not playing but duty as allies of justice, Nii-chan!\xe2\x80\x94 Not allies but justice itself, Onii-chan!With hands joined, go everywhere at a speed faster than our thoughts! This time, the Fire Sisters�\xe2\x80\x94 Karen and Tsukihi�\xe2\x80\x94 is heading for somewhere they\'ve never reached�\xe2\x80\x94 water-surrounded islands!There are three clusters of islands, conveniently coloured red, blue and purple. The clusters consist of a, b and c distinct islands respectively.Bridges have been built between some (possibly all or none) of the islands. A bridge bidirectionally connects two different islands and has length 1. For any two islands of the same colour, either they shouldn\'t be reached from each other through bridges, or the shortest distance between them is at least 3, apparently in order to prevent oddities from spreading quickly inside a cluster.The Fire Sisters are ready for the unknown, but they\'d also like to test your courage. And you\'re here to figure out the number of different ways to build all bridges under the constraints, and give the answer modulo 998\xe2\x80\x89244\xe2\x80\x89353. Two ways are considered different if a pair of islands exist, such that there\'s a bridge between them in one of them, but not in the other." 1800

869B "The Eternal Immortality" math "Even if the world is full of counterfeits, I still regard it as wonderful.Pile up herbs and incense, and arise again from the flames and ashes of its predecessor�\xe2\x80\x94 as is known to many, the phoenix does it like this.The phoenix has a rather long lifespan, and reincarnates itself once every a! years. Here a! denotes the factorial of integer a, that is, a!\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x892\xe2\x80\x89\xc3\x97\xe2\x80\x89...\xe2\x80\x89\xc3\x97\xe2\x80\x89a. Specifically, 0!\xe2\x80\x89=\xe2\x80\x891.Koyomi doesn\'t care much about this, but before he gets into another mess with oddities, he is interested in the number of times the phoenix will reincarnate in a timespan of b! years, that is, . Note that when b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89a this value is always integer.As the answer can be quite large, it would be enough for Koyomi just to know the last digit of the answer in decimal representation. And you\'re here to provide Koyomi with this knowledge." 1100

869A "The Artful Expedient" "brute force,implementation" "Rock... Paper!After Karen have found the deterministic winning (losing?) strategy for rock-paper-scissors, her brother, Koyomi, comes up with a new game as a substitute. The game works as follows.A positive integer n is decided first. Both Koyomi and Karen independently choose n distinct positive integers, denoted by x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn and y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn respectively. They reveal their sequences, and repeat until all of 2n integers become distinct, which is the only final state to be kept and considered.Then they count the number of ordered pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that the value xi xor yj equals to one of the 2n integers. Here xor means the bitwise exclusive or operation on two integers, and is denoted by operators ^ and/or xor in most programming languages.Karen claims a win if the number of such pairs is even, and Koyomi does otherwise. And you\'re here to help determine the winner of their latest game." 1100

868G "El Toll Caves" math "The prehistoric caves of El Toll are located in Moi\xc3\xa0 (Barcelona). You have heard that there is a treasure hidden in one of n possible spots in the caves. You assume that each of the spots has probability 1\xe2\x80\x89/\xe2\x80\x89n to contain a treasure.You cannot get into the caves yourself, so you have constructed a robot that can search the caves for treasure. Each day you can instruct the robot to visit exactly k distinct spots in the caves. If none of these spots contain treasure, then the robot will obviously return with empty hands. However, the caves are dark, and the robot may miss the treasure even when visiting the right spot. Formally, if one of the visited spots does contain a treasure, the robot will obtain it with probability 1\xe2\x80\x89/\xe2\x80\x892, otherwise it will return empty. Each time the robot searches the spot with the treasure, his success probability is independent of all previous tries (that is, the probability to miss the treasure after searching the right spot x times is 1\xe2\x80\x89/\xe2\x80\x892x).What is the expected number of days it will take to obtain the treasure if you choose optimal scheduling for the robot? Output the answer as a rational number modulo 109\xe2\x80\x89+\xe2\x80\x897. Formally, let the answer be an irreducible fraction P\xe2\x80\x89/\xe2\x80\x89Q, then you have to output . It is guaranteed that Q is not divisible by 109\xe2\x80\x89+\xe2\x80\x897." 3300

868F "Yet Another Minimization Problem" "divide and conquer,dp" "You are given an array of n integers a1... an. The cost of a subsegment is the number of unordered pairs of distinct indices within the subsegment that contain equal elements. Split the given array into k non-intersecting non-empty subsegments so that the sum of their costs is minimum possible. Each element should be present in exactly one subsegment." 2500

868E "Policeman and a Tree" dp,graphs,trees "You are given a tree (a connected non-oriented graph without cycles) with vertices numbered from 1 to n, and the length of the i-th edge is wi. In the vertex s there is a policeman, in the vertices x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xm (xj\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s) m criminals are located.The policeman can walk along the edges with speed 1, the criminals can move with arbitrary large speed. If a criminal at some moment is at the same point as the policeman, he instantly gets caught by the policeman. Determine the time needed for the policeman to catch all criminals, assuming everybody behaves optimally (i.e. the criminals maximize that time, the policeman minimizes that time). Everybody knows positions of everybody else at any moment of time." 2700

868D "Huge Strings" "bitmasks,brute force,dp,implementation,strings" "You are given n strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn consisting of characters 0 and 1. m operations are performed, on each of them you concatenate two existing strings into a new one. On the i-th operation the concatenation saisbi is saved into a new string sn\xe2\x80\x89+\xe2\x80\x89i (the operations are numbered starting from 1). After each operation you need to find the maximum positive integer k such that all possible strings consisting of 0 and 1 of length k (there are 2k such strings) are substrings of the new string. If there is no such k, print 0." 2200

868C "Qualification Rounds" "bitmasks,brute force,constructive algorithms,dp" "Snark and Philip are preparing the problemset for the upcoming pre-qualification round for semi-quarter-finals. They have a bank of n problems, and they want to select any non-empty subset of it as a problemset.k experienced teams are participating in the contest. Some of these teams already know some of the problems. To make the contest interesting for them, each of the teams should know at most half of the selected problems.Determine if Snark and Philip can make an interesting problemset!" 1500

868B "Race Against Time" implementation "Have you ever tried to explain to the coordinator, why it is eight hours to the contest and not a single problem has been prepared yet? Misha had. And this time he has a really strong excuse: he faced a space-time paradox! Space and time replaced each other.The entire universe turned into an enormous clock face with three hands�\xe2\x80\x94 hour, minute, and second. Time froze, and clocks now show the time h hours, m minutes, s seconds.Last time Misha talked with the coordinator at t1 o\'clock, so now he stands on the number t1 on the clock face. The contest should be ready by t2 o\'clock. In the terms of paradox it means that Misha has to go to number t2 somehow. Note that he doesn\'t have to move forward only: in these circumstances time has no direction.Clock hands are very long, and Misha cannot get round them. He also cannot step over as it leads to the collapse of space-time. That is, if hour clock points 12 and Misha stands at 11 then he cannot move to 1 along the top arc. He has to follow all the way round the clock center (of course, if there are no other hands on his way).Given the hands\' positions, t1, and t2, find if Misha can prepare the contest on time (or should we say on space?). That is, find if he can move from t1 to t2 by the clock face." 1400

868A "Bark to Unlock" "brute force,implementation,strings" "As technologies develop, manufacturers are making the process of unlocking a phone as user-friendly as possible. To unlock its new phone, Arkady\'s pet dog Mu-mu has to bark the password once. The phone represents a password as a string of two lowercase English letters.Mu-mu\'s enemy Kashtanka wants to unlock Mu-mu\'s phone to steal some sensible information, but it can only bark n distinct words, each of which can be represented as a string of two lowercase English letters. Kashtanka wants to bark several words (not necessarily distinct) one after another to pronounce a string containing the password as a substring. Tell if it\'s possible to unlock the phone in this way, or not." 900

867A "Between the Offices" implementation "As you may know, MemSQL has American offices in both San Francisco and Seattle. Being a manager in the company, you travel a lot between the two cities, always by plane.You prefer flying from Seattle to San Francisco than in the other direction, because it\'s warmer in San Francisco. You are so busy that you don\'t remember the number of flights you have made in either direction. However, for each of the last n days you know whether you were in San Francisco office or in Seattle office. You always fly at nights, so you never were at both offices on the same day. Given this information, determine if you flew more times from Seattle to San Francisco during the last n days, or not." 800

865G "Flowers and Chocolate" combinatorics,math,matrices "It\'s Piegirl\'s birthday soon, and Pieguy has decided to buy her a bouquet of flowers and a basket of chocolates.The flower shop has F different types of flowers available. The i-th type of flower always has exactly pi petals. Pieguy has decided to buy a bouquet consisting of exactly N flowers. He may buy the same type of flower multiple times. The N flowers are then arranged into a bouquet. The position of the flowers within a bouquet matters. You can think of a bouquet as an ordered list of flower types.The chocolate shop sells chocolates in boxes. There are B different types of boxes available. The i-th type of box contains ci pieces of chocolate. Pieguy can buy any number of boxes, and can buy the same type of box multiple times. He will then place these boxes into a basket. The position of the boxes within the basket matters. You can think of the basket as an ordered list of box types.Pieguy knows that Piegirl likes to pluck a petal from a flower before eating each piece of chocolate. He would like to ensure that she eats the last piece of chocolate from the last box just after plucking the last petal from the last flower. That is, the total number of petals on all the flowers in the bouquet should equal the total number of pieces of chocolate in all the boxes in the basket.How many different bouquet+basket combinations can Pieguy buy? The answer may be very large, so compute it modulo 1000000007\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897." 3300

865F "Egg Roulette" "bitmasks,brute force,divide and conquer,math,meet-in-the-middle" "The game of Egg Roulette is played between two players. Initially 2R raw eggs and 2C cooked eggs are placed randomly into a carton. The shells are left on so there is no way to distinguish a raw egg from a cooked egg. One at a time, a player will select an egg, and then smash the egg on his/her forehead. If the egg was cooked, not much happens, but if the egg was raw, it will make quite the mess. This continues until one player has broken R raw eggs, at which point that player is declared the loser and the other player wins.The order in which players take turns can be described as a string of \'A\' and \'B\' characters, where the i-th character tells which player should choose the i-th egg. Traditionally, players take turns going one after the other. That is, they follow the ordering ""ABABAB..."". This isn\'t very fair though, because the second player will win more often than the first. We\'d like you to find a better ordering for the players to take their turns. Let\'s define the unfairness of an ordering as the absolute difference between the first player\'s win probability and the second player\'s win probability. We\'re interested in orderings that minimize the unfairness. We only consider an ordering valid if it contains the same number of \'A\'s as \'B\'s.You will also be given a string S of length 2(R\xe2\x80\x89+\xe2\x80\x89C) containing only \'A\', \'B\', and \'?\' characters. An ordering is said to match S if it only differs from S in positions where S contains a \'?\'. Of the valid orderings that minimize unfairness, how many match S?" 3300

865E "Hex Dyslexia" "bitmasks,brute force,dp,graphs" "Copying large hexadecimal (base 16) strings by hand can be error prone, but that doesn\'t stop people from doing it. You\'ve discovered a bug in the code that was likely caused by someone making a mistake when copying such a string. You suspect that whoever copied the string did not change any of the digits in the string, nor the length of the string, but may have permuted the digits arbitrarily. For example, if the original string was 0abc they may have changed it to a0cb or 0bca, but not abc or 0abb.Unfortunately you don\'t have access to the original string nor the copied string, but you do know the length of the strings and their numerical absolute difference. You will be given this difference as a hexadecimal string S, which has been zero-extended to be equal in length to the original and copied strings. Determine the smallest possible numerical value of the original string." 3300

865D "Buy Low Sell High" "constructive algorithms,data structures,greedy" "You can perfectly predict the price of a certain stock for the next N days. You would like to profit on this knowledge, but only want to transact one share of stock per day. That is, each day you will either buy one share, sell one share, or do nothing. Initially you own zero shares, and you cannot sell shares when you don\'t own any. At the end of the N days you would like to again own zero shares, but want to have as much money as possible." 2400

865C "Gotta Go Fast" "binary search,dp" "You\'re trying to set the record on your favorite video game. The game consists of N levels, which must be completed sequentially in order to beat the game. You usually complete each level as fast as possible, but sometimes finish a level slower. Specifically, you will complete the i-th level in either Fi seconds or Si seconds, where Fi\xe2\x80\x89<\xe2\x80\x89Si, and there\'s a Pi percent chance of completing it in Fi seconds. After completing a level, you may decide to either continue the game and play the next level, or reset the game and start again from the first level. Both the decision and the action are instant.Your goal is to complete all the levels sequentially in at most R total seconds. You want to minimize the expected amount of time playing before achieving that goal. If you continue and reset optimally, how much total time can you expect to spend playing?" 2400

865B "Ordering Pizza" "binary search,sortings,ternary search" "It\'s another Start[c]up finals, and that means there is pizza to order for the onsite contestants. There are only 2 types of pizza (obviously not, but let\'s just pretend for the sake of the problem), and all pizzas contain exactly S slices.It is known that the i-th contestant will eat si slices of pizza, and gain ai happiness for each slice of type 1 pizza they eat, and bi happiness for each slice of type 2 pizza they eat. We can order any number of type 1 and type 2 pizzas, but we want to buy the minimum possible number of pizzas for all of the contestants to be able to eat their required number of slices. Given that restriction, what is the maximum possible total happiness that can be achieved?" 1900

865A "Save the problem!" "constructive algorithms" "Attention: we lost all the test cases for this problem, so instead of solving the problem, we need you to generate test cases. We\'re going to give you the answer, and you need to print a test case that produces the given answer. The original problem is in the following paragraph.People don\'t use cash as often as they used to. Having a credit card solves some of the hassles of cash, such as having to receive change when you can\'t form the exact amount of money needed to purchase an item. Typically cashiers will give you as few coins as possible in change, but they don\'t have to. For example, if your change is 30 cents, a cashier could give you a 5 cent piece and a 25 cent piece, or they could give you three 10 cent pieces, or ten 1 cent pieces, two 5 cent pieces, and one 10 cent piece. Altogether there are 18 different ways to make 30 cents using only 1 cent pieces, 5 cent pieces, 10 cent pieces, and 25 cent pieces. Two ways are considered different if they contain a different number of at least one type of coin. Given the denominations of the coins and an amount of change to be made, how many different ways are there to make change?As we mentioned before, we lost all the test cases for this problem, so we\'re actually going to give you the number of ways, and want you to produce a test case for which the number of ways is the given number. There could be many ways to achieve this (we guarantee there\'s always at least one), so you can print any, as long as it meets the constraints described below." 1400

864F "Cities Excursions" "dfs and similar,graphs,trees" "There are n cities in Berland. Some pairs of them are connected with m directed roads. One can use only these roads to move from one city to another. There are no roads that connect a city to itself. For each pair of cities (x,\xe2\x80\x89y) there is at most one road from x to y.A path from city s to city t is a sequence of cities p1, p2, ... , pk, where p1\xe2\x80\x89=\xe2\x80\x89s, pk\xe2\x80\x89=\xe2\x80\x89t, and there is a road from city pi to city pi\xe2\x80\x89+\xe2\x80\x891 for each i from 1 to k\xe2\x80\x89-\xe2\x80\x891. The path can pass multiple times through each city except t. It can\'t pass through t more than once.A path p from s to t is ideal if it is the lexicographically minimal such path. In other words, p is ideal path from s to t if for any other path q from s to t pi\xe2\x80\x89<\xe2\x80\x89qi, where i is the minimum integer such that pi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89qi.There is a tourist agency in the country that offers q unusual excursions: the j-th excursion starts at city sj and ends in city tj. For each pair sj, tj help the agency to study the ideal path from sj to tj. Note that it is possible that there is no ideal path from sj to tj. This is possible due to two reasons:   there is no path from sj to tj;  there are paths from sj to tj, but for every such path p there is another path q from sj to tj, such that pi\xe2\x80\x89>\xe2\x80\x89qi, where i is the minimum integer for which pi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89qi. The agency would like to know for the ideal path from sj to tj the kj-th city in that path (on the way from sj to tj).For each triple sj, tj, kj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q) find if there is an ideal path from sj to tj and print the kj-th city in that path, if there is any." 2700

864E Fire dp,sortings "Polycarp is in really serious trouble \xe2\x80\x94 his house is on fire! It\'s time to save the most valuable items. Polycarp estimated that it would take ti seconds to save i-th item. In addition, for each item, he estimated the value of di \xe2\x80\x94 the moment after which the item i will be completely burned and will no longer be valuable for him at all. In particular, if ti\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89di, then i-th item cannot be saved.Given the values pi for each of the items, find a set of items that Polycarp can save such that the total value of this items is maximum possible. Polycarp saves the items one after another. For example, if he takes item a first, and then item b, then the item a will be saved in ta seconds, and the item b \xe2\x80\x94 in ta\xe2\x80\x89+\xe2\x80\x89tb seconds after fire started." 2000

864D "Make a Permutation!" greedy,implementation,math "Ivan has an array consisting of n elements. Each of the elements is an integer from 1 to n.Recently Ivan learned about permutations and their lexicographical order. Now he wants to change (replace) minimum number of elements in his array in such a way that his array becomes a permutation (i.e. each of the integers from 1 to n was encountered in his array exactly once). If there are multiple ways to do it he wants to find the lexicographically minimal permutation among them.Thus minimizing the number of changes has the first priority, lexicographical minimizing has the second priority.In order to determine which of the two permutations is lexicographically smaller, we compare their first elements. If they are equal \xe2\x80\x94 compare the second, and so on. If we have two permutations x and y, then x is lexicographically smaller if xi\xe2\x80\x89<\xe2\x80\x89yi, where i is the first index in which the permutations x and y differ.Determine the array Ivan will obtain after performing all the changes." 1500

864C Bus greedy,implementation,math "A bus moves along the coordinate line Ox from the point x\xe2\x80\x89=\xe2\x80\x890 to the point x\xe2\x80\x89=\xe2\x80\x89a. After starting from the point x\xe2\x80\x89=\xe2\x80\x890, it reaches the point x\xe2\x80\x89=\xe2\x80\x89a, immediately turns back and then moves to the point x\xe2\x80\x89=\xe2\x80\x890. After returning to the point x\xe2\x80\x89=\xe2\x80\x890 it immediately goes back to the point x\xe2\x80\x89=\xe2\x80\x89a and so on. Thus, the bus moves from x\xe2\x80\x89=\xe2\x80\x890 to x\xe2\x80\x89=\xe2\x80\x89a and back. Moving from the point x\xe2\x80\x89=\xe2\x80\x890 to x\xe2\x80\x89=\xe2\x80\x89a or from the point x\xe2\x80\x89=\xe2\x80\x89a to x\xe2\x80\x89=\xe2\x80\x890 is called a bus journey. In total, the bus must make k journeys.The petrol tank of the bus can hold b liters of gasoline. To pass a single unit of distance the bus needs to spend exactly one liter of gasoline. The bus starts its first journey with a full petrol tank.There is a gas station in point x\xe2\x80\x89=\xe2\x80\x89f. This point is between points x\xe2\x80\x89=\xe2\x80\x890 and x\xe2\x80\x89=\xe2\x80\x89a. There are no other gas stations on the bus route. While passing by a gas station in either direction the bus can stop and completely refuel its tank. Thus, after stopping to refuel the tank will contain b liters of gasoline.What is the minimum number of times the bus needs to refuel at the point x\xe2\x80\x89=\xe2\x80\x89f to make k journeys? The first journey starts in the point x\xe2\x80\x89=\xe2\x80\x890." 1500

864B "Polycarp and Letters" "brute force,implementation,strings" "Polycarp loves lowercase letters and dislikes uppercase ones. Once he got a string s consisting only of lowercase and uppercase Latin letters.Let A be a set of positions in the string. Let\'s call it pretty if following conditions are met:  letters on positions from A in the string are all distinct and lowercase;  there are no uppercase letters in the string which are situated between positions from A (i.e. there is no such j that s[j] is an uppercase letter, and a1\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89a2 for some a1 and a2 from A). Write a program that will determine the maximum number of elements in a pretty set of positions." 1000

864A "Fair Game" implementation,sortings "Petya and Vasya decided to play a game. They have n cards (n is an even number). A single integer is written on each card.Before the game Petya will choose an integer and after that Vasya will choose another integer (different from the number that Petya chose). During the game each player takes all the cards with number he chose. For example, if Petya chose number 5 before the game he will take all cards on which 5 is written and if Vasya chose number 10 before the game he will take all cards on which 10 is written.The game is considered fair if Petya and Vasya can take all n cards, and the number of cards each player gets is the same.Determine whether Petya and Vasya can choose integer numbers before the game so that the game is fair." 1000

863G "Graphic Settings" NA "Recently Ivan bought a new computer. Excited, he unpacked it and installed his favourite game. With his old computer Ivan had to choose the worst possible graphic settings (because otherwise the framerate would be really low), but now he wants to check, maybe his new computer can perform well even with the best possible graphics?There are m graphics parameters in the game. i-th parameter can be set to any positive integer from 1 to ai, and initially is set to bi (bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai). So there are  different combinations of parameters. Ivan can increase or decrease any of these parameters by 1; after that the game will be restarted with new parameters (and Ivan will have the opportunity to check chosen combination of parameters).Ivan wants to try all p possible combinations. Also he wants to return to the initial settings after trying all combinations, because he thinks that initial settings can be somehow best suited for his hardware. But Ivan doesn\'t really want to make a lot of restarts.So he wants you to tell the following:  If there exists a way to make exactly p changes (each change either decreases or increases some parameter by 1) to try all possible combinations and return to initial combination, then Ivan wants to know this way.  Otherwise, if there exists a way to make exactly p\xe2\x80\x89-\xe2\x80\x891 changes to try all possible combinations (including the initial one), then Ivan wants to know this way. Help Ivan by showing him the way to change parameters!" 3200

863F "Almost Permutation" flows "Recently Ivan noticed an array a while debugging his code. Now Ivan can\'t remember this array, but the bug he was trying to fix didn\'t go away, so Ivan thinks that the data from this array might help him to reproduce the bug.Ivan clearly remembers that there were n elements in the array, and each element was not less than 1 and not greater than n. Also he remembers q facts about the array. There are two types of facts that Ivan remembers:  1 li ri vi \xe2\x80\x94 for each x such that li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri ax\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89vi;  2 li ri vi \xe2\x80\x94 for each x such that li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri ax\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89vi. Also Ivan thinks that this array was a permutation, but he is not so sure about it. He wants to restore some array that corresponds to the q facts that he remembers and is very similar to permutation. Formally, Ivan has denoted the cost of array as follows:, where cnt(i) is the number of occurences of i in the array.Help Ivan to determine minimum possible cost of the array that corresponds to the facts!" 2200

863E "Turn Off The TV" "data structures,sortings" "Luba needs your help again! Luba has n TV sets. She knows that i-th TV set will be working from moment of time li till moment ri, inclusive.Luba wants to switch off one of TV sets in order to free the socket. Let\'s call some TV set redundant if after switching it off the number of integer moments of time when at least one of TV sets is working won\'t decrease. Luba will be very upset if she has to switch off a non-redundant TV set.Help Luba by telling her the index of some redundant TV set. If there is no any, print -1." 2000

863D "Yet Another Array Queries Problem" "data structures,implementation" "You are given an array a of size n, and q queries to it. There are queries of two types:   1 li ri \xe2\x80\x94 perform a cyclic shift of the segment [li,\xe2\x80\x89ri] to the right. That is, for every x such that li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89ri new value of ax\xe2\x80\x89+\xe2\x80\x891 becomes equal to old value of ax, and new value of ali becomes equal to old value of ari;  2 li ri \xe2\x80\x94 reverse the segment [li,\xe2\x80\x89ri].  There are m important indices in the array b1, b2, ..., bm. For each i such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m you have to output the number that will have index bi in the array after all queries are performed." 1800

863C 1-2-3 graphs,implementation "Ilya is working for the company that constructs robots. Ilya writes programs for entertainment robots, and his current project is ""Bob"", a new-generation game robot. Ilya\'s boss wants to know his progress so far. Especially he is interested if Bob is better at playing different games than the previous model, ""Alice"". So now Ilya wants to compare his robots\' performance in a simple game called ""1-2-3"". This game is similar to the ""Rock-Paper-Scissors"" game: both robots secretly choose a number from the set {1,\xe2\x80\x892,\xe2\x80\x893} and say it at the same moment. If both robots choose the same number, then it\'s a draw and noone gets any points. But if chosen numbers are different, then one of the robots gets a point: 3 beats 2, 2 beats 1 and 1 beats 3. Both robots\' programs make them choose their numbers in such a way that their choice in (i\xe2\x80\x89+\xe2\x80\x891)-th game depends only on the numbers chosen by them in i-th game. Ilya knows that the robots will play k games, Alice will choose number a in the first game, and Bob will choose b in the first game. He also knows both robots\' programs and can tell what each robot will choose depending on their choices in previous game. Ilya doesn\'t want to wait until robots play all k games, so he asks you to predict the number of points they will have after the final game." 1800

863B Kayaking "brute force,greedy,sortings" "Vadim is really keen on travelling. Recently he heard about kayaking activity near his town and became very excited about it, so he joined a party of kayakers.Now the party is ready to start its journey, but firstly they have to choose kayaks. There are 2\xc2\xb7n people in the group (including Vadim), and they have exactly n\xe2\x80\x89-\xe2\x80\x891 tandem kayaks (each of which, obviously, can carry two people) and 2 single kayaks. i-th person\'s weight is wi, and weight is an important matter in kayaking \xe2\x80\x94 if the difference between the weights of two people that sit in the same tandem kayak is too large, then it can crash. And, of course, people want to distribute their seats in kayaks in order to minimize the chances that kayaks will crash.Formally, the instability of a single kayak is always 0, and the instability of a tandem kayak is the absolute difference between weights of the people that are in this kayak. Instability of the whole journey is the total instability of all kayaks.Help the party to determine minimum possible total instability!" 1500

863A Quasi-palindrome "brute force,implementation" "Let quasi-palindromic number be such number that adding some leading zeros (possible none) to it produces a palindromic string. String t is called a palindrome, if it reads the same from left to right and from right to left.For example, numbers 131 and 2010200 are quasi-palindromic, they can be transformed to strings ""131"" and ""002010200"", respectively, which are palindromes.You are given some integer number x. Check if it\'s a quasi-palindromic number." 900

862F "Mahmoud and Ehab and the final stage" "data structures,strings" "Mahmoud and Ehab solved Dr. Evil\'s questions so he gave them the password of the door of the evil land. When they tried to open the door using it, the door gave them a final question to solve before they leave (yes, the door is digital, Dr. Evil is modern). If they don\'t solve it, all the work will be useless and they won\'t leave the evil land forever. Will you help them?Mahmoud and Ehab are given n strings s1,\xe2\x80\x89s2,\xe2\x80\x89... ,\xe2\x80\x89sn numbered from 1 to n and q queries, Each query has one of the following forms:  1 a b (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), For all the intervals [l;r] where (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) find the maximum value of this expression:(r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89*\xe2\x80\x89LCP(sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89... ,\xe2\x80\x89sr\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89sr) where LCP(str1,\xe2\x80\x89str2,\xe2\x80\x89str3,\xe2\x80\x89... ) is the length of the longest common prefix of the strings str1,\xe2\x80\x89str2,\xe2\x80\x89str3,\xe2\x80\x89... . 2 x y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) where y is a string, consisting of lowercase English letters. Change the string at position x to y." 2900

862E "Mahmoud and Ehab and the function" "binary search,data structures,sortings" "Dr. Evil is interested in math and functions, so he gave Mahmoud and Ehab array a of length n and array b of length m. He introduced a function f(j) which is defined for integers j, which satisfy 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x89n. Suppose, ci\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x89j. Then f(j)\xe2\x80\x89=\xe2\x80\x89|c1\xe2\x80\x89-\xe2\x80\x89c2\xe2\x80\x89+\xe2\x80\x89c3\xe2\x80\x89-\xe2\x80\x89c4... cn|. More formally, . Dr. Evil wants Mahmoud and Ehab to calculate the minimum value of this function over all valid j. They found it a bit easy, so Dr. Evil made their task harder. He will give them q update queries. During each update they should add an integer xi to all elements in a in range [li;ri] i.e. they should add xi to ali,\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89... ,\xe2\x80\x89ari and then they should calculate the minimum value of f(j) for all valid j.Please help Mahmoud and Ehab." 2100

862D "Mahmoud and Ehab and the binary string" "binary search,divide and conquer,interactive" "Mahmoud and Ehab are in the fourth stage now.Dr. Evil has a hidden binary string of length n. He guarantees that there is at least one \'0\' symbol and at least one \'1\' symbol in it. Now he wants Mahmoud and Ehab to find a position of any \'0\' symbol and any \'1\' symbol. In order to do this, Mahmoud and Ehab can ask Dr. Evil up to 15 questions. They tell Dr. Evil some binary string of length n, and Dr. Evil tells the Hamming distance between these two strings. Hamming distance between 2 binary strings of the same length is the number of positions in which they have different symbols. You can find the definition of Hamming distance in the notes section below.Help Mahmoud and Ehab find these two positions.You will get Wrong Answer verdict if   Your queries doesn\'t satisfy interaction protocol described below.  You ask strictly more than 15 questions and your program terminated after exceeding queries limit. Please note, that you can do up to 15 ask queries and one answer query.  Your final answer is not correct.  You will get Idleness Limit Exceeded if you don\'t print anything or if you forget to flush the output, including for the final answer (more info about flushing output below).If you exceed the maximum number of queries, You should terminate with 0, In this case you\'ll get Wrong Answer, If you don\'t terminate you may receive any verdict because you\'ll be reading from a closed stream ." 2000

862C "Mahmoud and Ehab and the xor" "constructive algorithms" "Mahmoud and Ehab are on the third stage of their adventures now. As you know, Dr. Evil likes sets. This time he won\'t show them any set from his large collection, but will ask them to create a new set to replenish his beautiful collection of sets.Dr. Evil has his favorite evil integer x. He asks Mahmoud and Ehab to find a set of n distinct non-negative integers such the bitwise-xor sum of the integers in it is exactly x. Dr. Evil doesn\'t like big numbers, so any number in the set shouldn\'t be greater than 106." 1900

862B "Mahmoud and Ehab and the bipartiteness" "dfs and similar,graphs,trees" "Mahmoud and Ehab continue their adventures! As everybody in the evil land knows, Dr. Evil likes bipartite graphs, especially trees.A tree is a connected acyclic graph. A bipartite graph is a graph, whose vertices can be partitioned into 2 sets in such a way, that for each edge (u,\xe2\x80\x89v) that belongs to the graph, u and v belong to different sets. You can find more formal definitions of a tree and a bipartite graph in the notes section below.Dr. Evil gave Mahmoud and Ehab a tree consisting of n nodes and asked them to add edges to it in such a way, that the graph is still bipartite. Besides, after adding these edges the graph should be simple (doesn\'t contain loops or multiple edges). What is the maximum number of edges they can add?A loop is an edge, which connects a node with itself. Graph doesn\'t contain multiple edges when for each pair of nodes there is no more than one edge between them. A cycle and a loop aren\'t the same ." 1300

862A "Mahmoud and Ehab and the MEX" greedy,implementation "Dr. Evil kidnapped Mahmoud and Ehab in the evil land because of their performance in the Evil Olympiad in Informatics (EOI). He decided to give them some problems to let them go.Dr. Evil is interested in sets, He has a set of n integers. Dr. Evil calls a set of integers evil if the MEX of it is exactly x. the MEX of a set of integers is the minimum non-negative integer that doesn\'t exist in it. For example, the MEX of the set {0,\xe2\x80\x892,\xe2\x80\x894} is 1 and the MEX of the set {1,\xe2\x80\x892,\xe2\x80\x893} is 0 .Dr. Evil is going to make his set evil. To do this he can perform some operations. During each operation he can add some non-negative integer to his set or erase some element from it. What is the minimal number of operations Dr. Evil has to perform to make his set evil?" 1000

860E "Arkady and a Nobody-men" "data structures,dfs and similar,trees" "Arkady words in a large company. There are n employees working in a system of a strict hierarchy. Namely, each employee, with an exception of the CEO, has exactly one immediate manager. The CEO is a manager (through a chain of immediate managers) of all employees.Each employee has an integer rank. The CEO has rank equal to 1, each other employee has rank equal to the rank of his immediate manager plus 1.Arkady has a good post in the company, however, he feels that he is nobody in the company\'s structure, and there are a lot of people who can replace him. He introduced the value of replaceability. Consider an employee a and an employee b, the latter being manager of a (not necessarily immediate). Then the replaceability r(a,\xe2\x80\x89b) of a with respect to b is the number of subordinates (not necessarily immediate) of the manager b, whose rank is not greater than the rank of a. Apart from replaceability, Arkady introduced the value of negligibility. The negligibility za of employee a equals the sum of his replaceabilities with respect to all his managers, i.e. , where the sum is taken over all his managers b.Arkady is interested not only in negligibility of himself, but also in negligibility of all employees in the company. Find the negligibility of each employee for Arkady." 2700

859G "Circle of Numbers" math "n evenly spaced points have been marked around the edge of a circle. There is a number written at each point. You choose a positive real number k. Then you may repeatedly select a set of 2 or more points which are evenly spaced, and either increase all numbers at points in the set by k or decrease all numbers at points in the set by k. You would like to eventually end up with all numbers equal to 0. Is it possible?A set of 2 points is considered evenly spaced if they are diametrically opposed, and a set of 3 or more points is considered evenly spaced if they form a regular polygon." 3000

859F "Ordering T-Shirts" greedy "It\'s another Start[c]up, and that means there are T-shirts to order. In order to make sure T-shirts are shipped as soon as possible, we\'ve decided that this year we\'re going to order all of the necessary T-shirts before the actual competition. The top C contestants are going to be awarded T-shirts, but we obviously don\'t know which contestants that will be. The plan is to get the T-Shirt sizes of all contestants before the actual competition, and then order enough T-shirts so that no matter who is in the top C we\'ll have T-shirts available in order to award them.In order to get the T-shirt sizes of the contestants, we will send out a survey. The survey will allow contestants to either specify a single desired T-shirt size, or two adjacent T-shirt sizes. If a contestant specifies two sizes, it means that they can be awarded either size.As you can probably tell, this plan could require ordering a lot of unnecessary T-shirts. We\'d like your help to determine the minimum number of T-shirts we\'ll need to order to ensure that we\'ll be able to award T-shirts no matter the outcome of the competition." 2800

859E "Desk Disorder" "combinatorics,dfs and similar,dsu,graphs,trees" "A new set of desks just arrived, and it\'s about time! Things were getting quite cramped in the office. You\'ve been put in charge of creating a new seating chart for the engineers. The desks are numbered, and you sent out a survey to the engineering team asking each engineer the number of the desk they currently sit at, and the number of the desk they would like to sit at (which may be the same as their current desk). Each engineer must either remain where they sit, or move to the desired seat they indicated in the survey. No two engineers currently sit at the same desk, nor may any two engineers sit at the same desk in the new seating arrangement.How many seating arrangements can you create that meet the specified requirements? The answer may be very large, so compute it modulo 1000000007\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897." 2100

859D "Third Month Insanity" dp,probabilities,trees "The annual college sports-ball tournament is approaching, which for trademark reasons we\'ll refer to as Third Month Insanity. There are a total of 2N teams participating in the tournament, numbered from 1 to 2N. The tournament lasts N rounds, with each round eliminating half the teams. The first round consists of 2N\xe2\x80\x89-\xe2\x80\x891 games, numbered starting from 1. In game i, team 2\xc2\xb7i\xe2\x80\x89-\xe2\x80\x891 will play against team 2\xc2\xb7i. The loser is eliminated and the winner advances to the next round (there are no ties). Each subsequent round has half as many games as the previous round, and in game i the winner of the previous round\'s game 2\xc2\xb7i\xe2\x80\x89-\xe2\x80\x891 will play against the winner of the previous round\'s game 2\xc2\xb7i.Every year the office has a pool to see who can create the best bracket. A bracket is a set of winner predictions for every game. For games in the first round you may predict either team to win, but for games in later rounds the winner you predict must also be predicted as a winner in the previous round. Note that the bracket is fully constructed before any games are actually played. Correct predictions in the first round are worth 1 point, and correct predictions in each subsequent round are worth twice as many points as the previous, so correct predictions in the final game are worth 2N\xe2\x80\x89-\xe2\x80\x891 points.For every pair of teams in the league, you have estimated the probability of each team winning if they play against each other. Now you want to construct a bracket with the maximum possible expected score." 2100

859C "Pie Rules" dp,games "You may have heard of the pie rule before. It states that if two people wish to fairly share a slice of pie, one person should cut the slice in half, and the other person should choose who gets which slice. Alice and Bob have many slices of pie, and rather than cutting the slices in half, each individual slice will be eaten by just one person.The way Alice and Bob decide who eats each slice is as follows. First, the order in which the pies are to be handed out is decided. There is a special token called the ""decider"" token, initially held by Bob. Until all the pie is handed out, whoever has the decider token will give the next slice of pie to one of the participants, and the decider token to the other participant. They continue until no slices of pie are left.All of the slices are of excellent quality, so each participant obviously wants to maximize the total amount of pie they get to eat. Assuming both players make their decisions optimally, how much pie will each participant receive?" 1500

859B "Lazy Security Guard" "brute force,geometry,math" "Your security guard friend recently got a new job at a new security company. The company requires him to patrol an area of the city encompassing exactly N city blocks, but they let him choose which blocks. That is, your friend must walk the perimeter of a region whose area is exactly N blocks. Your friend is quite lazy and would like your help to find the shortest possible route that meets the requirements. The city is laid out in a square grid pattern, and is large enough that for the sake of the problem it can be considered infinite." 1000

859A "Declined Finalists" greedy,implementation "This year, as in previous years, MemSQL is inviting the top 25 competitors from the Start[c]up qualification round to compete onsite for the final round. Not everyone who is eligible to compete onsite can afford to travel to the office, though. Initially the top 25 contestants are invited to come onsite. Each eligible contestant must either accept or decline the invitation. Whenever a contestant declines, the highest ranked contestant not yet invited is invited to take the place of the one that declined. This continues until 25 contestants have accepted invitations.After the qualifying round completes, you know K of the onsite finalists, as well as their qualifying ranks (which start at 1, there are no ties). Determine the minimum possible number of contestants that declined the invitation to compete onsite in the final round." 800

858F "Wizard\'s Tour" "constructive algorithms,dfs and similar,graphs" "This year, as in previous years, MemSQL is inviting the top 25 competitors from the Start[c]up qualification round to compete onsite for the final round. Not everyone who is eligible to compete onsite can afford to travel to the office, though. Initially the top 25 contestants are invited to come onsite. Each eligible contestant must either accept or decline the invitation. Whenever a contestant declines, the highest ranked contestant not yet invited is invited to take the place of the one that declined. This continues until 25 contestants have accepted invitations.After the qualifying round completes, you know K of the onsite finalists, as well as their qualifying ranks (which start at 1, there are no ties). Determine the minimum possible number of contestants that declined the invitation to compete onsite in the final round." 2300

858E "Tests Renumeration" greedy,implementation "The All-Berland National Olympiad in Informatics has just ended! Now Vladimir wants to upload the contest from the Olympiad as a gym to a popular Codehorses website.Unfortunately, the archive with Olympiad\'s data is a mess. For example, the files with tests are named arbitrary without any logic.Vladimir wants to rename the files with tests so that their names are distinct integers starting from 1 without any gaps, namely, ""1"", ""2"", ..., ""n\', where n is the total number of tests.Some of the files contain tests from statements (examples), while others contain regular tests. It is possible that there are no examples, and it is possible that all tests are examples. Vladimir wants to rename the files so that the examples are the first several tests, all all the next files contain regular tests only.The only operation Vladimir can perform is the ""move"" command. Vladimir wants to write a script file, each of the lines in which is ""move file_1 file_2"", that means that the file ""file_1"" is to be renamed to ""file_2"". If there is a file ""file_2"" at the moment of this line being run, then this file is to be rewritten. After the line ""move file_1 file_2"" the file ""file_1"" doesn\'t exist, but there is a file ""file_2"" with content equal to the content of ""file_1"" before the ""move"" command.Help Vladimir to write the script file with the minimum possible number of lines so that after this script is run:  all examples are the first several tests having filenames ""1"", ""2"", ..., ""e"", where e is the total number of examples;  all other files contain regular tests with filenames ""e\xe2\x80\x89+\xe2\x80\x891"", ""e\xe2\x80\x89+\xe2\x80\x892"", ..., ""n"", where n is the total number of all tests." 2200

858D "Polycarp\'s phone book" "data structures,implementation,sortings" "The All-Berland National Olympiad in Informatics has just ended! Now Vladimir wants to upload the contest from the Olympiad as a gym to a popular Codehorses website.Unfortunately, the archive with Olympiad\'s data is a mess. For example, the files with tests are named arbitrary without any logic.Vladimir wants to rename the files with tests so that their names are distinct integers starting from 1 without any gaps, namely, ""1"", ""2"", ..., ""n\', where n is the total number of tests.Some of the files contain tests from statements (examples), while others contain regular tests. It is possible that there are no examples, and it is possible that all tests are examples. Vladimir wants to rename the files so that the examples are the first several tests, all all the next files contain regular tests only.The only operation Vladimir can perform is the ""move"" command. Vladimir wants to write a script file, each of the lines in which is ""move file_1 file_2"", that means that the file ""file_1"" is to be renamed to ""file_2"". If there is a file ""file_2"" at the moment of this line being run, then this file is to be rewritten. After the line ""move file_1 file_2"" the file ""file_1"" doesn\'t exist, but there is a file ""file_2"" with content equal to the content of ""file_1"" before the ""move"" command.Help Vladimir to write the script file with the minimum possible number of lines so that after this script is run:  all examples are the first several tests having filenames ""1"", ""2"", ..., ""e"", where e is the total number of examples;  all other files contain regular tests with filenames ""e\xe2\x80\x89+\xe2\x80\x891"", ""e\xe2\x80\x89+\xe2\x80\x892"", ..., ""n"", where n is the total number of all tests." 1600

858C "Did you mean..." dp,greedy,implementation "Beroffice text editor has a wide range of features that help working with text. One of the features is an automatic search for typos and suggestions of how to fix them.Beroffice works only with small English letters (i.e. with 26 letters from a to z). Beroffice thinks that a word is typed with a typo if there are three or more consonants in a row in the word. The only exception is that if the block of consonants has all letters the same, then this block (even if its length is greater than three) is not considered a typo. Formally, a word is typed with a typo if there is a block of not less that three consonants in a row, and there are at least two different letters in this block.For example:  the following words have typos: ""hellno"", ""hackcerrs"" and ""backtothefutttture"";  the following words don\'t have typos: ""helllllooooo"", ""tobeornottobe"" and ""oooooo"". When Beroffice editor finds a word with a typo, it inserts as little as possible number of spaces in this word (dividing it into several words) in such a way that each of the resulting words is typed without any typos.Implement this feature of Beroffice editor. Consider the following letters as the only vowels: \'a\', \'e\', \'i\', \'o\' and \'u\'. All the other letters are consonants in this problem." 1500

858B "Which floor?" "brute force,implementation" "In a building where Polycarp lives there are equal number of flats on each floor. Unfortunately, Polycarp don\'t remember how many flats are on each floor, but he remembers that the flats are numbered from 1 from lower to upper floors. That is, the first several flats are on the first floor, the next several flats are on the second and so on. Polycarp don\'t remember the total number of flats in the building, so you can consider the building to be infinitely high (i.e. there are infinitely many floors). Note that the floors are numbered from 1.Polycarp remembers on which floors several flats are located. It is guaranteed that this information is not self-contradictory. It means that there exists a building with equal number of flats on each floor so that the flats from Polycarp\'s memory have the floors Polycarp remembers.Given this information, is it possible to restore the exact floor for flat n?" 1500

858A k-rounding "brute force,math,number theory" "For a given positive integer n denote its k-rounding as the minimum positive integer x, such that x ends with k or more zeros in base 10 and is divisible by n.For example, 4-rounding of 375 is 375\xc2\xb780\xe2\x80\x89=\xe2\x80\x8930000. 30000 is the minimum integer such that it ends with 4 or more zeros and is divisible by 375.Write a program that will perform the k-rounding of n." 1100

856F "To Play or not to Play" greedy "Vasya and Petya are playing an online game. As most online games, it has hero progress system that allows players to gain experience that make their heroes stronger. Of course, Vasya would like to get as many experience points as possible. After careful study of experience points allocation, he found out that if he plays the game alone, he gets one experience point each second. However, if two players are playing together, and their current experience values differ by at most C points, they can boost their progress, and each of them gets 2 experience points each second.Since Vasya and Petya are middle school students, their parents don\'t allow them to play all the day around. Each of the friends has his own schedule: Vasya can only play during intervals [a1;b1],\xe2\x80\x89[a2;b2],\xe2\x80\x89...,\xe2\x80\x89[an;bn], and Petya can only play during intervals [c1;d1],\xe2\x80\x89[c2;d2],\xe2\x80\x89...,\xe2\x80\x89[cm;dm]. All time periods are given in seconds from the current moment. Vasya is good in math, so he has noticed that sometimes it can be profitable not to play alone, because experience difference could become too big, and progress would not be boosted even when played together.Now they would like to create such schedule of playing that Vasya\'s final experience was greatest possible. The current players experience is the same. Petya is not so concerned about his experience, so he is ready to cooperate and play when needed to maximize Vasya\'s experience." 3000

856E Satellites NA "Real Cosmic Communications is the largest telecommunication company on a far far away planet, located at the very edge of the universe. RCC launches communication satellites.The planet is at the very edge of the universe, so its form is half of a circle. Its radius is r, the ends of its diameter are points A and B. The line AB is the edge of the universe, so one of the half-planes contains nothing, neither the planet, nor RCC satellites, nor anything else. Let us introduce coordinates in the following way: the origin is at the center of AB segment, OX axis coincides with line AB, the planet is completely in y\xe2\x80\x89>\xe2\x80\x890 half-plane.The satellite can be in any point of the universe, except the planet points. Satellites are never located beyond the edge of the universe, nor on the edge itself \xe2\x80\x94 that is, they have coordinate y\xe2\x80\x89>\xe2\x80\x890. Satellite antennas are directed in such way that they cover the angle with the vertex in the satellite, and edges directed to points A and B. Let us call this area the satellite coverage area. The picture below shows coordinate system and coverage area of a satellite.  When RCC was founded there were no satellites around the planet. Since then there have been several events of one of the following types:   1 x y�\xe2\x80\x94 launch the new satellite and put it to the point (x,\xe2\x80\x89y). Satellites never move and stay at the point they were launched. Let us assign the number i to the i-th satellite in order of launching, starting from one.  2 i�\xe2\x80\x94 remove satellite number i.  3 i j�\xe2\x80\x94 make an attempt to create a communication channel between satellites i and j. To create a communication channel a repeater is required. It must not be located inside the planet, but can be located at its half-circle border, or above it. Repeater must be in coverage area of both satellites i and j. To avoid signal interference, it must not be located in coverage area of any other satellite. Of course, the repeater must be within the universe, it must have a coordinate y\xe2\x80\x89>\xe2\x80\x890. For each attempt to create a communication channel you must find out whether it is possible.Sample test has the following satellites locations:" 3100

856D "Masha and Cactus" dp,trees "Masha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree.Recall that tree is a connected undirected graph that has no cycles. Cactus is a connected undirected graph such that each vertex belongs to at most one cycle.Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and the beauty of this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus. Beauty of the resulting cactus is sum of beauties of all added edges. Help Masha find out what maximum beauty of the resulting cactus she can achieve." 2400

856C "Eleventh Birthday" combinatorics,dp,math "It is Borya\'s eleventh birthday, and he has got a great present: n cards with numbers. The i-th card has the number ai written on it. Borya wants to put his cards in a row to get one greater number. For example, if Borya has cards with numbers 1, 31, and 12, and he puts them in a row in this order, he would get a number 13112.He is only 11, but he already knows that there are n! ways to put his cards in a row. But today is a special day, so he is only interested in such ways that the resulting big number is divisible by eleven. So, the way from the previous paragraph is good, because 13112\xe2\x80\x89=\xe2\x80\x891192\xe2\x80\x89\xc3\x97\xe2\x80\x8911, but if he puts the cards in the following order: 31, 1, 12, he would get a number 31112, it is not divisible by 11, so this way is not good for Borya. Help Borya to find out how many good ways to put the cards are there.Borya considers all cards different, even if some of them contain the same number. For example, if Borya has two cards with 1 on it, there are two good ways.Help Borya, find the number of good ways to put the cards. This number can be large, so output it modulo 998244353." 2400

856B "Similar Words" dp,hashing,strings,trees "Let us call a non-empty sequence of lowercase English letters a word. Prefix of a word x is a word y that can be obtained from x by removing zero or more last letters of x.Let us call two words similar, if one of them can be obtained from the other by removing its first letter.You are given a set S of words. Find the maximal possible size of set of non-empty words X such that they satisfy the following:   each word of X is prefix of some word from S;  X has no similar words." 2300

856A "Set Theory" "brute force,constructive algorithms" "Masha and Grisha like studying sets of positive integers.One day Grisha has written a set A containing n different integers ai on a blackboard. Now he asks Masha to create a set B containing n different integers bj such that all n2 integers that can be obtained by summing up ai and bj for all possible pairs of i and j are different.Both Masha and Grisha don\'t like big numbers, so all numbers in A are from 1 to 106, and all numbers in B must also be in the same range.Help Masha to create the set B that satisfies Grisha\'s requirement." 1600

855G "Harry Vs Voldemort" "dfs and similar,dp,graphs,trees" "After destroying all of Voldemort\'s Horcruxes, Harry and Voldemort are up for the final battle. They each cast spells from their wands and the spells collide.The battle scene is Hogwarts, which can be represented in the form of a tree. There are, in total, n places in Hogwarts joined using n\xe2\x80\x89-\xe2\x80\x891 undirected roads.Ron, who was viewing this battle between Harry and Voldemort, wondered how many triplets of places (u,\xe2\x80\x89v,\xe2\x80\x89w) are there such that if Harry is standing at place u and Voldemort is standing at place v, their spells collide at a place w. This is possible for a triplet only when u, v and w are distinct, and there exist paths from u to w and from v to w which do not pass through the same roads.Now, due to the battle havoc, new paths are being added all the time. You have to tell Ron the answer after each addition.Formally, you are given a tree with n vertices and n\xe2\x80\x89-\xe2\x80\x891 edges. q new edges are being added between the nodes of the tree. After each addition you need to tell the number of triplets (u,\xe2\x80\x89v,\xe2\x80\x89w) such that u, v and w are distinct and there exist two paths, one between u and w, another between v and w such that these paths do not have an edge in common." 3300

855F Nagini "binary search,data structures" "Nagini, being a horcrux You-know-who created with the murder of Bertha Jorkins, has accumulated its army of snakes and is launching an attack on Hogwarts school. Hogwarts\' entrance can be imagined as a straight line (x-axis) from 1 to 105. Nagini is launching various snakes at the Hogwarts entrance. Each snake lands parallel to the entrance, covering a segment at a distance k from x\xe2\x80\x89=\xe2\x80\x89l to x\xe2\x80\x89=\xe2\x80\x89r. Formally, each snake can be imagined as being a line segment between points (l,\xe2\x80\x89k) and (r,\xe2\x80\x89k). Note that k can be both positive and negative, but not 0.Let, at some x-coordinate x\xe2\x80\x89=\xe2\x80\x89i, there be snakes at point (i,\xe2\x80\x89y1) and point (i,\xe2\x80\x89y2), such that y1\xe2\x80\x89>\xe2\x80\x890 and y2\xe2\x80\x89<\xe2\x80\x890. Then, if for any point (i,\xe2\x80\x89y3) containing a snake such that y3\xe2\x80\x89>\xe2\x80\x890, y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y3 holds and for any point (i,\xe2\x80\x89y4) containing a snake such that y4\xe2\x80\x89<\xe2\x80\x890, |y2|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|y4| holds, then the danger value at coordinate x\xe2\x80\x89=\xe2\x80\x89i is y1\xe2\x80\x89+\xe2\x80\x89|y2|. If no such y1 and y2 exist, danger value is 0. Harry wants to calculate the danger value of various segments of the Hogwarts entrance. Danger value for a segment [l,\xe2\x80\x89r) of the entrance can be calculated by taking the sum of danger values for each integer x-coordinate present in the segment.Formally, you have to implement two types of queries:  1 l r k: a snake is added parallel to entrance from x\xe2\x80\x89=\xe2\x80\x89l to x\xe2\x80\x89=\xe2\x80\x89r at y-coordinate y\xe2\x80\x89=\xe2\x80\x89k (l inclusive, r exclusive).  2 l r: you have to calculate the danger value of segment l to r (l inclusive, r exclusive)." 3100

855E "Salazar Slytherin\'s Locket" bitmasks,dp "Nagini, being a horcrux You-know-who created with the murder of Bertha Jorkins, has accumulated its army of snakes and is launching an attack on Hogwarts school. Hogwarts\' entrance can be imagined as a straight line (x-axis) from 1 to 105. Nagini is launching various snakes at the Hogwarts entrance. Each snake lands parallel to the entrance, covering a segment at a distance k from x\xe2\x80\x89=\xe2\x80\x89l to x\xe2\x80\x89=\xe2\x80\x89r. Formally, each snake can be imagined as being a line segment between points (l,\xe2\x80\x89k) and (r,\xe2\x80\x89k). Note that k can be both positive and negative, but not 0.Let, at some x-coordinate x\xe2\x80\x89=\xe2\x80\x89i, there be snakes at point (i,\xe2\x80\x89y1) and point (i,\xe2\x80\x89y2), such that y1\xe2\x80\x89>\xe2\x80\x890 and y2\xe2\x80\x89<\xe2\x80\x890. Then, if for any point (i,\xe2\x80\x89y3) containing a snake such that y3\xe2\x80\x89>\xe2\x80\x890, y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y3 holds and for any point (i,\xe2\x80\x89y4) containing a snake such that y4\xe2\x80\x89<\xe2\x80\x890, |y2|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|y4| holds, then the danger value at coordinate x\xe2\x80\x89=\xe2\x80\x89i is y1\xe2\x80\x89+\xe2\x80\x89|y2|. If no such y1 and y2 exist, danger value is 0. Harry wants to calculate the danger value of various segments of the Hogwarts entrance. Danger value for a segment [l,\xe2\x80\x89r) of the entrance can be calculated by taking the sum of danger values for each integer x-coordinate present in the segment.Formally, you have to implement two types of queries:  1 l r k: a snake is added parallel to entrance from x\xe2\x80\x89=\xe2\x80\x89l to x\xe2\x80\x89=\xe2\x80\x89r at y-coordinate y\xe2\x80\x89=\xe2\x80\x89k (l inclusive, r exclusive).  2 l r: you have to calculate the danger value of segment l to r (l inclusive, r exclusive)." 2200

855D "Rowena Ravenclaw\'s Diadem" trees "Nagini, being a horcrux You-know-who created with the murder of Bertha Jorkins, has accumulated its army of snakes and is launching an attack on Hogwarts school. Hogwarts\' entrance can be imagined as a straight line (x-axis) from 1 to 105. Nagini is launching various snakes at the Hogwarts entrance. Each snake lands parallel to the entrance, covering a segment at a distance k from x\xe2\x80\x89=\xe2\x80\x89l to x\xe2\x80\x89=\xe2\x80\x89r. Formally, each snake can be imagined as being a line segment between points (l,\xe2\x80\x89k) and (r,\xe2\x80\x89k). Note that k can be both positive and negative, but not 0.Let, at some x-coordinate x\xe2\x80\x89=\xe2\x80\x89i, there be snakes at point (i,\xe2\x80\x89y1) and point (i,\xe2\x80\x89y2), such that y1\xe2\x80\x89>\xe2\x80\x890 and y2\xe2\x80\x89<\xe2\x80\x890. Then, if for any point (i,\xe2\x80\x89y3) containing a snake such that y3\xe2\x80\x89>\xe2\x80\x890, y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y3 holds and for any point (i,\xe2\x80\x89y4) containing a snake such that y4\xe2\x80\x89<\xe2\x80\x890, |y2|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|y4| holds, then the danger value at coordinate x\xe2\x80\x89=\xe2\x80\x89i is y1\xe2\x80\x89+\xe2\x80\x89|y2|. If no such y1 and y2 exist, danger value is 0. Harry wants to calculate the danger value of various segments of the Hogwarts entrance. Danger value for a segment [l,\xe2\x80\x89r) of the entrance can be calculated by taking the sum of danger values for each integer x-coordinate present in the segment.Formally, you have to implement two types of queries:  1 l r k: a snake is added parallel to entrance from x\xe2\x80\x89=\xe2\x80\x89l to x\xe2\x80\x89=\xe2\x80\x89r at y-coordinate y\xe2\x80\x89=\xe2\x80\x89k (l inclusive, r exclusive).  2 l r: you have to calculate the danger value of segment l to r (l inclusive, r exclusive)." 2500

855C "Helga Hufflepuff\'s Cup" dp,trees "Nagini, being a horcrux You-know-who created with the murder of Bertha Jorkins, has accumulated its army of snakes and is launching an attack on Hogwarts school. Hogwarts\' entrance can be imagined as a straight line (x-axis) from 1 to 105. Nagini is launching various snakes at the Hogwarts entrance. Each snake lands parallel to the entrance, covering a segment at a distance k from x\xe2\x80\x89=\xe2\x80\x89l to x\xe2\x80\x89=\xe2\x80\x89r. Formally, each snake can be imagined as being a line segment between points (l,\xe2\x80\x89k) and (r,\xe2\x80\x89k). Note that k can be both positive and negative, but not 0.Let, at some x-coordinate x\xe2\x80\x89=\xe2\x80\x89i, there be snakes at point (i,\xe2\x80\x89y1) and point (i,\xe2\x80\x89y2), such that y1\xe2\x80\x89>\xe2\x80\x890 and y2\xe2\x80\x89<\xe2\x80\x890. Then, if for any point (i,\xe2\x80\x89y3) containing a snake such that y3\xe2\x80\x89>\xe2\x80\x890, y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y3 holds and for any point (i,\xe2\x80\x89y4) containing a snake such that y4\xe2\x80\x89<\xe2\x80\x890, |y2|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|y4| holds, then the danger value at coordinate x\xe2\x80\x89=\xe2\x80\x89i is y1\xe2\x80\x89+\xe2\x80\x89|y2|. If no such y1 and y2 exist, danger value is 0. Harry wants to calculate the danger value of various segments of the Hogwarts entrance. Danger value for a segment [l,\xe2\x80\x89r) of the entrance can be calculated by taking the sum of danger values for each integer x-coordinate present in the segment.Formally, you have to implement two types of queries:  1 l r k: a snake is added parallel to entrance from x\xe2\x80\x89=\xe2\x80\x89l to x\xe2\x80\x89=\xe2\x80\x89r at y-coordinate y\xe2\x80\x89=\xe2\x80\x89k (l inclusive, r exclusive).  2 l r: you have to calculate the danger value of segment l to r (l inclusive, r exclusive)." 2000

855B "Marvolo Gaunt\'s Ring" "brute force,data structures,dp" "Nagini, being a horcrux You-know-who created with the murder of Bertha Jorkins, has accumulated its army of snakes and is launching an attack on Hogwarts school. Hogwarts\' entrance can be imagined as a straight line (x-axis) from 1 to 105. Nagini is launching various snakes at the Hogwarts entrance. Each snake lands parallel to the entrance, covering a segment at a distance k from x\xe2\x80\x89=\xe2\x80\x89l to x\xe2\x80\x89=\xe2\x80\x89r. Formally, each snake can be imagined as being a line segment between points (l,\xe2\x80\x89k) and (r,\xe2\x80\x89k). Note that k can be both positive and negative, but not 0.Let, at some x-coordinate x\xe2\x80\x89=\xe2\x80\x89i, there be snakes at point (i,\xe2\x80\x89y1) and point (i,\xe2\x80\x89y2), such that y1\xe2\x80\x89>\xe2\x80\x890 and y2\xe2\x80\x89<\xe2\x80\x890. Then, if for any point (i,\xe2\x80\x89y3) containing a snake such that y3\xe2\x80\x89>\xe2\x80\x890, y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y3 holds and for any point (i,\xe2\x80\x89y4) containing a snake such that y4\xe2\x80\x89<\xe2\x80\x890, |y2|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|y4| holds, then the danger value at coordinate x\xe2\x80\x89=\xe2\x80\x89i is y1\xe2\x80\x89+\xe2\x80\x89|y2|. If no such y1 and y2 exist, danger value is 0. Harry wants to calculate the danger value of various segments of the Hogwarts entrance. Danger value for a segment [l,\xe2\x80\x89r) of the entrance can be calculated by taking the sum of danger values for each integer x-coordinate present in the segment.Formally, you have to implement two types of queries:  1 l r k: a snake is added parallel to entrance from x\xe2\x80\x89=\xe2\x80\x89l to x\xe2\x80\x89=\xe2\x80\x89r at y-coordinate y\xe2\x80\x89=\xe2\x80\x89k (l inclusive, r exclusive).  2 l r: you have to calculate the danger value of segment l to r (l inclusive, r exclusive)." 1500

855A "Tom Riddle\'s Diary" "brute force,implementation,strings" "Nagini, being a horcrux You-know-who created with the murder of Bertha Jorkins, has accumulated its army of snakes and is launching an attack on Hogwarts school. Hogwarts\' entrance can be imagined as a straight line (x-axis) from 1 to 105. Nagini is launching various snakes at the Hogwarts entrance. Each snake lands parallel to the entrance, covering a segment at a distance k from x\xe2\x80\x89=\xe2\x80\x89l to x\xe2\x80\x89=\xe2\x80\x89r. Formally, each snake can be imagined as being a line segment between points (l,\xe2\x80\x89k) and (r,\xe2\x80\x89k). Note that k can be both positive and negative, but not 0.Let, at some x-coordinate x\xe2\x80\x89=\xe2\x80\x89i, there be snakes at point (i,\xe2\x80\x89y1) and point (i,\xe2\x80\x89y2), such that y1\xe2\x80\x89>\xe2\x80\x890 and y2\xe2\x80\x89<\xe2\x80\x890. Then, if for any point (i,\xe2\x80\x89y3) containing a snake such that y3\xe2\x80\x89>\xe2\x80\x890, y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y3 holds and for any point (i,\xe2\x80\x89y4) containing a snake such that y4\xe2\x80\x89<\xe2\x80\x890, |y2|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|y4| holds, then the danger value at coordinate x\xe2\x80\x89=\xe2\x80\x89i is y1\xe2\x80\x89+\xe2\x80\x89|y2|. If no such y1 and y2 exist, danger value is 0. Harry wants to calculate the danger value of various segments of the Hogwarts entrance. Danger value for a segment [l,\xe2\x80\x89r) of the entrance can be calculated by taking the sum of danger values for each integer x-coordinate present in the segment.Formally, you have to implement two types of queries:  1 l r k: a snake is added parallel to entrance from x\xe2\x80\x89=\xe2\x80\x89l to x\xe2\x80\x89=\xe2\x80\x89r at y-coordinate y\xe2\x80\x89=\xe2\x80\x89k (l inclusive, r exclusive).  2 l r: you have to calculate the danger value of segment l to r (l inclusive, r exclusive)." 800

854B "Maxim Buys an Apartment" "constructive algorithms,math" "Maxim wants to buy an apartment in a new house at Line Avenue of Metropolis. The house has n apartments that are numbered from 1 to n and are arranged in a row. Two apartments are adjacent if their indices differ by 1. Some of the apartments can already be inhabited, others are available for sale.Maxim often visits his neighbors, so apartment is good for him if it is available for sale and there is at least one already inhabited apartment adjacent to it. Maxim knows that there are exactly k already inhabited apartments, but he doesn\'t know their indices yet.Find out what could be the minimum possible and the maximum possible number of apartments that are good for Maxim." 1200

854A Fraction "brute force,constructive algorithms,math" "Petya is a big fan of mathematics, especially its part related to fractions. Recently he learned that a fraction  is called proper iff its numerator is smaller than its denominator (a\xe2\x80\x89<\xe2\x80\x89b) and that the fraction is called irreducible if its numerator and its denominator are coprime (they do not have positive common divisors except 1).During his free time, Petya thinks about proper irreducible fractions and converts them to decimals using the calculator. One day he mistakenly pressed addition button (\xe2\x80\x89+\xe2\x80\x89) instead of division button (\xc3\xb7) and got sum of numerator and denominator that was equal to n instead of the expected decimal notation. Petya wanted to restore the original fraction, but soon he realized that it might not be done uniquely. That\'s why he decided to determine maximum possible proper irreducible fraction  such that sum of its numerator and denominator equals n. Help Petya deal with this problem." 800

853E "Lada Malina" "data structures,geometry" "After long-term research and lots of experiments leading Megapolian automobile manufacturer \xc2\xabAutoVoz\xc2\xbb released a brand new car model named \xc2\xabLada Malina\xc2\xbb. One of the most impressive features of \xc2\xabLada Malina\xc2\xbb is its highly efficient environment-friendly engines.Consider car as a point in Oxy plane. Car is equipped with k engines numbered from 1 to k. Each engine is defined by its velocity vector whose coordinates are (vxi,\xe2\x80\x89vyi) measured in distance units per day. An engine may be turned on at any level wi, that is a real number between \xe2\x80\x89-\xe2\x80\x891 and \xe2\x80\x89+\xe2\x80\x891 (inclusive) that result in a term of (wi\xc2\xb7vxi,\xe2\x80\x89wi\xc2\xb7vyi) in the final car velocity. Namely, the final car velocity is equal to (w1\xc2\xb7vx1\xe2\x80\x89+\xe2\x80\x89w2\xc2\xb7vx2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89wk\xc2\xb7vxk,\xe2\x80\x89��w1\xc2\xb7vy1\xe2\x80\x89+\xe2\x80\x89w2\xc2\xb7vy2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89wk\xc2\xb7vyk) Formally, if car moves with constant values of wi during the whole day then its x-coordinate will change by the first component of an expression above, and its y-coordinate will change by the second component of an expression above. For example, if all wi are equal to zero, the car won\'t move, and if all wi are equal to zero except w1\xe2\x80\x89=\xe2\x80\x891, then car will move with the velocity of the first engine.There are n factories in Megapolia, i-th of them is located in (fxi,\xe2\x80\x89fyi). On the i-th factory there are ai cars \xc2\xabLada Malina\xc2\xbb that are ready for operation.As an attempt to increase sales of a new car, \xc2\xabAutoVoz\xc2\xbb is going to hold an international exposition of cars. There are q options of exposition location and time, in the i-th of them exposition will happen in a point with coordinates (pxi,\xe2\x80\x89pyi) in ti days. Of course, at the \xc2\xabAutoVoz\xc2\xbb is going to bring as much new cars from factories as possible to the place of exposition. Cars are going to be moved by enabling their engines on some certain levels, such that at the beginning of an exposition car gets exactly to the exposition location. However, for some of the options it may be impossible to bring cars from some of the factories to the exposition location by the moment of an exposition. Your task is to determine for each of the options of exposition location and time how many cars will be able to get there by the beginning of an exposition." 3400

853D "Michael and Charging Stations" "binary search,dp,greedy" "Michael has just bought a new electric car for moving across city. Michael does not like to overwork, so each day he drives to only one of two his jobs.Michael\'s day starts from charging his electric car for getting to the work and back. He spends 1000 burles on charge if he goes to the first job, and 2000 burles if he goes to the second job.On a charging station he uses there is a loyalty program that involves bonus cards. Bonus card may have some non-negative amount of bonus burles. Each time customer is going to buy something for the price of x burles, he is allowed to pay an amount of y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x) burles that does not exceed the bonus card balance with bonus burles. In this case he pays x\xe2\x80\x89-\xe2\x80\x89y burles with cash, and the balance on the bonus card is decreased by y bonus burles. If customer pays whole price with cash (i.e., y\xe2\x80\x89=\xe2\x80\x890) then 10% of price is returned back to the bonus card. This means that bonus card balance increases by  bonus burles. Initially the bonus card balance is equal to 0 bonus burles.Michael has planned next n days and he knows how much does the charge cost on each of those days. Help Michael determine the minimum amount of burles in cash he has to spend with optimal use of bonus card. Assume that Michael is able to cover any part of the price with cash in any day. It is not necessary to spend all bonus burles at the end of the given period." 2400

853C Boredom "data structures" "Ilya is sitting in a waiting area of Metropolis airport and is bored of looking at time table that shows again and again that his plane is delayed. So he took out a sheet of paper and decided to solve some problems.First Ilya has drawn a grid of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n and marked n squares on it, such that no two marked squares share the same row or the same column. He calls a rectangle on a grid with sides parallel to grid sides beautiful if exactly two of its corner squares are marked. There are exactly n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89/\xe2\x80\x892 beautiful rectangles.Ilya has chosen q query rectangles on a grid with sides parallel to grid sides (not necessarily beautiful ones), and for each of those rectangles he wants to find its beauty degree. Beauty degree of a rectangle is the number of beautiful rectangles that share at least one square with the given one.Now Ilya thinks that he might not have enough time to solve the problem till the departure of his flight. You are given the description of marked cells and the query rectangles, help Ilya find the beauty degree of each of the query rectangles." 2100

853B "Jury Meeting" "greedy,sortings,two pointers" "Country of Metropolia is holding Olympiad of Metrpolises soon. It mean that all jury members of the olympiad should meet together in Metropolis (the capital of the country) for the problem preparation process.There are n\xe2\x80\x89+\xe2\x80\x891 cities consecutively numbered from 0 to n. City 0 is Metropolis that is the meeting point for all jury members. For each city from 1 to n there is exactly one jury member living there. Olympiad preparation is a long and demanding process that requires k days of work. For all of these k days each of the n jury members should be present in Metropolis to be able to work on problems.You know the flight schedule in the country (jury members consider themselves important enough to only use flights for transportation). All flights in Metropolia are either going to Metropolis or out of Metropolis. There are no night flights in Metropolia, or in the other words, plane always takes off at the same day it arrives. On his arrival day and departure day jury member is not able to discuss the olympiad. All flights in Megapolia depart and arrive at the same day.Gather everybody for k days in the capital is a hard objective, doing that while spending the minimum possible money is even harder. Nevertheless, your task is to arrange the cheapest way to bring all of the jury members to Metrpolis, so that they can work together for k days and then send them back to their home cities. Cost of the arrangement is defined as a total cost of tickets for all used flights. It is allowed for jury member to stay in Metropolis for more than k days." 1800

853A Planning greedy "Helen works in Metropolis airport. She is responsible for creating a departure schedule. There are n flights that must depart today, the i-th of them is planned to depart at the i-th minute of the day.Metropolis airport is the main transport hub of Metropolia, so it is difficult to keep the schedule intact. This is exactly the case today: because of technical issues, no flights were able to depart during the first k minutes of the day, so now the new departure schedule must be created.All n scheduled flights must now depart at different minutes between (k\xe2\x80\x89+\xe2\x80\x891)-th and (k\xe2\x80\x89+\xe2\x80\x89n)-th, inclusive. However, it\'s not mandatory for the flights to depart in the same order they were initially scheduled to do so�\xe2\x80\x94 their order in the new schedule can be different. There is only one restriction: no flight is allowed to depart earlier than it was supposed to depart in the initial schedule.Helen knows that each minute of delay of the i-th flight costs airport ci burles. Help her find the order for flights to depart in the new schedule that minimizes the total cost for the airport." 1500

852I Dating "brute force,dfs and similar,graphs,trees" "This story is happening in a town named BubbleLand. There are n houses in BubbleLand. In each of these n houses lives a boy or a girl. People there really love numbers and everyone has their favorite number f. That means that the boy or girl that lives in the i-th house has favorite number equal to fi.The houses are numerated with numbers 1 to n.The houses are connected with n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads and you can travel from any house to any other house in the town. There is exactly one path between every pair of houses.A new dating had agency opened their offices in this mysterious town and the citizens were very excited. They immediately sent q questions to the agency and each question was of the following format:   a b�\xe2\x80\x94 asking how many ways are there to choose a couple (boy and girl) that have the same favorite number and live in one of the houses on the unique path from house a to house b. Help the dating agency to answer the questions and grow their business." 2300

852H "Bob and stages" dp,geometry "The citizens of BubbleLand are celebrating their 10th anniversary so they decided to organize a big music festival. Bob got a task to invite N famous singers who would sing on the fest. He was too busy placing stages for their performances that he totally forgot to write the invitation e-mails on time, and unfortunately he only found K available singers. Now there are more stages than singers, leaving some of the stages empty. Bob would not like if citizens of BubbleLand noticed empty stages and found out that he was irresponsible.Because of that he decided to choose exactly K stages that form a convex set, make large posters as edges of that convex set and hold festival inside. While those large posters will make it impossible for citizens to see empty stages outside Bob still needs to make sure they don\'t see any of the empty stages inside that area.Since lots of people are coming, he would like that the festival area is as large as possible. Help him calculate the maximum area that he could obtain respecting the conditions. If there is no such area, the festival cannot be organized and the answer is 0.00." 3000

852G "Bathroom terminal" implementation "Smith wakes up at the side of a dirty, disused bathroom, his ankle chained to pipes. Next to him is tape-player with a hand-written message ""Play Me"". He finds a tape in his own back pocket. After putting the tape in the tape-player, he sees a key hanging from a ceiling, chained to some kind of a machine, which is connected to the terminal next to him. After pressing a Play button a rough voice starts playing from the tape:""Listen up Smith. As you can see, you are in pretty tough situation and in order to escape, you have to solve a puzzle. You are given N strings which represent words. Each word is of the maximum length L and consists of characters \'a\'-\'e\'. You are also given M strings which represent patterns. Pattern is a string of length \xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89 L and consists of characters \'a\'-\'e\' as well as the maximum 3 characters \'?\'. Character \'?\' is an unknown character, meaning it can be equal to any character \'a\'-\'e\', or even an empty character. For each pattern find the number of words that matches with the given pattern. After solving it and typing the result in the terminal, the key will drop from the ceiling and you may escape. Let the game begin.""Help Smith escape." 1700

852F "Product transformation" "combinatorics,math,number theory" "Consider an array A with N elements, all being the same integer a.Define the product transformation as a simultaneous update Ai\xe2\x80\x89=\xe2\x80\x89Ai\xc2\xb7Ai\xe2\x80\x89+\xe2\x80\x891, that is multiplying each element to the element right to it for , with the last number AN remaining the same. For example, if we start with an array A with a\xe2\x80\x89=\xe2\x80\x892 and N\xe2\x80\x89=\xe2\x80\x894, then after one product transformation A\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x89 4,\xe2\x80\x89 4,\xe2\x80\x89 2], and after two product transformations A\xe2\x80\x89=\xe2\x80\x89[16,\xe2\x80\x89 16,\xe2\x80\x89 8,\xe2\x80\x89 2].Your simple task is to calculate the array A after M product transformations. Since the numbers can get quite big you should output them modulo Q." 2200

852E "Casinos and travel" dp "John has just bought a new car and is planning a journey around the country. Country has N cities, some of which are connected by bidirectional roads. There are N\xe2\x80\x89-\xe2\x80\x891 roads and every city is reachable from any other city. Cities are labeled from 1 to N.John first has to select from which city he will start his journey. After that, he spends one day in a city and then travels to a randomly choosen city which is directly connected to his current one and which he has not yet visited. He does this until he can\'t continue obeying these rules.To select the starting city, he calls his friend Jack for advice. Jack is also starting a big casino business and wants to open casinos in some of the cities (max 1 per city, maybe nowhere). Jack knows John well and he knows that if he visits a city with a casino, he will gamble exactly once before continuing his journey.He also knows that if John enters a casino in a good mood, he will leave it in a bad mood and vice versa. Since he is John\'s friend, he wants him to be in a good mood at the moment when he finishes his journey. John is in a good mood before starting the journey.In how many ways can Jack select a starting city for John and cities where he will build casinos such that no matter how John travels, he will be in a good mood at the end? Print answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2100

852D "Exploration plan" "binary search,flows,graph matchings,shortest paths" "The competitors of Bubble Cup X gathered after the competition and discussed what is the best way to get to know the host country and its cities.After exploring the map of Serbia for a while, the competitors came up with the following facts: the country has V cities which are indexed with numbers from 1 to V, and there are E bi-directional roads that connect the cites. Each road has a weight (the time needed to cross that road). There are N teams at the Bubble Cup and the competitors came up with the following plan: each of the N teams will start their journey in one of the V cities, and some of the teams share the starting position.They want to find the shortest time T, such that every team can move in these T minutes, and the number of different cities they end up in is at least K (because they will only get to know the cities they end up in). A team doesn\'t have to be on the move all the time, if they like it in a particular city, they can stay there and wait for the time to pass.Please help the competitors to determine the shortest time T so it\'s possible for them to end up in at least K different cities or print -1 if that is impossible no matter how they move.Note that there can exist multiple roads between some cities." 2100

852C Property greedy,sortings "Bill is a famous mathematician in BubbleLand. Thanks to his revolutionary math discoveries he was able to make enough money to build a beautiful house. Unfortunately, for not paying property tax on time, court decided to punish Bill by making him lose a part of his property.Bill\xe2\x80\x99s property can be observed as a convex regular 2n-sided polygon A0 A1... A2n\xe2\x80\x89-\xe2\x80\x891 A2n,\xe2\x80\x89 A2n\xe2\x80\x89=\xe2\x80\x89 A0, with sides of the exactly 1 meter in length. Court rules for removing part of his property are as follows:  Split every edge Ak Ak\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89 k\xe2\x80\x89=\xe2\x80\x890... 2n\xe2\x80\x89-\xe2\x80\x891 in n equal parts of size 1\xe2\x80\x89/\xe2\x80\x89n with points P0,\xe2\x80\x89P1,\xe2\x80\x89...,\xe2\x80\x89Pn\xe2\x80\x89-\xe2\x80\x891  On every edge A2k A2k\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89 k\xe2\x80\x89=\xe2\x80\x890... n\xe2\x80\x89-\xe2\x80\x891 court will choose one point B2k\xe2\x80\x89=\xe2\x80\x89 Pi for some i\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x89...,\xe2\x80\x89 n\xe2\x80\x89-\xe2\x80\x891 such that   On every edge A2k\xe2\x80\x89+\xe2\x80\x891A2k\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89 k\xe2\x80\x89=\xe2\x80\x890...n\xe2\x80\x89-\xe2\x80\x891 Bill will choose one point B2k\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89 Pi for some i\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x89...,\xe2\x80\x89 n\xe2\x80\x89-\xe2\x80\x891 such that   Bill gets to keep property inside of 2n-sided polygon B0 B1... B2n\xe2\x80\x89-\xe2\x80\x891 Luckily, Bill found out which B2k points the court chose. Even though he is a great mathematician, his house is very big and he has a hard time calculating. Therefore, he is asking you to help him choose points so he maximizes area of property he can keep." 2100

852B "Neural Network country" dp,matrices "Due to the recent popularity of the Deep learning new countries are starting to look like Neural Networks. That is, the countries are being built deep with many layers, each layer possibly having many cities. They also have one entry, and one exit point.There are exactly L layers, each having N cities. Let us look at the two adjacent layers L1 and L2. Each city from the layer L1 is connected to each city from the layer L2 with the traveling cost cij for , and each pair of adjacent layers has the same cost in between their cities as any other pair (they just stacked the same layers, as usual). Also, the traveling costs to each city from the layer L2 are same for all cities in the L1, that is cij is the same for , and fixed j.Doctor G. needs to speed up his computations for this country so he asks you to find the number of paths he can take from entry to exit point such that his traveling cost is divisible by given number M." 2000

852A Digits "brute force,implementation,math" "John gave Jack a very hard problem. He wrote a very big positive integer A0 on a piece of paper. The number is less than 10200000 . In each step, Jack is allowed to put \'\xe2\x80\x89+\xe2\x80\x89\' signs in between some of the digits (maybe none) of the current number and calculate the sum of the expression. He can perform the same procedure on that sum and so on. The resulting sums can be labeled respectively by A1, A2 etc. His task is to get to a single digit number.The problem is that there is not much blank space on the paper. There are only three lines of space, so he can\'t perform more than three steps. Since he wants to fill up the paper completely, he will perform exactly three steps.Jack must not add leading zeros to intermediate results, but he can put \'\xe2\x80\x89+\xe2\x80\x89\' signs in front of digit 0. For example, if the current number is 1000100, 10\xe2\x80\x89+\xe2\x80\x89001\xe2\x80\x89+\xe2\x80\x8900 is a valid step, resulting in number 11." 2500

851B "Arpa and an exam about geometry" geometry,math "Arpa is taking a geometry exam. Here is the last problem of the exam.You are given three points a,\xe2\x80\x89b,\xe2\x80\x89c.Find a point and an angle such that if we rotate the page around the point by the angle, the new position of a is the same as the old position of b, and the new position of b is the same as the old position of c.Arpa is doubting if the problem has a solution or not (i.e. if there exists a point and an angle satisfying the condition). Help Arpa determine if the question has a solution or not." 1400

851A "Arpa and a research in Mexican wave" implementation,math "Arpa is researching the Mexican wave.There are n spectators in the stadium, labeled from 1 to n. They start the Mexican wave at time 0.   At time 1, the first spectator stands.  At time 2, the second spectator stands.  ...  At time k, the k-th spectator stands.  At time k\xe2\x80\x89+\xe2\x80\x891, the (k\xe2\x80\x89+\xe2\x80\x891)-th spectator stands and the first spectator sits.  At time k\xe2\x80\x89+\xe2\x80\x892, the (k\xe2\x80\x89+\xe2\x80\x892)-th spectator stands and the second spectator sits.  ...  At time n, the n-th spectator stands and the (n\xe2\x80\x89-\xe2\x80\x89k)-th spectator sits.  At time n\xe2\x80\x89+\xe2\x80\x891, the (n\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89k)-th spectator sits.  ...  At time n\xe2\x80\x89+\xe2\x80\x89k, the n-th spectator sits. Arpa wants to know how many spectators are standing at time t." 800

850F "Rainbow Balls" math "You have a bag of balls of n different colors. You have ai balls of the i-th color.While there are at least two different colored balls in the bag, perform the following steps:   Take out two random balls without replacement one by one. These balls might be the same color.  Color the second ball to the color of the first ball. You are not allowed to switch the order of the balls in this step.  Place both balls back in the bag.  All these actions take exactly one second. Let M\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897. It can be proven that the expected amount of time needed before you stop can be represented as a rational number , where P and Q are coprime integers and where Q is not divisible by M. Return the value ." 2800

850E "Random Elections" "bitmasks,brute force,divide and conquer,fft,math" "The presidential election is coming in Bearland next year! Everybody is so excited about this!So far, there are three candidates, Alice, Bob, and Charlie. There are n citizens in Bearland. The election result will determine the life of all citizens of Bearland for many years. Because of this great responsibility, each of n citizens will choose one of six orders of preference between Alice, Bob and Charlie uniformly at random, independently from other voters.The government of Bearland has devised a function to help determine the outcome of the election given the voters preferences. More specifically, the function is  (takes n boolean numbers and returns a boolean number). The function also obeys the following property: f(1\xe2\x80\x89-\xe2\x80\x89x1,\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89xn)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89f(x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn).Three rounds will be run between each pair of candidates: Alice and Bob, Bob and Charlie, Charlie and Alice. In each round, xi will be equal to 1, if i-th citizen prefers the first candidate to second in this round, and 0 otherwise. After this, y\xe2\x80\x89=\xe2\x80\x89f(x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn) will be calculated. If y\xe2\x80\x89=\xe2\x80\x891, the first candidate will be declared as winner in this round. If y\xe2\x80\x89=\xe2\x80\x890, the second will be the winner, respectively.Define the probability that there is a candidate who won two rounds as p. p\xc2\xb76n is always an integer. Print the value of this integer modulo 109\xe2\x80\x89+\xe2\x80\x897\xe2\x80\x89=\xe2\x80\x891 000 000 007." 2800

850D "Tournament Construction" "constructive algorithms,dp,graphs,greedy,math" "Ivan is reading a book about tournaments. He knows that a tournament is an oriented graph with exactly one oriented edge between each pair of vertices. The score of a vertex is the number of edges going outside this vertex. Yesterday Ivan learned Landau\'s criterion: there is tournament with scores d1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89dn if and only if  for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n and .Now, Ivan wanna solve following problem: given a set of numbers S\xe2\x80\x89=\xe2\x80\x89{a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am}, is there a tournament with given set of scores? I.e. is there tournament with sequence of scores d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dn such that if we remove duplicates in scores, we obtain the required set {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am}? Find a tournament with minimum possible number of vertices." 2800

850C "Arpa and a game with Mojtaba" bitmasks,dp,games "Mojtaba and Arpa are playing a game. They have a list of n numbers in the game.In a player\'s turn, he chooses a number pk (where p is a prime number and k is a positive integer) such that pk divides at least one number in the list. For each number in the list divisible by pk, call it x, the player will delete x and add  to the list. The player who can not make a valid choice of p and k loses.Mojtaba starts the game and the players alternatively make moves. Determine which one of players will be the winner if both players play optimally." 2200

850B "Arpa and a list of numbers" "implementation,number theory" "Arpa has found a list containing n numbers. He calls a list bad if and only if it is not empty and gcd (see notes section for more information) of numbers in the list is 1.Arpa can perform two types of operations:  Choose a number and delete it with cost x.  Choose a number and increase it by 1 with cost y. Arpa can apply these operations to as many numbers as he wishes, and he is allowed to apply the second operation arbitrarily many times on the same number.Help Arpa to find the minimum possible cost to make the list good." 2100

850A "Five Dimensional Points" "brute force,geometry,math" "You are given set of n points in 5-dimensional space. The points are labeled from 1 to n. No two points coincide.We will call point a bad if there are different points b and c, not equal to a, from the given set such that angle between vectors  and  is acute (i.e. strictly less than ). Otherwise, the point is called good.The angle between vectors  and  in 5-dimensional space is defined as , where  is the scalar product and  is length of .Given the list of points, print the indices of the good points in ascending order." 1700

849B "Tell Your World" "brute force,geometry" "Connect the countless points with lines, till we reach the faraway yonder.There are n points on a coordinate plane, the i-th of which being (i,\xe2\x80\x89yi).Determine whether it\'s possible to draw two parallel and non-overlapping lines, such that every point in the set lies on exactly one of them, and each of them passes through at least one point in the set." 1600

849A "Odds and Ends" implementation "Where do odds begin, and where do they end? Where does hope emerge, and will they ever break?Given an integer sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of length n. Decide whether it is possible to divide it into an odd number of non-empty subsegments, the each of which has an odd length and begins and ends with odd numbers.A subsegment is a contiguous slice of the whole sequence. For example, {3,\xe2\x80\x894,\xe2\x80\x895} and {1} are subsegments of sequence {1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895,\xe2\x80\x896}, while {1,\xe2\x80\x892,\xe2\x80\x894} and {7} are not." 1000

848E "Days of Floral Colours" "combinatorics,divide and conquer,dp,fft,math" "The Floral Clock has been standing by the side of Mirror Lake for years. Though unable to keep time, it reminds people of the passage of time and the good old days.On the rim of the Floral Clock are 2n flowers, numbered from 1 to 2n clockwise, each of which has a colour among all n possible ones. For each colour, there are exactly two flowers with it, the distance between which either is less than or equal to 2, or equals n. Additionally, if flowers u and v are of the same colour, then flowers opposite to u and opposite to v should be of the same colour as well \xe2\x80\x94 symmetry is beautiful!Formally, the distance between two flowers is 1 plus the number of flowers on the minor arc (or semicircle) between them. Below is a possible arrangement with n\xe2\x80\x89=\xe2\x80\x896 that cover all possibilities.  The beauty of an arrangement is defined to be the product of the lengths of flower segments separated by all opposite flowers of the same colour. In other words, in order to compute the beauty, we remove from the circle all flowers that have the same colour as flowers opposite to them. Then, the beauty is the product of lengths of all remaining segments. Note that we include segments of length 0 in this product. If there are no flowers that have the same colour as flower opposite to them, the beauty equals 0. For instance, the beauty of the above arrangement equals 1\xe2\x80\x89\xc3\x97\xe2\x80\x893\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x899 \xe2\x80\x94 the segments are {2}, {4,\xe2\x80\x895,\xe2\x80\x896}, {8} and {10,\xe2\x80\x8911,\xe2\x80\x8912}.While keeping the constraints satisfied, there may be lots of different arrangements. Find out the sum of beauty over all possible arrangements, modulo 998\xe2\x80\x89244\xe2\x80\x89353. Two arrangements are considered different, if a pair (u,\xe2\x80\x89v) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n) exists such that flowers u and v are of the same colour in one of them, but not in the other." 3400

848D "Shake It!" combinatorics,dp,flows,graphs "A never-ending, fast-changing and dream-like world unfolds, as the secret door opens.A world is an unordered graph G, in whose vertex set V(G) there are two special vertices s(G) and t(G). An initial world has vertex set {s(G),\xe2\x80\x89t(G)} and an edge between them.A total of n changes took place in an initial world. In each change, a new vertex w is added into V(G), an existing edge (u,\xe2\x80\x89v) is chosen, and two edges (u,\xe2\x80\x89w) and (v,\xe2\x80\x89w) are added into E(G). Note that it\'s possible that some edges are chosen in more than one change.It\'s known that the capacity of the minimum s-t cut of the resulting graph is m, that is, at least m edges need to be removed in order to make s(G) and t(G) disconnected.Count the number of non-similar worlds that can be built under the constraints, modulo 109\xe2\x80\x89+\xe2\x80\x897. We define two worlds similar, if they are isomorphic and there is isomorphism in which the s and t vertices are not relabelled. Formally, two worlds G and H are considered similar, if there is a bijection between their vertex sets , such that:   f(s(G))\xe2\x80\x89=\xe2\x80\x89s(H);  f(t(G))\xe2\x80\x89=\xe2\x80\x89t(H);  Two vertices u and v of G are adjacent in G if and only if f(u) and f(v) are adjacent in H." 2900

848C "Goodbye Souvenir" "data structures,divide and conquer" "I won\'t feel lonely, nor will I be sorrowful... not before everything is buried.A string of n beads is left as the message of leaving. The beads are numbered from 1 to n from left to right, each having a shape numbered by integers between 1 and n inclusive. Some beads may have the same shapes.The memory of a shape x in a certain subsegment of beads, is defined to be the difference between the last position and the first position that shape x appears in the segment. The memory of a subsegment is the sum of memories over all shapes that occur in it.From time to time, shapes of beads change as well as the memories. Sometimes, the past secreted in subsegments are being recalled, and you are to find the memory for each of them." 2600

848B "Rooter\'s Song" "constructive algorithms,data structures,geometry,implementation,sortings,two pointers" "I won\'t feel lonely, nor will I be sorrowful... not before everything is buried.A string of n beads is left as the message of leaving. The beads are numbered from 1 to n from left to right, each having a shape numbered by integers between 1 and n inclusive. Some beads may have the same shapes.The memory of a shape x in a certain subsegment of beads, is defined to be the difference between the last position and the first position that shape x appears in the segment. The memory of a subsegment is the sum of memories over all shapes that occur in it.From time to time, shapes of beads change as well as the memories. Sometimes, the past secreted in subsegments are being recalled, and you are to find the memory for each of them." 1900

848A "From Y to Y" "constructive algorithms" "From beginning till end, this message has been waiting to be conveyed.For a given unordered multiset of n lowercase English letters (""multi"" means that a letter may appear more than once), we treat all letters as strings of length 1, and repeat the following operation n\xe2\x80\x89-\xe2\x80\x891 times:  Remove any two elements s and t from the set, and add their concatenation s\xe2\x80\x89+\xe2\x80\x89t to the set. The cost of such operation is defined to be , where f(s,\xe2\x80\x89c) denotes the number of times character c appears in string s.Given a non-negative integer k, construct any valid non-empty set of no more than 100\xe2\x80\x89000 letters, such that the minimum accumulative cost of the whole process is exactly k. It can be shown that a solution always exists." 1600

847M "Weather Tomorrow" implementation,math "Vasya came up with his own weather forecasting method. He knows the information about the average air temperature for each of the last n days. Assume that the average air temperature for each day is integral.Vasya believes that if the average temperatures over the last n days form an arithmetic progression, where the first term equals to the average temperature on the first day, the second term equals to the average temperature on the second day and so on, then the average temperature of the next (n\xe2\x80\x89+\xe2\x80\x891)-th day will be equal to the next term of the arithmetic progression. Otherwise, according to Vasya\'s method, the temperature of the (n\xe2\x80\x89+\xe2\x80\x891)-th day will be equal to the temperature of the n-th day.Your task is to help Vasya predict the average temperature for tomorrow, i. e. for the (n\xe2\x80\x89+\xe2\x80\x891)-th day." 1000

847L "Berland SU Computer Network" "constructive algorithms,dfs and similar,graphs,hashing,trees" "In the computer network of the Berland State University there are n routers numbered from 1 to n. Some pairs of routers are connected by patch cords. Information can be transmitted over patch cords in both direction. The network is arranged in such a way that communication between any two routers (directly or through other routers) is possible. There are no cycles in the network, so there is only one path between each pair of routers over patch cords.Unfortunately, the exact topology of the network was lost by administrators. In order to restore it, the following auxiliary information was collected.For each patch cord p, directly connected to the router i, list of routers located behind the patch cord p relatively i is known. In other words, all routers path from which to the router i goes through p are known. So for each router i there are ki lists, where ki is the number of patch cords connected to i.For example, let the network consists of three routers connected in chain 1\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x893. Then:  the router 1: for the single patch cord connected to the first router there is a single list containing two routers: 2 and 3;  the router 2: for each of the patch cords connected to the second router there is a list: one list contains the router 1 and the other \xe2\x80\x94 the router 3;  the router 3: for the single patch cord connected to the third router there is a single list containing two routers: 1 and 2. Your task is to help administrators to restore the network topology, i. e. to identify all pairs of routers directly connected by a patch cord." 2400

847K "Travel Cards" greedy,implementation,sortings "In the evening Polycarp decided to analyze his today\'s travel expenses on public transport.The bus system in the capital of Berland is arranged in such a way that each bus runs along the route between two stops. Each bus has no intermediate stops. So each of the buses continuously runs along the route from one stop to the other and back. There is at most one bus running between a pair of stops.Polycarp made n trips on buses. About each trip the stop where he started the trip and the the stop where he finished are known. The trips follow in the chronological order in Polycarp\'s notes.It is known that one trip on any bus costs a burles. In case when passenger makes a transshipment the cost of trip decreases to b burles (b\xe2\x80\x89<\xe2\x80\x89a). A passenger makes a transshipment if the stop on which he boards the bus coincides with the stop where he left the previous bus. Obviously, the first trip can not be made with transshipment.For example, if Polycarp made three consecutive trips: ""BerBank""  ""University"", ""University""  ""BerMall"", ""University""  ""BerBank"", then he payed a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x89a\xe2\x80\x89=\xe2\x80\x892a\xe2\x80\x89+\xe2\x80\x89b burles. From the BerBank he arrived to the University, where he made transshipment to the other bus and departed to the BerMall. Then he walked to the University and returned to the BerBank by bus.Also Polycarp can buy no more than k travel cards. Each travel card costs f burles. The travel card for a single bus route makes free of charge any trip by this route (in both directions). Once purchased, a travel card can be used any number of times in any direction.What is the smallest amount of money Polycarp could have spent today if he can buy no more than k travel cards?" 1800

847J "Students Initiation" "binary search,flows,graphs" "Soon the first year students will be initiated into students at the University of Berland. The organizers of the initiation come up with a program for this holiday. In their opinion, it would be good if the first-year students presented small souvenirs to each other. When they voiced this idea to the first-year students, they found out the following:  some pairs of the new students already know each other;  each new student agrees to give souvenirs only to those with whom they are already familiar;  each new student does not want to present too many souvenirs. The organizers have written down all the pairs of first-year friends who are familiar with each other and now want to determine for each new student, whom they should give souvenirs to. In their opinion, in each pair of familiar students exactly one student must present a souvenir to another student.First year students already decided to call the unluckiest the one who will have to present the greatest number of souvenirs. The organizers in return promised that the unluckiest will be unlucky to the minimum possible degree: of course, they will have to present the greatest number of souvenirs compared to the other students, but this number will be as small as possible.Organizers are very busy, and they asked you to determine for each pair of first-year friends who and to whom should present a souvenir." 2400

847I "Noise Level" "dfs and similar,implementation,math" "The Berland\'s capital has the form of a rectangle with sizes n\xe2\x80\x89\xc3\x97\xe2\x80\x89m quarters. All quarters are divided into three types:  regular (labeled with the character \'.\') \xe2\x80\x94 such quarters do not produce the noise but are not obstacles to the propagation of the noise;  sources of noise (labeled with an uppercase Latin letter from \'A\' to \'Z\') \xe2\x80\x94 such quarters are noise sources and are not obstacles to the propagation of the noise;  heavily built-up (labeled with the character \'*\') \xe2\x80\x94 such quarters are soundproofed, the noise does not penetrate into them and they themselves are obstacles to the propagation of noise. A quarter labeled with letter \'A\' produces q units of noise. A quarter labeled with letter \'B\' produces 2\xc2\xb7q units of noise. And so on, up to a quarter labeled with letter \'Z\', which produces 26\xc2\xb7q units of noise. There can be any number of quarters labeled with each letter in the city.When propagating from the source of the noise, the noise level is halved when moving from one quarter to a quarter that shares a side with it (when an odd number is to be halved, it\'s rounded down). The noise spreads along the chain. For example, if some quarter is located at a distance 2 from the noise source, then the value of noise which will reach the quarter is divided by 4. So the noise level that comes from the source to the quarter is determined solely by the length of the shortest path between them. Heavily built-up quarters are obstacles, the noise does not penetrate into them.  The values in the cells of the table on the right show the total noise level in the respective quarters for q\xe2\x80\x89=\xe2\x80\x89100, the first term in each sum is the noise from the quarter \'A\', the second \xe2\x80\x94 the noise from the quarter \'B\'. The noise level in quarter is defined as the sum of the noise from all sources. To assess the quality of life of the population of the capital of Berland, it is required to find the number of quarters whose noise level exceeds the allowed level p." 1900

847H "Load Testing" greedy "Polycarp plans to conduct a load testing of its new project Fakebook. He already agreed with his friends that at certain points in time they will send requests to Fakebook. The load testing will last n minutes and in the i-th minute friends will send ai requests.Polycarp plans to test Fakebook under a special kind of load. In case the information about Fakebook gets into the mass media, Polycarp hopes for a monotone increase of the load, followed by a monotone decrease of the interest to the service. Polycarp wants to test this form of load.Your task is to determine how many requests Polycarp must add so that before some moment the load on the server strictly increases and after that moment strictly decreases. Both the increasing part and the decreasing part can be empty (i. e. absent). The decrease should immediately follow the increase. In particular, the load with two equal neigbouring values is unacceptable.For example, if the load is described with one of the arrays [1, 2, 8, 4, 3], [1, 3, 5] or [10], then such load satisfies Polycarp (in each of the cases there is an increasing part, immediately followed with a decreasing part). If the load is described with one of the arrays [1, 2, 2, 1], [2, 1, 2] or [10, 10], then such load does not satisfy Polycarp.Help Polycarp to make the minimum number of additional requests, so that the resulting load satisfies Polycarp. He can make any number of additional requests at any minute from 1 to n." 1600

847G "University Classes" implementation "There are n student groups at the university. During the study day, each group can take no more than 7 classes. Seven time slots numbered from 1 to 7 are allocated for the classes.The schedule on Monday is known for each group, i. e. time slots when group will have classes are known.Your task is to determine the minimum number of rooms needed to hold classes for all groups on Monday. Note that one room can hold at most one group class in a single time slot." 900

847F "Berland Elections" greedy,sortings "The elections to Berland parliament are happening today. Voting is in full swing!Totally there are n candidates, they are numbered from 1 to n. Based on election results k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) top candidates will take seats in the parliament.After the end of the voting the number of votes for each candidate is calculated. In the resulting table the candidates are ordered by the number of votes. In case of tie (equal number of votes) they are ordered by the time of the last vote given. The candidate with ealier last vote stands higher in the resulting table.So in the resulting table candidates are sorted by the number of votes (more votes stand for the higher place) and if two candidates have equal number of votes they are sorted by the time of last vote (earlier last vote stands for the higher place).There is no way for a candidate with zero votes to take a seat in the parliament. So it is possible that less than k candidates will take a seat in the parliament.In Berland there are m citizens who can vote. Each of them will vote for some candidate. Each citizen will give a vote to exactly one of n candidates. There is no option ""against everyone"" on the elections. It is not accepted to spoil bulletins or not to go to elections. So each of m citizens will vote for exactly one of n candidates.At the moment a citizens have voted already (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). This is an open election, so for each citizen it is known the candidate for which the citizen has voted. Formally, the j-th citizen voted for the candidate gj. The citizens who already voted are numbered in chronological order; i.e. the (j\xe2\x80\x89+\xe2\x80\x891)-th citizen voted after the j-th.The remaining m\xe2\x80\x89-\xe2\x80\x89a citizens will vote before the end of elections, each of them will vote for one of n candidates.Your task is to determine for each of n candidates one of the three possible outcomes:  a candidate will be elected to the parliament regardless of votes of the remaining m\xe2\x80\x89-\xe2\x80\x89a citizens;  a candidate has chance to be elected to the parliament after all n citizens have voted;  a candidate has no chances to be elected to the parliament regardless of votes of the remaining m\xe2\x80\x89-\xe2\x80\x89a citizens." 2100

847E Packmen "binary search,dp" "A game field is a strip of 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n square cells. In some cells there are Packmen, in some cells�\xe2\x80\x94 asterisks, other cells are empty.Packman can move to neighboring cell in 1 time unit. If there is an asterisk in the target cell then Packman eats it. Packman doesn\'t spend any time to eat an asterisk.In the initial moment of time all Packmen begin to move. Each Packman can change direction of its move unlimited number of times, but it is not allowed to go beyond the boundaries of the game field. Packmen do not interfere with the movement of other packmen; in one cell there can be any number of packmen moving in any directions.Your task is to determine minimum possible time after which Packmen can eat all the asterisks." 1800

847D "Dog Show" "constructive algorithms,data structures,greedy" "A new dog show on TV is starting next week. On the show dogs are required to demonstrate bottomless stomach, strategic thinking and self-preservation instinct. You and your dog are invited to compete with other participants and naturally you want to win!On the show a dog needs to eat as many bowls of dog food as possible (bottomless stomach helps here). Dogs compete separately of each other and the rules are as follows:At the start of the show the dog and the bowls are located on a line. The dog starts at position x\xe2\x80\x89=\xe2\x80\x890 and n bowls are located at positions x\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89x\xe2\x80\x89=\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89=\xe2\x80\x89n. The bowls are numbered from 1 to n from left to right. After the show starts the dog immediately begins to run to the right to the first bowl.The food inside bowls is not ready for eating at the start because it is too hot (dog\'s self-preservation instinct prevents eating). More formally, the dog can eat from the i-th bowl after ti seconds from the start of the show or later.It takes dog 1 second to move from the position x to the position x\xe2\x80\x89+\xe2\x80\x891. The dog is not allowed to move to the left, the dog runs only to the right with the constant speed 1 distance unit per second. When the dog reaches a bowl (say, the bowl i), the following cases are possible:  the food had cooled down (i.e. it passed at least ti seconds from the show start): the dog immediately eats the food and runs to the right without any stop,  the food is hot (i.e. it passed less than ti seconds from the show start): the dog has two options: to wait for the i-th bowl, eat the food and continue to run at the moment ti or to skip the i-th bowl and continue to run to the right without any stop. After T seconds from the start the show ends. If the dog reaches a bowl of food at moment T the dog can not eat it. The show stops before T seconds if the dog had run to the right of the last bowl.You need to help your dog create a strategy with which the maximum possible number of bowls of food will be eaten in T seconds." 2200

847C "Sum of Nestings" "constructive algorithms" "Recall that the bracket sequence is considered regular if it is possible to insert symbols \'+\' and \'1\' into it so that the result is a correct arithmetic expression. For example, a sequence ""(()())"" is regular, because we can get correct arithmetic expression insering symbols \'+\' and \'1\': ""((1+1)+(1+1))"". Also the following sequences are regular: ""()()()"", ""(())"" and ""()"". The following sequences are not regular bracket sequences: "")("", ""(()"" and ""())(()"".In this problem you are given two integers n and k. Your task is to construct a regular bracket sequence consisting of round brackets with length 2\xc2\xb7n with total sum of nesting of all opening brackets equals to exactly k. The nesting of a single opening bracket equals to the number of pairs of brackets in which current opening bracket is embedded.For example, in the sequence ""()(())"" the nesting of first opening bracket equals to 0, the nesting of the second opening bracket equals to 0 and the nesting of the third opening bracket equal to 1. So the total sum of nestings equals to 1." 1800

847B "Preparing for Merge Sort" "binary search,data structures" "Ivan has an array consisting of n different integers. He decided to reorder all elements in increasing order. Ivan loves merge sort so he decided to represent his array with one or several increasing sequences which he then plans to merge into one sorted array.Ivan represent his array with increasing sequences with help of the following algorithm.While there is at least one unused number in array Ivan repeats the following procedure:  iterate through array from the left to the right;  Ivan only looks at unused numbers on current iteration;  if current number is the first unused number on this iteration or this number is greater than previous unused number on current iteration, then Ivan marks the number as used and writes it down. For example, if Ivan\'s array looks like [1, 3, 2, 5, 4] then he will perform two iterations. On first iteration Ivan will use and write numbers [1, 3, 5], and on second one \xe2\x80\x94 [2, 4].Write a program which helps Ivan and finds representation of the given array with one or several increasing sequences in accordance with algorithm described above." 1600

847A "Union of Doubly Linked Lists" implementation "Doubly linked list is one of the fundamental data structures. A doubly linked list is a sequence of elements, each containing information about the previous and the next elements of the list. In this problem all lists have linear structure. I.e. each element except the first has exactly one previous element, each element except the last has exactly one next element. The list is not closed in a cycle.In this problem you are given n memory cells forming one or more doubly linked lists. Each cell contains information about element from some list. Memory cells are numbered from 1 to n.For each cell i you are given two values:   li \xe2\x80\x94 cell containing previous element for the element in the cell i;  ri \xe2\x80\x94 cell containing next element for the element in the cell i. If cell i contains information about the element which has no previous element then li\xe2\x80\x89=\xe2\x80\x890. Similarly, if cell i contains information about the element which has no next element then ri\xe2\x80\x89=\xe2\x80\x890.  Three lists are shown on the picture. For example, for the picture above the values of l and r are the following: l1\xe2\x80\x89=\xe2\x80\x894, r1\xe2\x80\x89=\xe2\x80\x897; l2\xe2\x80\x89=\xe2\x80\x895, r2\xe2\x80\x89=\xe2\x80\x890; l3\xe2\x80\x89=\xe2\x80\x890, r3\xe2\x80\x89=\xe2\x80\x890; l4\xe2\x80\x89=\xe2\x80\x896, r4\xe2\x80\x89=\xe2\x80\x891; l5\xe2\x80\x89=\xe2\x80\x890, r5\xe2\x80\x89=\xe2\x80\x892; l6\xe2\x80\x89=\xe2\x80\x890, r6\xe2\x80\x89=\xe2\x80\x894; l7\xe2\x80\x89=\xe2\x80\x891, r7\xe2\x80\x89=\xe2\x80\x890.Your task is to unite all given lists in a single list, joining them to each other in any order. In particular, if the input data already contains a single list, then there is no need to perform any actions. Print the resulting list in the form of values li, ri.Any other action, other than joining the beginning of one list to the end of another, can not be performed." 1500

846F "Random Query" "data structures,math,probabilities,two pointers" "You are given an array a consisting of n positive integers. You pick two integer numbers l and r from 1 to n, inclusive (numbers are picked randomly, equiprobably and independently). If l\xe2\x80\x89>\xe2\x80\x89r, then you swap values of l and r. You have to calculate the expected value of the number of unique elements in segment of the array from index l to index r, inclusive (1-indexed)." 1800

846E "Chemistry in Berland" "dfs and similar,greedy,trees" "Igor is a post-graduate student of chemistry faculty in Berland State University (BerSU). He needs to conduct a complicated experiment to write his thesis, but laboratory of BerSU doesn\'t contain all the materials required for this experiment.Fortunately, chemical laws allow material transformations (yes, chemistry in Berland differs from ours). But the rules of transformation are a bit strange.Berland chemists are aware of n materials, numbered in the order they were discovered. Each material can be transformed into some other material (or vice versa). Formally, for each i (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) there exist two numbers xi and ki that denote a possible transformation: ki kilograms of material xi can be transformed into 1 kilogram of material i, and 1 kilogram of material i can be transformed into 1 kilogram of material xi. Chemical processing equipment in BerSU allows only such transformation that the amount of resulting material is always an integer number of kilograms.For each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) Igor knows that the experiment requires ai kilograms of material i, and the laboratory contains bi kilograms of this material. Is it possible to conduct an experiment after transforming some materials (or none)?" 2300

846D Monitor "binary search,data structures" "Recently Luba bought a monitor. Monitor is a rectangular matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. But then she started to notice that some pixels cease to work properly. Luba thinks that the monitor will become broken the first moment when it contains a square k\xe2\x80\x89\xc3\x97\xe2\x80\x89k consisting entirely of broken pixels. She knows that q pixels are already broken, and for each of them she knows the moment when it stopped working. Help Luba to determine when the monitor became broken (or tell that it\'s still not broken even after all q pixels stopped working)." 1900

846C "Four Segments" "brute force,data structures,dp" "You are given an array of n integer numbers. Let sum(l,\xe2\x80\x89r) be the sum of all numbers on positions from l to r non-inclusive (l-th element is counted, r-th element is not counted). For indices l and r holds 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Indices in array are numbered from 0. For example, if a\xe2\x80\x89=\xe2\x80\x89[\xe2\x80\x89-\xe2\x80\x895,\xe2\x80\x893,\xe2\x80\x899,\xe2\x80\x894], then sum(0,\xe2\x80\x891)\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x895, sum(0,\xe2\x80\x892)\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892, sum(1,\xe2\x80\x894)\xe2\x80\x89=\xe2\x80\x8916 and sum(i,\xe2\x80\x89i)\xe2\x80\x89=\xe2\x80\x890 for each i from 0 to 4.Choose the indices of three delimiters delim0, delim1, delim2 (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89delim0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89delim1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89delim2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and divide the array in such a way that the value of res\xe2\x80\x89=\xe2\x80\x89sum(0,\xe2\x80\x89delim0) - sum(delim0,\xe2\x80\x89delim1) + sum(delim1,\xe2\x80\x89delim2) - sum(delim2,\xe2\x80\x89n) is maximal. Note that some of the expressions sum(l,\xe2\x80\x89r) can correspond to empty segments (if l\xe2\x80\x89=\xe2\x80\x89r for some segment)." 1800

846B "Math Show" "brute force,greedy" "Polycarp takes part in a math show. He is given n tasks, each consists of k subtasks, numbered 1 through k. It takes him tj minutes to solve the j-th subtask of any task. Thus, time required to solve a subtask depends only on its index, but not on the task itself. Polycarp can solve subtasks in any order.By solving subtask of arbitrary problem he earns one point. Thus, the number of points for task is equal to the number of solved subtasks in it. Moreover, if Polycarp completely solves the task (solves all k of its subtasks), he recieves one extra point. Thus, total number of points he recieves for the complete solution of the task is k\xe2\x80\x89+\xe2\x80\x891.Polycarp has M minutes of time. What is the maximum number of points he can earn?" 1800

846A "Curriculum Vitae" "brute force,implementation" "Hideo Kojima has just quit his job at Konami. Now he is going to find a new place to work. Despite being such a well-known person, he still needs a CV to apply for a job.During all his career Hideo has produced n games. Some of them were successful, some were not. Hideo wants to remove several of them (possibly zero) from his CV to make a better impression on employers. As a result there should be no unsuccessful game which comes right after successful one in his CV.More formally, you are given an array s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn of zeros and ones. Zero corresponds to an unsuccessful game, one \xe2\x80\x94 to a successful one. Games are given in order they were produced, and Hideo can\'t swap these values. He should remove some elements from this array in such a way that no zero comes right after one.Besides that, Hideo still wants to mention as much games in his CV as possible. Help this genius of a man determine the maximum number of games he can leave in his CV." 1500

845G "Shortest Path Problem?" "dfs and similar,graphs,math" "You are given an undirected graph with weighted edges. The length of some path between two vertices is the bitwise xor of weights of all edges belonging to this path (if some edge is traversed more than once, then it is included in bitwise xor the same number of times). You have to find the minimum length of path between vertex 1 and vertex n.Note that graph can contain multiple edges and loops. It is guaranteed that the graph is connected." 2300

845F "Guards In The Storehouse" bitmasks,dp "Polycarp owns a shop in the capital of Berland. Recently the criminal activity in the capital increased, so Polycarp is thinking about establishing some better security in the storehouse of his shop.The storehouse can be represented as a matrix with n rows and m columns. Each element of the matrix is either . (an empty space) or x (a wall).Polycarp wants to hire some guards (possibly zero) to watch for the storehouse. Each guard will be in some cell of matrix and will protect every cell to the right of his own cell and every cell to the bottom of his own cell, until the nearest wall. More formally, if the guard is standing in the cell (x0,\xe2\x80\x89y0), then he protects cell (x1,\xe2\x80\x89y1) if all these conditions are met:  (x1,\xe2\x80\x89y1) is an empty cell;  either x0\xe2\x80\x89=\xe2\x80\x89x1 and y0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1, or x0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1 and y0\xe2\x80\x89=\xe2\x80\x89y1;  there are no walls between cells (x0,\xe2\x80\x89y0) and (x1,\xe2\x80\x89y1). There can be a guard between these cells, guards can look through each other. Guards can be placed only in empty cells (and can protect only empty cells). The plan of placing the guards is some set of cells where guards will be placed (of course, two plans are different if there exists at least one cell that is included in the first plan, but not included in the second plan, or vice versa). Polycarp calls a plan suitable if there is not more than one empty cell that is not protected.Polycarp wants to know the number of suitable plans. Since it can be very large, you have to output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2500

845E "Fire in the City" "binary search,data structures" "The capital of Berland looks like a rectangle of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m of the square blocks of same size.Fire!It is known that k\xe2\x80\x89+\xe2\x80\x891 blocks got caught on fire (k\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xc2\xb7m). Those blocks are centers of ignition. Moreover positions of k of these centers are known and one of these stays unknown. All k\xe2\x80\x89+\xe2\x80\x891 positions are distinct.The fire goes the following way: during the zero minute of fire only these k\xe2\x80\x89+\xe2\x80\x891 centers of ignition are burning. Every next minute the fire goes to all neighbouring blocks to the one which is burning. You can consider blocks to burn for so long that this time exceeds the time taken in the problem. The neighbouring blocks are those that touch the current block by a side or by a corner.Berland Fire Deparment wants to estimate the minimal time it takes the fire to lighten up the whole city. Remember that the positions of k blocks (centers of ignition) are known and (k\xe2\x80\x89+\xe2\x80\x891)-th can be positioned in any other block.Help Berland Fire Department to estimate the minimal time it takes the fire to lighten up the whole city." 2400

845D "Driving Test" "data structures,dp,greedy" "Polycarp has just attempted to pass the driving test. He ran over the straight road with the signs of four types.  speed limit: this sign comes with a positive integer number \xe2\x80\x94 maximal speed of the car after the sign (cancel the action of the previous sign of this type);  overtake is allowed: this sign means that after some car meets it, it can overtake any other car;  no speed limit: this sign cancels speed limit if any (car can move with arbitrary speed after this sign);  no overtake allowed: some car can\'t overtake any other car after this sign. Polycarp goes past the signs consequentially, each new sign cancels the action of all the previous signs of it\'s kind (speed limit/overtake). It is possible that two or more ""no overtake allowed"" signs go one after another with zero ""overtake is allowed"" signs between them. It works with ""no speed limit"" and ""overtake is allowed"" signs as well.In the beginning of the ride overtake is allowed and there is no speed limit.You are given the sequence of events in chronological order \xe2\x80\x94 events which happened to Polycarp during the ride. There are events of following types:  Polycarp changes the speed of his car to specified (this event comes with a positive integer number);  Polycarp\'s car overtakes the other car;  Polycarp\'s car goes past the ""speed limit"" sign (this sign comes with a positive integer);  Polycarp\'s car goes past the ""overtake is allowed"" sign;  Polycarp\'s car goes past the ""no speed limit"";  Polycarp\'s car goes past the ""no overtake allowed""; It is guaranteed that the first event in chronological order is the event of type 1 (Polycarp changed the speed of his car to specified).After the exam Polycarp can justify his rule violations by telling the driving instructor that he just didn\'t notice some of the signs. What is the minimal number of signs Polycarp should say he didn\'t notice, so that he would make no rule violations from his point of view?" 1800

845C "Two TVs" "data structures,greedy,sortings" "Polycarp is a great fan of television.He wrote down all the TV programs he is interested in for today. His list contains n shows, i-th of them starts at moment li and ends at moment ri.Polycarp owns two TVs. He can watch two different shows simultaneously with two TVs but he can only watch one show at any given moment on a single TV. If one show ends at the same moment some other show starts then you can\'t watch them on a single TV.Polycarp wants to check out all n shows. Are two TVs enough to do so?" 1500

845B "Luba And The Ticket" "brute force,greedy,implementation" "Luba has a ticket consisting of 6 digits. In one move she can choose digit in any position and replace it with arbitrary digit. She wants to know the minimum number of digits she needs to replace in order to make the ticket lucky.The ticket is considered lucky if the sum of first three digits equals to the sum of last three digits." 1600

845A "Chess Tourney" implementation,sortings "Berland annual chess tournament is coming!Organizers have gathered 2\xc2\xb7n chess players who should be divided into two teams with n people each. The first team is sponsored by BerOil and the second team is sponsored by BerMobile. Obviously, organizers should guarantee the win for the team of BerOil.Thus, organizers should divide all 2\xc2\xb7n players into two teams with n people each in such a way that the first team always wins.Every chess player has its rating ri. It is known that chess player with the greater rating always wins the player with the lower rating. If their ratings are equal then any of the players can win.After teams assignment there will come a drawing to form n pairs of opponents: in each pair there is a player from the first team and a player from the second team. Every chess player should be in exactly one pair. Every pair plays once. The drawing is totally random.Is it possible to divide all 2\xc2\xb7n players into two teams with n people each so that the player from the first team in every pair wins regardless of the results of the drawing?" 1100

844B Rectangles combinatorics,math "You are given n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table. Each cell of the table is colored white or black. Find the number of non-empty sets of cells such that:  All cells in a set have the same color.  Every two cells in a set share row or column." 1300

844A Diversity greedy,implementation,strings "Calculate the minimum number of characters you need to change in the string s, so that it contains at least k different letters, or print that it is impossible.String s consists only of lowercase Latin letters, and it is allowed to change characters only to lowercase Latin letters too." 1000

843E "Maximum Flow" flows,graphs "You are given a directed graph, consisting of n vertices and m edges. The vertices s and t are marked as source and sink correspondingly. Additionally, there are no edges ending at s and there are no edges beginning in t.The graph was constructed in a following way: initially each edge had capacity ci\xe2\x80\x89>\xe2\x80\x890. A maximum flow with source at s and sink at t was constructed in this flow network. Let\'s denote fi as the value of flow passing through edge with index i. Next, all capacities ci and flow value fi were erased. Instead, indicators gi were written on edges \xe2\x80\x94 if flow value passing through edge i was positive, i.e. 1 if fi\xe2\x80\x89>\xe2\x80\x890 and 0 otherwise.Using the graph and values gi, find out what is the minimum possible number of edges in the initial flow network that could be saturated (the passing flow is equal to capacity, i.e. fi\xe2\x80\x89=\xe2\x80\x89ci). Also construct the corresponding flow network with maximum flow in it.A flow in directed graph is described by flow values fi on each of the edges so that the following conditions are satisfied:   for each vertex, except source and sink, total incoming flow and total outcoming flow are equal,  for each edge 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89fi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci A flow is maximum if the difference between the sum of flow values on edges from the source, and the sum of flow values on edges to the source (there are no such in this problem), is maximum possible." 3000

843D "Dynamic Shortest Path" "graphs,shortest paths" "You are given a weighted directed graph, consisting of n vertices and m edges. You should answer q queries of two types:  1 v�\xe2\x80\x94 find the length of shortest path from vertex 1 to vertex v.  2 c l1 l2 ... lc�\xe2\x80\x94 add 1 to weights of edges with indices l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lc." 3400

843C "Upgrading Tree" "constructive algorithms,dfs and similar,graphs,math,trees" "You are given a tree with n vertices and you are allowed to perform no more than 2n transformations on it. Transformation is defined by three vertices x,\xe2\x80\x89y,\xe2\x80\x89y\' and consists of deleting edge (x,\xe2\x80\x89y) and adding edge (x,\xe2\x80\x89y\'). Transformation x,\xe2\x80\x89y,\xe2\x80\x89y\' could be performed if all the following conditions are satisfied:  There is an edge (x,\xe2\x80\x89y) in the current tree.  After the transformation the graph remains a tree.  After the deletion of edge (x,\xe2\x80\x89y) the tree would consist of two connected components. Let\'s denote the set of nodes in the component containing vertex x by Vx, and the set of nodes in the component containing vertex y by Vy. Then condition |Vx|\xe2\x80\x89>\xe2\x80\x89|Vy| should be satisfied, i.e. the size of the component with x should be strictly larger than the size of the component with y. You should minimize the sum of squared distances between all pairs of vertices in a tree, which you could get after no more than 2n transformations and output any sequence of transformations leading initial tree to such state.Note that you don\'t need to minimize the number of operations. It is necessary to minimize only the sum of the squared distances." 2600

843B "Interactive LowerBound" "brute force,interactive,probabilities" "This is an interactive problem.You are given a sorted in increasing order singly linked list. You should find the minimum integer in the list which is greater than or equal to x.More formally, there is a singly liked list built on an array of n elements. Element with index i contains two integers: valuei is the integer value in this element, and nexti that is the index of the next element of the singly linked list (or -1, if the current element is the last). The list is sorted, i.e. if nexti\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891, then valuenexti\xe2\x80\x89>\xe2\x80\x89valuei.You are given the number of elements in the list n, the index of the first element start, and the integer x.You can make up to 2000 queries of the following two types:  ? i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n)�\xe2\x80\x94 ask the values valuei and nexti,  ! ans�\xe2\x80\x94 give the answer for the problem: the minimum integer, greater than or equal to x, or ! -1, if there are no such integers. Your program should terminate after this query. Write a program that solves this problem." 2000

843A "Sorting by Subsequences" "dfs and similar,dsu,implementation,math,sortings" "You are given a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an consisting of different integers. It is required to split this sequence into the maximum number of subsequences such that after sorting integers in each of them in increasing order, the total sequence also will be sorted in increasing order.Sorting integers in a subsequence is a process such that the numbers included in a subsequence are ordered in increasing order, and the numbers which are not included in a subsequence don\'t change their places.Every element of the sequence must appear in exactly one subsequence." 1400

842E "Nikita and game" "binary search,dfs and similar,divide and conquer,graphs,trees" "Nikita plays a new computer game. There are m levels in this game. In the beginning of each level a new class appears in the game; this class is a child-class of the class yi (and yi is called parent-class for this new class). Thus, the classes form a tree. Initially there is only one class with index 1.Changing the class to its neighbour (child-class or parent-class) in the tree costs 1 coin. You can not change the class back. The cost of changing the class a to the class b is equal to the total cost of class changes on the path from a to b in the class tree.Suppose that at i�-th level the maximum cost of changing one class to another is x. For each level output the number of classes such that for each of these classes there exists some other class y, and the distance from this class to y is exactly x." 2800

842D "Vitya and Strange Lesson" "binary search,data structures" "Today at the lesson Vitya learned a very interesting function�\xe2\x80\x94 mex. Mex of a sequence of numbers is the minimum non-negative number that is not present in the sequence as element. For example, mex([4,\xe2\x80\x8933,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x895])\xe2\x80\x89=\xe2\x80\x892 and mex([1,\xe2\x80\x892,\xe2\x80\x893])\xe2\x80\x89=\xe2\x80\x890.Vitya quickly understood all tasks of the teacher, but can you do the same?You are given an array consisting of n non-negative integers, and m queries. Each query is characterized by one number x and consists of the following consecutive steps:  Perform the bitwise addition operation modulo 2 (xor) of each array element with the number x.  Find mex of the resulting array. Note that after each query the array changes." 2000

842C "Ilya And The Tree" "dfs and similar,graphs,math,number theory,trees" "Ilya is very fond of graphs, especially trees. During his last trip to the forest Ilya found a very interesting tree rooted at vertex 1. There is an integer number written on each vertex of the tree; the number written on vertex i is equal to ai.Ilya believes that the beauty of the vertex x is the greatest common divisor of all numbers written on the vertices on the path from the root to x, including this vertex itself. In addition, Ilya can change the number in one arbitrary vertex to 0 or leave all vertices unchanged. Now for each vertex Ilya wants to know the maximum possible beauty it can have.For each vertex the answer must be considered independently.The beauty of the root equals to number written on it." 2000

842B "Gleb And Pizza" geometry "Gleb ordered pizza home. When the courier delivered the pizza, he was very upset, because several pieces of sausage lay on the crust, and he does not really like the crust.The pizza is a circle of radius r and center at the origin. Pizza consists of the main part \xe2\x80\x94 circle of radius r\xe2\x80\x89-\xe2\x80\x89d with center at the origin, and crust around the main part of the width d. Pieces of sausage are also circles. The radius of the i�-th piece of the sausage is ri, and the center is given as a pair (xi, yi).Gleb asks you to help determine the number of pieces of sausage caught on the crust. A piece of sausage got on the crust, if it completely lies on the crust." 1100

842A "Kirill And The Game" "brute force,two pointers" "Kirill plays a new computer game. He came to the potion store where he can buy any potion. Each potion is characterized by two integers�\xe2\x80\x94 amount of experience and cost. The efficiency of a potion is the ratio of the amount of experience to the cost. Efficiency may be a non-integer number.For each two integer numbers a and b such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y there is a potion with experience a and cost b in the store (that is, there are (r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891) potions).Kirill wants to buy a potion which has efficiency k. Will he be able to do this?" 1200

841B Godsend games,math "Leha somehow found an array consisting of n integers. Looking at it, he came up with a task. Two players play the game on the array. Players move one by one. The first player can choose for his move a subsegment of non-zero length with an odd sum of numbers and remove it from the array, after that the remaining parts are glued together into one array and the game continues. The second player can choose a subsegment of non-zero length with an even sum and remove it. Loses the one who can not make a move. Who will win if both play optimally?" 1100

841A "Generous Kefa" "brute force,implementation" "One day Kefa found n baloons. For convenience, we denote color of i-th baloon as si \xe2\x80\x94 lowercase letter of the Latin alphabet. Also Kefa has k friends. Friend will be upset, If he get two baloons of the same color. Kefa want to give out all baloons to his friends. Help Kefa to find out, can he give out all his baloons, such that no one of his friens will be upset \xe2\x80\x94 print \xc2\xabYES\xc2\xbb, if he can, and \xc2\xabNO\xc2\xbb, otherwise. Note, that Kefa\'s friend will not upset, if he doesn\'t get baloons at all." 900

840E "In a Trap" trees "Lech got into a tree consisting of n vertices with a root in vertex number 1. At each vertex i written integer ai. He will not get out until he answers q queries of the form u v. Answer for the query is maximal value  among all vertices i on path from u to v including u and v, where dist(i,\xe2\x80\x89v) is number of edges on path from i to v. Also guaranteed that vertex u is ancestor of vertex v. Leha\'s tastes are very singular: he believes that vertex is ancestor of itself.Help Leha to get out.The expression  means the bitwise exclusive OR to the numbers x and y.Note that vertex u is ancestor of vertex v if vertex u lies on the path from root to the vertex v." 3200

840D Destiny "data structures,probabilities" "Once, Leha found in the left pocket an array consisting of n integers, and in the right pocket q queries of the form l r k. If there are queries, then they must be answered. Answer for the query is minimal x such that x occurs in the interval l r strictly more than  times or \xe2\x80\x89-\xe2\x80\x891 if there is no such number. Help Leha with such a difficult task." 2500

840C "On the Bench" combinatorics,dp "A year ago on the bench in public park Leha found an array of n numbers. Leha believes that permutation p is right if for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n condition, that api\xc2\xb7api\xe2\x80\x89+\xe2\x80\x891 is not perfect square, holds. Leha wants to find number of right permutations modulo 109\xe2\x80\x89+\xe2\x80\x897." 2500

840B "Leha and another game about graph" "constructive algorithms,data structures,dfs and similar,dp,graphs" "Leha plays a computer game, where is on each level is given a connected graph with n vertices and m edges. Graph can contain multiple edges, but can not contain self loops. Each vertex has an integer di, which can be equal to 0, 1 or \xe2\x80\x89-\xe2\x80\x891. To pass the level, he needs to find a \xc2\xabgood\xc2\xbb subset of edges of the graph or say, that it doesn\'t exist. Subset is called \xc2\xabgood\xc2\xbb, if by by leaving only edges from this subset in the original graph, we obtain the following: for every vertex i, di\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891 or it\'s degree modulo 2 is equal to di. Leha wants to pass the game as soon as possible and ask you to help him. In case of multiple correct answers, print any of them." 2100

840A "Leha and Function" "combinatorics,greedy,math,number theory,sortings" "Leha like all kinds of strange things. Recently he liked the function F(n,\xe2\x80\x89k). Consider all possible k-element subsets of the set [1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n]. For subset find minimal element in it. F(n,\xe2\x80\x89k) \xe2\x80\x94 mathematical expectation of the minimal element among all k-element subsets.But only function does not interest him. He wants to do interesting things with it. Mom brought him two arrays A and B, each consists of m integers. For all i,\xe2\x80\x89j such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m the condition Ai\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89Bj holds. Help Leha rearrange the numbers in the array A so that the sum  is maximally possible, where A\' is already rearranged array." 1300

839E "Mother of Dragons" "brute force,graphs,math,meet-in-the-middle" "There are n castles in the Lannister\'s Kingdom and some walls connect two castles, no two castles are connected by more than one wall, no wall connects a castle to itself. Sir Jaime Lannister has discovered that Daenerys Targaryen is going to attack his kingdom soon. Therefore he wants to defend his kingdom. He has k liters of a strange liquid. He wants to distribute that liquid among the castles, so each castle may contain some liquid (possibly zero or non-integer number of liters). After that the stability of a wall is defined as follows: if the wall connects two castles a and b, and they contain x and y liters of that liquid, respectively, then the strength of that wall is x\xc2\xb7y.Your task is to print the maximum possible sum of stabilities of the walls that Sir Jaime Lannister can achieve." 2700

839D "Winter is here" "combinatorics,dp,math,number theory" "Winter is here at the North and the White Walkers are close. John Snow has an army consisting of n soldiers. While the rest of the world is fighting for the Iron Throne, he is going to get ready for the attack of the White Walkers.He has created a method to know how strong his army is. Let the i-th soldier\xe2\x80\x99s strength be ai. For some k he calls i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ik a clan if i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89i3\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik and gcd(ai1,\xe2\x80\x89ai2,\xe2\x80\x89...,\xe2\x80\x89aik)\xe2\x80\x89>\xe2\x80\x891 . He calls the strength of that clan k\xc2\xb7gcd(ai1,\xe2\x80\x89ai2,\xe2\x80\x89...,\xe2\x80\x89aik). Then he defines the strength of his army by the sum of strengths of all possible clans.Your task is to find the strength of his army. As the number may be very large, you have to print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Greatest common divisor (gcd) of a sequence of integers is the maximum possible integer so that each element of the sequence is divisible by it." 2200

839C Journey "dfs and similar,dp,graphs,probabilities,trees" "There are n cities and n\xe2\x80\x89-\xe2\x80\x891 roads in the Seven Kingdoms, each road connects two cities and we can reach any city from any other by the roads.Theon and Yara Greyjoy are on a horse in the first city, they are starting traveling through the roads. But the weather is foggy, so they can\xe2\x80\x99t see where the horse brings them. When the horse reaches a city (including the first one), it goes to one of the cities connected to the current city. But it is a strange horse, it only goes to cities in which they weren\'t before. In each such city, the horse goes with equal probabilities and it stops when there are no such cities. Let the length of each road be 1. The journey starts in the city 1. What is the expected length (expected value of length) of their journey? You can read about expected (average) value by the link https://en.wikipedia.org/wiki/Expected_value." 1500

839B "Game of the Rows" "brute force,greedy,implementation" "Daenerys Targaryen has an army consisting of k groups of soldiers, the i-th group contains ai soldiers. She wants to bring her army to the other side of the sea to get the Iron Throne. She has recently bought an airplane to carry her army through the sea. The airplane has n rows, each of them has 8 seats. We call two seats neighbor, if they are in the same row and in seats {1,\xe2\x80\x892}, {3,\xe2\x80\x894}, {4,\xe2\x80\x895}, {5,\xe2\x80\x896} or {7,\xe2\x80\x898}.  A row in the airplane Daenerys Targaryen wants to place her army in the plane so that there are no two soldiers from different groups sitting on neighboring seats.Your task is to determine if there is a possible arranging of her army in the airplane such that the condition above is satisfied." 1900

839A "Arya and Bran" implementation "Bran and his older sister Arya are from the same house. Bran like candies so much, so Arya is going to give him some Candies.At first, Arya and Bran have 0 Candies. There are n days, at the i-th day, Arya finds ai candies in a box, that is given by the Many-Faced God. Every day she can give Bran at most 8 of her candies. If she don\'t give him the candies at the same day, they are saved for her and she can give them to him later.Your task is to find the minimum number of days Arya needs to give Bran k candies before the end of the n-th day. Formally, you need to output the minimum day index to the end of which k candies will be given out (the days are indexed from 1 to n).Print -1 if she can\'t give him k candies during n given days." 900

838F "Expected Earnings" NA "You are playing a game with a bag of red and black balls. Initially, you are told that the bag has n balls total. In addition, you are also told that the bag has probability pi\xe2\x80\x89/\xe2\x80\x89106 of containing exactly i red balls.You now would like to buy balls from this bag. You really like the color red, so red balls are worth a unit of 1, while black balls are worth nothing. To buy a ball, if there are still balls in the bag, you pay a cost c with 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891, and draw a ball randomly from the bag. You can choose to stop buying at any point (and you can even choose to not buy anything at all).Given that you buy optimally to maximize the expected profit (i.e. # red balls - cost needed to obtain them), print the maximum expected profit." 2800

838E "Convex Countour" dp "You are given an strictly convex polygon with n vertices. It is guaranteed that no three points are collinear. You would like to take a maximum non intersecting path on the polygon vertices that visits each point at most once.More specifically your path can be represented as some sequence of distinct polygon vertices. Your path is the straight line segments between adjacent vertices in order. These segments are not allowed to touch or intersect each other except at the vertices in your sequence.Given the polygon, print the maximum length non-intersecting path that visits each point at most once." 2300

838D "Airplane Arrangements" "math,number theory" "There is an airplane which has n rows from front to back. There will be m people boarding this airplane.This airplane has an entrance at the very front and very back of the plane.Each person has some assigned seat. It is possible for multiple people to have the same assigned seat. The people will then board the plane one by one starting with person 1. Each person can independently choose either the front entrance or back entrance to enter the plane.When a person walks into the plane, they walk directly to their assigned seat and will try to sit in it. If it is occupied, they will continue walking in the direction they walked in until they are at empty seat - they will take the earliest empty seat that they can find. If they get to the end of the row without finding a seat, they will be angry.Find the number of ways to assign tickets to the passengers and board the plane without anyone getting angry. Two ways are different if there exists a passenger who chose a different entrance in both ways, or the assigned seat is different. Print this count modulo 109\xe2\x80\x89+\xe2\x80\x897." 2700

838C "Future Failure" dp,games "Alice and Bob are playing a game with a string of characters, with Alice going first. The string consists n characters, each of which is one of the first k letters of the alphabet. On a player\xe2\x80\x99s turn, they can either arbitrarily permute the characters in the words, or delete exactly one character in the word (if there is at least one character). In addition, their resulting word cannot have appeared before throughout the entire game. The player unable to make a valid move loses the game.Given n,\xe2\x80\x89k,\xe2\x80\x89p, find the number of words with exactly n characters consisting of the first k letters of the alphabet such that Alice will win if both Alice and Bob play optimally. Return this number modulo the prime number p." 2800

838B "Diverging Directions" "data structures,dfs and similar,trees" "You are given a directed weighted graph with n nodes and 2n\xe2\x80\x89-\xe2\x80\x892 edges. The nodes are labeled from 1 to n, while the edges are labeled from 1 to 2n\xe2\x80\x89-\xe2\x80\x892. The graph\'s edges can be split into two parts.  The first n\xe2\x80\x89-\xe2\x80\x891 edges will form a rooted spanning tree, with node 1 as the root. All these edges will point away from the root.  The last n\xe2\x80\x89-\xe2\x80\x891 edges will be from node i to node 1, for all 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. You are given q queries. There are two types of queries  1 i w: Change the weight of the i-th edge to w  2 u v: Print the length of the shortest path between nodes u to v Given these queries, print the shortest path lengths." 2100

838A "Binary Blocks" "brute force" "You are given an image, that can be represented with a 2-d n by m grid of pixels. Each pixel of the image is either on or off, denoted by the characters ""0"" or ""1"", respectively. You would like to compress this image. You want to choose an integer k\xe2\x80\x89>\xe2\x80\x891 and split the image into k by k blocks. If n and m are not divisible by k, the image is padded with only zeros on the right and bottom so that they are divisible by k. Each pixel in each individual block must have the same value. The given image may not be compressible in its current state. Find the minimum number of pixels you need to toggle (after padding) in order for the image to be compressible for some k. More specifically, the steps are to first choose k, then the image is padded with zeros, then, we can toggle the pixels so it is compressible for this k. The image must be compressible in that state." 1400

837G "Functions On The Segments" "data structures" "You have an array f of n functions.The function fi(x) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is characterized by parameters: x1,\xe2\x80\x89x2,\xe2\x80\x89y1,\xe2\x80\x89a,\xe2\x80\x89b,\xe2\x80\x89y2 and take values:   y1, if x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1.  a\xc2\xb7x\xe2\x80\x89+\xe2\x80\x89b, if x1\xe2\x80\x89<\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2.  y2, if x\xe2\x80\x89>\xe2\x80\x89x2. There are m queries. Each query is determined by numbers l, r and x. For a query with number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m), you need to calculate the sum of all fj(xi) where l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. The value of xi is calculated as follows: xi\xe2\x80\x89=\xe2\x80\x89(x\xe2\x80\x89+\xe2\x80\x89last) mod 109, where last is the answer to the query with number i\xe2\x80\x89-\xe2\x80\x891. The value of last equals 0 if i\xe2\x80\x89=\xe2\x80\x891." 2500

837F "Prefix Sums" "binary search,brute force,combinatorics,math,matrices" "Consider the function p(x), where x is an array of m integers, which returns an array y consisting of m\xe2\x80\x89+\xe2\x80\x891 integers such that yi is equal to the sum of first i elements of array x (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m).You have an infinite sequence of arrays A0,\xe2\x80\x89A1,\xe2\x80\x89A2..., where A0 is given in the input, and for each i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891 Ai\xe2\x80\x89=\xe2\x80\x89p(Ai\xe2\x80\x89-\xe2\x80\x891). Also you have a positive integer k. You have to find minimum possible i such that Ai contains a number which is larger or equal than k." 2400

837E "Vasya\'s Function" "binary search,implementation,math" "Consider the function p(x), where x is an array of m integers, which returns an array y consisting of m\xe2\x80\x89+\xe2\x80\x891 integers such that yi is equal to the sum of first i elements of array x (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m).You have an infinite sequence of arrays A0,\xe2\x80\x89A1,\xe2\x80\x89A2..., where A0 is given in the input, and for each i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891 Ai\xe2\x80\x89=\xe2\x80\x89p(Ai\xe2\x80\x89-\xe2\x80\x891). Also you have a positive integer k. You have to find minimum possible i such that Ai contains a number which is larger or equal than k." 2100

837D "Round Subset" dp,math "Let\'s call the roundness of the number the number of zeros to which it ends.You have an array of n numbers. You need to choose a subset of exactly k numbers so that the roundness of the product of the selected numbers will be maximum possible." 2100

837C "Two Seals" "brute force,implementation" "One very important person has a piece of paper in the form of a rectangle a\xe2\x80\x89\xc3\x97\xe2\x80\x89b.Also, he has n seals. Each seal leaves an impression on the paper in the form of a rectangle of the size xi\xe2\x80\x89\xc3\x97\xe2\x80\x89yi. Each impression must be parallel to the sides of the piece of paper (but seal can be rotated by 90 degrees).A very important person wants to choose two different seals and put them two impressions. Each of the selected seals puts exactly one impression. Impressions should not overlap (but they can touch sides), and the total area occupied by them should be the largest possible. What is the largest area that can be occupied by two seals?" 1500

837B "Flag of Berland" "brute force,implementation" "The flag of Berland is such rectangular field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m that satisfies following conditions:  Flag consists of three colors which correspond to letters \'R\', \'G\' and \'B\'.  Flag consists of three equal in width and height stripes, parralel to each other and to sides of the flag. Each stripe has exactly one color.  Each color should be used in exactly one stripe. You are given a field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, consisting of characters \'R\', \'G\' and \'B\'. Output ""YES"" (without quotes) if this field corresponds to correct flag of Berland. Otherwise, print ""NO"" (without quotes)." 1600

837A "Text Volume" implementation "You are given a text of single-space separated words, consisting of small and capital Latin letters.Volume of the word is number of capital letters in the word. Volume of the text is maximum volume of all words in the text.Calculate the volume of the given text." 800

835F "Roads in the Kingdom" "dfs and similar,dp,graphs,trees" "In the Kingdom K., there are n towns numbered with integers from 1 to n. The towns are connected by n bi-directional roads numbered with integers from 1 to n. The i-th road connects the towns ui and vi and its length is li. There is no more than one road between two towns. Also, there are no roads that connect the towns with itself.Let\'s call the inconvenience of the roads the maximum of the shortest distances between all pairs of towns.Because of lack of money, it was decided to close down one of the roads so that after its removal it is still possible to reach any town from any other. You have to find the minimum possible inconvenience of the roads after closing down one of the roads." 2500

835E "The penguin\'s game" "binary search,constructive algorithms,interactive" "In the Kingdom K., there are n towns numbered with integers from 1 to n. The towns are connected by n bi-directional roads numbered with integers from 1 to n. The i-th road connects the towns ui and vi and its length is li. There is no more than one road between two towns. Also, there are no roads that connect the towns with itself.Let\'s call the inconvenience of the roads the maximum of the shortest distances between all pairs of towns.Because of lack of money, it was decided to close down one of the roads so that after its removal it is still possible to reach any town from any other. You have to find the minimum possible inconvenience of the roads after closing down one of the roads." 2400

835D "Palindromic characteristics" "brute force,dp,hashing,strings" "Palindromic characteristics of string s with length |s| is a sequence of |s| integers, where k-th number is the total number of non-empty substrings of s which are k-palindromes.A string is 1-palindrome if and only if it reads the same backward as forward.A string is k-palindrome (k\xe2\x80\x89>\xe2\x80\x891) if and only if:   Its left half equals to its right half.  Its left and right halfs are non-empty (k\xe2\x80\x89-\xe2\x80\x891)-palindromes. The left half of string t is its prefix of length \xe2\x8c\x8a|t|\xe2\x80\x89/\xe2\x80\x892\xe2\x8c\x8b, and right half�\xe2\x80\x94 the suffix of the same length. \xe2\x8c\x8a|t|\xe2\x80\x89/\xe2\x80\x892\xe2\x8c\x8b denotes the length of string t divided by 2, rounded down.Note that each substring is counted as many times as it appears in the string. For example, in the string ""aaa"" the substring ""a"" appears 3 times." 1900

835C "Star sky" dp,implementation "The Cartesian coordinate system is set in the sky. There you can see n stars, the i-th has coordinates (xi, yi), a maximum brightness c, equal for all stars, and an initial brightness si (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89si\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c).Over time the stars twinkle. At moment 0 the i-th star has brightness si. Let at moment t some star has brightness x. Then at moment (t\xe2\x80\x89+\xe2\x80\x891) this star will have brightness x\xe2\x80\x89+\xe2\x80\x891, if x\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c, and 0, otherwise.You want to look at the sky q times. In the i-th time you will look at the moment ti and you will see a rectangle with sides parallel to the coordinate axes, the lower left corner has coordinates (x1i, y1i) and the upper right�\xe2\x80\x94 (x2i, y2i). For each view, you want to know the total brightness of the stars lying in the viewed rectangle.A star lies in a rectangle if it lies on its border or lies strictly inside it." 1600

835B "The number on the board" greedy "Some natural number was written on the board. Its sum of digits was not less than k. But you were distracted a bit, and someone changed this number to n, replacing some digits with others. It\'s known that the length of the number didn\'t change.You have to find the minimum number of digits in which these two numbers can differ." 1100

835A "Key races" math "Two boys decided to compete in text typing on the site ""Key races"". During the competition, they have to type a text consisting of s characters. The first participant types one character in v1 milliseconds and has ping t1 milliseconds. The second participant types one character in v2 milliseconds and has ping t2 milliseconds.If connection ping (delay) is t milliseconds, the competition passes for a participant as follows:   Exactly after t milliseconds after the start of the competition the participant receives the text to be entered.  Right after that he starts to type it.  Exactly t milliseconds after he ends typing all the text, the site receives information about it. The winner is the participant whose information on the success comes earlier. If the information comes from both participants at the same time, it is considered that there is a draw.Given the length of the text and the information about participants, determine the result of the game." 800

834B "The Festive Evening" "data structures,implementation" "It\'s the end of July�\xe2\x80\x93 the time when a festive evening is held at Jelly Castle! Guests from all over the kingdom gather here to discuss new trends in the world of confectionery. Yet some of the things discussed here are not supposed to be disclosed to the general public: the information can cause discord in the kingdom of Sweetland in case it turns out to reach the wrong hands. So it\'s a necessity to not let any uninvited guests in.There are 26 entrances in Jelly Castle, enumerated with uppercase English letters from A to Z. Because of security measures, each guest is known to be assigned an entrance he should enter the castle through. The door of each entrance is opened right before the first guest\'s arrival and closed right after the arrival of the last guest that should enter the castle through this entrance. No two guests can enter the castle simultaneously.For an entrance to be protected from possible intrusion, a candy guard should be assigned to it. There are k such guards in the castle, so if there are more than k opened doors, one of them is going to be left unguarded! Notice that a guard can\'t leave his post until the door he is assigned to is closed.Slastyona had a suspicion that there could be uninvited guests at the evening. She knows the order in which the invited guests entered the castle, and wants you to help her check whether there was a moment when more than k doors were opened." 1100

834A "The Useless Toy" implementation "Walking through the streets of Marshmallow City, Slastyona have spotted some merchants selling a kind of useless toy which is very popular nowadays�\xe2\x80\x93 caramel spinner! Wanting to join the craze, she has immediately bought the strange contraption.Spinners in Sweetland have the form of V-shaped pieces of caramel. Each spinner can, well, spin around an invisible magic axis. At a specific point in time, a spinner can take 4 positions shown below (each one rotated 90 degrees relative to the previous, with the fourth one followed by the first one):  After the spinner was spun, it starts its rotation, which is described by a following algorithm: the spinner maintains its position for a second then majestically switches to the next position in clockwise or counter-clockwise order, depending on the direction the spinner was spun in.Slastyona managed to have spinner rotating for exactly n seconds. Being fascinated by elegance of the process, she completely forgot the direction the spinner was spun in! Lucky for her, she managed to recall the starting position, and wants to deduct the direction given the information she knows. Help her do this." 900

833E "Caramel Clouds" "data structures,dp,sortings" "It is well-known that the best decoration for a flower bed in Sweetland are vanilla muffins. Seedlings of this plant need sun to grow up. Slastyona has m seedlings, and the j-th seedling needs at least kj minutes of sunlight to grow up.Most of the time it\'s sunny in Sweetland, but sometimes some caramel clouds come, the i-th of which will appear at time moment (minute) li and disappear at time moment ri. Of course, the clouds make shadows, and the seedlings can\'t grow when there is at least one cloud veiling the sun.Slastyona wants to grow up her muffins as fast as possible. She has exactly C candies, which is the main currency in Sweetland. One can dispel any cloud by paying ci candies. However, in order to comply with Sweetland\'s Department of Meteorology regulations, one can\'t dispel more than two clouds.Slastyona hasn\'t decided yet which of the m seedlings will be planted at the princess\' garden, so she needs your help. For each seedling determine the earliest moment it can grow up if Slastyona won\'t break the law and won\'t spend more candies than she has. Note that each of the seedlings is considered independently.The seedlings start to grow at time moment 0." 3400

833D "Red-Black Cobweb" "data structures,divide and conquer,implementation,trees" "Slastyona likes to watch life of nearby grove\'s dwellers. This time she watches a strange red-black spider sitting at the center of a huge cobweb.The cobweb is a set of n nodes connected by threads, each of the treads is either red of black. Using these threads, the spider can move between nodes. No thread connects a node to itself, and between any two nodes there is a unique sequence of threads connecting them.Slastyona decided to study some special qualities of the cobweb. She noticed that each of the threads has a value of clamminess x.However, Slastyona is mostly interested in jelliness of the cobweb. Consider those of the shortest paths between each pair of nodes on which the numbers of red and black threads differ at most twice. For each such path compute the product of the clamminess of threads on the path.The jelliness of the cobweb is the product of all obtained values among all paths. Those paths that differ by direction only are counted only once.Of course, this number can be huge, so Slastyona asks you to compute the jelliness of the given cobweb and print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2800

833C "Ever-Hungry Krakozyabra" "brute force,combinatorics,greedy,math" "Recently, a wild Krakozyabra appeared at Jelly Castle. It is, truth to be said, always eager to have something for dinner.Its favorite meal is natural numbers (typically served with honey sauce), or, to be more precise, the zeros in their corresponding decimal representations. As for other digits, Krakozyabra dislikes them; moreover, they often cause it indigestion! So, as a necessary precaution, Krakozyabra prefers to sort the digits of a number in non-descending order before proceeding to feast. Then, the leading zeros of the resulting number are eaten and the remaining part is discarded as an inedible tail.For example, if Krakozyabra is to have the number 57040 for dinner, its inedible tail would be the number 457.Slastyona is not really fond of the idea of Krakozyabra living in her castle. Hovewer, her natural hospitality prevents her from leaving her guest without food. Slastyona has a range of natural numbers from L to R, which she is going to feed the guest with. Help her determine how many distinct inedible tails are going to be discarded by Krakozyabra by the end of the dinner." 2700

833B "The Bakery" "binary search,data structures,divide and conquer,dp,two pointers" "Some time ago Slastyona the Sweetmaid decided to open her own bakery! She bought required ingredients and a wonder-oven which can bake several types of cakes, and opened the bakery.Soon the expenses started to overcome the income, so Slastyona decided to study the sweets market. She learned it\'s profitable to pack cakes in boxes, and that the more distinct cake types a box contains (let\'s denote this number as the value of the box), the higher price it has.She needs to change the production technology! The problem is that the oven chooses the cake types on its own and Slastyona can\'t affect it. However, she knows the types and order of n cakes the oven is going to bake today. Slastyona has to pack exactly k boxes with cakes today, and she has to put in each box several (at least one) cakes the oven produced one right after another (in other words, she has to put in a box a continuous segment of cakes).Slastyona wants to maximize the total value of all boxes with cakes. Help her determine this maximum possible total value." 2200

833A "The Meaningless Game" "math,number theory" "Slastyona and her loyal dog Pushok are playing a meaningless game that is indeed very interesting.The game consists of multiple rounds. Its rules are very simple: in each round, a natural number k is chosen. Then, the one who says (or barks) it faster than the other wins the round. After that, the winner\'s score is multiplied by k2, and the loser\'s score is multiplied by k. In the beginning of the game, both Slastyona and Pushok have scores equal to one.Unfortunately, Slastyona had lost her notepad where the history of all n games was recorded. She managed to recall the final results for each games, though, but all of her memories of them are vague. Help Slastyona verify their correctness, or, to put it another way, for each given pair of scores determine whether it was possible for a game to finish with such result or not." 1700

832E "Vasya and Shifts" matrices "Vasya has a set of 4n strings of equal length, consisting of lowercase English letters ""a"", ""b"", ""c"", ""d"" and ""e"". Moreover, the set is split into n groups of 4 equal strings each. Vasya also has one special string a of the same length, consisting of letters ""a"" only.Vasya wants to obtain from string a some fixed string b, in order to do this, he can use the strings from his set in any order. When he uses some string x, each of the letters in string a replaces with the next letter in alphabet as many times as the alphabet position, counting from zero, of the corresponding letter in string x. Within this process the next letter in alphabet after ""e"" is ""a"".For example, if some letter in a equals ""b"", and the letter on the same position in x equals ""c"", then the letter in a becomes equal ""d"", because ""c"" is the second alphabet letter, counting from zero. If some letter in a equals ""e"", and on the same position in x is ""d"", then the letter in a becomes ""c"". For example, if the string a equals ""abcde"", and string x equals ""baddc"", then a becomes ""bbabb"".A used string disappears, but Vasya can use equal strings several times.Vasya wants to know for q given strings b, how many ways there are to obtain from the string a string b using the given set of 4n strings? Two ways are different if the number of strings used from some group of 4 strings is different. Help Vasya compute the answers for these questions modulo 109\xe2\x80\x89+\xe2\x80\x897." 2600

832D "Misha, Grisha and Underground" "dfs and similar,graphs,trees" "Misha and Grisha are funny boys, so they like to use new underground. The underground has n stations connected with n\xe2\x80\x89-\xe2\x80\x891 routes so that each route connects two stations, and it is possible to reach every station from any other.The boys decided to have fun and came up with a plan. Namely, in some day in the morning Misha will ride the underground from station s to station f by the shortest path, and will draw with aerosol an ugly text ""Misha was here"" on every station he will pass through (including s and f). After that on the same day at evening Grisha will ride from station t to station f by the shortest path and will count stations with Misha\'s text. After that at night the underground workers will wash the texts out, because the underground should be clean. The boys have already chosen three stations a, b and c for each of several following days, one of them should be station s on that day, another should be station f, and the remaining should be station t. They became interested how they should choose these stations s, f, t so that the number Grisha will count is as large as possible. They asked you for help." 1900

832C "Strange Radiation" "binary search,implementation,math" "n people are standing on a coordinate axis in points with positive integer coordinates strictly less than 106. For each person we know in which direction (left or right) he is facing, and his maximum speed.You can put a bomb in some point with non-negative integer coordinate, and blow it up. At this moment all people will start running with their maximum speed in the direction they are facing. Also, two strange rays will start propagating from the bomb with speed s: one to the right, and one to the left. Of course, the speed s is strictly greater than people\'s maximum speed.The rays are strange because if at any moment the position and the direction of movement of some ray and some person coincide, then the speed of the person immediately increases by the speed of the ray.You need to place the bomb is such a point that the minimum time moment in which there is a person that has run through point 0, and there is a person that has run through point 106, is as small as possible. In other words, find the minimum time moment t such that there is a point you can place the bomb to so that at time moment t some person has run through 0, and some person has run through point 106." 2500

832B "Petya and Exam" implementation,strings "It\'s hard times now. Today Petya needs to score 100 points on Informatics exam. The tasks seem easy to Petya, but he thinks he lacks time to finish them all, so he asks you to help with one..There is a glob pattern in the statements (a string consisting of lowercase English letters, characters ""?"" and ""*""). It is known that character ""*"" occurs no more than once in the pattern.Also, n query strings are given, it is required to determine for each of them if the pattern matches it or not.Everything seemed easy to Petya, but then he discovered that the special pattern characters differ from their usual meaning.A pattern matches a string if it is possible to replace each character ""?"" with one good lowercase English letter, and the character ""*"" (if there is one) with any, including empty, string of bad lowercase English letters, so that the resulting string is the same as the given string.The good letters are given to Petya. All the others are bad." 1600

832A "Sasha and Sticks" games,math "It\'s one more school day now. Sasha doesn\'t like classes and is always bored at them. So, each day he invents some game and plays in it alone or with friends.Today he invented one simple game to play with Lena, with whom he shares a desk. The rules are simple. Sasha draws n sticks in a row. After that the players take turns crossing out exactly k sticks from left or right in each turn. Sasha moves first, because he is the inventor of the game. If there are less than k sticks on the paper before some turn, the game ends. Sasha wins if he makes strictly more moves than Lena. Sasha wants to know the result of the game before playing, you are to help him." 800

831C "Jury Marks" "brute force,constructive algorithms" "Polycarp watched TV-show where k jury members one by one rated a participant by adding him a certain number of points (may be negative, i.�e. points were subtracted). Initially the participant had some score, and each the marks were one by one added to his score. It is known that the i-th jury member gave ai points.Polycarp does not remember how many points the participant had before this k marks were given, but he remembers that among the scores announced after each of the k judges rated the participant there were n (n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) values b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn (it is guaranteed that all values bj are distinct). It is possible that Polycarp remembers not all of the scores announced, i.�e. n\xe2\x80\x89<\xe2\x80\x89k. Note that the initial score wasn\'t announced.Your task is to determine the number of options for the score the participant could have before the judges rated the participant." 1700

831B "Keyboard Layouts" implementation,strings "There are two popular keyboard layouts in Berland, they differ only in letters positions. All the other keys are the same. In Berland they use alphabet with 26 letters which coincides with English alphabet.You are given two strings consisting of 26 distinct letters each: all keys of the first and the second layouts in the same order. You are also given some text consisting of small and capital English letters and digits. It is known that it was typed in the first layout, but the writer intended to type it in the second layout. Print the text if the same keys were pressed in the second layout.Since all keys but letters are the same in both layouts, the capitalization of the letters should remain the same, as well as all other characters." 800

831A "Unimodal Array" implementation "Array of integers is unimodal, if:  it is strictly increasing in the beginning;  after that it is constant;  after that it is strictly decreasing. The first block (increasing) and the last block (decreasing) may be absent. It is allowed that both of this blocks are absent.For example, the following three arrays are unimodal: [5,\xe2\x80\x897,\xe2\x80\x8911,\xe2\x80\x8911,\xe2\x80\x892,\xe2\x80\x891], [4,\xe2\x80\x894,\xe2\x80\x892], [7], but the following three are not unimodal: [5,\xe2\x80\x895,\xe2\x80\x896,\xe2\x80\x896,\xe2\x80\x891], [1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x892], [4,\xe2\x80\x895,\xe2\x80\x895,\xe2\x80\x896].Write a program that checks if an array is unimodal." 1000

830E "Perpetual Motion Machine" "constructive algorithms,dp,graphs,implementation,math,trees" "Developer Petr thinks that he invented a perpetual motion machine. Namely, he has a lot of elements, which work in the following way.Each element has one controller that can be set to any non-negative real value. If a controller is set on some value x, then the controller consumes x2 energy units per second. At the same time, any two elements connected by a wire produce y\xc2\xb7z energy units per second, where y and z are the values set on their controllers.Petr has only a limited number of wires, so he has already built some scheme of elements and wires, and is now interested if it\'s possible to set the controllers in such a way that the system produces at least as much power as it consumes, and at least one controller is set on the value different from 0. Help him check this, and if it\'s possible, find the required integer values that should be set.It is guaranteed that if there exist controllers\' settings satisfying the above conditions, then there exist required integer values not greater than 106." 3100

830D "Singer House" combinatorics,dp,graphs,trees "It is known that passages in Singer house are complex and intertwined. Let\'s define a Singer k-house as a graph built by the following process: take complete binary tree of height k and add edges from each vertex to all its successors, if they are not yet present.  Singer 4-house Count the number of non-empty paths in Singer k-house which do not pass the same vertex twice. Two paths are distinct if the sets or the orders of visited vertices are different. Since the answer can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2800

830C "Bamboo Partition" "brute force,data structures,implementation,math,number theory,sortings,two pointers" "Vladimir wants to modernize partitions in his office. To make the office more comfortable he decided to remove a partition and plant several bamboos in a row. He thinks it would be nice if there are n bamboos in a row, and the i-th from the left is ai meters high. Vladimir has just planted n bamboos in a row, each of which has height 0 meters right now, but they grow 1 meter each day. In order to make the partition nice Vladimir can cut each bamboo once at any height (no greater that the height of the bamboo), and then the bamboo will stop growing.Vladimir wants to check the bamboos each d days (i.e. d days after he planted, then after 2d days and so on), and cut the bamboos that reached the required height. Vladimir wants the total length of bamboo parts he will cut off to be no greater than k meters.What is the maximum value d he can choose so that he can achieve what he wants without cutting off more than k meters of bamboo?" 2300

830B "Cards Sorting" "data structures,implementation,sortings" "Vasily has a deck of cards consisting of n cards. There is an integer on each of the cards, this integer is between 1 and 100\xe2\x80\x89000, inclusive. It is possible that some cards have the same integers on them.Vasily decided to sort the cards. To do this, he repeatedly takes the top card from the deck, and if the number on it equals the minimum number written on the cards in the deck, then he places the card away. Otherwise, he puts it under the deck and takes the next card from the top, and so on. The process ends as soon as there are no cards in the deck. You can assume that Vasily always knows the minimum number written on some card in the remaining deck, but doesn\'t know where this card (or these cards) is.You are to determine the total number of times Vasily takes the top card from the deck." 1600

830A "Office Keys" "binary search,brute force,dp,greedy,sortings" "There are n people and k keys on a straight line. Every person wants to get to the office which is located on the line as well. To do that, he needs to reach some point with a key, take the key and then go to the office. Once a key is taken by somebody, it couldn\'t be taken by anybody else.You are to determine the minimum time needed for all n people to get to the office with keys. Assume that people move a unit distance per 1 second. If two people reach a key at the same time, only one of them can take the key. A person can pass through a point with a key without taking it." 1800

828B "Black Square" implementation "Polycarp has a checkered sheet of paper of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Polycarp painted some of cells with black, the others remained white. Inspired by Malevich\'s ""Black Square"", Polycarp wants to paint minimum possible number of white cells with black so that all black cells form a square.You are to determine the minimum possible number of cells needed to be painted black so that the black cells form a black square with sides parallel to the painting\'s sides. All the cells that do not belong to the square should be white. The square\'s side should have positive length." 1300

828A "Restaurant Tables" implementation "In a small restaurant there are a tables for one person and b tables for two persons. It it known that n groups of people come today, each consisting of one or two people. If a group consist of one person, it is seated at a vacant one-seater table. If there are none of them, it is seated at a vacant two-seater table. If there are none of them, it is seated at a two-seater table occupied by single person. If there are still none of them, the restaurant denies service to this group.If a group consist of two people, it is seated at a vacant two-seater table. If there are none of them, the restaurant denies service to this group.You are given a chronological order of groups coming. You are to determine the total number of people the restaurant denies service to." 1200

827F "Dirty Arkady\'s Kitchen" "data structures,dp,graphs,shortest paths" "In a small restaurant there are a tables for one person and b tables for two persons. It it known that n groups of people come today, each consisting of one or two people. If a group consist of one person, it is seated at a vacant one-seater table. If there are none of them, it is seated at a vacant two-seater table. If there are none of them, it is seated at a two-seater table occupied by single person. If there are still none of them, the restaurant denies service to this group.If a group consist of two people, it is seated at a vacant two-seater table. If there are none of them, the restaurant denies service to this group.You are given a chronological order of groups coming. You are to determine the total number of people the restaurant denies service to." 3200

827E "Rusty String" fft,math,strings "Grigory loves strings. Recently he found a metal strip on a loft. The strip had length n and consisted of letters ""V"" and ""K"". Unfortunately, rust has eaten some of the letters so that it\'s now impossible to understand which letter was written.Grigory couldn\'t understand for a long time what these letters remind him of, so he became interested in the following question: if we put a letter ""V"" or ""K"" on each unreadable position, which values can the period of the resulting string be equal to?A period of a string is such an integer d from 1 to the length of the string that if we put the string shifted by d positions to the right on itself, then all overlapping letters coincide. For example, 3 and 5 are periods of ""VKKVK""." 2700

827D "Best Edge Weight" "data structures,dfs and similar,graphs,trees" "You are given a connected weighted graph with n vertices and m edges. The graph doesn\'t contain loops nor multiple edges. Consider some edge with id i. Let\'s determine for this edge the maximum integer weight we can give to it so that it is contained in all minimum spanning trees of the graph if we don\'t change the other weights.You are to determine this maximum weight described above for each edge. You should calculate the answer for each edge independently, it means there can\'t be two edges with changed weights at the same time." 2700

827C "DNA Evolution" "data structures,strings" "Everyone knows that DNA strands consist of nucleotides. There are four types of nucleotides: ""A"", ""T"", ""G"", ""C"". A DNA strand is a sequence of nucleotides. Scientists decided to track evolution of a rare species, which DNA strand was string s initially. Evolution of the species is described as a sequence of changes in the DNA. Every change is a change of some nucleotide, for example, the following change can happen in DNA strand ""AAGC"": the second nucleotide can change to ""T"" so that the resulting DNA strand is ""ATGC"".Scientists know that some segments of the DNA strand can be affected by some unknown infections. They can represent an infection as a sequence of nucleotides. Scientists are interested if there are any changes caused by some infections. Thus they sometimes want to know the value of impact of some infection to some segment of the DNA. This value is computed as follows:  Let the infection be represented as a string e, and let scientists be interested in DNA strand segment starting from position l to position r, inclusive.  Prefix of the string eee... (i.e. the string that consists of infinitely many repeats of string e) is written under the string s from position l to position r, inclusive.  The value of impact is the number of positions where letter of string s coincided with the letter written under it. Being a developer, Innokenty is interested in bioinformatics also, so the scientists asked him for help. Innokenty is busy preparing VK Cup, so he decided to delegate the problem to the competitors. Help the scientists!" 2100

827B "High Load" "constructive algorithms,greedy,implementation,trees" "Arkady needs your help again! This time he decided to build his own high-speed Internet exchange point. It should consist of n nodes connected with minimum possible number of wires into one network (a wire directly connects two nodes). Exactly k of the nodes should be exit-nodes, that means that each of them should be connected to exactly one other node of the network, while all other nodes should be connected to at least two nodes in order to increase the system stability.Arkady wants to make the system as fast as possible, so he wants to minimize the maximum distance between two exit-nodes. The distance between two nodes is the number of wires a package needs to go through between those two nodes.Help Arkady to find such a way to build the network that the distance between the two most distant exit-nodes is as small as possible." 1800

827A "String Reconstruction" "data structures,greedy,sortings,strings" "Ivan had string s consisting of small English letters. However, his friend Julia decided to make fun of him and hid the string s. Ivan preferred making a new string to finding the old one. Ivan knows some information about the string s. Namely, he remembers, that string ti occurs in string s at least ki times or more, he also remembers exactly ki positions where the string ti occurs in string s: these positions are xi,\xe2\x80\x891,\xe2\x80\x89xi,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89xi,\xe2\x80\x89ki. He remembers n such strings ti.You are to reconstruct lexicographically minimal string s such that it fits all the information Ivan remembers. Strings ti and string s consist of small English letters only." 1700

825G "Tree Queries" "dfs and similar,graphs,trees" "You are given a tree consisting of n vertices (numbered from 1 to n). Initially all vertices are white. You have to process q queries of two different types:  1 x \xe2\x80\x94 change the color of vertex x to black. It is guaranteed that the first query will be of this type.  2 x \xe2\x80\x94 for the vertex x, find the minimum index y such that the vertex with index y belongs to the simple path from x to some black vertex (a simple path never visits any vertex more than once). For each query of type 2 print the answer to it.Note that the queries are given in modified way." 2500

825F "String Compression" "dp,hashing,string suffix structures,strings" "Ivan wants to write a letter to his friend. The letter is a string s consisting of lowercase Latin letters.Unfortunately, when Ivan started writing the letter, he realised that it is very long and writing the whole letter may take extremely long time. So he wants to write the compressed version of string s instead of the string itself.The compressed version of string s is a sequence of strings c1,\xe2\x80\x89s1,\xe2\x80\x89c2,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89ck,\xe2\x80\x89sk, where ci is the decimal representation of number ai (without any leading zeroes) and si is some string consisting of lowercase Latin letters. If Ivan writes string s1 exactly a1 times, then string s2 exactly a2 times, and so on, the result will be string s.The length of a compressed version is |c1|\xe2\x80\x89+\xe2\x80\x89|s1|\xe2\x80\x89+\xe2\x80\x89|c2|\xe2\x80\x89+\xe2\x80\x89|s2|... |ck|\xe2\x80\x89+\xe2\x80\x89|sk|. Among all compressed versions Ivan wants to choose a version such that its length is minimum possible. Help Ivan to determine minimum possible length." 2400

825E "Minimal Labels" "data structures,dfs and similar,graphs,greedy" "You are given a directed acyclic graph with n vertices and m edges. There are no self-loops or multiple edges between any pair of vertices. Graph can be disconnected.You should assign labels to all vertices in such a way that:  Labels form a valid permutation of length n \xe2\x80\x94 an integer sequence such that each integer from 1 to n appears exactly once in it.  If there exists an edge from vertex v to vertex u then labelv should be smaller than labelu.  Permutation should be lexicographically smallest among all suitable. Find such sequence of labels to satisfy all the conditions." 2300

825D "Suitable Replacement" "binary search,greedy,implementation" "You are given two strings s and t consisting of small Latin letters, string s can also contain \'?\' characters. Suitability of string s is calculated by following metric:Any two letters can be swapped positions, these operations can be performed arbitrary number of times over any pair of positions. Among all resulting strings s, you choose the one with the largest number of non-intersecting occurrences of string t. Suitability is this number of occurrences.You should replace all \'?\' characters with small Latin letters in such a way that the suitability of string s is maximal." 1500

825C "Multi-judge Solving" greedy,implementation "Makes solves problems on Decoforces and lots of other different online judges. Each problem is denoted by its difficulty \xe2\x80\x94 a positive integer number. Difficulties are measured the same across all the judges (the problem with difficulty d on Decoforces is as hard as the problem with difficulty d on any other judge). Makes has chosen n problems to solve on Decoforces with difficulties a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. He can solve these problems in arbitrary order. Though he can solve problem i with difficulty ai only if he had already solved some problem with difficulty  (no matter on what online judge was it).Before starting this chosen list of problems, Makes has already solved problems with maximum difficulty k.With given conditions it\'s easy to see that Makes sometimes can\'t solve all the chosen problems, no matter what order he chooses. So he wants to solve some problems on other judges to finish solving problems from his list. For every positive integer y there exist some problem with difficulty y on at least one judge besides Decoforces.Makes can solve problems on any judge at any time, it isn\'t necessary to do problems from the chosen list one right after another.Makes doesn\'t have too much free time, so he asked you to calculate the minimum number of problems he should solve on other judges in order to solve all the chosen problems from Decoforces." 1600

825B Five-In-a-Row "brute force,implementation" "Alice and Bob play 5-in-a-row game. They have a playing field of size 10\xe2\x80\x89\xc3\x97\xe2\x80\x8910. In turns they put either crosses or noughts, one at a time. Alice puts crosses and Bob puts noughts.In current match they have made some turns and now it\'s Alice\'s turn. She wonders if she can put cross in such empty cell that she wins immediately.Alice wins if some crosses in the field form line of length not smaller than 5. This line can be horizontal, vertical and diagonal." 1600

825A "Binary Protocol" implementation "Polycarp has just invented a new binary protocol for data transmission. He is encoding positive integer decimal number to binary string using following algorithm:  Each digit is represented with number of \'1\' characters equal to the value of that digit (for 0 it is zero ones).  Digits are written one by one in order corresponding to number and separated by single \'0\' character. Though Polycarp learnt how to encode the numbers, he has no idea how to decode them back. Help him calculate the decoded number." 1100

822F Madness "constructive algorithms,dfs and similar,trees" "The second semester starts at the University of Pavlopolis. After vacation in Vi\xc4\x8dkopolis Noora needs to return to Pavlopolis and continue her study.Sometimes (or quite often) there are teachers who do not like you. Incidentally Noora also has one such teacher. His name is Yury Dmitrievich and he teaches graph theory. Yury Dmitrievich doesn\'t like Noora, so he always gives the girl the most difficult tasks. So it happened this time.The teacher gives Noora a tree with n vertices. Vertices are numbered with integers from 1 to n. The length of all the edges of this tree is 1. Noora chooses a set of simple paths that pairwise don\'t intersect in edges. However each vertex should belong to at least one of the selected path.For each of the selected paths, the following is done:  We choose exactly one edge (u,\xe2\x80\x89v) that belongs to the path.  On the selected edge (u,\xe2\x80\x89v) there is a point at some selected distance x from the vertex u and at distance 1\xe2\x80\x89-\xe2\x80\x89x from vertex v. But the distance x chosen by Noora arbitrarily, i. e. it can be different for different edges.  One of the vertices u or v is selected. The point will start moving to the selected vertex. Let us explain how the point moves by example. Suppose that the path consists of two edges (v1,\xe2\x80\x89v2) and (v2,\xe2\x80\x89v3), the point initially stands on the edge (v1,\xe2\x80\x89v2) and begins its movement to the vertex v1. Then the point will reach v1, then ""turn around"", because the end of the path was reached, further it will move in another direction to vertex v2, then to vertex v3, then ""turn around"" again, then move to v2 and so on. The speed of the points is 1 edge per second. For example, for 0.5 second the point moves to the length of the half of an edge.A stopwatch is placed at each vertex of the tree. The time that the stopwatches indicate at start time is 0 seconds. Then at the starting moment of time, all points simultaneously start moving from the selected positions to selected directions along the selected paths, and stopwatches are simultaneously started. When one of the points reaches the vertex v, the stopwatch at the vertex v is automatically reset, i.e. it starts counting the time from zero.Denote by resv the maximal time that the stopwatch at the vertex v will show if the point movement continues infinitely. Noora is asked to select paths and points on them so that res1 is as minimal as possible. If there are several solutions to do this, it is necessary to minimize res2, then res3, res4,\xe2\x80\x89...,\xe2\x80\x89resn.Help Noora complete the teacher\'s task.For the better understanding of the statement, see the explanation for the example." 2500

822E Liar "binary search,dp,hashing,string suffix structures" "The first semester ended. You know, after the end of the first semester the holidays begin. On holidays Noora decided to return to Vi\xc4\x8dkopolis. As a modest souvenir for Leha, she brought a sausage of length m from Pavlopolis. Everyone knows that any sausage can be represented as a string of lowercase English letters, the length of which is equal to the length of the sausage.Leha was very pleased with the gift and immediately ate the sausage. But then he realized that it was a quite tactless act, because the sausage was a souvenir! So the hacker immediately went to the butcher shop. Unfortunately, there was only another sausage of length n in the shop. However Leha was not upset and bought this sausage. After coming home, he decided to cut the purchased sausage into several pieces and number the pieces starting from 1 from left to right. Then he wants to select several pieces and glue them together so that the obtained sausage is equal to the sausage that Noora gave. But the hacker can glue two pieces together only when the number of the left piece is less than the number of the right piece. Besides he knows that if he glues more than x pieces, Noora will notice that he has falsified souvenir sausage and will be very upset. Of course Leha doesn\xe2\x80\x99t want to upset the girl. The hacker asks you to find out whether he is able to cut the sausage he bought, and then glue some of the pieces so that Noora doesn\'t notice anything.Formally, you are given two strings s and t. The length of the string s is n, the length of the string t is m. It is required to select several pairwise non-intersecting substrings from s, so that their concatenation in the same order as these substrings appear in s, is equal to the string t. Denote by f(s,\xe2\x80\x89t) the minimal number of substrings to be chosen so that their concatenation is equal to the string t. If it is impossible to choose such substrings, then f(s,\xe2\x80\x89t)\xe2\x80\x89=\xe2\x80\x89\xe2\x88\x9e. Leha really wants to know whether it\xe2\x80\x99s true that f(s,\xe2\x80\x89t)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x." 2400

822D "My pretty girl Noora" "brute force,dp,greedy,math,number theory" "In Pavlopolis University where Noora studies it was decided to hold beauty contest ""Miss Pavlopolis University"". Let\'s describe the process of choosing the most beautiful girl in the university in more detail.The contest is held in several stages. Suppose that exactly n girls participate in the competition initially. All the participants are divided into equal groups, x participants in each group. Furthermore the number x is chosen arbitrarily, i. e. on every stage number x can be different. Within each group the jury of the contest compares beauty of the girls in the format ""each with each"". In this way, if group consists of x girls, then  comparisons occur. Then, from each group, the most beautiful participant is selected. Selected girls enter the next stage of the competition. Thus if n girls were divided into groups, x participants in each group, then exactly  participants will enter the next stage. The contest continues until there is exactly one girl left who will be ""Miss Pavlopolis University""But for the jury this contest is a very tedious task. They would like to divide the girls into groups in each stage so that the total number of pairwise comparisons of the girls is as few as possible. Let f(n) be the minimal total number of comparisons that should be made to select the most beautiful participant, if we admit n girls to the first stage.The organizers of the competition are insane. They give Noora three integers t, l and r and ask the poor girl to calculate the value of the following expression: t0\xc2\xb7f(l)\xe2\x80\x89+\xe2\x80\x89t1\xc2\xb7f(l\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89tr\xe2\x80\x89-\xe2\x80\x89l\xc2\xb7f(r). However, since the value of this expression can be quite large the organizers ask her to calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897. If Noora can calculate the value of this expression the organizers promise her to help during the beauty contest. But the poor girl is not strong in mathematics, so she turned for help to Leha and he turned to you." 1800

822C "Hacker, pack your bags!" "binary search,greedy,implementation,sortings" "It\'s well known that the best way to distract from something is to do one\'s favourite thing. Job is such a thing for Leha.So the hacker began to work hard in order to get rid of boredom. It means that Leha began to hack computers all over the world. For such zeal boss gave the hacker a vacation of exactly x days. You know the majority of people prefer to go somewhere for a vacation, so Leha immediately went to the travel agency. There he found out that n vouchers left. i-th voucher is characterized by three integers li, ri, costi \xe2\x80\x94 day of departure from Vi\xc4\x8dkopolis, day of arriving back in Vi\xc4\x8dkopolis and cost of the voucher correspondingly. The duration of the i-th voucher is a value ri\xe2\x80\x89-\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891.At the same time Leha wants to split his own vocation into two parts. Besides he wants to spend as little money as possible. Formally Leha wants to choose exactly two vouchers i and j (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) so that they don\'t intersect, sum of their durations is exactly x and their total cost is as minimal as possible. Two vouchers i and j don\'t intersect if only at least one of the following conditions is fulfilled: ri\xe2\x80\x89<\xe2\x80\x89lj or rj\xe2\x80\x89<\xe2\x80\x89li.Help Leha to choose the necessary vouchers!" 1600

822B "Crossword solving" "brute force,implementation,strings" "Erelong Leha was bored by calculating of the greatest common divisor of two factorials. Therefore he decided to solve some crosswords. It\'s well known that it is a very interesting occupation though it can be very difficult from time to time. In the course of solving one of the crosswords, Leha had to solve a simple task. You are able to do it too, aren\'t you?Leha has two strings s and t. The hacker wants to change the string s at such way, that it can be found in t as a substring. All the changes should be the following: Leha chooses one position in the string s and replaces the symbol in this position with the question mark ""?"". The hacker is sure that the question mark in comparison can play the role of an arbitrary symbol. For example, if he gets string s=""ab?b"" as a result, it will appear in t=""aabrbb"" as a substring.Guaranteed that the length of the string s doesn\'t exceed the length of the string t. Help the hacker to replace in s as few symbols as possible so that the result of the replacements can be found in t as a substring. The symbol ""?"" should be considered equal to any other symbol." 1000

822A "I\'m bored with life" "implementation,math,number theory" "Erelong Leha was bored by calculating of the greatest common divisor of two factorials. Therefore he decided to solve some crosswords. It\'s well known that it is a very interesting occupation though it can be very difficult from time to time. In the course of solving one of the crosswords, Leha had to solve a simple task. You are able to do it too, aren\'t you?Leha has two strings s and t. The hacker wants to change the string s at such way, that it can be found in t as a substring. All the changes should be the following: Leha chooses one position in the string s and replaces the symbol in this position with the question mark ""?"". The hacker is sure that the question mark in comparison can play the role of an arbitrary symbol. For example, if he gets string s=""ab?b"" as a result, it will appear in t=""aabrbb"" as a substring.Guaranteed that the length of the string s doesn\'t exceed the length of the string t. Help the hacker to replace in s as few symbols as possible so that the result of the replacements can be found in t as a substring. The symbol ""?"" should be considered equal to any other symbol." 800

821E "Okabe and El Psy Kongroo" dp,matrices "Okabe likes to take walks but knows that spies from the Organization could be anywhere; that\'s why he wants to know how many different walks he can take in his city safely. Okabe\'s city can be represented as all points (x,\xe2\x80\x89y) such that x and y are non-negative. Okabe starts at the origin (point (0,\xe2\x80\x890)), and needs to reach the point (k,\xe2\x80\x890). If Okabe is currently at the point (x,\xe2\x80\x89y), in one step he can go to (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), or (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891).Additionally, there are n horizontal line segments, the i-th of which goes from x\xe2\x80\x89=\xe2\x80\x89ai to x\xe2\x80\x89=\xe2\x80\x89bi inclusive, and is at y\xe2\x80\x89=\xe2\x80\x89ci. It is guaranteed that a1\xe2\x80\x89=\xe2\x80\x890, an\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bn, and ai\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x891 for 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. The i-th line segment forces Okabe to walk with y-value in the range 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci when his x value satisfies ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi, or else he might be spied on. This also means he is required to be under two line segments when one segment ends and another begins.Okabe now wants to know how many walks there are from the origin to the point (k,\xe2\x80\x890) satisfying these conditions, modulo 109\xe2\x80\x89+\xe2\x80\x897." 2100

821D "Okabe and City" "dfs and similar,graphs,shortest paths" "Okabe likes to be able to walk through his city on a path lit by street lamps. That way, he doesn\'t get beaten up by schoolchildren.Okabe\'s city is represented by a 2D grid of cells. Rows are numbered from 1 to n from top to bottom, and columns are numbered 1 to m from left to right. Exactly k cells in the city are lit by a street lamp. It\'s guaranteed that the top-left cell is lit.Okabe starts his walk from the top-left cell, and wants to reach the bottom-right cell. Of course, Okabe will only walk on lit cells, and he can only move to adjacent cells in the up, down, left, and right directions. However, Okabe can also temporarily light all the cells in any single row or column at a time if he pays 1 coin, allowing him to walk through some cells not lit initially. Note that Okabe can only light a single row or column at a time, and has to pay a coin every time he lights a new row or column. To change the row or column that is temporarily lit, he must stand at a cell that is lit initially. Also, once he removes his temporary light from a row or column, all cells in that row/column not initially lit are now not lit.Help Okabe find the minimum number of coins he needs to pay to complete his walk!" 2200

821C "Okabe and Boxes" "data structures,greedy,trees" "Okabe and Super Hacker Daru are stacking and removing boxes. There are n boxes numbered from 1 to n. Initially there are no boxes on the stack.Okabe, being a control freak, gives Daru 2n commands: n of which are to add a box to the top of the stack, and n of which are to remove a box from the top of the stack and throw it in the trash. Okabe wants Daru to throw away the boxes in the order from 1 to n. Of course, this means that it might be impossible for Daru to perform some of Okabe\'s remove commands, because the required box is not on the top of the stack.That\'s why Daru can decide to wait until Okabe looks away and then reorder the boxes in the stack in any way he wants. He can do it at any point of time between Okabe\'s commands, but he can\'t add or remove boxes while he does it.Tell Daru the minimum number of times he needs to reorder the boxes so that he can successfully complete all of Okabe\'s commands. It is guaranteed that every box is added before it is required to be removed." 1500

821B "Okabe and Banana Trees" "brute force,math" "Okabe needs bananas for one of his experiments for some strange reason. So he decides to go to the forest and cut banana trees.Consider the point (x,\xe2\x80\x89y) in the 2D plane such that x and y are integers and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y. There is a tree in such a point, and it has x\xe2\x80\x89+\xe2\x80\x89y bananas. There are no trees nor bananas in other points. Now, Okabe draws a line with equation . Okabe can select a single rectangle with axis aligned sides with all points on or under the line and cut all the trees in all points that are inside or on the border of this rectangle and take their bananas. Okabe\'s rectangle can be degenerate; that is, it can be a line segment or even a point.Help Okabe and find the maximum number of bananas he can get if he chooses the rectangle wisely.Okabe is sure that the answer does not exceed 1018. You can trust him." 1300

821A "Okabe and Future Gadget Laboratory" implementation "Okabe needs to renovate the Future Gadget Laboratory after he tried doing some crazy experiments! The lab is represented as an n by n square grid of integers. A good lab is defined as a lab in which every number not equal to 1 can be expressed as the sum of a number in the same row and a number in the same column. In other words, for every x,\xe2\x80\x89y such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and ax,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x891, there should exist two indices s and t so that ax,\xe2\x80\x89y\xe2\x80\x89=\xe2\x80\x89ax,\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89at,\xe2\x80\x89y, where ai,\xe2\x80\x89j denotes the integer in i-th row and j-th column.Help Okabe determine whether a given lab is good!" 800

820B "Mister B and Angle in Polygon" "constructive algorithms,geometry,math" "On one quiet day all of sudden Mister B decided to draw angle a on his field. Aliens have already visited his field and left many different geometric figures on it. One of the figures is regular convex n-gon (regular convex polygon with n sides).That\'s why Mister B decided to use this polygon. Now Mister B must find three distinct vertices v1, v2, v3 such that the angle  (where v2 is the vertex of the angle, and v1 and v3 lie on its sides) is as close as possible to a. In other words, the value  should be minimum possible.If there are many optimal solutions, Mister B should be satisfied with any of them." 1300

820A "Mister B and Book Reading" implementation "Mister B once received a gift: it was a book about aliens, which he started read immediately. This book had c pages.At first day Mister B read v0 pages, but after that he started to speed up. Every day, starting from the second, he read a pages more than on the previous day (at first day he read v0 pages, at second�\xe2\x80\x94 v0\xe2\x80\x89+\xe2\x80\x89a pages, at third�\xe2\x80\x94 v0\xe2\x80\x89+\xe2\x80\x892a pages, and so on). But Mister B is just a human, so he physically wasn\'t able to read more than v1 pages per day.Also, to refresh his memory, every day, starting from the second, Mister B had to reread last l pages he read on the previous day. Mister B finished the book when he read the last page for the first time.Help Mister B to calculate how many days he needed to finish the book." 900

819E "Mister B and Flight to the Moon" "constructive algorithms,graphs" "In order to fly to the Moon Mister B just needs to solve the following problem.There is a complete indirected graph with n vertices. You need to cover it with several simple cycles of length 3 and 4 so that each edge is in exactly 2 cycles.We are sure that Mister B will solve the problem soon and will fly to the Moon. Will you?" 2800

819D "Mister B and Astronomers" "number theory" "After studying the beacons Mister B decided to visit alien\'s planet, because he learned that they live in a system of flickering star Moon. Moreover, Mister B learned that the star shines once in exactly T seconds. The problem is that the star is yet to be discovered by scientists.There are n astronomers numerated from 1 to n trying to detect the star. They try to detect the star by sending requests to record the sky for 1 second. The astronomers send requests in cycle: the i-th astronomer sends a request exactly ai second after the (i\xe2\x80\x89-\xe2\x80\x891)-th (i.e. if the previous request was sent at moment t, then the next request is sent at moment t\xe2\x80\x89+\xe2\x80\x89ai); the 1-st astronomer sends requests a1 seconds later than the n-th. The first astronomer sends his first request at moment 0.Mister B doesn\'t know the first moment the star is going to shine, but it\'s obvious that all moments at which the star will shine are determined by the time of its shine moment in the interval [0,\xe2\x80\x89T). Moreover, this interval can be split into T parts of 1 second length each of form [t,\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x891), where t\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89(T\xe2\x80\x89-\xe2\x80\x891).Mister B wants to know how lucky each astronomer can be in discovering the star first.For each astronomer compute how many segments of form [t,\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x891) (t\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89(T\xe2\x80\x89-\xe2\x80\x891)) there are in the interval [0,\xe2\x80\x89T) so that this astronomer is the first to discover the star if the first shine of the star happens in this time interval." 2900

819C "Mister B and Beacons on Field" "number theory" "Mister B has a house in the middle of a giant plain field, which attracted aliens life. For convenience, aliens specified the Cartesian coordinate system on the field in such a way that Mister B\'s house has coordinates (0,\xe2\x80\x890). After that they sent three beacons to the field, but something went wrong. One beacon was completely destroyed, while the other two landed in positions with coordinates (m,\xe2\x80\x890) and (0,\xe2\x80\x89n), respectively, but shut down.Mister B was interested in this devices, so he decided to take them home. He came to the first beacon, placed at (m,\xe2\x80\x890), lifted it up and carried the beacon home choosing the shortest path. After that he came to the other beacon, placed at (0,\xe2\x80\x89n), and also carried it home choosing the shortest path. When first beacon was lifted up, the navigation system of the beacons was activated.Partially destroyed navigation system started to work in following way.At time moments when both survived beacons are at points with integer coordinates the system tries to find a location for the third beacon. It succeeds if and only if there is a point with integer coordinates such that the area of the triangle formed by the two survived beacons and this point is equal to s. In this case the system sends a packet of information with beacon positions to aliens, otherwise it doesn\'t.Compute how many packets of information system sent while Mister B was moving the beacons." 2900

819B "Mister B and PR Shifts" "data structures,implementation,math" "Some time ago Mister B detected a strange signal from the space, which he started to study.After some transformation the signal turned out to be a permutation p of length n or its cyclic shift. For the further investigation Mister B need some basis, that\'s why he decided to choose cyclic shift of this permutation which has the minimum possible deviation.Let\'s define the deviation of a permutation p as .Find a cyclic shift of permutation p with minimum possible deviation. If there are multiple solutions, print any of them.Let\'s denote id k (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n) of a cyclic shift of permutation p as the number of right shifts needed to reach this shift, for example:  k\xe2\x80\x89=\xe2\x80\x890: shift p1,\xe2\x80\x89p2,\xe2\x80\x89... pn,  k\xe2\x80\x89=\xe2\x80\x891: shift pn,\xe2\x80\x89p1,\xe2\x80\x89... pn\xe2\x80\x89-\xe2\x80\x891,  ...,  k\xe2\x80\x89=\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891: shift p2,\xe2\x80\x89p3,\xe2\x80\x89... pn,\xe2\x80\x89p1." 1900

819A "Mister B and Boring Game" games,greedy "Sometimes Mister B has free evenings when he doesn\'t know what to do. Fortunately, Mister B found a new game, where the player can play against aliens.All characters in this game are lowercase English letters. There are two players: Mister B and his competitor.Initially the players have a string s consisting of the first a English letters in alphabetical order (for example, if a\xe2\x80\x89=\xe2\x80\x895, then s equals to ""abcde"").The players take turns appending letters to string s. Mister B moves first.Mister B must append exactly b letters on each his move. He can arbitrary choose these letters. His opponent adds exactly a letters on each move.Mister B quickly understood that his opponent was just a computer that used a simple algorithm. The computer on each turn considers the suffix of string s of length a and generates a string t of length a such that all letters in the string t are distinct and don\'t appear in the considered suffix. From multiple variants of t lexicographically minimal is chosen (if a\xe2\x80\x89=\xe2\x80\x894 and the suffix is ""bfdd"", the computer chooses string t equal to ""aceg""). After that the chosen string t is appended to the end of s.Mister B soon found the game boring and came up with the following question: what can be the minimum possible number of different letters in string s on the segment between positions l and r, inclusive. Letters of string s are numerated starting from 1." 2200

818G "Four Melodies" flows,graphs "Author note: I think some of you might remember the problem ""Two Melodies"" from Eductational Codeforces Round 22. Now it\'s time to make it a bit more difficult!Alice is a composer, and recently she had recorded two tracks that became very popular. Now she has got a lot of fans who are waiting for new tracks. This time Alice wants to form four melodies for her tracks.Alice has a sheet with n notes written on it. She wants to take four such non-empty non-intersecting subsequences that all of them form a melody and sum of their lengths is maximal.Subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements.Subsequence forms a melody when each two adjacent notes either differ by 1 or are congruent modulo 7.You should write a program which will calculate maximum sum of lengths of such four non-empty non-intersecting subsequences that all of them form a melody." 2600

818F "Level Generation" "binary search,math,ternary search" "Ivan is developing his own computer game. Now he tries to create some levels for his game. But firstly for each level he needs to draw a graph representing the structure of the level.Ivan decided that there should be exactly ni vertices in the graph representing level i, and the edges have to be bidirectional. When constructing the graph, Ivan is interested in special edges called bridges. An edge between two vertices u and v is called a bridge if this edge belongs to every path between u and v (and these vertices will belong to different connected components if we delete this edge). For each level Ivan wants to construct a graph where at least half of the edges are bridges. He also wants to maximize the number of edges in each constructed graph.So the task Ivan gave you is: given q numbers n1,\xe2\x80\x89n2,\xe2\x80\x89...,\xe2\x80\x89nq, for each i tell the maximum number of edges in a graph with ni vertices, if at least half of the edges are bridges. Note that the graphs cannot contain multiple edges or self-loops." 2100

818E "Card Game Again" "binary search,data structures,number theory,two pointers" "Vova again tries to play some computer card game.The rules of deck creation in this game are simple. Vova is given an existing deck of n cards and a magic number k. The order of the cards in the deck is fixed. Each card has a number written on it; number ai is written on the i-th card in the deck.After receiving the deck and the magic number, Vova removes x (possibly x\xe2\x80\x89=\xe2\x80\x890) cards from the top of the deck, y (possibly y\xe2\x80\x89=\xe2\x80\x890) cards from the bottom of the deck, and the rest of the deck is his new deck (Vova has to leave at least one card in the deck after removing cards). So Vova\'s new deck actually contains cards x\xe2\x80\x89+\xe2\x80\x891, x\xe2\x80\x89+\xe2\x80\x892, ... n\xe2\x80\x89-\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891, n\xe2\x80\x89-\xe2\x80\x89y from the original deck.Vova\'s new deck is considered valid iff the product of all numbers written on the cards in his new deck is divisible by k. So Vova received a deck (possibly not a valid one) and a number k, and now he wonders, how many ways are there to choose x and y so the deck he will get after removing x cards from the top and y cards from the bottom is valid?" 1900

818D "Multicolored Cars" "data structures,implementation" "Alice and Bob got very bored during a long car trip so they decided to play a game. From the window they can see cars of different colors running past them. Cars are going one after another.The game rules are like this. Firstly Alice chooses some color A, then Bob chooses some color B (A\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89B). After each car they update the number of cars of their chosen color that have run past them. Let\'s define this numbers after i-th car cntA(i) and cntB(i).  If cntA(i)\xe2\x80\x89>\xe2\x80\x89cntB(i) for every i then the winner is Alice.  If cntB(i)\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89cntA(i) for every i then the winner is Bob.  Otherwise it\'s a draw. Bob knows all the colors of cars that they will encounter and order of their appearance. Alice have already chosen her color A and Bob now wants to choose such color B that he will win the game (draw is not a win). Help him find this color.If there are multiple solutions, print any of them. If there is no such color then print -1." 1700

818C "Sofa Thief" "brute force,implementation" "Yet another round on DecoForces is coming! Grandpa Maks wanted to participate in it but someone has stolen his precious sofa! And how can one perform well with such a major loss?Fortunately, the thief had left a note for Grandpa Maks. This note got Maks to the sofa storehouse. Still he had no idea which sofa belongs to him as they all looked the same!The storehouse is represented as matrix n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Every sofa takes two neighbouring by some side cells. No cell is covered by more than one sofa. There can be empty cells.Sofa A is standing to the left of sofa B if there exist two such cells a and b that xa\xe2\x80\x89<\xe2\x80\x89xb, a is covered by A and b is covered by B. Sofa A is standing to the top of sofa B if there exist two such cells a and b that ya\xe2\x80\x89<\xe2\x80\x89yb, a is covered by A and b is covered by B. Right and bottom conditions are declared the same way. Note that in all conditions A\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89B. Also some sofa A can be both to the top of another sofa B and to the bottom of it. The same is for left and right conditions.The note also stated that there are cntl sofas to the left of Grandpa Maks\'s sofa, cntr \xe2\x80\x94 to the right, cntt \xe2\x80\x94 to the top and cntb \xe2\x80\x94 to the bottom.Grandpa Maks asks you to help him to identify his sofa. It is guaranteed that there is no more than one sofa of given conditions.Output the number of Grandpa Maks\'s sofa. If there is no such sofa that all the conditions are met for it then output -1." 2000

818B "Permutation Game" implementation "n children are standing in a circle and playing a game. Children\'s numbers in clockwise order form a permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of length n. It is an integer sequence such that each integer from 1 to n appears exactly once in it.The game consists of m steps. On each step the current leader with index i counts out ai people in clockwise order, starting from the next person. The last one to be pointed at by the leader becomes the new leader.You are given numbers l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lm \xe2\x80\x94 indices of leaders in the beginning of each step. Child with number l1 is the first leader in the game. Write a program which will restore a possible permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. If there are multiple solutions then print any of them. If there is no solution then print -1." 1600

818A "Diplomas and Certificates" implementation,math "There are n students who have taken part in an olympiad. Now it\'s time to award the students.Some of them will receive diplomas, some wiil get certificates, and others won\'t receive anything. Students with diplomas and certificates are called winners. But there are some rules of counting the number of diplomas and certificates. The number of certificates must be exactly k times greater than the number of diplomas. The number of winners must not be greater than half of the number of all students (i.e. not be greater than half of n). It\'s possible that there are no winners.You have to identify the maximum possible number of winners, according to these rules. Also for this case you have to calculate the number of students with diplomas, the number of students with certificates and the number of students who are not winners." 800

817F "MEX Queries" "binary search,data structures,trees" "You are given a set of integer numbers, initially it is empty. You should perform n queries.There are three different types of queries:   1 l r \xe2\x80\x94 Add all missing numbers from the interval [l,\xe2\x80\x89r]  2 l r \xe2\x80\x94 Remove all present numbers from the interval [l,\xe2\x80\x89r]  3 l r \xe2\x80\x94 Invert the interval [l,\xe2\x80\x89r] \xe2\x80\x94 add all missing and remove all present numbers from the interval [l,\xe2\x80\x89r] After each query you should output MEX of the set \xe2\x80\x94 the smallest positive (MEX \xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) integer number which is not presented in the set." 2300

817E "Choosing The Commander" "bitmasks,data structures,trees" "As you might remember from the previous round, Vova is currently playing a strategic game known as Rage of Empires.Vova managed to build a large army, but forgot about the main person in the army - the commander. So he tries to hire a commander, and he wants to choose the person who will be respected by warriors.Each warrior is represented by his personality \xe2\x80\x94 an integer number pi. Each commander has two characteristics \xe2\x80\x94 his personality pj and leadership lj (both are integer numbers). Warrior i respects commander j only if  ( is the bitwise excluding OR of x and y).Initially Vova\'s army is empty. There are three different types of events that can happen with the army:  1�pi \xe2\x80\x94 one warrior with personality pi joins Vova\'s army;  2�pi \xe2\x80\x94 one warrior with personality pi leaves Vova\'s army;  3�pi�li \xe2\x80\x94 Vova tries to hire a commander with personality pi and leadership li. For each event of the third type Vova wants to know how many warriors (counting only those who joined the army and haven\'t left yet) respect the commander he tries to hire." 2000

817D "Imbalanced Array" "data structures,divide and conquer,dsu,sortings" "You are given an array a consisting of n elements. The imbalance value of some subsegment of this array is the difference between the maximum and minimum element from this segment. The imbalance value of the array is the sum of imbalance values of all subsegments of this array.For example, the imbalance value of array [1,\xe2\x80\x894,\xe2\x80\x891] is 9, because there are 6 different subsegments of this array:   [1] (from index 1 to index 1), imbalance value is 0;  [1,\xe2\x80\x894] (from index 1 to index 2), imbalance value is 3;  [1,\xe2\x80\x894,\xe2\x80\x891] (from index 1 to index 3), imbalance value is 3;  [4] (from index 2 to index 2), imbalance value is 0;  [4,\xe2\x80\x891] (from index 2 to index 3), imbalance value is 3;  [1] (from index 3 to index 3), imbalance value is 0; You have to determine the imbalance value of the array a." 1900

817C "Really Big Numbers" "binary search,brute force,dp,math" "Ivan likes to learn different things about numbers, but he is especially interested in really big numbers. Ivan thinks that a positive integer number x is really big if the difference between x and the sum of its digits (in decimal representation) is not less than s. To prove that these numbers may have different special properties, he wants to know how rare (or not rare) they are \xe2\x80\x94 in fact, he needs to calculate the quantity of really big numbers that are not greater than n.Ivan tried to do the calculations himself, but soon realized that it\'s too difficult for him. So he asked you to help him in calculations." 1600

817B "Makes And The Product" combinatorics,implementation,math,sortings "After returning from the army Makes received a gift \xe2\x80\x94 an array a consisting of n positive integer numbers. He hadn\'t been solving problems for a long time, so he became interested to answer a particular question: how many triples of indices (i,\xe2\x80\x89�j,\xe2\x80\x89�k) (i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89k), such that ai\xc2\xb7aj\xc2\xb7ak is minimum possible, are there in the array? Help him with it!" 1500

817A "Treasure Hunt" "implementation,math,number theory" "Captain Bill the Hummingbird and his crew recieved an interesting challenge offer. Some stranger gave them a map, potion of teleportation and said that only this potion might help them to reach the treasure. Bottle with potion has two values x and y written on it. These values define four moves which can be performed using the potion:         Map shows that the position of Captain Bill the Hummingbird is (x1,\xe2\x80\x89y1) and the position of the treasure is (x2,\xe2\x80\x89y2).You task is to tell Captain Bill the Hummingbird whether he should accept this challenge or decline. If it is possible for Captain to reach the treasure using the potion then output ""YES"", otherwise ""NO"" (without quotes).The potion can be used infinite amount of times." 1200

816B "Karen and Coffee" "binary search,data structures,implementation" "To stay woke and attentive during classes, Karen needs some coffee!  Karen, a coffee aficionado, wants to know the optimal temperature for brewing the perfect cup of coffee. Indeed, she has spent some time reading several recipe books, including the universally acclaimed ""The Art of the Covfefe"".She knows n coffee recipes. The i-th recipe suggests that coffee should be brewed between li and ri degrees, inclusive, to achieve the optimal taste.Karen thinks that a temperature is admissible if at least k recipes recommend it.Karen has a rather fickle mind, and so she asks q questions. In each question, given that she only wants to prepare coffee with a temperature between a and b, inclusive, can you tell her how many admissible integer temperatures fall within the range?" 1400

816A "Karen and Morning" "brute force,implementation" "Karen is getting ready for a new school day!  It is currently hh:mm, given in a 24-hour format. As you know, Karen loves palindromes, and she believes that it is good luck to wake up when the time is a palindrome.What is the minimum number of minutes she should sleep, such that, when she wakes up, the time is a palindrome?Remember that a palindrome is a string that reads the same forwards and backwards. For instance, 05:39 is not a palindrome, because 05:39 backwards is 93:50. On the other hand, 05:50 is a palindrome, because 05:50 backwards is 05:50." 1000

815E "Karen and Neighborhood" "binary search,constructive algorithms,implementation" "It\'s been long after the events of the previous problems, and Karen has now moved on from student life and is looking to relocate to a new neighborhood.  The neighborhood consists of n houses in a straight line, labelled 1 to n from left to right, all an equal distance apart.Everyone in this neighborhood loves peace and quiet. Because of this, whenever a new person moves into the neighborhood, he or she always chooses the house whose minimum distance to any occupied house is maximized. If there are multiple houses with the maximum possible minimum distance, he or she chooses the leftmost one.Note that the first person to arrive always moves into house 1.Karen is the k-th person to enter this neighborhood. If everyone, including herself, follows this rule, which house will she move into?" 2900

815D "Karen and Cards" "binary search,combinatorics,data structures,geometry" "Karen just got home from the supermarket, and is getting ready to go to sleep.  After taking a shower and changing into her pajamas, she looked at her shelf and saw an album. Curious, she opened it and saw a trading card collection.She recalled that she used to play with those cards as a child, and, although she is now grown-up, she still wonders a few things about it.Each card has three characteristics: strength, defense and speed. The values of all characteristics of all cards are positive integers. The maximum possible strength any card can have is p, the maximum possible defense is q and the maximum possible speed is r.There are n cards in her collection. The i-th card has a strength ai, defense bi and speed ci, respectively.A card beats another card if at least two of its characteristics are strictly greater than the corresponding characteristics of the other card.She now wonders how many different cards can beat all the cards in her collection. Two cards are considered different if at least one of their characteristics have different values." 2800

815C "Karen and Supermarket" "brute force,dp,trees" "On the way home, Karen decided to stop by the supermarket to buy some groceries.  She needs to buy a lot of goods, but since she is a student her budget is still quite limited. In fact, she can only spend up to b dollars.The supermarket sells n goods. The i-th good can be bought for ci dollars. Of course, each good can only be bought once.Lately, the supermarket has been trying to increase its business. Karen, being a loyal customer, was given n coupons. If Karen purchases the i-th good, she can use the i-th coupon to decrease its price by di. Of course, a coupon cannot be used without buying the corresponding good.There is, however, a constraint with the coupons. For all i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892, in order to use the i-th coupon, Karen must also use the xi-th coupon (which may mean using even more coupons to satisfy the requirement for that coupon).Karen wants to know the following. What is the maximum number of goods she can buy, without exceeding her budget b?" 2400

815B "Karen and Test" "brute force,combinatorics,constructive algorithms,math" "Karen has just arrived at school, and she has a math test today!  The test is about basic addition and subtraction. Unfortunately, the teachers were too busy writing tasks for Codeforces rounds, and had no time to make an actual test. So, they just put one question in the test that is worth all the points.There are n integers written on a row. Karen must alternately add and subtract each pair of adjacent integers, and write down the sums or differences on the next row. She must repeat this process on the values on the next row, and so on, until only one integer remains. The first operation should be addition.Note that, if she ended the previous row by adding the integers, she should start the next row by subtracting, and vice versa.The teachers will simply look at the last integer, and then if it is correct, Karen gets a perfect score, otherwise, she gets a zero for the test.Karen has studied well for this test, but she is scared that she might make a mistake somewhere and it will cause her final answer to be wrong. If the process is followed, what number can she expect to be written on the last row?Since this number can be quite large, output only the non-negative remainder after dividing it by 109\xe2\x80\x89+\xe2\x80\x897." 2200

815A "Karen and Game" "brute force,greedy,implementation" "On the way to school, Karen became fixated on the puzzle game on her phone!  The game is played as follows. In each level, you have a grid with n rows and m columns. Each cell originally contains the number 0.One move consists of choosing one row or column, and adding 1 to all of the cells in that row or column.To win the level, after all the moves, the number in the cell at the i-th row and j-th column should be equal to gi,\xe2\x80\x89j.Karen is stuck on one level, and wants to know a way to beat this level using the minimum number of moves. Please, help her with this task!" 1700

814E "An unavoidable detour for home" "combinatorics,dp,graphs,shortest paths" "Those unwilling to return home from a long journey, will be affected by the oddity of the snail and lose their way. Mayoi, the oddity\'s carrier, wouldn\'t like this to happen, but there\'s nothing to do with this before a cure is figured out. For now, she would only like to know the enormous number of possibilities to be faced with if someone gets lost.There are n towns in the region, numbered from 1 to n. The town numbered 1 is called the capital. The traffic network is formed by bidirectional roads connecting pairs of towns. No two roads connect the same pair of towns, and no road connects a town with itself. The time needed to travel through each of the roads is the same. Lost travelers will not be able to find out how the towns are connected, but the residents can help them by providing the following facts:   Starting from each town other than the capital, the shortest path (i.e. the path passing through the minimum number of roads) to the capital exists, and is unique;  Let li be the number of roads on the shortest path from town i to the capital, then li\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89li\xe2\x80\x89-\xe2\x80\x891 holds for all 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;  For town i, the number of roads connected to it is denoted by di, which equals either 2 or 3. You are to count the number of different ways in which the towns are connected, and give the answer modulo 109\xe2\x80\x89+\xe2\x80\x897. Two ways of connecting towns are considered different if a pair (u,\xe2\x80\x89v) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) exists such there is a road between towns u and v in one of them but not in the other." 2600

814D "An overnight dance in discotheque" "dfs and similar,dp,geometry,greedy,trees" "The crowdedness of the discotheque would never stop our friends from having fun, but a bit more spaciousness won\'t hurt, will it?The discotheque can be seen as an infinite xy-plane, in which there are a total of n dancers. Once someone starts moving around, they will move only inside their own movement range, which is a circular area Ci described by a center (xi,\xe2\x80\x89yi) and a radius ri. No two ranges\' borders have more than one common point, that is for every pair (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) either ranges Ci and Cj are disjoint, or one of them is a subset of the other. Note that it\'s possible that two ranges\' borders share a single common point, but no two dancers have exactly the same ranges.Tsukihi, being one of them, defines the spaciousness to be the area covered by an odd number of movement ranges of dancers who are moving. An example is shown below, with shaded regions representing the spaciousness if everyone moves at the same time.  But no one keeps moving for the whole night after all, so the whole night\'s time is divided into two halves \xe2\x80\x94 before midnight and after midnight. Every dancer moves around in one half, while sitting down with friends in the other. The spaciousness of two halves are calculated separately and their sum should, of course, be as large as possible. The following figure shows an optimal solution to the example above.  By different plans of who dances in the first half and who does in the other, different sums of spaciousness over two halves are achieved. You are to find the largest achievable value of this sum." 2000

814C "An impassioned circulation of affection" "brute force,dp,strings,two pointers" "Nadeko\'s birthday is approaching! As she decorated the room for the party, a long garland of Dianthus-shaped paper pieces was placed on a prominent part of the wall. Brother Koyomi will like it!Still unsatisfied with the garland, Nadeko decided to polish it again. The garland has n pieces numbered from 1 to n from left to right, and the i-th piece has a colour si, denoted by a lowercase English letter. Nadeko will repaint at most m of the pieces to give each of them an arbitrary new colour (still denoted by a lowercase English letter). After this work, she finds out all subsegments of the garland containing pieces of only colour c \xe2\x80\x94 Brother Koyomi\'s favourite one, and takes the length of the longest among them to be the Koyomity of the garland.For instance, let\'s say the garland is represented by ""kooomo"", and Brother Koyomi\'s favourite colour is ""o"". Among all subsegments containing pieces of ""o"" only, ""ooo"" is the longest, with a length of 3. Thus the Koyomity of this garland equals 3.But problem arises as Nadeko is unsure about Brother Koyomi\'s favourite colour, and has swaying ideas on the amount of work to do. She has q plans on this, each of which can be expressed as a pair of an integer mi and a lowercase letter ci, meanings of which are explained above. You are to find out the maximum Koyomity achievable after repainting the garland according to each plan." 1600

814B "An express train to reveries" "constructive algorithms" "Sengoku still remembers the mysterious ""colourful meteoroids"" she discovered with Lala-chan when they were little. In particular, one of the nights impressed her deeply, giving her the illusion that all her fancies would be realized.On that night, Sengoku constructed a permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn of integers from 1 to n inclusive, with each integer representing a colour, wishing for the colours to see in the coming meteor outburst. Two incredible outbursts then arrived, each with n meteorids, colours of which being integer sequences a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn respectively. Meteoroids\' colours were also between 1 and n inclusive, and the two sequences were not identical, that is, at least one i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) exists, such that ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi holds.Well, she almost had it all \xe2\x80\x94 each of the sequences a and b matched exactly n\xe2\x80\x89-\xe2\x80\x891 elements in Sengoku\'s permutation. In other words, there is exactly one i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89pi, and exactly one j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that bj\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89pj.For now, Sengoku is able to recover the actual colour sequences a and b through astronomical records, but her wishes have been long forgotten. You are to reconstruct any possible permutation Sengoku could have had on that night." 1300

814A "An abandoned sentiment from past" "constructive algorithms,greedy,implementation,sortings" "A few years ago, Hitagi encountered a giant crab, who stole the whole of her body weight. Ever since, she tried to avoid contact with others, for fear that this secret might be noticed.To get rid of the oddity and recover her weight, a special integer sequence is needed. Hitagi\'s sequence has been broken for a long time, but now Kaiki provides an opportunity.Hitagi\'s sequence a has a length of n. Lost elements in it are denoted by zeros. Kaiki provides another sequence b, whose length k equals the number of lost elements in a (i.e. the number of zeros). Hitagi is to replace each zero in a with an element from b so that each element in b should be used exactly once. Hitagi knows, however, that, apart from 0, no integer occurs in a and b more than once in total.If the resulting sequence is not an increasing sequence, then it has the power to recover Hitagi from the oddity. You are to determine whether this is possible, or Kaiki\'s sequence is just another fake. In other words, you should detect whether it is possible to replace each zero in a with an integer from b so that each integer from b is used exactly once, and the resulting sequence is not increasing." 900

813F "Bipartite Checking" "data structures,dsu,graphs" "You are given an undirected graph consisting of n vertices. Initially there are no edges in the graph. Also you are given q queries, each query either adds one undirected edge to the graph or removes it. After each query you have to check if the resulting graph is bipartite (that is, you can paint all vertices of the graph into two colors so that there is no edge connecting two vertices of the same color)." 2500

813E "Army Creation" "binary search,data structures" "As you might remember from our previous rounds, Vova really likes computer games. Now he is playing a strategy game known as Rage of Empires.In the game Vova can hire n different warriors; ith warrior has the type ai. Vova wants to create a balanced army hiring some subset of warriors. An army is called balanced if for each type of warrior present in the game there are not more than k warriors of this type in the army. Of course, Vova wants his army to be as large as possible.To make things more complicated, Vova has to consider q different plans of creating his army. ith plan allows him to hire only warriors whose numbers are not less than li and not greater than ri.Help Vova to determine the largest size of a balanced army for each plan.Be aware that the plans are given in a modified way. See input section for details." 2200

813D "Two Melodies" dp,flows "Alice is a beginner composer and now she is ready to create another masterpiece. And not even the single one but two at the same time! Alice has a sheet with n notes written on it. She wants to take two such non-empty non-intersecting subsequences that both of them form a melody and sum of their lengths is maximal.Subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements.Subsequence forms a melody when each two adjacent notes either differs by 1 or are congruent modulo 7.You should write a program which will calculate maximum sum of lengths of such two non-empty non-intersecting subsequences that both of them form a melody." 2600

813C "The Tag Game" "dfs and similar,graphs" "Alice got tired of playing the tag game by the usual rules so she offered Bob a little modification to it. Now the game should be played on an undirected rooted tree of n vertices. Vertex 1 is the root of the tree.Alice starts at vertex 1 and Bob starts at vertex x (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x891). The moves are made in turns, Bob goes first. In one move one can either stay at the current vertex or travel to the neighbouring one.The game ends when Alice goes to the same vertex where Bob is standing. Alice wants to minimize the total number of moves and Bob wants to maximize it.You should write a program which will determine how many moves will the game last." 1700

813B "The Golden Age" "brute force,math" "Unlucky year in Berland is such a year that its number n can be represented as n\xe2\x80\x89=\xe2\x80\x89xa\xe2\x80\x89+\xe2\x80\x89yb, where a and b are non-negative integer numbers. For example, if x\xe2\x80\x89=\xe2\x80\x892 and y\xe2\x80\x89=\xe2\x80\x893 then the years 4 and 17 are unlucky (4\xe2\x80\x89=\xe2\x80\x8920\xe2\x80\x89+\xe2\x80\x8931, 17\xe2\x80\x89=\xe2\x80\x8923\xe2\x80\x89+\xe2\x80\x8932\xe2\x80\x89=\xe2\x80\x8924\xe2\x80\x89+\xe2\x80\x8930) and year 18 isn\'t unlucky as there is no such representation for it.Such interval of years that there are no unlucky years in it is called The Golden Age.You should write a program which will find maximum length of The Golden Age which starts no earlier than the year l and ends no later than the year r. If all years in the interval [l,\xe2\x80\x89r] are unlucky then the answer is 0." 1800

813A "The Contest" implementation "Pasha is participating in a contest on one well-known website. This time he wants to win the contest and will do anything to get to the first place!This contest consists of n problems, and Pasha solves ith problem in ai time units (his solutions are always correct). At any moment of time he can be thinking about a solution to only one of the problems (that is, he cannot be solving two problems at the same time). The time Pasha spends to send his solutions is negligible. Pasha can send any number of solutions at the same moment.Unfortunately, there are too many participants, and the website is not always working. Pasha received the information that the website will be working only during m time periods, jth period is represented by its starting moment lj and ending moment rj. Of course, Pasha can send his solution only when the website is working. In other words, Pasha can send his solution at some moment T iff there exists a period x such that lx\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89T\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rx.Pasha wants to know his best possible result. We need to tell him the minimal moment of time by which he is able to have solutions to all problems submitted, if he acts optimally, or say that it\'s impossible no matter how Pasha solves the problems." 1100

812E "Sagheer and Apple Tree" games,trees "Sagheer is playing a game with his best friend Soliman. He brought a tree with n nodes numbered from 1 to n and rooted at node 1. The i-th node has ai apples. This tree has a special property: the lengths of all paths from the root to any leaf have the same parity (i.e. all paths have even length or all paths have odd length).Sagheer and Soliman will take turns to play. Soliman will make the first move. The player who can\'t make a move loses.In each move, the current player will pick a single node, take a non-empty subset of apples from it and do one of the following two things:  eat the apples, if the node is a leaf.  move the apples to one of the children, if the node is non-leaf. Before Soliman comes to start playing, Sagheer will make exactly one change to the tree. He will pick two different nodes u and v and swap the apples of u with the apples of v.Can you help Sagheer count the number of ways to make the swap (i.e. to choose u and v) after which he will win the game if both players play optimally? (u,\xe2\x80\x89v) and (v,\xe2\x80\x89u) are considered to be the same pair." 2300

812D "Sagheer and Kindergarten" "dfs and similar,graphs,implementation,trees" "Sagheer is working at a kindergarten. There are n children and m different toys. These children use well-defined protocols for playing with the toys:  Each child has a lovely set of toys that he loves to play with. He requests the toys one after another at distinct moments of time. A child starts playing if and only if he is granted all the toys in his lovely set. If a child starts playing, then sooner or later he gives the toys back. No child keeps the toys forever. Children request toys at distinct moments of time. No two children request a toy at the same time. If a child is granted a toy, he never gives it back until he finishes playing with his lovely set. If a child is not granted a toy, he waits until he is granted this toy. He can\'t request another toy while waiting. If two children are waiting for the same toy, then the child who requested it first will take the toy first.Children don\'t like to play with each other. That\'s why they never share toys. When a child requests a toy, then granting the toy to this child depends on whether the toy is free or not. If the toy is free, Sagheer will give it to the child. Otherwise, the child has to wait for it and can\'t request another toy.Children are smart and can detect if they have to wait forever before they get the toys they want. In such case they start crying. In other words, a crying set is a set of children in which each child is waiting for a toy that is kept by another child in the set.Now, we have reached a scenario where all the children made all the requests for their lovely sets, except for one child x that still has one last request for his lovely set. Some children are playing while others are waiting for a toy, but no child is crying, and no one has yet finished playing. If the child x is currently waiting for some toy, he makes his last request just after getting that toy. Otherwise, he makes the request right away. When child x will make his last request, how many children will start crying?You will be given the scenario and q independent queries. Each query will be of the form x y meaning that the last request of the child x is for the toy y. Your task is to help Sagheer find the size of the maximal crying set when child x makes his last request." 2700

812C "Sagheer and Nubian Market" "binary search,sortings" "On his trip to Luxor and Aswan, Sagheer went to a Nubian market to buy some souvenirs for his friends and relatives. The market has some strange rules. It contains n different items numbered from 1 to n. The i-th item has base cost ai Egyptian pounds. If Sagheer buys k items with indices x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk, then the cost of item xj is axj\xe2\x80\x89+\xe2\x80\x89xj\xc2\xb7k for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k. In other words, the cost of an item is equal to its base cost in addition to its index multiplied by the factor k.Sagheer wants to buy as many souvenirs as possible without paying more than S Egyptian pounds. Note that he cannot buy a souvenir more than once. If there are many ways to maximize the number of souvenirs, he will choose the way that will minimize the total cost. Can you help him with this task?" 1500

812B "Sagheer, the Hausmeister" "bitmasks,brute force,dp" "Some people leave the lights at their workplaces on when they leave that is a waste of resources. As a hausmeister of DHBW, Sagheer waits till all students and professors leave the university building, then goes and turns all the lights off.The building consists of n floors with stairs at the left and the right sides. Each floor has m rooms on the same line with a corridor that connects the left and right stairs passing by all the rooms. In other words, the building can be represented as a rectangle with n rows and m\xe2\x80\x89+\xe2\x80\x892 columns, where the first and the last columns represent the stairs, and the m columns in the middle represent rooms.Sagheer is standing at the ground floor at the left stairs. He wants to turn all the lights off in such a way that he will not go upstairs until all lights in the floor he is standing at are off. Of course, Sagheer must visit a room to turn the light there off. It takes one minute for Sagheer to go to the next floor using stairs or to move from the current room/stairs to a neighboring room/stairs on the same floor. It takes no time for him to switch the light off in the room he is currently standing in. Help Sagheer find the minimum total time to turn off all the lights.Note that Sagheer does not have to go back to his starting position, and he does not have to visit rooms where the light is already switched off." 1600

812A "Sagheer and Crossroads" implementation "Sagheer is walking in the street when he comes to an intersection of two roads. Each road can be represented as two parts where each part has 3 lanes getting into the intersection (one for each direction) and 3 lanes getting out of the intersection, so we have 4 parts in total. Each part has 4 lights, one for each lane getting into the intersection (l \xe2\x80\x94 left, s \xe2\x80\x94 straight, r \xe2\x80\x94 right) and a light p for a pedestrian crossing.   An accident is possible if a car can hit a pedestrian. This can happen if the light of a pedestrian crossing of some part and the light of a lane that can get to or from that same part are green at the same time.Now, Sagheer is monitoring the configuration of the traffic lights. Your task is to help him detect whether an accident is possible." 1200

811E "Vladik and Entertaining Flags" "data structures,dsu,graphs" "In his spare time Vladik estimates beauty of the flags.Every flag could be represented as the matrix n\xe2\x80\x89\xc3\x97\xe2\x80\x89m which consists of positive integers.Let\'s define the beauty of the flag as number of components in its matrix. We call component a set of cells with same numbers and between any pair of cells from that set there exists a path through adjacent cells from same component. Here is the example of the partitioning some flag matrix into components:  But this time he decided to change something in the process. Now he wants to estimate not the entire flag, but some segment. Segment of flag can be described as a submatrix of the flag matrix with opposite corners at (1,\xe2\x80\x89l) and (n,\xe2\x80\x89r), where conditions 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m are satisfied.Help Vladik to calculate the beauty for some segments of the given flag." 2600

811D "Vladik and Favorite Game" "constructive algorithms,dfs and similar,graphs,interactive" "This is an interactive problem.Vladik has favorite game, in which he plays all his free time.Game field could be represented as n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix which consists of cells of three types:   \xc2\xab.\xc2\xbb \xe2\x80\x94 normal cell, player can visit it.  \xc2\xabF\xc2\xbb \xe2\x80\x94 finish cell, player has to finish his way there to win. There is exactly one cell of this type.  \xc2\xab*\xc2\xbb \xe2\x80\x94 dangerous cell, if player comes to this cell, he loses. Initially player is located in the left top cell with coordinates (1,\xe2\x80\x891). Player has access to 4 buttons ""U"", ""D"", ""L"", ""R"", each of them move player up, down, left and right directions respectively.But it\xe2\x80\x99s not that easy! Sometimes friends play game and change functions of buttons. Function of buttons ""L"" and ""R"" could have been swapped, also functions of buttons ""U"" and ""D"" could have been swapped. Note that functions of buttons can be changed only at the beginning of the game.Help Vladik win the game!" 2100

811C "Vladik and Memorable Trip" dp,implementation "Vladik often travels by trains. He remembered some of his trips especially well and I would like to tell you about one of these trips:Vladik is at initial train station, and now n people (including Vladik) want to get on the train. They are already lined up in some order, and for each of them the city code ai is known (the code of the city in which they are going to).Train chief selects some number of disjoint segments of the original sequence of people (covering entire sequence by segments is not necessary). People who are in the same segment will be in the same train carriage. The segments are selected in such way that if at least one person travels to the city x, then all people who are going to city x should be in the same railway carriage. This means that they can\xe2\x80\x99t belong to different segments. Note, that all people who travel to the city x, either go to it and in the same railway carriage, or do not go anywhere at all.Comfort of a train trip with people on segment from position l to position r is equal to XOR of all distinct codes of cities for people on the segment from position l to position r. XOR operation also known as exclusive OR.Total comfort of a train trip is equal to sum of comfort for each segment.Help Vladik to know maximal possible total comfort." 1900

811B "Vladik and Complicated Book" implementation,sortings "Vladik had started reading a complicated book about algorithms containing n pages. To improve understanding of what is written, his friends advised him to read pages in some order given by permutation P\xe2\x80\x89=\xe2\x80\x89[p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn], where pi denotes the number of page that should be read i-th in turn.Sometimes Vladik\xe2\x80\x99s mom sorted some subsegment of permutation P from position l to position r inclusive, because she loves the order. For every of such sorting Vladik knows number x�\xe2\x80\x94 what index of page in permutation he should read. He is wondered if the page, which he will read after sorting, has changed. In other words, has px changed? After every sorting Vladik return permutation to initial state, so you can assume that each sorting is independent from each other." 1200

811A "Vladik and Courtesy" "brute force,implementation" "At regular competition Vladik and Valera won a and b candies respectively. Vladik offered 1 his candy to Valera. After that Valera gave Vladik 2 his candies, so that no one thought that he was less generous. Vladik for same reason gave 3 candies to Valera in next turn.More formally, the guys take turns giving each other one candy more than they received in the previous turn.This continued until the moment when one of them couldn\xe2\x80\x99t give the right amount of candy. Candies, which guys got from each other, they don\xe2\x80\x99t consider as their own. You need to know, who is the first who can\xe2\x80\x99t give the right amount of candy." 800

810B "Summer sell-off" greedy,sortings "Summer holidays! Someone is going on trips, someone is visiting grandparents, but someone is trying to get a part-time job. This summer Noora decided that she wants to earn some money, and took a job in a shop as an assistant.Shop, where Noora is working, has a plan on the following n days. For each day sales manager knows exactly, that in i-th day ki products will be put up for sale and exactly li clients will come to the shop that day. Also, the manager is sure, that everyone, who comes to the shop, buys exactly one product or, if there aren\'t any left, leaves the shop without buying anything. Moreover, due to the short shelf-life of the products, manager established the following rule: if some part of the products left on the shelves at the end of the day, that products aren\'t kept on the next day and are sent to the dump.For advertising purposes manager offered to start a sell-out in the shop. He asked Noora to choose any f days from n next for sell-outs. On each of f chosen days the number of products were put up for sale would be doubled. Thus, if on i-th day shop planned to put up for sale ki products and Noora has chosen this day for sell-out, shelves of the shop would keep 2\xc2\xb7ki products. Consequently, there is an opportunity to sell two times more products on days of sell-out.Noora\'s task is to choose f days to maximize total number of sold products. She asks you to help her with such a difficult problem." 1300

810A "Straight <<A>>" implementation,math "Noora is a student of one famous high school. It\'s her final year in school�\xe2\x80\x94 she is going to study in university next year. However, she has to get an \xc2\xabA\xc2\xbb graduation certificate in order to apply to a prestigious one.In school, where Noora is studying, teachers are putting down marks to the online class register, which are integers from 1 to k. The worst mark is 1, the best is k. Mark that is going to the certificate, is calculated as an average of all the marks, rounded to the closest integer. If several answers are possible, rounding up is produced. For example, 7.3 is rounded to 7, but 7.5 and 7.8784�\xe2\x80\x94 to 8. For instance, if Noora has marks [8,\xe2\x80\x899], then the mark to the certificate is 9, because the average is equal to 8.5 and rounded to 9, but if the marks are [8,\xe2\x80\x898,\xe2\x80\x899], Noora will have graduation certificate with 8.To graduate with \xc2\xabA\xc2\xbb certificate, Noora has to have mark k.Noora got n marks in register this year. However, she is afraid that her marks are not enough to get final mark k. Noora decided to ask for help in the internet, where hacker Leha immediately responded to her request. He is ready to hack class register for Noora and to add Noora any number of additional marks from 1 to k. At the same time, Leha want his hack be unseen to everyone, so he decided to add as less as possible additional marks. Please help Leha to calculate the minimal number of marks he has to add, so that final Noora\'s mark will become equal to k." 900

809E "Surprise me!" "divide and conquer,math,number theory,trees" "Tired of boring dates, Leha and Noora decided to play a game.Leha found a tree with n vertices numbered from 1 to n. We remind you that tree is an undirected graph without cycles. Each vertex v of a tree has a number av written on it. Quite by accident it turned out that all values written on vertices are distinct and are natural numbers between 1 and n.The game goes in the following way. Noora chooses some vertex u of a tree uniformly at random and passes a move to Leha. Leha, in his turn, chooses (also uniformly at random) some vertex v from remaining vertices of a tree (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89u). As you could guess there are n(n\xe2\x80\x89-\xe2\x80\x891) variants of choosing vertices by players. After that players calculate the value of a function f(u,\xe2\x80\x89v)\xe2\x80\x89=\xe2\x80\x89\xcf\x86(au\xc2\xb7av) \xc2\xb7 d(u,\xe2\x80\x89v) of the chosen vertices where \xcf\x86(x) is Euler\'s totient function and d(x,\xe2\x80\x89y) is the shortest distance between vertices x and y in a tree.Soon the game became boring for Noora, so Leha decided to defuse the situation and calculate expected value of function f over all variants of choosing vertices u and v, hoping of at least somehow surprise the girl.Leha asks for your help in calculating this expected value. Let this value be representable in the form of an irreducible fraction . To further surprise Noora, he wants to name her the value . Help Leha!" 3100

809D "Hitchhiking in the Baltic States" "data structures,dp" "Leha and Noora decided to go on a trip in the Baltic States. As you know from the previous problem, Leha has lost his car on the parking of the restaurant. Unfortunately, requests to the watchman didn\'t helped hacker find the car, so friends decided to go hitchhiking.In total, they intended to visit n towns. However it turned out that sights in i-th town are open for visitors only on days from li to ri.What to do? Leha proposed to choose for each town i a day, when they will visit this town, i.e any integer xi in interval [li,\xe2\x80\x89ri]. After that Noora choses some subsequence of towns id1,\xe2\x80\x89id2,\xe2\x80\x89...,\xe2\x80\x89idk, which friends are going to visit, that at first they are strictly increasing, i.e idi\xe2\x80\x89<\xe2\x80\x89idi\xe2\x80\x89+\xe2\x80\x891 is for all integers i from 1 to k\xe2\x80\x89-\xe2\x80\x891, but also the dates of the friends visits are strictly increasing, i.e xidi\xe2\x80\x89<\xe2\x80\x89xidi\xe2\x80\x89+\xe2\x80\x891 is true for all integers i from 1 to k\xe2\x80\x89-\xe2\x80\x891.Please help Leha and Noora in choosing such xi for each town i, and such subsequence of towns id1,\xe2\x80\x89id2,\xe2\x80\x89...,\xe2\x80\x89idk, so that friends can visit maximal number of towns.You may assume, that Leha and Noora can start the trip any day." 2900

809C "Find a car" "combinatorics,divide and conquer,dp" "After a wonderful evening in the restaurant the time to go home came. Leha as a true gentlemen suggested Noora to give her a lift. Certainly the girl agreed with pleasure. Suddenly one problem appeared: Leha cannot find his car on a huge parking near the restaurant. So he decided to turn to the watchman for help.Formally the parking can be represented as a matrix 109\xe2\x80\x89\xc3\x97\xe2\x80\x89109. There is exactly one car in every cell of the matrix. All cars have their own machine numbers represented as a positive integer. Let\'s index the columns of the matrix by integers from 1 to 109 from left to right and the rows by integers from 1 to 109 from top to bottom. By coincidence it turned out, that for every cell (x,\xe2\x80\x89y) the number of the car, which stands in this cell, is equal to the minimum positive integer, which can\'t be found in the cells (i,\xe2\x80\x89y) and (x,\xe2\x80\x89j), 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89x,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89y.  The upper left fragment 5\xe2\x80\x89\xc3\x97\xe2\x80\x895 of the parking Leha wants to ask the watchman q requests, which can help him to find his car. Every request is represented as five integers x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2,\xe2\x80\x89k. The watchman have to consider all cells (x,\xe2\x80\x89y) of the matrix, such that x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2 and y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2, and if the number of the car in cell (x,\xe2\x80\x89y) does not exceed k, increase the answer to the request by the number of the car in cell (x,\xe2\x80\x89y). For each request Leha asks the watchman to tell him the resulting sum. Due to the fact that the sum can turn out to be quite large, hacker asks to calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897.However the requests seem to be impracticable for the watchman. Help the watchman to answer all Leha\'s requests." 2600

809B "Glad to see you!" "binary search,interactive" "This is an interactive problem. In the output section below you will see the information about flushing the output.On Sunday Leha the hacker took Nura from the house where she lives and went with her to one of the most luxurious restaurants in Vi\xc4\x8dkopolis. Upon arrival, they left the car in a huge parking lot near the restaurant and hurried inside the building.In the restaurant a polite waiter immediately brought the menu to Leha and Noora, consisting of n dishes. It is interesting that all dishes in the menu are numbered with integers from 1 to n. After a little thought, the girl ordered exactly k different dishes from available in the menu. To pass the waiting time while the chefs prepare ordered dishes, the girl invited the hacker to play a game that will help them get to know each other better.The game itself is very simple: Noora wants Leha to guess any two dishes among all ordered. At the same time, she is ready to answer only one type of questions. Leha can say two numbers x and y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). After that Noora chooses some dish a for the number x such that, at first, a is among the dishes Noora ordered (x can be equal to a), and, secondly, the value  is the minimum possible. By the same rules the girl chooses dish b for y. After that Noora says \xc2\xabTAK\xc2\xbb to Leha, if , and \xc2\xabNIE\xc2\xbb otherwise. However, the restaurant is preparing quickly, so Leha has enough time to ask no more than 60 questions. After that he should name numbers of any two dishes Noora ordered.Help Leha to solve this problem!" 2200

809A "Do you want a date?" implementation,math,sortings "Leha decided to move to a quiet town Vi\xc4\x8dkopolis, because he was tired by living in Bankopolis. Upon arrival he immediately began to expand his network of hacked computers. During the week Leha managed to get access to n computers throughout the town. Incidentally all the computers, which were hacked by Leha, lie on the same straight line, due to the reason that there is the only one straight street in Vi\xc4\x8dkopolis.Let\'s denote the coordinate system on this street. Besides let\'s number all the hacked computers with integers from 1 to n. So the i-th hacked computer is located at the point xi. Moreover the coordinates of all computers are distinct. Leha is determined to have a little rest after a hard week. Therefore he is going to invite his friend Noora to a restaurant. However the girl agrees to go on a date with the only one condition: Leha have to solve a simple task.Leha should calculate a sum of F(a) for all a, where a is a non-empty subset of the set, that consists of all hacked computers. Formally, let\'s denote A the set of all integers from 1 to n. Noora asks the hacker to find value of the expression . Here F(a) is calculated as the maximum among the distances between all pairs of computers from the set a. Formally, . Since the required sum can be quite large Noora asks to find it modulo 109\xe2\x80\x89+\xe2\x80\x897.Though, Leha is too tired. Consequently he is not able to solve this task. Help the hacker to attend a date." 1500

808G "Anthem of Berland" dp,strings "Berland has a long and glorious history. To increase awareness about it among younger citizens, King of Berland decided to compose an anthem.Though there are lots and lots of victories in history of Berland, there is the one that stand out the most. King wants to mention it in the anthem as many times as possible.He has already composed major part of the anthem and now just needs to fill in some letters. King asked you to help him with this work.The anthem is the string s of no more than 105 small Latin letters and question marks. The most glorious victory is the string t of no more than 105 small Latin letters. You should replace all the question marks with small Latin letters in such a way that the number of occurrences of string t in string s is maximal.Note that the occurrences of string t in s can overlap. Check the third example for clarification." 2300

808F "Card Game" "binary search,flows,graphs" "Digital collectible card games have become very popular recently. So Vova decided to try one of these.Vova has n cards in his collection. Each of these cards is characterised by its power pi, magic number ci and level li. Vova wants to build a deck with total power not less than k, but magic numbers may not allow him to do so \xe2\x80\x94 Vova can\'t place two cards in a deck if the sum of the magic numbers written on these cards is a prime number. Also Vova cannot use a card if its level is greater than the level of Vova\'s character.At the moment Vova\'s character\'s level is 1. Help Vova to determine the minimum level he needs to reach in order to build a deck with the required total power." 2400

808E "Selling Souvenirs" "binary search,dp,greedy,ternary search" "After several latest reforms many tourists are planning to visit Berland, and Berland people understood that it\'s an opportunity to earn money and changed their jobs to attract tourists. Petya, for example, left the IT corporation he had been working for and started to sell souvenirs at the market.This morning, as usual, Petya will come to the market. Petya has n different souvenirs to sell; ith souvenir is characterised by its weight wi and cost ci. Petya knows that he might not be able to carry all the souvenirs to the market. So Petya wants to choose a subset of souvenirs such that its total weight is not greater than m, and total cost is maximum possible.Help Petya to determine maximum possible total cost." 2300

808D "Array Division" "binary search,data structures,implementation" "Vasya has an array a consisting of positive integer numbers. Vasya wants to divide this array into two non-empty consecutive parts (the prefix and the suffix) so that the sum of all elements in the first part equals to the sum of elements in the second part. It is not always possible, so Vasya will move some element before dividing the array (Vasya will erase some element and insert it into an arbitrary position).Inserting an element in the same position he was erased from is also considered moving.Can Vasya divide the array after choosing the right element to move and its new position?" 1900

808C "Tea Party" "constructive algorithms,greedy,sortings" "Polycarp invited all his friends to the tea party to celebrate the holiday. He has n cups, one for each of his n friends, with volumes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. His teapot stores w milliliters of tea (w\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an). Polycarp wants to pour tea in cups in such a way that:  Every cup will contain tea for at least half of its volume  Every cup will contain integer number of milliliters of tea  All the tea from the teapot will be poured into cups  All friends will be satisfied. Friend with cup i won\'t be satisfied, if there exists such cup j that cup i contains less tea than cup j but ai\xe2\x80\x89>\xe2\x80\x89aj.For each cup output how many milliliters of tea should be poured in it. If it\'s impossible to pour all the tea and satisfy all conditions then output -1." 1400

808B "Average Sleep Time" "data structures,implementation,math" "It\'s been almost a week since Polycarp couldn\'t get rid of insomnia. And as you may already know, one week in Berland lasts k days!When Polycarp went to a doctor with his problem, the doctor asked him about his sleeping schedule (more specifically, the average amount of hours of sleep per week). Luckily, Polycarp kept records of sleep times for the last n days. So now he has a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is the sleep time on the i-th day.The number of records is so large that Polycarp is unable to calculate the average value by himself. Thus he is asking you to help him with the calculations. To get the average Polycarp is going to consider k consecutive days as a week. So there will be n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 weeks to take into consideration. For example, if k\xe2\x80\x89=\xe2\x80\x892, n\xe2\x80\x89=\xe2\x80\x893 and a\xe2\x80\x89=\xe2\x80\x89[3,\xe2\x80\x894,\xe2\x80\x897], then the result is .You should write a program which will calculate average sleep times of Polycarp over all weeks." 1300

808A "Lucky Year" implementation "Apart from having lots of holidays throughout the year, residents of Berland also have whole lucky years. Year is considered lucky if it has no more than 1 non-zero digit in its number. So years 100, 40000, 5 are lucky and 12, 3001 and 12345 are not.You are given current year in Berland. Your task is to find how long will residents of Berland wait till the next lucky year." 900

807B "T-Shirt Hunt" "brute force,implementation" "Not so long ago the Codecraft-17 contest was held on Codeforces. The top 25 participants, and additionally random 25 participants out of those who got into top 500, will receive a Codeforces T-shirt.Unfortunately, you didn\'t manage to get into top 25, but you got into top 500, taking place p.Now the elimination round of 8VC Venture Cup 2017 is being held. It has been announced that the Codecraft-17 T-shirt winners will be chosen as follows. Let s be the number of points of the winner of the elimination round of 8VC Venture Cup 2017. Then the following pseudocode will be executed: i := (s div 50) mod 475repeat 25 times:    i := (i * 96 + 42) mod 475    print (26 + i)Here ""div"" is the integer division operator, ""mod"" is the modulo (the remainder of division) operator.As the result of pseudocode execution, 25 integers between 26 and 500, inclusive, will be printed. These will be the numbers of places of the participants who get the Codecraft-17 T-shirts. It is guaranteed that the 25 printed integers will be pairwise distinct for any value of s.You\'re in the lead of the elimination round of 8VC Venture Cup 2017, having x points. You believe that having at least y points in the current round will be enough for victory.To change your final score, you can make any number of successful and unsuccessful hacks. A successful hack brings you 100 points, an unsuccessful one takes 50 points from you. It\'s difficult to do successful hacks, though.You want to win the current round and, at the same time, ensure getting a Codecraft-17 T-shirt. What is the smallest number of successful hacks you have to do to achieve that?" 1300

807A "Is it rated?" implementation,sortings "Is it rated?Here it is. The Ultimate Question of Competitive Programming, Codeforces, and Everything. And you are here to answer it.Another Codeforces round has been conducted. No two participants have the same number of points. For each participant, from the top to the bottom of the standings, their rating before and after the round is known.It\'s known that if at least one participant\'s rating has changed, then the round was rated for sure.It\'s also known that if the round was rated and a participant with lower rating took a better place in the standings than a participant with higher rating, then at least one round participant\'s rating has changed.In this problem, you should not make any other assumptions about the rating system.Determine if the current round is rated, unrated, or it\'s impossible to determine whether it is rated of not." 900

805B 3-palindrome "constructive algorithms" "In the beginning of the new year Keivan decided to reverse his name. He doesn\'t like palindromes, so he changed Naviek to Navick.He is too selfish, so for a given n he wants to obtain a string of n characters, each of which is either \'a\', \'b\' or \'c\', with no palindromes of length 3 appearing in the string as a substring. For example, the strings ""abc"" and ""abca"" suit him, while the string ""aba"" doesn\'t. He also want the number of letters \'c\' in his string to be as little as possible." 1000

805A "Fake NP" greedy,math "Tavak and Seyyed are good friends. Seyyed is very funny and he told Tavak to solve the following problem instead of longest-path.You are given l and r. For all integers from l to r, inclusive, we wrote down all of their integer divisors except 1. Find the integer that we wrote down the maximum number of times.Solve the problem to show that it\'s not a NP problem." 1000

804F "Fake bullions" "combinatorics,dfs and similar,dp,graphs,number theory" "In Isart people don\'t die. There are n gangs of criminals. The i-th gang contains si evil people numerated from 0 to si\xe2\x80\x89-\xe2\x80\x891. Some of these people took part in a big mine robbery and picked one gold bullion each (these people are given in the input). That happened 10100 years ago and then all of the gangs escaped to a remote area, far from towns.During the years, they were copying some gold bullions according to an organized plan in order to not get arrested. They constructed a tournament directed graph (a graph where there is exactly one directed edge between every pair of vertices) of gangs (the graph is given in the input). In this graph an edge from u to v means that in the i-th hour the person  of the gang u can send a fake gold bullion to person  of gang v. He sends it if he has some bullion (real or fake), while the receiver doesn\'t have any. Thus, at any moment each of the gangsters has zero or one gold bullion. Some of them have real bullions, and some of them have fake ones.In the beginning of this year, the police has finally found the gangs, but they couldn\'t catch them, as usual. The police decided to open a jewelry store so that the gangsters would sell the bullions. Thus, every gangster that has a bullion (fake or real) will try to sell it. If he has a real gold bullion, he sells it without problems, but if he has a fake one, there is a choice of two events that can happen:   The person sells the gold bullion successfully.  The person is arrested by police. The power of a gang is the number of people in it that successfully sold their bullion. After all selling is done, the police arrests b gangs out of top gangs. Sort the gangs by powers, we call the first a gang top gangs(you can sort the equal powers in each order). Consider all possible results of selling fake gold bullions and all possible choice of b gangs among the top gangs. Count the number of different sets of these b gangs modulo 109\xe2\x80\x89+\xe2\x80\x897. Two sets X and Y are considered different if some gang is in X and isn\'t in Y." 3400

804E "The same permutation" "constructive algorithms" "Seyyed and MoJaK are friends of Sajjad. Sajjad likes a permutation. Seyyed wants to change the permutation in a way that Sajjad won\'t like it. Seyyed thinks more swaps yield more probability to do that, so he makes MoJaK to perform a swap between every pair of positions (i,\xe2\x80\x89j), where i\xe2\x80\x89<\xe2\x80\x89j, exactly once. MoJaK doesn\'t like to upset Sajjad.Given the permutation, determine whether it is possible to swap all pairs of positions so that the permutation stays the same. If it is possible find how to do that." 3100

804D "Expected diameter of a tree" "binary search,brute force,dfs and similar,dp,sortings,trees" "Pasha is a good student and one of MoJaK\'s best friends. He always have a problem to think about. Today they had a talk about the following problem.We have a forest (acyclic undirected graph) with n vertices and m edges. There are q queries we should answer. In each query two vertices v and u are given. Let V be the set of vertices in the connected component of the graph that contains v, and U be the set of vertices in the connected component of the graph that contains u. Let\'s add an edge between some vertex  and some vertex in  and compute the value d of the resulting component. If the resulting component is a tree, the value d is the diameter of the component, and it is equal to -1 otherwise. What is the expected value of d, if we choose vertices a and b from the sets uniformly at random?Can you help Pasha to solve this problem?The diameter of the component is the maximum distance among some pair of vertices in the component. The distance between two vertices is the minimum number of edges on some path between the two vertices.Note that queries don\'t add edges to the initial forest." 2500

804C "Ice cream coloring" "constructive algorithms,dfs and similar,greedy" "Isart and Modsart were trying to solve an interesting problem when suddenly Kasra arrived. Breathless, he asked: ""Can you solve a problem I\'m stuck at all day?""We have a tree T with n vertices and m types of ice cream numerated from 1 to m. Each vertex i has a set of si types of ice cream. Vertices which have the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) type of ice cream form a connected subgraph. We build a new graph G with m vertices. We put an edge between the v-th and the u-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m, u\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89v) vertices in G if and only if there exists a vertex in T that has both the v-th and the u-th types of ice cream in its set. The problem is to paint the vertices of G with minimum possible number of colors in a way that no adjacent vertices have the same color.Please note that we consider that empty set of vertices form a connected subgraph in this problem.As usual, Modsart don\'t like to abandon the previous problem, so Isart wants you to solve the new problem." 2200

804B "Minimum number of steps" combinatorics,greedy,implementation,math "We have a string of letters \'a\' and \'b\'. We want to perform some operations on it. On each step we choose one of substrings ""ab"" in the string and replace it with the string ""bba"". If we have no ""ab"" as a substring, our job is done. Print the minimum number of steps we should perform to make our job done modulo 109\xe2\x80\x89+\xe2\x80\x897.The string ""ab"" appears as a substring if there is a letter \'b\' right after the letter \'a\' somewhere in the string." 1400

804A "Find Amir" "constructive algorithms,greedy,math" "A few years ago Sajjad left his school and register to another one due to security reasons. Now he wishes to find Amir, one of his schoolmates and good friends.There are n schools numerated from 1 to n. One can travel between each pair of them, to do so, he needs to buy a ticket. The ticker between schools i and j costs  and can be used multiple times. Help Sajjad to find the minimum cost he needs to pay for tickets to visit all schools. He can start and finish in any school." 1000

803G "Periodic RMQ Problem" "data structures" "You are given an array a consisting of positive integers and q queries to this array. There are two types of queries:   1 l r x \xe2\x80\x94 for each index i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r set ai\xe2\x80\x89=\xe2\x80\x89x.  2 l r \xe2\x80\x94 find the minimum among such ai that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. We decided that this problem is too easy. So the array a is given in a compressed form: there is an array b consisting of n elements and a number k in the input, and before all queries a is equal to the concatenation of k arrays b (so the size of a is n\xc2\xb7k)." 2300

803F "Coprime Subsequences" "bitmasks,combinatorics,number theory" "Let\'s call a non-empty sequence of positive integers a1,\xe2\x80\x89a2... ak coprime if the greatest common divisor of all elements of this sequence is equal to 1.Given an array a consisting of n positive integers, find the number of its coprime subsequences. Since the answer may be very large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897.Note that two subsequences are considered different if chosen indices are different. For example, in the array [1,\xe2\x80\x891] there are 3 different subsequences: [1], [1] and [1,\xe2\x80\x891]." 2000

803E "Roma and Poker" dp,graphs "Each evening Roma plays online poker on his favourite website. The rules of poker on this website are a bit strange: there are always two players in a hand, there are no bets, and the winner takes 1 virtual bourle from the loser.Last evening Roma started to play poker. He decided to spend no more than k virtual bourles \xe2\x80\x94 he will stop immediately if the number of his loses exceeds the number of his wins by k. Also Roma will leave the game if he wins enough money for the evening, i.e. if the number of wins exceeds the number of loses by k.Next morning Roma found a piece of paper with a sequence on it representing his results. Roma doesn\'t remember the results exactly, and some characters in the sequence are written in a way such that it\'s impossible to recognize this character, so Roma can\'t recall whether he won k bourles or he lost.The sequence written by Roma is a string s consisting of characters W (Roma won the corresponding hand), L (Roma lost), D (draw) and ? (unknown result). Roma wants to restore any valid sequence by changing all ? characters to W, L or D. The sequence is called valid if all these conditions are met:   In the end the absolute difference between the number of wins and loses is equal to k;  There is no hand such that the absolute difference before this hand was equal to k. Help Roma to restore any such sequence." 2000

803D "Magazine Ad" "binary search,greedy" "The main city magazine offers its readers an opportunity to publish their ads. The format of the ad should be like this:There are space-separated non-empty words of lowercase and uppercase Latin letters.There are hyphen characters \'-\' in some words, their positions set word wrapping points. Word can include more than one hyphen. It is guaranteed that there are no adjacent spaces and no adjacent hyphens. No hyphen is adjacent to space. There are no spaces and no hyphens before the first word and after the last word. When the word is wrapped, the part of the word before hyphen and the hyphen itself stay on current line and the next part of the word is put on the next line. You can also put line break between two words, in that case the space stays on current line. Check notes for better understanding.The ad can occupy no more that k lines and should have minimal width. The width of the ad is the maximal length of string (letters, spaces and hyphens are counted) in it.You should write a program that will find minimal width of the ad." 1900

803C "Maximal GCD" "constructive algorithms,greedy,math" "You are given positive integer number n. You should create such strictly increasing sequence of k positive numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak, that their sum is equal to n and greatest common divisor is maximal.Greatest common divisor of sequence is maximum of such numbers that every element of sequence is divisible by them.If there is no possible sequence then output -1." 1900

803B "Distances to Zero" "constructive algorithms" "You are given the array of integer numbers a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. For each element find the distance to the nearest zero (to the element which equals to zero). There is at least one zero element in the given array." 1200

803A "Maximal Binary Matrix" "constructive algorithms" "You are given matrix with n rows and n columns filled with zeroes. You should put k ones in it in such a way that the resulting matrix is symmetrical with respect to the main diagonal (the diagonal that goes from the top left to the bottom right corner) and is lexicographically maximal.One matrix is lexicographically greater than the other if the first different number in the first different row from the top in the first matrix is greater than the corresponding number in the second one.If there exists no such matrix then output -1." 1400

802O "April Fools\' Problem (hard)" "binary search,data structures,flows" "You are given matrix with n rows and n columns filled with zeroes. You should put k ones in it in such a way that the resulting matrix is symmetrical with respect to the main diagonal (the diagonal that goes from the top left to the bottom right corner) and is lexicographically maximal.One matrix is lexicographically greater than the other if the first different number in the first different row from the top in the first matrix is greater than the corresponding number in the second one.If there exists no such matrix then output -1." 2900

802N "April Fools\' Problem (medium)" "binary search,flows,graphs" "You are given matrix with n rows and n columns filled with zeroes. You should put k ones in it in such a way that the resulting matrix is symmetrical with respect to the main diagonal (the diagonal that goes from the top left to the bottom right corner) and is lexicographically maximal.One matrix is lexicographically greater than the other if the first different number in the first different row from the top in the first matrix is greater than the corresponding number in the second one.If there exists no such matrix then output -1." 2400

802M "April Fools\' Problem (easy)" greedy,sortings "You are given matrix with n rows and n columns filled with zeroes. You should put k ones in it in such a way that the resulting matrix is symmetrical with respect to the main diagonal (the diagonal that goes from the top left to the bottom right corner) and is lexicographically maximal.One matrix is lexicographically greater than the other if the first different number in the first different row from the top in the first matrix is greater than the corresponding number in the second one.If there exists no such matrix then output -1." 1200

802L "Send the Fool Further! (hard)" "dfs and similar,dp,math,trees" "Heidi is terrified by your estimate and she found it unrealistic that her friends would collaborate to drive her into debt. She expects that, actually, each person will just pick a random friend to send Heidi to. (This randomness assumption implies, however, that she can now visit the same friend an arbitrary number of times...) Moreover, if a person only has one friend in common with Heidi (i.e., if that person is in a leaf of the tree), then that person will not send Heidi back (so that Heidi\'s travel will end at some point).Heidi also found unrealistic the assumption that she can make all the travels in one day. Therefore now she assumes that every time she travels a route between two friends, she needs to buy a new ticket. She wants to know: how much should she expect to spend on the trips?For what it\'s worth, Heidi knows that Jenny has at least two friends." 2400

802K "Send the Fool Further! (medium)" dp,trees "Thank you for helping Heidi! It is now the second of April, but she has been summoned by Jenny again. The pranks do not seem to end...In the meantime, Heidi has decided that she does not trust her friends anymore. Not too much, anyway. Her relative lack of trust is manifested as follows: whereas previously she would not be made to visit the same person twice, now she can only be sure that she will not be made to visit the same person more than k times. (In the case of Jenny, this includes her first visit in the beginning. The situation from the easy version corresponds to setting k\xe2\x80\x89=\xe2\x80\x891.)This is not as bad as it looks, since a single ticket for a route between two friends allows Heidi to travel between this pair of friends the whole day (in both directions). In other words, once she pays for travel between a pair of friends, all further travels between that pair are free.How much money will Heidi waste now, in a worst-case scenario?" 2100

802J "Send the Fool Further! (easy)" "dfs and similar,graphs,trees" "Heidi\'s friend Jenny is asking Heidi to deliver an important letter to one of their common friends. Since Jenny is Irish, Heidi thinks that this might be a prank. More precisely, she suspects that the message she is asked to deliver states: ""Send the fool further!"", and upon reading it the recipient will ask Heidi to deliver the same message to yet another friend (that the recipient has in common with Heidi), and so on.Heidi believes that her friends want to avoid awkward situations, so she will not be made to visit the same person (including Jenny) twice. She also knows how much it costs to travel between any two of her friends who know each other. She wants to know: what is the maximal amount of money she will waste on travel if it really is a prank?Heidi\'s n friends are labeled 0 through n\xe2\x80\x89-\xe2\x80\x891, and their network of connections forms a tree. In other words, every two of her friends a, b know each other, possibly indirectly (there is a sequence of friends starting from a and ending on b and such that each two consecutive friends in the sequence know each other directly), and there are exactly n\xe2\x80\x89-\xe2\x80\x891 pairs of friends who know each other directly.Jenny is given the number 0." 1400

802I "Fake News (hard)" "string suffix structures" "Now that you have proposed a fake post for the HC2 Facebook page, Heidi wants to measure the quality of the post before actually posting it. She recently came across a (possibly fake) article about the impact of fractal structure on multimedia messages and she is now trying to measure the self-similarity of the message, which is defined aswhere the sum is over all nonempty strings p and  is the number of occurences of p in s as a substring. (Note that the sum is infinite, but it only has a finite number of nonzero summands.)Heidi refuses to do anything else until she knows how to calculate this self-similarity. Could you please help her? (If you would like to instead convince Heidi that a finite string cannot be a fractal anyway \xe2\x80\x93 do not bother, we have already tried.)" 2300

802H "Fake News (medium)" "constructive algorithms,strings" "Thanks to your help, Heidi is confident that no one can fool her. She has now decided to post some fake news on the HC2 Facebook page. However, she wants to be able to communicate to the HC2 committee that the post is fake, using some secret phrase hidden in the post as a subsequence. To make this method foolproof, she wants the phrase to appear n times in the post. She is asking you to design a post (string) s and a hidden phrase p such that p appears in s as a subsequence exactly n times." 2200

802G "Fake News (easy)" implementation,strings "As it\'s the first of April, Heidi is suspecting that the news she reads today are fake, and she does not want to look silly in front of all the contestants. She knows that a newspiece is fake if it contains heidi as a subsequence. Help Heidi assess whether the given piece is true, but please be discreet about it..." 800

802F "Marmots (hard)" math,probabilities "Your task is the exact same as for the easy version. But this time, the marmots subtract the village\'s population P from their random number before responding to Heidi\'s request.Also, there are now villages with as few as a single inhabitant, meaning that .Can you help Heidi find out whether a village follows a Poisson or a uniform distribution?" 2800

802E "Marmots (medium)" math "Good job! Now that Heidi is able to distinguish between Poisson and uniform distributions, she is in a good position to actually estimate the populations.Can you help Heidi estimate each village\'s population?" 2200

802D "Marmots (easy)" math "Heidi is a statistician to the core, and she likes to study the evolution of marmot populations in each of V (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89V\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89100) villages! So it comes that every spring, when Heidi sees the first snowdrops sprout in the meadows around her barn, she impatiently dons her snowshoes and sets out to the Alps, to welcome her friends the marmots to a new season of thrilling adventures.Arriving in a village, Heidi asks each and every marmot she comes across for the number of inhabitants of that village. This year, the marmots decide to play an April Fools\' joke on Heidi. Instead of consistently providing the exact number of inhabitants P (10\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89P\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891000) of the village, they respond with a random non-negative integer k, drawn from one of two types of probability distributions:  Poisson (d\'avril) distribution: the probability of getting an answer k is  for k\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,  Uniform distribution: the probability of getting an answer k is  for k\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x892P. Heidi collects exactly 250 answers per village. Every village follows either the Poisson or the uniform distribution. Heidi cannot tell marmots apart, so she may query some marmots several times, and each time the marmot will answer with a new number drawn from the village\'s distribution.Can you help Heidi to find out whether a village follows a Poisson or a uniform distribution?" 2100

802C "Heidi and Library (hard)" flows "The good times at Heidi\'s library are over. Marmots finally got their internet connections and stopped coming to the library altogether. Not only that, but the bookstore has begun charging extortionate prices for some books. Namely, whereas in the previous versions each book could be bought for 1 CHF, now the price of book i is ci CHF." 2600

802B "Heidi and Library (medium)" "data structures,greedy" "Whereas humans nowadays read fewer and fewer books on paper, book readership among marmots has surged. Heidi has expanded the library and is now serving longer request sequences." 1800

802A "Heidi and Library (easy)" greedy "Your search for Heidi is over \xe2\x80\x93 you finally found her at a library, dressed up as a human. In fact, she has spent so much time there that she now runs the place! Her job is to buy books and keep them at the library so that people can borrow and read them. There are n different books, numbered 1 through n.We will look at the library\'s operation during n consecutive days. Heidi knows in advance that on the i-th day (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) precisely one person will come to the library, request to borrow the book ai, read it in a few hours, and return the book later on the same day.Heidi desperately wants to please all her guests, so she will make sure to always have the book ai available in the library on the i-th day. During the night before the i-th day, she has the option of going to the bookstore (which operates at nights to avoid competition with the library) and buying any book for the price of 1 CHF. Of course, if she already has a book at the library, she does not need to buy it again. Initially, the library contains no books.There is a problem, though. The capacity of the library is k \xe2\x80\x93 this means that at any time, there can be at most k books at the library. If buying a new book would cause Heidi to have more than k books, she must first get rid of some book that she already has, in order to make room for the new book. If she later needs a book that she got rid of, she will need to buy that book again.You are given k and the sequence of requests for books a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. What is the minimum cost (in CHF) of buying new books to satisfy all the requests?" 1800

801B "Valued Keys" "constructive algorithms,greedy,strings" "You found a mysterious function f. The function takes two strings s1 and s2. These strings must consist only of lowercase English letters, and must be the same length.The output of the function f is another string of the same length. The i-th character of the output is equal to the minimum of the i-th character of s1 and the i-th character of s2.For example, f(""ab"", ""ba"") = ""aa"", and f(""nzwzl"", ""zizez"") = ""niwel"".You found two strings x and y of the same length and consisting of only lowercase English letters. Find any string z such that f(x,\xe2\x80\x89z)\xe2\x80\x89=\xe2\x80\x89y, or print -1 if no such string z exists." 900

801A "Vicious Keyboard" "brute force" "Tonio has a keyboard with only two letters, ""V"" and ""K"".One day, he has typed out a string s with only these two letters. He really likes it when the string ""VK"" appears, so he wishes to change at most one letter in the string (or do no changes) to maximize the number of occurrences of that string. Compute the maximum number of times ""VK"" can appear as a substring (i.�e. a letter ""K"" right after a letter ""V"") in the resulting string." 1100

799G "Cut the pie" "binary search,data structures,geometry" "Arkady reached the n-th level in Township game, so Masha decided to bake a pie for him! Of course, the pie has a shape of convex n-gon, i.e. a polygon with n vertices.Arkady decided to cut the pie in two equal in area parts by cutting it by a straight line, so that he can eat one of them and give the other to Masha. There is a difficulty because Arkady has already put a knife at some point of the pie, so he now has to cut the pie by a straight line passing trough this point.Help Arkady: find a line that passes through the point Arkady has put a knife into and cuts the pie into two parts of equal area, or determine that it\'s impossible. Your program has to quickly answer many queries with the same pie, but different points in which Arkady puts a knife." 3500

799F "Beautiful fountains rows" "data structures" "Butler Ostin wants to show Arkady that rows of odd number of fountains are beautiful, while rows of even number of fountains are not.The butler wants to show Arkady n gardens. Each garden is a row of m cells, the i-th garden has one fountain in each of the cells between li and ri inclusive, and there are no more fountains in that garden. The issue is that some of the gardens contain even number of fountains, it is wrong to show them to Arkady.Ostin wants to choose two integers a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b and show only part of each of the gardens that starts at cell a and ends at cell b. Of course, only such segments suit Ostin that each garden has either zero or odd number of fountains on this segment. Also, it is necessary that at least one garden has at least one fountain on the segment from a to b.Help Ostin to find the total length of all such segments, i.e. sum up the value (b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x891) for each suitable pair (a,\xe2\x80\x89b)." 3500

799E "Aquarium decoration" "data structures,greedy,two pointers" "Arkady and Masha want to choose decorations for thier aquarium in Fishdom game. They have n decorations to choose from, each of them has some cost. To complete a task Arkady and Masha need to choose exactly m decorations from given, and they want to spend as little money as possible.There is one difficulty: Masha likes some a of the given decorations, Arkady likes some b of the given decorations. Some decorations may be liked by both Arkady and Masha, or not be liked by both. The friends want to choose such decorations so that each of them likes at least k decorations among the chosen. Help Masha and Arkady find the minimum sum of money they need to spend." 2500

799D "Field expansion" "brute force,dp,meet-in-the-middle" "In one of the games Arkady is fond of the game process happens on a rectangular field. In the game process Arkady can buy extensions for his field, each extension enlarges one of the field sizes in a particular number of times. Formally, there are n extensions, the i-th of them multiplies the width or the length (by Arkady\'s choice) by ai. Each extension can\'t be used more than once, the extensions can be used in any order.Now Arkady\'s field has size h\xe2\x80\x89\xc3\x97\xe2\x80\x89w. He wants to enlarge it so that it is possible to place a rectangle of size a\xe2\x80\x89\xc3\x97\xe2\x80\x89b on it (along the width or along the length, with sides parallel to the field sides). Find the minimum number of extensions needed to reach Arkady\'s goal." 2100

799C Fountains "binary search,data structures,implementation" "Arkady plays Gardenscapes a lot. Arkady wants to build two new fountains. There are n available fountains, for each fountain its beauty and cost are known. There are two types of money in the game: coins and diamonds, so each fountain cost can be either in coins or diamonds. No money changes between the types are allowed.Help Arkady to find two fountains with maximum total beauty so that he can buy both at the same time." 1800

799B "T-shirt buying" "data structures,implementation" "A new pack of n t-shirts came to a shop. Each of the t-shirts is characterized by three integers pi, ai and bi, where pi is the price of the i-th t-shirt, ai is front color of the i-th t-shirt and bi is back color of the i-th t-shirt. All values pi are distinct, and values ai and bi are integers from 1 to 3.m buyers will come to the shop. Each of them wants to buy exactly one t-shirt. For the j-th buyer we know his favorite color cj.A buyer agrees to buy a t-shirt, if at least one side (front or back) is painted in his favorite color. Among all t-shirts that have colors acceptable to this buyer he will choose the cheapest one. If there are no such t-shirts, the buyer won\'t buy anything. Assume that the buyers come one by one, and each buyer is served only after the previous one is served.You are to compute the prices each buyer will pay for t-shirts." 1400

799A "Carrot Cakes" "brute force,implementation" "In some game by Playrix it takes t minutes for an oven to bake k carrot cakes, all cakes are ready at the same moment t minutes after they started baking. Arkady needs at least n cakes to complete a task, but he currently don\'t have any. However, he has infinitely many ingredients and one oven. Moreover, Arkady can build one more similar oven to make the process faster, it would take d minutes to build the oven. While the new oven is being built, only old one can bake cakes, after the new oven is built, both ovens bake simultaneously. Arkady can\'t build more than one oven.Determine if it is reasonable to build the second oven, i.e. will it decrease the minimum time needed to get n cakes or not. If the time needed with the second oven is the same as with one oven, then it is unreasonable." 1100

798E "Mike and code of a permutation" "constructive algorithms,data structures,graphs,sortings" "Mike has discovered a new way to encode permutations. If he has a permutation P\xe2\x80\x89=\xe2\x80\x89[p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn], he will encode it in the following way:Denote by A\xe2\x80\x89=\xe2\x80\x89[a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an] a sequence of length n which will represent the code of the permutation. For each i from 1 to n sequentially, he will choose the smallest unmarked j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that pi\xe2\x80\x89<\xe2\x80\x89pj and will assign to ai the number j (in other words he performs ai\xe2\x80\x89=\xe2\x80\x89j) and will mark j. If there is no such j, he\'ll assign to ai the number \xe2\x80\x89-\xe2\x80\x891 (he performs ai\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891). Mike forgot his original permutation but he remembers its code. Your task is simple: find any permutation such that its code is the same as the code of Mike\'s original permutation.You may assume that there will always be at least one valid permutation." 3000

798D "Mike and distribution" "constructive algorithms,sortings" "Mike has always been thinking about the harshness of social inequality. He\'s so obsessed with it that sometimes it even affects him while solving problems. At the moment, Mike has two sequences of positive integers A\xe2\x80\x89=\xe2\x80\x89[a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an] and B\xe2\x80\x89=\xe2\x80\x89[b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn] of length n each which he uses to ask people some quite peculiar questions.To test you on how good are you at spotting inequality in life, he wants you to find an ""unfair"" subset of the original sequence. To be more precise, he wants you to select k numbers P\xe2\x80\x89=\xe2\x80\x89[p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk] such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k and elements in P are distinct. Sequence P will represent indices of elements that you\'ll select from both sequences. He calls such a subset P ""unfair"" if and only if the following conditions are satisfied: 2\xc2\xb7(ap1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89apk) is greater than the sum of all elements from sequence A, and 2\xc2\xb7(bp1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89bpk) is greater than the sum of all elements from the sequence B. Also, k should be smaller or equal to  because it will be to easy to find sequence P if he allowed you to select too many elements!Mike guarantees you that a solution will always exist given the conditions described above, so please help him satisfy his curiosity!" 2400

798C "Mike and gcd problem" "dp,greedy,number theory" "Mike has a sequence A\xe2\x80\x89=\xe2\x80\x89[a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an] of length n. He considers the sequence B\xe2\x80\x89=\xe2\x80\x89[b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn] beautiful if the gcd of all its elements is bigger than 1, i.e. . Mike wants to change his sequence in order to make it beautiful. In one move he can choose an index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), delete numbers ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 and put numbers ai\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 in their place instead, in this order. He wants perform as few operations as possible. Find the minimal number of operations to make sequence A beautiful if it\'s possible, or tell him that it is impossible to do so. is the biggest non-negative number d such that d divides bi for every i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n)." 1700

798B "Mike and strings" "brute force,dp,strings" "Mike has n strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn each consisting of lowercase English letters. In one move he can choose a string si, erase the first character and append it to the end of the string. For example, if he has the string ""coolmike"", in one move he can transform it into the string ""oolmikec"".Now Mike asks himself: what is minimal number of moves that he needs to do in order to make all the strings equal?" 1300

798A "Mike and palindrome" "brute force,constructive algorithms,strings" "Mike has a string s consisting of only lowercase English letters. He wants to change exactly one character from the string so that the resulting one is a palindrome. A palindrome is a string that reads the same backward as forward, for example strings ""z"", ""aaa"", ""aba"", ""abccba"" are palindromes, but strings ""codeforces"", ""reality"", ""ab"" are not." 1000

797F "Mice and Holes" "data structures,dp,greedy,sortings" "One day Masha came home and noticed n mice in the corridor of her flat. Of course, she shouted loudly, so scared mice started to run to the holes in the corridor.The corridor can be represeted as a numeric axis with n mice and m holes on it. ith mouse is at the coordinate xi, and jth hole \xe2\x80\x94 at coordinate pj. jth hole has enough room for cj mice, so not more than cj mice can enter this hole.What is the minimum sum of distances that mice have to go through so that they all can hide in the holes? If ith mouse goes to the hole j, then its distance is |xi\xe2\x80\x89-\xe2\x80\x89pj|.Print the minimum sum of distances." 2600

797E "Array Queries" "brute force,data structures,dp" "a is an array of n positive integers, all of which are not greater than n.You have to process q queries to this array. Each query is represented by two numbers p and k. Several operations are performed in each query; each operation changes p to p\xe2\x80\x89+\xe2\x80\x89ap\xe2\x80\x89+\xe2\x80\x89k. There operations are applied until p becomes greater than n. The answer to the query is the number of performed operations." 2000

797D "Broken BST" "data structures,dfs and similar" "Let T be arbitrary binary tree \xe2\x80\x94 tree, every vertex of which has no more than two children. Given tree is rooted, so there exists only one vertex which doesn\'t have a parent \xe2\x80\x94 it\'s the root of a tree. Every vertex has an integer number written on it. Following algorithm is run on every value from the tree T:  Set pointer to the root of a tree.  Return success if the value in the current vertex is equal to the number you are looking for  Go to the left child of the vertex if the value in the current vertex is greater than the number you are looking for  Go to the right child of the vertex if the value in the current vertex is less than the number you are looking for  Return fail if you try to go to the vertex that doesn\'t exist Here is the pseudo-code of the described algorithm: bool find(TreeNode t, int x) {    if (t == null)        return false;    if (t.value == x)        return true;    if (x < t.value)        return find(t.left, x);    else        return find(t.right, x);}find(root, x);The described algorithm works correctly if the tree is binary search tree (i.e. for each node the values of left subtree are less than the value in the node, the values of right subtree are greater than the value in the node). But it can return invalid result if tree is not a binary search tree.Since the given tree is not necessarily a binary search tree, not all numbers can be found this way. Your task is to calculate, how many times the search will fail being running on every value from the tree.If the tree has multiple vertices with the same values on them then you should run algorithm on every one of them separately." 2100

797C "Minimal string" "data structures,greedy,strings" "Petya recieved a gift of a string s with length up to 105 characters for his birthday. He took two more empty strings t and u and decided to play a game. This game has two possible moves:  Extract the first character of s and append t with this character.  Extract the last character of t and append u with this character. Petya wants to get strings s and t empty and string u lexicographically minimal.You should write a program that will help Petya win the game." 1700

797B "Odd sum" dp,greedy,implementation "You are given sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of integer numbers of length n. Your task is to find such subsequence that its sum is odd and maximum among all such subsequences. It\'s guaranteed that given sequence contains subsequence with odd sum.Subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements.You should write a program which finds sum of the best subsequence." 1400

797A k-Factorization "implementation,math,number theory" "Given a positive integer n, find k integers (not necessary distinct) such that all these integers are strictly greater than 1, and their product is equal to n." 1100

796F "Sequence Recovery" "bitmasks,data structures,greedy" "Zane once had a good sequence a consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an�\xe2\x80\x94 but he has lost it.A sequence is said to be good if and only if all of its integers are non-negative and do not exceed 109 in value.  However, Zane remembers having played around with his sequence by applying m operations to it.There are two types of operations:1. Find the maximum value of integers with indices i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r, given l and r.2. Assign d as the value of the integer with index k, given k and d.After he finished playing, he restored his sequence to the state it was before any operations were applied. That is, sequence a was no longer affected by the applied type 2 operations. Then, he lost his sequence at some time between now and then.Fortunately, Zane remembers all the operations and the order he applied them to his sequence, along with the distinct results of all type 1 operations. Moreover, among all good sequences that would produce the same results when the same operations are applied in the same order, he knows that his sequence a has the greatest cuteness.We define cuteness of a sequence as the bitwise OR result of all integers in such sequence. For example, the cuteness of Zane\'s sequence a is a1 OR a2 OR ... OR an.Zane understands that it might not be possible to recover exactly the lost sequence given his information, so he would be happy to get any good sequence b consisting of n integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn that:1. would give the same results when the same operations are applied in the same order, and2. has the same cuteness as that of Zane\'s original sequence a.If there is such a sequence, find it. Otherwise, it means that Zane must have remembered something incorrectly, which is possible." 2800

796E "Exam Cheating" "binary search,dp" "Zane and Zane\'s crush have just decided to date! However, the girl is having a problem with her Physics final exam, and needs your help.There are n questions, numbered from 1 to n. Question i comes before question i\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n). Each of the questions cannot be guessed on, due to the huge penalty for wrong answers. The girl luckily sits in the middle of two geniuses, so she is going to cheat.  However, the geniuses have limitations. Each of them may or may not know the answers to some questions. Anyway, it is safe to assume that the answers on their answer sheets are absolutely correct.To make sure she will not get caught by the proctor, the girl will glance at most p times, each time looking at no more than k consecutive questions on one of the two geniuses\' answer sheet. When the girl looks at some question on an answer sheet, she copies the answer to that question if it is on that answer sheet, or does nothing otherwise.Help the girl find the maximum number of questions she can get correct." 2400

796D "Police Stations" "constructive algorithms,dfs and similar,dp,graphs,shortest paths,trees" "Inzane finally found Zane with a lot of money to spare, so they together decided to establish a country of their own.Ruling a country is not an easy job. Thieves and terrorists are always ready to ruin the country\'s peace. To fight back, Zane and Inzane have enacted a very effective law: from each city it must be possible to reach a police station by traveling at most d kilometers along the roads.  There are n cities in the country, numbered from 1 to n, connected only by exactly n\xe2\x80\x89-\xe2\x80\x891 roads. All roads are 1 kilometer long. It is initially possible to travel from a city to any other city using these roads. The country also has k police stations located in some cities. In particular, the city\'s structure satisfies the requirement enforced by the previously mentioned law. Also note that there can be multiple police stations in one city.However, Zane feels like having as many as n\xe2\x80\x89-\xe2\x80\x891 roads is unnecessary. The country is having financial issues, so it wants to minimize the road maintenance cost by shutting down as many roads as possible.Help Zane find the maximum number of roads that can be shut down without breaking the law. Also, help him determine such roads." 2100

796C "Bank Hacking" "constructive algorithms,data structures,dp,trees" "Although Inzane successfully found his beloved bone, Zane, his owner, has yet to return. To search for Zane, he would need a lot of money, of which he sadly has none. To deal with the problem, he has decided to hack the banks.  There are n banks, numbered from 1 to n. There are also n\xe2\x80\x89-\xe2\x80\x891 wires connecting the banks. All banks are initially online. Each bank also has its initial strength: bank i has initial strength ai.Let us define some keywords before we proceed. Bank i and bank j are neighboring if and only if there exists a wire directly connecting them. Bank i and bank j are semi-neighboring if and only if there exists an online bank k such that bank i and bank k are neighboring and bank k and bank j are neighboring.When a bank is hacked, it becomes offline (and no longer online), and other banks that are neighboring or semi-neighboring to it have their strengths increased by 1.To start his plan, Inzane will choose a bank to hack first. Indeed, the strength of such bank must not exceed the strength of his computer. After this, he will repeatedly choose some bank to hack next until all the banks are hacked, but he can continue to hack bank x if and only if all these conditions are met:  Bank x is online. That is, bank x is not hacked yet.  Bank x is neighboring to some offline bank.  The strength of bank x is less than or equal to the strength of Inzane\'s computer. Determine the minimum strength of the computer Inzane needs to hack all the banks." 1900

796B "Find The Bone" implementation "Zane the wizard is going to perform a magic show shuffling the cups.There are n cups, numbered from 1 to n, placed along the x-axis on a table that has m holes on it. More precisely, cup i is on the table at the position x\xe2\x80\x89=\xe2\x80\x89i.The problematic bone is initially at the position x\xe2\x80\x89=\xe2\x80\x891. Zane will confuse the audience by swapping the cups k times, the i-th time of which involves the cups at the positions x\xe2\x80\x89=\xe2\x80\x89ui and x\xe2\x80\x89=\xe2\x80\x89vi. If the bone happens to be at the position where there is a hole at any time, it will fall into the hole onto the ground and will not be affected by future swapping operations.Do not forget that Zane is a wizard. When he swaps the cups, he does not move them ordinarily. Instead, he teleports the cups (along with the bone, if it is inside) to the intended positions. Therefore, for example, when he swaps the cup at x\xe2\x80\x89=\xe2\x80\x894 and the one at x\xe2\x80\x89=\xe2\x80\x896, they will not be at the position x\xe2\x80\x89=\xe2\x80\x895 at any moment during the operation.  Zane\xe2\x80\x99s puppy, Inzane, is in trouble. Zane is away on his vacation, and Inzane cannot find his beloved bone, as it would be too exhausting to try opening all the cups. Inzane knows that the Codeforces community has successfully helped Zane, so he wants to see if it could help him solve his problem too. Help Inzane determine the final position of the bone." 1300

796A "Buying A House" "brute force,implementation" "Zane the wizard had never loved anyone before, until he fell in love with a girl, whose name remains unknown to us.  The girl lives in house m of a village. There are n houses in that village, lining in a straight line from left to right: house 1, house 2, ..., house n. The village is also well-structured: house i and house i\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) are exactly 10 meters away. In this village, some houses are occupied, and some are not. Indeed, unoccupied houses can be purchased.You will be given n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an that denote the availability and the prices of the houses. If house i is occupied, and therefore cannot be bought, then ai equals 0. Otherwise, house i can be bought, and ai represents the money required to buy it, in dollars.As Zane has only k dollars to spare, it becomes a challenge for him to choose the house to purchase, so that he could live as near as possible to his crush. Help Zane determine the minimum distance from his crush\'s house to some house he can afford, to help him succeed in his love." 800

794G "Replace All" combinatorics,dp,math "Igor the analyst is at work. He learned about a feature in his text editor called ""Replace All"". Igor is too bored at work and thus he came up with the following problem:Given two strings x and y which consist of the English letters \'A\' and \'B\' only, a pair of strings (s,\xe2\x80\x89t) is called good if: s and t consist of the characters \'0\' and \'1\' only. 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|,\xe2\x80\x89|t|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, where |z| denotes the length of string z, and n is a fixed positive integer. If we replace all occurrences of \'A\' in x and y with the string s, and replace all occurrences of \'B\' in x and y with the string t, then the two obtained from x and y strings are equal. For example, if x\xe2\x80\x89=\xe2\x80\x89AAB, y\xe2\x80\x89=\xe2\x80\x89BB and n\xe2\x80\x89=\xe2\x80\x894, then (01, 0101) is one of good pairs of strings, because both obtained after replacing strings are ""01010101"".The flexibility of a pair of strings x and y is the number of pairs of good strings (s,\xe2\x80\x89t). The pairs are ordered, for example the pairs (0, 1) and (1, 0) are different.You\'re given two strings c and d. They consist of characters \'A\', \'B\' and \'?\' only. Find the sum of flexibilities of all possible pairs of strings (c\',\xe2\x80\x89d\') such that c\' and d\' can be obtained from c and d respectively by replacing the question marks with either \'A\' or \'B\', modulo 109\xe2\x80\x89+\xe2\x80\x897." 3400

794F "Leha and security system" "data structures" "Bankopolis, the city you already know, finally got a new bank opened! Unfortunately, its security system is not yet working fine... Meanwhile hacker Leha arrived in Bankopolis and decided to test the system!Bank has n cells for clients\' money. A sequence from n numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an describes the amount of money each client has. Leha wants to make requests to the database of the bank, finding out the total amount of money on some subsegments of the sequence and changing values of the sequence on some subsegments. Using a bug in the system, Leha can requests two types of queries to the database:  1 l r x y denoting that Leha changes each digit x to digit y in each element of sequence ai, for which l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r is holds. For example, if we change in number 11984381 digit 8 to 4, we get 11944341. It\'s worth noting that Leha, in order to stay in the shadow, never changes digits in the database to 0, i.e. y\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890.  2 l r denoting that Leha asks to calculate and print the sum of such elements of sequence ai, for which l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r holds. As Leha is a white-hat hacker, he don\'t want to test this vulnerability on a real database. You are to write a similar database for Leha to test." 2800

794E "Choosing Carrot" games,math "Oleg the bank client and Igor the analyst are arguing again. This time, they want to pick a gift as a present for their friend, ZS the coder. After a long thought, they decided that their friend loves to eat carrots the most and thus they want to pick the best carrot as their present.There are n carrots arranged in a line. The i-th carrot from the left has juiciness ai. Oleg thinks ZS loves juicy carrots whereas Igor thinks that he hates juicy carrots. Thus, Oleg would like to maximize the juiciness of the carrot they choose while Igor would like to minimize the juiciness of the carrot they choose.To settle this issue, they decided to play a game again. Oleg and Igor take turns to play the game. In each turn, a player can choose a carrot from either end of the line, and eat it. The game ends when only one carrot remains. Oleg moves first. The last remaining carrot will be the carrot that they will give their friend, ZS.Oleg is a sneaky bank client. When Igor goes to a restroom, he performs k moves before the start of the game. Each move is the same as above (eat a carrot from either end of the line). After Igor returns, they start the game with Oleg still going first. Oleg wonders: for each k such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, what is the juiciness of the carrot they will give to ZS if he makes k extra moves beforehand and both players play optimally?" 2800

794D "Labelling Cities" "dfs and similar,graphs,hashing" "Oleg the bank client lives in Bankopolia. There are n cities in Bankopolia and some pair of cities are connected directly by bi-directional roads. The cities are numbered from 1 to n. There are a total of m roads in Bankopolia, the i-th road connects cities ui and vi. It is guaranteed that from each city it is possible to travel to any other city using some of the roads.Oleg wants to give a label to each city. Suppose the label of city i is equal to xi. Then, it must hold that for all pairs of cities (u,\xe2\x80\x89v) the condition |xu\xe2\x80\x89-\xe2\x80\x89xv|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 holds if and only if there is a road connecting u and v.Oleg wonders if such a labeling is possible. Find an example of such labeling if the task is possible and state that it is impossible otherwise." 2400

794C "Naming Company" games,greedy,sortings "Oleg the client and Igor the analyst are good friends. However, sometimes they argue over little things. Recently, they started a new company, but they are having trouble finding a name for the company.To settle this problem, they\'ve decided to play a game. The company name will consist of n letters. Oleg and Igor each have a set of n letters (which might contain multiple copies of the same letter, the sets can be different). Initially, the company name is denoted by n question marks. Oleg and Igor takes turns to play the game, Oleg moves first. In each turn, a player can choose one of the letters c in his set and replace any of the question marks with c. Then, a copy of the letter c is removed from his set. The game ends when all the question marks has been replaced by some letter.For example, suppose Oleg has the set of letters {i,\xe2\x80\x89o,\xe2\x80\x89i} and Igor has the set of letters {i,\xe2\x80\x89m,\xe2\x80\x89o}. One possible game is as follows :Initially, the company name is ???.Oleg replaces the second question mark with \'i\'. The company name becomes ?i?. The set of letters Oleg have now is {i,\xe2\x80\x89o}.Igor replaces the third question mark with \'o\'. The company name becomes ?io. The set of letters Igor have now is {i,\xe2\x80\x89m}.Finally, Oleg replaces the first question mark with \'o\'. The company name becomes oio. The set of letters Oleg have now is {i}.In the end, the company name is oio.Oleg wants the company name to be as lexicographically small as possible while Igor wants the company name to be as lexicographically large as possible. What will be the company name if Oleg and Igor always play optimally?A string s\xe2\x80\x89=\xe2\x80\x89s1s2...sm is called lexicographically smaller than a string t\xe2\x80\x89=\xe2\x80\x89t1t2...tm (where s\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t) if si\xe2\x80\x89<\xe2\x80\x89ti where i is the smallest index such that si\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ti. (so sj\xe2\x80\x89=\xe2\x80\x89tj for all j\xe2\x80\x89<\xe2\x80\x89i)" 1800

794B "Cutting Carrot" geometry,math "Igor the analyst has adopted n little bunnies. As we all know, bunnies love carrots. Thus, Igor has bought a carrot to be shared between his bunnies. Igor wants to treat all the bunnies equally, and thus he wants to cut the carrot into n pieces of equal area. Formally, the carrot can be viewed as an isosceles triangle with base length equal to 1 and height equal to h. Igor wants to make n\xe2\x80\x89-\xe2\x80\x891 cuts parallel to the base to cut the carrot into n pieces. He wants to make sure that all n pieces have the same area. Can you help Igor determine where to cut the carrot so that each piece have equal area?  Illustration to the first example." 1200

794A "Bank Robbery" "brute force,implementation" "A robber has attempted to rob a bank but failed to complete his task. However, he had managed to open all the safes.Oleg the bank client loves money (who doesn\'t), and decides to take advantage of this failed robbery and steal some money from the safes. There are many safes arranged in a line, where the i-th safe from the left is called safe i. There are n banknotes left in all the safes in total. The i-th banknote is in safe xi. Oleg is now at safe a. There are two security guards, one of which guards the safe b such that b\xe2\x80\x89<\xe2\x80\x89a, i.e. the first guard is to the left of Oleg. The other guard guards the safe c so that c\xe2\x80\x89>\xe2\x80\x89a, i.e. he is to the right of Oleg.The two guards are very lazy, so they do not move. In every second, Oleg can either take all the banknotes from the current safe or move to any of the neighboring safes. However, he cannot visit any safe that is guarded by security guards at any time, becaues he might be charged for stealing. Determine the maximum amount of banknotes Oleg can gather." 800

793G "Oleg and chess" "data structures,divide and conquer,flows,graph matchings" "Oleg the bank client solves an interesting chess problem: place on n\xe2\x80\x89\xc3\x97\xe2\x80\x89n chessboard the maximum number of rooks so that they don\'t beat each other. Of course, no two rooks can share the same cell.Remind that a rook standing in the cell (a,\xe2\x80\x89b) beats a rook standing in the cell (x,\xe2\x80\x89y) if and only if a\xe2\x80\x89=\xe2\x80\x89x or b\xe2\x80\x89=\xe2\x80\x89y.Unfortunately (of fortunately?) for Oleg the answer in this problem was always n, so the task bored Oleg soon. He decided to make it more difficult by removing some cells from the board. If a cell is deleted, Oleg can\'t put a rook there, but rooks do beat each other ""through"" deleted cells.Oleg deletes the cells in groups, namely, he repeatedly choose a rectangle with sides parallel to the board sides and deletes all the cells inside the rectangle. Formally, if he chooses a rectangle, lower left cell of which has coordinates (x1,\xe2\x80\x89y1), and upper right cell of which has coordinates (x2,\xe2\x80\x89y2), then he deletes all such cells with coordinates (x,\xe2\x80\x89y) that x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2 and y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2. It is guaranteed that no cell is deleted twice, i.e. the chosen rectangles do not intersect.This version of the problem Oleg can\'t solve, and his friend Igor is busy at a conference, so he can\'t help Oleg.You are the last hope for Oleg! Help him: given the size of the board and the deleted rectangles find the maximum possible number of rooks that could be placed on the board so that no two rooks beat each other." 3400

793F "Julia the snail" "data structures,divide and conquer,dp" "After hard work Igor decided to have some rest.He decided to have a snail. He bought an aquarium with a slippery tree trunk in the center, and put a snail named Julia into the aquarium.Igor noticed that sometimes Julia wants to climb onto the trunk, but can\'t do it because the trunk is too slippery. To help the snail Igor put some ropes on the tree, fixing the lower end of the i-th rope on the trunk on the height li above the ground, and the higher end on the height ri above the ground.For some reason no two ropes share the same position of the higher end, i.e. all ri are distinct. Now Julia can move down at any place of the trunk, and also move up from the lower end of some rope to its higher end. Igor is proud of his work, and sometimes think about possible movements of the snail. Namely, he is interested in the following questions: \xc2\xabSuppose the snail is on the trunk at height x now. What is the highest position on the trunk the snail can get on if it would never be lower than x or higher than y?\xc2\xbb Please note that Julia can\'t move from a rope to the trunk before it reaches the higher end of the rope, and Igor is interested in the highest position on the tree trunk.Igor is interested in many questions, and not always can answer them. Help him, write a program that answers these questions." 3000

793E "Problem of offices" "constructive algorithms,dfs and similar,dp,trees" "Earlier, when there was no Internet, each bank had a lot of offices all around Bankopolis, and it caused a lot of problems. Namely, each day the bank had to collect cash from all the offices.Once Oleg the bank client heard a dialogue of two cash collectors. Each day they traveled through all the departments and offices of the bank following the same route every day. The collectors started from the central department and moved between some departments or between some department and some office using special roads. Finally, they returned to the central department. The total number of departments and offices was n, the total number of roads was n\xe2\x80\x89-\xe2\x80\x891. In other words, the special roads system was a rooted tree in which the root was the central department, the leaves were offices, the internal vertices were departments. The collectors always followed the same route in which the number of roads was minimum possible, that is 2n\xe2\x80\x89-\xe2\x80\x892.One of the collectors said that the number of offices they visited between their visits to offices a and then b (in the given order) is equal to the number of offices they visited between their visits to offices b and then a (in this order). The other collector said that the number of offices they visited between their visits to offices c and then d (in this order) is equal to the number of offices they visited between their visits to offices d and then c (in this order). The interesting part in this talk was that the shortest path (using special roads only) between any pair of offices among a, b, c and d passed through the central department.Given the special roads map and the indexes of offices a, b, c and d, determine if the situation described by the collectors was possible, or not." 2900

793D "Presents in Bankopolis" "dp,graphs,shortest paths" "Bankopolis is an incredible city in which all the n crossroads are located on a straight line and numbered from 1 to n along it. On each crossroad there is a bank office.The crossroads are connected with m oriented bicycle lanes (the i-th lane goes from crossroad ui to crossroad vi), the difficulty of each of the lanes is known.Oleg the bank client wants to gift happiness and joy to the bank employees. He wants to visit exactly k offices, in each of them he wants to gift presents to the employees.The problem is that Oleg don\'t want to see the reaction on his gifts, so he can\'t use a bicycle lane which passes near the office in which he has already presented his gifts (formally, the i-th lane passes near the office on the x-th crossroad if and only if min(ui,\xe2\x80\x89vi)\xe2\x80\x89<\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89max(ui,\xe2\x80\x89vi))). Of course, in each of the offices Oleg can present gifts exactly once. Oleg is going to use exactly k\xe2\x80\x89-\xe2\x80\x891 bicycle lane to move between offices. Oleg can start his path from any office and finish it in any office.Oleg wants to choose such a path among possible ones that the total difficulty of the lanes he will use is minimum possible. Find this minimum possible total difficulty." 2100

793C "Mice problem" geometry,implementation,math,sortings "Igor the analyst fell asleep on the work and had a strange dream. In the dream his desk was crowded with computer mice, so he bought a mousetrap to catch them.The desk can be considered as an infinite plane, then the mousetrap is a rectangle which sides are parallel to the axes, and which opposite sides are located in points (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2).Igor wants to catch all mice. Igor has analysed their behavior and discovered that each mouse is moving along a straight line with constant speed, the speed of the i-th mouse is equal to (vix,\xe2\x80\x89viy), that means that the x coordinate of the mouse increases by vix units per second, while the y coordinates increases by viy units. The mousetrap is open initially so that the mice are able to move freely on the desk. Igor can close the mousetrap at any moment catching all the mice that are strictly inside the mousetrap.Igor works a lot, so he is busy in the dream as well, and he asks you to write a program that by given mousetrap\'s coordinates, the initial coordinates of the mice and their speeds determines the earliest time moment in which he is able to catch all the mice. Please note that Igor can close the mousetrap only once." 2300

793B "Igor and his way to work" "dfs and similar,graphs,implementation,shortest paths" "Woken up by the alarm clock Igor the financial analyst hurried up to the work. He ate his breakfast and sat in his car. Sadly, when he opened his GPS navigator, he found that some of the roads in Bankopolis, the city where he lives, are closed due to road works. Moreover, Igor has some problems with the steering wheel, so he can make no more than two turns on his way to his office in bank.Bankopolis looks like a grid of n rows and m columns. Igor should find a way from his home to the bank that has no more than two turns and doesn\'t contain cells with road works, or determine that it is impossible and he should work from home. A turn is a change in movement direction. Igor\'s car can only move to the left, to the right, upwards and downwards. Initially Igor can choose any direction. Igor is still sleepy, so you should help him." 1600

793A "Oleg and shares" implementation,math "Oleg the bank client checks share prices every day. There are n share prices he is interested in. Today he observed that each second exactly one of these prices decreases by k rubles (note that each second exactly one price changes, but at different seconds different prices can change). Prices can become negative. Oleg found this process interesting, and he asked Igor the financial analyst, what is the minimum time needed for all n prices to become equal, or it is impossible at all? Igor is busy right now, so he asked you to help Oleg. Can you answer this question?" 900

792F "Mages and Monsters" "data structures,geometry" "Vova plays a computer game known as Mages and Monsters. Vova\'s character is a mage. Though as he has just started, his character knows no spells.Vova\'s character can learn new spells during the game. Every spell is characterized by two values xi and yi \xe2\x80\x94 damage per second and mana cost per second, respectively. Vova doesn\'t have to use a spell for an integer amount of seconds. More formally, if he uses a spell with damage x and mana cost y for z seconds, then he will deal x\xc2\xb7z damage and spend y\xc2\xb7z mana (no rounding). If there is no mana left (mana amount is set in the start of the game and it remains the same at the beginning of every fight), then character won\'t be able to use any spells. It is prohibited to use multiple spells simultaneously.Also Vova can fight monsters. Every monster is characterized by two values tj and hj \xe2\x80\x94 monster kills Vova\'s character in tj seconds and has hj health points. Mana refills after every fight (or Vova\'s character revives with full mana reserve), so previous fights have no influence on further ones.Vova\'s character kills a monster, if he deals hj damage to it in no more than tj seconds using his spells (it is allowed to use more than one spell in a fight) and spending no more mana than he had at the beginning of the fight. If monster\'s health becomes zero exactly in tj seconds (it means that the monster and Vova\'s character kill each other at the same time), then Vova wins the fight.You have to write a program which can answer two types of queries:  1 x y \xe2\x80\x94 Vova\'s character learns new spell which deals x damage per second and costs y mana per second.  2 t h \xe2\x80\x94 Vova fights the monster which kills his character in t seconds and has h health points. Note that queries are given in a different form. Also remember that Vova\'s character knows no spells at the beginning of the game.For every query of second type you have to determine if Vova is able to win the fight with corresponding monster." 3100

792E "Colored Balls" "greedy,math,number theory" "There are n boxes with colored balls on the table. Colors are numbered from 1 to n. i-th box contains ai balls, all of which have color i. You have to write a program that will divide all balls into sets such that:  each ball belongs to exactly one of the sets,  there are no empty sets,  there is no set containing two (or more) balls of different colors (each set contains only balls of one color),  there are no two sets such that the difference between their sizes is greater than 1. Print the minimum possible number of sets." 2500

792D "Paths in a Complete Binary Tree" bitmasks,trees "T is a complete binary tree consisting of n vertices. It means that exactly one vertex is a root, and each vertex is either a leaf (and doesn\'t have children) or an inner node (and has exactly two children). All leaves of a complete binary tree have the same depth (distance from the root). So n is a number such that n\xe2\x80\x89+\xe2\x80\x891 is a power of 2.In the picture you can see a complete binary tree with n\xe2\x80\x89=\xe2\x80\x8915.  Vertices are numbered from 1 to n in a special recursive way: we recursively assign numbers to all vertices from the left subtree (if current vertex is not a leaf), then assign a number to the current vertex, and then recursively assign numbers to all vertices from the right subtree (if it exists). In the picture vertices are numbered exactly using this algorithm. It is clear that for each size of a complete binary tree exists exactly one way to give numbers to all vertices. This way of numbering is called symmetric.You have to write a program that for given n answers q queries to the tree.Each query consists of an integer number ui (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ui\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and a string si, where ui is the number of vertex, and si represents the path starting from this vertex. String si doesn\'t contain any characters other than \'L\', \'R\' and \'U\', which mean traverse to the left child, to the right child and to the parent, respectively. Characters from si have to be processed from left to right, considering that ui is the vertex where the path starts. If it\'s impossible to process a character (for example, to go to the left child of a leaf), then you have to skip it. The answer is the number of vertex where the path represented by si ends.For example, if ui\xe2\x80\x89=\xe2\x80\x894 and si\xe2\x80\x89=\xe2\x80\x89\xc2\xabUURL\xc2\xbb, then the answer is 10." 1900

792C "Divide by Three" "dp,greedy,math,number theory" "A positive integer number n is written on a blackboard. It consists of not more than 105 digits. You have to transform it into a beautiful number by erasing some of the digits, and you want to erase as few digits as possible.The number is called beautiful if it consists of at least one digit, doesn\'t have leading zeroes and is a multiple of 3. For example, 0, 99, 10110 are beautiful numbers, and 00, 03, 122 are not.Write a program which for the given n will find a beautiful number such that n can be transformed into this number by erasing as few digits as possible. You can erase an arbitraty set of digits. For example, they don\'t have to go one after another in the number n.If it\'s impossible to obtain a beautiful number, print -1. If there are multiple answers, print any of them." 2000

792B "Counting-out Rhyme" implementation "n children are standing in a circle and playing the counting-out game. Children are numbered clockwise from 1 to n. In the beginning, the first child is considered the leader. The game is played in k steps. In the i-th step the leader counts out ai people in clockwise order, starting from the next person. The last one to be pointed at by the leader is eliminated, and the next player after him becomes the new leader.For example, if there are children with numbers [8,\xe2\x80\x8910,\xe2\x80\x8913,\xe2\x80\x8914,\xe2\x80\x8916] currently in the circle, the leader is child 13 and ai\xe2\x80\x89=\xe2\x80\x8912, then counting-out rhyme ends on child 16, who is eliminated. Child 8 becomes the leader.You have to write a program which prints the number of the child to be eliminated on every step." 1300

792A "New Bus Route" implementation,sortings "There are n cities situated along the main road of Berland. Cities are represented by their coordinates \xe2\x80\x94 integer numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. All coordinates are pairwise distinct.It is possible to get from one city to another only by bus. But all buses and roads are very old, so the Minister of Transport decided to build a new bus route. The Minister doesn\'t want to spend large amounts of money \xe2\x80\x94 he wants to choose two cities in such a way that the distance between them is minimal possible. The distance between two cities is equal to the absolute value of the difference between their coordinates.It is possible that there are multiple pairs of cities with minimal possible distance, so the Minister wants to know the quantity of such pairs. Your task is to write a program that will calculate the minimal possible distance between two pairs of cities and the quantity of pairs which have this distance." 1100

791A "Bear and Big Brother" implementation "Bear Limak wants to become the largest of bears, or at least to become larger than his brother Bob.Right now, Limak and Bob weigh a and b respectively. It\'s guaranteed that Limak\'s weight is smaller than or equal to his brother\'s weight.Limak eats a lot and his weight is tripled after every year, while Bob\'s weight is doubled after every year.After how many full years will Limak become strictly larger (strictly heavier) than Bob?" 800

789B "Masha and geometric depression" "brute force,implementation,math" "Masha really loves algebra. On the last lesson, her strict teacher Dvastan gave she new exercise.You are given geometric progression b defined by two integers b1 and q. Remind that a geometric progression is a sequence of integers b1,\xe2\x80\x89b2,\xe2\x80\x89b3,\xe2\x80\x89..., where for each i\xe2\x80\x89>\xe2\x80\x891 the respective term satisfies the condition bi\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x891\xc2\xb7q, where q is called the common ratio of the progression. Progressions in Uzhlyandia are unusual: both b1 and q can equal 0. Also, Dvastan gave Masha m ""bad"" integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am, and an integer l.Masha writes all progression terms one by one onto the board (including repetitive) while condition |bi|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l is satisfied (|x| means absolute value of x). There is an exception: if a term equals one of the ""bad"" integers, Masha skips it (doesn\'t write onto the board) and moves forward to the next term.But the lesson is going to end soon, so Masha has to calculate how many integers will be written on the board. In order not to get into depression, Masha asked you for help: help her calculate how many numbers she will write, or print ""inf"" in case she needs to write infinitely many integers." 1700

789A "Anastasia and pebbles" implementation,math "Anastasia loves going for a walk in Central Uzhlyandian Park. But she became uninterested in simple walking, so she began to collect Uzhlyandian pebbles. At first, she decided to collect all the pebbles she could find in the park.She has only two pockets. She can put at most k pebbles in each pocket at the same time. There are n different pebble types in the park, and there are wi pebbles of the i-th type. Anastasia is very responsible, so she never mixes pebbles of different types in same pocket. However, she can put different kinds of pebbles in different pockets at the same time. Unfortunately, she can\'t spend all her time collecting pebbles, so she can collect pebbles from the park only once a day.Help her to find the minimum number of days needed to collect all the pebbles of Uzhlyandian Central Park, taking into consideration that Anastasia can\'t place pebbles of different types in same pocket." 1100

788E "New task" "data structures" "On the 228-th international Uzhlyandian Wars strategic game tournament teams from each country are called. The teams should consist of 5 participants.The team of Uzhlyandia will consist of soldiers, because there are no gamers.Masha is a new minister of defense and gaming. The prime duty of the minister is to calculate the efficiency of the Uzhlandian army. The army consists of n soldiers standing in a row, enumerated from 1 to n. For each soldier we know his skill in Uzhlyandian Wars: the i-th soldier\'s skill is ai.It was decided that the team will consist of three players and two assistants. The skills of players should be same, and the assistants\' skills should not be greater than the players\' skill. Moreover, it is important for Masha that one of the assistants should stand in the row to the left of the players, and the other one should stand in the row to the right of the players. Formally, a team is five soldiers with indexes i, j, k, l, p, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj\xe2\x80\x89=\xe2\x80\x89ak\xe2\x80\x89=\xe2\x80\x89al\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89ap. The efficiency of the army is the number of different teams Masha can choose. Two teams are considered different if there is such i such that the i-th soldier is a member of one team, but not a member of the other team.Initially, all players are able to be players. For some reasons, sometimes some soldiers become unable to be players. Sometimes some soldiers, that were unable to be players, become able to be players. At any time any soldier is able to be an assistant. Masha wants to control the efficiency of the army, so she asked you to tell her the number of different possible teams modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897) after each change." 2900

788D "Finding lines" "constructive algorithms,divide and conquer,interactive" "After some programming contest Roma decided to try himself in tourism. His home country Uzhlyandia is a Cartesian plane. He wants to walk along each of the Main Straight Lines in Uzhlyandia. It is known that each of these lines is a straight line parallel to one of the axes (i.e. it is described with the equation x\xe2\x80\x89=\xe2\x80\x89a or y\xe2\x80\x89=\xe2\x80\x89a, where a is integer called the coordinate of this line).Roma lost his own map, so he should find out the coordinates of all lines at first. Uncle Anton agreed to help him, using the following rules:   Initially Roma doesn\'t know the number of vertical and horizontal lines and their coordinates;  Roma can announce integer coordinates of some point in Uzhlandia, and Anton then will tell him the minimum among the distances from the chosen point to each of the lines. However, since the coordinates of the lines don\'t exceed 108 by absolute value, Roma can\'t choose a point with coordinates exceeding 108 by absolute value. Uncle Anton is in a hurry to the UOI (Uzhlandian Olympiad in Informatics), so he can only answer no more than 3\xc2\xb7105 questions.The problem is that Roma doesn\'t know how to find out the coordinates of the lines. Write a program that plays Roma\'s role and finds the coordinates." 3000

788C "The Great Mixing" "dfs and similar,graphs,shortest paths" "Sasha and Kolya decided to get drunk with Coke, again. This time they have k types of Coke. i-th type is characterised by its carbon dioxide concentration . Today, on the party in honour of Sergiy of Vancouver they decided to prepare a glass of Coke with carbon dioxide concentration . The drink should also be tasty, so the glass can contain only integer number of liters of each Coke type (some types can be not presented in the glass). Also, they want to minimize the total volume of Coke in the glass.Carbon dioxide concentration is defined as the volume of carbone dioxide in the Coke divided by the total volume of Coke. When you mix two Cokes, the volume of carbon dioxide sums up, and the total volume of Coke sums up as well.Help them, find the minimal natural number of liters needed to create a glass with carbon dioxide concentration . Assume that the friends have unlimited amount of each Coke type." 2300

788B "Weird journey" "combinatorics,constructive algorithms,dfs and similar,dsu,graphs" "Little boy Igor wants to become a traveller. At first, he decided to visit all the cities of his motherland�\xe2\x80\x94 Uzhlyandia.It is widely known that Uzhlyandia has n cities connected with m bidirectional roads. Also, there are no two roads in the country that connect the same pair of cities, but roads starting and ending in the same city can exist. Igor wants to plan his journey beforehand. Boy thinks a path is good if the path goes over m\xe2\x80\x89-\xe2\x80\x892 roads twice, and over the other 2 exactly once. The good path can start and finish in any city of Uzhlyandia.Now he wants to know how many different good paths are in Uzhlyandia. Two paths are considered different if the sets of roads the paths goes over exactly once differ. Help Igor�\xe2\x80\x94 calculate the number of good paths." 2100

788A "Functions again" "dp,two pointers" "Something happened in Uzhlyandia again... There are riots on the streets... Famous Uzhlyandian superheroes Shean the Sheep and Stas the Giraffe were called in order to save the situation. Upon the arriving, they found that citizens are worried about maximum values of the Main Uzhlyandian Function f, which is defined as follows:In the above formula, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n must hold, where n is the size of the Main Uzhlyandian Array a, and |x| means absolute value of x. But the heroes skipped their math lessons in school, so they asked you for help. Help them calculate the maximum value of f among all possible values of l and r for the given array a." 1600

787B "Not Afraid" greedy,implementation,math "Since the giant heads have appeared in the sky all humanity is in danger, so all Ricks and Mortys from all parallel universes are gathering in groups to find a solution to get rid of them. There are n parallel universes participating in this event (n Ricks and n Mortys). I. e. each of n universes has one Rick and one Morty. They\'re gathering in m groups. Each person can be in many groups and a group can contain an arbitrary number of members.Ricks and Mortys have registered online in these groups. So, a person can have joined a group more than once (developer of this website hadn\'t considered this possibility).  Summer from universe #1 knows that in each parallel universe (including hers) exactly one of Rick and Morty from that universe is a traitor and is loyal, but no one knows which one. She knows that we are doomed if there\'s a group such that every member in that group is a traitor (they will plan and destroy the world). Summer knows that if there\'s a possibility that world ends (there\'s a group where all members are traitors) she should immediately cancel this event. So she wants to know if she should cancel the event. You have to tell her yes if and only if there\'s at least one scenario (among all 2n possible scenarios, 2 possible scenarios for who a traitor in each universe) such that in that scenario the world will end." 1300

787A "The Monster" "brute force,math,number theory" "A monster is chasing after Rick and Morty on another planet. They\'re so frightened that sometimes they scream. More accurately, Rick screams at times b,\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x89a,\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x892a,\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x893a,\xe2\x80\x89... and Morty screams at times d,\xe2\x80\x89d\xe2\x80\x89+\xe2\x80\x89c,\xe2\x80\x89d\xe2\x80\x89+\xe2\x80\x892c,\xe2\x80\x89d\xe2\x80\x89+\xe2\x80\x893c,\xe2\x80\x89....   The Monster will catch them if at any point they scream at the same time, so it wants to know when it will catch them (the first time they scream at the same time) or that they will never scream at the same time." 1200

786E ALT "data structures,flows,graphs,trees" "ALT is a planet in a galaxy called ""Encore"". Humans rule this planet but for some reason there\'s no dog in their planet, so the people there are sad and depressed. Rick and Morty are universal philanthropists and they want to make people in ALT happy. ALT has n cities numbered from 1 to n and n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads numbered from 1 to n\xe2\x80\x89-\xe2\x80\x891. One can go from any city to any other city using these roads.There are two types of people in ALT:  Guardians. A guardian lives in a house alongside a road and guards the road.  Citizens. A citizen lives in a house inside a city and works in an office in another city. Every person on ALT is either a guardian or a citizen and there\'s exactly one guardian alongside each road.   Rick and Morty talked to all the people in ALT, and here\'s what they got:  There are m citizens living in ALT.  Citizen number i lives in city number xi and works in city number yi.  Every day each citizen will go through all roads along the shortest path from his home to his work.  A citizen will be happy if and only if either he himself has a puppy himself or all of guardians along his path to his work has a puppy (he sees the guardian\'s puppy in each road and will be happy).  A guardian is always happy. You need to tell Rick and Morty the minimum number of puppies they need in order to make all people in ALT happy, and also provide an optimal way to distribute these puppies." 3200

786D "Rap God" "data structures,dfs and similar,hashing,strings,trees" "Rick is in love with Unity. But Mr. Meeseeks also love Unity, so Rick and Mr. Meeseeks are ""love rivals"". Unity loves rap, so it decided that they have to compete in a rap game (battle) in order to choose the best. Rick is too nerds, so instead he\'s gonna make his verse with running his original algorithm on lyrics ""Rap God"" song.  His algorithm is a little bit complicated. He\'s made a tree with n vertices numbered from 1 to n and there\'s a lowercase english letter written on each edge. He denotes str(a,\xe2\x80\x89b) to be the string made by writing characters on edges on the shortest path from a to b one by one (a string of length equal to distance of a to b). Note that str(a,\xe2\x80\x89b) is reverse of str(b,\xe2\x80\x89a) and str(a,\xe2\x80\x89a) is empty. In order to make the best verse he can, he needs to answer some queries, but he\'s not a computer scientist and is not able to answer those queries, so he asked you to help him. Each query is characterized by two vertices x and y (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y). Answer to this query is the number of vertices like z such that z\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x,\xe2\x80\x89z\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y and str(x,\xe2\x80\x89y) is lexicographically larger than str(x,\xe2\x80\x89z).String x\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89x1x2...x|x| is lexicographically larger than string y\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y1y2...y|y|, if either |x|\xe2\x80\x89\xe2\x80\x89>\xe2\x80\x89\xe2\x80\x89|y| and x1\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y1,\xe2\x80\x89\xe2\x80\x89x2\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89x|y|\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y|y|, or exists such number r (r\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89|x|,\xe2\x80\x89\xe2\x80\x89r\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89|y|), that x1\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y1,\xe2\x80\x89\xe2\x80\x89x2\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89xr\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89yr and xr\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891\xe2\x80\x89\xe2\x80\x89>\xe2\x80\x89\xe2\x80\x89yr\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891. Characters are compared like their ASCII codes (or alphabetic order).Help Rick get the girl (or whatever gender Unity has)." 3400

786C "Till I Collapse" "data structures,divide and conquer" "Rick and Morty want to find MR. PBH and they can\'t do it alone. So they need of Mr. Meeseeks. They Have generated n Mr. Meeseeks, standing in a line numbered from 1 to n. Each of them has his own color. i-th Mr. Meeseeks\' color is ai. Rick and Morty are gathering their army and they want to divide Mr. Meeseeks into some squads. They don\'t want their squads to be too colorful, so each squad should have Mr. Meeseeks of at most k different colors. Also each squad should be a continuous subarray of Mr. Meeseeks in the line. Meaning that for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89e\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, if Mr. Meeseeks number i and Mr. Meeseeks number j are in the same squad then Mr. Meeseeks number e should be in that same squad.  Also, each squad needs its own presidio, and building a presidio needs money, so they want the total number of squads to be minimized.Rick and Morty haven\'t finalized the exact value of k, so in order to choose it, for each k between 1 and n (inclusive) need to know the minimum number of presidios needed." 2400

786B Legacy "data structures,graphs,shortest paths" "Rick and his co-workers have made a new radioactive formula and a lot of bad guys are after them. So Rick wants to give his legacy to Morty before bad guys catch them. There are n planets in their universe numbered from 1 to n. Rick is in planet number s (the earth) and he doesn\'t know where Morty is. As we all know, Rick owns a portal gun. With this gun he can open one-way portal from a planet he is in to any other planet (including that planet). But there are limits on this gun because he\'s still using its free trial.  By default he can not open any portal by this gun. There are q plans in the website that sells these guns. Every time you purchase a plan you can only use it once but you can purchase it again if you want to use it more.Plans on the website have three types:  With a plan of this type you can open a portal from planet v to planet u.  With a plan of this type you can open a portal from planet v to any planet with index in range [l,\xe2\x80\x89r].  With a plan of this type you can open a portal from any planet with index in range [l,\xe2\x80\x89r] to planet v. Rick doesn\'t known where Morty is, but Unity is going to inform him and he wants to be prepared for when he finds and start his journey immediately. So for each planet (including earth itself) he wants to know the minimum amount of money he needs to get from earth to that planet." 2300

786A Berzerk "dfs and similar,dp,games" "Rick and Morty are playing their own version of Berzerk (which has nothing in common with the famous Berzerk game). This game needs a huge space, so they play it with a computer.In this game there are n objects numbered from 1 to n arranged in a circle (in clockwise order). Object number 1 is a black hole and the others are planets. There\'s a monster in one of the planet. Rick and Morty don\'t know on which one yet, only that he\'s not initially in the black hole, but Unity will inform them before the game starts. But for now, they want to be prepared for every possible scenario.  Each one of them has a set of numbers between 1 and n\xe2\x80\x89-\xe2\x80\x891 (inclusive). Rick\'s set is s1 with k1 elements and Morty\'s is s2 with k2 elements. One of them goes first and the player changes alternatively. In each player\'s turn, he should choose an arbitrary number like x from his set and the monster will move to his x-th next object from its current position (clockwise). If after his move the monster gets to the black hole he wins.Your task is that for each of monster\'s initial positions and who plays first determine if the starter wins, loses, or the game will stuck in an infinite loop. In case when player can lose or make game infinity, it more profitable to choose infinity game." 2000

785E "Anton and Permutation" "brute force,data structures" "Anton likes permutations, especially he likes to permute their elements. Note that a permutation of n elements is a sequence of numbers {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an}, in which every number from 1 to n appears exactly once.One day Anton got a new permutation and started to play with it. He does the following operation q times: he takes two elements of the permutation and swaps these elements. After each operation he asks his friend Vanya, how many inversions there are in the new permutation. The number of inversions in a permutation is the number of distinct pairs (i,\xe2\x80\x89j) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and ai\xe2\x80\x89>\xe2\x80\x89aj.Vanya is tired of answering Anton\'s silly questions. So he asked you to write a program that would answer these questions instead of him.Initially Anton\'s permutation was {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n}, that is ai\xe2\x80\x89=\xe2\x80\x89i for all i such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 2200

785D "Anton and School - 2" "combinatorics,dp,math,number theory" "As you probably know, Anton goes to school. One of the school subjects that Anton studies is Bracketology. On the Bracketology lessons students usually learn different sequences that consist of round brackets (characters ""("" and "")"" (without quotes)).On the last lesson Anton learned about the regular simple bracket sequences (RSBS). A bracket sequence s of length n is an RSBS if the following conditions are met:  It is not empty (that is n\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890).  The length of the sequence is even.  First  charactes of the sequence are equal to ""("".  Last  charactes of the sequence are equal to "")"". For example, the sequence ""((()))"" is an RSBS but the sequences ""((())"" and ""(()())"" are not RSBS.Elena Ivanovna, Anton\'s teacher, gave him the following task as a homework. Given a bracket sequence s. Find the number of its distinct subsequences such that they are RSBS. Note that a subsequence of s is a string that can be obtained from s by deleting some of its elements. Two subsequences are considered distinct if distinct sets of positions are deleted.Because the answer can be very big and Anton\'s teacher doesn\'t like big numbers, she asks Anton to find the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Anton thought of this task for a very long time, but he still doesn\'t know how to solve it. Help Anton to solve this task and write a program that finds the answer for it!" 2300

785C "Anton and Fairy Tale" "binary search,math" "Anton likes to listen to fairy tales, especially when Danik, Anton\'s best friend, tells them. Right now Danik tells Anton a fairy tale:""Once upon a time, there lived an emperor. He was very rich and had much grain. One day he ordered to build a huge barn to put there all his grain. Best builders were building that barn for three days and three nights. But they overlooked and there remained a little hole in the barn, from which every day sparrows came through. Here flew a sparrow, took a grain and flew away...""More formally, the following takes place in the fairy tale. At the beginning of the first day the barn with the capacity of n grains was full. Then, every day (starting with the first day) the following happens:  m grains are brought to the barn. If m grains doesn\'t fit to the barn, the barn becomes full and the grains that doesn\'t fit are brought back (in this problem we can assume that the grains that doesn\'t fit to the barn are not taken into account).  Sparrows come and eat grain. In the i-th day i sparrows come, that is on the first day one sparrow come, on the second day two sparrows come and so on. Every sparrow eats one grain. If the barn is empty, a sparrow eats nothing. Anton is tired of listening how Danik describes every sparrow that eats grain from the barn. Anton doesn\'t know when the fairy tale ends, so he asked you to determine, by the end of which day the barn will become empty for the first time. Help Anton and write a program that will determine the number of that day!" 1600

785B "Anton and Classes" greedy,sortings "Anton likes to play chess. Also he likes to do programming. No wonder that he decided to attend chess classes and programming classes.Anton has n variants when he will attend chess classes, i-th variant is given by a period of time (l1,\xe2\x80\x89i,\xe2\x80\x89r1,\xe2\x80\x89i). Also he has m variants when he will attend programming classes, i-th variant is given by a period of time (l2,\xe2\x80\x89i,\xe2\x80\x89r2,\xe2\x80\x89i).Anton needs to choose exactly one of n possible periods of time when he will attend chess classes and exactly one of m possible periods of time when he will attend programming classes. He wants to have a rest between classes, so from all the possible pairs of the periods he wants to choose the one where the distance between the periods is maximal.The distance between periods (l1,\xe2\x80\x89r1) and (l2,\xe2\x80\x89r2) is the minimal possible distance between a point in the first period and a point in the second period, that is the minimal possible |i\xe2\x80\x89-\xe2\x80\x89j|, where l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1 and l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2. In particular, when the periods intersect, the distance between them is 0.Anton wants to know how much time his rest between the classes will last in the best case. Help Anton and find this number!" 1100

785A "Anton and Polyhedrons" implementation,strings "Anton\'s favourite geometric figures are regular polyhedrons. Note that there are five kinds of regular polyhedrons:   Tetrahedron. Tetrahedron has 4 triangular faces.  Cube. Cube has 6 square faces.  Octahedron. Octahedron has 8 triangular faces.  Dodecahedron. Dodecahedron has 12 pentagonal faces.  Icosahedron. Icosahedron has 20 triangular faces. All five kinds of polyhedrons are shown on the picture below:  Anton has a collection of n polyhedrons. One day he decided to know, how many faces his polyhedrons have in total. Help Anton and find this number!" 800

784G "BF Calculator" "*special problem" "In this problem you will write a simple generator of Brainfuck (https://en.wikipedia.org/wiki/Brainfuck) calculators.You are given an arithmetic expression consisting of integers from 0 to 255 and addition/subtraction signs between them. Output a Brainfuck program which, when executed, will print the result of evaluating this expression.We use a fairly standard Brainfuck interpreter for checking the programs: 30000 memory cells. memory cells store integers from 0 to 255 with unsigned 8-bit wraparound. console input (, command) is not supported, but it\'s not needed for this problem." 2000

784F "Crunching Numbers Just for You" "*special problem,implementation" "You are developing a new feature for the website which sells airline tickets: being able to sort tickets by price! You have already extracted the tickets\' prices, so there\'s just the last step to be done...You are given an array of integers. Sort it in non-descending order." 1900

784E "Twisted Circuit" "*special problem,brute force,implementation"  2000

784D "Touchy-Feely Palindromes" "*special problem,implementation" "InputThe only line of the input contains a string of digits. The length of the string is between 1 and 10, inclusive.OutputOutput ""Yes"" or ""No"".ExamplesInputCopy373OutputCopyYesInputCopy121OutputCopyNoInputCopy436OutputCopyYes" 1900

784C INTERCALC "*special problem,implementation" "DO YOU EXPECT ME TO FIND THIS OUT?WHAT BASE AND/XOR LANGUAGE INCLUDES string?DON\'T BYTE OF MORE THAN YOU CAN CHEWYOU CAN ONLY DISTORT THE LARGEST OF MATHEMATICS SO FARSAYING ""ABRACADABRA"" WITHOUT A MAGIC AND WON\'T DO YOU ANY GOODTHE LAST STACK RUPTURES. ALL DIE. OH, THE EMBARRASSMENT!I HAVE NO ARRAY AND I MUST SCREAMELEMENTS MAY NOT BE STORED IN WEST HYPERSPACE" 1800

784B "Kids\' Riddle" "*special problem" "DO YOU EXPECT ME TO FIND THIS OUT?WHAT BASE AND/XOR LANGUAGE INCLUDES string?DON\'T BYTE OF MORE THAN YOU CAN CHEWYOU CAN ONLY DISTORT THE LARGEST OF MATHEMATICS SO FARSAYING ""ABRACADABRA"" WITHOUT A MAGIC AND WON\'T DO YOU ANY GOODTHE LAST STACK RUPTURES. ALL DIE. OH, THE EMBARRASSMENT!I HAVE NO ARRAY AND I MUST SCREAMELEMENTS MAY NOT BE STORED IN WEST HYPERSPACE" 2000

784A "Numbers Joke" "*special problem" "InputThe input contains a single integer a (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8930).OutputOutput a single integer.ExampleInputCopy3OutputCopy27" 1700

780H "Intranet of Buses" "binary search,geometry,implementation,two pointers" "A new bus route is opened in the city . The route is a closed polygon line in the place, with all segments parallel to one of the axes. m buses will operate on the route. All buses move in a loop along the route in the same direction with equal constant velocities (stopping times are negligible in this problem).Buses start their movement in the first vertex of the route with equal interval. Suppose that T is the total time for a single bus to travel the whole loop of the route. Then, the bus 1 starts moving at time 0, the bus 2 starts at time T\xe2\x80\x89/\xe2\x80\x89m, the bus 3 starts at time 2T\xe2\x80\x89/\xe2\x80\x89m, and so on; finally, the bus m starts moving at time (m\xe2\x80\x89-\xe2\x80\x891)T\xe2\x80\x89/\xe2\x80\x89m. Thus, all intervals between pairs of consecutive buses (including the interval between the last and the first bus) are equal.Buses can communicate with each other via wireless transmitters of equal power. If the transmitters have power D, then only buses within distance D of each other can communicate.The buses are also equipped with a distributed system of schedule tracking. For all buses to stick to the schedule, the system has to synchronize the necessary data between all buses from time to time. At the moment of synchronization, the bus 1 communicates with the bus 2, the bus 2�\xe2\x80\x94 with bus 3, and so on; also, the bus m communicates with the bus 1.As a research employee, you are tasked with finding the smallest value of D such that it is possible to find a time moment to perform synchronization once all buses have started moving." 3100

780G "Andryusha and Nervous Barriers" "data structures,dp" "Andryusha has found a perplexing arcade machine. The machine is a vertically adjusted board divided into square cells. The board has w columns numbered from 1 to w from left to right, and h rows numbered from 1 to h from the bottom to the top.Further, there are barriers in some of board rows. There are n barriers in total, and i-th of them occupied the cells li through ri of the row ui. Andryusha recollects well that no two barriers share the same row. Furthermore, no row is completely occupied with a barrier, that is, at least one cell in each row is free.The player can throw a marble to any column of the machine from above. A marble falls downwards until it encounters a barrier, or falls through the bottom of the board. A marble disappears once it encounters a barrier but is replaced by two more marbles immediately to the left and to the right of the same barrier. In a situation when the barrier is at an edge of the board, both marbles appear next to the barrier at the side opposite to the edge. More than one marble can occupy the same place of the board, without obstructing each other\'s movement. Ultimately, all marbles are bound to fall from the bottom of the machine.  Examples of marble-barrier interaction. Peculiarly, sometimes marbles can go through barriers as if they were free cells. That is so because the barriers are in fact alive, and frightened when a marble was coming at them from a very high altitude. More specifically, if a marble falls towards the barrier i from relative height more than si (that is, it started its fall strictly higher than ui\xe2\x80\x89+\xe2\x80\x89si), then the barrier evades the marble. If a marble is thrown from the top of the board, it is considered to appear at height (h\xe2\x80\x89+\xe2\x80\x891).Andryusha remembers to have thrown a marble once in each of the columns. Help him find the total number of marbles that came down at the bottom of the machine. Since the answer may be large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2700

780F "Axel and Marston in Bitland" bitmasks,dp,graphs,matrices "A couple of friends, Axel and Marston are travelling across the country of Bitland. There are n towns in Bitland, with some pairs of towns connected by one-directional roads. Each road in Bitland is either a pedestrian road or a bike road. There can be multiple roads between any pair of towns, and may even be a road from a town to itself. However, no pair of roads shares the starting and the destination towns along with their types simultaneously.The friends are now located in the town 1 and are planning the travel route. Axel enjoys walking, while Marston prefers biking. In order to choose a route diverse and equally interesting for both friends, they have agreed upon the following procedure for choosing the road types during the travel: The route starts with a pedestrian route. Suppose that a beginning of the route is written in a string s of letters P (pedestrain road) and B (biking road). Then, the string  is appended to s, where  stands for the string s with each character changed to opposite (that is, all pedestrian roads changed to bike roads, and vice versa).In the first few steps the route will look as follows: P, PB, PBBP, PBBPBPPB, PBBPBPPBBPPBPBBP, and so on.After that the friends start travelling from the town 1 via Bitlandian roads, choosing the next road according to the next character of their route type each time. If it is impossible to choose the next road, the friends terminate their travel and fly home instead.Help the friends to find the longest possible route that can be travelled along roads of Bitland according to the road types choosing procedure described above. If there is such a route with more than 1018 roads in it, print -1 instead." 2400

780E "Underground Lab" "constructive algorithms,dfs and similar,graphs" "The evil Bumbershoot corporation produces clones for gruesome experiments in a vast underground lab. On one occasion, the corp cloned a boy Andryusha who was smarter than his comrades. Immediately Andryusha understood that something fishy was going on there. He rallied fellow clones to go on a feud against the evil corp, and they set out to find an exit from the lab. The corp had to reduce to destroy the lab complex.The lab can be pictured as a connected graph with n vertices and m edges. k clones of Andryusha start looking for an exit in some of the vertices. Each clone can traverse any edge once per second. Any number of clones are allowed to be at any vertex simultaneously. Each clone is allowed to stop looking at any time moment, but he must look at his starting vertex at least. The exit can be located at any vertex of the lab, hence each vertex must be visited by at least one clone.Each clone can visit at most  vertices before the lab explodes.Your task is to choose starting vertices and searching routes for the clones. Each route can have at most  vertices." 2100

780D "Innokenty and a Football League" "2-sat,graphs,greedy,implementation,shortest paths,strings" "Innokenty is a president of a new football league in Byteland. The first task he should do is to assign short names to all clubs to be shown on TV next to the score. Of course, the short names should be distinct, and Innokenty wants that all short names consist of three letters.Each club\'s full name consist of two words: the team\'s name and the hometown\'s name, for example, ""DINAMO BYTECITY"". Innokenty doesn\'t want to assign strange short names, so he wants to choose such short names for each club that:   the short name is the same as three first letters of the team\'s name, for example, for the mentioned club it is ""DIN"",  or, the first two letters of the short name should be the same as the first two letters of the team\'s name, while the third letter is the same as the first letter in the hometown\'s name. For the mentioned club it is ""DIB"". Apart from this, there is a rule that if for some club x the second option of short name is chosen, then there should be no club, for which the first option is chosen which is the same as the first option for the club x. For example, if the above mentioned club has short name ""DIB"", then no club for which the first option is chosen can have short name equal to ""DIN"". However, it is possible that some club have short name ""DIN"", where ""DI"" are the first two letters of the team\'s name, and ""N"" is the first letter of hometown\'s name. Of course, no two teams can have the same short name.Help Innokenty to choose a short name for each of the teams. If this is impossible, report that. If there are multiple answer, any of them will suit Innokenty. If for some team the two options of short name are equal, then Innokenty will formally think that only one of these options is chosen." 1900

780C "Andryusha and Colored Balloons" "dfs and similar,graphs,greedy,trees" "Andryusha goes through a park each day. The squares and paths between them look boring to Andryusha, so he decided to decorate them.The park consists of n squares connected with (n\xe2\x80\x89-\xe2\x80\x891) bidirectional paths in such a way that any square is reachable from any other using these paths. Andryusha decided to hang a colored balloon at each of the squares. The baloons\' colors are described by positive integers, starting from 1. In order to make the park varicolored, Andryusha wants to choose the colors in a special way. More precisely, he wants to use such colors that if a, b and c are distinct squares that a and b have a direct path between them, and b and c have a direct path between them, then balloon colors on these three squares are distinct.Andryusha wants to use as little different colors as possible. Help him to choose the colors!" 1600

780B "The Meeting Place Cannot Be Changed" "binary search" "The main road in Bytecity is a straight line from south to north. Conveniently, there are coordinates measured in meters from the southernmost building in north direction.At some points on the road there are n friends, and i-th of them is standing at the point xi meters and can move with any speed no greater than vi meters per second in any of the two directions along the road: south or north.You are to compute the minimum time needed to gather all the n friends at some point on the road. Note that the point they meet at doesn\'t need to have integer coordinate." 1600

780A "Andryusha and Socks" implementation "Andryusha is an orderly boy and likes to keep things in their place.Today he faced a problem to put his socks in the wardrobe. He has n distinct pairs of socks which are initially in a bag. The pairs are numbered from 1 to n. Andryusha wants to put paired socks together and put them in the wardrobe. He takes the socks one by one from the bag, and for each sock he looks whether the pair of this sock has been already took out of the bag, or not. If not (that means the pair of this sock is still in the bag), he puts the current socks on the table in front of him. Otherwise, he puts both socks from the pair to the wardrobe.Andryusha remembers the order in which he took the socks from the bag. Can you tell him what is the maximum number of socks that were on the table at the same time?" 800

779C "Dishonest Sellers" "constructive algorithms,greedy,sortings" "Igor found out discounts in a shop and decided to buy n items. Discounts at the store will last for a week and Igor knows about each item that its price now is ai, and after a week of discounts its price will be bi.Not all of sellers are honest, so now some products could be more expensive than after a week of discounts.Igor decided that buy at least k of items now, but wait with the rest of the week in order to save money as much as possible. Your task is to determine the minimum money that Igor can spend to buy all n items." 1200

779B "Weird Rounding" "brute force,greedy" "Polycarp is crazy about round numbers. He especially likes the numbers divisible by 10k.In the given number of n Polycarp wants to remove the least number of digits to get a number that is divisible by 10k. For example, if k\xe2\x80\x89=\xe2\x80\x893, in the number 30020 it is enough to delete a single digit (2). In this case, the result is 3000 that is divisible by 103\xe2\x80\x89=\xe2\x80\x891000.Write a program that prints the minimum number of digits to be deleted from the given integer number n, so that the result is divisible by 10k. The result should not start with the unnecessary leading zero (i.e., zero can start only the number 0, which is required to be written as exactly one digit).It is guaranteed that the answer exists." 1100

779A "Pupils Redistribution" "constructive algorithms,math" "In Berland each high school student is characterized by academic performance \xe2\x80\x94 integer value between 1 and 5.In high school 0xFF there are two groups of pupils: the group A and the group B. Each group consists of exactly n students. An academic performance of each student is known \xe2\x80\x94 integer value between 1 and 5.The school director wants to redistribute students between groups so that each of the two groups has the same number of students whose academic performance is equal to 1, the same number of students whose academic performance is 2 and so on. In other words, the purpose of the school director is to change the composition of groups, so that for each value of academic performance the numbers of students in both groups are equal.To achieve this, there is a plan to produce a series of exchanges of students between groups. During the single exchange the director selects one student from the class A and one student of class B. After that, they both change their groups.Print the least number of exchanges, in order to achieve the desired equal numbers of students for each academic performance." 1000

778E "Selling Numbers" dp,sortings "Boris really likes numbers and even owns a small shop selling interesting numbers. He has n decimal numbers Bi. Cost of the number in his shop is equal to the sum of costs of its digits. You are given the values cd, where cd is the cost of the digit d. Of course, Boris is interested in that numbers he owns have the maximum cost possible.Recently Boris got hold of the magical artifact A, which can allow him to increase the cost of his collection. Artifact is a string, consisting of digits and \'?\' symbols. To use the artifact, Boris must replace all \'?\' with digits to get a decimal number without leading zeros (it is also not allowed to get number 0). After that, the resulting number is added to all numbers Bi in Boris\' collection. He uses the artifact exactly once.What is the maximum cost of the collection Boris can achieve after using the artifact?" 3000

778D "Parquet Re-laying" "constructive algorithms" "Peter decided to lay a parquet in the room of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, the parquet consists of tiles of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x892. When the workers laid the parquet, it became clear that the tiles pattern looks not like Peter likes, and workers will have to re-lay it.The workers decided that removing entire parquet and then laying it again is very difficult task, so they decided to make such an operation every hour: remove two tiles, which form a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, rotate them 90 degrees and put them back on the same place.  They have no idea how to obtain the desired configuration using these operations, and whether it is possible at all.Help Peter to make a plan for the workers or tell that it is impossible. The plan should contain at most 100\xe2\x80\x89000 commands." 2700

778C "Peterson Polyglot" "brute force,dfs and similar,dsu,hashing,strings,trees" "Peterson loves to learn new languages, but his favorite hobby is making new ones. Language is a set of words, and word is a sequence of lowercase Latin letters.Peterson makes new language every morning. It is difficult task to store the whole language, so Peterson have invented new data structure for storing his languages which is called broom. Broom is rooted tree with edges marked with letters. Initially broom is represented by the only vertex�\xe2\x80\x94 the root of the broom. When Peterson wants to add new word to the language he stands at the root and processes the letters of new word one by one. Consider that Peterson stands at the vertex u. If there is an edge from u marked with current letter, Peterson goes through this edge. Otherwise Peterson adds new edge from u to the new vertex v, marks it with the current letter and goes through the new edge. Size of broom is the number of vertices in it.In the evening after working day Peterson can\'t understand the language he made this morning. It is too difficult for bored Peterson and he tries to make it simpler. Simplification of the language is the process of erasing some letters from some words of this language. Formally, Peterson takes some positive integer p and erases p-th letter from all the words of this language having length at least p. Letters in words are indexed starting by 1. Peterson considers that simplification should change at least one word, i.e. there has to be at least one word of length at least p. Peterson tries to make his language as simple as possible, so he wants to choose p such that the size of the broom for his simplified language is as small as possible.Peterson is pretty annoyed with this task so he asks you for help. Write a program to find the smallest possible size of the broom and integer p." 2500

778B "Bitwise Formula" "bitmasks,brute force,dfs and similar,expression parsing,implementation" "Bob recently read about bitwise operations used in computers: AND, OR and XOR. He have studied their properties and invented a new game.Initially, Bob chooses integer m, bit depth of the game, which means that all numbers in the game will consist of m bits. Then he asks Peter to choose some m-bit number. After that, Bob computes the values of n variables. Each variable is assigned either a constant m-bit number or result of bitwise operation. Operands of the operation may be either variables defined before, or the number, chosen by Peter. After that, Peter\'s score equals to the sum of all variable values.Bob wants to know, what number Peter needs to choose to get the minimum possible score, and what number he needs to choose to get the maximum possible score. In both cases, if there are several ways to get the same score, find the minimum number, which he can choose." 1800

778A "String Game" "binary search,greedy,strings" "Little Nastya has a hobby, she likes to remove some letters from word, to obtain another word. But it turns out to be pretty hard for her, because she is too young. Therefore, her brother Sergey always helps her.Sergey gives Nastya the word t and wants to get the word p out of it. Nastya removes letters in a certain order (one after another, in this order strictly), which is specified by permutation of letters\' indices of the word t: a1... a|t|. We denote the length of word x as |x|. Note that after removing one letter, the indices of other letters don\'t change. For example, if t\xe2\x80\x89=\xe2\x80\x89""nastya"" and a\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x891,\xe2\x80\x895,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x896] then removals make the following sequence of words ""nastya""  ""nastya""  ""nastya""  ""nastya""  ""nastya""  ""nastya""  ""nastya"".Sergey knows this permutation. His goal is to stop his sister at some point and continue removing by himself to get the word p. Since Nastya likes this activity, Sergey wants to stop her as late as possible. Your task is to determine, how many letters Nastya can remove before she will be stopped by Sergey.It is guaranteed that the word p can be obtained by removing the letters from word t." 1700

777E "Hanoi Factory" "brute force,data structures,dp,greedy,sortings" "Of course you have heard the famous task about Hanoi Towers, but did you know that there is a special factory producing the rings for this wonderful game? Once upon a time, the ruler of the ancient Egypt ordered the workers of Hanoi Factory to create as high tower as possible. They were not ready to serve such a strange order so they had to create this new tower using already produced rings.There are n rings in factory\'s stock. The i-th ring has inner radius ai, outer radius bi and height hi. The goal is to select some subset of rings and arrange them such that the following conditions are satisfied:  Outer radiuses form a non-increasing sequence, i.e. one can put the j-th ring on the i-th ring only if bj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi.  Rings should not fall one into the the other. That means one can place ring j on the ring i only if bj\xe2\x80\x89>\xe2\x80\x89ai.  The total height of all rings used should be maximum possible." 2000

777D "Cloud of Hashtags" "binary search,greedy,implementation,strings" "Vasya is an administrator of a public page of organization ""Mouse and keyboard"" and his everyday duty is to publish news from the world of competitive programming. For each news he also creates a list of hashtags to make searching for a particular topic more comfortable. For the purpose of this problem we define hashtag as a string consisting of lowercase English letters and exactly one symbol \'#\' located at the beginning of the string. The length of the hashtag is defined as the number of symbols in it without the symbol \'#\'.The head administrator of the page told Vasya that hashtags should go in lexicographical order (take a look at the notes section for the definition).Vasya is lazy so he doesn\'t want to actually change the order of hashtags in already published news. Instead, he decided to delete some suffixes (consecutive characters at the end of the string) of some of the hashtags. He is allowed to delete any number of characters, even the whole string except for the symbol \'#\'. Vasya wants to pick such a way to delete suffixes that the total number of deleted symbols is minimum possible. If there are several optimal solutions, he is fine with any of them." 1800

777C "Alyona and Spreadsheet" "binary search,data structures,dp,greedy,implementation,two pointers" "During the lesson small girl Alyona works with one famous spreadsheet computer program and learns how to edit tables.Now she has a table filled with integers. The table consists of n rows and m columns. By ai,\xe2\x80\x89j we will denote the integer located at the i-th row and the j-th column. We say that the table is sorted in non-decreasing order in the column j if ai,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891.Teacher gave Alyona k tasks. For each of the tasks two integers l and r are given and Alyona has to answer the following question: if one keeps the rows from l to r inclusive and deletes all others, will the table be sorted in non-decreasing order in at least one column? Formally, does there exist such j that ai,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j for all i from l to r\xe2\x80\x89-\xe2\x80\x891 inclusive.Alyona is too small to deal with this task and asks you to help!" 1600

777B "Game of Credit Cards" "data structures,dp,greedy,sortings" "After the fourth season Sherlock and Moriary have realized the whole foolishness of the battle between them and decided to continue their competitions in peaceful game of Credit Cards.Rules of this game are simple: each player bring his favourite n-digit credit card. Then both players name the digits written on their cards one by one. If two digits are not equal, then the player, whose digit is smaller gets a flick (knock in the forehead usually made with a forefinger) from the other player. For example, if n\xe2\x80\x89=\xe2\x80\x893, Sherlock\'s card is 123 and Moriarty\'s card has number 321, first Sherlock names 1 and Moriarty names 3 so Sherlock gets a flick. Then they both digit 2 so no one gets a flick. Finally, Sherlock names 3, while Moriarty names 1 and gets a flick.Of course, Sherlock will play honestly naming digits one by one in the order they are given, while Moriary, as a true villain, plans to cheat. He is going to name his digits in some other order (however, he is not going to change the overall number of occurences of each digit). For example, in case above Moriarty could name 1, 2, 3 and get no flicks at all, or he can name 2, 3 and 1 to give Sherlock two flicks.Your goal is to find out the minimum possible number of flicks Moriarty will get (no one likes flicks) and the maximum possible number of flicks Sherlock can get from Moriarty. Note, that these two goals are different and the optimal result may be obtained by using different strategies." 1300

777A "Shell Game" "constructive algorithms,implementation,math" "Bomboslav likes to look out of the window in his room and watch lads outside playing famous shell game. The game is played by two persons: operator and player. Operator takes three similar opaque shells and places a ball beneath one of them. Then he shuffles the shells by swapping some pairs and the player has to guess the current position of the ball.Bomboslav noticed that guys are not very inventive, so the operator always swaps the left shell with the middle one during odd moves (first, third, fifth, etc.) and always swaps the middle shell with the right one during even moves (second, fourth, etc.).Let\'s number shells from 0 to 2 from left to right. Thus the left shell is assigned number 0, the middle shell is 1 and the right shell is 2. Bomboslav has missed the moment when the ball was placed beneath the shell, but he knows that exactly n movements were made by the operator and the ball was under shell x at the end. Now he wonders, what was the initial position of the ball?" 1000

776G "Sherlock and the Encrypted Data" bitmasks,combinatorics,dp "Sherlock found a piece of encrypted data which he thinks will be useful to catch Moriarty. The encrypted data consists of two integer l and r. He noticed that these integers were in hexadecimal form.He takes each of the integers from l to r, and performs the following operations: He lists the distinct digits present in the given number. For example: for 101416, he lists the digits as 1,\xe2\x80\x890,\xe2\x80\x894.  Then he sums respective powers of two for each digit listed in the step above. Like in the above example sum\xe2\x80\x89=\xe2\x80\x8921\xe2\x80\x89+\xe2\x80\x8920\xe2\x80\x89+\xe2\x80\x8924\xe2\x80\x89=\xe2\x80\x891910.  He changes the initial number by applying bitwise xor of the initial number and the sum. Example: . Note that xor is done in binary notation. One more example: for integer 1e the sum is sum\xe2\x80\x89=\xe2\x80\x8921\xe2\x80\x89+\xe2\x80\x89214. Letters a, b, c, d, e, f denote hexadecimal digits 10, 11, 12, 13, 14, 15, respertively.Sherlock wants to count the numbers in the range from l to r (both inclusive) which decrease on application of the above four steps. He wants you to answer his q queries for different l and r." 2900

776F "Sherlock\'s bet to Moriarty" "constructive algorithms,data structures,divide and conquer,geometry,graphs,implementation,trees" "Sherlock found a piece of encrypted data which he thinks will be useful to catch Moriarty. The encrypted data consists of two integer l and r. He noticed that these integers were in hexadecimal form.He takes each of the integers from l to r, and performs the following operations: He lists the distinct digits present in the given number. For example: for 101416, he lists the digits as 1,\xe2\x80\x890,\xe2\x80\x894.  Then he sums respective powers of two for each digit listed in the step above. Like in the above example sum\xe2\x80\x89=\xe2\x80\x8921\xe2\x80\x89+\xe2\x80\x8920\xe2\x80\x89+\xe2\x80\x8924\xe2\x80\x89=\xe2\x80\x891910.  He changes the initial number by applying bitwise xor of the initial number and the sum. Example: . Note that xor is done in binary notation. One more example: for integer 1e the sum is sum\xe2\x80\x89=\xe2\x80\x8921\xe2\x80\x89+\xe2\x80\x89214. Letters a, b, c, d, e, f denote hexadecimal digits 10, 11, 12, 13, 14, 15, respertively.Sherlock wants to count the numbers in the range from l to r (both inclusive) which decrease on application of the above four steps. He wants you to answer his q queries for different l and r." 2800

776E "The Holmes Children" "math,number theory" "The Holmes children are fighting over who amongst them is the cleverest.Mycroft asked Sherlock and Eurus to find value of f(n), where f(1)\xe2\x80\x89=\xe2\x80\x891 and for n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892, f(n) is the number of distinct ordered positive integer pairs (x,\xe2\x80\x89y) that satisfy x\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89=\xe2\x80\x89n and gcd(x,\xe2\x80\x89y)\xe2\x80\x89=\xe2\x80\x891. The integer gcd(a,\xe2\x80\x89b) is the greatest common divisor of a and b.Sherlock said that solving this was child\'s play and asked Mycroft to instead get the value of . Summation is done over all positive integers d that divide n.Eurus was quietly observing all this and finally came up with her problem to astonish both Sherlock and Mycroft.She defined a k-composite function Fk(n) recursively as follows:She wants them to tell the value of Fk(n) modulo 1000000007." 2100

776D "The Door Problem" "2-sat,dfs and similar,dsu,graphs" "Moriarty has trapped n people in n distinct rooms in a hotel. Some rooms are locked, others are unlocked. But, there is a condition that the people in the hotel can only escape when all the doors are unlocked at the same time. There are m switches. Each switch control doors of some rooms, but each door is controlled by exactly two switches.You are given the initial configuration of the doors. Toggling any switch, that is, turning it ON when it is OFF, or turning it OFF when it is ON, toggles the condition of the doors that this switch controls. Say, we toggled switch 1, which was connected to room 1, 2 and 3 which were respectively locked, unlocked and unlocked. Then, after toggling the switch, they become unlocked, locked and locked.You need to tell Sherlock, if there exists a way to unlock all doors at the same time." 2000

776C "Molly\'s Chemicals" "binary search,brute force,data structures,implementation,math" "Moriarty has trapped n people in n distinct rooms in a hotel. Some rooms are locked, others are unlocked. But, there is a condition that the people in the hotel can only escape when all the doors are unlocked at the same time. There are m switches. Each switch control doors of some rooms, but each door is controlled by exactly two switches.You are given the initial configuration of the doors. Toggling any switch, that is, turning it ON when it is OFF, or turning it OFF when it is ON, toggles the condition of the doors that this switch controls. Say, we toggled switch 1, which was connected to room 1, 2 and 3 which were respectively locked, unlocked and unlocked. Then, after toggling the switch, they become unlocked, locked and locked.You need to tell Sherlock, if there exists a way to unlock all doors at the same time." 1800

776B "Sherlock and his girlfriend" "constructive algorithms,number theory" "Sherlock has a new girlfriend (so unlike him!). Valentine\'s day is coming and he wants to gift her some jewelry.He bought n pieces of jewelry. The i-th piece has price equal to i\xe2\x80\x89+\xe2\x80\x891, that is, the prices of the jewelry are 2,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x89... n\xe2\x80\x89+\xe2\x80\x891.Watson gave Sherlock a challenge to color these jewelry pieces such that two pieces don\'t have the same color if the price of one piece is a prime divisor of the price of the other piece. Also, Watson asked him to minimize the number of different colors used.Help Sherlock complete this trivial task." 1200

776A "A Serial Killer" "brute force,implementation,strings" "Our beloved detective, Sherlock is currently trying to catch a serial killer who kills a person each day. Using his powers of deduction, he came to know that the killer has a strategy for selecting his next victim.The killer starts with two potential victims on his first day, selects one of these two, kills selected victim and replaces him with a new person. He repeats this procedure each day. This way, each day he has two potential victims to choose from. Sherlock knows the initial two potential victims. Also, he knows the murder that happened on a particular day and the new person who replaced this victim.You need to help him get all the pairs of potential victims at each day so that Sherlock can observe some pattern." 900

775A "University Schedule" "*special problem" "In this problem your task is to come up with a week schedule of classes in university for professors and student groups. Consider that there are 6 educational days in week and maximum number of classes per educational day is 7 (classes numerated from 1 to 7 for each educational day).It is known that in university n students study, m professors work and there are a classrooms for conducting classes. Also you have two-dimensional array with n\xe2\x80\x89\xc3\x97\xe2\x80\x89m size which contains the following information. The number which stays in i-th row and j-th column equals to the number of classes which professor j must conduct with the group i in a single week. The schedule which you output must satisfy to array described above.There are several other conditions for schedule. Single professor can not conduct more than one class. Similarly, single student group can not be on more than one class at the same time.Let define a fatigue function for professors and student groups. Call this function f.To single professor fatigue calculated in the following way. Let look on classes which this professor must conduct in each of the 6-th educational days. Let x be the number of class which professor will firstly conduct in day i and let y \xe2\x80\x94 the last class for this professor. Then the value (2\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(2\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891) must be added to professor\'s fatigue. If professor has no classes in day i, nothing is added to professor\'s fatigue. For single student group fatigue is calculated similarly. Lets look at classes of this group in each of the 6 educational days. Let x be the number of first class for this group on day i and let y \xe2\x80\x94 the last class for this group. Then the value (2\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(2\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891) must be added to this group\'s fatigue. If student group has no classes in day i, nothing is added to group\'s fatigue.So the value of function f equals to total {fatigue} for all n student groups and for all m professors.Your task is to come up with such a schedule which minimizes the value of function f.Jury prepared some solution of this problem. For each test you will get a certain number of points. It equals to result of division of the value of function f from the jury solution by the value of function f for schedule which your program output (i. e. the smaller value of {fatigue} function your program find the more points you will get), multiplied by 100. In the other words if the value of f for jury solution equals to p and for your solution \xe2\x80\x94 to q, you will get 100\xc2\xb7p\xe2\x80\x89/\xe2\x80\x89q points (note, that the number of points is a real number). The points will be added together for all tests. The goal is to score as many points as possible." 2900

774L Bars "*special problem,binary search" "Polycarp\'s workday lasts exactly n minutes. He loves chocolate bars and can eat one bar in one minute. Today Polycarp has k bars at the beginning of the workday.In some minutes of the workday Polycarp has important things to do and in such minutes he is not able to eat a chocolate bar. In other minutes he can either eat or not eat one chocolate bar. It is guaranteed, that in the first and in the last minutes of the workday Polycarp has no important things to do and he will always eat bars in this minutes to gladden himself at the begining and at the end of the workday. Also it is guaranteed, that k is strictly greater than 1.Your task is to determine such an order of eating chocolate bars that the maximum break time between eating bars is as minimum as possible.Consider that Polycarp eats a bar in the minute x and the next bar in the minute y (x<y). Then the break time is equal to y\xe2\x88\x92x\xe2\x88\x921 minutes. It is not necessary for Polycarp to eat all bars he has." 2000

774K "Stepan and Vowels" "*special problem,implementation,strings" "Stepan likes to repeat vowel letters when he writes words. For example, instead of the word ""pobeda"" he can write ""pobeeeedaaaaa"".Sergey does not like such behavior, so he wants to write a program to format the words written by Stepan. This program must combine all consecutive equal vowels to a single vowel. The vowel letters are ""a"", ""e"", ""i"", ""o"", ""u"" and ""y"".There are exceptions: if letters ""e"" or ""o"" repeat in a row exactly 2 times, like in words ""feet"" and ""foot"", the program must skip them and do not transform in one vowel. For example, the word ""iiiimpleeemeentatiioon"" must be converted to the word ""implemeentatioon"".Sergey is very busy and asks you to help him and write the required program." 1600

774J "Stepan\'s Series" "*special problem,dp" "Stepan likes to repeat vowel letters when he writes words. For example, instead of the word ""pobeda"" he can write ""pobeeeedaaaaa"".Sergey does not like such behavior, so he wants to write a program to format the words written by Stepan. This program must combine all consecutive equal vowels to a single vowel. The vowel letters are ""a"", ""e"", ""i"", ""o"", ""u"" and ""y"".There are exceptions: if letters ""e"" or ""o"" repeat in a row exactly 2 times, like in words ""feet"" and ""foot"", the program must skip them and do not transform in one vowel. For example, the word ""iiiimpleeemeentatiioon"" must be converted to the word ""implemeentatioon"".Sergey is very busy and asks you to help him and write the required program." 2000

774I "Composing Of String" "*special problem,dp" "Stepan has a set of n strings. Also, he has a favorite string s. Stepan wants to do the following. He will take some strings of his set and write them down one after another. It is possible that he will take some strings more than once, and will not take some of them at all.Your task is to determine the minimum number of strings in the set which Stepan needs to take and write so that the string s appears as a subsequence in the resulting written down string. For example, in the string ""abcd"" strings ""ad"", ""acd"", ""abcd"" appear as subsequences, and strings ""ba"", ""abdc"" don\'t appear as subsequences." 2300

774H "Repairing Of String" "*special problem,constructive algorithms" "Stepan had a favorite string s which consisted of the lowercase letters of the Latin alphabet. After graduation, he decided to remember it, but it was a long time ago, so he can\'t now remember it. But Stepan remembers some information about the string, namely the sequence of integers c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn, where n equals the length of the string s, and ci equals the number of substrings in the string s with the length i, consisting of the same letters. The substring is a sequence of consecutive characters in the string s.For example, if the Stepan\'s favorite string is equal to ""tttesst"", the sequence c looks like: c\xe2\x80\x89=\xe2\x80\x89[7,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x890].Stepan asks you to help to repair his favorite string s according to the given sequence c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn." 2200

774G "Perfectionist Arkadiy" "*special problem,number theory" "Arkadiy has lots square photos with size a\xe2\x80\x89\xc3\x97\xe2\x80\x89a. He wants to put some of them on a rectangular wall with size h\xe2\x80\x89\xc3\x97\xe2\x80\x89w. The photos which Arkadiy will put on the wall must form a rectangular grid and the distances between neighboring vertically and horizontally photos and also the distances between outside rows and columns of photos to the nearest bound of the wall must be equal to x, where x is some non-negative real number. Look on the picture below for better understanding of the statement.  Arkadiy haven\'t chosen yet how many photos he would put on the wall, however, he want to put at least one photo. Your task is to determine the minimum value of x which can be obtained after putting photos, or report that there is no way to put positive number of photos and satisfy all the constraints. Suppose that Arkadiy has enough photos to make any valid arrangement according to the constraints.Note that Arkadiy wants to put at least one photo on the wall. The photos should not overlap, should completely lie inside the wall bounds and should have sides parallel to the wall sides." 2700

774F "Pens And Days Of Week" "*special problem,binary search,number theory" "Stepan has n pens. Every day he uses them, and on the i-th day he uses the pen number i. On the (n\xe2\x80\x89+\xe2\x80\x891)-th day again he uses the pen number 1, on the (n\xe2\x80\x89+\xe2\x80\x892)-th \xe2\x80\x94 he uses the pen number 2 and so on.On every working day (from Monday to Saturday, inclusive) Stepan spends exactly 1 milliliter of ink of the pen he uses that day. On Sunday Stepan has a day of rest, he does not stend the ink of the pen he uses that day. Stepan knows the current volume of ink in each of his pens. Now it\'s the Monday morning and Stepan is going to use the pen number 1 today. Your task is to determine which pen will run out of ink before all the rest (that is, there will be no ink left in it), if Stepan will use the pens according to the conditions described above." 2700

774E "Big Number and Remainder" "*special problem,math,number theory" "Stepan has a very big positive integer.Let\'s consider all cyclic shifts of Stepan\'s integer (if we look at his integer like at a string) which are also integers (i.e. they do not have leading zeros). Let\'s call such shifts as good shifts. For example, for the integer 10203 the good shifts are the integer itself 10203 and integers 20310 and 31020.Stepan wants to know the minimum remainder of the division by the given number m among all good shifts. Your task is to determine the minimum remainder of the division by m." 2300

774D "Lie or Truth" "*special problem,constructive algorithms,implementation,sortings" "Vasya has a sequence of cubes and exactly one integer is written on each cube. Vasya exhibited all his cubes in a row. So the sequence of numbers written on the cubes in the order from the left to the right equals to a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.While Vasya was walking, his little brother Stepan played with Vasya\'s cubes and changed their order, so now the sequence of numbers written on the cubes became equal to b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn. Stepan said that he swapped only cubes which where on the positions between l and r, inclusive, and did not remove or add any other cubes (i. e. he said that he reordered cubes between positions l and r, inclusive, in some way).Your task is to determine if it is possible that Stepan said the truth, or it is guaranteed that Stepan deceived his brother." 1500

774C "Maximum Number" "*special problem,constructive algorithms,greedy,implementation" "Stepan has the newest electronic device with a display. Different digits can be shown on it. Each digit is shown on a seven-section indicator like it is shown on the picture below.  So, for example, to show the digit 3 on the display, 5 sections must be highlighted; and for the digit 6, 6 sections must be highlighted. The battery of the newest device allows to highlight at most n sections on the display. Stepan wants to know the maximum possible integer number which can be shown on the display of his newest device. Your task is to determine this number. Note that this number must not contain leading zeros. Assume that the size of the display is enough to show any integer." 1200

774B "Significant Cups" "*special problem,binary search,data structures,two pointers" "Stepan is a very experienced olympiad participant. He has n cups for Physics olympiads and m cups for Informatics olympiads. Each cup is characterized by two parameters \xe2\x80\x94 its significance ci and width wi.Stepan decided to expose some of his cups on a shelf with width d in such a way, that:  there is at least one Physics cup and at least one Informatics cup on the shelf,  the total width of the exposed cups does not exceed d,  from each subjects (Physics and Informatics) some of the most significant cups are exposed (i. e. if a cup for some subject with significance x is exposed, then all the cups for this subject with significance greater than x must be exposed too). Your task is to determine the maximum possible total significance, which Stepan can get when he exposes cups on the shelf with width d, considering all the rules described above. The total significance is the sum of significances of all the exposed cups." 2100

774A "Amusement Park" "*special problem,ternary search" "Pupils decided to go to amusement park. Some of them were with parents. In total, n people came to the park and they all want to get to the most extreme attraction and roll on it exactly once.Tickets for group of x people are sold on the attraction, there should be at least one adult in each group (it is possible that the group consists of one adult). The ticket price for such group is c1\xe2\x80\x89+\xe2\x80\x89c2\xc2\xb7(x\xe2\x80\x89-\xe2\x80\x891)2 (in particular, if the group consists of one person, then the price is c1). All pupils who came to the park and their parents decided to split into groups in such a way that each visitor join exactly one group, and the total price of visiting the most extreme attraction is as low as possible. You are to determine this minimum possible total price. There should be at least one adult in each group." 2100

773F "Test Data Generation" "combinatorics,divide and conquer,dp,fft,math,number theory" "Test data generation is not an easy task! Often, generating big random test cases is not enough to ensure thorough testing of solutions for correctness.For example, consider a problem from an old Codeforces round. Its input format looks roughly as follows:The first line contains a single integer n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89maxn)�\xe2\x80\x94 the size of the set. The second line contains n distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89maxa)�\xe2\x80\x94 the elements of the set in increasing order.If you don\'t pay attention to the problem solution, it looks fairly easy to generate a good test case for this problem. Let n\xe2\x80\x89=\xe2\x80\x89maxn, take random distinct ai from 1 to maxa, sort them... Soon you understand that it\'s not that easy.Here is the actual problem solution. Let g be the greatest common divisor of a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Let x\xe2\x80\x89=\xe2\x80\x89an\xe2\x80\x89/\xe2\x80\x89g\xe2\x80\x89-\xe2\x80\x89n. Then the correct solution outputs ""Alice"" if x is odd, and ""Bob"" if x is even.Consider two wrong solutions to this problem which differ from the correct one only in the formula for calculating x.The first wrong solution calculates x as x\xe2\x80\x89=\xe2\x80\x89an\xe2\x80\x89/\xe2\x80\x89g (without subtracting n).The second wrong solution calculates x as x\xe2\x80\x89=\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x89n (without dividing by g).A test case is interesting if it makes both wrong solutions output an incorrect answer.Given maxn, maxa and q, find the number of interesting test cases satisfying the constraints, and output it modulo q." 3400

773E "Blog Post Rating" "data structures,sortings" "It\'s well-known that blog posts are an important part of Codeforces platform. Every blog post has a global characteristic changing over time�\xe2\x80\x94 its community rating. A newly created blog post\'s community rating is 0. Codeforces users may visit the blog post page and rate it, changing its community rating by +1 or -1.Consider the following model of Codeforces users\' behavior. The i-th user has his own estimated blog post rating denoted by an integer ai. When a user visits a blog post page, he compares his estimated blog post rating to its community rating. If his estimated rating is higher, he rates the blog post with +1 (thus, the blog post\'s community rating increases by 1). If his estimated rating is lower, he rates the blog post with -1 (decreasing its community rating by 1). If the estimated rating and the community rating are equal, user doesn\'t rate the blog post at all (in this case we\'ll say that user rates the blog post for 0). In any case, after this procedure user closes the blog post page and never opens it again.Consider a newly created blog post with the initial community rating of 0. For each of n Codeforces users, numbered from 1 to n, his estimated blog post rating ai is known.For each k from 1 to n, inclusive, the following question is asked. Let users with indices from 1 to k, in some order, visit the blog post page, rate the blog post and close the page. Each user opens the blog post only after the previous user closes it. What could be the maximum possible community rating of the blog post after these k visits?" 3000

773D "Perishable Roads" "dp,graphs,shortest paths" "In the country of Never, there are n cities and a well-developed road system. There is exactly one bidirectional road between every pair of cities, thus, there are as many as  roads! No two roads intersect, and no road passes through intermediate cities. The art of building tunnels and bridges has been mastered by Neverians.An independent committee has evaluated each road of Never with a positive integer called the perishability of the road. The lower the road\'s perishability is, the more pleasant it is to drive through this road.It\'s the year of transport in Never. It has been decided to build a museum of transport in one of the cities, and to set a single signpost directing to some city (not necessarily the one with the museum) in each of the other cities. The signposts must satisfy the following important condition: if any Neverian living in a city without the museum starts travelling from that city following the directions of the signposts, then this person will eventually arrive in the city with the museum.Neverians are incredibly positive-minded. If a Neverian travels by a route consisting of several roads, he considers the perishability of the route to be equal to the smallest perishability of all the roads in this route.The government of Never has not yet decided where to build the museum, so they consider all n possible options. The most important is the sum of perishabilities of the routes to the museum city from all the other cities of Never, if the travelers strictly follow the directions of the signposts. The government of Never cares about their citizens, so they want to set the signposts in a way which minimizes this sum. Help them determine the minimum possible sum for all n possible options of the city where the museum can be built." 2700

773C "Prairie Partition" "binary search,constructive algorithms,greedy,math" "It can be shown that any positive integer x can be uniquely represented as x\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x894\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x892k\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89r, where k and r are integers, k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890, 0\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892k. Let\'s call that representation prairie partition of x.For example, the prairie partitions of 12, 17, 7 and 1 are:  12\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x894\xe2\x80\x89+\xe2\x80\x895,17\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x894\xe2\x80\x89+\xe2\x80\x898\xe2\x80\x89+\xe2\x80\x892,7\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x894,1\xe2\x80\x89=\xe2\x80\x891. Alice took a sequence of positive integers (possibly with repeating elements), replaced every element with the sequence of summands in its prairie partition, arranged the resulting numbers in non-decreasing order and gave them to Borys. Now Borys wonders how many elements Alice\'s original sequence could contain. Find all possible options!" 2200

773B "Dynamic Problem Scoring" "brute force,greedy" "Vasya and Petya take part in a Codeforces round. The round lasts for two hours and contains five problems.For this round the dynamic problem scoring is used. If you were lucky not to participate in any Codeforces round with dynamic problem scoring, here is what it means. The maximum point value of the problem depends on the ratio of the number of participants who solved the problem to the total number of round participants. Everyone who made at least one submission is considered to be participating in the round.Pay attention to the range bounds. For example, if 40 people are taking part in the round, and 10 of them solve a particular problem, then the solvers fraction is equal to 1\xe2\x80\x89/\xe2\x80\x894, and the problem\'s maximum point value is equal to 1500.If the problem\'s maximum point value is equal to x, then for each whole minute passed from the beginning of the contest to the moment of the participant\'s correct submission, the participant loses x\xe2\x80\x89/\xe2\x80\x89250 points. For example, if the problem\'s maximum point value is 2000, and the participant submits a correct solution to it 40 minutes into the round, this participant will be awarded with 2000\xc2\xb7(1\xe2\x80\x89-\xe2\x80\x8940\xe2\x80\x89/\xe2\x80\x89250)\xe2\x80\x89=\xe2\x80\x891680 points for this problem.There are n participants in the round, including Vasya and Petya. For each participant and each problem, the number of minutes which passed between the beginning of the contest and the submission of this participant to this problem is known. It\'s also possible that this participant made no submissions to this problem.With two seconds until the end of the round, all participants\' submissions have passed pretests, and not a single hack attempt has been made. Vasya believes that no more submissions or hack attempts will be made in the remaining two seconds, and every submission will pass the system testing.Unfortunately, Vasya is a cheater. He has registered 109\xe2\x80\x89+\xe2\x80\x897 new accounts for the round. Now Vasya can submit any of his solutions from these new accounts in order to change the maximum point values of the problems. Vasya can also submit any wrong solutions to any problems. Note that Vasya can not submit correct solutions to the problems he hasn\'t solved.Vasya seeks to score strictly more points than Petya in the current round. Vasya has already prepared the scripts which allow to obfuscate his solutions and submit them into the system from any of the new accounts in just fractions of seconds. However, Vasya doesn\'t want to make his cheating too obvious, so he wants to achieve his goal while making submissions from the smallest possible number of new accounts.Find the smallest number of new accounts Vasya needs in order to beat Petya (provided that Vasya\'s assumptions are correct), or report that Vasya can\'t achieve his goal." 2000

773A "Success Rate" "binary search,math" "You are an experienced Codeforces user. Today you found out that during your activity on Codeforces you have made y submissions, out of which x have been successful. Thus, your current success rate on Codeforces is equal to x\xe2\x80\x89/\xe2\x80\x89y.Your favorite rational number in the [0;1] range is p\xe2\x80\x89/\xe2\x80\x89q. Now you wonder: what is the smallest number of submissions you have to make if you want your success rate to be p\xe2\x80\x89/\xe2\x80\x89q?" 1700

772E "Verifying Kingdom" "binary search,divide and conquer,interactive,trees" "This is an interactive problem.The judge has a hidden rooted full binary tree with n leaves. A full binary tree is one where every node has either 0 or 2 children. The nodes with 0 children are called the leaves of the tree. Since this is a full binary tree, there are exactly 2n\xe2\x80\x89-\xe2\x80\x891 nodes in the tree. The leaves of the judge\'s tree has labels from 1 to n. You would like to reconstruct a tree that is isomorphic to the judge\'s tree. To do this, you can ask some questions.A question consists of printing the label of three distinct leaves a1,\xe2\x80\x89a2,\xe2\x80\x89a3. Let the depth of a node be the shortest distance from the node to the root of the tree. Let LCA(a,\xe2\x80\x89b) denote the node with maximum depth that is a common ancestor of the nodes a and b.Consider X\xe2\x80\x89=\xe2\x80\x89LCA(a1,\xe2\x80\x89a2),\xe2\x80\x89Y\xe2\x80\x89=\xe2\x80\x89LCA(a2,\xe2\x80\x89a3),\xe2\x80\x89Z\xe2\x80\x89=\xe2\x80\x89LCA(a3,\xe2\x80\x89a1). The judge will tell you which one of X,\xe2\x80\x89Y,\xe2\x80\x89Z has the maximum depth. Note, this pair is uniquely determined since the tree is a binary tree; there can\'t be any ties. More specifically, if X (or Y, Z respectively) maximizes the depth, the judge will respond with the string ""X"" (or ""Y"", ""Z"" respectively). You may only ask at most 10\xc2\xb7n questions." 3200

772D "Varying Kibibits" bitmasks,dp "You are given n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Denote this list of integers as T.Let f(L) be a function that takes in a non-empty list of integers L.The function will output another integer as follows:   First, all integers in L are padded with leading zeros so they are all the same length as the maximum length number in L.  We will construct a string where the i-th character is the minimum of the i-th character in padded input numbers.  The output is the number representing the string interpreted in base 10. For example f(10,\xe2\x80\x899)\xe2\x80\x89=\xe2\x80\x890, f(123,\xe2\x80\x89321)\xe2\x80\x89=\xe2\x80\x89121, f(530,\xe2\x80\x89932,\xe2\x80\x8981)\xe2\x80\x89=\xe2\x80\x8930.Define the function  Here,  denotes a subsequence.In other words, G(x) is the sum of squares of sum of elements of nonempty subsequences of T that evaluate to x when plugged into f modulo 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007, then multiplied by x. The last multiplication is not modded. You would like to compute G(0),\xe2\x80\x89G(1),\xe2\x80\x89...,\xe2\x80\x89G(999\xe2\x80\x89999). To reduce the output size, print the value , where  denotes the bitwise XOR operator." 2700

772C "Vulnerable Kerbals" "constructive algorithms,dp,graphs,math,number theory" "You are given an integer m, and a list of n distinct integers between 0 and m\xe2\x80\x89-\xe2\x80\x891.You would like to construct a sequence satisfying the properties:  Each element is an integer between 0 and m\xe2\x80\x89-\xe2\x80\x891, inclusive.  All prefix products of the sequence modulo m are distinct.  No prefix product modulo m appears as an element of the input list.  The length of the sequence is maximized. Construct any sequence satisfying the properties above." 2300

772B "Volatile Kite" geometry "You are given a convex polygon P with n distinct vertices p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. Vertex pi has coordinates (xi,\xe2\x80\x89yi) in the 2D plane. These vertices are listed in clockwise order.You can choose a real number D and move each vertex of the polygon a distance of at most D from their original positions.Find the maximum value of D such that no matter how you move the vertices, the polygon does not intersect itself and stays convex." 1800

772A "Voltage Keepsake" "binary search,math" "You have n devices that you want to use simultaneously.The i-th device uses ai units of power per second. This usage is continuous. That is, in \xce\xbb seconds, the device will use \xce\xbb\xc2\xb7ai units of power. The i-th device currently has bi units of power stored. All devices can store an arbitrary amount of power.You have a single charger that can plug to any single device. The charger will add p units of power per second to a device. This charging is continuous. That is, if you plug in a device for \xce\xbb seconds, it will gain \xce\xbb\xc2\xb7p units of power. You can switch which device is charging at any arbitrary unit of time (including real numbers), and the time it takes to switch is negligible.You are wondering, what is the maximum amount of time you can use the devices until one of them hits 0 units of power.If you can use the devices indefinitely, print -1. Otherwise, print the maximum amount of time before any one device hits 0 power." 1800

771F "Bear and Isomorphic Points" "geometry,two pointers" "Bearland is a big square on the plane. It contains all points with coordinates not exceeding 106 by the absolute value.There are n houses in Bearland. The i-th of them is located at the point (xi,\xe2\x80\x89yi). The n points are distinct, but some subsets of them may be collinear.Bear Limak lives in the first house. He wants to destroy his house and build a new one somewhere in Bearland.Bears don\'t like big changes. For every three points (houses) pi, pj and pk, the sign of their cross product (pj\xe2\x80\x89-\xe2\x80\x89pi)\xe2\x80\x89\xc3\x97\xe2\x80\x89(pk\xe2\x80\x89-\xe2\x80\x89pi) should be the same before and after the relocation. If it was negative/positive/zero, it should still be negative/positive/zero respectively. This condition should be satisfied for all triples of indices (i,\xe2\x80\x89j,\xe2\x80\x89k), possibly equal to each other or different than 1. Additionally, Limak isn\'t allowed to build the house at the point where some other house already exists (but it can be the point where his old house was).In the formula above, we define the difference and the cross product of points (ax,\xe2\x80\x89ay) and (bx,\xe2\x80\x89by) as: (ax,\xe2\x80\x89ay)\xe2\x80\x89-\xe2\x80\x89(bx,\xe2\x80\x89by)\xe2\x80\x89=\xe2\x80\x89(ax\xe2\x80\x89-\xe2\x80\x89bx,\xe2\x80\x89ay\xe2\x80\x89-\xe2\x80\x89by),\xe2\x80\x89 (ax,\xe2\x80\x89ay)\xe2\x80\x89\xc3\x97\xe2\x80\x89(bx,\xe2\x80\x89by)\xe2\x80\x89=\xe2\x80\x89ax\xc2\xb7by\xe2\x80\x89-\xe2\x80\x89ay\xc2\xb7bx.Consider a set of possible new placements of Limak\'s house. Your task is to find the area of that set of points.Formally, let\'s say that Limak chooses the new placement randomly (each coordinate is chosen independently uniformly at random from the interval [\xe2\x80\x89-\xe2\x80\x89106,\xe2\x80\x89106]). Let p denote the probability of getting the allowed placement of new house. Let S denote the area of Bearland (S\xe2\x80\x89=\xe2\x80\x894\xc2\xb71012). Your task is to find p\xc2\xb7S." 3300

771E "Bear and Rectangle Strips" dp,greedy "Limak has a grid that consists of 2 rows and n columns. The j-th cell in the i-th row contains an integer ti,\xe2\x80\x89j which can be positive, negative or zero.A non-empty rectangle of cells is called nice if and only if the sum of numbers in its cells is equal to 0.Limak wants to choose some nice rectangles and give them to his friends, as gifts. No two chosen rectangles should share a cell. What is the maximum possible number of nice rectangles Limak can choose?" 3000

771D "Bear and Company" dp "Bear Limak prepares problems for a programming competition. Of course, it would be unprofessional to mention the sponsor name in the statement. Limak takes it seriously and he is going to change some words. To make it still possible to read, he will try to modify each word as little as possible.Limak has a string s that consists of uppercase English letters. In one move he can swap two adjacent letters of the string. For example, he can transform a string ""ABBC"" into ""BABC"" or ""ABCB"" in one move.Limak wants to obtain a string without a substring ""VK"" (i.e. there should be no letter \'V\' immediately followed by letter \'K\'). It can be easily proved that it\'s possible for any initial string s.What is the minimum possible number of moves Limak can do?" 2500

771C "Bear and Tree Jumps" "dfs and similar,dp,trees" "A tree is an undirected connected graph without cycles. The distance between two vertices is the number of edges in a simple path between them.Limak is a little polar bear. He lives in a tree that consists of n vertices, numbered 1 through n.Limak recently learned how to jump. He can jump from a vertex to any vertex within distance at most k.For a pair of vertices (s,\xe2\x80\x89t) we define f(s,\xe2\x80\x89t) as the minimum number of jumps Limak needs to get from s to t. Your task is to find the sum of f(s,\xe2\x80\x89t) over all pairs of vertices (s,\xe2\x80\x89t) such that s\xe2\x80\x89<\xe2\x80\x89t." 2100

771B "Bear and Different Names" "constructive algorithms,greedy" "In the army, it isn\'t easy to form a group of soldiers that will be effective on the battlefield. The communication is crucial and thus no two soldiers should share a name (what would happen if they got an order that Bob is a scouter, if there are two Bobs?).A group of soldiers is effective if and only if their names are different. For example, a group (John, Bob, Limak) would be effective, while groups (Gary, Bob, Gary) and (Alice, Alice) wouldn\'t.You are a spy in the enemy\'s camp. You noticed n soldiers standing in a row, numbered 1 through n. The general wants to choose a group of k consecutive soldiers. For every k consecutive soldiers, the general wrote down whether they would be an effective group or not.You managed to steal the general\'s notes, with n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891, each either ""YES"" or ""NO"".   The string s1 describes a group of soldiers 1 through k (""YES"" if the group is effective, and ""NO"" otherwise).  The string s2 describes a group of soldiers 2 through k\xe2\x80\x89+\xe2\x80\x891.  And so on, till the string sn\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 that describes a group of soldiers n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 through n. Your task is to find possible names of n soldiers. Names should match the stolen notes. Each name should be a string that consists of between 1 and 10 English letters, inclusive. The first letter should be uppercase, and all other letters should be lowercase. Names don\'t have to be existing names�\xe2\x80\x94 it\'s allowed to print ""Xyzzzdj"" or ""T"" for example.Find and print any solution. It can be proved that there always exists at least one solution." 1500

771A "Bear and Friendship Condition" "dfs and similar,dsu,graphs" "Bear Limak examines a social network. Its main functionality is that two members can become friends (then they can talk with each other and share funny pictures).There are n members, numbered 1 through n. m pairs of members are friends. Of course, a member can\'t be a friend with themselves.Let A-B denote that members A and B are friends. Limak thinks that a network is reasonable if and only if the following condition is satisfied: For every three distinct members (X, Y, Z), if X-Y and Y-Z then also X-Z.For example: if Alan and Bob are friends, and Bob and Ciri are friends, then Alan and Ciri should be friends as well.Can you help Limak and check if the network is reasonable? Print ""YES"" or ""NO"" accordingly, without the quotes." 1500

770D "Draw Brackets!" "*special problem,implementation" "A sequence of square brackets is regular if by inserting symbols ""+"" and ""1"" into it, you can get a regular mathematical expression from it. For example, sequences ""[[]][]"", ""[]"" and ""[[][[]]]"" \xe2\x80\x94 are regular, at the same time ""]["", ""[[]"" and ""[[]]]["" \xe2\x80\x94 are irregular. Draw the given sequence using a minimalistic pseudographics in the strip of the lowest possible height \xe2\x80\x94 use symbols \'+\', \'-\' and \'|\'. For example, the sequence ""[[][]][]"" should be represented as: +-        -++- -+    |+- -++- -+||   |||   ||   |||   ||+- -++- -+||   |+-        -++- -+Each bracket should be represented with the hepl of one or more symbols \'|\' (the vertical part) and symbols \'+\' and \'-\' as on the example which is given above.Brackets should be drawn without spaces one by one, only dividing pairs of consecutive pairwise brackets with a single-space bar (so that the two brackets do not visually merge into one symbol). The image should have the minimum possible height. The enclosed bracket is always smaller than the surrounding bracket, but each bracket separately strives to maximize the height of the image. So the pair of final brackets in the example above occupies the entire height of the image.Study carefully the examples below, they adequately explain the condition of the problem. Pay attention that in this problem the answer (the image) is unique." 1400

770C "Online Courses In BSU" "*special problem,dfs and similar,graphs,implementation" "Now you can take online courses in the Berland State University! Polycarp needs to pass k main online courses of his specialty to get a diploma. In total n courses are availiable for the passage.The situation is complicated by the dependence of online courses, for each course there is a list of those that must be passed before starting this online course (the list can be empty, it means that there is no limitation).Help Polycarp to pass the least number of courses in total to get the specialty (it means to pass all main and necessary courses). Write a program which prints the order of courses. Polycarp passes courses consistently, he starts the next course when he finishes the previous one. Each course can\'t be passed more than once." 1500

770B "Maximize Sum of Digits" "*special problem,implementation,math" "Anton has the integer x. He is interested what positive integer, which doesn\'t exceed x, has the maximum sum of digits.Your task is to help Anton and to find the integer that interests him. If there are several such integers, determine the biggest of them." 1300

770A "New Password" "*special problem,implementation" "Innokentiy decides to change the password in the social net ""Contact!"", but he is too lazy to invent a new password by himself. That is why he needs your help. Innokentiy decides that new password should satisfy the following conditions:  the length of the password must be equal to n,  the password should consist only of lowercase Latin letters,  the number of distinct symbols in the password must be equal to k,  any two consecutive symbols in the password must be distinct. Your task is to help Innokentiy and to invent a new password which will satisfy all given conditions." 800

769D "k-Interesting Pairs Of Integers" "*special problem,bitmasks,brute force,meet-in-the-middle" "Vasya has the sequence consisting of n integers. Vasya consider the pair of integers x and y k-interesting, if their binary representation differs from each other exactly in k bits. For example, if k\xe2\x80\x89=\xe2\x80\x892, the pair of integers x\xe2\x80\x89=\xe2\x80\x895 and y\xe2\x80\x89=\xe2\x80\x893 is k-interesting, because their binary representation x=101 and y=011 differs exactly in two bits.Vasya wants to know how many pairs of indexes (i, j) are in his sequence so that i\xe2\x80\x89<\xe2\x80\x89j and the pair of integers ai and aj is k-interesting. Your task is to help Vasya and determine this number." 1700

769C "Cycle In Maze" "*special problem,dfs and similar,graphs,greedy,shortest paths" "The Robot is in a rectangular maze of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell of the maze is either empty or occupied by an obstacle. The Robot can move between neighboring cells on the side left (the symbol ""L""), right (the symbol ""R""), up (the symbol ""U"") or down (the symbol ""D""). The Robot can move to the cell only if it is empty. Initially, the Robot is in the empty cell.Your task is to find lexicographically minimal Robot\'s cycle with length exactly k, which begins and ends in the cell where the Robot was initially. It is allowed to the Robot to visit any cell many times (including starting).Consider that Robot\'s way is given as a line which consists of symbols ""L"", ""R"", ""U"" and ""D"". For example, if firstly the Robot goes down, then left, then right and up, it means that his way is written as ""DLRU"".In this task you don\'t need to minimize the length of the way. Find the minimum lexicographical (in alphabet order as in the dictionary) line which satisfies requirements above." 1700

769B "News About Credit" "*special problem,greedy,two pointers" "Polycarp studies at the university in the group which consists of n students (including himself). All they are registrated in the social net ""TheContacnt!"".Not all students are equally sociable. About each student you know the value ai \xe2\x80\x94 the maximum number of messages which the i-th student is agree to send per day. The student can\'t send messages to himself. In early morning Polycarp knew important news that the programming credit will be tomorrow. For this reason it is necessary to urgently inform all groupmates about this news using private messages. Your task is to make a plan of using private messages, so that:  the student i sends no more than ai messages (for all i from 1 to n);  all students knew the news about the credit (initially only Polycarp knew it);  the student can inform the other student only if he knows it himself. Let\'s consider that all students are numerated by distinct numbers from 1 to n, and Polycarp always has the number 1.In that task you shouldn\'t minimize the number of messages, the moment of time, when all knew about credit or some other parameters. Find any way how to use private messages which satisfies requirements above." 1200

769A "Year of University Entrance" "*special problem,implementation,sortings" "There is the faculty of Computer Science in Berland. In the social net ""TheContact!"" for each course of this faculty there is the special group whose name equals the year of university entrance of corresponding course of students at the university. Each of students joins the group of his course and joins all groups for which the year of student\'s university entrance differs by no more than x from the year of university entrance of this student, where x \xe2\x80\x94 some non-negative integer. A value x is not given, but it can be uniquely determined from the available data. Note that students don\'t join other groups. You are given the list of groups which the student Igor joined. According to this information you need to determine the year of Igor\'s university entrance." 800

768G "The Winds of Winter" "binary search,data structures" "Given a rooted tree with n nodes. The Night King removes exactly one node from the tree and all the edges associated with it. Doing this splits the tree and forms a forest. The node which is removed is not a part of the forest.The root of a tree in the forest is the node in that tree which does not have a parent. We define the strength of the forest as the size of largest tree in forest.Jon Snow wants to minimize the strength of the forest. To do this he can perform the following operation at most once.He removes the edge between a node and its parent and inserts a new edge between this node and any other node in forest such that the total number of trees in forest remain same.For each node v you need to find the minimum value of strength of the forest formed when node v is removed." 3300

768F "Barrels and boxes" "brute force,combinatorics,math,number theory,probabilities" "Tarly has two different type of items, food boxes and wine barrels. There are f food boxes and w wine barrels. Tarly stores them in various stacks and each stack can consist of either food boxes or wine barrels but not both. The stacks are placed in a line such that no two stacks of food boxes are together and no two stacks of wine barrels are together.The height of a stack is defined as the number of items in the stack. Two stacks are considered different if either their heights are different or one of them contains food and other contains wine.Jon Snow doesn\'t like an arrangement if any stack of wine barrels has height less than or equal to h. What is the probability that Jon Snow will like the arrangement if all arrangement are equiprobably?Two arrangement of stacks are considered different if exists such i, that i-th stack of one arrangement is different from the i-th stack of the other arrangement." 2300

768E "Game of Stones" bitmasks,dp,games "Sam has been teaching Jon the Game of Stones to sharpen his mind and help him devise a strategy to fight the white walkers. The rules of this game are quite simple:  The game starts with n piles of stones indexed from 1 to n. The i-th pile contains si stones. The players make their moves alternatively. A move is considered as removal of some number of stones from a pile. Removal of 0 stones does not count as a move. The player who is unable to make a move loses.Now Jon believes that he is ready for battle, but Sam does not think so. To prove his argument, Sam suggested that they play a modified version of the game.In this modified version, no move can be made more than once on a pile. For example, if 4 stones are removed from a pile, 4 stones cannot be removed from that pile again.Sam sets up the game and makes the first move. Jon believes that Sam is just trying to prevent him from going to battle. Jon wants to know if he can win if both play optimally." 2100

768D "Jon and Orbs" dp,math,probabilities "Jon Snow is on the lookout for some orbs required to defeat the white walkers. There are k different types of orbs and he needs at least one of each. One orb spawns daily at the base of a Weirwood tree north of the wall. The probability of this orb being of any kind is equal. As the north of wall is full of dangers, he wants to know the minimum number of days he should wait before sending a ranger to collect the orbs such that the probability of him getting at least one of each kind of orb is at least , where \xce\xb5\xe2\x80\x89<\xe2\x80\x8910\xe2\x80\x89-\xe2\x80\x897.To better prepare himself, he wants to know the answer for q different values of pi. Since he is busy designing the battle strategy with Sam, he asks you for your help." 2200

768C "Jon Snow and his Favourite Number" "brute force,dp,implementation,sortings" "Jon Snow now has to fight with White Walkers. He has n rangers, each of which has his own strength. Also Jon Snow has his favourite number x. Each ranger can fight with a white walker only if the strength of the white walker equals his strength. He however thinks that his rangers are weak and need to improve. Jon now thinks that if he takes the bitwise XOR of strengths of some of rangers with his favourite number x, he might get soldiers of high strength. So, he decided to do the following operation k times:  Arrange all the rangers in a straight line in the order of increasing strengths. Take the bitwise XOR (is written as ) of the strength of each alternate ranger with x and update it\'s strength. Suppose, Jon has 5 rangers with strengths [9,\xe2\x80\x897,\xe2\x80\x8911,\xe2\x80\x8915,\xe2\x80\x895] and he performs the operation 1 time with x\xe2\x80\x89=\xe2\x80\x892. He first arranges them in the order of their strengths, [5,\xe2\x80\x897,\xe2\x80\x899,\xe2\x80\x8911,\xe2\x80\x8915]. Then he does the following:  The strength of first ranger is updated to , i.e. 7. The strength of second ranger remains the same, i.e. 7. The strength of third ranger is updated to , i.e. 11. The strength of fourth ranger remains the same, i.e. 11. The strength of fifth ranger is updated to , i.e. 13. The new strengths of the 5 rangers are [7,\xe2\x80\x897,\xe2\x80\x8911,\xe2\x80\x8911,\xe2\x80\x8913]Now, Jon wants to know the maximum and minimum strength of the rangers after performing the above operations k times. He wants your help for this task. Can you help him?" 1800

768B "Code For 1" "constructive algorithms,dfs and similar,divide and conquer" "Jon fought bravely to rescue the wildlings who were attacked by the white-walkers at Hardhome. On his arrival, Sam tells him that he wants to go to Oldtown to train at the Citadel to become a maester, so he can return and take the deceased Aemon\'s place as maester of Castle Black. Jon agrees to Sam\'s proposal and Sam sets off his journey to the Citadel. However becoming a trainee at the Citadel is not a cakewalk and hence the maesters at the Citadel gave Sam a problem to test his eligibility. Initially Sam has a list with a single element n. Then he has to perform certain operations on this list. In each operation Sam must remove any element x, such that x\xe2\x80\x89>\xe2\x80\x891, from the list and insert at the same position , ,  sequentially. He must continue with these operations until all the elements in the list are either 0 or 1.Now the masters want the total number of 1s in the range l to r (1-indexed). Sam wants to become a maester but unfortunately he cannot solve this problem. Can you help Sam to pass the eligibility test?" 1600

768A "Oath of the Night\'s Watch" "constructive algorithms,sortings" "Jon fought bravely to rescue the wildlings who were attacked by the white-walkers at Hardhome. On his arrival, Sam tells him that he wants to go to Oldtown to train at the Citadel to become a maester, so he can return and take the deceased Aemon\'s place as maester of Castle Black. Jon agrees to Sam\'s proposal and Sam sets off his journey to the Citadel. However becoming a trainee at the Citadel is not a cakewalk and hence the maesters at the Citadel gave Sam a problem to test his eligibility. Initially Sam has a list with a single element n. Then he has to perform certain operations on this list. In each operation Sam must remove any element x, such that x\xe2\x80\x89>\xe2\x80\x891, from the list and insert at the same position , ,  sequentially. He must continue with these operations until all the elements in the list are either 0 or 1.Now the masters want the total number of 1s in the range l to r (1-indexed). Sam wants to become a maester but unfortunately he cannot solve this problem. Can you help Sam to pass the eligibility test?" 900

767E Change-free greedy "Student Arseny likes to plan his life for n days ahead. He visits a canteen every day and he has already decided what he will order in each of the following n days. Prices in the canteen do not change and that means Arseny will spend ci rubles during the i-th day.There are 1-ruble coins and 100-ruble notes in circulation. At this moment, Arseny has m coins and a sufficiently large amount of notes (you can assume that he has an infinite amount of them). Arseny loves modern technologies, so he uses his credit card everywhere except the canteen, but he has to pay in cash in the canteen because it does not accept cards.Cashier always asks the student to pay change-free. However, it\'s not always possible, but Arseny tries to minimize the dissatisfaction of the cashier. Cashier\'s dissatisfaction for each of the days is determined by the total amount of notes and coins in the change. To be precise, if the cashier gives Arseny x notes and coins on the i-th day, his dissatisfaction for this day equals x\xc2\xb7wi. Cashier always gives change using as little coins and notes as possible, he always has enough of them to be able to do this.  ""Caution! Angry cashier"" Arseny wants to pay in such a way that the total dissatisfaction of the cashier for n days would be as small as possible. Help him to find out how he needs to pay in each of the n days!Note that Arseny always has enough money to pay, because he has an infinite amount of notes. Arseny can use notes and coins he received in change during any of the following days." 2400

767D "Cartons of milk" "binary search,data structures,greedy,sortings,two pointers" "Olya likes milk very much. She drinks k cartons of milk each day if she has at least k and drinks all of them if she doesn\'t. But there\'s an issue�\xe2\x80\x94 expiration dates. Each carton has a date after which you can\'t drink it (you still can drink it exactly at the date written on the carton). Due to this, if Olya\'s fridge contains a carton past its expiry date, she throws it away.Olya hates throwing out cartons, so when she drinks a carton, she chooses the one which expires the fastest. It\'s easy to understand that this strategy minimizes the amount of cartons thrown out and lets her avoid it if it\'s even possible.  Milk. Best before: 20.02.2017. The main issue Olya has is the one of buying new cartons. Currently, there are n cartons of milk in Olya\'s fridge, for each one an expiration date is known (how soon does it expire, measured in days). In the shop that Olya visited there are m cartons, and the expiration date is known for each of those cartons as well.Find the maximum number of cartons Olya can buy so that she wouldn\'t have to throw away any cartons. Assume that Olya drank no cartons today." 2100

767C Garland "dfs and similar,graphs,greedy,trees" "Once at New Year Dima had a dream in which he was presented a fairy garland. A garland is a set of lamps, some pairs of which are connected by wires. Dima remembered that each two lamps in the garland were connected directly or indirectly via some wires. Furthermore, the number of wires was exactly one less than the number of lamps.There was something unusual about the garland. Each lamp had its own brightness which depended on the temperature of the lamp. Temperatures could be positive, negative or zero. Dima has two friends, so he decided to share the garland with them. He wants to cut two different wires so that the garland breaks up into three parts. Each part of the garland should shine equally, i.�e. the sums of lamps\' temperatures should be equal in each of the parts. Of course, each of the parts should be non-empty, i.�e. each part should contain at least one lamp.  Help Dima to find a suitable way to cut the garland, or determine that this is impossible.While examining the garland, Dima lifted it up holding by one of the lamps. Thus, each of the lamps, except the one he is holding by, is now hanging on some wire. So, you should print two lamp ids as the answer which denote that Dima should cut the wires these lamps are hanging on. Of course, the lamp Dima is holding the garland by can\'t be included in the answer." 2000

767B "The Queue" "brute force,greedy" "Finally! Vasya have come of age and that means he can finally get a passport! To do it, he needs to visit the passport office, but it\'s not that simple. There\'s only one receptionist at the passport office and people can queue up long before it actually opens. Vasya wants to visit the passport office tomorrow.He knows that the receptionist starts working after ts minutes have passed after midnight and closes after tf minutes have passed after midnight (so that (tf\xe2\x80\x89-\xe2\x80\x891) is the last minute when the receptionist is still working). The receptionist spends exactly t minutes on each person in the queue. If the receptionist would stop working within t minutes, he stops serving visitors (other than the one he already serves). Vasya also knows that exactly n visitors would come tomorrow. For each visitor Vasya knows the point of time when he would come to the passport office. Each visitor queues up and doesn\'t leave until he was served. If the receptionist is free when a visitor comes (in particular, if the previous visitor was just served and the queue is empty), the receptionist begins to serve the newcomer immediately.  ""Reception 1"" For each visitor, the point of time when he would come to the passport office is positive. Vasya can come to the office at the time zero (that is, at midnight) if he needs so, but he can come to the office only at integer points of time. If Vasya arrives at the passport office at the same time with several other visitors, he yields to them and stand in the queue after the last of them.Vasya wants to come at such point of time that he will be served by the receptionist, and he would spend the minimum possible time in the queue. Help him!" 2100

767A Snacktower "data structures,implementation" "According to an old legeng, a long time ago Ankh-Morpork residents did something wrong to miss Fortune, and she cursed them. She said that at some time n snacks of distinct sizes will fall on the city, and the residents should build a Snacktower of them by placing snacks one on another. Of course, big snacks should be at the bottom of the tower, while small snacks should be at the top.Years passed, and once different snacks started to fall onto the city, and the residents began to build the Snacktower.  However, they faced some troubles. Each day exactly one snack fell onto the city, but their order was strange. So, at some days the residents weren\'t able to put the new stack on the top of the Snacktower: they had to wait until all the bigger snacks fell. Of course, in order to not to anger miss Fortune again, the residents placed each snack on the top of the tower immediately as they could do it.Write a program that models the behavior of Ankh-Morpork residents." 1100

766E "Mahmoud and a xor trip" "bitmasks,constructive algorithms,data structures,dfs and similar,dp,math,trees" "Mahmoud and Ehab live in a country with n cities numbered from 1 to n and connected by n\xe2\x80\x89-\xe2\x80\x891 undirected roads. It\'s guaranteed that you can reach any city from any other using these roads. Each city has a number ai attached to it.We define the distance from city x to city y as the xor of numbers attached to the cities on the path from x to y (including both x and y). In other words if values attached to the cities on the path from x to y form an array p of length l then the distance between them is , where  is bitwise xor operation.Mahmoud and Ehab want to choose two cities and make a journey from one to another. The index of the start city is always less than or equal to the index of the finish city (they may start and finish in the same city and in this case the distance equals the number attached to that city). They can\'t determine the two cities so they try every city as a start and every city with greater index as a finish. They want to know the total distance between all pairs of cities." 2100

766D "Mahmoud and a Dictionary" "data structures,dfs and similar,dp,dsu,graphs" "Mahmoud wants to write a new dictionary that contains n words and relations between them. There are two types of relations: synonymy (i.�e. the two words mean the same) and antonymy (i.�e. the two words mean the opposite). From time to time he discovers a new relation between two words.He know that if two words have a relation between them, then each of them has relations with the words that has relations with the other. For example, if like means love and love is the opposite of hate, then like is also the opposite of hate. One more example: if love is the opposite of hate and hate is the opposite of like, then love means like, and so on.Sometimes Mahmoud discovers a wrong relation. A wrong relation is a relation that makes two words equal and opposite at the same time. For example if he knows that love means like and like is the opposite of hate, and then he figures out that hate means like, the last relation is absolutely wrong because it makes hate and like opposite and have the same meaning at the same time.After Mahmoud figured out many relations, he was worried that some of them were wrong so that they will make other relations also wrong, so he decided to tell every relation he figured out to his coder friend Ehab and for every relation he wanted to know is it correct or wrong, basing on the previously discovered relations. If it is wrong he ignores it, and doesn\'t check with following relations.After adding all relations, Mahmoud asked Ehab about relations between some words based on the information he had given to him. Ehab is busy making a Codeforces round so he asked you for help." 2000

766C "Mahmoud and a Message" "brute force,dp,greedy,strings" "Mahmoud wrote a message s of length n. He wants to send it as a birthday present to his friend Moaz who likes strings. He wrote it on a magical paper but he was surprised because some characters disappeared while writing the string. That\'s because this magical paper doesn\'t allow character number i in the English alphabet to be written on it in a string of length more than ai. For example, if a1\xe2\x80\x89=\xe2\x80\x892 he can\'t write character \'a\' on this paper in a string of length 3 or more. String ""aa"" is allowed while string ""aaa"" is not.Mahmoud decided to split the message into some non-empty substrings so that he can write every substring on an independent magical paper and fulfill the condition. The sum of their lengths should be n and they shouldn\'t overlap. For example, if a1\xe2\x80\x89=\xe2\x80\x892 and he wants to send string ""aaa"", he can split it into ""a"" and ""aa"" and use 2 magical papers, or into ""a"", ""a"" and ""a"" and use 3 magical papers. He can\'t split it into ""aa"" and ""aa"" because the sum of their lengths is greater than n. He can split the message into single string if it fulfills the conditions.A substring of string s is a string that consists of some consecutive characters from string s, strings ""ab"", ""abc"" and ""b"" are substrings of string ""abc"", while strings ""acb"" and ""ac"" are not. Any string is a substring of itself.While Mahmoud was thinking of how to split the message, Ehab told him that there are many ways to split it. After that Mahmoud asked you three questions:   How many ways are there to split the string into substrings such that every substring fulfills the condition of the magical paper, the sum of their lengths is n and they don\'t overlap? Compute the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.  What is the maximum length of a substring that can appear in some valid splitting?  What is the minimum number of substrings the message can be spit in? Two ways are considered different, if the sets of split positions differ. For example, splitting ""aa|a"" and ""a|aa"" are considered different splittings of message ""aaa""." 1700

766B "Mahmoud and a Triangle" "constructive algorithms,geometry,greedy,math,number theory,sortings" "Mahmoud has n line segments, the i-th of them has length ai. Ehab challenged him to use exactly 3 line segments to form a non-degenerate triangle. Mahmoud doesn\'t accept challenges unless he is sure he can win, so he asked you to tell him if he should accept the challenge. Given the lengths of the line segments, check if he can choose exactly 3 of them to form a non-degenerate triangle.Mahmoud should use exactly 3 line segments, he can\'t concatenate two line segments or change any length. A non-degenerate triangle is a triangle with positive area." 1000

766A "Mahmoud and Longest Uncommon Subsequence" "constructive algorithms,strings" "While Mahmoud and Ehab were practicing for IOI, they found a problem which name was Longest common subsequence. They solved it, and then Ehab challenged Mahmoud with another problem.Given two strings a and b, find the length of their longest uncommon subsequence, which is the longest string that is a subsequence of one of them and not a subsequence of the other.A subsequence of some string is a sequence of characters that appears in the same order in the string, The appearances don\'t have to be consecutive, for example, strings ""ac"", ""bc"", ""abc"" and ""a"" are subsequences of string ""abc"" while strings ""abbc"" and ""acb"" are not. The empty string is a subsequence of any string. Any string is a subsequence of itself." 1000

765G "Math, math everywhere" "brute force,dp,math,meet-in-the-middle,number theory" "If you have gone that far, you\'ll probably skip unnecessary legends anyway...You are given a binary string  and an integer . Find the number of integers k, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89N, such that for all i\xe2\x80\x89=\xe2\x80\x890, 1, ..., m\xe2\x80\x89-\xe2\x80\x891  Print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 3200

765F Souvenirs "data structures" "Artsem is on vacation and wants to buy souvenirs for his two teammates. There are n souvenir shops along the street. In i-th shop Artsem can buy one souvenir for ai dollars, and he cannot buy more than one souvenir in one shop. He doesn\'t want to introduce envy in his team, so he wants to buy two souvenirs with least possible difference in price.Artsem has visited the shopping street m times. For some strange reason on the i-th day only shops with numbers from li to ri were operating (weird? yes it is, but have you ever tried to come up with a reasonable legend for a range query problem?). For each visit, Artsem wants to know the minimum possible difference in prices of two different souvenirs he can buy in the opened shops.In other words, for each Artsem\'s visit you should find the minimum possible value of |as\xe2\x80\x89-\xe2\x80\x89at| where li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s,\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri, s\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t." 3100

765E "Tree Folding" "dfs and similar,dp,greedy,implementation,trees" "Vanya wants to minimize a tree. He can perform the following operation multiple times: choose a vertex v, and two disjoint (except for v) paths of equal length a0\xe2\x80\x89=\xe2\x80\x89v, a1, ..., ak, and b0\xe2\x80\x89=\xe2\x80\x89v, b1, ..., bk. Additionally, vertices a1, ..., ak, b1, ..., bk must not have any neighbours in the tree other than adjacent vertices of corresponding paths. After that, one of the paths may be merged into the other, that is, the vertices b1, ..., bk can be effectively erased:  Help Vanya determine if it possible to make the tree into a path via a sequence of described operations, and if the answer is positive, also determine the shortest length of such path." 2200

765D "Artsem and Saunders" "constructive algorithms,dsu,math" "Artsem has a friend Saunders from University of Chicago. Saunders presented him with the following problem.Let [n] denote the set {1,\xe2\x80\x89...,\xe2\x80\x89n}. We will also write f:\xe2\x80\x89[x]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[y] when a function f is defined in integer points 1, ..., x, and all its values are integers from 1 to y.Now then, you are given a function f:\xe2\x80\x89[n]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[n]. Your task is to find a positive integer m, and two functions g:\xe2\x80\x89[n]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[m], h:\xe2\x80\x89[m]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[n], such that g(h(x))\xe2\x80\x89=\xe2\x80\x89x for all , and h(g(x))\xe2\x80\x89=\xe2\x80\x89f(x) for all , or determine that finding these is impossible." 1700

765C "Table Tennis Game 2" math "Misha and Vanya have played several table tennis sets. Each set consists of several serves, each serve is won by one of the players, he receives one point and the loser receives nothing. Once one of the players scores exactly k points, the score is reset and a new set begins.Across all the sets Misha scored a points in total, and Vanya scored b points. Given this information, determine the maximum number of sets they could have played, or that the situation is impossible.Note that the game consisted of several complete sets." 1200

765B "Code obfuscation" greedy,implementation,strings "Kostya likes Codeforces contests very much. However, he is very disappointed that his solutions are frequently hacked. That\'s why he decided to obfuscate (intentionally make less readable) his code before upcoming contest.To obfuscate the code, Kostya first looks at the first variable name used in his program and replaces all its occurrences with a single symbol a, then he looks at the second variable name that has not been replaced yet, and replaces all its occurrences with b, and so on. Kostya is well-mannered, so he doesn\'t use any one-letter names before obfuscation. Moreover, there are at most 26 unique identifiers in his programs.You are given a list of identifiers of some program with removed spaces and line breaks. Check if this program can be a result of Kostya\'s obfuscation." 1100

765A "Neverending competitions" implementation,math "There are literally dozens of snooker competitions held each year, and team Jinotega tries to attend them all (for some reason they prefer name ""snookah"")! When a competition takes place somewhere far from their hometown, Ivan, Artsem and Konstantin take a flight to the contest and back.Jinotega\'s best friends, team Base have found a list of their itinerary receipts with information about departure and arrival airports. Now they wonder, where is Jinotega now: at home or at some competition far away? They know that:   this list contains all Jinotega\'s flights in this year (in arbitrary order),  Jinotega has only flown from his hometown to a snooker contest and back,  after each competition Jinotega flies back home (though they may attend a competition in one place several times),  and finally, at the beginning of the year Jinotega was at home. Please help them to determine Jinotega\'s location!" 900

764B "Timofey and cubes" "constructive algorithms,implementation" "Young Timofey has a birthday today! He got kit of n cubes as a birthday present from his parents. Every cube has a number ai, which is written on it. Timofey put all the cubes in a row and went to unpack other presents.In this time, Timofey\'s elder brother, Dima reordered the cubes using the following rule. Suppose the cubes are numbered from 1 to n in their order. Dima performs several steps, on step i he reverses the segment of cubes from i-th to (n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891)-th. He does this while i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891.After performing the operations Dima went away, being very proud of himself. When Timofey returned to his cubes, he understood that their order was changed. Help Timofey as fast as you can and save the holiday�\xe2\x80\x94 restore the initial order of the cubes using information of their current location." 900

764A "Taymyr is calling you" "brute force,implementation,math" "Comrade Dujikov is busy choosing artists for Timofey\'s birthday and is recieving calls from Taymyr from Ilia-alpinist.Ilia-alpinist calls every n minutes, i.e. in minutes n, 2n, 3n and so on. Artists come to the comrade every m minutes, i.e. in minutes m, 2m, 3m and so on. The day is z minutes long, i.e. the day consists of minutes 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89z. How many artists should be killed so that there are no artists in the room when Ilia calls? Consider that a call and a talk with an artist take exactly one minute." 800

763E "Timofey and our friends animals" "data structures,divide and conquer,dsu" "After his birthday party, Timofey went to his favorite tree alley in a park. He wants to feed there his favorite birds�\xe2\x80\x94 crows.It\'s widely known that each tree is occupied by a single crow family. The trees in the alley form a row and are numbered from 1 to n. Some families are friends to each other. For some reasons, two families can be friends only if they live not too far from each other, more precisely, there is no more than k\xe2\x80\x89-\xe2\x80\x891 trees between any pair of friend families. Formally, the family on the u-th tree and the family on the v-th tree can be friends only if |u\xe2\x80\x89-\xe2\x80\x89v|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k holds.One of the friendship features is that if some family learns that Timofey is feeding crows somewhere, it notifies about this all friend families. Thus, after Timofey starts to feed crows under some tree, all the families that are friends to the family living on this tree, as well as their friends and so on, fly to the feeding place. Of course, the family living on the tree also comes to the feeding place.Today Timofey came to the alley and noticed that all the families that live on trees with numbers strictly less than l or strictly greater than r have flown away. Thus, it is not possible to pass the information about feeding through them. Moreover, there is no need to feed them. Help Timofey to learn what is the minimum number of trees under which he has to feed crows so that all the families that have remained will get the information about feeding. You are given several situations, described by integers l and r, you need to calculate the answer for all of them." 2900

763D "Timofey and a flat tree" "data structures,graphs,hashing,shortest paths,trees" "Little Timofey has a big tree�\xe2\x80\x94 an undirected connected graph with n vertices and no simple cycles. He likes to walk along it. His tree is flat so when he walks along it he sees it entirely. Quite naturally, when he stands on a vertex, he sees the tree as a rooted tree with the root in this vertex.Timofey assumes that the more non-isomorphic subtrees are there in the tree, the more beautiful the tree is. A subtree of a vertex is a subgraph containing this vertex and all its descendants. You should tell Timofey the vertex in which he should stand to see the most beautiful rooted tree.Subtrees of vertices u and v are isomorphic if the number of children of u equals the number of children of v, and their children can be arranged in such a way that the subtree of the first son of u is isomorphic to the subtree of the first son of v, the subtree of the second son of u is isomorphic to the subtree of the second son of v, and so on. In particular, subtrees consisting of single vertex are isomorphic to each other." 2900

763C "Timofey and remoduling" "brute force,implementation,math,number theory" "Little Timofey likes integers a lot. Unfortunately, he is very young and can\'t work with very big integers, so he does all the operations modulo his favorite prime m. Also, Timofey likes to look for arithmetical progressions everywhere.One of his birthday presents was a sequence of distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Timofey wants to know whether he can rearrange the elements of the sequence so that is will be an arithmetical progression modulo m, or not.Arithmetical progression modulo m of length n with first element x and difference d is sequence of integers x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89d,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x892d,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89(n\xe2\x80\x89-\xe2\x80\x891)\xc2\xb7d, each taken modulo m." 2600

763B "Timofey and rectangles" "constructive algorithms,geometry" "One of Timofey\'s birthday presents is a colourbook in a shape of an infinite plane. On the plane n rectangles with sides parallel to coordinate axes are situated. All sides of the rectangles have odd length. Rectangles cannot intersect, but they can touch each other.Help Timofey to color his rectangles in 4 different colors in such a way that every two rectangles touching each other by side would have different color, or determine that it is impossible.Two rectangles intersect if their intersection has positive area. Two rectangles touch by sides if there is a pair of sides such that their intersection has non-zero length  The picture corresponds to the first example" 2100

763A "Timofey and a tree" "dfs and similar,dp,dsu,graphs,implementation,trees" "Each New Year Timofey and his friends cut down a tree of n vertices and bring it home. After that they paint all the n its vertices, so that the i-th vertex gets color ci.Now it\'s time for Timofey birthday, and his mother asked him to remove the tree. Timofey removes the tree in the following way: he takes some vertex in hands, while all the other vertices move down so that the tree becomes rooted at the chosen vertex. After that Timofey brings the tree to a trash can.Timofey doesn\'t like it when many colors are mixing together. A subtree annoys him if there are vertices of different color in it. Timofey wants to find a vertex which he should take in hands so that there are no subtrees that annoy him. He doesn\'t consider the whole tree as a subtree since he can\'t see the color of the root vertex.A subtree of some vertex is a subgraph containing that vertex and all its descendants.Your task is to determine if there is a vertex, taking which in hands Timofey wouldn\'t be annoyed." 1600

762F "Tree nesting" combinatorics,graphs,trees "You are given two trees (connected undirected acyclic graphs) S and T.Count the number of subtrees (connected subgraphs) of S that are isomorphic to tree T. Since this number can get quite large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897.Two subtrees of tree S are considered different, if there exists a vertex in S that belongs to exactly one of them.Tree G is called isomorphic to tree H if there exists a bijection f from the set of vertices of G to the set of vertices of H that has the following property: if there is an edge between vertices A and B in tree G, then there must be an edge between vertices f(A) and f(B) in tree H. And vice versa�\xe2\x80\x94 if there is an edge between vertices A and B in tree H, there must be an edge between f\xe2\x80\x89-\xe2\x80\x891(A) and f\xe2\x80\x89-\xe2\x80\x891(B) in tree G." 2800

762E "Radio stations" "binary search,data structures" "In the lattice points of the coordinate line there are n radio stations, the i-th of which is described by three integers:  xi \xe2\x80\x94 the coordinate of the i-th station on the line,  ri \xe2\x80\x94 the broadcasting range of the i-th station,  fi \xe2\x80\x94 the broadcasting frequency of the i-th station. We will say that two radio stations with numbers i and j reach each other, if the broadcasting range of each of them is more or equal to the distance between them. In other words min(ri,\xe2\x80\x89rj)\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89|xi\xe2\x80\x89-\xe2\x80\x89xj|.Let\'s call a pair of radio stations (i,\xe2\x80\x89j) bad if i\xe2\x80\x89<\xe2\x80\x89j, stations i and j reach each other and they are close in frequency, that is, |fi\xe2\x80\x89-\xe2\x80\x89fj|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k.Find the number of bad pairs of radio stations." 2200

762D "Maximum path" dp,greedy,implementation "You are given a rectangular table 3\xe2\x80\x89\xc3\x97\xe2\x80\x89n. Each cell contains an integer. You can move from one cell to another if they share a side.Find such path from the upper left cell to the bottom right cell of the table that doesn\'t visit any of the cells twice, and the sum of numbers written in the cells of this path is maximum possible." 2300

762C "Two strings" "binary search,hashing,strings,two pointers" "You are given two strings a and b. You have to remove the minimum possible number of consecutive (standing one after another) characters from string b in such a way that it becomes a subsequence of string a. It can happen that you will not need to remove any characters at all, or maybe you will have to remove all of the characters from b and make it empty.Subsequence of string s is any such string that can be obtained by erasing zero or more characters (not necessarily consecutive) from string s." 2100

762B "USB vs. PS/2" "greedy,implementation,sortings,two pointers" "Due to the increase in the number of students of Berland State University it was decided to equip a new computer room. You were given the task of buying mouses, and you have to spend as little as possible. After all, the country is in crisis!The computers bought for the room were different. Some of them had only USB ports, some�\xe2\x80\x94 only PS/2 ports, and some had both options.You have found a price list of a certain computer shop. In it, for m mouses it is specified the cost and the type of the port that is required to plug the mouse in (USB or PS/2). Each mouse from the list can be bought at most once.You want to buy some set of mouses from the given price list in such a way so that you maximize the number of computers equipped with mouses (it is not guaranteed that you will be able to equip all of the computers), and in case of equality of this value you want to minimize the total cost of mouses you will buy." 1400

762A "k-th divisor" "math,number theory" "You are given two integers n and k. Find k-th smallest divisor of n, or report that it doesn\'t exist.Divisor of n is any such natural number, that n can be divided by it without remainder." 1400

761F "Dasha and Photos" "brute force,data structures,dp,implementation" "Dasha decided to have a rest after solving the problem D and began to look photos from previous competitions.Let\'s call photos as the matrix with the size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, which consists of lowercase English letters.Some k photos especially interested her, because they can be received from photo-template by painting a rectangular area in a certain color. Let\'s call such photos special.   More formally the i-th special photo is received from the photo-template by replacing all characters on some rectangle with upper left corner of the cell with coordinates (ai,\xe2\x80\x89bi) and lower right corner in the cell with coordinates (ci,\xe2\x80\x89di) to the symbol ei.Dasha asks you to find the special photo so that the total distance from it to all other special photos is minimum. And calculate this distance.Determine the distance between two photos as the sum of distances between all corresponding letters. The distance between two letters is the difference module of their positions in the alphabet. For example, the distance between letters \'h\' and \'m\' equals |8\xe2\x80\x89-\xe2\x80\x8913|\xe2\x80\x89=\xe2\x80\x895, because the letter \'h\' is the 8-th in the alphabet, the letter \'m\' is the 13-th." 2600

761E "Dasha and Puzzle" "constructive algorithms,dfs and similar,graphs,greedy,trees" "Dasha decided to have a rest after solving the problem. She had been ready to start her favourite activity \xe2\x80\x94 origami, but remembered the puzzle that she could not solve.   The tree is a non-oriented connected graph without cycles. In particular, there always are n\xe2\x80\x89-\xe2\x80\x891 edges in a tree with n vertices.The puzzle is to position the vertices at the points of the Cartesian plane with integral coordinates, so that the segments between the vertices connected by edges are parallel to the coordinate axes. Also, the intersection of segments is allowed only at their ends. Distinct vertices should be placed at different points. Help Dasha to find any suitable way to position the tree vertices on the plane.It is guaranteed that if it is possible to position the tree vertices on the plane without violating the condition which is given above, then you can do it by using points with integral coordinates which don\'t exceed 1018 in absolute value." 2000

761D "Dasha and Very Difficult Problem" "binary search,brute force,constructive algorithms,greedy,sortings" "Dasha logged into the system and began to solve problems. One of them is as follows:Given two sequences a and b of length n each you need to write a sequence c of length n, the i-th element of which is calculated as follows: ci\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x89ai.About sequences a and b we know that their elements are in the range from l to r. More formally, elements satisfy the following conditions: l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. About sequence c we know that all its elements are distinct.  Dasha wrote a solution to that problem quickly, but checking her work on the standard test was not so easy. Due to an error in the test system only the sequence a and the compressed sequence of the sequence c were known from that test.Let\'s give the definition to a compressed sequence. A compressed sequence of sequence c of length n is a sequence p of length n, so that pi equals to the number of integers which are less than or equal to ci in the sequence c. For example, for the sequence c\xe2\x80\x89=\xe2\x80\x89[250,\xe2\x80\x89200,\xe2\x80\x89300,\xe2\x80\x89100,\xe2\x80\x8950] the compressed sequence will be p\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x893,\xe2\x80\x895,\xe2\x80\x892,\xe2\x80\x891]. Pay attention that in c all integers are distinct. Consequently, the compressed sequence contains all integers from 1 to n inclusively.Help Dasha to find any sequence b for which the calculated compressed sequence of sequence c is correct." 1700

761C "Dasha and Password" "brute force,dp,implementation" "After overcoming the stairs Dasha came to classes. She needed to write a password to begin her classes. The password is a string of length n which satisfies the following requirements:  There is at least one digit in the string,  There is at least one lowercase (small) letter of the Latin alphabet in the string,  There is at least one of three listed symbols in the string: \'#\', \'*\', \'&\'.   Considering that these are programming classes it is not easy to write the password.For each character of the password we have a fixed string of length m, on each of these n strings there is a pointer on some character. The i-th character displayed on the screen is the pointed character in the i-th string. Initially, all pointers are on characters with indexes 1 in the corresponding strings (all positions are numbered starting from one).During one operation Dasha can move a pointer in one string one character to the left or to the right. Strings are cyclic, it means that when we move the pointer which is on the character with index 1 to the left, it moves to the character with the index m, and when we move it to the right from the position m it moves to the position 1.You need to determine the minimum number of operations necessary to make the string displayed on the screen a valid password." 1500

761B "Dasha and friends" "brute force,implementation,math" "Running with barriers on the circle track is very popular in the country where Dasha lives, so no wonder that on her way to classes she saw the following situation:The track is the circle with length L, in distinct points of which there are n barriers. Athlete always run the track in counterclockwise direction if you look on him from above. All barriers are located at integer distance from each other along the track. Her friends the parrot Kefa and the leopard Sasha participated in competitions and each of them ran one lap. Each of the friends started from some integral point on the track. Both friends wrote the distance from their start along the track to each of the n barriers. Thus, each of them wrote n integers in the ascending order, each of them was between 0 and L\xe2\x80\x89-\xe2\x80\x891, inclusively.  Consider an example. Let L\xe2\x80\x89=\xe2\x80\x898, blue points are barriers, and green points are Kefa\'s start (A) and Sasha\'s start (B). Then Kefa writes down the sequence [2,\xe2\x80\x894,\xe2\x80\x896], and Sasha writes down [1,\xe2\x80\x895,\xe2\x80\x897]. There are several tracks in the country, all of them have same length and same number of barriers, but the positions of the barriers can differ among different tracks. Now Dasha is interested if it is possible that Kefa and Sasha ran the same track or they participated on different tracks. Write the program which will check that Kefa\'s and Sasha\'s tracks coincide (it means that one can be obtained from the other by changing the start position). Note that they always run the track in one direction \xe2\x80\x94 counterclockwise, if you look on a track from above." 1300

761A "Dasha and Stairs" "brute force,constructive algorithms,implementation,math" "On her way to programming school tiger Dasha faced her first test \xe2\x80\x94 a huge staircase!  The steps were numbered from one to infinity. As we know, tigers are very fond of all striped things, it is possible that it has something to do with their color. So on some interval of her way she calculated two values \xe2\x80\x94 the number of steps with even and odd numbers. You need to check whether there is an interval of steps from the l-th to the r-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), for which values that Dasha has found are correct." 1000

760B "Frodo and pillows" "binary search,greedy" "n hobbits are planning to spend the night at Frodo\'s house. Frodo has n beds standing in a row and m pillows (n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Each hobbit needs a bed and at least one pillow to sleep, however, everyone wants as many pillows as possible. Of course, it\'s not always possible to share pillows equally, but any hobbit gets hurt if he has at least two pillows less than some of his neighbors have. Frodo will sleep on the k-th bed in the row. What is the maximum number of pillows he can have so that every hobbit has at least one pillow, every pillow is given to some hobbit and no one is hurt?" 1500

760A "Petr and a calendar" implementation,math "Petr wants to make a calendar for current month. For this purpose he draws a table in which columns correspond to weeks (a week is seven consequent days from Monday to Sunday), rows correspond to weekdays, and cells contain dates. For example, a calendar for January 2017 should look like on the picture:  Petr wants to know how many columns his table should have given the month and the weekday of the first date of that month? Assume that the year is non-leap." 800

758F "Geometrical Progression" "brute force,math,number theory" "For given n, l and r find the number of distinct geometrical progression, each of which contains n distinct integers not less than l and not greater than r. In other words, for each progression the following must hold: l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89aj , where a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is the geometrical progression, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j.Geometrical progression is a sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an where each term after first is found by multiplying the previous one by a fixed non-zero number d called the common ratio. Note that in our task d may be non-integer. For example in progression 4,\xe2\x80\x896,\xe2\x80\x899, common ratio is .Two progressions a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn are considered different, if there is such i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) that ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi." 2400

758E "Broken Tree" "dfs and similar,dp,graphs,greedy,trees" "You are given a tree that has n vertices, which are numbered from 1 to n, where the vertex number one is the root. Each edge has weight wi and strength pi.Botanist Innokentiy, who is the only member of the jury of the Olympiad in Informatics, doesn\'t like broken trees. The tree is broken if there is such an edge the strength of which is less than the sum of weight of subtree\'s edges to which it leads.It is allowed to reduce weight of any edge by arbitrary integer value, but then the strength of its edge is reduced by the same value. It means if the weight of the edge is 10, and the strength is 12, then by the reducing the weight by 7 its weight will equal 3, and the strength will equal 5. It is not allowed to increase the weight of the edge.Your task is to get the tree, which is not broken, by reducing the weight of edges of the given tree, and also all edged should have the positive weight, moreover, the total weight of all edges should be as large as possible.It is obvious that the strength of edges can not be negative, however it can equal zero if the weight of the subtree equals zero." 2600

758D "Ability To Convert" "constructive algorithms,dp,greedy,math,strings" "Alexander is learning how to convert numbers from the decimal system to any other, however, he doesn\'t know English letters, so he writes any number only as a decimal number, it means that instead of the letter A he will write the number 10. Thus, by converting the number 475 from decimal to hexadecimal system, he gets 11311 (475\xe2\x80\x89=\xe2\x80\x891\xc2\xb7162\xe2\x80\x89+\xe2\x80\x8913\xc2\xb7161\xe2\x80\x89+\xe2\x80\x8911\xc2\xb7160). Alexander lived calmly until he tried to convert the number back to the decimal number system.Alexander remembers that he worked with little numbers so he asks to find the minimum decimal number so that by converting it to the system with the base n he will get the number k." 2000

758C "Unfair Poll" "binary search,constructive algorithms,implementation,math" "On the Literature lesson Sergei noticed an awful injustice, it seems that some students are asked more often than others.Seating in the class looks like a rectangle, where n rows with m pupils in each. The teacher asks pupils in the following order: at first, she asks all pupils from the first row in the order of their seating, then she continues to ask pupils from the next row. If the teacher asked the last row, then the direction of the poll changes, it means that she asks the previous row. The order of asking the rows looks as follows: the 1-st row, the 2-nd row, ..., the n\xe2\x80\x89-\xe2\x80\x891-st row, the n-th row, the n\xe2\x80\x89-\xe2\x80\x891-st row, ..., the 2-nd row, the 1-st row, the 2-nd row, ...The order of asking of pupils on the same row is always the same: the 1-st pupil, the 2-nd pupil, ..., the m-th pupil.During the lesson the teacher managed to ask exactly k questions from pupils in order described above. Sergei seats on the x-th row, on the y-th place in the row. Sergei decided to prove to the teacher that pupils are asked irregularly, help him count three values:  the maximum number of questions a particular pupil is asked,  the minimum number of questions a particular pupil is asked,  how many times the teacher asked Sergei. If there is only one row in the class, then the teacher always asks children from this row." 1700

758B "Blown Garland" "brute force,implementation,number theory" "Nothing is eternal in the world, Kostya understood it on the 7-th of January when he saw partially dead four-color garland.Now he has a goal to replace dead light bulbs, however he doesn\'t know how many light bulbs for each color are required. It is guaranteed that for each of four colors at least one light is working.It is known that the garland contains light bulbs of four colors: red, blue, yellow and green. The garland is made as follows: if you take any four consecutive light bulbs then there will not be light bulbs with the same color among them. For example, the garland can look like ""RYBGRYBGRY"", ""YBGRYBGRYBG"", ""BGRYB"", but can not look like ""BGRYG"", ""YBGRYBYGR"" or ""BGYBGY"". Letters denote colors: \'R\'�\xe2\x80\x94 red, \'B\'�\xe2\x80\x94 blue, \'Y\'�\xe2\x80\x94 yellow, \'G\'�\xe2\x80\x94 green.Using the information that for each color at least one light bulb still works count the number of dead light bulbs of each four colors." 1100

758A "Holiday Of Equality" implementation,math "In Berland it is the holiday of equality. In honor of the holiday the king decided to equalize the welfare of all citizens in Berland by the expense of the state treasury. Totally in Berland there are n citizens, the welfare of each of them is estimated as the integer in ai burles (burle is the currency in Berland).You are the royal treasurer, which needs to count the minimum charges of the kingdom on the king\'s present. The king can only give money, he hasn\'t a power to take away them." 800

757G "Can Bash Save the Day?" "data structures,divide and conquer,graphs,trees" "Whoa! You did a great job helping Team Rocket who managed to capture all the Pokemons sent by Bash. Meowth, part of Team Rocket, having already mastered the human language, now wants to become a master in programming as well. He agrees to free the Pokemons if Bash can answer his questions.Initially, Meowth gives Bash a weighted tree containing n nodes and a sequence a1,\xe2\x80\x89a2...,\xe2\x80\x89an which is a permutation of 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n. Now, Mewoth makes q queries of one of the following forms:  1 l r v: meaning Bash should report , where dist(a,\xe2\x80\x89b) is the length of the shortest path from node a to node b in the given tree.   2 x: meaning Bash should swap ax and ax\xe2\x80\x89+\xe2\x80\x891 in the given sequence. This new sequence is used for later queries. Help Bash to answer the questions!" 3400

757F "Team Rocket Rises Again" "data structures,graphs,shortest paths" "It\'s the turn of the year, so Bash wants to send presents to his friends. There are n cities in the Himalayan region and they are connected by m bidirectional roads. Bash is living in city s. Bash has exactly one friend in each of the other cities. Since Bash wants to surprise his friends, he decides to send a Pikachu to each of them. Since there may be some cities which are not reachable from Bash\'s city, he only sends a Pikachu to those friends who live in a city reachable from his own city. He also wants to send it to them as soon as possible.He finds out the minimum time for each of his Pikachus to reach its destination city. Since he is a perfectionist, he informs all his friends with the time their gift will reach them. A Pikachu travels at a speed of 1 meters per second. His friends were excited to hear this and would be unhappy if their presents got delayed. Unfortunately Team Rocket is on the loose and they came to know of Bash\'s plan. They want to maximize the number of friends who are unhappy with Bash.They do this by destroying exactly one of the other n\xe2\x80\x89-\xe2\x80\x891 cities. This implies that the friend residing in that city dies, so he is unhappy as well.Note that if a city is destroyed, all the roads directly connected to the city are also destroyed and the Pikachu may be forced to take a longer alternate route.Please also note that only friends that are waiting for a gift count as unhappy, even if they die.Since Bash is already a legend, can you help Team Rocket this time and find out the maximum number of Bash\'s friends who can be made unhappy by destroying exactly one city." 2800

757E "Bash Plays with Functions" "brute force,combinatorics,dp,number theory" "Bash got tired on his journey to become the greatest Pokemon master. So he decides to take a break and play with functions.Bash defines a function f0(n), which denotes the number of ways of factoring n into two factors p and q such that gcd(p,\xe2\x80\x89q)\xe2\x80\x89=\xe2\x80\x891. In other words, f0(n) is the number of ordered pairs of positive integers (p,\xe2\x80\x89q) such that p\xc2\xb7q\xe2\x80\x89=\xe2\x80\x89n and gcd(p,\xe2\x80\x89q)\xe2\x80\x89=\xe2\x80\x891.But Bash felt that it was too easy to calculate this function. So he defined a series of functions, where fr\xe2\x80\x89+\xe2\x80\x891 is defined as:Where (u,\xe2\x80\x89v) is any ordered pair of positive integers, they need not to be co-prime.Now Bash wants to know the value of fr(n) for different r and n. Since the value could be huge, he would like to know the value modulo 109\xe2\x80\x89+\xe2\x80\x897. Help him!" 2500

757D "Felicity\'s Big Secret Revealed" bitmasks,dp "Bash got tired on his journey to become the greatest Pokemon master. So he decides to take a break and play with functions.Bash defines a function f0(n), which denotes the number of ways of factoring n into two factors p and q such that gcd(p,\xe2\x80\x89q)\xe2\x80\x89=\xe2\x80\x891. In other words, f0(n) is the number of ordered pairs of positive integers (p,\xe2\x80\x89q) such that p\xc2\xb7q\xe2\x80\x89=\xe2\x80\x89n and gcd(p,\xe2\x80\x89q)\xe2\x80\x89=\xe2\x80\x891.But Bash felt that it was too easy to calculate this function. So he defined a series of functions, where fr\xe2\x80\x89+\xe2\x80\x891 is defined as:Where (u,\xe2\x80\x89v) is any ordered pair of positive integers, they need not to be co-prime.Now Bash wants to know the value of fr(n) for different r and n. Since the value could be huge, he would like to know the value modulo 109\xe2\x80\x89+\xe2\x80\x897. Help him!" 2200

757C "Felicity is Coming!" "data structures,hashing,sortings,strings" "It\'s that time of the year, Felicity is around the corner and you can see people celebrating all around the Himalayan region. The Himalayan region has n gyms. The i-th gym has gi Pokemon in it. There are m distinct Pokemon types in the Himalayan region numbered from 1 to m. There is a special evolution camp set up in the fest which claims to evolve any Pokemon. The type of a Pokemon could change after evolving, subject to the constraint that if two Pokemon have the same type before evolving, they will have the same type after evolving. Also, if two Pokemon have different types before evolving, they will have different types after evolving. It is also possible that a Pokemon has the same type before and after evolving. Formally, an evolution plan is a permutation f of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89m}, such that f(x)\xe2\x80\x89=\xe2\x80\x89y means that a Pokemon of type x evolves into a Pokemon of type y.The gym leaders are intrigued by the special evolution camp and all of them plan to evolve their Pokemons. The protocol of the mountain states that in each gym, for every type of Pokemon, the number of Pokemon of that type before evolving any Pokemon should be equal the number of Pokemon of that type after evolving all the Pokemons according to the evolution plan. They now want to find out how many distinct evolution plans exist which satisfy the protocol.Two evolution plans f1 and f2 are distinct, if they have at least one Pokemon type evolving into a different Pokemon type in the two plans, i. e. there exists an i such that f1(i)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89f2(i).Your task is to find how many distinct evolution plans are possible such that if all Pokemon in all the gyms are evolved, the number of Pokemon of each type in each of the gyms remains the same. As the answer can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 1900

757B "Bash\'s Big Day" "greedy,math,number theory" "It\'s that time of the year, Felicity is around the corner and you can see people celebrating all around the Himalayan region. The Himalayan region has n gyms. The i-th gym has gi Pokemon in it. There are m distinct Pokemon types in the Himalayan region numbered from 1 to m. There is a special evolution camp set up in the fest which claims to evolve any Pokemon. The type of a Pokemon could change after evolving, subject to the constraint that if two Pokemon have the same type before evolving, they will have the same type after evolving. Also, if two Pokemon have different types before evolving, they will have different types after evolving. It is also possible that a Pokemon has the same type before and after evolving. Formally, an evolution plan is a permutation f of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89m}, such that f(x)\xe2\x80\x89=\xe2\x80\x89y means that a Pokemon of type x evolves into a Pokemon of type y.The gym leaders are intrigued by the special evolution camp and all of them plan to evolve their Pokemons. The protocol of the mountain states that in each gym, for every type of Pokemon, the number of Pokemon of that type before evolving any Pokemon should be equal the number of Pokemon of that type after evolving all the Pokemons according to the evolution plan. They now want to find out how many distinct evolution plans exist which satisfy the protocol.Two evolution plans f1 and f2 are distinct, if they have at least one Pokemon type evolving into a different Pokemon type in the two plans, i. e. there exists an i such that f1(i)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89f2(i).Your task is to find how many distinct evolution plans are possible such that if all Pokemon in all the gyms are evolved, the number of Pokemon of each type in each of the gyms remains the same. As the answer can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 1400

757A "Gotta Catch Em\' All!" implementation "It\'s that time of the year, Felicity is around the corner and you can see people celebrating all around the Himalayan region. The Himalayan region has n gyms. The i-th gym has gi Pokemon in it. There are m distinct Pokemon types in the Himalayan region numbered from 1 to m. There is a special evolution camp set up in the fest which claims to evolve any Pokemon. The type of a Pokemon could change after evolving, subject to the constraint that if two Pokemon have the same type before evolving, they will have the same type after evolving. Also, if two Pokemon have different types before evolving, they will have different types after evolving. It is also possible that a Pokemon has the same type before and after evolving. Formally, an evolution plan is a permutation f of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89m}, such that f(x)\xe2\x80\x89=\xe2\x80\x89y means that a Pokemon of type x evolves into a Pokemon of type y.The gym leaders are intrigued by the special evolution camp and all of them plan to evolve their Pokemons. The protocol of the mountain states that in each gym, for every type of Pokemon, the number of Pokemon of that type before evolving any Pokemon should be equal the number of Pokemon of that type after evolving all the Pokemons according to the evolution plan. They now want to find out how many distinct evolution plans exist which satisfy the protocol.Two evolution plans f1 and f2 are distinct, if they have at least one Pokemon type evolving into a different Pokemon type in the two plans, i. e. there exists an i such that f1(i)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89f2(i).Your task is to find how many distinct evolution plans are possible such that if all Pokemon in all the gyms are evolved, the number of Pokemon of each type in each of the gyms remains the same. As the answer can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 1000

756F "Long number" "expression parsing,math,number theory" "Consider the following grammar: <expression> ::= <term> | <expression> \'+\' <term> <term> ::= <number> | <number> \'-\' <number> | <number> \'(\' <expression> \')\' <number> ::= <pos_digit> | <number> <digit> <digit> ::= \'0\' | <pos_digit> <pos_digit> ::= \'1\' | \'2\' | \'3\' | \'4\' | \'5\' | \'6\' | \'7\' | \'8\' | \'9\'This grammar describes a number in decimal system using the following rules: <number> describes itself, <number>-<number> (l-r, l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) describes integer which is concatenation of all integers from l to r, written without leading zeros. For example, 8-11 describes 891011, <number>(<expression>) describes integer which is concatenation of <number> copies of integer described by <expression>, <expression>+<term> describes integer which is concatenation of integers described by <expression> and <term>.For example, 2(2-4+1)+2(2(17)) describes the integer 2341234117171717.You are given an expression in the given grammar. Print the integer described by it modulo 109\xe2\x80\x89+\xe2\x80\x897." 3400

756E "Byteland coins" combinatorics,dp,math "There are n types of coins in Byteland. Conveniently, the denomination of the coin type k divides the denomination of the coin type k\xe2\x80\x89+\xe2\x80\x891, the denomination of the coin type 1 equals 1 tugrick. The ratio of the denominations of coin types k\xe2\x80\x89+\xe2\x80\x891 and k equals ak. It is known that for each x there are at most 20 coin types of denomination x.Byteasar has bk coins of type k with him, and he needs to pay exactly m tugricks. It is known that Byteasar never has more than 3\xc2\xb7105 coins with him. Byteasar want to know how many ways there are to pay exactly m tugricks. Two ways are different if there is an integer k such that the amount of coins of type k differs in these two ways. As all Byteland citizens, Byteasar wants to know the number of ways modulo 109\xe2\x80\x89+\xe2\x80\x897." 3200

756D "Bacterial Melee" "brute force,combinatorics,dp,string suffix structures" "Julia is conducting an experiment in her lab. She placed several luminescent bacterial colonies in a horizontal testtube. Different types of bacteria can be distinguished by the color of light they emit. Julia marks types of bacteria with small Latin letters ""a"", ..., ""z"".The testtube is divided into n consecutive regions. Each region is occupied by a single colony of a certain bacteria type at any given moment. Hence, the population of the testtube at any moment can be described by a string of n Latin characters.Sometimes a colony can decide to conquer another colony in one of the adjacent regions. When that happens, the attacked colony is immediately eliminated and replaced by a colony of the same type as the attacking colony, while the attacking colony keeps its type. Note that a colony can only attack its neighbours within the boundaries of the testtube. At any moment, at most one attack can take place.For example, consider a testtube with population ""babb"". There are six options for an attack that may happen next: the first colony attacks the second colony (1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x892), the resulting population is ""bbbb""; 2\xe2\x80\x89\xe2\x86\x92\xe2\x80\x891, the result is ""aabb""; 2\xe2\x80\x89\xe2\x86\x92\xe2\x80\x893, the result is ""baab""; 3\xe2\x80\x89\xe2\x86\x92\xe2\x80\x892, the result is ""bbbb"" (note that the result is the same as the first option); 3\xe2\x80\x89\xe2\x86\x92\xe2\x80\x894 or 4\xe2\x80\x89\xe2\x86\x92\xe2\x80\x893, the population does not change.The pattern of attacks is rather unpredictable. Julia is now wondering how many different configurations of bacteria in the testtube she can obtain after a sequence of attacks takes place (it is possible that no attacks will happen at all). Since this number can be large, find it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2400

756C "Nikita and stack" "data structures" "Nikita has a stack. A stack in this problem is a data structure that supports two operations. Operation push(x) puts an integer x on the top of the stack, and operation pop() deletes the top integer from the stack, i.�e. the last added. If the stack is empty, then the operation pop() does nothing.Nikita made m operations with the stack but forgot them. Now Nikita wants to remember them. He remembers them one by one, on the i-th step he remembers an operation he made pi-th. In other words, he remembers the operations in order of some permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pm. After each step Nikita wants to know what is the integer on the top of the stack after performing the operations he have already remembered, in the corresponding order. Help him!" 2200

756B "Travel Card" "binary search,dp" "A new innovative ticketing systems for public transport is introduced in Bytesburg. Now there is a single travel card for all transport. To make a trip a passenger scan his card and then he is charged according to the fare.The fare is constructed in the following manner. There are three types of tickets:   a ticket for one trip costs 20 byteland rubles,  a ticket for 90 minutes costs 50 byteland rubles,  a ticket for one day (1440 minutes) costs 120 byteland rubles. Note that a ticket for x minutes activated at time t can be used for trips started in time range from t to t\xe2\x80\x89+\xe2\x80\x89x\xe2\x80\x89-\xe2\x80\x891, inclusive. Assume that all trips take exactly one minute.To simplify the choice for the passenger, the system automatically chooses the optimal tickets. After each trip starts, the system analyses all the previous trips and the current trip and chooses a set of tickets for these trips with a minimum total cost. Let the minimum total cost of tickets to cover all trips from the first to the current is a, and the total sum charged before is b. Then the system charges the passenger the sum a\xe2\x80\x89-\xe2\x80\x89b.You have to write a program that, for given trips made by a passenger, calculates the sum the passenger is charged after each trip." 1600

756A "Pavel and barbecue" "constructive algorithms,dfs and similar" "Pavel cooks barbecue. There are n skewers, they lay on a brazier in a row, each on one of n positions. Pavel wants each skewer to be cooked some time in every of n positions in two directions: in the one it was directed originally and in the reversed direction.Pavel has a plan: a permutation p and a sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, consisting of zeros and ones. Each second Pavel move skewer on position i to position pi, and if bi equals 1 then he reverses it. So he hope that every skewer will visit every position in both directions.Unfortunately, not every pair of permutation p and sequence b suits Pavel. What is the minimum total number of elements in the given permutation p and the given sequence b he needs to change so that every skewer will visit each of 2n placements? Note that after changing the permutation should remain a permutation as well.There is no problem for Pavel, if some skewer visits some of the placements several times before he ends to cook. In other words, a permutation p and a sequence b suit him if there is an integer k (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892n), so that after k seconds each skewer visits each of the 2n placements.It can be shown that some suitable pair of permutation p and sequence b exists for any n." 1700

755G "PolandBall and Many Other Balls" "combinatorics,divide and conquer,dp,fft,math,number theory" "PolandBall is standing in a row with Many Other Balls. More precisely, there are exactly n Balls. Balls are proud of their home land�\xe2\x80\x94 and they want to prove that it\'s strong.The Balls decided to start with selecting exactly m groups of Balls, each consisting either of single Ball or two neighboring Balls. Each Ball can join no more than one group.The Balls really want to impress their Enemies. They kindly asked you to calculate number of such divisions for all m where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k. Output all these values modulo 998244353, the Enemies will be impressed anyway." 3200

755F "PolandBall and Gifts" bitmasks,dp,greedy "It\'s Christmas time! PolandBall and his friends will be giving themselves gifts. There are n Balls overall. Each Ball has someone for whom he should bring a present according to some permutation p, pi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i for all i.Unfortunately, Balls are quite clumsy. We know earlier that exactly k of them will forget to bring their gift. A Ball number i will get his present if the following two constraints will hold:   Ball number i will bring the present he should give.  Ball x such that px\xe2\x80\x89=\xe2\x80\x89i will bring his present. What is minimum and maximum possible number of kids who will not get their present if exactly k Balls will forget theirs?" 2600

755E "PolandBall and White-Red graph" "constructive algorithms,graphs,shortest paths" "PolandBall has an undirected simple graph consisting of n vertices. Unfortunately, it has no edges. The graph is very sad because of that. PolandBall wanted to make it happier, adding some red edges. Then, he will add white edges in every remaining place. Therefore, the final graph will be a clique in two colors: white and red. Colorfulness of the graph is a value min(dr,\xe2\x80\x89dw), where dr is the diameter of the red subgraph and dw is the diameter of white subgraph. The diameter of a graph is a largest value d such that shortest path between some pair of vertices in it is equal to d. If the graph is not connected, we consider its diameter to be -1.PolandBall wants the final graph to be as neat as possible. He wants the final colorfulness to be equal to k. Can you help him and find any graph which satisfies PolandBall\'s requests?" 2400

755D "PolandBall and Polygon" "data structures" "PolandBall has such a convex polygon with n veritces that no three of its diagonals intersect at the same point. PolandBall decided to improve it and draw some red segments. He chose a number k such that gcd(n,\xe2\x80\x89k)\xe2\x80\x89=\xe2\x80\x891. Vertices of the polygon are numbered from 1 to n in a clockwise way. PolandBall repeats the following process n times, starting from the vertex 1: Assume you\'ve ended last operation in vertex x (consider x\xe2\x80\x89=\xe2\x80\x891 if it is the first operation). Draw a new segment from vertex x to k-th next vertex in clockwise direction. This is a vertex x\xe2\x80\x89+\xe2\x80\x89k or x\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x89n depending on which of these is a valid index of polygon\'s vertex.Your task is to calculate number of polygon\'s sections after each drawing. A section is a clear area inside the polygon bounded with drawn diagonals or the polygon\'s sides." 2000

755C "PolandBall and Forest" "dfs and similar,dsu,graphs,interactive,trees" "PolandBall lives in a forest with his family. There are some trees in the forest. Trees are undirected acyclic graphs with k vertices and k\xe2\x80\x89-\xe2\x80\x891 edges, where k is some integer. Note that one vertex is a valid tree.There is exactly one relative living in each vertex of each tree, they have unique ids from 1 to n. For each Ball i we know the id of its most distant relative living on the same tree. If there are several such vertices, we only know the value of the one with smallest id among those.How many trees are there in the forest?" 1300

755B "PolandBall and Game" "binary search,data structures,games,greedy,sortings,strings" "PolandBall is playing a game with EnemyBall. The rules are simple. Players have to say words in turns. You cannot say a word which was already said. PolandBall starts. The Ball which can\'t say a new word loses.You\'re given two lists of words familiar to PolandBall and EnemyBall. Can you determine who wins the game, if both play optimally?" 1100

755A "PolandBall and Hypothesis" "brute force,graphs,math,number theory" "PolandBall is a young, clever Ball. He is interested in prime numbers. He has stated a following hypothesis: ""There exists such a positive integer n that for each positive integer m number n\xc2\xb7m\xe2\x80\x89+\xe2\x80\x891 is a prime number"".Unfortunately, PolandBall is not experienced yet and doesn\'t know that his hypothesis is incorrect. Could you prove it wrong? Write a program that finds a counterexample for any n." 800

754E "Dasha and cyclic table" "bitmasks,brute force,fft,strings,trees" "Dasha is fond of challenging puzzles: Rubik\'s Cube 3\xe2\x80\x89\xc3\x97\xe2\x80\x893\xe2\x80\x89\xc3\x97\xe2\x80\x893, 4\xe2\x80\x89\xc3\x97\xe2\x80\x894\xe2\x80\x89\xc3\x97\xe2\x80\x894, 5\xe2\x80\x89\xc3\x97\xe2\x80\x895\xe2\x80\x89\xc3\x97\xe2\x80\x895 and so on. This time she has a cyclic table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, and each cell of the table contains a lowercase English letter. Each cell has coordinates (i,\xe2\x80\x89j) (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89m). The table is cyclic means that to the right of cell (i,\xe2\x80\x89j) there is the cell , and to the down there is the cell .Dasha has a pattern as well. A pattern is a non-cyclic table of size r\xe2\x80\x89\xc3\x97\xe2\x80\x89c. Each cell is either a lowercase English letter or a question mark. Each cell has coordinates (i,\xe2\x80\x89j) (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89r, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89c).The goal of the puzzle is to find all the appearance positions of the pattern in the cyclic table.We say that the cell (i,\xe2\x80\x89j) of cyclic table is an appearance position, if for every pair (x,\xe2\x80\x89y) such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89r and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89<\xe2\x80\x89c one of the following conditions holds:   There is a question mark in the cell (x,\xe2\x80\x89y) of the pattern, or  The cell  of the cyclic table equals to the cell (x,\xe2\x80\x89y) of the pattern. Dasha solved this puzzle in no time, as well as all the others she ever tried. Can you solve it?." 2600

754D "Fedor and coupons" "binary search,data structures,greedy,sortings" "All our characters have hobbies. The same is true for Fedor. He enjoys shopping in the neighboring supermarket. The goods in the supermarket have unique integer ids. Also, for every integer there is a product with id equal to this integer. Fedor has n discount coupons, the i-th of them can be used with products with ids ranging from li to ri, inclusive. Today Fedor wants to take exactly k coupons with him.Fedor wants to choose the k coupons in such a way that the number of such products x that all coupons can be used with this product x is as large as possible (for better understanding, see examples). Fedor wants to save his time as well, so he asks you to choose coupons for him. Help Fedor!" 2100

754C "Vladik and chat" "brute force,constructive algorithms,dp,implementation,strings" "Recently Vladik discovered a new entertainment�\xe2\x80\x94 coding bots for social networks. He would like to use machine learning in his bots so now he want to prepare some learning data for them.At first, he need to download t chats. Vladik coded a script which should have downloaded the chats, however, something went wrong. In particular, some of the messages have no information of their sender. It is known that if a person sends several messages in a row, they all are merged into a single message. It means that there could not be two or more messages in a row with the same sender. Moreover, a sender never mention himself in his messages.Vladik wants to recover senders of all the messages so that each two neighboring messages will have different senders and no sender will mention himself in his messages.He has no idea of how to do this, and asks you for help. Help Vladik to recover senders in each of the chats!" 2200

754B "Ilya and tic-tac-toe game" "brute force,implementation" "Ilya is an experienced player in tic-tac-toe on the 4\xe2\x80\x89\xc3\x97\xe2\x80\x894 field. He always starts and plays with Xs. He played a lot of games today with his friend Arseny. The friends became tired and didn\'t finish the last game. It was Ilya\'s turn in the game when they left it. Determine whether Ilya could have won the game by making single turn or not. The rules of tic-tac-toe on the 4\xe2\x80\x89\xc3\x97\xe2\x80\x894 field are as follows. Before the first turn all the field cells are empty. The two players take turns placing their signs into empty cells (the first player places Xs, the second player places Os). The player who places Xs goes first, the another one goes second. The winner is the player who first gets three of his signs in a row next to each other (horizontal, vertical or diagonal)." 1100

754A "Lesha and array splitting" "constructive algorithms,greedy,implementation" "One spring day on his way to university Lesha found an array A. Lesha likes to split arrays into several parts. This time Lesha decided to split the array A into several, possibly one, new arrays so that the sum of elements in each of the new arrays is not zero. One more condition is that if we place the new arrays one after another they will form the old array A.Lesha is tired now so he asked you to split the array. Help Lesha!" 1200

753C "Interactive Bulls and Cows (Hard)" "brute force,constructive algorithms,interactive" "The only difference from the previous problem is the constraint on the number of requests. In this problem your program should guess the answer doing at most 7 requests.This problem is a little bit unusual. Here you are to implement an interaction with a testing system. That means that you can make queries and get responses in the online mode. Please be sure to use the stream flushing operation after each query\'s output in order not to leave part of your output in some buffer. For example, in C++ you\'ve got to use the fflush(stdout) function, in Java \xe2\x80\x94 call System.out.flush(), and in Pascal \xe2\x80\x94 flush(output).Bulls and Cows (also known as Cows and Bulls or Pigs and Bulls or Bulls and Cleots) is an old code-breaking paper and pencil game for two players, predating the similar commercially marketed board game Mastermind.On a sheet of paper, the first player thinks a secret string. This string consists only of digits and has the length 4. The digits in the string must be all different, no two or more equal digits are allowed.Then the second player tries to guess his opponent\'s string. For every guess the first player gives the number of matches. If the matching digits are on their right positions, they are ""bulls"", if on different positions, they are ""cows"". Thus a response is a pair of numbers \xe2\x80\x94 the number of ""bulls"" and the number of ""cows"". A try can contain equal digits.More formally, let\'s the secret string is s and the second player are trying to guess it with a string x. The number of ""bulls"" is a number of such positions i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894) where s[i]\xe2\x80\x89=\xe2\x80\x89x[i]. The number of ""cows"" is a number of such digits c that s contains c in the position i (i.e. s[i]\xe2\x80\x89=\xe2\x80\x89c), x contains c, but x[i]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89c.For example, the secret string is ""0427"", the opponent\'s try is ""0724"", then the answer is 2 bulls and 2 cows (the bulls are ""0"" and ""2"", the cows are ""4"" and ""7""). If the secret string is ""0123"", the opponent\'s try is ""0330"", then the answer is 1 bull and 1 cow.In this problem you are to guess the string s that the system has chosen. You only know that the chosen string consists of 4 distinct digits.You can make queries to the testing system, each query is the output of a single 4-digit string. The answer to the query is the number of bulls and number of cows. If the system\'s response equals ""4 0"", that means the interaction with your problem is over and the program must terminate. That is possible for two reasons \xe2\x80\x94 the program either guessed the number x or made an invalid action (for example, printed letters instead of digits).Your program is allowed to do at most 7 queries.You can hack solutions of other participants providing a 4-digit string containing distinct digits \xe2\x80\x94 the secret string." 2500

753B "Interactive Bulls and Cows (Easy)" "brute force,constructive algorithms,implementation" "This problem is a little bit unusual. Here you are to implement an interaction with a testing system. That means that you can make queries and get responses in the online mode. Please be sure to use the stream flushing operation after each query\'s output in order not to leave part of your output in some buffer. For example, in C++ you\'ve got to use the fflush(stdout) function, in Java \xe2\x80\x94 call System.out.flush(), and in Pascal \xe2\x80\x94 flush(output).Bulls and Cows (also known as Cows and Bulls or Pigs and Bulls or Bulls and Cleots) is an old code-breaking paper and pencil game for two players, predating the similar commercially marketed board game Mastermind.On a sheet of paper, the first player thinks a secret string. This string consists only of digits and has the length 4. The digits in the string must be all different, no two or more equal digits are allowed.Then the second player tries to guess his opponent\'s string. For every guess the first player gives the number of matches. If the matching digits are on their right positions, they are ""bulls"", if on different positions, they are ""cows"". Thus a response is a pair of numbers \xe2\x80\x94 the number of ""bulls"" and the number of ""cows"". A try can contain equal digits.More formally, let\'s the secret string is s and the second player are trying to guess it with a string x. The number of ""bulls"" is a number of such positions i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894) where s[i]\xe2\x80\x89=\xe2\x80\x89x[i]. The number of ""cows"" is a number of such digits c that s contains c in the position i (i.e. s[i]\xe2\x80\x89=\xe2\x80\x89c), x contains c, but x[i]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89c.For example, the secret string is ""0427"", the opponent\'s try is ""0724"", then the answer is 2 bulls and 2 cows (the bulls are ""0"" and ""2"", the cows are ""4"" and ""7""). If the secret string is ""0123"", the opponent\'s try is ""0330"", then the answer is 1 bull and 1 cow.In this problem you are to guess the string s that the system has chosen. You only know that the chosen string consists of 4 distinct digits.You can make queries to the testing system, each query is the output of a single 4-digit string. The answer to the query is the number of bulls and number of cows. If the system\'s response equals ""4 0"", that means the interaction with your problem is over and the program must terminate. That is possible for two reasons \xe2\x80\x94 the program either guessed the number x or made an invalid action (for example, printed letters instead of digits).Your program is allowed to do at most 50 queries.You can hack solutions of other participants providing a 4-digit string containing distinct digits \xe2\x80\x94 the secret string." 1600

753A "Santa Claus and Candies" dp,greedy,math "Santa Claus has n candies, he dreams to give them as gifts to children.What is the maximal number of children for whose he can give candies if Santa Claus want each kid should get distinct positive integer number of candies. Santa Class wants to give all n candies he has." 1000

750H "New Year and Snowy Grid" "dfs and similar,dsu,graphs,interactive" "Pay attention to the output section below, where you will see the information about flushing the output.Bearland is a grid with h rows and w columns. Rows are numbered 1 through h from top to bottom. Columns are numbered 1 through w from left to right. Every cell is either allowed (denoted by \'.\' in the input) or permanently blocked (denoted by \'#\').Bearland is a cold land, where heavy snow often makes travelling harder. Every day a few allowed cells are temporarily blocked by snow. Note, that this block works only on this particular day and next day any of these cells might be allowed again (unless there is another temporarily block).It\'s possible to move directly between two cells only if they share a side and none of them is permanently or temporarily blocked.Limak is a little polar bear who lives in Bearland. His house is at the top left cell, while his school is at the bottom right cell. Every day Limak should first go from his house to the school and then return back to his house. Since he gets bored easily, he doesn\'t want to visit the same cell twice on one day, except for the cell with his house, where he starts and ends. If Limak can reach a school and return home avoiding revisiting cells, he calls a day interesting.There are q days you must process, one after another. For each of these days you should check if it\'s interesting and print ""YES"" or ""NO"" on a separate line. In order to be able to read the description of the next day you should print the answer for the previous one and flush the output.It\'s guaranteed that a day with no cells temporarily blocked by snow would be interesting. It\'s also guaranteed that cells with Limak\'s house and school are never blocked (neither permanently or temporarily)." 3500

750G "New Year and Binary Tree Paths" "bitmasks,brute force,combinatorics,dp" "The New Year tree is an infinite perfect binary tree rooted in the node 1. Each node v has two children: nodes indexed (2\xc2\xb7v) and (2\xc2\xb7v\xe2\x80\x89+\xe2\x80\x891).  Polar bears love decorating the New Year tree and Limak is no exception. As he is only a little bear, he was told to decorate only one simple path between some pair of nodes. Though he was given an opportunity to pick the pair himself! Now he wants to know the number of unordered pairs of indices (u,\xe2\x80\x89v) (u\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v), such that the sum of indices of all nodes along the simple path between u and v (including endpoints) is equal to s. Can you help him and count this value?" 3200

750F "New Year and Finding Roots" "constructive algorithms,implementation,interactive,trees" "This is an interactive problem. In the interaction section below you will find the information about flushing the output.The New Year tree of height h is a perfect binary tree with vertices numbered 1 through 2h\xe2\x80\x89-\xe2\x80\x891 in some order. In this problem we assume that h is at least 2. The drawing below shows one example New Year tree of height 3:  Polar bears love decorating the New Year tree and Limak is no exception. To decorate the tree, he must first find its root, i.e. a vertex with exactly two neighbours (assuming that h\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892). It won\'t be easy because Limak is a little bear and he doesn\'t even see the whole tree. Can you help him?There are t testcases. In each testcase, you should first read h from the input. Then you can ask at most 16 questions of format ""? x"" (without quotes), where x is an integer between 1 and 2h\xe2\x80\x89-\xe2\x80\x891, inclusive. As a reply you will get the list of neighbours of vertex x (more details in the ""Interaction"" section below). For example, for a tree on the drawing above after asking ""? 1"" you would get a response with 3 neighbours: 4, 5 and 7. Your goal is to find the index of the root y and print it in the format ""! y"". You will be able to read h for a next testcase only after printing the answer in a previous testcase and flushing the output.Each tree is fixed from the beginning and it doesn\'t change during your questions." 2800

750E "New Year and Old Subsequence" "data structures,divide and conquer,dp,matrices" "A string t is called nice if a string ""2017"" occurs in t as a subsequence but a string ""2016"" doesn\'t occur in t as a subsequence. For example, strings ""203434107"" and ""9220617"" are nice, while strings ""20016"", ""1234"" and ""20167"" aren\'t nice.The ugliness of a string is the minimum possible number of characters to remove, in order to obtain a nice string. If it\'s impossible to make a string nice by removing characters, its ugliness is \xe2\x80\x89-\xe2\x80\x891.Limak has a string s of length n, with characters indexed 1 through n. He asks you q queries. In the i-th query you should compute and print the ugliness of a substring (continuous subsequence) of s starting at the index ai and ending at the index bi (inclusive)." 2600

750D "New Year and Fireworks" "brute force,data structures,dfs and similar,dp,implementation" "One tradition of welcoming the New Year is launching fireworks into the sky. Usually a launched firework flies vertically upward for some period of time, then explodes, splitting into several parts flying in different directions. Sometimes those parts also explode after some period of time, splitting into even more parts, and so on.Limak, who lives in an infinite grid, has a single firework. The behaviour of the firework is described with a recursion depth n and a duration for each level of recursion t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. Once Limak launches the firework in some cell, the firework starts moving upward. After covering t1 cells (including the starting cell), it explodes and splits into two parts, each moving in the direction changed by 45 degrees (see the pictures below for clarification). So, one part moves in the top-left direction, while the other one moves in the top-right direction. Each part explodes again after covering t2 cells, splitting into two parts moving in directions again changed by 45 degrees. The process continues till the n-th level of recursion, when all 2n\xe2\x80\x89-\xe2\x80\x891 existing parts explode and disappear without creating new parts. After a few levels of recursion, it\'s possible that some parts will be at the same place and at the same time�\xe2\x80\x94 it is allowed and such parts do not crash.Before launching the firework, Limak must make sure that nobody stands in cells which will be visited at least once by the firework. Can you count the number of those cells?" 1900

750C "New Year and Rating" "binary search,greedy,math" "Every Codeforces user has rating, described with one integer, possibly negative or zero. Users are divided into two divisions. The first division is for users with rating 1900 or higher. Those with rating 1899 or lower belong to the second division. In every contest, according to one\'s performance, his or her rating changes by some value, possibly negative or zero.Limak competed in n contests in the year 2016. He remembers that in the i-th contest he competed in the division di (i.e. he belonged to this division just before the start of this contest) and his rating changed by ci just after the contest. Note that negative ci denotes the loss of rating.What is the maximum possible rating Limak can have right now, after all n contests? If his rating may be arbitrarily big, print ""Infinity"". If there is no scenario matching the given information, print ""Impossible""." 1600

750B "New Year and North Pole" geometry,implementation "In this problem we assume the Earth to be a completely round ball and its surface a perfect sphere. The length of the equator and any meridian is considered to be exactly 40\xe2\x80\x89000 kilometers. Thus, travelling from North Pole to South Pole or vice versa takes exactly 20\xe2\x80\x89000 kilometers.Limak, a polar bear, lives on the North Pole. Close to the New Year, he helps somebody with delivering packages all around the world. Instead of coordinates of places to visit, Limak got a description how he should move, assuming that he starts from the North Pole. The description consists of n parts. In the i-th part of his journey, Limak should move ti kilometers in the direction represented by a string diri that is one of: ""North"", ""South"", ""West"", ""East"".Limak isn\xe2\x80\x99t sure whether the description is valid. You must help him to check the following conditions:  If at any moment of time (before any of the instructions or while performing one of them) Limak is on the North Pole, he can move only to the South.  If at any moment of time (before any of the instructions or while performing one of them) Limak is on the South Pole, he can move only to the North.  The journey must end on the North Pole. Check if the above conditions are satisfied and print ""YES"" or ""NO"" on a single line." 1300

750A "New Year and Hurry" "binary search,brute force,implementation,math" "Limak is going to participate in a contest on the last day of the 2016. The contest will start at 20:00 and will last four hours, exactly until midnight. There will be n problems, sorted by difficulty, i.e. problem 1 is the easiest and problem n is the hardest. Limak knows it will take him 5\xc2\xb7i minutes to solve the i-th problem.Limak\'s friends organize a New Year\'s Eve party and Limak wants to be there at midnight or earlier. He needs k minutes to get there from his house, where he will participate in the contest first.How many problems can Limak solve if he wants to make it to the party?" 800

749E "Inversions After Shuffle" "data structures,probabilities" "You are given a permutation of integers from 1 to n. Exactly once you apply the following operation to this permutation: pick a random segment and shuffle its elements. Formally:  Pick a random segment (continuous subsequence) from l to r. All  segments are equiprobable.  Let k\xe2\x80\x89=\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891, i.e. the length of the chosen segment. Pick a random permutation of integers from 1 to k, p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk. All k! permutation are equiprobable.  This permutation is applied to elements of the chosen segment, i.e. permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89ar,\xe2\x80\x89ar\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89an is transformed to a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89al\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89p1,\xe2\x80\x89al\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89al\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89pk\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89al\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89pk,\xe2\x80\x89ar\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89an. Inversion if a pair of elements (not necessary neighbouring) with the wrong relative order. In other words, the number of inversion is equal to the number of pairs (i,\xe2\x80\x89j) such that i\xe2\x80\x89<\xe2\x80\x89j and ai\xe2\x80\x89>\xe2\x80\x89aj. Find the expected number of inversions after we apply exactly one operation mentioned above." 2400

749D "Leaving Auction" "binary search,data structures" "There are n people taking part in auction today. The rules of auction are classical. There were n bids made, though it\'s not guaranteed they were from different people. It might happen that some people made no bids at all.Each bid is define by two integers (ai,\xe2\x80\x89bi), where ai is the index of the person, who made this bid and bi is its size. Bids are given in chronological order, meaning bi\xe2\x80\x89<\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x891 for all i\xe2\x80\x89<\xe2\x80\x89n. Moreover, participant never makes two bids in a row (no one updates his own bid), i.e. ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 for all i\xe2\x80\x89<\xe2\x80\x89n.Now you are curious with the following question: who (and which bid) will win the auction if some participants were absent? Consider that if someone was absent, all his bids are just removed and no new bids are added.Note, that if during this imaginary exclusion of some participants it happens that some of the remaining participants makes a bid twice (or more times) in a row, only first of these bids is counted. For better understanding take a look at the samples.You have several questions in your mind, compute the answer for each of them." 2000

749C Voting "greedy,implementation,two pointers" "There are n employees in Alternative Cake Manufacturing (ACM). They are now voting on some very important question and the leading world media are trying to predict the outcome of the vote.Each of the employees belongs to one of two fractions: depublicans or remocrats, and these two fractions have opposite opinions on what should be the outcome of the vote. The voting procedure is rather complicated:   Each of n employees makes a statement. They make statements one by one starting from employees 1 and finishing with employee n. If at the moment when it\'s time for the i-th employee to make a statement he no longer has the right to vote, he just skips his turn (and no longer takes part in this voting).  When employee makes a statement, he can do nothing or declare that one of the other employees no longer has a right to vote. It\'s allowed to deny from voting people who already made the statement or people who are only waiting to do so. If someone is denied from voting he no longer participates in the voting till the very end.  When all employees are done with their statements, the procedure repeats: again, each employees starting from 1 and finishing with n who are still eligible to vote make their statements.  The process repeats until there is only one employee eligible to vote remaining and he determines the outcome of the whole voting. Of course, he votes for the decision suitable for his fraction. You know the order employees are going to vote and that they behave optimal (and they also know the order and who belongs to which fraction). Predict the outcome of the vote." 1500

749B "Parallelogram is Back" "brute force,constructive algorithms,geometry" "Long time ago Alex created an interesting problem about parallelogram. The input data for this problem contained four integer points on the Cartesian plane, that defined the set of vertices of some non-degenerate (positive area) parallelogram. Points not necessary were given in the order of clockwise or counterclockwise traversal.Alex had very nice test for this problem, but is somehow happened that the last line of the input was lost and now he has only three out of four points of the original parallelogram. He remembers that test was so good that he asks you to restore it given only these three points." 1200

749A "Bachgold Problem" "greedy,implementation,math,number theory" "Bachgold problem is very easy to formulate. Given a positive integer n represent it as a sum of maximum possible number of prime numbers. One can prove that such representation exists for any integer greater than 1.Recall that integer k is called prime if it is greater than 1 and has exactly two positive integer divisors�\xe2\x80\x94 1 and k." 800

748F "Santa Clauses and a Soccer Championship" "constructive algorithms,dfs and similar,graphs,trees" "The country Treeland consists of n cities connected with n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads in such a way that it\'s possible to reach every city starting from any other city using these roads. There will be a soccer championship next year, and all participants are Santa Clauses. There are exactly 2k teams from 2k different cities.During the first stage all teams are divided into k pairs. Teams of each pair play two games against each other: one in the hometown of the first team, and the other in the hometown of the other team. Thus, each of the 2k cities holds exactly one soccer game. However, it\'s not decided yet how to divide teams into pairs.It\'s also necessary to choose several cities to settle players in. Organizers tend to use as few cities as possible to settle the teams.Nobody wants to travel too much during the championship, so if a team plays in cities u and v, it wants to live in one of the cities on the shortest path between u and v (maybe, in u or in v). There is another constraint also: the teams from one pair must live in the same city.Summarizing, the organizers want to divide 2k teams into pairs and settle them in the minimum possible number of cities m in such a way that teams from each pair live in the same city which lies between their hometowns." 2300

748E "Santa Claus and Tangerines" "binary search,data structures,greedy,two pointers" "Santa Claus has n tangerines, and the i-th of them consists of exactly ai slices. Santa Claus came to a school which has k pupils. Santa decided to treat them with tangerines.However, there can be too few tangerines to present at least one tangerine to each pupil. So Santa decided to divide tangerines into parts so that no one will be offended. In order to do this, he can divide a tangerine or any existing part into two smaller equal parts. If the number of slices in the part he wants to split is odd, then one of the resulting parts will have one slice more than the other. It\'s forbidden to divide a part consisting of only one slice.Santa Claus wants to present to everyone either a whole tangerine or exactly one part of it (that also means that everyone must get a positive number of slices). One or several tangerines or their parts may stay with Santa.Let bi be the number of slices the i-th pupil has in the end. Let Santa\'s joy be the minimum among all bi\'s.Your task is to find the maximum possible joy Santa can have after he treats everyone with tangerines (or their parts)." 2100

748D "Santa Claus and a Palindrome" "constructive algorithms,data structures,greedy" "Santa Claus likes palindromes very much. There was his birthday recently. k of his friends came to him to congratulate him, and each of them presented to him a string si having the same length n. We denote the beauty of the i-th string by ai. It can happen that ai is negative�\xe2\x80\x94 that means that Santa doesn\'t find this string beautiful at all.Santa Claus is crazy about palindromes. He is thinking about the following question: what is the maximum possible total beauty of a palindrome which can be obtained by concatenating some (possibly all) of the strings he has? Each present can be used at most once. Note that all strings have the same length n.Recall that a palindrome is a string that doesn\'t change after one reverses it.Since the empty string is a palindrome too, the answer can\'t be negative. Even if all ai\'s are negative, Santa can obtain the empty string." 2100

748C "Santa Claus and Robot" "constructive algorithms,math" "Santa Claus has Robot which lives on the infinite grid and can move along its lines. He can also, having a sequence of m points p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pm with integer coordinates, do the following: denote its initial location by p0. First, the robot will move from p0 to p1 along one of the shortest paths between them (please notice that since the robot moves only along the grid lines, there can be several shortest paths). Then, after it reaches p1, it\'ll move to p2, again, choosing one of the shortest ways, then to p3, and so on, until he has visited all points in the given order. Some of the points in the sequence may coincide, in that case Robot will visit that point several times according to the sequence order.While Santa was away, someone gave a sequence of points to Robot. This sequence is now lost, but Robot saved the protocol of its unit movements. Please, find the minimum possible length of the sequence." 1400

748B "Santa Claus and Keyboard Check" implementation,strings "Santa Claus decided to disassemble his keyboard to clean it. After he returned all the keys back, he suddenly realized that some pairs of keys took each other\'s place! That is, Santa suspects that each key is either on its place, or on the place of another key, which is located exactly where the first key should be. In order to make sure that he\'s right and restore the correct order of keys, Santa typed his favorite patter looking only to his keyboard.You are given the Santa\'s favorite patter and the string he actually typed. Determine which pairs of keys could be mixed. Each key must occur in pairs at most once." 1500

748A "Santa Claus and a Place in a Class" implementation,math "Santa Claus is the first who came to the Christmas Olympiad, and he is going to be the first to take his place at a desk! In the classroom there are n lanes of m desks each, and there are two working places at each of the desks. The lanes are numbered from 1 to n from the left to the right, the desks in a lane are numbered from 1 to m starting from the blackboard. Note that the lanes go perpendicularly to the blackboard, not along it (see picture).The organizers numbered all the working places from 1 to 2nm. The places are numbered by lanes (i.�e. all the places of the first lane go first, then all the places of the second lane, and so on), in a lane the places are numbered starting from the nearest to the blackboard (i.�e. from the first desk in the lane), at each desk, the place on the left is numbered before the place on the right.  The picture illustrates the first and the second samples. Santa Clause knows that his place has number k. Help him to determine at which lane at which desk he should sit, and whether his place is on the left or on the right!" 800

747F "Igor and Interesting Numbers" "brute force,combinatorics,dp,math" "Igor likes hexadecimal notation and considers positive integer in the hexadecimal notation interesting if each digit and each letter in it appears no more than t times. For example, if t\xe2\x80\x89=\xe2\x80\x893, then integers 13a13322, aaa, abcdef0123456789 are interesting, but numbers aaaa, abababab and 1000000 are not interesting.Your task is to find the k-th smallest interesting for Igor integer in the hexadecimal notation. The integer should not contain leading zeros." 2500

747E Comments "dfs and similar,expression parsing,implementation,strings" "A rare article in the Internet is posted without a possibility to comment it. On a Polycarp\'s website each article has comments feed.Each comment on Polycarp\'s website is a non-empty string consisting of uppercase and lowercase letters of English alphabet. Comments have tree-like structure, that means each comment except root comments (comments of the highest level) has exactly one parent comment.When Polycarp wants to save comments to his hard drive he uses the following format. Each comment he writes in the following format:   at first, the text of the comment is written;  after that the number of comments is written, for which this comment is a parent comment (i.�e. the number of the replies to this comments);  after that the comments for which this comment is a parent comment are written (the writing of these comments uses the same algorithm).  All elements in this format are separated by single comma. Similarly, the comments of the first level are separated by comma.For example, if the comments look like:  then the first comment is written as ""hello,2,ok,0,bye,0"", the second is written as ""test,0"", the third comment is written as ""one,1,two,2,a,0,b,0"". The whole comments feed is written as: ""hello,2,ok,0,bye,0,test,0,one,1,two,2,a,0,b,0"". For a given comments feed in the format specified above print the comments in a different format:   at first, print a integer d�\xe2\x80\x94 the maximum depth of nesting comments;  after that print d lines, the i-th of them corresponds to nesting level i;  for the i-th row print comments of nesting level i in the order of their appearance in the Policarp\'s comments feed, separated by space." 1700

747D "Winter Is Coming" dp,greedy,sortings "The winter in Berland lasts n days. For each day we know the forecast for the average air temperature that day. Vasya has a new set of winter tires which allows him to drive safely no more than k days at any average air temperature. After k days of using it (regardless of the temperature of these days) the set of winter tires wears down and cannot be used more. It is not necessary that these k days form a continuous segment of days.Before the first winter day Vasya still uses summer tires. It is possible to drive safely on summer tires any number of days when the average air temperature is non-negative. It is impossible to drive on summer tires at days when the average air temperature is negative. Vasya can change summer tires to winter tires and vice versa at the beginning of any day.Find the minimum number of times Vasya needs to change summer tires to winter tires and vice versa to drive safely during the winter. At the end of the winter the car can be with any set of tires." 1800

747C Servers implementation "There are n servers in a laboratory, each of them can perform tasks. Each server has a unique id�\xe2\x80\x94 integer from 1 to n.It is known that during the day q tasks will come, the i-th of them is characterized with three integers: ti�\xe2\x80\x94 the moment in seconds in which the task will come, ki�\xe2\x80\x94 the number of servers needed to perform it, and di�\xe2\x80\x94 the time needed to perform this task in seconds. All ti are distinct.To perform the i-th task you need ki servers which are unoccupied in the second ti. After the servers begin to perform the task, each of them will be busy over the next di seconds. Thus, they will be busy in seconds ti,\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89-\xe2\x80\x891. For performing the task, ki servers with the smallest ids will be chosen from all the unoccupied servers. If in the second ti there are not enough unoccupied servers, the task is ignored.Write the program that determines which tasks will be performed and which will be ignored." 1300

747B "Mammoth\'s Genome Decoding" implementation,strings "There are n servers in a laboratory, each of them can perform tasks. Each server has a unique id�\xe2\x80\x94 integer from 1 to n.It is known that during the day q tasks will come, the i-th of them is characterized with three integers: ti�\xe2\x80\x94 the moment in seconds in which the task will come, ki�\xe2\x80\x94 the number of servers needed to perform it, and di�\xe2\x80\x94 the time needed to perform this task in seconds. All ti are distinct.To perform the i-th task you need ki servers which are unoccupied in the second ti. After the servers begin to perform the task, each of them will be busy over the next di seconds. Thus, they will be busy in seconds ti,\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89-\xe2\x80\x891. For performing the task, ki servers with the smallest ids will be chosen from all the unoccupied servers. If in the second ti there are not enough unoccupied servers, the task is ignored.Write the program that determines which tasks will be performed and which will be ignored." 900

747A "Display Size" "brute force,math" "A big company decided to launch a new series of rectangular displays, and decided that the display must have exactly n pixels. Your task is to determine the size of the rectangular display \xe2\x80\x94 the number of lines (rows) of pixels a and the number of columns of pixels b, so that:  there are exactly n pixels on the display;  the number of rows does not exceed the number of columns, it means a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b;  the difference b\xe2\x80\x89-\xe2\x80\x89a is as small as possible." 800

746G "New Roads" "constructive algorithms,graphs,trees" "There are n cities in Berland, each of them has a unique id�\xe2\x80\x94 an integer from 1 to n, the capital is the one with id 1. Now there is a serious problem in Berland with roads�\xe2\x80\x94 there are no roads.That is why there was a decision to build n\xe2\x80\x89-\xe2\x80\x891 roads so that there will be exactly one simple path between each pair of cities.In the construction plan t integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89at were stated, where t equals to the distance from the capital to the most distant city, concerning new roads. ai equals the number of cities which should be at the distance i from the capital. The distance between two cities is the number of roads one has to pass on the way from one city to another. Also, it was decided that among all the cities except the capital there should be exactly k cities with exactly one road going from each of them. Such cities are dead-ends and can\'t be economically attractive. In calculation of these cities the capital is not taken into consideration regardless of the number of roads from it. Your task is to offer a plan of road\'s construction which satisfies all the described conditions or to inform that it is impossible." 2100

746F "Music in Car" "data structures,greedy,two pointers" "Sasha reaches the work by car. It takes exactly k minutes. On his way he listens to music. All songs in his playlist go one by one, after listening to the i-th song Sasha gets a pleasure which equals ai. The i-th song lasts for ti minutes. Before the beginning of his way Sasha turns on some song x and then he listens to the songs one by one: at first, the song x, then the song (x\xe2\x80\x89+\xe2\x80\x891), then the song number (x\xe2\x80\x89+\xe2\x80\x892), and so on. He listens to songs until he reaches the work or until he listens to the last song in his playlist. Sasha can listen to each song to the end or partly.In the second case he listens to the song for integer number of minutes, at least half of the song\'s length. Formally, if the length of the song equals d minutes, Sasha listens to it for no less than  minutes, then he immediately switches it to the next song (if there is such). For example, if the length of the song which Sasha wants to partly listen to, equals 5 minutes, then he should listen to it for at least 3 minutes, if the length of the song equals 8 minutes, then he should listen to it for at least 4 minutes.It takes no time to switch a song.Sasha wants to listen partly no more than w songs. If the last listened song plays for less than half of its length, then Sasha doesn\'t get pleasure from it and that song is not included to the list of partly listened songs. It is not allowed to skip songs. A pleasure from a song does not depend on the listening mode, for the i-th song this value equals ai.Help Sasha to choose such x and no more than w songs for partial listening to get the maximum pleasure. Write a program to find the maximum pleasure Sasha can get from the listening to the songs on his way to the work." 2200

746E "Numbers Exchange" greedy,implementation,math "Eugeny has n cards, each of them has exactly one integer written on it. Eugeny wants to exchange some cards with Nikolay so that the number of even integers on his cards would equal the number of odd integers, and that all these numbers would be distinct. Nikolay has m cards, distinct numbers from 1 to m are written on them, one per card. It means that Nikolay has exactly one card with number 1, exactly one card with number 2 and so on. A single exchange is a process in which Eugeny gives one card to Nikolay and takes another one from those Nikolay has. Your task is to find the minimum number of card exchanges and determine which cards Eugeny should exchange." 1900

746D "Green and Black Tea" "constructive algorithms,greedy,math" "Innokentiy likes tea very much and today he wants to drink exactly n cups of tea. He would be happy to drink more but he had exactly n tea bags, a of them are green and b are black.Innokentiy doesn\'t like to drink the same tea (green or black) more than k times in a row. Your task is to determine the order of brewing tea bags so that Innokentiy will be able to drink n cups of tea, without drinking the same tea more than k times in a row, or to inform that it is impossible. Each tea bag has to be used exactly once." 1500

746C Tram "constructive algorithms,implementation,math" "The tram in Berland goes along a straight line from the point 0 to the point s and back, passing 1 meter per t1 seconds in both directions. It means that the tram is always in the state of uniform rectilinear motion, instantly turning around at points x\xe2\x80\x89=\xe2\x80\x890 and x\xe2\x80\x89=\xe2\x80\x89s.Igor is at the point x1. He should reach the point x2. Igor passes 1 meter per t2 seconds. Your task is to determine the minimum time Igor needs to get from the point x1 to the point x2, if it is known where the tram is and in what direction it goes at the moment Igor comes to the point x1.Igor can enter the tram unlimited number of times at any moment when his and the tram\'s positions coincide. It is not obligatory that points in which Igor enter and exit the tram are integers. Assume that any boarding and unboarding happens instantly. Igor can move arbitrary along the line (but not faster than 1 meter per t2 seconds). He can also stand at some point for some time." 1600

746B Decoding implementation,strings "Polycarp is mad about coding, that is why he writes Sveta encoded messages. He calls the median letter in a word the letter which is in the middle of the word. If the word\'s length is even, the median letter is the left of the two middle letters. In the following examples, the median letter is highlighted: contest, info. If the word consists of single letter, then according to above definition this letter is the median letter. Polycarp encodes each word in the following way: he writes down the median letter of the word, then deletes it and repeats the process until there are no letters left. For example, he encodes the word volga as logva.You are given an encoding s of some word, your task is to decode it." 900

746A Compote implementation,math "Nikolay has a lemons, b apples and c pears. He decided to cook a compote. According to the recipe the fruits should be in the ratio 1:\xe2\x80\x892:\xe2\x80\x894. It means that for each lemon in the compote should be exactly 2 apples and exactly 4 pears. You can\'t crumble up, break up or cut these fruits into pieces. These fruits�\xe2\x80\x94 lemons, apples and pears�\xe2\x80\x94 should be put in the compote as whole fruits.Your task is to determine the maximum total number of lemons, apples and pears from which Nikolay can cook the compote. It is possible that Nikolay can\'t use any fruits, in this case print 0." 800

745B "Hongcow Solves A Puzzle" implementation "Hongcow likes solving puzzles.One day, Hongcow finds two identical puzzle pieces, with the instructions ""make a rectangle"" next to them. The pieces can be described by an n by m grid of characters, where the character \'X\' denotes a part of the puzzle and \'.\' denotes an empty part of the grid. It is guaranteed that the puzzle pieces are one 4-connected piece. See the input format and samples for the exact details on how a jigsaw piece will be specified.The puzzle pieces are very heavy, so Hongcow cannot rotate or flip the puzzle pieces. However, he is allowed to move them in any directions. The puzzle pieces also cannot overlap.You are given as input the description of one of the pieces. Determine if it is possible to make a rectangle from two identical copies of the given input. The rectangle should be solid, i.e. there should be no empty holes inside it or on its border. Keep in mind that Hongcow is not allowed to flip or rotate pieces and they cannot overlap, i.e. no two \'X\' from different pieces can share the same position." 1400

745A "Hongcow Learns the Cyclic Shift" implementation,strings "Hongcow is learning to spell! One day, his teacher gives him a word that he needs to learn to spell. Being a dutiful student, he immediately learns how to spell the word.Hongcow has decided to try to make new words from this one. He starts by taking the word he just learned how to spell, and moves the last character of the word to the beginning of the word. He calls this a cyclic shift. He can apply cyclic shift many times. For example, consecutively applying cyclic shift operation to the word ""abracadabra"" Hongcow will get words ""aabracadabr"", ""raabracadab"" and so on.Hongcow is now wondering how many distinct words he can generate by doing the cyclic shift arbitrarily many times. The initial string is also counted." 900

744E "Hongcow Masters the Cyclic Shift" "strings,two pointers" "Hongcow\'s teacher heard that Hongcow had learned about the cyclic shift, and decided to set the following problem for him.You are given a list of n strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn contained in the list A.A list X of strings is called stable if the following condition holds.First, a message is defined as a concatenation of some elements of the list X. You can use an arbitrary element as many times as you want, and you may concatenate these elements in any arbitrary order. Let SX denote the set of of all messages you can construct from the list. Of course, this set has infinite size if your list is nonempty.Call a single message good if the following conditions hold:   Suppose the message is the concatenation of k strings w1,\xe2\x80\x89w2,\xe2\x80\x89...,\xe2\x80\x89wk, where each wi is an element of X.  Consider the |w1|\xe2\x80\x89+\xe2\x80\x89|w2|\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89|wk| cyclic shifts of the string. Let m be the number of these cyclic shifts of the string that are elements of SX.  A message is good if and only if m is exactly equal to k. The list X is called stable if and only if every element of SX is good.Let f(L) be 1 if L is a stable list, and 0 otherwise.Find the sum of f(L) where L is a nonempty contiguous sublist of A (there are  contiguous sublists in total)." 3200

744D "Hongcow Draws a Circle" geometry "Hongcow really likes the color red. Hongcow doesn\'t like the color blue.Hongcow is standing in an infinite field where there are n red points and m blue points.Hongcow wants to draw a circle in the field such that this circle contains at least one red point, and no blue points. Points that line exactly on the boundary of the circle can be counted as either inside or outside.Compute the radius of the largest circle that satisfies this condition. If this circle can have arbitrarily large size, print \xe2\x80\x89-\xe2\x80\x891. Otherwise, your answer will be accepted if it has relative or absolute error at most 10\xe2\x80\x89-\xe2\x80\x894." 3200

744C "Hongcow Buys a Deck of Cards" "bitmasks,brute force,dp" "One day, Hongcow goes to the store and sees a brand new deck of n special cards. Each individual card is either red or blue. He decides he wants to buy them immediately. To do this, he needs to play a game with the owner of the store.This game takes some number of turns to complete. On a turn, Hongcow may do one of two things:   Collect tokens. Hongcow collects 1 red token and 1 blue token by choosing this option (thus, 2 tokens in total per one operation).  Buy a card. Hongcow chooses some card and spends tokens to purchase it as specified below. The i-th card requires ri red resources and bi blue resources. Suppose Hongcow currently has A red cards and B blue cards. Then, the i-th card will require Hongcow to spend max(ri\xe2\x80\x89-\xe2\x80\x89A,\xe2\x80\x890) red tokens, and max(bi\xe2\x80\x89-\xe2\x80\x89B,\xe2\x80\x890) blue tokens. Note, only tokens disappear, but the cards stay with Hongcow forever. Each card can be bought only once.Given a description of the cards and their costs determine the minimum number of turns Hongcow needs to purchase all cards." 2400

744B "Hongcow\'s Game" "bitmasks,divide and conquer,interactive" "One day, Hongcow goes to the store and sees a brand new deck of n special cards. Each individual card is either red or blue. He decides he wants to buy them immediately. To do this, he needs to play a game with the owner of the store.This game takes some number of turns to complete. On a turn, Hongcow may do one of two things:   Collect tokens. Hongcow collects 1 red token and 1 blue token by choosing this option (thus, 2 tokens in total per one operation).  Buy a card. Hongcow chooses some card and spends tokens to purchase it as specified below. The i-th card requires ri red resources and bi blue resources. Suppose Hongcow currently has A red cards and B blue cards. Then, the i-th card will require Hongcow to spend max(ri\xe2\x80\x89-\xe2\x80\x89A,\xe2\x80\x890) red tokens, and max(bi\xe2\x80\x89-\xe2\x80\x89B,\xe2\x80\x890) blue tokens. Note, only tokens disappear, but the cards stay with Hongcow forever. Each card can be bought only once.Given a description of the cards and their costs determine the minimum number of turns Hongcow needs to purchase all cards." 1900

744A "Hongcow Builds A Nation" "dfs and similar,graphs" "Hongcow is ruler of the world. As ruler of the world, he wants to make it easier for people to travel by road within their own countries.The world can be modeled as an undirected graph with n nodes and m edges. k of the nodes are home to the governments of the k countries that make up the world.There is at most one edge connecting any two nodes and no edge connects a node to itself. Furthermore, for any two nodes corresponding to governments, there is no path between those two nodes. Any graph that satisfies all of these conditions is stable.Hongcow wants to add as many edges as possible to the graph while keeping it stable. Determine the maximum number of edges Hongcow can add." 1500

743E "Vladik and cards" "binary search,bitmasks,brute force,dp" "Vladik was bored on his way home and decided to play the following game. He took n cards and put them in a row in front of himself. Every card has a positive integer number not exceeding 8 written on it. He decided to find the longest subsequence of cards which satisfies the following conditions:  the number of occurrences of each number from 1 to 8 in the subsequence doesn\'t differ by more then 1 from the number of occurrences of any other number. Formally, if there are ck cards with number k on them in the subsequence, than for all pairs of integers  the condition |ci\xe2\x80\x89-\xe2\x80\x89cj|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 must hold.  if there is at least one card with number x on it in the subsequence, then all cards with number x in this subsequence must form a continuous segment in it (but not necessarily a continuous segment in the original sequence). For example, the subsequence [1,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x892] satisfies this condition while the subsequence [1,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x891] doesn\'t. Note that [1,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x892] doesn\'t satisfy the first condition. Please help Vladik to find the length of the longest subsequence that satisfies both conditions." 2200

743D "Chloe and pleasant prizes" "dfs and similar,dp,graphs,trees" "Generous sponsors of the olympiad in which Chloe and Vladik took part allowed all the participants to choose a prize for them on their own. Christmas is coming, so sponsors decided to decorate the Christmas tree with their prizes. They took n prizes for the contestants and wrote on each of them a unique id (integer from 1 to n). A gift i is characterized by integer ai�\xe2\x80\x94 pleasantness of the gift. The pleasantness of the gift can be positive, negative or zero. Sponsors placed the gift 1 on the top of the tree. All the other gifts hung on a rope tied to some other gift so that each gift hung on the first gift, possibly with a sequence of ropes and another gifts. Formally, the gifts formed a rooted tree with n vertices.The prize-giving procedure goes in the following way: the participants come to the tree one after another, choose any of the remaining gifts and cut the rope this prize hang on. Note that all the ropes which were used to hang other prizes on the chosen one are not cut. So the contestant gets the chosen gift as well as the all the gifts that hang on it, possibly with a sequence of ropes and another gifts.Our friends, Chloe and Vladik, shared the first place on the olympiad and they will choose prizes at the same time! To keep themselves from fighting, they decided to choose two different gifts so that the sets of the gifts that hang on them with a sequence of ropes and another gifts don\'t intersect. In other words, there shouldn\'t be any gift that hang both on the gift chosen by Chloe and on the gift chosen by Vladik. From all of the possible variants they will choose such pair of prizes that the sum of pleasantness of all the gifts that they will take after cutting the ropes is as large as possible.Print the maximum sum of pleasantness that Vladik and Chloe can get. If it is impossible for them to choose the gifts without fighting, print Impossible." 1800

743C "Vladik and fractions" "brute force,constructive algorithms,math,number theory" "Vladik and Chloe decided to determine who of them is better at math. Vladik claimed that for any positive integer n he can represent fraction  as a sum of three distinct positive fractions in form .Help Vladik with that, i.e for a given n find three distinct positive integers x, y and z such that . Because Chloe can\'t check Vladik\'s answer if the numbers are large, he asks you to print numbers not exceeding 109.If there is no such answer, print -1." 1500

743B "Chloe and the sequence" "binary search,bitmasks,constructive algorithms,implementation" "Chloe, the same as Vladik, is a competitive programmer. She didn\'t have any problems to get to the olympiad like Vladik, but she was confused by the task proposed on the olympiad.Let\'s consider the following algorithm of generating a sequence of integers. Initially we have a sequence consisting of a single element equal to 1. Then we perform (n\xe2\x80\x89-\xe2\x80\x891) steps. On each step we take the sequence we\'ve got on the previous step, append it to the end of itself and insert in the middle the minimum positive integer we haven\'t used before. For example, we get the sequence [1,\xe2\x80\x892,\xe2\x80\x891] after the first step, the sequence [1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891] after the second step.The task is to find the value of the element with index k (the elements are numbered from 1) in the obtained sequence, i.�e. after (n\xe2\x80\x89-\xe2\x80\x891) steps.Please help Chloe to solve the problem!" 1200

743A "Vladik and flights" "constructive algorithms,greedy,implementation" "Vladik is a competitive programmer. This year he is going to win the International Olympiad in Informatics. But it is not as easy as it sounds: the question Vladik face now is to find the cheapest way to get to the olympiad.Vladik knows n airports. All the airports are located on a straight line. Each airport has unique id from 1 to n, Vladik\'s house is situated next to the airport with id a, and the place of the olympiad is situated next to the airport with id b. It is possible that Vladik\'s house and the place of the olympiad are located near the same airport. To get to the olympiad, Vladik can fly between any pair of airports any number of times, but he has to start his route at the airport a and finish it at the airport b.Each airport belongs to one of two companies. The cost of flight from the airport i to the airport j is zero if both airports belong to the same company, and |i\xe2\x80\x89-\xe2\x80\x89j| if they belong to different companies.Print the minimum cost Vladik has to pay to get to the olympiad." 1200

742B "Arpa\xe2\x80\x99s obvious problem and Mehrdad\xe2\x80\x99s terrible solution" "brute force,math,number theory" "Vladik is a competitive programmer. This year he is going to win the International Olympiad in Informatics. But it is not as easy as it sounds: the question Vladik face now is to find the cheapest way to get to the olympiad.Vladik knows n airports. All the airports are located on a straight line. Each airport has unique id from 1 to n, Vladik\'s house is situated next to the airport with id a, and the place of the olympiad is situated next to the airport with id b. It is possible that Vladik\'s house and the place of the olympiad are located near the same airport. To get to the olympiad, Vladik can fly between any pair of airports any number of times, but he has to start his route at the airport a and finish it at the airport b.Each airport belongs to one of two companies. The cost of flight from the airport i to the airport j is zero if both airports belong to the same company, and |i\xe2\x80\x89-\xe2\x80\x89j| if they belong to different companies.Print the minimum cost Vladik has to pay to get to the olympiad." 1500

742A "Arpa\xe2\x80\x99s hard exam and Mehrdad\xe2\x80\x99s naive cheat" "implementation,math,number theory" "Vladik is a competitive programmer. This year he is going to win the International Olympiad in Informatics. But it is not as easy as it sounds: the question Vladik face now is to find the cheapest way to get to the olympiad.Vladik knows n airports. All the airports are located on a straight line. Each airport has unique id from 1 to n, Vladik\'s house is situated next to the airport with id a, and the place of the olympiad is situated next to the airport with id b. It is possible that Vladik\'s house and the place of the olympiad are located near the same airport. To get to the olympiad, Vladik can fly between any pair of airports any number of times, but he has to start his route at the airport a and finish it at the airport b.Each airport belongs to one of two companies. The cost of flight from the airport i to the airport j is zero if both airports belong to the same company, and |i\xe2\x80\x89-\xe2\x80\x89j| if they belong to different companies.Print the minimum cost Vladik has to pay to get to the olympiad." 1000

741E "Arpa\xe2\x80\x99s abnormal DNA and Mehrdad\xe2\x80\x99s deep interest" "data structures,string suffix structures" "Vladik is a competitive programmer. This year he is going to win the International Olympiad in Informatics. But it is not as easy as it sounds: the question Vladik face now is to find the cheapest way to get to the olympiad.Vladik knows n airports. All the airports are located on a straight line. Each airport has unique id from 1 to n, Vladik\'s house is situated next to the airport with id a, and the place of the olympiad is situated next to the airport with id b. It is possible that Vladik\'s house and the place of the olympiad are located near the same airport. To get to the olympiad, Vladik can fly between any pair of airports any number of times, but he has to start his route at the airport a and finish it at the airport b.Each airport belongs to one of two companies. The cost of flight from the airport i to the airport j is zero if both airports belong to the same company, and |i\xe2\x80\x89-\xe2\x80\x89j| if they belong to different companies.Print the minimum cost Vladik has to pay to get to the olympiad." 3400

741D "Arpa\xe2\x80\x99s letter-marked tree and Mehrdad\xe2\x80\x99s Dokhtar-kosh paths" "data structures,dfs and similar,trees" "Vladik is a competitive programmer. This year he is going to win the International Olympiad in Informatics. But it is not as easy as it sounds: the question Vladik face now is to find the cheapest way to get to the olympiad.Vladik knows n airports. All the airports are located on a straight line. Each airport has unique id from 1 to n, Vladik\'s house is situated next to the airport with id a, and the place of the olympiad is situated next to the airport with id b. It is possible that Vladik\'s house and the place of the olympiad are located near the same airport. To get to the olympiad, Vladik can fly between any pair of airports any number of times, but he has to start his route at the airport a and finish it at the airport b.Each airport belongs to one of two companies. The cost of flight from the airport i to the airport j is zero if both airports belong to the same company, and |i\xe2\x80\x89-\xe2\x80\x89j| if they belong to different companies.Print the minimum cost Vladik has to pay to get to the olympiad." 2900

741C "Arpa\xe2\x80\x99s overnight party and Mehrdad\xe2\x80\x99s silent entering" "constructive algorithms,dfs and similar,graphs" "Vladik is a competitive programmer. This year he is going to win the International Olympiad in Informatics. But it is not as easy as it sounds: the question Vladik face now is to find the cheapest way to get to the olympiad.Vladik knows n airports. All the airports are located on a straight line. Each airport has unique id from 1 to n, Vladik\'s house is situated next to the airport with id a, and the place of the olympiad is situated next to the airport with id b. It is possible that Vladik\'s house and the place of the olympiad are located near the same airport. To get to the olympiad, Vladik can fly between any pair of airports any number of times, but he has to start his route at the airport a and finish it at the airport b.Each airport belongs to one of two companies. The cost of flight from the airport i to the airport j is zero if both airports belong to the same company, and |i\xe2\x80\x89-\xe2\x80\x89j| if they belong to different companies.Print the minimum cost Vladik has to pay to get to the olympiad." 2600

741B "Arpa\'s weak amphitheater and Mehrdad\'s valuable Hoses" "dfs and similar,dp,dsu" "Vladik is a competitive programmer. This year he is going to win the International Olympiad in Informatics. But it is not as easy as it sounds: the question Vladik face now is to find the cheapest way to get to the olympiad.Vladik knows n airports. All the airports are located on a straight line. Each airport has unique id from 1 to n, Vladik\'s house is situated next to the airport with id a, and the place of the olympiad is situated next to the airport with id b. It is possible that Vladik\'s house and the place of the olympiad are located near the same airport. To get to the olympiad, Vladik can fly between any pair of airports any number of times, but he has to start his route at the airport a and finish it at the airport b.Each airport belongs to one of two companies. The cost of flight from the airport i to the airport j is zero if both airports belong to the same company, and |i\xe2\x80\x89-\xe2\x80\x89j| if they belong to different companies.Print the minimum cost Vladik has to pay to get to the olympiad." 1600

741A "Arpa\'s loud Owf and Mehrdad\'s evil plan" "dfs and similar,math" "Vladik is a competitive programmer. This year he is going to win the International Olympiad in Informatics. But it is not as easy as it sounds: the question Vladik face now is to find the cheapest way to get to the olympiad.Vladik knows n airports. All the airports are located on a straight line. Each airport has unique id from 1 to n, Vladik\'s house is situated next to the airport with id a, and the place of the olympiad is situated next to the airport with id b. It is possible that Vladik\'s house and the place of the olympiad are located near the same airport. To get to the olympiad, Vladik can fly between any pair of airports any number of times, but he has to start his route at the airport a and finish it at the airport b.Each airport belongs to one of two companies. The cost of flight from the airport i to the airport j is zero if both airports belong to the same company, and |i\xe2\x80\x89-\xe2\x80\x89j| if they belong to different companies.Print the minimum cost Vladik has to pay to get to the olympiad." 1600

740B "Alyona and flowers" "constructive algorithms" "Little Alyona is celebrating Happy Birthday! Her mother has an array of n flowers. Each flower has some mood, the mood of i-th flower is ai. The mood can be positive, zero or negative.Let\'s define a subarray as a segment of consecutive flowers. The mother suggested some set of subarrays. Alyona wants to choose several of the subarrays suggested by her mother. After that, each of the flowers will add to the girl\'s happiness its mood multiplied by the number of chosen subarrays the flower is in.For example, consider the case when the mother has 5 flowers, and their moods are equal to 1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x894. Suppose the mother suggested subarrays (1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892), (3,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x894), (1,\xe2\x80\x893), (1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893). Then if the girl chooses the third and the fourth subarrays then:   the first flower adds 1\xc2\xb71\xe2\x80\x89=\xe2\x80\x891 to the girl\'s happiness, because he is in one of chosen subarrays,  the second flower adds (\xe2\x80\x89-\xe2\x80\x892)\xc2\xb71\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892, because he is in one of chosen subarrays,  the third flower adds 1\xc2\xb72\xe2\x80\x89=\xe2\x80\x892, because he is in two of chosen subarrays,  the fourth flower adds 3\xc2\xb72\xe2\x80\x89=\xe2\x80\x896, because he is in two of chosen subarrays,  the fifth flower adds (\xe2\x80\x89-\xe2\x80\x894)\xc2\xb70\xe2\x80\x89=\xe2\x80\x890, because he is in no chosen subarrays. Thus, in total 1\xe2\x80\x89+\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x892)\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x896\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89=\xe2\x80\x897 is added to the girl\'s happiness. Alyona wants to choose such subarrays from those suggested by the mother that the value added to her happiness would be as large as possible. Help her do this!Alyona can choose any number of the subarrays, even 0 or all suggested by her mother." 1200

740A "Alyona and copybooks" "brute force,implementation" "Little girl Alyona is in a shop to buy some copybooks for school. She study four subjects so she wants to have equal number of copybooks for each of the subjects. There are three types of copybook\'s packs in the shop: it is possible to buy one copybook for a rubles, a pack of two copybooks for b rubles, and a pack of three copybooks for c rubles. Alyona already has n copybooks.What is the minimum amount of rubles she should pay to buy such number of copybooks k that n\xe2\x80\x89+\xe2\x80\x89k is divisible by 4? There are infinitely many packs of any type in the shop. Alyona can buy packs of different type in the same purchase." 1300

