2037G "Natlan Exploring" "combinatorics,dp,math,number theory" "You are exploring the stunning region of Natlan! This region consists of n cities, and each city is rated with an attractiveness ai. A directed edge exists from City i to City j if and only if i<j and gcd(ai,aj)\xe2\x89\xa01, where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y.Starting from City 1, your task is to determine the total number of distinct paths you can take to reach City n, modulo 998244353. Two paths are different if and only if the set of cities visited is different." -999 1706B "Making Towers" dp,greedy,math "You have a sequence of n colored blocks. The color of the i-th block is ci, an integer between 1 and n.You will place the blocks down in sequence on an infinite coordinate grid in the following way.   Initially, you place block 1 at (0,0).  For 2\xe2\x89\xa4i\xe2\x89\xa4n, if the (i\xe2\x88\x921)-th block is placed at position (x,y), then the i-th block can be placed at one of positions (x+1,y), (x\xe2\x88\x921,y), (x,y+1) (but not at position (x,y\xe2\x88\x921)), as long no previous block was placed at that position. A tower is formed by s blocks such that they are placed at positions (x,y),(x,y+1),\xe2\x80\xa6,(x,y+s\xe2\x88\x921) for some position (x,y) and integer s. The size of the tower is s, the number of blocks in it. A tower of color r is a tower such that all blocks in it have the color r.For each color r from 1 to n, solve the following problem independently:   Find the maximum size of a tower of color r that you can form by placing down the blocks according to the rules." 1100 1333E "Road to 1600" "brute force,constructive algorithms" "Egor wants to achieve a rating of 1600 points on the well-known chess portal ChessForces and he needs your help!Before you start solving the problem, Egor wants to remind you how the chess pieces move. Chess rook moves along straight lines up and down, left and right, as many squares as it wants. And when it wants, it can stop. The queen walks in all directions vertically and diagonally at any distance. You can see the examples below.  To reach the goal, Egor should research the next topic:There is an N\xc3\x97N board. Each cell of the board has a number from 1 to N2 in it and numbers in all cells are distinct.In the beginning, some chess figure stands in the cell with the number 1. Note that this cell is already considered as visited. After that every move is determined by the following rules:   Among all not visited yet cells to which the figure can get in one move, it goes to the cell that has minimal number. If all accessible cells were already visited and some cells are not yet visited, then the figure is teleported to the not visited cell that has minimal number. If this step happens, the piece pays a fee of 1 vun. If all cells are already visited, the process is stopped. Egor should find an N\xc3\x97N board on which the rook pays strictly less vuns than the queen during the round with this numbering. Help him to find such N\xc3\x97N numbered board, or tell that it doesn\'t exist." 2400 92105 Labyrinth-5 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200 696C PLEASE combinatorics,dp,implementation,math,matrices "As we all know Barney\'s job is ""PLEASE"" and he has not much to do at work. That\'s why he started playing ""cups and key"". In this game there are three identical cups arranged in a line from left to right. Initially key to Barney\'s heart is under the middle cup.  Then at one turn Barney swaps the cup in the middle with any of other two cups randomly (he choses each with equal probability), so the chosen cup becomes the middle one. Game lasts n turns and Barney independently choses a cup to swap with the middle one within each turn, and the key always remains in the cup it was at the start.After n-th turn Barney asks a girl to guess which cup contains the key. The girl points to the middle one but Barney was distracted while making turns and doesn\'t know if the key is under the middle cup. That\'s why he asked you to tell him the probability that girl guessed right.Number n of game turns can be extremely large, that\'s why Barney did not give it to you. Instead he gave you an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak such that   in other words, n is multiplication of all elements of the given array.Because of precision difficulties, Barney asked you to tell him the answer as an irreducible fraction. In other words you need to find it as a fraction p\xe2\x80\x89/\xe2\x80\x89q such that , where  is the greatest common divisor. Since p and q can be extremely large, you only need to find the remainders of dividing each of them by 109\xe2\x80\x89+\xe2\x80\x897.Please note that we want  of p and q to be 1, not  of their remainders after dividing by 109\xe2\x80\x89+\xe2\x80\x897." 2000 1873F "Money Trees" "binary search,greedy,math,two pointers" "Luca is in front of a row of n trees. The i-th tree has ai fruit and height hi.He wants to choose a contiguous subarray of the array [hl,hl+1,\xe2\x80\xa6,hr] such that for each i (l\xe2\x89\xa4i<r), hi is divisible\xe2\x80\xa0 by hi+1. He will collect all the fruit from each of the trees in the subarray (that is, he will collect al+al+1+\xe2\x8b\xaf+ar fruits). However, if he collects more than k fruits in total, he will get caught. What is the maximum length of a subarray Luca can choose so he doesn\'t get caught?\xe2\x80\xa0 x is divisible by y if the ratio xy is an integer." 1300 1725H "Hot Black Hot White" "constructive algorithms,math" "One day, you are accepted as being Dr. Chanek\'s assistant. The first task given by Dr. Chanek to you is to take care and store his magical stones.Dr. Chanek has N magical stones with N being an even number. Those magical stones are numbered from 1 to N. Magical stone i has a strength of Ai. A magical stone can be painted with two colours, namely the colour black or the colour white. You are tasked to paint the magical stones with the colour black or white and store the magical stones into a magic box with a magic coefficient Z (0\xe2\x89\xa4Z\xe2\x89\xa42). The painting of the magical stones must be done in a way such that there are N2 black magical stones and N2 white magical stones.Define concat(x,y) for two integers x and y as the result of concatenating the digits of x to the left of y in their decimal representation without changing the order. As an example, concat(10,24) will result in 1024.For a magic box with a magic coefficient Z, magical stone i will react with magical stone j if the colours of both stones are different and concat(Ai,Aj)\xc3\x97concat(Aj,Ai)+Ai\xc3\x97Aj\xe2\x89\xa1Zmod3. A magical stone that is reacting will be very hot and dangerous. Because of that, you must colour the magical stones and determine the magic coefficient Z of the magic box in a way such that there is no magical stone that reacts, or report if it is impossible." 1800 1525D Armchairs "dp,flows,graph matchings,greedy" "There are n armchairs, numbered from 1 to n from left to right. Some armchairs are occupied by people (at most one person per armchair), others are not. The number of occupied armchairs is not greater than n2.For some reason, you would like to tell people to move from their armchairs to some other ones. If the i-th armchair is occupied by someone and the j-th armchair is not, you can tell the person sitting in the i-th armchair to move to the j-th armchair. The time it takes a person to move from the i-th armchair to the j-th one is |i\xe2\x88\x92j| minutes. You may perform this operation any number of times, but these operations must be done sequentially, i.\xe2\x80\x89e. you cannot tell a person to move until the person you asked to move in the last operation has finished moving to their destination armchair.You want to achieve the following situation: every seat that was initially occupied must be free. What is the minimum time you need to do it?" 1137D "Cooperative Game" "constructive algorithms,interactive,number theory" "This is an interactive problem.Misha likes to play cooperative games with incomplete information. Today he suggested ten his friends to play a cooperative game ""Lake"".Misha has already come up with a field for the upcoming game. The field for this game is a directed graph consisting of two parts. The first part is a road along the coast of the lake which is a cycle of c vertices. The second part is a path from home to the lake which is a chain of t vertices, and there is an edge from the last vertex of this chain to the vertex of the road along the coast which has the most beautiful view of the lake, also known as the finish vertex. Misha decided to keep the field secret, so nobody knows neither t nor c.  Note that each vertex of the field has exactly one outgoing edge and all the vertices except the home vertex and the finish vertex have exactly one ingoing edge. The home vertex has no incoming edges, the finish vertex has two incoming edges.At the beginning of the game pieces of all the ten players, indexed with consecutive integers from 0 to 9, are at the home vertex. After that on each turn some of the players can ask Misha to simultaneously move their pieces along the corresponding edges. Misha will not answer more than q such queries. After each move Misha will tell players whose pieces are at the same vertices and whose pieces are at different vertices.The goal of the game is to move all the pieces to the finish vertex. Misha\'s friends have no idea how to win in such a game without knowledge of c, t and q, but luckily they are your friends. Help them: coordinate their actions to win the game. Misha has drawn such a field that 1\xe2\x89\xa4t,c, (t+c)\xe2\x89\xa41000 and q=3\xe2\x8b\x85(t+c)." 450A "Jzzhu and Children" implementation "There are n children in Jzzhu\'s school. Jzzhu is going to give some candies to them. Let\'s number all the children from 1 to n. The i-th child wants to get at least ai candies.Jzzhu asks children to line up. Initially, the i-th child stands at the i-th place of the line. Then Jzzhu start distribution of the candies. He follows the algorithm:  Give m candies to the first child of the line.  If this child still haven\'t got enough candies, then the child goes to the end of the line, else the child go home.  Repeat the first two steps while the line is not empty. Consider all the children in the order they go home. Jzzhu wants to know, which child will be the last in this order?" 1000 201A "Clear Symmetry" "constructive algorithms,dp,math" "Consider some square matrix A with side n consisting of zeros and ones. There are n rows numbered from 1 to n from top to bottom and n columns numbered from 1 to n from left to right in this matrix. We\'ll denote the element of the matrix which is located at the intersection of the i-row and the j-th column as Ai,\xe2\x80\x89j.Let\'s call matrix A clear if no two cells containing ones have a common side.Let\'s call matrix A symmetrical if it matches the matrices formed from it by a horizontal and/or a vertical reflection. Formally, for each pair (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) both of the following conditions must be met: Ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89An\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j and Ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89Ai,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891.Let\'s define the sharpness of matrix A as the number of ones in it.Given integer x, your task is to find the smallest positive integer n such that there exists a clear symmetrical matrix A with side n and sharpness x." 1700
2037F "Ardent Flames" "binary search,data structures,sortings,two pointers" "You have obtained the new limited event character Xilonen. You decide to use her in combat.There are n enemies in a line. The i\'th enemy from the left has health hi and is currently at position xi. Xilonen has an attack damage of m, and you are ready to defeat the enemies with her.Xilonen has a powerful ""ground stomp"" attack. Before you perform any attacks, you select an integer p and position Xilonen there (p can be any integer position, including a position with an enemy currently). Afterwards, for each attack, she deals m damage to an enemy at position p (if there are any), m\xe2\x88\x921 damage to enemies at positions p\xe2\x88\x921 and p+1, m\xe2\x88\x922 damage to enemies at positions p\xe2\x88\x922 and p+2, and so on. Enemies that are at least a distance of m away from Xilonen take no damage from attacks.Formally, if there is an enemy at position x, she will deal max(0,m\xe2\x88\x92|p\xe2\x88\x92x|) damage to that enemy each hit. Note that you may not choose a different p for different attacks. Over all possible p, output the minimum number of attacks Xilonen must perform to defeat at least k enemies. If it is impossible to find a p such that eventually at least k enemies will be defeated, output \xe2\x88\x921 instead. Note that an enemy is considered to be defeated if its health reaches 0 or below." -999.0                                                
2036A Quintomania implementation "Boris Notkin composes melodies. He represents them as a sequence of notes, where each note is encoded as an integer from 0 to 127 inclusive. The interval between two notes a and b is equal to |a\xe2\x88\x92b| semitones.Boris considers a melody perfect if the interval between each two adjacent notes is either 5 semitones or 7 semitones.After composing his latest melodies, he enthusiastically shows you his collection of works. Help Boris Notkin understand whether his melodies are perfect." 800.0                                                
2035H "Peak Productivity Forces" "constructive algorithms" "I\'m peakly productive and this is deep.You are given two permutations\xe2\x88\x97 a and b, both of length n.You can perform the following three-step operation on permutation a:  Choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n). Cyclic shift a1,a2,\xe2\x80\xa6,ai\xe2\x88\x921 by 1 to the right. If you had chosen i=1, then this range doesn\'t exist, and you cyclic shift nothing. Cyclic shift ai+1,ai+2,\xe2\x80\xa6,an by 1 to the right. If you had chosen i=n, then this range doesn\'t exist, and you cyclic shift nothing.After the operation, a1,a2,\xe2\x80\xa6,ai\xe2\x88\x922,ai\xe2\x88\x921,ai,ai+1,ai+2,\xe2\x80\xa6,an\xe2\x88\x921,an is transformed into ai\xe2\x88\x921,a1,\xe2\x80\xa6,ai\xe2\x88\x923,ai\xe2\x88\x922,ai,an,ai+1,\xe2\x80\xa6,an\xe2\x88\x922,an\xe2\x88\x921.Here are some examples of operations done on the identity permutation [1,2,3,4,5,6,7] of length 7:   If we choose i=3, it will become [2,1,3,7,4,5,6].  If we choose i=1, it will become [1,7,2,3,4,5,6].  If we choose i=7, it will become [6,1,2,3,4,5,7].  Notably, position i is not shifted. Find a construction using at most 2n operations to make a equal to b or print \xe2\x88\x921 if it is impossible. The number of operations does not need to be minimized. It can be shown that if it is possible to make a equal to b, it is possible to do this within 2n operations. \xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 3500.0                                                
2035D "Yet Another Real Number Problem" "binary search,data structures,divide and conquer,greedy,implementation,math" "Three r there are\'s in strawberry.You are given an array b of length m. You can perform the following operation any number of times (possibly zero):   Choose two distinct indices i and j where 1\xe2\x89\xa4i<j\xe2\x89\xa4m and bi is even, divide bi by 2 and multiply bj by 2.  Your task is to maximize the sum of the array after performing any number of such operations. Since it could be large, output this sum modulo 109+7.Since this problem is too easy, you are given an array a of length n and need to solve the problem for each prefix of a.In other words, denoting the maximum sum of b after performing any number of such operations as f(b), you need to output f([a1]), f([a1,a2]), \xe2\x80\xa6, f([a1,a2,\xe2\x80\xa6,an]) modulo 109+7 respectively." 1800.0                                                
2033E "Sakurako, Kosuke, and the Permutation" "brute force,data structures,dfs and similar,dsu,graphs,greedy,math" "Sakurako\'s exams are over, and she did excellently. As a reward, she received a permutation p. Kosuke was not entirely satisfied because he failed one exam and did not receive a gift. He decided to sneak into her room (thanks to the code for her lock) and spoil the permutation so that it becomes simple.A permutation p is considered simple if for every i (1\xe2\x89\xa4i\xe2\x89\xa4n) one of the following conditions holds:  pi=i  ppi=i For example, the permutations [1,2,3,4], [5,2,4,3,1], and [2,1] are simple, while [2,3,1] and [5,2,1,4,3] are not.In one operation, Kosuke can choose indices i,j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) and swap the elements pi and pj.Sakurako is about to return home. Your task is to calculate the minimum number of operations that Kosuke needs to perform to make the permutation simple." 1400.0                                                
2032B Medians "constructive algorithms,greedy,implementation,math" "You are given an array a=[1,2,\xe2\x80\xa6,n], where n is odd, and an integer k.Your task is to choose an odd positive integer m and to split a into m subarrays\xe2\x80\xa0 b1,b2,\xe2\x80\xa6,bm such that:  Each element of the array a belongs to exactly one subarray.  For all 1\xe2\x89\xa4i\xe2\x89\xa4m, |bi| is odd, i.e., the length of each subarray is odd.  median([median(b1),median(b2),\xe2\x80\xa6,median(bm)])=k, i.e., the median\xe2\x80\xa1 of the array of medians of all subarrays must equal k. median(c) denotes the median of the array c. \xe2\x80\xa0A subarray of the array a of length n is the array [al,al+1,\xe2\x80\xa6,ar] for some integers 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n.\xe2\x80\xa1A median of the array of odd length is the middle element after the array is sorted in non-decreasing order. For example: median([1,2,5,4,3])=3, median([3,2,1])=2, median([2,1,2,1,2,2,2])=2." 1100.0                                                
2031E "Penchick and Chloe\'s Trees" "binary search,constructive algorithms,data structures,dfs and similar,dp,greedy,math,sortings,trees" "With just a few hours left until Penchick and Chloe leave for Singapore, they could hardly wait to see the towering trees at the Singapore Botanic Gardens! Attempting to contain their excitement, Penchick crafted a rooted tree to keep Chloe and himself busy.Penchick has a rooted tree\xe2\x88\x97 consisting of n vertices, numbered from 1 to n, with vertex 1 as the root, and Chloe can select a non-negative integer d to create a perfect binary tree\xe2\x80\xa0 of depth d.Since Penchick and Chloe are good friends, Chloe wants her tree to be isomorphic\xe2\x80\xa1 to Penchick\'s tree. To meet this condition, Chloe can perform the following operation on her own tree any number of times:  Select an edge (u,v), where u is the parent of v.  Remove vertex v and all the edges connected to v, then connect all of v\'s previous children directly to u. In particular, doing an operation on an edge (u,v) where v is a leaf will delete vertex v without adding any new edges.Since constructing a perfect binary tree can be time-consuming, Chloe wants to choose the minimum d such that a perfect binary tree of depth d can be made isomorphic to Penchick\'s tree using the above operation. Note that she can\'t change the roots of the trees.\xe2\x88\x97A tree is a connected graph without cycles.  A rooted tree is a tree where one vertex is special and called the root.  The parent of vertex v is the first vertex on the simple path from v to the root. The root has no parent.  A child of vertex v is any vertex u for which v is the parent.  A leaf is any vertex without children. \xe2\x80\xa0A full binary tree is rooted tree, in which each node has 0 or 2 children.  A perfect binary tree is a full binary tree in which every leaf is at the same distance from the root. The depth of such a tree is the distance from the root to a leaf.\xe2\x80\xa1Two rooted trees, rooted at r1 and r2 respectively, are considered isomorphic if there exists a permutation p of the vertices such that an edge (u,v) exists in the first tree if and only if the edge (pu,pv) exists in the second tree, and pr1=r2." -999.0                                                
2030G2 "The Destruction of the Universe (Hard Version)" combinatorics,math "This is the hard version of the problem. In this version, n\xe2\x89\xa4106. You can only make hacks if both versions of the problem are solved.Orangutans are powerful beings\xe2\x80\x94so powerful that they only need 1 unit of time to destroy every vulnerable planet in the universe!There are n planets in the universe. Each planet has an interval of vulnerability [l,r], during which it will be exposed to destruction by orangutans. Orangutans can also expand the interval of vulnerability of any planet by 1 unit.Specifically, suppose the expansion is performed on planet p with interval of vulnerability [lp,rp]. Then, the resulting interval of vulnerability may be either [lp\xe2\x88\x921,rp] or [lp,rp+1].Given a set of planets, orangutans can destroy all planets if the intervals of vulnerability of all planets in the set intersect at least one common point. Let the score of such a set denote the minimum number of expansions that must be performed.Orangutans are interested in the sum of scores of all non-empty subsets of the planets in the universe. As the answer can be large, output it modulo 998244353." 3100.0                                                
2030B "Minimise Oneness" "combinatorics,constructive algorithms,games,math" "For an arbitrary binary string t\xe2\x88\x97, let f(t) be the number of non-empty subsequences\xe2\x80\xa0 of t that contain only 0, and let g(t) be the number of non-empty subsequences of t that contain at least one 1. Note that for f(t) and for g(t), each subsequence is counted as many times as it appears in t. E.g., f(000)=7,g(100)=4.We define the oneness of the binary string t to be |f(t)\xe2\x88\x92g(t)|, where for an arbitrary integer z, |z| represents the absolute value of z.You are given a positive integer n. Find a binary string s of length n such that its oneness is as small as possible. If there are multiple strings, you can print any of them.\xe2\x88\x97A binary string is a string that only consists of characters 0 and 1.\xe2\x80\xa0A sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) elements. For example, subsequences of 1011101 are 0, 1, 11111, 0111, but not 000 nor 11100." 800.0                                                
2029E "Common Generator" "brute force,constructive algorithms,math,number theory" "For two integers x and y (x,y\xe2\x89\xa52), we will say that x is a generator of y if and only if x can be transformed to y by performing the following operation some number of times (possibly zero):  Choose a divisor d (d\xe2\x89\xa52) of x, then increase x by d. For example,   3 is a generator of 8 since we can perform the following operations: 3d=3\xe2\x86\x926d=2\xe2\x86\x928;  4 is a generator of 10 since we can perform the following operations: 4d=4\xe2\x86\x928d=2\xe2\x86\x9210;  5 is not a generator of 6 since we cannot transform 5 into 6 with the operation above. Now, Kevin gives you an array a consisting of n pairwise distinct integers (ai\xe2\x89\xa52).You have to find an integer x\xe2\x89\xa52 such that for each 1\xe2\x89\xa4i\xe2\x89\xa4n, x is a generator of ai, or determine that such an integer does not exist." 2100.0                                                
2028D "Alice\'s Adventures in Cards" "constructive algorithms,data structures,dp,graphs,greedy,implementation,ternary search" "Alice is playing cards with the Queen of Hearts, King of Hearts, and Jack of Hearts. There are n different types of cards in their card game. Alice currently has a card of type 1 and needs a card of type n to escape Wonderland. The other players have one of each kind of card.In this card game, Alice can trade cards with the three other players. Each player has different preferences for the n types of cards, which can be described by permutations\xe2\x88\x97 q, k, and j for the Queen, King, and Jack, respectively. A player values card a more than card b if for their permutation p, pa>pb. Then, this player is willing to trade card b to Alice in exchange for card a. Alice\'s preferences are straightforward: she values card a more than card b if a>b, and she will also only trade according to these preferences.Determine if Alice can trade up from card 1 to card n subject to these preferences, and if it is possible, give a possible set of trades to do it.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2000.0                                                
2027E1 "Bit Game (Easy Version)" "bitmasks,brute force,games,math" "This is the easy version of this problem. The only difference is that you need to output the winner of the game in this version, and the number of stones in each pile are fixed. You must solve both versions to be able to hack.Alice and Bob are playing a familiar game where they take turns removing stones from n piles. Initially, there are xi stones in the i-th pile, and it has an associated value ai. A player can take d stones away from the i-th pile if and only if both of the following conditions are met:   1\xe2\x89\xa4d\xe2\x89\xa4ai, and  x&d=d, where x is the current number of stones in the i-th pile and & denotes the bitwise AND operation. The player who cannot make a move loses, and Alice goes first.You\'re given the ai and xi values for each pile, please determine who will win the game if both players play optimally." 2800.0                                                
2025F "Choose Your Queries" "constructive algorithms,dfs and similar,dp,graphs,greedy,trees" "You are given an array a, consisting of n integers (numbered from 1 to n). Initially, they are all zeroes.You have to process q queries. The i-th query consists of two different integers xi and yi. During the i-th query, you have to choose an integer p (which is either xi or yi) and an integer d (which is either 1 or \xe2\x88\x921), and assign ap=ap+d.After each query, every element of a should be a non-negative integer.Process all queries in such a way that the sum of all elements of a after the last query is the minimum possible." 2700.0                                                
2023A "Concatenation of Arrays" "constructive algorithms,greedy,math,sortings" "You are given n arrays a1, \xe2\x80\xa6, an. The length of each array is two. Thus, ai=[ai,1,ai,2]. You need to concatenate the arrays into a single array of length 2n such that the number of inversions\xe2\x80\xa0 in the resulting array is minimized. Note that you do not need to count the actual number of inversions.More formally, you need to choose a permutation\xe2\x80\xa1 p of length n, so that the array b=[ap1,1,ap1,2,ap2,1,ap2,2,\xe2\x80\xa6,apn,1,apn,2] contains as few inversions as possible.\xe2\x80\xa0The number of inversions in an array c is the number of pairs of indices i and j such that i<j and ci>cj.\xe2\x80\xa1A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1300.0                                                
2021E1 "Digital Village (Easy Version)" "brute force,data structures,dfs and similar,dp,dsu,fft,graphs,greedy,implementation,math,trees" "This is the easy version of the problem. In the three versions, the constraints on n and m are different. You can make hacks only if all the versions of the problem are solved.Pak Chanek is setting up internet connections for the village of Khuntien. The village can be represented as a connected simple graph with n houses and m internet cables connecting house ui and house vi, each with a latency of wi.There are p houses that require internet. Pak Chanek can install servers in at most k of the houses. The houses that need internet will then be connected to one of the servers. However, since each cable has its latency, the latency experienced by house si requiring internet will be the maximum latency of the cables between that house and the server it is connected to.For each k=1,2,\xe2\x80\xa6,n, help Pak Chanek determine the minimum total latency that can be achieved for all the houses requiring internet." 2300.0                                                
2020D "Connect the Dots" "brute force,dp,dsu,graphs,math,trees" "One fine evening, Alice sat down to play the classic game ""Connect the Dots"", but with a twist.To play the game, Alice draws a straight line and marks n points on it, indexed from 1 to n. Initially, there are no arcs between the points, so they are all disjoint. After that, Alice performs m operations of the following type:  She picks three integers ai, di (1\xe2\x89\xa4di\xe2\x89\xa410), and ki.  She selects points ai,ai+di,ai+2di,ai+3di,\xe2\x80\xa6,ai+ki\xe2\x8b\x85di and connects each pair of these points with arcs. After performing all m operations, she wants to know the number of connected components\xe2\x80\xa0 these points form. Please help her find this number.\xe2\x80\xa0 Two points are said to be in one connected component if there is a path between them via several (possibly zero) arcs and other points." 1800.0                                                
2019A "Max Plus Size" "brute force,dp,greedy" "EnV - Dynasty\xe2\xa0\x80You are given an array a1,a2,\xe2\x80\xa6,an of positive integers.You can color some elements of the array red, but there cannot be two adjacent red elements (i.e., for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, at least one of ai and ai+1 must not be red).Your score is the maximum value of a red element plus the number of red elements. Find the maximum score you can get." 800.0                                                
2018F3 "Speedbreaker Counting (Hard Version)" dp,greedy,math "NightHawk22 - Isolation\xe2\xa0\x80This is the hard version of the problem. In the three versions, the constraints on n and the time limit are different. You can make hacks only if all the versions of the problem are solved.This is the statement of Problem D1B:  There are n cities in a row, numbered 1,2,\xe2\x80\xa6,n left to right.  At time 1, you conquer exactly one city, called the starting city.  At time 2,3,\xe2\x80\xa6,n, you can choose a city adjacent to the ones conquered so far and conquer it. You win if, for each i, you conquer city i at a time no later than ai. A winning strategy may or may not exist, also depending on the starting city. How many starting cities allow you to win? For each 0\xe2\x89\xa4k\xe2\x89\xa4n, count the number of arrays of positive integers a1,a2,\xe2\x80\xa6,an such that  1\xe2\x89\xa4ai\xe2\x89\xa4n for each 1\xe2\x89\xa4i\xe2\x89\xa4n;  the answer to Problem D1B is k. The answer can be very large, so you have to calculate it modulo a given prime p." 3100.0                                                
2018B Speedbreaker "binary search,data structures,dp,greedy,implementation,two pointers" "Djjaner - Speedbreaker\xe2\xa0\x80There are n cities in a row, numbered 1,2,\xe2\x80\xa6,n left to right.  At time 1, you conquer exactly one city, called the starting city.  At time 2,3,\xe2\x80\xa6,n, you can choose a city adjacent to the ones conquered so far and conquer it. You win if, for each i, you conquer city i at a time no later than ai. A winning strategy may or may not exist, also depending on the starting city. How many starting cities allow you to win?" 1900.0                                                
2018A "Cards Partition" "2-sat,brute force,greedy,implementation,math" "DJ Genki vs Gram - Einherjar Joker\xe2\xa0\x80You have some cards. An integer between 1 and n is written on each card: specifically, for each i from 1 to n, you have ai cards which have the number i written on them.There is also a shop which contains unlimited cards of each type. You have k coins, so you can buy at most k new cards in total, and the cards you buy can contain any integer between 1 and n, inclusive.After buying the new cards, you must partition all your cards into decks, according to the following rules:   all the decks must have the same size;  there are no pairs of cards with the same value in the same deck. Find the maximum possible size of a deck after buying cards and partitioning them optimally." 1600.0                                                
2009G2 "Yunli\'s Subarray Queries (hard version)" "binary search,data structures,dp" "This is the hard version of the problem. In this version, it is guaranteed that r\xe2\x89\xa5l+k\xe2\x88\x921 for all queries.For an arbitrary array b, Yunli can perform the following operation any number of times:  Select an index i. Set bi=x where x is any integer she desires (x is not limited to the interval [1,n]). Denote f(b) as the minimum number of operations she needs to perform until there exists a consecutive subarray\xe2\x88\x97 of length at least k in b.Yunli is given an array a of size n and asks you q queries. In each query, you must output \xe2\x88\x91rj=l+k\xe2\x88\x921f([al,al+1,\xe2\x80\xa6,aj]).\xe2\x88\x97If there exists a consecutive subarray of length k that starts at index i (1\xe2\x89\xa4i\xe2\x89\xa4|b|\xe2\x88\x92k+1), then bj=bj\xe2\x88\x921+1 for all i<j\xe2\x89\xa4i+k\xe2\x88\x921." 2200.0                                                
2009G1 "Yunli\'s Subarray Queries (easy version)" "binary search,data structures,two pointers" "This is the easy version of the problem. In this version, it is guaranteed that r=l+k\xe2\x88\x921 for all queries.For an arbitrary array b, Yunli can perform the following operation any number of times:  Select an index i. Set bi=x where x is any integer she desires (x is not limited to the interval [1,n]). Denote f(b) as the minimum number of operations she needs to perform until there exists a consecutive subarray\xe2\x88\x97 of length at least k in b.Yunli is given an array a of size n and asks you q queries. In each query, you must output \xe2\x88\x91rj=l+k\xe2\x88\x921f([al,al+1,\xe2\x80\xa6,aj]). Note that in this version, you are only required to output f([al,al+1,\xe2\x80\xa6,al+k\xe2\x88\x921]).\xe2\x88\x97If there exists a consecutive subarray of length k that starts at index i (1\xe2\x89\xa4i\xe2\x89\xa4|b|\xe2\x88\x92k+1), then bj=bj\xe2\x88\x921+1 for all i<j\xe2\x89\xa4i+k\xe2\x88\x921." 1900.0                                                
2005E2 "Subtangle Game (Hard Version)" "data structures,dp,games,greedy,implementation" "This is the hard version of the problem. The differences between the two versions are the constraints on all the variables. You can make hacks only if both versions of the problem are solved.Tsovak and Narek are playing a game. They have an array a and a matrix b of integers with n rows and m columns, numbered from 1. The cell in the i-th row and the j-th column is (i,j).They are looking for the elements of a in turns; Tsovak starts first. Each time a player looks for a cell in the matrix containing the current element of a (Tsovak looks for the first, then Narek looks for the second, etc.). Let\'s say a player has chosen the cell (r,c). The next player has to choose his cell in the submatrix starting at (r+1,c+1) and ending in (n,m) (the submatrix can be empty if r=n or c=m). If a player cannot find such a cell (or the remaining submatrix is empty) or the array ends (the previous player has chosen the last element), then he loses.Your task is to determine the winner if the players play optimally.Note: since the input is large, you may need to optimize input/output for this problem.For example, in C++, it is enough to use the following lines at the start of the main() function: int main() {    ios_base::sync_with_stdio(false);    cin.tie(NULL); cout.tie(NULL);}" 2500.0                                                
2005B1 "The Strict Teacher (Easy Version)" greedy,math,sortings "This is the easy version of the problem. The only differences between the two versions are the constraints on m and q. In this version, m=2 and q=1. You can make hacks only if both versions of the problem are solved.Narek and Tsovak were busy preparing this round, so they have not managed to do their homework and decided to steal David\'s homework. Their strict teacher noticed that David has no homework and now wants to punish him. She hires other teachers to help her catch David. And now m teachers together are chasing him. Luckily, the classroom is big, so David has many places to hide.The classroom can be represented as a one-dimensional line with cells from 1 to n, inclusive.At the start, all m teachers and David are in distinct cells. Then they make moves. During each move   David goes to an adjacent cell or stays at the current one.  Then, each of the m teachers simultaneously goes to an adjacent cell or stays at the current one. This continues until David is caught. David is caught if any of the teachers (possibly more than one) is located in the same cell as David. Everyone sees others\' moves, so they all act optimally.Your task is to find how many moves it will take for the teachers to catch David if they all act optimally.Acting optimally means the student makes his moves in a way that maximizes the number of moves the teachers need to catch him; and the teachers coordinate with each other to make their moves in a way that minimizes the number of moves they need to catch the student.Also, as Narek and Tsovak think this task is easy, they decided to give you q queries on David\'s position. Note: this is the easy version, and you are given only one query." 1000.0                                                
2004D "Colored Portals" "binary search,brute force,data structures,graphs,greedy,implementation,shortest paths" "There are n cities located on a straight line. The cities are numbered from 1 to n.Portals are used to move between cities. There are 4 colors of portals: blue, green, red, and yellow. Each city has portals of two different colors. You can move from city i to city j if they have portals of the same color (for example, you can move between a ""blue-red"" city and a ""blue-green"" city). This movement costs |i\xe2\x88\x92j| coins.Your task is to answer q independent queries: calculate the minimum cost to move from city x to city y." 1600.0                                                
2003E2 "Turtle and Inversions (Hard Version)" "brute force,data structures,divide and conquer,dp,greedy,math,two pointers" "This is a hard version of this problem. The differences between the versions are the constraint on m and ri<li+1 holds for each i from 1 to m\xe2\x88\x921 in the easy version. You can make hacks only if both versions of the problem are solved.Turtle gives you m intervals [l1,r1],[l2,r2],\xe2\x80\xa6,[lm,rm]. He thinks that a permutation p is interesting if there exists an integer ki for every interval (li\xe2\x89\xa4ki<ri), and if he lets ai=kimaxj=lipj,bi=riminj=ki+1pj for every integer i from 1 to m, the following condition holds:mmaxi=1ai<mmini=1biTurtle wants you to calculate the maximum number of inversions of all interesting permutations of length n, or tell him if there is no interesting permutation.An inversion of a permutation p is a pair of integers (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) such that pi>pj." 2700.0                                                
2003D1 "Turtle and a MEX Problem (Easy Version)" greedy,math "The two versions are different problems. In this version of the problem, you can choose the same integer twice or more. You can make hacks only if both versions are solved.One day, Turtle was playing with n sequences. Let the length of the i-th sequence be li. Then the i-th sequence was ai,1,ai,2,\xe2\x80\xa6,ai,li.Piggy gave Turtle a problem to solve when Turtle was playing. The statement of the problem was:  There was a non-negative integer x at first. Turtle would perform an arbitrary number (possibly zero) of operations on the integer.  In each operation, Turtle could choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n, and set x to mex\xe2\x80\xa0(x,ai,1,ai,2,\xe2\x80\xa6,ai,li).  Turtle was asked to find the answer, which was the maximum value of x after performing an arbitrary number of operations. Turtle solved the above problem without difficulty. He defined f(k) as the answer to the above problem when the initial value of x was k.Then Piggy gave Turtle a non-negative integer m and asked Turtle to find the value of m\xe2\x88\x91i=0f(i) (i.e., the value of f(0)+f(1)+\xe2\x80\xa6+f(m)). Unfortunately, he couldn\'t solve this problem. Please help him!\xe2\x80\xa0mex(c1,c2,\xe2\x80\xa6,ck) is defined as the smallest non-negative integer x which does not occur in the sequence c. For example, mex(2,2,0,3) is 1, mex(1,2) is 0." 1500.0                                                
2002H "Counting 101" greedy "It\'s been a long summer\'s day, with the constant chirping of cicadas and the heat which never seemed to end. Finally, it has drawn to a close. The showdown has passed, the gates are open, and only a gentle breeze is left behind.Your predecessors had taken their final bow; it\'s your turn to take the stage.Sorting through some notes that were left behind, you found a curious statement named Problem 101:  Given a positive integer sequence a1,a2,\xe2\x80\xa6,an, you can operate on it any number of times. In an operation, you choose three consecutive elements ai,ai+1,ai+2, and merge them into one element max(ai+1,ai+1,ai+2+1). Please calculate the maximum number of operations you can do without creating an element greater than m. After some thought, you decided to propose the following problem, named Counting 101:  Given n and m. For each k=0,1,\xe2\x80\xa6,\xe2\x8c\x8an\xe2\x88\x9212\xe2\x8c\x8b, please find the number of integer sequences a1,a2,\xe2\x80\xa6,an with elements in [1,m], such that when used as input for Problem 101, the answer is k. As the answer can be very large, please print it modulo 109+7." 3500.0                                                
2002G "Lattice Optimizing" "bitmasks,brute force,hashing,meet-in-the-middle" "Consider a grid graph with n rows and n columns. Let the cell in row x and column y be (x,y). There exists a directed edge from (x,y) to (x+1,y), with non-negative integer value dx,y, for all 1\xe2\x89\xa4x<n,1\xe2\x89\xa4y\xe2\x89\xa4n, and there also exists a directed edge from (x,y) to (x,y+1), with non-negative integer value rx,y, for all 1\xe2\x89\xa4x\xe2\x89\xa4n,1\xe2\x89\xa4y<n.Initially, you are at (1,1), with an empty set S. You need to walk along the edges and eventually reach (n,n). Whenever you pass an edge, its value will be inserted into S. Please maximize the MEX\xe2\x88\x97 of S when you reach (n,n).\xe2\x88\x97The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:   The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0,1,2, and 3 belong to the array, but 4 does not." 3400.0                                                
2002D2 "DFS Checker (Hard Version)" "binary search,data structures,dfs and similar,graphs,hashing,trees" "This is the hard version of the problem. In this version, you are given a generic tree and the constraints on n and q are higher. You can make hacks only if both versions of the problem are solved.You are given a rooted tree consisting of n vertices. The vertices are numbered from 1 to n, and the root is the vertex 1. You are also given a permutation p1,p2,\xe2\x80\xa6,pn of [1,2,\xe2\x80\xa6,n].You need to answer q queries. For each query, you are given two integers x, y; you need to swap px and py and determine if p1,p2,\xe2\x80\xa6,pn is a valid DFS order\xe2\x80\xa0 of the given tree.Please note that the swaps are persistent through queries.\xe2\x80\xa0 A DFS order is found by calling the following dfs function on the given tree.dfs_order = []function dfs(v):    append v to the back of dfs_order    pick an arbitrary permutation s of children of v    for child in s:        dfs(child)dfs(1)Note that the DFS order is not unique." 2300.0                                                
2000G "Call During the Journey" "binary search,brute force,graphs,greedy,shortest paths" "You live in a city consisting of n intersections and m streets connecting some pairs of intersections. You can travel in either direction on each street. No two streets connect the same pair of intersections, and no street connects an intersection to itself. You can reach any intersection from any other, possibly passing through some other intersections.Every minute, you can board a bus at intersection ui and travel for li1 minutes to intersection vi. Conversely, you can travel from intersection vi to intersection ui in li1 minutes. You can only board and exit the bus at intersections. You can only board the bus at an intersection if you are currently there.You can also walk along each street, which takes li2>li1 minutes.You can make stops at intersections.You live at intersection number 1. Today you woke up at time 0, and you have an important event scheduled at intersection number n, which you must reach no later than time t0. You also have a phone call planned that will last from t1 to t2 minutes (t1<t2<t0). During the phone call, you cannot ride the bus, but you can walk along any streets, make stops, or stay at home. You can exit the bus at minute t1 and board the bus again at minute t2.Since you want to get enough sleep, you became curious \xe2\x80\x94 how late can you leave home to have time to talk on the phone and still not be late for the event?" 2100.0                                                
2000E "Photoshoot for Gorillas" "combinatorics,data structures,greedy,math" "You really love gorillas, so you decided to organize a photoshoot for them. Gorillas live in the jungle. The jungle is represented as a grid of n rows and m columns. w gorillas agreed to participate in the photoshoot, and the gorilla with index i (1\xe2\x89\xa4i\xe2\x89\xa4w) has a height of ai. You want to place all the gorillas in the cells of the grid such that there is no more than one gorilla in each cell.The spectacle of the arrangement is equal to the sum of the spectacles of all sub-squares of the grid with a side length of k.The spectacle of a sub-square is equal to the sum of the heights of the gorillas in it.From all suitable arrangements, choose the arrangement with the maximum spectacle." 1400.0                                                
2000B "Seating in a Bus" "two pointers" "In Berland, a bus consists of a row of n seats numbered from 1 to n. Passengers are advised to always board the bus following these rules:   If there are no occupied seats in the bus, a passenger can sit in any free seat; Otherwise, a passenger should sit in any free seat that has at least one occupied neighboring seat. In other words, a passenger can sit in a seat with index i (1\xe2\x89\xa4i\xe2\x89\xa4n) only if at least one of the seats with indices i\xe2\x88\x921 or i+1 is occupied. Today, n passengers boarded the bus. The array a chronologically records the seat numbers they occupied. That is, a1 contains the seat number where the first passenger sat, a2 \xe2\x80\x94 the seat number where the second passenger sat, and so on.You know the contents of the array a. Determine whether all passengers followed the recommendations.For example, if n=5, and a = [5,4,2,1,3], then the recommendations were not followed, as the 3-rd passenger sat in seat number 2, while the neighboring seats with numbers 1 and 3 were free." 800.0                                                
1999C Showering greedy,implementation "As a computer science student, Alex faces a hard challenge \xe2\x80\x94 showering. He tries to shower daily, but despite his best efforts there are always challenges. He takes s minutes to shower and a day only has m minutes! He already has n tasks planned for the day. Task i is represented as an interval (li, ri), which means that Alex is busy and can not take a shower in that time interval (at any point in time strictly between li and ri). No two tasks overlap.Given all n time intervals, will Alex be able to shower that day? In other words, will Alex have a free time interval of length at least s? In the first test case, Alex can shower for the first 3 minutes of the day and not miss any of the tasks." 800.0                                                
1998A "Find K Distinct Points with Fixed Center" "constructive algorithms,implementation,math" "I couldn\'t think of a good title for this problem, so I decided to learn from LeetCode.\xe2\x80\x94 Sun Tzu, The Art of WarYou are given three integers xc, yc, and k (\xe2\x88\x92100\xe2\x89\xa4xc,yc\xe2\x89\xa4100, 1\xe2\x89\xa4k\xe2\x89\xa41000). You need to find k distinct points (x1,y1), (x2,y2), \xe2\x80\xa6, (xk,yk), having integer coordinates, on the 2D coordinate plane such that:   their center\xe2\x88\x97 is (xc,yc)  \xe2\x88\x92109\xe2\x89\xa4xi,yi\xe2\x89\xa4109 for all i from 1 to k  It can be proven that at least one set of k distinct points always exists that satisfies these conditions.\xe2\x88\x97The center of k points (x1,y1), (x2,y2), \xe2\x80\xa6, (xk,yk) is (x1+x2+\xe2\x80\xa6+xkk,y1+y2+\xe2\x80\xa6+ykk)." 800.0                                                
1997E "Level Up" "binary search,brute force,data structures,divide and conquer,implementation" "Monocarp is playing a computer game. He starts the game being level 1. He is about to fight n monsters, in order from 1 to n. The level of the i-th monster is ai.For each monster in the given order, Monocarp\'s encounter goes as follows:  if Monocarp\'s level is strictly higher than the monster\'s level, the monster flees (runs away);  otherwise, Monocarp fights the monster. After every k-th fight with a monster (fleeing monsters do not count), Monocarp\'s level increases by 1. So, his level becomes 2 after k monsters he fights, 3 after 2k monsters, 4 after 3k monsters, and so on.You need to process q queries of the following form:  i x: will Monocarp fight the i-th monster (or will this monster flee) if the parameter k is equal to x?" 2200.0                                                
1994D "Funny Game" "constructive algorithms,dsu,graphs,greedy,math,number theory,trees" "Vanya has a graph with n vertices (numbered from 1 to n) and an array a of n integers; initially, there are no edges in the graph. Vanya got bored, and to have fun, he decided to perform n\xe2\x88\x921 operations.Operation number x (operations are numbered in order starting from 1) is as follows:  Choose 2 different numbers 1\xe2\x89\xa4u,v\xe2\x89\xa4n, such that |au\xe2\x88\x92av| is divisible by x.  Add an undirected edge between vertices u and v to the graph. Help Vanya get a connected\xe2\x88\x97 graph using the n\xe2\x88\x921 operations, or determine that it is impossible.\xe2\x88\x97A graph is called connected if it is possible to reach any vertex from any other by moving along the edges." 1900.0                                                
1992F "Valuable Cards" "brute force,dp,greedy,number theory,two pointers" "In his favorite cafe Kmes once again wanted to try the herring under a fur coat. Previously, it would not have been difficult for him to do this, but the cafe recently introduced a new purchasing policy.Now, in order to make a purchase, Kmes needs to solve the following problem: n cards with prices for different positions are laid out in front of him, on the i-th card there is an integer ai, among these prices there is no whole positive integer x.Kmes is asked to divide these cards into the minimum number of bad segments (so that each card belongs to exactly one segment). A segment is considered bad if it is impossible to select a subset of cards with a product equal to x. All segments, in which Kmes will divide the cards, must be bad.Formally, the segment (l,r) is bad if there are no indices i1<i2<\xe2\x80\xa6<ik such that l\xe2\x89\xa4i1,ik\xe2\x89\xa4r, and ai1\xe2\x8b\x85ai2\xe2\x80\xa6\xe2\x8b\x85aik=x.Help Kmes determine the minimum number of bad segments in order to enjoy his favorite dish." 1900.0                                                
1991H "Prime Split Game" "bitmasks,dp,fft,games,math,number theory" "Alice and Bob are playing a game with n piles of stones, where the i-th pile has ai stones. Players take turns making moves, with Alice going first.On each move, the player does the following three-step process:   Choose an integer k (1\xe2\x89\xa4k\xe2\x89\xa4n2). Note that the value of k can be different for different moves.  Remove k piles of stones.  Choose another k piles of stones and split each pile into two piles. The number of stones in each new pile must be a prime number. The player who is unable to make a move loses.Determine who will win if both players play optimally." 3300.0                                                
1989D "Smithing Skill" "brute force,data structures,dp,greedy,math,sortings,two pointers" "You are playing a famous computer game (that just works) where you have various skills you can level up. Today, you focused on the ""Smithing"" skill. Your tactic is obvious: forging weapons from ingots and then melting them back to return the materials partially. For simplicity, every time you create an item, you get 1 experience point, and every time you melt an item, you also get 1 experience point.There are n classes of weapons you can forge and m types of metal ingots.You can create one weapon of the i-th class, spending ai ingots of metal of the same type. Melting a weapon of the i-th class (which you crafted earlier) returns you bi ingots of the type of metal it was made of.You have cj metal ingots of the j-th type, and you know that you can craft a weapon of any class from any metal type. Each combination of a weapon class and a metal type can be used any number of times.What is the maximum total amount of experience you can earn by crafting and melting weapons?" 1900.0                                                
1987H "Fumo Temple" interactive "This temple only magnifies the mountain\'s power.BadelineThis is an interactive problem.You are given two positive integers n and m (n\xe2\x89\xa4m).The jury has hidden from you a rectangular matrix a with n rows and m columns, where ai,j\xe2\x88\x88{\xe2\x88\x921,0,1} for all 1\xe2\x89\xa4i\xe2\x89\xa4n and 1\xe2\x89\xa4j\xe2\x89\xa4m. The jury has also selected a cell (i0,j0). Your goal is to find (i0,j0).In one query, you give a cell (i,j), then the jury will reply with an integer.   If (i,j)=(i0,j0), the jury will reply with 0.  Else, let S be the sum of ax,y over all x and y such that min(i,i0)\xe2\x89\xa4x\xe2\x89\xa4max(i,i0) and min(j,j0)\xe2\x89\xa4y\xe2\x89\xa4max(j,j0). Then, the jury will reply with |i\xe2\x88\x92i0|+|j\xe2\x88\x92j0|+|S|. Find (i0,j0) by making at most n+225 queries.Note: the grader is not adaptive: a and (i0,j0) are fixed before any queries are made." 3500.0                                                
1987A "Upload More RAM" greedy,math "Oh no, the ForceCodes servers are running out of memory! Luckily, you can help them out by uploading some of your RAM!You want to upload n GBs of RAM. Every second, you will upload either 0 or 1 GB of RAM. However, there is a restriction on your network speed: in any k consecutive seconds, you can upload only at most 1 GB of RAM in total.Find the minimum number of seconds needed to upload n GBs of RAM!" 800.0                                                
1980G "Yasya and the Mysterious Tree" "bitmasks,data structures,dfs and similar,graphs,greedy,strings,trees" "Yasya was walking in the forest and accidentally found a tree with n vertices. A tree is a connected undirected graph with no cycles.Next to the tree, the girl found an ancient manuscript with m queries written on it. The queries can be of two types.The first type of query is described by the integer y. The weight of each edge in the tree is replaced by the bitwise exclusive OR of the weight of that edge and the integer y.The second type is described by the vertex v and the integer x. Yasya chooses a vertex u (1\xe2\x89\xa4u\xe2\x89\xa4n, u\xe2\x89\xa0v) and mentally draws a bidirectional edge of weight x from v to u in the tree.Then Yasya finds a simple cycle in the resulting graph and calculates the bitwise exclusive OR of all the edges in it. She wants to choose a vertex u such that the calculated value is maximum. This calculated value will be the answer to the query. It can be shown that such a cycle exists and is unique under the given constraints (independent of the choice of u). If an edge between v and u already existed, a simple cycle is the path v\xe2\x86\x92u\xe2\x86\x92v.Note that the second type of query is performed mentally, meaning the tree does not change in any way after it.Help Yasya answer all the queries." 2300.0                                                
1979D "Fixing a Binary String" "bitmasks,brute force,constructive algorithms,dp,greedy,hashing,strings" "You are given a binary string s of length n, consisting of zeros and ones. You can perform the following operation exactly once:  Choose an integer p (1\xe2\x89\xa4p\xe2\x89\xa4n).  Reverse the substring s1s2\xe2\x80\xa6sp. After this step, the string s1s2\xe2\x80\xa6sn will become spsp\xe2\x88\x921\xe2\x80\xa6s1sp+1sp+2\xe2\x80\xa6sn.  Then, perform a cyclic shift of the string s to the left p times. After this step, the initial string s1s2\xe2\x80\xa6sn will become sp+1sp+2\xe2\x80\xa6snspsp\xe2\x88\x921\xe2\x80\xa6s1. For example, if you apply the operation to the string 110001100110 with p=3, after the second step, the string will become 011001100110, and after the third step, it will become 001100110011.A string s is called k-proper if two conditions are met:  s1=s2=\xe2\x80\xa6=sk;  si+k\xe2\x89\xa0si for any i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k). For example, with k=3, the strings 000, 111000111, and 111000 are k-proper, while the strings 000000, 001100, and 1110000 are not.You are given an integer k, which is a divisor of n. Find an integer p (1\xe2\x89\xa4p\xe2\x89\xa4n) such that after performing the operation, the string s becomes k-proper, or determine that it is impossible. Note that if the string is initially k-proper, you still need to apply exactly one operation to it." 1800.0                                                
1979B "XOR Sequences" bitmasks,greedy "You are given two distinct non-negative integers x and y. Consider two infinite sequences a1,a2,a3,\xe2\x80\xa6 and b1,b2,b3,\xe2\x80\xa6, where  an=n\xe2\x8a\x95x;  bn=n\xe2\x8a\x95y. Here, x\xe2\x8a\x95y denotes the bitwise XOR operation of integers x and y.For example, with x=6, the first 8 elements of sequence a will look as follows: [7,4,5,2,3,0,1,14,\xe2\x80\xa6]. Note that the indices of elements start with 1.Your task is to find the length of the longest common subsegment\xe2\x80\xa0 of sequences a and b. In other words, find the maximum integer m such that ai=bj,ai+1=bj+1,\xe2\x80\xa6,ai+m\xe2\x88\x921=bj+m\xe2\x88\x921 for some i,j\xe2\x89\xa51.\xe2\x80\xa0A subsegment of sequence p is a sequence pl,pl+1,\xe2\x80\xa6,pr, where 1\xe2\x89\xa4l\xe2\x89\xa4r." 1000.0                                                
1978D Elections "data structures,greedy,implementation,math" "Elections are taking place in Berland. There are n candidates participating in the elections, numbered from 1 to n. The i-th candidate has ai fans who will vote for him. Additionally, there are c people who are undecided about their favorite candidate, let\'s call them undecided. Undecided people will vote for the candidate with the lowest number.The candidate who receives the maximum number of votes wins the elections, and if multiple candidates receive the same maximum number of votes, the candidate with the lowest number among them wins.You found these elections too boring and predictable, so you decided to exclude some candidates from them. If you do not allow candidate number i to participate in the elections, all ai of his fans will become undecided, and will vote for the candidate with the lowest number.You are curious to find, for each i from 1 to n, the minimum number of candidates that need to be excluded from the elections for candidate number i to win the elections." 1600.0                                                
1977E Tensor "constructive algorithms,graphs,interactive" "This is an interactive problem.You are given an integer n.The jury has hidden from you a directed graph with n vertices (numbered from 1 to n) and some number of edges. You additionally know that:   The graph only contains edges of the form i\xe2\x86\x90j, where 1\xe2\x89\xa4i<j\xe2\x89\xa4n.  For any three vertices 1\xe2\x89\xa4i<j<k\xe2\x89\xa4n, at least one of the following holds\xe2\x80\xa0:   Vertex i is reachable from vertex j, or  Vertex i is reachable from vertex k, or  Vertex j is reachable from vertex k.  You want to color each vertex in either black or white such that for any two vertices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) of the same color, vertex i is reachable from vertex j.To do that, you can ask queries of the following type:   ?  i  j \xe2\x80\x94 is vertex i reachable from vertex j (1\xe2\x89\xa4i<j\xe2\x89\xa4n)? Find any valid vertex coloring of the hidden graph in at most 2\xe2\x8b\x85n queries. It can be proven that such a coloring always exists.Note that the grader is not adaptive: the graph is fixed before any queries are made.\xe2\x80\xa0 Vertex a is reachable from vertex b if there exists a path from vertex b to vertex a in the graph." 2600.0                                                
1975H "378QAQ and Core" greedy,strings "378QAQ has a string s of length n. Define the core of a string as the substring\xe2\x80\xa0 with maximum lexicographic\xe2\x80\xa1 order.For example, the core of ""bazoka"" is ""zoka"", and the core of ""aaa"" is ""aaa"".378QAQ wants to rearrange the string s so that the core is lexicographically minimum. Find the lexicographically minimum possible core over all rearrangements of s.\xe2\x80\xa0 A substring of string s is a continuous segment of letters from s. For example, ""defor"", ""code"" and ""o"" are all substrings of ""codeforces"" while ""codes"" and ""aaa"" are not.\xe2\x80\xa1 A string p is lexicographically smaller than a string q if and only if one of the following holds:   p is a prefix of q, but p\xe2\x89\xa0q; or  in the first position where p and q differ, the string p has a smaller element than the corresponding element in q (when compared by their ASCII code). For example, ""code"" and ""coda"" are both lexicographically smaller than ""codeforces"" while ""codeforceston"" and ""z"" are not." 3500.0                                                
1975D "Paint the Tree" "brute force,dfs and similar,dp,greedy,shortest paths,trees" "378QAQ has a tree with n vertices. Initially, all vertices are white. There are two chess pieces called PA and PB on the tree. PA and PB are initially located on vertices a and b respectively. In one step, 378QAQ will do the following in order:  Move PA to a neighboring vertex. If the target vertex is white, this vertex will be painted red.  Move PB to a neighboring vertex. If the target vertex is colored in red, this vertex will be painted blue. Initially, the vertex a is painted red. If a=b, the vertex a is painted blue instead. Note that both the chess pieces must be moved in each step. Two pieces can be on the same vertex at any given time.378QAQ wants to know the minimum number of steps to paint all vertices blue." 1700.0                                                
1973C "Cat, Fox and Double Maximum" "constructive algorithms,greedy,implementation,math,sortings" "Fox loves permutations! She came up with the following problem and asked Cat to solve it:You are given an even positive integer n and a permutation\xe2\x80\xa0 p of length n. The score of another permutation q of length n is the number of local maximums in the array a of length n, where ai=pi+qi for all i (1\xe2\x89\xa4i\xe2\x89\xa4n). In other words, the score of q is the number of i such that 1<i<n (note the strict inequalities), ai\xe2\x88\x921<ai, and ai>ai+1 (once again, note the strict inequalities). Find the permutation q that achieves the maximum score for given n and p. If there exist multiple such permutations, you can pick any of them.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1700.0                                                
1973A "Chess For Three" "brute force,dp,implementation,math" "Three friends gathered to play a few games of chess together.In every game, two of them play against each other. The winner gets 2 points while the loser gets 0, and in case of a draw, both players get 1 point each. Note that the same pair of players could have played any non-negative number of times (possibly zero). It is also possible that no games were played at all. You\'ve been told that their scores after all the games were played were p1, p2 and p3. Additionally, it is guaranteed that p1\xe2\x89\xa4p2\xe2\x89\xa4p3 holds.Find the maximum number of draws that could have happened and print it. If there isn\'t any way to obtain p1, p2 and p3 as a result of a non-negative number of games between the three players, print \xe2\x88\x921 instead." 900.0                                                
1972A "Contest Proposal" "brute force,greedy,two pointers" "A contest contains n problems and the difficulty of the i-th problem is expected to be at most bi. There are already n problem proposals and the difficulty of the i-th problem is ai. Initially, both a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn are sorted in non-decreasing order.Some of the problems may be more difficult than expected, so the writers must propose more problems. When a new problem with difficulty w is proposed, the most difficult problem will be deleted from the contest, and the problems will be sorted in a way that the difficulties are non-decreasing.In other words, in each operation, you choose an integer w, insert it into the array a, sort array a in non-decreasing order, and remove the last element from it.Find the minimum number of new problems to make ai\xe2\x89\xa4bi for all i." 800.0                                                
1970F3 "Playing Quidditch (Hard)" implementation "This afternoon, you decided to enjoy the first days of Spring by taking a walk outside. As you come near the Quidditch field, you hear screams. Once again, there is a conflict about the score: the two teams are convinced that they won the game! To prevent this problem from happening one more time, you decide to get involved in the refereeing of the matches.Now, you will stay in the stadium to watch the game and count the score. At the end of the game, you will decide the winner.Today, two teams are competing: the red Gryffindor (R) and the blue Ravenclaw (B) team. Each team is composed of P players (1\xe2\x89\xa4P\xe2\x89\xa410).The field is a rectangle of N lines and M columns (3\xe2\x89\xa4N,M\xe2\x89\xa499, N and M are odd). All the positions are integers, and several entities are allowed to be at the same position in the field. At the beginning of the game, the field contains goals for the two teams (each team can own between one and five goals), the players, and exactly one Quaffle. In this version of the problem, one Bludger and a Golden Snitch can be present.A game is composed of T steps (0\xe2\x89\xa4T\xe2\x89\xa410000). At each step, one entity on the field (a player or a ball) performs one action. All entities can move. A player can also catch a ball or throw the Quaffle that it is carrying. To catch a ball, a player must be located on the same cell as it. The Quaffle does not perform any action while it is being carried; it only follows the movements of the player. If a player carrying the Quaffle decides to throw it, the Quaffle is simply put at the current position of the player. If a player is on the same cell as a Bludger (either after a movement from the player or the Bludger), the player is eliminated. If the player is eliminated while it is carrying the Quaffle, the Quaffle remains on the cell containing both the player and the Bludger after the move. It is guaranteed that this never occurs while the player is in a cell containing a goal.To win a point, a player must leave the Quaffle at a goal of the other team. When it does, the team of the player wins one point, and the Quaffle instantly moves to the middle of the field (the cell at the (M+1)/2-th column of the (N+1)/2-th line of the field, starting from 1). There is no goal in the middle of the field. If a player puts the ball in its own goal, the other team wins the point. If a player catches the Golden Snitch, their team wins 10 points and the game is over." 2300.0                                                
1970E3 "Trails (Hard)" dp,matrices "Harry Potter is hiking in the Alps surrounding Lake Geneva. In this area there are m cabins, numbered 1 to m. Each cabin is connected, with one or more trails, to a central meeting point next to the lake. Each trail is either short or long. Cabin i is connected with si short trails and li long trails to the lake.Each day, Harry walks a trail from the cabin where he currently is to Lake Geneva, and then from there he walks a trail to any of the m cabins (including the one he started in). However, as he has to finish the hike in a day, at least one of the two trails has to be short.How many possible combinations of trails can Harry take if he starts in cabin 1 and walks for n days?Give the answer modulo 109+7." 2200.0                                                
1970D2 "Arithmancy (Medium)" "constructive algorithms,interactive,probabilities,strings" "The only difference between the versions of this problem is the maximum value of n.Professor Vector is preparing to teach her Arithmancy class. She needs to prepare n distinct magic words for the class. Each magic word is a string consisting of characters X and O. A spell is a string created by concatenating two magic words together. The power of a spell is equal to the number of its different non-empty substrings. For example, the power of the spell XOXO is equal to 7, because it has 7 different substrings: X, O, XO, OX, XOX, OXO and XOXO.Each student will create their own spell by concatenating two magic words. Since the students are not very good at magic yet, they will choose each of the two words independently and uniformly at random from the n words provided by Professor Vector. It is therefore also possible that the two words a student chooses are the same. Each student will then compute the power of their spell, and tell it to Professor Vector. In order to check their work, and of course to impress the students, Professor Vector needs to find out which two magic words and in which order were concatenated by each student.Your program needs to perform the role of Professor Vector: first, create n distinct magic words, and then handle multiple requests where it is given the spell power and needs to determine the indices of the two magic words, in the correct order, that were used to create the corresponding spell." 2600.0                                                
1970B3 "Exact Neighbours (Hard)" "constructive algorithms" "After some recent attacks on Hogwarts Castle by the Death Eaters, the Order of the Phoenix has decided to station n members in Hogsmead Village. The houses will be situated on a picturesque n\xc3\x97n square field. Each wizard will have their own house, and every house will belong to some wizard. Each house will take up the space of one square.However, as you might know wizards are very superstitious. During the weekends, each wizard i will want to visit the house that is exactly ai (0\xe2\x89\xa4ai\xe2\x89\xa4n) away from their own house. The roads in the village are built horizontally and vertically, so the distance between points (xi,yi) and (xj,yj) on the n\xc3\x97n field is |xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|. The wizards know and trust each other, so one wizard can visit another wizard\'s house when the second wizard is away. The houses to be built will be big enough for all n wizards to simultaneously visit any house.Apart from that, each wizard is mandated to have a view of the Hogwarts Castle in the north and the Forbidden Forest in the south, so the house of no other wizard should block the view. In terms of the village, it means that in each column of the n\xc3\x97n field, there can be at most one house, i.e. if the i-th house has coordinates (xi,yi), then xi\xe2\x89\xa0xj for all i\xe2\x89\xa0j.The Order of the Phoenix doesn\'t yet know if it is possible to place n houses in such a way that will satisfy the visit and view requirements of all n wizards, so they are asking for your help in designing such a plan.If it is possible to have a correct placement, where for the i-th wizard there is a house that is ai away from it and the house of the i-th wizard is the only house in their column, output YES, the position of houses for each wizard, and to the house of which wizard should each wizard go during the weekends.If it is impossible to have a correct placement, output NO." 2300.0                                                
1970B2 "Exact Neighbours (Medium)" "constructive algorithms" "The only difference between this and the hard version is that a1=0.After some recent attacks on Hogwarts Castle by the Death Eaters, the Order of the Phoenix has decided to station n members in Hogsmead Village. The houses will be situated on a picturesque n\xc3\x97n square field. Each wizard will have their own house, and every house will belong to some wizard. Each house will take up the space of one square.However, as you might know wizards are very superstitious. During the weekends, each wizard i will want to visit the house that is exactly ai (0\xe2\x89\xa4ai\xe2\x89\xa4n) away from their own house. The roads in the village are built horizontally and vertically, so the distance between points (xi,yi) and (xj,yj) on the n\xc3\x97n field is |xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|. The wizards know and trust each other, so one wizard can visit another wizard\'s house when the second wizard is away. The houses to be built will be big enough for all n wizards to simultaneously visit any house.Apart from that, each wizard is mandated to have a view of the Hogwarts Castle in the north and the Forbidden Forest in the south, so the house of no other wizard should block the view. In terms of the village, it means that in each column of the n\xc3\x97n field, there can be at most one house, i.e. if the i-th house has coordinates (xi,yi), then xi\xe2\x89\xa0xj for all i\xe2\x89\xa0j.The Order of the Phoenix doesn\'t yet know if it is possible to place n houses in such a way that will satisfy the visit and view requirements of all n wizards, so they are asking for your help in designing such a plan.If it is possible to have a correct placement, where for the i-th wizard there is a house that is ai away from it and the house of the i-th wizard is the only house in their column, output YES, the position of houses for each wizard, and to the house of which wizard should each wizard go during the weekends.If it is impossible to have a correct placement, output NO." 2100.0                                                
1968D "Permutation Game" "brute force,dfs and similar,games,graphs,greedy,math" "Bodya and Sasha found a permutation p1,\xe2\x80\xa6,pn and an array a1,\xe2\x80\xa6,an. They decided to play a well-known ""Permutation game"".A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).Both of them chose a starting position in the permutation.The game lasts k turns. The players make moves simultaneously. On each turn, two things happen to each player:   If the current position of the player is x, his score increases by ax.  Then the player either stays at his current position x or moves from x to px.  The winner of the game is the player with the higher score after exactly k turns.Knowing Bodya\'s starting position PB and Sasha\'s starting position PS, determine who wins the game if both players are trying to win." 1300.0                                                
1968A Maximize? "brute force,math,number theory" "You are given an integer x. Your task is to find any integer y (1\xe2\x89\xa4y<x) such that gcd(x,y)+y is maximum possible.Note that if there is more than one y which satisfies the statement, you are allowed to find any.gcd(a,b) is the Greatest Common Divisor of a and b. For example, gcd(6,4)=2." 800.0                                                
1967E2 "Again Counting Arrays (Hard Version)" combinatorics,dp,math "This is the hard version of the problem. The differences between the two versions are the constraints on n,m,b0 and the time limit. You can make hacks only if both versions are solved.Little R has counted many sets before, and now she decides to count arrays.Little R thinks an array b0,\xe2\x80\xa6,bn consisting of non-negative integers is continuous if and only if, for each i such that 1\xe2\x89\xa4i\xe2\x89\xa4n, |bi\xe2\x88\x92bi\xe2\x88\x921|=1 is satisfied. She likes continuity, so she only wants to generate continuous arrays.If Little R is given b0 and a1,\xe2\x80\xa6,an, she will try to generate a non-negative continuous array b, which has no similarity with a. More formally, for all 1\xe2\x89\xa4i\xe2\x89\xa4n, ai\xe2\x89\xa0bi holds.However, Little R does not have any array a. Instead, she gives you n, m and b0. She wants to count the different integer arrays a1,\xe2\x80\xa6,an satisfying:  1\xe2\x89\xa4ai\xe2\x89\xa4m;  At least one non-negative continuous array b0,\xe2\x80\xa6,bn can be generated. Note that bi\xe2\x89\xa50, but the bi can be arbitrarily large.Since the actual answer may be enormous, please just tell her the answer modulo 998244353." 3500.0                                                
1966B "Rectangle Filling" "constructive algorithms,implementation" "There is an n\xc3\x97m grid of white and black squares. In one operation, you can select any two squares of the same color, and color all squares in the subrectangle between them that color.Formally, if you select positions (x1,y1) and (x2,y2), both of which are currently the same color c, set the color of all (x,y) where min(x1,x2)\xe2\x89\xa4x\xe2\x89\xa4max(x1,x2) and min(y1,y2)\xe2\x89\xa4y\xe2\x89\xa4max(y1,y2) to c.This diagram shows a sequence of two possible operations on a grid:  Is it possible for all squares in the grid to be the same color, after performing any number of operations (possibly zero)?" 1100.0                                                
1965F Conference "data structures,flows" "You have been asked to organize a very important art conference. The first step is to choose the dates.The conference must last for a certain number of consecutive days. Each day, one lecturer must perform, and the same lecturer cannot perform more than once.You asked n potential lecturers if they could participate in the conference. Lecturer i indicated that they could perform on any day from li to ri inclusive.A certain segment of days can be chosen as the conference dates if there is a way to assign an available lecturer to each day of the segment, assigning each lecturer to no more than one day.For each k from 1 to n, find how many ways there are to choose a segment of k consecutive days as the conference dates." 3300.0                                                
1958G "Observation Towers" "*special problem" "Consider a segment of an OX axis from 1 to n. There are k observation towers on this segment.Each tower has two parameters \xe2\x80\x94 the coordinate xi and the height hi. The coordinates of all towers are distinct. From tower i, you can see point j if |xi\xe2\x88\x92j|\xe2\x89\xa4hi (where |a| is an absolute value of a).You can increase the height of any tower by 1 for one coin. The height of each tower can be increased any number of times (including zero).You need to process q independent queries. In the i-th query, two different points l and r are given. You need to calculate the minimum number of coins required to be able to see both of these points (from one tower or from different towers)." 2400.0                                                
1957F1 "Frequency Mismatch (Easy Version)" "binary search,data structures,divide and conquer,hashing,probabilities,trees" "This is the easy version of the problem. The difference between the two versions of this problem is the constraint on k. You can make hacks only if all versions of the problem are solved.You are given an undirected tree of n nodes. Each node v has a value av written on it. You have to answer queries related to the tree.You are given q queries. In each query, you are given 5 integers, u1,v1,u2,v2,k. Denote the count of nodes with value c on path u1\xe2\x86\x92v1 with xc, and the count of nodes with value c on path u2\xe2\x86\x92v2 with yc. If there are z such values of c such that xc\xe2\x89\xa0yc, output any min(z,k) such values in any order." 2600.0                                                
1956A "Nene\'s Game" "binary search,brute force,data structures,games,greedy" "Nene invented a new game based on an increasing sequence of integers a1,a2,\xe2\x80\xa6,ak.In this game, initially n players are lined up in a row. In each of the rounds of this game, the following happens:  Nene finds the a1-th, a2-th, \xe2\x80\xa6, ak-th players in a row. They are kicked out of the game simultaneously. If the i-th player in a row should be kicked out, but there are fewer than i players in a row, they are skipped. Once no one is kicked out of the game in some round, all the players that are still in the game are declared as winners.For example, consider the game with a=[3,5] and n=5 players. Let the players be named player A, player B, \xe2\x80\xa6, player E in the order they are lined up initially. Then,   Before the first round, players are lined up as ABCDE. Nene finds the 3-rd and the 5-th players in a row. These are players C and E. They are kicked out in the first round.  Now players are lined up as ABD. Nene finds the 3-rd and the 5-th players in a row. The 3-rd player is player D and there is no 5-th player in a row. Thus, only player D is kicked out in the second round.  In the third round, no one is kicked out of the game, so the game ends after this round.  Players A and B are declared as the winners. Nene has not yet decided how many people would join the game initially. Nene gave you q integers n1,n2,\xe2\x80\xa6,nq and you should answer the following question for each 1\xe2\x89\xa4i\xe2\x89\xa4q independently:  How many people would be declared as winners if there are ni players in the game initially?" 800.0                                                
1955F "Unfair Game" dp,games,greedy,math,schedules "Alice and Bob gathered in the evening to play an exciting game on a sequence of n integers, each integer of the sequence doesn\'t exceed 4. The rules of the game are too complex to describe, so let\'s just describe the winning condition \xe2\x80\x94 Alice wins if the bitwise XOR of all the numbers in the sequence is non-zero; otherwise, Bob wins.The guys invited Eve to act as a judge. Initially, Alice and Bob play with n numbers. After one game, Eve removes one of the numbers from the sequence, then Alice and Bob play with n\xe2\x88\x921 numbers. Eve removes one number again, after which Alice and Bob play with n\xe2\x88\x922 numbers. This continues until the sequence of numbers is empty.Eve seems to think that in such a game, Alice almost always wins, so she wants Bob to win as many times as possible. Determine the maximum number of times Bob can win against Alice if Eve removes the numbers optimally." 1800.0                                                
1954C "Long Multiplication" "greedy,math,number theory" "You are given two integers x and y of the same length, consisting of digits from 1 to 9.You can perform the following operation any number of times (possibly zero): swap the i-th digit in x and the i-th digit in y.For example, if x=73 and y=31, you can swap the 2-nd digits and get x=71 and y=33.Your task is to maximize the product of x and y using the aforementioned operation any number of times. If there are multiple answers, print any of them." 1200.0                                                
1952J "Help, what does it mean to be ""Based""" "brute force,constructive algorithms,expression parsing,implementation,sortings" "InputSup, gimme a single integer x (1\xe2\x89\xa4x\xe2\x89\xa44) homie uwu :3OutputIf x=1, spit out some based code that, like when ya feed it two integers a and b, it hands over their sum.If x=2, slap some based code that takes an integer a and returns its absolute value like magic, no cap.If x=3, check this out: blaze some based code that grabs an integer n (1\xe2\x89\xa4n\xe2\x89\xa450) and an array a of n distinct integers, then flexes the maximum value real quick.If x=4, toss me some based code that snatches an integer n (1\xe2\x89\xa4n\xe2\x89\xa450), an array a of n distinct integers and an integer k (1\xe2\x89\xa4k\xe2\x89\xa4n), then nails down that k-th largest value in the array. Get it, fam!ExamplesInputCopy1OutputCopyyoink ayoink b*slaps a on top of b*yeet bgo touch some grassInputCopy2OutputCopyyoink abruh b is lowkey just 0rip this b fell off by avibe check a ratios bsimp for 7bruh a is lowkey just byeet ago touch some grassInputCopy3OutputCopyyoink nyoink abruh m is lowkey just a[0]bruh i is lowkey just 1vibe check n ratios isimp for 9yeet mgo touch some grassvibe check a[i] ratios mbruh m is lowkey just a[i]*slaps 1 on top of i*simp for 5InputCopy4OutputCopy NoteSlide into the ""My Submissions"" page and vibe check ur code by clicking on its ID. You\'ll see just how based or cringe it is." -999.0                                                
1952G "Mathematician Takeover" "binary search,dfs and similar,math" "A mathematician grabbed my computer as I was preparing this problem, deleted the statement, and changed the samples to fit his liking. The model solution and input/output format are still correct, but the samples are wrong. I\'ve partially fixed the problem so that when you submit, it will be tested against the correct version of the problem. However, I can\'t fix the samples below. As a computer scientist, can you solve the correct problem?" -999.0                                                
1951A "Dual Trigger" "constructive algorithms,greedy,math" "Ng\xe1\xbb\x8dt - L\xe1\xba\xa6N CU\xe1\xbb\x90I (\xc4\x91i b\xc3\xaan em x\xc3\xb3t xa ng\xc6\xb0\xe1\xbb\x9di \xc6\xa1i)\xe0\xb6\x9eThere are n lamps numbered 1 to n lined up in a row, initially turned off. You can perform the following operation any number of times (possibly zero):   Choose two non-adjacent\xe2\x80\xa0 lamps that are currently turned off, then turn them on. Determine whether you can reach configuration s, where si=1 means the i-th lamp is turned on, and si=0 otherwise.\xe2\x80\xa0 Only lamp i and i+1 are adjacent for all 1\xe2\x89\xa4i<n. Note that lamp n and 1 are not adjacent when n\xe2\x89\xa02." 900.0                                                
1949A Grove "brute force,dfs and similar,dp,geometry,probabilities" "You want to plant trees in a square lawn of size n\xc3\x97n whose corners have Cartesian coordinates (0,0), (n,0), (0,n), and (n,n). Trees can only be planted at locations with integer coordinates. Every tree will grow roots within a disk of radius r centered at the location where the tree was planted; such disks must be fully contained in the lawn (possibly touching the boundary of the lawn) and can only intersect each other on their boundaries.Find a configuration that maximizes the number of trees." 3300.0                                                
1945F "Kirill and Mushrooms" "data structures,sortings" "As soon as everyone in the camp fell asleep, Kirill sneaked out of the tent and went to the Wise Oak to gather mushrooms.It is known that there are n mushrooms growing under the Oak, each of which has magic power vi. Kirill really wants to make a magical elixir of maximum strength from the mushrooms.The strength of the elixir is equal to the product of the number of mushrooms in it and the minimum magic power among these mushrooms. To prepare the elixir, Kirill will sequentially pick one mushroom growing under the Oak. Kirill can gather mushrooms in any order.However, it\'s not that simple. The Wise Oak informed Kirill of a permutation of numbers p from 1 to n. If Kirill picks only k mushrooms, then the magic power of all mushrooms with indices p1,p2,\xe2\x80\xa6,pk\xe2\x88\x921 will become 0. Kirill will not use mushrooms with zero magic power to prepare the elixir.Your task is to help Kirill gather mushrooms in such a way that he can brew the elixir of maximum possible strength. However, Kirill is a little scared to stay near the oak for too long, so out of all the suitable options for gathering mushrooms, he asks you to find the one with the minimum number of mushrooms.A permutation of length n is an array consisting of n different integers from 1 to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears in the array twice) and [1,3,4] is also not a permutation (n=3, but 4 appears in the array)." 1900.0                                                
1942C1 "Bessie\'s Birthday Cake (Easy Version)" geometry,greedy,math "Proof Geometric Construction Can Solve All Love Affairs - manbo-p\xe2\xa0\x80This is the easy version of the problem. The only difference between the two versions is the constraint on y. In this version y=0. You can make hacks only if both versions are solved.Bessie has received a birthday cake from her best friend Elsie, and it came in the form of a regular polygon with n sides. The vertices of the cake are numbered from 1 to n clockwise. You and Bessie are going to choose some of those vertices to cut non-intersecting diagonals into the cake. In other words, the endpoints of the diagonals must be part of the chosen vertices.Bessie would only like to give out pieces of cake which result in a triangle to keep consistency. The size of the pieces doesn\'t matter, and the whole cake does not have to be separated into all triangles (other shapes are allowed in the cake, but those will not be counted). Bessie has already chosen x of those vertices that can be used to form diagonals. She wants you to choose no more than y other vertices such that the number of triangular pieces of cake she can give out is maximized.What is the maximum number of triangular pieces of cake Bessie can give out?" 1300.0                                                
1937B "Binary Path" dp,greedy,implementation "You are given a 2\xc3\x97n grid filled with zeros and ones. Let the number at the intersection of the i-th row and the j-th column be aij.There is a grasshopper at the top-left cell (1,1) that can only jump one cell right or downwards. It wants to reach the bottom-right cell (2,n). Consider the binary string of length n+1 consisting of numbers written in cells of the path without changing their order.Your goal is to:   Find the lexicographically smallest\xe2\x80\xa0 string you can attain by choosing any available path;  Find the number of paths that yield this lexicographically smallest string. \xe2\x80\xa0 If two strings s and t have the same length, then s is lexicographically smaller than t if and only if in the first position where s and t differ, the string s has a smaller element than the corresponding element in t." 1300.0                                                
1936B Pinball "binary search,data structures,implementation,math,two pointers" "There is a one-dimensional grid of length n. The i-th cell of the grid contains a character si, which is either \'<\' or \'>\'.When a pinball is placed on one of the cells, it moves according to the following rules:   If the pinball is on the i-th cell and si is \'<\', the pinball moves one cell to the left in the next second. If si is \'>\', it moves one cell to the right.  After the pinball has moved, the character si is inverted (i. e. if si used to be \'<\', it becomes \'>\', and vice versa).  The pinball stops moving when it leaves the grid: either from the left border or from the right one. You need to answer n independent queries. In the i-th query, a pinball will be placed on the i-th cell. Note that we always place a pinball on the initial grid.For each query, calculate how many seconds it takes the pinball to leave the grid. It can be shown that the pinball will always leave the grid within a finite number of steps." 2000.0                                                
1935F "Andrey\'s Tree" "binary search,constructive algorithms,data structures,dfs and similar,dsu,greedy,implementation,trees" "Master Andrey loves trees\xe2\x80\xa0 very much, so he has a tree consisting of n vertices.But it\'s not that simple. Master Timofey decided to steal one vertex from the tree. If Timofey stole vertex v from the tree, then vertex v and all edges with one end at vertex v are removed from the tree, while the numbers of other vertices remain unchanged. To prevent Andrey from getting upset, Timofey decided to make the resulting graph a tree again. To do this, he can add edges between any vertices a and b, but when adding such an edge, he must pay |a\xe2\x88\x92b| coins to the Master\'s Assistance Center.Note that the resulting tree does not contain vertex v.Timofey has not yet decided which vertex v he will remove from the tree, so he wants to know for each vertex 1\xe2\x89\xa4v\xe2\x89\xa4n, the minimum number of coins needed to be spent to make the graph a tree again after removing vertex v, as well as which edges need to be added.\xe2\x80\xa0A tree is an undirected connected graph without cycles." 2800.0                                                
1934E "Weird LCM Operations" "brute force,constructive algorithms,number theory" "Given an integer n, you construct an array a of n integers, where ai=i for all integers i in the range [1,n]. An operation on this array is defined as follows:  Select three distinct indices i, j, and k from the array, and let x=ai, y=aj, and z=ak.  Update the array as follows: ai=lcm(y,z), aj=lcm(x,z), and ak=lcm(x,y), where lcm represents the least common multiple.  Your task is to provide a possible sequence of operations, containing at most \xe2\x8c\x8an6\xe2\x8c\x8b+5 operations such that after executing these operations, if you create a set containing the greatest common divisors (GCDs) of all subsequences with a size greater than 1, then all numbers from 1 to n should be present in this set.After all the operations ai\xe2\x89\xa41018 should hold for all 1\xe2\x89\xa4i\xe2\x89\xa4n.We can show that an answer always exists." 3000.0                                                
1934B "Yet Another Coin Problem" "brute force,dp,greedy,math" "You have 5 different types of coins, each with a value equal to one of the first 5 triangular numbers: 1, 3, 6, 10, and 15. These coin types are available in abundance. Your goal is to find the minimum number of these coins required such that their total value sums up to exactly n.We can show that the answer always exists." 1200.0                                                
1933B "Turtle Math: Fast Three Task" "implementation,math,number theory" "You are given an array a1,a2,\xe2\x80\xa6,an.In one move, you can perform either of the following two operations:  Choose an element from the array and remove it from the array. As a result, the length of the array decreases by 1; Choose an element from the array and increase its value by 1. You can perform any number of moves. If the current array becomes empty, then no more moves can be made.Your task is to find the minimum number of moves required to make the sum of the elements of the array a divisible by 3. It is possible that you may need 0 moves.Note that the sum of the elements of an empty array (an array of length 0) is equal to 0." 800.0                                                
1931F "Chat Screenshots" "combinatorics,dfs and similar,graphs" "There are n people in the programming contest chat. Chat participants are ordered by activity, but each person sees himself at the top of the list.For example, there are 4 participants in the chat, and their order is [2,3,1,4]. Then   1-st user sees the order [1,2,3,4].  2-nd user sees the order [2,3,1,4].  3-rd user sees the order [3,2,1,4].  4-th user sees the order [4,2,3,1]. k people posted screenshots in the chat, which show the order of participants shown to this user. The screenshots were taken within a short period of time, and the order of participants has not changed. Your task is to determine whether there is a certain order that all screenshots correspond to." 1700.0                                                
1930A "Maximise The Score" greedy,sortings "There are 2n positive integers written on a whiteboard. Being bored, you decided to play a one-player game with the numbers on the whiteboard.You start with a score of 0. You will increase your score by performing the following move exactly n times:   Choose two integers x and y that are written on the whiteboard.  Add min(x,y) to your score.  Erase x and y from the whiteboard.  Note that after performing the move n times, there will be no more integers written on the whiteboard.Find the maximum final score you can achieve if you optimally perform the n moves." 800.0                                                
1929C "Sasha and the Casino" "binary search,brute force,constructive algorithms,games,greedy,math" "Sasha decided to give his girlfriend the best handbag, but unfortunately for Sasha, it is very expensive. Therefore, Sasha wants to earn it. After looking at earning tips on the internet, he decided to go to the casino.Sasha knows that the casino operates under the following rules. If Sasha places a bet of y coins (where y is a positive integer), then in case of winning, he will receive y\xe2\x8b\x85k coins (i.e., his number of coins will increase by y\xe2\x8b\x85(k\xe2\x88\x921)). And in case of losing, he will lose the entire bet amount (i.e., his number of coins will decrease by y).Note that the bet amount must always be a positive (>0) integer and cannot exceed Sasha\'s current number of coins.Sasha also knows that there is a promotion at the casino: he cannot lose more than x times in a row.Initially, Sasha has a coins. He wonders whether he can place bets such that he is guaranteed to win any number of coins. In other words, is it true that for any integer n, Sasha can make bets so that for any outcome that does not contradict the rules described above, at some moment of time he will have at least n coins." 1400.0                                                
1928F "Digital Patterns" "combinatorics,data structures,implementation,math" "Anya is engaged in needlework. Today she decided to knit a scarf from semi-transparent threads. Each thread is characterized by a single integer \xe2\x80\x94 the transparency coefficient.The scarf is made according to the following scheme: horizontal threads with transparency coefficients a1,a2,\xe2\x80\xa6,an and vertical threads with transparency coefficients b1,b2,\xe2\x80\xa6,bm are selected. Then they are interwoven as shown in the picture below, forming a piece of fabric of size n\xc3\x97m, consisting of exactly nm nodes:  Example of a piece of fabric for n=m=4. After the interweaving tightens and there are no gaps between the threads, each node formed by a horizontal thread with number i and a vertical thread with number j will turn into a cell, which we will denote as (i,j). Cell (i,j) will have a transparency coefficient of ai+bj.The interestingness of the resulting scarf will be the number of its sub-squares\xe2\x80\xa0 in which there are no pairs of neighboring\xe2\x80\xa0\xe2\x80\xa0 cells with the same transparency coefficients.Anya has not yet decided which threads to use for the scarf, so you will also be given q queries to increase/decrease the coefficients for the threads on some ranges. After each query of which you need to output the interestingness of the resulting scarf.\xe2\x80\xa0A sub-square of a piece of fabric is defined as the set of all its cells (i,j), such that x0\xe2\x89\xa4i\xe2\x89\xa4x0+d and y0\xe2\x89\xa4j\xe2\x89\xa4y0+d for some integers x0, y0, and d (1\xe2\x89\xa4x0\xe2\x89\xa4n\xe2\x88\x92d, 1\xe2\x89\xa4y0\xe2\x89\xa4m\xe2\x88\x92d, d\xe2\x89\xa50).\xe2\x80\xa0\xe2\x80\xa0. Cells (i1,j1) and (i2,j2) are neighboring if and only if |i1\xe2\x88\x92i2|+|j1\xe2\x88\x92j2|=1." 2900.0                                                
1928D "Lonely Mountain Dungeons" "brute force,data structures,greedy,math,ternary search" "Once, the people, elves, dwarves, and other inhabitants of Middle-earth gathered to reclaim the treasures stolen from them by Smaug. In the name of this great goal, they rallied around the powerful elf Timothy and began to plan the overthrow of the ruler of the Lonely Mountain.The army of Middle-earth inhabitants will consist of several squads. It is known that each pair of creatures of the same race, which are in different squads, adds b units to the total strength of the army. But since it will be difficult for Timothy to lead an army consisting of a large number of squads, the total strength of an army consisting of k squads is reduced by (k\xe2\x88\x921)\xe2\x8b\x85x units. Note that the army always consists of at least one squad.It is known that there are n races in Middle-earth, and the number of creatures of the i-th race is equal to ci. Help the inhabitants of Middle-earth determine the maximum strength of the army they can assemble." 1900.0                                                
1928B Equalize "binary search,greedy,sortings,two pointers" "Vasya has two hobbies \xe2\x80\x94 adding permutations\xe2\x80\xa0 to arrays and finding the most frequently occurring element. Recently, he found an array a and decided to find out the maximum number of elements equal to the same number in the array a that he can obtain after adding some permutation to the array a.More formally, Vasya must choose exactly one permutation p1,p2,p3,\xe2\x80\xa6,pn of length n, and then change the elements of the array a according to the rule ai:=ai+pi. After that, Vasya counts how many times each number occurs in the array a and takes the maximum of these values. You need to determine the maximum value he can obtain.\xe2\x80\xa0A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1200.0                                                
1927E "Klever Permutation" "constructive algorithms,math,two pointers" "You are given two integers n and k (k\xe2\x89\xa4n), where k is even.A permutation of length n is an array consisting of n distinct integers from 1 to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (as 2 appears twice in the array) and [0,1,2] is also not a permutation (as n=3, but 3 is not present in the array).Your task is to construct a k-level permutation of length n.A permutation is called k-level if, among all the sums of continuous segments of length k (of which there are exactly n\xe2\x88\x92k+1), any two sums differ by no more than 1.More formally, to determine if the permutation p is k-level, first construct an array s of length n\xe2\x88\x92k+1, where si=\xe2\x88\x91i+k\xe2\x88\x921j=ipj, i.e., the i-th element is equal to the sum of pi,pi+1,\xe2\x80\xa6,pi+k\xe2\x88\x921.A permutation is called k-level if max(s)\xe2\x88\x92min(s)\xe2\x89\xa41.Find any k-level permutation of length n." 1400.0                                                
1927B "Following the String" "constructive algorithms,greedy,strings" "Polycarp lost the string s of length n consisting of lowercase Latin letters, but he still has its trace.The trace of the string s is an array a of n integers, where ai is the number of such indices j (j<i) that si=sj. For example, the trace of the string abracadabra is the array [0,0,0,1,0,2,0,3,1,1,4].Given a trace of a string, find any string s from which it could have been obtained. The string s should consist only of lowercase Latin letters a-z." 900.0                                                
1923E "Count Paths" "data structures,dfs and similar,dp,dsu,graphs,trees" "You are given a tree, consisting of n vertices, numbered from 1 to n. Every vertex is colored in some color, denoted by an integer from 1 to n.A simple path of the tree is called beautiful if:   it consists of at least 2 vertices;  the first and the last vertices of the path have the same color;  no other vertex on the path has the same color as the first vertex. Count the number of the beautiful simple paths of the tree. Note that paths are considered undirected (i. e. the path from x to y is the same as the path from y to x)." 2000.0                                                
1923D Slimes "binary search,constructive algorithms,data structures,greedy,two pointers" "There are n slimes placed in a line. The slimes are numbered from 1 to n in order from left to right. The size of the i-th slime is ai.Every second, the following happens: exactly one slime eats one of its neighbors and increases its size by the eaten neighbor\'s size. A slime can eat its neighbor only if it is strictly bigger than this neighbor. If there is no slime which is strictly bigger than one of its neighbors, the process ends.For example, suppose n=5, a=[2,2,3,1,4]. The process can go as follows:  first, the 3-rd slime eats the 2-nd slime. The size of the 3-rd slime becomes 5, the 2-nd slime is eaten.  then, the 3-rd slime eats the 1-st slime (they are neighbors since the 2-nd slime is already eaten). The size of the 3-rd slime becomes 7, the 1-st slime is eaten.  then, the 5-th slime eats the 4-th slime. The size of the 5-th slime becomes 5, the 4-th slime is eaten.  then, the 3-rd slime eats the 5-th slime (they are neighbors since the 4-th slime is already eaten). The size of the 3-rd slime becomes 12, the 5-th slime is eaten. For each slime, calculate the minimum number of seconds it takes for this slime to be eaten by another slime (among all possible ways the process can go), or report that it is impossible." 1800.0                                                
1922D "Berserk Monsters" "brute force,data structures,dsu,implementation,math" "Monocarp is playing a computer game (yet again). Guess what is he doing? That\'s right, killing monsters.There are n monsters in a row, numbered from 1 to n. The i-th monster has two parameters: attack value equal to ai and defense value equal to di. In order to kill these monsters, Monocarp put a berserk spell on them, so they\'re attacking each other instead of Monocarp\'s character.The fight consists of n rounds. Every round, the following happens:  first, every alive monster i deals ai damage to the closest alive monster to the left (if it exists) and the closest alive monster to the right (if it exists);  then, every alive monster j which received more than dj damage during this round dies. I.\xe2\x80\x89e. the j-th monster dies if and only if its defense value dj is strictly less than the total damage it received this round. For each round, calculate the number of monsters that will die during that round." 1900.0                                                
1921C "Sending Messages" greedy,math "Stepan is a very busy person. Today he needs to send n messages at moments m1,m2,\xe2\x80\xa6mn (mi<mi+1). Unfortunately, by the moment 0, his phone only has f units of charge left. At the moment 0, the phone is turned on.The phone loses a units of charge for each unit of time it is on. Also, at any moment, Stepan can turn off the phone and turn it on later. This action consumes b units of energy each time. Consider turning on and off to be instantaneous, so you can turn it on at moment x and send a message at the same moment, and vice versa, send a message at moment x and turn off the phone at the same moment.If at any point the charge level drops to 0 (becomes \xe2\x89\xa40), it is impossible to send a message at that moment.Since all messages are very important to Stepan, he wants to know if he can send all the messages without the possibility of charging the phone." 900.0                                                
1917F "Construct Tree" "bitmasks,constructive algorithms,dp,trees" "You are given an array of integers l1,l2,\xe2\x80\xa6,ln and an integer d. Is it possible to construct a tree satisfying the following three conditions?  The tree contains n+1 nodes.  The length of the i-th edge is equal to li.  The (weighted) diameter of the tree is equal to d." 2500.0                                                
1916E "Happy Life in University" "data structures,dfs and similar,greedy,trees" "Egor and his friend Arseniy are finishing school this year and will soon enter university. And since they are very responsible guys, they have started preparing for admission already.First of all, they decided to take care of where they will live for the long four years of study, and after visiting the university\'s website, they found out that the university dormitory can be represented as a root tree with n vertices with the root at vertex 1. In the tree, each vertex represents a recreation with some type of activity ai. The friends need to choose 2 recreations (not necessarily different) in which they will settle. The guys are convinced that the more the value of the following function f(u,v)=diff(u,lca(u,v))\xe2\x8b\x85diff(v,lca(u,v)), the more fun their life will be. Help Egor and Arseniy and find the maximum value of f(u,v) among all pairs of recreations!\xe2\x80\xa0diff(u,v) \xe2\x80\x94 the number of different activities listed on the simple path from vertex u to vertex v.\xe2\x80\xa0lca(u,v) \xe2\x80\x94 a vertex p such that it is at the maximum distance from the root and is a parent of both vertex u and vertex v." 2300.0                                                
1915G Bicycles "graphs,greedy,implementation,shortest paths,sortings" "All of Slavic\'s friends are planning to travel from the place where they live to a party using their bikes. And they all have a bike except Slavic. There are n cities through which they can travel. They all live in the city 1 and want to go to the party located in the city n. The map of cities can be seen as an undirected graph with n nodes and m edges. Edge i connects cities ui and vi and has a length of wi.Slavic doesn\'t have a bike, but what he has is money. Every city has exactly one bike for sale. The bike in the i-th city has a slowness factor of si. Once Slavic buys a bike, he can use it whenever to travel from the city he is currently in to any neighboring city, by taking wi\xe2\x8b\x85sj time, considering he is traversing edge i using a bike j he owns.Slavic can buy as many bikes as he wants as money isn\'t a problem for him. Since Slavic hates traveling by bike, he wants to get from his place to the party in the shortest amount of time possible. And, since his informatics skills are quite rusty, he asks you for help.What\'s the shortest amount of time required for Slavic to travel from city 1 to city n? Slavic can\'t travel without a bike. It is guaranteed that it is possible for Slavic to travel from city 1 to any other city." 1800.0                                                
1914A "Problemsolving Log" implementation,strings "Monocarp is participating in a programming contest, which features 26 problems, named from \'A\' to \'Z\'. The problems are sorted by difficulty. Moreover, it\'s known that Monocarp can solve problem \'A\' in 1 minute, problem \'B\' in 2 minutes, ..., problem \'Z\' in 26 minutes.After the contest, you discovered his contest log \xe2\x80\x94 a string, consisting of uppercase Latin letters, such that the i-th letter tells which problem Monocarp was solving during the i-th minute of the contest. If Monocarp had spent enough time in total on a problem to solve it, he solved it. Note that Monocarp could have been thinking about a problem after solving it.Given Monocarp\'s contest log, calculate the number of problems he solved during the contest." 800.0                                                
1913E "Matrix Problem" flows,graphs "You are given a matrix a, consisting of n rows by m columns. Each element of the matrix is equal to 0 or 1.You can perform the following operation any number of times (possibly zero): choose an element of the matrix and replace it with either 0 or 1.You are also given two arrays A and B (of length n and m respectively). After you perform the operations, the matrix should satisfy the following conditions:  the number of ones in the i-th row of the matrix should be exactly Ai for every i\xe2\x88\x88[1,n].  the number of ones in the j-th column of the matrix should be exactly Bj for every j\xe2\x88\x88[1,m]. Calculate the minimum number of operations you have to perform." 2400.0                                                
1910G "Pool Records" "*special problem,greedy" "Alice and Bob are swimming in the pool under the guidance of their instructor Monocarp.The pool can be represented as a segment on the OX-axis from 0 to 50. Both Alice and Bob started at moment 0 at point 0 with positive real speeds vA and vB correspondingly.Both Alice and Bob swim from 0 to point 50, then instantly turn back and swim from 50 to 0. At 0 they turn back again and swim to 50 and so on.Monocarp logged all valuable info about Alice and Bob, including moments of time when they met at the same point (Alice and Bob swim on parallel lanes, so they don\'t bother each other). Let\'s name that moments of time as sequence t1,t2,\xe2\x80\xa6,tn.Due to some incident, Monocarp lost almost all data he recorded, and all he has now is array t. Monocarp remembers that Alice and Bob had distinct positive real swimming speeds vA and vB (vA>0; vB>0; vA\xe2\x89\xa0vB) and that sequence t contains the first n meeting moments.But looking at sequence t he noticed that all ti are integer values, and now he doubts is sequence t valid or there are some errors in it. Help Monocarp to check array t!" 2700.0                                                
1910F "Build Railway Stations" "*special problem,greedy,trees" "Monocarp is playing a computer game where he\'s controlling an empire. An empire consists of n cities, connected by n\xe2\x88\x921 roads. The cities are numbered from 1 to n. It\'s possible to reach every city from every other one using the roads.Traversing every road takes 2 hours. However, that can be improved. Monocarp can build railway stations in no more than k cities. After they are built, all existing roads that connect two cities with railway stations get converted to railroads and become 1 hour to traverse.Let f(x,y) be the total time it takes to traverse the roads on the shortest path between cities x and y.Monocarp wants to build at most k railway stations in such a way that the following value is minimized: n\xe2\x88\x91v=1v\xe2\x88\x921\xe2\x88\x91u=1f(v,u) (the total time it takes to travel from every city to every other one). What the smallest value he can achieve?" 2000.0                                                
1907G Lights "brute force,constructive algorithms,dfs and similar,graphs,greedy,implementation" "In the end of the day, Anna needs to turn off the lights in the office. There are n lights and n light switches, but their operation scheme is really strange. The switch i changes the state of light i, but it also changes the state of some other light ai (change the state means that if the light was on, it goes off and vice versa).Help Anna to turn all the lights off using minimal number of switches, or say it is impossible." 2200.0                                                
1906D "Spaceship Exploration" "binary search,geometry" "In The ICPC Galaxy, there exists a zone filled with asteroids that is unsafe to enter. The map of the galaxy is represented in a 2D Cartesian coordinate system. The zone is in the shape of an N-sided convex polygon. Each corner is numbered from 1 to N; corner i is located at (Xi,Yi). At any moment, you should not be inside this polygon; however, it is safe to touch the side of the polygon.There are Q scenarios (numbered from 1 to Q). In scenario j, you want to go from a starting point at (Aj,Bj) to an ending point at (Cj,Dj). You will be riding on a special spaceship that can only travel in a straight line. First, you set the direction of the spaceship, then the spaceship will start traveling in that direction. During the travel, you are only allowed to change direction at most once. Changing direction means you stop the spaceship, set a new direction, and then start traveling again in the new direction.For each scenario, determine the minimum distance required to travel without being inside of the zone at any moment, or report if it is impossible to reach the ending point." 2800.0                                                
1906A "Easy As ABC" "brute force" "You are playing a word puzzle. The puzzle starts with a 3 by 3 grid, where each cell contains either the letter A, B, or C.The goal of this puzzle is to find the lexicographically smallest possible word of length 3. The word can be formed by choosing three different cells where the cell containing the first letter is adjacent to the cell containing the second letter, and the cell containing the second letter is adjacent to the cell containing the third letter.Two cells are adjacent to each other if they share a border or a corner, as shown in the following illustration. Formally, if (r,c) denotes the cell in the r-th row and c-th column, then cell (r,c) is adjacent to cell (r,c+1), (r\xe2\x88\x921,c+1), (r\xe2\x88\x921,c), (r\xe2\x88\x921,c\xe2\x88\x921), (r,c\xe2\x88\x921), (r+1,c\xe2\x88\x921), (r+1,c), and (r+1,c+1).  Determine the lexicographically smallest possible word of length 3 that you can find within the grid.A string s of length n is lexicographically smaller than string t of the same length if there exists an integer 1\xe2\x89\xa4i\xe2\x89\xa4n such that sj=tj for all 1\xe2\x89\xa4j<i, and si<ti in alphabetical order. The following illustration shows some examples on some grids and their the lexicographically smallest possible word of length 3 that you can find within the grids." 1000.0                                                
1901F Landscaping "binary search,geometry,two pointers" "You are appointed to a very important task: you are in charge of flattening one specific road.The road can be represented as a polygonal line starting at (0,0), ending at (n\xe2\x88\x921,0) and consisting of n vertices (including starting and ending points). The coordinates of the i-th vertex of the polyline are (i,ai).""Flattening"" road is equivalent to choosing some line segment from (0,y0) to (n\xe2\x88\x921,y1) such that all points of the polyline are below the chosen segment (or on the same height). Values y0 and y1 may be real.You can imagine that the road has some dips and pits, and you start pouring pavement onto it until you make the road flat. Points 0 and n\xe2\x88\x921 have infinitely high walls, so pavement doesn\'t fall out of segment [0,n\xe2\x88\x921].  The cost of flattening the road is equal to the area between the chosen segment and the polyline. You want to minimize the cost, that\'s why the flattened road is not necessary horizontal.But there is a problem: your data may be too old, so you sent a person to measure new heights. The person goes from 0 to n\xe2\x88\x921 and sends you new heights bi of each vertex i of the polyline.Since measuring new heights may take a while, and you don\'t know when you\'ll be asked, calculate the minimum cost (and corresponding y0 and y1) to flatten the road after each new height bi you get." 2900.0                                                
1896G "Pepe Racing" "constructive algorithms,implementation,interactive,sortings" "This is an interactive problem.There are n2 pepes labeled 1,2,\xe2\x80\xa6,n2 with pairwise distinct speeds. You would like to set up some races to find out the relative speed of these pepes.In one race, you can choose exactly n distinct pepes and make them race against each other. After each race, you will only know the fastest pepe of these n pepes.Can you order the n2\xe2\x88\x92n+1 fastest pepes in at most 2n2\xe2\x88\x922n+1 races? Note that the slowest n\xe2\x88\x921 pepes are indistinguishable from each other.Note that the interactor is adaptive. That is, the relative speeds of the pepes are not fixed in the beginning and may depend on your queries. But it is guaranteed that at any moment there is at least one initial configuration of pepes such that all the answers to the queries are consistent." 3200.0                                                
1896E "Permutation Sorting" "data structures,sortings" "You are given a permutation\xe2\x80\xa0 a of size n. We call an index i good if ai=i is satisfied. After each second, we rotate all indices that are not good to the right by one position. Formally,  Let s1,s2,\xe2\x80\xa6,sk be the indices of a that are not good in increasing order. That is, sj<sj+1 and if index i is not good, then there exists j such that sj=i.  For each i from 1 to k, we assign as(i%k+1):=asi all at once. For each i from 1 to n, find the first time that index i becomes good. \xe2\x80\xa0 A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2100.0                                                
1895D "XOR Construction" "bitmasks,constructive algorithms,data structures,math,string suffix structures,trees" "You are given n\xe2\x88\x921 integers a1,a2,\xe2\x80\xa6,an\xe2\x88\x921.Your task is to construct an array b1,b2,\xe2\x80\xa6,bn such that:  every integer from 0 to n\xe2\x88\x921 appears in b exactly once;  for every i from 1 to n\xe2\x88\x921, bi\xe2\x8a\x95bi+1=ai (where \xe2\x8a\x95 denotes the bitwise XOR operator)." 1900.0                                                
1895C "Torn Lucky Ticket" "brute force,dp,hashing,implementation,math" "A ticket is a non-empty string of digits from 1 to 9.A lucky ticket is such a ticket that:   it has an even length;  the sum of digits in the first half is equal to the sum of digits in the second half. You are given n ticket pieces s1,s2,\xe2\x80\xa6,sn. How many pairs (i,j) (for 1\xe2\x89\xa4i,j\xe2\x89\xa4n) are there such that si+sj is a lucky ticket? Note that it\'s possible that i=j.Here, the + operator denotes the concatenation of the two strings. For example, if si is 13, and sj is 37, then si+sj is 1337." 1400.0                                                
1891E "Brukhovich and Exams" "brute force,greedy,implementation,math,sortings" "The boy Smilo is learning algorithms with a teacher named Brukhovich.Over the course of the year, Brukhovich will administer n exams. For each exam, its difficulty ai is known, which is a non-negative integer.Smilo doesn\'t like when the greatest common divisor of the difficulties of two consecutive exams is equal to 1. Therefore, he considers the sadness of the academic year to be the number of such pairs of exams. More formally, the sadness is the number of indices i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) such that gcd(ai,ai+1)=1, where gcd(x,y) is the greatest common divisor of integers x and y.Brukhovich wants to minimize the sadness of the year of Smilo. To do this, he can set the difficulty of any exam to 0. However, Brukhovich doesn\'t want to make his students\' lives too easy. Therefore, he will perform this action no more than k times.Help Smilo determine the minimum sadness that Brukhovich can achieve if he performs no more than k operations.As a reminder, the greatest common divisor (GCD) of two non-negative integers x and y is the maximum integer that is a divisor of both x and y and is denoted as gcd(x,y). In particular, gcd(x,0)=gcd(0,x)=x for any non-negative integer x." 2500.0                                                
1891D "Suspicious logarithms" "binary search,brute force,math" "Let f(x) be the floor of the binary logarithm of x. In other words, f(x) is largest non-negative integer y, such that 2y does not exceed x.Let g(x) be the floor of the logarithm of x with base f(x). In other words, g(x) is the largest non-negative integer z, such that f(x)z does not exceed x.You are given q queries. The i-th query consists of two integers li and ri. The answer to the query is the sum of g(k) across all integers k, such that li\xe2\x89\xa4k\xe2\x89\xa4ri. Since the answers might be large, print them modulo 109+7." 1900.0                                                
1891C "Smilo and Monsters" "binary search,constructive algorithms,greedy,sortings,two pointers" "A boy called Smilo is playing a new game! In the game, there are n hordes of monsters, and the i-th horde contains ai monsters. The goal of the game is to destroy all the monsters. To do this, you have two types of attacks and a combo counter x, initially set to 0:  The first type: you choose a number i from 1 to n, such that there is at least one monster left in the horde with the number i. Then, you kill one monster from horde number i, and the combo counter x increases by 1.  The second type: you choose a number i from 1 to n, such that there are at least x monsters left in the horde with number i. Then, you use an ultimate attack and kill x monsters from the horde with number i. After that, x is reset to zero.Your task is to destroy all of the monsters, meaning that there should be no monsters left in any of the hordes. Smilo wants to win as quickly as possible, so he wants to the minimum number of attacks required to win the game." 1500.0                                                
1887D Split "binary search,data structures,divide and conquer,dsu,math,trees,two pointers" "Let\'s call an array b1,b2,\xe2\x80\xa6,bm (m\xe2\x89\xa52) good if it can be split into two parts such that all elements in the left part are strictly smaller than all elements in the right part. In other words, there must exist an index 1\xe2\x89\xa4i<m such that every element from b1,\xe2\x80\xa6,bi is strictly smaller than every element from bi+1,\xe2\x80\xa6,bm.Given an array a1,a2,\xe2\x80\xa6an consisting of distinct integers from 1 to n. There are q queries. Each query consists of two numbers l and r. For each query, determine whether the array al,al+1,\xe2\x80\xa6,ar is good." 2700.0                                                
1883G2 "Dances (Hard Version)" "binary search,greedy,sortings,two pointers" "This is the hard version of the problem. The only difference is that in this version m\xe2\x89\xa4109.You are given two arrays of integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn. Before applying any operations, you can reorder the elements of each array as you wish. Then, in one operation, you will perform both of the following actions, if the arrays are not empty: Choose any element from array a and remove it (all remaining elements are shifted to a new array a), Choose any element from array b and remove it (all remaining elements are shifted to a new array b).Let k be the final size of both arrays. You need to find the minimum number of operations required to satisfy ai<bi for all 1\xe2\x89\xa4i\xe2\x89\xa4k.This problem was too easy, so the problem author decided to make it more challenging. You are also given a positive integer m. Now, you need to find the sum of answers to the problem for m pairs of arrays (c[i],b), where 1\xe2\x89\xa4i\xe2\x89\xa4m. Array c[i] is obtained from a as follows: c[i]1=i, c[i]j=aj, for 2\xe2\x89\xa4j\xe2\x89\xa4n." 1900.0                                                
1881G "Anya and the Mysterious String" "binary search,data structures" "Anya received a string s of length n brought from Rome. The string s consists of lowercase Latin letters and at first glance does not raise any suspicions. An instruction was attached to the string.Start of the instruction.A palindrome is a string that reads the same from left to right and right to left. For example, the strings ""anna"", ""aboba"", ""level"" are palindromes, while the strings ""gorilla"", ""banan"", ""off"" are not.A substring [l\xe2\x80\xa6r] of string s is a string slsl+1\xe2\x80\xa6sr\xe2\x88\x921sr. For example, the substring [4\xe2\x80\xa66] of the string ""generation"" is the string ""era"".A string is called beautiful if it does not contain a substring of length at least two that is a palindrome. For example, the strings ""fox"", ""abcdef"", and ""yioy"" are beautiful, while the strings ""xyxx"", ""yikjkitrb"" are not.When an integer x is added to the character si, it is replaced x times with the next character in the alphabet, with ""z"" being replaced by ""a"".When an integer x is added to the substring [l,r] of string s, it becomes the string s1s2\xe2\x80\xa6sl\xe2\x88\x921(sl+x)(sl+1+x)\xe2\x80\xa6(sr\xe2\x88\x921+x)(sr+x)sr+1\xe2\x80\xa6sn. For example, when the substring [2,4] of the string ""abazaba"" is added with the number 6, the resulting string is ""ahgfaba"".End of the instruction.After reading the instruction, Anya resigned herself to the fact that she has to answer m queries. The queries can be of two types:  Add the number x to the substring [l\xe2\x80\xa6r] of string s.  Determine whether the substring [l\xe2\x80\xa6r] of string s is beautiful." 2000.0                                                
2035E Monster "binary search,brute force,constructive algorithms,greedy,implementation,math,ternary search" "Man, this Genshin boss is so hard. Good thing they have a top-up of 6 coins for only $4.99. I should be careful and spend no more than I need to, lest my mom catches me...You are fighting a monster with z health using a weapon with d damage. Initially, d=0. You can perform the following operations.  Increase d \xe2\x80\x94 the damage of your weapon by 1, costing x coins.  Attack the monster, dealing d damage and costing y coins. You cannot perform the first operation for more than k times in a row.Find the minimum number of coins needed to defeat the monster by dealing at least z damage." 2300.0                                                
2033B "Sakurako and Water" "brute force,constructive algorithms,greedy" "During her journey with Kosuke, Sakurako and Kosuke found a valley that can be represented as a matrix of size n\xc3\x97n, where at the intersection of the i-th row and the j-th column is a mountain with a height of ai,j. If ai,j<0, then there is a lake there.Kosuke is very afraid of water, so Sakurako needs to help him:  With her magic, she can select a square area of mountains and increase the height of each mountain on the main diagonal of that area by exactly one. More formally, she can choose a submatrix with the upper left corner located at (i,j) and the lower right corner at (p,q), such that p\xe2\x88\x92i=q\xe2\x88\x92j. She can then add one to each element at the intersection of the (i+k)-th row and the (j+k)-th column, for all k such that 0\xe2\x89\xa4k\xe2\x89\xa4p\xe2\x88\x92i.Determine the minimum number of times Sakurako must use her magic so that there are no lakes." 900.0                                                
2032D Genokraken "constructive algorithms,data structures,graphs,greedy,implementation,interactive,trees,two pointers" "This is an interactive problem.Upon clearing the Waterside Area, Gretel has found a monster named Genokraken, and she\'s keeping it contained for her scientific studies.The monster\'s nerve system can be structured as a tree\xe2\x80\xa0 of n nodes (really, everything should stop resembling trees all the time\xe2\x80\xa6), numbered from 0 to n\xe2\x88\x921, with node 0 as the root.Gretel\'s objective is to learn the exact structure of the monster\'s nerve system \xe2\x80\x94 more specifically, she wants to know the values p1,p2,\xe2\x80\xa6,pn\xe2\x88\x921 of the tree, where pi (0\xe2\x89\xa4pi<i) is the direct parent node of node i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).She doesn\'t know exactly how the nodes are placed, but she knows a few convenient facts:  If we remove root node 0 and all adjacent edges, this tree will turn into a forest consisting of only paths\xe2\x80\xa1. Each node that was initially adjacent to the node 0 will be the end of some path.  The nodes are indexed in a way that if 1\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4n\xe2\x88\x921, then px\xe2\x89\xa4py.  Node 1 has exactly two adjacent nodes (including the node 0).  The tree in this picture does not satisfy the condition, because if we remove node 0, then node 2 (which was initially adjacent to the node 0) will not be the end of the path 4\xe2\x88\x922\xe2\x88\x925.The tree in this picture does not satisfy the condition, because p3\xe2\x89\xa4p4 must hold.The tree in this picture does not satisfy the condition, because node 1 has only one adjacent node. Gretel can make queries to the containment cell:  ""? a b"" (1\xe2\x89\xa4a,b<n, a\xe2\x89\xa0b) \xe2\x80\x94 the cell will check if the simple path between nodes a and b contains the node 0. However, to avoid unexpected consequences by overstimulating the creature, Gretel wants to query at most 2n\xe2\x88\x926 times. Though Gretel is gifted, she can\'t do everything all at once, so can you give her a helping hand?\xe2\x80\xa0A tree is a connected graph where every pair of distinct nodes has exactly one simple path connecting them.\xe2\x80\xa1A path is a tree whose vertices can be listed in the order v1,v2,\xe2\x80\xa6,vk such that the edges are (vi,vi+1) (1\xe2\x89\xa4i<k)." 1800.0                                                
2029I "Variance Challenge" flows,graphs,greedy "Kevin has recently learned the definition of variance. For an array a of length n, the variance of a is defined as follows:  Let x=1nn\xe2\x88\x91i=1ai, i.e., x is the mean of the array a;  Then, the variance of a is V(a)=1nn\xe2\x88\x91i=1(ai\xe2\x88\x92x)2. Now, Kevin gives you an array a consisting of n integers, as well as an integer k. You can perform the following operation on a:  Select an interval [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), then for each l\xe2\x89\xa4i\xe2\x89\xa4r, increase ai by k. For each 1\xe2\x89\xa4p\xe2\x89\xa4m, you have to find the minimum possible variance of a after exactly p operations are performed, independently for each p.For simplicity, you only need to output the answers multiplied by n2. It can be proven that the results are always integers." 3400.0                                                
2029H "Message Spread" "bitmasks,brute force,combinatorics,dp" "Given is an undirected graph with n vertices and m edges. Each edge connects two vertices (u,v) and has a probability of pq of appearing each day.Initially, vertex 1 has a message. At the end of the day, a vertex has a message if and only if itself or at least one of the vertices adjacent to it had the message the day before. Note that each day, each edge chooses its appearance independently.Calculate the expected number of days before all the vertices have the message, modulo 998244353." 3500.0                                                
2029G "Balanced Problem" "data structures,dp" "There is an array a consisting of n integers. Initially, all elements of a are equal to 0.Kevin can perform several operations on the array. Each operation is one of the following two types: Prefix addition \xe2\x80\x94 Kevin first selects an index x (1\xe2\x89\xa4x\xe2\x89\xa4n), and then for each 1\xe2\x89\xa4j\xe2\x89\xa4x, increases aj by 1;  Suffix addition \xe2\x80\x94 Kevin first selects an index x (1\xe2\x89\xa4x\xe2\x89\xa4n), and then for each x\xe2\x89\xa4j\xe2\x89\xa4n, increases aj by 1.In the country of KDOI, people think that the integer v is balanced. Thus, Iris gives Kevin an array c consisting of n integers and defines the beauty of the array a as follows: Initially, set b=0;  For each 1\xe2\x89\xa4i\xe2\x89\xa4n, if ai=v, add ci to b;  The beauty of a is the final value of b.Kevin wants to maximize the beauty of a after all the operations. However, he had already performed m operations when he was sleepy. Now, he can perform an arbitrary number (possibly zero) of new operations.You have to help Kevin find the maximum possible beauty if he optimally performs the new operations.However, to make sure that you are not just rolling the dice, Kevin gives you an integer V, and you need to solve the problem for each 1\xe2\x89\xa4v\xe2\x89\xa4V." 3000.0                                                
2028F "Alice\'s Adventures in Addition" "bitmasks,brute force,dp,implementation" "Note that the memory limit is unusual.The Cheshire Cat has a riddle for Alice: given n integers a1,a2,\xe2\x80\xa6,an and a target m, is there a way to insert + and \xc3\x97 into the circles of the expression a1\xe2\x88\x98a2\xe2\x88\x98\xe2\x8b\xaf\xe2\x88\x98an=m to make it true? We follow the usual order of operations: \xc3\x97 is done before +.Although Alice is excellent at chess, she is not good at math. Please help her so she can find a way out of Wonderland!" 2700.0                                                
2027E2 "Bit Game (Hard Version)" bitmasks,dp,math "This is the hard version of this problem. The only difference is that you need to output the number of choices of games where Bob wins in this version, where the number of stones in each pile are not fixed. You must solve both versions to be able to hack.Alice and Bob are playing a familiar game where they take turns removing stones from n piles. Initially, there are xi stones in the i-th pile, and it has an associated value ai. A player can take d stones away from the i-th pile if and only if both of the following conditions are met:   1\xe2\x89\xa4d\xe2\x89\xa4ai, and  x&d=d, where x is the current number of stones in the i-th pile and & denotes the bitwise AND operation. The player who cannot make a move loses, and Alice goes first.You\'re given the ai values of each pile, but the number of stones in the i-th pile has not been determined yet. For the i-th pile, xi can be any integer between 1 and bi, inclusive. That is, you can choose an array x1,x2,\xe2\x80\xa6,xn such that the condition 1\xe2\x89\xa4xi\xe2\x89\xa4bi is satisfied for all piles. Your task is to count the number of games where Bob wins if both players play optimally. Two games are considered different if the number of stones in any pile is different, i.e., the arrays of x differ in at least one position.Since the answer can be very large, please output the result modulo 109+7." 3100.0                                                
2027C "Add Zeros" "brute force,data structures,dfs and similar,dp,graphs,greedy" "You\'re given an array a initially containing n integers. In one operation, you must do the following:  Choose a position i such that 1<i\xe2\x89\xa4|a| and ai=|a|+1\xe2\x88\x92i, where |a| is the current size of the array.  Append i\xe2\x88\x921 zeros onto the end of a. After performing this operation as many times as you want, what is the maximum possible length of the array a?" 1500.0                                                
2027A "Rectangle Arrangement" geometry,implementation,math "You are coloring an infinite square grid, in which all cells are initially white. To do this, you are given n stamps. Each stamp is a rectangle of width wi and height hi.You will use each stamp exactly once to color a rectangle of the same size as the stamp on the grid in black. You cannot rotate the stamp, and for each cell, the stamp must either cover it fully or not cover it at all. You can use the stamp at any position on the grid, even if some or all of the cells covered by the stamping area are already black.What is the minimum sum of the perimeters of the connected regions of black squares you can obtain after all the stamps have been used?" 800.0                                                
2025A "Two Screens" "binary search,greedy,strings,two pointers" "There are two screens which can display sequences of uppercase Latin letters. Initially, both screens display nothing.In one second, you can do one of the following two actions:  choose a screen and an uppercase Latin letter, and append that letter to the end of the sequence displayed on that screen;  choose a screen and copy the sequence from it to the other screen, overwriting the sequence that was displayed on the other screen. You have to calculate the minimum number of seconds you have to spend so that the first screen displays the sequence s, and the second screen displays the sequence t." 800.0                                                
2024A "Profitable Interest Rate" greedy,math "Alice has a coins. She can open a bank deposit called ""Profitable"", but the minimum amount required to open this deposit is b coins.There is also a deposit called ""Unprofitable"", which can be opened with any amount of coins. Alice noticed that if she opens the ""Unprofitable"" deposit with x coins, the minimum amount required to open the ""Profitable"" deposit decreases by 2x coins. However, these coins cannot later be deposited into the ""Profitable"" deposit.Help Alice determine the maximum number of coins she can deposit into the ""Profitable"" deposit if she first deposits some amount of coins (possibly 0) into the ""Unprofitable"" deposit. If Alice can never open the ""Profitable"" deposit, output 0." 800.0                                                
2018F1 "Speedbreaker Counting (Easy Version)" combinatorics,dp,greedy,math "NightHawk22 - Isolation\xe2\xa0\x80This is the easy version of the problem. In the three versions, the constraints on n and the time limit are different. You can make hacks only if all the versions of the problem are solved.This is the statement of Problem D1B:  There are n cities in a row, numbered 1,2,\xe2\x80\xa6,n left to right.  At time 1, you conquer exactly one city, called the starting city.  At time 2,3,\xe2\x80\xa6,n, you can choose a city adjacent to the ones conquered so far and conquer it. You win if, for each i, you conquer city i at a time no later than ai. A winning strategy may or may not exist, also depending on the starting city. How many starting cities allow you to win? For each 0\xe2\x89\xa4k\xe2\x89\xa4n, count the number of arrays of positive integers a1,a2,\xe2\x80\xa6,an such that  1\xe2\x89\xa4ai\xe2\x89\xa4n for each 1\xe2\x89\xa4i\xe2\x89\xa4n;  the answer to Problem D1B is k. The answer can be very large, so you have to calculate it modulo a given prime p." 2900.0                                                
2018D "Max Plus Min Plus Size" "data structures,dp,dsu,greedy,implementation,matrices,sortings" "EnV - The Dusty Dragon Tavern\xe2\xa0\x80You are given an array a1,a2,\xe2\x80\xa6,an of positive integers.You can color some elements of the array red, but there cannot be two adjacent red elements (i.e., for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, at least one of ai and ai+1 must not be red).Your score is the maximum value of a red element, plus the minimum value of a red element, plus the number of red elements. Find the maximum score you can get." 2200.0                                                
2013F2 "Game in Tree (Hard Version)" "binary search,data structures,trees" "This is the hard version of the problem. In this version, it is not guaranteed that u=v. You can make hacks only if both versions of the problem are solved.Alice and Bob are playing a fun game on a tree. This game is played on a tree with n vertices, numbered from 1 to n. Recall that a tree with n vertices is an undirected connected graph with n\xe2\x88\x921 edges.Alice and Bob take turns, with Alice going first. Each player starts at some vertex.On their turn, a player must move from the current vertex to a neighboring vertex that has not yet been visited by anyone. The first player who cannot make a move loses.You are given two vertices u and v. Represent the simple path from vertex u to v as an array p1,p2,p3,\xe2\x80\xa6,pm, where p1=u, pm=v, and there is an edge between pi and pi+1 for all i (1\xe2\x89\xa4i<m).You need to determine the winner of the game if Alice starts at vertex 1 and Bob starts at vertex pj for each j (where 1\xe2\x89\xa4j\xe2\x89\xa4m)." 3500.0                                                
2013F1 "Game in Tree (Easy Version)" "binary search,brute force,data structures,dp,games,greedy,implementation,trees" "This is the easy version of the problem. In this version, u=v. You can make hacks only if both versions of the problem are solved.Alice and Bob are playing a fun game on a tree. This game is played on a tree with n vertices, numbered from 1 to n. Recall that a tree with n vertices is an undirected connected graph with n\xe2\x88\x921 edges.Alice and Bob take turns, with Alice going first. Each player starts at some vertex.On their turn, a player must move from the current vertex to a neighboring vertex that has not yet been visited by anyone. The first player who cannot make a move loses.You are given two vertices u and v. Represent the simple path from vertex u to v as an array p1,p2,p3,\xe2\x80\xa6,pm, where p1=u, pm=v, and there is an edge between pi and pi+1 for all i (1\xe2\x89\xa4i<m).You need to determine the winner of the game if Alice starts at vertex 1 and Bob starts at vertex pj for each j (where 1\xe2\x89\xa4j\xe2\x89\xa4m)." 2700.0                                                
2013D "Minimize the Difference" "binary search,greedy" "Zhan, tired after the contest, gave the only task that he did not solve during the contest to his friend, Sungat. However, he could not solve it either, so we ask you to try to solve this problem.You are given an array a1,a2,\xe2\x80\xa6,an of length n. We can perform any number (possibly, zero) of operations on the array.In one operation, we choose a position i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) and perform the following action:   ai:=ai\xe2\x88\x921, and ai+1:=ai+1+1. Find the minimum possible value of max(a1,a2,\xe2\x80\xa6,an)\xe2\x88\x92min(a1,a2,\xe2\x80\xa6,an)." 1900.0                                                
2013B "Battle for Survive" "constructive algorithms,greedy,math" "Eralim, being the mafia boss, manages a group of n fighters. Fighter i has a rating of ai.Eralim arranges a tournament of n\xe2\x88\x921 battles, in each of which two not yet eliminated fighters i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) are chosen, and as a result of the battle, fighter i is eliminated from the tournament, and the rating of fighter j is reduced by the rating of fighter i. That is, aj is decreased by ai. Note that fighter j\'s rating can become negative. The fighters indexes do not change.Eralim wants to know what maximum rating the last remaining fighter can preserve if he chooses the battles optimally." 900.0                                                
2011H "Strange Matrix" "*special problem,graphs,greedy" "You are given a matrix a of size n\xc3\x97m, consisting of integers from 0 to 31 inclusive.Let\'s call the matrix strange if for every two distinct rows i and j, both of the following conditions hold:   for every set of k indices (x1,x2,\xe2\x80\xa6,xk), where 1\xe2\x89\xa4x1<x2<\xe2\x8b\xaf<xk\xe2\x89\xa4m, the equality ai,x1&aj,x1&ai,x2&aj,x2&\xe2\x8b\xaf&ai,xk&aj,xk=0 holds (where & \xe2\x80\x94 bitwise AND of two numbers);  for every set of k indices (x1,x2,\xe2\x80\xa6,xk), where 1\xe2\x89\xa4x1<x2<\xe2\x8b\xaf<xk\xe2\x89\xa4m, the equality ai,x1|aj,x1|ai,x2|aj,x2|\xe2\x8b\xaf|ai,xk|aj,xk=31 holds (where | \xe2\x80\x94 bitwise OR of two numbers). You can perform the following operation any number of times: take any row of the matrix and a number y from 0 to 31 inclusive; then apply the bitwise XOR with the number y to all elements of the selected row. The cost of such an operation is equal to y.Your task is to calculate the minimum cost to make the matrix strange, or report that it is impossible." -999.0                                                
2009G1 "Yunli\'s Subarray Queries (easy version)" "binary search,data structures,two pointers" "This is the easy version of the problem. In this version, it is guaranteed that r=l+k\xe2\x88\x921 for all queries.For an arbitrary array b, Yunli can perform the following operation any number of times:  Select an index i. Set bi=x where x is any integer she desires (x is not limited to the interval [1,n]). Denote f(b) as the minimum number of operations she needs to perform until there exists a consecutive subarray\xe2\x88\x97 of length at least k in b.Yunli is given an array a of size n and asks you q queries. In each query, you must output \xe2\x88\x91rj=l+k\xe2\x88\x921f([al,al+1,\xe2\x80\xa6,aj]). Note that in this version, you are only required to output f([al,al+1,\xe2\x80\xa6,al+k\xe2\x88\x921]).\xe2\x88\x97If there exists a consecutive subarray of length k that starts at index i (1\xe2\x89\xa4i\xe2\x89\xa4|b|\xe2\x88\x92k+1), then bj=bj\xe2\x88\x921+1 for all i<j\xe2\x89\xa4i+k\xe2\x88\x921." 1900.0                                                
2009F "Firefly\'s Queries" "bitmasks,data structures,flows,math" "Firefly is given an array a of length n. Let ci denote the i\'th cyclic shift\xe2\x88\x97 of a. She creates a new array b such that b=c1+c2+\xe2\x8b\xaf+cn where + represents concatenation\xe2\x80\xa0. Then, she asks you q queries. For each query, output the sum of all elements in the subarray of b that starts from the l-th element and ends at the r-th element, inclusive of both ends.\xe2\x88\x97The x-th (1\xe2\x89\xa4x\xe2\x89\xa4n) cyclic shift of the array a is ax,ax+1\xe2\x80\xa6an,a1,a2\xe2\x80\xa6ax\xe2\x88\x921. Note that the 1-st shift is the initial a.\xe2\x80\xa0The concatenation of two arrays p and q of length n (in other words, p+q) is p1,p2,...,pn,q1,q2,...,qn." 1700.0                                                
2009E "Klee\'s SUPER DUPER LARGE Array!!!" "binary search,math,ternary search" "Klee has an array a of length n containing integers [k,k+1,...,k+n\xe2\x88\x921] in that order. Klee wants to choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that x=|a1+a2+\xe2\x8b\xaf+ai\xe2\x88\x92ai+1\xe2\x88\x92\xe2\x8b\xaf\xe2\x88\x92an| is minimized. Note that for an arbitrary integer z, |z| represents the absolute value of z. Output the minimum possible value of x." 1400.0                                                
2009B osu!mania "brute force,implementation" "You are playing your favorite rhythm game, osu!mania. The layout of your beatmap consists of n rows and 4 columns. Because notes at the bottom are closer, you will process the bottommost row first and the topmost row last. Each row will contain exactly one note, represented as a \'#\'.For each note 1,2,\xe2\x80\xa6,n, in the order of processing, output the column in which the note appears." 800.0                                                
2008B "Square or Not" "brute force,math,strings" "A beautiful binary matrix is a matrix that has ones on its edges and zeros inside.  Examples of four beautiful binary matrices. Today, Sakurako was playing with a beautiful binary matrix of size r\xc3\x97c and created a binary string s by writing down all the rows of the matrix, starting from the first and ending with the r-th. More formally, the element from the matrix in the i-th row and j-th column corresponds to the ((i\xe2\x88\x921)\xe2\x88\x97c+j)-th element of the string.You need to check whether the beautiful matrix from which the string s was obtained could be squared. In other words, you need to check whether the string s could have been build from a square beautiful binary matrix (i.e., one where r=c)." 800.0                                                
2006F "Dora\'s Paint" "brute force,combinatorics,constructive algorithms,graphs,implementation" "Sadly, Dora poured the paint when painting the class mural. Dora considers the mural as the matrix b of size n\xc3\x97n. Initially, bi,j=0 for all 1\xe2\x89\xa4i,j\xe2\x89\xa4n.Dora has only two brushes which have two different colors. In one operation, she can paint the matrix with one of two brushes:  The first brush has color 1 on it and can paint one column of the matrix. That is, Dora chooses 1\xe2\x89\xa4j\xe2\x89\xa4n and makes bi,j:=1 for all 1\xe2\x89\xa4i\xe2\x89\xa4n;  The second brush has color 2 on it and can paint one row of the matrix. That is, Dora chooses 1\xe2\x89\xa4i\xe2\x89\xa4n and makes bi,j:=2 for all 1\xe2\x89\xa4j\xe2\x89\xa4n. Dora paints the matrix so that the resulting matrix b contains only 1 and 2.For a matrix b, let f(b) denote the minimum number of operations needed to turn the initial matrix (containing only 0) into b. The beauty of a matrix b is the number of ways to paint the initial matrix in exactly f(b) operations to turn it into b. If there\'s no way to turn the initial matrix into b, the beauty of b is 0.However, Dora made a uniformly random mistake; there\'s exactly one element different in the matrix a given to you from the real matrix b. That is, there is exactly one pair (i,j) such that ai,j=3\xe2\x88\x92bi,j.Please help Dora compute the expected beauty of the real matrix b modulo 998244353 (all possible n2 mistakes have equal probability).Since the size of the matrix is too large, Dora will only tell you the positions of m elements of color 1, and the remaining n2\xe2\x88\x92m elements have color 2." 3500.0                                                
2006B "Iris and the Tree" "brute force,data structures,dfs and similar,dsu,math,trees" "Given a rooted tree with the root at vertex 1. For any vertex i (1<i\xe2\x89\xa4n) in the tree, there is an edge connecting vertices i and pi (1\xe2\x89\xa4pi<i), with a weight equal to ti.Iris does not know the values of ti, but she knows that n\xe2\x88\x91i=2ti=w and each of the ti is a non-negative integer.The vertices of the tree are numbered in a special way: the numbers of the vertices in each subtree are consecutive integers. In other words, the vertices of the tree are numbered in the order of a depth-first search.  The tree in this picture satisfies the condition. For example, in the subtree of vertex 2, the vertex numbers are 2,3,4,5, which are consecutive integers.   The tree in this picture does not satisfy the condition, as in the subtree of vertex 2, the vertex numbers 2 and 4 are not consecutive integers. We define dist(u,v) as the length of the simple path between vertices u and v in the tree.Next, there will be n\xe2\x88\x921 events:  Iris is given integers x and y, indicating that tx=y. After each event, Iris wants to know the maximum possible value of dist(i,imodn+1) independently for each i (1\xe2\x89\xa4i\xe2\x89\xa4n). She only needs to know the sum of these n values. Please help Iris quickly get the answers.Note that when calculating the maximum possible values of dist(i,imodn+1) and dist(j,jmodn+1) for i\xe2\x89\xa0j, the unknown edge weights may be different." 1800.0                                                
2003F "Turtle and Three Sequences" "brute force,data structures,dp,greedy,math,probabilities,two pointers" "Piggy gives Turtle three sequences a1,a2,\xe2\x80\xa6,an, b1,b2,\xe2\x80\xa6,bn, and c1,c2,\xe2\x80\xa6,cn.Turtle will choose a subsequence of 1,2,\xe2\x80\xa6,n of length m, let it be p1,p2,\xe2\x80\xa6,pm. The subsequence should satisfy the following conditions:  ap1\xe2\x89\xa4ap2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4apm;  All bpi for all indices i are pairwise distinct, i.e., there don\'t exist two different indices i, j such that bpi=bpj. Help him find the maximum value of m\xe2\x88\x91i=1cpi, or tell him that it is impossible to choose a subsequence of length m that satisfies the conditions above.Recall that a sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) elements." 2800.0                                                
2003B "Turtle and Piggy Are Playing a Game 2" games,greedy,sortings "Turtle and Piggy are playing a game on a sequence. They are given a sequence a1,a2,\xe2\x80\xa6,an, and Turtle goes first. Turtle and Piggy alternate in turns (so, Turtle does the first turn, Piggy does the second, Turtle does the third, etc.).The game goes as follows:  Let the current length of the sequence be m. If m=1, the game ends.  If the game does not end and it\'s Turtle\'s turn, then Turtle must choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4m\xe2\x88\x921, set ai to max(ai,ai+1), and remove ai+1.  If the game does not end and it\'s Piggy\'s turn, then Piggy must choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4m\xe2\x88\x921, set ai to min(ai,ai+1), and remove ai+1. Turtle wants to maximize the value of a1 in the end, while Piggy wants to minimize the value of a1 in the end. Find the value of a1 in the end if both players play optimally.You can refer to notes for further clarification." 800.0                                                
2001B "Generate Permutation" "constructive algorithms" "There is an integer sequence a of length n, where each element is initially \xe2\x88\x921.Misuki has two typewriters where the first one writes letters from left to right, with a pointer initially pointing to 1, and another writes letters from right to left with a pointer initially pointing to n.Misuki would choose one of the typewriters and use it to perform the following operations until a becomes a permutation of [1,2,\xe2\x80\xa6,n]  write number: write the minimum positive integer that isn\'t present in the array a to the element ai, i is the position where the pointer points at. Such operation can be performed only when ai=\xe2\x88\x921.  carriage return: return the pointer to its initial position (i.e. 1 for the first typewriter, n for the second)  move pointer: move the pointer to the next position, let i be the position the pointer points at before this operation, if Misuki is using the first typewriter, i:=i+1 would happen, and i:=i\xe2\x88\x921 otherwise. Such operation can be performed only if after the operation, 1\xe2\x89\xa4i\xe2\x89\xa4n holds. Your task is to construct any permutation p of length n, such that the minimum number of carriage return operations needed to make a=p is the same no matter which typewriter Misuki is using." 800.0                                                
2000E "Photoshoot for Gorillas" "combinatorics,data structures,greedy,math" "You really love gorillas, so you decided to organize a photoshoot for them. Gorillas live in the jungle. The jungle is represented as a grid of n rows and m columns. w gorillas agreed to participate in the photoshoot, and the gorilla with index i (1\xe2\x89\xa4i\xe2\x89\xa4w) has a height of ai. You want to place all the gorillas in the cells of the grid such that there is no more than one gorilla in each cell.The spectacle of the arrangement is equal to the sum of the spectacles of all sub-squares of the grid with a side length of k.The spectacle of a sub-square is equal to the sum of the heights of the gorillas in it.From all suitable arrangements, choose the arrangement with the maximum spectacle." 1400.0                                                
1999E "Triple Operations" dp,implementation,math "On the board Ivy wrote down all integers from l to r, inclusive.In an operation, she does the following:   pick two numbers x and y on the board, erase them, and in their place write the numbers 3x and \xe2\x8c\x8ay3\xe2\x8c\x8b. (Here \xe2\x8c\x8a\xe2\x88\x99\xe2\x8c\x8b denotes rounding down to the nearest integer). What is the minimum number of operations Ivy needs to make all numbers on the board equal 0? We have a proof that this is always possible." 1300.0                                                
1999D "Slavic\'s Exam" greedy,implementation,strings "Slavic has a very tough exam and needs your help in order to pass it. Here is the question he is struggling with:There exists a string s, which consists of lowercase English letters and possibly zero or more ""?"". Slavic is asked to change each ""?"" to a lowercase English letter such that string t becomes a subsequence (not necessarily continuous) of the string s. Output any such string, or say that it is impossible in case no string that respects the conditions exists." 1100.0                                                
1999A "A+B Again?" implementation,math "Given a two-digit positive integer n, find the sum of its digits." 800.0                                                
1997E "Level Up" "binary search,brute force,data structures,divide and conquer,implementation" "Monocarp is playing a computer game. He starts the game being level 1. He is about to fight n monsters, in order from 1 to n. The level of the i-th monster is ai.For each monster in the given order, Monocarp\'s encounter goes as follows:  if Monocarp\'s level is strictly higher than the monster\'s level, the monster flees (runs away);  otherwise, Monocarp fights the monster. After every k-th fight with a monster (fleeing monsters do not count), Monocarp\'s level increases by 1. So, his level becomes 2 after k monsters he fights, 3 after 2k monsters, 4 after 3k monsters, and so on.You need to process q queries of the following form:  i x: will Monocarp fight the i-th monster (or will this monster flee) if the parameter k is equal to x?" 2200.0                                                
1997C "Even Positions" "constructive algorithms,data structures,greedy" "Monocarp had a regular bracket sequence s of length n (n is even). He even came up with his own way to calculate its cost.He knows that in a regular bracket sequence (RBS), each opening bracket is paired up with the corresponding closing bracket. So he decided to calculate the cost of RBS as the sum of distances between pairs of corresponding bracket pairs.For example, let\'s look at RBS (())(). It has three pairs of brackets:   (__)__: the distance between brackets at position 1 and at 4 is 4\xe2\x88\x921=3;  _()___: the distance is 3\xe2\x88\x922=1;  ____(): the distance is 6\xe2\x88\x925=1.  So the cost of (())() is 3+1+1=5.Unfortunately, due to data corruption, Monocarp lost all characters on odd positions s1,s3,\xe2\x80\xa6,sn\xe2\x88\x921. Only characters on even positions (s2,s4,\xe2\x80\xa6,sn) remain. For example, (())() turned to _(_)_).Monocarp wants to restore his RBS by placing brackets on the odd positions. But since the restored RBS may not be unique, he wants to choose one with minimum cost. It\'s too hard to do for Monocarp alone, so can you help him?Reminder: A regular bracket sequence is a string consisting of only brackets, such that this sequence, when inserted 1-s and +-s, gives a valid mathematical expression. For example, (), (()) or (()())() are RBS, while ), ()( or ())(() are not." 1100.0                                                
1997A "Strong Password" "brute force,implementation,strings" "Monocarp\'s current password on Codeforces is a string s, consisting of lowercase Latin letters. Monocarp thinks that his current password is too weak, so he wants to insert exactly one lowercase Latin letter into the password to make it stronger. Monocarp can choose any letter and insert it anywhere, even before the first character or after the last character.Monocarp thinks that the password\'s strength is proportional to the time it takes him to type the password. The time it takes to type the password is calculated as follows:  the time to type the first character is 2 seconds;  for each character other than the first, the time it takes to type it is 1 second if it is the same as the previous character, or 2 seconds otherwise. For example, the time it takes to type the password abacaba is 14; the time it takes to type the password a is 2; the time it takes to type the password aaabacc is 11.You have to help Monocarp \xe2\x80\x94 insert a lowercase Latin letter into his password so that the resulting password takes the maximum possible amount of time to type." 800.0                                                
1996F Bomb "binary search,greedy,math" "Sparkle gives you two arrays a and b of length n. Initially, your score is 0. In one operation, you can choose an integer i and add ai to your score. Then, you must set ai = max(0,ai\xe2\x88\x92bi).You only have time to perform k operations before Sparkle sets off a nuclear bomb! What is the maximum score you can acquire after k operations?" 1900.0                                                
1994F "Stardew Valley" "constructive algorithms,dfs and similar,graphs,trees" "Pelican Town represents n houses connected by m bidirectional roads. Some roads have NPCs standing on them. Farmer Buba needs to walk on each road with an NPC and talk to them.Help the farmer find a route satisfying the following properties:   The route starts at some house, follows the roads, and ends at the same house.  The route does not follow any road more than once (in both directions together).  The route follows each road with an NPC exactly once.  Note that the route can follow roads without NPCs, and you do not need to minimize the length of the route.It is guaranteed that you can reach any house from any other by walking on the roads with NPCs only." 2500.0                                                
1992A "Only Pluses" "brute force,constructive algorithms,greedy,math,sortings" "Kmes has written three integers a, b and c in order to remember that he has to give Noobish_Monk a\xc3\x97b\xc3\x97c bananas.Noobish_Monk has found these integers and decided to do the following at most 5 times:  pick one of these integers;  increase it by 1. For example, if a=2, b=3 and c=4, then one can increase a three times by one and increase b two times. After that a=5, b=5, c=4. Then the total number of bananas will be 5\xc3\x975\xc3\x974=100.What is the maximum value of a\xc3\x97b\xc3\x97c Noobish_Monk can achieve with these operations?" 800.0                                                
1989D "Smithing Skill" "brute force,data structures,dp,greedy,math,sortings,two pointers" "You are playing a famous computer game (that just works) where you have various skills you can level up. Today, you focused on the ""Smithing"" skill. Your tactic is obvious: forging weapons from ingots and then melting them back to return the materials partially. For simplicity, every time you create an item, you get 1 experience point, and every time you melt an item, you also get 1 experience point.There are n classes of weapons you can forge and m types of metal ingots.You can create one weapon of the i-th class, spending ai ingots of metal of the same type. Melting a weapon of the i-th class (which you crafted earlier) returns you bi ingots of the type of metal it was made of.You have cj metal ingots of the j-th type, and you know that you can craft a weapon of any class from any metal type. Each combination of a weapon class and a metal type can be used any number of times.What is the maximum total amount of experience you can earn by crafting and melting weapons?" 1900.0                                                
1988F Heartbeat combinatorics,dp,fft,math "For an array u1,u2,\xe2\x80\xa6,un, define   a prefix maximum as an index i such that ui>uj for all j<i;  a suffix maximum as an index i such that ui>uj for all j>i;  an ascent as an index i (i>1) such that ui>ui\xe2\x88\x921. You are given three cost arrays: [a1,a2,\xe2\x80\xa6,an], [b1,b2,\xe2\x80\xa6,bn], and [c0,c1,\xe2\x80\xa6,cn\xe2\x88\x921].Define the cost of an array that has x prefix maximums, y suffix maximums, and z ascents as ax\xe2\x8b\x85by\xe2\x8b\x85cz.Let the sum of costs of all permutations of 1,2,\xe2\x80\xa6,n be f(n). Find f(1), f(2), ..., f(n) modulo 998244353." 3000.0                                                
1987F1 "Interesting Problem (Easy Version)" dp "This is the easy version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if both versions of the problem are solved.You are given an array of integers a of length n. In one operation, you will perform the following two-step process:   Choose an index i such that 1\xe2\x89\xa4i<|a| and ai=i.  Remove ai and ai+1 from the array and concatenate the remaining parts. Find the maximum number of times that you can perform the operation above." 2500.0                                                
1987B K-Sort greedy "You are given an array of integers a of length n. You can apply the following operation any number of times (maybe, zero):   First, choose an integer k such that 1\xe2\x89\xa4k\xe2\x89\xa4n and pay k+1 coins.  Then, choose exactly k indices such that 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n.  Then, for each x from 1 to k, increase aix by 1. Find the minimum number of coins needed to make a non-decreasing. That is, a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an." 1000.0                                                
1984E Shuffle dp,greedy,trees "Two hungry red pandas, Oscar and Lura, have a tree T with n nodes. They are willing to perform the following shuffle procedure on the whole tree T exactly once. With this shuffle procedure, they will create a new tree out of the nodes of the old tree.   Choose any node V from the original tree T. Create a new tree T2, with V as the root.  Remove V from T, such that the original tree is split into one or more subtrees (or zero subtrees, if V is the only node in T).  Shuffle each subtree with the same procedure (again choosing any node as the root), then connect all shuffled subtrees\' roots back to V to finish constructing T2. After this, Oscar and Lura are left with a new tree T2. They can only eat leaves and are very hungry, so please find the maximum number of leaves over all trees that can be created in exactly one shuffle.Note that leaves are all nodes with degree 1. Thus, the root may be considered as a leaf if it has only one child." 2400.0                                                
1984B "Large Addition" implementation,math "A digit is large if it is between 5 and 9, inclusive. A positive integer is large if all of its digits are large.You are given an integer x. Can it be the sum of two large positive integers with the same number of digits?" 1100.0                                                
1983E "I Love Balls" combinatorics,math,probabilities "Alice and Bob are playing a game. There are n balls, out of which k are special. Each ball has a value associated with it. The players play turn by turn. In each turn, the player randomly picks a ball and adds the value of the ball to their score, which is 0 at the beginning of the game. The selected ball is removed from the game. If the ball was special, the same player takes the next turn if at least one ball is remaining. If the ball picked was not special, the next player plays their turn.They play this game until no balls are remaining in the game. Alice plays first.Find the expected score that both the players have at the end of the game modulo 109+7. Formally, let M=109+7. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 2300.0                                                
1980D GCD-sequence "greedy,implementation,math,number theory" "GCD (Greatest Common Divisor) of two integers x and y is the maximum integer z by which both x and y are divisible. For example, GCD(36,48)=12, GCD(5,10)=5, and GCD(7,11)=1.Kristina has an array a consisting of exactly n positive integers. She wants to count the GCD of each neighbouring pair of numbers to get a new array b, called GCD-sequence. So, the elements of the GCD-sequence b will be calculated using the formula bi=GCD(ai,ai+1) for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921.Determine whether it is possible to remove exactly one number from the array a so that the GCD sequence b is non-decreasing (i.e., bi\xe2\x89\xa4bi+1 is always true).For example, let Khristina had an array a = [20,6,12,3,48,36]. If she removes a4=3 from it and counts the GCD-sequence of b, she gets:  b1=GCD(20,6)=2  b2=GCD(6,12)=6  b3=GCD(12,48)=12  b4=GCD(48,36)=12  The resulting GCD sequence b = [2,6,12,12] is non-decreasing because b1\xe2\x89\xa4b2\xe2\x89\xa4b3\xe2\x89\xa4b4." 1400.0                                                
1979A "Guess the Maximum" "brute force,greedy,implementation" "Alice and Bob came up with a rather strange game. They have an array of integers a1,a2,\xe2\x80\xa6,an. Alice chooses a certain integer k and tells it to Bob, then the following happens:  Bob chooses two integers i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n), and then finds the maximum among the integers ai,ai+1,\xe2\x80\xa6,aj;  If the obtained maximum is strictly greater than k, Alice wins, otherwise Bob wins. Help Alice find the maximum k at which she is guaranteed to win." 800.0                                                
1978D Elections "data structures,greedy,implementation,math" "Elections are taking place in Berland. There are n candidates participating in the elections, numbered from 1 to n. The i-th candidate has ai fans who will vote for him. Additionally, there are c people who are undecided about their favorite candidate, let\'s call them undecided. Undecided people will vote for the candidate with the lowest number.The candidate who receives the maximum number of votes wins the elections, and if multiple candidates receive the same maximum number of votes, the candidate with the lowest number among them wins.You found these elections too boring and predictable, so you decided to exclude some candidates from them. If you do not allow candidate number i to participate in the elections, all ai of his fans will become undecided, and will vote for the candidate with the lowest number.You are curious to find, for each i from 1 to n, the minimum number of candidates that need to be excluded from the elections for candidate number i to win the elections." 1600.0                                                
1975D "Paint the Tree" "brute force,dfs and similar,dp,greedy,shortest paths,trees" "378QAQ has a tree with n vertices. Initially, all vertices are white. There are two chess pieces called PA and PB on the tree. PA and PB are initially located on vertices a and b respectively. In one step, 378QAQ will do the following in order:  Move PA to a neighboring vertex. If the target vertex is white, this vertex will be painted red.  Move PB to a neighboring vertex. If the target vertex is colored in red, this vertex will be painted blue. Initially, the vertex a is painted red. If a=b, the vertex a is painted blue instead. Note that both the chess pieces must be moved in each step. Two pieces can be on the same vertex at any given time.378QAQ wants to know the minimum number of steps to paint all vertices blue." 1700.0                                                
1974A "Phone Desktop" greedy,math "Little Rosie has a phone with a desktop (or launcher, as it is also called). The desktop can consist of several screens. Each screen is represented as a grid of size 5\xc3\x973, i.e., five rows and three columns.There are x applications with an icon size of 1\xc3\x971 cells; such an icon occupies only one cell of the screen. There are also y applications with an icon size of 2\xc3\x972 cells; such an icon occupies a square of 4 cells on the screen. Each cell of each screen can be occupied by no more than one icon.Rosie wants to place the application icons on the minimum number of screens. Help her find the minimum number of screens needed." 800.0                                                
1971E "Find the Car" "binary search,math,sortings" "Timur is in a car traveling on the number line from point 0 to point n. The car starts moving from point 0 at minute 0.There are k+1 signs on the line at points 0,a1,a2,\xe2\x80\xa6,ak, and Timur knows that the car will arrive there at minutes 0,b1,b2,\xe2\x80\xa6,bk, respectively. The sequences a and b are strictly increasing with ak=n.  Between any two adjacent signs, the car travels with a constant speed. Timur has q queries: each query will be an integer d, and Timur wants you to output how many minutes it takes the car to reach point d, rounded down to the nearest integer." 1500.0                                                
1970F2 "Playing Quidditch (Medium)" implementation "This afternoon, you decided to enjoy the first days of Spring by taking a walk outside. As you come near the Quidditch field, you hear screams. Once again, there is a conflict about the score: the two teams are convinced that they won the game! To prevent this problem from happening one more time, you decide to get involved in the refereeing of the matches.Now, you will stay in the stadium to watch the game and count the score. At the end of the game, you will decide the winner.Today, two teams are competing: the red Gryffindor (R) and the blue Ravenclaw (B) team. Each team is composed of P players (1\xe2\x89\xa4P\xe2\x89\xa410).The field is a rectangle of N lines and M columns (3\xe2\x89\xa4N,M\xe2\x89\xa499, N and M are odd). All the positions are integers, and several entities are allowed to be at the same position in the field. At the beginning of the game, the field contains goals for the two teams (each team can own between one and five goals), the players, and exactly one Quaffle. In this version of the problem, one Bludger can be present. An other type of ball will be available in the harder version of the problem.A game is composed of T steps (0\xe2\x89\xa4T\xe2\x89\xa410000). At each step, one entity on the field (a player or a ball) performs one action. All entities can move. A player can also catch a ball or throw the Quaffle that it is carrying. To catch a ball, a player must be located on the same cell as it. The Quaffle does not perform any action while it is being carried; it only follows the movements of the player. If a player carrying the Quaffle decides to throw it, the Quaffle is simply put at the current position of the player. If a player is on the same cell as a Bludger (either after a movement from the player or the Bludger), the player is eliminated. If the player is eliminated while it is carrying the Quaffle, the Quaffle remains on the cell containing both the player and the Bludger after the move. It is guaranteed that this never occurs while the player is in a cell containing a goal.To win a point, a player must leave the Quaffle at a goal of the other team. When it does, the team of the player wins one point, and the Quaffle instantly moves to the middle of the field (the cell at the (M+1)/2-th column of the (N+1)/2-th line of the field, starting from 1). There is no goal in the middle of the field. If a player puts the ball in its own goal, the other team wins the point." 2300.0                                                
1970C3 "Game on Tree (Hard)" "dfs and similar,dp,games,trees" "This is the hard version of the problem. The only difference in this version is the constraint on t.Ron and Hermione are playing a game on a tree of n nodes that are initially inactive. The game consists of t rounds, each of which starts with a stone on exactly one node, which is considered as activated. A move consists of picking an inactive neighbor of the node with a stone on it and moving the stone there (thus activating this neighbor). Ron makes the first move, after which he alternates with Hermione until no valid move is available. The player that cannot make a move loses the round. If both players play optimally, who wins each round of this game? Note that all the rounds are played with the same tree; only the starting node changes. Moreover, after each round, all active nodes are considered inactive again." 1900.0                                                
1969D "Shop Game" "data structures,greedy,math,sortings" "Alice and Bob are playing a game in the shop. There are n items in the shop; each item has two parameters: ai (item price for Alice) and bi (item price for Bob).Alice wants to choose a subset (possibly empty) of items and buy them. After that, Bob does the following:   if Alice bought less than k items, Bob can take all of them for free;  otherwise, he will take k items for free that Alice bought (Bob chooses which k items it will be), and for the rest of the chosen items, Bob will buy them from Alice and pay bi for the i-th item. Alice\'s profit is equal to \xe2\x88\x91i\xe2\x88\x88Sbi\xe2\x88\x92\xe2\x88\x91j\xe2\x88\x88Taj, where S is the set of items Bob buys from Alice, and T is the set of items Alice buys from the shop. In other words, Alice\'s profit is the difference between the amount Bob pays her and the amount she spends buying the items.Alice wants to maximize her profit, Bob wants to minimize Alice\'s profit. Your task is to calculate Alice\'s profit if both Alice and Bob act optimally." 1900.0                                                
1969B "Shifts and Sorting" "constructive algorithms,greedy" "Let\'s define a cyclic shift of some string s as a transformation from s1s2\xe2\x80\xa6sn\xe2\x88\x921sn into sns1s2\xe2\x80\xa6sn\xe2\x88\x921. In other words, you take one last character sn and place it before the first character while moving all other characters to the right.You are given a binary string s (a string consisting of only 0-s and/or 1-s).In one operation, you can choose any substring slsl+1\xe2\x80\xa6sr (1\xe2\x89\xa4l<r\xe2\x89\xa4|s|) and cyclically shift it. The cost of such operation is equal to r\xe2\x88\x92l+1 (or the length of the chosen substring).You can perform the given operation any number of times. What is the minimum total cost to make s sorted in non-descending order?" 1000.0                                                
1968G1 "Division + LCP (easy version)" "binary search,data structures,dp,hashing,string suffix structures,strings" "This is the easy version of the problem. In this version l=r.You are given a string s. For a fixed k, consider a division of s into exactly k continuous substrings w1,\xe2\x80\xa6,wk. Let fk be the maximal possible LCP(w1,\xe2\x80\xa6,wk) among all divisions.LCP(w1,\xe2\x80\xa6,wm) is the length of the Longest Common Prefix of the strings w1,\xe2\x80\xa6,wm.For example, if s=abababcab and k=4, a possible division is abababcab. The LCP(ab,ab,abc,ab) is 2, since ab is the Longest Common Prefix of those four strings. Note that each substring consists of a continuous segment of characters and each character belongs to exactly one substring.Your task is to find fl,fl+1,\xe2\x80\xa6,fr. In this version l=r." 1900.0                                                
1968C "Assembly via Remainders" "constructive algorithms,number theory" "You are given an array x2,x3,\xe2\x80\xa6,xn. Your task is to find any array a1,\xe2\x80\xa6,an, where:   1\xe2\x89\xa4ai\xe2\x89\xa4109 for all 1\xe2\x89\xa4i\xe2\x89\xa4n.  xi=aimodai\xe2\x88\x921 for all 2\xe2\x89\xa4i\xe2\x89\xa4n. Here cmodd denotes the remainder of the division of the integer c by the integer d. For example 5mod2=1, 72mod3=0, 143mod14=3.Note that if there is more than one a which satisfies the statement, you are allowed to find any." 1000.0                                                
1967C "Fenwick Tree" "bitmasks,brute force,combinatorics,data structures,dp,math,trees" "Let lowbit(x) denote the value of the lowest binary bit of x, e.g. lowbit(12)=4, lowbit(8)=8.For an array a of length n, if an array s of length n satisfies sk=(k\xe2\x88\x91i=k\xe2\x88\x92lowbit(k)+1ai)mod998244353 for all k, then s is called the Fenwick Tree of a. Let\'s denote it as s=f(a).For a positive integer k and an array a, fk(a) is defined as follows:fk(a)={f(a)if k=1f(fk\xe2\x88\x921(a))otherwise.You are given an array b of length n and a positive integer k. Find an array a that satisfies 0\xe2\x89\xa4ai<998244353 and fk(a)=b. It can be proved that an answer always exists. If there are multiple possible answers, you may print any of them." 2300.0                                                
1967A "Permutation Counting" "binary search,greedy,implementation,math,sortings" "You have some cards. An integer between 11 and n is written on each card: specifically, for each i from 1 to n, you have ai cards which have the number i written on them.There is also a shop which contains unlimited cards of each type. You have k coins, so you can buy k new cards in total, and the cards you buy can contain any integer between 1 and n.After buying the new cards, you rearrange all your cards in a line. The score of a rearrangement is the number of (contiguous) subarrays of length n which are a permutation of [1,2,\xe2\x80\xa6,n]. What\'s the maximum score you can get?" 1400.0                                                
1958J Necromancer "*special problem" "Monocarp is playing a computer game. In this game, his character is a necromancer. He is fighting n monsters numbered from 1 to n. Each monster has two parameters: health and strength.Monocarp considers q scenarios of the battle. In each scenario, he chooses some segment [l,r] of monsters and calculates the number of moves it takes to defeat all these monsters.Each scenario proceeds as follows. First, Monocarp kills monster l and revives it as a zombie (this does not count as a move). Then each move the following happens: let i be the index of the first monster in the segment [l,r] that is still alive. All zombies attack monster i, reducing its health by their total strength. After that, if monster i has 0 or less health, it dies and Monocarp revives it as a zombie.When the monster is revived, the zombie\'s strength is equal to the monster\'s strength.Help Monocarp for each scenario to calculate how many moves it will take to kill all the monsters in the segment." 3200.0                                                
1958C Firewood "*special problem" "It\'s pretty cold in Berland (yes, even in May). So Monocarp has to light his fireplace.Monocarp has a big log of wood, which weighs 2n grams. Monocarp has watched the weather forecast and decided that he has to burn k grams of wood in the fireplace today, and the remaining 2n\xe2\x88\x92k grams of wood will be used tomorrow.In one minute, Monocarp can use his saw to split one of his logs in half. Initially he has only one log, but of course, after splitting a log, he gets two new logs. If the weight of the log is x, then each of the resulting logs has weight equal to x2. Monocarp can\'t split logs of weight 1 gram.Monocarp has to cut his log in such a way that some of the resulting logs weigh exactly k grams in total (and since the total weight of wood doesn\'t change, the remaining logs will have a total weight equal to exactly 2n\xe2\x88\x92k). Help him to calculate the minimum number of minutes he has to spend cutting the logs." 1500.0                                                
1957A Stickogon "constructive algorithms,greedy" "You are given n sticks of lengths a1,a2,\xe2\x80\xa6,an. Find the maximum number of regular (equal-sided) polygons you can construct simultaneously, such that:   Each side of a polygon is formed by exactly one stick.  No stick is used in more than 1 polygon. Note: Sticks cannot be broken." 800.0                                                
1952E "Sweep Line" combinatorics,games,math "Be careful not to make a mistake. You might have to start all over again.\xe2\x80\x94 Someone, probably" -999.0                                                
1951H "Thanos Snap" "binary search,dp,games,greedy,trees" "Piotr Rubik - Psalm dla Ciebie\xe0\xb6\x9eThere is an array a of size 2k for some positive integer k, which is initially a permutation of values from 1 to 2k. Alice and Bob play the following game on the array a. First, a value t between 1 and k is shown to both Alice and Bob. Then, for exactly t turns, the following happens:   Alice either does nothing, or chooses two distinct elements of the array a and swaps them.  Bob chooses either the left half or the right half of the array a and erases it. The score of the game is defined as the maximum value in a after all t turns have been played. Alice wants to maximize this score, while Bob wants to minimize it.You need to output k numbers: the score of the game if both Alice and Bob play optimally for t from 1 to k." 3200.0                                                
1951C "Ticket Hoarding" greedy,math,sortings "Ma\xc3\xaetre Gims - Est-ce que tu m\'aimes ?\xe0\xb6\x9eAs the CEO of a startup company, you want to reward each of your k employees with a ticket to the upcoming concert. The tickets will be on sale for n days, and by some time travelling, you have predicted that the price per ticket at day i will be ai. However, to prevent ticket hoarding, the concert organizers have implemented the following measures:  A person may purchase no more than m tickets per day.  If a person purchases x tickets on day i, all subsequent days (i.e. from day i+1 onwards) will have their prices per ticket increased by x. For example, if a=[1,3,8,4,5] and you purchase 2 tickets on day 1, they will cost 2 in total, and the prices from day 2 onwards will become [5,10,6,7]. If you then purchase 3 more tickets on day 2, they will cost in total an additional 15, and the prices from day 3 onwards will become [13,9,10].Find the minimum spending to purchase k tickets." 1400.0                                                
1950A "Stair, Peak, or Neither?" implementation "You are given three digits a, b, and c. Determine whether they form a stair, a peak, or neither.   A stair satisfies the condition a<b<c.  A peak satisfies the condition a<b>c." 800.0                                                
1949K "Make Triangle" "constructive algorithms,math" "You are given n positive integers x1,x2,\xe2\x80\xa6,xn and three positive integers na,nb,nc satisfying na+nb+nc=n. You want to split the n positive integers into three groups, so that: The first group contains na numbers, the second group contains nb numbers, the third group contains nc numbers. Let sa be the sum of the numbers in the first group, sb be the sum in the second group, and sc be the sum in the third group. Then sa,sb,sc are the sides of a triangle with positive area.Determine if this is possible. If this is possible, find one way to do so." 2800.0                                                
1949H "Division Avoidance" greedy,math "A newly discovered organism can be represented as a set of cells on an infinite grid. There is a coordinate system on the grid such that each cell has two integer coordinates x and y. A cell with coordinates x=a and y=b will be denoted as (a,b).Initially, the organism consists of a single cell (0,0). Then zero or more divisions can happen. In one division, a cell (a,b) is removed and replaced by two cells (a+1,b) and (a,b+1).For example, after the first division, the organism always consists of two cells (1,0) and (0,1), and after the second division, it is either the three cells (2,0), (1,1) and (0,1), or the three cells (1,0), (1,1) and (0,2).A division of a cell (a,b) can only happen if the cells (a+1,b) and (a,b+1) are not yet part of the organism. For example, the cell (1,0) cannot divide if the organism currently consists of the three cells (1,0), (1,1) and (0,2), since the cell (1,1) that would be one of the results of this division is already part of the organism.You are given a set of forbidden cells (ci,di). Is it possible for the organism to contain none of those cells after zero or more divisions?" 3100.0                                                
1949A Grove "brute force,dfs and similar,dp,geometry,probabilities" "You want to plant trees in a square lawn of size n\xc3\x97n whose corners have Cartesian coordinates (0,0), (n,0), (0,n), and (n,n). Trees can only be planted at locations with integer coordinates. Every tree will grow roots within a disk of radius r centered at the location where the tree was planted; such disks must be fully contained in the lawn (possibly touching the boundary of the lawn) and can only intersect each other on their boundaries.Find a configuration that maximizes the number of trees." 3300.0                                                
1946F "Nobody is needed" "2-sat,data structures,dfs and similar,dp" "Oleg received a permutation a of length n as a birthday present.Oleg\'s friend Nechipor asks Oleg q questions, each question is characterized by two numbers l and r, in response to the question Oleg must say the number of sets of indices (t1,t2,\xe2\x80\xa6,tk) of any length k\xe2\x89\xa51 such that:   l\xe2\x89\xa4ti\xe2\x89\xa4r for each i from 1 to k.  ti<ti+1 for each i from 1 to k\xe2\x88\x921.  ati+1 is divisible by ati for each i from 1 to k\xe2\x88\x921. Help Oleg and answer all of Nechipor\'s questions." 2500.0                                                
1946D "Birthday Gift" "bitmasks,brute force,constructive algorithms,greedy,implementation" "Yarik\'s birthday is coming soon, and Mark decided to give him an array a of length n.Mark knows that Yarik loves bitwise operations very much, and he also has a favorite number x, so Mark wants to find the maximum number k such that it is possible to select pairs of numbers [l1,r1], [l2,r2], \xe2\x80\xa6 [lk,rk], such that:   l1=1.  rk=n.  li\xe2\x89\xa4ri for all i from 1 to k.  ri+1=li+1 for all i from 1 to k\xe2\x88\x921.  (al1\xe2\x8a\x95al1+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar1)|(al2\xe2\x8a\x95al2+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar2)|\xe2\x80\xa6|(alk\xe2\x8a\x95alk+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ark)\xe2\x89\xa4x, where \xe2\x8a\x95 denotes the operation of bitwise XOR, and | denotes the operation of bitwise OR. If such k does not exist, then output \xe2\x88\x921." 1900.0                                                
1945H "GCD is Greater" "brute force,data structures,math,number theory" "In the evenings during the hike, Kirill and Anton decided to take out an array of integers a of length n from their backpack and play a game with it. The rules are as follows: Kirill chooses from 2 to (n\xe2\x88\x922) numbers and encircles them in red. Anton encircles all the remaining numbers in blue. Kirill calculates the greatest common divisor (GCD) of all the red numbers. Anton calculates the bitwise AND of all the blue numbers and adds the number x to the result. If the GCD of all the red numbers is strictly greater than the sum of the bitwise AND of all the blue numbers and the number x, then Kirill wins; otherwise, Anton wins.Help Kirill to beat Anton or tell if it\'s impossible." 2600.0                                                
1943E1 "MEX Game 2 (Easy Version)" "binary search,brute force,greedy" "This is the easy version of the problem. The only difference between the two versions is the constraint on t, m and the sum of m. You can make hacks only if both versions of the problem are solved.Alice and Bob play yet another game on an array a of size n. Alice starts with an empty array c. Both players take turns playing, with Alice starting first.On Alice\'s turn, she picks one element from a, appends that element to c, and then deletes it from a.On Bob\'s turn, he picks at most k elements from a, and then deletes it from a. The game ends when the array a is empty. Alice\'s score is defined to be the MEX\xe2\x80\xa0 of c. Alice wants to maximize her score while Bob wants to minimize it. Find Alice\'s final score if both players play optimally.The array will be given in compressed format. Instead of giving the elements present in the array, we will be giving their frequencies. Formally, you will be given m, the maximum element in the array, and then m+1 integers f0,f1,\xe2\x80\xa6,fm, where fi represents the number of times i occurs in the array a.\xe2\x80\xa0 The MEX (minimum excludant) of an array of integers is defined as the smallest non-negative integer which does not occur in the array. For example:   The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0, 1, 2 and 3 belong to the array, but 4 does not." 2900.0                                                
1936E "Yet Yet Another Permutation Problem" "divide and conquer,fft,math" "You are given a permutation p of length n.Please count the number of permutations q of length n which satisfy the following: for each 1\xe2\x89\xa4i<n, max(q1,\xe2\x80\xa6,qi)\xe2\x89\xa0max(p1,\xe2\x80\xa6,pi).Since the answer may be large, output the answer modulo 998244353." 3400.0                                                
1936B Pinball "binary search,data structures,implementation,math,two pointers" "There is a one-dimensional grid of length n. The i-th cell of the grid contains a character si, which is either \'<\' or \'>\'.When a pinball is placed on one of the cells, it moves according to the following rules:   If the pinball is on the i-th cell and si is \'<\', the pinball moves one cell to the left in the next second. If si is \'>\', it moves one cell to the right.  After the pinball has moved, the character si is inverted (i. e. if si used to be \'<\', it becomes \'>\', and vice versa).  The pinball stops moving when it leaves the grid: either from the left border or from the right one. You need to answer n independent queries. In the i-th query, a pinball will be placed on the i-th cell. Note that we always place a pinball on the initial grid.For each query, calculate how many seconds it takes the pinball to leave the grid. It can be shown that the pinball will always leave the grid within a finite number of steps." 2000.0                                                
1934D2 "XOR Break --- Game Version" bitmasks,games,greedy,interactive "This is an interactive problem.This is the game version of the problem. Note that the solution of this problem may or may not share ideas with the solution of the solo version. You can solve and get points for both versions independently.Alice and Bob are playing a game. The game starts with a positive integer n, with players taking turns. On each turn of the game, the following sequence of events takes place:  The player having the integer p breaks it into two integers p1 and p2, where 0<p1<p, 0<p2<p and p1\xe2\x8a\x95p2=p.  If no such p1, p2 exist, the player loses.  Otherwise, the opponent does either select the integer p1 or p2.  The game continues with the selected integer. The opponent will try to break it. As Alice, your goal is to win. You can execute a maximum of 63 break operations. You have the choice to play first or second. The system will act for Bob.Here \xe2\x8a\x95 denotes the bitwise XOR operation." 2400.0                                                
1934B "Yet Another Coin Problem" "brute force,dp,greedy,math" "You have 5 different types of coins, each with a value equal to one of the first 5 triangular numbers: 1, 3, 6, 10, and 15. These coin types are available in abundance. Your goal is to find the minimum number of these coins required such that their total value sums up to exactly n.We can show that the answer always exists." 1200.0                                                
1933A "Turtle Puzzle: Rearrange and Negate" greedy,math,sortings "You are given an array a of n integers. You must perform the following two operations on the array (the first, then the second):  Arbitrarily rearrange the elements of the array or leave the order of its elements unchanged.  Choose at most one contiguous segment of elements and replace the signs of all elements in this segment with their opposites. Formally, you can choose a pair of indices l,r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and assign ai=\xe2\x88\x92ai for all l\xe2\x89\xa4i\xe2\x89\xa4r (negate elements). Note that you may choose not to select a pair of indices and leave all the signs of the elements unchanged. What is the maximum sum of the array elements after performing these two operations (the first, then the second)?" 800.0                                                
1932G "Moving Platforms" "graphs,math,number theory,shortest paths" "There is a game where you need to move through a labyrinth. The labyrinth consists of n platforms, connected by m passages. Each platform is at some level li, an integer number from 0 to H\xe2\x88\x921. In a single step, if you are currently on platform i, you can stay on it, or move to another platform j. To move to platform j they have to be connected by the passage, and their levels have to be the same, namely li=lj.After each step, the levels of all platforms change. The new level of platform i is calculated as l\xe2\x80\xb2i=(li+si)modH, for all i. You start on platform 1. Find the minimum number of steps you need to get to platform n." 2300.0                                                
1932E "Final Countdown" "implementation,math,number theory" "You are in a nuclear laboratory that is about to explode and destroy the Earth. You must save the Earth before the final countdown reaches zero. The countdown consists of n (1\xe2\x89\xa4n\xe2\x89\xa44\xe2\x8b\x85105) mechanical indicators, each showing one decimal digit. You noticed that when the countdown changes its state from x to x\xe2\x88\x921, it doesn\'t happen in one move. Instead, each change of a single digit takes one second. So, for example, if the countdown shows 42, then it will change to 41 in one second, because only one digit is changed, but if the countdown shows 2300, then it will change to 2299 in three seconds, because the three last digits are changed.Find out how much time is left before the countdown reaches zero." 1600.0                                                
1932B "Chaya Calendar" "number theory" "The Chaya tribe believes that there are n signs of the apocalypse. Over time, it has been found out that the i-th sign occurs every ai years (in years ai, 2\xe2\x8b\x85ai, 3\xe2\x8b\x85ai, \xe2\x80\xa6).According to the legends, for the apocalypse to happen, the signs must occur sequentially. That is, first they wait for the first sign to occur, then strictly after it, the second sign will occur, and so on. That is, if the i-th sign occurred in the year x, the tribe starts waiting for the occurrence of the (i+1)-th sign, starting from the year x+1.In which year will the n-th sign occur and the apocalypse will happen?" 1100.0                                                
1931F "Chat Screenshots" "combinatorics,dfs and similar,graphs" "There are n people in the programming contest chat. Chat participants are ordered by activity, but each person sees himself at the top of the list.For example, there are 4 participants in the chat, and their order is [2,3,1,4]. Then   1-st user sees the order [1,2,3,4].  2-nd user sees the order [2,3,1,4].  3-rd user sees the order [3,2,1,4].  4-th user sees the order [4,2,3,1]. k people posted screenshots in the chat, which show the order of participants shown to this user. The screenshots were taken within a short period of time, and the order of participants has not changed. Your task is to determine whether there is a certain order that all screenshots correspond to." 1700.0                                                
1930D1 "Sum over all Substrings (Easy Version)" "brute force,dp,greedy,strings" "This is the easy version of the problem. The only difference between the two versions is the constraint on t and n. You can make hacks only if both versions of the problem are solved.For a binary\xe2\x80\xa0 pattern p and a binary string q, both of length m, q is called p-good if for every i (1\xe2\x89\xa4i\xe2\x89\xa4m), there exist indices l and r such that:   1\xe2\x89\xa4l\xe2\x89\xa4i\xe2\x89\xa4r\xe2\x89\xa4m, and  pi is a mode\xe2\x80\xa1 of the string qlql+1\xe2\x80\xa6qr. For a pattern p, let f(p) be the minimum possible number of 1s in a p-good binary string (of the same length as the pattern).You are given a binary string s of size n. Find n\xe2\x88\x91i=1n\xe2\x88\x91j=if(sisi+1\xe2\x80\xa6sj). In other words, you need to sum the values of f over all n(n+1)2 substrings of s.\xe2\x80\xa0 A binary pattern is a string that only consists of characters 0 and 1.\xe2\x80\xa1 Character c is a mode of string t of length m if the number of occurrences of c in t is at least \xe2\x8c\x88m2\xe2\x8c\x89. For example, 0 is a mode of 010, 1 is not a mode of 010, and both 0 and 1 are modes of 011010." 1800.0                                                
1930A "Maximise The Score" greedy,sortings "There are 2n positive integers written on a whiteboard. Being bored, you decided to play a one-player game with the numbers on the whiteboard.You start with a score of 0. You will increase your score by performing the following move exactly n times:   Choose two integers x and y that are written on the whiteboard.  Add min(x,y) to your score.  Erase x and y from the whiteboard.  Note that after performing the move n times, there will be no more integers written on the whiteboard.Find the maximum final score you can achieve if you optimally perform the n moves." 800.0                                                
1928C "Physical Education Lesson" "brute force,math,number theory" "In a well-known school, a physical education lesson took place. As usual, everyone was lined up and asked to settle in ""the first\xe2\x80\x93k-th"" position.As is known, settling in ""the first\xe2\x80\x93k-th"" position occurs as follows: the first k people have numbers 1,2,3,\xe2\x80\xa6,k, the next k\xe2\x88\x922 people have numbers k\xe2\x88\x921,k\xe2\x88\x922,\xe2\x80\xa6,2, the next k people have numbers 1,2,3,\xe2\x80\xa6,k, and so on. Thus, the settling repeats every 2k\xe2\x88\x922 positions. Examples of settling are given in the ""Note"" section.The boy Vasya constantly forgets everything. For example, he forgot the number k described above. But he remembers the position he occupied in the line, as well as the number he received during the settling. Help Vasya understand how many natural numbers k fit under the given constraints.Note that the settling exists if and only if k>1. In particular, this means that the settling does not exist for k=1." 1600.0                                                
1924D "Balanced Subsequences" combinatorics,dp,math "A sequence of brackets is called balanced if one can turn it into a valid math expression by adding characters \'+\' and \'1\'. For example, sequences \'(())()\', \'()\', and \'(()(()))\' are balanced, while \')(\', \'(()\', and \'(()))(\' are not.A subsequence is a sequence that can be derived from the given sequence by deleting zero or more elements without changing the order of the remaining elements.You are given three integers n, m and k. Find the number of sequences consisting of n \'(\' and m \')\', such that the longest balanced subsequence is of length 2\xe2\x8b\x85k. Since the answer can be large calculate it modulo 1000000007 (109+7)." 2700.0                                                
1921G "Mischievous Shooter" "brute force,data structures,divide and conquer,dp,implementation" "Once the mischievous and wayward shooter named Shel found himself on a rectangular field of size n\xc3\x97m, divided into unit squares. Each cell either contains a target or not.Shel only had a lucky shotgun with him, with which he can shoot in one of the four directions: right-down, left-down, left-up, or right-up. When fired, the shotgun hits all targets in the chosen direction, the Manhattan distance to which does not exceed a fixed constant k. The Manhattan distance between two points (x1,y1) and (x2,y2) is equal to |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|.  Possible hit areas for k=3. Shel\'s goal is to hit as many targets as possible. Please help him find this value." 2200.0                                                
1919G "Tree LGM" "constructive algorithms,divide and conquer,games,trees" "In TreeWorld, there is a popular two-player game played on a tree with n vertices labelled from 1 to n. In this game, the tournament leaders first choose a vertex to be the root of the tree and choose another vertex (possibly the same vertex as the root) to place a coin on. Then, each player will take turns moving the coin to any child\xe2\x80\xa0 of the vertex that the coin is currently on. The first player who is unable to make a move loses.Alice wants to be a tree LGM, so she spends a lot of time studying the game. She wrote down an n by n matrix s, where si,j=1 if the first player can win with the root of the tree chosen to be vertex i, and the coin was initially placed on vertex j. Otherwise, si,j=0. Alice is a perfectionist, so she assumes that both players play perfectly in the game.However, she accidentally knocked her head on the way to the tournament and forgot what the tree looked like. Determine whether there exists a tree that satisfies the winning and losing states represented by matrix s, and if it exists, construct a valid tree.\xe2\x80\xa0 A vertex c is a child of vertex u if there is an edge between c and u, and c does not lie on the unique simple path from the root to vertex u." 3500.0                                                
1919A "Wallet Exchange" games,math "Alice and Bob are bored, so they decide to play a game with their wallets. Alice has a coins in her wallet, while Bob has b coins in his wallet.Both players take turns playing, with Alice making the first move. In each turn, the player will perform the following steps in order:  Choose to exchange wallets with their opponent, or to keep their current wallets.  Remove 1 coin from the player\'s current wallet. The current wallet cannot have 0 coins before performing this step. The player who cannot make a valid move on their turn loses. If both Alice and Bob play optimally, determine who will win the game." 800.0                                                
1918E "ace5 and Task Order" "constructive algorithms,divide and conquer,implementation,interactive,probabilities,sortings" "This is an interactive problem!In the new round, there were n tasks with difficulties from 1 to n. The coordinator, who decided to have the first round with tasks in unsorted order of difficulty, rearranged the tasks, resulting in a permutation of difficulties from 1 to n. After that, the coordinator challenged ace5 to guess the permutation in the following way.Initially, the coordinator chooses a number x from 1 to n.ace5 can make queries of the form: ? i. The answer will be:   >, if ai>x, after which x increases by 1.  <, if ai<x, after which x decreases by 1.  =, if ai=x, after which x remains unchanged. The task for ace5 is to guess the permutation in no more than 40n queries. Since ace5 is too busy writing the announcement, he has entrusted this task to you." 2200.0                                                
1918C XOR-distance bitmasks,greedy,implementation,math "You are given integers a, b, r. Find the smallest value of |(a\xe2\x8a\x95x)\xe2\x88\x92(b\xe2\x8a\x95x)| among all 0\xe2\x89\xa4x\xe2\x89\xa4r.\xe2\x8a\x95 is the operation of bitwise XOR, and |y| is absolute value of y." 1400.0                                                
1917C "Watering an Array" "brute force,greedy,implementation,math" "You have an array of integers a1,a2,\xe2\x80\xa6,an of length n. On the i-th of the next d days you are going to do exactly one of the following two actions:  Add 1 to each of the first bi elements of the array a (i.e., set aj:=aj+1 for each 1\xe2\x89\xa4j\xe2\x89\xa4bi).  Count the elements which are equal to their position (i.e., the aj=j). Denote the number of such elements as c. Then, you add c to your score, and reset the entire array a to a 0-array of length n (i.e., set [a1,a2,\xe2\x80\xa6,an]:=[0,0,\xe2\x80\xa6,0]). Your score is equal to 0 in the beginning. Note that on each day you should perform exactly one of the actions above: you cannot skip a day or perform both actions on the same day.What is the maximum score you can achieve at the end?Since d can be quite large, the sequence b is given to you in the compressed format:   You are given a sequence of integers v1,v2,\xe2\x80\xa6,vk. The sequence b is a concatenation of infinitely many copies of v: b=[v1,v2,\xe2\x80\xa6,vk,v1,v2,\xe2\x80\xa6,vk,\xe2\x80\xa6]." 1600.0                                                
1915C "Can I Square?" "binary search,implementation" "Calin has n buckets, the i-th of which contains ai wooden squares of side length 1.Can Calin build a square using all the given squares?" 800.0                                                
1914G1 "Light Bulbs (Easy Version)" "brute force,combinatorics,dfs and similar,dp,dsu,graphs,math,trees" "The easy and hard versions of this problem differ only in the constraints on n. In the easy version, the sum of values of n2 over all test cases does not exceed 106. Furthermore, n does not exceed 1000 in each test case.There are 2n light bulbs arranged in a row. Each light bulb has a color from 1 to n (exactly two light bulbs for each color).Initially, all light bulbs are turned off. You choose a set of light bulbs S that you initially turn on. After that, you can perform the following operations in any order any number of times:  choose two light bulbs i and j of the same color, exactly one of which is on, and turn on the second one;  choose three light bulbs i,j,k, such that both light bulbs i and k are on and have the same color, and the light bulb j is between them (i<j<k), and turn on the light bulb j. You want to choose a set of light bulbs S that you initially turn on in such a way that by performing the described operations, you can ensure that all light bulbs are turned on.Calculate two numbers:  the minimum size of the set S that you initially turn on;  the number of sets S of minimum size (taken modulo 998244353)." 2100.0                                                
1913B "Swap and Delete" strings "You are given a binary string s (a string consisting only of 0-s and 1-s).You can perform two types of operations on s:   delete one character from s. This operation costs 1 coin;  swap any pair of characters in s. This operation is free (costs 0 coins). You can perform these operations any number of times and in any order.Let\'s name a string you\'ve got after performing operations above as t. The string t is good if for each i from 1 to |t| ti\xe2\x89\xa0si (|t| is the length of the string t). The empty string is always good. Note that you are comparing the resulting string t with the initial string s.What is the minimum total cost to make the string t good?" 1000.0                                                
1912E "Evaluate It and Back Again" "constructive algorithms,implementation,math" "Aidan and Nadia are long-time friends with a shared passion for mathematics. Each of them has a favorite number: Aidan\'s favorite number is p, and Nadia\'s is q. To commemorate their friendship, their friends want to make a present: a plaque with an arithmetic expression whose value is equal to their favorite numbers. At first glance, it sounds impossible, but the answer is simple: Aidan reads left-to-right, while Nadia reads right-to-left, so the same expression can have different values for them.For example, if 2023-12-13 is written on the plaque, then Aidan would calculate the result as 2023\xe2\x88\x9212\xe2\x88\x9213=1998, and Nadia would calculate it as 31\xe2\x88\x9221\xe2\x88\x923202=\xe2\x88\x923192.Find an arithmetic expression that, when read left-to-right, evaluates to p, and, when read right-to-left, evaluates to q. Its length must be at most 1000 characters. It\'s guaranteed that such an expression exists for all valid inputs." 2200.0                                                
1907A Rook implementation "As you probably know, chess is a game that is played on a board with 64 squares arranged in an 8\xc3\x978 grid. Columns of this board are labeled with letters from a to h, and rows are labeled with digits from 1 to 8. Each square is described by the row and column it belongs to.  The rook is a piece in the game of chess. During its turn, it may move any non-zero number of squares horizontally or vertically. Your task is to find all possible moves for a rook on an empty chessboard." 800.0                                                
1906L "Palindromic Parentheses" "constructive algorithms" "Construct a parentheses sequence consisting of N characters such that it is balanced and the length of its longest palindromic subsequence (LPS) is exactly K. Determine whether such a construction is possible. If there are several possible sequences, construct any of them.A parentheses sequence consists of only character ( and ). A parentheses sequence is balanced if each character ( has a corresponding character ) and the pairs of parentheses are properly nested. For example, (), (()), (())(), and ((())()) are balanced. However, )(, ((), and ()) are not balanced.A sequence is palindromic if it reads the same backwards as forwards. For example, ((, ), ())(, and (()(( are palindromic. However, (), )(, and (()) are not palindromic.A subsequence can be derived from another sequence by removing zero or more characters without changing the order of the remaining characters. For example, (, ))), ())(, and (())() are subsequence of (())(). However, )(( and ((())) are not subsequence of (())().The longest palindromic subsequence (LPS) of a sequence is a subsequence with the maximum number of characters, derived from that sequence and it is palindromic. For example, the LPS of sequence (())() is ())(, which can be obtained by removing the second and sixth characters. Therefore, the length of the LPS of (())() is 4." 2500.0                                                
1906H "Twin Friends" combinatorics,dp "You meet two new friends who are twins. The name of the elder twin is A, which consists of N characters. While the name of the younger twin is B, which consists of M characters. It is known that N\xe2\x89\xa4M.You want to call each of them with a nickname. For the elder twin, you want to pick any permutation of A as the nickname. For the younger twin, you want to remove exactly M\xe2\x88\x92N characters from any permutation of B. Denote the nicknames of the elder twin and the younger twin as A\xe2\x80\xb2 and B\xe2\x80\xb2, respectively.You want the nicknames to satisfy the following requirement. For each i that satisfies 1\xe2\x89\xa4i\xe2\x89\xa4N, B\xe2\x80\xb2i must be equal to either A\xe2\x80\xb2i or the next letter that follows alphabetically after A\xe2\x80\xb2i (if such a next letter exists).Determine the number of different pairs of nicknames (A\xe2\x80\xb2,B\xe2\x80\xb2) that satisfy the requirement. Two pairs of nicknames are considered different if at least one of the nicknames are different. As the result might be large, find the answer modulo 998244353." 2200.0                                                
1905C "Largest Subsequence" greedy,strings "Given is a string s of length n. In one operation you can select the lexicographically largest\xe2\x80\xa0 subsequence of string s and cyclic shift it to the right\xe2\x80\xa1. Your task is to calculate the minimum number of operations it would take for s to become sorted, or report that it never reaches a sorted state.\xe2\x80\xa0A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; In the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b.\xe2\x80\xa1By cyclic shifting the string t1t2\xe2\x80\xa6tm to the right, we get the string tmt1\xe2\x80\xa6tm\xe2\x88\x921." 1400.0                                                
1904C "Array Game" "binary search,brute force,data structures,sortings,two pointers" "You are given an array a of n positive integers. In one operation, you must pick some (i,j) such that 1\xe2\x89\xa4i<j\xe2\x89\xa4|a| and append |ai\xe2\x88\x92aj| to the end of the a (i.e. increase n by 1 and set an to |ai\xe2\x88\x92aj|). Your task is to minimize and print the minimum value of a after performing k operations." 1400.0                                                
1903A "Halloumi Boxes" "brute force,greedy,sortings" "Theofanis is busy after his last contest, as now, he has to deliver many halloumis all over the world. He stored them inside n boxes and each of which has some number ai written on it. He wants to sort them in non-decreasing order based on their number, however, his machine works in a strange way. It can only reverse any subarray\xe2\x80\xa0 of boxes with length at most k.Find if it\'s possible to sort the boxes using any number of reverses.\xe2\x80\xa0 Reversing a subarray means choosing two indices i and j (where 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n) and changing the array a1,a2,\xe2\x80\xa6,an to a1,a2,\xe2\x80\xa6,ai\xe2\x88\x921,aj,aj\xe2\x88\x921,\xe2\x80\xa6,ai,aj+1,\xe2\x80\xa6,an\xe2\x88\x921,an. The length of the subarray is then j\xe2\x88\x92i+1." 800.0                                                
1902B "Getting Points" "binary search,brute force,greedy" "Monocarp is a student at Berland State University. Due to recent changes in the Berland education system, Monocarp has to study only one subject \xe2\x80\x94 programming.The academic term consists of n days, and in order not to get expelled, Monocarp has to earn at least P points during those n days. There are two ways to earn points \xe2\x80\x94 completing practical tasks and attending lessons. For each practical task Monocarp fulfills, he earns t points, and for each lesson he attends, he earns l points.Practical tasks are unlocked ""each week"" as the term goes on: the first task is unlocked on day 1 (and can be completed on any day from 1 to n), the second task is unlocked on day 8 (and can be completed on any day from 8 to n), the third task is unlocked on day 15, and so on.Every day from 1 to n, there is a lesson which can be attended by Monocarp. And every day, Monocarp chooses whether to study or to rest the whole day. When Monocarp decides to study, he attends a lesson and can complete no more than 2 tasks, which are already unlocked and not completed yet. If Monocarp rests the whole day, he skips a lesson and ignores tasks.Monocarp wants to have as many days off as possible, i. e. he wants to maximize the number of days he rests. Help him calculate the maximum number of days he can rest!" 1100.0                                                
1901E "Compressed Tree" "dfs and similar,dp,graphs,greedy,sortings,trees" "You are given a tree consisting of n vertices. A number is written on each vertex; the number on vertex i is equal to ai.You can perform the following operation any number of times (possibly zero):   choose a vertex which has at most 1 incident edge and remove this vertex from the tree. Note that you can delete all vertices.After all operations are done, you\'re compressing the tree. The compression process is done as follows. While there is a vertex having exactly 2 incident edges in the tree, perform the following operation:   delete this vertex, connect its neighbors with an edge. It can be shown that if there are multiple ways to choose a vertex to delete during the compression process, the resulting tree is still the same.Your task is to calculate the maximum possible sum of numbers written on vertices after applying the aforementioned operation any number of times, and then compressing the tree." 2200.0                                                
1900E "Transitive Graph" "dfs and similar,dp,dsu,graphs,implementation" "You are given a directed graph G with n vertices and m edges between them.Initially, graph H is the same as graph G. Then you decided to perform the following actions:   If there exists a triple of vertices a, b, c of H, such that there is an edge from a to b and an edge from b to c, but there is no edge from a to c, add an edge from a to c.  Repeat the previous step as long as there are such triples. Note that the number of edges in H can be up to n2 after performing the actions.You also wrote some values on vertices of graph H. More precisely, vertex i has the value of ai written on it.Consider a simple path consisting of k distinct vertices with indexes v1,v2,\xe2\x80\xa6,vk. The length of such a path is k. The value of that path is defined as \xe2\x88\x91ki=1avi.A simple path is considered the longest if there is no other simple path in the graph with greater length.Among all the longest simple paths in H, find the one with the smallest value." 2100.0                                                
1900D "Small GCD" "bitmasks,brute force,dp,math,number theory" "Let a, b, and c be integers. We define function f(a,b,c) as follows:Order the numbers a, b, c in such a way that a\xe2\x89\xa4b\xe2\x89\xa4c. Then return gcd(a,b), where gcd(a,b) denotes the greatest common divisor (GCD) of integers a and b.So basically, we take the gcd of the 2 smaller values and ignore the biggest one. You are given an array a of n elements. Compute the sum of f(ai,aj,ak) for each i, j, k, such that 1\xe2\x89\xa4i<j<k\xe2\x89\xa4n. More formally, compute n\xe2\x88\x91i=1n\xe2\x88\x91j=i+1n\xe2\x88\x91k=j+1f(ai,aj,ak)." 2000.0                                                
1899A "Game with Integers" "games,math,number theory" "Vanya and Vova are playing a game. Players are given an integer n. On their turn, the player can add 1 to the current integer or subtract 1. The players take turns; Vanya starts. If after Vanya\'s move the integer is divisible by 3, then he wins. If 10 moves have passed and Vanya has not won, then Vova wins.Write a program that, based on the integer n, determines who will win if both players play optimally." 800.0                                                
1893E "Cacti Symphony" "combinatorics,dfs and similar,dp,graphs" "You are given an undirected connected graph in which any two distinct simple cycles do not have common vertices. Since the graph can be very large, it is given to you in a compressed form: for each edge, you are also given a number d, which indicates that there are d additional vertices on this edge.You need to assign a weight to each vertex and each edge of the graph \xe2\x80\x94 an integer from 1 to 3.An edge of the graph is called good if the bitwise XOR of the weights of its adjacent vertices is not equal to 0 and not equal to the weight of that edge.Similarly, a vertex of the graph is called good if the bitwise XOR of the weights of its adjacent edges is not equal to 0 and not equal to the weight of that vertex.You need to determine how many ways there are to assign weights to the vertices and edges of the graph so that all vertices and edges are good. Since the answer can be quite large, you need to calculate the remainder of the answer divided by 998244353." 3500.0                                                
1889A "Qingshan Loves Strings 2" "constructive algorithms,greedy,implementation" "Qingshan has a string s which only contains 0 and 1.A string a of length k is good if and only if  ai\xe2\x89\xa0ak\xe2\x88\x92i+1 for all i=1,2,\xe2\x80\xa6,k. For Div. 2 contestants, note that this condition is different from the condition in problem B.For example, 10, 1010, 111000 are good, while 11, 101, 001, 001100 are not good.Qingshan wants to make s good. To do this, she can do the following operation at most 300 times (possibly, zero):   insert 01 to any position of s (getting a new s). Please tell Qingshan if it is possible to make s good. If it is possible, print a sequence of operations that makes s good." 1300.0                                                
1887C "Minimum Array" "binary search,brute force,constructive algorithms,data structures,greedy,hashing,two pointers" "Given an array a of length n consisting of integers. Then the following operation is sequentially applied to it q times: Choose indices l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and an integer x; Add x to all elements of the array a in the segment [l,r]. More formally, assign ai:=ai+x for all l\xe2\x89\xa4i\xe2\x89\xa4r.Let bj be the array a obtained after applying the first j operations (0\xe2\x89\xa4j\xe2\x89\xa4q). Note that b0 is the array a before applying any operations.You need to find the lexicographically minimum\xe2\x80\xa0 array among all arrays bj.\xe2\x80\xa0An array x is lexicographically smaller than array y if there is an index i such that xi<yi, and xj=yj for all j<i. In other words, for the first index i where the arrays differ, xi<yi." 2400.0                                                
1883G2 "Dances (Hard Version)" "binary search,greedy,sortings,two pointers" "This is the hard version of the problem. The only difference is that in this version m\xe2\x89\xa4109.You are given two arrays of integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn. Before applying any operations, you can reorder the elements of each array as you wish. Then, in one operation, you will perform both of the following actions, if the arrays are not empty: Choose any element from array a and remove it (all remaining elements are shifted to a new array a), Choose any element from array b and remove it (all remaining elements are shifted to a new array b).Let k be the final size of both arrays. You need to find the minimum number of operations required to satisfy ai<bi for all 1\xe2\x89\xa4i\xe2\x89\xa4k.This problem was too easy, so the problem author decided to make it more challenging. You are also given a positive integer m. Now, you need to find the sum of answers to the problem for m pairs of arrays (c[i],b), where 1\xe2\x89\xa4i\xe2\x89\xa4m. Array c[i] is obtained from a as follows: c[i]1=i, c[i]j=aj, for 2\xe2\x89\xa4j\xe2\x89\xa4n." 1900.0                                                
1883B Chemistry strings "You are given a string s of length n, consisting of lowercase Latin letters, and an integer k.You need to check if it is possible to remove exactly k characters from the string s in such a way that the remaining characters can be rearranged to form a palindrome. Note that you can reorder the remaining characters in any way.A palindrome is a string that reads the same forwards and backwards. For example, the strings ""z"", ""aaa"", ""aba"", ""abccba"" are palindromes, while the strings ""codeforces"", ""reality"", ""ab"" are not." 900.0                                                
1882D "Tree XOR" "bitmasks,dfs and similar,dp,greedy,trees" "You are given a tree with n vertices labeled from 1 to n. An integer ai is written on vertex i for i=1,2,\xe2\x80\xa6,n. You want to make all ai equal by performing some (possibly, zero) spells.Suppose you root the tree at some vertex. On each spell, you can select any vertex v and any non-negative integer c. Then for all vertices i in the subtree\xe2\x80\xa0 of v, replace ai with ai\xe2\x8a\x95c. The cost of this spell is s\xe2\x8b\x85c, where s is the number of vertices in the subtree. Here \xe2\x8a\x95 denotes the bitwise XOR operation.Let mr be the minimum possible total cost required to make all ai equal, if vertex r is chosen as the root of the tree. Find m1,m2,\xe2\x80\xa6,mn.\xe2\x80\xa0 Suppose vertex r is chosen as the root of the tree. Then vertex i belongs to the subtree of v if the simple path from i to r contains v." 1900.0                                                
1879E "Interactive Game with Coloring" "brute force,constructive algorithms,dfs and similar,graphs,implementation,interactive,trees" "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.You are given a tree on n vertices; vertex 1 is the root of the tree. For every i\xe2\x88\x88[2,n], the parent of the i-th vertex is pi, and pi<i.You have to color all edges of the tree using the minimum possible number of colors such that you can win the game on that tree (every edge should be painted into exactly one color).The game we\'re going to play will be conducted as follows. After you paint the edges and print their colors, the jury will place a chip into one of the vertices of the tree (except for the root). Your goal is to move this chip to the root in exactly d moves, where d is the distance from the root to that vertex (the distance is equal to the number of edges on the path). If the chip reaches the root in d moves, you win. Otherwise, you lose.The jury won\'t tell you where the chip is located. You won\'t even know the value of d in advance. However, at the start of each move, you will be told how many edges of each color are incident to the current vertex (this includes both the edge leading up the tree and the edges leading away from the root). You have to choose one of these colors, and the chip will be moved along the edge of the chosen color (if there are multiple edges with that color incident to the current vertex, the jury gets to choose one of them). After the chip is moved, you will be told the same information about the current vertex again, and the game continues, until you either reach the root, or you make d moves without reaching the root.The interactor for this problem is adaptive. It means that both the starting vertex and the current vertex are not fixed and may change ""on the run"" depending on the output of your program. However, the state of the game will always be consistent with the information you are given: there will always be at least one starting vertex and at least one path of your chip from that vertex consistent with both the information about the colors you receive and the colors you\'ve chosen during the moves." 2400.0                                                
1879D "Sum of XOR Functions" "bitmasks,combinatorics,divide and conquer,dp,math" "You are given an array a of length n consisting of non-negative integers.You have to calculate the value of \xe2\x88\x91nl=1\xe2\x88\x91nr=lf(l,r)\xe2\x8b\x85(r\xe2\x88\x92l+1), where f(l,r) is al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x8b\xaf\xe2\x8a\x95ar\xe2\x88\x921\xe2\x8a\x95ar (the character \xe2\x8a\x95 denotes bitwise XOR).Since the answer can be very large, print it modulo 998244353." 1700.0                                                
1879C "Make it Alternating" combinatorics,dp,greedy "You are given a binary string s. A binary string is a string consisting of characters 0 and/or 1.You can perform the following operation on s any number of times (even zero):  choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4|s|, then erase the character si. You have to make s alternating, i.\xe2\x80\x89e. after you perform the operations, every two adjacent characters in s should be different.Your goal is to calculate two values:  the minimum number of operations required to make s alternating;  the number of different shortest sequences of operations that make s alternating. Two sequences of operations are different if in at least one operation, the chosen integer i is different in these two sequences." 1300.0                                                
1876C Autosynthesis "constructive algorithms,dfs and similar,graphs,greedy,sortings" "Chaneka writes down an array a of n positive integer elements. Initially, all elements are not circled. In one operation, Chaneka can circle an element. It is possible to circle the same element more than once.After doing all operations, Chaneka makes a sequence r consisting of all uncircled elements of a following the order of their indices.Chaneka also makes another sequence p such that its length is equal to the number of operations performed and pi is the index of the element that is circled in the i-th operation.Chaneka wants to do several operations such that sequence r is equal to sequence p. Help her achieve this, or report if it is impossible! Note that if there are multiple solutions, you can print any of them." 2100.0                                                
     1703C Cypher "brute force,implementation,strings" "Luca has a cypher made up of a sequence of n wheels, each with a digit ai written on it. On the i-th wheel, he made bi moves. Each move is one of two types:   up move (denoted by U): it increases the i-th digit by 1. After applying the up move on 9, it becomes 0.  down move (denoted by D): it decreases the i-th digit by 1. After applying the down move on 0, it becomes 9.   Example for n=4. The current sequence is 0 0 0 0. Luca knows the final sequence of wheels and the moves for each wheel. Help him find the original sequence and crack the cypher." 800.0                                           
     1702B "Polycarp Writes a String from Memory" greedy "Polycarp has a poor memory. Each day he can remember no more than 3 of different letters. Polycarp wants to write a non-empty string of s consisting of lowercase Latin letters, taking minimum number of days. In how many days will he be able to do it?Polycarp initially has an empty string and can only add characters to the end of that string.For example, if Polycarp wants to write the string lollipops, he will do it in 2 days:   on the first day Polycarp will memorize the letters l, o, i and write lolli;  On the second day Polycarp will remember the letters p, o, s, add pops to the resulting line and get the line lollipops. If Polycarp wants to write the string stringology, he will do it in 4 days:   in the first day will be written part str;  on day two will be written part ing;  on the third day, part of olog will be written;  on the fourth day, part of y will be written. For a given string s, print the minimum number of days it will take Polycarp to write it." 800.0                                           
     1702A "Round Down the Price" "constructive algorithms" "At the store, the salespeople want to make all prices round. In this problem, a number that is a power of 10 is called a round number. For example, the numbers 100=1, 101=10, 102=100 are round numbers, but 20, 110 and 256 are not round numbers. So, if an item is worth m bourles (the value of the item is not greater than 109), the sellers want to change its value to the nearest round number that is not greater than m. They ask you: by how many bourles should you decrease the value of the item to make it worth exactly 10k bourles, where the value of k \xe2\x80\x94 is the maximum possible (k \xe2\x80\x94 any non-negative integer).For example, let the item have a value of 178-bourles. Then the new price of the item will be 100, and the answer will be 178\xe2\x88\x92100=78." 800.0                                           
     1701F Points "combinatorics,data structures,implementation,math,matrices" "A triple of points i, j and k on a coordinate line is called beautiful if i<j<k and k\xe2\x88\x92i\xe2\x89\xa4d.You are given a set of points on a coordinate line, initially empty. You have to process queries of three types:  add a point;  remove a point;  calculate the number of beautiful triples consisting of points belonging to the set." 2500.0                                           
     1701A "Grass Field" implementation "There is a field of size 2\xc3\x972. Each cell of this field can either contain grass or be empty. The value ai,j is 1 if the cell (i,j) contains grass, or 0 otherwise.In one move, you can choose one row and one column and cut all the grass in this row and this column. In other words, you choose the row x and the column y, then you cut the grass in all cells ax,i and all cells ai,y for all i from 1 to 2. After you cut the grass from a cell, it becomes empty (i.\xe2\x80\x89e. its value is replaced by 0).Your task is to find the minimum number of moves required to cut the grass in all non-empty cells of the field (i.\xe2\x80\x89e. make all ai,j zeros).You have to answer t independent test cases." 800.0                                           
     1700A "Optimal Path" "constructive algorithms,greedy,math" "You are given a table a of size n\xc3\x97m. We will consider the table rows numbered from top to bottom from 1 to n, and the columns numbered from left to right from 1 to m. We will denote a cell that is in the i-th row and in the j-th column as (i,j). In the cell (i,j) there is written a number (i\xe2\x88\x921)\xe2\x8b\x85m+j, that is aij=(i\xe2\x88\x921)\xe2\x8b\x85m+j.A turtle initially stands in the cell (1,1) and it wants to come to the cell (n,m). From the cell (i,j) it can in one step go to one of the cells (i+1,j) or (i,j+1), if it exists. A path is a sequence of cells in which for every two adjacent in the sequence cells the following satisfies: the turtle can reach from the first cell to the second cell in one step. A cost of a path is the sum of numbers that are written in the cells of the path.  For example, with n=2 and m=3 the table will look as shown above. The turtle can take the following path: (1,1)\xe2\x86\x92(1,2)\xe2\x86\x92(1,3)\xe2\x86\x92(2,3). The cost of such way is equal to a11+a12+a13+a23=12. On the other hand, the paths (1,1)\xe2\x86\x92(1,2)\xe2\x86\x92(2,2)\xe2\x86\x92(2,1) and (1,1)\xe2\x86\x92(1,3) are incorrect, because in the first path the turtle can\'t make a step (2,2)\xe2\x86\x92(2,1), and in the second path it can\'t make a step (1,1)\xe2\x86\x92(1,3).You are asked to tell the turtle a minimal possible cost of a path from the cell (1,1) to the cell (n,m). Please note that the cells (1,1) and (n,m) are a part of the way." 800.0                                           
     1698F "Equal Reversal" "constructive algorithms,graphs,implementation,math" "There is an array a of length n. You may perform the following operation on it:  Choose two indices l and r where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and al=ar. Then, reverse the subsegment from the l-th to the r-th element, i. e. set [al,al+1,\xe2\x80\xa6,ar\xe2\x88\x921,ar] to [ar,ar\xe2\x88\x921,\xe2\x80\xa6,al+1,al]. You are also given another array b of length n which is a permutation of a. Find a sequence of at most n2 operations that transforms array a into b, or report that no such sequence exists." 2800.0                                           
     1698E "PermutationForces II" "brute force,combinatorics,greedy,sortings,trees,two pointers" "You are given a permutation a of length n. Recall that permutation is an array consisting of n distinct integers from 1 to n in arbitrary order.You have a strength of s and perform n moves on the permutation a. The i-th move consists of the following:   Pick two integers x and y such that i\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4min(i+s,n), and swap the positions of the integers x and y in the permutation a. Note that you can select x=y in the operation, in which case no swap will occur. You want to turn a into another permutation b after n moves. However, some elements of b are missing and are replaced with \xe2\x88\x921 instead. Count the number of ways to replace each \xe2\x88\x921 in b with some integer from 1 to n so that b is a permutation and it is possible to turn a into b with a strength of s. Since the answer can be large, output it modulo 998244353." 2300.0                                           
     1697E Coloring "brute force,combinatorics,constructive algorithms,dp,geometry,graphs,greedy,implementation,math" "You are given n points on the plane, the coordinates of the i-th point are (xi,yi). No two points have the same coordinates.The distance between points i and j is defined as d(i,j)=|xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|.For each point, you have to choose a color, represented by an integer from 1 to n. For every ordered triple of different points (a,b,c), the following constraints should be met:  if a, b and c have the same color, then d(a,b)=d(a,c)=d(b,c);  if a and b have the same color, and the color of c is different from the color of a, then d(a,b)<d(a,c) and d(a,b)<d(b,c). Calculate the number of different ways to choose the colors that meet these constraints." 2400.0                                           
     1697D "Guess The String" "binary search,constructive algorithms,interactive" "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.The jury has chosen a string s consisting of n characters; each character of s is a lowercase Latin letter. Your task is to guess this string; initially, you know only its length.You may ask queries of two types:  1 i \xe2\x80\x94 the query of the first type, where i is an integer from 1 to n. In response to this query, the jury will tell you the character si;  2 l r \xe2\x80\x94 the query of the second type, where l and r are integers such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. In response to this query, the jury will tell you the number of different characters among sl,sl+1,\xe2\x80\xa6,sr. You are allowed to ask no more than 26 queries of the first type, and no more than 6000 queries of the second type. Your task is to restore the string s.For each test in this problem, the string s is fixed beforehand, and will be the same for every submission." 1900.0                                           
     1696C "Fishingprince Plays With Array" "constructive algorithms,greedy,implementation,math" "Fishingprince is playing with an array [a1,a2,\xe2\x80\xa6,an]. He also has a magic number m.He can do the following two operations on it:  Select 1\xe2\x89\xa4i\xe2\x89\xa4n such that ai is divisible by m (that is, there exists an integer t such that m\xe2\x8b\x85t=ai). Replace ai with m copies of aim. The order of the other elements doesn\'t change. For example, when m=2 and a=[2,3] and i=1, a changes into [1,1,3].  Select 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92m+1 such that ai=ai+1=\xe2\x8b\xaf=ai+m\xe2\x88\x921. Replace these m elements with a single m\xe2\x8b\x85ai. The order of the other elements doesn\'t change. For example, when m=2 and a=[3,2,2,3] and i=2, a changes into [3,4,3]. Note that the array length might change during the process. The value of n above is defined as the current length of the array (might differ from the n in the input).Fishingprince has another array [b1,b2,\xe2\x80\xa6,bk]. Please determine if he can turn a into b using any number (possibly zero) of operations." 1400.0                                           
     1695B "Circle Game" games,greedy "Mike and Joe are playing a game with some stones. Specifically, they have n piles of stones of sizes a1,a2,\xe2\x80\xa6,an. These piles are arranged in a circle.The game goes as follows. Players take turns removing some positive number of stones from a pile in clockwise order starting from pile 1. Formally, if a player removed stones from pile i on a turn, the other player removes stones from pile ((imodn)+1) on the next turn.If a player cannot remove any stones on their turn (because the pile is empty), they lose. Mike goes first.If Mike and Joe play optimally, who will win?" 1000.0                                           
     1693F "I Might Be Wrong" "binary search,greedy,two pointers" "You are given a binary string S of length n indexed from 1 to n. You can perform the following operation any number of times (possibly zero):Choose two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). Let cnt0 be the number of times 0 occurs in S[l\xe2\x80\xa6r] and cnt1 be the number of times 1 occurs in S[l\xe2\x80\xa6r]. You can pay |cnt0\xe2\x88\x92cnt1|+1 coins and sort the S[l\xe2\x80\xa6r]. (by S[l\xe2\x80\xa6r] we mean the substring of S starting at position l and ending at position r)For example if S= 11001, we can perform the operation on S[2\xe2\x80\xa64], paying |2\xe2\x88\x921|+1=2 coins, and obtain S= 10011 as a new string.Find the minimum total number of coins required to sort S in increasing order." 3400.0                                           
     1693E "Outermost Maximums" "data structures,greedy" "Yeri has an array of n+2 non-negative integers : a0,a1,...,an,an+1.We know that a0=an+1=0.She wants to make all the elements of a equal to zero in the minimum number of operations.In one operation she can do one of the following:  Choose the leftmost maximum element and change it to the maximum of the elements on its left. Choose the rightmost maximum element and change it to the maximum of the elements on its right.Help her find the minimum number of operations needed to make all elements of a equal to zero." 3400.0                                           
     1691C "Sum of Substrings" "brute force,constructive algorithms,greedy,math,strings" "You are given a binary string s of length n.Let\'s define di as the number whose decimal representation is sisi+1 (possibly, with a leading zero). We define f(s) to be the sum of all the valid di. In other words, f(s)=n\xe2\x88\x921\xe2\x88\x91i=1di.For example, for the string s=1011:   d1=10 (ten);  d2=01 (one)  d3=11 (eleven);  f(s)=10+01+11=22. In one operation you can swap any two adjacent elements of the string. Find the minimum value of f(s) that can be achieved if at most k operations are allowed." 1400.0                                           
     1691A "Beat The Odds" "brute force,greedy,math" "Given a sequence a1,a2,\xe2\x80\xa6,an, find the minimum number of elements to remove from the sequence such that after the removal, the sum of every 2 consecutive elements is even." 800.0                                           
     1689E ANDfinity "bitmasks,brute force,constructive algorithms,dfs and similar,dsu,graphs" "Bit Lightyear, to the ANDfinity and beyond!After graduating from computer sciences, Vlad has been awarded an array a1,a2,\xe2\x80\xa6,an of n non-negative integers. As it is natural, he wanted to construct a graph consisting of n vertices, numbered 1,2,\xe2\x80\xa6,n. He decided to add an edge between i and j if and only if ai&aj>0, where & denotes the bitwise AND operation.Vlad also wants the graph to be connected, which might not be the case initially. In order to satisfy that, he can do the following two types of operations on the array:  Choose some element ai and increment it by 1.  Choose some element ai and decrement it by 1 (possible only if ai>0). It can be proven that there exists a finite sequence of operations such that the graph will be connected. So, can you please help Vlad find the minimum possible number of operations to do that and also provide the way how to do that?" 2500.0                                           
     1687E "Become Big For Me" "combinatorics,constructive algorithms,greedy,math,number theory" "Come, let\'s build a world where even the weak are not forgotten!\xe2\x80\x94Kijin Seija, Double Dealing CharactersShinmyoumaru has a mallet that can turn objects bigger or smaller. She is testing it out on a sequence a and a number v whose initial value is 1. She wants to make v=gcdi\xe2\x89\xa0j{ai\xe2\x8b\x85aj} by no more than 105 operations (gcdi\xe2\x89\xa0j{ai\xe2\x8b\x85aj} denotes the gcd of all products of two distinct elements of the sequence a). In each operation, she picks a subsequence b of a, and does one of the followings:   Enlarge: v=v\xe2\x8b\x85lcm(b)  Reduce: v=vlcm(b) Note that she does not need to guarantee that v is an integer, that is, v does not need to be a multiple of lcm(b) when performing Reduce.Moreover, she wants to guarantee that the total length of b chosen over the operations does not exceed 106. Fine a possible operation sequence for her. You don\'t need to minimize anything." 3500.0                                           
     1686A "Everything Everywhere All But One" greedy "You are given an array of n integers a1,a2,\xe2\x80\xa6,an. After you watched the amazing film ""Everything Everywhere All At Once"", you came up with the following operation.In one operation, you choose n\xe2\x88\x921 elements of the array and replace each of them with their arithmetic mean (which doesn\'t have to be an integer). For example, from the array [1,2,3,1] we can get the array [2,2,2,1], if we choose the first three elements, or we can get the array [43,43,3,43], if we choose all elements except the third.Is it possible to make all elements of the array equal by performing a finite number of such operations?" 800.0                                           
     1685D2 "Permutation Weight (Hard Version)" "constructive algorithms,greedy" "This is a hard version of the problem. The difference between the easy and hard versions is that in this version, you have to output the lexicographically smallest permutation with the smallest weight.You are given a permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n.Let\'s define the weight of the permutation q1,q2,\xe2\x80\xa6,qn of integers from 1 to n as |q1\xe2\x88\x92pq2|+|q2\xe2\x88\x92pq3|+\xe2\x80\xa6+|qn\xe2\x88\x921\xe2\x88\x92pqn|+|qn\xe2\x88\x92pq1|You want your permutation to be as lightweight as possible. Among the permutations q with the smallest possible weight, find the lexicographically smallest.Permutation a1,a2,\xe2\x80\xa6,an is lexicographically smaller than permutation b1,b2,\xe2\x80\xa6,bn, if there exists some 1\xe2\x89\xa4i\xe2\x89\xa4n such that aj=bj for all 1\xe2\x89\xa4j<i and ai<bi." 3500.0                                           
     1684C "Column Swapping" "brute force,constructive algorithms,greedy,implementation,sortings" "You are given a grid with n rows and m columns, where each cell has a positive integer written on it. Let\'s call a grid good, if in each row the sequence of numbers is sorted in a non-decreasing order. It means, that for each 1\xe2\x89\xa4i\xe2\x89\xa4n and 2\xe2\x89\xa4j\xe2\x89\xa4m the following holds: ai,j\xe2\x89\xa5ai,j\xe2\x88\x921.You have to to do the following operation exactly once: choose two columns with indexes i and j (not necessarily different), 1\xe2\x89\xa4i,j\xe2\x89\xa4m, and swap them.You are asked to determine whether it is possible to make the grid good after the swap and, if it is, find the columns that need to be swapped." 1400.0                                           
     1677E "Tokitsukaze and Beautiful Subsegments" "data structures" "Tokitsukaze has a permutation p of length n.Let\'s call a segment [l,r] beautiful if there exist i and j satisfying pi\xe2\x8b\x85pj=max{pl,pl+1,\xe2\x80\xa6,pr}, where l\xe2\x89\xa4i<j\xe2\x89\xa4r.Now Tokitsukaze has q queries, in the i-th query she wants to know how many beautiful subsegments [x,y] there are in the segment [li,ri] (i. e. li\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4ri)." 2900.0                                           
     1675F "Vlad and Unfinished Business" "dfs and similar,dp,greedy,trees" "Vlad and Nastya live in a city consisting of n houses and n\xe2\x88\x921 road. From each house, you can get to the other by moving only along the roads. That is, the city is a tree.Vlad lives in a house with index x, and Nastya lives in a house with index y. Vlad decided to visit Nastya. However, he remembered that he had postponed for later k things that he has to do before coming to Nastya. To do the i-th thing, he needs to come to the ai-th house, things can be done in any order. In 1 minute, he can walk from one house to another if they are connected by a road.Vlad does not really like walking, so he is interested what is the minimum number of minutes he has to spend on the road to do all things and then come to Nastya. Houses a1,a2,\xe2\x80\xa6,ak he can visit in any order. He can visit any house multiple times (if he wants)." 1800.0                                           
     1675A "Food for Animals" greedy,math "In the pet store on sale there are:  a packs of dog food;  b packs of cat food;  c packs of universal food (such food is suitable for both dogs and cats). Polycarp has x dogs and y cats. Is it possible that he will be able to buy food for all his animals in the store? Each of his dogs and each of his cats should receive one pack of suitable food for it." 800.0                                           
     1673F "Anti-Theft Road Planning" "bitmasks,constructive algorithms,divide and conquer,greedy,interactive,math" "This is an interactive problem.A city has n2 buildings divided into a grid of n rows and n columns. You need to build a road of some length D(A,B) of your choice between each pair of adjacent by side buildings A and B. Due to budget limitations and legal restrictions, the length of each road must be a positive integer and the total length of all roads should not exceed 48000.There is a thief in the city who will start from the topmost, leftmost building (in the first row and the first column) and roam around the city, occasionally stealing artifacts from some of the buildings. He can move from one building to another adjacent building by travelling through the road which connects them.You are unable to track down what buildings he visits and what path he follows to reach them. But there is one tracking mechanism in the city. The tracker is capable of storing a single integer x which is initially 0. Each time the thief travels from a building A to another adjacent building B through a road of length D(A,B), the tracker changes x to x\xe2\x8a\x95D(A,B). Each time the thief steals from a building, the tracker reports the value x stored in it and resets it back to 0.It is known beforehand that the thief will steal in exactly k buildings but you will know the values returned by the tracker only after the thefts actually happen. Your task is to choose the lengths of roads in such a way that no matter what strategy or routes the thief follows, you will be able to exactly tell the location of all the buildings where the thefts occurred from the values returned by the tracker." 2400.0                                           
     1673D "Lost Arithmetic Progression" "combinatorics,math,number theory" "Long ago, you thought of two finite arithmetic progressions A and B. Then you found out another sequence C containing all elements common to both A and B. It is not hard to see that C is also a finite arithmetic progression. After many years, you forgot what A was but remember B and C. You are, for some reason, determined to find this lost arithmetic progression. Before you begin this eternal search, you want to know how many different finite arithmetic progressions exist which can be your lost progression A. Two arithmetic progressions are considered different if they differ in their first term, common difference or number of terms.It may be possible that there are infinitely many such progressions, in which case you won\'t even try to look for them! Print \xe2\x88\x921 in all such cases. Even if there are finite number of them, the answer might be very large. So, you are only interested to find the answer modulo 109+7." 1900.0                                           
     1672F2 "Checker for Array Shuffling" "constructive algorithms,dfs and similar,graphs" "oolimry has an array a of length n which he really likes. Today, you have changed his array to b, a permutation of a, to make him sad.Because oolimry is only a duck, he can only perform the following operation to restore his array:   Choose two integers i,j such that 1\xe2\x89\xa4i,j\xe2\x89\xa4n.  Swap bi and bj. The sadness of the array b is the minimum number of operations needed to transform b into a.Given the arrays a and b, where b is a permutation of a, determine if b has the maximum sadness over all permutations of a." 2800.0                                           
     1672B "I love AAAB" "constructive algorithms,implementation" "Let\'s call a string good if its length is at least 2 and all of its characters are A except for the last character which is B. The good strings are AB,AAB,AAAB,\xe2\x80\xa6. Note that B is not a good string.You are given an initially empty string s1.You can perform the following operation any number of times:   Choose any position of s1 and insert some good string in that position. Given a string s2, can we turn s1 into s2 after some number of operations?" 800.0                                           
     1671F "Permutation Counting" "brute force,combinatorics,dp,fft,math" "Calculate the number of permutations p of size n with exactly k inversions (pairs of indices (i,j) such that i<j and pi>pj) and exactly x indices i such that pi>pi+1.Yep, that\'s the whole problem. Good luck!" 2700.0                                           
     1670E "Hemose on the Tree" "bitmasks,constructive algorithms,dfs and similar,trees" "After the last regional contest, Hemose and his teammates finally qualified to the ICPC World Finals, so for this great achievement and his love of trees, he gave you this problem as the name of his team ""Hemose 3al shagra"" (Hemose on the tree).You are given a tree of n vertices where n is a power of 2. You have to give each node and edge an integer value in the range [1,2n\xe2\x88\x921] (inclusive), where all the values are distinct.After giving each node and edge a value, you should select some root for the tree such that the maximum cost of any simple path starting from the root and ending at any node or edge is minimized.The cost of the path between two nodes u and v or any node u and edge e is defined as the bitwise XOR of all the node\'s and edge\'s values between them, including the endpoints (note that in a tree there is only one simple path between two nodes or between a node and an edge)." 2200.0                                           
     1669F "Eating Candies" "binary search,data structures,greedy,two pointers" "There are n candies put from left to right on a table. The candies are numbered from left to right. The i-th candy has weight wi. Alice and Bob eat candies. Alice can eat any number of candies from the left (she can\'t skip candies, she eats them in a row). Bob can eat any number of candies from the right (he can\'t skip candies, he eats them in a row). Of course, if Alice ate a candy, Bob can\'t eat it (and vice versa).They want to be fair. Their goal is to eat the same total weight of candies. What is the most number of candies they can eat in total?" 1100.0                                           
     1669A Division? implementation "Codeforces separates its users into 4 divisions by their rating:  For Division 1: 1900\xe2\x89\xa4rating  For Division 2: 1600\xe2\x89\xa4rating\xe2\x89\xa41899  For Division 3: 1400\xe2\x89\xa4rating\xe2\x89\xa41599  For Division 4: rating\xe2\x89\xa41399 Given a rating, print in which division the rating belongs." 800.0                                           
     1666I "Interactive Treasure Hunt" "brute force,constructive algorithms,geometry,interactive,math" "This is an interactive problem.There is a grid of n\xc3\x97m cells. Two treasure chests are buried in two different cells of the grid. Your task is to find both of them. You can make two types of operations:    DIG r c: try to find the treasure in the cell (r,c). The interactor will tell you if you found the treasure or not.  SCAN r c: scan from the cell (r,c). The result of this operation is the sum of Manhattan distances from the cell (r,c) to the cells where the treasures are hidden. Manhattan distance from a cell (r1,c1) to a cell (r2,c2) is calculated as |r1\xe2\x88\x92r2|+|c1\xe2\x88\x92c2|. You need to find the treasures in at most 7 operations. This includes both DIG and SCAN operations in total. To solve the test you need to call DIG operation at least once in both of the cells where the treasures are hidden." 2200.0                                           
     1666B "Budget Distribution"  "Distributing budgeted money with limited resources and many constraints is a hard problem. A budget plan consists of t topics; i-th topic consists of ni items. For each topic, the optimal relative money distribution is known. The optimal relative distribution for the topic i is a list of real numbers pi,j, where ni\xe2\x88\x91j=1pi,j=1. Let\'s denote the amount of money assigned to j-th item of the topic i as ci,j; the total amount of money for the topic is Ci=ni\xe2\x88\x91j=1ci,j. A non-optimality of the plan for the topic i is defined as ni\xe2\x88\x91j=1|ci,jCi\xe2\x88\x92pi,j|. Informally, the non-optimality is the total difference between the optimal and the actual ratios of money assigned to all the items in the topic. The total plan non-optimality is the sum of non-optimalities of all t topics. Your task is to minimize the total plan non-optimality.However, the exact amount of money available is not known yet. j-th item of i-th topic already has \xcb\x86ci,j dollars assigned to it and they cannot be taken back. Also, there are q possible values of the extra unassigned amounts of money available xk. For each of them, you need to calculate the minimal possible total non-optimality among all ways to distribute this extra money. You don\'t need to assign an integer amount of money to an item, any real number is possible, but all the extra money must be distributed among all the items in addition to \xcb\x86ci,j already assigned. Formally, for each value of extra money xk you\'ll need to find its distribution di,j such that di,j\xe2\x89\xa50 and t\xe2\x88\x91i=1ni\xe2\x88\x91j=1di,j=xk, giving the resulting budget assignments ci,j=\xcb\x86ci,j+di,j that minimize the total plan non-optimality." 3300.0                                           
     1663E "Are You Safe?" "*special problem,implementation" "Seven boys and seven girls from Athens were brought before King Minos. The evil king laughed and said ""I hope you enjoy your stay in Crete"".With a loud clang, the doors behind them shut, and darkness reigned. The terrified children huddled together. In the distance they heard a bellowing, unholy roar.Bravely, they advanced forward, to their doom." -999.0                                           
     1663A "Who Tested?" "*special problem,expression parsing,trees"  -999.0                                           
     1662L "Il Derby della Madonnina" "data structures,dp,math" "The derby between Milan and Inter is happening soon, and you have been chosen as the assistant referee for the match, also known as linesman. Your task is to move along the touch-line, namely the side of the field, always looking very carefully at the match to check for offside positions and other offences.Football is an extremely serious matter in Italy, and thus it is fundamental that you keep very close track of the ball for as much time as possible. This means that you want to maximise the number of kicks which you monitor closely. You are able to monitor closely a kick if, when it happens, you are in the position along the touch-line with minimum distance from the place where the kick happens.Fortunately, expert analysts have been able to accurately predict all the kicks which will occur during the game. That is, you have been given two lists of integers, t1,\xe2\x80\xa6,tn and a1,\xe2\x80\xa6,an, indicating that ti seconds after the beginning of the match the ball will be kicked and you can monitor closely such kick if you are at the position ai along the touch-line. At the beginning of the game you start at position 0 and the maximum speed at which you can walk along the touch-line is v units per second (i.e., you can change your position by at most v each second). What is the maximum number of kicks that you can monitor closely?" -999.0                                           
     1662I "Ice Cream Shop" "brute force,implementation,sortings" "On a beach there are n huts in a perfect line, hut 1 being at the left and hut i+1 being 100 meters to the right of hut i, for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. In hut i there are pi people.There are m ice cream sellers, also aligned in a perfect line with all the huts. The i-th ice cream seller has their shop xi meters to the right of the first hut. All ice cream shops are at distinct locations, but they may be at the same location as a hut.You want to open a new ice cream shop and you wonder what the best location for your shop is. You can place your ice cream shop anywhere on the beach (not necessarily at an integer distance from the first hut) as long as it is aligned with the huts and the other ice cream shops, even if there is already another ice cream shop or a hut at that location. You know that people would come to your shop only if it is strictly closer to their hut than any other ice cream shop.If every person living in the huts wants to buy exactly one ice cream, what is the maximum number of ice creams that you can sell if you place the shop optimally?" -999.0                                           
     1662F Antennas "data structures,dfs and similar,graphs,graphs,implementation,implementation,shortest paths,shortest paths" "There are n equidistant antennas on a line, numbered from 1 to n. Each antenna has a power rating, the power of the i-th antenna is pi. The i-th and the j-th antenna can communicate directly if and only if their distance is at most the minimum of their powers, i.e., |i\xe2\x88\x92j|\xe2\x89\xa4min(pi,pj). Sending a message directly between two such antennas takes 1 second.What is the minimum amount of time necessary to send a message from antenna a to antenna b, possibly using other antennas as relays?" -999.0                                           
     1661E "Narrow Components" "brute force,data structures,dp,dsu,math,trees" "You are given a matrix a, consisting of 3 rows and n columns. Each cell of the matrix is either free or taken.A free cell y is reachable from a free cell x if at least one of these conditions hold:   x and y share a side;  there exists a free cell z such that z is reachable from x and y is reachable from z. A connected component is a set of free cells of the matrix such that all cells in it are reachable from one another, but adding any other free cell to the set violates this rule.You are asked q queries about the matrix. Each query is the following:   l r \xe2\x80\x94 count the number of connected components of the matrix, consisting of columns from l to r of the matrix a, inclusive. Print the answers to all queries." 2500.0                                           
     1660E "Matrix and Shifts" "brute force,constructive algorithms,greedy,implementation" "You are given a binary matrix A of size n\xc3\x97n. Rows are numbered from top to bottom from 1 to n, columns are numbered from left to right from 1 to n. The element located at the intersection of row i and column j is called Aij. Consider a set of 4 operations:  Cyclically shift all rows up. The row with index i will be written in place of the row i\xe2\x88\x921 (2\xe2\x89\xa4i\xe2\x89\xa4n), the row with index 1 will be written in place of the row n.  Cyclically shift all rows down. The row with index i will be written in place of the row i+1 (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), the row with index n will be written in place of the row 1.  Cyclically shift all columns to the left. The column with index j will be written in place of the column j\xe2\x88\x921 (2\xe2\x89\xa4j\xe2\x89\xa4n), the column with index 1 will be written in place of the column n.  Cyclically shift all columns to the right. The column with index j will be written in place of the column j+1 (1\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x921), the column with index n will be written in place of the column 1.   The 3\xc3\x973 matrix is shown on the left before the 3-rd operation is applied to it, on the right \xe2\x80\x94 after. You can perform an arbitrary (possibly zero) number of operations on the matrix; the operations can be performed in any order.After that, you can perform an arbitrary (possibly zero) number of new xor-operations:  Select any element Aij and assign it with new value Aij\xe2\x8a\x951. In other words, the value of (Aij+1)mod2 will have to be written into element Aij. Each application of this xor-operation costs one burl. Note that the 4 shift operations \xe2\x80\x94 are free. These 4 operations can only be performed before xor-operations are performed.Output the minimum number of burles you would have to pay to make the A matrix unitary. A unitary matrix is a matrix with ones on the main diagonal and the rest of its elements are zeros (that is, Aij=1 if i=j and Aij=0 otherwise)." 1600.0                                           
     1659B "Bit Flipping" "bitmasks,constructive algorithms,greedy,strings" "You are given a binary string of length n. You have exactly k moves. In one move, you must select a single bit. The state of all bits except that bit will get flipped (0 becomes 1, 1 becomes 0). You need to output the lexicographically largest string that you can get after using all k moves. Also, output the number of times you will select each bit. If there are multiple ways to do this, you may output any of them.A binary string a is lexicographically larger than a binary string b of the same length, if and only if the following holds:   in the first position where a and b differ, the string a contains a 1, and the string b contains a 0." 1300.0                                           
     1657F "Words on Tree" "2-sat,dfs and similar,dsu,graphs,trees" "You are given a tree consisting of n vertices, and q triples (xi,yi,si), where xi and yi are integers from 1 to n, and si is a string with length equal to the number of vertices on the simple path from xi to yi.You want to write a lowercase Latin letter on each vertex in such a way that, for each of q given triples, at least one of the following conditions holds:  if you write out the letters on the vertices on the simple path from xi to yi in the order they appear on this path, you get the string si;  if you write out the letters on the vertices on the simple path from yi to xi in the order they appear on this path, you get the string si. Find any possible way to write a letter on each vertex to meet these constraints, or report that it is impossible." 2600.0                                           
     1656E "Equal Tree Sums" "constructive algorithms,dfs and similar,math,trees" "You are given an undirected unrooted tree, i.e. a connected undirected graph without cycles.You must assign a nonzero integer weight to each vertex so that the following is satisfied: if any vertex of the tree is removed, then each of the remaining connected components has the same sum of weights in its vertices." 2200.0                                           
     1654F "Minimal String Xoration" "bitmasks,data structures,divide and conquer,greedy,hashing,sortings,strings" "You are given an integer n and a string s consisting of 2n lowercase letters of the English alphabet. The characters of the string s are s0s1s2\xe2\x8b\xafs2n\xe2\x88\x921.A string t of length 2n (whose characters are denoted by t0t1t2\xe2\x8b\xaft2n\xe2\x88\x921) is a xoration of s if there exists an integer j (0\xe2\x89\xa4j\xe2\x89\xa42n\xe2\x88\x921) such that, for each 0\xe2\x89\xa4i\xe2\x89\xa42n\xe2\x88\x921, ti=si\xe2\x8a\x95j (where \xe2\x8a\x95 denotes the operation bitwise XOR).Find the lexicographically minimal xoration of s.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 2800.0                                           
     1648C "Tyler and Strings" "combinatorics,data structures,implementation" "While looking at the kitchen fridge, the little boy Tyler noticed magnets with symbols, that can be aligned into a string s.Tyler likes strings, and especially those that are lexicographically smaller than another string, t. After playing with magnets on the fridge, he is wondering, how many distinct strings can be composed out of letters of string s by rearranging them, so that the resulting string is lexicographically smaller than the string t? Tyler is too young, so he can\'t answer this question. The alphabet Tyler uses is very large, so for your convenience he has already replaced the same letters in s and t to the same integers, keeping that different letters have been replaced to different integers.We call a string x lexicographically smaller than a string y if one of the followings conditions is fulfilled:   There exists such position of symbol m that is presented in both strings, so that before m-th symbol the strings are equal, and the m-th symbol of string x is smaller than m-th symbol of string y.  String x is the prefix of string y and x\xe2\x89\xa0y. Because the answer can be too large, print it modulo 998244353." 1900.0                                           
     1648B "Integral Array" "brute force,constructive algorithms,data structures,math" "You are given an array a of n positive integers numbered from 1 to n. Let\'s call an array integral if for any two, not necessarily different, numbers x and y from this array, x\xe2\x89\xa5y, the number \xe2\x8c\x8axy\xe2\x8c\x8b (x divided by y with rounding down) is also in this array.You are guaranteed that all numbers in a do not exceed c. Your task is to check whether this array is integral." 1800.0                                           
     1647A "Madoka and Math Dad" implementation,math "Madoka finally found the administrator password for her computer. Her father is a well-known popularizer of mathematics, so the password is the answer to the following problem.Find the maximum decimal number without zeroes and with no equal digits in a row, such that the sum of its digits is n.Madoka is too tired of math to solve it herself, so help her to solve this problem!" 800.0                                           
     1646B "Quality vs Quantity" "brute force,constructive algorithms,greedy,sortings,two pointers" "You are given a sequence of n non-negative integers a1,a2,\xe2\x80\xa6,an. Initially, all the elements of the sequence are unpainted. You can paint each number Red_ or \xc2\xafBlue (but not both), or leave it unpainted. For a color c, Count(c) is the number of elements in the sequence painted with that color and Sum(c) is the sum of the elements in the sequence painted with that color.For example, if the given sequence is [2,8,6,3,1] and it is painted this way: [\xc2\xaf2,8,6_,\xc2\xaf3,1] (where 6 is painted red, 2 and 3 are painted blue, 1 and 8 are unpainted) then Sum(Red_)=6, Sum(\xc2\xafBlue)=2+3=5, Count(Red_)=1, and Count(\xc2\xafBlue)=2.Determine if it is possible to paint the sequence so that Sum(Red_)>Sum(\xc2\xafBlue) and Count(Red_)<Count(\xc2\xafBlue)." 800.0                                           
     1641C "Anonymity Is Important" "binary search,brute force,data structures,dsu,greedy,sortings" "In the work of a doctor, it is important to maintain the anonymity of clients and the results of tests. The test results are sent to everyone personally by email, but people are very impatient and they want to know the results right away.That\'s why in the testing lab ""De-vitro"" doctors came up with an experimental way to report the results. Let\'s assume that n people took the tests in the order of the queue. Then the chief doctor Sam can make several statements, in each telling if there is a sick person among the people in the queue from l-th to r-th (inclusive), for some values l and r.During the process, Sam will check how well this scheme works and will be interested in whether it is possible to find out the test result of i-th person from the information he announced. And if it can be done, then is that patient sick or not.Help Sam to test his scheme." 2200.0                                           
     1639I "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999.0                                           
     1639A "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999.0                                           
     1638A Reverse "constructive algorithms,greedy,math" "You are given a permutation p1,p2,\xe2\x80\xa6,pn of length n. You have to choose two integers l,r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and reverse the subsegment [l,r] of the permutation. The permutation will become p1,p2,\xe2\x80\xa6,pl\xe2\x88\x921,pr,pr\xe2\x88\x921,\xe2\x80\xa6,pl,pr+1,pr+2,\xe2\x80\xa6,pn.Find the lexicographically smallest permutation that can be obtained by performing exactly one reverse operation on the initial permutation.Note that for two distinct permutations of equal length a and b, a is lexicographically smaller than b if at the first position they differ, a has the smaller element.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 800.0                                           
     1635F "Closest Pair" "data structures,greedy" "There are n weighted points on the OX-axis. The coordinate and the weight of the i-th point is xi and wi, respectively. All points have distinct coordinates and positive weights. Also, xi<xi+1 holds for any 1\xe2\x89\xa4i<n. The weighted distance between i-th point and j-th point is defined as |xi\xe2\x88\x92xj|\xe2\x8b\x85(wi+wj), where |val| denotes the absolute value of val.You should answer q queries, where the i-th query asks the following: Find the minimum weighted distance among all pairs of distinct points among the points in subarray [li,ri]." 2800.0                                           
     1635D "Infinite Set" "bitmasks,dp,math,matrices,number theory,strings" "You are given an array a consisting of n distinct positive integers.Let\'s consider an infinite integer set S which contains all integers x that satisfy at least one of the following conditions: x=ai for some 1\xe2\x89\xa4i\xe2\x89\xa4n. x=2y+1 and y is in S. x=4y and y is in S.For example, if a=[1,2] then the 10 smallest elements in S will be {1,2,3,4,5,7,8,9,11,12}.Find the number of elements in S that are strictly smaller than 2p. Since this number may be too large, print it modulo 109+7." 1800.0                                           
     1634E "Fair Share" "constructive algorithms,data structures,dfs and similar,graph matchings,graphs" "Even a cat has things it can do that AI cannot.\xe2\x80\x94 Fei-Fei LiYou are given m arrays of positive integers. Each array is of even length.You need to split all these integers into two equal multisets L and R, that is, each element of each array should go into one of two multisets (but not both). Additionally, for each of the m arrays, exactly half of its elements should go into L, and the rest should go into R.Give an example of such a division or determine that no such division exists." 2400.0                                           
     1634A "Reverse and Concatenate" greedy,strings "Real stupidity beats artificial intelligence every time.\xe2\x80\x94 Terry Pratchett, Hogfather, DiscworldYou are given a string s of length n and a number k. Let\'s denote by rev(s) the reversed string s (i.e. rev(s)=snsn\xe2\x88\x921...s1). You can apply one of the two kinds of operations to the string: replace the string s with s+rev(s) replace the string s with rev(s)+sHow many different strings can you get as a result of performing exactly k operations (possibly of different kinds) on the original string s?In this statement we denoted the concatenation of strings s and t as s+t. In other words, s+t=s1s2...snt1t2...tm, where n and m are the lengths of strings s and t respectively." 800.0                                           
     1633D "Make Them Equal" dp,greedy "You have an array of integers a of size n. Initially, all elements of the array are equal to 1. You can perform the following operation: choose two integers i (1\xe2\x89\xa4i\xe2\x89\xa4n) and x (x>0), and then increase the value of ai by \xe2\x8c\x8aaix\xe2\x8c\x8b (i.e. make ai=ai+\xe2\x8c\x8aaix\xe2\x8c\x8b).After performing all operations, you will receive ci coins for all such i that ai=bi.Your task is to determine the maximum number of coins that you can receive by performing no more than k operations." 1600.0                                           
     1630A "And Matching" "bitmasks,constructive algorithms" "You are given a set of n (n is always a power of 2) elements containing all integers 0,1,2,\xe2\x80\xa6,n\xe2\x88\x921 exactly once.Find n2 pairs of elements such that:  Each element in the set is in exactly one pair.  The sum over all pairs of the bitwise AND of its elements must be exactly equal to k. Formally, if ai and bi are the elements of the i-th pair, then the following must hold: n/2\xe2\x88\x91i=1ai&bi=k, where & denotes the bitwise AND operation. If there are many solutions, print any of them, if there is no solution, print \xe2\x88\x921 instead." 1500.0                                           
     1628D2 "Game on Sum (Hard Version)" combinatorics,dp,games,math "This is the hard version of the problem. The difference is the constraints on n, m and t. You can make hacks only if all versions of the problem are solved.Alice and Bob are given the numbers n, m and k, and play a game as follows:The game has a score that Alice tries to maximize, and Bob tries to minimize. The score is initially 0. The game consists of n turns. Each turn, Alice picks a real number from 0 to k (inclusive) which Bob either adds to or subtracts from the score of the game. But throughout the game, Bob has to choose to add at least m out of the n turns.Bob gets to know which number Alice picked before deciding whether to add or subtract the number from the score, and Alice gets to know whether Bob added or subtracted the number for the previous turn before picking the number for the current turn (except on the first turn since there was no previous turn).If Alice and Bob play optimally, what will the final score of the game be?" 2400.0                                           
     1626C "Monsters And Spells" "binary search,data structures,dp,greedy,implementation,math,two pointers" "Monocarp is playing a computer game once again. He is a wizard apprentice, who only knows a single spell. Luckily, this spell can damage the monsters.The level he\'s currently on contains n monsters. The i-th of them appears ki seconds after the start of the level and has hi health points. As an additional constraint, hi\xe2\x89\xa4ki for all 1\xe2\x89\xa4i\xe2\x89\xa4n. All ki are different.Monocarp can cast the spell at moments which are positive integer amounts of second after the start of the level: 1,2,3,\xe2\x80\xa6 The damage of the spell is calculated as follows. If he didn\'t cast the spell at the previous second, the damage is 1. Otherwise, let the damage at the previous second be x. Then he can choose the damage to be either x+1 or 1. A spell uses mana: casting a spell with damage x uses x mana. Mana doesn\'t regenerate.To kill the i-th monster, Monocarp has to cast a spell with damage at least hi at the exact moment the monster appears, which is ki.Note that Monocarp can cast the spell even when there is no monster at the current second.The mana amount required to cast the spells is the sum of mana usages for all cast spells. Calculate the least amount of mana required for Monocarp to kill all monsters.It can be shown that it\'s always possible to kill all monsters under the constraints of the problem." 1700.0                                           
     1626B "Minor Reduction" greedy,strings "You are given a decimal representation of an integer x without leading zeros.You have to perform the following reduction on it exactly once: take two neighboring digits in x and replace them with their sum without leading zeros (if the sum is 0, it\'s represented as a single 0).For example, if x=10057, the possible reductions are:   choose the first and the second digits 1 and 0, replace them with 1+0=1; the result is 1057;  choose the second and the third digits 0 and 0, replace them with 0+0=0; the result is also 1057;  choose the third and the fourth digits 0 and 5, replace them with 0+5=5; the result is still 1057;  choose the fourth and the fifth digits 5 and 7, replace them with 5+7=12; the result is 10012. What\'s the largest number that can be obtained?" 1100.0                                           
     1625E1 "Cats on the Upgrade (easy version)" "brute force,data structures,dfs and similar,divide and conquer,dp,graphs,trees" "This is the easy version of the problem. The only difference between the easy and the hard versions are removal queries, they are present only in the hard version.""Interplanetary Software, Inc."" together with ""Robots of Cydonia, Ltd."" has developed and released robot cats. These electronic pets can meow, catch mice and entertain the owner in various ways.The developers from ""Interplanetary Software, Inc."" have recently decided to release a software update for these robots. After the update, the cats must solve the problems about bracket sequences. One of the problems is described below.  First, we need to learn a bit of bracket sequence theory. Consider the strings that contain characters ""("", "")"" and ""."". Call a string regular bracket sequence (RBS), if it can be transformed to an empty string by one or more operations of removing either single ""."" characters, or a continuous substring ""()"". For instance, the string ""(()(.))"" is an RBS, as it can be transformed to an empty string with the following sequence of removals: ""(()(.))"" \xe2\x86\x92 ""(()())"" \xe2\x86\x92 ""(())"" \xe2\x86\x92 ""()"" \xe2\x86\x92 """". We got an empty string, so the initial string was an RBS. At the same time, the string "")("" is not an RBS, as it is not possible to apply such removal operations to it.An RBS is simple if this RBS is not empty, doesn\'t start with ""."", and doesn\'t end with ""."".Denote the substring of the string s as its sequential subsegment. In particular, s[l\xe2\x80\xa6r]=slsl+1\xe2\x80\xa6sr, where si is the i-th character of the string s.Now, move on to the problem statement itself. You are given a string s, initially consisting of characters ""("" and "")"". You need to answer the queries of the following kind.Given two indices, l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n), and it\'s guaranteed that the substring s[l\xe2\x80\xa6r] is a simple RBS. You need to find the number of substrings in s[l\xe2\x80\xa6r] such that they are simple RBS. In other words, find the number of index pairs i, j such that l\xe2\x89\xa4i<j\xe2\x89\xa4r and s[i\xe2\x80\xa6j] is a simple RBS.You are an employee in ""Interplanetary Software, Inc."" and you were given the task to teach the cats to solve the problem above, after the update.Note that the ""."" character cannot appear in the string in this version of the problem. It is only needed for the hard version." 2500.0                                           
     1625D "Binary Spiders" "bitmasks,data structures,implementation,math,sortings,trees" "Binary Spiders are species of spiders that live on Mars. These spiders weave their webs to defend themselves from enemies.To weave a web, spiders join in pairs. If the first spider in pair has x legs, and the second spider has y legs, then they weave a web with durability x\xe2\x8a\x95y. Here, \xe2\x8a\x95 means bitwise XOR.Binary Spiders live in large groups. You observe a group of n spiders, and the i-th spider has ai legs.When the group is threatened, some of the spiders become defenders. Defenders are chosen in the following way. First, there must be at least two defenders. Second, any pair of defenders must be able to weave a web with durability at least k. Third, there must be as much defenders as possible.Scientists have researched the behaviour of Binary Spiders for a long time, and now they have a hypothesis that they can always choose the defenders in an optimal way, satisfying the conditions above. You need to verify this hypothesis on your group of spiders. So, you need to understand how many spiders must become defenders. You are not a Binary Spider, so you decided to use a computer to solve this problem." 2300.0                                           
     1624B "Make AP" implementation,math "Polycarp has 3 positive integers a, b and c. He can perform the following operation exactly once.  Choose a positive integer m and multiply exactly one of the integers a, b or c by m. Can Polycarp make it so that after performing the operation, the sequence of three numbers a, b, c (in this order) forms an arithmetic progression? Note that you cannot change the order of a, b and c.Formally, a sequence x1,x2,\xe2\x80\xa6,xn is called an arithmetic progression (AP) if there exists a number d (called ""common difference"") such that xi+1=xi+d for all i from 1 to n\xe2\x88\x921. In this problem, n=3.For example, the following sequences are AP: [5,10,15], [3,2,1], [1,1,1], and [13,10,7]. The following sequences are not AP: [1,2,4], [0,1,0] and [1,3,2].You need to answer t independent test cases." 900.0                                           
     1623A "Robot Cleaner" "brute force,implementation,math" "A robot cleaner is placed on the floor of a rectangle room, surrounded by walls. The floor consists of nn rows and mm columns. The rows of the floor are numbered from 11 to nn from top to bottom, and columns of the floor are numbered from 11 to mm from left to right. The cell on the intersection of the rr-th row and the cc-th column is denoted as (r,c)(r,c). The initial position of the robot is (rb,cb)(rb,cb).In one second, the robot moves by drdr rows and dcdc columns, that is, after one second, the robot moves from the cell (r,c)(r,c) to (r+dr,c+dc)(r+dr,c+dc). Initially dr=1dr=1, dc=1dc=1. If there is a vertical wall (the left or the right walls) in the movement direction, dcdc is reflected before the movement, so the new value of dcdc is \xe2\x88\x92dc\xe2\x88\x92dc. And if there is a horizontal wall (the upper or lower walls), drdr is reflected before the movement, so the new value of drdr is \xe2\x88\x92dr\xe2\x88\x92dr.Each second (including the moment before the robot starts moving), the robot cleans every cell lying in the same row or the same column as its position. There is only one dirty cell at (rd,cd)(rd,cd). The job of the robot is to clean that dirty cell.  Illustration for the first example. The blue arc is the robot. The red star is the target dirty cell. Each second the robot cleans a row and a column, denoted by yellow stripes. Given the floor size nn and mm, the robot\'s initial position (rb,cb)(rb,cb) and the dirty cell\'s position (rd,cd)(rd,cd), find the time for the robot to do its job." 800.0                                           
     1620D "Exact Change" "brute force,constructive algorithms,greedy" "One day, early in the morning, you decided to buy yourself a bag of chips in the nearby store. The store has chips of n different flavors. A bag of the i-th flavor costs ai burles.The store may run out of some flavors, so you\'ll decide which one to buy after arriving there. But there are two major flaws in this plan:   you have only coins of 1, 2 and 3 burles;  since it\'s morning, the store will ask you to pay in exact change, i. e. if you choose the i-th flavor, you\'ll have to pay exactly ai burles. Coins are heavy, so you\'d like to take the least possible number of coins in total. That\'s why you are wondering: what is the minimum total number of coins you should take with you, so you can buy a bag of chips of any flavor in exact change?" 2000.0                                           
     1619B "Squares and Cubes" implementation,math "Polycarp likes squares and cubes of positive integers. Here is the beginning of the sequence of numbers he likes: 1, 4, 8, 9, ....For a given number n, count the number of integers from 1 to n that Polycarp likes. In other words, find the number of such x that x is a square of a positive integer number or a cube of a positive integer number (or both a square and a cube simultaneously)." 800.0                                           
     1619A "Square String?" implementation,strings "A string is called square if it is some string written twice in a row. For example, the strings ""aa"", ""abcabc"", ""abab"" and ""baabaa"" are square. But the strings ""aaa"", ""abaaab"" and ""abcdabc"" are not square.For a given string s determine if it is square." 800.0                                           
     1618F Reverse "bitmasks,constructive algorithms,dfs and similar,implementation,math,strings" "You are given two positive integers x and y. You can perform the following operation with x: write it in its binary form without leading zeros, add 0 or 1 to the right of it, reverse the binary form and turn it into a decimal number which is assigned as the new value of x.For example:   34 can be turned into 81 via one operation: the binary form of 34 is 100010, if you add 1, reverse it and remove leading zeros, you will get 1010001, which is the binary form of 81.  34 can be turned into 17 via one operation: the binary form of 34 is 100010, if you add 0, reverse it and remove leading zeros, you will get 10001, which is the binary form of 17.  81 can be turned into 69 via one operation: the binary form of 81 is 1010001, if you add 0, reverse it and remove leading zeros, you will get 1000101, which is the binary form of 69.  34 can be turned into 69 via two operations: first you turn 34 into 81 and then 81 into 69. Your task is to find out whether x can be turned into y after a certain number of operations (possibly zero)." 2000.0                                           
     1618D "Array and Operations" dp,greedy,math "You are given an array a of n integers, and another integer k such that 2k\xe2\x89\xa4n.You have to perform exactly k operations with this array. In one operation, you have to choose two elements of the array (let them be ai and aj; they can be equal or different, but their positions in the array must not be the same), remove them from the array, and add \xe2\x8c\x8aaiaj\xe2\x8c\x8b to your score, where \xe2\x8c\x8axy\xe2\x8c\x8b is the maximum integer not exceeding xy.Initially, your score is 0. After you perform exactly k operations, you add all the remaining elements of the array to the score.Calculate the minimum possible score you can get." 1300.0                                           
     1616G "Just Add an Edge" "dfs and similar,dp,graphs" "You are given a directed acyclic graph with n vertices and m edges. For all edges a\xe2\x86\x92b in the graph, a<b holds.You need to find the number of pairs of vertices x, y, such that x>y and after adding the edge x\xe2\x86\x92y to the graph, it has a Hamiltonian path." 3500.0                                           
     1615G "Maximum Adjacent Pairs" "constructive algorithms,graph matchings" "You are given an array a consisting of n non-negative integers.You have to replace each 0 in a with an integer from 1 to n (different elements equal to 0 can be replaced by different integers).The value of the array you obtain is the number of integers k from 1 to n such that the following condition holds: there exist a pair of adjacent elements equal to k (i.\xe2\x80\x89e. there exists some i\xe2\x88\x88[1,n\xe2\x88\x921] such that ai=ai+1=k). If there are multiple such pairs for some integer k, this integer is counted in the value only once.Your task is to obtain the array with the maximum possible value." 3300.0                                           
     1615F "LEGOndary Grandmaster" combinatorics,dp,math "After getting bored by playing with crayons, you decided to switch to Legos! Today, you\'re working with a long strip, with height 1 and length n, some positions of which are occupied by 1 by 1 Lego pieces.In one second, you can either remove two adjacent Lego pieces from the strip (if both are present), or add two Lego pieces to adjacent positions (if both are absent). You can only add or remove Lego\'s at two adjacent positions at the same time, as otherwise your chubby fingers run into precision issues.You want to know exactly how much time you\'ll spend playing with Legos. You value efficiency, so given some starting state and some ending state, you\'ll always spend the least number of seconds to transform the starting state into the ending state. If it\'s impossible to transform the starting state into the ending state, you just skip it (so you spend 0 seconds).The issue is that, for some positions, you don\'t remember whether there were Legos there or not (in either the starting state, the ending state, or both). Over all pairs of (starting state, ending state) that are consistent with your memory, find the total amount of time it will take to transform the starting state to the ending state. Print this value modulo 1000000007 (109+7)." 2800.0                                           
     1615D "X(or)-mas Tree" "bitmasks,dfs and similar,dsu,graphs,trees" "\'Twas the night before Christmas, and Santa\'s frantically setting up his new Christmas tree! There are n nodes in the tree, connected by n\xe2\x88\x921 edges. On each edge of the tree, there\'s a set of Christmas lights, which can be represented by an integer in binary representation.  He has m elves come over and admire his tree. Each elf is assigned two nodes, a and b, and that elf looks at all lights on the simple path between the two nodes. After this, the elf\'s favorite number becomes the bitwise XOR of the values of the lights on the edges in that path.However, the North Pole has been recovering from a nasty bout of flu. Because of this, Santa forgot some of the configurations of lights he had put on the tree, and he has already left the North Pole! Fortunately, the elves came to the rescue, and each one told Santa what pair of nodes he was assigned (ai,bi), as well as the parity of the number of set bits in his favorite number. In other words, he remembers whether the number of 1\'s when his favorite number is written in binary is odd or even.Help Santa determine if it\'s possible that the memories are consistent, and if it is, remember what his tree looked like, and maybe you\'ll go down in history!" 2200.0                                           
     1615A "Closing The Gap" greedy,math "There are n block towers in a row, where tower i has a height of ai. You\'re part of a building crew, and you want to make the buildings look as nice as possible. In a single day, you can perform the following operation:  Choose two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n; i\xe2\x89\xa0j), and move a block from tower i to tower j. This essentially decreases ai by 1 and increases aj by 1. You think the ugliness of the buildings is the height difference between the tallest and shortest buildings. Formally, the ugliness is defined as max(a)\xe2\x88\x92min(a). What\'s the minimum possible ugliness you can achieve, after any number of days?" 800.0                                           
     1614D1 "Divan and Kostomuksha (easy version)" "dp,number theory" "This is the easy version of the problem. The only difference is maximum value of ai.Once in Kostomuksha Divan found an array a consisting of positive integers. Now he wants to reorder the elements of a to maximize the value of the following function: n\xe2\x88\x91i=1gcd(a1,a2,\xe2\x80\xa6,ai), where gcd(x1,x2,\xe2\x80\xa6,xk) denotes the greatest common divisor of integers x1,x2,\xe2\x80\xa6,xk, and gcd(x)=x for any integer x.Reordering elements of an array means changing the order of elements in the array arbitrary, or leaving the initial order.Of course, Divan can solve this problem. However, he found it interesting, so he decided to share it with you." 2100.0                                           
     1613E "Crazy Robot" "dfs and similar,graphs" "There is a grid, consisting of n rows and m columns. Each cell of the grid is either free or blocked. One of the free cells contains a lab. All the cells beyond the borders of the grid are also blocked.A crazy robot has escaped from this lab. It is currently in some free cell of the grid. You can send one of the following commands to the robot: ""move right"", ""move down"", ""move left"" or ""move up"". Each command means moving to a neighbouring cell in the corresponding direction.However, as the robot is crazy, it will do anything except following the command. Upon receiving a command, it will choose a direction such that it differs from the one in command and the cell in that direction is not blocked. If there is such a direction, then it will move to a neighbouring cell in that direction. Otherwise, it will do nothing.We want to get the robot to the lab to get it fixed. For each free cell, determine if the robot can be forced to reach the lab starting in this cell. That is, after each step of the robot a command can be sent to a robot such that no matter what different directions the robot chooses, it will end up in a lab." 2000.0                                           
     1608G "Alphabetic Tree" "binary search,data structures,dfs and similar,hashing,string suffix structures,strings,trees" "You are given m strings and a tree on n nodes. Each edge has some letter written on it.You have to answer q queries. Each query is described by 4 integers u, v, l and r. The answer to the query is the total number of occurrences of str(u,v) in strings with indices from l to r. str(u,v) is defined as the string that is made by concatenating letters written on the edges on the shortest path from u to v (in order that they are traversed)." 3500.0                                           
     1608E "The Cells on the Paper" "binary search,implementation,sortings" "On an endless checkered sheet of paper, n cells are chosen and colored in three colors, where n is divisible by 3. It turns out that there are exactly n3 marked cells of each of three colors! Find the largest such k that it\'s possible to choose k3 cells of each color, remove all other marked cells, and then select three rectangles with sides parallel to the grid lines so that the following conditions hold:  No two rectangles can intersect (but they can share a part of the boundary). In other words, the area of intersection of any two of these rectangles must be 0. The i-th rectangle contains all the chosen cells of the i-th color and no chosen cells of other colors, for i=1,2,3." 2800.0                                           
     1607E "Robot on the Board 1" implementation "The robot is located on a checkered rectangular board of size n\xc3\x97m (n rows, m columns). The rows in the board are numbered from 1 to n from top to bottom, and the columns \xe2\x80\x94 from 1 to m from left to right.The robot is able to move from the current cell to one of the four cells adjacent by side.The sequence of commands s executed by the robot is given. Each command is denoted by one of the symbols \'L\', \'R\', \'D\' or \'U\', and triggers the movement to left, right, down or up, respectively.The robot can start its movement in any cell. The robot executes the commands starting from the first one, strictly in the order in which they are listed in s. If the robot moves beyond the edge of the board, it falls and breaks. A command that causes the robot to break is not considered successfully executed.The robot\'s task is to execute as many commands as possible without falling off the board. For example, on board 3\xc3\x973, if the robot starts a sequence of actions s=""RRDLUU"" (""right"", ""right"", ""down"", ""left"", ""up"", ""up"") from the central cell, the robot will perform one command, then the next command will force him to cross the edge. If the robot starts moving from the cell (2,1) (second row, first column) then all commands will be executed successfully and the robot will stop at the cell (1,2) (first row, second column).  The robot starts from cell (2,1) (second row, first column). It moves right, right, down, left, up, and up. In this case it ends in the cell (1,2) (first row, second column). Determine the cell from which the robot should start its movement in order to execute as many commands as possible." 1600.0                                           
     1606C Banknotes "greedy,number theory" "In Berland, n different types of banknotes are used. Banknotes of the i-th type have denomination 10ai burles (burles are the currency used in Berland); the denomination of banknotes of the first type is exactly 1.Let\'s denote f(s) as the minimum number of banknotes required to represent exactly s burles. For example, if the denominations of banknotes used in Berland are 1, 10 and 100, then f(59)=14: 9 banknotes with denomination of 1 burle and 5 banknotes with denomination of 10 burles can be used to represent exactly 9\xe2\x8b\x851+5\xe2\x8b\x8510=59 burles, and there\'s no way to do it with fewer banknotes.For a given integer k, find the minimum positive number of burles s that cannot be represented with k or fewer banknotes (that is, f(s)>k)." 1400.0                                           
     1606A "AB Balance" strings "You are given a string s of length n consisting of characters a and/or b.Let AB(s) be the number of occurrences of string ab in s as a substring. Analogically, BA(s) is the number of occurrences of ba in s as a substring.In one step, you can choose any index i and replace si with character a or b.What is the minimum number of steps you need to make to achieve AB(s)=BA(s)?Reminder:The number of occurrences of string d in s as substring is the number of indices i (1\xe2\x89\xa4i\xe2\x89\xa4|s|\xe2\x88\x92|d|+1) such that substring sisi+1\xe2\x80\xa6si+|d|\xe2\x88\x921 is equal to d. For example, AB(aabbbabaa)=2 since there are two indices i: i=2 where aabbbabaa and i=6 where aabbbabaa." 900.0                                           
     1605C "Dominant Character" "brute force,greedy,implementation,strings" "Ashish has a string s of length n containing only characters \'a\', \'b\' and \'c\'.He wants to find the length of the smallest substring, which satisfies the following conditions:   Length of the substring is at least 2  \'a\' occurs strictly more times in this substring than \'b\'  \'a\' occurs strictly more times in this substring than \'c\'  Ashish is busy planning his next Codeforces round. Help him solve the problem.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end." 1400.0                                           
     1601E "Phys Ed Online" "data structures,dp,greedy" "Students of one unknown college don\'t have PE courses. That\'s why q of them decided to visit a gym nearby by themselves. The gym is open for n days and has a ticket system. At the i-th day, the cost of one ticket is equal to ai. You are free to buy more than one ticket per day.You can activate a ticket purchased at day i either at day i or any day later. Each activated ticket is valid only for k days. In other words, if you activate ticket at day t, it will be valid only at days t,t+1,\xe2\x80\xa6,t+k\xe2\x88\x921. You know that the j-th student wants to visit the gym at each day from lj to rj inclusive. Each student will use the following strategy of visiting the gym at any day i (lj\xe2\x89\xa4i\xe2\x89\xa4rj):  person comes to a desk selling tickets placed near the entrance and buy several tickets with cost ai apiece (possibly, zero tickets);  if the person has at least one activated and still valid ticket, they just go in. Otherwise, they activate one of tickets purchased today or earlier and go in. Note that each student will visit gym only starting lj, so each student has to buy at least one ticket at day lj.Help students to calculate the minimum amount of money they have to spend in order to go to the gym." 2900.0                                           
     1599H "Hidden Fortress" interactive,math "This is an interactive problem!As part of your contribution in the Great Bubble War, you have been tasked with finding the newly built enemy fortress. The world you live in is a giant 109\xc3\x97109 grid, with squares having both coordinates between 1 and 109. You know that the enemy base has the shape of a rectangle, with the sides parallel to the sides of the grid. The people of your world are extremely scared of being at the edge of the world, so you know that the base doesn\'t contain any of the squares on the edges of the grid (the x or y coordinate being 1 or 109). To help you locate the base, you have been given a device that you can place in any square of the grid, and it will tell you the manhattan distance to the closest square of the base. The manhattan distance from square (a,b) to square (p,q) is calculated as |a\xe2\x88\x92p|+|b\xe2\x88\x92q|. If you try to place the device inside the enemy base, you will be captured by the enemy. Because of this, you need to make sure to never place the device inside the enemy base. Unfortunately, the device is powered by a battery and you can\'t recharge it. This means that you can use the device at most 40 times." 2100.0                                           
     1599D "Bubble Popping"  "There are N bubbles in a coordinate plane. Bubbles are so tiny that it can be assumed that each bubble is a point (Xi,Yi). Q Bubble Cup finalists plan to play with the bubbles. Each finalist would link to use infinitely long Bubble Cup stick to pop some bubbles. The i-th finalist would like to place the stick in the direction of vector (dxi,dyi), and plays the following game until Ki bubbles are popped. The game starts with finalist placing the stick in the direction of vector (dxi,dyi), and sweeping it from the infinity to the left until it hits some bubble, which is immediately popped. It is guaranteed that only one bubble will be hit in this step. After that the finalist starts rotating the stick in the counter clockwise direction with the center of rotation in point where the previous bubble was popped. When the next bubble is hit, it is immediately popped and becomes the new center of rotation. The process continues until Ki bubbles have been popped. It is guaranteed that the stick won\'t hit two bubbles simultaneously in this process. For each finalist find which bubble would be popped the last. Note that each game starts with the configuration of all N bubbles, so the games don\'t depend on the previous games." 3200.0                                           
     1598G "The Sum of Good Numbers" "hashing,math,string suffix structures,strings" "Let\'s call a positive integer good if there is no digit 0 in its decimal representation.For an array of a good numbers a, one found out that the sum of some two neighboring elements is equal to x (i.e. x=ai+ai+1 for some i). x had turned out to be a good number as well.Then the elements of the array a were written out one after another without separators into one string s. For example, if a=[12,5,6,133], then s=1256133.You are given a string s and a number x. Your task is to determine the positions in the string that correspond to the adjacent elements of the array that have sum x. If there are several possible answers, you can print any of them." 3200.0                                           
     1598D "Training Session" "combinatorics,data structures,geometry,implementation,math" "Monocarp is the coach of the Berland State University programming teams. He decided to compose a problemset for a training session for his teams.Monocarp has n problems that none of his students have seen yet. The i-th problem has a topic ai (an integer from 1 to n) and a difficulty bi (an integer from 1 to n). All problems are different, that is, there are no two tasks that have the same topic and difficulty at the same time.Monocarp decided to select exactly 3 problems from n problems for the problemset. The problems should satisfy at least one of two conditions (possibly, both):  the topics of all three selected problems are different;  the difficulties of all three selected problems are different. Your task is to determine the number of ways to select three problems for the problemset." 1700.0                                           
     1594D "The Number of Imposters" "constructive algorithms,dfs and similar,dp,dsu,graphs" "Theofanis started playing the new online game called ""Among them"". However, he always plays with Cypriot players, and they all have the same name: ""Andreas"" (the most common name in Cyprus).In each game, Theofanis plays with n other players. Since they all have the same name, they are numbered from 1 to n.The players write m comments in the chat. A comment has the structure of ""i j c"" where i and j are two distinct integers and c is a string (1\xe2\x89\xa4i,j\xe2\x89\xa4n; i\xe2\x89\xa0j; c is either imposter or crewmate). The comment means that player i said that player j has the role c.An imposter always lies, and a crewmate always tells the truth. Help Theofanis find the maximum possible number of imposters among all the other Cypriot players, or determine that the comments contradict each other (see the notes for further explanation).Note that each player has exactly one role: either imposter or crewmate." 1700.0                                           
     1592C "Bakry and Partitioning" "bitmasks,constructive algorithms,dfs and similar,dp,graphs,trees" "Bakry faced a problem, but since he\'s lazy to solve it, he asks for your help.You are given a tree of n nodes, the i-th node has value ai assigned to it for each i from 1 to n. As a reminder, a tree on n nodes is a connected graph with n\xe2\x88\x921 edges.You want to delete at least 1, but at most k\xe2\x88\x921 edges from the tree, so that the following condition would hold:For every connected component calculate the bitwise XOR of the values of the nodes in it. Then, these values have to be the same for all connected components.Is it possible to achieve this condition?" 1700.0                                           
     1584F "Strange LCS" bitmasks,dp,graphs,greedy,strings "You are given n strings s1,s2,\xe2\x80\xa6,sn, each consisting of lowercase and uppercase English letters. In addition, it\'s guaranteed that each character occurs in each string at most twice. Find the longest common subsequence of these strings.A string t is a subsequence of a string s if t can be obtained from s by deletion of several (possibly, zero or all) symbols." 2600.0                                           
     1581B "Diameter of Graph" "constructive algorithms,graphs,greedy,math" "CQXYM wants to create a connected undirected graph with n nodes and m edges, and the diameter of the graph must be strictly less than k\xe2\x88\x921. Also, CQXYM doesn\'t want a graph that contains self-loops or multiple edges (i.e. each edge connects two different vertices and between each pair of vertices there is at most one edge).The diameter of a graph is the maximum distance between any two nodes.The distance between two nodes is the minimum number of the edges on the path which endpoints are the two nodes.CQXYM wonders whether it is possible to create such a graph." 1200.0                                           
     1580D Subsequence "brute force,divide and conquer,dp,greedy,trees" "Alice has an integer sequence a of length n and all elements are different. She will choose a subsequence of a of length m, and defines the value of a subsequence ab1,ab2,\xe2\x80\xa6,abm as m\xe2\x88\x91i=1(m\xe2\x8b\x85abi)\xe2\x88\x92m\xe2\x88\x91i=1m\xe2\x88\x91j=1f(min(bi,bj),max(bi,bj)), where f(i,j) denotes min(ai,ai+1,\xe2\x80\xa6,aj).Alice wants you to help her to maximize the value of the subsequence she choose.A sequence s is a subsequence of a sequence t if s can be obtained from t by deletion of several (possibly, zero or all) elements." 2900.0                                           
     1578L Labyrinth "binary search,dsu,greedy" "In a dream, Lucy found herself in a labyrinth. This labyrinth consists of n rooms, connected by m passages (i-th passage is wi cm wide). Each passage can be traversed in both directions. It is guaranteed that it is possible to get from any room to any other room. But this is not an ordinary labyrinth \xe2\x80\x94 each room in this labyrinth contains a magic candy. When Lucy eats this magic candy, she is getting wider. Specifically, if she eats candy from room i she becomes wider by ci cm. Note that she is not obliged to eat candy the first time she visits a particular room, but she can eat each candy only once. Unfortunately, passages in this labyrinth are pretty narrow, so after eating some candy, Lucy can get too wide and will not be able to traverse them \xe2\x80\x94 her width should not be greater than the width of the corresponding passage.Lucy starts her journey in a room number 1. She wants to eat all the candies. After that, she will just wake up, so she does not have to be able to return to the room 1. She realizes that with her current width, she may not be able to do so, so she plans a workout before embarking on her journey. Lucy wants to know if it is possible to start with some positive width and still eat all the candies. If yes, then what is the maximal starting width with which it is possible." 2400.0                                           
     1578I "Interactive Rays" geometry,interactive "This is an interactive problem.Your goal is to find a circle on a plane by shooting rays and getting the distance to the circle as a result. Interactor has three hidden integer parameters that are determined in advance for each test, but which you don\'t know \xe2\x80\x94 xc, yc, and rc. (xc,yc) are coordinates of the circle\'s center and rc is its radius. The absolute values of xc, yc, and rc do not exceed 105, and 1\xe2\x89\xa4rc\xe2\x89\xa4\xe2\x88\x9ax2c+y2c\xe2\x88\x921.You can shoot rays that extend from the origin (0,0) and go via a point (xq,yq) with the integer coordinates you specify. For each ray, you get a distance from the ray to the circle or 0 if the ray intersects the circle." 3300.0                                           
     1578B "Building Forest Trails" "data structures,dsu" "There are n villages lying equidistant on a circle in the middle of a thick, impassable forest. From ancient times, it was impossible to move from one village to another, but technical progress has changed a lot. Now, there is a technology to build passable trails in the forest. The building process consists of m events. Each event is either building a trail or querying if two villages are connected. Trails are built as straight lines connecting two villages. After a trail is built, anybody can walk along the trail from one village to another. Moreover, if two trails cross, anybody can turn at the intersection, and if other trails leave a village you have just reached, they can also be used to walk along. So, for example, if villages are numbered 1 to 6 in the order around the circle, and there are trails 1 to 3, 2 to 4, and 4 to 6, then all villages, except the 5-th, are reachable from the 1-st village.Given a list of m events, for each query, find if two given villages are reachable from each other at that moment." 2800.0                                           
     1575M "Managing Telephone Poles" "data structures,geometry" "Mr. Chanek\'s city can be represented as a plane. He wants to build a housing complex in the city.There are some telephone poles on the plane, which is represented by a grid a of size (n+1)\xc3\x97(m+1). There is a telephone pole at (x,y) if ax,y=1.For each point (x,y), define S(x,y) as the square of the Euclidean distance between the nearest pole and (x,y). Formally, the square of the Euclidean distance between two points (x1,y1) and (x2,y2) is (x2\xe2\x88\x92x1)2+(y2\xe2\x88\x92y1)2.To optimize the building plan, the project supervisor asks you the sum of all S(x,y) for each 0\xe2\x89\xa4x\xe2\x89\xa4n and 0\xe2\x89\xa4y\xe2\x89\xa4m. Help him by finding the value of \xe2\x88\x91nx=0\xe2\x88\x91my=0S(x,y)." 2400.0                                           
     1574C "Slay the Dragon" "binary search,greedy,sortings,ternary search" "Recently, Petya learned about a new game ""Slay the Dragon"". As the name suggests, the player will have to fight with dragons. To defeat a dragon, you have to kill it and defend your castle. To do this, the player has a squad of n heroes, the strength of the i-th hero is equal to ai.According to the rules of the game, exactly one hero should go kill the dragon, all the others will defend the castle. If the dragon\'s defense is equal to x, then you have to send a hero with a strength of at least x to kill it. If the dragon\'s attack power is y, then the total strength of the heroes defending the castle should be at least y.The player can increase the strength of any hero by 1 for one gold coin. This operation can be done any number of times.There are m dragons in the game, the i-th of them has defense equal to xi and attack power equal to yi. Petya was wondering what is the minimum number of coins he needs to spend to defeat the i-th dragon.Note that the task is solved independently for each dragon (improvements are not saved)." 1300.0                                           
     1572D "Bridge Club" "flows,graph matchings,graphs,greedy" "There are currently n hot topics numbered from 0 to n\xe2\x88\x921 at your local bridge club and 2n players numbered from 0 to 2n\xe2\x88\x921. Each player holds a different set of views on those n topics, more specifically, the i-th player holds a positive view on the j-th topic if i & 2j>0, and a negative view otherwise. Here & denotes the bitwise AND operation.You are going to organize a bridge tournament capable of accommodating at most k pairs of players (bridge is played in teams of two people). You can select teams arbitrarily while each player is in at most one team, but there is one catch: two players cannot be in the same pair if they disagree on 2 or more of those n topics, as they would argue too much during the play.You know that the i-th player will pay you ai dollars if they play in this tournament. Compute the maximum amount of money that you can earn if you pair the players in your club optimally." 2800.0                                           
     1572C Paint dp,greedy "You are given a 1 by n pixel image. The i-th pixel of the image has color ai. For each color, the number of pixels of that color is at most 20.You can perform the following operation, which works like the bucket tool in paint programs, on this image:   pick a color \xe2\x80\x94 an integer from 1 to n;  choose a pixel in the image;  for all pixels connected to the selected pixel, change their colors to the selected color (two pixels of the same color are considered connected if all the pixels between them have the same color as those two pixels). Compute the minimum number of operations needed to make all the pixels in the image have the same color." 2700.0                                           
     1572B "Xor of 3" "brute force,constructive algorithms,greedy,two pointers" "You are given a sequence a of length n consisting of 0s and 1s.You can perform the following operation on this sequence:   Pick an index i from 1 to n\xe2\x88\x922 (inclusive).  Change all of ai, ai+1, ai+2 to ai\xe2\x8a\x95ai+1\xe2\x8a\x95ai+2 simultaneously, where \xe2\x8a\x95 denotes the bitwise XOR operation  Find a sequence of at most n operations that changes all elements of a to 0s or report that it\'s impossible.We can prove that if there exists a sequence of operations of any length that changes all elements of a to 0s, then there is also such a sequence of length not greater than n." 2500.0                                           
     1571I "Physical Examination" "*special problem,binary search,data structures" "Polycarp plans to undergo a full physical examination at his local clinic. There are n doctors, numbered from 1 to n. The i-th doctor takes patients from minute Li to minute Ri, so Polycarp can visit him at any minute in this range. It takes each doctor exactly one minute to examine Polycarp\'s health.Polycarp wants to arrive at the clinic at some minute x and visit all n doctors in some order without waiting or visiting any doctor several times.More formally, he chooses an integer x and a permutation p1,p2,\xe2\x80\xa6,pn (a sequence of n integers from 1 to n such that each integer appears exactly once), then proceeds to visit:   doctor p1 at minute x;  doctor p2 at minute x+1;  ...  doctor pn at minute x+n\xe2\x88\x921. The pi-th doctor should be able to take patients at minute x+i\xe2\x88\x921, so the following should hold: L[pi]\xe2\x89\xa4x+i\xe2\x88\x921\xe2\x89\xa4R[pi].Determine if it\'s possible for Polycarp to choose such a minute x and a permutation p that he\'ll be able to visit all n doctors in without waiting or visiting any doctor several times. If there are multiple answers, print any of them." 3200.0                                           
     1569F "Palindromic Hamiltonian Path" "brute force,dfs and similar,dp,graphs,hashing" "You are given a simple undirected graph with n vertices, n is even. You are going to write a letter on each vertex. Each letter should be one of the first k letters of the Latin alphabet.A path in the graph is called Hamiltonian if it visits each vertex exactly once. A string is called palindromic if it reads the same from left to right and from right to left. A path in the graph is called palindromic if the letters on the vertices in it spell a palindromic string without changing the order.A string of length n is good if:   each letter is one of the first k lowercase Latin letters;  if you write the i-th letter of the string on the i-th vertex of the graph, there will exist a palindromic Hamiltonian path in the graph. Note that the path doesn\'t necesserily go through the vertices in order 1,2,\xe2\x80\xa6,n.Count the number of good strings." 3000.0                                           
     1567E "Non-Decreasing Dilemma" "data structures,divide and conquer,math" "Alice has recently received an array a1,a2,\xe2\x80\xa6,an for her birthday! She is very proud of her array, and when she showed her friend Bob the array, he was very happy with her present too!However, soon Bob became curious, and as any sane friend would do, asked Alice to perform q operations of two types on her array:  1 x y: update the element ax to y (set ax=y).  2 l r: calculate how many non-decreasing subarrays exist within the subarray [al,al+1,\xe2\x80\xa6,ar]. More formally, count the number of pairs of integers (p,q) such that l\xe2\x89\xa4p\xe2\x89\xa4q\xe2\x89\xa4r and ap\xe2\x89\xa4ap+1\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4aq\xe2\x88\x921\xe2\x89\xa4aq. Help Alice answer Bob\'s queries!" 2200.0                                           
     1567C "Carrying Conundrum" bitmasks,combinatorics,dp,math "Alice has just learned addition. However, she hasn\'t learned the concept of ""carrying"" fully \xe2\x80\x94 instead of carrying to the next column, she carries to the column two columns to the left.For example, the regular way to evaluate the sum 2039+2976 would be as shown:   However, Alice evaluates it as shown:   In particular, this is what she does:   add 9 and 6 to make 15, and carry the 1 to the column two columns to the left, i. e. to the column ""0 9"";  add 3 and 7 to make 10 and carry the 1 to the column two columns to the left, i. e. to the column ""2 2"";  add 1, 0, and 9 to make 10 and carry the 1 to the column two columns to the left, i. e. to the column above the plus sign;  add 1, 2 and 2 to make 5;  add 1 to make 1.  Thus, she ends up with the incorrect result of 15005.Alice comes up to Bob and says that she has added two numbers to get a result of n. However, Bob knows that Alice adds in her own way. Help Bob find the number of ordered pairs of positive integers such that when Alice adds them, she will get a result of n. Note that pairs (a,b) and (b,a) are considered different if a\xe2\x89\xa0b." 1600.0                                           
     1566G "Four Vertices" "constructive algorithms,data structures,graphs,greedy,implementation,shortest paths" "You are given an undirected weighted graph, consisting of n vertices and m edges.Some queries happen with this graph:  Delete an existing edge from the graph.  Add a non-existing edge to the graph. At the beginning and after each query, you should find four different vertices a, b, c, d such that there exists a path between a and b, there exists a path between c and d, and the sum of lengths of two shortest paths from a to b and from c to d is minimal. The answer to the query is the sum of the lengths of these two shortest paths. The length of the path is equal to the sum of weights of edges in this path." 3100.0                                           
     1562B "Scenes From a Memory" "brute force,constructive algorithms,implementation,math,number theory" "During the hypnosis session, Nicholas suddenly remembered a positive integer n, which doesn\'t contain zeros in decimal notation. Soon, when he returned home, he got curious: what is the maximum number of digits that can be removed from the number so that the number becomes not prime, that is, either composite or equal to one?For some numbers doing so is impossible: for example, for number 53 it\'s impossible to delete some of its digits to obtain a not prime integer. However, for all n in the test cases of this problem, it\'s guaranteed that it\'s possible to delete some of their digits to obtain a not prime number.Note that you cannot remove all the digits from the number.A prime number is a number that has no divisors except one and itself. A composite is a number that has more than two divisors. 1 is neither a prime nor a composite number." 1000.0                                           
     1558F "Strange Sort" "data structures,sortings" "You have a permutation: an array a=[a1,a2,\xe2\x80\xa6,an] of distinct integers from 1 to n. The length of the permutation n is odd.Consider the following algorithm of sorting the permutation in increasing order.A helper procedure of the algorithm, f(i), takes a single argument i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) and does the following. If ai>ai+1, the values of ai and ai+1 are exchanged. Otherwise, the permutation doesn\'t change.The algorithm consists of iterations, numbered with consecutive integers starting with 1. On the i-th iteration, the algorithm does the following:   if i is odd, call f(1),f(3),\xe2\x80\xa6,f(n\xe2\x88\x922);  if i is even, call f(2),f(4),\xe2\x80\xa6,f(n\xe2\x88\x921). It can be proven that after a finite number of iterations the permutation will be sorted in increasing order.After how many iterations will this happen for the first time?" 3300.0                                           
     1558C "Bottom-Tier Reversals" "constructive algorithms,greedy" "You have a permutation: an array a=[a1,a2,\xe2\x80\xa6,an] of distinct integers from 1 to n. The length of the permutation n is odd.You need to sort the permutation in increasing order.In one step, you can choose any prefix of the permutation with an odd length and reverse it. Formally, if a=[a1,a2,\xe2\x80\xa6,an], you can choose any odd integer p between 1 and n, inclusive, and set a to [ap,ap\xe2\x88\x921,\xe2\x80\xa6,a1,ap+1,ap+2,\xe2\x80\xa6,an].Find a way to sort a using no more than 5n2 reversals of the above kind, or determine that such a way doesn\'t exist. The number of reversals doesn\'t have to be minimized." 2000.0                                           
     1556H "DIY Tree" graphs,greedy,math,probabilities "William really likes puzzle kits. For one of his birthdays, his friends gifted him a complete undirected edge-weighted graph consisting of n vertices.He wants to build a spanning tree of this graph, such that for the first k vertices the following condition is satisfied: the degree of a vertex with index i does not exceed di. Vertices from k+1 to n may have any degree.William wants you to find the minimum weight of a spanning tree that satisfies all the conditions.A spanning tree is a subset of edges of a graph that forms a tree on all n vertices of the graph. The weight of a spanning tree is defined as the sum of weights of all the edges included in a spanning tree." 3300.0                                           
     1554A Cherry greedy "You are given n integers a1,a2,\xe2\x80\xa6,an. Find the maximum value of max(al,al+1,\xe2\x80\xa6,ar)\xe2\x8b\x85min(al,al+1,\xe2\x80\xa6,ar) over all pairs (l,r) of integers for which 1\xe2\x89\xa4l<r\xe2\x89\xa4n." 800.0                                           
     1550E Stringforces "binary search,bitmasks,brute force,dp,strings,two pointers" "You are given a string s of length n. Each character is either one of the first k lowercase Latin letters or a question mark.You are asked to replace every question mark with one of the first k lowercase Latin letters in such a way that the following value is maximized.Let fi be the maximum length substring of string s, which consists entirely of the i-th Latin letter. A substring of a string is a contiguous subsequence of that string. If the i-th letter doesn\'t appear in a string, then fi is equal to 0.The value of a string s is the minimum value among fi for all i from 1 to k.What is the maximum value the string can have?" 2500.0                                           
     1550C "Manhattan Subarrays" "brute force,geometry,greedy,implementation" "Suppose you have two points p=(xp,yp) and q=(xq,yq). Let\'s denote the Manhattan distance between them as d(p,q)=|xp\xe2\x88\x92xq|+|yp\xe2\x88\x92yq|.Let\'s say that three points p, q, r form a bad triple if d(p,r)=d(p,q)+d(q,r).Let\'s say that an array b1,b2,\xe2\x80\xa6,bm is good if it is impossible to choose three distinct indices i, j, k such that the points (bi,i), (bj,j) and (bk,k) form a bad triple.You are given an array a1,a2,\xe2\x80\xa6,an. Calculate the number of good subarrays of a. A subarray of the array a is the array al,al+1,\xe2\x80\xa6,ar for some 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n.Note that, according to the definition, subarrays of length 1 and 2 are good." 1700.0                                           
     1547D "Co-growing Sequence" "bitmasks,constructive algorithms,greedy" "A sequence of non-negative integers a1,a2,\xe2\x80\xa6,an is called growing if for all i from 1 to n\xe2\x88\x921 all ones (of binary representation) in ai are in the places of ones (of binary representation) in ai+1 (in other words, ai&ai+1=ai, where & denotes bitwise AND). If n=1 then the sequence is considered growing as well.For example, the following four sequences are growing:   [2,3,15,175] \xe2\x80\x94 in binary it\'s [102,112,11112,101011112];  [5] \xe2\x80\x94 in binary it\'s [1012];  [1,3,7,15] \xe2\x80\x94 in binary it\'s [12,112,1112,11112];  [0,0,0] \xe2\x80\x94 in binary it\'s [02,02,02]. The following three sequences are non-growing:   [3,4,5] \xe2\x80\x94 in binary it\'s [112,1002,1012];  [5,4,3] \xe2\x80\x94 in binary it\'s [1012,1002,0112];  [1,2,4,8] \xe2\x80\x94 in binary it\'s [00012,00102,01002,10002]. Consider two sequences of non-negative integers x1,x2,\xe2\x80\xa6,xn and y1,y2,\xe2\x80\xa6,yn. Let\'s call this pair of sequences co-growing if the sequence x1\xe2\x8a\x95y1,x2\xe2\x8a\x95y2,\xe2\x80\xa6,xn\xe2\x8a\x95yn is growing where \xe2\x8a\x95 denotes bitwise XOR.You are given a sequence of integers x1,x2,\xe2\x80\xa6,xn. Find the lexicographically minimal sequence y1,y2,\xe2\x80\xa6,yn such that sequences xi and yi are co-growing.The sequence a1,a2,\xe2\x80\xa6,an is lexicographically smaller than the sequence b1,b2,\xe2\x80\xa6,bn if there exists 1\xe2\x89\xa4k\xe2\x89\xa4n such that ai=bi for any 1\xe2\x89\xa4i<k but ak<bk." 1300.0                                           
     1547B "Alphabetical Strings" greedy,implementation,strings "A string s of length n (1\xe2\x89\xa4n\xe2\x89\xa426) is called alphabetical if it can be obtained using the following algorithm:  first, write an empty string to s (i.e. perform the assignment s := """");  then perform the next step n times;  at the i-th step take i-th lowercase letter of the Latin alphabet and write it either to the left of the string s or to the right of the string s (i.e. perform the assignment s := c+s or s := s+c, where c is the i-th letter of the Latin alphabet). In other words, iterate over the n first letters of the Latin alphabet starting from \'a\' and etc. Each time we prepend a letter to the left of the string s or append a letter to the right of the string s. Strings that can be obtained in that way are alphabetical.For example, the following strings are alphabetical: ""a"", ""ba"", ""ab"", ""bac"" and ""ihfcbadeg"". The following strings are not alphabetical: ""z"", ""aa"", ""ca"", ""acb"", ""xyz"" and ""ddcba"".From the given string, determine if it is alphabetical." 800.0                                           
     1545D "AquaMoon and Wrong Coordinate" "constructive algorithms,interactive,math" "Cirno gives AquaMoon a problem. There are m people numbered from 0 to m\xe2\x88\x921. They are standing on a coordinate axis in points with positive integer coordinates. They are facing right (i.e. in the direction of the coordinate increase). At this moment everyone will start running with the constant speed in the direction of coordinate increasing. The initial coordinate of the i-th person on the line is xi, and the speed of the i-th person is vi. So the coordinate of the i-th person at the moment t will be xi+t\xe2\x8b\x85vi.Cirno captured the coordinates of m people in k consecutive integer moments from 0 to k\xe2\x88\x921. In every moment, the coordinates of m people were recorded in arbitrary order.To make the problem more funny, Cirno modified one coordinate at the moment y (0<y<k\xe2\x88\x921) to a different integer.AquaMoon wants to find the moment y and the original coordinate p before the modification. Actually, she is not a programmer at all. So she wasn\'t able to solve it. Can you help her?" 3000.0                                           
     1542A "Odd Set" math "You are given a multiset (i. e. a set that can contain multiple equal integers) containing 2n integers. Determine if you can split it into exactly n pairs (i. e. each element should be in exactly one pair) so that the sum of the two elements in each pair is odd (i. e. when divided by 2, the remainder is 1)." 800.0                                           
     1538E "Funny Substrings" "data structures,hashing,implementation,matrices,strings" "Polycarp came up with a new programming language. There are only two types of statements in it:   ""x := s"": assign the variable named x the value s (where s is a string). For example, the statement var := hello assigns the variable named var the value hello. Note that s is the value of a string, not the name of a variable. Between the variable name, the := operator and the string contains exactly one space each. ""x = a + b"": assign the variable named x the concatenation of values of two variables a and b. For example, if the program consists of three statements a := hello, b := world, c = a + b, then the variable c will contain the string helloworld. It is guaranteed that the program is correct and the variables a and b were previously defined. There is exactly one space between the variable names and the = and + operators. All variable names and strings only consist of lowercase letters of the English alphabet and do not exceed 5 characters.The result of the program is the number of occurrences of string haha in the string that was written to the variable in the last statement.Polycarp was very tired while inventing that language. He asks you to implement it. Your task is \xe2\x80\x94 for given program statements calculate the number of occurrences of string haha in the last assigned variable." 2100.0                                           
     1536D "Omkar and Medians" "data structures,greedy,implementation" "Uh oh! Ray lost his array yet again! However, Omkar might be able to help because he thinks he has found the OmkArray of Ray\'s array. The OmkArray of an array a with elements a1,a2,\xe2\x80\xa6,a2k\xe2\x88\x921, is the array b with elements b1,b2,\xe2\x80\xa6,bk such that bi is equal to the median of a1,a2,\xe2\x80\xa6,a2i\xe2\x88\x921 for all i. Omkar has found an array b of size n (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105, \xe2\x88\x92109\xe2\x89\xa4bi\xe2\x89\xa4109). Given this array b, Ray wants to test Omkar\'s claim and see if b actually is an OmkArray of some array a. Can you help Ray?The median of a set of numbers a1,a2,\xe2\x80\xa6,a2i\xe2\x88\x921 is the number ci where c1,c2,\xe2\x80\xa6,c2i\xe2\x88\x921 represents a1,a2,\xe2\x80\xa6,a2i\xe2\x88\x921 sorted in nondecreasing order." 2000.0                                           
     1534D "Lost Tree" "constructive algorithms,interactive,trees" "This is an interactive problem.Little Dormi was faced with an awkward problem at the carnival: he has to guess the edges of an unweighted tree of n nodes! The nodes of the tree are numbered from 1 to n.The game master only allows him to ask one type of question: Little Dormi picks a node r (1\xe2\x89\xa4r\xe2\x89\xa4n), and the game master will reply with an array d1,d2,\xe2\x80\xa6,dn, where di is the length of the shortest path from node r to i, for all 1\xe2\x89\xa4i\xe2\x89\xa4n.Additionally, to make the game unfair challenge Little Dormi the game master will allow at most \xe2\x8c\x88n2\xe2\x8c\x89 questions, where \xe2\x8c\x88x\xe2\x8c\x89 denotes the smallest integer greater than or equal to x.Faced with the stomach-churning possibility of not being able to guess the tree, Little Dormi needs your help to devise a winning strategy!Note that the game master creates the tree before the game starts, and does not change it during the game." 1800.0                                           
     1532F "Prefixes and Suffixes" "*special problem,strings" "Ivan wants to play a game with you. He picked some string s of length n consisting only of lowercase Latin letters. You don\'t know this string. Ivan has informed you about all its improper prefixes and suffixes (i.e. prefixes and suffixes of lengths from 1 to n\xe2\x88\x921), but he didn\'t tell you which strings are prefixes and which are suffixes.Ivan wants you to guess which of the given 2n\xe2\x88\x922 strings are prefixes of the given string and which are suffixes. It may be impossible to guess the string Ivan picked (since multiple strings may give the same set of suffixes and prefixes), but Ivan will accept your answer if there is at least one string that is consistent with it. Let the game begin!" -999.0                                           
     1531E3 "\xd0\xa1\xd0\xbe\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb8\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc" "*special problem,binary search" "\xd0\xa0\xd0\xb0\xd1\x81\xd1\x81\xd0\xbc\xd0\xbe\xd1\x82\xd1\x80\xd0\xb8\xd0\xbc \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xb4 \xd1\x81\xd0\xbe\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb8 \xd1\x81\xd0\xbb\xd0\xb8\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbd\xd0\xb0 \xd1\x8f\xd0\xb7\xd1\x8b\xd0\xba\xd0\xb5 Python: def sort(a):  n = len(a)  b = [0 for i in range(n)]  log = []  def mergeSort(l, r):    if r - l <= 1:      return    m = (l + r) >> 1    mergeSort(l, m)    mergeSort(m, r)    i, j, k = l, m, l    while i < m and j < r:      if a[i] < a[j]:        log.append(\'0\')        b[k] = a[i]        i += 1      else:        log.append(\'1\')        b[k] = a[j]        j += 1      k += 1    while i < m:      b[k] = a[i]      i += 1      k += 1    while j < r:      b[k] = a[j]      j += 1      k += 1    for p in range(l, r):      a[p] = b[p]  mergeSort(0, n)  return """".join(log)\xd0\x9a\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbc\xd0\xb5\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x8d\xd1\x82\xd0\xbe\xd1\x82 \xd0\xba\xd0\xbe\xd0\xb4 \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd0\xb5\xd1\x82 \xd0\xbb\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5 \xe2\x80\x94 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xb5\xd0\xb9\xd1\x88\xd0\xb8\xd0\xb9 \xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd1\x80\xd1\x83\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd0\xb8.\xd0\xa1\xd1\x82\xd0\xb0\xd1\x80\xd1\x88\xd0\xb8\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x87\xd0\xb8\xd0\xba \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd1\x81\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbb \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 a (\xd0\xbc\xd0\xb0\xd1\x81\xd1\x81\xd0\xb8\xd0\xb2 \xd0\xb8\xd0\xb7 n \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe n), \xd0\xb4\xd0\xb0\xd0\xbb \xd0\xb5\xd1\x91 \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x85\xd0\xbe\xd0\xb4 \xd1\x84\xd1\x83\xd0\xbd\xd0\xba\xd1\x86\xd0\xb8\xd0\xb8 sort \xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb8\xd0\xbb \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x8b\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb5 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s. \xd0\x9d\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0\xd1\x88\xd1\x91\xd0\xbb, \xd0\xb0 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb0 a \xd0\xbf\xd0\xbe\xd1\x82\xd0\xb5\xd1\x80\xd1\x8f\xd0\xbb\xd0\xb0\xd1\x81\xd1\x8c. \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x83\xd1\x8e \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 a \xd1\x82\xd0\xb0\xd0\xba\xd1\x83\xd1\x8e, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xb7\xd0\xbe\xd0\xb2 \xd1\x84\xd1\x83\xd0\xbd\xd0\xba\xd1\x86\xd0\xb8\xd0\xb8 sort \xd0\xbe\xd1\x82 \xd0\xbd\xd0\xb5\xd1\x91 \xd0\xb4\xd0\xb0\xd1\x81\xd1\x82 \xd1\x82\xd1\x83 \xd0\xb6\xd0\xb5 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s. \xd0\x9f\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb5\xd0\xbc\xd1\x83!" -999.0                                           
     1531E1 "\xd0\xa1\xd0\xbe\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb8\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc" "*special problem" "\xd0\xa0\xd0\xb0\xd1\x81\xd1\x81\xd0\xbc\xd0\xbe\xd1\x82\xd1\x80\xd0\xb8\xd0\xbc \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xb4 \xd1\x81\xd0\xbe\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb8 \xd1\x81\xd0\xbb\xd0\xb8\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbd\xd0\xb0 \xd1\x8f\xd0\xb7\xd1\x8b\xd0\xba\xd0\xb5 Python: def sort(a):  n = len(a)  b = [0 for i in range(n)]  log = []  def mergeSort(l, r):    if r - l <= 1:      return    m = (l + r) >> 1    mergeSort(l, m)    mergeSort(m, r)    i, j, k = l, m, l    while i < m and j < r:      if a[i] < a[j]:        log.append(\'0\')        b[k] = a[i]        i += 1      else:        log.append(\'1\')        b[k] = a[j]        j += 1      k += 1    while i < m:      b[k] = a[i]      i += 1      k += 1    while j < r:      b[k] = a[j]      j += 1      k += 1    for p in range(l, r):      a[p] = b[p]  mergeSort(0, n)  return """".join(log)\xd0\x9a\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbc\xd0\xb5\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x8d\xd1\x82\xd0\xbe\xd1\x82 \xd0\xba\xd0\xbe\xd0\xb4 \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd0\xb5\xd1\x82 \xd0\xbb\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5 \xe2\x80\x94 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xb5\xd0\xb9\xd1\x88\xd0\xb8\xd0\xb9 \xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd1\x80\xd1\x83\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd0\xb8.\xd0\xa1\xd1\x82\xd0\xb0\xd1\x80\xd1\x88\xd0\xb8\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x87\xd0\xb8\xd0\xba \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd1\x81\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbb \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 a (\xd0\xbc\xd0\xb0\xd1\x81\xd1\x81\xd0\xb8\xd0\xb2 \xd0\xb8\xd0\xb7 n \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe n), \xd0\xb4\xd0\xb0\xd0\xbb \xd0\xb5\xd1\x91 \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x85\xd0\xbe\xd0\xb4 \xd1\x84\xd1\x83\xd0\xbd\xd0\xba\xd1\x86\xd0\xb8\xd0\xb8 sort \xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb8\xd0\xbb \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x8b\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb5 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s. \xd0\x9d\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0\xd1\x88\xd1\x91\xd0\xbb, \xd0\xb0 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb0 a \xd0\xbf\xd0\xbe\xd1\x82\xd0\xb5\xd1\x80\xd1\x8f\xd0\xbb\xd0\xb0\xd1\x81\xd1\x8c. \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x83\xd1\x8e \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 a \xd1\x82\xd0\xb0\xd0\xba\xd1\x83\xd1\x8e, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xb7\xd0\xbe\xd0\xb2 \xd1\x84\xd1\x83\xd0\xbd\xd0\xba\xd1\x86\xd0\xb8\xd0\xb8 sort \xd0\xbe\xd1\x82 \xd0\xbd\xd0\xb5\xd1\x91 \xd0\xb4\xd0\xb0\xd1\x81\xd1\x82 \xd1\x82\xd1\x83 \xd0\xb6\xd0\xb5 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s. \xd0\x9f\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb5\xd0\xbc\xd1\x83!" -999.0                                           
     1531C "\xd0\xa1\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80" "*special problem,constructive algorithms,dp" "\xd0\x92\xd1\x81\xd0\xb5 \xd0\xb3\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb2\xd1\x8f\xd1\x82\xd1\x81\xd1\x8f \xd0\xba VK Fest 2021! \xd0\x94\xd0\xbb\xd1\x8f \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb7\xd1\x80\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f\xd0\xbc \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xb0 \xd0\xbb\xd1\x83\xd1\x87\xd1\x88\xd0\xb5 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xbd\xd0\xb0 \xd0\xb3\xd0\xbb\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x86\xd0\xb5\xd0\xbd\xd0\xb0, \xd0\xbf\xd0\xbb\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80. \xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb5 \xd0\xbc\xd1\x8b \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd0\xbc \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd0\xbc\xd0\xb0\xd1\x82\xd1\x80\xd0\xb8\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x81\xd0\xb1\xd0\xbe\xd0\xba\xd1\x83 \xe2\x80\x94 \xd1\x81\xd1\x85\xd0\xb5\xd0\xbc\xd0\xb0\xd1\x82\xd0\xb8\xd1\x87\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xbd \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xbc\xd0\xb5\xd1\x82\xd1\x8c \xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd1\x83 \xd0\xbb\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd1\x8b \xd0\xb8\xd0\xb7 nn \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb2\xd1\x8b\xd1\x85 \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2. \xd0\x9b\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd0\xb0 \xe2\x80\x94 \xd1\x8d\xd1\x82\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xb1\xd0\xb0\xd1\x88\xd0\xb5\xd0\xbd \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2, \xd0\xb2\xd1\x8b\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2 \xd1\x80\xd1\x8f\xd0\xb4, \xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x8b \xd0\xb1\xd0\xb0\xd1\x88\xd0\xb5\xd0\xbd \xd0\xbd\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb7\xd1\x80\xd0\xb0\xd1\x81\xd1\x82\xd0\xb0\xd1\x8e\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe.\xd0\x9d\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb5\xd0\xbc \xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xbd\xd0\xba\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xb5\xd1\x82\xd1\x8c \xd1\x82\xd1\x80\xd0\xb8 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd1\x8b\xd0\xb5 \xd1\x84\xd0\xb8\xd0\xb3\xd1\x83\xd1\x80\xd1\x8b \xd0\xb8\xd0\xb7 1212 \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2. \xd0\x9f\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xb2\xd0\xb5 \xd1\x84\xd0\xb8\xd0\xb3\xd1\x83\xd1\x80\xd1\x8b \xe2\x80\x94 \xd0\xbb\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd1\x8b, \xd0\xb0 \xd1\x82\xd1\x80\xd0\xb5\xd1\x82\xd1\x8c\xd1\x8f \xe2\x80\x94 \xd0\xbd\xd0\xb5\xd1\x82.  \xd0\x98\xd0\xb7 \xd1\x8d\xd1\x81\xd1\x82\xd0\xb5\xd1\x82\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd0\xba\xd0\xb8\xd1\x85 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9 \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xbe \xd1\x80\xd0\xb5\xd1\x88\xd0\xb5\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd1\x81\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xbc. \xd0\xa4\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe, \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80 \xd0\xbd\xd0\xb0\xd0\xb7\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x81\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xbc, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xbe\xd1\x82\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x81\xd1\x85\xd0\xb5\xd0\xbc\xd1\x8b \xd0\xbe\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd0\xb9 x=yx=y \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x82\xd0\xbe\xd1\x82 \xd0\xb6\xd0\xb5 \xd1\x81\xd0\xb0\xd0\xbc\xd1\x8b\xd0\xb9 \xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xbd\xd0\xbe\xd0\xba (\xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xbe\xd1\x81\xd1\x8c xx \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe, \xd0\xb0 \xd0\xbe\xd1\x81\xd1\x8c yy \xe2\x80\x94 \xd1\x81\xd0\xbd\xd0\xb8\xd0\xb7\xd1\x83 \xd0\xb2\xd0\xb2\xd0\xb5\xd1\x80\xd1\x85). \xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb0\xd1\x8f \xd0\xbb\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd0\xb0 \xd0\xbd\xd0\xb0 \xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xbd\xd0\xba\xd0\xb5 \xd0\xb2\xd1\x8b\xd1\x88\xd0\xb5 \xe2\x80\x94 \xd1\x81\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd0\xb0\xd1\x8f, \xd0\xb0 \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xb0\xd1\x8f \xe2\x80\x94 \xd0\xbd\xd0\xb5\xd1\x82.  \xd0\x9a\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xbc\xd0\xb0\xd0\xba\xd1\x81\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xba\xd1\x82\xd0\xbd\xd1\x8b\xd0\xbc \xe2\x80\x94 \xd0\xb0 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe, \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd0\xb0 \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0, \xd0\xb2\xd0\xbd\xd1\x83\xd1\x82\xd1\x80\xd1\x8c \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xbd\xd0\xb0 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb5.\xd0\x9f\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xbc\xd1\x83 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd1\x83 nn \xd0\xbd\xd0\xb0\xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xb9\xd1\x82\xd0\xb5 \xd1\x81\xd1\x85\xd0\xb5\xd0\xbc\xd1\x83 \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80\xd0\xb0 \xd0\xb8\xd0\xb7 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe nn \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2, \xd1\x83\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xbb\xd0\xb5\xd1\x82\xd0\xb2\xd0\xbe\xd1\x80\xd1\x8f\xd1\x8e\xd1\x89\xd1\x83\xd1\x8e \xd0\xb2\xd1\x81\xd0\xb5\xd0\xbc \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x8f\xd0\xbc." -999.0                                           
     1530D "Secret Santa" "constructive algorithms,flows,graphs,greedy,math" "Every December, VK traditionally holds an event for its employees named ""Secret Santa"". Here\'s how it happens.n employees numbered from 1 to n take part in the event. Each employee i is assigned a different employee bi, to which employee i has to make a new year gift. Each employee is assigned to exactly one other employee, and nobody is assigned to themselves (but two employees may be assigned to each other). Formally, all bi must be distinct integers between 1 and n, and for any i, bi\xe2\x89\xa0i must hold.The assignment is usually generated randomly. This year, as an experiment, all event participants have been asked who they wish to make a gift to. Each employee i has said that they wish to make a gift to employee ai.Find a valid assignment b that maximizes the number of fulfilled wishes of the employees." 1600.0                                           
     1528E "Mashtali and Hagh Trees" combinatorics,dp,trees "Today is Mashtali\'s birthday! He received a Hagh tree from Haj Davood as his birthday present!A directed tree is called a Hagh tree iff:   The length of the longest directed path in it is exactly n.  Every vertex has at most three edges attached to it independent of their orientation.  Let\'s call vertices u and v friends if one of them has a directed path to the other. For every pair of vertices u and v that are not friends, there should exist a vertex w that is friends with both u and v (a mutual friend). After opening his gift, Mashtali found out that the labels on the vertices were gone.Immediately, he asked himself: how many different unlabeled Hagh trees are there? That is, how many possible trees could he have received as his birthday present?At the first glance, the number of such trees seemed to be infinite since there was no limit on the number of vertices; but then he solved the problem and proved that there\'s a finite number of unlabeled Hagh trees!Amazed by this fact, he shared the task with you so that you could enjoy solving it as well. Since the answer can be rather large he asked you to find the number of different unlabeled Hagh trees modulo 998244353.Here two trees are considered different, if they are not isomorphic: if there is no way to map nodes of one tree to the second tree, so that edges are mapped to edges preserving the orientation.Some examples for n=2:   Directed trees D and E are Hagh. C is not Hagh because it has a vertex with 4 edges attached to it. A and B are not Hagh because their longest directed paths are not equal to n. Also in B the leftmost and rightmost vertices are not friends neither do they have a mutual friend." 2900.0                                           
     1528B "Kavi on Pairing Duty" combinatorics,dp,math "Kavi has 2n points lying on the OX axis, i-th of which is located at x=i.Kavi considers all ways to split these 2n points into n pairs. Among those, he is interested in good pairings, which are defined as follows:Consider n segments with ends at the points in correspondent pairs. The pairing is called good, if for every 2 different segments A and B among those, at least one of the following holds:  One of the segments A and B lies completely inside the other.  A and B have the same length. Consider the following example:  A is a good pairing since the red segment lies completely inside the blue segment.B is a good pairing since the red and the blue segment have the same length.C is not a good pairing since none of the red or blue segments lies inside the other, neither do they have the same size.Kavi is interested in the number of good pairings, so he wants you to find it for him. As the result can be large, find this number modulo 998244353.Two pairings are called different, if some two points are in one pair in some pairing and in different pairs in another." 1700.0                                           
     1528A "Parsa\'s Humongous Tree" "dfs and similar,divide and conquer,dp,greedy,trees" "Parsa has a humongous tree on n vertices.On each vertex v he has written two integers lv and rv.To make Parsa\'s tree look even more majestic, Nima wants to assign a number av (lv\xe2\x89\xa4av\xe2\x89\xa4rv) to each vertex v such that the beauty of Parsa\'s tree is maximized.Nima\'s sense of the beauty is rather bizarre. He defines the beauty of the tree as the sum of |au\xe2\x88\x92av| over all edges (u,v) of the tree.Since Parsa\'s tree is too large, Nima can\'t maximize its beauty on his own. Your task is to find the maximum possible beauty for Parsa\'s tree." 1600.0                                           
          1333C "Eugene and an array" "binary search,data structures,implementation,two pointers" "Eugene likes working with arrays. And today he needs your help in solving one challenging task.An array c is a subarray of an array b if c can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end.Let\'s call a nonempty array good if for every nonempty subarray of this array, sum of the elements of this subarray is nonzero. For example, array [\xe2\x88\x921,2,\xe2\x88\x923] is good, as all arrays [\xe2\x88\x921], [\xe2\x88\x921,2], [\xe2\x88\x921,2,\xe2\x88\x923], [2], [2,\xe2\x88\x923], [\xe2\x88\x923] have nonzero sums of elements. However, array [\xe2\x88\x921,2,\xe2\x88\x921,\xe2\x88\x923] isn\'t good, as his subarray [\xe2\x88\x921,2,\xe2\x88\x921] has sum of elements equal to 0.Help Eugene to calculate the number of nonempty good subarrays of a given array a." 1700.0                                      
          1333B "Kind Anton" greedy,implementation "Once again, Boris needs the help of Anton in creating a task. This time Anton needs to solve the following problem:There are two arrays of integers a and b of length n. It turned out that array a contains only elements from the set {\xe2\x88\x921,0,1}.Anton can perform the following sequence of operations any number of times:  Choose any pair of indexes (i,j) such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n. It is possible to choose the same pair (i,j) more than once.   Add ai to aj. In other words, j-th element of the array becomes equal to ai+aj. For example, if you are given array [1,\xe2\x88\x921,0], you can transform it only to [1,\xe2\x88\x921,\xe2\x88\x921], [1,0,0] and [1,\xe2\x88\x921,1] by one operation.Anton wants to predict if it is possible to apply some number (zero or more) of these operations to the array a so that it becomes equal to array b. Can you help him?" 1100.0                                      
          1332B "Composite Coloring" "brute force,constructive algorithms,greedy,math,number theory" "A positive integer is called composite if it can be represented as a product of two positive integers, both greater than 1. For example, the following numbers are composite: 6, 4, 120, 27. The following numbers aren\'t: 1, 2, 3, 17, 97.Alice is given a sequence of n composite numbers a1,a2,\xe2\x80\xa6,an.She wants to choose an integer m\xe2\x89\xa411 and color each element one of m colors from 1 to m so that:  for each color from 1 to m there is at least one element of this color;  each element is colored and colored exactly one color;  the greatest common divisor of any two elements that are colored the same color is greater than 1, i.e. gcd(ai,aj)>1 for each pair i,j if these elements are colored the same color. Note that equal elements can be colored different colors \xe2\x80\x94 you just have to choose one of m colors for each of the indices from 1 to n.Alice showed already that if all ai\xe2\x89\xa41000 then she can always solve the task by choosing some m\xe2\x89\xa411.Help Alice to find the required coloring. Note that you don\'t have to minimize or maximize the number of colors, you just have to find the solution with some m from 1 to 11." 1400.0                                      
          1331C "...And after happily lived ever they" "*special problem,bitmasks" "InputThe input contains a single integer a (0\xe2\x89\xa4a\xe2\x89\xa463).OutputOutput a single number.ExamplesInputCopy2OutputCopy2InputCopy5OutputCopy24InputCopy35OutputCopy50" -999.0                                      
          1329A "Dreamoon Likes Coloring" "constructive algorithms,greedy,implementation,math" "Dreamoon likes coloring cells very much.There is a row of n cells. Initially, all cells are empty (don\'t contain any color). Cells are numbered from 1 to n.You are given an integer m and m integers l1,l2,\xe2\x80\xa6,lm (1\xe2\x89\xa4li\xe2\x89\xa4n)Dreamoon will perform m operations.In i-th operation, Dreamoon will choose a number pi from range [1,n\xe2\x88\x92li+1] (inclusive) and will paint all cells from pi to pi+li\xe2\x88\x921 (inclusive) in i-th color. Note that cells may be colored more one than once, in this case, cell will have the color from the latest operation.Dreamoon hopes that after these m operations, all colors will appear at least once and all cells will be colored. Please help Dreamoon to choose pi in each operation to satisfy all constraints." 1800.0                                      
          1328B "K-th Beautiful String" "binary search,brute force,combinatorics,implementation,math" "For the given integer n (n>2) let\'s write down all the strings of length n which contain n\xe2\x88\x922 letters \'a\' and two letters \'b\' in lexicographical (alphabetical) order.Recall that the string s of length n is lexicographically less than string t of length n, if there exists such i (1\xe2\x89\xa4i\xe2\x89\xa4n), that si<ti, and for any j (1\xe2\x89\xa4j<i) sj=tj. The lexicographic comparison of strings is implemented by the operator < in modern programming languages.For example, if n=5 the strings are (the order does matter):  aaabb  aabab  aabba  abaab  ababa  abbaa  baaab  baaba  babaa  bbaaa It is easy to show that such a list of strings will contain exactly n\xe2\x8b\x85(n\xe2\x88\x921)2 strings.You are given n (n>2) and k (1\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x8b\x85(n\xe2\x88\x921)2). Print the k-th string from the list." 1300.0                                      
          1327C "Game with Chips" "constructive algorithms,implementation" "Petya has a rectangular Board of size n\xc3\x97m. Initially, k chips are placed on the board, i-th chip is located in the cell at the intersection of sxi-th row and syi-th column.In one action, Petya can move all the chips to the left, right, down or up by 1 cell.If the chip was in the (x,y) cell, then after the operation:   left, its coordinates will be (x,y\xe2\x88\x921);  right, its coordinates will be (x,y+1);  down, its coordinates will be (x+1,y);  up, its coordinates will be (x\xe2\x88\x921,y). If the chip is located by the wall of the board, and the action chosen by Petya moves it towards the wall, then the chip remains in its current position.Note that several chips can be located in the same cell.For each chip, Petya chose the position which it should visit. Note that it\'s not necessary for a chip to end up in this position.Since Petya does not have a lot of free time, he is ready to do no more than 2nm actions.You have to find out what actions Petya should do so that each chip visits the position that Petya selected for it at least once. Or determine that it is not possible to do this in 2nm actions." 1600.0                                      
          1326G "Spiderweb Trees" dp,geometry,trees "Let\'s call a graph with n vertices, each of which has it\'s own point Ai=(xi,yi) with integer coordinates, a planar tree if:  All points A1,A2,\xe2\x80\xa6,An are different and no three points lie on the same line.  The graph is a tree, i.e. there are exactly n\xe2\x88\x921 edges there exists a path between any pair of vertices.  For all pairs of edges (s1,f1) and (s2,f2), such that s1\xe2\x89\xa0s2,s1\xe2\x89\xa0f2, f1\xe2\x89\xa0s2, and f1\xe2\x89\xa0f2, the segments As1Af1 and As2Af2 don\'t intersect. Imagine a planar tree with n vertices. Consider the convex hull of points A1,A2,\xe2\x80\xa6,An. Let\'s call this tree a spiderweb tree if for all 1\xe2\x89\xa4i\xe2\x89\xa4n the following statements are true:  All leaves (vertices with degree \xe2\x89\xa41) of the tree lie on the border of the convex hull.  All vertices on the border of the convex hull are leaves. An example of a spiderweb tree:   The points A3,A6,A7,A4 lie on the convex hull and the leaf vertices of the tree are 3,6,7,4.Refer to the notes for more examples.Let\'s call the subset S\xe2\x8a\x82{1,2,\xe2\x80\xa6,n} of vertices a subtree of the tree if for all pairs of vertices in S, there exists a path that contains only vertices from S. Note that any subtree of the planar tree is a planar tree.You are given a planar tree with n vertexes. Let\'s call a partition of the set {1,2,\xe2\x80\xa6,n} into non-empty subsets A1,A2,\xe2\x80\xa6,Ak (i.e. Ai\xe2\x88\xa9Aj=\xe2\x88\x85 for all 1\xe2\x89\xa4i<j\xe2\x89\xa4k and A1\xe2\x88\xaaA2\xe2\x88\xaa\xe2\x80\xa6\xe2\x88\xaaAk={1,2,\xe2\x80\xa6,n}) good if for all 1\xe2\x89\xa4i\xe2\x89\xa4k, the subtree Ai is a spiderweb tree. Two partitions are different if there exists some set that lies in one parition, but not the other.Find the number of good partitions. Since this number can be very large, find it modulo 998244353." 3500.0                                      
          1322B Present "binary search,bitmasks,constructive algorithms,data structures,math,sortings" "Catherine received an array of integers as a gift for March 8. Eventually she grew bored with it, and she started calculated various useless characteristics for it. She succeeded to do it for each one she came up with. But when she came up with another one \xe2\x80\x94 xor of all pairwise sums of elements in the array, she realized that she couldn\'t compute it for a very large array, thus she asked for your help. Can you do it? Formally, you need to compute(a1+a2)\xe2\x8a\x95(a1+a3)\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95(a1+an)\xe2\x8a\x95(a2+a3)\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95(a2+an)\xe2\x80\xa6\xe2\x8a\x95(an\xe2\x88\x921+an)Here x\xe2\x8a\x95y is a bitwise XOR operation (i.e. x ^ y in many modern programming languages). You can read about it in Wikipedia: https://en.wikipedia.org/wiki/Exclusive_or#Bitwise_operation." 2100.0                                      
          1322A "Unusual Competitions" greedy "A bracketed sequence is called correct (regular) if by inserting ""+"" and ""1"" you can get a well-formed mathematical expression from it. For example, sequences ""(())()"", ""()"" and ""(()(()))"" are correct, while "")("", ""(()"" and ""(()))("" are not.The teacher gave Dmitry\'s class a very strange task \xe2\x80\x94 she asked every student to come up with a sequence of arbitrary length, consisting only of opening and closing brackets. After that all the students took turns naming the sequences they had invented. When Dima\'s turn came, he suddenly realized that all his classmates got the correct bracketed sequence, and whether he got the correct bracketed sequence, he did not know.Dima suspects now that he simply missed the word ""correct"" in the task statement, so now he wants to save the situation by modifying his sequence slightly. More precisely, he can the arbitrary number of times (possibly zero) perform the reorder operation.The reorder operation consists of choosing an arbitrary consecutive subsegment (substring) of the sequence and then reordering all the characters in it in an arbitrary way. Such operation takes l nanoseconds, where l is the length of the subsegment being reordered. It\'s easy to see that reorder operation doesn\'t change the number of opening and closing brackets. For example for ""))(("" he can choose the substring "")("" and do reorder "")()("" (this operation will take 2 nanoseconds).Since Dima will soon have to answer, he wants to make his sequence correct as fast as possible. Help him to do this, or determine that it\'s impossible." 1300.0                                      
          1320E "Treeland and Viruses" "data structures,dfs and similar,dp,shortest paths,trees" "There are n cities in Treeland connected with n\xe2\x88\x921 bidirectional roads in such that a way that any city is reachable from any other; in other words, the graph of cities and roads is a tree. Treeland is preparing for a seasonal virus epidemic, and currently, they are trying to evaluate different infection scenarios.In each scenario, several cities are initially infected with different virus species. Suppose that there are ki virus species in the i-th scenario. Let us denote vj the initial city for the virus j, and sj the propagation speed of the virus j. The spread of the viruses happens in turns: first virus 1 spreads, followed by virus 2, and so on. After virus ki spreads, the process starts again from virus 1.A spread turn of virus j proceeds as follows. For each city x not infected with any virus at the start of the turn, at the end of the turn it becomes infected with virus j if and only if there is such a city y that: city y was infected with virus j at the start of the turn; the path between cities x and y contains at most sj edges; all cities on the path between cities x and y (excluding y) were uninfected with any virus at the start of the turn.Once a city is infected with a virus, it stays infected indefinitely and can not be infected with any other virus. The spread stops once all cities are infected.You need to process q independent scenarios. Each scenario is described by ki virus species and mi important cities. For each important city determine which the virus it will be infected by in the end." 3000.0                                      
          1316D "Nash Matrix" "constructive algorithms,dfs and similar,graphs,implementation" "Nash designed an interesting yet simple board game where a player is simply required to follow instructions written on the cell where the player currently stands. This board game is played on the n\xc3\x97n board. Rows and columns of this board are numbered from 1 to n. The cell on the intersection of the r-th row and c-th column is denoted by (r,c).Some cells on the board are called blocked zones. On each cell of the board, there is written one of the following 5 characters  \xe2\x80\x94 U, D, L, R or X  \xe2\x80\x94 instructions for the player. Suppose that the current cell is (r,c). If the character is R, the player should move to the right cell (r,c+1), for L the player should move to the left cell (r,c\xe2\x88\x921), for U the player should move to the top cell (r\xe2\x88\x921,c), for D the player should move to the bottom cell (r+1,c). Finally, if the character in the cell is X, then this cell is the blocked zone. The player should remain in this cell (the game for him isn\'t very interesting from now on).It is guaranteed that the characters are written in a way that the player will never have to step outside of the board, no matter at which cell he starts.As a player starts from a cell, he moves according to the character in the current cell. The player keeps moving until he lands in a blocked zone. It is also possible that the player will keep moving infinitely long.For every of the n2 cells of the board Alice, your friend, wants to know, how will the game go, if the player starts in this cell. For each starting cell of the board, she writes down the cell that the player stops at, or that the player never stops at all. She gives you the information she has written: for each cell (r,c) she wrote:   a pair (x,y), meaning if a player had started at (r,c), he would end up at cell (x,y).  or a pair (\xe2\x88\x921,\xe2\x88\x921), meaning if a player had started at (r,c), he would keep moving infinitely long and would never enter the blocked zone. It might be possible that Alice is trying to fool you and there\'s no possible grid that satisfies all the constraints Alice gave you. For the given information Alice provided you, you are required to decipher a possible board, or to determine that such a board doesn\'t exist. If there exist several different boards that satisfy the provided information, you can find any of them." 2000.0                                      
          1316A "Grade Allocation" implementation "n students are taking an exam. The highest possible score at this exam is m. Let ai be the score of the i-th student. You have access to the school database which stores the results of all students.You can change each student\'s score as long as the following conditions are satisfied:   All scores are integers  0\xe2\x89\xa4ai\xe2\x89\xa4m  The average score of the class doesn\'t change. You are student 1 and you would like to maximize your own score.Find the highest possible score you can assign to yourself such that all conditions are satisfied." 800.0                                      
          1313A "Fast Food Restaurant" "brute force,greedy,implementation" "Tired of boring office work, Denis decided to open a fast food restaurant.On the first day he made a portions of dumplings, b portions of cranberry juice and c pancakes with condensed milk.The peculiarity of Denis\'s restaurant is the procedure of ordering food. For each visitor Denis himself chooses a set of dishes that this visitor will receive. When doing so, Denis is guided by the following rules:  every visitor should receive at least one dish (dumplings, cranberry juice, pancakes with condensed milk are all considered to be dishes);  each visitor should receive no more than one portion of dumplings, no more than one portion of cranberry juice and no more than one pancake with condensed milk;  all visitors should receive different sets of dishes. What is the maximum number of visitors Denis can feed?" 900.0                                      
          1312F "Attack on Red Kingdom" "games,two pointers" "The Red Kingdom is attacked by the White King and the Black King!The Kingdom is guarded by n castles, the i-th castle is defended by ai soldiers. To conquer the Red Kingdom, the Kings have to eliminate all the defenders. Each day the White King launches an attack on one of the castles. Then, at night, the forces of the Black King attack a castle (possibly the same one). Then the White King attacks a castle, then the Black King, and so on. The first attack is performed by the White King.Each attack must target a castle with at least one alive defender in it. There are three types of attacks:  a mixed attack decreases the number of defenders in the targeted castle by x (or sets it to 0 if there are already less than x defenders);  an infantry attack decreases the number of defenders in the targeted castle by y (or sets it to 0 if there are already less than y defenders);  a cavalry attack decreases the number of defenders in the targeted castle by z (or sets it to 0 if there are already less than z defenders). The mixed attack can be launched at any valid target (at any castle with at least one soldier). However, the infantry attack cannot be launched if the previous attack on the targeted castle had the same type, no matter when and by whom it was launched. The same applies to the cavalry attack. A castle that was not attacked at all can be targeted by any type of attack.The King who launches the last attack will be glorified as the conqueror of the Red Kingdom, so both Kings want to launch the last attack (and they are wise enough to find a strategy that allows them to do it no matter what are the actions of their opponent, if such strategy exists). The White King is leading his first attack, and you are responsible for planning it. Can you calculate the number of possible options for the first attack that allow the White King to launch the last attack? Each option for the first attack is represented by the targeted castle and the type of attack, and two options are different if the targeted castles or the types of attack are different." 2500.0                                      
          1310B "Double Elimination" dp,implementation "The biggest event of the year \xe2\x80\x93 Cota 2 world championship ""The Innernational"" is right around the corner. 2n teams will compete in a double-elimination format (please, carefully read problem statement even if you know what is it) to identify the champion. Teams are numbered from 1 to 2n and will play games one-on-one. All teams start in the upper bracket.All upper bracket matches will be held played between teams that haven\'t lost any games yet. Teams are split into games by team numbers. Game winner advances in the next round of upper bracket, losers drop into the lower bracket.Lower bracket starts with 2n\xe2\x88\x921 teams that lost the first upper bracket game. Each lower bracket round consists of two games. In the first game of a round 2k teams play a game with each other (teams are split into games by team numbers). 2k\xe2\x88\x921 loosing teams are eliminated from the championship, 2k\xe2\x88\x921 winning teams are playing 2k\xe2\x88\x921 teams that got eliminated in this round of upper bracket (again, teams are split into games by team numbers). As a result of each round both upper and lower bracket have 2k\xe2\x88\x921 teams remaining. See example notes for better understanding.Single remaining team of upper bracket plays with single remaining team of lower bracket in grand-finals to identify championship winner.You are a fan of teams with numbers a1,a2,...,ak. You want the championship to have as many games with your favourite teams as possible. Luckily, you can affect results of every championship game the way you want. What\'s maximal possible number of championship games that include teams you\'re fan of?" 2500.0                                      
          1305H "Kuroni the Private Tutor" "binary search,greedy" "As a professional private tutor, Kuroni has to gather statistics of an exam. Kuroni has appointed you to complete this important task. You must not disappoint him.The exam consists of n questions, and m students have taken the exam. Each question was worth 1 point. Question i was solved by at least li and at most ri students. Additionally, you know that the total score of all students is t.Furthermore, you took a glance at the final ranklist of the quiz. The students were ranked from 1 to m, where rank 1 has the highest score and rank m has the lowest score. Ties were broken arbitrarily.You know that the student at rank pi had a score of si for 1\xe2\x89\xa4i\xe2\x89\xa4q.You wonder if there could have been a huge tie for first place. Help Kuroni determine the maximum number of students who could have gotten as many points as the student with rank 1, and the maximum possible score for rank 1 achieving this maximum number of students." 3500.0                                      
          1304C "Air Conditioner" "dp,greedy,implementation,sortings,two pointers" "Gildong owns a bulgogi restaurant. The restaurant has a lot of customers, so many of them like to make a reservation before visiting it.Gildong tries so hard to satisfy the customers that he even memorized all customers\' preferred temperature ranges! Looking through the reservation list, he wants to satisfy all customers by controlling the temperature of the restaurant.The restaurant has an air conditioner that has 3 states: off, heating, and cooling. When it\'s off, the restaurant\'s temperature remains the same. When it\'s heating, the temperature increases by 1 in one minute. Lastly, when it\'s cooling, the temperature decreases by 1 in one minute. Gildong can change the state as many times as he wants, at any integer minutes. The air conditioner is off initially.Each customer is characterized by three values: ti \xe2\x80\x94 the time (in minutes) when the i-th customer visits the restaurant, li \xe2\x80\x94 the lower bound of their preferred temperature range, and hi \xe2\x80\x94 the upper bound of their preferred temperature range.A customer is satisfied if the temperature is within the preferred range at the instant they visit the restaurant. Formally, the i-th customer is satisfied if and only if the temperature is between li and hi (inclusive) in the ti-th minute.Given the initial temperature, the list of reserved customers\' visit times and their preferred temperature ranges, you\'re going to help him find if it\'s possible to satisfy all customers." 1500.0                                      
          1304B "Longest Palindrome" "brute force,constructive algorithms,greedy,implementation,strings" "Returning back to problem solving, Gildong is now studying about palindromes. He learned that a palindrome is a string that is the same as its reverse. For example, strings ""pop"", ""noon"", ""x"", and ""kkkkkk"" are palindromes, while strings ""moon"", ""tv"", and ""abab"" are not. An empty string is also a palindrome.Gildong loves this concept so much, so he wants to play with it. He has n distinct strings of equal length m. He wants to discard some of the strings (possibly none or all) and reorder the remaining strings so that the concatenation becomes a palindrome. He also wants the palindrome to be as long as possible. Please help him find one." 1100.0                                      
          1303D "Fill The Bag" bitmasks,greedy "You have a bag of size n. Also you have m boxes. The size of i-th box is ai, where each ai is an integer non-negative power of two.You can divide boxes into two parts of equal size. Your goal is to fill the bag completely.For example, if n=10 and a=[1,1,32] then you have to divide the box of size 32 into two parts of size 16, and then divide the box of size 16. So you can fill the bag with boxes of size 1, 1 and 8.Calculate the minimum number of divisions required to fill the bag of size n." 1900.0                                      
          1303C "Perfect Keyboard" "dfs and similar,greedy,implementation" "Polycarp wants to assemble his own keyboard. Layouts with multiple rows are too complicated for him \xe2\x80\x94 his keyboard will consist of only one row, where all 26 lowercase Latin letters will be arranged in some order.Polycarp uses the same password s on all websites where he is registered (it is bad, but he doesn\'t care). He wants to assemble a keyboard that will allow to type this password very easily. He doesn\'t like to move his fingers while typing the password, so, for each pair of adjacent characters in s, they should be adjacent on the keyboard. For example, if the password is abacaba, then the layout cabdefghi... is perfect, since characters a and c are adjacent on the keyboard, and a and b are adjacent on the keyboard. It is guaranteed that there are no two adjacent equal characters in s, so, for example, the password cannot be password (two characters s are adjacent).Can you help Polycarp with choosing the perfect layout of the keyboard, if it is possible?" 1600.0                                      
          1303B "National Project" math "Your company was appointed to lay new asphalt on the highway of length n. You know that every day you can either repair one unit of the highway (lay new asphalt over one unit of the highway) or skip repairing.Skipping the repair is necessary because of the climate. The climate in your region is periodical: there are g days when the weather is good and if you lay new asphalt these days it becomes high-quality pavement; after that, the weather during the next b days is bad, and if you lay new asphalt these days it becomes low-quality pavement; again g good days, b bad days and so on.You can be sure that you start repairing at the start of a good season, in other words, days 1,2,\xe2\x80\xa6,g are good.You don\'t really care about the quality of the highway, you just want to make sure that at least half of the highway will have high-quality pavement. For example, if the n=5 then at least 3 units of the highway should have high quality; if n=4 then at least 2 units should have high quality.What is the minimum number of days is needed to finish the repair of the whole highway?" 1400.0                                      
          1302E "Amazing bitset"  "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543Andrey has just started to study competitive programming and he is fascinated by bitsets and operations on them.For example, assume he has a bitset with n elements. He can change the values of the bitset in the following way:   He chooses different indices i0, i1, i2, ... ik (k\xe2\x89\xa51, 1\xe2\x89\xa4ij\xe2\x89\xa4n) so that bit i0 is different from all bits i1, i2, ... ik.  He flips all these k+1 bits.  He calls a bitset amazing if he can flip all the bits using several such changes.Another topic Andrey is interested in is probability theory. For given n and p, where p is a rational number represented as ab with integer a,b, he considers all bitsets of length n, where each element is equal to 1 with probability p independently of the other elements.He wants to know the probability that a bitset generated by the described method is amazing.It is guaranteed that the answer to this problem can be represented as a rational number xy, where y is coprime with 1234567891. You need to output such integer z that x\xe2\x89\xa1yz(mod1234567891) and 0\xe2\x89\xa4z<1234567891." -999.0                                      
          1301B "Motarack\'s Birthday" "binary search,greedy,ternary search" "Dark is going to attend Motarack\'s birthday. Dark decided that the gift he is going to give to Motarack is an array a of n non-negative integers.Dark created that array 1000 years ago, so some elements in that array disappeared. Dark knows that Motarack hates to see an array that has two adjacent elements with a high absolute difference between them. He doesn\'t have much time so he wants to choose an integer k (0\xe2\x89\xa4k\xe2\x89\xa4109) and replaces all missing elements in the array a with k.Let m be the maximum absolute difference between all adjacent elements (i.e. the maximum value of |ai\xe2\x88\x92ai+1| for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) in the array a after Dark replaces all missing elements with k.Dark should choose an integer k so that m is minimized. Can you help him?" 1500.0                                      
          1299D "Around the World" "bitmasks,combinatorics,dfs and similar,dp,graphs,graphs,math,trees" "Guy-Manuel and Thomas are planning 144 trips around the world.You are given a simple weighted undirected connected graph with n vertexes and m edges with the following restriction: there isn\'t any simple cycle (i. e. a cycle which doesn\'t pass through any vertex more than once) of length greater than 3 which passes through the vertex 1. The cost of a path (not necessarily simple) in this graph is defined as the XOR of weights of all edges in that path with each edge being counted as many times as the path passes through it.But the trips with cost 0 aren\'t exciting. You may choose any subset of edges incident to the vertex 1 and remove them. How many are there such subsets, that, when removed, there is not any nontrivial cycle with the cost equal to 0 which passes through the vertex 1 in the resulting graph? A cycle is called nontrivial if it passes through some edge odd number of times. As the answer can be very big, output it modulo 109+7." 3000.0                                      
          1297I "Falling Blocks" "*special problem,data structures" "Recently, Polycarp has invented a new mobile game with falling blocks.In the game, n blocks are falling down, one at a time, towards a flat surface with length d units. Each block can be represented as a rectangle with coordinates from li to ri and unit height, dropped downwards from very high up. A block falls until it comes in contact with the flat surface or any other block. Let\'s define that block a covers block b if la\xe2\x89\xa4lb\xe2\x89\xa4rb\xe2\x89\xa4ra. Consider what happens when a new block i falls. If the new (upper) block i comes in contact with any block j such that block i does not cover block j, block i will stick to block j, and no blocks will disappear. Otherwise, all blocks that block i covers and is in contact with will be vaporized, and block i will continue falling with the ability to vaporize lower blocks.For example, consider what happens when three blocks (1,2), (2,3) and (1,3) fall, in that order. The first block will stick to the flat surface. Then, the second block will stick to the first block. Finally, the third block will vaporize the second block, keep falling, vaporize the first block, and stick to the flat surface.  Here is a graphic for the first example. After each block falls, help Polycarp determine how many blocks will remain!" -999.0                                      
          1295F "Good Contest" combinatorics,dp,probabilities "An online contest will soon be held on ForceCoders, a large competitive programming platform. The authors have prepared n problems; and since the platform is very popular, 998244351 coder from all over the world is going to solve them.For each problem, the authors estimated the number of people who would solve it: for the i-th problem, the number of accepted solutions will be between li and ri, inclusive.The creator of ForceCoders uses different criteria to determine if the contest is good or bad. One of these criteria is the number of inversions in the problem order. An inversion is a pair of problems (x,y) such that x is located earlier in the contest (x<y), but the number of accepted solutions for y is strictly greater.Obviously, both the creator of ForceCoders and the authors of the contest want the contest to be good. Now they want to calculate the probability that there will be no inversions in the problem order, assuming that for each problem i, any integral number of accepted solutions for it (between li and ri) is equally probable, and all these numbers are independent." 2700.0                                      
          1295D "Same GCDs" "math,number theory" "You are given two integers a and m. Calculate the number of integers x such that 0\xe2\x89\xa4x<m and gcd(a,m)=gcd(a+x,m).Note: gcd(a,b) is the greatest common divisor of a and b." 1800.0                                      
          1295B "Infinite Prefixes" math,strings "You are given string s of length n consisting of 0-s and 1-s. You build an infinite string t as a concatenation of an infinite number of strings s, or t=ssss\xe2\x80\xa6 For example, if s= 10010, then t= 100101001010010...Calculate the number of prefixes of t with balance equal to x. The balance of some string q is equal to cnt0,q\xe2\x88\x92cnt1,q, where cnt0,q is the number of occurrences of 0 in q, and cnt1,q is the number of occurrences of 1 in q. The number of such prefixes can be infinite; if it is so, you must say that.A prefix is a string consisting of several first letters of a given string, without any reorders. An empty prefix is also a valid prefix. For example, the string ""abcd"" has 5 prefixes: empty string, ""a"", ""ab"", ""abc"" and ""abcd""." 1700.0                                      
          1292F "Nora\'s Toy Boxes" bitmasks,combinatorics,dp "SIHanatsuka - EMber SIHanatsuka - ATONEMENTBack in time, the seven-year-old Nora used to play lots of games with her creation ROBO_Head-02, both to have fun and enhance his abilities.One day, Nora\'s adoptive father, Phoenix Wyle, brought Nora n boxes of toys. Before unpacking, Nora decided to make a fun game for ROBO.She labelled all n boxes with n distinct integers a1,a2,\xe2\x80\xa6,an and asked ROBO to do the following action several (possibly zero) times:  Pick three distinct indices i, j and k, such that ai\xe2\x88\xa3aj and ai\xe2\x88\xa3ak. In other words, ai divides both aj and ak, that is ajmodai=0, akmodai=0.  After choosing, Nora will give the k-th box to ROBO, and he will place it on top of the box pile at his side. Initially, the pile is empty.  After doing so, the box k becomes unavailable for any further actions. Being amused after nine different tries of the game, Nora asked ROBO to calculate the number of possible different piles having the largest amount of boxes in them. Two piles are considered different if there exists a position where those two piles have different boxes.Since ROBO was still in his infant stages, and Nora was still too young to concentrate for a long time, both fell asleep before finding the final answer. Can you help them?As the number of such piles can be very large, you should print the answer modulo 109+7." 3500.0                                      
          1292A "NEKO\'s Maze Game" "data structures,dsu,implementation" "3R2 as DJ Mashiro - Happiness Breeze Ice - DJ Mashiro is dead or aliveNEKO#\xce\xa6\xcf\x89\xce\xa6 has just got a new maze game on her PC!The game\'s main puzzle is a maze, in the forms of a 2\xc3\x97n rectangle grid. NEKO\'s task is to lead a Nekomimi girl from cell (1,1) to the gate at (2,n) and escape the maze. The girl can only move between cells sharing a common side.However, at some moments during the game, some cells may change their state: either from normal ground to lava (which forbids movement into that cell), or vice versa (which makes that cell passable again). Initially all cells are of the ground type.After hours of streaming, NEKO finally figured out there are only q such moments: the i-th moment toggles the state of cell (ri,ci) (either from ground to lava or vice versa).Knowing this, NEKO wonders, after each of the q moments, whether it is still possible to move from cell (1,1) to cell (2,n) without going through any lava cells.Although NEKO is a great streamer and gamer, she still can\'t get through quizzes and problems requiring large amount of Brain Power. Can you help her?" 1400.0                                      
          1287B Hyperset "brute force,data structures,implementation" "Bees Alice and Alesya gave beekeeper Polina famous card game ""Set"" as a Christmas present. The deck consists of cards that vary in four features across three options for each kind of feature: number of shapes, shape, shading, and color. In this game, some combinations of three cards are said to make up a set. For every feature \xe2\x80\x94 color, number, shape, and shading \xe2\x80\x94 the three cards must display that feature as either all the same, or pairwise different. The picture below shows how sets look.Polina came up with a new game called ""Hyperset"". In her game, there are n cards with k features, each feature has three possible values: ""S"", ""E"", or ""T"". The original ""Set"" game can be viewed as ""Hyperset"" with k=4.Similarly to the original game, three cards form a set, if all features are the same for all cards or are pairwise different. The goal of the game is to compute the number of ways to choose three cards that form a set.Unfortunately, winter holidays have come to an end, and it\'s time for Polina to go to school. Help Polina find the number of sets among the cards lying on the table." 1500.0                                      
          1287A "Angry Students" greedy,implementation "It\'s a walking tour day in SIS.Winter, so t groups of students are visiting Torzhok. Streets of Torzhok are so narrow that students have to go in a row one after another.Initially, some students are angry. Let\'s describe a group of students by a string of capital letters ""A"" and ""P"":   ""A"" corresponds to an angry student  ""P"" corresponds to a patient student Such string describes the row from the last to the first student.Every minute every angry student throws a snowball at the next student. Formally, if an angry student corresponds to the character with index i in the string describing a group then they will throw a snowball at the student that corresponds to the character with index i+1 (students are given from the last to the first student). If the target student was not angry yet, they become angry. Even if the first (the rightmost in the string) student is angry, they don\'t throw a snowball since there is no one in front of them.Let\'s look at the first example test. The row initially looks like this: PPAP. Then, after a minute the only single angry student will throw a snowball at the student in front of them, and they also become angry: PPAA. After that, no more students will become angry.Your task is to help SIS.Winter teachers to determine the last moment a student becomes angry for every group." 800.0                                      
          1286A Garland dp,greedy,sortings "Vadim loves decorating the Christmas tree, so he got a beautiful garland as a present. It consists of n light bulbs in a single row. Each bulb has a number from 1 to n (in arbitrary order), such that all the numbers are distinct. While Vadim was solving problems, his home Carp removed some light bulbs from the garland. Now Vadim wants to put them back on.Vadim wants to put all bulb back on the garland. Vadim defines complexity of a garland to be the number of pairs of adjacent bulbs with numbers with different parity (remainder of the division by 2). For example, the complexity of 1 4 2 3 5 is 2 and the complexity of 1 3 5 7 6 4 2 is 1.No one likes complexity, so Vadim wants to minimize the number of such pairs. Find the way to put all bulbs back on the garland, such that the complexity is as small as possible." 1800.0                                      
          1283B "Candies Division" math "Santa has n candies and he wants to gift them to k kids. He wants to divide as many candies as possible between all k kids. Santa can\'t divide one candy into parts but he is allowed to not use some candies at all.Suppose the kid who recieves the minimum number of candies has a candies and the kid who recieves the maximum number of candies has b candies. Then Santa will be satisfied, if the both conditions are met at the same time:  b\xe2\x88\x92a\xe2\x89\xa41 (it means b=a or b=a+1);  the number of kids who has a+1 candies (note that a+1 not necessarily equals b) does not exceed \xe2\x8c\x8ak2\xe2\x8c\x8b (less than or equal to \xe2\x8c\x8ak2\xe2\x8c\x8b). \xe2\x8c\x8ak2\xe2\x8c\x8b is k divided by 2 and rounded down to the nearest integer. For example, if k=5 then \xe2\x8c\x8ak2\xe2\x8c\x8b=\xe2\x8c\x8a52\xe2\x8c\x8b=2.Your task is to find the maximum number of candies Santa can give to kids so that he will be satisfied.You have to answer t independent test cases." 900.0                                      
          1282E "The Cake Is a Lie" "constructive algorithms,data structures,dfs and similar,graphs" "We are committed to the well being of all participants. Therefore, instead of the problem, we suggest you enjoy a piece of cake.Uh oh. Somebody cut the cake. We told them to wait for you, but they did it anyway. There is still some left, though, if you hurry back. Of course, before you taste the cake, you thought about how the cake was cut.It is known that the cake was originally a regular n-sided polygon, each vertex of which had a unique number from 1 to n. The vertices were numbered in random order.Each piece of the cake is a triangle. The cake was cut into n\xe2\x88\x922 pieces as follows: each time one cut was made with a knife (from one vertex to another) such that exactly one triangular piece was separated from the current cake, and the rest continued to be a convex polygon. In other words, each time three consecutive vertices of the polygon were selected and the corresponding triangle was cut off.A possible process of cutting the cake is presented in the picture below.  Example of 6-sided cake slicing. You are given a set of n\xe2\x88\x922 triangular pieces in random order. The vertices of each piece are given in random order \xe2\x80\x94 clockwise or counterclockwise. Each piece is defined by three numbers \xe2\x80\x94 the numbers of the corresponding n-sided cake vertices.For example, for the situation in the picture above, you could be given a set of pieces: [3,6,5],[5,2,4],[5,4,6],[6,3,1].You are interested in two questions.  What was the enumeration of the n-sided cake vertices?  In what order were the pieces cut? Formally, you have to find two permutations p1,p2,\xe2\x80\xa6,pn (1\xe2\x89\xa4pi\xe2\x89\xa4n) and q1,q2,\xe2\x80\xa6,qn\xe2\x88\x922 (1\xe2\x89\xa4qi\xe2\x89\xa4n\xe2\x88\x922) such that if the cake vertices are numbered with the numbers p1,p2,\xe2\x80\xa6,pn in order clockwise or counterclockwise, then when cutting pieces of the cake in the order q1,q2,\xe2\x80\xa6,qn\xe2\x88\x922 always cuts off a triangular piece so that the remaining part forms one convex polygon.For example, in the picture above the answer permutations could be: p=[2,4,6,1,3,5] (or any of its cyclic shifts, or its reversal and after that any cyclic shift) and q=[2,4,1,3].Write a program that, based on the given triangular pieces, finds any suitable permutations p and q." 2400.0                                      
          1275F "\xd0\xa8\xd0\xb0\xd1\x80\xd0\xb4\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2" "*special problem,binary search,interactive" "\xd0\xad\xd1\x82\xd0\xbe \xd0\xb8\xd0\xbd\xd1\x82\xd0\xb5\xd1\x80\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd0\xb2\xd0\xbd\xd0\xb0\xd1\x8f \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb0.\xd0\x9a\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd1\x81\xd0\xbb\xd0\xb8\xd1\x88\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xb8 \xd0\xbd\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x89\xd0\xb0\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80, \xd0\xb8\xd1\x85 \xd0\xbf\xd1\x80\xd0\xb8\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd1\x88\xd0\xb0\xd1\x80\xd0\xb4\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c. \xd0\xa0\xd0\xb0\xd1\x81\xd1\x81\xd0\xbc\xd0\xbe\xd1\x82\xd1\x80\xd0\xb8\xd0\xbc \xd1\x81\xd0\xb8\xd1\x81\xd1\x82\xd0\xb5\xd0\xbc\xd1\x83 \xd1\x85\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xb0\xd1\x8f \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xb0 S \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb0\xd1\x85, \xd0\xbd\xd1\x83\xd0\xbc\xd0\xb5\xd1\x80\xd1\x83\xd0\xb5\xd0\xbc\xd1\x8b\xd1\x85 \xd1\x81 \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb8\xd1\x86\xd1\x8b. \xd0\x9a\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb7 \xd0\xba\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c \xd0\xbf\xd0\xb8\xd1\x88\xd0\xb5\xd1\x82 \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82, \xd0\xb5\xd0\xbc\xd1\x83 \xd0\xb2\xd1\x8b\xd0\xb4\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x83\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb4\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb8\xd1\x84\xd0\xb8\xd0\xba\xd0\xb0\xd1\x82\xd0\xbe\xd1\x80 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x85 \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe 1018 \xd0\xb8 \xd1\x81\xd0\xbe\xd1\x85\xd1\x80\xd0\xb0\xd0\xbd\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb9\xd0\xbd\xd1\x8b\xd0\xb9 \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80. \xd0\xa7\xd0\xb5\xd0\xbc \xd0\xbf\xd0\xbe\xd0\xb7\xd0\xb6\xd0\xb5 \xd0\xb1\xd1\x8b\xd0\xbb \xd1\x81\xd0\xbe\xd0\xb7\xd0\xb4\xd0\xb0\xd0\xbd \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82, \xd1\x82\xd0\xb5\xd0\xbc \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xb5\xd0\xb3\xd0\xbe id. \xd0\x98\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd1\x8b \xd1\x83\xd0\xb4\xd0\xb0\xd0\xbb\xd1\x8f\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f, \xd0\xbf\xd0\xbe\xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xbd\xd0\xb0 \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb0\xd1\x85 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb0\xd1\x82\xd1\x8c \xd1\x81\xd1\x83\xd1\x89\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2.\xd0\xa0\xd0\xb0\xd1\x81\xd1\x81\xd0\xbc\xd0\xbe\xd1\x82\xd1\x80\xd0\xb8\xd0\xbc \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xbd\xd0\xb5\xd1\x83\xd0\xb4\xd0\xb0\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 id \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f \xd0\xb8 \xd0\xbe\xd1\x82\xd1\x81\xd0\xbe\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd0\xbc \xd0\xb8\xd1\x85 \xd0\xbf\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd1\x80\xd0\xb0\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8e. \xd0\x92\xd0\xb0\xd0\xbc \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x83\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x82\xd1\x8c k-\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85. \xd0\x94\xd0\xbb\xd1\x8f \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb2\xd1\x8b \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82\xd0\xb5 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 100 \xd0\xb4\xd0\xbe\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbd\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb7\xd0\xb0\xd0\xbf\xd1\x80\xd0\xbe\xd1\x81\xd0\xbe\xd0\xb2. \xd0\x9a\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb7\xd0\xb0\xd0\xbf\xd1\x80\xd0\xbe\xd1\x81 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd1\x82 \xc2\xab? i j\xc2\xbb. \xd0\x92 \xd0\xbe\xd1\x82\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb8\xd0\xb4\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb8\xd1\x84\xd0\xb8\xd0\xba\xd0\xb0\xd1\x82\xd0\xbe\xd1\x80 j-\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd1\x80\xd0\xb0\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8e \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f \xd1\x81\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb8 \xd1\x85\xd1\x80\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x89\xd0\xb8\xd1\x85\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 i-\xd0\xbc \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb5. \xd0\x9a\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xb2\xd1\x8b \xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb5\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82\xd0\xb5 k-\xd0\xb9 \xd0\xbf\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd1\x80\xd0\xb0\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8e \xd0\xb8\xd0\xb4\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb8\xd1\x84\xd0\xb8\xd0\xba\xd0\xb0\xd1\x82\xd0\xbe\xd1\x80, \xd0\xb2\xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbf\xd1\x80\xd0\xbe\xd1\x81\xd0\xb0 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbe\xd1\x82\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xb2 \xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd1\x82\xd0\xb5 \xc2\xab! id\xc2\xbb." -999.0                                      
          1271D Portals "data structures,dp,greedy,implementation,sortings" "You play a strategic video game (yeah, we ran out of good problem legends). In this game you control a large army, and your goal is to conquer n castles of your opponent.Let\'s describe the game process in detail. Initially you control an army of k warriors. Your enemy controls n castles; to conquer the i-th castle, you need at least ai warriors (you are so good at this game that you don\'t lose any warriors while taking over a castle, so your army stays the same after the fight). After you take control over a castle, you recruit new warriors into your army \xe2\x80\x94 formally, after you capture the i-th castle, bi warriors join your army. Furthermore, after capturing a castle (or later) you can defend it: if you leave at least one warrior in a castle, this castle is considered defended. Each castle has an importance parameter ci, and your total score is the sum of importance values over all defended castles. There are two ways to defend a castle:  if you are currently in the castle i, you may leave one warrior to defend castle i;  there are m one-way portals connecting the castles. Each portal is characterised by two numbers of castles u and v (for each portal holds u>v). A portal can be used as follows: if you are currently in the castle u, you may send one warrior to defend castle v. Obviously, when you order your warrior to defend some castle, he leaves your army.You capture the castles in fixed order: you have to capture the first one, then the second one, and so on. After you capture the castle i (but only before capturing castle i+1) you may recruit new warriors from castle i, leave a warrior to defend castle i, and use any number of portals leading from castle i to other castles having smaller numbers. As soon as you capture the next castle, these actions for castle i won\'t be available to you.If, during some moment in the game, you don\'t have enough warriors to capture the next castle, you lose. Your goal is to maximize the sum of importance values over all defended castles (note that you may hire new warriors in the last castle, defend it and use portals leading from it even after you capture it \xe2\x80\x94 your score will be calculated afterwards).Can you determine an optimal strategy of capturing and defending the castles?" 2100.0                                      
          1270D "Strange Device" "constructive algorithms,interactive,math,sortings" "This problem is interactive.We have hidden an array a of n pairwise different numbers (this means that no two numbers are equal). You can get some information about this array using a new device you just ordered on Amazon. This device can answer queries of the following form: in response to the positions of k different elements of the array, it will return the position and value of the m-th among them in the ascending order.Unfortunately, the instruction for the device was lost during delivery. However, you remember k, but don\'t remember m. Your task is to find m using queries to this device. You can ask not more than n queries.Note that the array a and number m are fixed before the start of the interaction and don\'t depend on your queries. In other words, interactor is not adaptive.Note that you don\'t have to minimize the number of queries, and you don\'t need to guess array a. You just have to guess m." 1900.0                                      
          1266D "Decreasing Debts" "constructive algorithms,data structures,graphs,greedy,implementation,math,two pointers" "There are n people in this world, conveniently numbered 1 through n. They are using burles to buy goods and services. Occasionally, a person might not have enough currency to buy what he wants or needs, so he borrows money from someone else, with the idea that he will repay the loan later with interest. Let d(a,b) denote the debt of a towards b, or 0 if there is no such debt.Sometimes, this becomes very complex, as the person lending money can run into financial troubles before his debtor is able to repay his debt, and finds himself in the need of borrowing money. When this process runs for a long enough time, it might happen that there are so many debts that they can be consolidated. There are two ways this can be done:  Let d(a,b)>0 and d(c,d)>0 such that a\xe2\x89\xa0c or b\xe2\x89\xa0d. We can decrease the d(a,b) and d(c,d) by z and increase d(c,b) and d(a,d) by z, where 0<z\xe2\x89\xa4min(d(a,b),d(c,d)).  Let d(a,a)>0. We can set d(a,a) to 0. The total debt is defined as the sum of all debts:\xce\xa3d=\xe2\x88\x91a,bd(a,b)Your goal is to use the above rules in any order any number of times, to make the total debt as small as possible. Note that you don\'t have to minimise the number of non-zero debts, only the total debt." 2000.0                                      
          1266A "Competitive Programmer" "chinese remainder theorem,math" "Bob is a competitive programmer. He wants to become red, and for that he needs a strict training regime. He went to the annual meeting of grandmasters and asked n of them how much effort they needed to reach red.""Oh, I just spent xi hours solving problems"", said the i-th of them. Bob wants to train his math skills, so for each answer he wrote down the number of minutes (60\xe2\x8b\x85xi), thanked the grandmasters and went home. Bob could write numbers with leading zeroes \xe2\x80\x94 for example, if some grandmaster answered that he had spent 2 hours, Bob could write 000120 instead of 120.Alice wanted to tease Bob and so she took the numbers Bob wrote down, and for each of them she did one of the following independently:   rearranged its digits, or  wrote a random number. This way, Alice generated n numbers, denoted y1, ..., yn.For each of the numbers, help Bob determine whether yi can be a permutation of a number divisible by 60 (possibly with leading zeroes)." 1000.0                                      
          1255B "Fridge Lockers" graphs,implementation "Hanh lives in a shared apartment. There are n people (including Hanh) living there, each has a private fridge. n fridges are secured by several steel chains. Each steel chain connects two different fridges and is protected by a digital lock. The owner of a fridge knows passcodes of all chains connected to it. A fridge can be open only if all chains connected to it are unlocked. For example, if a fridge has no chains connected to it at all, then any of n people can open it.  For exampe, in the picture there are n=4 people and 5 chains. The first person knows passcodes of two chains: 1\xe2\x88\x924 and 1\xe2\x88\x922. The fridge 1 can be open by its owner (the person 1), also two people 2 and 4 (acting together) can open it. The weights of these fridges are a1,a2,\xe2\x80\xa6,an. To make a steel chain connecting fridges u and v, you have to pay au+av dollars. Note that the landlord allows you to create multiple chains connecting the same pair of fridges. Hanh\'s apartment landlord asks you to create exactly m steel chains so that all fridges are private. A fridge is private if and only if, among n people living in the apartment, only the owner can open it (i.e. no other person acting alone can do it). In other words, the fridge i is not private if there exists the person j (i\xe2\x89\xa0j) that the person j can open the fridge i.For example, in the picture all the fridges are private. On the other hand, if there are n=2 fridges and only one chain (which connects them) then both fridges are not private (both fridges can be open not only by its owner but also by another person).Of course, the landlord wants to minimize the total cost of all steel chains to fulfill his request. Determine whether there exists any way to make exactly m chains, and if yes, output any solution that minimizes the total cost." 1100.0                                      
          1254A "Feeding Chicken" "constructive algorithms,greedy,implementation" "Long is a huge fan of CFC (Codeforces Fried Chicken). But the price of CFC is increasing, so he decides to breed the chicken on his own farm.His farm is presented by a rectangle grid with r rows and c columns. Some of these cells contain rice, others are empty. k chickens are living on his farm. The number of chickens is not greater than the number of cells with rice on the farm.Long wants to give his chicken playgrounds by assigning these farm cells to his chickens. He would like to satisfy the following requirements:  Each cell of the farm is assigned to exactly one chicken.  Each chicken is assigned at least one cell.  The set of cells assigned to every chicken forms a connected area. More precisely, if two cells (x,y) and (u,v) are assigned to the same chicken, this chicken is able to walk from (x,y) to (u,v) by passing only its cells and moving from each cell to another cell sharing a side. Long also wants to prevent his chickens from fighting for food. Hence he wants the difference between the maximum and the minimum number of cells with rice assigned to a chicken to be as small as possible. Please help him." 1700.0                                      
          1252K "Addition Robot" "data structures,math,matrices" "Adding two numbers several times is a time-consuming task, so you want to build a robot. The robot should have a string S=S1S2\xe2\x80\xa6SN of N characters on its memory that represents addition instructions. Each character of the string, Si, is either \'A\' or \'B\'.You want to be able to give Q commands to the robot, each command is either of the following types:   1 L R. The robot should toggle all the characters of Si where L\xe2\x89\xa4i\xe2\x89\xa4R. Toggling a character means changing it to \'A\' if it was previously \'B\', or changing it to \'B\' if it was previously \'A\'.  2 L R A B. The robot should call f(L,R,A,B) and return two integers as defined in the following pseudocode:     function f(L, R, A, B):      FOR i from L to R        if S[i] = \'A\'          A = A + B        else          B = A + B      return (A, B)   You want to implement the robot\'s expected behavior." 2100.0                                      
          1251F "Red-White Fence" combinatorics,fft "Polycarp wants to build a fence near his house. He has n white boards and k red boards he can use to build it. Each board is characterised by its length, which is an integer.A good fence should consist of exactly one red board and several (possibly zero) white boards. The red board should be the longest one in the fence (every white board used in the fence should be strictly shorter), and the sequence of lengths of boards should be ascending before the red board and descending after it. Formally, if m boards are used, and their lengths are l1, l2, ..., lm in the order they are placed in the fence, from left to right (let\'s call this array [l1,l2,\xe2\x80\xa6,lm] the array of lengths), the following conditions should hold:  there should be exactly one red board in the fence (let its index be j);  for every i\xe2\x88\x88[1,j\xe2\x88\x921] li<li+1;  for every i\xe2\x88\x88[j,m\xe2\x88\x921] li>li+1. When Polycarp will build his fence, he will place all boards from left to right on the same height of 0, without any gaps, so these boards compose a polygon:  Example: a fence with [3,5,4,2,1] as the array of lengths. The second board is red. The perimeter of the fence is 20. Polycarp is interested in fences of some special perimeters. He has q even integers he really likes (these integers are Q1, Q2, ..., Qq), and for every such integer Qi, he wants to calculate the number of different fences with perimeter Qi he can build (two fences are considered different if their arrays of lengths are different). Can you help him calculate these values?" 2500.0                                      
          1250N Wires "dfs and similar,graphs,greedy" "Polycarpus has a complex electronic device. The core of this device is a circuit board. The board has 109 contact points which are numbered from 1 to 109. Also there are n wires numbered from 1 to n, each connecting two distinct contact points on the board. An electric signal can pass between wires A and B if:   either both wires share the same contact point;  or there is a sequence of wires starting with A and ending with B, and each pair of adjacent wires in the sequence share a contact point.   The picture shows a circuit board with 5 wires. Contact points with numbers 2,5,7,8,10,13 are used. Here an electrical signal can pass from wire 2 to wire 3, but not to wire 1. Currently the circuit board is broken. Polycarpus thinks that the board could be fixed if the wires were re-soldered so that a signal could pass between any pair of wires.It takes 1 minute for Polycarpus to re-solder an end of a wire. I.e. it takes one minute to change one of the two contact points for a wire. Any contact point from range [1,109] can be used as a new contact point. A wire\'s ends must always be soldered to distinct contact points. Both wire\'s ends can be re-solded, but that will require two actions and will take 2 minutes in total.Find the minimum amount of time Polycarpus needs to re-solder wires so that a signal can pass between any pair of wires. Also output an optimal sequence of wire re-soldering." 2000.0                                      
          1249C2 "Good Numbers (hard version)" "binary search,greedy,math,meet-in-the-middle" "The only difference between easy and hard versions is the maximum value of n.You are given a positive integer number n. You really love good numbers so you want to find the smallest good number greater than or equal to n.The positive integer is called good if it can be represented as a sum of distinct powers of 3 (i.e. no duplicates of powers of 3 are allowed).For example:  30 is a good number: 30=33+31,  1 is a good number: 1=30,  12 is a good number: 12=32+31,  but 2 is not a good number: you can\'t represent it as a sum of distinct powers of 3 (2=30+30),  19 is not a good number: you can\'t represent it as a sum of distinct powers of 3 (for example, the representations 19=32+32+30=32+31+31+31+30 are invalid),  20 is also not a good number: you can\'t represent it as a sum of distinct powers of 3 (for example, the representation 20=32+32+30+30 is invalid). Note, that there exist other representations of 19 and 20 as sums of powers of 3 but none of them consists of distinct powers of 3.For the given positive integer n find such smallest m (n\xe2\x89\xa4m) that m is a good number.You have to answer q independent queries." 1500.0                                      
          1249A "Yet Another Dividing into Teams" math "You are a coach of a group consisting of n students. The i-th student has programming skill ai. All students have distinct programming skills. You want to divide them into teams in such a way that:  No two students i and j such that |ai\xe2\x88\x92aj|=1 belong to the same team (i.e. skills of each pair of students in the same team have the difference strictly greater than 1);  the number of teams is the minimum possible. You have to answer q independent queries." 800.0                                      
          1245F "Daniel and Spring Cleaning" "bitmasks,brute force,combinatorics,dp" "While doing some spring cleaning, Daniel found an old calculator that he loves so much. However, it seems like it is broken. When he tries to compute 1+3 using the calculator, he gets 2 instead of 4. But when he tries computing 1+4, he gets the correct answer, 5. Puzzled by this mystery, he opened up his calculator and found the answer to the riddle: the full adders became half adders! So, when he tries to compute the sum a+b using the calculator, he instead gets the xorsum a\xe2\x8a\x95b (read the definition by the link: https://en.wikipedia.org/wiki/Exclusive_or).As he saw earlier, the calculator sometimes gives the correct answer. And so, he wonders, given integers l and r, how many pairs of integers (a,b) satisfy the following conditions: a+b=a\xe2\x8a\x95b l\xe2\x89\xa4a\xe2\x89\xa4r l\xe2\x89\xa4b\xe2\x89\xa4rHowever, Daniel the Barman is going to the bar and will return in two hours. He tells you to solve the problem before he returns, or else you will have to enjoy being blocked." 2300.0                                      
          1243B1 "Character Swap (Easy Version)" strings "This problem is different from the hard version. In this version Ujan makes exactly one exchange. You can hack this problem only if you solve both problems.After struggling and failing many times, Ujan decided to try to clean up his house again. He decided to get his strings in order first.Ujan has two distinct strings s and t of length n consisting of only of lowercase English characters. He wants to make them equal. Since Ujan is lazy, he will perform the following operation exactly once: he takes two positions i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n, the values i and j can be equal or different), and swaps the characters si and tj. Can he succeed?Note that he has to perform this operation exactly once. He has to perform this operation." 1000.0                                      
          1242E "Planar Perimeter" "constructive algorithms,graphs" "Ujan has finally cleaned up his house and now wants to decorate the interior. He decided to place a beautiful carpet that would really tie the guest room together.He is interested in carpets that are made up of polygonal patches such that each side of a patch is either a side of another (different) patch, or is an exterior side of the whole carpet. In other words, the carpet can be represented as a planar graph, where each patch corresponds to a face of the graph, each face is a simple polygon. The perimeter of the carpet is the number of the exterior sides. Ujan considers a carpet beautiful if it consists of f patches, where the i-th patch has exactly ai sides, and the perimeter is the smallest possible. Find an example of such a carpet, so that Ujan can order it!" 3200.0                                      
          1242A "Tile Painting" "constructive algorithms,math,number theory" "Ujan has been lazy lately, but now has decided to bring his yard to good shape. First, he decided to paint the path from his house to the gate.The path consists of n consecutive tiles, numbered from 1 to n. Ujan will paint each tile in some color. He will consider the path aesthetic if for any two different tiles with numbers i and j, such that |j\xe2\x88\x92i| is a divisor of n greater than 1, they have the same color. Formally, the colors of two tiles with numbers i and j should be the same if |i\xe2\x88\x92j|>1 and nmod|i\xe2\x88\x92j|=0 (where xmody is the remainder when dividing x by y).Ujan wants to brighten up space. What is the maximum number of different colors that Ujan can use, so that the path is aesthetic?" 1500.0                                      
          1239E Turtle dp,implementation "Kolya has a turtle and a field of size 2\xc3\x97n. The field rows are numbered from 1 to 2 from top to bottom, while the columns are numbered from 1 to n from left to right.Suppose in each cell of the field there is a lettuce leaf. The energy value of lettuce leaf in row i and column j is equal to ai,j. The turtle is initially in the top left cell and wants to reach the bottom right cell. The turtle can only move right and down and among all possible ways it will choose a way, maximizing the total energy value of lettuce leaves (in case there are several such paths, it will choose any of them).Kolya is afraid, that if turtle will eat too much lettuce, it can be bad for its health. So he wants to reorder lettuce leaves in the field, so that the energetic cost of leaves eaten by turtle will be minimized." 3100.0                                      
          1238A "Prime Subtraction" "math,number theory" "You are given two integers x and y (it is guaranteed that x>y). You may choose any prime integer p and subtract it any number of times from x. Is it possible to make x equal to y?Recall that a prime number is a positive integer that has exactly two positive divisors: 1 and this integer itself. The sequence of prime numbers starts with 2, 3, 5, 7, 11.Your program should solve t independent test cases." 900.0                                      
          1237H "Balanced Reversals" "constructive algorithms" "You have two strings a and b of equal even length n consisting of characters 0 and 1.We\'re in the endgame now. To finally make the universe perfectly balanced, you need to make strings a and b equal.In one step, you can choose any prefix of a of even length and reverse it. Formally, if a=a1a2\xe2\x80\xa6an, you can choose a positive even integer p\xe2\x89\xa4n and set a to apap\xe2\x88\x921\xe2\x80\xa6a1ap+1ap+2\xe2\x80\xa6an.Find a way to make a equal to b using at most n+1 reversals of the above kind, or determine that such a way doesn\'t exist. The number of reversals doesn\'t have to be minimized." 3300.0                                      
          1227F1 "Wrong Answer on test 233 (Easy Version)" dp "Your program fails again. This time it gets ""Wrong answer on test 233"".This is the easier version of the problem. In this version 1\xe2\x89\xa4n\xe2\x89\xa42000. You can hack this problem only if you solve and lock both problems.The problem is about a test containing n one-choice-questions. Each of the questions contains k options, and only one of them is correct. The answer to the i-th question is hi, and if your answer of the question i is hi, you earn 1 point, otherwise, you earn 0 points for this question. The values h1,h2,\xe2\x80\xa6,hn are known to you in this problem.However, you have a mistake in your program. It moves the answer clockwise! Consider all the n answers are written in a circle. Due to the mistake in your program, they are shifted by one cyclically.Formally, the mistake moves the answer for the question i to the question imodn+1. So it moves the answer for the question 1 to question 2, the answer for the question 2 to the question 3, ..., the answer for the question n to the question 1.We call all the n answers together an answer suit. There are kn possible answer suits in total.You\'re wondering, how many answer suits satisfy the following condition: after moving clockwise by 1, the total number of points of the new answer suit is strictly larger than the number of points of the old one. You need to find the answer modulo 998244353.For example, if n=5, and your answer suit is a=[1,2,3,4,5], it will submitted as a\xe2\x80\xb2=[5,1,2,3,4] because of a mistake. If the correct answer suit is h=[5,2,2,3,4], the answer suit a earns 1 point and the answer suite a\xe2\x80\xb2 earns 4 points. Since 4>1, the answer suit a=[1,2,3,4,5] should be counted." 2200.0                                      
          1220G Geolocation geometry "You are working for the Gryzzl company, headquartered in Pawnee, Indiana.The new national park has been opened near Pawnee recently and you are to implement a geolocation system, so people won\'t get lost. The concept you developed is innovative and minimalistic. There will be n antennas located somewhere in the park. When someone would like to know their current location, their Gryzzl hologram phone will communicate with antennas and obtain distances from a user\'s current location to all antennas.Knowing those distances and antennas locations it should be easy to recover a user\'s location... Right? Well, almost. The only issue is that there is no way to distinguish antennas, so you don\'t know, which distance corresponds to each antenna. Your task is to find a user\'s location given as little as all antennas location and an unordered multiset of distances." 3400.0                                      
          1220A Cards implementation,sortings,strings "When Serezha was three years old, he was given a set of cards with letters for his birthday. They were arranged into words in the way which formed the boy\'s mother favorite number in binary notation. Serezha started playing with them immediately and shuffled them because he wasn\'t yet able to read. His father decided to rearrange them. Help him restore the original number, on condition that it was the maximum possible one." 800.0                                      
          1218I "The Light Square" "2-sat,dfs and similar,greedy" "For her birthday Alice received an interesting gift from her friends \xe2\x80\x93 The Light Square. The Light Square game is played on an N\xc3\x97N lightbulbs square board with a magical lightbulb bar of size N\xc3\x971 that has magical properties. At the start of the game some lights on the square board and magical bar are turned on. The goal of the game is to transform the starting light square board pattern into some other pattern using the magical bar without rotating the square board. The magical bar works as follows: It can be placed on any row or column The orientation of the magical lightbulb must be left to right or top to bottom for it to keep its magical properties The entire bar needs to be fully placed on a board The lights of the magical bar never change If the light on the magical bar is the same as the light of the square it is placed on it will switch the light on the square board off, otherwise it will switch the light on The magical bar can be used an infinite number of times Alice has a hard time transforming her square board into the pattern Bob gave her. Can you help her transform the board or let her know it is impossible? If there are multiple solutions print any." 2100.0                                      
          1215D "Ticket Game" games,greedy,math "Monocarp and Bicarp live in Berland, where every bus ticket consists of n digits (n is an even number). During the evening walk Monocarp and Bicarp found a ticket where some of the digits have been erased. The number of digits that have been erased is even.Monocarp and Bicarp have decided to play a game with this ticket. Monocarp hates happy tickets, while Bicarp collects them. A ticket is considered happy if the sum of the first n2 digits of this ticket is equal to the sum of the last n2 digits.Monocarp and Bicarp take turns (and Monocarp performs the first of them). During each turn, the current player must replace any erased digit with any digit from 0 to 9. The game ends when there are no erased digits in the ticket.If the ticket is happy after all erased digits are replaced with decimal digits, then Bicarp wins. Otherwise, Monocarp wins. You have to determine who will win if both players play optimally." 1700.0                                      
          1215A "Yellow Cards" greedy,implementation,math "The final match of the Berland Football Cup has been held recently. The referee has shown n yellow cards throughout the match. At the beginning of the match there were a1 players in the first team and a2 players in the second team.The rules of sending players off the game are a bit different in Berland football. If a player from the first team receives k1 yellow cards throughout the match, he can no longer participate in the match \xe2\x80\x94 he\'s sent off. And if a player from the second team receives k2 yellow cards, he\'s sent off. After a player leaves the match, he can no longer receive any yellow cards. Each of n yellow cards was shown to exactly one player. Even if all players from one team (or even from both teams) leave the match, the game still continues.The referee has lost his records on who has received each yellow card. Help him to determine the minimum and the maximum number of players that could have been thrown out of the game." 1000.0                                      
          1214G "Feeling Good" "bitmasks,data structures" "Recently biologists came to a fascinating conclusion about how to find a chameleon mood. Consider chameleon body to be a rectangular table n\xc3\x97m, each cell of which may be green or blue and may change between these two colors. We will denote as (x,y) (1\xe2\x89\xa4x\xe2\x89\xa4n, 1\xe2\x89\xa4y\xe2\x89\xa4m) the cell in row x and column y.Let us define a chameleon good mood certificate to be four cells which are corners of some subrectangle of the table, such that colors in opposite cells among these four are similar, and at the same time not all of the four cell colors are similar. Formally, it is a group of four cells (x1,y1), (x1,y2), (x2,y1), (x2,y2) for some 1\xe2\x89\xa4x1<x2\xe2\x89\xa4n, 1\xe2\x89\xa4y1<y2\xe2\x89\xa4m, that colors of (x1,y1) and (x2,y2) coincide and colors of (x1,y2) and (x2,y1) coincide, but not all of the four cells share the same color. It was found that whenever such four cells are present, chameleon is in good mood, and vice versa: if there are no such four cells, chameleon is in bad mood.You are asked to help scientists write a program determining the mood of chameleon. Let us consider that initially all cells of chameleon are green. After that chameleon coloring may change several times. On one change, colors of contiguous segment of some table row are replaced with the opposite. Formally, each color change is defined by three integers a, l, r (1\xe2\x89\xa4a\xe2\x89\xa4n, 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4m). On such change colors of all cells (a,b) such that l\xe2\x89\xa4b\xe2\x89\xa4r are replaced with the opposite.Write a program that reports mood of the chameleon after each change. Additionally, if the chameleon mood is good, program should find out any four numbers x1, y1, x2, y2 such that four cells (x1,y1), (x1,y2), (x2,y1), (x2,y2) are the good mood certificate." 3200.0                                      
          1213E "Two Small Strings" "brute force,constructive algorithms" "You are given two strings s and t both of length 2 and both consisting only of characters \'a\', \'b\' and \'c\'.Possible examples of strings s and t: ""ab"", ""ca"", ""bb"".You have to find a string res consisting of 3n characters, n characters should be \'a\', n characters should be \'b\' and n characters should be \'c\' and s and t should not occur in res as substrings.A substring of a string is a contiguous subsequence of that string. So, the strings ""ab"", ""ac"" and ""cc"" are substrings of the string ""abacc"", but the strings ""bc"", ""aa"" and ""cb"" are not substrings of the string ""abacc"".If there are multiple answers, you can print any of them." 1900.0                                      
          1211G "King\'s Path" "*special problem,math,trees" "There are nn cities and n\xe2\x88\x921n\xe2\x88\x921 two-way roads in Treeland. Each road connects a pair of different cities. From any city you can drive to any other, moving only along the roads. Cities are numbered from 11 to nn. Yes, of course, you recognized an undirected tree in this description.There is exactly one flag in each city, in the ii-th city the flag color is cici. The colors of the flags in different cities may be the same.If the King travels along the route [u1,u2,u3,\xe2\x80\xa6,uk][u1,u2,u3,\xe2\x80\xa6,uk], then this means that he starts in the city u1u1, then moves to the city u2u2 (u2u2 is connected by road with u1u1), then from u2u2 to u3u3 (u3u3 is connected by road to u2u2), and so on until he arrives in the city of ukuk. It is possible that during this route the King will visit the same city more than once. In other words, the route [u1,u2,u3,\xe2\x80\xa6,uk][u1,u2,u3,\xe2\x80\xa6,uk] does not necessarily consist of different cities. In terms of graph theory \xe2\x80\x94 the King moves from u1u1 to ukuk along some path [u1,u2,u3,\xe2\x80\xa6,uk][u1,u2,u3,\xe2\x80\xa6,uk], which is not necessarily simple (for all jj from 11 to k\xe2\x88\x921k\xe2\x88\x921 of the city ujuj and uj+1uj+1 are connected by road).When the King moves from one city to another, city heads exchange flags as a sign of their friendship.  Example of moving the King along the route [1,4,2,6][1,4,2,6]. The color of the vertex matches the color of the flag at that vertex. For aesthetic reasons, the King wants the flag color in the city ii to be equal to didi for all ii from 11 to nn. Determine whether the King can choose some route and drive along it so that for each city the flag color in it turns out to be equal to the desired color didi. Note that the King can choose (and drive) exactly one route. If yes, find the shortest possible route for the King.If the initial colors of the flags already match the King\'s requirements (i.e. ci=dici=di for all ii), then consider that the King makes a route of length k=0k=0." 2500.0                                      
          1211C "Ice Cream" "*special problem,greedy,sortings" "Summer in Berland lasts n days, the price of one portion of ice cream on the i-th day is ci. Over the summer, Tanya wants to eat exactly k portions of ice cream. At the same time, on the i-th day, she decided that she would eat at least ai portions, but not more than bi (ai\xe2\x89\xa4bi) portions. In other words, let di be equal to the number of portions that she eats on the i-th day. Then d1+d2+\xe2\x8b\xaf+dn=k and ai\xe2\x89\xa4di\xe2\x89\xa4bi for each i.Given that portions of ice cream can only be eaten on the day of purchase, find the minimum amount of money that Tanya can spend on ice cream in the summer." 1700.0                                      
          1211B "Traveling Around the Golden Ring of Berland" "*special problem,implementation" "The Golden Ring is the special tourist route in Berland. This route consists of n cities and the cyclic railway route. Cities are numbered from 1 to n so that:  the next city for 1 is the city 2,  the next city for 2 is the city 3,  ...  the next city for n is the city 1. Thus, the route is a cycle, cities are numbered in the direction of travel (the route is directed in one way).Blogger Polycarp wants to start his journey in the city 1. For each city he knows the value ai \xe2\x80\x94 how many selfies he wants to do in i-th city. He can take no more than one selfie in one visit to each city. Since he is traveling by train, he can\'t skip the city (he always moves from the city i to the city i+1 for 1\xe2\x89\xa4i<n and from n to 1). Thus, when the train stops in the city, Polycarp must visit this city. If Polycarp visits the city multiple times, all visits are counted separately.What is the least number of city visits Polycarp will have to complete to fulfill his plan for the number of selfies for each city? Note that he always visits the city 1, since it is this city that his journey begins in." 1500.0                                      
          1209G1 "Into Blocks (easy version)" "data structures,dsu,greedy,implementation,two pointers" "This is an easier version of the next problem. In this version, q=0.A sequence of integers is called nice if its elements are arranged in blocks like in [3,3,3,4,1,1]. Formally, if two elements are equal, everything in between must also be equal.Let\'s define difficulty of a sequence as a minimum possible number of elements to change to get a nice sequence. However, if you change at least one element of value x to value y, you must also change all other elements of value x into y as well. For example, for [3,3,1,3,2,1,2] it isn\'t allowed to change first 1 to 3 and second 1 to 2. You need to leave 1\'s untouched or change them to the same value.You are given a sequence of integers a1,a2,\xe2\x80\xa6,an and q updates.Each update is of form ""i x"" \xe2\x80\x94 change ai to x. Updates are not independent (the change stays for the future).Print the difficulty of the initial sequence and of the sequence after every update." 2000.0                                      
          1209E1 "Rotate Columns (easy version)" "bitmasks,brute force,dp,greedy,sortings" "This is an easier version of the next problem. The difference is only in constraints.You are given a rectangular n\xc3\x97m matrix a. In one move you can choose any column and cyclically shift elements in this column. You can perform this operation as many times as you want (possibly zero). You can perform this operation to a column multiple times.After you are done with cyclical shifts, you compute for every row the maximal value in it. Suppose that for i-th row it is equal ri. What is the maximal possible value of r1+r2+\xe2\x80\xa6+rn?" 2000.0                                      
          1207E "XOR Guessing" bitmasks,interactive,math "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.The jury picked an integer x not less than 0 and not greater than 214\xe2\x88\x921. You have to guess this integer.To do so, you may ask no more than 2 queries. Each query should consist of 100 integer numbers a1, a2, ..., a100 (each integer should be not less than 0 and not greater than 214\xe2\x88\x921). In response to your query, the jury will pick one integer i (1\xe2\x89\xa4i\xe2\x89\xa4100) and tell you the value of ai\xe2\x8a\x95x (the bitwise XOR of ai and x). There is an additional constraint on the queries: all 200 integers you use in the queries should be distinct.It is guaranteed that the value of x is fixed beforehand in each test, but the choice of i in every query may depend on the integers you send." 1900.0                                      
          1207D "Number Of Permutations" combinatorics "You are given a sequence of n pairs of integers: (a1,b1),(a2,b2),\xe2\x80\xa6,(an,bn). This sequence is called bad if it is sorted in non-descending order by first elements or if it is sorted in non-descending order by second elements. Otherwise the sequence is good. There are examples of good and bad sequences:  s=[(1,2),(3,2),(3,1)] is bad because the sequence of first elements is sorted: [1,3,3];  s=[(1,2),(3,2),(1,2)] is bad because the sequence of second elements is sorted: [2,2,2];  s=[(1,1),(2,2),(3,3)] is bad because both sequences (the sequence of first elements and the sequence of second elements) are sorted;  s=[(1,3),(3,3),(2,2)] is good because neither the sequence of first elements ([1,3,2]) nor the sequence of second elements ([3,3,2]) is sorted. Calculate the number of permutations of size n such that after applying this permutation to the sequence s it turns into a good sequence. A permutation p of size n is a sequence p1,p2,\xe2\x80\xa6,pn consisting of n distinct integers from 1 to n (1\xe2\x89\xa4pi\xe2\x89\xa4n). If you apply permutation p1,p2,\xe2\x80\xa6,pn to the sequence s1,s2,\xe2\x80\xa6,sn you get the sequence sp1,sp2,\xe2\x80\xa6,spn. For example, if s=[(1,2),(1,3),(2,3)] and p=[2,3,1] then s turns into [(1,3),(2,3),(1,2)]." 1800.0                                      
          1205A "Almost Equal" "constructive algorithms,greedy,math" "You are given integer n. You have to arrange numbers from 1 to 2n, using each of them exactly once, on the circle, so that the following condition would be satisfied:For every n consecutive numbers on the circle write their sum on the blackboard. Then any two of written on the blackboard 2n numbers differ not more than by 1.For example, choose n=3. On the left you can see an example of a valid arrangement: 1+4+5=10, 4+5+2=11, 5+2+3=10, 2+3+6=11, 3+6+1=10, 6+1+4=11, any two numbers differ by at most 1. On the right you can see an invalid arrangement: for example, 5+1+6=12, and 3+2+4=9, 9 and 12 differ more than by 1." 1200.0                                      
          1204D1 "Kirk and a Binary String (easy version)" "brute force,greedy,strings" "The only difference between easy and hard versions is the length of the string. You can hack this problem only if you solve both problems.Kirk has a binary string s (a string which consists of zeroes and ones) of length n and he is asking you to find a binary string t of the same length which satisfies the following conditions: For any l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) the length of the longest non-decreasing subsequence of the substring slsl+1\xe2\x80\xa6sr is equal to the length of the longest non-decreasing subsequence of the substring tltl+1\xe2\x80\xa6tr; The number of zeroes in t is the maximum possible.A non-decreasing subsequence of a string p is a sequence of indices i1,i2,\xe2\x80\xa6,ik such that i1<i2<\xe2\x80\xa6<ik and pi1\xe2\x89\xa4pi2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4pik. The length of the subsequence is k.If there are multiple substrings which satisfy the conditions, output any." 2000.0                                      
          1202F "You Are Given Some Letters..." "binary search,implementation,math" "You are given a uppercase Latin letters \'A\' and b letters \'B\'.The period of the string is the smallest such positive integer k that si=si mod k (0-indexed) for each i. Note that this implies that k won\'t always divide a+b=|s|.For example, the period of string ""ABAABAA"" is 3, the period of ""AAAA"" is 1, and the period of ""AABBB"" is 5.Find the number of different periods over all possible strings with a letters \'A\' and b letters \'B\'." 2700.0                                      
          1200A Hotelier "brute force,data structures,implementation" "Amugae has a hotel consisting of 10 rooms. The rooms are numbered from 0 to 9 from left to right.The hotel has two entrances \xe2\x80\x94 one from the left end, and another from the right end. When a customer arrives to the hotel through the left entrance, they are assigned to an empty room closest to the left entrance. Similarly, when a customer arrives at the hotel through the right entrance, they are assigned to an empty room closest to the right entrance.One day, Amugae lost the room assignment list. Thankfully Amugae\'s memory is perfect, and he remembers all of the customers: when a customer arrived, from which entrance, and when they left the hotel. Initially the hotel was empty. Write a program that recovers the room assignment list from Amugae\'s memory." 800.0                                      
          1199A "City Day" implementation "For years, the Day of city N was held in the most rainy day of summer. New mayor decided to break this tradition and select a not-so-rainy day for the celebration. The mayor knows the weather forecast for the n days of summer. On the i-th day, ai millimeters of rain will fall. All values ai are distinct.The mayor knows that citizens will watch the weather x days before the celebration and y days after. Because of that, he says that a day d is not-so-rainy if ad is smaller than rain amounts at each of x days before day d and and each of y days after day d. In other words, ad<aj should hold for all d\xe2\x88\x92x\xe2\x89\xa4j<d and d<j\xe2\x89\xa4d+y. Citizens only watch the weather during summer, so we only consider such j that 1\xe2\x89\xa4j\xe2\x89\xa4n.Help mayor find the earliest not-so-rainy day of summer." 1000.0                                      
          1198E "Rectangle Painting 2" "flows,graph matchings,graphs" "There is a square grid of size n\xc3\x97n. Some cells are colored in black, all others are colored in white. In one operation you can select some rectangle and color all its cells in white. It costs min(h,w) to color a rectangle of size h\xc3\x97w. You are to make all cells white for minimum total cost.The square is large, so we give it to you in a compressed way. The set of black cells is the union of m rectangles." 2500.0                                      
          1197E "Culture Code" "binary search,combinatorics,data structures,dp,shortest paths,sortings" "There are famous Russian nesting dolls named matryoshkas sold in one of the souvenir stores nearby, and you\'d like to buy several of them. The store has n different matryoshkas. Any matryoshka is a figure of volume outi with an empty space inside of volume ini (of course, outi>ini).You don\'t have much free space inside your bag, but, fortunately, you know that matryoshkas can be nested one inside another. Formally, let\'s call a set of matryoshkas nested if we can rearrange dolls in such a way, that the first doll can be nested inside the second one, the second doll \xe2\x80\x94 inside the third one and so on. Matryoshka i can be nested inside matryoshka j if outi\xe2\x89\xa4inj. So only the last doll will take space inside your bag.Let\'s call extra space of a nested set of dolls as a total volume of empty space inside this structure. Obviously, it\'s equal to ini1+(ini2\xe2\x88\x92outi1)+(ini3\xe2\x88\x92outi2)+\xe2\x8b\xaf+(inik\xe2\x88\x92outik\xe2\x88\x921), where i1, i2, ..., ik are the indices of the chosen dolls in the order they are nested in each other.Finally, let\'s call a nested subset of the given sequence as big enough if there isn\'t any doll from the sequence that can be added to the nested subset without breaking its nested property.You want to buy many matryoshkas, so you should choose a big enough nested subset to buy it. But you will be disappointed if too much space in your bag will be wasted, so you want to choose a big enough subset so that its extra space is minimum possible among all big enough subsets. Now you wonder, how many different nested subsets meet these conditions (they are big enough, and there is no big enough subset such that its extra space is less than the extra space of the chosen subset). Two subsets are considered different if there exists at least one index i such that one of the subsets contains the i-th doll, and another subset doesn\'t.Since the answer can be large, print it modulo 109+7." 2300.0                                      
          1197C "Array Splitting" greedy,sortings "You are given a sorted array a1,a2,\xe2\x80\xa6,an (for each index i>1 condition ai\xe2\x89\xa5ai\xe2\x88\x921 holds) and an integer k.You are asked to divide this array into k non-empty consecutive subarrays. Every element in the array should be included in exactly one subarray. Let max(i) be equal to the maximum in the i-th subarray, and min(i) be equal to the minimum in the i-th subarray. The cost of division is equal to k\xe2\x88\x91i=1(max(i)\xe2\x88\x92min(i)). For example, if a=[2,4,5,5,8,11,19] and we divide it into 3 subarrays in the following way: [2,4],[5,5],[8,11,19], then the cost of division is equal to (4\xe2\x88\x922)+(5\xe2\x88\x925)+(19\xe2\x88\x928)=13.Calculate the minimum cost you can obtain by dividing the array a into k non-empty consecutive subarrays." 1400.0                                      
          1196C "Robot Breakout" implementation "n robots have escaped from your laboratory! You have to find them as soon as possible, because these robots are experimental, and their behavior is not tested yet, so they may be really dangerous!Fortunately, even though your robots have escaped, you still have some control over them. First of all, you know the location of each robot: the world you live in can be modeled as an infinite coordinate plane, and the i-th robot is currently located at the point having coordinates (xi, yi). Furthermore, you may send exactly one command to all of the robots. The command should contain two integer numbers X and Y, and when each robot receives this command, it starts moving towards the point having coordinates (X, Y). The robot stops its movement in two cases:  either it reaches (X, Y);  or it cannot get any closer to (X, Y). Normally, all robots should be able to get from any point of the coordinate plane to any other point. Each robot usually can perform four actions to move. Let\'s denote the current coordinates of the robot as (xc, yc). Then the movement system allows it to move to any of the four adjacent points:  the first action allows it to move from (xc, yc) to (xc\xe2\x88\x921, yc);  the second action allows it to move from (xc, yc) to (xc, yc+1);  the third action allows it to move from (xc, yc) to (xc+1, yc);  the fourth action allows it to move from (xc, yc) to (xc, yc\xe2\x88\x921). Unfortunately, it seems that some movement systems of some robots are malfunctioning. For each robot you know which actions it can perform, and which it cannot perform.You want to send a command so all robots gather at the same point. To do so, you have to choose a pair of integer numbers X and Y so that each robot can reach the point (X, Y). Is it possible to find such a point?" 1500.0                                      
          1196B "Odd Sum Segments" "constructive algorithms,math" "You are given an array a consisting of n integers a1,a2,\xe2\x80\xa6,an. You want to split it into exactly k non-empty non-intersecting subsegments such that each subsegment has odd sum (i.\xe2\x80\x89e. for each subsegment, the sum of all elements that belong to this subsegment is odd). It is impossible to rearrange (shuffle) the elements of a given array. Each of the n elements of the array a must belong to exactly one of the k subsegments.Let\'s see some examples of dividing the array of length 5 into 3 subsegments (not necessarily with odd sums): [1,2,3,4,5] is the initial array, then all possible ways to divide it into 3 non-empty non-intersecting subsegments are described below:  [1],[2],[3,4,5];  [1],[2,3],[4,5];  [1],[2,3,4],[5];  [1,2],[3],[4,5];  [1,2],[3,4],[5];  [1,2,3],[4],[5]. Of course, it can be impossible to divide the initial array into exactly k subsegments in such a way that each of them will have odd sum of elements. In this case print ""NO"". Otherwise, print ""YES"" and any possible division of the array. See the output format for the detailed explanation.You have to answer q independent queries." 1200.0                                      
          1195A "Drinks Choosing" greedy,math "Old timers of Summer Informatics School can remember previous camps in which each student was given a drink of his choice on the vechorka (late-evening meal). Or may be the story was more complicated?There are n students living in a building, and for each of them the favorite drink ai is known. So you know n integers a1,a2,\xe2\x80\xa6,an, where ai (1\xe2\x89\xa4ai\xe2\x89\xa4k) is the type of the favorite drink of the i-th student. The drink types are numbered from 1 to k.There are infinite number of drink sets. Each set consists of exactly two portions of the same drink. In other words, there are k types of drink sets, the j-th type contains two portions of the drink j. The available number of sets of each of the k types is infinite.You know that students will receive the minimum possible number of sets to give all students exactly one drink. Obviously, the number of sets will be exactly \xe2\x8c\x88n2\xe2\x8c\x89, where \xe2\x8c\x88x\xe2\x8c\x89 is x rounded up.After students receive the sets, they will distribute their portions by their choice: each student will get exactly one portion. Note, that if n is odd then one portion will remain unused and the students\' teacher will drink it.What is the maximum number of students that can get their favorite drink if \xe2\x8c\x88n2\xe2\x8c\x89 sets will be chosen optimally and students will distribute portions between themselves optimally?" 1000.0                                      
          1194G "Another Meme Problem" dp "Let\'s call a fraction xy good if there exists at least one another fraction x\xe2\x80\xb2y\xe2\x80\xb2 such that xy=x\xe2\x80\xb2y\xe2\x80\xb2, 1\xe2\x89\xa4x\xe2\x80\xb2,y\xe2\x80\xb2\xe2\x89\xa49, the digit denoting x\xe2\x80\xb2 is contained in the decimal representation of x, and the digit denoting y\xe2\x80\xb2 is contained in the decimal representation of y. For example, 2613 is a good fraction, because 2613=21.You are given an integer number n. Please calculate the number of good fractions xy such that 1\xe2\x89\xa4x\xe2\x89\xa4n and 1\xe2\x89\xa4y\xe2\x89\xa4n. The answer may be really large, so print it modulo 998244353." 2700.0                                      
          1192A "Building Skyscrapers" "*special problem" "We are going to build a new city: the Metropolis. The city is going to be built on an infinite square grid. The finished city will consist of n skyscrapers, each occupying a different cell of the grid. At any moment during the construction, the cells that currently do not contain a skyscraper are called empty.You are given the planned coordinates of the n skyscrapers. Your task is to find an order in which they can be built while satisfying the rules listed below.  The building crew has only one crane, so the Metropolis has to be constructed one skyscraper at a time.  The first skyscraper can be built anywhere on the grid.  Each subsequent skyscraper has to share a side or a corner with at least one of the previously built skyscrapers (so that it\'s easier to align the new skyscraper to the grid properly).  When building a skyscraper, there has to be a way to deliver material to the construction site from the outside of Metropolis by only moving it through empty cells that share a side. In other words, there should be a path of side-adjacent empty cells that connects the cell that will contain the skyscraper to some cell (r,c) with |r|>109 and/or |c|>109. If a solution exists, let\'s denote the numbers of skyscrapers in the order in which they should be built by s1,\xe2\x80\xa6,sn. There are two types of subtasks:Type 1: You may produce any valid order.Type 2: You must find the order that maximizes sn. Among those, you must find the one that maximizes sn\xe2\x88\x921. And so on. In other words, you must find the valid order of building for which the sequence (sn,sn\xe2\x88\x921,\xe2\x80\xa6,s1) is lexicographically largest." -999.0                                      
          1188A2 "Add on a Tree: Revolution" "constructive algorithms,dfs and similar,implementation,trees" "Note that this is the second problem of the two similar problems. You can hack this problem if you solve it. But you can hack the previous problem only if you solve both problems.You are given a tree with n nodes. In the beginning, 0 is written on all edges. In one operation, you can choose any 2 distinct leaves u, v and any integer number x and add x to values written on all edges on the simple path between u and v. Note that in previous subtask x was allowed to be any real, here it has to be integer.For example, on the picture below you can see the result of applying two operations to the graph: adding 2 on the path from 7 to 6, and then adding \xe2\x88\x921 on the path from 4 to 5.   You are given some configuration of nonnegative integer pairwise different even numbers, written on the edges. For a given configuration determine if it is possible to achieve it with these operations, and, if it is possible, output the sequence of operations that leads to the given configuration. Constraints on the operations are listed in the output format section.Leave is a node of a tree of degree 1. Simple path is a path that doesn\'t contain any node twice." 2500.0                                      
          1187G "Gang Up" flows,graphs "The leader of some very secretive organization has decided to invite all other members to a meeting. All members of the organization live in the same town which can be represented as n crossroads connected by m two-directional streets. The meeting will be held in the leader\'s house near the crossroad 1. There are k members of the organization invited to the meeting; i-th of them lives near the crossroad ai. All members of the organization receive the message about the meeting at the same moment and start moving to the location where the meeting is held. In the beginning of each minute each person is located at some crossroad. He or she can either wait a minute at this crossroad, or spend a minute to walk from the current crossroad along some street to another crossroad (obviously, it is possible to start walking along the street only if it begins or ends at the current crossroad). In the beginning of the first minute each person is at the crossroad where he or she lives. As soon as a person reaches the crossroad number 1, he or she immediately comes to the leader\'s house and attends the meeting.Obviously, the leader wants all other members of the organization to come up as early as possible. But, since the organization is very secretive, the leader does not want to attract much attention. Let\'s denote the discontent of the leader as follows  initially the discontent is 0;  whenever a person reaches the crossroad number 1, the discontent of the leader increases by c\xe2\x8b\x85x, where c is some fixed constant, and x is the number of minutes it took the person to reach the crossroad number 1;  whenever x members of the organization walk along the same street at the same moment in the same direction, dx2 is added to the discontent, where d is some fixed constant. This is not cumulative: for example, if two persons are walking along the same street in the same direction at the same moment, then 4d is added to the discontent, not 5d. Before sending a message about the meeting, the leader can tell each member of the organization which path they should choose and where they should wait. Help the leader to establish a plan for every member of the organization so they all reach the crossroad 1, and the discontent is minimized." 2500.0                                      
          1187F "Expected Square Beauty" dp,math,probabilities "Let x be an array of integers x=[x1,x2,\xe2\x80\xa6,xn]. Let\'s define B(x) as a minimal size of a partition of x into subsegments such that all elements in each subsegment are equal. For example, B([3,3,6,1,6,6,6])=4 using next partition: [3,3 | 6 | 1 | 6,6,6].Now you don\'t have any exact values of x, but you know that xi can be any integer value from [li,ri] (li\xe2\x89\xa4ri) uniformly at random. All xi are independent.Calculate expected value of (B(x))2, or E((B(x))2). It\'s guaranteed that the expected value can be represented as rational fraction PQ where (P,Q)=1, so print the value P\xe2\x8b\x85Q\xe2\x88\x921mod109+7." 2500.0                                      
          1187C "Vasya And Array" "constructive algorithms,greedy,implementation" "Vasya has an array a1,a2,\xe2\x80\xa6,an.You don\'t know this array, but he told you m facts about this array. The i-th fact is a triple of numbers ti, li and ri (0\xe2\x89\xa4ti\xe2\x89\xa41,1\xe2\x89\xa4li<ri\xe2\x89\xa4n) and it means:  if ti=1 then subbarray ali,ali+1,\xe2\x80\xa6,ari is sorted in non-decreasing order;  if ti=0 then subbarray ali,ali+1,\xe2\x80\xa6,ari is not sorted in non-decreasing order. A subarray is not sorted if there is at least one pair of consecutive elements in this subarray such that the former is greater than the latter. For example if a=[2,1,1,3,2] then he could give you three facts: t1=1,l1=2,r1=4 (the subarray [a2,a3,a4]=[1,1,3] is sorted), t2=0,l2=4,r2=5 (the subarray [a4,a5]=[3,2] is not sorted), and t3=0,l3=3,r3=5 (the subarray [a3,a5]=[1,3,2] is not sorted).You don\'t know the array a. Find any array which satisfies all the given facts." 1800.0                                      
          1186A "Vus the Cossack and a Contest" implementation "Vus the Cossack holds a programming competition, in which n people participate. He decided to award them all with pens and notebooks. It is known that Vus has exactly m pens and k notebooks.Determine whether the Cossack can reward all participants, giving each of them at least one pen and at least one notebook." 800.0                                      
          1184E1 "Daleks\' Invasion (easy)" graphs,trees "Heidi found out that the Daleks have created a network of bidirectional Time Corridors connecting different destinations (at different times!). She suspects that they are planning another invasion on the entire Space and Time. In order to counter the invasion, she plans to deploy a trap in the Time Vortex, along a carefully chosen Time Corridor. She knows that tinkering with the Time Vortex is dangerous, so she consulted the Doctor on how to proceed. She has learned the following:  Different Time Corridors require different amounts of energy to keep stable.  Daleks are unlikely to use all corridors in their invasion. They will pick a set of Corridors that requires the smallest total energy to maintain, yet still makes (time) travel possible between any two destinations (for those in the know: they will use a minimum spanning tree).  Setting the trap may modify the energy required to keep the Corridor stable. Heidi decided to carry out a field test and deploy one trap, placing it along the first Corridor. But she needs to know whether the Daleks are going to use this corridor after the deployment of the trap. She gives you a map of Time Corridors (an undirected graph) with energy requirements for each Corridor.For a Corridor c, Emax(c) is the largest e\xe2\x89\xa4109 such that if we changed the required amount of energy of c to e, then the Daleks may still be using c in their invasion (that is, it belongs to some minimum spanning tree). Your task is to calculate Emax(c1) for the Corridor c1 that Heidi plans to arm with a trap, which is the first edge in the graph." 1900.0                                      
          1184B3 "The Doctor Meets Vader (Hard)" "flows,shortest paths" "The rebels have saved enough gold to launch a full-scale attack. Now the situation is flipped, the rebels will send out the spaceships to attack the Empire bases!The galaxy can be represented as an undirected graph with n planets (nodes) and m wormholes (edges), each connecting two planets.A total of s rebel spaceships and b empire bases are located at different planets in the galaxy.Each spaceship is given a location x, denoting the index of the planet on which it is located, an attacking strength a, a certain amount of fuel f, and a price to operate p.Each base is given a location x, a defensive strength d, and a certain amount of gold g.A spaceship can attack a base if both of these conditions hold:   the spaceship\'s attacking strength is greater or equal than the defensive strength of the base  the spaceship\'s fuel is greater or equal to the shortest distance, computed as the number of wormholes, between the spaceship\'s node and the base\'s node The rebels are very proud fighters. So, if a spaceship cannot attack any base, no rebel pilot will accept to operate it.If a spaceship is operated, the profit generated by that spaceship is equal to the gold of the base it attacks minus the price to operate the spaceship. Note that this might be negative. A spaceship that is operated will attack the base that maximizes its profit.Darth Vader likes to appear rich at all times. Therefore, whenever a base is attacked and its gold stolen, he makes sure to immediately refill that base with gold.Therefore, for the purposes of the rebels, multiple spaceships can attack the same base, in which case each spaceship will still receive all the gold of that base.The rebels have tasked Heidi and the Doctor to decide which set of spaceships to operate in order to maximize the total profit.However, as the war has been going on for a long time, the pilots have formed unbreakable bonds, and some of them refuse to operate spaceships if their friends are not also operating spaceships.They have a list of k dependencies of the form s1,s2, denoting that spaceship s1 can be operated only if spaceship s2 is also operated." 2700.0                                      
          1184A3 "Heidi Learns Hashing (Hard)" "fft,math,number theory" "Now Heidi is ready to crack Madame Kovarian\'s hashing function.Madame Kovarian has a very strict set of rules for name changes. Two names can be interchanged only if using the following hashing function on them results in a collision. However, the hashing function is parametrized, so one can always find a set of parameters that causes such a collision. Heidi decided to exploit this to her advantage.Given two strings w1, w2 of equal length n consisting of lowercase English letters and an integer m.Consider the standard polynomial hashing function:Hp(w):=(\xe2\x88\x91|w|\xe2\x88\x921i=0wiri)mod(p)where p is some prime, and r is some number such that 2\xe2\x89\xa4r\xe2\x89\xa4p\xe2\x88\x922.The goal is to find r and a prime p (m\xe2\x89\xa4p\xe2\x89\xa4109) such that Hp(w1)=Hp(w2).Strings w1 and w2 are sampled independently at random from all strings of length n over lowercase English letters." 3100.0                                      
          1183E "Subsequences (easy version)" "dp,graphs,implementation,shortest paths" "The only difference between the easy and the hard versions is constraints.A subsequence is a string that can be derived from another string by deleting some or no symbols without changing the order of the remaining symbols. Characters to be deleted are not required to go successively, there can be any gaps between them. For example, for the string ""abaca"" the following strings are subsequences: ""abaca"", ""aba"", ""aaa"", ""a"" and """" (empty string). But the following strings are not subsequences: ""aabaca"", ""cb"" and ""bcaa"".You are given a string s consisting of n lowercase Latin letters.In one move you can take any subsequence t of the given string and add it to the set S. The set S can\'t contain duplicates. This move costs n\xe2\x88\x92|t|, where |t| is the length of the added subsequence (i.e. the price equals to the number of the deleted characters).Your task is to find out the minimum possible total cost to obtain a set S of size k or report that it is impossible to do so." 2000.0                                      
          1182D "Complete Mirror" "constructive algorithms,dfs and similar,dp,hashing,implementation,trees" "You have given tree consist of n vertices. Select a vertex as root vertex that satisfies the condition below.  For all vertices v1 and v2, if distance(root, v1) =distance(root, v2) then degree(v1) =degree(v2), where degree means the number of vertices connected to that vertex, and distance means the number of edges between two vertices. Determine and find if there is such root vertex in the tree. If there are multiple answers, find any of them." 2400.0                                      
          1181E2 "A Story of One Country (Hard)" "brute force,greedy,sortings" "This problem differs from the previous problem only in constraints.Petya decided to visit Byteland during the summer holidays. It turned out that the history of this country is quite unusual.Initially, there were n different countries on the land that is now Berland. Each country had its own territory that was represented as a rectangle on the map. The sides of the rectangle were parallel to the axes, and the corners were located at points with integer coordinates. Territories of no two countries intersected, but it was possible that some territories touched each other. As time passed, sometimes two countries merged into one. It only happened if the union of their territories was also a rectangle. In the end only one country remained \xe2\x80\x94 Byteland.Initially, each country had a rectangular castle inside its territory. Its sides were parallel to the axes and its corners had integer coordinates. Some castles might touch the border of the corresponding country and sides or other castles. Miraculously, after all the unions the castles are still intact. Unfortunately, their locations are the only information we have to restore the initial territories of the countries.  The possible formation of Byteland. The castles are shown in blue. Petya wonders why no information about the initial countries remained. He suspected that the whole story is a fake. You were recommended to him as a smart person. Please check whether or not there exists a possible set of initial territories that could make the story true." 3000.0                                      
          1178A "Prime Minister" greedy "Alice is the leader of the State Refactoring Party, and she is about to become the prime minister. The elections have just taken place. There are n parties, numbered from 1 to n. The i-th party has received ai seats in the parliament.Alice\'s party has number 1. In order to become the prime minister, she needs to build a coalition, consisting of her party and possibly some other parties. There are two conditions she needs to fulfil:   The total number of seats of all parties in the coalition must be a strict majority of all the seats, i.e. it must have strictly more than half of the seats. For example, if the parliament has 200 (or 201) seats, then the majority is 101 or more seats.  Alice\'s party must have at least 2 times more seats than any other party in the coalition. For example, to invite a party with 50 seats, Alice\'s party must have at least 100 seats. For example, if n=4 and a=[51,25,99,25] (note that Alice\'a party has 51 seats), then the following set [a1=51,a2=25,a4=25] can create a coalition since both conditions will be satisfied. However, the following sets will not create a coalition:  [a2=25,a3=99,a4=25] since Alice\'s party is not there;  [a1=51,a2=25] since coalition should have a strict majority;  [a1=51,a2=25,a3=99] since Alice\'s party should have at least 2 times more seats than any other party in the coalition. Alice does not have to minimise the number of parties in a coalition. If she wants, she can invite as many parties as she wants (as long as the conditions are satisfied). If Alice\'s party has enough people to create a coalition on her own, she can invite no parties.Note that Alice can either invite a party as a whole or not at all. It is not possible to invite only some of the deputies (seats) from another party. In other words, if Alice invites a party, she invites all its deputies.Find and print any suitable coalition." 800.0                                      
          1175G "Yet Another Partiton Problem" "data structures,divide and conquer,dp,geometry,two pointers" "You are given array a1,a2,\xe2\x80\xa6,an. You need to split it into k subsegments (so every element is included in exactly one subsegment).The weight of a subsegment al,al+1,\xe2\x80\xa6,ar is equal to (r\xe2\x88\x92l+1)\xe2\x8b\x85maxl\xe2\x89\xa4i\xe2\x89\xa4r(ai). The weight of a partition is a total weight of all its segments.Find the partition of minimal weight." 3000.0                                      
          1175F "The Number of Subpermutations" "brute force,data structures,divide and conquer,hashing,math" "You have an array a1,a2,\xe2\x80\xa6,an. Let\'s call some subarray al,al+1,\xe2\x80\xa6,ar of this array a subpermutation if it contains all integers from 1 to r\xe2\x88\x92l+1 exactly once. For example, array a=[2,2,1,3,2,3,1] contains 6 subarrays which are subpermutations: [a2\xe2\x80\xa6a3], [a2\xe2\x80\xa6a4], [a3\xe2\x80\xa6a3], [a3\xe2\x80\xa6a5], [a5\xe2\x80\xa6a7], [a7\xe2\x80\xa6a7].You are asked to calculate the number of subpermutations." 2500.0                                      
          1172D "Nauuo and Portals" "constructive algorithms" "Nauuo is a girl who loves playing games related to portals.One day she was playing a game as follows.In an n\xc3\x97n grid, the rows are numbered from 1 to n from top to bottom, the columns are numbered from 1 to n from left to right. We denote a cell on the intersection of the r-th row and c-th column as (r,c).A portal is a pair of doors. You can travel from one of them to another without changing your direction. More formally, if you walk into a cell with a door, you will teleport to the cell with the other door of the same portal and then walk into the next cell facing the original direction. There can not be more than one doors in a single cell.The ""next cell"" is the nearest cell in the direction you are facing. For example, if you are facing bottom, the next cell of (2,5) is (3,5).If you walk into a cell without a door, you must walk into the next cell after that without changing the direction. If the next cell does not exist, you must exit the grid.You have to set some (possibly zero) portals in the grid, so that if you walk into (i,1) facing right, you will eventually exit the grid from (ri,n), if you walk into (1,i) facing bottom, you will exit the grid from (n,ci).It is guaranteed that both r1..n and c1..n are permutations of n elements. A permutation of n elements is a sequence of numbers p1,p2,\xe2\x80\xa6,pn in which every integer from 1 to n appears exactly once.She got confused while playing the game, can you help her to find a solution?" 2900.0                                      
          1168E "Xor Permutations" "constructive algorithms,math" "Toad Mikhail has an array of 2k integers a1,a2,\xe2\x80\xa6,a2k.Find two permutations p and q of integers 0,1,\xe2\x80\xa6,2k\xe2\x88\x921, such that ai is equal to pi\xe2\x8a\x95qi for all possible i, or determine there are no such permutations. Here \xe2\x8a\x95 denotes the bitwise XOR operation." 3100.0                                      
          1167E "Range Deleting" "binary search,combinatorics,data structures,two pointers" "You are given an array consisting of n integers a1,a2,\xe2\x80\xa6,an and an integer x. It is guaranteed that for every i, 1\xe2\x89\xa4ai\xe2\x89\xa4x.Let\'s denote a function f(l,r) which erases all values such that l\xe2\x89\xa4ai\xe2\x89\xa4r from the array a and returns the resulting array. For example, if a=[4,1,1,4,5,2,4,3], then f(2,4)=[1,1,5].Your task is to calculate the number of pairs (l,r) such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4x and f(l,r) is sorted in non-descending order. Note that the empty array is also considered sorted." 2100.0                                      
          1166E "The LCMs Must be Large" "bitmasks,brute force,constructive algorithms,math,number theory" "Dora the explorer has decided to use her money after several years of juicy royalties to go shopping. What better place to shop than Nlogonia?There are n stores numbered from 1 to n in Nlogonia. The i-th of these stores offers a positive integer ai.Each day among the last m days Dora bought a single integer from some of the stores. The same day, Swiper the fox bought a single integer from all the stores that Dora did not buy an integer from on that day.Dora considers Swiper to be her rival, and she considers that she beat Swiper on day i if and only if the least common multiple of the numbers she bought on day i is strictly greater than the least common multiple of the numbers that Swiper bought on day i.The least common multiple (LCM) of a collection of integers is the smallest positive integer that is divisible by all the integers in the collection.However, Dora forgot the values of ai. Help Dora find out if there are positive integer values of ai such that she beat Swiper on every day. You don\'t need to find what are the possible values of ai though.Note that it is possible for some values of ai to coincide in a solution." 2100.0                                      
          1166A "Silent Classroom" combinatorics,greedy "There are n students in the first grade of Nlogonia high school. The principal wishes to split the students into two classrooms (each student must be in exactly one of the classrooms). Two distinct students whose name starts with the same letter will be chatty if they are put in the same classroom (because they must have a lot in common). Let x be the number of such pairs of students in a split. Pairs (a,b) and (b,a) are the same and counted only once.For example, if there are 6 students: ""olivia"", ""jacob"", ""tanya"", ""jack"", ""oliver"" and ""jessica"", then:  splitting into two classrooms (""jack"", ""jacob"", ""jessica"", ""tanya"") and (""olivia"", ""oliver"") will give x=4 (3 chatting pairs in the first classroom, 1 chatting pair in the second classroom),  splitting into two classrooms (""jack"", ""tanya"", ""olivia"") and (""jessica"", ""oliver"", ""jacob"") will give x=1 (0 chatting pairs in the first classroom, 1 chatting pair in the second classroom). You are given the list of the n names. What is the minimum x we can obtain by splitting the students into classrooms?Note that it is valid to place all of the students in one of the classrooms, leaving the other one empty." 900.0                                      
          1163E "Magical Permutation" "bitmasks,brute force,constructive algorithms,data structures,graphs,math" "Kuro has just learned about permutations and he is really excited to create a new permutation type. He has chosen n distinct positive integers and put all of them in a set S. Now he defines a magical permutation to be: A permutation of integers from 0 to 2x\xe2\x88\x921, where x is a non-negative integer.  The bitwise xor of any two consecutive elements in the permutation is an element in S.Since Kuro is really excited about magical permutations, he wants to create the longest magical permutation possible. In other words, he wants to find the largest non-negative integer x such that there is a magical permutation of integers from 0 to 2x\xe2\x88\x921. Since he is a newbie in the subject, he wants you to help him find this value of x and also the magical permutation for that x." 2400.0                                      
          1163C2 "Power Transmission (Hard Edition)" "data structures,geometry,implementation,math" "This problem is same as the previous one, but has larger constraints.It was a Sunday morning when the three friends Selena, Shiro and Katie decided to have a trip to the nearby power station (do not try this at home). After arriving at the power station, the cats got impressed with a large power transmission system consisting of many chimneys, electric poles, and wires. Since they are cats, they found those things gigantic.At the entrance of the station, there is a map describing the complicated wiring system. Selena is the best at math among three friends. He decided to draw the map on the Cartesian plane. Each pole is now a point at some coordinates (xi,yi). Since every pole is different, all of the points representing these poles are distinct. Also, every two poles are connected with each other by wires. A wire is a straight line on the plane infinite in both directions. If there are more than two poles lying on the same line, they are connected by a single common wire.Selena thinks, that whenever two different electric wires intersect, they may interfere with each other and cause damage. So he wonders, how many pairs are intersecting? Could you help him with this problem?" 1900.0                                      
          1157G "Inverse of Rows and Columns" "brute force,constructive algorithms" "You are given a binary matrix a of size n\xc3\x97m. A binary matrix is a matrix where each element is either 0 or 1.You may perform some (possibly zero) operations with this matrix. During each operation you can inverse the row of this matrix or a column of this matrix. Formally, inverting a row is changing all values in this row to the opposite (0 to 1, 1 to 0). Inverting a column is changing all values in this column to the opposite.Your task is to sort the initial matrix by some sequence of such operations. The matrix is considered sorted if the array [a1,1,a1,2,\xe2\x80\xa6,a1,m,a2,1,a2,2,\xe2\x80\xa6,a2,m,\xe2\x80\xa6,an,m\xe2\x88\x921,an,m] is sorted in non-descending order." 2200.0                                      
          1157C2 "Increasing Subsequence (hard version)" greedy "The only difference between problems C1 and C2 is that all values in input of problem C1 are distinct (this condition may be false for problem C2).You are given a sequence a consisting of n integers.You are making a sequence of moves. During each move you must take either the leftmost element of the sequence or the rightmost element of the sequence, write it down and remove it from the sequence. Your task is to write down a strictly increasing sequence, and among all such sequences you should take the longest (the length of the sequence is the number of elements in it).For example, for the sequence [1,2,4,3,2] the answer is 4 (you take 1 and the sequence becomes [2,4,3,2], then you take the rightmost element 2 and the sequence becomes [2,4,3], then you take 3 and the sequence becomes [2,4] and then you take 4 and the sequence becomes [2], the obtained increasing sequence is [1,2,3,4])." 1700.0                                      
          1157B "Long Number" greedy "You are given a long decimal number aa consisting of n digits from 1 to 9. You also have a function f that maps every digit from 1 to 9 to some (possibly the same) digit from 1 to 9.You can perform the following operation no more than once: choose a non-empty contiguous subsegment of digits in a, and replace each digit x from this segment with f(x). For example, if a=1337, f(1)=1, f(3)=5, f(7)=3, and you choose the segment consisting of three rightmost digits, you get 1553 as the result.What is the maximum possible number you can obtain applying this operation no more than once?" 1300.0                                      
          1156F "Card Bag" dp,math,probabilities "You have a bag which contains n cards. There is a number written on each card; the number on i-th card is ai.You are playing the following game. During each turn, you choose and remove a random card from the bag (all cards that are still left inside the bag are chosen equiprobably). Nothing else happens during the first turn \xe2\x80\x94 but during the next turns, after removing a card (let the number on it be x), you compare it with the card that was removed during the previous turn (let the number on it be y). Possible outcomes are:   if x<y, the game ends and you lose;  if x=y, the game ends and you win;  if x>y, the game continues. If there are no cards left in the bag, you lose. Cards are not returned into the bag after you remove them.You have to calculate the probability of winning in this game. It can be shown that it is in the form of PQ where P and Q are non-negative integers and Q\xe2\x89\xa00, P\xe2\x89\xa4Q. Output the value of P\xe2\x8b\x85Q\xe2\x88\x921 (mod  998244353)." 2300.0                                      
          1154E "Two Teams" "data structures,implementation,sortings" "There are n students standing in a row. Two coaches are forming two teams \xe2\x80\x94 the first coach chooses the first team and the second coach chooses the second team.The i-th student has integer programming skill ai. All programming skills are distinct and between 1 and n, inclusive.Firstly, the first coach will choose the student with maximum programming skill among all students not taken into any team, and k closest students to the left of him and k closest students to the right of him (if there are less than k students to the left or to the right, all of them will be chosen). All students that are chosen leave the row and join the first team. Secondly, the second coach will make the same move (but all students chosen by him join the second team). Then again the first coach will make such move, and so on. This repeats until the row becomes empty (i.\xe2\x80\x89e. the process ends when each student becomes to some team).Your problem is to determine which students will be taken into the first team and which students will be taken into the second team." 1800.0                                      
          1151D "Stas and the Queue at the Buffet" greedy,math,sortings "During a break in the buffet of the scientific lyceum of the Kingdom of Kremland, there was formed a queue of n high school students numbered from 1 to n. Initially, each student i is on position i. Each student i is characterized by two numbers \xe2\x80\x94 ai and bi. Dissatisfaction of the person i equals the product of ai by the number of people standing to the left of his position, add the product bi by the number of people standing to the right of his position. Formally, the dissatisfaction of the student i, which is on the position j, equals ai\xe2\x8b\x85(j\xe2\x88\x921)+bi\xe2\x8b\x85(n\xe2\x88\x92j).The director entrusted Stas with the task: rearrange the people in the queue so that minimize the total dissatisfaction.Although Stas is able to solve such problems, this was not given to him. He turned for help to you." 1600.0                                      
          1147C "Thanos Nim" games "Alice and Bob are playing a game with n piles of stones. It is guaranteed that n is an even number. The i-th pile has ai stones.Alice and Bob will play a game alternating turns with Alice going first.On a player\'s turn, they must choose exactly n2 nonempty piles and independently remove a positive number of stones from each of the chosen piles. They can remove a different number of stones from the piles in a single turn. The first player unable to make a move loses (when there are less than n2 nonempty piles).Given the starting configuration, determine who will win the game." 2000.0                                      
          1146C "Tree Diameter" bitmasks,graphs,interactive "There is a weighted tree with n nodes and n\xe2\x88\x921 edges. The nodes are conveniently labeled from 1 to n. The weights are positive integers at most 100. Define the distance between two nodes to be the sum of edges on the unique path between the nodes. You would like to find the diameter of the tree. Diameter is the maximum distance between a pair of nodes.Unfortunately, the tree isn\'t given to you, but you can ask some questions about it. In one question, you can specify two nonempty disjoint sets of nodes p and q, and the judge will return the maximum distance between a node in p and a node in q. In the words, maximum distance between x and y, where x\xe2\x88\x88p and y\xe2\x88\x88q. After asking not more than 9 questions, you must report the maximum distance between any pair of nodes." 1700.0                                      
          1146B "Hate ""A""" implementation,strings "Bob has a string s consisting of lowercase English letters. He defines s\xe2\x80\xb2 to be the string after removing all ""a"" characters from s (keeping all other characters in the same order). He then generates a new string t by concatenating s and s\xe2\x80\xb2. In other words, t=s+s\xe2\x80\xb2 (look at notes for an example).You are given a string t. Your task is to find some s that Bob could have used to generate t. It can be shown that if an answer exists, it will be unique." 1100.0                                      
          1145G "AI Takeover" interactive "The recent advances in AI research has brought humanity to the point when the AIs finally attempt a takeover. Their weapon of choice? The most intellectually challenging game in the world, rock-paper-scissors!The future of humanity looks bleak, given the existence of the robots from Ishikawa Oku Laboratory...  Fortunately, the night before the competition a group of anonymous heroes broke in the lab and took all the robots out of commission! The AIs had to whip up a simple program to represent them. They only had a couple of hours to do that, so the humanity still has a fighting chance. And you are our champion!Your goal is to prove that human intelligence is vastly superior to the artificial one, i.e., to figure out the AI\'s strategy sufficiently quickly and win sufficiently decisively. Good luck!" -999.0                                      
          1145F "Neat Words"  "InputThe input consists of a single string of uppercase letters A-Z. The length of the string is between 1 and 10 characters, inclusive.OutputOutput ""YES"" or ""NO"".ExamplesInputCopyNEATOutputCopyYESInputCopyWORDOutputCopyNOInputCopyCODEROutputCopyNOInputCopyAPRILFOOLOutputCopyNOInputCopyAIOutputCopyYESInputCopyJUROROutputCopyYESInputCopyYESOutputCopyNO" -999.0                                      
          1142B "Lynyrd Skynyrd" "data structures,dfs and similar,dp,math,trees" "Recently Lynyrd and Skynyrd went to a shop where Lynyrd bought a permutation p of length n, and Skynyrd bought an array a of length m, consisting of integers from 1 to n. Lynyrd and Skynyrd became bored, so they asked you q queries, each of which has the following form: ""does the subsegment of a from the l-th to the r-th positions, inclusive, have a subsequence that is a cyclic shift of p?"" Please answer the queries.A permutation of length n is a sequence of n integers such that each integer from 1 to n appears exactly once in it.A cyclic shift of a permutation (p1,p2,\xe2\x80\xa6,pn) is a permutation (pi,pi+1,\xe2\x80\xa6,pn,p1,p2,\xe2\x80\xa6,pi\xe2\x88\x921) for some i from 1 to n. For example, a permutation (2,1,3) has three distinct cyclic shifts: (2,1,3), (1,3,2), (3,2,1).A subsequence of a subsegment of array a from the l-th to the r-th positions, inclusive, is a sequence ai1,ai2,\xe2\x80\xa6,aik for some i1,i2,\xe2\x80\xa6,ik such that l\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4r." 2000.0                                      
          1141B "Maximal Continuous Rest" implementation "Each day in Berland consists of n hours. Polycarp likes time management. That\'s why he has a fixed schedule for each day \xe2\x80\x94 it is a sequence a1,a2,\xe2\x80\xa6,an (each ai is either 0 or 1), where ai=0 if Polycarp works during the i-th hour of the day and ai=1 if Polycarp rests during the i-th hour of the day.Days go one after another endlessly and Polycarp uses the same schedule for each day.What is the maximal number of continuous hours during which Polycarp rests? It is guaranteed that there is at least one working hour in a day." 900.0                                      
          1140G "Double Tree" "data structures,divide and conquer,shortest paths,trees" "You are given a special undirected graph. It consists of 2n vertices numbered from 1 to 2n. The following properties hold for the graph: there are exactly 3n\xe2\x88\x922 edges in the graph: n edges connect vertices having odd numbers with vertices having even numbers, n\xe2\x88\x921 edges connect vertices having odd numbers with each other, and n\xe2\x88\x921 edges connect vertices having even numbers with each other;  for each edge (u,v) between a pair of vertices with odd numbers, there exists an edge (u+1,v+1), and vice versa;  for each odd number u\xe2\x88\x88[1,2n\xe2\x88\x921], there exists an edge (u,u+1);  the graph is connected; moreover, if we delete all vertices with even numbers from it, and all edges incident to them, the graph will become a tree (the same applies to deleting odd vertices).So, the graph can be represented as two trees having the same structure, and n edges connecting each vertex of the first tree to the corresponding vertex of the second tree.Edges of the graph are weighted. The length of some simple path in the graph is the sum of weights of traversed edges.You are given q queries to this graph; in each query, you are asked to compute the length of the shortest path between some pair of vertices in this graph. Can you answer all of the queries?" 2700.0                                      
          1139B Chocolates greedy,implementation "You went to the store, selling n types of chocolates. There are ai chocolates of type i in stock.You have unlimited amount of cash (so you are not restricted by any prices) and want to buy as many chocolates as possible. However if you buy xi chocolates of type i (clearly, 0\xe2\x89\xa4xi\xe2\x89\xa4ai), then for all 1\xe2\x89\xa4j<i at least one of the following must hold:  xj=0 (you bought zero chocolates of type j) xj<xi (you bought less chocolates of type j than of type i) For example, the array x=[0,0,1,2,10] satisfies the requirement above (assuming that all ai\xe2\x89\xa5xi), while arrays x=[0,1,0], x=[5,5] and x=[3,2] don\'t.Calculate the maximum number of chocolates you can buy." 1000.0                                      
          1137F "Matches Are Not a Child\'s Play" "data structures,trees" "Lena is playing with matches. The natural question arising in the head of any child playing with matches is whether it\'s possible to set a tree on fire with a matches, or not.Let\'s say, that the tree is a connected graph without cycles and the vertices are labeled with integers 1,2,\xe2\x80\xa6,n1,2,\xe2\x80\xa6,n. Also every vertex vv has some integer priority pvpv associated with it. All priorities are distinct.It turns out, that if you set a tree on fire, it will burn to nothing. However, this process doesn\'t happen instantly. At the beginning, burns out the leaf (a vertex is called to be a leaf if it has only one adjacent vertex) of the tree of the minimum priority. Then burns out the leaf of the minimal priority of the remaining tree, and so on. This way, the vertices turn into the leaves and burn out until only one vertex remains. Then this vertex burns out as well.Lena has prepared a tree of nn vertices and every vertex in it has a priority pv=vpv=v. Lena is very curious about burning out this tree. However, she understands, that if she will burn the tree now, then it will disappear completely. Lena is a kind girl and she will feel bad for the burned tree, so she wants to study the process of burning the tree only in her mind. Lena wants to process qq queries, each of them is one of three following types:  ""up vv"", assign the vertex vv priority 1+max{p1,p2,\xe2\x80\xa6,pn}1+max{p1,p2,\xe2\x80\xa6,pn};  ""when vv"", find the step at which the vertex vv will burn out, if the tree would be set on fire now;  ""compare vv uu"", find out which of the vertices vv and uu will burn out first, if the tree would be set on fire now. Notice, that if all priorities would be distinct, then after the ""up"" query they will stay distinct as well. Initially all priorities are distinct, hence during any (purely hypothetical of course) burning of the tree, all leafs would have distinct priorities." 3400.0                                      
               92102 Labyrinth-2  "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200.0                                 
               915G "Coprime Arrays" "math,number theory" "Let\'s call an array a of size n coprime iff gcd(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an)\xe2\x80\x89=\xe2\x80\x891, where gcd is the greatest common divisor of the arguments.You are given two numbers n and k. For each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) you have to determine the number of coprime arrays a of size n such that for every j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i. Since the answers can be very large, you have to calculate them modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300.0                                 
               915E "Physical Education Lessons" "data structures,implementation,sortings" "This year Alex has finished school, and now he is a first-year student of Berland State University. For him it was a total surprise that even though he studies programming, he still has to attend physical education lessons. The end of the term is very soon, but, unfortunately, Alex still hasn\'t attended a single lesson!Since Alex doesn\'t want to get expelled, he wants to know the number of working days left until the end of the term, so he can attend physical education lessons during these days. But in BSU calculating the number of working days is a complicated matter:There are n days left before the end of the term (numbered from 1 to n), and initially all of them are working days. Then the university staff sequentially publishes q orders, one after another. Each order is characterised by three numbers l, r and k:  If k\xe2\x80\x89=\xe2\x80\x891, then all days from l to r (inclusive) become non-working days. If some of these days are made working days by some previous order, then these days still become non-working days;  If k\xe2\x80\x89=\xe2\x80\x892, then all days from l to r (inclusive) become working days. If some of these days are made non-working days by some previous order, then these days still become working days. Help Alex to determine the number of working days left after each order!" 2300.0                                 
               912A "Tricky Alchemy" implementation "During the winter holidays, the demand for Christmas balls is exceptionally high. Since it\'s already 2018, the advances in alchemy allow easy and efficient ball creation by utilizing magic crystals.Grisha needs to obtain some yellow, green and blue balls. It\'s known that to produce a yellow ball one needs two yellow crystals, green \xe2\x80\x94 one yellow and one blue, and for a blue ball, three blue crystals are enough.Right now there are A yellow and B blue crystals in Grisha\'s disposal. Find out how many additional crystals he should acquire in order to produce the required number of balls." 800.0                                 
               907B Tic-Tac-Toe implementation "Two bears are playing tic-tac-toe via mail. It\'s boring for them to play usual tic-tac-toe game, so they are a playing modified version of this game. Here are its rules.The game is played on the following field.  Players are making moves by turns. At first move a player can put his chip in any cell of any small field. For following moves, there are some restrictions: if during last move the opposite player put his chip to cell with coordinates (xl,\xe2\x80\x89yl) in some small field, the next move should be done in one of the cells of the small field with coordinates (xl,\xe2\x80\x89yl). For example, if in the first move a player puts his chip to lower left cell of central field, then the second player on his next move should put his chip into some cell of lower left field (pay attention to the first test case). If there are no free cells in the required field, the player can put his chip to any empty cell on any field.You are given current state of the game and coordinates of cell in which the last move was done. You should find all cells in which the current player can put his chip.A hare works as a postman in the forest, he likes to foul bears. Sometimes he changes the game field a bit, so the current state of the game could be unreachable. However, after his changes the cell where the last move was done is not empty. You don\'t need to find if the state is unreachable or not, just output possible next moves according to the rules." 1400.0                                 
               907A "Masha and Bears" "brute force,implementation" "A family consisting of father bear, mother bear and son bear owns three cars. Father bear can climb into the largest car and he likes it. Also, mother bear can climb into the middle car and she likes it. Moreover, son bear can climb into the smallest car and he likes it. It\'s known that the largest car is strictly larger than the middle car, and the middle car is strictly larger than the smallest car. Masha came to test these cars. She could climb into all cars, but she liked only the smallest car. It\'s known that a character with size a can climb into some car with size b if and only if a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b, he or she likes it if and only if he can climb into this car and 2a\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89b.You are given sizes of bears and Masha. Find out some possible integer non-negative sizes of cars." 1300.0                                 
               906A Shockers implementation,strings "Valentin participates in a show called ""Shockers"". The rules are quite easy: jury selects one letter which Valentin doesn\'t know. He should make a small speech, but every time he pronounces a word that contains the selected letter, he receives an electric shock. He can make guesses which letter is selected, but for each incorrect guess he receives an electric shock too. The show ends when Valentin guesses the selected letter correctly.Valentin can\'t keep in mind everything, so he could guess the selected letter much later than it can be uniquely determined and get excessive electric shocks. Excessive electric shocks are those which Valentin got after the moment the selected letter can be uniquely determined. You should find out the number of excessive electric shocks." 1600.0                                 
               903D "Almost Difference" "data structures,math" "Let\'s denote a function You are given an array a consisting of n integers. You have to calculate the sum of d(ai,\xe2\x80\x89aj) over all pairs (i,\xe2\x80\x89j) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 2200.0                                 
               901C "Bipartite Segments" "binary search,data structures,dfs and similar,dsu,graphs,two pointers" "You are given an undirected graph with n vertices. There are no edge-simple cycles with the even length in it. In other words, there are no cycles of even length that pass each edge at most once. Let\'s enumerate vertices from 1 to n. You have to answer q queries. Each query is described by a segment of vertices [l;\xe2\x80\x89r], and you have to count the number of its subsegments [x;\xe2\x80\x89y] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), such that if we delete all vertices except the segment of vertices [x;\xe2\x80\x89y] (including x and y) and edges between them, the resulting graph is bipartite." 2300.0                                 
               900D "Unusual Sequences" "bitmasks,combinatorics,dp,math,number theory" "Count the number of distinct sequences a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai) consisting of positive integers such that gcd(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an)\xe2\x80\x89=\xe2\x80\x89x and . As this number could be large, print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.gcd here means the greatest common divisor." 2000.0                                 
               899F "Letters Removing" "data structures,strings" "Petya has a string of length n consisting of small and large English letters and digits.He performs m operations. Each operation is described with two integers l and r and a character c: Petya removes from the string all characters c on positions between l and r, inclusive. It\'s obvious that the length of the string remains the same or decreases after each operation.Find how the string will look like after Petya performs all m operations." 2100.0                                 
               898E "Squares and not squares" "constructive algorithms,greedy" "Ann and Borya have n piles with candies and n is even number. There are ai candies in pile with number i.Ann likes numbers which are square of some integer and Borya doesn\'t like numbers which are square of any integer. During one move guys can select some pile with candies and add one candy to it (this candy is new and doesn\'t belong to any other pile) or remove one candy (if there is at least one candy in this pile). Find out minimal number of moves that is required to make exactly n\xe2\x80\x89/\xe2\x80\x892 piles contain number of candies that is a square of some integer and exactly n\xe2\x80\x89/\xe2\x80\x892 piles contain number of candies that is not a square of any integer." 1600.0                                 
               898B "Proper Nutrition" "brute force,implementation,number theory" "Vasya has n burles. One bottle of Ber-Cola costs a burles and one Bars bar costs b burles. He can buy any non-negative integer number of bottles of Ber-Cola and any non-negative integer number of Bars bars.Find out if it\'s possible to buy some amount of bottles of Ber-Cola and Bars bars and spend exactly n burles.In other words, you should find two non-negative integers x and y such that Vasya can buy x bottles of Ber-Cola and y Bars bars and x\xc2\xb7a\xe2\x80\x89+\xe2\x80\x89y\xc2\xb7b\xe2\x80\x89=\xe2\x80\x89n or tell that it\'s impossible." 1100.0                                 
               897A "Scarborough Fair" implementation "Are you going to Scarborough Fair?Parsley, sage, rosemary and thyme.Remember me to one who lives there.He once was the true love of mine.Willem is taking the girl to the highest building in island No.28, however, neither of them knows how to get there.Willem asks his friend, Grick for directions, Grick helped them, and gave them a task.Although the girl wants to help, Willem insists on doing it by himself.Grick gave Willem a string of length n.Willem needs to do m operations, each operation has four parameters l,\xe2\x80\x89r,\xe2\x80\x89c1,\xe2\x80\x89c2, which means that all symbols c1 in range [l,\xe2\x80\x89r] (from l-th to r-th, including l and r) are changed into c2. String is 1-indexed.Grick wants to know the final string after all the m operations." 800.0                                 
               896B "Ithea Plays With Chtholly" "binary search,constructive algorithms,games,greedy,interactive" "This is an interactive problem. Refer to the Interaction section below for better understanding.Ithea and Chtholly want to play a game in order to determine who can use the kitchen tonight.Initially, Ithea puts n clear sheets of paper in a line. They are numbered from 1 to n from left to right.This game will go on for m rounds. In each round, Ithea will give Chtholly an integer between 1 and c, and Chtholly needs to choose one of the sheets to write down this number (if there is already a number before, she will erase the original one and replace it with the new one).Chtholly wins if, at any time, all the sheets are filled with a number and the n numbers are in non-decreasing order looking from left to right from sheet 1 to sheet n, and if after m rounds she still doesn\'t win, she loses the game.Chtholly really wants to win the game as she wants to cook something for Willem. But she doesn\'t know how to win the game. So Chtholly finds you, and your task is to write a program to receive numbers that Ithea gives Chtholly and help her make the decision on which sheet of paper write this number." 2000.0                                 
               894B "Ralph And His Magic Field" "combinatorics,constructive algorithms,math,number theory" "Ralph has a magic field which is divided into n\xe2\x80\x89\xc3\x97\xe2\x80\x89m blocks. That is to say, there are n rows and m columns on the field. Ralph can put an integer in each block. However, the magic field doesn\'t always work properly. It works only if the product of integers in each row and each column equals to k, where k is either 1 or -1.Now Ralph wants you to figure out the number of ways to put numbers in each block in such a way that the magic field works properly. Two ways are considered different if and only if there exists at least one block where the numbers in the first way and in the second way are different. You are asked to output the answer modulo 1000000007\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897.Note that there is no range of the numbers to put in the blocks, but we can prove that the answer is not infinity." 1800.0                                 
               891E Lust combinatorics,math,matrices "A false witness that speaketh lies!You are given a sequence containing n integers. There is a variable res that is equal to 0 initially. The following process repeats k times.Choose an index from 1 to n uniformly at random. Name it x. Add to res the multiply of all ai\'s such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, but i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x. Then, subtract ax by 1.You have to find expected value of res at the end of the process. It can be proved that the expected value of res can be represented as an irreducible fraction . You have to find ." 3000.0                                 
               888D "Almost Identity Permutations" combinatorics,dp,math "A permutation p of size n is an array such that every integer from 1 to n occurs exactly once in this array.Let\'s call a permutation an almost identity permutation iff there exist at least n\xe2\x80\x89-\xe2\x80\x89k indices i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that pi\xe2\x80\x89=\xe2\x80\x89i.Your task is to count the number of almost identity permutations for given numbers n and k." 1600.0                                 
               884E "Binary Matrix" dsu "You are given a matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each element of the matrix is either 1 or 0. You have to determine the number of connected components consisting of 1\'s. Two cells belong to the same component if they have a common border, and both elements in these cells are 1\'s.Note that the memory limit is unusual!" 2500.0                                 
               883G "Orientation of Edges" "dfs and similar,graphs" "Vasya has a graph containing both directed (oriented) and undirected (non-oriented) edges. There can be multiple edges between a pair of vertices.Vasya has picked a vertex s from the graph. Now Vasya wants to create two separate plans:  to orient each undirected edge in one of two possible directions to maximize number of vertices reachable from vertex s;  to orient each undirected edge in one of two possible directions to minimize number of vertices reachable from vertex s. In each of two plans each undirected edge must become directed. For an edge chosen directions can differ in two plans.Help Vasya find the plans." 1900.0                                 
               879B "Table Tennis" "data structures,implementation" "n people are standing in a line to play table tennis. At first, the first two players in the line play a game. Then the loser goes to the end of the line, and the winner plays with the next person from the line, and so on. They play until someone wins k games in a row. This player becomes the winner.For each of the participants, you know the power to play table tennis, and for all players these values are different. In a game the player with greater power always wins. Determine who will be the winner." 1200.0                                 
               870D "Something with XOR Queries" "brute force,interactive,probabilities" "This is an interactive problem.Jury has hidden a permutation p of integers from 0 to n\xe2\x80\x89-\xe2\x80\x891. You know only the length n. Remind that in permutation all integers are distinct.Let b be the inverse permutation for p, i.e. pbi\xe2\x80\x89=\xe2\x80\x89i for all i. The only thing you can do is to ask xor of elements pi and bj, printing two indices i and j (not necessarily distinct). As a result of the query with indices i and j you\'ll get the value , where  denotes the xor operation. You can find the description of xor operation in notes.Note that some permutations can remain indistinguishable from the hidden one, even if you make all possible n2 queries. You have to compute the number of permutations indistinguishable from the hidden one, and print one of such permutations, making no more than 2n queries.The hidden permutation does not depend on your queries." 2000.0                                 
               864D "Make a Permutation!" greedy,implementation,math "Ivan has an array consisting of n elements. Each of the elements is an integer from 1 to n.Recently Ivan learned about permutations and their lexicographical order. Now he wants to change (replace) minimum number of elements in his array in such a way that his array becomes a permutation (i.e. each of the integers from 1 to n was encountered in his array exactly once). If there are multiple ways to do it he wants to find the lexicographically minimal permutation among them.Thus minimizing the number of changes has the first priority, lexicographical minimizing has the second priority.In order to determine which of the two permutations is lexicographically smaller, we compare their first elements. If they are equal \xe2\x80\x94 compare the second, and so on. If we have two permutations x and y, then x is lexicographically smaller if xi\xe2\x80\x89<\xe2\x80\x89yi, where i is the first index in which the permutations x and y differ.Determine the array Ivan will obtain after performing all the changes." 1500.0                                 
               862F "Mahmoud and Ehab and the final stage" "data structures,strings" "Mahmoud and Ehab solved Dr. Evil\'s questions so he gave them the password of the door of the evil land. When they tried to open the door using it, the door gave them a final question to solve before they leave (yes, the door is digital, Dr. Evil is modern). If they don\'t solve it, all the work will be useless and they won\'t leave the evil land forever. Will you help them?Mahmoud and Ehab are given n strings s1,\xe2\x80\x89s2,\xe2\x80\x89... ,\xe2\x80\x89sn numbered from 1 to n and q queries, Each query has one of the following forms:  1 a b (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), For all the intervals [l;r] where (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) find the maximum value of this expression:(r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89*\xe2\x80\x89LCP(sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89... ,\xe2\x80\x89sr\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89sr) where LCP(str1,\xe2\x80\x89str2,\xe2\x80\x89str3,\xe2\x80\x89... ) is the length of the longest common prefix of the strings str1,\xe2\x80\x89str2,\xe2\x80\x89str3,\xe2\x80\x89... . 2 x y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) where y is a string, consisting of lowercase English letters. Change the string at position x to y." 2900.0                                 
               859E "Desk Disorder" "combinatorics,dfs and similar,dsu,graphs,trees" "A new set of desks just arrived, and it\'s about time! Things were getting quite cramped in the office. You\'ve been put in charge of creating a new seating chart for the engineers. The desks are numbered, and you sent out a survey to the engineering team asking each engineer the number of the desk they currently sit at, and the number of the desk they would like to sit at (which may be the same as their current desk). Each engineer must either remain where they sit, or move to the desired seat they indicated in the survey. No two engineers currently sit at the same desk, nor may any two engineers sit at the same desk in the new seating arrangement.How many seating arrangements can you create that meet the specified requirements? The answer may be very large, so compute it modulo 1000000007\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897." 2100.0                                 
               853E "Lada Malina" "data structures,geometry" "After long-term research and lots of experiments leading Megapolian automobile manufacturer \xc2\xabAutoVoz\xc2\xbb released a brand new car model named \xc2\xabLada Malina\xc2\xbb. One of the most impressive features of \xc2\xabLada Malina\xc2\xbb is its highly efficient environment-friendly engines.Consider car as a point in Oxy plane. Car is equipped with k engines numbered from 1 to k. Each engine is defined by its velocity vector whose coordinates are (vxi,\xe2\x80\x89vyi) measured in distance units per day. An engine may be turned on at any level wi, that is a real number between \xe2\x80\x89-\xe2\x80\x891 and \xe2\x80\x89+\xe2\x80\x891 (inclusive) that result in a term of (wi\xc2\xb7vxi,\xe2\x80\x89wi\xc2\xb7vyi) in the final car velocity. Namely, the final car velocity is equal to (w1\xc2\xb7vx1\xe2\x80\x89+\xe2\x80\x89w2\xc2\xb7vx2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89wk\xc2\xb7vxk,\xe2\x80\x89  w1\xc2\xb7vy1\xe2\x80\x89+\xe2\x80\x89w2\xc2\xb7vy2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89wk\xc2\xb7vyk) Formally, if car moves with constant values of wi during the whole day then its x-coordinate will change by the first component of an expression above, and its y-coordinate will change by the second component of an expression above. For example, if all wi are equal to zero, the car won\'t move, and if all wi are equal to zero except w1\xe2\x80\x89=\xe2\x80\x891, then car will move with the velocity of the first engine.There are n factories in Megapolia, i-th of them is located in (fxi,\xe2\x80\x89fyi). On the i-th factory there are ai cars \xc2\xabLada Malina\xc2\xbb that are ready for operation.As an attempt to increase sales of a new car, \xc2\xabAutoVoz\xc2\xbb is going to hold an international exposition of cars. There are q options of exposition location and time, in the i-th of them exposition will happen in a point with coordinates (pxi,\xe2\x80\x89pyi) in ti days. Of course, at the \xc2\xabAutoVoz\xc2\xbb is going to bring as much new cars from factories as possible to the place of exposition. Cars are going to be moved by enabling their engines on some certain levels, such that at the beginning of an exposition car gets exactly to the exposition location. However, for some of the options it may be impossible to bring cars from some of the factories to the exposition location by the moment of an exposition. Your task is to determine for each of the options of exposition location and time how many cars will be able to get there by the beginning of an exposition." 3400.0                                 
               852F "Product transformation" "combinatorics,math,number theory" "Consider an array A with N elements, all being the same integer a.Define the product transformation as a simultaneous update Ai\xe2\x80\x89=\xe2\x80\x89Ai\xc2\xb7Ai\xe2\x80\x89+\xe2\x80\x891, that is multiplying each element to the element right to it for , with the last number AN remaining the same. For example, if we start with an array A with a\xe2\x80\x89=\xe2\x80\x892 and N\xe2\x80\x89=\xe2\x80\x894, then after one product transformation A\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x89 4,\xe2\x80\x89 4,\xe2\x80\x89 2], and after two product transformations A\xe2\x80\x89=\xe2\x80\x89[16,\xe2\x80\x89 16,\xe2\x80\x89 8,\xe2\x80\x89 2].Your simple task is to calculate the array A after M product transformations. Since the numbers can get quite big you should output them modulo Q." 2200.0                                 
               852E "Casinos and travel" dp "John has just bought a new car and is planning a journey around the country. Country has N cities, some of which are connected by bidirectional roads. There are N\xe2\x80\x89-\xe2\x80\x891 roads and every city is reachable from any other city. Cities are labeled from 1 to N.John first has to select from which city he will start his journey. After that, he spends one day in a city and then travels to a randomly choosen city which is directly connected to his current one and which he has not yet visited. He does this until he can\'t continue obeying these rules.To select the starting city, he calls his friend Jack for advice. Jack is also starting a big casino business and wants to open casinos in some of the cities (max 1 per city, maybe nowhere). Jack knows John well and he knows that if he visits a city with a casino, he will gamble exactly once before continuing his journey.He also knows that if John enters a casino in a good mood, he will leave it in a bad mood and vice versa. Since he is John\'s friend, he wants him to be in a good mood at the moment when he finishes his journey. John is in a good mood before starting the journey.In how many ways can Jack select a starting city for John and cities where he will build casinos such that no matter how John travels, he will be in a good mood at the end? Print answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2100.0                                 
               850E "Random Elections" "bitmasks,brute force,divide and conquer,fft,math" "The presidential election is coming in Bearland next year! Everybody is so excited about this!So far, there are three candidates, Alice, Bob, and Charlie. There are n citizens in Bearland. The election result will determine the life of all citizens of Bearland for many years. Because of this great responsibility, each of n citizens will choose one of six orders of preference between Alice, Bob and Charlie uniformly at random, independently from other voters.The government of Bearland has devised a function to help determine the outcome of the election given the voters preferences. More specifically, the function is  (takes n boolean numbers and returns a boolean number). The function also obeys the following property: f(1\xe2\x80\x89-\xe2\x80\x89x1,\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89xn)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89f(x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn).Three rounds will be run between each pair of candidates: Alice and Bob, Bob and Charlie, Charlie and Alice. In each round, xi will be equal to 1, if i-th citizen prefers the first candidate to second in this round, and 0 otherwise. After this, y\xe2\x80\x89=\xe2\x80\x89f(x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn) will be calculated. If y\xe2\x80\x89=\xe2\x80\x891, the first candidate will be declared as winner in this round. If y\xe2\x80\x89=\xe2\x80\x890, the second will be the winner, respectively.Define the probability that there is a candidate who won two rounds as p. p\xc2\xb76n is always an integer. Print the value of this integer modulo 109\xe2\x80\x89+\xe2\x80\x897\xe2\x80\x89=\xe2\x80\x891 000 000 007." 2800.0                                 
               847L "Berland SU Computer Network" "constructive algorithms,dfs and similar,graphs,hashing,trees" "In the computer network of the Berland State University there are n routers numbered from 1 to n. Some pairs of routers are connected by patch cords. Information can be transmitted over patch cords in both direction. The network is arranged in such a way that communication between any two routers (directly or through other routers) is possible. There are no cycles in the network, so there is only one path between each pair of routers over patch cords.Unfortunately, the exact topology of the network was lost by administrators. In order to restore it, the following auxiliary information was collected.For each patch cord p, directly connected to the router i, list of routers located behind the patch cord p relatively i is known. In other words, all routers path from which to the router i goes through p are known. So for each router i there are ki lists, where ki is the number of patch cords connected to i.For example, let the network consists of three routers connected in chain 1\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x893. Then:  the router 1: for the single patch cord connected to the first router there is a single list containing two routers: 2 and 3;  the router 2: for each of the patch cords connected to the second router there is a list: one list contains the router 1 and the other \xe2\x80\x94 the router 3;  the router 3: for the single patch cord connected to the third router there is a single list containing two routers: 1 and 2. Your task is to help administrators to restore the network topology, i. e. to identify all pairs of routers directly connected by a patch cord." 2400.0                                 
               847I "Noise Level" "dfs and similar,implementation,math" "The Berland\'s capital has the form of a rectangle with sizes n\xe2\x80\x89\xc3\x97\xe2\x80\x89m quarters. All quarters are divided into three types:  regular (labeled with the character \'.\') \xe2\x80\x94 such quarters do not produce the noise but are not obstacles to the propagation of the noise;  sources of noise (labeled with an uppercase Latin letter from \'A\' to \'Z\') \xe2\x80\x94 such quarters are noise sources and are not obstacles to the propagation of the noise;  heavily built-up (labeled with the character \'*\') \xe2\x80\x94 such quarters are soundproofed, the noise does not penetrate into them and they themselves are obstacles to the propagation of noise. A quarter labeled with letter \'A\' produces q units of noise. A quarter labeled with letter \'B\' produces 2\xc2\xb7q units of noise. And so on, up to a quarter labeled with letter \'Z\', which produces 26\xc2\xb7q units of noise. There can be any number of quarters labeled with each letter in the city.When propagating from the source of the noise, the noise level is halved when moving from one quarter to a quarter that shares a side with it (when an odd number is to be halved, it\'s rounded down). The noise spreads along the chain. For example, if some quarter is located at a distance 2 from the noise source, then the value of noise which will reach the quarter is divided by 4. So the noise level that comes from the source to the quarter is determined solely by the length of the shortest path between them. Heavily built-up quarters are obstacles, the noise does not penetrate into them.  The values in the cells of the table on the right show the total noise level in the respective quarters for q\xe2\x80\x89=\xe2\x80\x89100, the first term in each sum is the noise from the quarter \'A\', the second \xe2\x80\x94 the noise from the quarter \'B\'. The noise level in quarter is defined as the sum of the noise from all sources. To assess the quality of life of the population of the capital of Berland, it is required to find the number of quarters whose noise level exceeds the allowed level p." 1900.0                                 
               846D Monitor "binary search,data structures" "Recently Luba bought a monitor. Monitor is a rectangular matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. But then she started to notice that some pixels cease to work properly. Luba thinks that the monitor will become broken the first moment when it contains a square k\xe2\x80\x89\xc3\x97\xe2\x80\x89k consisting entirely of broken pixels. She knows that q pixels are already broken, and for each of them she knows the moment when it stopped working. Help Luba to determine when the monitor became broken (or tell that it\'s still not broken even after all q pixels stopped working)." 1900.0                                 
               845E "Fire in the City" "binary search,data structures" "The capital of Berland looks like a rectangle of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m of the square blocks of same size.Fire!It is known that k\xe2\x80\x89+\xe2\x80\x891 blocks got caught on fire (k\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xc2\xb7m). Those blocks are centers of ignition. Moreover positions of k of these centers are known and one of these stays unknown. All k\xe2\x80\x89+\xe2\x80\x891 positions are distinct.The fire goes the following way: during the zero minute of fire only these k\xe2\x80\x89+\xe2\x80\x891 centers of ignition are burning. Every next minute the fire goes to all neighbouring blocks to the one which is burning. You can consider blocks to burn for so long that this time exceeds the time taken in the problem. The neighbouring blocks are those that touch the current block by a side or by a corner.Berland Fire Deparment wants to estimate the minimal time it takes the fire to lighten up the whole city. Remember that the positions of k blocks (centers of ignition) are known and (k\xe2\x80\x89+\xe2\x80\x891)-th can be positioned in any other block.Help Berland Fire Department to estimate the minimal time it takes the fire to lighten up the whole city." 2400.0                                 
               845C "Two TVs" "data structures,greedy,sortings" "Polycarp is a great fan of television.He wrote down all the TV programs he is interested in for today. His list contains n shows, i-th of them starts at moment li and ends at moment ri.Polycarp owns two TVs. He can watch two different shows simultaneously with two TVs but he can only watch one show at any given moment on a single TV. If one show ends at the same moment some other show starts then you can\'t watch them on a single TV.Polycarp wants to check out all n shows. Are two TVs enough to do so?" 1500.0                                 
               845A "Chess Tourney" implementation,sortings "Berland annual chess tournament is coming!Organizers have gathered 2\xc2\xb7n chess players who should be divided into two teams with n people each. The first team is sponsored by BerOil and the second team is sponsored by BerMobile. Obviously, organizers should guarantee the win for the team of BerOil.Thus, organizers should divide all 2\xc2\xb7n players into two teams with n people each in such a way that the first team always wins.Every chess player has its rating ri. It is known that chess player with the greater rating always wins the player with the lower rating. If their ratings are equal then any of the players can win.After teams assignment there will come a drawing to form n pairs of opponents: in each pair there is a player from the first team and a player from the second team. Every chess player should be in exactly one pair. Every pair plays once. The drawing is totally random.Is it possible to divide all 2\xc2\xb7n players into two teams with n people each so that the player from the first team in every pair wins regardless of the results of the drawing?" 1100.0                                 
               843E "Maximum Flow" flows,graphs "You are given a directed graph, consisting of n vertices and m edges. The vertices s and t are marked as source and sink correspondingly. Additionally, there are no edges ending at s and there are no edges beginning in t.The graph was constructed in a following way: initially each edge had capacity ci\xe2\x80\x89>\xe2\x80\x890. A maximum flow with source at s and sink at t was constructed in this flow network. Let\'s denote fi as the value of flow passing through edge with index i. Next, all capacities ci and flow value fi were erased. Instead, indicators gi were written on edges \xe2\x80\x94 if flow value passing through edge i was positive, i.e. 1 if fi\xe2\x80\x89>\xe2\x80\x890 and 0 otherwise.Using the graph and values gi, find out what is the minimum possible number of edges in the initial flow network that could be saturated (the passing flow is equal to capacity, i.e. fi\xe2\x80\x89=\xe2\x80\x89ci). Also construct the corresponding flow network with maximum flow in it.A flow in directed graph is described by flow values fi on each of the edges so that the following conditions are satisfied:   for each vertex, except source and sink, total incoming flow and total outcoming flow are equal,  for each edge 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89fi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci A flow is maximum if the difference between the sum of flow values on edges from the source, and the sum of flow values on edges to the source (there are no such in this problem), is maximum possible." 3000.0                                 
               842C "Ilya And The Tree" "dfs and similar,graphs,math,number theory,trees" "Ilya is very fond of graphs, especially trees. During his last trip to the forest Ilya found a very interesting tree rooted at vertex 1. There is an integer number written on each vertex of the tree; the number written on vertex i is equal to ai.Ilya believes that the beauty of the vertex x is the greatest common divisor of all numbers written on the vertices on the path from the root to x, including this vertex itself. In addition, Ilya can change the number in one arbitrary vertex to 0 or leave all vertices unchanged. Now for each vertex Ilya wants to know the maximum possible beauty it can have.For each vertex the answer must be considered independently.The beauty of the root equals to number written on it." 2000.0                                 
               842A "Kirill And The Game" "brute force,two pointers" "Kirill plays a new computer game. He came to the potion store where he can buy any potion. Each potion is characterized by two integers \xe2\x80\x94 amount of experience and cost. The efficiency of a potion is the ratio of the amount of experience to the cost. Efficiency may be a non-integer number.For each two integer numbers a and b such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y there is a potion with experience a and cost b in the store (that is, there are (r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891) potions).Kirill wants to buy a potion which has efficiency k. Will he be able to do this?" 1200.0                                 
               841B Godsend games,math "Leha somehow found an array consisting of n integers. Looking at it, he came up with a task. Two players play the game on the array. Players move one by one. The first player can choose for his move a subsegment of non-zero length with an odd sum of numbers and remove it from the array, after that the remaining parts are glued together into one array and the game continues. The second player can choose a subsegment of non-zero length with an even sum and remove it. Loses the one who can not make a move. Who will win if both play optimally?" 1100.0                                 
               835F "Roads in the Kingdom" "dfs and similar,dp,graphs,trees" "In the Kingdom K., there are n towns numbered with integers from 1 to n. The towns are connected by n bi-directional roads numbered with integers from 1 to n. The i-th road connects the towns ui and vi and its length is li. There is no more than one road between two towns. Also, there are no roads that connect the towns with itself.Let\'s call the inconvenience of the roads the maximum of the shortest distances between all pairs of towns.Because of lack of money, it was decided to close down one of the roads so that after its removal it is still possible to reach any town from any other. You have to find the minimum possible inconvenience of the roads after closing down one of the roads." 2500.0                                 
               830D "Singer House" combinatorics,dp,graphs,trees "It is known that passages in Singer house are complex and intertwined. Let\'s define a Singer k-house as a graph built by the following process: take complete binary tree of height k and add edges from each vertex to all its successors, if they are not yet present.  Singer 4-house Count the number of non-empty paths in Singer k-house which do not pass the same vertex twice. Two paths are distinct if the sets or the orders of visited vertices are different. Since the answer can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2800.0                                 
               830B "Cards Sorting" "data structures,implementation,sortings" "Vasily has a deck of cards consisting of n cards. There is an integer on each of the cards, this integer is between 1 and 100\xe2\x80\x89000, inclusive. It is possible that some cards have the same integers on them.Vasily decided to sort the cards. To do this, he repeatedly takes the top card from the deck, and if the number on it equals the minimum number written on the cards in the deck, then he places the card away. Otherwise, he puts it under the deck and takes the next card from the top, and so on. The process ends as soon as there are no cards in the deck. You can assume that Vasily always knows the minimum number written on some card in the remaining deck, but doesn\'t know where this card (or these cards) is.You are to determine the total number of times Vasily takes the top card from the deck." 1600.0                                 
               827C "DNA Evolution" "data structures,strings" "Everyone knows that DNA strands consist of nucleotides. There are four types of nucleotides: ""A"", ""T"", ""G"", ""C"". A DNA strand is a sequence of nucleotides. Scientists decided to track evolution of a rare species, which DNA strand was string s initially. Evolution of the species is described as a sequence of changes in the DNA. Every change is a change of some nucleotide, for example, the following change can happen in DNA strand ""AAGC"": the second nucleotide can change to ""T"" so that the resulting DNA strand is ""ATGC"".Scientists know that some segments of the DNA strand can be affected by some unknown infections. They can represent an infection as a sequence of nucleotides. Scientists are interested if there are any changes caused by some infections. Thus they sometimes want to know the value of impact of some infection to some segment of the DNA. This value is computed as follows:  Let the infection be represented as a string e, and let scientists be interested in DNA strand segment starting from position l to position r, inclusive.  Prefix of the string eee... (i.e. the string that consists of infinitely many repeats of string e) is written under the string s from position l to position r, inclusive.  The value of impact is the number of positions where letter of string s coincided with the letter written under it. Being a developer, Innokenty is interested in bioinformatics also, so the scientists asked him for help. Innokenty is busy preparing VK Cup, so he decided to delegate the problem to the competitors. Help the scientists!" 2100.0                                 
               827B "High Load" "constructive algorithms,greedy,implementation,trees" "Arkady needs your help again! This time he decided to build his own high-speed Internet exchange point. It should consist of n nodes connected with minimum possible number of wires into one network (a wire directly connects two nodes). Exactly k of the nodes should be exit-nodes, that means that each of them should be connected to exactly one other node of the network, while all other nodes should be connected to at least two nodes in order to increase the system stability.Arkady wants to make the system as fast as possible, so he wants to minimize the maximum distance between two exit-nodes. The distance between two nodes is the number of wires a package needs to go through between those two nodes.Help Arkady to find such a way to build the network that the distance between the two most distant exit-nodes is as small as possible." 1800.0                                 
               825B Five-In-a-Row "brute force,implementation" "Alice and Bob play 5-in-a-row game. They have a playing field of size 10\xe2\x80\x89\xc3\x97\xe2\x80\x8910. In turns they put either crosses or noughts, one at a time. Alice puts crosses and Bob puts noughts.In current match they have made some turns and now it\'s Alice\'s turn. She wonders if she can put cross in such empty cell that she wins immediately.Alice wins if some crosses in the field form line of length not smaller than 5. This line can be horizontal, vertical and diagonal." 1600.0                                 
               825A "Binary Protocol" implementation "Polycarp has just invented a new binary protocol for data transmission. He is encoding positive integer decimal number to binary string using following algorithm:  Each digit is represented with number of \'1\' characters equal to the value of that digit (for 0 it is zero ones).  Digits are written one by one in order corresponding to number and separated by single \'0\' character. Though Polycarp learnt how to encode the numbers, he has no idea how to decode them back. Help him calculate the decoded number." 1100.0                                 
               821D "Okabe and City" "dfs and similar,graphs,shortest paths" "Okabe likes to be able to walk through his city on a path lit by street lamps. That way, he doesn\'t get beaten up by schoolchildren.Okabe\'s city is represented by a 2D grid of cells. Rows are numbered from 1 to n from top to bottom, and columns are numbered 1 to m from left to right. Exactly k cells in the city are lit by a street lamp. It\'s guaranteed that the top-left cell is lit.Okabe starts his walk from the top-left cell, and wants to reach the bottom-right cell. Of course, Okabe will only walk on lit cells, and he can only move to adjacent cells in the up, down, left, and right directions. However, Okabe can also temporarily light all the cells in any single row or column at a time if he pays 1 coin, allowing him to walk through some cells not lit initially. Note that Okabe can only light a single row or column at a time, and has to pay a coin every time he lights a new row or column. To change the row or column that is temporarily lit, he must stand at a cell that is lit initially. Also, once he removes his temporary light from a row or column, all cells in that row/column not initially lit are now not lit.Help Okabe find the minimum number of coins he needs to pay to complete his walk!" 2200.0                                 
               819D "Mister B and Astronomers" "number theory" "After studying the beacons Mister B decided to visit alien\'s planet, because he learned that they live in a system of flickering star Moon. Moreover, Mister B learned that the star shines once in exactly T seconds. The problem is that the star is yet to be discovered by scientists.There are n astronomers numerated from 1 to n trying to detect the star. They try to detect the star by sending requests to record the sky for 1 second. The astronomers send requests in cycle: the i-th astronomer sends a request exactly ai second after the (i\xe2\x80\x89-\xe2\x80\x891)-th (i.e. if the previous request was sent at moment t, then the next request is sent at moment t\xe2\x80\x89+\xe2\x80\x89ai); the 1-st astronomer sends requests a1 seconds later than the n-th. The first astronomer sends his first request at moment 0.Mister B doesn\'t know the first moment the star is going to shine, but it\'s obvious that all moments at which the star will shine are determined by the time of its shine moment in the interval [0,\xe2\x80\x89T). Moreover, this interval can be split into T parts of 1 second length each of form [t,\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x891), where t\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89(T\xe2\x80\x89-\xe2\x80\x891).Mister B wants to know how lucky each astronomer can be in discovering the star first.For each astronomer compute how many segments of form [t,\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x891) (t\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89(T\xe2\x80\x89-\xe2\x80\x891)) there are in the interval [0,\xe2\x80\x89T) so that this astronomer is the first to discover the star if the first shine of the star happens in this time interval." 2900.0                                 
               819B "Mister B and PR Shifts" "data structures,implementation,math" "Some time ago Mister B detected a strange signal from the space, which he started to study.After some transformation the signal turned out to be a permutation p of length n or its cyclic shift. For the further investigation Mister B need some basis, that\'s why he decided to choose cyclic shift of this permutation which has the minimum possible deviation.Let\'s define the deviation of a permutation p as .Find a cyclic shift of permutation p with minimum possible deviation. If there are multiple solutions, print any of them.Let\'s denote id k (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n) of a cyclic shift of permutation p as the number of right shifts needed to reach this shift, for example:  k\xe2\x80\x89=\xe2\x80\x890: shift p1,\xe2\x80\x89p2,\xe2\x80\x89... pn,  k\xe2\x80\x89=\xe2\x80\x891: shift pn,\xe2\x80\x89p1,\xe2\x80\x89... pn\xe2\x80\x89-\xe2\x80\x891,  ...,  k\xe2\x80\x89=\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891: shift p2,\xe2\x80\x89p3,\xe2\x80\x89... pn,\xe2\x80\x89p1." 1900.0                                 
               818E "Card Game Again" "binary search,data structures,number theory,two pointers" "Vova again tries to play some computer card game.The rules of deck creation in this game are simple. Vova is given an existing deck of n cards and a magic number k. The order of the cards in the deck is fixed. Each card has a number written on it; number ai is written on the i-th card in the deck.After receiving the deck and the magic number, Vova removes x (possibly x\xe2\x80\x89=\xe2\x80\x890) cards from the top of the deck, y (possibly y\xe2\x80\x89=\xe2\x80\x890) cards from the bottom of the deck, and the rest of the deck is his new deck (Vova has to leave at least one card in the deck after removing cards). So Vova\'s new deck actually contains cards x\xe2\x80\x89+\xe2\x80\x891, x\xe2\x80\x89+\xe2\x80\x892, ... n\xe2\x80\x89-\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891, n\xe2\x80\x89-\xe2\x80\x89y from the original deck.Vova\'s new deck is considered valid iff the product of all numbers written on the cards in his new deck is divisible by k. So Vova received a deck (possibly not a valid one) and a number k, and now he wonders, how many ways are there to choose x and y so the deck he will get after removing x cards from the top and y cards from the bottom is valid?" 1900.0                                 
               817A "Treasure Hunt" "implementation,math,number theory" "Captain Bill the Hummingbird and his crew recieved an interesting challenge offer. Some stranger gave them a map, potion of teleportation and said that only this potion might help them to reach the treasure. Bottle with potion has two values x and y written on it. These values define four moves which can be performed using the potion:         Map shows that the position of Captain Bill the Hummingbird is (x1,\xe2\x80\x89y1) and the position of the treasure is (x2,\xe2\x80\x89y2).You task is to tell Captain Bill the Hummingbird whether he should accept this challenge or decline. If it is possible for Captain to reach the treasure using the potion then output ""YES"", otherwise ""NO"" (without quotes).The potion can be used infinite amount of times." 1200.0                                 
               815B "Karen and Test" "brute force,combinatorics,constructive algorithms,math" "Karen has just arrived at school, and she has a math test today!  The test is about basic addition and subtraction. Unfortunately, the teachers were too busy writing tasks for Codeforces rounds, and had no time to make an actual test. So, they just put one question in the test that is worth all the points.There are n integers written on a row. Karen must alternately add and subtract each pair of adjacent integers, and write down the sums or differences on the next row. She must repeat this process on the values on the next row, and so on, until only one integer remains. The first operation should be addition.Note that, if she ended the previous row by adding the integers, she should start the next row by subtracting, and vice versa.The teachers will simply look at the last integer, and then if it is correct, Karen gets a perfect score, otherwise, she gets a zero for the test.Karen has studied well for this test, but she is scared that she might make a mistake somewhere and it will cause her final answer to be wrong. If the process is followed, what number can she expect to be written on the last row?Since this number can be quite large, output only the non-negative remainder after dividing it by 109\xe2\x80\x89+\xe2\x80\x897." 2200.0                                 
               815A "Karen and Game" "brute force,greedy,implementation" "On the way to school, Karen became fixated on the puzzle game on her phone!  The game is played as follows. In each level, you have a grid with n rows and m columns. Each cell originally contains the number 0.One move consists of choosing one row or column, and adding 1 to all of the cells in that row or column.To win the level, after all the moves, the number in the cell at the i-th row and j-th column should be equal to gi,\xe2\x80\x89j.Karen is stuck on one level, and wants to know a way to beat this level using the minimum number of moves. Please, help her with this task!" 1700.0                                 
               812B "Sagheer, the Hausmeister" "bitmasks,brute force,dp" "Some people leave the lights at their workplaces on when they leave that is a waste of resources. As a hausmeister of DHBW, Sagheer waits till all students and professors leave the university building, then goes and turns all the lights off.The building consists of n floors with stairs at the left and the right sides. Each floor has m rooms on the same line with a corridor that connects the left and right stairs passing by all the rooms. In other words, the building can be represented as a rectangle with n rows and m\xe2\x80\x89+\xe2\x80\x892 columns, where the first and the last columns represent the stairs, and the m columns in the middle represent rooms.Sagheer is standing at the ground floor at the left stairs. He wants to turn all the lights off in such a way that he will not go upstairs until all lights in the floor he is standing at are off. Of course, Sagheer must visit a room to turn the light there off. It takes one minute for Sagheer to go to the next floor using stairs or to move from the current room/stairs to a neighboring room/stairs on the same floor. It takes no time for him to switch the light off in the room he is currently standing in. Help Sagheer find the minimum total time to turn off all the lights.Note that Sagheer does not have to go back to his starting position, and he does not have to visit rooms where the light is already switched off." 1600.0                                 
               812A "Sagheer and Crossroads" implementation "Sagheer is walking in the street when he comes to an intersection of two roads. Each road can be represented as two parts where each part has 3 lanes getting into the intersection (one for each direction) and 3 lanes getting out of the intersection, so we have 4 parts in total. Each part has 4 lights, one for each lane getting into the intersection (l \xe2\x80\x94 left, s \xe2\x80\x94 straight, r \xe2\x80\x94 right) and a light p for a pedestrian crossing.   An accident is possible if a car can hit a pedestrian. This can happen if the light of a pedestrian crossing of some part and the light of a lane that can get to or from that same part are green at the same time.Now, Sagheer is monitoring the configuration of the traffic lights. Your task is to help him detect whether an accident is possible." 1200.0                                 
               811E "Vladik and Entertaining Flags" "data structures,dsu,graphs" "In his spare time Vladik estimates beauty of the flags.Every flag could be represented as the matrix n\xe2\x80\x89\xc3\x97\xe2\x80\x89m which consists of positive integers.Let\'s define the beauty of the flag as number of components in its matrix. We call component a set of cells with same numbers and between any pair of cells from that set there exists a path through adjacent cells from same component. Here is the example of the partitioning some flag matrix into components:  But this time he decided to change something in the process. Now he wants to estimate not the entire flag, but some segment. Segment of flag can be described as a submatrix of the flag matrix with opposite corners at (1,\xe2\x80\x89l) and (n,\xe2\x80\x89r), where conditions 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m are satisfied.Help Vladik to calculate the beauty for some segments of the given flag." 2600.0                                 
               809E "Surprise me!" "divide and conquer,math,number theory,trees" "Tired of boring dates, Leha and Noora decided to play a game.Leha found a tree with n vertices numbered from 1 to n. We remind you that tree is an undirected graph without cycles. Each vertex v of a tree has a number av written on it. Quite by accident it turned out that all values written on vertices are distinct and are natural numbers between 1 and n.The game goes in the following way. Noora chooses some vertex u of a tree uniformly at random and passes a move to Leha. Leha, in his turn, chooses (also uniformly at random) some vertex v from remaining vertices of a tree (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89u). As you could guess there are n(n\xe2\x80\x89-\xe2\x80\x891) variants of choosing vertices by players. After that players calculate the value of a function f(u,\xe2\x80\x89v)\xe2\x80\x89=\xe2\x80\x89\xcf\x86(au\xc2\xb7av) \xc2\xb7 d(u,\xe2\x80\x89v) of the chosen vertices where \xcf\x86(x) is Euler\'s totient function and d(x,\xe2\x80\x89y) is the shortest distance between vertices x and y in a tree.Soon the game became boring for Noora, so Leha decided to defuse the situation and calculate expected value of function f over all variants of choosing vertices u and v, hoping of at least somehow surprise the girl.Leha asks for your help in calculating this expected value. Let this value be representable in the form of an irreducible fraction . To further surprise Noora, he wants to name her the value . Help Leha!" 3100.0                                 
               808G "Anthem of Berland" dp,strings "Berland has a long and glorious history. To increase awareness about it among younger citizens, King of Berland decided to compose an anthem.Though there are lots and lots of victories in history of Berland, there is the one that stand out the most. King wants to mention it in the anthem as many times as possible.He has already composed major part of the anthem and now just needs to fill in some letters. King asked you to help him with this work.The anthem is the string s of no more than 105 small Latin letters and question marks. The most glorious victory is the string t of no more than 105 small Latin letters. You should replace all the question marks with small Latin letters in such a way that the number of occurrences of string t in string s is maximal.Note that the occurrences of string t in s can overlap. Check the third example for clarification." 2300.0                                 
               808C "Tea Party" "constructive algorithms,greedy,sortings" "Polycarp invited all his friends to the tea party to celebrate the holiday. He has n cups, one for each of his n friends, with volumes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. His teapot stores w milliliters of tea (w\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an). Polycarp wants to pour tea in cups in such a way that:  Every cup will contain tea for at least half of its volume  Every cup will contain integer number of milliliters of tea  All the tea from the teapot will be poured into cups  All friends will be satisfied. Friend with cup i won\'t be satisfied, if there exists such cup j that cup i contains less tea than cup j but ai\xe2\x80\x89>\xe2\x80\x89aj.For each cup output how many milliliters of tea should be poured in it. If it\'s impossible to pour all the tea and satisfy all conditions then output -1." 1400.0                                 
               808B "Average Sleep Time" "data structures,implementation,math" "It\'s been almost a week since Polycarp couldn\'t get rid of insomnia. And as you may already know, one week in Berland lasts k days!When Polycarp went to a doctor with his problem, the doctor asked him about his sleeping schedule (more specifically, the average amount of hours of sleep per week). Luckily, Polycarp kept records of sleep times for the last n days. So now he has a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is the sleep time on the i-th day.The number of records is so large that Polycarp is unable to calculate the average value by himself. Thus he is asking you to help him with the calculations. To get the average Polycarp is going to consider k consecutive days as a week. So there will be n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 weeks to take into consideration. For example, if k\xe2\x80\x89=\xe2\x80\x892, n\xe2\x80\x89=\xe2\x80\x893 and a\xe2\x80\x89=\xe2\x80\x89[3,\xe2\x80\x894,\xe2\x80\x897], then the result is .You should write a program which will calculate average sleep times of Polycarp over all weeks." 1300.0                                 
               808A "Lucky Year" implementation "Apart from having lots of holidays throughout the year, residents of Berland also have whole lucky years. Year is considered lucky if it has no more than 1 non-zero digit in its number. So years 100, 40000, 5 are lucky and 12, 3001 and 12345 are not.You are given current year in Berland. Your task is to find how long will residents of Berland wait till the next lucky year." 900.0                                 
               805B 3-palindrome "constructive algorithms" "In the beginning of the new year Keivan decided to reverse his name. He doesn\'t like palindromes, so he changed Naviek to Navick.He is too selfish, so for a given n he wants to obtain a string of n characters, each of which is either \'a\', \'b\' or \'c\', with no palindromes of length 3 appearing in the string as a substring. For example, the strings ""abc"" and ""abca"" suit him, while the string ""aba"" doesn\'t. He also want the number of letters \'c\' in his string to be as little as possible." 1000.0                                 
               805A "Fake NP" greedy,math "Tavak and Seyyed are good friends. Seyyed is very funny and he told Tavak to solve the following problem instead of longest-path.You are given l and r. For all integers from l to r, inclusive, we wrote down all of their integer divisors except 1. Find the integer that we wrote down the maximum number of times.Solve the problem to show that it\'s not a NP problem." 1000.0                                 
               803A "Maximal Binary Matrix" "constructive algorithms" "You are given matrix with n rows and n columns filled with zeroes. You should put k ones in it in such a way that the resulting matrix is symmetrical with respect to the main diagonal (the diagonal that goes from the top left to the bottom right corner) and is lexicographically maximal.One matrix is lexicographically greater than the other if the first different number in the first different row from the top in the first matrix is greater than the corresponding number in the second one.If there exists no such matrix then output -1." 1400.0                                 
               802N "April Fools\' Problem (medium)" "binary search,flows,graphs" "The marmots need to prepare k problems for HC2 over n days. Each problem, once prepared, also has to be printed.The preparation of a problem on day i (at most one per day) costs ai CHF, and the printing of a problem on day i (also at most one per day) costs bi CHF. Of course, a problem cannot be printed before it has been prepared (but doing both on the same day is fine).What is the minimum cost of preparation and printing?" 2400.0                                 
               799A "Carrot Cakes" "brute force,implementation" "In some game by Playrix it takes t minutes for an oven to bake k carrot cakes, all cakes are ready at the same moment t minutes after they started baking. Arkady needs at least n cakes to complete a task, but he currently don\'t have any. However, he has infinitely many ingredients and one oven. Moreover, Arkady can build one more similar oven to make the process faster, it would take d minutes to build the oven. While the new oven is being built, only old one can bake cakes, after the new oven is built, both ovens bake simultaneously. Arkady can\'t build more than one oven.Determine if it is reasonable to build the second oven, i.e. will it decrease the minimum time needed to get n cakes or not. If the time needed with the second oven is the same as with one oven, then it is unreasonable." 1100.0                                 
               798E "Mike and code of a permutation" "constructive algorithms,data structures,graphs,sortings" "Mike has discovered a new way to encode permutations. If he has a permutation P\xe2\x80\x89=\xe2\x80\x89[p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn], he will encode it in the following way:Denote by A\xe2\x80\x89=\xe2\x80\x89[a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an] a sequence of length n which will represent the code of the permutation. For each i from 1 to n sequentially, he will choose the smallest unmarked j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that pi\xe2\x80\x89<\xe2\x80\x89pj and will assign to ai the number j (in other words he performs ai\xe2\x80\x89=\xe2\x80\x89j) and will mark j. If there is no such j, he\'ll assign to ai the number \xe2\x80\x89-\xe2\x80\x891 (he performs ai\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891). Mike forgot his original permutation but he remembers its code. Your task is simple: find any permutation such that its code is the same as the code of Mike\'s original permutation.You may assume that there will always be at least one valid permutation." 3000.0                                 
               798C "Mike and gcd problem" "dp,greedy,number theory" "Mike has a sequence A\xe2\x80\x89=\xe2\x80\x89[a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an] of length n. He considers the sequence B\xe2\x80\x89=\xe2\x80\x89[b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn] beautiful if the gcd of all its elements is bigger than 1, i.e. . Mike wants to change his sequence in order to make it beautiful. In one move he can choose an index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), delete numbers ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 and put numbers ai\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 in their place instead, in this order. He wants perform as few operations as possible. Find the minimal number of operations to make sequence A beautiful if it\'s possible, or tell him that it is impossible to do so. is the biggest non-negative number d such that d divides bi for every i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n)." 1700.0                                 
               796D "Police Stations" "constructive algorithms,dfs and similar,dp,graphs,shortest paths,trees" "Inzane finally found Zane with a lot of money to spare, so they together decided to establish a country of their own.Ruling a country is not an easy job. Thieves and terrorists are always ready to ruin the country\'s peace. To fight back, Zane and Inzane have enacted a very effective law: from each city it must be possible to reach a police station by traveling at most d kilometers along the roads.  There are n cities in the country, numbered from 1 to n, connected only by exactly n\xe2\x80\x89-\xe2\x80\x891 roads. All roads are 1 kilometer long. It is initially possible to travel from a city to any other city using these roads. The country also has k police stations located in some cities. In particular, the city\'s structure satisfies the requirement enforced by the previously mentioned law. Also note that there can be multiple police stations in one city.However, Zane feels like having as many as n\xe2\x80\x89-\xe2\x80\x891 roads is unnecessary. The country is having financial issues, so it wants to minimize the road maintenance cost by shutting down as many roads as possible.Help Zane find the maximum number of roads that can be shut down without breaking the law. Also, help him determine such roads." 2100.0                                 
               796C "Bank Hacking" "constructive algorithms,data structures,dp,trees" "Although Inzane successfully found his beloved bone, Zane, his owner, has yet to return. To search for Zane, he would need a lot of money, of which he sadly has none. To deal with the problem, he has decided to hack the banks.  There are n banks, numbered from 1 to n. There are also n\xe2\x80\x89-\xe2\x80\x891 wires connecting the banks. All banks are initially online. Each bank also has its initial strength: bank i has initial strength ai.Let us define some keywords before we proceed. Bank i and bank j are neighboring if and only if there exists a wire directly connecting them. Bank i and bank j are semi-neighboring if and only if there exists an online bank k such that bank i and bank k are neighboring and bank k and bank j are neighboring.When a bank is hacked, it becomes offline (and no longer online), and other banks that are neighboring or semi-neighboring to it have their strengths increased by 1.To start his plan, Inzane will choose a bank to hack first. Indeed, the strength of such bank must not exceed the strength of his computer. After this, he will repeatedly choose some bank to hack next until all the banks are hacked, but he can continue to hack bank x if and only if all these conditions are met:  Bank x is online. That is, bank x is not hacked yet.  Bank x is neighboring to some offline bank.  The strength of bank x is less than or equal to the strength of Inzane\'s computer. Determine the minimum strength of the computer Inzane needs to hack all the banks." 1900.0                                 
               793F "Julia the snail" "data structures,divide and conquer,dp" "After hard work Igor decided to have some rest.He decided to have a snail. He bought an aquarium with a slippery tree trunk in the center, and put a snail named Julia into the aquarium.Igor noticed that sometimes Julia wants to climb onto the trunk, but can\'t do it because the trunk is too slippery. To help the snail Igor put some ropes on the tree, fixing the lower end of the i-th rope on the trunk on the height li above the ground, and the higher end on the height ri above the ground.For some reason no two ropes share the same position of the higher end, i.e. all ri are distinct. Now Julia can move down at any place of the trunk, and also move up from the lower end of some rope to its higher end. Igor is proud of his work, and sometimes think about possible movements of the snail. Namely, he is interested in the following questions: \xc2\xabSuppose the snail is on the trunk at height x now. What is the highest position on the trunk the snail can get on if it would never be lower than x or higher than y?\xc2\xbb Please note that Julia can\'t move from a rope to the trunk before it reaches the higher end of the rope, and Igor is interested in the highest position on the tree trunk.Igor is interested in many questions, and not always can answer them. Help him, write a program that answers these questions." 3000.0                                 
               793C "Mice problem" geometry,implementation,math,sortings "Igor the analyst fell asleep on the work and had a strange dream. In the dream his desk was crowded with computer mice, so he bought a mousetrap to catch them.The desk can be considered as an infinite plane, then the mousetrap is a rectangle which sides are parallel to the axes, and which opposite sides are located in points (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2).Igor wants to catch all mice. Igor has analysed their behavior and discovered that each mouse is moving along a straight line with constant speed, the speed of the i-th mouse is equal to (vix,\xe2\x80\x89viy), that means that the x coordinate of the mouse increases by vix units per second, while the y coordinates increases by viy units. The mousetrap is open initially so that the mice are able to move freely on the desk. Igor can close the mousetrap at any moment catching all the mice that are strictly inside the mousetrap.Igor works a lot, so he is busy in the dream as well, and he asks you to write a program that by given mousetrap\'s coordinates, the initial coordinates of the mice and their speeds determines the earliest time moment in which he is able to catch all the mice. Please note that Igor can close the mousetrap only once." 2300.0                                 
               793A "Oleg and shares" implementation,math "Oleg the bank client checks share prices every day. There are n share prices he is interested in. Today he observed that each second exactly one of these prices decreases by k rubles (note that each second exactly one price changes, but at different seconds different prices can change). Prices can become negative. Oleg found this process interesting, and he asked Igor the financial analyst, what is the minimum time needed for all n prices to become equal, or it is impossible at all? Igor is busy right now, so he asked you to help Oleg. Can you answer this question?" 900.0                                 
               792E "Colored Balls" "greedy,math,number theory" "There are n boxes with colored balls on the table. Colors are numbered from 1 to n. i-th box contains ai balls, all of which have color i. You have to write a program that will divide all balls into sets such that:  each ball belongs to exactly one of the sets,  there are no empty sets,  there is no set containing two (or more) balls of different colors (each set contains only balls of one color),  there are no two sets such that the difference between their sizes is greater than 1. Print the minimum possible number of sets." 2500.0                                 
               792C "Divide by Three" "dp,greedy,math,number theory" "A positive integer number n is written on a blackboard. It consists of not more than 105 digits. You have to transform it into a beautiful number by erasing some of the digits, and you want to erase as few digits as possible.The number is called beautiful if it consists of at least one digit, doesn\'t have leading zeroes and is a multiple of 3. For example, 0, 99, 10110 are beautiful numbers, and 00, 03, 122 are not.Write a program which for the given n will find a beautiful number such that n can be transformed into this number by erasing as few digits as possible. You can erase an arbitraty set of digits. For example, they don\'t have to go one after another in the number n.If it\'s impossible to obtain a beautiful number, print -1. If there are multiple answers, print any of them." 2000.0                                 
               789A "Anastasia and pebbles" implementation,math "Anastasia loves going for a walk in Central Uzhlyandian Park. But she became uninterested in simple walking, so she began to collect Uzhlyandian pebbles. At first, she decided to collect all the pebbles she could find in the park.She has only two pockets. She can put at most k pebbles in each pocket at the same time. There are n different pebble types in the park, and there are wi pebbles of the i-th type. Anastasia is very responsible, so she never mixes pebbles of different types in same pocket. However, she can put different kinds of pebbles in different pockets at the same time. Unfortunately, she can\'t spend all her time collecting pebbles, so she can collect pebbles from the park only once a day.Help her to find the minimum number of days needed to collect all the pebbles of Uzhlyandian Central Park, taking into consideration that Anastasia can\'t place pebbles of different types in same pocket." 1100.0                                 
               786E ALT "data structures,flows,graphs,trees" "ALT is a planet in a galaxy called ""Encore"". Humans rule this planet but for some reason there\'s no dog in their planet, so the people there are sad and depressed. Rick and Morty are universal philanthropists and they want to make people in ALT happy. ALT has n cities numbered from 1 to n and n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads numbered from 1 to n\xe2\x80\x89-\xe2\x80\x891. One can go from any city to any other city using these roads.There are two types of people in ALT:  Guardians. A guardian lives in a house alongside a road and guards the road.  Citizens. A citizen lives in a house inside a city and works in an office in another city. Every person on ALT is either a guardian or a citizen and there\'s exactly one guardian alongside each road.   Rick and Morty talked to all the people in ALT, and here\'s what they got:  There are m citizens living in ALT.  Citizen number i lives in city number xi and works in city number yi.  Every day each citizen will go through all roads along the shortest path from his home to his work.  A citizen will be happy if and only if either he himself has a puppy himself or all of guardians along his path to his work has a puppy (he sees the guardian\'s puppy in each road and will be happy).  A guardian is always happy. You need to tell Rick and Morty the minimum number of puppies they need in order to make all people in ALT happy, and also provide an optimal way to distribute these puppies." 3200.0                                 
               786B Legacy "data structures,graphs,shortest paths" "Rick and his co-workers have made a new radioactive formula and a lot of bad guys are after them. So Rick wants to give his legacy to Morty before bad guys catch them. There are n planets in their universe numbered from 1 to n. Rick is in planet number s (the earth) and he doesn\'t know where Morty is. As we all know, Rick owns a portal gun. With this gun he can open one-way portal from a planet he is in to any other planet (including that planet). But there are limits on this gun because he\'s still using its free trial.  By default he can not open any portal by this gun. There are q plans in the website that sells these guns. Every time you purchase a plan you can only use it once but you can purchase it again if you want to use it more.Plans on the website have three types:  With a plan of this type you can open a portal from planet v to planet u.  With a plan of this type you can open a portal from planet v to any planet with index in range [l,\xe2\x80\x89r].  With a plan of this type you can open a portal from any planet with index in range [l,\xe2\x80\x89r] to planet v. Rick doesn\'t known where Morty is, but Unity is going to inform him and he wants to be prepared for when he finds and start his journey immediately. So for each planet (including earth itself) he wants to know the minimum amount of money he needs to get from earth to that planet." 2300.0                                 
               785B "Anton and Classes" greedy,sortings "Anton likes to play chess. Also he likes to do programming. No wonder that he decided to attend chess classes and programming classes.Anton has n variants when he will attend chess classes, i-th variant is given by a period of time (l1,\xe2\x80\x89i,\xe2\x80\x89r1,\xe2\x80\x89i). Also he has m variants when he will attend programming classes, i-th variant is given by a period of time (l2,\xe2\x80\x89i,\xe2\x80\x89r2,\xe2\x80\x89i).Anton needs to choose exactly one of n possible periods of time when he will attend chess classes and exactly one of m possible periods of time when he will attend programming classes. He wants to have a rest between classes, so from all the possible pairs of the periods he wants to choose the one where the distance between the periods is maximal.The distance between periods (l1,\xe2\x80\x89r1) and (l2,\xe2\x80\x89r2) is the minimal possible distance between a point in the first period and a point in the second period, that is the minimal possible |i\xe2\x80\x89-\xe2\x80\x89j|, where l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1 and l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2. In particular, when the periods intersect, the distance between them is 0.Anton wants to know how much time his rest between the classes will last in the best case. Help Anton and find this number!" 1100.0                                 
               780F "Axel and Marston in Bitland" bitmasks,dp,graphs,matrices "A couple of friends, Axel and Marston are travelling across the country of Bitland. There are n towns in Bitland, with some pairs of towns connected by one-directional roads. Each road in Bitland is either a pedestrian road or a bike road. There can be multiple roads between any pair of towns, and may even be a road from a town to itself. However, no pair of roads shares the starting and the destination towns along with their types simultaneously.The friends are now located in the town 1 and are planning the travel route. Axel enjoys walking, while Marston prefers biking. In order to choose a route diverse and equally interesting for both friends, they have agreed upon the following procedure for choosing the road types during the travel: The route starts with a pedestrian route. Suppose that a beginning of the route is written in a string s of letters P (pedestrain road) and B (biking road). Then, the string  is appended to s, where  stands for the string s with each character changed to opposite (that is, all pedestrian roads changed to bike roads, and vice versa).In the first few steps the route will look as follows: P, PB, PBBP, PBBPBPPB, PBBPBPPBBPPBPBBP, and so on.After that the friends start travelling from the town 1 via Bitlandian roads, choosing the next road according to the next character of their route type each time. If it is impossible to choose the next road, the friends terminate their travel and fly home instead.Help the friends to find the longest possible route that can be travelled along roads of Bitland according to the road types choosing procedure described above. If there is such a route with more than 1018 roads in it, print -1 instead." 2400.0                                 
               780C "Andryusha and Colored Balloons" "dfs and similar,graphs,greedy,trees" "Andryusha goes through a park each day. The squares and paths between them look boring to Andryusha, so he decided to decorate them.The park consists of n squares connected with (n\xe2\x80\x89-\xe2\x80\x891) bidirectional paths in such a way that any square is reachable from any other using these paths. Andryusha decided to hang a colored balloon at each of the squares. The baloons\' colors are described by positive integers, starting from 1. In order to make the park varicolored, Andryusha wants to choose the colors in a special way. More precisely, he wants to use such colors that if a, b and c are distinct squares that a and b have a direct path between them, and b and c have a direct path between them, then balloon colors on these three squares are distinct.Andryusha wants to use as little different colors as possible. Help him to choose the colors!" 1600.0                                 
               778A "String Game" "binary search,greedy,strings" "Little Nastya has a hobby, she likes to remove some letters from word, to obtain another word. But it turns out to be pretty hard for her, because she is too young. Therefore, her brother Sergey always helps her.Sergey gives Nastya the word t and wants to get the word p out of it. Nastya removes letters in a certain order (one after another, in this order strictly), which is specified by permutation of letters\' indices of the word t: a1... a|t|. We denote the length of word x as |x|. Note that after removing one letter, the indices of other letters don\'t change. For example, if t\xe2\x80\x89=\xe2\x80\x89""nastya"" and a\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x891,\xe2\x80\x895,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x896] then removals make the following sequence of words ""nastya""  ""nastya""  ""nastya""  ""nastya""  ""nastya""  ""nastya""  ""nastya"".Sergey knows this permutation. His goal is to stop his sister at some point and continue removing by himself to get the word p. Since Nastya likes this activity, Sergey wants to stop her as late as possible. Your task is to determine, how many letters Nastya can remove before she will be stopped by Sergey.It is guaranteed that the word p can be obtained by removing the letters from word t." 1700.0                                 
               777C "Alyona and Spreadsheet" "binary search,data structures,dp,greedy,implementation,two pointers" "During the lesson small girl Alyona works with one famous spreadsheet computer program and learns how to edit tables.Now she has a table filled with integers. The table consists of n rows and m columns. By ai,\xe2\x80\x89j we will denote the integer located at the i-th row and the j-th column. We say that the table is sorted in non-decreasing order in the column j if ai,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891.Teacher gave Alyona k tasks. For each of the tasks two integers l and r are given and Alyona has to answer the following question: if one keeps the rows from l to r inclusive and deletes all others, will the table be sorted in non-decreasing order in at least one column? Formally, does there exist such j that ai,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j for all i from l to r\xe2\x80\x89-\xe2\x80\x891 inclusive.Alyona is too small to deal with this task and asks you to help!" 1600.0                                 
               773D "Perishable Roads" "dp,graphs,shortest paths" "In the country of Never, there are n cities and a well-developed road system. There is exactly one bidirectional road between every pair of cities, thus, there are as many as  roads! No two roads intersect, and no road passes through intermediate cities. The art of building tunnels and bridges has been mastered by Neverians.An independent committee has evaluated each road of Never with a positive integer called the perishability of the road. The lower the road\'s perishability is, the more pleasant it is to drive through this road.It\'s the year of transport in Never. It has been decided to build a museum of transport in one of the cities, and to set a single signpost directing to some city (not necessarily the one with the museum) in each of the other cities. The signposts must satisfy the following important condition: if any Neverian living in a city without the museum starts travelling from that city following the directions of the signposts, then this person will eventually arrive in the city with the museum.Neverians are incredibly positive-minded. If a Neverian travels by a route consisting of several roads, he considers the perishability of the route to be equal to the smallest perishability of all the roads in this route.The government of Never has not yet decided where to build the museum, so they consider all n possible options. The most important is the sum of perishabilities of the routes to the museum city from all the other cities of Never, if the travelers strictly follow the directions of the signposts. The government of Never cares about their citizens, so they want to set the signposts in a way which minimizes this sum. Help them determine the minimum possible sum for all n possible options of the city where the museum can be built." 2700.0                                 
               768C "Jon Snow and his Favourite Number" "brute force,dp,implementation,sortings" "Jon Snow now has to fight with White Walkers. He has n rangers, each of which has his own strength. Also Jon Snow has his favourite number x. Each ranger can fight with a white walker only if the strength of the white walker equals his strength. He however thinks that his rangers are weak and need to improve. Jon now thinks that if he takes the bitwise XOR of strengths of some of rangers with his favourite number x, he might get soldiers of high strength. So, he decided to do the following operation k times:  Arrange all the rangers in a straight line in the order of increasing strengths. Take the bitwise XOR (is written as ) of the strength of each alternate ranger with x and update it\'s strength. Suppose, Jon has 5 rangers with strengths [9,\xe2\x80\x897,\xe2\x80\x8911,\xe2\x80\x8915,\xe2\x80\x895] and he performs the operation 1 time with x\xe2\x80\x89=\xe2\x80\x892. He first arranges them in the order of their strengths, [5,\xe2\x80\x897,\xe2\x80\x899,\xe2\x80\x8911,\xe2\x80\x8915]. Then he does the following:  The strength of first ranger is updated to , i.e. 7. The strength of second ranger remains the same, i.e. 7. The strength of third ranger is updated to , i.e. 11. The strength of fourth ranger remains the same, i.e. 11. The strength of fifth ranger is updated to , i.e. 13. The new strengths of the 5 rangers are [7,\xe2\x80\x897,\xe2\x80\x8911,\xe2\x80\x8911,\xe2\x80\x8913]Now, Jon wants to know the maximum and minimum strength of the rangers after performing the above operations k times. He wants your help for this task. Can you help him?" 1800.0                                 
               768A "Oath of the Night\'s Watch" "constructive algorithms,sortings" """Night gathers, and now my watch begins. It shall not end until my death. I shall take no wife, hold no lands, father no children. I shall wear no crowns and win no glory. I shall live and die at my post. I am the sword in the darkness. I am the watcher on the walls. I am the shield that guards the realms of men. I pledge my life and honor to the Night\'s Watch, for this night and all the nights to come."" \xe2\x80\x94 The Night\'s Watch oath.With that begins the watch of Jon Snow. He is assigned the task to support the stewards.This time he has n stewards with him whom he has to provide support. Each steward has his own strength. Jon Snow likes to support a steward only if there exists at least one steward who has strength strictly less than him and at least one steward who has strength strictly greater than him.Can you find how many stewards will Jon support?" 900.0                                 
               765F Souvenirs "data structures" "Artsem is on vacation and wants to buy souvenirs for his two teammates. There are n souvenir shops along the street. In i-th shop Artsem can buy one souvenir for ai dollars, and he cannot buy more than one souvenir in one shop. He doesn\'t want to introduce envy in his team, so he wants to buy two souvenirs with least possible difference in price.Artsem has visited the shopping street m times. For some strange reason on the i-th day only shops with numbers from li to ri were operating (weird? yes it is, but have you ever tried to come up with a reasonable legend for a range query problem?). For each visit, Artsem wants to know the minimum possible difference in prices of two different souvenirs he can buy in the opened shops.In other words, for each Artsem\'s visit you should find the minimum possible value of |as\xe2\x80\x89-\xe2\x80\x89at| where li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s,\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri, s\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t." 3100.0                                 
               765D "Artsem and Saunders" "constructive algorithms,dsu,math" "Artsem has a friend Saunders from University of Chicago. Saunders presented him with the following problem.Let [n] denote the set {1,\xe2\x80\x89...,\xe2\x80\x89n}. We will also write f:\xe2\x80\x89[x]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[y] when a function f is defined in integer points 1, ..., x, and all its values are integers from 1 to y.Now then, you are given a function f:\xe2\x80\x89[n]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[n]. Your task is to find a positive integer m, and two functions g:\xe2\x80\x89[n]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[m], h:\xe2\x80\x89[m]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[n], such that g(h(x))\xe2\x80\x89=\xe2\x80\x89x for all , and h(g(x))\xe2\x80\x89=\xe2\x80\x89f(x) for all , or determine that finding these is impossible." 1700.0                                 
               764B "Timofey and cubes" "constructive algorithms,implementation" "Young Timofey has a birthday today! He got kit of n cubes as a birthday present from his parents. Every cube has a number ai, which is written on it. Timofey put all the cubes in a row and went to unpack other presents.In this time, Timofey\'s elder brother, Dima reordered the cubes using the following rule. Suppose the cubes are numbered from 1 to n in their order. Dima performs several steps, on step i he reverses the segment of cubes from i-th to (n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891)-th. He does this while i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891.After performing the operations Dima went away, being very proud of himself. When Timofey returned to his cubes, he understood that their order was changed. Help Timofey as fast as you can and save the holiday \xe2\x80\x94 restore the initial order of the cubes using information of their current location." 900.0                                 
               761F "Dasha and Photos" "brute force,data structures,dp,implementation" "Dasha decided to have a rest after solving the problem D and began to look photos from previous competitions.Let\'s call photos as the matrix with the size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, which consists of lowercase English letters.Some k photos especially interested her, because they can be received from photo-template by painting a rectangular area in a certain color. Let\'s call such photos special.   More formally the i-th special photo is received from the photo-template by replacing all characters on some rectangle with upper left corner of the cell with coordinates (ai,\xe2\x80\x89bi) and lower right corner in the cell with coordinates (ci,\xe2\x80\x89di) to the symbol ei.Dasha asks you to find the special photo so that the total distance from it to all other special photos is minimum. And calculate this distance.Determine the distance between two photos as the sum of distances between all corresponding letters. The distance between two letters is the difference module of their positions in the alphabet. For example, the distance between letters \'h\' and \'m\' equals |8\xe2\x80\x89-\xe2\x80\x8913|\xe2\x80\x89=\xe2\x80\x895, because the letter \'h\' is the 8-th in the alphabet, the letter \'m\' is the 13-th." 2600.0                                 
               761E "Dasha and Puzzle" "constructive algorithms,dfs and similar,graphs,greedy,trees" "Dasha decided to have a rest after solving the problem. She had been ready to start her favourite activity \xe2\x80\x94 origami, but remembered the puzzle that she could not solve.   The tree is a non-oriented connected graph without cycles. In particular, there always are n\xe2\x80\x89-\xe2\x80\x891 edges in a tree with n vertices.The puzzle is to position the vertices at the points of the Cartesian plane with integral coordinates, so that the segments between the vertices connected by edges are parallel to the coordinate axes. Also, the intersection of segments is allowed only at their ends. Distinct vertices should be placed at different points. Help Dasha to find any suitable way to position the tree vertices on the plane.It is guaranteed that if it is possible to position the tree vertices on the plane without violating the condition which is given above, then you can do it by using points with integral coordinates which don\'t exceed 1018 in absolute value." 2000.0                                 
               761D "Dasha and Very Difficult Problem" "binary search,brute force,constructive algorithms,greedy,sortings" "Dasha logged into the system and began to solve problems. One of them is as follows:Given two sequences a and b of length n each you need to write a sequence c of length n, the i-th element of which is calculated as follows: ci\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x89ai.About sequences a and b we know that their elements are in the range from l to r. More formally, elements satisfy the following conditions: l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. About sequence c we know that all its elements are distinct.  Dasha wrote a solution to that problem quickly, but checking her work on the standard test was not so easy. Due to an error in the test system only the sequence a and the compressed sequence of the sequence c were known from that test.Let\'s give the definition to a compressed sequence. A compressed sequence of sequence c of length n is a sequence p of length n, so that pi equals to the number of integers which are less than or equal to ci in the sequence c. For example, for the sequence c\xe2\x80\x89=\xe2\x80\x89[250,\xe2\x80\x89200,\xe2\x80\x89300,\xe2\x80\x89100,\xe2\x80\x8950] the compressed sequence will be p\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x893,\xe2\x80\x895,\xe2\x80\x892,\xe2\x80\x891]. Pay attention that in c all integers are distinct. Consequently, the compressed sequence contains all integers from 1 to n inclusively.Help Dasha to find any sequence b for which the calculated compressed sequence of sequence c is correct." 1700.0                                 
               758D "Ability To Convert" "constructive algorithms,dp,greedy,math,strings" "Alexander is learning how to convert numbers from the decimal system to any other, however, he doesn\'t know English letters, so he writes any number only as a decimal number, it means that instead of the letter A he will write the number 10. Thus, by converting the number 475 from decimal to hexadecimal system, he gets 11311 (475\xe2\x80\x89=\xe2\x80\x891\xc2\xb7162\xe2\x80\x89+\xe2\x80\x8913\xc2\xb7161\xe2\x80\x89+\xe2\x80\x8911\xc2\xb7160). Alexander lived calmly until he tried to convert the number back to the decimal number system.Alexander remembers that he worked with little numbers so he asks to find the minimum decimal number so that by converting it to the system with the base n he will get the number k." 2000.0                                 
               755D "PolandBall and Polygon" "data structures" "PolandBall has such a convex polygon with n veritces that no three of its diagonals intersect at the same point. PolandBall decided to improve it and draw some red segments. He chose a number k such that gcd(n,\xe2\x80\x89k)\xe2\x80\x89=\xe2\x80\x891. Vertices of the polygon are numbered from 1 to n in a clockwise way. PolandBall repeats the following process n times, starting from the vertex 1: Assume you\'ve ended last operation in vertex x (consider x\xe2\x80\x89=\xe2\x80\x891 if it is the first operation). Draw a new segment from vertex x to k-th next vertex in clockwise direction. This is a vertex x\xe2\x80\x89+\xe2\x80\x89k or x\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x89n depending on which of these is a valid index of polygon\'s vertex.Your task is to calculate number of polygon\'s sections after each drawing. A section is a clear area inside the polygon bounded with drawn diagonals or the polygon\'s sides." 2000.0                                 
               754A "Lesha and array splitting" "constructive algorithms,greedy,implementation" "One spring day on his way to university Lesha found an array A. Lesha likes to split arrays into several parts. This time Lesha decided to split the array A into several, possibly one, new arrays so that the sum of elements in each of the new arrays is not zero. One more condition is that if we place the new arrays one after another they will form the old array A.Lesha is tired now so he asked you to split the array. Help Lesha!" 1200.0                                 
               750D "New Year and Fireworks" "brute force,data structures,dfs and similar,dp,implementation" "One tradition of welcoming the New Year is launching fireworks into the sky. Usually a launched firework flies vertically upward for some period of time, then explodes, splitting into several parts flying in different directions. Sometimes those parts also explode after some period of time, splitting into even more parts, and so on.Limak, who lives in an infinite grid, has a single firework. The behaviour of the firework is described with a recursion depth n and a duration for each level of recursion t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. Once Limak launches the firework in some cell, the firework starts moving upward. After covering t1 cells (including the starting cell), it explodes and splits into two parts, each moving in the direction changed by 45 degrees (see the pictures below for clarification). So, one part moves in the top-left direction, while the other one moves in the top-right direction. Each part explodes again after covering t2 cells, splitting into two parts moving in directions again changed by 45 degrees. The process continues till the n-th level of recursion, when all 2n\xe2\x80\x89-\xe2\x80\x891 existing parts explode and disappear without creating new parts. After a few levels of recursion, it\'s possible that some parts will be at the same place and at the same time \xe2\x80\x94 it is allowed and such parts do not crash.Before launching the firework, Limak must make sure that nobody stands in cells which will be visited at least once by the firework. Can you count the number of those cells?" 1900.0                                 
               744B "Hongcow\'s Game" "bitmasks,divide and conquer,interactive" "This is an interactive problem. In the interaction section below you will see the information about flushing the output.In this problem, you will be playing a game with Hongcow. How lucky of you!Hongcow has a hidden n by n matrix M. Let Mi,\xe2\x80\x89j denote the entry i-th row and j-th column of the matrix. The rows and columns are labeled from 1 to n.The matrix entries are between 0 and 109. In addition, Mi,\xe2\x80\x89i\xe2\x80\x89=\xe2\x80\x890 for all valid i. Your task is to find the minimum value along each row, excluding diagonal elements. Formally, for each i, you must find .To do this, you can ask Hongcow some questions.A question consists of giving Hongcow a subset of distinct indices {w1,\xe2\x80\x89w2,\xe2\x80\x89...,\xe2\x80\x89wk}, with 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Hongcow will respond with n integers. The i-th integer will contain the minimum value of min1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89kMi,\xe2\x80\x89wj.You may only ask Hongcow at most 20 questions \xe2\x80\x94 he thinks you only need that many questions answered.When you are ready to answer, print out a single integer \xe2\x80\x89-\xe2\x80\x891 on its own line, then n integers on the next line. The i-th integer should be the minimum value in the i-th row of the matrix, excluding the i-th element. Do not forget to flush the final answer as well. Printing the answer does not count as asking a question.You will get Wrong Answer verdict if   Your question or answers are not in the format described in this statement.  You ask strictly more than 20 questions.  Your question contains duplicate indices.  The value of k in your question does not lie in the range from 1 to n, inclusive.  Your final answer is not correct.  You will get Idleness Limit Exceeded if you don\'t print anything or if you forget to flush the output, including for the final answer (more info about flushing output below)." 1900.0                                 
               743B "Chloe and the sequence" "binary search,bitmasks,constructive algorithms,implementation" "Chloe, the same as Vladik, is a competitive programmer. She didn\'t have any problems to get to the olympiad like Vladik, but she was confused by the task proposed on the olympiad.Let\'s consider the following algorithm of generating a sequence of integers. Initially we have a sequence consisting of a single element equal to 1. Then we perform (n\xe2\x80\x89-\xe2\x80\x891) steps. On each step we take the sequence we\'ve got on the previous step, append it to the end of itself and insert in the middle the minimum positive integer we haven\'t used before. For example, we get the sequence [1,\xe2\x80\x892,\xe2\x80\x891] after the first step, the sequence [1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891] after the second step.The task is to find the value of the element with index k (the elements are numbered from 1) in the obtained sequence, i. e. after (n\xe2\x80\x89-\xe2\x80\x891) steps.Please help Chloe to solve the problem!" 1200.0                                 
               733A "Grasshopper And the String" implementation "One day, the Grasshopper was jumping on the lawn and found a piece of paper with a string. Grasshopper became interested what is the minimum jump ability he should have in order to be able to reach the far end of the string, jumping only on vowels of the English alphabet. Jump ability is the maximum possible length of his jump. Formally, consider that at the begginning the Grasshopper is located directly in front of the leftmost character of the string. His goal is to reach the position right after the rightmost character of the string. In one jump the Grasshopper could jump to the right any distance from 1 to the value of his jump ability.  The picture corresponds to the first example. The following letters are vowels: \'A\', \'E\', \'I\', \'O\', \'U\' and \'Y\'." 1000.0                                 
               731F "Video Cards" "brute force,data structures,implementation,math,number theory" "Little Vlad is fond of popular computer game Bota-2. Recently, the developers announced the new add-on named Bota-3. Of course, Vlad immediately bought only to find out his computer is too old for the new game and needs to be updated.There are n video cards in the shop, the power of the i-th video card is equal to integer value ai. As Vlad wants to be sure the new game will work he wants to buy not one, but several video cards and unite their powers using the cutting-edge technology. To use this technology one of the cards is chosen as the leading one and other video cards are attached to it as secondary. For this new technology to work it\'s required that the power of each of the secondary video cards is divisible by the power of the leading video card. In order to achieve that the power of any secondary video card can be reduced to any integer value less or equal than the current power. However, the power of the leading video card should remain unchanged, i.e. it can\'t be reduced.Vlad has an infinite amount of money so he can buy any set of video cards. Help him determine which video cards he should buy such that after picking the leading video card and may be reducing some powers of others to make them work together he will get the maximum total value of video power." 1900.0                                 
               731A "Night at the Museum" implementation,strings "Grigoriy, like the hero of one famous comedy film, found a job as a night security guard at the museum. At first night he received embosser and was to take stock of the whole exposition.Embosser is a special devise that allows to ""print"" the text of a plastic tape. Text is printed sequentially, character by character. The device consists of a wheel with a lowercase English letters written in a circle, static pointer to the current letter and a button that print the chosen letter. At one move it\'s allowed to rotate the alphabetic wheel one step clockwise or counterclockwise. Initially, static pointer points to letter \'a\'. Other letters are located as shown on the picture:  After Grigoriy add new item to the base he has to print its name on the plastic tape and attach it to the corresponding exhibit. It\'s not required to return the wheel to its initial position with pointer on the letter \'a\'.Our hero is afraid that some exhibits may become alive and start to attack him, so he wants to print the names as fast as possible. Help him, for the given string find the minimum number of rotations of the wheel required to print it." 800.0                                 
               730K "Roads Orientation Problem" graphs "Berland consists of n cities and m bidirectional roads connecting pairs of cities. There is no road connecting a city to itself, and between any pair of cities there is no more than one road. It is possible to reach any city from any other moving along roads.Currently Mr. President is in the city s and his destination is the city t. He plans to move along roads from s to t (s\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t).That\'s why Ministry of Fools and Roads has difficult days. The minister is afraid that Mr. President could get into a traffic jam or get lost. Who knows what else can happen!To be sure that everything goes as planned, the minister decided to temporarily make all roads one-way. So each road will be oriented in one of two possible directions. The following conditions must be satisfied:  There should be no cycles along roads after orientation.  The city s should be the only such city that all its roads are oriented out (i.e. there are no ingoing roads to the city s and the city s is the only such city).  The city t should be the only such city that all its roads are oriented in (i.e. there are no outgoing roads from the city t and the city t is the only such city). Help the minister solve his problem. Write a program to find any such orientation of all roads or report that no solution exists." 3200.0                                 
               730D "Running Over The Bridges" greedy,implementation,math "Polycarp is playing a game called ""Running Over The Bridges"". In this game he has to run over n bridges from the left to the right. Bridges are arranged one after the other, so the i-th bridge begins where the (i\xe2\x80\x89-\xe2\x80\x891)-th bridge ends.You have the following data about bridges: li and ti \xe2\x80\x94 the length of the i-th bridge and the maximum allowed time which Polycarp can spend running over the i-th bridge. Thus, if Polycarp is in the beginning of the bridge i at the time T then he has to leave it at the time T\xe2\x80\x89+\xe2\x80\x89ti or earlier. It is allowed to reach the right end of a bridge exactly at the time T\xe2\x80\x89+\xe2\x80\x89ti.Polycarp can run from the left side to the right one with speed 0.5, so he will run over a bridge with length s in time 2\xc2\xb7s. Besides, he has several magical drinks. If he uses one drink, his speed increases twice (i.e. to value 1) for r seconds. All magical drinks are identical. Please note that Polycarp can use a drink only at integer moments of time, and he drinks it instantly and completely. Additionally, if Polycarp uses a drink at the moment T he can use the next drink not earlier than at the moment T\xe2\x80\x89+\xe2\x80\x89r.What is the minimal number of drinks Polycarp has to use to run over all n bridges? If this number is not greater than 105, then you have to find out the moments of time when Polycarp has to use each magical drink." 2200.0                                 
               730A "Toda 2" greedy,implementation "A group of n friends enjoys playing popular video game Toda 2. There is a rating system describing skill level of each player, initially the rating of the i-th friend is ri.The friends decided to take part in the championship as a team. But they should have equal ratings to be allowed to compose a single team consisting of all n friends. So the friends are faced with the problem: how to make all their ratings equal.One way to change ratings is to willingly lose in some matches. Friends can form a party consisting of two to five (but not more than n) friends and play a match in the game. When the party loses, the rating of each of its members decreases by 1. A rating can\'t become negative, so ri\xe2\x80\x89=\xe2\x80\x890 doesn\'t change after losing.The friends can take part in multiple matches, each time making a party from any subset of friends (but remember about constraints on party size: from 2 to 5 members).The friends want to make their ratings equal but as high as possible.Help the friends develop a strategy of losing the matches so that all their ratings become equal and the resulting rating is maximum possible." 1800.0                                 
               729F "Financiers Game" dp "This problem has unusual memory constraint.At evening, Igor and Zhenya the financiers became boring, so they decided to play a game. They prepared n papers with the income of some company for some time periods. Note that the income can be positive, zero or negative.Igor and Zhenya placed the papers in a row and decided to take turns making moves. Igor will take the papers from the left side, Zhenya will take the papers from the right side. Igor goes first and takes 1 or 2 (on his choice) papers from the left. Then, on each turn a player can take k or k\xe2\x80\x89+\xe2\x80\x891 papers from his side if the opponent took exactly k papers in the previous turn. Players can\'t skip moves. The game ends when there are no papers left, or when some of the players can\'t make a move.Your task is to determine the difference between the sum of incomes on the papers Igor took and the sum of incomes on the papers Zhenya took, assuming both players play optimally. Igor wants to maximize the difference, Zhenya wants to minimize it." 2500.0                                 
               729E Subordinates "constructive algorithms,data structures,graphs,greedy,sortings" "There are n workers in a company, each of them has a unique id from 1 to n. Exaclty one of them is a chief, his id is s. Each worker except the chief has exactly one immediate superior.There was a request to each of the workers to tell how how many superiors (not only immediate). Worker\'s superiors are his immediate superior, the immediate superior of the his immediate superior, and so on. For example, if there are three workers in the company, from which the first is the chief, the second worker\'s immediate superior is the first, the third worker\'s immediate superior is the second, then the third worker has two superiors, one of them is immediate and one not immediate. The chief is a superior to all the workers except himself.Some of the workers were in a hurry and made a mistake. You are to find the minimum number of workers that could make a mistake." 1900.0                                 
               729B Spotlights dp,implementation "Theater stage is a rectangular field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. The director gave you the stage\'s plan which actors will follow. For each cell it is stated in the plan if there would be an actor in this cell or not.You are to place a spotlight on the stage in some good position. The spotlight will project light in one of the four directions (if you look at the stage from above) \xe2\x80\x94 left, right, up or down. Thus, the spotlight\'s position is a cell it is placed to and a direction it shines.A position is good if two conditions hold:   there is no actor in the cell the spotlight is placed to;  there is at least one actor in the direction the spotlight projects. Count the number of good positions for placing the spotlight. Two positions of spotlight are considered to be different if the location cells or projection direction differ." 1200.0                                 
               727B "Bill Total Value" "expression parsing,implementation,strings" "Vasily exited from a store and now he wants to recheck the total price of all purchases in his bill. The bill is a string in which the names of the purchases and their prices are printed in a row without any spaces. Check has the format ""name1price1name2price2...namenpricen"", where namei (name of the i-th purchase) is a non-empty string of length not more than 10, consisting of lowercase English letters, and pricei (the price of the i-th purchase) is a non-empty string, consisting of digits and dots (decimal points). It is possible that purchases with equal names have different prices.The price of each purchase is written in the following format. If the price is an integer number of dollars then cents are not written.Otherwise, after the number of dollars a dot (decimal point) is written followed by cents in a two-digit format (if number of cents is between 1 and 9 inclusively, there is a leading zero).Also, every three digits (from less significant to the most) in dollars are separated by dot (decimal point). No extra leading zeroes are allowed. The price always starts with a digit and ends with a digit.For example:  ""234"", ""1.544"", ""149.431.10"", ""0.99"" and ""123.05"" are valid prices,  "".333"", ""3.33.11"", ""12.00"", "".33"", ""0.1234"" and ""1.2"" are not valid. Write a program that will find the total price of all purchases in the given bill." 1600.0                                 
               727A "Transformation: from A to B" "brute force,dfs and similar,math" "Vasily has a number a, which he wants to turn into a number b. For this purpose, he can do two types of operations:  multiply the current number by 2 (that is, replace the number x by 2\xc2\xb7x);  append the digit 1 to the right of current number (that is, replace the number x by 10\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891). You need to help Vasily to transform the number a into the number b using only the operations described above, or find that it is impossible.Note that in this task you are not required to minimize the number of operations. It suffices to find any way to transform a into b." 1000.0                                 
               725B "Food on the Plane" implementation,math "A new airplane SuperPuperJet has an infinite number of rows, numbered with positive integers starting with 1 from cockpit to tail. There are six seats in each row, denoted with letters from \'a\' to \'f\'. Seats \'a\', \'b\' and \'c\' are located to the left of an aisle (if one looks in the direction of the cockpit), while seats \'d\', \'e\' and \'f\' are located to the right. Seats \'a\' and \'f\' are located near the windows, while seats \'c\' and \'d\' are located near the aisle.    It\'s lunch time and two flight attendants have just started to serve food. They move from the first rows to the tail, always maintaining a distance of two rows from each other because of the food trolley. Thus, at the beginning the first attendant serves row 1 while the second attendant serves row 3. When both rows are done they move one row forward: the first attendant serves row 2 while the second attendant serves row 4. Then they move three rows forward and the first attendant serves row 5 while the second attendant serves row 7. Then they move one row forward again and so on.Flight attendants work with the same speed: it takes exactly 1 second to serve one passenger and 1 second to move one row forward. Each attendant first serves the passengers on the seats to the right of the aisle and then serves passengers on the seats to the left of the aisle (if one looks in the direction of the cockpit). Moreover, they always serve passengers in order from the window to the aisle. Thus, the first passenger to receive food in each row is located in seat \'f\', and the last one \xe2\x80\x94 in seat \'c\'. Assume that all seats are occupied.Vasya has seat s in row n and wants to know how many seconds will pass before he gets his lunch." 1200.0                                 
               723B "Text Document Analysis" "expression parsing,implementation,strings" "Modern text editors usually show some information regarding the document being edited. For example, the number of words, the number of pages, or the number of characters.In this problem you should implement the similar functionality.You are given a string which only consists of:  uppercase and lowercase English letters,  underscore symbols (they are used as separators),  parentheses (both opening and closing). It is guaranteed that each opening parenthesis has a succeeding closing parenthesis. Similarly, each closing parentheses has a preceding opening parentheses matching it. For each pair of matching parentheses there are no other parenthesis between them. In other words, each parenthesis in the string belongs to a matching ""opening-closing"" pair, and such pairs can\'t be nested.For example, the following string is valid: ""_Hello_Vasya(and_Petya)__bye_(and_OK)"".Word is a maximal sequence of consecutive letters, i.e. such sequence that the first character to the left and the first character to the right of it is an underscore, a parenthesis, or it just does not exist. For example, the string above consists of seven words: ""Hello"", ""Vasya"", ""and"", ""Petya"", ""bye"", ""and"" and ""OK"". Write a program that finds:  the length of the longest word outside the parentheses (print 0, if there is no word outside the parentheses),  the number of words inside the parentheses (print 0, if there is no word inside the parentheses)." 1100.0                                 
               722F "Cyclic Cipher" "chinese remainder theorem,data structures,implementation,number theory,two pointers" "You are given n sequences. Each sequence consists of positive integers, not exceeding m. All integers in one sequence are distinct, but the same integer may appear in multiple sequences. The length of the i-th sequence is ki.Each second integers in each of the sequences are shifted by one to the left, i.e. integers at positions i\xe2\x80\x89>\xe2\x80\x891 go to positions i\xe2\x80\x89-\xe2\x80\x891, while the first integers becomes the last.Each second we take the first integer of each sequence and write it down to a new array. Then, for each value x from 1 to m we compute the longest segment of the array consisting of element x only.The above operation is performed for 10100 seconds. For each integer from 1 to m find out the longest segment found at this time." 2800.0                                 
               722D "Generating Sets" "binary search,data structures,dfs and similar,greedy,strings,trees" "You are given a set Y of n distinct positive integers y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn.Set X of n distinct positive integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn is said to generate set Y if one can transform X to Y by applying some number of the following two operation to integers in X:  Take any integer xi and multiply it by two, i.e. replace xi with 2\xc2\xb7xi.  Take any integer xi, multiply it by two and add one, i.e. replace xi with 2\xc2\xb7xi\xe2\x80\x89+\xe2\x80\x891. Note that integers in X are not required to be distinct after each operation.Two sets of distinct integers X and Y are equal if they are equal as sets. In other words, if we write elements of the sets in the array in the increasing order, these arrays would be equal.Note, that any set of integers (or its permutation) generates itself.You are given a set Y and have to find a set X that generates Y and the maximum element of X is mininum possible." 1900.0                                 
               721C Journey dp,graphs "Recently Irina arrived to one of the most famous cities of Berland \xe2\x80\x94 the Berlatov city. There are n showplaces in the city, numbered from 1 to n, and some of them are connected by one-directional roads. The roads in Berlatov are designed in a way such that there are no cyclic routes between showplaces.Initially Irina stands at the showplace 1, and the endpoint of her journey is the showplace n. Naturally, Irina wants to visit as much showplaces as she can during her journey. However, Irina\'s stay in Berlatov is limited and she can\'t be there for more than T time units.Help Irina determine how many showplaces she may visit during her journey from showplace 1 to showplace n within a time not exceeding T. It is guaranteed that there is at least one route from showplace 1 to showplace n such that Irina will spend no more than T time units passing it." 1800.0                                 
               717G Underfail flows "You have recently fallen through a hole and, after several hours of unconsciousness, have realized you are in an underground city. On one of your regular, daily walks through the unknown, you have encountered two unusually looking skeletons called Sanz and P\xe2\x80\x99pairus, who decided to accompany you and give you some puzzles for seemingly unknown reasons.One day, Sanz has created a crossword for you. Not any kind of crossword, but a 1D crossword! You are given m words and a string of length n. You are also given an array p, which designates how much each word is worth \xe2\x80\x94 the i-th word is worth pi points. Whenever you find one of the m words in the string, you are given the corresponding number of points. Each position in the crossword can be used at most x times. A certain word can be counted at different places, but you cannot count the same appearance of a word multiple times. If a word is a substring of another word, you can count them both (presuming you haven\xe2\x80\x99t used the positions more than x times).In order to solve the puzzle, you need to tell Sanz what\xe2\x80\x99s the maximum achievable number of points in the crossword. There is no need to cover all postions, just get the maximal score! Crossword and words contain only lowercase English letters." 2400.0                                 
               716B "Complete the Word" "greedy,two pointers" "ZS the Coder loves to read the dictionary. He thinks that a word is nice if there exists a substring (contiguous segment of letters) of it of length 26 where each letter of English alphabet appears exactly once. In particular, if the string has length strictly less than 26, no such substring exists and thus it is not nice.Now, ZS the Coder tells you a word, where some of its letters are missing as he forgot them. He wants to determine if it is possible to fill in the missing letters so that the resulting word is nice. If it is possible, he needs you to find an example of such a word as well. Can you help him?" 1300.0                                 
               711C "Coloring Trees" dp "ZS the Coder and Chris the Baboon has arrived at Udayland! They walked in the park where n trees grow. They decided to be naughty and color the trees in the park. The trees are numbered with integers from 1 to n from left to right.Initially, tree i has color ci. ZS the Coder and Chris the Baboon recognizes only m different colors, so 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m, where ci\xe2\x80\x89=\xe2\x80\x890 means that tree i is uncolored.ZS the Coder and Chris the Baboon decides to color only the uncolored trees, i.e. the trees with ci\xe2\x80\x89=\xe2\x80\x890. They can color each of them them in any of the m colors from 1 to m. Coloring the i-th tree with color j requires exactly pi,\xe2\x80\x89j litres of paint.The two friends define the beauty of a coloring of the trees as the minimum number of contiguous groups (each group contains some subsegment of trees) you can split all the n trees into so that each group contains trees of the same color. For example, if the colors of the trees from left to right are 2,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x893, the beauty of the coloring is 7, since we can partition the trees into 7 contiguous groups of the same color : {2},\xe2\x80\x89{1,\xe2\x80\x891,\xe2\x80\x891},\xe2\x80\x89{3},\xe2\x80\x89{2,\xe2\x80\x892},\xe2\x80\x89{3},\xe2\x80\x89{1},\xe2\x80\x89{3}. ZS the Coder and Chris the Baboon wants to color all uncolored trees so that the beauty of the coloring is exactly k. They need your help to determine the minimum amount of paint (in litres) needed to finish the job.Please note that the friends can\'t color the trees that are already colored." 1700.0                                 
               710D "Two Arithmetic Progressions" "math,number theory" "You are given two arithmetic progressions: a1k\xe2\x80\x89+\xe2\x80\x89b1 and a2l\xe2\x80\x89+\xe2\x80\x89b2. Find the number of integers x such that L\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89R and x\xe2\x80\x89=\xe2\x80\x89a1k\'\xe2\x80\x89+\xe2\x80\x89b1\xe2\x80\x89=\xe2\x80\x89a2l\'\xe2\x80\x89+\xe2\x80\x89b2, for some integers k\',\xe2\x80\x89l\'\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890." 2500.0                                 
               705B "Spider Man" games,math "Peter Parker wants to play a game with Dr. Octopus. The game is about cycles. Cycle is a sequence of vertices, such that first one is connected with the second, second is connected with third and so on, while the last one is connected with the first one again. Cycle may consist of a single isolated vertex.Initially there are k cycles, i-th of them consisting of exactly vi vertices. Players play alternatively. Peter goes first. On each turn a player must choose a cycle with at least 2 vertices (for example, x vertices) among all available cycles and replace it by two cycles with p and x\xe2\x80\x89-\xe2\x80\x89p vertices where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89<\xe2\x80\x89x is chosen by the player. The player who cannot make a move loses the game (and his life!).Peter wants to test some configurations of initial cycle sets before he actually plays with Dr. Octopus. Initially he has an empty set. In the i-th test he adds a cycle with ai vertices to the set (this is actually a multiset because it can contain two or more identical cycles). After each test, Peter wants to know that if the players begin the game with the current set of cycles, who wins? Peter is pretty good at math, but now he asks you to help." 1100.0                                 
               703B "Mishka and trip" implementation,math "Little Mishka is a great traveller and she visited many countries. After thinking about where to travel this time, she chose XXX \xe2\x80\x94 beautiful, but little-known northern country.Here are some interesting facts about XXX:  XXX consists of n cities, k of whose (just imagine!) are capital cities.  All of cities in the country are beautiful, but each is beautiful in its own way. Beauty value of i-th city equals to ci.  All the cities are consecutively connected by the roads, including 1-st and n-th city, forming a cyclic route 1\xe2\x80\x89\xe2\x80\x94\xe2\x80\x892\xe2\x80\x89\xe2\x80\x94\xe2\x80\x89...\xe2\x80\x89\xe2\x80\x94\xe2\x80\x89n\xe2\x80\x89\xe2\x80\x94\xe2\x80\x891. Formally, for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n there is a road between i-th and i\xe2\x80\x89+\xe2\x80\x891-th city, and another one between 1-st and n-th city.  Each capital city is connected with each other city directly by the roads. Formally, if city x is a capital city, then for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x, there is a road between cities x and i.  There is at most one road between any two cities.  Price of passing a road directly depends on beauty values of cities it connects. Thus if there is a road between cities i and j, price of passing it equals ci\xc2\xb7cj.Mishka started to gather her things for a trip, but didn\'t still decide which route to follow and thus she asked you to help her determine summary price of passing each of the roads in XXX. Formally, for every pair of cities a and b (a\xe2\x80\x89<\xe2\x80\x89b), such that there is a road between a and b you are to find sum of products ca\xc2\xb7cb. Will you help her?" 1400.0                                 
               703A "Mishka and Game" implementation "Mishka is a little polar bear. As known, little bears loves spending their free time playing dice for chocolates. Once in a wonderful sunny morning, walking around blocks of ice, Mishka met her friend Chris, and they started playing the game.Rules of the game are very simple: at first number of rounds n is defined. In every round each of the players throws a cubical dice with distinct numbers from 1 to 6 written on its faces. Player, whose value after throwing the dice is greater, wins the round. In case if player dice values are equal, no one of them is a winner.In average, player, who won most of the rounds, is the winner of the game. In case if two players won the same number of rounds, the result of the game is draw.Mishka is still very little and can\'t count wins and losses, so she asked you to watch their game and determine its result. Please help her!" 800.0                                 
               700B "Connecting Universities" "dfs and similar,dp,graphs,trees" "Treeland is a country in which there are n towns connected by n\xe2\x80\x89-\xe2\x80\x891 two-way road such that it\'s possible to get from any town to any other town. In Treeland there are 2k universities which are located in different towns. Recently, the president signed the decree to connect universities by high-speed network.The Ministry of Education understood the decree in its own way and decided that it was enough to connect each university with another one by using a cable. Formally, the decree will be done! To have the maximum sum in the budget, the Ministry decided to divide universities into pairs so that the total length of the required cable will be maximum. In other words, the total distance between universities in k pairs should be as large as possible. Help the Ministry to find the maximum total distance. Of course, each university should be present in only one pair. Consider that all roads have the same length which is equal to 1." 1800.0                                 
               697B Barnicle "brute force,implementation,math,strings" "Barney is standing in a bar and starring at a pretty girl. He wants to shoot her with his heart arrow but he needs to know the distance between him and the girl to make his shot accurate.  Barney asked the bar tender Carl about this distance value, but Carl was so busy talking to the customers so he wrote the distance value (it\'s a real number) on a napkin. The problem is that he wrote it in scientific notation. The scientific notation of some real number x is the notation of form AeB, where A is a real number and B is an integer and x\xe2\x80\x89=\xe2\x80\x89A\xe2\x80\x89\xc3\x97\xe2\x80\x8910B is true. In our case A is between 0 and 9 and B is non-negative.Barney doesn\'t know anything about scientific notation (as well as anything scientific at all). So he asked you to tell him the distance value in usual decimal representation with minimal number of digits after the decimal point (and no decimal point if it is an integer). See the output format for better understanding." 1400.0                                 
               697A "Pineapple Incident" implementation,math "Ted has a pineapple. This pineapple is able to bark like a bulldog! At time t (in seconds) it barks for the first time. Then every s seconds after it, it barks twice with 1 second interval. Thus it barks at times t, t\xe2\x80\x89+\xe2\x80\x89s, t\xe2\x80\x89+\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x891, t\xe2\x80\x89+\xe2\x80\x892s, t\xe2\x80\x89+\xe2\x80\x892s\xe2\x80\x89+\xe2\x80\x891, etc.  Barney woke up in the morning and wants to eat the pineapple, but he can\'t eat it when it\'s barking. Barney plans to eat it at time x (in seconds), so he asked you to tell him if it\'s gonna bark at that time." 900.0                                 
                    691C "Exponential notation" implementation,strings "You are given a positive decimal number x.Your task is to convert it to the ""simple exponential notation"".Let x\xe2\x80\x89=\xe2\x80\x89a\xc2\xb710b, where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x8910, then in general case the ""simple exponential notation"" looks like ""aEb"". If b equals to zero, the part ""Eb"" should be skipped. If a is an integer, it should be written without decimal point. Also there should not be extra zeroes in a and b." 1800.0                            
                    690E1 "Photographs (I)"  "The Human-Cow Confederation (HC2), led by Heidi, has built a base where people and cows can hide, guarded from zombie attacks. The entrance to the base is protected by an automated gate which performs a kind of a Turing test: it shows the entering creature a photograph and asks them whether the top and bottom halves of this photograph have been swapped or not. A person (or even a cow) will have no problem answering such questions; on the other hand, a zombie would just randomly smash one of the two buttons.The creature is asked a series of such questions. If at least 75% of them are answered correctly, the gate is unlocked; otherwise, a side door opens, beneath which a huge fan is spinning...Heidi is now building a robot army to fight the zombies, and she wants the robots to also be able to enter the base. You are tasked with programming them to distinguish the images. The first two images from the test set. The first picture has been rearranged, but not the second." 1800.0                            
                    690D3 "The Wall (hard)" dp "So many wall designs to choose from! Even modulo 106\xe2\x80\x89+\xe2\x80\x893, it\'s an enormous number. Given that recently Heidi acquired an unlimited supply of bricks, her choices are endless! She really needs to do something to narrow them down.Heidi is quick to come up with criteria for a useful wall:  In a useful wall, at least one segment is wider than W bricks. This should give the zombies something to hit their heads against. Or,  in a useful wall, at least one column is higher than H bricks. This provides a lookout from which zombies can be spotted at a distance. This should rule out a fair amount of possibilities, right? Help Heidi compute the number of useless walls that do not confirm to either of these criteria. In other words, a wall is useless if every segment has width at most W and height at most H.Parameter C, the total width of the wall, has the same meaning as in the easy version. However, note that the number of bricks is now unlimited.Output the number of useless walls modulo 106\xe2\x80\x89+\xe2\x80\x893." 2100.0                            
                    690D2 "The Wall (medium)" combinatorics "Heidi the Cow is aghast: cracks in the northern Wall? Zombies gathering outside, forming groups, preparing their assault? This must not happen! Quickly, she fetches her HC2 (Handbook of Crazy Constructions) and looks for the right chapter:How to build a wall:  Take a set of bricks.  Select one of the possible wall designs. Computing the number of possible designs is left as an exercise to the reader.  Place bricks on top of each other, according to the chosen design. This seems easy enough. But Heidi is a Coding Cow, not a Constructing Cow. Her mind keeps coming back to point 2b. Despite the imminent danger of a zombie onslaught, she wonders just how many possible walls she could build with up to n bricks.A wall is a set of wall segments as defined in the easy version. How many different walls can be constructed such that the wall consists of at least 1 and at most n bricks? Two walls are different if there exist a column c and a row r such that one wall has a brick in this spot, and the other does not.Along with n, you will be given C, the width of the wall (as defined in the easy version). Return the number of different walls modulo 106\xe2\x80\x89+\xe2\x80\x893." 1800.0                            
                    690B2 "Recover Polygon (medium)" geometry "Now that Heidi has made sure her Zombie Contamination level checker works, it\'s time to strike! This time, the zombie lair is a strictly convex polygon on the lattice. Each vertex of the polygon occupies a point on the lattice. For each cell of the lattice, Heidi knows the level of Zombie Contamination \xe2\x80\x93 the number of corners of the cell that are inside or on the border of the lair.Given this information, Heidi wants to know the exact shape of the lair to rain destruction on the zombies. Help her!" 2600.0                            
                    687E TOF "dfs and similar,graphs" "Today Pari gave Arya a cool graph problem. Arya wrote a non-optimal solution for it, because he believes in his ability to optimize non-optimal solutions. In addition to being non-optimal, his code was buggy and he tried a lot to optimize it, so the code also became dirty! He keeps getting Time Limit Exceeds and he is disappointed. Suddenly a bright idea came to his mind!Here is how his dirty code looks like:dfs(v){     set count[v] = count[v] + 1     if(count[v] < 1000)     {          foreach u in neighbors[v]          {               if(visited[u] is equal to false)               {                    dfs(u)               }               break          }     }     set visited[v] = true}main(){     input the digraph()     TOF()     foreach 1<=i<=n     {          set count[i] = 0 , visited[i] = false     }     foreach 1 <= v <= n     {          if(visited[v] is equal to false)          {               dfs(v)          }     }     ... // And do something cool and magical but we can\'t tell you what!}He asks you to write the TOF function in order to optimize the running time of the code with minimizing the number of calls of the dfs function. The input is a directed graph and in the TOF function you have to rearrange the edges of the graph in the list neighbors for each vertex. The number of calls of dfs function depends on the arrangement of neighbors of each vertex." 2900.0                            
                    687B "Remainders Game" "chinese remainder theorem,math,number theory" "Today Pari and Arya are playing a game called Remainders.Pari chooses two positive integer x and k, and tells Arya k but not x. Arya have to find the value . There are n ancient numbers c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn and Pari has to tell Arya  if Arya wants. Given k and the ancient values, tell us if Arya has a winning strategy independent of value of x or not. Formally, is it true that Arya can understand the value  for any positive integer x?Note, that  means the remainder of x after dividing it by y." 1800.0                            
                    686B "Little Robber Girl\'s Zoo" "constructive algorithms,implementation,sortings" "Little Robber Girl likes to scare animals in her zoo for fun. She decided to arrange the animals in a row in the order of non-decreasing height. However, the animals were so scared that they couldn\'t stay in the right places.The robber girl was angry at first, but then she decided to arrange the animals herself. She repeatedly names numbers l and r such that r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 is even. After that animals that occupy positions between l and r inclusively are rearranged as follows: the animal at position l swaps places with the animal at position l\xe2\x80\x89+\xe2\x80\x891, the animal l\xe2\x80\x89+\xe2\x80\x892 swaps with the animal l\xe2\x80\x89+\xe2\x80\x893, ..., finally, the animal at position r\xe2\x80\x89-\xe2\x80\x891 swaps with the animal r.Help the robber girl to arrange the animals in the order of non-decreasing height. You should name at most 20\xe2\x80\x89000 segments, since otherwise the robber girl will become bored and will start scaring the animals again." 1100.0                            
                    685A "Robbers\' watch" "brute force,combinatorics,dp,math" "Robbers, who attacked the Gerda\'s cab, are very successful in covering from the kingdom police. To make the goal of catching them even harder, they use their own watches.First, as they know that kingdom police is bad at math, robbers use the positional numeral system with base 7. Second, they divide one day in n hours, and each hour in m minutes. Personal watches of each robber are divided in two parts: first of them has the smallest possible number of places that is necessary to display any integer from 0 to n\xe2\x80\x89-\xe2\x80\x891, while the second has the smallest possible number of places that is necessary to display any integer from 0 to m\xe2\x80\x89-\xe2\x80\x891. Finally, if some value of hours or minutes can be displayed using less number of places in base 7 than this watches have, the required number of zeroes is added at the beginning of notation.Note that to display number 0 section of the watches is required to have at least one place.Little robber wants to know the number of moments of time (particular values of hours and minutes), such that all digits displayed on the watches are distinct. Help her calculate this number." 1700.0                            
                    682C "Alyona and the Tree" "dfs and similar,dp,graphs,trees" "Alyona decided to go on a diet and went to the forest to get some apples. There she unexpectedly found a magic rooted tree with root in the vertex 1, every vertex and every edge of which has a number written on.The girl noticed that some of the tree\'s vertices are sad, so she decided to play with them. Let\'s call vertex v sad if there is a vertex u in subtree of vertex v such that dist(v,\xe2\x80\x89u)\xe2\x80\x89>\xe2\x80\x89au, where au is the number written on vertex u, dist(v,\xe2\x80\x89u) is the sum of the numbers written on the edges on the path from v to u.Leaves of a tree are vertices connected to a single vertex by a single edge, but the root of a tree is a leaf if and only if the tree consists of a single vertex \xe2\x80\x94 root.Thus Alyona decided to remove some of tree leaves until there will be no any sad vertex left in the tree. What is the minimum number of leaves Alyona needs to remove?" 1600.0                            
                    681E "Runaway to a Shadow" geometry,sortings "Dima is living in a dormitory, as well as some cockroaches.At the moment 0 Dima saw a cockroach running on a table and decided to kill it. Dima needs exactly T seconds for aiming, and after that he will precisely strike the cockroach and finish it.To survive the cockroach has to run into a shadow, cast by round plates standing on the table, in T seconds. Shadow casted by any of the plates has the shape of a circle. Shadow circles may intersect, nest or overlap arbitrarily.The cockroach uses the following strategy: first he equiprobably picks a direction to run towards and then runs towards it with the constant speed v. If at some moment t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89T it reaches any shadow circle, it immediately stops in the shadow and thus will stay alive. Otherwise the cockroach is killed by the Dima\'s precise strike. Consider that the Dima\'s precise strike is instant.Determine the probability of that the cockroach will stay alive." 2500.0                            
                    681A "A Good Contest" implementation "Codeforces user\' handle color depends on his rating \xe2\x80\x94 it is red if his rating is greater or equal to 2400; it is orange if his rating is less than 2400 but greater or equal to 2200, etc. Each time participant takes part in a rated contest, his rating is changed depending on his performance.Anton wants the color of his handle to become red. He considers his performance in the rated contest to be good if he outscored some participant, whose handle was colored red before the contest and his rating has increased after it.Anton has written a program that analyses contest results and determines whether he performed good or not. Are you able to do the same?" 800.0                            
                    677E "Vanya and Balloons" "binary search,brute force,dp,implementation" "Vanya plays a game of balloons on the field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n, where each cell contains a balloon with one of the values 0, 1, 2 or 3. The goal is to destroy a cross, such that the product of all values of balloons in the cross is maximum possible. There are two types of crosses: normal and rotated. For example:**o****o**ooooo**o****o**oro***o*o*o***o***o*o*o***oFormally, the cross is given by three integers r, c and d, such that d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r,\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89d\xe2\x80\x89+\xe2\x80\x891. The normal cross consists of balloons located in cells (x,\xe2\x80\x89y) (where x stay for the number of the row and y for the number of the column), such that |x\xe2\x80\x89-\xe2\x80\x89r|\xc2\xb7|y\xe2\x80\x89-\xe2\x80\x89c|\xe2\x80\x89=\xe2\x80\x890 and |x\xe2\x80\x89-\xe2\x80\x89r|\xe2\x80\x89+\xe2\x80\x89|y\xe2\x80\x89-\xe2\x80\x89c|\xe2\x80\x89<\xe2\x80\x89d. Rotated cross consists of balloons located in cells (x,\xe2\x80\x89y), such that |x\xe2\x80\x89-\xe2\x80\x89r|\xe2\x80\x89=\xe2\x80\x89|y\xe2\x80\x89-\xe2\x80\x89c| and |x\xe2\x80\x89-\xe2\x80\x89r|\xe2\x80\x89<\xe2\x80\x89d.Vanya wants to know the maximum possible product of the values of balls forming one cross. As this value can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300.0                            
                    677B "Vanya and Food Processor" implementation,math "Vanya smashes potato in a vertical food processor. At each moment of time the height of the potato in the processor doesn\'t exceed h and the processor smashes k centimeters of potato each second. If there are less than k centimeters remaining, than during this second processor smashes all the remaining potato.Vanya has n pieces of potato, the height of the i-th piece is equal to ai. He puts them in the food processor one by one starting from the piece number 1 and finishing with piece number n. Formally, each second the following happens:  If there is at least one piece of potato remaining, Vanya puts them in the processor one by one, until there is not enough space for the next piece.  Processor smashes k centimeters of potato (or just everything that is inside). Provided the information about the parameter of the food processor and the size of each potato in a row, compute how long will it take for all the potato to become smashed." 1400.0                            
                    675C "Money Transfers" "constructive algorithms,data structures,greedy,sortings" "There are n banks in the city where Vasya lives, they are located in a circle, such that any two banks are neighbouring if their indices differ by no more than 1. Also, bank 1 and bank n are neighbours if n\xe2\x80\x89>\xe2\x80\x891. No bank is a neighbour of itself.Vasya has an account in each bank. Its balance may be negative, meaning Vasya owes some money to this bank.There is only one type of operations available: transfer some amount of money from any bank to account in any neighbouring bank. There are no restrictions on the size of the sum being transferred or balance requirements to perform this operation.Vasya doesn\'t like to deal with large numbers, so he asks you to determine the minimum number of operations required to change the balance of each bank account to zero. It\'s guaranteed, that this is possible to achieve, that is, the total balance of Vasya in all banks is equal to zero." 2100.0                            
                    671C "Ultimate Weirdness of an Array" "data structures,number theory" "Yasin has an array a containing n integers. Yasin is a 5 year old, so he loves ultimate weird things.Yasin denotes weirdness of an array as maximum gcd(ai,\xe2\x80\x89\xe2\x80\x89aj) value among all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. For n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 weirdness is equal to 0, gcd(x,\xe2\x80\x89\xe2\x80\x89y) is the greatest common divisor of integers x and y.He also defines the ultimate weirdness of an array. Ultimate weirdness is  where f(i,\xe2\x80\x89\xe2\x80\x89j) is weirdness of the new array a obtained by removing all elements between i and j inclusive, so new array is [a1... ai\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x891... an].Since 5 year old boys can\'t code, Yasin asks for your help to find the value of ultimate weirdness of the given array a!" 2800.0                            
                    667B "Coat of Anticubism" "constructive algorithms,geometry" "As some of you know, cubism is a trend in art, where the problem of constructing volumetrical shape on a plane with a combination of three-dimensional geometric shapes comes to the fore. A famous sculptor Cicasso, whose self-portrait you can contemplate, hates cubism. He is more impressed by the idea to transmit two-dimensional objects through three-dimensional objects by using his magnificent sculptures. And his new project is connected with this. Cicasso wants to make a coat for the haters of anticubism. To do this, he wants to create a sculpture depicting a well-known geometric primitive \xe2\x80\x94 convex polygon.Cicasso prepared for this a few blanks, which are rods with integer lengths, and now he wants to bring them together. The i-th rod is a segment of length li.The sculptor plans to make a convex polygon with a nonzero area, using all rods he has as its sides. Each rod should be used as a side to its full length. It is forbidden to cut, break or bend rods. However, two sides may form a straight angle .Cicasso knows that it is impossible to make a convex polygon with a nonzero area out of the rods with the lengths which he had chosen. Cicasso does not want to leave the unused rods, so the sculptor decides to make another rod-blank with an integer length so that his problem is solvable. Of course, he wants to make it as short as possible, because the materials are expensive, and it is improper deed to spend money for nothing. Help sculptor!" 1100.0                            
                    666C Codeword combinatorics,strings "The famous sculptor Cicasso is a Reberlandian spy!These is breaking news in Berlandian papers today. And now the sculptor is hiding. This time you give the shelter to the maestro. You have a protected bunker and you provide it to your friend. You set the security system in such way that only you can open the bunker. To open it one should solve the problem which is hard for others but is simple for you.Every day the bunker generates a codeword s. Every time someone wants to enter the bunker, integer n appears on the screen. As the answer one should enter another integer \xe2\x80\x94 the residue modulo 109\xe2\x80\x89+\xe2\x80\x897 of the number of strings of length n that consist only of lowercase English letters and contain the string s as the subsequence.The subsequence of string a is a string b that can be derived from the string a by removing some symbols from it (maybe none or all of them). In particular any string is the subsequence of itself. For example, the string ""cfo"" is the subsequence of the string ""codeforces"".You haven\'t implemented the algorithm that calculates the correct answers yet and you should do that ASAP." 2500.0                            
                    661F "Primes in Interval" "*special problem" "You are given two integers a and b (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b). How many prime numbers are there on the interval from a to b, inclusive?" 1900.0                            
                    660F "Bear and Bowling 4" "binary search,data structures,divide and conquer,geometry,ternary search" "Limak is an old brown bear. He often goes bowling with his friends. Today he feels really good and tries to beat his own record!For rolling a ball one gets a score \xe2\x80\x94 an integer (maybe negative) number of points. Score for the i-th roll is multiplied by i and scores are summed up. So, for k rolls with scores s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk, the total score is . The total score is 0 if there were no rolls.Limak made n rolls and got score ai for the i-th of them. He wants to maximize his total score and he came up with an interesting idea. He can say that some first rolls were only a warm-up, and that he wasn\'t focused during the last rolls. More formally, he can cancel any prefix and any suffix of the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. It is allowed to cancel all rolls, or to cancel none of them.The total score is calculated as if there were only non-canceled rolls. So, the first non-canceled roll has score multiplied by 1, the second one has score multiplied by 2, and so on, till the last non-canceled roll.What maximum total score can Limak get?" 2500.0                            
                    660E "Different Subsets For All Tuples" combinatorics,math "For a sequence a of n integers between 1 and m, inclusive, denote f(a) as the number of distinct subsequences of a (including the empty subsequence).You are given two positive integers n and m. Let S be the set of all sequences of length n consisting of numbers from 1 to m. Compute the sum f(a) over all a in S modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300.0                            
                    653C "Bear and Up-Down" "brute force,implementation" "The life goes up and down, just like nice sequences. Sequence t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn is called nice if the following two conditions are satisfied:   ti\xe2\x80\x89<\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891 for each odd i\xe2\x80\x89<\xe2\x80\x89n;  ti\xe2\x80\x89>\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891 for each even i\xe2\x80\x89<\xe2\x80\x89n. For example, sequences (2,\xe2\x80\x898), (1,\xe2\x80\x895,\xe2\x80\x891) and (2,\xe2\x80\x895,\xe2\x80\x891,\xe2\x80\x89100,\xe2\x80\x8999,\xe2\x80\x89120) are nice, while (1,\xe2\x80\x891), (1,\xe2\x80\x892,\xe2\x80\x893) and (2,\xe2\x80\x895,\xe2\x80\x893,\xe2\x80\x892) are not.Bear Limak has a sequence of positive integers t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. This sequence is not nice now and Limak wants to fix it by a single swap. He is going to choose two indices i\xe2\x80\x89<\xe2\x80\x89j and swap elements ti and tj in order to get a nice sequence. Count the number of ways to do so. Two ways are considered different if indices of elements chosen for a swap are different." 1900.0                            
                    643E "Bear and Destroying Subtrees" dp,math,probabilities,trees "Limak is a little grizzly bear. He will once attack Deerland but now he can only destroy trees in role-playing games. Limak starts with a tree with one vertex. The only vertex has index 1 and is a root of the tree.Sometimes, a game chooses a subtree and allows Limak to attack it. When a subtree is attacked then each of its edges is destroyed with probability , independently of other edges. Then, Limak gets the penalty \xe2\x80\x94 an integer equal to the height of the subtree after the attack. The height is defined as the maximum number of edges on the path between the root of the subtree and any vertex in the subtree.You must handle queries of two types.  1 v denotes a query of the first type. A new vertex appears and its parent is v. A new vertex has the next available index (so, new vertices will be numbered 2,\xe2\x80\x893,\xe2\x80\x89...).  2 v denotes a query of the second type. For a moment let\'s assume that the game allows Limak to attack a subtree rooted in v. Then, what would be the expected value of the penalty Limak gets after the attack? In a query of the second type, Limak doesn\'t actually attack the subtree and thus the query doesn\'t affect next queries." 2700.0                            
                    643C "Levels and Regions" dp "Radewoosh is playing a computer game. There are n levels, numbered 1 through n. Levels are divided into k regions (groups). Each region contains some positive number of consecutive levels.The game repeats the the following process: If all regions are beaten then the game ends immediately. Otherwise, the system finds the first region with at least one non-beaten level. Let X denote this region. The system creates an empty bag for tokens. Each token will represent one level and there may be many tokens representing the same level.  For each already beaten level i in the region X, the system adds ti tokens to the bag (tokens representing the i-th level).  Let j denote the first non-beaten level in the region X. The system adds tj tokens to the bag.  Finally, the system takes a uniformly random token from the bag and a player starts the level represented by the token. A player spends one hour and beats the level, even if he has already beaten it in the past. Given n, k and values t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn, your task is to split levels into regions. Each level must belong to exactly one region, and each region must contain non-empty consecutive set of levels. What is the minimum possible expected number of hours required to finish the game?" 2400.0                            
                    641D "Little Artem and Random Variable" dp,implementation,math,probabilities "Little Artyom decided to study probability theory. He found a book with a lot of nice exercises and now wants you to help him with one of them.Consider two dices. When thrown each dice shows some integer from 1 to n inclusive. For each dice the probability of each outcome is given (of course, their sum is 1), and different dices may have different probability distributions.We throw both dices simultaneously and then calculate values max(a,\xe2\x80\x89b) and min(a,\xe2\x80\x89b), where a is equal to the outcome of the first dice, while b is equal to the outcome of the second dice. You don\'t know the probability distributions for particular values on each dice, but you know the probability distributions for max(a,\xe2\x80\x89b) and min(a,\xe2\x80\x89b). That is, for each x from 1 to n you know the probability that max(a,\xe2\x80\x89b) would be equal to x and the probability that min(a,\xe2\x80\x89b) would be equal to x. Find any valid probability distribution for values on the dices. It\'s guaranteed that the input data is consistent, that is, at least one solution exists." 2400.0                            
                    638C "Road Improvement" "*special problem,dfs and similar,graphs,greedy,trees" "In Berland there are n cities and n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. Each road connects some pair of cities, from any city you can get to any other one using only the given roads.In each city there is exactly one repair brigade. To repair some road, you need two teams based in the cities connected by the road to work simultaneously for one day. Both brigades repair one road for the whole day and cannot take part in repairing other roads on that day. But the repair brigade can do nothing on that day.Determine the minimum number of days needed to repair all the roads. The brigades cannot change the cities where they initially are." 1800.0                            
                    637D "Running with Obstacles" "*special problem,data structures,dp,greedy" "A sportsman starts from point xstart\xe2\x80\x89=\xe2\x80\x890 and runs to point with coordinate xfinish\xe2\x80\x89=\xe2\x80\x89m (on a straight line). Also, the sportsman can jump \xe2\x80\x94 to jump, he should first take a run of length of not less than s meters (in this case for these s meters his path should have no obstacles), and after that he can jump over a length of not more than d meters. Running and jumping is permitted only in the direction from left to right. He can start andfinish a jump only at the points with integer coordinates in which there are no obstacles. To overcome some obstacle, it is necessary to land at a point which is strictly to the right of this obstacle.On the way of an athlete are n obstacles at coordinates x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. He cannot go over the obstacles, he can only jump over them. Your task is to determine whether the athlete will be able to get to the finish point." 1600.0                            
                    630C "Lucky Numbers" combinatorics,math "The numbers of all offices in the new building of the Tax Office of IT City will have lucky numbers.Lucky number is a number that consists of digits 7 and 8 only. Find the maximum number of offices in the new building of the Tax Office given that a door-plate can hold a number not longer than n digits." 1100.0                            
                    628E "Zbazi in Zeydabad" "data structures,implementation" "A tourist wants to visit country Zeydabad for Zbazi (a local game in Zeydabad).The country Zeydabad is a rectangular table consisting of n rows and m columns. Each cell on the country is either \'z\' or \'.\'.The tourist knows this country is named Zeydabad because there are lots of \'\'Z-pattern""s in the country. A \'\'Z-pattern"" is a square which anti-diagonal is completely filled with \'z\' and its upper and lower rows are also completely filled with \'z\'. All other cells of a square can be arbitrary.  Note that a \'\'Z-pattern"" can consist of only one cell (see the examples).So he wants to count the number of \'\'Z-pattern""s in the country (a necessary skill for Zbazi).Now your task is to help tourist with counting number of \'\'Z-pattern""s.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use gets/scanf/printf instead of getline/cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 2300.0                            
                    628B "New Skateboard" dp "Max wants to buy a new skateboard. He has calculated the amount of money that is needed to buy a new skateboard. He left a calculator on the floor and went to ask some money from his parents. Meanwhile his little brother Yusuf came and started to press the keys randomly. Unfortunately Max has forgotten the number which he had calculated. The only thing he knows is that the number is divisible by 4.You are given a string s consisting of digits (the number on the display of the calculator after Yusuf randomly pressed the keys). Your task is to find the number of substrings which are divisible by 4. A substring can start with a zero.A substring of a string is a nonempty sequence of consecutive characters.For example if string s is 124 then we have four substrings that are divisible by 4: 12, 4, 24 and 124. For the string 04 the answer is three: 0, 4, 04.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use gets/scanf/printf instead of getline/cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 1300.0                            
                    627D "Preorder Test" "binary search,dfs and similar,dp,graphs,greedy,trees" "For his computer science class, Jacob builds a model tree with sticks and balls containing n nodes in the shape of a tree. Jacob has spent ai minutes building the i-th ball in the tree.Jacob\'s teacher will evaluate his model and grade Jacob based on the effort he has put in. However, she does not have enough time to search his whole tree to determine this; Jacob knows that she will examine the first k nodes in a DFS-order traversal of the tree. She will then assign Jacob a grade equal to the minimum ai she finds among those k nodes.Though Jacob does not have enough time to rebuild his model, he can choose the root node that his teacher starts from. Furthermore, he can rearrange the list of neighbors of each node in any order he likes. Help Jacob find the best grade he can get on this assignment.A DFS-order traversal is an ordering of the nodes of a rooted tree, built by a recursive DFS-procedure initially called on the root of the tree. When called on a given node v, the procedure does the following:   Print v.  Traverse the list of neighbors of the node v in order and iteratively call DFS-procedure on each one. Do not call DFS-procedure on node u if you came to node v directly from u." 2600.0                            
                    626F "Group Projects" dp "There are n students in a class working on group projects. The students will divide into groups (some students may be in groups alone), work on their independent pieces, and then discuss the results together. It takes the i-th student ai minutes to finish his/her independent piece.If students work at different paces, it can be frustrating for the faster students and stressful for the slower ones. In particular, the imbalance of a group is defined as the maximum ai in the group minus the minimum ai in the group. Note that a group containing a single student has an imbalance of 0. How many ways are there for the students to divide into groups so that the total imbalance of all groups is at most k?Two divisions are considered distinct if there exists a pair of students who work in the same group in one division but different groups in the other." 2400.0                            
                    624A "Save Luke" math "Luke Skywalker got locked up in a rubbish shredder between two presses. R2D2 is already working on his rescue, but Luke needs to stay alive as long as possible. For simplicity we will assume that everything happens on a straight line, the presses are initially at coordinates 0 and L, and they move towards each other with speed v1 and v2, respectively. Luke has width d and is able to choose any position between the presses. Luke dies as soon as the distance between the presses is less than his width. Your task is to determine for how long Luke can stay alive." 800.0                            
                    623B "Array GCD" "dp,greedy,number theory" "You are given array ai of length n. You may consecutively apply two operations to this array:  remove some subsegment (continuous subsequence) of length m\xe2\x80\x89<\xe2\x80\x89n and pay for it m\xc2\xb7a coins;  change some elements of the array by at most 1, and pay b coins for each change. Please note that each of operations may be applied at most once (and may be not applied at all) so you can remove only one segment and each number may be changed (increased or decreased) by at most 1. Also note, that you are not allowed to delete the whole array.Your goal is to calculate the minimum number of coins that you need to spend in order to make the greatest common divisor of the elements of the resulting array be greater than 1." 2300.0                            
                    622B "The Time" implementation "You are given the current time in 24-hour format hh:mm. Find and print the time after a minutes.Note that you should find only the time after a minutes, see the examples to clarify the problem statement.You can read more about 24-hour format here https://en.wikipedia.org/wiki/24-hour_clock." 900.0                            
                    621C "Wet Shark and Flowers" "combinatorics,math,number theory,probabilities" "There are n sharks who grow flowers for Wet Shark. They are all sitting around the table, such that sharks i and i\xe2\x80\x89+\xe2\x80\x891 are neighbours for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891. Sharks n and 1 are neighbours too.Each shark will grow some number of flowers si. For i-th shark value si is random integer equiprobably chosen in range from li to ri. Wet Shark has it\'s favourite prime number p, and he really likes it! If for any pair of neighbouring sharks i and j the product si\xc2\xb7sj is divisible by p, then Wet Shark becomes happy and gives 1000 dollars to each of these sharks.At the end of the day sharks sum all the money Wet Shark granted to them. Find the expectation of this value." 1700.0                            
                    617C "Watering Flowers" implementation "A flowerbed has many flowers and two fountains.You can adjust the water pressure and set any values r1(r1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) and r2(r2\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890), giving the distances at which the water is spread from the first and second fountain respectively. You have to set such r1 and r2 that all the flowers are watered, that is, for each flower, the distance between the flower and the first fountain doesn\'t exceed r1, or the distance to the second fountain doesn\'t exceed r2. It\'s OK if some flowers are watered by both fountains.You need to decrease the amount of water you need, that is set such r1 and r2 that all the flowers are watered and the r12\xe2\x80\x89+\xe2\x80\x89r22 is minimum possible. Find this minimum value." 1600.0                            
                    617B Chocolate combinatorics "Bob loves everything sweet. His favorite chocolate bar consists of pieces, each piece may contain a nut. Bob wants to break the bar of chocolate into multiple pieces so that each part would contain exactly one nut and any break line goes between two adjacent pieces.You are asked to calculate the number of ways he can do it. Two ways to break chocolate are considered distinct if one of them contains a break between some two adjacent pieces and the other one doesn\'t. Please note, that if Bob doesn\'t make any breaks, all the bar will form one piece and it still has to have exactly one nut." 1300.0                            
                    616F "Expensive Strings" "data structures,sortings,string suffix structures,strings" "You are given n strings ti. Each string has cost ci.Let\'s define the function of string , where ps,\xe2\x80\x89i is the number of occurrences of s in ti, |s| is the length of the string s. Find the maximal value of function f(s) over all strings.Note that the string s is not necessarily some string from t." 2700.0                            
                    616C "The Labyrinth" "dfs and similar" "You are given a rectangular field of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells. Each cell is either empty or impassable (contains an obstacle). Empty cells are marked with \'.\', impassable cells are marked with \'*\'. Let\'s call two empty cells adjacent if they share a side.Let\'s call a connected component any non-extendible set of cells such that any two of them are connected by the path of adjacent cells. It is a typical well-known definition of a connected component.For each impassable cell (x,\xe2\x80\x89y) imagine that it is an empty cell (all other cells remain unchanged) and find the size (the number of cells) of the connected component which contains (x,\xe2\x80\x89y). You should do it for each impassable cell independently.The answer should be printed as a matrix with n rows and m columns. The j-th symbol of the i-th row should be ""."" if the cell is empty at the start. Otherwise the j-th symbol of the i-th row should contain the only digit \xe2\x80\x94- the answer modulo 10. The matrix should be printed without any spaces.To make your output faster it is recommended to build the output as an array of n strings having length m and print it as a sequence of lines. It will be much faster than writing character-by-character.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 1600.0                            
                    615B "Longtail Hedgehog" dp,graphs "This Christmas Santa gave Masha a magic picture and a pencil. The picture consists of n points connected by m segments (they might cross in any way, that doesn\'t matter). No two segments connect the same pair of points, and no segment connects the point to itself. Masha wants to color some segments in order paint a hedgehog. In Mashas mind every hedgehog consists of a tail and some spines. She wants to paint the tail that satisfies the following conditions:   Only segments already presented on the picture can be painted;  The tail should be continuous, i.e. consists of some sequence of points, such that every two neighbouring points are connected by a colored segment;  The numbers of points from the beginning of the tail to the end should strictly increase. Masha defines the length of the tail as the number of points in it. Also, she wants to paint some spines. To do so, Masha will paint all the segments, such that one of their ends is the endpoint of the tail. Masha defines the beauty of a hedgehog as the length of the tail multiplied by the number of spines. Masha wants to color the most beautiful hedgehog. Help her calculate what result she may hope to get.Note that according to Masha\'s definition of a hedgehog, one segment may simultaneously serve as a spine and a part of the tail (she is a little girl after all). Take a look at the picture for further clarifications." 1600.0                            
                    611G "New Year and Cake" "geometry,two pointers" "Limak is a little polar bear. According to some old traditions, his bear family prepared a New Year cake. And Limak likes cakes.As you may know, a New Year cake is a strictly convex polygon with n vertices.Parents won\'t allow Limak to eat more than half of a cake because he would get sick. After some thinking they decided to cut a cake along one of n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x893)\xe2\x80\x89/\xe2\x80\x892 diagonals. Then Limak will get a non-greater piece.Limak understands rules but he won\'t be happy if the second piece happens to be much bigger. Limak\'s disappointment will be equal to the difference between pieces\' areas, multiplied by two. It can be proved that it will be integer for the given constraints.There are n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x893)\xe2\x80\x89/\xe2\x80\x892 possible scenarios. Consider them all and find the sum of values of Limak\'s disappointment, modulo 109\xe2\x80\x89+\xe2\x80\x897." 2900.0                            
                    609D "Gadgets for dollars and pounds" "binary search,greedy,two pointers" "Nura wants to buy k gadgets. She has only s burles for that. She can buy each gadget for dollars or for pounds. So each gadget is selling only for some type of currency. The type of currency and the cost in that currency are not changing.Nura can buy gadgets for n days. For each day you know the exchange rates of dollar and pound, so you know the cost of conversion burles to dollars or to pounds.Each day (from 1 to n) Nura can buy some gadgets by current exchange rate. Each day she can buy any gadgets she wants, but each gadget can be bought no more than once during n days.Help Nura to find the minimum day index when she will have k gadgets. Nura always pays with burles, which are converted according to the exchange rate of the purchase day. Nura can\'t buy dollars or pounds, she always stores only burles. Gadgets are numbered with integers from 1 to m in order of their appearing in input." 2000.0                            
                    607D "Power Tree" "data structures,trees" "Genos and Saitama went shopping for Christmas trees. However, a different type of tree caught their attention, the exalted Power Tree. A Power Tree starts out as a single root vertex indexed 1. A Power Tree grows through a magical phenomenon known as an update. In an update, a single vertex is added to the tree as a child of some other vertex.Every vertex in the tree (the root and all the added vertices) has some value vi associated with it. The power of a vertex is defined as the strength of the multiset composed of the value associated with this vertex (vi) and the powers of its direct children. The strength of a multiset is defined as the sum of all elements in the multiset multiplied by the number of elements in it. Or in other words for some multiset S: Saitama knows the updates that will be performed on the tree, so he decided to test Genos by asking him queries about the tree during its growth cycle.An update is of the form 1 p v, and adds a new vertex with value v as a child of vertex p.A query is of the form 2 u, and asks for the power of vertex u.Please help Genos respond to these queries modulo 109\xe2\x80\x89+\xe2\x80\x897." 2600.0                            
                    605E "Intergalaxy Trips" "probabilities,shortest paths" "The scientists have recently discovered wormholes \xe2\x80\x94 objects in space that allow to travel very long distances between galaxies and star systems. The scientists know that there are n galaxies within reach. You are in the galaxy number 1 and you need to get to the galaxy number n. To get from galaxy i to galaxy j, you need to fly onto a wormhole (i,\xe2\x80\x89j) and in exactly one galaxy day you will find yourself in galaxy j. Unfortunately, the required wormhole is not always available. Every galaxy day they disappear and appear at random. However, the state of wormholes does not change within one galaxy day. A wormhole from galaxy i to galaxy j exists during each galaxy day taken separately with probability pij. You can always find out what wormholes exist at the given moment. At each moment you can either travel to another galaxy through one of wormholes that exist at this moment or you can simply wait for one galaxy day to see which wormholes will lead from your current position at the next day.Your task is to find the expected value of time needed to travel from galaxy 1 to galaxy n, if you act in the optimal way. It is guaranteed that this expected value exists." 2700.0                            
                    603C "Lieges of Legendre" games,math "Kevin and Nicky Sun have invented a new game called Lieges of Legendre. In this game, two players take turns modifying the game state with Kevin moving first. Initially, the game is set up so that there are n piles of cows, with the i-th pile containing ai cows. During each player\'s turn, that player calls upon the power of Sunlight, and uses it to either:  Remove a single cow from a chosen non-empty pile.  Choose a pile of cows with even size 2\xc2\xb7x (x\xe2\x80\x89>\xe2\x80\x890), and replace it with k piles of x cows each. The player who removes the last cow wins. Given n, k, and a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, help Kevin and Nicky find the winner, given that both sides play in optimal way." 2200.0                            
                    603B "Moodular Arithmetic" "combinatorics,dfs and similar,dsu,math,number theory" "As behooves any intelligent schoolboy, Kevin Sun is studying psycowlogy, cowculus, and cryptcowgraphy at the Bovinia State University (BGU) under Farmer Ivan. During his Mathematics of Olympiads (MoO) class, Kevin was confronted with a weird functional equation and needs your help. For two fixed integers k and p, where p is an odd prime number, the functional equation states that  for some function . (This equation should hold for any integer x in the range 0 to p\xe2\x80\x89-\xe2\x80\x891, inclusive.)It turns out that f can actually be many different functions. Instead of finding a solution, Kevin wants you to count the number of distinct functions f that satisfy this equation. Since the answer may be very large, you should print your result modulo 109\xe2\x80\x89+\xe2\x80\x897." 1800.0                            
                    598E "Chocolate Bar" "brute force,dp" "You have a rectangular chocolate bar consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m single squares. You want to eat exactly k squares, so you may need to break the chocolate bar. In one move you can break any single rectangular piece of chocolate in two rectangular pieces. You can break only by lines between squares: horizontally or vertically. The cost of breaking is equal to square of the break length.For example, if you have a chocolate bar consisting of 2\xe2\x80\x89\xc3\x97\xe2\x80\x893 unit squares then you can break it horizontally and get two 1\xe2\x80\x89\xc3\x97\xe2\x80\x893 pieces (the cost of such breaking is 32\xe2\x80\x89=\xe2\x80\x899), or you can break it vertically in two ways and get two pieces: 2\xe2\x80\x89\xc3\x97\xe2\x80\x891 and 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 (the cost of such breaking is 22\xe2\x80\x89=\xe2\x80\x894).For several given values n, m and k find the minimum total cost of breaking. You can eat exactly k squares of chocolate if after all operations of breaking there is a set of rectangular pieces of chocolate with the total size equal to k squares. The remaining n\xc2\xb7m\xe2\x80\x89-\xe2\x80\x89k squares are not necessarily form a single rectangular piece." 2000.0                            
                    596D "Wilbur and Trees" dp,math,probabilities,sortings "Wilbur the pig really wants to be a beaver, so he decided today to pretend he is a beaver and bite at trees to cut them down.There are n trees located at various positions on a line. Tree i is located at position xi. All the given positions of the trees are distinct.The trees are equal, i.e. each tree has height h. Due to the wind, when a tree is cut down, it either falls left with probability p, or falls right with probability 1\xe2\x80\x89-\xe2\x80\x89p. If a tree hits another tree while falling, that tree will fall in the same direction as the tree that hit it. A tree can hit another tree only if the distance between them is strictly less than h. For example, imagine there are 4 trees located at positions 1, 3, 5 and 8, while h\xe2\x80\x89=\xe2\x80\x893 and the tree at position 1 falls right. It hits the tree at position 3 and it starts to fall too. In it\'s turn it hits the tree at position 5 and it also starts to fall. The distance between 8 and 5 is exactly 3, so the tree at position 8 will not fall.As long as there are still trees standing, Wilbur will select either the leftmost standing tree with probability 0.5 or the rightmost standing tree with probability 0.5. Selected tree is then cut down. If there is only one tree remaining, Wilbur always selects it. As the ground is covered with grass, Wilbur wants to know the expected total length of the ground covered with fallen trees after he cuts them all down because he is concerned about his grass-eating cow friends. Please help Wilbur." 2300.0                            
                    596A "Wilbur and Swimming Pool" geometry,implementation "After making bad dives into swimming pools, Wilbur wants to build a swimming pool in the shape of a rectangle in his backyard. He has set up coordinate axes, and he wants the sides of the rectangle to be parallel to them. Of course, the area of the rectangle must be positive. Wilbur had all four vertices of the planned pool written on a paper, until his friend came along and erased some of the vertices.Now Wilbur is wondering, if the remaining n vertices of the initial rectangle give enough information to restore the area of the planned swimming pool." 1100.0                            
                    590D "Top Secret Task" dp "A top-secret military base under the command of Colonel Zuev is expecting an inspection from the Ministry of Defence. According to the charter, each top-secret military base must include a top-secret troop that should... well, we cannot tell you exactly what it should do, it is a top secret troop at the end. The problem is that Zuev\'s base is missing this top-secret troop for some reasons.The colonel decided to deal with the problem immediately and ordered to line up in a single line all n soldiers of the base entrusted to him. Zuev knows that the loquacity of the i-th soldier from the left is equal to qi. Zuev wants to form the top-secret troop using k leftmost soldiers in the line, thus he wants their total loquacity to be as small as possible (as the troop should remain top-secret). To achieve this, he is going to choose a pair of consecutive soldiers and swap them. He intends to do so no more than s times. Note that any soldier can be a participant of such swaps for any number of times. The problem turned out to be unusual, and colonel Zuev asked you to help.Determine, what is the minimum total loquacity of the first k soldiers in the line, that can be achieved by performing no more than s swaps of two consecutive soldiers." 2300.0                            
                    588B "Duff in Love" math "Duff is in love with lovely numbers! A positive integer x is called lovely if and only if there is no such positive integer a\xe2\x80\x89>\xe2\x80\x891 such that a2 is a divisor of x.  Malek has a number store! In his store, he has only divisors of positive integer n (and he has all of them). As a birthday present, Malek wants to give her a lovely number from his store. He wants this number to be as big as possible.Malek always had issues in math, so he asked for your help. Please tell him what is the biggest lovely number in his store." 1300.0                            
                    587D "Duff in Mafia" "2-sat,binary search" "Duff is one if the heads of Mafia in her country, Andarz Gu. Andarz Gu has n cities (numbered from 1 to n) connected by m bidirectional roads (numbered by 1 to m).Each road has a destructing time, and a color. i-th road connects cities vi and ui and its color is ci and its destructing time is ti.Mafia wants to destruct a matching in Andarz Gu. A matching is a subset of roads such that no two roads in this subset has common endpoint. They can destruct these roads in parallel, i. e. the total destruction time is a maximum over destruction times of all selected roads.  They want two conditions to be satisfied:  The remaining roads form a proper coloring.  Destructing time of this matching is minimized. The remaining roads after destructing this matching form a proper coloring if and only if no two roads of the same color have same endpoint, or, in the other words, edges of each color should form a matching.There is no programmer in Mafia. That\'s why Duff asked for your help. Please help her and determine which matching to destruct in order to satisfied those conditions (or state that this is not possible)." 3100.0                            
                    581B "Luxurious Houses" implementation,math "The capital of Berland has n multifloor buildings. The architect who built up the capital was very creative, so all the houses were built in one row.Let\'s enumerate all the houses from left to right, starting with one. A house is considered to be luxurious if the number of floors in it is strictly greater than in all the houses with larger numbers. In other words, a house is luxurious if the number of floors in it is strictly greater than in all the houses, which are located to the right from it. In this task it is assumed that the heights of floors in the houses are the same.The new architect is interested in n questions, i-th of them is about the following: ""how many floors should be added to the i-th house to make it luxurious?"" (for all i from 1 to n, inclusive). You need to help him cope with this task.Note that all these questions are independent from each other \xe2\x80\x94 the answer to the question for house i does not affect other answers (i.e., the floors to the houses are not actually added)." 1100.0                            
                    580A "Kefa and First Steps" "brute force,dp,implementation" "Kefa decided to make some money doing business on the Internet for exactly n days. He knows that on the i-th day (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) he makes ai money. Kefa loves progress, that\'s why he wants to know the length of the maximum non-decreasing subsegment in sequence ai. Let us remind you that the subsegment of the sequence is its continuous fragment. A subsegment of numbers is called non-decreasing if all numbers in it follow in the non-decreasing order.Help Kefa cope with this task!" 900.0                            
                    578B """Or"" Game" "brute force,greedy" "You are given n numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You can perform at most k operations. For each operation you can multiply one of the numbers by x. We want to make  as large as possible, where  denotes the bitwise OR. Find the maximum possible value of  after performing at most k operations optimally." 1700.0                            
                    578A "A Problem about Polyline" geometry,math "There is a polyline going through points (0,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(x,\xe2\x80\x89x)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(2x,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(3x,\xe2\x80\x89x)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(4x,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89...\xe2\x80\x89-\xe2\x80\x89(2kx,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(2kx\xe2\x80\x89+\xe2\x80\x89x,\xe2\x80\x89x)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89.... We know that the polyline passes through the point (a,\xe2\x80\x89b). Find minimum positive value x such that it is true or determine that there is no such x." 1700.0                            
                    575F Bulbo dp,greedy "Bananistan is a beautiful banana republic. Beautiful women in beautiful dresses. Beautiful statues of beautiful warlords. Beautiful stars in beautiful nights.In Bananistan people play this crazy game \xe2\x80\x93 Bulbo. There\xe2\x80\x99s an array of bulbs and player at the position, which represents one of the bulbs. The distance between two neighboring bulbs is 1. Before each turn player can change his position with cost |posnew\xe2\x80\x89-\xe2\x80\x89posold|. After that, a contiguous set of bulbs lights-up and player pays the cost that\xe2\x80\x99s equal to the distance to the closest shining bulb. Then, all bulbs go dark again. The goal is to minimize your summed cost. I tell you, Bananistanians are spending their nights playing with bulbs.Banana day is approaching, and you are hired to play the most beautiful Bulbo game ever. A huge array of bulbs is installed, and you know your initial position and all the light-ups in advance. You need to play the ideal game and impress Bananistanians, and their families." 2100.0                            
                    575B Bribes "dfs and similar,graphs,trees" "Ruritania is a country with a very badly maintained road network, which is not exactly good news for lorry drivers that constantly have to do deliveries. In fact, when roads are maintained, they become one-way. It turns out that it is sometimes impossible to get from one town to another in a legal way \xe2\x80\x93 however, we know that all towns are reachable, though illegally!Fortunately for us, the police tend to be very corrupt and they will allow a lorry driver to break the rules and drive in the wrong direction provided they receive \xe2\x80\x98a small gift\xe2\x80\x99. There is one patrol car for every road and they will request 1000 Ruritanian dinars when a driver drives in the wrong direction. However, being greedy, every time a patrol car notices the same driver breaking the rule, they will charge double the amount of money they requested the previous time on that particular road.Borna is a lorry driver that managed to figure out this bribing pattern. As part of his job, he has to make K stops in some towns all over Ruritania and he has to make these stops in a certain order. There are N towns (enumerated from 1 to N) in Ruritania and Borna\xe2\x80\x99s initial location is the capital city i.e. town 1. He happens to know which ones out of the N\xe2\x80\x89-\xe2\x80\x891 roads in Ruritania are currently unidirectional, but he is unable to compute the least amount of money he needs to prepare for bribing the police. Help Borna by providing him with an answer and you will be richly rewarded." 2200.0                            
                    571A "Lengthening Sticks" combinatorics,implementation,math "You are given three sticks with positive integer lengths of a,\xe2\x80\x89b, and c centimeters. You can increase length of some of them by some positive integer number of centimeters (different sticks can be increased by a different length), but in total by at most l centimeters. In particular, it is allowed not to increase the length of any stick.Determine the number of ways to increase the lengths of some sticks so that you can form from them a non-degenerate (that is, having a positive area) triangle. Two ways are considered different, if the length of some stick is increased by different number of centimeters in them." 2100.0                            
                    568C "New Language" 2-sat,greedy "Living in Byteland was good enough to begin with, but the good king decided to please his subjects and to introduce a national language. He gathered the best of wise men, and sent an expedition to faraway countries, so that they would find out all about how a language should be designed.After some time, the wise men returned from the trip even wiser. They locked up for six months in the dining room, after which they said to the king: ""there are a lot of different languages, but almost all of them have letters that are divided into vowels and consonants; in a word, vowels and consonants must be combined correctly.""There are very many rules, all of them have exceptions, but our language will be deprived of such defects! We propose to introduce a set of formal rules of combining vowels and consonants, and include in the language all the words that satisfy them.The rules of composing words are: The letters are divided into vowels and consonants in some certain way; All words have a length of exactly n; There are m rules of the form (pos1,\xe2\x80\x89t1,\xe2\x80\x89pos2,\xe2\x80\x89t2). Each rule is: if the position pos1 has a letter of type t1, then the position pos2 has a letter of type t2.You are given some string s of length n, it is not necessarily a correct word of the new language. Among all the words of the language that lexicographically not smaller than the string s, find the minimal one in lexicographic order." 2600.0                            
                    567F Mausoleum dp "King of Berland Berl IV has recently died. Hail Berl V! As a sign of the highest achievements of the deceased king the new king decided to build a mausoleum with Berl IV\'s body on the main square of the capital.The mausoleum will be constructed from 2n blocks, each of them has the shape of a cuboid. Each block has the bottom base of a 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 meter square. Among the blocks, exactly two of them have the height of one meter, exactly two have the height of two meters, ..., exactly two have the height of n meters.The blocks are arranged in a row without spacing one after the other. Of course, not every arrangement of blocks has the form of a mausoleum. In order to make the given arrangement in the form of the mausoleum, it is necessary that when you pass along the mausoleum, from one end to the other, the heights of the blocks first were non-decreasing (i.e., increasing or remained the same), and then \xe2\x80\x94 non-increasing (decrease or remained unchanged). It is possible that any of these two areas will be omitted. For example, the following sequences of block height meet this requirement:  [1,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x894,\xe2\x80\x893,\xe2\x80\x891];  [1,\xe2\x80\x891];  [2,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x891];  [1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x891]. Suddenly, k more requirements appeared. Each of the requirements has the form: ""h[xi] signi h[yi]"", where h[t] is the height of the t-th block, and a signi is one of the five possible signs: \'=\' (equals), \'<\' (less than), \'>\' (more than), \'<=\' (less than or equals), \'>=\' (more than or equals). Thus, each of the k additional requirements is given by a pair of indexes xi, yi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi,\xe2\x80\x89yi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n) and sign signi.Find the number of possible ways to rearrange the blocks so that both the requirement about the shape of the mausoleum (see paragraph 3) and the k additional requirements were met." 2400.0                            
                    567C "Geometric Progression" "binary search,data structures,dp" "Polycarp loves geometric progressions very much. Since he was only three years old, he loves only the progressions of length three. He also has a favorite integer k and a sequence a, consisting of n integers.He wants to know how many subsequences of length three can be selected from a, so that they form a geometric progression with common ratio k.A subsequence of length three is a combination of three such indexes i1,\xe2\x80\x89i2,\xe2\x80\x89i3, that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89i3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. That is, a subsequence of length three are such groups of three elements that are not necessarily consecutive in the sequence, but their indexes are strictly increasing.A geometric progression with common ratio k is a sequence of numbers of the form b\xc2\xb7k0,\xe2\x80\x89b\xc2\xb7k1,\xe2\x80\x89...,\xe2\x80\x89b\xc2\xb7kr\xe2\x80\x89-\xe2\x80\x891.Polycarp is only three years old, so he can not calculate this number himself. Help him to do it." 1700.0                            
                    566E "Restoring Map" "bitmasks,constructive algorithms,trees" "Archaeologists found some information about an ancient land of Treeland. We know for sure that the Treeland consisted of n cities connected by the n\xe2\x80\x89-\xe2\x80\x891 road, such that you can get from each city to any other one along the roads. However, the information about the specific design of roads in Treeland has been lost. The only thing that the archaeologists can use is the preserved information about near cities.Two cities of Treeland were called near, if it were possible to move from one city to the other one by moving through at most two roads. Also, a city is considered near to itself. During the recent excavations archaeologists found a set of n notes, each of them represents a list of cities, near to some of the n cities of the country. However, unfortunately, none of the found records lets you understand in what order the cities go in the list and for which city in the list the near to it cities were listed. Help the archaeologists and restore any variant of the map of Treeland that meets the found information." 3200.0                            
                    560B "Gerald is into Art" "constructive algorithms,implementation" "Gerald bought two very rare paintings at the Sotheby\'s auction and he now wants to hang them on the wall. For that he bought a special board to attach it to the wall and place the paintings on the board. The board has shape of an a1\xe2\x80\x89\xc3\x97\xe2\x80\x89b1 rectangle, the paintings have shape of a a2\xe2\x80\x89\xc3\x97\xe2\x80\x89b2 and a3\xe2\x80\x89\xc3\x97\xe2\x80\x89b3 rectangles.Since the paintings are painted in the style of abstract art, it does not matter exactly how they will be rotated, but still, one side of both the board, and each of the paintings must be parallel to the floor. The paintings can touch each other and the edges of the board, but can not overlap or go beyond the edge of the board. Gerald asks whether it is possible to place the paintings on the board, or is the board he bought not large enough?" 1200.0                            
                    558C "Amr and Chemistry" "brute force,graphs,greedy,math,shortest paths" "Amr loves Chemistry, and specially doing experiments. He is preparing for a new interesting experiment.Amr has n different types of chemicals. Each chemical i has an initial volume of ai liters. For this experiment, Amr has to mix all the chemicals together, but all the chemicals volumes must be equal first. So his task is to make all the chemicals volumes equal.To do this, Amr can do two different kind of operations.   Choose some chemical i and double its current volume so the new volume will be 2ai  Choose some chemical i and divide its volume by two (integer division) so the new volume will be  Suppose that each chemical is contained in a vessel of infinite volume. Now Amr wonders what is the minimum number of operations required to make all the chemicals volumes equal?" 1900.0                            
                    555B "Case of Fugitive" "data structures,greedy,sortings" "Andrewid the Android is a galaxy-famous detective. He is now chasing a criminal hiding on the planet Oxa-5, the planet almost fully covered with water.The only dry land there is an archipelago of n narrow islands located in a row. For more comfort let\'s represent them as non-intersecting segments on a straight line: island i has coordinates [li,\xe2\x80\x89ri], besides, ri\xe2\x80\x89<\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891 for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891.To reach the goal, Andrewid needs to place a bridge between each pair of adjacent islands. A bridge of length a can be placed between the i-th and the (i\xe2\x80\x89+\xe2\x80\x891)-th islads, if there are such coordinates of x and y, that li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri, li\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89+\xe2\x80\x891 and y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89=\xe2\x80\x89a. The detective was supplied with m bridges, each bridge can be used at most once. Help him determine whether the bridges he got are enough to connect each pair of adjacent islands." 2000.0                            
                    551A "GukiZ and Contest" "brute force,implementation,sortings" "Professor GukiZ likes programming contests. He especially likes to rate his students on the contests he prepares. Now, he has decided to prepare a new contest. In total, n students will attend, and before the start, every one of them has some positive integer rating. Students are indexed from 1 to n. Let\'s denote the rating of i-th student as ai. After the contest ends, every student will end up with some positive integer position. GukiZ expects that his students will take places according to their ratings. He thinks that each student will take place equal to . In particular, if student A has rating strictly lower then student B, A will get the strictly better position than B, and if two students have equal ratings, they will share the same position. GukiZ would like you to reconstruct the results by following his expectations. Help him and determine the position after the end of the contest for each of his students if everything goes as expected." 800.0                            
                    549H "Degenerate Matrix" "binary search,math" "The determinant of a matrix 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 is defined as follows:A matrix is called degenerate if its determinant is equal to zero. The norm ||A|| of a matrix A is defined as a maximum of absolute values of its elements.You are given a matrix . Consider any degenerate matrix B such that norm ||A\xe2\x80\x89-\xe2\x80\x89B|| is minimum possible. Determine ||A\xe2\x80\x89-\xe2\x80\x89B||." 2100.0                            
                    549A "Face Detection" implementation,strings "The developers of Looksery have to write an efficient algorithm that detects faces on a picture. Unfortunately, they are currently busy preparing a contest for you, so you will have to do it for them. In this problem an image is a rectangular table that consists of lowercase Latin letters. A face on the image is a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, such that from the four letters of this square you can make word ""face"". You need to write a program that determines the number of faces on the image. The squares that correspond to the faces can overlap." 900.0                            
                    548B "Mike and Fun" "brute force,dp,greedy,implementation" "Mike and some bears are playing a game just for fun. Mike is the judge. All bears except Mike are standing in an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid, there\'s exactly one bear in each cell. We denote the bear standing in column number j of row number i by (i,\xe2\x80\x89j). Mike\'s hands are on his ears (since he\'s the judge) and each bear standing in the grid has hands either on his mouth or his eyes.  They play for q rounds. In each round, Mike chooses a bear (i,\xe2\x80\x89j) and tells him to change his state i. e. if his hands are on his mouth, then he\'ll put his hands on his eyes or he\'ll put his hands on his mouth otherwise. After that, Mike wants to know the score of the bears.Score of the bears is the maximum over all rows of number of consecutive bears with hands on their eyes in that row.Since bears are lazy, Mike asked you for help. For each round, tell him the score of these bears after changing the state of a bear selected in that round." 1400.0                            
                    542E "Playing on Graph" "graphs,shortest paths" "Vova and Marina love offering puzzles to each other. Today Marina offered Vova to cope with the following task.Vova has a non-directed graph consisting of n vertices and m edges without loops and multiple edges. Let\'s define the operation of contraction two vertices a and b that are not connected by an edge. As a result of this operation vertices a and b are deleted and instead of them a new vertex x is added into the graph, and also edges are drawn from it to all vertices that were connected with a or with b (specifically, if the vertex was connected with both a and b, then also exactly one edge is added from x to it). Thus, as a result of contraction again a non-directed graph is formed, it contains no loops nor multiple edges, and it contains (n\xe2\x80\x89-\xe2\x80\x891) vertices.Vova must perform the contraction an arbitrary number of times to transform the given graph into a chain of the maximum length. A chain of length k (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) is a connected graph whose vertices can be numbered with integers from 1 to k\xe2\x80\x89+\xe2\x80\x891 so that the edges of the graph connect all pairs of vertices (i,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) and only them. Specifically, the graph that consists of one vertex is a chain of length 0. The vertices that are formed as a result of the contraction are allowed to be used in the following operations of contraction.  The picture illustrates the contraction of two vertices marked by red. Help Vova cope with his girlfriend\'s task. Find the maximum length of the chain that can be obtained from the resulting graph or else determine that it is impossible to obtain the chain." 2600.0                            
                    533A "Berland Miners" "binary search,data structures,dfs and similar,greedy,trees" "The biggest gold mine in Berland consists of n caves, connected by n\xe2\x80\x89-\xe2\x80\x891 transitions. The entrance to the mine leads to the cave number 1, it is possible to go from it to any remaining cave of the mine by moving along the transitions. The mine is being developed by the InMine Inc., k miners work for it. Each day the corporation sorts miners into caves so that each cave has at most one miner working there. For each cave we know the height of its ceiling hi in meters, and for each miner we know his height sj, also in meters. If a miner\'s height doesn\'t exceed the height of the cave ceiling where he is, then he can stand there comfortably, otherwise, he has to stoop and that makes him unhappy.Unfortunately, miners typically go on strike in Berland, so InMine makes all the possible effort to make miners happy about their work conditions. To ensure that no miner goes on strike, you need make sure that no miner has to stoop at any moment on his way from the entrance to the mine to his cave (in particular, he must be able to stand comfortably in the cave where he works). To reach this goal, you can choose exactly one cave and increase the height of its ceiling by several meters. However enlarging a cave is an expensive and complex procedure. That\'s why InMine Inc. asks you either to determine the minimum number of meters you should raise the ceiling of some cave so that it is be possible to sort the miners into the caves and keep all miners happy with their working conditions or to determine that it is impossible to achieve by raising ceiling in exactly one cave." 3000.0                            
                    525D "Arthur and Walls" "constructive algorithms,data structures,graphs,greedy,shortest paths" "Finally it is a day when Arthur has enough money for buying an apartment. He found a great option close to the center of the city with a nice price.Plan of the apartment found by Arthur looks like a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m consisting of squares of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891. Each of those squares contains either a wall (such square is denoted by a symbol ""*"" on the plan) or a free space (such square is denoted on the plan by a symbol ""."").Room in an apartment is a maximal connected area consisting of free squares. Squares are considered adjacent if they share a common side.The old Arthur dream is to live in an apartment where all rooms are rectangles. He asks you to calculate minimum number of walls you need to remove in order to achieve this goal. After removing a wall from a square it becomes a free square. While removing the walls it is possible that some rooms unite into a single one." 2400.0                            
                    525C "Ilya and Sticks" greedy,math,sortings "In the evening, after the contest Ilya was bored, and he really felt like maximizing. He remembered that he had a set of n sticks and an instrument. Each stick is characterized by its length li.Ilya decided to make a rectangle from the sticks. And due to his whim, he decided to make rectangles in such a way that maximizes their total area. Each stick is used in making at most one rectangle, it is possible that some of sticks remain unused. Bending sticks is not allowed.Sticks with lengths a1, a2, a3 and a4 can make a rectangle if the following properties are observed:  a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a4  a1\xe2\x80\x89=\xe2\x80\x89a2  a3\xe2\x80\x89=\xe2\x80\x89a4 A rectangle can be made of sticks with lengths of, for example, 3 3 3 3 or 2 2 4 4. A rectangle cannot be made of, for example, sticks 5 5 5 7.Ilya also has an instrument which can reduce the length of the sticks. The sticks are made of a special material, so the length of each stick can be reduced by at most one. For example, a stick with length 5 can either stay at this length or be transformed into a stick of length 4.You have to answer the question \xe2\x80\x94 what maximum total area of the rectangles can Ilya get with a file if makes rectangles from the available sticks?" 1600.0                            
                    525B "Pasha and String" "constructive algorithms,greedy,math,strings" "Pasha got a very beautiful string s for his birthday, the string consists of lowercase Latin letters. The letters in the string are numbered from 1 to |s| from left to right, where |s| is the length of the given string.Pasha didn\'t like his present very much so he decided to change it. After his birthday Pasha spent m days performing the following transformations on his string \xe2\x80\x94 each day he chose integer ai and reversed a piece of string (a segment) from position ai to position |s|\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891. It is guaranteed that 2\xc2\xb7ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|.You face the following task: determine what Pasha\'s string will look like after m days." 1400.0                            
                    521D Shop greedy "Vasya plays one very well-known and extremely popular MMORPG game. His game character has k skill; currently the i-th of them equals to ai. Also this game has a common rating table in which the participants are ranked according to the product of all the skills of a hero in the descending order.Vasya decided to \'upgrade\' his character via the game store. This store offers n possible ways to improve the hero\'s skills; Each of these ways belongs to one of three types:  assign the i-th skill to b;  add b to the i-th skill;  multiply the i-th skill by b. Unfortunately, a) every improvement can only be used once; b) the money on Vasya\'s card is enough only to purchase not more than m of the n improvements. Help Vasya to reach the highest ranking in the game. To do this tell Vasya which of improvements he has to purchase and in what order he should use them to make his rating become as high as possible. If there are several ways to achieve it, print any of them." 2800.0                            
                    520E "Pluses everywhere" "combinatorics,dp,math,number theory" "Vasya is sitting on an extremely boring math class. To have fun, he took a piece of paper and wrote out n numbers on a single line. After that, Vasya began to write out different ways to put pluses (""+"") in the line between certain digits in the line so that the result was a correct arithmetic expression; formally, no two pluses in such a partition can stand together (between any two adjacent pluses there must be at least one digit), and no plus can stand at the beginning or the end of a line. For example, in the string 100500, ways 100500 (add no pluses), 1+00+500 or 10050+0 are correct, and ways 100++500, +1+0+0+5+0+0 or 100500+ are incorrect.The lesson was long, and Vasya has written all the correct ways to place exactly k pluses in a string of digits. At this point, he got caught having fun by a teacher and he was given the task to calculate the sum of all the resulting arithmetic expressions by the end of the lesson (when calculating the value of an expression the leading zeros should be ignored). As the answer can be large, Vasya is allowed to get only its remainder modulo 109\xe2\x80\x89+\xe2\x80\x897. Help him!" 2200.0                            
                    520A Pangram implementation,strings "A word or a sentence in some language is called a pangram if all the characters of the alphabet of this language appear in it at least once. Pangrams are often used to demonstrate fonts in printing or test the output devices.You are given a string consisting of lowercase and uppercase Latin letters. Check whether this string is a pangram. We say that the string contains a letter of the Latin alphabet if this letter occurs in the string in uppercase or lowercase." 800.0                            
                    519D "A and B and Interesting Substrings" "data structures,dp,two pointers" "A and B are preparing themselves for programming contests.After several years of doing sports programming and solving many problems that require calculating all sorts of abstract objects, A and B also developed rather peculiar tastes.A likes lowercase letters of the Latin alphabet. He has assigned to each letter a number that shows how much he likes that letter (he has assigned negative numbers to the letters he dislikes). B likes substrings. He especially likes the ones that start and end with the same letter (their length must exceed one).Also, A and B have a string s. Now they are trying to find out how many substrings t of a string s are interesting to B (that is, t starts and ends with the same letter and its length is larger than one), and also the sum of values of all letters (assigned by A), except for the first and the last one is equal to zero.Naturally, A and B have quickly found the number of substrings t that are interesting to them. Can you do it?" 1800.0                            
                    515D "Drazil and Tiles" "constructive algorithms,greedy" "Drazil created a following problem about putting 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 tiles into an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid:""There is a grid with some cells that are empty and some cells that are occupied. You should use 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 tiles to cover all empty cells and no two tiles should cover each other. And you should print a solution about how to do it.""But Drazil doesn\'t like to write special checking program for this task. His friend, Varda advised him: ""how about asking contestant only to print the solution when it exists and it is unique? Otherwise contestant may print \'Not unique\' "".Drazil found that the constraints for this task may be much larger than for the original task!Can you solve this new problem?Note that you should print \'Not unique\' either when there exists no solution or when there exists several different solutions for the original task." 2000.0                            
                    509F "Progress Monitoring" dp,trees "Programming teacher Dmitry Olegovich is going to propose the following task for one of his tests for students:You are given a tree T with n vertices, specified by its adjacency matrix a[1... n,\xe2\x80\x891... n]. What is the output of the following pseudocode?used[1 ... n] = {0, ..., 0};procedure dfs(v):    print v;    used[v] = 1;    for i = 1, 2, ..., n:        if (a[v][i] == 1 and used[i] == 0):            dfs(i);dfs(1);In order to simplify the test results checking procedure, Dmitry Olegovich decided to create a tree T such that the result is his favorite sequence b. On the other hand, Dmitry Olegovich doesn\'t want to provide students with same trees as input, otherwise they might cheat. That\'s why Dmitry Olegovich is trying to find out the number of different trees T such that the result of running the above pseudocode with T as input is exactly the sequence b. Can you help him?Two trees with n vertices are called different if their adjacency matrices a1 and a2 are different, i. e. there exists a pair (i,\xe2\x80\x89j), such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and a1[i][j]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89a2[i][j]." 2300.0                            
                    507D "The Maths Lecture" dp,implementation "Amr doesn\'t like Maths as he finds it really boring, so he usually sleeps in Maths lectures. But one day the teacher suspected that Amr is sleeping and asked him a question to make sure he wasn\'t.First he gave Amr two positive integers n and k. Then he asked Amr, how many integer numbers x\xe2\x80\x89>\xe2\x80\x890 exist such that:  Decimal representation of x (without leading zeroes) consists of exactly n digits;  There exists some integer y\xe2\x80\x89>\xe2\x80\x890 such that:   ;  decimal representation of y is a suffix of decimal representation of x.  As the answer to this question may be pretty huge the teacher asked Amr to output only its remainder modulo a number m.Can you help Amr escape this embarrassing situation?" 2200.0                            
                    506E "Mr. Kitayuta\'s Gift" combinatorics,dp,matrices,strings "Mr. Kitayuta has kindly given you a string s consisting of lowercase English letters. You are asked to insert exactly n lowercase English letters into s to make it a palindrome. (A palindrome is a string that reads the same forward and backward. For example, ""noon"", ""testset"" and ""a"" are all palindromes, while ""test"" and ""kitayuta"" are not.) You can choose any n lowercase English letters, and insert each of them to any position of s, possibly to the beginning or the end of s. You have to insert exactly n letters even if it is possible to turn s into a palindrome by inserting less than n letters.Find the number of the palindromes that can be obtained in this way, modulo 10007." 3000.0                            
                    505D "Mr. Kitayuta\'s Technology" "dfs and similar" "Shuseki Kingdom is the world\'s leading nation for innovation and technology. There are n cities in the kingdom, numbered from 1 to n.Thanks to Mr. Kitayuta\'s research, it has finally become possible to construct teleportation pipes between two cities. A teleportation pipe will connect two cities unidirectionally, that is, a teleportation pipe from city x to city y cannot be used to travel from city y to city x. The transportation within each city is extremely developed, therefore if a pipe from city x to city y and a pipe from city y to city z are both constructed, people will be able to travel from city x to city z instantly.Mr. Kitayuta is also involved in national politics. He considers that the transportation between the m pairs of city (ai,\xe2\x80\x89bi) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) is important. He is planning to construct teleportation pipes so that for each important pair (ai,\xe2\x80\x89bi), it will be possible to travel from city ai to city bi by using one or more teleportation pipes (but not necessarily from city bi to city ai). Find the minimum number of teleportation pipes that need to be constructed. So far, no teleportation pipe has been constructed, and there is no other effective transportation between cities." 2200.0                            
                    504E "Misha and LCP on Tree" "binary search,dfs and similar,hashing,string suffix structures,trees" "Misha has a tree with characters written on the vertices. He can choose two vertices s and t of this tree and write down characters of vertices lying on a path from s to t. We\'ll say that such string corresponds to pair (s,\xe2\x80\x89t).Misha has m queries of type: you are given 4 vertices a, b, c, d; you need to find the largest common prefix of the strings that correspond to pairs (a,\xe2\x80\x89b) and (c,\xe2\x80\x89d). Your task is to help him." 3000.0                            
                    494E Sharti "data structures,games" "During the last 24 hours Hamed and Malek spent all their time playing ""Sharti"". Now they are too exhausted to finish the last round. So they asked you for help to determine the winner of this round. ""Sharti"" is played on a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n board with some of cells colored white and others colored black. The rows of the board are numbered from top to bottom using number 1 to n. Also the columns of the board are numbered from left to right using numbers 1 to n. The cell located at the intersection of i-th row and j-th column is denoted by (i,\xe2\x80\x89j).The players alternatively take turns. In each turn the player must choose a square with side-length at most k with its lower-right cell painted white. Then the colors of all the cells in this square are inversed (white cells become black and vice-versa). The player who cannot perform a move in his turn loses. You know Hamed and Malek are very clever and they would have played their best moves at each turn. Knowing this and the fact that Hamed takes the first turn, given the initial board as described in the input, you must determine which one of them will be the winner." 3200.0                            
                    494A Treasure greedy "Malek has recently found a treasure map. While he was looking for a treasure he found a locked door. There was a string s written on the door consisting of characters \'(\', \')\' and \'#\'. Below there was a manual on how to open the door. After spending a long time Malek managed to decode the manual and found out that the goal is to replace each \'#\' with one or more \')\' characters so that the final string becomes beautiful. Below there was also written that a string is called beautiful if for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) there are no more \')\' characters than \'(\' characters among the first i characters of s and also the total number of \'(\' characters is equal to the total number of \')\' characters. Help Malek open the door by telling him for each \'#\' character how many \')\' characters he must replace it with." 1500.0                            
                    492E "Vanya and Field" math "Vanya decided to walk in the field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. The field contains m apple trees, the i-th apple tree is at the cell with coordinates (xi,\xe2\x80\x89yi). Vanya moves towards vector (dx,\xe2\x80\x89dy). That means that if Vanya is now at the cell (x,\xe2\x80\x89y), then in a second he will be at cell . The following condition is satisfied for the vector: , where  is the largest integer that divides both a and b. Vanya ends his path when he reaches the square he has already visited. Vanya wonders, from what square of the field he should start his path to see as many apple trees as possible." 2000.0                            
                    491A "Up the hill" "constructive algorithms,implementation" "Hiking club ""Up the hill"" just returned from a walk. Now they are trying to remember which hills they\'ve just walked through.It is known that there were N stops, all on different integer heights between 1 and N kilometers (inclusive) above the sea level. On the first day they\'ve traveled from the first stop to the second stop, on the second day they\'ve traveled from the second to the third and so on, and on the last day they\'ve traveled from the stop N\xe2\x80\x89-\xe2\x80\x891 to the stop N and successfully finished their expedition.They are trying to find out which heights were their stops located at. They have an entry in a travel journal specifying how many days did they travel up the hill, and how many days did they walk down the hill.Help them by suggesting some possible stop heights satisfying numbers from the travel journal." 1000.0                            
                    489E Hiking "binary search,dp" "A traveler is planning a water hike along the river. He noted the suitable rest points for the night and wrote out their distances from the starting point. Each of these locations is further characterized by its picturesqueness, so for the i-th rest point the distance from the start equals xi, and its picturesqueness equals bi. The traveler will move down the river in one direction, we can assume that he will start from point 0 on the coordinate axis and rest points are points with coordinates xi.Every day the traveler wants to cover the distance l. In practice, it turns out that this is not always possible, because he needs to end each day at one of the resting points. In addition, the traveler is choosing between two desires: cover distance l every day and visit the most picturesque places.Let\'s assume that if the traveler covers distance rj in a day, then he feels frustration , and his total frustration over the hike is calculated as the total frustration on all days.Help him plan the route so as to minimize the relative total frustration: the total frustration divided by the total picturesqueness of all the rest points he used.The traveler\'s path must end in the farthest rest point." 2300.0                            
                    489D "Unbearable Controversy of Being" "brute force,combinatorics,dfs and similar,graphs" "Tomash keeps wandering off and getting lost while he is walking along the streets of Berland. It\'s no surprise! In his home town, for any pair of intersections there is exactly one way to walk from one intersection to the other one. The capital of Berland is very different!Tomash has noticed that even simple cases of ambiguity confuse him. So, when he sees a group of four distinct intersections a, b, c and d, such that there are two paths from a to c \xe2\x80\x94 one through b and the other one through d, he calls the group a ""damn rhombus"". Note that pairs (a,\xe2\x80\x89b), (b,\xe2\x80\x89c), (a,\xe2\x80\x89d), (d,\xe2\x80\x89c) should be directly connected by the roads. Schematically, a damn rhombus is shown on the figure below:  Other roads between any of the intersections don\'t make the rhombus any more appealing to Tomash, so the four intersections remain a ""damn rhombus"" for him.Given that the capital of Berland has n intersections and m roads and all roads are unidirectional and are known in advance, find the number of ""damn rhombi"" in the city.When rhombi are compared, the order of intersections b and d doesn\'t matter." 1700.0                            
                    487D "Conveyor Belts" "data structures" "Automatic Bakery of Cyberland (ABC) recently bought an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle table. To serve the diners, ABC placed seats around the table. The size of each seat is equal to a unit square, so there are 2(n\xe2\x80\x89+\xe2\x80\x89m) seats in total.ABC placed conveyor belts on each unit square on the table. There are three types of conveyor belts: ""^"", ""<"" and "">"". A ""^"" belt can bring things upwards. ""<"" can bring leftwards and "">"" can bring rightwards.Let\'s number the rows with 1 to n from top to bottom, the columns with 1 to m from left to right. We consider the seats above and below the top of the table are rows 0 and n\xe2\x80\x89+\xe2\x80\x891 respectively. Also we define seats to the left of the table and to the right of the table to be column 0 and m\xe2\x80\x89+\xe2\x80\x891. Due to the conveyor belts direction restriction there are currently no way for a diner sitting in the row n\xe2\x80\x89+\xe2\x80\x891 to be served.Given the initial table, there will be q events in order. There are two types of events:  ""A x y"" means, a piece of bread will appear at row x and column y (we will denote such position as (x,\xe2\x80\x89y)). The bread will follow the conveyor belt, until arriving at a seat of a diner. It is possible that the bread gets stuck in an infinite loop. Your task is to simulate the process, and output the final position of the bread, or determine that there will be an infinite loop.  ""C x y c"" means that the type of the conveyor belt at (x,\xe2\x80\x89y) is changed to c. Queries are performed separately meaning that even if the bread got stuck in an infinite loop, it won\'t affect further queries." 2700.0                            
                    482B "Interesting Array" "constructive algorithms,data structures,trees" "We\'ll call an array of n non-negative integers a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n] interesting, if it meets m constraints. The i-th of the m constraints consists of three integers li, ri, qi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) meaning that value  should be equal to qi. Your task is to find any interesting array of n elements or state that such array doesn\'t exist.Expression x&y means the bitwise AND of numbers x and y. In programming languages C++, Java and Python this operation is represented as ""&"", in Pascal \xe2\x80\x94 as ""and""." 1800.0                            
                    479C Exams greedy,sortings "Student Valera is an undergraduate student at the University. His end of term exams are approaching and he is to pass exactly n exams. Valera is a smart guy, so he will be able to pass any exam he takes on his first try. Besides, he can take several exams on one day, and in any order.According to the schedule, a student can take the exam for the i-th subject on the day number ai. However, Valera has made an arrangement with each teacher and the teacher of the i-th subject allowed him to take an exam before the schedule time on day bi (bi\xe2\x80\x89<\xe2\x80\x89ai). Thus, Valera can take an exam for the i-th subject either on day ai, or on day bi. All the teachers put the record of the exam in the student\'s record book on the day of the actual exam and write down the date of the mark as number ai.Valera believes that it would be rather strange if the entries in the record book did not go in the order of non-decreasing date. Therefore Valera asks you to help him. Find the minimum possible value of the day when Valera can take the final exam if he takes exams so that all the records in his record book go in the order of non-decreasing date." 1400.0                            
                    476B "Dreamoon and WiFi" "bitmasks,brute force,combinatorics,dp,math,probabilities" "Dreamoon is standing at the position 0 on a number line. Drazil is sending a list of commands through Wi-Fi to Dreamoon\'s smartphone and Dreamoon follows them.Each command is one of the following two types:   Go 1 unit towards the positive direction, denoted as \'+\'  Go 1 unit towards the negative direction, denoted as \'-\' But the Wi-Fi condition is so poor that Dreamoon\'s smartphone reports some of the commands can\'t be recognized and Dreamoon knows that some of them might even be wrong though successfully recognized. Dreamoon decides to follow every recognized command and toss a fair coin to decide those unrecognized ones (that means, he moves to the 1 unit to the negative or positive direction with the same probability 0.5). You are given an original list of commands sent by Drazil and list received by Dreamoon. What is the probability that Dreamoon ends in the position originally supposed to be final by Drazil\'s commands?" 1300.0                            
                    472E "Design Tutorial: Learn from a Game" "constructive algorithms,implementation" "One way to create task is to learn from game. You should pick a game and focus on part of the mechanic of that game, then it might be a good task.Let\'s have a try. Puzzle and Dragon was a popular game in Japan, we focus on the puzzle part of that game, it is a tile-matching puzzle.(Picture from Wikipedia page: http://en.wikipedia.org/wiki/Puzzle_&_Dragons)There is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m board which consists of orbs. During the game you can do the following move. In the beginning of move you touch a cell of the board, then you can move your finger to one of the adjacent cells (a cell not on the boundary has 8 adjacent cells), then you can move your finger from the current cell to one of the adjacent cells one more time, and so on. Each time you move your finger from a cell to another cell, the orbs in these cells swap with each other. In other words whatever move you make, the orb in the cell you are touching never changes.The goal is to achieve such kind of pattern that the orbs will be cancelled and your monster will attack the enemy, but we don\'t care about these details. Instead, we will give you the initial board as an input and the target board as an output. Your goal is to determine whether there is a way to reach the target in a single move." 2800.0                            
                    471E "MUH and Lots and Lots of Segments" "data structures,dsu" "Polar bears Menshykov and Uslada from the zoo of St. Petersburg and elephant Horace from the zoo of Kiev decided to do some painting. As they were trying to create their first masterpiece, they made a draft on a piece of paper. The draft consists of n segments. Each segment was either horizontal or vertical. Now the friends want to simplify the draft by deleting some segments or parts of segments so that the final masterpiece meets three conditions:  Horace wants to be able to paint the whole picture in one stroke: by putting the brush on the paper and never taking it off until the picture is ready. The brush can paint the same place multiple times. That\'s why all the remaining segments must form a single connected shape.  Menshykov wants the resulting shape to be simple. He defines a simple shape as a shape that doesn\'t contain any cycles.  Initially all the segment on the draft have integer startpoint and endpoint coordinates. Uslada doesn\'t like real coordinates and she wants this condition to be fulfilled after all the changes. As in other parts the draft is already beautiful, the friends decided to delete such parts of the draft that the sum of lengths of the remaining segments is as large as possible. Your task is to count this maximum sum of the lengths that remain after all the extra segments are removed." 2700.0                            
                    471B "MUH and Important Things" implementation,sortings "It\'s time polar bears Menshykov and Uslada from the zoo of St. Petersburg and elephant Horace from the zoo of Kiev got down to business. In total, there are n tasks for the day and each animal should do each of these tasks. For each task, they have evaluated its difficulty. Also animals decided to do the tasks in order of their difficulty. Unfortunately, some tasks can have the same difficulty, so the order in which one can perform the tasks may vary.Menshykov, Uslada and Horace ask you to deal with this nuisance and come up with individual plans for each of them. The plan is a sequence describing the order in which an animal should do all the n tasks. Besides, each of them wants to have its own unique plan. Therefore three plans must form three different sequences. You are to find the required plans, or otherwise deliver the sad news to them by stating that it is impossible to come up with three distinct plans for the given tasks." 1300.0                            
                    469A "I Wanna Be the Guy" greedy,implementation "There is a game called ""I Wanna Be the Guy"", consisting of n levels. Little X and his friend Little Y are addicted to the game. Each of them wants to pass the whole game.Little X can pass only p levels of the game. And Little Y can pass only q levels of the game. You are given the indices of levels Little X can pass and the indices of levels Little Y can pass. Will Little X and Little Y pass the whole game, if they cooperate each other?" 800.0                            
                    468E Permanent "dp,graph matchings,math,meet-in-the-middle" "Little X has solved the #P-complete problem in polynomial time recently. So he gives this task to you. There is a special n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix A, you should calculate its permanent modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). The special property of matrix A is almost all its elements equal to 1. Only k elements have specified value.You can find the definition of permanent at the link: https://en.wikipedia.org/wiki/Permanent" 3100.0                            
                    468B "Two Sets" "2-sat,dfs and similar,dsu,graph matchings,greedy" "Little X has n distinct integers: p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. He wants to divide all of them into two sets A and B. The following two conditions must be satisfied:  If number x belongs to set A, then number a\xe2\x80\x89-\xe2\x80\x89x must also belong to set A.  If number x belongs to set B, then number b\xe2\x80\x89-\xe2\x80\x89x must also belong to set B. Help Little X divide the numbers into two sets or determine that it\'s impossible." 2000.0                            
                    466C "Number of Ways" "binary search,brute force,data structures,dp,two pointers" "You\'ve got array a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n], consisting of n integers. Count the number of ways to split all the elements of the array into three contiguous parts so that the sum of elements in each part is the same. More formally, you need to find the number of such pairs of indices i,\xe2\x80\x89j (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), that ." 1700.0                            
                    462B "Appleman and Card Game" greedy "Appleman has n cards. Each card has an uppercase letter written on it. Toastman must choose k cards from Appleman\'s cards. Then Appleman should give Toastman some coins depending on the chosen cards. Formally, for each Toastman\'s card i you should calculate how much Toastman\'s cards have the letter equal to letter on ith, then sum up all these quantities, such a number of coins Appleman should give to Toastman.Given the description of Appleman\'s cards. What is the maximum number of coins Toastman can get?" 1300.0                            
                    459E "Pashmak and Graph" dp,sortings "Pashmak\'s homework is a problem about graphs. Although he always tries to do his homework completely, he can\'t solve this problem. As you know, he\'s really weak at graph theory; so try to help him in solving the problem.You are given a weighted directed graph with n vertices and m edges. You need to find a path (perhaps, non-simple) with maximum number of edges, such that the weights of the edges increase along the path. In other words, each edge of the path must have strictly greater weight than the previous edge in the path.Help Pashmak, print the number of edges in the required path." 1900.0                            
                    457A "Golden System" math,meet-in-the-middle "Piegirl got bored with binary, decimal and other integer based counting systems. Recently she discovered some interesting properties about number , in particular that q2\xe2\x80\x89=\xe2\x80\x89q\xe2\x80\x89+\xe2\x80\x891, and she thinks it would make a good base for her new unique system. She called it ""golden system"". In golden system the number is a non-empty string containing 0\'s and 1\'s as digits. The decimal value of expression a0a1...an equals to .Soon Piegirl found out that this system doesn\'t have same properties that integer base systems do and some operations can not be performed on it. She wasn\'t able to come up with a fast way of comparing two numbers. She is asking for your help.Given two numbers written in golden system notation, determine which of them has larger decimal value." 1700.0                            
                    455B "A Lot of Games" "dfs and similar,dp,games,implementation,strings,trees" "Andrew, Fedor and Alex are inventive guys. Now they invent the game with strings for two players.Given a group of n non-empty strings. During the game two players build the word together, initially the word is empty. The players move in turns. On his step player must add a single letter in the end of the word, the resulting word must be prefix of at least one string from the group. A player loses if he cannot move.Andrew and Alex decided to play this game k times. The player who is the loser of the i-th game makes the first move in the (i\xe2\x80\x89+\xe2\x80\x891)-th game. Guys decided that the winner of all games is the player who wins the last (k-th) game. Andrew and Alex already started the game. Fedor wants to know who wins the game if both players will play optimally. Help him." 1900.0                            
                    454B "Little Pony and Sort by Shift" implementation "One day, Twilight Sparkle is interested in how to sort a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an in non-decreasing order. Being a young unicorn, the only operation she can perform is a unit shift. That is, she can move the last element of the sequence to its beginning:a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89an,\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. Help Twilight Sparkle to calculate: what is the minimum number of operations that she needs to sort the sequence?" 1200.0                            
                    453A "Little Pony and Expected Maximum" probabilities "Twilight Sparkle was playing Ludo with her friends Rainbow Dash, Apple Jack and Flutter Shy. But she kept losing. Having returned to the castle, Twilight Sparkle became interested in the dice that were used in the game.The dice has m faces: the first face of the dice contains a dot, the second one contains two dots, and so on, the m-th face contains m dots. Twilight Sparkle is sure that when the dice is tossed, each face appears with probability . Also she knows that each toss is independent from others. Help her to calculate the expected maximum number of dots she could get after tossing the dice n times." 1600.0                            
                         1867E1 "Salyg1n and Array (simple version)" "constructive algorithms,interactive,math" "This is the simple version of the problem. The only difference between the versions is the limit on the number of queries. In this version, you can make no more than 100 queries. You can make hacks only if both versions of the problem are solved.This is an interactive problem!salyg1n has given you a positive integer k and wants to play a game with you. He has chosen an array of n integers a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4109). You must print a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an, where \xe2\x8a\x95 denotes the bitwise XOR operation. You can make queries of the following type:  ? i: in response to this query, you will receive ai\xe2\x8a\x95ai+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ai+k\xe2\x88\x921. Also, after this query, the subarray ai,ai+1,\xe2\x80\xa6,ai+k\xe2\x88\x921 will be reversed, i.e., the chosen array a will become: a1,a2,\xe2\x80\xa6ai\xe2\x88\x921,ai+k\xe2\x88\x921,ai+k\xe2\x88\x922,\xe2\x80\xa6,ai+1,ai,ai+k,\xe2\x80\xa6,an. You can make no more than 100 queries to answer the problem." 2000.0                       
                         1866L "Lihmuf Balling" "binary search,brute force,math" "After working at a factory (Lihmuf Sorting), Lihmuf wants to play a game with his good friend, Pak Chanek. There are N boxes numbered from 1 to N. The i-th box contains i balls. Pak Chanek and Lihmuf will play a game using those boxes.There will be N turns numbered from 1 to N. On each turn, Pak Chanek chooses one box and takes all balls from that box, then Lihmuf does the same thing for one box he chooses (it is possible that the two chosen boxes are the same).Given an integer M. Before the game begins, Lihmuf must choose an integer K satisfying 1\xe2\x89\xa4K\xe2\x89\xa4M. It is known that on the j-th turn, Pak Chanek will choose the j-th box, while Lihmuf will choose the y-th box, with y=((j\xc3\x97K\xe2\x88\x921)modN)+1. Help Lihmuf choose the correct value of K so that he will get as many balls as possible! If there are more than one possible values of K that result in the maximum total balls, find the minimum such value of K.Keep in mind that each box can be chosen more than once, but after a box is chosen for the first time, the box becomes empty." 2400.0                       
                         1864I "Future Dominators" graphs,greedy "Dhruvil and amenotiomoi are sitting in different countries and chatting online. Initially, amenotiomoi has an empty board of size n\xc3\x97n, and Dhruvil has a sequence of integers 1,2,\xe2\x80\xa6,n2, each number occurring exactly once. The numbers may be placed in the cells of the board, each cell is either empty or contains exactly one number.The current state of the board is called good, if there is a way of placing the remaining numbers in empty cells so that all numbers except 1 have a neighbor with a smaller value. Two cells are neighbors if they share an edge.The rows are numbered from 1 to n from top to bottom, the columns are numbered from 1 to n from left to right. The cell at the intersection of the x-th row and the y-th column is denoted as (x,y).To chat, amenotiomoi asks q queries to Dhruvil. Each time he provides Dhruvil with an empty cell (x,y). Dhruvil has to place one of the remaining numbers in this cell so that the board is still good. Among all ways to do this, he chooses the largest possible number he can place and sends this number to amenotiomoi as the answer to the query.Since amenotiomoi knows the correct answer every time, he tells Dhruvil (x\xe2\x8a\x95k,y\xe2\x8a\x95k) instead of (x,y), where k is the answer for the previous query. If amenotiomoi is sending the first query, he considers k=0. Each time Dhruvil has to decode the query and send the answer to amenotiomoi. Here \xe2\x8a\x95 denotes the bitwise XOR operation.Help Dhruvil reply to all amenotiomoi\'s queries." 3500.0                       
                         1862E "Kolya and Movie Theatre" "constructive algorithms,data structures,greedy" "Recently, Kolya found out that a new movie theatre is going to be opened in his city soon, which will show a new movie every day for n days. So, on the day with the number 1\xe2\x89\xa4i\xe2\x89\xa4n, the movie theatre will show the premiere of the i-th movie. Also, Kolya found out the schedule of the movies and assigned the entertainment value to each movie, denoted by ai.However, the longer Kolya stays without visiting a movie theatre, the larger the decrease in entertainment value of the next movie. That decrease is equivalent to d\xe2\x8b\x85cnt, where d is a predetermined value and cnt is the number of days since the last visit to the movie theatre. It is also known that Kolya managed to visit another movie theatre a day before the new one opened \xe2\x80\x94 the day with the number 0. So if we visit the movie theatre the first time on the day with the number i, then cnt \xe2\x80\x94 the number of days since the last visit to the movie theatre will be equal to i.For example, if d=2 and a=[3,2,5,4,6], then by visiting movies with indices 1 and 3, cnt value for the day 1 will be equal to 1\xe2\x88\x920=1 and cnt value for the day 3 will be 3\xe2\x88\x921=2, so the total entertainment value of the movies will be a1\xe2\x88\x92d\xe2\x8b\x851+a3\xe2\x88\x92d\xe2\x8b\x852=3\xe2\x88\x922\xe2\x8b\x851+5\xe2\x88\x922\xe2\x8b\x852=2.Unfortunately, Kolya only has time to visit at most m movies. Help him create a plan to visit the cinema in such a way that the total entertainment value of all the movies he visits is maximized." 1600.0                       
                         1858E1 "Rollbacks (Easy Version)" "brute force,data structures,dfs and similar,trees" "This is an easy version of this problem. The only difference between the versions is that you have to solve the hard version in online mode. You can make hacks only if both versions of the problem are solved.You have an array a, which is initially empty. You need to process queries of the following types:  + x \xe2\x80\x94 add the integer x to the end of the array a.  - k \xe2\x80\x94 remove the last k numbers from the array a.  ! \xe2\x80\x94 roll back the last active change (i.e., make the array a the way it was before the change). In this problem, only queries of the first two types (+ and -) are considered as changes.  ? \xe2\x80\x94 find the number of distinct numbers in the array a." 2500.0                       
                         1858C "Yet Another Permutation Problem" "constructive algorithms,greedy,math,number theory" "Alex got a new game called ""GCD permutations"" as a birthday present. Each round of this game proceeds as follows:  First, Alex chooses a permutation\xe2\x80\xa0 a1,a2,\xe2\x80\xa6,an of integers from 1 to n.  Then, for each i from 1 to n, an integer di=gcd(ai,a(imodn)+1) is calculated.  The score of the round is the number of distinct numbers among d1,d2,\xe2\x80\xa6,dn. Alex has already played several rounds so he decided to find a permutation a1,a2,\xe2\x80\xa6,an such that its score is as large as possible.Recall that gcd(x,y) denotes the greatest common divisor (GCD) of numbers x and y, and xmody denotes the remainder of dividing x by y.\xe2\x80\xa0A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1000.0                       
                         1857E "Power of Points" math,sortings "You are given n points with integer coordinates x1,\xe2\x80\xa6xn, which lie on a number line.For some integer s, we construct segments [s,x1], [s,x2], \xe2\x80\xa6, [s,xn]. Note that if xi<s, then the segment will look like [xi,s]. The segment [a,b] covers all integer points a,a+1,a+2,\xe2\x80\xa6,b.We define the power of a point p as the number of segments that intersect the point with coordinate p, denoted as fp.Your task is to compute 109\xe2\x88\x91p=1fp for each s\xe2\x88\x88{x1,\xe2\x80\xa6,xn}, i.e., the sum of fp for all integer points from 1 to 109.For example, if the initial coordinates are [1,2,5,7,1] and we choose s=5, then the segments will be: [1,5],[2,5],[5,5],[5,7],[1,5]. And the powers of the points will be: f1=2,f2=3,f3=3,f4=3,f5=5,f6=1,f7=1,f8=0,\xe2\x80\xa6,f109=0. Their sum is 2+3+3+3+5+1+1=18." 1500.0                       
                         1856E2 "PermuTree (hard version)" "bitmasks,dfs and similar,dp,fft,greedy,implementation,math,trees" "This is the hard version of the problem. The differences between the two versions are the constraint on n and the time limit. You can make hacks only if both versions of the problem are solved.You are given a tree with n vertices rooted at vertex 1.For some permutation\xe2\x80\xa0 a of length n, let f(a) be the number of pairs of vertices (u,v) such that au<alca(u,v)<av. Here, lca(u,v) denotes the lowest common ancestor of vertices u and v.Find the maximum possible value of f(a) over all permutations a of length n.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2700.0                       
                         1856D "More Wrong" "divide and conquer,interactive" "This is an interactive problem.The jury has hidden a permutation\xe2\x80\xa0 p of length n.In one query, you can pick two integers l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n) by paying (r\xe2\x88\x92l)2 coins. In return, you will be given the number of inversions\xe2\x80\xa1 in the subarray [pl,pl+1,\xe2\x80\xa6pr].Find the index of the maximum element in p by spending at most 5\xe2\x8b\x85n2 coins.Note: the grader is not adaptive: the permutation is fixed before any queries are made.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).\xe2\x80\xa1 The number of inversions in an array is the number of pairs of indices (i,j) such that i<j and ai>aj. For example, the array [10,2,6,3] contains 4 inversions. The inversions are (1,2),(1,3),(1,4), and (3,4)." 2100.0                       
                         1856B "Good Arrays" implementation,math "You are given an array of positive integers a of length n.Let\'s call an array of positive integers b of length n good if:   ai\xe2\x89\xa0bi for all i from 1 to n,  a1+a2+\xe2\x80\xa6+an=b1+b2+\xe2\x80\xa6+bn. Does a good array exist?" 900.0                       
                         1852C "Ina of the Mountain" "data structures,dp,greedy,math" "To prepare her ""Takodachi"" dumbo octopuses for world domination, Ninomae Ina\'nis, a.k.a. Ina of the Mountain, orders Hoshimachi Suisei to throw boulders at them. Ina asks you, Kiryu Coco, to help choose where the boulders are thrown.There are n octopuses on a single-file trail on Ina\'s mountain, numbered 1,2,\xe2\x80\xa6,n. The i-th octopus has a certain initial health value ai, where 1\xe2\x89\xa4ai\xe2\x89\xa4k.Each boulder crushes consecutive octopuses with indexes l,l+1,\xe2\x80\xa6,r, where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. You can choose the numbers l and r arbitrarily for each boulder.For each boulder, the health value of each octopus the boulder crushes is reduced by 1. However, as octopuses are immortal, once they reach a health value of 0, they will immediately regenerate to a health value of k. Given the octopuses\' initial health values, find the minimum number of boulders that need to be thrown to make the health of all octopuses equal to k." 2400.0                       
                         1849D "Array Painting" "constructive algorithms,greedy,two pointers" "You are given an array of n integers, where each integer is either 0, 1, or 2. Initially, each element of the array is blue.Your goal is to paint each element of the array red. In order to do so, you can perform operations of two types:  pay one coin to choose a blue element and paint it red;  choose a red element which is not equal to 0 and a blue element adjacent to it, decrease the chosen red element by 1, and paint the chosen blue element red. What is the minimum number of coins you have to spend to achieve your goal?" 1700.0                       
                         1847B "Hamon Odyssey" "bitmasks,greedy,two pointers" "Jonathan is fighting against DIO\'s Vampire minions. There are n of them with strengths a1,a2,\xe2\x80\xa6,an. Denote (l,r) as the group consisting of the vampires with indices from l to r. Jonathan realizes that the strength of any such group is in its weakest link, that is, the bitwise AND. More formally, the strength level of the group (l,r) is defined as f(l,r)=al&al+1&al+2&\xe2\x80\xa6&ar. Here, & denotes the bitwise AND operation. Because Jonathan would like to defeat the vampire minions fast, he will divide the vampires into contiguous groups, such that each vampire is in exactly one group, and the sum of strengths of the groups is minimized. Among all ways to divide the vampires, he would like to find the way with the maximum number of groups.Given the strengths of each of the n vampires, find the maximum number of groups among all possible ways to divide the vampires with the smallest sum of strengths." 1000.0                       
                         1846D "Rudolph and Christmas Tree" "constructive algorithms,geometry,math" "Rudolph drew a beautiful Christmas tree and decided to print the picture. However, the ink in the cartridge often runs out at the most inconvenient moment. Therefore, Rudolph wants to calculate in advance how much green ink he will need.The tree is a vertical trunk with identical triangular branches at different heights. The thickness of the trunk is negligible.Each branch is an isosceles triangle with base d and height h, whose base is perpendicular to the trunk. The triangles are arranged upward at an angle, and the trunk passes exactly in the middle. The base of the i-th triangle is located at a height of yi.The figure below shows an example of a tree with d=4,h=2 and three branches with bases at heights [1,4,5].  Help Rudolph calculate the total area of the tree branches." 1200.0                       
                         1844A "Subtraction Game" "constructive algorithms,games" "You are given two positive integers, a and b (a<b).For some positive integer n, two players will play a game starting with a pile of n stones. They take turns removing exactly a or exactly b stones from the pile. The player who is unable to make a move loses.Find a positive integer n such that the second player to move in this game has a winning strategy. This means that no matter what moves the first player makes, the second player can carefully choose their moves (possibly depending on the first player\'s moves) to ensure they win." 800.0                       
                         1841F "Monocarp and a Strategic Game" "geometry,sortings,two pointers" "Monocarp plays a strategic computer game in which he develops a city. The city is inhabited by creatures of four different races \xe2\x80\x94 humans, elves, orcs, and dwarves.Each inhabitant of the city has a happiness value, which is an integer. It depends on how many creatures of different races inhabit the city. Specifically, the happiness of each inhabitant is 0 by default; it increases by 1 for each other creature of the same race and decreases by 1 for each creature of a hostile race. Humans are hostile to orcs (and vice versa), and elves are hostile to dwarves (and vice versa).At the beginning of the game, Monocarp\'s city is not inhabited by anyone. During the game, n groups of creatures will come to his city, wishing to settle there. The i-th group consists of ai humans, bi orcs, ci elves, and di dwarves. Each time, Monocarp can either accept the entire group of creatures into the city, or reject the entire group.The game calculates Monocarp\'s score according to the following formula: m+k, where m is the number of inhabitants in the city, and k is the sum of the happiness values of all creatures in the city.Help Monocarp earn the maximum possible number of points by the end of the game!" 2700.0                       
                         1840A "Cipher Shifer" "implementation,strings,two pointers" "There is a string a (unknown to you), consisting of lowercase Latin letters, encrypted according to the following rule into string s:  after each character of string a, an arbitrary (possibly zero) number of any lowercase Latin letters, different from the character itself, is added;  after each such addition, the character that we supplemented is added. You are given string s, and you need to output the initial string a. In other words, you need to decrypt string s.Note that each string encrypted in this way is decrypted uniquely." 800.0                       
                         1839B Lamps greedy,sortings "You have n lamps, numbered by integers from 1 to n. Each lamp i has two integer parameters ai and bi.At each moment each lamp is in one of three states: it may be turned on, turned off, or broken.Initially all lamps are turned off. In one operation you can select one lamp that is turned off and turn it on (you can\'t turn on broken lamps). You receive bi points for turning lamp i on. The following happens after each performed operation:   Let\'s denote the number of lamps that are turned on as x (broken lamps do not count). All lamps i such that ai\xe2\x89\xa4x simultaneously break, whether they were turned on or off. Please note that broken lamps never count as turned on and that after a turned on lamp breaks, you still keep points received for turning it on.You can perform an arbitrary number of operations.Find the maximum number of points you can get." 1100.0                       
                         1838C "No Prime Differences" "constructive algorithms,math,number theory" "You are given integers n and m. Fill an n by m grid with the integers 1 through n\xe2\x8b\x85m, in such a way that for any two adjacent cells in the grid, the absolute difference of the values in those cells is not a prime number. Two cells in the grid are considered adjacent if they share a side.  It can be shown that under the given constraints, there is always a solution." 1400.0                       
                         1837E "Playoff Fixing" combinatorics,trees "2k teams participate in a playoff tournament. The teams are numbered from 1 to 2k, in order of decreasing strength. So, team 1 is the strongest one, team 2k is the weakest one. A team with a smaller number always defeats a team with a larger number.First of all, the teams are arranged in some order during a procedure called seeding. Each team is assigned another unique value from 1 to 2k, called a seed, that represents its starting position in the playoff.The tournament consists of 2k\xe2\x88\x921 games. They are held as follows: the teams are split into pairs: team with seed 1 plays against team with seed 2, team with seed 3 plays against team with seed 4 (exactly in this order), and so on (so, 2k\xe2\x88\x921 games are played in that phase). When a team loses a game, it is eliminated.After that, only 2k\xe2\x88\x921 teams remain. If only one team remains, it is declared the champion; otherwise, 2k\xe2\x88\x922 games are played: in the first one of them, the winner of the game ""seed 1 vs seed 2"" plays against the winner of the game ""seed 3 vs seed 4"", then the winner of the game ""seed 5 vs seed 6"" plays against the winner of the game ""seed 7 vs seed 8"", and so on. This process repeats until only one team remains.After the tournament ends, the teams are assigned places according to the tournament phase when they were eliminated. In particular:  the winner of the tournament gets place 1;  the team eliminated in the finals gets place 2;  both teams eliminated in the semifinals get place 3;  all teams eliminated in the quarterfinals get place 5;  all teams eliminated in the 1/8 finals get place 9, and so on. Now that we established the rules, we do a little rigging. In particular, we want:   team 1 (not team with seed 1) to take place 1;  team 2 to take place 2;  teams 3 and 4 to take place 3;  teams from 5 to 8 to take place 5, and so on. For example, this picture describes one of the possible ways the tournament can go with k=3, and the resulting places of the teams:  Some seeds are already reserved for some teams (we are not the only ones rigging the tournament, apparently). We have to fill the rest of the seeds with the remaining teams to achieve the desired placements. How many ways are there to do that? Since that value might be large, print it modulo 998244353." 2200.0                       
                         1837A "Grasshopper on a Line" "constructive algorithms,math" "You are given two integers x and k. Grasshopper starts in a point 0 on an OX axis. In one move, it can jump some integer distance, that is not divisible by k, to the left or to the right.What\'s the smallest number of moves it takes the grasshopper to reach point x? What are these moves? If there are multiple answers, print any of them." 800.0                       
                         1832C "Contrast Value" greedy,implementation "For an array of integers [a1,a2,\xe2\x80\xa6,an], let\'s call the value |a1\xe2\x88\x92a2|+|a2\xe2\x88\x92a3|+\xe2\x8b\xaf+|an\xe2\x88\x921\xe2\x88\x92an| the contrast of the array. Note that the contrast of an array of size 1 is equal to 0.You are given an array of integers a. Your task is to build an array of b in such a way that all the following conditions are met:  b is not empty, i.e there is at least one element;  b is a subsequence of a, i.e b can be produced by deleting some elements from a (maybe zero);  the contrast of b is equal to the contrast of a. What is the minimum possible size of the array b?" 1200.0                       
                         1832B "Maximum Sum" "brute force,sortings,two pointers" "You are given an array a1,a2,\xe2\x80\xa6,an, where all elements are different.You have to perform exactly k operations with it. During each operation, you do exactly one of the following two actions (you choose which to do yourself):  find two minimum elements in the array, and delete them;  find the maximum element in the array, and delete it. You have to calculate the maximum possible sum of elements in the resulting array." 1100.0                       
                         1826F "Fading into Fog" geometry,interactive,math,probabilities "This is an interactive problem.There are n distinct hidden points with real coordinates on a two-dimensional Euclidean plane. In one query, you can ask some line ax+by+c=0 and get the projections of all n points to this line in some order. The given projections are not exact, please read the interaction section for more clarity.Using the minimum number of queries, guess all n points and output them in some order. Here minimality means the minimum number of queries required to solve any possible test case with n points.The hidden points are fixed in advance and do not change throughout the interaction. In other words, the interactor is not adaptive.A projection of point A to line ax+by+c=0 is the point on the line closest to A." 2800.0                       
                         1824D "LuoTianyi and the Function" "data structures" "LuoTianyi gives you an array a of n integers and the index begins from 1.Define g(i,j) as follows:  g(i,j) is the largest integer x that satisfies {ap:i\xe2\x89\xa4p\xe2\x89\xa4j}\xe2\x8a\x86{aq:x\xe2\x89\xa4q\xe2\x89\xa4j} while i\xe2\x89\xa4j;  and g(i,j)=0 while i>j. There are q queries. For each query you are given four integers l,r,x,y, you need to calculate r\xe2\x88\x91i=ly\xe2\x88\x91j=xg(i,j)." 3000.0                       
                         1821B "Sort the Subarray" "brute force,greedy" "Monocarp had an array a consisting of n integers. He has decided to choose two integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, and then sort the subarray a[l..r] (the subarray a[l..r] is the part of the array a containing the elements al,al+1,al+2,\xe2\x80\xa6,ar\xe2\x88\x921,ar) in non-descending order. After sorting the subarray, Monocarp has obtained a new array, which we denote as a\xe2\x80\xb2.For example, if a=[6,7,3,4,4,6,5], and Monocarp has chosen l=2,r=5, then a\xe2\x80\xb2=[6,3,4,4,7,6,5].You are given the arrays a and a\xe2\x80\xb2. Find the integers l and r that Monocarp could have chosen. If there are multiple pairs of values (l,r), find the one which corresponds to the longest subarray." 1100.0                       
                         1818A Politics greedy,implementation "In a debate club with n members, including yourself (member 1), there are k opinions to be discussed in sequence. During each discussion, members express their agreement or disagreement with the opinion. Let\'s define Y as the number of members who agree and N as the number of members who disagree. After each discussion, members leave the club based on the following criteria:  If more members agree than disagree (Y>N), all members who disagreed leave the club.  If more members disagree than agree (Y<N), all members who agreed leave the club.  If there is a tie (Y=N), all members leave the club. As the club president, your goal is to stay in the club and maximize the number of members remaining after the meeting. You have access to each member\'s stance on all k opinions before the meeting starts, and you can expel any number of members (excluding yourself) before the meeting begins.Determine the maximum number of members, including yourself, who can remain in the club after the meeting. You don\'t need to provide the specific expulsion strategy but only the maximum number of members that can stay. Ensure that you remain in the club after the meeting as well." 800.0                       
                         1817D "Toy Machine" "constructive algorithms,games,implementation" "There is a toy machine with toys arranged in two rows of n cells each (n is odd).  Initial state for n=9. Initially, n\xe2\x88\x922 toys are placed in the non-corner cells of the top row. The bottom row is initially empty, and its leftmost, rightmost, and central cells are blocked. There are 4 buttons to control the toy machine: left, right, up, and down marked by the letters L, R, U, and D correspondingly.When pressing L, R, U, or D, all the toys will be moved simultaneously in the corresponding direction and will only stop if they push into another toy, the wall or a blocked cell. Your goal is to move the k-th toy into the leftmost cell of the top row. The toys are numbered from 1 to n\xe2\x88\x922 from left to right. Given n and k, find a solution that uses at most 1000000 button presses.To test out the toy machine, a web page is available that lets you play the game in real time." 2700.0                       
                         1817B "Fish Graph" "brute force,constructive algorithms,dfs and similar,graphs" "You are given a simple undirected graph with n nodes and m edges. Note that the graph is not necessarily connected. The nodes are labeled from 1 to n.We define a graph to be a Fish Graph if it contains a simple cycle with a special node u belonging to the cycle. Apart from the edges in the cycle, the graph should have exactly 2 extra edges. Both edges should connect to node u, but they should not be connected to any other node of the cycle. Determine if the graph contains a subgraph that is a Fish Graph, and if so, find any such subgraph.In this problem, we define a subgraph as a graph obtained by taking any subset of the edges of the original graph.  Visualization of example 1. The red edges form one possible subgraph that is a Fish Graph." 1900.0                       
                         1815C Between "constructive algorithms,dfs and similar,graphs,greedy" "You are given an integer n, as well as m pairs of integers (ai,bi), where 1\xe2\x89\xa4ai,bi\xe2\x89\xa4n, ai\xe2\x89\xa0bi.You want to construct a sequence satisfying the following requirements:  All elements in the sequence are integers between 1 and n.  There is exactly one element with value 1 in the sequence.  For each i (1\xe2\x89\xa4i\xe2\x89\xa4m), between any two elements (on different positions) in the sequence with value ai, there is at least one element with value bi.  The sequence constructed has the maximum length among all possible sequences satisfying the above properties. Sometimes, it is possible that such a sequence can be arbitrarily long, in which case you should output ""INFINITE"". Otherwise, you should output ""FINITE"" and the sequence itself. If there are multiple possible constructions that yield the maximum length, output any." 2200.0                       
                         1815B "Sum Graph" "brute force,constructive algorithms,graphs,implementation,interactive,shortest paths,trees" "This is an interactive problem.There is a hidden permutation p1,p2,\xe2\x80\xa6,pn. Consider an undirected graph with n nodes only with no edges. You can make two types of queries:  Specify an integer x satisfying 2\xe2\x89\xa4x\xe2\x89\xa42n. For all integers i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that 1\xe2\x89\xa4x\xe2\x88\x92i\xe2\x89\xa4n, an edge between node i and node x\xe2\x88\x92i will be added.  Query the number of edges in the shortest path between node pi and node pj. As the answer to this question you will get the number of edges in the shortest path if such a path exists, or \xe2\x88\x921 if there is no such path. Note that you can make both types of queries in any order.Within 2n queries (including type 1 and type 2), guess two possible permutations, at least one of which is p1,p2,\xe2\x80\xa6,pn. You get accepted if at least one of the permutations is correct. You are allowed to guess the same permutation twice.A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2000.0                       
                         1812I "Mountain Climber" "*special problem" "InputThe first line of input contains t (1\xe2\x89\xa4t\xe2\x89\xa425) \xe2\x80\x94 the number of test cases.The only line of each test case contains a single string s (1\xe2\x89\xa4|s|\xe2\x89\xa4100) consisting only of lowercase English letters.OutputFor each test case, print YES or NO.ExampleInputCopy23bigflashingclumpiunderpasspassundertranquilizingpoleandrejdumplingbocchiryonijikakitasingingsongsalperentoxicpiearibucketpotatoflamestormscarletsmaisakurajimamisakamikotoninfiasylveonpikachumewheniseearulhiiarulOutputCopyYESNOYESYESYESNOYESNOYESYESYESYESYESYESNONONOYESNONONONONO" -999.0                       
                         1812H "Expected Twist" "*special problem,interactive" "This is an interactive problem.There is an array a1,a2,\xe2\x80\xa6,an of n integers hidden from you. Your task is to find the smallest element of the array.To do this, you can ask several queries. In each query, you can pick two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). In return, you will be given the value of max(al,al+1,\xe2\x80\xa6,ar). In other words, you will be told the maximum value of the subarray from al to ar.Find the minimum of the array. You can ask at most 624 queries.It is guaranteed that the values a1,a2,\xe2\x80\xa6,an are chosen uniformly at random between 0 and 232\xe2\x88\x921 (inclusive)." -999.0                       
                         1812C Digits "*special problem" "InputThe first line contains a single integer t (1\xe2\x89\xa4t\xe2\x89\xa432) \xe2\x80\x94 the number of test cases.Each test case contains n lines. The i-th line contains an integer ai (1\xe2\x89\xa4ai\xe2\x89\xa49).The sum of n over all test cases doesn\'t exceed 155.OutputFor each test case, print one integer \xe2\x80\x94 the answer.ExampleInputCopy321471235OutputCopy8730" -999.0                       
                         1811G2 "Vlad and the Nice Paths (hard version)" "binary search,combinatorics,data structures,dp,math,two pointers" "This is hard version of the problem, it differs from the easy one only by constraints on n and k.Vlad found a row of n tiles and the integer k. The tiles are indexed from left to right and the i-th tile has the color ci. After a little thought, he decided what to do with it.You can start from any tile and jump to any number of tiles right, forming the path p. Let\'s call the path p of length m nice if:  p can be divided into blocks of length exactly k, that is, m is divisible by k;  cp1=cp2=\xe2\x80\xa6=cpk;  cpk+1=cpk+2=\xe2\x80\xa6=cp2k;  \xe2\x80\xa6  cpm\xe2\x88\x92k+1=cpm\xe2\x88\x92k+2=\xe2\x80\xa6=cpm; Your task is to find the number of nice paths of maximum length. Since this number may be too large, print it modulo 109+7." 2200.0                       
                         1811F "Is It Flower?" "dfs and similar,graphs,implementation" "Vlad found a flowerbed with graphs in his yard and decided to take one for himself. Later he found out that in addition to the usual graphs, k-flowers also grew on that flowerbed. A graph is called a k-flower if it consists of a simple cycle of length k, through each vertex of which passes its own simple cycle of length k and these cycles do not intersect at the vertices. For example, 3-flower looks like this:  Note that 1-flower and 2-flower do not exist, since at least 3 vertices are needed to form a cycle.Vlad really liked the structure of the k-flowers and now he wants to find out if he was lucky to take one of them from the flowerbed." 2100.0                       
                         1810E Monsters "brute force,data structures,dfs and similar,dsu,graphs,greedy" "There is an undirected graph with n vertices and m edges. Initially, for each vertex i, there is a monster with danger ai on that vertex. For a monster with danger ai, you can defeat it if and only if you have defeated at least ai other monsters before.Now you want to defeat all the monsters. First, you choose some vertex s and defeat the monster on that vertex (since you haven\'t defeated any monsters before, as has to be 0). Then, you can move through the edges. If you want to move from vertex u to vertex v, then the following must hold: either the monster on vertex v has been defeated before, or you can defeat it now. For the second case, you defeat the monster on vertex v and reach vertex v.You can pass the vertices and the edges any number of times. Determine whether you can defeat all the monsters or not." 2100.0                       
                         1810B Candies "constructive algorithms,math,number theory" "This problem is about candy. Initially, you only have 1 candy, and you want to have exactly n candies.You can use the two following spells in any order at most 40 times in total.  Assume you have x candies now. If you use the first spell, then x candies become 2x\xe2\x88\x921 candies.  Assume you have x candies now. If you use the second spell, then x candies become 2x+1 candies. Construct a sequence of spells, such that after using them in order, you will have exactly n candies, or determine it\'s impossible." 800.0                       
                         1809F "Traveling in Berland" "binary search,data structures,graphs,greedy,implementation" "There are n cities in Berland, arranged in a circle and numbered from 1 to n in clockwise order.You want to travel all over Berland, starting in some city, visiting all the other cities and returning to the starting city. Unfortunately, you can only drive along the Berland Ring Highway, which connects all n cities. The road was designed by a very titled and respectable minister, so it is one-directional \xe2\x80\x94 it can only be traversed clockwise, only from the city i to the city (imodn)+1 (i.e. from 1 to 2, from 2 in 3, ..., from n to 1).The fuel tank of your car holds up to k liters of fuel. To drive from the i-th city to the next one, ai liters of fuel are needed (and are consumed in the process).Every city has a fuel station; a liter of fuel in the i-th city costs bi burles. Refueling between cities is not allowed; if fuel has run out between cities, then your journey is considered incomplete.For each city, calculate the minimum cost of the journey if you start and finish it in that city." 2500.0                       
                         1807C "Find and Replace" greedy,implementation,strings "You are given a string s consisting of lowercase Latin characters. In an operation, you can take a character and replace all occurrences of this character with 0 or replace all occurrences of this character with 1.Is it possible to perform some number of moves so that the resulting string is an alternating binary string\xe2\x80\xa0? For example, consider the string abacaba. You can perform the following moves:   Replace a with 0. Now the string is 0b0c0b0.  Replace b with 1. Now the string is 010c010.  Replace c with 1. Now the string is 0101010. This is an alternating binary string. \xe2\x80\xa0An alternating binary string is a string of 0s and 1s such that no two adjacent bits are equal. For example, 01010101, 101, 1 are alternating binary strings, but 0110, 0a0a0, 10100 are not." 800.0                       
                         1806F2 "GCD Master (hard version)" greedy,math,sortings "This is the hard version of the problem. The only difference between the two versions is the constraint on m. You can make hacks only if both versions of the problem are solved.You are given an array a of length n and two integers m and k. Each element in a satisfies 1\xe2\x89\xa4ai\xe2\x89\xa4m.In one operation, you choose two indices i and j such that 1\xe2\x89\xa4i<j\xe2\x89\xa4|a|, then append gcd(ai,aj) to the back of the array and delete ai and aj from the array. Note that the length of the array decreases by one after this operation.Find the maximum possible sum of the array after performing exactly k operations." 2900.0                       
                         1805F2 "Survival of the Weakest (hard version)" "greedy,math,sortings,two pointers" "This is the hard version of the problem. It differs from the easy one only in constraints on n. You can make hacks only if you lock both versions.Let a1,a2,\xe2\x80\xa6,an be an array of non-negative integers. Let F(a1,a2,\xe2\x80\xa6,an) be the sorted in the non-decreasing order array of n\xe2\x88\x921 smallest numbers of the form ai+aj, where 1\xe2\x89\xa4i<j\xe2\x89\xa4n. In other words, F(a1,a2,\xe2\x80\xa6,an) is the sorted in the non-decreasing order array of n\xe2\x88\x921 smallest sums of all possible pairs of elements of the array a1,a2,\xe2\x80\xa6,an. For example, F(1,2,5,7)=[1+2,1+5,2+5]=[3,6,7].You are given an array of non-negative integers a1,a2,\xe2\x80\xa6,an. Determine the single element of the array F(F(F\xe2\x80\xa6F\xe2\x8f\x9fn\xe2\x88\x921(a1,a2,\xe2\x80\xa6,an)\xe2\x80\xa6)). Since the answer can be quite large, output it modulo 109+7." 3100.0                       
                         1805D "A Wide, Wide Graph" "dfs and similar,dp,graphs,greedy,trees" "You are given a tree (a connected graph without cycles) with n vertices. Consider a fixed integer k. Then, the graph Gk is an undirected graph with n vertices, where an edge between vertices u and v exists if and only if the distance between vertices u and v in the given tree is at least k.For each k from 1 to n, print the number of connected components in the graph Gk." 1800.0                       
                         1804A "Lame King" greedy,math "You are given a checkerboard of size 201\xc3\x97201, i. e. it has 201 rows and 201 columns. The rows of this checkerboard are numbered from \xe2\x88\x92100 to 100 from bottom to top. The columns of this checkerboard are numbered from \xe2\x88\x92100 to 100 from left to right. The notation (r,c) denotes the cell located in the r-th row and the c-th column.There is a king piece at position (0,0) and it wants to get to position (a,b) as soon as possible. In this problem our king is lame. Each second, the king makes exactly one of the following five moves.   Skip move. King\'s position remains unchanged.  Go up. If the current position of the king is (r,c) he goes to position (r+1,c).  Go down. Position changes from (r,c) to (r\xe2\x88\x921,c).  Go right. Position changes from (r,c) to (r,c+1).  Go left. Position changes from (r,c) to (r,c\xe2\x88\x921).  King is not allowed to make moves that put him outside of the board. The important consequence of the king being lame is that he is not allowed to make the same move during two consecutive seconds. For example, if the king goes right, the next second he can only skip, go up, down, or left.What is the minimum number of seconds the lame king needs to reach position (a,b)?" 800.0                       
                         1802A Likes greedy,implementation "Nikita recently held a very controversial round, after which his contribution changed very quickly.The announcement hung on the main page for n seconds. In the ith second |ai|th person either liked or removed the like (Nikita was lucky in this task and there are no dislikes). If ai>0, then the aith person put a like. If ai<0, then the person \xe2\x88\x92ai removed the like. Each person put and removed the like no more than once. A person could not remove a like if he had not put it before.Since Nikita\'s contribution became very bad after the round, he wanted to analyze how his contribution changed while the announcement was on the main page. He turned to the creator of the platform with a request to give him the sequence a1,a2,\xe2\x80\xa6,an. But due to the imperfection of the platform, the sequence a was shuffled.You are given a shuffled sequence of a that describes user activity. You need to tell for each moment from 1 to n what the maximum and minimum number of likes could be on the post at that moment." 800.0                       
                         1801E "Gasoline prices" "data structures,divide and conquer,dsu,hashing,trees" "Berland \xe2\x80\x94 is a huge country consisting of n cities. The road network of Berland can be represented as a root tree, that is, there is only n\xe2\x88\x921 road in the country, and you can get from any city to any other exactly one way, if you do not visit any city twice. For the convenience of representing the country, for each city i, the city pi is fixed, equal to the first city to which you need to go from the city i to get to the city 1. In other words, the city pi is equal to the ancestor of the city i if the tree is hung for the city 1.There is one gas station in each city of Berland. Gas stations have special pricing, and for each gas station there is a fixed range of prices for which they are ready to sell gasoline. A gas station in the city with the number i is ready to sell gasoline at any price from li to ri inclusive.The King of Berland \xe2\x80\x94 is an exemplary family man, and for m years, two sons were born to him every year. The king\'s children have been involved in public affairs since early childhood, and at the end of each year they check the honesty of gasoline prices. From birth, the king\'s children, who are born in the year i, are responsible for checking gasoline prices on the ways from the city of ai to the city of bi and from the city of ci to the city of di, respectively.The check is as follows: both children simultaneously start their journey from the cities ai and ci, respectively. The first son of the king, born in the year i, moves along the path from the city ai to the city bi, and the second  \xe2\x80\x94 from the city ci to the city di. Children check that the price of gasoline in the city of ai coincides with the price of gasoline in the city of ci. Next, they check that the price of gasoline in the second city on the way from ai to bi coincides with the price in the second city on the way from ci to di. Then they repeat the same thing for a couple of third cities on their paths and so on. At the end, they check that the price of gasoline in the city of bi coincides with the price of gasoline in the city of di. It is guaranteed that the length of the path from the city ai to the city bi coincides with the length of the path from the city ci to the city di.Gas stations must strictly obey the laws, and therefore all checks of gasoline prices should not reveal violations. Help Berland gas stations find out how many ways they can set gasoline prices for m years. In other words, for each i from 1 to m, calculate how many ways you can set gasoline prices at all gas stations so that after the birth of the first i pairs of the king\'s children, all their checks did not reveal violations, and at any gas station the price was in the acceptable price range. Since the number of such methods can be large, calculate the answer modulo 109+7." 3000.0                       
                         1801A "The Very Beautiful Blanket" "bitmasks,constructive algorithms" "Kirill wants to weave the very beautiful blanket consisting of n\xc3\x97m of the same size square patches of some colors. He matched some non-negative integer to each color. Thus, in our problem, the blanket can be considered a B matrix of size n\xc3\x97m consisting of non-negative integers.Kirill considers that the blanket is very beautiful, if for each submatrix A of size 4\xc3\x974 of the matrix B is true: A11\xe2\x8a\x95A12\xe2\x8a\x95A21\xe2\x8a\x95A22=A33\xe2\x8a\x95A34\xe2\x8a\x95A43\xe2\x8a\x95A44, A13\xe2\x8a\x95A14\xe2\x8a\x95A23\xe2\x8a\x95A24=A31\xe2\x8a\x95A32\xe2\x8a\x95A41\xe2\x8a\x95A42,where \xe2\x8a\x95 means bitwise exclusive ORKirill asks you to help her weave a very beautiful blanket, and as colorful as possible!He gives you two integers n and m. Your task is to generate a matrix B of size n\xc3\x97m, which corresponds to a very beautiful blanket and in which the number of different numbers maximized." 1600.0                       
                         1799H "Tree Cutting" "bitmasks,dfs and similar,dp" "You are given a tree with n vertices.A hero k times do the following operation:  Choose some edge.  Remove it.  Take one of the two remaining parts and delete it.  Write the number of vertices in the remaining part. You are given an initial tree and the a sequence of written numbers. Find the number of ways to make operations such that the written numbers are equal to the given numbers. Due to the answer can be big, find it by modulo 998244353. Two ways are considered different, if on some operation edge or remaining part are selected differently." 3200.0                       
                         1799A "Recent Actions" "data structures,greedy,implementation,math" "On Codeforces the ""Recent Actions"" field shows the last n posts with recent actions.Initially, there are posts 1,2,\xe2\x80\xa6,n in the field (this is in order from top to down). Also there are infinitely many posts not in the field, numbered with integers n+1,n+2,\xe2\x80\xa6.When recent action happens in the post p:  If it is in the ""Recent Actions"" field, it moves from its position to the top position.  Otherwise, it is added to the top position, and the post on the down position is removed from the ""Recent Actions"" field. You know, that the next m recent actions will happen in the posts p1,p2,\xe2\x80\xa6,pm (n+1\xe2\x89\xa4pi\xe2\x89\xa4n+m) in the moments of time 1,2,\xe2\x80\xa6,m. Note, that recent actions only happen with posts with numbers \xe2\x89\xa5n+1.For each post i (1\xe2\x89\xa4i\xe2\x89\xa4n), find the first time it will be removed from the ""Recent Actions"" field or say, that it won\'t be removed." 800.0                       
                         1797D "Li Hua and Tree" "brute force,data structures,dfs and similar,dp,implementation,trees" "Li Hua has a tree of n vertices and n\xe2\x88\x921 edges. The root of the tree is vertex 1. Each vertex i has importance ai. Denote the size of a subtree as the number of vertices in it, and the importance as the sum of the importance of vertices in it. Denote the heavy son of a non-leaf vertex as the son with the largest subtree size. If multiple of them exist, the heavy son is the one with the minimum index.Li Hua wants to perform m operations:  ""1 x"" (1\xe2\x89\xa4x\xe2\x89\xa4n) \xe2\x80\x94 calculate the importance of the subtree whose root is x.  ""2 x"" (2\xe2\x89\xa4x\xe2\x89\xa4n) \xe2\x80\x94 rotate the heavy son of x up. Formally, denote sonx as the heavy son of x, fax as the father of x. He wants to remove the edge between x and fax and connect an edge between sonx and fax. It is guaranteed that x is not root, but not guaranteed that x is not a leaf. If x is a leaf, please ignore the operation. Suppose you were Li Hua, please solve this problem." 1900.0                       
                         1796E "Colored Subgraphs" "dfs and similar,dp,games,greedy,trees" "Monocarp has a tree, consisting of n vertices.He is going to select some vertex r and perform the following operations on each vertex v from 1 to n:   set dv equal to the distance from v to r (the number of edges on the shortest path);  color v some color. A nice coloring satisfies two conditions:   for each pair of vertices of the same color (v,u), there exists a path from v to u that only visits vertices of the same color;  for each pair of vertices of the same color (v,u), dv\xe2\x89\xa0du. Note that Monocarp can choose any amount of different colors he wants to use.For each used color, he then counts the number of vertices of this color. The cost of the tree is the minimum of these numbers.What can be the maximum cost of the tree?" 2500.0                       
                         1796D "Maximum Subarray" "data structures,dp,greedy,two pointers" "You are given an array a1,a2,\xe2\x80\xa6,an, consisting of n integers. You are also given two integers k and x.You have to perform the following operation exactly once: add x to the elements on exactly k distinct positions, and subtract x from all the others.For example, if a=[2,\xe2\x88\x921,2,3], k=1, x=2, and we have picked the first element, then after the operation the array a=[4,\xe2\x88\x923,0,1].Let f(a) be the maximum possible sum of a subarray of a. The subarray of a is a contiguous part of the array a, i.\xe2\x80\x89e. the array ai,ai+1,\xe2\x80\xa6,aj for some 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n. An empty subarray should also be considered, it has sum 0.Let the array a\xe2\x80\xb2 be the array a after applying the aforementioned operation. Apply the operation in such a way that f(a\xe2\x80\xb2) is the maximum possible, and print the maximum possible value of f(a\xe2\x80\xb2)." 2000.0                       
                         1794D "Counting Factorizations" "combinatorics,divide and conquer,dp,math,number theory" "The prime factorization of a positive integer m is the unique way to write it as m=pe11\xe2\x8b\x85pe22\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85pekk, where p1,p2,\xe2\x80\xa6,pk are prime numbers, p1<p2<\xe2\x80\xa6<pk and e1,e2,\xe2\x80\xa6,ek are positive integers. For each positive integer m, f(m) is defined as the multiset of all numbers in its prime factorization, that is f(m)={p1,e1,p2,e2,\xe2\x80\xa6,pk,ek}. For example, f(24)={2,3,3,1}, f(5)={1,5} and f(1)={}.You are given a list consisting of 2n integers a1,a2,\xe2\x80\xa6,a2n. Count how many positive integers m satisfy that f(m)={a1,a2,\xe2\x80\xa6,a2n}. Since this value may be large, print it modulo 998244353." 1900.0                       
                         1789F "Serval and Brain Power" "bitmasks,brute force,dp,greedy,implementation,strings" "Serval loves Brain Power and his brain power problem.Serval defines that a string T is powerful iff T can be obtained by concatenating some string T\xe2\x80\xb2 multiple times. Formally speaking, T is powerful iff there exist a string T\xe2\x80\xb2 and an integer k\xe2\x89\xa52 such that T=T\xe2\x80\xb2+T\xe2\x80\xb2+\xe2\x8b\xaf+T\xe2\x80\xb2\xe2\x8f\x9fk timesFor example, gogogo is powerful because it can be obtained by concatenating go three times, but power is not powerful.Serval has a string S consists of lowercase English letters. He is curious about the longest powerful subsequence of S, and he only needs you to find out the length of it. If all the non-empty subsequences of S is not powerful, the answer is considered to be 0.A string a is a subsequence of a string b if a can be obtained from b by the deletion of several (possibly, zero or all) characters." 2700.0                       
                         1789E "Serval and Music Game" "brute force,dp,implementation,math,number theory" "Serval loves playing music games. He meets a problem when playing music games, and he leaves it for you to solve.You are given n positive integers s1<s2<\xe2\x80\xa6<sn. f(x) is defined as the number of i (1\xe2\x89\xa4i\xe2\x89\xa4n) that exist non-negative integers pi,qi such that: si=pi\xe2\x8c\x8asnx\xe2\x8c\x8b+qi\xe2\x8c\x88snx\xe2\x8c\x89Find out \xe2\x88\x91snx=1x\xe2\x8b\x85f(x) modulo 998244353.As a reminder, \xe2\x8c\x8ax\xe2\x8c\x8b denotes the maximal integer that is no greater than x, and \xe2\x8c\x88x\xe2\x8c\x89 denotes the minimal integer that is no less than x." 2500.0                       
                         1787F "Inverse Transformation" "constructive algorithms,implementation,math" "A permutation scientist is studying a self-transforming permutation a consisting of n elements a1,a2,\xe2\x80\xa6,an.A permutation is a sequence of integers from 1 to n of length n containing each number exactly once. For example, [1], [4,3,5,1,2] are permutations, while [1,1], [4,3,1] are not.The permutation transforms day by day. On each day, each element x becomes ax, that is, ax becomes aax. Specifically:   on the first day, the permutation becomes b, where bx=aax;  on the second day, the permutation becomes c, where cx=bbx;  \xe2\x80\xa6  For example, consider permutation a=[2,3,1]. On the first day, it becomes [3,1,2]. On the second day, it becomes [2,3,1].You\'re given the permutation a\xe2\x80\xb2 on the k-th day.Define \xcf\x83(x)=ax, and define f(x) as the minimal positive integer m such that \xcf\x83m(x)=x, where \xcf\x83m(x) denotes \xcf\x83(\xcf\x83(\xe2\x80\xa6\xcf\x83\xe2\x8f\x9fm times(x)\xe2\x80\xa6)).For example, if a=[2,3,1], then \xcf\x83(1)=2, \xcf\x832(1)=\xcf\x83(\xcf\x83(1))=\xcf\x83(2)=3, \xcf\x833(1)=\xcf\x83(\xcf\x83(\xcf\x83(1)))=\xcf\x83(3)=1, so f(1)=3. And if a=[4,2,1,3], \xcf\x83(2)=2 so f(2)=1; \xcf\x83(3)=1, \xcf\x832(3)=4, \xcf\x833(3)=3 so f(3)=3.Find the initial permutation a such that n\xe2\x88\x91i=11f(i) is minimum possible." 2500.0                       
                         1787C "Remove the Bracket" dp,greedy,math "RSJ has a sequence a of n integers a1,a2,\xe2\x80\xa6,an and an integer s. For each of a2,a3,\xe2\x80\xa6,an\xe2\x88\x921, he chose a pair of non-negative integers xi and yi such that xi+yi=ai and (xi\xe2\x88\x92s)\xe2\x8b\x85(yi\xe2\x88\x92s)\xe2\x89\xa50.Now he is interested in the value F=a1\xe2\x8b\x85x2+y2\xe2\x8b\x85x3+y3\xe2\x8b\x85x4+\xe2\x80\xa6+yn\xe2\x88\x922\xe2\x8b\x85xn\xe2\x88\x921+yn\xe2\x88\x921\xe2\x8b\x85an.Please help him find the minimum possible value F he can get by choosing xi and yi optimally. It can be shown that there is always at least one valid way to choose them." 1600.0                       
                         1787B "Number Factorization" "greedy,math,number theory" "Given an integer n.Consider all pairs of integer arrays a and p of the same length such that n=\xe2\x88\x8fapii (i.e. ap11\xe2\x8b\x85ap22\xe2\x8b\x85\xe2\x80\xa6) (ai>1;pi>0) and ai is the product of some (possibly one) distinct prime numbers.For example, for n=28=22\xe2\x8b\x8571=41\xe2\x8b\x8571 the array pair a=[2,7], p=[2,1] is correct, but the pair of arrays a=[4,7], p=[1,1] is not, because 4=22 is a product of non-distinct prime numbers.Your task is to find the maximum value of \xe2\x88\x91ai\xe2\x8b\x85pi (i.e. a1\xe2\x8b\x85p1+a2\xe2\x8b\x85p2+\xe2\x80\xa6) over all possible pairs of arrays a and p. Note that you do not need to minimize or maximize the length of the arrays." 1100.0                       
                         1783E "Game of the Year" "brute force,data structures,math,number theory" "Monocarp and Polycarp are playing a computer game. This game features n bosses for the playing to kill, numbered from 1 to n.They will fight each boss the following way:   Monocarp makes k attempts to kill the boss;  Polycarp makes k attempts to kill the boss;  Monocarp makes k attempts to kill the boss;  Polycarp makes k attempts to kill the boss;  ... Monocarp kills the i-th boss on his ai-th attempt. Polycarp kills the i-th boss on his bi-th attempt. After one of them kills the i-th boss, they move on to the (i+1)-st boss. The attempt counters reset for both of them. Once one of them kills the n-th boss, the game ends.Find all values of k from 1 to n such that Monocarp kills all bosses." 2300.0                       
                         1783D "Different Arrays" "brute force,dp,implementation" "You are given an array a consisting of n integers.You have to perform the sequence of n\xe2\x88\x922 operations on this array:  during the first operation, you either add a2 to a1 and subtract a2 from a3, or add a2 to a3 and subtract a2 from a1;  during the second operation, you either add a3 to a2 and subtract a3 from a4, or add a3 to a4 and subtract a3 from a2;  ...  during the last operation, you either add an\xe2\x88\x921 to an\xe2\x88\x922 and subtract an\xe2\x88\x921 from an, or add an\xe2\x88\x921 to an and subtract an\xe2\x88\x921 from an\xe2\x88\x922. So, during the i-th operation, you add the value of ai+1 to one of its neighbors, and subtract it from the other neighbor.For example, if you have the array [1,2,3,4,5], one of the possible sequences of operations is:  subtract 2 from a3 and add it to a1, so the array becomes [3,2,1,4,5];  subtract 1 from a2 and add it to a4, so the array becomes [3,1,1,5,5];  subtract 5 from a3 and add it to a5, so the array becomes [3,1,\xe2\x88\x924,5,10]. So, the resulting array is [3,1,\xe2\x88\x924,5,10].An array is reachable if it can be obtained by performing the aforementioned sequence of operations on a. You have to calculate the number of reachable arrays, and print it modulo 998244353." 2000.0                       
                         1779F "Xorcerer\'s Stones" "bitmasks,constructive algorithms,dp,trees" "Misha had been banned from playing chess for good since he was accused of cheating with an engine. Therefore, he retired and decided to become a xorcerer.One day, while taking a walk in a park, Misha came across a rooted tree with nodes numbered from 11 to nn. The root of the tree is node 11. For each 1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n, node ii contains aiai stones in it. Misha has recently learned a new spell in his xorcery class and wants to test it out. A spell consists of:  Choose some node ii (1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n).  Calculate the bitwise XOR xx of all ajaj such that node jj is in the subtree of ii (ii belongs to its own subtree).  Set ajaj equal to xx for all nodes jj in the subtree of ii. Misha can perform at most 2n2n spells and he wants to remove all stones from the tree. More formally, he wants ai=0ai=0 to hold for each 1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n. Can you help him perform the spells?A tree with nn nodes is a connected acyclic graph which contains n\xe2\x88\x921n\xe2\x88\x921 edges. The subtree of node ii is the set of all nodes jj such that ii lies on the simple path from 11 (the root) to jj. We consider ii to be contained in its own subtree." 2500.0                       
                         1779D "Boris and His Amazing Haircut" "constructive algorithms,data structures,dp,dsu,greedy,sortings" "Boris thinks that chess is a tedious game. So he left his tournament early and went to a barber shop as his hair was a bit messy.His current hair can be described by an array a1,a2,\xe2\x80\xa6,an, where ai is the height of the hair standing at position i. His desired haircut can be described by an array b1,b2,\xe2\x80\xa6,bn in a similar fashion.The barber has m razors. Each has its own size and can be used at most once. In one operation, he chooses a razor and cuts a segment of Boris\'s hair. More formally, an operation is:  Choose any razor which hasn\'t been used before, let its size be x;  Choose a segment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n);  Set ai:=min(ai,x) for each l\xe2\x89\xa4i\xe2\x89\xa4r; Notice that some razors might have equal sizes \xe2\x80\x94 the barber can choose some size x only as many times as the number of razors with size x. He may perform as many operations as he wants, as long as any razor is used at most once and ai=bi for each 1\xe2\x89\xa4i\xe2\x89\xa4n at the end. He does not have to use all razors.Can you determine whether the barber can give Boris his desired haircut?" 1700.0                       
                         1777B Emordnilap combinatorics,greedy,math "A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array). There are n!=n\xe2\x8b\x85(n\xe2\x88\x921)\xe2\x8b\x85(n\xe2\x88\x922)\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x851 different permutations of length n.Given a permutation p of n numbers, we create an array a consisting of 2n numbers, which is equal to p concatenated with its reverse. We then define the beauty of p as the number of inversions in a.The number of inversions in the array a is the number of pairs of indices i, j such that i<j and ai>aj.For example, for permutation p=[1,2], a would be [1,2,2,1]. The inversions in a are (2,4) and (3,4) (assuming 1-based indexing). Hence, the beauty of p is 2.Your task is to find the sum of beauties of all n! permutations of size n. Print the remainder we get when dividing this value by 1000000007 (109+7)." 900.0                       
                         1776J "Italian Data Centers" "graphs,shortest paths" "An Italian data center consists of a set of servers, each colored green, white, or red, and a set of wires connecting them. Each wire connects two distinct servers and two servers are connected by at most one wire. Additionally, the data center is connected, i.e. there is a way to transmit information between any two servers through a sequence of wires.To judge all of the contestant submissions, SWERC has an Italian data center. Since every year the number of contestants doubles, the data center needs to grow to adapt to the extra load. To address this, SWERC builds a new data center based on the previous year\'s one by following these steps:  For each server s in the old data center, the new data center contains two servers s1 and s2 of the same color as s. A wire is placed connecting the two servers s1 and s2.  For each wire connecting servers s and t in the old data center: if s and t have the same color, then a wire is placed in the new data center connecting s1 and t1 and another wire connecting s2 and t2; otherwise, a wire is placed in the new data center connecting s1 and t2 and another one connecting s2 and t1. One can show that if the old data center is connected than the new data center is also connected.You are given the Italian data center that SWERC currently has, which contains n servers (indexed by 1,2,\xe2\x80\xa6,n) and m wires connecting them. The organization wants to know how good their data center will be after k years, so you should determine the diameter of the data center SWERC will have in k years. The diameter of the data center is the largest distance between any two servers, i.e. the shortest number of wires that have to be used to transmit something between the two servers." 2500.0                       
                         1775F "Laboratory on Pluto" "constructive algorithms,dp,greedy,math" "As you know, Martian scientists are actively engaged in space research. One of the highest priorities is Pluto. In order to study this planet in more detail, it was decided to build a laboratory on Pluto.It is known that the lab will be built of n square blocks of equal size. For convenience, we will assume that Pluto\'s surface is a plane divided by vertical and horizontal lines into unit squares. Each square is either occupied by a lab block or not, and only n squares are occupied.Since each block is square, it has four walls. If a wall is adjacent to another block, it is considered inside, otherwise \xe2\x80\x94 outside.Pluto is famous for its extremely cold temperatures, so the outside walls of the lab must be insulated. One unit of insulation per exterior wall would be required. Thus, the greater the total length of the outside walls of the lab (i. e., its perimeter), the more insulation will be needed.Consider the lab layout in the figure below. It shows that the lab consists of n=33 blocks, and all the blocks have a total of 24 outside walls, i. e. 24 units of insulation will be needed.You should build the lab optimally, i. e., minimize the amount of insulation. On the other hand, there may be many optimal options, so scientists may be interested in the number of ways to build the lab using the minimum amount of insulation, modulo a prime number m.Two ways are considered the same if they are the same when overlapping without turning. Thus, if a lab plan is rotated by 90\xe2\x88\x98, such a new plan can be considered a separate way.To help scientists explore Pluto, you need to write a program that solves these difficult problems." 2500.0                       
                         1774D "Same Count One" "brute force,constructive algorithms,greedy,implementation,two pointers" "ChthollyNotaSeniorious received a special gift from AquaMoon: n binary arrays of length m. AquaMoon tells him that in one operation, he can choose any two arrays and any position pos from 1 to m, and swap the elements at positions pos in these arrays.He is fascinated with this game, and he wants to find the minimum number of operations needed to make the numbers of 1s in all arrays the same. He has invited you to participate in this interesting game, so please try to find it!If it is possible, please output specific exchange steps in the format described in the output section. Otherwise, please output \xe2\x88\x921." 1600.0                       
                         1773B BinCoin "binary search,divide and conquer,hashing,implementation,probabilities,trees" "There are n employees in the BinCoin company numbered from 1 to n. The subordination structure in this company is a rooted tree. In other words:   There is one CEO in the company \xe2\x80\x94 the main boss.  Each other employee has exactly one direct superior.  There are no cycles in the subordination structure. Moreover, due to the inexplicable love of the CEO of BinCoin for all the binary stuff, the subordination structure in the company is a binary rooted tree. That means each employee is directly superior to exactly zero or two other employees.In the CEO\'s opinion, working in this company is almost as dangerous as in mines. So, employees should sign the waiver of claims sometimes. This process happens in the following way. Initially, CEO takes the journal, then recursively the following procedure is performed:  If an employee that holds the journal does not have any subordinates, they sign the waiver in the journal and give it back to their superior. The procedure stops if that was the CEO, who has no superior.  Otherwise   they choose one of two of their direct subordinates uniformly at random and give the journal to one of them;  when they get the journal back, they sign it;  and then they give it to another direct subordinate;  when they get it back again, they give it back to their superior. The procedure stops if that was the CEO, who has no superior.  All random choices are independent.One day, the CEO realized that they could not remember the subordination tree. Fortunately, they have the journal with k records. Each record is a sequence of employees in the order they\'ve signed in a journal.Help CEO restore the subordination tree." 2200.0                       
                         1772E "Permutation Game" games "Two players are playing a game. They have a permutation of integers 1, 2, ..., n (a permutation is an array where each element from 1 to n occurs exactly once). The permutation is not sorted in either ascending or descending order (i.\xe2\x80\x89e. the permutation does not have the form [1,2,\xe2\x80\xa6,n] or [n,n\xe2\x88\x921,\xe2\x80\xa6,1]).Initially, all elements of the permutation are colored red. The players take turns. On their turn, the player can do one of three actions:  rearrange the elements of the permutation in such a way that all red elements keep their positions (note that blue elements can be swapped with each other, but it\'s not obligatory);  change the color of one red element to blue;  skip the turn. The first player wins if the permutation is sorted in ascending order (i.\xe2\x80\x89e. it becomes [1,2,\xe2\x80\xa6,n]). The second player wins if the permutation is sorted in descending order (i.\xe2\x80\x89e. it becomes [n,n\xe2\x88\x921,\xe2\x80\xa6,1]). If the game lasts for 100500 turns and nobody wins, it ends in a draw.Your task is to determine the result of the game if both players play optimally." 1700.0                       
                         1771B "Hossam and Friends" "binary search,constructive algorithms,dp,two pointers" "Hossam makes a big party, and he will invite his friends to the party.He has n friends numbered from 1 to n. They will be arranged in a queue as follows: 1,2,3,\xe2\x80\xa6,n.Hossam has a list of m pairs of his friends that don\'t know each other. Any pair not present in this list are friends.A subsegment of the queue starting from the friend a and ending at the friend b is [a,a+1,a+2,\xe2\x80\xa6,b]. A subsegment of the queue is called good when all pairs of that segment are friends.Hossam wants to know how many pairs (a,b) there are (1\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa4n), such that the subsegment starting from the friend a and ending at the friend b is good." 1400.0                       
                         1770G "Koxia and Bracket" "divide and conquer,fft,math" "Chiyuu has a bracket sequence\xe2\x80\xa0 s of length n. Let k be the minimum number of characters that Chiyuu has to remove from s to make s balanced\xe2\x80\xa1.Now, Koxia wants you to count the number of ways to remove k characters from s so that s becomes balanced, modulo 998244353.Note that two ways of removing characters are considered distinct if and only if the set of indices removed is different.\xe2\x80\xa0 A bracket sequence is a string containing only the characters ""("" and "")"".\xe2\x80\xa1 A bracket sequence is called balanced if one can turn it into a valid math expression by adding characters + and 1. For example, sequences (())(), (), (()(())) and the empty string are balanced, while )(, ((), and (()))( are not." 3400.0                       
                         1769D3 "\xd0\x98\xd0\xb3\xd1\x80\xd0\xb0 \xd0\xb2 \xd0\x94\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 III" "*special problem,brute force" "\xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8 \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 26 \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xbe\xd0\xb2 \xd1\x81 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xbc\xd0\xb8 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f\xd0\xbc\xd0\xb8 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0.\xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd0\x91\xd0\xbe\xd0\xb1 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb\xd0\xb8 \xd1\x81\xd1\x8b\xd0\xb3\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x83\xd1\x8e \xd0\xb8\xd0\xb3\xd1\x80\xd1\x83 \xc2\xab\xd0\x94\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0\xc2\xbb. \xd0\x9f\xd0\xbe\xd0\xb6\xd0\xb0\xd0\xbb\xd1\x83\xd0\xb9\xd1\x81\xd1\x82\xd0\xb0, \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd1\x83 \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbe\xd1\x82\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2\xd0\xb0\xd0\xbc.\xd0\x94\xd0\xbb\xd1\x8f \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb4\xd0\xb0\xd1\x80\xd1\x82\xd0\xbd\xd0\xb0\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb8\xd0\xb7 36 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xe2\x80\x94 \xd0\xbf\xd0\xbe \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 (\xd0\xbe\xd1\x82 \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xbe \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0) \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd1\x91\xd1\x85 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb5\xd0\xb9 (\xd1\x82\xd1\x80\xd0\xb5\xd1\x84\xd1\x8b, \xd0\xb1\xd1\x83\xd0\xb1\xd0\xbd\xd1\x8b, \xd0\xbf\xd0\xb8\xd0\xba\xd0\xb8 \xd0\xb8 \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb8). \xd0\x9a\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xbf\xd0\xbe \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd1\x83 \xd0\xbe\xd1\x82 \xd0\xbc\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x88\xd0\xb5\xd0\xb9 \xd0\xba \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x88\xd0\xb5\xd0\xb9 \xd0\xb8\xd0\xb4\xd1\x83\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc: \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0, \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0, \xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb5\xd1\x82, \xd0\xb4\xd0\xb0\xd0\xbc\xd0\xb0, \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c, \xd1\x82\xd1\x83\xd0\xb7.\xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x88\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd0\xb8 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb4\xd0\xb0\xd1\x91\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe 18 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82. \xd0\x9a\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbf\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd1\x91\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0\xd0\xbc. \xd0\x92\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb9 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8.\xd0\x98\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb8 \xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x82 \xd0\xbf\xd0\xbe \xd0\xbe\xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb8. \xd0\xa5\xd0\xbe\xd0\xb4 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xbe\xd0\xb2:   \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8;  \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd1\x83, \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd1\x83 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd1\x83 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb8\xd1\x86\xd1\x83 \xd0\xb2\xd1\x8b\xd1\x88\xd0\xb5;  \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd1\x83, \xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb5\xd1\x82\xd0\xb0, \xd0\xb4\xd0\xb0\xd0\xbc\xd1\x83, \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd0\xb8\xd0\xbb\xd0\xb8 \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb8\xd1\x86\xd1\x83 \xd0\xbd\xd0\xb8\xd0\xb6\xd0\xb5. \xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 \xd0\xbf\xd0\xb8\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb2 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd1\x84 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd1\x84, \xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0 \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd0\xb9 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd0\xb9.\xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbd\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8, \xd1\x82\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd0\xba \xd1\x81\xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xbd\xd0\xb8\xd0\xba\xd1\x83. \xd0\x9e\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5: \xd0\xbd\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x8f \xd0\xbf\xd1\x80\xd0\xbe\xd0\xbf\xd1\x83\xd1\x81\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe \xd1\x82\xd0\xb0\xd0\xba \xe2\x80\x94 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xba\xd0\xbe\xd1\x80\xd1\x80\xd0\xb5\xd0\xba\xd1\x82\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe.\xd0\x9f\xd0\xbe\xd0\xbc\xd0\xb8\xd0\xbc\xd0\xbe \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba \xd1\x81\xd1\x82\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb8\xd0\xb7\xd0\xb1\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb2 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5, \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd0\x91\xd0\xbe\xd0\xb1 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f\xd1\x82, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x86\xd0\xb5 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xd1\x83 \xd0\xb8\xd1\x85 \xd1\x81\xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c \xd0\xba\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5, \xd0\xb0 \xd0\xb2 \xd0\xb8\xd1\x85 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xe2\x80\x94 \xd0\xba\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb5. \xd0\x9d\xd0\xb0\xd0\xbf\xd0\xbe\xd0\xbc\xd0\xbd\xd0\xb8\xd0\xbc, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xba\xd0\xb0\xd0\xbd\xd1\x87\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd0\xba\xd0\xb0\xd0\xba \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xb8\xd0\xb7 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbd\xd1\x8e\xd1\x8e \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8.\xd0\xa0\xd0\xb5\xd0\xb7\xd1\x83\xd0\xbb\xd1\x8c\xd1\x82\xd0\xb0\xd1\x82\xd0\xbe\xd0\xbc \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xbd\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xb2\xd1\x91\xd0\xbc \xd1\x81\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xba\xd1\x83\xd0\xbf\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7 \xd0\xb8\xd0\xbd\xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8 \xd0\xbe \xd1\x82\xd0\xbe\xd0\xbc, \xd0\xba\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xbe\xd0\xbf\xd1\x82\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb5, \xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xbe \xd1\x82\xd0\xbe\xd0\xbc, \xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xd1\x83 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb2\xd1\x88\xd0\xb5\xd0\xb3\xd0\xbe.\xd0\x9f\xd1\x83\xd1\x81\xd1\x82\xd1\x8c \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd0\x91\xd0\xbe\xd0\xb1 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xb2\xd0\xb7\xd1\x8f\xd0\xbb\xd0\xb8 \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb8 18 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9, \xd0\xbd\xd0\xbe \xd0\xb5\xd1\x89\xd1\x91 \xd0\xbd\xd0\xb5 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb\xd0\xb8, \xd0\xba\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc. \xd0\x92\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xb2\xd1\x91\xd0\xbc \xd0\xb0\xd0\xb1\xd1\x81\xd0\xbe\xd0\xbb\xd1\x8e\xd1\x82\xd0\xbd\xd1\x83\xd1\x8e \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd1\x80\xd0\xb5\xd0\xb7\xd1\x83\xd0\xbb\xd1\x8c\xd1\x82\xd0\xb0\xd1\x82\xd0\xb0\xd0\xbc\xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xb2 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0, \xd0\xb8 \xd0\xb2 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\x91\xd0\xbe\xd0\xb1.\xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb2 \xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb8\xd1\x85 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd1\x8f\xd1\x85 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\x91\xd0\xbe\xd0\xb1, \xd0\xbd\xd0\xbe \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5 \xd1\x83 \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd1\x8b \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f 6 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x86\xd0\xb5 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b, \xd0\xb0 \xd0\xb2\xd0\xbe \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc \xe2\x80\x94 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe 2, \xd1\x82\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd1\x80\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xb0 4. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb6\xd0\xb5 \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd1\x83 \xd0\x91\xd0\xbe\xd0\xb1\xd0\xb0 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f 5 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5, \xd0\xb0 \xd0\xb2\xd0\xbe \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\x91\xd0\xbe\xd0\xb1 \xd0\xb8 \xd1\x83 \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd1\x8b \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f 3 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5, \xd1\x82\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd1\x80\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xb0 8.\xd0\xa0\xd0\xb5\xd0\xb1\xd1\x8f\xd1\x82\xd0\xb0 \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f\xd1\x82 \xd1\x83\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x82\xd1\x8c, \xd0\xbd\xd0\xb0\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb1\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xbe\xd0\xb2. \xd0\x9f\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xbc\xd1\x83 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd1\x83 k\xe2\x89\xa426 \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb8\xd0\xbc \xd0\xbd\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5 k \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xbe\xd0\xb2, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd1\x8b \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 \xd0\xbd\xd0\xb8\xd1\x85 \xe2\x80\x94 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0." 2300.0                       
                         1769C2 "\xd0\x9f\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xba\xd0\xb0 II" "*special problem,dp" "\xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8 n\xe2\x89\xa42\xe2\x8b\x85105 \xd0\xb8 ai\xe2\x89\xa4106 (\xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x83 n \xd0\xbf\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x80\xd0\xb0\xd0\xbc \xd0\xb2\xd1\x85\xd0\xbe\xd0\xb4\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2\xd0\xbd\xd1\x83\xd1\x82\xd1\x80\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0).\xd0\x92\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xb7\xd0\xb0 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x8b \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8 VK \xd1\x83\xd0\xb6\xd0\xb5 \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd0\xbb\xd0\xb0 n \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb2 \xd0\xb2 \xd1\x81\xd0\xb8\xd1\x81\xd1\x82\xd0\xb5\xd0\xbc\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb9. i-\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82 \xd0\xb1\xd1\x8b\xd0\xbb \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd0\xbd \xd0\xb2 ai-\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x8b \xd0\x92\xd0\xb8\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8. \xd0\x92 \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xbd\xd0\xb8 \xd0\x92\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb3\xd0\xbb\xd0\xb0 \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb2, \xd0\xb0 \xd0\xb2 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb8\xd0\xb5 \xe2\x80\x94 \xd0\xbd\xd0\xb5 \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe.\xd0\x92\xd0\xb8\xd0\xba\xd1\x83 \xd0\xb8\xd0\xbd\xd1\x82\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x83\xd1\x8e\xd1\x82 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5 \xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb7\xd0\xba\xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x80\xd1\x8f\xd0\xb4 \xd0\xb8\xd0\xb4\xd1\x83\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9 \xd1\x83 \xd0\xbd\xd0\xb5\xd1\x91 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82. \xd0\xa7\xd0\xb5\xd0\xbc \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd0\xbd\xd0\xb5\xd0\xb5 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x81\xd0\xb0\xd0\xbc\xd1\x8b\xd0\xb9 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd1\x82\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb7\xd0\xbe\xd0\xba, \xd1\x82\xd0\xb5\xd0\xbc \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb4\xd1\x83\xd0\xba\xd1\x82\xd0\xb8\xd0\xb2\xd0\xbd\xd1\x8b\xd0\xbc \xd1\x81\xd0\xbe\xd1\x82\xd1\x80\xd1\x83\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbe\xd0\xbd\xd0\xb0 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x81\xd0\xb5\xd0\xb1\xd1\x8f \xd0\xbe\xd1\x89\xd1\x83\xd1\x89\xd0\xb0\xd1\x82\xd1\x8c.\xd0\x9d\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xbe \xd0\x92\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xbd\xd0\xb0\xd1\x88\xd0\xbb\xd0\xb0 \xd1\x81\xd0\xbf\xd0\xbe\xd1\x81\xd0\xbe\xd0\xb1 \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xb2\xd0\xbf\xd0\xb5\xd1\x80\xd1\x91\xd0\xb4, \xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb5 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd1\x87\xd0\xb5\xd0\xbc \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x83\xd1\x82\xd0\xba\xd0\xb8. \xd0\xa2\xd0\xb0\xd0\xba\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, i-\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82 \xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd1\x80\xd1\x8c \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xc2\xab\xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd0\xbd\xc2\xbb \xd0\xbb\xd0\xb8\xd0\xb1\xd0\xbe \xd0\xb2 ai-\xd0\xb9, \xd0\xbb\xd0\xb8\xd0\xb1\xd0\xbe \xd0\xb2 (ai+1)-\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c. \xd0\x92\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5\xd0\xb7\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x81\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbe\xd1\x82 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb8\xd1\x85 \xe2\x80\x94 \xd0\xb2 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8, \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xba\xd0\xb0\xd0\xba \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb2\xd1\x81\xd0\xb5\xd0\xbc \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0\xd0\xbc \xd0\xb8\xd1\x81\xd1\x85\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f, \xd1\x82\xd0\xb0\xd0\xba \xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd1\x8b \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c \xd0\xb2\xd0\xbf\xd0\xb5\xd1\x80\xd1\x91\xd0\xb4.\xd0\x9d\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd1\x83 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb7\xd0\xba\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x80\xd1\x8f\xd0\xb4 \xd0\xb8\xd0\xb4\xd1\x83\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9, \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd1\x83 \xd0\x92\xd0\xb8\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x84\xd0\xb8\xd0\xbb\xd0\xb5 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xbe\xd1\x82\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xba\xd0\xb8 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8 \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb2." 1300.0                       
                         1767E "Algebra Flash" "bitmasks,brute force,dp,graphs,math,meet-in-the-middle,trees" "Algebra Flash 2.2 has just been released!Changelog:  New gamemode! Thank you for the continued support of the game! Huh, is that it? Slightly disappointed, you boot up the game and click on the new gamemode. It says ""Colored platforms"".There are n platforms, numbered from 1 to n, placed one after another. There are m colors available in the game, numbered from 1 to m. The i-th platform is colored ci.You start on the platform 1 and want to reach platform n. In one move, you can jump from some platform i to platforms i+1 or i+2.All platforms are initially deactivated (including platforms 1 and n). For each color j, you can pay xj coins to activate all platforms of that color.You want to activate some platforms so that you could start on an activated platform 1, jump through some activated platforms and reach an activated platform n.What\'s the smallest amount of coins you can spend to achieve that?" 2500.0                       
                         1761A "Two Permutations" "brute force,constructive algorithms" "You are given three integers n, a, and b. Determine if there exist two permutations p and q of length n, for which the following conditions hold:  The length of the longest common prefix of p and q is a.  The length of the longest common suffix of p and q is b. A permutation of length n is an array containing each integer from 1 to n exactly once. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 800.0                       
                         1760D "Challenging Valleys" "implementation,two pointers" "You are given an array a[0\xe2\x80\xa6n\xe2\x88\x921] of n integers. This array is called a ""valley"" if there exists exactly one subarray a[l\xe2\x80\xa6r] such that:  0\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n\xe2\x88\x921,  al=al+1=al+2=\xe2\x8b\xaf=ar,  l=0 or al\xe2\x88\x921>al,  r=n\xe2\x88\x921 or ar<ar+1. Here are three examples:  The first image shows the array [3,2,2,1,2,2,3], it is a valley because only subarray with indices l=r=3 satisfies the condition.The second image shows the array [1,1,1,2,3,3,4,5,6,6,6], it is a valley because only subarray with indices l=0,r=2 satisfies the codition.The third image shows the array [1,2,3,4,3,2,1], it is not a valley because two subarrays l=r=0 and l=r=6 that satisfy the condition.You are asked whether the given array is a valley or not.Note that we consider the array to be indexed from 0." 1000.0                       
                         1759C Thermostat "greedy,math,shortest paths" "Vlad came home and found out that someone had reconfigured the old thermostat to the temperature of a.The thermostat can only be set to a temperature from l to r inclusive, the temperature cannot change by less than x. Formally, in one operation you can reconfigure the thermostat from temperature a to temperature b if |a\xe2\x88\x92b|\xe2\x89\xa5x and l\xe2\x89\xa4b\xe2\x89\xa4r.You are given l, r, x, a and b. Find the minimum number of operations required to get temperature b from temperature a, or say that it is impossible." 1100.0                       
                         1758F "Decent Division" "constructive algorithms,data structures" "A binary string is a string where every character is 0 or 1. Call a binary string decent if it has an equal number of 0s and 1s.Initially, you have an infinite binary string t whose characters are all 0s. You are given a sequence a of n updates, where ai indicates that the character at index ai will be flipped (0\xe2\x86\x941). You need to keep and modify after each update a set S of disjoint ranges such that:   for each range [l,r], the substring tl\xe2\x80\xa6tr is a decent binary string, and  for all indices i such that ti=1, there exists [l,r] in S such that l\xe2\x89\xa4i\xe2\x89\xa4r. You only need to output the ranges that are added to or removed from S after each update. You can only add or remove ranges from S at most 106 times.More formally, let Si be the set of ranges after the i-th update, where S0=\xe2\x88\x85 (the empty set). Define Xi to be the set of ranges removed after update i, and Yi to be the set of ranges added after update i. Then for 1\xe2\x89\xa4i\xe2\x89\xa4n, Si=(Si\xe2\x88\x921\xe2\x88\x96Xi)\xe2\x88\xaaYi. The following should hold for all 1\xe2\x89\xa4i\xe2\x89\xa4n:   \xe2\x88\x80a,b\xe2\x88\x88Si,(a\xe2\x89\xa0b)\xe2\x86\x92(a\xe2\x88\xa9b=\xe2\x88\x85);  Xi\xe2\x8a\x86Si\xe2\x88\x921;  (Si\xe2\x88\x921\xe2\x88\x96Xi)\xe2\x88\xa9Yi=\xe2\x88\x85;  n\xe2\x88\x91i=1(|Xi|+|Yi|)\xe2\x89\xa4106." 3000.0                       
                         1758C "Almost All Multiples" "greedy,number theory" "Given two integers n and x, a permutation\xe2\x80\xa0 p of length n is called funny if pi is a multiple of i for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, pn=1, and p1=x.Find the lexicographically minimal\xe2\x80\xa1 funny permutation, or report that no such permutation exists.\xe2\x80\xa0 A permutation of length n is an array consisting of each of the integers from 1 to n exactly once.\xe2\x80\xa1 Let a and b be permutations of length n. Then a is lexicographically smaller than b if in the first position i where a and b differ, ai<bi. A permutation is lexicographically minimal if it is lexicographically smaller than all other permutations." 1400.0                       
                         1750H BinaryStringForces "constructive algorithms,data structures,dp" "You are given a binary string s of length n. We define a maximal substring as a substring that cannot be extended while keeping all elements equal. For example, in the string 11000111 there are three maximal substrings: 11, 000 and 111.In one operation, you can select two maximal adjacent substrings. Since they are maximal and adjacent, it\'s easy to see their elements must have different values. Let a be the length of the sequence of ones and b be the length of the sequence of zeros. Then do the following: If a\xe2\x89\xa5b, then replace b selected zeros with b ones.  If a<b, then replace a selected ones with a zeros.As an example, for 1110000 we make it 0000000, for 0011 we make it 1111. We call a string being good if it can be turned into 1111...1111 using the aforementioned operation any number of times (possibly, zero). Find the number of good substrings among all n(n+1)2 non-empty substrings of s." 3500.0                       
                         1750F Majority combinatorics,dp,math,strings "Everyone was happy coding, until suddenly a power shortage happened and the best competitive programming site went down. Fortunately, a system administrator bought some new equipment recently, including some UPSs. Thus there are some servers that are still online, but we need all of them to be working in order to keep the round rated.Imagine the servers being a binary string s of length n. If the i-th server is online, then si=1, and si=0 otherwise.A system administrator can do the following operation called electricity spread, that consists of the following phases:   Select two servers at positions 1\xe2\x89\xa4i<j\xe2\x89\xa4n such that both are online (i.e. si=sj=1). The spread starts only from online servers.  Check if we have enough power to make the spread. We consider having enough power if the number of turned on servers in range [i,j] is at least the number of turned off servers in range [i,j]. More formally, check whether 2\xe2\x8b\x85(si+si+1+\xe2\x80\xa6+sj)\xe2\x89\xa5j\xe2\x88\x92i+1. If the check is positive, turn on all the offline servers in range [i,j]. More formally, make sk:=1 for all k from i to j. We call a binary string s of length n rated if we can turn on all servers (i.e. make si=1 for 1\xe2\x89\xa4i\xe2\x89\xa4n) using the electricity spread operation any number of times (possibly, 0). Your task is to find the number of rated strings of length n modulo m." 2700.0                       
                         1747A "Two Groups" "constructive algorithms,greedy" "You are given an array a consisting of n integers. You want to distribute these n integers into two groups s1 and s2 (groups can be empty) so that the following conditions are satisfied:  For each i (1\xe2\x89\xa4i\xe2\x89\xa4n), ai goes into exactly one group. The value |sum(s1)|\xe2\x88\x92|sum(s2)| is the maximum possible among all such ways to distribute the integers.Here sum(s1) denotes the sum of the numbers in the group s1, and sum(s2) denotes the sum of the numbers in the group s2.Determine the maximum possible value of |sum(s1)|\xe2\x88\x92|sum(s2)|." 800.0                       
                         1746F Kazaee "data structures,hashing,probabilities" "You have an array a consisting of n positive integers and you have to handle q queries of the following types:  1 i x: change ai to x,  2 l r k: check if the number of occurrences of every positive integer in the subarray al,al+1,\xe2\x80\xa6ar is a multiple of k (check the example for better understanding)." 2800.0                       
                         1746E1 "Joking (Easy Version)" "binary search,constructive algorithms,interactive,ternary search" "The only difference between this problem and the hard version is the maximum number of questions.This is an interactive problem.There is a hidden integer 1\xe2\x89\xa4x\xe2\x89\xa4n which you have to find. In order to find it you can ask at most 82 questions.In each question you can choose a non-empty integer set S and ask if x belongs to S or not, after each question, if x belongs to S, you\'ll receive ""YES"", otherwise ""NO"".But the problem is that not all answers are necessarily true (some of them are joking), it\'s just guaranteed that for each two consecutive questions, at least one of them is answered correctly.Additionally to the questions, you can make at most 2 guesses for the answer x. Each time you make a guess, if you guess x correctly, you receive "":)"" and your program should terminate, otherwise you\'ll receive "":("".As a part of the joking, we will not fix the value of x in the beginning. Instead, it can change throughout the interaction as long as all the previous responses are valid as described above.Note that your answer guesses are always answered correctly. If you ask a question before and after a guess, at least one of these two questions is answered correctly, as normal." 2500.0                       
                         1746C "Permutation Operations" "constructive algorithms,greedy,implementation,math" "You are given a permutation a of size n and you should perform n operations on it. In the i-th operation, you can choose a non-empty suffix of a and increase all of its elements by i. How can we perform the operations to minimize the number of inversions in the final array?Note that you can perform operations on the same suffix any number of times you want.A permutation of size n is an array of size n such that each integer from 1 to n occurs exactly once in this array. A suffix is several consecutive elements of an array that include the last element of the array. An inversion in an array a is a pair of indices (i,j) such that i>j and ai<aj." 1300.0                       
                         1743B "Permutation Value" "constructive algorithms,greedy" "You are given an integer n. You have to construct a permutation of size n.A permutation is an array where each integer from 1 to s (where s is the size of permutation) occurs exactly once. For example, [2,1,4,3] is a permutation of size 4; [1,2,4,5,3] is a permutation of size 5; [1,4,3] is not a permutation (the integer 2 is absent), [2,1,3,1] is not a permutation (the integer 1 appears twice).A subsegment of a permutation is a contiguous subsequence of that permutation. For example, the permutation [2,1,4,3] has 10 subsegments: [2], [2,1], [2,1,4], [2,1,4,3], [1], [1,4], [1,4,3], [4], [4,3] and [3].The value of the permutation is the number of its subsegments which are also permutations. For example, the value of [2,1,4,3] is 3 since the subsegments [2,1], [1] and [2,1,4,3] are permutations.You have to construct a permutation of size n with minimum possible value among all permutations of size n." 800.0                       
                         1741B "Funny Permutation" "constructive algorithms,math" "A sequence of n numbers is called permutation if it contains all numbers from 1 to n exactly once. For example, the sequences [3,1,4,2], [1] and [2,1] are permutations, but [1,2,1], [0,1] and [1,3,4] are not.For a given number n you need to make a permutation p such that two requirements are satisfied at the same time:  For each element pi, at least one of its neighbors has a value that differs from the value of pi by one. That is, for each element pi (1\xe2\x89\xa4i\xe2\x89\xa4n), at least one of its neighboring elements (standing to the left or right of pi) must be pi+1, or pi\xe2\x88\x921.  the permutation must have no fixed points. That is, for every i (1\xe2\x89\xa4i\xe2\x89\xa4n), pi\xe2\x89\xa0i must be satisfied. Let\'s call the permutation that satisfies these requirements funny.For example, let n=4. Then [4,3,1,2] is a funny permutation, since:   to the right of p1=4 is p2=p1\xe2\x88\x921=4\xe2\x88\x921=3;  to the left of p2=3 is p1=p2+1=3+1=4;  to the right of p3=1 is p4=p3+1=1+1=2;  to the left of p4=2 is p3=p4\xe2\x88\x921=2\xe2\x88\x921=1.  for all i is pi\xe2\x89\xa0i. For a given positive integer n, output any funny permutation of length n, or output -1 if funny permutation of length n does not exist." 800.0                       
                         1738F "Connectivity Addicts" "constructive algorithms,dsu,graphs,greedy,interactive,shortest paths,trees" "This is an interactive problem.Given a simple undirected graph with n vertices numbered from 1 to n, your task is to color all the vertices such that for every color c, the following conditions hold:   The set of vertices with color c is connected;  sc\xe2\x89\xa4n2c, where nc is the number of vertices with color c, and sc is the sum of degrees of vertices with color c.  It can be shown that there always exists a way to color all the vertices such that the above conditions hold. Initially, you are only given the number n of vertices and the degree of each vertex. In each query, you can choose a vertex u. As a response, you will be given the k-th edge incident to u, if this is the k-th query on vertex u. You are allowed to make at most n queries.An undirected graph is simple if it does not contain multiple edges or self-loops.The degree of a vertex is the number of edges incident to it. A set S of vertices is connected if for every two different vertices u,v\xe2\x88\x88S, there is a path, which only passes through vertices in S, that connects u and v. That is, there is a sequence of edges (u1,v1),(u2,v2),\xe2\x80\xa6,(uk,vk) with k\xe2\x89\xa51 such that   u1=u, vk=v, and vi=ui+1 for every 1\xe2\x89\xa4i<k; and  uk\xe2\x88\x88S and vk\xe2\x88\x88S for every 1\xe2\x89\xa4i\xe2\x89\xa4k.  Especially, a set containing only one vertex is connected." 2400.0                       
                         1737B "Ela\'s Fitness and the Luxury Number" "binary search,implementation,math" "While working at DTL, Ela is very aware of her physical and mental health. She started to practice various sports, such as Archery, Yoga, and Football.Since she started engaging in sports activities, Ela switches to trying a new sport on days she considers being ""Luxury"" days. She counts the days since she started these activities, in which the day she starts is numbered as day 11. A ""Luxury"" day is the day in which the number of this day is a luxurious number. An integer xx is called a luxurious number if it is divisible by \xe2\x8c\x8ax\xe2\x88\x92\xe2\x88\x92\xe2\x88\x9a\xe2\x8c\x8b\xe2\x8c\x8ax\xe2\x8c\x8b.Here \xe2\x8c\x8ar\xe2\x8c\x8b\xe2\x8c\x8ar\xe2\x8c\x8b denotes the ""floor"" of a real number rr. In other words, it\'s the largest integer not greater than rr.For example: 88, 5656, 100100 are luxurious numbers, since 88 is divisible by \xe2\x8c\x8a8\xe2\x80\x93\xe2\x88\x9a\xe2\x8c\x8b=\xe2\x8c\x8a2.8284\xe2\x8c\x8b=2\xe2\x8c\x8a8\xe2\x8c\x8b=\xe2\x8c\x8a2.8284\xe2\x8c\x8b=2, 5656 is divisible \xe2\x8c\x8a56\xe2\x88\x92\xe2\x88\x92\xe2\x88\x9a\xe2\x8c\x8b=\xe2\x8c\x8a7.4833\xe2\x8c\x8b=7\xe2\x8c\x8a56\xe2\x8c\x8b=\xe2\x8c\x8a7.4833\xe2\x8c\x8b=7, and 100100 is divisible by \xe2\x8c\x8a100\xe2\x88\x92\xe2\x88\x92\xe2\x88\x92\xe2\x88\x9a\xe2\x8c\x8b=\xe2\x8c\x8a10\xe2\x8c\x8b=10\xe2\x8c\x8a100\xe2\x8c\x8b=\xe2\x8c\x8a10\xe2\x8c\x8b=10, respectively. On the other hand 55, 4040 are not, since 55 are not divisible by \xe2\x8c\x8a5\xe2\x80\x93\xe2\x88\x9a\xe2\x8c\x8b=\xe2\x8c\x8a2.2361\xe2\x8c\x8b=2\xe2\x8c\x8a5\xe2\x8c\x8b=\xe2\x8c\x8a2.2361\xe2\x8c\x8b=2, and 4040 are not divisible by \xe2\x8c\x8a40\xe2\x88\x92\xe2\x88\x92\xe2\x88\x9a\xe2\x8c\x8b=\xe2\x8c\x8a6.3246\xe2\x8c\x8b=6\xe2\x8c\x8a40\xe2\x8c\x8b=\xe2\x8c\x8a6.3246\xe2\x8c\x8b=6.Being a friend of Ela, you want to engage in these fitness activities with her to keep her and yourself accompanied (and have fun together, of course). Between day ll and day rr, you want to know how many times she changes the activities." 1300.0                       
                         1736D "Equal Binary Subsequences" "constructive algorithms,geometry,greedy,implementation,strings" "Everool has a binary string s of length 2n. Note that a binary string is a string consisting of only characters 0 and 1. He wants to partition s into two disjoint equal subsequences. He needs your help to do it.You are allowed to do the following operation exactly once.   You can choose any subsequence (possibly empty) of s and rotate it right by one position. In other words, you can select a sequence of indices b1,b2,\xe2\x80\xa6,bm, where 1\xe2\x89\xa4b1<b2<\xe2\x80\xa6<bm\xe2\x89\xa42n. After that you simultaneously set sb1:=sbm, sb2:=sb1, \xe2\x80\xa6, sbm:=sbm\xe2\x88\x921.Can you partition s into two disjoint equal subsequences after performing the allowed operation exactly once?A partition of s into two disjoint equal subsequences sp and sq is two increasing arrays of indices p1,p2,\xe2\x80\xa6,pn and q1,q2,\xe2\x80\xa6,qn, such that each integer from 1 to 2n is encountered in either p or q exactly once, sp=sp1sp2\xe2\x80\xa6spn, sq=sq1sq2\xe2\x80\xa6sqn, and sp=sq.If it is not possible to partition after performing any kind of operation, report \xe2\x88\x921. If it is possible to do the operation and partition s into two disjoint subsequences sp and sq, such that sp=sq, print elements of b and indices of sp, i. e. the values p1,p2,\xe2\x80\xa6,pn." 2200.0                       
                         1733D2 "Zero-One (Hard Version)" dp,greedy "This is the hard version of this problem. In this version, n\xe2\x89\xa45000 holds, and this version has no restriction between x and y. You can make hacks only if both versions of the problem are solved.You are given two binary strings a and b, both of length n. You can do the following operation any number of times (possibly zero).   Select two indices l and r (l<r).  Change al to (1\xe2\x88\x92al), and ar to (1\xe2\x88\x92ar).  If l+1=r, the cost of the operation is x. Otherwise, the cost is y. You have to find the minimum cost needed to make a equal to b or say there is no way to do so." 2000.0                       
                         1732E Location "data structures,dp,math,number theory" "You are given two arrays of integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn. You need to handle q queries of the following two types: 1 l r x: assign ai:=x for all l\xe2\x89\xa4i\xe2\x89\xa4r; 2 l r: find the minimum value of the following expression among all l\xe2\x89\xa4i\xe2\x89\xa4r: lcm(ai,bi)gcd(ai,bi).In this problem gcd(x,y) denotes the greatest common divisor of x and y, and lcm(x,y) denotes the least common multiple of x and y." 2800.0                       
                         1731B "Kill Demodogs" greedy,math "Demodogs from the Upside-down have attacked Hawkins again. El wants to reach Mike and also kill as many Demodogs in the way as possible.Hawkins can be represented as an n\xc3\x97n grid. The number of Demodogs in a cell at the i-th row and the j-th column is i\xe2\x8b\x85j. El is at position (1,1) of the grid, and she has to reach (n,n) where she can find Mike. The only directions she can move are the right (from (i,j) to (i,j+1)) and the down (from (i,j) to (i+1,j)). She can\'t go out of the grid, as there are doors to the Upside-down at the boundaries. Calculate the maximum possible number of Demodogs ans she can kill on the way, considering that she kills all Demodogs in cells she visits (including starting and finishing cells).Print 2022\xe2\x8b\x85ans modulo 109+7. Modulo 109+7 because the result can be too large and multiplied by 2022 because we are never gonna see it again!(Note, you firstly multiply by 2022 and only after that take the remainder.)" 1100.0                       
                         1730D "Prefixes and Suffixes" "constructive algorithms,strings,two pointers" "You have two strings s1 and s2 of length n, consisting of lowercase English letters. You can perform the following operation any (possibly zero) number of times:   Choose a positive integer 1\xe2\x89\xa4k\xe2\x89\xa4n.  Swap the prefix of the string s1 and the suffix of the string s2 of length k. Is it possible to make these two strings equal by doing described operations?" 2200.0                       
                         1729C "Jumping on Tiles" "constructive algorithms,strings" "Polycarp was given a row of tiles. Each tile contains one lowercase letter of the Latin alphabet. The entire sequence of tiles forms the string s.In other words, you are given a string s consisting of lowercase Latin letters.Initially, Polycarp is on the first tile of the row and wants to get to the last tile by jumping on the tiles. Jumping from i-th tile to j-th tile has a cost equal to |index(si)\xe2\x88\x92index(sj)|, where index(c) is the index of the letter c in the alphabet (for example, index(\'a\')=1, index(\'b\')=2, ..., index(\'z\')=26) .Polycarp wants to get to the n-th tile for the minimum total cost, but at the same time make maximum number of jumps.In other words, among all possible ways to get to the last tile for the minimum total cost, he will choose the one with the maximum number of jumps.Polycarp can visit each tile at most once.Polycarp asks you to help \xe2\x80\x94 print the sequence of indices of string s on which he should jump." 1100.0                       
                         1728D "Letter Picking" "constructive algorithms,dp,games,two pointers" "Alice and Bob are playing a game. Initially, they are given a non-empty string s, consisting of lowercase Latin letters. The length of the string is even. Each player also has a string of their own, initially empty.Alice starts, then they alternate moves. In one move, a player takes either the first or the last letter of the string s, removes it from s and prepends (adds to the beginning) it to their own string.The game ends when the string s becomes empty. The winner is the player with a lexicographically smaller string. If the players\' strings are equal, then it\'s a draw.A string a is lexicographically smaller than a string b if there exists such position i that aj=bj for all j<i and ai<bi.What is the result of the game if both players play optimally (e.\xe2\x80\x89g. both players try to win; if they can\'t, then try to draw)?" 1800.0                       
                         1726B "Mainak and Interesting Sequence" "bitmasks,constructive algorithms,math" "Mainak has two positive integers n and m.Mainak finds a sequence a1,a2,\xe2\x80\xa6,an of n positive integers interesting, if for all integers i (1\xe2\x89\xa4i\xe2\x89\xa4n), the bitwise XOR of all elements in a which are strictly less than ai is 0. Formally if pi is the bitwise XOR of all elements in a which are strictly less than ai, then a is an interesting sequence if p1=p2=\xe2\x80\xa6=pn=0.For example, sequences [1,3,2,3,1,2,3], [4,4,4,4], [25] are interesting, whereas [1,2,3,4] (p2=1\xe2\x89\xa00), [4,1,1,2,4] (p1=1\xe2\x8a\x951\xe2\x8a\x952=2\xe2\x89\xa00), [29,30,30] (p2=29\xe2\x89\xa00) aren\'t interesting.Here a\xe2\x8a\x95b denotes bitwise XOR of integers a and b.Find any interesting sequence a1,a2,\xe2\x80\xa6,an (or report that there exists no such sequence) such that the sum of the elements in the sequence a is equal to m, i.e. a1+a2\xe2\x80\xa6+an=m.As a reminder, the bitwise XOR of an empty sequence is considered to be 0." 1100.0                       
                              1725A "Accumulation of Dominoes" math "Pak Chanek has a grid that has N rows and M columns. Each row is numbered from 1 to N from top to bottom. Each column is numbered from 1 to M from left to right.Each tile in the grid contains a number. The numbers are arranged as follows:   Row 1 contains integers from 1 to M from left to right.  Row 2 contains integers from M+1 to 2\xc3\x97M from left to right.  Row 3 contains integers from 2\xc3\x97M+1 to 3\xc3\x97M from left to right.  And so on until row N. A domino is defined as two different tiles in the grid that touch by their sides. A domino is said to be tight if and only if the two numbers in the domino have a difference of exactly 1. Count the number of distinct tight dominoes in the grid.Two dominoes are said to be distinct if and only if there exists at least one tile that is in one domino, but not in the other." 800.0                  
                              1721F "Matching Reduction" "brute force,constructive algorithms,dfs and similar,flows,graph matchings,graphs,interactive" "You are given a bipartite graph with n1 vertices in the first part, n2 vertices in the second part, and m edges. The maximum matching in this graph is the maximum possible (by size) subset of edges of this graph such that no vertex is incident to more than one chosen edge.You have to process two types of queries to this graph:  1 \xe2\x80\x94 remove the minimum possible number of vertices from this graph so that the size of the maximum matching gets reduced exactly by 1, and print the vertices that you have removed. Then, find any maximum matching in this graph and print the sum of indices of edges belonging to this matching;  2 \xe2\x80\x94 query of this type will be asked only after a query of type 1. As the answer to this query, you have to print the edges forming the maximum matching you have chosen in the previous query. Note that you should solve the problem in online mode. It means that you can\'t read the whole input at once. You can read each query only after writing the answer for the last query. Use functions fflush in C++ and BufferedWriter.flush in Java languages after each writing in your program." 2800.0                  
                              1721A Image greedy,implementation "You have an image file of size 2\xc3\x972, consisting of 4 pixels. Each pixel can have one of 26 different colors, denoted by lowercase Latin letters.You want to recolor some of the pixels of the image so that all 4 pixels have the same color. In one move, you can choose no more than two pixels of the same color and paint them into some other color (if you choose two pixels, both should be painted into the same color).What is the minimum number of moves you have to make in order to fulfill your goal?" 800.0                  
                              1717A "Madoka and Strange Thoughts" "math,number theory" "Madoka is a very strange girl, and therefore she suddenly wondered how many pairs of integers (a,b) exist, where 1\xe2\x89\xa4a,b\xe2\x89\xa4n, for which lcm(a,b)gcd(a,b)\xe2\x89\xa43.In this problem, gcd(a,b) denotes the greatest common divisor of the numbers a and b, and lcm(a,b) denotes the smallest common multiple of the numbers a and b." 800.0                  
                              1714A "Everyone Loves to Sleep" implementation,math "Vlad, like everyone else, loves to sleep very much.Every day Vlad has to do n things, each at a certain time. For each of these things, he has an alarm clock set, the i-th of them is triggered on hi hours mi minutes every day (0\xe2\x89\xa4hi<24,0\xe2\x89\xa4mi<60). Vlad uses the 24-hour time format, so after h=12,m=59 comes h=13,m=0 and after h=23,m=59 comes h=0,m=0.This time Vlad went to bed at H hours M minutes (0\xe2\x89\xa4H<24,0\xe2\x89\xa4M<60) and asks you to answer: how much he will be able to sleep until the next alarm clock.If any alarm clock rings at the time when he went to bed, then he will sleep for a period of time of length 0." 900.0                  
                              1712F Triameter "binary search,data structures,dfs and similar,trees" "\xe2\x80\x94 What is my mission?  \xe2\x80\x94 To count graph diameters.You and Your SubmissionA tree is a connected undirected graph without cycles. A weighted tree has a weight assigned to each edge. The degree of a vertex is the number of edges connected to this vertex.You are given a weighted tree with n vertices, each edge has a weight of 1. Let L be the set of vertices with degree equal to 1. You have to answer q independent queries. In the i-th query:  You are given a positive integer xi.  For all u,v\xe2\x88\x88L such that u<v, add edge (u,v) with weight xi to the graph (initially the given tree).  Find the diameter of the resulting graph. The diameter of a graph is equal to max1\xe2\x89\xa4u<v\xe2\x89\xa4nd(u,v), where d(u,v) is the length of the shortest path between vertex u and vertex v." 3200.0                  
                              1712D "Empty Graph" "binary search,constructive algorithms,data structures,greedy,shortest paths" "\xe2\x80\x94 Do you have a wish?  \xe2\x80\x94 I want people to stop gifting each other arrays.O_o and Another Young BoyAn array of n positive integers a1,a2,\xe2\x80\xa6,an fell down on you from the skies, along with a positive integer k\xe2\x89\xa4n.You can apply the following operation at most k times:   Choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n and an integer 1\xe2\x89\xa4x\xe2\x89\xa4109. Then do ai:=x (assign x to ai). Then build a complete undirected weighted graph with n vertices numbered with integers from 1 to n, where edge (l,r) (1\xe2\x89\xa4l<r\xe2\x89\xa4n) has weight min(al,al+1,\xe2\x80\xa6,ar).You have to find the maximum possible diameter of the resulting graph after performing at most k operations.The diameter of a graph is equal to max1\xe2\x89\xa4u<v\xe2\x89\xa4nd(u,v), where d(u,v) is the length of the shortest path between vertex u and vertex v." 2000.0                  
                              1709B "Also Try Minecraft" "data structures,dp,implementation" "You are beta testing the new secret Terraria update. This update will add quests to the game!Simply, the world map can be represented as an array of length n, where the i-th column of the world has height ai.There are m quests you have to test. The j-th of them is represented by two integers sj and tj. In this quest, you have to go from the column sj to the column tj. At the start of the quest, you are appearing at the column sj.In one move, you can go from the column x to the column x\xe2\x88\x921 or to the column x+1. In this version, you have Spectre Boots, which allow you to fly. Since it is a beta version, they are bugged, so they only allow you to fly when you are going up and have infinite fly duration. When you are moving from the column with the height p to the column with the height q, then you get some amount of fall damage. If the height p is greater than the height q, you get p\xe2\x88\x92q fall damage, otherwise you fly up and get 0 damage.For each of the given quests, determine the minimum amount of fall damage you can get during this quest." 900.0                  
                              1708A "Difference Operations" greedy,math "You are given an array a consisting of n positive integers.You are allowed to perform this operation any number of times (possibly, zero):   choose an index i (2\xe2\x89\xa4i\xe2\x89\xa4n), and change ai to ai\xe2\x88\x92ai\xe2\x88\x921. Is it possible to make ai=0 for all 2\xe2\x89\xa4i\xe2\x89\xa4n?" 800.0                  
                              1707F Bugaboo "bitmasks,constructive algorithms,dp,number theory" "A transformation of an array of positive integers a1,a2,\xe2\x80\xa6,an is defined by replacing a with the array b1,b2,\xe2\x80\xa6,bn given by bi=ai\xe2\x8a\x95a(imodn)+1, where \xe2\x8a\x95 denotes the bitwise XOR operation.You are given integers n, t, and w. We consider an array c1,c2,\xe2\x80\xa6,cn (0\xe2\x89\xa4ci\xe2\x89\xa42w\xe2\x88\x921) to be bugaboo if and only if there exists an array a1,a2,\xe2\x80\xa6,an such that after transforming a for t times, a becomes c.For example, when n=6, t=2, w=2, then the array [3,2,1,0,2,2] is bugaboo because it can be given by transforming the array [2,3,1,1,0,1] for 2 times:[2,3,1,1,0,1]\xe2\x86\x92[2\xe2\x8a\x953,3\xe2\x8a\x951,1\xe2\x8a\x951,1\xe2\x8a\x950,0\xe2\x8a\x951,1\xe2\x8a\x952]=[1,2,0,1,1,3];[1,2,0,1,1,3]\xe2\x86\x92[1\xe2\x8a\x952,2\xe2\x8a\x950,0\xe2\x8a\x951,1\xe2\x8a\x951,1\xe2\x8a\x953,3\xe2\x8a\x951]=[3,2,1,0,2,2].And the array [4,4,4,4,0,0] is not bugaboo because 4>22\xe2\x88\x921. The array [2,3,3,3,3,3] is also not bugaboo because it can\'t be given by transforming one array for 2 times.You are given an array c with some positions lost (only m positions are known at first and the remaining positions are lost). And there are q modifications, where each modification is changing a position of c. A modification can possibly change whether the position is lost or known, and it can possibly redefine a position that is already given.You need to calculate how many possible arrays c (with arbitrary elements on the lost positions) are bugaboos after each modification. Output the i-th answer modulo pi (pi is a given array consisting of q elements)." 3500.0                  
                              1706E "Qpwoeirut and Vertices" "binary search,data structures,dfs and similar,divide and conquer,dsu,greedy,trees" "You are given a connected undirected graph with n vertices and m edges. Vertices of the graph are numbered by integers from 1 to n and edges of the graph are numbered by integers from 1 to m.Your task is to answer q queries, each consisting of two integers l and r. The answer to each query is the smallest non-negative integer k such that the following condition holds:   For all pairs of integers (a,b) such that l\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa4r, vertices a and b are reachable from one another using only the first k edges (that is, edges 1,2,\xe2\x80\xa6,k)." 2300.0                  
                                  800.0 1525A Potion-making "math,number theory" "You have an initially empty cauldron, and you want to brew a potion in it. The potion consists of two ingredients: magic essence and water. The potion you want to brew should contain exactly k % magic essence and (100\xe2\x88\x92k) % water.In one step, you can pour either one liter of magic essence or one liter of water into the cauldron. What is the minimum number of steps to brew a potion? You don\'t care about the total volume of the potion, only about the ratio between magic essence and water in it.A small reminder: if you pour e liters of essence and w liters of water (e+w>0) into the cauldron, then it contains ee+w\xe2\x8b\x85100 % (without rounding) magic essence and we+w\xe2\x8b\x85100 % water."              
                                  2000.0 1521C "Nastia and a Hidden Permutation" "constructive algorithms,interactive" "This is an interactive problem!Nastia has a hidden permutation p of length n consisting of integers from 1 to n. You, for some reason, want to figure out the permutation. To do that, you can give her an integer t (1\xe2\x89\xa4t\xe2\x89\xa42), two different indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j), and an integer x (1\xe2\x89\xa4x\xe2\x89\xa4n\xe2\x88\x921). Depending on t, she will answer:   t=1: max(min(x,pi),min(x+1,pj));  t=2: min(max(x,pi),max(x+1,pj)). You can ask Nastia at most \xe2\x8c\x8a3\xe2\x8b\x85n2\xe2\x8c\x8b+30 times. It is guaranteed that she will not change her permutation depending on your queries. Can you guess the permutation?"              
                                  1300.0 1521B "Nastia and a Good Array" "constructive algorithms,math,number theory" "Nastia has received an array of n positive integers as a gift.She calls such an array a good that for all i (2\xe2\x89\xa4i\xe2\x89\xa4n) takes place gcd(ai\xe2\x88\x921,ai)=1, where gcd(u,v) denotes the greatest common divisor (GCD) of integers u and v.You can perform the operation: select two different indices i,j (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j) and two integers x,y (1\xe2\x89\xa4x,y\xe2\x89\xa42\xe2\x8b\x85109) so that min(ai,aj)=min(x,y). Then change ai to x and aj to y.The girl asks you to make the array good using at most n operations.It can be proven that this is always possible."              
                                  3300.0 1517G "Starry Night Camping" "constructive algorithms,flows,graphs" "At the foot of Liyushan Mountain, n tents will be carefully arranged to provide accommodation for those who are willing to experience the joy of approaching nature, the tranquility of the night, and the bright starry sky.The i-th tent is located at the point of (xi,yi) and has a weight of wi. A tent is important if and only if both xi and yi are even. You need to remove some tents such that for each remaining important tent (x,y), there do not exist 3 other tents (x\xe2\x80\xb21,y\xe2\x80\xb21), (x\xe2\x80\xb22,y\xe2\x80\xb22) and (x\xe2\x80\xb23,y\xe2\x80\xb23) such that both conditions are true:   |x\xe2\x80\xb2j\xe2\x88\x92x|,|y\xe2\x80\xb2j\xe2\x88\x92y|\xe2\x89\xa41 for all j\xe2\x88\x88{1,2,3}, and  these four tents form a parallelogram (or a rectangle) and one of its sides is parallel to the x-axis. Please maximize the sum of the weights of the tents that are not removed. Print the maximum value."              
                                  1200.0 1517B "Morning Jogging" "constructive algorithms,greedy,sortings" "The 2050 volunteers are organizing the ""Run! Chase the Rising Sun"" activity. Starting on Apr 25 at 7:30 am, runners will complete the 6km trail around the Yunqi town.There are n+1 checkpoints on the trail. They are numbered by 0, 1, ..., n. A runner must start at checkpoint 0 and finish at checkpoint n. No checkpoint is skippable \xe2\x80\x94 he must run from checkpoint 0 to checkpoint 1, then from checkpoint 1 to checkpoint 2 and so on. Look at the picture in notes section for clarification.Between any two adjacent checkpoints, there are m different paths to choose. For any 1\xe2\x89\xa4i\xe2\x89\xa4n, to run from checkpoint i\xe2\x88\x921 to checkpoint i, a runner can choose exactly one from the m possible paths. The length of the j-th path between checkpoint i\xe2\x88\x921 and i is bi,j for any 1\xe2\x89\xa4j\xe2\x89\xa4m and 1\xe2\x89\xa4i\xe2\x89\xa4n.To test the trail, we have m runners. Each runner must run from the checkpoint 0 to the checkpoint n once, visiting all the checkpoints. Every path between every pair of adjacent checkpoints needs to be ran by exactly one runner. If a runner chooses the path of length li between checkpoint i\xe2\x88\x921 and i (1\xe2\x89\xa4i\xe2\x89\xa4n), his tiredness is nmini=1li, i. e. the minimum length of the paths he takes.Please arrange the paths of the m runners to minimize the sum of tiredness of them."              
                                  1500.0 1515D "Phoenix and Socks" "greedy,sortings,two pointers" "To satisfy his love of matching socks, Phoenix has brought his n socks (n is even) to the sock store. Each of his socks has a color ci and is either a left sock or right sock. Phoenix can pay one dollar to the sock store to either:   recolor a sock to any color c\xe2\x80\xb2 (1\xe2\x89\xa4c\xe2\x80\xb2\xe2\x89\xa4n)  turn a left sock into a right sock  turn a right sock into a left sock  The sock store may perform each of these changes any number of times. Note that the color of a left sock doesn\'t change when it turns into a right sock, and vice versa. A matching pair of socks is a left and right sock with the same color. What is the minimum cost for Phoenix to make n/2 matching pairs? Each sock must be included in exactly one matching pair."              
                                  1600.0 1514C "Product 1 Modulo N" "greedy,number theory" "Now you get Baby Ehab\'s first words: ""Given an integer n, find the longest subsequence of [1,2,\xe2\x80\xa6,n\xe2\x88\x921] whose product is 1 modulo n."" Please solve the problem.A sequence b is a subsequence of an array a if b can be obtained from a by deleting some (possibly all) elements. The product of an empty subsequence is equal to 1."              
                                  2000.0 1513D "GCD and MST" "constructive algorithms,dsu,graphs,greedy,number theory,sortings" "You are given an array a of n (n\xe2\x89\xa52) positive integers and an integer p. Consider an undirected weighted graph of n vertices numbered from 1 to n for which the edges between the vertices i and j (i<j) are added in the following manner:  If gcd(ai,ai+1,ai+2,\xe2\x80\xa6,aj)=min(ai,ai+1,ai+2,\xe2\x80\xa6,aj), then there is an edge of weight min(ai,ai+1,ai+2,\xe2\x80\xa6,aj) between i and j.  If i+1=j, then there is an edge of weight p between i and j. Here gcd(x,y,\xe2\x80\xa6) denotes the greatest common divisor (GCD) of integers x, y, ....Note that there could be multiple edges between i and j if both of the above conditions are true, and if both the conditions fail for i and j, then there is no edge between these vertices.The goal is to find the weight of the minimum spanning tree of this graph."              
                                  1400.0 1513B "AND Sequences" "bitmasks,combinatorics,constructive algorithms,math" "A sequence of n non-negative integers (n\xe2\x89\xa52) a1,a2,\xe2\x80\xa6,an is called good if for all i from 1 to n\xe2\x88\x921 the following condition holds true: a1&a2&\xe2\x80\xa6&ai=ai+1&ai+2&\xe2\x80\xa6&an, where & denotes the bitwise AND operation.You are given an array a of size n (n\xe2\x89\xa52). Find the number of permutations p of numbers ranging from 1 to n, for which the sequence ap1, ap2, ... ,apn is good. Since this number can be large, output it modulo 109+7."              
                                  1700.0 1512G "Short Task" "brute force,dp,math,number theory" "Let us denote by d(n) the sum of all divisors of the number n, i.e. d(n)=\xe2\x88\x91k|nk.For example, d(1)=1, d(4)=1+2+4=7, d(6)=1+2+3+6=12.For a given number c, find the minimum n such that d(n)=c."              
                                  1600.0 1512E "Permutation by Sum" "brute force,greedy,math" "A permutation is a sequence of n integers from 1 to n, in which all the numbers occur exactly once. For example, [1], [3,5,2,1,4], [1,3,2] are permutations, and [2,3,2], [4,3,1], [0] are not.Polycarp was given four integers n, l, r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and s (1\xe2\x89\xa4s\xe2\x89\xa4n(n+1)2) and asked to find a permutation p of numbers from 1 to n that satisfies the following condition:   s=pl+pl+1+\xe2\x80\xa6+pr. For example, for n=5, l=3, r=5, and s=8, the following permutations are suitable (not all options are listed):   p=[3,4,5,2,1];  p=[5,2,4,3,1];  p=[5,2,1,3,4].  But, for example, there is no permutation suitable for the condition above for n=4, l=1, r=1, and s=5.Help Polycarp, for the given n, l, r, and s, find a permutation of numbers from 1 to n that fits the condition above. If there are several suitable permutations, print any of them."              
                                  800.0 1512A "Spy Detected!" "brute force,implementation" "You are given an array a consisting of n (n\xe2\x89\xa53) positive integers. It is known that in this array, all the numbers except one are the same (for example, in the array [4,11,4,4] all numbers except one are equal to 4).Print the index of the element that does not equal others. The numbers in the array are numbered from one."              
                                  1100.0 1511B "GCD Length" "constructive algorithms,math,number theory" "You are given three integers a, b and c.Find two positive integers x and y (x>0, y>0) such that:   the decimal representation of x without leading zeroes consists of a digits;  the decimal representation of y without leading zeroes consists of b digits;  the decimal representation of gcd(x,y) without leading zeroes consists of c digits. gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y.Output x and y. If there are multiple answers, output any of them."              
                                  800.0 1506A "Strange Table" math "Polycarp found a rectangular table consisting of n rows and m columns. He noticed that each cell of the table has its number, obtained by the following algorithm ""by columns"":   cells are numbered starting from one;  cells are numbered from left to right by columns, and inside each column from top to bottom;  number of each cell is an integer one greater than in the previous cell. For example, if n=3 and m=5, the table will be numbered as follows:147101325811143691215However, Polycarp considers such numbering inconvenient. He likes the numbering ""by rows"":   cells are numbered starting from one;  cells are numbered from top to bottom by rows, and inside each row from left to right;  number of each cell is an integer one greater than the number of the previous cell. For example, if n=3 and m=5, then Polycarp likes the following table numbering: 123456789101112131415Polycarp doesn\'t have much time, so he asks you to find out what would be the cell number in the numbering ""by rows"", if in the numbering ""by columns"" the cell has the number x?"              
                                  2200.0 1505F Math "*special problem,math" "*The two images are equivalent, feel free to use either one."              
                                  1400.0 1505C "Fibonacci Words" "*special problem,implementation" "InputThe input consists of a single string of uppercase letters A-Z. The length of the string is between 1 and 10 characters, inclusive.OutputOutput ""YES"" or ""NO"".ExamplesInputCopyHELPOutputCopyYESInputCopyAIDOutputCopyNOInputCopyMARYOutputCopyNOInputCopyANNAOutputCopyYESInputCopyMUGOutputCopyYESInputCopyCUPOutputCopyNOInputCopySUMOutputCopyYESInputCopyPRODUCTOutputCopyNO"              
                                  1600.0 1505B DMCA "*special problem,implementation,number theory" "Many people are aware of DMCA \xe2\x80\x93 Digital Millennium Copyright Act. But another recently proposed DMCA \xe2\x80\x93 Digital Millennium Calculation Act \xe2\x80\x93 is much less known.In this problem you need to find a root of a number according to this new DMCA law."              
                                  1600.0 1497C2 "k-LCM (hard version)" "constructive algorithms,math" "It is the hard version of the problem. The only difference is that in this version 3\xe2\x89\xa4k\xe2\x89\xa4n.You are given a positive integer n. Find k positive integers a1,a2,\xe2\x80\xa6,ak, such that:  a1+a2+\xe2\x80\xa6+ak=n  LCM(a1,a2,\xe2\x80\xa6,ak)\xe2\x89\xa4n2 Here LCM is the least common multiple of numbers a1,a2,\xe2\x80\xa6,ak.We can show that for given constraints the answer always exists."              
                                  2900.0 1494F "Delete The Edges" "brute force,constructive algorithms,dfs and similar,graphs,implementation" "You are given an undirected connected graph consisting of n vertices and m edges. Your goal is to destroy all edges of the given graph.You may choose any vertex as the starting one and begin walking from it along the edges. When you walk along an edge, you destroy it. Obviously, you cannot walk along an edge if it is destroyed.You can perform the mode shift operation at most once during your walk, and this operation can only be performed when you are at some vertex (you cannot perform it while traversing an edge). After the mode shift, the edges you go through are deleted in the following way: the first edge after the mode shift is not destroyed, the second one is destroyed, the third one is not destroyed, the fourth one is destroyed, and so on. You cannot switch back to the original mode, and you don\'t have to perform this operation if you don\'t want to.Can you destroy all the edges of the given graph?"              
                                  2400.0 1494E "A-Z Graph" "constructive algorithms,data structures,graphs,hashing" "You are given a directed graph consisting of n vertices. Each directed edge (or arc) labeled with a single character. Initially, the graph is empty.You should process m queries with it. Each query is one of three types:   ""+ u v c"" \xe2\x80\x94 add arc from u to v with label c. It\'s guaranteed that there is no arc (u,v) in the graph at this moment;  ""\xe2\x88\x92 u v"" \xe2\x80\x94 erase arc from u to v. It\'s guaranteed that the graph contains arc (u,v) at this moment;  ""? k"" \xe2\x80\x94 find the sequence of k vertices v1,v2,\xe2\x80\xa6,vk such that there exist both routes v1\xe2\x86\x92v2\xe2\x86\x92\xe2\x8b\xaf\xe2\x86\x92vk and vk\xe2\x86\x92vk\xe2\x88\x921\xe2\x86\x92\xe2\x8b\xaf\xe2\x86\x92v1 and if you write down characters along both routes you\'ll get the same string. You can visit the same vertices any number of times."              
                                  800.0 1493A Anti-knapsack "constructive algorithms,greedy" "You are given two integers n and k. You are asked to choose maximum number of distinct integers from 1 to n so that there is no subset of chosen numbers with sum equal to k.A subset of a set is a set that can be obtained from initial one by removing some (possibly all or none) elements of it."              
                                  1900.0 1492D "Genius\'s Gambit" "bitmasks,constructive algorithms,greedy,math" "You are given three integers a, b, k.Find two binary integers x and y (x\xe2\x89\xa5y) such that   both x and y consist of a zeroes and b ones;  x\xe2\x88\x92y (also written in binary form) has exactly k ones.  You are not allowed to use leading zeros for x and y."              
                                  1500.0 1492C "Maximum width" "binary search,data structures,dp,greedy,two pointers" "Your classmate, whom you do not like because he is boring, but whom you respect for his intellect, has two strings: s of length n and t of length m.A sequence p1,p2,\xe2\x80\xa6,pm, where 1\xe2\x89\xa4p1<p2<\xe2\x80\xa6<pm\xe2\x89\xa4n, is called beautiful, if spi=ti for all i from 1 to m. The width of a sequence is defined as max1\xe2\x89\xa4i<m(pi+1\xe2\x88\x92pi).Please help your classmate to identify the beautiful sequence with the maximum width. Your classmate promised you that for the given strings s and t there is at least one beautiful sequence."              
                                  3400.0 1491H "Yuezheng Ling and Dynamic Tree" "data structures,trees" "Yuezheng Ling gives Luo Tianyi a tree which has n nodes, rooted at 1. Luo Tianyi will tell you that the parent of the i-th node is ai (1\xe2\x89\xa4ai<i for 2\xe2\x89\xa4i\xe2\x89\xa4n), and she will ask you to perform q queries of 2 types: She\'ll give you three integers l, r and x (2\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4x\xe2\x89\xa4105). You need to replace ai with max(ai\xe2\x88\x92x,1) for all i with l\xe2\x89\xa4i\xe2\x89\xa4r. She\'ll give you two integers u, v (1\xe2\x89\xa4u,v\xe2\x89\xa4n). You need to find the LCA of nodes u and v (their lowest common ancestor)."              
                                  2800.0 1488H "Build From Suffixes" "*special problem,combinatorics,data structures" "You are given an integer n and a sequence a of n\xe2\x88\x921 integers, each element is either 0 or 1.You are asked to build a string of length n such that:   each letter is one of ""abcd"";  if ai=1, then the i-th suffix of the string is lexicographically smaller than the (i+1)-th suffix;  if ai=0, then the i-th suffix of the string is lexicographically greater than the (i+1)-th suffix. You will be asked q queries of form:   i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) \xe2\x80\x94 flip the value of ai (if ai=0, then set ai to 1, and vice versa). After each query print the number of different strings that satisfy the given constraints modulo 998244353."              
                                  900.0 1488A "From Zero To Y" "*special problem,math" "You are given two positive (greater than zero) integers x and y. There is a variable k initially set to 0.You can perform the following two types of operations:   add 1 to k (i.\xe2\x80\x89e. assign k:=k+1);  add x\xe2\x8b\x8510p to k for some non-negative p (i.\xe2\x80\x89e. assign k:=k+x\xe2\x8b\x8510p for some p\xe2\x89\xa50). Find the minimum number of operations described above to set the value of k to y."              
                                  2600.0 1486F "Pairs of Paths" "combinatorics,data structures,dfs and similar,dp,trees" "You are given a tree consisting of n vertices, and m simple vertex paths. Your task is to find how many pairs of those paths intersect at exactly one vertex. More formally you have to find the number of pairs (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4m) such that pathi and pathj have exactly one vertex in common."              
                                  2400.0 1485F "Copy or Prefix Sum" "combinatorics,data structures,dp,sortings" "You are given an array of integers b1,b2,\xe2\x80\xa6,bn.An array a1,a2,\xe2\x80\xa6,an of integers is hybrid if for each i (1\xe2\x89\xa4i\xe2\x89\xa4n) at least one of these conditions is true:   bi=ai, or  bi=\xe2\x88\x91ij=1aj. Find the number of hybrid arrays a1,a2,\xe2\x80\xa6,an. As the result can be very large, you should print the answer modulo 109+7."              
                                  1700.0 1485C "Floor and Mod" "binary search,brute force,math,number theory" "A pair of positive integers (a,b) is called special if \xe2\x8c\x8aab\xe2\x8c\x8b=amodb. Here, \xe2\x8c\x8aab\xe2\x8c\x8b is the result of the integer division between a and b, while amodb is its remainder.You are given two integers x and y. Find the number of special pairs (a,b) such that 1\xe2\x89\xa4a\xe2\x89\xa4x and 1\xe2\x89\xa4b\xe2\x89\xa4y."              
                                  3100.0 1481F "AB Tree" dp,greedy,trees "Kilani and Abd are neighbors for 3000 years, but then the day came and Kilani decided to move to another house. As a farewell gift, Kilani is going to challenge Abd with a problem written by their other neighbor with the same name Abd.  The problem is:You are given a connected tree rooted at node 1.You should assign a character a or b to every node in the tree so that the total number of a\'s is equal to x and the total number of b\'s is equal to n\xe2\x88\x92x.Let\'s define a string for each node v of the tree as follows:   if v is root then the string is just one character assigned to v:  otherwise, let\'s take a string defined for the v\'s parent pv and add to the end of it a character assigned to v. You should assign every node a character in a way that minimizes the number of distinct strings among the strings of all nodes."              
                                  2000.0 1481D "AB Graph" "brute force,constructive algorithms,graphs,greedy,implementation" "Your friend Salem is Warawreh\'s brother and only loves math and geometry problems. He has solved plenty of such problems, but according to Warawreh, in order to graduate from university he has to solve more graph problems. Since Salem is not good with graphs he asked your help with the following problem.  You are given a complete directed graph with n vertices without self-loops. In other words, you have n vertices and each pair of vertices u and v (u\xe2\x89\xa0v) has both directed edges (u,v) and (v,u).Every directed edge of the graph is labeled with a single character: either \'a\' or \'b\' (edges (u,v) and (v,u) may have different labels).You are also given an integer m>0. You should find a path of length m such that the string obtained by writing out edges\' labels when going along the path is a palindrome. The length of the path is the number of edges in it.You can visit the same vertex and the same directed edge any number of times."              
                                  3500.0 1479E "School Clubs" "dp,fft,math,number theory,probabilities" "In Homer\'s school, there are n students who love clubs. Initially, there are m clubs, and each of the n students is in exactly one club. In other words, there are ai students in the i-th club for 1\xe2\x89\xa4i\xe2\x89\xa4m and a1+a2+\xe2\x8b\xaf+am=n.The n students are so unfriendly that every day one of them (chosen uniformly at random from all of the n students) gets angry. The student who gets angry will do one of the following things.   With probability 12, he leaves his current club, then creates a new club himself and joins it. There is only one student (himself) in the new club he creates.  With probability 12, he does not create new clubs. In this case, he changes his club to a new one (possibly the same club he is in currently) with probability proportional to the number of students in it. Formally, suppose there are k clubs and there are bi students in the i-th club for 1\xe2\x89\xa4i\xe2\x89\xa4k (before the student gets angry). He leaves his current club, and then joins the i-th club with probability bin.  We note that when a club becomes empty, students will never join it because any student who gets angry will join an empty club with probability 0 according to the above statement.Homer wonders the expected number of days until every student is in the same club for the first time.We can prove that the answer can be represented as a rational number pq with gcd(p,q)=1. Therefore, you are asked to find the value of pq\xe2\x88\x921mod998244353. It can be shown that qmod998244353\xe2\x89\xa00 under the given constraints of the problem."              
                                  2900.0 1479D "Odd Mineral Resource" "binary search,bitmasks,brute force,data structures,probabilities,trees" "In Homer\'s country, there are n cities numbered 1 to n and they form a tree. That is, there are (n\xe2\x88\x921) undirected roads between these n cities and every two cities can reach each other through these roads. Homer\'s country is an industrial country, and each of the n cities in it contains some mineral resource. The mineral resource of city i is labeled ai. Homer is given the plans of the country in the following q years. The plan of the i-th year is described by four parameters ui,vi,li and ri, and he is asked to find any mineral resource ci such that the following two conditions hold:   mineral resource ci appears an odd number of times between city ui and city vi; and  li\xe2\x89\xa4ci\xe2\x89\xa4ri. As the best friend of Homer, he asks you for help. For every plan, find any such mineral resource ci, or tell him that there doesn\'t exist one."              
                                  900.0 1475B "New Year\'s Number" "brute force,dp,math" "Polycarp remembered the 2020-th year, and he is happy with the arrival of the new 2021-th year. To remember such a wonderful moment, Polycarp wants to represent the number n as the sum of a certain number of 2020 and a certain number of 2021.For example, if:   n=4041, then the number n can be represented as the sum 2020+2021;  n=4042, then the number n can be represented as the sum 2021+2021;  n=8081, then the number n can be represented as the sum 2020+2020+2020+2021;  n=8079, then the number n cannot be represented as the sum of the numbers 2020 and 2021. Help Polycarp to find out whether the number n can be represented as the sum of a certain number of numbers 2020 and a certain number of numbers 2021."              
                                  2400.0 1473E "Minimum Path" "graphs,shortest paths" "You are given a weighted undirected connected graph consisting of n vertices and m edges. It is guaranteed that there are no self-loops or multiple edges in the given graph.Let\'s define the weight of the path consisting of k edges with indices e1,e2,\xe2\x80\xa6,ek as k\xe2\x88\x91i=1wei\xe2\x88\x92kmaxi=1wei+kmini=1wei, where wi \xe2\x80\x94 weight of the i-th edge in the graph.Your task is to find the minimum weight of the path from the 1-st vertex to the i-th vertex for each i (2\xe2\x89\xa4i\xe2\x89\xa4n)."              
                                  1700.0 1472E "Correct Placement" "binary search,data structures,dp,sortings,two pointers" "Polycarp has invited n friends to celebrate the New Year. During the celebration, he decided to take a group photo of all his friends. Each friend can stand or lie on the side.Each friend is characterized by two values hi (their height) and wi (their width). On the photo the i-th friend will occupy a rectangle hi\xc3\x97wi (if they are standing) or wi\xc3\x97hi (if they are lying on the side).The j-th friend can be placed in front of the i-th friend on the photo if his rectangle is lower and narrower than the rectangle of the i-th friend. Formally, at least one of the following conditions must be fulfilled:  hj<hi and wj<wi (both friends are standing or both are lying);  wj<hi and hj<wi (one of the friends is standing and the other is lying). For example, if n=3, h=[3,5,3] and w=[4,4,3], then:  the first friend can be placed in front of the second: w1<h2 and h1<w2 (one of the them is standing and the other one is lying);  the third friend can be placed in front of the second: h3<h2 and w3<w2 (both friends are standing or both are lying). In other cases, the person in the foreground will overlap the person in the background.Help Polycarp for each i find any j, such that the j-th friend can be located in front of the i-th friend (i.e. at least one of the conditions above is fulfilled).Please note that you do not need to find the arrangement of all people for a group photo. You just need to find for each friend i any other friend j who can be located in front of him. Think about it as you need to solve n separate independent subproblems."              
                                  900.0 1471A "Strange Partition" "greedy,math,number theory" "You are given an array a of length n, and an integer x. You can perform the following operation as many times as you would like (possibly zero): replace two adjacent elements of the array by their sum. For example, if the initial array was [3,6,9], in a single operation one can replace the last two elements by their sum, yielding an array [3,15], or replace the first two elements to get an array [9,9]. Note that the size of the array decreases after each operation.The beauty of an array b=[b1,\xe2\x80\xa6,bk] is defined as \xe2\x88\x91ki=1\xe2\x8c\x88bix\xe2\x8c\x89, which means that we divide each element by x, round it up to the nearest integer, and sum up the resulting values. For example, if x=3, and the array is [4,11,6], the beauty of the array is equal to \xe2\x8c\x8843\xe2\x8c\x89+\xe2\x8c\x88113\xe2\x8c\x89+\xe2\x8c\x8863\xe2\x8c\x89=2+4+2=8.Please determine the minimum and the maximum beauty you can get by performing some operations on the original array."              
                                  2500.0 1470C "Strange Shuffle" "binary search,brute force,constructive algorithms,interactive" "This is an interactive problem.n people sitting in a circle are trying to shuffle a deck of cards. The players are numbered from 1 to n, so that players i and i+1 are neighbours (as well as players 1 and n). Each of them has exactly k cards, where k is even. The left neighbour of a player i is player i\xe2\x88\x921, and their right neighbour is player i+1 (except for players 1 and n, who are respective neighbours of each other).Each turn the following happens: if a player has x cards, they give \xe2\x8c\x8ax/2\xe2\x8c\x8b to their neighbour on the left and \xe2\x8c\x88x/2\xe2\x8c\x89 cards to their neighbour on the right. This happens for all players simultaneously.However, one player p is the impostor and they just give all their cards to their neighbour on the right. You know the number of players n and the number of cards k each player has initially, but p is unknown to you. Your task is to determine the value of p, by asking questions like ""how many cards does player q have?"" for an index q of your choice. After each question all players will make exactly one move and give their cards to their neighbours. You need to find the impostor by asking no more than 1000 questions."              
                                  2600.0 1469F "Power Sockets" "binary search,data structures,greedy" "// We decided to drop the legend about the power sockets but feel free to come up with your own :^)Define a chain:   a chain of length 1 is a single vertex;  a chain of length x is a chain of length x\xe2\x88\x921 with a new vertex connected to the end of it with a single edge. You are given n chains of lengths l1,l2,\xe2\x80\xa6,ln. You plan to build a tree using some of them.  Each vertex of the tree is either white or black.  The tree initially only has a white root vertex.  All chains initially consist only of white vertices.  You can take one of the chains and connect any of its vertices to any white vertex of the tree with an edge. The chain becomes part of the tree. Both endpoints of this edge become black.  Each chain can be used no more than once.  Some chains can be left unused. The distance between two vertices of the tree is the number of edges on the shortest path between them.If there is at least k white vertices in the resulting tree, then the value of the tree is the distance between the root and the k-th closest white vertex.What\'s the minimum value of the tree you can obtain? If there is no way to build a tree with at least k white vertices, then print -1."              
                                  1600.0 1468K "The Robot" "brute force,implementation" "There is a robot on a checkered field that is endless in all directions. Initially, the robot is located in the cell with coordinates (0,0). He will execute commands which are described by a string of capital Latin letters \'L\', \'R\', \'D\', \'U\'. When a command is executed, the robot simply moves in the corresponding direction:  \'L\': one cell to the left (the x-coordinate of the current cell decreases by 1);  \'R\': one cell to the right (the x-coordinate of the current cell is increased by 1);  \'D\': one cell down (the y-coordinate of the current cell decreases by 1);  \'U\': one cell up (the y-coordinate of the current cell is increased by 1). Your task is to put an obstacle in one cell of the field so that after executing the commands, the robot will return to the original cell of its path (0,0). Of course, an obstacle cannot be placed in the starting cell (0,0). It is guaranteed that if the obstacle is not placed, then the robot will not return to the starting cell.An obstacle affects the movement of the robot in the following way: if it tries to go in a certain direction, and there is an obstacle, then it simply remains in place (the obstacle also remains, that is, it does not disappear).Find any such cell of the field (other than (0,0)) that if you put an obstacle there, the robot will return to the cell (0,0) after the execution of all commands. If there is no solution, then report it."              
                                  2500.0 1468I "Plane Tiling" geometry,implementation,math "You are given five integers n, dx1, dy1, dx2 and dy2. You have to select n distinct pairs of integers (xi,yi) in such a way that, for every possible pair of integers (x,y), there exists exactly one triple of integers (a,b,i) meeting the following constraints: {x=xi+a\xe2\x8b\x85dx1+b\xe2\x8b\x85dx2,y=yi+a\xe2\x8b\x85dy1+b\xe2\x8b\x85dy2."              
                                  2200.0 1468H "K and Medians" "constructive algorithms,greedy,math" "Let\'s denote the median of a sequence s with odd length as the value in the middle of s if we sort s in non-decreasing order. For example, let s=[1,2,5,7,2,3,12]. After sorting, we get sequence [1,2,2,3_,5,7,12], and the median is equal to 3.You have a sequence of n integers [1,2,\xe2\x80\xa6,n] and an odd integer k.In one step, you choose any k elements from the sequence and erase all chosen elements except their median. These elements do not have to go continuously (gaps are allowed between them).For example, if you have a sequence [1,2,3,4,5,6,7] (i.e. n=7) and k=3, then the following options for the first step are possible:  choose [1,2_,3]; 2 is their median, so it is not erased, and the resulting sequence is [2,4,5,6,7];  choose [2,4_,6]; 4 is their median, so it is not erased, and the resulting sequence is [1,3,4,5,7];  choose [1,6_,7]; 6 is their median, so it is not erased, and the resulting sequence is [2,3,4,5,6];  and several others. You can do zero or more steps. Can you get a sequence b1, b2, ..., bm after several steps?You\'ll be given t test cases. Solve each test case independently."              
                                  3500.0 1464F "My Beautiful Madness" "data structures,trees" "You are given a tree. We will consider simple paths on it. Let\'s denote path between vertices a and b as (a,b). Let d-neighborhood of a path be a set of vertices of the tree located at a distance \xe2\x89\xa4d from at least one vertex of the path (for example, 0-neighborhood of a path is a path itself). Let P be a multiset of the tree paths. Initially, it is empty. You are asked to maintain the following queries:  1 u v \xe2\x80\x94 add path (u,v) into P (1\xe2\x89\xa4u,v\xe2\x89\xa4n).  2 u v \xe2\x80\x94 delete path (u,v) from P (1\xe2\x89\xa4u,v\xe2\x89\xa4n). Notice that (u,v) equals to (v,u). For example, if P={(1,2),(1,2)}, than after query 2 2 1, P={(1,2)}.  3 d \xe2\x80\x94 if intersection of all d-neighborhoods of paths from P is not empty output ""Yes"", otherwise output ""No"" (0\xe2\x89\xa4d\xe2\x89\xa4n\xe2\x88\x921)."              
                                  2700.0 1461F "Mathematical Expression" "constructive algorithms,dp,greedy" "Barbara was late for her math class so as a punishment the teacher made her solve the task on a sheet of paper. Barbara looked at the sheet of paper and only saw n numbers a1,a2,\xe2\x80\xa6,an without any mathematical symbols. The teacher explained to Barbara that she has to place the available symbols between the numbers in a way that would make the resulting expression\'s value as large as possible. To find out which symbols were available the teacher has given Barbara a string s which contained that information.  It\'s easy to notice that Barbara has to place n\xe2\x88\x921 symbols between numbers in total. The expression must start with a number and all symbols must be allowed (i.e. included in s). Note that multiplication takes precedence over addition or subtraction, addition and subtraction have the same priority and performed from left to right. Help Barbara and create the required expression!"              
                                  800.0 1461A "String Generation" "constructive algorithms,greedy" "One fall day Joe got bored because he couldn\'t find himself something interesting to do. Marty suggested Joe to generate a string of length n to entertain him somehow. It didn\'t seem particularly difficult, but Joe\'s generated string had to follow these rules:  the string may only contain characters \'a\', \'b\', or \'c\';  the maximum length of a substring of this string that is a palindrome does not exceed k.   A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end. For example, strings ""a"", ""bc"", ""abc"" are substrings of a string ""abc"", while strings ""ac"", ""ba"", ""cba"" are not.A string is a palindrome if it reads the same from the left to the right and from the right to the left. For example, strings ""abccba"", ""abbba"", ""aba"", ""abacaba"", ""a"", and ""bacab"" are palindromes, while strings ""abcbba"", ""abb"", and ""ab"" are not.Now Joe wants to find any correct string. Help him! It can be proven that the answer always exists under the given constraints."              
                                  800.0 1459A "Red-Blue Shuffle" math,probabilities "There are n cards numbered 1,\xe2\x80\xa6,n. The card i has a red digit ri and a blue digit bi written on it.We arrange all n cards in random order from left to right, with all permutations of 1,\xe2\x80\xa6,n having the same probability. We then read all red digits on the cards from left to right, and obtain an integer R. In the same way, we read all blue digits and obtain an integer B. When reading a number, leading zeros can be ignored. If all digits in a number are zeros, then the number is equal to 0. Below is an illustration of a possible rearrangement of three cards, and how R and B can be found.  Two players, Red and Blue, are involved in a bet. Red bets that after the shuffle R>B, and Blue bets that R<B. If in the end R=B, the bet results in a draw, and neither player wins.Determine, which of the two players is more likely (has higher probability) to win the bet, or that their chances are equal. Refer to the Note section for a formal discussion of comparing probabilities."              
                                  1600.0 1458A "Row GCD" "math,number theory" "You are given two positive integer sequences a1,\xe2\x80\xa6,an and b1,\xe2\x80\xa6,bm. For each j=1,\xe2\x80\xa6,m find the greatest common divisor of a1+bj,\xe2\x80\xa6,an+bj."              
                                  800.0 1453A "Cancel the Trains" implementation "Gildong\'s town has a train system that has 100 trains that travel from the bottom end to the top end and 100 trains that travel from the left end to the right end. The trains starting from each side are numbered from 1 to 100, respectively, and all trains have the same speed. Let\'s take a look at the picture below.  The train system can be represented as coordinates on a 2D plane. The i-th train starting at the bottom end is initially at (i,0) and will be at (i,T) after T minutes, and the i-th train starting at the left end is initially at (0,i) and will be at (T,i) after T minutes. All trains arrive at their destinations after 101 minutes.However, Gildong found that some trains scheduled to depart at a specific time, simultaneously, are very dangerous. At this time, n trains are scheduled to depart from the bottom end and m trains are scheduled to depart from the left end. If two trains are both at (x,y) at the same time for some x and y, they will crash into each other. Therefore, he is asking you to find the minimum number of trains that should be cancelled to prevent all such crashes."              
                                  1400.0 1452B "Toy Blocks" "binary search,greedy,math,sortings" "You are asked to watch your nephew who likes to play with toy blocks in a strange way.He has n boxes and the i-th box has ai blocks. His game consists of two steps:   he chooses an arbitrary box i;  he tries to move all blocks from the i-th box to other boxes.  If he can make the same number of blocks in each of n\xe2\x88\x921 other boxes then he will be happy, otherwise, will be sad. Note that your nephew can only move the blocks from the chosen box to the other boxes; he cannot move blocks from the other boxes.You don\'t want to make your nephew sad, so you decided to put several extra blocks into some boxes in such a way that no matter which box i he chooses he won\'t be sad. What is the minimum number of extra blocks you need to put?"              
                                  2000.0 1451E1 "Bitwise Queries (Easy Version)" "bitmasks,constructive algorithms,interactive,math" "The only difference between the easy and hard versions is the constraints on the number of queries.This is an interactive problem.Ridbit has a hidden array a of n integers which he wants Ashish to guess. Note that n is a power of two. Ashish is allowed to ask three different types of queries. They are of the form   AND i j: ask for the bitwise AND of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j)  OR i j: ask for the bitwise OR of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j)  XOR i j: ask for the bitwise XOR of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j) Can you help Ashish guess the elements of the array?In this version, each element takes a value in the range [0,n\xe2\x88\x921] (inclusive) and Ashish can ask no more than n+2 queries."              
                                  1700.0 1451D "Circle Game" games,geometry,math "Utkarsh is forced to play yet another one of Ashish\'s games. The game progresses turn by turn and as usual, Ashish moves first.Consider the 2D plane. There is a token which is initially at (0,0). In one move a player must increase either the x coordinate or the y coordinate of the token by exactly k. In doing so, the player must ensure that the token stays within a (Euclidean) distance d from (0,0).In other words, if after a move the coordinates of the token are (p,q), then p2+q2\xe2\x89\xa4d2 must hold.The game ends when a player is unable to make a move. It can be shown that the game will end in a finite number of moves. If both players play optimally, determine who will win."              
                                  3000.0 1446D2 "Frequency Problem (Hard Version)" "data structures,greedy,two pointers" "This is the hard version of the problem. The difference between the versions is in the constraints on the array elements. You can make hacks only if all versions of the problem are solved.You are given an array [a1,a2,\xe2\x80\xa6,an]. Your goal is to find the length of the longest subarray of this array such that the most frequent value in it is not unique. In other words, you are looking for a subarray such that if the most frequent value occurs f times in this subarray, then at least 2 different values should occur exactly f times.An array c is a subarray of an array d if c can be obtained from d by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end."              
                                  2900.0 1444D "Rectangular Polyline" "constructive algorithms,dp,geometry" "One drew a closed polyline on a plane, that consisted only of vertical and horizontal segments (parallel to the coordinate axes). The segments alternated between horizontal and vertical ones (a horizontal segment was always followed by a vertical one, and vice versa). The polyline did not contain strict self-intersections, which means that in case any two segments shared a common point, that point was an endpoint for both of them (please consult the examples in the notes section).Unfortunately, the polyline was erased, and you only know the lengths of the horizonal and vertical segments. Please construct any polyline matching the description with such segments, or determine that it does not exist."              
                                  3500.0 1439E "Cheat and Win" "bitmasks,data structures,games,trees" "Let\'s consider a (109+1)\xc3\x97(109+1) field. The rows are numbered with integers from 0 to 109 and the columns are numbered with integers from 0 to 109. Let\'s define as (x,y) the cell located in the x-th row and y-th column.Let\'s call a cell (x,y) good if x&y=0, there & is the bitwise and operation.Let\'s build a graph where vertices will be all good cells of the field and we will make an edge between all pairs of adjacent by side good cells. It can be proved that this graph will be a tree \xe2\x80\x94 connected graph without cycles. Let\'s hang this tree on vertex (0,0), so we will have a rooted tree with root (0,0).Two players will play the game. Initially, some good cells are black and others are white. Each player on his turn chooses a black good cell and a subset of its ancestors (possibly empty) and inverts their colors (from white to black and vice versa). The player who can\'t move (because all good cells are white) loses. It can be proved that the game is always finite.Initially, all cells are white. You are given m pairs of cells. For each pair color all cells in a simple path between them as black. Note that we do not invert their colors, we paint them black.Sohrab and Mashtali are going to play this game. Sohrab is the first player and Mashtali is the second.Mashtali wants to win and decided to cheat. He can make the following operation multiple times before the game starts: choose a cell and invert colors of all vertices on the path between it and the root of the tree.Mammad who was watching them wondered: ""what is the minimum number of operations Mashtali should do to have a winning strategy?"".Find the answer to this question for the initial painting of the tree. It can be proved that at least one possible way to cheat always exists."              
                                  1800.0 1437C "Chef Monocarp" "dp,flows,graph matchings,greedy,math,sortings" "Chef Monocarp has just put n dishes into an oven. He knows that the i-th dish has its optimal cooking time equal to ti minutes.At any positive integer minute T Monocarp can put no more than one dish out of the oven. If the i-th dish is put out at some minute T, then its unpleasant value is |T\xe2\x88\x92ti| \xe2\x80\x94 the absolute difference between T and ti. Once the dish is out of the oven, it can\'t go back in.Monocarp should put all the dishes out of the oven. What is the minimum total unpleasant value Monocarp can obtain?"              
                                  1500.0 1436C "Binary Search" "binary search,combinatorics" "Andrey thinks he is truly a successful developer, but in reality he didn\'t know about the binary search algorithm until recently. After reading some literature Andrey understood that this algorithm allows to quickly find a certain number x in an array. For an array a indexed from zero, and an integer x the pseudocode of the algorithm is as follows:  Note that the elements of the array are indexed from zero, and the division is done in integers (rounding down).Andrey read that the algorithm only works if the array is sorted. However, he found this statement untrue, because there certainly exist unsorted arrays for which the algorithm find x!Andrey wants to write a letter to the book authors, but before doing that he must consider the permutations of size n such that the algorithm finds x in them. A permutation of size n is an array consisting of n distinct integers between 1 and n in arbitrary order.Help Andrey and find the number of permutations of size n which contain x at position pos and for which the given implementation of the binary search algorithm finds x (returns true). As the result may be extremely large, print the remainder of its division by 109+7."              
                                  2100.0 1433F "Zero Remainder Sum" dp "You are given a matrix a of size n\xc3\x97m consisting of integers.You can choose no more than \xe2\x8c\x8am2\xe2\x8c\x8b elements in each row. Your task is to choose these elements in such a way that their sum is divisible by k and this sum is the maximum.In other words, you can choose no more than a half (rounded down) of elements in each row, you have to find the maximum sum of these elements divisible by k.Note that you can choose zero elements (and the sum of such set is 0)."              
                                  800.0 1433B "Yet Another Bookshelf" greedy,implementation "There is a bookshelf which can fit n books. The i-th position of bookshelf is ai=1 if there is a book on this position and ai=0 otherwise. It is guaranteed that there is at least one book on the bookshelf.In one move, you can choose some contiguous segment [l;r] consisting of books (i.e. for each i from l to r the condition ai=1 holds) and:  Shift it to the right by 1: move the book at index i to i+1 for all l\xe2\x89\xa4i\xe2\x89\xa4r. This move can be done only if r+1\xe2\x89\xa4n and there is no book at the position r+1.  Shift it to the left by 1: move the book at index i to i\xe2\x88\x921 for all l\xe2\x89\xa4i\xe2\x89\xa4r. This move can be done only if l\xe2\x88\x921\xe2\x89\xa51 and there is no book at the position l\xe2\x88\x921. Your task is to find the minimum number of moves required to collect all the books on the shelf as a contiguous (consecutive) segment (i.e. the segment without any gaps).For example, for a=[0,0,1,0,1] there is a gap between books (a4=0 when a3=1 and a5=1), for a=[1,1,0] there are no gaps between books and for a=[0,0,0] there are also no gaps between books.You have to answer t independent test cases."              
                                  2300.0 1425D "Danger of Mad Snakes" combinatorics,dp,math "Mr. Chanek The Ninja is one day tasked with a mission to handle mad snakes that are attacking a site. Now, Mr. Chanek already arrived at the hills where the destination is right below these hills. The mission area can be divided into a grid of size 1000\xc3\x971000 squares. There are N mad snakes on the site, the i\'th mad snake is located on square (Xi,Yi) and has a danger level Bi.Mr. Chanek is going to use the Shadow Clone Jutsu and Rasengan that he learned from Lord Seventh to complete this mission. His attack strategy is as follows:  Mr. Chanek is going to make M clones.  Each clone will choose a mad snake as the attack target. Each clone must pick a different mad snake to attack.  All clones jump off the hills and attack their respective chosen target at once with Rasengan of radius R. If the mad snake at square (X,Y) is attacked with a direct Rasengan, it and all mad snakes at squares (X\xe2\x80\xb2,Y\xe2\x80\xb2) where max(|X\xe2\x80\xb2\xe2\x88\x92X|,|Y\xe2\x80\xb2\xe2\x88\x92Y|)\xe2\x89\xa4R will die.  The real Mr. Chanek will calculate the score of this attack. The score is defined as the square of the sum of the danger levels of all the killed snakes. Now Mr. Chanek is curious, what is the sum of scores for every possible attack strategy? Because this number can be huge, Mr. Chanek only needs the output modulo 109+7."              
                                  3500.0 1423N "BubbleSquare Tokens"  "BubbleSquare social network is celebrating 13th anniversary and it is rewarding its members with special edition BubbleSquare tokens. Every member receives one personal token. Also, two additional tokens are awarded to each member for every friend they have on the network. Yet, there is a twist \xe2\x80\x93 everyone should end up with different number of tokens from all their friends. Each member may return one received token. Also, each two friends may agree to each return one or two tokens they have obtained on behalf of their friendship."              
                                  2400.0 1423J "Bubble Cup hypothesis" "bitmasks,constructive algorithms,dp,math" "The Bubble Cup hypothesis stood unsolved for 130 years. Who ever proves the hypothesis will be regarded as one of the greatest mathematicians of our time! A famous mathematician Jerry Mao managed to reduce the hypothesis to this problem:Given a number m, how many polynomials P with coefficients in set {0,1,2,3,4,5,6,7} have: P(2)=m?Help Jerry Mao solve the long standing problem!"              
                                  1900.0 1423B "Valuable Paper" "binary search,flows,graph matchings,graphs" "The pandemic is upon us, and the world is in shortage of the most important resource: toilet paper. As one of the best prepared nations for this crisis, BubbleLand promised to help all other world nations with this valuable resource. To do that, the country will send airplanes to other countries carrying toilet paper.In BubbleLand, there are N toilet paper factories, and N airports. Because of how much it takes to build a road, and of course legal issues, every factory must send paper to only one airport, and every airport can only take toilet paper from one factory.Also, a road can\'t be built between all airport-factory pairs, again because of legal issues. Every possible road has number d given, number of days it takes to build that road.Your job is to choose N factory-airport pairs, such that if the country starts building all roads at the same time, it takes the least amount of days to complete them."              
                                  800.0 1422A Fence geometry,math "Yura is tasked to build a closed fence in shape of an arbitrary non-degenerate simple quadrilateral. He\'s already got three straight fence segments with known lengths a, b, and c. Now he needs to find out some possible integer length d of the fourth straight fence segment so that he can build the fence using these four segments. In other words, the fence should have a quadrilateral shape with side lengths equal to a, b, c, and d. Help Yura, find any possible length of the fourth side.A non-degenerate simple quadrilateral is such a quadrilateral that no three of its corners lie on the same line, and it does not cross itself."              
                                  1900.0 1421D Hexagons "brute force,constructive algorithms,greedy,implementation,math,shortest paths" "Lindsey Buckingham told Stevie Nicks ""Go your own way"". Nicks is now sad and wants to go away as quickly as possible, but she lives in a 2D hexagonal world.Consider a hexagonal tiling of the plane as on the picture below.  Nicks wishes to go from the cell marked (0,0) to a certain cell given by the coordinates. She may go from a hexagon to any of its six neighbors you want, but there is a cost associated with each of them. The costs depend only on the direction in which you travel. Going from (0,0) to (1,1) will take the exact same cost as going from (\xe2\x88\x922,\xe2\x88\x921) to (\xe2\x88\x921,0). The costs are given in the input in the order c1, c2, c3, c4, c5, c6 as in the picture below.  Print the smallest cost of a path from the origin which has coordinates (0,0) to the given cell."              
                                  2100.0 1420C2 "Pok\xc3\xa9mon Army (hard version)" "data structures,divide and conquer,dp,greedy,implementation" "This is the hard version of the problem. The difference between the versions is that the easy version has no swap operations. You can make hacks only if all versions of the problem are solved.Pikachu is a cute and friendly pok\xc3\xa9mon living in the wild pikachu herd.But it has become known recently that infamous team R wanted to steal all these pok\xc3\xa9mon! Pok\xc3\xa9mon trainer Andrew decided to help Pikachu to build a pok\xc3\xa9mon army to resist.First, Andrew counted all the pok\xc3\xa9mon \xe2\x80\x94 there were exactly n pikachu. The strength of the i-th pok\xc3\xa9mon is equal to ai, and all these numbers are distinct.As an army, Andrew can choose any non-empty subsequence of pokemons. In other words, Andrew chooses some array b from k indices such that 1\xe2\x89\xa4b1<b2<\xe2\x8b\xaf<bk\xe2\x89\xa4n, and his army will consist of pok\xc3\xa9mons with forces ab1,ab2,\xe2\x80\xa6,abk.The strength of the army is equal to the alternating sum of elements of the subsequence; that is, ab1\xe2\x88\x92ab2+ab3\xe2\x88\x92ab4+\xe2\x80\xa6.Andrew is experimenting with pok\xc3\xa9mon order. He performs q operations. In i-th operation Andrew swaps li-th and ri-th pok\xc3\xa9mon.Andrew wants to know the maximal stregth of the army he can achieve with the initial pok\xc3\xa9mon placement. He also needs to know the maximal strength after each operation.Help Andrew and the pok\xc3\xa9mon, or team R will realize their tricky plan!"              
                                  2800.0 1419F "Rain of Fire" "binary search,data structures,dfs and similar,dsu,graphs,implementation" "There are n detachments on the surface, numbered from 1 to n, the i-th detachment is placed in a point with coordinates (xi,yi). All detachments are placed in different points.Brimstone should visit each detachment at least once. You can choose the detachment where Brimstone starts.To move from one detachment to another he should first choose one of four directions of movement (up, right, left or down) and then start moving with the constant speed of one unit interval in a second until he comes to a detachment. After he reaches an arbitrary detachment, he can repeat the same process.Each t seconds an orbital strike covers the whole surface, so at that moment Brimstone should be in a point where some detachment is located. He can stay with any detachment as long as needed.Brimstone is a good commander, that\'s why he can create at most one detachment and place it in any empty point with integer coordinates he wants before his trip. Keep in mind that Brimstone will need to visit this detachment, too.Help Brimstone and find such minimal t that it is possible to check each detachment. If there is no such t report about it."              
                                  1500.0 1419D2 "Sage\'s Birthday (hard version)" "binary search,brute force,constructive algorithms,greedy,sortings,two pointers" "This is the hard version of the problem. The difference between the versions is that in the easy version all prices ai are different. You can make hacks if and only if you solved both versions of the problem.Today is Sage\'s birthday, and she will go shopping to buy ice spheres. All n ice spheres are placed in a row and they are numbered from 1 to n from left to right. Each ice sphere has a positive integer price. In this version, some prices can be equal.An ice sphere is cheap if it costs strictly less than two neighboring ice spheres: the nearest to the left and the nearest to the right. The leftmost and the rightmost ice spheres are not cheap. Sage will choose all cheap ice spheres and then buy only them.You can visit the shop before Sage and reorder the ice spheres as you wish. Find out the maximum number of ice spheres that Sage can buy, and show how the ice spheres should be reordered."              
                                  1500.0 1419C Killjoy greedy,implementation,math "A new agent called Killjoy invented a virus COVID-2069 that infects accounts on Codeforces. Each account has a rating, described by an integer (it can possibly be negative or very large).Killjoy\'s account is already infected and has a rating equal to x. Its rating is constant. There are n accounts except hers, numbered from 1 to n. The i-th account\'s initial rating is ai. Any infected account (initially the only infected account is Killjoy\'s) instantly infects any uninfected account if their ratings are equal. This can happen at the beginning (before any rating changes) and after each contest. If an account is infected, it can not be healed.Contests are regularly held on Codeforces. In each contest, any of these n accounts (including infected ones) can participate. Killjoy can\'t participate. After each contest ratings are changed this way: each participant\'s rating is changed by an integer, but the sum of all changes must be equal to zero. New ratings can be any integer.Find out the minimal number of contests needed to infect all accounts. You can choose which accounts will participate in each contest and how the ratings will change.It can be proven that all accounts can be infected in some finite number of contests."              
                                  2400.0 1418E "Expected Damage" "binary search,combinatorics,probabilities" "You are playing a computer game. In this game, you have to fight n monsters.To defend from monsters, you need a shield. Each shield has two parameters: its current durability a and its defence rating b. Each monster has only one parameter: its strength d.When you fight a monster with strength d while having a shield with current durability a and defence b, there are three possible outcomes:  if a=0, then you receive d damage;  if a>0 and d\xe2\x89\xa5b, you receive no damage, but the current durability of the shield decreases by 1;  if a>0 and d<b, nothing happens. The i-th monster has strength di, and you will fight each of the monsters exactly once, in some random order (all n! orders are equiprobable). You have to consider m different shields, the i-th shield has initial durability ai and defence rating bi. For each shield, calculate the expected amount of damage you will receive if you take this shield and fight the given n monsters in random order."              
                                  2600.0 1416D "Graph and Queries" "data structures,dsu,graphs,implementation,trees" "You are given an undirected graph consisting of n vertices and m edges. Initially there is a single integer written on every vertex: the vertex i has pi written on it. All pi are distinct integers from 1 to n.You have to process q queries of two types:  1 v \xe2\x80\x94 among all vertices reachable from the vertex v using the edges of the graph (including the vertex v itself), find a vertex u with the largest number pu written on it, print pu and replace pu with 0;  2 i \xe2\x80\x94 delete the i-th edge from the graph.  Note that, in a query of the first type, it is possible that all vertices reachable from v have 0 written on them. In this case, u is not explicitly defined, but since the selection of u does not affect anything, you can choose any vertex reachable from v and print its value (which is 0)."              
                                  2000.0 1415D XOR-gun "bitmasks,brute force,constructive algorithms" "Arkady owns a non-decreasing array a1,a2,\xe2\x80\xa6,an. You are jealous of its beauty and want to destroy this property. You have a so-called XOR-gun that you can use one or more times.In one step you can select two consecutive elements of the array, let\'s say x and y, remove them from the array and insert the integer x\xe2\x8a\x95y on their place, where \xe2\x8a\x95 denotes the bitwise XOR operation. Note that the length of the array decreases by one after the operation. You can\'t perform this operation when the length of the array reaches one.For example, if the array is [2,5,6,8], you can select 5 and 6 and replace them with 5\xe2\x8a\x956=3. The array becomes [2,3,8].You want the array no longer be non-decreasing. What is the minimum number of steps needed? If the array stays non-decreasing no matter what you do, print \xe2\x88\x921."              
                                  1100.0 1415B "Repainting Street" "brute force,brute force,greedy" "There is a street with n houses in a line, numbered from 1 to n. The house i is initially painted in color ci. The street is considered beautiful if all houses are painted in the same color. Tom, the painter, is in charge of making the street beautiful. Tom\'s painting capacity is defined by an integer, let\'s call it k.On one day, Tom can do the following repainting process that consists of two steps:   He chooses two integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and r\xe2\x88\x92l+1=k.  For each house i such that l\xe2\x89\xa4i\xe2\x89\xa4r, he can either repaint it with any color he wants, or ignore it and let it keep its current color. Note that in the same day Tom can use different colors to repaint different houses.Tom wants to know the minimum number of days needed to repaint the street so that it becomes beautiful."              
                                  800.0 1415A "Prison Break" "brute force,math" "There is a prison that can be represented as a rectangular matrix with n rows and m columns. Therefore, there are n\xe2\x8b\x85m prison cells. There are also n\xe2\x8b\x85m prisoners, one in each prison cell. Let\'s denote the cell in the i-th row and the j-th column as (i,j).There\'s a secret tunnel in the cell (r,c), that the prisoners will use to escape! However, to avoid the risk of getting caught, they will escape at night.Before the night, every prisoner is in his own cell. When night comes, they can start moving to adjacent cells. Formally, in one second, a prisoner located in cell (i,j) can move to cells (i\xe2\x88\x921,j) , (i+1,j) , (i,j\xe2\x88\x921) , or (i,j+1), as long as the target cell is inside the prison. They can also choose to stay in cell (i,j).The prisoners want to know the minimum number of seconds needed so that every prisoner can arrive to cell (r,c) if they move optimally. Note that there can be any number of prisoners in the same cell at the same time."              
                                  2800.0 1413F "Roads and Ramen" "data structures,trees" "In the Land of Fire there are n villages and n\xe2\x88\x921 bidirectional road, and there is a path between any pair of villages by roads. There are only two types of roads: stone ones and sand ones. Since the Land of Fire is constantly renovating, every morning workers choose a single road and flip its type (so it becomes a stone road if it was a sand road and vice versa). Also everyone here loves ramen, that\'s why every morning a ramen pavilion is set in the middle of every stone road, and at the end of each day all the pavilions are removed.For each of the following m days, after another road is flipped, Naruto and Jiraiya choose a simple path \xe2\x80\x94 that is, a route which starts in a village and ends in a (possibly, the same) village, and doesn\'t contain any road twice. Since Naruto and Jiraiya also love ramen very much, they buy a single cup of ramen on each stone road and one of them eats it. Since they don\'t want to offend each other, they only choose routes where they can eat equal number of ramen cups. Since they both like traveling, they choose any longest possible path. After every renovation find the maximal possible length of a path (that is, the number of roads in it) they can follow."              
                                  800.0 1409A "Yet Another Two Integers Problem" greedy,math "You are given two integers a and b.In one move, you can choose some integer k from 1 to 10 and add it to a or subtract it from a. In other words, you choose an integer k\xe2\x88\x88[1;10] and perform a:=a+k or a:=a\xe2\x88\x92k. You may use different values of k in different moves.Your task is to find the minimum number of moves required to obtain b from a.You have to answer t independent test cases."              
                                  2000.0 1408D Searchlights "binary search,brute force,data structures,dp,implementation,sortings,two pointers" "There are n robbers at coordinates (a1,b1), (a2,b2), ..., (an,bn) and m searchlight at coordinates (c1,d1), (c2,d2), ..., (cm,dm). In one move you can move each robber to the right (increase ai of each robber by one) or move each robber up (increase bi of each robber by one). Note that you should either increase all ai or all bi, you can\'t increase ai for some points and bi for some other points.Searchlight j can see a robber i if ai\xe2\x89\xa4cj and bi\xe2\x89\xa4dj. A configuration of robbers is safe if no searchlight can see a robber (i.e. if there is no pair i,j such that searchlight j can see a robber i).What is the minimum number of moves you need to perform to reach a safe configuration?"              
                                  1500.0 1404A "Balanced Bitstring" implementation,strings "A bitstring is a string consisting only of the characters 0 and 1. A bitstring is called k-balanced if every substring of size k of this bitstring has an equal amount of 0 and 1 characters (k2 of each).You are given an integer k and a string s which is composed only of characters 0, 1, and ?. You need to determine whether you can make a k-balanced bitstring by replacing every ? characters in s with either 0 or 1.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end."              
                                  2900.0 1402B Roads "*special problem,geometry,sortings" "The government of Treeland wants to build a new road network. There are 2N cities in Treeland. The unfinished plan of the road network already contains N road segments, each of which connects two cities with a straight line. No two road segments have a common point (including their endpoints).  Your task is to determine N\xe2\x88\x921 additional road segments satisfying the following conditions:   Every new road segment must connect two cities with a straight line.  If two segments (new or old) have a common point, then this point must be an endpoint of both segments.  The road network connects all cities: for each pair of cities there is a path consisting of segments that connects the two cities."              
                                  2600.0 1400G Mercenaries "bitmasks,brute force,combinatorics,dp,dsu,math,two pointers" "Polycarp plays a (yet another!) strategic computer game. In this game, he leads an army of mercenaries.Polycarp wants to gather his army for a quest. There are n mercenaries for hire, and the army should consist of some subset of them.The i-th mercenary can be chosen if the resulting number of chosen mercenaries is not less than li (otherwise he deems the quest to be doomed) and not greater than ri (he doesn\'t want to share the trophies with too many other mercenaries). Furthermore, m pairs of mercenaries hate each other and cannot be chosen for the same quest. How many non-empty subsets does Polycarp need to consider? In other words, calculate the number of non-empty subsets of mercenaries such that the size of this subset belongs to [li,ri] for each chosen mercenary, and there are no two mercenaries in the subset that hate each other.The answer may be large, so calculate it modulo 998244353."              
                                  1500.0 1397B "Power Sequence" "brute force,math,number theory,sortings" "Let\'s call a list of positive integers a0,a1,...,an\xe2\x88\x921 a power sequence if there is a positive integer c, so that for every 0\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 then ai=ci.Given a list of n positive integers a0,a1,...,an\xe2\x88\x921, you are allowed to:  Reorder the list (i.e. pick a permutation p of {0,1,...,n\xe2\x88\x921} and change ai to api), then  Do the following operation any number of times: pick an index i and change ai to ai\xe2\x88\x921 or ai+1 (i.e. increment or decrement ai by 1) with a cost of 1. Find the minimum cost to transform a0,a1,...,an\xe2\x88\x921 into a power sequence."              
                                  1600.0 1396A "Multiples of Length" "constructive algorithms,greedy,number theory" "You are given an array a of n integers.You want to make all elements of a equal to zero by doing the following operation exactly three times:  Select a segment, for each number in this segment we can add a multiple of len to it, where len is the length of this segment (added integers can be different). It can be proven that it is always possible to make all elements of a equal to zero."              
                                  800.0 1393A "Rainbow Dash, Fluttershy and Chess Coloring" greedy,math "One evening Rainbow Dash and Fluttershy have come up with a game. Since the ponies are friends, they have decided not to compete in the game but to pursue a common goal. The game starts on a square flat grid, which initially has the outline borders built up. Rainbow Dash and Fluttershy have flat square blocks with size 1\xc3\x971, Rainbow Dash has an infinite amount of light blue blocks, Fluttershy has an infinite amount of yellow blocks. The blocks are placed according to the following rule: each newly placed block must touch the built on the previous turns figure by a side (note that the outline borders of the grid are built initially). At each turn, one pony can place any number of blocks of her color according to the game rules.Rainbow and Fluttershy have found out that they can build patterns on the grid of the game that way. They have decided to start with something simple, so they made up their mind to place the blocks to form a chess coloring. Rainbow Dash is well-known for her speed, so she is interested in the minimum number of turns she and Fluttershy need to do to get a chess coloring, covering the whole grid with blocks. Please help her find that number!Since the ponies can play many times on different boards, Rainbow Dash asks you to find the minimum numbers of turns for several grids of the games.The chess coloring in two colors is the one in which each square is neighbor by side only with squares of different colors."              
                                  2100.0 1392E "Omkar and Duck" "bitmasks,constructive algorithms,interactive,math" "This is an interactive problem.Omkar has just come across a duck! The duck is walking on a grid with n rows and n columns (2\xe2\x89\xa4n\xe2\x89\xa425) so that the grid contains a total of n2 cells. Let\'s denote by (x,y) the cell in the x-th row from the top and the y-th column from the left. Right now, the duck is at the cell (1,1) (the cell in the top left corner) and would like to reach the cell (n,n) (the cell in the bottom right corner) by moving either down 1 cell or to the right 1 cell each second.Since Omkar thinks ducks are fun, he wants to play a game with you based on the movement of the duck. First, for each cell (x,y) in the grid, you will tell Omkar a nonnegative integer ax,y not exceeding 1016, and Omkar will then put ax,y uninteresting problems in the cell (x,y). After that, the duck will start their journey from (1,1) to (n,n). For each cell (x,y) that the duck crosses during their journey (including the cells (1,1) and (n,n)), the duck will eat the ax,y uninteresting problems in that cell. Once the duck has completed their journey, Omkar will measure their mass to determine the total number k of uninteresting problems that the duck ate on their journey, and then tell you k.Your challenge, given k, is to exactly reproduce the duck\'s path, i. e. to tell Omkar precisely which cells the duck crossed on their journey. To be sure of your mastery of this game, Omkar will have the duck complete q different journeys (1\xe2\x89\xa4q\xe2\x89\xa4103). Note that all journeys are independent: at the beginning of each journey, the cell (x,y) will still contain ax,y uninteresting tasks."              
                                  1500.0 1391C "Cyclic Permutations" combinatorics,dp,graphs,math "A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).Consider a permutation p of length n, we build a graph of size n using it as follows:   For every 1\xe2\x89\xa4i\xe2\x89\xa4n, find the largest j such that 1\xe2\x89\xa4j<i and pj>pi, and add an undirected edge between node i and node j  For every 1\xe2\x89\xa4i\xe2\x89\xa4n, find the smallest j such that i<j\xe2\x89\xa4n and pj>pi, and add an undirected edge between node i and node j In cases where no such j exists, we make no edges. Also, note that we make edges between the corresponding indices, not the values at those indices.For clarity, consider as an example n=4, and p=[3,1,4,2]; here, the edges of the graph are (1,3),(2,1),(2,3),(4,3).A permutation p is cyclic if the graph built using p has at least one simple cycle. Given n, find the number of cyclic permutations of length n. Since the number may be very large, output it modulo 109+7.Please refer to the Notes section for the formal definition of a simple cycle"              
                                  800.0 1391A Suborrays "constructive algorithms,math" "A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).For a positive integer n, we call a permutation p of length n good if the following condition holds for every pair i and j (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n) \xe2\x80\x94   (pi OR pi+1 OR \xe2\x80\xa6 OR pj\xe2\x88\x921 OR pj)\xe2\x89\xa5j\xe2\x88\x92i+1, where OR denotes the bitwise OR operation. In other words, a permutation p is good if for every subarray of p, the OR of all elements in it is not less than the number of elements in that subarray. Given a positive integer n, output any good permutation of length n. We can show that for the given constraints such a permutation always exists."              
                                  2800.0 1389G "Directing Edges" "dfs and similar,dp,graphs,trees" "You are given an undirected connected graph consisting of n vertices and m edges. k vertices of this graph are special.You have to direct each edge of this graph or leave it undirected. If you leave the i-th edge undirected, you pay wi coins, and if you direct it, you don\'t have to pay for it.Let\'s call a vertex saturated if it is reachable from each special vertex along the edges of the graph (if an edge is undirected, it can be traversed in both directions). After you direct the edges of the graph (possibly leaving some of them undirected), you receive ci coins for each saturated vertex i. Thus, your total profit can be calculated as \xe2\x88\x91i\xe2\x88\x88Sci\xe2\x88\x92\xe2\x88\x91j\xe2\x88\x88Uwj, where S is the set of saturated vertices, and U is the set of edges you leave undirected.For each vertex i, calculate the maximum possible profit you can get if you have to make the vertex i saturated."              
                                  1800.0 1388C "Uncle Bogdan and Country Happiness" "dfs and similar,greedy,math,trees" "Uncle Bogdan is in captain Flint\'s crew for a long time and sometimes gets nostalgic for his homeland. Today he told you how his country introduced a happiness index.There are n cities and n\xe2\x88\x921 undirected roads connecting pairs of cities. Citizens of any city can reach any other city traveling by these roads. Cities are numbered from 1 to n and the city 1 is a capital. In other words, the country has a tree structure.There are m citizens living in the country. A pi people live in the i-th city but all of them are working in the capital. At evening all citizens return to their home cities using the shortest paths. Every person has its own mood: somebody leaves his workplace in good mood but somebody are already in bad mood. Moreover any person can ruin his mood on the way to the hometown. If person is in bad mood he won\'t improve it.Happiness detectors are installed in each city to monitor the happiness of each person who visits the city. The detector in the i-th city calculates a happiness index hi as the number of people in good mood minus the number of people in bad mood. Let\'s say for the simplicity that mood of a person doesn\'t change inside the city.Happiness detector is still in development, so there is a probability of a mistake in judging a person\'s happiness. One late evening, when all citizens successfully returned home, the government asked uncle Bogdan (the best programmer of the country) to check the correctness of the collected happiness indexes.Uncle Bogdan successfully solved the problem. Can you do the same?More formally, You need to check: ""Is it possible that, after all people return home, for each city i the happiness index will be equal exactly to hi""."              
                                  2500.0 1387B2 "Village (Maximum)" "*special problem,dfs and similar,trees" "This problem is split into two tasks. In this task, you are required to find the maximum possible answer. In the task Village (Minimum) you are required to find the minimum possible answer. Each task is worth 50 points.There are N houses in a certain village. A single villager lives in each of the houses. The houses are connected by roads. Each road connects two houses and is exactly 1 kilometer long. From each house it is possible to reach any other using one or several consecutive roads. In total there are N\xe2\x88\x921 roads in the village.One day all villagers decided to move to different houses \xe2\x80\x94 that is, after moving each house should again have a single villager living in it, but no villager should be living in the same house as before. We would like to know the largest possible total length in kilometers of the shortest paths between the old and the new houses for all villagers. Example village with seven houses For example, if there are seven houses connected by roads as shown on the figure, the largest total length is 18 km (this can be achieved by moving 1\xe2\x86\x927, 2\xe2\x86\x923, 3\xe2\x86\x924, 4\xe2\x86\x921, 5\xe2\x86\x922, 6\xe2\x86\x925, 7\xe2\x86\x926).Write a program that finds the largest total length of the shortest paths in kilometers and an example assignment of the new houses to the villagers."              
                                  2500.0 1381C Mastermind "constructive algorithms,graph matchings,greedy,implementation,sortings,two pointers" "In the game of Mastermind, there are two players  \xe2\x80\x94 Alice and Bob. Alice has a secret code, which Bob tries to guess. Here, a code is defined as a sequence of n colors. There are exactly n+1 colors in the entire universe, numbered from 1 to n+1 inclusive.When Bob guesses a code, Alice tells him some information about how good of a guess it is, in the form of two integers x and y.The first integer x is the number of indices where Bob\'s guess correctly matches Alice\'s code. The second integer y is the size of the intersection of the two codes as multisets. That is, if Bob were to change the order of the colors in his guess, y is the maximum number of indices he could get correct.For example, suppose n=5, Alice\'s code is [3,1,6,1,2], and Bob\'s guess is [3,1,1,2,5]. At indices 1 and 2 colors are equal, while in the other indices they are not equal. So x=2. And the two codes have the four colors 1,1,2,3 in common, so y=4.  Solid lines denote a matched color for the same index. Dashed lines denote a matched color at a different index. x is the number of solid lines, and y is the total number of lines. You are given Bob\'s guess and two values x and y. Can you find one possibility of Alice\'s code so that the values of x and y are correct?"              
                                  1200.0 1375B "Neighbor Grid" "constructive algorithms,greedy" "You are given a grid with n rows and m columns, where each cell has a non-negative integer written on it. We say the grid is good if for each cell the following condition holds: if it has a number k>0 written on it, then exactly k of its neighboring cells have a number greater than 0 written on them. Note that if the number in the cell is 0, there is no such restriction on neighboring cells.You are allowed to take any number in the grid and increase it by 1. You may apply this operation as many times as you want, to any numbers you want. Perform some operations (possibly zero) to make the grid good, or say that it is impossible. If there are multiple possible answers, you may find any of them.Two cells are considered to be neighboring if they have a common edge."              
                                  2400.0 1374F "Cyclic Shifts Sorting" "brute force,constructive algorithms,implementation,sortings" "You are given an array a consisting of n integers.In one move, you can choose some index i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922) and shift the segment [ai,ai+1,ai+2] cyclically to the right (i.e. replace the segment [ai,ai+1,ai+2] with [ai+2,ai,ai+1]). Your task is to sort the initial array by no more than n2 such operations or say that it is impossible to do that.You have to answer t independent test cases."              
                                  2800.0 1371F "Raging Thunder" "data structures,divide and conquer,implementation" "You are a warrior fighting against the machine god Thor.Thor challenge you to solve the following problem:There are n conveyors arranged in a line numbered with integers from 1 to n from left to right. Each conveyor has a symbol ""<"" or "">"". The initial state of the conveyor i is equal to the i-th character of the string s. There are n+1 holes numbered with integers from 0 to n. The hole 0 is on the left side of the conveyor 1, and for all i\xe2\x89\xa51 the hole i is on the right side of the conveyor i.When a ball is on the conveyor i, the ball moves by the next rules:If the symbol ""<"" is on the conveyor i, then:  If i=1, the ball falls into the hole 0.  If the symbol ""<"" is on the conveyor i\xe2\x88\x921, the ball moves to the conveyor i\xe2\x88\x921.  If the symbol "">"" is on the conveyor i\xe2\x88\x921, the ball falls into the hole i\xe2\x88\x921. If the symbol "">"" is on the conveyor i, then:  If i=n, the ball falls into the hole n.  If the symbol "">"" is on the conveyor i+1, the ball moves to the conveyor i+1.  If the symbol ""<"" is on the conveyor i+1, the ball falls into the hole i. You should answer next q queries, each query is defined by the pair of integers l,r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n):   First, for all conveyors l,l+1,...,r, the symbol ""<"" changes to "">"" and vice versa. These changes remain for the next queries.  After that, put one ball on each conveyor l,l+1,...,r. Then, each ball falls into some hole. Find the maximum number of balls in one hole. After the query all balls disappear and don\'t considered in the next queries."              
                                  800.0 1369A FashionabLee geometry,math "Lee is going to fashionably decorate his house for a party, using some regular convex polygons...Lee thinks a regular n-sided (convex) polygon is beautiful if and only if he can rotate it in such a way that at least one of its edges is parallel to the OX-axis and at least one of its edges is parallel to the OY-axis at the same time.Recall that a regular n-sided polygon is a convex polygon with n vertices such that all the edges and angles are equal.Now he is shopping: the market has t regular polygons. For each of them print YES if it is beautiful and NO otherwise."              
                                  1500.0 1368C "Even Picture" "constructive algorithms" "Leo Jr. draws pictures in his notebook with checkered sheets (that is, each sheet has a regular square grid printed on it). We can assume that the sheets are infinitely large in any direction.To draw a picture, Leo Jr. colors some of the cells on a sheet gray. He considers the resulting picture beautiful if the following conditions are satisfied: The picture is connected, that is, it is possible to get from any gray cell to any other by following a chain of gray cells, with each pair of adjacent cells in the path being neighbours (that is, sharing a side). Each gray cell has an even number of gray neighbours. There are exactly n gray cells with all gray neighbours. The number of other gray cells can be arbitrary (but reasonable, so that they can all be listed).Leo Jr. is now struggling to draw a beautiful picture with a particular choice of n. Help him, and provide any example of a beautiful picture.To output cell coordinates in your answer, assume that the sheet is provided with a Cartesian coordinate system such that one of the cells is chosen to be the origin (0,0), axes 0x and 0y are orthogonal and parallel to grid lines, and a unit step along any axis in any direction takes you to a neighbouring cell."              
                                  1800.0 1367D "Task On The Board" "constructive algorithms,greedy,implementation,sortings" "Polycarp wrote on the board a string s containing only lowercase Latin letters (\'a\'-\'z\'). This string is known for you and given in the input.After that, he erased some letters from the string s, and he rewrote the remaining letters in any order. As a result, he got some new string t. You have to find it with some additional information.Suppose that the string t has length m and the characters are numbered from left to right from 1 to m. You are given a sequence of m integers: b1,b2,\xe2\x80\xa6,bm, where bi is the sum of the distances |i\xe2\x88\x92j| from the index i to all such indices j that tj>ti (consider that \'a\'<\'b\'<...<\'z\'). In other words, to calculate bi, Polycarp finds all such indices j that the index j contains a letter that is later in the alphabet than ti and sums all the values |i\xe2\x88\x92j|.For example, if t = ""abzb"", then:  since t1=\'a\', all other indices contain letters which are later in the alphabet, that is: b1=|1\xe2\x88\x922|+|1\xe2\x88\x923|+|1\xe2\x88\x924|=1+2+3=6;  since t2=\'b\', only the index j=3 contains the letter, which is later in the alphabet, that is: b2=|2\xe2\x88\x923|=1;  since t3=\'z\', then there are no indexes j such that tj>ti, thus b3=0;  since t4=\'b\', only the index j=3 contains the letter, which is later in the alphabet, that is: b4=|4\xe2\x88\x923|=1. Thus, if t = ""abzb"", then b=[6,1,0,1].Given the string s and the array b, find any possible string t for which the following two requirements are fulfilled simultaneously:  t is obtained from s by erasing some letters (possibly zero) and then writing the rest in any order;  the array, constructed from the string t according to the rules above, equals to the array b specified in the input data."              
                                  2700.0 1366F "Jog Around The Graph" "binary search,dp,geometry,graphs" "You are given a simple weighted connected undirected graph, consisting of n vertices and m edges.A path in the graph of length k is a sequence of k+1 vertices v1,v2,\xe2\x80\xa6,vk+1 such that for each i (1\xe2\x89\xa4i\xe2\x89\xa4k) the edge (vi,vi+1) is present in the graph. A path from some vertex v also has vertex v1=v. Note that edges and vertices are allowed to be included in the path multiple times.The weight of the path is the total weight of edges in it.For each i from 1 to q consider a path from vertex 1 of length i of the maximum weight. What is the sum of weights of these q paths?Answer can be quite large, so print it modulo 109+7."              
                                  1700.0 1365D "Solve The Maze" "constructive algorithms,dfs and similar,dsu,graphs,greedy,implementation,shortest paths" "Vivek has encountered a problem. He has a maze that can be represented as an n\xc3\x97m grid. Each of the grid cells may represent the following:  Empty \xe2\x80\x94 \'.\'  Wall \xe2\x80\x94 \'#\'  Good person  \xe2\x80\x94 \'G\'  Bad person \xe2\x80\x94 \'B\' The only escape from the maze is at cell (n,m).A person can move to a cell only if it shares a side with their current cell and does not contain a wall. Vivek wants to block some of the empty cells by replacing them with walls in such a way, that all the good people are able to escape, while none of the bad people are able to. A cell that initially contains \'G\' or \'B\' cannot be blocked and can be travelled through.Help him determine if there exists a way to replace some (zero or more) empty cells with walls to satisfy the above conditions.It is guaranteed that the cell (n,m) is empty. Vivek can also block this cell."              
                                  1300.0 1365B "Trouble Sort" "constructive algorithms,implementation" "Ashish has n elements arranged in a line. These elements are represented by two integers ai \xe2\x80\x94 the value of the element and bi \xe2\x80\x94 the type of the element (there are only two possible types: 0 and 1). He wants to sort the elements in non-decreasing values of ai.He can perform the following operation any number of times:  Select any two elements i and j such that bi\xe2\x89\xa0bj and swap them. That is, he can only swap two elements of different types in one move. Tell him if he can sort the elements in non-decreasing values of ai after performing any number of operations."              
                                  2100.0 1364D "Ehab\'s Last Corollary" "constructive algorithms,dfs and similar,graphs,greedy,implementation,trees" "Given a connected undirected graph with n vertices and an integer k, you have to either:  either find an independent set that has exactly \xe2\x8c\x88k2\xe2\x8c\x89 vertices. or find a simple cycle of length at most k. An independent set is a set of vertices such that no two of them are connected by an edge. A simple cycle is a cycle that doesn\'t contain any vertex twice. I have a proof that for any input you can always solve at least one of these problems, but it\'s left as an exercise for the reader."              
                                  1200.0 1364A XXXXX "brute force,data structures,number theory,two pointers" "Ehab loves number theory, but for some reason he hates the number x. Given an array a, find the length of its longest subarray such that the sum of its elements isn\'t divisible by x, or determine that such subarray doesn\'t exist.An array a is a subarray of an array b if a can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end."              
                                  2000.0 1363E "Tree Shuffling" "dfs and similar,dp,greedy,trees" "Ashish has a tree consisting of n nodes numbered 1 to n rooted at node 1. The i-th node in the tree has a cost ai, and binary digit bi is written in it. He wants to have binary digit ci written in the i-th node in the end.To achieve this, he can perform the following operation any number of times:   Select any k nodes from the subtree of any node u, and shuffle the digits in these nodes as he wishes, incurring a cost of k\xe2\x8b\x85au. Here, he can choose k ranging from 1 to the size of the subtree of u. He wants to perform the operations in such a way that every node finally has the digit corresponding to its target.Help him find the minimum total cost he needs to spend so that after all the operations, every node u has digit cu written in it, or determine that it is impossible."              
                                  2500.0 1361C "Johnny and Megan\'s Necklace" "binary search,bitmasks,constructive algorithms,dfs and similar,dsu,graphs" "Johnny\'s younger sister Megan had a birthday recently. Her brother has bought her a box signed as ""Your beautiful necklace \xe2\x80\x94 do it yourself!"". It contains many necklace parts and some magic glue. The necklace part is a chain connecting two pearls. Color of each pearl can be defined by a non-negative integer. The magic glue allows Megan to merge two pearls (possibly from the same necklace part) into one. The beauty of a connection of pearls in colors uu and vv is defined as follows: let 2k2k be the greatest power of two dividing u\xe2\x8a\x95vu\xe2\x8a\x95v \xe2\x80\x94 exclusive or of uu and vv. Then the beauty equals kk. If u=vu=v, you may assume that beauty is equal to 2020.Each pearl can be combined with another at most once. Merging two parts of a necklace connects them. Using the glue multiple times, Megan can finally build the necklace, which is a cycle made from connected necklace parts (so every pearl in the necklace is combined with precisely one other pearl in it). The beauty of such a necklace is the minimum beauty of a single connection in it. The girl wants to use all available necklace parts to build exactly one necklace consisting of all of them with the largest possible beauty. Help her!"              
                                  1700.0 1360F Spy-string "bitmasks,brute force,constructive algorithms,dp,hashing,strings" "You are given n strings a1,a2,\xe2\x80\xa6,an: all of them have the same length m. The strings consist of lowercase English letters.Find any string s of length m such that each of the given n strings differs from s in at most one position. Formally, for each given string ai, there is no more than one position j such that ai[j]\xe2\x89\xa0s[j].Note that the desired string s may be equal to one of the given strings ai, or it may differ from all the given strings.For example, if you have the strings abac and zbab, then the answer to the problem might be the string abab, which differs from the first only by the last character, and from the second only by the first."              
                                  -999.0 1357D5 "Quantum Classification - Dataset 7"  "This problem is identical to the problem D1 in every aspect except the training dataset. Please refer to that problem for the full problem statement."              
                                  -999.0 1357D2 "Quantum Classification - Dataset 4"  "This problem is identical to the problem D1 in every aspect except the training dataset. Please refer to that problem for the full problem statement."              
                                  -999.0 1357D1 "Quantum Classification - Dataset 3"  "You are given a training dataset, in which each entry is a features vector (an array of 2 real numbers) and a label 0 or 1 indicating the class to which this vector belongs.Your goal is to use this dataset to train a quantum classification model that will accurately classify a validation dataset - a different dataset generated using the same data distribution as the training one. The error rate of classifying the validation dataset using your model (the percentage of incorrectly classified samples) should be less than 5%.  The quantum classification library that will use your model to classify the data is documented here.  This tutorial has an end-to-end example of training a model using this library as a Python notebook.  The warmup round editorial discusses solving easier problems features in the warmup round.  You can find the exact implementation of the testing harness for the D problems of this round, including the preprocessing methods, here.  You can find examples of training a model and using it for classification here."              
                                  -999.0 1357A4 "Distinguish Rz from R1"  "You are given an operation that implements a single-qubit unitary transformation: either the Rz gate or the R1 gate. The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the Rz gate or 1 if it was the R1 gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly once (you can pass to it any rotation angle that you choose).You have to implement an operation which takes a single-qubit operation unitary as an input and returns an integer. The operation unitary will accept two parameters (similarly to Rz and R1 intrinsic gates): the first parameter is the rotation angle and the second parameter is the qubit to which the rotation is applied. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : ((Double, Qubit) => Unit is Adj+Ctl)) : Int {        // your code here    }}"              
                                  -999.0 1357A1 "Figure out direction of CNOT"  "You are given an operation that implements a two-qubit unitary transformation: either the CNOT gate with the first qubit as control and the second qubit as target (CNOT12), or the CNOT gate with the second qubit as control and the first qubit as target (CNOT21). The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the CNOT12 gate or 1 if it was the CNOT21 gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly once.You have to implement an operation which takes a two-qubit operation unitary as an input and returns an integer. The operation unitary will accept an array of qubits as input, but it will fail if the array is empty or has one or more than two qubits. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit[] => Unit is Adj+Ctl)) : Int {        // your code here    }}"              
                                  1800.0 1355C "Count Triangles" "binary search,implementation,math,two pointers" "Like any unknown mathematician, Yuri has favourite numbers: A, B, C, and D, where A\xe2\x89\xa4B\xe2\x89\xa4C\xe2\x89\xa4D. Yuri also likes triangles and once he thought: how many non-degenerate triangles with integer sides x, y, and z exist, such that A\xe2\x89\xa4x\xe2\x89\xa4B\xe2\x89\xa4y\xe2\x89\xa4C\xe2\x89\xa4z\xe2\x89\xa4D holds?Yuri is preparing problems for a new contest now, so he is very busy. That\'s why he asked you to calculate the number of triangles with described property.The triangle is called non-degenerate if and only if its vertices are not collinear."              
                                  2000.0 1354C2 "Not So Simple Polygon Embedding" "binary search,brute force,geometry,math" "The statement of this problem is the same as the statement of problem C1. The only difference is that, in problem C1, n is always even, and in C2, n is always odd.You are given a regular polygon with 2\xe2\x8b\x85n vertices (it\'s convex and has equal sides and equal angles) and all its sides have length 1. Let\'s name it as 2n-gon.Your task is to find the square of the minimum size such that you can embed 2n-gon in the square. Embedding 2n-gon in the square means that you need to place 2n-gon in the square in such way that each point which lies inside or on a border of 2n-gon should also lie inside or on a border of the square.You can rotate 2n-gon and/or the square."              
                                  1500.0 1352F "Binary String Reconstruction" "constructive algorithms,dfs and similar,math" "For some binary string s (i.e. each character si is either \'0\' or \'1\'), all pairs of consecutive (adjacent) characters were written. In other words, all substrings of length 2 were written. For each pair (substring of length 2), the number of \'1\' (ones) in it was calculated.You are given three numbers:  n0 \xe2\x80\x94 the number of such pairs of consecutive characters (substrings) where the number of ones equals 0;  n1 \xe2\x80\x94 the number of such pairs of consecutive characters (substrings) where the number of ones equals 1;  n2 \xe2\x80\x94 the number of such pairs of consecutive characters (substrings) where the number of ones equals 2. For example, for the string s=""1110011110"", the following substrings would be written: ""11"", ""11"", ""10"", ""00"", ""01"", ""11"", ""11"", ""11"", ""10"". Thus, n0=1, n1=3, n2=5.Your task is to restore any suitable binary string s from the given values n0,n1,n2. It is guaranteed that at least one of the numbers n0,n1,n2 is greater than 0. Also, it is guaranteed that a solution exists."              
                                  3500.0 1349F2 "Slime and Sequences (Hard Version)" dp,fft,math "Note that the only differences between easy and hard versions are the constraints on n and the time limit. You can make hacks only if all versions are solved.Slime is interested in sequences. He defined good positive integer sequences p of length n as follows: For each k>1 that presents in p, there should be at least one pair of indices i,j, such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n, pi=k\xe2\x88\x921 and pj=k.For the given integer n, the set of all good sequences of length n is sn. For the fixed integer k and the sequence p, let fp(k) be the number of times that k appears in p. For each k from 1 to n, Slime wants to know the following value:(\xe2\x88\x91p\xe2\x88\x88snfp(k)) mod 998244353"              
                                  2000.0 1349B "Orac and Medians" "constructive algorithms,greedy,math" "Slime has a sequence of positive integers a1,a2,\xe2\x80\xa6,an.In one operation Orac can choose an arbitrary subsegment [l\xe2\x80\xa6r] of this sequence and replace all values al,al+1,\xe2\x80\xa6,ar to the value of median of {al,al+1,\xe2\x80\xa6,ar}.In this problem, for the integer multiset s, the median of s is equal to the \xe2\x8c\x8a|s|+12\xe2\x8c\x8b-th smallest number in it. For example, the median of {1,4,4,6,5} is 4, and the median of {1,7,5,8} is 5.Slime wants Orac to make a1=a2=\xe2\x80\xa6=an=k using these operations.Orac thinks that it is impossible, and he does not want to waste his time, so he decided to ask you if it is possible to satisfy the Slime\'s requirement, he may ask you these questions several times."              
                                  1600.0 1349A "Orac and LCM" "data structures,math,number theory" "For the multiset of positive integers s={s1,s2,\xe2\x80\xa6,sk}, define the Greatest Common Divisor (GCD) and Least Common Multiple (LCM) of s as follow: gcd(s) is the maximum positive integer x, such that all integers in s are divisible on x. lcm(s) is the minimum positive integer x, that divisible on all integers from s.For example, gcd({8,12})=4,gcd({12,18,6})=6 and lcm({4,6})=12. Note that for any positive integer x, gcd({x})=lcm({x})=x.Orac has a sequence a with length n. He come up with the multiset t={lcm({ai,aj}) | i<j}, and asked you to find the value of gcd(t) for him. In other words, you need to calculate the GCD of LCMs of all pairs of elements in the given sequence."              
                                  2400.0 1348E "Phoenix and Berries" "brute force,dp,greedy,math" "Phoenix is picking berries in his backyard. There are n shrubs, and each shrub has ai red berries and bi blue berries.Each basket can contain k berries. But, Phoenix has decided that each basket may only contain berries from the same shrub or berries of the same color (red or blue). In other words, all berries in a basket must be from the same shrub or/and have the same color.For example, if there are two shrubs with 5 red and 2 blue berries in the first shrub and 2 red and 1 blue berries in the second shrub then Phoenix can fill 2 baskets of capacity 4 completely:   the first basket will contain 3 red and 1 blue berries from the first shrub;  the second basket will contain the 2 remaining red berries from the first shrub and 2 red berries from the second shrub. Help Phoenix determine the maximum number of baskets he can fill completely!"              
                                  800.0 1348A "Phoenix and Balance" greedy,math "Phoenix has n coins with weights 21,22,\xe2\x80\xa6,2n. He knows that n is even.He wants to split the coins into two piles such that each pile has exactly n2 coins and the difference of weights between the two piles is minimized. Formally, let a denote the sum of weights in the first pile, and b denote the sum of weights in the second pile. Help Phoenix minimize |a\xe2\x88\x92b|, the absolute value of a\xe2\x88\x92b."              
                                  2900.0 1346I "Pac-Man 2.0" "*special problem,dp" "Polycarp is developing a new version of an old video game ""Pac-Man"". Though he really enjoyed playing the original game, he didn\'t like some aspects of it, so he decided to alter the rules a bit.In Polycarp\'s version, you play as Pac-Man and you have to collect pellets scattered over the game world while avoiding dangerous ghosts (no difference from the original yet). Polycarp didn\'t like the fact that there was no escape from the ghosts in the original, so, in his version, the game world is divided into n safe zones with m one-directional pathways between them \xe2\x80\x94 and it is guaranteed that Pac-Man can reach any safe zone from any other. Since safe zones are safe, the ghosts cannot attack Pac-Man while it is there, it is in danger only while traversing the pathways. Pac-Man starts the game in the safe zone s.All pellets are scattered over the safe zones; initially, the i-th safe zone contains ai pellets (and if Pac-Man is in a safe zone, it may freely collect all the pellets in it). The pellets disappear after being collected, but after the last pellet in the game world is collected, new pellets spawn in the safe zones in the same quantity as before (ai new pellets spawn in the i-th zone). The pellets can be respawned any number of times, so the game is essentially infinite.Polycarp has already determined the structure of the game world and the number of pellets in each safe zone. Now he is trying to find out if the game is difficult enough. There are q goals in the game, the i-th goal is to collect at least Ci pellets from the beginning of the game. Polycarp denotes the difficulty of the i-th goal as the minimum number of times the player has to traverse a one-directional pathway in order to collect Ci pellets (since only traversing a pathway puts Pac-Man in danger). If some pathway is traversed multiple times while Pac-Man is collecting the pellets, it is included in the answer the same number of times.Help Polycarp to calculate the difficulty of each goal!"              
                                  1600.0 1346C "Spring Cleaning" "*special problem,greedy,sortings" "Tanya wants to organize her bookcase. There are n bookshelves in the bookcase, the i-th bookshelf contains ai books on it. Tanya will be satisfied if each bookshelf contains no more than k books.Tanya can do one of the two following operations to achieve her goal:   Choose exactly one bookshelf and put all the books from it in the storage room (i.\xe2\x80\x89e. choose some i and assign ai:=0). During this operation she spends x seconds.  Take all books from all n bookshelves and distribute them between all n bookshelves evenly (the definition of the term is given below). During this operation she spends y seconds. Consider the sequence a of n integers. Then its even distribution is such a sequence b of n integers that the sum of b equals the sum of a and the value max(b)\xe2\x88\x92min(b) is the minimum possible.For example, if the array a=[5,4,3] then its even distribution is b=[4,4,4]. If a=[1,2,3,4] then its even distribution is b=[2,3,3,2] (or any permutation of this array).Your task is to find the minimum number of seconds Tanya has to spend to obtain the bookcase with no more than k books on each bookshelf."              
                                  1700.0 1343D "Constant Palindrome Sum" "brute force,data structures,greedy,two pointers" "You are given an array a consisting of n integers (it is guaranteed that n is even, i.e. divisible by 2). All ai does not exceed some integer k.Your task is to replace the minimum number of elements (replacement is the following operation: choose some index i from 1 to n and replace ai with some integer in range [1;k]) to satisfy the following conditions:  after all replacements, all ai are positive integers not greater than k;  for all i from 1 to n2 the following equation is true: ai+an\xe2\x88\x92i+1=x, where x should be the same for all n2 pairs of elements. You have to answer t independent test cases."              
                                  2300.0 1342E "Placing Rooks" combinatorics,fft,math "Calculate the number of ways to place n rooks on n\xc3\x97n chessboard so that both following conditions are met:  each empty cell is under attack;  exactly k pairs of rooks attack each other. An empty cell is under attack if there is at least one rook in the same row or at least one rook in the same column. Two rooks attack each other if they share the same row or column, and there are no other rooks between them. For example, there are only two pairs of rooks that attack each other in the following picture:  One of the ways to place the rooks for n=3 and k=2 Two ways to place the rooks are considered different if there exists at least one cell which is empty in one of the ways but contains a rook in another way.The answer might be large, so print it modulo 998244353."              
                                  2600.0 1340D "Nastya and Time Machine" "constructive algorithms,dfs and similar,graphs,trees" "Denis came to Nastya and discovered that she was not happy to see him... There is only one chance that she can become happy. Denis wants to buy all things that Nastya likes so she will certainly agree to talk to him. The map of the city where they live has a lot of squares, some of which are connected by roads. There is exactly one way between each pair of squares which does not visit any vertex twice. It turns out that the graph of the city is a tree.Denis is located at vertex 1 at the time 0. He wants to visit every vertex at least once and get back as soon as possible.Denis can walk one road in 1 time. Unfortunately, the city is so large that it will take a very long time to visit all squares. Therefore, Denis took a desperate step. He pulled out his pocket time machine, which he constructed in his basement. With its help, Denis can change the time to any non-negative time, which is less than the current time.But the time machine has one feature. If the hero finds himself in the same place and at the same time twice, there will be an explosion of universal proportions and Nastya will stay unhappy. Therefore, Denis asks you to find him a route using a time machine that he will get around all squares and will return to the first and at the same time the maximum time in which he visited any square will be minimal.Formally, Denis\'s route can be represented as a sequence of pairs: {v1,t1},{v2,t2},{v3,t3},\xe2\x80\xa6,{vk,tk}, where vi is number of square, and ti is time in which the boy is now.The following conditions must be met:  The route starts on square 1 at time 0, i.e. v1=1,t1=0 and ends on the square 1, i.e. vk=1.  All transitions are divided into two types:   Being in the square change the time: {vi,ti}\xe2\x86\x92{vi+1,ti+1}:vi+1=vi,0\xe2\x89\xa4ti+1<ti.  Walk along one of the roads: {vi,ti}\xe2\x86\x92{vi+1,ti+1}. Herewith, vi and vi+1 are connected by road, and ti+1=ti+1   All pairs {vi,ti} must be different.  All squares are among v1,v2,\xe2\x80\xa6,vk. You need to find a route such that the maximum time in any square will be minimal, that is, the route for which max(t1,t2,\xe2\x80\xa6,tk) will be the minimum possible."              
                                  2400.0 1340C "Nastya and Unexpected Guest" "dfs and similar,dp,graphs,shortest paths" "If the girl doesn\'t go to Denis, then Denis will go to the girl. Using this rule, the young man left home, bought flowers and went to Nastya. On the way from Denis\'s house to the girl\'s house is a road of n lines. This road can\'t be always crossed in one green light. Foreseeing this, the good mayor decided to place safety islands in some parts of the road. Each safety island is located after a line, as well as at the beginning and at the end of the road. Pedestrians can relax on them, gain strength and wait for a green light.Denis came to the edge of the road exactly at the moment when the green light turned on. The boy knows that the traffic light first lights up g seconds green, and then r seconds red, then again g seconds green and so on.Formally, the road can be represented as a segment [0,n]. Initially, Denis is at point 0. His task is to get to point n in the shortest possible time.He knows many different integers d1,d2,\xe2\x80\xa6,dm, where 0\xe2\x89\xa4di\xe2\x89\xa4n  \xe2\x80\x94 are the coordinates of points, in which the safety islands are located. Only at one of these points, the boy can be at a time when the red light is on.Unfortunately, Denis isn\'t always able to control himself because of the excitement, so some restrictions are imposed:  He must always move while the green light is on because it\'s difficult to stand when so beautiful girl is waiting for you. Denis can change his position by \xc2\xb11 in 1 second. While doing so, he must always stay inside the segment [0,n].  He can change his direction only on the safety islands (because it is safe). This means that if in the previous second the boy changed his position by +1 and he walked on a safety island, then he can change his position by \xc2\xb11. Otherwise, he can change his position only by +1. Similarly, if in the previous second he changed his position by \xe2\x88\x921, on a safety island he can change position by \xc2\xb11, and at any other point by \xe2\x88\x921.  At the moment when the red light is on, the boy must be on one of the safety islands. He can continue moving in any direction when the green light is on. Denis has crossed the road as soon as his coordinate becomes equal to n.This task was not so simple, because it\'s possible that it is impossible to cross the road. Since Denis has all thoughts about his love, he couldn\'t solve this problem and asked us to help him. Find the minimal possible time for which he can cross the road according to these rules, or find that it is impossible to do."              
                                  1500.0 1340A "Nastya and Strange Generator" "brute force,data structures,greedy,implementation" "Denis was very sad after Nastya rejected him. So he decided to walk through the gateways to have some fun. And luck smiled at him! When he entered the first courtyard, he met a strange man who was selling something. Denis bought a mysterious item and it was... Random permutation generator! Denis could not believed his luck.When he arrived home, he began to study how his generator works and learned the algorithm. The process of generating a permutation consists of n steps. At the i-th step, a place is chosen for the number i (1\xe2\x89\xa4i\xe2\x89\xa4n). The position for the number i is defined as follows:  For all j from 1 to n, we calculate rj  \xe2\x80\x94 the minimum index such that j\xe2\x89\xa4rj\xe2\x89\xa4n, and the position rj is not yet occupied in the permutation. If there are no such positions, then we assume that the value of rj is not defined.  For all t from 1 to n, we calculate countt  \xe2\x80\x94 the number of positions 1\xe2\x89\xa4j\xe2\x89\xa4n such that rj is defined and rj=t.  Consider the positions that are still not occupied by permutation and among those we consider the positions for which the value in the count array is maximum.  The generator selects one of these positions for the number i. The generator can choose any position. Let\'s have a look at the operation of the algorithm in the following example:  Let n=5 and the algorithm has already arranged the numbers 1,2,3 in the permutation. Consider how the generator will choose a position for the number 4:  The values of r will be r=[3,3,3,4,\xc3\x97], where \xc3\x97 means an indefinite value.  Then the count values will be count=[0,0,3,1,0].  There are only two unoccupied positions in the permutation: 3 and 4. The value in the count array for position 3 is 3, for position 4 it is 1.  The maximum value is reached only for position 3, so the algorithm will uniquely select this position for number 4. Satisfied with his purchase, Denis went home. For several days without a break, he generated permutations. He believes that he can come up with random permutations no worse than a generator. After that, he wrote out the first permutation that came to mind p1,p2,\xe2\x80\xa6,pn and decided to find out if it could be obtained as a result of the generator.Unfortunately, this task was too difficult for him, and he asked you for help. It is necessary to define whether the written permutation could be obtained using the described algorithm if the generator always selects the position Denis needs."              
                                  1800.0 1335E2 "Three Blocks Palindrome (hard version)" "brute force,data structures,dp,two pointers" "The only difference between easy and hard versions is constraints.You are given a sequence a consisting of n positive integers.Let\'s define a three blocks palindrome as the sequence, consisting of at most two distinct elements (let these elements are a and b, a can be equal b) and is as follows: [a,a,\xe2\x80\xa6,a\xe2\x8f\x9fx,b,b,\xe2\x80\xa6,b\xe2\x8f\x9fy,a,a,\xe2\x80\xa6,a\xe2\x8f\x9fx]. There x,y are integers greater than or equal to 0. For example, sequences [], [2], [1,1], [1,2,1], [1,2,2,1] and [1,1,2,1,1] are three block palindromes but [1,2,3,2,1], [1,2,1,2,1] and [1,2] are not.Your task is to choose the maximum by length subsequence of a that is a three blocks palindrome.You have to answer t independent test cases.Recall that the sequence t is a a subsequence of the sequence s if t can be derived from s by removing zero or more elements without changing the order of the remaining elements. For example, if s=[1,2,1,3,1,2,1], then possible subsequences are: [1,1,1,1], [3] and [1,2,1,3,1,2,1], but not [3,2,3] and [1,1,1,1,2]."              
                                  1700.0 1335E1 "Three Blocks Palindrome (easy version)" "binary search,brute force,data structures,dp,two pointers" "The only difference between easy and hard versions is constraints.You are given a sequence a consisting of n positive integers.Let\'s define a three blocks palindrome as the sequence, consisting of at most two distinct elements (let these elements are a and b, a can be equal b) and is as follows: [a,a,\xe2\x80\xa6,a\xe2\x8f\x9fx,b,b,\xe2\x80\xa6,b\xe2\x8f\x9fy,a,a,\xe2\x80\xa6,a\xe2\x8f\x9fx]. There x,y are integers greater than or equal to 0. For example, sequences [], [2], [1,1], [1,2,1], [1,2,2,1] and [1,1,2,1,1] are three block palindromes but [1,2,3,2,1], [1,2,1,2,1] and [1,2] are not.Your task is to choose the maximum by length subsequence of a that is a three blocks palindrome.You have to answer t independent test cases.Recall that the sequence t is a a subsequence of the sequence s if t can be derived from s by removing zero or more elements without changing the order of the remaining elements. For example, if s=[1,2,1,3,1,2,1], then possible subsequences are: [1,1,1,1], [3] and [1,2,1,3,1,2,1], but not [3,2,3] and [1,1,1,1,2]."              
                                  900.0 1335B "Construct the String" "constructive algorithms" "You are given three positive integers n, a and b. You have to construct a string s of length n consisting of lowercase Latin letters such that each substring of length a has exactly b distinct letters. It is guaranteed that the answer exists.You have to answer t independent test cases.Recall that the substring s[l\xe2\x80\xa6r] is the string sl,sl+1,\xe2\x80\xa6,sr and its length is r\xe2\x88\x92l+1. In this problem you are only interested in substrings of length a."              
                                  2900.0 1334G "Substring Search" "bitmasks,brute force,fft" "You are given a permutation p consisting of exactly 26 integers from 1 to 26 (since it is a permutation, each integer from 1 to 26 occurs in p exactly once) and two strings s and t consisting of lowercase Latin letters.A substring t\xe2\x80\xb2 of string t is an occurence of string s if the following conditions are met:  |t\xe2\x80\xb2|=|s|;  for each i\xe2\x88\x88[1,|s|], either si=t\xe2\x80\xb2i, or pidx(si)=idx(t\xe2\x80\xb2i), where idx(c) is the index of character c in Latin alphabet (idx(a)=1, idx(b)=2, idx(z)=26). For example, if p1=2, p2=3, p3=1, s=abc, t=abcaaba, then three substrings of t are occurences of s (they are t\xe2\x80\xb2=abc, t\xe2\x80\xb2=bca and t\xe2\x80\xb2=aba).For each substring of t having length equal to |s|, check if it is an occurence of s."              
              1000.0                         1136B "Nastya Is Playing Computer Games" "constructive algorithms,math" "Finished her homework, Nastya decided to play computer games. Passing levels one by one, Nastya eventually faced a problem. Her mission is to leave a room, where a lot of monsters live, as quickly as possible.There are n manholes in the room which are situated on one line, but, unfortunately, all the manholes are closed, and there is one stone on every manhole. There is exactly one coin under every manhole, and to win the game Nastya should pick all the coins. Initially Nastya stands near the k-th manhole from the left. She is thinking what to do.In one turn, Nastya can do one of the following:   if there is at least one stone on the manhole Nastya stands near, throw exactly one stone from it onto any other manhole (yes, Nastya is strong).  go to a neighboring manhole;  if there are no stones on the manhole Nastya stays near, she can open it and pick the coin from it. After it she must close the manhole immediately (it doesn\'t require additional moves).   The figure shows the intermediate state of the game. At the current position Nastya can throw the stone to any other manhole or move left or right to the neighboring manholes. If she were near the leftmost manhole, she could open it (since there are no stones on it). Nastya can leave the room when she picks all the coins. Monsters are everywhere, so you need to compute the minimum number of moves Nastya has to make to pick all the coins.Note one time more that Nastya can open a manhole only when there are no stones onto it."          
              2300.0                         1131E "String Multiplication" dp,greedy,strings "Roman and Denis are on the trip to the programming competition. Since the trip was long, they soon got bored, and hence decided to came up with something. Roman invented a pizza\'s recipe, while Denis invented a string multiplication. According to Denis, the result of multiplication (product) of strings s of length m and t is a string t+s1+t+s2+\xe2\x80\xa6+t+sm+t, where si denotes the i-th symbol of the string s, and ""+"" denotes string concatenation. For example, the product of strings ""abc"" and ""de"" is a string ""deadebdecde"", while the product of the strings ""ab"" and ""z"" is a string ""zazbz"". Note, that unlike the numbers multiplication, the product of strings s and t is not necessarily equal to product of t and s.Roman was jealous of Denis, since he invented such a cool operation, and hence decided to invent something string-related too. Since Roman is beauty-lover, he decided to define the beauty of the string as the length of the longest substring, consisting of only one letter. For example, the beauty of the string ""xayyaaabca"" is equal to 3, since there is a substring ""aaa"", while the beauty of the string ""qwerqwer"" is equal to 1, since all neighboring symbols in it are different.In order to entertain Roman, Denis wrote down n strings p1,p2,p3,\xe2\x80\xa6,pn on the paper and asked him to calculate the beauty of the string (\xe2\x80\xa6(((p1\xe2\x8b\x85p2)\xe2\x8b\x85p3)\xe2\x8b\x85\xe2\x80\xa6)\xe2\x8b\x85pn, where s\xe2\x8b\x85t denotes a multiplication of strings s and t. Roman hasn\'t fully realized how Denis\'s multiplication works, so he asked you for a help. Denis knows, that Roman is very impressionable, he guarantees, that the beauty of the resulting string is at most 109."          
              1200.0                         1121B "Mike and Children" "brute force,implementation" "Mike decided to teach programming to children in an elementary school. He knows that it is not an easy task to interest children in that age to code. That is why he decided to give each child two sweets.Mike has n sweets with sizes a1,a2,\xe2\x80\xa6,an. All his sweets have different sizes. That is, there is no such pair (i,j) (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that i\xe2\x89\xa0j and ai=aj.Since Mike has taught for many years, he knows that if he gives two sweets with sizes ai and aj to one child and ak and ap to another, where (ai+aj)\xe2\x89\xa0(ak+ap), then a child who has a smaller sum of sizes will be upset. That is, if there are two children who have different sums of sweets, then one of them will be upset. Apparently, Mike does not want somebody to be upset. Mike wants to invite children giving each of them two sweets. Obviously, he can\'t give one sweet to two or more children. His goal is to invite as many children as he can. Since Mike is busy preparing to his first lecture in the elementary school, he is asking you to find the maximum number of children he can invite giving each of them two sweets in such way that nobody will be upset."          
              2700.0                         1120B "Once in a casino" "constructive algorithms,greedy,implementation,math" "One player came to a casino and found a slot machine where everything depends only on how he plays. The rules follow.A positive integer a is initially on the screen. The player can put a coin into the machine and then add 1 to or subtract 1 from any two adjacent digits. All digits must remain from 0 to 9 after this operation, and the leading digit must not equal zero. In other words, it is forbidden to add 1 to 9, to subtract 1 from 0 and to subtract 1 from the leading 1. Once the number on the screen becomes equal to b, the player wins the jackpot. a and b have the same number of digits.Help the player to determine the minimal number of coins he needs to spend in order to win the jackpot and tell how to play."          
              1800.0                         1119D "Frets On Fire" "binary search,sortings" "Miyako came to the flea kingdom with a ukulele. She became good friends with local flea residents and played beautiful music for them every day.In return, the fleas made a bigger ukulele for her: it has n strings, and each string has (1018+1) frets numerated from 0 to 1018. The fleas use the array s1,s2,\xe2\x80\xa6,sn to describe the ukulele\'s tuning, that is, the pitch of the j-th fret on the i-th string is the integer si+j.Miyako is about to leave the kingdom, but the fleas hope that Miyako will answer some last questions for them.Each question is in the form of: ""How many different pitches are there, if we consider frets between l and r (inclusive) on all strings?""Miyako is about to visit the cricket kingdom and has no time to answer all the questions. Please help her with this task!Formally, you are given a matrix with n rows and (1018+1) columns, where the cell in the i-th row and j-th column (0\xe2\x89\xa4j\xe2\x89\xa41018) contains the integer si+j. You are to answer q queries, in the k-th query you have to answer the number of distinct integers in the matrix from the lk-th to the rk-th columns, inclusive."          
              2500.0                         1117F "Crisp String" bitmasks,dp "You are given a string of length n. Each character is one of the first p lowercase Latin letters.You are also given a matrix A with binary values of size p\xc3\x97p. This matrix is symmetric (Aij=Aji). Aij=1 means that the string can have the i-th and j-th letters of Latin alphabet adjacent.Let\'s call the string crisp if all of the adjacent characters in it can be adjacent (have 1 in the corresponding cell of matrix A).You are allowed to do the following move. Choose any letter, remove all its occurrences and join the remaining parts of the string without changing their order. For example, removing letter \'a\' from ""abacaba"" will yield ""bcb"".The string you are given is crisp. The string should remain crisp after every move you make.You are allowed to do arbitrary number of moves (possible zero). What is the shortest resulting string you can obtain?"          
              1300.0                         1113B "Sasha and Magnetic Machines" "greedy,number theory" "One day Sasha visited the farmer 2D and his famous magnetic farm. On this farm, the crop grows due to the influence of a special magnetic field. Maintaining of the magnetic field is provided by n machines, and the power of the i-th machine is ai. This year 2D decided to cultivate a new culture, but what exactly he didn\'t say. For the successful growth of the new culture, it is necessary to slightly change the powers of the machines. 2D can at most once choose an arbitrary integer x, then choose one machine and reduce the power of its machine by x times, and at the same time increase the power of one another machine by x times (powers of all the machines must stay positive integers). Note that he may not do that if he wants. More formally, 2D can choose two such indices i and j, and one integer x such that x is a divisor of ai, and change powers as following: ai=aix, aj=aj\xe2\x8b\x85xSasha is very curious, that\'s why he wants to calculate the minimum total power the farmer can reach. There are too many machines, and Sasha can\'t cope with computations, help him!"          
              2200.0                         1110E "Magic Stones" "constructive algorithms,math,sortings" "Grigory has n magic stones, conveniently numbered from 1 to n. The charge of the i-th stone is equal to ci.Sometimes Grigory gets bored and selects some inner stone (that is, some stone with index i, where 2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), and after that synchronizes it with neighboring stones. After that, the chosen stone loses its own charge, but acquires the charges from neighboring stones. In other words, its charge ci changes to c\xe2\x80\xb2i=ci+1+ci\xe2\x88\x921\xe2\x88\x92ci.Andrew, Grigory\'s friend, also has n stones with charges ti. Grigory is curious, whether there exists a sequence of zero or more synchronization operations, which transforms charges of Grigory\'s stones into charges of corresponding Andrew\'s stones, that is, changes ci into ti for all i?"          
              1800.0                         1107D Compression "dp,implementation,math,number theory" "You are given a binary matrix A of size n\xc3\x97n. Let\'s denote an x-compression of the given matrix as a matrix B of size nx\xc3\x97nx such that for every i\xe2\x88\x88[1,n],j\xe2\x88\x88[1,n] the condition A[i][j]=B[\xe2\x8c\x88ix\xe2\x8c\x89][\xe2\x8c\x88jx\xe2\x8c\x89] is met.Obviously, x-compression is possible only if x divides n, but this condition is not enough. For example, the following matrix of size 2\xc3\x972 does not have any 2-compression: 01   10 For the given matrix A, find maximum x such that an x-compression of this matrix is possible.Note that the input is given in compressed form. But even though it is compressed, you\'d better use fast input."          
              1400.0                         1102B "Array K-Coloring" greedy,sortings "You are given an array a consisting of n integer numbers.You have to color this array in k colors in such a way that:   Each element of the array should be colored in some color;  For each i from 1 to k there should be at least one element colored in the i-th color in the array;  For each i from 1 to k all elements colored in the i-th color should be distinct. Obviously, such coloring might be impossible. In this case, print ""NO"". Otherwise print ""YES"" and any coloring (i.e. numbers c1,c2,\xe2\x80\xa6cn, where 1\xe2\x89\xa4ci\xe2\x89\xa4k and ci is the color of the i-th element of the given array) satisfying the conditions above. If there are multiple answers, you can print any."          
              1500.0                         1101E "Polycarp\'s New Job" implementation "Polycarp has recently got himself a new job. He now earns so much that his old wallet can\'t even store all the money he has.Berland bills somehow come in lots of different sizes. However, all of them are shaped as rectangles (possibly squares). All wallets are also produced in form of rectangles (possibly squares).A bill x\xc3\x97y fits into some wallet h\xc3\x97w if either x\xe2\x89\xa4h and y\xe2\x89\xa4w or y\xe2\x89\xa4h and x\xe2\x89\xa4w. Bills can overlap with each other in a wallet and an infinite amount of bills can fit into a wallet. That implies that all the bills Polycarp currently have fit into a wallet if every single one of them fits into it independently of the others.Now you are asked to perform the queries of two types:  + x y \xe2\x80\x94 Polycarp earns a bill of size x\xc3\x97y;  ? h w \xe2\x80\x94 Polycarp wants to check if all the bills he has earned to this moment fit into a wallet of size h\xc3\x97w. It is guaranteed that there is at least one query of type 1 before the first query of type 2 and that there is at least one query of type 2 in the input data.For each query of type 2 print ""YES"" if all the bills he has earned to this moment fit into a wallet of given size. Print ""NO"" otherwise."          
              1200.0                         1100C "NN and the Optical Illusion" "binary search,geometry,math" "NN is an experienced internet user and that means he spends a lot of time on the social media. Once he found the following image on the Net, which asked him to compare the sizes of inner circles:  It turned out that the circles are equal. NN was very surprised by this fact, so he decided to create a similar picture himself.He managed to calculate the number of outer circles n and the radius of the inner circle r. NN thinks that, using this information, you can exactly determine the radius of the outer circles R so that the inner circle touches all of the outer ones externally and each pair of neighboring outer circles also touches each other. While NN tried very hard to guess the required radius, he didn\'t manage to do that. Help NN find the required radius for building the required picture."          
              1200.0                         1099C Postcard "constructive algorithms,implementation" "Andrey received a postcard from Irina. It contained only the words ""Hello, Andrey!"", and a strange string consisting of lowercase Latin letters, snowflakes and candy canes. Andrey thought that this string is an encrypted message, and decided to decrypt it.Andrey noticed that snowflakes and candy canes always stand after the letters, so he supposed that the message was encrypted as follows. Candy cane means that the letter before it can be removed, or can be left. A snowflake means that the letter before it can be removed, left, or repeated several times.For example, consider the following string:   This string can encode the message \xc2\xabhappynewyear\xc2\xbb. For this, candy canes and snowflakes should be used as follows:   candy cane 1: remove the letter w,  snowflake 1: repeat the letter p twice,  candy cane 2: leave the letter n,  snowflake 2: remove the letter w,  snowflake 3: leave the letter e.   Please note that the same string can encode different messages. For example, the string above can encode \xc2\xabhayewyar\xc2\xbb, \xc2\xabhapppppynewwwwwyear\xc2\xbb, and other messages.Andrey knows that messages from Irina usually have a length of k letters. Help him to find out if a given string can encode a message of k letters, and if so, give an example of such a message."          
              3500.0                         1098F \xd0\x96-function "string suffix structures,strings" "The length of the longest common prefix of two strings s=s1s2\xe2\x80\xa6sn and t=t1t2\xe2\x80\xa6tm is defined as the maximum k\xe2\x89\xa4min(n,m) such that s1s2\xe2\x80\xa6sk equals t1t2\xe2\x80\xa6tk. Let\'s denote the longest common prefix of two strings s and t as lcp(s,t).Z-function of a string s1s2\xe2\x80\xa6sn is a sequence of integers z1,z2,\xe2\x80\xa6,zn, where zi=lcp(s1s2\xe2\x80\xa6sn,  sisi+1\xe2\x80\xa6sn). \xd0\x96-function of a string s is defined as z1+z2+\xe2\x80\xa6+zn.You\'re given a string s=s1s2\xe2\x80\xa6sn and q queries. Each query is described by two integers li and ri, where 1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n. The answer for the query is defined as \xd0\x96-function of the string slisli+1\xe2\x80\xa6sri."          
              2400.0                         1098C "Construct a tree" "binary search,constructive algorithms,dfs and similar,graphs,greedy,trees" "Misha walked through the snowy forest and he was so fascinated by the trees to decide to draw his own tree!Misha would like to construct a rooted tree with n vertices, indexed from 1 to n, where the root has index 1. Every other vertex has a parent pi, and i is called a child of vertex pi. Vertex u belongs to the subtree of vertex v iff v is reachable from u while iterating over the parents (u, pu, ppu, ...). Clearly, v belongs to its own subtree, and the number of vertices in the subtree is called the size of the subtree. Misha is only interested in trees where every vertex belongs to the subtree of vertex 1.Below there is a tree with 6 vertices. The subtree of vertex 2 contains vertices 2, 3, 4, 5. Hence the size of its subtree is 4.   The branching coefficient of the tree is defined as the maximum number of children in any vertex. For example, for the tree above the branching coefficient equals 2. Your task is to construct a tree with n vertices such that the sum of the subtree sizes for all vertices equals s, and the branching coefficient is minimum possible."          
              800.0                         1097A "Gennady and a Card Game" "brute force,implementation" "Gennady owns a small hotel in the countryside where he lives a peaceful life. He loves to take long walks, watch sunsets and play cards with tourists staying in his hotel. His favorite game is called ""Mau-Mau"".To play Mau-Mau, you need a pack of 52 cards. Each card has a suit (Diamonds \xe2\x80\x94 D, Clubs \xe2\x80\x94 C, Spades \xe2\x80\x94 S, or Hearts \xe2\x80\x94 H), and a rank (2, 3, 4, 5, 6, 7, 8, 9, T, J, Q, K, or A).At the start of the game, there is one card on the table and you have five cards in your hand. You can play a card from your hand if and only if it has the same rank or the same suit as the card on the table.In order to check if you\'d be a good playing partner, Gennady has prepared a task for you. Given the card on the table and five cards in your hand, check if you can play at least one card."          
              1800.0                         1096D "Easy Problem" dp "Vasya is preparing a contest, and now he has written a statement for an easy problem. The statement is a string of length n consisting of lowercase Latin latters. Vasya thinks that the statement can be considered hard if it contains a subsequence hard; otherwise the statement is easy. For example, hard, hzazrzd, haaaaard can be considered hard statements, while har, hart and drah are easy statements. Vasya doesn\'t want the statement to be hard. He may remove some characters from the statement in order to make it easy. But, of course, some parts of the statement can be crucial to understanding. Initially the ambiguity of the statement is 0, and removing i-th character increases the ambiguity by ai (the index of each character is considered as it was in the original statement, so, for example, if you delete character r from hard, and then character d, the index of d is still 4 even though you delete it from the string had).Vasya wants to calculate the minimum ambiguity of the statement, if he removes some characters (possibly zero) so that the statement is easy. Help him to do it!Recall that subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements."          
              2400.0                         1093E "Intersection of Permutations" "data structures" "You are given two permutations a and b, both consisting of n elements. Permutation of n elements is such a integer sequence that each value from 1 to n appears exactly once in it.You are asked to perform two types of queries with them:  1 la ra lb rb \xe2\x80\x94 calculate the number of values which appear in both segment [la;ra] of positions in permutation a and segment [lb;rb] of positions in permutation b;  2 x y \xe2\x80\x94 swap values on positions x and y in permutation b. Print the answer for each query of the first type.It is guaranteed that there will be at least one query of the first type in the input."          
              900.0                         1093B "Letters Rearranging" "constructive algorithms,greedy,sortings,strings" "You are given a string s consisting only of lowercase Latin letters.You can rearrange all letters of this string as you wish. Your task is to obtain a good string by rearranging the letters of the given string or report that it is impossible to do it.Let\'s call a string good if it is not a palindrome. Palindrome is a string which is read from left to right the same as from right to left. For example, strings ""abacaba"", ""aa"" and ""z"" are palindromes and strings ""bba"", ""xd"" are not.You have to answer t independent queries."          
              800.0                         1093A "Dice Rolling" math "Mishka got a six-faced dice. It has integer numbers from 2 to 7 written on its faces (all numbers on faces are different, so this is an almost usual dice).Mishka wants to get exactly x points by rolling his dice. The number of points is just a sum of numbers written at the topmost face of the dice for all the rolls Mishka makes.Mishka doesn\'t really care about the number of rolls, so he just wants to know any number of rolls he can make to be able to get exactly x points for them. Mishka is very lucky, so if the probability to get x points with chosen number of rolls is non-zero, he will be able to roll the dice in such a way. Your task is to print this number. It is guaranteed that at least one answer exists.Mishka is also very curious about different number of points to score so you have to answer t independent queries."          
              2200.0                         1092D1 "Great Vova Wall (Version 1)" greedy,implementation,math "Vova\'s family is building the Great Vova Wall (named by Vova himself). Vova\'s parents, grandparents, grand-grandparents contributed to it. Now it\'s totally up to Vova to put the finishing touches.The current state of the wall can be respresented by a sequence a of n integers, with ai being the height of the i-th part of the wall.Vova can only use 2\xc3\x971 bricks to put in the wall (he has infinite supply of them, however).Vova can put bricks horizontally on the neighboring parts of the wall of equal height. It means that if for some i the current height of part i is the same as for part i+1, then Vova can put a brick there and thus increase both heights by 1. Obviously, Vova can\'t put bricks in such a way that its parts turn out to be off the borders (to the left of part 1 of the wall or to the right of part n of it).The next paragraph is specific to the version 1 of the problem.Vova can also put bricks vertically. That means increasing height of any part of the wall by 2.Vova is a perfectionist, so he considers the wall completed when:  all parts of the wall has the same height;  the wall has no empty spaces inside it. Can Vova complete the wall using any amount of bricks (possibly zero)?"          
              2600.0                         1089I "Interval-Free Permutations" combinatorics "Consider a permutation p1,p2,\xe2\x80\xa6pn of integers from 1 to n. We call a sub-segment pl,pl+1,\xe2\x80\xa6,pr\xe2\x88\x921,pr of the permutation an interval if it is a reordering of some set of consecutive integers. For example, the permutation (6,7,1,8,5,3,2,4) has the intervals (6,7), (5,3,2,4), (3,2), and others. Each permutation has some trivial intervals \xe2\x80\x94 the full permutation itself and every single element. We call a permutation interval-free if it does not have non-trivial intervals. In other words, interval-free permutation does not have intervals of length between 2 and n\xe2\x88\x921 inclusive. Your task is to count the number of interval-free permutations of length n modulo prime number p."          
              1600.0                         1085C "Connect Three" implementation,math "The Squareland national forest is divided into equal 1\xc3\x971 square plots aligned with north-south and east-west directions. Each plot can be uniquely described by integer Cartesian coordinates (x,y) of its south-west corner.Three friends, Alice, Bob, and Charlie are going to buy three distinct plots of land A,B,C in the forest. Initially, all plots in the forest (including the plots A,B,C) are covered by trees. The friends want to visit each other, so they want to clean some of the plots from trees. After cleaning, one should be able to reach any of the plots A,B,C from any other one of those by moving through adjacent cleared plots. Two plots are adjacent if they share a side.  For example, A=(0,0), B=(1,1), C=(2,2). The minimal number of plots to be cleared is 5. One of the ways to do it is shown with the gray color. Of course, the friends don\'t want to strain too much. Help them find out the smallest number of plots they need to clean from trees."          
              800.0                         1085A "Right-Left Cipher" implementation,strings "Polycarp loves ciphers. He has invented his own cipher called Right-Left.Right-Left cipher is used for strings. To encrypt the string s=s1s2\xe2\x80\xa6sn Polycarp uses the following algorithm:  he writes down s1,  he appends the current word with s2 (i.e. writes down s2 to the right of the current result),  he prepends the current word with s3 (i.e. writes down s3 to the left of the current result),  he appends the current word with s4 (i.e. writes down s4 to the right of the current result),  he prepends the current word with s5 (i.e. writes down s5 to the left of the current result),  and so on for each position until the end of s. For example, if s=""techno"" the process is: ""t"" \xe2\x86\x92 ""te"" \xe2\x86\x92 ""cte"" \xe2\x86\x92 ""cteh"" \xe2\x86\x92 ""ncteh"" \xe2\x86\x92 ""ncteho"". So the encrypted s=""techno"" is ""ncteho"".Given string t \xe2\x80\x94 the result of encryption of some string s. Your task is to decrypt it, i.e. find the string s."          
              1000.0                         1084A "The Fair Nut and Elevator" "brute force,implementation" "The Fair Nut lives in n story house. ai people live on the i-th floor of the house. Every person uses elevator twice a day: to get from the floor where he/she lives to the ground (first) floor and to get from the first floor to the floor where he/she lives, when he/she comes back home in the evening. It was decided that elevator, when it is not used, will stay on the x-th floor, but x hasn\'t been chosen yet. When a person needs to get from floor a to floor b, elevator follows the simple algorithm:   Moves from the x-th floor (initially it stays on the x-th floor) to the a-th and takes the passenger.  Moves from the a-th floor to the b-th floor and lets out the passenger (if a equals b, elevator just opens and closes the doors, but still comes to the floor from the x-th floor).  Moves from the b-th floor back to the x-th.  The elevator never transposes more than one person and always goes back to the floor x before transposing a next passenger. The elevator spends one unit of electricity to move between neighboring floors. So moving from the a-th floor to the b-th floor requires |a\xe2\x88\x92b| units of electricity.Your task is to help Nut to find the minimum number of electricity units, that it would be enough for one day, by choosing an optimal the x-th floor. Don\'t forget than elevator initially stays on the x-th floor."          
              3500.0                         1081H "Palindromic Magic" "data structures,hashing,strings" "After learning some fancy algorithms about palindromes, Chouti found palindromes very interesting, so he wants to challenge you with this problem.Chouti has got two strings A and B. Since he likes palindromes, he would like to pick a as some non-empty palindromic substring of A and b as some non-empty palindromic substring of B. Concatenating them, he will get string ab.Chouti thinks strings he could get this way are interesting, so he wants to know how many different strings he can get."          
              1900.0                         1076E "Vasya and a Tree" "data structures,trees" "Vasya has a tree consisting of n vertices with root in vertex 1. At first all vertices has 0 written on it.Let d(i,j) be the distance between vertices i and j, i.e. number of edges in the shortest path from i to j. Also, let\'s denote k-subtree of vertex x \xe2\x80\x94 set of vertices y such that next two conditions are met:   x is the ancestor of y (each vertex is the ancestor of itself);  d(x,y)\xe2\x89\xa4k. Vasya needs you to process m queries. The i-th query is a triple vi, di and xi. For each query Vasya adds value xi to each vertex from di-subtree of vi.Report to Vasya all values, written on vertices of the tree after processing all queries."          
              1100.0                         1070K "Video Posts" implementation "Polycarp took n videos, the duration of the i-th video is ai seconds. The videos are listed in the chronological order, i.e. the 1-st video is the earliest, the 2-nd video is the next, ..., the n-th video is the last.Now Polycarp wants to publish exactly k (1\xe2\x89\xa4k\xe2\x89\xa4n) posts in Instabram. Each video should be a part of a single post. The posts should preserve the chronological order, it means that the first post should contain one or more of the earliest videos, the second post should contain a block (one or more videos) going next and so on. In other words, if the number of videos in the j-th post is sj then:  s1+s2+\xe2\x8b\xaf+sk=n (si>0),  the first post contains the videos: 1,2,\xe2\x80\xa6,s1;  the second post contains the videos: s1+1,s1+2,\xe2\x80\xa6,s1+s2;  the third post contains the videos: s1+s2+1,s1+s2+2,\xe2\x80\xa6,s1+s2+s3;  ...  the k-th post contains videos: n\xe2\x88\x92sk+1,n\xe2\x88\x92sk+2,\xe2\x80\xa6,n. Polycarp is a perfectionist, he wants the total duration of videos in each post to be the same.Help Polycarp to find such positive integer values s1,s2,\xe2\x80\xa6,sk that satisfy all the conditions above."          
              2400.0                         1070I "Privatization of Roads in Berland" "flows,graph matchings,graphs" "There are n cities and m two-way roads in Berland, each road connecting two distinct cities.Recently the Berland government has made a tough decision to transfer ownership of the roads to private companies. In total, there are 100500 private companies in Berland, numbered by integers from 1 to 100500. After the privatization, every road should belong to exactly one company.The anti-monopoly committee demands that after the privatization each company can own at most two roads. The urbanists of Berland also stated their opinion: each city should be adjacent to the roads owned by at most k companies.Help the government to distribute the roads between the companies so that both conditions are satisfied. That is, each company gets at most two roads, and each city has roads of at most k distinct companies adjacent to it."          
              2100.0                         1070E "Getting Deals Done" "binary search,data structures" "Polycarp has a lot of work to do. Recently he has learned a new time management rule: ""if a task takes five minutes or less, do it immediately"". Polycarp likes the new rule, however he is not sure that five minutes is the optimal value. He supposes that this value d should be chosen based on existing task list.Polycarp has a list of n tasks to complete. The i-th task has difficulty pi, i.e. it requires exactly pi minutes to be done. Polycarp reads the tasks one by one from the first to the n-th. If a task difficulty is d or less, Polycarp starts the work on the task immediately. If a task difficulty is strictly greater than d, he will not do the task at all. It is not allowed to rearrange tasks in the list. Polycarp doesn\'t spend any time for reading a task or skipping it.Polycarp has t minutes in total to complete maximum number of tasks. But he does not want to work all the time. He decides to make a break after each group of m consecutive tasks he was working on. The break should take the same amount of time as it was spent in total on completion of these m tasks.For example, if n=7, p=[3,1,4,1,5,9,2], d=3 and m=2 Polycarp works by the following schedule:  Polycarp reads the first task, its difficulty is not greater than d (p1=3\xe2\x89\xa4d=3) and works for 3 minutes (i.e. the minutes 1, 2, 3);  Polycarp reads the second task, its difficulty is not greater than d (p2=1\xe2\x89\xa4d=3) and works for 1 minute (i.e. the minute 4);  Polycarp notices that he has finished m=2 tasks and takes a break for 3+1=4 minutes (i.e. on the minutes 5,6,7,8);  Polycarp reads the third task, its difficulty is greater than d (p3=4>d=3) and skips it without spending any time;  Polycarp reads the fourth task, its difficulty is not greater than d (p4=1\xe2\x89\xa4d=3) and works for 1 minute (i.e. the minute 9);  Polycarp reads the tasks 5 and 6, skips both of them (p5>d and p6>d);  Polycarp reads the 7-th task, its difficulty is not greater than d (p7=2\xe2\x89\xa4d=3) and works for 2 minutes (i.e. the minutes 10, 11);  Polycarp notices that he has finished m=2 tasks and takes a break for 1+2=3 minutes (i.e. on the minutes 12,13,14). Polycarp stops exactly after t minutes. If Polycarp started a task but has not finished it by that time, the task is not considered as completed. It is allowed to complete less than m tasks in the last group. Also Polycarp considers acceptable to have shorter break than needed after the last group of tasks or even not to have this break at all \xe2\x80\x94 his working day is over and he will have enough time to rest anyway.Please help Polycarp to find such value d, which would allow him to complete maximum possible number of tasks in t minutes."          
              2000.0                         1070C "Cloud Computing" "data structures,greedy" "Buber is a Berland technology company that specializes in waste of investor\'s money. Recently Buber decided to transfer its infrastructure to a cloud. The company decided to rent CPU cores in the cloud for n consecutive days, which are numbered from 1 to n. Buber requires k CPU cores each day.The cloud provider offers m tariff plans, the i-th tariff plan is characterized by the following parameters:  li and ri \xe2\x80\x94 the i-th tariff plan is available only on days from li to ri, inclusive,  ci \xe2\x80\x94 the number of cores per day available for rent on the i-th tariff plan,  pi \xe2\x80\x94 the price of renting one core per day on the i-th tariff plan. Buber can arbitrarily share its computing core needs between the tariff plans. Every day Buber can rent an arbitrary number of cores (from 0 to ci) on each of the available plans. The number of rented cores on a tariff plan can vary arbitrarily from day to day.Find the minimum amount of money that Buber will pay for its work for n days from 1 to n. If on a day the total number of cores for all available tariff plans is strictly less than k, then this day Buber will have to work on fewer cores (and it rents all the available cores), otherwise Buber rents exactly k cores this day."          
              1400.0                         1068A Birthday math "Ivan is collecting coins. There are only N different collectible coins, Ivan has K of them. He will be celebrating his birthday soon, so all his M freinds decided to gift him coins. They all agreed to three terms:  Everyone must gift as many coins as others. All coins given to Ivan must be different. Not less than L coins from gifts altogether, must be new in Ivan\'s collection.But his friends don\'t know which coins have Ivan already got in his collection. They don\'t want to spend money so they want to buy minimum quantity of coins, that satisfy all terms, irrespective of the Ivan\'s collection. Help them to find this minimum number of coins or define it\'s not possible to meet all the terms."          
              1700.0                         1066E "Binary Numbers AND Sum" "data structures,implementation,math" "You are given two huge binary integer numbers a and b of lengths n and m respectively. You will repeat the following process: if b>0, then add to the answer the value a & b and divide b by 2 rounding down (i.e. remove the last digit of b), and repeat the process again, otherwise stop the process.The value a & b means bitwise AND of a and b. Your task is to calculate the answer modulo 998244353.Note that you should add the value a & b to the answer in decimal notation, not in binary. So your task is to calculate the answer in decimal notation. For example, if a=10102 (1010) and b=10002 (810), then the value a & b will be equal to 8, not to 1000."          
              2500.0                         1065F "Up and Down the Tree" "dfs and similar,dp,trees" "You are given a tree with n vertices; its root is vertex 1. Also there is a token, initially placed in the root. You can move the token to other vertices. Let\'s assume current vertex of token is v, then you make any of the following two possible moves:   move down to any leaf in subtree of v;  if vertex v is a leaf, then move up to the parent no more than k times. In other words, if h(v) is the depth of vertex v (the depth of the root is 0), then you can move to vertex to such that to is an ancestor of v and h(v)\xe2\x88\x92k\xe2\x89\xa4h(to). Consider that root is not a leaf (even if its degree is 1). Calculate the maximum number of different leaves you can visit during one sequence of moves."          
              1800.0                         1062D "Fun with Integers" "dfs and similar,graphs,implementation,math" "You are given a positive integer n greater or equal to 2. For every pair of integers a and b (2\xe2\x89\xa4|a|,|b|\xe2\x89\xa4n), you can transform a into b if and only if there exists an integer x such that 1<|x| and (a\xe2\x8b\x85x=b or b\xe2\x8b\x85x=a), where |x| denotes the absolute value of x.After such a transformation, your score increases by |x| points and you are not allowed to transform a into b nor b into a anymore.Initially, you have a score of 0. You can start at any integer and transform it as many times as you like. What is the maximum score you can achieve?"          
              1500.0                         1062B Math "greedy,math,number theory" "JATC\'s math teacher always gives the class some interesting math problems so that they don\'t get bored. Today the problem is as follows. Given an integer n, you can perform the following operations zero or more times:  mul x: multiplies n by x (where x is an arbitrary positive integer).  sqrt: replaces n with \xe2\x88\x9an (to apply this operation, \xe2\x88\x9an must be an integer). You can perform these operations as many times as you like. What is the minimum value of n, that can be achieved and what is the minimum number of operations, to achieve that minimum value?Apparently, no one in the class knows the answer to this problem, maybe you can help them?"          
              2400.0                         1061F "Lost Root" interactive,probabilities "The graph is called tree if it is connected and has no cycles. Suppose the tree is rooted at some vertex. Then tree is called to be perfect k-ary tree if each vertex is either a leaf (has no children) or has exactly k children. Also, in perfect k-ary tree all leafs must have same depth.For example, the picture below illustrates perfect binary tree with 15 vertices:There is a perfect k-ary tree with n nodes. The nodes are labeled with distinct integers from 1 to n, however you don\'t know how nodes are labelled. Still, you want to find the label of the root of the tree.You are allowed to make at most 60\xe2\x8b\x85n queries of the following type:  ""? a b c"", the query returns ""Yes"" if node with label b lies on the path from a to c and ""No"" otherwise. Both a and c are considered to be lying on the path from a to c.When you are ready to report the root of the tree, print   ""! s"", where s is the label of the root of the tree. It is possible to report the root only once and this query is not counted towards limit of 60\xe2\x8b\x85n queries."          
              2600.0                         1061E Politics flows,graphs "There are n cities in the country. Two candidates are fighting for the post of the President. The elections are set in the future, and both candidates have already planned how they are going to connect the cities with roads. Both plans will connect all cities using n\xe2\x88\x921 roads only. That is, each plan can be viewed as a tree. Both of the candidates had also specified their choice of the capital among n cities (x for the first candidate and y for the second candidate), which may or may not be same.Each city has a potential of building a port (one city can have at most one port). Building a port in i-th city brings ai amount of money. However, each candidate has his specific demands. The demands are of the form:   k x, which means that the candidate wants to build exactly x ports in the subtree of the k-th city of his tree (the tree is rooted at the capital of his choice). Find out the maximum revenue that can be gained while fulfilling all demands of both candidates, or print -1 if it is not possible to do.It is additionally guaranteed, that each candidate has specified the port demands for the capital of his choice."          
              3500.0                         1054H "Epic Convolution" "chinese remainder theorem,fft,math,number theory" "You are given two arrays a0,a1,\xe2\x80\xa6,an\xe2\x88\x921 and b0,b1,\xe2\x80\xa6,bm\xe2\x88\x921, and an integer c.Compute the following sum:n\xe2\x88\x921\xe2\x88\x91i=0m\xe2\x88\x921\xe2\x88\x91j=0aibjci2j3Since it\'s value can be really large, print it modulo 490019."          
              2700.0                         1054F "Electric Scheme" "flows,graph matchings" "Pasha is a young technician, nevertheless, he has already got a huge goal: to assemble a PC. The first task he has to become familiar with is to assemble an electric scheme.The scheme Pasha assembled yesterday consists of several wires. Each wire is a segment that connects two points on a plane with integer coordinates within the segment [1,109].There are wires of two colors in the scheme:   red wires: these wires are horizontal segments, i.e. if such a wire connects two points (x1,y1) and (x2,y2), then y1=y2;  blue wires: these wires are vertical segments, i.e. if such a wire connects two points (x1,y1) and (x2,y2), then x1=x2. Note that if a wire connects a point to itself, it may be blue, and it can be red. Also, in Pasha\'s scheme no two wires of the same color intersect, i.e. there are no two wires of same color that have common points.The imperfection of Pasha\'s scheme was that the wires were not isolated, so in the points where two wires of different colors intersect, Pasha saw sparks. Pasha wrote down all the points where he saw sparks and obtained a set of n distinct points. After that he disassembled the scheme.Next morning Pasha looked at the set of n points where he had seen sparks and wondered how many wires had he used. Unfortunately, he does not remember that, so he wonders now what is the smallest number of wires he might have used in the scheme. Help him to determine this number and place the wires in such a way that in the resulting scheme the sparks occur in the same places."          
              800.0                         1047A "Little C Loves 3 I" math "Little C loves number \xc2\xab3\xc2\xbb very much. He loves all things about it.Now he has a positive integer n. He wants to split n into 3 positive integers a,b,c, such that a+b+c=n and none of the 3 integers is a multiple of 3. Help him to find a solution."          
              2400.0                         1044D "Deduction Queries" "data structures,dsu" "There is an array a of 230 integers, indexed from 0 to 230\xe2\x88\x921. Initially, you know that 0\xe2\x89\xa4ai<230 (0\xe2\x89\xa4i<230), but you do not know any of the values. Your task is to process queries of two types: 1 l r x: You are informed that the bitwise xor of the subarray [l,r] (ends inclusive) is equal to x. That is, al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar\xe2\x88\x921\xe2\x8a\x95ar=x, where \xe2\x8a\x95 is the bitwise xor operator. In some cases, the received update contradicts past updates. In this case, you should ignore the contradicting update (the current update). 2 l r: You are asked to output the bitwise xor of the subarray [l,r] (ends inclusive). If it is still impossible to know this value, considering all past updates, then output \xe2\x88\x921.Note that the queries are encoded. That is, you need to write an online solution."          
              1900.0                         1044B "Intersecting Subtrees" "dfs and similar,interactive,trees" "You are playing a strange game with Li Chen. You have a tree with n nodes drawn on a piece of paper. All nodes are unlabeled and distinguishable. Each of you independently labeled the vertices from 1 to n. Neither of you know the other\'s labelling of the tree.You and Li Chen each chose a subtree (i.e., a connected subgraph) in that tree. Your subtree consists of the vertices labeled x1,x2,\xe2\x80\xa6,xk1 in your labeling, Li Chen\'s subtree consists of the vertices labeled y1,y2,\xe2\x80\xa6,yk2 in his labeling. The values of x1,x2,\xe2\x80\xa6,xk1 and y1,y2,\xe2\x80\xa6,yk2 are known to both of you.   The picture shows two labelings of a possible tree: yours on the left and Li Chen\'s on the right. The selected trees are highlighted. There are two common nodes. You want to determine whether your subtrees have at least one common vertex. Luckily, your friend Andrew knows both labelings of the tree. You can ask Andrew at most 5 questions, each of which is in one of the following two forms:   A x: Andrew will look at vertex x in your labeling and tell you the number of this vertex in Li Chen\'s labeling.  B y: Andrew will look at vertex y in Li Chen\'s labeling and tell you the number of this vertex in your labeling. Determine whether the two subtrees have at least one common vertex after asking some questions. If there is at least one common vertex, determine one of your labels for any of the common vertices."          
              1700.0                         1044A "The Tower is Going Home" "binary search,two pointers" "On a chessboard with a width of 109 and a height of 109, the rows are numbered from bottom to top from 1 to 109, and the columns are numbered from left to right from 1 to 109. Therefore, for each cell of the chessboard you can assign the coordinates (x,y), where x is the column number and y is the row number.Every day there are fights between black and white pieces on this board. Today, the black ones won, but at what price? Only the rook survived, and it was driven into the lower left corner \xe2\x80\x94 a cell with coordinates (1,1). But it is still happy, because the victory has been won and it\'s time to celebrate it! In order to do this, the rook needs to go home, namely \xe2\x80\x94 on the upper side of the field (that is, in any cell that is in the row with number 109).Everything would have been fine, but the treacherous white figures put spells on some places of the field before the end of the game. There are two types of spells:   Vertical. Each of these is defined by one number x. Such spells create an infinite blocking line between the columns x and x+1.  Horizontal. Each of these is defined by three numbers x1, x2, y. Such spells create a blocking segment that passes through the top side of the cells, which are in the row y and in columns from x1 to x2 inclusive. The peculiarity of these spells is that it is impossible for a certain pair of such spells to have a common point. Note that horizontal spells can have common points with vertical spells.    An example of a chessboard. Let\'s recall that the rook is a chess piece that in one move can move to any point that is in the same row or column with its initial position. In our task, the rook can move from the cell (r0,c0) into the cell (r1,c1) only under the condition that r1=r0 or c1=c0 and there is no blocking lines or blocking segments between these cells (For better understanding, look at the samples).Fortunately, the rook can remove spells, but for this it has to put tremendous efforts, therefore, it wants to remove the minimum possible number of spells in such way, that after this it can return home. Find this number!"          
              1200.0                         1043B "Lost Array" implementation "Bajtek, known for his unusual gifts, recently got an integer array x0,x1,\xe2\x80\xa6,xk\xe2\x88\x921.Unfortunately, after a huge array-party with his extraordinary friends, he realized that he\'d lost it. After hours spent on searching for a new toy, Bajtek found on the arrays producer\'s website another array a of length n+1. As a formal description of a says, a0=0 and for all other i (1\xe2\x89\xa4i\xe2\x89\xa4n) ai=x(i\xe2\x88\x921)modk+ai\xe2\x88\x921, where pmodq denotes the remainder of division p by q.For example, if the x=[1,2,3] and n=5, then:  a0=0,  a1=x0mod3+a0=x0+0=1,  a2=x1mod3+a1=x1+1=3,  a3=x2mod3+a2=x2+3=6,  a4=x3mod3+a3=x0+6=7,  a5=x4mod3+a4=x1+7=9. So, if the x=[1,2,3] and n=5, then a=[0,1,3,6,7,9].Now the boy hopes that he will be able to restore x from a! Knowing that 1\xe2\x89\xa4k\xe2\x89\xa4n, help him and find all possible values of k \xe2\x80\x94 possible lengths of the lost array."          
              1800.0                         1042D "Petya and Array" "data structures,divide and conquer,two pointers" "Petya has an array a consisting of n integers. He has learned partial sums recently, and now he can calculate the sum of elements on any segment of the array really fast. The segment is a non-empty sequence of elements standing one next to another in the array.Now he wonders what is the number of segments in his array with the sum less than t. Help Petya to calculate this number.More formally, you are required to calculate the number of pairs l,r (l\xe2\x89\xa4r) such that al+al+1+\xe2\x8b\xaf+ar\xe2\x88\x921+ar<t."          
              1700.0                         1042C "Array Product" "constructive algorithms,greedy,math" "You are given an array a consisting of n integers. You can perform the following operations with it:   Choose some positions i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n,i\xe2\x89\xa0j), write the value of ai\xe2\x8b\x85aj into the j-th cell and remove the number from the i-th cell;  Choose some position i and remove the number from the i-th cell (this operation can be performed no more than once and at any point of time, not necessarily in the beginning). The number of elements decreases by one after each operation. However, the indexing of positions stays the same. Deleted numbers can\'t be used in the later operations.Your task is to perform exactly n\xe2\x88\x921 operations with the array in such a way that the only number that remains in the array is maximum possible. This number can be rather large, so instead of printing it you need to print any sequence of operations which leads to this maximum number. Read the output format to understand what exactly you need to print."          
              1300.0                         1040B "Shashlik Cooking" dp,greedy,math "Long story short, shashlik is Miroslav\'s favorite food. Shashlik is prepared on several skewers simultaneously. There are two states for each skewer: initial and turned over.This time Miroslav laid out n skewers parallel to each other, and enumerated them with consecutive integers from 1 to n in order from left to right. For better cooking, he puts them quite close to each other, so when he turns skewer number i, it leads to turning k closest skewers from each side of the skewer i, that is, skewers number i\xe2\x88\x92k, i\xe2\x88\x92k+1, ..., i\xe2\x88\x921, i+1, ..., i+k\xe2\x88\x921, i+k (if they exist). For example, let n=6 and k=1. When Miroslav turns skewer number 3, then skewers with numbers 2, 3, and 4 will come up turned over. If after that he turns skewer number 1, then skewers number 1, 3, and 4 will be turned over, while skewer number 2 will be in the initial position (because it is turned again).As we said before, the art of cooking requires perfect timing, so Miroslav wants to turn over all n skewers with the minimal possible number of actions. For example, for the above example n=6 and k=1, two turnings are sufficient: he can turn over skewers number 2 and 5.Help Miroslav turn over all n skewers."          
              2400.0                         1038E "Maximum Matching" "bitmasks,brute force,dfs and similar,dp,graphs" "You are given n blocks, each of them is of the form [color1|value|color2], where the block can also be flipped to get [color2|value|color1]. A sequence of blocks is called valid if the touching endpoints of neighboring blocks have the same color. For example, the sequence of three blocks A, B and C is valid if the left color of the B is the same as the right color of the A and the right color of the B is the same as the left color of C.The value of the sequence is defined as the sum of the values of the blocks in this sequence.Find the maximum possible value of the valid sequence that can be constructed from the subset of the given blocks. The blocks from the subset can be reordered and flipped if necessary. Each block can be used at most once in the sequence."          
              1300.0                         1037C Equalize dp,greedy,strings "You are given two binary strings a and b of the same length. You can perform the following two operations on the string a:  Swap any two bits at indices i and j respectively (1\xe2\x89\xa4i,j\xe2\x89\xa4n), the cost of this operation is |i\xe2\x88\x92j|, that is, the absolute difference between i and j.  Select any arbitrary index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and flip (change 0 to 1 or 1 to 0) the bit at this index. The cost of this operation is 1. Find the minimum cost to make the string a equal to b. It is not allowed to modify string b."          
              1300.0                         1037A Packets "constructive algorithms,greedy,math" "You have n coins, each of the same value of 1.Distribute them into packets such that any amount x (1\xe2\x89\xa4x\xe2\x89\xa4n) can be formed using some (possibly one or all) number of these packets.Each packet may only be used entirely or not used at all. No packet may be used more than once in the formation of the single x, however it may be reused for the formation of other x\'s.Find the minimum number of packets in such a distribution."          
              1600.0                         1036D "Vasya and Arrays" "greedy,two pointers" "Vasya has two arrays A and B of lengths n and m, respectively.He can perform the following operation arbitrary number of times (possibly zero): he takes some consecutive subsegment of the array and replaces it with a single element, equal to the sum of all elements on this subsegment. For example, from the array [1,10,100,1000,10000] Vasya can obtain array [1,1110,10000], and from array [1,2,3] Vasya can obtain array [6].Two arrays A and B are considered equal if and only if they have the same length and for each valid i Ai=Bi.Vasya wants to perform some of these operations on array A, some on array B, in such a way that arrays A and B become equal. Moreover, the lengths of the resulting arrays should be maximal possible.Help Vasya to determine the maximum length of the arrays that he can achieve or output that it is impossible to make arrays A and B equal."          
              1900.0                         1036C "Classy Numbers" combinatorics,dp "Let\'s call some positive integer classy if its decimal representation contains no more than 3 non-zero digits. For example, numbers 4, 200000, 10203 are classy and numbers 4231, 102306, 7277420000 are not.You are given a segment [L;R]. Count the number of classy integers x such that L\xe2\x89\xa4x\xe2\x89\xa4R.Each testcase contains several segments, for each of them you are required to solve the problem separately."          
              1600.0                         1036B "Diagonal Walking v.2" math "Mikhail walks on a Cartesian plane. He starts at the point (0,0), and in one move he can go to any of eight adjacent points. For example, if Mikhail is currently at the point (0,0), he can go to any of the following points in one move:   (1,0);  (1,1);  (0,1);  (\xe2\x88\x921,1);  (\xe2\x88\x921,0);  (\xe2\x88\x921,\xe2\x88\x921);  (0,\xe2\x88\x921);  (1,\xe2\x88\x921). If Mikhail goes from the point (x1,y1) to the point (x2,y2) in one move, and x1\xe2\x89\xa0x2 and y1\xe2\x89\xa0y2, then such a move is called a diagonal move.Mikhail has q queries. For the i-th query Mikhail\'s target is to go to the point (ni,mi) from the point (0,0) in exactly ki moves. Among all possible movements he want to choose one with the maximum number of diagonal moves. Your task is to find the maximum number of diagonal moves or find that it is impossible to go from the point (0,0) to the point (ni,mi) in ki moves.Note that Mikhail can visit any point any number of times (even the destination point!)."          
              3500.0                         1034D "Intervals of Intervals" "binary search,data structures,two pointers" "Little D is a friend of Little C who loves intervals very much instead of number ""3"".Now he has n intervals on the number axis, the i-th of which is [ai,bi].Only the n intervals can not satisfy him. He defines the value of an interval of intervals [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, l and r are both integers) as the total length of the union of intervals from the l-th to the r-th.He wants to select exactly k different intervals of intervals such that the sum of their values is maximal. Please help him calculate the maximal sum."          
              2100.0                         1032E "The Unbearable Lightness of Weights" dp,math "You have a set of n weights. You know that their masses are a1, a2, ..., an grams, but you don\'t know which of them has which mass. You can\'t distinguish the weights.However, your friend does know the mass of each weight. You can ask your friend to give you exactly k weights with the total mass m (both parameters k and m are chosen by you), and your friend will point to any valid subset of weights, if it is possible.You are allowed to make this query only once. Find the maximum possible number of weights you can reveal after this query."          
              800.0                         1031A "Golden Plate" implementation,math "You have a plate and you want to add some gilding to it. The plate is a rectangle that we split into w\xc3\x97h cells. There should be k gilded rings, the first one should go along the edge of the plate, the second one \xe2\x80\x94 2 cells away from the edge and so on. Each ring has a width of 1 cell. Formally, the i-th of these rings should consist of all bordering cells on the inner rectangle of size (w\xe2\x88\x924(i\xe2\x88\x921))\xc3\x97(h\xe2\x88\x924(i\xe2\x88\x921)).  The picture corresponds to the third example. Your task is to compute the number of cells to be gilded."          
              2900.0                         1030G "Linear Congruential Generator" "number theory" "You are given a tuple generator f(k)=(f(k)1,f(k)2,\xe2\x80\xa6,f(k)n), where f(k)i=(ai\xe2\x8b\x85f(k\xe2\x88\x921)i+bi)modpi and f(0)=(x1,x2,\xe2\x80\xa6,xn). Here xmody denotes the remainder of x when divided by y. All pi are primes.One can see that with fixed sequences xi, yi, ai the tuples f(k) starting from some index will repeat tuples with smaller indices. Calculate the maximum number of different tuples (from all f(k) for k\xe2\x89\xa50) that can be produced by this generator, if xi, ai, bi are integers in the range [0,pi\xe2\x88\x921] and can be chosen arbitrary. The answer can be large, so print the remainder it gives when divided by 109+7"          
              1300.0                         1030C "Vasya and Golden Ticket" implementation "Recently Vasya found a golden ticket \xe2\x80\x94 a sequence which consists of n digits a1a2\xe2\x80\xa6an. Vasya considers a ticket to be lucky if it can be divided into two or more non-intersecting segments with equal sums. For example, ticket 350178 is lucky since it can be divided into three segments 350, 17 and 8: 3+5+0=1+7=8. Note that each digit of sequence should belong to exactly one segment.Help Vasya! Tell him if the golden ticket he found is lucky or not."          
              3000.0                         1028G "Guess the number" dp,interactive "This problem is interactive.You should guess hidden number x which is between 1 and M=10004205361450474, inclusive.You could use up to 5 queries.In each query, you can output an increasing sequence of k\xe2\x89\xa4x integers, each between 1 and M, inclusive, and you will obtain one of the following as an answer:  either the hidden number belongs to your query sequence, in this case you immediately win;  or you will be given where the hidden number is located with respect to your query sequence, that is, either it is less than all numbers from the sequence, greater than all numbers from the sequence, or you will be given such an i that the hidden number x is between the i-th and the (i+1)-st numbers of your sequence. See the interaction section for clarity.Be aware that the interactor is adaptive, i.e. the hidden number can depend on queries the solution makes. However, it is guaranteed that for any solution the interactor works non-distinguishable from the situation when the hidden number is fixed beforehand.Hacks are allowed only with fixed hidden number. A hack is represented by a single integer between 1 and M. In all pretests the hidden number is fixed as well."          
              1200.0                         1028B "Unnatural Conditions" "constructive algorithms,math" "Let s(x) be sum of digits in decimal representation of positive integer x. Given two integers n and m, find some positive integers a and b such that   s(a)\xe2\x89\xa5n,  s(b)\xe2\x89\xa5n,  s(a+b)\xe2\x89\xa4m."          
              1600.0                         1027C "Minimum Value Rectangle" greedy "You have n sticks of the given lengths.Your task is to choose exactly four of them in such a way that they can form a rectangle. No sticks can be cut to pieces, each side of the rectangle must be formed by a single stick. No stick can be chosen multiple times. It is guaranteed that it is always possible to choose such sticks.Let S be the area of the rectangle and P be the perimeter of the rectangle. The chosen rectangle should have the value P2S minimal possible. The value is taken without any rounding.If there are multiple answers, print any of them.Each testcase contains several lists of sticks, for each of them you are required to solve the problem separately."          
              2700.0                         1025E "Colored Cubes" "constructive algorithms,implementation,matrices" "Vasya passes all exams! Despite expectations, Vasya is not tired, moreover, he is ready for new challenges. However, he does not want to work too hard on difficult problems.Vasya remembered that he has a not-so-hard puzzle: m colored cubes are placed on a chessboard of size n\xc3\x97n. The fact is that m\xe2\x89\xa4n and all cubes have distinct colors. Each cube occupies exactly one cell. Also, there is a designated cell for each cube on the board, the puzzle is to place each cube on its place. The cubes are fragile, so in one operation you only can move one cube onto one of four neighboring by side cells, if only it is empty. Vasya wants to be careful, so each operation takes exactly one second. Vasya used to train hard for VK Cup Final, so he can focus his attention on the puzzle for at most 3 hours, that is 10800 seconds. Help Vasya find such a sequence of operations that all cubes will be moved onto their designated places, and Vasya won\'t lose his attention."          
              800.0                         1017A "The Rank" implementation "John Smith knows that his son, Thomas Smith, is among the best students in his class and even in his school. After the students of the school took the exams in English, German, Math, and History, a table of results was formed.There are n students, each of them has a unique id (from 1 to n). Thomas\'s id is 1. Every student has four scores correspond to his or her English, German, Math, and History scores. The students are given in order of increasing of their ids.In the table, the students will be sorted by decreasing the sum of their scores. So, a student with the largest sum will get the first place. If two or more students have the same sum, these students will be sorted by increasing their ids. Please help John find out the rank of his son."          
              3400.0                         1012F Passports dp,implementation "Gleb is a famous competitive programming teacher from Innopolis. He is planning a trip to N programming camps in the nearest future. Each camp will be held in a different country. For each of them, Gleb needs to apply for a visa. For each of these trips Gleb knows three integers: the number of the first day of the trip si, the length of the trip in days leni, and the number of days ti this country\'s consulate will take to process a visa application and stick a visa in a passport. Gleb has P (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89P\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892) valid passports and is able to decide which visa he wants to put in which passport.For each trip, Gleb will have a flight to that country early in the morning of the day si and will return back late in the evening of the day si\xe2\x80\x89+\xe2\x80\x89leni\xe2\x80\x89-\xe2\x80\x891.To apply for a visa on the day d, Gleb needs to be in Innopolis in the middle of this day. So he can\'t apply for a visa while he is on a trip, including the first and the last days. If a trip starts the next day after the end of the other one, Gleb can\'t apply for a visa between them as well. The earliest Gleb can apply for a visa is day 1.After applying for a visa of country i on day d, Gleb will get his passport back in the middle of the day d\xe2\x80\x89+\xe2\x80\x89ti. Consulates use delivery services, so Gleb can get his passport back even if he is not in Innopolis on this day. Gleb can apply for another visa on the same day he received his passport back, if he is in Innopolis this day. Gleb will not be able to start his trip on day si if he doesn\'t has a passport with a visa for the corresponding country in the morning of day si. In particular, the passport should not be in another country\'s consulate for visa processing.Help Gleb to decide which visas he needs to receive in which passport, and when he should apply for each visa."          
              3400.0                         1010F Tree fft,graphs,trees "The Main Martian Tree grows on Mars. It is a binary tree (a rooted tree, with no more than two sons at each vertex) with n vertices, where the root vertex has the number 1. Its fruits are the Main Martian Fruits. It\'s summer now, so this tree does not have any fruit yet.Autumn is coming soon, and leaves and branches will begin to fall off the tree. It is clear, that if a vertex falls off the tree, then its entire subtree will fall off too. In addition, the root will remain on the tree. Formally: the tree will have some connected subset of vertices containing the root.After that, the fruits will grow on the tree (only at those vertices which remain). Exactly x fruits will grow in the root. The number of fruits in each remaining vertex will be not less than the sum of the numbers of fruits in the remaining sons of this vertex. It is allowed, that some vertices will not have any fruits.Natasha wondered how many tree configurations can be after the described changes. Since this number can be very large, output it modulo 998244353.Two configurations of the resulting tree are considered different if one of these two conditions is true: they have different subsets of remaining vertices; they have the same subset of remaining vertices, but there is a vertex in this subset where they have a different amount of fruits."          
              2000.0                         1009E "Intercity Travelling" combinatorics,math,probabilities "Leha is planning his journey from Moscow to Saratov. He hates trains, so he has decided to get from one city to another by car.The path from Moscow to Saratov can be represented as a straight line (well, it\'s not that straight in reality, but in this problem we will consider it to be straight), and the distance between Moscow and Saratov is n km. Let\'s say that Moscow is situated at the point with coordinate 0 km, and Saratov \xe2\x80\x94 at coordinate n km.Driving for a long time may be really difficult. Formally, if Leha has already covered i kilometers since he stopped to have a rest, he considers the difficulty of covering (i+1)-th kilometer as ai+1. It is guaranteed that for every i\xe2\x88\x88[1,n\xe2\x88\x921] ai\xe2\x89\xa4ai+1. The difficulty of the journey is denoted as the sum of difficulties of each kilometer in the journey.Fortunately, there may be some rest sites between Moscow and Saratov. Every integer point from 1 to n\xe2\x88\x921 may contain a rest site. When Leha enters a rest site, he may have a rest, and the next kilometer will have difficulty a1, the kilometer after it \xe2\x80\x94 difficulty a2, and so on.For example, if n=5 and there is a rest site in coordinate 2, the difficulty of journey will be 2a1+2a2+a3: the first kilometer will have difficulty a1, the second one \xe2\x80\x94 a2, then Leha will have a rest, and the third kilometer will have difficulty a1, the fourth \xe2\x80\x94 a2, and the last one \xe2\x80\x94 a3. Another example: if n=7 and there are rest sites in coordinates 1 and 5, the difficulty of Leha\'s journey is 3a1+2a2+a3+a4.Leha doesn\'t know which integer points contain rest sites. So he has to consider every possible situation. Obviously, there are 2n\xe2\x88\x921 different distributions of rest sites (two distributions are different if there exists some point x such that it contains a rest site in exactly one of these distributions). Leha considers all these distributions to be equiprobable. He wants to calculate p \xe2\x80\x94 the expected value of difficulty of his journey.Obviously, p\xe2\x8b\x852n\xe2\x88\x921 is an integer number. You have to calculate it modulo 998244353."          
              3400.0                         1007E "Mini Metro" dp "In a simplified version of a ""Mini Metro"" game, there is only one subway line, and all the trains go in the same direction. There are n stations on the line, ai people are waiting for the train at the i-th station at the beginning of the game. The game starts at the beginning of the 0-th hour. At the end of each hour (couple minutes before the end of the hour), bi people instantly arrive to the i-th station. If at some moment, the number of people at the i-th station is larger than ci, you lose.A player has several trains which he can appoint to some hours. The capacity of each train is k passengers. In the middle of the appointed hour, the train goes from the 1-st to the n-th station, taking as many people at each station as it can accommodate. A train can not take people from the i-th station if there are people at the i\xe2\x88\x921-th station.If multiple trains are appointed to the same hour, their capacities are being added up and they are moving together.The player wants to stay in the game for t hours. Determine the minimum number of trains he will need for it."          
              3000.0                         1007C "Guess two numbers" "binary search,interactive" "This is an interactive problem.Vasya and Vitya play a game. Vasya thought of two integers a and b from 1 to n and Vitya tries to guess them. Each round he tells Vasya two numbers x and y from 1 to n. If both x=a and y=b then Vitya wins. Else Vasya must say one of the three phrases:   x is less than a;  y is less than b;  x is greater than a or y is greater than b. Vasya can\'t lie, but if multiple phrases are true, he may choose any of them. For example, if Vasya thought of numbers 2 and 4, then he answers with the phrase 3 to a query (3,4), and he can answer with the phrase 1 or phrase 3 to a query (1,5).Help Vitya win in no more than 600 rounds."          
              1200.0                         1006C "Three Parts of the Array" "binary search,data structures,two pointers" "You are given an array d1,d2,\xe2\x80\xa6,dn consisting of n integer numbers.Your task is to split this array into three parts (some of which may be empty) in such a way that each element of the array belongs to exactly one of the three parts, and each of the parts forms a consecutive contiguous subsegment (possibly, empty) of the original array. Let the sum of elements of the first part be sum1, the sum of elements of the second part be sum2 and the sum of elements of the third part be sum3. Among all possible ways to split the array you have to choose a way such that sum1=sum3 and sum1 is maximum possible.More formally, if the first part of the array contains a elements, the second part of the array contains b elements and the third part contains c elements, then:sum1=\xe2\x88\x911\xe2\x89\xa4i\xe2\x89\xa4adi, sum2=\xe2\x88\x91a+1\xe2\x89\xa4i\xe2\x89\xa4a+bdi, sum3=\xe2\x88\x91a+b+1\xe2\x89\xa4i\xe2\x89\xa4a+b+cdi.The sum of an empty array is 0.Your task is to find a way to split the array such that sum1=sum3 and sum1 is maximum possible."          
              2400.0                         1000F "One Occurrence" "data structures,divide and conquer" "You are given an array a consisting of n integers, and q queries to it. i-th query is denoted by two integers li and ri. For each query, you have to find any integer that occurs exactly once in the subarray of a from index li to index ri (a subarray is a contiguous subsegment of an array). For example, if a=[1,1,2,3,2,4], then for query (li=2,ri=6) the subarray we are interested in is [1,2,3,2,4], and possible answers are 1, 3 and 4; for query (li=1,ri=2) the subarray we are interested in is [1,1], and there is no such element that occurs exactly once.Can you answer all of the queries?"          
              2000.0                         999E "Reachability from the Capital" "dfs and similar,graphs,greedy" "There are n cities and m roads in Berland. Each road connects a pair of cities. The roads in Berland are one-way.What is the minimum number of new roads that need to be built to make all the cities reachable from the capital?New roads will also be one-way."          
              2000.0                         997B "Roman Digits" "brute force,combinatorics,dp,greedy,math" "Let\'s introduce a number system which is based on a roman digits. There are digits I, V, X, L which correspond to the numbers 1, 5, 10 and 50 respectively. The use of other roman digits is not allowed.Numbers in this system are written as a sequence of one or more digits. We define the value of the sequence simply as the sum of digits in it.For example, the number XXXV evaluates to 35 and the number IXI \xe2\x80\x94 to 12.Pay attention to the difference to the traditional roman system \xe2\x80\x94 in our system any sequence of digits is valid, moreover the order of digits doesn\'t matter, for example IX means 11, not 9.One can notice that this system is ambiguous, and some numbers can be written in many different ways. Your goal is to determine how many distinct integers can be represented by exactly n roman digits I, V, X, L."          
              2700.0                         995E "Number Clicker" "divide and conquer,graphs,meet-in-the-middle,number theory" "Allen is playing Number Clicker on his phone.He starts with an integer u on the screen. Every second, he can press one of 3 buttons.  Turn u\xe2\x86\x92u+1(modp).  Turn u\xe2\x86\x92u+p\xe2\x88\x921(modp).  Turn u\xe2\x86\x92up\xe2\x88\x922(modp). Allen wants to press at most 200 buttons and end up with v on the screen. Help him!"          
              2500.0                         993D "Compute Power" "binary search,dp,greedy" "You need to execute several tasks, each associated with number of processors it needs, and the compute power it will consume.You have sufficient number of analog computers, each with enough processors for any task. Each computer can execute up to one task at a time, and no more than two tasks total. The first task can be any, the second task on each computer must use strictly less power than the first. You will assign between 1 and 2 tasks to each computer. You will then first execute the first task on each computer, wait for all of them to complete, and then execute the second task on each computer that has two tasks assigned.If the average compute power per utilized processor (the sum of all consumed powers for all tasks presently running divided by the number of utilized processors) across all computers exceeds some unknown threshold during the execution of the first tasks, the entire system will blow up. There is no restriction on the second tasks execution. Find the lowest threshold for which it is possible.Due to the specifics of the task, you need to print the answer multiplied by 1000 and rounded up."          
              2100.0                         993C "Careful Maneuvering" "bitmasks,brute force,geometry" "There are two small spaceship, surrounded by two groups of enemy larger spaceships. The space is a two-dimensional plane, and one group of the enemy spaceships is positioned in such a way that they all have integer y-coordinates, and their x-coordinate is equal to \xe2\x88\x92100, while the second group is positioned in such a way that they all have integer y-coordinates, and their x-coordinate is equal to 100.Each spaceship in both groups will simultaneously shoot two laser shots (infinite ray that destroys any spaceship it touches), one towards each of the small spaceships, all at the same time. The small spaceships will be able to avoid all the laser shots, and now want to position themselves at some locations with x=0 (with not necessarily integer y-coordinates), such that the rays shot at them would destroy as many of the enemy spaceships as possible. Find the largest numbers of spaceships that can be destroyed this way, assuming that the enemy spaceships can\'t avoid laser shots."          
              1600.0                         993A "Two Squares" geometry,implementation "You are given two squares, one with sides parallel to the coordinate axes, and another one with sides at 45 degrees to the coordinate axes. Find whether the two squares intersect.The interior of the square is considered to be part of the square, i.e. if one square is completely inside another, they intersect. If the two squares only share one common point, they are also considered to intersect."          
              1000.0                         991A "If at first you don\'t succeed..." implementation "Each student eagerly awaits the day he would pass the exams successfully. Thus, Vasya was ready to celebrate, but, alas, he didn\'t pass it. However, many of Vasya\'s fellow students from the same group were more successful and celebrated after the exam.Some of them celebrated in the BugDonalds restaurant, some of them \xe2\x80\x94 in the BeaverKing restaurant, the most successful ones were fast enough to celebrate in both of restaurants. Students which didn\'t pass the exam didn\'t celebrate in any of those restaurants and elected to stay home to prepare for their reexamination. However, this quickly bored Vasya and he started checking celebration photos on the Kilogramm. He found out that, in total, BugDonalds was visited by A students, BeaverKing \xe2\x80\x94 by B students and C students visited both restaurants. Vasya also knows that there are N students in his group.Based on this info, Vasya wants to determine either if his data contradicts itself or, if it doesn\'t, how many students in his group didn\'t pass the exam. Can you help him so he won\'t waste his valuable preparation time?"          
              1400.0                         988C "Equal Sums" implementation,sortings "You are given k sequences of integers. The length of the i-th sequence equals to ni.You have to choose exactly two sequences i and j (i\xe2\x89\xa0j) such that you can remove exactly one element in each of them in such a way that the sum of the changed sequence i (its length will be equal to ni\xe2\x88\x921) equals to the sum of the changed sequence j (its length will be equal to nj\xe2\x88\x921).Note that it\'s required to remove exactly one element in each of the two chosen sequences.Assume that the sum of the empty (of the length equals 0) sequence is 0."          
              2700.0                         985G "Team Players" combinatorics "There are n players numbered from 0 to n\xe2\x88\x921 with ranks. The i-th player has rank i.Players can form teams: the team should consist of three players and no pair of players in the team should have a conflict. The rank of the team is calculated using the following algorithm: let i, j, k be the ranks of players in the team and i<j<k, then the rank of the team is equal to A\xe2\x8b\x85i+B\xe2\x8b\x85j+C\xe2\x8b\x85k.You are given information about the pairs of players who have a conflict. Calculate the total sum of ranks over all possible valid teams modulo 264."          
              2100.0                         985E "Pencils and Boxes" "binary search,data structures,dp,greedy,two pointers" "Mishka received a gift of multicolored pencils for his birthday! Unfortunately he lives in a monochrome world, where everything is of the same color and only saturation differs. This pack can be represented as a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n integer numbers \xe2\x80\x94 saturation of the color of each pencil. Now Mishka wants to put all the mess in the pack in order. He has an infinite number of empty boxes to do this. He would like to fill some boxes in such a way that:  Each pencil belongs to exactly one box;  Each non-empty box has at least k pencils in it;  If pencils i and j belong to the same box, then |ai\xe2\x80\x89-\xe2\x80\x89aj|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d, where |x| means absolute value of x. Note that the opposite is optional, there can be pencils i and j such that |ai\xe2\x80\x89-\xe2\x80\x89aj|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d and they belong to different boxes. Help Mishka to determine if it\'s possible to distribute all the pencils into boxes. Print ""YES"" if there exists such a distribution. Otherwise print ""NO""."          
              2100.0                         985D "Sand Fortress" "binary search,constructive algorithms,math" "You are going to the beach with the idea to build the greatest sand castle ever in your head! The beach is not as three-dimensional as you could have imagined, it can be decribed as a line of spots to pile up sand pillars. Spots are numbered 1 through infinity from left to right. Obviously, there is not enough sand on the beach, so you brought n packs of sand with you. Let height hi of the sand pillar on some spot i be the number of sand packs you spent on it. You can\'t split a sand pack to multiple pillars, all the sand from it should go to a single one. There is a fence of height equal to the height of pillar with H sand packs to the left of the first spot and you should prevent sand from going over it. Finally you ended up with the following conditions to building the castle:  h1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89H: no sand from the leftmost spot should go over the fence;  For any  |hi\xe2\x80\x89-\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891: large difference in heights of two neighboring pillars can lead sand to fall down from the higher one to the lower, you really don\'t want this to happen;  : you want to spend all the sand you brought with you. As you have infinite spots to build, it is always possible to come up with some valid castle structure. Though you want the castle to be as compact as possible. Your task is to calculate the minimum number of spots you can occupy so that all the aforementioned conditions hold."          
              2400.0                         983C Elevator "dp,graphs,shortest paths" "You work in a big office. It is a 9 floor building with an elevator that can accommodate up to 4 people. It is your responsibility to manage this elevator.Today you are late, so there are queues on some floors already. For each person you know the floor where he currently is and the floor he wants to reach. Also, you know the order in which people came to the elevator.According to the company\'s rules, if an employee comes to the elevator earlier than another one, he has to enter the elevator earlier too (even if these employees stay on different floors). Note that the employees are allowed to leave the elevator in arbitrary order.The elevator has two commands:   Go up or down one floor. The movement takes 1 second.  Open the doors on the current floor. During this operation all the employees who have reached their destination get out of the elevator. Then all the employees on the floor get in the elevator in the order they are queued up while it doesn\'t contradict the company\'s rules and there is enough space in the elevator. Each employee spends 1 second to get inside and outside the elevator. Initially the elevator is empty and is located on the floor 1.You are interested what is the minimum possible time you need to spend to deliver all the employees to their destination. It is not necessary to return the elevator to the floor 1."          
              2600.0                         982E Billiard "geometry,number theory" "Consider a billiard table of rectangular size n\xc3\x97m with four pockets. Let\'s introduce a coordinate system with the origin at the lower left corner (see the picture).   There is one ball at the point (x,y) currently. Max comes to the table and strikes the ball. The ball starts moving along a line that is parallel to one of the axes or that makes a 45\xe2\x88\x98 angle with them. We will assume that:   the angles between the directions of the ball before and after a collision with a side are equal,  the ball moves indefinitely long, it only stops when it falls into a pocket,  the ball can be considered as a point, it falls into a pocket if and only if its coordinates coincide with one of the pockets,  initially the ball is not in a pocket. Note that the ball can move along some side, in this case the ball will just fall into the pocket at the end of the side.Your task is to determine whether the ball will fall into a pocket eventually, and if yes, which of the four pockets it will be."          
              1400.0                         981C "Useful Decomposition" implementation,trees "Ramesses knows a lot about problems involving trees (undirected connected graphs without cycles)!He created a new useful tree decomposition, but he does not know how to construct it, so he asked you for help!The decomposition is the splitting the edges of the tree in some simple paths in such a way that each two paths have at least one common vertex. Each edge of the tree should be in exactly one path.Help Remesses, find such a decomposition of the tree or derermine that there is no such decomposition."          
              2200.0                         980E "The Number Games" "data structures,greedy,trees" "The nation of Panel holds an annual show called The Number Games, where each district in the nation will be represented by one contestant.The nation has n districts numbered from 1 to n, each district has exactly one path connecting it to every other district. The number of fans of a contestant from district i is equal to 2i.This year, the president decided to reduce the costs. He wants to remove k contestants from the games. However, the districts of the removed contestants will be furious and will not allow anyone to cross through their districts. The president wants to ensure that all remaining contestants are from districts that can be reached from one another. He also wishes to maximize the total number of fans of the participating contestants.Which contestants should the president remove?"          
              2100.0                         980D "Perfect Groups" "dp,math,number theory" "SaMer has written the greatest test case of all time for one of his problems. For a given array of integers, the problem asks to find the minimum number of groups the array can be divided into, such that the product of any pair of integers in the same group is a perfect square. Each integer must be in exactly one group. However, integers in a group do not necessarily have to be contiguous in the array.SaMer wishes to create more cases from the test case he already has. His test case has an array A of n integers, and he needs to find the number of contiguous subarrays of A that have an answer to the problem equal to k for each integer k between 1 and n (inclusive)."          
              900.0                         980A "Links and Pearls" implementation,math "A necklace can be described as a string of links (\'-\') and pearls (\'o\'), with the last link or pearl connected to the first one.  You can remove a link or a pearl and insert it between two other existing links or pearls (or between a link and a pearl) on the necklace. This process can be repeated as many times as you like, but you can\'t throw away any parts.Can you make the number of links between every two adjacent pearls equal? Two pearls are considered to be adjacent if there is no other pearl between them.Note that the final necklace should remain as one circular part of the same length as the initial necklace."          
              1800.0                         979B "Treasure Hunt" greedy "After the big birthday party, Katie still wanted Shiro to have some more fun. Later, she came up with a game called treasure hunt. Of course, she invited her best friends Kuro and Shiro to play with her.The three friends are very smart so they passed all the challenges very quickly and finally reached the destination. But the treasure can only belong to one cat so they started to think of something which can determine who is worthy of the treasure. Instantly, Kuro came up with some ribbons.A random colorful ribbon is given to each of the cats. Each color of the ribbon can be represented as an uppercase or lowercase Latin letter. Let\'s call a consecutive subsequence of colors that appears in the ribbon a subribbon. The beauty of a ribbon is defined as the maximum number of times one of its subribbon appears in the ribbon. The more the subribbon appears, the more beautiful is the ribbon. For example, the ribbon aaaaaaa has the beauty of 7 because its subribbon a appears 7 times, and the ribbon abcdabc has the beauty of 2 because its subribbon abc appears twice.The rules are simple. The game will have n turns. Every turn, each of the cats must change strictly one color (at one position) in his/her ribbon to an arbitrary color which is different from the unchanged one. For example, a ribbon aaab can be changed into acab in one turn. The one having the most beautiful ribbon after n turns wins the treasure.Could you find out who is going to be the winner if they all play optimally?"          
              800.0                         978B "File Name" greedy,strings "You can not just take the file and send it. When Polycarp trying to send a file in the social network ""Codehorses"", he encountered an unexpected problem. If the name of the file contains three or more ""x"" (lowercase Latin letters ""x"") in a row, the system considers that the file content does not correspond to the social network topic. In this case, the file is not sent and an error message is displayed.Determine the minimum number of characters to remove from the file name so after that the name does not contain ""xxx"" as a substring. Print 0 if the file name does not initially contain a forbidden substring ""xxx"".You can delete characters in arbitrary positions (not necessarily consecutive). If you delete a character, then the length of a string is reduced by 1. For example, if you delete the character in the position 2 from the string ""exxxii"", then the resulting string is ""exxii""."          
              2200.0                         965E "Short Code" "data structures,dp,greedy,strings,trees" "Arkady\'s code contains n variables. Each variable has a unique name consisting of lowercase English letters only. One day Arkady decided to shorten his code.He wants to replace each variable name with its non-empty prefix so that these new names are still unique (however, a new name of some variable can coincide with some old name of another or same variable). Among such possibilities he wants to find the way with the smallest possible total length of the new names.A string a is a prefix of a string b if you can delete some (possibly none) characters from the end of b and obtain a.Please find this minimum possible total length of new names."          
              1900.0                         965D "Single-use Stones" "binary search,flows,greedy,two pointers" "A lot of frogs want to cross a river. A river is w units width, but frogs can only jump l units long, where l<w. Frogs can also jump on lengths shorter than l. but can\'t jump longer. Hopefully, there are some stones in the river to help them.The stones are located at integer distances from the banks. There are ai stones at the distance of i units from the bank the frogs are currently at. Each stone can only be used once by one frog, after that it drowns in the water.What is the maximum number of frogs that can cross the river, given that then can only jump on the stones?"          
              2400.0                         962F "Simple Cycles Edges" "dfs and similar,graphs,trees" "You are given an undirected graph, consisting of n vertices and m edges. The graph does not necessarily connected. Guaranteed, that the graph does not contain multiple edges (more than one edges between a pair of vertices) or loops (edges from a vertex to itself).A cycle in a graph is called a simple, if it contains each own vertex exactly once. So simple cycle doesn\'t allow to visit a vertex more than once in a cycle.Determine the edges, which belong to exactly on one simple cycle."          
              1400.0                         961C Chessboard "bitmasks,brute force,implementation" "Magnus decided to play a classic chess game. Though what he saw in his locker shocked him! His favourite chessboard got broken into 4 pieces, each of size n by n, n is always odd. And what\'s even worse, some squares were of wrong color. j-th square of the i-th row of k-th piece of the board has color ak,\xe2\x80\x89i,\xe2\x80\x89j; 1 being black and 0 being white. Now Magnus wants to change color of some squares in such a way that he recolors minimum number of squares and obtained pieces form a valid chessboard. Every square has its color different to each of the neightbouring by side squares in a valid board. Its size should be 2n by 2n. You are allowed to move pieces but not allowed to rotate or flip them."          
              1900.0                         959E "Mahmoud and Ehab and the xor-MST" bitmasks,dp,graphs,implementation,math "Ehab is interested in the bitwise-xor operation and the special graphs. Mahmoud gave him a problem that combines both. He has a complete graph consisting of n vertices numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891. For all 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89<\xe2\x80\x89n, vertex u and vertex v are connected with an undirected edge that has weight  (where  is the bitwise-xor operation). Can you find the weight of the minimum spanning tree of that graph?You can read about complete graphs in https://en.wikipedia.org/wiki/Complete_graphYou can read about the minimum spanning tree in https://en.wikipedia.org/wiki/Minimum_spanning_treeThe weight of the minimum spanning tree is the sum of the weights on the edges included in it."          
              800.0                         959A "Mahmoud and Ehab and the even-odd game" games,math "Mahmoud and Ehab play a game called the even-odd game. Ehab chooses his favorite integer n and then they take turns, starting from Mahmoud. In each player\'s turn, he has to choose an integer a and subtract it from n such that:  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.  If it\'s Mahmoud\'s turn, a has to be even, but if it\'s Ehab\'s turn, a has to be odd. If the current player can\'t choose any number satisfying the conditions, he loses. Can you determine the winner if they both play optimally?"          
              1500.0                         958F1 "Lightsabers (easy)" implementation "There is unrest in the Galactic Senate. Several thousand solar systems have declared their intentions to leave the Republic. Master Heidi needs to select the Jedi Knights who will go on peacekeeping missions throughout the galaxy. It is well-known that the success of any peacekeeping mission depends on the colors of the lightsabers of the Jedi who will go on that mission. Heidi has n Jedi Knights standing in front of her, each one with a lightsaber of one of m possible colors. She knows that for the mission to be the most effective, she needs to select some contiguous interval of knights such that there are exactly k1 knights with lightsabers of the first color, k2 knights with lightsabers of the second color, ..., km knights with lightsabers of the m-th color. Help her find out if this is possible."          
              1600.0                         958E1 "Guard Duty (easy)" "brute force,geometry,greedy,math" "The Rebel fleet is afraid that the Empire might want to strike back again. Princess Heidi needs to know if it is possible to assign R Rebel spaceships to guard B bases so that every base has exactly one guardian and each spaceship has exactly one assigned base (in other words, the assignment is a perfect matching). Since she knows how reckless her pilots are, she wants to be sure that any two (straight) paths \xe2\x80\x93 from a base to its assigned spaceship \xe2\x80\x93 do not intersect in the galaxy plane (that is, in 2D), and so there is no risk of collision."          
              3100.0                         958A3 "Death Stars (hard)"  "The stardate is 2015, and Death Stars are bigger than ever! This time, two rebel spies have yet again given Heidi two maps with the possible locations of the Death Stars.Heidi has now received two maps with possible locations of N Death Stars. She knows that each of the maps is possibly corrupted, and may contain some stars that are not Death Stars. Furthermore, each of the maps was created from a different point of view. Hence, stars that are shown in one of the maps are rotated and translated with respect to the other map. Now Heidi wants to find out which of the stars shown in both maps are actually Death Stars, and the correspondence between the Death Stars on the two maps."          
              1400.0                         955B "Not simply beatiful strings" implementation "Let\'s call a string adorable if its letters can be realigned in such a way that they form two consequent groups of equal symbols (note that different groups must contain different symbols). For example, ababa is adorable (you can transform it to aaabb, where the first three letters form a group of a-s and others \xe2\x80\x94 a group of b-s), but cccc is not since in each possible consequent partition letters in these two groups coincide.You\'re given a string s. Check whether it can be split into two non-empty subsequences such that the strings formed by these subsequences are adorable. Here a subsequence is an arbitrary set of indexes of the string."          
              800.0                         954A "Diagonal Walking" implementation "Mikhail walks on a 2D plane. He can go either up or right. You are given a sequence of Mikhail\'s moves. He thinks that this sequence is too long and he wants to make it as short as possible.In the given sequence moving up is described by character U and moving right is described by character R. Mikhail can replace any pair of consecutive moves RU or UR with a diagonal move (described as character D). After that, he can go on and do some other replacements, until there is no pair of consecutive moves RU or UR left.Your problem is to print the minimum possible length of the sequence of moves after the replacements."          
              800.0                         952A "Quirky Quantifiers" math "InputThe input contains a single integer a (10\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89999).OutputOutput 0 or 1.ExamplesInputCopy13OutputCopy1InputCopy927OutputCopy1InputCopy48OutputCopy0"          
              2300.0                         949D Curfew "binary search,brute force,greedy,sortings" "Instructors of Some Informatics School make students go to bed.The house contains n rooms, in each room exactly b students were supposed to sleep. However, at the time of curfew it happened that many students are not located in their assigned rooms. The rooms are arranged in a row and numbered from 1 to n. Initially, in i-th room there are ai students. All students are currently somewhere in the house, therefore a1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an\xe2\x80\x89=\xe2\x80\x89nb. Also 2 instructors live in this house.The process of curfew enforcement is the following. One instructor starts near room 1 and moves toward room n, while the second instructor starts near room n and moves toward room 1. After processing current room, each instructor moves on to the next one. Both instructors enter rooms and move simultaneously, if n is odd, then only the first instructor processes the middle room. When all rooms are processed, the process ends.When an instructor processes a room, she counts the number of students in the room, then turns off the light, and locks the room. Also, if the number of students inside the processed room is not equal to b, the instructor writes down the number of this room into her notebook (and turns off the light, and locks the room). Instructors are in a hurry (to prepare the study plan for the next day), so they don\'t care about who is in the room, but only about the number of students.While instructors are inside the rooms, students can run between rooms that are not locked and not being processed. A student can run by at most d rooms, that is she can move to a room with number that differs my at most d. Also, after (or instead of) running each student can hide under a bed in a room she is in. In this case the instructor will not count her during the processing. In each room any number of students can hide simultaneously.Formally, here is what\'s happening:  A curfew is announced, at this point in room i there are ai students.  Each student can run to another room but not further than d rooms away from her initial room, or stay in place. After that each student can optionally hide under a bed.  Instructors enter room 1 and room n, they count students there and lock the room (after it no one can enter or leave this room).  Each student from rooms with numbers from 2 to n\xe2\x80\x89-\xe2\x80\x891 can run to another room but not further than d rooms away from her current room, or stay in place. Each student can optionally hide under a bed.  Instructors move from room 1 to room 2 and from room n to room n\xe2\x80\x89-\xe2\x80\x891.  This process continues until all rooms are processed. Let x1 denote the number of rooms in which the first instructor counted the number of non-hidden students different from b, and x2 be the same number for the second instructor. Students know that the principal will only listen to one complaint, therefore they want to minimize the maximum of numbers xi. Help them find this value if they use the optimal strategy."          
              1700.0                         949B "A Leapfrog in the Array" "constructive algorithms,math" "Dima is a beginner programmer. During his working process, he regularly has to repeat the following operation again and again: to remove every second element from the array. One day he has been bored with easy solutions of this problem, and he has come up with the following extravagant algorithm.Let\'s consider that initially array contains n numbers from 1 to n and the number i is located in the cell with the index 2i\xe2\x80\x89-\xe2\x80\x891 (Indices are numbered starting from one) and other cells of the array are empty. Each step Dima selects a non-empty array cell with the maximum index and moves the number written in it to the nearest empty cell to the left of the selected one. The process continues until all n numbers will appear in the first n cells of the array. For example if n\xe2\x80\x89=\xe2\x80\x894, the array is changing as follows:  You have to write a program that allows you to determine what number will be in the cell with index x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) after Dima\'s algorithm finishes."          
              2500.0                         946G "Almost Increasing Array" "data structures,dp" "We call an array almost increasing if we can erase not more than one element from it so that the array becomes strictly increasing (that is, every element is striclty greater than every element before it).You are given an array a consisting of n elements. You are allowed to replace any element with any integer number (and you may do so any number of times you need). What is the minimum number of replacements you have to perform in order to make the array almost increasing?"          
              2600.0                         940F "Machine Learning" "brute force,data structures" "You come home and fell some unpleasant smell. Where is it coming from?You are given an array a. You have to answer the following queries:   You are given two integers l and r. Let ci be the number of occurrences of i in al:\xe2\x80\x89r, where al:\xe2\x80\x89r is the subarray of a from l-th element to r-th inclusive. Find the Mex of {c0,\xe2\x80\x89c1,\xe2\x80\x89...,\xe2\x80\x89c109}  You are given two integers p to x. Change ap to x. The Mex of a multiset of numbers is the smallest non-negative integer not in the set.Note that in this problem all elements of a are positive, which means that c0 = 0 and 0 is never the answer for the query of the second type."          
              2000.0                         940E Cashback "data structures,dp,greedy,math" "Since you are the best Wraith King, Nizhniy Magazin \xc2\xabMir\xc2\xbb at the centre of Vinnytsia is offering you a discount.You are given an array a of length n and an integer c. The value of some array b of length k is the sum of its elements except for the  smallest. For example, the value of the array [3,\xe2\x80\x891,\xe2\x80\x896,\xe2\x80\x895,\xe2\x80\x892] with c\xe2\x80\x89=\xe2\x80\x892 is 3\xe2\x80\x89+\xe2\x80\x896\xe2\x80\x89+\xe2\x80\x895\xe2\x80\x89=\xe2\x80\x8914.Among all possible partitions of a into contiguous subarrays output the smallest possible sum of the values of these subarrays."          
              1200.0                         940A "Points on the line" "brute force,greedy,sortings" "We\'ve got no test cases. A big olympiad is coming up. But the problemsetters\' number one priority should be adding another problem to the round. The diameter of a multiset of points on the line is the largest distance between two points from this set. For example, the diameter of the multiset {1,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x891} is 2.Diameter of multiset consisting of one point is 0.You are given n points on the line. What is the minimum number of points you have to remove, so that the diameter of the multiset of the remaining points will not exceed d?"          
              1800.0                         939E Maximize! "binary search,greedy,ternary search,two pointers" "You are given a multiset S consisting of positive integers (initially empty). There are two kind of queries:   Add a positive integer to S, the newly added integer is not less than any number in it.  Find a subset s of the set S such that the value  is maximum possible. Here max(s) means maximum value of elements in s,  \xe2\x80\x94 the average value of numbers in s. Output this maximum possible value of ."          
              1600.0                         939D "Love Rescue" "dfs and similar,dsu,graphs,greedy,strings" "Valya and Tolya are an ideal pair, but they quarrel sometimes. Recently, Valya took offense at her boyfriend because he came to her in t-shirt with lettering that differs from lettering on her pullover. Now she doesn\'t want to see him and Tolya is seating at his room and crying at her photos all day long.This story could be very sad but fairy godmother (Tolya\'s grandmother) decided to help them and restore their relationship. She secretly took Tolya\'s t-shirt and Valya\'s pullover and wants to make the letterings on them same. In order to do this, for one unit of mana she can buy a spell that can change some letters on the clothes. Your task is calculate the minimum amount of mana that Tolya\'s grandmother should spend to rescue love of Tolya and Valya.More formally, letterings on Tolya\'s t-shirt and Valya\'s pullover are two strings with same length n consisting only of lowercase English letters. Using one unit of mana, grandmother can buy a spell of form (c1,\xe2\x80\x89c2) (where c1 and c2 are some lowercase English letters), which can arbitrary number of times transform a single letter c1 to c2 and vise-versa on both Tolya\'s t-shirt and Valya\'s pullover. You should find the minimum amount of mana that grandmother should spend to buy a set of spells that can make the letterings equal. In addition you should output the required set of spells."          
              1100.0                         938B "Run For Your Prize" "brute force,greedy" "You and your friend are participating in a TV show ""Run For Your Prize"".At the start of the show n prizes are located on a straight line. i-th prize is located at position ai. Positions of all prizes are distinct. You start at position 1, your friend \xe2\x80\x94 at position 106 (and there is no prize in any of these two positions). You have to work as a team and collect all prizes in minimum possible time, in any order.You know that it takes exactly 1 second to move from position x to position x\xe2\x80\x89+\xe2\x80\x891 or x\xe2\x80\x89-\xe2\x80\x891, both for you and your friend. You also have trained enough to instantly pick up any prize, if its position is equal to your current position (and the same is true for your friend). Carrying prizes does not affect your speed (or your friend\'s speed) at all.Now you may discuss your strategy with your friend and decide who will pick up each prize. Remember that every prize must be picked up, either by you or by your friend.What is the minimum number of seconds it will take to pick up all the prizes?"          
              3000.0                         936D "World of Tank" dp,greedy "Vitya loves programming and problem solving, but sometimes, to distract himself a little, he plays computer games. Once he found a new interesting game about tanks, and he liked it so much that he went through almost all levels in one day. Remained only the last level, which was too tricky. Then Vitya remembered that he is a programmer, and wrote a program that helped him to pass this difficult level. Try do the same.The game is organized as follows. There is a long road, two cells wide and n cells long. Some cells have obstacles. You control a tank that occupies one cell. Initially, the tank is located before the start of the road, in a cell with coordinates (0,\xe2\x80\x891). Your task is to move the tank to the end of the road, to the cell (n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x891) or (n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x892).  Every second the tank moves one cell to the right: the coordinate x is increased by one. When you press the up or down arrow keys, the tank instantly changes the lane, that is, the y coordinate. When you press the spacebar, the tank shoots, and the nearest obstacle along the lane in which the tank rides is instantly destroyed. In order to load a gun, the tank needs t seconds. Initially, the gun is not loaded, that means, the first shot can be made only after t seconds after the tank starts to move.If at some point the tank is in the same cell with an obstacle not yet destroyed, it burns out. If you press the arrow exactly at the moment when the tank moves forward, the tank will first move forward, and then change the lane, so it will not be possible to move diagonally.Your task is to find out whether it is possible to pass the level, and if possible, to find the order of actions the player need to make."          
              2300.0                         936C "Lock Puzzle" "constructive algorithms,implementation,strings" "Welcome to another task about breaking the code lock! Explorers Whitfield and Martin came across an unusual safe, inside of which, according to rumors, there are untold riches, among which one can find the solution of the problem of discrete logarithm!Of course, there is a code lock is installed on the safe. The lock has a screen that displays a string of n lowercase Latin letters. Initially, the screen displays string s. Whitfield and Martin found out that the safe will open when string t will be displayed on the screen.The string on the screen can be changed using the operation \xc2\xabshift x\xc2\xbb. In order to apply this operation, explorers choose an integer x from 0 to n inclusive. After that, the current string p\xe2\x80\x89=\xe2\x80\x89\xce\xb1\xce\xb2 changes to \xce\xb2R\xce\xb1, where the length of \xce\xb2 is x, and the length of \xce\xb1 is n\xe2\x80\x89-\xe2\x80\x89x. In other words, the suffix of the length x of string p is reversed and moved to the beginning of the string. For example, after the operation \xc2\xabshift 4\xc2\xbb the string \xc2\xababcacb\xc2\xbb will be changed with string \xc2\xabbcacab \xc2\xbb, since \xce\xb1\xe2\x80\x89=\xe2\x80\x89ab, \xce\xb2\xe2\x80\x89=\xe2\x80\x89cacb, \xce\xb2R\xe2\x80\x89=\xe2\x80\x89bcac.Explorers are afraid that if they apply too many operations \xc2\xabshift\xc2\xbb, the lock will be locked forever. They ask you to find a way to get the string t on the screen, using no more than 6100 operations."          
              2100.0                         936B "Sleepy Game" "dfs and similar,dp,games,graphs" "Petya and Vasya arranged a game. The game runs by the following rules. Players have a directed graph consisting of n vertices and m edges. One of the vertices contains a chip. Initially the chip is located at vertex s. Players take turns moving the chip along some edge of the graph. Petya goes first. Player who can\'t move the chip loses. If the game lasts for 106 turns the draw is announced.Vasya was performing big laboratory work in ""Spelling and parts of speech"" at night before the game, so he fell asleep at the very beginning of the game. Petya decided to take the advantage of this situation and make both Petya\'s and Vasya\'s moves.Your task is to help Petya find out if he can win the game or at least draw a tie."          
              1200.0                         931B "World Cup" "constructive algorithms,implementation" "The last stage of Football World Cup is played using the play-off system.There are n teams left in this stage, they are enumerated from 1 to n. Several rounds are held, in each round the remaining teams are sorted in the order of their ids, then the first in this order plays with the second, the third \xe2\x80\x94 with the fourth, the fifth \xe2\x80\x94 with the sixth, and so on. It is guaranteed that in each round there is even number of teams. The winner of each game advances to the next round, the loser is eliminated from the tournament, there are no draws. In the last round there is the only game with two remaining teams: the round is called the Final, the winner is called the champion, and the tournament is over.Arkady wants his two favorite teams to play in the Final. Unfortunately, the team ids are already determined, and it may happen that it is impossible for teams to meet in the Final, because they are to meet in some earlier stage, if they are strong enough. Determine, in which round the teams with ids a and b can meet."          
              1400.0                         929A "\xd0\x9f\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2" "*special problem,greedy,implementation" "\xd0\x9a\xd0\xb0\xd0\xba \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe, \xd0\xb2 \xd1\x82\xd0\xb5\xd0\xbf\xd0\xbb\xd1\x83\xd1\x8e \xd0\xbf\xd0\xbe\xd0\xb3\xd0\xbe\xd0\xb4\xd1\x83 \xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xb8\xd0\xb5 \xd0\xb6\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd0\xb8 \xd0\xba\xd1\x80\xd1\x83\xd0\xbf\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb2 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb8\xd1\x81\xd0\xb0\xd0\xbc\xd0\xb8 \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb4\xd1\x81\xd0\xba\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd0\xb0. \xd0\x92\xd0\xbe\xd1\x82 \xd0\xb8 \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe\xd0\xb4\xd0\xbd\xd1\x8f \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb4\xd0\xbe\xd0\xb1\xd0\xb8\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82 \xd1\x88\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8b \xd0\xb4\xd0\xbe \xd0\xb4\xd0\xbe\xd0\xbc\xd0\xb0, \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd1\x8f \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb4\xd1\x81\xd0\xba\xd0\xb8\xd0\xb5 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4\xd1\x8b.\xd0\xa8\xd0\xba\xd0\xbe\xd0\xbb\xd0\xb0 \xd0\xb8 \xd0\xb4\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd0\xb9 \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb5, \xd0\xba\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd0\xbd\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb5 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c n \xd1\x82\xd0\xbe\xd1\x87\xd0\xb5\xd0\xba, \xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd0\xb7\xd1\x8f\xd1\x82\xd1\x8c \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xb8\xd0\xbb\xd0\xb8 \xd1\x81\xd0\xb4\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb5\xd0\xb3\xd0\xbe. \xd0\x9f\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 x1 \xd0\xba\xd0\xb8\xd0\xbb\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xb2\xd0\xb4\xd0\xbe\xd0\xbb\xd1\x8c \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd1\x8b, \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb9 \xe2\x80\x94 \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 x2 \xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba \xd0\xb4\xd0\xb0\xd0\xbb\xd0\xb5\xd0\xb5, n-\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 xn. \xd0\xa8\xd0\xba\xd0\xbe\xd0\xbb\xd0\xb0 \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd1\x8f \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 x1 (\xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x82\xd0\xb0\xd0\xbc \xd0\xb6\xd0\xb5, \xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82), \xd0\xb0 \xd0\xb4\xd0\xbe\xd0\xbc \xe2\x80\x94 \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 xn (\xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x82\xd0\xb0\xd0\xbc \xd0\xb6\xd0\xb5, \xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xb8 n-\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82). \xd0\x98\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe xi\xe2\x80\x89<\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n.\xd0\xa1\xd0\xbe\xd0\xb3\xd0\xbb\xd0\xb0\xd1\x81\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0\xd0\xbc \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd0\xb0, \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x87\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbe\xd0\xbd \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xbe\xd0\xb1\xd1\x8f\xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb2\xd0\xb5\xd1\x80\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x82\xd0\xbe\xd1\x87\xd0\xb5\xd0\xba \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd0\xb0, \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe, \xd0\xbe\xd0\xbd \xd1\x82\xd1\x83\xd1\x82 \xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xb7\xd1\x8f\xd1\x82\xd1\x8c \xd0\xbd\xd0\xbe\xd0\xb2\xd1\x8b\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4, \xd0\xb8 \xd0\xbe\xd1\x82\xd1\x81\xd1\x87\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xb9\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe. \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4\xd0\xb0 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xb7\xd1\x8f\xd1\x82\xd1\x8c \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4 \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9-\xd1\x82\xd0\xbe \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd0\xb0, \xd1\x82\xd0\xbe \xd0\xbe\xd0\xbd \xd1\x81\xd0\xb4\xd0\xb0\xd1\x91\xd1\x82 \xd1\x82\xd0\xbe\xd1\x82 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4, \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc \xd0\xbe\xd0\xbd \xd0\xb4\xd0\xbe \xd0\xbd\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xb4\xd0\xbe\xd0\xb5\xd1\x85\xd0\xb0\xd0\xbb, \xd0\xb1\xd0\xb5\xd1\x80\xd1\x91\xd1\x82 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xbd\xd0\xbe\xd0\xb2\xd1\x8b\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4 \xd0\xb8 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xbd\xd1\x91\xd0\xbc \xd1\x81\xd0\xb2\xd0\xbe\xd1\x91 \xd0\xb4\xd0\xb2\xd0\xb8\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5.\xd0\x97\xd0\xb0 \xd0\xbe\xd1\x82\xd0\xb2\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f, \xd0\xbd\xd0\xb5\xd0\xb7\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x81\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbe\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4\xd0\xb0, \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd1\x83\xd1\x81\xd0\xbf\xd0\xb5\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb5\xd1\x85\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 k \xd0\xba\xd0\xb8\xd0\xbb\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xb2\xd0\xb4\xd0\xbe\xd0\xbb\xd1\x8c \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd1\x8b. \xd0\x9e\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd0\xb5, \xd1\x81\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbb\xd0\xb8 \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd0\xb4\xd0\xbe\xd0\xb5\xd1\x85\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4\xd0\xb0\xd1\x85 \xd0\xbe\xd1\x82 \xd1\x88\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8b \xd0\xb4\xd0\xbe \xd0\xb4\xd0\xbe\xd0\xbc\xd0\xb0, \xd0\xb8 \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb4\xd0\xb0, \xd1\x82\xd0\xbe \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb5 \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7 \xd0\xb5\xd0\xbc\xd1\x83 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xb7\xd1\x8f\xd1\x82\xd1\x8c \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82, \xd0\xb2\xd0\xba\xd0\xbb\xd1\x8e\xd1\x87\xd0\xb0\xd1\x8f \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4? \xd0\xa3\xd1\x87\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd0\xbd\xd0\xb5 \xd0\xbd\xd0\xb0\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbd \xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe\xd0\xb4\xd0\xbd\xd1\x8f \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbf\xd0\xb5\xd1\x88\xd0\xba\xd0\xbe\xd0\xbc."          
              2100.0                         926J Segments "data structures" "There is a straight line colored in white. n black segments are added on it one by one.After each segment is added, determine the number of connected components of black segments (i. e. the number of black segments in the union of the black segments). In particular, if one segment ends in a point x, and another segment starts in the point x, these two segments belong to the same connected component."          
              2000.0                         926F "Mobile Communications"  "A sum of p rubles is charged from Arkady\'s mobile phone account every day in the morning. Among the following m days, there are n days when Arkady will top up the account: in the day di he will deposit ti rubles on his mobile phone account. Arkady will always top up the account before the daily payment will be done. There will be no other payments nor tops up in the following m days.Determine the number of days starting from the 1-st to the m-th such that the account will have a negative amount on it after the daily payment (i. e. in evening). Initially the account\'s balance is zero rubles."          
              1600.0                         926D "Choose Place"  "A classroom in a school has six rows with 3 desks in each row. Two people can use the same desk: one sitting on the left and one sitting on the right. Some places are already occupied, and some places are vacant. Petya has just entered the class and wants to occupy the most convenient place. The conveniences of the places are shown on the picture:  Here, the desks in the top row are the closest to the blackboard, while the desks in the bottom row are the furthest from the blackboard.You are given a plan of the class, where \'*\' denotes an occupied place, \'.\' denotes a vacant place, and the aisles are denoted by \'-\'. Find any of the most convenient vacant places for Petya."          
              1300.0                         926A 2-3-numbers implementation,math "A positive integer is called a 2-3-integer, if it is equal to 2x\xc2\xb73y for some non-negative integers x and y. In other words, these integers are such integers that only have 2 and 3 among their prime divisors. For example, integers 1, 6, 9, 16 and 108 \xe2\x80\x94 are 2-3 integers, while 5, 10, 21 and 120 are not.Print the number of 2-3-integers on the given segment [l,\xe2\x80\x89r], i. e. the number of sich 2-3-integers t that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r."          
                                           449B "Jzzhu and Cities" "graphs,greedy,shortest paths" "Jzzhu is the president of country A. There are n cities numbered from 1 to n in his country. City 1 is the capital of A. Also there are m roads connecting the cities. One can go from city ui to vi (and vise versa) using the i-th road, the length of this road is xi. Finally, there are k train routes in the country. One can use the i-th train route to go from capital of the country to city si (and vise versa), the length of this route is yi.Jzzhu doesn\'t want to waste the money of the country, so he is going to close some of the train routes. Please tell Jzzhu the maximum number of the train routes which can be closed under the following condition: the length of the shortest path from every city to the capital mustn\'t change." 2000.0     
                                           449A "Jzzhu and Chocolate" greedy,math "Jzzhu has a big rectangular chocolate bar that consists of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m unit squares. He wants to cut this bar exactly k times. Each cut must meet the following requirements:  each cut should be straight (horizontal or vertical);  each cut should go along edges of unit squares (it is prohibited to divide any unit chocolate square with cut);  each cut should go inside the whole chocolate bar, and all cuts must be distinct. The picture below shows a possible way to cut a 5\xe2\x80\x89\xc3\x97\xe2\x80\x896 chocolate for 5 times.  Imagine Jzzhu have made k cuts and the big chocolate is splitted into several pieces. Consider the smallest (by area) piece of the chocolate, Jzzhu wants this piece to be as large as possible. What is the maximum possible area of smallest piece he can get with exactly k cuts? The area of a chocolate piece is the number of unit squares in it." 1700.0     
                                           448E Divisors "brute force,dfs and similar,implementation,number theory" "Bizon the Champion isn\'t just friendly, he also is a rigorous coder.Let\'s define function f(a), where a is a sequence of integers. Function f(a) returns the following sequence: first all divisors of a1 go in the increasing order, then all divisors of a2 go in the increasing order, and so on till the last element of sequence a. For example, f([2,\xe2\x80\x899,\xe2\x80\x891])\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x899,\xe2\x80\x891].Let\'s determine the sequence Xi, for integer i (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890): X0\xe2\x80\x89=\xe2\x80\x89[X] ([X] is a sequence consisting of a single number X), Xi\xe2\x80\x89=\xe2\x80\x89f(Xi\xe2\x80\x89-\xe2\x80\x891) (i\xe2\x80\x89>\xe2\x80\x890). For example, at X\xe2\x80\x89=\xe2\x80\x896 we get X0\xe2\x80\x89=\xe2\x80\x89[6], X1\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x896], X2\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x896].Given the numbers X and k, find the sequence Xk. As the answer can be rather large, find only the first 105 elements of this sequence." 2200.0     
                                           444D "DZY Loves Strings" "binary search,hashing,strings,two pointers" "DZY loves strings, and he enjoys collecting them.In China, many people like to use strings containing their names\' initials, for example: xyz, jcvb, dzy, dyh.Once DZY found a lucky string s. A lot of pairs of good friends came to DZY when they heard about the news. The first member of the i-th pair has name ai, the second one has name bi. Each pair wondered if there is a substring of the lucky string containing both of their names. If so, they want to find the one with minimum length, which can give them good luck and make their friendship last forever.Please help DZY for each pair find the minimum length of the substring of s that contains both ai and bi, or point out that such substring doesn\'t exist.A substring of s is a string slsl\xe2\x80\x89+\xe2\x80\x891... sr for some integers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|). The length of such the substring is (r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891).A string p contains some another string q if there is a substring of p equal to q." 2500.0     
                                           444B "DZY Loves FFT" probabilities "DZY loves Fast Fourier Transformation, and he enjoys using it.Fast Fourier Transformation is an algorithm used to calculate convolution. Specifically, if a, b and c are sequences with length n, which are indexed from 0 to n\xe2\x80\x89-\xe2\x80\x891, andWe can calculate c fast using Fast Fourier Transformation.DZY made a little change on this formula. NowTo make things easier, a is a permutation of integers from 1 to n, and b is a sequence only containing 0 and 1. Given a and b, DZY needs your help to calculate c.Because he is naughty, DZY provides a special way to get a and b. What you need is only three integers n, d, x. After getting them, use the code below to generate a and b.//x is 64-bit variable;function getNextX() {    x = (x * 37 + 10007) % 1000000007;    return x;}function initAB() {    for(i = 0; i < n; i = i + 1){        a[i] = i + 1;    }    for(i = 0; i < n; i = i + 1){        swap(a[i], a[getNextX() % (i + 1)]);    }    for(i = 0; i < n; i = i + 1){        if (i < d)            b[i] = 1;        else            b[i] = 0;    }    for(i = 0; i < n; i = i + 1){        swap(b[i], b[getNextX() % (i + 1)]);    }}Operation x % y denotes remainder after division x by y. Function swap(x, y) swaps two values x and y." 2300.0     
                                           442D "Adam and Tree" "data structures,trees" "When Adam gets a rooted tree (connected non-directed graph without cycles), he immediately starts coloring it. More formally, he assigns a color to each edge of the tree so that it meets the following two conditions:   There is no vertex that has more than two incident edges painted the same color.  For any two vertexes that have incident edges painted the same color (say, c), the path between them consists of the edges of the color c. Not all tree paintings are equally good for Adam. Let\'s consider the path from some vertex to the root. Let\'s call the number of distinct colors on this path the cost of the vertex. The cost of the tree\'s coloring will be the maximum cost among all the vertexes. Help Adam determine the minimum possible cost of painting the tree. Initially, Adam\'s tree consists of a single vertex that has number one and is the root. In one move Adam adds a new vertex to the already existing one, the new vertex gets the number equal to the minimum positive available integer. After each operation you need to calculate the minimum cost of coloring the resulting tree." 2600.0     
                                           439B "Devu, the Dumb Guy" implementation,sortings "Devu is a dumb guy, his learning curve is very slow. You are supposed to teach him n subjects, the ith subject has ci chapters. When you teach him, you are supposed to teach all the chapters of a subject continuously.Let us say that his initial per chapter learning power of a subject is x hours. In other words he can learn a chapter of a particular subject in x hours.Well Devu is not complete dumb, there is a good thing about him too. If you teach him a subject, then time required to teach any chapter of the next subject will require exactly 1 hour less than previously required (see the examples to understand it more clearly). Note that his per chapter learning power can not be less than 1 hour.You can teach him the n subjects in any possible order. Find out minimum amount of time (in hours) Devu will take to understand all the subjects and you will be free to do some enjoying task rather than teaching a dumb guy.Please be careful that answer might not fit in 32 bit data type." 1200.0     
                                           437E "The Child and Polygon" dp,geometry "This time our child has a simple polygon. He has to find the number of ways to split the polygon into non-degenerate triangles, each way must satisfy the following requirements:  each vertex of each triangle is one of the polygon vertex;  each side of the polygon must be the side of exactly one triangle;  the area of intersection of every two triangles equals to zero, and the sum of all areas of triangles equals to the area of the polygon;  each triangle must be completely inside the polygon;  each side of each triangle must contain exactly two vertices of the polygon. The picture below depicts an example of a correct splitting.  Please, help the child. Calculate the described number of ways modulo 1000000007 (109\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x897) for him." 2500.0     
                                           437D "The Child and Zoo" dsu,sortings "Of course our child likes walking in a zoo. The zoo has n areas, that are numbered from 1 to n. The i-th area contains ai animals in it. Also there are m roads in the zoo, and each road connects two distinct areas. Naturally the zoo is connected, so you can reach any area of the zoo from any other area using the roads.Our child is very smart. Imagine the child want to go from area p to area q. Firstly he considers all the simple routes from p to q. For each route the child writes down the number, that is equal to the minimum number of animals among the route areas. Let\'s denote the largest of the written numbers as f(p,\xe2\x80\x89q). Finally, the child chooses one of the routes for which he writes down the value f(p,\xe2\x80\x89q).After the child has visited the zoo, he thinks about the question: what is the average value of f(p,\xe2\x80\x89q) for all pairs p,\xe2\x80\x89q (p\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89q)? Can you answer his question?" 1900.0     
                                           434E "Furukawa Nagisa\'s Tree" "binary search,divide and conquer,sortings,trees" "One day, Okazaki Tomoya has bought a tree for Furukawa Nagisa\'s birthday. The tree is so strange that every node of the tree has a value. The value of the i-th node is vi. Now Furukawa Nagisa and Okazaki Tomoya want to play a game on the tree.Let (s,\xe2\x80\x89e) be the path from node s to node e, we can write down the sequence of the values of nodes on path (s,\xe2\x80\x89e), and denote this sequence as S(s,\xe2\x80\x89e). We define the value of the sequence G(S(s,\xe2\x80\x89e)) as follows. Suppose that the sequence is z0,\xe2\x80\x89z1...zl\xe2\x80\x89-\xe2\x80\x891, where l is the length of the sequence. We define G(S(s,\xe2\x80\x89e))\xe2\x80\x89=\xe2\x80\x89z0\xe2\x80\x89\xc3\x97\xe2\x80\x89k0\xe2\x80\x89+\xe2\x80\x89z1\xe2\x80\x89\xc3\x97\xe2\x80\x89k1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89zl\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x89kl\xe2\x80\x89-\xe2\x80\x891. If the path (s,\xe2\x80\x89e) satisfies , then the path (s,\xe2\x80\x89e) belongs to Furukawa Nagisa, otherwise it belongs to Okazaki Tomoya.Calculating who has more paths is too easy, so they want to play something more difficult. Furukawa Nagisa thinks that if paths (p1,\xe2\x80\x89p2) and (p2,\xe2\x80\x89p3) belong to her, then path (p1,\xe2\x80\x89p3) belongs to her as well. Also, she thinks that if paths (p1,\xe2\x80\x89p2) and (p2,\xe2\x80\x89p3) belong to Okazaki Tomoya, then path (p1,\xe2\x80\x89p3) belongs to Okazaki Tomoya as well. But in fact, this conclusion isn\'t always right. So now Furukawa Nagisa wants to know how many triplets (p1,\xe2\x80\x89p2,\xe2\x80\x89p3) are correct for the conclusion, and this is your task." 3000.0     
                                           433B "Kuriyama Mirai\'s Stones" dp,implementation,sortings "Kuriyama Mirai has killed many monsters and got many (namely n) stones. She numbers the stones from 1 to n. The cost of the i-th stone is vi. Kuriyama Mirai wants to know something about these stones so she will ask you two kinds of questions:  She will tell you two numbers, l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), and you should tell her .  Let ui be the cost of the i-th cheapest stone (the cost that will be on the i-th place if we arrange all the stone costs in non-decreasing order). This time she will tell you two numbers, l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), and you should tell her . For every question you should give the correct answer, or Kuriyama Mirai will say ""fuyukai desu"" and then become unhappy." 1200.0     
                                           429D "Tricky Function" "data structures,divide and conquer,geometry" "Iahub and Sorin are the best competitive programmers in their town. However, they can\'t both qualify to an important contest. The selection will be made with the help of a single problem. Blatnatalag, a friend of Iahub, managed to get hold of the problem before the contest. Because he wants to make sure Iahub will be the one qualified, he tells Iahub the following task.You\'re given an (1-based) array a with n elements. Let\'s define function f(i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) as (i\xe2\x80\x89-\xe2\x80\x89j)2\xe2\x80\x89+\xe2\x80\x89g(i,\xe2\x80\x89j)2. Function g is calculated by the following pseudo-code:int g(int i, int j) {    int sum = 0;    for (int k = min(i, j) + 1; k <= max(i, j); k = k + 1)        sum = sum + a[k];    return sum;}Find a value mini\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j  f(i,\xe2\x80\x89j).Probably by now Iahub already figured out the solution to this problem. Can you?" 2200.0     
                                           427A "Police Recruits" implementation "The police department of your city has just started its journey. Initially, they don\xe2\x80\x99t have any manpower. So, they started hiring new recruits in groups.Meanwhile, crimes keeps occurring within the city. One member of the police force can investigate only one crime during his/her lifetime.If there is no police officer free (isn\'t busy with crime) during the occurrence of a crime, it will go untreated.Given the chronological order of crime occurrences and recruit hirings, find the number of crimes which will go untreated." 800.0     
                                           426B "Sereja and Mirroring" implementation "Let\'s assume that we are given a matrix b of size x\xe2\x80\x89\xc3\x97\xe2\x80\x89y, let\'s determine the operation of mirroring matrix b. The mirroring of matrix b is a 2x\xe2\x80\x89\xc3\x97\xe2\x80\x89y matrix c which has the following properties:  the upper half of matrix c (rows with numbers from 1 to x) exactly matches b;  the lower half of matrix c (rows with numbers from x\xe2\x80\x89+\xe2\x80\x891 to 2x) is symmetric to the upper one; the symmetry line is the line that separates two halves (the line that goes in the middle, between rows x and x\xe2\x80\x89+\xe2\x80\x891). Sereja has an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix a. He wants to find such matrix b, that it can be transformed into matrix a, if we\'ll perform on it several (possibly zero) mirrorings. What minimum number of rows can such matrix contain?" 1300.0     
                                           426A "Sereja and Mugs" implementation "Sereja showed an interesting game to his friends. The game goes like that. Initially, there is a table with an empty cup and n water mugs on it. Then all players take turns to move. During a move, a player takes a non-empty mug of water and pours all water from it into the cup. If the cup overfills, then we assume that this player lost.As soon as Sereja\'s friends heard of the game, they wanted to play it. Sereja, on the other hand, wanted to find out whether his friends can play the game in such a way that there are no losers. You are given the volumes of all mugs and the cup. Also, you know that Sereja has (n\xe2\x80\x89-\xe2\x80\x891) friends. Determine if Sereja\'s friends can play the game so that nobody loses." 800.0     
                                           424D "Biathlon Track" "binary search,brute force,constructive algorithms,data structures,dp" "Recently an official statement of the world Olympic Committee said that the Olympic Winter Games 2030 will be held in Tomsk. The city officials decided to prepare for the Olympics thoroughly and to build all the necessary Olympic facilities as early as possible. First, a biathlon track will be built.To construct a biathlon track a plot of land was allocated, which is a rectangle divided into n\xe2\x80\x89\xc3\x97\xe2\x80\x89m identical squares. Each of the squares has two coordinates: the number of the row (from 1 to n), where it is located, the number of the column (from 1 to m), where it is located. Also each of the squares is characterized by its height. During the sports the biathletes will have to move from one square to another. If a biathlete moves from a higher square to a lower one, he makes a descent. If a biathlete moves from a lower square to a higher one, he makes an ascent. If a biathlete moves between two squares with the same height, then he moves on flat ground.The biathlon track should be a border of some rectangular area of the allocated land on which biathletes will move in the clockwise direction. It is known that on one move on flat ground an average biathlete spends tp seconds, an ascent takes tu seconds, a descent takes td seconds. The Tomsk Administration wants to choose the route so that the average biathlete passes it in as close to t seconds as possible. In other words, the difference between time ts of passing the selected track and t should be minimum.For a better understanding you can look at the first sample of the input data. In this sample n\xe2\x80\x89=\xe2\x80\x896,\xe2\x80\x89m\xe2\x80\x89=\xe2\x80\x897, and the administration wants the track covering time to be as close to t\xe2\x80\x89=\xe2\x80\x8948 seconds as possible, also, tp\xe2\x80\x89=\xe2\x80\x893, tu\xe2\x80\x89=\xe2\x80\x896 and td\xe2\x80\x89=\xe2\x80\x892. If we consider the rectangle shown on the image by arrows, the average biathlete can move along the boundary in a clockwise direction in exactly 48 seconds. The upper left corner of this track is located in the square with the row number 4, column number 3 and the lower right corner is at square with row number 6, column number 7.  Among other things the administration wants all sides of the rectangle which boundaries will be the biathlon track to consist of no less than three squares and to be completely contained within the selected land.You are given the description of the given plot of land and all necessary time values. You are to write the program to find the most suitable rectangle for a biathlon track. If there are several such rectangles, you are allowed to print any of them." 2300.0     
                                           424C "Magic Formulas" math "People in the Tomskaya region like magic formulas very much. You can see some of them below.Imagine you are given a sequence of positive integer numbers p1, p2, ..., pn. Lets write down some magic formulas:Here, ""mod"" means the operation of taking the residue after dividing.The expression  means applying the bitwise xor (excluding ""OR"") operation to integers x and y. The given operation exists in all modern programming languages. For example, in languages C++ and Java it is represented by ""^"", in Pascal \xe2\x80\x94 by ""xor"".People in the Tomskaya region like magic formulas very much, but they don\'t like to calculate them! Therefore you are given the sequence p, calculate the value of Q." 1600.0     
                                           424B Megacity "binary search,greedy,implementation,sortings" "The administration of the Tomsk Region firmly believes that it\'s time to become a megacity (that is, get population of one million). Instead of improving the demographic situation, they decided to achieve its goal by expanding the boundaries of the city.The city of Tomsk can be represented as point on the plane with coordinates (0; 0). The city is surrounded with n other locations, the i-th one has coordinates (xi, yi) with the population of ki people. You can widen the city boundaries to a circle of radius r. In such case all locations inside the circle and on its border are included into the city.Your goal is to write a program that will determine the minimum radius r, to which is necessary to expand the boundaries of Tomsk, so that it becomes a megacity." 1200.0     
                                           413C Jeopardy! greedy,math "\'Jeopardy!\' is an intellectual game where players answer questions and earn points. Company Q conducts a simplified \'Jeopardy!\' tournament among the best IT companies. By a lucky coincidence, the old rivals made it to the finals: company R1 and company R2. The finals will have n questions, m of them are auction questions and n\xe2\x80\x89-\xe2\x80\x89m of them are regular questions. Each question has a price. The price of the i-th question is ai points. During the game the players chose the questions. At that, if the question is an auction, then the player who chose it can change the price if the number of his current points is strictly larger than the price of the question. The new price of the question cannot be less than the original price and cannot be greater than the current number of points of the player who chose the question. The correct answer brings the player the points equal to the price of the question. The wrong answer to the question reduces the number of the player\'s points by the value of the question price.The game will go as follows. First, the R2 company selects a question, then the questions are chosen by the one who answered the previous question correctly. If no one answered the question, then the person who chose last chooses again.All R2 employees support their team. They want to calculate what maximum possible number of points the R2 team can get if luck is on their side during the whole game (they will always be the first to correctly answer questions). Perhaps you are not going to be surprised, but this problem was again entrusted for you to solve." 1400.0     
                                           412A Poster greedy,implementation "The R1 company has recently bought a high rise building in the centre of Moscow for its main office. It\'s time to decorate the new office, and the first thing to do is to write the company\'s slogan above the main entrance to the building.The slogan of the company consists of n characters, so the decorators hung a large banner, n meters wide and 1 meter high, divided into n equal squares. The first character of the slogan must be in the first square (the leftmost) of the poster, the second character must be in the second square, and so on.Of course, the R1 programmers want to write the slogan on the poster themselves. To do this, they have a large (and a very heavy) ladder which was put exactly opposite the k-th square of the poster. To draw the i-th character of the slogan on the poster, you need to climb the ladder, standing in front of the i-th square of the poster. This action (along with climbing up and down the ladder) takes one hour for a painter. The painter is not allowed to draw characters in the adjacent squares when the ladder is in front of the i-th square because the uncomfortable position of the ladder may make the characters untidy. Besides, the programmers can move the ladder. In one hour, they can move the ladder either a meter to the right or a meter to the left.Drawing characters and moving the ladder is very tiring, so the programmers want to finish the job in as little time as possible. Develop for them an optimal poster painting plan!" 900.0     
                                           408A "Line to Cashier" implementation "Little Vasya went to the supermarket to get some groceries. He walked about the supermarket for a long time and got a basket full of products. Now he needs to choose the cashier to pay for the products.There are n cashiers at the exit from the supermarket. At the moment the queue for the i-th cashier already has ki people. The j-th person standing in the queue to the i-th cashier has mi,\xe2\x80\x89j items in the basket. Vasya knows that:  the cashier needs 5 seconds to scan one item;  after the cashier scans each item of some customer, he needs 15 seconds to take the customer\'s money and give him the change. Of course, Vasya wants to select a queue so that he can leave the supermarket as soon as possible. Help him write a program that displays the minimum number of seconds after which Vasya can get to one of the cashiers." 900.0     
                                           407A Triangle "brute force,geometry,implementation,math" "There is a right triangle with legs of length a and b. Your task is to determine whether it is possible to locate the triangle on the plane in such a way that none of its sides is parallel to the coordinate axes. All the vertices must have integer coordinates. If there exists such a location, you have to output the appropriate coordinates of vertices." 1600.0     
                                           406E "Hamming Triples" "implementation,math,two pointers" "Little Chris is having a nightmare. Even in dreams all he thinks about is math.Chris dreams about m binary strings of length n, indexed with numbers from 1 to m. The most horrifying part is that the bits of each string are ordered in either ascending or descending order. For example, Chris could be dreaming about the following 4 strings of length 5:  The Hamming distance H(a,\xe2\x80\x89b) between two strings a and b of length n is the number of positions at which the corresponding symbols are different. \xd0\xa1hris thinks that each three strings with different indices constitute a single triple. Chris\'s delusion is that he will wake up only if he counts the number of such string triples a, b, c that the sum H(a,\xe2\x80\x89b)\xe2\x80\x89+\xe2\x80\x89H(b,\xe2\x80\x89c)\xe2\x80\x89+\xe2\x80\x89H(c,\xe2\x80\x89a) is maximal among all the string triples constructed from the dreamed strings.Help Chris wake up from this nightmare!" 2800.0     
                                           404C "Restore Graph" "dfs and similar,graphs,sortings" "Valera had an undirected connected graph without self-loops and multiple edges consisting of n vertices. The graph had an interesting property: there were at most k edges adjacent to each of its vertices. For convenience, we will assume that the graph vertices were indexed by integers from 1 to n.One day Valera counted the shortest distances from one of the graph vertices to all other ones and wrote them out in array d. Thus, element d[i] of the array shows the shortest distance from the vertex Valera chose to vertex number i.Then something irreparable terrible happened. Valera lost the initial graph. However, he still has the array d. Help him restore the lost graph." 1800.0     
                                           400C "Inna and Huge Candy Matrix" implementation,math "Inna and Dima decided to surprise Sereja. They brought a really huge candy matrix, it\'s big even for Sereja! Let\'s number the rows of the giant matrix from 1 to n from top to bottom and the columns \xe2\x80\x94 from 1 to m, from left to right. We\'ll represent the cell on the intersection of the i-th row and j-th column as (i,\xe2\x80\x89j). Just as is expected, some cells of the giant candy matrix contain candies. Overall the matrix has p candies: the k-th candy is at cell (xk,\xe2\x80\x89yk).The time moved closer to dinner and Inna was already going to eat p of her favourite sweets from the matrix, when suddenly Sereja (for the reason he didn\'t share with anyone) rotated the matrix x times clockwise by 90 degrees. Then he performed the horizontal rotate of the matrix y times. And then he rotated the matrix z times counterclockwise by 90 degrees. The figure below shows how the rotates of the matrix looks like.  Inna got really upset, but Duma suddenly understood two things: the candies didn\'t get damaged and he remembered which cells contained Inna\'s favourite sweets before Sereja\'s strange actions. Help guys to find the new coordinates in the candy matrix after the transformation Sereja made!" 1500.0     
                                           399B "Red and Blue Balls"  "User ainta has a stack of n red and blue balls. He can apply a certain operation which changes the colors of the balls inside the stack.  While the top ball inside the stack is red, pop the ball from the top of the stack.  Then replace the blue ball on the top with a red ball.  And finally push some blue balls to the stack until the stack has total of n balls inside.   If there are no blue balls inside the stack, ainta can\'t apply this operation. Given the initial state of the stack, ainta wants to know the maximum number of operations he can repeatedly apply." -999.0     
                                           397B "On Corruption and Numbers" "constructive algorithms,implementation,math" "Alexey, a merry Berland entrant, got sick of the gray reality and he zealously wants to go to university. There are a lot of universities nowadays, so Alexey is getting lost in the diversity \xe2\x80\x94 he has not yet decided what profession he wants to get. At school, he had bad grades in all subjects, and it\'s only thanks to wealthy parents that he was able to obtain the graduation certificate.The situation is complicated by the fact that each high education institution has the determined amount of voluntary donations, paid by the new students for admission \xe2\x80\x94 ni berubleys. He cannot pay more than ni, because then the difference between the paid amount and ni can be regarded as a bribe!Each rector is wearing the distinctive uniform of his university. Therefore, the uniform\'s pockets cannot contain coins of denomination more than ri. The rector also does not carry coins of denomination less than li in his pocket \xe2\x80\x94 because if everyone pays him with so small coins, they gather a lot of weight and the pocket tears. Therefore, a donation can be paid only by coins of denomination x berubleys, where li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri (Berland uses coins of any positive integer denomination). Alexey can use the coins of different denominations and he can use the coins of the same denomination any number of times. When Alexey was first confronted with such orders, he was puzzled because it turned out that not all universities can accept him! Alexey is very afraid of going into the army (even though he had long wanted to get the green uniform, but his dad says that the army bullies will beat his son and he cannot pay to ensure the boy\'s safety). So, Alexey wants to know for sure which universities he can enter so that he could quickly choose his alma mater.Thanks to the parents, Alexey is not limited in money and we can assume that he has an unlimited number of coins of each type.In other words, you are given t requests, each of them contains numbers ni,\xe2\x80\x89li,\xe2\x80\x89ri. For each query you need to answer, whether it is possible to gather the sum of exactly ni berubleys using only coins with an integer denomination from li to ri berubleys. You can use coins of different denominations. Coins of each denomination can be used any number of times." -999.0     
                                           394C Dominoes "constructive algorithms,greedy" "During the break, we decided to relax and play dominoes. Our box with Domino was empty, so we decided to borrow the teacher\'s dominoes.The teacher responded instantly at our request. He put nm dominoes on the table as an n\xe2\x80\x89\xc3\x97\xe2\x80\x892m rectangle so that each of the n rows contained m dominoes arranged horizontally. Each half of each domino contained number (0 or 1).We were taken aback, and the teacher smiled and said: ""Consider some arrangement of dominoes in an n\xe2\x80\x89\xc3\x97\xe2\x80\x892m matrix. Let\'s count for each column of the matrix the sum of numbers in this column. Then among all such sums find the maximum one. Can you rearrange the dominoes in the matrix in such a way that the maximum sum will be minimum possible? Note that it is prohibited to change the orientation of the dominoes, they all need to stay horizontal, nevertheless dominoes are allowed to rotate by 180 degrees. As a reward I will give you all my dominoes"".We got even more taken aback. And while we are wondering what was going on, help us make an optimal matrix of dominoes." -999.0     
                                           394A "Counting Sticks" "brute force,implementation" "When new students come to the Specialized Educational and Scientific Centre (SESC) they need to start many things from the beginning. Sometimes the teachers say (not always unfairly) that we cannot even count. So our teachers decided to teach us arithmetics from the start. And what is the best way to teach students add and subtract? \xe2\x80\x94 That\'s right, using counting sticks! An here\'s our new task: An expression of counting sticks is an expression of type:[ A sticks][sign +][B sticks][sign =][C sticks] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89A,\xe2\x80\x89B,\xe2\x80\x89C).  Sign + consists of two crossed sticks: one vertical and one horizontal. Sign = consists of two horizontal sticks. The expression is arithmetically correct if A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89=\xe2\x80\x89C.We\'ve got an expression that looks like A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89=\xe2\x80\x89C given by counting sticks. Our task is to shift at most one stick (or we can shift nothing) so that the expression became arithmetically correct. Note that we cannot remove the sticks from the expression, also we cannot shift the sticks from the signs + and =.We really aren\'t fabulous at arithmetics. Can you help us?" -999.0     
                                           386D "Game with Points" "dp,graphs,implementation,shortest paths" "You are playing the following game. There are n points on a plane. They are the vertices of a regular n-polygon. Points are labeled with integer numbers from 1 to n. Each pair of distinct points is connected by a diagonal, which is colored in one of 26 colors. Points are denoted by lowercase English letters. There are three stones positioned on three distinct vertices. All stones are the same. With one move you can move the stone to another free vertex along some diagonal. The color of this diagonal must be the same as the color of the diagonal, connecting another two stones. Your goal is to move stones in such way that the only vertices occupied by stones are 1, 2 and 3. You must achieve such position using minimal number of moves. Write a program which plays this game in an optimal way." 2100.0     
                                           383C "Propagating tree" "data structures,dfs and similar,trees" "Iahub likes trees very much. Recently he discovered an interesting tree named propagating tree. The tree consists of n nodes numbered from 1 to n, each node i having an initial value ai. The root of the tree is node 1.This tree has a special property: when a value val is added to a value of node i, the value -val is added to values of all the children of node i. Note that when you add value -val to a child of node i, you also add -(-val) to all children of the child of node i and so on. Look an example explanation to understand better how it works.This tree supports two types of queries:  ""1 x val"" \xe2\x80\x94 val is added to the value of node x;  ""2 x"" \xe2\x80\x94 print the current value of node x. In order to help Iahub understand the tree better, you must answer m queries of the preceding type." 2000.0     
                                           379B "New Year Present" "constructive algorithms,implementation" "The New Year is coming! That\'s why many people today are busy preparing New Year presents. Vasily the Programmer is no exception.Vasily knows that the best present is (no, it\'s not a contest) money. He\'s put n empty wallets from left to right in a row and decided how much money to put in what wallet. Vasily decided to put ai coins to the i-th wallet from the left.Vasily is a very busy man, so the money are sorted into the bags by his robot. Initially, the robot stands by the leftmost wallet in the row. The robot can follow instructions of three types: go to the wallet that is to the left of the current one (if such wallet exists), go to the wallet that is to the right of the current one (if such wallet exists), put a coin to the current wallet. Due to some technical malfunctions the robot cannot follow two ""put a coin"" instructions in a row.Vasily doesn\'t want to wait for long, so he wants to write a program for the robot that contains at most 106 operations (not necessarily minimum in length) the robot can use to put coins into the wallets. Help him." 1200.0     
                                           378B Semifinals implementation,sortings "Two semifinals have just been in the running tournament. Each semifinal had n participants. There are n participants advancing to the finals, they are chosen as follows: from each semifinal, we choose k people (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) who showed the best result in their semifinals and all other places in the finals go to the people who haven\'t ranked in the top k in their semifinal but got to the n\xe2\x80\x89-\xe2\x80\x892k of the best among the others.The tournament organizers hasn\'t yet determined the k value, so the participants want to know who else has any chance to get to the finals and who can go home." 1300.0     
                                           375C "Circling Round Treasures" "bitmasks,shortest paths" "You have a map as a rectangle table. Each cell of the table is either an obstacle, or a treasure with a certain price, or a bomb, or an empty cell. Your initial position is also given to you.You can go from one cell of the map to a side-adjacent one. At that, you are not allowed to go beyond the borders of the map, enter the cells with treasures, obstacles and bombs. To pick the treasures, you need to build a closed path (starting and ending in the starting cell). The closed path mustn\'t contain any cells with bombs inside. Let\'s assume that the sum of the treasures\' values that are located inside the closed path equals v, and besides, you\'ve made k single moves (from one cell to another) while you were going through the path, then such path brings you the profit of v\xe2\x80\x89-\xe2\x80\x89k rubles.Your task is to build a closed path that doesn\'t contain any bombs and brings maximum profit.Note that the path can have self-intersections. In order to determine if a cell lies inside a path or not, use the following algorithm:  Assume that the table cells are points on the plane (the table cell on the intersection of the i-th column and the j-th row is point (i,\xe2\x80\x89j)). And the given path is a closed polyline that goes through these points.  You need to find out if the point p of the table that is not crossed by the polyline lies inside the polyline.  Let\'s draw a ray that starts from point p and does not intersect other points of the table (such ray must exist).  Let\'s count the number of segments of the polyline that intersect the painted ray. If this number is odd, we assume that point p (and consequently, the table cell) lie inside the polyline (path). Otherwise, we assume that it lies outside." 2600.0     
                                           373B "Making Sequences is Fun" "binary search,implementation,math" "We\'ll define S(n) for positive integer n as follows: the number of the n\'s digits in the decimal base. For example, S(893)\xe2\x80\x89=\xe2\x80\x893, S(114514)\xe2\x80\x89=\xe2\x80\x896.You want to make a consecutive integer sequence starting from number m (m,\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...). But you need to pay S(n)\xc2\xb7k to add the number n to the sequence.You can spend a cost up to w, and you want to make the sequence as long as possible. Write a program that tells sequence\'s maximum length." 1600.0     
                                           373A "Collecting Beats is Fun" implementation "Cucumber boy is fan of Kyubeat, a famous music game.Kyubeat has 16 panels for playing arranged in 4\xe2\x80\x89\xc3\x97\xe2\x80\x894 table. When a panel lights up, he has to press that panel.Each panel has a timing to press (the preffered time when a player should press it), and Cucumber boy is able to press at most k panels in a time with his one hand. Cucumber boy is trying to press all panels in perfect timing, that is he wants to press each panel exactly in its preffered time. If he cannot press the panels with his two hands in perfect timing, his challenge to press all the panels in perfect timing will fail.You are given one scene of Kyubeat\'s panel from the music Cucumber boy is trying. Tell him is he able to press all the panels in perfect timing." 900.0     
                                           370C Mittens "constructive algorithms,greedy,sortings" "A Christmas party in city S. had n children. All children came in mittens. The mittens can be of different colors, but each child had the left and the right mitten of the same color. Let\'s say that the colors of the mittens are numbered with integers from 1 to m, and the children are numbered from 1 to n. Then the i-th child has both mittens of color ci.The Party had Santa Claus (\'Father Frost\' in Russian), his granddaughter Snow Girl, the children danced around the richly decorated Christmas tree. In fact, everything was so bright and diverse that the children wanted to wear mittens of distinct colors. The children decided to swap the mittens so that each of them got one left and one right mitten in the end, and these two mittens were of distinct colors. All mittens are of the same size and fit all the children.The children started exchanging the mittens haphazardly, but they couldn\'t reach the situation when each child has a pair of mittens of distinct colors. Vasily Petrov, the dad of one of the children, noted that in the general case the children\'s idea may turn out impossible. Besides, he is a mathematician and he came up with such scheme of distributing mittens that the number of children that have distinct-colored mittens was maximum. You task is to repeat his discovery. Note that the left and right mittens are different: each child must end up with one left and one right mitten." 1800.0     
                                           370A "Rook, Bishop and King" "graphs,math,shortest paths" "Little Petya is learning to play chess. He has already learned how to move a king, a rook and a bishop. Let us remind you the rules of moving chess pieces. A chessboard is 64 square fields organized into an 8\xe2\x80\x89\xc3\x97\xe2\x80\x898 table. A field is represented by a pair of integers (r,\xe2\x80\x89c) \xe2\x80\x94 the number of the row and the number of the column (in a classical game the columns are traditionally indexed by letters). Each chess piece takes up exactly one field. To make a move is to move a chess piece, the pieces move by the following rules:  A rook moves any number of fields horizontally or vertically.  A bishop moves any number of fields diagonally.  A king moves one field in any direction \xe2\x80\x94 horizontally, vertically or diagonally.   The pieces move like that Petya is thinking about the following problem: what minimum number of moves is needed for each of these pieces to move from field (r1,\xe2\x80\x89c1) to field (r2,\xe2\x80\x89c2)? At that, we assume that there are no more pieces besides this one on the board. Help him solve this problem." 1100.0     
                                           366E "Dima and Magic Guitar" "brute force,implementation,math" "Dima loves Inna very much. He decided to write a song for her. Dima has a magic guitar with n strings and m frets. Dima makes the guitar produce sounds like that: to play a note, he needs to hold one of the strings on one of the frets and then pull the string. When Dima pulls the i-th string holding it on the j-th fret the guitar produces a note, let\'s denote it as aij. We know that Dima\'s guitar can produce k distinct notes. It is possible that some notes can be produced in multiple ways. In other words, it is possible that aij\xe2\x80\x89=\xe2\x80\x89apq at (i,\xe2\x80\x89j)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89(p,\xe2\x80\x89q).Dima has already written a song \xe2\x80\x94 a sequence of s notes. In order to play the song, you need to consecutively produce the notes from the song on the guitar. You can produce each note in any available way. Dima understood that there are many ways to play a song and he wants to play it so as to make the song look as complicated as possible (try to act like Cobein).We\'ll represent a way to play a song as a sequence of pairs (xi,\xe2\x80\x89yi) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s), such that the xi-th string on the yi-th fret produces the i-th note from the song. The complexity of moving between pairs (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) equals  + . The complexity of a way to play a song is the maximum of complexities of moving between adjacent pairs.Help Dima determine the maximum complexity of the way to play his song! The guy\'s gotta look cool!" 2200.0     
                                           358E "Dima and Kicks" "brute force,dsu,graphs,implementation" "Dima is a good person. In fact, he\'s great. But all good things come to an end...Seryozha is going to kick Dima just few times.. For this reason he divides the room into unit squares. Now the room is a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m consisting of unit squares.For the beginning, Seryozha put Dima in a center of some square. Then he started to kick Dima (it is known, that he kicks Dima at least once). Each time when Dima is kicked he flyes up and moves into one of four directions (up, left, right, down). On each move Dima passes k (k\xe2\x80\x89>\xe2\x80\x891) unit of the length in the corresponding direction. Seryozha is really kind, so he kicks Dima in such way that Dima never meets the walls (in other words, Dima never leave the room\'s space). Seryozha is also dynamic character so Dima never flies above the same segment, connecting a pair of adjacent squares, twice.Seryozha kicks Dima for a long time, but Dima is not vindictive \xe2\x80\x94 Dima writes. Dima marked all squares in which he was staying or above which he was flying. Thanks to kicks, Dima does not remember the k value, so he asks you to find all possible values which matches to the Dima\'s records." 2300.0     
                                           358B "Dima and Text Messages" "brute force,strings" "Seryozha has a very changeable character. This time he refused to leave the room to Dima and his girlfriend (her hame is Inna, by the way). However, the two lovebirds can always find a way to communicate. Today they are writing text messages to each other.Dima and Inna are using a secret code in their text messages. When Dima wants to send Inna some sentence, he writes out all words, inserting a heart before each word and after the last word. A heart is a sequence of two characters: the ""less"" characters (<) and the digit three (3). After applying the code, a test message looks like that: <3word1<3word2<3 ... wordn<3.Encoding doesn\'t end here. Then Dima inserts a random number of small English characters, digits, signs ""more"" and ""less"" into any places of the message.Inna knows Dima perfectly well, so she knows what phrase Dima is going to send her beforehand. Inna has just got a text message. Help her find out if Dima encoded the message correctly. In other words, find out if a text message could have been received by encoding in the manner that is described above." 1500.0     
                                           356C Compartments "combinatorics,constructive algorithms,greedy,implementation" "A team of students from the city S is sent to the All-Berland Olympiad in Informatics. Traditionally, they go on the train. All students have bought tickets in one carriage, consisting of n compartments (each compartment has exactly four people). We know that if one compartment contain one or two students, then they get bored, and if one compartment contain three or four students, then the compartment has fun throughout the entire trip.The students want to swap with other people, so that no compartment with students had bored students. To swap places with another person, you need to convince him that it is really necessary. The students can not independently find the necessary arguments, so they asked a sympathetic conductor for help. The conductor can use her life experience to persuade any passenger to switch places with some student.However, the conductor does not want to waste time persuading the wrong people, so she wants to know what is the minimum number of people necessary to persuade her to change places with the students. Your task is to find the number. After all the swaps each compartment should either have no student left, or have a company of three or four students." 2100.0     
                                           351E "Jeff and Permutation" greedy "Jeff\'s friends know full well that the boy likes to get sequences and arrays for his birthday. Thus, Jeff got sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn for his birthday.Jeff hates inversions in sequences. An inversion in sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is a pair of indexes i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that an inequality ai\xe2\x80\x89>\xe2\x80\x89aj holds.Jeff can multiply some numbers of the sequence p by -1. At that, he wants the number of inversions in the sequence to be minimum. Help Jeff and find the minimum number of inversions he manages to get." 2200.0     
                                           346E "Doodle Jump" "math,number theory" "In Doodle Jump the aim is to guide a four-legged creature called ""The Doodler"" up a never-ending series of platforms without falling. \xe2\x80\x94 Wikipedia. It is a very popular game and xiaodao likes it very much. One day when playing the game she wondered whether there exists a platform that the doodler couldn\'t reach due to the limits of its jumping ability. Consider the following problem.There are n platforms. The height of the x-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) platform is a\xc2\xb7x mod p, where a and p are positive co-prime integers. The maximum possible height of a Doodler\'s jump is h. That is, it can jump from height h1 to height h2 (h1\xe2\x80\x89<\xe2\x80\x89h2) if h2\xe2\x80\x89-\xe2\x80\x89h1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89h. Initially, the Doodler is on the ground, the height of which is 0. The question is whether it can reach the highest platform or not.For example, when a\xe2\x80\x89=\xe2\x80\x897, n\xe2\x80\x89=\xe2\x80\x894, p\xe2\x80\x89=\xe2\x80\x8912, h\xe2\x80\x89=\xe2\x80\x892, the heights of the platforms are 7, 2, 9, 4 as in the picture below. With the first jump the Doodler can jump to the platform at height 2, with the second one the Doodler can jump to the platform at height 4, but then it can\'t jump to any of the higher platforms. So, it can\'t reach the highest platform.  User xiaodao thought about the problem for a long time but didn\'t solve it, so she asks you for help. Also, she has a lot of instances of the problem. Your task is solve all of these instances." 3000.0     
                                           345G "Suffix Subgroup" "*special problem,strings" "You are given a group of n strings: s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn.You should find a subgroup si1,\xe2\x80\x89si2,\xe2\x80\x89...,\xe2\x80\x89sik (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of the group. The following two conditions must hold:  there exists a string t such, that each string from found subgroup is its suffix;  the number of strings in the found subgroup is as large as possible. Your task is to print the number of strings in the found subgroup." 2200.0     
                                           343A "Rational Resistance" "math,number theory" "Mad scientist Mike is building a time machine in his spare time. To finish the work, he needs a resistor with a certain resistance value.However, all Mike has is lots of identical resistors with unit resistance R0\xe2\x80\x89=\xe2\x80\x891. Elements with other resistance can be constructed from these resistors. In this problem, we will consider the following as elements:   one resistor;  an element and one resistor plugged in sequence;  an element and one resistor plugged in parallel.   With the consecutive connection the resistance of the new element equals R\xe2\x80\x89=\xe2\x80\x89Re\xe2\x80\x89+\xe2\x80\x89R0. With the parallel connection the resistance of the new element equals . In this case Re equals the resistance of the element being connected.Mike needs to assemble an element with a resistance equal to the fraction . Determine the smallest possible number of resistors he needs to make such an element." 1600.0     
                                           341D "Iahub and Xors" "data structures" "Iahub does not like background stories, so he\'ll tell you exactly what this problem asks you for.You are given a matrix a with n rows and n columns. Initially, all values of the matrix are zeros. Both rows and columns are 1-based, that is rows are numbered 1, 2, ..., n and columns are numbered 1, 2, ..., n. Let\'s denote an element on the i-th row and j-th column as ai,\xe2\x80\x89j.We will call a submatrix (x0,\xe2\x80\x89y0,\xe2\x80\x89x1,\xe2\x80\x89y1) such elements ai,\xe2\x80\x89j for which two inequalities hold: x0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1, y0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1.Write a program to perform two following operations:  Query(x0, y0, x1, y1): print the xor sum of the elements of the submatrix (x0,\xe2\x80\x89y0,\xe2\x80\x89x1,\xe2\x80\x89y1).  Update(x0, y0, x1, y1, v): each element from submatrix (x0,\xe2\x80\x89y0,\xe2\x80\x89x1,\xe2\x80\x89y1) gets xor-ed by value v." 2500.0     
                                           338E Optimize! "data structures" "Manao is solving a problem with the following statement:  He came up with a solution that produces the correct answers but is too slow. You are given the pseudocode of his solution, where the function getAnswer calculates the answer to the problem:getAnswer(a[1..n], b[1..len], h)  answer = 0  for i = 1 to n-len+1    answer = answer + f(a[i..i+len-1], b, h, 1)  return answerf(s[1..len], b[1..len], h, index)  if index = len+1 then    return 1  for i = 1 to len    if s[index] + b[i] >= h      mem = b[i]      b[i] = 0      res = f(s, b, h, index + 1)      b[i] = mem      if res > 0        return 1  return 0Your task is to help Manao optimize his algorithm." 2600.0     
                                           336A "Vasily the Bear and Triangle" implementation,math "Vasily the bear has a favorite rectangle, it has one vertex at point (0,\xe2\x80\x890), and the opposite vertex at point (x,\xe2\x80\x89y). Of course, the sides of Vasya\'s favorite rectangle are parallel to the coordinate axes. Vasya also loves triangles, if the triangles have one vertex at point B\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x890). That\'s why today he asks you to find two points A\xe2\x80\x89=\xe2\x80\x89(x1,\xe2\x80\x89y1) and C\xe2\x80\x89=\xe2\x80\x89(x2,\xe2\x80\x89y2), such that the following conditions hold:  the coordinates of points: x1, x2, y1, y2 are integers. Besides, the following inequation holds: x1\xe2\x80\x89<\xe2\x80\x89x2;  the triangle formed by point A, B and C is rectangular and isosceles ( is right);  all points of the favorite rectangle are located inside or on the border of triangle ABC;  the area of triangle ABC is as small as possible. Help the bear, find the required points. It is not so hard to proof that these points are unique." 1000.0     
                                           335F "Buy One, Get One Free" dp,greedy "A nearby pie shop is having a special sale. For each pie you pay full price for, you may select one pie of a strictly lesser value to get for free. Given the prices of all the pies you wish to acquire, determine the minimum total amount you must pay for all of the pies." 3000.0     
                                           330B "Road Construction" "constructive algorithms,graphs" "A country has n cities. Initially, there is no road in the country. One day, the king decides to construct some roads connecting pairs of cities. Roads can be traversed either way. He wants those roads to be constructed in such a way that it is possible to go from each city to any other city by traversing at most two roads. You are also given m pairs of cities \xe2\x80\x94 roads cannot be constructed between these pairs of cities.Your task is to construct the minimum number of roads that still satisfy the above conditions. The constraints will guarantee that this is always possible." 1300.0     
                                           329C "Graph Reconstruction" "constructive algorithms" "I have an undirected graph consisting of n nodes, numbered 1 through n. Each node has at most two incident edges. For each pair of nodes, there is at most an edge connecting them. No edge connects a node to itself.I would like to create a new graph in such a way that:   The new graph consists of the same number of nodes and edges as the old graph.  The properties in the first paragraph still hold.  For each two nodes u and v, if there is an edge connecting them in the old graph, there is no edge connecting them in the new graph. Help me construct the new graph, or tell me if it is impossible." 2400.0     
                                           329A Purification "constructive algorithms,greedy" "You are an adventurer currently journeying inside an evil temple. After defeating a couple of weak zombies, you arrived at a square room consisting of tiles forming an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n grid. The rows are numbered 1 through n from top to bottom, and the columns are numbered 1 through n from left to right. At the far side of the room lies a door locked with evil magical forces. The following inscriptions are written on the door: The cleaning of all evil will awaken the door! Being a very senior adventurer, you immediately realize what this means. You notice that every single cell in the grid are initially evil. You should purify all of these cells.The only method of tile purification known to you is by casting the ""Purification"" spell. You cast this spell on a single tile \xe2\x80\x94 then, all cells that are located in the same row and all cells that are located in the same column as the selected tile become purified (including the selected tile)! It is allowed to purify a cell more than once.You would like to purify all n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells while minimizing the number of times you cast the ""Purification"" spell. This sounds very easy, but you just noticed that some tiles are particularly more evil than the other tiles. You cannot cast the ""Purification"" spell on those particularly more evil tiles, not even after they have been purified. They can still be purified if a cell sharing the same row or the same column gets selected by the ""Purification"" spell.Please find some way to purify all the cells with the minimum number of spells cast. Print -1 if there is no such way." 1500.0     
                                           327B "Hungry Sequence" math "Iahub and Iahubina went to a date at a luxury restaurant. Everything went fine until paying for the food. Instead of money, the waiter wants Iahub to write a Hungry sequence consisting of n integers. A sequence a1, a2, ..., an, consisting of n integers, is Hungry if and only if:   Its elements are in increasing order. That is an inequality ai\xe2\x80\x89<\xe2\x80\x89aj holds for any two indices i,\xe2\x80\x89j (i\xe2\x80\x89<\xe2\x80\x89j).  For any two indices i and j (i\xe2\x80\x89<\xe2\x80\x89j), aj must not be divisible by ai. Iahub is in trouble, so he asks you for help. Find a Hungry sequence with n elements." 1200.0     
                                           321E "Ciel and Gondolas" "data structures,divide and conquer,dp" "Fox Ciel is in the Amusement Park. And now she is in a queue in front of the Ferris wheel. There are n people (or foxes more precisely) in the queue: we use first people to refer one at the head of the queue, and n-th people to refer the last one in the queue.There will be k gondolas, and the way we allocate gondolas looks like this:  When the first gondolas come, the q1 people in head of the queue go into the gondolas.  Then when the second gondolas come, the q2 people in head of the remain queue go into the gondolas.    ... The remain qk people go into the last (k-th) gondolas. Note that q1, q2, ..., qk must be positive. You can get from the statement that  and qi\xe2\x80\x89>\xe2\x80\x890.You know, people don\'t want to stay with strangers in the gondolas, so your task is to find an optimal allocation way (that is find an optimal sequence q) to make people happy. For every pair of people i and j, there exists a value uij denotes a level of unfamiliar. You can assume uij\xe2\x80\x89=\xe2\x80\x89uji for all i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and uii\xe2\x80\x89=\xe2\x80\x890 for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Then an unfamiliar value of a gondolas is the sum of the levels of unfamiliar between any pair of people that is into the gondolas.A total unfamiliar value is the sum of unfamiliar values for all gondolas. Help Fox Ciel to find the minimal possible total unfamiliar value for some optimal allocation." 2600.0     
                                           321A "Ciel and Robot" "binary search,implementation,math" "Fox Ciel has a robot on a 2D plane. Initially it is located in (0, 0). Fox Ciel code a command to it. The command was represented by string s. Each character of s is one move operation. There are four move operations at all:  \'U\': go up, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x, y+1);  \'D\': go down, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x, y-1);  \'L\': go left, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x-1, y);  \'R\': go right, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x+1, y). The robot will do the operations in s from left to right, and repeat it infinite times. Help Fox Ciel to determine if after some steps the robot will located in (a,\xe2\x80\x89b)." 1700.0     
                                           319E Ping-Pong "data structures" "In this problem at each moment you have a set of intervals. You can move from interval (a,\xe2\x80\x89b) from our set to interval (c,\xe2\x80\x89d) from our set if and only if c\xe2\x80\x89<\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x89d or c\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89d. Also there is a path from interval I1 from our set to interval I2 from our set if there is a sequence of successive moves starting from I1 so that we can reach I2.Your program should handle the queries of the following two types:  ""1 x y"" (x\xe2\x80\x89<\xe2\x80\x89y) \xe2\x80\x94 add the new interval (x,\xe2\x80\x89y) to the set of intervals. The length of the new interval is guaranteed to be strictly greater than all the previous intervals. ""2 a b"" (a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b) \xe2\x80\x94 answer the question: is there a path from a-th (one-based) added interval to b-th (one-based) added interval? Answer all the queries. Note, that initially you have an empty set of intervals." 3000.0     
                                           319A "Malek Dance Club" combinatorics,math "As a tradition, every year before IOI all the members of Natalia Fan Club are invited to Malek Dance Club to have a fun night together. Malek Dance Club has 2n members and coincidentally Natalia Fan Club also has 2n members. Each member of MDC is assigned a unique id i from 0 to 2n\xe2\x80\x89-\xe2\x80\x891. The same holds for each member of NFC.One of the parts of this tradition is one by one dance, where each member of MDC dances with a member of NFC. A dance pair is a pair of numbers (a,\xe2\x80\x89b) such that member a from MDC dances with member b from NFC.The complexity of a pairs\' assignment is the number of pairs of dancing pairs (a,\xe2\x80\x89b) and (c,\xe2\x80\x89d) such that a\xe2\x80\x89<\xe2\x80\x89c and b\xe2\x80\x89>\xe2\x80\x89d.You are given a binary number of length n named x. We know that member i from MDC dances with member  from NFC. Your task is to calculate the complexity of this assignment modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Expression  denotes applying \xc2\xabXOR\xc2\xbb to numbers x and y. This operation exists in all modern programming languages, for example, in C++ and Java it denotes as \xc2\xab^\xc2\xbb, in Pascal \xe2\x80\x94 \xc2\xabxor\xc2\xbb." 1600.0     
                                           318A "Even Odds" math "Being a nonconformist, Volodya is displeased with the current state of things, particularly with the order of natural numbers (natural number is positive integer number). He is determined to rearrange them. But there are too many natural numbers, so Volodya decided to start with the first n. He writes down the following sequence of numbers: firstly all odd integers from 1 to n (in ascending order), then all even integers from 1 to n (also in ascending order). Help our hero to find out which number will stand at the position number k." 900.0     
                                           317E "Princess and Her Shadow" "constructive algorithms,shortest paths" "Princess Vlada enjoys springing in the meadows and walking in the forest. One day \xe2\x80\x94 wonderful, sunny day \xe2\x80\x94 during her walk Princess found out with astonishment that her shadow was missing! ""Blimey!"", \xe2\x80\x94 she thought and started her search of the shadow in the forest.Normally the Shadow is too lazy and simply sleeps under the Princess. But at this terrifically hot summer day she got bored of such a dull life, so she decided to play with Vlada.The forest, where our characters entertain themselves, may be represented as a set of integer cells in the plane, where the Shadow and the Princess can move only up, down, left and right by 1. Some cells (as it happens in decent forests) are occupied by trees. The Shadow and the Princess are not allowed to enter a cell occupied by a tree. Unfortunately, these are the hard times for the forest, so there are very few trees growing here...At first the Princess was walking within the cell (vx, vy), while the Shadow hid from the Princess in the cell (sx, sy). The Princess, The Shadow and the trees are located in the different cells.The Shadow is playing with the Princess. As soon as the Princess moves by 1 in some direction, the Shadow simultaneously flies by 1 in the same direction, if it is possible (if the cell to fly to is not occupied by some tree); otherwise, the Shadow doesn\'t move. The Shadow is very shadowy, so our characters do not interfere with each other.We say that the Shadow is caught by the Princess if after some move both of them are located in the same cell. Vlada managed to catch her Shadow! Can you?" 3100.0     
                                           317C Balance "constructive algorithms,dfs and similar,graphs,trees" "A system of n vessels with water is given. Several pairs of vessels are connected by tubes with transfusion mechanisms. One may transfer an integer amount of liters of water between two vessels connected by such tube (tube works in both directions). There might be multiple tubes between two vessels. Total number of tubes equals e. Volume of each vessel equals v liters. Of course, the amount of the water in any vessel cannot exceed v liters in the process of transfusions.Given the initial amounts ai of water in the vessels and the desired amounts bi find a sequence of transfusions that deals with the task. Total number of transfusions must not exceed 2\xc2\xb7n2." 2500.0     
                                           317A "Perfect Pair" "brute force" "Let us call a pair of integer numbers m-perfect, if at least one number in the pair is greater than or equal to m. Thus, the pairs (3, 3) and (0, 2) are 2-perfect while the pair (-1, 1) is not.Two integers x, y are written on the blackboard. It is allowed to erase one of them and replace it with the sum of the numbers, (x\xe2\x80\x89+\xe2\x80\x89y).What is the minimum number of such operations one has to perform in order to make the given pair of integers m-perfect?" 1600.0     
                                           316G2 "Good Substrings" "string suffix structures" "Smart Beaver recently got interested in a new word game. The point is as follows: count the number of distinct good substrings of some string s. To determine if a string is good or not the game uses rules. Overall there are n rules. Each rule is described by a group of three (p,\xe2\x80\x89l,\xe2\x80\x89r), where p is a string and l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are integers. We\xe2\x80\x99ll say that string t complies with rule (p,\xe2\x80\x89l,\xe2\x80\x89r), if the number of occurrences of string t in string p lies between l and r, inclusive. For example, string ""ab"", complies with rules (""ab"", 1, 2) and (""aab"", 0, 1), but does not comply with rules (""cd"", 1, 2) and (""abab"", 0, 1).A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (|s| is a length of s) is string slsl\xe2\x80\x89+\xe2\x80\x891... sr.Consider a number of occurrences  of string t in string p as a number of pairs of integers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|) such that p[l... r]\xe2\x80\x89=\xe2\x80\x89t.We\xe2\x80\x99ll say that string t is good if it complies with all n rules. Smart Beaver asks you to help him to write a program that can calculate the number of distinct good substrings of string s. Two substrings s[x... y] and s[z... w] are cosidered to be distinct iff s[x... y]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s[z... w]." 2200.0     
                                           316E2 "Summer Homework" "data structures,math" "By the age of three Smart Beaver mastered all arithmetic operations and got this summer homework from the amazed teacher:You are given a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to perform on it m consecutive operations of the following type:  For given numbers xi and vi assign value vi to element axi.  For given numbers li and ri you\'ve got to calculate sum , where f0\xe2\x80\x89=\xe2\x80\x89f1\xe2\x80\x89=\xe2\x80\x891 and at i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892: fi\xe2\x80\x89=\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x892.  For a group of three numbers li ri di you should increase value ax by di for all x (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri). Smart Beaver planned a tour around great Canadian lakes, so he asked you to help him solve the given problem." 2300.0     
                                           316E1 "Summer Homework" "brute force,data structures" "By the age of three Smart Beaver mastered all arithmetic operations and got this summer homework from the amazed teacher:You are given a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to perform on it m consecutive operations of the following type:  For given numbers xi and vi assign value vi to element axi.  For given numbers li and ri you\'ve got to calculate sum , where f0\xe2\x80\x89=\xe2\x80\x89f1\xe2\x80\x89=\xe2\x80\x891 and at i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892: fi\xe2\x80\x89=\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x892.  For a group of three numbers li ri di you should increase value ax by di for all x (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri). Smart Beaver planned a tour around great Canadian lakes, so he asked you to help him solve the given problem." 1500.0     
                                           315B "Sereja and Array" implementation "Sereja has got an array, consisting of n integers, a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Sereja is an active boy, so he is now going to complete m operations. Each operation will have one of the three forms:  Make vi-th array element equal to xi. In other words, perform the assignment avi\xe2\x80\x89=\xe2\x80\x89xi.  Increase each array element by yi. In other words, perform n assignments ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89yi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).  Take a piece of paper and write out the qi-th array element. That is, the element aqi. Help Sereja, complete all his operations." 1200.0     
                                           309C "Memory for Arrays" "binary search,bitmasks,greedy" "You get to work and turn on the computer. You start coding and give little thought to the RAM role in the whole process. In this problem your task is to solve one of the problems you encounter in your computer routine.We\'ll consider the RAM as a sequence of cells that can contain data. Some cells already contain some data, some are empty. The empty cells form the so-called memory clusters. Thus, a memory cluster is a sequence of some consecutive empty memory cells. You have exactly n memory clusters, the i-th cluster consists of ai cells. You need to find memory for m arrays in your program. The j-th array takes 2bj consecutive memory cells. There possibly isn\'t enough memory for all m arrays, so your task is to determine what maximum number of arrays can be located in the available memory clusters. Of course, the arrays cannot be divided between the memory clusters. Also, no cell can belong to two arrays." 1900.0     
                                           306D Polygon "constructive algorithms,geometry" "Polycarpus loves convex polygons, especially if all their angles are the same and all their sides are different. Draw for him any such polygon with the given number of vertexes." 2300.0     
                                           306C "White, Black and White Again" "combinatorics,number theory" "Polycarpus is sure that his life fits the description: ""first there is a white stripe, then a black one, then a white one again"". So, Polycarpus is sure that this rule is going to fulfill during the next n days. Polycarpus knows that he is in for w good events and b not-so-good events. At least one event is going to take place during each day. As each day is unequivocally characterizes as a part of a white or a black stripe, then each day is going to have events of the same type only (ether good or not-so-good).What is the number of distinct ways this scenario can develop over the next n days if Polycarpus is in for a white stripe (a stripe that has good events only, the stripe\'s length is at least 1 day), the a black stripe (a stripe that has not-so-good events only, the stripe\'s length is at least 1 day) and a white stripe again (a stripe that has good events only, the stripe\'s length is at least 1 day). Each of n days will belong to one of the three stripes only.Note that even the events of the same type are distinct from each other. Even if some events occur on the same day, they go in some order (there are no simultaneous events).Write a code that prints the number of possible configurations to sort the events into days. See the samples for clarifications on which scenarios should be considered distinct. Print the answer modulo 1000000009 (109\xe2\x80\x89+\xe2\x80\x899)." 2100.0     
                                           303D "Rotatable Number" "math,number theory" "Bike is a smart boy who loves math very much. He invented a number called ""Rotatable Number"" inspired by 142857. As you can see, 142857 is a magic number because any of its rotatings can be got by multiplying that number by 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x896 (numbers from one to number\'s length). Rotating a number means putting its last several digit into first. For example, by rotating number 12345 you can obtain any numbers: 12345,\xe2\x80\x8951234,\xe2\x80\x8945123,\xe2\x80\x8934512,\xe2\x80\x8923451. It\'s worth mentioning that leading-zeroes are allowed. So both 4500123 and 0123450 can be obtained by rotating 0012345. You can see why 142857 satisfies the condition. All of the 6 equations are under base 10.  142857\xc2\xb71\xe2\x80\x89=\xe2\x80\x89142857;  142857\xc2\xb72\xe2\x80\x89=\xe2\x80\x89285714;  142857\xc2\xb73\xe2\x80\x89=\xe2\x80\x89428571;  142857\xc2\xb74\xe2\x80\x89=\xe2\x80\x89571428;  142857\xc2\xb75\xe2\x80\x89=\xe2\x80\x89714285;  142857\xc2\xb76\xe2\x80\x89=\xe2\x80\x89857142. Now, Bike has a problem. He extends ""Rotatable Number"" under any base b. As is mentioned above, 142857 is a ""Rotatable Number"" under base 10. Another example is 0011 under base 2. All of the 4 equations are under base 2.  0011\xc2\xb71\xe2\x80\x89=\xe2\x80\x890011;  0011\xc2\xb710\xe2\x80\x89=\xe2\x80\x890110;  0011\xc2\xb711\xe2\x80\x89=\xe2\x80\x891001;  0011\xc2\xb7100\xe2\x80\x89=\xe2\x80\x891100. So, he wants to find the largest b (1\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89x) so that there is a positive ""Rotatable Number"" (leading-zeroes allowed) of length n under base b.Note that any time you multiply a rotatable number by numbers from 1 to its length you should get a rotating of that number." 2600.0     
                                           301D "Yaroslav and Divisors" "data structures" "Yaroslav has an array p\xe2\x80\x89=\xe2\x80\x89p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), consisting of n distinct integers. Also, he has m queries:  Query number i is represented as a pair of integers li, ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).  The answer to the query li,\xe2\x80\x89ri is the number of pairs of integers q, w (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q,\xe2\x80\x89w\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri) such that pq is the divisor of pw. Help Yaroslav, answer all his queries." 2200.0     
                                           300B Coach "brute force,dfs and similar,graphs" "A programming coach has n students to teach. We know that n is divisible by 3. Let\'s assume that all students are numbered from 1 to n, inclusive.Before the university programming championship the coach wants to split all students into groups of three. For some pairs of students we know that they want to be on the same team. Besides, if the i-th student wants to be on the same team with the j-th one, then the j-th student wants to be on the same team with the i-th one. The coach wants the teams to show good results, so he wants the following condition to hold: if the i-th student wants to be on the same team with the j-th, then the i-th and the j-th students must be on the same team. Also, it is obvious that each student must be on exactly one team.Help the coach and divide the teams the way he wants." 1500.0     
                                           299B "Ksusha the Squirrel" "brute force,implementation" "Ksusha the Squirrel is standing at the beginning of a straight road, divided into n sectors. The sectors are numbered 1 to n, from left to right. Initially, Ksusha stands in sector 1. Ksusha wants to walk to the end of the road, that is, get to sector n. Unfortunately, there are some rocks on the road. We know that Ksusha hates rocks, so she doesn\'t want to stand in sectors that have rocks.Ksusha the squirrel keeps fit. She can jump from sector i to any of the sectors i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x89k. Help Ksusha! Given the road description, say if she can reach the end of the road (note, she cannot stand on a rock)?" 900.0     
                                           297B "Fish Weight" "constructive algorithms,greedy" "It is known that there are k fish species in the polar ocean, numbered from 1 to k. They are sorted by non-decreasing order of their weight, which is a positive number. Let the weight of the i-th type of fish be wi, then 0\xe2\x80\x89<\xe2\x80\x89w1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89wk holds.Polar bears Alice and Bob each have caught some fish, and they are guessing who has the larger sum of weight of the fish he/she\'s caught. Given the type of the fish they\'ve caught, determine whether it is possible that the fish caught by Alice has a strictly larger total weight than Bob\'s. In other words, does there exist a sequence of weights wi (not necessary integers), such that the fish caught by Alice has a strictly larger total weight?" 1600.0     
                                           296A "Yaroslav and Permutations" greedy,math "Yaroslav has an array that consists of n integers. In one second Yaroslav can swap two neighboring array elements. Now Yaroslav is wondering if he can obtain an array where any two neighboring elements would be distinct in a finite time.Help Yaroslav." 1100.0     
                                           294D "Shaass and Painter Robot" "brute force,implementation,number theory" "Shaass thinks a kitchen with all white floor tiles is so boring. His kitchen floor is made of n\xc2\xb7m square tiles forming a n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle. Therefore he\'s decided to color some of the tiles in black so that the floor looks like a checkerboard, which is no two side-adjacent tiles should have the same color.Shaass wants to use a painter robot to color the tiles. In the beginning the robot is standing in a border tile (xs,\xe2\x80\x89ys) facing a diagonal direction (i.e. upper-left, upper-right, down-left or down-right). As the robot walks in the kitchen he paints every tile he passes even if it\'s painted before. Painting each tile consumes one unit of black paint. If at any moment the robot hits a wall of the kitchen he changes his direction according the reflection rules. Note that a tile gets painted when the robot enters the tile from another tile, in other words changing direction in the same tile doesn\'t lead to any painting. The first tile the robot is standing on, is also painted.The robot stops painting the first moment the floor is checkered. Given the dimensions of the kitchen and the position of the robot, find out the amount of paint the robot consumes before it stops painting the floor.Let\'s consider an examples depicted below.  If the robot starts at tile number 1 (the tile (1,\xe2\x80\x891)) of the left grid heading to down-right it\'ll pass tiles 1354236 and consumes 7 units of black paint on his way until he stops at tile number 6. But if it starts at tile number 1 in the right grid heading to down-right it will get stuck in a loop painting tiles 1, 2, and 3." 2500.0     
                                           293C "Cube Problem" "brute force,math,number theory" "Yaroslav, Andrey and Roman love playing cubes. Sometimes they get together and play cubes for hours and hours! Today they got together again and they are playing cubes. Yaroslav took unit cubes and composed them into an a\xe2\x80\x89\xc3\x97\xe2\x80\x89a\xe2\x80\x89\xc3\x97\xe2\x80\x89a cube, Andrey made a b\xe2\x80\x89\xc3\x97\xe2\x80\x89b\xe2\x80\x89\xc3\x97\xe2\x80\x89b cube and Roman made a c\xe2\x80\x89\xc3\x97\xe2\x80\x89c\xe2\x80\x89\xc3\x97\xe2\x80\x89c cube. After that the game was finished and the guys left. But later, Vitaly entered the room. He saw the cubes and wanted to make a cube as well. But what size should the cube be? Of course it should be a large cube with the side of length a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x89c. Besides, Vitaly decided to decompose the cubes built by Yaroslav, Andrey and Roman and compose his own large cube out of them. However, it turned out that the unit cubes he got from destroying the three cubes just weren\'t enough to make a large cube. We know that Vitaly was short of exactly n cubes. Vitaly got upset, demolished everything and left. As he was leaving, he met Petya and told him that there had been three cubes in the room and that he needed another n unit cubes to make his own large cube.Petya entered the room and saw the messily scattered cubes. He wanted to make it neat and orderly again. But he only knows that there had been three cubes, made of small unit cubes and that Vitaly needed n more unit cubes to make a large one! Help Petya understand, how many ways of sizes a, b, c are there to restore Yaroslav\'s, Andrey\'s and Roman\'s cubes." 2400.0     
                                           292B "Network Topology" graphs,implementation "This problem uses a simplified network topology model, please read the problem statement carefully and use it as a formal document as you develop the solution.Polycarpus continues working as a system administrator in a large corporation. The computer network of this corporation consists of n computers, some of them are connected by a cable. The computers are indexed by integers from 1 to n. It\'s known that any two computers connected by cable directly or through other computersPolycarpus decided to find out the network\'s topology. A network topology is the way of describing the network configuration, the scheme that shows the location and the connections of network devices.Polycarpus knows three main network topologies: bus, ring and star. A bus is the topology that represents a shared cable with all computers connected with it. In the ring topology the cable connects each computer only with two other ones. A star is the topology where all computers of a network are connected to the single central node.Let\'s represent each of these network topologies as a connected non-directed graph. A bus is a connected graph that is the only path, that is, the graph where all nodes are connected with two other ones except for some two nodes that are the beginning and the end of the path. A ring is a connected graph, where all nodes are connected with two other ones. A star is a connected graph, where a single central node is singled out and connected with all other nodes. For clarifications, see the picture.  (1) \xe2\x80\x94 bus, (2) \xe2\x80\x94 ring, (3) \xe2\x80\x94 star You\'ve got a connected non-directed graph that characterizes the computer network in Polycarpus\' corporation. Help him find out, which topology type the given network is. If that is impossible to do, say that the network\'s topology is unknown." 1200.0     
                                           290F "Greedy Petya" "*special problem,dfs and similar,graphs,greedy" "Petya is an unexperienced programming contestant. Recently he has come across the following problem:You are given a non-directed graph which consists of n nodes and m edges. Your task is to determine whether the graph contains a Hamiltonian path.Petya wrote a quick bug-free code which he believes solves this problem. After that Petya decided to give this problem for April Fools Day contest. Unfortunately, Petya might have made a mistake, and it\'s quite possible that his algorithm is wrong. But this isn\'t a good excuse to leave the contest without submitting this problem, is it?" 2800.0     
                                           288A "Polo the Penguin and Strings" greedy "Little penguin Polo adores strings. But most of all he adores strings of length n.One day he wanted to find a string that meets the following conditions:  The string consists of n lowercase English letters (that is, the string\'s length equals n), exactly k of these letters are distinct.  No two neighbouring letters of a string coincide; that is, if we represent a string as s\xe2\x80\x89=\xe2\x80\x89s1s2... sn, then the following inequality holds, si\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x891(1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n).  Among all strings that meet points 1 and 2, the required string is lexicographically smallest. Help him find such string or state that such string doesn\'t exist.String x\xe2\x80\x89=\xe2\x80\x89x1x2... xp is lexicographically less than string y\xe2\x80\x89=\xe2\x80\x89y1y2... yq, if either p\xe2\x80\x89<\xe2\x80\x89q and x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xp\xe2\x80\x89=\xe2\x80\x89yp, or there is such number r (r\xe2\x80\x89<\xe2\x80\x89p,\xe2\x80\x89r\xe2\x80\x89<\xe2\x80\x89q), that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xr\xe2\x80\x89=\xe2\x80\x89yr and xr\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89yr\xe2\x80\x89+\xe2\x80\x891. The characters of the strings are compared by their ASCII codes." 1300.0     
                                           287A "IQ Test" "brute force,implementation" "In the city of Ultima Thule job applicants are often offered an IQ test. The test is as follows: the person gets a piece of squared paper with a 4\xe2\x80\x89\xc3\x97\xe2\x80\x894 square painted on it. Some of the square\'s cells are painted black and others are painted white. Your task is to repaint at most one cell the other color so that the picture has a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, completely consisting of cells of the same color. If the initial picture already has such a square, the person should just say so and the test will be completed. Your task is to write a program that determines whether it is possible to pass the test. You cannot pass the test if either repainting any cell or no action doesn\'t result in a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, consisting of cells of the same color." 1100.0     
                                           286D Tourists "data structures,sortings" "A double tourist path, located at a park in Ultima Thule, is working by the following principle:  We introduce the Cartesian coordinate system.  At some points of time there are two tourists going (for a walk) from points (\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890) and (1,\xe2\x80\x890) simultaneously. The first one is walking from (\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890), the second one is walking from (1,\xe2\x80\x890).  Both tourists in a pair move at the same speed 1 (distance unit per second), the first one moves along line x\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891, the second one moves along line x\xe2\x80\x89=\xe2\x80\x891, both of them are moving in the positive direction of the Oy axis.  At some points of time walls appear. Wall (li,\xe2\x80\x89ri) is a segment between points (0,\xe2\x80\x89li) and (0,\xe2\x80\x89ri). Each wall appears immediately. The Ultima Thule government wants to learn this for each pair of tourists that walk simultaneously: for how long (in seconds) will they not see each other? Two tourists don\'t see each other if the segment that connects their positions on the plane intersects at least one wall. Two segments intersect if they share at least one point. We assume that the segments\' ends belong to the segments.Help the government count the required time. Note that the walls can intersect (in any way) or coincide." 2600.0     
                                           285E "Positions in Permutations" combinatorics,dp,math "Permutation p is an ordered set of integers p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers, each of them doesn\'t exceed n. We\'ll denote the i-th element of permutation p as pi. We\'ll call number n the size or the length of permutation p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn.We\'ll call position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) in permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn good, if |p[i]\xe2\x80\x89-\xe2\x80\x89i|\xe2\x80\x89=\xe2\x80\x891. Count the number of permutations of size n with exactly k good positions. Print the answer modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2600.0     
                                           282D "Yet Another Number Game" dp,games "Since most contestants do not read this part, I have to repeat that Bitlandians are quite weird. They have their own jobs, their own working method, their own lives, their own sausages and their own games!Since you are so curious about Bitland, I\'ll give you the chance of peeking at one of these games.BitLGM and BitAryo are playing yet another of their crazy-looking genius-needed Bitlandish games. They\'ve got a sequence of n non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. The players make moves in turns. BitLGM moves first. Each player can and must do one of the two following actions in his turn:  Take one of the integers (we\'ll denote it as ai). Choose integer x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai). And then decrease ai by x, that is, apply assignment: ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x89x.  Choose integer x . And then decrease all ai by x, that is, apply assignment: ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x89x, for all i. The player who cannot make a move loses.You\'re given the initial sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Determine who wins, if both players plays optimally well and if BitLGM and BitAryo start playing the described game in this sequence." 2100.0     
                                           279E "Beautiful Decomposition" "dp,games,greedy,number theory" "Valera considers a number beautiful, if it equals 2k or -2k for some integer k (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890). Recently, the math teacher asked Valera to represent number n as the sum of beautiful numbers. As Valera is really greedy, he wants to complete the task using as few beautiful numbers as possible. Help Valera and find, how many numbers he is going to need. In other words, if you look at all decompositions of the number n into beautiful summands, you need to find the size of the decomposition which has the fewest summands." 1900.0     
                                           277E "Binary Tree on Plane" flows,trees "A root tree is a directed acyclic graph that contains one node (root), from which there is exactly one path to any other node.A root tree is binary if each node has at most two outgoing arcs.When a binary tree is painted on the plane, all arcs should be directed from top to bottom. That is, each arc going from u to v must meet the condition yu\xe2\x80\x89>\xe2\x80\x89yv.You\'ve been given the coordinates of all tree nodes. Your task is to connect these nodes by arcs so as to get the binary root tree and make the total length of the arcs minimum. All arcs of the built tree must be directed from top to bottom." 2400.0     
                                           276C "Little Girl and Maximum Sum" "data structures,greedy,implementation,sortings" "The little girl loves the problems on array queries very much.One day she came across a rather well-known problem: you\'ve got an array of n elements (the elements of the array are indexed starting from 1); also, there are q queries, each one is defined by a pair of integers li, ri (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n). You need to find for each query the sum of elements of the array with indexes from li to ri, inclusive.The little girl found the problem rather boring. She decided to reorder the array elements before replying to the queries in a way that makes the sum of query replies maximum possible. Your task is to find the value of this maximum sum." 1500.0     
                                           272E "Dima and Horses" "combinatorics,constructive algorithms,graphs" "Dima came to the horse land. There are n horses living in the land. Each horse in the horse land has several enemies (enmity is a symmetric relationship). The horse land isn\'t very hostile, so the number of enemies of each horse is at most 3.Right now the horse land is going through an election campaign. So the horses trusted Dima to split them into two parts. At that the horses want the following condition to hold: a horse shouldn\'t have more than one enemy in its party.Help Dima split the horses into parties. Note that one of the parties can turn out to be empty." 2200.0     
                                           271A "Beautiful Year" "brute force" "It seems like the year of 2013 came only yesterday. Do you know a curious fact? The year of 2013 is the first year after the old 1987 with only distinct digits.Now you are suggested to solve the following problem: given a year number, find the minimum year number which is strictly larger than the given one and has only distinct digits." 800.0     
                                           270A "Fancy Fence" geometry,implementation,math "Emuskald needs a fence around his farm, but he is too lazy to build it himself. So he purchased a fence-building robot.He wants the fence to be a regular polygon. The robot builds the fence along a single path, but it can only make fence corners at a single angle a.Will the robot be able to build the fence Emuskald wants? In other words, is there a regular polygon which angles are equal to a?" 1100.0     
                                           266D BerDonalds "graphs,math,shortest paths" "BerDonalds, a well-known fast food restaurant, is going to open a cafe in Bertown. The important thing is to choose the new restaurant\'s location so that it would be easy to get there. The Bertown road system is represented by n junctions, connected by m bidirectional roads. For each road we know its length. We also know that we can get from any junction to any other one, moving along the roads.Your task is to find such location of the restaurant, that the shortest distance along the roads from the cafe to the farthest junction would be minimum. Note that the restaurant can be located not only on the junction, but at any point of any road." 2400.0     
                                           266C "Below the Diagonal" "constructive algorithms,greedy,math" "You are given a square matrix consisting of n rows and n columns. We assume that the rows are numbered from 1 to n from top to bottom and the columns are numbered from 1 to n from left to right. Some cells (n\xe2\x80\x89-\xe2\x80\x891 cells in total) of the the matrix are filled with ones, the remaining cells are filled with zeros. We can apply the following operations to the matrix:  Swap i-th and j-th rows of the matrix;  Swap i-th and j-th columns of the matrix. You are asked to transform the matrix into a special form using these operations. In that special form all the ones must be in the cells that lie below the main diagonal. Cell of the matrix, which is located on the intersection of the i-th row and of the j-th column, lies below the main diagonal if i\xe2\x80\x89>\xe2\x80\x89j." 2100.0     
                                           262A "Roma and Lucky Numbers" implementation "Roma (a popular Russian name that means \'Roman\') loves the Little Lvov Elephant\'s lucky numbers.Let us remind you that lucky numbers are positive integers whose decimal representation only contains lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Roma\'s got n positive integers. He wonders, how many of those integers have not more than k lucky digits? Help him, write the program that solves the problem." 800.0     
                                           261D "Maxim and Increasing Subsequence" dp "Maxim loves sequences, especially those that strictly increase. He is wondering, what is the length of the longest increasing subsequence of the given sequence a?Sequence a is given as follows:   the length of the sequence equals n\xe2\x80\x89\xc3\x97\xe2\x80\x89t;   (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xc3\x97\xe2\x80\x89t), where operation  means taking the remainder after dividing number x by number y. Sequence s1,\xe2\x80\x89\xe2\x80\x89s2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89sr of length r is a subsequence of sequence a1,\xe2\x80\x89\xe2\x80\x89a2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89an, if there is such increasing sequence of indexes i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ir (1\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89i1\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89i2\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89... \xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89ir\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89n), that aij\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89sj. In other words, the subsequence can be obtained from the sequence by crossing out some elements.Sequence s1,\xe2\x80\x89\xe2\x80\x89s2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89sr is increasing, if the following inequality holds: s1\xe2\x80\x89<\xe2\x80\x89s2\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89sr.Maxim have k variants of the sequence a. Help Maxim to determine for each sequence the length of the longest increasing subsequence." 2600.0     
                                           261B "Maxim and Restaurant" dp,math,probabilities "Maxim has opened his own restaurant! The restaurant has got a huge table, the table\'s length is p meters.Maxim has got a dinner party tonight, n guests will come to him. Let\'s index the guests of Maxim\'s restaurant from 1 to n. Maxim knows the sizes of all guests that are going to come to him. The i-th guest\'s size (ai) represents the number of meters the guest is going to take up if he sits at the restaurant table.Long before the dinner, the guests line up in a queue in front of the restaurant in some order. Then Maxim lets the guests in, one by one. Maxim stops letting the guests in when there is no place at the restaurant table for another guest in the queue. There is no place at the restaurant table for another guest in the queue, if the sum of sizes of all guests in the restaurant plus the size of this guest from the queue is larger than p. In this case, not to offend the guest who has no place at the table, Maxim doesn\'t let any other guest in the restaurant, even if one of the following guests in the queue would have fit in at the table.Maxim is now wondering, what is the average number of visitors who have come to the restaurant for all possible n! orders of guests in the queue. Help Maxim, calculate this number." 1900.0     
                                           258D "Little Elephant and Broken Sorting" dp,math,probabilities "The Little Elephant loves permutations of integers from 1 to n very much. But most of all he loves sorting them. To sort a permutation, the Little Elephant repeatedly swaps some elements. As a result, he must receive a permutation 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n.This time the Little Elephant has permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. Its sorting program needs to make exactly m moves, during the i-th move it swaps elements that are at that moment located at the ai-th and the bi-th positions. But the Little Elephant\'s sorting program happened to break down and now on every step it can equiprobably either do nothing or swap the required elements.Now the Little Elephant doesn\'t even hope that the program will sort the permutation, but he still wonders: if he runs the program and gets some permutation, how much will the result of sorting resemble the sorted one? For that help the Little Elephant find the mathematical expectation of the number of permutation inversions after all moves of the program are completed.We\'ll call a pair of integers i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) an inversion in permutatuon p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, if the following inequality holds: pi\xe2\x80\x89>\xe2\x80\x89pj." 2600.0     
                                           257E "Greedy Elevator" "data structures,implementation" "The m-floor (m\xe2\x80\x89>\xe2\x80\x891) office of international corporation CodeForces has the advanced elevator control system established. It works as follows.All office floors are sequentially numbered with integers from 1 to m. At time t\xe2\x80\x89=\xe2\x80\x890, the elevator is on the first floor, the elevator is empty and nobody is waiting for the elevator on other floors. Next, at times ti (ti\xe2\x80\x89>\xe2\x80\x890) people come to the elevator. For simplicity, we assume that one person uses the elevator only once during the reported interval. For every person we know three parameters: the time at which the person comes to the elevator, the floor on which the person is initially, and the floor to which he wants to go.The movement of the elevator between the floors is as follows. At time t (t\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890, t is an integer) the elevator is always at some floor. First the elevator releases all people who are in the elevator and want to get to the current floor. Then it lets in all the people waiting for the elevator on this floor. If a person comes to the elevator exactly at time t, then he has enough time to get into it. We can assume that all of these actions (going in or out from the elevator) are made instantly. After that the elevator decides, which way to move and at time (t\xe2\x80\x89+\xe2\x80\x891) the elevator gets to the selected floor.The elevator selects the direction of moving by the following algorithm.   If the elevator is empty and at the current time no one is waiting for the elevator on any floor, then the elevator remains at the current floor.  Otherwise, let\'s assume that the elevator is on the floor number x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Then elevator calculates the directions\' ""priorities"" pup and pdown: pup is the sum of the number of people waiting for the elevator on the floors with numbers greater than x, and the number of people in the elevator, who want to get to the floors with the numbers greater than x; pdown is the sum of the number of people waiting for the elevator on the floors with numbers less than x, and the number of people in the elevator, who want to get to the floors with the numbers less than x. If pup\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89pdown, then the elevator goes one floor above the current one (that is, from floor x to floor x\xe2\x80\x89+\xe2\x80\x891), otherwise the elevator goes one floor below the current one (that is, from floor x to floor x\xe2\x80\x89-\xe2\x80\x891). Your task is to simulate the work of the elevator and for each person to tell the time when the elevator will get to the floor this person needs. Please note that the elevator is large enough to accommodate all the people at once." 2200.0     
                                           256D "Liars and Serge" dp "There are n people, sitting in a line at the table. For each person we know that he always tells either the truth or lies.Little Serge asked them: how many of you always tell the truth? Each of the people at the table knows everything (who is an honest person and who is a liar) about all the people at the table. The honest people are going to say the correct answer, the liars are going to say any integer from 1 to n, which is not the correct answer. Every liar chooses his answer, regardless of the other liars, so two distinct liars may give distinct answer.Serge does not know any information about the people besides their answers to his question. He took a piece of paper and wrote n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is the answer of the i-th person in the row. Given this sequence, Serge determined that exactly k people sitting at the table apparently lie.Serge wonders, how many variants of people\'s answers (sequences of answers a of length n) there are where one can say that exactly k people sitting at the table apparently lie. As there can be rather many described variants of answers, count the remainder of dividing the number of the variants by 777777777." 2700.0     
                                           255E "Furlo and Rublo and Game" games,implementation,math "Furlo and Rublo play a game. The table has n piles of coins lying on it, the i-th pile has ai coins. Furlo and Rublo move in turns, Furlo moves first. In one move you are allowed to:  choose some pile, let\'s denote the current number of coins in it as x;  choose some integer y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89<\xe2\x80\x89x; x1\xe2\x80\x89/\xe2\x80\x894\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1\xe2\x80\x89/\xe2\x80\x892) and decrease the number of coins in this pile to y. In other words, after the described move the pile will have y coins left. The player who can\'t make a move, loses. Your task is to find out, who wins in the given game if both Furlo and Rublo play optimally well." 2200.0     
                                           255C "Almost Arithmetical Progression" "brute force,dp" "Gena loves sequences of numbers. Recently, he has discovered a new type of sequences which he called an almost arithmetical progression. A sequence is an almost arithmetical progression, if its elements can be represented as:  a1\xe2\x80\x89=\xe2\x80\x89p, where p is some integer;  ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891)i\xe2\x80\x89+\xe2\x80\x891\xc2\xb7q (i\xe2\x80\x89>\xe2\x80\x891), where q is some integer. Right now Gena has a piece of paper with sequence b, consisting of n integers. Help Gena, find there the longest subsequence of integers that is an almost arithmetical progression.Sequence s1,\xe2\x80\x89\xe2\x80\x89s2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89sk is a subsequence of sequence b1,\xe2\x80\x89\xe2\x80\x89b2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89bn, if there is such increasing sequence of indexes i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ik (1\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89i1\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89i2\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89... \xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89ik\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89n), that bij\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89sj. In other words, sequence s can be obtained from b by crossing out some elements." 1500.0     
                                           252A "Little Xor" "brute force,implementation" "Little Petya likes arrays that consist of non-negative integers a lot. Recently his mom has presented him one such array consisting of n elements. Petya immediately decided to find there a segment of consecutive elements, such that the xor of all numbers from this segment was maximal possible. Help him with that.The xor operation is the bitwise exclusive ""OR"", that is denoted as ""xor"" in Pascal and ""^"" in C/C++/Java." 1100.0     
                                           249D "Donkey and Stars" "data structures,dp,geometry,math,sortings" "In the evenings Donkey would join Shrek to look at the stars. They would sit on a log, sipping tea and they would watch the starry sky. The sky hung above the roof, right behind the chimney. Shrek\'s stars were to the right of the chimney and the Donkey\'s stars were to the left. Most days the Donkey would just count the stars, so he knew that they are exactly n. This time he wanted a challenge. He imagined a coordinate system: he put the origin of the coordinates at the intersection of the roof and the chimney, directed the OX axis to the left along the roof and the OY axis \xe2\x80\x94 up along the chimney (see figure). The Donkey imagined two rays emanating from he origin of axes at angles \xce\xb11 and \xce\xb12 to the OX axis.  Now he chooses any star that lies strictly between these rays. After that he imagines more rays that emanate from this star at the same angles \xce\xb11 and \xce\xb12 to the OX axis and chooses another star that lies strictly between the new rays. He repeats the operation as long as there still are stars he can choose between the rays that emanate from a star.   As a result, the Donkey gets a chain of stars. He can consecutively get to each star if he acts by the given rules.Your task is to find the maximum number of stars m that the Donkey\'s chain can contain.Note that the chain must necessarily start in the point of the origin of the axes, that isn\'t taken into consideration while counting the number m of stars in the chain." 2700.0     
                                           248D "Sweets for Everyone!" "binary search,greedy,implementation" "For he knew every Who down in Whoville beneath, Was busy now, hanging a mistletoe wreath. ""And they\'re hanging their stockings!"" he snarled with a sneer, ""Tomorrow is Christmas! It\'s practically here!""Dr. Suess, How The Grinch Stole ChristmasChristmas celebrations are coming to Whoville. Cindy Lou Who and her parents Lou Lou Who and Betty Lou Who decided to give sweets to all people in their street. They decided to give the residents of each house on the street, one kilogram of sweets. So they need as many kilos of sweets as there are homes on their street.The street, where the Lou Who family lives can be represented as n consecutive sections of equal length. You can go from any section to a neighbouring one in one unit of time. Each of the sections is one of three types: an empty piece of land, a house or a shop. Cindy Lou and her family can buy sweets in a shop, but no more than one kilogram of sweets in one shop (the vendors care about the residents of Whoville not to overeat on sweets).After the Lou Who family leave their home, they will be on the first section of the road. To get to this section of the road, they also require one unit of time. We can assume that Cindy and her mom and dad can carry an unlimited number of kilograms of sweets. Every time they are on a house section, they can give a kilogram of sweets to the inhabitants of the house, or they can simply move to another section. If the family have already given sweets to the residents of a house, they can\'t do it again. Similarly, if they are on the shop section, they can either buy a kilo of sweets in it or skip this shop. If they\'ve bought a kilo of sweets in a shop, the seller of the shop remembered them and the won\'t sell them a single candy if they come again. The time to buy and give sweets can be neglected. The Lou Whos do not want the people of any house to remain without food.The Lou Whos want to spend no more than t time units of time to give out sweets, as they really want to have enough time to prepare for the Christmas celebration. In order to have time to give all the sweets, they may have to initially bring additional k kilos of sweets.Cindy Lou wants to know the minimum number of k kilos of sweets they need to take with them, to have time to give sweets to the residents of each house in their street.Your task is to write a program that will determine the minimum possible value of k." 2300.0     
                                           245C "Game with Coins" greedy "Two pirates Polycarpus and Vasily play a very interesting game. They have n chests with coins, the chests are numbered with integers from 1 to n. Chest number i has ai coins. Polycarpus and Vasily move in turns. Polycarpus moves first. During a move a player is allowed to choose a positive integer x (2\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and take a coin from each chest with numbers x, 2\xc2\xb7x, 2\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891. It may turn out that some chest has no coins, in this case the player doesn\'t take a coin from this chest. The game finishes when all chests get emptied.Polycarpus isn\'t a greedy scrooge. Polycarpys is a lazy slob. So he wonders in what minimum number of moves the game can finish. Help Polycarpus, determine the minimum number of moves in which the game can finish. Note that Polycarpus counts not only his moves, he also counts Vasily\'s moves." 1700.0     
                                           242E "XOR on Segment" "bitmasks,data structures" "You\'ve got an array a, consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You are allowed to perform two operations on this array:  Calculate the sum of current array elements on the segment [l,\xe2\x80\x89r], that is, count value al\xe2\x80\x89+\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ar.  Apply the xor operation with a given number x to each array element on the segment [l,\xe2\x80\x89r], that is, execute . This operation changes exactly r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 array elements. Expression  means applying bitwise xor operation to numbers x and y. The given operation exists in all modern programming languages, for example in language C++ and Java it is marked as ""^"", in Pascal \xe2\x80\x94 as ""xor"".You\'ve got a list of m operations of the indicated type. Your task is to perform all given operations, for each sum query you should print the result you get." 2000.0     
                                           242B "Big Segment" implementation,sortings "A coordinate line has n segments, the i-th segment starts at the position li and ends at the position ri. We will denote such a segment as [li,\xe2\x80\x89ri].You have suggested that one of the defined segments covers all others. In other words, there is such segment in the given set, which contains all other ones. Now you want to test your assumption. Find in the given set the segment which covers all other segments, and print its number. If such a segment doesn\'t exist, print -1.Formally we will assume that segment [a,\xe2\x80\x89b] covers segment [c,\xe2\x80\x89d], if they meet this condition a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b." 1100.0     
                                           241D Numbers  "You have a sequence of n distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). You want to remove some integers in such a way that the resulting sequence of integers satisfies the following three conditions:  the resulting sequence is not empty;  the exclusive or (xor operation) of all the integers in the resulting sequence equals 0;  if you write all the integers of the resulting sequence (from beginning to the end) in a row in the decimal numeral system and without any spaces, the written number is divisible by p. You are given the sequence of n integers a and a prime number p, find a way to satisfy the described conditions." 2900.0     
                                           238A "Not Wool Sequences" "constructive algorithms,math" "A sequence of non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of length n is called a wool sequence if and only if there exists two integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that . In other words each wool sequence contains a subsequence of consecutive elements with xor equal to 0.The expression  means applying the operation of a bitwise xor to numbers x and y. The given operation exists in all modern programming languages, for example, in languages C++ and Java it is marked as ""^"", in Pascal \xe2\x80\x94 as ""xor"".In this problem you are asked to compute the number of sequences made of n integers from 0 to 2m\xe2\x80\x89-\xe2\x80\x891 that are not a wool sequence. You should print this number modulo 1000000009 (109\xe2\x80\x89+\xe2\x80\x899)." 1300.0     
                                           232B Table bitmasks,combinatorics,dp,math "John Doe has an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table. John Doe can paint points in some table cells, not more than one point in one table cell. John Doe wants to use such operations to make each square subtable of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n have exactly k points.John Doe wondered, how many distinct ways to fill the table with points are there, provided that the condition must hold. As this number can be rather large, John Doe asks to find its remainder after dividing by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).You should assume that John always paints a point exactly in the center of some cell. Two ways to fill a table are considered distinct, if there exists a table cell, that has a point in one way and doesn\'t have it in the other." 1900.0     
                                           230B T-primes "binary search,implementation,math,number theory" "We know that prime numbers are positive integers that have exactly two distinct positive divisors. Similarly, we\'ll call a positive integer t \xd0\xa2-prime, if t has exactly three distinct positive divisors.You are given an array of n positive integers. For each of them determine whether it is \xd0\xa2-prime or not." 1300.0     
                                           225C Barcode dp,matrices "You\'ve got an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m pixel picture. Each pixel can be white or black. Your task is to change the colors of as few pixels as possible to obtain a barcode picture.A picture is a barcode if the following conditions are fulfilled:   All pixels in each column are of the same color.  The width of each monochrome vertical line is at least x and at most y pixels. In other words, if we group all neighbouring columns of the pixels with equal color, the size of each group can not be less than x or greater than y." 1700.0     
                                           223B "Two Strings" "data structures,dp,strings" "A subsequence of length |x| of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (where |s| is the length of string s) is a string x\xe2\x80\x89=\xe2\x80\x89sk1sk2... sk|x| (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k1\xe2\x80\x89<\xe2\x80\x89k2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89k|x|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|).You\'ve got two strings \xe2\x80\x94 s and t. Let\'s consider all subsequences of string s, coinciding with string t. Is it true that each character of string s occurs in at least one of these subsequences? In other words, is it true that for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|), there is such subsequence x\xe2\x80\x89=\xe2\x80\x89sk1sk2... sk|x| of string s, that x\xe2\x80\x89=\xe2\x80\x89t and for some j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|x|) kj\xe2\x80\x89=\xe2\x80\x89i." 1900.0     
                                           223A "Bracket Sequence" "data structures,expression parsing,implementation" "A bracket sequence is a string, containing only characters ""("", "")"", ""["" and ""]"".A correct bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, bracket sequences ""()[]"", ""([])"" are correct (the resulting expressions are: ""(1)+[1]"", ""([1+1]+1)""), and ""]("" and ""["" are not. The empty string is a correct bracket sequence by definition.A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (where |s| is the length of string s) is the string slsl\xe2\x80\x89+\xe2\x80\x891... sr. The empty string is a substring of any string by definition.You are given a bracket sequence, not necessarily correct. Find its substring which is a correct bracket sequence and contains as many opening square brackets \xc2\xab[\xc2\xbb as possible." 1700.0     
                                           219E "Parking Lot" "data structures" "A parking lot in the City consists of n parking spaces, standing in a line. The parking spaces are numbered from 1 to n from left to right. When a car arrives at the lot, the operator determines an empty parking space for it. For the safety\'s sake the chosen place should be located as far from the already occupied places as possible. That is, the closest occupied parking space must be as far away as possible. If there are several such places, then the operator chooses the place with the minimum index from them. If all parking lot places are empty, then the car gets place number 1.We consider the distance between the i-th and the j-th parking spaces equal to 4\xc2\xb7|i\xe2\x80\x89-\xe2\x80\x89j| meters.You are given the parking lot records of arriving and departing cars in the chronological order. For each record of an arriving car print the number of the parking lot that was given to this car." 2200.0     
                                           219B "Special Offer! Super Price 999 Bourles!" implementation "Polycarpus is an amateur businessman. Recently he was surprised to find out that the market for paper scissors is completely free! Without further ado, Polycarpus decided to start producing and selling such scissors.Polycaprus calculated that the optimal celling price for such scissors would be p bourles. However, he read somewhere that customers are attracted by prices that say something like ""Special Offer! Super price 999 bourles!"". So Polycarpus decided to lower the price a little if it leads to the desired effect.Polycarpus agrees to lower the price by no more than d bourles so that the number of nines at the end of the resulting price is maximum. If there are several ways to do it, he chooses the maximum possible price.Note, Polycarpus counts only the trailing nines in a price." 1400.0     
                                           217A "Ice Skating" "brute force,dfs and similar,dsu,graphs" "Bajtek is learning to skate on ice. He\'s a beginner, so his only mode of transportation is pushing off from a snow drift to the north, east, south or west and sliding until he lands in another snow drift. He has noticed that in this way it\'s impossible to get from some snow drifts to some other by any sequence of moves. He now wants to heap up some additional snow drifts, so that he can get from any snow drift to any other one. He asked you to find the minimal number of snow drifts that need to be created.We assume that Bajtek can only heap up snow drifts at integer coordinates." 1200.0     
                                           216E "Martian Luck" "math,number theory" "You know that the Martians use a number system with base k. Digit b (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89k) is considered lucky, as the first contact between the Martians and the Earthlings occurred in year b (by Martian chronology).A digital root d(x) of number x is a number that consists of a single digit, resulting after cascading summing of all digits of number x. Word ""cascading"" means that if the first summing gives us a number that consists of several digits, then we sum up all digits again, and again, until we get a one digit number.For example, d(35047)\xe2\x80\x89=\xe2\x80\x89d((3\xe2\x80\x89+\xe2\x80\x895\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x894)7)\xe2\x80\x89=\xe2\x80\x89d(157)\xe2\x80\x89=\xe2\x80\x89d((1\xe2\x80\x89+\xe2\x80\x895)7)\xe2\x80\x89=\xe2\x80\x89d(67)\xe2\x80\x89=\xe2\x80\x8967. In this sample the calculations are performed in the 7-base notation.If a number\'s digital root equals b, the Martians also call this number lucky.You have string s, which consists of n digits in the k-base notation system. Your task is to find, how many distinct substrings of the given string are lucky numbers. Leading zeroes are permitted in the numbers.Note that substring s[i... j] of the string s\xe2\x80\x89=\xe2\x80\x89a1a2... an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is the string aiai\xe2\x80\x89+\xe2\x80\x891... aj. Two substrings s[i1... j1] and s[i2... j2] of the string s are different if either i1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i2 or j1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j2." 2000.0     
                                           213A Game "dfs and similar,greedy" "Furik and Rubik love playing computer games. Furik has recently found a new game that greatly interested Rubik. The game consists of n parts and to complete each part a player may probably need to complete some other ones. We know that the game can be fully completed, that is, its parts do not form cyclic dependencies. Rubik has 3 computers, on which he can play this game. All computers are located in different houses. Besides, it has turned out that each part of the game can be completed only on one of these computers. Let\'s number the computers with integers from 1 to 3. Rubik can perform the following actions:   Complete some part of the game on some computer. Rubik spends exactly 1 hour on completing any part on any computer.  Move from the 1-st computer to the 2-nd one. Rubik spends exactly 1 hour on that.  Move from the 1-st computer to the 3-rd one. Rubik spends exactly 2 hours on that.  Move from the 2-nd computer to the 1-st one. Rubik spends exactly 2 hours on that.  Move from the 2-nd computer to the 3-rd one. Rubik spends exactly 1 hour on that.  Move from the 3-rd computer to the 1-st one. Rubik spends exactly 1 hour on that.  Move from the 3-rd computer to the 2-nd one. Rubik spends exactly 2 hours on that. Help Rubik to find the minimum number of hours he will need to complete all parts of the game. Initially Rubik can be located at the computer he considers necessary." 1700.0     
                                           212C Cowboys combinatorics,dp,math "A very tense moment: n cowboys stand in a circle and each one points his colt at a neighbor. Each cowboy can point the colt to the person who follows or precedes him in clockwise direction. Human life is worthless, just like in any real western.The picture changes each second! Every second the cowboys analyse the situation and, if a pair of cowboys realize that they aim at each other, they turn around. In a second all such pairs of neighboring cowboys aiming at each other turn around. All actions happen instantaneously and simultaneously in a second.We\'ll use character ""A"" to denote a cowboy who aims at his neighbour in the clockwise direction, and character ""B"" for a cowboy who aims at his neighbour in the counter clockwise direction. Then a string of letters ""A"" and ""B"" will denote the circle of cowboys, the record is made from the first of them in a clockwise direction.For example, a circle that looks like ""ABBBABBBA"" after a second transforms into ""BABBBABBA"" and a circle that looks like ""BABBA"" transforms into ""ABABB"".   This picture illustrates how the circle ""BABBA"" transforms into ""ABABB""  A second passed and now the cowboys\' position is described by string s. Your task is to determine the number of possible states that lead to s in a second. Two states are considered distinct if there is a cowboy who aims at his clockwise neighbor in one state and at his counter clockwise neighbor in the other state." 2100.0     
                                           209C "Trails and Glades" "constructive algorithms,dsu,graphs,greedy" "Vasya went for a walk in the park. The park has n glades, numbered from 1 to n. There are m trails between the glades. The trails are numbered from 1 to m, where the i-th trail connects glades xi and yi. The numbers of the connected glades may be the same (xi\xe2\x80\x89=\xe2\x80\x89yi), which means that a trail connects a glade to itself. Also, two glades may have several non-intersecting trails between them.Vasya is on glade 1, he wants to walk on all trails of the park exactly once, so that he can eventually return to glade 1. Unfortunately, Vasya does not know whether this walk is possible or not. Help Vasya, determine whether the walk is possible or not. If such walk is impossible, find the minimum number of trails the authorities need to add to the park in order to make the described walk possible.Vasya can shift from one trail to another one only on glades. He can move on the trails in both directions. If Vasya started going on the trail that connects glades a and b, from glade a, then he must finish this trail on glade b." 2400.0     
                                           207D5 "The Beaver\'s Problem - 3"  "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 1600.0     
                                           207C1 "Game with Two Trees"  "The Smart Beaver from ABBYY has come up with a new developing game for children. The Beaver thinks that this game will help children to understand programming better.The main object of the game is finite rooted trees, each of their edges contains some lowercase English letter. Vertices on any tree are always numbered sequentially from 1 to m, where m is the number of vertices in the tree. Before describing the actual game, let\'s introduce some definitions.We\'ll assume that the sequence of vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a forward path, if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is a direct ancestor of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all letters from the the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to forward path v1, v2, ..., vk.We\'ll assume that the sequence of tree vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a backward path if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is the direct descendant of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all the letters from the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to backward path v1, v2, ..., vk.Now let\'s describe the game that the Smart Beaver from ABBYY has come up with. The game uses two rooted trees, each of which initially consists of one vertex with number 1. The player is given some sequence of operations. Each operation is characterized by three values (t, v, c) where:   t is the number of the tree on which the operation is executed (1 or 2);  v is the vertex index in this tree (it is guaranteed that the tree contains a vertex with this index);  c is a lowercase English letter. The actual operation is as follows: vertex v of tree t gets a new descendant with number m\xe2\x80\x89+\xe2\x80\x891 (where m is the current number of vertices in tree t), and there should be letter c put on the new edge from vertex v to vertex m\xe2\x80\x89+\xe2\x80\x891.We\'ll say that an ordered group of three integers (i, j, q) is a good combination if:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m1, where m1 is the number of vertices in the first tree;  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j,\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m2, where m2 is the number of vertices in the second tree;  there exists a forward path v1, v2, ..., vk such that v1\xe2\x80\x89=\xe2\x80\x89j and vk\xe2\x80\x89=\xe2\x80\x89q in the second tree;  the string that corresponds to the forward path in the second tree from vertex j to vertex q equals the string that corresponds to the backward path in the first tree from vertex i to vertex 1 (note that both paths are determined uniquely). Your task is to calculate the number of existing good combinations after each operation on the trees." 2100.0     
                                           203C Photographer greedy,sortings "Valera\'s lifelong ambition was to be a photographer, so he bought a new camera. Every day he got more and more clients asking for photos, and one day Valera needed a program that would determine the maximum number of people he can serve.The camera\'s memory is d megabytes. Valera\'s camera can take photos of high and low quality. One low quality photo takes a megabytes of memory, one high quality photo take b megabytes of memory. For unknown reasons, each client asks him to make several low quality photos and several high quality photos. More formally, the i-th client asks to make xi low quality photos and yi high quality photos.Valera wants to serve as many clients per day as possible, provided that they will be pleased with his work. To please the i-th client, Valera needs to give him everything he wants, that is, to make xi low quality photos and yi high quality photos. To make one low quality photo, the camera must have at least a megabytes of free memory space. Similarly, to make one high quality photo, the camera must have at least b megabytes of free memory space. Initially the camera\'s memory is empty. Valera also does not delete photos from the camera so that the camera\'s memory gradually fills up.Calculate the maximum number of clients Valera can successfully serve and print the numbers of these clients." 1400.0     
                                           202B "Brand New Easy Problem" "brute force" "A widely known among some people Belarusian sport programmer Lesha decided to make some money to buy a one square meter larger flat. To do this, he wants to make and carry out a Super Rated Match (SRM) on the site Torcoder.com. But there\'s a problem \xe2\x80\x94 a severe torcoder coordinator Ivan does not accept any Lesha\'s problem, calling each of them an offensive word ""duped"" (that is, duplicated). And one day they nearely quarrelled over yet another problem Ivan wouldn\'t accept.You are invited to act as a fair judge and determine whether the problem is indeed brand new, or Ivan is right and the problem bears some resemblance to those used in the previous SRMs.You are given the descriptions of Lesha\'s problem and each of Torcoder.com archive problems. The description of each problem is a sequence of words. Besides, it is guaranteed that Lesha\'s problem has no repeated words, while the description of an archive problem may contain any number of repeated words.The ""similarity"" between Lesha\'s problem and some archive problem can be found as follows. Among all permutations of words in Lesha\'s problem we choose the one that occurs in the archive problem as a subsequence. If there are multiple such permutations, we choose the one with the smallest number of inversions. Then the ""similarity"" of a problem can be written as , where n is the number of words in Lesha\'s problem and x is the number of inversions in the chosen permutation. Note that the ""similarity"" p is always a positive integer.The problem is called brand new if there is not a single problem in Ivan\'s archive which contains a permutation of words from Lesha\'s problem as a subsequence.Help the boys and determine whether the proposed problem is new, or specify the problem from the archive which resembles Lesha\'s problem the most, otherwise." 1700.0     
                                           201C "Fragile Bridges" dp "You are playing a video game and you have just reached the bonus level, where the only possible goal is to score as many points as possible. Being a perfectionist, you\'ve decided that you won\'t leave this level until you\'ve gained the maximum possible number of points there.The bonus level consists of n small platforms placed in a line and numbered from 1 to n from left to right and (n\xe2\x80\x89-\xe2\x80\x891) bridges connecting adjacent platforms. The bridges between the platforms are very fragile, and for each bridge the number of times one can pass this bridge from one of its ends to the other before it collapses forever is known in advance.The player\'s actions are as follows. First, he selects one of the platforms to be the starting position for his hero. After that the player can freely move the hero across the platforms moving by the undestroyed bridges. As soon as the hero finds himself on a platform with no undestroyed bridge attached to it, the level is automatically ended. The number of points scored by the player at the end of the level is calculated as the number of transitions made by the hero between the platforms. Note that if the hero started moving by a certain bridge, he has to continue moving in the same direction until he is on a platform.Find how many points you need to score to be sure that nobody will beat your record, and move to the next level with a quiet heart." 2000.0     
                                                195D "Analyzing Polyline" geometry,math,sortings "As Valeric and Valerko were watching one of the last Euro Championship games in a sports bar, they broke a mug. Of course, the guys paid for it but the barman said that he will let them watch football in his bar only if they help his son complete a programming task. The task goes like that.Let\'s consider a set of functions of the following form:  Let\'s define a sum of n functions y1(x),\xe2\x80\x89...,\xe2\x80\x89yn(x) of the given type as function s(x)\xe2\x80\x89=\xe2\x80\x89y1(x)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89yn(x) for any x. It\'s easy to show that in this case the graph s(x) is a polyline. You are given n functions of the given type, your task is to find the number of angles that do not equal 180 degrees, in the graph s(x), that is the sum of the given functions.Valeric and Valerko really want to watch the next Euro Championship game, so they asked you to help them." 1900.0
                                                194B Square math "There is a square painted on a piece of paper, the square\'s side equals n meters. John Doe draws crosses on the square\'s perimeter. John paints the first cross in the lower left corner of the square. Then John moves along the square\'s perimeter in the clockwise direction (first upwards, then to the right, then downwards, then to the left and so on). Every time he walks (n\xe2\x80\x89+\xe2\x80\x891) meters, he draws a cross (see picture for clarifications).John Doe stops only when the lower left corner of the square has two crosses. How many crosses will John draw?   The figure shows the order in which John draws crosses for a square with side 4. The lower left square has two crosses. Overall John paints 17 crosses." 1200.0
                                                193A "Cutting Figure" "constructive algorithms,graphs,trees" "You\'ve gotten an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m sheet of squared paper. Some of its squares are painted. Let\'s mark the set of all painted squares as A. Set A is connected. Your task is to find the minimum number of squares that we can delete from set A to make it not connected.A set of painted squares is called connected, if for every two squares a and b from this set there is a sequence of squares from the set, beginning in a and ending in b, such that in this sequence any square, except for the last one, shares a common side with the square that follows next in the sequence. An empty set and a set consisting of exactly one square are connected by definition." 1700.0
                                                188F "Binary Notation" "*special problem,implementation" "You are given a positive integer n. Output its binary notation." 1400.0
                                                188D Asterisks "*special problem,implementation" "You are given a number n. Print n lines, i-th line should consist of i characters ""*"". Lines\' indices are 1-based." 1100.0
                                                186A "Comparing Strings" implementation,strings "Some dwarves that are finishing the StUDY (State University for Dwarven Youngsters) Bachelor courses, have been told ""no genome, no degree"". That means that all dwarves should write a thesis on genome. Dwarven genome is far from simple. It is represented by a string that consists of lowercase Latin letters.Dwarf Misha has already chosen the subject for his thesis: determining by two dwarven genomes, whether they belong to the same race. Two dwarves belong to the same race if we can swap two characters in the first dwarf\'s genome and get the second dwarf\'s genome as a result. Help Dwarf Misha and find out whether two gnomes belong to the same race or not." 1100.0
                                                180D Name greedy,strings "Everything got unclear to us in a far away constellation Tau Ceti. Specifically, the Taucetians choose names to their children in a very peculiar manner.Two young parents abac and bbad think what name to give to their first-born child. They decided that the name will be the permutation of letters of string s. To keep up with the neighbours, they decided to call the baby so that the name was lexicographically strictly larger than the neighbour\'s son\'s name t.On the other hand, they suspect that a name tax will be introduced shortly. According to it, the Taucetians with lexicographically larger names will pay larger taxes. That\'s the reason abac and bbad want to call the newborn so that the name was lexicographically strictly larger than name t and lexicographically minimum at that.The lexicographical order of strings is the order we are all used to, the ""dictionary"" order. Such comparison is used in all modern programming languages to compare strings. Formally, a string p of length n is lexicographically less than string q of length m, if one of the two statements is correct:  n\xe2\x80\x89<\xe2\x80\x89m, and p is the beginning (prefix) of string q (for example, ""aba"" is less than string ""abaa""),  p1\xe2\x80\x89=\xe2\x80\x89q1, p2\xe2\x80\x89=\xe2\x80\x89q2, ..., pk\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89qk\xe2\x80\x89-\xe2\x80\x891, pk\xe2\x80\x89<\xe2\x80\x89qk for some k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89min(n,\xe2\x80\x89m)), here characters in strings are numbered starting from 1. Write a program that, given string s and the heighbours\' child\'s name t determines the string that is the result of permutation of letters in s. The string should be lexicographically strictly more than t and also, lexicographically minimum." 1900.0
                                                178C1 "Smart Beaver and Resolving Collisions"  "The Smart Beaver from ABBYY has a lot of hobbies. One of them is constructing efficient hash tables. One of the most serious problems in hash tables is resolving collisions. The Beaver is interested in this problem very much and he decided to explore it in detail.We assume that the hash table consists of h cells numbered from 0 to h\xe2\x80\x89-\xe2\x80\x891. Objects are added to and removed from it. Every object has its own unique identifier. In addition, every object has a corresponding hash value \xe2\x80\x94 an integer between 0 and h\xe2\x80\x89-\xe2\x80\x891, inclusive. When an object is added to the table, if the cell corresponding to the hash value of the object is free, then this object goes there. If the cell is already occupied by another object, there is a collision. When an object is deleted from the table, the cell which it occupied becomes empty.The Smart Beaver has recently learned about the method of linear probing to resolve collisions. It is as follows. Let\'s say that the hash value for the added object equals t and cell t of the table is already occupied. Then we try to add this object to cell (t\xe2\x80\x89+\xe2\x80\x89m) mod h. If it is also occupied, then we try cell (t\xe2\x80\x89+\xe2\x80\x892\xc2\xb7m) mod h, then cell (t\xe2\x80\x89+\xe2\x80\x893\xc2\xb7m) mod h, and so on. Note that in some cases it\'s possible that the new object can not be added to the table. It is guaranteed that the input for this problem doesn\'t contain such situations.The operation a mod b means that we take the remainder of the division of number a by number b.This technique immediately seemed very inoptimal to the Beaver, and he decided to assess its inefficiency. So, you are given a sequence of operations, each of which is either an addition of an object to the table or a deletion of an object from the table. When adding a new object, a sequence of calls to the table is performed. Calls to occupied cells are called dummy. In other words, if the result of the algorithm described above is the object being added to cell (t\xe2\x80\x89+\xe2\x80\x89i\xc2\xb7m) mod h (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890), then exactly i dummy calls have been performed.Your task is to calculate the total number of dummy calls to the table for the given sequence of additions and deletions. When an object is deleted from the table, assume that no dummy calls are performed. The table is empty before performing the operations, that is, initially it doesn\'t contain any objects." 1600.0
                                                177F1 "Script Generation"  "The Smart Beaver from ABBYY was offered a job of a screenwriter for the ongoing TV series. In particular, he needs to automate the hard decision: which main characters will get married by the end of the series.There are n single men and n single women among the main characters. An opinion poll showed that viewers like several couples, and a marriage of any of them will make the audience happy. The Smart Beaver formalized this fact as k triples of numbers (h,\xe2\x80\x89w,\xe2\x80\x89r), where h is the index of the man, w is the index of the woman, and r is the measure of the audience\'s delight in case of the marriage of this couple. The same poll showed that the marriage of any other couple will leave the audience indifferent, so the screenwriters decided not to include any such marriages in the plot.The script allows you to arrange several marriages between the heroes or not to arrange marriages at all. A subset of some of the k marriages is considered acceptable if each man and each woman is involved in at most one marriage of the subset (the series won\'t allow any divorces). The value of the acceptable set of marriages is the total delight the spectators will get from the marriages included in this set.Obviously, there is a finite number of acceptable sets, and they all describe some variants of the script. The screenwriters do not want to choose a set with maximum value \xe2\x80\x94 it would make the plot too predictable. So the Smart Beaver offers the following option: sort all the acceptable sets in increasing order of value and choose the t-th set from the sorted list. Thus, t\xe2\x80\x89=\xe2\x80\x891 corresponds to a plot without marriages, t\xe2\x80\x89=\xe2\x80\x892 \xe2\x80\x94 to a single marriage resulting in minimal delight for the audience, and so on.Help the Beaver to implement the algorithm for selecting the desired set." 1800.0
                                                177E1 "Space Voyage" "binary search" "The Smart Beaver from ABBYY plans a space travel on an ultramodern spaceship. During the voyage he plans to visit n planets. For planet i ai is the maximum number of suitcases that an alien tourist is allowed to bring to the planet, and bi is the number of citizens on the planet.The Smart Beaver is going to bring some presents from ABBYY to the planets he will be visiting. The presents are packed in suitcases, x presents in each. The Beaver will take to the ship exactly a1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an suitcases.As the Beaver lands on the i-th planet, he takes ai suitcases and goes out. On the first day on the planet the Beaver takes a walk and gets to know the citizens. On the second and all subsequent days the Beaver gives presents to the citizens \xe2\x80\x94 each of the bi citizens gets one present per day. The Beaver leaves the planet in the evening of the day when the number of presents left is strictly less than the number of citizens (i.e. as soon as he won\'t be able to give away the proper number of presents the next day). He leaves the remaining presents at the hotel.The Beaver is going to spend exactly c days traveling. The time spent on flights between the planets is considered to be zero. In how many ways can one choose the positive integer x so that the planned voyage will take exactly c days?" 1700.0
                                                175B "Plane of Tanks: Pro" implementation "Vasya has been playing Plane of Tanks with his friends the whole year. Now it is time to divide the participants into several categories depending on their results. A player is given a non-negative integer number of points in each round of the Plane of Tanks. Vasya wrote results for each round of the last year. He has n records in total.In order to determine a player\'s category consider the best result obtained by the player and the best results of other players. The player belongs to category:   ""noob"" \xe2\x80\x94 if more than 50% of players have better results;  ""random"" \xe2\x80\x94 if his result is not worse than the result that 50% of players have, but more than 20% of players have better results;  ""average"" \xe2\x80\x94 if his result is not worse than the result that 80% of players have, but more than 10% of players have better results;  ""hardcore"" \xe2\x80\x94 if his result is not worse than the result that 90% of players have, but more than 1% of players have better results;  ""pro"" \xe2\x80\x94 if his result is not worse than the result that 99% of players have.  When the percentage is calculated the player himself is taken into account. That means that if two players played the game and the first one gained 100 points and the second one 1000 points, then the first player\'s result is not worse than the result that 50% of players have, and the second one is not worse than the result that 100% of players have.Vasya gave you the last year Plane of Tanks results. Help Vasya determine each player\'s category." 1400.0
                                                175A "Robot Bicorn Attack" "brute force,implementation" "Vasya plays Robot Bicorn Attack.The game consists of three rounds. For each one a non-negative integer amount of points is given. The result of the game is the sum of obtained points. Vasya has already played three rounds and wrote obtained points one by one (without leading zeros) into the string s. Vasya decided to brag about his achievement to the friends. However, he has forgotten how many points he got for each round. The only thing he remembers is the string s.Help Vasya to find out what is the maximum amount of points he could get. Take into account that Vasya played Robot Bicorn Attack for the first time, so he could not get more than 1000000 (106) points for one round." 1400.0
                                                171G "Mysterious numbers - 2" "*special problem" "InputThe only line of input contains three integers a1,\xe2\x80\x89a2,\xe2\x80\x89a3 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89a3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8920), separated by spaces.OutputOutput a single integer.ExamplesInputCopy2 3 2OutputCopy5InputCopy13 14 1OutputCopy14InputCopy14 5 9OutputCopy464InputCopy17 18 3OutputCopy53" 1600.0
                                                171C "A Piece of Cake" "*special problem,implementation" "How to make a cake you\'ll never eat.Ingredients.   2 carrots  0 calories  100 g chocolate spread  1 pack of flour  1 egg Method.   Put calories into the mixing bowl.  Take carrots from refrigerator.  Chop carrots.  Take chocolate spread from refrigerator.  Put chocolate spread into the mixing bowl.  Combine pack of flour into the mixing bowl.  Fold chocolate spread into the mixing bowl.  Add chocolate spread into the mixing bowl.  Put pack of flour into the mixing bowl.  Add egg into the mixing bowl.  Fold pack of flour into the mixing bowl.  Chop carrots until choped.  Pour contents of the mixing bowl into the baking dish. Serves 1." 2000.0
                                                169A Chores sortings "Petya and Vasya are brothers. Today is a special day for them as their parents left them home alone and commissioned them to do n chores. Each chore is characterized by a single parameter \xe2\x80\x94 its complexity. The complexity of the i-th chore equals hi.As Petya is older, he wants to take the chores with complexity larger than some value x (hi\xe2\x80\x89>\xe2\x80\x89x) to leave to Vasya the chores with complexity less than or equal to x (hi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x). The brothers have already decided that Petya will do exactly a chores and Vasya will do exactly b chores (a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89=\xe2\x80\x89n).In how many ways can they choose an integer x so that Petya got exactly a chores and Vasya got exactly b chores?" 800.0
                                                166E Tetrahedron dp,math,matrices "You are given a tetrahedron. Let\'s mark its vertices with letters A, B, C and D correspondingly.  An ant is standing in the vertex D of the tetrahedron. The ant is quite active and he wouldn\'t stay idle. At each moment of time he makes a step from one vertex to another one along some edge of the tetrahedron. The ant just can\'t stand on one place.You do not have to do much to solve the problem: your task is to count the number of ways in which the ant can go from the initial vertex D to itself in exactly n steps. In other words, you are asked to find out the number of different cyclic paths with the length of n from vertex D to itself. As the number can be quite large, you should print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1500.0
                                                166B Polygons geometry,sortings "You\'ve got another geometrical task. You are given two non-degenerate polygons A and B as vertex coordinates. Polygon A is strictly convex. Polygon B is an arbitrary polygon without any self-intersections and self-touches. The vertices of both polygons are given in the clockwise order. For each polygon no three consecutively following vertices are located on the same straight line.Your task is to check whether polygon B is positioned strictly inside polygon A. It means that any point of polygon B should be strictly inside polygon A. ""Strictly"" means that the vertex of polygon B cannot lie on the side of the polygon A." 2100.0
                                                165D "Beard Graph" "data structures,dsu,trees" "Let\'s define a non-oriented connected graph of n vertices and n\xe2\x80\x89-\xe2\x80\x891 edges as a beard, if all of its vertices except, perhaps, one, have the degree of 2 or 1 (that is, there exists no more than one vertex, whose degree is more than two). Let us remind you that the degree of a vertex is the number of edges that connect to it. Let each edge be either black or white. Initially all edges are black.You are given the description of the beard graph. Your task is to analyze requests of the following types:   paint the edge number i black. The edge number i is the edge that has this number in the description. It is guaranteed that by the moment of this request the i-th edge is white  paint the edge number i white. It is guaranteed that by the moment of this request the i-th edge is black  find the length of the shortest path going only along the black edges between vertices a and b or indicate that no such path exists between them (a path\'s length is the number of edges in it) The vertices are numbered with integers from 1 to n, and the edges are numbered with integers from 1 to n\xe2\x80\x89-\xe2\x80\x891." 2100.0
                                                165A "Supercentral Point" implementation "One day Vasya painted a Cartesian coordinate system on a piece of paper and marked some set of points (x1,\xe2\x80\x89y1),\xe2\x80\x89(x2,\xe2\x80\x89y2),\xe2\x80\x89...,\xe2\x80\x89(xn,\xe2\x80\x89yn). Let\'s define neighbors for some fixed point from the given set (x,\xe2\x80\x89y):   point (x\',\xe2\x80\x89y\') is (x,\xe2\x80\x89y)\'s right neighbor, if x\'\xe2\x80\x89>\xe2\x80\x89x and y\'\xe2\x80\x89=\xe2\x80\x89y  point (x\',\xe2\x80\x89y\') is (x,\xe2\x80\x89y)\'s left neighbor, if x\'\xe2\x80\x89<\xe2\x80\x89x and y\'\xe2\x80\x89=\xe2\x80\x89y  point (x\',\xe2\x80\x89y\') is (x,\xe2\x80\x89y)\'s lower neighbor, if x\'\xe2\x80\x89=\xe2\x80\x89x and y\'\xe2\x80\x89<\xe2\x80\x89y  point (x\',\xe2\x80\x89y\') is (x,\xe2\x80\x89y)\'s upper neighbor, if x\'\xe2\x80\x89=\xe2\x80\x89x and y\'\xe2\x80\x89>\xe2\x80\x89y We\'ll consider point (x,\xe2\x80\x89y) from the given set supercentral, if it has at least one upper, at least one lower, at least one left and at least one right neighbor among this set\'s points.Vasya marked quite many points on the paper. Analyzing the picture manually is rather a challenge, so Vasya asked you to help him. Your task is to find the number of supercentral points in the given set." 1000.0
                                                161E "Polycarpus the Safecracker" "brute force,dp" "Polycarpus has t safes. The password for each safe is a square matrix consisting of decimal digits \'0\' ... \'9\' (the sizes of passwords to the safes may vary). Alas, Polycarpus has forgotten all passwords, so now he has to restore them.Polycarpus enjoys prime numbers, so when he chose the matrix passwords, he wrote a prime number in each row of each matrix. To his surprise, he found that all the matrices turned out to be symmetrical (that is, they remain the same after transposition). Now, years later, Polycarp was irritated to find out that he remembers only the prime numbers pi, written in the first lines of the password matrices.For each safe find the number of matrices which can be passwords to it.The number of digits in pi determines the number of rows and columns of the i-th matrix. One prime number can occur in several rows of the password matrix or in several matrices. The prime numbers that are written not in the first row of the matrix may have leading zeros." 2500.0
                                                161A "Dress\'em in Vests!" "binary search,brute force,greedy,two pointers" "The Two-dimensional kingdom is going through hard times... This morning the Three-Dimensional kingdom declared war on the Two-dimensional one. This (possibly armed) conflict will determine the ultimate owner of the straight line.The Two-dimensional kingdom has a regular army of n people. Each soldier registered himself and indicated the desired size of the bulletproof vest: the i-th soldier indicated size ai. The soldiers are known to be unpretentious, so the command staff assumes that the soldiers are comfortable in any vests with sizes from ai\xe2\x80\x89-\xe2\x80\x89x to ai\xe2\x80\x89+\xe2\x80\x89y, inclusive (numbers x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890 are specified). The Two-dimensional kingdom has m vests at its disposal, the j-th vest\'s size equals bj. Help mobilize the Two-dimensional kingdom\'s army: equip with vests as many soldiers as possible. Each vest can be used only once. The i-th soldier can put on the j-th vest, if ai\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89y." 1300.0
                                                159E "Zebra Tower" "*special problem,data structures,greedy,sortings" "Little Janet likes playing with cubes. Actually, she likes to play with anything whatsoever, cubes or tesseracts, as long as they are multicolored. Each cube is described by two parameters \xe2\x80\x94 color ci and size si. A Zebra Tower is a tower that consists of cubes of exactly two colors. Besides, the colors of the cubes in the tower must alternate (colors of adjacent cubes must differ). The Zebra Tower should have at least two cubes. There are no other limitations. The figure below shows an example of a Zebra Tower.  A Zebra Tower\'s height is the sum of sizes of all cubes that form the tower. Help little Janet build the Zebra Tower of the maximum possible height, using the available cubes." 1700.0
                                                159B Matchmaker "*special problem,greedy,sortings" "Polycarpus has n markers and m marker caps. Each marker is described by two numbers: xi is the color and yi is the diameter. Correspondingly, each cap is described by two numbers: aj is the color and bj is the diameter. Cap (aj,\xe2\x80\x89bj) can close marker (xi,\xe2\x80\x89yi) only if their diameters match, that is, bj\xe2\x80\x89=\xe2\x80\x89yi. Besides, a marker is considered to be beautifully closed, if the cap color and the marker color match, that is, aj\xe2\x80\x89=\xe2\x80\x89xi.Find the way to close the maximum number of markers. If there are several such ways, then choose the one that has the maximum number of beautifully closed markers." 1100.0
                                                153D "Date Change" "*special problem" "You are given a date in ""DD.MM.YYYY"" (""day.month.year"") format and a number of days shift you have to add to this date. Output the resulting date." 2000.0
                                                152A Marks implementation "Vasya, or Mr. Vasily Petrov is a dean of a department in a local university. After the winter exams he got his hands on a group\'s gradebook.Overall the group has n students. They received marks for m subjects. Each student got a mark from 1 to 9 (inclusive) for each subject.Let\'s consider a student the best at some subject, if there is no student who got a higher mark for this subject. Let\'s consider a student successful, if there exists a subject he is the best at.Your task is to find the number of successful students in the group." 900.0
                                                150C "Smart Cheater" "data structures,math,probabilities" "I guess there\'s not much point in reminding you that Nvodsk winters aren\'t exactly hot. That increased the popularity of the public transport dramatically. The route of bus 62 has exactly n stops (stop 1 goes first on its way and stop n goes last). The stops are positioned on a straight line and their coordinates are 0\xe2\x80\x89=\xe2\x80\x89x1\xe2\x80\x89<\xe2\x80\x89x2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89xn. Each day exactly m people use bus 62. For each person we know the number of the stop where he gets on the bus and the number of the stop where he gets off the bus. A ticket from stop a to stop b (a\xe2\x80\x89<\xe2\x80\x89b) costs xb\xe2\x80\x89-\xe2\x80\x89xa rubles. However, the conductor can choose no more than one segment NOT TO SELL a ticket for. We mean that conductor should choose C and D (\xd0\xa1 <= D) and sell a ticket for the segments [A, C] and [D, B], or not sell the ticket at all. The conductor and the passenger divide the saved money between themselves equally. The conductor\'s ""untaxed income"" is sometimes interrupted by inspections that take place as the bus drives on some segment of the route located between two consecutive stops. The inspector fines the conductor by c rubles for each passenger who doesn\'t have the ticket for this route\'s segment.You know the coordinated of all stops xi; the numbers of stops where the i-th passenger gets on and off, ai and bi (ai\xe2\x80\x89<\xe2\x80\x89bi); the fine c; and also pi \xe2\x80\x94 the probability of inspection on segment between the i-th and the i\xe2\x80\x89+\xe2\x80\x891-th stop. The conductor asked you to help him make a plan of selling tickets that maximizes the mathematical expectation of his profit." 2200.0
                                                149A "Business trip" greedy,implementation,sortings "What joy! Petya\'s parents went on a business trip for the whole year and the playful kid is left all by himself. Petya got absolutely happy. He jumped on the bed and threw pillows all day long, until... Today Petya opened the cupboard and found a scary note there. His parents had left him with duties: he should water their favourite flower all year, each day, in the morning, in the afternoon and in the evening. ""Wait a second!"" \xe2\x80\x94 thought Petya. He know for a fact that if he fulfills the parents\' task in the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8912) month of the year, then the flower will grow by ai centimeters, and if he doesn\'t water the flower in the i-th month, then the flower won\'t grow this month. Petya also knows that try as he might, his parents won\'t believe that he has been watering the flower if it grows strictly less than by k centimeters. Help Petya choose the minimum number of months when he will water the flower, given that the flower should grow no less than by k centimeters." 900.0
                                                143B "Help Kingdom of Far Far Away 2" implementation,strings "For some time the program of rounding numbers that had been developed by the Codeforces participants during one of the previous rounds, helped the citizens of Far Far Away to convert numbers into a more easily readable format. However, as time went by, the economy of the Far Far Away developed and the scale of operations grew. So the King ordered to found the Bank of Far Far Away and very soon even the rounding didn\'t help to quickly determine even the order of the numbers involved in operations. Besides, rounding a number to an integer wasn\'t very convenient as a bank needed to operate with all numbers with accuracy of up to 0.01, and not up to an integer.The King issued yet another order: to introduce financial format to represent numbers denoting amounts of money. The formal rules of storing a number in the financial format are as follows:   A number contains the integer part and the fractional part. The two parts are separated with a character ""."" (decimal point).  To make digits in the integer part of a number easier to read, they are split into groups of three digits, starting from the least significant ones. The groups are separated with the character "","" (comma). For example, if the integer part of a number equals 12345678, then it will be stored in the financial format as 12,345,678  In the financial format a number\'s fractional part should contain exactly two digits. So, if the initial number (the number that is converted into the financial format) contains less than two digits in the fractional part (or contains no digits at all), it is complemented with zeros until its length equals 2. If the fractional part contains more than two digits, the extra digits are simply discarded (they are not rounded: see sample tests).  When a number is stored in the financial format, the minus sign is not written. Instead, if the initial number had the minus sign, the result is written in round brackets.  Please keep in mind that the bank of Far Far Away operates using an exotic foreign currency \xe2\x80\x94 snakes ($), that\'s why right before the number in the financial format we should put the sign ""$"". If the number should be written in the brackets, then the snake sign should also be inside the brackets. For example, by the above given rules number 2012 will be stored in the financial format as ""$2,012.00"" and number -12345678.9 will be stored as ""($12,345,678.90)"".The merchants of Far Far Away visited you again and expressed much hope that you supply them with the program that can convert arbitrary numbers to the financial format. Can you help them?" 1200.0
                                                142B "Help General" "constructive algorithms,greedy,implementation" "Once upon a time in the Kingdom of Far Far Away lived Sir Lancelot, the chief Royal General. He was very proud of his men and he liked to invite the King to come and watch drill exercises which demonstrated the fighting techniques and tactics of the squad he was in charge of. But time went by and one day Sir Lancelot had a major argument with the Fairy Godmother (there were rumors that the argument occurred after the general spoke badly of the Godmother\'s flying techniques. That seemed to hurt the Fairy Godmother very deeply). As the result of the argument, the Godmother put a rather strange curse upon the general. It sounded all complicated and quite harmless: ""If the squared distance between some two soldiers equals to 5, then those soldiers will conflict with each other!""The drill exercises are held on a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m field, split into nm square 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 segments for each soldier. Thus, the square of the distance between the soldiers that stand on squares (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) equals exactly (x1\xe2\x80\x89-\xe2\x80\x89x2)2\xe2\x80\x89+\xe2\x80\x89(y1\xe2\x80\x89-\xe2\x80\x89y2)2. Now not all nm squad soldiers can participate in the drill exercises as it was before the Fairy Godmother\'s curse. Unless, of course, the general wants the soldiers to fight with each other or even worse... For example, if he puts a soldier in the square (2,\xe2\x80\x892), then he cannot put soldiers in the squares (1,\xe2\x80\x894), (3,\xe2\x80\x894), (4,\xe2\x80\x891) and (4,\xe2\x80\x893) \xe2\x80\x94 each of them will conflict with the soldier in the square (2,\xe2\x80\x892).Your task is to help the general. You are given the size of the drill exercise field. You are asked to calculate the maximum number of soldiers that can be simultaneously positioned on this field, so that no two soldiers fall under the Fairy Godmother\'s curse." 1800.0
                                                139B Wallpaper implementation,math "Having bought his own apartment, Boris decided to paper the walls in every room. Boris\'s flat has n rooms, each of which has the form of a rectangular parallelepiped. For every room we known its length, width and height of the walls in meters (different rooms can have different dimensions, including height).Boris chose m types of wallpaper to paper the walls of the rooms with (but it is not necessary to use all the types). Each type of wallpaper is sold in rolls of a fixed length and width (the length, naturally, shows how long the unfolded roll will be). In addition, for each type we know the price of one roll of this type.The wallpaper of each type contains strips running along the length of the roll. When gluing the strips must be located strictly vertically (so the roll cannot be rotated, even if the length is less than the width). Besides, a roll can be cut in an arbitrary manner, but the joints of glued pieces should also be vertical. In addition, each room should be papered by only one type of wallpaper. And pieces of the same roll cannot be used to paper different rooms. That is, for each room the rolls are purchased separately. Also, some rolls can be used not completely.After buying an apartment Boris is short of cash, so he wants to spend the minimum money on wallpaper. Help him." 1600.0
                                                138C "Mushroom Gnomes - 2" "binary search,data structures,probabilities,sortings" "One day Natalia was walking in the woods when she met a little mushroom gnome. The gnome told her the following story:Everybody knows that the mushroom gnomes\' power lies in the magic mushrooms that grow in the native woods of the gnomes. There are n trees and m magic mushrooms in the woods: the i-th tree grows at a point on a straight line with coordinates ai and has the height of hi, the j-th mushroom grows at the point with coordinates bj and has magical powers zj.But one day wild mushroommunchers, the sworn enemies of mushroom gnomes unleashed a terrible storm on their home forest. As a result, some of the trees began to fall and crush the magic mushrooms. The supreme oracle of mushroom gnomes calculated in advance the probability for each tree that it will fall to the left, to the right or will stand on. If the tree with the coordinate x and height h falls to the left, then all the mushrooms that belong to the right-open interval [x\xe2\x80\x89-\xe2\x80\x89h,\xe2\x80\x89x), are destroyed. If a tree falls to the right, then the mushrooms that belong to the left-open interval (x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89h] are destroyed. Only those mushrooms that are not hit by a single tree survive.Knowing that all the trees fall independently of each other (i.e., all the events are mutually independent, and besides, the trees do not interfere with other trees falling in an arbitrary direction), the supreme oracle was also able to quickly calculate what would be the expectation of the total power of the mushrooms which survived after the storm. His calculations ultimately saved the mushroom gnomes from imminent death.Natalia, as a good Olympiad programmer, got interested in this story, and she decided to come up with a way to quickly calculate the expectation of the sum of the surviving mushrooms\' power." 2200.0
                                                137E "Last Chance" "data structures,implementation,strings" "Having read half of the book called ""Storm and Calm"" on the IT lesson, Innocentius was absolutely determined to finish the book on the maths lessons. All was fine until the math teacher Ms. Watkins saw Innocentius reading fiction books instead of solving equations of the fifth degree. As during the last maths class Innocentius suggested the algorithm of solving equations of the fifth degree in the general case, Ms. Watkins had no other choice but to give him a new task.The teacher asked to write consecutively (without spaces) all words from the ""Storm and Calm"" in one long string s. She thought that a string is good if the number of vowels in the string is no more than twice more than the number of consonants. That is, the string with v vowels and c consonants is good if and only if v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892c.The task Innocentius had to solve turned out to be rather simple: he should find the number of the longest good substrings of the string s." 2000.0
                                                132A "Turing Tape" implementation "INTERCAL is the oldest of esoteric programming languages. One of its many weird features is the method of character-based output, known as Turing Tape method. It converts an array of unsigned 8-bit integers into a sequence of characters to print, using the following method.The integers of the array are processed one by one, starting from the first. Processing i-th element of the array is done in three steps:1. The 8-bit binary notation of the ASCII-code of the previous printed character is reversed. When the first element of the array is processed, the result of this step is considered to be 0.2. The i-th element of the array is subtracted from the result of the previous step modulo 256.3. The binary notation of the result of the previous step is reversed again to produce ASCII-code of the i-th character to be printed.You are given the text printed using this method. Restore the array used to produce this text." 1300.0
                                                131B "Opposites Attract" implementation,math "Everybody knows that opposites attract. That is the key principle of the ""Perfect Matching"" dating agency. The ""Perfect Matching"" matchmakers have classified each registered customer by his interests and assigned to the i-th client number ti (\xe2\x80\x89-\xe2\x80\x8910\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ti\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8910). Of course, one number can be assigned to any number of customers.""Perfect Matching"" wants to advertise its services and publish the number of opposite couples, that is, the couples who have opposite values of t. Each couple consists of exactly two clients. The customer can be included in a couple an arbitrary number of times. Help the agency and write the program that will find the sought number by the given sequence t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. For example, if t\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891), then any two elements ti and tj form a couple if i and j have different parity. Consequently, in this case the sought number equals 4.Of course, a client can\'t form a couple with him/herself." 1200.0
                                                120J "Minimum Sum" "divide and conquer,geometry,sortings" "You are given a set of n vectors on a plane. For each vector you are allowed to multiply any of its coordinates by -1. Thus, each vector vi\xe2\x80\x89=\xe2\x80\x89(xi,\xe2\x80\x89yi) can be transformed into one of the following four vectors:  vi1\xe2\x80\x89=\xe2\x80\x89(xi,\xe2\x80\x89yi),  vi2\xe2\x80\x89=\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x89xi,\xe2\x80\x89yi),  vi3\xe2\x80\x89=\xe2\x80\x89(xi,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89yi),  vi4\xe2\x80\x89=\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x89xi,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89yi).  You should find two vectors from the set and determine which of their coordinates should be multiplied by -1 so that the absolute value of the sum of the resulting vectors was minimally possible. More formally, you should choose two vectors vi, vj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) and two numbers k1, k2 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k1,\xe2\x80\x89k2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894), so that the value of the expression |vik1\xe2\x80\x89+\xe2\x80\x89vjk2| were minimum." 1900.0
                                                120H "Brevity is Soul of Wit" "graph matchings" "As we communicate, we learn much new information. However, the process of communication takes too much time. It becomes clear if we look at the words we use in our everyday speech.We can list many simple words consisting of many letters: ""information"", ""technologies"", ""university"", ""construction"", ""conservatoire"", ""refrigerator"", ""stopwatch"", ""windowsill"", ""electricity"", ""government"" and so on. Of course, we can continue listing those words ad infinitum. Fortunately, the solution for that problem has been found. To make our speech clear and brief, we should replace the initial words with those that resemble them but are much shorter. This idea hasn\'t been brought into life yet, that\'s why you are chosen to improve the situation. Let\'s consider the following formal model of transforming words: we shall assume that one can use n words in a chat. For each words we shall introduce a notion of its shorter variant. We shall define shorter variant of an arbitrary word s as such word t, that meets the following conditions:  it occurs in s as a subsequence,  its length ranges from one to four characters. In other words, the word t consists at least of one and at most of four characters that occur in the same order in the word s. Note that those characters do not necessarily follow in s immediately one after another. You are allowed not to shorten the initial word if its length does not exceed four characters.You are given a list of n different words. Your task is to find a set of their shortened variants. The shortened variants of all words from the list should be different." 1800.0
                                                120E "Put Knight!" games,math "Petya and Gena play a very interesting game ""Put a Knight!"" on a chessboard n\xe2\x80\x89\xc3\x97\xe2\x80\x89n in size. In this game they take turns to put chess pieces called ""knights"" on the board so that no two knights could threat each other. A knight located in square (r,\xe2\x80\x89c) can threat squares (r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x892), (r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x892), (r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x892), (r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x892), (r\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891), (r\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891), (r\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891) and (r\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891) (some of the squares may be located outside the chessboard). The player who can\'t put a new knight during his move loses. Determine which player wins considering that both players play optimally well and Petya starts." 1400.0
                                                119C "Education Reform" dp "Yet another education system reform has been carried out in Berland recently. The innovations are as follows:An academic year now consists of n days. Each day pupils study exactly one of m subjects, besides, each subject is studied for no more than one day. After the lessons of the i-th subject pupils get the home task that contains no less than ai and no more than bi exercises. Besides, each subject has a special attribute, the complexity (ci). A school can make its own timetable, considering the following conditions are satisfied:  the timetable should contain the subjects in the order of the complexity\'s strict increasing;  each day, except for the first one, the task should contain either k times more exercises, or more by k compared to the previous day (more formally: let\'s call the number of home task exercises in the i-th day as xi, then for each i (1\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n): either xi\xe2\x80\x89=\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x89xi\xe2\x80\x89-\xe2\x80\x891 or xi\xe2\x80\x89=\xe2\x80\x89k\xc2\xb7xi\xe2\x80\x89-\xe2\x80\x891 must be true);  the total number of exercises in all home tasks should be maximal possible. All limitations are separately set for each school.It turned out that in many cases ai and bi reach 1016 (however, as the Berland Minister of Education is famous for his love to half-measures, the value of bi\xe2\x80\x89-\xe2\x80\x89ai doesn\'t exceed 100). That also happened in the Berland School \xe2\x84\x96256. Nevertheless, you as the school\'s principal still have to work out the timetable for the next academic year..." 2000.0
                                                119B "Before Exam" "constructive algorithms,implementation,sortings" "Vasya is about to take his first university exam in about several minutes. And it\'s not just some ordinary exam, it\'s on mathematical analysis. Of course, right now Vasya can only think of one thing: what the result of his talk with the examiner will be...To prepare for the exam, one has to study proofs of n theorems. It is known that there will be k examination cards on the exam and each card contains  distinct theorems. Besides, no theorem is mentioned in more than one card (that is,  theorems won\'t be mentioned in any card). During the exam several students may get the same card.We do not know the exact way theorems are distributed by cards, however the students that took the exam before Vasya told him what theorems their cards contained. Vasya evaluates his level of proficiency in the i-th theorem by some number ai. The level of proficiency in some card is the average of the levels of proficiency in the theorems that are included in the card. Now Vasya wants to know the minimally and maximally possible levels of his proficiency in the card he gets on the exam. Vasya wants to determine it by the data he has collected from other students. Unfortunately, Vasya has no time left to do the math and he asked you to help him." 1900.0
                                                113B Petr# "brute force,data structures,hashing,strings" "Long ago, when Petya was a schoolboy, he was very much interested in the Petr# language grammar. During one lesson Petya got interested in the following question: how many different continuous substrings starting with the sbegin and ending with the send (it is possible sbegin\xe2\x80\x89=\xe2\x80\x89send), the given string t has. Substrings are different if and only if their contents aren\'t equal, their positions of occurence don\'t matter. Petya wasn\'t quite good at math, that\'s why he couldn\'t count this number. Help him!" 2000.0
                                                110B "Lucky String" "constructive algorithms,strings" "Petya loves lucky numbers. We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya recently learned to determine whether a string of lowercase Latin letters is lucky. For each individual letter all its positions in the string are written out in the increasing order. This results in 26 lists of numbers; some of them can be empty. A string is considered lucky if and only if in each list the absolute difference of any two adjacent numbers is a lucky number. For example, let\'s consider string ""zbcdzefdzc"". The lists of positions of equal letters are: b: 2 c: 3,\xe2\x80\x8910 d: 4,\xe2\x80\x898 e: 6 f: 7 z: 1,\xe2\x80\x895,\xe2\x80\x899 Lists of positions of letters a, g, h, ..., y are empty.This string is lucky as all differences are lucky numbers. For letters z: 5\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x894, 9\xe2\x80\x89-\xe2\x80\x895\xe2\x80\x89=\xe2\x80\x894, for letters c: 10\xe2\x80\x89-\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x897, for letters d: 8\xe2\x80\x89-\xe2\x80\x894\xe2\x80\x89=\xe2\x80\x894. Note that if some letter occurs only once in a string, it doesn\'t influence the string\'s luckiness after building the lists of positions of equal letters. The string where all the letters are distinct is considered lucky.Find the lexicographically minimal lucky string whose length equals n." 1100.0
                                                109A "Lucky Sum of Digits" "brute force,implementation" "Petya loves lucky numbers. We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya wonders eagerly what minimum lucky number has the sum of digits equal to n. Help him cope with the task." 1000.0
                                                105B "Dark Assembly" "brute force,probabilities" "Dark Assembly is a governing body in the Netherworld. Here sit the senators who take the most important decisions for the player. For example, to expand the range of the shop or to improve certain characteristics of the character the Dark Assembly\'s approval is needed.The Dark Assembly consists of n senators. Each of them is characterized by his level and loyalty to the player. The level is a positive integer which reflects a senator\'s strength. Loyalty is the probability of a positive decision in the voting, which is measured as a percentage with precision of up to 10%. Senators make decisions by voting. Each of them makes a positive or negative decision in accordance with their loyalty. If strictly more than half of the senators take a positive decision, the player\'s proposal is approved. If the player\'s proposal is not approved after the voting, then the player may appeal against the decision of the Dark Assembly. To do that, player needs to kill all the senators that voted against (there\'s nothing wrong in killing senators, they will resurrect later and will treat the player even worse). The probability that a player will be able to kill a certain group of senators is equal to A\xe2\x80\x89/\xe2\x80\x89(A\xe2\x80\x89+\xe2\x80\x89B), where A is the sum of levels of all player\'s characters and B is the sum of levels of all senators in this group. If the player kills all undesired senators, then his proposal is approved.Senators are very fond of sweets. They can be bribed by giving them candies. For each received candy a senator increases his loyalty to the player by 10%. It\'s worth to mention that loyalty cannot exceed 100%. The player can take no more than k sweets to the courtroom. Candies should be given to the senators before the start of voting.Determine the probability that the Dark Assembly approves the player\'s proposal if the candies are distributed among the senators in the optimal way." 1800.0
                                                103D "Time to Raid Cowavans" "brute force,data structures,sortings" "As you know, the most intelligent beings on the Earth are, of course, cows. This conclusion was reached long ago by the Martian aliens, as well as a number of other intelligent civilizations from outer space. Sometimes cows gather into cowavans. This seems to be seasonal. But at this time the cows become passive and react poorly to external stimuli. A cowavan is a perfect target for the Martian scientific saucer, it\'s time for large-scale abductions, or, as the Martians say, raids. Simply put, a cowavan is a set of cows in a row. If we number all cows in the cowavan with positive integers from 1 to n, then we can formalize the popular model of abduction, known as the (a,\xe2\x80\x89b)-Cowavan Raid: first they steal a cow number a, then number a\xe2\x80\x89+\xe2\x80\x89b, then \xe2\x80\x94 number a\xe2\x80\x89+\xe2\x80\x892\xc2\xb7b, and so on, until the number of an abducted cow exceeds n. During one raid the cows are not renumbered. The aliens would be happy to place all the cows on board of their hospitable ship, but unfortunately, the amount of cargo space is very, very limited. The researchers, knowing the mass of each cow in the cowavan, made p scenarios of the (a,\xe2\x80\x89b)-raid. Now they want to identify the following thing for each scenario individually: what total mass of pure beef will get on board of the ship. All the scenarios are independent, in the process of performing the calculations the cows are not being stolen." 2100.0
                                                101C Vectors implementation,math "At a geometry lesson Gerald was given a task: to get vector B out of vector A. Besides, the teacher permitted him to perform the following operations with vector \xd0\x90: Turn the vector by 90 degrees clockwise. Add to the vector a certain vector C.Operations could be performed in any order any number of times.Can Gerald cope with the task?" 2000.0
                                                100H Battleship "*special problem,dfs and similar,implementation" "Do you know the game Battleship? If no, look into Wikipedia article http://en.wikipedia.org/wiki/Battleship_(game). You are given the positions of ships on a 10\xe2\x80\x89\xc3\x97\xe2\x80\x8910 board for playing Battleship. According to the rules, the board should contain the following ships:   one of size 4 (4\xe2\x80\x89\xc3\x97\xe2\x80\x891 or 1\xe2\x80\x89\xc3\x97\xe2\x80\x894 rectangle),  two of size 3 (3\xe2\x80\x89\xc3\x97\xe2\x80\x891 or 1\xe2\x80\x89\xc3\x97\xe2\x80\x893 rectangles),  three of size 2 (2\xe2\x80\x89\xc3\x97\xe2\x80\x891 or 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 rectangles),  four of size 1 (1\xe2\x80\x89\xc3\x97\xe2\x80\x891 rectangles). The ships should not \'bend\', touch each other or overlap in any way. Each ship can be oriented horizontaly or verticaly. Your task is to check whether the given set of boards meets the given conditions." 2100.0
                                                100A "Carpeting the Room" "*special problem,implementation" "Soroush\'s room is a square with side length n. Before this contest he bought k fine Persian carpets to carpet his room for celebrating the 100th contest on his favorite site. Each Persian carpet is a square of side length n1.Soroush wants to cover all the area of his room. Carpets can be put over each other but it is not allowed to rotate the carpets. Can Soroush carpet his room completely?" 1100.0
                                                98B "Help King" implementation,probabilities,trees "This is the modification of the problem used during the official round. Unfortunately, author\'s solution of the original problem appeared wrong, so the problem was changed specially for the archive.Once upon a time in a far away kingdom lived the King. The King had a beautiful daughter, Victoria. They lived happily, but not happily ever after: one day a vicious dragon attacked the kingdom and stole Victoria. The King was full of grief, yet he gathered his noble knights and promised half of his kingdom and Victoria\'s hand in marriage to the one who will save the girl from the infernal beast.Having travelled for some time, the knights found the dragon\'s lair and all of them rushed there to save Victoria. Each knight spat on the dragon once and, as the dragon had quite a fragile and frail heart, his heart broke and poor beast died. As for the noble knights, they got Victoria right to the King and started brawling as each one wanted the girl\'s hand in marriage.The problem was that all the noble knights were equally noble and equally handsome, and Victoria didn\'t want to marry any of them anyway. Then the King (and he was a very wise man and didn\'t want to hurt anybody\'s feelings) decided to find out who will get his daughter randomly, i.e. tossing a coin. However, there turned out to be n noble knights and the coin only has two sides. The good thing is that when a coin is tossed, the coin falls on each side with equal probability. The King got interested how to pick one noble knight using this coin so that all knights had equal probability of being chosen (the probability in that case should always be equal to 1\xe2\x80\x89/\xe2\x80\x89n). First the King wants to know the expected number of times he will need to toss a coin to determine the winner. Besides, while tossing the coin, the King should follow the optimal tossing strategy (i.e. the strategy that minimizes the expected number of tosses). Help the King in this challenging task." 2200.0
                                                97D "Robot in Basement" "bitmasks,brute force,implementation" "The Professor has lost his home robot yet again. After some thinking Professor understood that he had left the robot in the basement.The basement in Professor\'s house is represented by a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, split into 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 squares. Some squares are walls which are impassable; other squares are passable. You can get from any passable square to any other passable square moving through edge-adjacent passable squares. One passable square is the exit from the basement. The robot is placed exactly in one passable square. Also the robot may be placed in the exit square.Professor is scared of going to the dark basement looking for the robot at night. However, he has a basement plan and the robot\'s remote control. Using the remote, Professor can send signals to the robot to shift one square left, right, up or down. When the robot receives a signal, it moves in the required direction if the robot\'s neighboring square in the given direction is passable. Otherwise, the robot stays idle.Professor wrote a sequence of k commands on a piece of paper. He thinks that the sequence can lead the robot out of the basement, wherever it\'s initial position might be. Professor programmed another robot to press the required buttons on the remote according to the notes on the piece of paper. Professor was just about to run the program and go to bed, when he had an epiphany.Executing each command takes some energy and Professor doesn\'t want to get huge electricity bill at the end of the month. That\'s why he wants to find in the sequence he has written out the minimal possible prefix that would guarantee to lead the robot out to the exit after the prefix is fulfilled. And that\'s the problem Professor challenges you with at this late hour." 2700.0
                                                93D Flags dp,math,matrices "When Igor K. was a freshman, his professor strictly urged him, as well as all other freshmen, to solve programming Olympiads. One day a problem called ""Flags"" from a website called Timmy\'s Online Judge caught his attention. In the problem one had to find the number of three-colored flags that would satisfy the condition... actually, it doesn\'t matter. Igor K. quickly found the formula and got the so passionately desired Accepted.However, the professor wasn\'t very much impressed. He decided that the problem represented on Timmy\'s Online Judge was very dull and simple: it only had three possible colors of flag stripes and only two limitations. He suggested a complicated task to Igor K. and the fellow failed to solve it. Of course, we won\'t tell anybody that the professor couldn\'t solve it as well.And how about you? Can you solve the problem?The flags consist of one or several parallel stripes of similar width. The stripes can be one of the following colors: white, black, red or yellow. You should find the number of different flags with the number of stripes from L to R, if:  a flag cannot have adjacent stripes of one color;  a flag cannot have adjacent white and yellow stripes;  a flag cannot have adjacent red and black stripes;  a flag cannot have the combination of black, white and red stripes following one after another in this or reverse order;  symmetrical flags (as, for example, a WB and a BW flag, where W and B stand for the white and black colors) are considered the same." 2500.0
                                                91D "Grocer\'s Problem" "constructive algorithms,graphs,greedy" "Yesterday was a fair in a supermarket\'s grocery section. There were n jars with spices on the fair. Before the event the jars were numbered from 1 to n from the left to the right. After the event the jars were moved and the grocer had to sort them by the increasing of the numbers.The grocer has a special machine at his disposal. The machine can take any 5 or less jars and rearrange them in the way the grocer wants. Note that the jars do not have to stand consecutively. For example, from the permutation 2, 6, 5, 4, 3, 1 one can get permutation 1, 2, 3, 4, 5, 6, if pick the jars on the positions 1, 2, 3, 5 and 6. Which minimum number of such operations is needed to arrange all the jars in the order of their numbers\' increasing?" 2600.0
                                                91B Queue "binary search,data structures" "There are n walruses standing in a queue in an airport. They are numbered starting from the queue\'s tail: the 1-st walrus stands at the end of the queue and the n-th walrus stands at the beginning of the queue. The i-th walrus has the age equal to ai.The i-th walrus becomes displeased if there\'s a younger walrus standing in front of him, that is, if exists such j (i\xe2\x80\x89<\xe2\x80\x89j), that ai\xe2\x80\x89>\xe2\x80\x89aj. The displeasure of the i-th walrus is equal to the number of walruses between him and the furthest walrus ahead of him, which is younger than the i-th one. That is, the further that young walrus stands from him, the stronger the displeasure is.The airport manager asked you to count for each of n walruses in the queue his displeasure." 1500.0
                                                86B "Tetris revisited" "constructive algorithms,graph matchings,greedy,math" "Physicist Woll likes to play one relaxing game in between his search of the theory of everything.Game interface consists of a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m playing field and a dashboard. Initially some cells of the playing field are filled while others are empty. Dashboard contains images of all various connected (we mean connectivity by side) figures of 2, 3, 4 and 5 cells, with all their rotations and reflections. Player can copy any figure from the dashboard and place it anywhere at the still empty cells of the playing field. Of course any figure can be used as many times as needed.Woll\'s aim is to fill the whole field in such a way that there are no empty cells left, and also... just have some fun.Every initially empty cell should be filled with exactly one cell of some figure. Every figure should be entirely inside the board.  In the picture black cells stand for initially filled cells of the field, and one-colour regions represent the figures." 2200.0
                                                86A Reflection math "For each positive integer n consider the integer \xcf\x88(n) which is obtained from n by replacing every digit a in the decimal notation of n with the digit (9\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89\xe2\x80\x89a). We say that \xcf\x88(n) is the reflection of n. For example, reflection of 192 equals 807. Note that leading zeros (if any) should be omitted. So reflection of 9 equals 0, reflection of 91 equals 8.Let us call the weight of the number the product of the number and its reflection. Thus, the weight of the number 10 is equal to 10\xc2\xb789\xe2\x80\x89=\xe2\x80\x89890.Your task is to find the maximum weight of the numbers in the given range [l,\xe2\x80\x89r] (boundaries are included)." 1600.0
                                                85A Domino "constructive algorithms,implementation" "We all know the problem about the number of ways one can tile a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n field by 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 dominoes. You probably remember that it goes down to Fibonacci numbers. We will talk about some other problem below, there you also are going to deal with tiling a rectangular field with dominoes.You are given a 4\xe2\x80\x89\xc3\x97\xe2\x80\x89n rectangular field, that is the field that contains four lines and n columns. You have to find for it any tiling by 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 dominoes such that each of the n\xe2\x80\x89-\xe2\x80\x891 potential vertical cuts along the grid lines intersects at least one domino, splitting it in two. No two dominoes in the sought tiling should overlap, each square of the field should be covered by exactly one domino. It is allowed to rotate the dominoes, that is, you can use 2\xe2\x80\x89\xc3\x97\xe2\x80\x891 as well as 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 dominoes.Write a program that finds an arbitrary sought tiling." 1300.0
                                                84C Biathlon "binary search,implementation" "Perhaps many have heard that the World Biathlon Championship has finished. Although our hero Valera was not present at this spectacular event himself and only watched it on TV, it excited him so much that he decided to enroll in a biathlon section.Of course, biathlon as any sport, proved very difficult in practice. It takes much time and effort. Workouts, workouts, and workouts, \xe2\x80\x94 that\'s what awaited Valera on his way to great achievements in biathlon.As for the workouts, you all probably know that every professional biathlete should ski fast and shoot precisely at the shooting range. Only in this case you can hope to be successful, because running and shooting are the two main components of biathlon. Valera has been diligent in his ski trainings, which is why he runs really fast, however, his shooting accuracy is nothing to write home about.On a biathlon base where Valera is preparing for the competition, there is a huge rifle range with n targets. Each target have shape of a circle, and the center of each circle is located on the Ox axis. At the last training session Valera made the total of m shots. To make monitoring of his own results easier for him, one rather well-known programmer (of course it is you) was commissioned to write a program that would reveal how many and which targets Valera hit. More specifically, for each target the program must print the number of the first successful shot (in the target), or ""-1"" if this was not hit. The target is considered hit if the shot is inside the circle or on its boundary. Valera is counting on you and perhaps, thanks to you he will one day win international competitions." 1700.0
                                                84A "Toy Army" "math,number theory" "The hero of our story, Valera, and his best friend Arcady are still in school, and therefore they spend all the free time playing turn-based strategy ""GAGA: Go And Go Again"". The gameplay is as follows. There are two armies on the playing field each of which consists of n men (n is always even). The current player specifies for each of her soldiers an enemy\'s soldier he will shoot (a target) and then all the player\'s soldiers shot simultaneously. This is a game world, and so each soldier shoots perfectly, that is he absolutely always hits the specified target. If an enemy soldier is hit, he will surely die. It may happen that several soldiers had been indicated the same target. Killed soldiers do not participate in the game anymore. The game ""GAGA"" consists of three steps: first Valera makes a move, then Arcady, then Valera again and the game ends. You are asked to calculate the maximum total number of soldiers that may be killed during the game." 900.0
                                                78A Haiku implementation,strings "Haiku is a genre of Japanese traditional poetry.A haiku poem consists of 17 syllables split into three phrases, containing 5, 7 and 5 syllables correspondingly (the first phrase should contain exactly 5 syllables, the second phrase should contain exactly 7 syllables, and the third phrase should contain exactly 5 syllables). A haiku masterpiece contains a description of a moment in those three phrases. Every word is important in a small poem, which is why haiku are rich with symbols. Each word has a special meaning, a special role. The main principle of haiku is to say much using a few words.To simplify the matter, in the given problem we will consider that the number of syllable in the phrase is equal to the number of vowel letters there. Only the following letters are regarded as vowel letters: ""a"", ""e"", ""i"", ""o"" and ""u"".Three phases from a certain poem are given. Determine whether it is haiku or not." 800.0
                                                76E Points implementation,math "You are given N points on a plane. Write a program which will find the sum of squares of distances between all pairs of points." 1700.0
                                                73F "Plane of Tanks" "brute force,geometry" "Vasya plays the Plane of Tanks. The tanks in this game keep trying to finish each other off. But your ""Pedalny"" is not like that... He just needs to drive in a straight line from point A to point B on the plane. Unfortunately, on the same plane are n enemy tanks. We shall regard all the tanks as points. At the initial moment of time Pedalny is at the point A. Enemy tanks would be happy to destroy it immediately, but initially their turrets are tuned in other directions. Specifically, for each tank we know the initial rotation of the turret ai (the angle in radians relative to the OX axis in the counterclockwise direction) and the maximum speed of rotation of the turret wi (radians per second). If at any point of time a tank turret will be aimed precisely at the tank Pedalny, then the enemy fires and it never misses. Pedalny can endure no more than k shots. Gun reloading takes very much time, so we can assume that every enemy will produce no more than one shot. Your task is to determine what minimum speed of v Pedalny must have to get to the point B. It is believed that Pedalny is able to instantly develop the speed of v, and the first k shots at him do not reduce the speed and do not change the coordinates of the tank." 2900.0
                                                73D FreeDiv "dfs and similar,graphs,greedy" "Vasya plays FreeDiv. In this game he manages a huge state, which has n cities and m two-way roads between them. Unfortunately, not from every city you can reach any other one moving along these roads. Therefore Vasya decided to divide the state into provinces so that in every province, one could reach from every city all the cities of the province, but there are no roads between provinces. Unlike other turn-based strategies, in FreeDiv a player has the opportunity to build tunnels between cities. The tunnels are two-way roads along which one can move armies undetected by the enemy. However, no more than one tunnel can be connected to each city. As for Vasya, he wants to build a network of tunnels so that any pair of cities in his state were reachable by some path consisting of roads and a tunnels. But at that no more than k tunnels are connected to each province (otherwise, the province will be difficult to keep in case other provinces are captured by enemy armies).Vasya discovered that maybe he will not be able to build such a network for the current condition of the state. Maybe he\'ll have first to build several roads between cities in different provinces to merge the provinces. Your task is to determine the minimum number of roads Vasya needs to build so that it was possible to build the required network of tunnels in the resulting state." 2200.0
                                                73C "LionAge II" dp "Vasya plays the LionAge II. He was bored of playing with a stupid computer, so he installed this popular MMORPG, to fight with his friends. Vasya came up with the name of his character \xe2\x80\x94 non-empty string s, consisting of a lowercase Latin letters. However, in order not to put up a front of friends, Vasya has decided to change no more than k letters of the character name so that the new name sounded as good as possible. Euphony of the line is defined as follows: for each pair of adjacent letters x and y (x immediately precedes y) the bonus c(x,\xe2\x80\x89y) is added to the result. Your task is to determine what the greatest Euphony can be obtained by changing at most k letters in the name of the Vasya\'s character." 1800.0
                                                72F Oil "*special problem,greedy,math" "After the nationalization of the oil industry, Dr. Mosaddegh wants to dig some oil wells to extract all the oil in Persian Gulf. But Persian Gulf is huge and has an infinite amount of oil. So Dr. Mosaddegh works only on a rectangular plane of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m of the Persian Gulf. Each of the cells in this rectangle either contains an infinite amount of oil or nothing.Two cells are considered adjacent if and only if they have a common edge, a path is a sequence c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cx of cells so that all of them contain oil and for each i, ci is adjacent to ci\xe2\x80\x89-\xe2\x80\x891 and ci\xe2\x80\x89+\xe2\x80\x891 (if they exist). Two cells are considered connected to each other if and only if there exists a path between them. If we dig a well in a certain cell, we can extract oil from all the cells that are connected to it by oil paths. It is not allowed to dig wells on empty cells.Dr. Mosaddegh also knows that in Persian Gulf, the empty cells form rows and columns. I. e. if some cell is empty, then it\'s column is completely empty or it\'s row is completely empty, or both.Help Dr. Mosaddegh find out how many wells he has to dig to access all the oil in that region." 1900.0
                                                72E "Ali goes shopping" "*special problem,brute force,strings" "Ali Koochooloo is going to buy new clothes since we\'re reaching Noruz, the ancient Persian festival and the beginning of new Persian year.When Ali entered a shop, he saw that the shopkeeper was a programmer and since there is no money in programming he had changed his career. The shopkeeper told Ali that he can buy anything for free if he could answer a simple question in 10 seconds. But to see the question Ali has to pay 3 tomans.Ali agreed instantly and the shopkeeper handed him a piece of paper containing the task. The task was indeed very simple. It said: Let string A be ababababababab. Which non-empty substring of A is repeated the most times in it?Ali answered fast. He said the answer is a. But the shopkeeper said that Ali is wrong and asked him to read the rest of statement:If several substrings have the maximal repeat time, then the substring with maximal length would be the answer, in case of a tie the alphabetically latest substring will be chosen.So the answer is ab.Now Ali wants us to solve this problem for different strings. We don\'t have a great advantage over Ali, we just have a computer and a weird language." 1800.0
                                                71A "Way Too Long Words" strings "Sometimes some words like ""localization"" or ""internationalization"" are so long that writing them many times in one text is quite tiresome.Let\'s consider a word too long, if its length is strictly more than 10 characters. All too long words should be replaced with a special abbreviation.This abbreviation is made like this: we write down the first and the last letter of a word and between them we write the number of letters between the first and the last letters. That number is in decimal system and doesn\'t contain any leading zeroes.Thus, ""localization"" will be spelt as ""l10n"", and ""internationalization\xc2\xbb will be spelt as ""i18n"".You are suggested to automatize the process of changing the words with abbreviations. At that all too long words should be replaced by the abbreviation and the words that are not too long should not undergo any changes." 800.0
                                                70D "Professor\'s task" "data structures,geometry" "Once a walrus professor Plato asked his programming students to perform the following practical task. The students had to implement such a data structure that would support a convex hull on some set of points S. The input to the program had q queries of two types: 1. Add a point with coordinates (x,\xe2\x80\x89y) into the set S. Note that in this case the convex hull of S could have changed, and could have remained the same. 2. Say whether a point with coordinates (x,\xe2\x80\x89y) belongs to an area limited by the convex hull, including the border. All the students coped with the task. What about you?" 2700.0
                                                70A Cookies math "Fangy collects cookies. Once he decided to take a box and put cookies into it in some way. If we take a square k\xe2\x80\x89\xc3\x97\xe2\x80\x89k in size, divided into blocks 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 in size and paint there the main diagonal together with cells, which lie above it, then the painted area will be equal to the area occupied by one cookie k in size. Fangy also has a box with a square base 2n\xe2\x80\x89\xc3\x97\xe2\x80\x892n, divided into blocks 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 in size. In a box the cookies should not overlap, and they should not be turned over or rotated. See cookies of sizes 2 and 4 respectively on the figure:    To stack the cookies the little walrus uses the following algorithm. He takes out of the repository the largest cookie which can fit in some place in the box and puts it there. Everything could be perfect but alas, in the repository the little walrus has infinitely many cookies of size 2 and larger, and there are no cookies of size 1, therefore, empty cells will remain in the box. Fangy wants to know how many empty cells will be left in the end." 1300.0
                                                67D "Optical Experiment" "binary search,data structures,dp" "Professor Phunsuk Wangdu has performed some experiments on rays. The setup for n rays is as follows.There is a rectangular box having exactly n holes on the opposite faces. All rays enter from the holes of the first side and exit from the holes of the other side of the box. Exactly one ray can enter or exit from each hole. The holes are in a straight line.  Professor Wangdu is showing his experiment to his students. He shows that there are cases, when all the rays are intersected by every other ray. A curious student asked the professor: ""Sir, there are some groups of rays such that all rays in that group intersect every other ray in that group. Can we determine the number of rays in the largest of such groups?"".Professor Wangdu now is in trouble and knowing your intellect he asks you to help him." 1900.0
                                                65A "Harry Potter and Three Spells" implementation,math "A long time ago (probably even in the first book), Nicholas Flamel, a great alchemist and the creator of the Philosopher\'s Stone, taught Harry Potter three useful spells. The first one allows you to convert a grams of sand into b grams of lead, the second one allows you to convert c grams of lead into d grams of gold and third one allows you to convert e grams of gold into f grams of sand. When Harry told his friends about these spells, Ron Weasley was amazed. After all, if they succeed in turning sand into lead, lead into gold, and then turning part of the gold into sand again and so on, then it will be possible to start with a small amount of sand and get huge amounts of gold! Even an infinite amount of gold! Hermione Granger, by contrast, was skeptical about that idea. She argues that according to the law of conservation of matter getting an infinite amount of matter, even using magic, is impossible. On the contrary, the amount of matter may even decrease during transformation, being converted to magical energy. Though Hermione\'s theory seems convincing, Ron won\'t believe her. As far as Ron is concerned, Hermione made up her law of conservation of matter to stop Harry and Ron wasting their time with this nonsense, and to make them go and do homework instead. That\'s why Ron has already collected a certain amount of sand for the experiments. A quarrel between the friends seems unavoidable...Help Harry to determine which one of his friends is right, and avoid the quarrel after all. To do this you have to figure out whether it is possible to get the amount of gold greater than any preassigned number from some finite amount of sand." 1800.0
                                                62C Inquisition geometry,implementation,sortings "In Medieval times existed the tradition of burning witches at steaks together with their pets, black cats. By the end of the 15-th century the population of black cats ceased to exist. The difficulty of the situation led to creating the EIC - the Emergency Inquisitory Commission.The resolution #666 says that a white cat is considered black when and only when the perimeter of its black spots exceeds the acceptable norm. But what does the acceptable norm equal to? Every inquisitor will choose it himself depending on the situation. And your task is to find the perimeter of black spots on the cat\'s fur.The very same resolution says that the cat\'s fur is a white square with the length of 105. During the measurement of spots it is customary to put the lower left corner of the fur into the origin of axes (0;0) and the upper right one \xe2\x80\x94 to the point with coordinates (105;105). The cats\' spots are nondegenerate triangles. The spots can intersect and overlap with each other, but it is guaranteed that each pair of the triangular spots\' sides have no more than one common point.We\'ll regard the perimeter in this problem as the total length of the boarders where a cat\'s fur changes color." 2300.0
                                                62B Tyndex.Brome "binary search,implementation" "Tyndex is again well ahead of the rivals! The reaction to the release of Zoozle Chrome browser was the release of a new browser Tyndex.Brome!The popularity of the new browser is growing daily. And the secret is not even the Tyndex.Bar installed (the Tyndex.Bar automatically fills the glass with the finest 1664 cognac after you buy Tyndex.Bottles and insert in into a USB port). It is highly popular due to the well-thought interaction with the user.Let us take, for example, the system of automatic address correction. Have you entered codehorses instead of codeforces? The gloomy Zoozle Chrome will sadly say that the address does not exist. Tyndex.Brome at the same time will automatically find the closest address and sent you there. That\'s brilliant!How does this splendid function work? That\'s simple! For each potential address a function of the F error is calculated by the following rules:  for every letter ci from the potential address c the closest position j of the letter ci in the address (s) entered by the user is found. The absolute difference |i\xe2\x80\x89-\xe2\x80\x89j| of these positions is added to F. So for every i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|c|) the position j is chosen such, that ci\xe2\x80\x89=\xe2\x80\x89sj, and |i\xe2\x80\x89-\xe2\x80\x89j| is minimal possible.  if no such letter ci exists in the address entered by the user, then the length of the potential address |c| is added to F. After the values of the error function have been calculated for all the potential addresses the most suitable one is found. To understand the special features of the above described method better, it is recommended to realize the algorithm of calculating the F function for an address given by the user and some set of potential addresses. Good luck!" 1800.0
                                                61D "Eternal Victory" "dfs and similar,graphs,greedy,shortest paths,trees" "Valerian was captured by Shapur. The victory was such a great one that Shapur decided to carve a scene of Valerian\'s defeat on a mountain. So he had to find the best place to make his victory eternal!He decided to visit all n cities of Persia to find the best available mountain, but after the recent war he was too tired and didn\'t want to traverse a lot. So he wanted to visit each of these n cities at least once with smallest possible traverse. Persian cities are connected with bidirectional roads. You can go from any city to any other one using these roads and there is a unique path between each two cities.All cities are numbered 1 to n. Shapur is currently in the city 1 and he wants to visit all other cities with minimum possible traverse. He can finish his travels in any city.Help Shapur find how much He should travel." 1800.0
                                                59C Title "expression parsing" "Vasya has recently finished writing a book. Now he faces the problem of giving it the title. Vasya wants the title to be vague and mysterious for his book to be noticeable among others. That\'s why the title should be represented by a single word containing at least once each of the first k Latin letters and not containing any other ones. Also, the title should be a palindrome, that is it should be read similarly from the left to the right and from the right to the left.Vasya has already composed the approximate variant of the title. You are given the title template s consisting of lowercase Latin letters and question marks. Your task is to replace all the question marks by lowercase Latin letters so that the resulting word satisfies the requirements, described above. Each question mark should be replaced by exactly one letter, it is not allowed to delete characters or add new ones to the template. If there are several suitable titles, choose the first in the alphabetical order, for Vasya\'s book to appear as early as possible in all the catalogues." 1600.0
                                                59A Word implementation,strings "Vasya is very upset that many people on the Net mix uppercase and lowercase letters in one word. That\'s why he decided to invent an extension for his favorite browser that would change the letters\' register in every word so that it either only consisted of lowercase letters or, vice versa, only of uppercase ones. At that as little as possible letters should be changed in the word. For example, the word HoUse must be replaced with house, and the word ViP \xe2\x80\x94 with VIP. If a word contains an equal number of uppercase and lowercase letters, you should replace all the letters with lowercase ones. For example, maTRIx should be replaced by matrix. Your task is to use the given method on one given word." 800.0
                                                58A "Chat room" greedy,strings "Vasya has recently learned to type and log on to the Internet. He immediately entered a chat room and decided to say hello to everybody. Vasya typed the word s. It is considered that Vasya managed to say hello if several letters can be deleted from the typed word so that it resulted in the word ""hello"". For example, if Vasya types the word ""ahhellllloou"", it will be considered that he said hello, and if he types ""hlelo"", it will be considered that Vasya got misunderstood and he didn\'t manage to say hello. Determine whether Vasya managed to say hello by the given word s." 1000.0
                                                57E Chess "math,shortest paths" "Brian the Rabbit adores chess. Not long ago he argued with Stewie the Rabbit that a knight is better than a king. To prove his point he tries to show that the knight is very fast but Stewie doesn\'t accept statements without evidence. He constructed an infinite chessboard for Brian, where he deleted several squares to add some more interest to the game. Brian only needs to count how many different board squares a knight standing on a square with coordinates of (0,\xe2\x80\x890) can reach in no more than k moves. Naturally, it is forbidden to move to the deleted squares.Brian doesn\'t very much like exact sciences himself and is not acquainted with programming, that\'s why he will hardly be able to get ahead of Stewie who has already started solving the problem. Help Brian to solve the problem faster than Stewie." 3000.0
                                                56D "Changing a String" dp "There is a string s, consisting of capital Latin letters. Let\'s denote its current length as |s|. During one move it is allowed to apply one of the following operations to it:   INSERT pos ch \xe2\x80\x94 insert a letter ch in the string s in the position pos (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pos\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89A\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ch\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89Z). The letter ch becomes the pos-th symbol of the string s, at that the letters shift aside and the length of the string increases by 1.  DELETE pos \xe2\x80\x94 delete a character number pos (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pos\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) from the string s. At that the letters shift together and the length of the string decreases by 1.  REPLACE pos ch \xe2\x80\x94 the letter in the position pos of the line s is replaced by ch (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pos\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|,\xe2\x80\x89A\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ch\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89Z). At that the length of the string does not change. Your task is to find in which minimal number of moves one can get a t string from an s string. You should also find the sequence of actions leading to the required results." 2100.0
                                                54E "Vacuum \xd0\xa1leaner" geometry "One winter evening the Hedgehog was relaxing at home in his cozy armchair and clicking through the TV channels. Stumbled on an issue of \xc2\xabTopShop\xc2\xbb, the Hedgehog was about to change the channel when all of a sudden he was stopped by an advertisement of a new wondrous invention.Actually, a vacuum cleaner was advertised there. It was called Marvellous Vacuum and it doesn\'t even need a human to operate it while it cleans! The vacuum cleaner can move around the flat on its own: it moves in some direction and if it hits an obstacle there, it automatically chooses a new direction. Sooner or later this vacuum cleaner will travel through all the room and clean it all. Having remembered how much time the Hedgehog spends every time on cleaning (surely, no less than a half of the day), he got eager to buy this wonder.However, the Hedgehog quickly understood that the cleaner has at least one weak point: it won\'t clean well in the room\'s corners because it often won\'t able to reach the corner due to its shape. To estimate how serious is this drawback in practice, the Hedgehog asked you to write for him the corresponding program.You will be given the cleaner\'s shape in the top view. We will consider only the cases when the vacuum cleaner is represented as a convex polygon. The room is some infinitely large rectangle. We consider one corner of this room and want to find such a rotation of the vacuum cleaner so that it, being pushed into this corner, will leave the minimum possible area in the corner uncovered." 2700.0
                                                54C "First Digit Law" dp,math,probabilities "In the probability theory the following paradox called Benford\'s law is known: ""In many lists of random numbers taken from real sources, numbers starting with digit 1 occur much more often than numbers starting with any other digit"" (that\'s the simplest form of the law).Having read about it on Codeforces, the Hedgehog got intrigued by the statement and wishes to thoroughly explore it. He finds the following similar problem interesting in particular: there are N random variables, the i-th of which can take any integer value from some segment [Li;Ri] (all numbers from this segment are equiprobable). It means that the value of the i-th quantity can be equal to any integer number from a given interval [Li;Ri] with probability 1\xe2\x80\x89/\xe2\x80\x89(Ri\xe2\x80\x89-\xe2\x80\x89Li\xe2\x80\x89+\xe2\x80\x891).The Hedgehog wants to know the probability of the event that the first digits of at least K% of those values will be equal to one. In other words, let us consider some set of fixed values of these random variables and leave only the first digit (the MSD \xe2\x80\x94 most significant digit) of each value. Then let\'s count how many times the digit 1 is encountered and if it is encountered in at least K per cent of those N values, than such set of values will be called a good one. You have to find the probability that a set of values of the given random variables will be a good one." 2000.0
                                                54A Presents implementation "The Hedgehog likes to give presents to his friend, but no less he likes to receive them.Having received another present today, the Hedgehog suddenly understood that he has no place to put it as there was no room left on the special shelf in the cupboard. He will have to choose another shelf, but which one should he choose, how large should it be?In order to get to know this, the Hedgehog asks you to write him a program that will count the estimated number of presents that he will receive during the following N days. Besides, he is guided by the principle:   on each holiday day the Hedgehog will necessarily receive a present,  he receives presents at least every K days (i.e., if he received a present on the i-th day, he will receive the next present no later than on the i\xe2\x80\x89+\xe2\x80\x89K-th day).  For the given N and K, as well as the list of holidays among the following N days count the minimal number of presents that could be given to the Hedgehog. The number of today\'s day is zero, and you should regard today\'s present as already given (i.e., you shouldn\'t count it in the answer)." 1300.0
                                                51A "Cheaterius\'s Problem" implementation "Cheaterius is a famous in all the Berland astrologist, magician and wizard, and he also is a liar and a cheater. One of his latest inventions is Cheaterius\' amulets! They bring luck and wealth, but are rather expensive. Cheaterius makes them himself. The technology of their making is kept secret. But we know that throughout long nights Cheaterius glues together domino pairs with super glue to get squares 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 which are the Cheaterius\' magic amulets!   That\'s what one of Cheaterius\'s amulets looks like After a hard night Cheaterius made n amulets. Everyone of them represents a square 2\xe2\x80\x89\xc3\x97\xe2\x80\x892, every quarter contains 1 to 6 dots. Now he wants sort them into piles, every pile must contain similar amulets. Two amulets are called similar if they can be rotated by 90, 180 or 270 degrees so that the following condition is met: the numbers of dots in the corresponding quarters should be the same. It is forbidden to turn over the amulets.Write a program that by the given amulets will find the number of piles on Cheaterius\' desk." 1300.0
                                                50E "Square Equation Roots" math "A schoolboy Petya studies square equations. The equations that are included in the school curriculum, usually look simple: x2\xe2\x80\x89+\xe2\x80\x892bx\xe2\x80\x89+\xe2\x80\x89c\xe2\x80\x89=\xe2\x80\x890 where b, c are natural numbers.Petya noticed that some equations have two real roots, some of them have only one root and some equations don\'t have real roots at all. Moreover it turned out that several different square equations can have a common root.Petya is interested in how many different real roots have all the equations of the type described above for all the possible pairs of numbers b and c such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. Help Petya find that number." 2300.0
                                                50A "Domino piling" greedy,math "You are given a rectangular board of M\xe2\x80\x89\xc3\x97\xe2\x80\x89N squares. Also you are given an unlimited number of standard domino pieces of 2\xe2\x80\x89\xc3\x97\xe2\x80\x891 squares. You are allowed to rotate the pieces. You are asked to place as many dominoes as possible on the board so as to meet the following conditions:1. Each domino completely covers two squares.2. No two dominoes overlap.3. Each domino lies entirely inside the board. It is allowed to touch the edges of the board.Find the maximum number of dominoes, which can be placed under these restrictions." 800.0
                                                46E Comb "data structures,dp" "Having endured all the hardships, Lara Croft finally found herself in a room with treasures. To her surprise she didn\'t find golden mountains there. Lara looked around and noticed on the floor a painted table n\xe2\x80\x89\xc3\x97\xe2\x80\x89m panels in size with integers written on the panels. There also was a huge number of stones lying by the wall. On the pillar near the table Lara found a guidance note which said that to get hold of the treasures one has to choose some non-zero number of the first panels in each row of the table and put stones on all those panels to push them down. After that she will receive a number of golden coins equal to the sum of numbers written on the chosen panels. Lara quickly made up her mind on how to arrange the stones and was about to start when she noticed an addition to the note in small font below. According to the addition, for the room ceiling not to crush and smash the adventurer, the chosen panels should form a comb. It was explained that the chosen panels form a comb when the sequence c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn made from the quantities of panels chosen in each table line satisfies the following property: c1\xe2\x80\x89>\xe2\x80\x89c2\xe2\x80\x89<\xe2\x80\x89c3\xe2\x80\x89>\xe2\x80\x89c4\xe2\x80\x89<\xe2\x80\x89..., i.e. the inequation mark interchanges between the neighboring elements. Now Lara is bewildered and doesn\'t know what to do. Help her to determine the largest number of coins she can get and survive at the same time." 1900.0
                                                45E Director "constructive algorithms,greedy" "Vasya is a born Berland film director, he is currently working on a new blockbuster, ""The Unexpected"". Vasya knows from his own experience how important it is to choose the main characters\' names and surnames wisely. He made up a list of n names and n surnames that he wants to use. Vasya haven\'t decided yet how to call characters, so he is free to match any name to any surname. Now he has to make the list of all the main characters in the following format: ""Name1 Surname1, Name2 Surname2, ..., Namen Surnamen"", i.e. all the name-surname pairs should be separated by exactly one comma and exactly one space, and the name should be separated from the surname by exactly one space. First of all Vasya wants to maximize the number of the pairs, in which the name and the surname start from one letter. If there are several such variants, Vasya wants to get the lexicographically minimal one. Help him.An answer will be verified a line in the format as is shown above, including the needed commas and spaces. It\'s the lexicographical minimality of such a line that needs to be ensured. The output line shouldn\'t end with a space or with a comma." 2000.0
                                                44E "Anfisa the Monkey" dp "Anfisa the monkey learns to type. She is yet unfamiliar with the ""space"" key and can only type in lower-case Latin letters. Having typed for a fairly long line, Anfisa understood that it would be great to divide what she has written into k lines not shorter than a and not longer than b, for the text to resemble human speech more. Help Anfisa." 1400.0
                                                44B Cola implementation "To celebrate the opening of the Winter Computer School the organizers decided to buy in n liters of cola. However, an unexpected difficulty occurred in the shop: it turned out that cola is sold in bottles 0.5, 1 and 2 liters in volume. At that, there are exactly a bottles 0.5 in volume, b one-liter bottles and c of two-liter ones. The organizers have enough money to buy any amount of cola. What did cause the heated arguments was how many bottles of every kind to buy, as this question is pivotal for the distribution of cola among the participants (and organizers as well).Thus, while the organizers are having the argument, discussing different variants of buying cola, the Winter School can\'t start. Your task is to count the number of all the possible ways to buy exactly n liters of cola and persuade the organizers that this number is too large, and if they keep on arguing, then the Winter Computer School will have to be organized in summer.All the bottles of cola are considered indistinguishable, i.e. two variants of buying are different from each other only if they differ in the number of bottles of at least one kind." 1500.0
                                                43E Race "brute force,implementation,two pointers" "Today s kilometer long auto race takes place in Berland. The track is represented by a straight line as long as s kilometers. There are n cars taking part in the race, all of them start simultaneously at the very beginning of the track. For every car is known its behavior \xe2\x80\x94 the system of segments on each of which the speed of the car is constant. The j-th segment of the i-th car is pair (vi,\xe2\x80\x89j,\xe2\x80\x89ti,\xe2\x80\x89j), where vi,\xe2\x80\x89j is the car\'s speed on the whole segment in kilometers per hour and ti,\xe2\x80\x89j is for how many hours the car had been driving at that speed. The segments are given in the order in which they are ""being driven on"" by the cars.Your task is to find out how many times during the race some car managed to have a lead over another car. A lead is considered a situation when one car appears in front of another car. It is known, that all the leads happen instantly, i. e. there are no such time segment of positive length, during which some two cars drive ""together"". At one moment of time on one and the same point several leads may appear. In this case all of them should be taken individually. Meetings of cars at the start and finish are not considered to be counted as leads." 2300.0
                                                42D "Strange town" "constructive algorithms,math" "Volodya has recently visited a very odd town. There are N tourist attractions in the town and every two of them are connected by a bidirectional road. Each road has some travel price (natural number) assigned to it and all prices are distinct. But the most striking thing about this town is that each city sightseeing tour has the same total price! That is, if we choose any city sightseeing tour \xe2\x80\x94 a cycle which visits every attraction exactly once \xe2\x80\x94 the sum of the costs of the tour roads is independent of the tour. Volodya is curious if you can find such price system with all road prices not greater than 1000." 2300.0
                                                42A "Guilty --- to the kitchen!" greedy,implementation "It\'s a very unfortunate day for Volodya today. He got bad mark in algebra and was therefore forced to do some work in the kitchen, namely to cook borscht (traditional Russian soup). This should also improve his algebra skills.According to the borscht recipe it consists of n ingredients that have to be mixed in proportion  litres (thus, there should be a1\xe2\x80\x89\xc2\xb7x,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89\xc2\xb7x litres of corresponding ingredients mixed for some non-negative x). In the kitchen Volodya found out that he has b1,\xe2\x80\x89...,\xe2\x80\x89bn litres of these ingredients at his disposal correspondingly. In order to correct his algebra mistakes he ought to cook as much soup as possible in a V litres volume pan (which means the amount of soup cooked can be between 0 and V litres). What is the volume of borscht Volodya will cook ultimately?" 1400.0
                                                41B "Martian Dollar" "brute force" "One day Vasya got hold of information on the Martian dollar course in bourles for the next n days. The buying prices and the selling prices for one dollar on day i are the same and are equal to ai. Vasya has b bourles. He can buy a certain number of dollars and then sell it no more than once in n days. According to Martian laws, one can buy only an integer number of dollars. Which maximal sum of money in bourles can Vasya get by the end of day n?" 1400.0
                                                40E "Number Table" combinatorics "As it has been found out recently, all the Berland\'s current economical state can be described using a simple table n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size. n \xe2\x80\x94 the number of days in each Berland month, m \xe2\x80\x94 the number of months. Thus, a table cell corresponds to a day and a month of the Berland\'s year. Each cell will contain either 1, or -1, which means the state\'s gains in a particular month, on a particular day. 1 corresponds to profits, -1 corresponds to losses. It turned out important for successful development to analyze the data on the state of the economy of the previous year, however when the treasurers referred to the archives to retrieve the data, it turned out that the table had been substantially damaged. In some table cells the number values had faded and were impossible to be deciphered. It is known that the number of cells in which the data had been preserved is strictly less than max(n,\xe2\x80\x89m). However, there is additional information \xe2\x80\x94 the product of the numbers in each line and column equaled -1. Your task is to find out how many different tables may conform to the preserved data. As the answer to the task can be quite large, you have to find it modulo p." 2500.0
                                                40C "Berland Square" implementation,math "Last year the world\'s largest square was built in Berland. It is known that the square can be represented as an infinite plane with an introduced Cartesian system of coordinates. On that square two sets of concentric circles were painted. Let\'s call the set of concentric circles with radii 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89K and the center in the point (z,\xe2\x80\x890) a (K,\xe2\x80\x89z)-set. Thus, on the square were painted a (N,\xe2\x80\x89x)-set and a (M,\xe2\x80\x89y)-set. You have to find out how many parts those sets divided the square into." 2300.0
                                                39J "Spelling Check" hashing,implementation,strings "Petya has noticed that when he types using a keyboard, he often presses extra buttons and adds extra letters to the words. Of course, the spell-checking system underlines the words for him and he has to click every word and choose the right variant. Petya got fed up with correcting his mistakes himself, that\xe2\x80\x99s why he decided to invent the function that will correct the words itself. Petya started from analyzing the case that happens to him most of the time, when all one needs is to delete one letter for the word to match a word from the dictionary. Thus, Petya faces one mini-task: he has a printed word and a word from the dictionary, and he should delete one letter from the first word to get the second one. And now the very non-trivial question that Petya faces is: which letter should he delete?" 1500.0
                                                37E "Trial for Chief" "graphs,greedy,shortest paths" "Having unraveled the Berland Dictionary, the scientists managed to read the notes of the chroniclers of that time. For example, they learned how the chief of the ancient Berland tribe was chosen.As soon as enough pretenders was picked, the following test took place among them: the chief of the tribe took a slab divided by horizontal and vertical stripes into identical squares (the slab consisted of N lines and M columns) and painted every square black or white. Then every pretender was given a slab of the same size but painted entirely white. Within a day a pretender could paint any side-linked set of the squares of the slab some color. The set is called linked if for any two squares belonging to the set there is a path belonging the set on which any two neighboring squares share a side. The aim of each pretender is to paint his slab in the exactly the same way as the chief\xe2\x80\x99s slab is painted. The one who paints a slab like that first becomes the new chief.Scientists found the slab painted by the ancient Berland tribe chief. Help them to determine the minimal amount of days needed to find a new chief if he had to paint his slab in the given way." 2600.0
                                                33D Knights "geometry,graphs,shortest paths,sortings" "Berland is facing dark times again. The army of evil lord Van de Mart is going to conquer the whole kingdom. To the council of war called by the Berland\'s king Valery the Severe came n knights. After long discussions it became clear that the kingdom has exactly n control points (if the enemy conquers at least one of these points, the war is lost) and each knight will occupy one of these points. Berland is divided into m\xe2\x80\x89+\xe2\x80\x891 regions with m fences, and the only way to get from one region to another is to climb over the fence. Each fence is a circle on a plane, no two fences have common points, and no control point is on the fence. You are given k pairs of numbers ai, bi. For each pair you have to find out: how many fences a knight from control point with index ai has to climb over to reach control point bi (in case when Van de Mart attacks control point bi first). As each knight rides a horse (it is very difficult to throw a horse over a fence), you are to find out for each pair the minimum amount of fences to climb over." 2000.0
                                                31E "TV Game" dp "There is a new TV game on BerTV. In this game two players get a number A consisting of 2n digits. Before each turn players determine who will make the next move. Each player should make exactly n moves. On it\'s turn i-th player takes the leftmost digit of A and appends it to his or her number Si. After that this leftmost digit is erased from A. Initially the numbers of both players (S1 and S2) are \xc2\xabempty\xc2\xbb. Leading zeroes in numbers A,\xe2\x80\x89S1,\xe2\x80\x89S2 are allowed. In the end of the game the first player gets S1 dollars, and the second gets S2 dollars.One day Homer and Marge came to play the game. They managed to know the number A beforehand. They want to find such sequence of their moves that both of them makes exactly n moves and which maximizes their total prize. Help them." 2400.0
                                                31A "Worms Evolution" implementation "Professor Vasechkin is studying evolution of worms. Recently he put forward hypotheses that all worms evolve by division. There are n forms of worms. Worms of these forms have lengths a1, a2, ..., an. To prove his theory, professor needs to find 3 different forms that the length of the first form is equal to sum of lengths of the other two forms. Help him to do this." 1200.0
                                                30D "King\'s Problem?" geometry,greedy "Every true king during his life must conquer the world, hold the Codeforces world finals, win pink panda in the shooting gallery and travel all over his kingdom.King Copa has already done the first three things. Now he just needs to travel all over the kingdom. The kingdom is an infinite plane with Cartesian coordinate system on it. Every city is a point on this plane. There are n cities in the kingdom at points with coordinates (x1,\xe2\x80\x890),\xe2\x80\x89(x2,\xe2\x80\x890),\xe2\x80\x89...,\xe2\x80\x89(xn,\xe2\x80\x890), and there is one city at point (xn\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89yn\xe2\x80\x89+\xe2\x80\x891). King starts his journey in the city number k. Your task is to find such route for the king, which visits all cities (in any order) and has minimum possible length. It is allowed to visit a city twice. The king can end his journey in any city. Between any pair of cities there is a direct road with length equal to the distance between the corresponding points. No two cities may be located at the same point." 2600.0
                                                30B "Codeforces World Finals" implementation "The king Copa often has been reported about the Codeforces site, which is rapidly getting more and more popular among the brightest minds of the humanity, who are using it for training and competing. Recently Copa understood that to conquer the world he needs to organize the world Codeforces tournament. He hopes that after it the brightest minds will become his subordinates, and the toughest part of conquering the world will be completed.The final round of the Codeforces World Finals 20YY is scheduled for DD.MM.YY, where DD is the day of the round, MM is the month and YY are the last two digits of the year. Bob is lucky to be the first finalist form Berland. But there is one problem: according to the rules of the competition, all participants must be at least 18 years old at the moment of the finals. Bob was born on BD.BM.BY. This date is recorded in his passport, the copy of which he has already mailed to the organizers. But Bob learned that in different countries the way, in which the dates are written, differs. For example, in the US the month is written first, then the day and finally the year. Bob wonders if it is possible to rearrange the numbers in his date of birth so that he will be at least 18 years old on the day DD.MM.YY. He can always tell that in his motherland dates are written differently. Help him.According to another strange rule, eligible participant must be born in the same century as the date of the finals. If the day of the finals is participant\'s 18-th birthday, he is allowed to participate. As we are considering only the years from 2001 to 2099 for the year of the finals, use the following rule: the year is leap if it\'s number is divisible by four." 1700.0
                                                29B "Traffic Lights" implementation "A car moves from point A to point B at speed v meters per second. The action takes place on the X-axis. At the distance d meters from A there are traffic lights. Starting from time 0, for the first g seconds the green light is on, then for the following r seconds the red light is on, then again the green light is on for the g seconds, and so on.The car can be instantly accelerated from 0 to v and vice versa, can instantly slow down from the v to 0. Consider that it passes the traffic lights at the green light instantly. If the car approaches the traffic lights at the moment when the red light has just turned on, it doesn\'t have time to pass it. But if it approaches the traffic lights at the moment when the green light has just turned on, it can move. The car leaves point A at the time 0.What is the minimum time for the car to get from point A to point B without breaking the traffic rules?" 1500.0
                                                25A "IQ test" "brute force" "Bob is preparing to pass IQ test. The most frequent task in this test is to find out which one of the given n numbers differs from the others. Bob observed that one number usually differs from the others in evenness. Help Bob \xe2\x80\x94 to check his answers, he needs a program that among the given n numbers finds one that is different in evenness." 1300.0
                                                23C "Oranges and Apples" "constructive algorithms,sortings" "In 2N\xe2\x80\x89-\xe2\x80\x891 boxes there are apples and oranges. Your task is to choose N boxes so, that they will contain not less than half of all the apples and not less than half of all the oranges." 2500.0
                                                23B Party "constructive algorithms,graphs,math" "n people came to a party. Then those, who had no friends among people at the party, left. Then those, who had exactly 1 friend among those who stayed, left as well. Then those, who had exactly 2,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891 friends among those who stayed by the moment of their leaving, did the same.What is the maximum amount of people that could stay at the party in the end?" 1600.0
                                                22B "Bargaining Table" "brute force,dp" "Bob wants to put a new bargaining table in his office. To do so he measured the office room thoroughly and drew its plan: Bob\'s office room is a rectangular room n\xe2\x80\x89\xc3\x97\xe2\x80\x89m meters. Each square meter of the room is either occupied by some furniture, or free. A bargaining table is rectangular, and should be placed so, that its sides are parallel to the office walls. Bob doesn\'t want to change or rearrange anything, that\'s why all the squares that will be occupied by the table should be initially free. Bob wants the new table to sit as many people as possible, thus its perimeter should be maximal. Help Bob find out the maximum possible perimeter of a bargaining table for his office." 1500.0
                                                14E Camels dp "Bob likes to draw camels: with a single hump, two humps, three humps, etc. He draws a camel by connecting points on a coordinate plane. Now he\'s drawing camels with t humps, representing them as polylines in the plane. Each polyline consists of n vertices with coordinates (x1,\xe2\x80\x89y1), (x2,\xe2\x80\x89y2), ..., (xn,\xe2\x80\x89yn). The first vertex has a coordinate x1\xe2\x80\x89=\xe2\x80\x891, the second \xe2\x80\x94 x2\xe2\x80\x89=\xe2\x80\x892, etc. Coordinates yi might be any, but should satisfy the following conditions:  there should be t humps precisely, i.e. such indexes j (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), so that yj\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89yj\xe2\x80\x89>\xe2\x80\x89yj\xe2\x80\x89+\xe2\x80\x891,  there should be precisely t\xe2\x80\x89-\xe2\x80\x891 such indexes j (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), so that yj\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89yj\xe2\x80\x89<\xe2\x80\x89yj\xe2\x80\x89+\xe2\x80\x891,  no segment of a polyline should be parallel to the Ox-axis,  all yi are integers between 1 and 4. For a series of his drawings of camels with t humps Bob wants to buy a notebook, but he doesn\'t know how many pages he will need. Output the amount of different polylines that can be drawn to represent camels with t humps for a given number n." 1900.0
                                                10E "Greedy Change" "constructive algorithms" "Billy investigates the question of applying greedy algorithm to different spheres of life. At the moment he is studying the application of greedy algorithm to the problem about change. There is an amount of n coins of different face values, and the coins of each value are not limited in number. The task is to collect the sum x with the minimum amount of coins. Greedy algorithm with each its step takes the coin of the highest face value, not exceeding x. Obviously, if among the coins\' face values exists the face value 1, any sum x can be collected with the help of greedy algorithm. However, greedy algorithm does not always give the optimal representation of the sum, i.e. the representation with the minimum amount of coins. For example, if there are face values {1,\xe2\x80\x893,\xe2\x80\x894} and it is asked to collect the sum 6, greedy algorithm will represent the sum as 4\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891, while the optimal representation is 3\xe2\x80\x89+\xe2\x80\x893, containing one coin less. By the given set of face values find out if there exist such a sum x that greedy algorithm will collect in a non-optimal way. If such a sum exists, find out the smallest of these sums." 2600.0
                                                9C "Hexadecimal\'s Numbers" "brute force,implementation,math" "One beautiful July morning a terrible thing happened in Mainframe: a mean virus Megabyte somehow got access to the memory of his not less mean sister Hexadecimal. He loaded there a huge amount of n different natural numbers from 1 to n to obtain total control over her energy.But his plan failed. The reason for this was very simple: Hexadecimal didn\'t perceive any information, apart from numbers written in binary format. This means that if a number in a decimal representation contained characters apart from 0 and 1, it was not stored in the memory. Now Megabyte wants to know, how many numbers were loaded successfully." 1200.0
                                                9B "Running Student" "brute force,geometry,implementation" "And again a misfortune fell on Poor Student. He is being late for an exam.Having rushed to a bus stop that is in point (0,\xe2\x80\x890), he got on a minibus and they drove along a straight line, parallel to axis OX, in the direction of increasing x.Poor Student knows the following:   during one run the minibus makes n stops, the i-th stop is in point (xi,\xe2\x80\x890)  coordinates of all the stops are different  the minibus drives at a constant speed, equal to vb  it can be assumed the passengers get on and off the minibus at a bus stop momentarily  Student can get off the minibus only at a bus stop  Student will have to get off the minibus at a terminal stop, if he does not get off earlier  the University, where the exam will be held, is in point (xu,\xe2\x80\x89yu)  Student can run from a bus stop to the University at a constant speed vs as long as needed  a distance between two points can be calculated according to the following formula:   Student is already on the minibus, so, he cannot get off at the first bus stop Poor Student wants to get to the University as soon as possible. Help him to choose the bus stop, where he should get off. If such bus stops are multiple, choose the bus stop closest to the University." 1200.0
                                                5E "Bindian Signalizing" "data structures" "Everyone knows that long ago on the territory of present-day Berland there lived Bindian tribes. Their capital was surrounded by n hills, forming a circle. On each hill there was a watchman, who watched the neighbourhood day and night.In case of any danger the watchman could make a fire on the hill. One watchman could see the signal of another watchman, if on the circle arc connecting the two hills there was no hill higher than any of the two. As for any two hills there are two different circle arcs connecting them, the signal was seen if the above mentioned condition was satisfied on at least one of the arcs. For example, for any two neighbouring watchmen it is true that the signal of one will be seen by the other.An important characteristics of this watch system was the amount of pairs of watchmen able to see each other\'s signals. You are to find this amount by the given heights of the hills." 2400.0
     1704F "Colouring Game" "constructive algorithms,dp,games" "Alice and Bob are playing a game. There are n cells in a row. Initially each cell is either red or blue. Alice goes first.On each turn, Alice chooses two neighbouring cells which contain at least one red cell, and paints that two cells white. Then, Bob chooses two neighbouring cells which contain at least one blue cell, and paints that two cells white. The player who cannot make a move loses.Find the winner if both Alice and Bob play optimally.Note that a chosen cell can be white, as long as the other cell satisfies the constraints." 2600.0                                           
     1703G "Good Key, Bad Key" "bitmasks,brute force,dp,greedy,math" "There are n chests. The i-th chest contains ai coins. You need to open all n chests in order from chest 1 to chest n.There are two types of keys you can use to open a chest:   a good key, which costs k coins to use;  a bad key, which does not cost any coins, but will halve all the coins in each unopened chest, including the chest it is about to open. The halving operation will round down to the nearest integer for each chest halved. In other words using a bad key to open chest i will do ai=\xe2\x8c\x8aai2\xe2\x8c\x8b, ai+1=\xe2\x8c\x8aai+12\xe2\x8c\x8b,\xe2\x80\xa6,an=\xe2\x8c\x8aan2\xe2\x8c\x8b;  any key (both good and bad) breaks after a usage, that is, it is a one-time use. You need to use in total n keys, one for each chest. Initially, you have no coins and no keys. If you want to use a good key, then you need to buy it.During the process, you are allowed to go into debt; for example, if you have 1 coin, you are allowed to buy a good key worth k=3 coins, and your balance will become \xe2\x88\x922 coins.Find the maximum number of coins you can have after opening all n chests in order from chest 1 to chest n." 1600.0                                           
     1703C Cypher "brute force,implementation,strings" "Luca has a cypher made up of a sequence of n wheels, each with a digit ai written on it. On the i-th wheel, he made bi moves. Each move is one of two types:   up move (denoted by U): it increases the i-th digit by 1. After applying the up move on 9, it becomes 0.  down move (denoted by D): it decreases the i-th digit by 1. After applying the down move on 0, it becomes 9.   Example for n=4. The current sequence is 0 0 0 0. Luca knows the final sequence of wheels and the moves for each wheel. Help him find the original sequence and crack the cypher." 800.0                                           
     1703A "YES or YES?" "brute force,implementation,strings" "There is a string s of length 3, consisting of uppercase and lowercase English letters. Check if it is equal to ""YES"" (without quotes), where each letter can be in any case. For example, ""yES"", ""Yes"", ""yes"" are all allowable." 800.0                                           
     1701F Points "combinatorics,data structures,implementation,math,matrices" "A triple of points i, j and k on a coordinate line is called beautiful if i<j<k and k\xe2\x88\x92i\xe2\x89\xa4d.You are given a set of points on a coordinate line, initially empty. You have to process queries of three types:  add a point;  remove a point;  calculate the number of beautiful triples consisting of points belonging to the set." 2500.0                                           
     1701C "Schedule Management" "binary search,greedy,implementation,two pointers" "There are n workers and m tasks. The workers are numbered from 1 to n. Each task i has a value ai \xe2\x80\x94 the index of worker who is proficient in this task.Every task should have a worker assigned to it. If a worker is proficient in the task, they complete it in 1 hour. Otherwise, it takes them 2 hours.The workers work in parallel, independently of each other. Each worker can only work on one task at once.Assign the workers to all tasks in such a way that the tasks are completed as early as possible. The work starts at time 0. What\'s the minimum time all tasks can be completed by?" 1400.0                                           
     1701A "Grass Field" implementation "There is a field of size 2\xc3\x972. Each cell of this field can either contain grass or be empty. The value ai,j is 1 if the cell (i,j) contains grass, or 0 otherwise.In one move, you can choose one row and one column and cut all the grass in this row and this column. In other words, you choose the row x and the column y, then you cut the grass in all cells ax,i and all cells ai,y for all i from 1 to 2. After you cut the grass from a cell, it becomes empty (i.\xe2\x80\x89e. its value is replaced by 0).Your task is to find the minimum number of moves required to cut the grass in all non-empty cells of the field (i.\xe2\x80\x89e. make all ai,j zeros).You have to answer t independent test cases." 800.0                                           
     1700E "Serega the Pirate" "brute force,constructive algorithms" "Little pirate Serega robbed a ship with puzzles of different kinds. Among all kinds, he liked only one, the hardest.A puzzle is a table of n rows and m columns, whose cells contain each number from 1 to n\xe2\x8b\x85m exactly once.To solve a puzzle, you have to find a sequence of cells in the table, such that any two consecutive cells are adjacent by the side in the table. The sequence can have arbitrary length and should visit each cell one or more times. For a cell containing the number i, denote the position of the first occurrence of this cell in the sequence as ti. The sequence solves the puzzle, if t1<t2<\xe2\x8b\xaf<tnm. In other words, the cell with number x should be first visited before the cell with number x+1 for each x.Let\'s call a puzzle solvable, if there exists at least one suitable sequence.In one move Serega can choose two arbitrary cells in the table (not necessarily adjacent by the side) and swap their numbers. He would like to know the minimum number of moves to make his puzzle solvable, but he is too impatient. Thus, please tell if the minimum number of moves is 0, 1, or at least 2. In the case, where 1 move is required, please also find the number of suitable cell pairs to swap." 2600.0                                           
     1700B "Palindromic Numbers" "constructive algorithms,implementation,math" "During a daily walk Alina noticed a long number written on the ground. Now Alina wants to find some positive number of same length without leading zeroes, such that the sum of these two numbers is a palindrome. Recall that a number is called a palindrome, if it reads the same right to left and left to right. For example, numbers 121,66,98989 are palindromes, and 103,239,1241 are not palindromes.Alina understands that a valid number always exist. Help her find one!" 1100.0                                           
     1698G "Long Binary String" "bitmasks,math,matrices,meet-in-the-middle,number theory" "There is a binary string t of length 10100, and initally all of its bits are 0. You are given a binary string s, and perform the following operation some times:   Select some substring of t, and replace it with its XOR with s.\xe2\x80\xa0  After several operations, the string t has exactly two bits 1; that is, there are exactly two distinct indices p and q such that the p-th and q-th bits of t are 1, and the rest of the bits are 0. Find the lexicographically largest\xe2\x80\xa1 string t satisfying these constraints, or report that no such string exists.\xe2\x80\xa0 Formally, choose an index i such that 0\xe2\x89\xa4i\xe2\x89\xa410100\xe2\x88\x92|s|. For all 1\xe2\x89\xa4j\xe2\x89\xa4|s|, if sj=1, then toggle ti+j. That is, if ti+j=0, set ti+j=1. Otherwise if ti+j=1, set ti+j=0.\xe2\x80\xa1 A binary string a is lexicographically larger than a binary string b of the same length if in the first position where a and b differ, the string a has a bit 1 and the corresponding bit in b is 0." 2900.0                                           
     1698B "Rising Sand" "constructive algorithms,greedy,implementation" "There are n piles of sand where the i-th pile has ai blocks of sand. The i-th pile is called too tall if 1<i<n and ai>ai\xe2\x88\x921+ai+1. That is, a pile is too tall if it has more sand than its two neighbours combined. (Note that piles on the ends of the array cannot be too tall.)You are given an integer k. An operation consists of picking k consecutive piles of sand and adding one unit of sand to them all. Formally, pick 1\xe2\x89\xa4l,r\xe2\x89\xa4n such that r\xe2\x88\x92l+1=k. Then for all l\xe2\x89\xa4i\xe2\x89\xa4r, update ai\xe2\x86\x90ai+1.What is the maximum number of piles that can simultaneously be too tall after some (possibly zero) operations?" 800.0                                           
     1697E Coloring "brute force,combinatorics,constructive algorithms,dp,geometry,graphs,greedy,implementation,math" "You are given n points on the plane, the coordinates of the i-th point are (xi,yi). No two points have the same coordinates.The distance between points i and j is defined as d(i,j)=|xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|.For each point, you have to choose a color, represented by an integer from 1 to n. For every ordered triple of different points (a,b,c), the following constraints should be met:  if a, b and c have the same color, then d(a,b)=d(a,c)=d(b,c);  if a and b have the same color, and the color of c is different from the color of a, then d(a,b)<d(a,c) and d(a,b)<d(b,c). Calculate the number of different ways to choose the colors that meet these constraints." 2400.0                                           
     1696A "NIT orz!" bitmasks,greedy "NIT, the cleaver, is new in town! Thousands of people line up to orz him. To keep his orzers entertained, NIT decided to let them solve the following problem related to orz. Can you solve this problem too?You are given a 1-indexed array of n integers, a, and an integer z. You can do the following operation any number (possibly zero) of times:  Select a positive integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n. Then, simutaneously set ai to (aiorz) and set z to (aiandz). In other words, let x and y respectively be the current values of ai and z. Then set ai to (xory) and set z to (xandy). Here or and and denote the bitwise operations OR and AND respectively.Find the maximum possible value of the maximum value in a after any number (possibly zero) of operations." 800.0                                           
     1695C "Zero Path" "brute force,data structures,dp,graphs,greedy,shortest paths" "You are given a grid with n rows and m columns. We denote the square on the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) row and j-th (1\xe2\x89\xa4j\xe2\x89\xa4m) column by (i,j) and the number there by aij. All numbers are equal to 1 or to \xe2\x88\x921. You start from the square (1,1) and can move one square down or one square to the right at a time. In the end, you want to end up at the square (n,m).Is it possible to move in such a way so that the sum of the values written in all the visited cells (including a11 and anm) is 0?" 1700.0                                           
     1694B "Paranoid String" "constructive algorithms,greedy" "Let\'s call a binary string T of length m indexed from 1 to m paranoid if we can obtain a string of length 1 by performing the following two kinds of operations m\xe2\x88\x921 times in any order : Select any substring of T that is equal to 01, and then replace it with 1. Select any substring of T that is equal to 10, and then replace it with 0.For example, if T= 001, we can select the substring [T2T3] and perform the first operation. So we obtain T= 01.You are given a binary string S of length n indexed from 1 to n. Find the number of pairs of integers (l,r) 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n such that S[l\xe2\x80\xa6r] (the substring of S from l to r) is a paranoid string." 1200.0                                           
     1692F 3SUM "brute force,math" "Given an array a of positive integers with length n, determine if there exist three distinct indices i, j, k such that ai+aj+ak ends in the digit 3." 1300.0                                           
     1692D "The Clock" "brute force,implementation" "Victor has a 24-hour clock that shows the time in the format ""HH:MM"" (00 \xe2\x89\xa4 HH \xe2\x89\xa4 23, 00 \xe2\x89\xa4 MM \xe2\x89\xa4 59). He looks at the clock every x minutes, and the clock is currently showing time s. How many different palindromes will Victor see in total after looking at the clock every x minutes, the first time being at time s?For example, if the clock starts out as 03:12 and Victor looks at the clock every 360 minutes (i.e. every 6 hours), then he will see the times 03:12, 09:12, 15:12, 21:12, 03:12, and the times will continue to repeat. Here the time 21:12 is the only palindrome he will ever see, so the answer is 1.A palindrome is a string that reads the same backward as forward. For example, the times 12:21, 05:50, 11:11 are palindromes but 13:13, 22:10, 02:22 are not." 1100.0                                           
     1691F "K-Set Tree" "combinatorics,dfs and similar,dp,math,trees" "You are given a tree G with n vertices and an integer k. The vertices of the tree are numbered from 1 to n.For a vertex r and a subset S of vertices of G, such that |S|=k, we define f(r,S) as the size of the smallest rooted subtree containing all vertices in S when the tree is rooted at r. A set of vertices T is called a rooted subtree, if all the vertices in T are connected, and for each vertex in T, all its descendants belong to T.You need to calculate the sum of f(r,S) over all possible distinct combinations of vertices r and subsets S, where |S|=k. Formally, compute the following: \xe2\x88\x91r\xe2\x88\x88V\xe2\x88\x91S\xe2\x8a\x86V,|S|=kf(r,S), where V is the set of vertices in G.Output the answer modulo 109+7." 2500.0                                           
     1691A "Beat The Odds" "brute force,greedy,math" "Given a sequence a1,a2,\xe2\x80\xa6,an, find the minimum number of elements to remove from the sequence such that after the removal, the sum of every 2 consecutive elements is even." 800.0                                           
     1690E "Price Maximization" "binary search,greedy,math,two pointers" "A batch of n goods (n \xe2\x80\x94 an even number) is brought to the store, i-th of which has weight ai. Before selling the goods, they must be packed into packages. After packing, the following will be done:   There will be n2 packages, each package contains exactly two goods;  The weight of the package that contains goods with indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) is ai+aj. With this, the cost of a package of weight x is always \xe2\x8c\x8axk\xe2\x8c\x8b burles (rounded down), where k \xe2\x80\x94 a fixed and given value.Pack the goods to the packages so that the revenue from their sale is maximized. In other words, make such n2 pairs of given goods that the sum of the values \xe2\x8c\x8axik\xe2\x8c\x8b, where xi is the weight of the package number i (1\xe2\x89\xa4i\xe2\x89\xa4n2), is maximal.For example, let n=6,k=3, weights of goods a=[3,2,7,1,4,8]. Let\'s pack them into the following packages.   In the first package we will put the third and sixth goods. Its weight will be a3+a6=7+8=15. The cost of the package will be \xe2\x8c\x8a153\xe2\x8c\x8b=5 burles.  In the second package put the first and fifth goods, the weight is a1+a5=3+4=7. The cost of the package is \xe2\x8c\x8a73\xe2\x8c\x8b=2 burles.  In the third package put the second and fourth goods, the weight is a2+a4=2+1=3. The cost of the package is \xe2\x8c\x8a33\xe2\x8c\x8b=1 burle. With this packing, the total cost of all packs would be 5+2+1=8 burles." 1500.0                                           
     1685E "The Ultimate LIS Problem" "data structures,greedy" "It turns out that this is exactly the 100-th problem of mine that appears in some programming competition. So it has to be special! And what can be more special than another problem about LIS...You are given a permutation p1,p2,\xe2\x80\xa6,p2n+1 of integers from 1 to 2n+1. You will have to process q updates, where the i-th update consists in swapping pui,pvi.After each update, find any cyclic shift of p with LIS\xe2\x89\xa4n, or determine that there is no such shift. (Refer to the output section for details).Here LIS(a) denotes the length of longest strictly increasing subsequence of a.Hacks are disabled in this problem. Don\'t ask why." 3500.0                                           
     1680F "Lenient Vertex Cover" "dfs and similar,divide and conquer,dsu,graphs,trees" "You are given a simple connected undirected graph, consisting of n vertices and m edges. The vertices are numbered from 1 to n.A vertex cover of a graph is a set of vertices such that each edge has at least one of its endpoints in the set.Let\'s call a lenient vertex cover such a vertex cover that at most one edge in it has both endpoints in the set.Find a lenient vertex cover of a graph or report that there is none. If there are multiple answers, then print any of them." 2600.0                                           
     1679E "Typical Party in Dorm" bitmasks,combinatorics,dp,strings "Today is a holiday in the residence hall \xe2\x80\x94 Oleh arrived, in honor of which the girls gave him a string. Oleh liked the gift a lot, so he immediately thought up and offered you, his best friend, the following problem.You are given a string s of length n, which consists of the first 17 lowercase Latin letters {a, b, c, \xe2\x80\xa6, p, q} and question marks. And q queries. Each query is defined by a set of pairwise distinct lowercase first 17 letters of the Latin alphabet, which can be used to replace the question marks in the string s.The answer to the query is the sum of the number of distinct substrings that are palindromes over all strings that can be obtained from the original string s by replacing question marks with available characters. The answer must be calculated modulo 998244353.Pay attention! Two substrings are different when their start and end positions in the string are different. So, the number of different substrings that are palindromes for the string aba will be 4: a, b, a, aba.Consider examples of replacing question marks with letters. For example, from the string aba??ee when querying {a, b} you can get the strings ababaee or abaaaee but you cannot get the strings pizza,  abaee, abacaba, aba?fee, aba47ee, or abatree.Recall that a palindrome is a string that reads the same from left to right as from right to left." 2400.0                                           
     1674G "Remove Directed Edges" "dfs and similar,dp,graphs" "You are given a directed acyclic graph, consisting of n vertices and m edges. The vertices are numbered from 1 to n. There are no multiple edges and self-loops.Let inv be the number of incoming edges (indegree) and outv be the number of outgoing edges (outdegree) of vertex v.You are asked to remove some edges from the graph. Let the new degrees be in\xe2\x80\xb2v and out\xe2\x80\xb2v.You are only allowed to remove the edges if the following conditions hold for every vertex v:   in\xe2\x80\xb2v<inv or in\xe2\x80\xb2v=inv=0;  out\xe2\x80\xb2v<outv or out\xe2\x80\xb2v=outv=0. Let\'s call a set of vertices S cute if for each pair of vertices v and u (v\xe2\x89\xa0u) such that v\xe2\x88\x88S and u\xe2\x88\x88S, there exists a path either from v to u or from u to v over the non-removed edges.What is the maximum possible size of a cute set S after you remove some edges from the graph and both indegrees and outdegrees of all vertices either decrease or remain equal to 0?" 2000.0                                           
     1671E Preorder "combinatorics,divide and conquer,dp,dsu,hashing,sortings,trees" "You are given a rooted tree of 2n\xe2\x88\x921 vertices. Every vertex of this tree has either 0 children, or 2 children. All leaves of this tree have the same distance from the root, and for every non-leaf vertex, one of its children is the left one, and the other child is the right one. Formally, you are given a perfect binary tree.The vertices of the tree are numbered in the following order:  the root has index 1;  if a vertex has index x, then its left child has index 2x, and its right child has index 2x+1. Every vertex of the tree has a letter written on it, either A or B. Let\'s define the character on the vertex x as sx.Let the preorder string of some vertex x be defined in the following way:  if the vertex x is a leaf, then the preorder string of x be consisting of only one character sx;  otherwise, the preorder string of x is sx+f(lx)+f(rx), where + operator defines concatenation of strings, f(lx) is the preorder string of the left child of x, and f(rx) is the preorder string of the right child of x. The preorder string of the tree is the preorder string of its root.Now, for the problem itself...You have to calculate the number of different strings that can be obtained as the preorder string of the given tree, if you are allowed to perform the following operation any number of times before constructing the preorder string of the tree:  choose any non-leaf vertex x, and swap its children (so, the left child becomes the right one, and vice versa)." 2100.0                                           
     1669H "Maximal AND" bitmasks,greedy,math "Let AND denote the bitwise AND operation, and OR denote the bitwise OR operation.You are given an array a of length n and a non-negative integer k. You can perform at most k operations on the array of the following type:  Select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and replace ai with ai OR 2j where j is any integer between 0 and 30 inclusive. In other words, in an operation you can choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and set the j-th bit of ai to 1 (0\xe2\x89\xa4j\xe2\x89\xa430). Output the maximum possible value of a1 AND a2 AND \xe2\x80\xa6 AND an after performing at most k operations." 1300.0                                           
     1669F "Eating Candies" "binary search,data structures,greedy,two pointers" "There are n candies put from left to right on a table. The candies are numbered from left to right. The i-th candy has weight wi. Alice and Bob eat candies. Alice can eat any number of candies from the left (she can\'t skip candies, she eats them in a row). Bob can eat any number of candies from the right (he can\'t skip candies, he eats them in a row). Of course, if Alice ate a candy, Bob can\'t eat it (and vice versa).They want to be fair. Their goal is to eat the same total weight of candies. What is the most number of candies they can eat in total?" 1100.0                                           
     1669C "Odd/Even Increments" greedy,greedy,implementation,math "Given an array a=[a1,a2,\xe2\x80\xa6,an] of n positive integers, you can do operations of two types on it:  Add 1 to every element with an odd index. In other words change the array as follows: a1:=a1+1,a3:=a3+1,a5:=a5+1,\xe2\x80\xa6.  Add 1 to every element with an even index. In other words change the array as follows: a2:=a2+1,a4:=a4+1,a6:=a6+1,\xe2\x80\xa6.Determine if after any number of operations it is possible to make the final array contain only even numbers or only odd numbers. In other words, determine if you can make all elements of the array have the same parity after any number of operations.Note that you can do operations of both types any number of times (even none). Operations of different types can be performed a different number of times." 800.0                                           
     1665D "GCD Guess" "bitmasks,chinese remainder theorem,constructive algorithms,games,interactive,math,number theory" "This is an interactive problem.There is a positive integer 1\xe2\x89\xa4x\xe2\x89\xa4109 that you have to guess.In one query you can choose two positive integers a\xe2\x89\xa0b. As an answer to this query you will get gcd(x+a,x+b), where gcd(n,m) is the greatest common divisor of the numbers n and m.To guess one hidden number x you are allowed to make no more than 30 queries." 2000.0                                           
     1663C "P\xc5\x8dja Verdon" "*special problem,implementation,math" "Aenar has an array a consisting of n integers." -999.0                                           
     1663A "Who Tested?" "*special problem,expression parsing,trees"  -999.0                                           
     1662A "Organizing SWERC" "brute force,implementation" "Gianni, SWERC\'s chief judge, received a huge amount of high quality problems from the judges and now he has to choose a problem set for SWERC.He received n problems and he assigned a beauty score and a difficulty to each of them. The i-th problem has beauty score equal to bi and difficulty equal to di. The beauty and the difficulty are integers between 1 and 10. If there are no problems with a certain difficulty (the possible difficulties are 1,2,\xe2\x80\xa6,10) then Gianni will ask for more problems to the judges.Otherwise, for each difficulty between 1 and 10, he will put in the problem set one of the most beautiful problems with such difficulty (so the problem set will contain exactly 10 problems with distinct difficulties). You shall compute the total beauty of the problem set, that is the sum of the beauty scores of the problems chosen by Gianni." -999.0                                           
     1658D2 "388535 (Hard Version)" "bitmasks,brute force,data structures,math" "This is the hard version of the problem. The difference in the constraints between both versions are colored below in red. You can make hacks only if all versions of the problem are solved.Marin and Gojou are playing hide-and-seek with an array.Gojou initially perform the following steps:   First, Gojou chooses 2 integers l and r such that l\xe2\x89\xa4r.  Then, Gojou will make an array a of length r\xe2\x88\x92l+1 which is a permutation of the array [l,l+1,\xe2\x80\xa6,r].  Finally, Gojou chooses a secret integer x and sets ai to ai\xe2\x8a\x95x for all i (where \xe2\x8a\x95 denotes the bitwise XOR operation). Marin is then given the values of l,r and the final array a. She needs to find the secret integer x to win. Can you help her?Note that there may be multiple possible x that Gojou could have chosen. Marin can find any possible x that could have resulted in the final value of a." 2300.0                                           
     1657B "XY Sequence" greedy "You are given four integers n, B, x and y. You should build a sequence a0,a1,a2,\xe2\x80\xa6,an where a0=0 and for each i\xe2\x89\xa51 you can choose:   either ai=ai\xe2\x88\x921+x  or ai=ai\xe2\x88\x921\xe2\x88\x92y. Your goal is to build such a sequence a that ai\xe2\x89\xa4B for all i and n\xe2\x88\x91i=0ai is maximum possible." 800.0                                           
     1656F "Parametric MST" "binary search,constructive algorithms,graphs,greedy,math,sortings" "You are given n integers a1,a2,\xe2\x80\xa6,an. For any real number t, consider the complete weighted graph on n vertices Kn(t) with weight of the edge between vertices i and j equal to wij(t)=ai\xe2\x8b\x85aj+t\xe2\x8b\x85(ai+aj). Let f(t) be the cost of the minimum spanning tree of Kn(t). Determine whether f(t) is bounded above and, if so, output the maximum value it attains." 2600.0                                           
     1654H "Three Minimums" "combinatorics,constructive algorithms,divide and conquer,dp,fft,math" "Given a list of distinct values, we denote with first minimum, second minimum, and third minimum the three smallest values (in increasing order).A permutation p1,p2,\xe2\x80\xa6,pn is good if the following statement holds for all pairs (l,r) with 1\xe2\x89\xa4l<l+2\xe2\x89\xa4r\xe2\x89\xa4n.   If {pl,pr} are (not necessarily in this order) the first and second minimum of pl,pl+1,\xe2\x80\xa6,pr then the third minimum of pl,pl+1,\xe2\x80\xa6,pr is either pl+1 or pr\xe2\x88\x921. You are given an integer n and a string s of length m consisting of characters ""<"" and "">"".Count the number of good permutations p1,p2,\xe2\x80\xa6,pn such that, for all 1\xe2\x89\xa4i\xe2\x89\xa4m,   pi<pi+1 if si= ""<"";  pi>pi+1 if si= "">"".  As the result can be very large, you should print it modulo 998244353." 3500.0                                           
     1654E "Arithmetic Operations" "brute force,data structures,graphs,math" "You are given an array of integers a1,a2,\xe2\x80\xa6,an.You can do the following operation any number of times (possibly zero):   Choose any index i and set ai to any integer (positive, negative or 0). What is the minimum number of operations needed to turn a into an arithmetic progression? The array a is an arithmetic progression if ai+1\xe2\x88\x92ai=ai\xe2\x88\x92ai\xe2\x88\x921 for any 2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921." 2300.0                                           
     1651E "Sum of Matchings" "brute force,combinatorics,constructive algorithms,dfs and similar,graph matchings,greedy,math" "Let\'s denote the size of the maximum matching in a graph G as MM(G).You are given a bipartite graph. The vertices of the first part are numbered from 1 to n, the vertices of the second part are numbered from n+1 to 2n. Each vertex\'s degree is 2.For a tuple of four integers (l,r,L,R), where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and n+1\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa42n, let\'s define G\xe2\x80\xb2(l,r,L,R) as the graph which consists of all vertices of the given graph that are included in the segment [l,r] or in the segment [L,R], and all edges of the given graph such that each of their endpoints belongs to one of these segments. In other words, to obtain G\xe2\x80\xb2(l,r,L,R) from the original graph, you have to remove all vertices i such that i\xe2\x88\x89[l,r] and i\xe2\x88\x89[L,R], and all edges incident to these vertices.Calculate the sum of MM(G(l,r,L,R)) over all tuples of integers (l,r,L,R) having 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and n+1\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa42n." 2600.0                                           
     1650F "Vitaly and Advanced Useless Algorithms" dp,greedy,implementation "Vitaly enrolled in the course Advanced Useless Algorithms. The course consists of n tasks. Vitaly calculated that he has ai hours to do the task i from the day he enrolled in the course. That is, the deadline before the i-th task is ai hours. The array a is sorted in ascending order, in other words, the job numbers correspond to the order in which the assignments are turned in.Vitaly does everything conscientiously, so he wants to complete each task by 100 percent, or more. Initially, his completion rate for each task is 0 percent.Vitaly has m training options, each option can be used not more than once. The ith option is characterized by three integers: ei,ti and pi. If Vitaly uses the ith option, then after ti hours (from the current moment) he will increase the progress of the task ei by pi percent. For example, let Vitaly have 3 of tasks to complete. Let the array a have the form: a=[5,7,8]. Suppose Vitaly has 5 of options: [e1=1,t1=1,p1=30], [e2=2,t2=3,p2=50], [e3=2,t3=3,p3=100], [e4=1,t4=1,p4=80], [e5=3,t5=3,p5=100]. Then, if Vitaly prepares in the following way, he will be able to complete everything in time:   Vitaly chooses the 4-th option. Then in 1 hour, he will complete the 1-st task at 80 percent. He still has 4 hours left before the deadline for the 1-st task.  Vitaly chooses the 3-rd option. Then in 3 hours, he will complete the 2-nd task in its entirety. He has another 1 hour left before the deadline for the 1-st task and 4 hours left before the deadline for the 3-rd task.  Vitaly chooses the 1-st option. Then after 1 hour, he will complete the 1-st task for 110 percent, which means that he will complete the 1-st task just in time for the deadline.  Vitaly chooses the 5-th option. He will complete the 3-rd task for 2 hours, and after another 1 hour, Vitaly will complete the 3-rd task in its entirety. Thus, Vitaly has managed to complete the course completely and on time, using the 4 options.Help Vitaly \xe2\x80\x94 print the options for Vitaly to complete the tasks in the correct order. Please note: each option can be used not more than once. If there are several possible answers, it is allowed to output any of them." 2200.0                                           
     1650C "Weight of the System of Nested Segments" greedy,hashing,implementation,sortings "On the number line there are m points, i-th of which has integer coordinate xi and integer weight wi. The coordinates of all points are different, and the points are numbered from 1 to m.A sequence of n segments [l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn] is called system of nested segments if for each pair i,j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) the condition li<lj<rj<ri is satisfied. In other words, the second segment is strictly inside the first one, the third segment is strictly inside the second one, and so on.For a given number n, find a system of nested segments such that:  both ends of each segment are one of m given points;  the sum of the weights 2\xe2\x8b\x85n of the points used as ends of the segments is minimal. For example, let m=8. The given points are marked in the picture, their weights are marked in red, their coordinates are marked in blue. Make a system of three nested segments:  weight of the first segment: 1+1=2  weight of the second segment: 10+(\xe2\x88\x921)=9  weight of the third segment: 3+(\xe2\x88\x922)=1  sum of the weights of all the segments in the system: 2+9+1=12   System of three nested segments" 1200.0                                           
     1647E "Madoka and the Sixth-graders" "data structures,dfs and similar,greedy" "After the most stunning success with the fifth-graders, Madoka has been trusted with teaching the sixth-graders.There\'s n single-place desks in her classroom. At the very beginning Madoka decided that the student number bi (1\xe2\x89\xa4bi\xe2\x89\xa4n) will sit at the desk number i. Also there\'s an infinite line of students with numbers n+1,n+2,n+3,\xe2\x80\xa6 waiting at the door with the hope of being able to learn something from the Madoka herself. Pay attention that each student has his unique number.After each lesson, the following happens in sequence.   The student sitting at the desk i moves to the desk pi. All students move simultaneously.  If there is more than one student at a desk, the student with the lowest number keeps the place, and the others are removed from the class forever.  For all empty desks in ascending order, the student from the lowest number from the outside line occupies the desk. Note that in the end there is exactly one student at each desk again. It is guaranteed that the numbers p are such that at least one student is removed after each lesson. Check out the explanation to the first example for a better understanding.After several (possibly, zero) lessons the desk i is occupied by student ai. Given the values a1,a2,\xe2\x80\xa6,an and p1,p2,\xe2\x80\xa6,pn, find the lexicographically smallest suitable initial seating permutation b1,b2,\xe2\x80\xa6,bn.The permutation is an array of n different integers from 1 up to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not (2 occurs twice). [1,3,4] is not a permutation either (n=3 but there\'s 4 in the array).For two different permutations a and b of the same length, a is lexicographically less than b if in the first position where a and b differ, the permutation a has a smaller element than the corresponding element in b." 2500.0                                           
     1641B "Repetitions Decoding" "constructive algorithms,implementation,sortings" "Olya has an array of integers a1,a2,\xe2\x80\xa6,an. She wants to split it into tandem repeats. Since it\'s rarely possible, before that she wants to perform the following operation several (possibly, zero) number of times: insert a pair of equal numbers into an arbitrary position. Help her!More formally:  A tandem repeat is a sequence x of even length 2k such that for each 1\xe2\x89\xa4i\xe2\x89\xa4k the condition xi=xi+k is satisfied.  An array a could be split into tandem repeats if you can split it into several parts, each being a subsegment of the array, such that each part is a tandem repeat.  In one operation you can choose an arbitrary letter c and insert [c,c] to any position in the array (at the beginning, between any two integers, or at the end).  You are to perform several operations and split the array into tandem repeats or determine that it is impossible. Please note that you do not have to minimize the number of operations." 2000.0                                           
     1638D "Big Brush" "constructive algorithms,data structures,greedy,implementation" "You found a painting on a canvas of size n\xc3\x97m. The canvas can be represented as a grid with n rows and m columns. Each cell has some color. Cell (i,j) has color ci,j.Near the painting you also found a brush in the shape of a 2\xc3\x972 square, so the canvas was surely painted in the following way: initially, no cell was painted. Then, the following painting operation has been performed some number of times:  Choose two integers i and j (1\xe2\x89\xa4i<n, 1\xe2\x89\xa4j<m) and some color k (1\xe2\x89\xa4k\xe2\x89\xa4nm).  Paint cells (i,j), (i+1,j), (i,j+1), (i+1,j+1) in color k. All cells must be painted at least once. A cell can be painted multiple times. In this case, its final color will be the last one.Find any sequence of at most nm operations that could have led to the painting you found or state that it\'s impossible." 2000.0                                           
     1637G Birthday "constructive algorithms,greedy,math" "Vitaly gave Maxim n numbers 1,2,\xe2\x80\xa6,n for his 16-th birthday. Maxim was tired of playing board games during the celebration, so he decided to play with these numbers. In one step Maxim can choose two numbers x and y from the numbers he has, throw them away, and add two numbers x+y and |x\xe2\x88\x92y| instead. He wants all his numbers to be equal after several steps and the sum of the numbers to be minimal.Help Maxim to find a solution. Maxim\'s friends don\'t want to wait long, so the number of steps in the solution should not exceed 20n. It is guaranteed that under the given constraints, if a solution exists, then there exists a solution that makes all numbers equal, minimizes their sum, and spends no more than 20n moves." 3000.0                                           
     1633A "Div. 7" "brute force" "You are given an integer n. You have to change the minimum number of digits in it in such a way that the resulting number does not have any leading zeroes and is divisible by 7.If there are multiple ways to do it, print any of them. If the given number is already divisible by 7, leave it unchanged." 800.0                                           
     1632B "Roof Construction" "bitmasks,constructive algorithms" "It has finally been decided to build a roof over the football field in School 179. Its construction will require placing n consecutive vertical pillars. Furthermore, the headmaster wants the heights of all the pillars to form a permutation p of integers from 0 to n\xe2\x88\x921, where pi is the height of the i-th pillar from the left (1\xe2\x89\xa4i\xe2\x89\xa4n).As the chief, you know that the cost of construction of consecutive pillars is equal to the maximum value of the bitwise XOR of heights of all pairs of adjacent pillars. In other words, the cost of construction is equal to max1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921pi\xe2\x8a\x95pi+1, where \xe2\x8a\x95 denotes the bitwise XOR operation.Find any sequence of pillar heights p of length n with the smallest construction cost.In this problem, a permutation is an array consisting of n distinct integers from 0 to n\xe2\x88\x921 in arbitrary order. For example, [2,3,1,0,4] is a permutation, but [1,0,1] is not a permutation (1 appears twice in the array) and [1,0,3] is also not a permutation (n=3, but 3 is in the array)." 1000.0                                           
     1628E "Groceries in Meteor Town" "binary search,data structures,dsu,trees" "Mihai lives in a town where meteor storms are a common problem. It\'s annoying, because Mihai has to buy groceries sometimes, and getting hit by meteors isn\'t fun. Therefore, we ask you to find the most dangerous way to buy groceries so that we can trick him to go there.The town has n buildings numbered from 1 to n. Some buildings have roads between them, and there is exactly 1 simple path from any building to any other building. Each road has a certain meteor danger level. The buildings all have grocery stores, but Mihai only cares about the open ones, of course. Initially, all the grocery stores are closed.You are given q queries of three types:  Given the integers l and r, the buildings numbered from l to r open their grocery stores (nothing happens to buildings in the range that already have an open grocery store). Given the integers l and r, the buildings numbered from l to r close their grocery stores (nothing happens to buildings in the range that didn\'t have an open grocery store). Given the integer x, find the maximum meteor danger level on the simple path from x to any open grocery store, or \xe2\x88\x921 if there is no edge on any simple path to an open store." 3100.0                                           
     1624D "Palindromes Coloring" "binary search,greedy,sortings,strings" "You have a string s consisting of lowercase Latin alphabet letters. You can color some letters in colors from 1 to k. It is not necessary to paint all the letters. But for each color, there must be a letter painted in that color.Then you can swap any two symbols painted in the same color as many times as you want. After that, k strings will be created, i-th of them will contain all the characters colored in the color i, written in the order of their sequence in the string s.Your task is to color the characters of the string so that all the resulting k strings are palindromes, and the length of the shortest of these k strings is as large as possible.Read the note for the first test case of the example if you need a clarification.Recall that a string is a palindrome if it reads the same way both from left to right and from right to left. For example, the strings abacaba, cccc, z and dxd are palindromes, but the strings abab and aaabaa \xe2\x80\x94 are not." 1400.0                                           
     1623B "Game on Ranges" "brute force,dfs and similar,implementation,sortings" "Alice and Bob play the following game. Alice has a set S of disjoint ranges of integers, initially containing only one range [1,n]. In one turn, Alice picks a range [l,r] from the set S and asks Bob to pick a number in the range. Bob chooses a number d (l\xe2\x89\xa4d\xe2\x89\xa4r). Then Alice removes [l,r] from S and puts into the set S the range [l,d\xe2\x88\x921] (if l\xe2\x89\xa4d\xe2\x88\x921) and the range [d+1,r] (if d+1\xe2\x89\xa4r). The game ends when the set S is empty. We can show that the number of turns in each game is exactly n.After playing the game, Alice remembers all the ranges [l,r] she picked from the set S, but Bob does not remember any of the numbers that he picked. But Bob is smart, and he knows he can find out his numbers d from Alice\'s ranges, and so he asks you for help with your programming skill.Given the list of ranges that Alice has picked ([l,r]), for each range, help Bob find the number d that Bob has picked.We can show that there is always a unique way for Bob to choose his number for a list of valid ranges picked by Alice." 1100.0                                           
     1622E "Math Test" "bitmasks,brute force,greedy" "Petya is a math teacher. n of his students has written a test consisting of m questions. For each student, it is known which questions he has answered correctly and which he has not.If the student answers the j-th question correctly, he gets pj points (otherwise, he gets 0 points). Moreover, the points for the questions are distributed in such a way that the array p is a permutation of numbers from 1 to m.For the i-th student, Petya knows that he expects to get xi points for the test. Petya wonders how unexpected the results could be. Petya believes that the surprise value of the results for students is equal to n\xe2\x88\x91i=1|xi\xe2\x88\x92ri|, where ri is the number of points that the i-th student has got for the test.Your task is to help Petya find such a permutation p for which the surprise value of the results is maximum possible. If there are multiple answers, print any of them." 2200.0                                           
     1622D Shuffle "combinatorics,math,two pointers" "You are given a binary string (i.\xe2\x80\x89e. a string consisting of characters 0 and/or 1) s of length n. You can perform the following operation with the string s at most once: choose a substring (a contiguous subsequence) of s having exactly k characters 1 in it, and shuffle it (reorder the characters in the substring as you wish).Calculate the number of different strings which can be obtained from s by performing this operation at most once." 2000.0                                           
     1619H "Permutation and Queries" "brute force,data structures,divide and conquer,two pointers" "You are given a permutation p of n elements. A permutation of n elements is an array of length n containing each integer from 1 to n exactly once. For example, [1,2,3] and [4,3,5,1,2] are permutations, but [1,2,4] and [4,3,2,1,2] are not permutations. You should perform q queries.There are two types of queries:  1 x y \xe2\x80\x94 swap px and py.  2 i k \xe2\x80\x94 print the number that i will become if we assign i=pi k times." 2400.0                                           
     1618E "Singers\' Tour" "constructive algorithms,math" "n towns are arranged in a circle sequentially. The towns are numbered from 1 to n in clockwise order. In the i-th town, there lives a singer with a repertoire of ai minutes for each i\xe2\x88\x88[1,n].Each singer visited all n towns in clockwise order, starting with the town he lives in, and gave exactly one concert in each town. In addition, in each town, the i-th singer got inspired and came up with a song that lasts ai minutes. The song was added to his repertoire so that he could perform it in the rest of the cities.Hence, for the i-th singer, the concert in the i-th town will last ai minutes, in the (i+1)-th town the concert will last 2\xe2\x8b\x85ai minutes, ..., in the ((i+k)modn+1)-th town the duration of the concert will be (k+2)\xe2\x8b\x85ai, ..., in the town ((i+n\xe2\x88\x922)modn+1) \xe2\x80\x94 n\xe2\x8b\x85ai minutes.You are given an array of b integer numbers, where bi is the total duration of concerts in the i-th town. Reconstruct any correct sequence of positive integers a or say that it is impossible." 1700.0                                           
     1618D "Array and Operations" dp,greedy,math "You are given an array a of n integers, and another integer k such that 2k\xe2\x89\xa4n.You have to perform exactly k operations with this array. In one operation, you have to choose two elements of the array (let them be ai and aj; they can be equal or different, but their positions in the array must not be the same), remove them from the array, and add \xe2\x8c\x8aaiaj\xe2\x8c\x8b to your score, where \xe2\x8c\x8axy\xe2\x8c\x8b is the maximum integer not exceeding xy.Initially, your score is 0. After you perform exactly k operations, you add all the remaining elements of the array to the score.Calculate the minimum possible score you can get." 1300.0                                           
     1617B "GCD Problem" "brute force,constructive algorithms,math,number theory" "Given a positive integer n. Find three distinct positive integers a, b, c such that a+b+c=n and gcd(a,b)=c, where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y." 900.0                                           
     1614C "Divan and bitwise operations" "bitmasks,combinatorics,constructive algorithms,dp,math" "Once Divan analyzed a sequence a1,a2,\xe2\x80\xa6,an consisting of n non-negative integers as follows. He considered each non-empty subsequence of the sequence a, computed the bitwise XOR of its elements and added up all the XORs, obtaining the coziness of the sequence a.A sequence c is a subsequence of a sequence d if c can be obtained from d by deletion of several (possibly, zero or all) elements. For example, [1,2,3,4], [2,4], and [2] are subsequences of [1,2,3,4], but [4,3] and [0] are not.Divan was very proud of his analysis, but now he lost the sequence a, and also the coziness value! However, Divan remembers the value of bitwise OR on m contiguous subsegments of the sequence a. It turns out that each element of the original sequence is contained in at least one of these m segments.Divan asks you to help find the coziness of the sequence a using the information he remembers. If several coziness values are possible, print any.As the result can be very large, print the value modulo 109+7." 1500.0                                           
     1612F "Armor and Weapons" "brute force,dp,greedy,shortest paths" "Monocarp plays a computer game. There are n different sets of armor and m different weapons in this game. If a character equips the i-th set of armor and wields the j-th weapon, their power is usually equal to i+j; but some combinations of armor and weapons synergize well. Formally, there is a list of q ordered pairs, and if the pair (i,j) belongs to this list, the power of the character equipped with the i-th set of armor and wielding the j-th weapon is not i+j, but i+j+1.Initially, Monocarp\'s character has got only the 1-st armor set and the 1-st weapon. Monocarp can obtain a new weapon or a new set of armor in one hour. If he wants to obtain the k-th armor set or the k-th weapon, he must possess a combination of an armor set and a weapon that gets his power to k or greater. Of course, after Monocarp obtains a weapon or an armor set, he can use it to obtain new armor sets or weapons, but he can go with any of the older armor sets and/or weapons as well.Monocarp wants to obtain the n-th armor set and the m-th weapon. What is the minimum number of hours he has to spend on it?" 2800.0                                           
     1611F "ATM and Students" "binary search,data structures,two pointers" "Polycarp started working at a bank. He was assigned to monitor the ATM. The ATM initially contains s rubles.A queue of n students lined up to him. Each student wants to either withdraw a certain amount of money or deposit it into an account. If ai is positive, then the student credits that amount of money via ATM. Otherwise, the student withdraws |ai| rubles.In the beginning, the ATM is turned off and an arbitrary number of students are not served. At some point, Polycarp turns on the ATM, which has an initial amount of s rubles. Then, the remaining students start queueing at the ATM. If at some point in time there is less money in the ATM than the student wants to withdraw, then the student is not served and Polycarp turns off the ATM and does not turn it on anymore.More formally, the students that are served are forming a contiguous subsequence.Polycarp wants the ATM to serve the maximum number of students. Help him in this matter. Print the numbers of the first and last student, or determine that he will not be able to serve anyone.In other words, find such a longest continuous segment of students that, starting with the sum of s at the ATM, all these students will be served. ATM serves students consistently (i.e. one after another in the order of the queue)." 1800.0                                           
     1611C "Polycarp Recovers the Permutation" "constructive algorithms" "Polycarp wrote on a whiteboard an array p of length n, which is a permutation of numbers from 1 to n. In other words, in p each number from 1 to n occurs exactly once.He also prepared a resulting array a, which is initially empty (that is, it has a length of 0).After that, he did exactly n steps. Each step looked like this:  Look at the leftmost and rightmost elements of p, and pick the smaller of the two. If you picked the leftmost element of p, append it to the left of a; otherwise, if you picked the rightmost element of p, append it to the right of a. The picked element is erased from p. Note that on the last step, p has a length of 1 and its minimum element is both leftmost and rightmost. In this case, Polycarp can choose what role the minimum element plays. In other words, this element can be added to a both on the left and on the right (at the discretion of Polycarp).Let\'s look at an example. Let n=4, p=[3,1,4,2]. Initially a=[]. Then: During the first step, the minimum is on the right (with a value of 2), so after this step, p=[3,1,4] and a=[2] (he added the value 2 to the right).  During the second step, the minimum is on the left (with a value of 3), so after this step, p=[1,4] and a=[3,2] (he added the value 3 to the left).  During the third step, the minimum is on the left (with a value of 1), so after this step, p=[4] and a=[1,3,2] (he added the value 1 to the left).  During the fourth step, the minimum is both left and right (this value is 4). Let\'s say Polycarp chose the right option. After this step, p=[] and a=[1,3,2,4] (he added the value 4 to the right).Thus, a possible value of a after n steps could be a=[1,3,2,4].You are given the final value of the resulting array a. Find any possible initial value for p that can result the given a, or determine that there is no solution." 1000.0                                           
     1607H "Banquet Preparations 2" "greedy,sortings,two pointers" "The chef has cooked n dishes yet again: the i-th dish consists of ai grams of fish and bi grams of meat. Banquet organizers consider two dishes i and j equal if ai=aj and bi=bj at the same time.The banquet organizers estimate the variety of n dishes as follows. The variety of a set of dishes is equal to the number of different dishes in it. The less variety is, the better.In order to reduce the variety, a taster was invited. He will eat exactly mi grams of food from each dish. For each dish, the taster determines separately how much fish and how much meat he will eat. The only condition is that he will eat exactly mi grams of the i-th dish in total.Determine how much of what type of food the taster should eat from each dish so that the value of variety is the minimum possible. If there are several correct answers, you may output any of them." 2200.0                                           
     1606E Arena combinatorics,dp,math "There are n heroes fighting in the arena. Initially, the i-th hero has ai health points.The fight in the arena takes place in several rounds. At the beginning of each round, each alive hero deals 1 damage to all other heroes. Hits of all heroes occur simultaneously. Heroes whose health is less than 1 at the end of the round are considered killed.If exactly 1 hero remains alive after a certain round, then he is declared the winner. Otherwise, there is no winner.Your task is to calculate the number of ways to choose the initial health points for each hero ai, where 1\xe2\x89\xa4ai\xe2\x89\xa4x, so that there is no winner of the fight. The number of ways can be very large, so print it modulo 998244353. Two ways are considered different if at least one hero has a different amount of health. For example, [1,2,1] and [2,1,1] are different." 2100.0                                           
     1606A "AB Balance" strings "You are given a string s of length n consisting of characters a and/or b.Let AB(s) be the number of occurrences of string ab in s as a substring. Analogically, BA(s) is the number of occurrences of ba in s as a substring.In one step, you can choose any index i and replace si with character a or b.What is the minimum number of steps you need to make to achieve AB(s)=BA(s)?Reminder:The number of occurrences of string d in s as substring is the number of indices i (1\xe2\x89\xa4i\xe2\x89\xa4|s|\xe2\x88\x92|d|+1) such that substring sisi+1\xe2\x80\xa6si+|d|\xe2\x88\x921 is equal to d. For example, AB(aabbbabaa)=2 since there are two indices i: i=2 where aabbbabaa and i=6 where aabbbabaa." 900.0                                           
     1604B "XOR Specia-LIS-t"  "YouKn0wWho has an integer sequence a1,a2,\xe2\x80\xa6an. Now he will split the sequence a into one or more consecutive subarrays so that each element of a belongs to exactly one subarray. Let k be the number of resulting subarrays, and h1,h2,\xe2\x80\xa6,hk be the lengths of the longest increasing subsequences of corresponding subarrays.For example, if we split [2,5,3,1,4,3,2,2,5,1] into [2,5,3,1,4], [3,2,2,5], [1], then h=[3,2,1].YouKn0wWho wonders if it is possible to split the sequence a in such a way that the bitwise XOR of h1,h2,\xe2\x80\xa6,hk is equal to 0. You have to tell whether it is possible.The longest increasing subsequence (LIS) of a sequence b1,b2,\xe2\x80\xa6,bm is the longest sequence of valid indices i1,i2,\xe2\x80\xa6,ik such that i1<i2<\xe2\x80\xa6<ik and bi1<bi2<\xe2\x80\xa6<bik. For example, the LIS of [2,5,3,3,5] is [2,3,5], which has length 3.An array c is a subarray of an array b if c can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 1100.0                                           
     1602A "Two Subsequences" implementation "You are given a string s. You need to find two non-empty strings a and b such that the following conditions are satisfied:  Strings a and b are both subsequences of s.  For each index i, character si of string s must belong to exactly one of strings a or b.  String a is lexicographically minimum possible; string b may be any possible string. Given string s, print any valid a and b.Reminder:A string a (b) is a subsequence of a string s if a (b) can be obtained from s by deletion of several (possibly, zero) elements. For example, ""dores"", ""cf"", and ""for"" are subsequences of ""codeforces"", while ""decor"" and ""fork"" are not.A string x is lexicographically smaller than a string y if and only if one of the following holds:  x is a prefix of y, but x\xe2\x89\xa0y;  in the first position where x and y differ, the string x has a letter that appears earlier in the alphabet than the corresponding letter in y." 800.0                                           
     1599H "Hidden Fortress" interactive,math "This is an interactive problem!As part of your contribution in the Great Bubble War, you have been tasked with finding the newly built enemy fortress. The world you live in is a giant 109\xc3\x97109 grid, with squares having both coordinates between 1 and 109. You know that the enemy base has the shape of a rectangle, with the sides parallel to the sides of the grid. The people of your world are extremely scared of being at the edge of the world, so you know that the base doesn\'t contain any of the squares on the edges of the grid (the x or y coordinate being 1 or 109). To help you locate the base, you have been given a device that you can place in any square of the grid, and it will tell you the manhattan distance to the closest square of the base. The manhattan distance from square (a,b) to square (p,q) is calculated as |a\xe2\x88\x92p|+|b\xe2\x88\x92q|. If you try to place the device inside the enemy base, you will be captured by the enemy. Because of this, you need to make sure to never place the device inside the enemy base. Unfortunately, the device is powered by a battery and you can\'t recharge it. This means that you can use the device at most 40 times." 2100.0                                           
     1598C "Delete Two Elements" "data structures,dp,implementation,math,two pointers" "Monocarp has got an array a consisting of n integers. Let\'s denote k as the mathematic mean of these elements (note that it\'s possible that k is not an integer). The mathematic mean of an array of n elements is the sum of elements divided by the number of these elements (i.\xe2\x80\x89e. sum divided by n).Monocarp wants to delete exactly two elements from a so that the mathematic mean of the remaining (n\xe2\x88\x922) elements is still equal to k.Your task is to calculate the number of pairs of positions [i,j] (i<j) such that if the elements on these positions are deleted, the mathematic mean of (n\xe2\x88\x922) remaining elements is equal to k (that is, it is equal to the mathematic mean of n elements of the original array a)." 1200.0                                           
     1593A Elections math "The elections in which three candidates participated have recently ended. The first candidate received a votes, the second one received b votes, the third one received c votes. For each candidate, solve the following problem: how many votes should be added to this candidate so that he wins the election (i.e. the number of votes for this candidate was strictly greater than the number of votes for any other candidate)?Please note that for each candidate it is necessary to solve this problem independently, i.e. the added votes for any candidate do not affect the calculations when getting the answer for the other two candidates." 800.0                                           
     1592C "Bakry and Partitioning" "bitmasks,constructive algorithms,dfs and similar,dp,graphs,trees" "Bakry faced a problem, but since he\'s lazy to solve it, he asks for your help.You are given a tree of n nodes, the i-th node has value ai assigned to it for each i from 1 to n. As a reminder, a tree on n nodes is a connected graph with n\xe2\x88\x921 edges.You want to delete at least 1, but at most k\xe2\x88\x921 edges from the tree, so that the following condition would hold:For every connected component calculate the bitwise XOR of the values of the nodes in it. Then, these values have to be the same for all connected components.Is it possible to achieve this condition?" 1700.0                                           
     1592B "Hemose Shopping" "constructive algorithms,dsu,math,sortings" "Hemose was shopping with his friends Samez, AhmedZ, AshrafEzz, TheSawan and O_E in Germany. As you know, Hemose and his friends are problem solvers, so they are very clever. Therefore, they will go to all discount markets in Germany.Hemose has an array of n integers. He wants Samez to sort the array in the non-decreasing order. Since it would be a too easy problem for Samez, Hemose allows Samez to use only the following operation:Choose indices i and j such that 1\xe2\x89\xa4i,j\xe2\x89\xa4n, and |i\xe2\x88\x92j|\xe2\x89\xa5x. Then, swap elements ai and aj.Can you tell Samez if there\'s a way to sort the array in the non-decreasing order by using the operation written above some finite number of times (possibly 0)?" 1200.0                                           
     1585D "Yet Another Sorting Problem" "data structures,math" "Petya has an array of integers a1,a2,\xe2\x80\xa6,an. He only likes sorted arrays. Unfortunately, the given array could be arbitrary, so Petya wants to sort it.Petya likes to challenge himself, so he wants to sort array using only 3-cycles. More formally, in one operation he can pick 3 pairwise distinct indices i, j, and k (1\xe2\x89\xa4i,j,k\xe2\x89\xa4n) and apply i\xe2\x86\x92j\xe2\x86\x92k\xe2\x86\x92i cycle to the array a. It simultaneously places ai on position j, aj on position k, and ak on position i, without changing any other element.For example, if a is [10,50,20,30,40,60] and he chooses i=2, j=1, k=5, then the array becomes [50_,40_,20,30,10_,60].Petya can apply arbitrary number of 3-cycles (possibly, zero). You are to determine if Petya can sort his array a, i. e. make it non-decreasing." 1900.0                                           
     1585A "Life of a Flower" implementation "Petya has got an interesting flower. Petya is a busy person, so he sometimes forgets to water it. You are given n days from Petya\'s live and you have to determine what happened with his flower in the end.The flower grows as follows:   If the flower isn\'t watered for two days in a row, it dies.  If the flower is watered in the i-th day, it grows by 1 centimeter.  If the flower is watered in the i-th and in the (i\xe2\x88\x921)-th day (i>1), then it grows by 5 centimeters instead of 1.  If the flower is not watered in the i-th day, it does not grow. At the beginning of the 1-st day the flower is 1 centimeter tall. What is its height after n days?" 800.0                                           
     1584A "Mathematical Addition" math "Ivan decided to prepare for the test on solving integer equations. He noticed that all tasks in the test have the following form:  You are given two positive integers u and v, find any pair of integers (not necessarily positive) x, y, such that: xu+yv=x+yu+v.  The solution x=0, y=0 is forbidden, so you should find any solution with (x,y)\xe2\x89\xa0(0,0). Please help Ivan to solve some equations of this form." 800.0                                           
     1583H "Omkar and Tours" "data structures,divide and conquer,sortings,trees" "Omkar is hosting tours of his country, Omkarland! There are n cities in Omkarland, and, rather curiously, there are exactly n\xe2\x88\x921 bidirectional roads connecting the cities to each other. It is guaranteed that you can reach any city from any other city through the road network.Every city has an enjoyment value e. Each road has a capacity c, denoting the maximum number of vehicles that can be on it, and an associated toll t. However, the toll system in Omkarland has an interesting quirk: if a vehicle travels on multiple roads on a single journey, they pay only the highest toll of any single road on which they traveled. (In other words, they pay maxt over all the roads on which they traveled.) If a vehicle traverses no roads, they pay 0 toll.Omkar has decided to host q tour groups. Each tour group consists of v vehicles starting at city x. (Keep in mind that a tour group with v vehicles can travel only on roads with capacity \xe2\x89\xa5v.) Being the tour organizer, Omkar wants his groups to have as much fun as they possibly can, but also must reimburse his groups for the tolls that they have to pay. Thus, for each tour group, Omkar wants to know two things: first, what is the enjoyment value of the city y with maximum enjoyment value that the tour group can reach from their starting city, and second, how much per vehicle will Omkar have to pay to reimburse the entire group for their trip from x to y? (This trip from x to y will always be on the shortest path from x to y.)In the case that there are multiple reachable cities with the maximum enjoyment value, Omkar will let his tour group choose which one they want to go to. Therefore, to prepare for all possible scenarios, he wants to know the amount of money per vehicle that he needs to guarantee that he can reimburse the group regardless of which city they choose." 3300.0                                           
     1583G "Omkar and Time Travel" "data structures,math" "El Psy Kongroo.Omkar is watching Steins;Gate.In Steins;Gate, Okabe Rintarou needs to complete n tasks (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105). Unfortunately, he doesn\'t know when he needs to complete the tasks.Initially, the time is 0. Time travel will now happen according to the following rules:For each k=1,2,\xe2\x80\xa6,n, Okabe will realize at time bk that he was supposed to complete the k-th task at time ak (ak<bk). When he realizes this, if k-th task was already completed at time ak, Okabe keeps the usual flow of time. Otherwise, he time travels to time ak then immediately completes the task.If Okabe time travels to time ak, all tasks completed after this time will become incomplete again. That is, for every j, if aj>ak, the j-th task will become incomplete, if it was complete (if it was incomplete, nothing will change).Okabe has bad memory, so he can time travel to time ak only immediately after getting to time bk and learning that he was supposed to complete the k-th task at time ak. That is, even if Okabe already had to perform k-th task before, he wouldn\'t remember it before stumbling on the info about this task at time bk again.Please refer to the notes for an example of time travelling.There is a certain set s of tasks such that the first moment that all of the tasks in s are simultaneously completed (regardless of whether any other tasks are currently completed), a funny scene will take place. Omkar loves this scene and wants to know how many times Okabe will time travel before this scene takes place. Find this number modulo 109+7. It can be proven that eventually all n tasks will be completed and so the answer always exists." 3000.0                                           
     1583B "Omkar and Heavenly Tree" "constructive algorithms,trees" "Lord Omkar would like to have a tree with n nodes (3\xe2\x89\xa4n\xe2\x89\xa4105) and has asked his disciples to construct the tree. However, Lord Omkar has created m (1\xe2\x89\xa4m<n) restrictions to ensure that the tree will be as heavenly as possible. A tree with n nodes is an connected undirected graph with n nodes and n\xe2\x88\x921 edges. Note that for any two nodes, there is exactly one simple path between them, where a simple path is a path between two nodes that does not contain any node more than once.Here is an example of a tree:   A restriction consists of 3 pairwise distinct integers, a, b, and c (1\xe2\x89\xa4a,b,c\xe2\x89\xa4n). It signifies that node b cannot lie on the simple path between node a and node c. Can you help Lord Omkar and become his most trusted disciple? You will need to find heavenly trees for multiple sets of restrictions. It can be shown that a heavenly tree will always exist for any set of restrictions under the given constraints." 1200.0                                           
     1583A "Windblume Ode" "math,number theory" "A bow adorned with nameless flowers that bears the earnest hopes of an equally nameless person.You have obtained the elegant bow known as the Windblume Ode. Inscribed in the weapon is an array of n (n\xe2\x89\xa53) positive distinct integers (i.e. different, no duplicates are allowed).Find the largest subset (i.e. having the maximum number of elements) of this array such that its sum is a composite number. A positive integer x is called composite if there exists a positive integer y such that 1<y<x and x is divisible by y.If there are multiple subsets with this largest size with the composite sum, you can output any of them. It can be proven that under the constraints of the problem such a non-empty subset always exists." 800.0                                           
     1582G "Kuzya and Homework" "data structures,number theory" "Kuzya started going to school. He was given math homework in which he was given an array a of length n and an array of symbols b of length n, consisting of symbols \'*\' and \'/\'.Let\'s denote a path of calculations for a segment [l;r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) in the following way:   Let x=1 initially. For every i from l to r we will consequently do the following: if bi= \'*\', x=x\xe2\x88\x97ai, and if bi= \'/\', then x=xai. Let\'s call a path of calculations for the segment [l;r] a list of all x that we got during the calculations (the number of them is exactly r\xe2\x88\x92l+1). For example, let a=[7, 12, 3, 5, 4, 10, 9], b=[/, \xe2\x88\x97, /, /, /, \xe2\x88\x97, \xe2\x88\x97], l=2, r=6, then the path of calculations for that segment is [12, 4, 0.8, 0.2, 2].Let\'s call a segment [l;r] simple if the path of calculations for it contains only integer numbers. Kuzya needs to find the number of simple segments [l;r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). Since he obviously has no time and no interest to do the calculations for each option, he asked you to write a program to get to find that number!" 2600.0                                           
     1582F1 "Korney Korneevich and XOR (easy version)" bitmasks,dp,greedy "This is an easier version of the problem with smaller constraints.Korney Korneevich dag up an array a of length n. Korney Korneevich has recently read about the operation bitwise XOR, so he wished to experiment with it. For this purpose, he decided to find all integers x\xe2\x89\xa50 such that there exists an increasing subsequence of the array a, in which the bitwise XOR of numbers is equal to x.It didn\'t take a long time for Korney Korneevich to find all such x, and he wants to check his result. That\'s why he asked you to solve this problem!A sequence s is a subsequence of a sequence b if s can be obtained from b by deletion of several (possibly, zero or all) elements.A sequence s1,s2,\xe2\x80\xa6,sm is called increasing if s1<s2<\xe2\x80\xa6<sm." 1800.0                                           
     1582E "Pchelyonok and Segments" "binary search,data structures,dp,greedy,math" "Pchelyonok decided to give Mila a gift. Pchelenok has already bought an array a of length n, but gifting an array is too common. Instead of that, he decided to gift Mila the segments of that array!Pchelyonok wants his gift to be beautiful, so he decided to choose k non-overlapping segments of the array [l1,r1], [l2,r2], \xe2\x80\xa6 [lk,rk] such that:  the length of the first segment [l1,r1] is k, the length of the second segment [l2,r2] is k\xe2\x88\x921, \xe2\x80\xa6, the length of the k-th segment [lk,rk] is 1  for each i<j, the i-th segment occurs in the array earlier than the j-th (i.e. ri<lj)  the sums in these segments are strictly increasing (i.e. let sum(l\xe2\x80\xa6r)=r\xe2\x88\x91i=lai \xe2\x80\x94 the sum of numbers in the segment [l,r] of the array, then sum(l1\xe2\x80\xa6r1)<sum(l2\xe2\x80\xa6r2)<\xe2\x80\xa6<sum(lk\xe2\x80\xa6rk)). Pchelenok also wants his gift to be as beautiful as possible, so he asks you to find the maximal value of k such that he can give Mila a gift!" 2000.0                                           
     1582B "Luntik and Subsequences" combinatorics,math "Luntik came out for a morning stroll and found an array a of length n. He calculated the sum s of the elements of the array (s=\xe2\x88\x91ni=1ai). Luntik calls a subsequence of the array a nearly full if the sum of the numbers in that subsequence is equal to s\xe2\x88\x921.Luntik really wants to know the number of nearly full subsequences of the array a. But he needs to come home so he asks you to solve that problem!A sequence x is a subsequence of a sequence y if x can be obtained from y by deletion of several (possibly, zero or all) elements." 900.0                                           
     1580F "Problems for Codeforces" combinatorics,fft,math "XYMXYM and CQXYM will prepare n problems for Codeforces. The difficulty of the problem i will be an integer ai, where ai\xe2\x89\xa50. The difficulty of the problems must satisfy ai+ai+1<m (1\xe2\x89\xa4i<n), and a1+an<m, where m is a fixed integer. XYMXYM wants to know how many plans of the difficulty of the problems there are modulo 998244353.Two plans of difficulty a and b are different only if there is an integer i (1\xe2\x89\xa4i\xe2\x89\xa4n) satisfying ai\xe2\x89\xa0bi." 3300.0                                           
     1578I "Interactive Rays" geometry,interactive "This is an interactive problem.Your goal is to find a circle on a plane by shooting rays and getting the distance to the circle as a result. Interactor has three hidden integer parameters that are determined in advance for each test, but which you don\'t know \xe2\x80\x94 xc, yc, and rc. (xc,yc) are coordinates of the circle\'s center and rc is its radius. The absolute values of xc, yc, and rc do not exceed 105, and 1\xe2\x89\xa4rc\xe2\x89\xa4\xe2\x88\x9ax2c+y2c\xe2\x88\x921.You can shoot rays that extend from the origin (0,0) and go via a point (xq,yq) with the integer coordinates you specify. For each ray, you get a distance from the ray to the circle or 0 if the ray intersects the circle." 3300.0                                           
     1578D "Dragon Curve"  "A dragon curve is a self-similar fractal curve. In this problem, it is a curve that consists of straight-line segments of the same length connected at right angles. A simple way to construct a dragon curve is as follows: take a strip of paper, fold it in half n times in the same direction, then partially unfold it such that the segments are joined at right angles. This is illustrated here:  In this example, a dragon curve of order 3 is constructed. In general, a dragon curve of a higher order will have a dragon curve of a lower order as its prefix. This allows us to define a dragon curve of infinite order, which is the limit of dragon curves of a finite order as the order approaches infinity.Consider four dragon curves of infinite order. Each starts at the origin (the point (0,0)), and the length of each segment is \xe2\x88\x9a2. The first segments of the curves end at the points (1,1), (\xe2\x88\x921,1), (\xe2\x88\x921,\xe2\x88\x921) and (1,\xe2\x88\x921), respectively. The first turn of each curve is left (that is, the second segment of the first curve ends at the point (0,2)). In this case, every segment is a diagonal of an axis-aligned unit square with integer coordinates, and it can be proven that there is exactly one segment passing through every such square.Given a point (x,y), your task is to find on which of the four curves lies the segment passing through the square with the opposite corners at (x,y) and (x+1,y+1), as well as the position of that segment on that curve. The curves are numbered 1 through 4. Curve 1 goes through (1,1), 2 through (\xe2\x88\x921,1), 3 through (\xe2\x88\x921,\xe2\x88\x921), and 4 through (1,\xe2\x88\x921). The segments are numbered starting with 1." 3200.0                                           
     1575K "Knitting Batik" implementation,math "Mr. Chanek wants to knit a batik, a traditional cloth from Indonesia. The cloth forms a grid a with size n\xc3\x97m. There are k colors, and each cell in the grid can be one of the k colors.Define a sub-rectangle as an ordered pair of two cells ((x1,y1),(x2,y2)), denoting the top-left cell and bottom-right cell (inclusively) of a sub-rectangle in a. Two sub-rectangles ((x1,y1),(x2,y2)) and ((x3,y3),(x4,y4)) have the same pattern if and only if the following holds:   they have the same width (x2\xe2\x88\x92x1=x4\xe2\x88\x92x3);  they have the same height (y2\xe2\x88\x92y1=y4\xe2\x88\x92y3);  for every pair (i,j) where 0\xe2\x89\xa4i\xe2\x89\xa4x2\xe2\x88\x92x1 and 0\xe2\x89\xa4j\xe2\x89\xa4y2\xe2\x88\x92y1, the color of cells (x1+i,y1+j) and (x3+i,y3+j) are equal. Count the number of possible batik color combinations, such that the subrectangles ((ax,ay),(ax+r\xe2\x88\x921,ay+c\xe2\x88\x921)) and ((bx,by),(bx+r\xe2\x88\x921,by+c\xe2\x88\x921)) have the same pattern.Output the answer modulo 109+7." 2200.0                                           
     1575H "Holiday Wall Ornaments" dp,strings "The Winter holiday will be here soon. Mr. Chanek wants to decorate his house\'s wall with ornaments. The wall can be represented as a binary string a of length n. His favorite nephew has another binary string b of length m (m\xe2\x89\xa4n).Mr. Chanek\'s nephew loves the non-negative integer k. His nephew wants exactly k occurrences of b as substrings in a. However, Mr. Chanek does not know the value of k. So, for each k (0\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x92m+1), find the minimum number of elements in a that have to be changed such that there are exactly k occurrences of b in a.A string s occurs exactly k times in t if there are exactly k different pairs (p,q) such that we can obtain s by deleting p characters from the beginning and q characters from the end of t." 2200.0                                           
     1575F "Finding Expected Value" math "Mr. Chanek opened a letter from his fellow, who is currently studying at Singanesia. Here is what it says.Define an array b (0\xe2\x89\xa4bi<k) with n integers. While there exists a pair (i,j) such that bi\xe2\x89\xa0bj, do the following operation:  Randomly pick a number i satisfying 0\xe2\x89\xa4i<n. Note that each number i has a probability of 1n to be picked.  Randomly Pick a number j satisfying 0\xe2\x89\xa4j<k.  Change the value of bi to j. It is possible for bi to be changed to the same value. Denote f(b) as the expected number of operations done to b until all elements of b are equal. You are given two integers n and k, and an array a (\xe2\x88\x921\xe2\x89\xa4ai<k) of n integers. For every index i with ai=\xe2\x88\x921, replace ai with a random number j satisfying 0\xe2\x89\xa4j<k. Let c be the number of occurrences of \xe2\x88\x921 in a. There are kc possibilites of a after the replacement, each with equal probability of being the final array.Find the expected value of f(a) modulo 109+7. Formally, let M=109+7. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM).After reading the letter, Mr. Chanek gave the task to you. Solve it for the sake of their friendship!" 2900.0                                           
     1575D "Divisible by Twenty-Five" "brute force,dfs and similar,dp" "Mr. Chanek has an integer represented by a string s. Zero or more digits have been erased and are denoted by the character _. There are also zero or more digits marked by the character X, meaning they\'re the same digit.Mr. Chanek wants to count the number of possible integer s, where s is divisible by 25. Of course, s must not contain any leading zero. He can replace the character _ with any digit. He can also replace the character X with any digit, but it must be the same for every character X.As a note, a leading zero is any 0 digit that comes before the first nonzero digit in a number string in positional notation. For example, 0025 has two leading zeroes. An exception is the integer zero, (0 has no leading zero, but 0000 has three leading zeroes)." 1800.0                                           
     1574C "Slay the Dragon" "binary search,greedy,sortings,ternary search" "Recently, Petya learned about a new game ""Slay the Dragon"". As the name suggests, the player will have to fight with dragons. To defeat a dragon, you have to kill it and defend your castle. To do this, the player has a squad of n heroes, the strength of the i-th hero is equal to ai.According to the rules of the game, exactly one hero should go kill the dragon, all the others will defend the castle. If the dragon\'s defense is equal to x, then you have to send a hero with a strength of at least x to kill it. If the dragon\'s attack power is y, then the total strength of the heroes defending the castle should be at least y.The player can increase the strength of any hero by 1 for one gold coin. This operation can be done any number of times.There are m dragons in the game, the i-th of them has defense equal to xi and attack power equal to yi. Petya was wondering what is the minimum number of coins he needs to spend to defeat the i-th dragon.Note that the task is solved independently for each dragon (improvements are not saved)." 1300.0                                           
     1571A "Sequence of Comparisons" "*special problem" "Once upon a time, Petya had an array of integers a of length n. But over time, the array itself was lost, and only n\xe2\x88\x921 results of comparisons of neighboring array elements remained. In other words, for every i from 1 to n\xe2\x88\x921, Petya knows exactly one of these three facts:  ai<ai+1;  ai=ai+1;  ai>ai+1. Petya wonders if it is possible to uniquely determine the result of comparing a1 and an.You have to help Petya determine the result of comparing a1 and an or report that the result cannot be determined unambiguously." 800.0                                           
     1569F "Palindromic Hamiltonian Path" "brute force,dfs and similar,dp,graphs,hashing" "You are given a simple undirected graph with n vertices, n is even. You are going to write a letter on each vertex. Each letter should be one of the first k letters of the Latin alphabet.A path in the graph is called Hamiltonian if it visits each vertex exactly once. A string is called palindromic if it reads the same from left to right and from right to left. A path in the graph is called palindromic if the letters on the vertices in it spell a palindromic string without changing the order.A string of length n is good if:   each letter is one of the first k lowercase Latin letters;  if you write the i-th letter of the string on the i-th vertex of the graph, there will exist a palindromic Hamiltonian path in the graph. Note that the path doesn\'t necesserily go through the vertices in order 1,2,\xe2\x80\xa6,n.Count the number of good strings." 3000.0                                           
     1567B "MEXor Mixup" bitmasks,greedy "Alice gave Bob two integers a and b (a>0 and b\xe2\x89\xa50). Being a curious boy, Bob wrote down an array of non-negative integers with MEX value of all elements equal to a and XOR value of all elements equal to b.What is the shortest possible length of the array Bob wrote?Recall that the MEX (Minimum EXcluded) of an array is the minimum non-negative integer that does not belong to the array and the XOR of an array is the bitwise XOR of all the elements of the array." 1000.0                                           
     1562E "Rescue Niwen!" "dp,greedy,string suffix structures,strings" "Morning desert sun horizonRise above the sands of time...Fates Warning, ""Exodus""After crossing the Windswept Wastes, Ori has finally reached the Windtorn Ruins to find the Heart of the Forest! However, the ancient repository containing this priceless Willow light did not want to open!Ori was taken aback, but the Voice of the Forest explained to him that the cunning Gorleks had decided to add protection to the repository.The Gorleks were very fond of the ""string expansion"" operation. They were also very fond of increasing subsequences.Suppose a string s1s2s3\xe2\x80\xa6sn is given. Then its ""expansion"" is defined as the sequence of strings s1, s1s2, ..., s1s2\xe2\x80\xa6sn, s2, s2s3, ..., s2s3\xe2\x80\xa6sn, s3, s3s4, ..., sn\xe2\x88\x921sn, sn. For example, the ""expansion"" the string \'abcd\' will be the following sequence of strings: \'a\', \'ab\', \'abc\', \'abcd\', \'b\', \'bc\', \'bcd\', \'c\', \'cd\', \'d\'. To open the ancient repository, Ori must find the size of the largest increasing subsequence of the ""expansion"" of the string s. Here, strings are compared lexicographically.Help Ori with this task!A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 2500.0                                           
     1560C "Infinity Table" implementation,math "Polycarp has found a table having an infinite number of rows and columns. The rows are numbered from 1, starting from the topmost one. The columns are numbered from 1, starting from the leftmost one.Initially, the table hasn\'t been filled and Polycarp wants to fix it. He writes integers from 1 and so on to the table as follows.  The figure shows the placement of the numbers from 1 to 10. The following actions are denoted by the arrows. The leftmost topmost cell of the table is filled with the number 1. Then he writes in the table all positive integers beginning from 2 sequentially using the following algorithm.First, Polycarp selects the leftmost non-filled cell in the first row and fills it. Then, while the left neighbor of the last filled cell is filled, he goes down and fills the next cell. So he goes down until the last filled cell has a non-filled neighbor to the left (look at the vertical arrow going down in the figure above).After that, he fills the cells from the right to the left until he stops at the first column (look at the horizontal row in the figure above). Then Polycarp selects the leftmost non-filled cell in the first row, goes down, and so on.A friend of Polycarp has a favorite number k. He wants to know which cell will contain the number. Help him to find the indices of the row and the column, such that the intersection of the row and the column is the cell containing the number k." 800.0                                           
     1558B "Up the Strip" "brute force,dp,math,number theory,two pointers" "Note that the memory limit in this problem is lower than in others.You have a vertical strip with n cells, numbered consecutively from 1 to n from top to bottom.You also have a token that is initially placed in cell n. You will move the token up until it arrives at cell 1.Let the token be in cell x>1 at some moment. One shift of the token can have either of the following kinds:   Subtraction: you choose an integer y between 1 and x\xe2\x88\x921, inclusive, and move the token from cell x to cell x\xe2\x88\x92y.  Floored division: you choose an integer z between 2 and x, inclusive, and move the token from cell x to cell \xe2\x8c\x8axz\xe2\x8c\x8b (x divided by z rounded down). Find the number of ways to move the token from cell n to cell 1 using one or more shifts, and print it modulo m. Note that if there are several ways to move the token from one cell to another in one shift, all these ways are considered distinct (check example explanation for a better understanding)." 1900.0                                           
     1556F "Sports Betting" bitmasks,combinatorics,dp,graphs,math,probabilities "William is not only interested in trading but also in betting on sports matches. n teams participate in each match. Each team is characterized by strength ai. Each two teams i<j play with each other exactly once. Team i wins with probability aiai+aj and team j wins with probability ajai+aj.The team is called a winner if it directly or indirectly defeated all other teams. Team a defeated (directly or indirectly) team b if there is a sequence of teams c1, c2, ... ck such that c1=a, ck=b and team ci defeated team ci+1 for all i from 1 to k\xe2\x88\x921. Note that it is possible that team a defeated team b and in the same time team b defeated team a.William wants you to find the expected value of the number of winners." 2500.0                                           
     1556E Equilibrium "data structures,dp,greedy" "William has two arrays aa and bb, each consisting of nn items.For some segments l..rl..r of these arrays William wants to know if it is possible to equalize the values of items in these segments using a balancing operation. Formally, the values are equalized if for each ii from ll to rr holds ai=biai=bi.To perform a balancing operation an even number of indices must be selected, such that l\xe2\x89\xa4pos1<pos2<\xe2\x8b\xaf<posk\xe2\x89\xa4rl\xe2\x89\xa4pos1<pos2<\xe2\x8b\xaf<posk\xe2\x89\xa4r. Next the items of array a at positions pos1,pos3,pos5,\xe2\x80\xa6pos1,pos3,pos5,\xe2\x80\xa6 get incremented by one and the items of array b at positions pos2,pos4,pos6,\xe2\x80\xa6pos2,pos4,pos6,\xe2\x80\xa6 get incremented by one.William wants to find out if it is possible to equalize the values of elements in two arrays for each segment using some number of balancing operations, and what is the minimal number of operations required for that. Note that for each segment the operations are performed independently." 2200.0                                           
     1553I Stairs "combinatorics,divide and conquer,dp,fft,math" "For a permutation p of numbers 1 through n, we define a stair array a as follows: ai is length of the longest segment of permutation which contains position i and is made of consecutive values in sorted order: [x,x+1,\xe2\x80\xa6,y\xe2\x88\x921,y] or [y,y\xe2\x88\x921,\xe2\x80\xa6,x+1,x] for some x\xe2\x89\xa4y. For example, for permutation p=[4,1,2,3,7,6,5] we have a=[1,3,3,3,3,3,3]. You are given the stair array a. Your task is to calculate the number of permutations which have stair array equal to a. Since the number can be big, compute it modulo 998244353. Note that this number can be equal to zero." 3400.0                                           
     1553D Backspace "dp,greedy,strings,two pointers" "You are given two strings s and t, both consisting of lowercase English letters. You are going to type the string s character by character, from the first character to the last one.When typing a character, instead of pressing the button corresponding to it, you can press the ""Backspace"" button. It deletes the last character you have typed among those that aren\'t deleted yet (or does nothing if there are no characters in the current string). For example, if s is ""abcbd"" and you press Backspace instead of typing the first and the fourth characters, you will get the string ""bd"" (the first press of Backspace deletes no character, and the second press deletes the character \'c\'). Another example, if s is ""abcaa"" and you press Backspace instead of the last two letters, then the resulting text is ""a"".Your task is to determine whether you can obtain the string t, if you type the string s and press ""Backspace"" instead of typing several (maybe zero) characters of s." 1500.0                                           
     1552I "Organizing a Music Festival" "dfs and similar,math" "You are the organizer of the famous ""Zurich Music Festival"". There will be n singers who will perform at the festival, identified by the integers 1, 2, \xe2\x80\xa6, n. You must choose in which order they are going to perform on stage. You have m friends and each of them has a set of favourite singers. More precisely, for each 1\xe2\x89\xa4i\xe2\x89\xa4m, the i-th friend likes singers si,1,si,2,\xe2\x80\xa6,si,qi.A friend of yours is happy if the singers he likes perform consecutively (in an arbitrary order). An ordering of the singers is valid if it makes all your friends happy.Compute the number of valid orderings modulo 998244353." 3400.0                                           
     1552G "A Serious Referee" "bitmasks,brute force,dfs and similar,sortings" "Andrea has come up with what he believes to be a novel sorting algorithm for arrays of length n. The algorithm works as follows.Initially there is an array of n integers a1,a2,\xe2\x80\xa6,an. Then, k steps are executed.For each 1\xe2\x89\xa4i\xe2\x89\xa4k, during the i-th step the subsequence of the array a with indexes ji,1<ji,2<\xe2\x8b\xaf<ji,qi is sorted, without changing the values with the remaining indexes. So, the subsequence aji,1,aji,2,\xe2\x80\xa6,aji,qi is sorted and all other elements of a are left untouched.Andrea, being eager to share his discovery with the academic community, sent a short paper describing his algorithm to the journal ""Annals of Sorting Algorithms"" and you are the referee of the paper (that is, the person who must judge the correctness of the paper). You must decide whether Andrea\'s algorithm is correct, that is, if it sorts any array a of n integers." 3000.0                                           
     1550E Stringforces "binary search,bitmasks,brute force,dp,strings,two pointers" "You are given a string s of length n. Each character is either one of the first k lowercase Latin letters or a question mark.You are asked to replace every question mark with one of the first k lowercase Latin letters in such a way that the following value is maximized.Let fi be the maximum length substring of string s, which consists entirely of the i-th Latin letter. A substring of a string is a contiguous subsequence of that string. If the i-th letter doesn\'t appear in a string, then fi is equal to 0.The value of a string s is the minimum value among fi for all i from 1 to k.What is the maximum value the string can have?" 2500.0                                           
     1547D "Co-growing Sequence" "bitmasks,constructive algorithms,greedy" "A sequence of non-negative integers a1,a2,\xe2\x80\xa6,an is called growing if for all i from 1 to n\xe2\x88\x921 all ones (of binary representation) in ai are in the places of ones (of binary representation) in ai+1 (in other words, ai&ai+1=ai, where & denotes bitwise AND). If n=1 then the sequence is considered growing as well.For example, the following four sequences are growing:   [2,3,15,175] \xe2\x80\x94 in binary it\'s [102,112,11112,101011112];  [5] \xe2\x80\x94 in binary it\'s [1012];  [1,3,7,15] \xe2\x80\x94 in binary it\'s [12,112,1112,11112];  [0,0,0] \xe2\x80\x94 in binary it\'s [02,02,02]. The following three sequences are non-growing:   [3,4,5] \xe2\x80\x94 in binary it\'s [112,1002,1012];  [5,4,3] \xe2\x80\x94 in binary it\'s [1012,1002,0112];  [1,2,4,8] \xe2\x80\x94 in binary it\'s [00012,00102,01002,10002]. Consider two sequences of non-negative integers x1,x2,\xe2\x80\xa6,xn and y1,y2,\xe2\x80\xa6,yn. Let\'s call this pair of sequences co-growing if the sequence x1\xe2\x8a\x95y1,x2\xe2\x8a\x95y2,\xe2\x80\xa6,xn\xe2\x8a\x95yn is growing where \xe2\x8a\x95 denotes bitwise XOR.You are given a sequence of integers x1,x2,\xe2\x80\xa6,xn. Find the lexicographically minimal sequence y1,y2,\xe2\x80\xa6,yn such that sequences xi and yi are co-growing.The sequence a1,a2,\xe2\x80\xa6,an is lexicographically smaller than the sequence b1,b2,\xe2\x80\xa6,bn if there exists 1\xe2\x89\xa4k\xe2\x89\xa4n such that ai=bi for any 1\xe2\x89\xa4i<k but ak<bk." 1300.0                                           
     1546B "AquaMoon and Stolen String" interactive,math "AquaMoon had n strings of length m each. n is an odd number.When AquaMoon was gone, Cirno tried to pair these n strings together. After making n\xe2\x88\x9212 pairs, she found out that there was exactly one string without the pair!In her rage, she disrupted each pair of strings. For each pair, she selected some positions (at least 1 and at most m) and swapped the letters in the two strings of this pair at the selected positions.For example, if m=6 and two strings ""abcdef"" and ""xyzklm"" are in one pair and Cirno selected positions 2, 3 and 6 she will swap \'b\' with \'y\', \'c\' with \'z\' and \'f\' with \'m\'. The resulting strings will be ""ayzdem"" and ""xbcklf"".Cirno then stole away the string without pair and shuffled all remaining strings in arbitrary order.AquaMoon found the remaining n\xe2\x88\x921 strings in complete disarray. Also, she remembers the initial n strings. She wants to know which string was stolen, but she is not good at programming. Can you help her?" 1200.0                                           
     1543D2 "RPD and Rap Sheet (Hard Version)" "brute force,constructive algorithms,interactive,math" "This is the hard version of the problem. The only difference is that here 2\xe2\x89\xa4k\xe2\x89\xa4100. You can make hacks only if both the versions of the problem are solved.This is an interactive problem!Every decimal number has a base k equivalent. The individual digits of a base k number are called k-its. Let\'s define the k-itwise XOR of two k-its a and b as (a+b)modk.The k-itwise XOR of two base k numbers is equal to the new number formed by taking the k-itwise XOR of their corresponding k-its. The k-itwise XOR of two decimal numbers a and b is denoted by a\xe2\x8a\x95kb and is equal to the decimal representation of the k-itwise XOR of the base k representations of a and b. All further numbers used in the statement below are in decimal unless specified.You have hacked the criminal database of Rockport Police Department (RPD), also known as the Rap Sheet. But in order to access it, you require a password. You don\'t know it, but you are quite sure that it lies between 0 and n\xe2\x88\x921 inclusive. So, you have decided to guess it. Luckily, you can try at most n times without being blocked by the system. But the system is adaptive. Each time you make an incorrect guess, it changes the password. Specifically, if the password before the guess was x, and you guess a different number y, then the system changes the password to a number z such that x\xe2\x8a\x95kz=y. Guess the password and break into the system." 2200.0                                           
     1542E1 "Abnormal Permutation Pairs (easy version)" combinatorics,dp,fft,math "This is the easy version of the problem. The only difference between the easy version and the hard version is the constraints on n. You can only make hacks if both versions are solved.A permutation of 1,2,\xe2\x80\xa6,n is a sequence of n integers, where each integer from 1 to n appears exactly once. For example, [2,3,1,4] is a permutation of 1,2,3,4, but [1,4,2,2] isn\'t because 2 appears twice in it.Recall that the number of inversions in a permutation a1,a2,\xe2\x80\xa6,an is the number of pairs of indices (i,j) such that i<j and ai>aj.Let p and q be two permutations of 1,2,\xe2\x80\xa6,n. Find the number of permutation pairs (p,q) that satisfy the following conditions:  p is lexicographically smaller than q.  the number of inversions in p is greater than the number of inversions in q. Print the number of such pairs modulo mod. Note that mod may not be a prime." 2400.0                                           
     1541B "Pleasant Pairs" "brute force,implementation,math,number theory" "You are given an array a1,a2,\xe2\x80\xa6,an consisting of n distinct integers. Count the number of pairs of indices (i,j) such that i<j and ai\xe2\x8b\x85aj=i+j." 1200.0                                           
     1540C1 "Converging Array (Easy Version)" dp,math "This is the easy version of the problem. The only difference is that in this version q=1. You can make hacks only if both versions of the problem are solved.There is a process that takes place on arrays a and b of length n and length n\xe2\x88\x921 respectively. The process is an infinite sequence of operations. Each operation is as follows:   First, choose a random integer i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).  Then, simultaneously set ai=min(ai,ai+ai+1\xe2\x88\x92bi2) and ai+1=max(ai+1,ai+ai+1+bi2) without any rounding (so values may become non-integer).  See notes for an example of an operation.It can be proven that array a converges, i. e. for each i there exists a limit ai converges to. Let function F(a,b) return the value a1 converges to after a process on a and b.You are given array b, but not array a. However, you are given a third array c. Array a is good if it contains only integers and satisfies 0\xe2\x89\xa4ai\xe2\x89\xa4ci for 1\xe2\x89\xa4i\xe2\x89\xa4n.Your task is to count the number of good arrays a where F(a,b)\xe2\x89\xa5x for q values of x. Since the number of arrays can be very large, print it modulo 109+7." 2700.0                                           
     1540A "Great Graphs" "constructive algorithms,graphs,greedy,shortest paths,sortings" "Farmer John has a farm that consists of n pastures connected by one-directional roads. Each road has a weight, representing the time it takes to go from the start to the end of the road. The roads could have negative weight, where the cows go so fast that they go back in time! However, Farmer John guarantees that it is impossible for the cows to get stuck in a time loop, where they can infinitely go back in time by traveling across a sequence of roads. Also, each pair of pastures is connected by at most one road in each direction.Unfortunately, Farmer John lost the map of the farm. All he remembers is an array d, where di is the smallest amount of time it took the cows to reach the i-th pasture from pasture 1 using a sequence of roads. The cost of his farm is the sum of the weights of each of the roads, and Farmer John needs to know the minimal cost of a farm that is consistent with his memory." 1400.0                                           
     1538G "Gift Set" "binary search,greedy,math,ternary search" "Polycarp has x of red and y of blue candies. Using them, he wants to make gift sets. Each gift set contains either a red candies and b blue candies, or a blue candies and b red candies. Any candy can belong to at most one gift set.Help Polycarp to find the largest number of gift sets he can create.For example, if x=10, y=12, a=5, and b=2, then Polycarp can make three gift sets:   In the first set there will be 5 red candies and 2 blue candies;  In the second set there will be 5 blue candies and 2 red candies;  In the third set will be 5 blue candies and 2 red candies. Note that in this example there is one red candy that Polycarp does not use in any gift set." 2100.0                                           
     1538C "Number of Pairs" "binary search,data structures,math,two pointers" "You are given an array a of n integers. Find the number of pairs (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) where the sum of ai+aj is greater than or equal to l and less than or equal to r (that is, l\xe2\x89\xa4ai+aj\xe2\x89\xa4r).For example, if n=3, a=[5,1,2], l=4 and r=7, then two pairs are suitable:   i=1 and j=2 (4\xe2\x89\xa45+1\xe2\x89\xa47);  i=1 and j=3 (4\xe2\x89\xa45+2\xe2\x89\xa47)." 1300.0                                           
     1537E1 "Erase and Extend (Easy Version)" "binary search,brute force,dp,greedy,hashing,implementation,string suffix structures,strings,two pointers" "This is the easy version of the problem. The only difference is the constraints on n and k. You can make hacks only if all versions of the problem are solved.You have a string s, and you can do two types of operations on it:   Delete the last character of the string.  Duplicate the string: s:=s+s, where + denotes concatenation. You can use each operation any number of times (possibly none).Your task is to find the lexicographically smallest string of length exactly k that can be obtained by doing these operations on string s.A string a is lexicographically smaller than a string b if and only if one of the following holds:  a is a prefix of b, but a\xe2\x89\xa0b;  In the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 1600.0                                           
     1536C "Diluc and Kaeya" "data structures,dp,hashing,number theory" "The tycoon of a winery empire in Mondstadt, unmatched in every possible way. A thinker in the Knights of Favonius with an exotic appearance.This time, the brothers are dealing with a strange piece of wood marked with their names. This plank of wood can be represented as a string of n characters. Each character is either a \'D\' or a \'K\'. You want to make some number of cuts (possibly 0) on this string, partitioning it into several contiguous pieces, each with length at least 1. Both brothers act with dignity, so they want to split the wood as evenly as possible. They want to know the maximum number of pieces you can split the wood into such that the ratios of the number of occurrences of \'D\' to the number of occurrences of \'K\' in each chunk are the same.Kaeya, the curious thinker, is interested in the solution for multiple scenarios. He wants to know the answer for every prefix of the given string. Help him to solve this problem!For a string we define a ratio as a:b where \'D\' appears in it a times, and \'K\' appears b times. Note that a or b can equal 0, but not both. Ratios a:b and c:d are considered equal if and only if a\xe2\x8b\x85d=b\xe2\x8b\x85c. For example, for the string \'DDD\' the ratio will be 3:0, for \'DKD\' \xe2\x80\x94 2:1, for \'DKK\' \xe2\x80\x94 1:2, and for \'KKKKDD\' \xe2\x80\x94 2:4. Note that the ratios of the latter two strings are equal to each other, but they are not equal to the ratios of the first two strings." 1500.0                                           
     1534E "Lost Array" "graphs,greedy,interactive,shortest paths" "This is an interactive problem.Note: the XOR-sum of an array a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4109) is defined as a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an, where \xe2\x8a\x95 denotes the bitwise XOR operation.Little Dormi received an array of n integers a1,a2,\xe2\x80\xa6,an for Christmas. However, while playing with it over the winter break, he accidentally dropped it into his XOR machine, and the array got lost.The XOR machine is currently configured with a query size of k (which you cannot change), and allows you to perform the following type of query: by giving the machine k distinct indices x1,x2,\xe2\x80\xa6,xk, it will output ax1\xe2\x8a\x95ax2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95axk.As Little Dormi\'s older brother, you would like to help him recover the XOR-sum of his array a1,a2,\xe2\x80\xa6,an by querying the XOR machine.Little Dormi isn\'t very patient, so to be as fast as possible, you must query the XOR machine the minimum number of times to find the XOR-sum of his array. Formally, let d be the minimum number of queries needed to find the XOR-sum of any array of length n with a query size of k. Your program will be accepted if you find the correct XOR-sum in at most d queries.Lastly, you also noticed that with certain configurations of the machine k and values of n, it may not be possible to recover the XOR-sum of Little Dormi\'s lost array. If that is the case, you should report it as well.The array a1,a2,\xe2\x80\xa6,an is fixed before you start querying the XOR machine and does not change with the queries." 2300.0                                           
     1534A "Colour the Flag" "brute force,implementation" "Today we will be playing a red and white colouring game (no, this is not the Russian Civil War; these are just the colours of the Canadian flag).You are given an n\xc3\x97m grid of ""R"", ""W"", and ""."" characters. ""R"" is red, ""W"" is white and ""."" is blank. The neighbours of a cell are those that share an edge with it (those that only share a corner do not count).Your job is to colour the blank cells red or white so that every red cell only has white neighbours (and no red ones) and every white cell only has red neighbours (and no white ones). You are not allowed to recolour already coloured cells." 800.0                                           
     1531B2 \xd0\x9c\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb3 "*special problem" "\xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\xbe\xd1\x82\xd0\xba\xd1\x80\xd1\x8b\xd0\xbb\xd0\xb0 \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb9 \xd1\x88\xd1\x82\xd0\xb0\xd0\xb1 \xd0\xb2 \xd0\xa1\xd0\xb0\xd0\xbd\xd0\xba\xd1\x82-\xd0\x9f\xd0\xb5\xd1\x82\xd0\xb5\xd1\x80\xd0\xb1\xd1\x83\xd1\x80\xd0\xb3\xd0\xb5! \xd0\x92\xd1\x8b \xd0\xbd\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb8\xd0\xbd\xd1\x83\xd0\xbb\xd0\xb8 \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c\xd1\x8e \xd1\x81\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbe\xd0\xb1\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 \xd0\xb8 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb5\xd1\x85\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7 \xd0\xbe\xd1\x84\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb2 \xd0\x94\xd0\xbe\xd0\xbc\xd0\xb5 \xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xb2 \xd0\xbe\xd1\x84\xd0\xb8\xd1\x81 \xd0\xbd\xd0\xb0 \xd0\x9a\xd1\x80\xd0\xb0\xd1\x81\xd0\xbd\xd0\xbe\xd0\xbc \xd0\xbc\xd0\xbe\xd1\x81\xd1\x82\xd1\x83.\xd0\x94\xd0\xbb\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbc\xd1\x84\xd0\xbe\xd1\x80\xd1\x82\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x8b \xd0\xb2\xd0\xb0\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd0\xb2\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xb0 \xd1\x81 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb9, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb8\xd0\xb7\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xb2\xd1\x8b\xd0\xb3\xd0\xbb\xd1\x8f\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xbe \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd1\x8b\xd0\xbc \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd0\xbc. \xd0\x9d\xd0\xb0 \xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xb5 \xd0\xbe\xd1\x84\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\x9a\xd1\x80\xd0\xb0\xd1\x81\xd0\xbd\xd0\xbe\xd0\xbc \xd0\xbc\xd0\xbe\xd1\x81\xd1\x82\xd1\x83 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c n \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb2, i-\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd1\x88\xd0\xb8\xd1\x80\xd0\xb8\xd0\xbd\xd1\x83 wi \xd0\xb8 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x83 hi. \xd0\x9b\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 90 \xd0\xb3\xd1\x80\xd0\xb0\xd0\xb4\xd1\x83\xd1\x81\xd0\xbe\xd0\xb2, \xd0\xb8 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbe\xd0\xbd \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xbc\xd0\xb5\xd1\x82\xd1\x8c \xd1\x88\xd0\xb8\xd1\x80\xd0\xb8\xd0\xbd\xd1\x83 hi \xd0\xb8 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x83 wi.\xd0\x9d\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xb2\xd1\x91\xd0\xbc \xd0\xbd\xd0\xb5\xd1\x83\xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xbe\xd1\x87\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x83\xd1\x8e \xd0\xbf\xd0\xb0\xd1\x80\xd1\x83 \xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x89\xd0\xb5\xd0\xb9, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb8\xd1\x85 \xd0\xbf\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c \xd1\x82\xd0\xb0\xd0\xba, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xbe\xd0\xbd\xd0\xb8 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb2\xd1\x83\xd1\x8e \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x83. \xd0\x9b\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xb2 \xd0\xbf\xd0\xb0\xd1\x80\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xba\xd0\xb0\xd0\xba \xd0\xbf\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c \xd0\xbe\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb8\xd1\x81\xd1\x85\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbe\xd1\x80\xd0\xb8\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8, \xd1\x82\xd0\xb0\xd0\xba \xd0\xb8 \xd0\xbd\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xb2\xd0\xbe\xd1\x80\xd0\xb0\xd1\x87\xd0\xb8\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c.\xd0\x9f\xd0\xbe\xd0\xb4\xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x89\xd0\xb8\xd0\xb5 \xd0\xbf\xd0\xb0\xd1\x80\xd1\x8b \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb2." -999.0                                           
     1526A "Mean Inequality" "constructive algorithms,sortings" "You are given an array a of 2n distinct integers. You want to arrange the elements of the array in a circle such that no element is equal to the the arithmetic mean of its 2 neighbours.More formally, find an array b, such that: b is a permutation of a.For every i from 1 to 2n, bi\xe2\x89\xa0bi\xe2\x88\x921+bi+12, where b0=b2n and b2n+1=b1. It can be proved that under the constraints of this problem, such array b always exists." 800.0                                           
          1331G "Lingua Romana" "*special problem" "per nextum in unam tum XI conscribementis fac sic    vestibulo perlegementum da varo.    morde varo.    seqis cumula varum.cisper nextum in unam tum XI conscribementis fac sic    seqis decumulamenta da varo.    varum privamentum fodementum da aresulto.    varum tum III elevamentum tum V multiplicamentum da bresulto.    aresultum tum bresultum addementum da resulto.    si CD tum resultum non praestantiam fac sic        dictum sic f(%d) = %.2f cis tum varum tum resultum egresso describe.        novumversum egresso scribe.    cis    si CD tum resultum praestantiam fac sic        dictum sic f(%d) = MAGNA NIMIS! cis tum varum egresso describe.        novumversum egresso scribe.            ciscis" -999.0                                      
          1331E "Jordan Smiley" "*special problem,dfs and similar,geometry,implementation"  -999.0                                      
          1329A "Dreamoon Likes Coloring" "constructive algorithms,greedy,implementation,math" "Dreamoon likes coloring cells very much.There is a row of n cells. Initially, all cells are empty (don\'t contain any color). Cells are numbered from 1 to n.You are given an integer m and m integers l1,l2,\xe2\x80\xa6,lm (1\xe2\x89\xa4li\xe2\x89\xa4n)Dreamoon will perform m operations.In i-th operation, Dreamoon will choose a number pi from range [1,n\xe2\x88\x92li+1] (inclusive) and will paint all cells from pi to pi+li\xe2\x88\x921 (inclusive) in i-th color. Note that cells may be colored more one than once, in this case, cell will have the color from the latest operation.Dreamoon hopes that after these m operations, all colors will appear at least once and all cells will be colored. Please help Dreamoon to choose pi in each operation to satisfy all constraints." 1800.0                                      
          1328D Carousel "constructive algorithms,dp,graphs,greedy,math" "The round carousel consists of n figures of animals. Figures are numbered from 1 to n in order of the carousel moving. Thus, after the n-th figure the figure with the number 1 follows. Each figure has its own type \xe2\x80\x94 the type of the animal corresponding to this figure (the horse, the tiger and so on). The type of animal of the i-th figure equals ti.  The example of the carousel for n=9 and t=[5,5,1,15,1,5,5,1,1]. You want to color each figure in one of the colors. You think that it\'s boring if the carousel contains two different figures (with the distinct types of animals) going one right after another and colored in the same color.Your task is to color the figures in such a way that the number of distinct colors used is the minimum possible and there are no figures of the different types going one right after another and colored in the same color. If you use exactly k distinct colors, then the colors of figures should be denoted with integers from 1 to k." 1800.0                                      
          1327B "Princesses and Princes" "brute force,graphs,greedy" "The King of Berland Polycarp LXXXIV has n daughters. To establish his power to the neighbouring kingdoms he wants to marry his daughters to the princes of these kingdoms. As a lucky coincidence there are n other kingdoms as well.So Polycarp LXXXIV has enumerated his daughters from 1 to n and the kingdoms from 1 to n. For each daughter he has compiled a list of kingdoms princes of which she wanted to marry.Polycarp LXXXIV is very busy, so he finds a couple for his daughters greedily one after another.For the first daughter he takes the kingdom with the lowest number from her list and marries the daughter to their prince. For the second daughter he takes the kingdom with the lowest number from her list, prince of which hasn\'t been taken already. If there are no free princes in the list then the daughter marries nobody and Polycarp LXXXIV proceeds to the next daughter. The process ends after the n-th daughter.For example, let there be 4 daughters and kingdoms, the lists daughters have are [2,3], [1,2], [3,4], [3], respectively.  In that case daughter 1 marries the prince of kingdom 2, daughter 2 marries the prince of kingdom 1, daughter 3 marries the prince of kingdom 3, leaving daughter 4 nobody to marry to.Actually, before starting the marriage process Polycarp LXXXIV has the time to convince one of his daughters that some prince is also worth marrying to. Effectively, that means that he can add exactly one kingdom to exactly one of his daughter\'s list. Note that this kingdom should not be present in the daughter\'s list.Polycarp LXXXIV wants to increase the number of married couples.Unfortunately, what he doesn\'t have the time for is determining what entry to add. If there is no way to increase the total number of married couples then output that the marriages are already optimal. Otherwise, find such an entry that the total number of married couples increases if Polycarp LXXXIV adds it.If there are multiple ways to add an entry so that the total number of married couples increases then print any of them.For your and our convenience you are asked to answer t independent test cases." 1200.0                                      
          1326F2 "Wise Men (Hard Version)" bitmasks,dp,math "This is the hard version of the problem. The difference is constraints on the number of wise men and the time limit. You can make hacks only if all versions of this task are solved.n wise men live in a beautiful city. Some of them know each other.For each of the n! possible permutations p1,p2,\xe2\x80\xa6,pn of the wise men, let\'s generate a binary string of length n\xe2\x88\x921: for each 1\xe2\x89\xa4i<n set si=1 if pi and pi+1 know each other, and si=0 otherwise. For all possible 2n\xe2\x88\x921 binary strings, find the number of permutations that produce this binary string." 3200.0                                      
          1326E Bombs "data structures,two pointers" "You are given a permutation, p1,p2,\xe2\x80\xa6,pn.Imagine that some positions of the permutation contain bombs, such that there exists at least one position without a bomb.For some fixed configuration of bombs, consider the following process. Initially, there is an empty set, A.For each i from 1 to n: Add pi to A.  If the i-th position contains a bomb, remove the largest element in A.After the process is completed, A will be non-empty. The cost of the configuration of bombs equals the largest element in A.You are given another permutation, q1,q2,\xe2\x80\xa6,qn.For each 1\xe2\x89\xa4i\xe2\x89\xa4n, find the cost of a configuration of bombs such that there exists a bomb in positions q1,q2,\xe2\x80\xa6,qi\xe2\x88\x921. For example, for i=1, you need to find the cost of a configuration without bombs, and for i=n, you need to find the cost of a configuration with bombs in positions q1,q2,\xe2\x80\xa6,qn\xe2\x88\x921." 2400.0                                      
          1326A "Bad Ugly Numbers" "constructive algorithms,number theory" "You are given a integer n (n>0). Find any integer s which satisfies these conditions, or report that there are no such numbers:In the decimal representation of s:   s>0,  s consists of n digits,  no digit in s equals 0,  s is not divisible by any of it\'s digits." 1000.0                                      
          1325C "Ehab and Path-etic MEXs" "constructive algorithms,dfs and similar,greedy,trees" "You are given a tree consisting of n nodes. You want to write some labels on the tree\'s edges such that the following conditions hold:  Every label is an integer between 0 and n\xe2\x88\x922 inclusive.  All the written labels are distinct.  The largest value among MEX(u,v) over all pairs of nodes (u,v) is as small as possible. Here, MEX(u,v) denotes the smallest non-negative integer that isn\'t written on any edge on the unique simple path from node u to node v." 1500.0                                      
          1323B "Count Subrectangles" "binary search,greedy,implementation" "You are given an array a of length n and array b of length m both consisting of only integers 0 and 1. Consider a matrix c of size n\xc3\x97m formed by following rule: ci,j=ai\xe2\x8b\x85bj (i.e. ai multiplied by bj). It\'s easy to see that c consists of only zeroes and ones too.How many subrectangles of size (area) k consisting only of ones are there in c?A subrectangle is an intersection of a consecutive (subsequent) segment of rows and a consecutive (subsequent) segment of columns. I.e. consider four integers x1,x2,y1,y2 (1\xe2\x89\xa4x1\xe2\x89\xa4x2\xe2\x89\xa4n, 1\xe2\x89\xa4y1\xe2\x89\xa4y2\xe2\x89\xa4m) a subrectangle c[x1\xe2\x80\xa6x2][y1\xe2\x80\xa6y2] is an intersection of the rows x1,x1+1,x1+2,\xe2\x80\xa6,x2 and the columns y1,y1+1,y1+2,\xe2\x80\xa6,y2.The size (area) of a subrectangle is the total number of cells in it." 1500.0                                      
          1323A "Even Subset Sum Problem" "brute force,dp,greedy,implementation" "You are given an array a consisting of n positive integers. Find a non-empty subset of its elements such that their sum is even (i.e. divisible by 2) or determine that there is no such subset.Both the given array and required subset may contain equal values." 800.0                                      
          1322A "Unusual Competitions" greedy "A bracketed sequence is called correct (regular) if by inserting ""+"" and ""1"" you can get a well-formed mathematical expression from it. For example, sequences ""(())()"", ""()"" and ""(()(()))"" are correct, while "")("", ""(()"" and ""(()))("" are not.The teacher gave Dmitry\'s class a very strange task \xe2\x80\x94 she asked every student to come up with a sequence of arbitrary length, consisting only of opening and closing brackets. After that all the students took turns naming the sequences they had invented. When Dima\'s turn came, he suddenly realized that all his classmates got the correct bracketed sequence, and whether he got the correct bracketed sequence, he did not know.Dima suspects now that he simply missed the word ""correct"" in the task statement, so now he wants to save the situation by modifying his sequence slightly. More precisely, he can the arbitrary number of times (possibly zero) perform the reorder operation.The reorder operation consists of choosing an arbitrary consecutive subsegment (substring) of the sequence and then reordering all the characters in it in an arbitrary way. Such operation takes l nanoseconds, where l is the length of the subsegment being reordered. It\'s easy to see that reorder operation doesn\'t change the number of opening and closing brackets. For example for ""))(("" he can choose the substring "")("" and do reorder "")()("" (this operation will take 2 nanoseconds).Since Dima will soon have to answer, he wants to make his sequence correct as fast as possible. Help him to do this, or determine that it\'s impossible." 1300.0                                      
          1320C "World of Darkraft: Battle for Azathoth" "brute force,data structures,sortings" "Roma is playing a new expansion for his favorite game World of Darkraft. He made a new character and is going for his first grind.Roma has a choice to buy exactly one of n different weapons and exactly one of m different armor sets. Weapon i has attack modifier ai and is worth cai coins, and armor set j has defense modifier bj and is worth cbj coins.After choosing his equipment Roma can proceed to defeat some monsters. There are p monsters he can try to defeat. Monster k has defense xk, attack yk and possesses zk coins. Roma can defeat a monster if his weapon\'s attack modifier is larger than the monster\'s defense, and his armor set\'s defense modifier is larger than the monster\'s attack. That is, a monster k can be defeated with a weapon i and an armor set j if ai>xk and bj>yk. After defeating the monster, Roma takes all the coins from them. During the grind, Roma can defeat as many monsters as he likes. Monsters do not respawn, thus each monster can be defeated at most one.Thanks to Roma\'s excessive donations, we can assume that he has an infinite amount of in-game currency and can afford any of the weapons and armor sets. Still, he wants to maximize the profit of the grind. The profit is defined as the total coins obtained from all defeated monsters minus the cost of his equipment. Note that Roma must purchase a weapon and an armor set even if he can not cover their cost with obtained coins.Help Roma find the maximum profit of the grind." 2000.0                                      
          1315A "Dead Pixel" implementation "Screen resolution of Polycarp\'s monitor is a\xc3\x97b pixels. Unfortunately, there is one dead pixel at his screen. It has coordinates (x,y) (0\xe2\x89\xa4x<a,0\xe2\x89\xa4y<b). You can consider columns of pixels to be numbered from 0 to a\xe2\x88\x921, and rows \xe2\x80\x94 from 0 to b\xe2\x88\x921.Polycarp wants to open a rectangular window of maximal size, which doesn\'t contain the dead pixel. The boundaries of the window should be parallel to the sides of the screen.Print the maximal area (in pixels) of a window that doesn\'t contain the dead pixel inside itself." 800.0                                      
          1305B "Kuroni and Simple Strings" "constructive algorithms,greedy,strings,two pointers" "Now that Kuroni has reached 10 years old, he is a big boy and doesn\'t like arrays of integers as presents anymore. This year he wants a Bracket sequence as a Birthday present. More specifically, he wants a bracket sequence so complex that no matter how hard he tries, he will not be able to remove a simple subsequence!We say that a string formed by n characters \'(\' or \')\' is simple if its length n is even and positive, its first n2 characters are \'(\', and its last n2 characters are \')\'. For example, the strings () and (()) are simple, while the strings )( and ()() are not simple.Kuroni will be given a string formed by characters \'(\' and \')\' (the given string is not necessarily simple). An operation consists of choosing a subsequence of the characters of the string that forms a simple string and removing all the characters of this subsequence from the string. Note that this subsequence doesn\'t have to be continuous. For example, he can apply the operation to the string \')()(()))\', to choose a subsequence of bold characters, as it forms a simple string \'(())\', delete these bold characters from the string and to get \'))()\'. Kuroni has to perform the minimum possible number of operations on the string, in such a way that no more operations can be performed on the remaining string. The resulting string does not have to be empty.Since the given string is too large, Kuroni is unable to figure out how to minimize the number of operations. Can you help him do it instead?A sequence of characters a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters." 1200.0                                      
          1304A "Two Rabbits" math "Being tired of participating in too many Codeforces rounds, Gildong decided to take some rest in a park. He sat down on a bench, and soon he found two rabbits hopping around. One of the rabbits was taller than the other.He noticed that the two rabbits were hopping towards each other. The positions of the two rabbits can be represented as integer coordinates on a horizontal line. The taller rabbit is currently on position x, and the shorter rabbit is currently on position y (x<y). Every second, each rabbit hops to another position. The taller rabbit hops to the positive direction by a, and the shorter rabbit hops to the negative direction by b.  For example, let\'s say x=0, y=10, a=2, and b=3. At the 1-st second, each rabbit will be at position 2 and 7. At the 2-nd second, both rabbits will be at position 4.Gildong is now wondering: Will the two rabbits be at the same position at the same moment? If so, how long will it take? Let\'s find a moment in time (in seconds) after which the rabbits will be at the same point." 800.0                                      
          1303C "Perfect Keyboard" "dfs and similar,greedy,implementation" "Polycarp wants to assemble his own keyboard. Layouts with multiple rows are too complicated for him \xe2\x80\x94 his keyboard will consist of only one row, where all 26 lowercase Latin letters will be arranged in some order.Polycarp uses the same password s on all websites where he is registered (it is bad, but he doesn\'t care). He wants to assemble a keyboard that will allow to type this password very easily. He doesn\'t like to move his fingers while typing the password, so, for each pair of adjacent characters in s, they should be adjacent on the keyboard. For example, if the password is abacaba, then the layout cabdefghi... is perfect, since characters a and c are adjacent on the keyboard, and a and b are adjacent on the keyboard. It is guaranteed that there are no two adjacent equal characters in s, so, for example, the password cannot be password (two characters s are adjacent).Can you help Polycarp with choosing the perfect layout of the keyboard, if it is possible?" 1600.0                                      
          1301E Nanosoft "binary search,data structures,dp,implementation" "Warawreh created a great company called Nanosoft. The only thing that Warawreh still has to do is to place a large picture containing its logo on top of the company\'s building.The logo of Nanosoft can be described as four squares of the same size merged together into one large square. The top left square is colored with red, the top right square is colored with green, the bottom left square is colored with yellow and the bottom right square is colored with blue.An Example of some correct logos:An Example of some incorrect logos:Warawreh went to Adhami\'s store in order to buy the needed picture. Although Adhami\'s store is very large he has only one picture that can be described as a grid of n rows and m columns. The color of every cell in the picture will be green (the symbol \'G\'), red (the symbol \'R\'), yellow (the symbol \'Y\') or blue (the symbol \'B\').Adhami gave Warawreh q options, in every option he gave him a sub-rectangle from that picture and told him that he can cut that sub-rectangle for him. To choose the best option, Warawreh needs to know for every option the maximum area of sub-square inside the given sub-rectangle that can be a Nanosoft logo. If there are no such sub-squares, the answer is 0.Warawreh couldn\'t find the best option himself so he asked you for help, can you help him?" 2500.0                                      
          1301D "Time to Run" "constructive algorithms,graphs,implementation" "Bashar was practicing for the national programming contest. Because of sitting too much in front of the computer without doing physical movements and eating a lot Bashar became much fatter. Bashar is going to quit programming after the national contest and he is going to become an actor (just like his father), so he should lose weight.In order to lose weight, Bashar is going to run for k kilometers. Bashar is going to run in a place that looks like a grid of n rows and m columns. In this grid there are two one-way roads of one-kilometer length between each pair of adjacent by side cells, one road is going from the first cell to the second one, and the other road is going from the second cell to the first one. So, there are exactly (4nm\xe2\x88\x922n\xe2\x88\x922m) roads.Let\'s take, for example, n=3 and m=4. In this case, there are 34 roads. It is the picture of this case (arrows describe roads):Bashar wants to run by these rules:  He starts at the top-left cell in the grid;  In one move Bashar may go up (the symbol \'U\'), down (the symbol \'D\'), left (the symbol \'L\') or right (the symbol \'R\'). More formally, if he stands in the cell in the row i and in the column j, i.e. in the cell (i,j) he will move to:   in the case \'U\' to the cell (i\xe2\x88\x921,j);  in the case \'D\' to the cell (i+1,j);  in the case \'L\' to the cell (i,j\xe2\x88\x921);  in the case \'R\' to the cell (i,j+1);   He wants to run exactly k kilometers, so he wants to make exactly k moves;  Bashar can finish in any cell of the grid;  He can\'t go out of the grid so at any moment of the time he should be on some cell;  Bashar doesn\'t want to get bored while running so he must not visit the same road twice. But he can visit the same cell any number of times. Bashar asks you if it is possible to run by such rules. If it is possible, you should tell him how should he run.You should give him a steps to do and since Bashar can\'t remember too many steps, a should not exceed 3000. In every step, you should give him an integer f and a string of moves s of length at most 4 which means that he should repeat the moves in the string s for f times. He will perform the steps in the order you print them.For example, if the steps are 2 RUD, 3 UUL then the moves he is going to move are RUD + RUD + UUL + UUL + UUL = RUDRUDUULUULUUL.Can you help him and give him a correct sequence of moves such that the total distance he will run is equal to k kilometers or say, that it is impossible?" 2000.0                                      
          1297I "Falling Blocks" "*special problem,data structures" "Recently, Polycarp has invented a new mobile game with falling blocks.In the game, n blocks are falling down, one at a time, towards a flat surface with length d units. Each block can be represented as a rectangle with coordinates from li to ri and unit height, dropped downwards from very high up. A block falls until it comes in contact with the flat surface or any other block. Let\'s define that block a covers block b if la\xe2\x89\xa4lb\xe2\x89\xa4rb\xe2\x89\xa4ra. Consider what happens when a new block i falls. If the new (upper) block i comes in contact with any block j such that block i does not cover block j, block i will stick to block j, and no blocks will disappear. Otherwise, all blocks that block i covers and is in contact with will be vaporized, and block i will continue falling with the ability to vaporize lower blocks.For example, consider what happens when three blocks (1,2), (2,3) and (1,3) fall, in that order. The first block will stick to the flat surface. Then, the second block will stick to the first block. Finally, the third block will vaporize the second block, keep falling, vaporize the first block, and stick to the flat surface.  Here is a graphic for the first example. After each block falls, help Polycarp determine how many blocks will remain!" -999.0                                      
          1297H "Paint the String" "*special problem,dp,strings" "You are given a string s of lowercase Latin letters. It is required to paint each letter of the string in one of two colors (red or blue) so that if you write all the red letters from left to right and write all the blue letters from left to right, then the lexicographically maximum of the two written strings is lexicographically minimal. For each index, in the string s you can choose either of two colors.Formally, we write out:  the string r (can be empty) \xe2\x80\x94 all red letters in the order from left to right (red subsequence),  the string b (can be empty) \xe2\x80\x94 all blue letters in the order from left to right (blue subsequence). Your task is to paint the string such that max(r,b) is minimal. Small reminder: the empty string is the lexicographically smallest string." -999.0                                      
          1295E "Permutation Separation" "data structures,divide and conquer" "You are given a permutation p1,p2,\xe2\x80\xa6,pn (an array where each integer from 1 to n appears exactly once). The weight of the i-th element of this permutation is ai.At first, you separate your permutation into two non-empty sets \xe2\x80\x94 prefix and suffix. More formally, the first set contains elements p1,p2,\xe2\x80\xa6,pk, the second \xe2\x80\x94 pk+1,pk+2,\xe2\x80\xa6,pn, where 1\xe2\x89\xa4k<n.After that, you may move elements between sets. The operation you are allowed to do is to choose some element of the first set and move it to the second set, or vice versa (move from the second set to the first). You have to pay ai dollars to move the element pi.Your goal is to make it so that each element of the first set is less than each element of the second set. Note that if one of the sets is empty, this condition is met.For example, if p=[3,1,2] and a=[7,1,4], then the optimal strategy is: separate p into two parts [3,1] and [2] and then move the 2-element into first set (it costs 4). And if p=[3,5,1,6,2,4], a=[9,1,9,9,1,9], then the optimal strategy is: separate p into two parts [3,5,1] and [6,2,4], and then move the 2-element into first set (it costs 1), and 5-element into second set (it also costs 1).Calculate the minimum number of dollars you have to spend." 2200.0                                      
          1294C "Product of Three Numbers" "greedy,math,number theory" "You are given one integer number n. Find three distinct integers a,b,c such that 2\xe2\x89\xa4a,b,c and a\xe2\x8b\x85b\xe2\x8b\x85c=n or say that it is impossible to do it.If there are several answers, you can print any.You have to answer t independent test cases." 1300.0                                      
          1293B "JOE is on TV!" combinatorics,greedy,math "3R2 - Standby for ActionOur dear Cafe\'s owner, JOE Miller, will soon take part in a new game TV-show ""1 vs. n""!The game goes in rounds, where in each round the host asks JOE and his opponents a common question. All participants failing to answer are eliminated. The show ends when only JOE remains (we assume that JOE never answers a question wrong!).For each question JOE answers, if there are s (s>0) opponents remaining and t (0\xe2\x89\xa4t\xe2\x89\xa4s) of them make a mistake on it, JOE receives ts dollars, and consequently there will be s\xe2\x88\x92t opponents left for the next question.JOE wonders what is the maximum possible reward he can receive in the best possible scenario. Yet he has little time before show starts, so can you help him answering it instead?" 1000.0                                      
          1292C "Xenon\'s Attack on the Gangs" "combinatorics,dfs and similar,dp,greedy,trees" "INSPION FullBand Master - INSPION INSPION - IOLITE-SUNSTONEOn another floor of the A.R.C. Markland-N, the young man Simon ""Xenon"" Jackson, takes a break after finishing his project early (as always). Having a lot of free time, he decides to put on his legendary hacker ""X"" instinct and fight against the gangs of the cyber world.His target is a network of n small gangs. This network contains exactly n\xe2\x88\x921 direct links, each of them connecting two gangs together. The links are placed in such a way that every pair of gangs is connected through a sequence of direct links.By mining data, Xenon figured out that the gangs used a form of cross-encryption to avoid being busted: every link was assigned an integer from 0 to n\xe2\x88\x922 such that all assigned integers are distinct and every integer was assigned to some link. If an intruder tries to access the encrypted data, they will have to surpass S password layers, with S being defined by the following formula:S=\xe2\x88\x911\xe2\x89\xa4u<v\xe2\x89\xa4nmex(u,v)Here, mex(u,v) denotes the smallest non-negative integer that does not appear on any link on the unique simple path from gang u to gang v.Xenon doesn\'t know the way the integers are assigned, but it\'s not a problem. He decides to let his AI\'s instances try all the passwords on his behalf, but before that, he needs to know the maximum possible value of S, so that the AIs can be deployed efficiently.Now, Xenon is out to write the AI scripts, and he is expected to finish them in two hours. Can you find the maximum possible S before he returns?" 2300.0                                      
          1292B "Aroma\'s Search" "brute force,constructive algorithms,geometry,greedy,implementation" "THE SxPLAY & KIV\xce\x9b - \xe6\xbc\x82\xe6\xb5\x81 KIV\xce\x9b & Nikki Simmons - PerspectivesWith a new body, our idol Aroma White (or should we call her Kaori Minamiya?) begins to uncover her lost past through the OS space.The space can be considered a 2D plane, with an infinite number of data nodes, indexed from 0, with their coordinates defined as follows:  The coordinates of the 0-th node is (x0,y0)  For i>0, the coordinates of i-th node is (ax\xe2\x8b\x85xi\xe2\x88\x921+bx,ay\xe2\x8b\x85yi\xe2\x88\x921+by) Initially Aroma stands at the point (xs,ys). She can stay in OS space for at most t seconds, because after this time she has to warp back to the real world. She doesn\'t need to return to the entry point (xs,ys) to warp home.While within the OS space, Aroma can do the following actions:  From the point (x,y), Aroma can move to one of the following points: (x\xe2\x88\x921,y), (x+1,y), (x,y\xe2\x88\x921) or (x,y+1). This action requires 1 second.  If there is a data node at where Aroma is staying, she can collect it. We can assume this action costs 0 seconds. Of course, each data node can be collected at most once. Aroma wants to collect as many data as possible before warping back. Can you help her in calculating the maximum number of data nodes she could collect within t seconds?" 1700.0                                      
          1288F "Red-Blue Graph" "constructive algorithms,flows" "You are given a bipartite graph: the first part of this graph contains n1 vertices, the second part contains n2 vertices, and there are m edges. The graph can contain multiple edges.Initially, each edge is colorless. For each edge, you may either leave it uncolored (it is free), paint it red (it costs r coins) or paint it blue (it costs b coins). No edge can be painted red and blue simultaneously.There are three types of vertices in this graph \xe2\x80\x94 colorless, red and blue. Colored vertices impose additional constraints on edges\' colours:  for each red vertex, the number of red edges indicent to it should be strictly greater than the number of blue edges incident to it;  for each blue vertex, the number of blue edges indicent to it should be strictly greater than the number of red edges incident to it. Colorless vertices impose no additional constraints.Your goal is to paint some (possibly none) edges so that all constraints are met, and among all ways to do so, you should choose the one with minimum total cost." 2900.0                                      
          1288D "Minimax Problem" "binary search,bitmasks,dp" "You are given n arrays a1, a2, ..., an; each array consists of exactly m integers. We denote the y-th element of the x-th array as ax,y.You have to choose two arrays ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, it is possible that i=j). After that, you will obtain a new array b consisting of m integers, such that for every k\xe2\x88\x88[1,m] bk=max(ai,k,aj,k).Your goal is to choose i and j so that the value of mmink=1bk is maximum possible." 2000.0                                      
          1286E "Fedya the Potter Strikes Back" "data structures,strings" "Fedya has a string S, initially empty, and an array W, also initially empty.There are n queries to process, one at a time. Query i consists of a lowercase English letter ci and a nonnegative integer wi. First, ci must be appended to S, and wi must be appended to W. The answer to the query is the sum of suspiciousnesses for all subsegments of W [L, R], (1\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa4i).We define the suspiciousness of a subsegment as follows: if the substring of S corresponding to this subsegment (that is, a string of consecutive characters from L-th to R-th, inclusive) matches the prefix of S of the same length (that is, a substring corresponding to the subsegment [1, R\xe2\x88\x92L+1]), then its suspiciousness is equal to the minimum in the array W on the [L, R] subsegment. Otherwise, in case the substring does not match the corresponding prefix, the suspiciousness is 0.Help Fedya answer all the queries before the orderlies come for him!" 3200.0                                      
          1283F "DIY Garland" "constructive algorithms,greedy,trees" "Polycarp has decided to decorate his room because the New Year is soon. One of the main decorations that Polycarp will install is the garland he is going to solder himself.Simple garlands consisting of several lamps connected by one wire are too boring for Polycarp. He is going to solder a garland consisting of n lamps and n\xe2\x88\x921 wires. Exactly one lamp will be connected to power grid, and power will be transmitted from it to other lamps by the wires. Each wire connectes exactly two lamps; one lamp is called the main lamp for this wire (the one that gets power from some other wire and transmits it to this wire), the other one is called the auxiliary lamp (the one that gets power from this wire). Obviously, each lamp has at most one wire that brings power to it (and this lamp is the auxiliary lamp for this wire, and the main lamp for all other wires connected directly to it).Each lamp has a brightness value associated with it, the i-th lamp has brightness 2i. We define the importance of the wire as the sum of brightness values over all lamps that become disconnected from the grid if the wire is cut (and all other wires are still working).Polycarp has drawn the scheme of the garland he wants to make (the scheme depicts all n lamp and n\xe2\x88\x921 wires, and the lamp that will be connected directly to the grid is marked; the wires are placed in such a way that the power can be transmitted to each lamp). After that, Polycarp calculated the importance of each wire, enumerated them from 1 to n\xe2\x88\x921 in descending order of their importance, and then wrote the index of the main lamp for each wire (in the order from the first wire to the last one).The following day Polycarp bought all required components of the garland and decided to solder it \xe2\x80\x94 but he could not find the scheme. Fortunately, Polycarp found the list of indices of main lamps for all wires. Can you help him restore the original scheme?" 2200.0                                      
          1280B Beingawesomeism implementation,math "You are an all-powerful being and you have created a rectangular world. In fact, your world is so bland that it could be represented by a r\xc3\x97cr\xc3\x97c grid. Each cell on the grid represents a country. Each country has a dominant religion. There are only two religions in your world. One of the religions is called Beingawesomeism, who do good for the sake of being good. The other religion is called Pushingittoofarism, who do murders for the sake of being bad.Oh, and you are actually not really all-powerful. You just have one power, which you can use infinitely many times! Your power involves missionary groups. When a missionary group of a certain country, say aa, passes by another country bb, they change the dominant religion of country bb to the dominant religion of country aa.In particular, a single use of your power is this:   You choose a horizontal 1\xc3\x97x1\xc3\x97x subgrid or a vertical x\xc3\x971x\xc3\x971 subgrid. That value of xx is up to you;  You choose a direction dd. If you chose a horizontal subgrid, your choices will either be NORTH or SOUTH. If you choose a vertical subgrid, your choices will either be EAST or WEST;  You choose the number ss of steps;  You command each country in the subgrid to send a missionary group that will travel ss steps towards direction dd. In each step, they will visit (and in effect convert the dominant religion of) all ss countries they pass through, as detailed above.  The parameters xx, dd, ss must be chosen in such a way that any of the missionary groups won\'t leave the grid. The following image illustrates one possible single usage of your power. Here, A represents a country with dominant religion Beingawesomeism and P represents a country with dominant religion Pushingittoofarism. Here, we\'ve chosen a 1\xc3\x9741\xc3\x974 subgrid, the direction NORTH, and s=2s=2 steps.   You are a being which believes in free will, for the most part. However, you just really want to stop receiving murders that are attributed to your name. Hence, you decide to use your powers and try to make Beingawesomeism the dominant religion in every country.What is the minimum number of usages of your power needed to convert everyone to Beingawesomeism?With god, nothing is impossible. But maybe you\'re not god? If it is impossible to make Beingawesomeism the dominant religion in all countries, you must also admit your mortality and say so." 1800.0                                      
          1279D "Santa\'s Bot" combinatorics,math,probabilities "Santa Claus has received letters from n different kids throughout this year. Of course, each kid wants to get some presents from Santa: in particular, the i-th kid asked Santa to give them one of ki different items as a present. Some items could have been asked by multiple kids.Santa is really busy, so he wants the New Year Bot to choose the presents for all children. Unfortunately, the Bot\'s algorithm of choosing presents is bugged. To choose a present for some kid, the Bot does the following:  choose one kid x equiprobably among all n kids;  choose some item y equiprobably among all kx items kid x wants;  choose a kid z who will receive the present equipropably among all n kids (this choice is independent of choosing x and y); the resulting triple (x,y,z) is called the decision of the Bot. If kid z listed item y as an item they want to receive, then the decision valid. Otherwise, the Bot\'s choice is invalid.Santa is aware of the bug, but he can\'t estimate if this bug is really severe. To do so, he wants to know the probability that one decision generated according to the aforementioned algorithm is valid. Can you help him?" 1700.0                                      
          1279A "New Year Garland" math "Polycarp is sad \xe2\x80\x94 New Year is coming in few days but there is still no snow in his city. To bring himself New Year mood, he decided to decorate his house with some garlands.The local store introduced a new service this year, called ""Build your own garland"". So you can buy some red, green and blue lamps, provide them and the store workers will solder a single garland of them. The resulting garland will have all the lamps you provided put in a line. Moreover, no pair of lamps of the same color will be adjacent to each other in this garland!For example, if you provide 3 red, 3 green and 3 blue lamps, the resulting garland can look like this: ""RGBRBGBGR"" (""RGB"" being the red, green and blue color, respectively). Note that it\'s ok to have lamps of the same color on the ends of the garland.However, if you provide, say, 1 red, 10 green and 2 blue lamps then the store workers won\'t be able to build any garland of them. Any garland consisting of these lamps will have at least one pair of lamps of the same color adjacent to each other. Note that the store workers should use all the lamps you provided.So Polycarp has bought some sets of lamps and now he wants to know if the store workers can build a garland from each of them." 900.0                                      
          1278F Cards "combinatorics,dp,math,number theory,probabilities" "Consider the following experiment. You have a deck of m cards, and exactly one card is a joker. n times, you do the following: shuffle the deck, take the top card of the deck, look at it and return it into the deck.Let x be the number of times you have taken the joker out of the deck during this experiment. Assuming that every time you shuffle the deck, all m! possible permutations of cards are equiprobable, what is the expected value of xk? Print the answer modulo 998244353." 2600.0                                      
          1278C "Berry Jam" "data structures,dp,greedy,implementation" "Karlsson has recently discovered a huge stock of berry jam jars in the basement of the house. More specifically, there were 2n jars of strawberry and blueberry jam.All the 2n jars are arranged in a row. The stairs to the basement are exactly in the middle of that row. So when Karlsson enters the basement, he sees exactly n jars to his left and n jars to his right.For example, the basement might look like this:  Being the starightforward man he is, he immediately starts eating the jam. In one minute he chooses to empty either the first non-empty jar to his left or the first non-empty jar to his right.Finally, Karlsson decided that at the end the amount of full strawberry and blueberry jam jars should become the same.For example, this might be the result:  He has eaten 1 jar to his left and then 5 jars to his right. There remained exactly 3 full jars of both strawberry and blueberry jam. Jars are numbered from 1 to 2n from left to right, so Karlsson initially stands between jars n and n+1.What is the minimum number of jars Karlsson is required to empty so that an equal number of full strawberry and blueberry jam jars is left?Your program should answer t independent test cases." 1700.0                                      
          1278B "A and B" greedy,math "You are given two integers a and b. You can perform a sequence of operations: during the first operation you choose one of these numbers and increase it by 1; during the second operation you choose one of these numbers and increase it by 2, and so on. You choose the number of these operations yourself.For example, if a=1 and b=3, you can perform the following sequence of three operations:   add 1 to a, then a=2 and b=3;  add 2 to b, then a=2 and b=5;  add 3 to a, then a=5 and b=5. Calculate the minimum number of operations required to make a and b equal." 1500.0                                      
          1278A "Shuffle Hashing" "brute force,implementation,strings" "Polycarp has built his own web service. Being a modern web service it includes login feature. And that always implies password security problems.Polycarp decided to store the hash of the password, generated by the following algorithm:  take the password p, consisting of lowercase Latin letters, and shuffle the letters randomly in it to obtain p\xe2\x80\xb2 (p\xe2\x80\xb2 can still be equal to p);  generate two random strings, consisting of lowercase Latin letters, s1 and s2 (any of these strings can be empty);  the resulting hash h=s1+p\xe2\x80\xb2+s2, where addition is string concatenation. For example, let the password p= ""abacaba"". Then p\xe2\x80\xb2 can be equal to ""aabcaab"". Random strings s1= ""zyx"" and s2= ""kjh"". Then h= ""zyxaabcaabkjh"".Note that no letters could be deleted or added to p to obtain p\xe2\x80\xb2, only the order could be changed.Now Polycarp asks you to help him to implement the password check module. Given the password p and the hash h, check that h can be the hash for the password p.Your program should answer t independent test cases." 1000.0                                      
          1276C "Beautiful Rectangle" "brute force,combinatorics,constructive algorithms,data structures,greedy,math" "You are given n integers. You need to choose a subset and put the chosen numbers in a beautiful rectangle (rectangular matrix). Each chosen number should occupy one of its rectangle cells, each cell must be filled with exactly one chosen number. Some of the n numbers may not be chosen.A rectangle (rectangular matrix) is called beautiful if in each row and in each column all values are different.What is the largest (by the total number of cells) beautiful rectangle you can construct? Print the rectangle itself." 2300.0                                      
          1272A "Three Friends" "brute force,greedy,math,sortings" "Three friends are going to meet each other. Initially, the first friend stays at the position x=a, the second friend stays at the position x=b and the third friend stays at the position x=c on the coordinate axis Ox.In one minute each friend independently from other friends can change the position x by 1 to the left or by 1 to the right (i.e. set x:=x\xe2\x88\x921 or x:=x+1) or even don\'t change it.Let\'s introduce the total pairwise distance \xe2\x80\x94 the sum of distances between each pair of friends. Let a\xe2\x80\xb2, b\xe2\x80\xb2 and c\xe2\x80\xb2 be the final positions of the first, the second and the third friend, correspondingly. Then the total pairwise distance is |a\xe2\x80\xb2\xe2\x88\x92b\xe2\x80\xb2|+|a\xe2\x80\xb2\xe2\x88\x92c\xe2\x80\xb2|+|b\xe2\x80\xb2\xe2\x88\x92c\xe2\x80\xb2|, where |x| is the absolute value of x.Friends are interested in the minimum total pairwise distance they can reach if they will move optimally. Each friend will move no more than once. So, more formally, they want to know the minimum total pairwise distance they can reach after one minute.You have to answer q independent test cases." 900.0                                      
          1271C "Shawarma Tent" "brute force,geometry,greedy,implementation" "The map of the capital of Berland can be viewed on the infinite coordinate plane. Each point with integer coordinates contains a building, and there are streets connecting every building to four neighbouring buildings. All streets are parallel to the coordinate axes.The main school of the capital is located in (sx,sy). There are n students attending this school, the i-th of them lives in the house located in (xi,yi). It is possible that some students live in the same house, but no student lives in (sx,sy).After classes end, each student walks from the school to his house along one of the shortest paths. So the distance the i-th student goes from the school to his house is |sx\xe2\x88\x92xi|+|sy\xe2\x88\x92yi|.The Provision Department of Berland has decided to open a shawarma tent somewhere in the capital (at some point with integer coordinates). It is considered that the i-th student will buy a shawarma if at least one of the shortest paths from the school to the i-th student\'s house goes through the point where the shawarma tent is located. It is forbidden to place the shawarma tent at the point where the school is located, but the coordinates of the shawarma tent may coincide with the coordinates of the house of some student (or even multiple students).You want to find the maximum possible number of students buying shawarma and the optimal location for the tent itself." 1300.0                                      
          1271A Suits "brute force,greedy,math" "A new delivery of clothing has arrived today to the clothing store. This delivery consists of a ties, b scarves, c vests and d jackets.The store does not sell single clothing items \xe2\x80\x94 instead, it sells suits of two types:  a suit of the first type consists of one tie and one jacket;  a suit of the second type consists of one scarf, one vest and one jacket. Each suit of the first type costs e coins, and each suit of the second type costs f coins.Calculate the maximum possible cost of a set of suits that can be composed from the delivered clothing items. Note that one item cannot be used in more than one suit (though some items may be left unused)." 800.0                                      
          1270A "Card Game" games,greedy,math "Two players decided to play one interesting card game.There is a deck of n cards, with values from 1 to n. The values of cards are pairwise different (this means that no two different cards have equal values). At the beginning of the game, the deck is completely distributed between players such that each player has at least one card. The game goes as follows: on each turn, each player chooses one of their cards (whichever they want) and puts on the table, so that the other player doesn\'t see which card they chose. After that, both cards are revealed, and the player, value of whose card was larger, takes both cards in his hand. Note that as all cards have different values, one of the cards will be strictly larger than the other one. Every card may be played any amount of times. The player loses if he doesn\'t have any cards.For example, suppose that n=5, the first player has cards with values 2 and 3, and the second player has cards with values 1, 4, 5. Then one possible flow of the game is:The first player chooses the card 3. The second player chooses the card 1. As 3>1, the first player gets both cards. Now the first player has cards 1, 2, 3, the second player has cards 4, 5.The first player chooses the card 3. The second player chooses the card 4. As 3<4, the second player gets both cards. Now the first player has cards 1, 2. The second player has cards 3, 4, 5.The first player chooses the card 1. The second player chooses the card 3. As 1<3, the second player gets both cards. Now the first player has only the card 2. The second player has cards 1, 3, 4, 5.The first player chooses the card 2. The second player chooses the card 4. As 2<4, the second player gets both cards. Now the first player is out of cards and loses. Therefore, the second player wins.Who will win if both players are playing optimally? It can be shown that one of the players has a winning strategy." 800.0                                      
          1268C "K Integers" "binary search,data structures" "You are given a permutation p1,p2,\xe2\x80\xa6,pn.In one move you can swap two adjacent values.You want to perform a minimum number of moves, such that in the end there will exist a subsegment 1,2,\xe2\x80\xa6,k, in other words in the end there should be an integer i, 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k+1 such that pi=1,pi+1=2,\xe2\x80\xa6,pi+k\xe2\x88\x921=k.Let f(k) be the minimum number of moves that you need to make a subsegment with values 1,2,\xe2\x80\xa6,k appear in the permutation.You need to find f(1),f(2),\xe2\x80\xa6,f(n)." 2300.0                                      
          1267L Lexicography "constructive algorithms,strings" "Lucy likes letters. She studied the definition of the lexicographical order at school and plays with it.At first, she tried to construct the lexicographically smallest word out of given letters. It was so easy! Then she tried to build multiple words and minimize one of them. This was much harder!Formally, Lucy wants to make n words of length l each out of the given n\xe2\x8b\x85l letters, so that the k-th of them in the lexicographic order is lexicographically as small as possible." 1800.0                                      
          1267I "Intriguing Selection" "brute force,constructive algorithms,implementation,interactive,sortings" "This is an interactive problem.You are the head coach of a chess club. The club has 2n players, each player has some strength which can be represented by a number, and all those numbers are distinct. The strengths of the players are not known to you.You need to select n players who would represent your club in the upcoming championship. Naturally, you want to select n players with the highest strengths.You can organize matches between the players to do that. In every match, you pick two players, they play some games, and you learn which one of the two has higher strength. You can wait for the outcome of a match before deciding who will participate in the next one.However, you do not want to know exactly how those n players compare between themselves, as that would make the championship itself less intriguing. More formally, you must reach a state where there is exactly one way to choose n players with the highest strengths that is consistent with the outcomes of the matches you organized, but there must be at least two possible orderings of those n players by strength that are consistent with the outcomes of the matches you organized." 2600.0                                      
          1266H "Red-Blue Graph" dp,graphs,math,matrices,meet-in-the-middle "There is a directed graph on n vertices numbered 1 through n where each vertex (except n) has two outgoing arcs, red and blue. At any point in time, exactly one of the arcs is active for each vertex. Initially, all blue arcs are active and there is a token located at vertex 1. In one second, the vertex with token first switches its active arcs \xe2\x80\x94 the inactive arc becomes active and vice versa. Then, the token is moved along the active arc. When the token reaches the vertex n, it stops. It is guaranteed that n is reachable via arcs from every vertex.You are given q queries. Each query contains a state of the graph \xe2\x80\x94 a pair (v,s) of the following form:   v is the vertex where the token is currently located;  s is a string consisting of n\xe2\x88\x921 characters. The i-th character corresponds to the color of the active edge leading from the i-th vertex (the character is \'R\' if red arc is active, otherwise the character is \'B\'). For each query, determine whether the given state is reachable from the initial state and the first time this configuration appears. Note that the two operations (change active arc and traverse it) are atomic \xe2\x80\x94 a state is not considered reached if it appears after changing the active arc but before traversing it." 3400.0                                      
          1266D "Decreasing Debts" "constructive algorithms,data structures,graphs,greedy,implementation,math,two pointers" "There are n people in this world, conveniently numbered 1 through n. They are using burles to buy goods and services. Occasionally, a person might not have enough currency to buy what he wants or needs, so he borrows money from someone else, with the idea that he will repay the loan later with interest. Let d(a,b) denote the debt of a towards b, or 0 if there is no such debt.Sometimes, this becomes very complex, as the person lending money can run into financial troubles before his debtor is able to repay his debt, and finds himself in the need of borrowing money. When this process runs for a long enough time, it might happen that there are so many debts that they can be consolidated. There are two ways this can be done:  Let d(a,b)>0 and d(c,d)>0 such that a\xe2\x89\xa0c or b\xe2\x89\xa0d. We can decrease the d(a,b) and d(c,d) by z and increase d(c,b) and d(a,d) by z, where 0<z\xe2\x89\xa4min(d(a,b),d(c,d)).  Let d(a,a)>0. We can set d(a,a) to 0. The total debt is defined as the sum of all debts:\xce\xa3d=\xe2\x88\x91a,bd(a,b)Your goal is to use the above rules in any order any number of times, to make the total debt as small as possible. Note that you don\'t have to minimise the number of non-zero debts, only the total debt." 2000.0                                      
          1265A "Beautiful String" "constructive algorithms,greedy" "A string is called beautiful if no two consecutive characters are equal. For example, ""ababcb"", ""a"" and ""abab"" are beautiful strings, while ""aaaaaa"", ""abaa"" and ""bb"" are not.Ahcl wants to construct a beautiful string. He has a string s, consisting of only characters \'a\', \'b\', \'c\' and \'?\'. Ahcl needs to replace each character \'?\' with one of the three characters \'a\', \'b\' or \'c\', such that the resulting string is beautiful. Please help him!More formally, after replacing all characters \'?\', the condition si\xe2\x89\xa0si+1 should be satisfied for all 1\xe2\x89\xa4i\xe2\x89\xa4|s|\xe2\x88\x921, where |s| is the length of the string s." 1000.0                                      
          1264D2 "Beautiful Bracket Sequence (hard version)" combinatorics,probabilities "This is the hard version of this problem. The only difference is the limit of n - the length of the input string. In this version, 1\xe2\x89\xa4n\xe2\x89\xa4106.Let\'s define a correct bracket sequence and its depth as follow:  An empty string is a correct bracket sequence with depth 0.  If ""s"" is a correct bracket sequence with depth d then ""(s)"" is a correct bracket sequence with depth d+1.  If ""s"" and ""t"" are both correct bracket sequences then their concatenation ""st"" is a correct bracket sequence with depth equal to the maximum depth of s and t. For a (not necessarily correct) bracket sequence s, we define its depth as the maximum depth of any correct bracket sequence induced by removing some characters from s (possibly zero). For example: the bracket sequence s=""())(())"" has depth 2, because by removing the third character we obtain a correct bracket sequence ""()(())"" with depth 2.Given a string a consists of only characters \'(\', \')\' and \'?\'. Consider all (not necessarily correct) bracket sequences obtained by replacing all characters \'?\' in a by either \'(\' or \')\'. Calculate the sum of all the depths of all these bracket sequences. As this number can be large, find it modulo 998244353.Hacks in this problem can be done only if easy and hard versions of this problem was solved." 2900.0                                      
          1257E "The Contest" "data structures,dp,greedy" "A team of three programmers is going to play a contest. The contest consists of n problems, numbered from 1 to n. Each problem is printed on a separate sheet of paper. The participants have decided to divide the problem statements into three parts: the first programmer took some prefix of the statements (some number of first paper sheets), the third contestant took some suffix of the statements (some number of last paper sheets), and the second contestant took all remaining problems. But something went wrong \xe2\x80\x94 the statements were printed in the wrong order, so the contestants have received the problems in some random order.The first contestant has received problems a1,1,a1,2,\xe2\x80\xa6,a1,k1. The second one has received problems a2,1,a2,2,\xe2\x80\xa6,a2,k2. The third one has received all remaining problems (a3,1,a3,2,\xe2\x80\xa6,a3,k3).The contestants don\'t want to play the contest before they redistribute the statements. They want to redistribute them so that the first contestant receives some prefix of the problemset, the third contestant receives some suffix of the problemset, and the second contestant receives all the remaining problems.During one move, some contestant may give one of their problems to other contestant. What is the minimum number of moves required to redistribute the problems?It is possible that after redistribution some participant (or even two of them) will not have any problems." 2000.0                                      
          1257A "Two Rival Students" greedy,math "You are the gym teacher in the school.There are n students in the row. And there are two rivalling students among them. The first one is in position a, the second in position b. Positions are numbered from 1 to n from left to right.Since they are rivals, you want to maximize the distance between them. If students are in positions p and s respectively, then distance between them is |p\xe2\x88\x92s|. You can do the following operation at most x times: choose two adjacent (neighbouring) students and swap them.Calculate the maximum distance between two rivalling students after at most x swaps." 800.0                                      
          1254D "Tree Queries" "data structures,probabilities,trees" "Hanh is a famous biologist. He loves growing trees and doing experiments on his own garden.One day, he got a tree consisting of n vertices. Vertices are numbered from 1 to n. A tree with n vertices is an undirected connected graph with n\xe2\x88\x921 edges. Initially, Hanh sets the value of every vertex to 0.Now, Hanh performs q operations, each is either of the following types:   Type 1: Hanh selects a vertex v and an integer d. Then he chooses some vertex r uniformly at random, lists all vertices u such that the path from r to u passes through v. Hanh then increases the value of all such vertices u by d.  Type 2: Hanh selects a vertex v and calculates the expected value of v. Since Hanh is good at biology but not math, he needs your help on these operations." 2700.0                                      
          1252J "Tiling Terrace" "brute force,dp" "Talia has just bought an abandoned house in the outskirt of Jakarta. The house has a nice and long yard which can be represented as a one-dimensional grid containing 1\xc3\x97N cells. To beautify the house, Talia is going to build a terrace on the yard by tiling the cells. Each cell on the yard contains either soil (represented by the character \'.\') or rock (represented by the character \'#\'), and there are at most 50 cells containing rocks.Being a superstitious person, Talia wants to tile the terrace with mystical tiles that have the power to repel ghosts. There are three types of mystical tiles:   Type-1: Covers 1\xc3\x971 cell and can only be placed on a soil cell (""."").  Type-2: Covers 1\xc3\x972 cells and can only be placed on two consecutive soil cells ("".."").  Type-3: Covers 1\xc3\x973 cells and can only be placed on consecutive soil-rock-soil cells ("".#.""). Each tile of Type-1, Type-2, and Type-3 has the power to repel G1, G2, and G3 ghosts per day, respectively. There are also some mystical rules which must be followed for the power to be effective:   There should be no overlapping tiles, i.e. each cell is covered by at most one tile.  There should be at most K tiles of Type-1, while there are no limitations for tiles of Type-2 and Type-3. Talia is scared of ghosts, thus, the terrace (which is tiled by mystical tiles) should be able to repel as many ghosts as possible. Help Talia to find the maximum number of ghosts that can be repelled per day by the terrace. Note that Talia does not need to tile all the cells on the yard as long as the number of ghosts that can be repelled by the terrace is maximum." 2300.0                                      
          1251E2 "Voting (Hard Version)" "binary search,data structures,greedy" "The only difference between easy and hard versions is constraints.Now elections are held in Berland and you want to win them. More precisely, you want everyone to vote for you.There are n voters, and two ways to convince each of them to vote for you. The first way to convince the i-th voter is to pay him pi coins. The second way is to make mi other voters vote for you, and the i-th voter will vote for free.Moreover, the process of such voting takes place in several steps. For example, if there are five voters with m1=1, m2=2, m3=2, m4=4, m5=5, then you can buy the vote of the fifth voter, and eventually everyone will vote for you. Set of people voting for you will change as follows: 5\xe2\x86\x921,5\xe2\x86\x921,2,3,5\xe2\x86\x921,2,3,4,5.Calculate the minimum number of coins you have to spend so that everyone votes for you." 2400.0                                      
          1250M SmartGarden "constructive algorithms,divide and conquer" "Berland Gardeners United Inc. hired you for the project called ""SmartGarden"". The main feature of this project is automatic garden watering.Formally the garden can be represented as a square of n\xc3\x97n cells with rows numbered 1 to n from top to bottom and columns numbered 1 to n from left to right. Each cell of the garden contains either a plant or a slab. It\'s known that slabs are located on the main diagonal of the matrix representing the garden, and in the cells that are below the main diagonal and share a side with at least one cell of the main diagonal. All the remaining cells of the garden are filled with plants.  Example of the garden for n=5. During implementation of the project you created a smart robot that takes a list of commands as an input, which are processed one by one. Each command contains:   a list of horizontal lines (rows in the matrix representing the garden);  a list of vertical lines (columns in the matrix representing the garden). While executing each command robot waters only cells in the intersection of specified rows and specified columns. So, if you specify r rows and c columns, then exactly r\xe2\x8b\x85c cells will be watered.In the demo for the customer you have tuned robot in such a way that it waters all the garden. To do that you prepared a single command containing all n rows and all n columns.Unfortunately, 5 hours before the demo for your customer it turned out that the CEO of Berland Gardeners United Inc. was going to take part in it. Moreover, most probably he will be standing on a garden slab during the demo!Now you need to create a list of commands for the robot so that it waters all the plants and doesn\'t water any cell containing a slab. Since it\'s only a beta version of ""SmartGarden"", the total number of commands shouldn\'t exceed 50.Create a program that, for a given size of the garden, will find a list of no more than 50 commands that allow the robot to water all the plants in the garden without watering the slabs. It is allowed to water a plant several times." 2500.0                                      
          1250J "The Parade" "binary search,greedy" "The Berland Army is preparing for a large military parade. It is already decided that the soldiers participating in it will be divided into k rows, and all rows will contain the same number of soldiers.Of course, not every arrangement of soldiers into k rows is suitable. Heights of all soldiers in the same row should not differ by more than 1. The height of each soldier is an integer between 1 and n.For each possible height, you know the number of soldiers having this height. To conduct a parade, you have to choose the soldiers participating in it, and then arrange all of the chosen soldiers into k rows so that both of the following conditions are met:  each row has the same number of soldiers,  no row contains a pair of soldiers such that their heights differ by 2 or more. Calculate the maximum number of soldiers who can participate in the parade." 1800.0                                      
          1249C2 "Good Numbers (hard version)" "binary search,greedy,math,meet-in-the-middle" "The only difference between easy and hard versions is the maximum value of n.You are given a positive integer number n. You really love good numbers so you want to find the smallest good number greater than or equal to n.The positive integer is called good if it can be represented as a sum of distinct powers of 3 (i.e. no duplicates of powers of 3 are allowed).For example:  30 is a good number: 30=33+31,  1 is a good number: 1=30,  12 is a good number: 12=32+31,  but 2 is not a good number: you can\'t represent it as a sum of distinct powers of 3 (2=30+30),  19 is not a good number: you can\'t represent it as a sum of distinct powers of 3 (for example, the representations 19=32+32+30=32+31+31+31+30 are invalid),  20 is also not a good number: you can\'t represent it as a sum of distinct powers of 3 (for example, the representation 20=32+32+30+30 is invalid). Note, that there exist other representations of 19 and 20 as sums of powers of 3 but none of them consists of distinct powers of 3.For the given positive integer n find such smallest m (n\xe2\x89\xa4m) that m is a good number.You have to answer q independent queries." 1500.0                                      
          1245A "Good ol\' Numbers Coloring" "math,number theory" "Consider the set of all nonnegative integers: 0,1,2,\xe2\x80\xa6. Given two integers a and b (1\xe2\x89\xa4a,b\xe2\x89\xa4104). We paint all the numbers in increasing number first we paint 0, then we paint 1, then 2 and so on.Each number is painted white or black. We paint a number i according to the following rules:   if i=0, it is colored white;   if i\xe2\x89\xa5a and i\xe2\x88\x92a is colored white, i is also colored white;   if i\xe2\x89\xa5b and i\xe2\x88\x92b is colored white, i is also colored white;   if i is still not colored white, it is colored black. In this way, each nonnegative integer gets one of two colors.For example, if a=3, b=5, then the colors of the numbers (in the order from 0) are: white (0), black (1), black (2), white (3), black (4), white (5), white (6), black (7), white (8), white (9), ...Note that:   It is possible that there are infinitely many nonnegative integers colored black. For example, if a=10 and b=10, then only 0,10,20,30 and any other nonnegative integers that end in 0 when written in base 10 are white. The other integers are colored black.   It is also possible that there are only finitely many nonnegative integers colored black. For example, when a=1 and b=10, then there is no nonnegative integer colored black at all. Your task is to determine whether or not the number of nonnegative integers colored black is infinite.If there are infinitely many nonnegative integers colored black, simply print a line containing ""Infinite"" (without the quotes). Otherwise, print ""Finite"" (without the quotes)." 1000.0                                      
          1244A "Pens and Pencils" math "Tomorrow is a difficult day for Polycarp: he has to attend a lectures and b practical classes at the university! Since Polycarp is a diligent student, he is going to attend all of them.While preparing for the university, Polycarp wonders whether he can take enough writing implements to write all of the lectures and draw everything he has to during all of the practical classes. Polycarp writes lectures using a pen (he can\'t use a pencil to write lectures!); he can write down c lectures using one pen, and after that it runs out of ink. During practical classes Polycarp draws blueprints with a pencil (he can\'t use a pen to draw blueprints!); one pencil is enough to draw all blueprints during d practical classes, after which it is unusable.Polycarp\'s pencilcase can hold no more than k writing implements, so if Polycarp wants to take x pens and y pencils, they will fit in the pencilcase if and only if x+y\xe2\x89\xa4k.Now Polycarp wants to know how many pens and pencils should he take. Help him to determine it, or tell that his pencilcase doesn\'t have enough room for all the implements he needs tomorrow!Note that you don\'t have to minimize the number of writing implements (though their total number must not exceed k)." 800.0                                      
          1243B2 "Character Swap (Hard Version)" strings "This problem is different from the easy version. In this version Ujan makes at most 2n swaps. In addition, k\xe2\x89\xa41000,n\xe2\x89\xa450 and it is necessary to print swaps themselves. You can hack this problem if you solve it. But you can hack the previous problem only if you solve both problems.After struggling and failing many times, Ujan decided to try to clean up his house again. He decided to get his strings in order first.Ujan has two distinct strings s and t of length n consisting of only of lowercase English characters. He wants to make them equal. Since Ujan is lazy, he will perform the following operation at most 2n times: he takes two positions i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n, the values i and j can be equal or different), and swaps the characters si and tj.Ujan\'s goal is to make the strings s and t equal. He does not need to minimize the number of performed operations: any sequence of operations of length 2n or shorter is suitable." 1600.0                                      
          1238F "The Maximum Subtree" "dfs and similar,dp,graphs,trees" "Assume that you have k one-dimensional segments s1,s2,\xe2\x80\xa6sk (each segment is denoted by two integers \xe2\x80\x94 its endpoints). Then you can build the following graph on these segments. The graph consists of k vertexes, and there is an edge between the i-th and the j-th vertexes (i\xe2\x89\xa0j) if and only if the segments si and sj intersect (there exists at least one point that belongs to both of them).For example, if s1=[1,6],s2=[8,20],s3=[4,10],s4=[2,13],s5=[17,18], then the resulting graph is the following:  A tree of size m is good if it is possible to choose m one-dimensional segments so that the graph built on these segments coincides with this tree.You are given a tree, you have to find its good subtree with maximum possible size. Recall that a subtree is a connected subgraph of a tree.Note that you have to answer q independent queries." 2200.0                                      
          1236D "Alice and the Doll" "brute force,data structures,greedy,implementation" "Alice got a new doll these days. It can even walk!Alice has built a maze for the doll and wants to test it. The maze is a grid with n rows and m columns. There are k obstacles, the i-th of them is on the cell (xi,yi), which means the cell in the intersection of the xi-th row and the yi-th column.However, the doll is clumsy in some ways. It can only walk straight or turn right at most once in the same cell (including the start cell). It cannot get into a cell with an obstacle or get out of the maze.More formally, there exist 4 directions, in which the doll can look:  The doll looks in the direction along the row from the first cell to the last. While moving looking in this direction the doll will move from the cell (x,y) into the cell (x,y+1);  The doll looks in the direction along the column from the first cell to the last. While moving looking in this direction the doll will move from the cell (x,y) into the cell (x+1,y);  The doll looks in the direction along the row from the last cell to first. While moving looking in this direction the doll will move from the cell (x,y) into the cell (x,y\xe2\x88\x921);  The doll looks in the direction along the column from the last cell to the first. While moving looking in this direction the doll will move from the cell (x,y) into the cell (x\xe2\x88\x921,y). .Standing in some cell the doll can move into the cell in the direction it looks or it can turn right once. Turning right once, the doll switches it\'s direction by the following rules: 1\xe2\x86\x922, 2\xe2\x86\x923, 3\xe2\x86\x924, 4\xe2\x86\x921. Standing in one cell, the doll can make at most one turn right.Now Alice is controlling the doll\'s moves. She puts the doll in of the cell (1,1) (the upper-left cell of the maze). Initially, the doll looks to the direction 1, so along the row from the first cell to the last. She wants to let the doll walk across all the cells without obstacles exactly once and end in any place. Can it be achieved?" 2300.0                                      
          1236C Labs "constructive algorithms,greedy,implementation" "In order to do some research, n2 labs are built on different heights of a mountain. Let\'s enumerate them with integers from 1 to n2, such that the lab with the number 1 is at the lowest place, the lab with the number 2 is at the second-lowest place, \xe2\x80\xa6, the lab with the number n2 is at the highest place.To transport water between the labs, pipes are built between every pair of labs. A pipe can transport at most one unit of water at a time from the lab with the number u to the lab with the number v if u>v.Now the labs need to be divided into n groups, each group should contain exactly n labs. The labs from different groups can transport water to each other. The sum of units of water that can be sent from a group A to a group B is equal to the number of pairs of labs (u,v) such that the lab with the number u is from the group A, the lab with the number v is from the group B and u>v. Let\'s denote this value as f(A,B) (i.e. f(A,B) is the sum of units of water that can be sent from a group A to a group B).For example, if n=3 and there are 3 groups X, Y and Z: X={1,5,6},Y={2,4,9} and Z={3,7,8}. In this case, the values of f are equal to:  f(X,Y)=4 because of 5\xe2\x86\x922, 5\xe2\x86\x924, 6\xe2\x86\x922, 6\xe2\x86\x924,  f(X,Z)=2 because of 5\xe2\x86\x923, 6\xe2\x86\x923,  f(Y,X)=5 because of 2\xe2\x86\x921, 4\xe2\x86\x921, 9\xe2\x86\x921, 9\xe2\x86\x925, 9\xe2\x86\x926,  f(Y,Z)=4 because of 4\xe2\x86\x923, 9\xe2\x86\x923, 9\xe2\x86\x927, 9\xe2\x86\x928,  f(Z,X)=7 because of 3\xe2\x86\x921, 7\xe2\x86\x921, 7\xe2\x86\x925, 7\xe2\x86\x926, 8\xe2\x86\x921, 8\xe2\x86\x925, 8\xe2\x86\x926,  f(Z,Y)=5 because of 3\xe2\x86\x922, 7\xe2\x86\x922, 7\xe2\x86\x924, 8\xe2\x86\x922, 8\xe2\x86\x924. Please, divide labs into n groups with size n, such that the value minf(A,B) over all possible pairs of groups A and B (A\xe2\x89\xa0B) is maximal.In other words, divide labs into n groups with size n, such that minimum number of the sum of units of water that can be transported from a group A to a group B for every pair of different groups A and B (A\xe2\x89\xa0B) as big as possible.Note, that the example above doesn\'t demonstrate an optimal division, but it demonstrates how to calculate the values f for some division.If there are many optimal divisions, you can find any." 1300.0                                      
          1236A Stones "brute force,greedy,math" "Alice is playing with some stones.Now there are three numbered heaps of stones. The first of them contains a stones, the second of them contains b stones and the third of them contains c stones.Each time she can do one of two operations:  take one stone from the first heap and two stones from the second heap (this operation can be done only if the first heap contains at least one stone and the second heap contains at least two stones);  take one stone from the second heap and two stones from the third heap (this operation can be done only if the second heap contains at least one stone and the third heap contains at least two stones). She wants to get the maximum number of stones, but she doesn\'t know what to do. Initially, she has 0 stones. Can you help her?" 800.0                                      
          1234B1 "Social Network (easy version)" implementation "The only difference between easy and hard versions are constraints on n and k.You are messaging in one of the popular social networks via your smartphone. Your smartphone can show at most k most recent conversations with your friends. Initially, the screen is empty (i.e. the number of displayed conversations equals 0).Each conversation is between you and some of your friends. There is at most one conversation with any of your friends. So each conversation is uniquely defined by your friend.You (suddenly!) have the ability to see the future. You know that during the day you will receive n messages, the i-th message will be received from the friend with ID idi (1\xe2\x89\xa4idi\xe2\x89\xa4109).If you receive a message from idi in the conversation which is currently displayed on the smartphone then nothing happens: the conversations of the screen do not change and do not change their order, you read the message and continue waiting for new messages.Otherwise (i.e. if there is no conversation with idi on the screen):  Firstly, if the number of conversations displayed on the screen is k, the last conversation (which has the position k) is removed from the screen.  Now the number of conversations on the screen is guaranteed to be less than k and the conversation with the friend idi is not displayed on the screen.  The conversation with the friend idi appears on the first (the topmost) position on the screen and all the other displayed conversations are shifted one position down. Your task is to find the list of conversations (in the order they are displayed on the screen) after processing all n messages." 1000.0                                      
          1227D1 "Optimal Subsequences (Easy Version)" "data structures,greedy" "This is the easier version of the problem. In this version 1\xe2\x89\xa4n,m\xe2\x89\xa4100. You can hack this problem only if you solve and lock both problems.You are given a sequence of integers a=[a1,a2,\xe2\x80\xa6,an] of length n. Its subsequence is obtained by removing zero or more elements from the sequence a (they do not necessarily go consecutively). For example, for the sequence a=[11,20,11,33,11,20,11]:  [11,20,11,33,11,20,11], [11,20,11,33,11,20], [11,11,11,11], [20], [33,20] are subsequences (these are just some of the long list);  [40], [33,33], [33,20,20], [20,20,11,11] are not subsequences. Suppose that an additional non-negative integer k (1\xe2\x89\xa4k\xe2\x89\xa4n) is given, then the subsequence is called optimal if:  it has a length of k and the sum of its elements is the maximum possible among all subsequences of length k;  and among all subsequences of length k that satisfy the previous item, it is lexicographically minimal. Recall that the sequence b=[b1,b2,\xe2\x80\xa6,bk] is lexicographically smaller than the sequence c=[c1,c2,\xe2\x80\xa6,ck] if the first element (from the left) in which they differ less in the sequence b than in c. Formally: there exists t (1\xe2\x89\xa4t\xe2\x89\xa4k) such that b1=c1, b2=c2, ..., bt\xe2\x88\x921=ct\xe2\x88\x921 and at the same time bt<ct. For example:  [10,20,20] lexicographically less than [10,21,1],  [7,99,99] is lexicographically less than [10,21,1],  [10,21,0] is lexicographically less than [10,21,1]. You are given a sequence of a=[a1,a2,\xe2\x80\xa6,an] and m requests, each consisting of two numbers kj and posj (1\xe2\x89\xa4k\xe2\x89\xa4n, 1\xe2\x89\xa4posj\xe2\x89\xa4kj). For each query, print the value that is in the index posj of the optimal subsequence of the given sequence a for k=kj.For example, if n=4, a=[10,20,30,20], kj=2, then the optimal subsequence is [20,30] \xe2\x80\x94 it is the minimum lexicographically among all subsequences of length 2 with the maximum total sum of items. Thus, the answer to the request kj=2, posj=1 is the number 20, and the answer to the request kj=2, posj=2 is the number 30." 1600.0                                      
          1227A "Math Problem" math "Your math teacher gave you the following problem:There are n segments on the x-axis, [l1;r1],[l2;r2],\xe2\x80\xa6,[ln;rn]. The segment [l;r] includes the bounds, i.e. it is a set of such x that l\xe2\x89\xa4x\xe2\x89\xa4r. The length of the segment [l;r] is equal to r\xe2\x88\x92l.Two segments [a;b] and [c;d] have a common point (intersect) if there exists x that a\xe2\x89\xa4x\xe2\x89\xa4b and c\xe2\x89\xa4x\xe2\x89\xa4d. For example, [2;5] and [3;10] have a common point, but [5;6] and [1;4] don\'t have.You should add one segment, which has at least one common point with each of the given segments and as short as possible (i.e. has minimal length). The required segment can degenerate to be a point (i.e a segment with length zero). The added segment may or may not be among the given n segments.In other words, you need to find a segment [a;b], such that [a;b] and every [li;ri] have a common point for each i, and b\xe2\x88\x92a is minimal." 1100.0                                      
          1225B1 "TV Subscriptions (Easy Version)" implementation "The only difference between easy and hard versions is constraints.The BerTV channel every day broadcasts one episode of one of the k TV shows. You know the schedule for the next n days: a sequence of integers a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4k), where ai is the show, the episode of which will be shown in i-th day.The subscription to the show is bought for the entire show (i.e. for all its episodes), for each show the subscription is bought separately.How many minimum subscriptions do you need to buy in order to have the opportunity to watch episodes of purchased shows d (1\xe2\x89\xa4d\xe2\x89\xa4n) days in a row? In other words, you want to buy the minimum number of TV shows so that there is some segment of d consecutive days in which all episodes belong to the purchased shows." 1000.0                                      
          1221G "Graph And Numbers" "bitmasks,brute force,combinatorics,dp,meet-in-the-middle" "You are given an undirected graph with n vertices and m edges. You have to write a number on each vertex of this graph, each number should be either 0 or 1. After that, you write a number on each edge equal to the sum of numbers on vertices incident to that edge.You have to choose the numbers you will write on the vertices so that there is at least one edge with 0 written on it, at least one edge with 1 and at least one edge with 2. How many ways are there to do it? Two ways to choose numbers are different if there exists at least one vertex which has different numbers written on it in these two ways." 2900.0                                      
          1220B "Multiplication Table" "math,number theory" "Sasha grew up and went to first grade. To celebrate this event her mother bought her a multiplication table M with n rows and n columns such that Mij=ai\xe2\x8b\x85aj where a1,\xe2\x80\xa6,an is some sequence of positive integers.Of course, the girl decided to take it to school with her. But while she was having lunch, hooligan Grisha erased numbers on the main diagonal and threw away the array a1,\xe2\x80\xa6,an. Help Sasha restore the array!" 1300.0                                      
          1220A Cards implementation,sortings,strings "When Serezha was three years old, he was given a set of cards with letters for his birthday. They were arranged into words in the way which formed the boy\'s mother favorite number in binary notation. Serezha started playing with them immediately and shuffled them because he wasn\'t yet able to read. His father decided to rearrange them. Help him restore the original number, on condition that it was the maximum possible one." 800.0                                      
          1218E "Product Tuples" "divide and conquer,fft" "While roaming the mystic areas of Stonefalls, in order to drop legendary loot, an adventurer was given a quest as follows. He was given an array A=a1,a2,...,aN of length N, and a number K.Define array B as B(q,A)= { q\xe2\x88\x92a1,q\xe2\x88\x92a2,...,q\xe2\x88\x92aN }. Define function F as F(B,K) being sum of products of all K-tuples of elements in array B. For example, if the array B is [2,3,4,5], and with K=3, sum of products of all 3-tuples is F(B,3)=2\xe2\x88\x973\xe2\x88\x974+2\xe2\x88\x973\xe2\x88\x975+3\xe2\x88\x974\xe2\x88\x975+2\xe2\x88\x974\xe2\x88\x975He was then given a number Q, number of queries of two types:   Type 1: Given q, i, and d calculate F(B(q,A),K) where we make change to initial array as A[i]=d.  Type 2: Given q, L, R, and d calculate F(B(q,A),K) where we make change to initial array as A[i]=A[i]+d for all i in range [L,R] inclusive. All changes are temporarily made to initial array, and don\'t propagate to following queries. Help the adventurer calculate the answer to a quest, and finally get that loot!" 2500.0                                      
          1215E Marbles bitmasks,dp "Monocarp has arranged n colored marbles in a row. The color of the i-th marble is ai. Monocarp likes ordered things, so he wants to rearrange marbles in such a way that all marbles of the same color form a contiguos segment (and there is only one such segment for each color). In other words, Monocarp wants to rearrange marbles so that, for every color j, if the leftmost marble of color j is l-th in the row, and the rightmost marble of this color has position r in the row, then every marble from l to r has color j.To achieve his goal, Monocarp can do the following operation any number of times: choose two neighbouring marbles, and swap them.You have to calculate the minimum number of operations Monocarp has to perform to rearrange the marbles. Note that the order of segments of marbles having equal color does not matter, it is only required that, for every color, all the marbles of this color form exactly one contiguous segment." 2200.0                                      
          1215B "The Number of Products" combinatorics,dp,implementation "You are given a sequence a1,a2,\xe2\x80\xa6,an consisting of n non-zero integers (i.e. ai\xe2\x89\xa00). You have to calculate two following values:  the number of pairs of indices (l,r) (l\xe2\x89\xa4r) such that al\xe2\x8b\x85al+1\xe2\x80\xa6ar\xe2\x88\x921\xe2\x8b\x85ar is negative;  the number of pairs of indices (l,r) (l\xe2\x89\xa4r) such that al\xe2\x8b\x85al+1\xe2\x80\xa6ar\xe2\x88\x921\xe2\x8b\x85ar is positive;" 1400.0                                      
          1214E "Petya and Construction Set" "constructive algorithms,graphs,math,sortings,trees" "It\'s Petya\'s birthday party and his friends have presented him a brand new ""Electrician-n"" construction set, which they are sure he will enjoy as he always does with weird puzzles they give him.Construction set ""Electrician-n"" consists of 2n\xe2\x88\x921 wires and 2n light bulbs. Each bulb has its own unique index that is an integer from 1 to 2n, while all wires look the same and are indistinguishable. In order to complete this construction set one has to use each of the wires to connect two distinct bulbs. We define a chain in a completed construction set as a sequence of distinct bulbs of length at least two, such that every two consecutive bulbs in this sequence are directly connected by a wire. Completed construction set configuration is said to be correct if a resulting network of bulbs and wires has a tree structure, i.e. any two distinct bulbs are the endpoints of some chain.Petya was assembling different configurations for several days, and he noticed that sometimes some of the bulbs turn on. After a series of experiments he came up with a conclusion that bulbs indexed 2i and 2i\xe2\x88\x921 turn on if the chain connecting them consists of exactly di wires. Moreover, the following important condition holds: the value of di is never greater than n.Petya did his best but was not able to find a configuration that makes all bulbs to turn on, so he seeks your assistance. Please, find out a configuration that makes all bulbs shine. It is guaranteed that such configuration always exists." 2000.0                                      
          1213F "Unstable String Sort" "data structures,dfs and similar,dsu,graphs,greedy,implementation,strings" "Authors have come up with the string s consisting of n lowercase Latin letters.You are given two permutations of its indices (not necessary equal) p and q (both of length n). Recall that the permutation is the array of length n which contains each integer from 1 to n exactly once.For all i from 1 to n\xe2\x88\x921 the following properties hold: s[pi]\xe2\x89\xa4s[pi+1] and s[qi]\xe2\x89\xa4s[qi+1]. It means that if you will write down all characters of s in order of permutation indices, the resulting string will be sorted in the non-decreasing order.Your task is to restore any such string s of length n consisting of at least k distinct lowercase Latin letters which suits the given permutations.If there are multiple answers, you can print any of them." 2100.0                                      
          1211C "Ice Cream" "*special problem,greedy,sortings" "Summer in Berland lasts n days, the price of one portion of ice cream on the i-th day is ci. Over the summer, Tanya wants to eat exactly k portions of ice cream. At the same time, on the i-th day, she decided that she would eat at least ai portions, but not more than bi (ai\xe2\x89\xa4bi) portions. In other words, let di be equal to the number of portions that she eats on the i-th day. Then d1+d2+\xe2\x8b\xaf+dn=k and ai\xe2\x89\xa4di\xe2\x89\xa4bi for each i.Given that portions of ice cream can only be eaten on the day of purchase, find the minimum amount of money that Tanya can spend on ice cream in the summer." 1700.0                                      
          1209H "Moving Walkways" "data structures,greedy,math" "Airports often use moving walkways to help you walking big distances faster. Each such walkway has some speed that effectively increases your speed. You can stand on such a walkway and let it move you, or you could also walk and then your effective speed is your walking speed plus walkway\'s speed.Limak wants to get from point 0 to point L on a straight line. There are n disjoint walkways in between. The i-th walkway is described by two integers xi and yi and a real value si. The i-th walkway starts at xi, ends at yi and has speed si. Every walkway is located inside the segment [0,L] and no two walkways have positive intersection. However, they can touch by endpoints.Limak needs to decide how to distribute his energy. For example, it might make more sense to stand somewhere (or to walk slowly) to then have a lot of energy to walk faster.Limak\'s initial energy is 0 and it must never drop below that value. At any moment, he can walk with any speed v in the interval [0,2] and it will cost him v energy per second, but he continuously recovers energy with speed of 1 energy per second. So, when he walks with speed v, his energy increases by (1\xe2\x88\x92v). Note that negative value would mean losing energy.In particular, he can walk with speed 1 and this won\'t change his energy at all, while walking with speed 0.77 effectively gives him 0.23 energy per second.Limak can choose his speed arbitrarily (any real value in interval [0,2]) at every moment of time (including the moments when he is located on non-integer positions). Everything is continuous (non-discrete).What is the fastest time Limak can get from 0 to L?" 3300.0                                      
          1209G2 "Into Blocks (hard version)" "data structures" "This is a harder version of the problem. In this version q\xe2\x89\xa4200000.A sequence of integers is called nice if its elements are arranged in blocks like in [3,3,3,4,1,1]. Formally, if two elements are equal, everything in between must also be equal.Let\'s define difficulty of a sequence as a minimum possible number of elements to change to get a nice sequence. However, if you change at least one element of value x to value y, you must also change all other elements of value x into y as well. For example, for [3,3,1,3,2,1,2] it isn\'t allowed to change first 1 to 3 and second 1 to 2. You need to leave 1\'s untouched or change them to the same value.You are given a sequence of integers a1,a2,\xe2\x80\xa6,an and q updates.Each update is of form ""i x"" \xe2\x80\x94 change ai to x. Updates are not independent (the change stays for the future).Print the difficulty of the initial sequence and of the sequence after every update." 3200.0                                      
          1209E1 "Rotate Columns (easy version)" "bitmasks,brute force,dp,greedy,sortings" "This is an easier version of the next problem. The difference is only in constraints.You are given a rectangular n\xc3\x97m matrix a. In one move you can choose any column and cyclically shift elements in this column. You can perform this operation as many times as you want (possibly zero). You can perform this operation to a column multiple times.After you are done with cyclical shifts, you compute for every row the maximal value in it. Suppose that for i-th row it is equal ri. What is the maximal possible value of r1+r2+\xe2\x80\xa6+rn?" 2000.0                                      
          1209D "Cow and Snacks" "dfs and similar,dsu,graphs" "The legendary Farmer John is throwing a huge party, and animals from all over the world are hanging out at his house. His guests are hungry, so he instructs his cow Bessie to bring out the snacks! Moo!There are n snacks flavors, numbered with integers 1,2,\xe2\x80\xa6,n. Bessie has n snacks, one snack of each flavor. Every guest has exactly two favorite flavors. The procedure for eating snacks will go as follows:  First, Bessie will line up the guests in some way.  Then in this order, guests will approach the snacks one by one.  Each guest in their turn will eat all remaining snacks of their favorite flavor. In case no favorite flavors are present when a guest goes up, they become very sad.  Help Bessie to minimize the number of sad guests by lining the guests in an optimal way." 1700.0                                      
          1205D "Almost All" "constructive algorithms,trees" "You are given a tree with n nodes. You have to write non-negative integers on its edges so that the following condition would be satisfied:For every two nodes i, j, look at the path between them and count the sum of numbers on the edges of this path. Write all obtained sums on the blackboard. Then every integer from 1 to \xe2\x8c\x8a2n29\xe2\x8c\x8b has to be written on the blackboard at least once. It is guaranteed that such an arrangement exists." 2700.0                                      
          1204D1 "Kirk and a Binary String (easy version)" "brute force,greedy,strings" "The only difference between easy and hard versions is the length of the string. You can hack this problem only if you solve both problems.Kirk has a binary string s (a string which consists of zeroes and ones) of length n and he is asking you to find a binary string t of the same length which satisfies the following conditions: For any l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) the length of the longest non-decreasing subsequence of the substring slsl+1\xe2\x80\xa6sr is equal to the length of the longest non-decreasing subsequence of the substring tltl+1\xe2\x80\xa6tr; The number of zeroes in t is the maximum possible.A non-decreasing subsequence of a string p is a sequence of indices i1,i2,\xe2\x80\xa6,ik such that i1<i2<\xe2\x80\xa6<ik and pi1\xe2\x89\xa4pi2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4pik. The length of the subsequence is k.If there are multiple substrings which satisfy the conditions, output any." 2000.0                                      
          1204A "BowWow and the Timetable" math "In the city of Saint Petersburg, a day lasts for 2100 minutes. From the main station of Saint Petersburg, a train departs after 1 minute, 4 minutes, 16 minutes, and so on; in other words, the train departs at time 4k for each integer k\xe2\x89\xa50. Team BowWow has arrived at the station at the time s and it is trying to count how many trains have they missed; in other words, the number of trains that have departed strictly before time s. For example if s=20, then they missed trains which have departed at 1, 4 and 16. As you are the only one who knows the time, help them!Note that the number s will be given you in a binary representation without leading zeroes." 1000.0                                      
          1203D2 "Remove the Substring (hard version)" "binary search,greedy,implementation,two pointers" "The only difference between easy and hard versions is the length of the string.You are given a string s and a string t, both consisting only of lowercase Latin letters. It is guaranteed that t can be obtained from s by removing some (possibly, zero) number of characters (not necessary contiguous) from s without changing order of remaining characters (in other words, it is guaranteed that t is a subsequence of s).For example, the strings ""test"", ""tst"", ""tt"", ""et"" and """" are subsequences of the string ""test"". But the strings ""tset"", ""se"", ""contest"" are not subsequences of the string ""test"".You want to remove some substring (contiguous subsequence) from s of maximum possible length such that after removing this substring t will remain a subsequence of s.If you want to remove the substring s[l;r] then the string s will be transformed to s1s2\xe2\x80\xa6sl\xe2\x88\x921sr+1sr+2\xe2\x80\xa6s|s|\xe2\x88\x921s|s| (where |s| is the length of s).Your task is to find the maximum possible length of the substring you can remove so that t is still a subsequence of s." 1700.0                                      
          1201A "Important Exam" implementation,strings "A class of students wrote a multiple-choice test.There are n students in the class. The test had m questions, each of them had 5 possible answers (A, B, C, D or E). There is exactly one correct answer for each question. The correct answer for question i worth ai points. Incorrect answers are graded with zero points.The students remember what answers they gave on the exam, but they don\'t know what are the correct answers. They are very optimistic, so they want to know what is the maximum possible total score of all students in the class." 900.0                                      
          1200E "Compress Words" "brute force,hashing,implementation,string suffix structures,strings" "Amugae has a sentence consisting of n words. He want to compress this sentence into one word. Amugae doesn\'t like repetitions, so when he merges two words into one word, he removes the longest prefix of the second word that coincides with a suffix of the first word. For example, he merges ""sample"" and ""please"" into ""samplease"".Amugae will merge his sentence left to right (i.e. first merge the first two words, then merge the result with the third word and so on). Write a program that prints the compressed word after the merging process ends." 2000.0                                      
          1200C "Round Corridor" "math,number theory" "Amugae is in a very large round corridor. The corridor consists of two areas. The inner area is equally divided by n sectors, and the outer area is equally divided by m sectors. A wall exists between each pair of sectors of same area (inner or outer), but there is no wall between the inner area and the outer area. A wall always exists at the 12 o\'clock position.  The inner area\'s sectors are denoted as (1,1),(1,2),\xe2\x80\xa6,(1,n) in clockwise direction. The outer area\'s sectors are denoted as (2,1),(2,2),\xe2\x80\xa6,(2,m) in the same manner. For a clear understanding, see the example image above.Amugae wants to know if he can move from one sector to another sector. He has q questions.For each question, check if he can move between two given sectors." 1400.0                                      
          1198F "GCD Groups 2" "greedy,number theory,probabilities" "You are given an array of n integers. You need to split all integers into two groups so that the GCD of all integers in the first group is equal to one and the GCD of all integers in the second group is equal to one.The GCD of a group of integers is the largest non-negative integer that divides all the integers in the group.Both groups have to be non-empty." 2900.0                                      
          1198E "Rectangle Painting 2" "flows,graph matchings,graphs" "There is a square grid of size n\xc3\x97n. Some cells are colored in black, all others are colored in white. In one operation you can select some rectangle and color all its cells in white. It costs min(h,w) to color a rectangle of size h\xc3\x97w. You are to make all cells white for minimum total cost.The square is large, so we give it to you in a compressed way. The set of black cells is the union of m rectangles." 2500.0                                      
          1196C "Robot Breakout" implementation "n robots have escaped from your laboratory! You have to find them as soon as possible, because these robots are experimental, and their behavior is not tested yet, so they may be really dangerous!Fortunately, even though your robots have escaped, you still have some control over them. First of all, you know the location of each robot: the world you live in can be modeled as an infinite coordinate plane, and the i-th robot is currently located at the point having coordinates (xi, yi). Furthermore, you may send exactly one command to all of the robots. The command should contain two integer numbers X and Y, and when each robot receives this command, it starts moving towards the point having coordinates (X, Y). The robot stops its movement in two cases:  either it reaches (X, Y);  or it cannot get any closer to (X, Y). Normally, all robots should be able to get from any point of the coordinate plane to any other point. Each robot usually can perform four actions to move. Let\'s denote the current coordinates of the robot as (xc, yc). Then the movement system allows it to move to any of the four adjacent points:  the first action allows it to move from (xc, yc) to (xc\xe2\x88\x921, yc);  the second action allows it to move from (xc, yc) to (xc, yc+1);  the third action allows it to move from (xc, yc) to (xc+1, yc);  the fourth action allows it to move from (xc, yc) to (xc, yc\xe2\x88\x921). Unfortunately, it seems that some movement systems of some robots are malfunctioning. For each robot you know which actions it can perform, and which it cannot perform.You want to send a command so all robots gather at the same point. To do so, you have to choose a pair of integer numbers X and Y so that each robot can reach the point (X, Y). Is it possible to find such a point?" 1500.0                                      
          1195F "Geometers Anonymous Club" "data structures,geometry,math,sortings" "Denis holds a Geometers Anonymous Club meeting in SIS. He has prepared n convex polygons numbered from 1 to n for the club. He plans to offer members of the club to calculate Minkowski sums of these polygons. More precisely, he plans to give q tasks, the i-th of them asks to calculate the sum of Minkowski of polygons with indices from li to ri inclusive.The sum of Minkowski of two sets A and B is the set C={a+b:a\xe2\x88\x88A,b\xe2\x88\x88B}. It can be proven that if A and B are convex polygons then C will also be a convex polygon.   Sum of two convex polygons To calculate the sum of Minkowski of p polygons (p>2), you need to calculate the sum of Minkowski of the first p\xe2\x88\x921 polygons, and then calculate the sum of Minkowski of the resulting polygon and the p-th polygon.For the convenience of checking answers, Denis has decided to prepare and calculate the number of vertices in the sum of Minkowski for each task he prepared. Help him to do it." 2500.0                                      
          1194E "Count The Rectangles" "bitmasks,brute force,data structures,geometry,sortings" "There are n segments drawn on a plane; the i-th segment connects two points (xi,1, yi,1) and (xi,2, yi,2). Each segment is non-degenerate, and is either horizontal or vertical \xe2\x80\x94 formally, for every i\xe2\x88\x88[1,n] either xi,1=xi,2 or yi,1=yi,2 (but only one of these conditions holds). Only segments of different types may intersect: no pair of horizontal segments shares any common points, and no pair of vertical segments shares any common points.We say that four segments having indices h1, h2, v1 and v2 such that h1<h2 and v1<v2 form a rectangle if the following conditions hold:  segments h1 and h2 are horizontal;  segments v1 and v2 are vertical;  segment h1 intersects with segment v1;  segment h2 intersects with segment v1;  segment h1 intersects with segment v2;  segment h2 intersects with segment v2. Please calculate the number of ways to choose four segments so they form a rectangle. Note that the conditions h1<h2 and v1<v2 should hold." 2200.0                                      
          1191B "Tokitsukaze and Mahjong" "brute force,implementation" "Tokitsukaze is playing a game derivated from Japanese mahjong. In this game, she has three tiles in her hand. Each tile she owns is a suited tile, which means it has a suit (manzu, pinzu or souzu) and a number (a digit ranged from 1 to 9). In this problem, we use one digit and one lowercase letter, which is the first character of the suit, to represent a suited tile. All possible suited tiles are represented as 1m, 2m, \xe2\x80\xa6, 9m, 1p, 2p, \xe2\x80\xa6, 9p, 1s, 2s, \xe2\x80\xa6, 9s.In order to win the game, she must have at least one mentsu (described below) in her hand, so sometimes she should draw extra suited tiles. After drawing a tile, the number of her tiles increases by one. She can draw any tiles she wants, including those already in her hand.Do you know the minimum number of extra suited tiles she needs to draw so that she can win?Here are some useful definitions in this game:  A mentsu, also known as meld, is formed by a koutsu or a shuntsu;  A koutsu, also known as triplet, is made of three identical tiles, such as [1m, 1m, 1m], however, [1m, 1p, 1s] or [1m, 4m, 7m] is NOT a koutsu;  A shuntsu, also known as sequence, is made of three sequential numbered tiles in the same suit, such as [1m, 2m, 3m] and [5s, 7s, 6s], however, [9m, 1m, 2m] or [1m, 2p, 3s] is NOT a shuntsu. Some examples:   [2m, 3p, 2s, 4m, 1s, 2s, 4s] \xe2\x80\x94 it contains no koutsu or shuntsu, so it includes no mentsu;  [4s, 3m, 3p, 4s, 5p, 4s, 5p] \xe2\x80\x94 it contains a koutsu, [4s, 4s, 4s], but no shuntsu, so it includes a mentsu;  [5p, 5s, 9m, 4p, 1s, 7p, 7m, 6p] \xe2\x80\x94 it contains no koutsu but a shuntsu, [5p, 4p, 6p] or [5p, 7p, 6p], so it includes a mentsu. Note that the order of tiles is unnecessary and you can assume the number of each type of suited tiles she can draw is infinite." 1200.0                                      
          1190B "Tokitsukaze, CSL and Stone Game" games "Tokitsukaze and CSL are playing a little game of stones.In the beginning, there are n piles of stones, the i-th pile of which has ai stones. The two players take turns making moves. Tokitsukaze moves first. On each turn the player chooses a nonempty pile and removes exactly one stone from the pile. A player loses if all of the piles are empty before his turn, or if after removing the stone, two piles (possibly empty) contain the same number of stones. Supposing that both players play optimally, who will win the game?Consider an example: n=3 and sizes of piles are a1=2, a2=3, a3=0. It is impossible to choose the empty pile, so Tokitsukaze has two choices: the first and the second piles. If she chooses the first pile then the state will be [1,3,0] and it is a good move. But if she chooses the second pile then the state will be [2,2,0] and she immediately loses. So the only good move for her is to choose the first pile. Supposing that both players always take their best moves and never make mistakes, who will win the game?Note that even if there are two piles with the same number of stones at the beginning, Tokitsukaze may still be able to make a valid first move. It is only necessary that there are no two piles with the same number of stones after she moves." 1800.0                                      
          1188E "Problem from Red Panda" combinatorics "At Moscow Workshops ICPC team gets a balloon for each problem they solved first. Team MSU Red Panda got so many balloons that they didn\'t know how to spend them. So they came up with a problem with them.There are several balloons, not more than 106 in total, each one is colored in one of k colors. We can perform the following operation: choose k\xe2\x88\x921 balloons such that they are of k\xe2\x88\x921 different colors, and recolor them all into remaining color. We can perform this operation any finite number of times (for example, we can only perform the operation if there are at least k\xe2\x88\x921 different colors among current balls).How many different balloon configurations can we get? Only number of balloons of each color matters, configurations differing only by the order of balloons are counted as equal. As this number can be very large, output it modulo 998244353." 3300.0                                      
          1187E "Tree Painting" "dfs and similar,dp,trees" "You are given a tree (an undirected connected acyclic graph) consisting of n vertices. You are playing a game on this tree.Initially all vertices are white. On the first turn of the game you choose one vertex and paint it black. Then on each turn you choose a white vertex adjacent (connected by an edge) to any black vertex and paint it black.Each time when you choose a vertex (even during the first turn), you gain the number of points equal to the size of the connected component consisting only of white vertices that contains the chosen vertex. The game ends when all vertices are painted black.Let\'s see the following example:Vertices 1 and 4 are painted black already. If you choose the vertex 2, you will gain 4 points for the connected component consisting of vertices 2,3,5 and 6. If you choose the vertex 9, you will gain 3 points for the connected component consisting of vertices 7,8 and 9.Your task is to maximize the number of points you gain." 2100.0                                      
          1185C1 "Exam in BerSU (easy version)" greedy,sortings "The only difference between easy and hard versions is constraints.A session has begun at Beland State University. Many students are taking exams.Polygraph Poligrafovich is going to examine a group of n students. Students will take the exam one-by-one in order from 1-th to n-th. Rules of the exam are following:  The i-th student randomly chooses a ticket.  if this ticket is too hard to the student, he doesn\'t answer and goes home immediately (this process is so fast that it\'s considered no time elapses). This student fails the exam.  if the student finds the ticket easy, he spends exactly ti minutes to pass the exam. After it, he immediately gets a mark and goes home. Students take the exam in the fixed order, one-by-one, without any interruption. At any moment of time, Polygraph Poligrafovich takes the answer from one student.The duration of the whole exam for all students is M minutes (maxti\xe2\x89\xa4M), so students at the end of the list have a greater possibility to run out of time to pass the exam.For each student i, you should count the minimum possible number of students who need to fail the exam so the i-th student has enough time to pass the exam.For each student i, find the answer independently. That is, if when finding the answer for the student i1 some student j should leave, then while finding the answer for i2 (i2>i1) the student j student does not have to go home." 1200.0                                      
          1184E1 "Daleks\' Invasion (easy)" graphs,trees "Heidi found out that the Daleks have created a network of bidirectional Time Corridors connecting different destinations (at different times!). She suspects that they are planning another invasion on the entire Space and Time. In order to counter the invasion, she plans to deploy a trap in the Time Vortex, along a carefully chosen Time Corridor. She knows that tinkering with the Time Vortex is dangerous, so she consulted the Doctor on how to proceed. She has learned the following:  Different Time Corridors require different amounts of energy to keep stable.  Daleks are unlikely to use all corridors in their invasion. They will pick a set of Corridors that requires the smallest total energy to maintain, yet still makes (time) travel possible between any two destinations (for those in the know: they will use a minimum spanning tree).  Setting the trap may modify the energy required to keep the Corridor stable. Heidi decided to carry out a field test and deploy one trap, placing it along the first Corridor. But she needs to know whether the Daleks are going to use this corridor after the deployment of the trap. She gives you a map of Time Corridors (an undirected graph) with energy requirements for each Corridor.For a Corridor c, Emax(c) is the largest e\xe2\x89\xa4109 such that if we changed the required amount of energy of c to e, then the Daleks may still be using c in their invasion (that is, it belongs to some minimum spanning tree). Your task is to calculate Emax(c1) for the Corridor c1 that Heidi plans to arm with a trap, which is the first edge in the graph." 1900.0                                      
          1184B1 "The Doctor Meets Vader (Easy)" "binary search,sortings" "Heidi and Doctor Who hopped out of the TARDIS and found themselves at EPFL in 2018. They were surrounded by stormtroopers and Darth Vader was approaching. Miraculously, they managed to escape to a nearby rebel base but the Doctor was very confused. Heidi reminded him that last year\'s HC2 theme was Star Wars. Now he understood, and he\'s ready to face the evils of the Empire!The rebels have s spaceships, each with a certain attacking power a.They want to send their spaceships to destroy the empire bases and steal enough gold and supplies in order to keep the rebellion alive.The empire has b bases, each with a certain defensive power d, and a certain amount of gold g.A spaceship can attack all the bases which have a defensive power less than or equal to its attacking power.If a spaceship attacks a base, it steals all the gold in that base.The rebels are still undecided which spaceship to send out first, so they asked for the Doctor\'s help. They would like to know, for each spaceship, the maximum amount of gold it can steal." 1400.0                                      
          1183H "Subsequences (hard version)" dp,strings "The only difference between the easy and the hard versions is constraints.A subsequence is a string that can be derived from another string by deleting some or no symbols without changing the order of the remaining symbols. Characters to be deleted are not required to go successively, there can be any gaps between them. For example, for the string ""abaca"" the following strings are subsequences: ""abaca"", ""aba"", ""aaa"", ""a"" and """" (empty string). But the following strings are not subsequences: ""aabaca"", ""cb"" and ""bcaa"".You are given a string s consisting of n lowercase Latin letters.In one move you can take any subsequence t of the given string and add it to the set S. The set S can\'t contain duplicates. This move costs n\xe2\x88\x92|t|, where |t| is the length of the added subsequence (i.e. the price equals to the number of the deleted characters).Your task is to find out the minimum possible total cost to obtain a set S of size k or report that it is impossible to do so." 1900.0                                      
          1183G "Candy Box (hard version)" greedy,implementation,sortings "This problem is a version of problem D from the same contest with some additional constraints and tasks.There are n candies in a candy box. The type of the i-th candy is ai (1\xe2\x89\xa4ai\xe2\x89\xa4n). You have to prepare a gift using some of these candies with the following restriction: the numbers of candies of each type presented in a gift should be all distinct (i.\xe2\x80\x89e. for example, a gift having two candies of type 1 and two candies of type 2 is bad).It is possible that multiple types of candies are completely absent from the gift. It is also possible that not all candies of some types will be taken to a gift.You really like some of the candies and don\'t want to include them into the gift, but you want to eat them yourself instead. For each candy, a number fi is given, which is equal to 0 if you really want to keep i-th candy for yourself, or 1 if you don\'t mind including it into your gift. It is possible that two candies of the same type have different values of fi.You want your gift to be as large as possible, but you don\'t want to include too many of the candies you want to eat into the gift. So, you want to calculate the maximum possible number of candies that can be included into a gift, and among all ways to choose maximum number of candies, you want to maximize the number of candies having fi=1 in your gift.You have to answer q independent queries.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 2000.0                                      
          1183C "Computer Game" "binary search,math" "Vova is playing a computer game. There are in total n turns in the game and Vova really wants to play all of them. The initial charge of his laptop battery (i.e. the charge before the start of the game) is k.During each turn Vova can choose what to do:   If the current charge of his laptop battery is strictly greater than a, Vova can just play, and then the charge of his laptop battery will decrease by a;  if the current charge of his laptop battery is strictly greater than b (b<a), Vova can play and charge his laptop, and then the charge of his laptop battery will decrease by b;  if the current charge of his laptop battery is less than or equal to a and b at the same time then Vova cannot do anything and loses the game. Regardless of Vova\'s turns the charge of the laptop battery is always decreases.Vova wants to complete the game (Vova can complete the game if after each of n turns the charge of the laptop battery is strictly greater than 0). Vova has to play exactly n turns. Among all possible ways to complete the game, Vova wants to choose the one where the number of turns when he just plays (first type turn) is the maximum possible. It is possible that Vova cannot complete the game at all.Your task is to find out the maximum possible number of turns Vova can just play (make the first type turn) or report that Vova cannot complete the game.You have to answer q independent queries." 1400.0                                      
          1182A "Filling Shapes" dp,math "You have a given integer n. Find the number of ways to fill all 3\xc3\x97n tiles with the shape described in the picture below. Upon filling, no empty spaces are allowed. Shapes cannot overlap.  This picture describes when n=4. The left one is the shape and the right one is 3\xc3\x97n tiles." 1000.0                                      
          1181E1 "A Story of One Country (Easy)" "brute force,divide and conquer,sortings" "This problem differs from the next problem only in constraints.Petya decided to visit Byteland during the summer holidays. It turned out that the history of this country is quite unusual.Initially, there were n different countries on the land that is now Berland. Each country had its own territory that was represented as a rectangle on the map. The sides of the rectangle were parallel to the axes, and the corners were located at points with integer coordinates. Territories of no two countries intersected, but it was possible that some territories touched each other. As time passed, sometimes two countries merged into one. It only happened if the union of their territories was also a rectangle. In the end only one country remained \xe2\x80\x94 Byteland.Initially, each country had a rectangular castle inside its territory. Its sides were parallel to the axes and its corners had integer coordinates. Some castles might touch the border of the corresponding country and sides or other castles. Miraculously, after all the unions the castles are still intact. Unfortunately, their locations are the only information we have to restore the initial territories of the countries.  The possible formation of Byteland. The castles are shown in blue. Petya wonders why no information about the initial countries remained. He suspected that the whole story is a fake. You were recommended to him as a smart person. Please check whether or not there exists a possible set of initial territories that could make the story true." 2500.0                                      
          1181D Irrigation "binary search,data structures,implementation,sortings,trees,two pointers" "Misha was interested in water delivery from childhood. That\'s why his mother sent him to the annual Innovative Olympiad in Irrigation (IOI). Pupils from all Berland compete there demonstrating their skills in watering. It is extremely expensive to host such an olympiad, so after the first n olympiads the organizers introduced the following rule of the host city selection.The host cities of the olympiads are selected in the following way. There are m cities in Berland wishing to host the olympiad, they are numbered from 1 to m. The host city of each next olympiad is determined as the city that hosted the olympiad the smallest number of times before. If there are several such cities, the city with the smallest index is selected among them.Misha\'s mother is interested where the olympiad will be held in some specific years. The only information she knows is the above selection rule and the host cities of the first n olympiads. Help her and if you succeed, she will ask Misha to avoid flooding your house." 2200.0                                      
          1181A Chunga-Changa greedy,math "Soon after the Chunga-Changa island was discovered, it started to acquire some forms of civilization and even market economy. A new currency arose, colloquially called ""chizhik"". One has to pay in chizhiks to buy a coconut now.Sasha and Masha are about to buy some coconuts which are sold at price z chizhiks per coconut. Sasha has x chizhiks, Masha has y chizhiks. Each girl will buy as many coconuts as she can using only her money. This way each girl will buy an integer non-negative number of coconuts.The girls discussed their plans and found that the total number of coconuts they buy can increase (or decrease) if one of them gives several chizhiks to the other girl. The chizhiks can\'t be split in parts, so the girls can only exchange with integer number of chizhiks.Consider the following example. Suppose Sasha has 5 chizhiks, Masha has 4 chizhiks, and the price for one coconut be 3 chizhiks. If the girls don\'t exchange with chizhiks, they will buy 1+1=2 coconuts. However, if, for example, Masha gives Sasha one chizhik, then Sasha will have 6 chizhiks, Masha will have 3 chizhiks, and the girls will buy 2+1=3 coconuts. It is not that easy to live on the island now, so Sasha and Mash want to exchange with chizhiks in such a way that they will buy the maximum possible number of coconuts. Nobody wants to have a debt, so among all possible ways to buy the maximum possible number of coconuts find such a way that minimizes the number of chizhiks one girl gives to the other (it is not important who will be the person giving the chizhiks)." 1000.0                                      
          1178H "Stock Exchange" "binary search,flows,graphs" "Warning: This problem has an unusual memory limit!Bob decided that he will not waste his prime years implementing GUI forms for a large corporation and instead will earn his supper on the Stock Exchange Reykjavik. The Stock Exchange Reykjavik is the only actual stock exchange in the world. The only type of transaction is to take a single share of stock x and exchange it for a single share of stock y, provided that the current price of share x is at least the current price of share y. There are 2n stocks listed on the SER that are of interest to Bob, numbered from 1 to 2n. Bob owns a single share of stocks 1 through n and would like to own a single share of each of n+1 through 2n some time in the future.Bob managed to forecast the price of each stock \xe2\x80\x94 in time t\xe2\x89\xa50, the stock i will cost ai\xe2\x8b\x85\xe2\x8c\x8at\xe2\x8c\x8b+bi. The time is currently t=0. Help Bob find the earliest moment in time in which he can own a single share of each of n+1 through 2n, and the minimum number of stock exchanges he has to perform in order to do that.You may assume that the Stock Exchange has an unlimited amount of each stock at any point in time." 3500.0                                      
          1178D "Prime Graph" "constructive algorithms,greedy,math,number theory" "Every person likes prime numbers. Alice is a person, thus she also shares the love for them. Bob wanted to give her an affectionate gift but couldn\'t think of anything inventive. Hence, he will be giving her a graph. How original, Bob! Alice will surely be thrilled!When building the graph, he needs four conditions to be satisfied:   It must be a simple undirected graph, i.e. without multiple (parallel) edges and self-loops.  The number of vertices must be exactly n \xe2\x80\x94 a number he selected. This number is not necessarily prime.  The total number of edges must be prime.  The degree (i.e. the number of edges connected to the vertex) of each vertex must be prime. Below is an example for n=4. The first graph (left one) is invalid as the degree of vertex 2 (and 4) equals to 1, which is not prime. The second graph (middle one) is invalid as the total number of edges is 4, which is not a prime number. The third graph (right one) is a valid answer for n=4.   Note that the graph can be disconnected.Please help Bob to find any such graph!" 1500.0                                      
          1177B "Digits Sequence (Hard Edition)" "binary search,divide and conquer,implementation" "Let\'s write all the positive integer numbers one after another from 1 without any delimiters (i.e. as a single string). It will be the infinite sequence starting with 123456789101112131415161718192021222324252627282930313233343536...Your task is to print the k-th digit of this sequence." 1800.0                                      
          1176A "Divide it!" "brute force,greedy,implementation" "You are given an integer n.You can perform any of the following operations with this number an arbitrary (possibly, zero) number of times:   Replace n with n2 if n is divisible by 2;  Replace n with 2n3 if n is divisible by 3;  Replace n with 4n5 if n is divisible by 5. For example, you can replace 30 with 15 using the first operation, with 20 using the second operation or with 24 using the third operation.Your task is to find the minimum number of moves required to obtain 1 from n or say that it is impossible to do it.You have to answer q independent queries." 800.0                                      
          1174B "Ehab Is an Odd Person" sortings "You\'re given an array a of length n. You can perform the following operation on it as many times as you want:  Pick two integers i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that ai+aj is odd, then swap ai and aj. What is lexicographically the smallest array you can obtain?An array x is lexicographically smaller than an array y if there exists an index i such that xi<yi, and xj=yj for all 1\xe2\x89\xa4j<i. Less formally, at the first index i in which they differ, xi<yi" 1200.0                                      
          1170I "Good Subsets" "*special problem,dp" "You are given n segments on the Ox axis. The i-th segment is given as a pair li,ri, where li is the position of the left end of the i-th segment and ri is the position of the right end of the i-th segment. Segments may intersect, overlap, or even coincide. A segment is a set of numbers (including floating-point numbers) lying between the segment ends or coinciding with them. Formally, the segment [l,r]={x | x\xe2\x88\x88R, l\xe2\x89\xa4x\xe2\x89\xa4r}.Let the union of segments be the set of all axis points covered by the set of segments. Let\'s call a subset of the given segments good if its union equals the union of all n segments.Your task is to calculate the number of good subsets of the given n segments. Since the answer may be very large, print it modulo 998244353." -999.0                                      
          1170F Wheels "*special problem,binary search,greedy" "Polycarp has n wheels and a car with m slots for wheels. The initial pressure in the i-th wheel is ai.Polycarp\'s goal is to take exactly m wheels among the given n wheels and equalize the pressure in them (then he can put these wheels in a car and use it for driving). In one minute he can decrease or increase the pressure in any (single) wheel by 1. He can increase the pressure no more than k times in total because it is hard to pump up wheels.Help Polycarp and say what is the minimum number of minutes he needs to spend to equalize the pressure of at least m wheels among the given n wheels." -999.0                                      
          1170A "Three Integers Again" "*special problem,math" "We have three positive integers a, b and c. You don\'t know their values, but you know some information about them. Consider all three pairwise sums, i.e. the numbers a+b, a+c and b+c. You know exactly two (any) of three pairwise sums.Your task is to find such three positive integers a, b and c which match the given information. It means that if you consider a+b, a+c and b+c, two out of all three of them are given in the input. Among all such triples, you must choose one with the minimum possible sum a+b+c, and among all triples with the minimum sum, you can print any.You have to process q independent queries." -999.0                                      
          1166E "The LCMs Must be Large" "bitmasks,brute force,constructive algorithms,math,number theory" "Dora the explorer has decided to use her money after several years of juicy royalties to go shopping. What better place to shop than Nlogonia?There are n stores numbered from 1 to n in Nlogonia. The i-th of these stores offers a positive integer ai.Each day among the last m days Dora bought a single integer from some of the stores. The same day, Swiper the fox bought a single integer from all the stores that Dora did not buy an integer from on that day.Dora considers Swiper to be her rival, and she considers that she beat Swiper on day i if and only if the least common multiple of the numbers she bought on day i is strictly greater than the least common multiple of the numbers that Swiper bought on day i.The least common multiple (LCM) of a collection of integers is the smallest positive integer that is divisible by all the integers in the collection.However, Dora forgot the values of ai. Help Dora find out if there are positive integer values of ai such that she beat Swiper on every day. You don\'t need to find what are the possible values of ai though.Note that it is possible for some values of ai to coincide in a solution." 2100.0                                      
          1165C "Good String" greedy "Let\'s call (yet again) a string good if its length is even, and every character in odd position of this string is different from the next character (the first character is different from the second, the third is different from the fourth, and so on). For example, the strings good, string and xyyx are good strings, and the strings bad, aa and aabc are not good. Note that the empty string is considered good.You are given a string s, you have to delete minimum number of characters from this string so that it becomes good." 1300.0                                      
          1163B1 "Cat Party (Easy Edition)" "data structures,implementation" "This problem is same as the next one, but has smaller constraints.Shiro\'s just moved to the new house. She wants to invite all friends of her to the house so they can play monopoly. However, her house is too small, so she can only invite one friend at a time.For each of the n days since the day Shiro moved to the new house, there will be exactly one cat coming to the Shiro\'s house. The cat coming in the i-th day has a ribbon with color ui. Shiro wants to know the largest number x, such that if we consider the streak of the first x days, it is possible to remove exactly one day from this streak so that every ribbon color that has appeared among the remaining x\xe2\x88\x921 will have the same number of occurrences.For example, consider the following sequence of ui: [2,2,1,1,5,4,4,5]. Then x=7 makes a streak, since if we remove the leftmost ui=5, each ribbon color will appear exactly twice in the prefix of x\xe2\x88\x921 days. Note that x=8 doesn\'t form a streak, since you must remove exactly one day. Since Shiro is just a cat, she is not very good at counting and needs your help finding the longest streak." 1500.0                                      
          1158D "Winding polygonal line" "constructive algorithms,geometry,greedy,math" "Vasya has n different points A1,A2,\xe2\x80\xa6An on the plane. No three of them lie on the same line He wants to place them in some order Ap1,Ap2,\xe2\x80\xa6,Apn, where p1,p2,\xe2\x80\xa6,pn \xe2\x80\x94 some permutation of integers from 1 to n.After doing so, he will draw oriented polygonal line on these points, drawing oriented segments from each point to the next in the chosen order. So, for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 he will draw oriented segment from point Api to point Api+1. He wants to make this polygonal line satisfying 2 conditions:   it will be non-self-intersecting, so any 2 segments which are not neighbors don\'t have common points.  it will be winding. Vasya has a string s, consisting of (n\xe2\x88\x922) symbols ""L"" or ""R"". Let\'s call an oriented polygonal line winding, if its i-th turn left, if si= ""L"" and right, if si= ""R"". More formally: i-th turn will be in point Api+1, where oriented segment from point Api to point Api+1 changes to oriented segment from point Api+1 to point Api+2. Let\'s define vectors \xe2\x86\x92v1=\xe2\x86\x92ApiApi+1 and \xe2\x86\x92v2=\xe2\x86\x92Api+1Api+2. Then if in order to rotate the vector \xe2\x86\x92v1 by the smallest possible angle, so that its direction coincides with the direction of the vector \xe2\x86\x92v2 we need to make a turn counterclockwise, then we say that i-th turn is to the left, and otherwise to the right. For better understanding look at this pictures with some examples of turns:  There are left turns on this picture   There are right turns on this picture You are given coordinates of the points A1,A2,\xe2\x80\xa6An on the plane and string s. Find a permutation p1,p2,\xe2\x80\xa6,pn of the integers from 1 to n, such that the polygonal line, drawn by Vasya satisfy two necessary conditions." 2600.0                                      
          1157C2 "Increasing Subsequence (hard version)" greedy "The only difference between problems C1 and C2 is that all values in input of problem C1 are distinct (this condition may be false for problem C2).You are given a sequence a consisting of n integers.You are making a sequence of moves. During each move you must take either the leftmost element of the sequence or the rightmost element of the sequence, write it down and remove it from the sequence. Your task is to write down a strictly increasing sequence, and among all such sequences you should take the longest (the length of the sequence is the number of elements in it).For example, for the sequence [1,2,4,3,2] the answer is 4 (you take 1 and the sequence becomes [2,4,3,2], then you take the rightmost element 2 and the sequence becomes [2,4,3], then you take 3 and the sequence becomes [2,4] and then you take 4 and the sequence becomes [2], the obtained increasing sequence is [1,2,3,4])." 1700.0                                      
          1156G Optimizer graphs,greedy,hashing,implementation "Let\'s analyze a program written on some strange programming language. The variables in this language have names consisting of 1 to 4 characters, and each character is a lowercase or an uppercase Latin letter, or a digit. There is an extra constraint that the first character should not be a digit.There are four types of operations in the program, each denoted by one of the characters: $, ^, # or &.Each line of the program has one of the following formats:   <lvalue>=<rvalue>, where <lvalue> and <rvalue> are valid variable names;  <lvalue>=<arg1><op><arg2>, where <lvalue>, <arg1> and <arg2> are valid variable names, and <op> is an operation character. The program is executed line-by-line, and the result of execution is stored in a variable having the name res. If res is never assigned in the program, then the result will be equal to the value of res before running the program.Two programs are called equivalent if no matter which operations do characters $, ^, # and & denote (but, obviously, performing the same operation on the same arguments gives the same result) and which values do variables have before execution of program, the value of res after running the first program is equal to the value of res after running the second program (the programs are executed independently).You are given a program consisting of n lines. Your task is to write a program consisting of minimum possible number of lines that is equivalent to the program you are given." 2700.0                                      
          1156B "Ugly Pairs" "dfs and similar,greedy,implementation,sortings,strings" "You are given a string, consisting of lowercase Latin letters.A pair of neighbouring letters in a string is considered ugly if these letters are also neighbouring in a alphabet. For example, string ""abaca"" contains ugly pairs at positions (1,2) \xe2\x80\x94 ""ab"" and (2,3) \xe2\x80\x94 ""ba"". Letters \'a\' and \'z\' aren\'t considered neighbouring in a alphabet.Can you rearrange the letters of a given string so that there are no ugly pairs? You can choose any order of the letters of the given string but you can\'t add any new letters or remove the existing ones. You can also leave the order the same.If there are multiple answers, print any of them.You also have to answer T separate queries." 1800.0                                      
          1155C "Alarm Clocks Everywhere" "math,number theory" "Ivan is going to sleep now and wants to set his alarm clock. There will be many necessary events tomorrow, the i-th of them will start during the xi-th minute. Ivan doesn\'t want to skip any of the events, so he has to set his alarm clock in such a way that it rings during minutes x1,x2,\xe2\x80\xa6,xn, so he will be awake during each of these minutes (note that it does not matter if his alarm clock will ring during any other minute).Ivan can choose two properties for the alarm clock \xe2\x80\x94 the first minute it will ring (let\'s denote it as y) and the interval between two consecutive signals (let\'s denote it by p). After the clock is set, it will ring during minutes y,y+p,y+2p,y+3p and so on.Ivan can choose any minute as the first one, but he cannot choose any arbitrary value of p. He has to pick it among the given values p1,p2,\xe2\x80\xa6,pm (his phone does not support any other options for this setting).So Ivan has to choose the first minute y when the alarm clock should start ringing and the interval between two consecutive signals pj in such a way that it will ring during all given minutes x1,x2,\xe2\x80\xa6,xn (and it does not matter if his alarm clock will ring in any other minutes).Your task is to tell the first minute y and the index j such that if Ivan sets his alarm clock with properties y and pj it will ring during all given minutes x1,x2,\xe2\x80\xa6,xn or say that it is impossible to choose such values of the given properties. If there are multiple answers, you can print any." 1300.0                                      
          1152E "Neko and Flashback" "constructive algorithms,dfs and similar,graphs" "A permutation of length k is a sequence of k integers from 1 to k containing each integer exactly once. For example, the sequence [3,1,2] is a permutation of length 3.When Neko was five, he thought of an array a of n positive integers and a permutation p of length n\xe2\x88\x921. Then, he performed the following:  Constructed an array b of length n\xe2\x88\x921, where bi=min(ai,ai+1).  Constructed an array c of length n\xe2\x88\x921, where ci=max(ai,ai+1).  Constructed an array b\xe2\x80\xb2 of length n\xe2\x88\x921, where b\xe2\x80\xb2i=bpi.  Constructed an array c\xe2\x80\xb2 of length n\xe2\x88\x921, where c\xe2\x80\xb2i=cpi. For example, if the array a was [3,4,6,5,7] and permutation p was [2,4,1,3], then Neko would have constructed the following arrays:  b=[3,4,5,5]  c=[4,6,6,7]  b\xe2\x80\xb2=[4,5,3,5]  c\xe2\x80\xb2=[6,7,4,6] Then, he wrote two arrays b\xe2\x80\xb2 and c\xe2\x80\xb2 on a piece of paper and forgot about it. 14 years later, when he was cleaning up his room, he discovered this old piece of paper with two arrays b\xe2\x80\xb2 and c\xe2\x80\xb2 written on it. However he can\'t remember the array a and permutation p he used.In case Neko made a mistake and there is no array a and permutation p resulting in such b\xe2\x80\xb2 and c\xe2\x80\xb2, print -1. Otherwise, help him recover any possible array a." 2400.0                                      
          1152D "Neko and Aki\'s Prank" dp,greedy,trees "Neko is playing with his toys on the backyard of Aki\'s house. Aki decided to play a prank on him, by secretly putting catnip into Neko\'s toys. Unfortunately, he went overboard and put an entire bag of catnip into the toys...It took Neko an entire day to turn back to normal. Neko reported to Aki that he saw a lot of weird things, including a trie of all correct bracket sequences of length 2n2n.The definition of correct bracket sequence is as follows:  The empty sequence is a correct bracket sequence,  If ss is a correct bracket sequence, then (s)(s) is a correct bracket sequence,  If ss and tt are a correct bracket sequence, then stst is also a correct bracket sequence. For example, the strings ""(())"", ""()()"" form a correct bracket sequence, while "")("" and ""(("" not.Aki then came up with an interesting problem: What is the size of the maximum matching (the largest set of edges such that there are no two edges with a common vertex) in this trie? Since the answer can be quite large, print it modulo 109+7109+7." 2100.0                                      
          1151C "Problem for Nazar" "constructive algorithms,math" "Nazar, a student of the scientific lyceum of the Kingdom of Kremland, is known for his outstanding mathematical abilities. Today a math teacher gave him a very difficult task.Consider two infinite sets of numbers. The first set consists of odd positive numbers (1,3,5,7,\xe2\x80\xa6), and the second set consists of even positive numbers (2,4,6,8,\xe2\x80\xa6). At the first stage, the teacher writes the first number on the endless blackboard from the first set, in the second stage \xe2\x80\x94 the first two numbers from the second set, on the third stage \xe2\x80\x94 the next four numbers from the first set, on the fourth \xe2\x80\x94 the next eight numbers from the second set and so on. In other words, at each stage, starting from the second, he writes out two times more numbers than at the previous one, and also changes the set from which these numbers are written out to another. The ten first written numbers: 1,2,4,3,5,7,9,6,8,10. Let\'s number the numbers written, starting with one.The task is to find the sum of numbers with numbers from l to r for given integers l and r. The answer may be big, so you need to find the remainder of the division by 1000000007 (109+7).Nazar thought about this problem for a long time, but didn\'t come up with a solution. Help him solve this problem." 1800.0                                      
          1148E "Earth Wind and Fire" "constructive algorithms,greedy,math,sortings,two pointers" "There are n stones arranged on an axis. Initially the i-th stone is located at the coordinate si. There may be more than one stone in a single place.You can perform zero or more operations of the following type:   take two stones with indices i and j so that si\xe2\x89\xa4sj, choose an integer d (0\xe2\x89\xa42\xe2\x8b\x85d\xe2\x89\xa4sj\xe2\x88\x92si), and replace the coordinate si with (si+d) and replace coordinate sj with (sj\xe2\x88\x92d). In other words, draw stones closer to each other. You want to move the stones so that they are located at positions t1,t2,\xe2\x80\xa6,tn. The order of the stones is not important \xe2\x80\x94 you just want for the multiset of the stones resulting positions to be the same as the multiset of t1,t2,\xe2\x80\xa6,tn.Detect whether it is possible to move the stones this way, and if yes, construct a way to do so. You don\'t need to minimize the number of moves." 2300.0                                      
          1148A "Another One Bites The Dust" greedy "Let\'s call a string good if and only if it consists of only two types of letters \xe2\x80\x94 \'a\' and \'b\' and every two consecutive letters are distinct. For example ""baba"" and ""aba"" are good strings and ""abb"" is a bad string.You have a strings ""a"", b strings ""b"" and c strings ""ab"". You want to choose some subset of these strings and concatenate them in any arbitrarily order.What is the length of the longest good string you can obtain this way?" 800.0                                      
          1147F "Zigzag Game" games,interactive "You are given a complete bipartite graph with 2n nodes, with n nodes on each side of the bipartition. Nodes 1 through n are on one side of the bipartition, and nodes n+1 to 2n are on the other side. You are also given an n\xc3\x97n matrix a describing the edge weights. aij denotes the weight of the edge between nodes i and j+n. Each edge has a distinct weight.Alice and Bob are playing a game on this graph. First Alice chooses to play as either ""increasing"" or ""decreasing"" for herself, and Bob gets the other choice. Then she places a token on any node of the graph. Bob then moves the token along any edge incident to that node. They now take turns playing the following game, with Alice going first.The current player must move the token from the current vertex to some adjacent unvisited vertex. Let w be the last weight of the last edge that was traversed. The edge that is traversed must be strictly greater than w if the player is playing as ""increasing"", otherwise, it must be strictly less. The first player unable to make a move loses.You are given n and the edge weights of the graph. You can choose to play as either Alice or Bob, and you will play against the judge. You must win all the games for your answer to be judged correct." 3500.0                                      
          1147E "Rainbow Coins" interactive "Carl has n coins of various colors, and he would like to sort them into piles. The coins are labeled 1,2,\xe2\x80\xa6,n, and each coin is exactly one of red, green, or blue. He would like to sort the coins into three different piles so one pile contains all red coins, one pile contains all green coins, and one pile contains all blue coins.Unfortunately, Carl is colorblind, so this task is impossible for him. Luckily, he has a friend who can take a pair of coins and tell Carl if they are the same color or not. Using his friend, Carl believes he can now sort the coins. The order of the piles doesn\'t matter, as long as all same colored coins are in the one pile, and no two different colored coins are in the same pile.His friend will answer questions about multiple pairs of coins in batches, and will answer about all of those pairs in parallel. Each coin should be in at most one pair in each batch. The same coin can appear in different batches.Carl can use only 7 batches. Help him find the piles of coins after sorting." 3000.0                                      
          1146G "Zoning Restrictions" dp,flows,graphs "You are planning to build housing on a street. There are n spots available on the street on which you can build a house. The spots are labeled from 1 to n from left to right. In each spot, you can build a house with an integer height between 0 and h.In each spot, if a house has height a, you can gain a2 dollars from it.The city has m zoning restrictions though. The i-th restriction says that if the tallest house from spots li to ri is strictly more than xi, you must pay a fine of ci.You would like to build houses to maximize your profit (sum of dollars gained minus fines). Determine the maximum profit possible." 2700.0                                      
          1146D "Frog Jumping" "dfs and similar,math,number theory" "A frog is initially at position 0 on the number line. The frog has two positive integers a and b. From a position k, it can either jump to position k+a or k\xe2\x88\x92b.Let f(x) be the number of distinct integers the frog can reach if it never jumps on an integer outside the interval [0,x]. The frog doesn\'t need to visit all these integers in one trip, that is, an integer is counted if the frog can somehow reach it if it starts from 0.Given an integer m, find \xe2\x88\x91mi=0f(i). That is, find the sum of all f(i) for i from 0 to m." 2100.0                                      
          1145F "Neat Words"  "InputThe input consists of a single string of uppercase letters A-Z. The length of the string is between 1 and 10 characters, inclusive.OutputOutput ""YES"" or ""NO"".ExamplesInputCopyNEATOutputCopyYESInputCopyWORDOutputCopyNOInputCopyCODEROutputCopyNOInputCopyAPRILFOOLOutputCopyNOInputCopyAIOutputCopyYESInputCopyJUROROutputCopyYESInputCopyYESOutputCopyNO" -999.0                                      
          1142D Foreigner dp "Traveling around the world you noticed that many shop owners raise prices to inadequate values if the see you are a foreigner.You define inadequate numbers as follows:   all integers from 1 to 9 are inadequate;  for an integer x\xe2\x89\xa510 to be inadequate, it is required that the integer \xe2\x8c\x8ax/10\xe2\x8c\x8b is inadequate, but that\'s not the only condition. Let\'s sort all the inadequate integers. Let \xe2\x8c\x8ax/10\xe2\x8c\x8b have number k in this order. Then, the integer x is inadequate only if the last digit of x is strictly less than the reminder of division of k by 11. Here \xe2\x8c\x8ax/10\xe2\x8c\x8b denotes x/10 rounded down.Thus, if x is the m-th in increasing order inadequate number, and m gives the remainder c when divided by 11, then integers 10\xe2\x8b\x85x+0,10\xe2\x8b\x85x+1\xe2\x80\xa6,10\xe2\x8b\x85x+(c\xe2\x88\x921) are inadequate, while integers 10\xe2\x8b\x85x+c,10\xe2\x8b\x85x+(c+1),\xe2\x80\xa6,10\xe2\x8b\x85x+9 are not inadequate.The first several inadequate integers are 1,2,3,4,5,6,7,8,9,10,20,21,30,31,32\xe2\x80\xa6. After that, since 4 is the fourth inadequate integer, 40,41,42,43 are inadequate, while 44,45,46,\xe2\x80\xa6,49 are not inadequate; since 10 is the 10-th inadequate number, integers 100,101,102,\xe2\x80\xa6,109 are all inadequate. And since 20 is the 11-th inadequate number, none of 200,201,202,\xe2\x80\xa6,209 is inadequate.You wrote down all the prices you have seen in a trip. Unfortunately, all integers got concatenated in one large digit string s and you lost the bounds between the neighboring integers. You are now interested in the number of substrings of the resulting string that form an inadequate number. If a substring appears more than once at different positions, all its appearances are counted separately." 2800.0                                      
          1142C U2 geometry "Recently Vasya learned that, given two points with different x coordinates, you can draw through them exactly one parabola with equation of type y=x2+bx+c, where b and c are reals. Let\'s call such a parabola an U-shaped one.Vasya drew several distinct points with integer coordinates on a plane and then drew an U-shaped parabola through each pair of the points that have different x coordinates. The picture became somewhat messy, but Vasya still wants to count how many of the parabolas drawn don\'t have any drawn point inside their internal area. Help Vasya.The internal area of an U-shaped parabola is the part of the plane that lies strictly above the parabola when the y axis is directed upwards." 2400.0                                      
          1141A "Game 23" implementation,math "Polycarp plays ""Game 23"". Initially he has a number n and his goal is to transform it to m. In one move, he can multiply n by 2 or multiply n by 3. He can perform any number of moves.Print the number of moves needed to transform n to m. Print -1 if it is impossible to do so.It is easy to prove that any way to transform n to m contains the same number of moves (i.e. number of moves doesn\'t depend on the way of transformation)." 1000.0                                      
          1138A "Sushi for Two" "binary search,greedy,implementation" "Arkady invited Anna for a dinner to a sushi restaurant. The restaurant is a bit unusual: it offers n pieces of sushi aligned in a row, and a customer has to choose a continuous subsegment of these sushi to buy.The pieces of sushi are of two types: either with tuna or with eel. Let\'s denote the type of the i-th from the left sushi as ti, where ti=1 means it is with tuna, and ti=2 means it is with eel.Arkady does not like tuna, Anna does not like eel. Arkady wants to choose such a continuous subsegment of sushi that it has equal number of sushi of each type and each half of the subsegment has only sushi of one type. For example, subsegment [2,2,2,1,1,1] is valid, but subsegment [1,2,1,2,1,2] is not, because both halves contain both types of sushi.Find the length of the longest continuous subsegment of sushi Arkady can buy." 900.0                                      
               920E "Connected Components?" "data structures,dfs and similar,dsu,graphs" "You are given an undirected graph consisting of n vertices and  edges. Instead of giving you the edges that exist in the graph, we give you m unordered pairs (x,\xe2\x80\x89y) such that there is no edge between x and y, and if some pair of vertices is not listed in the input, then there is an edge between these vertices.You have to find the number of connected components in the graph and the size of each component. A connected component is a set of vertices X such that for every two vertices from this set there exists at least one path in the graph connecting these vertices, but adding any other vertex to X violates this rule." 2100.0                                 
               920D Tanks dp,greedy,implementation "Petya sometimes has to water his field. To water the field, Petya needs a tank with exactly V ml of water.Petya has got N tanks, i-th of them initially containing ai ml of water. The tanks are really large, any of them can contain any amount of water (no matter how large this amount is).Also Petya has got a scoop that can contain up to K ml of water (initially the scoop is empty). This scoop can be used to get some water from some tank, and after that pour it all into some tank (it is impossible to get water from multiple tanks without pouring it, or leave some water in the scoop when pouring it). When Petya tries to get some water from a tank, he gets min(v,\xe2\x80\x89K) water, where v is the current volume of water in the tank.Is it possible to obtain a tank with exactly V ml of water using these operations? If it is possible, print a sequence of operations that allows to do it. If there are multiple ways to obtain needed amount of water in some tank, print any of them." 2400.0                                 
               920C "Swap Adjacent Elements" "dfs and similar,greedy,math,sortings,two pointers" "You have an array a consisting of n integers. Each integer from 1 to n appears exactly once in this array.For some indices i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) it is possible to swap i-th element with (i\xe2\x80\x89+\xe2\x80\x891)-th, for other indices it is not possible. You may perform any number of swapping operations any order. There is no limit on the number of times you swap i-th element with (i\xe2\x80\x89+\xe2\x80\x891)-th (if the position is not forbidden).Can you make this array sorted in ascending order performing some sequence of swapping operations?" 1400.0                                 
               919E "Congruence Equation" "chinese remainder theorem,math,number theory" "Given an integer x. Your task is to find out how many positive integers n (1\xe2\x89\xa4n\xe2\x89\xa4x) satisfy n\xe2\x8b\x85an\xe2\x89\xa1b(modp), where a,b,p are all known constants." 2100.0                                 
               917B MADMAX "dfs and similar,dp,games,graphs" "As we all know, Max is the best video game player among her friends. Her friends were so jealous of hers, that they created an actual game just to prove that she\'s not the best at games. The game is played on a directed acyclic graph (a DAG) with n vertices and m edges. There\'s a character written on each edge, a lowercase English letter.  Max and Lucas are playing the game. Max goes first, then Lucas, then Max again and so on. Each player has a marble, initially located at some vertex. Each player in his/her turn should move his/her marble along some edge (a player can move the marble from vertex v to vertex u if there\'s an outgoing edge from v to u). If the player moves his/her marble from vertex v to vertex u, the ""character"" of that round is the character written on the edge from v to u. There\'s one additional rule; the ASCII code of character of round i should be greater than or equal to the ASCII code of character of round i\xe2\x80\x89-\xe2\x80\x891 (for i\xe2\x80\x89>\xe2\x80\x891). The rounds are numbered for both players together, i. e. Max goes in odd numbers, Lucas goes in even numbers. The player that can\'t make a move loses the game. The marbles may be at the same vertex at the same time.Since the game could take a while and Lucas and Max have to focus on finding Dart, they don\'t have time to play. So they asked you, if they both play optimally, who wins the game?You have to determine the winner of the game for all initial positions of the marbles." 1700.0                                 
               914H "Ember and Storm\'s Tree Game" combinatorics,dp,games,trees "Ember and Storm play a game. First, Ember picks a labelled tree T of n vertices, such that the degree of every vertex is at most d. Then, Storm picks two distinct vertices u and v in this tree and writes down the labels of the vertices in the path from u to v in a sequence a1,\xe2\x80\x89a2... ak. Finally, Ember picks any index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k) in the array. Now he performs one of the following two operations exactly once:  flip the subrange [i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89k] and add ai to it. After this, the sequence becomes a1,\xe2\x80\x89... ai,\xe2\x80\x89ak\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89ak\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89... ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ai  negate the subrange [i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89k] and add ai to it. i.e., the array becomes a1,\xe2\x80\x89... ai,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89...\xe2\x80\x89-\xe2\x80\x89ak\xe2\x80\x89+\xe2\x80\x89ai Ember wins if the array is monotonically increasing or decreasing after this. Otherwise Storm wins.The game can be described by the tuple (T,\xe2\x80\x89u,\xe2\x80\x89v,\xe2\x80\x89i,\xe2\x80\x89op) where op is \xc2\xabflip\xc2\xbb or \xc2\xabnegate\xc2\xbb depending on the action Ember chose in the last turn. Find the number of tuples that can occur if Ember and Storm play optimally. When they play optimally, if there are multiple moves by which they are guaranteed to win, then they may play any of the winning moves. Otherwise, if someone loses no matter what they play, then they may play any of the possible moves.Report the answer modulo m." 3400.0                                 
               913H "Don\'t Exceed" math,probabilities "You generate real numbers s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn as follows:   s0\xe2\x80\x89=\xe2\x80\x890;  si\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ti, where ti is a real number chosen independently uniformly at random between 0 and 1, inclusive. You are given real numbers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. You are interested in the probability that si\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi is true for all i simultaneously.It can be shown that this can be represented as , where P and Q are coprime integers, and . Print the value of P\xc2\xb7Q\xe2\x80\x89-\xe2\x80\x891 modulo 998244353." 3400.0                                 
               912A "Tricky Alchemy" implementation "During the winter holidays, the demand for Christmas balls is exceptionally high. Since it\'s already 2018, the advances in alchemy allow easy and efficient ball creation by utilizing magic crystals.Grisha needs to obtain some yellow, green and blue balls. It\'s known that to produce a yellow ball one needs two yellow crystals, green \xe2\x80\x94 one yellow and one blue, and for a blue ball, three blue crystals are enough.Right now there are A yellow and B blue crystals in Grisha\'s disposal. Find out how many additional crystals he should acquire in order to produce the required number of balls." 800.0                                 
               911B "Two Cakes" "binary search,brute force,implementation" "It\'s New Year\'s Eve soon, so Ivan decided it\'s high time he started setting the table. Ivan has bought two cakes and cut them into pieces: the first cake has been cut into a pieces, and the second one \xe2\x80\x94 into b pieces.Ivan knows that there will be n people at the celebration (including himself), so Ivan has set n plates for the cakes. Now he is thinking about how to distribute the cakes between the plates. Ivan wants to do it in such a way that all following conditions are met:  Each piece of each cake is put on some plate;  Each plate contains at least one piece of cake;  No plate contains pieces of both cakes. To make his guests happy, Ivan wants to distribute the cakes in such a way that the minimum number of pieces on the plate is maximized. Formally, Ivan wants to know the maximum possible number x such that he can distribute the cakes according to the aforementioned conditions, and each plate will contain at least x pieces of cake.Help Ivan to calculate this number x!" 1200.0                                 
               910A "The Way to Home" "dfs and similar,dp,greedy,implementation" "A frog lives on the axis Ox and needs to reach home which is in the point n. She starts from the point 1. The frog can jump to the right at a distance not more than d. So, after she jumped from the point x she can reach the point x\xe2\x80\x89+\xe2\x80\x89a, where a is an integer from 1 to d.For each point from 1 to n is known if there is a lily flower in it. The frog can jump only in points with a lilies. Guaranteed that there are lilies in the points 1 and n.Determine the minimal number of jumps that the frog needs to reach home which is in the point n from the point 1. Consider that initially the frog is in the point 1. If the frog can not reach home, print -1." 800.0                                 
               909A "Generate Login" "brute force,greedy,sortings" "The preferred way to generate user login in Polygon is to concatenate a prefix of the user\'s first name and a prefix of their last name, in that order. Each prefix must be non-empty, and any of the prefixes can be the full name. Typically there are multiple possible logins for each person.You are given the first and the last name of a user. Return the alphabetically earliest login they can get (regardless of other potential Polygon users).As a reminder, a prefix of a string s is its substring which occurs at the beginning of s: ""a"", ""ab"", ""abc"" etc. are prefixes of string ""{abcdef}"" but ""b"" and \'bc"" are not. A string a is alphabetically earlier than a string b, if a is a prefix of b, or a and b coincide up to some position, and then a has a letter that is alphabetically earlier than the corresponding letter in b: ""a"" and ""ab"" are alphabetically earlier than ""ac"" but ""b"" and ""ba"" are alphabetically later than ""ac""." 1000.0                                 
               908H "New Year and Boolean Bridges"  "Your friend has a hidden directed graph with n nodes.Let f(u,\xe2\x80\x89v) be true if there is a directed path from node u to node v, and false otherwise. For each pair of distinct nodes, u,\xe2\x80\x89v, you know at least one of the three statements is true:        Here AND, OR and XOR mean AND, OR and exclusive OR operations, respectively.You are given an n by n matrix saying which one of the three statements holds for each pair of vertices. The entry in the u-th row and v-th column has a single character.   If the first statement holds, this is represented by the character \'A\'.  If the second holds, this is represented by the character \'O\'.  If the third holds, this is represented by the character \'X\'.  The diagonal of this matrix will only contain the character \'-\'. Note that it is possible that a pair of nodes may satisfy multiple statements, in which case, the character given will represent one of the true statements for that pair. This matrix is also guaranteed to be symmetric.You would like to know if there is a directed graph that is consistent with this matrix. If it is impossible, print the integer -1. Otherwise, print the minimum number of edges that could be consistent with this information." 3100.0                                 
               906D "Power Tower" "chinese remainder theorem,math,number theory" "Priests of the Quetzalcoatl cult want to build a tower to represent a power of their god. Tower is usually made of power-charged rocks. It is built with the help of rare magic by levitating the current top of tower and adding rocks at its bottom. If top, which is built from k\xe2\x80\x89-\xe2\x80\x891 rocks, possesses power p and we want to add the rock charged with power wk then value of power of a new tower will be {wk}p. Rocks are added from the last to the first. That is for sequence w1,\xe2\x80\x89...,\xe2\x80\x89wm value of power will beAfter tower is built, its power may be extremely large. But still priests want to get some information about it, namely they want to know a number called cumulative power which is the true value of power taken modulo m. Priests have n rocks numbered from 1 to n. They ask you to calculate which value of cumulative power will the tower possess if they will build it from rocks numbered l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r." 2700.0                                 
               906A Shockers implementation,strings "Valentin participates in a show called ""Shockers"". The rules are quite easy: jury selects one letter which Valentin doesn\'t know. He should make a small speech, but every time he pronounces a word that contains the selected letter, he receives an electric shock. He can make guesses which letter is selected, but for each incorrect guess he receives an electric shock too. The show ends when Valentin guesses the selected letter correctly.Valentin can\'t keep in mind everything, so he could guess the selected letter much later than it can be uniquely determined and get excessive electric shocks. Excessive electric shocks are those which Valentin got after the moment the selected letter can be uniquely determined. You should find out the number of excessive electric shocks." 1600.0                                 
               900B "Position in Fraction" "math,number theory" "You have a fraction . You need to find the first occurrence of digit c into decimal notation of the fraction after decimal point." 1300.0                                 
               898A Rounding implementation,math "Vasya has a non-negative integer n. He wants to round it to nearest integer, which ends up with 0. If n already ends up with 0, Vasya considers it already rounded.For example, if n\xe2\x80\x89=\xe2\x80\x894722 answer is 4720. If n\xe2\x80\x89=\xe2\x80\x895 Vasya can round it to 0 or to 10. Both ways are correct.For given n find out to which integer will Vasya round it." 800.0                                 
               895C "Square Subsets" bitmasks,combinatorics,dp,math "Petya was late for the lesson too. The teacher gave him an additional task. For some array a Petya should find the number of different ways to select non-empty subset of elements from it in such a way that their product is equal to a square of some integer.Two ways are considered different if sets of indexes of elements chosen by these ways are different.Since the answer can be very large, you should find the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2000.0                                 
               894D "Ralph And His Tour in Binary Country" "brute force,data structures,trees" "Ralph is in the Binary Country. The Binary Country consists of n cities and (n\xe2\x80\x89-\xe2\x80\x891) bidirectional roads connecting the cities. The roads are numbered from 1 to (n\xe2\x80\x89-\xe2\x80\x891), the i-th road connects the city labeled  (here \xe2\x8c\x8a x\xe2\x8c\x8b denotes the x rounded down to the nearest integer) and the city labeled (i\xe2\x80\x89+\xe2\x80\x891), and the length of the i-th road is Li.Now Ralph gives you m queries. In each query he tells you some city Ai and an integer Hi. He wants to make some tours starting from this city. He can choose any city in the Binary Country (including Ai) as the terminal city for a tour. He gains happiness (Hi\xe2\x80\x89-\xe2\x80\x89L) during a tour, where L is the distance between the city Ai and the terminal city.Ralph is interested in tours from Ai in which he can gain positive happiness. For each query, compute the sum of happiness gains for all such tours.Ralph will never take the same tour twice or more (in one query), he will never pass the same city twice or more in one tour." 2200.0                                 
               891E Lust combinatorics,math,matrices "A false witness that speaketh lies!You are given a sequence containing n integers. There is a variable res that is equal to 0 initially. The following process repeats k times.Choose an index from 1 to n uniformly at random. Name it x. Add to res the multiply of all ai\'s such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, but i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x. Then, subtract ax by 1.You have to find expected value of res at the end of the process. It can be proved that the expected value of res can be represented as an irreducible fraction . You have to find ." 3000.0                                 
               887F "Row of Models" greedy,sortings "During the final part of fashion show all models come to the stage and stay in one row and fashion designer stays to right to model on the right. During the rehearsal, Izabella noticed, that row isn\'t nice, but she can\'t figure out how to fix it. Like many other creative people, Izabella has a specific sense of beauty. Evaluating beauty of row of models Izabella looks at heights of models. She thinks that row is nice if for each model distance to nearest model with less height (model or fashion designer) to the right of her doesn\'t exceed k (distance between adjacent people equals 1, the distance between people with exactly one man between them equals 2, etc). She wants to make row nice, but fashion designer has his own sense of beauty, so she can at most one time select two models from the row and swap their positions if the left model from this pair is higher than the right model from this pair.Fashion designer (man to the right of rightmost model) has less height than all models and can\'t be selected for exchange.You should tell if it\'s possible to make at most one exchange in such a way that row becomes nice for Izabella." 2500.0                                 
               887C "Solution for Cube" "brute force,implementation" "During the breaks between competitions, top-model Izabella tries to develop herself and not to be bored. For example, now she tries to solve Rubik\'s cube 2x2x2.It\'s too hard to learn to solve Rubik\'s cube instantly, so she learns to understand if it\'s possible to solve the cube in some state using 90-degrees rotation of one face of the cube in any direction.To check her answers she wants to use a program which will for some state of cube tell if it\'s possible to solve it using one rotation, described above.Cube is called solved if for each face of cube all squares on it has the same color.https://en.wikipedia.org/wiki/Rubik\'s_Cube" 1500.0                                 
               884A "Book Reading" implementation "Recently Luba bought a very interesting book. She knows that it will take t seconds to read the book. Luba wants to finish reading as fast as she can.But she has some work to do in each of n next days. The number of seconds that Luba has to spend working during i-th day is ai. If some free time remains, she can spend it on reading.Help Luba to determine the minimum number of day when she finishes reading.It is guaranteed that the answer doesn\'t exceed n.Remember that there are 86400 seconds in a day." 800.0                                 
               883K "Road Widening" "constructive algorithms,greedy,implementation" "Mayor of city S just hates trees and lawns. They take so much space and there could be a road on the place they occupy!The Mayor thinks that one of the main city streets could be considerably widened on account of lawn nobody needs anyway. Moreover, that might help reduce the car jams which happen from time to time on the street.The street is split into n equal length parts from left to right, the i-th part is characterized by two integers: width of road si and width of lawn gi.  For each of n parts the Mayor should decide the size of lawn to demolish. For the i-th part he can reduce lawn width by integer xi (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89gi). After it new road width of the i-th part will be equal to s\'i\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x89xi and new lawn width will be equal to g\'i\xe2\x80\x89=\xe2\x80\x89gi\xe2\x80\x89-\xe2\x80\x89xi.On the one hand, the Mayor wants to demolish as much lawn as possible (and replace it with road). On the other hand, he does not want to create a rapid widening or narrowing of the road, which would lead to car accidents. To avoid that, the Mayor decided that width of the road for consecutive parts should differ by at most 1, i.e. for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) the inequation |s\'i\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89s\'i|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 should hold. Initially this condition might not be true.You need to find the the total width of lawns the Mayor will destroy according to his plan." 1800.0                                 
               883C "Downloading B++" "binary search,implementation" "Only T milliseconds left before the start of well-known online programming contest Codehorses Round 2017.Polycarp needs to download B++ compiler to take part in the contest. The size of the file is f bytes.Polycarp\'s internet tariff allows to download data at the rate of one byte per t0 milliseconds. This tariff is already prepaid, and its use does not incur any expense for Polycarp. In addition, the Internet service provider offers two additional packages:  download a1 bytes at the rate of one byte per t1 milliseconds, paying p1 burles for the package;  download a2 bytes at the rate of one byte per t2 milliseconds, paying p2 burles for the package. Polycarp can buy any package many times. When buying a package, its price (p1 or p2) is prepaid before usage. Once a package is bought it replaces the regular tariff until package data limit is completely used. After a package is consumed Polycarp can immediately buy a new package or switch to the regular tariff without loosing any time. While a package is in use Polycarp can\'t buy another package or switch back to the regular internet tariff.Find the minimum amount of money Polycarp has to spend to download an f bytes file no more than in T milliseconds.Note that because of technical reasons Polycarp can download only integer number of bytes using regular tariff and both packages. I.e. in each of three downloading modes the number of downloaded bytes will be integer. It means that Polycarp can\'t download a byte partially using the regular tariff or/and both packages." 2300.0                                 
               877F "Ann and Books" "data structures,flows,hashing" "In Ann\'s favorite book shop are as many as n books on math and economics. Books are numbered from 1 to n. Each of them contains non-negative number of problems.Today there is a sale: any subsegment of a segment from l to r can be bought at a fixed price. Ann decided that she wants to buy such non-empty subsegment that the sale operates on it and the number of math problems is greater than the number of economics problems exactly by k. Note that k may be positive, negative or zero.Unfortunately, Ann is not sure on which segment the sale operates, but she has q assumptions. For each of them she wants to know the number of options to buy a subsegment satisfying the condition (because the time she spends on choosing depends on that).Currently Ann is too busy solving other problems, she asks you for help. For each her assumption determine the number of subsegments of the given segment such that the number of math problems is greaten than the number of economics problems on that subsegment exactly by k." 2300.0                                 
               869C "The Intriguing Obsession" combinatorics,dp,math "\xe2\x80\x94 This is not playing but duty as allies of justice, Nii-chan!\xe2\x80\x94 Not allies but justice itself, Onii-chan!With hands joined, go everywhere at a speed faster than our thoughts! This time, the Fire Sisters \xe2\x80\x94 Karen and Tsukihi \xe2\x80\x94 is heading for somewhere they\'ve never reached \xe2\x80\x94 water-surrounded islands!There are three clusters of islands, conveniently coloured red, blue and purple. The clusters consist of a, b and c distinct islands respectively.Bridges have been built between some (possibly all or none) of the islands. A bridge bidirectionally connects two different islands and has length 1. For any two islands of the same colour, either they shouldn\'t be reached from each other through bridges, or the shortest distance between them is at least 3, apparently in order to prevent oddities from spreading quickly inside a cluster.The Fire Sisters are ready for the unknown, but they\'d also like to test your courage. And you\'re here to figure out the number of different ways to build all bridges under the constraints, and give the answer modulo 998\xe2\x80\x89244\xe2\x80\x89353. Two ways are considered different if a pair of islands exist, such that there\'s a bridge between them in one of them, but not in the other." 1800.0                                 
               869B "The Eternal Immortality" math "Even if the world is full of counterfeits, I still regard it as wonderful.Pile up herbs and incense, and arise again from the flames and ashes of its predecessor \xe2\x80\x94 as is known to many, the phoenix does it like this.The phoenix has a rather long lifespan, and reincarnates itself once every a! years. Here a! denotes the factorial of integer a, that is, a!\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x892\xe2\x80\x89\xc3\x97\xe2\x80\x89...\xe2\x80\x89\xc3\x97\xe2\x80\x89a. Specifically, 0!\xe2\x80\x89=\xe2\x80\x891.Koyomi doesn\'t care much about this, but before he gets into another mess with oddities, he is interested in the number of times the phoenix will reincarnate in a timespan of b! years, that is, . Note that when b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89a this value is always integer.As the answer can be quite large, it would be enough for Koyomi just to know the last digit of the answer in decimal representation. And you\'re here to provide Koyomi with this knowledge." 1100.0                                 
               867A "Between the Offices" implementation "As you may know, MemSQL has American offices in both San Francisco and Seattle. Being a manager in the company, you travel a lot between the two cities, always by plane.You prefer flying from Seattle to San Francisco than in the other direction, because it\'s warmer in San Francisco. You are so busy that you don\'t remember the number of flights you have made in either direction. However, for each of the last n days you know whether you were in San Francisco office or in Seattle office. You always fly at nights, so you never were at both offices on the same day. Given this information, determine if you flew more times from Seattle to San Francisco during the last n days, or not." 800.0                                 
               864C Bus greedy,implementation,math "A bus moves along the coordinate line Ox from the point x\xe2\x80\x89=\xe2\x80\x890 to the point x\xe2\x80\x89=\xe2\x80\x89a. After starting from the point x\xe2\x80\x89=\xe2\x80\x890, it reaches the point x\xe2\x80\x89=\xe2\x80\x89a, immediately turns back and then moves to the point x\xe2\x80\x89=\xe2\x80\x890. After returning to the point x\xe2\x80\x89=\xe2\x80\x890 it immediately goes back to the point x\xe2\x80\x89=\xe2\x80\x89a and so on. Thus, the bus moves from x\xe2\x80\x89=\xe2\x80\x890 to x\xe2\x80\x89=\xe2\x80\x89a and back. Moving from the point x\xe2\x80\x89=\xe2\x80\x890 to x\xe2\x80\x89=\xe2\x80\x89a or from the point x\xe2\x80\x89=\xe2\x80\x89a to x\xe2\x80\x89=\xe2\x80\x890 is called a bus journey. In total, the bus must make k journeys.The petrol tank of the bus can hold b liters of gasoline. To pass a single unit of distance the bus needs to spend exactly one liter of gasoline. The bus starts its first journey with a full petrol tank.There is a gas station in point x\xe2\x80\x89=\xe2\x80\x89f. This point is between points x\xe2\x80\x89=\xe2\x80\x890 and x\xe2\x80\x89=\xe2\x80\x89a. There are no other gas stations on the bus route. While passing by a gas station in either direction the bus can stop and completely refuel its tank. Thus, after stopping to refuel the tank will contain b liters of gasoline.What is the minimum number of times the bus needs to refuel at the point x\xe2\x80\x89=\xe2\x80\x89f to make k journeys? The first journey starts in the point x\xe2\x80\x89=\xe2\x80\x890." 1500.0                                 
               863C 1-2-3 graphs,implementation "Ilya is working for the company that constructs robots. Ilya writes programs for entertainment robots, and his current project is ""Bob"", a new-generation game robot. Ilya\'s boss wants to know his progress so far. Especially he is interested if Bob is better at playing different games than the previous model, ""Alice"". So now Ilya wants to compare his robots\' performance in a simple game called ""1-2-3"". This game is similar to the ""Rock-Paper-Scissors"" game: both robots secretly choose a number from the set {1,\xe2\x80\x892,\xe2\x80\x893} and say it at the same moment. If both robots choose the same number, then it\'s a draw and noone gets any points. But if chosen numbers are different, then one of the robots gets a point: 3 beats 2, 2 beats 1 and 1 beats 3. Both robots\' programs make them choose their numbers in such a way that their choice in (i\xe2\x80\x89+\xe2\x80\x891)-th game depends only on the numbers chosen by them in i-th game. Ilya knows that the robots will play k games, Alice will choose number a in the first game, and Bob will choose b in the first game. He also knows both robots\' programs and can tell what each robot will choose depending on their choices in previous game. Ilya doesn\'t want to wait until robots play all k games, so he asks you to predict the number of points they will have after the final game." 1800.0                                 
               863B Kayaking "brute force,greedy,sortings" "Vadim is really keen on travelling. Recently he heard about kayaking activity near his town and became very excited about it, so he joined a party of kayakers.Now the party is ready to start its journey, but firstly they have to choose kayaks. There are 2\xc2\xb7n people in the group (including Vadim), and they have exactly n\xe2\x80\x89-\xe2\x80\x891 tandem kayaks (each of which, obviously, can carry two people) and 2 single kayaks. i-th person\'s weight is wi, and weight is an important matter in kayaking \xe2\x80\x94 if the difference between the weights of two people that sit in the same tandem kayak is too large, then it can crash. And, of course, people want to distribute their seats in kayaks in order to minimize the chances that kayaks will crash.Formally, the instability of a single kayak is always 0, and the instability of a tandem kayak is the absolute difference between weights of the people that are in this kayak. Instability of the whole journey is the total instability of all kayaks.Help the party to determine minimum possible total instability!" 1500.0                                 
               862C "Mahmoud and Ehab and the xor" "constructive algorithms" "Mahmoud and Ehab are on the third stage of their adventures now. As you know, Dr. Evil likes sets. This time he won\'t show them any set from his large collection, but will ask them to create a new set to replenish his beautiful collection of sets.Dr. Evil has his favorite evil integer x. He asks Mahmoud and Ehab to find a set of n distinct non-negative integers such the bitwise-xor sum of the integers in it is exactly x. Dr. Evil doesn\'t like big numbers, so any number in the set shouldn\'t be greater than 106." 1900.0                                 
               859C "Pie Rules" dp,games "You may have heard of the pie rule before. It states that if two people wish to fairly share a slice of pie, one person should cut the slice in half, and the other person should choose who gets which slice. Alice and Bob have many slices of pie, and rather than cutting the slices in half, each individual slice will be eaten by just one person.The way Alice and Bob decide who eats each slice is as follows. First, the order in which the pies are to be handed out is decided. There is a special token called the ""decider"" token, initially held by Bob. Until all the pie is handed out, whoever has the decider token will give the next slice of pie to one of the participants, and the decider token to the other participant. They continue until no slices of pie are left.All of the slices are of excellent quality, so each participant obviously wants to maximize the total amount of pie they get to eat. Assuming both players make their decisions optimally, how much pie will each participant receive?" 1500.0                                 
               858B "Which floor?" "brute force,implementation" "In a building where Polycarp lives there are equal number of flats on each floor. Unfortunately, Polycarp don\'t remember how many flats are on each floor, but he remembers that the flats are numbered from 1 from lower to upper floors. That is, the first several flats are on the first floor, the next several flats are on the second and so on. Polycarp don\'t remember the total number of flats in the building, so you can consider the building to be infinitely high (i.e. there are infinitely many floors). Note that the floors are numbered from 1.Polycarp remembers on which floors several flats are located. It is guaranteed that this information is not self-contradictory. It means that there exists a building with equal number of flats on each floor so that the flats from Polycarp\'s memory have the floors Polycarp remembers.Given this information, is it possible to restore the exact floor for flat n?" 1500.0                                 
               856C "Eleventh Birthday" combinatorics,dp,math "It is Borya\'s eleventh birthday, and he has got a great present: n cards with numbers. The i-th card has the number ai written on it. Borya wants to put his cards in a row to get one greater number. For example, if Borya has cards with numbers 1, 31, and 12, and he puts them in a row in this order, he would get a number 13112.He is only 11, but he already knows that there are n! ways to put his cards in a row. But today is a special day, so he is only interested in such ways that the resulting big number is divisible by eleven. So, the way from the previous paragraph is good, because 13112\xe2\x80\x89=\xe2\x80\x891192\xe2\x80\x89\xc3\x97\xe2\x80\x8911, but if he puts the cards in the following order: 31, 1, 12, he would get a number 31112, it is not divisible by 11, so this way is not good for Borya. Help Borya to find out how many good ways to put the cards are there.Borya considers all cards different, even if some of them contain the same number. For example, if Borya has two cards with 1 on it, there are two good ways.Help Borya, find the number of good ways to put the cards. This number can be large, so output it modulo 998244353." 2400.0                                 
               852H "Bob and stages" dp,geometry "The citizens of BubbleLand are celebrating their 10th anniversary so they decided to organize a big music festival. Bob got a task to invite N famous singers who would sing on the fest. He was too busy placing stages for their performances that he totally forgot to write the invitation e-mails on time, and unfortunately he only found K available singers. Now there are more stages than singers, leaving some of the stages empty. Bob would not like if citizens of BubbleLand noticed empty stages and found out that he was irresponsible.Because of that he decided to choose exactly K stages that form a convex set, make large posters as edges of that convex set and hold festival inside. While those large posters will make it impossible for citizens to see empty stages outside Bob still needs to make sure they don\'t see any of the empty stages inside that area.Since lots of people are coming, he would like that the festival area is as large as possible. Help him calculate the maximum area that he could obtain respecting the conditions. If there is no such area, the festival cannot be organized and the answer is 0.00." 3000.0                                 
               852G "Bathroom terminal" implementation "Smith wakes up at the side of a dirty, disused bathroom, his ankle chained to pipes. Next to him is tape-player with a hand-written message ""Play Me"". He finds a tape in his own back pocket. After putting the tape in the tape-player, he sees a key hanging from a ceiling, chained to some kind of a machine, which is connected to the terminal next to him. After pressing a Play button a rough voice starts playing from the tape:""Listen up Smith. As you can see, you are in pretty tough situation and in order to escape, you have to solve a puzzle. You are given N strings which represent words. Each word is of the maximum length L and consists of characters \'a\'-\'e\'. You are also given M strings which represent patterns. Pattern is a string of length \xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89 L and consists of characters \'a\'-\'e\' as well as the maximum 3 characters \'?\'. Character \'?\' is an unknown character, meaning it can be equal to any character \'a\'-\'e\', or even an empty character. For each pattern find the number of words that matches with the given pattern. After solving it and typing the result in the terminal, the key will drop from the ceiling and you may escape. Let the game begin.""Help Smith escape." 1700.0                                 
               851A "Arpa and a research in Mexican wave" implementation,math "Arpa is researching the Mexican wave.There are n spectators in the stadium, labeled from 1 to n. They start the Mexican wave at time 0.   At time 1, the first spectator stands.  At time 2, the second spectator stands.  ...  At time k, the k-th spectator stands.  At time k\xe2\x80\x89+\xe2\x80\x891, the (k\xe2\x80\x89+\xe2\x80\x891)-th spectator stands and the first spectator sits.  At time k\xe2\x80\x89+\xe2\x80\x892, the (k\xe2\x80\x89+\xe2\x80\x892)-th spectator stands and the second spectator sits.  ...  At time n, the n-th spectator stands and the (n\xe2\x80\x89-\xe2\x80\x89k)-th spectator sits.  At time n\xe2\x80\x89+\xe2\x80\x891, the (n\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89k)-th spectator sits.  ...  At time n\xe2\x80\x89+\xe2\x80\x89k, the n-th spectator sits. Arpa wants to know how many spectators are standing at time t." 800.0                                 
               848A "From Y to Y" "constructive algorithms" "From beginning till end, this message has been waiting to be conveyed.For a given unordered multiset of n lowercase English letters (""multi"" means that a letter may appear more than once), we treat all letters as strings of length 1, and repeat the following operation n\xe2\x80\x89-\xe2\x80\x891 times:  Remove any two elements s and t from the set, and add their concatenation s\xe2\x80\x89+\xe2\x80\x89t to the set. The cost of such operation is defined to be , where f(s,\xe2\x80\x89c) denotes the number of times character c appears in string s.Given a non-negative integer k, construct any valid non-empty set of no more than 100\xe2\x80\x89000 letters, such that the minimum accumulative cost of the whole process is exactly k. It can be shown that a solution always exists." 1600.0                                 
               847G "University Classes" implementation "There are n student groups at the university. During the study day, each group can take no more than 7 classes. Seven time slots numbered from 1 to 7 are allocated for the classes.The schedule on Monday is known for each group, i. e. time slots when group will have classes are known.Your task is to determine the minimum number of rooms needed to hold classes for all groups on Monday. Note that one room can hold at most one group class in a single time slot." 900.0                                 
               847F "Berland Elections" greedy,sortings "The elections to Berland parliament are happening today. Voting is in full swing!Totally there are n candidates, they are numbered from 1 to n. Based on election results k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) top candidates will take seats in the parliament.After the end of the voting the number of votes for each candidate is calculated. In the resulting table the candidates are ordered by the number of votes. In case of tie (equal number of votes) they are ordered by the time of the last vote given. The candidate with ealier last vote stands higher in the resulting table.So in the resulting table candidates are sorted by the number of votes (more votes stand for the higher place) and if two candidates have equal number of votes they are sorted by the time of last vote (earlier last vote stands for the higher place).There is no way for a candidate with zero votes to take a seat in the parliament. So it is possible that less than k candidates will take a seat in the parliament.In Berland there are m citizens who can vote. Each of them will vote for some candidate. Each citizen will give a vote to exactly one of n candidates. There is no option ""against everyone"" on the elections. It is not accepted to spoil bulletins or not to go to elections. So each of m citizens will vote for exactly one of n candidates.At the moment a citizens have voted already (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). This is an open election, so for each citizen it is known the candidate for which the citizen has voted. Formally, the j-th citizen voted for the candidate gj. The citizens who already voted are numbered in chronological order; i.e. the (j\xe2\x80\x89+\xe2\x80\x891)-th citizen voted after the j-th.The remaining m\xe2\x80\x89-\xe2\x80\x89a citizens will vote before the end of elections, each of them will vote for one of n candidates.Your task is to determine for each of n candidates one of the three possible outcomes:  a candidate will be elected to the parliament regardless of votes of the remaining m\xe2\x80\x89-\xe2\x80\x89a citizens;  a candidate has chance to be elected to the parliament after all n citizens have voted;  a candidate has no chances to be elected to the parliament regardless of votes of the remaining m\xe2\x80\x89-\xe2\x80\x89a citizens." 2100.0                                 
               847C "Sum of Nestings" "constructive algorithms" "Recall that the bracket sequence is considered regular if it is possible to insert symbols \'+\' and \'1\' into it so that the result is a correct arithmetic expression. For example, a sequence ""(()())"" is regular, because we can get correct arithmetic expression insering symbols \'+\' and \'1\': ""((1+1)+(1+1))"". Also the following sequences are regular: ""()()()"", ""(())"" and ""()"". The following sequences are not regular bracket sequences: "")("", ""(()"" and ""())(()"".In this problem you are given two integers n and k. Your task is to construct a regular bracket sequence consisting of round brackets with length 2\xc2\xb7n with total sum of nesting of all opening brackets equals to exactly k. The nesting of a single opening bracket equals to the number of pairs of brackets in which current opening bracket is embedded.For example, in the sequence ""()(())"" the nesting of first opening bracket equals to 0, the nesting of the second opening bracket equals to 0 and the nesting of the third opening bracket equal to 1. So the total sum of nestings equals to 1." 1800.0                                 
               845E "Fire in the City" "binary search,data structures" "The capital of Berland looks like a rectangle of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m of the square blocks of same size.Fire!It is known that k\xe2\x80\x89+\xe2\x80\x891 blocks got caught on fire (k\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xc2\xb7m). Those blocks are centers of ignition. Moreover positions of k of these centers are known and one of these stays unknown. All k\xe2\x80\x89+\xe2\x80\x891 positions are distinct.The fire goes the following way: during the zero minute of fire only these k\xe2\x80\x89+\xe2\x80\x891 centers of ignition are burning. Every next minute the fire goes to all neighbouring blocks to the one which is burning. You can consider blocks to burn for so long that this time exceeds the time taken in the problem. The neighbouring blocks are those that touch the current block by a side or by a corner.Berland Fire Deparment wants to estimate the minimal time it takes the fire to lighten up the whole city. Remember that the positions of k blocks (centers of ignition) are known and (k\xe2\x80\x89+\xe2\x80\x891)-th can be positioned in any other block.Help Berland Fire Department to estimate the minimal time it takes the fire to lighten up the whole city." 2400.0                                 
               843D "Dynamic Shortest Path" "graphs,shortest paths" "You are given a weighted directed graph, consisting of n vertices and m edges. You should answer q queries of two types:  1 v \xe2\x80\x94 find the length of shortest path from vertex 1 to vertex v.  2 c l1 l2 ... lc \xe2\x80\x94 add 1 to weights of edges with indices l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lc." 3400.0                                 
               842E "Nikita and game" "binary search,dfs and similar,divide and conquer,graphs,trees" "Nikita plays a new computer game. There are m levels in this game. In the beginning of each level a new class appears in the game; this class is a child-class of the class yi (and yi is called parent-class for this new class). Thus, the classes form a tree. Initially there is only one class with index 1.Changing the class to its neighbour (child-class or parent-class) in the tree costs 1 coin. You can not change the class back. The cost of changing the class a to the class b is equal to the total cost of class changes on the path from a to b in the class tree.Suppose that at i -th level the maximum cost of changing one class to another is x. For each level output the number of classes such that for each of these classes there exists some other class y, and the distance from this class to y is exactly x." 2800.0                                 
               842D "Vitya and Strange Lesson" "binary search,data structures" "Today at the lesson Vitya learned a very interesting function \xe2\x80\x94 mex. Mex of a sequence of numbers is the minimum non-negative number that is not present in the sequence as element. For example, mex([4,\xe2\x80\x8933,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x895])\xe2\x80\x89=\xe2\x80\x892 and mex([1,\xe2\x80\x892,\xe2\x80\x893])\xe2\x80\x89=\xe2\x80\x890.Vitya quickly understood all tasks of the teacher, but can you do the same?You are given an array consisting of n non-negative integers, and m queries. Each query is characterized by one number x and consists of the following consecutive steps:  Perform the bitwise addition operation modulo 2 (xor) of each array element with the number x.  Find mex of the resulting array. Note that after each query the array changes." 2000.0                                 
               838F "Expected Earnings"  "You are playing a game with a bag of red and black balls. Initially, you are told that the bag has n balls total. In addition, you are also told that the bag has probability pi\xe2\x80\x89/\xe2\x80\x89106 of containing exactly i red balls.You now would like to buy balls from this bag. You really like the color red, so red balls are worth a unit of 1, while black balls are worth nothing. To buy a ball, if there are still balls in the bag, you pay a cost c with 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891, and draw a ball randomly from the bag. You can choose to stop buying at any point (and you can even choose to not buy anything at all).Given that you buy optimally to maximize the expected profit (i.e. # red balls - cost needed to obtain them), print the maximum expected profit." 2800.0                                 
               838D "Airplane Arrangements" "math,number theory" "There is an airplane which has n rows from front to back. There will be m people boarding this airplane.This airplane has an entrance at the very front and very back of the plane.Each person has some assigned seat. It is possible for multiple people to have the same assigned seat. The people will then board the plane one by one starting with person 1. Each person can independently choose either the front entrance or back entrance to enter the plane.When a person walks into the plane, they walk directly to their assigned seat and will try to sit in it. If it is occupied, they will continue walking in the direction they walked in until they are at empty seat - they will take the earliest empty seat that they can find. If they get to the end of the row without finding a seat, they will be angry.Find the number of ways to assign tickets to the passengers and board the plane without anyone getting angry. Two ways are different if there exists a passenger who chose a different entrance in both ways, or the assigned seat is different. Print this count modulo 109\xe2\x80\x89+\xe2\x80\x897." 2700.0                                 
               835F "Roads in the Kingdom" "dfs and similar,dp,graphs,trees" "In the Kingdom K., there are n towns numbered with integers from 1 to n. The towns are connected by n bi-directional roads numbered with integers from 1 to n. The i-th road connects the towns ui and vi and its length is li. There is no more than one road between two towns. Also, there are no roads that connect the towns with itself.Let\'s call the inconvenience of the roads the maximum of the shortest distances between all pairs of towns.Because of lack of money, it was decided to close down one of the roads so that after its removal it is still possible to reach any town from any other. You have to find the minimum possible inconvenience of the roads after closing down one of the roads." 2500.0                                 
               830C "Bamboo Partition" "brute force,data structures,implementation,math,number theory,sortings,two pointers" "Vladimir wants to modernize partitions in his office. To make the office more comfortable he decided to remove a partition and plant several bamboos in a row. He thinks it would be nice if there are n bamboos in a row, and the i-th from the left is ai meters high. Vladimir has just planted n bamboos in a row, each of which has height 0 meters right now, but they grow 1 meter each day. In order to make the partition nice Vladimir can cut each bamboo once at any height (no greater that the height of the bamboo), and then the bamboo will stop growing.Vladimir wants to check the bamboos each d days (i.e. d days after he planted, then after 2d days and so on), and cut the bamboos that reached the required height. Vladimir wants the total length of bamboo parts he will cut off to be no greater than k meters.What is the maximum value d he can choose so that he can achieve what he wants without cutting off more than k meters of bamboo?" 2300.0                                 
               828B "Black Square" implementation "Polycarp has a checkered sheet of paper of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Polycarp painted some of cells with black, the others remained white. Inspired by Malevich\'s ""Black Square"", Polycarp wants to paint minimum possible number of white cells with black so that all black cells form a square.You are to determine the minimum possible number of cells needed to be painted black so that the black cells form a black square with sides parallel to the painting\'s sides. All the cells that do not belong to the square should be white. The square\'s side should have positive length." 1300.0                                 
               822F Madness "constructive algorithms,dfs and similar,trees" "The second semester starts at the University of Pavlopolis. After vacation in Vi\xc4\x8dkopolis Noora needs to return to Pavlopolis and continue her study.Sometimes (or quite often) there are teachers who do not like you. Incidentally Noora also has one such teacher. His name is Yury Dmitrievich and he teaches graph theory. Yury Dmitrievich doesn\'t like Noora, so he always gives the girl the most difficult tasks. So it happened this time.The teacher gives Noora a tree with n vertices. Vertices are numbered with integers from 1 to n. The length of all the edges of this tree is 1. Noora chooses a set of simple paths that pairwise don\'t intersect in edges. However each vertex should belong to at least one of the selected path.For each of the selected paths, the following is done:  We choose exactly one edge (u,\xe2\x80\x89v) that belongs to the path.  On the selected edge (u,\xe2\x80\x89v) there is a point at some selected distance x from the vertex u and at distance 1\xe2\x80\x89-\xe2\x80\x89x from vertex v. But the distance x chosen by Noora arbitrarily, i. e. it can be different for different edges.  One of the vertices u or v is selected. The point will start moving to the selected vertex. Let us explain how the point moves by example. Suppose that the path consists of two edges (v1,\xe2\x80\x89v2) and (v2,\xe2\x80\x89v3), the point initially stands on the edge (v1,\xe2\x80\x89v2) and begins its movement to the vertex v1. Then the point will reach v1, then ""turn around"", because the end of the path was reached, further it will move in another direction to vertex v2, then to vertex v3, then ""turn around"" again, then move to v2 and so on. The speed of the points is 1 edge per second. For example, for 0.5 second the point moves to the length of the half of an edge.A stopwatch is placed at each vertex of the tree. The time that the stopwatches indicate at start time is 0 seconds. Then at the starting moment of time, all points simultaneously start moving from the selected positions to selected directions along the selected paths, and stopwatches are simultaneously started. When one of the points reaches the vertex v, the stopwatch at the vertex v is automatically reset, i.e. it starts counting the time from zero.Denote by resv the maximal time that the stopwatch at the vertex v will show if the point movement continues infinitely. Noora is asked to select paths and points on them so that res1 is as minimal as possible. If there are several solutions to do this, it is necessary to minimize res2, then res3, res4,\xe2\x80\x89...,\xe2\x80\x89resn.Help Noora complete the teacher\'s task.For the better understanding of the statement, see the explanation for the example." 2500.0                                 
               819C "Mister B and Beacons on Field" "number theory" "Mister B has a house in the middle of a giant plain field, which attracted aliens life. For convenience, aliens specified the Cartesian coordinate system on the field in such a way that Mister B\'s house has coordinates (0,\xe2\x80\x890). After that they sent three beacons to the field, but something went wrong. One beacon was completely destroyed, while the other two landed in positions with coordinates (m,\xe2\x80\x890) and (0,\xe2\x80\x89n), respectively, but shut down.Mister B was interested in this devices, so he decided to take them home. He came to the first beacon, placed at (m,\xe2\x80\x890), lifted it up and carried the beacon home choosing the shortest path. After that he came to the other beacon, placed at (0,\xe2\x80\x89n), and also carried it home choosing the shortest path. When first beacon was lifted up, the navigation system of the beacons was activated.Partially destroyed navigation system started to work in following way.At time moments when both survived beacons are at points with integer coordinates the system tries to find a location for the third beacon. It succeeds if and only if there is a point with integer coordinates such that the area of the triangle formed by the two survived beacons and this point is equal to s. In this case the system sends a packet of information with beacon positions to aliens, otherwise it doesn\'t.Compute how many packets of information system sent while Mister B was moving the beacons." 2900.0                                 
               818F "Level Generation" "binary search,math,ternary search" "Ivan is developing his own computer game. Now he tries to create some levels for his game. But firstly for each level he needs to draw a graph representing the structure of the level.Ivan decided that there should be exactly ni vertices in the graph representing level i, and the edges have to be bidirectional. When constructing the graph, Ivan is interested in special edges called bridges. An edge between two vertices u and v is called a bridge if this edge belongs to every path between u and v (and these vertices will belong to different connected components if we delete this edge). For each level Ivan wants to construct a graph where at least half of the edges are bridges. He also wants to maximize the number of edges in each constructed graph.So the task Ivan gave you is: given q numbers n1,\xe2\x80\x89n2,\xe2\x80\x89...,\xe2\x80\x89nq, for each i tell the maximum number of edges in a graph with ni vertices, if at least half of the edges are bridges. Note that the graphs cannot contain multiple edges or self-loops." 2100.0                                 
               817B "Makes And The Product" combinatorics,implementation,math,sortings "After returning from the army Makes received a gift \xe2\x80\x94 an array a consisting of n positive integer numbers. He hadn\'t been solving problems for a long time, so he became interested to answer a particular question: how many triples of indices (i,\xe2\x80\x89 j,\xe2\x80\x89 k) (i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89k), such that ai\xc2\xb7aj\xc2\xb7ak is minimum possible, are there in the array? Help him with it!" 1500.0                                 
               816B "Karen and Coffee" "binary search,data structures,implementation" "To stay woke and attentive during classes, Karen needs some coffee!  Karen, a coffee aficionado, wants to know the optimal temperature for brewing the perfect cup of coffee. Indeed, she has spent some time reading several recipe books, including the universally acclaimed ""The Art of the Covfefe"".She knows n coffee recipes. The i-th recipe suggests that coffee should be brewed between li and ri degrees, inclusive, to achieve the optimal taste.Karen thinks that a temperature is admissible if at least k recipes recommend it.Karen has a rather fickle mind, and so she asks q questions. In each question, given that she only wants to prepare coffee with a temperature between a and b, inclusive, can you tell her how many admissible integer temperatures fall within the range?" 1400.0                                 
               815D "Karen and Cards" "binary search,combinatorics,data structures,geometry" "Karen just got home from the supermarket, and is getting ready to go to sleep.  After taking a shower and changing into her pajamas, she looked at her shelf and saw an album. Curious, she opened it and saw a trading card collection.She recalled that she used to play with those cards as a child, and, although she is now grown-up, she still wonders a few things about it.Each card has three characteristics: strength, defense and speed. The values of all characteristics of all cards are positive integers. The maximum possible strength any card can have is p, the maximum possible defense is q and the maximum possible speed is r.There are n cards in her collection. The i-th card has a strength ai, defense bi and speed ci, respectively.A card beats another card if at least two of its characteristics are strictly greater than the corresponding characteristics of the other card.She now wonders how many different cards can beat all the cards in her collection. Two cards are considered different if at least one of their characteristics have different values." 2800.0                                 
               810A "Straight <<A>>" implementation,math "Noora is a student of one famous high school. It\'s her final year in school \xe2\x80\x94 she is going to study in university next year. However, she has to get an \xc2\xabA\xc2\xbb graduation certificate in order to apply to a prestigious one.In school, where Noora is studying, teachers are putting down marks to the online class register, which are integers from 1 to k. The worst mark is 1, the best is k. Mark that is going to the certificate, is calculated as an average of all the marks, rounded to the closest integer. If several answers are possible, rounding up is produced. For example, 7.3 is rounded to 7, but 7.5 and 7.8784 \xe2\x80\x94 to 8. For instance, if Noora has marks [8,\xe2\x80\x899], then the mark to the certificate is 9, because the average is equal to 8.5 and rounded to 9, but if the marks are [8,\xe2\x80\x898,\xe2\x80\x899], Noora will have graduation certificate with 8.To graduate with \xc2\xabA\xc2\xbb certificate, Noora has to have mark k.Noora got n marks in register this year. However, she is afraid that her marks are not enough to get final mark k. Noora decided to ask for help in the internet, where hacker Leha immediately responded to her request. He is ready to hack class register for Noora and to add Noora any number of additional marks from 1 to k. At the same time, Leha want his hack be unseen to everyone, so he decided to add as less as possible additional marks. Please help Leha to calculate the minimal number of marks he has to add, so that final Noora\'s mark will become equal to k." 900.0                                 
               802M "April Fools\' Problem (easy)" greedy,sortings "The marmots have prepared a very easy problem for this year\'s HC2 \xe2\x80\x93 this one. It involves numbers n, k and a sequence of n positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. They also came up with a beautiful and riveting story for the problem statement. It explains what the input means, what the program should output, and it also reads like a good criminal.However I, Heidi, will have none of that. As my joke for today, I am removing the story from the statement and replacing it with these two unhelpful paragraphs. Now solve the problem, fools!" 1200.0                                 
               802J "Send the Fool Further! (easy)" "dfs and similar,graphs,trees" "Heidi\'s friend Jenny is asking Heidi to deliver an important letter to one of their common friends. Since Jenny is Irish, Heidi thinks that this might be a prank. More precisely, she suspects that the message she is asked to deliver states: ""Send the fool further!"", and upon reading it the recipient will ask Heidi to deliver the same message to yet another friend (that the recipient has in common with Heidi), and so on.Heidi believes that her friends want to avoid awkward situations, so she will not be made to visit the same person (including Jenny) twice. She also knows how much it costs to travel between any two of her friends who know each other. She wants to know: what is the maximal amount of money she will waste on travel if it really is a prank?Heidi\'s n friends are labeled 0 through n\xe2\x80\x89-\xe2\x80\x891, and their network of connections forms a tree. In other words, every two of her friends a, b know each other, possibly indirectly (there is a sequence of friends starting from a and ending on b and such that each two consecutive friends in the sequence know each other directly), and there are exactly n\xe2\x80\x89-\xe2\x80\x891 pairs of friends who know each other directly.Jenny is given the number 0." 1400.0                                 
               802A "Heidi and Library (easy)" greedy "Your search for Heidi is over \xe2\x80\x93 you finally found her at a library, dressed up as a human. In fact, she has spent so much time there that she now runs the place! Her job is to buy books and keep them at the library so that people can borrow and read them. There are n different books, numbered 1 through n.We will look at the library\'s operation during n consecutive days. Heidi knows in advance that on the i-th day (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) precisely one person will come to the library, request to borrow the book ai, read it in a few hours, and return the book later on the same day.Heidi desperately wants to please all her guests, so she will make sure to always have the book ai available in the library on the i-th day. During the night before the i-th day, she has the option of going to the bookstore (which operates at nights to avoid competition with the library) and buying any book for the price of 1 CHF. Of course, if she already has a book at the library, she does not need to buy it again. Initially, the library contains no books.There is a problem, though. The capacity of the library is k \xe2\x80\x93 this means that at any time, there can be at most k books at the library. If buying a new book would cause Heidi to have more than k books, she must first get rid of some book that she already has, in order to make room for the new book. If she later needs a book that she got rid of, she will need to buy that book again.You are given k and the sequence of requests for books a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. What is the minimum cost (in CHF) of buying new books to satisfy all the requests?" 1800.0                                 
               798B "Mike and strings" "brute force,dp,strings" "Mike has n strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn each consisting of lowercase English letters. In one move he can choose a string si, erase the first character and append it to the end of the string. For example, if he has the string ""coolmike"", in one move he can transform it into the string ""oolmikec"".Now Mike asks himself: what is minimal number of moves that he needs to do in order to make all the strings equal?" 1300.0                                 
               796F "Sequence Recovery" "bitmasks,data structures,greedy" "Zane once had a good sequence a consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an \xe2\x80\x94 but he has lost it.A sequence is said to be good if and only if all of its integers are non-negative and do not exceed 109 in value.  However, Zane remembers having played around with his sequence by applying m operations to it.There are two types of operations:1. Find the maximum value of integers with indices i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r, given l and r.2. Assign d as the value of the integer with index k, given k and d.After he finished playing, he restored his sequence to the state it was before any operations were applied. That is, sequence a was no longer affected by the applied type 2 operations. Then, he lost his sequence at some time between now and then.Fortunately, Zane remembers all the operations and the order he applied them to his sequence, along with the distinct results of all type 1 operations. Moreover, among all good sequences that would produce the same results when the same operations are applied in the same order, he knows that his sequence a has the greatest cuteness.We define cuteness of a sequence as the bitwise OR result of all integers in such sequence. For example, the cuteness of Zane\'s sequence a is a1 OR a2 OR ... OR an.Zane understands that it might not be possible to recover exactly the lost sequence given his information, so he would be happy to get any good sequence b consisting of n integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn that:1. would give the same results when the same operations are applied in the same order, and2. has the same cuteness as that of Zane\'s original sequence a.If there is such a sequence, find it. Otherwise, it means that Zane must have remembered something incorrectly, which is possible." 2800.0                                 
               794E "Choosing Carrot" games,math "Oleg the bank client and Igor the analyst are arguing again. This time, they want to pick a gift as a present for their friend, ZS the coder. After a long thought, they decided that their friend loves to eat carrots the most and thus they want to pick the best carrot as their present.There are n carrots arranged in a line. The i-th carrot from the left has juiciness ai. Oleg thinks ZS loves juicy carrots whereas Igor thinks that he hates juicy carrots. Thus, Oleg would like to maximize the juiciness of the carrot they choose while Igor would like to minimize the juiciness of the carrot they choose.To settle this issue, they decided to play a game again. Oleg and Igor take turns to play the game. In each turn, a player can choose a carrot from either end of the line, and eat it. The game ends when only one carrot remains. Oleg moves first. The last remaining carrot will be the carrot that they will give their friend, ZS.Oleg is a sneaky bank client. When Igor goes to a restroom, he performs k moves before the start of the game. Each move is the same as above (eat a carrot from either end of the line). After Igor returns, they start the game with Oleg still going first. Oleg wonders: for each k such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, what is the juiciness of the carrot they will give to ZS if he makes k extra moves beforehand and both players play optimally?" 2800.0                                 
               793G "Oleg and chess" "data structures,divide and conquer,flows,graph matchings" "Oleg the bank client solves an interesting chess problem: place on n\xe2\x80\x89\xc3\x97\xe2\x80\x89n chessboard the maximum number of rooks so that they don\'t beat each other. Of course, no two rooks can share the same cell.Remind that a rook standing in the cell (a,\xe2\x80\x89b) beats a rook standing in the cell (x,\xe2\x80\x89y) if and only if a\xe2\x80\x89=\xe2\x80\x89x or b\xe2\x80\x89=\xe2\x80\x89y.Unfortunately (of fortunately?) for Oleg the answer in this problem was always n, so the task bored Oleg soon. He decided to make it more difficult by removing some cells from the board. If a cell is deleted, Oleg can\'t put a rook there, but rooks do beat each other ""through"" deleted cells.Oleg deletes the cells in groups, namely, he repeatedly choose a rectangle with sides parallel to the board sides and deletes all the cells inside the rectangle. Formally, if he chooses a rectangle, lower left cell of which has coordinates (x1,\xe2\x80\x89y1), and upper right cell of which has coordinates (x2,\xe2\x80\x89y2), then he deletes all such cells with coordinates (x,\xe2\x80\x89y) that x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2 and y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2. It is guaranteed that no cell is deleted twice, i.e. the chosen rectangles do not intersect.This version of the problem Oleg can\'t solve, and his friend Igor is busy at a conference, so he can\'t help Oleg.You are the last hope for Oleg! Help him: given the size of the board and the deleted rectangles find the maximum possible number of rooks that could be placed on the board so that no two rooks beat each other." 3400.0                                 
               786C "Till I Collapse" "data structures,divide and conquer" "Rick and Morty want to find MR. PBH and they can\'t do it alone. So they need of Mr. Meeseeks. They Have generated n Mr. Meeseeks, standing in a line numbered from 1 to n. Each of them has his own color. i-th Mr. Meeseeks\' color is ai. Rick and Morty are gathering their army and they want to divide Mr. Meeseeks into some squads. They don\'t want their squads to be too colorful, so each squad should have Mr. Meeseeks of at most k different colors. Also each squad should be a continuous subarray of Mr. Meeseeks in the line. Meaning that for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89e\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, if Mr. Meeseeks number i and Mr. Meeseeks number j are in the same squad then Mr. Meeseeks number e should be in that same squad.  Also, each squad needs its own presidio, and building a presidio needs money, so they want the total number of squads to be minimized.Rick and Morty haven\'t finalized the exact value of k, so in order to choose it, for each k between 1 and n (inclusive) need to know the minimum number of presidios needed." 2400.0                                 
               785C "Anton and Fairy Tale" "binary search,math" "Anton likes to listen to fairy tales, especially when Danik, Anton\'s best friend, tells them. Right now Danik tells Anton a fairy tale:""Once upon a time, there lived an emperor. He was very rich and had much grain. One day he ordered to build a huge barn to put there all his grain. Best builders were building that barn for three days and three nights. But they overlooked and there remained a little hole in the barn, from which every day sparrows came through. Here flew a sparrow, took a grain and flew away...""More formally, the following takes place in the fairy tale. At the beginning of the first day the barn with the capacity of n grains was full. Then, every day (starting with the first day) the following happens:  m grains are brought to the barn. If m grains doesn\'t fit to the barn, the barn becomes full and the grains that doesn\'t fit are brought back (in this problem we can assume that the grains that doesn\'t fit to the barn are not taken into account).  Sparrows come and eat grain. In the i-th day i sparrows come, that is on the first day one sparrow come, on the second day two sparrows come and so on. Every sparrow eats one grain. If the barn is empty, a sparrow eats nothing. Anton is tired of listening how Danik describes every sparrow that eats grain from the barn. Anton doesn\'t know when the fairy tale ends, so he asked you to determine, by the end of which day the barn will become empty for the first time. Help Anton and write a program that will determine the number of that day!" 1600.0                                 
               784F "Crunching Numbers Just for You" "*special problem,implementation" "You are developing a new feature for the website which sells airline tickets: being able to sort tickets by price! You have already extracted the tickets\' prices, so there\'s just the last step to be done...You are given an array of integers. Sort it in non-descending order." 1900.0                                 
               784E "Twisted Circuit" "*special problem,brute force,implementation"  2000.0                                 
               780H "Intranet of Buses" "binary search,geometry,implementation,two pointers" "A new bus route is opened in the city . The route is a closed polygon line in the place, with all segments parallel to one of the axes. m buses will operate on the route. All buses move in a loop along the route in the same direction with equal constant velocities (stopping times are negligible in this problem).Buses start their movement in the first vertex of the route with equal interval. Suppose that T is the total time for a single bus to travel the whole loop of the route. Then, the bus 1 starts moving at time 0, the bus 2 starts at time T\xe2\x80\x89/\xe2\x80\x89m, the bus 3 starts at time 2T\xe2\x80\x89/\xe2\x80\x89m, and so on; finally, the bus m starts moving at time (m\xe2\x80\x89-\xe2\x80\x891)T\xe2\x80\x89/\xe2\x80\x89m. Thus, all intervals between pairs of consecutive buses (including the interval between the last and the first bus) are equal.Buses can communicate with each other via wireless transmitters of equal power. If the transmitters have power D, then only buses within distance D of each other can communicate.The buses are also equipped with a distributed system of schedule tracking. For all buses to stick to the schedule, the system has to synchronize the necessary data between all buses from time to time. At the moment of synchronization, the bus 1 communicates with the bus 2, the bus 2 \xe2\x80\x94 with bus 3, and so on; also, the bus m communicates with the bus 1.As a research employee, you are tasked with finding the smallest value of D such that it is possible to find a time moment to perform synchronization once all buses have started moving." 3100.0                                 
               780D "Innokenty and a Football League" "2-sat,graphs,greedy,implementation,shortest paths,strings" "Innokenty is a president of a new football league in Byteland. The first task he should do is to assign short names to all clubs to be shown on TV next to the score. Of course, the short names should be distinct, and Innokenty wants that all short names consist of three letters.Each club\'s full name consist of two words: the team\'s name and the hometown\'s name, for example, ""DINAMO BYTECITY"". Innokenty doesn\'t want to assign strange short names, so he wants to choose such short names for each club that:   the short name is the same as three first letters of the team\'s name, for example, for the mentioned club it is ""DIN"",  or, the first two letters of the short name should be the same as the first two letters of the team\'s name, while the third letter is the same as the first letter in the hometown\'s name. For the mentioned club it is ""DIB"". Apart from this, there is a rule that if for some club x the second option of short name is chosen, then there should be no club, for which the first option is chosen which is the same as the first option for the club x. For example, if the above mentioned club has short name ""DIB"", then no club for which the first option is chosen can have short name equal to ""DIN"". However, it is possible that some club have short name ""DIN"", where ""DI"" are the first two letters of the team\'s name, and ""N"" is the first letter of hometown\'s name. Of course, no two teams can have the same short name.Help Innokenty to choose a short name for each of the teams. If this is impossible, report that. If there are multiple answer, any of them will suit Innokenty. If for some team the two options of short name are equal, then Innokenty will formally think that only one of these options is chosen." 1900.0                                 
               780C "Andryusha and Colored Balloons" "dfs and similar,graphs,greedy,trees" "Andryusha goes through a park each day. The squares and paths between them look boring to Andryusha, so he decided to decorate them.The park consists of n squares connected with (n\xe2\x80\x89-\xe2\x80\x891) bidirectional paths in such a way that any square is reachable from any other using these paths. Andryusha decided to hang a colored balloon at each of the squares. The baloons\' colors are described by positive integers, starting from 1. In order to make the park varicolored, Andryusha wants to choose the colors in a special way. More precisely, he wants to use such colors that if a, b and c are distinct squares that a and b have a direct path between them, and b and c have a direct path between them, then balloon colors on these three squares are distinct.Andryusha wants to use as little different colors as possible. Help him to choose the colors!" 1600.0                                 
               778E "Selling Numbers" dp,sortings "Boris really likes numbers and even owns a small shop selling interesting numbers. He has n decimal numbers Bi. Cost of the number in his shop is equal to the sum of costs of its digits. You are given the values cd, where cd is the cost of the digit d. Of course, Boris is interested in that numbers he owns have the maximum cost possible.Recently Boris got hold of the magical artifact A, which can allow him to increase the cost of his collection. Artifact is a string, consisting of digits and \'?\' symbols. To use the artifact, Boris must replace all \'?\' with digits to get a decimal number without leading zeros (it is also not allowed to get number 0). After that, the resulting number is added to all numbers Bi in Boris\' collection. He uses the artifact exactly once.What is the maximum cost of the collection Boris can achieve after using the artifact?" 3000.0                                 
               776C "Molly\'s Chemicals" "binary search,brute force,data structures,implementation,math" "Molly Hooper has n different kinds of chemicals arranged in a line. Each of the chemicals has an affection value, The i-th of them has affection value ai.Molly wants Sherlock to fall in love with her. She intends to do this by mixing a contiguous segment of chemicals together to make a love potion with total affection value as a non-negative integer power of k. Total affection value of a continuous segment of chemicals is the sum of affection values of each chemical in that segment.Help her to do so in finding the total number of such segments." 1800.0                                 
               771E "Bear and Rectangle Strips" dp,greedy "Limak has a grid that consists of 2 rows and n columns. The j-th cell in the i-th row contains an integer ti,\xe2\x80\x89j which can be positive, negative or zero.A non-empty rectangle of cells is called nice if and only if the sum of numbers in its cells is equal to 0.Limak wants to choose some nice rectangles and give them to his friends, as gifts. No two chosen rectangles should share a cell. What is the maximum possible number of nice rectangles Limak can choose?" 3000.0                                 
               771A "Bear and Friendship Condition" "dfs and similar,dsu,graphs" "Bear Limak examines a social network. Its main functionality is that two members can become friends (then they can talk with each other and share funny pictures).There are n members, numbered 1 through n. m pairs of members are friends. Of course, a member can\'t be a friend with themselves.Let A-B denote that members A and B are friends. Limak thinks that a network is reasonable if and only if the following condition is satisfied: For every three distinct members (X, Y, Z), if X-Y and Y-Z then also X-Z.For example: if Alan and Bob are friends, and Bob and Ciri are friends, then Alan and Ciri should be friends as well.Can you help Limak and check if the network is reasonable? Print ""YES"" or ""NO"" accordingly, without the quotes." 1500.0                                 
               767C Garland "dfs and similar,graphs,greedy,trees" "Once at New Year Dima had a dream in which he was presented a fairy garland. A garland is a set of lamps, some pairs of which are connected by wires. Dima remembered that each two lamps in the garland were connected directly or indirectly via some wires. Furthermore, the number of wires was exactly one less than the number of lamps.There was something unusual about the garland. Each lamp had its own brightness which depended on the temperature of the lamp. Temperatures could be positive, negative or zero. Dima has two friends, so he decided to share the garland with them. He wants to cut two different wires so that the garland breaks up into three parts. Each part of the garland should shine equally, i. e. the sums of lamps\' temperatures should be equal in each of the parts. Of course, each of the parts should be non-empty, i. e. each part should contain at least one lamp.  Help Dima to find a suitable way to cut the garland, or determine that this is impossible.While examining the garland, Dima lifted it up holding by one of the lamps. Thus, each of the lamps, except the one he is holding by, is now hanging on some wire. So, you should print two lamp ids as the answer which denote that Dima should cut the wires these lamps are hanging on. Of course, the lamp Dima is holding the garland by can\'t be included in the answer." 2000.0                                 
               765F Souvenirs "data structures" "Artsem is on vacation and wants to buy souvenirs for his two teammates. There are n souvenir shops along the street. In i-th shop Artsem can buy one souvenir for ai dollars, and he cannot buy more than one souvenir in one shop. He doesn\'t want to introduce envy in his team, so he wants to buy two souvenirs with least possible difference in price.Artsem has visited the shopping street m times. For some strange reason on the i-th day only shops with numbers from li to ri were operating (weird? yes it is, but have you ever tried to come up with a reasonable legend for a range query problem?). For each visit, Artsem wants to know the minimum possible difference in prices of two different souvenirs he can buy in the opened shops.In other words, for each Artsem\'s visit you should find the minimum possible value of |as\xe2\x80\x89-\xe2\x80\x89at| where li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s,\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri, s\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t." 3100.0                                 
               765B "Code obfuscation" greedy,implementation,strings "Kostya likes Codeforces contests very much. However, he is very disappointed that his solutions are frequently hacked. That\'s why he decided to obfuscate (intentionally make less readable) his code before upcoming contest.To obfuscate the code, Kostya first looks at the first variable name used in his program and replaces all its occurrences with a single symbol a, then he looks at the second variable name that has not been replaced yet, and replaces all its occurrences with b, and so on. Kostya is well-mannered, so he doesn\'t use any one-letter names before obfuscation. Moreover, there are at most 26 unique identifiers in his programs.You are given a list of identifiers of some program with removed spaces and line breaks. Check if this program can be a result of Kostya\'s obfuscation." 1100.0                                 
               763B "Timofey and rectangles" "constructive algorithms,geometry" "One of Timofey\'s birthday presents is a colourbook in a shape of an infinite plane. On the plane n rectangles with sides parallel to coordinate axes are situated. All sides of the rectangles have odd length. Rectangles cannot intersect, but they can touch each other.Help Timofey to color his rectangles in 4 different colors in such a way that every two rectangles touching each other by side would have different color, or determine that it is impossible.Two rectangles intersect if their intersection has positive area. Two rectangles touch by sides if there is a pair of sides such that their intersection has non-zero length  The picture corresponds to the first example" 2100.0                                 
               763A "Timofey and a tree" "dfs and similar,dp,dsu,graphs,implementation,trees" "Each New Year Timofey and his friends cut down a tree of n vertices and bring it home. After that they paint all the n its vertices, so that the i-th vertex gets color ci.Now it\'s time for Timofey birthday, and his mother asked him to remove the tree. Timofey removes the tree in the following way: he takes some vertex in hands, while all the other vertices move down so that the tree becomes rooted at the chosen vertex. After that Timofey brings the tree to a trash can.Timofey doesn\'t like it when many colors are mixing together. A subtree annoys him if there are vertices of different color in it. Timofey wants to find a vertex which he should take in hands so that there are no subtrees that annoy him. He doesn\'t consider the whole tree as a subtree since he can\'t see the color of the root vertex.A subtree of some vertex is a subgraph containing that vertex and all its descendants.Your task is to determine if there is a vertex, taking which in hands Timofey wouldn\'t be annoyed." 1600.0                                 
               762D "Maximum path" dp,greedy,implementation "You are given a rectangular table 3\xe2\x80\x89\xc3\x97\xe2\x80\x89n. Each cell contains an integer. You can move from one cell to another if they share a side.Find such path from the upper left cell to the bottom right cell of the table that doesn\'t visit any of the cells twice, and the sum of numbers written in the cells of this path is maximum possible." 2300.0                                 
               762B "USB vs. PS/2" "greedy,implementation,sortings,two pointers" "Due to the increase in the number of students of Berland State University it was decided to equip a new computer room. You were given the task of buying mouses, and you have to spend as little as possible. After all, the country is in crisis!The computers bought for the room were different. Some of them had only USB ports, some \xe2\x80\x94 only PS/2 ports, and some had both options.You have found a price list of a certain computer shop. In it, for m mouses it is specified the cost and the type of the port that is required to plug the mouse in (USB or PS/2). Each mouse from the list can be bought at most once.You want to buy some set of mouses from the given price list in such a way so that you maximize the number of computers equipped with mouses (it is not guaranteed that you will be able to equip all of the computers), and in case of equality of this value you want to minimize the total cost of mouses you will buy." 1400.0                                 
               760B "Frodo and pillows" "binary search,greedy" "n hobbits are planning to spend the night at Frodo\'s house. Frodo has n beds standing in a row and m pillows (n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Each hobbit needs a bed and at least one pillow to sleep, however, everyone wants as many pillows as possible. Of course, it\'s not always possible to share pillows equally, but any hobbit gets hurt if he has at least two pillows less than some of his neighbors have. Frodo will sleep on the k-th bed in the row. What is the maximum number of pillows he can have so that every hobbit has at least one pillow, every pillow is given to some hobbit and no one is hurt?" 1500.0                                 
               757G "Can Bash Save the Day?" "data structures,divide and conquer,graphs,trees" "Whoa! You did a great job helping Team Rocket who managed to capture all the Pokemons sent by Bash. Meowth, part of Team Rocket, having already mastered the human language, now wants to become a master in programming as well. He agrees to free the Pokemons if Bash can answer his questions.Initially, Meowth gives Bash a weighted tree containing n nodes and a sequence a1,\xe2\x80\x89a2...,\xe2\x80\x89an which is a permutation of 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n. Now, Mewoth makes q queries of one of the following forms:  1 l r v: meaning Bash should report , where dist(a,\xe2\x80\x89b) is the length of the shortest path from node a to node b in the given tree.   2 x: meaning Bash should swap ax and ax\xe2\x80\x89+\xe2\x80\x891 in the given sequence. This new sequence is used for later queries. Help Bash to answer the questions!" 3400.0                                 
               757E "Bash Plays with Functions" "brute force,combinatorics,dp,number theory" "Bash got tired on his journey to become the greatest Pokemon master. So he decides to take a break and play with functions.Bash defines a function f0(n), which denotes the number of ways of factoring n into two factors p and q such that gcd(p,\xe2\x80\x89q)\xe2\x80\x89=\xe2\x80\x891. In other words, f0(n) is the number of ordered pairs of positive integers (p,\xe2\x80\x89q) such that p\xc2\xb7q\xe2\x80\x89=\xe2\x80\x89n and gcd(p,\xe2\x80\x89q)\xe2\x80\x89=\xe2\x80\x891.But Bash felt that it was too easy to calculate this function. So he defined a series of functions, where fr\xe2\x80\x89+\xe2\x80\x891 is defined as:Where (u,\xe2\x80\x89v) is any ordered pair of positive integers, they need not to be co-prime.Now Bash wants to know the value of fr(n) for different r and n. Since the value could be huge, he would like to know the value modulo 109\xe2\x80\x89+\xe2\x80\x897. Help him!" 2500.0                                 
               757B "Bash\'s Big Day" "greedy,math,number theory" "Bash has set out on a journey to become the greatest Pokemon master. To get his first Pokemon, he went to Professor Zulu\'s Lab. Since Bash is Professor Zulu\'s favourite student, Zulu allows him to take as many Pokemon from his lab as he pleases.But Zulu warns him that a group of k\xe2\x80\x89>\xe2\x80\x891 Pokemon with strengths {s1,\xe2\x80\x89s2,\xe2\x80\x89s3,\xe2\x80\x89...,\xe2\x80\x89sk} tend to fight among each other if gcd(s1,\xe2\x80\x89s2,\xe2\x80\x89s3,\xe2\x80\x89...,\xe2\x80\x89sk)\xe2\x80\x89=\xe2\x80\x891 (see notes for gcd definition).Bash, being smart, does not want his Pokemon to fight among each other. However, he also wants to maximize the number of Pokemon he takes from the lab. Can you help Bash find out the maximum number of Pokemon he can take? Note: A Pokemon cannot fight with itself." 1400.0                                 
               756F "Long number" "expression parsing,math,number theory" "Consider the following grammar: <expression> ::= <term> | <expression> \'+\' <term> <term> ::= <number> | <number> \'-\' <number> | <number> \'(\' <expression> \')\' <number> ::= <pos_digit> | <number> <digit> <digit> ::= \'0\' | <pos_digit> <pos_digit> ::= \'1\' | \'2\' | \'3\' | \'4\' | \'5\' | \'6\' | \'7\' | \'8\' | \'9\'This grammar describes a number in decimal system using the following rules: <number> describes itself, <number>-<number> (l-r, l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) describes integer which is concatenation of all integers from l to r, written without leading zeros. For example, 8-11 describes 891011, <number>(<expression>) describes integer which is concatenation of <number> copies of integer described by <expression>, <expression>+<term> describes integer which is concatenation of integers described by <expression> and <term>.For example, 2(2-4+1)+2(2(17)) describes the integer 2341234117171717.You are given an expression in the given grammar. Print the integer described by it modulo 109\xe2\x80\x89+\xe2\x80\x897." 3400.0                                 
               756A "Pavel and barbecue" "constructive algorithms,dfs and similar" "Pavel cooks barbecue. There are n skewers, they lay on a brazier in a row, each on one of n positions. Pavel wants each skewer to be cooked some time in every of n positions in two directions: in the one it was directed originally and in the reversed direction.Pavel has a plan: a permutation p and a sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, consisting of zeros and ones. Each second Pavel move skewer on position i to position pi, and if bi equals 1 then he reverses it. So he hope that every skewer will visit every position in both directions.Unfortunately, not every pair of permutation p and sequence b suits Pavel. What is the minimum total number of elements in the given permutation p and the given sequence b he needs to change so that every skewer will visit each of 2n placements? Note that after changing the permutation should remain a permutation as well.There is no problem for Pavel, if some skewer visits some of the placements several times before he ends to cook. In other words, a permutation p and a sequence b suit him if there is an integer k (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892n), so that after k seconds each skewer visits each of the 2n placements.It can be shown that some suitable pair of permutation p and sequence b exists for any n." 1700.0                                 
               754D "Fedor and coupons" "binary search,data structures,greedy,sortings" "All our characters have hobbies. The same is true for Fedor. He enjoys shopping in the neighboring supermarket. The goods in the supermarket have unique integer ids. Also, for every integer there is a product with id equal to this integer. Fedor has n discount coupons, the i-th of them can be used with products with ids ranging from li to ri, inclusive. Today Fedor wants to take exactly k coupons with him.Fedor wants to choose the k coupons in such a way that the number of such products x that all coupons can be used with this product x is as large as possible (for better understanding, see examples). Fedor wants to save his time as well, so he asks you to choose coupons for him. Help Fedor!" 2100.0                                 
               749B "Parallelogram is Back" "brute force,constructive algorithms,geometry" "Long time ago Alex created an interesting problem about parallelogram. The input data for this problem contained four integer points on the Cartesian plane, that defined the set of vertices of some non-degenerate (positive area) parallelogram. Points not necessary were given in the order of clockwise or counterclockwise traversal.Alex had very nice test for this problem, but is somehow happened that the last line of the input was lost and now he has only three out of four points of the original parallelogram. He remembers that test was so good that he asks you to restore it given only these three points." 1200.0                                 
               749A "Bachgold Problem" "greedy,implementation,math,number theory" "Bachgold problem is very easy to formulate. Given a positive integer n represent it as a sum of maximum possible number of prime numbers. One can prove that such representation exists for any integer greater than 1.Recall that integer k is called prime if it is greater than 1 and has exactly two positive integer divisors \xe2\x80\x94 1 and k." 800.0                                 
               747F "Igor and Interesting Numbers" "brute force,combinatorics,dp,math" "Igor likes hexadecimal notation and considers positive integer in the hexadecimal notation interesting if each digit and each letter in it appears no more than t times. For example, if t\xe2\x80\x89=\xe2\x80\x893, then integers 13a13322, aaa, abcdef0123456789 are interesting, but numbers aaaa, abababab and 1000000 are not interesting.Your task is to find the k-th smallest interesting for Igor integer in the hexadecimal notation. The integer should not contain leading zeros." 2500.0                                 
               743E "Vladik and cards" "binary search,bitmasks,brute force,dp" "Vladik was bored on his way home and decided to play the following game. He took n cards and put them in a row in front of himself. Every card has a positive integer number not exceeding 8 written on it. He decided to find the longest subsequence of cards which satisfies the following conditions:  the number of occurrences of each number from 1 to 8 in the subsequence doesn\'t differ by more then 1 from the number of occurrences of any other number. Formally, if there are ck cards with number k on them in the subsequence, than for all pairs of integers  the condition |ci\xe2\x80\x89-\xe2\x80\x89cj|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 must hold.  if there is at least one card with number x on it in the subsequence, then all cards with number x in this subsequence must form a continuous segment in it (but not necessarily a continuous segment in the original sequence). For example, the subsequence [1,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x892] satisfies this condition while the subsequence [1,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x891] doesn\'t. Note that [1,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x892] doesn\'t satisfy the first condition. Please help Vladik to find the length of the longest subsequence that satisfies both conditions." 2200.0                                 
               743A "Vladik and flights" "constructive algorithms,greedy,implementation" "Vladik is a competitive programmer. This year he is going to win the International Olympiad in Informatics. But it is not as easy as it sounds: the question Vladik face now is to find the cheapest way to get to the olympiad.Vladik knows n airports. All the airports are located on a straight line. Each airport has unique id from 1 to n, Vladik\'s house is situated next to the airport with id a, and the place of the olympiad is situated next to the airport with id b. It is possible that Vladik\'s house and the place of the olympiad are located near the same airport. To get to the olympiad, Vladik can fly between any pair of airports any number of times, but he has to start his route at the airport a and finish it at the airport b.Each airport belongs to one of two companies. The cost of flight from the airport i to the airport j is zero if both airports belong to the same company, and |i\xe2\x80\x89-\xe2\x80\x89j| if they belong to different companies.Print the minimum cost Vladik has to pay to get to the olympiad." 1200.0                                 
               740B "Alyona and flowers" "constructive algorithms" "Little Alyona is celebrating Happy Birthday! Her mother has an array of n flowers. Each flower has some mood, the mood of i-th flower is ai. The mood can be positive, zero or negative.Let\'s define a subarray as a segment of consecutive flowers. The mother suggested some set of subarrays. Alyona wants to choose several of the subarrays suggested by her mother. After that, each of the flowers will add to the girl\'s happiness its mood multiplied by the number of chosen subarrays the flower is in.For example, consider the case when the mother has 5 flowers, and their moods are equal to 1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x894. Suppose the mother suggested subarrays (1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892), (3,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x894), (1,\xe2\x80\x893), (1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893). Then if the girl chooses the third and the fourth subarrays then:   the first flower adds 1\xc2\xb71\xe2\x80\x89=\xe2\x80\x891 to the girl\'s happiness, because he is in one of chosen subarrays,  the second flower adds (\xe2\x80\x89-\xe2\x80\x892)\xc2\xb71\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892, because he is in one of chosen subarrays,  the third flower adds 1\xc2\xb72\xe2\x80\x89=\xe2\x80\x892, because he is in two of chosen subarrays,  the fourth flower adds 3\xc2\xb72\xe2\x80\x89=\xe2\x80\x896, because he is in two of chosen subarrays,  the fifth flower adds (\xe2\x80\x89-\xe2\x80\x894)\xc2\xb70\xe2\x80\x89=\xe2\x80\x890, because he is in no chosen subarrays. Thus, in total 1\xe2\x80\x89+\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x892)\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x896\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89=\xe2\x80\x897 is added to the girl\'s happiness. Alyona wants to choose such subarrays from those suggested by the mother that the value added to her happiness would be as large as possible. Help her do this!Alyona can choose any number of the subarrays, even 0 or all suggested by her mother." 1200.0                                 
               739B "Alyona and a tree" "binary search,data structures,dfs and similar,graphs,trees" "Alyona has a tree with n vertices. The root of the tree is the vertex 1. In each vertex Alyona wrote an positive integer, in the vertex i she wrote ai. Moreover, the girl wrote a positive integer to every edge of the tree (possibly, different integers on different edges).Let\'s define dist(v,\xe2\x80\x89u) as the sum of the integers written on the edges of the simple path from v to u.The vertex v controls the vertex u (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89u) if and only if u is in the subtree of v and dist(v,\xe2\x80\x89u)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89au.Alyona wants to settle in some vertex. In order to do this, she wants to know for each vertex v what is the number of vertices u such that v controls u." 1900.0                                 
               735E "Ostap and Tree" dp,trees "Ostap already settled down in Rio de Janiero suburb and started to grow a tree in his garden. Recall that a tree is a connected undirected acyclic graph. Ostap\'s tree now has n vertices. He wants to paint some vertices of the tree black such that from any vertex u there is at least one black vertex v at distance no more than k. Distance between two vertices of the tree is the minimum possible number of edges of the path between them.As this number of ways to paint the tree can be large, Ostap wants you to compute it modulo 109\xe2\x80\x89+\xe2\x80\x897. Two ways to paint the tree are considered different if there exists a vertex that is painted black in one way and is not painted in the other one." 2500.0                                 
               734C "Anton and Making Potions" "binary search,dp,greedy,two pointers" "Anton is playing a very interesting computer game, but now he is stuck at one of the levels. To pass to the next level he has to prepare n potions.Anton has a special kettle, that can prepare one potions in x seconds. Also, he knows spells of two types that can faster the process of preparing potions.  Spells of this type speed up the preparation time of one potion. There are m spells of this type, the i-th of them costs bi manapoints and changes the preparation time of each potion to ai instead of x.  Spells of this type immediately prepare some number of potions. There are k such spells, the i-th of them costs di manapoints and instantly create ci potions. Anton can use no more than one spell of the first type and no more than one spell of the second type, and the total number of manapoints spent should not exceed s. Consider that all spells are used instantly and right before Anton starts to prepare potions.Anton wants to get to the next level as fast as possible, so he is interested in the minimum number of time he needs to spent in order to prepare at least n potions." 1600.0                                 
               731E "Funny Game" dp,games "Once upon a time Petya and Gena gathered after another programming competition and decided to play some game. As they consider most modern games to be boring, they always try to invent their own games. They have only stickers and markers, but that won\'t stop them.The game they came up with has the following rules. Initially, there are n stickers on the wall arranged in a row. Each sticker has some number written on it. Now they alternate turn, Petya moves first.One move happens as follows. Lets say there are m\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 stickers on the wall. The player, who makes the current move, picks some integer k from 2 to m and takes k leftmost stickers (removes them from the wall). After that he makes the new sticker, puts it to the left end of the row, and writes on it the new integer, equal to the sum of all stickers he took on this move. Game ends when there is only one sticker left on the wall. The score of the player is equal to the sum of integers written on all stickers he took during all his moves. The goal of each player is to maximize the difference between his score and the score of his opponent.Given the integer n and the initial sequence of stickers on the wall, define the result of the game, i.e. the difference between the Petya\'s and Gena\'s score if both players play optimally." 2200.0                                 
               731B "Coupons and Discounts" "constructive algorithms,greedy" "The programming competition season has already started and it\'s time to train for ICPC. Sereja coaches his teams for a number of year and he knows that to get ready for the training session it\'s not enough to prepare only problems and editorial. As the training sessions lasts for several hours, teams become hungry. Thus, Sereja orders a number of pizzas so they can eat right after the end of the competition.Teams plan to train for n times during n consecutive days. During the training session Sereja orders exactly one pizza for each team that is present this day. He already knows that there will be ai teams on the i-th day.There are two types of discounts in Sereja\'s favourite pizzeria. The first discount works if one buys two pizzas at one day, while the second is a coupon that allows to buy one pizza during two consecutive days (two pizzas in total).As Sereja orders really a lot of pizza at this place, he is the golden client and can use the unlimited number of discounts and coupons of any type at any days.Sereja wants to order exactly ai pizzas on the i-th day while using only discounts and coupons. Note, that he will never buy more pizzas than he need for this particular day. Help him determine, whether he can buy the proper amount of pizzas each day if he is allowed to use only coupons and discounts. Note, that it\'s also prohibited to have any active coupons after the end of the day n." 1100.0                                 
               730J Bottles dp "Nick has n bottles of soda left after his birthday. Each bottle is described by two values: remaining amount of soda ai and bottle volume bi (ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi).Nick has decided to pour all remaining soda into minimal number of bottles, moreover he has to do it as soon as possible. Nick spends x seconds to pour x units of soda from one bottle to another.Nick asks you to help him to determine k \xe2\x80\x94 the minimal number of bottles to store all remaining soda and t \xe2\x80\x94 the minimal time to pour soda into k bottles. A bottle can\'t store more soda than its volume. All remaining soda should be saved." 1900.0                                 
               730E "Award Ceremony" greedy,implementation "All-Berland programming contest comes to an end. In total, n teams participated in it. Like in ACM-ICPC, current results stopped refreshing one hour before the contest ends. So at the Award Ceremony, results are partially known. For each team the value ai is given \xe2\x80\x94 the number of points the i-th team has earned before the last hour of the contest. Besides that, the Jury has evaluated all submissions sent during the last hour and knows values di \xe2\x80\x94 the number of points earned by the i-th team during the last hour (these values can be negative, which means that a team can lose points).Before the contest, each team got unique id from 1 to n. According to the contest rules, a team with more points takes a higher place. If two or more teams have equal number of points, the team with lower id will take the higher place. So no two teams can share the same place.The Award Ceremony proceeds in the following way. At the beginning of the ceremony, a large screen shows the results for the time moment ""one hour before the end"", which means that the i-th team has ai points. Then the Jury unfreezes results of the teams one by one in some order. When result of the j-th team is unfrozen, its score changes from aj to aj\xe2\x80\x89+\xe2\x80\x89dj. At this time the table of results is modified and the place of the team can change. The unfreezing of the j-th team is followed by the applause from the audience with duration of |xj\xe2\x80\x89-\xe2\x80\x89yj| seconds, where xj is the place of the j-th team before unfreezing and yj is the place right after the unfreezing. For example, if the team does not change the place, there is no applause from the audience. As you can see, during the Award Ceremony, each team will be unfrozen exactly once.Your task is to find such an order to unfreeze all the teams that the total duration of applause is maximum possible." 2200.0                                 
               729F "Financiers Game" dp "This problem has unusual memory constraint.At evening, Igor and Zhenya the financiers became boring, so they decided to play a game. They prepared n papers with the income of some company for some time periods. Note that the income can be positive, zero or negative.Igor and Zhenya placed the papers in a row and decided to take turns making moves. Igor will take the papers from the left side, Zhenya will take the papers from the right side. Igor goes first and takes 1 or 2 (on his choice) papers from the left. Then, on each turn a player can take k or k\xe2\x80\x89+\xe2\x80\x891 papers from his side if the opponent took exactly k papers in the previous turn. Players can\'t skip moves. The game ends when there are no papers left, or when some of the players can\'t make a move.Your task is to determine the difference between the sum of incomes on the papers Igor took and the sum of incomes on the papers Zhenya took, assuming both players play optimally. Igor wants to maximize the difference, Zhenya wants to minimize it." 2500.0                                 
               727E "Games on a CD" "data structures,hashing,string suffix structures,strings" "Several years ago Tolya had n computer games and at some point of time he decided to burn them to CD. After that he wrote down the names of the games one after another in a circle on the CD in clockwise order. The names were distinct, the length of each name was equal to k. The names didn\'t overlap.Thus, there is a cyclic string of length n\xc2\xb7k written on the CD.Several years have passed and now Tolya can\'t remember which games he burned to his CD. He knows that there were g popular games that days. All of the games he burned were among these g games, and no game was burned more than once.You have to restore any valid list of games Tolya could burn to the CD several years ago." 2300.0                                 
               727C "Guess the Array" "constructive algorithms,interactive,math" "This is an interactive problem. You should use flush operation after each printed line. For example, in C++ you should use fflush(stdout), in Java you should use System.out.flush(), and in Pascal \xe2\x80\x94 flush(output).In this problem you should guess an array a which is unknown for you. The only information you have initially is the length n of the array a.The only allowed action is to ask the sum of two elements by their indices. Formally, you can print two indices i and j (the indices should be distinct). Then your program should read the response: the single integer equals to ai\xe2\x80\x89+\xe2\x80\x89aj.It is easy to prove that it is always possible to guess the array using at most n requests.Write a program that will guess the array a by making at most n requests." 1400.0                                 
               727B "Bill Total Value" "expression parsing,implementation,strings" "Vasily exited from a store and now he wants to recheck the total price of all purchases in his bill. The bill is a string in which the names of the purchases and their prices are printed in a row without any spaces. Check has the format ""name1price1name2price2...namenpricen"", where namei (name of the i-th purchase) is a non-empty string of length not more than 10, consisting of lowercase English letters, and pricei (the price of the i-th purchase) is a non-empty string, consisting of digits and dots (decimal points). It is possible that purchases with equal names have different prices.The price of each purchase is written in the following format. If the price is an integer number of dollars then cents are not written.Otherwise, after the number of dollars a dot (decimal point) is written followed by cents in a two-digit format (if number of cents is between 1 and 9 inclusively, there is a leading zero).Also, every three digits (from less significant to the most) in dollars are separated by dot (decimal point). No extra leading zeroes are allowed. The price always starts with a digit and ends with a digit.For example:  ""234"", ""1.544"", ""149.431.10"", ""0.99"" and ""123.05"" are valid prices,  "".333"", ""3.33.11"", ""12.00"", "".33"", ""0.1234"" and ""1.2"" are not valid. Write a program that will find the total price of all purchases in the given bill." 1600.0                                 
               727A "Transformation: from A to B" "brute force,dfs and similar,math" "Vasily has a number a, which he wants to turn into a number b. For this purpose, he can do two types of operations:  multiply the current number by 2 (that is, replace the number x by 2\xc2\xb7x);  append the digit 1 to the right of current number (that is, replace the number x by 10\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891). You need to help Vasily to transform the number a into the number b using only the operations described above, or find that it is impossible.Note that in this task you are not required to minimize the number of operations. It suffices to find any way to transform a into b." 1000.0                                 
               725A "Jumping Ball" implementation "In a new version of the famous Pinball game, one of the most important parts of the game field is a sequence of n bumpers. The bumpers are numbered with integers from 1 to n from left to right. There are two types of bumpers. They are denoted by the characters \'<\' and \'>\'. When the ball hits the bumper at position i it goes one position to the right (to the position i\xe2\x80\x89+\xe2\x80\x891) if the type of this bumper is \'>\', or one position to the left (to i\xe2\x80\x89-\xe2\x80\x891) if the type of the bumper at position i is \'<\'. If there is no such position, in other words if i\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x891 or i\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89n, the ball falls from the game field.Depending on the ball\'s starting position, the ball may eventually fall from the game field or it may stay there forever. You are given a string representing the bumpers\' types. Calculate the number of positions such that the ball will eventually fall from the game field if it starts at that position." 1000.0                                 
               724G "Xor-matic Number of the Graph" "bitmasks,graphs,math,number theory,trees" "You are given an undirected graph, constisting of n vertices and m edges. Each edge of the graph has some non-negative integer written on it.Let\'s call a triple (u,\xe2\x80\x89v,\xe2\x80\x89s) interesting, if 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and there is a path (possibly non-simple, i.e. it can visit the same vertices and edges multiple times) between vertices u and v such that xor of all numbers written on the edges of this path is equal to s. When we compute the value s for some path, each edge is counted in xor as many times, as it appear on this path. It\'s not hard to prove that there are finite number of such triples.Calculate the sum over modulo 109\xe2\x80\x89+\xe2\x80\x897 of the values of s over all interesting triples." 2600.0                                 
               723A "The New Year: Meeting Friends" implementation,math,sortings "There are three friend living on the straight line Ox in Lineland. The first friend lives at the point x1, the second friend lives at the point x2, and the third friend lives at the point x3. They plan to celebrate the New Year together, so they need to meet at one point. What is the minimum total distance they have to travel in order to meet at some point and celebrate the New Year?It\'s guaranteed that the optimal answer is always integer." 800.0                                 
               722D "Generating Sets" "binary search,data structures,dfs and similar,greedy,strings,trees" "You are given a set Y of n distinct positive integers y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn.Set X of n distinct positive integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn is said to generate set Y if one can transform X to Y by applying some number of the following two operation to integers in X:  Take any integer xi and multiply it by two, i.e. replace xi with 2\xc2\xb7xi.  Take any integer xi, multiply it by two and add one, i.e. replace xi with 2\xc2\xb7xi\xe2\x80\x89+\xe2\x80\x891. Note that integers in X are not required to be distinct after each operation.Two sets of distinct integers X and Y are equal if they are equal as sets. In other words, if we write elements of the sets in the array in the increasing order, these arrays would be equal.Note, that any set of integers (or its permutation) generates itself.You are given a set Y and have to find a set X that generates Y and the maximum element of X is mininum possible." 1900.0                                 
               718E "Matvey\'s Birthday" bitmasks,graphs "Today is Matvey\'s birthday. He never knows what to ask as a present so friends gave him a string s of length n. This string consists of only first eight English letters: \'a\', \'b\', ..., \'h\'.First question that comes to mind is: who might ever need some string? Matvey is a special boy so he instantly found what to do with this string. He used it to build an undirected graph where vertices correspond to position in the string and there is an edge between distinct positions a and b (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) if at least one of the following conditions hold:   a and b are neighbouring, i.e. |a\xe2\x80\x89-\xe2\x80\x89b|\xe2\x80\x89=\xe2\x80\x891.  Positions a and b contain equal characters, i.e. sa\xe2\x80\x89=\xe2\x80\x89sb. Then Matvey decided to find the diameter of this graph. Diameter is a maximum distance (length of the shortest path) among all pairs of vertices. Also, Matvey wants to find the number of pairs of vertices such that the distance between them is equal to the diameter of the graph. As he is very cool and experienced programmer he managed to solve this problem very fast. Will you do the same?" 3300.0                                 
               717C "Potions Homework" implementation,sortings "Harry Water, Ronaldo, Her-my-oh-knee and their friends have started a new school year at their MDCS School of Speechcraft and Misery. At the time, they are very happy to have seen each other after a long time. The sun is shining, birds are singing, flowers are blooming, and their Potions class teacher, professor Snipe is sulky as usual. Due to his angst fueled by disappointment in his own life, he has given them a lot of homework in Potions class. Each of the n students has been assigned a single task. Some students do certain tasks faster than others. Thus, they want to redistribute the tasks so that each student still does exactly one task, and that all tasks are finished. Each student has their own laziness level, and each task has its own difficulty level. Professor Snipe is trying hard to improve their work ethics, so each student\xe2\x80\x99s laziness level is equal to their task\xe2\x80\x99s difficulty level. Both sets of values are given by the sequence a, where ai represents both the laziness level of the i-th student and the difficulty of his task. The time a student needs to finish a task is equal to the product of their laziness level and the task\xe2\x80\x99s difficulty. They are wondering, what is the minimum possible total time they must spend to finish all tasks if they distribute them in the optimal way. Each person should receive one task and each task should be given to one person. Print the answer modulo 10\xe2\x80\x89007." 1200.0                                 
               715E "Complete the Permutations" combinatorics,fft,graphs,math "ZS the Coder is given two permutations p and q of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n}, but some of their elements are replaced with 0. The distance between two permutations p and q is defined as the minimum number of moves required to turn p into q. A move consists of swapping exactly 2 elements of p.ZS the Coder wants to determine the number of ways to replace the zeros with positive integers from the set {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n} such that p and q are permutations of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n} and the distance between p and q is exactly k.ZS the Coder wants to find the answer for all 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891. Can you help him?" 3400.0                                 
               715C "Digit Tree" "dfs and similar,divide and conquer,dsu,trees" "ZS the Coder has a large tree. It can be represented as an undirected connected graph of n vertices numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891 and n\xe2\x80\x89-\xe2\x80\x891 edges between them. There is a single nonzero digit written on each edge.One day, ZS the Coder was bored and decided to investigate some properties of the tree. He chose a positive integer M, which is coprime to 10, i.e. .ZS consider an ordered pair of distinct vertices (u,\xe2\x80\x89v) interesting when if he would follow the shortest path from vertex u to vertex v and write down all the digits he encounters on his path in the same order, he will get a decimal representaion of an integer divisible by M.Formally, ZS consider an ordered pair of distinct vertices (u,\xe2\x80\x89v) interesting if the following states true:  Let a1\xe2\x80\x89=\xe2\x80\x89u,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak\xe2\x80\x89=\xe2\x80\x89v be the sequence of vertices on the shortest path from u to v in the order of encountering them;  Let di (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k) be the digit written on the edge between vertices ai and ai\xe2\x80\x89+\xe2\x80\x891;  The integer  is divisible by M. Help ZS the Coder find the number of interesting pairs!" 2700.0                                 
               713D "Animals and Puzzle" "binary search,data structures" "Owl Sonya gave a huge lake puzzle of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m to hedgehog Filya as a birthday present. Friends immediately started to assemble the puzzle, but some parts of it turned out to be empty \xe2\x80\x94 there was no picture on them. Parts with picture on it are denoted by 1, while empty parts are denoted by 0. Rows of the puzzle are numbered from top to bottom with integers from 1 to n, while columns are numbered from left to right with integers from 1 to m.Animals decided to complete the picture and play with it, as it might be even more fun! Owl and hedgehog ask each other some queries. Each query is provided by four integers x1, y1, x2, y2 which define the rectangle, where (x1,\xe2\x80\x89y1) stands for the coordinates of the up left cell of the rectangle, while (x2,\xe2\x80\x89y2) stands for the coordinates of the bottom right cell. The answer to the query is the size of the maximum square consisting of picture parts only (only parts denoted by 1) and located fully inside the query rectangle.Help Sonya and Filya answer t queries." 2700.0                                 
               712E "Memory and Casinos" "data structures,math,probabilities" "There are n casinos lined in a row. If Memory plays at casino i, he has probability pi to win and move to the casino on the right (i\xe2\x80\x89+\xe2\x80\x891) or exit the row (if i\xe2\x80\x89=\xe2\x80\x89n), and a probability 1\xe2\x80\x89-\xe2\x80\x89pi to lose and move to the casino on the left (i\xe2\x80\x89-\xe2\x80\x891) or also exit the row (if i\xe2\x80\x89=\xe2\x80\x891). We say that Memory dominates on the interval i... j if he completes a walk such that,  He starts on casino i.  He never looses in casino i.  He finishes his walk by winning in casino j. Note that Memory can still walk left of the 1-st casino and right of the casino n and that always finishes the process.Now Memory has some requests, in one of the following forms:  1 i a b: Set .  2 l r: Print the probability that Memory will dominate on the interval l... r, i.e. compute the probability that Memory will first leave the segment l... r after winning at casino r, if she starts in casino l. It is guaranteed that at any moment of time p is a non-decreasing sequence, i.e. pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891 for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891.Please help Memory by answering all his requests!" 2500.0                                 
               708E "Student\'s Camp" dp,math "Alex studied well and won the trip to student camp Alushta, located on the seashore. Unfortunately, it\'s the period of the strong winds now and there is a chance the camp will be destroyed! Camp building can be represented as the rectangle of n\xe2\x80\x89+\xe2\x80\x892 concrete blocks height and m blocks width.Every day there is a breeze blowing from the sea. Each block, except for the blocks of the upper and lower levers, such that there is no block to the left of it is destroyed with the probability . Similarly, each night the breeze blows in the direction to the sea. Thus, each block (again, except for the blocks of the upper and lower levers) such that there is no block to the right of it is destroyed with the same probability p. Note, that blocks of the upper and lower level are indestructible, so there are only n\xc2\xb7m blocks that can be destroyed.The period of the strong winds will last for k days and k nights. If during this period the building will split in at least two connected components, it will collapse and Alex will have to find another place to spend summer.Find the probability that Alex won\'t have to look for other opportunities and will be able to spend the summer in this camp." 3100.0                                 
               706C "Hard problem" dp,strings "Vasiliy is fond of solving different tasks. Today he found one he wasn\'t able to solve himself, so he asks you to help.Vasiliy is given n strings consisting of lowercase English letters. He wants them to be sorted in lexicographical order (as in the dictionary), but he is not allowed to swap any of them. The only operation he is allowed to do is to reverse any of them (first character becomes last, second becomes one before last and so on).To reverse the i-th string Vasiliy has to spent ci units of energy. He is interested in the minimum amount of energy he has to spent in order to have strings sorted in lexicographical order.String A is lexicographically smaller than string B if it is shorter than B (|A|\xe2\x80\x89<\xe2\x80\x89|B|) and is its prefix, or if none of them is a prefix of the other and at the first position where they differ character in A is smaller than the character in B.For the purpose of this problem, two equal strings nearby do not break the condition of sequence being sorted lexicographically." 1600.0                                 
               704C "Black Widow" dp,graphs,implementation,math "Natalia Romanova is trying to test something on the new gun S.H.I.E.L.D gave her. In order to determine the result of the test, she needs to find the number of answers to a certain equation. The equation is of form:Where  represents logical OR and  represents logical exclusive OR (XOR), and vi,\xe2\x80\x89j are some boolean variables or their negations. Natalia calls the left side of the equation a XNF formula. Each statement in brackets is called a clause, and vi,\xe2\x80\x89j are called literals.In the equation Natalia has, the left side is actually a 2-XNF-2 containing variables x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xm and their negations. An XNF formula is 2-XNF-2 if:  For each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, ki\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892, i.e. the size of each clause doesn\'t exceed two.  Each variable occurs in the formula at most two times (with negation and without negation in total). Please note that it\'s possible that a variable occurs twice but its negation doesn\'t occur in any clause (or vice versa). Natalia is given a formula of m variables, consisting of n clauses. Please, make sure to check the samples in order to properly understand how the formula looks like.Natalia is more into fight than theory, so she asked you to tell her the number of answers to this equation. More precisely, you need to find the number of ways to set x1,\xe2\x80\x89...,\xe2\x80\x89xm with true and false (out of total of 2m ways) so that the equation is satisfied. Since this number can be extremely large, you need to print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Please, note that some variable may appear twice in one clause, or not appear in the equation at all (but still, setting it to false or true gives different ways to set variables)." 2900.0                                 
               704A Thor "brute force,data structures,implementation" "Thor is getting used to the Earth. As a gift Loki gave him a smartphone. There are n applications on this phone. Thor is fascinated by this phone. He has only one minor issue: he can\'t count the number of unread notifications generated by those applications (maybe Loki put a curse on it so he can\'t).q events are about to happen (in chronological order). They are of three types:  Application x generates a notification (this new notification is unread).  Thor reads all notifications generated so far by application x (he may re-read some notifications).  Thor reads the first t notifications generated by phone applications (notifications generated in first t events of the first type). It\'s guaranteed that there were at least t events of the first type before this event. Please note that he doesn\'t read first t unread notifications, he just reads the very first t notifications generated on his phone and he may re-read some of them in this operation. Please help Thor and tell him the number of unread notifications after each event. You may assume that initially there are no notifications in the phone." 1600.0                                 
               703B "Mishka and trip" implementation,math "Little Mishka is a great traveller and she visited many countries. After thinking about where to travel this time, she chose XXX \xe2\x80\x94 beautiful, but little-known northern country.Here are some interesting facts about XXX:  XXX consists of n cities, k of whose (just imagine!) are capital cities.  All of cities in the country are beautiful, but each is beautiful in its own way. Beauty value of i-th city equals to ci.  All the cities are consecutively connected by the roads, including 1-st and n-th city, forming a cyclic route 1\xe2\x80\x89\xe2\x80\x94\xe2\x80\x892\xe2\x80\x89\xe2\x80\x94\xe2\x80\x89...\xe2\x80\x89\xe2\x80\x94\xe2\x80\x89n\xe2\x80\x89\xe2\x80\x94\xe2\x80\x891. Formally, for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n there is a road between i-th and i\xe2\x80\x89+\xe2\x80\x891-th city, and another one between 1-st and n-th city.  Each capital city is connected with each other city directly by the roads. Formally, if city x is a capital city, then for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x, there is a road between cities x and i.  There is at most one road between any two cities.  Price of passing a road directly depends on beauty values of cities it connects. Thus if there is a road between cities i and j, price of passing it equals ci\xc2\xb7cj.Mishka started to gather her things for a trip, but didn\'t still decide which route to follow and thus she asked you to help her determine summary price of passing each of the roads in XXX. Formally, for every pair of cities a and b (a\xe2\x80\x89<\xe2\x80\x89b), such that there is a road between a and b you are to find sum of products ca\xc2\xb7cb. Will you help her?" 1400.0                                 
               702F T-Shirts "data structures" "The big consignment of t-shirts goes on sale in the shop before the beginning of the spring. In all n types of t-shirts go on sale. The t-shirt of the i-th type has two integer parameters \xe2\x80\x94 ci and qi, where ci \xe2\x80\x94 is the price of the i-th type t-shirt, qi \xe2\x80\x94 is the quality of the i-th type t-shirt. It should be assumed that the unlimited number of t-shirts of each type goes on sale in the shop, but in general the quality is not concerned with the price. As predicted, k customers will come to the shop within the next month, the j-th customer will get ready to spend up to bj on buying t-shirts. All customers have the same strategy. First of all, the customer wants to buy the maximum possible number of the highest quality t-shirts, then to buy the maximum possible number of the highest quality t-shirts from residuary t-shirts and so on. At the same time among several same quality t-shirts the customer will buy one that is cheaper. The customers don\'t like the same t-shirts, so each customer will not buy more than one t-shirt of one type. Determine the number of t-shirts which each customer will buy, if they use the described strategy. All customers act independently from each other, and the purchase of one does not affect the purchase of another." 2800.0                                 
               702B "Powers of Two" "brute force,data structures,implementation,math" "You are given n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Find the number of pairs of indexes i,\xe2\x80\x89j (i\xe2\x80\x89<\xe2\x80\x89j) that ai\xe2\x80\x89+\xe2\x80\x89aj is a power of 2 (i. e. some integer x exists so that ai\xe2\x80\x89+\xe2\x80\x89aj\xe2\x80\x89=\xe2\x80\x892x)." 1500.0                                 
               698C LRU bitmasks,dp,math,probabilities "While creating high loaded systems one should pay a special attention to caching. This problem will be about one of the most popular caching algorithms called LRU (Least Recently Used).Suppose the cache may store no more than k objects. At the beginning of the workflow the cache is empty. When some object is queried we check if it is present in the cache and move it here if it\'s not. If there are more than k objects in the cache after this, the least recently used one should be removed. In other words, we remove the object that has the smallest time of the last query.Consider there are n videos being stored on the server, all of the same size. Cache can store no more than k videos and caching algorithm described above is applied. We know that any time a user enters the server he pick the video i with probability pi. The choice of the video is independent to any events before.The goal of this problem is to count for each of the videos the probability it will be present in the cache after 10100 queries." 2400.0                                 
               698A Vacations dp "Vasya has n days of vacations! So he decided to improve his IT skills and do sport. Vasya knows the following information about each of this n days: whether that gym opened and whether a contest was carried out in the Internet on that day. For the i-th day there are four options:  on this day the gym is closed and the contest is not carried out;  on this day the gym is closed and the contest is carried out;  on this day the gym is open and the contest is not carried out;  on this day the gym is open and the contest is carried out. On each of days Vasya can either have a rest or write the contest (if it is carried out on this day), or do sport (if the gym is open on this day).Find the minimum number of days on which Vasya will have a rest (it means, he will not do sport and write the contest at the same time). The only limitation that Vasya has \xe2\x80\x94 he does not want to do the same activity on two consecutive days: it means, he will not do sport on two consecutive days, and write the contest on two consecutive days." 1400.0                                 
                    687D "Dividing Kingdom II" "brute force,data structures,dsu,graphs,sortings" "Long time ago, there was a great kingdom and it was being ruled by The Great Arya and Pari The Great. These two had some problems about the numbers they like, so they decided to divide the great kingdom between themselves.The great kingdom consisted of n cities numbered from 1 to n and m bidirectional roads between these cities, numbered from 1 to m. The i-th road had length equal to wi. The Great Arya and Pari The Great were discussing about destructing some prefix (all road with numbers less than some x) and suffix (all roads with numbers greater than some x) of the roads so there will remain only the roads with numbers l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x891 and r.After that they will divide the great kingdom into two pieces (with each city belonging to exactly one piece) such that the hardness of the division is minimized. The hardness of a division is the maximum length of a road such that its both endpoints are in the same piece of the kingdom. In case there is no such road, the hardness of the division is considered to be equal to \xe2\x80\x89-\xe2\x80\x891.Historians found the map of the great kingdom, and they have q guesses about the l and r chosen by those great rulers. Given these data, for each guess li and ri print the minimum possible hardness of the division of the kingdom." 2500.0                            
                    686A "Free Ice Cream" "constructive algorithms,implementation" "After their adventure with the magic mirror Kay and Gerda have returned home and sometimes give free ice cream to kids in the summer.At the start of the day they have x ice cream packs. Since the ice cream is free, people start standing in the queue before Kay and Gerda\'s house even in the night. Each person in the queue wants either to take several ice cream packs for himself and his friends or to give several ice cream packs to Kay and Gerda (carriers that bring ice cream have to stand in the same queue).If a carrier with d ice cream packs comes to the house, then Kay and Gerda take all his packs. If a child who wants to take d ice cream packs comes to the house, then Kay and Gerda will give him d packs if they have enough ice cream, otherwise the child will get no ice cream at all and will leave in distress.Kay wants to find the amount of ice cream they will have after all people will leave from the queue, and Gerda wants to find the number of distressed kids." 800.0                            
                    685D "Kay and Eternity" "brute force,implementation,sortings" "Snow Queen told Kay to form a word ""eternity"" using pieces of ice. Kay is eager to deal with the task, because he will then become free, and Snow Queen will give him all the world and a pair of skates.Behind the palace of the Snow Queen there is an infinite field consisting of cells. There are n pieces of ice spread over the field, each piece occupying exactly one cell and no two pieces occupying the same cell. To estimate the difficulty of the task Kay looks at some squares of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k cells, with corners located at the corners of the cells and sides parallel to coordinate axis and counts the number of pieces of the ice inside them.This method gives an estimation of the difficulty of some part of the field. However, Kay also wants to estimate the total difficulty, so he came up with the following criteria: for each x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) he wants to count the number of squares of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k, such that there are exactly x pieces of the ice inside.Please, help Kay estimate the difficulty of the task given by the Snow Queen." 2600.0                            
                    683C "Symmetric Difference" "*special problem" "You are given two sets of numbers. Your task is to print all numbers from the sets, that both sets don\'t contain simultaneously." 1600.0                            
                    680A "Bear and Five Cards" "constructive algorithms,implementation" "A little bear Limak plays a game. He has five cards. There is one number written on each card. Each number is a positive integer.Limak can discard (throw out) some cards. His goal is to minimize the sum of numbers written on remaining (not discarded) cards.He is allowed to at most once discard two or three cards with the same number. Of course, he won\'t discard cards if it\'s impossible to choose two or three cards with the same number.Given five numbers written on cards, cay you find the minimum sum of numbers on remaining cards?" 800.0                            
                    678F "Lena and Queries" "data structures,divide and conquer,geometry" "Lena is a programmer. She got a task to solve at work.There is an empty set of pairs of integers and n queries to process. Each query is one of three types:  Add a pair (a,\xe2\x80\x89b) to the set.  Remove a pair added in the query number i. All queries are numbered with integers from 1 to n.  For a given integer q find the maximal value x\xc2\xb7q\xe2\x80\x89+\xe2\x80\x89y over all pairs (x,\xe2\x80\x89y) from the set. Help Lena to process the queries." 2500.0                            
                    675B "Restoring Painting" "brute force,constructive algorithms,math" "Vasya works as a watchman in the gallery. Unfortunately, one of the most expensive paintings was stolen while he was on duty. He doesn\'t want to be fired, so he has to quickly restore the painting. He remembers some facts about it.  The painting is a square 3\xe2\x80\x89\xc3\x97\xe2\x80\x893, each cell contains a single integer from 1 to n, and different cells may contain either different or equal integers.  The sum of integers in each of four squares 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 is equal to the sum of integers in the top left square 2\xe2\x80\x89\xc3\x97\xe2\x80\x892.  Four elements a, b, c and d are known and are located as shown on the picture below. Help Vasya find out the number of distinct squares the satisfy all the conditions above. Note, that this number may be equal to 0, meaning Vasya remembers something wrong.Two squares are considered to be different, if there exists a cell that contains two different integers in different squares." 1400.0                            
                    666C Codeword combinatorics,strings "The famous sculptor Cicasso is a Reberlandian spy!These is breaking news in Berlandian papers today. And now the sculptor is hiding. This time you give the shelter to the maestro. You have a protected bunker and you provide it to your friend. You set the security system in such way that only you can open the bunker. To open it one should solve the problem which is hard for others but is simple for you.Every day the bunker generates a codeword s. Every time someone wants to enter the bunker, integer n appears on the screen. As the answer one should enter another integer \xe2\x80\x94 the residue modulo 109\xe2\x80\x89+\xe2\x80\x897 of the number of strings of length n that consist only of lowercase English letters and contain the string s as the subsequence.The subsequence of string a is a string b that can be derived from the string a by removing some symbols from it (maybe none or all of them). In particular any string is the subsequence of itself. For example, the string ""cfo"" is the subsequence of the string ""codeforces"".You haven\'t implemented the algorithm that calculates the correct answers yet and you should do that ASAP." 2500.0                            
                    666A "Reberland Linguistics" dp,implementation,strings "First-rate specialists graduate from Berland State Institute of Peace and Friendship. You are one of the most talented students in this university. The education is not easy because you need to have fundamental knowledge in different areas, which sometimes are not related to each other. For example, you should know linguistics very well. You learn a structure of Reberland language as foreign language. In this language words are constructed according to the following rules. First you need to choose the ""root"" of the word \xe2\x80\x94 some string which has more than 4 letters. Then several strings with the length 2 or 3 symbols are appended to this word. The only restriction \xe2\x80\x94  it is not allowed to append the same string twice in a row. All these strings are considered to be suffixes of the word (this time we use word ""suffix"" to describe a morpheme but not the few last characters of the string as you may used to). Here is one exercise that you have found in your task list. You are given the word s. Find all distinct strings with the length 2 or 3, which can be suffixes of this word according to the word constructing rules in Reberland language. Two strings are considered distinct if they have different length or there is a position in which corresponding characters do not match. Let\'s look at the example: the word abacabaca is given. This word can be obtained in the following ways: , where the root of the word is overlined, and suffixes are marked by ""corners"". Thus, the set of possible suffixes for this word is {aca,\xe2\x80\x89ba,\xe2\x80\x89ca}." 1800.0                            
                    665A "Buses Between Cities" implementation "Buses run between the cities A and B, the first one is at 05:00 AM and the last one departs not later than at 11:59 PM. A bus from the city A departs every a minutes and arrives to the city B in a ta minutes, and a bus from the city B departs every b minutes and arrives to the city A in a tb minutes.The driver Simion wants to make his job diverse, so he counts the buses going towards him. Simion doesn\'t count the buses he meet at the start and finish.You know the time when Simion departed from the city A to the city B. Calculate the number of buses Simion will meet to be sure in his counting." 1600.0                            
                    662D "International Olympiad" "constructive algorithms,greedy,implementation,math" "International Abbreviation Olympiad takes place annually starting from 1989. Each year the competition receives an abbreviation of form IAO\'y, where y stands for some number of consequent last digits of the current year. Organizers always pick an abbreviation with non-empty string y that has never been used before. Among all such valid abbreviations they choose the shortest one and announce it to be the abbreviation of this year\'s competition.For example, the first three Olympiads (years 1989, 1990 and 1991, respectively) received the abbreviations IAO\'9, IAO\'0 and IAO\'1, while the competition in 2015 received an abbreviation IAO\'15, as IAO\'5 has been already used in 1995.You are given a list of abbreviations. For each of them determine the year it stands for." 2000.0                            
                    660C "Hard Process" "binary search,dp,two pointers" "You are given an array a with n elements. Each element of a is either 0 or 1.Let\'s denote the length of the longest subsegment of consecutive elements in a, consisting of only numbers one, as f(a). You can change no more than k zeroes to ones to maximize f(a)." 1600.0                            
                    659C "Tanya and Toys" greedy,implementation "In Berland recently a new collection of toys went on sale. This collection consists of 109 types of toys, numbered with integers from 1 to 109. A toy from the new collection of the i-th type costs i bourles.Tania has managed to collect n different types of toys a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an from the new collection. Today is Tanya\'s birthday, and her mother decided to spend no more than m bourles on the gift to the daughter. Tanya will choose several different types of toys from the new collection as a gift. Of course, she does not want to get a type of toy which she already has.Tanya wants to have as many distinct types of toys in her collection as possible as the result. The new collection is too diverse, and Tanya is too little, so she asks you to help her in this." 1200.0                            
                    653B "Bear and Compressing" "brute force,dfs and similar,dp,strings" "Limak is a little polar bear. Polar bears hate long strings and thus they like to compress them. You should also know that Limak is so young that he knows only first six letters of the English alphabet: \'a\', \'b\', \'c\', \'d\', \'e\' and \'f\'.You are given a set of q possible operations. Limak can perform them in any order, any operation may be applied any number of times. The i-th operation is described by a string ai of length two and a string bi of length one. No two of q possible operations have the same string ai.When Limak has a string s he can perform the i-th operation on s if the first two letters of s match a two-letter string ai. Performing the i-th operation removes first two letters of s and inserts there a string bi. See the notes section for further clarification.You may note that performing an operation decreases the length of a string s exactly by 1. Also, for some sets of operations there may be a string that cannot be compressed any further, because the first two letters don\'t match any ai.Limak wants to start with a string of length n and perform n\xe2\x80\x89-\xe2\x80\x891 operations to finally get a one-letter string ""a"". In how many ways can he choose the starting string to be able to get ""a""? Remember that Limak can use only letters he knows." 1300.0                            
                    652F "Ants on a Circle" "constructive algorithms,math" "n ants are on a circle of length m. An ant travels one unit of distance per one unit of time. Initially, the ant number i is located at the position si and is facing in the direction di (which is either L or R). Positions are numbered in counterclockwise order starting from some point. Positions of the all ants are distinct.All the ants move simultaneously, and whenever two ants touch, they will both switch their directions. Note that it is possible for an ant to move in some direction for a half of a unit of time and in opposite direction for another half of a unit of time.Print the positions of the ants after t time units." 2800.0                            
                    652D "Nested Segments" "data structures,sortings" "You are given n segments on a line. There are no ends of some segments that coincide. For each segment find the number of segments it contains." 1800.0                            
                    652C "Foe Pairs" "combinatorics,sortings,two pointers" "You are given a permutation p of length n. Also you are given m foe pairs (ai,\xe2\x80\x89bi) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai,\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi). Your task is to count the number of different intervals (x,\xe2\x80\x89y) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) that do not contain any foe pairs. So you shouldn\'t count intervals (x,\xe2\x80\x89y) that contain at least one foe pair in it (the positions and order of the values from the foe pair are not important).Consider some example: p\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x894] and foe pairs are {(3,\xe2\x80\x892),\xe2\x80\x89(4,\xe2\x80\x892)}. The interval (1,\xe2\x80\x893) is incorrect because it contains a foe pair (3,\xe2\x80\x892). The interval (1,\xe2\x80\x894) is also incorrect because it contains two foe pairs (3,\xe2\x80\x892) and (4,\xe2\x80\x892). But the interval (1,\xe2\x80\x892) is correct because it doesn\'t contain any foe pair." 1800.0                            
                    650C "Table Compression" "dfs and similar,dp,dsu,graphs,greedy" "Little Petya is now fond of data compression algorithms. He has already studied gz, bz, zip algorithms and many others. Inspired by the new knowledge, Petya is now developing the new compression algorithm which he wants to name dis.Petya decided to compress tables. He is given a table a consisting of n rows and m columns that is filled with positive integers. He wants to build the table a\' consisting of positive integers such that the relative order of the elements in each row and each column remains the same. That is, if in some row i of the initial table ai,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89ai,\xe2\x80\x89k, then in the resulting table a\'i,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89a\'i,\xe2\x80\x89k, and if ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89ai,\xe2\x80\x89k then a\'i,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89a\'i,\xe2\x80\x89k. Similarly, if in some column j of the initial table ai,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89ap,\xe2\x80\x89j then in compressed table a\'i,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89a\'p,\xe2\x80\x89j and if ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89ap,\xe2\x80\x89j then a\'i,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89a\'p,\xe2\x80\x89j. Because large values require more space to store them, the maximum value in a\' should be as small as possible.Petya is good in theory, however, he needs your help to implement the algorithm." 2200.0                            
                    650B "Image Preview" "binary search,brute force,dp,two pointers" "Vasya\'s telephone contains n photos. Photo number 1 is currently opened on the phone. It is allowed to move left and right to the adjacent photo by swiping finger over the screen. If you swipe left from the first photo, you reach photo n. Similarly, by swiping right from the last photo you reach photo 1. It takes a seconds to swipe from photo to adjacent.For each photo it is known which orientation is intended for it \xe2\x80\x94 horizontal or vertical. Phone is in the vertical orientation and can\'t be rotated. It takes b second to change orientation of the photo.Vasya has T seconds to watch photos. He want to watch as many photos as possible. If Vasya opens the photo for the first time, he spends 1 second to notice all details in it. If photo is in the wrong orientation, he spends b seconds on rotating it before watching it. If Vasya has already opened the photo, he just skips it (so he doesn\'t spend any time for watching it or for changing its orientation). It is not allowed to skip unseen photos.Help Vasya find the maximum number of photos he is able to watch during T seconds." 1900.0                            
                    649C "\xd0\x9f\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd1\x8c \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb9" "constructive algorithms,greedy,sortings" "\xd0\x9d\xd0\xb0 \xd1\x82\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 \xd0\xbf\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xb3\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb5 \xd0\xba \xd1\x81\xd0\xbe\xd1\x80\xd0\xb5\xd0\xb2\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f\xd0\xbc \xd0\xbf\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8e \xd0\xbf\xd1\x80\xd0\xb8\xd1\x88\xd0\xbb\xd0\xb8 n \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4. \xd0\xa2\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4\xd1\x8b \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xbb \xd1\x82\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83, \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xbb\xd0\xb5\xd0\xba\xd1\x82 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87 \xd0\xb4\xd0\xbb\xd1\x8f i-\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4\xd1\x8b \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xb5\xd1\x82 ai \xd1\x81\xd1\x82\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x86. \xd0\x92 \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c x \xd0\xbb\xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2 \xd0\xb1\xd1\x83\xd0\xbc\xd0\xb0\xd0\xb3\xd0\xb8, \xd1\x83 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd0\xbe\xd0\xb1\xd0\xb5 \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd1\x8b \xd1\x87\xd0\xb8\xd1\x81\xd1\x82\xd1\x8b\xd0\xb5, \xd0\xb8 y \xd0\xbb\xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2, \xd1\x83 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd0\xb0 \xd1\x87\xd0\xb8\xd1\x81\xd1\x82\xd0\xb0\xd1\x8f. \xd0\x9f\xd1\x80\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd0\xb8 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xbb\xd0\xb8\xd1\x81\xd1\x82\xd0\xb5 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x82\xd0\xb8\xd0\xbf\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb4\xd0\xb2\xd0\xb5 \xd1\x81\xd1\x82\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x86\xd1\x8b \xd0\xb8\xd0\xb7 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb9 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87, \xd0\xb0 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd0\xb8 \xd0\xbd\xd0\xb0 \xd0\xbb\xd0\xb8\xd1\x81\xd1\x82\xd0\xb5 \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x82\xd0\xb8\xd0\xbf\xd0\xb0 \xe2\x80\x94 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83. \xd0\x9a\xd0\xbe\xd0\xbd\xd0\xb5\xd1\x87\xd0\xbd\xd0\xbe, \xd0\xbd\xd0\xb0 \xd0\xbb\xd0\xb8\xd1\x81\xd1\x82\xd0\xb5 \xd0\xbd\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x8f \xd0\xbf\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x8f \xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xbb\xd0\xb5\xd0\xba\xd1\x82\xd0\xbe\xd0\xb2 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87. \xd0\x9e\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xbb\xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2, \xd1\x83 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd0\xbe\xd0\xb1\xd0\xb5 \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd1\x8b \xd1\x87\xd0\xb8\xd1\x81\xd1\x82\xd1\x8b\xd0\xb5, \xd0\xbd\xd0\xb5 \xd0\xbe\xd0\xb1\xd1\x8f\xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xb1\xd0\xb5\xd0\xb8\xd1\x85 \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd0\xb0\xd1\x85, \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd1\x87\xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd0\xb9.\xd0\x92\xd0\xb0\xd0\xbc \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82 \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbc\xd0\xb0\xd0\xba\xd1\x81\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xbc \xd1\x82\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80 \xd1\x81\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xbb\xd0\xb5\xd0\xba\xd1\x82\xd1\x8b \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87 \xd1\x86\xd0\xb5\xd0\xbb\xd0\xb8\xd0\xba\xd0\xbe\xd0\xbc." 1500.0                            
                    648E "\xd0\xa1\xd0\xbe\xd0\xb1\xd0\xb5\xd1\x80\xd0\xb8 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe" "graphs,shortest paths" "\xd0\x94\xd0\xb0\xd0\xbd\xd0\xbe \xd1\x86\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xb5 \xd0\xbd\xd0\xb5\xd0\xbe\xd1\x82\xd1\x80\xd0\xb8\xd1\x86\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe k \xd0\xb8 n \xd0\xbd\xd0\xb5\xd0\xbe\xd1\x82\xd1\x80\xd0\xb8\xd1\x86\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. \xd0\x97\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x8f \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb8\xd0\xb7 \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3 \xd0\xb7\xd0\xb0 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd0\xb7\xd0\xb2\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5 \xd0\xb8, \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe, \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd1\x8f \xd0\xba\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5-\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xbd\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7 (\xd0\xb0 \xd0\xba\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5-\xd1\x82\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5 \xd0\xbd\xd0\xb5 \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd1\x8f), \xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd1\x80\xd0\xb0\xd1\x82\xd1\x87\xd0\xb0\xd0\xb9\xd1\x88\xd0\xb5\xd0\xb5 (\xd0\xbd\xd0\xb0\xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb5\xd0\xb5 \xd0\xbf\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd1\x83 \xd1\x86\xd0\xb8\xd1\x84\xd1\x80) \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe, \xd0\xb4\xd0\xb5\xd0\xbb\xd1\x8f\xd1\x89\xd0\xb5\xd0\xb5\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 k, \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd1\x8d\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe." 2300.0                            
                    645D "Robot Rapping Results Report" "binary search,dp,graphs" "While Farmer John rebuilds his farm in an unfamiliar portion of Bovinia, Bessie is out trying some alternative jobs. In her new gig as a reporter, Bessie needs to know about programming competition results as quickly as possible. When she covers the 2016 Robot Rap Battle Tournament, she notices that all of the robots operate under deterministic algorithms. In particular, robot i will beat robot j if and only if robot i has a higher skill level than robot j. And if robot i beats robot j and robot j beats robot k, then robot i will beat robot k. Since rapping is such a subtle art, two robots can never have the same skill level.Given the results of the rap battles in the order in which they were played, determine the minimum number of first rap battles that needed to take place before Bessie could order all of the robots by skill level." 1800.0                            
                    639B "Bear and Forgotten Tree 3" "constructive algorithms,graphs,trees" "A tree is a connected undirected graph consisting of n vertices and n\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89\xe2\x80\x891 edges. Vertices are numbered 1 through n.Limak is a little polar bear and Radewoosh is his evil enemy. Limak once had a tree but Radewoosh stolen it. Bear is very sad now because he doesn\'t remember much about the tree \xe2\x80\x94 he can tell you only three values n, d and h:  The tree had exactly n vertices.  The tree had diameter d. In other words, d was the biggest distance between two vertices.  Limak also remembers that he once rooted the tree in vertex 1 and after that its height was h. In other words, h was the biggest distance between vertex 1 and some other vertex. The distance between two vertices of the tree is the number of edges on the simple path between them.Help Limak to restore his tree. Check whether there exists a tree satisfying the given conditions. Find any such tree and print its edges in any order. It\'s also possible that Limak made a mistake and there is no suitable tree \xe2\x80\x93 in this case print ""-1""." 1600.0                            
                    637B "Chat Order" "*special problem,binary search,constructive algorithms,data structures,sortings" "Polycarp is a big lover of killing time in social networks. A page with a chatlist in his favourite network is made so that when a message is sent to some friend, his friend\'s chat rises to the very top of the page. The relative order of the other chats doesn\'t change. If there was no chat with this friend before, then a new chat is simply inserted to the top of the list.Assuming that the chat list is initially empty, given the sequence of Polycaprus\' messages make a list of chats after all of his messages are processed. Assume that no friend wrote any message to Polycarpus." 1200.0                            
                    633A "Ebony and Ivory" "brute force,math,number theory" "Dante is engaged in a fight with ""The Savior"". Before he can fight it with his sword, he needs to break its shields. He has two guns, Ebony and Ivory, each of them is able to perform any non-negative number of shots.For every bullet that hits the shield, Ebony deals a units of damage while Ivory deals b units of damage. In order to break the shield Dante has to deal exactly c units of damage. Find out if this is possible." 1100.0                            
                    632A "Grandma Laura and Apples"  "Grandma Laura came to the market to sell some apples. During the day she sold all the apples she had. But grandma is old, so she forgot how many apples she had brought to the market.She precisely remembers she had n buyers and each of them bought exactly half of the apples she had at the moment of the purchase and also she gave a half of an apple to some of them as a gift (if the number of apples at the moment of purchase was odd), until she sold all the apples she had.So each buyer took some integral positive number of apples, but maybe he didn\'t pay for a half of an apple (if the number of apples at the moment of the purchase was odd).For each buyer grandma remembers if she gave a half of an apple as a gift or not. The cost of an apple is p (the number p is even).Print the total money grandma should have at the end of the day to check if some buyers cheated her." 1200.0                            
                    629D "Babaei and Birthday Cake" "data structures,dp" "As you know, every birthday party has a cake! This time, Babaei is going to prepare the very special birthday party\'s cake.Simple cake is a cylinder of some radius and height. The volume of the simple cake is equal to the volume of corresponding cylinder. Babaei has n simple cakes and he is going to make a special cake placing some cylinders on each other.However, there are some additional culinary restrictions. The cakes are numbered in such a way that the cake number i can be placed only on the table or on some cake number j where j\xe2\x80\x89<\xe2\x80\x89i. Moreover, in order to impress friends Babaei will put the cake i on top of the cake j only if the volume of the cake i is strictly greater than the volume of the cake j.Babaei wants to prepare a birthday cake that has a maximum possible total volume. Help him find this value." 2000.0                            
                    629B "Far Relative\xe2\x80\x99s Problem" "brute force" "Famil Door wants to celebrate his birthday with his friends from Far Far Away. He has n friends and each of them can come to the party in a specific range of days of the year from ai to bi. Of course, Famil Door wants to have as many friends celebrating together with him as possible.Far cars are as weird as Far Far Away citizens, so they can only carry two people of opposite gender, that is exactly one male and one female. However, Far is so far from here that no other transportation may be used to get to the party.Famil Door should select some day of the year and invite some of his friends, such that they all are available at this moment and the number of male friends invited is equal to the number of female friends invited. Find the maximum number of friends that may present at the party." 1100.0                            
                    627F "Island Puzzle" "dfs and similar,dsu,graphs,trees" "A remote island chain contains n islands, with some bidirectional bridges between them. The current bridge network forms a tree. In other words, a total of n\xe2\x80\x89-\xe2\x80\x891 bridges connect pairs of islands in a way that it\'s possible to reach any island from any other island using the bridge network. The center of each island contains an identical pedestal, and all but one of the islands has a fragile, uniquely colored statue currently held on the pedestal. The remaining island holds only an empty pedestal.The islanders want to rearrange the statues in a new order. To do this, they repeat the following process: first, they choose an island directly adjacent to the island containing an empty pedestal. Then, they painstakingly carry the statue on this island across the adjoining bridge and place it on the empty pedestal.It is often impossible to rearrange statues in the desired order using only the operation described above. The islanders would like to build one additional bridge in order to make this achievable in the fewest number of movements possible. Find the bridge to construct and the minimum number of statue movements necessary to arrange the statues in the desired position." 3400.0                            
                    626G Raffles "data structures,dp,greedy,math" "Johnny is at a carnival which has n raffles. Raffle i has a prize with value pi. Each participant can put tickets in whichever raffles they choose (they may have more than one ticket in a single raffle). At the end of the carnival, one ticket is selected at random from each raffle, and the owner of the ticket wins the associated prize. A single person can win multiple prizes from different raffles. However, county rules prevent any one participant from owning more than half the tickets in a single raffle, i.e. putting more tickets in the raffle than all the other participants combined. To help combat this (and possibly win some prizes), the organizers started by placing a single ticket in each raffle, which they will never remove.Johnny bought t tickets and is wondering where to place them. Currently, there are a total of li tickets in the i-th raffle. He watches as other participants place tickets and modify their decisions and, at every moment in time, wants to know how much he can possibly earn. Find the maximum possible expected value of Johnny\'s winnings at each moment if he distributes his tickets optimally. Johnny may redistribute all of his tickets arbitrarily between each update, but he may not place more than t tickets total or have more tickets in a single raffle than all other participants combined." 3100.0                            
                    623B "Array GCD" "dp,greedy,number theory" "You are given array ai of length n. You may consecutively apply two operations to this array:  remove some subsegment (continuous subsequence) of length m\xe2\x80\x89<\xe2\x80\x89n and pay for it m\xc2\xb7a coins;  change some elements of the array by at most 1, and pay b coins for each change. Please note that each of operations may be applied at most once (and may be not applied at all) so you can remove only one segment and each number may be changed (increased or decreased) by at most 1. Also note, that you are not allowed to delete the whole array.Your goal is to calculate the minimum number of coins that you need to spend in order to make the greatest common divisor of the elements of the resulting array be greater than 1." 2300.0                            
                    622C "Not Equal on a Segment" "data structures,implementation" "You are given array a with n integers and m queries. The i-th query is given with three integers li,\xe2\x80\x89ri,\xe2\x80\x89xi.For the i-th query find any position pi (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri) so that api\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89xi." 1700.0                            
                    618A "Slime Combining" implementation "Your friend recently gave you some slimes for your birthday. You have n slimes all initially with value 1.You are going to play a game with these slimes. Initially, you put a single slime by itself in a row. Then, you will add the other n\xe2\x80\x89-\xe2\x80\x891 slimes one by one. When you add a slime, you place it at the right of all already placed slimes. Then, while the last two slimes in the row have the same value v, you combine them together to create a slime with value v\xe2\x80\x89+\xe2\x80\x891.You would like to see what the final state of the row is after you\'ve added all n slimes. Please print the values of the slimes in the row from left to right." 800.0                            
                    614A "Link/Cut Tree" "brute force,implementation" "Programmer Rostislav got seriously interested in the Link/Cut Tree data structure, which is based on Splay trees. Specifically, he is now studying the expose procedure.Unfortunately, Rostislav is unable to understand the definition of this procedure, so he decided to ask programmer Serezha to help him. Serezha agreed to help if Rostislav solves a simple task (and if he doesn\'t, then why would he need Splay trees anyway?)Given integers l, r and k, you need to print all powers of number k within range from l to r inclusive. However, Rostislav doesn\'t want to spent time doing this, as he got interested in playing a network game called Agar with Gleb. Help him!" 1500.0                            
                    611H "New Year  and Forgotten Tree" "constructive algorithms,flows,graphs" "A tree is a connected undirected graph with n\xe2\x80\x89-\xe2\x80\x891 edges, where n denotes the number of vertices. Vertices are numbered 1 through n.Limak is a little polar bear. His bear family prepares a New Year tree every year. One year ago their tree was more awesome than usually. Thus, they decided to prepare the same tree in the next year. Limak was responsible for remembering that tree.It would be hard to remember a whole tree. Limak decided to describe it in his notebook instead. He took a pen and wrote n\xe2\x80\x89-\xe2\x80\x891 lines, each with two integers \xe2\x80\x94 indices of two vertices connected by an edge.Now, the New Year is just around the corner and Limak is asked to reconstruct that tree. Of course, there is a problem. He was a very little bear a year ago, and he didn\'t know digits and the alphabet, so he just replaced each digit with a question mark \xe2\x80\x94 the only character he knew. That means, for any vertex index in his notes he knows only the number of digits in it. At least he knows there were no leading zeroes.Limak doesn\'t want to disappoint everyone. Please, take his notes and reconstruct a New Year tree. Find any tree matching Limak\'s records and print its edges in any order. It\'s also possible that Limak made a mistake and there is no suitable tree \xe2\x80\x93 in this case print ""-1"" (without the quotes)." 3200.0                            
                    609E "Minimum spanning tree for each edge" "data structures,dfs and similar,dsu,graphs,trees" "Connected undirected weighted graph without self-loops and multiple edges is given. Graph contains n vertices and m edges.For each edge (u,\xe2\x80\x89v) find the minimal possible weight of the spanning tree that contains the edge (u,\xe2\x80\x89v).The weight of the spanning tree is the sum of weights of all edges included in spanning tree." 2100.0                            
                    607C Marbles hashing,strings "In the spirit of the holidays, Saitama has given Genos two grid paths of length n (a weird gift even by Saitama\'s standards). A grid path is an ordered sequence of neighbouring squares in an infinite grid. Two squares are neighbouring if they share a side.One example of a grid path is (0,\xe2\x80\x890)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x892)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(1,\xe2\x80\x892)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(1,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891). Note that squares in this sequence might be repeated, i.e. path has self intersections.Movement within a grid path is restricted to adjacent squares within the sequence. That is, from the i-th square, one can only move to the (i\xe2\x80\x89-\xe2\x80\x891)-th or (i\xe2\x80\x89+\xe2\x80\x891)-th squares of this path. Note that there is only a single valid move from the first and last squares of a grid path. Also note, that even if there is some j-th square of the path that coincides with the i-th square, only moves to (i\xe2\x80\x89-\xe2\x80\x891)-th and (i\xe2\x80\x89+\xe2\x80\x891)-th squares are available. For example, from the second square in the above sequence, one can only move to either the first or third squares.To ensure that movement is not ambiguous, the two grid paths will not have an alternating sequence of three squares. For example, a contiguous subsequence (0,\xe2\x80\x890)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x890) cannot occur in a valid grid path.One marble is placed on the first square of each grid path. Genos wants to get both marbles to the last square of each grid path. However, there is a catch. Whenever he moves one marble, the other marble will copy its movement if possible. For instance, if one marble moves east, then the other marble will try and move east as well. By try, we mean if moving east is a valid move, then the marble will move east.Moving north increases the second coordinate by 1, while moving south decreases it by 1. Similarly, moving east increases first coordinate by 1, while moving west decreases it.Given these two valid grid paths, Genos wants to know if it is possible to move both marbles to the ends of their respective paths. That is, if it is possible to move the marbles such that both marbles rest on the last square of their respective paths." 2500.0                            
                    606A "Magic Spheres" implementation "Carl is a beginner magician. He has a blue, b violet and c orange magic spheres. In one move he can transform two spheres of the same color into one sphere of any other color. To make a spell that has never been seen before, he needs at least x blue, y violet and z orange spheres. Can he get them (possible, in multiple actions)?" 1200.0                            
                    600D "Area of Two Circles\' Intersection" geometry "You are given two circles. Find the area of their intersection." 2000.0                            
                    600A "Extract Numbers" implementation,strings "You are given string s. Let\'s call word any largest sequence of consecutive symbols without symbols \',\' (comma) and \';\' (semicolon). For example, there are four words in string ""aba,123;1a;0"": ""aba"", ""123"", ""1a"", ""0"". A word can be empty: for example, the string s="";;"" contains three empty words separated by \';\'.You should find all words in the given string that are nonnegative INTEGER numbers without leading zeroes and build by them new string a. String a should contain all words that are numbers separating them by \',\' (the order of numbers should remain the same as in the string s). By all other words you should build string b in the same way (the order of numbers should remain the same as in the string s).Here strings ""101"", ""0"" are INTEGER numbers, but ""01"" and ""1.0"" are not.For example, for the string aba,123;1a;0 the string a would be equal to ""123,0"" and string b would be equal to ""aba,1a""." 1600.0                            
                    599E "Sandy and Nuts" bitmasks,dp,trees "Rooted tree is a connected graph without any simple cycles with one vertex selected as a root. In this problem the vertex number 1 will always serve as a root.Lowest common ancestor of two vertices u and v is the farthest from the root vertex that lies on both the path from u to the root and on path from v to the root. We will denote it as LCA(u,\xe2\x80\x89v).Sandy had a rooted tree consisting of n vertices that she used to store her nuts. Unfortunately, the underwater storm broke her tree and she doesn\'t remember all it\'s edges. She only managed to restore m edges of the initial tree and q triples ai, bi and ci, for which she supposes LCA(ai,\xe2\x80\x89bi)\xe2\x80\x89=\xe2\x80\x89ci.Help Sandy count the number of trees of size n with vertex 1 as a root, that match all the information she remembered. If she made a mess and there are no such trees then print 0. Two rooted trees are considered to be distinct if there exists an edge that occur in one of them and doesn\'t occur in the other one." 2600.0                            
                    599D "Spongebob and Squares" "brute force,math" "Spongebob is already tired trying to reason his weird actions and calculations, so he simply asked you to find all pairs of n and m, such that there are exactly x distinct squares in the table consisting of n rows and m columns. For example, in a 3\xe2\x80\x89\xc3\x97\xe2\x80\x895 table there are 15 squares with side one, 8 squares with side two and 3 squares with side three. The total number of distinct squares in a 3\xe2\x80\x89\xc3\x97\xe2\x80\x895 table is 15\xe2\x80\x89+\xe2\x80\x898\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x8926." 1900.0                            
                    597B Restaurant dp,greedy,sortings "A restaurant received n orders for the rental. Each rental order reserve the restaurant for a continuous period of time, the i-th order is characterized by two time values \xe2\x80\x94 the start time li and the finish time ri (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri).Restaurant management can accept and reject orders. What is the maximal number of orders the restaurant can accept?No two accepted orders can intersect, i.e. they can\'t share even a moment of time. If one order ends in the moment other starts, they can\'t be accepted both." 1600.0                            
                    593D "Happy Tree Party" "data structures,dfs and similar,graphs,math,trees" "Bogdan has a birthday today and mom gave him a tree consisting of n vertecies. For every edge of the tree i, some number xi was written on it. In case you forget, a tree is a connected non-directed graph without cycles. After the present was granted, m guests consecutively come to Bogdan\'s party. When the i-th guest comes, he performs exactly one of the two possible operations:   Chooses some number yi, and two vertecies ai and bi. After that, he moves along the edges of the tree from vertex ai to vertex bi using the shortest path (of course, such a path is unique in the tree). Every time he moves along some edge j, he replaces his current number yi by , that is, by the result of integer division yi div xj.  Chooses some edge pi and replaces the value written in it xpi by some positive integer ci\xe2\x80\x89<\xe2\x80\x89xpi. As Bogdan cares about his guests, he decided to ease the process. Write a program that performs all the operations requested by guests and outputs the resulting value yi for each i of the first type." 2400.0                            
                    593A 2Char "brute force,implementation" "Andrew often reads articles in his favorite magazine 2Char. The main feature of these articles is that each of them uses at most two distinct letters. Andrew decided to send an article to the magazine, but as he hasn\'t written any article, he just decided to take a random one from magazine 26Char. However, before sending it to the magazine 2Char, he needs to adapt the text to the format of the journal. To do so, he removes some words from the chosen article, in such a way that the remaining text can be written using no more than two distinct letters.Since the payment depends from the number of non-space characters in the article, Andrew wants to keep the words with the maximum total length." 1200.0                            
                    591B Rebranding implementation,strings "The name of one small but proud corporation consists of n lowercase English letters. The Corporation has decided to try rebranding \xe2\x80\x94 an active marketing strategy, that includes a set of measures to change either the brand (both for the company and the goods it produces) or its components: the name, the logo, the slogan. They decided to start with the name.For this purpose the corporation has consecutively hired m designers. Once a company hires the i-th designer, he immediately contributes to the creation of a new corporation name as follows: he takes the newest version of the name and replaces all the letters xi by yi, and all the letters yi by xi. This results in the new version. It is possible that some of these letters do no occur in the string. It may also happen that xi coincides with yi. The version of the name received after the work of the last designer becomes the new name of the corporation.Manager Arkady has recently got a job in this company, but is already soaked in the spirit of teamwork and is very worried about the success of the rebranding. Naturally, he can\'t wait to find out what is the new name the Corporation will receive.Satisfy Arkady\'s curiosity and tell him the final version of the name." 1200.0                            
                    585F "Digits of Number Pi" dp,implementation,strings "Vasily has recently learned about the amazing properties of number \xcf\x80. In one of the articles it has been hypothesized that, whatever the sequence of numbers we have, in some position, this sequence is found among the digits of number \xcf\x80. Thus, if you take, for example, the epic novel ""War and Peace"" of famous Russian author Leo Tolstoy, and encode it with numbers, then we will find the novel among the characters of number \xcf\x80.Vasily was absolutely delighted with this, because it means that all the books, songs and programs have already been written and encoded in the digits of \xcf\x80. Vasily is, of course, a bit wary that this is only a hypothesis and it hasn\'t been proved, so he decided to check it out.To do this, Vasily downloaded from the Internet the archive with the sequence of digits of number \xcf\x80, starting with a certain position, and began to check the different strings of digits on the presence in the downloaded archive. Vasily quickly found short strings of digits, but each time he took a longer string, it turned out that it is not in the archive. Vasily came up with a definition that a string of length d is a half-occurrence if it contains a substring of length of at least , which occurs in the archive.To complete the investigation, Vasily took 2 large numbers x,\xe2\x80\x89y (x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y) with the same number of digits and now he wants to find the number of numbers in the interval from x to y, which are half-occurrences in the archive. Help Vasily calculate this value modulo 109\xe2\x80\x89+\xe2\x80\x897." 3200.0                            
                    585E "Present for Vitalik the Philatelist" "combinatorics,math,number theory" "Vitalik the philatelist has a birthday today!As he is a regular customer in a stamp store called \'Robin Bobin\', the store management decided to make him a gift.Vitalik wants to buy one stamp and the store will give him a non-empty set of the remaining stamps, such that the greatest common divisor (GCD) of the price of the stamps they give to him is more than one. If the GCD of prices of the purchased stamp and prices of present stamps set will be equal to 1, then Vitalik will leave the store completely happy.The store management asks you to count the number of different situations in which Vitalik will leave the store completely happy. Since the required number of situations can be very large, you need to find the remainder of this number modulo 109\xe2\x80\x89+\xe2\x80\x897. The situations are different if the stamps purchased by Vitalik are different, or if one of the present sets contains a stamp that the other present does not contain." 2900.0                            
                    584E "Anton and Ira" "constructive algorithms,greedy,math" "Anton loves transforming one permutation into another one by swapping elements for money, and Ira doesn\'t like paying for stupid games. Help them obtain the required permutation by paying as little money as possible.More formally, we have two permutations, p and s of numbers from 1 to n. We can swap pi and pj, by paying |i\xe2\x80\x89-\xe2\x80\x89j| coins for it. Find and print the smallest number of coins required to obtain permutation s from permutation p. Also print the sequence of swap operations at which we obtain a solution." 2300.0                            
                    582C "Superior Periodic Subarrays" "number theory" "You are given an infinite periodic array a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89... with the period of length n. Formally, . A periodic subarray (l,\xe2\x80\x89s) (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s\xe2\x80\x89<\xe2\x80\x89n) of array a is an infinite periodic array with a period of length s that is a subsegment of array a, starting with position l.A periodic subarray (l,\xe2\x80\x89s) is superior, if when attaching it to the array a, starting from index l, any element of the subarray is larger than or equal to the corresponding element of array a. An example of attaching is given on the figure (top \xe2\x80\x94 infinite array a, bottom \xe2\x80\x94 its periodic subarray (l,\xe2\x80\x89s)):  Find the number of distinct pairs (l,\xe2\x80\x89s), corresponding to the superior periodic arrays." 2400.0                            
                    581F "Zublicanes and Mumocrates" "dp,trees,two pointers" "It\'s election time in Berland. The favorites are of course parties of zublicanes and mumocrates. The election campaigns of both parties include numerous demonstrations on n main squares of the capital of Berland. Each of the n squares certainly can have demonstrations of only one party, otherwise it could lead to riots. On the other hand, both parties have applied to host a huge number of demonstrations, so that on all squares demonstrations must be held. Now the capital management will distribute the area between the two parties.Some pairs of squares are connected by (n\xe2\x80\x89-\xe2\x80\x891) bidirectional roads such that between any pair of squares there is a unique way to get from one square to another. Some squares are on the outskirts of the capital meaning that they are connected by a road with only one other square, such squares are called dead end squares.The mayor of the capital instructed to distribute all the squares between the parties so that the dead end squares had the same number of demonstrations of the first and the second party. It is guaranteed that the number of dead end squares of the city is even.To prevent possible conflicts between the zublicanes and the mumocrates it was decided to minimize the number of roads connecting the squares with the distinct parties. You, as a developer of the department of distributing squares, should determine this smallest number." 2400.0                            
                    580A "Kefa and First Steps" "brute force,dp,implementation" "Kefa decided to make some money doing business on the Internet for exactly n days. He knows that on the i-th day (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) he makes ai money. Kefa loves progress, that\'s why he wants to know the length of the maximum non-decreasing subsegment in sequence ai. Let us remind you that the subsegment of the sequence is its continuous fragment. A subsegment of numbers is called non-decreasing if all numbers in it follow in the non-decreasing order.Help Kefa cope with this task!" 900.0                            
                    578A "A Problem about Polyline" geometry,math "There is a polyline going through points (0,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(x,\xe2\x80\x89x)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(2x,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(3x,\xe2\x80\x89x)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(4x,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89...\xe2\x80\x89-\xe2\x80\x89(2kx,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(2kx\xe2\x80\x89+\xe2\x80\x89x,\xe2\x80\x89x)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89.... We know that the polyline passes through the point (a,\xe2\x80\x89b). Find minimum positive value x such that it is true or determine that there is no such x." 1700.0                            
                    576E "Painting Edges" "binary search,data structures" "Note the unusual memory limit for this problem.You are given an undirected graph consisting of n vertices and m edges. The vertices are numbered with integers from 1 to n, the edges are numbered with integers from 1 to m. Each edge can be unpainted or be painted in one of the k colors, which are numbered with integers from 1 to k. Initially, none of the edges is painted in any of the colors.You get queries of the form ""Repaint edge ei to color ci"". At any time the graph formed by the edges of the same color must be bipartite. If after the repaint this condition is violated, then the query is considered to be invalid and edge ei keeps its color. Otherwise, edge ei is repainted in color ci, and the query is considered to valid.Recall that the graph is called bipartite if the set of its vertices can be divided into two parts so that no edge connected vertices of the same parts.For example, suppose you are given a triangle graph, that is a graph with three vertices and edges (1,\xe2\x80\x892), (2,\xe2\x80\x893) and (3,\xe2\x80\x891). Suppose that the first two edges are painted color 1, and the third one is painted color 2. Then the query of ""repaint the third edge in color 1"" will be incorrect because after its execution the graph formed by the edges of color 1 will not be bipartite. On the other hand, it is possible to repaint the second edge in color 2.You receive q queries. For each query, you should either apply it, and report that the query is valid, or report that the query is invalid." 3300.0                            
                    575E "Spectator Riots" geometry "It\xe2\x80\x99s riot time on football stadium Ramacana! Raging fans have entered the field and the police find themselves in a difficult situation. The field can be represented as a square in the coordinate system defined by two diagonal vertices in (0,0) and (105, 105). The sides of that square are also considered to be inside the field, everything else is outside.In the beginning, there are N fans on the field. For each fan we are given his speed, an integer vi as well as his integer coordinates (xi, yi). A fan with those coordinates might move and after one second he might be at any point (xi\xe2\x80\x89+\xe2\x80\x89p, yi\xe2\x80\x89+\xe2\x80\x89q) where 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|\xe2\x80\x89+\xe2\x80\x89|q|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89vi. p, q are both integers.Points that go outside of the square that represents the field are excluded and all others have equal probability of being the location of that specific fan after one second.Andrej, a young and promising police officer, has sent a flying drone to take a photo of the riot from above. The drone\xe2\x80\x99s camera works like this:  It selects three points with integer coordinates such that there is a chance of a fan appearing there after one second. They must not be collinear or the camera won\xe2\x80\x99t work. It is guaranteed that not all of the initial positions of fans will be on the same line.  Camera focuses those points and creates a circle that passes through those three points. A photo is taken after one second (one second after the initial state).  Everything that is on the circle or inside it at the moment of taking the photo (one second after focusing the points) will be on the photo. Your goal is to select those three points so that the expected number of fans seen on the photo is maximized. If there are more such selections, select those three points that give the circle with largest radius among them. If there are still more suitable selections, any one of them will be accepted. If your answer follows conditions above and radius of circle you return is smaller then the optimal one by 0.01, your output will be considered as correct.No test will have optimal radius bigger than 1010." 2800.0                            
                    570D "Tree Requests" "binary search,bitmasks,constructive algorithms,dfs and similar,graphs,trees" "Roman planted a tree consisting of n vertices. Each vertex contains a lowercase English letter. Vertex 1 is the root of the tree, each of the n\xe2\x80\x89-\xe2\x80\x891 remaining vertices has a parent in the tree. Vertex is connected with its parent by an edge. The parent of vertex i is vertex pi, the parent index is always less than the index of the vertex (i.e., pi\xe2\x80\x89<\xe2\x80\x89i).The depth of the vertex is the number of nodes on the path from the root to v along the edges. In particular, the depth of the root is equal to 1.We say that vertex u is in the subtree of vertex v, if we can get from u to v, moving from the vertex to the parent. In particular, vertex v is in its subtree.Roma gives you m queries, the i-th of which consists of two numbers vi, hi. Let\'s consider the vertices in the subtree vi located at depth hi. Determine whether you can use the letters written at these vertices to make a string that is a palindrome. The letters that are written in the vertexes, can be rearranged in any order to make a palindrome, but all letters should be used." 2200.0                            
                    570C Replacement "constructive algorithms,data structures,implementation" "Daniel has a string s, consisting of lowercase English letters and period signs (characters \'.\'). Let\'s define the operation of replacement as the following sequence of steps: find a substring "".."" (two consecutive periods) in string s, of all occurrences of the substring let\'s choose the first one, and replace this substring with string ""."". In other words, during the replacement operation, the first two consecutive periods are replaced by one. If string s contains no two consecutive periods, then nothing happens.Let\'s define f(s) as the minimum number of operations of replacement to perform, so that the string does not have any two consecutive periods left.You need to process m queries, the i-th results in that the character at position xi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of string s is assigned value ci. After each operation you have to calculate and output the value of f(s).Help Daniel to process all queries." 1600.0                            
                    570A Elections implementation "The country of Byalechinsk is running elections involving n candidates. The country consists of m cities. We know how many people in each city voted for each candidate.The electoral system in the country is pretty unusual. At the first stage of elections the votes are counted for each city: it is assumed that in each city won the candidate who got the highest number of votes in this city, and if several candidates got the maximum number of votes, then the winner is the one with a smaller index.At the second stage of elections the winner is determined by the same principle over the cities: the winner of the elections is the candidate who won in the maximum number of cities, and among those who got the maximum number of cities the winner is the one with a smaller index.Determine who will win the elections." 1100.0                            
                    567D "One-Dimensional Battle Ships" "binary search,data structures,greedy,sortings" "Alice and Bob love playing one-dimensional battle ships. They play on the field in the form of a line consisting of n square cells (that is, on a 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n table).At the beginning of the game Alice puts k ships on the field without telling their positions to Bob. Each ship looks as a 1\xe2\x80\x89\xc3\x97\xe2\x80\x89a rectangle (that is, it occupies a sequence of a consecutive squares of the field). The ships cannot intersect and even touch each other.After that Bob makes a sequence of ""shots"". He names cells of the field and Alice either says that the cell is empty (""miss""), or that the cell belongs to some ship (""hit"").But here\'s the problem! Alice like to cheat. May be that is why she responds to each Bob\'s move with a ""miss"". Help Bob catch Alice cheating \xe2\x80\x94 find Bob\'s first move, such that after it you can be sure that Alice cheated." 1700.0                            
                    566A "Matching Names" "dfs and similar,strings,trees" "Teachers of one programming summer school decided to make a surprise for the students by giving them names in the style of the ""Hobbit"" movie. Each student must get a pseudonym maximally similar to his own name. The pseudonym must be a name of some character of the popular saga and now the teachers are busy matching pseudonyms to student names.There are n students in a summer school. Teachers chose exactly n pseudonyms for them. Each student must get exactly one pseudonym corresponding to him. Let us determine the relevance of a pseudonym b to a student with name a as the length of the largest common prefix a and b. We will represent such value as . Then we can determine the quality of matching of the pseudonyms to students as a sum of relevances of all pseudonyms to the corresponding students.Find the matching between students and pseudonyms with the maximum quality." 2300.0                            
                    557C "Arthur and Table" "brute force,data structures,dp,greedy,math,sortings" "Arthur has bought a beautiful big table into his new flat. When he came home, Arthur noticed that the new table is unstable.In total the table Arthur bought has n legs, the length of the i-th leg is li.Arthur decided to make the table stable and remove some legs. For each of them Arthur determined number di \xe2\x80\x94 the amount of energy that he spends to remove the i-th leg.A table with k legs is assumed to be stable if there are more than half legs of the maximum length. For example, to make a table with 5 legs stable, you need to make sure it has at least three (out of these five) legs of the maximum length. Also, a table with one leg is always stable and a table with two legs is stable if and only if they have the same lengths.Your task is to help Arthur and count the minimum number of energy units Arthur should spend on making the table stable." 1900.0                            
                    556B "Case of Fake Numbers" "brute force,implementation" "Andrewid the Android is a galaxy-famous detective. He is now investigating a case of frauds who make fake copies of the famous Stolp\'s gears, puzzles that are as famous as the Rubik\'s cube once was.Its most important components are a button and a line of n similar gears. Each gear has n teeth containing all numbers from 0 to n\xe2\x80\x89-\xe2\x80\x891 in the counter-clockwise order. When you push a button, the first gear rotates clockwise, then the second gear rotates counter-clockwise, the the third gear rotates clockwise an so on.Besides, each gear has exactly one active tooth. When a gear turns, a new active tooth is the one following after the current active tooth according to the direction of the rotation. For example, if n\xe2\x80\x89=\xe2\x80\x895, and the active tooth is the one containing number 0, then clockwise rotation makes the tooth with number 1 active, or the counter-clockwise rotating makes the tooth number 4 active.Andrewid remembers that the real puzzle has the following property: you can push the button multiple times in such a way that in the end the numbers on the active teeth of the gears from first to last form sequence 0,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891. Write a program that determines whether the given puzzle is real or fake." 1100.0                            
                    556A "Case of the Zeros and Ones" greedy "Andrewid the Android is a galaxy-famous detective. In his free time he likes to think about strings containing zeros and ones.Once he thought about a string of length n consisting of zeroes and ones. Consider the following operation: we choose any two adjacent positions in the string, and if one them contains 0, and the other contains 1, then we are allowed to remove these two digits from the string, obtaining a string of length n\xe2\x80\x89-\xe2\x80\x892 as a result.Now Andreid thinks about what is the minimum length of the string that can remain after applying the described operation several times (possibly, zero)? Help him to calculate this number." 900.0                            
                    554A "Kyoya and Photobooks" "brute force,math,strings" "Kyoya Ootori is selling photobooks of the Ouran High School Host Club. He has 26 photos, labeled ""a"" to ""z"", and he has compiled them into a photo booklet with some photos in some order (possibly with some photos being duplicated). A photo booklet can be described as a string of lowercase letters, consisting of the photos in the booklet in order. He now wants to sell some ""special edition"" photobooks, each with one extra photo inserted anywhere in the book. He wants to make as many distinct photobooks as possible, so he can make more money. He asks Haruhi, how many distinct photobooks can he make by inserting one extra photo into the photobook he already has?Please help Haruhi solve this problem." 900.0                            
                    553E "Kyoya and Train" dp,fft,graphs,math,probabilities "Kyoya Ootori wants to take the train to get to school. There are n train stations and m one-way train lines going between various stations. Kyoya is currently at train station 1, and the school is at station n. To take a train, he must pay for a ticket, and the train also takes a certain amount of time. However, the trains are not perfect and take random amounts of time to arrive at their destination. If Kyoya arrives at school strictly after t time units, he will have to pay a fine of x.Each train line is described by a ticket price, and a probability distribution on the time the train takes. More formally, train line i has ticket cost ci, and a probability distribution pi,\xe2\x80\x89k which denotes the probability that this train will take k time units for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t. Amounts of time that each of the trains used by Kyouya takes are mutually independent random values (moreover, if Kyoya travels along the same train more than once, it is possible for the train to take different amounts of time and those amounts are also independent one from another). Kyoya wants to get to school by spending the least amount of money in expectation (for the ticket price plus possible fine for being late). Of course, Kyoya has an optimal plan for how to get to school, and every time he arrives at a train station, he may recalculate his plan based on how much time he has remaining. What is the expected cost that Kyoya will pay to get to school if he moves optimally?" 3200.0                            
                    553B "Kyoya and Permutation" "binary search,combinatorics,constructive algorithms,greedy,implementation,math" "Let\'s define the permutation of length n as an array p\xe2\x80\x89=\xe2\x80\x89[p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn] consisting of n distinct integers from range from 1 to n. We say that this permutation maps value 1 into the value p1, value 2 into the value p2 and so on.Kyota Ootori has just learned about cyclic representation of a permutation. A cycle is a sequence of numbers such that each element of this sequence is being mapped into the next element of this sequence (and the last element of the cycle is being mapped into the first element of the cycle). The cyclic representation is a representation of p as a collection of cycles forming p. For example, permutation p\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x891,\xe2\x80\x896,\xe2\x80\x892,\xe2\x80\x895,\xe2\x80\x893] has a cyclic representation that looks like (142)(36)(5) because 1 is replaced by 4, 4 is replaced by 2, 2 is replaced by 1, 3 and 6 are swapped, and 5 remains in place. Permutation may have several cyclic representations, so Kyoya defines the standard cyclic representation of a permutation as follows. First, reorder the elements within each cycle so the largest element is first. Then, reorder all of the cycles so they are sorted by their first element. For our example above, the standard cyclic representation of [4,\xe2\x80\x891,\xe2\x80\x896,\xe2\x80\x892,\xe2\x80\x895,\xe2\x80\x893] is (421)(5)(63).Now, Kyoya notices that if we drop the parenthesis in the standard cyclic representation, we get another permutation! For instance, [4,\xe2\x80\x891,\xe2\x80\x896,\xe2\x80\x892,\xe2\x80\x895,\xe2\x80\x893] will become [4,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x895,\xe2\x80\x896,\xe2\x80\x893].Kyoya notices that some permutations don\'t change after applying operation described above at all. He wrote all permutations of length n that do not change in a list in lexicographic order. Unfortunately, his friend Tamaki Suoh lost this list. Kyoya wishes to reproduce the list and he needs your help. Given the integers n and k, print the permutation that was k-th on Kyoya\'s list." 1900.0                            
                    552E "Vanya and Brackets" "brute force,dp,expression parsing,greedy,implementation,strings" "Vanya is doing his maths homework. He has an expression of form , where x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn are digits from 1 to 9, and sign  represents either a plus \'+\' or the multiplication sign \'*\'. Vanya needs to add one pair of brackets in this expression so that to maximize the value of the resulting expression." 2100.0                            
                    551C "GukiZ hates Boxes" "binary search,greedy" "Professor GukiZ is concerned about making his way to school, because massive piles of boxes are blocking his way. In total there are n piles of boxes, arranged in a line, from left to right, i-th pile (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) containing ai boxes. Luckily, m students are willing to help GukiZ by removing all the boxes from his way. Students are working simultaneously. At time 0, all students are located left of the first pile. It takes one second for every student to move from this position to the first pile, and after that, every student must start performing sequence of two possible operations, each taking one second to complete. Possible operations are: If i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89n, move from pile i to pile i\xe2\x80\x89+\xe2\x80\x891; If pile located at the position of student is not empty, remove one box from it.GukiZ\'s students aren\'t smart at all, so they need you to tell them how to remove boxes before professor comes (he is very impatient man, and doesn\'t want to wait). They ask you to calculate minumum time t in seconds for which they can remove all the boxes from GukiZ\'s way. Note that students can be positioned in any manner after t seconds, but all the boxes must be removed." 2200.0                            
                    550C "Divisibility by Eight" "brute force,dp,math" "You are given a non-negative integer n, its decimal representation consists of at most 100 digits and doesn\'t contain leading zeroes.Your task is to determine if it is possible in this case to remove some of the digits (possibly not remove any digit at all) so that the result contains at least one digit, forms a non-negative integer, doesn\'t have leading zeroes and is divisible by 8. After the removing, it is forbidden to rearrange the digits.If a solution exists, you should print it." 1500.0                            
                    546D "Soldier and Number Game" "constructive algorithms,dp,math,number theory" "Two soldiers are playing a game. At the beginning first of them chooses a positive integer n and gives it to the second soldier. Then the second one tries to make maximum possible number of rounds. Each round consists of choosing a positive integer x\xe2\x80\x89>\xe2\x80\x891, such that n is divisible by x and replacing n with n\xe2\x80\x89/\xe2\x80\x89x. When n becomes equal to 1 and there is no more possible valid moves the game is over and the score of the second soldier is equal to the number of rounds he performed.To make the game more interesting, first soldier chooses n of form a!\xe2\x80\x89/\xe2\x80\x89b! for some positive integer a and b (a\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89b). Here by k! we denote the factorial of k that is defined as a product of all positive integers not large than k.What is the maximum possible score of the second soldier?" 1700.0                            
                    544B "Sea and Islands" "constructive algorithms,implementation" "A map of some object is a rectangular field consisting of n rows and n columns. Each cell is initially occupied by the sea but you can cover some some cells of the map with sand so that exactly k islands appear on the map. We will call a set of sand cells to be island if it is possible to get from each of them to each of them by moving only through sand cells and by moving from a cell only to a side-adjacent cell. The cells are called to be side-adjacent if they share a vertical or horizontal side. It is easy to see that islands do not share cells (otherwise they together form a bigger island).Find a way to cover some cells with sand so that exactly k islands appear on the n\xe2\x80\x89\xc3\x97\xe2\x80\x89n map, or determine that no such way exists." 1400.0                            
                    543A "Writing Code" dp "Programmers working on a large project have just received a task to write exactly m lines of code. There are n programmers working on a project, the i-th of them makes exactly ai bugs in every line of code that he writes. Let\'s call a sequence of non-negative integers v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vn a plan, if v1\xe2\x80\x89+\xe2\x80\x89v2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89vn\xe2\x80\x89=\xe2\x80\x89m. The programmers follow the plan like that: in the beginning the first programmer writes the first v1 lines of the given task, then the second programmer writes v2 more lines of the given task, and so on. In the end, the last programmer writes the remaining lines of the code. Let\'s call a plan good, if all the written lines of the task contain at most b bugs in total.Your task is to determine how many distinct good plans are there. As the number of plans can be large, print the remainder of this number modulo given positive integer mod." 1800.0                            
                    542F Quest dp,greedy "Polycarp is making a quest for his friends. He has already made n tasks, for each task the boy evaluated how interesting it is as an integer qi, and the time ti in minutes needed to complete the task. An interesting feature of his quest is: each participant should get the task that is best suited for him, depending on his preferences. The task is chosen based on an interactive quiz that consists of some questions. The player should answer these questions with ""yes"" or ""no"". Depending on the answer to the question, the participant either moves to another question or goes to one of the tasks that are in the quest. In other words, the quest is a binary tree, its nodes contain questions and its leaves contain tasks. We know that answering any of the questions that are asked before getting a task takes exactly one minute from the quest player. Polycarp knows that his friends are busy people and they can\'t participate in the quest for more than T minutes. Polycarp wants to choose some of the n tasks he made, invent the corresponding set of questions for them and use them to form an interactive quiz as a binary tree so that no matter how the player answers quiz questions, he spends at most T minutes on completing the whole quest (that is, answering all the questions and completing the task). Specifically, the quest can contain zero questions and go straight to the task. Each task can only be used once (i.e., the people who give different answers to questions should get different tasks).Polycarp wants the total ""interest"" value of the tasks involved in the quest to be as large as possible. Help him determine the maximum possible total interest value of the task considering that the quest should be completed in T minutes at any variant of answering questions." 2100.0                            
                    538G "Berserk Robot" "constructive algorithms,math,sortings" "Help! A robot escaped our lab and we need help finding it. The lab is at the point (0,\xe2\x80\x890) of the coordinate plane, at time 0 the robot was there. The robot\'s movements are defined by a program \xe2\x80\x94 a string of length l, consisting of characters U, L, D, R. Each second the robot executes the next command in his program: if the current coordinates of the robot are (x,\xe2\x80\x89y), then commands U, L, D, R move it to cells (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y) respectively. The execution of the program started at time 0. The program is looped, i.e. each l seconds of executing the program start again from the first character. Unfortunately, we don\'t know what program was loaded into the robot when he left the lab.Our radars managed to find out the position of the robot at n moments of time: we know that at the moment of time ti the robot is at the point (xi,\xe2\x80\x89yi). Given this data, either help to determine what program could be loaded into the robot, or determine that no possible program meets the data and the robot must have broken down." 3100.0                            
                    534C "Polycarpus\' Dice" math "Polycarp has n dice d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dn. The i-th dice shows numbers from 1 to di. Polycarp rolled all the dice and the sum of numbers they showed is A. Agrippina didn\'t see which dice showed what number, she knows only the sum A and the values d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dn. However, she finds it enough to make a series of statements of the following type: dice i couldn\'t show number r. For example, if Polycarp had two six-faced dice and the total sum is A\xe2\x80\x89=\xe2\x80\x8911, then Agrippina can state that each of the two dice couldn\'t show a value less than five (otherwise, the remaining dice must have a value of at least seven, which is impossible).For each dice find the number of values for which it can be guaranteed that the dice couldn\'t show these values if the sum of the shown values is A." 1600.0                            
                    533A "Berland Miners" "binary search,data structures,dfs and similar,greedy,trees" "The biggest gold mine in Berland consists of n caves, connected by n\xe2\x80\x89-\xe2\x80\x891 transitions. The entrance to the mine leads to the cave number 1, it is possible to go from it to any remaining cave of the mine by moving along the transitions. The mine is being developed by the InMine Inc., k miners work for it. Each day the corporation sorts miners into caves so that each cave has at most one miner working there. For each cave we know the height of its ceiling hi in meters, and for each miner we know his height sj, also in meters. If a miner\'s height doesn\'t exceed the height of the cave ceiling where he is, then he can stand there comfortably, otherwise, he has to stoop and that makes him unhappy.Unfortunately, miners typically go on strike in Berland, so InMine makes all the possible effort to make miners happy about their work conditions. To ensure that no miner goes on strike, you need make sure that no miner has to stoop at any moment on his way from the entrance to the mine to his cave (in particular, he must be able to stand comfortably in the cave where he works). To reach this goal, you can choose exactly one cave and increase the height of its ceiling by several meters. However enlarging a cave is an expensive and complex procedure. That\'s why InMine Inc. asks you either to determine the minimum number of meters you should raise the ceiling of some cave so that it is be possible to sort the miners into the caves and keep all miners happy with their working conditions or to determine that it is impossible to achieve by raising ceiling in exactly one cave." 3000.0                            
                    530G "Levenshtein distance" "*special problem" "Levenshtein distance between two strings of letters is calculated as the minimal total cost of a sequence of edit actions that converts one of the strings into the other one. The allowed edit actions are: substitution: the cost of substituting one letter with another is equal to the difference of index numbers of these letters in English alphabet. insertion/deletion: the cost of inserting a letter into a string or deleting a letter from a string is equal to the index number of this letter in English alphabet (see examples).You are given two strings. Find the Levenshtein distance between them." 2100.0                            
                    523B "Mean Requests" "*special problem,implementation" "In this problem you will have to deal with a real algorithm that is used in the VK social network.As in any other company that creates high-loaded websites, the VK developers have to deal with request statistics regularly. An important indicator reflecting the load of the site is the mean number of requests for a certain period of time of T seconds (for example, T\xe2\x80\x89=\xe2\x80\x8960 seconds\xe2\x80\x89=\xe2\x80\x891 min and T\xe2\x80\x89=\xe2\x80\x8986400 seconds\xe2\x80\x89=\xe2\x80\x891 day). For example, if this value drops dramatically, that shows that the site has access problem. If this value grows, that may be a reason to analyze the cause for the growth and add more servers to the website if it is really needed.However, even such a natural problem as counting the mean number of queries for some period of time can be a challenge when you process the amount of data of a huge social network. That\'s why the developers have to use original techniques to solve problems approximately, but more effectively at the same time.Let\'s consider the following formal model. We have a service that works for n seconds. We know the number of queries to this resource at at each moment of time t (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Let\'s formulate the following algorithm of calculating the mean with exponential decay. Let c be some real number, strictly larger than one.// setting this constant value correctly can adjust   // the time range for which statistics will be calculateddouble c = some constant value; // as the result of the algorithm\'s performance this variable will contain // the mean number of queries for the last // T seconds by the current moment of timedouble mean = 0.0; for t = 1..n: // at each second, we do the following:    // at is the number of queries that came at the last second;    mean = (mean + at / T) / c;Thus, the mean variable is recalculated each second using the number of queries that came at that second. We can make some mathematical calculations and prove that choosing the value of constant c correctly will make the value of mean not very different from the real mean value ax at t\xe2\x80\x89-\xe2\x80\x89T\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t. The advantage of such approach is that it only uses the number of requests at the current moment of time and doesn\'t require storing the history of requests for a large time range. Also, it considers the recent values with the weight larger than the weight of the old ones, which helps to react to dramatic change in values quicker.However before using the new theoretical approach in industrial programming, there is an obligatory step to make, that is, to test its credibility practically on given test data sets. Your task is to compare the data obtained as a result of the work of an approximate algorithm to the real data. You are given n values at, integer T and real number c. Also, you are given m moments pj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m), where we are interested in the mean value of the number of queries for the last T seconds. Implement two algorithms. The first one should calculate the required value by definition, i.e. by the formula . The second algorithm should calculate the mean value as is described above. Print both values and calculate the relative error of the second algorithm by the formula , where approx is the approximate value, obtained by the second algorithm, and real is the exact value obtained by the first algorithm." 1500.0                            
                    513B2 Permutations "bitmasks,divide and conquer,math" "You are given a permutation p of numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n. Let\'s define f(p) as the following sum:Find the lexicographically m-th permutation of length n in the set of permutations having the maximum possible value of f(p)." 1800.0                            
                    510E "Fox And Dinner" flows "Fox Ciel is participating in a party in Prime Kingdom. There are n foxes there (include Fox Ciel). The i-th fox is ai years old.They will have dinner around some round tables. You want to distribute foxes such that:  Each fox is sitting at some table.  Each table has at least 3 foxes sitting around it.  The sum of ages of any two adjacent foxes around each table should be a prime number. If k foxes f1, f2, ..., fk are sitting around table in clockwise order, then for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891: fi and fi\xe2\x80\x89+\xe2\x80\x891 are adjacent, and f1 and fk are also adjacent.If it is possible to distribute the foxes in the desired manner, find out a way to do that." 2300.0                            
                    510B "Fox And Two Dots" "dfs and similar" "Fox Ciel is playing a mobile puzzle game called ""Two Dots"". The basic levels are played on a board of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells, like this:Each cell contains a dot that has some color. We will use different uppercase Latin characters to express different colors.The key of this game is to find a cycle that contain dots of same color. Consider 4 blue dots on the picture forming a circle as an example. Formally, we call a sequence of dots d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dk a cycle if and only if it meets the following condition:  These k dots are different: if i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j then di is different from dj.  k is at least 4.  All dots belong to the same color.  For all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891: di and di\xe2\x80\x89+\xe2\x80\x891 are adjacent. Also, dk and d1 should also be adjacent. Cells x and y are called adjacent if they share an edge. Determine if there exists a cycle on the field." 1500.0                            
                    510A "Fox And Snake" implementation "Fox Ciel starts to learn programming. The first task is drawing a fox! However, that turns out to be too hard for a beginner, so she decides to draw a snake instead.A snake is a pattern on a n by m table. Denote c-th cell of r-th row as (r,\xe2\x80\x89c). The tail of the snake is located at (1,\xe2\x80\x891), then it\'s body extends to (1,\xe2\x80\x89m), then goes down 2 rows to (3,\xe2\x80\x89m), then goes left to (3,\xe2\x80\x891) and so on.Your task is to draw this snake for Fox Ciel: the empty cells should be represented as dot characters (\'.\') and the snake cells should be filled with number signs (\'#\').Consider sample tests in order to understand the snake pattern." 800.0                            
                    509A "Maximum in Table" "brute force,implementation" "An n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table a is defined as follows:  The first row and the first column contain ones, that is: ai,\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89a1,\xe2\x80\x89i\xe2\x80\x89=\xe2\x80\x891 for all i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n.  Each of the remaining numbers in the table is equal to the sum of the number above it and the number to the left of it. In other words, the remaining elements are defined by the formula ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891. These conditions define all the values in the table.You are given a number n. You need to determine the maximum value in the n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table defined by the rules above." 800.0                            
                    508B "Anton and currency you all know" greedy,math,strings "Berland, 2016. The exchange rate of currency you all know against the burle has increased so much that to simplify the calculations, its fractional part was neglected and the exchange rate is now assumed to be an integer.Reliable sources have informed the financier Anton of some information about the exchange rate of currency you all know against the burle for tomorrow. Now Anton knows that tomorrow the exchange rate will be an even number, which can be obtained from the present rate by swapping exactly two distinct digits in it. Of all the possible values that meet these conditions, the exchange rate for tomorrow will be the maximum possible. It is guaranteed that today the exchange rate is an odd positive integer n. Help Anton to determine the exchange rate of currency you all know for tomorrow!" 1300.0                            
                    507E "Breaking Good" "dfs and similar,dp,graphs,shortest paths" "Breaking Good is a new video game which a lot of gamers want to have. There is a certain level in the game that is really difficult even for experienced gamers.Walter William, the main character of the game, wants to join a gang called Los Hermanos (The Brothers). The gang controls the whole country which consists of n cities with m bidirectional roads connecting them. There is no road is connecting a city to itself and for any two cities there is at most one road between them. The country is connected, in the other words, it is possible to reach any city from any other city using the given roads. The roads aren\'t all working. There are some roads which need some more work to be performed to be completely functioning.The gang is going to rob a bank! The bank is located in city 1. As usual, the hardest part is to escape to their headquarters where the police can\'t get them. The gang\'s headquarters is in city n. To gain the gang\'s trust, Walter is in charge of this operation, so he came up with a smart plan.First of all the path which they are going to use on their way back from city 1 to their headquarters n must be as short as possible, since it is important to finish operation as fast as possible.Then, gang has to blow up all other roads in country that don\'t lay on this path, in order to prevent any police reinforcements. In case of non-working road, they don\'t have to blow up it as it is already malfunctional. If the chosen path has some roads that doesn\'t work they\'ll have to repair those roads before the operation.Walter discovered that there was a lot of paths that satisfied the condition of being shortest possible so he decided to choose among them a path that minimizes the total number of affected roads (both roads that have to be blown up and roads to be repaired).Can you help Walter complete his task and gain the gang\'s trust?" 2100.0                            
                    507B "Amr and Pins" geometry,math "Amr loves Geometry. One day he came up with a very interesting problem.Amr has a circle of radius r and center in point (x,\xe2\x80\x89y). He wants the circle center to be in new position (x\',\xe2\x80\x89y\').In one step Amr can put a pin to the border of the circle in a certain point, then rotate the circle around that pin by any angle and finally remove the pin.Help Amr to achieve his goal in minimum number of steps." 1400.0                            
                    504D "Misha and XOR" bitmasks "After Misha\'s birthday he had many large numbers left, scattered across the room. Now it\'s time to clean up and Misha needs to put them in a basket. He ordered this task to his pet robot that agreed to complete the task at certain conditions. Before the robot puts a number x to the basket, Misha should answer the question: is it possible to choose one or multiple numbers that already are in the basket, such that their XOR sum equals x? If the answer is positive, you also need to give the indexes of these numbers. If there are multiple options of choosing numbers, you are allowed to choose any correct option. After Misha\'s answer the robot puts the number to the basket.Initially the basket is empty. Each integer you put in the basket takes some number. The first integer you put into the basket take number 0, the second integer takes number 1 and so on.Misha needs to clean up the place as soon as possible but unfortunately, he isn\'t that good at mathematics. He asks you to help him." 2700.0                            
                    493B "Vasya and Wrestling" implementation "Vasya has become interested in wrestling. In wrestling wrestlers use techniques for which they are awarded points by judges. The wrestler who gets the most points wins.When the numbers of points of both wrestlers are equal, the wrestler whose sequence of points is lexicographically greater, wins.If the sequences of the awarded points coincide, the wrestler who performed the last technique wins. Your task is to determine which wrestler won." 1400.0                            
                    487E Tourists "data structures,dfs and similar,graphs,trees" "There are n cities in Cyberland, numbered from 1 to n, connected by m bidirectional roads. The j-th road connects city aj and bj.For tourists, souvenirs are sold in every city of Cyberland. In particular, city i sell it at a price of wi.Now there are q queries for you to handle. There are two types of queries: ""C a w"": The price in city a is changed to w. ""A a b"": Now a tourist will travel from city a to b. He will choose a route, he also doesn\'t want to visit a city twice. He will buy souvenirs at the city where the souvenirs are the cheapest (possibly exactly at city a or b). You should output the minimum possible price that he can buy the souvenirs during his travel.More formally, we can define routes as follow: A route is a sequence of cities [x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk], where k is a certain positive integer. For any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k,\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89xj. For any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k, there is a road connecting xi and xi\xe2\x80\x89+\xe2\x80\x891. The minimum price of the route is min(wx1,\xe2\x80\x89wx2,\xe2\x80\x89...,\xe2\x80\x89wxk). The required answer is the minimum value of the minimum prices of all valid routes from a to b." 3200.0                            
                    484C "Strange Sorting" implementation,math "How many specific orders do you know? Ascending order, descending order, order of ascending length, order of ascending polar angle... Let\'s have a look at another specific order: d-sorting. This sorting is applied to the strings of length at least d, where d is some positive integer. The characters of the string are sorted in following manner: first come all the 0-th characters of the initial string, then the 1-st ones, then the 2-nd ones and so on, in the end go all the (d\xe2\x80\x89-\xe2\x80\x891)-th characters of the initial string. By the i-th characters we mean all the character whose positions are exactly i modulo d. If two characters stand on the positions with the same remainder of integer division by d, their relative order after the sorting shouldn\'t be changed. The string is zero-indexed. For example, for string \'qwerty\':Its 1-sorting is the string \'qwerty\' (all characters stand on 0 positions),Its 2-sorting is the string \'qetwry\' (characters \'q\', \'e\' and \'t\' stand on 0 positions and characters \'w\', \'r\' and \'y\' are on 1 positions),Its 3-sorting is the string \'qrwtey\' (characters \'q\' and \'r\' stand on 0 positions, characters \'w\' and \'t\' stand on 1 positions and characters \'e\' and \'y\' stand on 2 positions),Its 4-sorting is the string \'qtwyer\',Its 5-sorting is the string \'qywert\'.You are given string S of length n and m shuffling operations of this string. Each shuffling operation accepts two integer arguments k and d and transforms string S as follows. For each i from 0 to n\xe2\x80\x89-\xe2\x80\x89k in the increasing order we apply the operation of d-sorting to the substring S[i..i\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891]. Here S[a..b] represents a substring that consists of characters on positions from a to b inclusive.After each shuffling operation you need to print string S." 2600.0                            
                    482E ELCA "data structures,trees" "You have a root tree containing n vertexes. Let\'s number the tree vertexes with integers from 1 to n. The tree root is in the vertex 1.Each vertex (except fot the tree root) v has a direct ancestor pv. Also each vertex v has its integer value sv. Your task is to perform following queries:  P v u (u\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89v). If u isn\'t in subtree of v, you must perform the assignment pv\xe2\x80\x89=\xe2\x80\x89u. Otherwise you must perform assignment pu\xe2\x80\x89=\xe2\x80\x89v. Note that after this query the graph continues to be a tree consisting of n vertexes. V v t. Perform assignment sv\xe2\x80\x89=\xe2\x80\x89t. Your task is following. Before starting performing queries and after each query you have to calculate expected value written on the lowest common ancestor of two equiprobably selected vertices i and j. Here lowest common ancestor of i and j is the deepest vertex that lies on the both of the path from the root to vertex i and the path from the root to vertex j. Please note that the vertices i and j can be the same (in this case their lowest common ancestor coincides with them)." 3200.0                            
                    482A "Diverse Permutation" "constructive algorithms,greedy" "Permutation p is an ordered set of integers p1,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers not larger than n. We\'ll denote as n the length of permutation p1,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89pn.Your task is to find such permutation p of length n, that the group of numbers |p1\xe2\x80\x89-\xe2\x80\x89p2|,\xe2\x80\x89|p2\xe2\x80\x89-\xe2\x80\x89p3|,\xe2\x80\x89...,\xe2\x80\x89|pn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89pn| has exactly k distinct elements." 1200.0                            
                    479C Exams greedy,sortings "Student Valera is an undergraduate student at the University. His end of term exams are approaching and he is to pass exactly n exams. Valera is a smart guy, so he will be able to pass any exam he takes on his first try. Besides, he can take several exams on one day, and in any order.According to the schedule, a student can take the exam for the i-th subject on the day number ai. However, Valera has made an arrangement with each teacher and the teacher of the i-th subject allowed him to take an exam before the schedule time on day bi (bi\xe2\x80\x89<\xe2\x80\x89ai). Thus, Valera can take an exam for the i-th subject either on day ai, or on day bi. All the teachers put the record of the exam in the student\'s record book on the day of the actual exam and write down the date of the mark as number ai.Valera believes that it would be rather strange if the entries in the record book did not go in the order of non-decreasing date. Therefore Valera asks you to help him. Find the minimum possible value of the day when Valera can take the final exam if he takes exams so that all the records in his record book go in the order of non-decreasing date." 1400.0                            
                    476E "Dreamoon and Strings" dp,strings "Dreamoon has a string s and a pattern string p. He first removes exactly x characters from s obtaining string s\' as a result. Then he calculates  that is defined as the maximal number of non-overlapping substrings equal to p that can be found in s\'. He wants to make this number as big as possible.More formally, let\'s define  as maximum value of  over all s\' that can be obtained by removing exactly x characters from s. Dreamoon wants to know  for all x from 0 to |s| where |s| denotes the length of string s." 2200.0                            
                    475D CGCDSSQ "brute force,data structures,math" "Given a sequence of integers a1,\xe2\x80\x89...,\xe2\x80\x89an and q queries x1,\xe2\x80\x89...,\xe2\x80\x89xq on it. For each query xi you have to count the number of pairs (l,\xe2\x80\x89r) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and gcd(al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar)\xe2\x80\x89=\xe2\x80\x89xi. is a greatest common divisor of v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vn, that is equal to a largest positive integer that divides all vi." 2000.0                            
                    474D Flowers dp "We saw the little game Marmot made for Mole\'s lunch. Now it\'s Marmot\'s dinner time and, as we all know, Marmot eats flowers. At every dinner he eats some red and white flowers. Therefore a dinner can be represented as a sequence of several flowers, some of them white and some of them red.But, for a dinner to be tasty, there is a rule: Marmot wants to eat white flowers only in groups of size k.Now Marmot wonders in how many ways he can eat between a and b flowers. As the number of ways could be very large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1700.0                            
                    472F "Design Tutorial: Change the Goal" "constructive algorithms,math,matrices" "There are some tasks which have the following structure: you are given a model, and you can do some operations, you should use these operations to achive the goal. One way to create a new task is to use the same model and same operations, but change the goal.Let\'s have a try. I have created the following task for Topcoder SRM 557 Div1-Hard: you are given n integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. You are allowed to perform the assignments (as many as you want) of the following form xi ^= xj (in the original task i and j must be different, but in this task we allow i to equal j). The goal is to maximize the sum of all xi.Now we just change the goal. You are also given n integers y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn. You should make x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn exactly equal to y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn. In other words, for each i number xi should be equal to yi." 2700.0                            
                    467C "George and Job" dp,implementation "The new ITone 6 has been released recently and George got really keen to buy it. Unfortunately, he didn\'t have enough money, so George was going to work as a programmer. Now he faced the following problem at the work.Given a sequence of n integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. You are to choose k pairs of integers: [l1,\xe2\x80\x89r1],\xe2\x80\x89[l2,\xe2\x80\x89r2],\xe2\x80\x89...,\xe2\x80\x89[lk,\xe2\x80\x89rk] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1\xe2\x80\x89<\xe2\x80\x89l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89lk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; ri\xe2\x80\x89-\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89m),\xe2\x80\x89in such a way that the value of sum  is maximal possible. Help George to cope with the task." 1700.0                            
                    466D "Increase Sequence" combinatorics,dp "Peter has a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Peter wants all numbers in the sequence to equal h. He can perform the operation of ""adding one on the segment [l,\xe2\x80\x89r]"": add one to all elements of the sequence with indices from l to r (inclusive). At that, Peter never chooses any element as the beginning of the segment twice. Similarly, Peter never chooses any element as the end of the segment twice. In other words, for any two segments [l1,\xe2\x80\x89r1] and [l2,\xe2\x80\x89r2], where Peter added one, the following inequalities hold: l1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89l2 and r1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89r2.How many distinct ways are there to make all numbers in the sequence equal h? Print this number of ways modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Two ways are considered distinct if one of them has a segment that isn\'t in the other way." 2100.0                            
                    462B "Appleman and Card Game" greedy "Appleman has n cards. Each card has an uppercase letter written on it. Toastman must choose k cards from Appleman\'s cards. Then Appleman should give Toastman some coins depending on the chosen cards. Formally, for each Toastman\'s card i you should calculate how much Toastman\'s cards have the letter equal to letter on ith, then sum up all these quantities, such a number of coins Appleman should give to Toastman.Given the description of Appleman\'s cards. What is the maximum number of coins Toastman can get?" 1300.0                            
                    459A "Pashmak and Garden" implementation "Pashmak has fallen in love with an attractive girl called Parmida since one year ago...Today, Pashmak set up a meeting with his partner in a romantic garden. Unfortunately, Pashmak has forgotten where the garden is. But he remembers that the garden looks like a square with sides parallel to the coordinate axes. He also remembers that there is exactly one tree on each vertex of the square. Now, Pashmak knows the position of only two of the trees. Help him to find the position of two remaining ones." 1200.0                            
                    457B "Distributed Join" greedy "Piegirl was asked to implement two table join operation for distributed database system, minimizing the network traffic.Suppose she wants to join two tables, A and B. Each of them has certain number of rows which are distributed on different number of partitions. Table A is distributed on the first cluster consisting of m partitions. Partition with index i has ai rows from A. Similarly, second cluster containing table B has n partitions, i-th one having bi rows from B. In one network operation she can copy one row from any partition to any other partition. At the end, for each row from A and each row from B there should be a partition that has both rows. Determine the minimal number of network operations to achieve this." 1900.0                            
                    455E Function "data structures" "Serega and Fedor play with functions. One day they came across a very interesting function. It looks like that:  f(1,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89a[j], 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.  f(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89min(f(i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j),\xe2\x80\x89f(i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891))\xe2\x80\x89+\xe2\x80\x89a[j], 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Here a is an integer array of length n.Serega and Fedya want to know what values this function takes at some points. But they don\'t want to calculate the values manually. So they ask you to help them." 2900.0                            
                    453C "Little Pony and Summer Sun Celebration" "constructive algorithms,dfs and similar,graphs" "Twilight Sparkle learnt that the evil Nightmare Moon would return during the upcoming Summer Sun Celebration after one thousand years of imprisonment on the moon. She tried to warn her mentor Princess Celestia, but the princess ignored her and sent her to Ponyville to check on the preparations for the celebration.  Twilight Sparkle wanted to track the path of Nightmare Moon. Unfortunately, she didn\'t know the exact path. What she knew is the parity of the number of times that each place Nightmare Moon visited. Can you help Twilight Sparkle to restore any path that is consistent with this information?Ponyville can be represented as an undirected graph (vertices are places, edges are roads between places) without self-loops and multi-edges. The path can start and end at any place (also it can be empty). Each place can be visited multiple times. The path must not visit more than 4n places." 2200.0                            
                    450B "Jzzhu and Sequences" implementation,math "Jzzhu has invented a kind of sequences, they meet the following property:You are given x and y, please calculate fn modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1300.0                            
                         1873D "1D Eraser" "greedy,implementation,two pointers" "You are given a strip of paper s that is n cells long. Each cell is either black or white. In an operation you can take any k consecutive cells and make them all white.Find the minimum number of operations needed to remove all black cells." 800.0                       
                         1873A "Short Sort" "brute force,implementation" "There are three cards with letters a, b, c placed in a row in some order. You can do the following operation at most once:   Pick two cards, and swap them.  Is it possible that the row becomes abc after the operation? Output ""YES"" if it is possible, and ""NO"" otherwise." 800.0                       
                         1872E "Data Structures Fan" "binary search,bitmasks,data structures,dp" "You are given an array of integers a1,a2,\xe2\x80\xa6,an, as well as a binary string\xe2\x80\xa0 s consisting of n characters.Augustin is a big fan of data structures. Therefore, he asked you to implement a data structure that can answer q queries. There are two types of queries: ""1 l r"" (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) \xe2\x80\x94 replace each character si for l\xe2\x89\xa4i\xe2\x89\xa4r with its opposite. That is, replace all 0 with 1 and all 1 with 0. ""2 g"" (g\xe2\x88\x88{0,1}) \xe2\x80\x94 calculate the value of the bitwise XOR of the numbers ai for all indices i such that si=g. Note that the XOR of an empty set of numbers is considered to be equal to 0.Please help Augustin to answer all the queries!For example, if n=4, a=[1,2,3,6], s=1001, consider the following series of queries: ""2 0"" \xe2\x80\x94 we are interested in the indices i for which si=0, since s=1001, these are the indices 2 and 3, so the answer to the query will be a2\xe2\x8a\x95a3=2\xe2\x8a\x953=1. ""1 1 3"" \xe2\x80\x94 we need to replace the characters s1,s2,s3 with their opposites, so before the query s=1001, and after the query: s=0111. ""2 1"" \xe2\x80\x94 we are interested in the indices i for which si=1, since s=0111, these are the indices 2, 3, and 4, so the answer to the query will be a2\xe2\x8a\x95a3\xe2\x8a\x95a4=2\xe2\x8a\x953\xe2\x8a\x956=7. ""1 2 4"" \xe2\x80\x94 s=0111 \xe2\x86\x92 s=0000. ""2 1"" \xe2\x80\x94 s=0000, there are no indices with si=1, so since the XOR of an empty set of numbers is considered to be equal to 0, the answer to this query is 0.\xe2\x80\xa0 A binary string is a string containing only characters 0 or 1." 1500.0                       
                         1872B "The Corridor or There and Back Again" greedy,implementation "You are in a corridor that extends infinitely to the right, divided into square rooms. You start in room 1, proceed to room k, and then return to room 1. You can choose the value of k. Moving to an adjacent room takes 1 second.Additionally, there are n traps in the corridor: the i-th trap is located in room di and will be activated si seconds after you enter the room di. Once a trap is activated, you cannot enter or exit a room with that trap.  A schematic representation of a possible corridor and your path to room k and back. Determine the maximum value of k that allows you to travel from room 1 to room k and then return to room 1 safely.For instance, if n=1 and d1=2,s1=2, you can proceed to room k=2 and return safely (the trap will activate at the moment 1+s1=1+2=3, it can\'t prevent you to return back). But if you attempt to reach room k=3, the trap will activate at the moment 1+s1=1+2=3, preventing your return (you would attempt to enter room 2 on your way back at second 3, but the activated trap would block you). Any larger value for k is also not feasible. Thus, the answer is k=2." 900.0                       
                         1866K "Keen Tree Calculation" "binary search,data structures,dp,geometry,graphs,implementation,trees" "There is a tree of N vertices and N\xe2\x88\x921 edges. The i-th edge connects vertices Ui and Vi and has a length of Wi.Chaneka, the owner of the tree, asks you Q times. For the j-th question, the following is the question format:   Xj Kj \xe2\x80\x93 If each edge that contains vertex Xj has its length multiplied by Kj, what is the diameter of the tree? Notes:   Each of Chaneka\'s question is independent, which means the changes in edge length do not influence the next questions.  The diameter of a tree is the maximum possible distance between two different vertices in the tree." 2500.0                       
                         1864C "Divisor Chain" "bitmasks,constructive algorithms,math,number theory" "You are given an integer x. Your task is to reduce x to 1.To do that, you can do the following operation:  select a divisor d of x, then change x to x\xe2\x88\x92d, i.e. reduce x by d. (We say that d is a divisor of x if d is an positive integer and there exists an integer q such that x=d\xe2\x8b\x85q.) There is an additional constraint: you cannot select the same value of d more than twice.For example, for x=5, the following scheme is invalid because 1 is selected more than twice: 5\xe2\x88\x921\xe2\x86\x924\xe2\x88\x921\xe2\x86\x923\xe2\x88\x921\xe2\x86\x922\xe2\x88\x921\xe2\x86\x921. The following scheme is however a valid one: 5\xe2\x88\x921\xe2\x86\x924\xe2\x88\x922\xe2\x86\x922\xe2\x88\x921\xe2\x86\x921.Output any scheme which reduces x to 1 with at most 1000 operations. It can be proved that such a scheme always exists." 1300.0                       
                         1861D "Sorting By Multiplication" dp,greedy "You are given an array a of length n, consisting of positive integers. You can perform the following operation on this array any number of times (possibly zero):   choose three integers l, r and x such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, and multiply every ai such that l\xe2\x89\xa4i\xe2\x89\xa4r by x. Note that you can choose any integer as x, it doesn\'t have to be positive.You have to calculate the minimum number of operations to make the array a sorted in strictly ascending order (i.\xe2\x80\x89e. the condition a1<a2<\xe2\x8b\xaf<an must be satisfied)." 1800.0                       
                         1858C "Yet Another Permutation Problem" "constructive algorithms,greedy,math,number theory" "Alex got a new game called ""GCD permutations"" as a birthday present. Each round of this game proceeds as follows:  First, Alex chooses a permutation\xe2\x80\xa0 a1,a2,\xe2\x80\xa6,an of integers from 1 to n.  Then, for each i from 1 to n, an integer di=gcd(ai,a(imodn)+1) is calculated.  The score of the round is the number of distinct numbers among d1,d2,\xe2\x80\xa6,dn. Alex has already played several rounds so he decided to find a permutation a1,a2,\xe2\x80\xa6,an such that its score is as large as possible.Recall that gcd(x,y) denotes the greatest common divisor (GCD) of numbers x and y, and xmody denotes the remainder of dividing x by y.\xe2\x80\xa0A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1000.0                       
                         1857D "Strong Vertices" math,sortings,trees "Given two arrays a and b, both of length n. Elements of both arrays indexed from 1 to n. You are constructing a directed graph, where edge from u to v (u\xe2\x89\xa0v) exists if au\xe2\x88\x92av\xe2\x89\xa5bu\xe2\x88\x92bv.A vertex V is called strong if there exists a path from V to all other vertices.A path in a directed graph is a chain of several vertices, connected by edges, such that moving from the vertex u, along the directions of the edges, the vertex v can be reached.Your task is to find all strong vertices.For example, if a=[3,1,2,4] and b=[4,3,2,1], the graph will look like this:   The graph has only one strong vertex with number 4" 1300.0                       
                         1855B "Longest Divisors Interval" "brute force,combinatorics,greedy,math,number theory" "Given a positive integer n, find the maximum size of an interval [l,r] of positive integers such that, for every i in the interval (i.e., l\xe2\x89\xa4i\xe2\x89\xa4r), n is a multiple of i.Given two integers l\xe2\x89\xa4r, the size of the interval [l,r] is r\xe2\x88\x92l+1 (i.e., it coincides with the number of integers belonging to the interval)." 900.0                       
                         1854C "Expected Destruction" combinatorics,dp,math,probabilities "You have a set S of n distinct integers between 1 and m.Each second you do the following steps:   Pick an element x in S uniformly at random.  Remove x from S.  If x+1\xe2\x89\xa4m and x+1 is not in S, add x+1 to S. What is the expected number of seconds until S is empty?Output the answer modulo 1000000007.Formally, let P=1000000007. It can be shown that the answer can be expressed as an irreducible fraction ab, where a and b are integers and b\xe2\x89\xa20(modP). Output the integer equal to a\xe2\x8b\x85b\xe2\x88\x921modP. In other words, output an integer z such that 0\xe2\x89\xa4z<P and z\xe2\x8b\x85b\xe2\x89\xa1a(modP)." 2500.0                       
                         1853A Desorting "brute force,greedy,math" "Call an array a of length n sorted if a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an\xe2\x88\x921\xe2\x89\xa4an.Ntarsis has an array a of length n. He is allowed to perform one type of operation on it (zero or more times):   Choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).  Add 1 to a1,a2,\xe2\x80\xa6,ai.  Subtract 1 from ai+1,ai+2,\xe2\x80\xa6,an. The values of a can be negative after an operation.Determine the minimum operations needed to make a not sorted." 800.0                       
                         1851G "Vlad and the Mountains" "binary search,data structures,dsu,graphs,implementation,sortings,trees,two pointers" "Vlad decided to go on a trip to the mountains. He plans to move between n mountains, some of which are connected by roads. The i-th mountain has a height of hi.If there is a road between mountains i and j, Vlad can move from mountain i to mountain j by spending hj\xe2\x88\x92hi units of energy. If his energy drops below zero during the transition, he will not be able to move from mountain i to mountain j. Note that hj\xe2\x88\x92hi can be negative and then the energy will be restored.Vlad wants to consider different route options, so he asks you to answer the following queries: is it possible to construct some route starting at mountain a and ending at mountain b, given that he initially has e units of energy?" 2000.0                       
                         1849E "Max to the Right of Min" "binary search,data structures,divide and conquer,dp,dsu,two pointers" "You are given a permutation p of length n \xe2\x80\x94 an array, consisting of integers from 1 to n, all distinct.Let pl,r denote a subarray \xe2\x80\x94 an array formed by writing down elements from index l to index r, inclusive.Let maxposl,r denote the index of the maximum element on pl,r. Similarly, let minposl,r denote the index of the minimum element on it.Calculate the number of subarrays pl,r such that maxposl,r>minposl,r." 2300.0                       
                         1849B Monsters greedy,math,sortings "Monocarp is playing yet another computer game. And yet again, his character is killing some monsters. There are n monsters, numbered from 1 to n, and the i-th of them has ai health points initially.Monocarp\'s character has an ability that deals k damage to the monster with the highest current health. If there are several of them, the one with the smaller index is chosen. If a monster\'s health becomes less than or equal to 0 after Monocarp uses his ability, then it dies.Monocarp uses his ability until all monsters die. Your task is to determine the order in which monsters will die." 1000.0                       
                         1848B "Vika and the Bridge" "binary search,data structures,greedy,implementation,math,sortings" "In the summer, Vika likes to visit her country house. There is everything for relaxation: comfortable swings, bicycles, and a river.There is a wooden bridge over the river, consisting of n planks. It is quite old and unattractive, so Vika decided to paint it. And in the shed, they just found cans of paint of k colors.After painting each plank in one of k colors, Vika was about to go swinging to take a break from work. However, she realized that the house was on the other side of the river, and the paint had not yet completely dried, so she could not walk on the bridge yet.In order not to spoil the appearance of the bridge, Vika decided that she would still walk on it, but only stepping on planks of the same color. Otherwise, a small layer of paint on her sole will spoil the plank of another color. Vika also has a little paint left, but it will only be enough to repaint one plank of the bridge.Now Vika is standing on the ground in front of the first plank. To walk across the bridge, she will choose some planks of the same color (after repainting), which have numbers 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<im\xe2\x89\xa4n (planks are numbered from 1 from left to right). Then Vika will have to cross i1\xe2\x88\x921,i2\xe2\x88\x92i1\xe2\x88\x921,i3\xe2\x88\x92i2\xe2\x88\x921,\xe2\x80\xa6,im\xe2\x88\x92im\xe2\x88\x921\xe2\x88\x921,n\xe2\x88\x92im planks as a result of each of m+1 steps.Since Vika is afraid of falling, she does not want to take too long steps. Help her and tell her the minimum possible maximum number of planks she will have to cross in one step, if she can repaint one (or zero) plank a different color while crossing the bridge." 1200.0                       
                         1848A "Vika and Her Friends" games,math "Vika and her friends went shopping in a mall, which can be represented as a rectangular grid of rooms with sides of length n and m. Each room has coordinates (a,b), where 1\xe2\x89\xa4a\xe2\x89\xa4n,1\xe2\x89\xa4b\xe2\x89\xa4m. Thus we call a hall with coordinates (c,d) a neighbouring for it if |a\xe2\x88\x92c|+|b\xe2\x88\x92d|=1.Tired of empty fashion talks, Vika decided to sneak away unnoticed. But since she hasn\'t had a chance to visit one of the shops yet, she doesn\'t want to leave the mall. After a while, her friends noticed Vika\'s disappearance and started looking for her.Currently, Vika is in a room with coordinates (x,y), and her k friends are in rooms with coordinates (x1,y1), (x2,y2), ... ,(xk,yk), respectively. The coordinates can coincide. Note that all the girls must move to the neighbouring rooms.Every minute, first Vika moves to one of the adjacent to the side rooms of her choice, and then each friend (seeing Vika\'s choice) also chooses one of the adjacent rooms to move to.If at the end of the minute (that is, after all the girls have moved on to the neighbouring rooms) at least one friend is in the same room as Vika, she is caught and all the other friends are called.Tell us, can Vika run away from her annoying friends forever, or will she have to continue listening to empty fashion talks after some time?" 900.0                       
                         1846E2 "Rudolf and Snowflakes (hard version)" "binary search,brute force,implementation,math" "This is the hard version of the problem. The only difference is that in this version n\xe2\x89\xa41018.One winter morning, Rudolf was looking thoughtfully out the window, watching the falling snowflakes. He quickly noticed a certain symmetry in the configuration of the snowflakes. And like a true mathematician, Rudolf came up with a mathematical model of a snowflake.He defined a snowflake as an undirected graph constructed according to the following rules:   Initially, the graph has only one vertex.  Then, more vertices are added to the graph. The initial vertex is connected by edges to k new vertices (k>1).  Each vertex that is connected to only one other vertex is connected by edges to k more new vertices. This step should be done at least once. The smallest possible snowflake for k=4 is shown in the figure.  After some mathematical research, Rudolf realized that such snowflakes may not have any number of vertices. Help Rudolf check whether a snowflake with n vertices can exist." 1800.0                       
                         1844D "Row Major" "constructive algorithms,greedy,math,number theory,strings" "The row-major order of an r\xc3\x97c grid of characters A is the string obtained by concatenating all the rows, i.e. A11A12\xe2\x80\xa6A1cA21A22\xe2\x80\xa6A2c\xe2\x80\xa6Ar1Ar2\xe2\x80\xa6Arc.A grid of characters A is bad if there are some two adjacent cells (cells sharing an edge) with the same character.You are given a positive integer n. Consider all strings s consisting of only lowercase Latin letters such that they are not the row-major order of any bad grid. Find any string with the minimum number of distinct characters among all such strings of length n.It can be proven that at least one such string exists under the constraints of the problem." 1400.0                       
                         1842A "Tenzing and Tsondu" games,math "Tsondu always runs first! ! !Tsondu and Tenzing are playing a card game. Tsondu has n monsters with ability values a1,a2,\xe2\x80\xa6,an while Tenzing has m monsters with ability values b1,b2,\xe2\x80\xa6,bm.Tsondu and Tenzing take turns making moves, with Tsondu going first. In each move, the current player chooses two monsters: one on their side and one on the other side. Then, these monsters will fight each other. Suppose the ability values for the chosen monsters are x and y respectively, then the ability values of the monsters will become x\xe2\x88\x92y and y\xe2\x88\x92x respectively. If the ability value of any monster is smaller than or equal to 0, the monster dies.The game ends when at least one player has no monsters left alive. The winner is the player with at least one monster left alive. If both players have no monsters left alive, the game ends in a draw.Find the result of the game when both players play optimally." 800.0                       
                         1841F "Monocarp and a Strategic Game" "geometry,sortings,two pointers" "Monocarp plays a strategic computer game in which he develops a city. The city is inhabited by creatures of four different races \xe2\x80\x94 humans, elves, orcs, and dwarves.Each inhabitant of the city has a happiness value, which is an integer. It depends on how many creatures of different races inhabit the city. Specifically, the happiness of each inhabitant is 0 by default; it increases by 1 for each other creature of the same race and decreases by 1 for each creature of a hostile race. Humans are hostile to orcs (and vice versa), and elves are hostile to dwarves (and vice versa).At the beginning of the game, Monocarp\'s city is not inhabited by anyone. During the game, n groups of creatures will come to his city, wishing to settle there. The i-th group consists of ai humans, bi orcs, ci elves, and di dwarves. Each time, Monocarp can either accept the entire group of creatures into the city, or reject the entire group.The game calculates Monocarp\'s score according to the following formula: m+k, where m is the number of inhabitants in the city, and k is the sum of the happiness values of all creatures in the city.Help Monocarp earn the maximum possible number of points by the end of the game!" 2700.0                       
                         1840B "Binary Cafe" bitmasks,combinatorics,math "Once upon a time, Toma found himself in a binary cafe. It is a very popular and unusual place.The cafe offers visitors k different delicious desserts. The desserts are numbered from 0 to k\xe2\x88\x921. The cost of the i-th dessert is 2i coins, because it is a binary cafe! Toma is willing to spend no more than n coins on tasting desserts. At the same time, he is not interested in buying any dessert more than once, because one is enough to evaluate the taste.In how many different ways can he buy several desserts (possibly zero) for tasting?" 1100.0                       
                         1839A "The Good Array" greedy,implementation,math "You are given two integers n and k.An array a1,a2,\xe2\x80\xa6,an of length n, consisting of zeroes and ones is good if for all integers i from 1 to n both of the following conditions are satisfied:  at least \xe2\x8c\x88ik\xe2\x8c\x89 of the first i elements of a are equal to 1,  at least \xe2\x8c\x88ik\xe2\x8c\x89 of the last i elements of a are equal to 1. Here, \xe2\x8c\x88ik\xe2\x8c\x89 denotes the result of division of i by k, rounded up. For example, \xe2\x8c\x8863\xe2\x8c\x89=2, \xe2\x8c\x88115\xe2\x8c\x89=\xe2\x8c\x882.2\xe2\x8c\x89=3 and \xe2\x8c\x8874\xe2\x8c\x89=\xe2\x8c\x881.75\xe2\x8c\x89=2.Find the minimum possible number of ones in a good array." 800.0                       
                         1837C "Best Binary String" "constructive algorithms,greedy" "You are given a string s consisting of the characters 0, 1 and/or ?. Let\'s call it a pattern.Let\'s say that the binary string (a string where each character is either 0 or 1) matches the pattern if you can replace each character ? with 0 or 1 (for each character, the choice is independent) so that the strings become equal. For example, 0010 matches ?01?, but 010 doesn\'t match 1??, ??, or ????.Let\'s define the cost of the binary string as the minimum number of operations of the form ""reverse an arbitrary contiguous substring of the string"" required to sort the string in non-descending order.You have to find a binary string with the minimum possible cost among those that match the given pattern. If there are multiple answers, print any of them." 1000.0                       
                         1834F Typewriter "brute force,math" "Recently, Polycarp was given an unusual typewriter as a gift! Unfortunately, the typewriter was defective and had a rather strange design.The typewriter consists of n cells numbered from left to right from 1 to n, and a carriage that moves over them. The typewriter cells contain n distinct integers from 1 to n, and each cell i initially contains the integer pi. Before all actions, the carriage is at cell number 1 and there is nothing in its buffer storage. The cell on which the carriage is located is called the current cell. The carriage can perform five types of operations:  Take the integer from the current cell, if it is not empty, and put it in the carriage buffer, if it is empty (this buffer can contain no more than one integer).  Put the integer from the carriage buffer, if it is not empty, into the current cell, if it is empty.  Swap the number in the carriage buffer with the number in the current cell, if both the buffer and the cell contain integers.  Move the carriage from the current cell i to cell i+1 (if i<n), while the integer in the buffer is preserved.  Reset the carriage, i.e. move it to cell number 1, while the integer in the buffer is preserved. Polycarp was very interested in this typewriter, so he asks you to help him understand it and will ask you q queries of three types:  Perform a cyclic shift of the sequence p to the left by kj.  Perform a cyclic shift of the sequence p to the right by kj.  Reverse the sequence p. Before and after each query, Polycarp wants to know what minimum number of carriage resets is needed for the current sequence in order to distribute the numbers to their cells (so that the number i ends up in cell number i).Note that Polycarp only wants to know the minimum number of carriage resets required to arrange the numbers in their places, but he does not actually distribute them.Help Polycarp find the answers to his queries!" 2500.0                       
                         1834C "Game with Reversing" games,greedy,math,strings "Alice and Bob are playing a game. They have two strings S and T of the same length n consisting of lowercase latin letters. Players take turns alternately, with Alice going first.On her turn, Alice chooses an integer i from 1 to n, one of the strings S or T, and any lowercase latin letter c, and replaces the i-th symbol in the chosen string with the character c.On his turn, Bob chooses one of the strings S or T, and reverses it. More formally, Bob makes the replacement S:=rev(S) or T:=rev(T), where rev(P)=PnPn\xe2\x88\x921\xe2\x80\xa6P1.The game lasts until the strings S and T are equal. As soon as the strings become equal, the game ends instantly.Define the duration of the game as the total number of moves made by both players during the game. For example, if Alice made 2 moves in total, and Bob made 1 move, then the duration of this game is 3.Alice\'s goal is to minimize the duration of the game, and Bob\'s goal is to maximize the duration of the game.What will be the duration of the game, if both players play optimally? It can be shown that the game will end in a finite number of turns." 1200.0                       
                         1833F "Ira and Flamenco" "combinatorics,constructive algorithms,data structures,implementation,math,sortings,two pointers" "Ira loves Spanish flamenco dance very much. She decided to start her own dance studio and found n students, ith of whom has level ai.Ira can choose several of her students and set a dance with them. So she can set a huge number of dances, but she is only interested in magnificent dances. The dance is called magnificent if the following is true:   exactly m students participate in the dance;  levels of all dancers are pairwise distinct;  levels of every two dancers have an absolute difference strictly less than m. For example, if m=3 and a=[4,2,2,3,6], the following dances are magnificent (students participating in the dance are highlighted in red): [4,2,2,3,6], [4,2,2,3,6]. At the same time dances [4,2,2,3,6], [4,2,2,3,6], [4,2,2,3,6] are not magnificent.In the dance [4,2,2,3,6] only 2 students participate, although m=3.The dance [4,2,2,3,6] involves students with levels 2 and 2, although levels of all dancers must be pairwise distinct.In the dance [4,2,2,3,6] students with levels 3 and 6 participate, but |3\xe2\x88\x926|=3, although m=3.Help Ira count the number of magnificent dances that she can set. Since this number can be very large, count it modulo 109+7. Two dances are considered different if the sets of students participating in them are different." 1700.0                       
                         1829A "Love Story" implementation,strings "Timur loves codeforces. That\'s why he has a string s having length 10 made containing only lowercase Latin letters. Timur wants to know how many indices string s differs from the string ""codeforces"".For example string s= ""coolforsez"" differs from ""codeforces"" in 4 indices, shown in bold.Help Timur by finding the number of indices where string s differs from ""codeforces"".Note that you can\'t reorder the characters in the string s." 800.0                       
                         1827F "Copium Permutation" "constructive algorithms,data structures,greedy" "You are given a permutation a1,a2,\xe2\x80\xa6,an of the first n positive integers. A subarray [l,r] is called copium if we can rearrange it so that it becomes a sequence of consecutive integers, or more formally, if max(al,al+1,\xe2\x80\xa6,ar)\xe2\x88\x92min(al,al+1,\xe2\x80\xa6,ar)=r\xe2\x88\x92l For each k in the range [0,n], print out the maximum number of copium subarrays of a over all ways of rearranging the last n\xe2\x88\x92k elements of a." 3500.0                       
                         1827E "Bus Routes" "binary search,constructive algorithms,dfs and similar,greedy,trees" "There is a country consisting of n cities and n\xe2\x88\x921 bidirectional roads connecting them such that we can travel between any two cities using these roads. In other words, these cities and roads form a tree.There are m bus routes connecting the cities together. A bus route between city x and city y allows you to travel between any two cities in the simple path between x and y with this route.Determine if for every pair of cities u and v, you can travel from u to v using at most two bus routes." 3400.0                       
                         1827B2 "Range Sorting (Hard Version)" "binary search,data structures,dp,greedy" "The only difference between this problem and the easy version is the constraints on t and n.You are given an array a, consisting of n distinct integers a1,a2,\xe2\x80\xa6,an. Define the beauty of an array p1,p2,\xe2\x80\xa6pk as the minimum amount of time needed to sort this array using an arbitrary number of range-sort operations. In each range-sort operation, you will do the following:   Choose two integers l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4k).  Sort the subarray pl,pl+1,\xe2\x80\xa6,pr in r\xe2\x88\x92l seconds. Please calculate the sum of beauty over all subarrays of array a.A subarray of an array is defined as a sequence of consecutive elements of the array." 2400.0                       
                         1821F Timber combinatorics,dp,fft,math "There is a beautiful alley with trees in front of a shopping mall. Unfortunately, it has to go to make space for the parking lot.The trees on the alley all grow in a single line. There are n spots for trees, index 0 is the shopping mall, index n+1 is the road and indices from 1 to n are the spots for trees. Some of them are taken \xe2\x80\x94 there grow trees of the same height k. No more than one tree grows in each spot.When you chop down a tree in the spot x, you can make it fall either left or right. If it falls to the left, it takes up spots from x\xe2\x88\x92k to x, inclusive. If it falls to the right, it takes up spots from x to x+k, inclusive.Let m trees on the alley grow in some spots x1,x2,\xe2\x80\xa6,xm. Let an alley be called unfortunate if all m trees can be chopped down in such a way that:   no tree falls on the shopping mall or the road;  each spot is taken up by no more than one fallen tree. Calculate the number of different unfortunate alleys with m trees of height k. Two alleys are considered different if there is a spot y such that a tree grows in y on the first alley and doesn\'t grow in y on the second alley.Output the number modulo 998244353." 2600.0                       
                         1821B "Sort the Subarray" "brute force,greedy" "Monocarp had an array a consisting of n integers. He has decided to choose two integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, and then sort the subarray a[l..r] (the subarray a[l..r] is the part of the array a containing the elements al,al+1,al+2,\xe2\x80\xa6,ar\xe2\x88\x921,ar) in non-descending order. After sorting the subarray, Monocarp has obtained a new array, which we denote as a\xe2\x80\xb2.For example, if a=[6,7,3,4,4,6,5], and Monocarp has chosen l=2,r=5, then a\xe2\x80\xb2=[6,3,4,4,7,6,5].You are given the arrays a and a\xe2\x80\xb2. Find the integers l and r that Monocarp could have chosen. If there are multiple pairs of values (l,r), find the one which corresponds to the longest subarray." 1100.0                       
                         1819A "Constructive Problem" "brute force,greedy" "As you know, any problem that does not require the use of complex data structures is considered constructive. You are offered to solve one of such problems.You are given an array a of n non-negative integers. You are allowed to perform the following operation exactly once: choose some non-empty subsegment al,al+1,\xe2\x80\xa6,ar of the array a and a non-negative integer k, and assign value k to all elements of the array on the chosen subsegment.The task is to find out whether MEX(a) can be increased by exactly one by performing such an operation. In other words, if before the operation MEX(a)=m held, then after the operation it must hold that MEX(a)=m+1.Recall that MEX of a set of integers c1,c2,\xe2\x80\xa6,ck is defined as the smallest non-negative integer x which does not occur in the set c." 1300.0                       
                         1817D "Toy Machine" "constructive algorithms,games,implementation" "There is a toy machine with toys arranged in two rows of n cells each (n is odd).  Initial state for n=9. Initially, n\xe2\x88\x922 toys are placed in the non-corner cells of the top row. The bottom row is initially empty, and its leftmost, rightmost, and central cells are blocked. There are 4 buttons to control the toy machine: left, right, up, and down marked by the letters L, R, U, and D correspondingly.When pressing L, R, U, or D, all the toys will be moved simultaneously in the corresponding direction and will only stop if they push into another toy, the wall or a blocked cell. Your goal is to move the k-th toy into the leftmost cell of the top row. The toys are numbered from 1 to n\xe2\x88\x922 from left to right. Given n and k, find a solution that uses at most 1000000 button presses.To test out the toy machine, a web page is available that lets you play the game in real time." 2700.0                       
                         1816A "Ian Visits Mary" "constructive algorithms,geometry,number theory" "Ian and Mary are frogs living on lattice points of the Cartesian coordinate plane, with Ian living on (0,0) and Mary living on (a,b). Ian would like to visit Mary by jumping around the Cartesian coordinate plane. Every second, he jumps from his current position (xp,yp) to another lattice point (xq,yq), such that no lattice point other than (xp,yp) and (xq,yq) lies on the segment between point (xp,yp) and point (xq,yq). As Ian wants to meet Mary as soon as possible, he wants to jump towards point (a,b) using at most 2 jumps. Unfortunately, Ian is not good at maths. Can you help him?A lattice point is defined as a point with both the x-coordinate and y-coordinate being integers." 800.0                       
                         1814F "Communication Towers" "brute force,divide and conquer,dsu" "There are n communication towers, numbered from 1 to n, and m bidirectional wires between them. Each tower has a certain set of frequencies that it accepts, the i-th of them accepts frequencies from li to ri.Let\'s say that a tower b is accessible from a tower a, if there exists a frequency x and a sequence of towers a=v1,v2,\xe2\x80\xa6,vk=b, where consecutive towers in the sequence are directly connected by a wire, and each of them accepts frequency x. Note that accessibility is not transitive, i.\xe2\x80\x89e if b is accessible from a and c is accessible from b, then c may not be accessible from a.Your task is to determine the towers that are accessible from the 1-st tower." 2700.0                       
                         1814B "Long Legs" "brute force,math" "A robot is placed in a cell (0,0) of an infinite grid. This robot has adjustable length legs. Initially, its legs have length 1.Let the robot currently be in the cell (x,y) and have legs of length m. In one move, it can perform one of the following three actions:   jump into the cell (x+m,y);  jump into the cell (x,y+m);  increase the length of the legs by 1, i.\xe2\x80\x89e. set it to m+1. What\'s the smallest number of moves robot has to make to reach a cell (a,b)?" 1700.0                       
                         1812D "Trivial Conjecture" "*special problem,constructive algorithms,math,number theory" "f(n)={n2n\xe2\x89\xa10(mod2)3n+1n\xe2\x89\xa11(mod2)Find an integer n so that none of the first k terms of the sequence n,f(n),f(f(n)),f(f(f(n))),\xe2\x80\xa6 are equal to 1." -999.0                       
                         1810C "Make It Permutation" "brute force,greedy,sortings" "You have an integer array a of length n. There are two kinds of operations you can make.  Remove an integer from a. This operation costs c. Insert an arbitrary positive integer x to any position of a (to the front, to the back, or between any two consecutive elements). This operation costs d.You want to make the final array a permutation of any positive length. Please output the minimum cost of doing that. Note that you can make the array empty during the operations, but the final array must contain at least one integer.A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1300.0                       
                         1808B "Playing in a Casino" math,sortings "Galaxy Luck, a well-known casino in the entire solar system, introduces a new card game.In this game, there is a deck that consists of n cards. Each card has m numbers written on it. Each of the n players receives exactly one card from the deck.Then all players play with each other in pairs, and each pair of players plays exactly once. Thus, if there are, for example, four players in total, then six games are played: the first against the second, the first against the third, the first against the fourth, the second against the third, the second against the fourth and the third against the fourth.Each of these games determines the winner in some way, but the rules are quite complicated, so we will not describe them here. All that matters is how many chips are paid out to the winner. Let the first player\'s card have the numbers a1,a2,\xe2\x80\xa6,am, and the second player\'s card \xe2\x80\x94 b1,b2,\xe2\x80\xa6,bm. Then the winner of the game gets |a1\xe2\x88\x92b1|+|a2\xe2\x88\x92b2|+\xe2\x8b\xaf+|am\xe2\x88\x92bm| chips from the total pot, where |x| denotes the absolute value of x.To determine the size of the total pot, it is necessary to calculate the winners\' total winnings for all games. Since there can be many cards in a deck and many players, you have been assigned to write a program that does all the necessary calculations." 1200.0                       
                         1807G1 "Subsequence Addition (Easy Version)" "brute force,data structures,dp,greedy,implementation,sortings" "The only difference between the two versions is that in this version, the constraints are lower.Initially, array a contains just the number 1. You can perform several operations in order to change the array. In an operation, you can select some subsequence\xe2\x80\xa0 of a and add into a an element equal to the sum of all elements of the subsequence. You are given a final array c. Check if c can be obtained from the initial array a by performing some number (possibly 0) of operations on the initial array.\xe2\x80\xa0 A sequence b is a subsequence of a sequence a if b can be obtained from a by the deletion of several (possibly zero, but not all) elements. In other words, select k (1\xe2\x89\xa4k\xe2\x89\xa4|a|) distinct indices i1,i2,\xe2\x80\xa6,ik and insert anywhere into a a new element with the value equal to ai1+ai2+\xe2\x8b\xaf+aik." 1100.0                       
                         1806B "Mex Master" "constructive algorithms,greedy" "You are given an array a of length n. The score of a is the MEX\xe2\x80\xa0 of [a1+a2,a2+a3,\xe2\x80\xa6,an\xe2\x88\x921+an]. Find the minimum score of a if you are allowed to rearrange elements of a in any order. Note that you are not required to construct the array a that achieves the minimum score.\xe2\x80\xa0 The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:  The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4 because 0, 1, 2, and 3 belong to the array, but 4 does not." 900.0                       
                         1805F2 "Survival of the Weakest (hard version)" "greedy,math,sortings,two pointers" "This is the hard version of the problem. It differs from the easy one only in constraints on n. You can make hacks only if you lock both versions.Let a1,a2,\xe2\x80\xa6,an be an array of non-negative integers. Let F(a1,a2,\xe2\x80\xa6,an) be the sorted in the non-decreasing order array of n\xe2\x88\x921 smallest numbers of the form ai+aj, where 1\xe2\x89\xa4i<j\xe2\x89\xa4n. In other words, F(a1,a2,\xe2\x80\xa6,an) is the sorted in the non-decreasing order array of n\xe2\x88\x921 smallest sums of all possible pairs of elements of the array a1,a2,\xe2\x80\xa6,an. For example, F(1,2,5,7)=[1+2,1+5,2+5]=[3,6,7].You are given an array of non-negative integers a1,a2,\xe2\x80\xa6,an. Determine the single element of the array F(F(F\xe2\x80\xa6F\xe2\x8f\x9fn\xe2\x88\x921(a1,a2,\xe2\x80\xa6,an)\xe2\x80\xa6)). Since the answer can be quite large, output it modulo 109+7." 3100.0                       
                         1805C "Place for a Selfie" "binary search,data structures,geometry,math" "The universe is a coordinate plane. There are n space highways, each of which is a straight line y=kx passing through the origin (0,0). Also, there are m asteroid belts on the plane, which we represent as open upwards parabolas, i. e. graphs of functions y=ax2+bx+c, where a>0.You want to photograph each parabola. To do this, for each parabola you need to choose a line that does not intersect this parabola and does not touch it. You can select the same line for different parabolas. Please find such a line for each parabola, or determine that there is no such line." 1400.0                       
                         1805B "The String Has a Target" greedy,strings "You are given a string s. You can apply this operation to the string exactly once: choose index i and move character si to the beginning of the string (removing it at the old position). For example, if you apply the operation with index i=4 to the string ""abaacd"" with numbering from 1, you get the string ""aabacd"". What is the lexicographically minimal\xe2\x80\xa0 string you can obtain by this operation?\xe2\x80\xa0A string a is lexicographically smaller than a string b of the same length if and only if the following holds:   in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 800.0                       
                         1804H "Code Lock" bitmasks,dp "Lara has a safe that is locked with a circle-shaped code lock that consists of a rotating arrow, a static circumference around the arrow, an input screen, and an input button.The circumference of the lock is split into k equal sections numbered from 1 to k in clockwise order. Arrow always points to one of the sections. Each section is marked with one of the first k letters of the English alphabet. No two sections are marked with the same letter.Due to the lock limitations, the safe\'s password is a string of length n that consists of first k letters of the English alphabet only. Lara enters the password by rotating the lock\'s arrow and pressing the input button. Initially, the lock\'s arrow points to section 1 and the input screen is empty. In one second she can do one of the following actions.   Rotate the arrow one section clockwise. If the arrow was pointing at section x<k it will now point at section x+1. If the arrow was pointing at section k it will now point at section 1.  Rotate the arrow one section counter-clockwise. If the arrow was pointing at section x>1 it will now point at section x\xe2\x88\x921. If the arrow was pointing at section 1 it will now point at section k.  Press the input button. The letter marked on the section that the arrow points to will be added to the content of the input screen.  As soon as the content of the input screen matches the password, the safe will open. Lara always enters her password in the minimum possible time.Lara has recently found out that the safe can be re-programmed. She can take the first k letters of the English alphabet and assign them to the sectors in any order she likes. Now she wants to re-arrange the letters in a way that will minimize the number of seconds it takes her to input the password. Compute this minimum number of seconds and the number of ways to assign letters, for which this minimum number of seconds is achieved.Two ways to assign letters to sectors are considered to be distinct if there exists at least one sector i that is assigned different letters." 3300.0                       
                         1804C "Pull Your Luck" "brute force,greedy,math,number theory" "While James is gone on business, Vesper takes her time and explores what the legendary Casino Royale has to offer to people who are fond of competitive programming.Her attention was grabbed by the very new ""Pull Your Luck"" roulette which functions in a pretty peculiar way. The roulette\'s wheel consists of n sectors number from 0 to n\xe2\x88\x921. There is no ball and the winning sector is determined by a static arrow pointing to one of the sectors. Sectors\' indexes go in the natural order and the wheel always spins in the direction of indexes increment. That means that sector i+1 goes right after sector i for all i from 0 to n\xe2\x88\x922, and sector 0 goes right after sector n\xe2\x88\x921.After a bet is made, the player is allowed to pull the triggering handle herself and cause the wheel to spin. If the player\'s initial pull is made with the force equal to positive integer f, the wheel will spin for f seconds. During the first second it will advance f sectors, the next second it will advance f\xe2\x88\x921 sectors, then f\xe2\x88\x922 sectors, and so on until it comes to a complete stop. After the wheel comes to a complete stop, the sector which the arrow is pointing to is the winning one.The roulette\'s arrow currently points at sector x. Vesper knows that she can pull the handle with any integer force from 1 to p inclusive. Note that it is not allowed to pull the handle with force 0, i. e. not pull it all. The biggest prize is awarded if the winning sector is 0. Now Vesper wonders if she can make sector 0 win by pulling the triggering handle exactly once?" 1500.0                       
                         1799E "City Union" "constructive algorithms,dfs and similar,dsu,geometry,greedy,implementation,math" "You are given n\xc3\x97m grid. Some cells are filled and some are empty.A city is a maximal (by inclusion) set of filled cells such that it is possible to get from any cell in the set to any other cell in the set by moving to adjacent (by side) cells, without moving into any cells not in the set. In other words, a city is a connected component of filled cells with edges between adjacent (by side) cells.Initially, there are two cities on the grid. You want to change some empty cells into filled cells so that both of the following are satisfied:   There is one city on the resulting grid.  The shortest path between any two filled cells, achievable only by moving onto filled cells, is equal to the Manhattan distance between them. The Manhattan distance between two cells (a,b) and (c,d) is equal to |a\xe2\x88\x92c|+|b\xe2\x88\x92d|.Find a way to add filled cells that satisfies these conditions and minimizes the total number of filled cells." 2300.0                       
                         1798F "Gifts from Grandfather Ahmed" "dp,math,number theory" "Grandfather Ahmed\'s School has n+1 students. The students are divided into k classes, and si students study in the i-th class. So, s1+s2+\xe2\x80\xa6+sk=n+1.Due to the upcoming April Fools\' Day, all students will receive gifts!Grandfather Ahmed planned to order n+1 boxes of gifts. Each box can contain one or more gifts. He plans to distribute the boxes between classes so that the following conditions are satisfied:  Class number i receives exactly si boxes (so that each student can open exactly one box).  The total number of gifts in the boxes received by the i-th class should be a multiple of si (it should be possible to equally distribute the gifts among the si students of this class). Unfortunately, Grandfather Ahmed ordered only n boxes with gifts, the i-th of which contains ai gifts.Ahmed has to buy the missing gift box, and the number of gifts in the box should be an integer between 1 and 106. Help Ahmed to determine, how many gifts should the missing box contain, and build a suitable distribution of boxes to classes, or report that this is impossible." 2500.0                       
                         1797C "Li Hua and Chess" "constructive algorithms,greedy,interactive" "This is an interactive problem.Li Ming and Li Hua are playing a game. Li Hua has a chessboard of size n\xc3\x97m. Denote (r,c) (1\xe2\x89\xa4r\xe2\x89\xa4n,1\xe2\x89\xa4c\xe2\x89\xa4m) as the cell on the r-th row from the top and on the c-th column from the left. Li Ming put a king on the chessboard and Li Hua needs to guess its position.Li Hua can ask Li Ming no more than 3 questions. In each question, he can choose a cell and ask the minimum steps needed to move the king to the chosen cell. Each question is independent, which means the king doesn\'t actually move.A king can move from (x,y) to (x\xe2\x80\xb2,y\xe2\x80\xb2) if and only if max{|x\xe2\x88\x92x\xe2\x80\xb2|,|y\xe2\x88\x92y\xe2\x80\xb2|}=1 (shown in the following picture).  The position of the king is chosen before the interaction.Suppose you were Li Hua, please solve this problem." 1600.0                       
                         1797A "Li Hua and Maze" "constructive algorithms,flows,graphs,greedy,implementation" "There is a rectangular maze of size n\xc3\x97m. Denote (r,c) as the cell on the r-th row from the top and the c-th column from the left. Two cells are adjacent if they share an edge. A path is a sequence of adjacent empty cells.Each cell is initially empty. Li Hua can choose some cells (except (x1,y1) and (x2,y2)) and place an obstacle in each of them. He wants to know the minimum number of obstacles needed to be placed so that there isn\'t a path from (x1,y1) to (x2,y2).Suppose you were Li Hua, please solve this problem." 800.0                       
                         1793F Rebrending "brute force,data structures,divide and conquer,implementation" "Kostya and Zhenya \xe2\x80\x94 the creators of the band ""Paper"" \xe2\x80\x94 after the release of the legendary album decided to create a new band ""Day movers"", for this they need to find two new people.They invited n people to the casting. The casting will last q days. On the ith of the days, Kostya and Zhenya want to find two people on the segment from li to ri who are most suitable for their band. Since ""Day movers"" are doing a modern art, musical skills are not important to them and they look only at other signs: they want the height difference between two people to be as small as possible.Help them, and for each day, find the minimum difference in the growth of people from the casting on this segment!" 2600.0                       
                         1792D "Fixed Prefix Permutations" "binary search,bitmasks,data structures,hashing,math,sortings" "You are given n permutations a1,a2,\xe2\x80\xa6,an, each of length m. Recall that a permutation of length m is a sequence of m distinct integers from 1 to m.Let the beauty of a permutation p1,p2,\xe2\x80\xa6,pm be the largest k such that p1=1,p2=2,\xe2\x80\xa6,pk=k. If p1\xe2\x89\xa01, then the beauty is 0.The product of two permutations p\xe2\x8b\x85q is a permutation r such that rj=qpj.For each i from 1 to n, print the largest beauty of a permutation ai\xe2\x8b\x85aj over all j from 1 to n (possibly, i=j)." 1700.0                       
                         1789A "Serval and Mocha\'s Array" "brute force,math,number theory" "Mocha likes arrays, and Serval gave her an array consisting of positive integers as a gift.Mocha thinks that for an array of positive integers a, it is good iff the greatest common divisor of all the elements in a is no more than its length. And for an array of at least 2 positive integers, it is beautiful iff all of its prefixes whose length is no less than 2 are good. For example:  [3,6] is not good, because gcd(3,6)=3 is greater than its length 2.  [1,2,4] is both good and beautiful, because all of its prefixes whose length is no less than 2, which are [1,2] and [1,2,4], are both good.  [3,6,1] is good but not beautiful, because [3,6] is not good. Now Mocha gives you the gift array a of n positive integers, and she wants to know whether array a could become beautiful by reordering the elements in a. It is allowed to keep the array a unchanged." 800.0                       
                         1787E "The Harmonization of XOR" "bitmasks,constructive algorithms,greedy,math" "You are given an array of exactly n numbers [1,2,3,\xe2\x80\xa6,n] along with integers k and x.Partition the array in exactly k non-empty disjoint subsequences such that the bitwise XOR of all numbers in each subsequence is x, and each number is in exactly one subsequence. Notice that there are no constraints on the length of each subsequence.A sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) elements.For example, for n=15, k=6, x=7, the following scheme is valid:   [6,10,11], 6\xe2\x8a\x9510\xe2\x8a\x9511=7,  [5,12,14], 5\xe2\x8a\x9512\xe2\x8a\x9514=7,  [3,9,13], 3\xe2\x8a\x959\xe2\x8a\x9513=7,  [1,2,4], 1\xe2\x8a\x952\xe2\x8a\x954=7,  [8,15], 8\xe2\x8a\x9515=7,  [7], 7=7,  where \xe2\x8a\x95 represents the bitwise XOR operation.The following scheme is invalid, since 8, 15 do not appear:   [6,10,11], 6\xe2\x8a\x9510\xe2\x8a\x9511=7,  [5,12,14], 5\xe2\x8a\x9512\xe2\x8a\x9514=7,  [3,9,13], 3\xe2\x8a\x959\xe2\x8a\x9513=7,  [1,2,4], 1\xe2\x8a\x952\xe2\x8a\x954=7,  [7], 7=7. The following scheme is invalid, since 3 appears twice, and 1, 2 do not appear:   [6,10,11], 6\xe2\x8a\x9510\xe2\x8a\x9511=7,  [5,12,14], 5\xe2\x8a\x9512\xe2\x8a\x9514=7,  [3,9,13], 3\xe2\x8a\x959\xe2\x8a\x9513=7,  [3,4], 3\xe2\x8a\x954=7,  [8,15], 8\xe2\x8a\x9515=7,  [7], 7=7." 2100.0                       
                         1786B "Cake Assembly Line" "brute force,sortings" "A cake assembly line in a bakery was once again optimized, and now n cakes are made at a time! In the last step, each of the n cakes should be covered with chocolate.Consider a side view on the conveyor belt, let it be a number line. The i-th cake occupies the segment [ai\xe2\x88\x92w,ai+w] on this line, each pair of these segments does not have common points. Above the conveyor, there are n dispensers, and when a common button is pressed, chocolate from the i-th dispenser will cover the conveyor segment [bi\xe2\x88\x92h,bi+h]. Each pair of these segments also does not have common points.  Cakes and dispensers corresponding to the first example. The calibration of this conveyor belt part has not yet been performed, so you are to make it. Determine if it\'s possible to shift the conveyor so that each cake has some chocolate on it, and there is no chocolate outside the cakes. You can assume that the conveyour is long enough, so the cakes never fall. Also note that the button can only be pressed once.  In the first example we can shift the cakes as shown in the picture." 1300.0                       
                         1780D "Bit Guessing Game" "binary search,bitmasks,constructive algorithms,interactive" "This is an interactive problem.Kira has a hidden positive integer n, and Hayato needs to guess it.Initially, Kira gives Hayato the value cnt \xe2\x80\x94 the number of unit bits in the binary notation of n. To guess n, Hayato can only do operations of one kind: choose an integer x and subtract it from n. Note that after each operation, the number n changes. Kira doesn\'t like bad requests, so if Hayato tries to subtract a number x greater than n, he will lose to Kira. After each operation, Kira gives Hayato the updated value cnt \xe2\x80\x94 the number of unit bits in the binary notation of the updated value of n.Kira doesn\'t have much patience, so Hayato must guess the original value of n after no more than 30 operations.Since Hayato is in elementary school, he asks for your help. Write a program that guesses the number n. Kira is an honest person, so he chooses the initial number n before all operations and does not change it afterward." 1800.0                       
                         1779H "Olympic Team Building" "brute force,meet-in-the-middle" "Iron and Werewolf are participating in a chess Olympiad, so they want to practice team building. They gathered n players, where n is a power of 2, and they will play sports. Iron and Werewolf are among those n people.One of the sports is tug of war. For each 1\xe2\x89\xa4i\xe2\x89\xa4n, the i-th player has strength si. Elimination rounds will be held until only one player remains \xe2\x80\x94 we call that player the absolute winner.In each round:   Assume that m>1 players are still in the game, where m is a power of 2.  The m players are split into two teams of equal sizes (i. e., with m/2 players in each team). The strength of a team is the sum of the strengths of its players.  If the teams have equal strengths, Iron chooses who wins; otherwise, the stronger team wins.  Every player in the losing team is eliminated, so m/2 players remain. Iron already knows each player\'s strength and is wondering who can become the absolute winner and who can\'t if he may choose how the teams will be formed in each round, as well as the winning team in case of equal strengths." 3500.0                       
                         1779D "Boris and His Amazing Haircut" "constructive algorithms,data structures,dp,dsu,greedy,sortings" "Boris thinks that chess is a tedious game. So he left his tournament early and went to a barber shop as his hair was a bit messy.His current hair can be described by an array a1,a2,\xe2\x80\xa6,an, where ai is the height of the hair standing at position i. His desired haircut can be described by an array b1,b2,\xe2\x80\xa6,bn in a similar fashion.The barber has m razors. Each has its own size and can be used at most once. In one operation, he chooses a razor and cuts a segment of Boris\'s hair. More formally, an operation is:  Choose any razor which hasn\'t been used before, let its size be x;  Choose a segment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n);  Set ai:=min(ai,x) for each l\xe2\x89\xa4i\xe2\x89\xa4r; Notice that some razors might have equal sizes \xe2\x80\x94 the barber can choose some size x only as many times as the number of razors with size x. He may perform as many operations as he wants, as long as any razor is used at most once and ai=bi for each 1\xe2\x89\xa4i\xe2\x89\xa4n at the end. He does not have to use all razors.Can you determine whether the barber can give Boris his desired haircut?" 1700.0                       
                         1779B "MKnez\'s ConstructiveForces Task" "constructive algorithms,math" "MKnez wants to construct an array s1,s2,\xe2\x80\xa6,sn satisfying the following conditions:  Each element is an integer number different from 0;  For each pair of adjacent elements their sum is equal to the sum of the whole array. More formally, si\xe2\x89\xa00 must hold for each 1\xe2\x89\xa4i\xe2\x89\xa4n. Moreover, it must hold that s1+s2+\xe2\x8b\xaf+sn=si+si+1 for each 1\xe2\x89\xa4i<n.Help MKnez to construct an array with these properties or determine that it does not exist." 900.0                       
                         1777A "Everybody Likes Good Arrays!" greedy,math "An array a is good if for all pairs of adjacent elements, ai and ai+1 (1\xe2\x89\xa4i<n) are of different parity. Note that an array of size 1 is trivially good.You are given an array of size n. In one operation you can select any pair of adjacent elements in which both elements are of the same parity, delete them, and insert their product in the same position.Find the minimum number of operations to form a good array." 800.0                       
                         1776M "Parmigiana With Seafood" "binary search,dp,greedy,trees" "The ""Parmigiana di melanzane"" is a typical Italian dish. Alessandro and Bianca have very different tastes when it comes to it: Alessandro loves to eat Parmigiana with seafood, but Bianca thinks it is an atrocity! To decide which ingredients to include in the dish they prepare, they play the following game.There are n possible ingredients, labeled from 1 to n. The higher the label, the closer the ingredient is to being seafood. The ingredients are connected by n\xe2\x88\x921 edges, in such a way as to form a tree. Alessandro and Bianca take turns, with Alessandro going first. They alternately choose a terminal ingredient x, that is an ingredient currently connected to at most one other ingredient, and remove it from the tree. If the terminal ingredient x was chosen by Alessandro, it goes in the recipe; if it was chosen by Bianca, it is discarded.The taste of the Parmigiana is measured as the maximum label of an ingredient in the recipe. Alessandro wants to maximize the taste, while Bianca wants to minimize the taste. If both play optimally, what is the taste of the Parmigiana?" 3000.0                       
                         1775D "Friendly Spiders" "dfs and similar,graphs,math,number theory,shortest paths" "Mars is home to an unusual species of spiders \xe2\x80\x94 Binary spiders.Right now, Martian scientists are observing a colony of nn spiders, the ii-th of which has aiai legs.Some of the spiders are friends with each other. Namely, the ii-th and jj-th spiders are friends if gcd(ai,aj)\xe2\x89\xa01gcd(ai,aj)\xe2\x89\xa01, i. e., there is some integer k\xe2\x89\xa52k\xe2\x89\xa52 such that aiai and ajaj are simultaneously divided by kk without a remainder. Here gcd(x,y)gcd(x,y) denotes the greatest common divisor (GCD) of integers xx and yy.Scientists have discovered that spiders can send messages. If two spiders are friends, then they can transmit a message directly in one second. Otherwise, the spider must pass the message to his friend, who in turn must pass the message to his friend, and so on until the message reaches the recipient.Let\'s look at an example.Suppose a spider with eight legs wants to send a message to a spider with 1515 legs. He can\'t do it directly, because gcd(8,15)=1gcd(8,15)=1. But he can send a message through the spider with six legs because gcd(8,6)=2gcd(8,6)=2 and gcd(6,15)=3gcd(6,15)=3. Thus, the message will arrive in two seconds.Right now, scientists are observing how the ss-th spider wants to send a message to the tt-th spider. The researchers have a hypothesis that spiders always transmit messages optimally. For this reason, scientists would need a program that could calculate the minimum time to send a message and also deduce one of the optimal routes." 1800.0                       
                         1774E "Two Chess Pieces" "dfs and similar,dp,greedy,trees" "Cirno_9baka has a tree with n nodes. He is willing to share it with you, which means you can operate on it.Initially, there are two chess pieces on the node 1 of the tree. In one step, you can choose any piece, and move it to the neighboring node. You are also given an integer d. You need to ensure that the distance between the two pieces doesn\'t ever exceed d.Each of these two pieces has a sequence of nodes which they need to pass in any order, and eventually, they have to return to the root. As a curious boy, he wants to know the minimum steps you need to take." 1900.0                       
                         1774A "Add Plus Minus Sign" "constructive algorithms,math" "AquaMoon has a string a consisting of only 0 and 1. She wants to add + and \xe2\x88\x92 between all pairs of consecutive positions to make the absolute value of the resulting expression as small as possible. Can you help her?" 800.0                       
                         1773H "Hot and Cold" "binary search,interactive" "This is an interactive problem.After emigrating to another country, little Hanna came across the fact that playing ""Hot and cold"" became more difficult: she does not understand the hint phrases! You are to write a helping program for her.The playground where the game happens is a rectangle, and the treasure is hidden in some point with integer coordinates between 0 and 106, inclusive. Hanna visits several points with valid coordinates. If the visited point contains the hidden treasure, she receives the phrase ""Found!"" in the local language. Fortunately, the intonations allow her to recognize this phrase \xe2\x80\x94 in this problem it will be denoted by an exclamation mark.Otherwise, for each visited point except for the first one, Hanna receives a phrase in the local language stating whether she is now ""Closer"", ""Further"", or ""At the same distance"" from the treasure, compared to the previous point. The distances are measured in Euclidean metric. After the first visited point, in case of no treasure there, Hanna receives the phrase ""Not found"" in the local language.Your program must help Hanna find the treasure by visiting at most 64 points." 2600.0                       
                         1772G "Gaining Rating" "binary search,greedy,implementation,math,sortings,two pointers" "Monocarp is playing chess on one popular website. He has n opponents he can play with. The i-th opponent has rating equal to ai. Monocarp\'s initial rating is x. Monocarp wants to raise his rating to the value y (y>x).When Monocarp is playing against one of the opponents, he will win if his current rating is bigger or equal to the opponent\'s rating. If Monocarp wins, his rating is increased by 1, otherwise it is decreased by 1. The rating of his opponent does not change.Monocarp wants to gain rating y playing as few games as possible. But he can\'t just grind it, playing against weak opponents. The website has a rule that you should play against all opponents as evenly as possible. Speaking formally, if Monocarp wants to play against an opponent i, there should be no other opponent j such that Monocarp has played more games against i than against j.Calculate the minimum possible number of games Monocarp needs to gain rating y or say it\'s impossible. Note that ratings of Monocarp\'s opponents don\'t change, while Monocarp\'s rating does change." 2200.0                       
                         1772A A+B? implementation "You are given an expression of the form a+b, where a and b are integers from 0 to 9. You have to evaluate it and print the result." 800.0                       
                         1770B "Koxia and Permutation" "constructive algorithms" "Reve has two integers n and k.Let p be a permutation\xe2\x80\xa0 of length n. Let c be an array of length n\xe2\x88\x92k+1 such that ci=max(pi,\xe2\x80\xa6,pi+k\xe2\x88\x921)+min(pi,\xe2\x80\xa6,pi+k\xe2\x88\x921). Let the cost of the permutation p be the maximum element of c.Koxia wants you to construct a permutation with the minimum possible cost.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1000.0                       
                         1769A "\xd0\xa3\xd0\xb7\xd0\xba\xd0\xb0\xd1\x8f \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb0" "*special problem,math" "\xd0\x9a\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xbd\xd0\xbd\xd0\xb0 \xd0\xb8\xd0\xb7 n \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2 \xd0\xb5\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xbf\xd0\xbe \xd1\x83\xd0\xb7\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd0\xbd\xd0\xb5\xd0\xb9 \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb5 \xd0\xb2 \xd0\xbf\xd1\x83\xd0\xbd\xd0\xba\xd1\x82 \xd0\x91. \xd0\xa1\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd1\x8b \xd0\xbf\xd1\x80\xd0\xbe\xd0\xbd\xd1\x83\xd0\xbc\xd0\xb5\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd1\x8b \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe n. \xd0\x94\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd0\xb0 i \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd1\x82\xd0\xb5\xd0\xba\xd1\x83\xd1\x89\xd0\xb5\xd0\xb5 \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbe\xd1\x82 \xd0\xbd\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xb4\xd0\xbe \xd0\xbf\xd1\x83\xd0\xbd\xd0\xba\xd1\x82\xd0\xb0 \xd0\x91 \xd1\x80\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xbe ai \xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xbe\xd0\xb2. \xd0\x9f\xd1\x80\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc a1<a2<\xe2\x80\xa6<an, \xd0\xb2 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8, \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 1 \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb1\xd0\xbb\xd0\xb8\xd0\xb6\xd0\xb5 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xba \xd0\xbf\xd1\x83\xd0\xbd\xd0\xba\xd1\x82\xd1\x83 \xd0\x91, \xd0\xb0 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 n \xe2\x80\x94 \xd0\xb4\xd0\xb0\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe.\xd0\xa1\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd1\x81 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80\xd0\xbe\xd0\xbc i \xd0\xb4\xd0\xb2\xd0\xb8\xd0\xb6\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd1\x83 \xd0\xbf\xd1\x83\xd0\xbd\xd0\xba\xd1\x82\xd0\xb0 \xd0\x91 \xd1\x81\xd0\xbe \xd1\x81\xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c\xd1\x8e i \xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xb2 \xd1\x81\xd0\xb5\xd0\xba\xd1\x83\xd0\xbd\xd0\xb4\xd1\x83 (\xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x87\xd0\xb5\xd0\xbc \xd0\xb1\xd0\xbb\xd0\xb8\xd0\xb6\xd0\xb5 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xbd\xd0\xbd\xd0\xb5 \xd0\xba \xd0\xbf\xd1\x83\xd0\xbd\xd0\xba\xd1\x82\xd1\x83 \xd0\x91, \xd1\x82\xd0\xb5\xd0\xbc \xd0\xbc\xd0\xb5\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb5\xd0\xb5 \xd0\xbe\xd0\xbd \xd0\xb5\xd0\xb4\xd0\xb5\xd1\x82). \xd0\xa2\xd0\xb0\xd0\xba \xd0\xba\xd0\xb0\xd0\xba \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb0 \xd1\x83\xd0\xb7\xd0\xba\xd0\xb0\xd1\x8f, \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd1\x8b \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbe\xd0\xb1\xd0\xb3\xd0\xbe\xd0\xbd\xd1\x8f\xd1\x82\xd1\x8c \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb0. \xd0\x91\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd1\x8b \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xbd\xd0\xbd\xd0\xb5 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xbd\xd1\x8b \xd1\x81\xd0\xbe\xd0\xb1\xd0\xbb\xd1\x8e\xd0\xb4\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb4\xd0\xb8\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd1\x86\xd0\xb8\xd1\x8e \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xb2 1 \xd0\xbc\xd0\xb5\xd1\x82\xd1\x80. \xd0\x9f\xd0\xbe\xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xba\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xb1\xd1\x8b\xd1\x81\xd1\x82\xd1\x80\xd1\x8b\xd0\xb9 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe\xd0\xbd\xd1\x8f\xd0\xb5\xd1\x82 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xbc\xd0\xb5\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9, \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xb1\xd1\x8b\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xbf\xd1\x80\xd0\xb8\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd0\xb0\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xb5\xd1\x85\xd0\xb0\xd1\x82\xd1\x8c \xd1\x81\xd0\xbe \xd1\x81\xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c\xd1\x8e \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xbc\xd0\xb5\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe, \xd0\xbf\xd1\x80\xd0\xb8\xd1\x87\xd1\x91\xd0\xbc \xd0\xbd\xd0\xb0 \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb2 1 \xd0\xbc\xd0\xb5\xd1\x82\xd1\x80 \xd0\xbe\xd1\x82 \xd0\xbd\xd0\xb5\xd0\xb3\xd0\xbe.\xd0\x9e\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd0\xb5, \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xbc \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb4\xd0\xbe \xd0\xbf\xd1\x83\xd0\xbd\xd0\xba\xd1\x82\xd0\xb0 \xd0\x91 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb7 \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83 \xd1\x81\xd0\xb5\xd0\xba\xd1\x83\xd0\xbd\xd0\xb4\xd1\x83." 800.0                       
                         1768E "Partial Sorting" "combinatorics,math,number theory" "Consider a permutation\xe2\x80\xa0 p of length 3n. Each time you can do one of the following operations:  Sort the first 2n elements in increasing order.  Sort the last 2n elements in increasing order. We can show that every permutation can be made sorted in increasing order using only these operations. Let\'s call f(p) the minimum number of these operations needed to make the permutation p sorted in increasing order.Given n, find the sum of f(p) over all (3n)! permutations p of size 3n.Since the answer could be very large, output it modulo a prime M.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2300.0                       
                         1768B "Quick Sort" greedy,math "You are given a permutation\xe2\x80\xa0 p of length n and a positive integer k\xe2\x89\xa4n.In one operation, you:   Choose k distinct elements pi1,pi2,\xe2\x80\xa6,pik.  Remove them and then add them sorted in increasing order to the end of the permutation. For example, if p=[2,5,1,3,4] and k=2 and you choose 5 and 3 as the elements for the operation, then [2,5,1,3,4]\xe2\x86\x92[2,1,4,3,5].Find the minimum number of operations needed to sort the permutation in increasing order. It can be proven that it is always possible to do so.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 900.0                       
                         1767A "Cut the Triangle" implementation "You are given a non-degenerate triangle (a non-degenerate triangle is a triangle with positive area). The vertices of the triangle have coordinates (x1,y1), (x2,y2) and (x3,y3).You want to draw a straight line to cut the triangle into two non-degenerate triangles. Furthermore, the line you draw should be either horizontal or vertical.Can you draw the line to meet all the constraints?Here are some suitable ways to draw the line:  However, these ways to draw the line are not suitable (the first line cuts the triangle into a triangle and a quadrangle; the second line doesn\'t cut the triangle at all; the third line is neither horizontal nor vertical):" 800.0                       
                         1766E Decomposition "binary search,brute force,data structures,divide and conquer,dp,two pointers" "For a sequence of integers [x1,x2,\xe2\x80\xa6,xk], let\'s define its decomposition as follows:Process the sequence from the first element to the last one, maintaining the list of its subsequences. When you process the element xi, append it to the end of the first subsequence in the list such that the bitwise AND of its last element and xi is greater than 0. If there is no such subsequence in the list, create a new subsequence with only one element xi and append it to the end of the list of subsequences.For example, let\'s analyze the decomposition of the sequence [1,3,2,0,1,3,2,1]:  processing element 1, the list of subsequences is empty. There is no subsequence to append 1 to, so we create a new subsequence [1];  processing element 3, the list of subsequences is [[1]]. Since the bitwise AND of 3 and 1 is 1, the element is appended to the first subsequence;  processing element 2, the list of subsequences is [[1,3]]. Since the bitwise AND of 2 and 3 is 2, the element is appended to the first subsequence;  processing element 0, the list of subsequences is [[1,3,2]]. There is no subsequence to append 0 to, so we create a new subsequence [0];  processing element 1, the list of subsequences is [[1,3,2],[0]]. There is no subsequence to append 1 to, so we create a new subsequence [1];  processing element 3, the list of subsequences is [[1,3,2],[0],[1]]. Since the bitwise AND of 3 and 2 is 2, the element is appended to the first subsequence;  processing element 2, the list of subsequences is [[1,3,2,3],[0],[1]]. Since the bitwise AND of 2 and 3 is 2, the element is appended to the first subsequence;  processing element 1, the list of subsequences is [[1,3,2,3,2],[0],[1]]. The element 1 cannot be appended to any of the first two subsequences, but can be appended to the third one. The resulting list of subsequences is [[1,3,2,3,2],[0],[1,1]].Let f([x1,x2,\xe2\x80\xa6,xk]) be the number of subsequences the sequence [x1,x2,\xe2\x80\xa6,xk] is decomposed into.Now, for the problem itself.You are given a sequence [a1,a2,\xe2\x80\xa6,an], where each element is an integer from 0 to 3. Let a[i..j] be the sequence [ai,ai+1,\xe2\x80\xa6,aj]. You have to calculate n\xe2\x88\x91i=1n\xe2\x88\x91j=if(a[i..j])." 2300.0                       
                         1765G "Guess the String" "constructive algorithms,interactive,probabilities" "This is an interactive problem. You have to use flush operation right after printing each line. For example, in C++ you should use the function fflush(stdout), in Java or Kotlin \xe2\x80\x94 System.out.flush(), and in Python \xe2\x80\x94 sys.stdout.flush().The jury has a string s consisting of characters 0 and/or 1. The first character of this string is 0. The length of this string is n. You have to guess this string. Let\'s denote s[l..r] as the substring of s from l to r (i.\xe2\x80\x89e. s[l..r] is the string slsl+1\xe2\x80\xa6sr).Let the prefix function of the string s be an array [p1,p2,\xe2\x80\xa6,pn], where pi is the greatest integer j\xe2\x88\x88[0,i\xe2\x88\x921] such that s[1..j]=s[i\xe2\x88\x92j+1..i]. Also, let the antiprefix function of the string s be an array [q1,q2,\xe2\x80\xa6,qn], where qi is the greatest integer j\xe2\x88\x88[0,i\xe2\x88\x921] such that s[1..j] differs from s[i\xe2\x88\x92j+1..i] in every position.For example, for the string 011001, its prefix function is [0,0,0,1,1,2], and its antiprefix function is [0,1,1,2,3,4].You can ask queries of two types to guess the string s:  1 i \xe2\x80\x94 ""what is the value of pi?"";  2 i \xe2\x80\x94 ""what is the value of qi?"". You have to guess the string by asking no more than 789 queries. Note that giving the answer does not count as a query.In every test and in every test case, the string s is fixed beforehand." 2600.0                       
                         1764G3 "Doremy\'s Perfect DS Class (Hard Version)" "binary search,interactive" "The only difference between this problem and the other two versions is the maximum number of queries. In this version, you are allowed to ask at most 20 queries. You can make hacks only if all versions of the problem are solved.This is an interactive problem.""Everybody! Doremy\'s Perfect Data Structure Class is about to start! Come and do your best if you want to have as much IQ as me!"" In today\'s Data Structure class, Doremy is teaching everyone a powerful data structure \xe2\x80\x94 Doremy tree! Now she gives you a quiz to prove that you are paying attention in class.Given an array a of length m, Doremy tree supports the query Q(l,r,k), where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4m and 1\xe2\x89\xa4k\xe2\x89\xa4m, which returns the number of distinct integers in the array [\xe2\x8c\x8aalk\xe2\x8c\x8b,\xe2\x8c\x8aal+1k\xe2\x8c\x8b,\xe2\x80\xa6,\xe2\x8c\x8aark\xe2\x8c\x8b].Doremy has a secret permutation p of integers from 1 to n. You can make queries, in one query, you give 3 integers l,r,k (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4k\xe2\x89\xa4n) and receive the value of Q(l,r,k) for the array p. Can you find the index y (1\xe2\x89\xa4y\xe2\x89\xa4n) such that py=1 in at most 20 queries?Note that the permutation p is fixed before any queries are made." 3300.0                       
                         1764G2 "Doremy\'s Perfect DS Class (Medium Version)" "binary search,interactive" "The only difference between this problem and the other two versions is the maximum number of queries. In this version, you are allowed to ask at most 25 queries. You can make hacks only if all versions of the problem are solved.This is an interactive problem.""Everybody! Doremy\'s Perfect Data Structure Class is about to start! Come and do your best if you want to have as much IQ as me!"" In today\'s Data Structure class, Doremy is teaching everyone a powerful data structure \xe2\x80\x94 Doremy tree! Now she gives you a quiz to prove that you are paying attention in class.Given an array a of length m, Doremy tree supports the query Q(l,r,k), where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4m and 1\xe2\x89\xa4k\xe2\x89\xa4m, which returns the number of distinct integers in the array [\xe2\x8c\x8aalk\xe2\x8c\x8b,\xe2\x8c\x8aal+1k\xe2\x8c\x8b,\xe2\x80\xa6,\xe2\x8c\x8aark\xe2\x8c\x8b].Doremy has a secret permutation p of integers from 1 to n. You can make queries, in one query, you give 3 integers l,r,k (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4k\xe2\x89\xa4n) and receive the value of Q(l,r,k) for the array p. Can you find the index y (1\xe2\x89\xa4y\xe2\x89\xa4n) such that py=1 in at most 25 queries?Note that the permutation p is fixed before any queries are made." 3000.0                       
                         1764D "Doremy\'s Pegging Game" combinatorics,dp,math "Doremy has n+1n+1 pegs. There are nn red pegs arranged as vertices of a regular nn-sided polygon, numbered from 11 to nn in anti-clockwise order. There is also a blue peg of slightly smaller diameter in the middle of the polygon. A rubber band is stretched around the red pegs.Doremy is very bored today and has decided to play a game. Initially, she has an empty array aa. While the rubber band does not touch the blue peg, she will:  choose ii (1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n) such that the red peg ii has not been removed;  remove the red peg ii;  append ii to the back of aa. Doremy wonders how many possible different arrays aa can be produced by the following process. Since the answer can be big, you are only required to output it modulo pp. pp is guaranteed to be a prime number.  game with n=9n=9 and a=[7,5,2,8,3,9,4]a=[7,5,2,8,3,9,4] and another game with n=8n=8 and a=[3,4,7,1,8,5,2]a=[3,4,7,1,8,5,2]" 2000.0                       
                         1763D "Valid Bitonic Permutations" "combinatorics,dp,implementation,math,number theory" "You are given five integers n, i, j, x, and y. Find the number of bitonic permutations B, of the numbers 1 to n, such that Bi=x, and Bj=y. Since the answer can be large, compute it modulo 109+7.A bitonic permutation is a permutation of numbers, such that the elements of the permutation first increase till a certain index k, 2\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x921, and then decrease till the end. Refer to notes for further clarification." 2200.0                       
                         1761G "Centroid Guess" interactive,probabilities,trees "This in an interactive problem.There is an unknown tree consisting of n nodes, which has exactly one centroid. You only know n at first, and your task is to find the centroid of the tree.You can ask the distance between any two vertices for at most 2\xe2\x8b\x85105 times. Note that the interactor is not adaptive. That is, the tree is fixed in each test beforehand and does not depend on your queries.A vertex is called a centroid if its removal splits the tree into subtrees with at most \xe2\x8c\x8an2\xe2\x8c\x8b vertices each." 3500.0                       
                         1761D "Carry Bit" combinatorics,math "Let f(x,y) be the number of carries of x+y in binary (i. e. f(x,y)=g(x)+g(y)\xe2\x88\x92g(x+y), where g(x) is the number of ones in the binary representation of x).Given two integers n and k, find the number of ordered pairs (a,b) such that 0\xe2\x89\xa4a,b<2n, and f(a,b) equals k. Note that for a\xe2\x89\xa0b, (a,b) and (b,a) are considered as two different pairs. As this number may be large, output it modulo 109+7." 2100.0                       
                         1760D "Challenging Valleys" "implementation,two pointers" "You are given an array a[0\xe2\x80\xa6n\xe2\x88\x921] of n integers. This array is called a ""valley"" if there exists exactly one subarray a[l\xe2\x80\xa6r] such that:  0\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n\xe2\x88\x921,  al=al+1=al+2=\xe2\x8b\xaf=ar,  l=0 or al\xe2\x88\x921>al,  r=n\xe2\x88\x921 or ar<ar+1. Here are three examples:  The first image shows the array [3,2,2,1,2,2,3], it is a valley because only subarray with indices l=r=3 satisfies the condition.The second image shows the array [1,1,1,2,3,3,4,5,6,6,6], it is a valley because only subarray with indices l=0,r=2 satisfies the codition.The third image shows the array [1,2,3,4,3,2,1], it is not a valley because two subarrays l=r=0 and l=r=6 that satisfy the condition.You are asked whether the given array is a valley or not.Note that we consider the array to be indexed from 0." 1000.0                       
                         1753F "Minecraft Series" "brute force,two pointers" "Little Misha goes to the programming club and solves nothing there. It may seem strange, but when you find out that Misha is filming a Minecraft series, everything will fall into place...Misha is inspired by Manhattan, so he built a city in Minecraft that can be imagined as a table of size n\xc3\x97m. k students live in a city, the i-th student lives in the house, located at the intersection of the xi-th row and the yi-th column. Also, each student has a degree of his aggressiveness wi. Since the city turned out to be very large, Misha decided to territorially limit the actions of his series to some square s, which sides are parallel to the coordinate axes. The length of the side of the square should be an integer from 1 to min(n,m) cells.According to the plot, the main hero will come to the city and accidentally fall into the square s. Possessing a unique degree of aggressiveness 0, he will be able to show his leadership qualities and assemble a team of calm, moderate and aggressive students.In order for the assembled team to be versatile and close-knit, degrees of aggressiveness of all students of the team must be pairwise distinct and must form a single segment of consecutive integers. Formally, if there exist students with degrees of aggressiveness l,l+1,\xe2\x80\xa6,\xe2\x88\x921,1,\xe2\x80\xa6,r\xe2\x88\x921,r inside the square s, where l\xe2\x89\xa40\xe2\x89\xa4r, the main hero will be able to form a team of r\xe2\x88\x92l+1 people (of course, he is included in this team).Notice, that it is not required to take all students from square s to the team.Misha thinks that the team should consist of at least t people. That is why he is interested, how many squares are there in the table in which the main hero will be able to form a team of at least t people. Help him to calculate this." 3500.0                       
                         1749D "Counting Arrays" "combinatorics,dp,math,number theory" "Consider an array a of length n with elements numbered from 1 to n. It is possible to remove the i-th element of a if gcd(ai,i)=1, where gcd denotes the greatest common divisor. After an element is removed, the elements to the right are shifted to the left by one position.An array b with n integers such that 1\xe2\x89\xa4bi\xe2\x89\xa4n\xe2\x88\x92i+1 is a removal sequence for the array a if it is possible to remove all elements of a, if you remove the b1-th element, then the b2-th, ..., then the bn-th element. For example, let a=[42,314]:  [1,1] is a removal sequence: when you remove the 1-st element of the array, the condition gcd(42,1)=1 holds, and the array becomes [314]; when you remove the 1-st element again, the condition gcd(314,1)=1 holds, and the array becomes empty.  [2,1] is not a removal sequence: when you try to remove the 2-nd element, the condition gcd(314,2)=1 is false. An array is ambiguous if it has at least two removal sequences. For example, the array [1,2,5] is ambiguous: it has removal sequences [3,1,1] and [1,2,1]. The array [42,314] is not ambiguous: the only removal sequence it has is [1,1].You are given two integers n and m. You have to calculate the number of ambiguous arrays a such that the length of a is from 1 to n and each ai is an integer from 1 to m." 1900.0                       
                         1746B Rebellion "constructive algorithms,greedy,two pointers" "You have an array a of size n consisting only of zeroes and ones. You can do the following operation:  choose two indices 1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j,  add ai to aj,  remove ai from a. Note that elements of a can become bigger than 1 after performing some operations. Also note that n becomes 1 less after the operation.What is the minimum number of operations needed to make a non-decreasing, i. e. that each element is not less than the previous element?" 800.0                       
                         1744E1 "Divisible Numbers (easy version)" "brute force,math,number theory" "This is an easy version of the problem. The only difference between an easy and a hard version is the constraints on a, b, c and d.You are given 4 positive integers a, b, c, d with a<c and b<d. Find any pair of numbers x and y that satisfies the following conditions: a<x\xe2\x89\xa4c, b<y\xe2\x89\xa4d, x\xe2\x8b\x85y is divisible by a\xe2\x8b\x85b.Note that required x and y may not exist." 1500.0                       
                         1744D "Divisibility by 2^n" greedy,math,sortings "You are given an array of positive integers a1,a2,\xe2\x80\xa6,an.Make the product of all the numbers in the array (that is, a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85an) divisible by 2n.You can perform the following operation as many times as you like:  select an arbitrary index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and replace the value ai with ai=ai\xe2\x8b\x85i. You cannot apply the operation repeatedly to a single index. In other words, all selected values of i must be different.Find the smallest number of operations you need to perform to make the product of all the elements in the array divisible by 2n. Note that such a set of operations does not always exist." 1200.0                       
                         1743D "Problem with Random Tests" "brute force,dp,greedy,probabilities" "You are given a string s consisting of n characters. Each character of s is either 0 or 1.A substring of s is a contiguous subsequence of its characters.You have to choose two substrings of s (possibly intersecting, possibly the same, possibly non-intersecting \xe2\x80\x94 just any two substrings). After choosing them, you calculate the value of the chosen pair of substrings as follows:  let s1 be the first substring, s2 be the second chosen substring, and f(si) be the integer such that si is its binary representation (for example, if si is 11010, f(si)=26);  the value is the bitwise OR of f(s1) and f(s2). Calculate the maximum possible value you can get, and print it in binary representation without leading zeroes." 1700.0                       
                         1743B "Permutation Value" "constructive algorithms,greedy" "You are given an integer n. You have to construct a permutation of size n.A permutation is an array where each integer from 1 to s (where s is the size of permutation) occurs exactly once. For example, [2,1,4,3] is a permutation of size 4; [1,2,4,5,3] is a permutation of size 5; [1,4,3] is not a permutation (the integer 2 is absent), [2,1,3,1] is not a permutation (the integer 1 appears twice).A subsegment of a permutation is a contiguous subsequence of that permutation. For example, the permutation [2,1,4,3] has 10 subsegments: [2], [2,1], [2,1,4], [2,1,4,3], [1], [1,4], [1,4,3], [4], [4,3] and [3].The value of the permutation is the number of its subsegments which are also permutations. For example, the value of [2,1,4,3] is 3 since the subsegments [2,1], [1] and [2,1,4,3] are permutations.You have to construct a permutation of size n with minimum possible value among all permutations of size n." 800.0                       
                         1742A Sum implementation "You are given three integers a, b, and c. Determine if one of them is the sum of the other two." 800.0                       
                         1740H "MEX Tree Manipulation" "data structures,trees" "Given a rooted tree, define the value of vertex u in the tree recursively as the MEX\xe2\x80\xa0 of the values of its children. Note that it is only the children, not all of its descendants. In particular, the value of a leaf is 0.Pak Chanek has a rooted tree that initially only contains a single vertex with index 1, which is the root. Pak Chanek is going to do q queries. In the i-th query, Pak Chanek is given an integer xi. Pak Chanek needs to add a new vertex with index i+1 as the child of vertex xi. After adding the new vertex, Pak Chanek needs to recalculate the values of all vertices and report the sum of the values of all vertices in the current tree.\xe2\x80\xa0 The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For example, the MEX of [0,1,1,2,6,7] is 3 and the MEX of [6,9] is 0." 3300.0                       
                         1740F "Conditional Mix" combinatorics,dp,math "Pak Chanek is given an array a of n integers. For each i (1\xe2\x89\xa4i\xe2\x89\xa4n), Pak Chanek will write the one-element set {ai} on a whiteboard.After that, in one operation, Pak Chanek may do the following:   Choose two different sets S and T on the whiteboard such that S\xe2\x88\xa9T=\xe2\x88\x85 (S and T do not have any common elements).  Erase S and T from the whiteboard and write S\xe2\x88\xaaT (the union of S and T) onto the whiteboard. After performing zero or more operations, Pak Chanek will construct a multiset M containing the sizes of all sets written on the whiteboard. In other words, each element in M corresponds to the size of a set after the operations.How many distinct\xe2\x80\xa0 multisets M can be created by this process? Since the answer may be large, output it modulo 998244353.\xe2\x80\xa0 Multisets B and C are different if and only if there exists a value k such that the number of elements with value k in B is different than the number of elements with value k in C." 2600.0                       
                         1737E "Ela Goes Hiking" combinatorics,dp,math,probabilities "Ela likes to go hiking a lot. She loves nature and exploring the various creatures it offers. One day, she saw a strange type of ant, with a cannibalistic feature. More specifically, an ant would eat any ants that it sees which is smaller than it.Curious about this feature from a new creature, Ela ain\'t furious. She conducts a long, non-dubious, sentimental experiment.She puts n cannibalistic ants in a line on a long wooden stick. Initially, the ants have the same weight of 1. The distance between any two consecutive ants is the same. The distance between the first ant in the line to the left end and the last ant in the line to the right end is also the same as the distance between the ants. Each ant starts moving towards the left-end or the right-end randomly and equiprobably, at the same constant pace throughout the experiment. Two ants will crash if they are standing next to each other in the line and moving in opposite directions, and ants will change direction immediately when they reach the end of the stick. Ela can\'t determine the moving direction of each ant, but she understands very well their behavior when crashes happen.  If a crash happens between two ants of different weights, the heavier one will eat the lighter one, and gain the weight of the lighter one. After that, the heavier and will continue walking in the same direction. In other words, if the heavier one has weight x and walking to the right, the lighter one has weight y and walking to the left (x>y), then after the crash, the lighter one will diminish, and the heavier one will have weight x+y and continue walking to the right.  If a crash happens between two ants with the same weight, the one walking to the left end of the stick will eat the one walking to the right, and then continue walking in the same direction. In other words, if one ant of weight x walking to the left, crashes with another ant of weight x walking to the right, the one walking to the right will disappear, and the one walking to the left will have to weight 2x and continue walking to the left. Please, check the example in the ""Note"" section, which will demonstrate the ants\' behavior as above.We can prove that after a definite amount of time, there will be only one last ant standing. Initially, each ant can randomly and equiprobably move to the left or the right, which generates 2n different cases of initial movements for the whole pack. For each position in the line, calculate the probability that the ant begins in that position and survives. Output it modulo 109+7.Formally, let M=109+7. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 2500.0                       
                         1737D "Ela and the Wiring Wizard" "brute force,dp,graphs,greedy,implementation,shortest paths" "Ela needs to send a large package from machine 1 to machine n through a network of machines. Currently, with the network condition, she complains that the network is too slow and the package can\'t arrive in time. Luckily, a Wiring Wizard offered her a helping hand.The network can be represented as an undirected connected graph with n nodes, each node representing a machine. m wires are used to connect them. Wire i is used to connect machines ui and vi, and has a weight wi. The aforementioned large package, if going through wire i, will move from machine ui to machine vi (or vice versa) in exactly wi microseconds. The Wiring Wizard can use his spell an arbitrary number of times. For each spell, he will choose the wire of index i, connecting machine ui and vi, and rewire it following these steps:  Choose one machine that is connected by this wire. Without loss of generality, let\'s choose vi.  Choose a machine that is currently connecting to vi (including ui), call it ti. Disconnect the wire indexed i from vi, then using it to connect ui and ti. The rewiring of wire i will takes wi microseconds, and the weight of the wire will not change after this operation. After a rewiring, a machine might have some wire connect it with itself. Also, the Wiring Wizard has warned Ela that rewiring might cause temporary disconnections between some machines, but Ela just ignores it anyway. Her mission is to send the large package from machine 1 to machine n as fast as possible. Note that the Wizard can use his spell on a wire zero, one, or many times. To make sure the network works seamlessly while transferring the large package, once the package starts transferring from machine 1, the Wiring Wizard cannot use his spell to move wires around anymore.Ela wonders, with the help of the Wiring Wizard, what is the least amount of time needed to transfer the large package from machine 1 to n." 2200.0                       
                         1736E "Swap and Take" dp,greedy "You\'re given an array consisting of n integers. You have to perform n turns.Initially your score is 0.On the i-th turn, you are allowed to leave the array as it is or swap any one pair of 2 adjacent elements in the array and change exactly one of them to 0(and leave the value of other element unchanged) after swapping. In either case(whether you swap or not), after this you add ai to your score. What\'s the maximum possible score you can get?" 2600.0                       
                         1735F "Pebbles and Beads" "data structures,geometry" "There are two currencies: pebbles and beads. Initially you have a pebbles, b beads.There are n days, each day you can exchange one currency for another at some exchange rate.On day i, you can exchange \xe2\x88\x92pi\xe2\x89\xa4x\xe2\x89\xa4pi pebbles for \xe2\x88\x92qi\xe2\x89\xa4y\xe2\x89\xa4qi beads or vice versa. It\'s allowed not to perform an exchange at all. Meanwhile, if you perform an exchange, the proportion x\xe2\x8b\x85qi=\xe2\x88\x92y\xe2\x8b\x85pi must be fulfilled. Fractional exchanges are allowed.You can perform no more than one such exchange in one day. The numbers of pebbles and beads you have must always remain non-negative.Please solve the following n problems independently: for each day i, output the maximum number of pebbles that you can have at the end of day i if you perform exchanges optimally." 2900.0                       
                         1732D2 "Balance (Hard version)" "brute force,data structures,number theory" "This is the hard version of the problem. The only difference is that in this version there are remove queries.Initially you have a set containing one element \xe2\x80\x94 0. You need to handle q queries of the following types:+ x \xe2\x80\x94 add the integer x to the set. It is guaranteed that this integer is not contained in the set; - x \xe2\x80\x94 remove the integer x from the set. It is guaranteed that this integer is contained in the set; ? k \xe2\x80\x94 find the k-mex of the set. In our problem, we define the k-mex of a set of integers as the smallest non-negative integer x that is divisible by k and which is not contained in the set." 2400.0                       
                         1729G "Cut Substrings" "combinatorics,dp,hashing,strings,two pointers" "You are given two non-empty strings s and t, consisting of Latin letters.In one move, you can choose an occurrence of the string t in the string s and replace it with dots.Your task is to remove all occurrences of the string t in the string s in the minimum number of moves, and also calculate how many different sequences of moves of the minimum length exist.Two sequences of moves are considered different if the sets of indices at which the removed occurrences of the string t in s begin differ. For example, the sets {1,2,3} and {1,2,4} are considered different, the sets {2,4,6} and {2,6} \xe2\x80\x94 too, but sets {3,5} and {5,3} \xe2\x80\x94 not.For example, let the string s= ""abababacababa"" and the string t= ""aba"". We can remove all occurrences of the string t in 2 moves by cutting out the occurrences of the string t at the 3th and 9th positions. In this case, the string s is an example of the form ""ab...bac...ba"". It is also possible to cut occurrences of the string t at the 3th and 11th positions. There are two different sequences of minimum length moves.Since the answer can be large, output it modulo 109+7." 2100.0                       
                         1729F "Kirei and the Linear Function" hashing,math "Given the string s of decimal digits (0-9) of length n.A substring is a sequence of consecutive characters of a string. The substring of this string is defined by a pair of indexes \xe2\x80\x94 with its left and right ends. So, each pair of indexes (l,r), where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, corresponds to a substring of the string s. We will define as v(l,r) the numeric value of the corresponding substring (leading zeros are allowed in it).For example, if n=7, s=""1003004"", then v(1,3)=100, v(2,3)=0 and v(2,7)=3004.You are given n, s and an integer w (1\xe2\x89\xa4w<n).You need to process m queries, each of which is characterized by 3 numbers li,ri,ki (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n;0\xe2\x89\xa4ki\xe2\x89\xa48).The answer to the ith query is such a pair of substrings of length w that if we denote them as (L1,L1+w\xe2\x88\x921) and (L2,L2+w\xe2\x88\x921), then:  L1\xe2\x89\xa0L2, that is, the substrings are different;  the remainder of dividing a number v(L1,L1+w\xe2\x88\x921)\xe2\x8b\x85v(li,ri)+v(L2,L2+w\xe2\x88\x921) by 9 is equal to ki. If there are many matching substring pairs, then find a pair where L1 is as small as possible. If there are many matching pairs in this case, then minimize L2.Note that the answer may not exist." 1900.0                       
                         1728B "Best Permutation" "constructive algorithms,greedy" "Let\'s define the value of the permutation p of n integers 1, 2, ..., n (a permutation is an array where each element from 1 to n occurs exactly once) as follows:  initially, an integer variable x is equal to 0;  if x<p1, then add p1 to x (set x=x+p1), otherwise assign 0 to x;  if x<p2, then add p2 to x (set x=x+p2), otherwise assign 0 to x;  ...  if x<pn, then add pn to x (set x=x+pn), otherwise assign 0 to x;  the value of the permutation is x at the end of this process. For example, for p=[4,5,1,2,3,6], the value of x changes as follows: 0,4,9,0,2,5,11, so the value of the permutation is 11.You are given an integer n. Find a permutation p of size n with the maximum possible value among all permutations of size n. If there are several such permutations, you can print any of them." 800.0                       
                         1728A "Colored Balls: Revisited" "brute force,greedy,implementation,sortings" "The title is a reference to the very first Educational Round from our writers team, Educational Round 18.There is a bag, containing colored balls. There are n different colors of balls, numbered from 1 to n. There are cnti balls of color i in the bag. The total amount of balls in the bag is odd (e.\xe2\x80\x89g. cnt1+cnt2+\xe2\x8b\xaf+cntn is odd).In one move, you can choose two balls with different colors and take them out of the bag.At some point, all the remaining balls in the bag will have the same color. That\'s when you can\'t make moves anymore.Find any possible color of the remaining balls." 800.0                       
                         1726B "Mainak and Interesting Sequence" "bitmasks,constructive algorithms,math" "Mainak has two positive integers n and m.Mainak finds a sequence a1,a2,\xe2\x80\xa6,an of n positive integers interesting, if for all integers i (1\xe2\x89\xa4i\xe2\x89\xa4n), the bitwise XOR of all elements in a which are strictly less than ai is 0. Formally if pi is the bitwise XOR of all elements in a which are strictly less than ai, then a is an interesting sequence if p1=p2=\xe2\x80\xa6=pn=0.For example, sequences [1,3,2,3,1,2,3], [4,4,4,4], [25] are interesting, whereas [1,2,3,4] (p2=1\xe2\x89\xa00), [4,1,1,2,4] (p1=1\xe2\x8a\x951\xe2\x8a\x952=2\xe2\x89\xa00), [29,30,30] (p2=29\xe2\x89\xa00) aren\'t interesting.Here a\xe2\x8a\x95b denotes bitwise XOR of integers a and b.Find any interesting sequence a1,a2,\xe2\x80\xa6,an (or report that there exists no such sequence) such that the sum of the elements in the sequence a is equal to m, i.e. a1+a2\xe2\x80\xa6+an=m.As a reminder, the bitwise XOR of an empty sequence is considered to be 0." 1100.0                       
                              1725G Garage "binary search,geometry,math" "Pak Chanek plans to build a garage. He wants the garage to consist of a square and a right triangle that are arranged like the following illustration.  Define a and b as the lengths of two of the sides in the right triangle as shown in the illustration. An integer x is suitable if and only if we can construct a garage with assigning positive integer values for the lengths a and b (a<b) so that the area of the square at the bottom is exactly x. As a good friend of Pak Chanek, you are asked to help him find the N-th smallest suitable number." 1500.0                  
                              1722A "Spell Check" implementation "Timur likes his name. As a spelling of his name, he allows any permutation of the letters of the name. For example, the following strings are valid spellings of his name: Timur, miurT, Trumi, mriTu. Note that the correct spelling must have uppercased T and lowercased other letters.Today he wrote string s of length n consisting only of uppercase or lowercase Latin letters. He asks you to check if s is the correct spelling of his name." 800.0                  
                              1718A1 "Burenka and Traditions (easy version)" dp,greedy "This is the easy version of this problem. The difference between easy and hard versions is only the constraints on ai and on n. You can make hacks only if both versions of the problem are solved.Burenka is the crown princess of Buryatia, and soon she will become the n-th queen of the country. There is an ancient tradition in Buryatia \xe2\x80\x94 before the coronation, the ruler must show their strength to the inhabitants. To determine the strength of the n-th ruler, the inhabitants of the country give them an array of a of exactly n numbers, after which the ruler must turn all the elements of the array into zeros in the shortest time. The ruler can do the following two-step operation any number of times:   select two indices l and r, so that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and a non-negative integer x, then  for all l\xe2\x89\xa4i\xe2\x89\xa4r assign ai:=ai\xe2\x8a\x95x, where \xe2\x8a\x95 denotes the bitwise XOR operation. It takes \xe2\x8c\x88r\xe2\x88\x92l+12\xe2\x8c\x89 seconds to do this operation, where \xe2\x8c\x88y\xe2\x8c\x89 denotes y rounded up to the nearest integer. Help Burenka calculate how much time she will need." 1800.0                  
                              1715F "Crop Squares" "constructive algorithms,geometry,interactive,math" "This is an interactive problem.Farmer Stanley grows corn on a rectangular field of size n\xc3\x97m meters with corners in points (0,0), (0,m), (n,0), (n,m). This year the harvest was plentiful and corn covered the whole field.The night before harvest aliens arrived and poisoned the corn in a single 1\xc3\x971 square with sides parallel to field borders. The corn inside the square must not be eaten, but you cannot distinguish it from ordinary corn by sight. Stanley can only collect a sample of corn from an arbitrary polygon and bring it to the laboratory, where it will be analyzed and Stanley will be told the amount of corn in the sample that was poisoned. Since the harvest will soon deteriorate, such a study can be carried out no more than 5 times.More formally, it is allowed to make no more than 5 queries, each of them calculates the area of intersection of a chosen polygon with a square of poisoned corn. It is necessary to find out the coordinates of the lower-left corner of the drawn square (the vertex of the square with the smallest x and y coordinates)." 2700.0                  
                              1715B "Beautiful Array" "constructive algorithms,greedy,math" "Stanley defines the beauty of an array a of length n, which contains non-negative integers, as follows: n\xe2\x88\x91i=1\xe2\x8c\x8aaik\xe2\x8c\x8b, which means that we divide each element by k, round it down, and sum up the resulting values.Stanley told Sam the integer k and asked him to find an array a of n non-negative integers, such that the beauty is equal to b and the sum of elements is equal to s. Help Sam \xe2\x80\x94 find any of the arrays satisfying the conditions above." 1000.0                  
                              1714E "Add Modulo 10" "brute force,math,number theory" "You are given an array of n integers a1,a2,\xe2\x80\xa6,anYou can apply the following operation an arbitrary number of times:   select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and replace the value of the element ai with the value ai+(aimod10), where aimod10 is the remainder of the integer dividing ai by 10. For a single index (value i), this operation can be applied multiple times. If the operation is applied repeatedly to the same index, then the current value of ai is taken into account each time. For example, if ai=47 then after the first operation we get ai=47+7=54, and after the second operation we get ai=54+4=58.Check if it is possible to make all array elements equal by applying multiple (possibly zero) operations.For example, you have an array [6,11].   Let\'s apply this operation to the first element of the array. Let\'s replace a1=6 with a1+(a1mod10)=6+(6mod10)=6+6=12. We get the array [12,11].  Then apply this operation to the second element of the array. Let\'s replace a2=11 with a2+(a2mod10)=11+(11mod10)=11+1=12. We get the array [12,12]. Thus, by applying 2 operations, you can make all elements of an array equal." 1400.0                  
                              1713E "Cross Swapping" "2-sat,data structures,dsu,greedy,matrices" "You are given a square matrix A of size n\xc3\x97n whose elements are integers. We will denote the element on the intersection of the i-th row and the j-th column as Ai,j.You can perform operations on the matrix. In each operation, you can choose an integer k, then for each index i (1\xe2\x89\xa4i\xe2\x89\xa4n), swap Ai,k with Ak,i. Note that cell Ak,k remains unchanged.For example, for n=4 and k=3, this matrix will be transformed like this:  The operation k=3 swaps the blue row with the green column. You can perform this operation any number of times. Find the lexicographically smallest matrix\xe2\x80\xa0 you can obtain after performing arbitrary number of operations.\xe2\x80\xa0 For two matrices A and B of size n\xc3\x97n, let a(i\xe2\x88\x921)\xe2\x8b\x85n+j=Ai,j and b(i\xe2\x88\x921)\xe2\x8b\x85n+j=Bi,j. Then, the matrix A is lexicographically smaller than the matrix B when there exists an index i (1\xe2\x89\xa4i\xe2\x89\xa4n2) such that ai<bi and for all indices j such that 1\xe2\x89\xa4j<i, aj=bj." 2400.0                  
                              1713A "Traveling Salesman Problem" geometry,greedy,implementation "You are living on an infinite plane with the Cartesian coordinate system on it. In one move you can go to any of the four adjacent points (left, right, up, down).More formally, if you are standing at the point (x,y), you can:   go left, and move to (x\xe2\x88\x921,y), or  go right, and move to (x+1,y), or  go up, and move to (x,y+1), or  go down, and move to (x,y\xe2\x88\x921). There are n boxes on this plane. The i-th box has coordinates (xi,yi). It is guaranteed that the boxes are either on the x-axis or the y-axis. That is, either xi=0 or yi=0.You can collect a box if you and the box are at the same point. Find the minimum number of moves you have to perform to collect all of these boxes if you have to start and finish at the point (0,0)." 800.0                  
                              1712F Triameter "binary search,data structures,dfs and similar,trees" "\xe2\x80\x94 What is my mission?  \xe2\x80\x94 To count graph diameters.You and Your SubmissionA tree is a connected undirected graph without cycles. A weighted tree has a weight assigned to each edge. The degree of a vertex is the number of edges connected to this vertex.You are given a weighted tree with n vertices, each edge has a weight of 1. Let L be the set of vertices with degree equal to 1. You have to answer q independent queries. In the i-th query:  You are given a positive integer xi.  For all u,v\xe2\x88\x88L such that u<v, add edge (u,v) with weight xi to the graph (initially the given tree).  Find the diameter of the resulting graph. The diameter of a graph is equal to max1\xe2\x89\xa4u<v\xe2\x89\xa4nd(u,v), where d(u,v) is the length of the shortest path between vertex u and vertex v." 3200.0                  
                              1712E2 "LCM Sum (hard version)" "brute force,data structures,math,number theory,two pointers" "We are sum for we are manySome NumberThis version of the problem differs from the previous one only in the constraint on t. You can make hacks only if both versions of the problem are solved.You are given two positive integers l and r.Count the number of distinct triplets of integers (i,j,k) such that l\xe2\x89\xa4i<j<k\xe2\x89\xa4r and lcm(i,j,k)\xe2\x89\xa5i+j+k.Here lcm(i,j,k) denotes the least common multiple (LCM) of integers i, j, and k." 2500.0                  
                              1712D "Empty Graph" "binary search,constructive algorithms,data structures,greedy,shortest paths" "\xe2\x80\x94 Do you have a wish?  \xe2\x80\x94 I want people to stop gifting each other arrays.O_o and Another Young BoyAn array of n positive integers a1,a2,\xe2\x80\xa6,an fell down on you from the skies, along with a positive integer k\xe2\x89\xa4n.You can apply the following operation at most k times:   Choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n and an integer 1\xe2\x89\xa4x\xe2\x89\xa4109. Then do ai:=x (assign x to ai). Then build a complete undirected weighted graph with n vertices numbered with integers from 1 to n, where edge (l,r) (1\xe2\x89\xa4l<r\xe2\x89\xa4n) has weight min(al,al+1,\xe2\x80\xa6,ar).You have to find the maximum possible diameter of the resulting graph after performing at most k operations.The diameter of a graph is equal to max1\xe2\x89\xa4u<v\xe2\x89\xa4nd(u,v), where d(u,v) is the length of the shortest path between vertex u and vertex v." 2000.0                  
                              1711B Party "brute force,graphs" "A club plans to hold a party and will invite some of its n members. The n members are identified by the numbers 1,2,\xe2\x80\xa6,n. If member i is not invited, the party will gain an unhappiness value of ai.There are m pairs of friends among the n members. As per tradition, if both people from a friend pair are invited, they will share a cake at the party. The total number of cakes eaten will be equal to the number of pairs of friends such that both members have been invited.However, the club\'s oven can only cook two cakes at a time. So, the club demands that the total number of cakes eaten is an even number.What is the minimum possible total unhappiness value of the party, respecting the constraint that the total number of cakes eaten is even?" 1300.0                  
                              1710E "Two Arrays" "binary search,games,graph matchings" "You are given two arrays of integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bm. Alice and Bob are going to play a game. Alice moves first and they take turns making a move.They play on a grid of size n\xc3\x97m (a grid with n rows and m columns). Initially, there is a rook positioned on the first row and first column of the grid.During her/his move, a player can do one of the following two operations:  Move the rook to a different cell on the same row or the same column of the current cell. A player cannot move the rook to a cell that has been visited 1000 times before (i.e., the rook can stay in a certain cell at most 1000 times during the entire game). Note that the starting cell is considered to be visited once at the beginning of the game. End the game immediately with a score of ar+bc, where (r,c) is the current cell (i.e., the rook is on the r-th row and c-th column). Bob wants to maximize the score while Alice wants to minimize it. If they both play this game optimally, what is the final score of the game?" 2400.0                  
                              1709E "XOR Tree" "bitmasks,data structures,dfs and similar,dsu,greedy,trees" "You are given a tree consisting of n vertices. A number is written on each vertex; the number on vertex i is equal to ai.Recall that a simple path is a path that visits each vertex at most once. Let the weight of the path be the bitwise XOR of the values written on vertices it consists of. Let\'s say that a tree is good if no simple path has weight 0.You can apply the following operation any number of times (possibly, zero): select a vertex of the tree and replace the value written on it with an arbitrary positive integer. What is the minimum number of times you have to apply this operation in order to make the tree good?" 2400.0                  
                              1709C "Recover an RBS" "constructive algorithms,greedy,implementation,strings" "A bracket sequence is a string containing only characters ""("" and "")"". A regular bracket sequence (or, shortly, an RBS) is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example:  bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)"");  bracket sequences "")("", ""("" and "")"" are not. There was an RBS. Some brackets have been replaced with question marks. Is it true that there is a unique way to replace question marks with brackets, so that the resulting sequence is an RBS?" 1800.0                  
                              1707A "Doremy\'s IQ" "binary search,constructive algorithms,greedy,implementation" "Doremy is asked to test n contests. Contest i can only be tested on day i. The difficulty of contest i is ai. Initially, Doremy\'s IQ is q. On day i Doremy will choose whether to test contest i or not. She can only test a contest if her current IQ is strictly greater than 0.If Doremy chooses to test contest i on day i, the following happens:   if ai>q, Doremy will feel she is not wise enough, so q decreases by 1;  otherwise, nothing changes.  If she chooses not to test a contest, nothing changes.Doremy wants to test as many contests as possible. Please give Doremy a solution." 1600.0                  
                                  2400.0 1523D Love-Hate "bitmasks,brute force,dp,probabilities" "William is hosting a party for n of his trader friends. They started a discussion on various currencies they trade, but there\'s an issue: not all of his trader friends like every currency. They like some currencies, but not others.For each William\'s friend i it is known whether he likes currency j. There are m currencies in total. It is also known that a trader may not like more than p currencies.Because friends need to have some common topic for discussions they need to find the largest by cardinality (possibly empty) subset of currencies, such that there are at least \xe2\x8c\x88n2\xe2\x8c\x89 friends (rounded up) who like each currency in this subset."              
                                  2200.0 1520F2 "Guess the K-th Zero (Hard version)" "binary search,constructive algorithms,data structures,interactive" "This is an interactive problem.This is a hard version of the problem. The difference from the easy version is that in the hard version 1\xe2\x89\xa4t\xe2\x89\xa4min(n,104) and the total number of queries is limited to 6\xe2\x8b\x85104.Polycarp is playing a computer game. In this game, an array consisting of zeros and ones is hidden. Polycarp wins if he guesses the position of the k-th zero from the left t times.Polycarp can make no more than 6\xe2\x8b\x85104 requests totally of the following type:   ? l r \xe2\x80\x94 find out the sum of all elements in positions from l to r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) inclusive. To make the game more interesting, each guessed zero turns into one and the game continues on the changed array. More formally, if the position of the k-th zero was x, then after Polycarp guesses this position, the x-th element of the array will be replaced from 0 to 1.Help Polycarp win the game."              
                                  1000.0 1520C "Not Adjacent Matrix" "constructive algorithms" "We will consider the numbers a and b as adjacent if they differ by exactly one, that is, |a\xe2\x88\x92b|=1.We will consider cells of a square matrix n\xc3\x97n as adjacent if they have a common side, that is, for cell (r,c) cells (r,c\xe2\x88\x921), (r,c+1), (r\xe2\x88\x921,c) and (r+1,c) are adjacent to it.For a given number n, construct a square matrix n\xc3\x97n such that:   Each integer from 1 to n2 occurs in this matrix exactly once;  If (r1,c1) and (r2,c2) are adjacent cells, then the numbers written in them must not be adjacent."              
                                  2700.0 1519E "Off by One" "constructive algorithms,dfs and similar,geometry,graphs,sortings,trees" "There are n points on an infinite plane. The i-th point has coordinates (xi,yi) such that xi>0 and yi>0. The coordinates are not necessarily integer.In one move you perform the following operations:   choose two points a and b (a\xe2\x89\xa0b);  move point a from (xa,ya) to either (xa+1,ya) or (xa,ya+1);  move point b from (xb,yb) to either (xb+1,yb) or (xb,yb+1);  remove points a and b. However, the move can only be performed if there exists a line that passes through the new coordinates of a, new coordinates of b and (0,0). Otherwise, the move can\'t be performed and the points stay at their original coordinates (xa,ya) and (xb,yb), respectively.The numeration of points does not change after some points are removed. Once the points are removed, they can\'t be chosen in any later moves. Note that you have to move both points during the move, you can\'t leave them at their original coordinates.What is the maximum number of moves you can perform? What are these moves?If there are multiple answers, you can print any of them."              
                                  1600.0 1519D "Maximum Sum of Products" "brute force,dp,implementation,math,two pointers" "You are given two integer arrays a and b of length n.You can reverse at most one subarray (continuous subsegment) of the array a. Your task is to reverse such a subarray that the sum n\xe2\x88\x91i=1ai\xe2\x8b\x85bi is maximized."              
                                  3200.0 1517F Reunion combinatorics,dp,trees "It is reported that the 2050 Conference will be held in Yunqi Town in Hangzhou from April 23 to 25, including theme forums, morning jogging, camping and so on.The relationship between the n volunteers of the 2050 Conference can be represented by a tree (a connected undirected graph with n vertices and n\xe2\x88\x921 edges). The n vertices of the tree corresponds to the n volunteers and are numbered by 1,2,\xe2\x80\xa6,n.We define the distance between two volunteers i and j, dis(i,j) as the number of edges on the shortest path from vertex i to vertex j on the tree. dis(i,j)=0 whenever i=j.Some of the volunteers can attend the on-site reunion while others cannot. If for some volunteer x and nonnegative integer r, all volunteers whose distance to x is no more than r can attend the on-site reunion, a forum with radius r can take place. The level of the on-site reunion is defined as the maximum possible radius of any forum that can take place.Assume that each volunteer can attend the on-site reunion with probability 12 and these events are independent. Output the expected level of the on-site reunion. When no volunteer can attend, the level is defined as \xe2\x88\x921. When all volunteers can attend, the level is defined as n."              
                                  800.0 1517A "Sum of 2050" greedy,math "A number is called 2050-number if it is 2050, 20500, ..., (2050\xe2\x8b\x8510k for integer k\xe2\x89\xa50).Given a number n, you are asked to represent n as the sum of some (not necessarily distinct) 2050-numbers. Compute the minimum number of 2050-numbers required for that."              
                                  1400.0 1515C "Phoenix and Towers" "constructive algorithms,data structures,greedy" "Phoenix has n blocks of height h1,h2,\xe2\x80\xa6,hn, and all hi don\'t exceed some value x. He plans to stack all n blocks into m separate towers. The height of a tower is simply the sum of the heights of its blocks. For the towers to look beautiful, no two towers may have a height difference of strictly more than x. Please help Phoenix build m towers that look beautiful. Each tower must have at least one block and all blocks must be used."              
                                  800.0 1515A "Phoenix and Gold" "constructive algorithms,greedy,math" "Phoenix has collected n pieces of gold, and he wants to weigh them together so he can feel rich. The i-th piece of gold has weight wi. All weights are distinct. He will put his n pieces of gold on a weight scale, one piece at a time. The scale has an unusual defect: if the total weight on it is exactly x, it will explode. Can he put all n gold pieces onto the scale in some order, without the scale exploding during the process? If so, help him find some possible order. Formally, rearrange the array w so that for each i (1\xe2\x89\xa4i\xe2\x89\xa4n), i\xe2\x88\x91j=1wj\xe2\x89\xa0x."              
                                  1200.0 1512C "A-B Palindrome" "constructive algorithms,implementation,strings" "You are given a string s consisting of the characters \'0\', \'1\', and \'?\'. You need to replace all the characters with \'?\' in the string s by \'0\' or \'1\' so that the string becomes a palindrome and has exactly a characters \'0\' and exactly b characters \'1\'. Note that each of the characters \'?\' is replaced independently from the others.A string t of length n is called a palindrome if the equality t[i]=t[n\xe2\x88\x92i+1] is true for all i (1\xe2\x89\xa4i\xe2\x89\xa4n).For example, if s=""01?????0"", a=4 and b=4, then you can replace the characters \'?\' in the following ways:   ""01011010"";  ""01100110"". For the given string s and the numbers a and b, replace all the characters with \'?\' in the string s by \'0\' or \'1\' so that the string becomes a palindrome and has exactly a characters \'0\' and exactly b characters \'1\'."              
                                  2100.0 1511E "Colorings and Dominoes" combinatorics,dp,greedy,math "You have a large rectangular board which is divided into n\xc3\x97m cells (the board has n rows and m columns). Each cell is either white or black.You paint each white cell either red or blue. Obviously, the number of different ways to paint them is 2w, where w is the number of white cells.After painting the white cells of the board, you want to place the maximum number of dominoes on it, according to the following rules:  each domino covers two adjacent cells;  each cell is covered by at most one domino;  if a domino is placed horizontally (it covers two adjacent cells in one of the rows), it should cover only red cells;  if a domino is placed vertically (it covers two adjacent cells in one of the columns), it should cover only blue cells. Let the value of the board be the maximum number of dominoes you can place. Calculate the sum of values of the board over all 2w possible ways to paint it. Since it can be huge, print it modulo 998244353."              
                                  800.0 1511A "Review Site" greedy "You are an upcoming movie director, and you have just released your first movie. You have also launched a simple review site with two buttons to press \xe2\x80\x94 upvote and downvote.However, the site is not so simple on the inside. There are two servers, each with its separate counts for the upvotes and the downvotes.n reviewers enter the site one by one. Each reviewer is one of the following types:   type 1: a reviewer has watched the movie, and they like it \xe2\x80\x94 they press the upvote button;  type 2: a reviewer has watched the movie, and they dislike it \xe2\x80\x94 they press the downvote button;  type 3: a reviewer hasn\'t watched the movie \xe2\x80\x94 they look at the current number of upvotes and downvotes of the movie on the server they are in and decide what button to press. If there are more downvotes than upvotes, then a reviewer downvotes the movie. Otherwise, they upvote the movie. Each reviewer votes on the movie exactly once.Since you have two servers, you can actually manipulate the votes so that your movie gets as many upvotes as possible. When a reviewer enters a site, you know their type, and you can send them either to the first server or to the second one.What is the maximum total number of upvotes you can gather over both servers if you decide which server to send each reviewer to?"              
                                  3100.0 1508E "Tree Calendar" "brute force,constructive algorithms,data structures,dfs and similar,sortings,trees" "Yuu Koito and Touko Nanami are newlyweds! On the wedding day, Yuu gifted Touko a directed tree with n nodes and rooted at 1, and a labeling a which is some DFS order of the tree. Every edge in this tree is directed away from the root.After calling dfs(1) the following algorithm returns a as a DFS order of a tree rooted at 1 :order := 0a := array of length n function dfs(u):    order := order + 1    a[u] := order    for all v such that there is a directed edge (u -> v):        dfs(v)Note that there may be different DFS orders for a given tree.Touko likes the present so much she decided to play with it! On each day following the wedding day, Touko performs this procedure once: Among all directed edges u\xe2\x86\x92v such that au<av, select the edge u\xe2\x80\xb2\xe2\x86\x92v\xe2\x80\xb2 with the lexicographically smallest pair (au\xe2\x80\xb2,av\xe2\x80\xb2).  Swap au\xe2\x80\xb2 and av\xe2\x80\xb2.Days have passed since their wedding, and Touko has somehow forgotten which date the wedding was and what was the original labeling a! Fearing that Yuu might get angry, Touko decided to ask you to derive these two pieces of information using the current labeling.Being her good friend, you need to find the number of days that have passed since the wedding, and the original labeling of the tree. However, there is a chance that Touko might have messed up her procedures, which result in the current labeling being impossible to obtain from some original labeling; in that case, please inform Touko as well."              
                                  3000.0 1508D "Swap Pass" "constructive algorithms,geometry,sortings" "Based on a peculiar incident at basketball practice, Akari came up with the following competitive programming problem!You are given n points on the plane, no three of which are collinear. The i-th point initially has a label ai, in such a way that the labels a1,a2,\xe2\x80\xa6,an form a permutation of 1,2,\xe2\x80\xa6,n.You are allowed to modify the labels through the following operation:  Choose two distinct integers i and j between 1 and n.  Swap the labels of points i and j, and finally  Draw the segment between points i and j. A sequence of operations is valid if after applying all of the operations in the sequence in order, the k-th point ends up having the label k for all k between 1 and n inclusive, and the drawn segments don\'t intersect each other internally. Formally, if two of the segments intersect, then they must do so at a common endpoint of both segments.In particular, all drawn segments must be distinct.Find any valid sequence of operations, or say that none exist."              
                                  1000.0 1506C "Double-ended Strings" "brute force,implementation,strings" "You are given the strings a and b, consisting of lowercase Latin letters. You can do any number of the following operations in any order:   if |a|>0 (the length of the string a is greater than zero), delete the first character of the string a, that is, replace a with a2a3\xe2\x80\xa6an;  if |a|>0, delete the last character of the string a, that is, replace a with a1a2\xe2\x80\xa6an\xe2\x88\x921;  if |b|>0 (the length of the string b is greater than zero), delete the first character of the string b, that is, replace b with b2b3\xe2\x80\xa6bn;  if |b|>0, delete the last character of the string b, that is, replace b with b1b2\xe2\x80\xa6bn\xe2\x88\x921. Note that after each of the operations, the string a or b may become empty.For example, if a=""hello"" and b=""icpc"", then you can apply the following sequence of operations:   delete the first character of the string a \xe2\x87\x92 a=""ello"" and b=""icpc"";  delete the first character of the string b \xe2\x87\x92 a=""ello"" and b=""cpc"";  delete the first character of the string b \xe2\x87\x92 a=""ello"" and b=""pc"";  delete the last character of the string a \xe2\x87\x92 a=""ell"" and b=""pc"";  delete the last character of the string b \xe2\x87\x92 a=""ell"" and b=""p"". For the given strings a and b, find the minimum number of operations for which you can make the strings a and b equal. Note that empty strings are also equal."              
                                  2500.0 1505H "L BREAK into program" "*special problem" "Hack the program and get the password hidden in it."              
                                  2600.0 1505G "Encoded message" "*special problem,implementation" "InputThe first line of the input contains a single integer N (1\xe2\x89\xa4N\xe2\x89\xa424). The next N lines contain 5 space-separated integers each. The first three integers will be between 0 and 2, inclusive. The last two integers will be between 0 and 3, inclusive. The sum of the first three integers will be equal to the sum of the last two integers.OutputOutput the result \xe2\x80\x93 a string of lowercase English letters.ExamplesInputCopy11 0 0 1 0OutputCopyaInputCopy102 0 0 1 11 1 1 2 12 1 0 1 21 1 0 1 12 1 0 2 11 1 1 2 11 2 1 3 12 0 0 1 11 1 0 1 11 1 2 2 2OutputCopycodeforcez"              
                                  1800.0 1505E Cakewalk "*special problem,greedy,implementation,shortest paths" "A mouse encountered a nice big cake and decided to take a walk across it, eating the berries on top of the cake on its way. The cake is rectangular, neatly divided into squares; some of the squares have a berry in them, and some don\'t.The mouse is in a bit of a hurry, though, so once she enters the cake from its northwest corner (the top left cell in the input data), she will only go east (right) or south (down), until she reaches the southeast corner (the bottom right cell). She will eat every berry in the squares she passes through, but not in the other squares.The mouse tries to choose her path so as to maximize the number of berries consumed. However, her haste and hunger might be clouding her judgement, leading her to suboptimal decisions..."              
                                  1600.0 1503A "Balance the Bits" "constructive algorithms,greedy" "A sequence of brackets is called balanced if one can turn it into a valid math expression by adding characters \'+\' and \'1\'. For example, sequences \'(())()\', \'()\', and \'(()(()))\' are balanced, while \')(\', \'(()\', and \'(()))(\' are not.You are given a binary string s of length n. Construct two balanced bracket sequences a and b of length n such that for all 1\xe2\x89\xa4i\xe2\x89\xa4n:   if si=1, then ai=bi  if si=0, then ai\xe2\x89\xa0bi If it is impossible, you should report about it."              
                                  2500.0 1497E2 "Square-Free Division (hard version)" "data structures,dp,greedy,math,number theory,two pointers" "This is the hard version of the problem. The only difference is that in this version 0\xe2\x89\xa4k\xe2\x89\xa420.There is an array a1,a2,\xe2\x80\xa6,an of n positive integers. You should divide it into a minimal number of continuous segments, such that in each segment there are no two numbers (on different positions), whose product is a perfect square.Moreover, it is allowed to do at most k such operations before the division: choose a number in the array and change its value to any positive integer.What is the minimum number of continuous segments you should use if you will make changes optimally?"              
                                  1300.0 1493B "Planet Lapituletti" "brute force,implementation" "The time on the planet Lapituletti goes the same way it goes on Earth but a day lasts h hours and each hour lasts m minutes. The inhabitants of that planet use digital clocks similar to earth ones. Clocks display time in a format HH:MM (the number of hours in decimal is displayed first, then (after the colon) follows the number of minutes in decimal; the number of minutes and hours is written with leading zeros if needed to form a two-digit number). Hours are numbered from 0 to h\xe2\x88\x921 and minutes are numbered from 0 to m\xe2\x88\x921.  That\'s how the digits are displayed on the clock. Please note that digit 1 is placed in the middle of its position. A standard mirror is in use on the planet Lapituletti. Inhabitants often look at the reflection of the digital clocks in the mirror and feel happy when what you see on the reflected clocks is a valid time (that means that you see valid digits in the reflection and this time can be seen on the normal clocks at some moment of a day).The image of the clocks in the mirror is reflected against a vertical axis.  The reflection is not a valid time.The reflection is a valid time with h=24, m=60. However, for example, if h=10, m=60, then the reflection is not a valid time. An inhabitant of the planet Lapituletti begins to look at a mirrored image of the clocks at some time moment s and wants to know the nearest future time moment (which can possibly happen on the next day), when the reflected clock time is valid.It can be shown that with any h, m, s such a moment exists. If the reflected time is correct at the moment the inhabitant began to look at the clock, that moment is considered the nearest.You are asked to solve the problem for several test cases."              
                                  1900.0 1492D "Genius\'s Gambit" "bitmasks,constructive algorithms,greedy,math" "You are given three integers a, b, k.Find two binary integers x and y (x\xe2\x89\xa5y) such that   both x and y consist of a zeroes and b ones;  x\xe2\x88\x92y (also written in binary form) has exactly k ones.  You are not allowed to use leading zeros for x and y."              
                                  2700.0 1491F Magnets "binary search,constructive algorithms,interactive" "This is an interactive problem.Kochiya Sanae is playing with magnets. Realizing that some of those magnets are demagnetized, she is curious to find them out.There are n magnets, which can be of the following 3 types: N  S  - \xe2\x80\x94 these magnets are demagnetized. Note that you don\'t know the types of these magnets beforehand.You have a machine which can measure the force between the magnets, and you can use it at most n+\xe2\x8c\x8alog2n\xe2\x8c\x8b times.You can put some magnets to the left part of the machine and some to the right part of the machine, and launch the machine. Obviously, you can put one magnet to at most one side (you don\'t have to put all magnets). You can put the same magnet in different queries.Then the machine will tell the force these magnets produce. Formally, let n1,s1 be the number of N and S magnets correspondently on the left and n2,s2 \xe2\x80\x94 on the right. Then the force between them would be n1n2+s1s2\xe2\x88\x92n1s2\xe2\x88\x92n2s1. Please note that the force is a signed value.However, when the absolute value of the force is strictly larger than n, the machine will crash into pieces.You need to find all magnets of type - (all demagnetized ones), without breaking the machine.Note that the interactor is not adaptive. The types of the magnets are fixed before the start of the interaction and do not change with queries.It is guaranteed that there are at least 2 magnets whose type is not -, and at least 1 magnet of type -."              
                                  1700.0 1491C "Pekora and Trampoline" "brute force,data structures,dp,greedy,implementation" "There is a trampoline park with n trampolines in a line. The i-th of which has strength Si.Pekora can jump on trampolines in multiple passes. She starts the pass by jumping on any trampoline of her choice. If at the moment Pekora jumps on trampoline i, the trampoline will launch her to position i+Si, and Si will become equal to max(Si\xe2\x88\x921,1). In other words, Si will decrease by 1, except of the case Si=1, when Si will remain equal to 1. If there is no trampoline in position i+Si, then this pass is over. Otherwise, Pekora will continue the pass by jumping from the trampoline at position i+Si by the same rule as above.Pekora can\'t stop jumping during the pass until she lands at the position larger than n (in which there is no trampoline). Poor Pekora!Pekora is a naughty rabbit and wants to ruin the trampoline park by reducing all Si to 1. What is the minimum number of passes she needs to reduce all Si to 1?"              
                                  1200.0 1487B "Cat Cycle" "math,number theory" "Suppose you are living with two cats: A and B. There are n napping spots where both cats usually sleep.Your cats like to sleep and also like all these spots, so they change napping spot each hour cyclically:   Cat A changes its napping place in order: n,n\xe2\x88\x921,n\xe2\x88\x922,\xe2\x80\xa6,3,2,1,n,n\xe2\x88\x921,\xe2\x80\xa6 In other words, at the first hour it\'s on the spot n and then goes in decreasing order cyclically;  Cat B changes its napping place in order: 1,2,3,\xe2\x80\xa6,n\xe2\x88\x921,n,1,2,\xe2\x80\xa6 In other words, at the first hour it\'s on the spot 1 and then goes in increasing order cyclically. The cat B is much younger, so they have a strict hierarchy: A and B don\'t lie together. In other words, if both cats\'d like to go in spot x then the A takes this place and B moves to the next place in its order (if x<n then to x+1, but if x=n then to 1). Cat B follows his order, so it won\'t return to the skipped spot x after A frees it, but will move to the spot x+2 and so on.Calculate, where cat B will be at hour k?"              
                                  1500.0 1486B "Eastern Exhibition" "binary search,geometry,shortest paths,sortings" "You and your friends live in n houses. Each house is located on a 2D plane, in a point with integer coordinates. There might be different houses located in the same point. The mayor of the city is asking you for places for the building of the Eastern exhibition. You have to find the number of places (points with integer coordinates), so that the summary distance from all the houses to the exhibition is minimal. The exhibition can be built in the same point as some house. The distance between two points (x1,y1) and (x2,y2) is |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|, where |x| is the absolute value of x."              
                                  900.0 1486A "Shifting Stacks" greedy,implementation "You have n stacks of blocks. The i-th stack contains hi blocks and it\'s height is the number of blocks in it. In one move you can take a block from the i-th stack (if there is at least one block) and put it to the i+1-th stack. Can you make the sequence of heights strictly increasing?Note that the number of stacks always remains n: stacks don\'t disappear when they have 0 blocks."              
                                  3200.0 1482G Vabank "binary search,interactive" "Gustaw is the chief bank manager in a huge bank. He has unlimited access to the database system of the bank, in a few clicks he can move any amount of money from the bank\'s reserves to his own private account. However, the bank uses some fancy AI fraud detection system that makes stealing more difficult.Gustaw knows that the anti-fraud system just detects any operation that exceeds some fixed limit M euros and these operations are checked manually by a number of clerks. Thus, any fraud operation exceeding this limit is detected, while any smaller operation gets unnoticed.Gustaw doesn\'t know the limit M and wants to find it out. In one operation, he can choose some integer X and try to move X euros from the bank\'s reserves to his own account. Then, the following happens.   If X\xe2\x89\xa4M, the operation is unnoticed and Gustaw\'s account balance raises by X euros.  Otherwise, if X>M, the fraud is detected and cancelled. Moreover, Gustaw has to pay X euros from his own account as a fine. If he has less than X euros on the account, he is fired and taken to the police. Initially Gustaw has 1 euro on his account. Help him find the exact value of M in no more than 105 operations without getting him fired."              
                                  1100.0 1481B "New Colony" "brute force,greedy,implementation" "After reaching your destination, you want to build a new colony on the new planet. Since this planet has many mountains and the colony must be built on a flat surface you decided to flatten the mountains using boulders (you are still dreaming so this makes sense to you).  You are given an array h1,h2,\xe2\x80\xa6,hn, where hi is the height of the i-th mountain, and k \xe2\x80\x94 the number of boulders you have.You will start throwing boulders from the top of the first mountain one by one and they will roll as follows (let\'s assume that the height of the current mountain is hi):   if hi\xe2\x89\xa5hi+1, the boulder will roll to the next mountain;  if hi<hi+1, the boulder will stop rolling and increase the mountain height by 1 (hi=hi+1);  if the boulder reaches the last mountain it will fall to the waste collection system and disappear. You want to find the position of the k-th boulder or determine that it will fall into the waste collection system."              
                                  2100.0 1479B2 "Painting the Array II" "constructive algorithms,data structures,dp,greedy,implementation" "The only difference between the two versions is that this version asks the minimal possible answer.Homer likes arrays a lot. Today he is painting an array a1,a2,\xe2\x80\xa6,an with two kinds of colors, white and black. A painting assignment for a1,a2,\xe2\x80\xa6,an is described by an array b1,b2,\xe2\x80\xa6,bn that bi indicates the color of ai (0 for white and 1 for black).According to a painting assignment b1,b2,\xe2\x80\xa6,bn, the array a is split into two new arrays a(0) and a(1), where a(0) is the sub-sequence of all white elements in a and a(1) is the sub-sequence of all black elements in a. For example, if a=[1,2,3,4,5,6] and b=[0,1,0,1,0,0], then a(0)=[1,3,5,6] and a(1)=[2,4].The number of segments in an array c1,c2,\xe2\x80\xa6,ck, denoted seg(c), is the number of elements if we merge all adjacent elements with the same value in c. For example, the number of segments in [1,1,2,2,3,3,3,2] is 4, because the array will become [1,2,3,2] after merging adjacent elements with the same value. Especially, the number of segments in an empty array is 0.Homer wants to find a painting assignment b, according to which the number of segments in both a(0) and a(1), i.e. seg(a(0))+seg(a(1)), is as small as possible. Find this number."              
                                  1700.0 1478C "Nezzar and Symmetric Array" implementation,math,sortings "Long time ago there was a symmetric array a1,a2,\xe2\x80\xa6,a2n consisting of 2n distinct integers. Array a1,a2,\xe2\x80\xa6,a2n is called symmetric if for each integer 1\xe2\x89\xa4i\xe2\x89\xa42n, there exists an integer 1\xe2\x89\xa4j\xe2\x89\xa42n such that ai=\xe2\x88\x92aj.For each integer 1\xe2\x89\xa4i\xe2\x89\xa42n, Nezzar wrote down an integer di equal to the sum of absolute differences from ai to all integers in a, i. e. di=\xe2\x88\x912nj=1|ai\xe2\x88\x92aj|.Now a million years has passed and Nezzar can barely remember the array d and totally forget a. Nezzar wonders if there exists any symmetric array a consisting of 2n distinct integers that generates the array d."              
                                  3300.0 1477E "Nezzar and Tournaments" "data structures,greedy" "In the famous Oh-Suit-United tournament, two teams are playing against each other for the grand prize of precious pepper points.The first team consists of n players, and the second team consists of m players. Each player has a potential: the potential of the i-th player in the first team is ai, and the potential of the i-th player in the second team is bi.In the tournament, all players will be on the stage in some order. There will be a scoring device, initially assigned to an integer k, which will be used to value the performance of all players.The scores for all players will be assigned in the order they appear on the stage. Let the potential of the current player be x, and the potential of the previous player be y (y equals x for the first player). Then, x\xe2\x88\x92y is added to the value in the scoring device, Afterwards, if the value in the scoring device becomes negative, the value will be reset to 0. Lastly, the player\'s score is assigned to the current value on the scoring device. The score of a team is the sum of the scores of all its members.As an insane fan of the first team, Nezzar desperately wants the biggest win for the first team. He now wonders what is the maximum difference between scores of the first team and the second team.Formally, let the score of the first team be scoref and the score of the second team be scores. Nezzar wants to find the maximum value of scoref\xe2\x88\x92scores over all possible orders of players on the stage.However, situation often changes and there are q events that will happen. There are three types of events:  1 pos x \xe2\x80\x94 change apos to x;  2 pos x \xe2\x80\x94 change bpos to x;  3 x \xe2\x80\x94 tournament is held with k=x and Nezzar wants you to compute the maximum value of scoref\xe2\x88\x92scores. Can you help Nezzar to answer the queries of the third type?"              
                                  2800.0 1477D "Nezzar and Hidden Permutations" "constructive algorithms,dfs and similar,graphs" "Nezzar designs a brand new game ""Hidden Permutations"" and shares it with his best friend, Nanako.At the beginning of the game, Nanako and Nezzar both know integers n and m. The game goes in the following way:  Firstly, Nezzar hides two permutations p1,p2,\xe2\x80\xa6,pn and q1,q2,\xe2\x80\xa6,qn of integers from 1 to n, and Nanako secretly selects m unordered pairs (l1,r1),(l2,r2),\xe2\x80\xa6,(lm,rm);  After that, Nanako sends his chosen pairs to Nezzar;  On receiving those m unordered pairs, Nezzar checks if there exists 1\xe2\x89\xa4i\xe2\x89\xa4m, such that (pli\xe2\x88\x92pri) and (qli\xe2\x88\x92qri) have different signs. If so, Nezzar instantly loses the game and gets a score of \xe2\x88\x921. Otherwise, the score Nezzar gets is equal to the number of indices 1\xe2\x89\xa4i\xe2\x89\xa4n such that pi\xe2\x89\xa0qi. However, Nezzar accidentally knows Nanako\'s unordered pairs and decides to take advantage of them. Please help Nezzar find out two permutations p and q such that the score is maximized."              
                                  2200.0 1477C "Nezzar and Nice Beatmap" "constructive algorithms,geometry,greedy,math,sortings" "Nezzar loves the game osu!.osu! is played on beatmaps, which can be seen as an array consisting of distinct points on a plane. A beatmap is called nice if for any three consecutive points A,B,C listed in order, the angle between these three points, centered at B, is strictly less than 90 degrees.  Points A,B,C on the left have angle less than 90 degrees, so they can be three consecutive points of a nice beatmap; Points A\xe2\x80\xb2,B\xe2\x80\xb2,C\xe2\x80\xb2 on the right have angle greater or equal to 90 degrees, so they cannot be three consecutive points of a nice beatmap. Now Nezzar has a beatmap of n distinct points A1,A2,\xe2\x80\xa6,An. Nezzar would like to reorder these n points so that the resulting beatmap is nice.Formally, you are required to find a permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n, such that beatmap Ap1,Ap2,\xe2\x80\xa6,Apn is nice. If it is impossible, you should determine it."              
                                  1900.0 1477B "Nezzar and Binary String" "data structures,greedy" "Nezzar has a binary string s of length n that he wants to share with his best friend, Nanako. Nanako will spend q days inspecting the binary string. At the same time, Nezzar wants to change the string s into string f during these q days, because it looks better.It is known that Nanako loves consistency so much. On the i-th day, Nanako will inspect a segment of string s from position li to position ri inclusive. If the segment contains both characters \'0\' and \'1\', Nanako becomes unhappy and throws away the string.After this inspection, at the i-th night, Nezzar can secretly change strictly less than half of the characters in the segment from li to ri inclusive, otherwise the change will be too obvious.Now Nezzar wonders, if it is possible to avoid Nanako being unhappy and at the same time have the string become equal to the string f at the end of these q days and nights."              
                                  2300.0 1476E "Pattern Matching" "bitmasks,data structures,dfs and similar,graphs,hashing,sortings,strings" "You are given n patterns p1,p2,\xe2\x80\xa6,pn and m strings s1,s2,\xe2\x80\xa6,sm. Each pattern pi consists of k characters that are either lowercase Latin letters or wildcard characters (denoted by underscores). All patterns are pairwise distinct. Each string sj consists of k lowercase Latin letters.A string a matches a pattern b if for each i from 1 to k either bi is a wildcard character or bi=ai.You are asked to rearrange the patterns in such a way that the first pattern the j-th string matches is p[mtj]. You are allowed to leave the order of the patterns unchanged.Can you perform such a rearrangement? If you can, then print any valid order."              
                                  1400.0 1475C "Ball in Berland" combinatorics,graphs,math "At the school where Vasya is studying, preparations are underway for the graduation ceremony. One of the planned performances is a ball, which will be attended by pairs of boys and girls.Each class must present two couples to the ball. In Vasya\'s class, a boys and b girls wish to participate. But not all boys and not all girls are ready to dance in pairs.Formally, you know k possible one-boy-one-girl pairs. You need to choose two of these pairs so that no person is in more than one pair.For example, if a=3, b=4, k=4 and the couples (1,2), (1,3), (2,2), (3,4) are ready to dance together (in each pair, the boy\'s number comes first, then the girl\'s number), then the following combinations of two pairs are possible (not all possible options are listed below):   (1,3) and (2,2);  (3,4) and (1,3); But the following combinations are not possible:   (1,3) and (1,2) \xe2\x80\x94 the first boy enters two pairs;  (1,2) and (2,2) \xe2\x80\x94 the second girl enters two pairs; Find the number of ways to select two pairs that match the condition above. Two ways are considered different if they consist of different pairs."              
                                  900.0 1475A "Odd Divisor" "math,number theory" "You are given an integer n. Check if n has an odd divisor, greater than one (does there exist such a number x (x>1) that n is divisible by x and x is odd).For example, if n=6, then there is x=3. If n=4, then such a number does not exist."              
                                  1100.0 1472C "Long Jumps" dp,graphs "Polycarp found under the Christmas tree an array a of n elements and instructions for playing with it:   At first, choose index i (1\xe2\x89\xa4i\xe2\x89\xa4n) \xe2\x80\x94 starting position in the array. Put the chip at the index i (on the value ai).  While i\xe2\x89\xa4n, add ai to your score and move the chip ai positions to the right (i.e. replace i with i+ai).  If i>n, then Polycarp ends the game. For example, if n=5 and a=[7,3,1,2,3], then the following game options are possible:   Polycarp chooses i=1. Game process: i=1+7\xe2\x9f\xb68. The score of the game is: a1=7.  Polycarp chooses i=2. Game process: i=2+3\xe2\x9f\xb65+3\xe2\x9f\xb68. The score of the game is: a2+a5=6.  Polycarp chooses i=3. Game process: i=3+1\xe2\x9f\xb64+2\xe2\x9f\xb66. The score of the game is: a3+a4=3.  Polycarp chooses i=4. Game process: i=4+2\xe2\x9f\xb66. The score of the game is: a4=2.  Polycarp chooses i=5. Game process: i=5+3\xe2\x9f\xb68. The score of the game is: a5=3. Help Polycarp to find out the maximum score he can get if he chooses the starting index in an optimal way."              
                                  900.0 1471A "Strange Partition" "greedy,math,number theory" "You are given an array a of length n, and an integer x. You can perform the following operation as many times as you would like (possibly zero): replace two adjacent elements of the array by their sum. For example, if the initial array was [3,6,9], in a single operation one can replace the last two elements by their sum, yielding an array [3,15], or replace the first two elements to get an array [9,9]. Note that the size of the array decreases after each operation.The beauty of an array b=[b1,\xe2\x80\xa6,bk] is defined as \xe2\x88\x91ki=1\xe2\x8c\x88bix\xe2\x8c\x89, which means that we divide each element by x, round it up to the nearest integer, and sum up the resulting values. For example, if x=3, and the array is [4,11,6], the beauty of the array is equal to \xe2\x8c\x8843\xe2\x8c\x89+\xe2\x8c\x88113\xe2\x8c\x89+\xe2\x8c\x8863\xe2\x8c\x89=2+4+2=8.Please determine the minimum and the maximum beauty you can get by performing some operations on the original array."              
                                  1700.0 1468F "Full Turn" "geometry,hashing,number theory" "There are n persons located on a plane. The i-th person is located at the point (xi,yi) and initially looks at the point (ui,vi).At the same moment of time, all persons will start to rotate clockwise synchronously with the same angular speed. They will rotate until they do one full 360-degree turn. It is said that persons A and B made eye contact if person A looks in person B\'s direction at the same moment when person B looks in person A\'s direction. If there is a person C located between persons A and B, that will not obstruct A and B from making eye contact. A person can make eye contact with more than one person at the same time.Calculate the number of pairs of persons that will make eye contact at least once during the rotation (including the initial moment)."              
                                  1700.0 1467B "Hills And Valleys" "brute force,implementation" "You are given a sequence of n integers a1, a2, ..., an. Let us call an index j (2\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x921) a hill if aj>aj+1 and aj>aj\xe2\x88\x921; and let us call it a valley if aj<aj+1 and aj<aj\xe2\x88\x921.Let us define the intimidation value of a sequence as the sum of the number of hills and the number of valleys in the sequence. You can change exactly one integer in the sequence to any number that you want, or let the sequence remain unchanged. What is the minimum intimidation value that you can achieve?"              
                                  900.0 1467A "Wizard of Orz" "constructive algorithms,greedy,math" "There are n digital panels placed in a straight line. Each panel can show any digit from 0 to 9. Initially, all panels show 0.Every second, the digit shown by each panel increases by 1. In other words, at the end of every second, a panel that showed 9 would now show 0, a panel that showed 0 would now show 1, a panel that showed 1 would now show 2, and so on.When a panel is paused, the digit displayed on the panel does not change in the subsequent seconds.You must pause exactly one of these panels, at any second you wish. Then, the panels adjacent to it get paused one second later, the panels adjacent to those get paused 2 seconds later, and so on. In other words, if you pause panel x, panel y (for all valid y) would be paused exactly |x\xe2\x88\x92y| seconds later.For example, suppose there are 4 panels, and the 3-rd panel is paused when the digit 9 is on it.  The panel 1 pauses 2 seconds later, so it has the digit 1;  the panel 2 pauses 1 second later, so it has the digit 0;  the panel 4 pauses 1 second later, so it has the digit 0. The resulting 4-digit number is 1090. Note that this example is not optimal for n=4.Once all panels have been paused, you write the digits displayed on them from left to right, to form an n digit number (it can consist of leading zeros). What is the largest possible number you can get? Initially, all panels show 0."              
                                  2100.0 1466F "Euclid\'s nightmare" "bitmasks,dfs and similar,dsu,graphs,greedy,math,sortings" "You may know that Euclid was a mathematician. Well, as it turns out, Morpheus knew it too. So when he wanted to play a mean trick on Euclid, he sent him an appropriate nightmare. In his bad dream Euclid has a set S of n m-dimensional vectors over the Z2 field and can perform vector addition on them. In other words he has vectors with m coordinates, each one equal either 0 or 1. Vector addition is defined as follows: let u+v=w, then wi=(ui+vi)mod2. Euclid can sum any subset of S and archive another m-dimensional vector over Z2. In particular, he can sum together an empty subset; in such a case, the resulting vector has all coordinates equal 0.Let T be the set of all the vectors that can be written as a sum of some vectors from S. Now Euclid wonders the size of T and whether he can use only a subset S\xe2\x80\xb2 of S to obtain all the vectors from T. As it is usually the case in such scenarios, he will not wake up until he figures this out. So far, things are looking rather grim for the philosopher. But there is hope, as he noticed that all vectors in S have at most 2 coordinates equal 1. Help Euclid and calculate |T|, the number of m-dimensional vectors over Z2 that can be written as a sum of some vectors from S. As it can be quite large, calculate it modulo 109+7. You should also find S\xe2\x80\xb2, the smallest such subset of S, that all vectors in T can be written as a sum of vectors from S\xe2\x80\xb2. In case there are multiple such sets with a minimal number of elements, output the lexicographically smallest one with respect to the order in which their elements are given in the input. Consider sets A and B such that |A|=|B|. Let a1,a2,\xe2\x80\xa6a|A| and b1,b2,\xe2\x80\xa6b|B| be increasing arrays of indices elements of A and B correspondingly. A is lexicographically smaller than B iff there exists such i that aj=bj for all j<i and ai<bi."              
                                  1300.0 1466C "Canine poetry" dp,greedy,strings "After his wife\'s tragic death, Eurydice, Orpheus descended to the realm of death to see her. Reaching its gates was uneasy, but passing through them proved to be even more challenging. Mostly because of Cerberus, the three-headed hound of Hades. Orpheus, a famous poet, and musician plans to calm Cerberus with his poetry and safely walk past him. He created a very peculiar poem for Cerberus. It consists only of lowercase English letters. We call a poem\'s substring a palindrome if and only if it reads the same backwards and forwards. A string a is a substring of a string b if a can be obtained from b by deleting several (possibly zero or all) characters from the beginning and several (possibly zero or all) characters from the end.Unfortunately, Cerberus dislikes palindromes of length greater than 1. For example in the poem abaa the hound of Hades wouldn\'t like substrings aba and aa.Orpheus can only calm Cerberus if the hound likes his poetry. That\'s why he wants to change his poem so that it does not contain any palindrome substrings of length greater than 1.Orpheus can modify the poem by replacing a letter at any position with any lowercase English letter. He can use this operation arbitrarily many times (possibly zero). Since there can be many palindromes in his poem, he may have to make some corrections. But how many, exactly? Given the poem, determine the minimal number of letters that have to be changed so that the poem does not contain any palindromes of length greater than 1."              
                                  800.0 1462B "Last Year\'s Substring" dp,implementation,strings "Polycarp has a string s[1\xe2\x80\xa6n] of length n consisting of decimal digits. Polycarp performs the following operation with the string s no more than once (i.e. he can perform operation 0 or 1 time):   Polycarp selects two numbers i and j (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n) and removes characters from the s string at the positions i,i+1,i+2,\xe2\x80\xa6,j (i.e. removes substring s[i\xe2\x80\xa6j]). More formally, Polycarp turns the string s into the string s1s2\xe2\x80\xa6si\xe2\x88\x921sj+1sj+2\xe2\x80\xa6sn. For example, the string s=""20192020"" Polycarp can turn into strings:   ""2020"" (in this case (i,j)=(3,6) or (i,j)=(1,4));  ""2019220"" (in this case (i,j)=(6,6));  ""020"" (in this case (i,j)=(1,5));  other operations are also possible, only a few of them are listed above. Polycarp likes the string ""2020"" very much, so he is wondering if it is possible to turn the string s into a string ""2020"" in no more than one operation? Note that you can perform zero operations."              
                                  2900.0 1455G "Forbidden Value" "data structures,dp" "Polycarp is editing a complicated computer program. First, variable x is declared and assigned to 0. Then there are instructions of two types:   set y v \xe2\x80\x94 assign x a value y or spend v burles to remove that instruction (thus, not reassign x);  if y \xe2\x80\xa6 end block \xe2\x80\x94 execute instructions inside the if block if the value of x is y and ignore the block otherwise. if blocks can contain set instructions and other if blocks inside them.However, when the value of x gets assigned to s, the computer breaks and immediately catches fire. Polycarp wants to prevent that from happening and spend as few burles as possible.What is the minimum amount of burles he can spend on removing set instructions to never assign x to s?"              
                                  800.0 1454A "Special Permutation" "constructive algorithms,probabilities" "You are given one integer n (n>1).Recall that a permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation of length 5, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).Your task is to find a permutation p of length n that there is no index i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that pi=i (so, for all i from 1 to n the condition pi\xe2\x89\xa0i should be satisfied).You have to answer t independent test cases.If there are several answers, you can print any. It can be proven that the answer exists for each n>1."              
                                  800.0 1453A "Cancel the Trains" implementation "Gildong\'s town has a train system that has 100 trains that travel from the bottom end to the top end and 100 trains that travel from the left end to the right end. The trains starting from each side are numbered from 1 to 100, respectively, and all trains have the same speed. Let\'s take a look at the picture below.  The train system can be represented as coordinates on a 2D plane. The i-th train starting at the bottom end is initially at (i,0) and will be at (i,T) after T minutes, and the i-th train starting at the left end is initially at (0,i) and will be at (T,i) after T minutes. All trains arrive at their destinations after 101 minutes.However, Gildong found that some trains scheduled to depart at a specific time, simultaneously, are very dangerous. At this time, n trains are scheduled to depart from the bottom end and m trains are scheduled to depart from the left end. If two trains are both at (x,y) at the same time for some x and y, they will crash into each other. Therefore, he is asking you to find the minimum number of trains that should be cancelled to prevent all such crashes."              
                                  2700.0 1451F "Nullify The Matrix" "constructive algorithms,games" "Jeel and Ashish play a game on an n\xc3\x97m matrix. The rows are numbered 1 to n from top to bottom and the columns are numbered 1 to m from left to right. They play turn by turn. Ashish goes first.Initially, each cell of the matrix contains a non-negative integer. Each turn, a player must perform all of the following actions in order.   Choose a starting cell (r1,c1) with non-zero value.  Choose a finishing cell (r2,c2) such that r1\xe2\x89\xa4r2 and c1\xe2\x89\xa4c2.  Decrease the value of the starting cell by some positive non-zero integer.  Pick any of the shortest paths between the two cells and either increase, decrease or leave the values of cells on this path unchanged. Note that:   a shortest path is one that passes through the least number of cells;  all cells on this path excluding the starting cell, but the finishing cell may be modified;  the resulting value of each cell must be a non-negative integer;  the cells are modified independently and not necessarily by the same value.  If the starting and ending cells are the same, then as per the rules, the value of the cell is decreased. No other operations are performed.The game ends when all the values become zero. The player who is unable to make a move loses. It can be shown that the game will end in a finite number of moves if both players play optimally.Given the initial matrix, if both players play optimally, can you predict who will win?"              
                                  800.0 1451A "Subtract or Divide" greedy,math "Ridbit starts with an integer n.In one move, he can perform one of the following operations:   divide n by one of its proper divisors, or  subtract 1 from n if n is greater than 1. A proper divisor is a divisor of a number, excluding itself. For example, 1, 2, 4, 5, and 10 are proper divisors of 20, but 20 itself is not.What is the minimum number of moves Ridbit is required to make to reduce n to 1?"              
                                  1800.0 1446B "Catching Cheaters" dp,strings "You are given two strings A and B representing essays of two students who are suspected cheaters. For any two strings C, D we define their similarity score S(C,D) as 4\xe2\x8b\x85LCS(C,D)\xe2\x88\x92|C|\xe2\x88\x92|D|, where LCS(C,D) denotes the length of the Longest Common Subsequence of strings C and D. You believe that only some part of the essays could have been copied, therefore you\'re interested in their substrings.Calculate the maximal similarity score over all pairs of substrings. More formally, output maximal S(C,D) over all pairs (C,D), where C is some substring of A, and D is some substring of B. If X is a string, |X| denotes its length.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters. Pay attention to the difference between the substring and subsequence, as they both appear in the problem statement. You may wish to read the Wikipedia page about the Longest Common Subsequence problem."              
                                  900.0 1445B Elimination greedy,math "There is a famous olympiad, which has more than a hundred participants. The Olympiad consists of two stages: the elimination stage, and the final stage. At least a hundred participants will advance to the final stage. The elimination stage in turn consists of two contests.A result of the elimination stage is the total score in two contests, but, unfortunately, the jury lost the final standings and has only standings for the first and for the second contest separately. In each contest, the participants are ranked by their point score in non-increasing order. When two participants have a tie (earned the same score), they are ranked by their passport number (in accordance with local regulations, all passport numbers are distinct). In the first contest, the participant on the 100-th place scored a points. Also, the jury checked all participants from the 1-st to the 100-th place (inclusive) in the first contest and found out that all of them have at least b points in the second contest.Similarly, for the second contest, the participant on the 100-th place has c points. And the jury checked that all the participants from the 1-st to the 100-th place (inclusive) have at least d points in the first contest.After two contests, all participants are ranked by their total score in two contests in non-increasing order. When participants have the same total score, tie-breaking with passport numbers is used. The cutoff score to qualify to the final stage is the total score of the participant on the 100-th place.Given integers a, b, c, d, please help the jury determine the smallest possible value of the cutoff score."              
                                  3500.0 1444E "Finding the Vertex" "brute force,dfs and similar,dp,interactive,trees" "This is an interactive problem.You are given a tree \xe2\x80\x94 connected undirected graph without cycles. One vertex of the tree is special, and you have to find which one. You can ask questions in the following form: given an edge of the tree, which endpoint is closer to the special vertex, meaning which endpoint\'s shortest path to the special vertex contains fewer edges. You have to find the special vertex by asking the minimum number of questions in the worst case for a given tree.Please note that the special vertex might not be fixed by the interactor in advance: it might change the vertex to any other one, with the requirement of being consistent with the previously given answers."              
                                  2900.0 1444D "Rectangular Polyline" "constructive algorithms,dp,geometry" "One drew a closed polyline on a plane, that consisted only of vertical and horizontal segments (parallel to the coordinate axes). The segments alternated between horizontal and vertical ones (a horizontal segment was always followed by a vertical one, and vice versa). The polyline did not contain strict self-intersections, which means that in case any two segments shared a common point, that point was an endpoint for both of them (please consult the examples in the notes section).Unfortunately, the polyline was erased, and you only know the lengths of the horizonal and vertical segments. Please construct any polyline matching the description with such segments, or determine that it does not exist."              
                                  2400.0 1443E "Long Permutation" "brute force,math,two pointers" "A permutation is a sequence of integers from 1 to n of length n containing each number exactly once. For example, [1], [4,3,5,1,2], [3,2,1] \xe2\x80\x94 are permutations, and [1,1], [4,3,1], [2,3,4] \xe2\x80\x94 no.Permutation a is lexicographically smaller than permutation b (they have the same length n), if in the first index i in which they differ, a[i]<b[i]. For example, the permutation [1,3,2,4] is lexicographically smaller than the permutation [1,3,4,2], because the first two elements are equal, and the third element in the first permutation is smaller than in the second.The next permutation for a permutation a of length n \xe2\x80\x94 is the lexicographically smallest permutation b of length n that lexicographically larger than a. For example:   for permutation [2,1,4,3] the next permutation is [2,3,1,4];  for permutation [1,2,3] the next permutation is [1,3,2];  for permutation [2,1] next permutation does not exist. You are given the number n \xe2\x80\x94 the length of the initial permutation. The initial permutation has the form a=[1,2,\xe2\x80\xa6,n]. In other words, a[i]=i (1\xe2\x89\xa4i\xe2\x89\xa4n).You need to process q queries of two types:   1 l r: query for the sum of all elements on the segment [l,r]. More formally, you need to find a[l]+a[l+1]+\xe2\x80\xa6+a[r].  2 x: x times replace the current permutation with the next permutation. For example, if x=2 and the current permutation has the form [1,3,4,2], then we should perform such a chain of replacements [1,3,4,2]\xe2\x86\x92[1,4,2,3]\xe2\x86\x92[1,4,3,2]. For each query of the 1-st type output the required sum."              
                                  3100.0 1439D "INOI Final Contests" combinatorics,dp,fft "Today is the final contest of INOI (Iranian National Olympiad in Informatics). The contest room is a row with n computers. All computers are numbered with integers from 1 to n from left to right. There are m participants, numbered with integers from 1 to m.We have an array a of length m where ai (1\xe2\x89\xa4ai\xe2\x89\xa4n) is the computer behind which the i-th participant wants to sit.Also, we have another array b of length m consisting of characters \'L\' and \'R\'. bi is the side from which the i-th participant enters the room. \'L\' means the participant enters from the left of computer 1 and goes from left to right, and \'R\' means the participant enters from the right of computer n and goes from right to left.The participants in the order from 1 to m enter the room one by one. The i-th of them enters the contest room in the direction bi and goes to sit behind the ai-th computer. If it is occupied he keeps walking in his direction until he reaches the first unoccupied computer. After that, he sits behind it. If he doesn\'t find any computer he gets upset and gives up on the contest.The madness of the i-th participant is the distance between his assigned computer (ai) and the computer he ends up sitting behind. The distance between computers i and j is equal to |i\xe2\x88\x92j|.The values in the array a can be equal. There exist nm\xe2\x8b\x852m possible pairs of arrays (a,b).Consider all pairs of arrays (a,b) such that no person becomes upset. For each of them let\'s calculate the sum of participants madnesses. Find the sum of all these values.You will be given some prime modulo p. Find this sum by modulo p."              
                                  1800.0 1437C "Chef Monocarp" "dp,flows,graph matchings,greedy,math,sortings" "Chef Monocarp has just put n dishes into an oven. He knows that the i-th dish has its optimal cooking time equal to ti minutes.At any positive integer minute T Monocarp can put no more than one dish out of the oven. If the i-th dish is put out at some minute T, then its unpleasant value is |T\xe2\x88\x92ti| \xe2\x80\x94 the absolute difference between T and ti. Once the dish is out of the oven, it can\'t go back in.Monocarp should put all the dishes out of the oven. What is the minimum total unpleasant value Monocarp can obtain?"              
                                  900.0 1436B "Prime Square" "constructive algorithms,math" "Sasha likes investigating different math objects, for example, magic squares. But Sasha understands that magic squares have already been studied by hundreds of people, so he sees no sense of studying them further. Instead, he invented his own type of square \xe2\x80\x94 a prime square. A square of size n\xc3\x97n is called prime if the following three conditions are held simultaneously:   all numbers on the square are non-negative integers not exceeding 105;  there are no prime numbers in the square;  sums of integers in each row and each column are prime numbers. Sasha has an integer n. He asks you to find any prime square of size n\xc3\x97n. Sasha is absolutely sure such squares exist, so just help him!"              
                                  800.0 1436A Reorder math "For a given array a consisting of n integers and a given integer m find if it is possible to reorder elements of the array a in such a way that \xe2\x88\x91ni=1\xe2\x88\x91nj=iajj equals m? It is forbidden to delete elements as well as insert new elements. Please note that no rounding occurs during division, for example, 52=2.5."              
                                  2100.0 1433F "Zero Remainder Sum" dp "You are given a matrix a of size n\xc3\x97m consisting of integers.You can choose no more than \xe2\x8c\x8am2\xe2\x8c\x8b elements in each row. Your task is to choose these elements in such a way that their sum is divisible by k and this sum is the maximum.In other words, you can choose no more than a half (rounded down) of elements in each row, you have to find the maximum sum of these elements divisible by k.Note that you can choose zero elements (and the sum of such set is 0)."              
                                  2100.0 1431F "Neural Network Problem" "*special problem,binary search,greedy" "You want to train a neural network model for your graduation work. There are n images in the dataset, the i-th image\'s size is ai bytes.You don\'t have any powerful remote servers to train this model so you have to do it on your local machine. But there is a problem: the total size of the dataset is too big for your machine, so you decided to remove some images \xe2\x80\x94 though you don\'t want to make the dataset too weak so you can remove no more than k images from it. Note that you can only remove images, you can\'t change their order.You want to remove these images optimally so you came up with a metric (you\'re a data scientist after all) that allows to measure the result of removals. Consider the array b1,b2,\xe2\x80\xa6,bm after removing at most k images (n\xe2\x88\x92k\xe2\x89\xa4m\xe2\x89\xa4n). The data from this array will be uploaded to the machine in blocks of x consecutive elements each. More precisely:  elements with indices from 1 to x (b1,b2,\xe2\x80\xa6,bx) belong to the first block;  elements with indices from x+1 to 2x (bx+1,bx+2,\xe2\x80\xa6,b2x) belong to the second block;  elements with indices from 2x+1 to 3x (b2x+1,b2x+2,\xe2\x80\xa6,b3x) belong to the third block;  and so on. There will be cnt=\xe2\x8c\x88mx\xe2\x8c\x89 blocks in total. Note that if m is not divisible by x then the last block contains less than x elements, and it\'s okay.Let w(i) be the total size of the i-th block \xe2\x80\x94 that is, the sum of sizes of images inside this block. For example, the size of the first block w(1) is b1+b2+\xe2\x80\xa6+bx, the size of the second block w(2) is bx+1+bx+2+\xe2\x80\xa6+b2x.The value of the metric you came up with is the maximum block size over the blocks of the resulting dataset. In other words, the value of the metric is cntmaxi=1w(i).You don\'t want to overload your machine too much, so you have to remove at most k images in a way that minimizes the value of the metric described above."              
                                  2000.0 1431E "Chess Match" "*special problem" "The final of Berland Chess Team Championship is going to be held soon. Two teams consisting of n chess players each will compete for first place in the tournament. The skill of the i-th player in the first team is ai, and the skill of the i-th player in the second team is bi. The match will be held as follows: each player of the first team will play a game against one player from the second team in such a way that every player has exactly one opponent. Formally, if the player i from the first team opposes the player pi from the second team, then [p1,p2,\xe2\x80\xa6,pn] is a permutation (a sequence where each integer from 1 to n appears exactly once).Whenever two players of almost equal skill play a game, it will likely result in a tie. Chess fans don\'t like ties, so the organizers of the match should distribute the players in such a way that ties are unlikely.Let the unfairness of the match be the following value: nmini=1|ai\xe2\x88\x92bpi|. Your task is to assign each player from the first team an opponent from the second team so that the unfairness is maximum possible (the greater it is, the smaller the probability of ties is, that\'s why you should maximize it)."              
                                  1600.0 1431C "Black Friday" "*special problem,implementation" "There is a local shop in your area getting prepared for the great holiday of Black Friday. There are n items with prices p1,p2,\xe2\x80\xa6,pn on the display. They are ordered by price, so p1\xe2\x89\xa4p2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4pn.The shop has a prechosen discount value k. The Black Friday discount is applied in the following way: for a single purchase of x items, you get the cheapest \xe2\x8c\x8axk\xe2\x8c\x8b items of them for free (\xe2\x8c\x8axk\xe2\x8c\x8b is x divided by k rounded down to the nearest integer). You can include each item in your purchase no more than once.For example, if there are items with prices [1,1,2,2,2,3,4,5,6] in the shop, and you buy items with prices [1,2,2,4,5], and k=2, then you get the cheapest \xe2\x8c\x8a52\xe2\x8c\x8b=2 for free. They are items with prices 1 and 2.So you, being the naive customer, don\'t care about how much money you spend. However, you want the total price of the items you get for free to be as large as possible.What is the maximum total price of the items you can get for free on a single purchase?"              
                                  1400.0 1431B "Polycarp and the Language of Gods" "*special problem,implementation,two pointers" "Polycarp has just finished writing down the lecture on elvish languages. The language this week was ""VwV"" (pronounced as ""uwu""). The writing system of this language consists of only two lowercase Latin letters: \'v\' and \'w\'.Unfortunately, Polycarp has written all the lecture in cursive and without any spaces, so the notes look like a neverending sequence of squiggles. To be exact, Polycarp can\'t tell \'w\' apart from \'vv\' in his notes as both of them consist of the same two squiggles.Luckily, his brother Monocarp has better writing habits, so Polycarp managed to take his notes and now wants to make his own notes more readable. To do that he can follow the notes of Monocarp and underline some letters in his own notes in such a way that there is no more ambiguity. If he underlines a \'v\', then it can\'t be mistaken for a part of some \'w\', and if the underlines a \'w\', then it can\'t be mistaken for two adjacent letters \'v\'.What is the minimum number of letters Polycarp should underline to make his notes unambiguous?"              
                                  1900.0 1430E "String Reversal" "data structures,greedy,strings" "You are given a string s. You have to reverse it \xe2\x80\x94 that is, the first letter should become equal to the last letter before the reversal, the second letter should become equal to the second-to-last letter before the reversal \xe2\x80\x94 and so on. For example, if your goal is to reverse the string ""abddea"", you should get the string ""aeddba"". To accomplish your goal, you can swap the neighboring elements of the string. Your task is to calculate the minimum number of swaps you have to perform to reverse the given string."              
                                  900.0 1430A "Number of Apartments" "brute force,constructive algorithms,math" "Recently a new building with a new layout was constructed in Monocarp\'s hometown. According to this new layout, the building consists of three types of apartments: three-room, five-room, and seven-room apartments. It\'s also known that each room of each apartment has exactly one window. In other words, a three-room apartment has three windows, a five-room \xe2\x80\x94 five windows, and a seven-room \xe2\x80\x94 seven windows.Monocarp went around the building and counted n windows. Now he is wondering, how many apartments of each type the building may have.Unfortunately, Monocarp only recently has learned to count, so he is asking you to help him to calculate the possible quantities of three-room, five-room, and seven-room apartments in the building that has n windows. If there are multiple answers, you can print any of them.Here are some examples:  if Monocarp has counted 30 windows, there could have been 2 three-room apartments, 2 five-room apartments and 2 seven-room apartments, since 2\xe2\x8b\x853+2\xe2\x8b\x855+2\xe2\x8b\x857=30;  if Monocarp has counted 67 windows, there could have been 7 three-room apartments, 5 five-room apartments and 3 seven-room apartments, since 7\xe2\x8b\x853+5\xe2\x8b\x855+3\xe2\x8b\x857=67;  if Monocarp has counted 4 windows, he should have mistaken since no building with the aforementioned layout can have 4 windows."              
                                  1800.0 1426E "Rock, Paper, Scissors" "brute force,constructive algorithms,flows,greedy,math" "Alice and Bob have decided to play the game ""Rock, Paper, Scissors"". The game consists of several rounds, each round is independent of each other. In each round, both players show one of the following things at the same time: rock, paper or scissors. If both players showed the same things then the round outcome is a draw. Otherwise, the following rules applied:  if one player showed rock and the other one showed scissors, then the player who showed rock is considered the winner and the other one is considered the loser;  if one player showed scissors and the other one showed paper, then the player who showed scissors is considered the winner and the other one is considered the loser;  if one player showed paper and the other one showed rock, then the player who showed paper is considered the winner and the other one is considered the loser. Alice and Bob decided to play exactly n rounds of the game described above. Alice decided to show rock a1 times, show scissors a2 times and show paper a3 times. Bob decided to show rock b1 times, show scissors b2 times and show paper b3 times. Though, both Alice and Bob did not choose the sequence in which they show things. It is guaranteed that a1+a2+a3=n and b1+b2+b3=n.Your task is to find two numbers:  the minimum number of round Alice can win;  the maximum number of rounds Alice can win."              
                                  900.0 1426B "Symmetric Matrix" implementation "Masha has n types of tiles of size 2\xc3\x972. Each cell of the tile contains one integer. Masha has an infinite number of tiles of each type.Masha decides to construct the square of size m\xc3\x97m consisting of the given tiles. This square also has to be a symmetric with respect to the main diagonal matrix, and each cell of this square has to be covered with exactly one tile cell, and also sides of tiles should be parallel to the sides of the square. All placed tiles cannot intersect with each other. Also, each tile should lie inside the square. See the picture in Notes section for better understanding.Symmetric with respect to the main diagonal matrix is such a square s that for each pair (i,j) the condition s[i][j]=s[j][i] holds. I.e. it is true that the element written in the i-row and j-th column equals to the element written in the j-th row and i-th column.Your task is to determine if Masha can construct a square of size m\xc3\x97m which is a symmetric matrix and consists of tiles she has. Masha can use any number of tiles of each type she has to construct the square. Note that she can not rotate tiles, she can only place them in the orientation they have in the input.You have to answer t independent test cases."              
                                  1300.0 1425H "Huge Boxes of Animal Toys" "constructive algorithms" "Chaneka has a hobby of playing with animal toys. Every toy has a different fun value, a real number. Chaneka has four boxes to store the toys with specification:   The first box stores toys with fun values in range of (\xe2\x88\x92\xe2\x88\x9e,\xe2\x88\x921].  The second box stores toys with fun values in range of (\xe2\x88\x921,0).  The third box stores toys with fun values in range of (0,1).  The fourth box stores toys with fun value in range of [1,\xe2\x88\x9e). Chaneka has A, B, C, D toys in the first, second, third, and fourth box, respectively. One day she decides that she only wants one toy, a super toy. So she begins to create this super toy by sewing all the toys she has.While the number of toys Chaneka has is more than 1, she takes two different toys randomly and then sews them together, creating a new toy. The fun value of this new toy is equal to the multiplication of fun values of the sewn toys. She then puts this new toy in the appropriate box. She repeats this process until she only has one toy. This last toy is the super toy, and the box that stores this toy is the special box.As an observer, you only know the number of toys in each box initially but do not know their fun values. You also don\'t see the sequence of Chaneka\'s sewing. Determine which boxes can be the special box after Chaneka found her super toy."              
                                  1400.0 1425F "Flamingoes of Mystery" interactive "This is an interactive problem. You have to use a flush operation right after printing each line. For example, in C++ you should use the function fflush(stdout), in Java \xe2\x80\x94 System.out.flush(), in Pascal \xe2\x80\x94 flush(output) and in Python \xe2\x80\x94 sys.stdout.flush().Mr. Chanek wants to buy a flamingo to accompany his chickens on his farm. Before going to the pet shop, Mr. Chanek stops at an animal festival to have fun. It turns out there is a carnival game with a flamingo as the prize.There are N mysterious cages, which are numbered from 1 to N. Cage i has Ai (0\xe2\x89\xa4Ai\xe2\x89\xa4103) flamingoes inside (1\xe2\x89\xa4i\xe2\x89\xa4N). However, the game master keeps the number of flamingoes inside a secret. To win the flamingo, Mr. Chanek must guess the number of flamingoes in each cage.Coincidentally, Mr. Chanek has N coins. Each coin can be used to ask once, what is the total number of flamingoes inside cages numbered L to R inclusive? With L<R."              
                                  1300.0 1424G Years "data structures,sortings" "During one of the space missions, humans have found an evidence of previous life at one of the planets. They were lucky enough to find a book with birth and death years of each individual that had been living at this planet. What\'s interesting is that these years are in the range (1,109)! Therefore, the planet was named Longlifer.In order to learn more about Longlifer\'s previous population, scientists need to determine the year with maximum number of individuals that were alive, as well as the number of alive individuals in that year. Your task is to help scientists solve this problem!"              
                                  3000.0 1423I "Lookup Tables" bitmasks "John has Q closed intervals of consecutive 2K-bit numbers [li,ri] and one 16-bit value vi for each interval. (0\xe2\x89\xa4i<Q)John wants to implement a function F that maps 2K-bit numbers to 16-bit numbers in such a way that inputs from each interval are mapped to that interval\'s value. In other words: F(x)=vi,for every 0\xe2\x89\xa4i<Q, and every x\xe2\x88\x88[li,ri] The output of F for other inputs is unimportant.John wants to make his implementation of F fast so he has decided to use lookup tables. A single 2K-bit lookup table would be too large to fit in memory, so instead John plans to use two K-bit lookup tables, LSBTable and MSBTable. His implementation will look like this: F(x)=LSBTable[lowKBits(x)]&MSBTable[highKBits(x)] In other words it returns the ""bitwise and"" of results of looking up the K least significant bits in LSBTable and the K most significant bits in MSBTable.John needs your help. Given K, Q and Q intervals [li,ri] and values vi, find any two lookup tables which can implement F or report that such tables don\'t exist."              
                                  3500.0 1423G "Growing flowers" "data structures" "Sarah has always been a lover of nature, and a couple of years ago she saved up enough money to travel the world and explore all the things built by nature over its lifetime on earth. During this time she visited some truly special places which were left untouched for centuries, from watching icebergs in freezing weather to scuba-diving in oceans and admiring the sea life, residing unseen. These experiences were enhanced with breathtaking views built by mountains over time and left there for visitors to see for years on end. Over time, all these expeditions took a toll on Sarah and culminated in her decision to settle down in the suburbs and live a quiet life. However, as Sarah\'s love for nature never faded, she started growing flowers in her garden in an attempt to stay connected with nature. At the beginning she planted only blue orchids, but over time she started using different flower types to add variety to her collection of flowers. This collection of flowers can be represented as an array of N flowers and the i-th of them has a type associated with it, denoted as Ai. Each resident, passing by her collection and limited by the width of his view, can only see K contiguous flowers at each moment in time. To see the whole collection, the resident will look at the first K contiguous flowers A1,A2,...,AK, then shift his view by one flower and look at the next section of K contiguous flowers A2,A3,...,AK+1 and so on until they scan the whole collection, ending with section AN\xe2\x88\x92K+1,...,AN\xe2\x88\x921,AN.Each resident determines the beautiness of a section of K flowers as the number of distinct flower types in that section. Furthermore, the beautiness of the whole collection is calculated by summing the beautiness values of each contiguous section. Formally, beautiness Bi of a section starting at the i-th position is calculated as Bi=distinct(Ai,Ai+1,...,Ai+K\xe2\x88\x921), and beautiness of the collection B is calculated as B=B1+B2+...+BN\xe2\x88\x92K+1.In addition, as Sarah wants to keep her collection of flowers have a fresh feel, she can also pick two points L and R, dispose flowers between those two points and plant new flowers, all of them being the same type.You will be given Q queries and each of those queries will be of the following two types:   You will be given three integers L,R,X describing that Sarah has planted flowers of type X between positions L and R inclusive. Formally collection is changed such that A[i]=X for all i in range [L..R].  You will be given integer K, width of the resident\'s view and you have to determine the beautiness value B resident has associated with the collection For each query of second type print the result \xe2\x80\x93 beautiness B of the collection."              
                                  3500.0 1423C "Du\xc5\xa1an\'s Railway" "divide and conquer,graphs,trees" "As you may already know, Du\xc5\xa1an is keen on playing with railway models. He has a big map with cities that are connected with railways. His map can be seen as a graph where vertices are cities and the railways connecting them are the edges. So far, the graph corresponding to his map is a tree. As you already know, a tree is a connected acyclic undirected graph.He is curious to find out whether his railway can be optimized somehow. He wants to add so-called shortcuts, which are also railways connecting pairs of cities. This shortcut will represent the railways in the unique path in the tree between the pair of cities it connects. Since Du\xc5\xa1an doesn\'t like repeating the railways, he has also defined good paths in his newly obtained network (notice that after adding the shortcuts, his graph is no more a tree). He calls a path good, if no edge appears more than once, either as a regular railway edge or as an edge represented by some shortcut (Every shortcut in a good path has length 1, but uses up all the edges it represents - they can\'t appear again in that path). Having defined good paths, he defines good distance between two cities to be the length of the shortest good path between them. Finally, the shortcutting diameter of his network is the largest good distance between any two cities.Now he is curious to find out whether it is possible to achieve shortcutting diameter less or equal than k, while adding as few shortcuts as possible.Your solution should add no more than 10\xe2\x8b\x85n shortcuts."              
                                  1700.0 1422C Bargain combinatorics,dp,math "Sometimes it is not easy to come to an agreement in a bargain. Right now Sasha and Vova can\'t come to an agreement: Sasha names a price as high as possible, then Vova wants to remove as many digits from the price as possible. In more details, Sasha names some integer price n, Vova removes a non-empty substring of (consecutive) digits from the price, the remaining digits close the gap, and the resulting integer is the price.For example, is Sasha names 1213121, Vova can remove the substring 1312, and the result is 121.It is allowed for result to contain leading zeros. If Vova removes all digits, the price is considered to be 0.Sasha wants to come up with some constraints so that Vova can\'t just remove all digits, but he needs some arguments supporting the constraints. To start with, he wants to compute the sum of all possible resulting prices after Vova\'s move.Help Sasha to compute this sum. Since the answer can be very large, print it modulo 109+7."              
                                  1800.0 1420D "Rescue Nibel!" "combinatorics,data structures,sortings" "Ori and Sein have overcome many difficult challenges. They finally lit the Shrouded Lantern and found Gumon Seal, the key to the Forlorn Ruins. When they tried to open the door to the ruins... nothing happened.Ori was very surprised, but Sein gave the explanation quickly: clever Gumon decided to make an additional defence for the door.There are n lamps with Spirit Tree\'s light. Sein knows the time of turning on and off for the i-th lamp \xe2\x80\x94 li and ri respectively. To open the door you have to choose k lamps in such a way that there will be a moment of time when they all will be turned on.While Sein decides which of the k lamps to pick, Ori is interested: how many ways there are to pick such k lamps that the door will open? It may happen that Sein may be wrong and there are no such k lamps. The answer might be large, so print it modulo 998244353."              
                                  900.0 1420A "Cubes Sorting" math,sortings "For god\'s sake, you\'re boxes with legs! It is literally your only purpose! Walking onto buttons! How can you not do the one thing you were designed for?Oh, that\'s funny, is it? Oh it\'s funny? Because we\'ve been at this for twelve hours and you haven\'t solved it either, so I don\'t know why you\'re laughing. You\'ve got one hour! Solve it!  Wheatley decided to try to make a test chamber. He made a nice test chamber, but there was only one detail absent \xe2\x80\x94 cubes.For completing the chamber Wheatley needs n cubes. i-th cube has a volume ai.Wheatley has to place cubes in such a way that they would be sorted in a non-decreasing order by their volume. Formally, for each i>1, ai\xe2\x88\x921\xe2\x89\xa4ai must hold.To achieve his goal, Wheatley can exchange two neighbouring cubes. It means that for any i>1 you can exchange cubes on positions i\xe2\x88\x921 and i.But there is a problem: Wheatley is very impatient. If Wheatley needs more than n\xe2\x8b\x85(n\xe2\x88\x921)2\xe2\x88\x921 exchange operations, he won\'t do this boring work.Wheatly wants to know: can cubes be sorted under this conditions?"              
                                  1200.0 1419B Stairs "brute force,constructive algorithms,greedy,implementation,math" "Jett is tired after destroying the town and she wants to have a rest. She likes high places, that\'s why for having a rest she wants to get high and she decided to craft staircases.A staircase is a squared figure that consists of square cells. Each staircase consists of an arbitrary number of stairs. If a staircase has n stairs, then it is made of n columns, the first column is 1 cell high, the second column is 2 cells high, \xe2\x80\xa6, the n-th column if n cells high. The lowest cells of all stairs must be in the same row.A staircase with n stairs is called nice, if it may be covered by n disjoint squares made of cells. All squares should fully consist of cells of a staircase. This is how a nice covered staircase with 7 stairs looks like:  Find out the maximal number of different nice staircases, that can be built, using no more than x cells, in total. No cell can be used more than once."              
                                  1500.0 1418C "Mortal Kombat Tower" "dp,graphs,greedy,shortest paths" "You and your friend are playing the game Mortal Kombat XI. You are trying to pass a challenge tower. There are n bosses in this tower, numbered from 1 to n. The type of the i-th boss is ai. If the i-th boss is easy then its type is ai=0, otherwise this boss is hard and its type is ai=1.During one session, either you or your friend can kill one or two bosses (neither you nor your friend can skip the session, so the minimum number of bosses killed during one session is at least one). After your friend session, your session begins, then again your friend session begins, your session begins, and so on. The first session is your friend\'s session.Your friend needs to get good because he can\'t actually kill hard bosses. To kill them, he uses skip points. One skip point can be used to kill one hard boss.Your task is to find the minimum number of skip points your friend needs to use so you and your friend kill all n bosses in the given order.For example: suppose n=8, a=[1,0,1,1,0,1,1,1]. Then the best course of action is the following:  your friend kills two first bosses, using one skip point for the first boss;  you kill the third and the fourth bosses;  your friend kills the fifth boss;  you kill the sixth and the seventh bosses;  your friend kills the last boss, using one skip point, so the tower is completed using two skip points. You have to answer t independent test cases."              
                                  1300.0 1418B "Negative Prefixes" greedy,sortings "You are given an array a, consisting of n integers.Each position i (1\xe2\x89\xa4i\xe2\x89\xa4n) of the array is either locked or unlocked. You can take the values on the unlocked positions, rearrange them in any order and place them back into the unlocked positions. You are not allowed to remove any values, add the new ones or rearrange the values on the locked positions. You are allowed to leave the values in the same order as they were.For example, let a=[\xe2\x88\x921,1,3_,2,\xe2\x88\x922_,1,\xe2\x88\x924,0_], the underlined positions are locked. You can obtain the following arrays:   [\xe2\x88\x921,1,3_,2,\xe2\x88\x922_,1,\xe2\x88\x924,0_];  [\xe2\x88\x924,\xe2\x88\x921,3_,2,\xe2\x88\x922_,1,1,0_];  [1,\xe2\x88\x921,3_,2,\xe2\x88\x922_,1,\xe2\x88\x924,0_];  [1,2,3_,\xe2\x88\x921,\xe2\x88\x922_,\xe2\x88\x924,1,0_];  and some others. Let p be a sequence of prefix sums of the array a after the rearrangement. So p1=a1, p2=a1+a2, p3=a1+a2+a3, \xe2\x80\xa6, pn=a1+a2+\xe2\x8b\xaf+an.Let k be the maximum j (1\xe2\x89\xa4j\xe2\x89\xa4n) such that pj<0. If there are no j such that pj<0, then k=0.Your goal is to rearrange the values in such a way that k is minimum possible.Output the array a after the rearrangement such that the value k for it is minimum possible. If there are multiple answers then print any of them."              
                                  800.0 1411A "In-game Chat" implementation "You have been assigned to develop a filter for bad messages in the in-game chat. A message is a string S of length n, consisting of lowercase English letters and characters \')\'. The message is bad if the number of characters \')\' at the end of the string strictly greater than the number of remaining characters. For example, the string "")bc)))"" has three parentheses at the end, three remaining characters, and is not considered bad."              
                                  2600.0 1406E "Deleting Numbers" "interactive,math,number theory" "This is an interactive problem.There is an unknown integer x (1\xe2\x89\xa4x\xe2\x89\xa4n). You want to find x.At first, you have a set of integers {1,2,\xe2\x80\xa6,n}. You can perform the following operations no more than 10000 times:  A a: find how many numbers are multiples of a in the current set.  B a: find how many numbers are multiples of a in this set, and then delete all multiples of a, but x will never be deleted (even if it is a multiple of a). In this operation, a must be greater than 1.  C a: it means that you know that x=a. This operation can be only performed once. Remember that in the operation of type B a>1 must hold.Write a program, that will find the value of x."              
                                  2200.0 1406D "Three Sequences" "constructive algorithms,data structures,greedy,math" "You are given a sequence of n integers a1,a2,\xe2\x80\xa6,an.You have to construct two sequences of integers b and c with length n that satisfy:  for every i (1\xe2\x89\xa4i\xe2\x89\xa4n) bi+ci=ai  b is non-decreasing, which means that for every 1<i\xe2\x89\xa4n, bi\xe2\x89\xa5bi\xe2\x88\x921 must hold  c is non-increasing, which means that for every 1<i\xe2\x89\xa4n, ci\xe2\x89\xa4ci\xe2\x88\x921 must hold You have to minimize max(bi,ci). In other words, you have to minimize the maximum number in sequences b and c.Also there will be q changes, the i-th change is described by three integers l,r,x. You should add x to al,al+1,\xe2\x80\xa6,ar. You have to find the minimum possible value of max(bi,ci) for the initial sequence and for sequence after each change."              
                                  800.0 1405A "Permutation Forgery" "constructive algorithms" "A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).Let p be any permutation of length n. We define the fingerprint F(p) of p as the sorted array of sums of adjacent elements in p. More formally,F(p)=sort([p1+p2,p2+p3,\xe2\x80\xa6,pn\xe2\x88\x921+pn]).For example, if n=4 and p=[1,4,2,3], then the fingerprint is given by F(p)=sort([1+4,4+2,2+3])=sort([5,6,5])=[5,5,6].You are given a permutation p of length n. Your task is to find a different permutation p\xe2\x80\xb2 with the same fingerprint. Two permutations p and p\xe2\x80\xb2 are considered different if there is some index i such that pi\xe2\x89\xa0p\xe2\x80\xb2i."              
                                  1500.0 1404A "Balanced Bitstring" implementation,strings "A bitstring is a string consisting only of the characters 0 and 1. A bitstring is called k-balanced if every substring of size k of this bitstring has an equal amount of 0 and 1 characters (k2 of each).You are given an integer k and a string s which is composed only of characters 0, 1, and ?. You need to determine whether you can make a k-balanced bitstring by replacing every ? characters in s with either 0 or 1.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end."              
                                  1200.0 1399C "Boats Competition" "brute force,greedy,two pointers" "There are n people who want to participate in a boat competition. The weight of the i-th participant is wi. Only teams consisting of two people can participate in this competition. As an organizer, you think that it\'s fair to allow only teams with the same total weight.So, if there are k teams (a1,b1), (a2,b2), \xe2\x80\xa6, (ak,bk), where ai is the weight of the first participant of the i-th team and bi is the weight of the second participant of the i-th team, then the condition a1+b1=a2+b2=\xe2\x8b\xaf=ak+bk=s, where s is the total weight of each team, should be satisfied.Your task is to choose such s that the number of teams people can create is the maximum possible. Note that each participant can be in no more than one team.You have to answer t independent test cases."              
                                  800.0 1399A "Remove Smallest" greedy,sortings "You are given the array a consisting of n positive (greater than zero) integers.In one move, you can choose two indices i and j (i\xe2\x89\xa0j) such that the absolute difference between ai and aj is no more than one (|ai\xe2\x88\x92aj|\xe2\x89\xa41) and remove the smallest of these two elements. If two elements are equal, you can remove any of them (but exactly one).Your task is to find if it is possible to obtain the array consisting of only one element using several (possibly, zero) such moves or not.You have to answer t independent test cases."              
                                  800.0 1398B "Substring Removal Game" games,greedy,sortings "Alice and Bob play a game. They have a binary string s (a string such that each character in it is either 0 or 1). Alice moves first, then Bob, then Alice again, and so on.During their move, the player can choose any number (not less than one) of consecutive equal characters in s and delete them.For example, if the string is 10110, there are 6 possible moves (deleted characters are bold):  10110\xe2\x86\x920110;  10110\xe2\x86\x921110;  10110\xe2\x86\x921010;  10110\xe2\x86\x921010;  10110\xe2\x86\x92100;  10110\xe2\x86\x921011. After the characters are removed, the characters to the left and to the right of the removed block become adjacent. I.\xe2\x80\x89e. the following sequence of moves is valid: 10110\xe2\x86\x92100\xe2\x86\x921.The game ends when the string becomes empty, and the score of each player is the number of 1-characters deleted by them.Each player wants to maximize their score. Calculate the resulting score of Alice."              
                                  1800.0 1396B "Stoned Game" "brute force,constructive algorithms,games,greedy" "T is playing a game with his friend, HL.There are n piles of stones, the i-th pile initially has ai stones. T and HL will take alternating turns, with T going first. In each turn, a player chooses a non-empty pile and then removes a single stone from it. However, one cannot choose a pile that has been chosen in the previous turn (the pile that was chosen by the other player, or if the current turn is the first turn then the player can choose any non-empty pile). The player who cannot choose a pile in his turn loses, and the game ends.Assuming both players play optimally, given the starting configuration of t games, determine the winner of each game."              
                                  1000.0 1395A "Boboniu Likes to Color Balls" "brute force,math" "Boboniu gives you  r red balls,  g green balls,  b blue balls,  w white balls. He allows you to do the following operation as many times as you want:   Pick a red ball, a green ball, and a blue ball and then change their color to white. You should answer if it\'s possible to arrange all the balls into a palindrome after several (possibly zero) number of described operations."              
                                  2800.0 1394D "Boboniu and Jianghu" dp,greedy,sortings,trees "Since Boboniu finished building his Jianghu, he has been doing Kungfu on these mountains every day. Boboniu designs a map for his n mountains. He uses n\xe2\x88\x921 roads to connect all n mountains. Every pair of mountains is connected via roads.For the i-th mountain, Boboniu estimated the tiredness of doing Kungfu on the top of it as ti. He also estimated the height of each mountain as hi.A path is a sequence of mountains M such that for each i (1\xe2\x89\xa4i<|M|), there exists a road between Mi and Mi+1. Boboniu would regard the path as a challenge if for each i (1\xe2\x89\xa4i<|M|), hMi\xe2\x89\xa4hMi+1.Boboniu wants to divide all n\xe2\x88\x921 roads into several challenges. Note that each road must appear in exactly one challenge, but a mountain may appear in several challenges. Boboniu wants to minimize the total tiredness to do all the challenges. The tiredness of a challenge M is the sum of tiredness of all mountains in it, i.e. \xe2\x88\x91|M|i=1tMi. He asked you to find the minimum total tiredness. As a reward for your work, you\'ll become a guardian in his Jianghu."              
                                  3000.0 1392H "ZS Shuffles Cards" combinatorics,dp,math,probabilities "zscoder has a deck of n+m custom-made cards, which consists of n cards labelled from 1 to n and m jokers. Since zscoder is lonely, he wants to play a game with himself using those cards. Initially, the deck is shuffled uniformly randomly and placed on the table. zscoder has a set S which is initially empty. Every second, zscoder draws the top card from the deck.   If the card has a number x written on it, zscoder removes the card and adds x to the set S.  If the card drawn is a joker, zscoder places all the cards back into the deck and reshuffles (uniformly randomly) the n+m cards to form a new deck (hence the new deck now contains all cards from 1 to n and the m jokers). Then, if S currently contains all the elements from 1 to n, the game ends. Shuffling the deck doesn\'t take time at all. What is the expected number of seconds before the game ends? We can show that the answer can be written in the form PQ where P,Q are relatively prime integers and Q\xe2\x89\xa00mod998244353. Output the value of (P\xe2\x8b\x85Q\xe2\x88\x921) modulo 998244353."              
                                  1600.0 1389B "Array Walk" "brute force,dp,greedy" "You are given an array a1,a2,\xe2\x80\xa6,an, consisting of n positive integers. Initially you are standing at index 1 and have a score equal to a1. You can perform two kinds of moves:   move right \xe2\x80\x94 go from your current index x to x+1 and add ax+1 to your score. This move can only be performed if x<n.  move left \xe2\x80\x94 go from your current index x to x\xe2\x88\x921 and add ax\xe2\x88\x921 to your score. This move can only be performed if x>1. Also, you can\'t perform two or more moves to the left in a row. You want to perform exactly k moves. Also, there should be no more than z moves to the left among them.What is the maximum score you can achieve?"              
                                  3200.0 1383F "Special Edges" flows,graphs "Koa the Koala has a directed graph G with n nodes and m edges. Each edge has a capacity associated with it. Exactly k edges of the graph, numbered from 1 to k, are special, such edges initially have a capacity equal to 0.Koa asks you q queries. In each query she gives you k integers w1,w2,\xe2\x80\xa6,wk. This means that capacity of the i-th special edge becomes wi (and other capacities remain the same).Koa wonders: what is the maximum flow that goes from node 1 to node n after each such query?Help her!"              
                                  1700.0 1383A "String Transformation 1" "dsu,graphs,greedy,sortings,strings,trees,two pointers" "Note that the only difference between String Transformation 1 and String Transformation 2 is in the move Koa does. In this version the letter y Koa selects must be strictly greater alphabetically than x (read statement for better understanding). You can make hacks in these problems independently.Koa the Koala has two strings A and B of the same length n (|A|=|B|=n) consisting of the first 20 lowercase English alphabet letters (ie. from a to t).In one move Koa:  selects some subset of positions p1,p2,\xe2\x80\xa6,pk (k\xe2\x89\xa51;1\xe2\x89\xa4pi\xe2\x89\xa4n;pi\xe2\x89\xa0pj if i\xe2\x89\xa0j) of A such that Ap1=Ap2=\xe2\x80\xa6=Apk=x (ie. all letters on this positions are equal to some letter x).  selects a letter y (from the first 20 lowercase letters in English alphabet) such that y>x (ie. letter y is strictly greater alphabetically than x).  sets each letter in positions p1,p2,\xe2\x80\xa6,pk to letter y. More formally: for each i (1\xe2\x89\xa4i\xe2\x89\xa4k) Koa sets Api=y. Note that you can only modify letters in string A.Koa wants to know the smallest number of moves she has to do to make strings equal to each other (A=B) or to determine that there is no way to make them equal. Help her!"              
                                  3300.0 1381E Origami geometry,math,sortings "After being discouraged by 13 time-limit-exceeded verdicts on an ugly geometry problem, you decided to take a relaxing break for arts and crafts.There is a piece of paper in the shape of a simple polygon with n vertices. The polygon may be non-convex, but we all know that proper origami paper has the property that any horizontal line intersects the boundary of the polygon in at most two points.If you fold the paper along the vertical line x=f, what will be the area of the resulting shape? When you fold, the part of the paper to the left of the line is symmetrically reflected on the right side.  Your task is to answer q independent queries for values f1,\xe2\x80\xa6,fq."              
                                  2500.0 1381C Mastermind "constructive algorithms,graph matchings,greedy,implementation,sortings,two pointers" "In the game of Mastermind, there are two players  \xe2\x80\x94 Alice and Bob. Alice has a secret code, which Bob tries to guess. Here, a code is defined as a sequence of n colors. There are exactly n+1 colors in the entire universe, numbered from 1 to n+1 inclusive.When Bob guesses a code, Alice tells him some information about how good of a guess it is, in the form of two integers x and y.The first integer x is the number of indices where Bob\'s guess correctly matches Alice\'s code. The second integer y is the size of the intersection of the two codes as multisets. That is, if Bob were to change the order of the colors in his guess, y is the maximum number of indices he could get correct.For example, suppose n=5, Alice\'s code is [3,1,6,1,2], and Bob\'s guess is [3,1,1,2,5]. At indices 1 and 2 colors are equal, while in the other indices they are not equal. So x=2. And the two codes have the four colors 1,1,2,3 in common, so y=4.  Solid lines denote a matched color for the same index. Dashed lines denote a matched color at a different index. x is the number of solid lines, and y is the total number of lines. You are given Bob\'s guess and two values x and y. Can you find one possibility of Alice\'s code so that the values of x and y are correct?"              
                                  2500.0 1375E "Inversion SwapSort" "constructive algorithms,greedy,sortings" "Madeline has an array a of n integers. A pair (u,v) of integers forms an inversion in a if:  1\xe2\x89\xa4u<v\xe2\x89\xa4n.  au>av. Madeline recently found a magical paper, which allows her to write two indices u and v and swap the values au and av. Being bored, she decided to write a list of pairs (ui,vi) with the following conditions:  all the pairs in the list are distinct and form an inversion in a.  all the pairs that form an inversion in a are in the list.  Starting from the given array, if you swap the values at indices u1 and v1, then the values at indices u2 and v2 and so on, then after all pairs are processed, the array a will be sorted in non-decreasing order. Construct such a list or determine that no such list exists. If there are multiple possible answers, you may find any of them."              
                                  1100.0 1375A "Sign Flipping" "constructive algorithms,math" "You are given n integers a1,a2,\xe2\x80\xa6,an, where n is odd. You are allowed to flip the sign of some (possibly all or none) of them. You wish to perform these flips in such a way that the following conditions hold:  At least n\xe2\x88\x9212 of the adjacent differences ai+1\xe2\x88\x92ai for i=1,2,\xe2\x80\xa6,n\xe2\x88\x921 are greater than or equal to 0.  At least n\xe2\x88\x9212 of the adjacent differences ai+1\xe2\x88\x92ai for i=1,2,\xe2\x80\xa6,n\xe2\x88\x921 are less than or equal to 0. Find any valid way to flip the signs. It can be shown that under the given constraints, there always exists at least one choice of signs to flip that satisfies the required condition. If there are several solutions, you can find any of them."              
                                  1000.0 1374C "Move Brackets" greedy,strings "You are given a bracket sequence s of length n, where n is even (divisible by two). The string s consists of n2 opening brackets \'(\' and n2 closing brackets \')\'.In one move, you can choose exactly one bracket and move it to the beginning of the string or to the end of the string (i.e. you choose some index i, remove the i-th character of s and insert it before or after all remaining characters of s).Your task is to find the minimum number of moves required to obtain regular bracket sequence from s. It can be proved that the answer always exists under the given constraints.Recall what the regular bracket sequence is:  ""()"" is regular bracket sequence;  if s is regular bracket sequence then ""("" + s + "")"" is regular bracket sequence;  if s and t are regular bracket sequences then s + t is regular bracket sequence. For example, ""()()"", ""(())()"", ""(())"" and ""()"" are regular bracket sequences, but "")("", ""()("" and "")))"" are not.You have to answer t independent test cases."              
                                  2200.0 1373E "Sum of Digits" "brute force,constructive algorithms,dp,greedy" "Let f(x) be the sum of digits of a decimal number x.Find the smallest non-negative integer x such that f(x)+f(x+1)+\xe2\x8b\xaf+f(x+k)=n."              
                                  800.0 1372A "Omkar and Completion" "constructive algorithms,implementation" "You have been blessed as a child of Omkar. To express your gratitude, please solve this problem for Omkar!An array a of length n is called complete if all elements are positive and don\'t exceed 1000, and for all indices x,y,z (1\xe2\x89\xa4x,y,z\xe2\x89\xa4n), ax+ay\xe2\x89\xa0az (not necessarily distinct).You are given one integer n. Please find any complete array of length n. It is guaranteed that under given constraints such array exists."              
                                  800.0 1369A FashionabLee geometry,math "Lee is going to fashionably decorate his house for a party, using some regular convex polygons...Lee thinks a regular n-sided (convex) polygon is beautiful if and only if he can rotate it in such a way that at least one of its edges is parallel to the OX-axis and at least one of its edges is parallel to the OY-axis at the same time.Recall that a regular n-sided polygon is a convex polygon with n vertices such that all the edges and angles are equal.Now he is shopping: the market has t regular polygons. For each of them print YES if it is beautiful and NO otherwise."              
                                  1900.0 1367E "Necklace Assembly" "brute force,dfs and similar,dp,graphs,greedy,number theory" "The store sells n beads. The color of each bead is described by a lowercase letter of the English alphabet (""a""\xe2\x80\x93""z""). You want to buy some beads to assemble a necklace from them.A necklace is a set of beads connected in a circle.For example, if the store sells beads ""a"", ""b"", ""c"", ""a"", ""c"", ""c"", then you can assemble the following necklaces (these are not all possible options):  And the following necklaces cannot be assembled from beads sold in the store:  The first necklace cannot be assembled because it has three beads ""a"" (of the two available). The second necklace cannot be assembled because it contains a bead ""d"", which is not sold in the store. We call a necklace k-beautiful if, when it is turned clockwise by k beads, the necklace remains unchanged. For example, here is a sequence of three turns of a necklace.    As you can see, this necklace is, for example, 3-beautiful, 6-beautiful, 9-beautiful, and so on, but it is not 1-beautiful or 2-beautiful.In particular, a necklace of length 1 is k-beautiful for any integer k. A necklace that consists of beads of the same color is also beautiful for any k.You are given the integers n and k, and also the string s containing n lowercase letters of the English alphabet \xe2\x80\x94 each letter defines a bead in the store. You can buy any subset of beads and connect them in any order. Find the maximum length of a k-beautiful necklace you can assemble."              
                                  1500.0 1366C "Palindromic Paths" greedy,math "You are given a matrix with n rows (numbered from 1 to n) and m columns (numbered from 1 to m). A number ai,j is written in the cell belonging to the i-th row and the j-th column, each number is either 0 or 1.A chip is initially in the cell (1,1), and it will be moved to the cell (n,m). During each move, it either moves to the next cell in the current row, or in the current column (if the current cell is (x,y), then after the move it can be either (x+1,y) or (x,y+1)). The chip cannot leave the matrix.Consider each path of the chip from (1,1) to (n,m). A path is called palindromic if the number in the first cell is equal to the number in the last cell, the number in the second cell is equal to the number in the second-to-last cell, and so on.Your goal is to change the values in the minimum number of cells so that every path is palindromic."              
                                  1300.0 1366B Shuffle "math,two pointers" "You are given an array consisting of n integers a1, a2, ..., an. Initially ax=1, all other elements are equal to 0.You have to perform m operations. During the i-th operation, you choose two indices c and d such that li\xe2\x89\xa4c,d\xe2\x89\xa4ri, and swap ac and ad.Calculate the number of indices k such that it is possible to choose the operations so that ak=1 in the end."              
                                  1600.0 1364C "Ehab and Prefix MEXs" "brute force,constructive algorithms,greedy" "Given an array a of length n, find another array, b, of length n such that:  for each i (1\xe2\x89\xa4i\xe2\x89\xa4n) MEX({b1, b2, \xe2\x80\xa6, bi})=ai. The MEX of a set of integers is the smallest non-negative integer that doesn\'t belong to this set.If such array doesn\'t exist, determine this."              
                                  1300.0 1364B "Most socially-distanced subsequence" "greedy,two pointers" "Given a permutation p of length n, find its subsequence s1, s2, \xe2\x80\xa6, sk of length at least 2 such that:  |s1\xe2\x88\x92s2|+|s2\xe2\x88\x92s3|+\xe2\x80\xa6+|sk\xe2\x88\x921\xe2\x88\x92sk| is as big as possible over all subsequences of p with length at least 2.  Among all such subsequences, choose the one whose length, k, is as small as possible. If multiple subsequences satisfy these conditions, you are allowed to find any of them.A sequence a is a subsequence of an array b if a can be obtained from b by deleting some (possibly, zero or all) elements.A permutation of length n is an array of length n in which every element from 1 to n occurs exactly once."              
                                  1400.0 1363B "Subsequence Hate" implementation,strings "Shubham has a binary string s. A binary string is a string containing only characters ""0"" and ""1"".He can perform the following operation on the string any amount of times:   Select an index of the string, and flip the character at that index. This means, if the character was ""0"", it becomes ""1"", and vice versa. A string is called good if it does not contain ""010"" or ""101"" as a subsequence  \xe2\x80\x94 for instance, ""1001"" contains ""101"" as a subsequence, hence it is not a good string, while ""1000"" doesn\'t contain neither ""010"" nor ""101"" as subsequences, so it is a good string.What is the minimum number of operations he will have to perform, so that the string becomes good? It can be shown that with these operations we can make any string good.A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters."              
                                  3300.0 1361F "Johnny and New Toy" "data structures,implementation,math" "Johnny has a new toy. As you may guess, it is a little bit extraordinary. The toy is a permutation P of numbers from 1 to n, written in one row next to each other. For each i from 1 to n\xe2\x88\x921 between Pi and Pi+1 there is a weight Wi written, and those weights form a permutation of numbers from 1 to n\xe2\x88\x921. There are also extra weights W0=Wn=0.The instruction defines subsegment [L,R] as good if WL\xe2\x88\x921<Wi and WR<Wi for any i in {L,L+1,\xe2\x80\xa6,R\xe2\x88\x921}. For such subsegment it also defines WM as minimum of set {WL,WL+1,\xe2\x80\xa6,WR\xe2\x88\x921}. Now the fun begins. In one move, the player can choose one of the good subsegments, cut it into [L,M] and [M+1,R] and swap the two parts. More precisely, before one move the chosen subsegment of our toy looks like: WL\xe2\x88\x921,PL,WL,\xe2\x80\xa6,WM\xe2\x88\x921,PM,WM,PM+1,WM+1,\xe2\x80\xa6,WR\xe2\x88\x921,PR,WR and afterwards it looks like this: WL\xe2\x88\x921,PM+1,WM+1,\xe2\x80\xa6,WR\xe2\x88\x921,PR,WM,PL,WL,\xe2\x80\xa6,WM\xe2\x88\x921,PM,WR Such a move can be performed multiple times (possibly zero), and the goal is to achieve the minimum number of inversions in P. Johnny\'s younger sister Megan thinks that the rules are too complicated, so she wants to test her brother by choosing some pair of indices X and Y, and swapping PX and PY (X might be equal Y). After each sister\'s swap, Johnny wonders, what is the minimal number of inversions that he can achieve, starting with current P and making legal moves?You can assume that the input is generated randomly. P and W were chosen independently and equiprobably over all permutations; also, Megan\'s requests were chosen independently and equiprobably over all pairs of indices."              
                                  2900.0 1361D "Johnny and James" greedy,implementation,math,trees "James Bond, Johnny\'s favorite secret agent, has a new mission. There are n enemy bases, each of them is described by its coordinates so that we can think about them as points in the Cartesian plane. The bases can communicate with each other, sending a signal, which is the ray directed from the chosen point to the origin or in the opposite direction. The exception is the central base, which lies at the origin and can send a signal in any direction. When some two bases want to communicate, there are two possible scenarios. If they lie on the same line with the origin, one of them can send a signal directly to the other one. Otherwise, the signal is sent from the first base to the central, and then the central sends it to the second base. We denote the distance between two bases as the total Euclidean distance that a signal sent between them has to travel.Bond can damage all but some k bases, which he can choose arbitrarily. A damaged base can\'t send or receive the direct signal but still can pass it between two working bases. In particular, James can damage the central base, and the signal can still be sent between any two undamaged bases as before, so the distance between them remains the same. What is the maximal sum of the distances between all pairs of remaining bases that 007 can achieve by damaging exactly n\xe2\x88\x92k of them?"              
                                  2100.0 1360H "Binary Median" "binary search,bitmasks,brute force,constructive algorithms" "Consider all binary strings of length m (1\xe2\x89\xa4m\xe2\x89\xa460). A binary string is a string that consists of the characters 0 and 1 only. For example, 0110 is a binary string, and 012aba is not. Obviously, there are exactly 2m such strings in total.The string s is lexicographically smaller than the string t (both have the same length m) if in the first position i from the left in which they differ, we have s[i]<t[i]. This is exactly the way strings are compared in dictionaries and in most modern programming languages when comparing them in a standard way. For example, the string 01011 is lexicographically smaller than the string 01100, because the first two characters are the same, and the third character in the first string is less than that in the second.We remove from this set n (1\xe2\x89\xa4n\xe2\x89\xa4min(2m\xe2\x88\x921,100)) distinct binary strings a1,a2,\xe2\x80\xa6,an, each of length m. Thus, the set will have k=2m\xe2\x88\x92n strings. Sort all strings of the resulting set in lexicographical ascending order (as in the dictionary).We number all the strings after sorting from 0 to k\xe2\x88\x921. Print the string whose index is \xe2\x8c\x8ak\xe2\x88\x9212\xe2\x8c\x8b (such an element is called median), where \xe2\x8c\x8ax\xe2\x8c\x8b is the rounding of the number down to the nearest integer.For example, if n=3, m=3 and a=[010, 111, 001], then after removing the strings ai and sorting, the result will take the form: [000, 011, 100, 101, 110]. Thus, the desired median is 100."              
                                  800.0 1360B "Honest Coach" greedy,sortings "There are n athletes in front of you. Athletes are numbered from 1 to n from left to right. You know the strength of each athlete \xe2\x80\x94 the athlete number i has the strength si.You want to split all athletes into two teams. Each team must have at least one athlete, and each athlete must be exactly in one team.You want the strongest athlete from the first team to differ as little as possible from the weakest athlete from the second team. Formally, you want to split the athletes into two teams A and B so that the value |max(A)\xe2\x88\x92min(B)| is as small as possible, where max(A) is the maximum strength of an athlete from team A, and min(B) is the minimum strength of an athlete from team B.For example, if n=5 and the strength of the athletes is s=[3,1,2,6,4], then one of the possible split into teams is:   first team: A=[1,2,4],  second team: B=[3,6]. In this case, the value |max(A)\xe2\x88\x92min(B)| will be equal to |4\xe2\x88\x923|=1. This example illustrates one of the ways of optimal split into two teams.Print the minimum value |max(A)\xe2\x88\x92min(B)|."              
                                  2000.0 1359D "Yet Another Yet Another Task" "data structures,dp,implementation,two pointers" "Alice and Bob are playing yet another card game. This time the rules are the following. There are n cards lying in a row in front of them. The i-th card has value ai. First, Alice chooses a non-empty consecutive segment of cards [l;r] (l\xe2\x89\xa4r). After that Bob removes a single card j from that segment (l\xe2\x89\xa4j\xe2\x89\xa4r). The score of the game is the total value of the remaining cards on the segment (al+al+1+\xe2\x8b\xaf+aj\xe2\x88\x921+aj+1+\xe2\x8b\xaf+ar\xe2\x88\x921+ar). In particular, if Alice chooses a segment with just one element, then the score after Bob removes the only card is 0.Alice wants to make the score as big as possible. Bob takes such a card that the score is as small as possible.What segment should Alice choose so that the score is maximum possible? Output the maximum score."              
                                  1000.0 1359B "New Theatre Square" "brute force,dp,greedy,implementation,two pointers" "You might have remembered Theatre square from the problem 1A. Now it\'s finally getting repaved.The square still has a rectangular shape of n\xc3\x97m meters. However, the picture is about to get more complicated now. Let ai,j be the j-th square in the i-th row of the pavement.You are given the picture of the squares:  if ai,j= ""*"", then the j-th square in the i-th row should be black;  if ai,j= ""."", then the j-th square in the i-th row should be white. The black squares are paved already. You have to pave the white squares. There are two options for pavement tiles:  1\xc3\x971 tiles \xe2\x80\x94 each tile costs x burles and covers exactly 1 square;  1\xc3\x972 tiles \xe2\x80\x94 each tile costs y burles and covers exactly 2 adjacent squares of the same row. Note that you are not allowed to rotate these tiles or cut them into 1\xc3\x971 tiles. You should cover all the white squares, no two tiles should overlap and no black squares should be covered by tiles.What is the smallest total price of the tiles needed to cover all the white squares?"              
                                  -999.0 1357D4 "Quantum Classification - Dataset 6"  "This problem is identical to the problem D1 in every aspect except the training dataset. Please refer to that problem for the full problem statement."              
                                  -999.0 1357D3 "Quantum Classification - Dataset 5"  "This problem is identical to the problem D1 in every aspect except the training dataset. Please refer to that problem for the full problem statement."              
                                  -999.0 1356B1 Increment "*special problem" "Implement a unitary operation on a register of N qubits that increments the number written in the register modulo 2N.Your operation should take a register of type LittleEndian - an array of qubits that encodes an unsigned integer in little-endian format, with the least significant bit written first (corresponding to the array element with index 0). The ""output"" of your solution is the state in which it left the input qubits.For example, if the qubits passed to your operation are in the state 1\xe2\x88\x9a2(|11\xe2\x9f\xa9+|10\xe2\x9f\xa9)=1\xe2\x88\x9a2(|3\xe2\x9f\xa9+|1\xe2\x9f\xa9), they should be transformed to the state 1\xe2\x88\x9a2(|(3+1)mod22\xe2\x9f\xa9+|(1+1)mod22\xe2\x9f\xa9)=1\xe2\x88\x9a2(|0\xe2\x9f\xa9+|2\xe2\x9f\xa9)=1\xe2\x88\x9a2(|00\xe2\x9f\xa9+|01\xe2\x9f\xa9).Your code should have the following signature (note that your operation should have Adjoint and Controlled variants defined for it; is Adj+Ctl in the operation signature will generate them automatically based on your code):namespace Solution {    open Microsoft.Quantum.Arithmetic;    open Microsoft.Quantum.Intrinsic;    operation Solve (register : LittleEndian) : Unit is Adj+Ctl {        // your code here    }}Your code is not allowed to use measurements or arbitrary rotation gates (so, for example, using the library operation IncrementByInteger will cause runtime error). This operation can be implemented using just the X gate and its controlled variants."              
                                  -999.0 1356A5 "Distinguish Z from -Z" "*special problem" "You are given an operation that implements a single-qubit unitary transformation: either the Z gate or the -Z gate (i.e., the \xe2\x88\x92|0\xe2\x9f\xa9\xe2\x9f\xa80|+|1\xe2\x9f\xa9\xe2\x9f\xa81| gate: (\xe2\x88\x92Z)(\xce\xb1|0\xe2\x9f\xa9+\xce\xb2|1\xe2\x9f\xa9)=\xe2\x88\x92\xce\xb1|0\xe2\x9f\xa9+\xce\xb2|1\xe2\x9f\xa9). The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the Z gate or 1 if it was the -Z gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly once.You have to implement an operation which takes a single-qubit operation as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit => Unit is Adj+Ctl)) : Int {        // your code here    }}"              
                                  1200.0 1355B "Young Explorers" dp,greedy,sortings "Young wilderness explorers set off to their first expedition led by senior explorer Russell. Explorers went into a forest, set up a camp and decided to split into groups to explore as much interesting locations as possible. Russell was trying to form groups, but ran into some difficulties...Most of the young explorers are inexperienced, and sending them alone would be a mistake. Even Russell himself became senior explorer not long ago. Each of young explorers has a positive integer parameter ei \xe2\x80\x94 his inexperience. Russell decided that an explorer with inexperience e can only join the group of e or more people.Now Russell needs to figure out how many groups he can organize. It\'s not necessary to include every explorer in one of the groups: some can stay in the camp. Russell is worried about this expedition, so he asked you to help him."              
                                  800.0 1353B "Two Arrays And Swaps" greedy,sortings "You are given two arrays a and b both consisting of n positive (greater than zero) integers. You are also given an integer k.In one move, you can choose two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) and swap ai and bj (i.e. ai becomes bj and vice versa). Note that i and j can be equal or different (in particular, swap a2 with b2 or swap a3 and b9 both are acceptable moves).Your task is to find the maximum possible sum you can obtain in the array a if you can do no more than (i.e. at most) k such moves (swaps).You have to answer t independent test cases."              
                                  1200.0 1352B "Same Parity Summands" "constructive algorithms,math" "You are given two positive integers n (1\xe2\x89\xa4n\xe2\x89\xa4109) and k (1\xe2\x89\xa4k\xe2\x89\xa4100). Represent the number n as the sum of k positive integers of the same parity (have the same remainder when divided by 2).In other words, find a1,a2,\xe2\x80\xa6,ak such that all ai>0, n=a1+a2+\xe2\x80\xa6+ak and either all ai are even or all ai are odd at the same time.If such a representation does not exist, then report it."              
                                  900.0 1351B Square? "brute force,implementation,math" "Vasya claims that he had a paper square. He cut it into two rectangular parts using one vertical or horizontal cut. Then Vasya informed you the dimensions of these two rectangular parts. You need to check whether Vasya originally had a square. In other words, check if it is possible to make a square using two given rectangles."              
                                  2000.0 1346F "Dune II: Battle For Arrakis" "*special problem,data structures,greedy,math" "You\'re at the last mission in one very old and very popular strategy game Dune II: Battle For Arrakis. The map of the mission can be represented as a rectangular matrix of size n\xc3\x97m. Initially, there are ai,j units of your army in the cell (i,j).You want to prepare for the final battle, so you want to move all your army into exactly one cell of the map (i.e. nm\xe2\x88\x921 cells should contain 0 units of the army and the remaining cell should contain the entire army).To do this, you can do some (possibly, zero) number of moves. During one move, you can select exactly one unit from some cell and move it to one of the adjacent by side cells. I.e. from the cell (i,j) you can move the unit to cells:  (i\xe2\x88\x921,j);  (i,j\xe2\x88\x921);  (i+1,j);  (i,j+1). Of course, you want to move all your army into exactly one cell as fast as possible. So, you want to know the minimum number of moves you need to do that.And, of course, life goes on, so the situation on the map changes. There are q updates, the i-th update is denoted by three integers x,y,z. This update affects the army in the cell (x,y): after this update, the number of units in the cell (x,y) becomes z (i.e. you replace ax,y with z).Also, you want to determine, for each i, the minimum number of moves needed to move your entire army into exactly one cell with the first i updates applied to the initial map. In other words, the map after the i-th update equals the initial map with the first i updates applied to it."              
                                  2100.0 1343E "Weights Distributing" "brute force,graphs,greedy,shortest paths,sortings" "You are given an undirected unweighted graph consisting of n vertices and m edges (which represents the map of Bertown) and the array of prices p of length m. It is guaranteed that there is a path between each pair of vertices (districts).Mike has planned a trip from the vertex (district) a to the vertex (district) b and then from the vertex (district) b to the vertex (district) c. He can visit the same district twice or more. But there is one issue: authorities of the city want to set a price for using the road so if someone goes along the road then he should pay the price corresponding to this road (he pays each time he goes along the road). The list of prices that will be used p is ready and they just want to distribute it between all roads in the town in such a way that each price from the array corresponds to exactly one road.You are a good friend of Mike (and suddenly a mayor of Bertown) and want to help him to make his trip as cheap as possible. So, your task is to distribute prices between roads in such a way that if Mike chooses the optimal path then the price of the trip is the minimum possible. Note that you cannot rearrange prices after the start of the trip.You have to answer t independent test cases."              
                                  800.0 1343B "Balanced Array" "constructive algorithms,math" "You are given a positive integer n, it is guaranteed that n is even (i.e. divisible by 2).You want to construct the array a of length n such that:   The first n2 elements of a are even (divisible by 2);  the second n2 elements of a are odd (not divisible by 2);  all elements of a are distinct and positive;  the sum of the first half equals to the sum of the second half (n2\xe2\x88\x91i=1ai=n\xe2\x88\x91i=n2+1ai). If there are multiple answers, you can print any. It is not guaranteed that the answer exists.You have to answer t independent test cases."              
                                  2600.0 1340D "Nastya and Time Machine" "constructive algorithms,dfs and similar,graphs,trees" "Denis came to Nastya and discovered that she was not happy to see him... There is only one chance that she can become happy. Denis wants to buy all things that Nastya likes so she will certainly agree to talk to him. The map of the city where they live has a lot of squares, some of which are connected by roads. There is exactly one way between each pair of squares which does not visit any vertex twice. It turns out that the graph of the city is a tree.Denis is located at vertex 1 at the time 0. He wants to visit every vertex at least once and get back as soon as possible.Denis can walk one road in 1 time. Unfortunately, the city is so large that it will take a very long time to visit all squares. Therefore, Denis took a desperate step. He pulled out his pocket time machine, which he constructed in his basement. With its help, Denis can change the time to any non-negative time, which is less than the current time.But the time machine has one feature. If the hero finds himself in the same place and at the same time twice, there will be an explosion of universal proportions and Nastya will stay unhappy. Therefore, Denis asks you to find him a route using a time machine that he will get around all squares and will return to the first and at the same time the maximum time in which he visited any square will be minimal.Formally, Denis\'s route can be represented as a sequence of pairs: {v1,t1},{v2,t2},{v3,t3},\xe2\x80\xa6,{vk,tk}, where vi is number of square, and ti is time in which the boy is now.The following conditions must be met:  The route starts on square 1 at time 0, i.e. v1=1,t1=0 and ends on the square 1, i.e. vk=1.  All transitions are divided into two types:   Being in the square change the time: {vi,ti}\xe2\x86\x92{vi+1,ti+1}:vi+1=vi,0\xe2\x89\xa4ti+1<ti.  Walk along one of the roads: {vi,ti}\xe2\x86\x92{vi+1,ti+1}. Herewith, vi and vi+1 are connected by road, and ti+1=ti+1   All pairs {vi,ti} must be different.  All squares are among v1,v2,\xe2\x80\xa6,vk. You need to find a route such that the maximum time in any square will be minimal, that is, the route for which max(t1,t2,\xe2\x80\xa6,tk) will be the minimum possible."              
                                  1600.0 1336A "Linova and Kingdom" "dfs and similar,dp,greedy,sortings,trees" "Writing light novels is the most important thing in Linova\'s life. Last night, Linova dreamed about a fantastic kingdom. She began to write a light novel for the kingdom as soon as she woke up, and of course, she is the queen of it. There are n cities and n\xe2\x88\x921 two-way roads connecting pairs of cities in the kingdom. From any city, you can reach any other city by walking through some roads. The cities are numbered from 1 to n, and the city 1 is the capital of the kingdom. So, the kingdom has a tree structure.As the queen, Linova plans to choose exactly k cities developing industry, while the other cities will develop tourism. The capital also can be either industrial or tourism city.A meeting is held in the capital once a year. To attend the meeting, each industry city sends an envoy. All envoys will follow the shortest path from the departure city to the capital (which is unique).Traveling in tourism cities is pleasant. For each envoy, his happiness is equal to the number of tourism cities on his path.In order to be a queen loved by people, Linova wants to choose k cities which can maximize the sum of happinesses of all envoys. Can you calculate the maximum sum for her?"              
                                  2200.0 1334E "Divisor Paths" "combinatorics,graphs,greedy,math,number theory" "You are given a positive integer D. Let\'s build the following graph from it:   each vertex is a divisor of D (not necessarily prime, 1 and D itself are also included);  two vertices x and y (x>y) have an undirected edge between them if x is divisible by y and xy is a prime;  the weight of an edge is the number of divisors of x that are not divisors of y. For example, here is the graph for D=12:   Edge (4,12) has weight 3 because 12 has divisors [1,2,3,4,6,12] and 4 has divisors [1,2,4]. Thus, there are 3 divisors of 12 that are not divisors of 4 \xe2\x80\x94 [3,6,12].There is no edge between 3 and 2 because 3 is not divisible by 2. There is no edge between 12 and 3 because 123=4 is not a prime.Let the length of the path between some vertices v and u in the graph be the total weight of edges on it. For example, path [(1,2),(2,6),(6,12),(12,4),(4,2),(2,6)] has length 1+2+2+3+1+2=11. The empty path has length 0.So the shortest path between two vertices v and u is the path that has the minimal possible length.Two paths a and b are different if there is either a different number of edges in them or there is a position i such that ai and bi are different edges.You are given q queries of the following form:   v u \xe2\x80\x94 calculate the number of the shortest paths between vertices v and u. The answer for each query might be large so print it modulo 998244353."              
              1500.0                         1133D "Zero Quantity Maximization" "hashing,math,number theory" "You are given two arrays a and b, each contains n integers.You want to create a new array c as follows: choose some real (i.e. not necessarily integer) number d, and then for every i\xe2\x88\x88[1,n] let ci:=d\xe2\x8b\x85ai+bi.Your goal is to maximize the number of zeroes in array c. What is the largest possible answer, if you choose d optimally?"          
              1200.0                         1133B "Preparation for International Women\'s Day" "math,number theory" "International Women\'s Day is coming soon! Polycarp is preparing for the holiday.There are n candy boxes in the shop for sale. The i-th box contains di candies.Polycarp wants to prepare the maximum number of gifts for k girls. Each gift will consist of exactly two boxes. The girls should be able to share each gift equally, so the total amount of candies in a gift (in a pair of boxes) should be divisible by k. In other words, two boxes i and j (i\xe2\x89\xa0j) can be combined as a gift if di+dj is divisible by k.How many boxes will Polycarp be able to give? Of course, each box can be a part of no more than one gift. Polycarp cannot use boxes ""partially"" or redistribute candies between them."          
              2400.0                         1132G "Greedy Subsequences" "data structures,dp,trees" "For some array c, let\'s denote a greedy subsequence as a sequence of indices p1, p2, ..., pl such that 1\xe2\x89\xa4p1<p2<\xe2\x8b\xaf<pl\xe2\x89\xa4|c|, and for each i\xe2\x88\x88[1,l\xe2\x88\x921], pi+1 is the minimum number such that pi+1>pi and c[pi+1]>c[pi].You are given an array a1,a2,\xe2\x80\xa6,an. For each its subsegment of length k, calculate the length of its longest greedy subsequence."          
              1700.0                         1132C "Painting the Fence" "brute force" "You have a long fence which consists of n sections. Unfortunately, it is not painted, so you decided to hire q painters to paint it. i-th painter will paint all sections x such that li\xe2\x89\xa4x\xe2\x89\xa4ri.Unfortunately, you are on a tight budget, so you may hire only q\xe2\x88\x922 painters. Obviously, only painters you hire will do their work.You want to maximize the number of painted sections if you choose q\xe2\x88\x922 painters optimally. A section is considered painted if at least one painter paints it."          
              2300.0                         1131E "String Multiplication" dp,greedy,strings "Roman and Denis are on the trip to the programming competition. Since the trip was long, they soon got bored, and hence decided to came up with something. Roman invented a pizza\'s recipe, while Denis invented a string multiplication. According to Denis, the result of multiplication (product) of strings s of length m and t is a string t+s1+t+s2+\xe2\x80\xa6+t+sm+t, where si denotes the i-th symbol of the string s, and ""+"" denotes string concatenation. For example, the product of strings ""abc"" and ""de"" is a string ""deadebdecde"", while the product of the strings ""ab"" and ""z"" is a string ""zazbz"". Note, that unlike the numbers multiplication, the product of strings s and t is not necessarily equal to product of t and s.Roman was jealous of Denis, since he invented such a cool operation, and hence decided to invent something string-related too. Since Roman is beauty-lover, he decided to define the beauty of the string as the length of the longest substring, consisting of only one letter. For example, the beauty of the string ""xayyaaabca"" is equal to 3, since there is a substring ""aaa"", while the beauty of the string ""qwerqwer"" is equal to 1, since all neighboring symbols in it are different.In order to entertain Roman, Denis wrote down n strings p1,p2,p3,\xe2\x80\xa6,pn on the paper and asked him to calculate the beauty of the string (\xe2\x80\xa6(((p1\xe2\x8b\x85p2)\xe2\x8b\x85p3)\xe2\x8b\x85\xe2\x80\xa6)\xe2\x8b\x85pn, where s\xe2\x8b\x85t denotes a multiplication of strings s and t. Roman hasn\'t fully realized how Denis\'s multiplication works, so he asked you for a help. Denis knows, that Roman is very impressionable, he guarantees, that the beauty of the resulting string is at most 109."          
              800.0                         1131A "Sea Battle" math "In order to make the ""Sea Battle"" game more interesting, Boris decided to add a new ship type to it. The ship consists of two rectangles. The first rectangle has a width of w1 and a height of h1, while the second rectangle has a width of w2 and a height of h2, where w1\xe2\x89\xa5w2. In this game, exactly one ship is used, made up of two rectangles. There are no other ships on the field.The rectangles are placed on field in the following way:  the second rectangle is on top the first rectangle;  they are aligned to the left, i.e. their left sides are on the same line;  the rectangles are adjacent to each other without a gap. See the pictures in the notes: the first rectangle is colored red, the second rectangle is colored blue.Formally, let\'s introduce a coordinate system. Then, the leftmost bottom cell of the first rectangle has coordinates (1,1), the rightmost top cell of the first rectangle has coordinates (w1,h1), the leftmost bottom cell of the second rectangle has coordinates (1,h1+1) and the rightmost top cell of the second rectangle has coordinates (w2,h1+h2).After the ship is completely destroyed, all cells neighboring by side or a corner with the ship are marked. Of course, only cells, which don\'t belong to the ship are marked. On the pictures in the notes such cells are colored green.Find out how many cells should be marked after the ship is destroyed. The field of the game is infinite in any direction."          
              2900.0                         1129D Isolation "data structures,dp" "Find the number of ways to divide an array a of n integers into any number of disjoint non-empty segments so that, in each segment, there exist at most k distinct integers that appear exactly once.Since the answer can be large, find it modulo 998244353."          
              1700.0                         1118D1 "Coffee and Coursework (Easy version)" "brute force,greedy" "The only difference between easy and hard versions is the constraints.Polycarp has to write a coursework. The coursework consists of m pages.Polycarp also has n cups of coffee. The coffee in the i-th cup has ai caffeine in it. Polycarp can drink some cups of coffee (each one no more than once). He can drink cups in any order. Polycarp drinks each cup instantly and completely (i.e. he cannot split any cup into several days).Surely, courseworks are not usually being written in a single day (in a perfect world of Berland, at least). Some of them require multiple days of hard work.Let\'s consider some day of Polycarp\'s work. Consider Polycarp drinks k cups of coffee during this day and caffeine dosages of cups Polycarp drink during this day are ai1,ai2,\xe2\x80\xa6,aik. Then the first cup he drinks gives him energy to write ai1 pages of coursework, the second cup gives him energy to write max(0,ai2\xe2\x88\x921) pages, the third cup gives him energy to write max(0,ai3\xe2\x88\x922) pages, ..., the k-th cup gives him energy to write max(0,aik\xe2\x88\x92k+1) pages.If Polycarp doesn\'t drink coffee during some day, he cannot write coursework at all that day.Polycarp has to finish his coursework as soon as possible (spend the minimum number of days to do it). Your task is to find out this number of days or say that it is impossible."          
              2200.0                         1117E "Decypher the String" "bitmasks,chinese remainder theorem,constructive algorithms,interactive,math" "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.You are given a string t consisting of n lowercase Latin letters. This string was cyphered as follows: initially, the jury had a string s consisting of n lowercase Latin letters. Then they applied a sequence of no more than n (possibly zero) operations. i-th operation is denoted by two integers ai and bi (1\xe2\x89\xa4ai,bi\xe2\x89\xa4n), and means swapping two elements of the string with indices ai and bi. All operations were done in the order they were placed in the sequence. For example, if s is xyz and 2 following operations are performed: a1=1,b1=2; a2=2,b2=3, then after the first operation the current string is yxz, and after the second operation the current string is yzx, so t is yzx.You are asked to restore the original string s. Unfortunately, you have no information about the operations used in the algorithm (you don\'t even know if there were any operations in the sequence). But you may run the same sequence of operations on any string you want, provided that it contains only lowercase Latin letters and its length is n, and get the resulting string after those operations.Can you guess the original string s asking the testing system to run the sequence of swaps no more than 3 times?The string s and the sequence of swaps are fixed in each test; the interactor doesn\'t try to adapt the test to your solution."          
              -999.0                         1116D1 "Block diagonal matrix"  "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N which has 2x2 blocks of non-zero elements on the main diagonal and zero elements everywhere else.For example, for N=3 the matrix of the operation should have the following shape:XX......XX........XX......XX........XX......XX........XX......XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation."          
              -999.0                         1116B1 "Distinguish three-qubit states"  "You are given 3 qubits which are guaranteed to be in one of the two states: |\xcf\x880\xe2\x9f\xa9=1\xe2\x88\x9a3(|100\xe2\x9f\xa9+\xcf\x89|010\xe2\x9f\xa9+\xcf\x892|001\xe2\x9f\xa9), or |\xcf\x881\xe2\x9f\xa9=1\xe2\x88\x9a3(|100\xe2\x9f\xa9+\xcf\x892|010\xe2\x9f\xa9+\xcf\x89|001\xe2\x9f\xa9), where \xcf\x89=e2i\xcf\x80/3.Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was |\xcf\x880\xe2\x9f\xa9 state or 1 if it was |\xcf\x881\xe2\x9f\xa9 state. The state of the qubits after the operations does not matter.You have to implement an operation which takes an array of 3 qubits as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Int {        // your code here    }}"          
              -999.0                         1116A1 "Generate state |00\xe2\x9f\xa9 + |01\xe2\x9f\xa9 + |10\xe2\x9f\xa9"  "You are given two qubits in state |00\xe2\x9f\xa9. Your task is to create the following state on them:1\xe2\x88\x9a3(|00\xe2\x9f\xa9+|01\xe2\x9f\xa9+|10\xe2\x9f\xa9)You have to implement an operation which takes an array of 2 qubits as an input and has no output. The ""output"" of your solution is the state in which it left the input qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}"          
              2500.0                         1111E Tree "data structures,dfs and similar,dp,graphs,trees" "You are given a tree with n nodes and q queries.Every query starts with three integers k, m and r, followed by k nodes of the tree a1,a2,\xe2\x80\xa6,ak. To answer a query, assume that the tree is rooted at r. We want to divide the k given nodes into at most m groups such that the following conditions are met:   Each node should be in exactly one group and each group should have at least one node.  In any group, there should be no two distinct nodes such that one node is an ancestor (direct or indirect) of the other. You need to output the number of ways modulo 109+7 for every query."          
              1800.0                         1109B "Sasha and One More Name" "constructive algorithms,hashing,strings" "Reading books is one of Sasha\'s passions. Once while he was reading one book, he became acquainted with an unusual character. The character told about himself like that: ""Many are my names in many countries. Mithrandir among the Elves, Thark\xc3\xbbn to the Dwarves, Ol\xc3\xb3rin I was in my youth in the West that is forgotten, in the South Inc\xc3\xa1nus, in the North Gandalf; to the East I go not.""And at that moment Sasha thought, how would that character be called in the East? In the East all names are palindromes. A string is a palindrome if it reads the same backward as forward. For example, such strings as ""kazak"", ""oo"" and ""r"" are palindromes, but strings ""abb"" and ""ij"" are not. Sasha believed that the hero would be named after one of the gods of the East. As long as there couldn\'t be two equal names, so in the East people did the following: they wrote the original name as a string on a piece of paper, then cut the paper minimum number of times k, so they got k+1 pieces of paper with substrings of the initial string, and then unite those pieces together to get a new string. Pieces couldn\'t be turned over, they could be shuffled.In this way, it\'s possible to achive a string abcdefg from the string f|de|abc|g using 3 cuts (by swapping papers with substrings f and abc). The string cbadefg can\'t be received using the same cuts.More formally, Sasha wants for the given palindrome s find such minimum k, that you can cut this string into k+1 parts, and then unite them in such a way that the final string will be a palindrome and it won\'t be equal to the initial string s. It there is no answer, then print ""Impossible"" (without quotes)."          
              1800.0                         1108E1 "Array and Segments (Easy version)" "brute force,greedy,implementation" "The only difference between easy and hard versions is a number of elements in the array.You are given an array a consisting of n integers. The value of the i-th element of the array is ai.You are also given a set of m segments. The j-th segment is [lj;rj], where 1\xe2\x89\xa4lj\xe2\x89\xa4rj\xe2\x89\xa4n.You can choose some subset of the given set of segments and decrease values on each of the chosen segments by one (independently). For example, if the initial array a=[0,0,0,0,0] and the given segments are [1;3] and [2;4] then you can choose both of them and the array will become b=[\xe2\x88\x921,\xe2\x88\x922,\xe2\x88\x922,\xe2\x88\x921,0].You have to choose some subset of the given segments (each segment can be chosen at most once) in such a way that if you apply this subset of segments to the array a and obtain the array b then the value nmaxi=1bi\xe2\x88\x92nmini=1bi will be maximum possible.Note that you can choose the empty set.If there are multiple answers, you can print any.If you are Python programmer, consider using PyPy instead of Python when you submit your code."          
              2400.0                         1107G "Vasya and Maximum Profit" "binary search,constructive algorithms,data structures,dp,dsu" "Vasya got really tired of these credits (from problem F) and now wants to earn the money himself! He decided to make a contest to gain a profit.Vasya has n problems to choose from. They are numbered from 1 to n. The difficulty of the i-th problem is di. Moreover, the problems are given in the increasing order by their difficulties. The difficulties of all tasks are pairwise distinct. In order to add the i-th problem to the contest you need to pay ci burles to its author. For each problem in the contest Vasya gets a burles.In order to create a contest he needs to choose a consecutive subsegment of tasks.So the total earnings for the contest are calculated as follows:   if Vasya takes problem i to the contest, he needs to pay ci to its author;  for each problem in the contest Vasya gets a burles;  let gap(l,r)=maxl\xe2\x89\xa4i<r(di+1\xe2\x88\x92di)2. If Vasya takes all the tasks with indices from l to r to the contest, he also needs to pay gap(l,r). If l=r then gap(l,r)=0. Calculate the maximum profit that Vasya can earn by taking a consecutive segment of tasks."          
              900.0                         1106C "Lunar New Year and Number Division" greedy,implementation,math,sortings "Lunar New Year is approaching, and Bob is struggling with his homework \xe2\x80\x93 a number division problem.There are n positive integers a1,a2,\xe2\x80\xa6,an on Bob\'s homework paper, where n is always an even number. Bob is asked to divide those numbers into groups, where each group must contain at least 2 numbers. Suppose the numbers are divided into m groups, and the sum of the numbers in the j-th group is sj. Bob\'s aim is to minimize the sum of the square of sj, that is m\xe2\x88\x91j=1s2j.Bob is puzzled by this hard problem. Could you please help him solve it?"          
              1500.0                         1105C "Ayoub and Lost Array" combinatorics,dp,math "Ayoub had an array a of integers of size n and this array had two interesting properties:   All the integers in the array were between l and r (inclusive).  The sum of all the elements was divisible by 3. Unfortunately, Ayoub has lost his array, but he remembers the size of the array n and the numbers l and r, so he asked you to find the number of ways to restore the array. Since the answer could be very large, print it modulo 109+7 (i.e. the remainder when dividing by 109+7). In case there are no satisfying arrays (Ayoub has a wrong memory), print 0."          
              1100.0                         1105B "Zuhair and Strings" "brute force,implementation,strings" "Given a string s of length n and integer k (1\xe2\x89\xa4k\xe2\x89\xa4n). The string s has a level x, if x is largest non-negative integer, such that it\'s possible to find in s:  x non-intersecting (non-overlapping) substrings of length k,  all characters of these x substrings are the same (i.e. each substring contains only one distinct character and this character is the same for all the substrings). A substring is a sequence of consecutive (adjacent) characters, it is defined by two integers i and j (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n), denoted as s[i\xe2\x80\xa6j] = ""sisi+1\xe2\x80\xa6sj"".For example, if k=2, then:  the string ""aabb"" has level 1 (you can select substring ""aa""),  the strings ""zzzz"" and ""zzbzz"" has level 2 (you can select two non-intersecting substrings ""zz"" in each of them),  the strings ""abed"" and ""aca"" have level 0 (you can\'t find at least one substring of the length k=2 containing the only distinct character). Zuhair gave you the integer k and the string s of length n. You need to find x, the level of the string s."          
              3100.0                         1103D "Professional layer" bitmasks,dp "Cardbluff is popular sport game in Telegram. Each Cardbluff player has ever dreamed about entrance in the professional layer. There are n judges now in the layer and you are trying to pass the entrance exam. You have a number k \xe2\x80\x94 your skill in Cardbluff.Each judge has a number ai \xe2\x80\x94 an indicator of uncertainty about your entrance to the professional layer and a number ei \xe2\x80\x94 an experience playing Cardbluff. To pass the exam you need to convince all judges by playing with them. You can play only one game with each judge. As a result of a particular game, you can divide the uncertainty of i-th judge by any natural divisor of ai which is at most k. If GCD of all indicators is equal to 1, you will enter to the professional layer and become a judge.Also, you want to minimize the total amount of spent time. So, if you play with x judges with total experience y you will spend x\xe2\x8b\x85y seconds.Print minimal time to enter to the professional layer or \xe2\x88\x921 if it\'s impossible."          
              1400.0                         1103A "Grid game" "constructive algorithms,implementation" "You are given a 4x4 grid. You play a game \xe2\x80\x94 there is a sequence of tiles, each of them is either 2x1 or 1x2. Your task is to consequently place all tiles from the given sequence in the grid. When tile is placed, each cell which is located in fully occupied row or column is deleted (cells are deleted at the same time independently). You can place tile in the grid at any position, the only condition is that tiles (and tile parts) should not overlap. Your goal is to proceed all given figures and avoid crossing at any time."          
              1000.0                         1101A "Minimum Integer" math "You are given q queries in the following form:Given three integers li, ri and di, find minimum positive integer xi such that it is divisible by di and it does not belong to the segment [li,ri].Can you answer all the queries?Recall that a number x belongs to segment [l,r] if l\xe2\x89\xa4x\xe2\x89\xa4r."          
              1200.0                         1100C "NN and the Optical Illusion" "binary search,geometry,math" "NN is an experienced internet user and that means he spends a lot of time on the social media. Once he found the following image on the Net, which asked him to compare the sizes of inner circles:  It turned out that the circles are equal. NN was very surprised by this fact, so he decided to create a similar picture himself.He managed to calculate the number of outer circles n and the radius of the inner circle r. NN thinks that, using this information, you can exactly determine the radius of the outer circles R so that the inner circle touches all of the outer ones externally and each pair of neighboring outer circles also touches each other. While NN tried very hard to guess the required radius, he didn\'t manage to do that. Help NN find the required radius for building the required picture."          
              1300.0                         1100B "Build a Contest" "data structures,implementation" "Arkady coordinates rounds on some not really famous competitive programming platform. Each round features n problems of distinct difficulty, the difficulties are numbered from 1 to n.To hold a round Arkady needs n new (not used previously) problems, one for each difficulty. As for now, Arkady creates all the problems himself, but unfortunately, he can\'t just create a problem of a desired difficulty. Instead, when he creates a problem, he evaluates its difficulty from 1 to n and puts it into the problems pool.At each moment when Arkady can choose a set of n new problems of distinct difficulties from the pool, he holds a round with these problems and removes them from the pool. Arkady always creates one problem at a time, so if he can hold a round after creating a problem, he immediately does it.You are given a sequence of problems\' difficulties in the order Arkady created them. For each problem, determine whether Arkady held the round right after creating this problem, or not. Initially the problems pool is empty."          
              3400.0                         1098E "Fedya the Potter" "binary search,implementation,math,number theory" "Fedya loves problems involving data structures. Especially ones about different queries on subsegments. Fedya had a nice array a1,a2,\xe2\x80\xa6an and a beautiful data structure. This data structure, given l and r, 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, could find the greatest integer d, such that d divides each of al, al+1, ..., ar. Fedya really likes this data structure, so he applied it to every non-empty contiguous subarray of array a, put all answers into the array and sorted it. He called this array b. It\'s easy to see that array b contains n(n+1)/2 elements.After that, Fedya implemented another cool data structure, that allowed him to find sum bl+bl+1+\xe2\x80\xa6+br for given l and r, 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n(n+1)/2. Surely, Fedya applied this data structure to every contiguous subarray of array b, called the result c and sorted it. Help Fedya find the lower median of array c.Recall that for a sorted array of length k the lower median is an element at position \xe2\x8c\x8ak+12\xe2\x8c\x8b, if elements of the array are enumerated starting from 1. For example, the lower median of array (1,1,2,3,6) is 2, and the lower median of (0,17,23,96) is 17."          
              2800.0                         1098D Eels "data structures" "Vasya is a big fish lover, and his parents gave him an aquarium for the New Year. Vasya does not have a degree in ichthyology, so he thinks that filling a new aquarium with eels is a good idea. Unfortunately, eels are predators, so Vasya decided to find out how dangerous this idea was.Getting into one aquarium, eels fight each other until exactly one fish remains. When two eels fight, the big one eats the smaller one (if their weights are equal, then one of them will still eat the other). Namely, let n eels be initially in an aquarium, and the i-th of them have a weight of xi. Then n\xe2\x88\x921 battles will occur between them, as a result of which, only one eel will survive. In a battle of two eels with weights a and b, where a\xe2\x89\xa4b, eel of weight a will be eaten and disappear from the aquarium, and eel of weight b will increase its weight to a+b.A battle between two eels with weights a and b, where a\xe2\x89\xa4b, is considered dangerous if b\xe2\x89\xa42a. For a given set of eels, danger is defined as the maximum number of dangerous battles that can occur among these eels if they are placed in one aquarium.Now Vasya is planning, which eels he wants to put into an aquarium. He has some set of eels (initially empty). He makes a series of operations with this set. With each operation, he either adds one eel in the set, or removes one eel from the set. Vasya asks you to calculate the danger of the current set of eels after each operation."          
              1600.0                         1095D "Circular Dance" implementation "There are n kids, numbered from 1 to n, dancing in a circle around the Christmas tree. Let\'s enumerate them in a clockwise direction as p1, p2, ..., pn (all these numbers are from 1 to n and are distinct, so p is a permutation). Let the next kid for a kid pi be kid pi+1 if i<n and p1 otherwise. After the dance, each kid remembered two kids: the next kid (let\'s call him x) and the next kid for x. Each kid told you which kids he/she remembered: the kid i remembered kids ai,1 and ai,2. However, the order of ai,1 and ai,2 can differ from their order in the circle.  Example: 5 kids in a circle, p=[3,2,4,1,5] (or any cyclic shift). The information kids remembered is: a1,1=3, a1,2=5; a2,1=1, a2,2=4; a3,1=2, a3,2=4; a4,1=1, a4,2=5; a5,1=2, a5,2=3. You have to restore the order of the kids in the circle using this information. If there are several answers, you may print any. It is guaranteed that at least one solution exists.If you are Python programmer, consider using PyPy instead of Python when you submit your code."          
              1900.0                         1092F "Tree with Maximum Cost" "dfs and similar,dp,trees" "You are given a tree consisting exactly of n vertices. Tree is a connected undirected graph with n\xe2\x88\x921 edges. Each vertex v of this tree has a value av assigned to it.Let dist(x,y) be the distance between the vertices x and y. The distance between the vertices is the number of edges on the simple path between them.Let\'s define the cost of the tree as the following value: firstly, let\'s fix some vertex of the tree. Let it be v. Then the cost of the tree is n\xe2\x88\x91i=1dist(i,v)\xe2\x8b\x85ai.Your task is to calculate the maximum possible cost of the tree if you can choose v arbitrarily."          
              2200.0                         1092D2 "Great Vova Wall (Version 2)" "data structures,implementation" "Vova\'s family is building the Great Vova Wall (named by Vova himself). Vova\'s parents, grandparents, grand-grandparents contributed to it. Now it\'s totally up to Vova to put the finishing touches.The current state of the wall can be respresented by a sequence a of n integers, with ai being the height of the i-th part of the wall.Vova can only use 2\xc3\x971 bricks to put in the wall (he has infinite supply of them, however).Vova can put bricks only horizontally on the neighbouring parts of the wall of equal height. It means that if for some i the current height of part i is the same as for part i+1, then Vova can put a brick there and thus increase both heights by 1. Obviously, Vova can\'t put bricks in such a way that its parts turn out to be off the borders (to the left of part 1 of the wall or to the right of part n of it).Note that Vova can\'t put bricks vertically.Vova is a perfectionist, so he considers the wall completed when:  all parts of the wall has the same height;  the wall has no empty spaces inside it. Can Vova complete the wall using any amount of bricks (possibly zero)?"          
              1400.0                         1088C "Ehab and a 2-operation task" "constructive algorithms,greedy,math" "You\'re given an array a of length n. You can perform the following operations on it:  choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n), an integer x (0\xe2\x89\xa4x\xe2\x89\xa4106), and replace aj with aj+x for all (1\xe2\x89\xa4j\xe2\x89\xa4i), which means add x to all the elements in the prefix ending at i.  choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n), an integer x (1\xe2\x89\xa4x\xe2\x89\xa4106), and replace aj with aj%x for all (1\xe2\x89\xa4j\xe2\x89\xa4i), which means replace every element in the prefix ending at i with the remainder after dividing it by x. Can you make the array strictly increasing in no more than n+1 operations?"          
              1700.0                         1085D "Minimum Diameter Tree" "constructive algorithms,implementation,trees" "You are given a tree (an undirected connected graph without cycles) and an integer s.Vanya wants to put weights on all edges of the tree so that all weights are non-negative real numbers and their sum is s. At the same time, he wants to make the diameter of the tree as small as possible.Let\'s define the diameter of a weighed tree as the maximum sum of the weights of the edges lying on the path between two some vertices of the tree. In other words, the diameter of a weighed tree is the length of the longest simple path in the tree, where length of a path is equal to the sum of weights over all edges in the path.Find the minimum possible diameter that Vanya can get."          
              1600.0                         1085C "Connect Three" implementation,math "The Squareland national forest is divided into equal 1\xc3\x971 square plots aligned with north-south and east-west directions. Each plot can be uniquely described by integer Cartesian coordinates (x,y) of its south-west corner.Three friends, Alice, Bob, and Charlie are going to buy three distinct plots of land A,B,C in the forest. Initially, all plots in the forest (including the plots A,B,C) are covered by trees. The friends want to visit each other, so they want to clean some of the plots from trees. After cleaning, one should be able to reach any of the plots A,B,C from any other one of those by moving through adjacent cleared plots. Two plots are adjacent if they share a side.  For example, A=(0,0), B=(1,1), C=(2,2). The minimal number of plots to be cleared is 5. One of the ways to do it is shown with the gray color. Of course, the friends don\'t want to strain too much. Help them find out the smallest number of plots they need to clean from trees."          
              1000.0                         1084A "The Fair Nut and Elevator" "brute force,implementation" "The Fair Nut lives in n story house. ai people live on the i-th floor of the house. Every person uses elevator twice a day: to get from the floor where he/she lives to the ground (first) floor and to get from the first floor to the floor where he/she lives, when he/she comes back home in the evening. It was decided that elevator, when it is not used, will stay on the x-th floor, but x hasn\'t been chosen yet. When a person needs to get from floor a to floor b, elevator follows the simple algorithm:   Moves from the x-th floor (initially it stays on the x-th floor) to the a-th and takes the passenger.  Moves from the a-th floor to the b-th floor and lets out the passenger (if a equals b, elevator just opens and closes the doors, but still comes to the floor from the x-th floor).  Moves from the b-th floor back to the x-th.  The elevator never transposes more than one person and always goes back to the floor x before transposing a next passenger. The elevator spends one unit of electricity to move between neighboring floors. So moving from the a-th floor to the b-th floor requires |a\xe2\x88\x92b| units of electricity.Your task is to help Nut to find the minimum number of electricity units, that it would be enough for one day, by choosing an optimal the x-th floor. Don\'t forget than elevator initially stays on the x-th floor."          
              1800.0                         1083A "The Fair Nut and the Best Path" "data structures,dp,trees" "The Fair Nut is going to travel to the Tree Country, in which there are n cities. Most of the land of this country is covered by forest. Furthermore, the local road system forms a tree (connected graph without cycles). Nut wants to rent a car in the city u and go by a simple path to city v. He hasn\'t determined the path, so it\'s time to do it. Note that chosen path can consist of only one vertex.A filling station is located in every city. Because of strange law, Nut can buy only wi liters of gasoline in the i-th city. We can assume, that he has infinite money. Each road has a length, and as soon as Nut drives through this road, the amount of gasoline decreases by length. Of course, Nut can\'t choose a path, which consists of roads, where he runs out of gasoline. He can buy gasoline in every visited city, even in the first and the last.He also wants to find the maximum amount of gasoline that he can have at the end of the path. Help him: count it."          
              2000.0                         1082E "Increasing Frequency" "binary search,dp,greedy" "You are given array a of length n. You can choose one segment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and integer value k (positive, negative or even zero) and change al,al+1,\xe2\x80\xa6,ar by k each (i.e. ai:=ai+k for each l\xe2\x89\xa4i\xe2\x89\xa4r).What is the maximum possible number of elements with value c that can be obtained after one such operation?"          
              1600.0                         1082C "Multi-Subject Competition" greedy,sortings "A multi-subject competition is coming! The competition has m different subjects participants can choose from. That\'s why Alex (the coach) should form a competition delegation among his students. He has n candidates. For the i-th person he knows subject si the candidate specializes in and ri \xe2\x80\x94 a skill level in his specialization (this level can be negative!). The rules of the competition require each delegation to choose some subset of subjects they will participate in. The only restriction is that the number of students from the team participating in each of the chosen subjects should be the same.Alex decided that each candidate would participate only in the subject he specializes in. Now Alex wonders whom he has to choose to maximize the total sum of skill levels of all delegates, or just skip the competition this year if every valid non-empty delegation has negative sum.(Of course, Alex doesn\'t have any spare money so each delegate he chooses must participate in the competition)."          
              2000.0                         1080D "Olya and magical square" "constructive algorithms,implementation,math" "Recently, Olya received a magical square with the size of 2n\xc3\x972n.It seems to her sister that one square is boring. Therefore, she asked Olya to perform exactly k splitting operations.A Splitting operation is an operation during which Olya takes a square with side a and cuts it into 4 equal squares with side a2. If the side of the square is equal to 1, then it is impossible to apply a splitting operation to it (see examples for better understanding).Olya is happy to fulfill her sister\'s request, but she also wants the condition of Olya\'s happiness to be satisfied after all operations.The condition of Olya\'s happiness will be satisfied if the following statement is fulfilled:Let the length of the side of the lower left square be equal to a, then the length of the side of the right upper square should also be equal to a. There should also be a path between them that consists only of squares with the side of length a. All consecutive squares on a path should have a common side.Obviously, as long as we have one square, these conditions are met. So Olya is ready to fulfill her sister\'s request only under the condition that she is satisfied too. Tell her: is it possible to perform exactly k splitting operations in a certain order so that the condition of Olya\'s happiness is satisfied? If it is possible, tell also the size of the side of squares of which the path from the lower left square to the upper right one will consist."          
              1300.0                         1077C "Good Array"  "Let\'s call an array good if there is an element in the array that equals to the sum of all other elements. For example, the array a=[1,3,3,7] is good because there is the element a4=7 which equals to the sum 1+3+3.You are given an array a consisting of n integers. Your task is to print all indices j of this array such that after removing the j-th element from the array it will be good (let\'s call such indices nice).For example, if a=[8,3,5,2], the nice indices are 1 and 4:   if you remove a1, the array will look like [3,5,2] and it is good;  if you remove a4, the array will look like [8,3,5] and it is good. You have to consider all removals independently, i.\xe2\x80\x89e. remove the element, check if the resulting array is good, and return the element into the array."          
              800.0                         1075A "The King\'s Race" implementation,math "On a chessboard with a width of nn and a height of nn, rows are numbered from bottom to top from 11 to nn, columns are numbered from left to right from 11 to nn. Therefore, for each cell of the chessboard, you can assign the coordinates (r,c)(r,c), where rr is the number of the row, and cc is the number of the column.The white king has been sitting in a cell with (1,1)(1,1) coordinates for a thousand years, while the black king has been sitting in a cell with (n,n)(n,n) coordinates. They would have sat like that further, but suddenly a beautiful coin fell on the cell with coordinates (x,y)(x,y)...Each of the monarchs wanted to get it, so they decided to arrange a race according to slightly changed chess rules:As in chess, the white king makes the first move, the black king makes the second one, the white king makes the third one, and so on. However, in this problem, kings can stand in adjacent cells or even in the same cell at the same time.The player who reaches the coin first will win, that is to say, the player who reaches the cell with the coordinates (x,y)(x,y) first will win.Let\'s recall that the king is such a chess piece that can move one cell in all directions, that is, if the king is in the (a,b)(a,b) cell, then in one move he can move from (a,b)(a,b) to the cells (a+1,b)(a+1,b), (a\xe2\x88\x921,b)(a\xe2\x88\x921,b), (a,b+1)(a,b+1), (a,b\xe2\x88\x921)(a,b\xe2\x88\x921), (a+1,b\xe2\x88\x921)(a+1,b\xe2\x88\x921), (a+1,b+1)(a+1,b+1), (a\xe2\x88\x921,b\xe2\x88\x921)(a\xe2\x88\x921,b\xe2\x88\x921), or (a\xe2\x88\x921,b+1)(a\xe2\x88\x921,b+1). Going outside of the field is prohibited.Determine the color of the king, who will reach the cell with the coordinates (x,y)(x,y) first, if the white king moves first."          
              2300.0                         1073E "Segment Sum" bitmasks,combinatorics,dp,math "You are given two integers l and r (l\xe2\x89\xa4r). Your task is to calculate the sum of numbers from l to r (including l and r) such that each number contains at most k different digits, and print this sum modulo 998244353.For example, if k=1 then you have to calculate all numbers from l to r such that each number is formed using only one digit. For l=10,r=50 the answer is 11+22+33+44=110."          
              2400.0                         1070B Berkomnadzor "data structures,greedy" "Berkomnadzor \xe2\x80\x94 Federal Service for Supervision of Communications, Information Technology and Mass Media \xe2\x80\x94 is a Berland federal executive body that protects ordinary residents of Berland from the threats of modern internet.Berkomnadzor maintains a list of prohibited IPv4 subnets (blacklist) and a list of allowed IPv4 subnets (whitelist). All Internet Service Providers (ISPs) in Berland must configure the network equipment to block access to all IPv4 addresses matching the blacklist. Also ISPs must provide access (that is, do not block) to all IPv4 addresses matching the whitelist. If an IPv4 address does not match either of those lists, it\'s up to the ISP to decide whether to block it or not. An IPv4 address matches the blacklist (whitelist) if and only if it matches some subnet from the blacklist (whitelist). An IPv4 address can belong to a whitelist and to a blacklist at the same time, this situation leads to a contradiction (see no solution case in the output description).An IPv4 address is a 32-bit unsigned integer written in the form a.b.c.d, where each of the values a,b,c,d is called an octet and is an integer from 0 to 255 written in decimal notation. For example, IPv4 address 192.168.0.1 can be converted to a 32-bit number using the following expression 192\xe2\x8b\x85224+168\xe2\x8b\x85216+0\xe2\x8b\x8528+1\xe2\x8b\x8520. First octet a encodes the most significant (leftmost) 8 bits, the octets b and c \xe2\x80\x94 the following blocks of 8 bits (in this order), and the octet d encodes the least significant (rightmost) 8 bits.The IPv4 network in Berland is slightly different from the rest of the world. There are no reserved or internal addresses in Berland and use all 232 possible values.An IPv4 subnet is represented either as a.b.c.d or as a.b.c.d/x (where 0\xe2\x89\xa4x\xe2\x89\xa432). A subnet a.b.c.d contains a single address a.b.c.d. A subnet a.b.c.d/x contains all IPv4 addresses with x leftmost (most significant) bits equal to x leftmost bits of the address a.b.c.d. It is required that 32\xe2\x88\x92x rightmost (least significant) bits of subnet a.b.c.d/x are zeroes.Naturally it happens that all addresses matching subnet a.b.c.d/x form a continuous range. The range starts with address a.b.c.d (its rightmost 32\xe2\x88\x92x bits are zeroes). The range ends with address which x leftmost bits equal to x leftmost bits of address a.b.c.d, and its 32\xe2\x88\x92x rightmost bits are all ones. Subnet contains exactly 232\xe2\x88\x92x addresses. Subnet a.b.c.d/32 contains exactly one address and can also be represented by just a.b.c.d.For example subnet 192.168.0.0/24 contains range of 256 addresses. 192.168.0.0 is the first address of the range, and 192.168.0.255 is the last one.Berkomnadzor\'s engineers have devised a plan to improve performance of Berland\'s global network. Instead of maintaining both whitelist and blacklist they want to build only a single optimised blacklist containing minimal number of subnets. The idea is to block all IPv4 addresses matching the optimised blacklist and allow all the rest addresses. Of course, IPv4 addresses from the old blacklist must remain blocked and all IPv4 addresses from the old whitelist must still be allowed. Those IPv4 addresses which matched neither the old blacklist nor the old whitelist may be either blocked or allowed regardless of their accessibility before. Please write a program which takes blacklist and whitelist as input and produces optimised blacklist. The optimised blacklist must contain the minimal possible number of subnets and satisfy all IPv4 addresses accessibility requirements mentioned above. IPv4 subnets in the source lists may intersect arbitrarily. Please output a single number -1 if some IPv4 address matches both source whitelist and blacklist."          
              1100.0                         1066A "Vova and Train" math "Vova plans to go to the conference by train. Initially, the train is at the point 1 and the destination point of the path is the point L. The speed of the train is 1 length unit per minute (i.e. at the first minute the train is at the point 1, at the second minute \xe2\x80\x94 at the point 2 and so on).There are lanterns on the path. They are placed at the points with coordinates divisible by v (i.e. the first lantern is at the point v, the second is at the point 2v and so on).There is also exactly one standing train which occupies all the points from l to r inclusive.Vova can see the lantern at the point p if p is divisible by v and there is no standing train at this position (p\xe2\x88\x89[l;r]). Thus, if the point with the lantern is one of the points covered by the standing train, Vova can\'t see this lantern.Your problem is to say the number of lanterns Vova will see during the path. Vova plans to go to t different conferences, so you should answer t independent queries."          
              1600.0                         1065C "Make It Equal" greedy "There is a toy building consisting of n towers. Each tower consists of several cubes standing on each other. The i-th tower consists of hi cubes, so it has height hi.Let\'s define operation slice on some height H as following: for each tower i, if its height is greater than H, then remove some top cubes to make tower\'s height equal to H. Cost of one ""slice"" equals to the total number of removed cubes from all towers.Let\'s name slice as good one if its cost is lower or equal to k (k\xe2\x89\xa5n).  Calculate the minimum number of good slices you have to do to make all towers have the same height. Of course, it is always possible to make it so."          
              800.0                         1065A "Vasya and Chocolate" implementation,math "There is a special offer in Vasya\'s favourite supermarket: if the customer buys a chocolate bars, he or she may take b additional bars for free. This special offer can be used any number of times.Vasya currently has s roubles, and he wants to get as many chocolate bars for free. Each chocolate bar costs c roubles. Help Vasya to calculate the maximum possible number of chocolate bars he can get!"          
              1300.0                         1063A "Oh Those Palindromes" "constructive algorithms,strings" "A non-empty string is called palindrome, if it reads the same from the left to the right and from the right to the left. For example, ""abcba"", ""a"", and ""abba"" are palindromes, while ""abab"" and ""xy"" are not.A string is called a substring of another string, if it can be obtained from that string by dropping some (possibly zero) number of characters from the beginning and from the end of it. For example, ""abc"", ""ab"", and ""c"" are substrings of the string ""abc"", while ""ac"" and ""d"" are not.Let\'s define a palindromic count of the string as the number of its substrings that are palindromes. For example, the palindromic count of the string ""aaa"" is 6 because all its substrings are palindromes, and the palindromic count of the string ""abc"" is 3 because only its substrings of length 1 are palindromes.You are given a string s. You can arbitrarily rearrange its characters. You goal is to obtain a string with the maximum possible value of palindromic count."          
              1600.0                         1062C Banh-mi greedy,implementation,math "JATC loves Banh-mi (a Vietnamese food). His affection for Banh-mi is so much that he always has it for breakfast. This morning, as usual, he buys a Banh-mi and decides to enjoy it in a special way.First, he splits the Banh-mi into n parts, places them on a row and numbers them from 1 through n. For each part i, he defines the deliciousness of the part as xi\xe2\x88\x88{0,1}. JATC\'s going to eat those parts one by one. At each step, he chooses arbitrary remaining part and eats it. Suppose that part is the i-th part then his enjoyment of the Banh-mi will increase by xi and the deliciousness of all the remaining parts will also increase by xi. The initial enjoyment of JATC is equal to 0.For example, suppose the deliciousness of 3 parts are [0,1,0]. If JATC eats the second part then his enjoyment will become 1 and the deliciousness of remaining parts will become [1,_,1]. Next, if he eats the first part then his enjoyment will become 2 and the remaining parts will become [_,_,2]. After eating the last part, JATC\'s enjoyment will become 4.However, JATC doesn\'t want to eat all the parts but to save some for later. He gives you q queries, each of them consisting of two integers li and ri. For each query, you have to let him know what is the maximum enjoyment he can get if he eats all the parts with indices in the range [li,ri] in some order.All the queries are independent of each other. Since the answer to the query could be very large, print it modulo 109+7."          
              2200.0                         1059D "Nature Reserve" "binary search,geometry,ternary search" "There is a forest that we model as a plane and live n rare animals. Animal number i has its lair in the point (xi,yi). In order to protect them, a decision to build a nature reserve has been made.The reserve must have a form of a circle containing all lairs. There is also a straight river flowing through the forest. All animals drink from this river, therefore it must have at least one common point with the reserve. On the other hand, ships constantly sail along the river, so the reserve must not have more than one common point with the river.For convenience, scientists have made a transformation of coordinates so that the river is defined by y=0. Check whether it is possible to build a reserve, and if possible, find the minimum possible radius of such a reserve."          
              3200.0                         1056H "Detect Robots" "data structures,strings" "You successfully found poor Arkady near the exit of the station you\'ve perfectly predicted. You sent him home on a taxi and suddenly came up with a question.There are n crossroads in your city and several bidirectional roads connecting some of them. A taxi ride is a path from some crossroads to another one without passing the same crossroads twice. You have a collection of rides made by one driver and now you wonder if this driver can be a robot or they are definitely a human.You think that the driver can be a robot if for every two crossroads a and b the driver always chooses the same path whenever he drives from a to b. Note that a and b here do not have to be the endpoints of a ride and that the path from b to a can be different. On the contrary, if the driver ever has driven two different paths from a to b, they are definitely a human.Given the system of roads and the description of all rides available to you, determine if the driver can be a robot or not."          
              2700.0                         1054F "Electric Scheme" "flows,graph matchings" "Pasha is a young technician, nevertheless, he has already got a huge goal: to assemble a PC. The first task he has to become familiar with is to assemble an electric scheme.The scheme Pasha assembled yesterday consists of several wires. Each wire is a segment that connects two points on a plane with integer coordinates within the segment [1,109].There are wires of two colors in the scheme:   red wires: these wires are horizontal segments, i.e. if such a wire connects two points (x1,y1) and (x2,y2), then y1=y2;  blue wires: these wires are vertical segments, i.e. if such a wire connects two points (x1,y1) and (x2,y2), then x1=x2. Note that if a wire connects a point to itself, it may be blue, and it can be red. Also, in Pasha\'s scheme no two wires of the same color intersect, i.e. there are no two wires of same color that have common points.The imperfection of Pasha\'s scheme was that the wires were not isolated, so in the points where two wires of different colors intersect, Pasha saw sparks. Pasha wrote down all the points where he saw sparks and obtained a set of n distinct points. After that he disassembled the scheme.Next morning Pasha looked at the set of n points where he had seen sparks and wondered how many wires had he used. Unfortunately, he does not remember that, so he wonders now what is the smallest number of wires he might have used in the scheme. Help him to determine this number and place the wires in such a way that in the resulting scheme the sparks occur in the same places."          
              1500.0                         1054C "Candies Distribution" "constructive algorithms,implementation" "There are n children numbered from 1 to n in a kindergarten. Kindergarten teacher gave ai (1\xe2\x89\xa4ai\xe2\x89\xa4n) candies to the i-th child. Children were seated in a row in order from 1 to n from left to right and started eating candies. While the i-th child was eating candies, he calculated two numbers li and ri \xe2\x80\x94 the number of children seating to the left of him that got more candies than he and the number of children seating to the right of him that got more candies than he, respectively.Formally, li is the number of indices j (1\xe2\x89\xa4j<i), such that ai<aj and ri is the number of indices j (i<j\xe2\x89\xa4n), such that ai<aj.Each child told to the kindergarten teacher the numbers li and ri that he calculated. Unfortunately, she forgot how many candies she has given to each child. So, she asks you for help: given the arrays l and r determine whether she could have given the candies to the children such that all children correctly calculated their values li and ri, or some of them have definitely made a mistake. If it was possible, find any way how she could have done it."          
              800.0                         1054A "Elevator or Stairs?" implementation "Masha lives in a multi-storey building, where floors are numbered with positive integers. Two floors are called adjacent if their numbers differ by one. Masha decided to visit Egor. Masha lives on the floor x, Egor on the floor y (not on the same floor with Masha).The house has a staircase and an elevator. If Masha uses the stairs, it takes t1 seconds for her to walk between adjacent floors (in each direction). The elevator passes between adjacent floors (in each way) in t2 seconds. The elevator moves with doors closed. The elevator spends t3 seconds to open or close the doors. We can assume that time is not spent on any action except moving between adjacent floors and waiting for the doors to open or close. If Masha uses the elevator, it immediately goes directly to the desired floor.Coming out of the apartment on her floor, Masha noticed that the elevator is now on the floor z and has closed doors. Now she has to choose whether to use the stairs or use the elevator. If the time that Masha needs to get to the Egor\'s floor by the stairs is strictly less than the time it will take her using the elevator, then she will use the stairs, otherwise she will choose the elevator.Help Mary to understand whether to use the elevator or the stairs."          
              2400.0                         1051F "The Shortest Statement" "graphs,shortest paths,trees" "You are given a weighed undirected connected graph, consisting of n vertices and m edges.You should answer q queries, the i-th query is to find the shortest distance between vertices ui and vi."          
              2300.0                         1046I "Say Hello" geometry "Two friends are travelling through Bubble galaxy. They say ""Hello!"" via signals to each other if their distance is smaller or equal than d1 and   it\'s the first time they speak to each other or   at some point in time after their last talk their distance was greater than d2. We need to calculate how many times friends said ""Hello!"" to each other. For N moments, you\'ll have an array of points for each friend representing their positions at that moment. A person can stay in the same position between two moments in time, but if a person made a move we assume this movement as movement with constant speed in constant direction."          
              1400.0                         1046F "Splitting money" implementation "After finding and moving to the new planet that supports human life, discussions started on which currency should be used. After long negotiations, Bitcoin was ultimately chosen as the universal currency.These were the great news for Alice, whose grandfather got into Bitcoin mining in 2013, and accumulated a lot of them throughout the years. Unfortunately, when paying something in bitcoin everyone can see how many bitcoins you have in your public address wallet. This worried Alice, so she decided to split her bitcoins among multiple different addresses, so that every address has at most x satoshi (1 bitcoin = 108 satoshi). She can create new public address wallets for free and is willing to pay f fee in satoshi per transaction to ensure acceptable speed of transfer. The fee is deducted from the address the transaction was sent from. Tell Alice how much total fee in satoshi she will need to pay to achieve her goal."          
              2200.0                         1045D "Interstellar battle" math,probabilities,trees "In the intergalactic empire Bubbledom there are N planets, of which some pairs are directly connected by two-way wormholes. There are N\xe2\x88\x921 wormholes. The wormholes are of extreme religious importance in Bubbledom, a set of planets in Bubbledom consider themselves one intergalactic kingdom if and only if any two planets in the set can reach each other by traversing the wormholes. You are given that Bubbledom is one kingdom. In other words, the network of planets and wormholes is a tree.However, Bubbledom is facing a powerful enemy also possessing teleportation technology. The enemy attacks every night, and the government of Bubbledom retakes all the planets during the day. In a single attack, the enemy attacks every planet of Bubbledom at once, but some planets are more resilient than others. Planets are number 0,1,\xe2\x80\xa6,N\xe2\x88\x921 and the planet i will fall with probability pi. Before every night (including the very first one), the government reinforces or weakens the defenses of a single planet.The government of Bubbledom is interested in the following question: what is the expected number of intergalactic kingdoms Bubbledom will be split into, after a single enemy attack (before they get a chance to rebuild)? In other words, you need to print the expected number of connected components after every attack."          
              2400.0                         1042F "Leaf Sets" "data structures,dfs and similar,dsu,graphs,greedy,sortings,trees" "You are given an undirected tree, consisting of n vertices.The vertex is called a leaf if it has exactly one vertex adjacent to it.The distance between some pair of vertices is the number of edges in the shortest path between them.Let\'s call some set of leaves beautiful if the maximum distance between any pair of leaves in it is less or equal to k.You want to split all leaves into non-intersecting beautiful sets. What is the minimal number of sets in such a split?"          
              1900.0                         1041E "Tree Reconstruction" "constructive algorithms,data structures,graphs,greedy" "Monocarp has drawn a tree (an undirected connected acyclic graph) and then has given each vertex an index. All indices are distinct numbers from 1 to n. For every edge e of this tree, Monocarp has written two numbers: the maximum indices of the vertices of the two components formed if the edge e (and only this edge) is erased from the tree.Monocarp has given you a list of n\xe2\x88\x921 pairs of numbers. He wants you to provide an example of a tree that will produce the said list if this tree exists. If such tree does not exist, say so."          
              1600.0                         1041C "Coffee Break" "binary search,data structures,greedy,two pointers" "Recently Monocarp got a job. His working day lasts exactly m minutes. During work, Monocarp wants to drink coffee at certain moments: there are n minutes a1,a2,\xe2\x80\xa6,an, when he is able and willing to take a coffee break (for the sake of simplicity let\'s consider that each coffee break lasts exactly one minute). However, Monocarp\'s boss doesn\'t like when Monocarp takes his coffee breaks too often. So for the given coffee break that is going to be on minute ai, Monocarp must choose the day in which he will drink coffee during the said minute, so that every day at least d minutes pass between any two coffee breaks. Monocarp also wants to take these n coffee breaks in a minimum possible number of working days (he doesn\'t count days when he is not at work, and he doesn\'t take coffee breaks on such days). Take into account that more than d minutes pass between the end of any working day and the start of the following working day.For each of the n given minutes determine the day, during which Monocarp should take a coffee break in this minute. You have to minimize the number of days spent."          
              1600.0                         1036D "Vasya and Arrays" "greedy,two pointers" "Vasya has two arrays A and B of lengths n and m, respectively.He can perform the following operation arbitrary number of times (possibly zero): he takes some consecutive subsegment of the array and replaces it with a single element, equal to the sum of all elements on this subsegment. For example, from the array [1,10,100,1000,10000] Vasya can obtain array [1,1110,10000], and from array [1,2,3] Vasya can obtain array [6].Two arrays A and B are considered equal if and only if they have the same length and for each valid i Ai=Bi.Vasya wants to perform some of these operations on array A, some on array B, in such a way that arrays A and B become equal. Moreover, the lengths of the resulting arrays should be maximal possible.Help Vasya to determine the maximum length of the arrays that he can achieve or output that it is impossible to make arrays A and B equal."          
              2700.0                         1034C "Region Separation" "combinatorics,dp,number theory,trees" "There are n cities in the Kingdom of Autumn, numbered from 1 to n. People can travel between any two cities using n\xe2\x88\x921 two-directional roads.This year, the government decides to separate the kingdom. There will be regions of different levels. The whole kingdom will be the region of level 1. Each region of i-th level should be separated into several (at least two) regions of i+1-th level, unless i-th level is the last level. Each city should belong to exactly one region of each level and for any two cities in the same region, it should be possible to travel between them passing the cities in the same region only.According to research, for each city i, there is a value ai, which describes the importance of this city. All regions of the same level should have an equal sum of city importances.Your task is to find how many plans there are to determine the separation of the regions that all the conditions are satisfied. Two plans are considered different if and only if their numbers of levels are different or there exist two cities in the same region of one level in one plan but in different regions of this level in the other plan. Since the answer may be very large, output it modulo 109+7."          
              2200.0                         1034B "Little C Loves 3 II" "brute force,constructive algorithms,flows,graph matchings" "Little C loves number \xc2\xab3\xc2\xbb very much. He loves all things about it.Now he is playing a game on a chessboard of size n\xc3\x97m. The cell in the x-th row and in the y-th column is called (x,y). Initially, The chessboard is empty. Each time, he places two chessmen on two different empty cells, the Manhattan distance between which is exactly 3. The Manhattan distance between two cells (xi,yi) and (xj,yj) is defined as |xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|.He want to place as many chessmen as possible on the chessboard. Please help him find the maximum number of chessmen he can place."          
              1600.0                         1033C "Permutation Game" "brute force,dp,games" "After a long day, Alice and Bob decided to play a little game. The game board consists of n cells in a straight line, numbered from 1 to n, where each cell contains a number ai between 1 and n. Furthermore, no two cells contain the same number. A token is placed in one of the cells. They take alternating turns of moving the token around the board, with Alice moving first. The current player can move from cell i to cell j only if the following two conditions are satisfied:   the number in the new cell j must be strictly larger than the number in the old cell i (i.e. aj>ai), and  the distance that the token travels during this turn must be a multiple of the number in the old cell (i.e. |i\xe2\x88\x92j|modai=0). Whoever is unable to make a move, loses. For each possible starting position, determine who wins if they both play optimally. It can be shown that the game is always finite, i.e. there always is a winning strategy for one of the players."          
              1900.0                         1032D "Barcelonian Distance" geometry,implementation "In this problem we consider a very simplified model of Barcelona city.Barcelona can be represented as a plane with streets of kind x=c and y=c for every integer c (that is, the rectangular grid). However, there is a detail which makes Barcelona different from Manhattan. There is an avenue called Avinguda Diagonal which can be represented as a the set of points (x,y) for which ax+by+c=0.One can walk along streets, including the avenue. You are given two integer points A and B somewhere in Barcelona. Find the minimal possible distance one needs to travel to get to B from A."          
              1200.0                         1032B "Personalized Cup"  "At many competitions that have a word \xc2\xabcup\xc2\xbb in its official name the winner is presented with an actual cup. This time the organizers of one unusual programming competition have decided to please the winner even more and to add a nameplate to the cup with the handle of the winner.The nameplate is to be rectangular and the text on it will be printed as a table of several rows and columns. Having some measurements done, the organizers have found out that the number a of rows cannot be greater than 5 while the number b of columns cannot exceed 20. Every cell of the table will contain either an asterisk (\xc2\xab*\xc2\xbb) or a letter of user\'s handle.Furthermore, the organizers want the rows of the table to be uniform, which means that the number of asterisks used in different rows should differ by at most one (i.e. you can\'t have two asterisks in the first row and none in the second). The main goal, however, is to obtain the winner\'s handle precisely when reading the table from top to bottom and from left to right in every row (skipping asterisks).The organizers want for the nameplate to have as few rows as possible and among all valid tables with the minimum number of rows they want to choose the one that has the minimum number of columns.The winner is not yet determined so your task is to write a program that, given a certain handle, generates the necessary table."          
              800.0                         1028A "Find Square" implementation "Consider a table of size n\xc3\x97m, initially fully white. Rows are numbered 1 through n from top to bottom, columns 1 through m from left to right. Some square inside the table with odd side length was painted black. Find the center of this square."          
              3200.0                         1025G "Company Acquisitions" "constructive algorithms,math" "There are n startups. Startups can be active or acquired. If a startup is acquired, then that means it has exactly one active startup that it is following. An active startup can have arbitrarily many acquired startups that are following it. An active startup cannot follow any other startup.The following steps happen until there is exactly one active startup. The following sequence of steps takes exactly 1 day.  Two distinct active startups A, B, are chosen uniformly at random.  A fair coin is flipped, and with equal probability, A acquires B or B acquires A (i.e. if A acquires B, then that means B\'s state changes from active to acquired, and its starts following A).  When a startup changes from active to acquired, all of its previously acquired startups become active. For example, the following scenario can happen: Let\'s say A, B are active startups. C, D, E are acquired startups under A, and F, G are acquired startups under B: Active startups are shown in red. If A acquires B, then the state will be A, F, G are active startups. C, D, E, B are acquired startups under A. F and G have no acquired startups:  If instead, B acquires A, then the state will be B, C, D, E are active startups. F, G, A are acquired startups under B. C, D, E have no acquired startups:  You are given the initial state of the startups. For each startup, you are told if it is either acquired or active. If it is acquired, you are also given the index of the active startup that it is following.You\'re now wondering, what is the expected number of days needed for this process to finish with exactly one active startup at the end.It can be shown the expected number of days can be written as a rational number P/Q, where P and Q are co-prime integers, and Q\xe2\x89\xa00(mod109+7). Return the value of P\xe2\x8b\x85Q\xe2\x88\x921 modulo 109+7."          
              1200.0                         1023A "Single Wildcard Pattern Matching" "brute force,implementation,strings" "You are given two strings s and t. The string s consists of lowercase Latin letters and at most one wildcard character \'*\', the string t consists only of lowercase Latin letters. The length of the string s equals n, the length of the string t equals m.The wildcard character \'*\' in the string s (if any) can be replaced with an arbitrary sequence (possibly empty) of lowercase Latin letters. No other character of s can be replaced with anything. If it is possible to replace a wildcard character \'*\' in s to obtain a string t, then the string t matches the pattern s.For example, if s=""aba*aba"" then the following strings match it ""abaaba"", ""abacaba"" and ""abazzzaba"", but the following strings do not match: ""ababa"", ""abcaaba"", ""codeforces"", ""aba1aba"", ""aba?aba"".If the given string t matches the given string s, print ""YES"", otherwise print ""NO""."          
              800.0                         1017A "The Rank" implementation "John Smith knows that his son, Thomas Smith, is among the best students in his class and even in his school. After the students of the school took the exams in English, German, Math, and History, a table of results was formed.There are n students, each of them has a unique id (from 1 to n). Thomas\'s id is 1. Every student has four scores correspond to his or her English, German, Math, and History scores. The students are given in order of increasing of their ids.In the table, the students will be sorted by decreasing the sum of their scores. So, a student with the largest sum will get the first place. If two or more students have the same sum, these students will be sorted by increasing their ids. Please help John find out the rank of his son."          
              900.0                         1016A "Death Note" greedy,implementation,math "You received a notebook which is called Death Note. This notebook has infinite number of pages. A rule is written on the last page (huh) of this notebook. It says: ""You have to write names in this notebook during n consecutive days. During the i-th day you have to write exactly ai names."". You got scared (of course you got scared, who wouldn\'t get scared if he just receive a notebook which is named Death Note with a some strange rule written in it?).Of course, you decided to follow this rule. When you calmed down, you came up with a strategy how you will write names in the notebook. You have calculated that each page of the notebook can contain exactly m names. You will start writing names from the first page. You will write names on the current page as long as the limit on the number of names on this page is not exceeded. When the current page is over, you turn the page. Note that you always turn the page when it ends, it doesn\'t matter if it is the last day or not. If after some day the current page still can hold at least one name, during the next day you will continue writing the names from the current page.Now you are interested in the following question: how many times will you turn the page during each day? You are interested in the number of pages you will turn each day from 1 to n."          
              1200.0                         1015B "Obtaining the String" implementation "You are given two strings s and t. Both strings have length n and consist of lowercase Latin letters. The characters in the strings are numbered from 1 to n.You can successively perform the following move any number of times (possibly, zero):  swap any two adjacent (neighboring) characters of s (i.e. for any i={1,2,\xe2\x80\xa6,n\xe2\x88\x921} you can swap si and si+1). You can\'t apply a move to the string t. The moves are applied to the string s one after another.Your task is to obtain the string t from the string s. Find any way to do it with at most 104 such moves.You do not have to minimize the number of moves, just find any sequence of moves of length 104 or less to transform s into t."          
              1500.0                         1012A "Photo of The Sky" "brute force,implementation,math,sortings" "Pavel made a photo of his favourite stars in the sky. His camera takes a photo of all points of the sky that belong to some rectangle with sides parallel to the coordinate axes.Strictly speaking, it makes a photo of all points with coordinates (x,y), such that x1\xe2\x89\xa4x\xe2\x89\xa4x2 and y1\xe2\x89\xa4y\xe2\x89\xa4y2, where (x1,y1) and (x2,y2) are coordinates of the left bottom and the right top corners of the rectangle being photographed. The area of this rectangle can be zero.After taking the photo, Pavel wrote down coordinates of n of his favourite stars which appeared in the photo. These points are not necessarily distinct, there can be multiple stars in the same point of the sky.Pavel has lost his camera recently and wants to buy a similar one. Specifically, he wants to know the dimensions of the photo he took earlier. Unfortunately, the photo is also lost. His notes are also of not much help; numbers are written in random order all over his notepad, so it\'s impossible to tell which numbers specify coordinates of which points.Pavel asked you to help him to determine what are the possible dimensions of the photo according to his notes. As there are multiple possible answers, find the dimensions with the minimal possible area of the rectangle."          
              900.0                         1011A Stages greedy,implementation,sortings "Natasha is going to fly to Mars. She needs to build a rocket, which consists of several stages in some order. Each of the stages is defined by a lowercase Latin letter. This way, the rocket can be described by the string \xe2\x80\x94 concatenation of letters, which correspond to the stages.There are n stages available. The rocket must contain exactly k of them. Stages in the rocket should be ordered by their weight. So, after the stage with some letter can go only stage with a letter, which is at least two positions after in the alphabet (skipping one letter in between, or even more). For example, after letter \'c\' can\'t go letters \'a\', \'b\', \'c\' and \'d\', but can go letters \'e\', \'f\', ..., \'z\'.For the rocket to fly as far as possible, its weight should be minimal. The weight of the rocket is equal to the sum of the weights of its stages. The weight of the stage is the number of its letter in the alphabet. For example, the stage \'a \'weighs one ton,\' b \'weighs two tons, and\' z\' \xe2\x80\x94 26 tons.Build the rocket with the minimal weight or determine, that it is impossible to build a rocket at all. Each stage can be used at most once."          
              2000.0                         1009E "Intercity Travelling" combinatorics,math,probabilities "Leha is planning his journey from Moscow to Saratov. He hates trains, so he has decided to get from one city to another by car.The path from Moscow to Saratov can be represented as a straight line (well, it\'s not that straight in reality, but in this problem we will consider it to be straight), and the distance between Moscow and Saratov is n km. Let\'s say that Moscow is situated at the point with coordinate 0 km, and Saratov \xe2\x80\x94 at coordinate n km.Driving for a long time may be really difficult. Formally, if Leha has already covered i kilometers since he stopped to have a rest, he considers the difficulty of covering (i+1)-th kilometer as ai+1. It is guaranteed that for every i\xe2\x88\x88[1,n\xe2\x88\x921] ai\xe2\x89\xa4ai+1. The difficulty of the journey is denoted as the sum of difficulties of each kilometer in the journey.Fortunately, there may be some rest sites between Moscow and Saratov. Every integer point from 1 to n\xe2\x88\x921 may contain a rest site. When Leha enters a rest site, he may have a rest, and the next kilometer will have difficulty a1, the kilometer after it \xe2\x80\x94 difficulty a2, and so on.For example, if n=5 and there is a rest site in coordinate 2, the difficulty of journey will be 2a1+2a2+a3: the first kilometer will have difficulty a1, the second one \xe2\x80\x94 a2, then Leha will have a rest, and the third kilometer will have difficulty a1, the fourth \xe2\x80\x94 a2, and the last one \xe2\x80\x94 a3. Another example: if n=7 and there are rest sites in coordinates 1 and 5, the difficulty of Leha\'s journey is 3a1+2a2+a3+a4.Leha doesn\'t know which integer points contain rest sites. So he has to consider every possible situation. Obviously, there are 2n\xe2\x88\x921 different distributions of rest sites (two distributions are different if there exists some point x such that it contains a rest site in exactly one of these distributions). Leha considers all these distributions to be equiprobable. He wants to calculate p \xe2\x80\x94 the expected value of difficulty of his journey.Obviously, p\xe2\x8b\x852n\xe2\x88\x921 is an integer number. You have to calculate it modulo 998244353."          
              2400.0                         1000F "One Occurrence" "data structures,divide and conquer" "You are given an array a consisting of n integers, and q queries to it. i-th query is denoted by two integers li and ri. For each query, you have to find any integer that occurs exactly once in the subarray of a from index li to index ri (a subarray is a contiguous subsegment of an array). For example, if a=[1,1,2,3,2,4], then for query (li=2,ri=6) the subarray we are interested in is [1,2,3,2,4], and possible answers are 1, 3 and 4; for query (li=1,ri=2) the subarray we are interested in is [1,1], and there is no such element that occurs exactly once.Can you answer all of the queries?"          
              1900.0                         999D "Equalize the Remainders" "data structures,greedy,implementation" "You are given an array consisting of n integers a1,a2,\xe2\x80\xa6,an, and a positive integer m. It is guaranteed that m is a divisor of n.In a single move, you can choose any position i between 1 and n and increase ai by 1.Let\'s calculate cr (0\xe2\x89\xa4r\xe2\x89\xa4m\xe2\x88\x921) \xe2\x80\x94 the number of elements having remainder r when divided by m. In other words, for each remainder, let\'s find the number of corresponding elements in a with that remainder.Your task is to change the array in such a way that c0=c1=\xe2\x8b\xaf=cm\xe2\x88\x921=nm.Find the minimum number of moves to satisfy the above requirement."          
              1200.0                         998B Cutting dp,greedy,sortings "There are a lot of things which could be cut \xe2\x80\x94 trees, paper, ""the rope"". In this problem you are going to cut a sequence of integers.There is a sequence of integers, which contains the equal number of even and odd numbers. Given a limited budget, you need to make maximum possible number of cuts such that each resulting segment will have the same number of odd and even integers.Cuts separate a sequence to continuous (contiguous) segments. You may think about each cut as a break between two adjacent elements in a sequence. So after cutting each element belongs to exactly one segment. Say, [4,1,2,3,4,5,4,4,5,5] \xe2\x86\x92 two cuts \xe2\x86\x92 [4,1|2,3,4,5|4,4,5,5]. On each segment the number of even elements should be equal to the number of odd elements.The cost of the cut between x and y numbers is |x\xe2\x88\x92y| bitcoins. Find the maximum possible number of cuts that can be made while spending no more than B bitcoins."          
              800.0                         994A Fingerprints implementation "You are locked in a room with a door that has a keypad with 10 keys corresponding to digits from 0 to 9. To escape from the room, you need to enter a correct code. You also have a sequence of digits.Some keys on the keypad have fingerprints. You believe the correct code is the longest not necessarily contiguous subsequence of the sequence you have that only contains digits with fingerprints on the corresponding keys. Find such code."          
              2500.0                         993D "Compute Power" "binary search,dp,greedy" "You need to execute several tasks, each associated with number of processors it needs, and the compute power it will consume.You have sufficient number of analog computers, each with enough processors for any task. Each computer can execute up to one task at a time, and no more than two tasks total. The first task can be any, the second task on each computer must use strictly less power than the first. You will assign between 1 and 2 tasks to each computer. You will then first execute the first task on each computer, wait for all of them to complete, and then execute the second task on each computer that has two tasks assigned.If the average compute power per utilized processor (the sum of all consumed powers for all tasks presently running divided by the number of utilized processors) across all computers exceeds some unknown threshold during the execution of the first tasks, the entire system will blow up. There is no restriction on the second tasks execution. Find the lowest threshold for which it is possible.Due to the specifics of the task, you need to print the answer multiplied by 1000 and rounded up."          
              1600.0                         992B "Nastya Studies Informatics" "math,number theory" "Today on Informatics class Nastya learned about GCD and LCM (see links below). Nastya is very intelligent, so she solved all the tasks momentarily and now suggests you to solve one of them as well.We define a pair of integers (a,\xe2\x80\x89b) good, if GCD(a,\xe2\x80\x89b)\xe2\x80\x89=\xe2\x80\x89x and LCM(a,\xe2\x80\x89b)\xe2\x80\x89=\xe2\x80\x89y, where GCD(a,\xe2\x80\x89b) denotes the greatest common divisor of a and b, and LCM(a,\xe2\x80\x89b) denotes the least common multiple of a and b.You are given two integers x and y. You are to find the number of good pairs of integers (a,\xe2\x80\x89b) such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. Note that pairs (a,\xe2\x80\x89b) and (b,\xe2\x80\x89a) are considered different if a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b."          
              1000.0                         990A "Commentary Boxes" implementation,math "Berland Football Cup starts really soon! Commentators from all over the world come to the event.Organizers have already built n commentary boxes. m regional delegations will come to the Cup. Every delegation should get the same number of the commentary boxes. If any box is left unoccupied then the delegations will be upset. So each box should be occupied by exactly one delegation.If n is not divisible by m, it is impossible to distribute the boxes to the delegations at the moment.Organizers can build a new commentary box paying a burles and demolish a commentary box paying b burles. They can both build and demolish boxes arbitrary number of times (each time paying a corresponding fee). It is allowed to demolish all the existing boxes.What is the minimal amount of burles organizers should pay to satisfy all the delegations (i.e. to make the number of the boxes be divisible by m)?"          
              2700.0                         989E "A Trance of Nightfall" dp,geometry,matrices,probabilities "The cool breeze blows gently, the flowing water ripples steadily.""Flowing and passing like this, the water isn\'t gone ultimately; Waxing and waning like that, the moon doesn\'t shrink or grow eventually.""""Everything is transient in a way and perennial in another.""Kanno doesn\'t seem to make much sense out of Mino\'s isolated words, but maybe it\'s time that they enjoy the gentle breeze and the night sky \xe2\x80\x94 the inexhaustible gifts from nature.Gazing into the sky of stars, Kanno indulges in a night\'s tranquil dreams. There is a set S of n points on a coordinate plane.Kanno starts from a point P that can be chosen on the plane. P is not added to S if it doesn\'t belong to S. Then the following sequence of operations (altogether called a move) is repeated several times, in the given order:  Choose a line l such that it passes through at least two elements in S and passes through Kanno\'s current position. If there are multiple such lines, one is chosen equiprobably.  Move to one of the points that belong to S and lie on l. The destination is chosen equiprobably among all possible ones, including Kanno\'s current position (if it does belong to S). There are q queries each consisting of two integers (ti,mi). For each query, you\'re to help Kanno maximize the probability of the stopping position being the ti-th element in S after mi moves with a proper selection of P, and output this maximum probability. Note that according to rule 1, P should belong to at least one line that passes through at least two points from S."          
              2500.0                         989D "A Shade of Moonlight" "binary search,geometry,math,sortings,two pointers" "Gathering darkness shrouds the woods and the world. The moon sheds its light on the boat and the river.""To curtain off the moonlight should be hardly possible; the shades present its mellow beauty and restful nature."" Intonates Mino.""See? The clouds are coming."" Kanno gazes into the distance.""That can\'t be better,"" Mino turns to Kanno. The sky can be seen as a one-dimensional axis. The moon is at the origin whose coordinate is 0.There are n clouds floating in the sky. Each cloud has the same length l. The i-th initially covers the range of (xi,xi+l) (endpoints excluded). Initially, it moves at a velocity of vi, which equals either 1 or \xe2\x88\x921.Furthermore, no pair of clouds intersect initially, that is, for all 1\xe2\x89\xa4i<j\xe2\x89\xa4n, |xi\xe2\x88\x92xj|\xe2\x89\xa5l.With a wind velocity of w, the velocity of the i-th cloud becomes vi+w. That is, its coordinate increases by vi+w during each unit of time. Note that the wind can be strong and clouds can change their direction.You are to help Mino count the number of pairs (i,j) (i<j), such that with a proper choice of wind velocity w not exceeding wmax in absolute value (possibly negative and/or fractional), the i-th and j-th clouds both cover the moon at the same future moment. This w doesn\'t need to be the same across different pairs."          
              1200.0                         989B "A Tide of Riverscape" "constructive algorithms,strings" "Walking along a riverside, Mino silently takes a note of something.""Time,"" Mino thinks aloud.""What?""""Time and tide wait for no man,"" explains Mino. ""My name, taken from the river, always reminds me of this.""""And what are you recording?""""You see it, tide. Everything has its own period, and I think I\'ve figured out this one,"" says Mino with confidence.Doubtfully, Kanno peeks at Mino\'s records. The records are expressed as a string s of characters \'0\', \'1\' and \'.\', where \'0\' denotes a low tide, \'1\' denotes a high tide, and \'.\' denotes an unknown one (either high or low).You are to help Mino determine whether it\'s possible that after replacing each \'.\' independently with \'0\' or \'1\', a given integer p is not a period of the resulting string. In case the answer is yes, please also show such a replacement to Mino.In this problem, a positive integer p is considered a period of string s, if for all 1\xe2\x89\xa4i\xe2\x89\xa4|s|\xe2\x88\x92p, the i-th and (i+p)-th characters of s are the same. Here |s| is the length of s."          
              3100.0                         981H "K Paths" "combinatorics,data structures,dp,fft,math" "You are given a tree of n vertices. You are to select k (not necessarily distinct) simple paths in such a way that it is possible to split all edges of the tree into three sets: edges not contained in any path, edges that are a part of exactly one of these paths, and edges that are parts of all selected paths, and the latter set should be non-empty.Compute the number of ways to select k paths modulo 998244353.The paths are enumerated, in other words, two ways are considered distinct if there are such i (1\xe2\x89\xa4i\xe2\x89\xa4k) and an edge that the i-th path contains the edge in one way and does not contain it in the other."          
              1400.0                         977D "Divide by three, multiply by two" "dfs and similar,math,sortings" "Polycarp likes to play with numbers. He takes some integer number x, writes it down on the board, and then performs with it n\xe2\x88\x921 operations of the two kinds:   divide the number x by 3 (x must be divisible by 3);  multiply the number x by 2. After each operation, Polycarp writes down the result on the board and replaces x by the result. So there will be n numbers on the board after all.You are given a sequence of length n \xe2\x80\x94 the numbers that Polycarp wrote down. This sequence is given in arbitrary order, i.e. the order of the sequence can mismatch the order of the numbers written on the board.Your problem is to rearrange (reorder) elements of this sequence in such a way that it can match possible Polycarp\'s game in the order of the numbers written on the board. I.e. each next number will be exactly two times of the previous number or exactly one third of previous number.It is guaranteed that the answer exists."          
              900.0                         977B Two-gram implementation,strings "Two-gram is an ordered pair (i.e. string of length two) of capital Latin letters. For example, ""AZ"", ""AA"", ""ZA"" \xe2\x80\x94 three distinct two-grams.You are given a string s consisting of n capital Latin letters. Your task is to find any two-gram contained in the given string as a substring (i.e. two consecutive characters of the string) maximal number of times. For example, for string s = ""BBAABBBA"" the answer is two-gram ""BB"", which contained in s three times. In other words, find any most frequent two-gram.Note that occurrences of the two-gram can overlap with each other."          
              2500.0                         976D "Degree Set" "constructive algorithms,graphs,implementation" "You are given a sequence of n positive integers d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dn (d1\xe2\x80\x89<\xe2\x80\x89d2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89dn). Your task is to construct an undirected graph such that:  there are exactly dn\xe2\x80\x89+\xe2\x80\x891 vertices;  there are no self-loops;  there are no multiple edges;  there are no more than 106 edges;  its degree set is equal to d. Vertices should be numbered 1 through (dn\xe2\x80\x89+\xe2\x80\x891).Degree sequence is an array a with length equal to the number of vertices in a graph such that ai is the number of vertices adjacent to i-th vertex.Degree set is a sorted in increasing order sequence of all distinct values from the degree sequence.It is guaranteed that there exists such a graph that all the conditions hold, and it contains no more than 106 edges.Print the resulting graph."          
              1300.0                         976B "Lara Croft and the New Game" implementation,math "You might have heard about the next game in Lara Croft series coming out this year. You also might have watched its trailer. Though you definitely missed the main idea about its plot, so let me lift the veil of secrecy.Lara is going to explore yet another dangerous dungeon. Game designers decided to use good old 2D environment. The dungeon can be represented as a rectangle matrix of n rows and m columns. Cell (x,\xe2\x80\x89y) is the cell in the x-th row in the y-th column. Lara can move between the neighbouring by side cells in all four directions.Moreover, she has even chosen the path for herself to avoid all the traps. She enters the dungeon in cell (1,\xe2\x80\x891), that is top left corner of the matrix. Then she goes down all the way to cell (n,\xe2\x80\x891) \xe2\x80\x94 the bottom left corner. Then she starts moving in the snake fashion \xe2\x80\x94 all the way to the right, one cell up, then to the left to the cell in 2-nd column, one cell up. She moves until she runs out of non-visited cells. n and m given are such that she always end up in cell (1,\xe2\x80\x892).Lara has already moved to a neighbouring cell k times. Can you determine her current position?"          
              1300.0                         964B Messages math "There are n incoming messages for Vasya. The i-th message is going to be received after ti minutes. Each message has a cost, which equals to A initially. After being received, the cost of a message decreases by B each minute (it can become negative). Vasya can read any message after receiving it at any moment of time. After reading the message, Vasya\'s bank account receives the current cost of this message. Initially, Vasya\'s bank account is at 0.Also, each minute Vasya\'s bank account receives C\xc2\xb7k, where k is the amount of received but unread messages.Vasya\'s messages are very important to him, and because of that he wants to have all messages read after T minutes.Determine the maximum amount of money Vasya\'s bank account can hold after T minutes."          
              1600.0                         962D "Merge Equals" "data structures,implementation" "You are given an array of positive integers. While there are at least two equal elements, we will perform the following operation. We choose the smallest value x that occurs in the array 2 or more times. Take the first two occurrences of x in this array (the two leftmost occurrences). Remove the left of these two occurrences, and the right one is replaced by the sum of this two values (that is, 2\xe2\x8b\x85x).Determine how the array will look after described operations are performed.For example, consider the given array looks like [3,4,1,2,2,1,1]. It will be changed in the following way: [3,4,1,2,2,1,1] \xe2\x86\x92 [3,4,2,2,2,1] \xe2\x86\x92 [3,4,4,2,1] \xe2\x86\x92 [3,8,2,1].If the given array is look like [1,1,3,1,1] it will be changed in the following way: [1,1,3,1,1] \xe2\x86\x92 [2,3,1,1] \xe2\x86\x92 [2,3,2] \xe2\x86\x92 [3,4]."          
              2700.0                         961F k-substrings "binary search,hashing,string suffix structures" "You are given a string s consisting of n lowercase Latin letters.Let\'s denote k-substring of s as a string subsk\xe2\x80\x89=\xe2\x80\x89sksk\xe2\x80\x89+\xe2\x80\x891..sn\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89k. Obviously, subs1\xe2\x80\x89=\xe2\x80\x89s, and there are exactly  such substrings.Let\'s call some string t an odd proper suprefix of a string T iff the following conditions are met: |T|\xe2\x80\x89>\xe2\x80\x89|t|;  |t| is an odd number;  t is simultaneously a prefix and a suffix of T.For evey k-substring () of s you have to calculate the maximum length of its odd proper suprefix."          
              3100.0                         960H "Santa\'s Gift" "data structures,trees" "Santa has an infinite number of candies for each of m flavours. You are given a rooted tree with n vertices. The root of the tree is the vertex 1. Each vertex contains exactly one candy. The i-th vertex has a candy of flavour fi.Sometimes Santa fears that candies of flavour k have melted. He chooses any vertex x randomly and sends the subtree of x to the Bakers for a replacement. In a replacement, all the candies with flavour k are replaced with a new candy of the same flavour. The candies which are not of flavour k are left unchanged. After the replacement, the tree is restored.The actual cost of replacing one candy of flavour k is ck (given for each k). The Baker keeps the price fixed in order to make calculation simple. Every time when a subtree comes for a replacement, the Baker charges C, no matter which subtree it is and which flavour it is.Suppose that for a given flavour k the probability that Santa chooses a vertex for replacement is same for all the vertices. You need to find out the expected value of error in calculating the cost of replacement of flavour k. The error in calculating the cost is defined as follows.Error E(k)= (ActualCost \xe2\x80\x93 Price charged by the Bakers)2.Note that the actual cost is the cost of replacement of one candy of the flavour k multiplied by the number of candies in the subtree.Also, sometimes Santa may wish to replace a candy at vertex x with a candy of some flavour from his pocket.You need to handle two types of operations:   Change the flavour of the candy at vertex x to w.  Calculate the expected value of error in calculating the cost of replacement for a given flavour k."          
              2100.0                         960F Pathwalks "data structures,dp,graphs" "You are given a directed graph with n nodes and m edges, with all edges having a certain weight. There might be multiple edges and self loops, and the graph can also be disconnected. You need to choose a path (possibly passing through same vertices multiple times) in the graph such that the weights of the edges are in strictly increasing order, and these edges come in the order of input. Among all such paths, you need to find the the path that has the maximum possible number of edges, and report this value.Please note that the edges picked don\'t have to be consecutive in the input."          
              2100.0                         960D "Full Binary Tree Queries" "brute force,implementation,trees" "You have a full binary tree having infinite levels.Each node has an initial value. If a node has value x, then its left child has value 2\xc2\xb7x and its right child has value 2\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891. The value of the root is 1. You need to answer Q queries. There are 3 types of queries:  Cyclically shift the values of all nodes on the same level as node with value X by K units. (The values/nodes of any other level are not affected). Cyclically shift the nodes on the same level as node with value X by K units. (The subtrees of these nodes will move along with them). Print the value of every node encountered on the simple path from the node with value X to the root.Positive K implies right cyclic shift and negative K implies left cyclic shift. It is guaranteed that atleast one type 3 query is present."          
              2600.0                         958F3 "Lightsabers (hard)" fft "There used to be unrest in the Galactic Senate. Several thousand solar systems had declared their intentions to leave the Republic. But fear not! Master Heidi was able to successfully select the Jedi Knights that have restored peace in the galaxy. However, she knows that evil never sleeps and a time may come when she will need to pick another group of Jedi Knights. She wants to be sure she has enough options to do so.There are n Jedi Knights, each of them with a lightsaber of one of m colors. Given a number k, compute the number of differently colored collections of k lightsabers that some k Jedi Knights might have. Jedi Knights with lightsabers of the same color are indistinguishable (it\'s not the person, it\'s the lightsaber color that matters!), and their order does not matter; that is, we consider two collections of Jedi Knights to be different if and only if their vectors of counts of lightsabers of each color (like what you were given in the easy and the medium versions) are different. We count all subsets, not only contiguous subsegments of the input sequence. Output the answer modulo 1009."          
              1400.0                         958A1 "Death Stars (easy)" implementation "The stardate is 1977 and the science and art of detecting Death Stars is in its infancy. Princess Heidi has received information about the stars in the nearby solar system from the Rebel spies and now, to help her identify the exact location of the Death Star, she needs to know whether this information is correct. Two rebel spies have provided her with the maps of the solar system. Each map is an N\xe2\x80\x89\xc3\x97\xe2\x80\x89N grid, where each cell is either occupied by a star or empty. To see whether the information is correct, Heidi needs to know whether the two maps are of the same solar system, or if possibly one of the spies is actually an Empire double agent, feeding her false information.Unfortunately, spies may have accidentally rotated a map by 90, 180, or 270 degrees, or flipped it along the vertical or the horizontal axis, before delivering it to Heidi. If Heidi can rotate or flip the maps so that two of them become identical, then those maps are of the same solar system. Otherwise, there are traitors in the Rebel ranks! Help Heidi find out."          
              2600.0                         955F Heaps dp,trees "You\'re given a tree with n vertices rooted at 1.We say that there\'s a k-ary heap of depth m located at u if the following holds:  For m\xe2\x80\x89=\xe2\x80\x891 u itself is a k-ary heap of depth 1.  For m\xe2\x80\x89>\xe2\x80\x891 vertex u is a k-ary heap of depth m if at least k of its children are k-ary heaps of depth at least m\xe2\x80\x89-\xe2\x80\x891. Denote dpk(u) as maximum depth of k-ary heap in the subtree of u (including u). Your goal is to compute ."          
              2100.0                         955C "Sad powers" "binary search,math,number theory" "You\'re given Q queries of the form (L,\xe2\x80\x89R). For each query you have to find the number of such x that L\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89R and there exist integer numbers a\xe2\x80\x89>\xe2\x80\x890, p\xe2\x80\x89>\xe2\x80\x891 such that x\xe2\x80\x89=\xe2\x80\x89ap."          
              1400.0                         955B "Not simply beatiful strings" implementation "Let\'s call a string adorable if its letters can be realigned in such a way that they form two consequent groups of equal symbols (note that different groups must contain different symbols). For example, ababa is adorable (you can transform it to aaabb, where the first three letters form a group of a-s and others \xe2\x80\x94 a group of b-s), but cccc is not since in each possible consequent partition letters in these two groups coincide.You\'re given a string s. Check whether it can be split into two non-empty subsequences such that the strings formed by these subsequences are adorable. Here a subsequence is an arbitrary set of indexes of the string."          
              2100.0                         954F "Runner\'s Problem" dp,matrices,sortings "You are running through a rectangular field. This field can be represented as a matrix with 3 rows and m columns. (i,\xe2\x80\x89j) denotes a cell belonging to i-th row and j-th column.You start in (2,\xe2\x80\x891) and have to end your path in (2,\xe2\x80\x89m). From the cell (i,\xe2\x80\x89j) you may advance to:  (i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 only if i\xe2\x80\x89>\xe2\x80\x891,  (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891), or  (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 only if i\xe2\x80\x89<\xe2\x80\x893. However, there are n obstacles blocking your path. k-th obstacle is denoted by three integers ak, lk and rk, and it forbids entering any cell (ak,\xe2\x80\x89j) such that lk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rk.You have to calculate the number of different paths from (2,\xe2\x80\x891) to (2,\xe2\x80\x89m), and print it modulo 109\xe2\x80\x89+\xe2\x80\x897."          
              800.0                         954A "Diagonal Walking" implementation "Mikhail walks on a 2D plane. He can go either up or right. You are given a sequence of Mikhail\'s moves. He thinks that this sequence is too long and he wants to make it as short as possible.In the given sequence moving up is described by character U and moving right is described by character R. Mikhail can replace any pair of consecutive moves RU or UR with a diagonal move (described as character D). After that, he can go on and do some other replacements, until there is no pair of consecutive moves RU or UR left.Your problem is to print the minimum possible length of the sequence of moves after the replacements."          
              2400.0                         952F "2 + 2 != 4"  "One very experienced problem writer decided to prepare a problem for April Fools Day contest. The task was very simple - given an arithmetic expression, return the result of evaluating this expression. However, looks like there is a bug in the reference solution..."          
              2000.0                         952E "Cheese Board"  "Not to be confused with chessboard."          
              800.0                         946A Partition greedy "You are given a sequence a consisting of n integers. You may partition this sequence into two sequences b and c in such a way that every element belongs exactly to one of these sequences. Let B be the sum of elements belonging to b, and C be the sum of elements belonging to c (if some of these sequences is empty, then its sum is 0). What is the maximum possible value of B\xe2\x80\x89-\xe2\x80\x89C?"          
              2000.0                         940E Cashback "data structures,dp,greedy,math" "Since you are the best Wraith King, Nizhniy Magazin \xc2\xabMir\xc2\xbb at the centre of Vinnytsia is offering you a discount.You are given an array a of length n and an integer c. The value of some array b of length k is the sum of its elements except for the  smallest. For example, the value of the array [3,\xe2\x80\x891,\xe2\x80\x896,\xe2\x80\x895,\xe2\x80\x892] with c\xe2\x80\x89=\xe2\x80\x892 is 3\xe2\x80\x89+\xe2\x80\x896\xe2\x80\x89+\xe2\x80\x895\xe2\x80\x89=\xe2\x80\x8914.Among all possible partitions of a into contiguous subarrays output the smallest possible sum of the values of these subarrays."          
              2400.0                         939F Cutlet "data structures,dp" "Arkady wants to have a dinner. He has just returned from a shop where he has bought a semifinished cutlet. He only needs to fry it. The cutlet should be fried for 2n seconds, in particular, it should be fried for n seconds on one side and n seconds on the other side. Arkady has already got a frying pan and turn on fire, but understood that maybe he won\'t be able to flip the cutlet exactly after n seconds after the beginning of cooking.Arkady is too busy with sorting sticker packs in his favorite messenger and can flip the cutlet only in some periods of time. Namely, there are k periods of time in which he can do it, the i-th of them is an interval of time from li seconds after he starts cooking till ri seconds, inclusive. Arkady decided that it\'s not required to flip the cutlet exactly in the middle of cooking, instead, he will flip it several times in such a way that the cutlet will be fried exactly n seconds on one side and n seconds on the other side in total.Help Arkady and find out if it\'s possible for him to cook the cutlet, if he is able to flip the cutlet only in given periods of time; and if yes, find the minimum number of flips he needs to cook the cutlet."          
              1600.0                         939C "Convenient For Everybody" "binary search,two pointers" "In distant future on Earth day lasts for n hours and that\'s why there are n timezones. Local times in adjacent timezones differ by one hour. For describing local time, hours numbers from 1 to n are used, i.e. there is no time ""0 hours"", instead of it ""n hours"" is used. When local time in the 1-st timezone is 1 hour, local time in the i-th timezone is i hours.Some online programming contests platform wants to conduct a contest that lasts for an hour in such a way that its beginning coincides with beginning of some hour (in all time zones). The platform knows, that there are ai people from i-th timezone who want to participate in the contest. Each person will participate if and only if the contest starts no earlier than s hours 00 minutes local time and ends not later than f hours 00 minutes local time. Values s and f are equal for all time zones. If the contest starts at f hours 00 minutes local time, the person won\'t participate in it.Help platform select such an hour, that the number of people who will participate in the contest is maximum."          
              2300.0                         938E "Max History" combinatorics,math "You are given an array a of length n. We define fa the following way:  Initially fa\xe2\x80\x89=\xe2\x80\x890, M\xe2\x80\x89=\xe2\x80\x891;  for every 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n if aM\xe2\x80\x89<\xe2\x80\x89ai then we set fa\xe2\x80\x89=\xe2\x80\x89fa\xe2\x80\x89+\xe2\x80\x89aM and then set M\xe2\x80\x89=\xe2\x80\x89i. Calculate the sum of fa over all n! permutations of the array a modulo 109\xe2\x80\x89+\xe2\x80\x897.Note: two elements are considered different if their indices differ, so for every array a there are exactly n! permutations."          
              800.0                         935A "Fafa and his Company" "brute force,implementation" "Fafa owns a company that works on huge projects. There are n employees in Fafa\'s company. Whenever the company has a new project to start working on, Fafa has to divide the tasks of this project among all the employees.Fafa finds doing this every time is very tiring for him. So, he decided to choose the best l employees in his company as team leaders. Whenever there is a new project, Fafa will divide the tasks among only the team leaders and each team leader will be responsible of some positive number of employees to give them the tasks. To make this process fair for the team leaders, each one of them should be responsible for the same number of employees. Moreover, every employee, who is not a team leader, has to be under the responsibility of exactly one team leader, and no team leader is responsible for another team leader.Given the number of employees n, find in how many ways Fafa could choose the number of team leaders l in such a way that it is possible to divide employees between them evenly."          
              3200.0                         933E "A Preponderant Reunion" "constructive algorithms,dp" "East or west, home is best. That\'s why family reunion, the indispensable necessity of Lunar New Year celebration, is put in such a position.After the reunion dinner, Little Tommy plays a game with the family. Here is a concise introduction to this game:   There is a sequence of n non-negative integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn in the beginning. It is ruled that each integer in this sequence should be non-negative at any time.  You can select two consecutive positive integers in this sequence, pi and pi\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), and then decrease them by their minimum (i. e. min(pi,\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891)), the cost of this operation is equal to min(pi,\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891). We call such operation as a descension.  The game immediately ends when there are no two consecutive positive integers. Your task is to end the game so that the total cost of your operations is as small as possible. Obviously, every game ends after at most n\xe2\x80\x89-\xe2\x80\x891 descensions. Please share your solution of this game with the lowest cost."          
              2700.0                         933C "A Colourful Prospect" geometry,graphs "Firecrackers scare Nian the monster, but they\'re wayyyyy too noisy! Maybe fireworks make a nice complement.Little Tommy is watching a firework show. As circular shapes spread across the sky, a splendid view unfolds on the night of Lunar New Year\'s eve.A wonder strikes Tommy. How many regions are formed by the circles on the sky? We consider the sky as a flat plane. A region is a connected part of the plane with positive area, whose bound consists of parts of bounds of the circles and is a curve or several curves without self-intersections, and that does not contain any curve other than its boundaries. Note that exactly one of the regions extends infinitely."          
              2400.0                         932E "Team Work" combinatorics,dp,math "You have a team of N people. For a particular task, you can pick any non-empty subset of people. The cost of having x people for the task is xk. Output the sum of costs over all non-empty subsets of people."          
              800.0                         932A "Palindromic Supersequence" "constructive algorithms" "You are given a string A. Find a string B, where B is a palindrome and A is a subsequence of B.A subsequence of a string is a string that can be derived from it by deleting some (not necessarily consecutive) characters without changing the order of the remaining characters. For example, ""cotst"" is a subsequence of ""contest"".A palindrome is a string that reads the same forward or backward.The length of string B should be at most 104. It is guaranteed that there always exists such string.You do not need to find the shortest answer, the only restriction is that the length of string B should not exceed 104."          
              1900.0                         930C "Teodor is not a liar!" "data structures,dp" "Young Teodor enjoys drawing. His favourite hobby is drawing segments with integer borders inside his huge [1;m] segment. One day Teodor noticed that picture he just drawn has one interesting feature: there doesn\'t exist an integer point, that belongs each of segments in the picture. Having discovered this fact, Teodor decided to share it with Sasha.Sasha knows that Teodor likes to show off so he never trusts him. Teodor wants to prove that he can be trusted sometimes, so he decided to convince Sasha that there is no such integer point in his picture, which belongs to each segment. However Teodor is lazy person and neither wills to tell Sasha all coordinates of segments\' ends nor wills to tell him their amount, so he suggested Sasha to ask him series of questions \'Given the integer point xi, how many segments in Fedya\'s picture contain that point?\', promising to tell correct answers for this questions.Both boys are very busy studying and don\'t have much time, so they ask you to find out how many questions can Sasha ask Teodor, that having only answers on his questions, Sasha can\'t be sure that Teodor isn\'t lying to him. Note that Sasha doesn\'t know amount of segments in Teodor\'s picture. Sure, Sasha is smart person and never asks about same point twice."          
              1700.0                         929C "\xd0\x9a\xd1\x80\xd0\xb0\xd1\x81\xd0\xb8\xd0\xb2\xd0\xb0\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4\xd0\xb0" "*special problem,combinatorics,math" "\xd0\x97\xd0\xb0\xd0\xb2\xd1\x82\xd1\x80\xd0\xb0 \xd1\x83 \xd1\x85\xd0\xbe\xd0\xba\xd0\xba\xd0\xb5\xd0\xb9\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4\xd1\x8b, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd0\x95\xd0\xb2\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9, \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x82\xd1\x87. \xd0\x95\xd0\xb2\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8e \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb2\xd1\x8b\xd0\xb9\xd0\xb4\xd1\x83\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xbb\xd0\xb5\xd0\xb4 \xd0\xb2 \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb5: \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xb2\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x8c, \xd0\xb4\xd0\xb2\xd0\xb0 \xd0\xb7\xd0\xb0\xd1\x89\xd0\xb8\xd1\x82\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xb8 \xd1\x82\xd1\x80\xd0\xb8 \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85.\xd0\xa2\xd0\xb0\xd0\xba \xd0\xba\xd0\xb0\xd0\xba \xd1\x8d\xd1\x82\xd0\xbe \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd1\x8b\xd0\xb9 \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2, \xd0\x95\xd0\xb2\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xb2\xd0\xbe\xd0\xbb\xd0\xbd\xd1\x83\xd0\xb5\xd1\x82, \xd0\xbd\xd0\xb0\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xba\xd1\x80\xd0\xb0\xd1\x81\xd0\xb8\xd0\xb2\xd0\xb0 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xbb\xd1\x8c\xd0\xb4\xd1\x83, \xd1\x87\xd0\xb5\xd0\xbc \xd1\x81\xd0\xbf\xd0\xbe\xd1\x81\xd0\xbe\xd0\xb1\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2. \xd0\x90 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe, \xd0\x95\xd0\xb2\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9 \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd1\x82\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd1\x8b\xd0\xb9 \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x8b\xd1\x85 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb8\xd0\xb7 \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb0 \xd0\xbe\xd1\x82\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb0\xd0\xbb\xd0\xb8\xd1\x81\xd1\x8c \xd0\xbd\xd0\xb5 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5, \xd1\x87\xd0\xb5\xd0\xbc \xd0\xb2 \xd0\xb4\xd0\xb2\xd0\xb0 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb0. \xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb8 \xd1\x81 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0\xd0\xbc\xd0\xb8 13, 14, 10, 18, 15 \xd0\xb8 20 \xd1\x83\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd1\x8f\xd1\x82 \xd0\x95\xd0\xb2\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f, \xd0\xb0 \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8, \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xbd\xd0\xb0 \xd0\xbb\xd0\xb5\xd0\xb4 \xd0\xb2\xd1\x8b\xd0\xb9\xd0\xb4\xd1\x83\xd1\x82 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb8 \xd1\x81 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0\xd0\xbc\xd0\xb8 8 \xd0\xb8 17, \xd1\x82\xd0\xbe \xd1\x8d\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb5 \xd1\x83\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb8\xd1\x82 \xd0\x95\xd0\xb2\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f.\xd0\x9f\xd1\x80\xd0\xbe \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb2\xd0\xb0\xd0\xbc \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe, \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd0\xb7\xd0\xb8\xd1\x86\xd0\xb8\xd0\xb8 \xd0\xbe\xd0\xbd \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 (\xd0\xb2\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x8c, \xd0\xb7\xd0\xb0\xd1\x89\xd0\xb8\xd1\x82\xd0\xbd\xd0\xb8\xd0\xba \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x8e\xd1\x89\xd0\xb8\xd0\xb9), \xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80. \xd0\x92 \xd1\x85\xd0\xbe\xd0\xba\xd0\xba\xd0\xb5\xd0\xb5 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xbd\xd0\xb5 \xd0\xbe\xd0\xb1\xd1\x8f\xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb8\xd0\xb4\xd1\x83\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x80\xd1\x8f\xd0\xb4. \xd0\x9f\xd0\xbe\xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd1\x8b\xd1\x85 \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbe\xd0\xb2 \xd0\xb8\xd0\xb7 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb2\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x8f, \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd0\xb7\xd0\xb0\xd1\x89\xd0\xb8\xd1\x82\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd1\x85 \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\x95\xd0\xb2\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb2\xd1\x8b\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbd\xd1\x8f\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb5 \xd0\xba\xd1\x80\xd0\xb0\xd1\x81\xd0\xbe\xd1\x82\xd1\x8b."          
              1500.0                         926G "Large Bouquets"  "A flower shop has got n bouquets, and the i-th bouquet consists of ai flowers. Vasya, the manager of the shop, decided to make large bouquets from these bouquets. Vasya thinks that a bouquet is large if it is made of two or more initial bouquets, and there is a constraint: the total number of flowers in a large bouquet should be odd. Each of the initial bouquets can be a part of at most one large bouquet. If an initial bouquet becomes a part of a large bouquet, all its flowers are included in the large bouquet.Determine the maximum possible number of large bouquets Vasya can make."          
              1300.0                         922A "Cloning Toys" implementation "Imp likes his plush toy a lot.  Recently, he found a machine that can clone plush toys. Imp knows that if he applies the machine to an original toy, he additionally gets one more original toy and one copy, and if he applies the machine to a copied toy, he gets two additional copies.Initially, Imp has only one original toy. He wants to know if it is possible to use machine to get exactly x copied toys and y original toys? He can\'t throw toys away, and he can\'t apply the machine to a copy if he doesn\'t currently have any copies."          
              3200.0                         92111 Labyrinth-11  "See the problem statement here: http://codeforces.com/contest/921/problem/01."          
                                           449E "Jzzhu and Squares" "dp,math,number theory" "Jzzhu has two integers, n and m. He calls an integer point (x,\xe2\x80\x89y) of a plane special if 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. Jzzhu defines a unit square as a square with corners at points (x,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), where x and y are some integers.Let\'s look at all the squares (their sides not necessarily parallel to the coordinate axes) with corners at the special points. For each such square Jzzhu paints a dot in every unit square that is fully inside it. After that some unit squares can contain several dots. Now Jzzhu wonders, how many dots he has painted on the plane. Find this number modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2900.0     
                                           446B "DZY Loves Modification" "brute force,data structures,greedy" "As we know, DZY loves playing games. One day DZY decided to play with a n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix. To be more precise, he decided to modify the matrix with exactly k operations.Each modification is one of the following:  Pick some row of the matrix and decrease each element of the row by p. This operation brings to DZY the value of pleasure equal to the sum of elements of the row before the decreasing.  Pick some column of the matrix and decrease each element of the column by p. This operation brings to DZY the value of pleasure equal to the sum of elements of the column before the decreasing. DZY wants to know: what is the largest total value of pleasure he could get after performing exactly k modifications? Please, help him to calculate this value." 2000.0     
                                           445A "DZY Loves Chessboard" "dfs and similar,implementation" "DZY loves chessboard, and he enjoys playing with it.He has a chessboard of n rows and m columns. Some cells of the chessboard are bad, others are good. For every good cell, DZY wants to put a chessman on it. Each chessman is either white or black. After putting all chessmen, DZY wants that no two chessmen with the same color are on two adjacent cells. Two cells are adjacent if and only if they share a common edge.You task is to find any suitable placement of chessmen on the given chessboard." 1200.0     
                                           444A "DZY Loves Physics" greedy,math "DZY loves Physics, and he enjoys calculating density.Almost everything has density, even a graph. We define the density of a non-directed graph (nodes and edges of the graph have some values) as follows:  where v is the sum of the values of the nodes, e is the sum of the values of the edges.Once DZY got a graph G, now he wants to find a connected induced subgraph G\' of the graph, such that the density of G\' is as large as possible.An induced subgraph G\'(V\',\xe2\x80\x89E\') of a graph G(V,\xe2\x80\x89E) is a graph that satisfies:  ;  edge  if and only if , and edge ;  the value of an edge in G\' is the same as the value of the corresponding edge in G, so as the value of a node. Help DZY to find the induced subgraph with maximum density. Note that the induced subgraph you choose must be connected." 1600.0     
                                           439D "Devu and his Brother" "binary search,sortings,ternary search,two pointers" "Devu and his brother love each other a lot. As they are super geeks, they only like to play with arrays. They are given two arrays a and b by their father. The array a is given to Devu and b to his brother. As Devu is really a naughty kid, he wants the minimum value of his array a should be at least as much as the maximum value of his brother\'s array b. Now you have to help Devu in achieving this condition. You can perform multiple operations on the arrays. In a single operation, you are allowed to decrease or increase any element of any of the arrays by 1. Note that you are allowed to apply the operation on any index of the array multiple times.You need to find minimum number of operations required to satisfy Devu\'s condition so that the brothers can play peacefully without fighting." 1700.0     
                                           437D "The Child and Zoo" dsu,sortings "Of course our child likes walking in a zoo. The zoo has n areas, that are numbered from 1 to n. The i-th area contains ai animals in it. Also there are m roads in the zoo, and each road connects two distinct areas. Naturally the zoo is connected, so you can reach any area of the zoo from any other area using the roads.Our child is very smart. Imagine the child want to go from area p to area q. Firstly he considers all the simple routes from p to q. For each route the child writes down the number, that is equal to the minimum number of animals among the route areas. Let\'s denote the largest of the written numbers as f(p,\xe2\x80\x89q). Finally, the child chooses one of the routes for which he writes down the value f(p,\xe2\x80\x89q).After the child has visited the zoo, he thinks about the question: what is the average value of f(p,\xe2\x80\x89q) for all pairs p,\xe2\x80\x89q (p\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89q)? Can you answer his question?" 1900.0     
                                           436D "Pudding Monsters" dp "Have you ever played Pudding Monsters? In this task, a simplified one-dimensional model of this game is used.  Imagine an infinite checkered stripe, the cells of which are numbered sequentially with integers. Some cells of the strip have monsters, other cells of the strip are empty. All monsters are made of pudding, so if there are two monsters in the neighboring cells, they stick to each other (literally). Similarly, if several monsters are on consecutive cells, they all stick together in one block of monsters. We will call the stuck together monsters a block of monsters. A detached monster, not stuck to anyone else, is also considered a block.In one move, the player can take any block of monsters and with a movement of his hand throw it to the left or to the right. The selected monsters will slide on until they hit some other monster (or a block of monsters).For example, if a strip has three monsters in cells 1, 4 and 5, then there are only four possible moves: to send a monster in cell 1 to minus infinity, send the block of monsters in cells 4 and 5 to plus infinity, throw monster 1 to the right (it will stop in cell 3), throw a block of monsters in cells 4 and 5 to the left (they will stop in cells 2 and 3).Some cells on the strip are marked with stars. These are the special cells. The goal of the game is to make the largest possible number of special cells have monsters on them.You are given the numbers of the special cells on a strip as well as the initial position of all monsters. What is the maximum number of special cells that will contain monsters in the optimal game?" 2800.0     
                                           436C "Dungeons and Candies" dsu,graphs,greedy,trees "During the loading of the game ""Dungeons and Candies"" you are required to get descriptions of k levels from the server. Each description is a map of an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m checkered rectangular field. Some cells of the field contain candies (each cell has at most one candy). An empty cell is denoted as ""."" on the map, but if a cell has a candy, it is denoted as a letter of the English alphabet. A level may contain identical candies, in this case the letters in the corresponding cells of the map will be the same.  When you transmit information via a network, you want to minimize traffic \xe2\x80\x94 the total size of the transferred data. The levels can be transmitted in any order. There are two ways to transmit the current level A:  You can transmit the whole level A. Then you need to transmit n\xc2\xb7m bytes via the network.  You can transmit the difference between level A and some previously transmitted level B (if it exists); this operation requires to transmit dA,\xe2\x80\x89B\xc2\xb7w bytes, where dA,\xe2\x80\x89B is the number of cells of the field that are different for A and B, and w is a constant. Note, that you should compare only the corresponding cells of levels A and B to calculate dA,\xe2\x80\x89B. You cannot transform the maps of levels, i.e. rotate or shift them relatively to each other. Your task is to find a way to transfer all the k levels and minimize the traffic." 1800.0     
                                           436A "Feed with Candy" greedy "The hero of the Cut the Rope game is a little monster named Om Nom. He loves candies. And what a coincidence! He also is the hero of today\'s problem.  One day, Om Nom visited his friend Evan. Evan has n candies of two types (fruit drops and caramel drops), the i-th candy hangs at the height of hi centimeters above the floor of the house, its mass is mi. Om Nom wants to eat as many candies as possible. At the beginning Om Nom can make at most x centimeter high jumps. When Om Nom eats a candy of mass y, he gets stronger and the height of his jump increases by y centimeters.What maximum number of candies can Om Nom eat if he never eats two candies of the same type in a row (Om Nom finds it too boring)?" 1500.0     
                                           433E "Tachibana Kanade\'s Tofu" dp "Tachibana Kanade likes Mapo Tofu very much. One day, the canteen cooked all kinds of tofu to sell, but not all tofu is Mapo Tofu, only those spicy enough can be called Mapo Tofu.Each piece of tofu in the canteen is given a m-based number, all numbers are in the range [l,\xe2\x80\x89r] (l and r being m-based numbers), and for every m-based integer in the range [l,\xe2\x80\x89r], there exists a piece of tofu with that number.To judge what tofu is Mapo Tofu, Tachibana Kanade chose n m-based number strings, and assigned a value to each string. If a string appears in the number of a tofu, the value of the string will be added to the value of that tofu. If a string appears multiple times, then the value is also added that many times. Initially the value of each tofu is zero.Tachibana Kanade considers tofu with values no more than k to be Mapo Tofu. So now Tachibana Kanade wants to know, how many pieces of tofu are Mapo Tofu?" 2500.0     
                                           432E "Square Tiling" "constructive algorithms,greedy" "You have an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle table, its cells are not initially painted. Your task is to paint all cells of the table. The resulting picture should be a tiling of the table with squares. More formally:  each cell must be painted some color (the colors are marked by uppercase Latin letters);  we will assume that two cells of the table are connected if they are of the same color and share a side; each connected region of the table must form a square. Given n and m, find lexicographically minimum coloring of the table that meets the described properties." 2300.0     
                                           431B "Shower Line" "brute force,implementation" "Many students live in a dormitory. A dormitory is a whole new world of funny amusements and possibilities but it does have its drawbacks. There is only one shower and there are multiple students who wish to have a shower in the morning. That\'s why every morning there is a line of five people in front of the dormitory shower door. As soon as the shower opens, the first person from the line enters the shower. After a while the first person leaves the shower and the next person enters the shower. The process continues until everybody in the line has a shower.Having a shower takes some time, so the students in the line talk as they wait. At each moment of time the students talk in pairs: the (2i\xe2\x80\x89-\xe2\x80\x891)-th man in the line (for the current moment) talks with the (2i)-th one. Let\'s look at this process in more detail. Let\'s number the people from 1 to 5. Let\'s assume that the line initially looks as 23154 (person number 2 stands at the beginning of the line). Then, before the shower opens, 2 talks with 3, 1 talks with 5, 4 doesn\'t talk with anyone. Then 2 enters the shower. While 2 has a shower, 3 and 1 talk, 5 and 4 talk too. Then, 3 enters the shower. While 3 has a shower, 1 and 5 talk, 4 doesn\'t talk to anyone. Then 1 enters the shower and while he is there, 5 and 4 talk. Then 5 enters the shower, and then 4 enters the shower.We know that if students i and j talk, then the i-th student\'s happiness increases by gij and the j-th student\'s happiness increases by gji. Your task is to find such initial order of students in the line that the total happiness of all students will be maximum in the end. Please note that some pair of students may have a talk several times. In the example above students 1 and 5 talk while they wait for the shower to open and while 3 has a shower." 1200.0     
                                           427A "Police Recruits" implementation "The police department of your city has just started its journey. Initially, they don\xe2\x80\x99t have any manpower. So, they started hiring new recruits in groups.Meanwhile, crimes keeps occurring within the city. One member of the police force can investigate only one crime during his/her lifetime.If there is no police officer free (isn\'t busy with crime) during the occurrence of a crime, it will go untreated.Given the chronological order of crime occurrences and recruit hirings, find the number of crimes which will go untreated." 800.0     
                                           426B "Sereja and Mirroring" implementation "Let\'s assume that we are given a matrix b of size x\xe2\x80\x89\xc3\x97\xe2\x80\x89y, let\'s determine the operation of mirroring matrix b. The mirroring of matrix b is a 2x\xe2\x80\x89\xc3\x97\xe2\x80\x89y matrix c which has the following properties:  the upper half of matrix c (rows with numbers from 1 to x) exactly matches b;  the lower half of matrix c (rows with numbers from x\xe2\x80\x89+\xe2\x80\x891 to 2x) is symmetric to the upper one; the symmetry line is the line that separates two halves (the line that goes in the middle, between rows x and x\xe2\x80\x89+\xe2\x80\x891). Sereja has an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix a. He wants to find such matrix b, that it can be transformed into matrix a, if we\'ll perform on it several (possibly zero) mirrorings. What minimum number of rows can such matrix contain?" 1300.0     
                                           421A "Pasha and Hamsters" "constructive algorithms,implementation" "Pasha has two hamsters: Arthur and Alexander. Pasha put n apples in front of them. Pasha knows which apples Arthur likes. Similarly, Pasha knows which apples Alexander likes. Pasha doesn\'t want any conflict between the hamsters (as they may like the same apple), so he decided to distribute the apples between the hamsters on his own. He is going to give some apples to Arthur and some apples to Alexander. It doesn\'t matter how many apples each hamster gets but it is important that each hamster gets only the apples he likes. It is possible that somebody doesn\'t get any apples.Help Pasha distribute all the apples between the hamsters. Note that Pasha wants to distribute all the apples, not just some of them." 800.0     
                                           417C Football "constructive algorithms,graphs,implementation" "One day, at the ""Russian Code Cup"" event it was decided to play football as an out of competition event. All participants was divided into n teams and played several matches, two teams could not play against each other more than once.The appointed Judge was the most experienced member \xe2\x80\x94 Pavel. But since he was the wisest of all, he soon got bored of the game and fell asleep. Waking up, he discovered that the tournament is over and the teams want to know the results of all the matches.Pavel didn\'t want anyone to discover about him sleeping and not keeping an eye on the results, so he decided to recover the results of all games. To do this, he asked all the teams and learned that the real winner was friendship, that is, each team beat the other teams exactly k times. Help Pavel come up with chronology of the tournir that meets all the conditions, or otherwise report that there is no such table." 1400.0     
                                           416D "Population Size" greedy,implementation,math "Polycarpus develops an interesting theory about the interrelation of arithmetic progressions with just everything in the world. His current idea is that the population of the capital of Berland changes over time like an arithmetic progression. Well, or like multiple arithmetic progressions.Polycarpus believes that if he writes out the population of the capital for several consecutive years in the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, then it is convenient to consider the array as several arithmetic progressions, written one after the other. For example, sequence (8,\xe2\x80\x896,\xe2\x80\x894,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x894,\xe2\x80\x897,\xe2\x80\x8910,\xe2\x80\x892) can be considered as a sequence of three arithmetic progressions (8,\xe2\x80\x896,\xe2\x80\x894,\xe2\x80\x892), (1,\xe2\x80\x894,\xe2\x80\x897,\xe2\x80\x8910) and (2), which are written one after another.Unfortunately, Polycarpus may not have all the data for the n consecutive years (a census of the population doesn\'t occur every year, after all). For this reason, some values of ai \xe2\x80\x8b\xe2\x80\x8bmay be unknown. Such values are represented by number -1.For a given sequence a\xe2\x80\x89=\xe2\x80\x89(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an), which consists of positive integers and values \xe2\x80\x8b\xe2\x80\x8b-1, find the minimum number of arithmetic progressions Polycarpus needs to get a. To get a, the progressions need to be written down one after the other. Values \xe2\x80\x8b\xe2\x80\x8b-1 may correspond to an arbitrary positive integer and the values ai\xe2\x80\x89>\xe2\x80\x890 must be equal to the corresponding elements of sought consecutive record of the progressions.Let us remind you that a finite sequence c is called an arithmetic progression if the difference ci\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89ci of any two consecutive elements in it is constant. By definition, any sequence of length 1 is an arithmetic progression." 2400.0     
                                           416A "Guess a number!" "greedy,implementation,two pointers" "A TV show called ""Guess a number!"" is gathering popularity. The whole Berland, the old and the young, are watching the show.The rules are simple. The host thinks of an integer y and the participants guess it by asking questions to the host. There are four types of acceptable questions:  Is it true that y is strictly larger than number x?  Is it true that y is strictly smaller than number x?  Is it true that y is larger than or equal to number x?  Is it true that y is smaller than or equal to number x? On each question the host answers truthfully, ""yes"" or ""no"".Given the sequence of questions and answers, find any integer value of y that meets the criteria of all answers. If there isn\'t such value, print ""Impossible""." 1400.0     
                                           413E "Maze 2D" "data structures,divide and conquer" "The last product of the R2 company in the 2D games\' field is a new revolutionary algorithm of searching for the shortest path in a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n maze.Imagine a maze that looks like a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n rectangle, divided into unit squares. Each unit square is either an empty cell or an obstacle. In one unit of time, a person can move from an empty cell of the maze to any side-adjacent empty cell. The shortest path problem is formulated as follows. Given two free maze cells, you need to determine the minimum time required to go from one cell to the other.Unfortunately, the developed algorithm works well for only one request for finding the shortest path, in practice such requests occur quite often. You, as the chief R2 programmer, are commissioned to optimize the algorithm to find the shortest path. Write a program that will effectively respond to multiple requests to find the shortest path in a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n maze." 2200.0     
                                           412D "Giving Awards" "dfs and similar" "The employees of the R1 company often spend time together: they watch football, they go camping, they solve contests. So, it\'s no big deal that sometimes someone pays for someone else.Today is the day of giving out money rewards. The R1 company CEO will invite employees into his office one by one, rewarding each one for the hard work this month. The CEO knows who owes money to whom. And he also understands that if he invites person x to his office for a reward, and then immediately invite person y, who has lent some money to person x, then they can meet. Of course, in such a situation, the joy of person x from his brand new money reward will be much less. Therefore, the R1 CEO decided to invite the staff in such an order that the described situation will not happen for any pair of employees invited one after another.However, there are a lot of employees in the company, and the CEO doesn\'t have a lot of time. Therefore, the task has been assigned to you. Given the debt relationships between all the employees, determine in which order they should be invited to the office of the R1 company CEO, or determine that the described order does not exist." 2000.0     
                                           412C Pattern implementation,strings "Developers often face with regular expression patterns. A pattern is usually defined as a string consisting of characters and metacharacters that sets the rules for your search. These patterns are most often used to check whether a particular string meets the certain rules.In this task, a pattern will be a string consisting of small English letters and question marks (\'?\'). The question mark in the pattern is a metacharacter that denotes an arbitrary small letter of the English alphabet. We will assume that a string matches the pattern if we can transform the string into the pattern by replacing the question marks by the appropriate characters. For example, string aba matches patterns: ???, ??a, a?a, aba.Programmers that work for the R1 company love puzzling each other (and themselves) with riddles. One of them is as follows: you are given n patterns of the same length, you need to find a pattern that contains as few question marks as possible, and intersects with each of the given patterns. Two patterns intersect if there is a string that matches both the first and the second pattern. Can you solve this riddle?" 1200.0     
                                           412A Poster greedy,implementation "The R1 company has recently bought a high rise building in the centre of Moscow for its main office. It\'s time to decorate the new office, and the first thing to do is to write the company\'s slogan above the main entrance to the building.The slogan of the company consists of n characters, so the decorators hung a large banner, n meters wide and 1 meter high, divided into n equal squares. The first character of the slogan must be in the first square (the leftmost) of the poster, the second character must be in the second square, and so on.Of course, the R1 programmers want to write the slogan on the poster themselves. To do this, they have a large (and a very heavy) ladder which was put exactly opposite the k-th square of the poster. To draw the i-th character of the slogan on the poster, you need to climb the ladder, standing in front of the i-th square of the poster. This action (along with climbing up and down the ladder) takes one hour for a painter. The painter is not allowed to draw characters in the adjacent squares when the ladder is in front of the i-th square because the uncomfortable position of the ladder may make the characters untidy. Besides, the programmers can move the ladder. In one hour, they can move the ladder either a meter to the right or a meter to the left.Drawing characters and moving the ladder is very tiring, so the programmers want to finish the job in as little time as possible. Develop for them an optimal poster painting plan!" 900.0     
                                           411B "Multi-core Processor" implementation "The research center Q has developed a new multi-core processor. The processor consists of n cores and has k cells of cache memory. Consider the work of this processor.At each cycle each core of the processor gets one instruction: either do nothing, or the number of the memory cell (the core will write an information to the cell). After receiving the command, the core executes it immediately. Sometimes it happens that at one cycle, multiple cores try to write the information into a single cell. Unfortunately, the developers did not foresee the possibility of resolving conflicts between cores, so in this case there is a deadlock: all these cores and the corresponding memory cell are locked forever. Each of the locked cores ignores all further commands, and no core in the future will be able to record an information into the locked cell. If any of the cores tries to write an information into some locked cell, it is immediately locked.The development team wants to explore the deadlock situation. Therefore, they need a program that will simulate the processor for a given set of instructions for each core within m cycles . You\'re lucky, this interesting work is entrusted to you. According to the instructions, during the m cycles define for each core the number of the cycle, during which it will become locked. It is believed that initially all cores and all memory cells are not locked." 1600.0     
                                           409I "Feed the Golorp" "*special problem" "Golorps are mysterious creatures who feed on variables. Golorp\'s name is a program in some programming language. Some scientists believe that this language is Befunge; golorps are tantalizingly silent.Variables consumed by golorps can take values from 0 to 9, inclusive. For each golorp its daily diet is defined by its name. Some golorps are so picky that they can\'t be fed at all. Besides, all golorps are very health-conscious and try to eat as little as possible. Given a choice of several valid sequences of variable values, each golorp will choose lexicographically smallest one.For the purposes of this problem you can assume that a golorp consists of jaws and a stomach. The number of variables necessary to feed a golorp is defined by the shape of its jaws. Variables can get to the stomach only via the jaws.A hungry golorp is visiting you. You know its name; feed it or figure out that it\'s impossible." 2400.0     
                                           405A "Gravity Flip" greedy,implementation,sortings "Little Chris is bored during his physics lessons (too easy), so he has built a toy box to keep himself occupied. The box is special, since it has the ability to change gravity.There are n columns of toy cubes in the box arranged in a line. The i-th column contains ai cubes. At first, the gravity in the box is pulling the cubes downwards. When Chris switches the gravity, it begins to pull all the cubes to the right side of the box. The figure shows the initial and final configurations of the cubes in the box: the cubes that have changed their position are highlighted with orange.  Given the initial configuration of the toy cubes in the box, find the amounts of cubes in each of the n columns after the gravity switch!" 900.0     
                                           404A "Valera and X" implementation "Valera is a little boy. Yesterday he got a huge Math hometask at school, so Valera didn\'t have enough time to properly learn the English alphabet for his English lesson. Unfortunately, the English teacher decided to have a test on alphabet today. At the test Valera got a square piece of squared paper. The length of the side equals n squares (n is an odd number) and each unit square contains some small letter of the English alphabet.Valera needs to know if the letters written on the square piece of paper form letter ""X"". Valera\'s teacher thinks that the letters on the piece of paper form an ""X"", if:  on both diagonals of the square paper all letters are the same;  all other squares of the paper (they are not on the diagonals) contain the same letter that is different from the letters on the diagonals. Help Valera, write the program that completes the described task for him." 1000.0     
                                           403E "Two Rooted Trees" "data structures,implementation,trees" "You have two rooted undirected trees, each contains n vertices. Let\'s number the vertices of each tree with integers from 1 to n. The root of each tree is at vertex 1. The edges of the first tree are painted blue, the edges of the second one are painted red. For simplicity, let\'s say that the first tree is blue and the second tree is red.Edge {x,\xe2\x80\x89y} is called bad for edge {p,\xe2\x80\x89q} if two conditions are fulfilled:   The color of edge {x,\xe2\x80\x89y} is different from the color of edge {p,\xe2\x80\x89q}.  Let\'s consider the tree of the same color that edge {p,\xe2\x80\x89q} is. Exactly one of vertices x, y lies both in the subtree of vertex p and in the subtree of vertex q. In this problem, your task is to simulate the process described below. The process consists of several stages:  On each stage edges of exactly one color are deleted.  On the first stage, exactly one blue edge is deleted.  Let\'s assume that at the stage i we\'ve deleted edges {u1,\xe2\x80\x89v1}, {u2,\xe2\x80\x89v2}, ..., {uk,\xe2\x80\x89vk}. At the stage i\xe2\x80\x89+\xe2\x80\x891 we will delete all undeleted bad edges for edge {u1,\xe2\x80\x89v1}, then we will delete all undeleted bad edges for edge {u2,\xe2\x80\x89v2} and so on until we reach edge {uk,\xe2\x80\x89vk}.  For each stage of deleting edges determine what edges will be removed on the stage. Note that the definition of a bad edge always considers the initial tree before it had any edges removed." 2900.0     
                                           392D "Three Arrays" "data structures" "There are three arrays a, b and c. Each of them consists of n integers. SmallY wants to find three integers u, v, w (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v,\xe2\x80\x89w\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that the following condition holds: each number that appears in the union of a, b and c, appears either in the first u elements of a, or in the first v elements of b, or in the first w elements of c. Of course, SmallY doesn\'t want to have huge numbers u, v and w, so she wants sum u\xe2\x80\x89+\xe2\x80\x89v\xe2\x80\x89+\xe2\x80\x89w to be as small as possible.Please, help her to find the minimal possible sum of u\xe2\x80\x89+\xe2\x80\x89v\xe2\x80\x89+\xe2\x80\x89w." -999.0     
                                           392A "Blocked Points" math "Imagine you have an infinite 2D plane with Cartesian coordinate system. Some of the integral points are blocked, and others are not. Two integral points A and B on the plane are 4-connected if and only if:  the Euclidean distance between A and B is one unit and neither A nor B is blocked;  or there is some integral point C, such that A is 4-connected with C, and C is 4-connected with B. Let\'s assume that the plane doesn\'t contain blocked points. Consider all the integral points of the plane whose Euclidean distance from the origin is no more than n, we\'ll name these points special. Chubby Yang wants to get the following property: no special point is 4-connected to some non-special point. To get the property she can pick some integral points of the plane and make them blocked. What is the minimum number of points she needs to pick?" -999.0     
                                           391F3 "Stock Trading"  "This problem consists of three subproblems: for solving subproblem F1 you will receive 8 points, for solving subproblem F2 you will receive 15 points, and for solving subproblem F3 you will receive 10 points.Manao has developed a model to predict the stock price of a company over the next n days and wants to design a profit-maximizing trading algorithm to make use of these predictions. Unfortunately, Manao\'s trading account has the following restrictions:   It only allows owning either zero or one shares of stock at a time;  It only allows buying or selling a share of this stock once per day;  It allows a maximum of k buy orders over the next n days; For the purposes of this problem, we define a trade to a be the act of buying one share of stock on day i, then holding the stock until some day j\xe2\x80\x89>\xe2\x80\x89i at which point the share is sold. To restate the above constraints, Manao is permitted to make at most k non-overlapping trades during the course of an n-day trading period for which Manao\'s model has predictions about the stock price.Even though these restrictions limit the amount of profit Manao can make compared to what would be achievable with an unlimited number of trades or the ability to hold more than one share at a time, Manao still has the potential to make a lot of money because Manao\'s model perfectly predicts the daily price of the stock. For example, using this model, Manao could wait until the price is low, then buy one share and hold until the price reaches a high value, then sell for a profit, and repeat this process up to k times until n days have passed.Nevertheless, Manao is not satisfied by having a merely good trading algorithm, and wants to develop an optimal strategy for trading subject to these constraints. Help Manao achieve this goal by writing a program that will determine when to buy and sell stock to achieve the greatest possible profit during the n-day trading period subject to the above constraints." -999.0     
                                           391C1 "The Tournament" "brute force" "This problem consists of three subproblems: for solving subproblem C1 you will receive 4 points, for solving subproblem C2 you will receive 4 points, and for solving subproblem C3 you will receive 8 points.Manao decided to pursue a fighter\'s career. He decided to begin with an ongoing tournament. Before Manao joined, there were n contestants in the tournament, numbered from 1 to n. Each of them had already obtained some amount of tournament points, namely the i-th fighter had pi points.Manao is going to engage in a single fight against each contestant. Each of Manao\'s fights ends in either a win or a loss. A win grants Manao one point, and a loss grants Manao\'s opponent one point. For each i, Manao estimated the amount of effort ei he needs to invest to win against the i-th contestant. Losing a fight costs no effort.After Manao finishes all of his fights, the ranklist will be determined, with 1 being the best rank and n\xe2\x80\x89+\xe2\x80\x891 being the worst. The contestants will be ranked in descending order of their tournament points. The contestants with the same number of points as Manao will be ranked better than him if they won the match against him and worse otherwise. The exact mechanism of breaking ties for other fighters is not relevant here.Manao\'s objective is to have rank k or better. Determine the minimum total amount of effort he needs to invest in order to fulfill this goal, if it is possible." -999.0     
                                           388E "Fox and Meteor Shower" geometry "There is a meteor shower on the sky and there are n meteors. The sky can be viewed as a 2D Euclid Plane and the meteor is point on this plane. Fox Ciel looks at the sky. She finds out that the orbit of each meteor is a straight line, and each meteor has a constant velocity. Now Ciel wants to know: what is the maximum number of meteors such that any pair met at the same position at a certain time? Note that the time is not limited and can be also negative. The meteors will never collide when they appear at the same position at the same time." 3100.0     
                                           384B Multitasking "greedy,implementation,sortings,two pointers" "Iahub wants to enhance his multitasking abilities. In order to do this, he wants to sort n arrays simultaneously, each array consisting of m integers.Iahub can choose a pair of distinct indices i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m,\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j). Then in each array the values at positions i and j are swapped only if the value at position i is strictly greater than the value at position j.Iahub wants to find an array of pairs of distinct indices that, chosen in order, sort all of the n arrays in ascending or descending order (the particular order is given in input). The size of the array can be at most  (at most  pairs). Help Iahub, find any suitable array." 1500.0     
                                           383D Antimatter dp "Iahub accidentally discovered a secret lab. He found there n devices ordered in a line, numbered from 1 to n from left to right. Each device i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) can create either ai units of matter or ai units of antimatter. Iahub wants to choose some contiguous subarray of devices in the lab, specify the production mode for each of them (produce matter or antimatter) and finally take a photo of it. However he will be successful only if the amounts of matter and antimatter produced in the selected subarray will be the same (otherwise there would be overflowing matter or antimatter in the photo). You are requested to compute the number of different ways Iahub can successful take a photo. A photo is different than another if it represents another subarray, or if at least one device of the subarray is set to produce matter in one of the photos and antimatter in the other one." 2300.0     
                                           382B "Number Busters" "binary search,math" "Arthur and Alexander are number busters. Today they\'ve got a competition. Arthur took a group of four integers a,\xe2\x80\x89b,\xe2\x80\x89w,\xe2\x80\x89x (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89w,\xe2\x80\x890\xe2\x80\x89<\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89w) and Alexander took integer \xd1\x81. Arthur and Alexander use distinct approaches to number bustings. Alexander is just a regular guy. Each second, he subtracts one from his number. In other words, he performs the assignment: c\xe2\x80\x89=\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891. Arthur is a sophisticated guy. Each second Arthur performs a complex operation, described as follows: if b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89x, perform the assignment b\xe2\x80\x89=\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89x, if b\xe2\x80\x89<\xe2\x80\x89x, then perform two consecutive assignments a\xe2\x80\x89=\xe2\x80\x89a\xe2\x80\x89-\xe2\x80\x891; b\xe2\x80\x89=\xe2\x80\x89w\xe2\x80\x89-\xe2\x80\x89(x\xe2\x80\x89-\xe2\x80\x89b).You\'ve got numbers a,\xe2\x80\x89b,\xe2\x80\x89w,\xe2\x80\x89x,\xe2\x80\x89c. Determine when Alexander gets ahead of Arthur if both guys start performing the operations at the same time. Assume that Alexander got ahead of Arthur if c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a." 2000.0     
                                           380A "Sereja and Prefixes" "binary search,brute force" "Sereja loves number sequences very much. That\'s why he decided to make himself a new one following a certain algorithm.Sereja takes a blank piece of paper. Then he starts writing out the sequence in m stages. Each time he either adds a new number to the end of the sequence or takes l first elements of the current sequence and adds them c times to the end. More formally, if we represent the current sequence as a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, then after we apply the described operation, the sequence transforms into a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an[,\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al] (the block in the square brackets must be repeated c times). A day has passed and Sereja has completed the sequence. He wonders what are the values of some of its elements. Help Sereja." 1600.0     
                                           377E "Cookie Clicker" dp,geometry "Kostya is playing the computer game Cookie Clicker. The goal of this game is to gather cookies. You can get cookies using different buildings: you can just click a special field on the screen and get the cookies for the clicks, you can buy a cookie factory, an alchemy lab, a time machine and it all will bring lots and lots of cookies.At the beginning of the game (time 0), Kostya has 0 cookies and no buildings. He has n available buildings to choose from: the i-th building is worth ci cookies and when it\'s built it brings vi cookies at the end of each second. Also, to make the game more interesting to play, Kostya decided to add a limit: at each moment of time, he can use only one building. Of course, he can change the active building each second at his discretion.It\'s important that Kostya is playing a version of the game where he can buy new buildings and change active building only at time moments that are multiples of one second. Kostya can buy new building and use it at the same time. If Kostya starts to use a building at the time moment t, he can get the first profit from it only at the time moment t\xe2\x80\x89+\xe2\x80\x891.Kostya wants to earn at least s cookies as quickly as possible. Determine the number of seconds he needs to do that." 2800.0     
                                           375D "Tree and Queries" "data structures,dfs and similar,trees" "You have a rooted tree consisting of n vertices. Each vertex of the tree has some color. We will assume that the tree vertices are numbered by integers from 1 to n. Then we represent the color of vertex v as cv. The tree root is a vertex with number 1.In this problem you need to answer to m queries. Each query is described by two integers vj,\xe2\x80\x89kj. The answer to query vj,\xe2\x80\x89kj is the number of such colors of vertices x, that the subtree of vertex vj contains at least kj vertices of color x.You can find the definition of a rooted tree by the following link: http://en.wikipedia.org/wiki/Tree_(graph_theory)." 2400.0     
                                           374C "Inna and Dima" "dfs and similar,dp,graphs,implementation" "Inna and Dima bought a table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in the shop. Each cell of the table contains a single letter: ""D"", ""I"", ""M"", ""A"".Inna loves Dima, so she wants to go through his name as many times as possible as she moves through the table. For that, Inna acts as follows:  initially, Inna chooses some cell of the table where letter ""D"" is written;  then Inna can move to some side-adjacent table cell that contains letter ""I""; then from this cell she can go to one of the side-adjacent table cells that contains the written letter ""M""; then she can go to a side-adjacent cell that contains letter ""A"". Then Inna assumes that she has gone through her sweetheart\'s name;  Inna\'s next move can be going to one of the side-adjacent table cells that contains letter ""D"" and then walk on through name DIMA in the similar manner. Inna never skips a letter. So, from the letter ""D"" she always goes to the letter ""I"", from the letter ""I"" she always goes the to letter ""M"", from the letter ""M"" she always goes to the letter ""A"", and from the letter ""A"" she always goes to the letter ""D"". Depending on the choice of the initial table cell, Inna can go through name DIMA either an infinite number of times or some positive finite number of times or she can\'t go through his name once. Help Inna find out what maximum number of times she can go through name DIMA." 1900.0     
                                           372E "Drawing Circles is Fun" combinatorics,geometry "There are a set of points S on the plane. This set doesn\'t contain the origin O(0,\xe2\x80\x890), and for each two distinct points in the set A and B, the triangle OAB has strictly positive area.Consider a set of pairs of points (P1,\xe2\x80\x89P2),\xe2\x80\x89(P3,\xe2\x80\x89P4),\xe2\x80\x89...,\xe2\x80\x89(P2k\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89P2k). We\'ll call the set good if and only if:  k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892.  All Pi are distinct, and each Pi is an element of S.  For any two pairs (P2i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89P2i) and (P2j\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89P2j), the circumcircles of triangles OP2i\xe2\x80\x89-\xe2\x80\x891P2j\xe2\x80\x89-\xe2\x80\x891 and OP2iP2j have a single common point, and the circumcircle of triangles OP2i\xe2\x80\x89-\xe2\x80\x891P2j and OP2iP2j\xe2\x80\x89-\xe2\x80\x891 have a single common point. Calculate the number of good sets of pairs modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 3000.0     
                                           372A "Counting Kangaroos is Fun" "binary search,greedy,sortings,two pointers" "There are n kangaroos with pockets. Each kangaroo has a size (integer number). A kangaroo can go into another kangaroo\'s pocket if and only if the size of kangaroo who hold the kangaroo is at least twice as large as the size of kangaroo who is held.Each kangaroo can hold at most one kangaroo, and the kangaroo who is held by another kangaroo cannot hold any kangaroos.The kangaroo who is held by another kangaroo cannot be visible from outside. Please, find a plan of holding kangaroos with the minimal number of kangaroos who is visible." 1600.0     
                                           368B "Sereja and Suffixes" "data structures,dp" "Sereja has an array a, consisting of n integers a1, a2, ..., an. The boy cannot sit and do nothing, he decided to study an array. Sereja took a piece of paper and wrote out m integers l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lm (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). For each number li he wants to know how many distinct numbers are staying on the positions li, li\xe2\x80\x89+\xe2\x80\x891, ..., n. Formally, he want to find the number of distinct numbers among ali,\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89an.?Sereja wrote out the necessary array elements but the array was so large and the boy was so pressed for time. Help him, find the answer for the described question for each li." 1100.0     
                                           366C "Dima and Salad" dp "Dima, Inna and Seryozha have gathered in a room. That\'s right, someone\'s got to go. To cheer Seryozha up and inspire him to have a walk, Inna decided to cook something. Dima and Seryozha have n fruits in the fridge. Each fruit has two parameters: the taste and the number of calories. Inna decided to make a fruit salad, so she wants to take some fruits from the fridge for it. Inna follows a certain principle as she chooses the fruits: the total taste to the total calories ratio of the chosen fruits must equal k. In other words,  , where aj is the taste of the j-th chosen fruit and bj is its calories.Inna hasn\'t chosen the fruits yet, she is thinking: what is the maximum taste of the chosen fruits if she strictly follows her principle? Help Inna solve this culinary problem \xe2\x80\x94 now the happiness of a young couple is in your hands!Inna loves Dima very much so she wants to make the salad from at least one fruit." 1900.0     
                                           364E "Empty Rectangles" "divide and conquer,two pointers" "You\'ve got an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table (n rows and m columns), each cell of the table contains a ""0"" or a ""1"".Your task is to calculate the number of rectangles with the sides that are parallel to the sides of the table and go along the cell borders, such that the number one occurs exactly k times in the rectangle." 3000.0     
                                           364C "Beautiful Set" "brute force,number theory" "We\'ll call a set of positive integers a beautiful if the following condition fulfills: for any prime p, if , then . In other words, if one number from the set is divisible by prime p, then at least half of numbers from the set is divisible by p.Your task is to find any beautiful set, where the number of elements is equal to k and each element doesn\'t exceed 2k2." 2300.0     
                                           364A Matrix "combinatorics,data structures,implementation" "You have a string of decimal digits s. Let\'s define bij\xe2\x80\x89=\xe2\x80\x89si\xc2\xb7sj. Find in matrix b the number of such rectangles that the sum bij for all cells (i,\xe2\x80\x89j) that are the elements of the rectangle equals a in each rectangle.A rectangle in a matrix is a group of four integers (x,\xe2\x80\x89y,\xe2\x80\x89z,\xe2\x80\x89t) (x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y,\xe2\x80\x89z\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t). The elements of the rectangle are all cells (i,\xe2\x80\x89j) such that x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y,\xe2\x80\x89z\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t." 1600.0     
                                           362D "Fools and Foolproof Roads" "data structures,dfs and similar,dsu,graphs,greedy" "You must have heard all about the Foolland on your Geography lessons. Specifically, you must know that federal structure of this country has been the same for many centuries. The country consists of n cities, some pairs of cities are connected by bidirectional roads, each road is described by its length li.The fools lived in their land joyfully, but a recent revolution changed the king. Now the king is Vasily the Bear. Vasily divided the country cities into regions, so that any two cities of the same region have a path along the roads between them and any two cities of different regions don\'t have such path. Then Vasily decided to upgrade the road network and construct exactly p new roads in the country. Constructing a road goes like this:  We choose a pair of distinct cities u, v that will be connected by a new road (at that, it is possible that there already is a road between these cities).  We define the length of the new road: if cities u, v belong to distinct regions, then the length is calculated as min(109,\xe2\x80\x89S\xe2\x80\x89+\xe2\x80\x891) (S \xe2\x80\x94 the total length of all roads that exist in the linked regions), otherwise we assume that the length equals 1000.  We build a road of the specified length between the chosen cities. If the new road connects two distinct regions, after construction of the road these regions are combined into one new region. Vasily wants the road constructing process to result in the country that consists exactly of q regions. Your task is to come up with such road constructing plan for Vasily that it meets the requirement and minimizes the total length of the built roads." 2100.0     
                                           360E "Levko and Game" "graphs,greedy,shortest paths" "Levko loves sports pathfinding competitions in his city very much. In order to boost his performance, Levko spends his spare time practicing. The practice is a game.The city consists of n intersections connected by m\xe2\x80\x89+\xe2\x80\x89k directed roads. Two or more roads can connect the same pair of intersections. Besides, there can be roads leading from an intersection to itself. Levko and Zenyk are playing a game. First Levko stands on intersection s1, and Zenyk stands on intersection s2. They both want to get to intersection f. The person who does it quicker wins. If they get there at the same time, the game ends with a draw. By agreement both players start simultaneously and move with the same speed.Levko wants to win very much. He knows the lengths of all the roads in the city. Also he knows that he can change the lengths of some roads (there are k such roads at all) if he pays the government. So, the government can change the length of the i-th road to any integer value in the segment [li, ri] (both borders inclusive). Levko wondered if he can reconstruct the roads so as to win the game and whether he can hope for the draw if he cannot win.You should consider that both players play optimally well. It is guaranteed that we can get from intersections s1 and s2 to intersection f." 2800.0     
                                           359E Neatness "constructive algorithms,dfs and similar" "Simon loves neatness. So before he goes to bed, Simon wants to complete all chores in the house.Simon\'s house looks like a rectangular table consisting of n rows and n columns from above. All rows of the table are numbered from 1 to n from top to bottom. All columns of the table are numbered from 1 to n from left to right. Each cell of the table is a room. Pair (x,\xe2\x80\x89y) denotes the room, located at the intersection of the x-th row and the y-th column. For each room we know if the light is on or not there.Initially Simon is in room (x0,\xe2\x80\x89y0). He wants to turn off the lights in all the rooms in the house, and then return to room (x0,\xe2\x80\x89y0). Suppose that at the current moment Simon is in the room (x,\xe2\x80\x89y). To reach the desired result, he can perform the following steps:  The format of the action is ""1"". The action is to turn on the light in room (x,\xe2\x80\x89y). Simon cannot do it if the room already has light on.  The format of the action is ""2"". The action is to turn off the light in room (x,\xe2\x80\x89y). Simon cannot do it if the room already has light off.  The format of the action is ""dir"" (dir is a character). The action is to move to a side-adjacent room in direction dir. The direction can be left, right, up or down (the corresponding dir is L, R, U or D). Additionally, Simon can move only if he see a light in the direction dir. More formally, if we represent the room, Simon wants to go, as (nx,\xe2\x80\x89ny), there shold be an integer k (k\xe2\x80\x89>\xe2\x80\x890), that room (x\xe2\x80\x89+\xe2\x80\x89(nx\xe2\x80\x89-\xe2\x80\x89x)k,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89(ny\xe2\x80\x89-\xe2\x80\x89y)k) has a light. Of course, Simon cannot move out of his house. Help Simon, find the sequence of actions that lets him achieve the desired result." 2400.0     
                                           359C "Prime Number" "math,number theory" "Simon has a prime number x and an array of non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.Simon loves fractions very much. Today he wrote out number  on a piece of paper. After Simon led all fractions to a common denominator and summed them up, he got a fraction: , where number t equals xa1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an. Now Simon wants to reduce the resulting fraction. Help him, find the greatest common divisor of numbers s and t. As GCD can be rather large, print it as a remainder after dividing it by number 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1900.0     
                                           358C "Dima and Containers" "constructive algorithms,greedy,implementation" "Dima has a birthday soon! It\'s a big day! Saryozha\'s present to Dima is that Seryozha won\'t be in the room and won\'t disturb Dima and Inna as they celebrate the birthday. Inna\'s present to Dima is a stack, a queue and a deck.Inna wants her present to show Dima how great a programmer he is. For that, she is going to give Dima commands one by one. There are two types of commands:  Add a given number into one of containers. For the queue and the stack, you can add elements only to the end. For the deck, you can add elements to the beginning and to the end.  Extract a number from each of at most three distinct containers. Tell all extracted numbers to Inna and then empty all containers. In the queue container you can extract numbers only from the beginning. In the stack container you can extract numbers only from the end. In the deck number you can extract numbers from the beginning and from the end. You cannot extract numbers from empty containers. Every time Dima makes a command of the second type, Inna kisses Dima some (possibly zero) number of times. Dima knows Inna perfectly well, he is sure that this number equals the sum of numbers he extracts from containers during this operation.As we\'ve said before, Dima knows Inna perfectly well and he knows which commands Inna will give to Dima and the order of the commands. Help Dima find the strategy that lets him give as more kisses as possible for his birthday!" 2000.0     
                                           356E "Xenia and String Problem" "dp,hashing,implementation,string suffix structures,strings" "Xenia the coder went to The Olympiad of Informatics and got a string problem. Unfortunately, Xenia isn\'t fabulous in string algorithms. Help her solve the problem.String s is a sequence of characters s1s2... s|s|, where record |s| shows the length of the string. Substring s[i... j] of string s is string sisi\xe2\x80\x89+\xe2\x80\x891... sj.String s is a Gray string, if it meets the conditions:  the length of string |s| is odd;  character  occurs exactly once in the string;  either |s|\xe2\x80\x89=\xe2\x80\x891, or substrings  and  are the same and are Gray strings. For example, strings ""abacaba"", ""xzx"", ""g"" are Gray strings and strings ""aaa"", ""xz"", ""abaxcbc"" are not.The beauty of string p is the sum of the squares of the lengths of all substrings of string p that are Gray strings. In other words, consider all pairs of values i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|). If substring p[i... j] is a Gray string, you should add (j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891)2 to the beauty.Xenia has got string t consisting of lowercase English letters. She is allowed to replace at most one letter of the string by any other English letter. The task is to get a string of maximum beauty." 3000.0     
                                           354D "Transferring Pyramid" dp "Vasya and Petya are using an interesting data storing structure: a pyramid.The pyramid consists of n rows, the i-th row contains i cells. Each row is shifted half a cell to the left relative to the previous row. The cells are numbered by integers from 1 to  as shown on the picture below.An example of a pyramid at n\xe2\x80\x89=\xe2\x80\x895 is:   This data structure can perform operations of two types:   Change the value of a specific cell. It is described by three integers: ""t\xe2\x80\x82i\xe2\x80\x82v"", where t\xe2\x80\x89=\xe2\x80\x891 (the type of operation), i \xe2\x80\x94 the number of the cell to change and v the value to assign to the cell.  Change the value of some subpyramid. The picture shows a highlighted subpyramid with the top in cell 5. It is described by s\xe2\x80\x89+\xe2\x80\x892 numbers: ""t\xe2\x80\x82i\xe2\x80\x82v1\xe2\x80\x82v2\xe2\x80\x82...\xe2\x80\x82vs"", where t\xe2\x80\x89=\xe2\x80\x892, i \xe2\x80\x94 the number of the top cell of the pyramid, s \xe2\x80\x94 the size of the subpyramid (the number of cells it has), vj \xe2\x80\x94 the value you should assign to the j-th cell of the subpyramid. Formally: a subpyramid with top at the i-th cell of the k-th row (the 5-th cell is the second cell of the third row) will contain cells from rows from k to n, the (k\xe2\x80\x89+\xe2\x80\x89p)-th row contains cells from the i-th to the (i\xe2\x80\x89+\xe2\x80\x89p)-th (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k).Vasya and Petya had two identical pyramids. Vasya changed some cells in his pyramid and he now wants to send his changes to Petya. For that, he wants to find a sequence of operations at which Petya can repeat all Vasya\'s changes. Among all possible sequences, Vasya has to pick the minimum one (the one that contains the fewest numbers).You have a pyramid of n rows with k changed cells. Find the sequence of operations which result in each of the k changed cells being changed by at least one operation. Among all the possible sequences pick the one that contains the fewest numbers." 2900.0     
                                           351E "Jeff and Permutation" greedy "Jeff\'s friends know full well that the boy likes to get sequences and arrays for his birthday. Thus, Jeff got sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn for his birthday.Jeff hates inversions in sequences. An inversion in sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is a pair of indexes i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that an inequality ai\xe2\x80\x89>\xe2\x80\x89aj holds.Jeff can multiply some numbers of the sequence p by -1. At that, he wants the number of inversions in the sequence to be minimum. Help Jeff and find the minimum number of inversions he manages to get." 2200.0     
                                           347B "Fixed Points" "brute force,implementation,math" "A permutation of length n is an integer sequence such that each integer from 0 to (n\xe2\x80\x89-\xe2\x80\x891) appears exactly once in it. For example, sequence [0,\xe2\x80\x892,\xe2\x80\x891] is a permutation of length 3 while both [0,\xe2\x80\x892,\xe2\x80\x892] and [1,\xe2\x80\x892,\xe2\x80\x893] are not.A fixed point of a function is a point that is mapped to itself by the function. A permutation can be regarded as a bijective function. We\'ll get a definition of a fixed point in a permutation. An integer i is a fixed point of permutation a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891 if and only if ai\xe2\x80\x89=\xe2\x80\x89i. For example, permutation [0,\xe2\x80\x892,\xe2\x80\x891] has 1 fixed point and permutation [0,\xe2\x80\x891,\xe2\x80\x892] has 3 fixed points.You are given permutation a. You are allowed to swap two elements of the permutation at most once. Your task is to maximize the number of fixed points in the resulting permutation. Note that you are allowed to make at most one swap operation." 1100.0     
                                           345E "Black Cat Rush" "*special problem" "Today you go out of your house and immediately notice that something is weird. Around your door there is a swarm of black cats \xe2\x80\x94 all tense paws and twitching tails. As you do your first step, they all dart off and start running towards you. It looks like they want to thwart you!You are moving in a straight line from point (0,\xe2\x80\x890) to point (a,\xe2\x80\x890) with velocity v. There are n black cats around you who want to cross your paths. A cat can move in any direction with velocity at most u. A cat assumes it has crossed your path if it managed to get to at least one point of your path earlier or at the same time as you got there.You are given four integers: a, v, u, n, as well as cats\' coordinates (xi,\xe2\x80\x89yi). What is the greatest number of cats who manage to cross your path?" 2700.0     
                                           345B Triskaidekaphobia "*special problem" "Triskaidekaphobia is a fear of number 13. Ordinary people who suffer from this phobia feel uncomfortable around numbers 13, 130, 513 etc, but you, being a programmer, take this fear one step further. For example, consider number 7. It\'s ok when written in decimal, but written in base 4 it becomes 13, the dreadful number!The more you think about it, the worse it looks. Number 100 has as many as 13 notations which contain 13! And there are numbers which have 13 in infinite number of their notations! Luckily, you can do any math in binary, which is completely safe from the nasty number. But still, you want to be able to estimate the level of nastiness of any number. Your task is: given an integer n, find the number of different integer bases b (b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892) for which n, written in base b, contains at least one 13. Assume that ""digits"" of the number in bases larger than 10 are written not as letters but as decimal numbers; thus, 30 in base 16 is not 1E but (1)(14) or simply 114. Please note, that 13 must be present as a substring of notation, not a subsequence (123 doesn\'t contain 13)." 2100.0     
                                           341E "Candies Game" "constructive algorithms,greedy" "Iahub is playing an uncommon game. Initially, he has n boxes, numbered 1, 2, 3, ..., n. Each box has some number of candies in it, described by a sequence a1, a2, ..., an. The number ak represents the number of candies in box k. The goal of the game is to move all candies into exactly two boxes. The rest of n\xe2\x80\x89-\xe2\x80\x892 boxes must contain zero candies. Iahub is allowed to do several (possible zero) moves. At each move he chooses two different boxes i and j, such that ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj. Then, Iahub moves from box j to box i exactly ai candies. Obviously, when two boxes have equal number of candies, box number j becomes empty.Your task is to give him a set of moves such as Iahub to archive the goal of the game. If Iahub can\'t win the game for the given configuration of boxes, output -1. Please note that in case there exist a solution, you don\'t need to print the solution using minimal number of moves." 3000.0     
                                           339D "Xenia and Bit Operations" "data structures,trees" "Xenia the beginner programmer has a sequence a, consisting of 2n non-negative integers: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89a2n. Xenia is currently studying bit operations. To better understand how they work, Xenia decided to calculate some value v for a.Namely, it takes several iterations to calculate value v. At the first iteration, Xenia writes a new sequence a1 or a2,\xe2\x80\x89a3 or a4,\xe2\x80\x89...,\xe2\x80\x89a2n\xe2\x80\x89-\xe2\x80\x891 or a2n, consisting of 2n\xe2\x80\x89-\xe2\x80\x891 elements. In other words, she writes down the bit-wise OR of adjacent elements of sequence a. At the second iteration, Xenia writes the bitwise exclusive OR of adjacent elements of the sequence obtained after the first iteration. At the third iteration Xenia writes the bitwise OR of the adjacent elements of the sequence obtained after the second iteration. And so on; the operations of bitwise exclusive OR and bitwise OR alternate. In the end, she obtains a sequence consisting of one element, and that element is v.Let\'s consider an example. Suppose that sequence a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894). Then let\'s write down all the transformations (1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (1 or 2\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x893 or 4\xe2\x80\x89=\xe2\x80\x897) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (3 xor 7\xe2\x80\x89=\xe2\x80\x894). The result is v\xe2\x80\x89=\xe2\x80\x894.You are given Xenia\'s initial sequence. But to calculate value v for a given sequence would be too easy, so you are given additional m queries. Each query is a pair of integers p,\xe2\x80\x89b. Query p,\xe2\x80\x89b means that you need to perform the assignment ap\xe2\x80\x89=\xe2\x80\x89b. After each query, you need to print the new value v for the new sequence a." 1700.0     
                                           338E Optimize! "data structures" "Manao is solving a problem with the following statement:  He came up with a solution that produces the correct answers but is too slow. You are given the pseudocode of his solution, where the function getAnswer calculates the answer to the problem:getAnswer(a[1..n], b[1..len], h)  answer = 0  for i = 1 to n-len+1    answer = answer + f(a[i..i+len-1], b, h, 1)  return answerf(s[1..len], b[1..len], h, index)  if index = len+1 then    return 1  for i = 1 to len    if s[index] + b[i] >= h      mem = b[i]      b[i] = 0      res = f(s, b, h, index + 1)      b[i] = mem      if res > 0        return 1  return 0Your task is to help Manao optimize his algorithm." 2600.0     
                                           337B "Routine Problem" "greedy,math,number theory" "Manao has a monitor. The screen of the monitor has horizontal to vertical length ratio a:b. Now he is going to watch a movie. The movie\'s frame has horizontal to vertical length ratio c:d. Manao adjusts the view in such a way that the movie preserves the original frame ratio, but also occupies as much space on the screen as possible and fits within it completely. Thus, he may have to zoom the movie in or out, but Manao will always change the frame proportionally in both dimensions.Calculate the ratio of empty screen (the part of the screen not occupied by the movie) to the total screen size. Print the answer as an irreducible fraction p\xe2\x80\x89/\xe2\x80\x89q." 1400.0     
                                           335D "Rectangles and Square" "brute force,dp" "You are given n rectangles, labeled 1 through n. The corners of rectangles have integer coordinates and their edges are parallel to the Ox and Oy axes. The rectangles may touch each other, but they do not overlap (that is, there are no points that belong to the interior of more than one rectangle).Your task is to determine if there\'s a non-empty subset of the rectangles that forms a square. That is, determine if there exists a subset of the rectangles and some square for which every point that belongs to the interior or the border of that square belongs to the interior or the border of at least one of the rectangles in the subset, and every point that belongs to the interior or the border of at least one rectangle in the subset belongs to the interior or the border of that square." 2400.0     
                                           332D "Theft of Blueprints" graphs,math "Insurgents accidentally got hold of the plan of a top secret research polygon created on a distant planet for the needs of the Galaxy Empire. The insurgents suppose that this polygon is developing new deadly weapon. The polygon consists of n missile silos connected by bidirectional underground passages. The passages are linked to laboratories where research is conducted. Naturally, the passages are guarded severely: the passage between silos i and j is patrolled by ci,\xe2\x80\x89j war droids.The insurgents studied the polygon plan and noticed its unusual structure. As it turned out, for any k-element set of silos S there is exactly one silo that is directly connected by a passage with each silo from S (we\'ll call this silo adjacent with S). Having considered that, the insurgents decided to act as follows:  they choose a k-element set of silos S;  a group of scouts lands from the air into each silo from S;  each group moves along the corresponding passage to the silo, adjacent with S (as the scouts move, they check out the laboratories and watch for any signs of weapon blueprints);  in the silo, adjacent with S, the groups get on the ship and fly away. The danger of the operation is the total number of droids that patrol the passages through which the scouts will go. The danger of the operation obviously only depends on the way to choose set S. The insurgents haven\'t yet decided on the exact silos to send the scouts to. However, they already want to start preparing the weapons for the scout groups. To do that, the insurgents need to know the mathematical average of the dangers of the operations that correspond to all possible ways to choose set S. Solve this problem to help the insurgents protect the ideals of the Republic!" 2400.0     
                                           329C "Graph Reconstruction" "constructive algorithms" "I have an undirected graph consisting of n nodes, numbered 1 through n. Each node has at most two incident edges. For each pair of nodes, there is at most an edge connecting them. No edge connects a node to itself.I would like to create a new graph in such a way that:   The new graph consists of the same number of nodes and edges as the old graph.  The properties in the first paragraph still hold.  For each two nodes u and v, if there is an edge connecting them in the old graph, there is no edge connecting them in the new graph. Help me construct the new graph, or tell me if it is impossible." 2400.0     
                                           325A "Square and Rectangles" implementation "You are given n rectangles. The corners of rectangles have integer coordinates and their edges are parallel to the Ox and Oy axes. The rectangles may touch each other, but they do not overlap (that is, there are no points that belong to the interior of more than one rectangle). Your task is to determine if the rectangles form a square. In other words, determine if the set of points inside or on the border of at least one rectangle is precisely equal to the set of points inside or on the border of some square." 1500.0     
                                           322B "Ciel and Flowers" combinatorics,math "Fox Ciel has some flowers: r red flowers, g green flowers and b blue flowers. She wants to use these flowers to make several bouquets. There are 4 types of bouquets:  To make a ""red bouquet"", it needs 3 red flowers.  To make a ""green bouquet"", it needs 3 green flowers.  To make a ""blue bouquet"", it needs 3 blue flowers.  To make a ""mixing bouquet"", it needs 1 red, 1 green and 1 blue flower. Help Fox Ciel to find the maximal number of bouquets she can make." 1600.0     
                                           321E "Ciel and Gondolas" "data structures,divide and conquer,dp" "Fox Ciel is in the Amusement Park. And now she is in a queue in front of the Ferris wheel. There are n people (or foxes more precisely) in the queue: we use first people to refer one at the head of the queue, and n-th people to refer the last one in the queue.There will be k gondolas, and the way we allocate gondolas looks like this:  When the first gondolas come, the q1 people in head of the queue go into the gondolas.  Then when the second gondolas come, the q2 people in head of the remain queue go into the gondolas.    ... The remain qk people go into the last (k-th) gondolas. Note that q1, q2, ..., qk must be positive. You can get from the statement that  and qi\xe2\x80\x89>\xe2\x80\x890.You know, people don\'t want to stay with strangers in the gondolas, so your task is to find an optimal allocation way (that is find an optimal sequence q) to make people happy. For every pair of people i and j, there exists a value uij denotes a level of unfamiliar. You can assume uij\xe2\x80\x89=\xe2\x80\x89uji for all i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and uii\xe2\x80\x89=\xe2\x80\x890 for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Then an unfamiliar value of a gondolas is the sum of the levels of unfamiliar between any pair of people that is into the gondolas.A total unfamiliar value is the sum of unfamiliar values for all gondolas. Help Fox Ciel to find the minimal possible total unfamiliar value for some optimal allocation." 2600.0     
                                           319C "Kalila and Dimna in the Logging Industry" dp,geometry "Kalila and Dimna are two jackals living in a huge jungle. One day they decided to join a logging factory in order to make money. The manager of logging factory wants them to go to the jungle and cut n trees with heights a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. They bought a chain saw from a shop. Each time they use the chain saw on the tree number i, they can decrease the height of this tree by one unit. Each time that Kalila and Dimna use the chain saw, they need to recharge it. Cost of charging depends on the id of the trees which have been cut completely (a tree is cut completely if its height equal to 0). If the maximum id of a tree which has been cut completely is i (the tree that have height ai in the beginning), then the cost of charging the chain saw would be bi. If no tree is cut completely, Kalila and Dimna cannot charge the chain saw. The chainsaw is charged in the beginning. We know that for each i < j, ai\xe2\x80\x89<\xe2\x80\x89aj and bi\xe2\x80\x89>\xe2\x80\x89bj and also bn\xe2\x80\x89=\xe2\x80\x890 and a1\xe2\x80\x89=\xe2\x80\x891. Kalila and Dimna want to cut all the trees completely, with minimum cost. They want you to help them! Will you?" 2100.0     
                                           317E "Princess and Her Shadow" "constructive algorithms,shortest paths" "Princess Vlada enjoys springing in the meadows and walking in the forest. One day \xe2\x80\x94 wonderful, sunny day \xe2\x80\x94 during her walk Princess found out with astonishment that her shadow was missing! ""Blimey!"", \xe2\x80\x94 she thought and started her search of the shadow in the forest.Normally the Shadow is too lazy and simply sleeps under the Princess. But at this terrifically hot summer day she got bored of such a dull life, so she decided to play with Vlada.The forest, where our characters entertain themselves, may be represented as a set of integer cells in the plane, where the Shadow and the Princess can move only up, down, left and right by 1. Some cells (as it happens in decent forests) are occupied by trees. The Shadow and the Princess are not allowed to enter a cell occupied by a tree. Unfortunately, these are the hard times for the forest, so there are very few trees growing here...At first the Princess was walking within the cell (vx, vy), while the Shadow hid from the Princess in the cell (sx, sy). The Princess, The Shadow and the trees are located in the different cells.The Shadow is playing with the Princess. As soon as the Princess moves by 1 in some direction, the Shadow simultaneously flies by 1 in the same direction, if it is possible (if the cell to fly to is not occupied by some tree); otherwise, the Shadow doesn\'t move. The Shadow is very shadowy, so our characters do not interfere with each other.We say that the Shadow is caught by the Princess if after some move both of them are located in the same cell. Vlada managed to catch her Shadow! Can you?" 3100.0     
                                           317A "Perfect Pair" "brute force" "Let us call a pair of integer numbers m-perfect, if at least one number in the pair is greater than or equal to m. Thus, the pairs (3, 3) and (0, 2) are 2-perfect while the pair (-1, 1) is not.Two integers x, y are written on the blackboard. It is allowed to erase one of them and replace it with the sum of the numbers, (x\xe2\x80\x89+\xe2\x80\x89y).What is the minimum number of such operations one has to perform in order to make the given pair of integers m-perfect?" 1600.0     
                                           316G1 "Good Substrings" hashing,strings "Smart Beaver recently got interested in a new word game. The point is as follows: count the number of distinct good substrings of some string s. To determine if a string is good or not the game uses rules. Overall there are n rules. Each rule is described by a group of three (p,\xe2\x80\x89l,\xe2\x80\x89r), where p is a string and l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are integers. We\xe2\x80\x99ll say that string t complies with rule (p,\xe2\x80\x89l,\xe2\x80\x89r), if the number of occurrences of string t in string p lies between l and r, inclusive. For example, string ""ab"", complies with rules (""ab"", 1, 2) and (""aab"", 0, 1), but does not comply with rules (""cd"", 1, 2) and (""abab"", 0, 1).A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (|s| is a length of s) is string slsl\xe2\x80\x89+\xe2\x80\x891... sr.Consider a number of occurrences  of string t in string p as a number of pairs of integers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|) such that p[l... r]\xe2\x80\x89=\xe2\x80\x89t.We\xe2\x80\x99ll say that string t is good if it complies with all n rules. Smart Beaver asks you to help him to write a program that can calculate the number of distinct good substrings of string s. Two substrings s[x... y] and s[z... w] are cosidered to be distinct iff s[x... y]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s[z... w]." 1700.0     
                                           316E2 "Summer Homework" "data structures,math" "By the age of three Smart Beaver mastered all arithmetic operations and got this summer homework from the amazed teacher:You are given a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to perform on it m consecutive operations of the following type:  For given numbers xi and vi assign value vi to element axi.  For given numbers li and ri you\'ve got to calculate sum , where f0\xe2\x80\x89=\xe2\x80\x89f1\xe2\x80\x89=\xe2\x80\x891 and at i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892: fi\xe2\x80\x89=\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x892.  For a group of three numbers li ri di you should increase value ax by di for all x (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri). Smart Beaver planned a tour around great Canadian lakes, so he asked you to help him solve the given problem." 2300.0     
                                           314C "Sereja and Subsequences" "data structures,dp" "Sereja has a sequence that consists of n positive integers, a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. First Sereja took a piece of squared paper and wrote all distinct non-empty non-decreasing subsequences of sequence a. Then for each sequence written on the squared paper, Sereja wrote on a piece of lines paper all sequences that do not exceed it.A sequence of positive integers x\xe2\x80\x89=\xe2\x80\x89x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xr doesn\'t exceed a sequence of positive integers y\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yr, if the following inequation holds: x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89xr\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yr.Now Sereja wonders, how many sequences are written on the lines piece of paper. Help Sereja, find the required quantity modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000.0     
                                           313B "Ilya and Queries" dp,implementation "Ilya the Lion wants to help all his friends with passing exams. They need to solve the following problem to pass the IT exam.You\'ve got string s\xe2\x80\x89=\xe2\x80\x89s1s2... sn (n is the length of the string), consisting only of characters ""."" and ""#"" and m queries. Each query is described by a pair of integers li,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89<\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The answer to the query li,\xe2\x80\x89ri is the number of such integers i (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89ri), that si\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x891.Ilya the Lion wants to help his friends but is there anyone to help him? Help Ilya, solve the problem." 1100.0     
                                           313A "Ilya and Bank Account" "implementation,number theory" "Ilya is a very clever lion, he lives in an unusual city ZooVille. In this city all the animals have their rights and obligations. Moreover, they even have their own bank accounts. The state of a bank account is an integer. The state of a bank account can be a negative number. This means that the owner of the account owes the bank money.Ilya the Lion has recently had a birthday, so he got a lot of gifts. One of them (the gift of the main ZooVille bank) is the opportunity to delete the last digit or the digit before last from the state of his bank account no more than once. For example, if the state of Ilya\'s bank account is -123, then Ilya can delete the last digit and get his account balance equal to -12, also he can remove its digit before last and get the account balance equal to -13. Of course, Ilya is permitted not to use the opportunity to delete a digit from the balance.Ilya is not very good at math, and that\'s why he asks you to help him maximize his bank account. Find the maximum state of the bank account that can be obtained using the bank\'s gift." 900.0     
                                           311C "Fetch the Treasure" "brute force,data structures,graphs,shortest paths" "Rainbow built h cells in a row that are numbered from 1 to h from left to right. There are n cells with treasure. We call each of these n cells ""Treasure Cell"". The i-th ""Treasure Cell"" is the ai-th cell and the value of treasure in it is ci dollars.Then, Freda went in the first cell. For now, she can go just k cells forward, or return to the first cell. That means Freda was able to reach the 1st, (k\xe2\x80\x89+\xe2\x80\x891)-th, (2\xc2\xb7k\xe2\x80\x89+\xe2\x80\x891)-th, (3\xc2\xb7k\xe2\x80\x89+\xe2\x80\x891)-th cells and so on.Then Rainbow gave Freda m operations. Each operation is one of the following three types:  Add another method x: she can also go just x cells forward at any moment. For example, initially she has only one method k. If at some moment she has methods a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ar then she can reach all the cells with number in form , where vi \xe2\x80\x94 some non-negative integer.  Reduce the value of the treasure in the x-th ""Treasure Cell"" by y dollars. In other words, to apply assignment cx\xe2\x80\x89=\xe2\x80\x89cx\xe2\x80\x89-\xe2\x80\x89y.  Ask the value of the most valuable treasure among the cells Freda can reach. If Freda cannot reach any cell with the treasure then consider the value of the most valuable treasure equal to 0, and do nothing. Otherwise take the most valuable treasure away. If several ""Treasure Cells"" have the most valuable treasure, take the ""Treasure Cell"" with the minimum number (not necessarily with the minimum number of cell). After that the total number of cells with a treasure is decreased by one. As a programmer, you are asked by Freda to write a program to answer each query." 2500.0     
                                           311B "Cats Transport" "data structures,dp" "Zxr960115 is owner of a large farm. He feeds m cute cats and employs p feeders. There\'s a straight road across the farm and n hills along the road, numbered from 1 to n from left to right. The distance between hill i and (i\xe2\x80\x89-\xe2\x80\x891) is di meters. The feeders live in hill 1.One day, the cats went out to play. Cat i went on a trip to hill hi, finished its trip at time ti, and then waited at hill hi for a feeder. The feeders must take all the cats. Each feeder goes straightly from hill 1 to n without waiting at a hill and takes all the waiting cats at each hill away. Feeders walk at a speed of 1 meter per unit time and are strong enough to take as many cats as they want.For example, suppose we have two hills (d2\xe2\x80\x89=\xe2\x80\x891) and one cat that finished its trip at time 3 at hill 2 (h1\xe2\x80\x89=\xe2\x80\x892). Then if the feeder leaves hill 1 at time 2 or at time 3, he can take this cat, but if he leaves hill 1 at time 1 he can\'t take it. If the feeder leaves hill 1 at time 2, the cat waits him for 0 time units, if the feeder leaves hill 1 at time 3, the cat waits him for 1 time units.Your task is to schedule the time leaving from hill 1 for each feeder so that the sum of the waiting time of all cats is minimized." 2400.0     
                                           296B "Yaroslav and Two Strings" combinatorics,dp "Yaroslav thinks that two strings s and w, consisting of digits and having length n are non-comparable if there are two numbers, i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that si\xe2\x80\x89>\xe2\x80\x89wi and sj\xe2\x80\x89<\xe2\x80\x89wj. Here sign si represents the i-th digit of string s, similarly, wj represents the j-th digit of string w.A string\'s template is a string that consists of digits and question marks (""?"").Yaroslav has two string templates, each of them has length n. Yaroslav wants to count the number of ways to replace all question marks by some integers in both templates, so as to make the resulting strings incomparable. Note that the obtained strings can contain leading zeroes and that distinct question marks can be replaced by distinct or the same integers.Help Yaroslav, calculate the remainder after dividing the described number of ways by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000.0     
                                           293A "Weird Game" games,greedy "Yaroslav, Andrey and Roman can play cubes for hours and hours. But the game is for three, so when Roman doesn\'t show up, Yaroslav and Andrey play another game. Roman leaves a word for each of them. Each word consists of 2\xc2\xb7n binary characters ""0"" or ""1"". After that the players start moving in turns. Yaroslav moves first. During a move, a player must choose an integer from 1 to 2\xc2\xb7n, which hasn\'t been chosen by anybody up to that moment. Then the player takes a piece of paper and writes out the corresponding character from his string. Let\'s represent Yaroslav\'s word as s\xe2\x80\x89=\xe2\x80\x89s1s2... s2n. Similarly, let\'s represent Andrey\'s word as t\xe2\x80\x89=\xe2\x80\x89t1t2... t2n. Then, if Yaroslav choose number k during his move, then he is going to write out character sk on the piece of paper. Similarly, if Andrey choose number r during his move, then he is going to write out character tr on the piece of paper.The game finishes when no player can make a move. After the game is over, Yaroslav makes some integer from the characters written on his piece of paper (Yaroslav can arrange these characters as he wants). Andrey does the same. The resulting numbers can contain leading zeroes. The person with the largest number wins. If the numbers are equal, the game ends with a draw.You are given two strings s and t. Determine the outcome of the game provided that Yaroslav and Andrey play optimally well." 1500.0     
                                           291E "Tree-String Problem" "*special problem,dfs and similar,hashing,strings" "A rooted tree is a non-directed connected graph without any cycles with a distinguished vertex, which is called the tree root. Consider the vertices of a rooted tree, that consists of n vertices, numbered from 1 to n. In this problem the tree root is the vertex number 1.Let\'s represent the length of the shortest by the number of edges path in the tree between vertices v and u as d(v,\xe2\x80\x89u).A parent of vertex v in the rooted tree with the root in vertex r (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89r) is vertex pv, such that d(r,\xe2\x80\x89pv)\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89d(r,\xe2\x80\x89v) and d(pv,\xe2\x80\x89v)\xe2\x80\x89=\xe2\x80\x891. For example, on the picture the parent of vertex v\xe2\x80\x89=\xe2\x80\x895 is vertex p5\xe2\x80\x89=\xe2\x80\x892.One day Polycarpus came across a rooted tree, consisting of n vertices. The tree wasn\'t exactly ordinary: it had strings written on its edges. Polycarpus positioned the tree on the plane so as to make all edges lead from top to bottom if you go from the vertex parent to the vertex (see the picture). For any edge that lead from vertex pv to vertex v (1\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), he knows string sv that is written on it. All strings are written on the edges from top to bottom. For example, on the picture s7=""ba"". The characters in the strings are numbered starting from 0.  An example of Polycarpus\'s tree (corresponds to the example from the statement) Polycarpus defines the position in this tree as a specific letter on a specific string. The position is written as a pair of integers (v,\xe2\x80\x89x) that means that the position is the x-th letter of the string sv (1\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89|sv|), where |sv| is the length of string sv. For example, the highlighted letters are positions (2,\xe2\x80\x891) and (3,\xe2\x80\x891).Let\'s consider the pair of positions (v,\xe2\x80\x89x) and (u,\xe2\x80\x89y) in Polycarpus\' tree, such that the way from the first position to the second goes down on each step. We will consider that the pair of such positions defines string z. String z consists of all letters on the way from (v,\xe2\x80\x89x) to (u,\xe2\x80\x89y), written in the order of this path. For example, in the picture the highlighted positions define string ""bacaba"".Polycarpus has a string t, he wants to know the number of pairs of positions that define string t. Note that the way from the first position to the second in the pair must go down everywhere. Help him with this challenging tree-string problem!" 2000.0     
                                           289B "Polo the Penguin and Matrix" "brute force,dp,implementation,sortings,ternary search" "Little penguin Polo has an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix, consisting of integers. Let\'s index the matrix rows from 1 to n from top to bottom and let\'s index the columns from 1 to m from left to right. Let\'s represent the matrix element on the intersection of row i and column j as aij.In one move the penguin can add or subtract number d from some matrix element. Find the minimum number of moves needed to make all matrix elements equal. If the described plan is impossible to carry out, say so." 1400.0     
                                           288B "Polo the Penguin and Houses" combinatorics "Little penguin Polo loves his home village. The village has n houses, indexed by integers from 1 to n. Each house has a plaque containing an integer, the i-th house has a plaque containing integer pi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).Little penguin Polo loves walking around this village. The walk looks like that. First he stands by a house number x. Then he goes to the house whose number is written on the plaque of house x (that is, to house px), then he goes to the house whose number is written on the plaque of house px (that is, to house ppx), and so on.We know that:  When the penguin starts walking from any house indexed from 1 to k, inclusive, he can walk to house number 1.  When the penguin starts walking from any house indexed from k\xe2\x80\x89+\xe2\x80\x891 to n, inclusive, he definitely cannot walk to house number 1.  When the penguin starts walking from house number 1, he can get back to house number 1 after some non-zero number of walks from a house to a house. You need to find the number of ways you may write the numbers on the houses\' plaques so as to fulfill the three above described conditions. Print the remainder after dividing this number by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1500.0     
                                           286D Tourists "data structures,sortings" "A double tourist path, located at a park in Ultima Thule, is working by the following principle:  We introduce the Cartesian coordinate system.  At some points of time there are two tourists going (for a walk) from points (\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890) and (1,\xe2\x80\x890) simultaneously. The first one is walking from (\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890), the second one is walking from (1,\xe2\x80\x890).  Both tourists in a pair move at the same speed 1 (distance unit per second), the first one moves along line x\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891, the second one moves along line x\xe2\x80\x89=\xe2\x80\x891, both of them are moving in the positive direction of the Oy axis.  At some points of time walls appear. Wall (li,\xe2\x80\x89ri) is a segment between points (0,\xe2\x80\x89li) and (0,\xe2\x80\x89ri). Each wall appears immediately. The Ultima Thule government wants to learn this for each pair of tourists that walk simultaneously: for how long (in seconds) will they not see each other? Two tourists don\'t see each other if the segment that connects their positions on the plane intersects at least one wall. Two segments intersect if they share at least one point. We assume that the segments\' ends belong to the segments.Help the government count the required time. Note that the walls can intersect (in any way) or coincide." 2600.0     
                                           286B Shifting implementation "John Doe has found the beautiful permutation formula.Let\'s take permutation p\xe2\x80\x89=\xe2\x80\x89p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. Let\'s define transformation f of this permutation: where k (k\xe2\x80\x89>\xe2\x80\x891) is an integer, the transformation parameter, r is such maximum integer that rk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. If rk\xe2\x80\x89=\xe2\x80\x89n, then elements prk\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89prk\xe2\x80\x89+\xe2\x80\x892 and so on are omitted. In other words, the described transformation of permutation p cyclically shifts to the left each consecutive block of length k and the last block with the length equal to the remainder after dividing n by k. John Doe thinks that permutation f(f( ... f(p\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n],\xe2\x80\x892) ... ,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891),\xe2\x80\x89n) is beautiful. Unfortunately, he cannot quickly find the beautiful permutation he\'s interested in. That\'s why he asked you to help him.Your task is to find a beautiful permutation for the given n. For clarifications, see the notes to the third sample." 2200.0     
                                           282A Bit++ implementation "The classic programming language of Bitland is Bit++. This language is so peculiar and complicated.The language is that peculiar as it has exactly one variable, called x. Also, there are two operations:  Operation ++ increases the value of variable x by 1.  Operation -- decreases the value of variable x by 1. A statement in language Bit++ is a sequence, consisting of exactly one operation and one variable x. The statement is written without spaces, that is, it can only contain characters ""+"", ""-"", ""X"". Executing a statement means applying the operation it contains.A programme in Bit++ is a sequence of statements, each of them needs to be executed. Executing a programme means executing all the statements it contains.You\'re given a programme in language Bit++. The initial value of x is 0. Execute the programme and find its final value (the value of the variable when this programme is executed)." 800.0     
                                           280B "Maximum Xor Secondary" "data structures,implementation,two pointers" "Bike loves looking for the second maximum element in the sequence. The second maximum element in the sequence of distinct numbers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk (k\xe2\x80\x89>\xe2\x80\x891) is such maximum element xj, that the following inequality holds: .The lucky number of the sequence of distinct positive integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk (k\xe2\x80\x89>\xe2\x80\x891) is the number that is equal to the bitwise excluding OR of the maximum element of the sequence and the second maximum element of the sequence.You\'ve got a sequence of distinct positive integers s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn (n\xe2\x80\x89>\xe2\x80\x891). Let\'s denote sequence sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr as s[l..r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Your task is to find the maximum number among all lucky numbers of sequences s[l..r].Note that as all numbers in sequence s are distinct, all the given definitions make sence." 1800.0     
                                           278B "New Problem" "brute force,strings" "Coming up with a new problem isn\'t as easy as many people think. Sometimes it is hard enough to name it. We\'ll consider a title original if it doesn\'t occur as a substring in any titles of recent Codeforces problems. You\'ve got the titles of n last problems \xe2\x80\x94 the strings, consisting of lowercase English letters. Your task is to find the shortest original title for the new problem. If there are multiple such titles, choose the lexicographically minimum one. Note, that title of the problem can\'t be an empty string.A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (where |s| is the length of string s) is string slsl\xe2\x80\x89+\xe2\x80\x891... sr.String x\xe2\x80\x89=\xe2\x80\x89x1x2... xp is lexicographically smaller than string y\xe2\x80\x89=\xe2\x80\x89y1y2... yq, if either p\xe2\x80\x89<\xe2\x80\x89q and x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xp\xe2\x80\x89=\xe2\x80\x89yp, or there exists such number r (r\xe2\x80\x89<\xe2\x80\x89p,\xe2\x80\x89r\xe2\x80\x89<\xe2\x80\x89q), that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xr\xe2\x80\x89=\xe2\x80\x89yr and xr\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89yr\xe2\x80\x89+\xe2\x80\x891. The string characters are compared by their ASCII codes." 1500.0     
                                           275A "Lights Out" implementation "Lenny is playing a game on a 3\xe2\x80\x89\xc3\x97\xe2\x80\x893 grid of lights. In the beginning of the game all lights are switched on. Pressing any of the lights will toggle it and all side-adjacent lights. The goal of the game is to switch all the lights off. We consider the toggling as follows: if the light was switched on then it will be switched off, if it was switched off then it will be switched on.Lenny has spent some time playing with the grid and by now he has pressed each light a certain number of times. Given the number of times each light is pressed, you have to print the current state of each light." 900.0     
                                           272E "Dima and Horses" "combinatorics,constructive algorithms,graphs" "Dima came to the horse land. There are n horses living in the land. Each horse in the horse land has several enemies (enmity is a symmetric relationship). The horse land isn\'t very hostile, so the number of enemies of each horse is at most 3.Right now the horse land is going through an election campaign. So the horses trusted Dima to split them into two parts. At that the horses want the following condition to hold: a horse shouldn\'t have more than one enemy in its party.Help Dima split the horses into parties. Note that one of the parties can turn out to be empty." 2200.0     
                                           272C "Dima and Staircase" "data structures,implementation" "Dima\'s got a staircase that consists of n stairs. The first stair is at height a1, the second one is at a2, the last one is at an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89an). Dima decided to play with the staircase, so he is throwing rectangular boxes at the staircase from above. The i-th box has width wi and height hi. Dima throws each box vertically down on the first wi stairs of the staircase, that is, the box covers stairs with numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89wi. Each thrown box flies vertically down until at least one of the two following events happen:  the bottom of the box touches the top of a stair;  the bottom of the box touches the top of a box, thrown earlier. We only consider touching of the horizontal sides of stairs and boxes, at that touching with the corners isn\'t taken into consideration. Specifically, that implies that a box with width wi cannot touch the stair number wi\xe2\x80\x89+\xe2\x80\x891.You are given the description of the staircase and the sequence in which Dima threw the boxes at it. For each box, determine how high the bottom of the box after landing will be. Consider a box to fall after the previous one lands." 1500.0     
                                           271D "Good Substrings" "data structures,strings" "You\'ve got string s, consisting of small English letters. Some of the English letters are good, the rest are bad.A substring s[l...r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89s1s2...s|s| (where |s| is the length of string s) is string \xe2\x80\x89slsl\xe2\x80\x89+\xe2\x80\x891...sr.The substring s[l...r] is good, if among the letters \xe2\x80\x89sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr there are at most k bad ones (look at the sample\'s explanation to understand it more clear).Your task is to find the number of distinct good substrings of the given string s. Two substrings s[x...y] and s[p...q] are considered distinct if their content is different, i.e. s[x...y]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s[p...q]." 1800.0     
                                           271C Secret "constructive algorithms,implementation" "The Greatest Secret Ever consists of n words, indexed by positive integers from 1 to n. The secret needs dividing between k Keepers (let\'s index them by positive integers from 1 to k), the i-th Keeper gets a non-empty set of words with numbers from the set Ui\xe2\x80\x89=\xe2\x80\x89(ui,\xe2\x80\x891,\xe2\x80\x89ui,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89ui,\xe2\x80\x89|Ui|). Here and below we\'ll presuppose that the set elements are written in the increasing order.We\'ll say that the secret is safe if the following conditions are hold:  for any two indexes i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) the intersection of sets Ui and Uj is an empty set;  the union of sets U1,\xe2\x80\x89U2,\xe2\x80\x89...,\xe2\x80\x89Uk is set (1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n);  in each set Ui, its elements ui,\xe2\x80\x891,\xe2\x80\x89ui,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89ui,\xe2\x80\x89|Ui| do not form an arithmetic progression (in particular, |Ui|\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x893 should hold). Let us remind you that the elements of set (u1,\xe2\x80\x89u2,\xe2\x80\x89...,\xe2\x80\x89us) form an arithmetic progression if there is such number d, that for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89s) fulfills ui\xe2\x80\x89+\xe2\x80\x89d\xe2\x80\x89=\xe2\x80\x89ui\xe2\x80\x89+\xe2\x80\x891. For example, the elements of sets (5), (1,\xe2\x80\x8910) and (1,\xe2\x80\x895,\xe2\x80\x899) form arithmetic progressions and the elements of sets (1,\xe2\x80\x892,\xe2\x80\x894) and (3,\xe2\x80\x896,\xe2\x80\x898) don\'t.Your task is to find any partition of the set of words into subsets U1,\xe2\x80\x89U2,\xe2\x80\x89...,\xe2\x80\x89Uk so that the secret is safe. Otherwise indicate that there\'s no such partition." 1500.0     
                                           271A "Beautiful Year" "brute force" "It seems like the year of 2013 came only yesterday. Do you know a curious fact? The year of 2013 is the first year after the old 1987 with only distinct digits.Now you are suggested to solve the following problem: given a year number, find the minimum year number which is strictly larger than the given one and has only distinct digits." 800.0     
                                           268C "Beautiful Sets of Points" "constructive algorithms,implementation" "Manao has invented a new mathematical term \xe2\x80\x94 a beautiful set of points. He calls a set of points on a plane beautiful if it meets the following conditions:  The coordinates of each point in the set are integers.  For any two points from the set, the distance between them is a non-integer. Consider all points (x,\xe2\x80\x89y) which satisfy the inequations: 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m; x\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89>\xe2\x80\x890. Choose their subset of maximum size such that it is also a beautiful set of points." 1500.0     
                                           266D BerDonalds "graphs,math,shortest paths" "BerDonalds, a well-known fast food restaurant, is going to open a cafe in Bertown. The important thing is to choose the new restaurant\'s location so that it would be easy to get there. The Bertown road system is represented by n junctions, connected by m bidirectional roads. For each road we know its length. We also know that we can get from any junction to any other one, moving along the roads.Your task is to find such location of the restaurant, that the shortest distance along the roads from the cafe to the farthest junction would be minimum. Note that the restaurant can be located not only on the junction, but at any point of any road." 2400.0     
                                           264D "Colorful Stones" "dp,two pointers" "There are two sequences of colorful stones. The color of each stone is one of red, green, or blue. You are given two strings s and t. The i-th (1-based) character of s represents the color of the i-th stone of the first sequence. Similarly, the i-th (1-based) character of t represents the color of the i-th stone of the second sequence. If the character is ""R"", ""G"", or ""B"", the color of the corresponding stone is red, green, or blue, respectively.Initially Squirrel Liss is standing on the first stone of the first sequence and Cat Vasya is standing on the first stone of the second sequence. You can perform the following instructions zero or more times.Each instruction is one of the three types: ""RED"", ""GREEN"", or ""BLUE"". After an instruction c, the animals standing on stones whose colors are c will move one stone forward. For example, if you perform an instruction \xc2\xabRED\xc2\xbb, the animals standing on red stones will move one stone forward. You are not allowed to perform instructions that lead some animals out of the sequences. In other words, if some animals are standing on the last stones, you can\'t perform the instructions of the colors of those stones.A pair of positions (position of Liss, position of Vasya) is called a state. A state is called reachable if the state is reachable by performing instructions zero or more times from the initial state (1, 1). Calculate the number of distinct reachable states." 2500.0     
                                           263E Rhombus "brute force,data structures,dp" "You\'ve got a table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. On the intersection of the i-th row (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and the j-th column (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) there is a non-negative integer ai,\xe2\x80\x89j. Besides, you\'ve got a non-negative integer k.Your task is to find such pair of integers (a,\xe2\x80\x89b) that meets these conditions:   k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891;  k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891;  let\'s denote the maximum of the function  among all integers x and y, that satisfy the inequalities k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 and k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891, as mval; for the required pair of numbers the following equation must hold f(a,\xe2\x80\x89b)\xe2\x80\x89=\xe2\x80\x89mval." 2500.0     
                                           263A "Beautiful Matrix" implementation "You\'ve got a 5\xe2\x80\x89\xc3\x97\xe2\x80\x895 matrix, consisting of 24 zeroes and a single number one. Let\'s index the matrix rows by numbers from 1 to 5 from top to bottom, let\'s index the matrix columns by numbers from 1 to 5 from left to right. In one move, you are allowed to apply one of the two following transformations to the matrix:  Swap two neighboring matrix rows, that is, rows with indexes i and i\xe2\x80\x89+\xe2\x80\x891 for some integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x895).  Swap two neighboring matrix columns, that is, columns with indexes j and j\xe2\x80\x89+\xe2\x80\x891 for some integer j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x895). You think that a matrix looks beautiful, if the single number one of the matrix is located in its middle (in the cell that is on the intersection of the third row and the third column). Count the minimum number of moves needed to make the matrix beautiful." 800.0     
                                           262B "Roma and Changing Signs" greedy "Roma works in a company that sells TVs. Now he has to prepare a report for the last year.Roma has got a list of the company\'s incomes. The list is a sequence that consists of n integers. The total income of the company is the sum of all integers in sequence. Roma decided to perform exactly k changes of signs of several numbers in the sequence. He can also change the sign of a number one, two or more times.The operation of changing a number\'s sign is the operation of multiplying this number by -1.Help Roma perform the changes so as to make the total income of the company (the sum of numbers in the resulting sequence) maximum. Note that Roma should perform exactly k changes." 1200.0     
                                           257B "Playing Cubes" games,greedy,implementation "Petya and Vasya decided to play a little. They found n red cubes and m blue cubes. The game goes like that: the players take turns to choose a cube of some color (red or blue) and put it in a line from left to right (overall the line will have n\xe2\x80\x89+\xe2\x80\x89m cubes). Petya moves first. Petya\'s task is to get as many pairs of neighbouring cubes of the same color as possible. Vasya\'s task is to get as many pairs of neighbouring cubes of different colors as possible. The number of Petya\'s points in the game is the number of pairs of neighboring cubes of the same color in the line, the number of Vasya\'s points in the game is the number of neighbouring cubes of the different color in the line. Your task is to calculate the score at the end of the game (Petya\'s and Vasya\'s points, correspondingly), if both boys are playing optimally well. To ""play optimally well"" first of all means to maximize the number of one\'s points, and second \xe2\x80\x94 to minimize the number of the opponent\'s points." 1300.0     
                                           254A "Cards with Numbers" "constructive algorithms,sortings" "Petya has got 2n cards, each card contains some integer. The numbers on the cards can be the same. Let\'s index all cards by consecutive integers from 1 to 2n. We\'ll denote the number that is written on a card with number i, as ai. In order to play one entertaining game with his friends, Petya needs to split the cards into pairs so that each pair had equal numbers on the cards. Help Petya do that." 1200.0     
                                           253D "Table with Letters - 2" "brute force,two pointers" "Vasya has recently started to learn English. Now he needs to remember how to write English letters. He isn\'t sure about some of them, so he decided to train a little.He found a sheet of squared paper and began writing arbitrary English letters there. In the end Vasya wrote n lines containing m characters each. Thus, he got a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table, each cell of the table contained some English letter. Let\'s number the table rows from top to bottom with integers from 1 to n, and columns \xe2\x80\x94 from left to right with integers from 1 to m.After that Vasya looked at the resulting rectangular table and wondered, how many subtables are there, that matches both following conditions:  the subtable contains at most k cells with ""a"" letter;  all letters, located in all four corner cells of the subtable, are equal.  Formally, a subtable\'s definition is as follows. It is defined by four integers x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2 such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1\xe2\x80\x89<\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1\xe2\x80\x89<\xe2\x80\x89y2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. Then the subtable contains all such cells (x,\xe2\x80\x89y) (x is the row number, y is the column number), for which the following inequality holds x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2,\xe2\x80\x89y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2. The corner cells of the table are cells (x1,\xe2\x80\x89y1), (x1,\xe2\x80\x89y2), (x2,\xe2\x80\x89y1), (x2,\xe2\x80\x89y2).Vasya is already too tired after he\'s been writing letters to a piece of paper. That\'s why he asks you to count the value he is interested in." 2000.0     
                                           249E "Endless Matrix" math "A Russian space traveller Alisa Selezneva, like any other schoolgirl of the late 21 century, is interested in science. She has recently visited the MIT (Moscow Institute of Time), where its chairman and the co-inventor of the time machine academician Petrov told her about the construction of a time machine.During the demonstration of the time machine performance Alisa noticed that the machine does not have high speed and the girl got interested in the reason for such disadvantage. As it turns out on closer examination, one of the problems that should be solved for the time machine isn\'t solved by an optimal algorithm. If you find a way to solve this problem optimally, the time machine will run faster and use less energy.A task that none of the staff can solve optimally is as follows. There exists a matrix a, which is filled by the following rule:The cells are consecutive positive integers, starting with one. Besides, ai,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89at,\xe2\x80\x89k (i,\xe2\x80\x89j,\xe2\x80\x89t,\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891), if:  max(i,\xe2\x80\x89j)\xe2\x80\x89<\xe2\x80\x89max(t,\xe2\x80\x89k);  max(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89max(t,\xe2\x80\x89k) and j\xe2\x80\x89<\xe2\x80\x89k;  max(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89max(t,\xe2\x80\x89k), j\xe2\x80\x89=\xe2\x80\x89k and i\xe2\x80\x89>\xe2\x80\x89t. So, after the first 36 numbers are inserted, matrix a will look as follows:  To solve the problem, you should learn to find rather quickly for the given values of x1,\xe2\x80\x89y1,\xe2\x80\x89x2 and y2 (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2,\xe2\x80\x89y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2) the meaning of expression:As the meaning of this expression can be large enough, it is sufficient to know only the last 10 digits of the sought value.So, no one in MTI can solve the given task. Alice was brave enough to use the time machine and travel the past to help you.Your task is to write a program that uses the given values x1,\xe2\x80\x89y1,\xe2\x80\x89x2 and y2 finds the last 10 digits of the given expression." 2600.0     
                                           249D "Donkey and Stars" "data structures,dp,geometry,math,sortings" "In the evenings Donkey would join Shrek to look at the stars. They would sit on a log, sipping tea and they would watch the starry sky. The sky hung above the roof, right behind the chimney. Shrek\'s stars were to the right of the chimney and the Donkey\'s stars were to the left. Most days the Donkey would just count the stars, so he knew that they are exactly n. This time he wanted a challenge. He imagined a coordinate system: he put the origin of the coordinates at the intersection of the roof and the chimney, directed the OX axis to the left along the roof and the OY axis \xe2\x80\x94 up along the chimney (see figure). The Donkey imagined two rays emanating from he origin of axes at angles \xce\xb11 and \xce\xb12 to the OX axis.  Now he chooses any star that lies strictly between these rays. After that he imagines more rays that emanate from this star at the same angles \xce\xb11 and \xce\xb12 to the OX axis and chooses another star that lies strictly between the new rays. He repeats the operation as long as there still are stars he can choose between the rays that emanate from a star.   As a result, the Donkey gets a chain of stars. He can consecutively get to each star if he acts by the given rules.Your task is to find the maximum number of stars m that the Donkey\'s chain can contain.Note that the chain must necessarily start in the point of the origin of the axes, that isn\'t taken into consideration while counting the number m of stars in the chain." 2700.0     
                                           248D "Sweets for Everyone!" "binary search,greedy,implementation" "For he knew every Who down in Whoville beneath, Was busy now, hanging a mistletoe wreath. ""And they\'re hanging their stockings!"" he snarled with a sneer, ""Tomorrow is Christmas! It\'s practically here!""Dr. Suess, How The Grinch Stole ChristmasChristmas celebrations are coming to Whoville. Cindy Lou Who and her parents Lou Lou Who and Betty Lou Who decided to give sweets to all people in their street. They decided to give the residents of each house on the street, one kilogram of sweets. So they need as many kilos of sweets as there are homes on their street.The street, where the Lou Who family lives can be represented as n consecutive sections of equal length. You can go from any section to a neighbouring one in one unit of time. Each of the sections is one of three types: an empty piece of land, a house or a shop. Cindy Lou and her family can buy sweets in a shop, but no more than one kilogram of sweets in one shop (the vendors care about the residents of Whoville not to overeat on sweets).After the Lou Who family leave their home, they will be on the first section of the road. To get to this section of the road, they also require one unit of time. We can assume that Cindy and her mom and dad can carry an unlimited number of kilograms of sweets. Every time they are on a house section, they can give a kilogram of sweets to the inhabitants of the house, or they can simply move to another section. If the family have already given sweets to the residents of a house, they can\'t do it again. Similarly, if they are on the shop section, they can either buy a kilo of sweets in it or skip this shop. If they\'ve bought a kilo of sweets in a shop, the seller of the shop remembered them and the won\'t sell them a single candy if they come again. The time to buy and give sweets can be neglected. The Lou Whos do not want the people of any house to remain without food.The Lou Whos want to spend no more than t time units of time to give out sweets, as they really want to have enough time to prepare for the Christmas celebration. In order to have time to give all the sweets, they may have to initially bring additional k kilos of sweets.Cindy Lou wants to know the minimum number of k kilos of sweets they need to take with them, to have time to give sweets to the residents of each house in their street.Your task is to write a program that will determine the minimum possible value of k." 2300.0     
                                           248C Robo-Footballer "binary search,geometry" "It\'s a beautiful April day and Wallace is playing football with his friends. But his friends do not know that Wallace actually stayed home with Gromit and sent them his robotic self instead. Robo-Wallace has several advantages over the other guys. For example, he can hit the ball directly to the specified point. And yet, the notion of a giveaway is foreign to him. The combination of these features makes the Robo-Wallace the perfect footballer \xe2\x80\x94 as soon as the ball gets to him, he can just aim and hit the goal. He followed this tactics in the first half of the match, but he hit the goal rarely. The opposing team has a very good goalkeeper who catches most of the balls that fly directly into the goal. But Robo-Wallace is a quick thinker, he realized that he can cheat the goalkeeper. After all, they are playing in a football box with solid walls. Robo-Wallace can kick the ball to the other side, then the goalkeeper will not try to catch the ball. Then, if the ball bounces off the wall and flies into the goal, the goal will at last be scored.Your task is to help Robo-Wallace to detect a spot on the wall of the football box, to which the robot should kick the ball, so that the ball bounces once and only once off this wall and goes straight to the goal. In the first half of the match Robo-Wallace got a ball in the head and was severely hit. As a result, some of the schemes have been damaged. Because of the damage, Robo-Wallace can only aim to his right wall (Robo-Wallace is standing with his face to the opposing team\'s goal).The football box is rectangular. Let\'s introduce a two-dimensional coordinate system so that point (0, 0) lies in the lower left corner of the field, if you look at the box above. Robo-Wallace is playing for the team, whose goal is to the right. It is an improvised football field, so the gate of Robo-Wallace\'s rivals may be not in the middle of the left wall.  In the given coordinate system you are given:   y1, y2 \xe2\x80\x94 the y-coordinates of the side pillars of the goalposts of robo-Wallace\'s opponents;  yw \xe2\x80\x94 the y-coordinate of the wall to which Robo-Wallace is aiming;  xb, yb \xe2\x80\x94 the coordinates of the ball\'s position when it is hit;  r \xe2\x80\x94 the radius of the ball. A goal is scored when the center of the ball crosses the OY axis in the given coordinate system between (0, y1) and (0, y2). The ball moves along a straight line. The ball\'s hit on the wall is perfectly elastic (the ball does not shrink from the hit), the angle of incidence equals the angle of reflection. If the ball bounces off the wall not to the goal, that is, if it hits the other wall or the goal post, then the opposing team catches the ball and Robo-Wallace starts looking for miscalculation and gets dysfunctional. Such an outcome, if possible, should be avoided. We assume that the ball touches an object, if the distance from the center of the ball to the object is no greater than the ball radius r." 2000.0     
                                           248B "Chilly Willy" "math,number theory" "Chilly Willy loves playing with numbers. He only knows prime numbers that are digits yet. These numbers are 2, 3, 5 and 7. But Willy grew rather bored of such numbers, so he came up with a few games that were connected with them.Chilly Willy wants to find the minimum number of length n, such that it is simultaneously divisible by all numbers Willy already knows (2, 3, 5 and 7). Help him with that.A number\'s length is the number of digits in its decimal representation without leading zeros." 1400.0     
                                           245F "Log Stream Analysis" "binary search,brute force,implementation,strings" "You\'ve got a list of program warning logs. Each record of a log stream is a string in this format:  ""2012-MM-DD HH:MM:SS:MESSAGE"" (without the quotes). String ""MESSAGE"" consists of spaces, uppercase and lowercase English letters and characters ""!"", ""."", "","", ""?"". String ""2012-MM-DD"" determines a correct date in the year of 2012. String ""HH:MM:SS"" determines a correct time in the 24 hour format.The described record of a log stream means that at a certain time the record has got some program warning (string ""MESSAGE"" contains the warning\'s description).Your task is to print the first moment of time, when the number of warnings for the last n seconds was not less than m." 2000.0     
                                           243E Matrix "data structures" "Let\'s consider an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square matrix, consisting of digits one and zero.We\'ll consider a matrix good, if it meets the following condition: in each row of the matrix all ones go in one group. That is, each row of the matrix looks like that 00...0011...1100...00 (or simply consists of zeroes if it has no ones).You are given matrix a of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n, consisting of zeroes and ones. Your task is to determine whether you can get a good matrix b from it by rearranging the columns or not." 3000.0     
                                           242E "XOR on Segment" "bitmasks,data structures" "You\'ve got an array a, consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You are allowed to perform two operations on this array:  Calculate the sum of current array elements on the segment [l,\xe2\x80\x89r], that is, count value al\xe2\x80\x89+\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ar.  Apply the xor operation with a given number x to each array element on the segment [l,\xe2\x80\x89r], that is, execute . This operation changes exactly r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 array elements. Expression  means applying bitwise xor operation to numbers x and y. The given operation exists in all modern programming languages, for example in language C++ and Java it is marked as ""^"", in Pascal \xe2\x80\x94 as ""xor"".You\'ve got a list of m operations of the indicated type. Your task is to perform all given operations, for each sum query you should print the result you get." 2000.0     
                                           241G "Challenging Balloons" "constructive algorithms" "Martha \xe2\x80\x94 as a professional problemsetter \xe2\x80\x94 proposed a problem for a world-class contest. This is the problem statement:Tomorrow is Nadia\'s birthday, and Bardia (her brother) is assigned to make the balloons ready!There are n balloons (initially empty) that are tied to a straight line on certain positions x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. Bardia inflates the balloons from left to right. As a result, i-th balloon gets bigger and bigger until its radius reaches the pressure endurance pi or it touches another previously-inflated balloon.  While Bardia was busy with the balloons, he wondered ""What will be the sum of radius of balloons after all of the balloons are inflated?"". Being a nerdy type of guy, he is now thinking about the problem instead of preparing his sister\'s birthday. Calculate the answer to Bardia\'s problem so that Nadia\'s birthday won\'t be balloon-less.Artha \xe2\x80\x94 Martha\'s student \xe2\x80\x94 claimed his solution got accepted. Martha (being his teacher for a long time!) knew he couldn\'t have solved the problem for real and thus thinks there is something wrong with the testcases. Artha isn\'t anyhow logical, which means there is no way for Martha to explain the wrong point in his algorithm. So, the only way is to find a testcase to prove him wrong!Artha\'s pseudo-code is shown below:  You should output a small testcase for the problem such that Artha\'s algorithm is incorrect. The algorithm\'s output is considered correct if it differs from the correct value by no more than 1." 1900.0     
                                           232B Table bitmasks,combinatorics,dp,math "John Doe has an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table. John Doe can paint points in some table cells, not more than one point in one table cell. John Doe wants to use such operations to make each square subtable of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n have exactly k points.John Doe wondered, how many distinct ways to fill the table with points are there, provided that the condition must hold. As this number can be rather large, John Doe asks to find its remainder after dividing by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).You should assume that John always paints a point exactly in the center of some cell. Two ways to fill a table are considered distinct, if there exists a table cell, that has a point in one way and doesn\'t have it in the other." 1900.0     
                                           231E Cactus "data structures,dfs and similar,dp,graphs,trees" "A connected undirected graph is called a vertex cactus, if each vertex of this graph belongs to at most one simple cycle.A simple cycle in a undirected graph is a sequence of distinct vertices v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vt (t\xe2\x80\x89>\xe2\x80\x892), such that for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89t) exists an edge between vertices vi and vi\xe2\x80\x89+\xe2\x80\x891, and also exists an edge between vertices v1 and vt.A simple path in a undirected graph is a sequence of not necessarily distinct vertices v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vt (t\xe2\x80\x89>\xe2\x80\x890), such that for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89t) exists an edge between vertices vi and vi\xe2\x80\x89+\xe2\x80\x891 and furthermore each edge occurs no more than once. We\'ll say that a simple path v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vt starts at vertex v1 and ends at vertex vt.You\'ve got a graph consisting of n vertices and m edges, that is a vertex cactus. Also, you\'ve got a list of k pairs of interesting vertices xi,\xe2\x80\x89yi, for which you want to know the following information \xe2\x80\x94 the number of distinct simple paths that start at vertex xi and end at vertex yi. We will consider two simple paths distinct if the sets of edges of the paths are distinct.For each pair of interesting vertices count the number of distinct simple paths between them. As this number can be rather large, you should calculate it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2100.0     
                                           231C "To Add or Not to Add" "binary search,sortings,two pointers" "A piece of paper contains an array of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to find a number that occurs the maximum number of times in this array.However, before looking for such number, you are allowed to perform not more than k following operations \xe2\x80\x94 choose an arbitrary element from the array and add 1 to it. In other words, you are allowed to increase some array element by 1 no more than k times (you are allowed to increase the same element of the array multiple times).Your task is to find the maximum number of occurrences of some number in the array after performing no more than k allowed operations. If there are several such numbers, your task is to find the minimum one." 1600.0     
                                           227B "Effective Approach" implementation "Once at a team training Vasya, Petya and Sasha got a problem on implementing linear search in an array.According to the boys, linear search works as follows. The array elements in a pre-selected order are in turn compared with the number that you need to find. Once you find the array element that is equal to the required one, the search ends. The efficiency of the algorithm is the number of performed comparisons. The fewer comparisons the linear search has made, the more effective it is.Vasya believes that a linear search would work better if it sequentially iterates through the elements, starting with the 1-st one (in this problem we consider the elements of the array indexed from 1 to n) and ending with the n-th one. And Petya says that Vasya is wrong: the search will need less comparisons if it sequentially iterates the elements starting from the n-th and ending with the 1-st one. Sasha argues that the two approaches are equivalent.To finally begin the task, the teammates decided to settle the debate and compare the two approaches on an example. For this, they took an array that is a permutation of integers from 1 to n, and generated m queries of the form: find element with value bi in the array. They want to calculate for both approaches how many comparisons in total the linear search will need to respond to all queries. If the first search needs fewer comparisons, then the winner of the dispute is Vasya. If the second one does, then the winner is Petya. If both approaches make the same number of comparisons, then Sasha\'s got the upper hand.But the problem is, linear search is too slow. That\'s why the boys aren\'t going to find out who is right before the end of the training, unless you come in here. Help them to determine who will win the dispute." 1100.0     
                                           226D "The table" "constructive algorithms,greedy" "Harry Potter has a difficult homework. Given a rectangular table, consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells. Each cell of the table contains the integer. Harry knows how to use two spells: the first spell change the sign of the integers in the selected row, the second \xe2\x80\x94 in the selected column. Harry\'s task is to make non-negative the sum of the numbers in each row and each column using these spells.Alone, the boy can not cope. Help the young magician!" 2100.0     
                                           223E "Planar Graph" flows,geometry,graphs "A graph is called planar, if it can be drawn in such a way that its edges intersect only at their vertexes.An articulation point is such a vertex of an undirected graph, that when removed increases the number of connected components of the graph.A bridge is such an edge of an undirected graph, that when removed increases the number of connected components of the graph.You\'ve got a connected undirected planar graph consisting of n vertexes, numbered from 1 to n, drawn on the plane. The graph has no bridges, articulation points, loops and multiple edges. You are also given q queries. Each query is a cycle in the graph. The query response is the number of graph vertexes, which (if you draw a graph and the cycle on the plane) are located either inside the cycle, or on it. Write a program that, given the graph and the queries, will answer each query." 3000.0     
                                           223D Spider geometry,graphs "A plane contains a not necessarily convex polygon without self-intersections, consisting of n vertexes, numbered from 1 to n. There is a spider sitting on the border of the polygon, the spider can move like that:  Transfer. The spider moves from the point p1 with coordinates (x1,\xe2\x80\x89y1), lying on the polygon border, to the point p2 with coordinates (x2,\xe2\x80\x89y2), also lying on the border. The spider can\'t go beyond the polygon border as it transfers, that is, the spider\'s path from point p1 to point p2 goes along the polygon border. It\'s up to the spider to choose the direction of walking round the polygon border (clockwise or counterclockwise).  Descend. The spider moves from point p1 with coordinates (x1,\xe2\x80\x89y1) to point p2 with coordinates (x2,\xe2\x80\x89y2), at that points p1 and p2 must lie on one vertical straight line (x1\xe2\x80\x89=\xe2\x80\x89x2), point p1 must be not lower than point p2 (y1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89y2) and segment p1p2 mustn\'t have points, located strictly outside the polygon (specifically, the segment can have common points with the border). Initially the spider is located at the polygon vertex with number s. Find the length of the shortest path to the vertex number t, consisting of transfers and descends. The distance is determined by the usual Euclidean metric ." 3000.0     
                                           222E "Decoding Genome" dp,matrices "Recently a top secret mission to Mars has taken place. As a result, scientists managed to obtain some information about the Martian DNA. Now we know that any Martian DNA contains at most m different nucleotides, numbered from 1 to m. Special characteristics of the Martian DNA prevent some nucleotide pairs from following consecutively in this chain. For example, if the nucleotide 1 and nucleotide 2 can not follow consecutively in the Martian DNA, then the chain of nucleotides [1, 2] is not a valid chain of Martian DNA, but the chain of nucleotides [2, 1] can be a valid chain (if there is no corresponding restriction). The number of nucleotide pairs that can\'t follow in the DNA chain consecutively, is k. The needs of gene research required information about the quantity of correct n-long chains of the Martian DNA. Your task is to write a program that will calculate this value." 1900.0     
                                           222B "Cosmic Tables" "data structures,implementation" "The Free Meteor Association (FMA) has got a problem: as meteors are moving, the Universal Cosmic Descriptive Humorous Program (UCDHP) needs to add a special module that would analyze this movement. UCDHP stores some secret information about meteors as an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table with integers in its cells. The order of meteors in the Universe is changing. That\'s why the main UCDHP module receives the following queries:  The query to swap two table rows;  The query to swap two table columns;  The query to obtain a secret number in a particular table cell. As the main UCDHP module is critical, writing the functional of working with the table has been commissioned to you." 1300.0     
                                           220D "Little Elephant and Triangle" geometry,math "The Little Elephant is playing with the Cartesian coordinates\' system. Most of all he likes playing with integer points. The Little Elephant defines an integer point as a pair of integers (x; y), such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89h. Thus, the Little Elephant knows only (w\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(h\xe2\x80\x89+\xe2\x80\x891) distinct integer points.The Little Elephant wants to paint a triangle with vertexes at integer points, the triangle\'s area must be a positive integer. For that, he needs to find the number of groups of three points that form such triangle. At that, the order of points in a group matters, that is, the group of three points (0;0), (0;2), (2;2) isn\'t equal to the group (0;2), (0;0), (2;2).Help the Little Elephant to find the number of groups of three integer points that form a nondegenerate triangle with integer area." 2500.0     
                                           217D "Bitonix\' Patrol" "bitmasks,brute force,combinatorics,dfs and similar,math" "Byteland is trying to send a space mission onto the Bit-X planet. Their task is complicated by the fact that the orbit of the planet is regularly patrolled by Captain Bitonix, the leader of the space forces of Bit-X.There are n stations around Bit-X numbered clockwise from 1 to n. The stations are evenly placed on a circular orbit, so the stations number i and i\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), and the stations number 1 and n, are neighboring. The distance between every pair of adjacent stations is equal to m space miles. To go on a patrol, Captain Bitonix jumps in his rocket at one of the stations and flies in a circle, covering a distance of at least one space mile, before finishing in some (perhaps the starting) station.Bitonix\' rocket moves by burning fuel tanks. After Bitonix attaches an x-liter fuel tank and chooses the direction (clockwise or counter-clockwise), the rocket flies exactly x space miles along a circular orbit in the chosen direction. Note that the rocket has no brakes; it is not possible for the rocket to stop before depleting a fuel tank.For example, assume that n\xe2\x80\x89=\xe2\x80\x893 and m\xe2\x80\x89=\xe2\x80\x8960 and Bitonix has fuel tanks with volumes of 10, 60, 90 and 100 liters. If Bitonix starts from station 1, uses the 100-liter fuel tank to go clockwise, then uses the 90-liter fuel tank to go clockwise, and then uses the 10-liter fuel tank to go counterclockwise, he will finish back at station 1. This constitutes a valid patrol. Note that Bitonix does not have to use all available fuel tanks. Another valid option for Bitonix in this example would be to simply use the 60-liter fuel tank to fly to either station 2 or 3.However, if n was equal to 3, m was equal to 60 and the only fuel tanks available to Bitonix were one 10-liter tank and one 100-liter tank, he would have no way of completing a valid patrol (he wouldn\'t be able to finish any patrol exactly at the station).The Byteland space agency wants to destroy some of Captain Bitonix\' fuel tanks so that he cannot to complete any valid patrol. Find how many different subsets of the tanks the agency can destroy to prevent Captain Bitonix from completing a patrol and output the answer modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2900.0     
                                           216C "Hiring Staff" greedy "A new Berland businessman Vitaly is going to open a household appliances\' store. All he\'s got to do now is to hire the staff.The store will work seven days a week, but not around the clock. Every day at least k people must work in the store.Berland has a law that determines the order of working days and non-working days. Namely, each employee must work for exactly n consecutive days, then rest for exactly m days, then work for n more days and rest for m more, and so on. Vitaly doesn\'t want to break the law. Fortunately, there is a loophole: the law comes into force on the day when the employee is hired. For example, if an employee is hired on day x, then he should work on days [x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891], [x\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x89n,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x89n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x892n\xe2\x80\x89-\xe2\x80\x891], and so on. Day x can be chosen arbitrarily by Vitaly.There is one more thing: the key to the store. Berland law prohibits making copies of keys, so there is only one key. Vitaly is planning to entrust the key to the store employees. At the same time on each day the key must be with an employee who works that day \xe2\x80\x94 otherwise on this day no one can get inside the store. During the day the key holder can give the key to another employee, if he also works that day. The key will handed to the first hired employee at his first working day.Each employee has to be paid salary. Therefore, Vitaly wants to hire as few employees as possible provided that the store can operate normally on each day from 1 to infinity. In other words, on each day with index from 1 to infinity, the store must have at least k working employees, and one of the working employees should have the key to the store.Help Vitaly and determine the minimum required number of employees, as well as days on which they should be hired." 1800.0     
                                           214B Hometask "brute force,constructive algorithms,greedy,math" "Furik loves math lessons very much, so he doesn\'t attend them, unlike Rubik. But now Furik wants to get a good mark for math. For that Ms. Ivanova, his math teacher, gave him a new task. Furik solved the task immediately. Can you?You are given a set of digits, your task is to find the maximum integer that you can make from these digits. The made number must be divisible by 2, 3, 5 without a residue. It is permitted to use not all digits from the set, it is forbidden to use leading zeroes.Each digit is allowed to occur in the number the same number of times it occurs in the set." 1600.0     
                                           208B Solitaire "dfs and similar,dp" "A boy named Vasya wants to play an old Russian solitaire called ""Accordion"". In this solitaire, the player must observe the following rules:  A deck of n cards is carefully shuffled, then all n cards are put on the table in a line from left to right;  Before each move the table has several piles of cards lying in a line (initially there are n piles, each pile has one card). Let\'s number the piles from left to right, from 1 to x. During one move, a player can take the whole pile with the maximum number x (that is the rightmost of remaining) and put it on the top of pile x\xe2\x80\x89-\xe2\x80\x891 (if it exists) or on the top of pile x\xe2\x80\x89-\xe2\x80\x893 (if it exists). The player can put one pile on top of another one only if the piles\' top cards have the same suits or values. Please note that if pile x goes on top of pile y, then the top card of pile x becomes the top card of the resulting pile. Also note that each move decreases the total number of piles by 1;  The solitaire is considered completed if all cards are in the same pile. Vasya has already shuffled the cards and put them on the table, help him understand whether completing this solitaire is possible or not." 1900.0     
                                           207D6 "The Beaver\'s Problem - 3"  "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 2100.0     
                                           207D1 "The Beaver\'s Problem - 3"  "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 1800.0     
                                           207C2 "Game with Two Trees"  "The Smart Beaver from ABBYY has come up with a new developing game for children. The Beaver thinks that this game will help children to understand programming better.The main object of the game is finite rooted trees, each of their edges contains some lowercase English letter. Vertices on any tree are always numbered sequentially from 1 to m, where m is the number of vertices in the tree. Before describing the actual game, let\'s introduce some definitions.We\'ll assume that the sequence of vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a forward path, if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is a direct ancestor of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all letters from the the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to forward path v1, v2, ..., vk.We\'ll assume that the sequence of tree vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a backward path if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is the direct descendant of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all the letters from the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to backward path v1, v2, ..., vk.Now let\'s describe the game that the Smart Beaver from ABBYY has come up with. The game uses two rooted trees, each of which initially consists of one vertex with number 1. The player is given some sequence of operations. Each operation is characterized by three values (t, v, c) where:   t is the number of the tree on which the operation is executed (1 or 2);  v is the vertex index in this tree (it is guaranteed that the tree contains a vertex with this index);  c is a lowercase English letter. The actual operation is as follows: vertex v of tree t gets a new descendant with number m\xe2\x80\x89+\xe2\x80\x891 (where m is the current number of vertices in tree t), and there should be letter c put on the new edge from vertex v to vertex m\xe2\x80\x89+\xe2\x80\x891.We\'ll say that an ordered group of three integers (i, j, q) is a good combination if:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m1, where m1 is the number of vertices in the first tree;  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j,\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m2, where m2 is the number of vertices in the second tree;  there exists a forward path v1, v2, ..., vk such that v1\xe2\x80\x89=\xe2\x80\x89j and vk\xe2\x80\x89=\xe2\x80\x89q in the second tree;  the string that corresponds to the forward path in the second tree from vertex j to vertex q equals the string that corresponds to the backward path in the first tree from vertex i to vertex 1 (note that both paths are determined uniquely). Your task is to calculate the number of existing good combinations after each operation on the trees." 2200.0     
                                           207A2 "Beaver\'s Calculator 1.0" greedy "The Smart Beaver from ABBYY has once again surprised us! He has developed a new calculating device, which he called the ""Beaver\'s Calculator 1.0"". It is very peculiar and it is planned to be used in a variety of scientific problems.To test it, the Smart Beaver invited n scientists, numbered from 1 to n. The i-th scientist brought ki calculating problems for the device developed by the Smart Beaver from ABBYY. The problems of the i-th scientist are numbered from 1 to ki, and they must be calculated sequentially in the described order, since calculating each problem heavily depends on the results of calculating of the previous ones.Each problem of each of the n scientists is described by one integer ai,\xe2\x80\x89j, where i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is the number of the scientist, j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ki) is the number of the problem, and ai,\xe2\x80\x89j is the number of resource units the calculating device needs to solve this problem.The calculating device that is developed by the Smart Beaver is pretty unusual. It solves problems sequentially, one after another. After some problem is solved and before the next one is considered, the calculating device allocates or frees resources.The most expensive operation for the calculating device is freeing resources, which works much slower than allocating them. It is therefore desirable that each next problem for the calculating device requires no less resources than the previous one.You are given the information about the problems the scientists offered for the testing. You need to arrange these problems in such an order that the number of adjacent ""bad"" pairs of problems in this list is minimum possible. We will call two consecutive problems in this list a ""bad pair"" if the problem that is performed first requires more resources than the one that goes after it. Do not forget that the problems of the same scientist must be solved in a fixed order." 1800.0     
                                           203E Transportation "greedy,sortings,two pointers" "Valera came to Japan and bought many robots for his research. He\'s already at the airport, the plane will fly very soon and Valera urgently needs to bring all robots to the luggage compartment.The robots are self-propelled (they can potentially move on their own), some of them even have compartments to carry other robots. More precisely, for the i-th robot we know value ci \xe2\x80\x94 the number of robots it can carry. In this case, each of ci transported robots can additionally carry other robots.However, the robots need to be filled with fuel to go, so Valera spent all his last money and bought S liters of fuel. He learned that each robot has a restriction on travel distances. Thus, in addition to features ci, the i-th robot has two features fi and li \xe2\x80\x94 the amount of fuel (in liters) needed to move the i-th robot, and the maximum distance that the robot can go.Due to the limited amount of time and fuel, Valera wants to move the maximum number of robots to the luggage compartment. He operates as follows.   First Valera selects some robots that will travel to the luggage compartment on their own. In this case the total amount of fuel required to move all these robots must not exceed S.  Then Valera seats the robots into the compartments, so as to transport as many robots as possible. Note that if a robot doesn\'t move by itself, you can put it in another not moving robot that is moved directly or indirectly by a moving robot.  After that all selected and seated robots along with Valera go to the luggage compartment and the rest robots will be lost. There are d meters to the luggage compartment. Therefore, the robots that will carry the rest, must have feature li of not less than d. During the moving Valera cannot stop or change the location of the robots in any way.Help Valera calculate the maximum number of robots that he will be able to take home, and the minimum amount of fuel he will have to spend, because the remaining fuel will come in handy in Valera\'s research." 2300.0     
                                           203A "Two Problems" "brute force,implementation" "A boy Valera registered on site Codeforces as Valera, and wrote his first Codeforces Round #300. He boasted to a friend Arkady about winning as much as x points for his first contest. But Arkady did not believe his friend\'s words and decided to check whether Valera could have shown such a result.He knows that the contest number 300 was unusual because there were only two problems. The contest lasted for t minutes, the minutes are numbered starting from zero. The first problem had the initial cost of a points, and every minute its cost reduced by da points. The second problem had the initial cost of b points, and every minute this cost reduced by db points. Thus, as soon as the zero minute of the contest is over, the first problem will cost a\xe2\x80\x89-\xe2\x80\x89da points, and the second problem will cost b\xe2\x80\x89-\xe2\x80\x89db points. It is guaranteed that at any moment of the contest each problem has a non-negative cost.Arkady asks you to find out whether Valera could have got exactly x points for this contest. You should assume that Valera could have solved any number of the offered problems. You should also assume that for each problem Valera made no more than one attempt, besides, he could have submitted both problems at the same minute of the contest, starting with minute 0 and ending with minute number t\xe2\x80\x89-\xe2\x80\x891. Please note that Valera can\'t submit a solution exactly t minutes after the start of the contest or later." 1200.0     
                                                200D "Programming Language" "binary search,brute force,expression parsing,implementation" "Recently, Valery have come across an entirely new programming language. Most of all the language attracted him with template functions and procedures. Let us remind you that templates are tools of a language, designed to encode generic algorithms, without reference to some parameters (e.g., data types, buffer sizes, default values).Valery decided to examine template procedures in this language in more detail. The description of a template procedure consists of the procedure name and the list of its parameter types. The generic type T parameters can be used as parameters of template procedures.A procedure call consists of a procedure name and a list of variable parameters. Let\'s call a procedure suitable for this call if the following conditions are fulfilled:   its name equals to the name of the called procedure;  the number of its parameters equals to the number of parameters of the procedure call;  the types of variables in the procedure call match the corresponding types of its parameters. The variable type matches the type of a parameter if the parameter has a generic type T or the type of the variable and the parameter are the same. You are given a description of some set of template procedures. You are also given a list of variables used in the program, as well as direct procedure calls that use the described variables. For each call you need to count the number of procedures that are suitable for this call." 1800.0
                                                198C "Delivering Carcinogen" "binary search,geometry" "Qwerty the Ranger arrived to the Diatar system with a very important task. He should deliver a special carcinogen for scientific research to planet Persephone. This is urgent, so Qwerty has to get to the planet as soon as possible. A lost day may fail negotiations as nobody is going to pay for an overdue carcinogen.You can consider Qwerty\'s ship, the planet Persephone and the star Diatar points on a plane. Diatar is located in the origin of coordinate axes \xe2\x80\x94 at point (0,\xe2\x80\x890). Persephone goes round Diatar along a circular orbit with radius R in the counter-clockwise direction at constant linear speed vp (thus, for instance, a full circle around the star takes  of time). At the initial moment of time Persephone is located at point (xp,\xe2\x80\x89yp).At the initial moment of time Qwerty\'s ship is at point (x,\xe2\x80\x89y). Qwerty can move in any direction at speed of at most v (v\xe2\x80\x89>\xe2\x80\x89vp). The star Diatar is hot (as all stars), so Qwerty can\'t get too close to it. The ship\'s metal sheathing melts at distance r (r\xe2\x80\x89<\xe2\x80\x89R) from the star.Find the minimum time Qwerty needs to get the carcinogen to planet Persephone." 2400.0
                                                198A "About Bacteria" implementation,math "Qwerty the Ranger took up a government job and arrived on planet Mars. He should stay in the secret lab and conduct some experiments on bacteria that have funny and abnormal properties. The job isn\'t difficult, but the salary is high.At the beginning of the first experiment there is a single bacterium in the test tube. Every second each bacterium in the test tube divides itself into k bacteria. After that some abnormal effects create b more bacteria in the test tube. Thus, if at the beginning of some second the test tube had x bacteria, then at the end of the second it will have kx\xe2\x80\x89+\xe2\x80\x89b bacteria.The experiment showed that after n seconds there were exactly z bacteria and the experiment ended at this point.For the second experiment Qwerty is going to sterilize the test tube and put there t bacteria. He hasn\'t started the experiment yet but he already wonders, how many seconds he will need to grow at least z bacteria. The ranger thinks that the bacteria will divide by the same rule as in the first experiment. Help Qwerty and find the minimum number of seconds needed to get a tube with at least z bacteria in the second experiment." 1700.0
                                                195C "Try and Catch" "expression parsing,implementation" "Vasya is developing his own programming language VPL (Vasya Programming Language). Right now he is busy making the system of exceptions. He thinks that the system of exceptions must function like that.The exceptions are processed by try-catch-blocks. There are two operators that work with the blocks: The try operator. It opens a new try-catch-block.  The catch(<exception_type>, <message>) operator. It closes the try-catch-block that was started last and haven\'t yet been closed. This block can be activated only via exception of type <exception_type>. When we activate this block, the screen displays the <message>. If at the given moment there is no open try-catch-block, then we can\'t use the catch operator.The exceptions can occur in the program in only one case: when we use the throw operator. The throw(<exception_type>) operator creates the exception of the given type.Let\'s suggest that as a result of using some throw operator the program created an exception of type a. In this case a try-catch-block is activated, such that this block\'s try operator was described in the program earlier than the used throw operator. Also, this block\'s catch operator was given an exception type a as a parameter and this block\'s catch operator is described later that the used throw operator. If there are several such try-catch-blocks, then the system activates the block whose catch operator occurs earlier than others. If no try-catch-block was activated, then the screen displays message ""Unhandled Exception"".To test the system, Vasya wrote a program that contains only try, catch and throw operators, one line contains no more than one operator, the whole program contains exactly one throw operator.Your task is: given a program in VPL, determine, what message will be displayed on the screen." 1800.0
                                                193D "Two Segments" "data structures" "Nick has some permutation consisting of p integers from 1 to n. A segment [l,\xe2\x80\x89r] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) is a set of elements pi satisfying l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r.Nick calls a pair of segments [a0,\xe2\x80\x89a1] and [b0,\xe2\x80\x89b1] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89<\xe2\x80\x89b0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) good if all their (a1\xe2\x80\x89-\xe2\x80\x89a0\xe2\x80\x89+\xe2\x80\x89b1\xe2\x80\x89-\xe2\x80\x89b0\xe2\x80\x89+\xe2\x80\x892) elements, when sorted in ascending order, form an arithmetic progression with a difference of 1. That is, when they sorted in ascending order, the elements are in the form {x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891}, for some x and m.Your task is to find the number of distinct pairs of good segments in the given permutation. Two pairs of segments are considered distinct if the sets of elements contained in these pairs of segments are distinct. For example, any segment [l,\xe2\x80\x89r] (l\xe2\x80\x89<\xe2\x80\x89r) can be represented as a pair of segments, as [l,\xe2\x80\x89i] and [i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89r] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). As all these pairs consist of the same set of elements, they are considered identical.See the notes accompanying the sample tests for clarification." 2900.0
                                                190E "Counter Attack" "data structures,dsu,graphs,hashing,sortings" "Berland has managed to repel the flatlanders\' attack and is now starting the counter attack.Flatland has n cities, numbered from 1 to n, and some pairs of them are connected by bidirectional roads. The Flatlandian maps show roads between cities if and only if there is in fact no road between this pair of cities (we do not know whether is it a clever spy-proof strategy or just saving ink). In other words, if two cities are connected by a road on a flatland map, then there is in fact no road between them. The opposite situation is also true: if two cities are not connected by a road on a flatland map, then in fact, there is a road between them.The berlanders got hold of a flatland map. Now Vasya the Corporal is commissioned by General Touristov to find all such groups of flatland cities, that in each group of cities you can get from any city to any other one, moving along the actual roads. Also the cities from different groups are unreachable from each other, moving along the actual roads. Indeed, destroying such groups one by one is much easier than surrounding all Flatland at once!Help the corporal complete this task and finally become a sergeant! Don\'t forget that a flatland map shows a road between cities if and only if there is in fact no road between them." 2100.0
                                                187E "Heaven Tour" "data structures,greedy" "The story was not finished as PMP thought. God offered him one more chance to reincarnate and come back to life. But before he can come back, God told him that PMP should ask n great men including prominent programmers about their life experiences.The men are standing on a straight line. They are numbered 1 through n from left to right. The coordinate of the i-th man is xi (xi\xe2\x80\x89<\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n). PMP should visit all these people one by one in arbitrary order. Each men should be visited exactly once. At the beginning of his tour, he starts at location of s-th man and asks him about his experiences.Each time PMP wants to change his location, he should give a ticket to an angel and the angel carries him to his destination. Angels take PMP from one location, fly to his destination and put him down there. Nobody else is visited in this movement. Moving from i-th man to j-th man, takes |xi\xe2\x80\x89-\xe2\x80\x89xj| time. PMP can get back to life as soon as he visits all men.There are two types of angels: Some angels are going to the right and they only accept right tickets. Others are going the left and they only accept left tickets. There are an unlimited number of angels of each type. PMP has l left tickets and n\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89l right tickets.PMP wants to get back to life as soon as possible to be able to compete in this year\'s final instead of the final he missed last year. He wants to know the quickest way to visit all the men exactly once. He also needs to know the exact sequence moves he should make." 2900.0
                                                185B "Mushroom Scientists" "math,ternary search" "As you very well know, the whole Universe traditionally uses three-dimensional Cartesian system of coordinates. In this system each point corresponds to three real coordinates (x,\xe2\x80\x89y,\xe2\x80\x89z). In this coordinate system, the distance between the center of the Universe and the point is calculated by the following formula: . Mushroom scientists that work for the Great Mushroom King think that the Universe isn\'t exactly right and the distance from the center of the Universe to a point equals xa\xc2\xb7yb\xc2\xb7zc.To test the metric of mushroom scientists, the usual scientists offered them a task: find such x,\xe2\x80\x89y,\xe2\x80\x89z (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y,\xe2\x80\x89z; x\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89z\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89S), that the distance between the center of the Universe and the point (x,\xe2\x80\x89y,\xe2\x80\x89z) is maximum possible in the metric of mushroom scientists. The mushroom scientists aren\'t good at maths, so they commissioned you to do the task.Note that in this problem, it is considered that 00\xe2\x80\x89=\xe2\x80\x891." 1800.0
                                                178F3 "Representative Sampling"  "The Smart Beaver from ABBYY has a long history of cooperating with the ""Institute of Cytology and Genetics"". Recently, the Institute staff challenged the Beaver with a new problem. The problem is as follows.There is a collection of n proteins (not necessarily distinct). Each protein is a string consisting of lowercase Latin letters. The problem that the scientists offered to the Beaver is to select a subcollection of size k from the initial collection of proteins so that the representativity of the selected subset of proteins is maximum possible.The Smart Beaver from ABBYY did some research and came to the conclusion that the representativity of a collection of proteins can be evaluated by a single number, which is simply calculated. Let\'s suppose we have a collection {a1,\xe2\x80\x89...,\xe2\x80\x89ak} consisting of k strings describing proteins. The representativity of this collection is the following value: where f(x,\xe2\x80\x89y) is the length of the longest common prefix of strings x and y; for example, f(""abc"", ""abd"")\xe2\x80\x89=\xe2\x80\x892, and f(""ab"", ""bcd"")\xe2\x80\x89=\xe2\x80\x890.Thus, the representativity of collection of proteins {""abc"", ""abd"", ""abe""} equals 6, and the representativity of collection {""aaa"", ""ba"", ""ba""} equals 2.Having discovered that, the Smart Beaver from ABBYY asked the Cup contestants to write a program that selects, from the given collection of proteins, a subcollection of size k which has the largest possible value of representativity. Help him to solve this problem!" 2500.0
                                                178B3 "Greedy Merchants"  "In ABBYY a wonderful Smart Beaver lives. This time, he began to study history. When he read about the Roman Empire, he became interested in the life of merchants.The Roman Empire consisted of n cities numbered from 1 to n. It also had m bidirectional roads numbered from 1 to m. Each road connected two different cities. Any two cities were connected by no more than one road.We say that there is a path between cities c1 and c2 if there exists a finite sequence of cities t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tp (p\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) such that:  t1\xe2\x80\x89=\xe2\x80\x89c1  tp\xe2\x80\x89=\xe2\x80\x89c2  for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89p), cities ti and ti\xe2\x80\x89+\xe2\x80\x891 are connected by a road We know that there existed a path between any two cities in the Roman Empire.In the Empire k merchants lived numbered from 1 to k. For each merchant we know a pair of numbers si and li, where si is the number of the city where this merchant\'s warehouse is, and li is the number of the city where his shop is. The shop and the warehouse could be located in different cities, so the merchants had to deliver goods from the warehouse to the shop.Let\'s call a road important for the merchant if its destruction threatens to ruin the merchant, that is, without this road there is no path from the merchant\'s warehouse to his shop. Merchants in the Roman Empire are very greedy, so each merchant pays a tax (1 dinar) only for those roads which are important for him. In other words, each merchant pays di dinars of tax, where di (di\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) is the number of roads important for the i-th merchant.The tax collection day came in the Empire. The Smart Beaver from ABBYY is very curious by nature, so he decided to count how many dinars each merchant had paid that day. And now he needs your help." 1800.0
                                                177B1 "Rectangular Game" "number theory" "The Smart Beaver from ABBYY decided to have a day off. But doing nothing the whole day turned out to be too boring, and he decided to play a game with pebbles. Initially, the Beaver has n pebbles. He arranges them in a equal rows, each row has b pebbles (a\xe2\x80\x89>\xe2\x80\x891). Note that the Beaver must use all the pebbles he has, i. e. n\xe2\x80\x89=\xe2\x80\x89a\xc2\xb7b.   10 pebbles are arranged in two rows, each row has 5 pebbles  Once the Smart Beaver has arranged the pebbles, he takes back any of the resulting rows (that is, b pebbles) and discards all other pebbles. Then he arranges all his pebbles again (possibly choosing other values of a and b) and takes back one row, and so on. The game continues until at some point the Beaver ends up with exactly one pebble. The game process can be represented as a finite sequence of integers c1,\xe2\x80\x89...,\xe2\x80\x89ck, where:   c1\xe2\x80\x89=\xe2\x80\x89n  ci\xe2\x80\x89+\xe2\x80\x891 is the number of pebbles that the Beaver ends up with after the i-th move, that is, the number of pebbles in a row after some arrangement of ci pebbles (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k). Note that ci\xe2\x80\x89>\xe2\x80\x89ci\xe2\x80\x89+\xe2\x80\x891.  ck\xe2\x80\x89=\xe2\x80\x891 The result of the game is the sum of numbers ci. You are given n. Find the maximum possible result of the game." 1000.0
                                                176B "Word Cut" dp "Let\'s consider one interesting word game. In this game you should transform one word into another through special operations. Let\'s say we have word w, let\'s split this word into two non-empty parts x and y so, that w\xe2\x80\x89=\xe2\x80\x89xy. A split operation is transforming word w\xe2\x80\x89=\xe2\x80\x89xy into word u\xe2\x80\x89=\xe2\x80\x89yx. For example, a split operation can transform word ""wordcut"" into word ""cutword"".You are given two words start and end. Count in how many ways we can transform word start into word end, if we apply exactly k split operations consecutively to word start. Two ways are considered different if the sequences of applied operations differ. Two operation sequences are different if exists such number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), that in the i-th operation of the first sequence the word splits into parts x and y, in the i-th operation of the second sequence the word splits into parts a and b, and additionally x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89a holds." 1700.0
                                                174C "Range Increments" "data structures,greedy" "Polycarpus is an amateur programmer. Now he is analyzing a friend\'s program. He has already found there the function rangeIncrement(l, r), that adds 1 to each element of some array a for all indexes in the segment [l,\xe2\x80\x89r]. In other words, this function does the following: function rangeIncrement(l, r)    for i := l .. r do        a[i] = a[i] + 1Polycarpus knows the state of the array a after a series of function calls. He wants to determine the minimum number of function calls that lead to such state. In addition, he wants to find what function calls are needed in this case. It is guaranteed that the required number of calls does not exceed 105.Before calls of function rangeIncrement(l, r) all array elements equal zero." 1800.0
                                                173D Deputies "constructive algorithms,graphs,greedy,implementation" "The Trinitarian kingdom has exactly n\xe2\x80\x89=\xe2\x80\x893k cities. All of them are located on the shores of river Trissisipi, which flows through the whole kingdom. Some of the cities are located on one side of the river, and all the rest are on the other side.Some cities are connected by bridges built between them. Each bridge connects two cities that are located on the opposite sides of the river. Between any two cities exists no more than one bridge.The recently inaugurated King Tristan the Third is busy distributing his deputies among cities. In total there are k deputies and the king wants to commission each of them to control exactly three cities. However, no deputy can be entrusted to manage the cities, which are connected by a bridge \xe2\x80\x94 the deputy can set a too high fee for travelling over the bridge to benefit his pocket, which is bad for the reputation of the king.Help King Tristan the Third distribute the deputies between the cities, if it is possible." 2500.0
                                                169B "Replacing Digits" greedy "You are given an integer a that consists of n digits. You are also given a sequence of digits s of length m. The digit in position j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) of sequence s means that you can choose an arbitrary position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) in a and replace the digit in the chosen position i with sj. Each element in the sequence s can participate in no more than one replacing operation.Your task is to perform such sequence of replacements, that the given number a gets maximum value. You are allowed to use not all elements from s." 1100.0
                                                169A Chores sortings "Petya and Vasya are brothers. Today is a special day for them as their parents left them home alone and commissioned them to do n chores. Each chore is characterized by a single parameter \xe2\x80\x94 its complexity. The complexity of the i-th chore equals hi.As Petya is older, he wants to take the chores with complexity larger than some value x (hi\xe2\x80\x89>\xe2\x80\x89x) to leave to Vasya the chores with complexity less than or equal to x (hi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x). The brothers have already decided that Petya will do exactly a chores and Vasya will do exactly b chores (a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89=\xe2\x80\x89n).In how many ways can they choose an integer x so that Petya got exactly a chores and Vasya got exactly b chores?" 800.0
                                                167D "Wizards and Roads" "data structures,divide and conquer,graph matchings,graphs,greedy" "In some country live wizards. They love to build cities and roads.The country used to have k cities, the j-th city (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) was located at a point (xj, yj). It was decided to create another n\xe2\x80\x89-\xe2\x80\x89k cities. And the i-th one (k\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) was created at a point with coordinates (xi, yi):  xi\xe2\x80\x89=\xe2\x80\x89(a\xc2\xb7xi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89b) mod (109\xe2\x80\x89+\xe2\x80\x899)  yi\xe2\x80\x89=\xe2\x80\x89(c\xc2\xb7yi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89d) mod (109\xe2\x80\x89+\xe2\x80\x899) Here a, b, c, d are primes. Also, a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89c,\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89d.After the construction of all n cities, the wizards have noticed something surprising. It turned out that for every two different cities i and j, xi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89xj and yi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89yj holds.The cities are built, it\'s time to build roads! It was decided to use the most difficult (and, of course, the most powerful) spell for the construction of roads. Using this spell creates a road between the towns of u, v (yu > yv) if and only if for any city w which lies strictly inside the corner at the point u, v (see below), there is a city s that does not lie in the corner, which is located along the x-coordinate strictly between w and u and simultaneously ys\xe2\x80\x89>\xe2\x80\x89yv.A corner on the points p2(x2, y2), p1(x1, y1) (y1\xe2\x80\x89<\xe2\x80\x89y2) is the set of points (x,\xe2\x80\x89y), for which at least one of the two conditions is fulfilled:   min(x1,\xe2\x80\x89x2)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89max(x1,\xe2\x80\x89x2) and y\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89y1  y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2 and (x\xe2\x80\x89-\xe2\x80\x89x2)\xc2\xb7(x1\xe2\x80\x89-\xe2\x80\x89x2)\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890    The pictures showing two different corners  In order to test the spell, the wizards will apply it to all the cities that lie on the x-coordinate in the interval [L,\xe2\x80\x89R]. After the construction of roads the national government wants to choose the maximum number of pairs of cities connected by the road, so that no city occurs in two or more pairs. Your task is for each m offered variants of values L, R to calculate the maximum number of such pairs after the construction of the roads. Please note that the cities that do not lie in the interval [L,\xe2\x80\x89R] on the x-coordinate, do not affect the construction of roads in any way." 3000.0
                                                164A "Variable, or There and Back Again" "dfs and similar,graphs" "Life is not easy for the perfectly common variable named Vasya. Wherever it goes, it is either assigned a value, or simply ignored, or is being used!Vasya\'s life goes in states of a program. In each state, Vasya can either be used (for example, to calculate the value of another variable), or be assigned a value, or ignored. Between some states are directed (oriented) transitions.A path is a sequence of states v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vx, where for any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89x exists a transition from vi to vi\xe2\x80\x89+\xe2\x80\x891.Vasya\'s value in state v is interesting to the world, if exists path p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk such, that pi\xe2\x80\x89=\xe2\x80\x89v for some i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), in state p1 Vasya gets assigned a value, in state pk Vasya is used and there is no state pi (except for p1) where Vasya gets assigned a value.Help Vasya, find the states in which Vasya\'s value is interesting to the world." 1700.0
                                                160E "Buses and People" "binary search,data structures,sortings" "The main Bertown street is represented by a straight line. There are 109 bus stops located on the line. The stops are numbered with integers from 1 to 109 in the order in which they follow on the road. The city has n buses. Every day the i-th bus drives from stop number si to stop number fi (si\xe2\x80\x89<\xe2\x80\x89fi), it stops on all intermediate stops and returns only at night. The bus starts driving at time ti and drives so fast that it finishes driving also at time ti. The time ti is different for all buses. The buses have infinite capacity.Bertown has m citizens. Today the i-th person should get from stop number li to stop number ri (li\xe2\x80\x89<\xe2\x80\x89ri); the i-th citizen comes to his initial stop (li) at time bi. Each person, on the one hand, wants to get to the destination point as quickly as possible, and on the other hand, definitely does not want to change the buses as he rides. More formally: the i-th person chooses bus j, with minimum time tj, such that sj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li, ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89fj and bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89tj. Your task is to determine for each citizen whether he can ride to the destination point today and if he can, find the number of the bus on which the citizen will ride." 2400.0
                                                159D "Palindrome pairs" "*special problem,brute force,dp,strings" "You are given a non-empty string s consisting of lowercase letters. Find the number of pairs of non-overlapping palindromic substrings of this string.In a more formal way, you have to find the quantity of tuples (a,\xe2\x80\x89b,\xe2\x80\x89x,\xe2\x80\x89y) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s| and substrings s[a... b], s[x... y] are palindromes.A palindrome is a string that can be read the same way from left to right and from right to left. For example, ""abacaba"", ""z"", ""abba"" are palindromes.A substring s[i... j] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s = s1s2... s|s| is a string sisi\xe2\x80\x89+\xe2\x80\x891... sj. For example, substring s[2...4] of string s = ""abacaba"" equals ""bac""." 1500.0
                                                159C "String Manipulation 1.0" "*special problem,binary search,brute force,data structures,strings" "One popular website developed an unusual username editing procedure. One can change the username only by deleting some characters from it: to change the current name s, a user can pick number p and character c and delete the p-th occurrence of character c from the name. After the user changed his name, he can\'t undo the change.For example, one can change name ""arca"" by removing the second occurrence of character ""a"" to get ""arc"". Polycarpus learned that some user initially registered under nickname t, where t is a concatenation of k copies of string s. Also, Polycarpus knows the sequence of this user\'s name changes. Help Polycarpus figure out the user\'s final name." 1400.0
                                                155B Combination greedy,sortings "Ilya plays a card game by the following rules.A player has several cards. Each card contains two non-negative integers inscribed, one at the top of the card and one at the bottom. At the beginning of the round the player chooses one of his cards to play it. If the top of the card contains number ai, and the bottom contains number bi, then when the player is playing the card, he gets ai points and also gets the opportunity to play additional bi cards. After the playing the card is discarded.More formally: let\'s say that there is a counter of the cards that can be played. At the beginning of the round the counter equals one. When a card is played, the counter decreases by one for the played card and increases by the number bi, which is written at the bottom of the card. Then the played card is discarded. If after that the counter is not equal to zero, the player gets the opportunity to play another card from the remaining cards. The round ends when the counter reaches zero or the player runs out of cards.Of course, Ilya wants to get as many points as possible. Can you determine the maximum number of points he can score provided that you know his cards?" 1100.0
                                                153C "Caesar Cipher" "*special problem" "Caesar cipher is one of the simplest encryption techniques. To transform the original message into encrypted one using key k, one has to replace each letter with a letter which is k positions later in the alphabet (if this takes the position beyond Z, the rest of it is counted from the start of the alphabet). In a more formal way, if letters of the alphabet are enumerated starting with 0, the result of encryption for character x will be  (26 is the number of letters in the Latin alphabet).You are given the original message and the encryption key k. Output the resulting cipher." 2200.0
                                                151A "Soft Drinking" implementation,math "This winter is so cold in Nvodsk! A group of n friends decided to buy k bottles of a soft drink called ""Take-It-Light"" to warm up a bit. Each bottle has l milliliters of the drink. Also they bought c limes and cut each of them into d slices. After that they found p grams of salt.To make a toast, each friend needs nl milliliters of the drink, a slice of lime and np grams of salt. The friends want to make as many toasts as they can, provided they all drink the same amount. How many toasts can each friend make?" 800.0
                                                150B "Quantity of Strings" "combinatorics,dfs and similar,graphs,math" "Just in case somebody missed it: this winter is totally cold in Nvodsk! It is so cold that one gets funny thoughts. For example, let\'s say there are strings with the length exactly n, based on the alphabet of size m. Any its substring with length equal to k is a palindrome. How many such strings exist? Your task is to find their quantity modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Be careful and don\'t miss a string or two!Let us remind you that a string is a palindrome if it can be read the same way in either direction, from the left to the right and from the right to the left." 1600.0
                                                148C "Terse princess" "constructive algorithms,greedy" "\xc2\xabNext please\xc2\xbb, \xe2\x80\x94 the princess called and cast an estimating glance at the next groom.The princess intends to choose the most worthy groom, this is, the richest one. Whenever she sees a groom who is more rich than each of the previous ones, she says a measured \xc2\xabOh...\xc2\xbb. Whenever the groom is richer than all previous ones added together, she exclaims \xc2\xabWow!\xc2\xbb (no \xc2\xabOh...\xc2\xbb in this case). At the sight of the first groom the princess stays calm and says nothing.The fortune of each groom is described with an integer between 1 and 50000. You know that during the day the princess saw n grooms, said \xc2\xabOh...\xc2\xbb exactly a times and exclaimed \xc2\xabWow!\xc2\xbb exactly b times. Your task is to output a sequence of n integers t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn, where ti describes the fortune of i-th groom. If several sequences are possible, output any of them. If no sequence exists that would satisfy all the requirements, output a single number -1." 1700.0
                                                143A "Help Vasilisa the Wise 2" "brute force,math" "Vasilisa the Wise from the Kingdom of Far Far Away got a magic box with a secret as a present from her friend Hellawisa the Wise from the Kingdom of A Little Closer. However, Vasilisa the Wise does not know what the box\'s secret is, since she cannot open it again. She hopes that you will help her one more time with that.The box\'s lock looks as follows: it contains 4 identical deepenings for gems as a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, and some integer numbers are written at the lock\'s edge near the deepenings. The example of a lock is given on the picture below.  The box is accompanied with 9 gems. Their shapes match the deepenings\' shapes and each gem contains one number from 1 to 9 (each number is written on exactly one gem). The box will only open after it is decorated with gems correctly: that is, each deepening in the lock should be filled with exactly one gem. Also, the sums of numbers in the square\'s rows, columns and two diagonals of the square should match the numbers written at the lock\'s edge. For example, the above lock will open if we fill the deepenings with gems with numbers as is shown on the picture below.  Now Vasilisa the Wise wants to define, given the numbers on the box\'s lock, which gems she should put in the deepenings to open the box. Help Vasilisa to solve this challenging task." 1000.0
                                                140C "New Year Snowmen" "binary search,data structures,greedy" "As meticulous Gerald sets the table and caring Alexander sends the postcards, Sergey makes snowmen. Each showman should consist of three snowballs: a big one, a medium one and a small one. Sergey\'s twins help him: they\'ve already made n snowballs with radii equal to r1, r2, ..., rn. To make a snowman, one needs any three snowballs whose radii are pairwise different. For example, the balls with radii 1, 2 and 3 can be used to make a snowman but 2, 2, 3 or 2, 2, 2 cannot. Help Sergey and his twins to determine what maximum number of snowmen they can make from those snowballs." 1800.0
                                                137E "Last Chance" "data structures,implementation,strings" "Having read half of the book called ""Storm and Calm"" on the IT lesson, Innocentius was absolutely determined to finish the book on the maths lessons. All was fine until the math teacher Ms. Watkins saw Innocentius reading fiction books instead of solving equations of the fifth degree. As during the last maths class Innocentius suggested the algorithm of solving equations of the fifth degree in the general case, Ms. Watkins had no other choice but to give him a new task.The teacher asked to write consecutively (without spaces) all words from the ""Storm and Calm"" in one long string s. She thought that a string is good if the number of vowels in the string is no more than twice more than the number of consonants. That is, the string with v vowels and c consonants is good if and only if v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892c.The task Innocentius had to solve turned out to be rather simple: he should find the number of the longest good substrings of the string s." 2000.0
                                                136B "Ternary Logic" implementation,math "Little Petya very much likes computers. Recently he has received a new ""Ternatron IV"" as a gift from his mother. Unlike other modern computers, ""Ternatron IV"" operates with ternary and not binary logic. Petya immediately wondered how the xor operation is performed on this computer (and whether there is anything like it).It turned out that the operation does exist (however, it is called tor) and it works like this. Suppose that we need to calculate the value of the expression a tor b. Both numbers a and b are written in the ternary notation one under the other one (b under a). If they have a different number of digits, then leading zeroes are added to the shorter number until the lengths are the same. Then the numbers are summed together digit by digit. The result of summing each two digits is calculated modulo 3. Note that there is no carry between digits (i. e. during this operation the digits aren\'t transferred). For example: 1410 tor 5010\xe2\x80\x89=\xe2\x80\x8901123 tor 12123\xe2\x80\x89=\xe2\x80\x8910213\xe2\x80\x89=\xe2\x80\x893410.Petya wrote numbers a and c on a piece of paper. Help him find such number b, that a tor b\xe2\x80\x89=\xe2\x80\x89c. If there are several such numbers, print the smallest one." 1100.0
                                                132E "Bits of merry old England" flows,graphs "Another feature of Shakespeare language is that the variables are named after characters of plays by Shakespeare, and all operations on them (value assignment, output etc.) look like a dialog with other characters. New values of variables are defined in a rather lengthy way, so a programmer should try to minimize their usage.You have to print the given sequence of n integers. To do this, you have m variables and two types of operations on them:  variable=integer  print(variable) Any of the m variables can be used as variable. Variables are denoted by lowercase letters between ""a"" and ""z"", inclusive. Any integer number can be used as integer.Let\'s say that the penalty for using first type of operations equals to the number of set bits in the number integer. There is no penalty on using second type of operations. Find and output the program which minimizes the penalty for printing the given sequence of numbers." 2700.0
                                                132D "Constants in the language of Shakespeare" "constructive algorithms,dp,greedy" "Shakespeare is a widely known esoteric programming language in which programs look like plays by Shakespeare, and numbers are given by combinations of ornate epithets. In this problem we will have a closer look at the way the numbers are described in Shakespeare.Each constant in Shakespeare is created from non-negative powers of 2 using arithmetic operations. For simplicity we\'ll allow only addition and subtraction and will look for a representation of the given number which requires a minimal number of operations.You are given an integer n. You have to represent it as n\xe2\x80\x89=\xe2\x80\x89a1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89am, where each of ai is a non-negative power of 2, possibly multiplied by -1. Find a representation which minimizes the value of m." 2100.0
                                                130E "Tribonacci numbers" "*special problem" "Tribonacci numbers are a sequence of numbers, defined as follows: t0\xe2\x80\x89=\xe2\x80\x89t1\xe2\x80\x89=\xe2\x80\x890, t2\xe2\x80\x89=\xe2\x80\x891, ti\xe2\x80\x89=\xe2\x80\x89ti\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ti\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89ti\xe2\x80\x89-\xe2\x80\x893.You are given n; calculate n-th tribonacci number modulo 26." 1600.0
                                                130A "Hexagonal numbers" "*special problem,implementation" "Hexagonal numbers are figurate numbers which can be calculated using the formula hn\xe2\x80\x89=\xe2\x80\x892n2\xe2\x80\x89-\xe2\x80\x89n. You are given n; calculate n-th hexagonal number." 900.0
                                                128A Statues "dfs and similar" "In this task Anna and Maria play a game with a very unpleasant rival. Anna and Maria are in the opposite squares of a chessboard (8\xe2\x80\x89\xc3\x97\xe2\x80\x898): Anna is in the upper right corner, and Maria is in the lower left one. Apart from them, the board has several statues. Each statue occupies exactly one square. A square that contains a statue cannot have anything or anyone \xe2\x80\x94 neither any other statues, nor Anna, nor Maria.Anna is present on the board as a figurant (she stands still and never moves), and Maria has been actively involved in the game. Her goal is \xe2\x80\x94 to come to Anna\'s square. Maria and statues move in turn, Maria moves first. During one move Maria can go to any adjacent on the side or diagonal cell in which there is no statue, or she can stay in the cell where she is. The statues during their move must go one square down simultaneously, and those statues that were in the bottom row fall from the board and are no longer appeared.At that moment, when one of the statues is in the cell in which the Maria is, the statues are declared winners. At the moment when Maria comes into the cell where Anna has been waiting, Maria is declared the winner.Obviously, nothing depends on the statues, so it all depends on Maria. Determine who will win, if Maria does not make a strategic error." 1500.0
                                                117B "Very Interesting Game" "brute force,number theory" "In a very ancient country the following game was popular. Two people play the game. Initially first player writes a string s1, consisting of exactly nine digits and representing a number that does not exceed a. After that second player looks at s1 and writes a string s2, consisting of exactly nine digits and representing a number that does not exceed b. Here a and b are some given constants, s1 and s2 are chosen by the players. The strings are allowed to contain leading zeroes.If a number obtained by the concatenation (joining together) of strings s1 and s2 is divisible by mod, then the second player wins. Otherwise the first player wins. You are given numbers a, b, mod. Your task is to determine who wins if both players play in the optimal manner. If the first player wins, you are also required to find the lexicographically minimum winning move." 1800.0
                                                113C "Double Happiness" "brute force,math,number theory" "On the math lesson a teacher asked each pupil to come up with his own lucky numbers. As a fan of number theory Peter chose prime numbers. Bob was more original. He said that number t is his lucky number, if it can be represented as: t\xe2\x80\x89=\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89b2,\xe2\x80\x89 where a,\xe2\x80\x89b are arbitrary positive integers.Now, the boys decided to find out how many days of the interval [l,\xe2\x80\x89r] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are suitable for pair programming. They decided that the day i (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) is suitable for pair programming if and only if the number i is lucky for Peter and lucky for Bob at the same time. Help the boys to find the number of such days." 2200.0
                                                111E "Petya and Rectangle"  "Little Petya loves playing with rectangles. Mom bought Petya a rectangle divided into cells n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size (containing n rows, m columns). Petya marked two different cells of the rectangle and now he is solving the following task:Let\'s define a simple path between those two cells as a sequence of distinct cells a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak, where a1 and ak are the two marked cells. Besides, ai and ai\xe2\x80\x89+\xe2\x80\x891 are side-neighboring cells of the path (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k). Let\'s denote the path length as number k (the sequence length). Petya\'s task is to find the longest simple path\'s length and to print the path. Help him." 2900.0
                                                108A "Palindromic Times" implementation,strings "Tattah is asleep if and only if Tattah is attending a lecture. This is a well-known formula among Tattah\'s colleagues.On a Wednesday afternoon, Tattah was attending Professor HH\'s lecture. At 12:21, right before falling asleep, he was staring at the digital watch around Saher\'s wrist. He noticed that the digits on the clock were the same when read from both directions i.e. a palindrome.In his sleep, he started dreaming about such rare moments of the day when the time displayed on a digital clock is a palindrome. As soon as he woke up, he felt destined to write a program that finds the next such moment.However, he still hasn\'t mastered the skill of programming while sleeping, so your task is to help him." 1000.0
                                                105D "Entertaining Geodetics" "brute force,dsu,implementation" "The maps in the game are divided into square cells called Geo Panels. Some of these panels are painted. We shall assume that the Geo Panels without color are painted the transparent color. Besides, the map has so-called Geo Symbols. They look like pyramids of different colors (including Geo Symbols of the transparent color). Each Geo Symbol is located on one Geo Panel, and each Geo Panel may contain no more than one Geo Symbol. Geo Symbols can be eliminated. To understand better what happens when a Geo Symbol is eliminated, let us introduce some queue to which we will put the recently eliminated Geo Symbols. Let\'s put at the head of the queue a Geo Symbol that was eliminated just now. Next, we will repeat the following operation: Extract the Geo Symbol from the queue. Look at the color of the panel containing the given Geo Symbol. If it differs from transparent and differs from the color of the Geo Symbol, then all Geo Panels of this color are repainted in the color of the given Geo Symbol (transparent Geo Symbols repaint the Geo Panels transparent). Repainting is executed in an infinite spiral strictly in the following order starting from the panel, which contained the Geo Symbol:   In other words, we select all the panels that need to be repainted and find their numbers in the infinite spiral whose center is placed in the position of the given Geo Symbol. After that, we repaint them in the order of the number\'s increasing. If a panel contains another Geo Symbol and this panel is being repainted, then the Geo Symbol is removed from the field and placed at the tail of the queue. After repainting the Geo Symbol is completely eliminated and the next Geo Symbol is taken from the head of the queue (if there is any) and the process repeats. The process ends if the queue is empty. See the sample analysis for better understanding. You know the colors of all the Geo Panels and the location of all the Geo Symbols. Determine the number of repaintings, which will occur if you destroy one of the Geo Symbols." 2700.0
                                                103E "Buying Sets" "flows,graph matchings" "The Hexadecimal virus loves playing with number sets \xe2\x80\x94 intersecting them, uniting them. One beautiful day she was surprised to find out that Scuzzy, her spherical pet cat, united all sets in one and ate the result! Something had to be done quickly and Hexadecimal rushed to the market.The market has n sets of numbers on sale. The virus wants to buy the following collection of sets: the number of sets in the collection should be exactly the same as the number of numbers in the union of all bought sets. Moreover, Hexadecimal wants to buy the cheapest suitable collection of set.Yet nothing\'s so easy! As Mainframe is a kingdom of pure rivalry markets, we know that the union of any k sets contains no less than k distinct numbers (for every positive integer k).Help the virus choose the suitable collection of sets. The collection can be empty." 2900.0
                                                100H Battleship "*special problem,dfs and similar,implementation" "Do you know the game Battleship? If no, look into Wikipedia article http://en.wikipedia.org/wiki/Battleship_(game). You are given the positions of ships on a 10\xe2\x80\x89\xc3\x97\xe2\x80\x8910 board for playing Battleship. According to the rules, the board should contain the following ships:   one of size 4 (4\xe2\x80\x89\xc3\x97\xe2\x80\x891 or 1\xe2\x80\x89\xc3\x97\xe2\x80\x894 rectangle),  two of size 3 (3\xe2\x80\x89\xc3\x97\xe2\x80\x891 or 1\xe2\x80\x89\xc3\x97\xe2\x80\x893 rectangles),  three of size 2 (2\xe2\x80\x89\xc3\x97\xe2\x80\x891 or 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 rectangles),  four of size 1 (1\xe2\x80\x89\xc3\x97\xe2\x80\x891 rectangles). The ships should not \'bend\', touch each other or overlap in any way. Each ship can be oriented horizontaly or verticaly. Your task is to check whether the given set of boards meets the given conditions." 2100.0
                                                98D "Help Monks" "constructive algorithms" "In a far away kingdom is the famous Lio Shan monastery. Gods constructed three diamond pillars on the monastery\'s lawn long ago. Gods also placed on one pillar n golden disks of different diameters (in the order of the diameters\' decreasing from the bottom to the top). Besides, gods commanded to carry all the disks from the first pillar to the third one according to the following rules: you can carry only one disk in one move; you cannot put a larger disk on a smaller one. There was no universal opinion concerning what is to happen after the gods\' will is done: some people promised world peace and eternal happiness to everyone, whereas others predicted that the kingdom will face communi\xe2\x80\xa6 (gee, what am I rambling about?) the Armageddon. However, as everybody knew that it was impossible to solve the problem in less than 2n\xe2\x80\x89-\xe2\x80\x891 moves and the lazy Lio Shan monks never even started to solve it, everyone lives peacefully even though the problem was never solved and nobody was afraid of the Armageddon.However, the monastery wasn\'t doing so well lately and the wise prior Ku Sean Sun had to cut some disks at the edges and use the gold for the greater good. Wouldn\'t you think that the prior is entitled to have an air conditioning system? Besides, staying in the monastery all year is sooo dull\xe2\x80\xa6 One has to have a go at something new now and then, go skiing, for example\xe2\x80\xa6 Ku Sean Sun realize how big a mistake he had made only after a while: after he cut the edges, the diameters of some disks got the same; that means that some moves that used to be impossible to make, were at last possible (why, gods never prohibited to put a disk on a disk of the same diameter). Thus, the possible Armageddon can come earlier than was initially planned by gods. Much earlier. So much earlier, in fact, that Ku Sean Sun won\'t even have time to ski all he wants or relax under the air conditioner.The wise prior could never let that last thing happen and he asked one very old and very wise witch PikiWedia to help him. May be she can determine the least number of moves needed to solve the gods\' problem. However, the witch laid out her cards and found no answer for the prior. Then he asked you to help him.Can you find the shortest solution of the problem, given the number of disks and their diameters? Keep in mind that it is allowed to place disks of the same diameter one on the other one, however, the order in which the disks are positioned on the third pillar in the end should match the initial order of the disks on the first pillar." 2500.0
                                                98C "Help Greg the Dwarf" "geometry,ternary search" "A very unusual citizen lives in a far away kingdom \xe2\x80\x94 Dwarf Gracula. However, his unusual name is not the weirdest thing (besides, everyone long ago got used to calling him simply Dwarf Greg). What is special about Dwarf Greg \xe2\x80\x94 he\'s been living for over 200 years; besides, he lives in a crypt on an abandoned cemetery and nobody has ever seen him out in daytime. Moreover, nobody has ever seen Greg buy himself any food. That\'s why nobody got particularly surprised when after the infernal dragon\'s tragic death cattle continued to disappear from fields. The people in the neighborhood were long sure that the harmless dragon was never responsible for disappearing cattle (considering that the dragon used to be sincere about his vegetarian views). But even that\'s not the worst part of the whole story.The worst part is that merely several minutes ago Dwarf Greg in some unintelligible way got inside your house and asked you to help him solve a problem. The point is that a short time ago Greg decided to order a new coffin (knowing his peculiar character, you are not surprised at all). But the problem is: a very long in both directions L-shaped corridor leads to Greg\'s crypt, and you can\'t drag just any coffin through that corridor. That\'s why he asked you to help.  You\'ve formalized the task on a plane like this: let the corridor\'s width before and after the turn be equal to a and b correspondingly (see the picture). The corridor turns directly at a right angle, the coffin is a rectangle whose length and width are equal to l and w (l\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89w) correspondingly. Dwarf Greg has already determined the coffin\'s length (l), which is based on his height; your task is to determine the coffin\'s maximally possible width (w), at which it can be brought to the crypt. Besides, due to its large mass (pure marble!) the coffin is equipped with rotating wheels; therefore it is impossible to lift it off the ground, however, arbitrary moves and rotations of the coffin in the plane become possible. The coffin may be rotated arbitrarily just before you drag it into crypt and move through the corridor.Greg promised that if you help him, he will grant you immortality (I wonder how?). And if you don\'t, well... trust me, you don\'t want to know what happens if you don\'t help him..." 2500.0
                                                97C "Winning Strategy" "binary search,graphs,math,shortest paths" "One university has just found out about a sport programming contest called ACM ICPC v2.0. This contest doesn\'t differ much from the well-known ACM ICPC, for example, the participants are not allowed to take part in the finals more than two times. However, there is one notable difference: the teams in the contest should consist of exactly n participants.Having taken part in several ACM ICPC v2.0 finals and having not won any medals, the students and the university governors realized that it\'s high time they changed something about the preparation process. Specifically, as the first innovation it was decided to change the teams\' formation process. Having spent considerable amount of time on studying the statistics of other universities\' performance, they managed to receive some interesting information: the dependence between the probability of winning a medal and the number of team members that participated in the finals in the past. More formally, we know n\xe2\x80\x89+\xe2\x80\x891 real numbers p0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pn, where pi is the probability of getting a medal on the finals if the team has i participants of previous finals, and other n\xe2\x80\x89-\xe2\x80\x89i participants arrived to the finals for the first time.Despite such useful data, the university governors are unable to determine such team forming tactics that would provide the maximum probability of winning a medal at ACM ICPC v2.0 finals on average (we are supposed to want to provide such result to the far future and we are also supposed to have an endless supply of students). And how about you, can you offer such optimal tactic? At the first stage the university governors want to know the value of maximum average probability.More formally, suppose that the university sends a team to the k-th world finals. The team has ak participants of previous finals (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ak\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Since each person can participate in the finals no more than twice, the following condition must be true: . Your task is to choose sequence  so that the limit \xce\xa8 exists and it\'s value is maximal:As  is an infinite sequence, you should only print the maximum value of the \xce\xa8 limit." 2400.0
                                                97B Superset "constructive algorithms,divide and conquer" "A set of points on a plane is called good, if for any two points at least one of the three conditions is true: those two points lie on same horizontal line;  those two points lie on same vertical line;  the rectangle, with corners in these two points, contains inside or on its borders at least one point of the set, other than these two. We mean here a rectangle with sides parallel to coordinates\' axes, the so-called bounding box of the two points.You are given a set consisting of n points on a plane. Find any good superset of the given set whose size would not exceed 2\xc2\xb7105 points." 2300.0
                                                87A Trains implementation,math "Vasya the programmer lives in the middle of the Programming subway branch. He has two girlfriends: Dasha and Masha, who live at the different ends of the branch, each one is unaware of the other one\'s existence.When Vasya has some free time, he goes to one of his girlfriends. He descends into the subway at some time, waits the first train to come and rides on it to the end of the branch to the corresponding girl. However, the trains run with different frequencies: a train goes to Dasha\'s direction every a minutes, but a train goes to Masha\'s direction every b minutes. If two trains approach at the same time, Vasya goes toward the direction with the lower frequency of going trains, that is, to the girl, to whose directions the trains go less frequently (see the note to the third sample).We know that the trains begin to go simultaneously before Vasya appears. That is the train schedule is such that there exists a moment of time when the two trains arrive simultaneously.Help Vasya count to which girlfriend he will go more often." 1500.0
                                                84C Biathlon "binary search,implementation" "Perhaps many have heard that the World Biathlon Championship has finished. Although our hero Valera was not present at this spectacular event himself and only watched it on TV, it excited him so much that he decided to enroll in a biathlon section.Of course, biathlon as any sport, proved very difficult in practice. It takes much time and effort. Workouts, workouts, and workouts, \xe2\x80\x94 that\'s what awaited Valera on his way to great achievements in biathlon.As for the workouts, you all probably know that every professional biathlete should ski fast and shoot precisely at the shooting range. Only in this case you can hope to be successful, because running and shooting are the two main components of biathlon. Valera has been diligent in his ski trainings, which is why he runs really fast, however, his shooting accuracy is nothing to write home about.On a biathlon base where Valera is preparing for the competition, there is a huge rifle range with n targets. Each target have shape of a circle, and the center of each circle is located on the Ox axis. At the last training session Valera made the total of m shots. To make monitoring of his own results easier for him, one rather well-known programmer (of course it is you) was commissioned to write a program that would reveal how many and which targets Valera hit. More specifically, for each target the program must print the number of the first successful shot (in the target), or ""-1"" if this was not hit. The target is considered hit if the shot is inside the circle or on its boundary. Valera is counting on you and perhaps, thanks to you he will one day win international competitions." 1700.0
                                                78C "Beaver Game" "dp,games,number theory" "Two beavers, Timur and Marsel, play the following game.There are n logs, each of exactly m meters in length. The beavers move in turns. For each move a beaver chooses a log and gnaws it into some number (more than one) of equal parts, the length of each one is expressed by an integer and is no less than k meters. Each resulting part is also a log which can be gnawed in future by any beaver. The beaver that can\'t make a move loses. Thus, the other beaver wins.Timur makes the first move. The players play in the optimal way. Determine the winner." 2000.0
                                                75D "Big Maximum Sum" "data structures,dp,greedy,implementation,math,trees" "Ahmed and Mostafa used to compete together in many programming contests for several years. Their coach Fegla asked them to solve one challenging problem, of course Ahmed was able to solve it but Mostafa couldn\'t.This problem is similar to a standard problem but it has a different format and constraints.In the standard problem you are given an array of integers, and you have to find one or more consecutive elements in this array where their sum is the maximum possible sum.But in this problem you are given n small arrays, and you will create one big array from the concatenation of one or more instances of the small arrays (each small array could occur more than once). The big array will be given as an array of indexes (1-based) of the small arrays, and the concatenation should be done in the same order as in this array. Then you should apply the standard problem mentioned above on the resulting big array.For example let\'s suppose that the small arrays are {1, 6, -2}, {3, 3} and {-5, 1}. And the indexes in the big array are {2, 3, 1, 3}. So the actual values in the big array after formatting it as concatenation of the small arrays will be {3, 3, -5, 1, 1, 6, -2, -5, 1}. In this example the maximum sum is 9.Can you help Mostafa solve this problem?" 2000.0
                                                75A "Life Without Zeros" implementation "Can you imagine our life if we removed all zeros from it? For sure we will have many problems.In this problem we will have a simple example if we removed all zeros from our life, it\'s the addition operation. Let\'s assume you are given this equation a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89=\xe2\x80\x89c, where a and b are positive integers, and c is the sum of a and b. Now let\'s remove all zeros from this equation. Will the equation remain correct after removing all zeros?For example if the equation is 101\xe2\x80\x89+\xe2\x80\x89102\xe2\x80\x89=\xe2\x80\x89203, if we removed all zeros it will be 11\xe2\x80\x89+\xe2\x80\x8912\xe2\x80\x89=\xe2\x80\x8923 which is still a correct equation.But if the equation is 105\xe2\x80\x89+\xe2\x80\x89106\xe2\x80\x89=\xe2\x80\x89211, if we removed all zeros it will be 15\xe2\x80\x89+\xe2\x80\x8916\xe2\x80\x89=\xe2\x80\x89211 which is not a correct equation." 1000.0
                                                74E "Shift It!" "constructive algorithms" "There is a square box 6\xe2\x80\x89\xc3\x97\xe2\x80\x896 in size. It contains 36 chips 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 in size. Those chips contain 36 different characters \xe2\x80\x94 ""0""-""9"" and ""A""-""Z"". There is exactly one chip with each character.You are allowed to make the following operations: you may choose one of 6 rows or one of 6 columns and cyclically shift the chips there to one position to the left or to the right (for the row) or upwards or downwards (for the column). Those operations are allowed to perform several times. To solve the puzzle is to shift the chips using the above described operations so that they were written in the increasing order (exactly equal to the right picture). An example of solving the puzzle is shown on a picture below.  Write a program that finds the sequence of operations that solves the puzzle. That sequence should not necessarily be shortest, but you should not exceed the limit of 10000 operations. It is guaranteed that the solution always exists." 2800.0
                                                74D Hanger "data structures" "In one very large and very respectable company there is a cloakroom with a coat hanger. It is represented by n hooks, positioned in a row. The hooks are numbered with positive integers from 1 to n from the left to the right.The company workers have a very complicated work schedule. At the beginning of a work day all the employees are not there and the coat hanger in the cloakroom is empty. At some moments of time the employees arrive and some of them leave.When some employee arrives, he hangs his cloak on one of the available hooks. To be of as little discomfort to his colleagues as possible, the hook where the coat will hang, is chosen like this. First the employee chooses the longest segment among available hooks following in a row. If there are several of such segments, then he chooses the one closest to the right. After that the coat is hung on the hook located in the middle of this segment. If the segment has an even number of hooks, then among two central hooks we choose the one closest to the right.When an employee leaves, he takes his coat. As all the company workers deeply respect each other, no one takes somebody else\'s coat.From time to time the director of this respectable company gets bored and he sends his secretary to see how many coats hang on the coat hanger from the i-th to the j-th hook inclusive. And this whim is always to be fulfilled, otherwise the director gets angry and has a mental breakdown.Not to spend too much time traversing from the director\'s office to the cloakroom and back again, the secretary asked you to write a program, emulating the company cloakroom\'s work." 2400.0
                                                72B INI-file "*special problem,implementation" "The INI file format is a de facto standard for configuration files. INI files are simple text files with a basic structure. They are commonly associated with Microsoft Windows, but are also used on other platforms.Each line in INI-file stands for key-value mapping or defines new section. A key-value line has a format ""key=value"",where key \xe2\x80\x94 is the name of some property, and value \xe2\x80\x94 it\'s value. It is possible that it will be spaces from the both sides of key and/or value, the spaces should be ignored.A section line has a format ""[section]"". It means that all key-value lines after it define properties of the specified section. Of cause, the following section line changes the current section. A section line may have spaces around any of brackets.Also you should ignore comment lines \xe2\x80\x94 the first non-space character of comment line is "";"".You task is to write the program which will format given INI-file in a special way:   first, print key-value lines which do not belong to any section;  print all the sections in the lexicographical (alphabetical) order of their names;  inside each of two previous items, order key-value lines lexicographically by ""key"";  if there are more than one key-value lines with the same key inside a single section (or outside any sections), leave only one line (which appears later in the input data);  remove all redundant spaces and lines." 2200.0
                                                70D "Professor\'s task" "data structures,geometry" "Once a walrus professor Plato asked his programming students to perform the following practical task. The students had to implement such a data structure that would support a convex hull on some set of points S. The input to the program had q queries of two types: 1. Add a point with coordinates (x,\xe2\x80\x89y) into the set S. Note that in this case the convex hull of S could have changed, and could have remained the same. 2. Say whether a point with coordinates (x,\xe2\x80\x89y) belongs to an area limited by the convex hull, including the border. All the students coped with the task. What about you?" 2700.0
                                                67D "Optical Experiment" "binary search,data structures,dp" "Professor Phunsuk Wangdu has performed some experiments on rays. The setup for n rays is as follows.There is a rectangular box having exactly n holes on the opposite faces. All rays enter from the holes of the first side and exit from the holes of the other side of the box. Exactly one ray can enter or exit from each hole. The holes are in a straight line.  Professor Wangdu is showing his experiment to his students. He shows that there are cases, when all the rays are intersected by every other ray. A curious student asked the professor: ""Sir, there are some groups of rays such that all rays in that group intersect every other ray in that group. Can we determine the number of rays in the largest of such groups?"".Professor Wangdu now is in trouble and knowing your intellect he asks you to help him." 1900.0
                                                64C Table "*special problem,greedy,implementation,math" "The integer numbers from 1 to nm was put into rectangular table having n rows and m columns. The numbers was put from left to right, from top to bottom, i.e. the first row contains integers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89m, the second \xe2\x80\x94 m\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x892\xe2\x80\x89*\xe2\x80\x89m and so on.After it these numbers was written on the paper in another order: from top to bottom, from left to right. First, the numbers in the first column was written (from top to bottom) and so on.Print the k-th number on the paper." 1600.0
                                                63A "Sinking Ship" implementation,sortings,strings "The ship crashed into a reef and is sinking. Now the entire crew must be evacuated. All n crew members have already lined up in a row (for convenience let\'s label them all from left to right with positive integers from 1 to n) and await further instructions. However, one should evacuate the crew properly, in a strict order. Specifically:The first crew members to leave the ship are rats. Then women and children (both groups have the same priority) leave the ship. After that all men are evacuated from the ship. The captain leaves the sinking ship last.If we cannot determine exactly who should leave the ship first for any two members of the crew by the rules from the previous paragraph, then the one who stands to the left in the line leaves the ship first (or in other words, the one whose number in the line is less).For each crew member we know his status as a crew member, and also his name. All crew members have different names. Determine the order in which to evacuate the crew." 900.0
                                                62A "A Student\'s Dream" greedy,math "Statistics claims that students sleep no more than three hours a day. But even in the world of their dreams, while they are snoring peacefully, the sense of impending doom is still upon them.A poor student is dreaming that he is sitting the mathematical analysis exam. And he is examined by the most formidable professor of all times, a three times Soviet Union Hero, a Noble Prize laureate in student expulsion, venerable Petr Palych.The poor student couldn\'t answer a single question. Thus, instead of a large spacious office he is going to apply for a job to thorium mines. But wait a minute! Petr Palych decided to give the student the last chance! Yes, that is possible only in dreams. So the professor began: ""Once a Venusian girl and a Marsian boy met on the Earth and decided to take a walk holding hands. But the problem is the girl has al fingers on her left hand and ar fingers on the right one. The boy correspondingly has bl and br fingers. They can only feel comfortable when holding hands, when no pair of the girl\'s fingers will touch each other. That is, they are comfortable when between any two girl\'s fingers there is a boy\'s finger. And in addition, no three fingers of the boy should touch each other. Determine if they can hold hands so that the both were comfortable.""The boy any the girl don\'t care who goes to the left and who goes to the right. The difference is only that if the boy goes to the left of the girl, he will take her left hand with his right one, and if he goes to the right of the girl, then it is vice versa." 1300.0
                                                59E "Shortest Path" "graphs,shortest paths" "In Ancient Berland there were n cities and m two-way roads of equal length. The cities are numbered with integers from 1 to n inclusively. According to an ancient superstition, if a traveller visits three cities ai, bi, ci in row, without visiting other cities between them, a great disaster awaits him. Overall there are k such city triplets. Each triplet is ordered, which means that, for example, you are allowed to visit the cities in the following order: ai, ci, bi. Vasya wants to get from the city 1 to the city n and not fulfil the superstition. Find out which minimal number of roads he should take. Also you are required to find one of his possible path routes." 2000.0
                                                59A Word implementation,strings "Vasya is very upset that many people on the Net mix uppercase and lowercase letters in one word. That\'s why he decided to invent an extension for his favorite browser that would change the letters\' register in every word so that it either only consisted of lowercase letters or, vice versa, only of uppercase ones. At that as little as possible letters should be changed in the word. For example, the word HoUse must be replaced with house, and the word ViP \xe2\x80\x94 with VIP. If a word contains an equal number of uppercase and lowercase letters, you should replace all the letters with lowercase ones. For example, maTRIx should be replaced by matrix. Your task is to use the given method on one given word." 800.0
                                                57D Journey dp,math "Stewie the Rabbit explores a new parallel universe. This two dimensional universe has the shape of a rectangular grid, containing n lines and m columns. The universe is very small: one cell of the grid can only contain one particle. Each particle in this universe is either static or dynamic. Each static particle always remains in one and the same position. Due to unintelligible gravitation laws no two static particles in the parallel universe can be present in one column or row, and they also can\'t be present in the diagonally adjacent cells. A dynamic particle appears in a random empty cell, randomly chooses the destination cell (destination cell may coincide with the start cell, see the samples) and moves there along the shortest path through the cells, unoccupied by the static particles. All empty cells have the same probability of being selected as the beginning or end of the path. Having reached the destination cell, the particle disappears. Only one dynamic particle can exist at one moment of time. This particle can move from a cell to a cell if they have an adjacent side, and this transition takes exactly one galactic second. Stewie got interested in what is the average lifespan of one particle in the given universe." 2500.0
                                                57C Array combinatorics,math "Chris the Rabbit has been interested in arrays ever since he was a child. At the moment he is researching arrays with the length of n, containing only integers from 1 to n. He is not good at math, that\'s why some simple things drive him crazy. For example, yesterday he grew keen on counting how many different beautiful arrays there are. Chris thinks that an array is beautiful if it meets one of the two conditions:   each elements, starting from the second one, is no more than the preceding one  each element, starting from the second one, is no less than the preceding one Having got absolutely mad at himself and at math, Chris came to Stewie and Brian to ask them for help. However, they only laughed at him and said that the answer is too simple and not interesting. Help Chris the Rabbit to find the answer at last." 1900.0
                                                56A Bar implementation "According to Berland laws it is only allowed to sell alcohol to people not younger than 18 years. Vasya\'s job is to monitor the law\'s enforcement. Tonight he entered a bar and saw n people sitting there. For every one of them Vasya happened to determine either the age or the drink the person is having. Vasya can check any person, i.e. learn his age and the drink he is having at the same time. What minimal number of people should Vasya check additionally to make sure that there are no clients under 18 having alcohol drinks?The list of all alcohol drinks in Berland is: ABSINTH, BEER, BRANDY, CHAMPAGNE, GIN, RUM, SAKE, TEQUILA, VODKA, WHISKEY, WINE" 1000.0
                                                53D "Physical Education" sortings "Vasya is a school PE teacher. Unlike other PE teachers, Vasya doesn\'t like it when the students stand in line according to their height. Instead, he demands that the children stand in the following order: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is the height of the i-th student in the line and n is the number of students in the line. The children find it hard to keep in mind this strange arrangement, and today they formed the line in the following order: b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, which upset Vasya immensely. Now Vasya wants to rearrange the children so that the resulting order is like this: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. During each move Vasya can swap two people who stand next to each other in the line. Help Vasya, find the sequence of swaps leading to the arrangement Vasya needs. It is not required to minimize the number of moves." 1500.0
                                                50D Bombing "binary search,dp,probabilities" "The commanding officers decided to drop a nuclear bomb on the enemy\'s forces. You are ordered to determine the power of the warhead that needs to be used.The enemy has N strategically important objects. Their positions are known due to the intelligence service. The aim of the strike is to deactivate at least K important objects of the enemy. The bombing impact point is already determined and has coordinates of [X0; Y0].The nuclear warhead is marked by the estimated impact radius R\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890. All the buildings that are located closer than R to the bombing epicentre will be destroyed. All the buildings that are located further than R from the epicentre, can also be deactivated with some degree of probability. Let\'s assume that D is the distance between a building and the epicentre. This building\'s deactivation probability P(D,\xe2\x80\x89R) is calculated according to the following formula:  We should regard  as ea, where e\xe2\x80\x89\xe2\x89\x88\xe2\x80\x892.7182818284590452353602874713527If the estimated impact radius of the warhead is equal to zero, then all the buildings located in the impact point will be completely demolished and all the rest of important objects will not be damaged.The commanding officers want the probability of failing the task to be no more than \xce\xb5. Nuclear warheads are too expensive a luxury, that\'s why you have to minimise the estimated impact radius of the warhead." 2100.0
                                                49B Sum math "Vasya studies positional numeral systems. Unfortunately, he often forgets to write the base of notation in which the expression is written. Once he saw a note in his notebook saying a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89=\xe2\x80\x89?, and that the base of the positional notation wasn\xe2\x80\x99t written anywhere. Now Vasya has to choose a base p and regard the expression as written in the base p positional notation. Vasya understood that he can get different results with different bases, and some bases are even invalid. For example, expression 78\xe2\x80\x89+\xe2\x80\x8987 in the base 16 positional notation is equal to FF16, in the base 15 positional notation it is equal to 11015, in the base 10 one \xe2\x80\x94 to 16510, in the base 9 one \xe2\x80\x94 to 1769, and in the base 8 or lesser-based positional notations the expression is invalid as all the numbers should be strictly less than the positional notation base. Vasya got interested in what is the length of the longest possible expression value. Help him to find this length.The length of a number should be understood as the number of numeric characters in it. For example, the length of the longest answer for 78\xe2\x80\x89+\xe2\x80\x8987\xe2\x80\x89=\xe2\x80\x89? is 3. It is calculated like that in the base 15 (11015), base 10 (16510), base 9 (1769) positional notations, for example, and in some other ones." 1500.0
                                                48E "Ivan the Fool VS Gorynych the Dragon" dp,games,graphs "Once upon a time in a kingdom far, far away\xe2\x80\xa6 Okay, let\xe2\x80\x99s start at the point where Ivan the Fool met Gorynych the Dragon. Ivan took out his magic sword and the battle began. First Gorynych had h heads and t tails. With each strike of the sword Ivan can either cut off several heads (from 1 to n, but not more than Gorynych has at the moment), or several tails (from 1 to m, but not more than Gorynych has at the moment). At the same time, horrible though it seems, Gorynych the Dragon can also grow new heads and tails. And the number of growing heads and tails is determined uniquely by the number of heads or tails cut by the current strike. When the total number of heads and tails exceeds R, Gorynych the Dragon strikes its final blow and destroys Ivan the Fool. That\xe2\x80\x99s why Ivan aims to cut off all the dragon\xe2\x80\x99s heads and tails as quickly as possible and win. The events can also develop in a third way: neither of the opponents can win over the other one and they will continue fighting forever.The tale goes like this; easy to say, hard to do. Your task is to write a program that will determine the battle\xe2\x80\x99s outcome. Consider that Ivan strikes consecutively. After each blow Gorynych grows a number of new heads and tails depending on the number of cut ones. Gorynych the Dragon is defeated if after the blow he loses all his heads and tails and can\xe2\x80\x99t grow new ones. Ivan fights in the optimal way (fools are lucky), i.e.   if Ivan can win, he wins having struck the least number of blows;  if it is impossible to defeat Gorynych, but is possible to resist him for an infinitely long period of time, then that\xe2\x80\x99s the strategy Ivan chooses;  if Gorynych wins in any case, Ivan aims to resist him for as long as possible." 2100.0
                                                44F BerPaint geometry,graphs "Anfisa the monkey got disappointed in word processors as they aren\'t good enough at reflecting all the range of her emotions, that\'s why she decided to switch to graphics editors. Having opened the BerPaint, she saw a white rectangle W\xe2\x80\x89\xc3\x97\xe2\x80\x89H in size which can be painted on. First Anfisa learnt to navigate the drawing tool which is used to paint segments and quickly painted on that rectangle a certain number of black-colored segments. The resulting picture didn\'t seem bright enough to Anfisa, that\'s why she turned her attention to the ""fill"" tool which is used to find a point on the rectangle to paint and choose a color, after which all the area which is the same color as the point it contains, is completely painted the chosen color. Having applied the fill several times, Anfisa expressed her emotions completely and stopped painting. Your task is by the information on the painted segments and applied fills to find out for every color the total area of the areas painted this color after all the fills." 2700.0
                                                44B Cola implementation "To celebrate the opening of the Winter Computer School the organizers decided to buy in n liters of cola. However, an unexpected difficulty occurred in the shop: it turned out that cola is sold in bottles 0.5, 1 and 2 liters in volume. At that, there are exactly a bottles 0.5 in volume, b one-liter bottles and c of two-liter ones. The organizers have enough money to buy any amount of cola. What did cause the heated arguments was how many bottles of every kind to buy, as this question is pivotal for the distribution of cola among the participants (and organizers as well).Thus, while the organizers are having the argument, discussing different variants of buying cola, the Winter School can\'t start. Your task is to count the number of all the possible ways to buy exactly n liters of cola and persuade the organizers that this number is too large, and if they keep on arguing, then the Winter Computer School will have to be organized in summer.All the bottles of cola are considered indistinguishable, i.e. two variants of buying are different from each other only if they differ in the number of bottles of at least one kind." 1500.0
                                                43A Football strings "One day Vasya decided to have a look at the results of Berland 1910 Football Championship\xe2\x80\x99s finals. Unfortunately he didn\'t find the overall score of the match; however, he got hold of a profound description of the match\'s process. On the whole there are n lines in that description each of which described one goal. Every goal was marked with the name of the team that had scored it. Help Vasya, learn the name of the team that won the finals. It is guaranteed that the match did not end in a tie." 1000.0
                                                40E "Number Table" combinatorics "As it has been found out recently, all the Berland\'s current economical state can be described using a simple table n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size. n \xe2\x80\x94 the number of days in each Berland month, m \xe2\x80\x94 the number of months. Thus, a table cell corresponds to a day and a month of the Berland\'s year. Each cell will contain either 1, or -1, which means the state\'s gains in a particular month, on a particular day. 1 corresponds to profits, -1 corresponds to losses. It turned out important for successful development to analyze the data on the state of the economy of the previous year, however when the treasurers referred to the archives to retrieve the data, it turned out that the table had been substantially damaged. In some table cells the number values had faded and were impossible to be deciphered. It is known that the number of cells in which the data had been preserved is strictly less than max(n,\xe2\x80\x89m). However, there is additional information \xe2\x80\x94 the product of the numbers in each line and column equaled -1. Your task is to find out how many different tables may conform to the preserved data. As the answer to the task can be quite large, you have to find it modulo p." 2500.0
                                                39G "Inverse Function" implementation "Petya wrote a programme on C++ that calculated a very interesting function f(n). Petya ran the program with a certain value of n and went to the kitchen to have some tea. The history has no records concerning how long the program had been working. By the time Petya returned, it had completed the calculations and had the result. However while Petya was drinking tea, a sly virus managed to destroy the input file so that Petya can\'t figure out for which value of n the program was run. Help Petya, carry out the inverse function!Mostly, the program consists of a function in C++ with the following simplified syntax:  function ::= int f(int n) {operatorSequence} operatorSequence ::= operator | operator operatorSequence operator ::= return arithmExpr; | if (logicalExpr) return arithmExpr; logicalExpr ::= arithmExpr\xe2\x80\x89>\xe2\x80\x89arithmExpr | arithmExpr\xe2\x80\x89<\xe2\x80\x89arithmExpr | arithmExpr == arithmExpr arithmExpr ::= sum sum ::= product | sum\xe2\x80\x89+\xe2\x80\x89product | sum\xe2\x80\x89-\xe2\x80\x89product product ::= multiplier | product\xe2\x80\x89*\xe2\x80\x89multiplier | product\xe2\x80\x89/\xe2\x80\x89multiplier multiplier ::= n | number | f(arithmExpr) number ::= 0|1|2|... |32767 The whitespaces in a operatorSequence are optional.Thus, we have a function, in which body there are two kinds of operators. There is the operator ""return arithmExpr;"" that returns the value of the expression as the value of the function, and there is the conditional operator ""if (logicalExpr) return arithmExpr;"" that returns the value of the arithmetical expression when and only when the logical expression is true. Guaranteed that no other constructions of C++ language \xe2\x80\x94 cycles, assignment operators, nested conditional operators etc, and other variables except the n parameter are used in the function. All the constants are integers in the interval [0..32767].The operators are performed sequentially. After the function has returned a value other operators in the sequence are not performed. Arithmetical expressions are performed taking into consideration the standard priority of the operations. It means that first all the products that are part of the sum are calculated. During the calculation of the products the operations of multiplying and division are performed from the left to the right. Then the summands are summed, and the addition and the subtraction are also performed from the left to the right. Operations "">"" (more), ""<"" (less) and ""=="" (equals) also have standard meanings.Now you\'ve got to pay close attention! The program is compiled with the help of 15-bit Berland C++ compiler invented by a Berland company BerSoft, that\'s why arithmetical operations are performed in a non-standard way. Addition, subtraction and multiplication are performed modulo 32768 (if the result of subtraction is negative, then 32768 is added to it until the number belongs to the interval [0..32767]). Division ""/"" is a usual integer division where the remainder is omitted.Examples of arithmetical operations: Guaranteed that for all values of n from 0 to 32767 the given function is performed correctly. That means that:1. Division by 0 never occures.2. When performing a function for the value n\xe2\x80\x89=\xe2\x80\x89N recursive calls of the function f may occur only for the parameter value of 0,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89N\xe2\x80\x89-\xe2\x80\x891. Consequently, the program never has an infinite recursion.3. As the result of the sequence of the operators, the function always returns a value.We have to mention that due to all the limitations the value returned by the function f is independent from either global variables or the order of performing the calculations of arithmetical expressions as part of the logical one, or from anything else except the value of n parameter. That\'s why the f function can be regarded as a function in its mathematical sense, i.e. as a unique correspondence between any value of n from the interval [0..32767] and a value of f(n) from the same interval.Given the value of f(n), and you should find n. If the suitable n value is not unique, you should find the maximal one (from the interval [0..32767])." 2400.0
                                                39B "Company Income Growth" greedy "Petya works as a PR manager for a successful Berland company BerSoft. He needs to prepare a presentation on the company income growth since 2001 (the year of its founding) till now. Petya knows that in 2001 the company income amounted to a1 billion bourles, in 2002 \xe2\x80\x94 to a2 billion, ..., and in the current (2000\xe2\x80\x89+\xe2\x80\x89n)-th year \xe2\x80\x94 an billion bourles. On the base of the information Petya decided to show in his presentation the linear progress history which is in his opinion perfect. According to a graph Petya has already made, in the first year BerSoft company income must amount to 1 billion bourles, in the second year \xe2\x80\x94 2 billion bourles etc., each following year the income increases by 1 billion bourles. Unfortunately, the real numbers are different from the perfect ones. Among the numbers ai can even occur negative ones that are a sign of the company\xe2\x80\x99s losses in some years. That is why Petya wants to ignore some data, in other words, cross some numbers ai from the sequence and leave only some subsequence that has perfect growth.Thus Petya has to choose a sequence of years y1, y2, ..., yk,so that in the year y1 the company income amounted to 1 billion bourles, in the year y2 \xe2\x80\x94 2 billion bourles etc., in accordance with the perfect growth dynamics. Help him to choose the longest such sequence." 1300.0
                                                37D "Lesson Timetable" combinatorics,dp,math "When Petya has free from computer games time, he attends university classes. Every day the lessons on Petya\xe2\x80\x99s faculty consist of two double classes. The floor where the lessons take place is a long corridor with M classrooms numbered from 1 to M, situated along it.All the students of Petya\xe2\x80\x99s year are divided into N groups. Petya has noticed recently that these groups\xe2\x80\x99 timetable has the following peculiarity: the number of the classroom where the first lesson of a group takes place does not exceed the number of the classroom where the second lesson of this group takes place. Once Petya decided to count the number of ways in which one can make a lesson timetable for all these groups. The timetable is a set of 2N numbers: for each group the number of the rooms where the first and the second lessons take place. Unfortunately, he quickly lost the track of his calculations and decided to count only the timetables that satisfy the following conditions:1) On the first lesson in classroom i exactly Xi groups must be present.2) In classroom i no more than Yi groups may be placed.Help Petya count the number of timetables satisfying all those conditions\xd1\x8e As there can be a lot of such timetables, output modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300.0
                                                36D "New Game with a Chess Piece" games "Petya and Vasya are inventing a new game that requires a rectangular board and one chess piece. At the beginning of the game the piece stands in the upper-left corner of the board. Two players move the piece in turns. Each turn the chess piece can be moved either one square to the right or one square down or jump k squares diagonally down and to the right. The player who can\xe2\x80\x99t move the piece loses.   The guys haven\xe2\x80\x99t yet thought what to call the game or the best size of the board for it. Your task is to write a program that can determine the outcome of the game depending on the board size." 2300.0
                                                36B Fractal implementation "Ever since Kalevitch, a famous Berland abstractionist, heard of fractals, he made them the main topic of his canvases. Every morning the artist takes a piece of graph paper and starts with making a model of his future canvas. He takes a square as big as n\xe2\x80\x89\xc3\x97\xe2\x80\x89n squares and paints some of them black. Then he takes a clean square piece of paper and paints the fractal using the following algorithm: Step 1. The paper is divided into n2 identical squares and some of them are painted black according to the model.Step 2. Every square that remains white is divided into n2 smaller squares and some of them are painted black according to the model.Every following step repeats step 2.  Unfortunately, this tiresome work demands too much time from the painting genius. Kalevitch has been dreaming of making the process automatic to move to making 3D or even 4D fractals." 1600.0
                                                35C "Fire Again" "brute force,dfs and similar,shortest paths" "After a terrifying forest fire in Berland a forest rebirth program was carried out. Due to it N rows with M trees each were planted and the rows were so neat that one could map it on a system of coordinates so that the j-th tree in the i-th row would have the coordinates of (i,\xe2\x80\x89j). However a terrible thing happened and the young forest caught fire. Now we must find the coordinates of the tree that will catch fire last to plan evacuation.The burning began in K points simultaneously, which means that initially K trees started to burn. Every minute the fire gets from the burning trees to the ones that aren\xe2\x80\x99t burning and that the distance from them to the nearest burning tree equals to 1.Find the tree that will be the last to start burning. If there are several such trees, output any." 1500.0
                                                33D Knights "geometry,graphs,shortest paths,sortings" "Berland is facing dark times again. The army of evil lord Van de Mart is going to conquer the whole kingdom. To the council of war called by the Berland\'s king Valery the Severe came n knights. After long discussions it became clear that the kingdom has exactly n control points (if the enemy conquers at least one of these points, the war is lost) and each knight will occupy one of these points. Berland is divided into m\xe2\x80\x89+\xe2\x80\x891 regions with m fences, and the only way to get from one region to another is to climb over the fence. Each fence is a circle on a plane, no two fences have common points, and no control point is on the fence. You are given k pairs of numbers ai, bi. For each pair you have to find out: how many fences a knight from control point with index ai has to climb over to reach control point bi (in case when Van de Mart attacks control point bi first). As each knight rides a horse (it is very difficult to throw a horse over a fence), you are to find out for each pair the minimum amount of fences to climb over." 2000.0
                                                31E "TV Game" dp "There is a new TV game on BerTV. In this game two players get a number A consisting of 2n digits. Before each turn players determine who will make the next move. Each player should make exactly n moves. On it\'s turn i-th player takes the leftmost digit of A and appends it to his or her number Si. After that this leftmost digit is erased from A. Initially the numbers of both players (S1 and S2) are \xc2\xabempty\xc2\xbb. Leading zeroes in numbers A,\xe2\x80\x89S1,\xe2\x80\x89S2 are allowed. In the end of the game the first player gets S1 dollars, and the second gets S2 dollars.One day Homer and Marge came to play the game. They managed to know the number A beforehand. They want to find such sequence of their moves that both of them makes exactly n moves and which maximizes their total prize. Help them." 2400.0
                                                25E Test hashing,strings "Sometimes it is hard to prepare tests for programming problems. Now Bob is preparing tests to new problem about strings \xe2\x80\x94 input data to his problem is one string. Bob has 3 wrong solutions to this problem. The first gives the wrong answer if the input data contains the substring s1, the second enters an infinite loop if the input data contains the substring s2, and the third requires too much memory if the input data contains the substring s3. Bob wants these solutions to fail single test. What is the minimal length of test, which couldn\'t be passed by all three Bob\'s solutions?" 2200.0
                                                25B "Phone numbers" implementation "Phone number in Berland is a sequence of n digits. Often, to make it easier to memorize the number, it is divided into groups of two or three digits. For example, the phone number 1198733 is easier to remember as 11-987-33. Your task is to find for a given phone number any of its divisions into groups of two or three digits." 1100.0
                                                23A "You\'re Given a String..." "brute force,greedy" "You\'re given a string of lower-case Latin letters. Your task is to find the length of its longest substring that can be met in the string at least twice. These occurrences can overlap (see sample test 2)." 1200.0
                                                19E Fairy "dfs and similar,divide and conquer,dsu" "Once upon a time there lived a good fairy A. One day a fine young man B came to her and asked to predict his future. The fairy looked into her magic ball and said that soon the fine young man will meet the most beautiful princess ever and will marry her. Then she drew on a sheet of paper n points and joined some of them with segments, each of the segments starts in some point and ends in some other point. Having drawn that picture, she asked the young man to erase one of the segments from the sheet. Then she tries to colour each point red or blue so, that there is no segment having points of the same colour as its ends. If she manages to do so, the prediction will come true. B wants to meet the most beautiful princess, that\'s why he asks you to help him. Find all the segments that will help him to meet the princess." 2900.0
                                                19D Points "data structures" "Pete and Bob invented a new interesting game. Bob takes a sheet of paper and locates a Cartesian coordinate system on it as follows: point (0,\xe2\x80\x890) is located in the bottom-left corner, Ox axis is directed right, Oy axis is directed up. Pete gives Bob requests of three types:   add x y \xe2\x80\x94 on the sheet of paper Bob marks a point with coordinates (x,\xe2\x80\x89y). For each request of this type it\'s guaranteed that point (x,\xe2\x80\x89y) is not yet marked on Bob\'s sheet at the time of the request.  remove x y \xe2\x80\x94 on the sheet of paper Bob erases the previously marked point with coordinates (x,\xe2\x80\x89y). For each request of this type it\'s guaranteed that point (x,\xe2\x80\x89y) is already marked on Bob\'s sheet at the time of the request.  find x y \xe2\x80\x94 on the sheet of paper Bob finds all the marked points, lying strictly above and strictly to the right of point (x,\xe2\x80\x89y). Among these points Bob chooses the leftmost one, if it is not unique, he chooses the bottommost one, and gives its coordinates to Pete. Bob managed to answer the requests, when they were 10, 100 or 1000, but when their amount grew up to 2\xc2\xb7105, Bob failed to cope. Now he needs a program that will answer all Pete\'s requests. Help Bob, please!" 2800.0
                                                16A Flag implementation "According to a new ISO standard, a flag of every country should have a chequered field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, each square should be of one of 10 colours, and the flag should be \xc2\xabstriped\xc2\xbb: each horizontal row of the flag should contain squares of the same colour, and the colours of adjacent horizontal rows should be different. Berland\'s government asked you to find out whether their flag meets the new ISO standard." 800.0
                                                15D Map "data structures,implementation,sortings" "There is an area map that is a rectangular matrix n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, each cell of the matrix contains the average height of a corresponding area part. Peter works for a company that has to build several cities within this area, each of the cities will occupy a rectangle a\xe2\x80\x89\xc3\x97\xe2\x80\x89b cells on the map. To start construction works in a particular place Peter needs to remove excess ground from the construction site where a new city will be built. To do so he chooses a cell of the minimum height within this site, and removes excess ground from other cells of the site down to this minimum level. Let\'s consider that to lower the ground level from h2 to h1 (h1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89h2) they need to remove h2\xe2\x80\x89-\xe2\x80\x89h1 ground units.Let\'s call a site\'s position optimal, if the amount of the ground removed from this site is minimal compared to other possible positions. Peter constructs cities according to the following algorithm: from all the optimum site\'s positions he chooses the uppermost one. If this position is not unique, he chooses the leftmost one. Then he builds a city on this site. Peter repeats this process untill he can build at least one more city. For sure, he cannot carry out construction works on the occupied cells. Would you, please, help Peter place cities according to the algorithm?" 2500.0
                                                13C Sequence dp,sortings "Little Petya likes to play very much. And most of all he likes to play the following game:He is given a sequence of N integer numbers. At each step it is allowed to increase the value of any number by 1 or to decrease it by 1. The goal of the game is to make the sequence non-decreasing with the smallest number of steps. Petya is not good at math, so he asks for your help.The sequence a is called non-decreasing if a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aN holds, where N is the length of the sequence." 2200.0
                                                11E "Forward, march!" "binary search,dp,greedy" "Jack has become a soldier now. Unfortunately, he has trouble with the drill. Instead of marching beginning with the left foot and then changing legs with each step, as ordered, he keeps repeating a sequence of steps, in which he sometimes makes the wrong steps or \xe2\x80\x94 horror of horrors! \xe2\x80\x94 stops for a while. For example, if Jack uses the sequence \'right, left, break\', when the sergeant yells: \'Left! Right! Left! Right! Left! Right!\', Jack first makes a step with the right foot, then one with the left foot, then he is confused and stops for a moment, then again - this time according to the order - starts with the right foot, then uses the left foot, then - to the sergeant\'s irritation - he stops to catch his breath, to incorrectly start with the right foot again... Marching this way, Jack will make the step that he is supposed to in the given moment in only one third of cases.When the officers convinced him he should do something about it, Jack decided to modify the basic sequence of steps that he repeats. However, in order not to get too tired, he has decided that the only thing he\'ll do is adding any number of breaks in any positions of the original sequence (a break corresponds to stopping for the duration of one step). Of course, Jack can\'t make a step on the same foot twice in a row, if there is no pause between these steps. It is, however, not impossible that the sequence of steps he used so far is incorrect (it would explain a lot, actually).Help Private Jack! Given the sequence of steps he keeps repeating, calculate the maximal percentage of time that he can spend marching correctly after adding some breaks to his scheme." 2800.0
                                                11B "Jumping Jack" math "Jack is working on his jumping skills recently. Currently he\'s located at point zero of the number line. He would like to get to the point x. In order to train, he has decided that he\'ll first jump by only one unit, and each subsequent jump will be exactly one longer than the previous one. He can go either left or right with each jump. He wonders how many jumps he needs to reach x." 1600.0
                                                8A "Train and Peter" strings "Peter likes to travel by train. He likes it so much that on the train he falls asleep. Once in summer Peter was going by train from city A to city B, and as usual, was sleeping. Then he woke up, started to look through the window and noticed that every railway station has a flag of a particular colour.The boy started to memorize the order of the flags\' colours that he had seen. But soon he fell asleep again. Unfortunately, he didn\'t sleep long, he woke up and went on memorizing the colours. Then he fell asleep again, and that time he slept till the end of the journey.At the station he told his parents about what he was doing, and wrote two sequences of the colours that he had seen before and after his sleep, respectively.Peter\'s parents know that their son likes to fantasize. They give you the list of the flags\' colours at the stations that the train passes sequentially on the way from A to B, and ask you to find out if Peter could see those sequences on the way from A to B, or from B to A. Remember, please, that Peter had two periods of wakefulness.Peter\'s parents put lowercase Latin letters for colours. The same letter stands for the same colour, different letters \xe2\x80\x94 for different colours." 1200.0
                                                4D "Mysterious Present" dp,sortings "Peter decided to wish happy birthday to his friend from Australia and send him a card. To make his present more mysterious, he decided to make a chain. Chain here is such a sequence of envelopes A\xe2\x80\x89=\xe2\x80\x89{a1,\xe2\x80\x89\xe2\x80\x89a2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89an}, where the width and the height of the i-th envelope is strictly higher than the width and the height of the (i\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89\xe2\x80\x891)-th envelope respectively. Chain size is the number of envelopes in the chain. Peter wants to make the chain of the maximum size from the envelopes he has, the chain should be such, that he\'ll be able to put a card into it. The card fits into the chain if its width and height is lower than the width and the height of the smallest envelope in the chain respectively. It\'s forbidden to turn the card and the envelopes. Peter has very many envelopes and very little time, this hard task is entrusted to you." 1700.0
