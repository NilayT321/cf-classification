1525D Armchairs "dp,flows,graph matchings,greedy" "There are n armchairs, numbered from 1 to n from left to right. Some armchairs are occupied by people (at most one person per armchair), others are not. The number of occupied armchairs is not greater than n2.For some reason, you would like to tell people to move from their armchairs to some other ones. If the i-th armchair is occupied by someone and the j-th armchair is not, you can tell the person sitting in the i-th armchair to move to the j-th armchair. The time it takes a person to move from the i-th armchair to the j-th one is |i\xe2\x88\x92j| minutes. You may perform this operation any number of times, but these operations must be done sequentially, i.\xe2\x80\x89e. you cannot tell a person to move until the person you asked to move in the last operation has finished moving to their destination armchair.You want to achieve the following situation: every seat that was initially occupied must be free. What is the minimum time you need to do it?" 1800
1525C "Robot Collisions" "data structures,greedy,implementation,sortings" "There are n robots driving along an OX axis. There are also two walls: one is at coordinate 0 and one is at coordinate m.The i-th robot starts at an integer coordinate xi (0<xi<m) and moves either left (towards the 0) or right with the speed of 1 unit per second. No two robots start at the same coordinate.Whenever a robot reaches a wall, it turns around instantly and continues his ride in the opposite direction with the same speed.Whenever several robots meet at the same integer coordinate, they collide and explode into dust. Once a robot has exploded, it doesn\'t collide with any other robot. Note that if several robots meet at a non-integer coordinate, nothing happens.For each robot find out if it ever explodes and print the time of explosion if it happens and \xe2\x88\x921 otherwise." 2000
1525B "Permutation Sort" "constructive algorithms,greedy" "You are given a permutation a consisting of n numbers 1, 2, ..., n (a permutation is an array in which each element from 1 to n occurs exactly once).You can perform the following operation: choose some subarray (contiguous subsegment) of a and rearrange the elements in it in any way you want. But this operation cannot be applied to the whole array.For example, if a=[2,1,4,5,3] and we want to apply the operation to the subarray a[2,4] (the subarray containing all elements from the 2-nd to the 4-th), then after the operation, the array can become a=[2,5,1,4,3] or, for example, a=[2,1,5,4,3].Your task is to calculate the minimum number of operations described above to sort the permutation a in ascending order." 900
1525A Potion-making "math,number theory" "You have an initially empty cauldron, and you want to brew a potion in it. The potion consists of two ingredients: magic essence and water. The potion you want to brew should contain exactly k % magic essence and (100\xe2\x88\x92k) % water.In one step, you can pour either one liter of magic essence or one liter of water into the cauldron. What is the minimum number of steps to brew a potion? You don\'t care about the total volume of the potion, only about the ratio between magic essence and water in it.A small reminder: if you pour e liters of essence and w liters of water (e+w>0) into the cauldron, then it contains ee+w\xe2\x8b\x85100 % (without rounding) magic essence and we+w\xe2\x8b\x85100 % water." 800
1523H "Hopping Around the Array" "data structures,dp" "William really wants to get a pet. Since his childhood he dreamt about getting a pet grasshopper. William is being very responsible about choosing his pet, so he wants to set up a trial for the grasshopper!The trial takes place on an array a of length n, which defines lengths of hops for each of n cells. A grasshopper can hop around the sells according to the following rule: from a cell with index i it can jump to any cell with indices from i to i+ai inclusive.Let\'s call the k-grasshopper value of some array the smallest number of hops it would take a grasshopper to hop from the first cell to the last, but before starting you can select no more than k cells and remove them from the array. When a cell is removed all other cells are renumbered but the values of ai for each cell remains the same. During this the first and the last cells may not be removed.It is required to process q queries of the following format: you are given three numbers l, r, k. You are required to find the k-grasshopper value for an array, which is a subarray of the array a with elements from l to r inclusive." 3500
1523G "Try Booking" "data structures,divide and conquer" "William owns a flat in central London. He decided to rent his flat out for the next n days to earn some money.Since his flat is in the center of the city, he instantly got m offers in the form (li,ri), which means that someone wants to book the flat from day li until day ri inclusive. To avoid spending a lot of time figuring out whether it\'s profitable for him to accept an offer, William decided to develop an algorithm. The algorithm processes all offers as they arrive and will only accept offer i if the following two conditions are satisfied:  ri\xe2\x88\x92li+1\xe2\x89\xa5x.  None of the days between li and ri are occupied by a previously accepted offer  William isn\'t sure what value x should have and he asks you for help. For all x from 1 to n he wants you to calculate the total number of days for which the flat would be occupied if the corresponding value will be assigned to x." 3200
1523F "Favorite Game" bitmasks,dp "After William is done with work for the day, he enjoys playing his favorite video game.The game happens in a 2D world, starting at turn 00. William can pick any cell in the game world and spawn in it. Then, each turn, William may remain at his current location or move from the current location (x, y) to one of the following locations: (x + 1, y), (x - 1, y), (x, y + 1), (x, y - 1).To accelerate movement the game has nn fast travel towers. ii-th tower is located at location (xai,yaixai,yai). To be able to instantly travel to the tower from any location in the game world it must first be activated. Activation of tower ii happens at the moment when the player is in cell (xai,yaixai,yai) after this the tower remains active throughout the entire game.William also knows that the game has mm quests. ii-th quest can be completed instantly by being at location (xbi,ybixbi,ybi) on turn titi.William wants to find out the maximal number of quests he will be able to complete by optimally traversing the game world." 3300
1523E "Crypto Lights" combinatorics,dp,math,probabilities "To monitor cryptocurrency exchange rates trader William invented a wonderful device consisting of n lights arranged in a row. The device functions in the following way:Initially, all lights on William\'s device are turned off. At the beginning of a new iteration the device randomly, with a uniform distribution, picks a light that is turned off and turns it on, telling William which cryptocurrency he should invest in. After this iteration if any k consecutive lights contain more than one turned on light, then the device finishes working.William doesn\'t like uncertainty, so he wants you to calculate the expected value of the number of lights that are turned on in the device after it finishes working." 2600
1523D Love-Hate "bitmasks,brute force,dp,probabilities" "William is hosting a party for n of his trader friends. They started a discussion on various currencies they trade, but there\'s an issue: not all of his trader friends like every currency. They like some currencies, but not others.For each William\'s friend i it is known whether he likes currency j. There are m currencies in total. It is also known that a trader may not like more than p currencies.Because friends need to have some common topic for discussions they need to find the largest by cardinality (possibly empty) subset of currencies, such that there are at least \xe2\x8c\x88n2\xe2\x8c\x89 friends (rounded up) who like each currency in this subset." 2400
1523C "Compression and Expansion" "brute force,data structures,greedy,implementation,trees" "William is a huge fan of planning ahead. That is why he starts his morning routine by creating a nested list of upcoming errands.A valid nested list is any list which can be created from a list with one item ""1"" by applying some operations. Each operation inserts a new item into the list, on a new line, just after one of existing items a1.a2.a3.\xe2\x8b\xaf.ak and can be one of two types:   Add an item a1.a2.a3.\xe2\x8b\xaf.ak.1 (starting a list of a deeper level), or  Add an item a1.a2.a3.\xe2\x8b\xaf.(ak+1) (continuing the current level).  Operation can only be applied if the list does not contain two identical items afterwards. And also, if we consider every item as a sequence of numbers, then the sequence of items should always remain increasing in lexicographical order. Examples of valid and invalid lists that are shown in the picture can found in the ""Notes"" section.When William decided to save a Word document with the list of his errands he accidentally hit a completely different keyboard shortcut from the ""Ctrl-S"" he wanted to hit. It\'s not known exactly what shortcut he pressed but after triggering it all items in the list were replaced by a single number: the last number originally written in the item number.William wants you to help him restore a fitting original nested list." 1600
1523B "Lord of the Values" "constructive algorithms" "While trading on his favorite exchange trader William realized that he found a vulnerability. Using this vulnerability he could change the values of certain internal variables to his advantage. To play around he decided to change the values of all internal variables from a1,a2,\xe2\x80\xa6,an to \xe2\x88\x92a1,\xe2\x88\x92a2,\xe2\x80\xa6,\xe2\x88\x92an. For some unknown reason, the number of service variables is always an even number.William understands that with his every action he attracts more and more attention from the exchange\'s security team, so the number of his actions must not exceed 5000 and after every operation no variable can have an absolute value greater than 1018. William can perform actions of two types for two chosen variables with indices i and j, where i<j:  Perform assignment ai=ai+aj  Perform assignment aj=aj\xe2\x88\x92ai  William wants you to develop a strategy that will get all the internal variables to the desired values." 1100
1523A "Game of Life" implementation "William really likes the cellular automaton called ""Game of Life"" so he decided to make his own version. For simplicity, William decided to define his cellular automaton on an array containing n cells, with each cell either being alive or dead.Evolution of the array in William\'s cellular automaton occurs iteratively in the following way:  If the element is dead and it has exactly 1 alive neighbor in the current state of the array, then on the next iteration it will become alive. For an element at index i the neighbors would be elements with indices i\xe2\x88\x921 and i+1. If there is no element at that index, it is considered to be a dead neighbor.  William is a humane person so all alive elements stay alive. Check the note section for examples of the evolution.You are given some initial state of all elements and you need to help William find the state of the array after m iterations of evolution." 800
1521E "Nastia and a Beautiful Matrix" "binary search,constructive algorithms,dp,greedy" "You like numbers, don\'t you? Nastia has a lot of numbers and she wants to share them with you! Isn\'t it amazing?Let ai be how many numbers i (1\xe2\x89\xa4i\xe2\x89\xa4k) you have.An n\xc3\x97n matrix is called beautiful if it contains all the numbers you have, and for each 2\xc3\x972 submatrix of the original matrix is satisfied:   The number of occupied cells doesn\'t exceed 3;  The numbers on each diagonal are distinct. Make a beautiful matrix of minimum size." 2700
1521D "Nastia Plays with a Tree" "constructive algorithms,data structures,dfs and similar,dp,dsu,greedy,implementation,trees" "Nastia has an unweighted tree with n vertices and wants to play with it!The girl will perform the following operation with her tree, as long as she needs:  Remove any existing edge.  Add an edge between any pair of vertices. What is the minimum number of operations Nastia needs to get a bamboo from a tree? A bamboo is a tree in which no node has a degree greater than 2." 2500
1521C "Nastia and a Hidden Permutation" "constructive algorithms,interactive" "This is an interactive problem!Nastia has a hidden permutation p of length n consisting of integers from 1 to n. You, for some reason, want to figure out the permutation. To do that, you can give her an integer t (1\xe2\x89\xa4t\xe2\x89\xa42), two different indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j), and an integer x (1\xe2\x89\xa4x\xe2\x89\xa4n\xe2\x88\x921). Depending on t, she will answer:   t=1: max(min(x,pi),min(x+1,pj));  t=2: min(max(x,pi),max(x+1,pj)). You can ask Nastia at most \xe2\x8c\x8a3\xe2\x8b\x85n2\xe2\x8c\x8b+30 times. It is guaranteed that she will not change her permutation depending on your queries. Can you guess the permutation?" 2000
1521B "Nastia and a Good Array" "constructive algorithms,math,number theory" "Nastia has received an array of n positive integers as a gift.She calls such an array a good that for all i (2\xe2\x89\xa4i\xe2\x89\xa4n) takes place gcd(ai\xe2\x88\x921,ai)=1, where gcd(u,v) denotes the greatest common divisor (GCD) of integers u and v.You can perform the operation: select two different indices i,j (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j) and two integers x,y (1\xe2\x89\xa4x,y\xe2\x89\xa42\xe2\x8b\x85109) so that min(ai,aj)=min(x,y). Then change ai to x and aj to y.The girl asks you to make the array good using at most n operations.It can be proven that this is always possible." 1300
1521A "Nastia and Nearly Good Numbers" "constructive algorithms,math,number theory" "Nastia has 2 positive integers A and B. She defines that:  The integer is good if it is divisible by A\xe2\x8b\x85B;  Otherwise, the integer is nearly good, if it is divisible by A. For example, if A=6 and B=4, the integers 24 and 72 are good, the integers 6, 660 and 12 are nearly good, the integers 16, 7 are neither good nor nearly good.Find 3 different positive integers x, y, and z such that exactly one of them is good and the other 2 are nearly good, and x+y=z." 1000
1520G "To Go Or Not To Go?" "brute force,dfs and similar,graphs,greedy,implementation,shortest paths" "Dima overslept the alarm clock, which was supposed to raise him to school.Dima wonders if he will have time to come to the first lesson. To do this, he needs to know the minimum time it will take him to get from home to school.The city where Dima lives is a rectangular field of n\xc3\x97m size. Each cell (i,j) on this field is denoted by one number aij:  The number \xe2\x88\x921 means that the passage through the cell is prohibited;  The number 0 means that the cell is free and Dima can walk though it.  The number x (1\xe2\x89\xa4x\xe2\x89\xa4109) means that the cell contains a portal with a cost of x. A cell with a portal is also considered free. From any portal, Dima can go to any other portal, while the time of moving from the portal (i,j) to the portal (x,y) corresponds to the sum of their costs aij+axy.In addition to moving between portals, Dima can also move between unoccupied cells adjacent to one side in time w. In particular, he can enter a cell with a portal and not use it.Initially, Dima is in the upper-left cell (1,1), and the school is in the lower right cell (n,m)." 2200
1520F2 "Guess the K-th Zero (Hard version)" "binary search,constructive algorithms,data structures,interactive" "This is an interactive problem.This is a hard version of the problem. The difference from the easy version is that in the hard version 1\xe2\x89\xa4t\xe2\x89\xa4min(n,104) and the total number of queries is limited to 6\xe2\x8b\x85104.Polycarp is playing a computer game. In this game, an array consisting of zeros and ones is hidden. Polycarp wins if he guesses the position of the k-th zero from the left t times.Polycarp can make no more than 6\xe2\x8b\x85104 requests totally of the following type:   ? l r \xe2\x80\x94 find out the sum of all elements in positions from l to r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) inclusive. To make the game more interesting, each guessed zero turns into one and the game continues on the changed array. More formally, if the position of the k-th zero was x, then after Polycarp guesses this position, the x-th element of the array will be replaced from 0 to 1.Help Polycarp win the game." 2200
1520F1 "Guess the K-th Zero (Easy version)" "binary search,interactive" "This is an interactive problem.This is an easy version of the problem. The difference from the hard version is that in the easy version t=1 and the number of queries is limited to 20.Polycarp is playing a computer game. In this game, an array consisting of zeros and ones is hidden. Polycarp wins if he guesses the position of the k-th zero from the left t times.Polycarp can make no more than 20 requests of the following type:   ? l r \xe2\x80\x94 find out the sum of all elements in positions from l to r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) inclusive. In this (easy version) of the problem, this paragraph doesn\'t really make sense since t=1 always. To make the game more interesting, each guessed zero turns into one and the game continues on the changed array. More formally, if the position of the k-th zero was x, then after Polycarp guesses this position, the x-th element of the array will be replaced from 0 to 1. Of course, this feature affects something only for t>1.Help Polycarp win the game." 1600
1520E "Arranging The Sheep" greedy,math "You are playing the game ""Arranging The Sheep"". The goal of this game is to make the sheep line up. The level in the game is described by a string of length n, consisting of the characters \'.\' (empty space) and \'*\' (sheep). In one move, you can move any sheep one square to the left or one square to the right, if the corresponding square exists and is empty. The game ends as soon as the sheep are lined up, that is, there should be no empty cells between any sheep.For example, if n=6 and the level is described by the string ""**.*.."", then the following game scenario is possible:   the sheep at the 4 position moves to the right, the state of the level: ""**..*."";  the sheep at the 2 position moves to the right, the state of the level: ""*.*.*."";  the sheep at the 1 position moves to the right, the state of the level: "".**.*."";  the sheep at the 3 position moves to the right, the state of the level: "".*.**."";  the sheep at the 2 position moves to the right, the state of the level: ""..***."";  the sheep are lined up and the game ends. For a given level, determine the minimum number of moves you need to make to complete the level." 1400
1520D "Same Differences" "data structures,hashing,math" "You are given an array a of n integers. Count the number of pairs of indices (i,j) such that i<j and aj\xe2\x88\x92ai=j\xe2\x88\x92i." 1200
1520C "Not Adjacent Matrix" "constructive algorithms" "We will consider the numbers a and b as adjacent if they differ by exactly one, that is, |a\xe2\x88\x92b|=1.We will consider cells of a square matrix n\xc3\x97n as adjacent if they have a common side, that is, for cell (r,c) cells (r,c\xe2\x88\x921), (r,c+1), (r\xe2\x88\x921,c) and (r+1,c) are adjacent to it.For a given number n, construct a square matrix n\xc3\x97n such that:   Each integer from 1 to n2 occurs in this matrix exactly once;  If (r1,c1) and (r2,c2) are adjacent cells, then the numbers written in them must not be adjacent." 1000
1520B "Ordinary Numbers" "brute force,math,number theory" "Let\'s call a positive integer n ordinary if in the decimal notation all its digits are the same. For example, 1, 2 and 99 are ordinary numbers, but 719 and 2021 are not ordinary numbers.For a given number n, find the number of ordinary numbers among the numbers from 1 to n." 800
1520A "Do Not Be Distracted!" "brute force,implementation" "Polycarp has 26 tasks. Each task is designated by a capital letter of the Latin alphabet.The teacher asked Polycarp to solve tasks in the following way: if Polycarp began to solve some task, then he must solve it to the end, without being distracted by another task. After switching to another task, Polycarp cannot return to the previous task.Polycarp can only solve one task during the day. Every day he wrote down what task he solved. Now the teacher wants to know if Polycarp followed his advice.For example, if Polycarp solved tasks in the following order: ""DDBBCCCBBEZ"", then the teacher will see that on the third day Polycarp began to solve the task \'B\', then on the fifth day he got distracted and began to solve the task \'C\', on the eighth day Polycarp returned to the task \'B\'. Other examples of when the teacher is suspicious: ""BAB"", ""AABBCCDDEEBZZ"" and ""AAAAZAAAAA"".If Polycarp solved the tasks as follows: ""FFGZZZY"", then the teacher cannot have any suspicions. Please note that Polycarp is not obligated to solve all tasks. Other examples of when the teacher doesn\'t have any suspicious: ""BA"", ""AFFFCC"" and ""YYYYY"".Help Polycarp find out if his teacher might be suspicious." 800
1519F "Chests and Keys" "bitmasks,brute force,dfs and similar,dp,flows" "Alice and Bob play a game. Alice has got n treasure chests (the i-th of which contains ai coins) and m keys (the j-th of which she can sell Bob for bj coins).Firstly, Alice puts some locks on the chests. There are m types of locks, the locks of the j-th type can only be opened with the j-th key. To put a lock of type j on the i-th chest, Alice has to pay ci,j dollars. Alice can put any number of different types of locks on each chest (possibly, zero).Then, Bob buys some of the keys from Alice (possibly none, possibly all of them) and opens each chest he can (he can open a chest if he has the keys for all of the locks on this chest). Bob\'s profit is the difference between the total number of coins in the opened chests and the total number of coins he spends buying keys from Alice. If Bob\'s profit is strictly positive (greater than zero), he wins the game. Otherwise, Alice wins the game.Alice wants to put some locks on some chests so no matter which keys Bob buys, she always wins (Bob cannot get positive profit). Of course, she wants to spend the minimum possible number of dollars on buying the locks. Help her to determine whether she can win the game at all, and if she can, how many dollars she has to spend on the locks." 3200
1519E "Off by One" "constructive algorithms,dfs and similar,geometry,graphs,sortings,trees" "There are n points on an infinite plane. The i-th point has coordinates (xi,yi) such that xi>0 and yi>0. The coordinates are not necessarily integer.In one move you perform the following operations:   choose two points a and b (a\xe2\x89\xa0b);  move point a from (xa,ya) to either (xa+1,ya) or (xa,ya+1);  move point b from (xb,yb) to either (xb+1,yb) or (xb,yb+1);  remove points a and b. However, the move can only be performed if there exists a line that passes through the new coordinates of a, new coordinates of b and (0,0). Otherwise, the move can\'t be performed and the points stay at their original coordinates (xa,ya) and (xb,yb), respectively.The numeration of points does not change after some points are removed. Once the points are removed, they can\'t be chosen in any later moves. Note that you have to move both points during the move, you can\'t leave them at their original coordinates.What is the maximum number of moves you can perform? What are these moves?If there are multiple answers, you can print any of them." 2700
1519D "Maximum Sum of Products" "brute force,dp,implementation,math,two pointers" "You are given two integer arrays a and b of length n.You can reverse at most one subarray (continuous subsegment) of the array a. Your task is to reverse such a subarray that the sum n\xe2\x88\x91i=1ai\xe2\x8b\x85bi is maximized." 1600
1519C "Berland Regional" "brute force,data structures,greedy,number theory,sortings" "Polycarp is an organizer of a Berland ICPC regional event. There are n universities in Berland numbered from 1 to n. Polycarp knows all competitive programmers in the region. There are n students: the i-th student is enrolled at a university ui and has a programming skill si.Polycarp has to decide on the rules now. In particular, the number of members in the team.Polycarp knows that if he chooses the size of the team to be some integer k, each university will send their k strongest (with the highest programming skill s) students in the first team, the next k strongest students in the second team and so on. If there are fewer than k students left, then the team can\'t be formed. Note that there might be universities that send zero teams.The strength of the region is the total skill of the members of all present teams. If there are no teams present, then the strength is 0.Help Polycarp to find the strength of the region for each choice of k from 1 to n." 1400
1519B "The Cake Is a Lie" dp,math "There is a n\xc3\x97m grid. You are standing at cell (1,1) and your goal is to finish at cell (n,m).You can move to the neighboring cells to the right or down. In other words, suppose you are standing at cell (x,y). You can:   move right to the cell (x,y+1) \xe2\x80\x94 it costs x burles;  move down to the cell (x+1,y) \xe2\x80\x94 it costs y burles. Can you reach cell (n,m) spending exactly k burles?" 800
1519A "Red and Blue Beans" math "You have r red and b blue beans. You\'d like to distribute them among several (maybe, one) packets in such a way that each packet:   has at least one red bean (or the number of red beans ri\xe2\x89\xa51);  has at least one blue bean (or the number of blue beans bi\xe2\x89\xa51);  the number of red and blue beans should differ in no more than d (or |ri\xe2\x88\x92bi|\xe2\x89\xa4d) Can you distribute all beans?" 800
1517H "Fly Around the World" dp,geometry "After hearing the story of Dr. Zhang, Wowo decides to plan his own flight around the world. He already chose n checkpoints in the world map. Due to the landform and the clouds, he cannot fly too high or too low. Formally, let bi be the height of Wowo\'s aircraft at checkpoint i, x\xe2\x88\x92i\xe2\x89\xa4bi\xe2\x89\xa4x+i should be satisfied for all integers i between 1 and n, where x\xe2\x88\x92i and x+i are given integers.The angle of Wowo\'s aircraft is also limited. For example, it cannot make a 90-degree climb. Formally, y\xe2\x88\x92i\xe2\x89\xa4bi\xe2\x88\x92bi\xe2\x88\x921\xe2\x89\xa4y+i should be satisfied for all integers i between 2 and n, where y\xe2\x88\x92i and y+i are given integers.The final limitation is the speed of angling up or angling down. An aircraft should change its angle slowly for safety concerns. Formally, z\xe2\x88\x92i\xe2\x89\xa4(bi\xe2\x88\x92bi\xe2\x88\x921)\xe2\x88\x92(bi\xe2\x88\x921\xe2\x88\x92bi\xe2\x88\x922)\xe2\x89\xa4z+i should be satisfied for all integers i between 3 and n, where z\xe2\x88\x92i and z+i are given integers.Taking all these into consideration, Wowo finds that the heights at checkpoints are too hard for him to choose. Please help Wowo decide whether there exists a sequence of real numbers b1,\xe2\x80\xa6,bn satisfying all the contraints above." 3500
1517G "Starry Night Camping" "constructive algorithms,flows,graphs" "At the foot of Liyushan Mountain, n tents will be carefully arranged to provide accommodation for those who are willing to experience the joy of approaching nature, the tranquility of the night, and the bright starry sky.The i-th tent is located at the point of (xi,yi) and has a weight of wi. A tent is important if and only if both xi and yi are even. You need to remove some tents such that for each remaining important tent (x,y), there do not exist 3 other tents (x\xe2\x80\xb21,y\xe2\x80\xb21), (x\xe2\x80\xb22,y\xe2\x80\xb22) and (x\xe2\x80\xb23,y\xe2\x80\xb23) such that both conditions are true:   |x\xe2\x80\xb2j\xe2\x88\x92x|,|y\xe2\x80\xb2j\xe2\x88\x92y|\xe2\x89\xa41 for all j\xe2\x88\x88{1,2,3}, and  these four tents form a parallelogram (or a rectangle) and one of its sides is parallel to the x-axis. Please maximize the sum of the weights of the tents that are not removed. Print the maximum value." 3300
1517F Reunion combinatorics,dp,trees "It is reported that the 2050 Conference will be held in Yunqi Town in Hangzhou from April 23 to 25, including theme forums, morning jogging, camping and so on.The relationship between the n volunteers of the 2050 Conference can be represented by a tree (a connected undirected graph with n vertices and n\xe2\x88\x921 edges). The n vertices of the tree corresponds to the n volunteers and are numbered by 1,2,\xe2\x80\xa6,n.We define the distance between two volunteers i and j, dis(i,j) as the number of edges on the shortest path from vertex i to vertex j on the tree. dis(i,j)=0 whenever i=j.Some of the volunteers can attend the on-site reunion while others cannot. If for some volunteer x and nonnegative integer r, all volunteers whose distance to x is no more than r can attend the on-site reunion, a forum with radius r can take place. The level of the on-site reunion is defined as the maximum possible radius of any forum that can take place.Assume that each volunteer can attend the on-site reunion with probability 12 and these events are independent. Output the expected level of the on-site reunion. When no volunteer can attend, the level is defined as \xe2\x88\x921. When all volunteers can attend, the level is defined as n." 3200
1517E "Group Photo" "binary search,data structures,implementation,two pointers" "In the 2050 Conference, some people from the competitive programming community meet together and are going to take a photo. The n people form a line. They are numbered from 1 to n from left to right. Each of them either holds a cardboard with the letter \'C\' or a cardboard with the letter \'P\'.Let C={c1,c2,\xe2\x80\xa6,cm} (c1<c2<\xe2\x80\xa6<cm) be the set of people who hold cardboards of \'C\'. Let P={p1,p2,\xe2\x80\xa6,pk} (p1<p2<\xe2\x80\xa6<pk) be the set of people who hold cardboards of \'P\'. The photo is good if and only if it satisfies the following constraints:   C\xe2\x88\xaaP={1,2,\xe2\x80\xa6,n}  C\xe2\x88\xa9P=\xe2\x88\x85.  ci\xe2\x88\x92ci\xe2\x88\x921\xe2\x89\xa4ci+1\xe2\x88\x92ci(1<i<m).  pi\xe2\x88\x92pi\xe2\x88\x921\xe2\x89\xa5pi+1\xe2\x88\x92pi(1<i<k). Given an array a1,\xe2\x80\xa6,an, please find the number of good photos satisfying the following condition: \xe2\x88\x91x\xe2\x88\x88Cax<\xe2\x88\x91y\xe2\x88\x88Pay.The answer can be large, so output it modulo 998244353. Two photos are different if and only if there exists at least one person who holds a cardboard of \'C\' in one photo but holds a cardboard of \'P\' in the other." 2500
1517D "Explorer Space" "dp,graphs,shortest paths" "You are wandering in the explorer space of the 2050 Conference.The explorer space can be viewed as an undirected weighted grid graph with size n\xc3\x97m. The set of vertices is {(i,j)|1\xe2\x89\xa4i\xe2\x89\xa4n,1\xe2\x89\xa4j\xe2\x89\xa4m}. Two vertices (i1,j1) and (i2,j2) are connected by an edge if and only if |i1\xe2\x88\x92i2|+|j1\xe2\x88\x92j2|=1.At each step, you can walk to any vertex connected by an edge with your current vertex. On each edge, there are some number of exhibits. Since you already know all the exhibits, whenever you go through an edge containing x exhibits, your boredness increases by x.For each starting vertex (i,j), please answer the following question: What is the minimum possible boredness if you walk from (i,j) and go back to it after exactly k steps?You can use any edge for multiple times but the boredness on those edges are also counted for multiple times. At each step, you cannot stay on your current vertex. You also cannot change direction while going through an edge. Before going back to your starting vertex (i,j) after k steps, you can visit (i,j) (or not) freely." 1800
1517C "Fillomino 2" "constructive algorithms,dfs and similar,greedy,implementation" "Fillomino is a classic logic puzzle. (You do not need to know Fillomino in order to solve this problem.) In one classroom in Yunqi town, some volunteers are playing a board game variant of it:Consider an n by n chessboard. Its rows are numbered from 1 to n from the top to the bottom. Its columns are numbered from 1 to n from the left to the right. A cell on an intersection of x-th row and y-th column is denoted (x,y). The main diagonal of the chessboard is cells (x,x) for all 1\xe2\x89\xa4x\xe2\x89\xa4n.A permutation of {1,2,3,\xe2\x80\xa6,n} is written on the main diagonal of the chessboard. There is exactly one number written on each of the cells. The problem is to partition the cells under and on the main diagonal (there are exactly 1+2+\xe2\x80\xa6+n such cells) into n connected regions satisfying the following constraints:  Every region should be connected. That means that we can move from any cell of a region to any other cell of the same region visiting only cells of the same region and moving from a cell to an adjacent cell.  The x-th region should contain cell on the main diagonal with number x for all 1\xe2\x89\xa4x\xe2\x89\xa4n.  The number of cells that belong to the x-th region should be equal to x for all 1\xe2\x89\xa4x\xe2\x89\xa4n.  Each cell under and on the main diagonal should belong to exactly one region." 1400
1517B "Morning Jogging" "constructive algorithms,greedy,sortings" "The 2050 volunteers are organizing the ""Run! Chase the Rising Sun"" activity. Starting on Apr 25 at 7:30 am, runners will complete the 6km trail around the Yunqi town.There are n+1 checkpoints on the trail. They are numbered by 0, 1, ..., n. A runner must start at checkpoint 0 and finish at checkpoint n. No checkpoint is skippable \xe2\x80\x94 he must run from checkpoint 0 to checkpoint 1, then from checkpoint 1 to checkpoint 2 and so on. Look at the picture in notes section for clarification.Between any two adjacent checkpoints, there are m different paths to choose. For any 1\xe2\x89\xa4i\xe2\x89\xa4n, to run from checkpoint i\xe2\x88\x921 to checkpoint i, a runner can choose exactly one from the m possible paths. The length of the j-th path between checkpoint i\xe2\x88\x921 and i is bi,j for any 1\xe2\x89\xa4j\xe2\x89\xa4m and 1\xe2\x89\xa4i\xe2\x89\xa4n.To test the trail, we have m runners. Each runner must run from the checkpoint 0 to the checkpoint n once, visiting all the checkpoints. Every path between every pair of adjacent checkpoints needs to be ran by exactly one runner. If a runner chooses the path of length li between checkpoint i\xe2\x88\x921 and i (1\xe2\x89\xa4i\xe2\x89\xa4n), his tiredness is nmini=1li, i. e. the minimum length of the paths he takes.Please arrange the paths of the m runners to minimize the sum of tiredness of them." 1200
1517A "Sum of 2050" greedy,math "A number is called 2050-number if it is 2050, 20500, ..., (2050\xe2\x8b\x8510k for integer k\xe2\x89\xa50).Given a number n, you are asked to represent n as the sum of some (not necessarily distinct) 2050-numbers. Compute the minimum number of 2050-numbers required for that." 800
1516E "Baby Ehab Plays with Permutations" combinatorics,dp,math "This time around, Baby Ehab will play with permutations. He has n cubes arranged in a row, with numbers from 1 to n written on them. He\'ll make exactly j operations. In each operation, he\'ll pick up 2 cubes and switch their positions.He\'s wondering: how many different sequences of cubes can I have at the end? Since Baby Ehab is a turbulent person, he doesn\'t know how many operations he\'ll make, so he wants the answer for every possible j between 1 and k." 2500
1516D Cut "binary search,data structures,dp,graphs,number theory,two pointers" "This time Baby Ehab will only cut and not stick. He starts with a piece of paper with an array a of length n written on it, and then he does the following:  he picks a range (l,r) and cuts the subsegment al,al+1,\xe2\x80\xa6,ar out, removing the rest of the array.  he then cuts this range into multiple subranges.  to add a number theory spice to it, he requires that the elements of every subrange must have their product equal to their least common multiple (LCM). Formally, he partitions the elements of al,al+1,\xe2\x80\xa6,ar into contiguous subarrays such that the product of every subarray is equal to its LCM. Now, for q independent ranges (l,r), tell Baby Ehab the minimum number of subarrays he needs." 2100
1516C "Baby Ehab Partitions Again" "bitmasks,constructive algorithms,dp,math" "Baby Ehab was toying around with arrays. He has an array a of length n. He defines an array to be good if there\'s no way to partition it into 2 subsequences such that the sum of the elements in the first is equal to the sum of the elements in the second. Now he wants to remove the minimum number of elements in a so that it becomes a good array. Can you help him?A sequence b is a subsequence of an array a if b can be obtained from a by deleting some (possibly zero or all) elements. A partitioning of an array is a way to divide it into 2 subsequences such that every element belongs to exactly one subsequence, so you must use all the elements, and you can\'t share any elements." 1700
1516B "AGAGA XOOORRR" "bitmasks,brute force,dp,greedy" "Baby Ehab is known for his love for a certain operation. He has an array a of length n, and he decided to keep doing the following operation on it:   he picks 2 adjacent elements; he then removes them and places a single integer in their place: their bitwise XOR. Note that the length of the array decreases by one. Now he asks you if he can make all elements of the array equal. Since babies like to make your life harder, he requires that you leave at least 2 elements remaining." 1500
1516A "Tit for Tat" greedy "Given an array a of length n, you can do at most k operations of the following type on it:  choose 2 different elements in the array, add 1 to the first, and subtract 1 from the second. However, all the elements of a have to remain non-negative after this operation. What is lexicographically the smallest array you can obtain?An array x is lexicographically smaller than an array y if there exists an index i such that xi<yi, and xj=yj for all 1\xe2\x89\xa4j<i. Less formally, at the first index i in which they differ, xi<yi." 800
1515I "Phoenix and Diamonds" "binary search,data structures,sortings" "Phoenix wonders what it is like to rob diamonds from a jewelry store!There are n types of diamonds. The i-th type has weight wi and value vi. The store initially has ai diamonds of the i-th type.Each day, for q days, one of the following will happen:   A new shipment of ki diamonds of type di arrive.  The store sells ki diamonds of type di.  Phoenix wonders what will happen if he robs the store using a bag that can fit diamonds with total weight not exceeding ci. If he greedily takes diamonds of the largest value that fit, how much value would be taken? If there are multiple diamonds with the largest value, he will take the one with minimum weight. If, of the diamonds with the largest value, there are multiple with the same minimum weight, he will take any of them. Of course, since Phoenix is a law-abiding citizen, this is all a thought experiment and he never actually robs any diamonds from the store. This means that queries of type 3 do not affect the diamonds in the store." 3400
1515H "Phoenix and Bits" "bitmasks,brute force,data structures,sortings" "Phoenix loves playing with bits \xe2\x80\x94 specifically, by using the bitwise operations AND, OR, and XOR. He has n integers a1,a2,\xe2\x80\xa6,an, and will perform q of the following queries:  replace all numbers ai where l\xe2\x89\xa4ai\xe2\x89\xa4r with ai AND x;  replace all numbers ai where l\xe2\x89\xa4ai\xe2\x89\xa4r with ai OR x;  replace all numbers ai where l\xe2\x89\xa4ai\xe2\x89\xa4r with ai XOR x;  output how many distinct integers ai where l\xe2\x89\xa4ai\xe2\x89\xa4r. For each query, Phoenix is given l, r, and x. Note that he is considering the values of the numbers, not their indices." 3500
1515G "Phoenix and Odometers" "dfs and similar,graphs,math,number theory" "In Fire City, there are n intersections and m one-way roads. The i-th road goes from intersection ai to bi and has length li miles. There are q cars that may only drive along those roads. The i-th car starts at intersection vi and has an odometer that begins at si, increments for each mile driven, and resets to 0 whenever it reaches ti. Phoenix has been tasked to drive cars along some roads (possibly none) and return them to their initial intersection with the odometer showing 0.For each car, please find if this is possible. A car may visit the same road or intersection an arbitrary number of times. The odometers don\'t stop counting the distance after resetting, so odometers may also be reset an arbitrary number of times." 2700
1515F "Phoenix and Earthquake" "constructive algorithms,dfs and similar,dsu,graphs,greedy,trees" "Phoenix\'s homeland, the Fire Nation had n cities that were connected by m roads, but the roads were all destroyed by an earthquake. The Fire Nation wishes to repair n\xe2\x88\x921 of these roads so that all the cities are connected again. The i-th city has ai tons of asphalt. x tons of asphalt are used up when repairing a road, and to repair a road between i and j, cities i and j must have at least x tons of asphalt between them. In other words, if city i had ai tons of asphalt and city j had aj tons, there would remain ai+aj\xe2\x88\x92x tons after repairing the road between them. Asphalt can be moved between cities if the road between them is already repaired.Please determine if it is possible to connect all the cities, and if so, output any sequence of roads to repair." 2600
1515E "Phoenix and Computers" combinatorics,dp,math "There are n computers in a row, all originally off, and Phoenix wants to turn all of them on. He will manually turn on computers one at a time. At any point, if computer i\xe2\x88\x921 and computer i+1 are both on, computer i (2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) will turn on automatically if it is not already on. Note that Phoenix cannot manually turn on a computer that already turned on automatically.If we only consider the sequence of computers that Phoenix turns on manually, how many ways can he turn on all the computers? Two sequences are distinct if either the set of computers turned on manually is distinct, or the order of computers turned on manually is distinct. Since this number may be large, please print it modulo M." 2200
1515D "Phoenix and Socks" "greedy,sortings,two pointers" "To satisfy his love of matching socks, Phoenix has brought his n socks (n is even) to the sock store. Each of his socks has a color ci and is either a left sock or right sock. Phoenix can pay one dollar to the sock store to either:   recolor a sock to any color c\xe2\x80\xb2 (1\xe2\x89\xa4c\xe2\x80\xb2\xe2\x89\xa4n)  turn a left sock into a right sock  turn a right sock into a left sock  The sock store may perform each of these changes any number of times. Note that the color of a left sock doesn\'t change when it turns into a right sock, and vice versa. A matching pair of socks is a left and right sock with the same color. What is the minimum cost for Phoenix to make n/2 matching pairs? Each sock must be included in exactly one matching pair." 1500
1515C "Phoenix and Towers" "constructive algorithms,data structures,greedy" "Phoenix has n blocks of height h1,h2,\xe2\x80\xa6,hn, and all hi don\'t exceed some value x. He plans to stack all n blocks into m separate towers. The height of a tower is simply the sum of the heights of its blocks. For the towers to look beautiful, no two towers may have a height difference of strictly more than x. Please help Phoenix build m towers that look beautiful. Each tower must have at least one block and all blocks must be used." 1400
1515B "Phoenix and Puzzle" "brute force,geometry,math,number theory" "Phoenix is playing with a new puzzle, which consists of n identical puzzle pieces. Each puzzle piece is a right isosceles triangle as shown below.  A puzzle piece The goal of the puzzle is to create a square using the n pieces. He is allowed to rotate and move the pieces around, but none of them can overlap and all n pieces must be used (of course, the square shouldn\'t contain any holes as well). Can he do it?" 1000
1515A "Phoenix and Gold" "constructive algorithms,greedy,math" "Phoenix has collected n pieces of gold, and he wants to weigh them together so he can feel rich. The i-th piece of gold has weight wi. All weights are distinct. He will put his n pieces of gold on a weight scale, one piece at a time. The scale has an unusual defect: if the total weight on it is exactly x, it will explode. Can he put all n gold pieces onto the scale in some order, without the scale exploding during the process? If so, help him find some possible order. Formally, rearrange the array w so that for each i (1\xe2\x89\xa4i\xe2\x89\xa4n), i\xe2\x88\x91j=1wj\xe2\x89\xa0x." 800
1514E "Baby Ehab\'s Hyper Apartment" "binary search,graphs,interactive,sortings,two pointers" "This is an interactive problem.Baby Ehab loves crawling around his apartment. It has nn rooms numbered from 00 to n\xe2\x88\x921n\xe2\x88\x921. For every pair of rooms, aa and bb, there\'s either a direct passage from room aa to room bb, or from room bb to room aa, but never both.Baby Ehab wants to go play with Baby Badawy. He wants to know if he could get to him. However, he doesn\'t know anything about his apartment except the number of rooms. He can ask the baby sitter two types of questions:   is the passage between room aa and room bb directed from aa to bb or the other way around?  does room xx have a passage towards any of the rooms s1s1, s2s2, ..., sksk? He can ask at most 9n9n queries of the first type and at most 2n2n queries of the second type.After asking some questions, he wants to know for every pair of rooms aa and bb whether there\'s a path from aa to bb or not. A path from aa to bb is a sequence of passages that starts from room aa and ends at room bb." 2700
1514D "Cut and Stick" "binary search,data structures,greedy,implementation,sortings" "Baby Ehab has a piece of Cut and Stick with an array a of length n written on it. He plans to grab a pair of scissors and do the following to it:  pick a range (l,r) and cut out every element al, al+1, ..., ar in this range;  stick some of the elements together in the same order they were in the array;  end up with multiple pieces, where every piece contains some of the elements and every element belongs to some piece. More formally, he partitions the sequence al, al+1, ..., ar into subsequences. He thinks a partitioning is beautiful if for every piece (subsequence) it holds that, if it has length x, then no value occurs strictly more than \xe2\x8c\x88x2\xe2\x8c\x89 times in it.He didn\'t pick a range yet, so he\'s wondering: for q ranges (l,r), what is the minimum number of pieces he needs to partition the elements al, al+1, ..., ar into so that the partitioning is beautiful.A sequence b is a subsequence of an array a if b can be obtained from a by deleting some (possibly zero) elements. Note that it does not have to be contiguous." 2000
1514C "Product 1 Modulo N" "greedy,number theory" "Now you get Baby Ehab\'s first words: ""Given an integer n, find the longest subsequence of [1,2,\xe2\x80\xa6,n\xe2\x88\x921] whose product is 1 modulo n."" Please solve the problem.A sequence b is a subsequence of an array a if b can be obtained from a by deleting some (possibly all) elements. The product of an empty subsequence is equal to 1." 1600
1514B "AND 0, Sum Big" bitmasks,combinatorics,math "Baby Badawy\'s first words were ""AND 0 SUM BIG"", so he decided to solve the following problem. Given two integers n and k, count the number of arrays of length n such that:  all its elements are integers between 0 and 2k\xe2\x88\x921 (inclusive);  the bitwise AND of all its elements is 0;  the sum of its elements is as large as possible. Since the answer can be very large, print its remainder when divided by 109+7." 1200
1514A "Perfectly Imperfect Array" "math,number theory" "Given an array a of length n, tell us whether it has a non-empty subsequence such that the product of its elements is not a perfect square.A sequence b is a subsequence of an array a if b can be obtained from a by deleting some (possibly zero) elements." 800
1513F "Swapping Problem" "brute force,constructive algorithms,data structures,sortings" "You are given 2 arrays a and b, both of size n. You can swap two elements in b at most once (or leave it as it is), and you are required to minimize the value \xe2\x88\x91i|ai\xe2\x88\x92bi|.Find the minimum possible value of this sum." 2500
1513E "Cost Equilibrium" "combinatorics,constructive algorithms,math,sortings" "An array is called beautiful if all the elements in the array are equal.You can transform an array using the following steps any number of times:   Choose two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n), and an integer x (1\xe2\x89\xa4x\xe2\x89\xa4ai). Let i be the source index and j be the sink index.  Decrease the i-th element by x, and increase the j-th element by x. The resulting values at i-th and j-th index are ai\xe2\x88\x92x and aj+x respectively.  The cost of this operation is x\xe2\x8b\x85|j\xe2\x88\x92i|.  Now the i-th index can no longer be the sink and the j-th index can no longer be the source.  The total cost of a transformation is the sum of all the costs in step 3.For example, array [0,2,3,3] can be transformed into a beautiful array [2,2,2,2] with total cost 1\xe2\x8b\x85|1\xe2\x88\x923|+1\xe2\x8b\x85|1\xe2\x88\x924|=5.An array is called balanced, if it can be transformed into a beautiful array, and the cost of such transformation is uniquely defined. In other words, the minimum cost of transformation into a beautiful array equals the maximum cost.You are given an array a1,a2,\xe2\x80\xa6,an of length n, consisting of non-negative integers. Your task is to find the number of balanced arrays which are permutations of the given array. Two arrays are considered different, if elements at some position differ. Since the answer can be large, output it modulo 109+7." 2300
1513D "GCD and MST" "constructive algorithms,dsu,graphs,greedy,number theory,sortings" "You are given an array a of n (n\xe2\x89\xa52) positive integers and an integer p. Consider an undirected weighted graph of n vertices numbered from 1 to n for which the edges between the vertices i and j (i<j) are added in the following manner:  If gcd(ai,ai+1,ai+2,\xe2\x80\xa6,aj)=min(ai,ai+1,ai+2,\xe2\x80\xa6,aj), then there is an edge of weight min(ai,ai+1,ai+2,\xe2\x80\xa6,aj) between i and j.  If i+1=j, then there is an edge of weight p between i and j. Here gcd(x,y,\xe2\x80\xa6) denotes the greatest common divisor (GCD) of integers x, y, ....Note that there could be multiple edges between i and j if both of the above conditions are true, and if both the conditions fail for i and j, then there is no edge between these vertices.The goal is to find the weight of the minimum spanning tree of this graph." 2000
1513C "Add One" dp,matrices "You are given an integer n. You have to apply m operations to it.In a single operation, you must replace every digit d of the number with the decimal representation of integer d+1. For example, 1912 becomes 21023 after applying the operation once.You have to find the length of n after applying m operations. Since the answer can be very large, print it modulo 109+7." 1600
1513B "AND Sequences" "bitmasks,combinatorics,constructive algorithms,math" "A sequence of n non-negative integers (n\xe2\x89\xa52) a1,a2,\xe2\x80\xa6,an is called good if for all i from 1 to n\xe2\x88\x921 the following condition holds true: a1&a2&\xe2\x80\xa6&ai=ai+1&ai+2&\xe2\x80\xa6&an, where & denotes the bitwise AND operation.You are given an array a of size n (n\xe2\x89\xa52). Find the number of permutations p of numbers ranging from 1 to n, for which the sequence ap1, ap2, ... ,apn is good. Since this number can be large, output it modulo 109+7." 1400
1513A "Array and Peaks" "constructive algorithms,implementation" "A sequence of n integers is called a permutation if it contains all integers from 1 to n exactly once.Given two integers n and k, construct a permutation a of numbers from 1 to n which has exactly k peaks. An index i of an array a of size n is said to be a peak if 1<i<n and ai>ai\xe2\x88\x921 and ai>ai+1. If such permutation is not possible, then print \xe2\x88\x921." 800
1512G "Short Task" "brute force,dp,math,number theory" "Let us denote by d(n) the sum of all divisors of the number n, i.e. d(n)=\xe2\x88\x91k|nk.For example, d(1)=1, d(4)=1+2+4=7, d(6)=1+2+3+6=12.For a given number c, find the minimum n such that d(n)=c." 1700
1512F Education "brute force,dp,greedy,implementation" "Polycarp is wondering about buying a new computer, which costs c tugriks. To do this, he wants to get a job as a programmer in a big company.There are n positions in Polycarp\'s company, numbered starting from one. An employee in position i earns a[i] tugriks every day. The higher the position number, the more tugriks the employee receives. Initially, Polycarp gets a position with the number 1 and has 0 tugriks.Each day Polycarp can do one of two things:   If Polycarp is in the position of x, then he can earn a[x] tugriks.  If Polycarp is in the position of x (x<n) and has at least b[x] tugriks, then he can spend b[x] tugriks on an online course and move to the position x+1. For example, if n=4, c=15, a=[1,3,10,11], b=[1,2,7], then Polycarp can act like this:   On the first day, Polycarp is in the 1-st position and earns 1 tugrik. Now he has 1 tugrik;  On the second day, Polycarp is in the 1-st position and move to the 2-nd position. Now he has 0 tugriks;  On the third day, Polycarp is in the 2-nd position and earns 3 tugriks. Now he has 3 tugriks;  On the fourth day, Polycarp is in the 2-nd position and is transferred to the 3-rd position. Now he has 1 tugriks;  On the fifth day, Polycarp is in the 3-rd position and earns 10 tugriks. Now he has 11 tugriks;  On the sixth day, Polycarp is in the 3-rd position and earns 10 tugriks. Now he has 21 tugriks;  Six days later, Polycarp can buy himself a new computer. Find the minimum number of days after which Polycarp will be able to buy himself a new computer." 1900
1512E "Permutation by Sum" "brute force,greedy,math" "A permutation is a sequence of n integers from 1 to n, in which all the numbers occur exactly once. For example, [1], [3,5,2,1,4], [1,3,2] are permutations, and [2,3,2], [4,3,1], [0] are not.Polycarp was given four integers n, l, r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and s (1\xe2\x89\xa4s\xe2\x89\xa4n(n+1)2) and asked to find a permutation p of numbers from 1 to n that satisfies the following condition:   s=pl+pl+1+\xe2\x80\xa6+pr. For example, for n=5, l=3, r=5, and s=8, the following permutations are suitable (not all options are listed):   p=[3,4,5,2,1];  p=[5,2,4,3,1];  p=[5,2,1,3,4].  But, for example, there is no permutation suitable for the condition above for n=4, l=1, r=1, and s=5.Help Polycarp, for the given n, l, r, and s, find a permutation of numbers from 1 to n that fits the condition above. If there are several suitable permutations, print any of them." 1600
1512D "Corrupted Array" "constructive algorithms,data structures,greedy" "You are given a number n and an array b1,b2,\xe2\x80\xa6,bn+2, obtained according to the following algorithm:   some array a1,a2,\xe2\x80\xa6,an was guessed;  array a was written to array b, i.e. bi=ai (1\xe2\x89\xa4i\xe2\x89\xa4n);  The (n+1)-th element of the array b is the sum of the numbers in the array a, i.e. bn+1=a1+a2+\xe2\x80\xa6+an;  The (n+2)-th element of the array b was written some number x (1\xe2\x89\xa4x\xe2\x89\xa4109), i.e. bn+2=x; The  array b was shuffled. For example, the array b=[2,3,7,12,2] it could be obtained in the following ways:   a=[2,2,3] and x=12;  a=[3,2,7] and x=2. For the given array b, find any array a that could have been guessed initially." 1200
1512C "A-B Palindrome" "constructive algorithms,implementation,strings" "You are given a string s consisting of the characters \'0\', \'1\', and \'?\'. You need to replace all the characters with \'?\' in the string s by \'0\' or \'1\' so that the string becomes a palindrome and has exactly a characters \'0\' and exactly b characters \'1\'. Note that each of the characters \'?\' is replaced independently from the others.A string t of length n is called a palindrome if the equality t[i]=t[n\xe2\x88\x92i+1] is true for all i (1\xe2\x89\xa4i\xe2\x89\xa4n).For example, if s=""01?????0"", a=4 and b=4, then you can replace the characters \'?\' in the following ways:   ""01011010"";  ""01100110"". For the given string s and the numbers a and b, replace all the characters with \'?\' in the string s by \'0\' or \'1\' so that the string becomes a palindrome and has exactly a characters \'0\' and exactly b characters \'1\'." 1200
1512B "Almost Rectangle" implementation "There is a square field of size n\xc3\x97n in which two cells are marked. These cells can be in the same row or column.You are to mark two more cells so that they are the corners of a rectangle with sides parallel to the coordinate axes.For example, if n=4 and a rectangular field looks like this (there are asterisks in the marked cells):..\xe2\x88\x97.....\xe2\x88\x97.......Then you can mark two more cells as follows\xe2\x88\x97.\xe2\x88\x97.....\xe2\x88\x97.\xe2\x88\x97.....If there are several possible solutions, then print any of them." 800
1512A "Spy Detected!" "brute force,implementation" "You are given an array a consisting of n (n\xe2\x89\xa53) positive integers. It is known that in this array, all the numbers except one are the same (for example, in the array [4,11,4,4] all numbers except one are equal to 4).Print the index of the element that does not equal others. The numbers in the array are numbered from one." 800
1511G "Chips on a Board" "bitmasks,brute force,data structures,dp,games,two pointers" "Alice and Bob have a rectangular board consisting of n rows and m columns. Each row contains exactly one chip.Alice and Bob play the following game. They choose two integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4m and cut the board in such a way that only the part of it between column l and column r (inclusive) remains. So, all columns to the left of column l and all columns to the right of column r no longer belong to the board.After cutting the board, they move chips on the remaining part of the board (the part from column l to column r). They make alternating moves, and the player which cannot make a move loses the game. The first move is made by Alice, the second \xe2\x80\x94 by Bob, the third \xe2\x80\x94 by Alice, and so on. During their move, the player must choose one of the chips from the board and move it any positive number of cells to the left (so, if the chip was in column i, it can move to any column j<i, and the chips in the leftmost column cannot be chosen).Alice and Bob have q pairs of numbers Li and Ri. For each such pair, they want to determine who will be the winner of the game if l=Li and r=Ri. Note that these games should be considered independently (they don\'t affect the state of the board for the next games), and both Alice and Bob play optimally." 2700
1511F Chainword "brute force,data structures,dp,matrices,string suffix structures,strings" "A chainword is a special type of crossword. As most of the crosswords do, it has cells that you put the letters in and some sort of hints to what these letters should be.The letter cells in a chainword are put in a single row. We will consider chainwords of length m in this task.A hint to a chainword is a sequence of segments such that the segments don\'t intersect with each other and cover all m letter cells. Each segment contains a description of the word in the corresponding cells.The twist is that there are actually two hints: one sequence is the row above the letter cells and the other sequence is the row below the letter cells. When the sequences are different, they provide a way to resolve the ambiguity in the answers.You are provided with a dictionary of n words, each word consists of lowercase Latin letters. All words are pairwise distinct.An instance of a chainword is the following triple:   a string of m lowercase Latin letters;  the first hint: a sequence of segments such that the letters that correspond to each segment spell a word from the dictionary;  the second hint: another sequence of segments such that the letters that correspond to each segment spell a word from the dictionary. Note that the sequences of segments don\'t necessarily have to be distinct.Two instances of chainwords are considered different if they have different strings, different first hints or different second hints.Count the number of different instances of chainwords. Since the number might be pretty large, output it modulo 998244353." 2700
1511E "Colorings and Dominoes" combinatorics,dp,greedy,math "You have a large rectangular board which is divided into n\xc3\x97m cells (the board has n rows and m columns). Each cell is either white or black.You paint each white cell either red or blue. Obviously, the number of different ways to paint them is 2w, where w is the number of white cells.After painting the white cells of the board, you want to place the maximum number of dominoes on it, according to the following rules:  each domino covers two adjacent cells;  each cell is covered by at most one domino;  if a domino is placed horizontally (it covers two adjacent cells in one of the rows), it should cover only red cells;  if a domino is placed vertically (it covers two adjacent cells in one of the columns), it should cover only blue cells. Let the value of the board be the maximum number of dominoes you can place. Calculate the sum of values of the board over all 2w possible ways to paint it. Since it can be huge, print it modulo 998244353." 2100
1511D "Min Cost String" "brute force,constructive algorithms,graphs,greedy,strings" "Let\'s define the cost of a string s as the number of index pairs i and j (1\xe2\x89\xa4i<j<|s|) such that si=sj and si+1=sj+1.You are given two positive integers n and k. Among all strings with length n that contain only the first k characters of the Latin alphabet, find a string with minimum possible cost. If there are multiple such strings with minimum cost \xe2\x80\x94 find any of them." 1600
1511C "Yet Another Card Deck" "brute force,data structures,implementation,trees" "You have a card deck of n cards, numbered from top to bottom, i. e. the top card has index 1 and bottom card \xe2\x80\x94 index n. Each card has its color: the i-th card has color ai.You should process q queries. The j-th query is described by integer tj. For each query you should:   find the highest card in the deck with color tj, i. e. the card with minimum index;  print the position of the card you found;  take the card and place it on top of the deck." 1100
1511B "GCD Length" "constructive algorithms,math,number theory" "You are given three integers a, b and c.Find two positive integers x and y (x>0, y>0) such that:   the decimal representation of x without leading zeroes consists of a digits;  the decimal representation of y without leading zeroes consists of b digits;  the decimal representation of gcd(x,y) without leading zeroes consists of c digits. gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y.Output x and y. If there are multiple answers, output any of them." 1100
1511A "Review Site" greedy "You are an upcoming movie director, and you have just released your first movie. You have also launched a simple review site with two buttons to press \xe2\x80\x94 upvote and downvote.However, the site is not so simple on the inside. There are two servers, each with its separate counts for the upvotes and the downvotes.n reviewers enter the site one by one. Each reviewer is one of the following types:   type 1: a reviewer has watched the movie, and they like it \xe2\x80\x94 they press the upvote button;  type 2: a reviewer has watched the movie, and they dislike it \xe2\x80\x94 they press the downvote button;  type 3: a reviewer hasn\'t watched the movie \xe2\x80\x94 they look at the current number of upvotes and downvotes of the movie on the server they are in and decide what button to press. If there are more downvotes than upvotes, then a reviewer downvotes the movie. Otherwise, they upvote the movie. Each reviewer votes on the movie exactly once.Since you have two servers, you can actually manipulate the votes so that your movie gets as many upvotes as possible. When a reviewer enters a site, you know their type, and you can send them either to the first server or to the second one.What is the maximum total number of upvotes you can gather over both servers if you decide which server to send each reviewer to?" 800
1510K "King\'s Task" "brute force,graphs,implementation" "The brave Knight came to the King and asked permission to marry the princess. The King knew that the Knight was brave, but he also wanted to know if he was smart enough. So he asked him to solve the following task.There is a permutation pi of numbers from 1 to 2n. You can make two types of operations.   Swap p1 and p2, p3 and p4, ..., p2n\xe2\x88\x921 and p2n.  Swap p1 and pn+1, p2 and pn+2, ..., pn and p2n. The task is to find the minimal number of operations required to sort the given permutation.The Knight was not that smart actually, but quite charming, so the princess asks you to help him to solve the King\'s task." 1200
1510J "Japanese Game" "constructive algorithms,math" "Joseph really likes the culture of Japan. Last year he learned Japanese traditional clothes and visual arts and now he is trying to find out the secret of the Japanese game called Nonogram.In the one-dimensional version of the game, there is a row of n empty cells, some of which are to be filled with a pen. There is a description of a solution called a profile \xe2\x80\x94 a sequence of positive integers denoting the lengths of consecutive sets of filled cells. For example, the profile of [4,3,1] means that there are sets of four, three, and one filled cell, in that order, with at least one empty cell between successive sets. A suitable solution for n=12 and p=[4,3,1].  A wrong solution: the first four filled cells should be consecutive.  A wrong solution: there should be at least one empty cell before the last filled cell. Joseph found out that for some numbers n and profiles p there are lots of ways to fill the cells to satisfy the profile. Now he is in the process of solving a nonogram consisting of n cells and a profile p. He has already created a mask of p \xe2\x80\x94 he has filled all the cells that must be filled in every solution of the nonogram. The mask for n=12 and p=[4,3,1]: all the filled cells above are filled in every solution. After a break, he lost the source profile p. He only has n and the mask m. Help Joseph find any profile p\xe2\x80\xb2 with the mask m or say that there is no such profile and Joseph has made a mistake." 2700
1510I "Is It Rated?" greedy,interactive,math,probabilities "The popular improv website Interpretation Impetus hosts regular improv contests and maintains a rating of the best performers. However, since improv can often go horribly wrong, the website is notorious for declaring improv contests unrated. It now holds a wager before each improv contest where the participants try to predict whether it will be rated or unrated, and they are now more popular than the improv itself.Izzy and n other participants take part in each wager. First, they each make their prediction, expressed as 1 (""rated"") or 0 (""unrated""). Izzy always goes last, so she knows the predictions of the other participants when making her own. Then, the actual competition takes place and it is declared either rated or unrated.You need to write a program that will interactively play as Izzy. There will be m wagers held in 2021, and Izzy\'s goal is to have at most 1.3\xe2\x8b\x85b+100 wrong predictions after all those wagers, where b is the smallest number of wrong predictions that any other wager participant will have after all those wagers. The number b is not known in advance. Izzy also knows nothing about the other participants \xe2\x80\x94 they might somehow always guess correctly, or their predictions might be correlated. Izzy\'s predictions, though, do not affect the predictions of the other participants and the decision on the contest being rated or not \xe2\x80\x94 in other words, in each test case, your program always receives the same inputs, no matter what it outputs." 2700
1510H "Hard Optimization" dp "You are given a set of n segments on a line [Li;Ri]. All 2n segment endpoints are pairwise distinct integers.The set is laminar \xe2\x80\x94 any two segments are either disjoint or one of them contains the other.Choose a non-empty subsegment [li,ri] with integer endpoints in each segment (Li\xe2\x89\xa4li<ri\xe2\x89\xa4Ri) in such a way that no two subsegments intersect (they are allowed to have common endpoints though) and the sum of their lengths (\xe2\x88\x91ni=1ri\xe2\x88\x92li) is maximized." 3200
1510F "Fiber Shape" NA "Imagine a board with n pins put into it, the i-th pin is located at (xi,yi). For simplicity, we will restrict the problem to the case where the pins are placed in vertices of a convex polygon.Then, take a non-stretchable string of length l, and put it around all the pins. Place a pencil inside the string and draw a curve around the pins, trying to pull the string in every possible direction. The picture below shows an example of a string tied around the pins and pulled by a pencil (a point P).  Your task is to find an area inside this curve. Formally, for a given convex polygon S and a length l let\'s define a fiber shape F(S,l) as a set of points t such that the perimeter of the convex hull of S\xe2\x88\xaa{t} does not exceed l. Find an area of F(S,l)." 2800
1510D Digits "dp,math,number theory" "Diana loves playing with numbers. She\'s got n cards with positive integer numbers ai written on them. She spends her free time multiplying the numbers on the cards. She picks a non-empty subset of the cards and multiplies all the numbers ai written on them.Diana is happy when the product of the numbers ends with her favorite digit d. Now she is curious what cards she should pick so that the product of the numbers on them is the largest possible and the last decimal digit of the product is d. Please, help her." 2100
1510C "Cactus Not Enough" "dfs and similar,graph matchings,graphs" "There was no problem about a cactus at the NERC 2020 online round. That\'s a bad mistake, so judges decided to fix it. You shall not pass to the World Finals 2021 without solving a problem about a cactus!A cactus is a connected undirected graph in which every edge lies on at most one simple cycle. Intuitively, a cactus is a generalization of a tree where some cycles are allowed. Multiedges (multiple edges between a pair of vertices) and loops (edges that connect a vertex to itself) are not allowed in a cactus. Cher has got a cactus. She calls cactus strong if it is impossible to add an edge to it in such a way that it still remains a cactus. But Cher thinks her cactus is not strong enough. She wants to add the smallest possible number of edges to it to make it strong, i. e. to create a new cactus with the same vertices, so that the original cactus is a subgraph of the new one, and it is impossible to add another edge to it so that the graph remains a cactus. Cher hired you to do this job for her. So... it\'s on you!" 2900
1510B "Button Lock" "flows,graph matchings,graphs" "You are standing in front of the room with great treasures. The only thing stopping you is the door with a push-button combination lock. This lock has d buttons with digits from 0 to d\xe2\x88\x921. Whenever you press a button, it stays pushed down. You can not pop back up just one button, but there is a ""RESET"" button \xe2\x80\x94 pressing it pops up all other buttons. Initially, no buttons are pushed down.The door instantly opens when some specific set of digits is pushed down. Sadly, you don\'t know the password for it. Having read the documentation for this specific lock, you found out that there are n possible passwords for this particular lock. Find the shortest sequence of button presses, such that all possible passwords appear at least once during its execution. Any shortest correct sequence of button presses will be accepted." 2600
1509C "The Sports Festival" dp,greedy "The student council is preparing for the relay race at the sports festival.The council consists of n members. They will run one after the other in the race, the speed of member i is si. The discrepancy di of the i-th stage is the difference between the maximum and the minimum running speed among the first i members who ran. Formally, if ai denotes the speed of the i-th member who participated in the race, then di=max(a1,a2,\xe2\x80\xa6,ai)\xe2\x88\x92min(a1,a2,\xe2\x80\xa6,ai).You want to minimize the sum of the discrepancies d1+d2+\xe2\x8b\xaf+dn. To do this, you are allowed to change the order in which the members run. What is the minimum possible sum that can be achieved?" 1800
1509B "TMT Document" greedy "The student council has a shared document file. Every day, some members of the student council write the sequence TMT (short for Towa Maji Tenshi) in it.However, one day, the members somehow entered the sequence into the document at the same time, creating a jumbled mess. Therefore, it is Suguru Doujima\'s task to figure out whether the document has malfunctioned. Specifically, he is given a string of length n whose characters are all either T or M, and he wants to figure out if it is possible to partition it into some number of disjoint subsequences, all of which are equal to TMT. That is, each character of the string should belong to exactly one of the subsequences.A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero) characters." 1100
1509A "Average Height" "constructive algorithms" "Sayaka Saeki is a member of the student council, which has n other members (excluding Sayaka). The i-th member has a height of ai millimeters.It\'s the end of the school year and Sayaka wants to take a picture of all other members of the student council. Being the hard-working and perfectionist girl as she is, she wants to arrange all the members in a line such that the amount of photogenic consecutive pairs of members is as large as possible.A pair of two consecutive members u and v on a line is considered photogenic if their average height is an integer, i.e. au+av2 is an integer.Help Sayaka arrange the other members to maximize the number of photogenic consecutive pairs." 800
1508F "Optimal Encoding" "brute force,data structures" "Touko\'s favorite sequence of numbers is a permutation a1,a2,\xe2\x80\xa6,an of 1,2,\xe2\x80\xa6,n, and she wants some collection of permutations that are similar to her favorite permutation.She has a collection of q intervals of the form [li,ri] with 1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n. To create permutations that are similar to her favorite permutation, she coined the following definition:  A permutation b1,b2,\xe2\x80\xa6,bn allows an interval [l\xe2\x80\xb2,r\xe2\x80\xb2] to holds its shape if for any pair of integers (x,y) such that l\xe2\x80\xb2\xe2\x89\xa4x<y\xe2\x89\xa4r\xe2\x80\xb2, we have bx<by if and only if ax<ay.  A permutation b1,b2,\xe2\x80\xa6,bn is k-similar if b allows all intervals [li,ri] for all 1\xe2\x89\xa4i\xe2\x89\xa4k to hold their shapes. Yuu wants to figure out all k-similar permutations for Touko, but it turns out this is a very hard task; instead, Yuu will encode the set of all k-similar permutations with directed acylic graphs (DAG). Yuu also coined the following definitions for herself:  A permutation b1,b2,\xe2\x80\xa6,bn satisfies a DAG G\xe2\x80\xb2 if for all edge u\xe2\x86\x92v in G\xe2\x80\xb2, we must have bu<bv.  A k-encoding is a DAG Gk on the set of vertices 1,2,\xe2\x80\xa6,n such that a permutation b1,b2,\xe2\x80\xa6,bn satisfies Gk if and only if b is k-similar. Since Yuu is free today, she wants to figure out the minimum number of edges among all k-encodings for each k from 1 to q." 3500
1508E "Tree Calendar" "brute force,constructive algorithms,data structures,dfs and similar,sortings,trees" "Yuu Koito and Touko Nanami are newlyweds! On the wedding day, Yuu gifted Touko a directed tree with n nodes and rooted at 1, and a labeling a which is some DFS order of the tree. Every edge in this tree is directed away from the root.After calling dfs(1) the following algorithm returns a as a DFS order of a tree rooted at 1 :order := 0a := array of length n function dfs(u):    order := order + 1    a[u] := order    for all v such that there is a directed edge (u -> v):        dfs(v)Note that there may be different DFS orders for a given tree.Touko likes the present so much she decided to play with it! On each day following the wedding day, Touko performs this procedure once: Among all directed edges u\xe2\x86\x92v such that au<av, select the edge u\xe2\x80\xb2\xe2\x86\x92v\xe2\x80\xb2 with the lexicographically smallest pair (au\xe2\x80\xb2,av\xe2\x80\xb2).  Swap au\xe2\x80\xb2 and av\xe2\x80\xb2.Days have passed since their wedding, and Touko has somehow forgotten which date the wedding was and what was the original labeling a! Fearing that Yuu might get angry, Touko decided to ask you to derive these two pieces of information using the current labeling.Being her good friend, you need to find the number of days that have passed since the wedding, and the original labeling of the tree. However, there is a chance that Touko might have messed up her procedures, which result in the current labeling being impossible to obtain from some original labeling; in that case, please inform Touko as well." 3100
1508D "Swap Pass" "constructive algorithms,geometry,sortings" "Based on a peculiar incident at basketball practice, Akari came up with the following competitive programming problem!You are given n points on the plane, no three of which are collinear. The i-th point initially has a label ai, in such a way that the labels a1,a2,\xe2\x80\xa6,an form a permutation of 1,2,\xe2\x80\xa6,n.You are allowed to modify the labels through the following operation:  Choose two distinct integers i and j between 1 and n.  Swap the labels of points i and j, and finally  Draw the segment between points i and j. A sequence of operations is valid if after applying all of the operations in the sequence in order, the k-th point ends up having the label k for all k between 1 and n inclusive, and the drawn segments don\'t intersect each other internally. Formally, if two of the segments intersect, then they must do so at a common endpoint of both segments.In particular, all drawn segments must be distinct.Find any valid sequence of operations, or say that none exist." 3000
1508C "Complete the MST" "bitmasks,brute force,data structures,dfs and similar,dsu,graphs,greedy,trees" "As a teacher, Riko Hakozaki often needs to help her students with problems from various subjects. Today, she is asked a programming task which goes as follows.You are given an undirected complete graph with n nodes, where some edges are pre-assigned with a positive weight while the rest aren\'t. You need to assign all unassigned edges with non-negative weights so that in the resulting fully-assigned complete graph the XOR sum of all weights would be equal to 0.Define the ugliness of a fully-assigned complete graph the weight of its minimum spanning tree, where the weight of a spanning tree equals the sum of weights of its edges. You need to assign the weights so that the ugliness of the resulting graph is as small as possible.As a reminder, an undirected complete graph with n nodes contains all edges (u,v) with 1\xe2\x89\xa4u<v\xe2\x89\xa4n; such a graph has n(n\xe2\x88\x921)2 edges.She is not sure how to solve this problem, so she asks you to solve it for her." 2500
1508B "Almost Sorted" "binary search,combinatorics,constructive algorithms,implementation" "Seiji Maki doesn\'t only like to observe relationships being unfolded, he also likes to observe sequences of numbers, especially permutations. Today, he has his eyes on almost sorted permutations.A permutation a1,a2,\xe2\x80\xa6,an of 1,2,\xe2\x80\xa6,n is said to be almost sorted if the condition ai+1\xe2\x89\xa5ai\xe2\x88\x921 holds for all i between 1 and n\xe2\x88\x921 inclusive.Maki is considering the list of all almost sorted permutations of 1,2,\xe2\x80\xa6,n, given in lexicographical order, and he wants to find the k-th permutation in this list. Can you help him to find such permutation?Permutation p is lexicographically smaller than a permutation q if and only if the following holds: in the first position where p and q differ, the permutation p has a smaller element than the corresponding element in q." 1800
1508A "Binary Literature" "constructive algorithms,greedy,implementation,strings,two pointers" "A bitstring is a string that contains only the characters 0 and 1.Koyomi Kanou is working hard towards her dream of becoming a writer. To practice, she decided to participate in the Binary Novel Writing Contest. The writing prompt for the contest consists of three bitstrings of length 2n. A valid novel for the contest is a bitstring of length at most 3n that contains at least two of the three given strings as subsequences.Koyomi has just received the three prompt strings from the contest organizers. Help her write a valid novel for the contest.A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero) characters." 1900
1506G "Maximize the Remaining String" "brute force,data structures,dp,greedy,strings" "You are given a string s, consisting of lowercase Latin letters. While there is at least one character in the string s that is repeated at least twice, you perform the following operation:   you choose the index i (1\xe2\x89\xa4i\xe2\x89\xa4|s|) such that the character at position i occurs at least two times in the string s, and delete the character at position i, that is, replace s with s1s2\xe2\x80\xa6si\xe2\x88\x921si+1si+2\xe2\x80\xa6sn. For example, if s=""codeforces"", then you can apply the following sequence of operations:   i=6\xe2\x87\x92s=""codefrces"";  i=1\xe2\x87\x92s=""odefrces"";  i=7\xe2\x87\x92s=""odefrcs""; Given a given string s, find the lexicographically maximum string that can be obtained after applying a certain sequence of operations after which all characters in the string become unique.A string a of length n is lexicographically less than a string b of length m, if:   there is an index i (1\xe2\x89\xa4i\xe2\x89\xa4min(n,m)) such that the first i\xe2\x88\x921 characters of the strings a and b are the same, and the i-th character of the string a is less than i-th character of string b;  or the first min(n,m) characters in the strings a and b are the same and n<m. For example, the string a=""aezakmi"" is lexicographically less than the string b=""aezus""." 2000
1506F "Triangular Paths" "constructive algorithms,graphs,math,shortest paths,sortings" "Consider an infinite triangle made up of layers. Let\'s number the layers, starting from one, from the top of the triangle (from top to bottom). The k-th layer of the triangle contains k points, numbered from left to right. Each point of an infinite triangle is described by a pair of numbers (r,c) (1\xe2\x89\xa4c\xe2\x89\xa4r), where r is the number of the layer, and c is the number of the point in the layer. From each point (r,c) there are two directed edges to the points (r+1,c) and (r+1,c+1), but only one of the edges is activated. If r+c is even, then the edge to the point (r+1,c) is activated, otherwise the edge to the point (r+1,c+1) is activated. Look at the picture for a better understanding.  Activated edges are colored in black. Non-activated edges are colored in gray. From the point (r1,c1) it is possible to reach the point (r2,c2), if there is a path between them only from activated edges. For example, in the picture above, there is a path from (1,1) to (3,2), but there is no path from (2,1) to (1,1).Initially, you are at the point (1,1). For each turn, you can:   Replace activated edge for point (r,c). That is if the edge to the point (r+1,c) is activated, then instead of it, the edge to the point (r+1,c+1) becomes activated, otherwise if the edge to the point (r+1,c+1), then instead if it, the edge to the point (r+1,c) becomes activated. This action increases the cost of the path by 1;  Move from the current point to another by following the activated edge. This action does not increase the cost of the path. You are given a sequence of n points of an infinite triangle (r1,c1),(r2,c2),\xe2\x80\xa6,(rn,cn). Find the minimum cost path from (1,1), passing through all n points in arbitrary order." 2000
1506E "Restoring the Permutation" "constructive algorithms,implementation" "A permutation is a sequence of n integers from 1 to n, in which all numbers occur exactly once. For example, [1], [3,5,2,1,4], [1,3,2] are permutations, and [2,3,2], [4,3,1], [0] are not.Polycarp was presented with a permutation p of numbers from 1 to n. However, when Polycarp came home, he noticed that in his pocket, the permutation p had turned into an array q according to the following rule:   qi=max(p1,p2,\xe2\x80\xa6,pi). Now Polycarp wondered what lexicographically minimal and lexicographically maximal permutations could be presented to him.An array a of length n is lexicographically smaller than an array b of length n if there is an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that the first i\xe2\x88\x921 elements of arrays a and b are the same, and the i-th element of the array a is less than the i-th element of the array b. For example, the array a=[1,3,2,3] is lexicographically smaller than the array b=[1,3,4,2].For example, if n=7 and p=[3,2,4,1,7,5,6], then q=[3,3,4,4,7,7,7] and the following permutations could have been as p initially:   [3,1,4,2,7,5,6] (lexicographically minimal permutation);  [3,1,4,2,7,6,5];  [3,2,4,1,7,5,6];  [3,2,4,1,7,6,5] (lexicographically maximum permutation). For a given array q, find the lexicographically minimal and lexicographically maximal permutations that could have been originally presented to Polycarp." 1500
1506D "Epic Transformation" "constructive algorithms,data structures,greedy" "You are given an array a of length n consisting of integers. You can apply the following operation, consisting of several steps, on the array a zero or more times:   you select two different numbers in the array ai and aj;  you remove i-th and j-th elements from the array. For example, if n=6 and a=[1,6,1,1,4,4], then you can perform the following sequence of operations:   select i=1,j=5. The array a becomes equal to [6,1,1,4];  select i=1,j=2. The array a becomes equal to [1,4]. What can be the minimum size of the array after applying some sequence of operations to it?" 1400
1506C "Double-ended Strings" "brute force,implementation,strings" "You are given the strings a and b, consisting of lowercase Latin letters. You can do any number of the following operations in any order:   if |a|>0 (the length of the string a is greater than zero), delete the first character of the string a, that is, replace a with a2a3\xe2\x80\xa6an;  if |a|>0, delete the last character of the string a, that is, replace a with a1a2\xe2\x80\xa6an\xe2\x88\x921;  if |b|>0 (the length of the string b is greater than zero), delete the first character of the string b, that is, replace b with b2b3\xe2\x80\xa6bn;  if |b|>0, delete the last character of the string b, that is, replace b with b1b2\xe2\x80\xa6bn\xe2\x88\x921. Note that after each of the operations, the string a or b may become empty.For example, if a=""hello"" and b=""icpc"", then you can apply the following sequence of operations:   delete the first character of the string a \xe2\x87\x92 a=""ello"" and b=""icpc"";  delete the first character of the string b \xe2\x87\x92 a=""ello"" and b=""cpc"";  delete the first character of the string b \xe2\x87\x92 a=""ello"" and b=""pc"";  delete the last character of the string a \xe2\x87\x92 a=""ell"" and b=""pc"";  delete the last character of the string b \xe2\x87\x92 a=""ell"" and b=""p"". For the given strings a and b, find the minimum number of operations for which you can make the strings a and b equal. Note that empty strings are also equal." 1000
1506B "Partial Replacement" greedy,implementation "You are given a number k and a string s of length n, consisting of the characters \'.\' and \'*\'. You want to replace some of the \'*\' characters with \'x\' characters so that the following conditions are met:   The first character \'*\' in the original string should be replaced with \'x\';  The last character \'*\' in the original string should be replaced with \'x\';  The distance between two neighboring replaced characters \'x\' must not exceed k (more formally, if you replaced characters at positions i and j (i<j) and at positions [i+1,j\xe2\x88\x921] there is no ""x"" symbol, then j\xe2\x88\x92i must be no more than k). For example, if n=7, s=.**.*** and k=3, then the following strings will satisfy the conditions above:   .xx.*xx;  .x*.x*x;  .xx.xxx.  But, for example, the following strings will not meet the conditions:   .**.*xx (the first character \'*\' should be replaced with \'x\');  .x*.xx* (the last character \'*\' should be replaced with \'x\');  .x*.*xx (the distance between characters at positions 2 and 6 is greater than k=3). Given n, k, and s, find the minimum number of \'*\' characters that must be replaced with \'x\' in order to meet the above conditions." 1100
1506A "Strange Table" math "Polycarp found a rectangular table consisting of n rows and m columns. He noticed that each cell of the table has its number, obtained by the following algorithm ""by columns"":   cells are numbered starting from one;  cells are numbered from left to right by columns, and inside each column from top to bottom;  number of each cell is an integer one greater than in the previous cell. For example, if n=3 and m=5, the table will be numbered as follows:147101325811143691215However, Polycarp considers such numbering inconvenient. He likes the numbering ""by rows"":   cells are numbered starting from one;  cells are numbered from top to bottom by rows, and inside each row from left to right;  number of each cell is an integer one greater than the number of the previous cell. For example, if n=3 and m=5, then Polycarp likes the following table numbering: 123456789101112131415Polycarp doesn\'t have much time, so he asks you to find out what would be the cell number in the numbering ""by rows"", if in the numbering ""by columns"" the cell has the number x?" 800
1505I "Mysterious language again, seriously?" "*special problem" "You are given a mysterious language (codenamed ""Secret 2021"") available in ""Custom Test"" tab. Find out what this language is and write a program which outputs its name. Note that the program must be written in this language." 2200
1505H "L BREAK into program" "*special problem" "Hack the program and get the password hidden in it." 2500
1505G "Encoded message" "*special problem,implementation" "InputThe first line of the input contains a single integer N (1\xe2\x89\xa4N\xe2\x89\xa424). The next N lines contain 5 space-separated integers each. The first three integers will be between 0 and 2, inclusive. The last two integers will be between 0 and 3, inclusive. The sum of the first three integers will be equal to the sum of the last two integers.OutputOutput the result \xe2\x80\x93 a string of lowercase English letters.ExamplesInputCopy11 0 0 1 0OutputCopyaInputCopy102 0 0 1 11 1 1 2 12 1 0 1 21 1 0 1 12 1 0 2 11 1 1 2 11 2 1 3 12 0 0 1 11 1 0 1 11 1 2 2 2OutputCopycodeforcez" 2600
1505F Math "*special problem,math" "*The two images are equivalent, feel free to use either one." 2200
1505E Cakewalk "*special problem,greedy,implementation,shortest paths" "A mouse encountered a nice big cake and decided to take a walk across it, eating the berries on top of the cake on its way. The cake is rectangular, neatly divided into squares; some of the squares have a berry in them, and some don\'t.The mouse is in a bit of a hurry, though, so once she enters the cake from its northwest corner (the top left cell in the input data), she will only go east (right) or south (down), until she reaches the southeast corner (the bottom right cell). She will eat every berry in the squares she passes through, but not in the other squares.The mouse tries to choose her path so as to maximize the number of berries consumed. However, her haste and hunger might be clouding her judgement, leading her to suboptimal decisions..." 1800
1505D "Xenolith? Hippodrome?" "*special problem,number theory" "InputThe input contains two integers N, M (1\xe2\x89\xa4N\xe2\x89\xa41024,2\xe2\x89\xa4M\xe2\x89\xa416), separated by a single space.OutputOutput ""YES"" or ""NO"".ExamplesInputCopy2 3OutputCopyYESInputCopy3 2OutputCopyNOInputCopy33 16OutputCopyYESInputCopy26 5OutputCopyNO" 1800
1505C "Fibonacci Words" "*special problem,implementation" "InputThe input consists of a single string of uppercase letters A-Z. The length of the string is between 1 and 10 characters, inclusive.OutputOutput ""YES"" or ""NO"".ExamplesInputCopyHELPOutputCopyYESInputCopyAIDOutputCopyNOInputCopyMARYOutputCopyNOInputCopyANNAOutputCopyYESInputCopyMUGOutputCopyYESInputCopyCUPOutputCopyNOInputCopySUMOutputCopyYESInputCopyPRODUCTOutputCopyNO" 1400
1505B DMCA "*special problem,implementation,number theory" "Many people are aware of DMCA \xe2\x80\x93 Digital Millennium Copyright Act. But another recently proposed DMCA \xe2\x80\x93 Digital Millennium Calculation Act \xe2\x80\x93 is much less known.In this problem you need to find a root of a number according to this new DMCA law." 1600
1505A "Is it rated - 2" "*special problem,implementation,interactive" "InteractionThis is an interactive problem. You need to read participants\' queries from standard input and print your responses to standard output. You don\'t know the number of queries upfront, so you\'ll need to process them as you get them; you\'ll know you\'re done once you reach the end of the file.In each query, you will be asked the question, written in one line. You have to answer it correctly, patiently and without any display of emotions. Your response is case-insensitive.Please make sure to use the stream flushing operation after each response in order not to leave part of your output in some buffer.ExampleInputCopyIs it rated?Is it rated?Is it rated?OutputCopyNONONO" 900
1504B "Flip the Bits" "constructive algorithms,greedy,implementation,math" "There is a binary string a of length n. In one operation, you can select any prefix of a with an equal number of 0 and 1 symbols. Then all symbols in the prefix are inverted: each 0 becomes 1 and each 1 becomes 0.For example, suppose a=0111010000.   In the first operation, we can select the prefix of length 8 since it has four 0\'s and four 1\'s: [01110100]00\xe2\x86\x92[10001011]00.  In the second operation, we can select the prefix of length 2 since it has one 0 and one 1: [10]00101100\xe2\x86\x92[01]00101100.  It is illegal to select the prefix of length 4 for the third operation, because it has three 0\'s and one 1. Can you transform the string a into the string b using some finite number of operations (possibly, none)?" 1200
1504A "D\xc3\xa9j\xc3\xa0 Vu" "constructive algorithms,strings" "A palindrome is a string that reads the same backward as forward. For example, the strings ""z"", ""aaa"", ""aba"", and ""abccba"" are palindromes, but ""codeforces"" and ""ab"" are not. You hate palindromes because they give you d\xc3\xa9j\xc3\xa0 vu.There is a string s. You must insert exactly one character \'a\' somewhere in s. If it is possible to create a string that is not a palindrome, you should find one example. Otherwise, you should report that it is impossible.For example, suppose s= ""cbabc"". By inserting an \'a\', you can create ""acbabc"", ""cababc"", ""cbaabc"", ""cbabac"", or ""cbabca"". However ""cbaabc"" is a palindrome, so you must output one of the other options." 800
1503F "Balance the Cards" "constructive algorithms,data structures,divide and conquer,geometry,graphs,implementation" "A balanced bracket sequence is defined as an integer sequence that can be built with the following rules:  The empty sequence is balanced.  If [a1,\xe2\x80\xa6,an] and [b1,\xe2\x80\xa6,bm] are balanced, then their concatenation [a1,\xe2\x80\xa6,an,b1,\xe2\x80\xa6,bm] is balanced.  If x is a positive integer and [a1,\xe2\x80\xa6,an] is balanced, then [x,a1,\xe2\x80\xa6,an,\xe2\x88\x92x] is balanced. The positive numbers can be imagined as opening brackets and the negative numbers as closing brackets, where matching brackets must have the same type (absolute value). For example, [1,2,\xe2\x88\x922,\xe2\x88\x921] and [1,3,\xe2\x88\x923,2,\xe2\x88\x922,\xe2\x88\x921] are balanced, but [1,2,\xe2\x88\x921,\xe2\x88\x922] and [\xe2\x88\x921,1] are not balanced.There are 2n cards. Each card has a number on the front and a number on the back. Each integer 1,\xe2\x88\x921,2,\xe2\x88\x922,\xe2\x80\xa6,n,\xe2\x88\x92n appears exactly once on the front of some card and exactly once on the back of some (not necessarily the same) card.You can reorder the cards however you like. You are not allowed to flip cards, so numbers cannot move between the front and back. Your task is to order the cards so that the sequences given by the front numbers and the back numbers are both balanced, or report that it is impossible." 3500
1503E 2-Coloring combinatorics,dp,math "There is a grid with n rows and m columns. Every cell of the grid should be colored either blue or yellow.A coloring of the grid is called stupid if every row has exactly one segment of blue cells and every column has exactly one segment of yellow cells.In other words, every row must have at least one blue cell, and all blue cells in a row must be consecutive. Similarly, every column must have at least one yellow cell, and all yellow cells in a column must be consecutive.  An example of a stupid coloring.   Examples of clever colorings. The first coloring is missing a blue cell in the second row, and the second coloring has two yellow segments in the second column. How many stupid colorings of the grid are there? Two colorings are considered different if there is some cell that is colored differently." 3100
1503D "Flip the Cards" "2-sat,constructive algorithms,data structures,greedy,sortings,two pointers" "There is a deck of n cards. The i-th card has a number ai on the front and a number bi on the back. Every integer between 1 and 2n appears exactly once on the cards.A deck is called sorted if the front values are in increasing order and the back values are in decreasing order. That is, if ai<ai+1 and bi>bi+1 for all 1\xe2\x89\xa4i<n.To flip a card i means swapping the values of ai and bi. You must flip some subset of cards (possibly, none), then put all the cards in any order you like. What is the minimum number of cards you must flip in order to sort the deck?" 2600
1503C "Travelling Salesman Problem" "binary search,data structures,dp,greedy,shortest paths,sortings,two pointers" "There are n cities numbered from 1 to n, and city i has beauty ai.A salesman wants to start at city 1, visit every city exactly once, and return to city 1.For all i\xe2\x89\xa0j, a flight from city i to city j costs max(ci,aj\xe2\x88\x92ai) dollars, where ci is the price floor enforced by city i. Note that there is no absolute value. Find the minimum total cost for the salesman to complete his trip." 2200
1503B 3-Coloring "constructive algorithms,games,interactive" "This is an interactive problem.Alice and Bob are playing a game. There is n\xc3\x97n grid, initially empty. We refer to the cell in row i and column j by (i,j) for 1\xe2\x89\xa4i,j\xe2\x89\xa4n. There is an infinite supply of tokens that come in 3 colors labelled 1, 2, and 3.The game proceeds with turns as follows. Each turn begins with Alice naming one of the three colors, let\'s call it a. Then, Bob chooses a color b\xe2\x89\xa0a, chooses an empty cell, and places a token of color b on that cell.We say that there is a conflict if there exist two adjacent cells containing tokens of the same color. Two cells are considered adjacent if they share a common edge.If at any moment there is a conflict, Alice wins. Otherwise, if n2 turns are completed (so that the grid becomes full) without any conflicts, Bob wins.We have a proof that Bob has a winning strategy. Play the game as Bob and win.The interactor is adaptive. That is, Alice\'s color choices can depend on Bob\'s previous moves." 1700
1503A "Balance the Bits" "constructive algorithms,greedy" "A sequence of brackets is called balanced if one can turn it into a valid math expression by adding characters \'+\' and \'1\'. For example, sequences \'(())()\', \'()\', and \'(()(()))\' are balanced, while \')(\', \'(()\', and \'(()))(\' are not.You are given a binary string s of length n. Construct two balanced bracket sequences a and b of length n such that for all 1\xe2\x89\xa4i\xe2\x89\xa4n:   if si=1, then ai=bi  if si=0, then ai\xe2\x89\xa0bi If it is impossible, you should report about it." 1600
1501B "Napoleon Cake" dp,implementation,sortings "This week Arkady wanted to cook some pancakes (to follow ancient traditions) and make a problem about that. But then he remembered that one can\'t make a problem about stacking pancakes without working at a specific IT company, so he decided to bake the Napoleon cake instead.To bake a Napoleon cake, one has to bake n dry layers first, and then put them on each other in one stack, adding some cream. Arkady started with an empty plate, and performed the following steps n times:   place a new cake layer on the top of the stack;  after the i-th layer is placed, pour ai units of cream on top of the stack. When x units of cream are poured on the top of the stack, top x layers of the cake get drenched in the cream. If there are less than x layers, all layers get drenched and the rest of the cream is wasted. If x=0, no layer gets drenched.  The picture represents the first test case of the example. Help Arkady determine which layers of the cake eventually get drenched when the process is over, and which don\'t." 900
1501A "Alexey and Train" implementation "Alexey is travelling on a train. Unfortunately, due to the bad weather, the train moves slower that it should!Alexey took the train at the railroad terminal. Let\'s say that the train starts from the terminal at the moment 0. Also, let\'s say that the train will visit n stations numbered from 1 to n along its way, and that Alexey destination is the station n.Alexey learned from the train schedule n integer pairs (ai,bi) where ai is the expected time of train\'s arrival at the i-th station and bi is the expected time of departure.Also, using all information he has, Alexey was able to calculate n integers tm1,tm2,\xe2\x80\xa6,tmn where tmi is the extra time the train need to travel from the station i\xe2\x88\x921 to the station i. Formally, the train needs exactly ai\xe2\x88\x92bi\xe2\x88\x921+tmi time to travel from station i\xe2\x88\x921 to station i (if i=1 then b0 is the moment the train leave the terminal, and it\'s equal to 0).The train leaves the station i, if both conditions are met:   it\'s on the station for at least \xe2\x8c\x88bi\xe2\x88\x92ai2\xe2\x8c\x89 units of time (division with ceiling);  current time \xe2\x89\xa5bi. Since Alexey spent all his energy on prediction of time delays, help him to calculate the time of arrival at the station n." 800
1500F "Cupboards Jumps" dp "In the house where Krosh used to live, he had n cupboards standing in a line, the i-th cupboard had the height of hi. Krosh moved recently, but he wasn\'t able to move the cupboards with him. Now he wants to buy n new cupboards so that they look as similar to old ones as possible.Krosh does not remember the exact heights of the cupboards, but for every three consecutive cupboards he remembers the height difference between the tallest and the shortest of them. In other words, if the cupboards\' heights were h1,h2,\xe2\x80\xa6,hn, then Krosh remembers the values wi=max(hi,hi+1,hi+2)\xe2\x88\x92min(hi,hi+1,hi+2) for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922.Krosh wants to buy such n cupboards that all the values wi remain the same. Help him determine the required cupboards\' heights, or determine that he remembers something incorrectly and there is no suitable sequence of heights." 3500
1500E "Subset Trick" "binary search,data structures" "Vanya invented an interesting trick with a set of integers.Let an illusionist have a set of positive integers S. He names a positive integer x. Then an audience volunteer must choose some subset (possibly, empty) of S without disclosing it to the illusionist. The volunteer tells the illusionist the size of the chosen subset. And here comes the trick: the illusionist guesses whether the sum of the subset elements does not exceed x. The sum of elements of an empty subset is considered to be 0.Vanya wants to prepare the trick for a public performance. He prepared some set of distinct positive integers S. Vasya wants the trick to be successful. He calls a positive number x unsuitable, if he can\'t be sure that the trick would be successful for every subset a viewer can choose.Vanya wants to count the number of unsuitable integers for the chosen set S.Vanya plans to try different sets S. He wants you to write a program that finds the number of unsuitable integers for the initial set S, and after each change to the set S. Vanya will make q changes to the set, and each change is one of the following two types:   add a new integer a to the set S, or  remove some integer a from the set S." 3300
1500D "Tiles for Bathroom" "data structures,sortings,two pointers" "Kostya is extremely busy: he is renovating his house! He needs to hand wallpaper, assemble furniture throw away trash.Kostya is buying tiles for bathroom today. He is standing in front of a large square stand with tiles in a shop. The stand is a square of n\xc3\x97n cells, each cell of which contains a small tile with color ci,j. The shop sells tiles in packs: more specifically, you can only buy a subsquare of the initial square.A subsquare is any square part of the stand, i. e. any set S(i0,j0,k)={ci,j | i0\xe2\x89\xa4i<i0+k,j0\xe2\x89\xa4j<j0+k} with 1\xe2\x89\xa4i0,j0\xe2\x89\xa4n\xe2\x88\x92k+1.Kostya still does not know how many tiles he needs, so he considers the subsquares of all possible sizes. He doesn\'t want his bathroom to be too colorful. Help Kostya to count for each k\xe2\x89\xa4n the number of subsquares of size k\xc3\x97k that have at most q different colors of tiles. Two subsquares are considered different if their location on the stand is different." 2900
1500C "Matrix Sorting" "bitmasks,brute force,constructive algorithms,greedy,two pointers" "You are given two tables A and B of size n\xc3\x97m. We define a sorting by column as the following: we choose a column and reorder the rows of the table by the value in this column, from the rows with the smallest value to the rows with the largest. In case there are two or more rows with equal value in this column, their relative order does not change (such sorting algorithms are called stable).You can find this behavior of sorting by column in many office software for managing spreadsheets. Petya works in one, and he has a table A opened right now. He wants to perform zero of more sortings by column to transform this table to table B.Determine if it is possible to do so, and if yes, find a sequence of columns to sort by. Note that you do not need to minimize the number of sortings." 2600
1500B "Two chandeliers" "binary search,brute force,chinese remainder theorem,math,number theory" "Vasya is a CEO of a big construction company. And as any other big boss he has a spacious, richly furnished office with two crystal chandeliers. To stay motivated Vasya needs the color of light at his office to change every day. That\'s why he ordered both chandeliers that can change its color cyclically. For example: red \xe2\x80\x93 brown \xe2\x80\x93 yellow \xe2\x80\x93 red \xe2\x80\x93 brown \xe2\x80\x93 yellow and so on. There are many chandeliers that differs in color set or order of colors. And the person responsible for the light made a critical mistake \xe2\x80\x94 they bought two different chandeliers.Since chandeliers are different, some days they will have the same color, but some days \xe2\x80\x94 different. Of course, it looks poor and only annoys Vasya. As a result, at the k-th time when chandeliers will light with different colors, Vasya will become very angry and, most probably, will fire the person who bought chandeliers.Your task is to calculate the day, when it happens (counting from the day chandeliers were installed). You can think that Vasya works every day without weekends and days off." 2200
1500A "Going Home" "brute force,hashing,implementation,math" "It was the third month of remote learning, Nastya got sick of staying at dormitory, so she decided to return to her hometown. In order to make her trip more entertaining, one of Nastya\'s friend presented her an integer array a. Several hours after starting her journey home Nastya remembered about the present. To entertain herself she decided to check, are there four different indices x,y,z,w such that ax+ay=az+aw.Her train has already arrived the destination, but she still hasn\'t found the answer. Can you help her unravel the mystery?" 1800
1499G "Graph Coloring" "data structures,graphs,interactive" "You are given a bipartite graph consisting of n1 vertices in the first part, n2 vertices in the second part, and m edges, numbered from 1 to m. You have to color each edge into one of two colors, red and blue. You have to minimize the following value: \xe2\x88\x91v\xe2\x88\x88V|r(v)\xe2\x88\x92b(v)|, where V is the set of vertices of the graph, r(v) is the number of red edges incident to v, and b(v) is the number of blue edges incident to v.Sounds classical and easy, right? Well, you have to process q queries of the following format:  1 v1 v2 \xe2\x80\x94 add a new edge connecting the vertex v1 of the first part with the vertex v2 of the second part. This edge gets a new index as follows: the first added edge gets the index m+1, the second \xe2\x80\x94 m+2, and so on. After adding the edge, you have to print the hash of the current optimal coloring (if there are multiple optimal colorings, print the hash of any of them). Actually, this hash won\'t be verified, you may print any number as the answer to this query, but you may be asked to produce the coloring having this hash;  2 \xe2\x80\x94 print the optimal coloring of the graph with the same hash you printed while processing the previous query. The query of this type will only be asked after a query of type 1, and there will be at most 10 queries of this type. If there are multiple optimal colorings corresponding to this hash, print any of them. Note that if an edge was red or blue in some coloring, it may change its color in next colorings.The hash of the coloring is calculated as follows: let R be the set of indices of red edges, then the hash is (\xe2\x88\x91i\xe2\x88\x88R2i)mod998244353.Note that you should solve the problem in online mode. It means that you can\'t read the whole input at once. You can read each query only after writing the answer for the last query. Use functions fflush in C++ and BufferedWriter.flush in Java languages after each writing in your program." 3100
1499F "Diameter Cuts" "combinatorics,dfs and similar,dp,trees" "You are given an integer k and an undirected tree, consisting of n vertices.The length of a simple path (a path in which each vertex appears at most once) between some pair of vertices is the number of edges in this path. A diameter of a tree is the maximum length of a simple path between all pairs of vertices of this tree.You are about to remove a set of edges from the tree. The tree splits into multiple smaller trees when the edges are removed. The set of edges is valid if all the resulting trees have diameter less than or equal to k.Two sets of edges are different if there is an edge such that it appears in only one of the sets.Count the number of valid sets of edges modulo 998244353." 2400
1499E "Chaotic Merge" combinatorics,dp,math,strings "You are given two strings x and y, both consist only of lowercase Latin letters. Let |s| be the length of string s.Let\'s call a sequence a a merging sequence if it consists of exactly |x| zeros and exactly |y| ones in some order.A merge z is produced from a sequence a by the following rules:   if ai=0, then remove a letter from the beginning of x and append it to the end of z;  if ai=1, then remove a letter from the beginning of y and append it to the end of z. Two merging sequences a and b are different if there is some position i such that ai\xe2\x89\xa0bi.Let\'s call a string z chaotic if for all i from 2 to |z| zi\xe2\x88\x921\xe2\x89\xa0zi.Let s[l,r] for some 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|s| be a substring of consecutive letters of s, starting from position l and ending at position r inclusive.Let f(l1,r1,l2,r2) be the number of different merging sequences of x[l1,r1] and y[l2,r2] that produce chaotic merges. Note that only non-empty substrings of x and y are considered.Calculate \xe2\x88\x911\xe2\x89\xa4l1\xe2\x89\xa4r1\xe2\x89\xa4|x|1\xe2\x89\xa4l2\xe2\x89\xa4r2\xe2\x89\xa4|y|f(l1,r1,l2,r2). Output the answer modulo 998244353." 2400
1499D "The Number of Pairs" "dp,math,number theory" "You are given three positive (greater than zero) integers c, d and x. You have to find the number of pairs of positive integers (a,b) such that equality c\xe2\x8b\x85lcm(a,b)\xe2\x88\x92d\xe2\x8b\x85gcd(a,b)=x holds. Where lcm(a,b) is the least common multiple of a and b and gcd(a,b) is the greatest common divisor of a and b." 2100
1499C "Minimum Grid Path" "brute force,data structures,greedy,math" "Let\'s say you are standing on the XY-plane at point (0,0) and you want to reach point (n,n).You can move only in two directions:   to the right, i. e. horizontally and in the direction that increase your x coordinate,  or up, i. e. vertically and in the direction that increase your y coordinate. In other words, your path will have the following structure:   initially, you choose to go to the right or up;  then you go some positive integer distance in the chosen direction (distances can be chosen independently);  after that you change your direction (from right to up, or from up to right) and repeat the process. You don\'t like to change your direction too much, so you will make no more than n\xe2\x88\x921 direction changes.As a result, your path will be a polygonal chain from (0,0) to (n,n), consisting of at most n line segments where each segment has positive integer length and vertical and horizontal segments alternate.Not all paths are equal. You have n integers c1,c2,\xe2\x80\xa6,cn where ci is the cost of the i-th segment.Using these costs we can define the cost of the path as the sum of lengths of the segments of this path multiplied by their cost, i. e. if the path consists of k segments (k\xe2\x89\xa4n), then the cost of the path is equal to k\xe2\x88\x91i=1ci\xe2\x8b\x85lengthi (segments are numbered from 1 to k in the order they are in the path).Find the path of the minimum cost and print its cost." 1500
1499B "Binary Removals" "brute force,dp,greedy,implementation" "You are given a string s, consisting only of characters \'0\' or \'1\'. Let |s| be the length of s.You are asked to choose some integer k (k>0) and find a sequence a of length k such that:   1\xe2\x89\xa4a1<a2<\xe2\x8b\xaf<ak\xe2\x89\xa4|s|;  ai\xe2\x88\x921+1<ai for all i from 2 to k. The characters at positions a1,a2,\xe2\x80\xa6,ak are removed, the remaining characters are concatenated without changing the order. So, in other words, the positions in the sequence a should not be adjacent.Let the resulting string be s\xe2\x80\xb2. s\xe2\x80\xb2 is called sorted if for all i from 2 to |s\xe2\x80\xb2| s\xe2\x80\xb2i\xe2\x88\x921\xe2\x89\xa4s\xe2\x80\xb2i.Does there exist such a sequence a that the resulting string s\xe2\x80\xb2 is sorted?" 1000
1499A "Domino on Windowsill" "combinatorics,constructive algorithms,math" "You have a board represented as a grid with 2\xc3\x97n cells.The first k1 cells on the first row and first k2 cells on the second row are colored in white. All other cells are colored in black.You have w white dominoes (2\xc3\x971 tiles, both cells are colored in white) and b black dominoes (2\xc3\x971 tiles, both cells are colored in black).You can place a white domino on the board if both board\'s cells are white and not occupied by any other domino. In the same way, you can place a black domino if both cells are black and not occupied by any other domino.Can you place all w+b dominoes on the board if you can place dominoes both horizontally and vertically?" 800
1498F "Christmas Game" "bitmasks,data structures,dfs and similar,dp,games,math,trees" "Alice and Bob are going to celebrate Christmas by playing a game with a tree of presents. The tree has n nodes (numbered 1 to n, with some node r as its root). There are ai presents are hanging from the i-th node.Before beginning the game, a special integer k is chosen. The game proceeds as follows: Alice begins the game, with moves alternating each turn; in any move, the current player may choose some node (for example, i) which has depth at least k. Then, the player picks some positive number of presents hanging from that node, let\'s call it m (1\xe2\x89\xa4m\xe2\x89\xa4ai); the player then places these m presents on the k-th ancestor (let\'s call it j) of the i-th node (the k-th ancestor of vertex i is a vertex j such that i is a descendant of j, and the difference between the depth of j and the depth of i is exactly k). Now, the number of presents of the i-th node (ai) is decreased by m, and, correspondingly, aj is increased by m; Alice and Bob both play optimally. The player unable to make a move loses the game.For each possible root of the tree, find who among Alice or Bob wins the game.Note: The depth of a node i in a tree with root r is defined as the number of edges on the simple path from node r to node i. The depth of root r itself is zero." 2500
1498E "Two Houses" "brute force,graphs,greedy,interactive,sortings" "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.There is a city in which Dixit lives. In the city, there are n houses. There is  exactly one directed road between every pair of houses. For example, consider two houses A and B, then there is a directed road either from A to B or from B to A but not both. The number of roads leading to the i-th house is ki.Two houses A and B are bi-reachable if A is reachable from B and B is reachable from A. We say that house B is reachable from house A when there is a path from house A to house B.Dixit wants to buy two houses in the city, that is, one for living and one for studying. Of course, he would like to travel from one house to another. So, he wants to find a pair of bi-reachable houses A and B. Among all such pairs, he wants to choose one with the maximum value of |kA\xe2\x88\x92kB|, where ki is the number of roads leading to the house i. If more than one optimal pair exists, any of them is suitable.Since Dixit is busy preparing CodeCraft, can you help him find the desired pair of houses, or tell him that no such houses exist?In the problem input, you are not given the direction of each road. You are given \xe2\x80\x94 for each house \xe2\x80\x94 only the number of incoming roads to that house (ki).You are allowed to ask only one type of query from the judge: give two houses A and B, and the judge answers whether B is reachable from A. There is no upper limit on the number of queries. But, you cannot ask more queries after the judge answers ""Yes"" to any of your queries. Also, you cannot ask the same query twice.Once you have exhausted all your queries (or the judge responds ""Yes"" to any of your queries), your program must output its guess for the two houses and quit.See the Interaction section below for more details." 2200
1498D "Bananas in a Microwave" "dfs and similar,dp,graphs,implementation" "You have a malfunctioning microwave in which you want to put some bananas. You have n time-steps before the microwave stops working completely. At each time-step, it displays a new operation.Let k be the number of bananas in the microwave currently. Initially, k=0. In the i-th operation, you are given three parameters ti, xi, yi in the input. Based on the value of ti, you must do one of the following:Type 1: (ti=1, xi, yi) \xe2\x80\x94 pick an ai, such that 0\xe2\x89\xa4ai\xe2\x89\xa4yi, and perform the following update ai times: k:=\xe2\x8c\x88(k+xi)\xe2\x8c\x89.Type 2: (ti=2, xi, yi) \xe2\x80\x94 pick an ai, such that 0\xe2\x89\xa4ai\xe2\x89\xa4yi, and perform the following update ai times: k:=\xe2\x8c\x88(k\xe2\x8b\x85xi)\xe2\x8c\x89.Note that xi can be a fractional value. See input format for more details. Also, \xe2\x8c\x88x\xe2\x8c\x89 is the smallest integer \xe2\x89\xa5x.At the i-th time-step, you must apply the i-th operation exactly once.For each j such that 1\xe2\x89\xa4j\xe2\x89\xa4m, output the earliest time-step at which you can create exactly j bananas. If you cannot create exactly j bananas, output \xe2\x88\x921." 2200
1498C "Planar Reflections" "brute force,data structures,dp" "Gaurang has grown up in a mystical universe. He is faced by n consecutive 2D planes. He shoots a particle of decay age k at the planes.A particle can pass through a plane directly, however, every plane produces an identical copy of the particle going in the opposite direction with a decay age k\xe2\x88\x921. If a particle has decay age equal to 1, it will NOT produce a copy.For example, if there are two planes and a particle is shot with decay age 3 (towards the right), the process is as follows: (here, D(x) refers to a single particle with decay age x)  the first plane produces a D(2) to the left and lets D(3) continue on to the right;  the second plane produces a D(2) to the left and lets D(3) continue on to the right;  the first plane lets D(2) continue on to the left and produces a D(1) to the right;  the second plane lets D(1) continue on to the right (D(1) cannot produce any copies). In total, the final multiset S of particles is {D(3),D(2),D(2),D(1)}. (See notes for visual explanation of this test case.)Gaurang is unable to cope up with the complexity of this situation when the number of planes is too large. Help Gaurang find the size of the multiset S, given n and k.Since the size of the multiset can be very large, you have to output it modulo 109+7.Note: Particles can go back and forth between the planes without colliding with each other." 1600
1498B "Box Fitting" "binary search,bitmasks,data structures,greedy" "You are given n rectangles, each of height 1. Each rectangle\'s width is a power of 2 (i.\xe2\x80\x89e. it can be represented as 2x for some non-negative integer x). You are also given a two-dimensional box of width W. Note that W may or may not be a power of 2. Moreover, W is at least as large as the width of the largest rectangle.You have to find the smallest height of this box, such that it is able to fit all the given rectangles. It is allowed to have some empty space left in this box after fitting all the rectangles.You cannot rotate the given rectangles to make them fit into the box. Moreover, any two distinct rectangles must not overlap, i.\xe2\x80\x89e., any two distinct rectangles must have zero intersection area.See notes for visual explanation of sample input." 1300
1498A "GCD Sum" "brute force,math" "The gcdSum of a positive integer is the gcd of that integer with its sum of digits. Formally, gcdSum(x)=gcd(x, sum of digits of x) for a positive integer x. gcd(a,b) denotes the greatest common divisor of a and b \xe2\x80\x94 the largest integer d such that both integers a and b are divisible by d.For example: gcdSum(762)=gcd(762,7+6+2)=gcd(762,15)=3.Given an integer n, find the smallest integer x\xe2\x89\xa5n such that gcdSum(x)>1." 800
1497E2 "Square-Free Division (hard version)" "data structures,dp,greedy,math,number theory,two pointers" "This is the hard version of the problem. The only difference is that in this version 0\xe2\x89\xa4k\xe2\x89\xa420.There is an array a1,a2,\xe2\x80\xa6,an of n positive integers. You should divide it into a minimal number of continuous segments, such that in each segment there are no two numbers (on different positions), whose product is a perfect square.Moreover, it is allowed to do at most k such operations before the division: choose a number in the array and change its value to any positive integer.What is the minimum number of continuous segments you should use if you will make changes optimally?" 2500
1497E1 "Square-Free Division (easy version)" "data structures,dp,greedy,math,number theory,two pointers" "This is the easy version of the problem. The only difference is that in this version k=0.There is an array a1,a2,\xe2\x80\xa6,an of n positive integers. You should divide it into a minimal number of continuous segments, such that in each segment there are no two numbers (on different positions), whose product is a perfect square.Moreover, it is allowed to do at most k such operations before the division: choose a number in the array and change its value to any positive integer. But in this version k=0, so it is not important.What is the minimum number of continuous segments you should use if you will make changes optimally?" 1700
1497D Genius "bitmasks,dp,graphs,number theory" "Please note the non-standard memory limit.There are n problems numbered with integers from 1 to n. i-th problem has the complexity ci=2i, tag tagi and score si.After solving the problem i it\'s allowed to solve problem j if and only if IQ<|ci\xe2\x88\x92cj| and tagi\xe2\x89\xa0tagj. After solving it your IQ changes and becomes IQ=|ci\xe2\x88\x92cj| and you gain |si\xe2\x88\x92sj| points.Any problem can be the first. You can solve problems in any order and as many times as you want.Initially your IQ=0. Find the maximum number of points that can be earned." 2500
1497C2 "k-LCM (hard version)" "constructive algorithms,math" "It is the hard version of the problem. The only difference is that in this version 3\xe2\x89\xa4k\xe2\x89\xa4n.You are given a positive integer n. Find k positive integers a1,a2,\xe2\x80\xa6,ak, such that:  a1+a2+\xe2\x80\xa6+ak=n  LCM(a1,a2,\xe2\x80\xa6,ak)\xe2\x89\xa4n2 Here LCM is the least common multiple of numbers a1,a2,\xe2\x80\xa6,ak.We can show that for given constraints the answer always exists." 1600
1497C1 "k-LCM (easy version)" "constructive algorithms,math" "It is the easy version of the problem. The only difference is that in this version k=3.You are given a positive integer n. Find k positive integers a1,a2,\xe2\x80\xa6,ak, such that:  a1+a2+\xe2\x80\xa6+ak=n  LCM(a1,a2,\xe2\x80\xa6,ak)\xe2\x89\xa4n2 Here LCM is the least common multiple of numbers a1,a2,\xe2\x80\xa6,ak.We can show that for given constraints the answer always exists." 1200
1497B M-arrays "constructive algorithms,greedy,math" "You are given an array a1,a2,\xe2\x80\xa6,an consisting of n positive integers and a positive integer m.You should divide elements of this array into some arrays. You can order the elements in the new arrays as you want.Let\'s call an array m-divisible if for each two adjacent numbers in the array (two numbers on the positions i and i+1 are called adjacent for each i) their sum is divisible by m. An array of one element is m-divisible.Find the smallest number of m-divisible arrays that a1,a2,\xe2\x80\xa6,an is possible to divide into." 1200
1497A Meximization "brute force,data structures,greedy,sortings" "You are given an integer n and an array a1,a2,\xe2\x80\xa6,an. You should reorder the elements of the array a in such way that the sum of MEX on prefixes (i-th prefix is a1,a2,\xe2\x80\xa6,ai) is maximized.Formally, you should find an array b1,b2,\xe2\x80\xa6,bn, such that the sets of elements of arrays a and b are equal (it is equivalent to array b can be found as an array a with some reordering of its elements) and n\xe2\x88\x91i=1MEX(b1,b2,\xe2\x80\xa6,bi) is maximized.MEX of a set of nonnegative integers is the minimal nonnegative integer such that it is not in the set.For example, MEX({1,2,3})=0, MEX({0,1,2,4,5})=3." 800
1496B "Max and Mex" math "You are given a multiset S initially consisting of n distinct non-negative integers. A multiset is a set, that can contain some elements multiple times.You will perform the following operation k times:   Add the element \xe2\x8c\x88a+b2\xe2\x8c\x89 (rounded up) into S, where a=mex(S) and b=max(S). If this number is already in the set, it is added again. Here max of a multiset denotes the maximum integer in the multiset, and mex of a multiset denotes the smallest non-negative integer that is not present in the multiset. For example:   mex({1,4,0,2})=3;   mex({2,5,1})=0. Your task is to calculate the number of distinct elements in S after k operations will be done." 1100
1496A "Split it!" "brute force,constructive algorithms,greedy,strings" "Kawashiro Nitori is a girl who loves competitive programming.One day she found a string and an integer. As an advanced problem setter, she quickly thought of a problem.Given a string s and a parameter k, you need to check if there exist k+1 non-empty strings a1,a2...,ak+1, such that s=a1+a2+\xe2\x80\xa6+ak+ak+1+R(ak)+R(ak\xe2\x88\x921)+\xe2\x80\xa6+R(a1). Here + represents concatenation. We define R(x) as a reversed string x. For example R(abcd)=dcba. Note that in the formula above the part R(ak+1) is intentionally skipped." 900
1495F Squares "constructive algorithms,data structures,dp,graphs,trees" "There are n squares drawn from left to right on the floor. The i-th square has three integers pi,ai,bi, written on it. The sequence p1,p2,\xe2\x80\xa6,pn forms a permutation.Each round you will start from the leftmost square 1 and jump to the right. If you are now on the i-th square, you can do one of the following two operations:  Jump to the i+1-th square and pay the cost ai. If i=n, then you can end the round and pay the cost ai.  Jump to the j-th square and pay the cost bi, where j is the leftmost square that satisfies j>i,pj>pi. If there is no such j then you can end the round and pay the cost bi. There are q rounds in the game. To make the game more difficult, you need to maintain a square set S (initially it is empty). You must pass through these squares during the round (other squares can also be passed through). The square set S for the i-th round is obtained by adding or removing a square from the square set for the (i\xe2\x88\x921)-th round. For each round find the minimum cost you should pay to end it." 3300
1495E "Qingshan and Daniel" "brute force,data structures,greedy,implementation" "Qingshan and Daniel are going to play a card game. But it will be so boring if only two persons play this. So they will make n robots in total to play this game automatically. Robots made by Qingshan belong to the team 1, and robots made by Daniel belong to the team 2. Robot i belongs to team ti. Before the game starts, ai cards are given for robot i.The rules for this card game are simple:   Before the start, the robots are arranged in a circle in the order or their indices. The robots will discard cards in some order, in each step one robot discards a single card. When the game starts, robot 1 will discard one of its cards. After that, robots will follow the following rules:  If robot i discards the card last, the nearest robot whose team is opposite from i\'s will discard the card next. In another word j will discard a card right after i, if and only if among all j that satisfy ti\xe2\x89\xa0tj, dist(i,j) (definition is below) is minimum.  The robot who has no cards should quit the game immediately. This robot won\'t be considered in the next steps.  When no robot can discard the card next, the game ends. We define the distance from robot x to robot y as dist(x,y)=(y\xe2\x88\x92x+n)modn. It is similar to the oriented distance on the circle.For example, when n=5, the distance from 1 to 3 is dist(1,3)=(3\xe2\x88\x921+5)mod5=2, the distance from 3 to 1 is dist(3,1)=(1\xe2\x88\x923+5)mod5=3.Later, Qingshan finds out that it will take so much time to see how robots play. She wants to know the result as quickly as possible. You, as Qingshan\'s fan, are asked to calculate an array [ans1,ans2,\xe2\x80\xa6,ansn] \xe2\x80\x94 ansi is equal to the number of cards, that i-th robot will discard during the game. You need to hurry!To avoid the large size of the input, the team and the number of cards of each robot will be generated in your code with some auxiliary arrays." 3200
1495D "BFS Trees" "combinatorics,dfs and similar,graphs,math,shortest paths,trees" "We define a spanning tree of a graph to be a BFS tree rooted at vertex s if and only if for every node t the shortest distance between s and t in the graph is equal to the shortest distance between s and t in the spanning tree. Given a graph, we define f(x,y) to be the number of spanning trees of that graph that are BFS trees rooted at vertices x and y at the same time.You are given an undirected connected graph with n vertices and m edges. Calculate f(i,j) for all i, j by modulo 998244353." 2600
1495C "Garden of the Sun" "constructive algorithms,graphs" "There are many sunflowers in the Garden of the Sun.Garden of the Sun is a rectangular table with n rows and m columns, where the cells of the table are farmlands. All of the cells grow a sunflower on it. Unfortunately, one night, the lightning stroke some (possibly zero) cells, and sunflowers on those cells were burned into ashes. In other words, those cells struck by the lightning became empty. Magically, any two empty cells have no common points (neither edges nor corners).Now the owner wants to remove some (possibly zero) sunflowers to reach the following two goals:   When you are on an empty cell, you can walk to any other empty cell. In other words, those empty cells are connected.   There is exactly one simple path between any two empty cells. In other words, there is no cycle among the empty cells. You can walk from an empty cell to another if they share a common edge.Could you please give the owner a solution that meets all her requirements?Note that you are not allowed to plant sunflowers. You don\'t need to minimize the number of sunflowers you remove. It can be shown that the answer always exists." 2300
1495B "Let\'s Go Hiking" games,greedy "On a weekend, Qingshan suggests that she and her friend Daniel go hiking. Unfortunately, they are busy high school students, so they can only go hiking on scratch paper.A permutation p is written from left to right on the paper. First Qingshan chooses an integer index x (1\xe2\x89\xa4x\xe2\x89\xa4n) and tells it to Daniel. After that, Daniel chooses another integer index y (1\xe2\x89\xa4y\xe2\x89\xa4n, y\xe2\x89\xa0x).The game progresses turn by turn and as usual, Qingshan moves first. The rules follow:   If it is Qingshan\'s turn, Qingshan must change x to such an index x\xe2\x80\xb2 that 1\xe2\x89\xa4x\xe2\x80\xb2\xe2\x89\xa4n, |x\xe2\x80\xb2\xe2\x88\x92x|=1, x\xe2\x80\xb2\xe2\x89\xa0y, and px\xe2\x80\xb2<px at the same time.  If it is Daniel\'s turn, Daniel must change y to such an index y\xe2\x80\xb2 that 1\xe2\x89\xa4y\xe2\x80\xb2\xe2\x89\xa4n, |y\xe2\x80\xb2\xe2\x88\x92y|=1, y\xe2\x80\xb2\xe2\x89\xa0x, and py\xe2\x80\xb2>py at the same time. The person who can\'t make her or his move loses, and the other wins. You, as Qingshan\'s fan, are asked to calculate the number of possible x to make Qingshan win in the case both players play optimally." 1900
1495A "Diamond Miner" geometry,greedy,math,sortings "Diamond Miner is a game that is similar to Gold Miner, but there are n miners instead of 1 in this game.The mining area can be described as a plane. The n miners can be regarded as n points on the y-axis. There are n diamond mines in the mining area. We can regard them as n points on the x-axis. For some reason, no miners or diamond mines can be at the origin (point (0,0)). Every miner should mine exactly one diamond mine. Every miner has a hook, which can be used to mine a diamond mine. If a miner at the point (a,b) uses his hook to mine a diamond mine at the point (c,d), he will spend \xe2\x88\x9a(a\xe2\x88\x92c)2+(b\xe2\x88\x92d)2 energy to mine it (the distance between these points). The miners can\'t move or help each other.The object of this game is to minimize the sum of the energy that miners spend. Can you find this minimum?" 1200
1494F "Delete The Edges" "brute force,constructive algorithms,dfs and similar,graphs,implementation" "You are given an undirected connected graph consisting of n vertices and m edges. Your goal is to destroy all edges of the given graph.You may choose any vertex as the starting one and begin walking from it along the edges. When you walk along an edge, you destroy it. Obviously, you cannot walk along an edge if it is destroyed.You can perform the mode shift operation at most once during your walk, and this operation can only be performed when you are at some vertex (you cannot perform it while traversing an edge). After the mode shift, the edges you go through are deleted in the following way: the first edge after the mode shift is not destroyed, the second one is destroyed, the third one is not destroyed, the fourth one is destroyed, and so on. You cannot switch back to the original mode, and you don\'t have to perform this operation if you don\'t want to.Can you destroy all the edges of the given graph?" 2900
1494E "A-Z Graph" "constructive algorithms,data structures,graphs,hashing" "You are given a directed graph consisting of n vertices. Each directed edge (or arc) labeled with a single character. Initially, the graph is empty.You should process m queries with it. Each query is one of three types:   ""+ u v c"" \xe2\x80\x94 add arc from u to v with label c. It\'s guaranteed that there is no arc (u,v) in the graph at this moment;  ""\xe2\x88\x92 u v"" \xe2\x80\x94 erase arc from u to v. It\'s guaranteed that the graph contains arc (u,v) at this moment;  ""? k"" \xe2\x80\x94 find the sequence of k vertices v1,v2,\xe2\x80\xa6,vk such that there exist both routes v1\xe2\x86\x92v2\xe2\x86\x92\xe2\x8b\xaf\xe2\x86\x92vk and vk\xe2\x86\x92vk\xe2\x88\x921\xe2\x86\x92\xe2\x8b\xaf\xe2\x86\x92v1 and if you write down characters along both routes you\'ll get the same string. You can visit the same vertices any number of times." 2400
1494D Dogeforces "constructive algorithms,data structures,dfs and similar,divide and conquer,dsu,greedy,sortings,trees" "The Dogeforces company has k employees. Each employee, except for lower-level employees, has at least 2 subordinates. Lower-level employees have no subordinates. Each employee, except for the head of the company, has exactly one direct supervisor. The head of the company is a direct or indirect supervisor of all employees. It is known that in Dogeforces, each supervisor receives a salary strictly more than all his subordinates.The full structure of the company is a secret, but you know the number of lower-level employees and for each pair of lower-level employees, the salary of their common supervisor is known (if there are several such supervisors, then the supervisor with the minimum salary). You have to restore the structure of the company." 2300
1494C "1D Sokoban" "binary search,dp,greedy,implementation,two pointers" "You are playing a game similar to Sokoban on an infinite number line. The game is discrete, so you only consider integer positions on the line.You start on a position 0. There are n boxes, the i-th box is on a position ai. All positions of the boxes are distinct. There are also m special positions, the j-th position is bj. All the special positions are also distinct.In one move you can go one position to the left or to the right. If there is a box in the direction of your move, then you push the box to the next position in that direction. If the next position is taken by another box, then that box is also pushed to the next position, and so on. You can\'t go through the boxes. You can\'t pull the boxes towards you.You are allowed to perform any number of moves (possibly, zero). Your goal is to place as many boxes on special positions as possible. Note that some boxes can be initially placed on special positions." 1900
1494B "Berland Crossword" "bitmasks,brute force,greedy,implementation" "Berland crossword is a puzzle that is solved on a square grid with n rows and n columns. Initially all the cells are white.To solve the puzzle one has to color some cells on the border of the grid black in such a way that:   exactly U cells in the top row are black;  exactly R cells in the rightmost column are black;  exactly D cells in the bottom row are black;  exactly L cells in the leftmost column are black. Note that you can color zero cells black and leave every cell white.Your task is to check if there exists a solution to the given puzzle." 1400
1494A "ABC String" "bitmasks,brute force,implementation" "You are given a string a, consisting of n characters, n is even. For each i from 1 to n ai is one of \'A\', \'B\' or \'C\'.A bracket sequence is a string containing only characters ""("" and "")"". A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)""), and "")("", ""("" and "")"" are not.You want to find a string b that consists of n characters such that:   b is a regular bracket sequence;  if for some i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) ai=aj, then bi=bj. In other words, you want to replace all occurrences of \'A\' with the same type of bracket, then all occurrences of \'B\' with the same type of bracket and all occurrences of \'C\' with the same type of bracket.Your task is to determine if such a string b exists." 900
1493F "Enchanted Matrix" "bitmasks,interactive,number theory" "This is an interactive problem.There exists a matrix a of size n\xc3\x97m (n rows and m columns), you know only numbers n and m. The rows of the matrix are numbered from 1 to n from top to bottom, and columns of the matrix are numbered from 1 to m from left to right. The cell on the intersection of the x-th row and the y-th column is denoted as (x,y).You are asked to find the number of pairs (r,c) (1\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4c\xe2\x89\xa4m, r is a divisor of n, c is a divisor of m) such that if we split the matrix into rectangles of size r\xc3\x97c (of height r rows and of width c columns, each cell belongs to exactly one rectangle), all those rectangles are pairwise equal.You can use queries of the following type:   ? h w i1 j1 i2 j2 (1\xe2\x89\xa4h\xe2\x89\xa4n, 1\xe2\x89\xa4w\xe2\x89\xa4m, 1\xe2\x89\xa4i1,i2\xe2\x89\xa4n, 1\xe2\x89\xa4j1,j2\xe2\x89\xa4m) \xe2\x80\x94 to check if non-overlapping subrectangles of height h rows and of width w columns of matrix a are equal or not. The upper left corner of the first rectangle is (i1,j1). The upper left corner of the second rectangle is (i2,j2). Subrectangles overlap, if they have at least one mutual cell. If the subrectangles in your query have incorrect coordinates (for example, they go beyond the boundaries of the matrix) or overlap, your solution will be considered incorrect. You can use at most 3\xe2\x8b\x85\xe2\x8c\x8alog2(n+m)\xe2\x8c\x8b queries. All elements of the matrix a are fixed before the start of your program and do not depend on your queries." 2600
1493E "Enormous XOR" "bitmasks,constructive algorithms,greedy,math,strings,two pointers" "You are given two integers l and r in binary representation. Let g(x,y) be equal to the bitwise XOR of all integers from x to y inclusive (that is x\xe2\x8a\x95(x+1)\xe2\x8a\x95\xe2\x8b\xaf\xe2\x8a\x95(y\xe2\x88\x921)\xe2\x8a\x95y). Let\'s define f(l,r) as the maximum of all values of g(x,y) satisfying l\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4r.Output f(l,r)." 2600
1493D "GCD of an Array" "brute force,data structures,hashing,implementation,math,number theory,sortings,two pointers" "You are given an array a of length n. You are asked to process q queries of the following format: given integers i and x, multiply ai by x.After processing each query you need to output the greatest common divisor (GCD) of all elements of the array a.Since the answer can be too large, you are asked to output it modulo 109+7." 2100
1493C "K-beautiful Strings" "binary search,brute force,constructive algorithms,greedy,strings" "You are given a string s consisting of lowercase English letters and a number k. Let\'s call a string consisting of lowercase English letters beautiful if the number of occurrences of each letter in that string is divisible by k. You are asked to find the lexicographically smallest beautiful string of length n, which is lexicographically greater or equal to string s. If such a string does not exist, output \xe2\x88\x921.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 2000
1493B "Planet Lapituletti" "brute force,implementation" "The time on the planet Lapituletti goes the same way it goes on Earth but a day lasts h hours and each hour lasts m minutes. The inhabitants of that planet use digital clocks similar to earth ones. Clocks display time in a format HH:MM (the number of hours in decimal is displayed first, then (after the colon) follows the number of minutes in decimal; the number of minutes and hours is written with leading zeros if needed to form a two-digit number). Hours are numbered from 0 to h\xe2\x88\x921 and minutes are numbered from 0 to m\xe2\x88\x921.  That\'s how the digits are displayed on the clock. Please note that digit 1 is placed in the middle of its position. A standard mirror is in use on the planet Lapituletti. Inhabitants often look at the reflection of the digital clocks in the mirror and feel happy when what you see on the reflected clocks is a valid time (that means that you see valid digits in the reflection and this time can be seen on the normal clocks at some moment of a day).The image of the clocks in the mirror is reflected against a vertical axis.  The reflection is not a valid time.The reflection is a valid time with h=24, m=60. However, for example, if h=10, m=60, then the reflection is not a valid time. An inhabitant of the planet Lapituletti begins to look at a mirrored image of the clocks at some time moment s and wants to know the nearest future time moment (which can possibly happen on the next day), when the reflected clock time is valid.It can be shown that with any h, m, s such a moment exists. If the reflected time is correct at the moment the inhabitant began to look at the clock, that moment is considered the nearest.You are asked to solve the problem for several test cases." 1300
1493A Anti-knapsack "constructive algorithms,greedy" "You are given two integers n and k. You are asked to choose maximum number of distinct integers from 1 to n so that there is no subset of chosen numbers with sum equal to k.A subset of a set is a set that can be obtained from initial one by removing some (possibly all or none) elements of it." 800
1492E "Almost Fault-Tolerant Database" "brute force,constructive algorithms,dfs and similar,greedy,implementation" "You are storing an integer array of length m in a database. To maintain internal integrity and protect data, the database stores n copies of this array.Unfortunately, the recent incident may have altered the stored information in every copy in the database.It\'s believed, that the incident altered at most two elements in every copy. You need to recover the original array based on the current state of the database.In case there are multiple ways to restore the array, report any. If there is no array that differs from every copy in no more than two positions, report that as well." 2500
1492D "Genius\'s Gambit" "bitmasks,constructive algorithms,greedy,math" "You are given three integers a, b, k.Find two binary integers x and y (x\xe2\x89\xa5y) such that   both x and y consist of a zeroes and b ones;  x\xe2\x88\x92y (also written in binary form) has exactly k ones.  You are not allowed to use leading zeros for x and y." 1900
1492C "Maximum width" "binary search,data structures,dp,greedy,two pointers" "Your classmate, whom you do not like because he is boring, but whom you respect for his intellect, has two strings: s of length n and t of length m.A sequence p1,p2,\xe2\x80\xa6,pm, where 1\xe2\x89\xa4p1<p2<\xe2\x80\xa6<pm\xe2\x89\xa4n, is called beautiful, if spi=ti for all i from 1 to m. The width of a sequence is defined as max1\xe2\x89\xa4i<m(pi+1\xe2\x88\x92pi).Please help your classmate to identify the beautiful sequence with the maximum width. Your classmate promised you that for the given strings s and t there is at least one beautiful sequence." 1500
1492B "Card Deck" "data structures,greedy,math" "You have a deck of n cards, and you\'d like to reorder it to a new one.Each card has a value between 1 and n equal to pi. All pi are pairwise distinct. Cards in a deck are numbered from bottom to top, i. e. p1 stands for the bottom card, pn is the top card. In each step you pick some integer k>0, take the top k cards from the original deck and place them, in the order they are now, on top of the new deck. You perform this operation until the original deck is empty. (Refer to the notes section for the better understanding.)Let\'s define an order of a deck as n\xe2\x88\x91i=1nn\xe2\x88\x92i\xe2\x8b\x85pi.Given the original deck, output the deck with maximum possible order you can make using the operation above." 1100
1492A "Three swimmers" math "Three swimmers decided to organize a party in the swimming pool! At noon, they started to swim from the left side of the pool.It takes the first swimmer exactly a minutes to swim across the entire pool and come back, exactly b minutes for the second swimmer and c minutes for the third. Hence, the first swimmer will be on the left side of the pool after 0, a, 2a, 3a, ... minutes after the start time, the second one will be at 0, b, 2b, 3b, ... minutes, and the third one will be on the left side of the pool after 0, c, 2c, 3c, ... minutes.You came to the left side of the pool exactly p minutes after they started swimming. Determine how long you have to wait before one of the swimmers arrives at the left side of the pool." 800
1491I "Ruler Of The Zoo" "brute force,data structures" "After realizing that Zookeeper is just a duck, the animals have overthrown Zookeeper. They now have to decide a new ruler among themselves through a fighting tournament of the following format:Initially, animal 0 is king, while everyone else queues up with animal 1 at the front of the queue and animal n\xe2\x88\x921 at the back. The animal at the front of the queue will challenge the king to a fight, and the animal with greater strength will win the fight. The winner will become king, while the loser joins the back of the queue.An animal who wins 3 times consecutively will be crowned ruler for the whole zoo. The strength of each animal depends on how many consecutive fights he won. Animal i has strength Ai with 0 consecutive win, Bi with 1 consecutive win, and Ci with 2 consecutive wins. Initially, everyone has 0 consecutive win.For all animals, Ai>Bi and Ci>Bi. Also, the values of Ai, Bi, Ci are distinct (all 3n values are pairwise different). In other words, an animal who is not a king has strength Ai. A king usually has a strength of Bi or Ci. The exception is on the first turn, the first king (animal 0) has strength Ai.Who is the new ruler, and after how many fights? Or will it end up that animals fight forever with no one ending up as ruler?" 3500
1491H "Yuezheng Ling and Dynamic Tree" "data structures,trees" "Yuezheng Ling gives Luo Tianyi a tree which has n nodes, rooted at 1. Luo Tianyi will tell you that the parent of the i-th node is ai (1\xe2\x89\xa4ai<i for 2\xe2\x89\xa4i\xe2\x89\xa4n), and she will ask you to perform q queries of 2 types: She\'ll give you three integers l, r and x (2\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4x\xe2\x89\xa4105). You need to replace ai with max(ai\xe2\x88\x92x,1) for all i with l\xe2\x89\xa4i\xe2\x89\xa4r. She\'ll give you two integers u, v (1\xe2\x89\xa4u,v\xe2\x89\xa4n). You need to find the LCA of nodes u and v (their lowest common ancestor)." 3400
1491G "Switch and Flip" "constructive algorithms,graphs,math" "There are n coins labeled from 1 to n. Initially, coin ci is on position i and is facing upwards ((c1,c2,\xe2\x80\xa6,cn) is a permutation of numbers from 1 to n). You can do some operations on these coins. In one operation, you can do the following:Choose 2 distinct indices i and j.Then, swap the coins on positions i and j.Then, flip both coins on positions i and j. (If they are initially faced up, they will be faced down after the operation and vice versa)Construct a sequence of at most n+1 operations such that after performing all these operations the coin i will be on position i at the end, facing up.Note that you do not need to minimize the number of operations." 2800
1491F Magnets "binary search,constructive algorithms,interactive" "This is an interactive problem.Kochiya Sanae is playing with magnets. Realizing that some of those magnets are demagnetized, she is curious to find them out.There are n magnets, which can be of the following 3 types: N  S  - \xe2\x80\x94 these magnets are demagnetized. Note that you don\'t know the types of these magnets beforehand.You have a machine which can measure the force between the magnets, and you can use it at most n+\xe2\x8c\x8alog2n\xe2\x8c\x8b times.You can put some magnets to the left part of the machine and some to the right part of the machine, and launch the machine. Obviously, you can put one magnet to at most one side (you don\'t have to put all magnets). You can put the same magnet in different queries.Then the machine will tell the force these magnets produce. Formally, let n1,s1 be the number of N and S magnets correspondently on the left and n2,s2 \xe2\x80\x94 on the right. Then the force between them would be n1n2+s1s2\xe2\x88\x92n1s2\xe2\x88\x92n2s1. Please note that the force is a signed value.However, when the absolute value of the force is strictly larger than n, the machine will crash into pieces.You need to find all magnets of type - (all demagnetized ones), without breaking the machine.Note that the interactor is not adaptive. The types of the magnets are fixed before the start of the interaction and do not change with queries.It is guaranteed that there are at least 2 magnets whose type is not -, and at least 1 magnet of type -." 2700
1491E Fib-tree "brute force,dfs and similar,divide and conquer,number theory,trees" "Let Fk denote the k-th term of Fibonacci sequence, defined as below: F0=F1=1 for any integer n\xe2\x89\xa50, Fn+2=Fn+1+FnYou are given a tree with n vertices. Recall that a tree is a connected undirected graph without cycles.We call a tree a Fib-tree, if its number of vertices equals Fk for some k, and at least one of the following conditions holds: The tree consists of only 1 vertex; You can divide it into two Fib-trees by removing some edge of the tree. Determine whether the given tree is a Fib-tree or not." 2400
1491D "Zookeeper and The Infinite Zoo" "bitmasks,constructive algorithms,dp,greedy,math" "There is a new attraction in Singapore Zoo: The Infinite Zoo.The Infinite Zoo can be represented by a graph with an infinite number of vertices labeled 1,2,3,\xe2\x80\xa6. There is a directed edge from vertex u to vertex u+v if and only if u&v=v, where & denotes the bitwise AND operation. There are no other edges in the graph.Zookeeper has q queries. In the i-th query she will ask you if she can travel from vertex ui to vertex vi by going through directed edges." 1800
1491C "Pekora and Trampoline" "brute force,data structures,dp,greedy,implementation" "There is a trampoline park with n trampolines in a line. The i-th of which has strength Si.Pekora can jump on trampolines in multiple passes. She starts the pass by jumping on any trampoline of her choice. If at the moment Pekora jumps on trampoline i, the trampoline will launch her to position i+Si, and Si will become equal to max(Si\xe2\x88\x921,1). In other words, Si will decrease by 1, except of the case Si=1, when Si will remain equal to 1. If there is no trampoline in position i+Si, then this pass is over. Otherwise, Pekora will continue the pass by jumping from the trampoline at position i+Si by the same rule as above.Pekora can\'t stop jumping during the pass until she lands at the position larger than n (in which there is no trampoline). Poor Pekora!Pekora is a naughty rabbit and wants to ruin the trampoline park by reducing all Si to 1. What is the minimum number of passes she needs to reduce all Si to 1?" 1700
1491B "Minimal Cost" "brute force,math" "There is a graph of n rows and 106+2 columns, where rows are numbered from 1 to n and columns from 0 to 106+1:  Let\'s denote the node in the row i and column j by (i,j).Initially for each i the i-th row has exactly one obstacle \xe2\x80\x94 at node (i,ai). You want to move some obstacles so that you can reach node (n,106+1) from node (1,0) by moving through edges of this graph (you can\'t pass through obstacles). Moving one obstacle to an adjacent by edge free node costs u or v coins, as below:  If there is an obstacle in the node (i,j), you can use u coins to move it to (i\xe2\x88\x921,j) or (i+1,j), if such node exists and if there is no obstacle in that node currently.  If there is an obstacle in the node (i,j), you can use v coins to move it to (i,j\xe2\x88\x921) or (i,j+1), if such node exists and if there is no obstacle in that node currently.  Note that you can\'t move obstacles outside the grid. For example, you can\'t move an obstacle from (1,1) to (0,1). Refer to the picture above for a better understanding. Now you need to calculate the minimal number of coins you need to spend to be able to reach node (n,106+1) from node (1,0) by moving through edges of this graph without passing through obstacles." 1200
1491A "K-th Largest Value" "brute force,greedy,implementation" "You are given an array a consisting of n integers. Initially all elements of a are either 0 or 1. You need to process q queries of two kinds:  1 x : Assign to ax the value 1\xe2\x88\x92ax.  2 k : Print the k-th largest value of the array. As a reminder, k-th largest value of the array b is defined as following: Sort the array in the non-increasing order, return k-th element from it. For example, the second largest element in array [0,1,0,1] is 1, as after sorting in non-increasing order it becomes [1,1,0,0], and the second element in this array is equal to 1." 800
1490G "Old Floppy Drive" "binary search,data structures,math" "Polycarp was dismantling his attic and found an old floppy drive on it. A round disc was inserted into the drive with n integers written on it.Polycarp wrote the numbers from the disk into the a array. It turned out that the drive works according to the following algorithm:   the drive takes one positive number x as input and puts a pointer to the first element of the a array;  after that, the drive starts rotating the disk, every second moving the pointer to the next element, counting the sum of all the elements that have been under the pointer. Since the disk is round, in the a array, the last element is again followed by the first one;  as soon as the sum is at least x, the drive will shut down. Polycarp wants to learn more about the operation of the drive, but he has absolutely no free time. So he asked you m questions. To answer the i-th of them, you need to find how many seconds the drive will work if you give it xi as input. Please note that in some cases the drive can work infinitely.For example, if n=3,m=3, a=[1,\xe2\x88\x923,4] and x=[1,5,2], then the answers to the questions are as follows:   the answer to the first query is 0 because the drive initially points to the first item and the initial sum is 1.  the answer to the second query is 6, the drive will spin the disk completely twice and the amount becomes 1+(\xe2\x88\x923)+4+1+(\xe2\x88\x923)+4+1=5.  the answer to the third query is 2, the amount is 1+(\xe2\x88\x923)+4=2." 1900
1490F "Equalize the Array" "binary search,data structures,greedy,math,sortings" "Polycarp was gifted an array a of length n. Polycarp considers an array beautiful if there exists a number C, such that each number in the array occurs either zero or C times. Polycarp wants to remove some elements from the array a to make it beautiful.For example, if n=6 and a=[1,3,2,1,4,2], then the following options are possible to make the array a array beautiful:   Polycarp removes elements at positions 2 and 5, array a becomes equal to [1,2,1,2];  Polycarp removes elements at positions 1 and 6, array a becomes equal to [3,2,1,4];  Polycarp removes elements at positions 1,2 and 6, array a becomes equal to [2,1,4]; Help Polycarp determine the minimum number of elements to remove from the array a to make it beautiful." 1500
1490E "Accidental Victory" "binary search,data structures,greedy" "A championship is held in Berland, in which n players participate. The player with the number i has ai (ai\xe2\x89\xa51) tokens.The championship consists of n\xe2\x88\x921 games, which are played according to the following rules:  in each game, two random players with non-zero tokens are selected;  the player with more tokens is considered the winner of the game (in case of a tie, the winner is chosen randomly);  the winning player takes all of the loser\'s tokens; The last player with non-zero tokens is the winner of the championship.All random decisions that are made during the championship are made equally probable and independently.For example, if n=4, a=[1,2,4,3], then one of the options for the game (there could be other options) is:   during the first game, the first and fourth players were selected. The fourth player has more tokens, so he takes the first player\'s tokens. Now a=[0,2,4,4];  during the second game, the fourth and third players were selected. They have the same number of tokens, but in a random way, the third player is the winner. Now a=[0,2,8,0];  during the third game, the second and third players were selected. The third player has more tokens, so he takes the second player\'s tokens. Now a=[0,0,10,0];  the third player is declared the winner of the championship. Championship winners will receive personalized prizes. Therefore, the judges want to know in advance which players have a chance of winning, i.e have a non-zero probability of winning the championship. You have been asked to find all such players." 1400
1490D "Permutation Transformation" "dfs and similar,divide and conquer,implementation" "A permutation \xe2\x80\x94 is a sequence of length n integers from 1 to n, in which all the numbers occur exactly once. For example, [1], [3,5,2,1,4], [1,3,2] \xe2\x80\x94 permutations, and [2,3,2], [4,3,1], [0] \xe2\x80\x94 no.Polycarp was recently gifted a permutation a[1\xe2\x80\xa6n] of length n. Polycarp likes trees more than permutations, so he wants to transform permutation a into a rooted binary tree. He transforms an array of different integers into a tree as follows:   the maximum element of the array becomes the root of the tree;  all elements to the left of the maximum \xe2\x80\x94 form a left subtree (which is built according to the same rules but applied to the left part of the array), but if there are no elements to the left of the maximum, then the root has no left child;  all elements to the right of the maximum \xe2\x80\x94 form a right subtree (which is built according to the same rules but applied to the right side of the array), but if there are no elements to the right of the maximum, then the root has no right child. For example, if he builds a tree by permutation a=[3,5,2,1,4], then the root will be the element a2=5, and the left subtree will be the tree that will be built for the subarray a[1\xe2\x80\xa61]=[3], and the right one \xe2\x80\x94 for the subarray a[3\xe2\x80\xa65]=[2,1,4]. As a result, the following tree will be built:   The tree corresponding to the permutation a=[3,5,2,1,4]. Another example: let the permutation be a=[1,3,2,7,5,6,4]. In this case, the tree looks like this:   The tree corresponding to the permutation a=[1,3,2,7,5,6,4]. Let us denote by dv the depth of the vertex av, that is, the number of edges on the path from the root to the vertex numbered av. Note that the root depth is zero. Given the permutation a, for each vertex, find the value of dv." 1200
1490C "Sum of Cubes" "binary search,brute force,brute force,math" "You are given a positive integer x. Check whether the number x is representable as the sum of the cubes of two positive integers.Formally, you need to check if there are two integers a and b (1\xe2\x89\xa4a,b) such that a3+b3=x.For example, if x=35, then the numbers a=2 and b=3 are suitable (23+33=8+27=35). If x=4, then no pair of numbers a and b is suitable." 1100
1490B "Balanced Remainders" "brute force,constructive algorithms,math" "You are given a number n (divisible by 3) and an array a[1\xe2\x80\xa6n]. In one move, you can increase any of the array elements by one. Formally, you choose the index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and replace ai with ai+1. You can choose the same index i multiple times for different moves.Let\'s denote by c0, c1 and c2 the number of numbers from the array a that have remainders 0, 1 and 2 when divided by the number 3, respectively. Let\'s say that the array a has balanced remainders if c0, c1 and c2 are equal.For example, if n=6 and a=[0,2,5,5,4,8], then the following sequence of moves is possible:   initially c0=1, c1=1 and c2=4, these values are not equal to each other. Let\'s increase a3, now the array a=[0,2,6,5,4,8];  c0=2, c1=1 and c2=3, these values are not equal. Let\'s increase a6, now the array a=[0,2,6,5,4,9];  c0=3, c1=1 and c2=2, these values are not equal. Let\'s increase a1, now the array a=[1,2,6,5,4,9];  c0=2, c1=2 and c2=2, these values are equal to each other, which means that the array a has balanced remainders. Find the minimum number of moves needed to make the array a have balanced remainders." 1000
1490A "Dense Array" greedy,math "Polycarp calls an array dense if the greater of any two adjacent elements is not more than twice bigger than the smaller. More formally, for any i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), this condition must be satisfied: max(a[i],a[i+1])min(a[i],a[i+1])\xe2\x89\xa42For example, the arrays [1,2,3,4,3], [1,1,1] and [5,10] are dense. And the arrays [5,11], [1,4,2], [6,6,1] are not dense.You are given an array a of n integers. What is the minimum number of numbers you need to add to an array to make it dense? You can insert numbers anywhere in the array. If the array is already dense, no numbers need to be added.For example, if a=[4,2,10,1], then the answer is 5, and the array itself after inserting elements into it may look like this: a=[4,2,3_,5_,10,6_,4_,2_,1] (there are other ways to build such a)." 800
1488J "Flower Shop" "*special problem,data structures,fft,math" "Your friend is running a flower shop. In order to be prepared for the next holidays (when, as usual, sales skyrocket) she asked you to write her a special program that will help to analyze the stocks she has.There are n different types of flowers she can order and each flower of the type i costs wi. The last holidays were a great success, she sold all flowers she had, so right now all her stocks are empty.From this point, she starts routine operations of ordering and selling flowers, while trying to analyze what she has at hand. All of this can be represented as m queries of three types:   ""1 i c"" \xe2\x80\x94 she bought c flowers of type i;  ""2 i c"" \xe2\x80\x94 she disposed of c flowers of type i;  ""3 l r k"" \xe2\x80\x94 how many variants of bouquets she can make using only flowers of types l,l+1,\xe2\x80\xa6,r with the total cost no more than k. For simplicity, you can think that a bouquet is a multiset of flowers, and two bouquets are different if they are different as multisets. The cost of a bouquet is the sum of all flowers it has. Help your friend and write the program that can process all these queries." 3100
1488I "Demonic Invasion" "*special problem,flows" "Dalaran is a flying city of magic. It consists of n floating islands connected by m bridges (each bridge can be traversed in both directions). Every island is reachable from every other along these bridges. It would be a shame if some magic experiment went horribly wrong and this magnificent city got destroyed, right?Well, just guess what happened. A portal to demons\' realm was opened at the island 1. This is the start of day 1 of the catastrophe, and all k mages have gathered at the island 1 (they were trying to close the portal, but found out that it was impossible). At the start of day 2, a gigantic horde of demons will emerge from the portal, capture the island 1 and kill every mage staying at that island. During each day i, if the island v was captured by demons by the start of the day, the horde of demons will travel across all bridges connected directly to v, capture every island they reach, and kill every mage they meet along the way.Each bridge contains exactly one magic stone. Each mage at the start of the day can do one of the following actions:  Spend one day travelling along one of the bridges connected to the island where the mage currently is. When passing through a bridge, the mage can pick up the magic stone from it (if there is any; each magic stone can be picked up by at most one mage). If the bridge is passed by the demons during the same day, or by the start of the next day, the island where the mage goes is already captured by the demonic horde (even if they arrive there at the same moment), the mage is killed.  Perform a teleportation ritual to get to safety outside Dalaran. This ritual consumes two magic stones (and cannot be performed if the mage has less than two stones). Each magic stone decays in 2 days, so if is picked up in the middle of day i, it decays in the middle of day i+2. Decayed stones cannot be used in teleportation ritual.Calculate the maximum number of mages that can get to safety." 3100
1488H "Build From Suffixes" "*special problem,combinatorics,data structures" "You are given an integer n and a sequence a of n\xe2\x88\x921 integers, each element is either 0 or 1.You are asked to build a string of length n such that:   each letter is one of ""abcd"";  if ai=1, then the i-th suffix of the string is lexicographically smaller than the (i+1)-th suffix;  if ai=0, then the i-th suffix of the string is lexicographically greater than the (i+1)-th suffix. You will be asked q queries of form:   i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) \xe2\x80\x94 flip the value of ai (if ai=0, then set ai to 1, and vice versa). After each query print the number of different strings that satisfy the given constraints modulo 998244353." 2800
1488G "Painting Numbers" "*special problem,data structures,greedy,number theory" "You are given n integers, each integer is from 1 to n, all of them are pairwise distinct. You have to paint them red and blue (each integer should have exactly one color).The cost of painting is the number of pairs (x,y) such that ymodx=0, y is red and x is blue.For each k\xe2\x88\x88[1,n], calculate the maximum cost of painting if exactly k integers should have a red color." 2500
1488F Dogecoin "*special problem,*special problem,binary search,data structures" "Recently, cryptocurrencies have become increasingly popular. Ann decided that it was about time she started mining the Dogecoin cryptocurrency. Ann\'s computer is not very powerful, so Ann mines exactly 1 Dogecoin per day. On the Internet, there are forecasts of the cost of 1 dogecoin for the next n days. Every day, Ann can sell any amount of dogecoin that she currently has. Note that if Ann mined Dogecoin on the i-th day, then she can sell it on the same day.Ann has not yet decided when to start mining. She has prepared q possible plans and for each of them wants to know the maximum profit that she can get. Each of the plans is described by two numbers l and r \xe2\x80\x94 the first and last days of mining. Note that Ann should not have any Dogecoin left after the r-th day." 2300
1488E "Palindromic Doubles" "*special problem,data structures,dp" "A subsequence is a sequence that can be obtained from another sequence by removing some elements without changing the order of the remaining elements.A palindromic sequence is a sequence that is equal to the reverse of itself.You are given a sequence of n integers a1,a2,\xe2\x80\xa6,an. Any integer value appears in a no more than twice.What is the length of the longest palindromic subsequence of sequence a?" 2200
1488D "Problemsolving Marathon" "*special problem,binary search,greedy" "Polycarp has decided to do a problemsolving marathon. He wants to solve s problems in n days. Let ai be the number of problems he solves during the i-th day. He wants to find a distribution of problems into days such that:   ai is an integer value for all i from 1 to n;  ai\xe2\x89\xa51 for all i from 1 to n;  ai+1\xe2\x89\xa5ai for all i from 1 to n\xe2\x88\x921;  ai+1\xe2\x89\xa42\xe2\x8b\x85ai for all i from 1 to n\xe2\x88\x921;  an is maximized. Note that a1 can be arbitrarily large.What is the largest value of an Polycarp can obtain?" 1900
1488C "Two Policemen" "*special problem,binary search,brute force,math" "There is a street that can be represented as an array of length n.There are two policemen patrolling a street: the first one is standing at the point x of the street and the second one is standing at the point y of the street.During one minute, both policemen can decide what to do (independently): move left (if the current position is greater than 1), move right (if the current position is less than n), or do nothing.The street is considered clear if each point of the street is visited by at least one policeman.Your task is to find the minimum number of minutes the policemen need to visit each point of the street (again, each point should be visited by at least one of them).You have to answer t independent test cases." 1900
1488B "RBS Deletion" "*special problem,greedy" "A bracket sequence is a string containing only characters ""("" and "")"". A regular bracket sequence (or, shortly, an RBS) is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example:  bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)"");  bracket sequences "")("", ""("" and "")"" are not. You are given a string s, which is an RBS. You can apply any number of operations to this string. Each operation can have one of the following types:  choose some non-empty prefix of s and remove it from s, so s is still an RBS. For example, we can apply this operation as follows: ""(())()(())()()"" \xe2\x86\x92 ""()()"" (the first 10 characters are removed);  choose some contiguous non-empty substring of s and remove it from s, so s is still an RBS. For example, we can apply this operation as follows: ""(())()(())()()"" \xe2\x86\x92 ""(())()()()"" (the characters from the 7-th to the 10-th are removed). The operation 2 can be applied at most k times. Calculate the maximum number of operations you can apply until s becomes empty." 1800
1488A "From Zero To Y" "*special problem,math" "You are given two positive (greater than zero) integers x and y. There is a variable k initially set to 0.You can perform the following two types of operations:   add 1 to k (i.\xe2\x80\x89e. assign k:=k+1);  add x\xe2\x8b\x8510p to k for some non-negative p (i.\xe2\x80\x89e. assign k:=k+x\xe2\x8b\x8510p for some p\xe2\x89\xa50). Find the minimum number of operations described above to set the value of k to y." 900
1487G "String Counting" combinatorics,dp,fft,math "You have c1 letters \'a\', c2 letters \'b\', ..., c26 letters \'z\'. You want to build a beautiful string of length n from them (obviously, you cannot use the i-th letter more than ci times). Each ci is greater than n3.A string is called beautiful if there are no palindromic contiguous substrings of odd length greater than 1 in it. For example, the string ""abacaba"" is not beautiful, it has several palindromic substrings of odd length greater than 1 (for example, ""aca""). Another example: the string ""abcaa"" is beautiful.Calculate the number of different strings you can build, and print the answer modulo 998244353." 2700
1487F Ones "dp,greedy,shortest paths" "You are given a positive (greater than zero) integer n.You have to represent n as the sum of integers (possibly negative) consisting only of ones (digits \'1\'). For example, 24=11+11+1+1 and 102=111\xe2\x88\x9211+1+1. Among all possible representations, you have to find the one that uses the minimum number of ones in total." 2900
1487E "Cheap Dinner" "brute force,data structures,graphs,greedy,implementation,sortings,two pointers" "Ivan wants to have a good dinner. A good dinner should consist of a first course, a second course, a drink, and a dessert.There are n1 different types of first courses Ivan can buy (the i-th of them costs ai coins), n2 different types of second courses (the i-th of them costs bi coins), n3 different types of drinks (the i-th of them costs ci coins) and n4 different types of desserts (the i-th of them costs di coins).Some dishes don\'t go well with each other. There are m1 pairs of first courses and second courses that don\'t go well with each other, m2 pairs of second courses and drinks, and m3 pairs of drinks and desserts that don\'t go well with each other.Ivan wants to buy exactly one first course, one second course, one drink, and one dessert so that they go well with each other, and the total cost of the dinner is the minimum possible. Help him to find the cheapest dinner option!" 2000
1487D "Pythagorean Triples" "binary search,brute force,math,number theory" "A Pythagorean triple is a triple of integer numbers (a,b,c) such that it is possible to form a right triangle with the lengths of the first cathetus, the second cathetus and the hypotenuse equal to a, b and c, respectively. An example of the Pythagorean triple is (3,4,5).Vasya studies the properties of right triangles, and he uses a formula that determines if some triple of integers is Pythagorean. Unfortunately, he has forgotten the exact formula; he remembers only that the formula was some equation with squares. So, he came up with the following formula: c=a2\xe2\x88\x92b.Obviously, this is not the right formula to check if a triple of numbers is Pythagorean. But, to Vasya\'s surprise, it actually worked on the triple (3,4,5): 5=32\xe2\x88\x924, so, according to Vasya\'s formula, it is a Pythagorean triple.When Vasya found the right formula (and understood that his formula is wrong), he wondered: how many are there triples of integers (a,b,c) with 1\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa4c\xe2\x89\xa4n such that they are Pythagorean both according to his formula and the real definition? He asked you to count these triples." 1500
1487C "Minimum Ties" "brute force,constructive algorithms,dfs and similar,graphs,greedy,implementation,math" "A big football championship will occur soon! n teams will compete in it, and each pair of teams will play exactly one game against each other.There are two possible outcomes of a game:  the game may result in a tie, then both teams get 1 point;  one team might win in a game, then the winning team gets 3 points and the losing team gets 0 points. The score of a team is the number of points it gained during all games that it played.You are interested in a hypothetical situation when all teams get the same score at the end of the championship. A simple example of that situation is when all games result in ties, but you want to minimize the number of ties as well.Your task is to describe a situation (choose the result of each game) so that all teams get the same score, and the number of ties is the minimum possible." 1500
1487B "Cat Cycle" "math,number theory" "Suppose you are living with two cats: A and B. There are n napping spots where both cats usually sleep.Your cats like to sleep and also like all these spots, so they change napping spot each hour cyclically:   Cat A changes its napping place in order: n,n\xe2\x88\x921,n\xe2\x88\x922,\xe2\x80\xa6,3,2,1,n,n\xe2\x88\x921,\xe2\x80\xa6 In other words, at the first hour it\'s on the spot n and then goes in decreasing order cyclically;  Cat B changes its napping place in order: 1,2,3,\xe2\x80\xa6,n\xe2\x88\x921,n,1,2,\xe2\x80\xa6 In other words, at the first hour it\'s on the spot 1 and then goes in increasing order cyclically. The cat B is much younger, so they have a strict hierarchy: A and B don\'t lie together. In other words, if both cats\'d like to go in spot x then the A takes this place and B moves to the next place in its order (if x<n then to x+1, but if x=n then to 1). Cat B follows his order, so it won\'t return to the skipped spot x after A frees it, but will move to the spot x+2 and so on.Calculate, where cat B will be at hour k?" 1200
1487A Arena implementation,sortings "n heroes fight against each other in the Arena. Initially, the i-th hero has level ai.Each minute, a fight between two different heroes occurs. These heroes can be chosen arbitrarily (it\'s even possible that it is the same two heroes that were fighting during the last minute).When two heroes of equal levels fight, nobody wins the fight. When two heroes of different levels fight, the one with the higher level wins, and his level increases by 1.The winner of the tournament is the first hero that wins in at least 100500 fights (note that it\'s possible that the tournament lasts forever if no hero wins this number of fights, then there is no winner). A possible winner is a hero such that there exists a sequence of fights that this hero becomes the winner of the tournament.Calculate the number of possible winners among n heroes." 800
1486F "Pairs of Paths" "combinatorics,data structures,dfs and similar,dp,trees" "You are given a tree consisting of n vertices, and m simple vertex paths. Your task is to find how many pairs of those paths intersect at exactly one vertex. More formally you have to find the number of pairs (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4m) such that pathi and pathj have exactly one vertex in common." 2600
1486E "Paired Payment" "binary search,brute force,constructive algorithms,dp,flows,graphs,shortest paths" "There are n cities and m bidirectional roads in the country. The roads in the country form an undirected weighted graph. The graph is not guaranteed to be connected. Each road has it\'s own parameter w. You can travel through the roads, but the government made a new law: you can only go through two roads at a time (go from city a to city b and then from city b to city c) and you will have to pay (wab+wbc)2 money to go through those roads. Find out whether it is possible to travel from city 1 to every other city t and what\'s the minimum amount of money you need to get from 1 to t." 2200
1486D "Max Median" "binary search,data structures,dp" "You are a given an array a of length n. Find a subarray a[l..r] with length at least k with the largest median.A median in an array of length n is an element which occupies position number \xe2\x8c\x8an+12\xe2\x8c\x8b after we sort the elements in non-decreasing order. For example: median([1,2,3,4])=2, median([3,2,1])=2, median([2,1,2,1])=1.Subarray a[l..r] is a contiguous part of the array a, i. e. the array al,al+1,\xe2\x80\xa6,ar for some 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, its length is r\xe2\x88\x92l+1." 2100
1486C2 "Guessing the Greatest (hard version)" "binary search,interactive" "The only difference between the easy and the hard version is the limit to the number of queries.This is an interactive problem.There is an array a of n different numbers. In one query you can ask the position of the second maximum element in a subsegment a[l..r]. Find the position of the maximum element in the array in no more than 20 queries.A subsegment a[l..r] is all the elements al,al+1,...,ar. After asking this subsegment you will be given the position of the second maximum from this subsegment in the whole array." 1900
1486C1 "Guessing the Greatest (easy version)" "binary search,interactive" "The only difference between the easy and the hard version is the limit to the number of queries.This is an interactive problem.There is an array a of n different numbers. In one query you can ask the position of the second maximum element in a subsegment a[l..r]. Find the position of the maximum element in the array in no more than 40 queries.A subsegment a[l..r] is all the elements al,al+1,...,ar. After asking this subsegment you will be given the position of the second maximum from this subsegment in the whole array." 1600
1486B "Eastern Exhibition" "binary search,geometry,shortest paths,sortings" "You and your friends live in n houses. Each house is located on a 2D plane, in a point with integer coordinates. There might be different houses located in the same point. The mayor of the city is asking you for places for the building of the Eastern exhibition. You have to find the number of places (points with integer coordinates), so that the summary distance from all the houses to the exhibition is minimal. The exhibition can be built in the same point as some house. The distance between two points (x1,y1) and (x2,y2) is |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|, where |x| is the absolute value of x." 1500
1486A "Shifting Stacks" greedy,implementation "You have n stacks of blocks. The i-th stack contains hi blocks and it\'s height is the number of blocks in it. In one move you can take a block from the i-th stack (if there is at least one block) and put it to the i+1-th stack. Can you make the sequence of heights strictly increasing?Note that the number of stacks always remains n: stacks don\'t disappear when they have 0 blocks." 900
1485F "Copy or Prefix Sum" "combinatorics,data structures,dp,sortings" "You are given an array of integers b1,b2,\xe2\x80\xa6,bn.An array a1,a2,\xe2\x80\xa6,an of integers is hybrid if for each i (1\xe2\x89\xa4i\xe2\x89\xa4n) at least one of these conditions is true:   bi=ai, or  bi=\xe2\x88\x91ij=1aj. Find the number of hybrid arrays a1,a2,\xe2\x80\xa6,an. As the result can be very large, you should print the answer modulo 109+7." 2400
1485E "Move and Swap" "dfs and similar,dp,greedy,trees" "You are given n\xe2\x88\x921 integers a2,\xe2\x80\xa6,an and a tree with n vertices rooted at vertex 1. The leaves are all at the same distance d from the root. Recall that a tree is a connected undirected graph without cycles. The distance between two vertices is the number of edges on the simple path between them. All non-root vertices with degree 1 are leaves. If vertices s and f are connected by an edge and the distance of f from the root is greater than the distance of s from the root, then f is called a child of s.Initially, there are a red coin and a blue coin on the vertex 1. Let r be the vertex where the red coin is and let b be the vertex where the blue coin is. You should make d moves. A move consists of three steps:   Move the red coin to any child of r.  Move the blue coin to any vertex b\xe2\x80\xb2 such that dist(1,b\xe2\x80\xb2)=dist(1,b)+1. Here dist(x,y) indicates the length of the simple path between x and y. Note that b and b\xe2\x80\xb2 are not necessarily connected by an edge.  You can optionally swap the two coins (or skip this step). Note that r and b can be equal at any time, and there is no number written on the root.After each move, you gain |ar\xe2\x88\x92ab| points. What\'s the maximum number of points you can gain after d moves?" 2500
1485D "Multiples and Power Differences" "constructive algorithms,graphs,math,number theory" "You are given a matrix a consisting of positive integers. It has n rows and m columns.Construct a matrix b consisting of positive integers. It should have the same size as a, and the following conditions should be met:   1\xe2\x89\xa4bi,j\xe2\x89\xa4106;  bi,j is a multiple of ai,j;  the absolute value of the difference between numbers in any adjacent pair of cells (two cells that share the same side) in b is equal to k4 for some integer k\xe2\x89\xa51 (k is not necessarily the same for all pairs, it is own for each pair). We can show that the answer always exists." 2200
1485C "Floor and Mod" "binary search,brute force,math,number theory" "A pair of positive integers (a,b) is called special if \xe2\x8c\x8aab\xe2\x8c\x8b=amodb. Here, \xe2\x8c\x8aab\xe2\x8c\x8b is the result of the integer division between a and b, while amodb is its remainder.You are given two integers x and y. Find the number of special pairs (a,b) such that 1\xe2\x89\xa4a\xe2\x89\xa4x and 1\xe2\x89\xa4b\xe2\x89\xa4y." 1700
1485B "Replace and Keep Sorted" dp,implementation,math "Given a positive integer k, two arrays are called k-similar if:  they are strictly increasing;  they have the same length;  all their elements are positive integers between 1 and k (inclusive);  they differ in exactly one position. You are given an integer k, a strictly increasing array a and q queries. For each query, you are given two integers li\xe2\x89\xa4ri. Your task is to find how many arrays b exist, such that b is k-similar to array [ali,ali+1\xe2\x80\xa6,ari]." 1200
1485A "Add and Divide" "brute force,greedy,math,number theory" "You have two positive integers a and b.You can perform two kinds of operations:  a=\xe2\x8c\x8aab\xe2\x8c\x8b (replace a with the integer part of the division between a and b)  b=b+1 (increase b by 1) Find the minimum number of operations required to make a=0." 1000
1482H Exam "data structures,string suffix structures,trees" "This year a Chunin Selection Exam is held again in Konoha, and taking part in it are n ninjas named s1, s2, ..., sn. All names are distinct. One of the exam stages consists of fights between the participants. This year the rules determining the ninjas for each fight are the following: ninjas i and j fight against each other if the following conditions are held:  i\xe2\x89\xa0j;  sj is a substring of si;  there is no k except i and j that sj is a substring of sk, and sk is a substring of si. A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.Your task is to find out how many fights are going to take place this year." 3400
1482G Vabank "binary search,interactive" "Gustaw is the chief bank manager in a huge bank. He has unlimited access to the database system of the bank, in a few clicks he can move any amount of money from the bank\'s reserves to his own private account. However, the bank uses some fancy AI fraud detection system that makes stealing more difficult.Gustaw knows that the anti-fraud system just detects any operation that exceeds some fixed limit M euros and these operations are checked manually by a number of clerks. Thus, any fraud operation exceeding this limit is detected, while any smaller operation gets unnoticed.Gustaw doesn\'t know the limit M and wants to find it out. In one operation, he can choose some integer X and try to move X euros from the bank\'s reserves to his own account. Then, the following happens.   If X\xe2\x89\xa4M, the operation is unnoticed and Gustaw\'s account balance raises by X euros.  Otherwise, if X>M, the fraud is detected and cancelled. Moreover, Gustaw has to pay X euros from his own account as a fine. If he has less than X euros on the account, he is fired and taken to the police. Initially Gustaw has 1 euro on his account. Help him find the exact value of M in no more than 105 operations without getting him fired." 3200
1482F "Useful Edges" "graphs,shortest paths" "You are given a weighted undirected graph on n vertices along with q triples (u,v,l), where in each triple u and v are vertices and l is a positive integer. An edge e is called useful if there is at least one triple (u,v,l) and a path (not necessarily simple) with the following properties:  u and v are the endpoints of this path,  e is one of the edges of this path,  the sum of weights of all edges on this path doesn\'t exceed l. Please print the number of useful edges in this graph." 2400
1482E "Skyline Photo" "data structures,divide and conquer,dp" "Alice is visiting New York City. To make the trip fun, Alice will take photos of the city skyline and give the set of photos as a present to Bob. However, she wants to find the set of photos with maximum beauty and she needs your help. There are n buildings in the city, the i-th of them has positive height hi. All n building heights in the city are different. In addition, each building has a beauty value bi. Note that beauty can be positive or negative, as there are ugly buildings in the city too. A set of photos consists of one or more photos of the buildings in the skyline. Each photo includes one or more buildings in the skyline that form a contiguous segment of indices. Each building needs to be in exactly one photo. This means that if a building does not appear in any photo, or if a building appears in more than one photo, the set of pictures is not valid. The beauty of a photo is equivalent to the beauty bi of the shortest building in it. The total beauty of a set of photos is the sum of the beauty of all photos in it. Help Alice to find the maximum beauty a valid set of photos can have." 2100
1482D Playlist "data structures,dsu,implementation,shortest paths" "Arkady has a playlist that initially consists of n songs, numerated from 1 to n in the order they appear in the playlist. Arkady starts listening to the songs in the playlist one by one, starting from song 1. The playlist is cycled, i. e. after listening to the last song, Arkady will continue listening from the beginning.Each song has a genre ai, which is a positive integer. Let Arkady finish listening to a song with genre y, and the genre of the next-to-last listened song be x. If gcd(x,y)=1, he deletes the last listened song (with genre y) from the playlist. After that he continues listening normally, skipping the deleted songs, and forgetting about songs he listened to before. In other words, after he deletes a song, he can\'t delete the next song immediately.Here gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y.For example, if the initial songs\' genres were [5,9,2,10,15], then the playlist is converted as follows: [5, 9, 2, 10, 15] \xe2\x86\x92 [5, 9, 2, 10, 15] \xe2\x86\x92 [5, 2, 10, 15] (because gcd(5,9)=1) \xe2\x86\x92 [5, 2, 10, 15] \xe2\x86\x92 [5, 2, 10, 15] \xe2\x86\x92 [5, 2, 10, 15] \xe2\x86\x92 [5, 2, 10, 15] \xe2\x86\x92 [5, 2, 10, 15] \xe2\x86\x92 [5, 10, 15] (because gcd(5,2)=1) \xe2\x86\x92 [5, 10, 15] \xe2\x86\x92 [5, 10, 15] \xe2\x86\x92 ... The bold numbers represent the two last played songs. Note that after a song is deleted, Arkady forgets that he listened to that and the previous songs.Given the initial playlist, please determine which songs are eventually deleted and the order these songs are deleted." 1900
1482C "Basic Diplomacy" "brute force,constructive algorithms,greedy,implementation" "Aleksey has n friends. He is also on a vacation right now, so he has m days to play this new viral cooperative game! But since it\'s cooperative, Aleksey will need one teammate in each of these m days.On each of these days some friends will be available for playing, and all others will not. On each day Aleksey must choose one of his available friends to offer him playing the game (and they, of course, always agree). However, if any of them happens to be chosen strictly more than \xe2\x8c\x88m2\xe2\x8c\x89 times, then all other friends are offended. Of course, Aleksey doesn\'t want to offend anyone.Help him to choose teammates so that nobody is chosen strictly more than \xe2\x8c\x88m2\xe2\x8c\x89 times." 1600
1482B "Restore Modulo" implementation,math "For the first place at the competition, Alex won many arrays of integers and was assured that these arrays are very expensive. After the award ceremony Alex decided to sell them. There is a rule in arrays pawnshop: you can sell array only if it can be compressed to a generator.This generator takes four non-negative numbers n, m, c, s. n and m must be positive, s non-negative and for c it must be true that 0\xe2\x89\xa4c<m. The array a of length n is created according to the following rules:   a1=smodm, here xmody denotes remainder of the division of x by y;  ai=(ai\xe2\x88\x921+c)modm for all i such that 1<i\xe2\x89\xa4n. For example, if n=5, m=7, c=4, and s=10, then a=[3,0,4,1,5].Price of such an array is the value of m in this generator.Alex has a question: how much money he can get for each of the arrays. Please, help him to understand for every array whether there exist four numbers n, m, c, s that generate this array. If yes, then maximize m." 1500
1482A "Prison Break" math "Michael is accused of violating the social distancing rules and creating a risk of spreading coronavirus. He is now sent to prison. Luckily, Michael knows exactly what the prison looks like from the inside, especially since it\'s very simple.The prison can be represented as a rectangle a\xc3\x97b which is divided into ab cells, each representing a prison cell, common sides being the walls between cells, and sides on the perimeter being the walls leading to freedom. Before sentencing, Michael can ask his friends among the prison employees to make (very well hidden) holes in some of the walls (including walls between cells and the outermost walls). Michael wants to be able to get out of the prison after this, no matter which cell he is placed in. However, he also wants to break as few walls as possible.Your task is to find out the smallest number of walls to be broken so that there is a path to the outside from every cell after this." 800
1481F "AB Tree" dp,greedy,trees "Kilani and Abd are neighbors for 3000 years, but then the day came and Kilani decided to move to another house. As a farewell gift, Kilani is going to challenge Abd with a problem written by their other neighbor with the same name Abd.  The problem is:You are given a connected tree rooted at node 1.You should assign a character a or b to every node in the tree so that the total number of a\'s is equal to x and the total number of b\'s is equal to n\xe2\x88\x92x.Let\'s define a string for each node v of the tree as follows:   if v is root then the string is just one character assigned to v:  otherwise, let\'s take a string defined for the v\'s parent pv and add to the end of it a character assigned to v. You should assign every node a character in a way that minimizes the number of distinct strings among the strings of all nodes." 3100
1481E "Sorting Books" "data structures,dp,greedy" "One day you wanted to read something, so you went to your bookshelf to grab some book. But when you saw how messy the bookshelf was you decided to clean it up first.  There are n books standing in a row on the shelf, the i-th book has color ai.You\'d like to rearrange the books to make the shelf look beautiful. The shelf is considered beautiful if all books of the same color are next to each other.In one operation you can take one book from any position on the shelf and move it to the right end of the shelf.What is the minimum number of operations you need to make the shelf beautiful?" 2500
1481D "AB Graph" "brute force,constructive algorithms,graphs,greedy,implementation" "Your friend Salem is Warawreh\'s brother and only loves math and geometry problems. He has solved plenty of such problems, but according to Warawreh, in order to graduate from university he has to solve more graph problems. Since Salem is not good with graphs he asked your help with the following problem.  You are given a complete directed graph with n vertices without self-loops. In other words, you have n vertices and each pair of vertices u and v (u\xe2\x89\xa0v) has both directed edges (u,v) and (v,u).Every directed edge of the graph is labeled with a single character: either \'a\' or \'b\' (edges (u,v) and (v,u) may have different labels).You are also given an integer m>0. You should find a path of length m such that the string obtained by writing out edges\' labels when going along the path is a palindrome. The length of the path is the number of edges in it.You can visit the same vertex and the same directed edge any number of times." 2000
1481C "Fence Painting" "brute force,constructive algorithms,greedy" "You finally woke up after this crazy dream and decided to walk around to clear your head. Outside you saw your house\'s fence \xe2\x80\x94 so plain and boring, that you\'d like to repaint it.  You have a fence consisting of n planks, where the i-th plank has the color ai. You want to repaint the fence in such a way that the i-th plank has the color bi.You\'ve invited m painters for this purpose. The j-th painter will arrive at the moment j and will recolor exactly one plank to color cj. For each painter you can choose which plank to recolor, but you can\'t turn them down, i. e. each painter has to color exactly one plank.Can you get the coloring b you want? If it\'s possible, print for each painter which plank he must paint." 1600
1481B "New Colony" "brute force,greedy,implementation" "After reaching your destination, you want to build a new colony on the new planet. Since this planet has many mountains and the colony must be built on a flat surface you decided to flatten the mountains using boulders (you are still dreaming so this makes sense to you).  You are given an array h1,h2,\xe2\x80\xa6,hn, where hi is the height of the i-th mountain, and k \xe2\x80\x94 the number of boulders you have.You will start throwing boulders from the top of the first mountain one by one and they will roll as follows (let\'s assume that the height of the current mountain is hi):   if hi\xe2\x89\xa5hi+1, the boulder will roll to the next mountain;  if hi<hi+1, the boulder will stop rolling and increase the mountain height by 1 (hi=hi+1);  if the boulder reaches the last mountain it will fall to the waste collection system and disappear. You want to find the position of the k-th boulder or determine that it will fall into the waste collection system." 1100
1481A "Space Navigation" greedy,strings "You were dreaming that you are traveling to a planet named Planetforces on your personal spaceship. Unfortunately, its piloting system was corrupted and now you need to fix it in order to reach Planetforces.  Space can be represented as the XY plane. You are starting at point (0,0), and Planetforces is located in point (px,py).The piloting system of your spaceship follows its list of orders which can be represented as a string s. The system reads s from left to right. Suppose you are at point (x,y) and current order is si:   if si=U, you move to (x,y+1);  if si=D, you move to (x,y\xe2\x88\x921);  if si=R, you move to (x+1,y);  if si=L, you move to (x\xe2\x88\x921,y). Since string s could be corrupted, there is a possibility that you won\'t reach Planetforces in the end. Fortunately, you can delete some orders from s but you can\'t change their positions.Can you delete several orders (possibly, zero) from s in such a way, that you\'ll reach Planetforces after the system processes all orders?" 800
1480B "The Great Hero" greedy,implementation,sortings "The great hero guards the country where Homer lives. The hero has attack power A and initial health value B. There are n monsters in front of the hero. The i-th monster has attack power ai and initial health value bi. The hero or a monster is said to be living, if his or its health value is positive (greater than or equal to 1); and he or it is said to be dead, if his or its health value is non-positive (less than or equal to 0).In order to protect people in the country, the hero will fight with monsters until either the hero is dead or all the monsters are dead.  In each fight, the hero can select an arbitrary living monster and fight with it. Suppose the i-th monster is selected, and the health values of the hero and the i-th monster are x and y before the fight, respectively. After the fight, the health values of the hero and the i-th monster become x\xe2\x88\x92ai and y\xe2\x88\x92A, respectively. Note that the hero can fight the same monster more than once.For the safety of the people in the country, please tell them whether the great hero can kill all the monsters (even if the great hero himself is dead after killing the last monster)." 900
1480A "Yet Another String Game" games,greedy,strings "Homer has two friends Alice and Bob. Both of them are string fans. One day, Alice and Bob decide to play a game on a string s=s1s2\xe2\x80\xa6sn of length n consisting of lowercase English letters. They move in turns alternatively and Alice makes the first move.In a move, a player must choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) that has not been chosen before, and change si to any other lowercase English letter c that c\xe2\x89\xa0si.When all indices have been chosen, the game ends. The goal of Alice is to make the final string lexicographically as small as possible, while the goal of Bob is to make the final string lexicographically as large as possible. Both of them are game experts, so they always play games optimally. Homer is not a game expert, so he wonders what the final string will be.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 800
1479E "School Clubs" "dp,fft,math,number theory,probabilities" "In Homer\'s school, there are n students who love clubs. Initially, there are m clubs, and each of the n students is in exactly one club. In other words, there are ai students in the i-th club for 1\xe2\x89\xa4i\xe2\x89\xa4m and a1+a2+\xe2\x8b\xaf+am=n.The n students are so unfriendly that every day one of them (chosen uniformly at random from all of the n students) gets angry. The student who gets angry will do one of the following things.   With probability 12, he leaves his current club, then creates a new club himself and joins it. There is only one student (himself) in the new club he creates.  With probability 12, he does not create new clubs. In this case, he changes his club to a new one (possibly the same club he is in currently) with probability proportional to the number of students in it. Formally, suppose there are k clubs and there are bi students in the i-th club for 1\xe2\x89\xa4i\xe2\x89\xa4k (before the student gets angry). He leaves his current club, and then joins the i-th club with probability bin.  We note that when a club becomes empty, students will never join it because any student who gets angry will join an empty club with probability 0 according to the above statement.Homer wonders the expected number of days until every student is in the same club for the first time.We can prove that the answer can be represented as a rational number pq with gcd(p,q)=1. Therefore, you are asked to find the value of pq\xe2\x88\x921mod998244353. It can be shown that qmod998244353\xe2\x89\xa00 under the given constraints of the problem." 3500
1479D "Odd Mineral Resource" "binary search,bitmasks,brute force,data structures,probabilities,trees" "In Homer\'s country, there are n cities numbered 1 to n and they form a tree. That is, there are (n\xe2\x88\x921) undirected roads between these n cities and every two cities can reach each other through these roads. Homer\'s country is an industrial country, and each of the n cities in it contains some mineral resource. The mineral resource of city i is labeled ai. Homer is given the plans of the country in the following q years. The plan of the i-th year is described by four parameters ui,vi,li and ri, and he is asked to find any mineral resource ci such that the following two conditions hold:   mineral resource ci appears an odd number of times between city ui and city vi; and  li\xe2\x89\xa4ci\xe2\x89\xa4ri. As the best friend of Homer, he asks you for help. For every plan, find any such mineral resource ci, or tell him that there doesn\'t exist one." 2900
1479C "Continuous City" "bitmasks,constructive algorithms" "Some time ago Homer lived in a beautiful city. There were n blocks numbered from 1 to n and m directed roads between them. Each road had a positive length, and each road went from the block with the smaller index to the block with the larger index. For every two (different) blocks, there was at most one road between them. Homer discovered that for some two numbers L and R the city was (L,R)-continuous. The city is said to be (L,R)-continuous, if   all paths from block 1 to block n are of length between L and R (inclusive); and  for every L\xe2\x89\xa4d\xe2\x89\xa4R, there is exactly one path from block 1 to block n whose length is d. A path from block u to block v is a sequence u=x0\xe2\x86\x92x1\xe2\x86\x92x2\xe2\x86\x92\xe2\x8b\xaf\xe2\x86\x92xk=v, where there is a road from block xi\xe2\x88\x921 to block xi for every 1\xe2\x89\xa4i\xe2\x89\xa4k. The length of a path is the sum of lengths over all roads in the path. Two paths x0\xe2\x86\x92x1\xe2\x86\x92\xe2\x8b\xaf\xe2\x86\x92xk and y0\xe2\x86\x92y1\xe2\x86\x92\xe2\x8b\xaf\xe2\x86\x92yl are different, if k\xe2\x89\xa0l or xi\xe2\x89\xa0yi for some 0\xe2\x89\xa4i\xe2\x89\xa4min{k,l}. After moving to another city, Homer only remembers the two special numbers L and R but forgets the numbers n and m of blocks and roads, respectively, and how blocks are connected by roads. However, he believes the number of blocks should be no larger than 32 (because the city was small).As the best friend of Homer, please tell him whether it is possible to find a (L,R)-continuous city or not." 2500
1479B2 "Painting the Array II" "constructive algorithms,data structures,dp,greedy,implementation" "The only difference between the two versions is that this version asks the minimal possible answer.Homer likes arrays a lot. Today he is painting an array a1,a2,\xe2\x80\xa6,an with two kinds of colors, white and black. A painting assignment for a1,a2,\xe2\x80\xa6,an is described by an array b1,b2,\xe2\x80\xa6,bn that bi indicates the color of ai (0 for white and 1 for black).According to a painting assignment b1,b2,\xe2\x80\xa6,bn, the array a is split into two new arrays a(0) and a(1), where a(0) is the sub-sequence of all white elements in a and a(1) is the sub-sequence of all black elements in a. For example, if a=[1,2,3,4,5,6] and b=[0,1,0,1,0,0], then a(0)=[1,3,5,6] and a(1)=[2,4].The number of segments in an array c1,c2,\xe2\x80\xa6,ck, denoted seg(c), is the number of elements if we merge all adjacent elements with the same value in c. For example, the number of segments in [1,1,2,2,3,3,3,2] is 4, because the array will become [1,2,3,2] after merging adjacent elements with the same value. Especially, the number of segments in an empty array is 0.Homer wants to find a painting assignment b, according to which the number of segments in both a(0) and a(1), i.e. seg(a(0))+seg(a(1)), is as small as possible. Find this number." 2100
1479B1 "Painting the Array I" "constructive algorithms,data structures,dp,greedy,implementation" "The only difference between the two versions is that this version asks the maximal possible answer.Homer likes arrays a lot. Today he is painting an array a1,a2,\xe2\x80\xa6,an with two kinds of colors, white and black. A painting assignment for a1,a2,\xe2\x80\xa6,an is described by an array b1,b2,\xe2\x80\xa6,bn that bi indicates the color of ai (0 for white and 1 for black).According to a painting assignment b1,b2,\xe2\x80\xa6,bn, the array a is split into two new arrays a(0) and a(1), where a(0) is the sub-sequence of all white elements in a and a(1) is the sub-sequence of all black elements in a. For example, if a=[1,2,3,4,5,6] and b=[0,1,0,1,0,0], then a(0)=[1,3,5,6] and a(1)=[2,4].The number of segments in an array c1,c2,\xe2\x80\xa6,ck, denoted seg(c), is the number of elements if we merge all adjacent elements with the same value in c. For example, the number of segments in [1,1,2,2,3,3,3,2] is 4, because the array will become [1,2,3,2] after merging adjacent elements with the same value. Especially, the number of segments in an empty array is 0.Homer wants to find a painting assignment b, according to which the number of segments in both a(0) and a(1), i.e. seg(a(0))+seg(a(1)), is as large as possible. Find this number." 1900
1479A "Searching Local Minimum" "binary search,interactive,ternary search" "This is an interactive problem.Homer likes arrays a lot and he wants to play a game with you. Homer has hidden from you a permutation a1,a2,\xe2\x80\xa6,an of integers 1 to n. You are asked to find any index k (1\xe2\x89\xa4k\xe2\x89\xa4n) which is a local minimum. For an array a1,a2,\xe2\x80\xa6,an, an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) is said to be a local minimum if ai<min{ai\xe2\x88\x921,ai+1}, where a0=an+1=+\xe2\x88\x9e. An array is said to be a permutation of integers 1 to n, if it contains all integers from 1 to n exactly once.Initially, you are only given the value of n without any other information about this permutation.At each interactive step, you are allowed to choose any i (1\xe2\x89\xa4i\xe2\x89\xa4n) and make a query with it. As a response, you will be given the value of ai. You are asked to find any index k which is a local minimum after at most 100 queries." 1700
1478C "Nezzar and Symmetric Array" implementation,math,sortings "Long time ago there was a symmetric array a1,a2,\xe2\x80\xa6,a2n consisting of 2n distinct integers. Array a1,a2,\xe2\x80\xa6,a2n is called symmetric if for each integer 1\xe2\x89\xa4i\xe2\x89\xa42n, there exists an integer 1\xe2\x89\xa4j\xe2\x89\xa42n such that ai=\xe2\x88\x92aj.For each integer 1\xe2\x89\xa4i\xe2\x89\xa42n, Nezzar wrote down an integer di equal to the sum of absolute differences from ai to all integers in a, i. e. di=\xe2\x88\x912nj=1|ai\xe2\x88\x92aj|.Now a million years has passed and Nezzar can barely remember the array d and totally forget a. Nezzar wonders if there exists any symmetric array a consisting of 2n distinct integers that generates the array d." 1700
1478B "Nezzar and Lucky Number" "brute force,dp,greedy,math" "Nezzar\'s favorite digit among 1,\xe2\x80\xa6,9 is d. He calls a positive integer lucky if d occurs at least once in its decimal representation. Given q integers a1,a2,\xe2\x80\xa6,aq, for each 1\xe2\x89\xa4i\xe2\x89\xa4q Nezzar would like to know if ai can be equal to a sum of several (one or more) lucky numbers." 1100
1478A "Nezzar and Colorful Balls" "brute force,greedy" "Nezzar has n balls, numbered with integers 1,2,\xe2\x80\xa6,n. Numbers a1,a2,\xe2\x80\xa6,an are written on them, respectively. Numbers on those balls form a non-decreasing sequence, which means that ai\xe2\x89\xa4ai+1 for all 1\xe2\x89\xa4i<n.Nezzar wants to color the balls using the minimum number of colors, such that the following holds.  For any color, numbers on balls will form a strictly increasing sequence if he keeps balls with this chosen color and discards all other balls.  Note that a sequence with the length at most 1 is considered as a strictly increasing sequence.Please help Nezzar determine the minimum number of colors." 800
1477F "Nezzar and Chocolate Bars" combinatorics,fft,math,probabilities "Nezzar buys his favorite snack \xe2\x80\x94 n chocolate bars with lengths l1,l2,\xe2\x80\xa6,ln. However, chocolate bars might be too long to store them properly! In order to solve this problem, Nezzar designs an interesting process to divide them into small pieces. Firstly, Nezzar puts all his chocolate bars into a black box. Then, he will perform the following operation repeatedly until the maximum length over all chocolate bars does not exceed k.  Nezzar picks a chocolate bar from the box with probability proportional to its length x.  After step 1, Nezzar uniformly picks a real number r\xe2\x88\x88(0,x) and divides the chosen chocolate bar into two chocolate bars with lengths r and x\xe2\x88\x92r.  Lastly, he puts those two new chocolate bars into the black box. Nezzar now wonders, what is the expected number of operations he will perform to divide his chocolate bars into small pieces.It can be shown that the answer can be represented as PQ, where P and Q are coprime integers and Q\xe2\x89\xa20 (mod998244353). Print the value of P\xe2\x8b\x85Q\xe2\x88\x921mod998244353." 3500
1477E "Nezzar and Tournaments" "data structures,greedy" "In the famous Oh-Suit-United tournament, two teams are playing against each other for the grand prize of precious pepper points.The first team consists of n players, and the second team consists of m players. Each player has a potential: the potential of the i-th player in the first team is ai, and the potential of the i-th player in the second team is bi.In the tournament, all players will be on the stage in some order. There will be a scoring device, initially assigned to an integer k, which will be used to value the performance of all players.The scores for all players will be assigned in the order they appear on the stage. Let the potential of the current player be x, and the potential of the previous player be y (y equals x for the first player). Then, x\xe2\x88\x92y is added to the value in the scoring device, Afterwards, if the value in the scoring device becomes negative, the value will be reset to 0. Lastly, the player\'s score is assigned to the current value on the scoring device. The score of a team is the sum of the scores of all its members.As an insane fan of the first team, Nezzar desperately wants the biggest win for the first team. He now wonders what is the maximum difference between scores of the first team and the second team.Formally, let the score of the first team be scoref and the score of the second team be scores. Nezzar wants to find the maximum value of scoref\xe2\x88\x92scores over all possible orders of players on the stage.However, situation often changes and there are q events that will happen. There are three types of events:  1 pos x \xe2\x80\x94 change apos to x;  2 pos x \xe2\x80\x94 change bpos to x;  3 x \xe2\x80\x94 tournament is held with k=x and Nezzar wants you to compute the maximum value of scoref\xe2\x88\x92scores. Can you help Nezzar to answer the queries of the third type?" 3300
1477D "Nezzar and Hidden Permutations" "constructive algorithms,dfs and similar,graphs" "Nezzar designs a brand new game ""Hidden Permutations"" and shares it with his best friend, Nanako.At the beginning of the game, Nanako and Nezzar both know integers n and m. The game goes in the following way:  Firstly, Nezzar hides two permutations p1,p2,\xe2\x80\xa6,pn and q1,q2,\xe2\x80\xa6,qn of integers from 1 to n, and Nanako secretly selects m unordered pairs (l1,r1),(l2,r2),\xe2\x80\xa6,(lm,rm);  After that, Nanako sends his chosen pairs to Nezzar;  On receiving those m unordered pairs, Nezzar checks if there exists 1\xe2\x89\xa4i\xe2\x89\xa4m, such that (pli\xe2\x88\x92pri) and (qli\xe2\x88\x92qri) have different signs. If so, Nezzar instantly loses the game and gets a score of \xe2\x88\x921. Otherwise, the score Nezzar gets is equal to the number of indices 1\xe2\x89\xa4i\xe2\x89\xa4n such that pi\xe2\x89\xa0qi. However, Nezzar accidentally knows Nanako\'s unordered pairs and decides to take advantage of them. Please help Nezzar find out two permutations p and q such that the score is maximized." 2800
1477C "Nezzar and Nice Beatmap" "constructive algorithms,geometry,greedy,math,sortings" "Nezzar loves the game osu!.osu! is played on beatmaps, which can be seen as an array consisting of distinct points on a plane. A beatmap is called nice if for any three consecutive points A,B,C listed in order, the angle between these three points, centered at B, is strictly less than 90 degrees.  Points A,B,C on the left have angle less than 90 degrees, so they can be three consecutive points of a nice beatmap; Points A\xe2\x80\xb2,B\xe2\x80\xb2,C\xe2\x80\xb2 on the right have angle greater or equal to 90 degrees, so they cannot be three consecutive points of a nice beatmap. Now Nezzar has a beatmap of n distinct points A1,A2,\xe2\x80\xa6,An. Nezzar would like to reorder these n points so that the resulting beatmap is nice.Formally, you are required to find a permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n, such that beatmap Ap1,Ap2,\xe2\x80\xa6,Apn is nice. If it is impossible, you should determine it." 2200
1477B "Nezzar and Binary String" "data structures,greedy" "Nezzar has a binary string s of length n that he wants to share with his best friend, Nanako. Nanako will spend q days inspecting the binary string. At the same time, Nezzar wants to change the string s into string f during these q days, because it looks better.It is known that Nanako loves consistency so much. On the i-th day, Nanako will inspect a segment of string s from position li to position ri inclusive. If the segment contains both characters \'0\' and \'1\', Nanako becomes unhappy and throws away the string.After this inspection, at the i-th night, Nezzar can secretly change strictly less than half of the characters in the segment from li to ri inclusive, otherwise the change will be too obvious.Now Nezzar wonders, if it is possible to avoid Nanako being unhappy and at the same time have the string become equal to the string f at the end of these q days and nights." 1900
1477A "Nezzar and Board" "constructive algorithms,math,number theory" "n distinct integers x1,x2,\xe2\x80\xa6,xn are written on the board. Nezzar can perform the following operation multiple times.  Select two integers x,y (not necessarily distinct) on the board, and write down 2x\xe2\x88\x92y. Note that you don\'t remove selected numbers. Now, Nezzar wonders if it is possible to have his favorite number k on the board after applying above operation multiple times." 1800
1476G "Minimum Difference" "data structures,hashing,sortings,two pointers" "You are given an integer array a of size n.You have to perform m queries. Each query has one of two types:   ""1 l r k"" \xe2\x80\x94 calculate the minimum value dif such that there are exist k distinct integers x1,x2,\xe2\x80\xa6,xk such that cnti>0 (for every i\xe2\x88\x88[1,k]) and |cnti\xe2\x88\x92cntj|\xe2\x89\xa4dif (for every i\xe2\x88\x88[1,k],j\xe2\x88\x88[1,k]), where cnti is the number of occurrences of xi in the subarray a[l..r]. If it is impossible to choose k integers, report it;  ""2 p x"" \xe2\x80\x94 assign ap:=x." 3100
1476F Lanterns "binary search,data structures,dp" "There are n lanterns in a row. The lantern i is placed in position i and has power equal to pi.Each lantern can be directed to illuminate either some lanterns to the left or some lanterns to the right. If the i-th lantern is turned to the left, it illuminates all such lanterns j that j\xe2\x88\x88[i\xe2\x88\x92pi,i\xe2\x88\x921]. Similarly, if it is turned to the right, it illuminates all such lanterns j that j\xe2\x88\x88[i+1,i+pi].Your goal is to choose a direction for each lantern so each lantern is illuminated by at least one other lantern, or report that it is impossible." 3000
1476E "Pattern Matching" "bitmasks,data structures,dfs and similar,graphs,hashing,sortings,strings" "You are given n patterns p1,p2,\xe2\x80\xa6,pn and m strings s1,s2,\xe2\x80\xa6,sm. Each pattern pi consists of k characters that are either lowercase Latin letters or wildcard characters (denoted by underscores). All patterns are pairwise distinct. Each string sj consists of k lowercase Latin letters.A string a matches a pattern b if for each i from 1 to k either bi is a wildcard character or bi=ai.You are asked to rearrange the patterns in such a way that the first pattern the j-th string matches is p[mtj]. You are allowed to leave the order of the patterns unchanged.Can you perform such a rearrangement? If you can, then print any valid order." 2300
1476D Journey "dfs and similar,dp,dsu,implementation" "There are n+1 cities, numbered from 0 to n. n roads connect these cities, the i-th road connects cities i\xe2\x88\x921 and i (i\xe2\x88\x88[1,n]).Each road has a direction. The directions are given by a string of n characters such that each character is either L or R. If the i-th character is L, it means that the i-th road initially goes from the city i to the city i\xe2\x88\x921; otherwise it goes from the city i\xe2\x88\x921 to the city i.A traveler would like to visit as many cities of this country as possible. Initially, they will choose some city to start their journey from. Each day, the traveler must go from the city where they currently are to a neighboring city using one of the roads, and they can go along a road only if it is directed in the same direction they are going; i.\xe2\x80\x89e., if a road is directed from city i to the city i+1, it is possible to travel from i to i+1, but not from i+1 to i. After the traveler moves to a neighboring city, all roads change their directions to the opposite ones. If the traveler cannot go from their current city to a neighboring city, their journey ends; it is also possible to end the journey whenever the traveler wants to.The goal of the traveler is to visit as many different cities as possible (they can visit a city multiple times, but only the first visit is counted). For each city i, calculate the maximum number of different cities the traveler can visit during exactly one journey if they start in the city i." 1700
1476C "Longest Simple Cycle" dp,graphs,greedy "You have n chains, the i-th chain consists of ci vertices. Vertices in each chain are numbered independently from 1 to ci along the chain. In other words, the i-th chain is the undirected graph with ci vertices and (ci\xe2\x88\x921) edges connecting the j-th and the (j+1)-th vertices for each 1\xe2\x89\xa4j<ci.Now you decided to unite chains in one graph in the following way:   the first chain is skipped;  the 1-st vertex of the i-th chain is connected by an edge with the ai-th vertex of the (i\xe2\x88\x921)-th chain;  the last (ci-th) vertex of the i-th chain is connected by an edge with the bi-th vertex of the (i\xe2\x88\x921)-th chain.   Picture of the first test case. Dotted lines are the edges added during uniting process Calculate the length of the longest simple cycle in the resulting graph.A simple cycle is a chain where the first and last vertices are connected as well. If you travel along the simple cycle, each vertex of this cycle will be visited exactly once." 1600
1476B Inflation "binary search,brute force,greedy,math" "You have a statistic of price changes for one product represented as an array of n positive integers p0,p1,\xe2\x80\xa6,pn\xe2\x88\x921, where p0 is the initial price of the product and pi is how the price was increased during the i-th month.Using these price changes you are asked to calculate the inflation coefficients for each month as the ratio of current price increase pi to the price at the start of this month (p0+p1+\xe2\x8b\xaf+pi\xe2\x88\x921).Your boss said you clearly that the inflation coefficients must not exceed k %, so you decided to increase some values pi in such a way, that all pi remain integers and the inflation coefficients for each month don\'t exceed k %.You know, that the bigger changes \xe2\x80\x94 the more obvious cheating. That\'s why you need to minimize the total sum of changes.What\'s the minimum total sum of changes you need to make all inflation coefficients not more than k %?" 1300
1476A "K-divisible Sum" "binary search,constructive algorithms,greedy,math" "You are given two integers n and k.You should create an array of n positive integers a1,a2,\xe2\x80\xa6,an such that the sum (a1+a2+\xe2\x8b\xaf+an) is divisible by k and maximum element in a is minimum possible.What is the minimum possible maximum element in a?" 1000
1475G "Strange Beauty" "dp,math,number theory,sortings" "Polycarp found on the street an array a of n elements.Polycarp invented his criterion for the beauty of an array. He calls an array a beautiful if at least one of the following conditions must be met for each different pair of indices i\xe2\x89\xa0j:   ai is divisible by aj;  or aj is divisible by ai. For example, if:   n=5 and a=[7,9,3,14,63], then the a array is not beautiful (for i=4 and j=2, none of the conditions above is met);  n=3 and a=[2,14,42], then the a array is beautiful;  n=4 and a=[45,9,3,18], then the a array is not beautiful (for i=1 and j=4 none of the conditions above is met); Ugly arrays upset Polycarp, so he wants to remove some elements from the array a so that it becomes beautiful. Help Polycarp determine the smallest number of elements to remove to make the array a beautiful." 1900
1475F "Unusual Matrix" "2-sat,brute force,constructive algorithms" "You are given two binary square matrices a and b of size n\xc3\x97n. A matrix is called binary if each of its elements is equal to 0 or 1. You can do the following operations on the matrix a arbitrary number of times (0 or more):   vertical xor. You choose the number j (1\xe2\x89\xa4j\xe2\x89\xa4n) and for all i (1\xe2\x89\xa4i\xe2\x89\xa4n) do the following: ai,j:=ai,j\xe2\x8a\x951 (\xe2\x8a\x95 \xe2\x80\x94 is the operation xor (exclusive or)).  horizontal xor. You choose the number i (1\xe2\x89\xa4i\xe2\x89\xa4n) and for all j (1\xe2\x89\xa4j\xe2\x89\xa4n) do the following: ai,j:=ai,j\xe2\x8a\x951. Note that the elements of the a matrix change after each operation.For example, if n=3 and the matrix a is: (110001110) Then the following sequence of operations shows an example of transformations:   vertical xor, j=1. a=(010101010)  horizontal xor, i=2. a=(010010010)  vertical xor, j=2. a=(000000000) Check if there is a sequence of operations such that the matrix a becomes equal to the matrix b." 1900
1475E "Advertising Agency" combinatorics,math,sortings "Masha works in an advertising agency. In order to promote the new brand, she wants to conclude contracts with some bloggers. In total, Masha has connections of n different bloggers. Blogger numbered i has ai followers.Since Masha has a limited budget, she can only sign a contract with k different bloggers. Of course, Masha wants her ad to be seen by as many people as possible. Therefore, she must hire bloggers with the maximum total number of followers.Help her, find the number of ways to select k bloggers so that the total number of their followers is maximum possible. Two ways are considered different if there is at least one blogger in the first way, which is not in the second way. Masha believes that all bloggers have different followers (that is, there is no follower who would follow two different bloggers).For example, if n=4, k=3, a=[1,3,1,2], then Masha has two ways to select 3 bloggers with the maximum total number of followers:   conclude contracts with bloggers with numbers 1, 2 and 4. In this case, the number of followers will be equal to a1+a2+a4=6.  conclude contracts with bloggers with numbers 2, 3 and 4. In this case, the number of followers will be equal to a2+a3+a4=6. Since the answer can be quite large, output it modulo 109+7." 1600
1475D "Cleaning the Phone" "binary search,dp,sortings,two pointers" "Polycarp often uses his smartphone. He has already installed n applications on it. Application with number i takes up ai units of memory.Polycarp wants to free at least m units of memory (by removing some applications).Of course, some applications are more important to Polycarp than others. He came up with the following scoring system \xe2\x80\x94 he assigned an integer bi to each application:   bi=1 \xe2\x80\x94 regular application;  bi=2 \xe2\x80\x94 important application. According to this rating system, his phone has b1+b2+\xe2\x80\xa6+bn convenience points.Polycarp believes that if he removes applications with numbers i1,i2,\xe2\x80\xa6,ik, then he will free ai1+ai2+\xe2\x80\xa6+aik units of memory and lose bi1+bi2+\xe2\x80\xa6+bik convenience points.For example, if n=5, m=7, a=[5,3,2,1,4], b=[2,1,1,2,1], then Polycarp can uninstall the following application sets (not all options are listed below):   applications with numbers 1,4 and 5. In this case, it will free a1+a4+a5=10 units of memory and lose b1+b4+b5=5 convenience points;  applications with numbers 1 and 3. In this case, it will free a1+a3=7 units of memory and lose b1+b3=3 convenience points.  applications with numbers 2 and 5. In this case, it will free a2+a5=7 memory units and lose b2+b5=2 convenience points. Help Polycarp, choose a set of applications, such that if removing them will free at least m units of memory and lose the minimum number of convenience points, or indicate that such a set does not exist." 1800
1475C "Ball in Berland" combinatorics,graphs,math "At the school where Vasya is studying, preparations are underway for the graduation ceremony. One of the planned performances is a ball, which will be attended by pairs of boys and girls.Each class must present two couples to the ball. In Vasya\'s class, a boys and b girls wish to participate. But not all boys and not all girls are ready to dance in pairs.Formally, you know k possible one-boy-one-girl pairs. You need to choose two of these pairs so that no person is in more than one pair.For example, if a=3, b=4, k=4 and the couples (1,2), (1,3), (2,2), (3,4) are ready to dance together (in each pair, the boy\'s number comes first, then the girl\'s number), then the following combinations of two pairs are possible (not all possible options are listed below):   (1,3) and (2,2);  (3,4) and (1,3); But the following combinations are not possible:   (1,3) and (1,2) \xe2\x80\x94 the first boy enters two pairs;  (1,2) and (2,2) \xe2\x80\x94 the second girl enters two pairs; Find the number of ways to select two pairs that match the condition above. Two ways are considered different if they consist of different pairs." 1400
1475B "New Year\'s Number" "brute force,dp,math" "Polycarp remembered the 2020-th year, and he is happy with the arrival of the new 2021-th year. To remember such a wonderful moment, Polycarp wants to represent the number n as the sum of a certain number of 2020 and a certain number of 2021.For example, if:   n=4041, then the number n can be represented as the sum 2020+2021;  n=4042, then the number n can be represented as the sum 2021+2021;  n=8081, then the number n can be represented as the sum 2020+2020+2020+2021;  n=8079, then the number n cannot be represented as the sum of the numbers 2020 and 2021. Help Polycarp to find out whether the number n can be represented as the sum of a certain number of numbers 2020 and a certain number of numbers 2021." 900
1475A "Odd Divisor" "math,number theory" "You are given an integer n. Check if n has an odd divisor, greater than one (does there exist such a number x (x>1) that n is divisible by x and x is odd).For example, if n=6, then there is x=3. If n=4, then such a number does not exist." 900
1474F "1 2 3 4 ..." dp,math,matrices "Igor had a sequence d1,d2,\xe2\x80\xa6,dn of integers. When Igor entered the classroom there was an integer x written on the blackboard.Igor generated sequence p using the following algorithm:   initially, p=[x];  for each 1\xe2\x89\xa4i\xe2\x89\xa4n he did the following operation |di| times:   if di\xe2\x89\xa50, then he looked at the last element of p (let it be y) and appended y+1 to the end of p;  if di<0, then he looked at the last element of p (let it be y) and appended y\xe2\x88\x921 to the end of p.  For example, if x=3, and d=[1,\xe2\x88\x921,2], p will be equal [3,4,3,4,5].Igor decided to calculate the length of the longest increasing subsequence of p and the number of them.A sequence a is a subsequence of a sequence b if a can be obtained from b by deletion of several (possibly, zero or all) elements.A sequence a is an increasing sequence if each element of a (except the first one) is strictly greater than the previous element.For p=[3,4,3,4,5], the length of longest increasing subsequence is 3 and there are 3 of them: [3_,4_,3,4,5_], [3_,4,3,4_,5_], [3,4,3_,4_,5_]." 3000
1474E "What Is It?" "constructive algorithms,greedy" "Lunar rover finally reached planet X. After landing, he met an obstacle, that contains permutation p of length n. Scientists found out, that to overcome an obstacle, the robot should make p an identity permutation (make pi=i for all i).Unfortunately, scientists can\'t control the robot. Thus the only way to make p an identity permutation is applying the following operation to p multiple times:   Select two indices i and j (i\xe2\x89\xa0j), such that pj=i and swap the values of pi and pj. It takes robot (j\xe2\x88\x92i)2 seconds to do this operation.  Positions i and j are selected by the robot (scientists can\'t control it). He will apply this operation while p isn\'t an identity permutation. We can show that the robot will make no more than n operations regardless of the choice of i and j on each operation.Scientists asked you to find out the maximum possible time it will take the robot to finish making p an identity permutation (i. e. worst-case scenario), so they can decide whether they should construct a new lunar rover or just rest and wait. They won\'t believe you without proof, so you should build an example of p and robot\'s operations that maximizes the answer.For a better understanding of the statement, read the sample description." 2500
1474D Cleaning "data structures,dp,greedy,math" "During cleaning the coast, Alice found n piles of stones. The i-th pile has ai stones.Piles i and i+1 are neighbouring for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. If pile i becomes empty, piles i\xe2\x88\x921 and i+1 doesn\'t become neighbouring.Alice is too lazy to remove these stones, so she asked you to take this duty. She allowed you to do only the following operation:   Select two neighboring piles and, if both of them are not empty, remove one stone from each of them. Alice understands that sometimes it\'s impossible to remove all stones with the given operation, so she allowed you to use the following superability:   Before the start of cleaning, you can select two neighboring piles and swap them. Determine, if it is possible to remove all stones using the superability not more than once." 2200
1474C "Array Destruction" "brute force,constructive algorithms,data structures,greedy,implementation,sortings" "You found a useless array a of 2n positive integers. You have realized that you actually don\'t need this array, so you decided to throw out all elements of a.It could have been an easy task, but it turned out that you should follow some rules:   In the beginning, you select any positive integer x. Then you do the following operation n times:   select two elements of array with sum equals x;  remove them from a and replace x with maximum of that two numbers.  For example, if initially a=[3,5,1,2], you can select x=6. Then you can select the second and the third elements of a with sum 5+1=6 and throw them out. After this operation, x equals 5 and there are two elements in array: 3 and 2. You can throw them out on the next operation.Note, that you choose x before the start and can\'t change it as you want between the operations.Determine how should you behave to throw out all elements of a." 1700
1474B "Different Divisors" "binary search,constructive algorithms,greedy,math,number theory" "Positive integer x is called divisor of positive integer y, if y is divisible by x without remainder. For example, 1 is a divisor of 7 and 3 is not divisor of 8.We gave you an integer d and asked you to find the smallest positive integer a, such that  a has at least 4 divisors;  difference between any two divisors of a is at least d." 1000
1474A "Puzzle From the Future" greedy "In the 2022 year, Mike found two binary integers a and b of length n (both of them are written only by digits 0 and 1) that can have leading zeroes. In order not to forget them, he wanted to construct integer d in the following way:   he creates an integer c as a result of bitwise summing of a and b without transferring carry, so c may have one or more 2-s. For example, the result of bitwise summing of 0110 and 1101 is 1211 or the sum of 011000 and 011000 is 022000;  after that Mike replaces equal consecutive digits in c by one digit, thus getting d. In the cases above after this operation, 1211 becomes 121 and 022000 becomes 020 (so, d won\'t have equal consecutive digits). Unfortunately, Mike lost integer a before he could calculate d himself. Now, to cheer him up, you want to find any binary integer a of length n such that d will be maximum possible as integer.Maximum possible as integer means that 102>21, 012<101, 021=21 and so on." 800
1473G Tiles combinatorics,dp,fft,math "Consider a road consisting of several rows. Each row is divided into several rectangular tiles, and all tiles in the same row are equal. The first row contains exactly one rectangular tile. Look at the picture below which shows how the tiles are arranged.The road is constructed as follows:   the first row consists of 1 tile;  then a1 rows follow; each of these rows contains 1 tile greater than the previous row;  then b1 rows follow; each of these rows contains 1 tile less than the previous row;  then a2 rows follow; each of these rows contains 1 tile greater than the previous row;  then b2 rows follow; each of these rows contains 1 tile less than the previous row;  ...  then an rows follow; each of these rows contains 1 tile greater than the previous row;  then bn rows follow; each of these rows contains 1 tile less than the previous row.   An example of the road with n=2, a1=4, b1=2, a2=2, b2=3. Rows are arranged from left to right. You start from the only tile in the first row and want to reach the last row (any tile of it). From your current tile, you can move to any tile in the next row which touches your current tile.Calculate the number of different paths from the first row to the last row. Since it can be large, print it modulo 998244353." 2800
1473F "Strange Set" flows,math "Note that the memory limit is unusual.You are given an integer n and two sequences a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn.Let\'s call a set of integers S such that S\xe2\x8a\x86{1,2,3,\xe2\x80\xa6,n} strange, if, for every element i of S, the following condition is met: for every j\xe2\x88\x88[1,i\xe2\x88\x921], if aj divides ai, then j is also included in S. An empty set is always strange.The cost of the set S is \xe2\x88\x91i\xe2\x88\x88Sbi. You have to calculate the maximum possible cost of a strange set." 2700
1473E "Minimum Path" "graphs,shortest paths" "You are given a weighted undirected connected graph consisting of n vertices and m edges. It is guaranteed that there are no self-loops or multiple edges in the given graph.Let\'s define the weight of the path consisting of k edges with indices e1,e2,\xe2\x80\xa6,ek as k\xe2\x88\x91i=1wei\xe2\x88\x92kmaxi=1wei+kmini=1wei, where wi \xe2\x80\x94 weight of the i-th edge in the graph.Your task is to find the minimum weight of the path from the 1-st vertex to the i-th vertex for each i (2\xe2\x89\xa4i\xe2\x89\xa4n)." 2400
1473D Program "data structures,dp,implementation,strings" "You are given a program that consists of n instructions. Initially a single variable x is assigned to 0. Afterwards, the instructions are of two types:   increase x by 1;  decrease x by 1. You are given m queries of the following format:   query l r \xe2\x80\x94 how many distinct values is x assigned to if all the instructions between the l-th one and the r-th one inclusive are ignored and the rest are executed without changing the order?" 1700
1473C "No More Inversions" "constructive algorithms,math" "You have a sequence a with n elements 1,2,3,\xe2\x80\xa6,k\xe2\x88\x921,k,k\xe2\x88\x921,k\xe2\x88\x922,\xe2\x80\xa6,k\xe2\x88\x92(n\xe2\x88\x92k) (k\xe2\x89\xa4n<2k).Let\'s call as inversion in a a pair of indices i<j such that a[i]>a[j].Suppose, you have some permutation p of size k and you build a sequence b of size n in the following manner: b[i]=p[a[i]].Your goal is to find such permutation p that the total number of inversions in b doesn\'t exceed the total number of inversions in a, and b is lexicographically maximum.Small reminder: the sequence of k integers is called a permutation if it contains all integers from 1 to k exactly once.Another small reminder: a sequence s is lexicographically smaller than another sequence t, if either s is a prefix of t, or for the first i such that si\xe2\x89\xa0ti, si<ti holds (in the first position that these sequences are different, s has smaller number than t)." 1500
1473B "String LCM" "brute force,math,number theory,strings" "Let\'s define a multiplication operation between a string a and a positive integer x: a\xe2\x8b\x85x is the string that is a result of writing x copies of a one after another. For example, ""abc"" \xe2\x8b\x85 2 = ""abcabc"", ""a"" \xe2\x8b\x85 5 = ""aaaaa"".A string a is divisible by another string b if there exists an integer x such that b\xe2\x8b\x85x=a. For example, ""abababab"" is divisible by ""ab"", but is not divisible by ""ababab"" or ""aa"".LCM of two strings s and t (defined as LCM(s,t)) is the shortest non-empty string that is divisible by both s and t.You are given two strings s and t. Find LCM(s,t) or report that it does not exist. It can be shown that if LCM(s,t) exists, it is unique." 1000
1473A "Replacing Elements" greedy,implementation,math,sortings "You have an array a1,a2,\xe2\x80\xa6,an. All ai are positive integers.In one step you can choose three distinct indices i, j, and k (i\xe2\x89\xa0j; i\xe2\x89\xa0k; j\xe2\x89\xa0k) and assign the sum of aj and ak to ai, i. e. make ai=aj+ak.Can you make all ai lower or equal to d using the operation above any number of times (possibly, zero)?" 800
1472G "Moving to the Capital" "dfs and similar,dp,graphs,shortest paths" "There are nn cities in Berland. The city numbered 11 is the capital. Some pairs of cities are connected by a one-way road of length 1.Before the trip, Polycarp for each city found out the value of didi \xe2\x80\x94 the shortest distance from the capital (the 11-st city) to the ii-th city.Polycarp begins his journey in the city with number ss and, being in the ii-th city, chooses one of the following actions:   Travel from the ii-th city to the jj-th city if there is a road from the ii-th city to the jj-th and di<djdi<dj;  Travel from the ii-th city to the jj-th city if there is a road from the ii-th city to the jj-th and di\xe2\x89\xa5djdi\xe2\x89\xa5dj;  Stop traveling. Since the government of Berland does not want all people to come to the capital, so Polycarp no more than once can take the second action from the list. in other words, he can perform the second action 00 or 11 time during his journey. Polycarp, on the other hand, wants to be as close to the capital as possible.  For example, if n=6n=6 and the cities are connected, as in the picture above, then Polycarp could have made the following travels (not all possible options):   2\xe2\x86\x925\xe2\x86\x921\xe2\x86\x922\xe2\x86\x9252\xe2\x86\x925\xe2\x86\x921\xe2\x86\x922\xe2\x86\x925;  3\xe2\x86\x926\xe2\x86\x9223\xe2\x86\x926\xe2\x86\x922;  1\xe2\x86\x923\xe2\x86\x926\xe2\x86\x922\xe2\x86\x9251\xe2\x86\x923\xe2\x86\x926\xe2\x86\x922\xe2\x86\x925. Polycarp wants for each starting city ii to find out how close he can get to the capital. More formally: he wants to find the minimal value of djdj that Polycarp can get from the city ii to the city jj according to the rules described above." 2100
1472F "New Year\'s Puzzle" "brute force,dp,graph matchings,greedy,sortings" "Every year Santa Claus gives gifts to all children. However, each country has its own traditions, and this process takes place in different ways. For example, in Berland you need to solve the New Year\'s puzzle.Polycarp got the following problem: given a grid strip of size 2\xc3\x97n, some cells of it are blocked. You need to check if it is possible to tile all free cells using the 2\xc3\x971 and 1\xc3\x972 tiles (dominoes).For example, if n=5 and the strip looks like this (black cells are blocked):  Then it can be tiled, for example, using two vertical and two horizontal tiles, as in the picture below (different tiles are marked by different colors).  And if n=3 and the strip looks like this:  It is impossible to tile free cells.Polycarp easily solved this task and received his New Year\'s gift. Can you solve it?" 2100
1472E "Correct Placement" "binary search,data structures,dp,sortings,two pointers" "Polycarp has invited n friends to celebrate the New Year. During the celebration, he decided to take a group photo of all his friends. Each friend can stand or lie on the side.Each friend is characterized by two values hi (their height) and wi (their width). On the photo the i-th friend will occupy a rectangle hi\xc3\x97wi (if they are standing) or wi\xc3\x97hi (if they are lying on the side).The j-th friend can be placed in front of the i-th friend on the photo if his rectangle is lower and narrower than the rectangle of the i-th friend. Formally, at least one of the following conditions must be fulfilled:  hj<hi and wj<wi (both friends are standing or both are lying);  wj<hi and hj<wi (one of the friends is standing and the other is lying). For example, if n=3, h=[3,5,3] and w=[4,4,3], then:  the first friend can be placed in front of the second: w1<h2 and h1<w2 (one of the them is standing and the other one is lying);  the third friend can be placed in front of the second: h3<h2 and w3<w2 (both friends are standing or both are lying). In other cases, the person in the foreground will overlap the person in the background.Help Polycarp for each i find any j, such that the j-th friend can be located in front of the i-th friend (i.e. at least one of the conditions above is fulfilled).Please note that you do not need to find the arrangement of all people for a group photo. You just need to find for each friend i any other friend j who can be located in front of him. Think about it as you need to solve n separate independent subproblems." 1700
1472D "Even-Odd Game" dp,games,greedy,sortings "During their New Year holidays, Alice and Bob play the following game using an array a of n integers:   Players take turns, Alice moves first.  Each turn a player chooses any element and removes it from the array.  If Alice chooses even value, then she adds it to her score. If the chosen value is odd, Alice\'s score does not change.  Similarly, if Bob chooses odd value, then he adds it to his score. If the chosen value is even, then Bob\'s score does not change. If there are no numbers left in the array, then the game ends. The player with the highest score wins. If the scores of the players are equal, then a draw is declared.For example, if n=4 and a=[5,2,7,3], then the game could go as follows (there are other options):   On the first move, Alice chooses 2 and get two points. Her score is now 2. The array a is now [5,7,3].  On the second move, Bob chooses 5 and get five points. His score is now 5. The array a is now [7,3].  On the third move, Alice chooses 7 and get no points. Her score is now 2. The array a is now [3].  On the last move, Bob chooses 3 and get three points. His score is now 8. The array a is empty now.  Since Bob has more points at the end of the game, he is the winner. You want to find out who will win if both players play optimally. Note that there may be duplicate numbers in the array." 1200
1472C "Long Jumps" dp,graphs "Polycarp found under the Christmas tree an array a of n elements and instructions for playing with it:   At first, choose index i (1\xe2\x89\xa4i\xe2\x89\xa4n) \xe2\x80\x94 starting position in the array. Put the chip at the index i (on the value ai).  While i\xe2\x89\xa4n, add ai to your score and move the chip ai positions to the right (i.e. replace i with i+ai).  If i>n, then Polycarp ends the game. For example, if n=5 and a=[7,3,1,2,3], then the following game options are possible:   Polycarp chooses i=1. Game process: i=1+7\xe2\x9f\xb68. The score of the game is: a1=7.  Polycarp chooses i=2. Game process: i=2+3\xe2\x9f\xb65+3\xe2\x9f\xb68. The score of the game is: a2+a5=6.  Polycarp chooses i=3. Game process: i=3+1\xe2\x9f\xb64+2\xe2\x9f\xb66. The score of the game is: a3+a4=3.  Polycarp chooses i=4. Game process: i=4+2\xe2\x9f\xb66. The score of the game is: a4=2.  Polycarp chooses i=5. Game process: i=5+3\xe2\x9f\xb68. The score of the game is: a5=3. Help Polycarp to find out the maximum score he can get if he chooses the starting index in an optimal way." 1100
1472B "Fair Division" dp,greedy,math "Alice and Bob received n candies from their parents. Each candy weighs either 1 gram or 2 grams. Now they want to divide all candies among themselves fairly so that the total weight of Alice\'s candies is equal to the total weight of Bob\'s candies.Check if they can do that.Note that candies are not allowed to be cut in half." 800
1472A "Cards for Friends" greedy,math "For the New Year, Polycarp decided to send postcards to all his n friends. He wants to make postcards with his own hands. For this purpose, he has a sheet of paper of size w\xc3\x97h, which can be cut into pieces.Polycarp can cut any sheet of paper w\xc3\x97h that he has in only two cases:   If w is even, then he can cut the sheet in half and get two sheets of size w2\xc3\x97h;  If h is even, then he can cut the sheet in half and get two sheets of size w\xc3\x97h2; If w and h are even at the same time, then Polycarp can cut the sheet according to any of the rules above.After cutting a sheet of paper, the total number of sheets of paper is increased by 1.Help Polycarp to find out if he can cut his sheet of size w\xc3\x97h at into n or more pieces, using only the rules described above." 800
1471B "Strange List" "brute force,greedy,implementation,math" "You have given an array a of length n and an integer x to a brand new robot. What the robot does is the following: it iterates over the elements of the array, let the current element be q. If q is divisible by x, the robot adds x copies of the integer qx to the end of the array, and moves on to the next element. Note that the newly added elements could be processed by the robot later. Otherwise, if q is not divisible by x, the robot shuts down.Please determine the sum of all values of the array at the end of the process." 1100
1471A "Strange Partition" "greedy,math,number theory" "You are given an array a of length n, and an integer x. You can perform the following operation as many times as you would like (possibly zero): replace two adjacent elements of the array by their sum. For example, if the initial array was [3,6,9], in a single operation one can replace the last two elements by their sum, yielding an array [3,15], or replace the first two elements to get an array [9,9]. Note that the size of the array decreases after each operation.The beauty of an array b=[b1,\xe2\x80\xa6,bk] is defined as \xe2\x88\x91ki=1\xe2\x8c\x88bix\xe2\x8c\x89, which means that we divide each element by x, round it up to the nearest integer, and sum up the resulting values. For example, if x=3, and the array is [4,11,6], the beauty of the array is equal to \xe2\x8c\x8843\xe2\x8c\x89+\xe2\x8c\x88113\xe2\x8c\x89+\xe2\x8c\x8863\xe2\x8c\x89=2+4+2=8.Please determine the minimum and the maximum beauty you can get by performing some operations on the original array." 900
1470F "Strange Covering" "divide and conquer" "You are given n points on a plane. Please find the minimum sum of areas of two axis-aligned rectangles, such that each point is contained in at least one of these rectangles.Note that the chosen rectangles can be degenerate. Rectangle contains all the points that lie inside it or on its boundary." 3500
1470E "Strange Permutation" "binary search,combinatorics,data structures,dp,graphs,implementation,two pointers" "Alice had a permutation p1,p2,\xe2\x80\xa6,pn. Unfortunately, the permutation looked very boring, so she decided to change it and choose some non-overlapping subranges of this permutation and reverse them. The cost of reversing a single subrange [l,r] (elements from position l to position r, inclusive) is equal to r\xe2\x88\x92l, and the cost of the operation is the sum of costs of reversing individual subranges. Alice had an integer c in mind, so she only considered operations that cost no more than c.Then she got really bored, and decided to write down all the permutations that she could possibly obtain by performing exactly one operation on the initial permutation. Of course, Alice is very smart, so she wrote down each obtainable permutation exactly once (no matter in how many ways it can be obtained), and of course the list was sorted lexicographically.Now Bob would like to ask Alice some questions about her list. Each question is in the following form: what is the i-th number in the j-th permutation that Alice wrote down? Since Alice is too bored to answer these questions, she asked you to help her out." 3200
1470D "Strange Housing" "constructive algorithms,dfs and similar,graph matchings,graphs,greedy" "Students of Winter Informatics School are going to live in a set of houses connected by underground passages. Teachers are also going to live in some of these houses, but they can not be accommodated randomly. For safety reasons, the following must hold:  All passages between two houses will be closed, if there are no teachers in both of them. All other passages will stay open.  It should be possible to travel between any two houses using the underground passages that are open.  Teachers should not live in houses, directly connected by a passage. Please help the organizers to choose the houses where teachers will live to satisfy the safety requirements or determine that it is impossible." 2200
1470C "Strange Shuffle" "binary search,brute force,constructive algorithms,interactive" "This is an interactive problem.n people sitting in a circle are trying to shuffle a deck of cards. The players are numbered from 1 to n, so that players i and i+1 are neighbours (as well as players 1 and n). Each of them has exactly k cards, where k is even. The left neighbour of a player i is player i\xe2\x88\x921, and their right neighbour is player i+1 (except for players 1 and n, who are respective neighbours of each other).Each turn the following happens: if a player has x cards, they give \xe2\x8c\x8ax/2\xe2\x8c\x8b to their neighbour on the left and \xe2\x8c\x88x/2\xe2\x8c\x89 cards to their neighbour on the right. This happens for all players simultaneously.However, one player p is the impostor and they just give all their cards to their neighbour on the right. You know the number of players n and the number of cards k each player has initially, but p is unknown to you. Your task is to determine the value of p, by asking questions like ""how many cards does player q have?"" for an index q of your choice. After each question all players will make exactly one move and give their cards to their neighbours. You need to find the impostor by asking no more than 1000 questions." 2500
1470B "Strange Definition" "bitmasks,graphs,hashing,math,number theory" "Let us call two integers x and y adjacent if lcm(x,y)gcd(x,y) is a perfect square. For example, 3 and 12 are adjacent, but 6 and 9 are not.Here gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y, and lcm(x,y) denotes the least common multiple (LCM) of integers x and y.You are given an array a of length n. Each second the following happens: each element ai of the array is replaced by the product of all elements of the array (including itself), that are adjacent to the current value. Let di be the number of adjacent elements to ai (including ai itself). The beauty of the array is defined as max1\xe2\x89\xa4i\xe2\x89\xa4ndi. You are given q queries: each query is described by an integer w, and you have to output the beauty of the array after w seconds." 1900
1470A "Strange Birthday Party" "binary search,dp,greedy,sortings,two pointers" "Petya organized a strange birthday party. He invited n friends and assigned an integer ki to the i-th of them. Now Petya would like to give a present to each of them. In the nearby shop there are m unique presents available, the j-th present costs cj dollars (1\xe2\x89\xa4c1\xe2\x89\xa4c2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4cm). It\'s not allowed to buy a single present more than once.For the i-th friend Petya can either buy them a present j\xe2\x89\xa4ki, which costs cj dollars, or just give them cki dollars directly.Help Petya determine the minimum total cost of hosting his party." 1300
1469F "Power Sockets" "binary search,data structures,greedy" "// We decided to drop the legend about the power sockets but feel free to come up with your own :^)Define a chain:   a chain of length 1 is a single vertex;  a chain of length x is a chain of length x\xe2\x88\x921 with a new vertex connected to the end of it with a single edge. You are given n chains of lengths l1,l2,\xe2\x80\xa6,ln. You plan to build a tree using some of them.  Each vertex of the tree is either white or black.  The tree initially only has a white root vertex.  All chains initially consist only of white vertices.  You can take one of the chains and connect any of its vertices to any white vertex of the tree with an edge. The chain becomes part of the tree. Both endpoints of this edge become black.  Each chain can be used no more than once.  Some chains can be left unused. The distance between two vertices of the tree is the number of edges on the shortest path between them.If there is at least k white vertices in the resulting tree, then the value of the tree is the distance between the root and the k-th closest white vertex.What\'s the minimum value of the tree you can obtain? If there is no way to build a tree with at least k white vertices, then print -1." 2600
1469E "A Bit Similar" "bitmasks,brute force,hashing,string suffix structures,strings,two pointers" "Let\'s call two strings a and b (both of length k) a bit similar if they have the same character in some position, i. e. there exists at least one i\xe2\x88\x88[1,k] such that ai=bi.You are given a binary string s of length n (a string of n characters 0 and/or 1) and an integer k. Let\'s denote the string s[i..j] as the substring of s starting from the i-th character and ending with the j-th character (that is, s[i..j]=sisi+1si+2\xe2\x80\xa6sj\xe2\x88\x921sj).Let\'s call a binary string t of length k beautiful if it is a bit similar to all substrings of s having length exactly k; that is, it is a bit similar to s[1..k],s[2..k+1],\xe2\x80\xa6,s[n\xe2\x88\x92k+1..n].Your goal is to find the lexicographically smallest string t that is beautiful, or report that no such string exists. String x is lexicographically less than string y if either x is a prefix of y (and x\xe2\x89\xa0y), or there exists such i (1\xe2\x89\xa4i\xe2\x89\xa4min(|x|,|y|)), that xi<yi, and for any j (1\xe2\x89\xa4j<i) xj=yj." 2400
1469D "Ceil Divisions" "brute force,constructive algorithms,math,number theory" "You have an array a1,a2,\xe2\x80\xa6,an where ai=i.In one step, you can choose two indices x and y (x\xe2\x89\xa0y) and set ax=\xe2\x8c\x88axay\xe2\x8c\x89 (ceiling function).Your goal is to make array a consist of n\xe2\x88\x921 ones and 1 two in no more than n+5 steps. Note that you don\'t have to minimize the number of steps." 1700
1469C "Building a Fence" "dp,greedy,implementation,two pointers" "You want to build a fence that will consist of n equal sections. All sections have a width equal to 1 and height equal to k. You will place all sections in one line side by side.Unfortunately, the ground beneath the fence is not flat. For simplicity, you can think that the ground level under the i-th section is equal to hi. You should follow several rules to build the fence:   the consecutive sections should have a common side of length at least 1;  the first and the last sections should stand on the corresponding ground levels;  the sections between may be either on the ground level or higher, but not higher than k\xe2\x88\x921 from the ground level hi (the height should be an integer);   One of possible fences (blue color) for the first test case Is it possible to build a fence that meets all rules?" 1600
1469B "Red and Blue" dp,greedy "Monocarp had a sequence a consisting of n+m integers a1,a2,\xe2\x80\xa6,an+m. He painted the elements into two colors, red and blue; n elements were painted red, all other m elements were painted blue.After painting the elements, he has written two sequences r1,r2,\xe2\x80\xa6,rn and b1,b2,\xe2\x80\xa6,bm. The sequence r consisted of all red elements of a in the order they appeared in a; similarly, the sequence b consisted of all blue elements of a in the order they appeared in a as well.Unfortunately, the original sequence was lost, and Monocarp only has the sequences r and b. He wants to restore the original sequence. In case there are multiple ways to restore it, he wants to choose a way to restore that maximizes the value of f(a)=max(0,a1,(a1+a2),(a1+a2+a3),\xe2\x80\xa6,(a1+a2+a3+\xe2\x8b\xaf+an+m))Help Monocarp to calculate the maximum possible value of f(a)." 1000
1469A "Regular Bracket Sequence" "constructive algorithms,greedy" "A bracket sequence is called regular if it is possible to obtain correct arithmetic expression by inserting characters + and 1 into this sequence. For example, sequences (())(), () and (()(())) are regular, while )(, (() and (()))( are not. Let\'s call a regular bracket sequence ""RBS"".You are given a sequence s of n characters (, ), and/or ?. There is exactly one character ( and exactly one character ) in this sequence.You have to replace every character ? with either ) or ( (different characters ? can be replaced with different brackets). You cannot reorder the characters, remove them, insert other characters, and each ? must be replaced.Determine if it is possible to obtain an RBS after these replacements." 1000
1468N "Waste Sorting" greedy,implementation "The progress is not standing still in Berland. Recently all garbage containers in Bertown, the capital of Berland, were replaced by differentiated recycling bins, each accepting some category of waste. While this will definitely improve the ecological situation, for some citizens it\'s difficult to get used to the habit of sorting waste.Monocarp is one of those citizens who tries to get used to waste sorting. Today he has to take out the trash from his house. There are three containers near the Monocarp\'s house, the first one accepts paper waste, the second one accepts plastic waste, and the third one \xe2\x80\x94 all other types of waste. It is possible to fit c1 items into the first container, c2 items into the second container and c3 items into the third container.Monocarp has a lot of items to throw into containers. Some are made of paper, so Monocarp has to put them into the first container (he has a1 such items), some are made of plastic, so he has to put them into the second container (he has a2 such items), and some are neither paper nor plastic \xe2\x80\x94 so Monocarp has to put them into the third container (he has a3 such items).Unfortunately, there are also two categories of items that Monocarp is unsure of: he has a4 items which are partially made of paper, so he will put each of these items either into the first container or into the third container. Similarly, he has a5 items partially made of plastic, so he has to put each of them either into the second container or into the third container. Obviously, this choice is made separately for each item \xe2\x80\x94 for example, Monocarp can throw several partially-plastic items into the second container, and all other partially-plastic items \xe2\x80\x94 into the third one.Now Monocarp wonders: is it possible to put each item into some container so that the first container will hold no more than c1 items, the second one \xe2\x80\x94 no more than c2 items, and the third one \xe2\x80\x94 no more than c3 items?" 900
1468M "Similar Sets" "data structures,graphs,implementation" "You are given n sets of integers. The i-th set contains ki integers.Two sets are called similar if they share at least two common elements, i.\xe2\x80\x89e. there exist two integers x and y such that x\xe2\x89\xa0y, and they both belong to each of the two sets.Your task is to find two similar sets among the given ones, or report that there is no such pair of sets." 2300
1468L "Prime Divisors Selection" "binary search,greedy,math,number theory" "Suppose you have a sequence of k integers A=[a1,a2,\xe2\x80\xa6,ak] where each ai\xe2\x89\xa52. A sequence of prime integers P=[p1,p2,\xe2\x80\xa6,pk] is called suitable for the sequence A if a1 is divisible by p1, a2 is divisible by p2 and so on. A sequence of prime integers P is called friendly if there are no unique integers in this sequence. A sequence A is called ideal, if each sequence P that is suitable for A is friendly as well (i.\xe2\x80\x89e. there is no sequence P that is suitable for A, but not friendly). For example, the sequence [2,4,16] is ideal, while the sequence [2,4,6] is not ideal (there exists a sequence P=[2,2,3] which is suitable for A, but not friendly).You are given n different integers x1, x2, ..., xn. You have to choose exactly k of them in such a way that they form an ideal sequence, or report that it is impossible. Note that no integer can be chosen more than once." 2700
1468K "The Robot" "brute force,implementation" "There is a robot on a checkered field that is endless in all directions. Initially, the robot is located in the cell with coordinates (0,0). He will execute commands which are described by a string of capital Latin letters \'L\', \'R\', \'D\', \'U\'. When a command is executed, the robot simply moves in the corresponding direction:  \'L\': one cell to the left (the x-coordinate of the current cell decreases by 1);  \'R\': one cell to the right (the x-coordinate of the current cell is increased by 1);  \'D\': one cell down (the y-coordinate of the current cell decreases by 1);  \'U\': one cell up (the y-coordinate of the current cell is increased by 1). Your task is to put an obstacle in one cell of the field so that after executing the commands, the robot will return to the original cell of its path (0,0). Of course, an obstacle cannot be placed in the starting cell (0,0). It is guaranteed that if the obstacle is not placed, then the robot will not return to the starting cell.An obstacle affects the movement of the robot in the following way: if it tries to go in a certain direction, and there is an obstacle, then it simply remains in place (the obstacle also remains, that is, it does not disappear).Find any such cell of the field (other than (0,0)) that if you put an obstacle there, the robot will return to the cell (0,0) after the execution of all commands. If there is no solution, then report it." 1600
1468J "Road Reform" dsu,graphs,greedy "There are nn cities and mm bidirectional roads in Berland. The ii-th road connects the cities xixi and yiyi, and has the speed limit sisi. The road network allows everyone to get from any city to any other city. The Berland Transport Ministry is planning a road reform.First of all, maintaining all mm roads is too costly, so m\xe2\x88\x92(n\xe2\x88\x921)m\xe2\x88\x92(n\xe2\x88\x921) roads will be demolished in such a way that the remaining (n\xe2\x88\x921)(n\xe2\x88\x921) roads still allow to get to any city from any other city. Formally, the remaining roads should represent an undirected tree.Secondly, the speed limits on the remaining roads might be changed. The changes will be done sequentially, each change is either increasing the speed limit on some road by 11, or decreasing it by 11. Since changing the speed limit requires a lot of work, the Ministry wants to minimize the number of changes.The goal of the Ministry is to have a road network of (n\xe2\x88\x921)(n\xe2\x88\x921) roads with the maximum speed limit over all roads equal to exactly kk. They assigned you the task of calculating the minimum number of speed limit changes they have to perform so the road network meets their requirements.For example, suppose the initial map of Berland looks like that, and k=7k=7:  Then one of the optimal courses of action is to demolish the roads 11\xe2\x80\x9344 and 33\xe2\x80\x9344, and then decrease the speed limit on the road 22\xe2\x80\x9333 by 11, so the resulting road network looks like that:" 1800
1468I "Plane Tiling" geometry,implementation,math "You are given five integers n, dx1, dy1, dx2 and dy2. You have to select n distinct pairs of integers (xi,yi) in such a way that, for every possible pair of integers (x,y), there exists exactly one triple of integers (a,b,i) meeting the following constraints: {x=xi+a\xe2\x8b\x85dx1+b\xe2\x8b\x85dx2,y=yi+a\xe2\x8b\x85dy1+b\xe2\x8b\x85dy2." 2500
1468H "K and Medians" "constructive algorithms,greedy,math" "Let\'s denote the median of a sequence s with odd length as the value in the middle of s if we sort s in non-decreasing order. For example, let s=[1,2,5,7,2,3,12]. After sorting, we get sequence [1,2,2,3_,5,7,12], and the median is equal to 3.You have a sequence of n integers [1,2,\xe2\x80\xa6,n] and an odd integer k.In one step, you choose any k elements from the sequence and erase all chosen elements except their median. These elements do not have to go continuously (gaps are allowed between them).For example, if you have a sequence [1,2,3,4,5,6,7] (i.e. n=7) and k=3, then the following options for the first step are possible:  choose [1,2_,3]; 2 is their median, so it is not erased, and the resulting sequence is [2,4,5,6,7];  choose [2,4_,6]; 4 is their median, so it is not erased, and the resulting sequence is [1,3,4,5,7];  choose [1,6_,7]; 6 is their median, so it is not erased, and the resulting sequence is [2,3,4,5,6];  and several others. You can do zero or more steps. Can you get a sequence b1, b2, ..., bm after several steps?You\'ll be given t test cases. Solve each test case independently." 2200
1468G Hobbits "binary search,geometry" "The hobbits Frodo and Sam are carrying the One Ring to Mordor. In order not to be spotted by orcs, they decided to go through the mountains.The mountain relief can be represented as a polyline with n points (xi,yi), numbered from 1 to n (xi<xi+1 for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921). Hobbits start their journey at the point (x1,y1) and should reach the point (xn,yn) to complete their mission.The problem is that there is a tower with the Eye of Sauron, which watches them. The tower is located at the point (xn,yn) and has the height H, so the Eye is located at the point (xn,yn+H). In order to complete the mission successfully, the hobbits have to wear cloaks all the time when the Sauron Eye can see them, i.\xe2\x80\x89e. when there is a direct line from the Eye to the hobbits which is not intersected by the relief.The hobbits are low, so their height can be considered negligibly small, but still positive, so when a direct line from the Sauron Eye to the hobbits only touches the relief, the Eye can see them.  The Sauron Eye can\'t see hobbits when they are in the left position, but can see them when they are in the right position. The hobbits do not like to wear cloaks, so they wear them only when they can be spotted by the Eye. Your task is to calculate the total distance the hobbits have to walk while wearing cloaks." 2500
1468F "Full Turn" "geometry,hashing,number theory" "There are n persons located on a plane. The i-th person is located at the point (xi,yi) and initially looks at the point (ui,vi).At the same moment of time, all persons will start to rotate clockwise synchronously with the same angular speed. They will rotate until they do one full 360-degree turn. It is said that persons A and B made eye contact if person A looks in person B\'s direction at the same moment when person B looks in person A\'s direction. If there is a person C located between persons A and B, that will not obstruct A and B from making eye contact. A person can make eye contact with more than one person at the same time.Calculate the number of pairs of persons that will make eye contact at least once during the rotation (including the initial moment)." 1700
1468E "Four Segments" greedy "Monocarp wants to draw four line segments on a sheet of paper. He wants the i-th segment to have its length equal to ai (1\xe2\x89\xa4i\xe2\x89\xa44). These segments can intersect with each other, and each segment should be either horizontal or vertical.Monocarp wants to draw the segments in such a way that they enclose a rectangular space, and the area of that rectangular space should be maximum possible.For example, if Monocarp wants to draw four segments with lengths 1, 2, 3 and 4, he can do it the following way:  Here, Monocarp has drawn segments AB (with length 1), CD (with length 2), BC (with length 3) and EF (with length 4). He got a rectangle ABCF with area equal to 3 that is enclosed by the segments. Calculate the maximum area of a rectangle Monocarp can enclose with four segments." 800
1468D Firecrackers "binary search,sortings" "Consider a long corridor which can be divided into n square cells of size 1\xc3\x971. These cells are numbered from 1 to n from left to right.There are two people in this corridor, a hooligan and a security guard. Initially, the hooligan is in the a-th cell, the guard is in the b-th cell (a\xe2\x89\xa0b).   One of the possible situations. The corridor consists of 7 cells, the hooligan is in the 3-rd cell, the guard is in the 6-th (n=7, a=3, b=6). There are m firecrackers in the hooligan\'s pocket, the i-th firecracker explodes in si seconds after being lit.The following events happen each second (sequentially, exactly in the following order):  firstly, the hooligan either moves into an adjacent cell (from the cell i, he can move to the cell (i+1) or to the cell (i\xe2\x88\x921), and he cannot leave the corridor) or stays in the cell he is currently. If the hooligan doesn\'t move, he can light one of his firecrackers and drop it. The hooligan can\'t move into the cell where the guard is;  secondly, some firecrackers that were already dropped may explode. Formally, if the firecracker j is dropped on the T-th second, then it will explode on the (T+sj)-th second (for example, if a firecracker with sj=2 is dropped on the 4-th second, it explodes on the 6-th second);  finally, the guard moves one cell closer to the hooligan. If the guard moves to the cell where the hooligan is, the hooligan is caught. Obviously, the hooligan will be caught sooner or later, since the corridor is finite. His goal is to see the maximum number of firecrackers explode before he is caught; that is, he will act in order to maximize the number of firecrackers that explodes before he is caught.Your task is to calculate the number of such firecrackers, if the hooligan acts optimally." 1700
1468C Berpizza "data structures,implementation" "Monocarp and Polycarp are working as waiters in Berpizza, a pizzeria located near the center of Bertown. Since they are waiters, their job is to serve the customers, but they choose whom they serve first differently.At the start of the working day, there are no customers at the Berpizza. They come there one by one. When a customer comes into the pizzeria, she sits and waits for Monocarp or Polycarp to serve her. Monocarp has been working in Berpizza for just two weeks, so whenever he serves a customer, he simply chooses the one who came to Berpizza first, and serves that customer. On the other hand, Polycarp is an experienced waiter at Berpizza, and he knows which customers are going to spend a lot of money at the pizzeria (and which aren\'t) as soon as he sees them. For each customer, Polycarp estimates the amount of money this customer can spend, and when he serves a customer, he chooses the one that is expected to leave the most money at Berpizza (in case there are several such customers, he chooses the one who came first among them). Obviously, no customer can be served twice, so Monocarp and Polycarp choose which customer to serve only among those who haven\'t been served yet.When the number of customers gets really high, it becomes difficult for both Monocarp and Polycarp to choose the customer they are going to serve. Your task is to write a program that makes these choices for them. Formally, your program should be able to process three types of queries:  1 m \xe2\x80\x94 a customer comes to Berpizza, and Polycarp estimates the amount of money that they will spend as m;  2 \xe2\x80\x94 Monocarp serves a customer which came to the pizzeria first;  3 \xe2\x80\x94 Polycarp serves a customer which is expected to spend the largest amount of money at the pizzeria (if there are several such customers, the one that came to the pizzeria first is chosen). For each query of types 2 and 3, report the number of the customer who was served (the customers are numbered in the order they come to the pizzeria, starting from 1)." 1400
1468B Bakery "data structures,dsu" "Monocarp would like to open a bakery in his local area. But, at first, he should figure out whether he can compete with other shops.Monocarp plans that the bakery will work for n days. On the i-th day, ai loaves of bread will be baked in the morning before the opening. At the end of the n-th day, Monocarp will sell all the remaining bread that wasn\'t sold earlier with a huge discount.Because of how bread is stored, the bakery seller sells the bread in the following order: firstly, he sells the loaves that were baked that morning; secondly, he sells the loaves that were baked the day before and weren\'t sold yet; then the loaves that were baked two days before and weren\'t sold yet, and so on. That\'s why some customers may buy a rather stale bread and will definitely spread negative rumors.Let\'s define loaf spoilage as the difference between the day it was baked and the day it was sold. Then the unattractiveness of the bakery will be equal to the maximum spoilage among all loaves of bread baked at the bakery.Suppose Monocarp\'s local area has consumer demand equal to k, it means that each day k customers will come to the bakery and each of them will ask for one loaf of bread (the loaves are sold according to the aforementioned order). If there is no bread left, then the person just doesn\'t buy anything. During the last day sale, all the remaining loaves will be sold (and they will still count in the calculation of the unattractiveness).Monocarp analyzed his competitors\' data and came up with m possible consumer demand values k1,k2,\xe2\x80\xa6,km, and now he\'d like to calculate the unattractiveness of the bakery for each value of demand. Can you help him?" 2900
1468A LaIS "data structures,dp,greedy" "Let\'s call a sequence b1,b2,b3\xe2\x80\xa6,bk\xe2\x88\x921,bk almost increasing if min(b1,b2)\xe2\x89\xa4min(b2,b3)\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4min(bk\xe2\x88\x921,bk). In particular, any sequence with no more than two elements is almost increasing.You are given a sequence of integers a1,a2,\xe2\x80\xa6,an. Calculate the length of its longest almost increasing subsequence.You\'ll be given t test cases. Solve each test case independently.Reminder: a subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements." 2200
1467E "Distinctive Roots in a Tree" "data structures,dfs and similar,dp,trees" "You are given a tree with n vertices. Each vertex i has a value ai associated with it.Let us root the tree at some vertex v. The vertex v is called a distinctive root if the following holds: in all paths that start at v and end at some other node, all the values encountered are distinct. Two different paths may have values in common but a single path must have all distinct values.Find the number of distinctive roots in the tree." 2500
1467D "Sum of Paths" combinatorics,dp,math "There are n cells, numbered 1,2,\xe2\x80\xa6,n from left to right. You have to place a robot at any cell initially. The robot must make exactly k moves.In one move, the robot must move one cell to the left or right, provided that it doesn\'t move out of bounds. In other words, if the robot was in the cell i, it must move to either the cell i\xe2\x88\x921 or the cell i+1, as long as it lies between 1 and n (endpoints inclusive). The cells, in the order they are visited (including the cell the robot is placed), together make a good path.Each cell i has a value ai associated with it. Let c0,c1,\xe2\x80\xa6,ck be the sequence of cells in a good path in the order they are visited (c0 is the cell robot is initially placed, c1 is the cell where the robot is after its first move, and so on; more formally, ci is the cell that the robot is at after i moves). Then the value of the path is calculated as ac0+ac1+\xe2\x8b\xaf+ack.Your task is to calculate the sum of values over all possible good paths. Since this number can be very large, output it modulo 109+7. Two good paths are considered different if the starting cell differs or there exists an integer i\xe2\x88\x88[1,k] such that the current cell of the robot after exactly i moves is different in those paths.You must process q updates to a and print the updated sum each time. Each update changes the value of exactly one cell. See the input format and the sample input-output for more details." 2200
1467C "Three Bags" "constructive algorithms,greedy" "You are given three bags. Each bag contains a non-empty multiset of numbers. You can perform a number of operations on these bags. In one operation, you can choose any two non-empty bags, and choose one number from each of the bags. Let\'s say that you choose number a from the first bag and number b from the second bag. Then, you remove b from the second bag and replace a with a\xe2\x88\x92b in the first bag. Note that if there are multiple occurrences of these numbers, then you shall only remove/replace exactly one occurrence.You have to perform these operations in such a way that you have exactly one number remaining in exactly one of the bags (the other two bags being empty). It can be shown that you can always apply these operations to receive such a configuration in the end. Among all these configurations, find the one which has the maximum number left in the end." 1900
1467B "Hills And Valleys" "brute force,implementation" "You are given a sequence of n integers a1, a2, ..., an. Let us call an index j (2\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x921) a hill if aj>aj+1 and aj>aj\xe2\x88\x921; and let us call it a valley if aj<aj+1 and aj<aj\xe2\x88\x921.Let us define the intimidation value of a sequence as the sum of the number of hills and the number of valleys in the sequence. You can change exactly one integer in the sequence to any number that you want, or let the sequence remain unchanged. What is the minimum intimidation value that you can achieve?" 1700
1467A "Wizard of Orz" "constructive algorithms,greedy,math" "There are n digital panels placed in a straight line. Each panel can show any digit from 0 to 9. Initially, all panels show 0.Every second, the digit shown by each panel increases by 1. In other words, at the end of every second, a panel that showed 9 would now show 0, a panel that showed 0 would now show 1, a panel that showed 1 would now show 2, and so on.When a panel is paused, the digit displayed on the panel does not change in the subsequent seconds.You must pause exactly one of these panels, at any second you wish. Then, the panels adjacent to it get paused one second later, the panels adjacent to those get paused 2 seconds later, and so on. In other words, if you pause panel x, panel y (for all valid y) would be paused exactly |x\xe2\x88\x92y| seconds later.For example, suppose there are 4 panels, and the 3-rd panel is paused when the digit 9 is on it.  The panel 1 pauses 2 seconds later, so it has the digit 1;  the panel 2 pauses 1 second later, so it has the digit 0;  the panel 4 pauses 1 second later, so it has the digit 0. The resulting 4-digit number is 1090. Note that this example is not optimal for n=4.Once all panels have been paused, you write the digits displayed on them from left to right, to form an n digit number (it can consist of leading zeros). What is the largest possible number you can get? Initially, all panels show 0." 900
1466I "The Riddle of the Sphinx" "binary search,data structures,data structures,interactive" "What walks on four feet in the morning, two in the afternoon, and three at night?This is an interactive problem. This problem doesn\'t support hacks.Sphinx\'s duty is to guard the city of Thebes by making sure that no unworthy traveler crosses its gates. Only the ones who answer her riddle timely and correctly (or get an acc for short) are allowed to pass. As of those who fail, no one heard of them ever again...So you don\'t have a choice but to solve the riddle. Sphinx has an array a1,a2,\xe2\x80\xa6,an of nonnegative integers strictly smaller than 2b and asked you to find the maximum value among its elements. Of course, she will not show you the array, but she will give you n and b. As it is impossible to answer this riddle blindly, you can ask her some questions. For given i,y, she\'ll answer you whether ai is bigger than y. As sphinxes are not very patient, you can ask at most 3\xe2\x8b\x85(n+b) such questions.Although cunning, sphinxes are honest. Even though the array can change between your queries, answers to the previously asked questions will remain valid." 3400
1466H "Finding satisfactory solutions" combinatorics,dp,graphs,greedy,math "Getting so far in this contest is not an easy feat. By solving all the previous problems, you have impressed the gods greatly. Thus, they decided to spare you the story for this problem and grant a formal statement instead.Consider n agents. Each one of them initially has exactly one item, i-th agent has the item number i. We are interested in reassignments of these items among the agents. An assignment is valid iff each item is assigned to exactly one agent, and each agent is assigned exactly one item.Each agent has a preference over the items, which can be described by a permutation p of items sorted from the most to the least desirable. In other words, the agent prefers item i to item j iff i appears earlier in the permutation p. A preference profile is a list of n permutations of length n each, such that i-th permutation describes preferences of the i-th agent.It is possible that some of the agents are not happy with the assignment of items. A set of dissatisfied agents may choose not to cooperate with other agents. In such a case, they would exchange the items they possess initially (i-th item belongs to i-th agent) only between themselves. Agents from this group don\'t care about the satisfaction of agents outside of it. However, they need to exchange their items in such a way that will make at least one of them happier, and none of them less happy (in comparison to the given assignment).Formally, consider a valid assignment of items \xe2\x80\x94 A. Let A(i) denote the item assigned to i-th agent. Also, consider a subset of agents. Let S be the set of their indices. We will say this subset of agents is dissatisfied iff there exists a valid assignment B(i) such that:   For each i\xe2\x88\x88S, B(i)\xe2\x88\x88S.  No agent i\xe2\x88\x88S prefers A(i) to B(i) (no agent from the S is less happy).  At least one agent i\xe2\x88\x88S prefers B(i) to A(i) (at least one agent from the S is happier). An assignment is optimal if no subset of the agents is dissatisfied. Note that the empty subset cannot be dissatisfied. It can be proven that for each preference profile, there is precisely one optimal assignment.Example: Consider 3 agents with the following preference profile:   [2,1,3]  [1,2,3]  [1,3,2] And such an assignment:   First agent gets item 2  Second agent gets item 3.  Third agent gets item 1. See that the set of agents {1,2} is dissatisfied, because they can reassign their (initial) items in the following way:   First agent gets item 2.  Second agent gets item 1.  Third agent gets item 3. This reassignment will make the second agent happier and make no difference to the first agent. As a result, the third agent got an item that is worse for him, but this does not prevent the set {1,2} from being dissatisfied (he is not in this set).The following assignment would be optimal:   First agent gets item 2.  Second agent gets item 1.  Third agent gets item 3. Given an assignment A, calculate the number of distinct preference profiles for which assignment A is optimal. As the answer can be huge, output it modulo 109+7.Two preference profiles are different iff they assign different preference permutations to any agent." 3300
1466G "Song of the Sirens" "combinatorics,divide and conquer,hashing,math,string suffix structures,strings" "Whoso in ignorance draws near to them and hears the Sirens\' voice, he nevermore returns.Homer, OdysseyIn the times of Jason and the Argonauts, it was well known that sirens use the sound of their songs to lure sailors into their demise. Yet only a few knew that every time sirens call a sailor by his name, his will weakens, making him more vulnerable. For the purpose of this problem, both siren songs and names of the sailors will be represented as strings of lowercase English letters. The more times the sailor\'s name occurs as a contiguous substring of the song, the greater danger he is in.Jason found out that sirens can sing one of the n+1 songs, which have the following structure: let si (0\xe2\x89\xa4i\xe2\x89\xa4n) be the i-th song and t be a string of length n, then for every i<n: si+1=sitisi. In other words i+1-st song is the concatenation of i-th song, i-th letter (0-indexed) of t and the i-th song. Fortunately, he also knows s0 and t. Jason wonders how many times a sailor\'s name is mentioned in a particular song. Answer q queries: given the sailor\'s name (w) and the index of a song (i) output the number of occurrences of w in si as a substring. As this number can be quite large, output its remainder modulo 109+7." 2600
1466F "Euclid\'s nightmare" "bitmasks,dfs and similar,dsu,graphs,greedy,math,sortings" "You may know that Euclid was a mathematician. Well, as it turns out, Morpheus knew it too. So when he wanted to play a mean trick on Euclid, he sent him an appropriate nightmare. In his bad dream Euclid has a set S of n m-dimensional vectors over the Z2 field and can perform vector addition on them. In other words he has vectors with m coordinates, each one equal either 0 or 1. Vector addition is defined as follows: let u+v=w, then wi=(ui+vi)mod2. Euclid can sum any subset of S and archive another m-dimensional vector over Z2. In particular, he can sum together an empty subset; in such a case, the resulting vector has all coordinates equal 0.Let T be the set of all the vectors that can be written as a sum of some vectors from S. Now Euclid wonders the size of T and whether he can use only a subset S\xe2\x80\xb2 of S to obtain all the vectors from T. As it is usually the case in such scenarios, he will not wake up until he figures this out. So far, things are looking rather grim for the philosopher. But there is hope, as he noticed that all vectors in S have at most 2 coordinates equal 1. Help Euclid and calculate |T|, the number of m-dimensional vectors over Z2 that can be written as a sum of some vectors from S. As it can be quite large, calculate it modulo 109+7. You should also find S\xe2\x80\xb2, the smallest such subset of S, that all vectors in T can be written as a sum of vectors from S\xe2\x80\xb2. In case there are multiple such sets with a minimal number of elements, output the lexicographically smallest one with respect to the order in which their elements are given in the input. Consider sets A and B such that |A|=|B|. Let a1,a2,\xe2\x80\xa6a|A| and b1,b2,\xe2\x80\xa6b|B| be increasing arrays of indices elements of A and B correspondingly. A is lexicographically smaller than B iff there exists such i that aj=bj for all j<i and ai<bi." 2100
1466E "Apollo versus Pan" "bitmasks,brute force,math" "Only a few know that Pan and Apollo weren\'t only battling for the title of the GOAT musician. A few millenniums later, they also challenged each other in math (or rather in fast calculations). The task they got to solve is the following:Let x1,x2,\xe2\x80\xa6,xn be the sequence of n non-negative integers. Find this value: n\xe2\x88\x91i=1n\xe2\x88\x91j=1n\xe2\x88\x91k=1(xi&xj)\xe2\x8b\x85(xj|xk)Here & denotes the bitwise and, and | denotes the bitwise or.Pan and Apollo could solve this in a few seconds. Can you do it too? For convenience, find the answer modulo 109+7." 1800
1466D "13th Labour of Heracles" "data structures,greedy,sortings,trees" "You\'ve probably heard about the twelve labors of Heracles, but do you have any idea about the thirteenth? It is commonly assumed it took him a dozen years to complete the twelve feats, so on average, a year to accomplish every one of them. As time flows faster these days, you have minutes rather than months to solve this task. But will you manage?In this problem, you are given a tree with n weighted vertices. A tree is a connected graph with n\xe2\x88\x921 edges.Let us define its k-coloring as an assignment of k colors to the edges so that each edge has exactly one color assigned to it. Note that you don\'t have to use all k colors.A subgraph of color x consists of these edges from the original tree, which are assigned color x, and only those vertices that are adjacent to at least one such edge. So there are no vertices of degree 0 in such a subgraph.The value of a connected component is the sum of weights of its vertices. Let us define the value of a subgraph as a maximum of values of its connected components. We will assume that the value of an empty subgraph equals 0.There is also a value of a k-coloring, which equals the sum of values of subgraphs of all k colors. Given a tree, for each k from 1 to n\xe2\x88\x921 calculate the maximal value of a k-coloring." 1500
1466C "Canine poetry" dp,greedy,strings "After his wife\'s tragic death, Eurydice, Orpheus descended to the realm of death to see her. Reaching its gates was uneasy, but passing through them proved to be even more challenging. Mostly because of Cerberus, the three-headed hound of Hades. Orpheus, a famous poet, and musician plans to calm Cerberus with his poetry and safely walk past him. He created a very peculiar poem for Cerberus. It consists only of lowercase English letters. We call a poem\'s substring a palindrome if and only if it reads the same backwards and forwards. A string a is a substring of a string b if a can be obtained from b by deleting several (possibly zero or all) characters from the beginning and several (possibly zero or all) characters from the end.Unfortunately, Cerberus dislikes palindromes of length greater than 1. For example in the poem abaa the hound of Hades wouldn\'t like substrings aba and aa.Orpheus can only calm Cerberus if the hound likes his poetry. That\'s why he wants to change his poem so that it does not contain any palindrome substrings of length greater than 1.Orpheus can modify the poem by replacing a letter at any position with any lowercase English letter. He can use this operation arbitrarily many times (possibly zero). Since there can be many palindromes in his poem, he may have to make some corrections. But how many, exactly? Given the poem, determine the minimal number of letters that have to be changed so that the poem does not contain any palindromes of length greater than 1." 1300
1466B "Last minute enhancements" dp,greedy "Athenaeus has just finished creating his latest musical composition and will present it tomorrow to the people of Athens. Unfortunately, the melody is rather dull and highly likely won\'t be met with a warm reception. His song consists of n notes, which we will treat as positive integers. The diversity of a song is the number of different notes it contains. As a patron of music, Euterpe watches over composers and guides them throughout the process of creating new melodies. She decided to help Athenaeus by changing his song to make it more diverse.Being a minor goddess, she cannot arbitrarily change the song. Instead, for each of the n notes in the song, she can either leave it as it is or increase it by 1.Given the song as a sequence of integers describing the notes, find out the maximal, achievable diversity." 800
1466A "Bovine Dilemma" "brute force,geometry,math" "Argus was charged with guarding Io, which is not an ordinary cow. Io is quite an explorer, and she wanders off rather frequently, making Argus\' life stressful. So the cowherd decided to construct an enclosed pasture for Io.There are n trees growing along the river, where Argus tends Io. For this problem, the river can be viewed as the OX axis of the Cartesian coordinate system, and the n trees as points with the y-coordinate equal 0. There is also another tree growing in the point (0,1). Argus will tie a rope around three of the trees, creating a triangular pasture. Its exact shape doesn\'t matter to Io, but its area is crucial to her. There may be many ways for Argus to arrange the fence, but only the ones which result in different areas of the pasture are interesting for Io. Calculate the number of different areas that her pasture may have. Note that the pasture must have nonzero area." 800
1464F "My Beautiful Madness" "data structures,trees" "You are given a tree. We will consider simple paths on it. Let\'s denote path between vertices a and b as (a,b). Let d-neighborhood of a path be a set of vertices of the tree located at a distance \xe2\x89\xa4d from at least one vertex of the path (for example, 0-neighborhood of a path is a path itself). Let P be a multiset of the tree paths. Initially, it is empty. You are asked to maintain the following queries:  1 u v \xe2\x80\x94 add path (u,v) into P (1\xe2\x89\xa4u,v\xe2\x89\xa4n).  2 u v \xe2\x80\x94 delete path (u,v) from P (1\xe2\x89\xa4u,v\xe2\x89\xa4n). Notice that (u,v) equals to (v,u). For example, if P={(1,2),(1,2)}, than after query 2 2 1, P={(1,2)}.  3 d \xe2\x80\x94 if intersection of all d-neighborhoods of paths from P is not empty output ""Yes"", otherwise output ""No"" (0\xe2\x89\xa4d\xe2\x89\xa4n\xe2\x88\x921)." 3500
1463F "Max Correct Set" bitmasks,dp,math "Let\'s call the set of positive integers S correct if the following two conditions are met:   S\xe2\x8a\x86{1,2,\xe2\x80\xa6,n};  if a\xe2\x88\x88S and b\xe2\x88\x88S, then |a\xe2\x88\x92b|\xe2\x89\xa0x and |a\xe2\x88\x92b|\xe2\x89\xa0y. For the given values n, x, and y, you have to find the maximum size of the correct set." 3100
1463E "Plan of Lectures" "constructive algorithms,dfs and similar,dsu,graphs,implementation,sortings,trees" "Ivan is a programming teacher. During the academic year, he plans to give n lectures on n different topics. Each topic should be used in exactly one lecture. Ivan wants to choose which topic will he explain during the 1-st, 2-nd, ..., n-th lecture \xe2\x80\x94 formally, he wants to choose some permutation of integers from 1 to n (let\'s call this permutation q). qi is the index of the topic Ivan will explain during the i-th lecture.For each topic (except exactly one), there exists a prerequisite topic (for the topic i, the prerequisite topic is pi). Ivan cannot give a lecture on a topic before giving a lecture on its prerequisite topic. There exists at least one valid ordering of topics according to these prerequisite constraints.Ordering the topics correctly can help students understand the lectures better. Ivan has k special pairs of topics (xi,yi) such that he knows that the students will understand the yi-th topic better if the lecture on it is conducted right after the lecture on the xi-th topic. Ivan wants to satisfy the constraints on every such pair, that is, for every i\xe2\x88\x88[1,k], there should exist some j\xe2\x88\x88[1,n\xe2\x88\x921] such that qj=xi and qj+1=yi.Now Ivan wants to know if there exists an ordering of topics that satisfies all these constraints, and if at least one exists, find any of them." 2400
1463D Pairs "binary search,constructive algorithms,greedy,two pointers" "You have 2n integers 1,2,\xe2\x80\xa6,2n. You have to redistribute these 2n elements into n pairs. After that, you choose x pairs and take minimum elements from them, and from the other n\xe2\x88\x92x pairs, you take maximum elements.Your goal is to obtain the set of numbers {b1,b2,\xe2\x80\xa6,bn} as the result of taking elements from the pairs.What is the number of different x-s (0\xe2\x89\xa4x\xe2\x89\xa4n) such that it\'s possible to obtain the set b if for each x you can choose how to distribute numbers into pairs and from which x pairs choose minimum elements?" 1900
1463C "Busy Robot" implementation "You have a robot that can move along a number line. At time moment 0 it stands at point 0.You give n commands to the robot: at time ti seconds you command the robot to go to point xi. Whenever the robot receives a command, it starts moving towards the point xi with the speed of 1 unit per second, and he stops when he reaches that point. However, while the robot is moving, it ignores all the other commands that you give him.For example, suppose you give three commands to the robot: at time 1 move to point 5, at time 3 move to point 0 and at time 6 move to point 4. Then the robot stands at 0 until time 1, then starts moving towards 5, ignores the second command, reaches 5 at time 6 and immediately starts moving to 4 to execute the third command. At time 7 it reaches 4 and stops there.You call the command i successful, if there is a time moment in the range [ti,ti+1] (i. e. after you give this command and before you give another one, both bounds inclusive; we consider tn+1=+\xe2\x88\x9e) when the robot is at point xi. Count the number of successful commands. Note that it is possible that an ignored command is successful." 1800
1463B "Find The Array" "bitmasks,constructive algorithms,greedy" "You are given an array [a1,a2,\xe2\x80\xa6,an] such that 1\xe2\x89\xa4ai\xe2\x89\xa4109. Let S be the sum of all elements of the array a.Let\'s call an array b of n integers beautiful if:  1\xe2\x89\xa4bi\xe2\x89\xa4109 for each i from 1 to n;  for every pair of adjacent integers from the array (bi,bi+1), either bi divides bi+1, or bi+1 divides bi (or both);  2n\xe2\x88\x91i=1|ai\xe2\x88\x92bi|\xe2\x89\xa4S. Your task is to find any beautiful array. It can be shown that at least one beautiful array always exists." 1400
1463A Dungeon "binary search,math" "You are playing a new computer game in which you have to fight monsters. In a dungeon you are trying to clear, you met three monsters; the first of them has a health points, the second has b health points, and the third has c.To kill the monsters, you can use a cannon that, when fired, deals 1 damage to the selected monster. Every 7-th (i. e. shots with numbers 7, 14, 21 etc.) cannon shot is enhanced and deals 1 damage to all monsters, not just one of them. If some monster\'s current amount of health points is 0, it can\'t be targeted by a regular shot and does not receive damage from an enhanced shot.You want to pass the dungeon beautifully, i. e., kill all the monsters with the same enhanced shot (i. e. after some enhanced shot, the health points of each of the monsters should become equal to 0 for the first time). Each shot must hit a monster, i. e. each shot deals damage to at least one monster." 1100
1462F "The Treasure of The Segments" "binary search,data structures,greedy" "Polycarp found n segments on the street. A segment with the index i is described by two integers li and ri \xe2\x80\x94 coordinates of the beginning and end of the segment, respectively. Polycarp realized that he didn\'t need all the segments, so he wanted to delete some of them.Polycarp believes that a set of k segments is good if there is a segment [li,ri] (1\xe2\x89\xa4i\xe2\x89\xa4k) from the set, such that it intersects every segment from the set (the intersection must be a point or segment). For example, a set of 3 segments [[1,4],[2,3],[3,6]] is good, since the segment [2,3] intersects each segment from the set. Set of 4 segments [[1,2],[2,3],[3,5],[4,5]] is not good.Polycarp wonders, what is the minimum number of segments he has to delete so that the remaining segments form a good set?" 1800
1462E2 "Close Tuples (hard version)" "binary search,combinatorics,implementation,math,sortings,two pointers" "This is the hard version of this problem. The only difference between the easy and hard versions is the constraints on k and m. In this version of the problem, you need to output the answer by modulo 109+7.You are given a sequence a of length n consisting of integers from 1 to n. The sequence may contain duplicates (i.e. some elements can be equal).Find the number of tuples of m elements such that the maximum number in the tuple differs from the minimum by no more than k. Formally, you need to find the number of tuples of m indices i1<i2<\xe2\x80\xa6<im, such thatmax(ai1,ai2,\xe2\x80\xa6,aim)\xe2\x88\x92min(ai1,ai2,\xe2\x80\xa6,aim)\xe2\x89\xa4k.For example, if n=4, m=3, k=2, a=[1,2,4,3], then there are two such triples (i=1,j=2,z=4 and i=2,j=3,z=4). If n=4, m=2, k=1, a=[1,1,1,1], then all six possible pairs are suitable.As the result can be very large, you should print the value modulo 109+7 (the remainder when divided by 109+7)." 1700
1462E1 "Close Tuples (easy version)" "binary search,combinatorics,math,sortings,two pointers" "This is the easy version of this problem. The only difference between easy and hard versions is the constraints on k and m (in this version k=2 and m=3). Also, in this version of the problem, you DON\'T NEED to output the answer by modulo.You are given a sequence a of length n consisting of integers from 1 to n. The sequence may contain duplicates (i.e. some elements can be equal).Find the number of tuples of m=3 elements such that the maximum number in the tuple differs from the minimum by no more than k=2. Formally, you need to find the number of triples of indices i<j<z such thatmax(ai,aj,az)\xe2\x88\x92min(ai,aj,az)\xe2\x89\xa42.For example, if n=4 and a=[1,2,4,3], then there are two such triples (i=1,j=2,z=4 and i=2,j=3,z=4). If n=4 and a=[1,1,1,1], then all four possible triples are suitable." 1500
1462D "Add to Neighbour and Remove" "greedy,math,number theory" "Polycarp was given an array of a[1\xe2\x80\xa6n] of n integers. He can perform the following operation with the array a no more than n times:  Polycarp selects the index i and adds the value ai to one of his choice of its neighbors. More formally, Polycarp adds the value of ai to ai\xe2\x88\x921 or to ai+1 (if such a neighbor does not exist, then it is impossible to add to it).  After adding it, Polycarp removes the i-th element from the a array. During this step the length of a is decreased by 1. The two items above together denote one single operation.For example, if Polycarp has an array a=[3,1,6,6,2], then it can perform the following sequence of operations with it:   Polycarp selects i=2 and adds the value ai to (i\xe2\x88\x921)-th element: a=[4,6,6,2].  Polycarp selects i=1 and adds the value ai to (i+1)-th element: a=[10,6,2].  Polycarp selects i=3 and adds the value ai to (i\xe2\x88\x921)-th element: a=[10,8].  Polycarp selects i=2 and adds the value ai to (i\xe2\x88\x921)-th element: a=[18]. Note that Polycarp could stop performing operations at any time.Polycarp wondered how many minimum operations he would need to perform to make all the elements of a equal (i.e., he wants all ai are equal to each other)." 1400
1462C "Unique Number" "brute force,greedy,math" "You are given a positive number x. Find the smallest positive integer number that has the sum of digits equal to x and all digits are distinct (unique)." 900
1462B "Last Year\'s Substring" dp,implementation,strings "Polycarp has a string s[1\xe2\x80\xa6n] of length n consisting of decimal digits. Polycarp performs the following operation with the string s no more than once (i.e. he can perform operation 0 or 1 time):   Polycarp selects two numbers i and j (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n) and removes characters from the s string at the positions i,i+1,i+2,\xe2\x80\xa6,j (i.e. removes substring s[i\xe2\x80\xa6j]). More formally, Polycarp turns the string s into the string s1s2\xe2\x80\xa6si\xe2\x88\x921sj+1sj+2\xe2\x80\xa6sn. For example, the string s=""20192020"" Polycarp can turn into strings:   ""2020"" (in this case (i,j)=(3,6) or (i,j)=(1,4));  ""2019220"" (in this case (i,j)=(6,6));  ""020"" (in this case (i,j)=(1,5));  other operations are also possible, only a few of them are listed above. Polycarp likes the string ""2020"" very much, so he is wondering if it is possible to turn the string s into a string ""2020"" in no more than one operation? Note that you can perform zero operations." 800
1462A "Favorite Sequence" "implementation,two pointers" "Polycarp has a favorite sequence a[1\xe2\x80\xa6n] consisting of n integers. He wrote it out on the whiteboard as follows:  he wrote the number a1 to the left side (at the beginning of the whiteboard);  he wrote the number a2 to the right side (at the end of the whiteboard);  then as far to the left as possible (but to the right from a1), he wrote the number a3;  then as far to the right as possible (but to the left from a2), he wrote the number a4;  Polycarp continued to act as well, until he wrote out the entire sequence on the whiteboard.   The beginning of the result looks like this (of course, if n\xe2\x89\xa54). For example, if n=7 and a=[3,1,4,1,5,9,2], then Polycarp will write a sequence on the whiteboard [3,4,5,2,9,1,1].You saw the sequence written on the whiteboard and now you want to restore Polycarp\'s favorite sequence." 800
1461F "Mathematical Expression" "constructive algorithms,dp,greedy" "Barbara was late for her math class so as a punishment the teacher made her solve the task on a sheet of paper. Barbara looked at the sheet of paper and only saw n numbers a1,a2,\xe2\x80\xa6,an without any mathematical symbols. The teacher explained to Barbara that she has to place the available symbols between the numbers in a way that would make the resulting expression\'s value as large as possible. To find out which symbols were available the teacher has given Barbara a string s which contained that information.  It\'s easy to notice that Barbara has to place n\xe2\x88\x921 symbols between numbers in total. The expression must start with a number and all symbols must be allowed (i.e. included in s). Note that multiplication takes precedence over addition or subtraction, addition and subtraction have the same priority and performed from left to right. Help Barbara and create the required expression!" 2700
1461E "Water Level" "brute force,graphs,greedy,implementation,math" "In recent years John has very successfully settled at his new job at the office. But John doesn\'t like to idly sit around while his code is compiling, so he immediately found himself an interesting distraction. The point of his distraction was to maintain a water level in the water cooler used by other zebras.  Originally the cooler contained exactly k liters of water. John decided that the amount of water must always be at least l liters of water but no more than r liters. John will stay at the office for exactly t days. He knows that each day exactly x liters of water will be used by his colleagues. At the beginning of each day he can add exactly y liters of water to the cooler, but at any point in time the amount of water in the cooler must be in the range [l,r].Now John wants to find out whether he will be able to maintain the water level at the necessary level for t days. Help him answer this question!" 2200
1461D "Divide and Summarize" "binary search,brute force,data structures,divide and conquer,implementation,sortings" "Mike received an array a of length n as a birthday present and decided to test how pretty it is.An array would pass the i-th prettiness test if there is a way to get an array with a sum of elements totaling si, using some number (possibly zero) of slicing operations.  An array slicing operation is conducted in the following way:   assume mid=\xe2\x8c\x8amax(array)+min(array)2\xe2\x8c\x8b, where max and min \xe2\x80\x94 are functions that find the maximum and the minimum array elements. In other words, mid is the sum of the maximum and the minimum element of array divided by 2 rounded down.  Then the array is split into two parts left and right. The left array contains all elements which are less than or equal mid, and the right array contains all elements which are greater than mid. Elements in left and right keep their relative order from array.  During the third step we choose which of the left and right arrays we want to keep. The chosen array replaces the current one and the other is permanently discarded. You need to help Mike find out the results of q prettiness tests.Note that you test the prettiness of the array a, so you start each prettiness test with the primordial (initial) array a. Thus, the first slice (if required) is always performed on the array a." 1600
1461C "Random Events" dp,math,probabilities "Ron is a happy owner of a permutation a of length n.A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).  Ron\'s permutation is subjected to m experiments of the following type: (ri, pi). This means that elements in range [1,ri] (in other words, the prefix of length ri) have to be sorted in ascending order with the probability of pi. All experiments are performed in the same order in which they are specified in the input data.As an example, let\'s take a look at a permutation [4,2,1,5,3] and an experiment (3,0.6). After such an experiment with the probability of 60% the permutation will assume the form [1,2,4,5,3] and with a 40% probability it will remain unchanged.You have to determine the probability of the permutation becoming completely sorted in ascending order after m experiments." 1500
1461B "Find the Spruce" "brute force,dp,implementation" "Holidays are coming up really soon. Rick realized that it\'s time to think about buying a traditional spruce tree. But Rick doesn\'t want real trees to get hurt so he decided to find some in an n\xc3\x97m matrix consisting of ""*"" and ""."".  To find every spruce first let\'s define what a spruce in the matrix is. A set of matrix cells is called a spruce of height k with origin at point (x,y) if:  All cells in the set contain an ""*"".  For each 1\xe2\x89\xa4i\xe2\x89\xa4k all cells with the row number x+i\xe2\x88\x921 and columns in range [y\xe2\x88\x92i+1,y+i\xe2\x88\x921] must be a part of the set. All other cells cannot belong to the set.  Examples of correct and incorrect spruce trees:  Now Rick wants to know how many spruces his n\xc3\x97m matrix contains. Help Rick solve this problem." 1400
1461A "String Generation" "constructive algorithms,greedy" "One fall day Joe got bored because he couldn\'t find himself something interesting to do. Marty suggested Joe to generate a string of length n to entertain him somehow. It didn\'t seem particularly difficult, but Joe\'s generated string had to follow these rules:  the string may only contain characters \'a\', \'b\', or \'c\';  the maximum length of a substring of this string that is a palindrome does not exceed k.   A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end. For example, strings ""a"", ""bc"", ""abc"" are substrings of a string ""abc"", while strings ""ac"", ""ba"", ""cba"" are not.A string is a palindrome if it reads the same from the left to the right and from the right to the left. For example, strings ""abccba"", ""abbba"", ""aba"", ""abacaba"", ""a"", and ""bacab"" are palindromes, while strings ""abcbba"", ""abb"", and ""ab"" are not.Now Joe wants to find any correct string. Help him! It can be proven that the answer always exists under the given constraints." 800
1459B "Move and Turn" dp,math "A robot is standing at the origin of the infinite two-dimensional plane. Each second the robot moves exactly 1 meter in one of the four cardinal directions: north, south, west, and east. For the first step the robot can choose any of the four directions, but then at the end of every second it has to turn 90 degrees left or right with respect to the direction it just moved in. For example, if the robot has just moved north or south, the next step it takes has to be either west or east, and vice versa.The robot makes exactly n steps from its starting position according to the rules above. How many different points can the robot arrive to at the end? The final orientation of the robot can be ignored." 1300
1459A "Red-Blue Shuffle" math,probabilities "There are n cards numbered 1,\xe2\x80\xa6,n. The card i has a red digit ri and a blue digit bi written on it.We arrange all n cards in random order from left to right, with all permutations of 1,\xe2\x80\xa6,n having the same probability. We then read all red digits on the cards from left to right, and obtain an integer R. In the same way, we read all blue digits and obtain an integer B. When reading a number, leading zeros can be ignored. If all digits in a number are zeros, then the number is equal to 0. Below is an illustration of a possible rearrangement of three cards, and how R and B can be found.  Two players, Red and Blue, are involved in a bet. Red bets that after the shuffle R>B, and Blue bets that R<B. If in the end R=B, the bet results in a draw, and neither player wins.Determine, which of the two players is more likely (has higher probability) to win the bet, or that their chances are equal. Refer to the Note section for a formal discussion of comparing probabilities." 800
1458F "Range Diameter Sum" "data structures,trees" "You are given a tree with n vertices numbered 1,\xe2\x80\xa6,n. A tree is a connected simple graph without cycles.Let dist(u,v) be the number of edges in the unique simple path connecting vertices u and v.Let diam(l,r)=maxdist(u,v) over all pairs u,v such that l\xe2\x89\xa4u,v\xe2\x89\xa4r.Compute \xe2\x88\x911\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4ndiam(l,r)." 3500
1458E "Nim Shortcuts" "data structures,games" "After your debut mobile game ""Nim"" blew up, you decided to make a sequel called ""Nim 2"". This game will expand on the trusted Nim game formula, adding the much awaited second heap! In the game, there are two heaps, each containing a non-negative number of stones. Two players make moves in turn. On their turn, a player can take any positive number of stones from either one of the heaps. A player who is unable to move loses the game.To make the game easier to playtest, you\'ve introduced developer shortcuts. There are n shortcut positions (x1,y1),\xe2\x80\xa6,(xn,yn). These change the game as follows: suppose that before a player\'s turn the first and second heap contain x and y stones respectively. If the pair (x,y) is equal to one of the pairs (xi,yi), then the player about to move loses instantly, otherwise they are able to make moves as normal. Note that in the above explanation the two heaps and all pairs are ordered, that is, x must refer to the size of the first heap, and y must refer to the size of the second heap.The game release was followed by too much celebration, and next thing you know is developer shortcuts made their way to the next official update of the game! Players now complain that the AI opponent has become unbeatable at certain stages of the game. You now have to write a program to figure out which of the given initial positions can be won by the starting player, assuming both players act optimally." 3100
1458D "Flip and Reverse" "data structures,graphs,greedy" "You are given a string s of 0\'s and 1\'s. You are allowed to perform the following operation: choose a non-empty contiguous substring of s that contains an equal number of 0\'s and 1\'s; flip all characters in the substring, that is, replace all 0\'s with 1\'s, and vice versa; reverse the substring. For example, consider s = 00111011, and the following operation: Choose the first six characters as the substring to act upon: 00111011. Note that the number of 0\'s and 1\'s are equal, so this is a legal choice. Choosing substrings 0, 110, or the entire string would not be possible. Flip all characters in the substring: 11000111. Reverse the substring: 10001111.  Find the lexicographically smallest string that can be obtained from s after zero or more operations." 3100
1458C "Latin Square" math,matrices "You are given a square matrix of size n. Every row and every column of this matrix is a permutation of 1, 2, \xe2\x80\xa6, n. Let ai,j be the element at the intersection of i-th row and j-th column for every 1\xe2\x89\xa4i,j\xe2\x89\xa4n. Rows are numbered 1,\xe2\x80\xa6,n top to bottom, and columns are numbered 1,\xe2\x80\xa6,n left to right.There are six types of operations:   R: cyclically shift all columns to the right, formally, set the value of each ai,j to ai,((j\xe2\x88\x922)modn)+1;  L: cyclically shift all columns to the left, formally, set the value of each ai,j to ai,(jmodn)+1;  D: cyclically shift all rows down, formally, set the value of each ai,j to a((i\xe2\x88\x922)modn)+1,j;  U: cyclically shift all rows up, formally, set the value of each ai,j to a(imodn)+1,j;  I: replace the permutation read left to right in each row with its inverse.  C: replace the permutation read top to bottom in each column with its inverse.  Inverse of a permutation p1, p2, \xe2\x80\xa6, pn is a permutation q1, q2, \xe2\x80\xa6, qn, such that pqi=i for every 1\xe2\x89\xa4i\xe2\x89\xa4n.One can see that after any sequence of operations every row and every column of the matrix will still be a permutation of 1,2,\xe2\x80\xa6,n.Given the initial matrix description, you should process m operations and output the final matrix." 2700
1458B "Glass Half Spilled" dp "There are n glasses on the table numbered 1,\xe2\x80\xa6,n. The glass i can hold up to ai units of water, and currently contains bi units of water.You would like to choose k glasses and collect as much water in them as possible. To that effect you can pour water from one glass to another as many times as you like. However, because of the glasses\' awkward shape (and totally unrelated to your natural clumsiness), each time you try to transfer any amount of water, half of the amount is spilled on the floor.Formally, suppose a glass i currently contains ci units of water, and a glass j contains cj units of water. Suppose you try to transfer x units from glass i to glass j (naturally, x can not exceed ci). Then, x/2 units is spilled on the floor. After the transfer is done, the glass i will contain ci\xe2\x88\x92x units, and the glass j will contain min(aj,cj+x/2) units (excess water that doesn\'t fit in the glass is also spilled).Each time you transfer water, you can arbitrarlly choose from which glass i to which glass j to pour, and also the amount x transferred can be any positive real number.For each k=1,\xe2\x80\xa6,n, determine the largest possible total amount of water that can be collected in arbitrarily chosen k glasses after transferring water between glasses zero or more times." 2000
1458A "Row GCD" "math,number theory" "You are given two positive integer sequences a1,\xe2\x80\xa6,an and b1,\xe2\x80\xa6,bm. For each j=1,\xe2\x80\xa6,m find the greatest common divisor of a1+bj,\xe2\x80\xa6,an+bj." 1600
1456E XOR-ranges dp,greedy "Given integers c0,c1,\xe2\x80\xa6,ck\xe2\x88\x921 we can define the cost of a number 0\xe2\x89\xa4x<2k as p(x)=\xe2\x88\x91k\xe2\x88\x921i=0(\xe2\x8c\x8ax2i\xe2\x8c\x8bmod2)\xe2\x8b\x85ci. In other words, the cost of number x is the sum of ci over the bits of x which are equal to one.Let\'s define the cost of array a of length n\xe2\x89\xa52 with elements from [0,2k) as follows: cost(a)=\xe2\x88\x91n\xe2\x88\x921i=1p(ai\xe2\x8a\x95ai+1), where \xe2\x8a\x95 denotes bitwise exclusive OR operation.You have to construct an array of length n with minimal cost, given that each element should belong to the given segment: li\xe2\x89\xa4ai\xe2\x89\xa4ri." 3500
1455G "Forbidden Value" "data structures,dp" "Polycarp is editing a complicated computer program. First, variable x is declared and assigned to 0. Then there are instructions of two types:   set y v \xe2\x80\x94 assign x a value y or spend v burles to remove that instruction (thus, not reassign x);  if y \xe2\x80\xa6 end block \xe2\x80\x94 execute instructions inside the if block if the value of x is y and ignore the block otherwise. if blocks can contain set instructions and other if blocks inside them.However, when the value of x gets assigned to s, the computer breaks and immediately catches fire. Polycarp wants to prevent that from happening and spend as few burles as possible.What is the minimum amount of burles he can spend on removing set instructions to never assign x to s?" 2900
1455F "String and Operations" dp,greedy "You are given a string s consisting of n characters. These characters are among the first k lowercase letters of the Latin alphabet. You have to perform n operations with the string.During the i-th operation, you take the character that initially occupied the i-th position, and perform one of the following actions with it:  swap it with the previous character in the string (if it exists). This operation is represented as L;  swap it with the next character in the string (if it exists). This operation is represented as R;  cyclically change it to the previous character in the alphabet (b becomes a, c becomes b, and so on; a becomes the k-th letter of the Latin alphabet). This operation is represented as D;  cyclically change it to the next character in the alphabet (a becomes b, b becomes c, and so on; the k-th letter of the Latin alphabet becomes a). This operation is represented as U;  do nothing. This operation is represented as 0. For example, suppose the initial string is test, k=20, and the sequence of operations is URLD. Then the string is transformed as follows:  the first operation is U, so we change the underlined letter in test to the next one in the first 20 Latin letters, which is a. The string is now aest;  the second operation is R, so we swap the underlined letter with the next one in the string aest. The string is now aset;  the third operation is L, so we swap the underlined letter with the previous one in the string aset (note that this is now the 2-nd character of the string, but it was initially the 3-rd one, so the 3-rd operation is performed to it). The resulting string is saet;  the fourth operation is D, so we change the underlined letter in saet to the previous one in the first 20 Latin letters, which is s. The string is now saes. The result of performing the sequence of operations is saes.Given the string s and the value of k, find the lexicographically smallest string that can be obtained after applying a sequence of operations to s." 2800
1455E "Four Points" "brute force,constructive algorithms,flows,geometry,greedy,implementation,math,ternary search" "You are given four different integer points p1, p2, p3 and p4 on XY grid.In one step you can choose one of the points pi and move it in one of four directions by one. In other words, if you have chosen point pi=(x,y) you can move it to (x,y+1), (x,y\xe2\x88\x921), (x+1,y) or (x\xe2\x88\x921,y).Your goal to move points in such a way that they will form a square with sides parallel to OX and OY axes (a square with side 0 is allowed).What is the minimum number of steps you need to make such a square?" 2400
1455D "Sequence and Swaps" dp,greedy,sortings "You are given a sequence a consisting of n integers a1,a2,\xe2\x80\xa6,an, and an integer x. Your task is to make the sequence a sorted (it is considered sorted if the condition a1\xe2\x89\xa4a2\xe2\x89\xa4a3\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4an holds).To make the sequence sorted, you may perform the following operation any number of times you want (possibly zero): choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n and ai>x, and swap the values of ai and x.For example, if a=[0,2,3,5,4], x=1, the following sequence of operations is possible:  choose i=2 (it is possible since a2>x), then a=[0,1,3,5,4], x=2;  choose i=3 (it is possible since a3>x), then a=[0,1,2,5,4], x=3;  choose i=4 (it is possible since a4>x), then a=[0,1,2,3,4], x=5. Calculate the minimum number of operations you have to perform so that a becomes sorted, or report that it is impossible." 1600
1455C Ping-pong "constructive algorithms,games,math" "Alice and Bob play ping-pong with simplified rules.During the game, the player serving the ball commences a play. The server strikes the ball then the receiver makes a return by hitting the ball back. Thereafter, the server and receiver must alternately make a return until one of them doesn\'t make a return.The one who doesn\'t make a return loses this play. The winner of the play commences the next play. Alice starts the first play.Alice has x stamina and Bob has y. To hit the ball (while serving or returning) each player spends 1 stamina, so if they don\'t have any stamina, they can\'t return the ball (and lose the play) or can\'t serve the ball (in this case, the other player serves the ball instead). If both players run out of stamina, the game is over.Sometimes, it\'s strategically optimal not to return the ball, lose the current play, but save the stamina. On the contrary, when the server commences a play, they have to hit the ball, if they have some stamina left.Both Alice and Bob play optimally and want to, firstly, maximize their number of wins and, secondly, minimize the number of wins of their opponent.Calculate the resulting number of Alice\'s and Bob\'s wins." 1100
1455B Jumps "constructive algorithms,math" "You are standing on the OX-axis at point 0 and you want to move to an integer point x>0.You can make several jumps. Suppose you\'re currently at point y (y may be negative) and jump for the k-th time. You can:   either jump to the point y+k  or jump to the point y\xe2\x88\x921. What is the minimum number of jumps you need to reach the point x?" 1200
1455A "Strange Functions" "math,number theory" "Let\'s define a function f(x) (x is a positive integer) as follows: write all digits of the decimal representation of x backwards, then get rid of the leading zeroes. For example, f(321)=123, f(120)=21, f(1000000)=1, f(111)=111.Let\'s define another function g(x)=xf(f(x)) (x is a positive integer as well).Your task is the following: for the given positive integer n, calculate the number of different values of g(x) among all numbers x such that 1\xe2\x89\xa4x\xe2\x89\xa4n." 800
1454F "Array Partition" "binary search,data structures,greedy,two pointers" "You are given an array a consisting of n integers.Let min(l,r) be the minimum value among al,al+1,\xe2\x80\xa6,ar and max(l,r) be the maximum value among al,al+1,\xe2\x80\xa6,ar.Your task is to choose three positive (greater than 0) integers x, y and z such that:  x+y+z=n;  max(1,x)=min(x+1,x+y)=max(x+y+1,n). In other words, you have to split the array a into three consecutive non-empty parts that cover the whole array and the maximum in the first part equals the minimum in the second part and equals the maximum in the third part (or determine it is impossible to find such a partition).Among all such triples (partitions), you can choose any.You have to answer t independent test cases." 2100
1454E "Number of Simple Paths" "combinatorics,dfs and similar,graphs,trees" "You are given an undirected graph consisting of n vertices and n edges. It is guaranteed that the given graph is connected (i. e. it is possible to reach any vertex from any other vertex) and there are no self-loops and multiple edges in the graph.Your task is to calculate the number of simple paths of length at least 1 in the given graph. Note that paths that differ only by their direction are considered the same (i. e. you have to calculate the number of undirected paths). For example, paths [1,2,3] and [3,2,1] are considered the same.You have to answer t independent test cases.Recall that a path in the graph is a sequence of vertices v1,v2,\xe2\x80\xa6,vk such that each pair of adjacent (consecutive) vertices in this sequence is connected by an edge. The length of the path is the number of edges in it. A simple path is such a path that all vertices in it are distinct." 2000
1454D "Number into Sequence" "constructive algorithms,math,number theory" "You are given an integer n (n>1).Your task is to find a sequence of integers a1,a2,\xe2\x80\xa6,ak such that:  each ai is strictly greater than 1;  a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85ak=n (i. e. the product of this sequence is n);  ai+1 is divisible by ai for each i from 1 to k\xe2\x88\x921;  k is the maximum possible (i. e. the length of this sequence is the maximum possible). If there are several such sequences, any of them is acceptable. It can be proven that at least one valid sequence always exists for any integer n>1.You have to answer t independent test cases." 1300
1454C "Sequence Transformation" greedy,implementation "You are given a sequence a, initially consisting of n integers.You want to transform this sequence so that all elements in it are equal (i. e. it contains several occurrences of the same element).To achieve this, you choose some integer x that occurs at least once in a, and then perform the following operation any number of times (possibly zero): choose some segment [l,r] of the sequence and remove it. But there is one exception: you are not allowed to choose a segment that contains x. More formally, you choose some contiguous subsequence [al,al+1,\xe2\x80\xa6,ar] such that ai\xe2\x89\xa0x if l\xe2\x89\xa4i\xe2\x89\xa4r, and remove it. After removal, the numbering of elements to the right of the removed segment changes: the element that was the (r+1)-th is now l-th, the element that was (r+2)-th is now (l+1)-th, and so on (i. e. the remaining sequence just collapses).Note that you can not change x after you chose it.For example, suppose n=6, a=[1,3,2,4,1,2]. Then one of the ways to transform it in two operations is to choose x=1, then:  choose l=2, r=4, so the resulting sequence is a=[1,1,2];  choose l=3, r=3, so the resulting sequence is a=[1,1]. Note that choosing x is not an operation. Also, note that you can not remove any occurrence of x.Your task is to find the minimum number of operations required to transform the sequence in a way described above.You have to answer t independent test cases." 1200
1454B "Unique Bid Auction" implementation "There is a game called ""Unique Bid Auction"". You can read more about it here: https://en.wikipedia.org/wiki/Unique_bid_auction (though you don\'t have to do it to solve this problem).Let\'s simplify this game a bit. Formally, there are n participants, the i-th participant chose the number ai. The winner of the game is such a participant that the number he chose is unique (i. e. nobody else chose this number except him) and is minimal (i. e. among all unique values of a the minimum one is the winning one).Your task is to find the index of the participant who won the game (or -1 if there is no winner). Indexing is 1-based, i. e. the participants are numbered from 1 to n.You have to answer t independent test cases." 800
1454A "Special Permutation" "constructive algorithms,probabilities" "You are given one integer n (n>1).Recall that a permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation of length 5, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).Your task is to find a permutation p of length n that there is no index i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that pi=i (so, for all i from 1 to n the condition pi\xe2\x89\xa0i should be satisfied).You have to answer t independent test cases.If there are several answers, you can print any. It can be proven that the answer exists for each n>1." 800
1453F "Even Harder" dp "Gildong is now developing a puzzle game. The puzzle consists of n platforms numbered from 1 to n. The player plays the game as a character that can stand on each platform and the goal of the game is to move the character from the 1-st platform to the n-th platform.The i-th platform is labeled with an integer ai (0\xe2\x89\xa4ai\xe2\x89\xa4n\xe2\x88\x92i). When the character is standing on the i-th platform, the player can move the character to any of the j-th platforms where i+1\xe2\x89\xa4j\xe2\x89\xa4i+ai. If the character is on the i-th platform where ai=0 and i\xe2\x89\xa0n, the player loses the game.Since Gildong thinks the current game is not hard enough, he wants to make it even harder. He wants to change some (possibly zero) labels to 0 so that there remains exactly one way to win. He wants to modify the game as little as possible, so he\'s asking you to find the minimum number of platforms that should have their labels changed. Two ways are different if and only if there exists a platform the character gets to in one way but not in the other way." 2700
1453E "Dog Snacks" "binary search,dfs and similar,dp,greedy,trees" "Gildong is playing with his dog, Badugi. They\'re at a park that has n intersections and n\xe2\x88\x921 bidirectional roads, each 1 meter in length and connecting two intersections with each other. The intersections are numbered from 1 to n, and for every a and b (1\xe2\x89\xa4a,b\xe2\x89\xa4n), it is possible to get to the b-th intersection from the a-th intersection using some set of roads.Gildong has put one snack at every intersection of the park. Now Gildong will give Badugi a mission to eat all of the snacks. Badugi starts at the 1-st intersection, and he will move by the following rules:  Badugi looks for snacks that are as close to him as possible. Here, the distance is the length of the shortest path from Badugi\'s current location to the intersection with the snack. However, Badugi\'s sense of smell is limited to k meters, so he can only find snacks that are less than or equal to k meters away from himself. If he cannot find any such snack, he fails the mission.  Among all the snacks that Badugi can smell from his current location, he chooses a snack that minimizes the distance he needs to travel from his current intersection. If there are multiple such snacks, Badugi will choose one arbitrarily.  He repeats this process until he eats all n snacks. After that, he has to find the 1-st intersection again which also must be less than or equal to k meters away from the last snack he just ate. If he manages to find it, he completes the mission. Otherwise, he fails the mission. Unfortunately, Gildong doesn\'t know the value of k. So, he wants you to find the minimum value of k that makes it possible for Badugi to complete his mission, if Badugi moves optimally." 2300
1453D Checkpoints "brute force,constructive algorithms,greedy,math,probabilities" "Gildong is developing a game consisting of n stages numbered from 1 to n. The player starts the game from the 1-st stage and should beat the stages in increasing order of the stage number. The player wins the game after beating the n-th stage.There is at most one checkpoint on each stage, and there is always a checkpoint on the 1-st stage. At the beginning of the game, only the checkpoint on the 1-st stage is activated, and all other checkpoints are deactivated. When the player gets to the i-th stage that has a checkpoint, that checkpoint is activated.For each try of a stage, the player can either beat the stage or fail the stage. If they beat the i-th stage, the player is moved to the i+1-st stage. If they fail the i-th stage, the player is moved to the most recent checkpoint they activated, and they have to beat the stages after that checkpoint again.For example, assume that n=4 and the checkpoints are on the 1-st and 3-rd stages. The player starts at the 1-st stage. If they fail on the 1-st stage, they need to retry the 1-st stage because the checkpoint on the 1-st stage is the most recent checkpoint they activated. If the player beats the 1-st stage, they\'re moved to the 2-nd stage. If they fail it, they\'re sent back to the 1-st stage again. If they beat both the 1-st stage and the 2-nd stage, they get to the 3-rd stage and the checkpoint on the 3-rd stage is activated. Now whenever they fail on the 3-rd stage, or the 4-th stage after beating the 3-rd stage, they\'re sent back to the 3-rd stage. If they beat both the 3-rd stage and the 4-th stage, they win the game.Gildong is going to build the stages to have equal difficulty. He wants you to find any series of stages and checkpoints using at most 2000 stages, where the expected number of tries over all stages is exactly k, for a player whose probability of beating each stage is exactly 12." 1900
1453C Triangles greedy,implementation "Gildong has a square board consisting of n rows and n columns of square cells, each consisting of a single digit (from 0 to 9). The cell at the j-th column of the i-th row can be represented as (i,j), and the length of the side of each cell is 1. Gildong likes big things, so for each digit d, he wants to find a triangle such that:  Each vertex of the triangle is in the center of a cell.  The digit of every vertex of the triangle is d.  At least one side of the triangle is parallel to one of the sides of the board. You may assume that a side of length 0 is parallel to both sides of the board.  The area of the triangle is maximized. Of course, he can\'t just be happy with finding these triangles as is. Therefore, for each digit d, he\'s going to change the digit of exactly one cell of the board to d, then find such a triangle. He changes it back to its original digit after he is done with each digit. Find the maximum area of the triangle he can make for each digit.Note that he can put multiple vertices of the triangle on the same cell, and the triangle can be a degenerate triangle; i.e. the area of the triangle can be 0. Also, note that he is allowed to change the digit of a cell from d to d." 1700
1453B "Suffix Operations" "constructive algorithms,implementation" "Gildong has an interesting machine that has an array a with n integers. The machine supports two kinds of operations:  Increase all elements of a suffix of the array by 1.  Decrease all elements of a suffix of the array by 1. A suffix is a subsegment (contiguous elements) of the array that contains an. In other words, for all i where ai is included in the subsegment, all aj\'s where i<j\xe2\x89\xa4n must also be included in the subsegment.Gildong wants to make all elements of a equal \xe2\x80\x94 he will always do so using the minimum number of operations necessary. To make his life even easier, before Gildong starts using the machine, you have the option of changing one of the integers in the array to any other integer. You are allowed to leave the array unchanged. You want to minimize the number of operations Gildong performs. With your help, what is the minimum number of operations Gildong will perform?Note that even if you change one of the integers in the array, you should not count that as one of the operations because Gildong did not perform it." 1400
1453A "Cancel the Trains" implementation "Gildong\'s town has a train system that has 100 trains that travel from the bottom end to the top end and 100 trains that travel from the left end to the right end. The trains starting from each side are numbered from 1 to 100, respectively, and all trains have the same speed. Let\'s take a look at the picture below.  The train system can be represented as coordinates on a 2D plane. The i-th train starting at the bottom end is initially at (i,0) and will be at (i,T) after T minutes, and the i-th train starting at the left end is initially at (0,i) and will be at (T,i) after T minutes. All trains arrive at their destinations after 101 minutes.However, Gildong found that some trains scheduled to depart at a specific time, simultaneously, are very dangerous. At this time, n trains are scheduled to depart from the bottom end and m trains are scheduled to depart from the left end. If two trains are both at (x,y) at the same time for some x and y, they will crash into each other. Therefore, he is asking you to find the minimum number of trains that should be cancelled to prevent all such crashes." 800
1452G "Game On Tree" "data structures,dfs and similar,greedy,trees" "Alice and Bob are playing a game. They have a tree consisting of n vertices. Initially, Bob has k chips, the i-th chip is located in the vertex ai (all these vertices are unique). Before the game starts, Alice will place a chip into one of the vertices of the tree.The game consists of turns. Each turn, the following events happen (sequentially, exactly in the following order):  Alice either moves her chip to an adjacent vertex or doesn\'t move it;  for each Bob\'s chip, he either moves it to an adjacent vertex or doesn\'t move it. Note that this choice is done independently for each chip. The game ends when Alice\'s chip shares the same vertex with one (or multiple) of Bob\'s chips. Note that Bob\'s chips may share the same vertex, even though they are in different vertices at the beginning of the game.Alice wants to maximize the number of turns, Bob wants to minimize it. If the game ends in the middle of some turn (Alice moves her chip to a vertex that contains one or multiple Bob\'s chips), this turn is counted.For each vertex, calculate the number of turns the game will last if Alice places her chip in that vertex." 2700
1452F "Divide Powers" "constructive algorithms,greedy" "You are given a multiset of powers of two. More precisely, for each i from 0 to n exclusive you have cnti elements equal to 2i.In one operation, you can choose any one element 2l>1 and divide it into two elements 2l\xe2\x88\x921.You should perform q queries. Each query has one of two types:   ""1 pos val"" \xe2\x80\x94 assign cntpos:=val;  ""2 x k"" \xe2\x80\x94 calculate the minimum number of operations you need to make at least k elements with value lower or equal to 2x. Note that all queries of the second type don\'t change the multiset; that is, you just calculate the minimum number of operations, you don\'t perform them." 2900
1452E "Two Editorials" "brute force,dp,greedy,sortings,two pointers" "Berland regional ICPC contest has just ended. There were m participants numbered from 1 to m, who competed on a problemset of n problems numbered from 1 to n.Now the editorial is about to take place. There are two problem authors, each of them is going to tell the tutorial to exactly k consecutive tasks of the problemset. The authors choose the segment of k consecutive tasks for themselves independently of each other. The segments can coincide, intersect or not intersect at all.The i-th participant is interested in listening to the tutorial of all consecutive tasks from li to ri. Each participant always chooses to listen to only the problem author that tells the tutorials to the maximum number of tasks he is interested in. Let this maximum number be ai. No participant can listen to both of the authors, even if their segments don\'t intersect.The authors want to choose the segments of k consecutive tasks for themselves in such a way that the sum of ai over all participants is maximized." 2500
1452D "Radio Towers" combinatorics,dp,math "There are n+2 towns located on a coordinate line, numbered from 0 to n+1. The i-th town is located at the point i.You build a radio tower in each of the towns 1,2,\xe2\x80\xa6,n with probability 12 (these events are independent). After that, you want to set the signal power on each tower to some integer from 1 to n (signal powers are not necessarily the same, but also not necessarily different). The signal from a tower located in a town i with signal power p reaches every city c such that |c\xe2\x88\x92i|<p.After building the towers, you want to choose signal powers in such a way that:  towns 0 and n+1 don\'t get any signal from the radio towers;  towns 1,2,\xe2\x80\xa6,n get signal from exactly one radio tower each. For example, if n=5, and you have built the towers in towns 2, 4 and 5, you may set the signal power of the tower in town 2 to 2, and the signal power of the towers in towns 4 and 5 to 1. That way, towns 0 and n+1 don\'t get the signal from any tower, towns 1, 2 and 3 get the signal from the tower in town 2, town 4 gets the signal from the tower in town 4, and town 5 gets the signal from the tower in town 5.Calculate the probability that, after building the towers, you will have a way to set signal powers to meet all constraints." 1600
1452C "Two Brackets" greedy "You are given a string s, consisting of brackets of two types: \'(\', \')\', \'[\' and \']\'.A string is called a regular bracket sequence (RBS) if it\'s of one of the following types:   empty string;  \'(\' + RBS + \')\';  \'[\' + RBS + \']\';  RBS + RBS. where plus is a concatenation of two strings.In one move you can choose a non-empty subsequence of the string s (not necessarily consecutive) that is an RBS, remove it from the string and concatenate the remaining parts without changing the order.What is the maximum number of moves you can perform?" 800
1452B "Toy Blocks" "binary search,greedy,math,sortings" "You are asked to watch your nephew who likes to play with toy blocks in a strange way.He has n boxes and the i-th box has ai blocks. His game consists of two steps:   he chooses an arbitrary box i;  he tries to move all blocks from the i-th box to other boxes.  If he can make the same number of blocks in each of n\xe2\x88\x921 other boxes then he will be happy, otherwise, will be sad. Note that your nephew can only move the blocks from the chosen box to the other boxes; he cannot move blocks from the other boxes.You don\'t want to make your nephew sad, so you decided to put several extra blocks into some boxes in such a way that no matter which box i he chooses he won\'t be sad. What is the minimum number of extra blocks you need to put?" 1400
1452A "Robot Program" math "There is an infinite 2-dimensional grid. The robot stands in cell (0,0) and wants to reach cell (x,y). Here is a list of possible commands the robot can execute:  move north from cell (i,j) to (i,j+1);  move east from cell (i,j) to (i+1,j);  move south from cell (i,j) to (i,j\xe2\x88\x921);  move west from cell (i,j) to (i\xe2\x88\x921,j);  stay in cell (i,j). The robot wants to reach cell (x,y) in as few commands as possible. However, he can\'t execute the same command two or more times in a row.What is the minimum number of commands required to reach (x,y) from (0,0)?" 800
1451F "Nullify The Matrix" "constructive algorithms,games" "Jeel and Ashish play a game on an n\xc3\x97m matrix. The rows are numbered 1 to n from top to bottom and the columns are numbered 1 to m from left to right. They play turn by turn. Ashish goes first.Initially, each cell of the matrix contains a non-negative integer. Each turn, a player must perform all of the following actions in order.   Choose a starting cell (r1,c1) with non-zero value.  Choose a finishing cell (r2,c2) such that r1\xe2\x89\xa4r2 and c1\xe2\x89\xa4c2.  Decrease the value of the starting cell by some positive non-zero integer.  Pick any of the shortest paths between the two cells and either increase, decrease or leave the values of cells on this path unchanged. Note that:   a shortest path is one that passes through the least number of cells;  all cells on this path excluding the starting cell, but the finishing cell may be modified;  the resulting value of each cell must be a non-negative integer;  the cells are modified independently and not necessarily by the same value.  If the starting and ending cells are the same, then as per the rules, the value of the cell is decreased. No other operations are performed.The game ends when all the values become zero. The player who is unable to make a move loses. It can be shown that the game will end in a finite number of moves if both players play optimally.Given the initial matrix, if both players play optimally, can you predict who will win?" 2700
1451E2 "Bitwise Queries (Hard Version)" "bitmasks,constructive algorithms,interactive,math" "The only difference between the easy and hard versions is the constraints on the number of queries.This is an interactive problem.Ridbit has a hidden array a of n integers which he wants Ashish to guess. Note that n is a power of two. Ashish is allowed to ask three different types of queries. They are of the form   AND i j: ask for the bitwise AND of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j)  OR i j: ask for the bitwise OR of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j)  XOR i j: ask for the bitwise XOR of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j) Can you help Ashish guess the elements of the array?In this version, each element takes a value in the range [0,n\xe2\x88\x921] (inclusive) and Ashish can ask no more than n+1 queries." 2300
1451E1 "Bitwise Queries (Easy Version)" "bitmasks,constructive algorithms,interactive,math" "The only difference between the easy and hard versions is the constraints on the number of queries.This is an interactive problem.Ridbit has a hidden array a of n integers which he wants Ashish to guess. Note that n is a power of two. Ashish is allowed to ask three different types of queries. They are of the form   AND i j: ask for the bitwise AND of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j)  OR i j: ask for the bitwise OR of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j)  XOR i j: ask for the bitwise XOR of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j) Can you help Ashish guess the elements of the array?In this version, each element takes a value in the range [0,n\xe2\x88\x921] (inclusive) and Ashish can ask no more than n+2 queries." 2000
1451D "Circle Game" games,geometry,math "Utkarsh is forced to play yet another one of Ashish\'s games. The game progresses turn by turn and as usual, Ashish moves first.Consider the 2D plane. There is a token which is initially at (0,0). In one move a player must increase either the x coordinate or the y coordinate of the token by exactly k. In doing so, the player must ensure that the token stays within a (Euclidean) distance d from (0,0).In other words, if after a move the coordinates of the token are (p,q), then p2+q2\xe2\x89\xa4d2 must hold.The game ends when a player is unable to make a move. It can be shown that the game will end in a finite number of moves. If both players play optimally, determine who will win." 1700
1451C "String Equality" dp,greedy,hashing,implementation,strings "Ashish has two strings a and b, each of length n, and an integer k. The strings only contain lowercase English letters.He wants to convert string a into string b by performing some (possibly zero) operations on a.In one move, he can either   choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) and swap ai and ai+1, or  choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k+1) and if ai,ai+1,\xe2\x80\xa6,ai+k\xe2\x88\x921 are all equal to some character c (c\xe2\x89\xa0 \'z\'), replace each one with the next character (c+1), that is, \'a\' is replaced by \'b\', \'b\' is replaced by \'c\' and so on. Note that he can perform any number of operations, and the operations can only be performed on string a. Help Ashish determine if it is possible to convert string a into b after performing some (possibly zero) operations on it." 1400
1451B "Non-Substring Subsequence" dp,greedy,implementation,strings "Hr0d1y has q queries on a binary string s of length n. A binary string is a string containing only characters \'0\' and \'1\'.A query is described by a pair of integers li, ri (1\xe2\x89\xa4li<ri\xe2\x89\xa4n). For each query, he has to determine whether there exists a good subsequence in s that is equal to the substring s[li\xe2\x80\xa6ri].   A substring s[i\xe2\x80\xa6j] of a string s is the string formed by characters sisi+1\xe2\x80\xa6sj. String a is said to be a subsequence of string b if a can be obtained from b by deleting some characters without changing the order of the remaining characters. A subsequence is said to be good if it is not contiguous and has length \xe2\x89\xa52. For example, if s is ""1100110"", then the subsequences s1s2s4 (""1100110"") and s1s5s7 (""1100110"") are good, while s1s2s3 (""1100110"") is not good. Can you help Hr0d1y answer each query?" 900
1451A "Subtract or Divide" greedy,math "Ridbit starts with an integer n.In one move, he can perform one of the following operations:   divide n by one of its proper divisors, or  subtract 1 from n if n is greater than 1. A proper divisor is a divisor of a number, excluding itself. For example, 1, 2, 4, 5, and 10 are proper divisors of 20, but 20 itself is not.What is the minimum number of moves Ridbit is required to make to reduce n to 1?" 800
1450H2 "Multithreading (Hard Version)" combinatorics,implementation,math "The only difference between the two versions of the problem is that there are no updates in the easy version.There are n spools of thread placed on the rim of a circular table. The spools come in two types of thread: the first thread is black and the second thread is white.For any two spools of the same color, you can attach them with a thread of that color in a straight line segment. Define a matching as a way to attach spools together so that each spool is attached to exactly one other spool.Coloring is an assignment of colors (white and black) to the spools. A coloring is called valid if it has at least one matching. That is if the number of black spools and the number of white spools are both even.Given a matching, we can find the number of times some white thread intersects some black thread. We compute the number of pairs of differently colored threads that intersect instead of the number of intersection points, so one intersection point may be counted multiple times if different pairs of threads intersect at the same point. If c is a valid coloring, let f(c) denote the minimum number of such intersections out of all possible matchings.  The circle above is described by the coloring bwbbbwww. After matching the spools as shown, there is one intersection between differently colored threads. It can be proven that it is the minimum possible, so f(bwbbbwww)=1. You are given a string s representing an unfinished coloring, with black, white, and uncolored spools. A coloring c is called s-reachable if you can achieve it by assigning colors to the uncolored spools of s without changing the others.A coloring c is chosen uniformly at random among all valid, s-reachable colorings. Compute the expected value of f(c). You should find it by modulo 998244353.There will be m updates to change one character of s. After each update, you should again compute the expected value of f(c).We can show that each answer can be written in the form pq where p and q are relatively prime integers and q\xe2\x89\xa20(mod998244353). The answer by modulo 998244353 is equal to (p\xe2\x8b\x85q\xe2\x88\x921) modulo 998244353." 3300
1450H1 "Multithreading (Easy Version)" combinatorics,fft,math "The only difference between the two versions of the problem is that there are no updates in the easy version.There are n spools of thread placed on the rim of a circular table. The spools come in two types of thread: the first thread is black and the second thread is white.For any two spools of the same color, you can attach them with a thread of that color in a straight line segment. Define a matching as a way to attach spools together so that each spool is attached to exactly one other spool.Coloring is an assignment of colors (white and black) to the spools. A coloring is called valid if it has at least one matching. That is if the number of black spools and the number of white spools are both even.Given a matching, we can find the number of times some white thread intersects some black thread. We compute the number of pairs of differently colored threads that intersect instead of the number of intersection points, so one intersection point may be counted multiple times if different pairs of threads intersect at the same point. If c is a valid coloring, let f(c) denote the minimum number of such intersections out of all possible matchings.  The circle above is described by the coloring bwbbbwww. After matching the spools as shown, there is one intersection between differently colored threads. It can be proven that it is the minimum possible, so f(bwbbbwww)=1. You are given a string s representing an unfinished coloring, with black, white, and uncolored spools. A coloring c is called s-reachable if you can achieve it by assigning colors to the uncolored spools of s without changing the others.A coloring c is chosen uniformly at random among all valid, s-reachable colorings. Compute the expected value of f(c). You should find it by modulo 998244353.We can show that the answer can be written in the form pq where p and q are relatively prime integers and q\xe2\x89\xa20(mod998244353). The answer by modulo 998244353 is equal to (p\xe2\x8b\x85q\xe2\x88\x921) modulo 998244353." 2900
1450G Communism bitmasks,dp,trees "Please pay attention to the unusual memory limit in this problem.In a parallel universe, Satan is called ""Trygub"". For that reason, the letters of his namesake were deleted from the alphabet in ancient times.The government has n workers standing in a row and numbered with integers from 1 to n from left to right. Their job categories can be represented as a string s of length n, where the character si represents the job category of the i-th worker.A new law will be approved to increase the equality between the workers. The government decided to make everyone have the same job category by performing the following operation any number of times (possibly zero).There is a fixed rational parameter k=ab describing how easy it is to convince the public, and it will be used to determine the success of an operation.In an operation, the government first selects a job category x with at least one worker at the current moment. Suppose i1,\xe2\x80\xa6,im (i1<\xe2\x80\xa6<im) are the positions of all the workers with job category x. If k\xe2\x8b\x85(im\xe2\x88\x92i1+1)\xe2\x89\xa4m, the government is able to choose any job category y with at least one worker at the current moment and change the job category of all workers with job category x to job category y.If it is possible to make all workers have job category x, we say that x is obtainable. Can you tell the government the set of obtainable job categories?" 3500
1450F "The Struggling Contestant" "constructive algorithms,greedy" "To help those contestants who struggle a lot in contests, the headquarters of Codeforces are planning to introduce Division 5. In this new division, the tags of all problems will be announced prior to the round to help the contestants.The contest consists of n problems, where the tag of the i-th problem is denoted by an integer ai.You want to AK (solve all problems). To do that, you must solve the problems in some order. To make the contest funnier, you created extra limitations on yourself. You do not want to solve two problems consecutively with the same tag since it is boring. Also, you are afraid of big jumps in difficulties while solving them, so you want to minimize the number of times that you solve two problems consecutively that are not adjacent in the contest order.Formally, your solve order can be described by a permutation p of length n. The cost of a permutation is defined as the number of indices i (1\xe2\x89\xa4i<n) where |pi+1\xe2\x88\x92pi|>1. You have the requirement that api\xe2\x89\xa0api+1 for all 1\xe2\x89\xa4i<n.You want to know the minimum possible cost of permutation that satisfies the requirement. If no permutations meet this requirement, you should report about it." 2400
1450E Capitalism "constructive algorithms,dfs and similar,graphs,shortest paths" "A society can be represented by a connected, undirected graph of n vertices and m edges. The vertices represent people, and an edge (i,j) represents a friendship between people i and j.In society, the i-th person has an income ai. A person i is envious of person j if aj=ai+1. That is if person j has exactly 1 more unit of income than person i.The society is called capitalist if for every pair of friends one is envious of the other. For some friendships, you know which friend is envious of the other. For the remaining friendships, you do not know the direction of envy.The income inequality of society is defined as max1\xe2\x89\xa4i\xe2\x89\xa4nai\xe2\x88\x92min1\xe2\x89\xa4i\xe2\x89\xa4nai.You only know the friendships and not the incomes. If it is impossible for this society to be capitalist with the given knowledge, you should report about it. Otherwise, you should find an assignment of incomes in which the society is capitalist, and the income inequality is maximized." 2700
1450D "Rating Compression" "binary search,data structures,greedy,implementation,two pointers" "On the competitive programming platform CodeCook, every person has a rating graph described by an array of integers a of length n. You are now updating the infrastructure, so you\'ve created a program to compress these graphs.The program works as follows. Given an integer parameter k, the program takes the minimum of each contiguous subarray of length k in a.More formally, for an array a of length n and an integer k, define the k-compression array of a as an array b of length n\xe2\x88\x92k+1, such that bj=minj\xe2\x89\xa4i\xe2\x89\xa4j+k\xe2\x88\x921aiFor example, the 3-compression array of [1,3,4,5,2] is [min{1,3,4},min{3,4,5},min{4,5,2}]=[1,3,2].A permutation of length m is an array consisting of m distinct integers from 1 to m in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (m=3 but there is 4 in the array).A k-compression array will make CodeCook users happy if it will be a permutation. Given an array a, determine for all 1\xe2\x89\xa4k\xe2\x89\xa4n if CodeCook users will be happy after a k-compression of this array or not." 1800
1450C2 "Errich-Tac-Toe (Hard Version)" "constructive algorithms,math" "The only difference between the easy and hard versions is that tokens of type O do not appear in the input of the easy version.Errichto gave Monogon the following challenge in order to intimidate him from taking his top contributor spot on Codeforces.In a Tic-Tac-Toe grid, there are n rows and n columns. Each cell of the grid is either empty or contains a token. There are two types of tokens: X and O. If there exist three tokens of the same type consecutive in a row or column, it is a winning configuration. Otherwise, it is a draw configuration.  The patterns in the first row are winning configurations. The patterns in the second row are draw configurations. In an operation, you can change an X to an O, or an O to an X. Let k denote the total number of tokens in the grid. Your task is to make the grid a draw in at most \xe2\x8c\x8ak3\xe2\x8c\x8b (rounding down) operations.You are not required to minimize the number of operations." 2300
1450C1 "Errich-Tac-Toe (Easy Version)" "constructive algorithms,math" "The only difference between the easy and hard versions is that tokens of type O do not appear in the input of the easy version.Errichto gave Monogon the following challenge in order to intimidate him from taking his top contributor spot on Codeforces.In a Tic-Tac-Toe grid, there are n rows and n columns. Each cell of the grid is either empty or contains a token. There are two types of tokens: X and O. If there exist three tokens of the same type consecutive in a row or column, it is a winning configuration. Otherwise, it is a draw configuration.  The patterns in the first row are winning configurations. The patterns in the second row are draw configurations. In an operation, you can change an X to an O, or an O to an X. Let k denote the total number of tokens in the grid. Your task is to make the grid a draw in at most \xe2\x8c\x8ak3\xe2\x8c\x8b (rounding down) operations.You are not required to minimize the number of operations." 2100
1450B "Balls of Steel" "brute force,geometry,greedy" "You have n distinct points (x1,y1),\xe2\x80\xa6,(xn,yn) on the plane and a non-negative integer parameter k. Each point is a microscopic steel ball and k is the attract power of a ball when it\'s charged. The attract power is the same for all balls.In one operation, you can select a ball i to charge it. Once charged, all balls with Manhattan distance at most k from ball i move to the position of ball i. Many balls may have the same coordinate after an operation.More formally, for all balls j such that |xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|\xe2\x89\xa4k, we assign xj:=xi and yj:=yi.  An example of an operation. After charging the ball in the center, two other balls move to its position. On the right side, the red dot in the center is the common position of those balls. Your task is to find the minimum number of operations to move all balls to the same position, or report that this is impossible." 1000
1450A "Avoid Trygub" "constructive algorithms,sortings" "A string b is a subsequence of a string a if b can be obtained from a by deletion of several (possibly, zero or all) characters. For example, ""xy"" is a subsequence of ""xzyw"" and ""xy"", but not ""yx"".You are given a string a. Your task is to reorder the characters of a so that ""trygub"" is not a subsequence of the resulting string.In other words, you should find a string b which is a permutation of symbols of the string a and ""trygub"" is not a subsequence of b.We have a truly marvelous proof that any string can be arranged not to contain ""trygub"" as a subsequence, but this problem statement is too short to contain it." 800
1447B "Numbers Box" greedy,math "You are given a rectangular grid with n rows and m columns. The cell located on the i-th row from the top and the j-th column from the left has a value aij written in it.You can perform the following operation any number of times (possibly zero):  Choose any two adjacent cells and multiply the values in them by \xe2\x88\x921. Two cells are called adjacent if they share a side. Note that you can use a cell more than once in different operations.You are interested in X, the sum of all the numbers in the grid. What is the maximum X you can achieve with these operations?" 1000
1447A "Add Candies" "constructive algorithms,math" "There are n bags with candies, initially the i-th bag contains i candies. You want all the bags to contain an equal amount of candies in the end. To achieve this, you will: Choose m such that 1\xe2\x89\xa4m\xe2\x89\xa41000Perform m operations. In the j-th operation, you will pick one bag and add j candies to all bags apart from the chosen one.Your goal is to find a valid sequence of operations after which all the bags will contain an equal amount of candies. It can be proved that for the given constraints such a sequence always exists.You don\'t have to minimize m.If there are several valid sequences, you can output any." 800
1446F "Line Distance" "binary search,data structures,geometry" "You are given an integer k and n distinct points with integer coordinates on the Euclidean plane, the i-th point has coordinates (xi,yi).Consider a list of all the n(n\xe2\x88\x921)2 pairs of points ((xi,yi),(xj,yj)) (1\xe2\x89\xa4i<j\xe2\x89\xa4n). For every such pair, write out the distance from the line through these two points to the origin (0,0).Your goal is to calculate the k-th smallest number among these distances." 3200
1446E "Long Recovery" "constructive algorithms,dfs and similar" "A patient has been infected with an unknown disease. His body can be seen as an infinite grid of triangular cells which looks as follows:  Two cells are neighboring if they share a side. Therefore, each cell (x, y) has exactly three neighbors:   (x+1, y)  (x\xe2\x88\x921, y)  (x+1, y\xe2\x88\x921) if x is even and (x\xe2\x88\x921, y+1) otherwise.  Initially some cells are infected, all the others are healthy. The process of recovery begins. Each second, for exactly one cell (even though there might be multiple cells that could change its state) one of the following happens:  A healthy cell with at least 2 infected neighbors also becomes infected.  An infected cell with at least 2 healthy neighbors also becomes healthy. If no such cell exists, the process of recovery stops. Patient is considered recovered if the process of recovery has stopped and all the cells are healthy.We\'re interested in a worst-case scenario: is it possible that the patient never recovers, or if it\'s not possible, what is the maximum possible duration of the recovery process?" 3500
1446D2 "Frequency Problem (Hard Version)" "data structures,greedy,two pointers" "This is the hard version of the problem. The difference between the versions is in the constraints on the array elements. You can make hacks only if all versions of the problem are solved.You are given an array [a1,a2,\xe2\x80\xa6,an]. Your goal is to find the length of the longest subarray of this array such that the most frequent value in it is not unique. In other words, you are looking for a subarray such that if the most frequent value occurs f times in this subarray, then at least 2 different values should occur exactly f times.An array c is a subarray of an array d if c can be obtained from d by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 3000
1446D1 "Frequency Problem (Easy Version)" "data structures,greedy" "This is the easy version of the problem. The difference between the versions is in the constraints on the array elements. You can make hacks only if all versions of the problem are solved.You are given an array [a1,a2,\xe2\x80\xa6,an]. Your goal is to find the length of the longest subarray of this array such that the most frequent value in it is not unique. In other words, you are looking for a subarray such that if the most frequent value occurs f times in this subarray, then at least 2 different values should occur exactly f times.An array c is a subarray of an array d if c can be obtained from d by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 2600
1446C "Xor Tree" "binary search,bitmasks,data structures,divide and conquer,dp,trees" "For a given sequence of distinct non-negative integers (b1,b2,\xe2\x80\xa6,bk) we determine if it is good in the following way:  Consider a graph on k nodes, with numbers from b1 to bk written on them. For every i from 1 to k: find such j (1\xe2\x89\xa4j\xe2\x89\xa4k, j\xe2\x89\xa0i), for which (bi\xe2\x8a\x95bj) is the smallest among all such j, where \xe2\x8a\x95 denotes the operation of bitwise XOR (https://en.wikipedia.org/wiki/Bitwise_operation#XOR). Next, draw an undirected edge between vertices with numbers bi and bj in this graph. We say that the sequence is good if and only if the resulting graph forms a tree (is connected and doesn\'t have any simple cycles). It is possible that for some numbers bi and bj, you will try to add the edge between them twice. Nevertheless, you will add this edge only once.You can find an example below (the picture corresponding to the first test case). Sequence (0,1,5,2,6) is not good as we cannot reach 1 from 5.However, sequence (0,1,5,2) is good.   You are given a sequence (a1,a2,\xe2\x80\xa6,an) of distinct non-negative integers. You would like to remove some of the elements (possibly none) to make the remaining sequence good. What is the minimum possible number of removals required to achieve this goal?It can be shown that for any sequence, we can remove some number of elements, leaving at least 2, so that the remaining sequence is good." 2100
1446B "Catching Cheaters" dp,strings "You are given two strings A and B representing essays of two students who are suspected cheaters. For any two strings C, D we define their similarity score S(C,D) as 4\xe2\x8b\x85LCS(C,D)\xe2\x88\x92|C|\xe2\x88\x92|D|, where LCS(C,D) denotes the length of the Longest Common Subsequence of strings C and D. You believe that only some part of the essays could have been copied, therefore you\'re interested in their substrings.Calculate the maximal similarity score over all pairs of substrings. More formally, output maximal S(C,D) over all pairs (C,D), where C is some substring of A, and D is some substring of B. If X is a string, |X| denotes its length.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters. Pay attention to the difference between the substring and subsequence, as they both appear in the problem statement. You may wish to read the Wikipedia page about the Longest Common Subsequence problem." 1800
1446A Knapsack "constructive algorithms,greedy,sortings" "You have a knapsack with the capacity of W. There are also n items, the i-th one has weight wi. You want to put some of these items into the knapsack in such a way that their total weight C is at least half of its size, but (obviously) does not exceed it. Formally, C should satisfy: \xe2\x8c\x88W2\xe2\x8c\x89\xe2\x89\xa4C\xe2\x89\xa4W. Output the list of items you will put into the knapsack or determine that fulfilling the conditions is impossible. If there are several possible lists of items satisfying the conditions, you can output any. Note that you don\'t have to maximize the sum of weights of items in the knapsack." 1300
1445B Elimination greedy,math "There is a famous olympiad, which has more than a hundred participants. The Olympiad consists of two stages: the elimination stage, and the final stage. At least a hundred participants will advance to the final stage. The elimination stage in turn consists of two contests.A result of the elimination stage is the total score in two contests, but, unfortunately, the jury lost the final standings and has only standings for the first and for the second contest separately. In each contest, the participants are ranked by their point score in non-increasing order. When two participants have a tie (earned the same score), they are ranked by their passport number (in accordance with local regulations, all passport numbers are distinct). In the first contest, the participant on the 100-th place scored a points. Also, the jury checked all participants from the 1-st to the 100-th place (inclusive) in the first contest and found out that all of them have at least b points in the second contest.Similarly, for the second contest, the participant on the 100-th place has c points. And the jury checked that all the participants from the 1-st to the 100-th place (inclusive) have at least d points in the first contest.After two contests, all participants are ranked by their total score in two contests in non-increasing order. When participants have the same total score, tie-breaking with passport numbers is used. The cutoff score to qualify to the final stage is the total score of the participant on the 100-th place.Given integers a, b, c, d, please help the jury determine the smallest possible value of the cutoff score." 900
1445A "Array Rearrangment" greedy,sortings "You are given two arrays a and b, each consisting of n positive integers, and an integer x. Please determine if one can rearrange the elements of b so that ai+bi\xe2\x89\xa4x holds for each i (1\xe2\x89\xa4i\xe2\x89\xa4n)." 800
1444E "Finding the Vertex" "brute force,dfs and similar,dp,interactive,trees" "This is an interactive problem.You are given a tree \xe2\x80\x94 connected undirected graph without cycles. One vertex of the tree is special, and you have to find which one. You can ask questions in the following form: given an edge of the tree, which endpoint is closer to the special vertex, meaning which endpoint\'s shortest path to the special vertex contains fewer edges. You have to find the special vertex by asking the minimum number of questions in the worst case for a given tree.Please note that the special vertex might not be fixed by the interactor in advance: it might change the vertex to any other one, with the requirement of being consistent with the previously given answers." 3500
1444D "Rectangular Polyline" "constructive algorithms,dp,geometry" "One drew a closed polyline on a plane, that consisted only of vertical and horizontal segments (parallel to the coordinate axes). The segments alternated between horizontal and vertical ones (a horizontal segment was always followed by a vertical one, and vice versa). The polyline did not contain strict self-intersections, which means that in case any two segments shared a common point, that point was an endpoint for both of them (please consult the examples in the notes section).Unfortunately, the polyline was erased, and you only know the lengths of the horizonal and vertical segments. Please construct any polyline matching the description with such segments, or determine that it does not exist." 2900
1444C Team-Building "data structures,dfs and similar,dsu,graphs" "The new academic year has started, and Berland\'s university has n first-year students. They are divided into k academic groups, however, some of the groups might be empty. Among the students, there are m pairs of acquaintances, and each acquaintance pair might be both in a common group or be in two different groups.Alice is the curator of the first years, she wants to host an entertaining game to make everyone know each other. To do that, she will select two different academic groups and then divide the students of those groups into two teams. The game requires that there are no acquaintance pairs inside each of the teams.Alice wonders how many pairs of groups she can select, such that it\'ll be possible to play a game after that. All students of the two selected groups must take part in the game.Please note, that the teams Alice will form for the game don\'t need to coincide with groups the students learn in. Moreover, teams may have different sizes (or even be empty)." 2500
1444B "Divide and Sum" combinatorics,math,sortings "You are given an array a of length 2n. Consider a partition of array a into two subsequences p and q of length n each (each element of array a should be in exactly one subsequence: either in p or in q).Let\'s sort p in non-decreasing order, and q in non-increasing order, we can denote the sorted versions by x and y, respectively. Then the cost of a partition is defined as f(p,q)=\xe2\x88\x91ni=1|xi\xe2\x88\x92yi|.Find the sum of f(p,q) over all correct partitions of array a. Since the answer might be too big, print its remainder modulo 998244353." 1900
1444A Division "brute force,math,number theory" "Oleg\'s favorite subjects are History and Math, and his favorite branch of mathematics is division.To improve his division skills, Oleg came up with t pairs of integers pi and qi and for each pair decided to find the greatest integer xi, such that:   pi is divisible by xi;  xi is not divisible by qi.  Oleg is really good at division and managed to find all the answers quickly, how about you?" 1500
1443E "Long Permutation" "brute force,math,two pointers" "A permutation is a sequence of integers from 1 to n of length n containing each number exactly once. For example, [1], [4,3,5,1,2], [3,2,1] \xe2\x80\x94 are permutations, and [1,1], [4,3,1], [2,3,4] \xe2\x80\x94 no.Permutation a is lexicographically smaller than permutation b (they have the same length n), if in the first index i in which they differ, a[i]<b[i]. For example, the permutation [1,3,2,4] is lexicographically smaller than the permutation [1,3,4,2], because the first two elements are equal, and the third element in the first permutation is smaller than in the second.The next permutation for a permutation a of length n \xe2\x80\x94 is the lexicographically smallest permutation b of length n that lexicographically larger than a. For example:   for permutation [2,1,4,3] the next permutation is [2,3,1,4];  for permutation [1,2,3] the next permutation is [1,3,2];  for permutation [2,1] next permutation does not exist. You are given the number n \xe2\x80\x94 the length of the initial permutation. The initial permutation has the form a=[1,2,\xe2\x80\xa6,n]. In other words, a[i]=i (1\xe2\x89\xa4i\xe2\x89\xa4n).You need to process q queries of two types:   1 l r: query for the sum of all elements on the segment [l,r]. More formally, you need to find a[l]+a[l+1]+\xe2\x80\xa6+a[r].  2 x: x times replace the current permutation with the next permutation. For example, if x=2 and the current permutation has the form [1,3,4,2], then we should perform such a chain of replacements [1,3,4,2]\xe2\x86\x92[1,4,2,3]\xe2\x86\x92[1,4,3,2]. For each query of the 1-st type output the required sum." 2400
1443C "The Delivery Dilemma" "binary search,greedy,sortings" "Petya is preparing for his birthday. He decided that there would be n different dishes on the dinner table, numbered from 1 to n. Since Petya doesn\'t like to cook, he wants to order these dishes in restaurants.Unfortunately, all dishes are prepared in different restaurants and therefore Petya needs to pick up his orders from n different places. To speed up this process, he wants to order courier delivery at some restaurants. Thus, for each dish, there are two options for Petya how he can get it:  the dish will be delivered by a courier from the restaurant i, in this case the courier will arrive in ai minutes,  Petya goes to the restaurant i on his own and picks up the dish, he will spend bi minutes on this. Each restaurant has its own couriers and they start delivering the order at the moment Petya leaves the house. In other words, all couriers work in parallel. Petya must visit all restaurants in which he has not chosen delivery, he does this consistently.For example, if Petya wants to order n=4 dishes and a=[3,7,4,5], and b=[2,1,2,4], then he can order delivery from the first and the fourth restaurant, and go to the second and third on your own. Then the courier of the first restaurant will bring the order in 3 minutes, the courier of the fourth restaurant will bring the order in 5 minutes, and Petya will pick up the remaining dishes in 1+2=3 minutes. Thus, in 5 minutes all the dishes will be at Petya\'s house.Find the minimum time after which all the dishes can be at Petya\'s home." 1400
1443B "Saving the City" dp,greedy,math,sortings "Bertown is a city with n buildings in a straight line.The city\'s security service discovered that some buildings were mined. A map was compiled, which is a string of length n, where the i-th character is ""1"" if there is a mine under the building number i and ""0"" otherwise.Bertown\'s best sapper knows how to activate mines so that the buildings above them are not damaged. When a mine under the building numbered x is activated, it explodes and activates two adjacent mines under the buildings numbered x\xe2\x88\x921 and x+1 (if there were no mines under the building, then nothing happens). Thus, it is enough to activate any one mine on a continuous segment of mines to activate all the mines of this segment. For manual activation of one mine, the sapper takes a coins. He can repeat this operation as many times as you want.Also, a sapper can place a mine under a building if it wasn\'t there. For such an operation, he takes b coins. He can also repeat this operation as many times as you want.The sapper can carry out operations in any order.You want to blow up all the mines in the city to make it safe. Find the minimum number of coins that the sapper will have to pay so that after his actions there are no mines left in the city." 1300
1443A "Kids Seating" "constructive algorithms,math" "Today the kindergarten has a new group of n kids who need to be seated at the dinner table. The chairs at the table are numbered from 1 to 4n. Two kids can\'t sit on the same chair. It is known that two kids who sit on chairs with numbers a and b (a\xe2\x89\xa0b) will indulge if:   gcd(a,b)=1 or,  a divides b or b divides a. gcd(a,b) \xe2\x80\x94 the maximum number x such that a is divisible by x and b is divisible by x.For example, if n=3 and the kids sit on chairs with numbers 2, 3, 4, then they will indulge since 4 is divided by 2 and gcd(2,3)=1. If kids sit on chairs with numbers 4, 6, 10, then they will not indulge.The teacher really doesn\'t want the mess at the table, so she wants to seat the kids so there are no 2 of the kid that can indulge. More formally, she wants no pair of chairs a and b that the kids occupy to fulfill the condition above.Since the teacher is very busy with the entertainment of the kids, she asked you to solve this problem." 800
1442F "Differentiating Games" games,interactive "This is an interactive problemGinny is taking an exam on game theory. The professor is tired of hearing the same answers over and over again, so he offered Ginny to play a game instead of a standard exam. As known from the course, a combinatorial game on a graph with multiple starting positions is a game with a directed graph and multiple starting vertices holding a token each. Two players take turns moving one of the tokens along the graph edges on each turn. The player who can\'t make a move loses the game. If both players can play an infinitely long game without losing, a draw is called.For the exam, the professor drew an acyclic directed graph and chose one of its vertices. Ginny needs to guess the vertex the professor chose. To do so, Ginny can choose a multiset of vertices S several times and ask the professor: ""If I put one token in each vertex of the given graph for each occurrence of the vertex in the multiset S, and then one more in the selected vertex, what would be the result of the combinatorial game?"". Having given the task, the professor left the room to give Ginny some time to prepare for the game. Ginny thinks that she\'s being tricked because the problem is impossible to solve. Therefore, while the professor is away, she wants to add or remove several edges from the graph. Even though the original graph was acyclic, edges could be added to the graph to make cycles appear." 3400
1442E "Black, White and Grey Tree" "binary search,constructive algorithms,dfs and similar,dp,greedy,trees" "You are given a tree with each vertex coloured white, black or grey. You can remove elements from the tree by selecting a subset of vertices in a single connected component and removing them and their adjacent edges from the graph. The only restriction is that you are not allowed to select a subset containing a white and a black vertex at once.What is the minimum number of removals necessary to remove all vertices from the tree?" 3000
1442D Sum "data structures,divide and conquer,dp,greedy" "You are given n non-decreasing arrays of non-negative numbers. Vasya repeats the following operation k times:   Selects a non-empty array.  Puts the first element of the selected array in his pocket.  Removes the first element from the selected array. Vasya wants to maximize the sum of the elements in his pocket." 2800
1442C "Graph Transpositions" "dfs and similar,graphs,greedy,shortest paths" "You are given a directed graph of n vertices and m edges. Vertices are numbered from 1 to n. There is a token in vertex 1.The following actions are allowed:   Token movement. To move the token from vertex u to vertex v if there is an edge u\xe2\x86\x92v in the graph. This action takes 1 second.  Graph transposition. To transpose all the edges in the graph: replace each edge u\xe2\x86\x92v by an edge v\xe2\x86\x92u. This action takes increasingly more time: k-th transposition takes 2k\xe2\x88\x921 seconds, i.e. the first transposition takes 1 second, the second one takes 2 seconds, the third one takes 4 seconds, and so on. The goal is to move the token from vertex 1 to vertex n in the shortest possible time. Print this time modulo 998244353." 2400
1442B "Identify the Operations" "combinatorics,data structures,dsu,greedy,implementation" "We start with a permutation a1,a2,\xe2\x80\xa6,an and with an empty array b. We apply the following operation k times.On the i-th iteration, we select an index ti (1\xe2\x89\xa4ti\xe2\x89\xa4n\xe2\x88\x92i+1), remove ati from the array, and append one of the numbers ati\xe2\x88\x921 or ati+1 (if ti\xe2\x88\x921 or ti+1 are within the array bounds) to the right end of the array b. Then we move elements ati+1,\xe2\x80\xa6,an to the left in order to fill in the empty space.You are given the initial permutation a1,a2,\xe2\x80\xa6,an and the resulting array b1,b2,\xe2\x80\xa6,bk. All elements of an array b are distinct. Calculate the number of possible sequences of indices t1,t2,\xe2\x80\xa6,tk modulo 998244353." 1800
1442A "Extreme Subtraction" "constructive algorithms,dp,greedy" "You are given an array a of n positive integers.You can use the following operation as many times as you like: select any integer 1\xe2\x89\xa4k\xe2\x89\xa4n and do one of two things:   decrement by one k of the first elements of the array.  decrement by one k of the last elements of the array. For example, if n=5 and a=[3,2,2,1,4], then you can apply one of the following operations to it (not all possible options are listed below):   decrement from the first two elements of the array. After this operation a=[2,1,2,1,4];  decrement from the last three elements of the array. After this operation a=[3,2,1,0,3];  decrement from the first five elements of the array. After this operation a=[2,1,1,0,3]; Determine if it is possible to make all the elements of the array equal to zero by applying a certain number of operations." 1800
1440B "Sum of Medians" greedy,math "A median of an array of integers of length n is the number standing on the \xe2\x8c\x88n2\xe2\x8c\x89 (rounding up) position in the non-decreasing ordering of its elements. Positions are numbered starting with 1. For example, a median of the array [2,6,4,1,3,5] is equal to 3. There exist some other definitions of the median, but in this problem, we will use the described one.Given two integers n and k and non-decreasing array of nk integers. Divide all numbers into k arrays of size n, such that each number belongs to exactly one array.You want the sum of medians of all k arrays to be the maximum possible. Find this maximum possible sum." 900
1440A "Buy the String" implementation,math "You are given four integers n, c0, c1 and h and a binary string s of length n.A binary string is a string consisting of characters 0 and 1.You can change any character of the string s (the string should be still binary after the change). You should pay h coins for each change.After some changes (possibly zero) you want to buy the string. To buy the string you should buy all its characters. To buy the character 0 you should pay c0 coins, to buy the character 1 you should pay c1 coins.Find the minimum number of coins needed to buy the string." 800
1439E "Cheat and Win" "bitmasks,data structures,games,trees" "Let\'s consider a (109+1)\xc3\x97(109+1) field. The rows are numbered with integers from 0 to 109 and the columns are numbered with integers from 0 to 109. Let\'s define as (x,y) the cell located in the x-th row and y-th column.Let\'s call a cell (x,y) good if x&y=0, there & is the bitwise and operation.Let\'s build a graph where vertices will be all good cells of the field and we will make an edge between all pairs of adjacent by side good cells. It can be proved that this graph will be a tree \xe2\x80\x94 connected graph without cycles. Let\'s hang this tree on vertex (0,0), so we will have a rooted tree with root (0,0).Two players will play the game. Initially, some good cells are black and others are white. Each player on his turn chooses a black good cell and a subset of its ancestors (possibly empty) and inverts their colors (from white to black and vice versa). The player who can\'t move (because all good cells are white) loses. It can be proved that the game is always finite.Initially, all cells are white. You are given m pairs of cells. For each pair color all cells in a simple path between them as black. Note that we do not invert their colors, we paint them black.Sohrab and Mashtali are going to play this game. Sohrab is the first player and Mashtali is the second.Mashtali wants to win and decided to cheat. He can make the following operation multiple times before the game starts: choose a cell and invert colors of all vertices on the path between it and the root of the tree.Mammad who was watching them wondered: ""what is the minimum number of operations Mashtali should do to have a winning strategy?"".Find the answer to this question for the initial painting of the tree. It can be proved that at least one possible way to cheat always exists." 3500
1439D "INOI Final Contests" combinatorics,dp,fft "Today is the final contest of INOI (Iranian National Olympiad in Informatics). The contest room is a row with n computers. All computers are numbered with integers from 1 to n from left to right. There are m participants, numbered with integers from 1 to m.We have an array a of length m where ai (1\xe2\x89\xa4ai\xe2\x89\xa4n) is the computer behind which the i-th participant wants to sit.Also, we have another array b of length m consisting of characters \'L\' and \'R\'. bi is the side from which the i-th participant enters the room. \'L\' means the participant enters from the left of computer 1 and goes from left to right, and \'R\' means the participant enters from the right of computer n and goes from right to left.The participants in the order from 1 to m enter the room one by one. The i-th of them enters the contest room in the direction bi and goes to sit behind the ai-th computer. If it is occupied he keeps walking in his direction until he reaches the first unoccupied computer. After that, he sits behind it. If he doesn\'t find any computer he gets upset and gives up on the contest.The madness of the i-th participant is the distance between his assigned computer (ai) and the computer he ends up sitting behind. The distance between computers i and j is equal to |i\xe2\x88\x92j|.The values in the array a can be equal. There exist nm\xe2\x8b\x852m possible pairs of arrays (a,b).Consider all pairs of arrays (a,b) such that no person becomes upset. For each of them let\'s calculate the sum of participants madnesses. Find the sum of all these values.You will be given some prime modulo p. Find this sum by modulo p." 3100
1439C "Greedy Shopping" "binary search,data structures,divide and conquer,greedy,implementation" "You are given an array a1,a2,\xe2\x80\xa6,an of integers. This array is non-increasing.Let\'s consider a line with n shops. The shops are numbered with integers from 1 to n from left to right. The cost of a meal in the i-th shop is equal to ai.You should process q queries of two types:  1 x y: for each shop 1\xe2\x89\xa4i\xe2\x89\xa4x set ai=max(ai,y).  2 x y: let\'s consider a hungry man with y money. He visits the shops from x-th shop to n-th and if he can buy a meal in the current shop he buys one item of it. Find how many meals he will purchase. The man can buy a meal in the shop i if he has at least ai money, and after it his money decreases by ai." 2600
1439B "Graph Subset Problem" "constructive algorithms,data structures,graphs" "You are given an undirected graph with n vertices and m edges. Also, you are given an integer k.Find either a clique of size k or a non-empty subset of vertices such that each vertex of this subset has at least k neighbors in the subset. If there are no such cliques and subsets report about it.A subset of vertices is called a clique of size k if its size is k and there exists an edge between every two vertices from the subset. A vertex is called a neighbor of the other vertex if there exists an edge between them." 2600
1439A2 "Binary Table (Hard Version)" "constructive algorithms,graphs,greedy,implementation" "This is the hard version of the problem. The difference between the versions is in the number of possible operations that can be made. You can make hacks if and only if you solved both versions of the problem.You are given a binary table of size n\xc3\x97m. This table consists of symbols 0 and 1.You can make such operation: select 3 different cells that belong to one 2\xc3\x972 square and change the symbols in these cells (change 0 to 1 and 1 to 0).Your task is to make all symbols in the table equal to 0. You are allowed to make at most nm operations. You don\'t need to minimize the number of operations.It can be proved, that it is always possible." 1900
1439A1 "Binary Table (Easy Version)" "constructive algorithms,implementation" "This is the easy version of the problem. The difference between the versions is in the number of possible operations that can be made. You can make hacks if and only if you solved both versions of the problem.You are given a binary table of size n\xc3\x97m. This table consists of symbols 0 and 1.You can make such operation: select 3 different cells that belong to one 2\xc3\x972 square and change the symbols in these cells (change 0 to 1 and 1 to 0).Your task is to make all symbols in the table equal to 0. You are allowed to make at most 3nm operations. You don\'t need to minimize the number of operations.It can be proved that it is always possible." 1500
1438F "Olha and Igor" interactive,probabilities,trees "This is an interactive problem.Igor wants to find the key to Olha\'s heart. The problem is, that it\'s at the root of a binary tree.There is a perfect binary tree of height h consisting of n=2h\xe2\x88\x921 nodes. The nodes have been assigned distinct labels from 1 to n. However, Igor only knows h and does not know which label corresponds to which node. To find key to Olha\'s heart he needs to find the label assigned to the root by making queries of the following type at most n+420 times:   Select three distinct labels u, v and w (1\xe2\x89\xa4u,v,w\xe2\x89\xa4n).  In response, Olha (the grader) will tell him the label of the lowest common ancestor of nodes labelled u and v, if the tree was rooted at the node labelled w instead. Help Igor to find the root!Note: the grader is not adaptive: the labels are fixed before any queries are made." 3000
1438E "Yurii Can Do Everything" "binary search,bitmasks,brute force,constructive algorithms,divide and conquer,two pointers" "Yurii is sure he can do everything. Can he solve this task, though?He has an array a consisting of n positive integers. Let\'s call a subarray a[l...r] good if the following conditions are simultaneously satisfied:   l+1\xe2\x89\xa4r\xe2\x88\x921, i. e. the subarray has length at least 3;  (al\xe2\x8a\x95ar)=(al+1+al+2+\xe2\x80\xa6+ar\xe2\x88\x922+ar\xe2\x88\x921), where \xe2\x8a\x95 denotes the bitwise XOR operation. In other words, a subarray is good if the bitwise XOR of the two border elements is equal to the sum of the rest of the elements. Yurii wants to calculate the total number of good subarrays. What is it equal to?An array c is a subarray of an array d if c can be obtained from d by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 2500
1438D "Powerful Ksenia" "bitmasks,constructive algorithms,math" "Ksenia has an array a consisting of n positive integers a1,a2,\xe2\x80\xa6,an. In one operation she can do the following:   choose three distinct indices i, j, k, and then  change all of ai,aj,ak to ai\xe2\x8a\x95aj\xe2\x8a\x95ak simultaneously, where \xe2\x8a\x95 denotes the bitwise XOR operation. She wants to make all ai equal in at most n operations, or to determine that it is impossible to do so. She wouldn\'t ask for your help, but please, help her!" 2200
1438C "Engineer Artem" "2-sat,chinese remainder theorem,constructive algorithms,fft,flows" "Artem is building a new robot. He has a matrix a consisting of n rows and m columns. The cell located on the i-th row from the top and the j-th column from the left has a value ai,j written in it. If two adjacent cells contain the same value, the robot will break. A matrix is called good if no two adjacent cells contain the same value, where two cells are called adjacent if they share a side. Artem wants to increment the values in some cells by one to make a good.More formally, find a good matrix b that satisfies the following condition \xe2\x80\x94   For all valid (i,j), either bi,j=ai,j or bi,j=ai,j+1. For the constraints of this problem, it can be shown that such a matrix b always exists. If there are several such tables, you can output any of them. Please note that you do not have to minimize the number of increments." 2000
1438B "Valerii Against Everyone" "constructive algorithms,data structures,greedy,sortings" "You\'re given an array b of length n. Let\'s define another array a, also of length n, for which ai=2bi (1\xe2\x89\xa4i\xe2\x89\xa4n). Valerii says that every two non-intersecting subarrays of a have different sums of elements. You want to determine if he is wrong. More formally, you need to determine if there exist four integers l1,r1,l2,r2 that satisfy the following conditions:   1\xe2\x89\xa4l1\xe2\x89\xa4r1<l2\xe2\x89\xa4r2\xe2\x89\xa4n;  al1+al1+1+\xe2\x80\xa6+ar1\xe2\x88\x921+ar1=al2+al2+1+\xe2\x80\xa6+ar2\xe2\x88\x921+ar2. If such four integers exist, you will prove Valerii wrong. Do they exist?An array c is a subarray of an array d if c can be obtained from d by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 1000
1438A "Specific Tastes of Andre" "constructive algorithms,implementation" "Andre has very specific tastes. Recently he started falling in love with arrays.Andre calls an nonempty array b good, if sum of its elements is divisible by the length of this array. For example, array [2,3,1] is good, as sum of its elements \xe2\x80\x94 6 \xe2\x80\x94 is divisible by 3, but array [1,1,2,3] isn\'t good, as 7 isn\'t divisible by 4. Andre calls an array a of length n perfect if the following conditions hold:   Every nonempty subarray of this array is good.  For every i (1\xe2\x89\xa4i\xe2\x89\xa4n), 1\xe2\x89\xa4ai\xe2\x89\xa4100. Given a positive integer n, output any perfect array of length n. We can show that for the given constraints such an array always exists.An array c is a subarray of an array d if c can be obtained from d by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 800
1437G "Death DBMS" "data structures,string suffix structures,strings,trees" "For the simplicity, let\'s say that the ""Death Note"" is a notebook that kills a person when their name is written in it.It\'s easy to kill with it, but it\'s pretty hard to keep track of people you haven\'t killed and still plan to. You decided to make a ""Death Database Management System"" \xe2\x80\x94 a computer program that provides the easy access to the database of possible victims. Let me describe its specifications to you.Let\'s define a victim entity: a victim has a name (not necessarily unique) that consists only of lowercase Latin letters and an integer suspicion value.At the start of the program the user enters a list of n victim names into a database, each suspicion value is set to 0.Then the user makes queries of two types:   1 i x \xe2\x80\x94 set the suspicion value of the i-th victim to x;  2 q \xe2\x80\x94 given a string q find the maximum suspicion value of a victim whose name is a contiguous substring of q. Just to remind you, this program doesn\'t kill people, it only helps to search for the names to write down in an actual notebook. Thus, the list of the victims in the database doesn\'t change throughout the queries.What are you waiting for? Write that program now!" 2600
1437F "Emotional Fishermen" "combinatorics,dp,math,two pointers" "n fishermen have just returned from a fishing vacation. The i-th fisherman has caught a fish of weight ai.Fishermen are going to show off the fish they caught to each other. To do so, they firstly choose an order in which they show their fish (each fisherman shows his fish exactly once, so, formally, the order of showing fish is a permutation of integers from 1 to n). Then they show the fish they caught according to the chosen order. When a fisherman shows his fish, he might either become happy, become sad, or stay content.Suppose a fisherman shows a fish of weight x, and the maximum weight of a previously shown fish is y (y=0 if that fisherman is the first to show his fish). Then:  if x\xe2\x89\xa52y, the fisherman becomes happy;  if 2x\xe2\x89\xa4y, the fisherman becomes sad;  if none of these two conditions is met, the fisherman stays content. Let\'s call an order in which the fishermen show their fish emotional if, after all fishermen show their fish according to this order, each fisherman becomes either happy or sad. Calculate the number of emotional orders modulo 998244353." 2600
1437E "Make It Increasing" "binary search,constructive algorithms,data structures,dp,implementation" "You are given an array of n integers a1, a2, ..., an, and a set b of k distinct integers from 1 to n.In one operation, you may choose two integers i and x (1\xe2\x89\xa4i\xe2\x89\xa4n, x can be any integer) and assign ai:=x. This operation can be done only if i does not belong to the set b.Calculate the minimum number of operations you should perform so the array a is increasing (that is, a1<a2<a3<\xe2\x8b\xaf<an), or report that it is impossible." 2200
1437D "Minimal Height Tree" "graphs,greedy,shortest paths,trees" "Monocarp had a tree which consisted of n vertices and was rooted at vertex 1. He decided to study BFS (Breadth-first search), so he ran BFS on his tree, starting from the root. BFS can be described by the following pseudocode:a = [] # the order in which vertices were processedq = Queue()q.put(1) # place the root at the end of the queuewhile not q.empty():    k = q.pop() # retrieve the first vertex from the queue    a.append(k) # append k to the end of the sequence in which vertices were visited    for y in g[k]: # g[k] is the list of all children of vertex k, sorted in ascending order        q.put(y)Monocarp was fascinated by BFS so much that, in the end, he lost his tree. Fortunately, he still has a sequence of vertices, in which order vertices were visited by the BFS algorithm (the array a from the pseudocode). Monocarp knows that each vertex was visited exactly once (since they were put and taken from the queue exactly once). Also, he knows that all children of each vertex were viewed in ascending order.Monocarp knows that there are many trees (in the general case) with the same visiting order a, so he doesn\'t hope to restore his tree. Monocarp is okay with any tree that has minimum height.The height of a tree is the maximum depth of the tree\'s vertices, and the depth of a vertex is the number of edges in the path from the root to it. For example, the depth of vertex 1 is 0, since it\'s the root, and the depth of all root\'s children are 1.Help Monocarp to find any tree with given visiting order a and minimum height." 1600
1437C "Chef Monocarp" "dp,flows,graph matchings,greedy,math,sortings" "Chef Monocarp has just put n dishes into an oven. He knows that the i-th dish has its optimal cooking time equal to ti minutes.At any positive integer minute T Monocarp can put no more than one dish out of the oven. If the i-th dish is put out at some minute T, then its unpleasant value is |T\xe2\x88\x92ti| \xe2\x80\x94 the absolute difference between T and ti. Once the dish is out of the oven, it can\'t go back in.Monocarp should put all the dishes out of the oven. What is the minimum total unpleasant value Monocarp can obtain?" 1800
1437B "Reverse Binary Strings" "constructive algorithms,greedy" "You are given a string s of even length n. String s is binary, in other words, consists only of 0\'s and 1\'s.String s has exactly n2 zeroes and n2 ones (n is even).In one operation you can reverse any substring of s. A substring of a string is a contiguous subsequence of that string.What is the minimum number of operations you need to make string s alternating? A string is alternating if si\xe2\x89\xa0si+1 for all i. There are two types of alternating strings in general: 01010101... or 10101010..." 1200
1437A "Marketing Scheme" "brute force,constructive algorithms,greedy,math" "You got a job as a marketer in a pet shop, and your current task is to boost sales of cat food. One of the strategies is to sell cans of food in packs with discounts. Suppose you decided to sell packs with a cans in a pack with a discount and some customer wants to buy x cans of cat food. Then he follows a greedy strategy:   he buys \xe2\x8c\x8axa\xe2\x8c\x8b packs with a discount;  then he wants to buy the remaining (xmoda) cans one by one. \xe2\x8c\x8axa\xe2\x8c\x8b is x divided by a rounded down, xmoda is the remainer of x divided by a.But customers are greedy in general, so if the customer wants to buy (xmoda) cans one by one and it happens that (xmoda)\xe2\x89\xa5a2 he decides to buy the whole pack of a cans (instead of buying (xmoda) cans). It makes you, as a marketer, happy since the customer bought more than he wanted initially.You know that each of the customers that come to your shop can buy any number of cans from l to r inclusive. Can you choose such size of pack a that each customer buys more cans than they wanted initially?" 800
1436F "Sum Over Subsets" "combinatorics,math,number theory" "You are given a multiset S. Over all pairs of subsets A and B, such that:  B\xe2\x8a\x82A;  |B|=|A|\xe2\x88\x921;  greatest common divisor of all elements in A is equal to one; find the sum of \xe2\x88\x91x\xe2\x88\x88Ax\xe2\x8b\x85\xe2\x88\x91x\xe2\x88\x88Bx, modulo 998244353." 2800
1436E "Complicated Computations" "binary search,data structures,two pointers" "In this problem MEX of a certain array is the smallest positive integer not contained in this array.Everyone knows this definition, including Lesha. But Lesha loves MEX, so he comes up with a new problem involving MEX every day, including today.You are given an array a of length n. Lesha considers all the non-empty subarrays of the initial array and computes MEX for each of them. Then Lesha computes MEX of the obtained numbers.An array b is a subarray of an array a, if b can be obtained from a by deletion of several (possible none or all) elements from the beginning and several (possibly none or all) elements from the end. In particular, an array is a subarray of itself.Lesha understands that the problem is very interesting this time, but he doesn\'t know how to solve it. Help him and find the MEX of MEXes of all the subarrays!" 2400
1436D "Bandit in a City" "binary search,dfs and similar,graphs,greedy,trees" "Bandits appeared in the city! One of them is trying to catch as many citizens as he can.The city consists of n squares connected by n\xe2\x88\x921 roads in such a way that it is possible to reach any square from any other square. The square number 1 is the main square.After Sunday walk all the roads were changed to one-way roads in such a way that it is possible to reach any square from the main square.At the moment when the bandit appeared on the main square there were ai citizens on the i-th square. Now the following process will begin. First, each citizen that is currently on a square with some outgoing one-way roads chooses one of such roads and moves along it to another square. Then the bandit chooses one of the one-way roads outgoing from the square he is located and moves along it. The process is repeated until the bandit is located on a square with no outgoing roads. The bandit catches all the citizens on that square.The bandit wants to catch as many citizens as possible; the citizens want to minimize the number of caught people. The bandit and the citizens know positions of all citizens at any time, the citizens can cooperate. If both sides act optimally, how many citizens will be caught?" 1900
1436C "Binary Search" "binary search,combinatorics" "Andrey thinks he is truly a successful developer, but in reality he didn\'t know about the binary search algorithm until recently. After reading some literature Andrey understood that this algorithm allows to quickly find a certain number x in an array. For an array a indexed from zero, and an integer x the pseudocode of the algorithm is as follows:  Note that the elements of the array are indexed from zero, and the division is done in integers (rounding down).Andrey read that the algorithm only works if the array is sorted. However, he found this statement untrue, because there certainly exist unsorted arrays for which the algorithm find x!Andrey wants to write a letter to the book authors, but before doing that he must consider the permutations of size n such that the algorithm finds x in them. A permutation of size n is an array consisting of n distinct integers between 1 and n in arbitrary order.Help Andrey and find the number of permutations of size n which contain x at position pos and for which the given implementation of the binary search algorithm finds x (returns true). As the result may be extremely large, print the remainder of its division by 109+7." 1500
1436B "Prime Square" "constructive algorithms,math" "Sasha likes investigating different math objects, for example, magic squares. But Sasha understands that magic squares have already been studied by hundreds of people, so he sees no sense of studying them further. Instead, he invented his own type of square \xe2\x80\x94 a prime square. A square of size n\xc3\x97n is called prime if the following three conditions are held simultaneously:   all numbers on the square are non-negative integers not exceeding 105;  there are no prime numbers in the square;  sums of integers in each row and each column are prime numbers. Sasha has an integer n. He asks you to find any prime square of size n\xc3\x97n. Sasha is absolutely sure such squares exist, so just help him!" 900
1436A Reorder math "For a given array a consisting of n integers and a given integer m find if it is possible to reorder elements of the array a in such a way that \xe2\x88\x91ni=1\xe2\x88\x91nj=iajj equals m? It is forbidden to delete elements as well as insert new elements. Please note that no rounding occurs during division, for example, 52=2.5." 800
1434E "A Convex Game" dsu,games "Shikamaru and Asuma like to play different games, and sometimes they play the following: given an increasing list of numbers, they take turns to move. Each move consists of picking a number from the list.Assume the picked numbers are vi1, vi2, \xe2\x80\xa6, vik. The following conditions must hold:  ij<ij+1 for all 1\xe2\x89\xa4j\xe2\x89\xa4k\xe2\x88\x921;  vij+1\xe2\x88\x92vij<vij+2\xe2\x88\x92vij+1 for all 1\xe2\x89\xa4j\xe2\x89\xa4k\xe2\x88\x922. However, it\'s easy to play only one instance of game, so today Shikamaru and Asuma decided to play n simultaneous games. They agreed on taking turns as for just one game, Shikamaru goes first. At each turn, the player performs a valid move in any single game. The player who cannot move loses. Find out who wins, provided that both play optimally." 3500
1433G "Reducing Delivery Cost" "brute force,graphs,shortest paths" "You are a mayor of Berlyatov. There are n districts and m two-way roads between them. The i-th road connects districts xi and yi. The cost of travelling along this road is wi. There is some path between each pair of districts, so the city is connected.There are k delivery routes in Berlyatov. The i-th route is going from the district ai to the district bi. There is one courier on each route and the courier will always choose the cheapest (minimum by total cost) path from the district ai to the district bi to deliver products.The route can go from the district to itself, some couriers routes can coincide (and you have to count them independently).You can make at most one road to have cost zero (i.e. you choose at most one road and change its cost with 0).Let d(x,y) be the cheapest cost of travel between districts x and y.Your task is to find the minimum total courier routes cost you can achieve, if you optimally select the some road and change its cost with 0. In other words, you have to find the minimum possible value of k\xe2\x88\x91i=1d(ai,bi) after applying the operation described above optimally." 2100
1433F "Zero Remainder Sum" dp "You are given a matrix a of size n\xc3\x97m consisting of integers.You can choose no more than \xe2\x8c\x8am2\xe2\x8c\x8b elements in each row. Your task is to choose these elements in such a way that their sum is divisible by k and this sum is the maximum.In other words, you can choose no more than a half (rounded down) of elements in each row, you have to find the maximum sum of these elements divisible by k.Note that you can choose zero elements (and the sum of such set is 0)." 2100
1433E "Two Round Dances" combinatorics,math "One day, n people (n is an even number) met on a plaza and made two round dances, each round dance consists of exactly n2 people. Your task is to find the number of ways n people can make two round dances if each round dance consists of exactly n2 people. Each person should belong to exactly one of these two round dances.Round dance is a dance circle consisting of 1 or more people. Two round dances are indistinguishable (equal) if one can be transformed to another by choosing the first participant. For example, round dances [1,3,4,2], [4,2,1,3] and [2,1,3,4] are indistinguishable.For example, if n=2 then the number of ways is 1: one round dance consists of the first person and the second one of the second person.For example, if n=4 then the number of ways is 3. Possible options:  one round dance \xe2\x80\x94 [1,2], another \xe2\x80\x94 [3,4];  one round dance \xe2\x80\x94 [2,4], another \xe2\x80\x94 [3,1];  one round dance \xe2\x80\x94 [4,1], another \xe2\x80\x94 [3,2]. Your task is to find the number of ways n people can make two round dances if each round dance consists of exactly n2 people." 1300
1433D "Districts Connection" "constructive algorithms,dfs and similar" "There are n districts in the town, the i-th district belongs to the ai-th bandit gang. Initially, no districts are connected to each other.You are the mayor of the city and want to build n\xe2\x88\x921 two-way roads to connect all districts (two districts can be connected directly or through other connected districts).If two districts belonging to the same gang are connected directly with a road, this gang will revolt.You don\'t want this so your task is to build n\xe2\x88\x921 two-way roads in such a way that all districts are reachable from each other (possibly, using intermediate districts) and each pair of directly connected districts belong to different gangs, or determine that it is impossible to build n\xe2\x88\x921 roads to satisfy all the conditions.You have to answer t independent test cases." 1200
1433C "Dominant Piranha" "constructive algorithms,greedy" "There are n piranhas with sizes a1,a2,\xe2\x80\xa6,an in the aquarium. Piranhas are numbered from left to right in order they live in the aquarium.Scientists of the Berland State University want to find if there is dominant piranha in the aquarium. The piranha is called dominant if it can eat all the other piranhas in the aquarium (except itself, of course). Other piranhas will do nothing while the dominant piranha will eat them.Because the aquarium is pretty narrow and long, the piranha can eat only one of the adjacent piranhas during one move. Piranha can do as many moves as it needs (or as it can). More precisely:   The piranha i can eat the piranha i\xe2\x88\x921 if the piranha i\xe2\x88\x921 exists and ai\xe2\x88\x921<ai.  The piranha i can eat the piranha i+1 if the piranha i+1 exists and ai+1<ai. When the piranha i eats some piranha, its size increases by one (ai becomes ai+1).Your task is to find any dominant piranha in the aquarium or determine if there are no such piranhas.Note that you have to find any (exactly one) dominant piranha, you don\'t have to find all of them.For example, if a=[5,3,4,4,5], then the third piranha can be dominant. Consider the sequence of its moves:   The piranha eats the second piranha and a becomes [5,5_,4,5] (the underlined piranha is our candidate).  The piranha eats the third piranha and a becomes [5,6_,5].  The piranha eats the first piranha and a becomes [7_,5].  The piranha eats the second piranha and a becomes [8_]. You have to answer t independent test cases." 900
1433B "Yet Another Bookshelf" greedy,implementation "There is a bookshelf which can fit n books. The i-th position of bookshelf is ai=1 if there is a book on this position and ai=0 otherwise. It is guaranteed that there is at least one book on the bookshelf.In one move, you can choose some contiguous segment [l;r] consisting of books (i.e. for each i from l to r the condition ai=1 holds) and:  Shift it to the right by 1: move the book at index i to i+1 for all l\xe2\x89\xa4i\xe2\x89\xa4r. This move can be done only if r+1\xe2\x89\xa4n and there is no book at the position r+1.  Shift it to the left by 1: move the book at index i to i\xe2\x88\x921 for all l\xe2\x89\xa4i\xe2\x89\xa4r. This move can be done only if l\xe2\x88\x921\xe2\x89\xa51 and there is no book at the position l\xe2\x88\x921. Your task is to find the minimum number of moves required to collect all the books on the shelf as a contiguous (consecutive) segment (i.e. the segment without any gaps).For example, for a=[0,0,1,0,1] there is a gap between books (a4=0 when a3=1 and a5=1), for a=[1,1,0] there are no gaps between books and for a=[0,0,0] there are also no gaps between books.You have to answer t independent test cases." 800
1433A "Boring Apartments" implementation,math "There is a building consisting of 10 000 apartments numbered from 1 to 10 000, inclusive.Call an apartment boring, if its number consists of the same digit. Examples of boring apartments are 11,2,777,9999 and so on.Our character is a troublemaker, and he calls the intercoms of all boring apartments, till someone answers the call, in the following order:  First he calls all apartments consisting of digit 1, in increasing order (1,11,111,1111).  Next he calls all apartments consisting of digit 2, in increasing order (2,22,222,2222)  And so on. The resident of the boring apartment x answers the call, and our character stops calling anyone further.Our character wants to know how many digits he pressed in total and your task is to help him to count the total number of keypresses.For example, if the resident of boring apartment 22 answered, then our character called apartments with numbers 1,11,111,1111,2,22 and the total number of digits he pressed is 1+2+3+4+1+2=13.You have to answer t independent test cases." 800
1431J "Zero-XOR Array" "*special problem,dp" "You are given an array of integers a of size n. This array is non-decreasing, i.\xe2\x80\x89e. a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4an.You have to find arrays of integers b of size 2n\xe2\x88\x921, such that:  b2i\xe2\x88\x921=ai (1\xe2\x89\xa4i\xe2\x89\xa4n);  array b is non-decreasing;  b1\xe2\x8a\x95b2\xe2\x8a\x95\xe2\x8b\xaf\xe2\x8a\x95b2n\xe2\x88\x921=0 (\xe2\x8a\x95 denotes bitwise XOR operation: https://en.wikipedia.org/wiki/Exclusive_or. In Kotlin, it is xor function). Calculate the number of arrays that meet all the above conditions, modulo 998244353." 3400
1431I "Cyclic Shifts" "*special problem,strings" "You are given a matrix consisting of n rows and m columns. The matrix contains lowercase letters of the Latin alphabet.You can perform the following operation any number of times you want to: choose two integers i (1\xe2\x89\xa4i\xe2\x89\xa4m) and k (0<k<n), and shift every column j such that i\xe2\x89\xa4j\xe2\x89\xa4m cyclically by k. The shift is performed upwards.For example, if you have a matrix  (abcdefghi)  and perform an operation with i=2, k=1, then it becomes:  (aefdhigbc) You have to process q queries. Each of the queries is a string of length m consisting of lowercase letters of the Latin alphabet. For each query, you have to calculate the minimum number of operations described above you have to perform so that at least one row of the matrix is equal to the string from the query. Note that all queries are independent, that is, the operations you perform in a query don\'t affect the initial matrix in other queries." 2900
1431H "Rogue-like Game" "*special problem,brute force,greedy,two pointers" "Marina plays a new rogue-like game. In this game, there are n different character species and m different classes. The game is played in runs; for each run, Marina has to select a species and a class for her character. If she selects the i-th species and the j-th class, she will get ci,j points for this run.Initially, some species and classes are unlocked, all others are locked. To unlock the i-th species, Marina has to get at least ai points in total for previous runs \xe2\x80\x94 that is, as soon as her total score for played runs is at least ai, this species is unlocked. Similarly, to unlock the j-th class, she has to get at least bj points in total for previous runs. If ai=0 for some i, then this species is unlocked initially (the same applies to classes with bj=0).Marina wants to unlock all species and classes in the minimum number of runs. Before playing the game, she can read exactly one guide on some combination of species and class, and reading a guide will increase the score she gets for all runs with that combination by k (formally, before playing the game, she can increase exactly one value of ci,j by k).What is the minimum number of runs she has to play to unlock all species and classes if she chooses the combination to read a guide on optimally?" 2600
1431G "Number Deletion Game" "*special problem,dp,games,greedy" "Alice and Bob play a game. They have a set that initially consists of n integers. The game is played in k turns. During each turn, the following events happen:  firstly, Alice chooses an integer from the set. She can choose any integer except for the maximum one. Let the integer chosen by Alice be a;  secondly, Bob chooses an integer from the set. He can choose any integer that is greater than a. Let the integer chosen by Bob be b;  finally, both a and b are erased from the set, and the value of b\xe2\x88\x92a is added to the score of the game. Initially, the score is 0. Alice wants to maximize the resulting score, Bob wants to minimize it. Assuming that both Alice and Bob play optimally, calculate the resulting score of the game." 2100
1431F "Neural Network Problem" "*special problem,binary search,greedy" "You want to train a neural network model for your graduation work. There are n images in the dataset, the i-th image\'s size is ai bytes.You don\'t have any powerful remote servers to train this model so you have to do it on your local machine. But there is a problem: the total size of the dataset is too big for your machine, so you decided to remove some images \xe2\x80\x94 though you don\'t want to make the dataset too weak so you can remove no more than k images from it. Note that you can only remove images, you can\'t change their order.You want to remove these images optimally so you came up with a metric (you\'re a data scientist after all) that allows to measure the result of removals. Consider the array b1,b2,\xe2\x80\xa6,bm after removing at most k images (n\xe2\x88\x92k\xe2\x89\xa4m\xe2\x89\xa4n). The data from this array will be uploaded to the machine in blocks of x consecutive elements each. More precisely:  elements with indices from 1 to x (b1,b2,\xe2\x80\xa6,bx) belong to the first block;  elements with indices from x+1 to 2x (bx+1,bx+2,\xe2\x80\xa6,b2x) belong to the second block;  elements with indices from 2x+1 to 3x (b2x+1,b2x+2,\xe2\x80\xa6,b3x) belong to the third block;  and so on. There will be cnt=\xe2\x8c\x88mx\xe2\x8c\x89 blocks in total. Note that if m is not divisible by x then the last block contains less than x elements, and it\'s okay.Let w(i) be the total size of the i-th block \xe2\x80\x94 that is, the sum of sizes of images inside this block. For example, the size of the first block w(1) is b1+b2+\xe2\x80\xa6+bx, the size of the second block w(2) is bx+1+bx+2+\xe2\x80\xa6+b2x.The value of the metric you came up with is the maximum block size over the blocks of the resulting dataset. In other words, the value of the metric is cntmaxi=1w(i).You don\'t want to overload your machine too much, so you have to remove at most k images in a way that minimizes the value of the metric described above." 2100
1431E "Chess Match" "*special problem" "The final of Berland Chess Team Championship is going to be held soon. Two teams consisting of n chess players each will compete for first place in the tournament. The skill of the i-th player in the first team is ai, and the skill of the i-th player in the second team is bi. The match will be held as follows: each player of the first team will play a game against one player from the second team in such a way that every player has exactly one opponent. Formally, if the player i from the first team opposes the player pi from the second team, then [p1,p2,\xe2\x80\xa6,pn] is a permutation (a sequence where each integer from 1 to n appears exactly once).Whenever two players of almost equal skill play a game, it will likely result in a tie. Chess fans don\'t like ties, so the organizers of the match should distribute the players in such a way that ties are unlikely.Let the unfairness of the match be the following value: nmini=1|ai\xe2\x88\x92bpi|. Your task is to assign each player from the first team an opponent from the second team so that the unfairness is maximum possible (the greater it is, the smaller the probability of ties is, that\'s why you should maximize it)." 2000
1431D "Used Markers" "*special problem,greedy" "Your University has a large auditorium and today you are on duty there. There will be n lectures today \xe2\x80\x94 all from different lecturers, and your current task is to choose in which order ord they will happen.Each lecturer will use one marker to write something on a board during their lecture. Unfortunately, markers become worse the more you use them and lecturers may decline using markers which became too bad in their opinion.Formally, the i-th lecturer has their acceptance value ai which means they will not use the marker that was used at least in ai lectures already and will ask for a replacement. More specifically:   before the first lecture you place a new marker in the auditorium;  before the ordj-th lecturer (in the order you\'ve chosen) starts, they check the quality of the marker and if it was used in at least aordj lectures before, they will ask you for a new marker;  if you were asked for a new marker, then you throw away the old one, place a new one in the auditorium, and the lecturer gives a lecture. You know: the better the marker \xe2\x80\x94 the easier for an audience to understand what a lecturer has written, so you want to maximize the number of used markers. Unfortunately, the higher-ups watch closely how many markers were spent, so you can\'t just replace markers before each lecture. So, you have to replace markers only when you are asked by a lecturer. The marker is considered used if at least one lecturer used it for their lecture.You can choose the order ord in which lecturers will give lectures. Find such order that leads to the maximum possible number of the used markers." 1500
1431C "Black Friday" "*special problem,implementation" "There is a local shop in your area getting prepared for the great holiday of Black Friday. There are n items with prices p1,p2,\xe2\x80\xa6,pn on the display. They are ordered by price, so p1\xe2\x89\xa4p2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4pn.The shop has a prechosen discount value k. The Black Friday discount is applied in the following way: for a single purchase of x items, you get the cheapest \xe2\x8c\x8axk\xe2\x8c\x8b items of them for free (\xe2\x8c\x8axk\xe2\x8c\x8b is x divided by k rounded down to the nearest integer). You can include each item in your purchase no more than once.For example, if there are items with prices [1,1,2,2,2,3,4,5,6] in the shop, and you buy items with prices [1,2,2,4,5], and k=2, then you get the cheapest \xe2\x8c\x8a52\xe2\x8c\x8b=2 for free. They are items with prices 1 and 2.So you, being the naive customer, don\'t care about how much money you spend. However, you want the total price of the items you get for free to be as large as possible.What is the maximum total price of the items you can get for free on a single purchase?" 1600
1431B "Polycarp and the Language of Gods" "*special problem,implementation,two pointers" "Polycarp has just finished writing down the lecture on elvish languages. The language this week was ""VwV"" (pronounced as ""uwu""). The writing system of this language consists of only two lowercase Latin letters: \'v\' and \'w\'.Unfortunately, Polycarp has written all the lecture in cursive and without any spaces, so the notes look like a neverending sequence of squiggles. To be exact, Polycarp can\'t tell \'w\' apart from \'vv\' in his notes as both of them consist of the same two squiggles.Luckily, his brother Monocarp has better writing habits, so Polycarp managed to take his notes and now wants to make his own notes more readable. To do that he can follow the notes of Monocarp and underline some letters in his own notes in such a way that there is no more ambiguity. If he underlines a \'v\', then it can\'t be mistaken for a part of some \'w\', and if the underlines a \'w\', then it can\'t be mistaken for two adjacent letters \'v\'.What is the minimum number of letters Polycarp should underline to make his notes unambiguous?" 1400
1431A "Selling Hamburgers" "*special problem" "There are n customers in the cafeteria. Each of them wants to buy a hamburger. The i-th customer has ai coins, and they will buy a hamburger if it costs at most ai coins.Suppose the cost of the hamburger is m. Then the number of coins the cafeteria earns is m multiplied by the number of people who buy a hamburger if it costs m. Your task is to calculate the maximum number of coins the cafeteria can earn." 800
1430G "Yet Another DAG Problem" "bitmasks,dfs and similar,dp,flows,graphs,math" "You are given a directed acyclic graph (a directed graph that does not contain cycles) of n vertices and m arcs. The i-th arc leads from the vertex xi to the vertex yi and has the weight wi.Your task is to select an integer av for each vertex v, and then write a number bi on each arcs i such that bi=axi\xe2\x88\x92ayi. You must select the numbers so that:  all bi are positive;  the value of the expression m\xe2\x88\x91i=1wibi is the lowest possible. It can be shown that for any directed acyclic graph with non-negative wi, such a way to choose numbers exists." 2600
1430F "Realistic Gameplay" dp,greedy "Recently you\'ve discovered a new shooter. They say it has realistic game mechanics.Your character has a gun with magazine size equal to k and should exterminate n waves of monsters. The i-th wave consists of ai monsters and happens from the li-th moment of time up to the ri-th moments of time. All ai monsters spawn at moment li and you have to exterminate all of them before the moment ri ends (you can kill monsters right at moment ri). For every two consecutive waves, the second wave starts not earlier than the first wave ends (though the second wave can start at the same moment when the first wave ends) \xe2\x80\x94 formally, the condition ri\xe2\x89\xa4li+1 holds. Take a look at the notes for the examples to understand the process better.You are confident in yours and your character\'s skills so you can assume that aiming and shooting are instant and you need exactly one bullet to kill one monster. But reloading takes exactly 1 unit of time.One of the realistic mechanics is a mechanic of reloading: when you reload you throw away the old magazine with all remaining bullets in it. That\'s why constant reloads may cost you excessive amounts of spent bullets.You\'ve taken a liking to this mechanic so now you are wondering: what is the minimum possible number of bullets you need to spend (both used and thrown) to exterminate all waves.Note that you don\'t throw the remaining bullets away after eradicating all monsters, and you start with a full magazine." 2600
1430E "String Reversal" "data structures,greedy,strings" "You are given a string s. You have to reverse it \xe2\x80\x94 that is, the first letter should become equal to the last letter before the reversal, the second letter should become equal to the second-to-last letter before the reversal \xe2\x80\x94 and so on. For example, if your goal is to reverse the string ""abddea"", you should get the string ""aeddba"". To accomplish your goal, you can swap the neighboring elements of the string. Your task is to calculate the minimum number of swaps you have to perform to reverse the given string." 1900
1430D "String Deletion" "binary search,data structures,greedy,two pointers" "You have a string s consisting of n characters. Each character is either 0 or 1.You can perform operations on the string. Each operation consists of two steps:  select an integer i from 1 to the length of the string s, then delete the character si (the string length gets reduced by 1, the indices of characters to the right of the deleted one also get reduced by 1);  if the string s is not empty, delete the maximum length prefix consisting of the same characters (the indices of the remaining characters and the string length get reduced by the length of the deleted prefix). Note that both steps are mandatory in each operation, and their order cannot be changed.For example, if you have a string s= 111010, the first operation can be one of the following:  select i=1: we\'ll get 111010 \xe2\x86\x92 11010 \xe2\x86\x92 010;  select i=2: we\'ll get 111010 \xe2\x86\x92 11010 \xe2\x86\x92 010;  select i=3: we\'ll get 111010 \xe2\x86\x92 11010 \xe2\x86\x92 010;  select i=4: we\'ll get 111010 \xe2\x86\x92 11110 \xe2\x86\x92 0;  select i=5: we\'ll get 111010 \xe2\x86\x92 11100 \xe2\x86\x92 00;  select i=6: we\'ll get 111010 \xe2\x86\x92 11101 \xe2\x86\x92 01. You finish performing operations when the string s becomes empty. What is the maximum number of operations you can perform?" 1700
1430C "Numbers on Whiteboard" "constructive algorithms,data structures,greedy,implementation,math" "Numbers 1,2,3,\xe2\x80\xa6n (each integer from 1 to n once) are written on a board. In one operation you can erase any two numbers a and b from the board and write one integer a+b2 rounded up instead.You should perform the given operation n\xe2\x88\x921 times and make the resulting number that will be left on the board as small as possible. For example, if n=4, the following course of action is optimal:  choose a=4 and b=2, so the new number is 3, and the whiteboard contains [1,3,3];  choose a=3 and b=3, so the new number is 3, and the whiteboard contains [1,3];  choose a=1 and b=3, so the new number is 2, and the whiteboard contains [2]. It\'s easy to see that after n\xe2\x88\x921 operations, there will be left only one number. Your goal is to minimize it." 1000
1430B Barrels greedy,implementation,sortings "You have n barrels lined up in a row, numbered from left to right from one. Initially, the i-th barrel contains ai liters of water.You can pour water from one barrel to another. In one act of pouring, you can choose two different barrels x and y (the x-th barrel shouldn\'t be empty) and pour any possible amount of water from barrel x to barrel y (possibly, all water). You may assume that barrels have infinite capacity, so you can pour any amount of water in each of them. Calculate the maximum possible difference between the maximum and the minimum amount of water in the barrels, if you can pour water at most k times.Some examples:   if you have four barrels, each containing 5 liters of water, and k=1, you may pour 5 liters from the second barrel into the fourth, so the amounts of water in the barrels are [5,0,5,10], and the difference between the maximum and the minimum is 10;  if all barrels are empty, you can\'t make any operation, so the difference between the maximum and the minimum amount is still 0." 800
1430A "Number of Apartments" "brute force,constructive algorithms,math" "Recently a new building with a new layout was constructed in Monocarp\'s hometown. According to this new layout, the building consists of three types of apartments: three-room, five-room, and seven-room apartments. It\'s also known that each room of each apartment has exactly one window. In other words, a three-room apartment has three windows, a five-room \xe2\x80\x94 five windows, and a seven-room \xe2\x80\x94 seven windows.Monocarp went around the building and counted n windows. Now he is wondering, how many apartments of each type the building may have.Unfortunately, Monocarp only recently has learned to count, so he is asking you to help him to calculate the possible quantities of three-room, five-room, and seven-room apartments in the building that has n windows. If there are multiple answers, you can print any of them.Here are some examples:  if Monocarp has counted 30 windows, there could have been 2 three-room apartments, 2 five-room apartments and 2 seven-room apartments, since 2\xe2\x8b\x853+2\xe2\x8b\x855+2\xe2\x8b\x857=30;  if Monocarp has counted 67 windows, there could have been 7 three-room apartments, 5 five-room apartments and 3 seven-room apartments, since 7\xe2\x8b\x853+5\xe2\x8b\x855+3\xe2\x8b\x857=67;  if Monocarp has counted 4 windows, he should have mistaken since no building with the aforementioned layout can have 4 windows." 900
1428H "Rotary Laser Lock" "binary search,interactive" "This is an interactive problem.To prevent the mischievous rabbits from freely roaming around the zoo, Zookeeper has set up a special lock for the rabbit enclosure. This lock is called the Rotary Laser Lock.  The lock consists of n concentric rings numbered from 0 to n\xe2\x88\x921. The innermost ring is ring 0 and the outermost ring is ring n\xe2\x88\x921. All rings are split equally into nm sections each. Each of those rings contains a single metal arc that covers exactly m contiguous sections. At the center of the ring is a core and surrounding the entire lock are nm receivers aligned to the nm sections. The core has nm lasers that shine outward from the center, one for each section. The lasers can be blocked by any of the arcs. A display on the outside of the lock shows how many lasers hit the outer receivers.   In the example above, there are n=3 rings, each covering m=4 sections. The arcs are colored in green (ring 0), purple (ring 1), and blue (ring 2) while the lasers beams are shown in red. There are nm=12 sections and 3 of the lasers are not blocked by any arc, thus the display will show 3 in this case. Wabbit is trying to open the lock to free the rabbits, but the lock is completely opaque, and he cannot see where any of the arcs are. Given the relative positions of the arcs, Wabbit can open the lock on his own.  To be precise, Wabbit needs n\xe2\x88\x921 integers p1,p2,\xe2\x80\xa6,pn\xe2\x88\x921 satisfying 0\xe2\x89\xa4pi<nm such that for each i (1\xe2\x89\xa4i<n), Wabbit can rotate ring 0 clockwise exactly pi times such that the sections that ring 0 covers perfectly aligns with the sections that ring i covers. In the example above, the relative positions are p1=1 and p2=7. To operate the lock, he can pick any of the n rings and rotate them by 1 section either clockwise or anti-clockwise. You will see the number on the display after every rotation.Because his paws are small, Wabbit has asked you to help him to find the relative positions of the arcs after all of your rotations are completed. You may perform up to 15000 rotations before Wabbit gets impatient." 3500
1428G2 "Lucky Numbers (Hard Version)" dp,greedy "This is the hard version of the problem. The only difference is in the constraint on q. You can make hacks only if all versions of the problem are solved.Zookeeper has been teaching his q sheep how to write and how to add. The i-th sheep has to write exactly k non-negative integers with the sum ni.Strangely, sheep have superstitions about digits and believe that the digits 3, 6, and 9 are lucky. To them, the fortune of a number depends on the decimal representation of the number; the fortune of a number is equal to the sum of fortunes of its digits, and the fortune of a digit depends on its value and position and can be described by the following table. For example, the number 319 has fortune F2+3F0.   Each sheep wants to maximize the sum of fortune among all its k written integers. Can you help them?" 3000
1428G1 "Lucky Numbers (Easy Version)" dp,greedy "This is the easy version of the problem. The only difference is that in this version q=1. You can make hacks only if all versions of the problem are solved.Zookeeper has been teaching his q sheep how to write and how to add. The i-th sheep has to write exactly k non-negative integers with the sum ni.Strangely, sheep have superstitions about digits and believe that the digits 3, 6, and 9 are lucky. To them, the fortune of a number depends on the decimal representation of the number; the fortune of a number is equal to the sum of fortunes of its digits, and the fortune of a digit depends on its value and position and can be described by the following table. For example, the number 319 has fortune F2+3F0.   Each sheep wants to maximize the sum of fortune among all its k written integers. Can you help them?" 2900
1428F "Fruit Sequences" "binary search,data structures,divide and conquer,dp,two pointers" "Zookeeper is buying a carton of fruit to feed his pet wabbit. The fruits are a sequence of apples and oranges, which is represented by a binary string s1s2\xe2\x80\xa6sn of length n. 1 represents an apple and 0 represents an orange.Since wabbit is allergic to eating oranges, Zookeeper would like to find the longest contiguous sequence of apples. Let f(l,r) be the longest contiguous sequence of apples in the substring slsl+1\xe2\x80\xa6sr. Help Zookeeper find \xe2\x88\x91nl=1\xe2\x88\x91nr=lf(l,r), or the sum of f across all substrings." 2400
1428E "Carrots for Rabbits" "binary search,data structures,greedy,math,sortings" "There are some rabbits in Singapore Zoo. To feed them, Zookeeper bought n carrots with lengths a1,a2,a3,\xe2\x80\xa6,an. However, rabbits are very fertile and multiply very quickly. Zookeeper now has k rabbits and does not have enough carrots to feed all of them. To solve this problem, Zookeeper decided to cut the carrots into k pieces. For some reason, all resulting carrot lengths must be positive integers.Big carrots are very difficult for rabbits to handle and eat, so the time needed to eat a carrot of size x is x2.Help Zookeeper split his carrots while minimizing the sum of time taken for rabbits to eat the carrots." 2200
1428D "Bouncing Boomerangs" "constructive algorithms,greedy,implementation" "To improve the boomerang throwing skills of the animals, Zookeeper has set up an n\xc3\x97n grid with some targets, where each row and each column has at most 2 targets each. The rows are numbered from 1 to n from top to bottom, and the columns are numbered from 1 to n from left to right.  For each column, Zookeeper will throw a boomerang from the bottom of the column (below the grid) upwards. When the boomerang hits any target, it will bounce off, make a 90 degree turn to the right and fly off in a straight line in its new direction. The boomerang can hit multiple targets and does not stop until it leaves the grid.   In the above example, n=6 and the black crosses are the targets. The boomerang in column 1 (blue arrows) bounces 2 times while the boomerang in column 3 (red arrows) bounces 3 times. The boomerang in column i hits exactly ai targets before flying out of the grid. It is known that ai\xe2\x89\xa43.However, Zookeeper has lost the original positions of the targets. Thus, he asks you to construct a valid configuration of targets that matches the number of hits for each column, or tell him that no such configuration exists. If multiple valid configurations exist, you may print any of them." 1900
1428C ABBB "brute force,data structures,greedy,strings" "Zookeeper is playing a game. In this game, Zookeeper must use bombs to bomb a string that consists of letters \'A\' and \'B\'. He can use bombs to bomb a substring which is either ""AB"" or ""BB"". When he bombs such a substring, the substring gets deleted from the string and the remaining parts of the string get concatenated.For example, Zookeeper can use two such operations: AABABBA \xe2\x86\x92 AABBA \xe2\x86\x92 AAA.Zookeeper wonders what the shortest string he can make is. Can you help him find the length of the shortest string?" 1100
1428B "Belted Rooms" graphs,implementation "In the snake exhibition, there are n rooms (numbered 0 to n\xe2\x88\x921) arranged in a circle, with a snake in each room. The rooms are connected by n conveyor belts, and the i-th conveyor belt connects the rooms i and (i+1)modn. In the other words, rooms 0 and 1, 1 and 2, \xe2\x80\xa6, n\xe2\x88\x922 and n\xe2\x88\x921, n\xe2\x88\x921 and 0 are connected with conveyor belts.The i-th conveyor belt is in one of three states:  If it is clockwise, snakes can only go from room i to (i+1)modn.  If it is anticlockwise, snakes can only go from room (i+1)modn to i.  If it is off, snakes can travel in either direction.   Above is an example with 4 rooms, where belts 0 and 3 are off, 1 is clockwise, and 2 is anticlockwise.Each snake wants to leave its room and come back to it later. A room is returnable if the snake there can leave the room, and later come back to it using the conveyor belts. How many such returnable rooms are there?" 1200
1428A "Box is Pull" math "Wabbit is trying to move a box containing food for the rest of the zoo in the coordinate plane from the point (x1,y1) to the point (x2,y2).He has a rope, which he can use to pull the box. He can only pull the box if he stands exactly 1 unit away from the box in the direction of one of two coordinate axes. He will pull the box to where he is standing before moving out of the way in the same direction by 1 unit.   For example, if the box is at the point (1,2) and Wabbit is standing at the point (2,2), he can pull the box right by 1 unit, with the box ending up at the point (2,2) and Wabbit ending at the point (3,2).Also, Wabbit can move 1 unit to the right, left, up, or down without pulling the box. In this case, it is not necessary for him to be in exactly 1 unit away from the box. If he wants to pull the box again, he must return to a point next to the box. Also, Wabbit can\'t move to the point where the box is located.Wabbit can start at any point. It takes 1 second to travel 1 unit right, left, up, or down, regardless of whether he pulls the box while moving.Determine the minimum amount of time he needs to move the box from (x1,y1) to (x2,y2). Note that the point where Wabbit ends up at does not matter." 800
1427H "Prison Break" "binary search,games,geometry,ternary search" "A prisoner wants to escape from a prison. The prison is represented by the interior of the convex polygon with vertices P1,P2,P3,\xe2\x80\xa6,Pn+1,Pn+2,Pn+3. It holds P1=(0,0), Pn+1=(0,h), Pn+2=(\xe2\x88\x921018,h) and Pn+3=(\xe2\x88\x921018,0).  The prison walls Pn+1Pn+2, Pn+2Pn+3 and Pn+3P1 are very high and the prisoner is not able to climb them. Hence his only chance is to reach a point on one of the walls P1P2,P2P3,\xe2\x80\xa6,PnPn+1 and escape from there. On the perimeter of the prison, there are two guards. The prisoner moves at speed 1 while the guards move, remaining always on the perimeter of the prison, with speed v.If the prisoner reaches a point of the perimeter where there is a guard, the guard kills the prisoner. If the prisoner reaches a point of the part of the perimeter he is able to climb and there is no guard there, he escapes immediately. Initially the prisoner is at the point (\xe2\x88\x921017,h/2) and the guards are at P1. Find the minimum speed v such that the guards can guarantee that the prisoner will not escape (assuming that both the prisoner and the guards move optimally).Notes:   At any moment, the guards and the prisoner can see each other.  The ""climbing part"" of the escape takes no time.  You may assume that both the prisoner and the guards can change direction and velocity instantly and that they both have perfect reflexes (so they can react instantly to whatever the other one is doing).  The two guards can plan ahead how to react to the prisoner movements." 3500
1427G "One Billion Shades of Grey" flows,graphs "You have to paint with shades of grey the tiles of an n\xc3\x97n wall. The wall has n rows of tiles, each with n tiles.The tiles on the boundary of the wall (i.e., on the first row, last row, first column and last column) are already painted and you shall not change their color. All the other tiles are not painted. Some of the tiles are broken, you shall not paint those tiles. It is guaranteed that the tiles on the boundary are not broken.You shall paint all the non-broken tiles that are not already painted. When you paint a tile you can choose from 109 shades of grey, indexed from 1 to 109. You can paint multiple tiles with the same shade. Formally, painting the wall is equivalent to assigning a shade (an integer between 1 and 109) to each non-broken tile that is not already painted.The contrast between two tiles is the absolute value of the difference between the shades of the two tiles. The total contrast of the wall is the sum of the contrast of all the pairs of adjacent non-broken tiles (two tiles are adjacent if they share a side).Compute the minimum possible total contrast of the wall." 3300
1427F "Boring Card Game" "data structures,greedy,trees" "When they are bored, Federico and Giada often play the following card game with a deck containing 6n cards.Each card contains one number between 1 and 6n and each number appears on exactly one card. Initially the deck is sorted, so the first card contains the number 1, the second card contains the number 2, \xe2\x80\xa6, and the last one contains the number 6n.Federico and Giada take turns, alternating; Federico starts.In his turn, the player takes 3 contiguous cards from the deck and puts them in his pocket. The order of the cards remaining in the deck is not changed. They play until the deck is empty (after exactly 2n turns). At the end of the game both Federico and Giada have 3n cards in their pockets.You are given the cards in Federico\'s pocket at the end of the game. Describe a sequence of moves that produces that set of cards in Federico\'s pocket." 3200
1427E Xum "bitmasks,constructive algorithms,math,matrices,number theory" "You have a blackboard and initially only an odd number x is written on it. Your goal is to write the number 1 on the blackboard.You may write new numbers on the blackboard with the following two operations.   You may take two numbers (not necessarily distinct) already on the blackboard and write their sum on the blackboard. The two numbers you have chosen remain on the blackboard.  You may take two numbers (not necessarily distinct) already on the blackboard and write their bitwise XOR on the blackboard. The two numbers you have chosen remain on the blackboard.  Perform a sequence of operations such that at the end the number 1 is on the blackboard." 2500
1427D "Unshuffling a Deck" "constructive algorithms,implementation" "You are given a deck of n cards numbered from 1 to n (not necessarily in this order in the deck). You have to sort the deck by repeating the following operation.   Choose 2\xe2\x89\xa4k\xe2\x89\xa4n and split the deck in k nonempty contiguous parts D1,D2,\xe2\x80\xa6,Dk (D1 contains the first |D1| cards of the deck, D2 contains the following |D2| cards and so on). Then reverse the order of the parts, transforming the deck into Dk,Dk\xe2\x88\x921,\xe2\x80\xa6,D2,D1 (so, the first |Dk| cards of the new deck are Dk, the following |Dk\xe2\x88\x921| cards are Dk\xe2\x88\x921 and so on). The internal order of each packet of cards Di is unchanged by the operation. You have to obtain a sorted deck (i.e., a deck where the first card is 1, the second is 2 and so on) performing at most n operations. It can be proven that it is always possible to sort the deck performing at most n operations.Examples of operation: The following are three examples of valid operations (on three decks with different sizes).   If the deck is [3 6 2 1 4 5 7] (so 3 is the first card and 7 is the last card), we may apply the operation with k=4 and D1=[3 6], D2=[2 1 4], D3=[5], D4=[7]. Doing so, the deck becomes [7 5 2 1 4 3 6].  If the deck is [3 1 2], we may apply the operation with k=3 and D1=[3], D2=[1], D3=[2]. Doing so, the deck becomes [2 1 3].  If the deck is [5 1 2 4 3 6], we may apply the operation with k=2 and D1=[5 1], D2=[2 4 3 6]. Doing so, the deck becomes [2 4 3 6 5 1]." 2000
1427C "The Hard Work of Paparazzi" dp "You are a paparazzi working in Manhattan.Manhattan has r south-to-north streets, denoted by numbers 1,2,\xe2\x80\xa6,r in order from west to east, and r west-to-east streets, denoted by numbers 1,2,\xe2\x80\xa6,r in order from south to north. Each of the r south-to-north streets intersects each of the r west-to-east streets; the intersection between the x-th south-to-north street and the y-th west-to-east street is denoted by (x,y). In order to move from the intersection (x,y) to the intersection (x\xe2\x80\xb2,y\xe2\x80\xb2) you need |x\xe2\x88\x92x\xe2\x80\xb2|+|y\xe2\x88\x92y\xe2\x80\xb2| minutes.You know about the presence of n celebrities in the city and you want to take photos of as many of them as possible. More precisely, for each i=1,\xe2\x80\xa6,n, you know that the i-th celebrity will be at the intersection (xi,yi) in exactly ti minutes from now (and he will stay there for a very short time, so you may take a photo of him only if at the ti-th minute from now you are at the intersection (xi,yi)). You are very good at your job, so you are able to take photos instantaneously. You know that ti<ti+1 for any i=1,2,\xe2\x80\xa6,n\xe2\x88\x921.Currently you are at your office, which is located at the intersection (1,1). If you plan your working day optimally, what is the maximum number of celebrities you can take a photo of?" 2000
1427B "Chess Cheater" greedy,implementation,sortings "You like playing chess tournaments online.In your last tournament you played n games. For the sake of this problem, each chess game is either won or lost (no draws). When you lose a game you get 0 points. When you win you get 1 or 2 points: if you have won also the previous game you get 2 points, otherwise you get 1 point. If you win the very first game of the tournament you get 1 point (since there is not a ""previous game"").The outcomes of the n games are represented by a string s of length n: the i-th character of s is W if you have won the i-th game, while it is L if you have lost the i-th game.After the tournament, you notice a bug on the website that allows you to change the outcome of at most k of your games (meaning that at most k times you can change some symbol L to W, or W to L). Since your only goal is to improve your chess rating, you decide to cheat and use the bug.Compute the maximum score you can get by cheating in the optimal way." 1400
1427A "Avoiding Zero" math,sortings "You are given an array of n integers a1,a2,\xe2\x80\xa6,an.You have to create an array of n integers b1,b2,\xe2\x80\xa6,bn such that:   The array b is a rearrangement of the array a, that is, it contains the same values and each value appears the same number of times in the two arrays. In other words, the multisets {a1,a2,\xe2\x80\xa6,an} and {b1,b2,\xe2\x80\xa6,bn} are equal.For example, if a=[1,\xe2\x88\x921,0,1], then b=[\xe2\x88\x921,1,1,0] and b=[0,1,\xe2\x88\x921,1] are rearrangements of a, but b=[1,\xe2\x88\x921,\xe2\x88\x921,0] and b=[1,0,2,\xe2\x88\x923] are not rearrangements of a.  For all k=1,2,\xe2\x80\xa6,n the sum of the first k elements of b is nonzero. Formally, for all k=1,2,\xe2\x80\xa6,n, it must hold b1+b2+\xe2\x8b\xaf+bk\xe2\x89\xa00. If an array b1,b2,\xe2\x80\xa6,bn with the required properties does not exist, you have to print NO." 900
1426F "Number of Subsequences" combinatorics,dp,strings "You are given a string s consisting of lowercase Latin letters ""a"", ""b"" and ""c"" and question marks ""?"".Let the number of question marks in the string s be k. Let\'s replace each question mark with one of the letters ""a"", ""b"" and ""c"". Here we can obtain all 3k possible strings consisting only of letters ""a"", ""b"" and ""c"". For example, if s=""ac?b?c"" then we can obtain the following strings: [""acabac"", ""acabbc"", ""acabcc"", ""acbbac"", ""acbbbc"", ""acbbcc"", ""accbac"", ""accbbc"", ""accbcc""].Your task is to count the total number of subsequences ""abc"" in all resulting strings. Since the answer can be very large, print it modulo 109+7.A subsequence of the string t is such a sequence that can be derived from the string t after removing some (possibly, zero) number of letters without changing the order of remaining letters. For example, the string ""baacbc"" contains two subsequences ""abc"" \xe2\x80\x94 a subsequence consisting of letters at positions (2,5,6) and a subsequence consisting of letters at positions (3,5,6)." 2000
1426E "Rock, Paper, Scissors" "brute force,constructive algorithms,flows,greedy,math" "Alice and Bob have decided to play the game ""Rock, Paper, Scissors"". The game consists of several rounds, each round is independent of each other. In each round, both players show one of the following things at the same time: rock, paper or scissors. If both players showed the same things then the round outcome is a draw. Otherwise, the following rules applied:  if one player showed rock and the other one showed scissors, then the player who showed rock is considered the winner and the other one is considered the loser;  if one player showed scissors and the other one showed paper, then the player who showed scissors is considered the winner and the other one is considered the loser;  if one player showed paper and the other one showed rock, then the player who showed paper is considered the winner and the other one is considered the loser. Alice and Bob decided to play exactly n rounds of the game described above. Alice decided to show rock a1 times, show scissors a2 times and show paper a3 times. Bob decided to show rock b1 times, show scissors b2 times and show paper b3 times. Though, both Alice and Bob did not choose the sequence in which they show things. It is guaranteed that a1+a2+a3=n and b1+b2+b3=n.Your task is to find two numbers:  the minimum number of round Alice can win;  the maximum number of rounds Alice can win." 1800
1426D "Non-zero Segments" "constructive algorithms,data structures,greedy,sortings" "Kolya got an integer array a1,a2,\xe2\x80\xa6,an. The array can contain both positive and negative integers, but Kolya doesn\'t like 0, so the array doesn\'t contain any zeros.Kolya doesn\'t like that the sum of some subsegments of his array can be 0. The subsegment is some consecutive segment of elements of the array. You have to help Kolya and change his array in such a way that it doesn\'t contain any subsegments with the sum 0. To reach this goal, you can insert any integers between any pair of adjacent elements of the array (integers can be really any: positive, negative, 0, any by absolute value, even such a huge that they can\'t be represented in most standard programming languages).Your task is to find the minimum number of integers you have to insert into Kolya\'s array in such a way that the resulting array doesn\'t contain any subsegments with the sum 0." 1500
1426C "Increase and Copy" "binary search,constructive algorithms,math" "Initially, you have the array a consisting of one element 1 (a=[1]).In one move, you can do one of the following things:  Increase some (single) element of a by 1 (choose some i from 1 to the current length of a and increase ai by one);  Append the copy of some (single) element of a to the end of the array (choose some i from 1 to the current length of a and append ai to the end of the array). For example, consider the sequence of five moves:  You take the first element a1, append its copy to the end of the array and get a=[1,1].  You take the first element a1, increase it by 1 and get a=[2,1].  You take the second element a2, append its copy to the end of the array and get a=[2,1,1].  You take the first element a1, append its copy to the end of the array and get a=[2,1,1,2].  You take the fourth element a4, increase it by 1 and get a=[2,1,1,3]. Your task is to find the minimum number of moves required to obtain the array with the sum at least n.You have to answer t independent test cases." 1100
1426B "Symmetric Matrix" implementation "Masha has n types of tiles of size 2\xc3\x972. Each cell of the tile contains one integer. Masha has an infinite number of tiles of each type.Masha decides to construct the square of size m\xc3\x97m consisting of the given tiles. This square also has to be a symmetric with respect to the main diagonal matrix, and each cell of this square has to be covered with exactly one tile cell, and also sides of tiles should be parallel to the sides of the square. All placed tiles cannot intersect with each other. Also, each tile should lie inside the square. See the picture in Notes section for better understanding.Symmetric with respect to the main diagonal matrix is such a square s that for each pair (i,j) the condition s[i][j]=s[j][i] holds. I.e. it is true that the element written in the i-row and j-th column equals to the element written in the j-th row and i-th column.Your task is to determine if Masha can construct a square of size m\xc3\x97m which is a symmetric matrix and consists of tiles she has. Masha can use any number of tiles of each type she has to construct the square. Note that she can not rotate tiles, she can only place them in the orientation they have in the input.You have to answer t independent test cases." 900
1426A "Floor Number" implementation,math "Vasya goes to visit his classmate Petya. Vasya knows that Petya\'s apartment number is n. There is only one entrance in Petya\'s house and the distribution of apartments is the following: the first floor contains 2 apartments, every other floor contains x apartments each. Apartments are numbered starting from one, from the first floor. I.e. apartments on the first floor have numbers 1 and 2, apartments on the second floor have numbers from 3 to (x+2), apartments on the third floor have numbers from (x+3) to (2\xe2\x8b\x85x+2), and so on.Your task is to find the number of floor on which Petya lives. Assume that the house is always high enough to fit at least n apartments.You have to answer t independent test cases." 800
1425I "Impressive Harvesting of The Orchard" "data structures" "Mr. Chanek has an orchard structured as a rooted ternary tree with N vertices numbered from 1 to N. The root of the tree is vertex 1. Pi denotes the parent of vertex i, for (2\xe2\x89\xa4i\xe2\x89\xa4N). Interestingly, the height of the tree is not greater than 10. Height of a tree is defined to be the largest distance from the root to a vertex in the tree.There exist a bush on each vertex of the tree. Initially, all bushes have fruits. Fruits will not grow on bushes that currently already have fruits. The bush at vertex i will grow fruits after Ai days since its last harvest.Mr. Chanek will visit his orchard for Q days. In day i, he will harvest all bushes that have fruits on the subtree of vertex Xi. For each day, determine the sum of distances from every harvested bush to Xi, and the number of harvested bush that day. Harvesting a bush means collecting all fruits on the bush.For example, if Mr. Chanek harvests all fruits on subtree of vertex X, and harvested bushes [Y1,Y2,\xe2\x80\xa6,YM], the sum of distances is \xe2\x88\x91Mi=1distance(X,Yi)distance(U,V) in a tree is defined to be the number of edges on the simple path from U to V." 2800
1425H "Huge Boxes of Animal Toys" "constructive algorithms" "Chaneka has a hobby of playing with animal toys. Every toy has a different fun value, a real number. Chaneka has four boxes to store the toys with specification:   The first box stores toys with fun values in range of (\xe2\x88\x92\xe2\x88\x9e,\xe2\x88\x921].  The second box stores toys with fun values in range of (\xe2\x88\x921,0).  The third box stores toys with fun values in range of (0,1).  The fourth box stores toys with fun value in range of [1,\xe2\x88\x9e). Chaneka has A, B, C, D toys in the first, second, third, and fourth box, respectively. One day she decides that she only wants one toy, a super toy. So she begins to create this super toy by sewing all the toys she has.While the number of toys Chaneka has is more than 1, she takes two different toys randomly and then sews them together, creating a new toy. The fun value of this new toy is equal to the multiplication of fun values of the sewn toys. She then puts this new toy in the appropriate box. She repeats this process until she only has one toy. This last toy is the super toy, and the box that stores this toy is the special box.As an observer, you only know the number of toys in each box initially but do not know their fun values. You also don\'t see the sequence of Chaneka\'s sewing. Determine which boxes can be the special box after Chaneka found her super toy." 1300
1425F "Flamingoes of Mystery" interactive "This is an interactive problem. You have to use a flush operation right after printing each line. For example, in C++ you should use the function fflush(stdout), in Java \xe2\x80\x94 System.out.flush(), in Pascal \xe2\x80\x94 flush(output) and in Python \xe2\x80\x94 sys.stdout.flush().Mr. Chanek wants to buy a flamingo to accompany his chickens on his farm. Before going to the pet shop, Mr. Chanek stops at an animal festival to have fun. It turns out there is a carnival game with a flamingo as the prize.There are N mysterious cages, which are numbered from 1 to N. Cage i has Ai (0\xe2\x89\xa4Ai\xe2\x89\xa4103) flamingoes inside (1\xe2\x89\xa4i\xe2\x89\xa4N). However, the game master keeps the number of flamingoes inside a secret. To win the flamingo, Mr. Chanek must guess the number of flamingoes in each cage.Coincidentally, Mr. Chanek has N coins. Each coin can be used to ask once, what is the total number of flamingoes inside cages numbered L to R inclusive? With L<R." 1400
1425E "Excitation of Atoms" greedy,implementation "Mr. Chanek is currently participating in a science fair that is popular in town. He finds an exciting puzzle in the fair and wants to solve it.There are N atoms numbered from 1 to N. These atoms are especially quirky. Initially, each atom is in normal state. Each atom can be in an excited. Exciting atom i requires Di energy. When atom i is excited, it will give Ai energy. You can excite any number of atoms (including zero).These atoms also form a peculiar one-way bond. For each i, (1\xe2\x89\xa4i<N), if atom i is excited, atom Ei will also be excited at no cost. Initially, Ei = i+1. Note that atom N cannot form a bond to any atom.Mr. Chanek must change exactly K bonds. Exactly K times, Mr. Chanek chooses an atom i, (1\xe2\x89\xa4i<N) and changes Ei to a different value other than i and the current Ei. Note that an atom\'s bond can remain unchanged or changed more than once. Help Mr. Chanek determine the maximum energy that he can achieve!note: You must first change exactly K bonds before you can start exciting atoms." 2200
1425D "Danger of Mad Snakes" combinatorics,dp,math "Mr. Chanek The Ninja is one day tasked with a mission to handle mad snakes that are attacking a site. Now, Mr. Chanek already arrived at the hills where the destination is right below these hills. The mission area can be divided into a grid of size 1000\xc3\x971000 squares. There are N mad snakes on the site, the i\'th mad snake is located on square (Xi,Yi) and has a danger level Bi.Mr. Chanek is going to use the Shadow Clone Jutsu and Rasengan that he learned from Lord Seventh to complete this mission. His attack strategy is as follows:  Mr. Chanek is going to make M clones.  Each clone will choose a mad snake as the attack target. Each clone must pick a different mad snake to attack.  All clones jump off the hills and attack their respective chosen target at once with Rasengan of radius R. If the mad snake at square (X,Y) is attacked with a direct Rasengan, it and all mad snakes at squares (X\xe2\x80\xb2,Y\xe2\x80\xb2) where max(|X\xe2\x80\xb2\xe2\x88\x92X|,|Y\xe2\x80\xb2\xe2\x88\x92Y|)\xe2\x89\xa4R will die.  The real Mr. Chanek will calculate the score of this attack. The score is defined as the square of the sum of the danger levels of all the killed snakes. Now Mr. Chanek is curious, what is the sum of scores for every possible attack strategy? Because this number can be huge, Mr. Chanek only needs the output modulo 109+7." 2300
1425C "Captain of Knights" math "Mr. Chanek just won the national chess tournament and got a huge chessboard of size N\xc3\x97M. Bored with playing conventional chess, Mr. Chanek now defines a function F(X,Y), which denotes the minimum number of moves to move a knight from square (1,1) to square (X,Y). It turns out finding F(X,Y) is too simple, so Mr. Chanek defines:G(X,Y)=\xe2\x88\x91Ni=X\xe2\x88\x91Mj=YF(i,j)Given X and Y, you are tasked to find G(X,Y).A knight can move from square (a,b) to square (a\xe2\x80\xb2,b\xe2\x80\xb2) if and only if |a\xe2\x88\x92a\xe2\x80\xb2|>0, |b\xe2\x88\x92b\xe2\x80\xb2|>0, and |a\xe2\x88\x92a\xe2\x80\xb2|+|b\xe2\x88\x92b\xe2\x80\xb2|=3. Of course, the knight cannot leave the chessboard." 3100
1425B "Blue and Red of Our Faculty!" "divide and conquer,dp" "It\'s our faculty\'s 34th anniversary! To celebrate this great event, the Faculty of Computer Science, University of Indonesia (Fasilkom), held CPC - Coloring Pavements Competition. The gist of CPC is two players color the predetermined routes of Fasilkom in Blue and Red. There are N Checkpoints and M undirected predetermined routes. Routes i connects checkpoint Ui and Vi, for (1\xe2\x89\xa4i\xe2\x89\xa4M). It is guaranteed that any pair of checkpoints are connected by using one or more routes.The rules of CPC is as follows:   Two players play in each round. One player plays as blue, the other plays as red. For simplicity, let\'s call these players Blue and Red.  Blue will color every route in he walks on blue, Red will color the route he walks on red. Both players start at checkpoint number 1. Initially, all routes are gray.  Each phase, from their current checkpoint, Blue and Red select a different gray route and moves to the checkpoint on the other end of the route simultaneously.  The game ends when Blue or Red can no longer move. That is, there is no two distinct gray routes they can choose to continue moving. Chaneka is interested in participating. However, she does not want to waste much energy. So, She is only interested in the number of final configurations of the routes after each round. Turns out, counting this is also exhausting, so Chaneka asks you to figure this out!Two final configurations are considered different if there is a route U in a different color in the two configurations." 2600
1425A "Arena of Greed" games,greedy "Lately, Mr. Chanek frequently plays the game Arena of Greed. As the name implies, the game\'s goal is to find the greediest of them all, who will then be crowned king of Compfestnesia.The game is played by two people taking turns, where Mr. Chanek takes the first turn. Initially, there is a treasure chest containing N gold coins. The game ends if there are no more gold coins in the chest. In each turn, the players can make one of the following moves:  Take one gold coin from the chest.  Take half of the gold coins on the chest. This move is only available if the number of coins in the chest is even. Both players will try to maximize the number of coins they have. Mr. Chanek asks your help to find the maximum number of coins he can get at the end of the game if both he and the opponent plays optimally." 1400
1424M "Ancient Language" graphs,sortings "While exploring the old caves, researchers found a book, or more precisely, a stash of mixed pages from a book. Luckily, all of the original pages are present and each page contains its number. Therefore, the researchers can reconstruct the book.After taking a deeper look into the contents of these pages, linguists think that this may be some kind of dictionary. What\'s interesting is that this ancient civilization used an alphabet which is a subset of the English alphabet, however, the order of these letters in the alphabet is not like the one in the English language.Given the contents of pages that researchers have found, your task is to reconstruct the alphabet of this ancient civilization using the provided pages from the dictionary." 2200
1424G Years "data structures,sortings" "During one of the space missions, humans have found an evidence of previous life at one of the planets. They were lucky enough to find a book with birth and death years of each individual that had been living at this planet. What\'s interesting is that these years are in the range (1,109)! Therefore, the planet was named Longlifer.In order to learn more about Longlifer\'s previous population, scientists need to determine the year with maximum number of individuals that were alive, as well as the number of alive individuals in that year. Your task is to help scientists solve this problem!" 1300
1423N "BubbleSquare Tokens" NA "BubbleSquare social network is celebrating 13th anniversary and it is rewarding its members with special edition BubbleSquare tokens. Every member receives one personal token. Also, two additional tokens are awarded to each member for every friend they have on the network. Yet, there is a twist \xe2\x80\x93 everyone should end up with different number of tokens from all their friends. Each member may return one received token. Also, each two friends may agree to each return one or two tokens they have obtained on behalf of their friendship." 3500
1423M "Milutin\'s Plums" interactive "As you all know, the plum harvesting season is on! Little Milutin had his plums planted in an orchard that can be represented as an n by m matrix. While he was harvesting, he wrote the heights of all trees in a matrix of dimensions n by m.At night, when he has spare time, he likes to perform various statistics on his trees. This time, he is curious to find out the height of his lowest tree. So far, he has discovered some interesting properties of his orchard. There is one particular property that he thinks is useful for finding the tree with the smallest heigh.Formally, let L(i) be the leftmost tree with the smallest height in the i-th row of his orchard. He knows that L(i)\xe2\x89\xa4L(i+1) for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. Moreover, if he takes a submatrix induced by any subset of rows and any subset of columns, L(i)\xe2\x89\xa4L(i+1) will hold for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x80\xb2\xe2\x88\x921, where n\xe2\x80\xb2 is the number of rows in that submatrix.Since the season is at its peak and he is short on time, he asks you to help him find the plum tree with minimal height." 2800
1423L "Light switches" meet-in-the-middle "Nikola owns a large warehouse which is illuminated by N light bulbs, numbered 1 to N. At the exit of the warehouse, there are S light switches, numbered 1 to S. Each switch swaps the on/off state for some light bulbs, so if a light bulb is off, flipping the switch turns it on, and if the light bulb is on, flipping the switch turns it off.At the end of the day, Nikola wants to turn all the lights off. To achieve this, he will flip some of the light switches at the exit of the warehouse, but since Nikola is lazy, he wants to flip the _minimum_ number of switches required to turn all the lights off. Since Nikola was not able to calculate the minimum number of switches, he asked you to help him. During a period of D days, Nikola noted which light bulbs were off and which were on at the end of each day. He wants you to tell him the minimum number of switches he needed to flip to turn all the lights off for each of the D days or tell him that it\'s impossible." 2600
1423K "Lonely Numbers" "binary search,math,number theory,two pointers" "In number world, two different numbers are friends if they have a lot in common, but also each one has unique perks.More precisely, two different numbers a and b are friends if gcd(a,b), agcd(a,b), bgcd(a,b) can form sides of a triangle.Three numbers a, b and c can form sides of a triangle if a+b>c, b+c>a and c+a>b.In a group of numbers, a number is lonely if it doesn\'t have any friends in that group.Given a group of numbers containing all numbers from 1,2,3,...,n, how many numbers in that group are lonely?" 1600
1423J "Bubble Cup hypothesis" "bitmasks,constructive algorithms,dp,math" "The Bubble Cup hypothesis stood unsolved for 130 years. Who ever proves the hypothesis will be regarded as one of the greatest mathematicians of our time! A famous mathematician Jerry Mao managed to reduce the hypothesis to this problem:Given a number m, how many polynomials P with coefficients in set {0,1,2,3,4,5,6,7} have: P(2)=m?Help Jerry Mao solve the long standing problem!" 2400
1423I "Lookup Tables" bitmasks "John has Q closed intervals of consecutive 2K-bit numbers [li,ri] and one 16-bit value vi for each interval. (0\xe2\x89\xa4i<Q)John wants to implement a function F that maps 2K-bit numbers to 16-bit numbers in such a way that inputs from each interval are mapped to that interval\'s value. In other words: F(x)=vi,for every 0\xe2\x89\xa4i<Q, and every x\xe2\x88\x88[li,ri] The output of F for other inputs is unimportant.John wants to make his implementation of F fast so he has decided to use lookup tables. A single 2K-bit lookup table would be too large to fit in memory, so instead John plans to use two K-bit lookup tables, LSBTable and MSBTable. His implementation will look like this: F(x)=LSBTable[lowKBits(x)]&MSBTable[highKBits(x)] In other words it returns the ""bitwise and"" of results of looking up the K least significant bits in LSBTable and the K most significant bits in MSBTable.John needs your help. Given K, Q and Q intervals [li,ri] and values vi, find any two lookup tables which can implement F or report that such tables don\'t exist." 3000
1423H Virus "data structures,divide and conquer,dsu,graphs" "In Bubbleland a group of special programming forces gets a top secret job to calculate the number of potentially infected people by a new unknown virus. The state has a population of n people and every day there is new information about new contacts between people. The job of special programming forces is to calculate how many contacts in the last k days a given person had. The new virus has an incubation period of k days, and after that time people consider as non-infectious. Because the new virus is an extremely dangerous, government mark as suspicious everybody who had direct or indirect contact in the last k days, independently of the order of contacts.This virus is very strange, and people can\'t get durable immunity.You need to help special programming forces to calculate the number of suspicious people for a given person (number of people who had contact with a given person).There are 3 given inputs on beginning n where n is population, q number of queries, k virus incubation time in days. Each query is one of three types:    (x, y) person x and person y met that day (x\xe2\x89\xa0y).   (z) return the number of people in contact with z, counting himself.   The end of the current day moves on to the next day." 2500
1423G "Growing flowers" "data structures" "Sarah has always been a lover of nature, and a couple of years ago she saved up enough money to travel the world and explore all the things built by nature over its lifetime on earth. During this time she visited some truly special places which were left untouched for centuries, from watching icebergs in freezing weather to scuba-diving in oceans and admiring the sea life, residing unseen. These experiences were enhanced with breathtaking views built by mountains over time and left there for visitors to see for years on end. Over time, all these expeditions took a toll on Sarah and culminated in her decision to settle down in the suburbs and live a quiet life. However, as Sarah\'s love for nature never faded, she started growing flowers in her garden in an attempt to stay connected with nature. At the beginning she planted only blue orchids, but over time she started using different flower types to add variety to her collection of flowers. This collection of flowers can be represented as an array of N flowers and the i-th of them has a type associated with it, denoted as Ai. Each resident, passing by her collection and limited by the width of his view, can only see K contiguous flowers at each moment in time. To see the whole collection, the resident will look at the first K contiguous flowers A1,A2,...,AK, then shift his view by one flower and look at the next section of K contiguous flowers A2,A3,...,AK+1 and so on until they scan the whole collection, ending with section AN\xe2\x88\x92K+1,...,AN\xe2\x88\x921,AN.Each resident determines the beautiness of a section of K flowers as the number of distinct flower types in that section. Furthermore, the beautiness of the whole collection is calculated by summing the beautiness values of each contiguous section. Formally, beautiness Bi of a section starting at the i-th position is calculated as Bi=distinct(Ai,Ai+1,...,Ai+K\xe2\x88\x921), and beautiness of the collection B is calculated as B=B1+B2+...+BN\xe2\x88\x92K+1.In addition, as Sarah wants to keep her collection of flowers have a fresh feel, she can also pick two points L and R, dispose flowers between those two points and plant new flowers, all of them being the same type.You will be given Q queries and each of those queries will be of the following two types:   You will be given three integers L,R,X describing that Sarah has planted flowers of type X between positions L and R inclusive. Formally collection is changed such that A[i]=X for all i in range [L..R].  You will be given integer K, width of the resident\'s view and you have to determine the beautiness value B resident has associated with the collection For each query of second type print the result \xe2\x80\x93 beautiness B of the collection." 3500
1423F Coins math "A famous gang of pirates, Sea Dogs, has come back to their hideout from one of their extravagant plunders. They want to split their treasure fairly amongst themselves, that is why You, their trusted financial advisor, devised a game to help them:All of them take a sit at their round table, some of them with the golden coins they have just stolen. At each iteration of the game if one of them has equal or more than 2 coins, he is eligible to the splitting and he gives one coin to each pirate sitting next to him. If there are more candidates (pirates with equal or more than 2 coins) then You are the one that chooses which one of them will do the splitting in that iteration. The game ends when there are no more candidates eligible to do the splitting. Pirates can call it a day, only when the game ends. Since they are beings with a finite amount of time at their disposal, they would prefer if the game that they are playing can end after finite iterations, and if so, they call it a good game. On the other hand, if no matter how You do the splitting, the game cannot end in finite iterations, they call it a bad game. Can You help them figure out before they start playing if the game will be good or bad?" 2700
1423E "5G Antenna Towers" geometry "After making a strategic plan with carriers for expansion of mobile network throughout the whole country, the government decided to cover rural areas with the last generation of 5G network.Since 5G antenna towers will be built in the area of mainly private properties, the government needs an easy way to find information about landowners for each property partially or fully contained in the planned building area. The planned building area is represented as a rectangle with sides width and height.Every 5G antenna tower occupies a circle with a center in (x,y) and radius r. There is a database of Geodetic Institute containing information about each property. Each property is defined with its identification number and polygon represented as an array of (x,y) points in the counter-clockwise direction. Your task is to build an IT system which can handle queries of type (x,y,r) in which (x,y) represents a circle center, while r represents its radius. The IT system should return the total area of properties that need to be acquired for the building of a tower so that the government can estimate the price. Furthermore, the system should return a list of identification numbers of these properties (so that the owners can be contacted for land acquisition).A property needs to be acquired if the circle of the antenna tower is intersecting or touching it." 2700
1423D "Does anyone else hate the wind?" NA "Mark and his crew are sailing across the sea of Aeolus (in Greek mythology Aeolus was the keeper of the winds). They have the map which represents the NxM matrix with land and sea fields and they want to get to the port (the port is considered as sea field). They are in a hurry because the wind there is very strong and changeable and they have the food for only K days on the sea (that is the maximum that they can carry on the ship). John, the guy from Mark\'s crew, knows how to predict the direction of the wind on daily basis for W days which is enough time for them to reach the port or to run out of the food. Mark can move the ship in four directions (north, east, south, west) by one field for one day, but he can also stay in the same place. Wind can blow in four directions (north, east, south, west) or just not blow that day. The wind is so strong at the sea of Aeolus that it moves the ship for one whole field in the direction which it blows at. The ship\'s resulting movement is the sum of the ship\'s action and wind from that day. Mark must be careful in order to keep the ship on the sea, the resulting movement must end on the sea field and there must be a 4-connected path through the sea from the starting field. A 4-connected path is a path where you can go from one cell to another only if they share a side.For example in the following image, the ship can\'t move to the port as there is no 4-connected path through the sea.   In the next image, the ship can move to the port as there is a 4-connected path through the sea as shown with the red arrow. Furthermore, the ship can move to the port in one move if one of the following happens. Wind is blowing east and Mark moves the ship north, or wind is blowing north and Mark moves the ship east. In either of these scenarios the ship will end up in the port in one move.   Mark must also keep the ship on the map because he doesn\'t know what is outside. Lucky for Mark and his crew, there are T fish shops at the sea where they can replenish their food supplies to the maximum, but each shop is working on only one day. That means that Mark and his crew must be at the shop\'s position on the exact working day in order to replenish their food supplies. Help Mark to find the minimum of days that he and his crew need to reach the port or print \xe2\x88\x921 if that is impossible with the food supplies that they have." 3100
1423C "Du\xc5\xa1an\'s Railway" "divide and conquer,graphs,trees" "As you may already know, Du\xc5\xa1an is keen on playing with railway models. He has a big map with cities that are connected with railways. His map can be seen as a graph where vertices are cities and the railways connecting them are the edges. So far, the graph corresponding to his map is a tree. As you already know, a tree is a connected acyclic undirected graph.He is curious to find out whether his railway can be optimized somehow. He wants to add so-called shortcuts, which are also railways connecting pairs of cities. This shortcut will represent the railways in the unique path in the tree between the pair of cities it connects. Since Du\xc5\xa1an doesn\'t like repeating the railways, he has also defined good paths in his newly obtained network (notice that after adding the shortcuts, his graph is no more a tree). He calls a path good, if no edge appears more than once, either as a regular railway edge or as an edge represented by some shortcut (Every shortcut in a good path has length 1, but uses up all the edges it represents - they can\'t appear again in that path). Having defined good paths, he defines good distance between two cities to be the length of the shortest good path between them. Finally, the shortcutting diameter of his network is the largest good distance between any two cities.Now he is curious to find out whether it is possible to achieve shortcutting diameter less or equal than k, while adding as few shortcuts as possible.Your solution should add no more than 10\xe2\x8b\x85n shortcuts." 3500
1423B "Valuable Paper" "binary search,flows,graph matchings,graphs" "The pandemic is upon us, and the world is in shortage of the most important resource: toilet paper. As one of the best prepared nations for this crisis, BubbleLand promised to help all other world nations with this valuable resource. To do that, the country will send airplanes to other countries carrying toilet paper.In BubbleLand, there are N toilet paper factories, and N airports. Because of how much it takes to build a road, and of course legal issues, every factory must send paper to only one airport, and every airport can only take toilet paper from one factory.Also, a road can\'t be built between all airport-factory pairs, again because of legal issues. Every possible road has number d given, number of days it takes to build that road.Your job is to choose N factory-airport pairs, such that if the country starts building all roads at the same time, it takes the least amount of days to complete them." 1900
1423A "Wakanda Forever" NA "In the Kingdom of Wakanda, the 2020 economic crisis has made a great impact on each city and its surrounding area. Cities have made a plan to build a fast train rail between them to boost the economy, but because of the insufficient funds, each city can only build a rail with one other city, and they want to do it together.Cities which are paired up in the plan will share the cost of building the rail between them, and one city might need to pay more than the other. Each city knows the estimated cost of building their part of the rail to every other city. One city can not have the same cost of building the rail with two different cities.If in a plan, there are two cities that are not connected, but the cost to create a rail between them is lower for each of them than the cost to build the rail with their current pairs, then that plan is not acceptable and the collaboration won\'t go on. Your task is to create a suitable plan for the cities (pairing of the cities) or say that such plan doesn\'t exist." 3500
1422F "Boring Queries" "data structures,math,number theory" "Yura owns a quite ordinary and boring array a of length n. You think there is nothing more boring than that, but Vladik doesn\'t agree!In order to make Yura\'s array even more boring, Vladik makes q boring queries. Each query consists of two integers x and y. Before answering a query, the bounds l and r for this query are calculated: l=(last+x)modn+1, r=(last+y)modn+1, where last is the answer on the previous query (zero initially), and mod is the remainder operation. Whenever l>r, they are swapped.After Vladik computes l and r for a query, he is to compute the least common multiple (LCM) on the segment [l;r] of the initial array a modulo 109+7. LCM of a multiset of integers is the smallest positive integer that is divisible by all the elements of the multiset. The obtained LCM is the answer for this query.Help Vladik and compute the answer for each query!" 2700
1422E Minlexes dp,greedy,implementation,strings "Some time ago Lesha found an entertaining string s consisting of lowercase English letters. Lesha immediately developed an unique algorithm for this string and shared it with you. The algorithm is as follows.Lesha chooses an arbitrary (possibly zero) number of pairs on positions (i,i+1) in such a way that the following conditions are satisfied:   for each pair (i,i+1) the inequality 0\xe2\x89\xa4i<|s|\xe2\x88\x921 holds;  for each pair (i,i+1) the equality si=si+1 holds;  there is no index that is contained in more than one pair.  After that Lesha removes all characters on indexes contained in these pairs and the algorithm is over. Lesha is interested in the lexicographically smallest strings he can obtain by applying the algorithm to the suffixes of the given string." 2700
1422D "Returning Home" "graphs,shortest paths,sortings" "Yura has been walking for some time already and is planning to return home. He needs to get home as fast as possible. To do this, Yura can use the instant-movement locations around the city.Let\'s represent the city as an area of n\xc3\x97n square blocks. Yura needs to move from the block with coordinates (sx,sy) to the block with coordinates (fx,fy). In one minute Yura can move to any neighboring by side block; in other words, he can move in four directions. Also, there are m instant-movement locations in the city. Their coordinates are known to you and Yura. Yura can move to an instant-movement location in no time if he is located in a block with the same coordinate x or with the same coordinate y as the location.Help Yura to find the smallest time needed to get home." 2300
1422C Bargain combinatorics,dp,math "Sometimes it is not easy to come to an agreement in a bargain. Right now Sasha and Vova can\'t come to an agreement: Sasha names a price as high as possible, then Vova wants to remove as many digits from the price as possible. In more details, Sasha names some integer price n, Vova removes a non-empty substring of (consecutive) digits from the price, the remaining digits close the gap, and the resulting integer is the price.For example, is Sasha names 1213121, Vova can remove the substring 1312, and the result is 121.It is allowed for result to contain leading zeros. If Vova removes all digits, the price is considered to be 0.Sasha wants to come up with some constraints so that Vova can\'t just remove all digits, but he needs some arguments supporting the constraints. To start with, he wants to compute the sum of all possible resulting prices after Vova\'s move.Help Sasha to compute this sum. Since the answer can be very large, print it modulo 109+7." 1700
1422B "Nice Matrix" greedy,implementation,math "A matrix of size n\xc3\x97m is called nice, if all rows and columns of the matrix are palindromes. A sequence of integers (a1,a2,\xe2\x80\xa6,ak) is a palindrome, if for any integer i (1\xe2\x89\xa4i\xe2\x89\xa4k) the equality ai=ak\xe2\x88\x92i+1 holds.Sasha owns a matrix a of size n\xc3\x97m. In one operation he can increase or decrease any number in the matrix by one. Sasha wants to make the matrix nice. He is interested what is the minimum number of operations he needs.Help him!" 1300
1422A Fence geometry,math "Yura is tasked to build a closed fence in shape of an arbitrary non-degenerate simple quadrilateral. He\'s already got three straight fence segments with known lengths a, b, and c. Now he needs to find out some possible integer length d of the fourth straight fence segment so that he can build the fence using these four segments. In other words, the fence should have a quadrilateral shape with side lengths equal to a, b, c, and d. Help Yura, find any possible length of the fourth side.A non-degenerate simple quadrilateral is such a quadrilateral that no three of its corners lie on the same line, and it does not cross itself." 800
1421E "Swedish Heroes" "brute force,dp,implementation" "While playing yet another strategy game, Mans has recruited n Swedish heroes, whose powers which can be represented as an array a.Unfortunately, not all of those mighty heroes were created as capable as he wanted, so that he decided to do something about it. In order to accomplish his goal, he can pick two consecutive heroes, with powers ai and ai+1, remove them and insert a hero with power \xe2\x88\x92(ai+ai+1) back in the same position. For example if the array contains the elements [5,6,7,8], he can pick 6 and 7 and get [5,\xe2\x88\x92(6+7),8]=[5,\xe2\x88\x9213,8].After he will perform this operation n\xe2\x88\x921 times, Mans will end up having only one hero. He wants his power to be as big as possible. What\'s the largest possible power he can achieve?" 2700
1421D Hexagons "brute force,constructive algorithms,greedy,implementation,math,shortest paths" "Lindsey Buckingham told Stevie Nicks ""Go your own way"". Nicks is now sad and wants to go away as quickly as possible, but she lives in a 2D hexagonal world.Consider a hexagonal tiling of the plane as on the picture below.  Nicks wishes to go from the cell marked (0,0) to a certain cell given by the coordinates. She may go from a hexagon to any of its six neighbors you want, but there is a cost associated with each of them. The costs depend only on the direction in which you travel. Going from (0,0) to (1,1) will take the exact same cost as going from (\xe2\x88\x922,\xe2\x88\x921) to (\xe2\x88\x921,0). The costs are given in the input in the order c1, c2, c3, c4, c5, c6 as in the picture below.  Print the smallest cost of a path from the origin which has coordinates (0,0) to the given cell." 1900
1421C Palindromifier "constructive algorithms,strings" "Ringo found a string s of length n in his yellow submarine. The string contains only lowercase letters from the English alphabet. As Ringo and his friends love palindromes, he would like to turn the string s into a palindrome by applying two types of operations to the string. The first operation allows him to choose i (2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) and to append the substring s2s3\xe2\x80\xa6si (i\xe2\x88\x921 characters) reversed to the front of s.The second operation allows him to choose i (2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) and to append the substring sisi+1\xe2\x80\xa6sn\xe2\x88\x921 (n\xe2\x88\x92i characters) reversed to the end of s.Note that characters in the string in this problem are indexed from 1.For example suppose s=abcdef. If he performs the first operation with i=3 then he appends cb to the front of s and the result will be cbabcdef. Performing the second operation on the resulted string with i=5 will yield cbabcdefedc.Your task is to help Ringo make the entire string a palindrome by applying any of the two operations (in total) at most 30 times. The length of the resulting palindrome must not exceed 106It is guaranteed that under these constraints there always is a solution. Also note you do not have to minimize neither the number of operations applied, nor the length of the resulting string, but they have to fit into the constraints." 1400
1421B "Putting Bricks in the Wall" "constructive algorithms,implementation" "Pink Floyd are pulling a prank on Roger Waters. They know he doesn\'t like walls, he wants to be able to walk freely, so they are blocking him from exiting his room which can be seen as a grid.Roger Waters has a square grid of size n\xc3\x97n and he wants to traverse his grid from the upper left (1,1) corner to the lower right corner (n,n). Waters can move from a square to any other square adjacent by a side, as long as he is still in the grid. Also except for the cells (1,1) and (n,n) every cell has a value 0 or 1 in it.Before starting his traversal he will pick either a 0 or a 1 and will be able to only go to cells values in which are equal to the digit he chose. The starting and finishing cells (1,1) and (n,n) are exempt from this rule, he may go through them regardless of picked digit. Because of this the cell (1,1) takes value the letter \'S\' and the cell (n,n) takes value the letter \'F\'.For example, in the first example test case, he can go from (1,1) to (n,n) by using the zeroes on this path: (1,1), (2,1), (2,2), (2,3), (3,3), (3,4), (4,4)The rest of the band (Pink Floyd) wants Waters to not be able to do his traversal, so while he is not looking they will invert at most two cells in the grid (from 0 to 1 or vice versa). They are afraid they will not be quick enough and asked for your help in choosing the cells.  Note that you cannot invert cells (1,1) and (n,n).We can show that there always exists a solution for the given constraints.Also note that Waters will pick his digit of the traversal after the band has changed his grid, so he must not be able to reach (n,n) no matter what digit he picks." 1100
1421A XORwice bitmasks,greedy,math "In order to celebrate Twice\'s 5th anniversary, Tzuyu and Sana decided to play a game.Tzuyu gave Sana two integers a and b and a really important quest.In order to complete the quest, Sana has to output the smallest possible value of (a\xe2\x8a\x95x) + (b\xe2\x8a\x95x) for any given x, where \xe2\x8a\x95 denotes the bitwise XOR operation." 800
1420E "Battle Lemmings" dp,greedy "A lighthouse keeper Peter commands an army of n battle lemmings. He ordered his army to stand in a line and numbered the lemmings from 1 to n from left to right. Some of the lemmings hold shields. Each lemming cannot hold more than one shield.The more protected Peter\'s army is, the better. To calculate the protection of the army, he finds the number of protected pairs of lemmings, that is such pairs that both lemmings in the pair don\'t hold a shield, but there is a lemming with a shield between them.Now it\'s time to prepare for defence and increase the protection of the army. To do this, Peter can give orders. He chooses a lemming with a shield and gives him one of the two orders:   give the shield to the left neighbor if it exists and doesn\'t have a shield;  give the shield to the right neighbor if it exists and doesn\'t have a shield. In one second Peter can give exactly one order.It\'s not clear how much time Peter has before the defence. So he decided to determine the maximal value of army protection for each k from 0 to n(n\xe2\x88\x921)2, if he gives no more that k orders. Help Peter to calculate it!" 2500
1420D "Rescue Nibel!" "combinatorics,data structures,sortings" "Ori and Sein have overcome many difficult challenges. They finally lit the Shrouded Lantern and found Gumon Seal, the key to the Forlorn Ruins. When they tried to open the door to the ruins... nothing happened.Ori was very surprised, but Sein gave the explanation quickly: clever Gumon decided to make an additional defence for the door.There are n lamps with Spirit Tree\'s light. Sein knows the time of turning on and off for the i-th lamp \xe2\x80\x94 li and ri respectively. To open the door you have to choose k lamps in such a way that there will be a moment of time when they all will be turned on.While Sein decides which of the k lamps to pick, Ori is interested: how many ways there are to pick such k lamps that the door will open? It may happen that Sein may be wrong and there are no such k lamps. The answer might be large, so print it modulo 998244353." 1800
1420C2 "Pok\xc3\xa9mon Army (hard version)" "data structures,divide and conquer,dp,greedy,implementation" "This is the hard version of the problem. The difference between the versions is that the easy version has no swap operations. You can make hacks only if all versions of the problem are solved.Pikachu is a cute and friendly pok\xc3\xa9mon living in the wild pikachu herd.But it has become known recently that infamous team R wanted to steal all these pok\xc3\xa9mon! Pok\xc3\xa9mon trainer Andrew decided to help Pikachu to build a pok\xc3\xa9mon army to resist.First, Andrew counted all the pok\xc3\xa9mon \xe2\x80\x94 there were exactly n pikachu. The strength of the i-th pok\xc3\xa9mon is equal to ai, and all these numbers are distinct.As an army, Andrew can choose any non-empty subsequence of pokemons. In other words, Andrew chooses some array b from k indices such that 1\xe2\x89\xa4b1<b2<\xe2\x8b\xaf<bk\xe2\x89\xa4n, and his army will consist of pok\xc3\xa9mons with forces ab1,ab2,\xe2\x80\xa6,abk.The strength of the army is equal to the alternating sum of elements of the subsequence; that is, ab1\xe2\x88\x92ab2+ab3\xe2\x88\x92ab4+\xe2\x80\xa6.Andrew is experimenting with pok\xc3\xa9mon order. He performs q operations. In i-th operation Andrew swaps li-th and ri-th pok\xc3\xa9mon.Andrew wants to know the maximal stregth of the army he can achieve with the initial pok\xc3\xa9mon placement. He also needs to know the maximal strength after each operation.Help Andrew and the pok\xc3\xa9mon, or team R will realize their tricky plan!" 2100
1420C1 "Pok\xc3\xa9mon Army (easy version)" "constructive algorithms,dp,greedy" "This is the easy version of the problem. The difference between the versions is that the easy version has no swap operations. You can make hacks only if all versions of the problem are solved.Pikachu is a cute and friendly pok\xc3\xa9mon living in the wild pikachu herd.But it has become known recently that infamous team R wanted to steal all these pok\xc3\xa9mon! Pok\xc3\xa9mon trainer Andrew decided to help Pikachu to build a pok\xc3\xa9mon army to resist.First, Andrew counted all the pok\xc3\xa9mon \xe2\x80\x94 there were exactly n pikachu. The strength of the i-th pok\xc3\xa9mon is equal to ai, and all these numbers are distinct.As an army, Andrew can choose any non-empty subsequence of pokemons. In other words, Andrew chooses some array b from k indices such that 1\xe2\x89\xa4b1<b2<\xe2\x8b\xaf<bk\xe2\x89\xa4n, and his army will consist of pok\xc3\xa9mons with forces ab1,ab2,\xe2\x80\xa6,abk.The strength of the army is equal to the alternating sum of elements of the subsequence; that is, ab1\xe2\x88\x92ab2+ab3\xe2\x88\x92ab4+\xe2\x80\xa6.Andrew is experimenting with pok\xc3\xa9mon order. He performs q operations. In i-th operation Andrew swaps li-th and ri-th pok\xc3\xa9mon.Note: q=0 in this version of the task.Andrew wants to know the maximal stregth of the army he can achieve with the initial pok\xc3\xa9mon placement. He also needs to know the maximal strength after each operation.Help Andrew and the pok\xc3\xa9mon, or team R will realize their tricky plan!" 1300
1420B "Rock and Lever" bitmasks,math """You must lift the dam. With a lever. I will give it to you.You must block the canal. With a rock. I will not give the rock to you."" Danik urgently needs rock and lever! Obviously, the easiest way to get these things is to ask Hermit Lizard for them.Hermit Lizard agreed to give Danik the lever. But to get a stone, Danik needs to solve the following task.You are given a positive integer n, and an array a of positive integers. The task is to calculate the number of such pairs (i,j) that i<j and ai & aj\xe2\x89\xa5ai\xe2\x8a\x95aj, where & denotes the bitwise AND operation, and \xe2\x8a\x95 denotes the bitwise XOR operation.Danik has solved this task. But can you solve it?" 1200
1420A "Cubes Sorting" math,sortings "For god\'s sake, you\'re boxes with legs! It is literally your only purpose! Walking onto buttons! How can you not do the one thing you were designed for?Oh, that\'s funny, is it? Oh it\'s funny? Because we\'ve been at this for twelve hours and you haven\'t solved it either, so I don\'t know why you\'re laughing. You\'ve got one hour! Solve it!  Wheatley decided to try to make a test chamber. He made a nice test chamber, but there was only one detail absent \xe2\x80\x94 cubes.For completing the chamber Wheatley needs n cubes. i-th cube has a volume ai.Wheatley has to place cubes in such a way that they would be sorted in a non-decreasing order by their volume. Formally, for each i>1, ai\xe2\x88\x921\xe2\x89\xa4ai must hold.To achieve his goal, Wheatley can exchange two neighbouring cubes. It means that for any i>1 you can exchange cubes on positions i\xe2\x88\x921 and i.But there is a problem: Wheatley is very impatient. If Wheatley needs more than n\xe2\x8b\x85(n\xe2\x88\x921)2\xe2\x88\x921 exchange operations, he won\'t do this boring work.Wheatly wants to know: can cubes be sorted under this conditions?" 900
1419F "Rain of Fire" "binary search,data structures,dfs and similar,dsu,graphs,implementation" "There are n detachments on the surface, numbered from 1 to n, the i-th detachment is placed in a point with coordinates (xi,yi). All detachments are placed in different points.Brimstone should visit each detachment at least once. You can choose the detachment where Brimstone starts.To move from one detachment to another he should first choose one of four directions of movement (up, right, left or down) and then start moving with the constant speed of one unit interval in a second until he comes to a detachment. After he reaches an arbitrary detachment, he can repeat the same process.Each t seconds an orbital strike covers the whole surface, so at that moment Brimstone should be in a point where some detachment is located. He can stay with any detachment as long as needed.Brimstone is a good commander, that\'s why he can create at most one detachment and place it in any empty point with integer coordinates he wants before his trip. Keep in mind that Brimstone will need to visit this detachment, too.Help Brimstone and find such minimal t that it is possible to check each detachment. If there is no such t report about it." 2800
1419E Decryption "constructive algorithms,implementation,math,number theory" "An agent called Cypher is decrypting a message, that contains a composite number n. All divisors of n, which are greater than 1, are placed in a circle. Cypher can choose the initial order of numbers in the circle.In one move Cypher can choose two adjacent numbers in a circle and insert their least common multiple between them. He can do that move as many times as needed.A message is decrypted, if every two adjacent numbers are not coprime. Note that for such constraints it\'s always possible to decrypt the message.Find the minimal number of moves that Cypher should do to decrypt the message, and show the initial order of numbers in the circle for that." 2100
1419D2 "Sage\'s Birthday (hard version)" "binary search,brute force,constructive algorithms,greedy,sortings,two pointers" "This is the hard version of the problem. The difference between the versions is that in the easy version all prices ai are different. You can make hacks if and only if you solved both versions of the problem.Today is Sage\'s birthday, and she will go shopping to buy ice spheres. All n ice spheres are placed in a row and they are numbered from 1 to n from left to right. Each ice sphere has a positive integer price. In this version, some prices can be equal.An ice sphere is cheap if it costs strictly less than two neighboring ice spheres: the nearest to the left and the nearest to the right. The leftmost and the rightmost ice spheres are not cheap. Sage will choose all cheap ice spheres and then buy only them.You can visit the shop before Sage and reorder the ice spheres as you wish. Find out the maximum number of ice spheres that Sage can buy, and show how the ice spheres should be reordered." 1500
1419D1 "Sage\'s Birthday (easy version)" "binary search,constructive algorithms,greedy,sortings" "This is the easy version of the problem. The difference between the versions is that in the easy version all prices ai are different. You can make hacks if and only if you solved both versions of the problem.Today is Sage\'s birthday, and she will go shopping to buy ice spheres. All n ice spheres are placed in a row and they are numbered from 1 to n from left to right. Each ice sphere has a positive integer price. In this version all prices are different.An ice sphere is cheap if it costs strictly less than two neighboring ice spheres: the nearest to the left and the nearest to the right. The leftmost and the rightmost ice spheres are not cheap. Sage will choose all cheap ice spheres and then buy only them.You can visit the shop before Sage and reorder the ice spheres as you wish. Find out the maximum number of ice spheres that Sage can buy, and show how the ice spheres should be reordered." 1000
1419C Killjoy greedy,implementation,math "A new agent called Killjoy invented a virus COVID-2069 that infects accounts on Codeforces. Each account has a rating, described by an integer (it can possibly be negative or very large).Killjoy\'s account is already infected and has a rating equal to x. Its rating is constant. There are n accounts except hers, numbered from 1 to n. The i-th account\'s initial rating is ai. Any infected account (initially the only infected account is Killjoy\'s) instantly infects any uninfected account if their ratings are equal. This can happen at the beginning (before any rating changes) and after each contest. If an account is infected, it can not be healed.Contests are regularly held on Codeforces. In each contest, any of these n accounts (including infected ones) can participate. Killjoy can\'t participate. After each contest ratings are changed this way: each participant\'s rating is changed by an integer, but the sum of all changes must be equal to zero. New ratings can be any integer.Find out the minimal number of contests needed to infect all accounts. You can choose which accounts will participate in each contest and how the ratings will change.It can be proven that all accounts can be infected in some finite number of contests." 1500
1419B Stairs "brute force,constructive algorithms,greedy,implementation,math" "Jett is tired after destroying the town and she wants to have a rest. She likes high places, that\'s why for having a rest she wants to get high and she decided to craft staircases.A staircase is a squared figure that consists of square cells. Each staircase consists of an arbitrary number of stairs. If a staircase has n stairs, then it is made of n columns, the first column is 1 cell high, the second column is 2 cells high, \xe2\x80\xa6, the n-th column if n cells high. The lowest cells of all stairs must be in the same row.A staircase with n stairs is called nice, if it may be covered by n disjoint squares made of cells. All squares should fully consist of cells of a staircase. This is how a nice covered staircase with 7 stairs looks like:  Find out the maximal number of different nice staircases, that can be built, using no more than x cells, in total. No cell can be used more than once." 1200
1419A "Digit Game" games,greedy,implementation "Everyone knows that agents in Valorant decide, who will play as attackers, and who will play as defenders. To do that Raze and Breach decided to play t matches of a digit game...In each of t matches of the digit game, a positive integer is generated. It consists of n digits. The digits of this integer are numerated from 1 to n from the highest-order digit to the lowest-order digit. After this integer is announced, the match starts.Agents play in turns. Raze starts. In one turn an agent can choose any unmarked digit and mark it. Raze can choose digits on odd positions, but can not choose digits on even positions. Breach can choose digits on even positions, but can not choose digits on odd positions. The match ends, when there is only one unmarked digit left. If the single last digit is odd, then Raze wins, else Breach wins.It can be proved, that before the end of the match (for every initial integer with n digits) each agent has an ability to make a turn, i.e. there is at least one unmarked digit, that stands on a position of required parity.For each of t matches find out, which agent wins, if both of them want to win and play optimally." 900
1418G "Three Occurrences" "data structures,divide and conquer,hashing,two pointers" "You are given an array a consisting of n integers. We denote the subarray a[l..r] as the array [al,al+1,\xe2\x80\xa6,ar] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n).A subarray is considered good if every integer that occurs in this subarray occurs there exactly thrice. For example, the array [1,2,2,2,1,1,2,2,2] has three good subarrays:  a[1..6]=[1,2,2,2,1,1];  a[2..4]=[2,2,2];  a[7..9]=[2,2,2]. Calculate the number of good subarrays of the given array a." 2500
1418F "Equal Product" "data structures,math,number theory,two pointers" "You are given four integers n, m, l and r.Let\'s name a tuple (x1,y1,x2,y2) as good if:   1\xe2\x89\xa4x1<x2\xe2\x89\xa4n;  1\xe2\x89\xa4y2<y1\xe2\x89\xa4m;  x1\xe2\x8b\x85y1=x2\xe2\x8b\x85y2;  l\xe2\x89\xa4x1\xe2\x8b\x85y1\xe2\x89\xa4r. Find any good tuple for each x1 from 1 to n inclusive." 3000
1418E "Expected Damage" "binary search,combinatorics,probabilities" "You are playing a computer game. In this game, you have to fight n monsters.To defend from monsters, you need a shield. Each shield has two parameters: its current durability a and its defence rating b. Each monster has only one parameter: its strength d.When you fight a monster with strength d while having a shield with current durability a and defence b, there are three possible outcomes:  if a=0, then you receive d damage;  if a>0 and d\xe2\x89\xa5b, you receive no damage, but the current durability of the shield decreases by 1;  if a>0 and d<b, nothing happens. The i-th monster has strength di, and you will fight each of the monsters exactly once, in some random order (all n! orders are equiprobable). You have to consider m different shields, the i-th shield has initial durability ai and defence rating bi. For each shield, calculate the expected amount of damage you will receive if you take this shield and fight the given n monsters in random order." 2400
1418D "Trash Problem" "data structures,implementation" "Vova decided to clean his room. The room can be represented as the coordinate axis OX. There are n piles of trash in the room, coordinate of the i-th pile is the integer pi. All piles have different coordinates.Let\'s define a total cleanup as the following process. The goal of this process is to collect all the piles in no more than two different x coordinates. To achieve this goal, Vova can do several (possibly, zero) moves. During one move, he can choose some x and move all piles from x to x+1 or x\xe2\x88\x921 using his broom. Note that he can\'t choose how many piles he will move.Also, there are two types of queries:  0 x \xe2\x80\x94 remove a pile of trash from the coordinate x. It is guaranteed that there is a pile in the coordinate x at this moment.  1 x \xe2\x80\x94 add a pile of trash to the coordinate x. It is guaranteed that there is no pile in the coordinate x at this moment. Note that it is possible that there are zero piles of trash in the room at some moment.Vova wants to know the minimum number of moves he can spend if he wants to do a total cleanup before any queries. He also wants to know this number of moves after applying each query. Queries are applied in the given order. Note that the total cleanup doesn\'t actually happen and doesn\'t change the state of piles. It is only used to calculate the number of moves.For better understanding, please read the Notes section below to see an explanation for the first example." 2100
1418C "Mortal Kombat Tower" "dp,graphs,greedy,shortest paths" "You and your friend are playing the game Mortal Kombat XI. You are trying to pass a challenge tower. There are n bosses in this tower, numbered from 1 to n. The type of the i-th boss is ai. If the i-th boss is easy then its type is ai=0, otherwise this boss is hard and its type is ai=1.During one session, either you or your friend can kill one or two bosses (neither you nor your friend can skip the session, so the minimum number of bosses killed during one session is at least one). After your friend session, your session begins, then again your friend session begins, your session begins, and so on. The first session is your friend\'s session.Your friend needs to get good because he can\'t actually kill hard bosses. To kill them, he uses skip points. One skip point can be used to kill one hard boss.Your task is to find the minimum number of skip points your friend needs to use so you and your friend kill all n bosses in the given order.For example: suppose n=8, a=[1,0,1,1,0,1,1,1]. Then the best course of action is the following:  your friend kills two first bosses, using one skip point for the first boss;  you kill the third and the fourth bosses;  your friend kills the fifth boss;  you kill the sixth and the seventh bosses;  your friend kills the last boss, using one skip point, so the tower is completed using two skip points. You have to answer t independent test cases." 1500
1418B "Negative Prefixes" greedy,sortings "You are given an array a, consisting of n integers.Each position i (1\xe2\x89\xa4i\xe2\x89\xa4n) of the array is either locked or unlocked. You can take the values on the unlocked positions, rearrange them in any order and place them back into the unlocked positions. You are not allowed to remove any values, add the new ones or rearrange the values on the locked positions. You are allowed to leave the values in the same order as they were.For example, let a=[\xe2\x88\x921,1,3_,2,\xe2\x88\x922_,1,\xe2\x88\x924,0_], the underlined positions are locked. You can obtain the following arrays:   [\xe2\x88\x921,1,3_,2,\xe2\x88\x922_,1,\xe2\x88\x924,0_];  [\xe2\x88\x924,\xe2\x88\x921,3_,2,\xe2\x88\x922_,1,1,0_];  [1,\xe2\x88\x921,3_,2,\xe2\x88\x922_,1,\xe2\x88\x924,0_];  [1,2,3_,\xe2\x88\x921,\xe2\x88\x922_,\xe2\x88\x924,1,0_];  and some others. Let p be a sequence of prefix sums of the array a after the rearrangement. So p1=a1, p2=a1+a2, p3=a1+a2+a3, \xe2\x80\xa6, pn=a1+a2+\xe2\x8b\xaf+an.Let k be the maximum j (1\xe2\x89\xa4j\xe2\x89\xa4n) such that pj<0. If there are no j such that pj<0, then k=0.Your goal is to rearrange the values in such a way that k is minimum possible.Output the array a after the rearrangement such that the value k for it is minimum possible. If there are multiple answers then print any of them." 1300
1418A "Buying Torches" math "You are playing a very popular game called Cubecraft. Initially, you have one stick and want to craft k torches. One torch can be crafted using one stick and one coal.Hopefully, you\'ve met a very handsome wandering trader who has two trade offers:  exchange 1 stick for x sticks (you lose 1 stick and gain x sticks).  exchange y sticks for 1 coal (you lose y sticks and gain 1 coal). During one trade, you can use only one of these two trade offers. You can use each trade offer any number of times you want to, in any order.Your task is to find the minimum number of trades you need to craft at least k torches. The answer always exists under the given constraints.You have to answer t independent test cases." 1000
1417B "Two Arrays" greedy,math,sortings "RedDreamer has an array a consisting of n non-negative integers, and an unlucky integer T.Let\'s denote the misfortune of array b having length m as f(b) \xe2\x80\x94 the number of pairs of integers (i,j) such that 1\xe2\x89\xa4i<j\xe2\x89\xa4m and bi+bj=T. RedDreamer has to paint each element of a into one of two colors, white and black (for each element, the color is chosen independently), and then create two arrays c and d so that all white elements belong to c, and all black elements belong to d (it is possible that one of these two arrays becomes empty). RedDreamer wants to paint the elements in such a way that f(c)+f(d) is minimum possible.For example:  if n=6, T=7 and a=[1,2,3,4,5,6], it is possible to paint the 1-st, the 4-th and the 5-th elements white, and all other elements black. So c=[1,4,5], d=[2,3,6], and f(c)+f(d)=0+0=0;  if n=3, T=6 and a=[3,3,3], it is possible to paint the 1-st element white, and all other elements black. So c=[3], d=[3,3], and f(c)+f(d)=0+1=1. Help RedDreamer to paint the array optimally!" 1100
1417A Copy-paste greedy,math "\xe2\x80\x94 Hey folks, how do you like this problem?\xe2\x80\x94 That\'ll do it. BThero is a powerful magician. He has got n piles of candies, the i-th pile initially contains ai candies. BThero can cast a copy-paste spell as follows:   He chooses two piles (i,j) such that 1\xe2\x89\xa4i,j\xe2\x89\xa4n and i\xe2\x89\xa0j.  All candies from pile i are copied into pile j. Formally, the operation aj:=aj+ai is performed. BThero can cast this spell any number of times he wants to \xe2\x80\x94 but unfortunately, if some pile contains strictly more than k candies, he loses his magic power. What is the maximum number of times BThero can cast the spell without losing his power?" 800
1416F "Showing Off" "flows,graph matchings,greedy,implementation" "Another dull quarantine day was going by when BThero decided to start researching matrices of size n\xc3\x97m. The rows are numerated 1 through n from top to bottom, and the columns are numerated 1 through m from left to right. The cell in the i-th row and j-th column is denoted as (i,j).For each cell (i,j) BThero had two values:   The cost of the cell, which is a single positive integer.  The direction of the cell, which is one of characters L, R, D, U. Those characters correspond to transitions to adjacent cells (i,j\xe2\x88\x921), (i,j+1), (i+1,j) or (i\xe2\x88\x921,j), respectively. No transition pointed outside of the matrix. Let us call a cell (i2,j2) reachable from (i1,j1), if, starting from (i1,j1) and repeatedly moving to the adjacent cell according to our current direction, we will, sooner or later, visit (i2,j2). BThero decided to create another matrix from the existing two. For a cell (i,j), let us denote Si,j as a set of all reachable cells from it (including (i,j) itself). Then, the value at the cell (i,j) in the new matrix will be equal to the sum of costs of all cells in Si,j. After quickly computing the new matrix, BThero immediately sent it to his friends. However, he did not save any of the initial matrices! Help him to restore any two valid matrices, which produce the current one." 3300
1416E Split "binary search,data structures,dp,greedy" "One day, BThero decided to play around with arrays and came up with the following problem:You are given an array a, which consists of n positive integers. The array is numerated 1 through n. You execute the following procedure exactly once:  You create a new array b which consists of 2n positive integers, where for each 1\xe2\x89\xa4i\xe2\x89\xa4n the condition b2i\xe2\x88\x921+b2i=ai holds. For example, for the array a=[6,8,2] you can create b=[2,4,4,4,1,1].  You merge consecutive equal numbers in b. For example, b=[2,4,4,4,1,1] becomes b=[2,4,1]. Find and print the minimum possible value of |b| (size of b) which can be achieved at the end of the procedure. It can be shown that under the given constraints there is at least one way to construct b." 3200
1416D "Graph and Queries" "data structures,dsu,graphs,implementation,trees" "You are given an undirected graph consisting of n vertices and m edges. Initially there is a single integer written on every vertex: the vertex i has pi written on it. All pi are distinct integers from 1 to n.You have to process q queries of two types:  1 v \xe2\x80\x94 among all vertices reachable from the vertex v using the edges of the graph (including the vertex v itself), find a vertex u with the largest number pu written on it, print pu and replace pu with 0;  2 i \xe2\x80\x94 delete the i-th edge from the graph.  Note that, in a query of the first type, it is possible that all vertices reachable from v have 0 written on them. In this case, u is not explicitly defined, but since the selection of u does not affect anything, you can choose any vertex reachable from v and print its value (which is 0)." 2600
1416C "XOR Inverse" "bitmasks,data structures,divide and conquer,dp,greedy,math,sortings,strings,trees" "You are given an array a consisting of n non-negative integers. You have to choose a non-negative integer x and form a new array b of size n according to the following rule: for all i from 1 to n, bi=ai\xe2\x8a\x95x (\xe2\x8a\x95 denotes the operation bitwise XOR).An inversion in the b array is a pair of integers i and j such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n and bi>bj.You should choose x in such a way that the number of inversions in b is minimized. If there are several options for x \xe2\x80\x94 output the smallest one." 2000
1416B "Make Them Equal" "constructive algorithms,greedy,math" "You are given an array a consisting of n positive integers, numbered from 1 to n. You can perform the following operation no more than 3n times:  choose three integers i, j and x (1\xe2\x89\xa4i,j\xe2\x89\xa4n; 0\xe2\x89\xa4x\xe2\x89\xa4109);  assign ai:=ai\xe2\x88\x92x\xe2\x8b\x85i, aj:=aj+x\xe2\x8b\x85i. After each operation, all elements of the array should be non-negative.Can you find a sequence of no more than 3n operations after which all elements of the array are equal?" 2000
1416A "k-Amazing Numbers" "binary search,data structures,implementation,two pointers" "You are given an array a consisting of n integers numbered from 1 to n.Let\'s define the k-amazing number of the array as the minimum number that occurs in all of the subsegments of the array having length k (recall that a subsegment of a of length k is a contiguous part of a containing exactly k elements). If there is no integer occuring in all subsegments of length k for some value of k, then the k-amazing number is \xe2\x88\x921.For each k from 1 to n calculate the k-amazing number of the array a." 1500
1415F "Cakes for Clones" dp "You live on a number line. You are initially (at time moment t=0) located at point x=0. There are n events of the following type: at time ti a small cake appears at coordinate xi. To collect this cake, you have to be at this coordinate at this point, otherwise the cake spoils immediately. No two cakes appear at the same time and no two cakes appear at the same coordinate.You can move with the speed of 1 length unit per one time unit. Also, at any moment you can create a clone of yourself at the same point where you are located. The clone can\'t move, but it will collect the cakes appearing at this position for you. The clone disappears when you create another clone. If the new clone is created at time moment t, the old clone can collect the cakes that appear before or at the time moment t, and the new clone can collect the cakes that appear at or after time moment t.Can you collect all the cakes (by yourself or with the help of clones)?" 2900
1415E "New Game Plus!" "constructive algorithms,greedy,math" "Wabbit is playing a game with n bosses numbered from 1 to n. The bosses can be fought in any order. Each boss needs to be defeated exactly once. There is a parameter called boss bonus which is initially 0.When the i-th boss is defeated, the current boss bonus is added to Wabbit\'s score, and then the value of the boss bonus increases by the point increment ci. Note that ci can be negative, which means that other bosses now give fewer points.However, Wabbit has found a glitch in the game. At any point in time, he can reset the playthrough and start a New Game Plus playthrough. This will set the current boss bonus to 0, while all defeated bosses remain defeated. The current score is also saved and does not reset to zero after this operation. This glitch can be used at most k times. He can reset after defeating any number of bosses (including before or after defeating all of them), and he also can reset the game several times in a row without defeating any boss.Help Wabbit determine the maximum score he can obtain if he has to defeat all n bosses." 2200
1415D XOR-gun "bitmasks,brute force,constructive algorithms" "Arkady owns a non-decreasing array a1,a2,\xe2\x80\xa6,an. You are jealous of its beauty and want to destroy this property. You have a so-called XOR-gun that you can use one or more times.In one step you can select two consecutive elements of the array, let\'s say x and y, remove them from the array and insert the integer x\xe2\x8a\x95y on their place, where \xe2\x8a\x95 denotes the bitwise XOR operation. Note that the length of the array decreases by one after the operation. You can\'t perform this operation when the length of the array reaches one.For example, if the array is [2,5,6,8], you can select 5 and 6 and replace them with 5\xe2\x8a\x956=3. The array becomes [2,3,8].You want the array no longer be non-decreasing. What is the minimum number of steps needed? If the array stays non-decreasing no matter what you do, print \xe2\x88\x921." 2000
1415C "Bouncing Ball" "brute force,dp,implementation" "You\'re creating a game level for some mobile game. The level should contain some number of cells aligned in a row from left to right and numbered with consecutive integers starting from 1, and in each cell you can either put a platform or leave it empty.In order to pass a level, a player must throw a ball from the left so that it first lands on a platform in the cell p, then bounces off it, then bounces off a platform in the cell (p+k), then a platform in the cell (p+2k), and so on every k-th platform until it goes farther than the last cell. If any of these cells has no platform, you can\'t pass the level with these p and k.You already have some level pattern a1, a2, a3, ..., an, where ai=0 means there is no platform in the cell i, and ai=1 means there is one. You want to modify it so that the level can be passed with given p and k. In x seconds you can add a platform in some empty cell. In y seconds you can remove the first cell completely, reducing the number of cells by one, and renumerating the other cells keeping their order. You can\'t do any other operation. You can not reduce the number of cells to less than p.  Illustration for the third example test case. Crosses mark deleted cells. Blue platform is the newly added. What is the minimum number of seconds you need to make this level passable with given p and k?" 1400
1415B "Repainting Street" "brute force,brute force,greedy" "There is a street with n houses in a line, numbered from 1 to n. The house i is initially painted in color ci. The street is considered beautiful if all houses are painted in the same color. Tom, the painter, is in charge of making the street beautiful. Tom\'s painting capacity is defined by an integer, let\'s call it k.On one day, Tom can do the following repainting process that consists of two steps:   He chooses two integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and r\xe2\x88\x92l+1=k.  For each house i such that l\xe2\x89\xa4i\xe2\x89\xa4r, he can either repaint it with any color he wants, or ignore it and let it keep its current color. Note that in the same day Tom can use different colors to repaint different houses.Tom wants to know the minimum number of days needed to repaint the street so that it becomes beautiful." 1100
1415A "Prison Break" "brute force,math" "There is a prison that can be represented as a rectangular matrix with n rows and m columns. Therefore, there are n\xe2\x8b\x85m prison cells. There are also n\xe2\x8b\x85m prisoners, one in each prison cell. Let\'s denote the cell in the i-th row and the j-th column as (i,j).There\'s a secret tunnel in the cell (r,c), that the prisoners will use to escape! However, to avoid the risk of getting caught, they will escape at night.Before the night, every prisoner is in his own cell. When night comes, they can start moving to adjacent cells. Formally, in one second, a prisoner located in cell (i,j) can move to cells (i\xe2\x88\x921,j) , (i+1,j) , (i,j\xe2\x88\x921) , or (i,j+1), as long as the target cell is inside the prison. They can also choose to stay in cell (i,j).The prisoners want to know the minimum number of seconds needed so that every prisoner can arrive to cell (r,c) if they move optimally. Note that there can be any number of prisoners in the same cell at the same time." 800
1413F "Roads and Ramen" "data structures,trees" "In the Land of Fire there are n villages and n\xe2\x88\x921 bidirectional road, and there is a path between any pair of villages by roads. There are only two types of roads: stone ones and sand ones. Since the Land of Fire is constantly renovating, every morning workers choose a single road and flip its type (so it becomes a stone road if it was a sand road and vice versa). Also everyone here loves ramen, that\'s why every morning a ramen pavilion is set in the middle of every stone road, and at the end of each day all the pavilions are removed.For each of the following m days, after another road is flipped, Naruto and Jiraiya choose a simple path \xe2\x80\x94 that is, a route which starts in a village and ends in a (possibly, the same) village, and doesn\'t contain any road twice. Since Naruto and Jiraiya also love ramen very much, they buy a single cup of ramen on each stone road and one of them eats it. Since they don\'t want to offend each other, they only choose routes where they can eat equal number of ramen cups. Since they both like traveling, they choose any longest possible path. After every renovation find the maximal possible length of a path (that is, the number of roads in it) they can follow." 2800
1413E "Solo mid Oracle" "greedy,math,ternary search" "Meka-Naruto plays a computer game. His character has the following ability: given an enemy hero, deal a instant damage to him, and then heal that enemy b health points at the end of every second, for exactly c seconds, starting one second after the ability is used. That means that if the ability is used at time t, the enemy\'s health decreases by a at time t, and then increases by b at time points t+1, t+2, ..., t+c due to this ability.The ability has a cooldown of d seconds, i. e. if Meka-Naruto uses it at time moment t, next time he can use it is the time t+d. Please note that he can only use the ability at integer points in time, so all changes to the enemy\'s health also occur at integer times only.The effects from different uses of the ability may stack with each other; that is, the enemy which is currently under k spells gets k\xe2\x8b\x85b amount of heal this time. Also, if several health changes occur at the same moment, they are all counted at once.Now Meka-Naruto wonders if he can kill the enemy by just using the ability each time he can (that is, every d seconds). The enemy is killed if their health points become 0 or less. Assume that the enemy\'s health is not affected in any way other than by Meka-Naruto\'s character ability. What is the maximal number of health points the enemy can have so that Meka-Naruto is able to kill them?" 2100
1413D Shurikens "data structures,greedy,implementation" "Tenten runs a weapon shop for ninjas. Today she is willing to sell n shurikens which cost 1, 2, ..., n ryo (local currency). During a day, Tenten will place the shurikens onto the showcase, which is empty at the beginning of the day. Her job is fairly simple: sometimes Tenten places another shuriken (from the available shurikens) on the showcase, and sometimes a ninja comes in and buys a shuriken from the showcase. Since ninjas are thrifty, they always buy the cheapest shuriken from the showcase.Tenten keeps a record for all events, and she ends up with a list of the following types of records:  + means that she placed another shuriken on the showcase;  - x means that the shuriken of price x was bought. Today was a lucky day, and all shurikens were bought. Now Tenten wonders if her list is consistent, and what could be a possible order of placing the shurikens on the showcase. Help her to find this out!" 1700
1413C "Perform Easily" "binary search,brute force,dp,implementation,sortings,two pointers" "After battling Shikamaru, Tayuya decided that her flute is too predictable, and replaced it with a guitar. The guitar has 6 strings and an infinite number of frets numbered from 1. Fretting the fret number j on the i-th string produces the note ai+j.Tayuya wants to play a melody of n notes. Each note can be played on different string-fret combination. The easiness of performance depends on the difference between the maximal and the minimal indices of used frets. The less this difference is, the easier it is to perform the technique. Please determine the minimal possible difference.For example, if a=[1,1,2,2,3,3], and the sequence of notes is 4,11,11,12,12,13,13 (corresponding to the second example), we can play the first note on the first string, and all the other notes on the sixth string. Then the maximal fret will be 10, the minimal one will be 3, and the answer is 10\xe2\x88\x923=7, as shown on the picture." 1900
1413B "A New Technique" implementation "All techniques in the ninja world consist of hand seals. At the moment Naruto is learning a new technique, which consists of n\xe2\x8b\x85m different seals, denoted by distinct numbers. All of them were written in an n\xc3\x97m table.The table is lost now. Naruto managed to remember elements of each row from left to right, and elements of each column from top to bottom, but he doesn\'t remember the order of rows and columns. Please restore the table consistent with this data so that Naruto will be able to learn the new technique." 1100
1413A "Finding Sasuke" "constructive algorithms,math" "Naruto has sneaked into the Orochimaru\'s lair and is now looking for Sasuke. There are T rooms there. Every room has a door into it, each door can be described by the number n of seals on it and their integer energies a1, a2, ..., an. All energies ai are nonzero and do not exceed 100 by absolute value. Also, n is even.In order to open a door, Naruto must find such n seals with integer energies b1, b2, ..., bn that the following equality holds: a1\xe2\x8b\x85b1+a2\xe2\x8b\x85b2+...+an\xe2\x8b\x85bn=0. All bi must be nonzero as well as ai are, and also must not exceed 100 by absolute value. Please find required seals for every room there." 800
1411G "No Game No Life" bitmasks,games,math,matrices "Let\'s consider the following game of Alice and Bob on a directed acyclic graph. Each vertex may contain an arbitrary number of chips. Alice and Bob make turns alternating. Alice goes first. In one turn player can move exactly one chip along any edge outgoing from the vertex that contains this chip to the end of this edge. The one who cannot make a turn loses. Both players play optimally.Consider the following process that takes place every second on a given graph with n vertices:   An integer v is chosen equiprobably from [1,n+1].  If v\xe2\x89\xa4n, we add a chip to the v-th vertex and go back to step 1.  If v=n+1, Alice and Bob play the game with the current arrangement of chips and the winner is determined. After that, the process is terminated. Find the probability that Alice will win the game. It can be shown that the answer can be represented as PQ, where P and Q are coprime integers and Q\xe2\x89\xa20(mod998244353). Print the value of P\xe2\x8b\x85Q\xe2\x88\x921mod998244353." 2700
1411F "The Thorny Path" greedy,math "According to a legend the Hanoi Temple holds a permutation of integers from 1 to n. There are n stones of distinct colors lying in one line in front of the temple. Monks can perform the following operation on stones: choose a position i (1\xe2\x89\xa4i\xe2\x89\xa4n) and cyclically shift stones at positions i, p[i], p[p[i]], .... That is, a stone from position i will move to position p[i], a stone from position p[i] will move to position p[p[i]], and so on, a stone from position j, such that p[j]=i, will move to position i.Each day the monks must obtain a new arrangement of stones using an arbitrary number of these operations. When all possible arrangements will have been obtained, the world will end. You are wondering, what if some elements of the permutation could be swapped just before the beginning? How many days would the world last?You want to get a permutation that will allow the world to last as long as possible, using the minimum number of exchanges of two elements of the permutation.Two arrangements of stones are considered different if there exists a position i such that the colors of the stones on that position are different in these arrangements." 3000
1411E "Poman Numbers" bitmasks,greedy,math,strings "You\'ve got a string S consisting of n lowercase English letters from your friend. It turned out that this is a number written in poman numerals. The poman numeral system is long forgotten. All that\'s left is the algorithm to transform number from poman numerals to the numeral system familiar to us. Characters of S are numbered from 1 to n from left to right. Let\'s denote the value of S as f(S), it is defined as follows:   If |S|>1, an arbitrary integer m (1\xe2\x89\xa4m<|S|) is chosen, and it is defined that f(S)=\xe2\x88\x92f(S[1,m])+f(S[m+1,|S|]), where S[l,r] denotes the substring of S from the l-th to the r-th position, inclusively.  Otherwise S=c, where c is some English letter. Then f(S)=2pos(c), where pos(c) is the position of letter c in the alphabet (pos(a)=0, pos(z)=25). Note that m is chosen independently on each step.Your friend thinks it is possible to get f(S)=T by choosing the right m on every step. Is he right?" 2300
1411D "Grime Zoo" "brute force,greedy,implementation,strings" "Currently, XXOC\'s rap is a string consisting of zeroes, ones, and question marks. Unfortunately, haters gonna hate. They will write x angry comments for every occurrence of subsequence 01 and y angry comments for every occurrence of subsequence 10. You should replace all the question marks with 0 or 1 in such a way that the number of angry comments would be as small as possible.String b is a subsequence of string a, if it can be obtained by removing some characters from a. Two occurrences of a subsequence are considered distinct if sets of positions of remaining characters are distinct." 2100
1411C "Peaceful Rooks" "dfs and similar,dsu,graphs" "You are given a n\xc3\x97n chessboard. Rows and columns of the board are numbered from 1 to n. Cell (x,y) lies on the intersection of column number x and row number y.Rook is a chess piece, that can in one turn move any number of cells vertically or horizontally. There are m rooks (m<n) placed on the chessboard in such a way that no pair of rooks attack each other. I.e. there are no pair of rooks that share a row or a column.In one turn you can move one of the rooks any number of cells vertically or horizontally. Additionally, it shouldn\'t be attacked by any other rook after movement. What is the minimum number of moves required to place all the rooks on the main diagonal?The main diagonal of the chessboard is all the cells (i,i), where 1\xe2\x89\xa4i\xe2\x89\xa4n." 1700
1411B "Fair Numbers" "brute force,number theory" "We call a positive integer number fair if it is divisible by each of its nonzero digits. For example, 102 is fair (because it is divisible by 1 and 2), but 282 is not, because it isn\'t divisible by 8. Given a positive integer n. Find the minimum integer x, such that n\xe2\x89\xa4x and x is fair." 1000
1411A "In-game Chat" implementation "You have been assigned to develop a filter for bad messages in the in-game chat. A message is a string S of length n, consisting of lowercase English letters and characters \')\'. The message is bad if the number of characters \')\' at the end of the string strictly greater than the number of remaining characters. For example, the string "")bc)))"" has three parentheses at the end, three remaining characters, and is not considered bad." 800
1409F "Subsequences of Length Two" dp,strings "You are given two strings s and t consisting of lowercase Latin letters. The length of t is 2 (i.e. this string consists only of two characters).In one move, you can choose any character of s and replace it with any lowercase Latin letter. More formally, you choose some i and replace si (the character at the position i) with some character from \'a\' to \'z\'.You want to do no more than k replacements in such a way that maximizes the number of occurrences of t in s as a subsequence.Recall that a subsequence is a sequence that can be derived from the given sequence by deleting zero or more elements without changing the order of the remaining elements." 2100
1409E "Two Platforms" "binary search,dp,sortings,two pointers" "There are n points on a plane. The i-th point has coordinates (xi,yi). You have two horizontal platforms, both of length k. Each platform can be placed anywhere on a plane but it should be placed horizontally (on the same y-coordinate) and have integer borders. If the left border of the platform is (x,y) then the right border is (x+k,y) and all points between borders (including borders) belong to the platform.Note that platforms can share common points (overlap) and it is not necessary to place both platforms on the same y-coordinate.When you place both platforms on a plane, all points start falling down decreasing their y-coordinate. If a point collides with some platform at some moment, the point stops and is saved. Points which never collide with any platform are lost.Your task is to find the maximum number of points you can save if you place both platforms optimally.You have to answer t independent test cases.For better understanding, please read the Note section below to see a picture for the first test case." 1800
1409D "Decrease the Sum of Digits" greedy,math "You are given a positive integer n. In one move, you can increase n by one (i.e. make n:=n+1). Your task is to find the minimum number of moves you need to perform in order to make the sum of digits of n be less than or equal to s.You have to answer t independent test cases." 1500
1409C "Yet Another Array Restoration" "brute force,math,number theory" "We have a secret array. You don\'t know this array and you have to restore it. However, you know some facts about this array:  The array consists of n distinct positive (greater than 0) integers.  The array contains two elements x and y (these elements are known for you) such that x<y.  If you sort the array in increasing order (such that a1<a2<\xe2\x80\xa6<an), differences between all adjacent (consecutive) elements are equal (i.e. a2\xe2\x88\x92a1=a3\xe2\x88\x92a2=\xe2\x80\xa6=an\xe2\x88\x92an\xe2\x88\x921). It can be proven that such an array always exists under the constraints given below.Among all possible arrays that satisfy the given conditions, we ask you to restore one which has the minimum possible maximum element. In other words, you have to minimize max(a1,a2,\xe2\x80\xa6,an).You have to answer t independent test cases." 1200
1409B "Minimum Product" "brute force,greedy,math" "You are given four integers a, b, x and y. Initially, a\xe2\x89\xa5x and b\xe2\x89\xa5y. You can do the following operation no more than n times:  Choose either a or b and decrease it by one. However, as a result of this operation, value of a cannot become less than x, and value of b cannot become less than y. Your task is to find the minimum possible product of a and b (a\xe2\x8b\x85b) you can achieve by applying the given operation no more than n times.You have to answer t independent test cases." 1100
1409A "Yet Another Two Integers Problem" greedy,math "You are given two integers a and b.In one move, you can choose some integer k from 1 to 10 and add it to a or subtract it from a. In other words, you choose an integer k\xe2\x88\x88[1;10] and perform a:=a+k or a:=a\xe2\x88\x92k. You may use different values of k in different moves.Your task is to find the minimum number of moves required to obtain b from a.You have to answer t independent test cases." 800
1408I "Bitwise Magic" dp,math "You are given a positive integer k and an array a1,a2,\xe2\x80\xa6,an of non-negative distinct integers not smaller than k and not greater than 2c\xe2\x88\x921.In each of the next k seconds, one element is chosen randomly equiprobably out of all n elements and decreased by 1.For each integer x, 0\xe2\x89\xa4x\xe2\x89\xa42c\xe2\x88\x921, you need to find the probability that in the end the bitwise XOR of all elements of the array is equal to x. Each of these values can be represented as an irreducible fraction pq, and you need to find the value of p\xe2\x8b\x85q\xe2\x88\x921 modulo 998244353." 3200
1408H "Rainbow Triples" "binary search,data structures,flows,greedy" "You are given a sequence a1,a2,\xe2\x80\xa6,an of non-negative integers.You need to find the largest number m of triples (i1,j1,k1), (i2,j2,k2), ..., (im,jm,km) such that: 1\xe2\x89\xa4ip<jp<kp\xe2\x89\xa4n for each p in 1,2,\xe2\x80\xa6,m; aip=akp=0, ajp\xe2\x89\xa00; all aj1,aj2,\xe2\x80\xa6,ajm are different; all i1,j1,k1,i2,j2,k2,\xe2\x80\xa6,im,jm,km are different." 3300
1408G "Clusterization Counting" combinatorics,dp,dsu,fft,graphs,trees "There are n computers in the company network. They are numbered from 1 to n.For each pair of two computers 1\xe2\x89\xa4i<j\xe2\x89\xa4n you know the value ai,j: the difficulty of sending data between computers i and j. All values ai,j for i<j are different.You want to separate all computers into k sets A1,A2,\xe2\x80\xa6,Ak, such that the following conditions are satisfied:   for each computer 1\xe2\x89\xa4i\xe2\x89\xa4n there is exactly one set Aj, such that i\xe2\x88\x88Aj;  for each two pairs of computers (s,f) and (x,y) (s\xe2\x89\xa0f, x\xe2\x89\xa0y), such that s, f, x are from the same set but x and y are from different sets, as,f<ax,y. For each 1\xe2\x89\xa4k\xe2\x89\xa4n find the number of ways to divide computers into k groups, such that all required conditions are satisfied. These values can be large, so you need to find them by modulo 998244353." 2700
1408F "Two Different" "constructive algorithms,divide and conquer" "You are given an integer n.You should find a list of pairs (x1,y1), (x2,y2), ..., (xq,yq) (1\xe2\x89\xa4xi,yi\xe2\x89\xa4n) satisfying the following condition.Let\'s consider some function f:N\xc3\x97N\xe2\x86\x92N (we define N as the set of positive integers). In other words, f is a function that returns a positive integer for a pair of positive integers.Let\'s make an array a1,a2,\xe2\x80\xa6,an, where ai=i initially.You will perform q operations, in i-th of them you will:   assign t=f(axi,ayi) (t is a temporary variable, it is used only for the next two assignments);  assign axi=t;  assign ayi=t. In other words, you need to simultaneously change axi and ayi to f(axi,ayi). Note that during this process f(p,q) is always the same for a fixed pair of p and q.In the end, there should be at most two different numbers in the array a.It should be true for any function f.Find any possible list of pairs. The number of pairs should not exceed 5\xe2\x8b\x85105." 2300
1408E "Avoid Rainbow Cycles" "data structures,dsu,graphs,greedy,sortings,trees" "You are given m sets of integers A1,A2,\xe2\x80\xa6,Am; elements of these sets are integers between 1 and n, inclusive.There are two arrays of positive integers a1,a2,\xe2\x80\xa6,am and b1,b2,\xe2\x80\xa6,bn. In one operation you can delete an element j from the set Ai and pay ai+bj coins for that.You can make several (maybe none) operations (some sets can become empty).After that, you will make an edge-colored undirected graph consisting of n vertices. For each set Ai you will add an edge (x,y) with color i for all x,y\xe2\x88\x88Ai and x<y. Some pairs of vertices can be connected with more than one edge, but such edges have different colors.You call a cycle i1\xe2\x86\x92e1\xe2\x86\x92i2\xe2\x86\x92e2\xe2\x86\x92\xe2\x80\xa6\xe2\x86\x92ik\xe2\x86\x92ek\xe2\x86\x92i1 (ej is some edge connecting vertices ij and ij+1 in this graph) rainbow if all edges on it have different colors.Find the minimum number of coins you should pay to get a graph without rainbow cycles." 2400
1408D Searchlights "binary search,brute force,data structures,dp,implementation,sortings,two pointers" "There are n robbers at coordinates (a1,b1), (a2,b2), ..., (an,bn) and m searchlight at coordinates (c1,d1), (c2,d2), ..., (cm,dm). In one move you can move each robber to the right (increase ai of each robber by one) or move each robber up (increase bi of each robber by one). Note that you should either increase all ai or all bi, you can\'t increase ai for some points and bi for some other points.Searchlight j can see a robber i if ai\xe2\x89\xa4cj and bi\xe2\x89\xa4dj. A configuration of robbers is safe if no searchlight can see a robber (i.e. if there is no pair i,j such that searchlight j can see a robber i).What is the minimum number of moves you need to perform to reach a safe configuration?" 2000
1408C "Discrete Acceleration" "binary search,dp,implementation,math,two pointers" "There is a road with length l meters. The start of the road has coordinate 0, the end of the road has coordinate l.There are two cars, the first standing at the start of the road and the second standing at the end of the road. They will start driving simultaneously. The first car will drive from the start to the end and the second car will drive from the end to the start.Initially, they will drive with a speed of 1 meter per second. There are n flags at different coordinates a1,a2,\xe2\x80\xa6,an. Each time when any of two cars drives through a flag, the speed of that car increases by 1 meter per second.Find how long will it take for cars to meet (to reach the same coordinate)." 1500
1408B "Arrays Sum" "constructive algorithms,greedy,math" "You are given a non-decreasing array of non-negative integers a1,a2,\xe2\x80\xa6,an. Also you are given a positive integer k.You want to find m non-decreasing arrays of non-negative integers b1,b2,\xe2\x80\xa6,bm, such that:  The size of bi is equal to n for all 1\xe2\x89\xa4i\xe2\x89\xa4m.  For all 1\xe2\x89\xa4j\xe2\x89\xa4n, aj=b1,j+b2,j+\xe2\x80\xa6+bm,j. In the other word, array a is the sum of arrays bi.  The number of different elements in the array bi is at most k for all 1\xe2\x89\xa4i\xe2\x89\xa4m. Find the minimum possible value of m, or report that there is no possible m." 1400
1408A "Circle Coloring" "constructive algorithms" "You are given three sequences: a1,a2,\xe2\x80\xa6,an; b1,b2,\xe2\x80\xa6,bn; c1,c2,\xe2\x80\xa6,cn.For each i, ai\xe2\x89\xa0bi, ai\xe2\x89\xa0ci, bi\xe2\x89\xa0ci.Find a sequence p1,p2,\xe2\x80\xa6,pn, that satisfy the following conditions: pi\xe2\x88\x88{ai,bi,ci} pi\xe2\x89\xa0p(imodn)+1.In other words, for each element, you need to choose one of the three possible values, such that no two adjacent elements (where we consider elements i,i+1 adjacent for i<n and also elements 1 and n) will have equal value.It can be proved that in the given constraints solution always exists. You don\'t need to minimize/maximize anything, you need to find any proper sequence." 800
1407E "Egor in the Republic of Dagestan" "constructive algorithms,dfs and similar,dp,graphs,greedy,shortest paths" "Egor is a famous Russian singer, rapper, actor and blogger, and finally he decided to give a concert in the sunny Republic of Dagestan.There are n cities in the republic, some of them are connected by m directed roads without any additional conditions. In other words, road system of Dagestan represents an arbitrary directed graph. Egor will arrive to the city 1, travel to the city n by roads along some path, give a concert and fly away.As any famous artist, Egor has lots of haters and too annoying fans, so he can travel only by safe roads. There are two types of the roads in Dagestan, black and white: black roads are safe at night only, and white roads \xe2\x80\x94 in the morning. Before the trip Egor\'s manager\'s going to make a schedule: for each city he\'ll specify it\'s color, black or white, and then if during the trip they visit some city, the only time they can leave it is determined by the city\'s color: night, if it\'s black, and morning, if it\'s white. After creating the schedule Egor chooses an available path from 1 to n, and for security reasons it has to be the shortest possible.Egor\'s manager likes Dagestan very much and wants to stay here as long as possible, so he asks you to make such schedule that there would be no path from 1 to n or the shortest path\'s length would be greatest possible.A path is one city or a sequence of roads such that for every road (excluding the first one) the city this road goes from is equal to the city previous road goes into. Egor can move only along paths consisting of safe roads only. The path length is equal to the number of roads in it. The shortest path in a graph is a path with smallest length." 2500
1407D "Discrete Centrifugal Jumps" "data structures,dp,graphs" "There are n beautiful skyscrapers in New York, the height of the i-th one is hi. Today some villains have set on fire first n\xe2\x88\x921 of them, and now the only safety building is n-th skyscraper.Let\'s call a jump from i-th skyscraper to j-th (i<j) discrete, if all skyscrapers between are strictly lower or higher than both of them. Formally, jump is discrete, if i<j and one of the following conditions satisfied:   i+1=j  max(hi+1,\xe2\x80\xa6,hj\xe2\x88\x921)<min(hi,hj)  max(hi,hj)<min(hi+1,\xe2\x80\xa6,hj\xe2\x88\x921). At the moment, Vasya is staying on the first skyscraper and wants to live a little longer, so his goal is to reach n-th skyscraper with minimal count of discrete jumps. Help him with calcualting this number." 2200
1407C "Chocolate Bunny" "constructive algorithms,interactive,math,two pointers" "This is an interactive problem.We hid from you a permutation p of length n, consisting of the elements from 1 to n. You want to guess it. To do that, you can give us 2 different indices i and j, and we will reply with pimodpj (remainder of division pi by pj).We have enough patience to answer at most 2\xe2\x8b\x85n queries, so you should fit in this constraint. Can you do it?As a reminder, a permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1600
1407B "Big Vova" "brute force,greedy,math,number theory" "Alexander is a well-known programmer. Today he decided to finally go out and play football, but with the first hit he left a dent on the new Rolls-Royce of the wealthy businessman Big Vova. Vladimir has recently opened a store on the popular online marketplace ""Zmey-Gorynych"", and offers Alex a job: if he shows his programming skills by solving a task, he\'ll work as a cybersecurity specialist. Otherwise, he\'ll be delivering some doubtful products for the next two years.You\'re given n positive integers a1,a2,\xe2\x80\xa6,an. Using each of them exactly at once, you\'re to make such sequence b1,b2,\xe2\x80\xa6,bn that sequence c1,c2,\xe2\x80\xa6,cn is lexicographically maximal, where ci=GCD(b1,\xe2\x80\xa6,bi) - the greatest common divisor of the first i elements of b. Alexander is really afraid of the conditions of this simple task, so he asks you to solve it.A sequence a is lexicographically smaller than a sequence b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the sequence a has a smaller element than the corresponding element in b." 1300
1407A Ahahahahahahahaha "constructive algorithms,math" "Alexandra has an even-length array a, consisting of 0s and 1s. The elements of the array are enumerated from 1 to n. She wants to remove at most n2 elements (where n \xe2\x80\x94 length of array) in the way that alternating sum of the array will be equal 0 (i.e. a1\xe2\x88\x92a2+a3\xe2\x88\x92a4+\xe2\x80\xa6=0). In other words, Alexandra wants sum of all elements at the odd positions and sum of all elements at the even positions to become equal. The elements that you remove don\'t have to be consecutive.For example, if she has a=[1,0,1,0,0,0] and she removes 2nd and 4th elements, a will become equal [1,1,0,0] and its alternating sum is 1\xe2\x88\x921+0\xe2\x88\x920=0.Help her!" 1100
1406E "Deleting Numbers" "interactive,math,number theory" "This is an interactive problem.There is an unknown integer x (1\xe2\x89\xa4x\xe2\x89\xa4n). You want to find x.At first, you have a set of integers {1,2,\xe2\x80\xa6,n}. You can perform the following operations no more than 10000 times:  A a: find how many numbers are multiples of a in the current set.  B a: find how many numbers are multiples of a in this set, and then delete all multiples of a, but x will never be deleted (even if it is a multiple of a). In this operation, a must be greater than 1.  C a: it means that you know that x=a. This operation can be only performed once. Remember that in the operation of type B a>1 must hold.Write a program, that will find the value of x." 2600
1406D "Three Sequences" "constructive algorithms,data structures,greedy,math" "You are given a sequence of n integers a1,a2,\xe2\x80\xa6,an.You have to construct two sequences of integers b and c with length n that satisfy:  for every i (1\xe2\x89\xa4i\xe2\x89\xa4n) bi+ci=ai  b is non-decreasing, which means that for every 1<i\xe2\x89\xa4n, bi\xe2\x89\xa5bi\xe2\x88\x921 must hold  c is non-increasing, which means that for every 1<i\xe2\x89\xa4n, ci\xe2\x89\xa4ci\xe2\x88\x921 must hold You have to minimize max(bi,ci). In other words, you have to minimize the maximum number in sequences b and c.Also there will be q changes, the i-th change is described by three integers l,r,x. You should add x to al,al+1,\xe2\x80\xa6,ar. You have to find the minimum possible value of max(bi,ci) for the initial sequence and for sequence after each change." 2200
1406C "Link Cut Centroids" "constructive algorithms,dfs and similar,graphs,trees" "Fishing Prince loves trees, and he especially loves trees with only one centroid. The tree is a connected graph without cycles.A vertex is a centroid of a tree only when you cut this vertex (remove it and remove all edges from this vertex), the size of the largest connected component of the remaining graph is the smallest possible.For example, the centroid of the following tree is 2, because when you cut it, the size of the largest connected component of the remaining graph is 2 and it can\'t be smaller.  However, in some trees, there might be more than one centroid, for example:  Both vertex 1 and vertex 2 are centroids because the size of the largest connected component is 3 after cutting each of them.Now Fishing Prince has a tree. He should cut one edge of the tree (it means to remove the edge). After that, he should add one edge. The resulting graph after these two operations should be a tree. He can add the edge that he cut.He wants the centroid of the resulting tree to be unique. Help him and find any possible way to make the operations. It can be proved, that at least one such way always exists." 1700
1406B "Maximum Product" "brute force,dp,greedy,implementation,sortings" "You are given an array of integers a1,a2,\xe2\x80\xa6,an. Find the maximum possible value of aiajakalat among all five indices (i,j,k,l,t) (i<j<k<l<t)." 1200
1406A "Subset Mex" greedy,implementation,math "Given a set of integers (it can contain equal elements).You have to split it into two subsets A and B (both of them can contain equal elements or be empty). You have to maximize the value of mex(A)+mex(B).Here mex of a set denotes the smallest non-negative integer that doesn\'t exist in the set. For example:   mex({1,4,0,2,2,1})=3  mex({3,3,2,1,3,0,0})=4  mex(\xe2\x88\x85)=0 (mex for empty set) The set is splitted into two subsets A and B if for any integer number x the number of occurrences of x into this set is equal to the sum of the number of occurrences of x into A and the number of occurrences of x into B." 900
1405B "Array Cancellation" "constructive algorithms,implementation" "You\'re given an array a of n integers, such that a1+a2+\xe2\x8b\xaf+an=0.In one operation, you can choose two different indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n), decrement ai by one and increment aj by one. If i<j this operation is free, otherwise it costs one coin.How many coins do you have to spend in order to make all elements equal to 0?" 1000
1405A "Permutation Forgery" "constructive algorithms" "A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).Let p be any permutation of length n. We define the fingerprint F(p) of p as the sorted array of sums of adjacent elements in p. More formally,F(p)=sort([p1+p2,p2+p3,\xe2\x80\xa6,pn\xe2\x88\x921+pn]).For example, if n=4 and p=[1,4,2,3], then the fingerprint is given by F(p)=sort([1+4,4+2,2+3])=sort([5,6,5])=[5,5,6].You are given a permutation p of length n. Your task is to find a different permutation p\xe2\x80\xb2 with the same fingerprint. Two permutations p and p\xe2\x80\xb2 are considered different if there is some index i such that pi\xe2\x89\xa0p\xe2\x80\xb2i." 800
1404E Bricks "flows,graph matchings,graphs" "A brick is defined as a rectangle with integer side lengths with either width 1 or height 1 (or both).There is an n\xc3\x97m grid, and each cell is colored either black or white. A tiling is a way to place bricks onto the grid such that each black cell is covered by exactly one brick, and each white cell is not covered by any brick. In other words, bricks are placed on black cells only, cover all black cells, and no two bricks overlap.  An example tiling of the first test case using 5 bricks. It is possible to do better, using only 4 bricks. What is the minimum number of bricks required to make a valid tiling?" 2800
1404D "Game of Pairs" "constructive algorithms,dfs and similar,interactive,math,number theory" "This is an interactive problem.Consider a fixed positive integer n. Two players, First and Second play a game as follows:  First considers the 2n numbers 1,2,\xe2\x80\xa6,2n, and partitions them as he wants into n disjoint pairs. Then, Second chooses exactly one element from each of the pairs that First created (he chooses elements he wants). To determine the winner of the game, we compute the sum of the numbers chosen by Second. If the sum of all these numbers is a multiple of 2n, then Second wins. Otherwise, First wins.You are given the integer n. Your task is to decide which player you wish to play as and win the game." 2800
1404C "Fixed Point Removal" "binary search,constructive algorithms,data structures,greedy,two pointers" "Let a1,\xe2\x80\xa6,an be an array of n positive integers. In one operation, you can choose an index i such that ai=i, and remove ai from the array (after the removal, the remaining parts are concatenated).The weight of a is defined as the maximum number of elements you can remove.You must answer q independent queries (x,y): after replacing the x first elements of a and the y last elements of a by n+1 (making them impossible to remove), what would be the weight of a?" 2300
1404B "Tree Tag" "dfs and similar,dp,games,trees" "Alice and Bob are playing a fun game of tree tag.The game is played on a tree of n vertices numbered from 1 to n. Recall that a tree on n vertices is an undirected, connected graph with n\xe2\x88\x921 edges.Initially, Alice is located at vertex a, and Bob at vertex b. They take turns alternately, and Alice makes the first move. In a move, Alice can jump to a vertex with distance at most da from the current vertex. And in a move, Bob can jump to a vertex with distance at most db from the current vertex. The distance between two vertices is defined as the number of edges on the unique simple path between them. In particular, either player is allowed to stay at the same vertex in a move. Note that when performing a move, a player only occupies the starting and ending vertices of their move, not the vertices between them.If after at most 10100 moves, Alice and Bob occupy the same vertex, then Alice is declared the winner. Otherwise, Bob wins.Determine the winner if both players play optimally." 1900
1404A "Balanced Bitstring" implementation,strings "A bitstring is a string consisting only of the characters 0 and 1. A bitstring is called k-balanced if every substring of size k of this bitstring has an equal amount of 0 and 1 characters (k2 of each).You are given an integer k and a string s which is composed only of characters 0, 1, and ?. You need to determine whether you can make a k-balanced bitstring by replacing every ? characters in s with either 0 or 1.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end." 1500
1403C "Chess Rush" "*special problem,combinatorics,dp,implementation,math" "The mythic world of Chess Land is a rectangular grid of squares with R rows and C columns, R being greater than or equal to C. Its rows and columns are numbered from 1 to R and 1 to C, respectively. The inhabitants of Chess Land are usually mentioned as pieces in everyday language, and there are 5 specific types of them roaming the land: pawns, rooks, bishops, queens and kings. Contrary to popular belief, chivalry is long dead in Chess Land, so there are no knights to be found.Each piece is unique in the way it moves around from square to square: in one step,   a pawn can move one row forward (i.e. from row r to r+1), without changing columns;  a rook can move any number of columns left/right without changing rows OR move any number of rows forward/backward without changing columns;  a bishop can move to any square of the two diagonals intersecting at its currently occupied square;  a queen can move to any square where a rook or a bishop could move to from her position;  and a king can move to any of the 8 adjacent squares.  In the following figure, we marked by X the squares each piece can move to in a single step (here, the rows are numbered from bottom to top, and the columns from left to right).  Recently, Chess Land has become a dangerous place: pieces that are passing through the land can get captured unexpectedly by unknown forces and simply disappear. As a consequence, they would like to reach their destinations as fast (i.e. in as few moves) as possible, and they are also interested in the number of different ways it is possible for them to reach it, using the minimal number of steps \xe2\x80\x93 because more paths being available could mean lower chances of getting captured. Two paths are considered different if they differ in at least one visited square.For this problem, let us assume that pieces are entering Chess Land in a given column of row 1, and exit the land in a given column of row R. Your task is to answer Q questions: given the type of a piece, the column it enters row 1 and the column it must reach in row R in order to exit, compute the minimal number of moves it has to make in Chess Land, and the number of different ways it is able to do so." 3200
1403B "Spring cleaning" "*special problem,data structures,dfs and similar,graphs,trees" "Spring cleanings are probably the most boring parts of our lives, except this year, when Fl\xc3\xb3ra and her mother found a dusty old tree graph under the carpet.This tree has N nodes (numbered from 1 to N), connected by N\xe2\x88\x921 edges. The edges gathered too much dust, so Fl\xc3\xb3ra\'s mom decided to clean them. Cleaning the edges of an arbitrary tree is done by repeating the following process:   She chooses 2 different leaves (a node is a leaf if it is connected to exactly one other node by an edge), and cleans every edge lying on the shortest path between them. If this path has d edges, then the cost of cleaning this path is d.She doesn\'t want to harm the leaves of the tree, so she chooses every one of them at most once. A tree is cleaned when all of its edges are cleaned. The cost of this is the sum of costs for all cleaned paths.Fl\xc3\xb3ra thinks the tree they found is too small and simple, so she imagines Q variations of it. In the i-th variation, she adds a total of Di extra leaves to the original tree: for each new leaf, she chooses a node from the original tree, and connects that node with the new leaf by an edge. Note that some nodes may stop being leaves during this step.For all these Q variations, we are interested in the minimum cost that is required to clean the tree." 2300
1403A "The Potion of Great Power" "*special problem,2-sat,binary search,data structures,graphs,interactive,sortings,two pointers" "Once upon a time, in the Land of the Shamans, everyone lived on the Sky-High Beanstalk. Each shaman had a unique identifying number i between 0 and N\xe2\x88\x921, and an altitude value Hi, representing how high he lived above ground level. The distance between two altitudes is the absolute value of their difference.All shamans lived together in peace, until one of them stole the formula of the world-famous Potion of Great Power. To cover his/her tracks, the Thief has put a Curse on the land: most inhabitants could no longer trust each other...Despite the very difficult circumstances, the Order of Good Investigators have gained the following information about the Curse:   When the Curse first takes effect, everyone stops trusting each other.   The Curse is unstable: at the end of each day (exactly at midnight), one pair of shamans will start or stop trusting each other.   Unfortunately, each shaman will only ever trust at most D others at any given time.  They have also reconstructed a log of who trusted whom: for each night they know which pair of shamans started/stopped trusting each other.They believe the Thief has whispered the formula to an Evil Shaman. To avoid detection, both of them visited the home of one of their (respective) trusted friends. During the visit, the Thief whispered the formula to the Evil Shaman through the window. (Note: this trusted friend did not have to be home at the time. In fact, it\'s even possible that they visited each other\'s houses \xe2\x80\x93 shamans are weird.)Fortunately, whispers only travel short distances, so the Order knows the two trusted friends visited (by the Thief and the Evil Shaman) must live very close to each other.They ask you to help with their investigation. They would like to test their suspicions: what if the Thief was x, the Evil Shaman was y, and the formula was whispered on day v? What is the smallest distance the whispered formula had to travel? That is, what is the minimum distance between the apartments of some shamans x\xe2\x80\xb2 and y\xe2\x80\xb2 (i.e. min(|Hx\xe2\x80\xb2\xe2\x88\x92Hy\xe2\x80\xb2|)), such that x\xe2\x80\xb2 was a trusted friend of x and y\xe2\x80\xb2 was a trusted friend of y on day v?They will share all their information with you, then ask you a number of questions. You need to answer each question immediately, before receiving the next one." 2400
1402C "Star Trek" "*special problem,combinatorics,dfs and similar,dp,games,graphs,matrices,trees" "The United Federation of Planets is an alliance of N planets, they are indexed from 1 to N. Some planets are connected by space tunnels. In a space tunnel, a starship can fly both ways really fast. There are exactly N\xe2\x88\x921 space tunnels, and we can travel from any planet to any other planet in the Federation using these tunnels.It\'s well known that there are D additional parallel universes. These are exact copies of our universe, they have the same planets and space tunnels. They are indexed from 1 to D (our universe has index 0). We denote the planet x in universe i by Pix. We can travel from one universe to another using dimension portals. For every i (0\xe2\x89\xa4i\xe2\x89\xa4D\xe2\x88\x921), we will place exactly one portal that allows us to fly from PiAi to Pi+1Bi, for some planet indices Ai and Bi (i.e. 1\xe2\x89\xa4Ai,Bi\xe2\x89\xa4N).Once all the portals are placed, Starship Batthy\xc3\xa1ny will embark on its maiden voyage. It is currently orbiting around P01. Captain \xc3\x81gnes and Lieutenant G\xc3\xa1bor have decided to play the following game: they choose alternately a destination (a planet) to fly to. This planet can be in the same universe, if a space tunnel goes there, or it can be in another universe, if a portal goes there. Their aim is to visit places where no one has gone before. That\'s why, once they have visited a planet Pix, they never go back there (but they can visit the planet x in another universe). Captain \xc3\x81gnes chooses the first destination (then G\xc3\xa1bor, then \xc3\x81gnes etc.). If somebody can\'t choose a planet where they have not been before in his/her turn, he/she loses.Captain \xc3\x81gnes and Lieutenant G\xc3\xa1bor are both very clever: they know the locations of all tunnels and portals, and they both play optimally. For how many different placements of portals does Captain \xc3\x81gnes win the game? Two placements are different if there is an index i (0\xe2\x89\xa4i\xe2\x89\xa4D\xe2\x88\x921), where the ith portal connects different pairs of planets in the two placements (i.e Ai or Bi differs).This number can be very big, so we are interested in it modulo 109+7." 2600
1402B Roads "*special problem,geometry,sortings" "The government of Treeland wants to build a new road network. There are 2N cities in Treeland. The unfinished plan of the road network already contains N road segments, each of which connects two cities with a straight line. No two road segments have a common point (including their endpoints).  Your task is to determine N\xe2\x88\x921 additional road segments satisfying the following conditions:   Every new road segment must connect two cities with a straight line.  If two segments (new or old) have a common point, then this point must be an endpoint of both segments.  The road network connects all cities: for each pair of cities there is a path consisting of segments that connects the two cities." 2900
1402A "Fancy Fence" "*special problem,data structures,dsu,implementation,math,sortings" "Everybody knows that Bal\xc3\xa1zs has the fanciest fence in the whole town. It\'s built up from N fancy sections. The sections are rectangles standing closely next to each other on the ground. The ith section has integer height hi and integer width wi.  We are looking for fancy rectangles on this fancy fence.  A rectangle is fancy if:   its sides are either horizontal or vertical and have integer lengths  the distance between the rectangle and the ground is integer  the distance between the rectangle and the left side of the first section is integer  it\'s lying completely on sections  What is the number of fancy rectangles?  This number can be very big, so we are interested in it modulo 109+7." 1800
1401F "Reverse and Swap" "binary search,bitmasks,data structures" "You are given an array a of length 2n. You should process q queries on it. Each query has one of the following 4 types:   Replace(x,k) \xe2\x80\x94 change ax to k;  Reverse(k) \xe2\x80\x94 reverse each subarray [(i\xe2\x88\x921)\xe2\x8b\x852k+1,i\xe2\x8b\x852k] for all i (i\xe2\x89\xa51);  Swap(k) \xe2\x80\x94 swap subarrays [(2i\xe2\x88\x922)\xe2\x8b\x852k+1,(2i\xe2\x88\x921)\xe2\x8b\x852k] and [(2i\xe2\x88\x921)\xe2\x8b\x852k+1,2i\xe2\x8b\x852k] for all i (i\xe2\x89\xa51);  Sum(l,r) \xe2\x80\x94 print the sum of the elements of subarray [l,r]. Write a program that can quickly process given queries." 2400
1401E "Divide Square" "data structures,geometry,implementation,sortings" "There is a square of size 106\xc3\x97106 on the coordinate plane with four points (0,0), (0,106), (106,0), and (106,106) as its vertices.You are going to draw segments on the plane. All segments are either horizontal or vertical and intersect with at least one side of the square.Now you are wondering how many pieces this square divides into after drawing all segments. Write a program calculating the number of pieces of the square." 2400
1401D "Maximum Distributed Tree" "dfs and similar,dp,greedy,implementation,math,number theory,sortings,trees" "You are given a tree that consists of n nodes. You should label each of its n\xe2\x88\x921 edges with an integer in such way that satisfies the following conditions:   each integer must be greater than 0;  the product of all n\xe2\x88\x921 numbers should be equal to k;  the number of 1-s among all n\xe2\x88\x921 integers must be minimum possible. Let\'s define f(u,v) as the sum of the numbers on the simple path from node u to node v. Also, let n\xe2\x88\x921\xe2\x88\x91i=1n\xe2\x88\x91j=i+1f(i,j) be a distribution index of the tree.Find the maximum possible distribution index you can get. Since answer can be too large, print it modulo 109+7.In this problem, since the number k can be large, the result of the prime factorization of k is given instead." 1800
1401C "Mere Array" "constructive algorithms,math,number theory,sortings" "You are given an array a1,a2,\xe2\x80\xa6,an where all ai are integers and greater than 0. In one operation, you can choose two different indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n). If gcd(ai,aj) is equal to the minimum element of the whole array a, you can swap ai and aj. gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y. Now you\'d like to make a non-decreasing using the operation any number of times (possibly zero). Determine if you can do this. An array a is non-decreasing if and only if a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an." 1300
1401B "Ternary Sequence" "constructive algorithms,greedy,math" "You are given two sequences a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn. Each element of both sequences is either 0, 1 or 2. The number of elements 0, 1, 2 in the sequence a is x1, y1, z1 respectively, and the number of elements 0, 1, 2 in the sequence b is x2, y2, z2 respectively.You can rearrange the elements in both sequences a and b however you like. After that, let\'s define a sequence c as follows:ci={aibiif ai>bi0if ai=bi\xe2\x88\x92aibiif ai<biYou\'d like to make \xe2\x88\x91ni=1ci (the sum of all elements of the sequence c) as large as possible. What is the maximum possible sum?" 1100
1401A "Distance and Axis" "constructive algorithms,math" "We have a point A with coordinate x=n on OX-axis. We\'d like to find an integer point B (also on OX-axis), such that the absolute difference between the distance from O to B and the distance from A to B is equal to k.  The description of the first test case. Since sometimes it\'s impossible to find such point B, we can, in one step, increase or decrease the coordinate of A by 1. What is the minimum number of steps we should do to make such point B exist?" 900
1400G Mercenaries "bitmasks,brute force,combinatorics,dp,dsu,math,two pointers" "Polycarp plays a (yet another!) strategic computer game. In this game, he leads an army of mercenaries.Polycarp wants to gather his army for a quest. There are n mercenaries for hire, and the army should consist of some subset of them.The i-th mercenary can be chosen if the resulting number of chosen mercenaries is not less than li (otherwise he deems the quest to be doomed) and not greater than ri (he doesn\'t want to share the trophies with too many other mercenaries). Furthermore, m pairs of mercenaries hate each other and cannot be chosen for the same quest. How many non-empty subsets does Polycarp need to consider? In other words, calculate the number of non-empty subsets of mercenaries such that the size of this subset belongs to [li,ri] for each chosen mercenary, and there are no two mercenaries in the subset that hate each other.The answer may be large, so calculate it modulo 998244353." 2600
1400F "x-prime Substrings" "brute force,dfs and similar,dp,string suffix structures,strings" "You are given an integer value x and a string s consisting of digits from 1 to 9 inclusive.A substring of a string is a contiguous subsequence of that string.Let f(l,r) be the sum of digits of a substring s[l..r].Let\'s call substring s[l1..r1] x-prime if   f(l1,r1)=x;  there are no values l2,r2 such that   l1\xe2\x89\xa4l2\xe2\x89\xa4r2\xe2\x89\xa4r1;  f(l2,r2)\xe2\x89\xa0x;  x is divisible by f(l2,r2).  You are allowed to erase some characters from the string. If you erase a character, the two resulting parts of the string are concatenated without changing their order.What is the minimum number of characters you should erase from the string so that there are no x-prime substrings in it? If there are no x-prime substrings in the given string s, then print 0." 2800
1400E "Clear the Multiset" "data structures,divide and conquer,dp,greedy" "You have a multiset containing several integers. Initially, it contains a1 elements equal to 1, a2 elements equal to 2, ..., an elements equal to n.You may apply two types of operations:  choose two integers l and r (l\xe2\x89\xa4r), then remove one occurrence of l, one occurrence of l+1, ..., one occurrence of r from the multiset. This operation can be applied only if each number from l to r occurs at least once in the multiset;  choose two integers i and x (x\xe2\x89\xa51), then remove x occurrences of i from the multiset. This operation can be applied only if the multiset contains at least x occurrences of i. What is the minimum number of operations required to delete all elements from the multiset?" 2200
1400D Zigzags "brute force,combinatorics,data structures,math,two pointers" "You are given an array a1,a2\xe2\x80\xa6an. Calculate the number of tuples (i,j,k,l) such that:   1\xe2\x89\xa4i<j<k<l\xe2\x89\xa4n;  ai=ak and aj=al;" 1900
1400C "Binary String Reconstruction" "2-sat,brute force,constructive algorithms,greedy" "Consider the following process. You have a binary string (a string where each character is either 0 or 1) w of length n and an integer x. You build a new binary string s consisting of n characters. The i-th character of s is chosen as follows:  if the character wi\xe2\x88\x92x exists and is equal to 1, then si is 1 (formally, if i>x and wi\xe2\x88\x92x= 1, then si= 1);  if the character wi+x exists and is equal to 1, then si is 1 (formally, if i+x\xe2\x89\xa4n and wi+x= 1, then si= 1);  if both of the aforementioned conditions are false, then si is 0. You are given the integer x and the resulting string s. Reconstruct the original string w." 1500
1400B "RPG Protagonist" "brute force,greedy,math" "You are playing one RPG from the 2010s. You are planning to raise your smithing skill, so you need as many resources as possible. So how to get resources? By stealing, of course.You decided to rob a town\'s blacksmith and you take a follower with you. You can carry at most p units and your follower \xe2\x80\x94 at most f units.In the blacksmith shop, you found cnts swords and cntw war axes. Each sword weights s units and each war axe \xe2\x80\x94 w units. You don\'t care what to take, since each of them will melt into one steel ingot.What is the maximum number of weapons (both swords and war axes) you and your follower can carry out from the shop?" 1700
1400A "String Similarity" "constructive algorithms,strings" "A binary string is a string where each character is either 0 or 1. Two binary strings a and b of equal length are similar, if they have the same character in some position (there exists an integer i such that ai=bi). For example:  10010 and 01111 are similar (they have the same character in position 4);  10010 and 11111 are similar;  111 and 111 are similar;  0110 and 1001 are not similar. You are given an integer n and a binary string s consisting of 2n\xe2\x88\x921 characters. Let\'s denote s[l..r] as the contiguous substring of s starting with l-th character and ending with r-th character (in other words, s[l..r]=slsl+1sl+2\xe2\x80\xa6sr).You have to construct a binary string w of length n which is similar to all of the following strings: s[1..n], s[2..n+1], s[3..n+2], ..., s[n..2n\xe2\x88\x921]." 800
1399F "Yet Another Segments Subset" "data structures,dp,graphs,sortings" "You are given n segments on a coordinate axis OX. The i-th segment has borders [li;ri]. All points x, for which li\xe2\x89\xa4x\xe2\x89\xa4ri holds, belong to the i-th segment.Your task is to choose the maximum by size (the number of segments) subset of the given set of segments such that each pair of segments in this subset either non-intersecting or one of them lies inside the other one.Two segments [li;ri] and [lj;rj] are non-intersecting if they have no common points. For example, segments [1;2] and [3;4], [1;3] and [5;5] are non-intersecting, while segments [1;2] and [2;3], [1;2] and [2;2] are intersecting.The segment [li;ri] lies inside the segment [lj;rj] if lj\xe2\x89\xa4li and ri\xe2\x89\xa4rj. For example, segments [2;2], [2,3], [3;4] and [2;4] lie inside the segment [2;4], while [2;5] and [1;4] are not.You have to answer t independent test cases." 2300
1399E2 "Weights Division (hard version)" "binary search,dfs and similar,greedy,sortings,trees,two pointers" "Easy and hard versions are actually different problems, so we advise you to read both statements carefully.You are given a weighted rooted tree, vertex 1 is the root of this tree. Also, each edge has its own cost.A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. A parent of a vertex v is the last different from v vertex on the path from the root to the vertex v. Children of vertex v are all vertices for which v is the parent. A vertex is a leaf if it has no children. The weighted tree is such a tree that each edge of this tree has some weight.The weight of the path is the sum of edges weights on this path. The weight of the path from the vertex to itself is 0.You can make a sequence of zero or more moves. On each move, you select an edge and divide its weight by 2 rounding down. More formally, during one move, you choose some edge i and divide its weight by 2 rounding down (wi:=\xe2\x8c\x8awi2\xe2\x8c\x8b).Each edge i has an associated cost ci which is either 1 or 2 coins. Each move with edge i costs ci coins.Your task is to find the minimum total cost to make the sum of weights of paths from the root to each leaf at most S. In other words, if w(i,j) is the weight of the path from the vertex i to the vertex j, then you have to make \xe2\x88\x91v\xe2\x88\x88leavesw(root,v)\xe2\x89\xa4S, where leaves is the list of all leaves.You have to answer t independent test cases." 2200
1399E1 "Weights Division (easy version)" "data structures,dfs and similar,greedy,trees" "Easy and hard versions are actually different problems, so we advise you to read both statements carefully.You are given a weighted rooted tree, vertex 1 is the root of this tree.A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. A parent of a vertex v is the last different from v vertex on the path from the root to the vertex v. Children of vertex v are all vertices for which v is the parent. A vertex is a leaf if it has no children. The weighted tree is such a tree that each edge of this tree has some weight.The weight of the path is the sum of edges weights on this path. The weight of the path from the vertex to itself is 0.You can make a sequence of zero or more moves. On each move, you select an edge and divide its weight by 2 rounding down. More formally, during one move, you choose some edge i and divide its weight by 2 rounding down (wi:=\xe2\x8c\x8awi2\xe2\x8c\x8b).Your task is to find the minimum number of moves required to make the sum of weights of paths from the root to each leaf at most S. In other words, if w(i,j) is the weight of the path from the vertex i to the vertex j, then you have to make \xe2\x88\x91v\xe2\x88\x88leavesw(root,v)\xe2\x89\xa4S, where leaves is the list of all leaves.You have to answer t independent test cases." 2000
1399D "Binary String To Subsequences" "constructive algorithms,data structures,greedy,implementation" "You are given a binary string s consisting of n zeros and ones.Your task is to divide the given string into the minimum number of subsequences in such a way that each character of the string belongs to exactly one subsequence and each subsequence looks like ""010101 ..."" or ""101010 ..."" (i.e. the subsequence should not contain two adjacent zeros or ones).Recall that a subsequence is a sequence that can be derived from the given sequence by deleting zero or more elements without changing the order of the remaining elements. For example, subsequences of ""1011101"" are ""0"", ""1"", ""11111"", ""0111"", ""101"", ""1001"", but not ""000"", ""101010"" and ""11100"".You have to answer t independent test cases." 1500
1399C "Boats Competition" "brute force,greedy,two pointers" "There are n people who want to participate in a boat competition. The weight of the i-th participant is wi. Only teams consisting of two people can participate in this competition. As an organizer, you think that it\'s fair to allow only teams with the same total weight.So, if there are k teams (a1,b1), (a2,b2), \xe2\x80\xa6, (ak,bk), where ai is the weight of the first participant of the i-th team and bi is the weight of the second participant of the i-th team, then the condition a1+b1=a2+b2=\xe2\x8b\xaf=ak+bk=s, where s is the total weight of each team, should be satisfied.Your task is to choose such s that the number of teams people can create is the maximum possible. Note that each participant can be in no more than one team.You have to answer t independent test cases." 1200
1399B "Gifts Fixing" greedy "You have n gifts and you want to give all of them to children. Of course, you don\'t want to offend anyone, so all gifts should be equal between each other. The i-th gift consists of ai candies and bi oranges.During one move, you can choose some gift 1\xe2\x89\xa4i\xe2\x89\xa4n and do one of the following operations:  eat exactly one candy from this gift (decrease ai by one);  eat exactly one orange from this gift (decrease bi by one);  eat exactly one candy and exactly one orange from this gift (decrease both ai and bi by one). Of course, you can not eat a candy or orange if it\'s not present in the gift (so neither ai nor bi can become less than zero).As said above, all gifts should be equal. This means that after some sequence of moves the following two conditions should be satisfied: a1=a2=\xe2\x8b\xaf=an and b1=b2=\xe2\x8b\xaf=bn (and ai equals bi is not necessary).Your task is to find the minimum number of moves required to equalize all the given gifts.You have to answer t independent test cases." 800
1399A "Remove Smallest" greedy,sortings "You are given the array a consisting of n positive (greater than zero) integers.In one move, you can choose two indices i and j (i\xe2\x89\xa0j) such that the absolute difference between ai and aj is no more than one (|ai\xe2\x88\x92aj|\xe2\x89\xa41) and remove the smallest of these two elements. If two elements are equal, you can remove any of them (but exactly one).Your task is to find if it is possible to obtain the array consisting of only one element using several (possibly, zero) such moves or not.You have to answer t independent test cases." 800
1398G "Running Competition" "bitmasks,fft,math,number theory" "A running competition is going to be held soon. The stadium where the competition will be held can be represented by several segments on the coordinate plane:  two horizontal segments: one connecting the points (0,0) and (x,0), the other connecting the points (0,y) and (x,y);  n+1 vertical segments, numbered from 0 to n. The i-th segment connects the points (ai,0) and (ai,y); 0=a0<a1<a2<\xe2\x8b\xaf<an\xe2\x88\x921<an=x. For example, here is a picture of the stadium with x=10, y=5, n=3 and a=[0,3,5,10]:  A lap is a route that goes along the segments, starts and finishes at the same point, and never intersects itself (the only two points of a lap that coincide are its starting point and ending point). The length of a lap is a total distance travelled around it. For example, the red route in the picture representing the stadium is a lap of length 24.The competition will be held in q stages. The i-th stage has length li, and the organizers want to choose a lap for each stage such that the length of the lap is a divisor of li. The organizers don\'t want to choose short laps for the stages, so for each stage, they want to find the maximum possible length of a suitable lap.Help the organizers to calculate the maximum possible lengths of the laps for the stages! In other words, for every li, find the maximum possible integer L such that limodL=0, and there exists a lap of length exactly L.If it is impossible to choose such a lap then print \xe2\x88\x921." 2600
1398F "Controversial Rounds" "binary search,data structures,dp,greedy,two pointers" "Alice and Bob play a game. The game consists of several sets, and each set consists of several rounds. Each round is won either by Alice or by Bob, and the set ends when one of the players has won x rounds in a row. For example, if Bob won five rounds in a row and x=2, then two sets ends.You know that Alice and Bob have already played n rounds, and you know the results of some rounds. For each x from 1 to n, calculate the maximum possible number of sets that could have already finished if each set lasts until one of the players wins x rounds in a row. It is possible that the last set is still not finished \xe2\x80\x94 in that case, you should not count it in the answer." 2500
1398E "Two Types of Spells" "binary search,data structures,greedy,implementation,math,sortings" "Polycarp plays a computer game (yet again). In this game, he fights monsters using magic spells.There are two types of spells: fire spell of power x deals x damage to the monster, and lightning spell of power y deals y damage to the monster and doubles the damage of the next spell Polycarp casts. Each spell can be cast only once per battle, but Polycarp can cast them in any order.For example, suppose that Polycarp knows three spells: a fire spell of power 5, a lightning spell of power 1, and a lightning spell of power 8. There are 6 ways to choose the order in which he casts the spells:  first, second, third. This order deals 5+1+2\xe2\x8b\x858=22 damage;  first, third, second. This order deals 5+8+2\xe2\x8b\x851=15 damage;  second, first, third. This order deals 1+2\xe2\x8b\x855+8=19 damage;  second, third, first. This order deals 1+2\xe2\x8b\x858+2\xe2\x8b\x855=27 damage;  third, first, second. This order deals 8+2\xe2\x8b\x855+1=19 damage;  third, second, first. This order deals 8+2\xe2\x8b\x851+2\xe2\x8b\x855=20 damage. Initially, Polycarp knows 0 spells. His spell set changes n times, each time he either learns a new spell or forgets an already known one. After each change, calculate the maximum possible damage Polycarp may deal using the spells he knows." 2200
1398D "Colored Rectangles" dp,greedy,sortings "You are given three multisets of pairs of colored sticks:   R pairs of red sticks, the first pair has length r1, the second pair has length r2, \xe2\x80\xa6, the R-th pair has length rR;  G pairs of green sticks, the first pair has length g1, the second pair has length g2, \xe2\x80\xa6, the G-th pair has length gG;  B pairs of blue sticks, the first pair has length b1, the second pair has length b2, \xe2\x80\xa6, the B-th pair has length bB; You are constructing rectangles from these pairs of sticks with the following process:   take a pair of sticks of one color;  take a pair of sticks of another color different from the first one;  add the area of the resulting rectangle to the total area. Thus, you get such rectangles that their opposite sides are the same color and their adjacent sides are not the same color.Each pair of sticks can be used at most once, some pairs can be left unused. You are not allowed to split a pair into independent sticks.What is the maximum area you can achieve?" 1800
1398C "Good Subarrays" "data structures,dp,math" "You are given an array a1,a2,\xe2\x80\xa6,an consisting of integers from 0 to 9. A subarray al,al+1,al+2,\xe2\x80\xa6,ar\xe2\x88\x921,ar is good if the sum of elements of this subarray is equal to the length of this subarray (r\xe2\x88\x91i=lai=r\xe2\x88\x92l+1).For example, if a=[1,2,0], then there are 3 good subarrays: a1\xe2\x80\xa61=[1],a2\xe2\x80\xa63=[2,0] and a1\xe2\x80\xa63=[1,2,0].Calculate the number of good subarrays of the array a." 1600
1398B "Substring Removal Game" games,greedy,sortings "Alice and Bob play a game. They have a binary string s (a string such that each character in it is either 0 or 1). Alice moves first, then Bob, then Alice again, and so on.During their move, the player can choose any number (not less than one) of consecutive equal characters in s and delete them.For example, if the string is 10110, there are 6 possible moves (deleted characters are bold):  10110\xe2\x86\x920110;  10110\xe2\x86\x921110;  10110\xe2\x86\x921010;  10110\xe2\x86\x921010;  10110\xe2\x86\x92100;  10110\xe2\x86\x921011. After the characters are removed, the characters to the left and to the right of the removed block become adjacent. I.\xe2\x80\x89e. the following sequence of moves is valid: 10110\xe2\x86\x92100\xe2\x86\x921.The game ends when the string becomes empty, and the score of each player is the number of 1-characters deleted by them.Each player wants to maximize their score. Calculate the resulting score of Alice." 800
1398A "Bad Triangle" geometry,math "You are given an array a1,a2,\xe2\x80\xa6,an, which is sorted in non-decreasing order (ai\xe2\x89\xa4ai+1). Find three indices i, j, k such that 1\xe2\x89\xa4i<j<k\xe2\x89\xa4n and it is impossible to construct a non-degenerate triangle (a triangle with nonzero area) having sides equal to ai, aj and ak (for example it is possible to construct a non-degenerate triangle with sides 3, 4 and 5 but impossible with sides 3, 4 and 7). If it is impossible to find such triple, report it." 800
1397B "Power Sequence" "brute force,math,number theory,sortings" "Let\'s call a list of positive integers a0,a1,...,an\xe2\x88\x921 a power sequence if there is a positive integer c, so that for every 0\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 then ai=ci.Given a list of n positive integers a0,a1,...,an\xe2\x88\x921, you are allowed to:  Reorder the list (i.e. pick a permutation p of {0,1,...,n\xe2\x88\x921} and change ai to api), then  Do the following operation any number of times: pick an index i and change ai to ai\xe2\x88\x921 or ai+1 (i.e. increment or decrement ai by 1) with a cost of 1. Find the minimum cost to transform a0,a1,...,an\xe2\x88\x921 into a power sequence." 1500
1397A "Juggling Letters" greedy,strings "You are given n strings s1,s2,\xe2\x80\xa6,sn consisting of lowercase Latin letters.In one operation you can remove a character from a string si and insert it to an arbitrary position in a string sj (j may be equal to i). You may perform this operation any number of times. Is it possible to make all n strings equal?" 800
1396E "Distance Matching" "constructive algorithms,dfs and similar,trees" "You are given an integer k and a tree T with n nodes (n is even).Let dist(u,v) be the number of edges on the shortest path from node u to node v in T.Let us define a undirected weighted complete graph G=(V,E) as following:   V={x\xe2\x88\xa31\xe2\x89\xa4x\xe2\x89\xa4n} i.e. the set of integers from 1 to n E={(u,v,w)\xe2\x88\xa31\xe2\x89\xa4u,v\xe2\x89\xa4n,u\xe2\x89\xa0v,w=dist(u,v)} i.e. there is an edge between every pair of distinct nodes, the weight being the distance between their respective nodes in T Your task is simple, find a perfect matching in G with total edge weight k (1\xe2\x89\xa4k\xe2\x89\xa4n2)." 3200
1396D "Rainbow Rectangles" "data structures,sortings,two pointers" "Shrimpy Duc is a fat and greedy boy who is always hungry. After a while of searching for food to satisfy his never-ending hunger, Shrimpy Duc finds M&M candies lying unguarded on a L\xc3\x97L grid. There are n M&M candies on the grid, the i-th M&M is currently located at (xi+0.5,yi+0.5), and has color ci out of a total of k colors (the size of M&Ms are insignificant).Shrimpy Duc wants to steal a rectangle of M&Ms, specifically, he wants to select a rectangle with integer coordinates within the grid and steal all candies within the rectangle. Shrimpy Duc doesn\'t need to steal every single candy, however, he would like to steal at least one candy for each color.In other words, he wants to select a rectangle whose sides are parallel to the coordinate axes and whose left-bottom vertex (X1,Y1) and right-top vertex (X2,Y2) are points with integer coordinates satisfying 0\xe2\x89\xa4X1<X2\xe2\x89\xa4L and 0\xe2\x89\xa4Y1<Y2\xe2\x89\xa4L, so that for every color 1\xe2\x89\xa4c\xe2\x89\xa4k there is at least one M&M with color c that lies within that rectangle.How many such rectangles are there? This number may be large, so you only need to find it modulo 109+7." 3300
1396C "Monster Invaders" dp,greedy,implementation "Ziota found a video game called ""Monster Invaders"".Similar to every other shooting RPG game, ""Monster Invaders"" involves killing monsters and bosses with guns.For the sake of simplicity, we only consider two different types of monsters and three different types of guns.Namely, the two types of monsters are:   a normal monster with 1 hp.  a boss with 2 hp. And the three types of guns are:   Pistol, deals 1 hp in damage to one monster, r1 reloading time  Laser gun, deals 1 hp in damage to all the monsters in the current level (including the boss), r2 reloading time  AWP, instantly kills any monster, r3 reloading time The guns are initially not loaded, and the Ziota can only reload 1 gun at a time.The levels of the game can be considered as an array a1,a2,\xe2\x80\xa6,an, in which the i-th stage has ai normal monsters and 1 boss. Due to the nature of the game, Ziota cannot use the Pistol (the first type of gun) or AWP (the third type of gun) to shoot the boss before killing all of the ai normal monsters.If Ziota damages the boss but does not kill it immediately, he is forced to move out of the current level to an arbitrary adjacent level (adjacent levels of level i (1<i<n) are levels i\xe2\x88\x921 and i+1, the only adjacent level of level 1 is level 2, the only adjacent level of level n is level n\xe2\x88\x921). Ziota can also choose to move to an adjacent level at any time. Each move between adjacent levels are managed by portals with d teleportation time.In order not to disrupt the space-time continuum within the game, it is strictly forbidden to reload or shoot monsters during teleportation. Ziota starts the game at level 1. The objective of the game is rather simple, to kill all the bosses in all the levels. He is curious about the minimum time to finish the game (assuming it takes no time to shoot the monsters with a loaded gun and Ziota has infinite ammo on all the three guns). Please help him find this value." 2300
1396B "Stoned Game" "brute force,constructive algorithms,games,greedy" "T is playing a game with his friend, HL.There are n piles of stones, the i-th pile initially has ai stones. T and HL will take alternating turns, with T going first. In each turn, a player chooses a non-empty pile and then removes a single stone from it. However, one cannot choose a pile that has been chosen in the previous turn (the pile that was chosen by the other player, or if the current turn is the first turn then the player can choose any non-empty pile). The player who cannot choose a pile in his turn loses, and the game ends.Assuming both players play optimally, given the starting configuration of t games, determine the winner of each game." 1800
1396A "Multiples of Length" "constructive algorithms,greedy,number theory" "You are given an array a of n integers.You want to make all elements of a equal to zero by doing the following operation exactly three times:  Select a segment, for each number in this segment we can add a multiple of len to it, where len is the length of this segment (added integers can be different). It can be proven that it is always possible to make all elements of a equal to zero." 1600
1395C "Boboniu and Bit Operations" "bitmasks,brute force,dp,greedy" "Boboniu likes bit operations. He wants to play a game with you.Boboniu gives you two sequences of non-negative integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bm.For each i (1\xe2\x89\xa4i\xe2\x89\xa4n), you\'re asked to choose a j (1\xe2\x89\xa4j\xe2\x89\xa4m) and let ci=ai&bj, where & denotes the bitwise AND operation. Note that you can pick the same j for different i\'s.Find the minimum possible c1|c2|\xe2\x80\xa6|cn, where | denotes the bitwise OR operation." 1600
1395B "Boboniu Plays Chess" "constructive algorithms" "Boboniu likes playing chess with his employees. As we know, no employee can beat the boss in the chess game, so Boboniu has never lost in any round.You are a new applicant for his company. Boboniu will test you with the following chess question:Consider a n\xc3\x97m grid (rows are numbered from 1 to n, and columns are numbered from 1 to m). You have a chess piece, and it stands at some cell (Sx,Sy) which is not on the border (i.e. 2\xe2\x89\xa4Sx\xe2\x89\xa4n\xe2\x88\x921 and 2\xe2\x89\xa4Sy\xe2\x89\xa4m\xe2\x88\x921).From the cell (x,y), you can move your chess piece to (x,y\xe2\x80\xb2) (1\xe2\x89\xa4y\xe2\x80\xb2\xe2\x89\xa4m,y\xe2\x80\xb2\xe2\x89\xa0y) or (x\xe2\x80\xb2,y) (1\xe2\x89\xa4x\xe2\x80\xb2\xe2\x89\xa4n,x\xe2\x80\xb2\xe2\x89\xa0x). In other words, the chess piece moves as a rook. From the cell, you can move to any cell on the same row or column.Your goal is to visit each cell exactly once. Can you find a solution?Note that cells on the path between two adjacent cells in your route are not counted as visited, and it is not required to return to the starting point." 1100
1395A "Boboniu Likes to Color Balls" "brute force,math" "Boboniu gives you  r red balls,  g green balls,  b blue balls,  w white balls. He allows you to do the following operation as many times as you want:   Pick a red ball, a green ball, and a blue ball and then change their color to white. You should answer if it\'s possible to arrange all the balls into a palindrome after several (possibly zero) number of described operations." 1000
1394E "Boboniu and Banknote Collection" strings "No matter what trouble you\'re in, don\'t be afraid, but face it with a smile.I\'ve made another billion dollars! \xe2\x80\x94 BoboniuBoboniu has issued his currencies, named Bobo Yuan. Bobo Yuan (BBY) is a series of currencies. Boboniu gives each of them a positive integer identifier, such as BBY-1, BBY-2, etc.Boboniu has a BBY collection. His collection looks like a sequence. For example:  We can use sequence a=[1,2,3,3,2,1,4,4,1] of length n=9 to denote it.Now Boboniu wants to fold his collection. You can imagine that Boboniu stick his collection to a long piece of paper and fold it between currencies:  Boboniu will only fold the same identifier of currencies together. In other words, if ai is folded over aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n), then ai=aj must hold. Boboniu doesn\'t care if you follow this rule in the process of folding. But once it is finished, the rule should be obeyed.A formal definition of fold is described in notes.According to the picture above, you can fold a two times. In fact, you can fold a=[1,2,3,3,2,1,4,4,1] at most two times. So the maximum number of folds of it is 2.As an international fan of Boboniu, you\'re asked to calculate the maximum number of folds. You\'re given a sequence a of length n, for each i (1\xe2\x89\xa4i\xe2\x89\xa4n), you need to calculate the maximum number of folds of [a1,a2,\xe2\x80\xa6,ai]." 3500
1394D "Boboniu and Jianghu" dp,greedy,sortings,trees "Since Boboniu finished building his Jianghu, he has been doing Kungfu on these mountains every day. Boboniu designs a map for his n mountains. He uses n\xe2\x88\x921 roads to connect all n mountains. Every pair of mountains is connected via roads.For the i-th mountain, Boboniu estimated the tiredness of doing Kungfu on the top of it as ti. He also estimated the height of each mountain as hi.A path is a sequence of mountains M such that for each i (1\xe2\x89\xa4i<|M|), there exists a road between Mi and Mi+1. Boboniu would regard the path as a challenge if for each i (1\xe2\x89\xa4i<|M|), hMi\xe2\x89\xa4hMi+1.Boboniu wants to divide all n\xe2\x88\x921 roads into several challenges. Note that each road must appear in exactly one challenge, but a mountain may appear in several challenges. Boboniu wants to minimize the total tiredness to do all the challenges. The tiredness of a challenge M is the sum of tiredness of all mountains in it, i.e. \xe2\x88\x91|M|i=1tMi. He asked you to find the minimum total tiredness. As a reward for your work, you\'ll become a guardian in his Jianghu." 2800
1394C "Boboniu and String" "binary search,geometry,ternary search" "Boboniu defines BN-string as a string s of characters \'B\' and \'N\'.You can perform the following operations on the BN-string s:  Remove a character of s.  Remove a substring ""BN"" or ""NB"" of s.  Add a character \'B\' or \'N\' to the end of s.  Add a string ""BN"" or ""NB"" to the end of s. Note that a string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.Boboniu thinks that BN-strings s and t are similar if and only if:  |s|=|t|.  There exists a permutation p1,p2,\xe2\x80\xa6,p|s| such that for all i (1\xe2\x89\xa4i\xe2\x89\xa4|s|), spi=ti. Boboniu also defines dist(s,t), the distance between s and t, as the minimum number of operations that makes s similar to t.Now Boboniu gives you n non-empty BN-strings s1,s2,\xe2\x80\xa6,sn and asks you to find a non-empty BN-string t such that the maximum distance to string s is minimized, i.e. you need to minimize maxni=1dist(si,t)." 2600
1394B "Boboniu Walks on Graph" "brute force,dfs and similar,graphs,hashing" "Boboniu has a directed graph with n vertices and m edges.The out-degree of each vertex is at most k.Each edge has an integer weight between 1 and m. No two edges have equal weights.Boboniu likes to walk on the graph with some specific rules, which is represented by a tuple (c1,c2,\xe2\x80\xa6,ck). If he now stands on a vertex u with out-degree i, then he will go to the next vertex by the edge with the ci-th (1\xe2\x89\xa4ci\xe2\x89\xa4i) smallest weight among all edges outgoing from u.Now Boboniu asks you to calculate the number of tuples (c1,c2,\xe2\x80\xa6,ck) such that  1\xe2\x89\xa4ci\xe2\x89\xa4i for all i (1\xe2\x89\xa4i\xe2\x89\xa4k).  Starting from any vertex u, it is possible to go back to u in finite time by walking on the graph under the described rules." 2300
1394A "Boboniu Chats with Du" "dp,greedy,sortings,two pointers" "Have you ever used the chat application QQ? Well, in a chat group of QQ, administrators can muzzle a user for days.In Boboniu\'s chat group, there\'s a person called Du Yi who likes to make fun of Boboniu every day.Du will chat in the group for n days. On the i-th day:  If Du can speak, he\'ll make fun of Boboniu with fun factor ai. But after that, he may be muzzled depending on Boboniu\'s mood.  Otherwise, Du won\'t do anything. Boboniu\'s mood is a constant m. On the i-th day:  If Du can speak and ai>m, then Boboniu will be angry and muzzle him for d days, which means that Du won\'t be able to speak on the i+1,i+2,\xe2\x8b\xaf,min(i+d,n)-th days.  Otherwise, Boboniu won\'t do anything. The total fun factor is the sum of the fun factors on the days when Du can speak.Du asked you to find the maximum total fun factor among all possible permutations of a." 1800
1393E2 "Twilight and Ancient Scroll (harder version)" "dp,hashing,implementation,string suffix structures,strings,two pointers" "This is a harder version of the problem E with larger constraints.Twilight Sparkle has received a new task from Princess Celestia. This time she asked to decipher the ancient scroll containing important knowledge of pony origin.To hide the crucial information from evil eyes, pony elders cast a spell on the scroll. That spell adds exactly one letter in any place to each word it is cast on. To make the path to the knowledge more tangled elders chose some of words in the scroll and cast a spell on them.Twilight Sparkle knows that the elders admired the order in all things so the scroll original scroll contained words in lexicographically non-decreasing order. She is asked to delete one letter from some of the words of the scroll (to undo the spell) to get some version of the original scroll. Unfortunately, there may be more than one way to recover the ancient scroll. To not let the important knowledge slip by Twilight has to look through all variants of the original scroll and find the required one. To estimate the maximum time Twilight may spend on the work she needs to know the number of variants she has to look through. She asks you to find that number! Since that number can be very big, Twilight asks you to find it modulo 109+7.It may occur that princess Celestia has sent a wrong scroll so the answer may not exist.A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 3200
1393E1 "Twilight and Ancient Scroll (easier version)" "dp,hashing,implementation,string suffix structures,strings" "This is an easier version of the problem E with smaller constraints.Twilight Sparkle has received a new task from Princess Celestia. This time she asked to decipher the ancient scroll containing important knowledge of pony origin.To hide the crucial information from evil eyes, pony elders cast a spell on the scroll. That spell adds exactly one letter in any place to each word it is cast on. To make the path to the knowledge more tangled elders chose some of words in the scroll and cast a spell on them.Twilight Sparkle knows that the elders admired the order in all things so the scroll original scroll contained words in lexicographically non-decreasing order. She is asked to delete one letter from some of the words of the scroll (to undo the spell) to get some version of the original scroll. Unfortunately, there may be more than one way to recover the ancient scroll. To not let the important knowledge slip by Twilight has to look through all variants of the original scroll and find the required one. To estimate the maximum time Twilight may spend on the work she needs to know the number of variants she has to look through. She asks you to find that number! Since that number can be very big, Twilight asks you to find it modulo 109+7.It may occur that princess Celestia has sent a wrong scroll so the answer may not exist.A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 2800
1393D "Rarity and New Dress" "dfs and similar,dp,implementation,shortest paths" "Carousel Boutique is busy again! Rarity has decided to visit the pony ball and she surely needs a new dress, because going out in the same dress several times is a sign of bad manners. First of all, she needs a dress pattern, which she is going to cut out from the rectangular piece of the multicolored fabric.The piece of the multicolored fabric consists of n\xc3\x97m separate square scraps. Since Rarity likes dresses in style, a dress pattern must only include scraps sharing the same color. A dress pattern must be the square, and since Rarity is fond of rhombuses, the sides of a pattern must form a 45\xe2\x88\x98 angle with sides of a piece of fabric (that way it will be resembling the traditional picture of a rhombus).Examples of proper dress patterns:  Examples of improper dress patterns:  The first one consists of multi-colored scraps, the second one goes beyond the bounds of the piece of fabric, the third one is not a square with sides forming a 45\xe2\x88\x98 angle with sides of the piece of fabric.Rarity wonders how many ways to cut out a dress pattern that satisfies all the conditions that do exist. Please help her and satisfy her curiosity so she can continue working on her new masterpiece!" 2100
1393C "Pinkie Pie Eats Patty-cakes" "constructive algorithms,greedy,math,sortings" "Pinkie Pie has bought a bag of patty-cakes with different fillings! But it appeared that not all patty-cakes differ from one another with filling. In other words, the bag contains some patty-cakes with the same filling.Pinkie Pie eats the patty-cakes one-by-one. She likes having fun so she decided not to simply eat the patty-cakes but to try not to eat the patty-cakes with the same filling way too often. To achieve this she wants the minimum distance between the eaten with the same filling to be the largest possible. Herein Pinkie Pie called the distance between two patty-cakes the number of eaten patty-cakes strictly between them.Pinkie Pie can eat the patty-cakes in any order. She is impatient about eating all the patty-cakes up so she asks you to help her to count the greatest minimum distance between the eaten patty-cakes with the same filling amongst all possible orders of eating!Pinkie Pie is going to buy more bags of patty-cakes so she asks you to solve this problem for several bags!" 1700
1393B "Applejack and Storages" "constructive algorithms,data structures,greedy,implementation" "This year in Equestria was a year of plenty, so Applejack has decided to build some new apple storages. According to the advice of the farm designers, she chose to build two storages with non-zero area: one in the shape of a square and another one in the shape of a rectangle (which possibly can be a square as well).Applejack will build the storages using planks, she is going to spend exactly one plank on each side of the storage. She can get planks from her friend\'s company. Initially, the company storehouse has n planks, Applejack knows their lengths. The company keeps working so it receives orders and orders the planks itself. Applejack\'s friend can provide her with information about each operation. For convenience, he will give her information according to the following format:  + x: the storehouse received a plank with length x  \xe2\x88\x92 x: one plank with length x was removed from the storehouse (it is guaranteed that the storehouse had some planks with length x). Applejack is still unsure about when she is going to order the planks so she wants to know if she can order the planks to build rectangular and square storages out of them after every event at the storehouse. Applejack is busy collecting apples and she has completely no time to do the calculations so she asked you for help!We remind you that all four sides of a square are equal, and a rectangle has two pairs of equal sides." 1400
1393A "Rainbow Dash, Fluttershy and Chess Coloring" greedy,math "One evening Rainbow Dash and Fluttershy have come up with a game. Since the ponies are friends, they have decided not to compete in the game but to pursue a common goal. The game starts on a square flat grid, which initially has the outline borders built up. Rainbow Dash and Fluttershy have flat square blocks with size 1\xc3\x971, Rainbow Dash has an infinite amount of light blue blocks, Fluttershy has an infinite amount of yellow blocks. The blocks are placed according to the following rule: each newly placed block must touch the built on the previous turns figure by a side (note that the outline borders of the grid are built initially). At each turn, one pony can place any number of blocks of her color according to the game rules.Rainbow and Fluttershy have found out that they can build patterns on the grid of the game that way. They have decided to start with something simple, so they made up their mind to place the blocks to form a chess coloring. Rainbow Dash is well-known for her speed, so she is interested in the minimum number of turns she and Fluttershy need to do to get a chess coloring, covering the whole grid with blocks. Please help her find that number!Since the ponies can play many times on different boards, Rainbow Dash asks you to find the minimum numbers of turns for several grids of the games.The chess coloring in two colors is the one in which each square is neighbor by side only with squares of different colors." 800
1392I "Kevin and Grid" fft,graphs,math "As Kevin is in BigMan\'s house, suddenly a trap sends him onto a grid with n rows and m columns.BigMan\'s trap is configured by two arrays: an array a1,a2,\xe2\x80\xa6,an and an array b1,b2,\xe2\x80\xa6,bm.In the i-th row there is a heater which heats the row by ai degrees, and in the j-th column there is a heater which heats the column by bj degrees, so that the temperature of cell (i,j) is ai+bj.Fortunately, Kevin has a suit with one parameter x and two modes:  heat resistance. In this mode suit can stand all temperatures greater or equal to x, but freezes as soon as reaches a cell with temperature less than x.  cold resistance. In this mode suit can stand all temperatures less than x, but will burn as soon as reaches a cell with temperature at least x.Once Kevin lands on a cell the suit automatically turns to cold resistance mode if the cell has temperature less than x, or to heat resistance mode otherwise, and cannot change after that.We say that two cells are adjacent if they share an edge.Let a path be a sequence c1,c2,\xe2\x80\xa6,ck of cells such that ci and ci+1 are adjacent for 1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x921.We say that two cells are connected if there is a path between the two cells consisting only of cells that Kevin can step on.A connected component is a maximal set of pairwise connected cells.We say that a connected component is good if Kevin can escape the grid starting from it  \xe2\x80\x94 when it contains at least one border cell of the grid, and that it\'s bad otherwise.To evaluate the situation, Kevin gives a score of 1 to each good component and a score of 2 for each bad component.The final score will be the difference between the total score of components with temperatures bigger than or equal to x and the score of components with temperatures smaller than x.There are q possible values of x that Kevin can use, and for each of them Kevin wants to know the final score.Help Kevin defeat BigMan!" 3300
1392H "ZS Shuffles Cards" combinatorics,dp,math,probabilities "zscoder has a deck of n+m custom-made cards, which consists of n cards labelled from 1 to n and m jokers. Since zscoder is lonely, he wants to play a game with himself using those cards. Initially, the deck is shuffled uniformly randomly and placed on the table. zscoder has a set S which is initially empty. Every second, zscoder draws the top card from the deck.   If the card has a number x written on it, zscoder removes the card and adds x to the set S.  If the card drawn is a joker, zscoder places all the cards back into the deck and reshuffles (uniformly randomly) the n+m cards to form a new deck (hence the new deck now contains all cards from 1 to n and the m jokers). Then, if S currently contains all the elements from 1 to n, the game ends. Shuffling the deck doesn\'t take time at all. What is the expected number of seconds before the game ends? We can show that the answer can be written in the form PQ where P,Q are relatively prime integers and Q\xe2\x89\xa00mod998244353. Output the value of (P\xe2\x8b\x85Q\xe2\x88\x921) modulo 998244353." 3000
1392G "Omkar and Pies" "bitmasks,dfs and similar,dp,math,shortest paths" "Omkar has a pie tray with k (2\xe2\x89\xa4k\xe2\x89\xa420) spots. Each spot in the tray contains either a chocolate pie or a pumpkin pie. However, Omkar does not like the way that the pies are currently arranged, and has another ideal arrangement that he would prefer instead.To assist Omkar, n elves have gathered in a line to swap the pies in Omkar\'s tray. The j-th elf from the left is able to swap the pies at positions aj and bj in the tray.In order to get as close to his ideal arrangement as possible, Omkar may choose a contiguous subsegment of the elves and then pass his pie tray through the subsegment starting from the left. However, since the elves have gone to so much effort to gather in a line, they request that Omkar\'s chosen segment contain at least m (1\xe2\x89\xa4m\xe2\x89\xa4n) elves.Formally, Omkar may choose two integers l and r satisfying 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and r\xe2\x88\x92l+1\xe2\x89\xa5m so that first the pies in positions al and bl will be swapped, then the pies in positions al+1 and bl+1 will be swapped, etc. until finally the pies in positions ar and br are swapped.Help Omkar choose a segment of elves such that the amount of positions in Omkar\'s final arrangement that contain the same type of pie as in his ideal arrangement is the maximum possible. Note that since Omkar has a big imagination, it might be that the amounts of each type of pie in his original arrangement and in his ideal arrangement do not match." 2900
1392F "Omkar and Landslide" "binary search,constructive algorithms,data structures,greedy,math" "Omkar is standing at the foot of Celeste mountain. The summit is n meters away from him, and he can see all of the mountains up to the summit, so for all 1\xe2\x89\xa4j\xe2\x89\xa4n he knows that the height of the mountain at the point j meters away from himself is hj meters. It turns out that for all j satisfying 1\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x921, hj<hj+1 (meaning that heights are strictly increasing).Suddenly, a landslide occurs! While the landslide is occurring, the following occurs: every minute, if hj+2\xe2\x89\xa4hj+1, then one square meter of dirt will slide from position j+1 to position j, so that hj+1 is decreased by 1 and hj is increased by 1. These changes occur simultaneously, so for example, if hj+2\xe2\x89\xa4hj+1 and hj+1+2\xe2\x89\xa4hj+2 for some j, then hj will be increased by 1, hj+2 will be decreased by 1, and hj+1 will be both increased and decreased by 1, meaning that in effect hj+1 is unchanged during that minute.The landslide ends when there is no j such that hj+2\xe2\x89\xa4hj+1. Help Omkar figure out what the values of h1,\xe2\x80\xa6,hn will be after the landslide ends. It can be proven that under the given constraints, the landslide will always end in finitely many minutes.Note that because of the large amount of input, it is recommended that your code uses fast IO." 2400
1392E "Omkar and Duck" "bitmasks,constructive algorithms,interactive,math" "This is an interactive problem.Omkar has just come across a duck! The duck is walking on a grid with n rows and n columns (2\xe2\x89\xa4n\xe2\x89\xa425) so that the grid contains a total of n2 cells. Let\'s denote by (x,y) the cell in the x-th row from the top and the y-th column from the left. Right now, the duck is at the cell (1,1) (the cell in the top left corner) and would like to reach the cell (n,n) (the cell in the bottom right corner) by moving either down 1 cell or to the right 1 cell each second.Since Omkar thinks ducks are fun, he wants to play a game with you based on the movement of the duck. First, for each cell (x,y) in the grid, you will tell Omkar a nonnegative integer ax,y not exceeding 1016, and Omkar will then put ax,y uninteresting problems in the cell (x,y). After that, the duck will start their journey from (1,1) to (n,n). For each cell (x,y) that the duck crosses during their journey (including the cells (1,1) and (n,n)), the duck will eat the ax,y uninteresting problems in that cell. Once the duck has completed their journey, Omkar will measure their mass to determine the total number k of uninteresting problems that the duck ate on their journey, and then tell you k.Your challenge, given k, is to exactly reproduce the duck\'s path, i. e. to tell Omkar precisely which cells the duck crossed on their journey. To be sure of your mastery of this game, Omkar will have the duck complete q different journeys (1\xe2\x89\xa4q\xe2\x89\xa4103). Note that all journeys are independent: at the beginning of each journey, the cell (x,y) will still contain ax,y uninteresting tasks." 2100
1392D "Omkar and Bed Wars" dp,greedy "Omkar is playing his favorite pixelated video game, Bed Wars! In Bed Wars, there are n players arranged in a circle, so that for all j such that 2\xe2\x89\xa4j\xe2\x89\xa4n, player j\xe2\x88\x921 is to the left of the player j, and player j is to the right of player j\xe2\x88\x921. Additionally, player n is to the left of player 1, and player 1 is to the right of player n.Currently, each player is attacking either the player to their left or the player to their right. This means that each player is currently being attacked by either 0, 1, or 2 other players. A key element of Bed Wars strategy is that if a player is being attacked by exactly 1 other player, then they should logically attack that player in response. If instead a player is being attacked by 0 or 2 other players, then Bed Wars strategy says that the player can logically attack either of the adjacent players.Unfortunately, it might be that some players in this game are not following Bed Wars strategy correctly. Omkar is aware of whom each player is currently attacking, and he can talk to any amount of the n players in the game to make them instead attack another player  \xe2\x80\x94 i. e. if they are currently attacking the player to their left, Omkar can convince them to instead attack the player to their right; if they are currently attacking the player to their right, Omkar can convince them to instead attack the player to their left. Omkar would like all players to be acting logically. Calculate the minimum amount of players that Omkar needs to talk to so that after all players he talked to (if any) have changed which player they are attacking, all players are acting logically according to Bed Wars strategy." 1700
1392C "Omkar and Waterslide" greedy,implementation "Omkar is building a waterslide in his water park, and he needs your help to ensure that he does it as efficiently as possible.Omkar currently has n supports arranged in a line, the i-th of which has height ai. Omkar wants to build his waterslide from the right to the left, so his supports must be nondecreasing in height in order to support the waterslide. In 1 operation, Omkar can do the following: take any contiguous subsegment of supports which is nondecreasing by heights and add 1 to each of their heights. Help Omkar find the minimum number of operations he needs to perform to make his supports able to support his waterslide!An array b is a subsegment of an array c if b can be obtained from c by deletion of several (possibly zero or all) elements from the beginning and several (possibly zero or all) elements from the end.An array b1,b2,\xe2\x80\xa6,bn is called nondecreasing if bi\xe2\x89\xa4bi+1 for every i from 1 to n\xe2\x88\x921." 1200
1392B "Omkar and Infinity Clock" implementation,math "Being stuck at home, Ray became extremely bored. To pass time, he asks Lord Omkar to use his time bending power: Infinity Clock! However, Lord Omkar will only listen to mortals who can solve the following problem:You are given an array a of n integers. You are also given an integer k. Lord Omkar wants you to do k operations with this array.Define one operation as the following:   Set d to be the maximum value of your array.  For every i from 1 to n, replace ai with d\xe2\x88\x92ai. The goal is to predict the contents in the array after k operations. Please help Ray determine what the final sequence will look like!" 800
1392A "Omkar and Password" greedy,math "Lord Omkar has permitted you to enter the Holy Church of Omkar! To test your worthiness, Omkar gives you a password which you must interpret!A password is an array a of n positive integers. You apply the following operation to the array: pick any two adjacent numbers that are not equal to each other and replace them with their sum. Formally, choose an index i such that 1\xe2\x89\xa4i<n and ai\xe2\x89\xa0ai+1, delete both ai and ai+1 from the array and put ai+ai+1 in their place. For example, for array [7,4,3,7] you can choose i=2 and the array will become [7,4+3,7]=[7,7,7]. Note that in this array you can\'t apply this operation anymore.Notice that one operation will decrease the size of the password by 1. What is the shortest possible length of the password after some number (possibly 0) of operations?" 800
1391E "Pairs of Pairs" "constructive algorithms,dfs and similar,graphs,greedy,trees" "You have a simple and connected undirected graph consisting of n nodes and m edges.Consider any way to pair some subset of these n nodes such that no node is present in more than one pair. This pairing is valid if for every pair of pairs, the induced subgraph containing all 4 nodes, two from each pair, has at most 2 edges (out of the 6 possible edges). More formally, for any two pairs, (a,b) and (c,d), the induced subgraph with nodes {a,b,c,d} should have at most 2 edges. Please note that the subgraph induced by a set of nodes contains nodes only from this set and edges which have both of its end points in this set.Now, do one of the following:   Find a simple path consisting of at least \xe2\x8c\x88n2\xe2\x8c\x89 nodes. Here, a path is called simple if it does not visit any node multiple times.  Find a valid pairing in which at least \xe2\x8c\x88n2\xe2\x8c\x89 nodes are paired. It can be shown that it is possible to find at least one of the two in every graph satisfying constraints from the statement." 2600
1391D 505 "bitmasks,brute force,constructive algorithms,dp,greedy,implementation" "A binary matrix is called good if every even length square sub-matrix has an odd number of ones. Given a binary matrix a consisting of n rows and m columns, determine the minimum number of cells you need to change to make it good, or report that there is no way to make it good at all. All the terms above have their usual meanings \xe2\x80\x94 refer to the Notes section for their formal definitions." 2000
1391C "Cyclic Permutations" combinatorics,dp,graphs,math "A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).Consider a permutation p of length n, we build a graph of size n using it as follows:   For every 1\xe2\x89\xa4i\xe2\x89\xa4n, find the largest j such that 1\xe2\x89\xa4j<i and pj>pi, and add an undirected edge between node i and node j  For every 1\xe2\x89\xa4i\xe2\x89\xa4n, find the smallest j such that i<j\xe2\x89\xa4n and pj>pi, and add an undirected edge between node i and node j In cases where no such j exists, we make no edges. Also, note that we make edges between the corresponding indices, not the values at those indices.For clarity, consider as an example n=4, and p=[3,1,4,2]; here, the edges of the graph are (1,3),(2,1),(2,3),(4,3).A permutation p is cyclic if the graph built using p has at least one simple cycle. Given n, find the number of cyclic permutations of length n. Since the number may be very large, output it modulo 109+7.Please refer to the Notes section for the formal definition of a simple cycle" 1500
1391B "Fix You" "brute force,greedy,implementation" "Consider a conveyor belt represented using a grid consisting of n rows and m columns. The cell in the i-th row from the top and the j-th column from the left is labelled (i,j). Every cell, except (n,m), has a direction R (Right) or D (Down) assigned to it. If the cell (i,j) is assigned direction R, any luggage kept on that will move to the cell (i,j+1). Similarly, if the cell (i,j) is assigned direction D, any luggage kept on that will move to the cell (i+1,j). If at any moment, the luggage moves out of the grid, it is considered to be lost. There is a counter at the cell (n,m) from where all luggage is picked. A conveyor belt is called functional if and only if any luggage reaches the counter regardless of which cell it is placed in initially. More formally, for every cell (i,j), any luggage placed in this cell should eventually end up in the cell (n,m). This may not hold initially; you are, however, allowed to change the directions of some cells to make the conveyor belt functional. Please determine the minimum amount of cells you have to change.Please note that it is always possible to make any conveyor belt functional by changing the directions of some set of cells." 800
1391A Suborrays "constructive algorithms,math" "A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).For a positive integer n, we call a permutation p of length n good if the following condition holds for every pair i and j (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n) \xe2\x80\x94   (pi OR pi+1 OR \xe2\x80\xa6 OR pj\xe2\x88\x921 OR pj)\xe2\x89\xa5j\xe2\x88\x92i+1, where OR denotes the bitwise OR operation. In other words, a permutation p is good if for every subarray of p, the OR of all elements in it is not less than the number of elements in that subarray. Given a positive integer n, output any good permutation of length n. We can show that for the given constraints such a permutation always exists." 800
1389G "Directing Edges" "dfs and similar,dp,graphs,trees" "You are given an undirected connected graph consisting of n vertices and m edges. k vertices of this graph are special.You have to direct each edge of this graph or leave it undirected. If you leave the i-th edge undirected, you pay wi coins, and if you direct it, you don\'t have to pay for it.Let\'s call a vertex saturated if it is reachable from each special vertex along the edges of the graph (if an edge is undirected, it can be traversed in both directions). After you direct the edges of the graph (possibly leaving some of them undirected), you receive ci coins for each saturated vertex i. Thus, your total profit can be calculated as \xe2\x88\x91i\xe2\x88\x88Sci\xe2\x88\x92\xe2\x88\x91j\xe2\x88\x88Uwj, where S is the set of saturated vertices, and U is the set of edges you leave undirected.For each vertex i, calculate the maximum possible profit you can get if you have to make the vertex i saturated." 2800
1389F "Bicolored Segments" "data structures,dp,graph matchings,sortings" "You are given n segments [l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn]. Each segment has one of two colors: the i-th segment\'s color is ti.Let\'s call a pair of segments i and j bad if the following two conditions are met:  ti\xe2\x89\xa0tj;  the segments [li,ri] and [lj,rj] intersect, embed or touch, i.\xe2\x80\x89e. there exists an integer x such that x\xe2\x88\x88[li,ri] and x\xe2\x88\x88[lj,rj]. Calculate the maximum number of segments that can be selected from the given ones, so that there is no bad pair among the selected ones." 2600
1389E "Calendar Ambiguity" "math,number theory" "Berland year consists of m months with d days each. Months are numbered from 1 to m. Berland week consists of w days. The first day of the year is also the first day of the week. Note that the last week of the year might be shorter than w days.A pair (x,y) such that x<y is ambiguous if day x of month y is the same day of the week as day y of month x.Count the number of ambiguous pairs." 2200
1389D "Segment Intersections" "brute force,greedy,implementation,math" "You are given two lists of segments [al1,ar1],[al2,ar2],\xe2\x80\xa6,[aln,arn] and [bl1,br1],[bl2,br2],\xe2\x80\xa6,[bln,brn].Initially, all segments [ali,ari] are equal to [l1,r1] and all segments [bli,bri] are equal to [l2,r2].In one step, you can choose one segment (either from the first or from the second list) and extend it by 1. In other words, suppose you\'ve chosen segment [x,y] then you can transform it either into [x\xe2\x88\x921,y] or into [x,y+1].Let\'s define a total intersection I as the sum of lengths of intersections of the corresponding pairs of segments, i.e. n\xe2\x88\x91i=1intersection_length([ali,ari],[bli,bri]). Empty intersection has length 0 and length of a segment [x,y] is equal to y\xe2\x88\x92x.What is the minimum number of steps you need to make I greater or equal to k?" 2100
1389C "Good String" "brute force,dp,greedy,two pointers" "Let\'s call left cyclic shift of some string t1t2t3\xe2\x80\xa6tn\xe2\x88\x921tn as string t2t3\xe2\x80\xa6tn\xe2\x88\x921tnt1.Analogically, let\'s call right cyclic shift of string t as string tnt1t2t3\xe2\x80\xa6tn\xe2\x88\x921.Let\'s say string t is good if its left cyclic shift is equal to its right cyclic shift.You are given string s which consists of digits 0\xe2\x80\x939.What is the minimum number of characters you need to erase from s to make it good?" 1500
1389B "Array Walk" "brute force,dp,greedy" "You are given an array a1,a2,\xe2\x80\xa6,an, consisting of n positive integers. Initially you are standing at index 1 and have a score equal to a1. You can perform two kinds of moves:   move right \xe2\x80\x94 go from your current index x to x+1 and add ax+1 to your score. This move can only be performed if x<n.  move left \xe2\x80\x94 go from your current index x to x\xe2\x88\x921 and add ax\xe2\x88\x921 to your score. This move can only be performed if x>1. Also, you can\'t perform two or more moves to the left in a row. You want to perform exactly k moves. Also, there should be no more than z moves to the left among them.What is the maximum score you can achieve?" 1600
1389A "LCM Problem" "constructive algorithms,greedy,math,number theory" "Let LCM(x,y) be the minimum positive integer that is divisible by both x and y. For example, LCM(13,37)=481, LCM(9,6)=18.You are given two integers l and r. Find two integers x and y such that l\xe2\x89\xa4x<y\xe2\x89\xa4r and l\xe2\x89\xa4LCM(x,y)\xe2\x89\xa4r." 800
1388E "Uncle Bogdan and Projections" "data structures,geometry,sortings" "After returning to shore, uncle Bogdan usually visits the computer club ""The Rock"", to solve tasks in a pleasant company. One day, uncle Bogdan met his good old friend who told him one unusual task...There are nn non-intersecting horizontal segments with ends in integers points on the plane with the standard cartesian coordinate system. All segments are strictly above the OXOX axis. You can choose an arbitrary vector (aa, bb), where b<0b<0 and coordinates are real numbers, and project all segments to OXOX axis along this vector. The projections shouldn\'t intersect but may touch each other.Find the minimum possible difference between xx coordinate of the right end of the rightmost projection and xx coordinate of the left end of the leftmost projection." 2700
1388D "Captain Flint and Treasure" "data structures,dfs and similar,graphs,greedy,implementation,trees" "Captain Fint is involved in another treasure hunt, but have found only one strange problem. The problem may be connected to the treasure\'s location or may not. That\'s why captain Flint decided to leave the solving the problem to his crew and offered an absurdly high reward: one day off. The problem itself sounds like this...There are two arrays a and b of length n. Initially, an ans is equal to 0 and the following operation is defined:   Choose position i (1\xe2\x89\xa4i\xe2\x89\xa4n);  Add ai to ans;  If bi\xe2\x89\xa0\xe2\x88\x921 then add ai to abi. What is the maximum ans you can get by performing the operation on each i (1\xe2\x89\xa4i\xe2\x89\xa4n) exactly once?Uncle Bogdan is eager to get the reward, so he is asking your help to find the optimal order of positions to perform the operation on them." 2000
1388C "Uncle Bogdan and Country Happiness" "dfs and similar,greedy,math,trees" "Uncle Bogdan is in captain Flint\'s crew for a long time and sometimes gets nostalgic for his homeland. Today he told you how his country introduced a happiness index.There are n cities and n\xe2\x88\x921 undirected roads connecting pairs of cities. Citizens of any city can reach any other city traveling by these roads. Cities are numbered from 1 to n and the city 1 is a capital. In other words, the country has a tree structure.There are m citizens living in the country. A pi people live in the i-th city but all of them are working in the capital. At evening all citizens return to their home cities using the shortest paths. Every person has its own mood: somebody leaves his workplace in good mood but somebody are already in bad mood. Moreover any person can ruin his mood on the way to the hometown. If person is in bad mood he won\'t improve it.Happiness detectors are installed in each city to monitor the happiness of each person who visits the city. The detector in the i-th city calculates a happiness index hi as the number of people in good mood minus the number of people in bad mood. Let\'s say for the simplicity that mood of a person doesn\'t change inside the city.Happiness detector is still in development, so there is a probability of a mistake in judging a person\'s happiness. One late evening, when all citizens successfully returned home, the government asked uncle Bogdan (the best programmer of the country) to check the correctness of the collected happiness indexes.Uncle Bogdan successfully solved the problem. Can you do the same?More formally, You need to check: ""Is it possible that, after all people return home, for each city i the happiness index will be equal exactly to hi""." 1800
1388B "Captain Flint and a Long Voyage" greedy,math "Captain Flint and his crew keep heading to a savage shore of Byteland for several months already, drinking rum and telling stories. In such moments uncle Bogdan often remembers his nephew Denis. Today, he has told a story about how Denis helped him to come up with an interesting problem and asked the crew to solve it.In the beginning, uncle Bogdan wrote on a board a positive integer x consisting of n digits. After that, he wiped out x and wrote integer k instead, which was the concatenation of binary representations of digits x consists of (without leading zeroes). For example, let x=729, then k=111101001 (since 7=111, 2=10, 9=1001).After some time, uncle Bogdan understood that he doesn\'t know what to do with k and asked Denis to help. Denis decided to wipe last n digits of k and named the new number as r.As a result, Denis proposed to find such integer x of length n that r (as number) is maximum possible. If there are multiple valid x then Denis is interested in the minimum one.All crew members, including captain Flint himself, easily solved the task. All, except cabin boy Kostya, who was too drunk to think straight. But what about you?Note: in this task, we compare integers (x or k) as numbers (despite what representations they are written in), so 729<1999 or 111<1000." 1000
1388A "Captain Flint and Crew Recruitment" "brute force,greedy,math,number theory" "Despite his bad reputation, Captain Flint is a friendly person (at least, friendly to animals). Now Captain Flint is searching worthy sailors to join his new crew (solely for peaceful purposes). A sailor is considered as worthy if he can solve Flint\'s task.Recently, out of blue Captain Flint has been interested in math and even defined a new class of integers. Let\'s define a positive integer x as nearly prime if it can be represented as p\xe2\x8b\x85q, where 1<p<q and p and q are prime numbers. For example, integers 6 and 10 are nearly primes (since 2\xe2\x8b\x853=6 and 2\xe2\x8b\x855=10), but integers 1, 3, 4, 16, 17 or 44 are not.Captain Flint guessed an integer n and asked you: can you represent it as the sum of 4 different positive integers where at least 3 of them should be nearly prime.Uncle Bogdan easily solved the task and joined the crew. Can you do the same?" 800
1387C Viruses "*special problem,dp,shortest paths,string suffix structures" "The Committee for Research on Binary Viruses discovered a method of replication for a large family of viruses whose genetic codes are sequences of zeros and ones. Each virus originates from a single gene; for simplicity genes are denoted by integers from 0 to G\xe2\x88\x921. At each moment in time a virus is a sequence of genes. When mutation occurs, one of the genes from the sequence is replaced by a certain sequence of genes, according to the mutation table. The virus stops mutating when it consists only of genes 0 and 1.For instance, for the following mutation table: 2\xe2\x86\x92\xe2\x9f\xa80 1\xe2\x9f\xa93\xe2\x86\x92\xe2\x9f\xa82 0 0\xe2\x9f\xa93\xe2\x86\x92\xe2\x9f\xa81 3\xe2\x9f\xa94\xe2\x86\x92\xe2\x9f\xa80 3 1 2\xe2\x9f\xa95\xe2\x86\x92\xe2\x9f\xa82 1\xe2\x9f\xa95\xe2\x86\x92\xe2\x9f\xa85\xe2\x9f\xa9 a virus that initially consisted of a single gene 4, could have mutated as follows: \xe2\x9f\xa84\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80 3 1 2_\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80 2 0 0_ 1 2\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80 0 1_ 0 0 1 2\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80 0 1 0 0 1 0 1_\xe2\x9f\xa9 or in another way: \xe2\x9f\xa84\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80 3 1 2_\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80 1 3_ 1 2\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80 1 3 1 0 1_\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80 1 2 0 0_ 1 0 1\xe2\x9f\xa9\xe2\x86\x92\xe2\x9f\xa80 1 0 1_ 0 0 1 0 1\xe2\x9f\xa9Viruses are detected by antibodies that identify the presence of specific continuous fragments of zeros and ones in the viruses\' codes. For example, an antibody reacting to a fragment \xe2\x9f\xa80 0 1 0 0\xe2\x9f\xa9 will detect a virus \xe2\x9f\xa80 0 1 0 0 1 0 1\xe2\x9f\xa9, but it will not detect a virus \xe2\x9f\xa80 1 0 1 0 0 1 0 1\xe2\x9f\xa9.For each gene from 2 to G\xe2\x88\x921, the scientists are wondering whether a given set of antibodies is enough to detect all viruses that can emerge through mutations from this gene. If not, they want to know the length of the shortest virus that cannot be detected.It may happen that sometimes scientists don\'t have any antibodies. Then of course no virus can be detected, so the scientists are only interested in the length of the shortest possible virus that can emerge from the gene mutations." 2900
1387B2 "Village (Maximum)" "*special problem,dfs and similar,trees" "This problem is split into two tasks. In this task, you are required to find the maximum possible answer. In the task Village (Minimum) you are required to find the minimum possible answer. Each task is worth 50 points.There are N houses in a certain village. A single villager lives in each of the houses. The houses are connected by roads. Each road connects two houses and is exactly 1 kilometer long. From each house it is possible to reach any other using one or several consecutive roads. In total there are N\xe2\x88\x921 roads in the village.One day all villagers decided to move to different houses \xe2\x80\x94 that is, after moving each house should again have a single villager living in it, but no villager should be living in the same house as before. We would like to know the largest possible total length in kilometers of the shortest paths between the old and the new houses for all villagers. Example village with seven houses For example, if there are seven houses connected by roads as shown on the figure, the largest total length is 18 km (this can be achieved by moving 1\xe2\x86\x927, 2\xe2\x86\x923, 3\xe2\x86\x924, 4\xe2\x86\x921, 5\xe2\x86\x922, 6\xe2\x86\x925, 7\xe2\x86\x926).Write a program that finds the largest total length of the shortest paths in kilometers and an example assignment of the new houses to the villagers." 2500
1387B1 "Village (Minimum)" "*special problem,dp,greedy,trees" "This problem is split into two tasks. In this task, you are required to find the minimum possible answer. In the task Village (Maximum) you are required to find the maximum possible answer. Each task is worth 50 points.There are N houses in a certain village. A single villager lives in each of the houses. The houses are connected by roads. Each road connects two houses and is exactly 1 kilometer long. From each house it is possible to reach any other using one or several consecutive roads. In total there are N\xe2\x88\x921 roads in the village.One day all villagers decided to move to different houses \xe2\x80\x94 that is, after moving each house should again have a single villager living in it, but no villager should be living in the same house as before. We would like to know the smallest possible total length in kilometers of the shortest paths between the old and the new houses for all villagers. Example village with seven houses For example, if there are seven houses connected by roads as shown on the figure, the smallest total length is 8 km (this can be achieved by moving 1\xe2\x86\x926, 2\xe2\x86\x924, 3\xe2\x86\x921, 4\xe2\x86\x922, 5\xe2\x86\x927, 6\xe2\x86\x923, 7\xe2\x86\x925).Write a program that finds the smallest total length of the shortest paths in kilometers and an example assignment of the new houses to the villagers." 2100
1387A Graph "*special problem,binary search,dfs and similar,dp,math,ternary search" "You are given an undirected graph where each edge has one of two colors: black or red.Your task is to assign a real number to each node so that:   for each black edge the sum of values at its endpoints is 1;  for each red edge the sum of values at its endpoints is 2;  the sum of the absolute values of all assigned numbers is the smallest possible. Otherwise, if it is not possible, report that there is no feasible assignment of the numbers." 2100
1386C Joker "*special problem,bitmasks,data structures,divide and conquer,dsu" "Joker returns to Gotham City to execute another evil plan. In Gotham City, there are N street junctions (numbered from 1 to N) and M streets (numbered from 1 to M). Each street connects two distinct junctions, and two junctions are connected by at most one street.For his evil plan, Joker needs to use an odd number of streets that together form a cycle. That is, for a junction S and an even positive integer k, there is a sequence of junctions S,s1,\xe2\x80\xa6,sk,S such that there are streets connecting (a) S and s1, (b) sk and S, and (c) si\xe2\x88\x921 and si for each i=2,\xe2\x80\xa6,k.However, the police are controlling the streets of Gotham City. On each day i, they monitor a different subset of all streets with consecutive numbers j: li\xe2\x89\xa4j\xe2\x89\xa4ri. These monitored streets cannot be a part of Joker\'s plan, of course. Unfortunately for the police, Joker has spies within the Gotham City Police Department; they tell him which streets are monitored on which day. Now Joker wants to find out, for some given number of days, whether he can execute his evil plan. On such a day there must be a cycle of streets, consisting of an odd number of streets which are not monitored on that day." 2800
1386B Mixture "*special problem,data structures,geometry,math,sortings" "Serge, the chef of the famous restaurant ""Salt, Pepper & Garlic"" is trying to obtain his first Michelin star. He has been informed that a secret expert plans to visit his restaurant this evening.Even though the expert\'s name hasn\'t been disclosed, Serge is certain he knows which dish from the menu will be ordered as well as what the taste preferences of the expert are. Namely, the expert requires an extremely precise proportion of salt, pepper and garlic powder in his dish.Serge keeps a set of bottles with mixtures of salt, pepper and garlic powder on a special shelf in the kitchen. For each bottle, he knows the exact amount of each of the ingredients in kilograms. Serge can combine any number of bottled mixtures (or just use one of them directly) to get a mixture of particular proportions needed for a certain dish.Luckily, the absolute amount of a mixture that needs to be added to a dish is so small that you can assume that the amounts in the bottles will always be sufficient. However, the numeric values describing the proportions may be quite large.Serge would like to know whether it is possible to obtain the expert\'s favourite mixture from the available bottles, and if so\xe2\x80\x94what is the smallest possible number of bottles needed to achieve that.Furthermore, the set of bottles on the shelf may change over time as Serge receives new ones or lends his to other chefs. So he would like to answer this question after each such change.For example, assume that expert\'s favorite mixture is 1:1:1 and there are three bottles of mixtures on the shelf: MixtureSaltPepperGarlic powder110203023002001003121527 Amount of ingredient in the bottle, kg To obtain the desired mixture it is enough to use an equivalent amount of mixtures from bottles 1 and 2. If bottle 2 is removed, then it is no longer possible to obtain it.Write a program that helps Serge to solve this task!" 2900
1386A Colors "*special problem,binary search,constructive algorithms,interactive" "Linda likes to change her hair color from time to time, and would be pleased if her boyfriend Archie would notice the difference between the previous and the new color. Archie always comments on Linda\'s hair color if and only if he notices a difference \xe2\x80\x94 so Linda always knows whether Archie has spotted the difference or not.There is a new hair dye series in the market where all available colors are numbered by integers from 1 to N such that a smaller difference of the numerical values also means less visual difference.Linda assumes that for these series there should be some critical color difference C (1\xe2\x89\xa4C\xe2\x89\xa4N) for which Archie will notice color difference between the current color colornew and the previous color colorprev if |colornew\xe2\x88\x92colorprev|\xe2\x89\xa5C and will not if |colornew\xe2\x88\x92colorprev|<C.Now she has bought N sets of hair dye from the new series \xe2\x80\x94 one for each of the colors from 1 to N, and is ready to set up an experiment. Linda will change her hair color on a regular basis and will observe Archie\'s reaction \xe2\x80\x94 whether he will notice the color change or not. Since for the proper dye each set should be used completely, each hair color can be obtained no more than once.Before the experiment, Linda was using a dye from a different series which is not compatible with the new one, so for the clearness of the experiment Archie\'s reaction to the first used color is meaningless.Her aim is to find the precise value of C in a limited number of dyes. Write a program which finds the value of C by experimenting with the given N colors and observing Archie\'s reactions to color changes." 2700
1385G "Columns Swaps" "2-sat,dfs and similar,dsu,graphs,implementation" "You are given a table a of size 2\xc3\x97n (i.e. two rows and n columns) consisting of integers from 1 to n.In one move, you can choose some column j (1\xe2\x89\xa4j\xe2\x89\xa4n) and swap values a1,j and a2,j in it. Each column can be chosen no more than once.Your task is to find the minimum number of moves required to obtain permutations of size n in both first and second rows of the table or determine if it is impossible to do that.You have to answer t independent test cases.Recall that the permutation of size n is such an array of size n that contains each integer from 1 to n exactly once (the order of elements doesn\'t matter)." 2300
1385F "Removing Leaves" "data structures,greedy,implementation,trees" "You are given a tree (connected graph without cycles) consisting of n vertices. The tree is unrooted \xe2\x80\x94 it is just a connected undirected graph without cycles.In one move, you can choose exactly k leaves (leaf is such a vertex that is connected to only one another vertex) connected to the same vertex and remove them with edges incident to them. I.e. you choose such leaves u1,u2,\xe2\x80\xa6,uk that there are edges (u1,v), (u2,v), \xe2\x80\xa6, (uk,v) and remove these leaves and these edges.Your task is to find the maximum number of moves you can perform if you remove leaves optimally.You have to answer t independent test cases." 2300
1385E "Directing Edges" "constructive algorithms,dfs and similar,graphs" "You are given a graph consisting of n vertices and m edges. It is not guaranteed that the given graph is connected. Some edges are already directed and you can\'t change their direction. Other edges are undirected and you have to choose some direction for all these edges.You have to direct undirected edges in such a way that the resulting graph is directed and acyclic (i.e. the graph with all edges directed and having no directed cycles). Note that you have to direct all undirected edges.You have to answer t independent test cases." 2000
1385D "a-Good String" "bitmasks,brute force,divide and conquer,dp,implementation" "You are given a string s[1\xe2\x80\xa6n] consisting of lowercase Latin letters. It is guaranteed that n=2k for some integer k\xe2\x89\xa50.The string s[1\xe2\x80\xa6n] is called c-good if at least one of the following three conditions is satisfied:  The length of s is 1, and it consists of the character c (i.e. s1=c); The length of s is greater than 1, the first half of the string consists of only the character c (i.e. s1=s2=\xe2\x8b\xaf=sn2=c) and the second half of the string (i.e. the string sn2+1sn2+2\xe2\x80\xa6sn) is a (c+1)-good string;  The length of s is greater than 1, the second half of the string consists of only the character c (i.e. sn2+1=sn2+2=\xe2\x8b\xaf=sn=c) and the first half of the string (i.e. the string s1s2\xe2\x80\xa6sn2) is a (c+1)-good string. For example: ""aabc"" is \'a\'-good, ""ffgheeee"" is \'e\'-good.In one move, you can choose one index i from 1 to n and replace si with any lowercase Latin letter (any character from \'a\' to \'z\').Your task is to find the minimum number of moves required to obtain an \'a\'-good string from s (i.e. c-good string for c= \'a\'). It is guaranteed that the answer always exists.You have to answer t independent test cases.Another example of an \'a\'-good string is as follows. Consider the string s=""cdbbaaaa"". It is an \'a\'-good string, because:  the second half of the string (""aaaa"") consists of only the character \'a\';  the first half of the string (""cdbb"") is \'b\'-good string, because:   the second half of the string (""bb"") consists of only the character \'b\';  the first half of the string (""cd"") is \'c\'-good string, because:   the first half of the string (""c"") consists of only the character \'c\';  the second half of the string (""d"") is \'d\'-good string." 1500
1385C "Make It Good" greedy "You are given an array a consisting of n integers. You have to find the length of the smallest (shortest) prefix of elements you need to erase from a to make it a good array. Recall that the prefix of the array a=[a1,a2,\xe2\x80\xa6,an] is a subarray consisting several first elements: the prefix of the array a of length k is the array [a1,a2,\xe2\x80\xa6,ak] (0\xe2\x89\xa4k\xe2\x89\xa4n).The array b of length m is called good, if you can obtain a non-decreasing array c (c1\xe2\x89\xa4c2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4cm) from it, repeating the following operation m times (initially, c is empty):  select either the first or the last element of b, remove it from b, and append it to the end of the array c. For example, if we do 4 operations: take b1, then bm, then bm\xe2\x88\x921 and at last b2, then b becomes [b3,b4,\xe2\x80\xa6,bm\xe2\x88\x923] and c=[b1,bm,bm\xe2\x88\x921,b2].Consider the following example: b=[1,2,3,4,4,2,1]. This array is good because we can obtain non-decreasing array c from it by the following sequence of operations:  take the first element of b, so b=[2,3,4,4,2,1], c=[1];  take the last element of b, so b=[2,3,4,4,2], c=[1,1];  take the last element of b, so b=[2,3,4,4], c=[1,1,2];  take the first element of b, so b=[3,4,4], c=[1,1,2,2];  take the first element of b, so b=[4,4], c=[1,1,2,2,3];  take the last element of b, so b=[4], c=[1,1,2,2,3,4];  take the only element of b, so b=[], c=[1,1,2,2,3,4,4] \xe2\x80\x94 c is non-decreasing. Note that the array consisting of one element is good.Print the length of the shortest prefix of a to delete (erase), to make a to be a good array. Note that the required length can be 0.You have to answer t independent test cases." 1200
1385B "Restore the Permutation by Merger" greedy "A permutation of length n is a sequence of integers from 1 to n of length n containing each number exactly once. For example, [1], [4,3,5,1,2], [3,2,1] are permutations, and [1,1], [0,1], [2,2,1,4] are not.There was a permutation p[1\xe2\x80\xa6n]. It was merged with itself. In other words, let\'s take two instances of p and insert elements of the second p into the first maintaining relative order of elements. The result is a sequence of the length 2n.For example, if p=[3,1,2] some possible results are: [3,1,2,3,1,2], [3,3,1,1,2,2], [3,1,3,1,2,2]. The following sequences are not possible results of a merging: [1,3,2,1,2,3], [3,1,2,3,2,1], [3,3,1,2,2,1].For example, if p=[2,1] the possible results are: [2,2,1,1], [2,1,2,1]. The following sequences are not possible results of a merging: [1,1,2,2], [2,1,1,2], [1,2,2,1].Your task is to restore the permutation p by the given resulting sequence a. It is guaranteed that the answer exists and is unique.You have to answer t independent test cases." 800
1385A "Three Pairwise Maximums" math "You are given three positive (i.e. strictly greater than zero) integers x, y and z.Your task is to find positive integers a, b and c such that x=max(a,b), y=max(a,c) and z=max(b,c), or determine that it is impossible to find such a, b and c.You have to answer t independent test cases. Print required a, b and c in any (arbitrary) order." 800
1384B2 "Koa and the Beach (Hard Version)" "constructive algorithms,dp,greedy,implementation" "The only difference between easy and hard versions is on constraints. In this version constraints are higher. You can make hacks only if all versions of the problem are solved.Koa the Koala is at the beach!The beach consists (from left to right) of a shore, n+1 meters of sea and an island at n+1 meters from the shore.She measured the depth of the sea at 1,2,\xe2\x80\xa6,n meters from the shore and saved them in array d. di denotes the depth of the sea at i meters from the shore for 1\xe2\x89\xa4i\xe2\x89\xa4n.Like any beach this one has tide, the intensity of the tide is measured by parameter k and affects all depths from the beginning at time t=0 in the following way:  For a total of k seconds, each second, tide increases all depths by 1.  Then, for a total of k seconds, each second, tide decreases all depths by 1.  This process repeats again and again (ie. depths increase for k seconds then decrease for k seconds and so on ...).Formally, let\'s define 0-indexed array p=[0,1,2,\xe2\x80\xa6,k\xe2\x88\x922,k\xe2\x88\x921,k,k\xe2\x88\x921,k\xe2\x88\x922,\xe2\x80\xa6,2,1] of length 2k. At time t (0\xe2\x89\xa4t) depth at i meters from the shore equals di+p[tmod2k] (tmod2k denotes the remainder of the division of t by 2k). Note that the changes occur instantaneously after each second, see the notes for better understanding. At time t=0 Koa is standing at the shore and wants to get to the island. Suppose that at some time t (0\xe2\x89\xa4t) she is at x (0\xe2\x89\xa4x\xe2\x89\xa4n) meters from the shore:  In one second Koa can swim 1 meter further from the shore (x changes to x+1) or not swim at all (x stays the same), in both cases t changes to t+1.  As Koa is a bad swimmer, the depth of the sea at the point where she is can\'t exceed l at integer points of time (or she will drown). More formally, if Koa is at x (1\xe2\x89\xa4x\xe2\x89\xa4n) meters from the shore at the moment t (for some integer t\xe2\x89\xa50), the depth of the sea at this point  \xe2\x80\x94 dx+p[tmod2k]  \xe2\x80\x94 can\'t exceed l. In other words, dx+p[tmod2k]\xe2\x89\xa4l must hold always.  Once Koa reaches the island at n+1 meters from the shore, she stops and can rest.Note that while Koa swims tide doesn\'t have effect on her (ie. she can\'t drown while swimming). Note that Koa can choose to stay on the shore for as long as she needs and neither the shore or the island are affected by the tide (they are solid ground and she won\'t drown there). Koa wants to know whether she can go from the shore to the island. Help her!" 2200
1384B1 "Koa and the Beach (Easy Version)" "brute force,dp,greedy" "The only difference between easy and hard versions is on constraints. In this version constraints are lower. You can make hacks only if all versions of the problem are solved.Koa the Koala is at the beach!The beach consists (from left to right) of a shore, n+1 meters of sea and an island at n+1 meters from the shore.She measured the depth of the sea at 1,2,\xe2\x80\xa6,n meters from the shore and saved them in array d. di denotes the depth of the sea at i meters from the shore for 1\xe2\x89\xa4i\xe2\x89\xa4n.Like any beach this one has tide, the intensity of the tide is measured by parameter k and affects all depths from the beginning at time t=0 in the following way:  For a total of k seconds, each second, tide increases all depths by 1.  Then, for a total of k seconds, each second, tide decreases all depths by 1.  This process repeats again and again (ie. depths increase for k seconds then decrease for k seconds and so on ...).Formally, let\'s define 0-indexed array p=[0,1,2,\xe2\x80\xa6,k\xe2\x88\x922,k\xe2\x88\x921,k,k\xe2\x88\x921,k\xe2\x88\x922,\xe2\x80\xa6,2,1] of length 2k. At time t (0\xe2\x89\xa4t) depth at i meters from the shore equals di+p[tmod2k] (tmod2k denotes the remainder of the division of t by 2k). Note that the changes occur instantaneously after each second, see the notes for better understanding. At time t=0 Koa is standing at the shore and wants to get to the island. Suppose that at some time t (0\xe2\x89\xa4t) she is at x (0\xe2\x89\xa4x\xe2\x89\xa4n) meters from the shore:  In one second Koa can swim 1 meter further from the shore (x changes to x+1) or not swim at all (x stays the same), in both cases t changes to t+1.  As Koa is a bad swimmer, the depth of the sea at the point where she is can\'t exceed l at integer points of time (or she will drown). More formally, if Koa is at x (1\xe2\x89\xa4x\xe2\x89\xa4n) meters from the shore at the moment t (for some integer t\xe2\x89\xa50), the depth of the sea at this point  \xe2\x80\x94 dx+p[tmod2k]  \xe2\x80\x94 can\'t exceed l. In other words, dx+p[tmod2k]\xe2\x89\xa4l must hold always.  Once Koa reaches the island at n+1 meters from the shore, she stops and can rest.Note that while Koa swims tide doesn\'t have effect on her (ie. she can\'t drown while swimming). Note that Koa can choose to stay on the shore for as long as she needs and neither the shore or the island are affected by the tide (they are solid ground and she won\'t drown there). Koa wants to know whether she can go from the shore to the island. Help her!" 1900
1384A "Common Prefixes" "constructive algorithms,greedy,strings" "The length of the longest common prefix of two strings s=s1s2\xe2\x80\xa6sn and t=t1t2\xe2\x80\xa6tm is defined as the maximum integer k (0\xe2\x89\xa4k\xe2\x89\xa4min(n,m)) such that s1s2\xe2\x80\xa6sk equals t1t2\xe2\x80\xa6tk.Koa the Koala initially has n+1 strings s1,s2,\xe2\x80\xa6,sn+1.For each i (1\xe2\x89\xa4i\xe2\x89\xa4n) she calculated ai \xe2\x80\x94 the length of the longest common prefix of si and si+1.Several days later Koa found these numbers, but she couldn\'t remember the strings.So Koa would like to find some strings s1,s2,\xe2\x80\xa6,sn+1 which would have generated numbers a1,a2,\xe2\x80\xa6,an. Can you help her?If there are many answers print any. We can show that answer always exists for the given constraints." 1200
1383F "Special Edges" flows,graphs "Koa the Koala has a directed graph G with n nodes and m edges. Each edge has a capacity associated with it. Exactly k edges of the graph, numbered from 1 to k, are special, such edges initially have a capacity equal to 0.Koa asks you q queries. In each query she gives you k integers w1,w2,\xe2\x80\xa6,wk. This means that capacity of the i-th special edge becomes wi (and other capacities remain the same).Koa wonders: what is the maximum flow that goes from node 1 to node n after each such query?Help her!" 3200
1383E "Strange Operation" "combinatorics,data structures,dp" "Koa the Koala has a binary string s of length n. Koa can perform no more than n\xe2\x88\x921 (possibly zero) operations of the following form:In one operation Koa selects positions i and i+1 for some i with 1\xe2\x89\xa4i<|s| and sets si to max(si,si+1). Then Koa deletes position i+1 from s (after the removal, the remaining parts are concatenated).Note that after every operation the length of s decreases by 1.How many different binary strings can Koa obtain by doing no more than n\xe2\x88\x921 (possibly zero) operations modulo 109+7 (1000000007)?" 2800
1383D Rearrange "brute force,constructive algorithms,graphs,greedy,sortings" "Koa the Koala has a matrix A of n rows and m columns. Elements of this matrix are distinct integers from 1 to n\xe2\x8b\x85m (each number from 1 to n\xe2\x8b\x85m appears exactly once in the matrix).For any matrix M of n rows and m columns let\'s define the following:  The i-th row of M is defined as Ri(M)=[Mi1,Mi2,\xe2\x80\xa6,Mim] for all i (1\xe2\x89\xa4i\xe2\x89\xa4n).  The j-th column of M is defined as Cj(M)=[M1j,M2j,\xe2\x80\xa6,Mnj] for all j (1\xe2\x89\xa4j\xe2\x89\xa4m). Koa defines S(A)=(X,Y) as the spectrum of A, where X is the set of the maximum values in rows of A and Y is the set of the maximum values in columns of A.More formally:  X={max(R1(A)),max(R2(A)),\xe2\x80\xa6,max(Rn(A))}  Y={max(C1(A)),max(C2(A)),\xe2\x80\xa6,max(Cm(A))}Koa asks you to find some matrix A\xe2\x80\xb2 of n rows and m columns, such that each number from 1 to n\xe2\x8b\x85m appears exactly once in the matrix, and the following conditions hold:  S(A\xe2\x80\xb2)=S(A)  Ri(A\xe2\x80\xb2) is bitonic for all i (1\xe2\x89\xa4i\xe2\x89\xa4n)  Cj(A\xe2\x80\xb2) is bitonic for all j (1\xe2\x89\xa4j\xe2\x89\xa4m)  An array t (t1,t2,\xe2\x80\xa6,tk) is called bitonic if it first increases and then decreases. More formally: t is bitonic if there exists some position p (1\xe2\x89\xa4p\xe2\x89\xa4k) such that: t1<t2<\xe2\x80\xa6<tp>tp+1>\xe2\x80\xa6>tk.Help Koa to find such matrix or to determine that it doesn\'t exist." 2800
1383C "String Transformation 2" bitmasks,dp,graphs,trees "Note that the only difference between String Transformation 1 and String Transformation 2 is in the move Koa does. In this version the letter y Koa selects can be any letter from the first 20 lowercase letters of English alphabet (read statement for better understanding). You can make hacks in these problems independently.Koa the Koala has two strings A and B of the same length n (|A|=|B|=n) consisting of the first 20 lowercase English alphabet letters (ie. from a to t).In one move Koa:  selects some subset of positions p1,p2,\xe2\x80\xa6,pk (k\xe2\x89\xa51;1\xe2\x89\xa4pi\xe2\x89\xa4n;pi\xe2\x89\xa0pj if i\xe2\x89\xa0j) of A such that Ap1=Ap2=\xe2\x80\xa6=Apk=x (ie. all letters on this positions are equal to some letter x).  selects any letter y (from the first 20 lowercase letters in English alphabet).  sets each letter in positions p1,p2,\xe2\x80\xa6,pk to letter y. More formally: for each i (1\xe2\x89\xa4i\xe2\x89\xa4k) Koa sets Api=y. Note that you can only modify letters in string A.Koa wants to know the smallest number of moves she has to do to make strings equal to each other (A=B) or to determine that there is no way to make them equal. Help her!" 3100
1383B GameGame "bitmasks,constructive algorithms,dp,games,greedy,math" "Koa the Koala and her best friend want to play a game.The game starts with an array a of length n consisting of non-negative integers. Koa and her best friend move in turns and each have initially a score equal to 0. Koa starts.Let\'s describe a move in the game:  During his move, a player chooses any element of the array and removes it from this array, xor-ing it with the current score of the player. More formally: if the current score of the player is x and the chosen element is y, his new score will be x\xe2\x8a\x95y. Here \xe2\x8a\x95 denotes bitwise XOR operation. Note that after a move element y is removed from a.  The game ends when the array is empty. At the end of the game the winner is the player with the maximum score. If both players have the same score then it\'s a draw.If both players play optimally find out whether Koa will win, lose or draw the game." 1900
1383A "String Transformation 1" "dsu,graphs,greedy,sortings,strings,trees,two pointers" "Note that the only difference between String Transformation 1 and String Transformation 2 is in the move Koa does. In this version the letter y Koa selects must be strictly greater alphabetically than x (read statement for better understanding). You can make hacks in these problems independently.Koa the Koala has two strings A and B of the same length n (|A|=|B|=n) consisting of the first 20 lowercase English alphabet letters (ie. from a to t).In one move Koa:  selects some subset of positions p1,p2,\xe2\x80\xa6,pk (k\xe2\x89\xa51;1\xe2\x89\xa4pi\xe2\x89\xa4n;pi\xe2\x89\xa0pj if i\xe2\x89\xa0j) of A such that Ap1=Ap2=\xe2\x80\xa6=Apk=x (ie. all letters on this positions are equal to some letter x).  selects a letter y (from the first 20 lowercase letters in English alphabet) such that y>x (ie. letter y is strictly greater alphabetically than x).  sets each letter in positions p1,p2,\xe2\x80\xa6,pk to letter y. More formally: for each i (1\xe2\x89\xa4i\xe2\x89\xa4k) Koa sets Api=y. Note that you can only modify letters in string A.Koa wants to know the smallest number of moves she has to do to make strings equal to each other (A=B) or to determine that there is no way to make them equal. Help her!" 1700
1382B "Sequential Nim" dp,games "There are n piles of stones, where the i-th pile has ai stones. Two people play a game, where they take alternating turns removing stones.In a move, a player may remove a positive number of stones from the first non-empty pile (the pile with the minimal index, that has at least one stone). The first player who cannot make a move (because all piles are empty) loses the game. If both players play optimally, determine the winner of the game." 1100
1382A "Common Subsequence" "brute force" "You are given two arrays of integers a1,\xe2\x80\xa6,an and b1,\xe2\x80\xa6,bm.Your task is to find a non-empty array c1,\xe2\x80\xa6,ck that is a subsequence of a1,\xe2\x80\xa6,an, and also a subsequence of b1,\xe2\x80\xa6,bm. If there are multiple answers, find one of the smallest possible length. If there are still multiple of the smallest possible length, find any. If there are no such arrays, you should report about it.A sequence a is a subsequence of a sequence b if a can be obtained from b by deletion of several (possibly, zero) elements. For example, [3,1] is a subsequence of [3,2,1] and [4,3,1], but not a subsequence of [1,3,3,7] and [3,10,4]." 800
1381E Origami geometry,math,sortings "After being discouraged by 13 time-limit-exceeded verdicts on an ugly geometry problem, you decided to take a relaxing break for arts and crafts.There is a piece of paper in the shape of a simple polygon with n vertices. The polygon may be non-convex, but we all know that proper origami paper has the property that any horizontal line intersects the boundary of the polygon in at most two points.If you fold the paper along the vertical line x=f, what will be the area of the resulting shape? When you fold, the part of the paper to the left of the line is symmetrically reflected on the right side.  Your task is to answer q independent queries for values f1,\xe2\x80\xa6,fq." 3300
1381D "The Majestic Brown Tree Snake" "dfs and similar,dp,greedy,trees,two pointers" "There is an undirected tree of n vertices, connected by n\xe2\x88\x921 bidirectional edges. There is also a snake stuck inside of this tree. Its head is at vertex a and its tail is at vertex b. The snake\'s body occupies all vertices on the unique simple path between a and b.The snake wants to know if it can reverse itself  \xe2\x80\x94 that is, to move its head to where its tail started, and its tail to where its head started. Unfortunately, the snake\'s movements are restricted to the tree\'s structure.In an operation, the snake can move its head to an adjacent vertex not currently occupied by the snake. When it does this, the tail moves one vertex closer to the head, so that the length of the snake remains unchanged. Similarly, the snake can also move its tail to an adjacent vertex not currently occupied by the snake. When it does this, the head moves one unit closer to the tail.  Let\'s denote a snake position by (h,t), where h is the index of the vertex with the snake\'s head, t is the index of the vertex with the snake\'s tail. This snake can reverse itself with the movements (4,7)\xe2\x86\x92(5,1)\xe2\x86\x92(4,2)\xe2\x86\x92(1,3)\xe2\x86\x92(7,2)\xe2\x86\x92(8,1)\xe2\x86\x92(7,4). Determine if it is possible to reverse the snake with some sequence of operations." 3000
1381C Mastermind "constructive algorithms,graph matchings,greedy,implementation,sortings,two pointers" "In the game of Mastermind, there are two players  \xe2\x80\x94 Alice and Bob. Alice has a secret code, which Bob tries to guess. Here, a code is defined as a sequence of n colors. There are exactly n+1 colors in the entire universe, numbered from 1 to n+1 inclusive.When Bob guesses a code, Alice tells him some information about how good of a guess it is, in the form of two integers x and y.The first integer x is the number of indices where Bob\'s guess correctly matches Alice\'s code. The second integer y is the size of the intersection of the two codes as multisets. That is, if Bob were to change the order of the colors in his guess, y is the maximum number of indices he could get correct.For example, suppose n=5, Alice\'s code is [3,1,6,1,2], and Bob\'s guess is [3,1,1,2,5]. At indices 1 and 2 colors are equal, while in the other indices they are not equal. So x=2. And the two codes have the four colors 1,1,2,3 in common, so y=4.  Solid lines denote a matched color for the same index. Dashed lines denote a matched color at a different index. x is the number of solid lines, and y is the total number of lines. You are given Bob\'s guess and two values x and y. Can you find one possibility of Alice\'s code so that the values of x and y are correct?" 2500
1381B Unmerge dp "Let a and b be two arrays of lengths n and m, respectively, with no elements in common. We can define a new array merge(a,b) of length n+m recursively as follows:  If one of the arrays is empty, the result is the other array. That is, merge(\xe2\x88\x85,b)=b and merge(a,\xe2\x88\x85)=a. In particular, merge(\xe2\x88\x85,\xe2\x88\x85)=\xe2\x88\x85.  If both arrays are non-empty, and a1<b1, then merge(a,b)=[a1]+merge([a2,\xe2\x80\xa6,an],b). That is, we delete the first element a1 of a, merge the remaining arrays, then add a1 to the beginning of the result.  If both arrays are non-empty, and a1>b1, then merge(a,b)=[b1]+merge(a,[b2,\xe2\x80\xa6,bm]). That is, we delete the first element b1 of b, merge the remaining arrays, then add b1 to the beginning of the result. This algorithm has the nice property that if a and b are sorted, then merge(a,b) will also be sorted. For example, it is used as a subroutine in merge-sort. For this problem, however, we will consider the same procedure acting on non-sorted arrays as well. For example, if a=[3,1] and b=[2,4], then merge(a,b)=[2,3,1,4].A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).There is a permutation p of length 2n. Determine if there exist two arrays a and b, each of length n and with no elements in common, so that p=merge(a,b)." 1800
1381A2 "Prefix Flip (Hard Version)" "constructive algorithms,data structures,implementation,strings,two pointers" "This is the hard version of the problem. The difference between the versions is the constraint on n and the required number of operations. You can make hacks only if all versions of the problem are solved.There are two binary strings a and b of length n (a binary string is a string consisting of symbols 0 and 1). In an operation, you select a prefix of a, and simultaneously invert the bits in the prefix (0 changes to 1 and 1 changes to 0) and reverse the order of the bits in the prefix.For example, if a=001011 and you select the prefix of length 3, it becomes 011011. Then if you select the entire string, it becomes 001001.Your task is to transform the string a into b in at most 2n operations. It can be proved that it is always possible." 1700
1381A1 "Prefix Flip (Easy Version)" "constructive algorithms,data structures,strings" "This is the easy version of the problem. The difference between the versions is the constraint on n and the required number of operations. You can make hacks only if all versions of the problem are solved.There are two binary strings a and b of length n (a binary string is a string consisting of symbols 0 and 1). In an operation, you select a prefix of a, and simultaneously invert the bits in the prefix (0 changes to 1 and 1 changes to 0) and reverse the order of the bits in the prefix.For example, if a=001011 and you select the prefix of length 3, it becomes 011011. Then if you select the entire string, it becomes 001001.Your task is to transform the string a into b in at most 3n operations. It can be proved that it is always possible." 1300
1380G "Circular Dungeon" greedy,math,probabilities "You are creating a level for a video game. The level consists of n rooms placed in a circle. The rooms are numbered 1 through n. Each room contains exactly one exit: completing the j-th room allows you to go the (j+1)-th room (and completing the n-th room allows you to go the 1-st room).You are given the description of the multiset of n chests: the i-th chest has treasure value ci.Each chest can be of one of two types:   regular chest \xe2\x80\x94 when a player enters a room with this chest, he grabs the treasure and proceeds to the next room;  mimic chest \xe2\x80\x94 when a player enters a room with this chest, the chest eats him alive, and he loses. The player starts in a random room with each room having an equal probability of being chosen. The players earnings is equal to the total value of treasure chests he\'d collected before he lost.You are allowed to choose the order the chests go into the rooms. For each k from 1 to n place the chests into the rooms in such a way that:  each room contains exactly one chest;  exactly k chests are mimics;  the expected value of players earnings is minimum possible. Please note that for each k the placement is chosen independently.It can be shown that it is in the form of PQ where P and Q are non-negative integers and Q\xe2\x89\xa00. Report the values of P\xe2\x8b\x85Q\xe2\x88\x921(mod998244353)." 2600
1380F "Strange Addition" "data structures,dp,matrices" "Let a and b be some non-negative integers. Let\'s define strange addition of a and b as following:  write down the numbers one under another and align them by their least significant digit;  add them up digit by digit and concatenate the respective sums together. Assume that both numbers have an infinite number of leading zeros.For example, let\'s take a look at a strange addition of numbers 3248 and 908:  You are given a string c, consisting of n digits from 0 to 9. You are also given m updates of form:   x d \xe2\x80\x94 replace the digit at the x-th position of c with a digit d. Note that string c might have leading zeros at any point of time.After each update print the number of pairs (a,b) such that both a and b are non-negative integers and the result of a strange addition of a and b is equal to c.Note that the numbers of pairs can be quite large, so print them modulo 998244353." 2600
1380E "Merging Towers" "data structures,dsu,implementation,trees" "You have a set of n discs, the i-th disc has radius i. Initially, these discs are split among m towers: each tower contains at least one disc, and the discs in each tower are sorted in descending order of their radii from bottom to top.You would like to assemble one tower containing all of those discs. To do so, you may choose two different towers i and j (each containing at least one disc), take several (possibly all) top discs from the tower i and put them on top of the tower j in the same order, as long as the top disc of tower j is bigger than each of the discs you move. You may perform this operation any number of times.For example, if you have two towers containing discs [6,4,2,1] and [8,7,5,3] (in order from bottom to top), there are only two possible operations:  move disc 1 from the first tower to the second tower, so the towers are [6,4,2] and [8,7,5,3,1];  move discs [2,1] from the first tower to the second tower, so the towers are [6,4] and [8,7,5,3,2,1]. Let the difficulty of some set of towers be the minimum number of operations required to assemble one tower containing all of the discs. For example, the difficulty of the set of towers [[3,1],[2]] is 2: you may move the disc 1 to the second tower, and then move both discs from the second tower to the first tower.You are given m\xe2\x88\x921 queries. Each query is denoted by two numbers ai and bi, and means ""merge the towers ai and bi"" (that is, take all discs from these two towers and assemble a new tower containing all of them in descending order of their radii from top to bottom). The resulting tower gets index ai.For each k\xe2\x88\x88[0,m\xe2\x88\x921], calculate the difficulty of the set of towers after the first k queries are performed." 2300
1380D "Berserk And Fireball" "constructive algorithms,greedy,implementation,math,two pointers" "There are n warriors in a row. The power of the i-th warrior is ai. All powers are pairwise distinct.You have two types of spells which you may cast:   Fireball: you spend x mana and destroy exactly k consecutive warriors;  Berserk: you spend y mana, choose two consecutive warriors, and the warrior with greater power destroys the warrior with smaller power. For example, let the powers of warriors be [2,3,7,8,11,5,4], and k=3. If you cast Berserk on warriors with powers 8 and 11, the resulting sequence of powers becomes [2,3,7,11,5,4]. Then, for example, if you cast Fireball on consecutive warriors with powers [7,11,5], the resulting sequence of powers becomes [2,3,4].You want to turn the current sequence of warriors powers a1,a2,\xe2\x80\xa6,an into b1,b2,\xe2\x80\xa6,bm. Calculate the minimum amount of mana you need to spend on it." 2000
1380C "Create The Teams" "brute force,dp,greedy,implementation,sortings" "There are n programmers that you want to split into several non-empty teams. The skill of the i-th programmer is ai. You want to assemble the maximum number of teams from them. There is a restriction for each team: the number of programmers in the team multiplied by the minimum skill among all programmers in the team must be at least x.Each programmer should belong to at most one team. Some programmers may be left without a team.Calculate the maximum number of teams that you can assemble." 1400
1380B "Universal Solution" greedy "Recently, you found a bot to play ""Rock paper scissors"" with. Unfortunately, the bot uses quite a simple algorithm to play: he has a string s=s1s2\xe2\x80\xa6sn of length n where each letter is either R, S or P.While initializing, the bot is choosing a starting index pos (1\xe2\x89\xa4pos\xe2\x89\xa4n), and then it can play any number of rounds. In the first round, he chooses ""Rock"", ""Scissors"" or ""Paper"" based on the value of spos:   if spos is equal to R the bot chooses ""Rock"";  if spos is equal to S the bot chooses ""Scissors"";  if spos is equal to P the bot chooses ""Paper""; In the second round, the bot\'s choice is based on the value of spos+1. In the third round \xe2\x80\x94 on spos+2 and so on. After sn the bot returns to s1 and continues his game.You plan to play n rounds and you\'ve already figured out the string s but still don\'t know what is the starting index pos. But since the bot\'s tactic is so boring, you\'ve decided to find n choices to each round to maximize the average number of wins.In other words, let\'s suggest your choices are c1c2\xe2\x80\xa6cn and if the bot starts from index pos then you\'ll win in win(pos) rounds. Find c1c2\xe2\x80\xa6cn such that win(1)+win(2)+\xe2\x8b\xaf+win(n)n is maximum possible." 1400
1380A "Three Indices" "brute force,data structures" "You are given a permutation p1,p2,\xe2\x80\xa6,pn. Recall that sequence of n integers is called a permutation if it contains all integers from 1 to n exactly once.Find three indices i, j and k such that:   1\xe2\x89\xa4i<j<k\xe2\x89\xa4n;  pi<pj and pj>pk.  Or say that there are no such indices." 900
1379F2 "Chess Strikes Back (hard version)" "data structures,divide and conquer" "Note that the difference between easy and hard versions is that in hard version unavailable cells can become available again and in easy version can\'t. You can make hacks only if all versions are solved.Ildar and Ivan are tired of chess, but they really like the chessboard, so they invented a new game. The field is a chessboard 2n\xc3\x972m: it has 2n rows, 2m columns, and the cell in row i and column j is colored white if i+j is even, and is colored black otherwise.The game proceeds as follows: Ildar marks some of the white cells of the chessboard as unavailable, and asks Ivan to place n\xc3\x97m kings on the remaining white cells in such way, so that there are no kings attacking each other. A king can attack another king if they are located in the adjacent cells, sharing an edge or a corner.Ildar would like to explore different combinations of cells. Initially all cells are marked as available, and then he has q queries. In each query he either marks a cell as unavailable, or marks the previously unavailable cell as available. After each query he would like to know whether it is possible to place the kings on the available cells in a desired way. Please help him!" 2800
1379F1 "Chess Strikes Back (easy version)" "binary search,data structures" "Note that the difference between easy and hard versions is that in hard version unavailable cells can become available again and in easy version can\'t. You can make hacks only if all versions are solved.Ildar and Ivan are tired of chess, but they really like the chessboard, so they invented a new game. The field is a chessboard 2n\xc3\x972m: it has 2n rows, 2m columns, and the cell in row i and column j is colored white if i+j is even, and is colored black otherwise.The game proceeds as follows: Ildar marks some of the white cells of the chessboard as unavailable, and asks Ivan to place n\xc3\x97m kings on the remaining white cells in such way, so that there are no kings attacking each other. A king can attack another king if they are located in the adjacent cells, sharing an edge or a corner.Ildar would like to explore different combinations of cells. Initially all cells are marked as available, and then he has q queries. In each query he marks a cell as unavailable. After each query he would like to know whether it is possible to place the kings on the available cells in a desired way. Please help him!" 2700
1379E "Inverse Genealogy" "constructive algorithms,divide and conquer,dp,math,trees" "Ivan is fond of genealogy. Currently he is studying a particular genealogical structure, which consists of some people. In this structure every person has either both parents specified, or none. Additionally, each person has exactly one child, except for one special person, who does not have any children. The people in this structure are conveniently numbered from 1 to n, and si denotes the child of the person i (and si=0 for exactly one person who does not have any children).We say that a is an ancestor of b if either a=b, or a has a child, who is an ancestor of b. That is a is an ancestor for a, sa, ssa, etc.We say that person i is imbalanced in case this person has both parents specified, and the total number of ancestors of one of the parents is at least double the other. Ivan counted the number of imbalanced people in the structure, and got k people in total. However, he is not sure whether he computed it correctly, and would like to check if there is at least one construction with n people that have k imbalanced people in total. Please help him to find one such construction, or determine if it does not exist." 2800
1379D "New Passenger Trams" "binary search,brute force,data structures,sortings,two pointers" "There are many freight trains departing from Kirnes planet every day. One day on that planet consists of h hours, and each hour consists of m minutes, where m is an even number. Currently, there are n freight trains, and they depart every day at the same time: i-th train departs at hi hours and mi minutes.The government decided to add passenger trams as well: they plan to add a regular tram service with half-hour intervals. It means that the first tram of the day must depart at 0 hours and t minutes, where 0\xe2\x89\xa4t<m2, the second tram departs m2 minutes after the first one and so on. This schedule allows exactly two passenger trams per hour, which is a great improvement.To allow passengers to board the tram safely, the tram must arrive k minutes before. During the time when passengers are boarding the tram, no freight train can depart from the planet. However, freight trains are allowed to depart at the very moment when the boarding starts, as well as at the moment when the passenger tram departs. Note that, if the first passenger tram departs at 0 hours and t minutes, where t<k, then the freight trains can not depart during the last k\xe2\x88\x92t minutes of the day.  A schematic picture of the correct way to run passenger trams. Here h=2 (therefore, the number of passenger trams is 2h=4), the number of freight trains is n=6. The passenger trams are marked in red (note that the spaces between them are the same). The freight trains are marked in blue. Time segments of length k before each passenger tram are highlighted in red. Note that there are no freight trains inside these segments. Unfortunately, it might not be possible to satisfy the requirements of the government without canceling some of the freight trains. Please help the government find the optimal value of t to minimize the number of canceled freight trains in case all passenger trams depart according to schedule." 2300
1379C "Choosing flowers" "binary search,brute force,data structures,dfs and similar,dp,greedy,sortings,two pointers" "Vladimir would like to prepare a present for his wife: they have an anniversary! He decided to buy her exactly n flowers.Vladimir went to a flower shop, and he was amazed to see that there are m types of flowers being sold there, and there is unlimited supply of flowers of each type. Vladimir wants to choose flowers to maximize the happiness of his wife. He knows that after receiving the first flower of the i-th type happiness of his wife increases by ai and after receiving each consecutive flower of this type her happiness increases by bi. That is, if among the chosen flowers there are xi>0 flowers of type i, his wife gets ai+(xi\xe2\x88\x921)\xe2\x8b\x85bi additional happiness (and if there are no flowers of type i, she gets nothing for this particular type).Please help Vladimir to choose exactly n flowers to maximize the total happiness of his wife." 2000
1379B "Dubious Cyrpto" "binary search,brute force,math,number theory" "Pasha loves to send strictly positive integers to his friends. Pasha cares about security, therefore when he wants to send an integer n, he encrypts it in the following way: he picks three integers a, b and c such that l\xe2\x89\xa4a,b,c\xe2\x89\xa4r, and then he computes the encrypted value m=n\xe2\x8b\x85a+b\xe2\x88\x92c.Unfortunately, an adversary intercepted the values l, r and m. Is it possible to recover the original values of a, b and c from this information? More formally, you are asked to find any values of a, b and c such that  a, b and c are integers,  l\xe2\x89\xa4a,b,c\xe2\x89\xa4r,  there exists a strictly positive integer n, such that n\xe2\x8b\x85a+b\xe2\x88\x92c=m." 1500
1379A "Acacius and String" "brute force,implementation,strings" "Acacius is studying strings theory. Today he came with the following problem.You are given a string s of length n consisting of lowercase English letters and question marks. It is possible to replace question marks with lowercase English letters in such a way that a string ""abacaba"" occurs as a substring in a resulting string exactly once?Each question mark should be replaced with exactly one lowercase English letter. For example, string ""a?b?c"" can be transformed into strings ""aabbc"" and ""azbzc"", but can\'t be transformed into strings ""aabc"", ""a?bbc"" and ""babbc"".Occurrence of a string t of length m in the string s of length n as a substring is a index i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92m+1) such that string s[i..i+m\xe2\x88\x921] consisting of m consecutive symbols of s starting from i-th equals to string t. For example string ""ababa"" has two occurrences of a string ""aba"" as a substring with i=1 and i=3, but there are no occurrences of a string ""aba"" in the string ""acba"" as a substring.Please help Acacius to check if it is possible to replace all question marks with lowercase English letters in such a way that a string ""abacaba"" occurs as a substring in a resulting string exactly once." 1500
1375I "Cubic Lattice" "geometry,math,matrices,number theory" "A cubic lattice L in 3-dimensional euclidean space is a set of points defined in the following way: L={u\xe2\x8b\x85\xe2\x86\x92r1+v\xe2\x8b\x85\xe2\x86\x92r2+w\xe2\x8b\x85\xe2\x86\x92r3}u,v,w\xe2\x88\x88Z Where \xe2\x86\x92r1,\xe2\x86\x92r2,\xe2\x86\x92r3\xe2\x88\x88Z3 are some integer vectors such that:   \xe2\x86\x92r1, \xe2\x86\x92r2 and \xe2\x86\x92r3 are pairwise orthogonal: \xe2\x86\x92r1\xe2\x8b\x85\xe2\x86\x92r2=\xe2\x86\x92r1\xe2\x8b\x85\xe2\x86\x92r3=\xe2\x86\x92r2\xe2\x8b\x85\xe2\x86\x92r3=0 Where \xe2\x86\x92a\xe2\x8b\x85\xe2\x86\x92b is a dot product of vectors \xe2\x86\x92a and \xe2\x86\x92b.  \xe2\x86\x92r1, \xe2\x86\x92r2 and \xe2\x86\x92r3 all have the same length: |\xe2\x86\x92r1|=|\xe2\x86\x92r2|=|\xe2\x86\x92r3|=r  You\'re given a set A={\xe2\x86\x92a1,\xe2\x86\x92a2,\xe2\x80\xa6,\xe2\x86\x92an} of integer points, i-th point has coordinates ai=(xi;yi;zi). Let gi=gcd(xi,yi,zi). It is guaranteed that gcd(g1,g2,\xe2\x80\xa6,gn)=1.You have to find a cubic lattice L such that A\xe2\x8a\x82L and r is the maximum possible." 3500
1375H "Set Merging" "constructive algorithms,divide and conquer" "You are given a permutation a1,a2,\xe2\x80\xa6,an of numbers from 1 to n. Also, you have n sets S1,S2,\xe2\x80\xa6,Sn, where Si={ai}. Lastly, you have a variable cnt, representing the current number of sets. Initially, cnt=n.We define two kinds of functions on sets:f(S)=minu\xe2\x88\x88Su;g(S)=maxu\xe2\x88\x88Su.You can obtain a new set by merging two sets A and B, if they satisfy g(A)<f(B) (Notice that the old sets do not disappear).Formally, you can perform the following sequence of operations:cnt\xe2\x86\x90cnt+1;Scnt=Su\xe2\x88\xaaSv, you are free to choose u and v for which 1\xe2\x89\xa4u,v<cnt and which satisfy g(Su)<f(Sv).You are required to obtain some specific sets.There are q requirements, each of which contains two integers li,ri, which means that there must exist a set Ski (ki is the ID of the set, you should determine it) which equals {au\xe2\x88\xa3li\xe2\x89\xa4u\xe2\x89\xa4ri}, which is, the set consisting of all ai with indices between li and ri.In the end you must ensure that cnt\xe2\x89\xa42.2\xc3\x97106. Note that you don\'t have to minimize cnt. It is guaranteed that a solution under given constraints exists." 3300
1375G "Tree Modification" "brute force,constructive algorithms,dfs and similar,graph matchings,graphs,trees" "You are given a tree with n vertices. You are allowed to modify the structure of the tree through the following multi-step operation:  Choose three vertices a, b, and c such that b is adjacent to both a and c.  For every vertex d other than b that is adjacent to a, remove the edge connecting d and a and add the edge connecting d and c.  Delete the edge connecting a and b and add the edge connecting a and c. As an example, consider the following tree:  The following diagram illustrates the sequence of steps that happen when we apply an operation to vertices 2, 4, and 5:  It can be proven that after each operation, the resulting graph is still a tree.Find the minimum number of operations that must be performed to transform the tree into a star. A star is a tree with one vertex of degree n\xe2\x88\x921, called its center, and n\xe2\x88\x921 vertices of degree 1." 2800
1375F "Integer Game" "constructive algorithms,games,interactive,math" "This is an interactive problem.Anton and Harris are playing a game to decide which of them is the king of problemsetting.There are three piles of stones, initially containing a, b, and c stones, where a, b, and c are distinct positive integers. On each turn of the game, the following sequence of events takes place:  The first player chooses a positive integer y and provides it to the second player.  The second player adds y stones to one of the piles, with the condition that he cannot choose the same pile in two consecutive turns. The second player loses if, at any point, two of the piles contain the same number of stones. The first player loses if 1000 turns have passed without the second player losing.Feeling confident in his skills, Anton decided to let Harris choose whether he wants to go first or second. Help Harris defeat Anton and become the king of problemsetting!" 2600
1375E "Inversion SwapSort" "constructive algorithms,greedy,sortings" "Madeline has an array a of n integers. A pair (u,v) of integers forms an inversion in a if:  1\xe2\x89\xa4u<v\xe2\x89\xa4n.  au>av. Madeline recently found a magical paper, which allows her to write two indices u and v and swap the values au and av. Being bored, she decided to write a list of pairs (ui,vi) with the following conditions:  all the pairs in the list are distinct and form an inversion in a.  all the pairs that form an inversion in a are in the list.  Starting from the given array, if you swap the values at indices u1 and v1, then the values at indices u2 and v2 and so on, then after all pairs are processed, the array a will be sorted in non-decreasing order. Construct such a list or determine that no such list exists. If there are multiple possible answers, you may find any of them." 2500
1375D "Replace by MEX" "brute force,constructive algorithms,sortings" "You\'re given an array of n integers between 0 and n inclusive.In one operation, you can choose any element of the array and replace it by the MEX of the elements of the array (which may change after the operation).For example, if the current array is [0,2,2,1,4], you can choose the second element and replace it by the MEX of the present elements  \xe2\x80\x94 3. Array will become [0,3,2,1,4].You must make the array non-decreasing, using at most 2n operations.It can be proven that it is always possible. Please note that you do not have to minimize the number of operations. If there are many solutions, you can print any of them. \xe2\x80\x93An array b[1\xe2\x80\xa6n] is non-decreasing if and only if b1\xe2\x89\xa4b2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4bn.The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:  The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4 because 0, 1, 2 and 3 belong to the array, but 4 does not. It\'s worth mentioning that the MEX of an array of length n is always between 0 and n inclusive." 1900
1375C "Element Extermination" "constructive algorithms,data structures,greedy" "You are given an array a of length n, which initially is a permutation of numbers from 1 to n. In one operation, you can choose an index i (1\xe2\x89\xa4i<n) such that ai<ai+1, and remove either ai or ai+1 from the array (after the removal, the remaining parts are concatenated). For example, if you have the array [1,3,2], you can choose i=1 (since a1=1<a2=3), then either remove a1 which gives the new array [3,2], or remove a2 which gives the new array [1,2].Is it possible to make the length of this array equal to 1 with these operations?" 1400
1375B "Neighbor Grid" "constructive algorithms,greedy" "You are given a grid with n rows and m columns, where each cell has a non-negative integer written on it. We say the grid is good if for each cell the following condition holds: if it has a number k>0 written on it, then exactly k of its neighboring cells have a number greater than 0 written on them. Note that if the number in the cell is 0, there is no such restriction on neighboring cells.You are allowed to take any number in the grid and increase it by 1. You may apply this operation as many times as you want, to any numbers you want. Perform some operations (possibly zero) to make the grid good, or say that it is impossible. If there are multiple possible answers, you may find any of them.Two cells are considered to be neighboring if they have a common edge." 1200
1375A "Sign Flipping" "constructive algorithms,math" "You are given n integers a1,a2,\xe2\x80\xa6,an, where n is odd. You are allowed to flip the sign of some (possibly all or none) of them. You wish to perform these flips in such a way that the following conditions hold:  At least n\xe2\x88\x9212 of the adjacent differences ai+1\xe2\x88\x92ai for i=1,2,\xe2\x80\xa6,n\xe2\x88\x921 are greater than or equal to 0.  At least n\xe2\x88\x9212 of the adjacent differences ai+1\xe2\x88\x92ai for i=1,2,\xe2\x80\xa6,n\xe2\x88\x921 are less than or equal to 0. Find any valid way to flip the signs. It can be shown that under the given constraints, there always exists at least one choice of signs to flip that satisfies the required condition. If there are several solutions, you can find any of them." 1100
1374F "Cyclic Shifts Sorting" "brute force,constructive algorithms,implementation,sortings" "You are given an array a consisting of n integers.In one move, you can choose some index i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922) and shift the segment [ai,ai+1,ai+2] cyclically to the right (i.e. replace the segment [ai,ai+1,ai+2] with [ai+2,ai,ai+1]). Your task is to sort the initial array by no more than n2 such operations or say that it is impossible to do that.You have to answer t independent test cases." 2400
1374E2 "Reading Books (hard version)" "data structures,greedy,implementation,sortings,ternary search,two pointers" "Easy and hard versions are actually different problems, so read statements of both problems completely and carefully.Summer vacation has started so Alice and Bob want to play and joy, but... Their mom doesn\'t think so. She says that they have to read exactly m books before all entertainments. Alice and Bob will read each book together to end this exercise faster.There are n books in the family library. The i-th book is described by three integers: ti \xe2\x80\x94 the amount of time Alice and Bob need to spend to read it, ai (equals 1 if Alice likes the i-th book and 0 if not), and bi (equals 1 if Bob likes the i-th book and 0 if not).So they need to choose exactly m books from the given n books in such a way that:  Alice likes at least k books from the chosen set and Bob likes at least k books from the chosen set;  the total reading time of these m books is minimized (they are children and want to play and joy as soon a possible). The set they choose is the same for both Alice an Bob (it\'s shared between them) and they read all books together, so the total reading time is the sum of ti over all books that are in the chosen set.Your task is to help them and find any suitable set of books or determine that it is impossible to find such a set." 2500
1374E1 "Reading Books (easy version)" "data structures,greedy,sortings" "Easy and hard versions are actually different problems, so read statements of both problems completely and carefully.Summer vacation has started so Alice and Bob want to play and joy, but... Their mom doesn\'t think so. She says that they have to read some amount of books before all entertainments. Alice and Bob will read each book together to end this exercise faster.There are n books in the family library. The i-th book is described by three integers: ti \xe2\x80\x94 the amount of time Alice and Bob need to spend to read it, ai (equals 1 if Alice likes the i-th book and 0 if not), and bi (equals 1 if Bob likes the i-th book and 0 if not).So they need to choose some books from the given n books in such a way that:  Alice likes at least k books from the chosen set and Bob likes at least k books from the chosen set;  the total reading time of these books is minimized (they are children and want to play and joy as soon a possible). The set they choose is the same for both Alice an Bob (it\'s shared between them) and they read all books together, so the total reading time is the sum of ti over all books that are in the chosen set.Your task is to help them and find any suitable set of books or determine that it is impossible to find such a set." 1600
1374D "Zero Remainder Array" "math,sortings,two pointers" "You are given an array a consisting of n positive integers.Initially, you have an integer x=0. During one move, you can do one of the following two operations:  Choose exactly one i from 1 to n and increase ai by x (ai:=ai+x), then increase x by 1 (x:=x+1).  Just increase x by 1 (x:=x+1). The first operation can be applied no more than once to each i from 1 to n.Your task is to find the minimum number of moves required to obtain such an array that each its element is divisible by k (the value k is given).You have to answer t independent test cases." 1400
1374C "Move Brackets" greedy,strings "You are given a bracket sequence s of length n, where n is even (divisible by two). The string s consists of n2 opening brackets \'(\' and n2 closing brackets \')\'.In one move, you can choose exactly one bracket and move it to the beginning of the string or to the end of the string (i.e. you choose some index i, remove the i-th character of s and insert it before or after all remaining characters of s).Your task is to find the minimum number of moves required to obtain regular bracket sequence from s. It can be proved that the answer always exists under the given constraints.Recall what the regular bracket sequence is:  ""()"" is regular bracket sequence;  if s is regular bracket sequence then ""("" + s + "")"" is regular bracket sequence;  if s and t are regular bracket sequences then s + t is regular bracket sequence. For example, ""()()"", ""(())()"", ""(())"" and ""()"" are regular bracket sequences, but "")("", ""()("" and "")))"" are not.You have to answer t independent test cases." 1000
1374B "Multiply by 2, divide by 6" math "You are given an integer n. In one move, you can either multiply n by two or divide n by 6 (if it is divisible by 6 without the remainder).Your task is to find the minimum number of moves needed to obtain 1 from n or determine if it\'s impossible to do that.You have to answer t independent test cases." 900
1374A "Required Remainder" math "You are given three integers x,y and n. Your task is to find the maximum integer k such that 0\xe2\x89\xa4k\xe2\x89\xa4n that kmodx=y, where mod is modulo operation. Many programming languages use percent operator % to implement it.In other words, with given x,y and n you need to find the maximum possible integer from 0 to n that has the remainder y modulo x.You have to answer t independent test cases. It is guaranteed that such k exists for each test case." 800
1373G Pawns "data structures,divide and conquer,greedy" "You are given a chessboard consisting of n rows and n columns. Rows are numbered from bottom to top from 1 to n. Columns are numbered from left to right from 1 to n. The cell at the intersection of the x-th column and the y-th row is denoted as (x,y). Furthermore, the k-th column is a special column. Initially, the board is empty. There are m changes to the board. During the i-th change one pawn is added or removed from the board. The current board is good if we can move all pawns to the special column by the followings rules:  Pawn in the cell (x,y) can be moved to the cell (x,y+1), (x\xe2\x88\x921,y+1) or (x+1,y+1);  You can make as many such moves as you like;  Pawns can not be moved outside the chessboard;  Each cell can not contain more than one pawn. The current board may not always be good. To fix it, you can add new rows to the board. New rows are added at the top, i.\xe2\x80\x89e. they will have numbers n+1,n+2,n+3,\xe2\x80\xa6.After each of m changes, print one integer \xe2\x80\x94 the minimum number of rows which you have to add to make the board good." 2600
1373F "Network Coverage" "binary search,constructive algorithms,data structures,greedy" "The government of Berland decided to improve network coverage in his country. Berland has a unique structure: the capital in the center and n cities in a circle around the capital. The capital already has a good network coverage (so the government ignores it), but the i-th city contains ai households that require a connection.The government designed a plan to build n network stations between all pairs of neighboring cities which will maintain connections only for these cities. In other words, the i-th network station will provide service only for the i-th and the (i+1)-th city (the n-th station is connected to the n-th and the 1-st city).All network stations have capacities: the i-th station can provide the connection to at most bi households.Now the government asks you to check can the designed stations meet the needs of all cities or not \xe2\x80\x94 that is, is it possible to assign each household a network station so that each network station i provides the connection to at most bi households." 2400
1373E "Sum of Digits" "brute force,constructive algorithms,dp,greedy" "Let f(x) be the sum of digits of a decimal number x.Find the smallest non-negative integer x such that f(x)+f(x+1)+\xe2\x8b\xaf+f(x+k)=n." 2200
1373D "Maximum Sum on Even Positions" "divide and conquer,dp,greedy,implementation" "You are given an array a consisting of n integers. Indices of the array start from zero (i.\xe2\x80\x89e. the first element is a0, the second one is a1, and so on).You can reverse at most one subarray (continuous subsegment) of this array. Recall that the subarray of a with borders l and r is a[l;r]=al,al+1,\xe2\x80\xa6,ar.Your task is to reverse such a subarray that the sum of elements on even positions of the resulting array is maximized (i.\xe2\x80\x89e. the sum of elements a0,a2,\xe2\x80\xa6,a2k for integer k=\xe2\x8c\x8an\xe2\x88\x9212\xe2\x8c\x8b should be maximum possible).You have to answer t independent test cases." 1600
1373C "Pluses and Minuses" math "You are given a string s consisting only of characters + and -. You perform some process with this string. This process can be described by the following pseudocode: res = 0for init = 0 to inf    cur = init    ok = true    for i = 1 to |s|        res = res + 1        if s[i] == \'+\'            cur = cur + 1        else            cur = cur - 1        if cur < 0            ok = false            break    if ok        breakNote that the inf denotes infinity, and the characters of the string are numbered from 1 to |s|.You have to calculate the value of the res after the process ends." 1300
1373B "01 Game" games "Alica and Bob are playing a game.Initially they have a binary string s consisting of only characters 0 and 1.Alice and Bob make alternating moves: Alice makes the first move, Bob makes the second move, Alice makes the third one, and so on. During each move, the current player must choose two different adjacent characters of string s and delete them. For example, if s=1011001 then the following moves are possible:   delete s1 and s2: 1011001\xe2\x86\x9211001;  delete s2 and s3: 1011001\xe2\x86\x9211001;  delete s4 and s5: 1011001\xe2\x86\x9210101;  delete s6 and s7: 1011001\xe2\x86\x9210110. If a player can\'t make any move, they lose. Both players play optimally. You have to determine if Alice can win." 900
1373A "Donut Shops" greedy,implementation,math "There are two rival donut shops.The first shop sells donuts at retail: each donut costs a dollars.The second shop sells donuts only in bulk: box of b donuts costs c dollars. So if you want to buy x donuts from this shop, then you have to buy the smallest number of boxes such that the total number of donuts in them is greater or equal to x.You want to determine two positive integer values:   how many donuts can you buy so that they are strictly cheaper in the first shop than in the second shop?  how many donuts can you buy so that they are strictly cheaper in the second shop than in the first shop? If any of these values doesn\'t exist then that value should be equal to \xe2\x88\x921. If there are multiple possible answers, then print any of them.The printed values should be less or equal to 109. It can be shown that under the given constraints such values always exist if any values exist at all." 1000
1372F "Omkar and Modes" "binary search,divide and conquer,interactive" "Ray lost his array and needs to find it by asking Omkar. Omkar is willing to disclose that the array has the following qualities:  The array has n (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105) elements.  Every element in the array ai is an integer in the range 1\xe2\x89\xa4ai\xe2\x89\xa4109.  The array is sorted in nondecreasing order. Ray is allowed to send Omkar a series of queries. A query consists of two integers, l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. Omkar will respond with two integers, x and f. x is the mode of the subarray from index l to index r inclusive. The mode of an array is defined by the number that appears the most frequently. If there are multiple numbers that appear the most number of times, the smallest such number is considered to be the mode. f is the amount of times that x appears in the queried subarray.The array has k (1\xe2\x89\xa4k\xe2\x89\xa4min(25000,n)) distinct elements. However, due to Ray\'s sins, Omkar will not tell Ray what k is. Ray is allowed to send at most 4k queries.Help Ray find his lost array." 2700
1372E "Omkar and Last Floor" "dp,greedy,two pointers" "Omkar is building a house. He wants to decide how to make the floor plan for the last floor.Omkar\'s floor starts out as n rows of m zeros (1\xe2\x89\xa4n,m\xe2\x89\xa4100). Every row is divided into intervals such that every 0 in the row is in exactly 1 interval. For every interval for every row, Omkar can change exactly one of the 0s contained in that interval to a 1. Omkar defines the quality of a floor as the sum of the squares of the sums of the values in each column, i. e. if the sum of the values in the i-th column is qi, then the quality of the floor is \xe2\x88\x91mi=1q2i.Help Omkar find the maximum quality that the floor can have." 2900
1372D "Omkar and Circle" "brute force,dp,games,greedy" "Danny, the local Math Maniac, is fascinated by circles, Omkar\'s most recent creation. Help him solve this circle problem!You are given n nonnegative integers a1,a2,\xe2\x80\xa6,an arranged in a circle, where n must be odd (ie. n\xe2\x88\x921 is divisible by 2). Formally, for all i such that 2\xe2\x89\xa4i\xe2\x89\xa4n, the elements ai\xe2\x88\x921 and ai are considered to be adjacent, and an and a1 are also considered to be adjacent. In one operation, you pick a number on the circle, replace it with the sum of the two elements adjacent to it, and then delete the two adjacent elements from the circle. This is repeated until only one number remains in the circle, which we call the circular value.Help Danny find the maximum possible circular value after some sequences of operations." 2100
1372C "Omkar and Baseball" "constructive algorithms,math" "Patrick likes to play baseball, but sometimes he will spend so many hours hitting home runs that his mind starts to get foggy! Patrick is sure that his scores across n sessions follow the identity permutation (ie. in the first game he scores 1 point, in the second game he scores 2 points and so on). However, when he checks back to his record, he sees that all the numbers are mixed up! Define a special exchange as the following: choose any subarray of the scores and permute elements such that no element of subarray gets to the same position as it was before the exchange. For example, performing a special exchange on [1,2,3] can yield [3,1,2] but it cannot yield [3,2,1] since the 2 is in the same position. Given a permutation of n integers, please help Patrick find the minimum number of special exchanges needed to make the permutation sorted! It can be proved that under given constraints this number doesn\'t exceed 1018.An array a is a subarray of an array b if a can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 1500
1372B "Omkar and Last Class of Math" "greedy,math,number theory" "In Omkar\'s last class of math, he learned about the least common multiple, or LCM. LCM(a,b) is the smallest positive integer x which is divisible by both a and b.Omkar, having a laudably curious mind, immediately thought of a problem involving the LCM operation: given an integer n, find positive integers a and b such that a+b=n and LCM(a,b) is the minimum value possible.Can you help Omkar solve his ludicrously challenging math problem?" 1300
1372A "Omkar and Completion" "constructive algorithms,implementation" "You have been blessed as a child of Omkar. To express your gratitude, please solve this problem for Omkar!An array a of length n is called complete if all elements are positive and don\'t exceed 1000, and for all indices x,y,z (1\xe2\x89\xa4x,y,z\xe2\x89\xa4n), ax+ay\xe2\x89\xa0az (not necessarily distinct).You are given one integer n. Please find any complete array of length n. It is guaranteed that under given constraints such array exists." 800
1371F "Raging Thunder" "data structures,divide and conquer,implementation" "You are a warrior fighting against the machine god Thor.Thor challenge you to solve the following problem:There are n conveyors arranged in a line numbered with integers from 1 to n from left to right. Each conveyor has a symbol ""<"" or "">"". The initial state of the conveyor i is equal to the i-th character of the string s. There are n+1 holes numbered with integers from 0 to n. The hole 0 is on the left side of the conveyor 1, and for all i\xe2\x89\xa51 the hole i is on the right side of the conveyor i.When a ball is on the conveyor i, the ball moves by the next rules:If the symbol ""<"" is on the conveyor i, then:  If i=1, the ball falls into the hole 0.  If the symbol ""<"" is on the conveyor i\xe2\x88\x921, the ball moves to the conveyor i\xe2\x88\x921.  If the symbol "">"" is on the conveyor i\xe2\x88\x921, the ball falls into the hole i\xe2\x88\x921. If the symbol "">"" is on the conveyor i, then:  If i=n, the ball falls into the hole n.  If the symbol "">"" is on the conveyor i+1, the ball moves to the conveyor i+1.  If the symbol ""<"" is on the conveyor i+1, the ball falls into the hole i. You should answer next q queries, each query is defined by the pair of integers l,r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n):   First, for all conveyors l,l+1,...,r, the symbol ""<"" changes to "">"" and vice versa. These changes remain for the next queries.  After that, put one ball on each conveyor l,l+1,...,r. Then, each ball falls into some hole. Find the maximum number of balls in one hole. After the query all balls disappear and don\'t considered in the next queries." 2800
1371E2 "Asterism (Hard Version)" "binary search,combinatorics,dp,math,number theory,sortings" "This is the hard version of the problem. The difference between versions is the constraints on n and ai. You can make hacks only if all versions of the problem are solved.First, Aoi came up with the following idea for the competitive programming problem:Yuzu is a girl who collecting candies. Originally, she has x candies. There are also n enemies numbered with integers from 1 to n. Enemy i has ai candies.Yuzu is going to determine a permutation P. A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, {2,3,1,5,4} is a permutation, but {1,2,2} is not a permutation (2 appears twice in the array) and {1,3,4} is also not a permutation (because n=3 but there is the number 4 in the array).After that, she will do n duels with the enemies with the following rules:  If Yuzu has equal or more number of candies than enemy Pi, she wins the duel and gets 1 candy. Otherwise, she loses the duel and gets nothing.  The candy which Yuzu gets will be used in the next duels. Yuzu wants to win all duels. How many valid permutations P exist?This problem was easy and wasn\'t interesting for Akari, who is a friend of Aoi. And Akari made the following problem from the above idea:Let\'s define f(x) as the number of valid permutations for the integer x.You are given n, a and a prime number p\xe2\x89\xa4n. Let\'s call a positive integer x good, if the value f(x) is not divisible by p. Find all good integers x.Your task is to solve this problem made by Akari." 2300
1371E1 "Asterism (Easy Version)" "binary search,brute force,combinatorics,math,number theory,sortings" "This is the easy version of the problem. The difference between versions is the constraints on n and ai. You can make hacks only if all versions of the problem are solved.First, Aoi came up with the following idea for the competitive programming problem:Yuzu is a girl who collecting candies. Originally, she has x candies. There are also n enemies numbered with integers from 1 to n. Enemy i has ai candies.Yuzu is going to determine a permutation P. A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, {2,3,1,5,4} is a permutation, but {1,2,2} is not a permutation (2 appears twice in the array) and {1,3,4} is also not a permutation (because n=3 but there is the number 4 in the array).After that, she will do n duels with the enemies with the following rules:  If Yuzu has equal or more number of candies than enemy Pi, she wins the duel and gets 1 candy. Otherwise, she loses the duel and gets nothing.  The candy which Yuzu gets will be used in the next duels. Yuzu wants to win all duels. How many valid permutations P exist?This problem was easy and wasn\'t interesting for Akari, who is a friend of Aoi. And Akari made the following problem from the above idea:Let\'s define f(x) as the number of valid permutations for the integer x.You are given n, a and a prime number p\xe2\x89\xa4n. Let\'s call a positive integer x good, if the value f(x) is not divisible by p. Find all good integers x.Your task is to solve this problem made by Akari." 1900
1371D Grid-00100 "constructive algorithms,greedy,implementation" "A mad scientist Dr.Jubal has made a competitive programming task. Try to solve it!You are given integers n,k. Construct a grid A with size n\xc3\x97n consisting of integers 0 and 1. The very important condition should be satisfied: the sum of all elements in the grid is exactly k. In other words, the number of 1 in the grid is equal to k.Let\'s define:  Ai,j as the integer in the i-th row and the j-th column.  Ri=Ai,1+Ai,2+...+Ai,n (for all 1\xe2\x89\xa4i\xe2\x89\xa4n).  Cj=A1,j+A2,j+...+An,j (for all 1\xe2\x89\xa4j\xe2\x89\xa4n).  In other words, Ri are row sums and Cj are column sums of the grid A.  For the grid A let\'s define the value f(A)=(max(R)\xe2\x88\x92min(R))2+(max(C)\xe2\x88\x92min(C))2 (here for an integer sequence X we define max(X) as the maximum value in X and min(X) as the minimum value in X). Find any grid A, which satisfies the following condition. Among such grids find any, for which the value f(A) is the minimum possible. Among such tables, you can find any." 1600
1371C "A Cookie for You" greedy,implementation,math "Anna is a girl so brave that she is loved by everyone in the city and citizens love her cookies. She is planning to hold a party with cookies. Now she has a vanilla cookies and b chocolate cookies for the party.She invited n guests of the first type and m guests of the second type to the party. They will come to the party in some order. After coming to the party, each guest will choose the type of cookie (vanilla or chocolate) to eat. There is a difference in the way how they choose that type:If there are v vanilla cookies and c chocolate cookies at the moment, when the guest comes, then  if the guest of the first type: if v>c the guest selects a vanilla cookie. Otherwise, the guest selects a chocolate cookie.  if the guest of the second type: if v>c the guest selects a chocolate cookie. Otherwise, the guest selects a vanilla cookie. After that:  If there is at least one cookie of the selected type, the guest eats one.  Otherwise (there are no cookies of the selected type), the guest gets angry and returns to home. Anna wants to know if there exists some order of guests, such that no one guest gets angry. Your task is to answer her question." 1300
1371B "Magical Calendar" math "A competitive eater, Alice is scheduling some practices for an eating contest on a magical calendar. The calendar is unusual because a week contains not necessarily 7 days!In detail, she can choose any integer k which satisfies 1\xe2\x89\xa4k\xe2\x89\xa4r, and set k days as the number of days in a week.Alice is going to paint some n consecutive days on this calendar. On this calendar, dates are written from the left cell to the right cell in a week. If a date reaches the last day of a week, the next day\'s cell is the leftmost cell in the next (under) row.She wants to make all of the painted cells to be connected by side. It means, that for any two painted cells there should exist at least one sequence of painted cells, started in one of these cells, and ended in another, such that any two consecutive cells in this sequence are connected by side.Alice is considering the shape of the painted cells. Two shapes are the same if there exists a way to make them exactly overlapped using only parallel moves, parallel to the calendar\'s sides.For example, in the picture, a week has 4 days and Alice paints 5 consecutive days. [1] and [2] are different shapes, but [1] and [3] are equal shapes.  Alice wants to know how many possible shapes exists if she set how many days a week has and choose consecutive n days and paints them in calendar started in one of the days of the week. As was said before, she considers only shapes, there all cells are connected by side." 1200
1371A "Magical Sticks" math "A penguin Rocher has n sticks. He has exactly one stick with length i for all 1\xe2\x89\xa4i\xe2\x89\xa4n.He can connect some sticks. If he connects two sticks that have lengths a and b, he gets one stick with length a+b. Two sticks, that were used in the operation disappear from his set and the new connected stick appears in his set and can be used for the next connections.He wants to create the maximum number of sticks that have the same length. It is not necessary to make all sticks have the same length, some sticks can have the other length. How many sticks with the equal length he can create?" 800
1370F2 "The Hidden Pair (Hard Version)" "binary search,dfs and similar,graphs,interactive,shortest paths,trees" "Note that the only difference between the easy and hard version is the constraint on the number of queries. You can make hacks only if all versions of the problem are solved.This is an interactive problem.You are given a tree consisting of n nodes numbered with integers from 1 to n. Ayush and Ashish chose two secret distinct nodes in the tree. You need to find out both the nodes. You can make the following query:   Provide a list of nodes and you will receive a node from that list whose sum of distances to both the hidden nodes is minimal (if there are multiple such nodes in the list, you will receive any one of them). You will also get the sum of distances of that node to the hidden nodes. Recall that a tree is a connected graph without cycles. The distance between two nodes is defined as the number of edges in the simple path between them.More formally, let\'s define two hidden nodes as s and f. In one query you can provide the set of nodes {a1,a2,\xe2\x80\xa6,ac} of the tree. As a result, you will get two numbers ai and dist(ai,s)+dist(ai,f). The node ai is any node from the provided set, for which the number dist(ai,s)+dist(ai,f) is minimal.You can ask no more than 11 queries." 2700
1370F1 "The Hidden Pair (Easy Version)" "binary search,dfs and similar,graphs,interactive,shortest paths,trees" "Note that the only difference between the easy and hard version is the constraint on the number of queries. You can make hacks only if all versions of the problem are solved.This is an interactive problem.You are given a tree consisting of n nodes numbered with integers from 1 to n. Ayush and Ashish chose two secret distinct nodes in the tree. You need to find out both the nodes. You can make the following query:   Provide a list of nodes and you will receive a node from that list whose sum of distances to both the hidden nodes is minimal (if there are multiple such nodes in the list, you will receive any one of them). You will also get the sum of distances of that node to the hidden nodes. Recall that a tree is a connected graph without cycles. The distance between two nodes is defined as the number of edges in the simple path between them.More formally, let\'s define two hidden nodes as s and f. In one query you can provide the set of nodes {a1,a2,\xe2\x80\xa6,ac} of the tree. As a result, you will get two numbers ai and dist(ai,s)+dist(ai,f). The node ai is any node from the provided set, for which the number dist(ai,s)+dist(ai,f) is minimal.You can ask no more than 14 queries." 2400
1370E "Binary Subsequence Rotation" "binary search,constructive algorithms,data structures,greedy" "Naman has two binary strings s and t of length n (a binary string is a string which only consists of the characters ""0"" and ""1""). He wants to convert s into t using the following operation as few times as possible.In one operation, he can choose any subsequence of s and rotate it clockwise once.For example, if s=1110100, he can choose a subsequence corresponding to indices (1-based) {2,6,7} and rotate them clockwise. The resulting string would then be s=1010110.A string a is said to be a subsequence of string b if a can be obtained from b by deleting some characters without changing the ordering of the remaining characters.To perform a clockwise rotation on a sequence c of size k is to perform an operation which sets c1:=ck,c2:=c1,c3:=c2,\xe2\x80\xa6,ck:=ck\xe2\x88\x921 simultaneously.Determine the minimum number of operations Naman has to perform to convert s into t or say that it is impossible." 2100
1370D "Odd-Even Subsequence" "binary search,dp,dsu,greedy,implementation" "Ashish has an array a of size n.A subsequence of a is defined as a sequence that can be obtained from a by deleting some elements (possibly none), without changing the order of the remaining elements.Consider a subsequence s of a. He defines the cost of s as the minimum between:   The maximum among all elements at odd indices of s.  The maximum among all elements at even indices of s. Note that the index of an element is its index in s, rather than its index in a. The positions are numbered from 1. So, the cost of s is equal to min(max(s1,s3,s5,\xe2\x80\xa6),max(s2,s4,s6,\xe2\x80\xa6)).For example, the cost of {7,5,6} is min(max(7,6),max(5))=min(7,5)=5.Help him find the minimum cost of a subsequence of size k." 2000
1370C "Number Game" "games,math,number theory" "Ashishgup and FastestFinger play a game. They start with a number n and play in turns. In each turn, a player can make any one of the following moves:  Divide n by any of its odd divisors greater than 1.  Subtract 1 from n if n is greater than 1. Divisors of a number include the number itself.The player who is unable to make a move loses the game.Ashishgup moves first. Determine the winner of the game if both of them play optimally." 1400
1370B "GCD Compression" "constructive algorithms,math,number theory" "Ashish has an array a of consisting of 2n positive integers. He wants to compress a into an array b of size n\xe2\x88\x921. To do this, he first discards exactly 2 (any two) elements from a. He then performs the following operation until there are no elements left in a:   Remove any two elements from a and append their sum to b. The compressed array b has to have a special property. The greatest common divisor (gcd) of all its elements should be greater than 1.Recall that the gcd of an array of positive integers is the biggest integer that is a divisor of all integers in the array.It can be proven that it is always possible to compress array a into an array b of size n\xe2\x88\x921 such that gcd(b1,b2...,bn\xe2\x88\x921)>1. Help Ashish find a way to do so." 1100
1370A "Maximum GCD" "greedy,implementation,math,number theory" "Let\'s consider all integers in the range from 1 to n (inclusive).Among all pairs of distinct integers in this range, find the maximum possible greatest common divisor of integers in pair. Formally, find the maximum value of gcd(a,b), where 1\xe2\x89\xa4a<b\xe2\x89\xa4n.The greatest common divisor, gcd(a,b), of two positive integers a and b is the biggest integer that is a divisor of both a and b." 800
1369F BareLee "dfs and similar,dp,games" "Lee is used to finish his stories in a stylish way, this time he barely failed it, but Ice Bear came and helped him. Lee is so grateful for it, so he decided to show Ice Bear his new game called ""Critic""...The game is a one versus one game. It has t rounds, each round has two integers si and ei (which are determined and are known before the game begins, si and ei may differ from round to round). The integer si is written on the board at the beginning of the corresponding round. The players will take turns. Each player will erase the number on the board (let\'s say it was a) and will choose to write either 2\xe2\x8b\x85a or a+1 instead. Whoever writes a number strictly greater than ei loses that round and the other one wins that round.Now Lee wants to play ""Critic"" against Ice Bear, for each round he has chosen the round\'s si and ei in advance. Lee will start the first round, the loser of each round will start the next round.The winner of the last round is the winner of the game, and the loser of the last round is the loser of the game.Determine if Lee can be the winner independent of Ice Bear\'s moves or not. Also, determine if Lee can be the loser independent of Ice Bear\'s moves or not." 2700
1369E DeadLee "data structures,dfs and similar,greedy,implementation,sortings" "Lee bought some food for dinner time, but Lee\'s friends eat dinner in a deadly way. Lee is so scared, he doesn\'t want to die, at least not before seeing Online IOI 2020...There are n different types of food and m Lee\'s best friends. Lee has wi plates of the i-th type of food and each friend has two different favorite types of food: the i-th friend\'s favorite types of food are xi and yi (xi\xe2\x89\xa0yi).Lee will start calling his friends one by one. Whoever is called will go to the kitchen and will try to eat one plate of each of his favorite food types. Each of the friends will go to the kitchen exactly once.The only problem is the following: if a friend will eat at least one plate of food (in total) then he will be harmless. But if there is nothing left for him to eat (neither xi nor yi), he will eat Lee instead \xc3\x97_\xc3\x97.Lee can choose the order of friends to call, so he\'d like to determine if he can survive dinner or not. Also, he\'d like to know the order itself." 2400
1369D TediousLee dp,graphs,greedy,math,trees "Lee tried so hard to make a good div.2 D problem to balance his recent contest, but it still doesn\'t feel good at all. Lee invented it so tediously slow that he managed to develop a phobia about div.2 D problem setting instead. And now he is hiding behind the bushes...Let\'s define a Rooted Dead Bush (RDB) of level n as a rooted tree constructed as described below.A rooted dead bush of level 1 is a single vertex. To construct an RDB of level i we, at first, construct an RDB of level i\xe2\x88\x921, then for each vertex u:   if u has no children then we will add a single child to it;  if u has one child then we will add two children to it;  if u has more than one child, then we will skip it.   Rooted Dead Bushes of level 1, 2 and 3. Let\'s define a claw as a rooted tree with four vertices: one root vertex (called also as center) with three children. It looks like a claw:  The center of the claw is the vertex with label 1. Lee has a Rooted Dead Bush of level n. Initially, all vertices of his RDB are green.In one move, he can choose a claw in his RDB, if all vertices in the claw are green and all vertices of the claw are children of its center, then he colors the claw\'s vertices in yellow.He\'d like to know the maximum number of yellow vertices he can achieve. Since the answer might be very large, print it modulo 109+7." 1900
1369C RationalLee "greedy,math,sortings,two pointers" "Lee just became Master in Codeforces, and so, he went out to buy some gifts for his friends. He bought n integers, now it\'s time to distribute them between his friends rationally...Lee has n integers a1,a2,\xe2\x80\xa6,an in his backpack and he has k friends. Lee would like to distribute all integers in his backpack between his friends, such that the i-th friend will get exactly wi integers and each integer will be handed over to exactly one friend.Let\'s define the happiness of a friend as the sum of the maximum and the minimum integer he\'ll get.Lee would like to make his friends as happy as possible, in other words, he\'d like to maximize the sum of friends\' happiness. Now he asks you to calculate the maximum sum of friends\' happiness." 1400
1369B AccurateLee greedy,implementation,strings "Lee was cleaning his house for the party when he found a messy string under the carpets. Now he\'d like to make it clean accurately and in a stylish way...The string s he found is a binary string of length n (i. e. string consists only of 0-s and 1-s).In one move he can choose two consecutive characters si and si+1, and if si is 1 and si+1 is 0, he can erase exactly one of them (he can choose which one to erase but he can\'t erase both characters simultaneously). The string shrinks after erasing.Lee can make an arbitrary number of moves (possibly zero) and he\'d like to make the string s as clean as possible. He thinks for two different strings x and y, the shorter string is cleaner, and if they are the same length, then the lexicographically smaller string is cleaner.Now you should answer t test cases: for the i-th test case, print the cleanest possible string that Lee can get by doing some number of moves.Small reminder: if we have two strings x and y of the same length then x is lexicographically smaller than y if there is a position i such that x1=y1, x2=y2,..., xi\xe2\x88\x921=yi\xe2\x88\x921 and xi<yi." 1200
1369A FashionabLee geometry,math "Lee is going to fashionably decorate his house for a party, using some regular convex polygons...Lee thinks a regular n-sided (convex) polygon is beautiful if and only if he can rotate it in such a way that at least one of its edges is parallel to the OX-axis and at least one of its edges is parallel to the OY-axis at the same time.Recall that a regular n-sided polygon is a convex polygon with n vertices such that all the edges and angles are equal.Now he is shopping: the market has t regular polygons. For each of them print YES if it is beautiful and NO otherwise." 800
1368H2 "Breadboard Capacity (hard version)" NA "This is a harder version of the problem H with modification queries.Lester and Delbert work at an electronics company. They are currently working on a microchip component serving to connect two independent parts of a large supercomputer.The component is built on top of a breadboard \xe2\x80\x94 a grid-like base for a microchip. The breadboard has n rows and m columns, and each row-column intersection contains a node. Also, on each side of the breadboard there are ports that can be attached to adjacent nodes. Left and right side have n ports each, and top and bottom side have m ports each. Each of the ports is connected on the outside to one of the parts bridged by the breadboard, and is colored red or blue respectively.  Ports can be connected by wires going inside the breadboard. However, there are a few rules to follow: Each wire should connect a red port with a blue port, and each port should be connected to at most one wire. Each part of the wire should be horizontal or vertical, and turns are only possible at one of the nodes. To avoid interference, wires can not have common parts of non-zero length (but may have common nodes). Also, a wire can not cover the same segment of non-zero length twice.The capacity of the breadboard is the largest number of red-blue wire connections that can be made subject to the rules above. For example, the breadboard above has capacity 7, and one way to make seven connections is pictured below.  Up to this point statements of both versions are identical. Differences follow below.As is common, specifications of the project change a lot during development, so coloring of the ports is not yet fixed. There are q modifications to process, each of them has the form of ""colors of all ports in a contiguous range along one of the sides are switched (red become blue, and blue become red)"". All modifications are persistent, that is, the previous modifications are not undone before the next one is made.To estimate how bad the changes are, Lester and Delbert need to find the breadboard capacity after each change. Help them do this efficiently." 3500
1368H1 "Breadboard Capacity (easy version)" dp,flows,greedy "This is an easier version of the problem H without modification queries.Lester and Delbert work at an electronics company. They are currently working on a microchip component serving to connect two independent parts of a large supercomputer.The component is built on top of a breadboard \xe2\x80\x94 a grid-like base for a microchip. The breadboard has n rows and m columns, and each row-column intersection contains a node. Also, on each side of the breadboard there are ports that can be attached to adjacent nodes. Left and right side have n ports each, and top and bottom side have m ports each. Each of the ports is connected on the outside to one of the parts bridged by the breadboard, and is colored red or blue respectively.  Ports can be connected by wires going inside the breadboard. However, there are a few rules to follow: Each wire should connect a red port with a blue port, and each port should be connected to at most one wire. Each part of the wire should be horizontal or vertical, and turns are only possible at one of the nodes. To avoid interference, wires can not have common parts of non-zero length (but may have common nodes). Also, a wire can not cover the same segment of non-zero length twice.The capacity of the breadboard is the largest number of red-blue wire connections that can be made subject to the rules above. For example, the breadboard above has capacity 7, and one way to make seven connections is pictured below.  Up to this point statements of both versions are identical. Differences follow below.Given the current breadboard configuration, help Lester and Delbert find its capacity efficiently." 3300
1368G "Shifting Dominoes" "data structures,geometry,graphs,trees" "Bill likes to play with dominoes. He took an n\xc3\x97m board divided into equal square cells, and covered it with dominoes. Each domino covers two adjacent cells of the board either horizontally or vertically, and each cell is covered exactly once with a half of one domino (that is, there are no uncovered cells, and no two dominoes cover the same cell twice).After that Bill decided to play with the covered board and share some photos of it on social media. First, he removes exactly one domino from the board, freeing two of the cells. Next, he moves dominoes around. A domino can only be moved along the line parallel to its longer side. A move in the chosen direction is possible if the next cell in this direction is currently free. Bill doesn\'t want to lose track of what the original tiling looks like, so he makes sure that at any point each domino shares at least one cell with its original position.After removing a domino and making several (possibly, zero) moves Bill takes a photo of the board and posts it. However, with the amount of filters Bill is using, domino borders are not visible, so only the two free cells of the board can be identified. When the photo is posted, Bill reverts the board to its original state and starts the process again.Bill wants to post as many photos as possible, but he will not post any photo twice. How many distinct photos can he take? Recall that photos are different if the pairs of free cells in the photos are different." 3200
1368F "Lamps on a Circle" games,implementation,interactive,math "This is an interactive problem.John and his imaginary friend play a game. There are n lamps arranged in a circle. Lamps are numbered 1 through n in clockwise order, that is, lamps i and i+1 are adjacent for any i=1,\xe2\x80\xa6,n\xe2\x88\x921, and also lamps n and 1 are adjacent. Initially all lamps are turned off.John and his friend take turns, with John moving first. On his turn John can choose to terminate the game, or to make a move. To make a move, John can choose any positive number k and turn any k lamps of his choosing on. In response to this move, John\'s friend will choose k consecutive lamps and turn all of them off (the lamps in the range that were off before this move stay off). Note that the value of k is the same as John\'s number on his last move. For example, if n=5 and John have just turned three lamps on, John\'s friend may choose to turn off lamps 1,2,3, or 2,3,4, or 3,4,5, or 4,5,1, or 5,1,2.After this, John may choose to terminate or move again, and so on. However, John can not make more than 104 moves.John wants to maximize the number of lamps turned on at the end of the game, while his friend wants to minimize this number. Your task is to provide a strategy for John to achieve optimal result. Your program will play interactively for John against the jury\'s interactor program playing for John\'s friend.Suppose there are n lamps in the game. Let R(n) be the number of turned on lamps at the end of the game if both players act optimally. Your program has to terminate the game with at least R(n) turned on lamps within 104 moves. Refer to Interaction section below for interaction details.For technical reasons hacks for this problem are disabled." 2600
1368E "Ski Accidents" "constructive algorithms,graphs,greedy" "Arthur owns a ski resort on a mountain. There are n landing spots on the mountain numbered from 1 to n from the top to the foot of the mountain. The spots are connected with one-directional ski tracks. All tracks go towards the foot of the mountain, so there are no directed cycles formed by the tracks. There are at most two tracks leaving each spot, but many tracks may enter the same spot.A skier can start skiing from one spot and stop in another spot if there is a sequence of tracks that lead from the starting spot and end in the ending spot. Unfortunately, recently there were many accidents, because the structure of the resort allows a skier to go through dangerous paths, by reaching high speed and endangering himself and the other customers. Here, a path is called dangerous, if it consists of at least two tracks.Arthur wants to secure his customers by closing some of the spots in a way that there are no dangerous paths in the resort. When a spot is closed, all tracks entering and leaving that spot become unusable. Formally, after closing some of the spots, there should not be a path that consists of two or more tracks.Arthur doesn\'t want to close too many spots. He will be happy to find any way to close at most 47n spots so that the remaining part is safe. Help him find any suitable way to do so." 2500
1368D "AND, OR and square sum" bitmasks,greedy,math "Gottfried learned about binary number representation. He then came up with this task and presented it to you.You are given a collection of n non-negative integers a1,\xe2\x80\xa6,an. You are allowed to perform the following operation: choose two distinct indices 1\xe2\x89\xa4i,j\xe2\x89\xa4n. If before the operation ai=x, aj=y, then after the operation ai=x AND y, aj=x OR y, where AND and OR are bitwise AND and OR respectively (refer to the Notes section for formal description). The operation may be performed any number of times (possibly zero).After all operations are done, compute \xe2\x88\x91ni=1a2i \xe2\x80\x94 the sum of squares of all ai. What is the largest sum of squares you can achieve?" 1700
1368C "Even Picture" "constructive algorithms" "Leo Jr. draws pictures in his notebook with checkered sheets (that is, each sheet has a regular square grid printed on it). We can assume that the sheets are infinitely large in any direction.To draw a picture, Leo Jr. colors some of the cells on a sheet gray. He considers the resulting picture beautiful if the following conditions are satisfied: The picture is connected, that is, it is possible to get from any gray cell to any other by following a chain of gray cells, with each pair of adjacent cells in the path being neighbours (that is, sharing a side). Each gray cell has an even number of gray neighbours. There are exactly n gray cells with all gray neighbours. The number of other gray cells can be arbitrary (but reasonable, so that they can all be listed).Leo Jr. is now struggling to draw a beautiful picture with a particular choice of n. Help him, and provide any example of a beautiful picture.To output cell coordinates in your answer, assume that the sheet is provided with a Cartesian coordinate system such that one of the cells is chosen to be the origin (0,0), axes 0x and 0y are orthogonal and parallel to grid lines, and a unit step along any axis in any direction takes you to a neighbouring cell." 1500
1368B "Codeforces Subsequences" "brute force,constructive algorithms,greedy,math,strings" "Karl likes Codeforces and subsequences. He wants to find a string of lowercase English letters that contains at least k subsequences codeforces. Out of all possible strings, Karl wants to find a shortest one.Formally, a codeforces subsequence of a string s is a subset of ten characters of s that read codeforces from left to right. For example, codeforces contains codeforces a single time, while codeforcesisawesome contains codeforces four times: codeforcesisawesome, codeforcesisawesome, codeforcesisawesome, codeforcesisawesome.Help Karl find any shortest string that contains at least k codeforces subsequences." 1500
1368A C+= "brute force,greedy,implementation,math" "Leo has developed a new programming language C+=. In C+=, integer variables can only be changed with a ""+="" operation that adds the right-hand side value to the left-hand side variable. For example, performing ""a += b"" when a = 2, b = 3 changes the value of a to 5 (the value of b does not change).In a prototype program Leo has two integer variables a and b, initialized with some positive values. He can perform any number of operations ""a += b"" or ""b += a"". Leo wants to test handling large integers, so he wants to make the value of either a or b strictly greater than a given value n. What is the smallest number of operations he has to perform?" 800
1367F2 "Flying Sort (Hard Version)" "binary search,data structures,dp,greedy,sortings,two pointers" "This is a hard version of the problem. In this version, the given array can contain equal elements and the constraints on n are greater than in the easy version of the problem.You are given an array a of n integers (the given array can contain equal elements). You can perform the following operations on array elements:  choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and move the element a[i] to the begin of the array;  choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and move the element a[i] to the end of the array. For example, if n=5, a=[4,7,2,2,9], then the following sequence of operations can be performed:   after performing the operation of the first type to the second element, the array a will become [7,4,2,2,9];  after performing the operation of the second type to the second element, the array a will become [7,2,2,9,4]. You can perform operations of any type any number of times in any order.Find the minimum total number of operations of the first and second type that will make the a array sorted in non-decreasing order. In other words, what is the minimum number of operations must be performed so the array satisfies the inequalities a[1]\xe2\x89\xa4a[2]\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4a[n]." 2400
1367F1 "Flying Sort (Easy Version)" "dp,greedy,two pointers" "This is an easy version of the problem. In this version, all numbers in the given array are distinct and the constraints on n are less than in the hard version of the problem.You are given an array a of n integers (there are no equals elements in the array). You can perform the following operations on array elements:  choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and move the element a[i] to the begin of the array;  choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and move the element a[i] to the end of the array. For example, if n=5, a=[4,7,2,3,9], then the following sequence of operations can be performed:   after performing the operation of the first type to the second element, the array a will become [7,4,2,3,9];  after performing the operation of the second type to the second element, the array a will become [7,2,3,9,4]. You can perform operations of any type any number of times in any order.Find the minimum total number of operations of the first and second type that will make the a array sorted in non-decreasing order. In other words, what is the minimum number of operations that must be performed so the array satisfies the inequalities a[1]\xe2\x89\xa4a[2]\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4a[n]." 2100
1367E "Necklace Assembly" "brute force,dfs and similar,dp,graphs,greedy,number theory" "The store sells n beads. The color of each bead is described by a lowercase letter of the English alphabet (""a""\xe2\x80\x93""z""). You want to buy some beads to assemble a necklace from them.A necklace is a set of beads connected in a circle.For example, if the store sells beads ""a"", ""b"", ""c"", ""a"", ""c"", ""c"", then you can assemble the following necklaces (these are not all possible options):  And the following necklaces cannot be assembled from beads sold in the store:  The first necklace cannot be assembled because it has three beads ""a"" (of the two available). The second necklace cannot be assembled because it contains a bead ""d"", which is not sold in the store. We call a necklace k-beautiful if, when it is turned clockwise by k beads, the necklace remains unchanged. For example, here is a sequence of three turns of a necklace.    As you can see, this necklace is, for example, 3-beautiful, 6-beautiful, 9-beautiful, and so on, but it is not 1-beautiful or 2-beautiful.In particular, a necklace of length 1 is k-beautiful for any integer k. A necklace that consists of beads of the same color is also beautiful for any k.You are given the integers n and k, and also the string s containing n lowercase letters of the English alphabet \xe2\x80\x94 each letter defines a bead in the store. You can buy any subset of beads and connect them in any order. Find the maximum length of a k-beautiful necklace you can assemble." 1900
1367D "Task On The Board" "constructive algorithms,greedy,implementation,sortings" "Polycarp wrote on the board a string s containing only lowercase Latin letters (\'a\'-\'z\'). This string is known for you and given in the input.After that, he erased some letters from the string s, and he rewrote the remaining letters in any order. As a result, he got some new string t. You have to find it with some additional information.Suppose that the string t has length m and the characters are numbered from left to right from 1 to m. You are given a sequence of m integers: b1,b2,\xe2\x80\xa6,bm, where bi is the sum of the distances |i\xe2\x88\x92j| from the index i to all such indices j that tj>ti (consider that \'a\'<\'b\'<...<\'z\'). In other words, to calculate bi, Polycarp finds all such indices j that the index j contains a letter that is later in the alphabet than ti and sums all the values |i\xe2\x88\x92j|.For example, if t = ""abzb"", then:  since t1=\'a\', all other indices contain letters which are later in the alphabet, that is: b1=|1\xe2\x88\x922|+|1\xe2\x88\x923|+|1\xe2\x88\x924|=1+2+3=6;  since t2=\'b\', only the index j=3 contains the letter, which is later in the alphabet, that is: b2=|2\xe2\x88\x923|=1;  since t3=\'z\', then there are no indexes j such that tj>ti, thus b3=0;  since t4=\'b\', only the index j=3 contains the letter, which is later in the alphabet, that is: b4=|4\xe2\x88\x923|=1. Thus, if t = ""abzb"", then b=[6,1,0,1].Given the string s and the array b, find any possible string t for which the following two requirements are fulfilled simultaneously:  t is obtained from s by erasing some letters (possibly zero) and then writing the rest in any order;  the array, constructed from the string t according to the rules above, equals to the array b specified in the input data." 1800
1367C "Social Distance" "constructive algorithms,greedy,math" "Polycarp and his friends want to visit a new restaurant. The restaurant has n tables arranged along a straight line. People are already sitting at some tables. The tables are numbered from 1 to n in the order from left to right. The state of the restaurant is described by a string of length n which contains characters ""1"" (the table is occupied) and ""0"" (the table is empty).Restaurant rules prohibit people to sit at a distance of k or less from each other. That is, if a person sits at the table number i, then all tables with numbers from i\xe2\x88\x92k to i+k (except for the i-th) should be free. In other words, the absolute difference of the numbers of any two occupied tables must be strictly greater than k.For example, if n=8 and k=2, then:  strings ""10010001"", ""10000010"", ""00000000"", ""00100000"" satisfy the rules of the restaurant;  strings ""10100100"", ""10011001"", ""11111111"" do not satisfy to the rules of the restaurant, since each of them has a pair of ""1"" with a distance less than or equal to k=2. In particular, if the state of the restaurant is described by a string without ""1"" or a string with one ""1"", then the requirement of the restaurant is satisfied.You are given a binary string s that describes the current state of the restaurant. It is guaranteed that the rules of the restaurant are satisfied for the string s.Find the maximum number of free tables that you can occupy so as not to violate the rules of the restaurant. Formally, what is the maximum number of ""0"" that can be replaced by ""1"" such that the requirement will still be satisfied?For example, if n=6, k=1, s= ""100010"", then the answer to the problem will be 1, since only the table at position 3 can be occupied such that the rules are still satisfied." 1300
1367B "Even Array" greedy,math "You are given an array a[0\xe2\x80\xa6n\xe2\x88\x921] of length n which consists of non-negative integers. Note that array indices start from zero.An array is called good if the parity of each index matches the parity of the element at that index. More formally, an array is good if for all i (0\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) the equality imod2=a[i]mod2 holds, where xmod2 is the remainder of dividing x by 2.For example, the arrays [0,5,2,1] and [0,17,0,3] are good, and the array [2,4,6,7] is bad, because for i=1, the parities of i and a[i] are different: imod2=1mod2=1, but a[i]mod2=4mod2=0.In one move, you can take any two elements of the array and swap them (these elements are not necessarily adjacent).Find the minimum number of moves in which you can make the array a good, or say that this is not possible." 800
1367A "Short Substrings" implementation,strings "Alice guesses the strings that Bob made for her.At first, Bob came up with the secret string a consisting of lowercase English letters. The string a has a length of 2 or more characters. Then, from string a he builds a new string b and offers Alice the string b so that she can guess the string a.Bob builds b from a as follows: he writes all the substrings of length 2 of the string a in the order from left to right, and then joins them in the same order into the string b.For example, if Bob came up with the string a=""abac"", then all the substrings of length 2 of the string a are: ""ab"", ""ba"", ""ac"". Therefore, the string b=""abbaac"".You are given the string b. Help Alice to guess the string a that Bob came up with. It is guaranteed that b was built according to the algorithm given above. It can be proved that the answer to the problem is unique." 800
1366G "Construct the String" "data structures,dp,strings" "Let\'s denote the function f(s) that takes a string s consisting of lowercase Latin letters and dots, and returns a string consisting of lowercase Latin letters as follows:  let r be an empty string;  process the characters of s from left to right. For each character c, do the following: if c is a lowercase Latin letter, append c at the end of the string r; otherwise, delete the last character from r (if r is empty before deleting the last character \xe2\x80\x94 the function crashes);  return r as the result of the function. You are given two strings s and t. You have to delete the minimum possible number of characters from s so that f(s)=t (and the function does not crash). Note that you aren\'t allowed to insert new characters into s or reorder the existing ones." 2700
1366F "Jog Around The Graph" "binary search,dp,geometry,graphs" "You are given a simple weighted connected undirected graph, consisting of n vertices and m edges.A path in the graph of length k is a sequence of k+1 vertices v1,v2,\xe2\x80\xa6,vk+1 such that for each i (1\xe2\x89\xa4i\xe2\x89\xa4k) the edge (vi,vi+1) is present in the graph. A path from some vertex v also has vertex v1=v. Note that edges and vertices are allowed to be included in the path multiple times.The weight of the path is the total weight of edges in it.For each i from 1 to q consider a path from vertex 1 of length i of the maximum weight. What is the sum of weights of these q paths?Answer can be quite large, so print it modulo 109+7." 2700
1366E "Two Arrays" "binary search,brute force,combinatorics,constructive algorithms,dp,two pointers" "You are given two arrays a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bm. Array b is sorted in ascending order (bi<bi+1 for each i from 1 to m\xe2\x88\x921).You have to divide the array a into m consecutive subarrays so that, for each i from 1 to m, the minimum on the i-th subarray is equal to bi. Note that each element belongs to exactly one subarray, and they are formed in such a way: the first several elements of a compose the first subarray, the next several elements of a compose the second subarray, and so on.For example, if a=[12,10,20,20,25,30] and b=[10,20,30] then there are two good partitions of array a:   [12,10,20],[20,25],[30];  [12,10],[20,20,25],[30]. You have to calculate the number of ways to divide the array a. Since the number can be pretty large print it modulo 998244353." 2100
1366D "Two Divisors" "constructive algorithms,math,number theory" "You are given n integers a1,a2,\xe2\x80\xa6,an.For each ai find its two divisors d1>1 and d2>1 such that gcd(d1+d2,ai)=1 (where gcd(a,b) is the greatest common divisor of a and b) or say that there is no such pair." 2000
1366C "Palindromic Paths" greedy,math "You are given a matrix with n rows (numbered from 1 to n) and m columns (numbered from 1 to m). A number ai,j is written in the cell belonging to the i-th row and the j-th column, each number is either 0 or 1.A chip is initially in the cell (1,1), and it will be moved to the cell (n,m). During each move, it either moves to the next cell in the current row, or in the current column (if the current cell is (x,y), then after the move it can be either (x+1,y) or (x,y+1)). The chip cannot leave the matrix.Consider each path of the chip from (1,1) to (n,m). A path is called palindromic if the number in the first cell is equal to the number in the last cell, the number in the second cell is equal to the number in the second-to-last cell, and so on.Your goal is to change the values in the minimum number of cells so that every path is palindromic." 1500
1366B Shuffle "math,two pointers" "You are given an array consisting of n integers a1, a2, ..., an. Initially ax=1, all other elements are equal to 0.You have to perform m operations. During the i-th operation, you choose two indices c and d such that li\xe2\x89\xa4c,d\xe2\x89\xa4ri, and swap ac and ad.Calculate the number of indices k such that it is possible to choose the operations so that ak=1 in the end." 1300
1366A "Shovels and Swords" "binary search,greedy,math" "Polycarp plays a well-known computer game (we won\'t mention its name). In this game, he can craft tools of two types \xe2\x80\x94 shovels and swords. To craft a shovel, Polycarp spends two sticks and one diamond; to craft a sword, Polycarp spends two diamonds and one stick.Each tool can be sold for exactly one emerald. How many emeralds can Polycarp earn, if he has a sticks and b diamonds?" 1100
1365G "Secure Password" "bitmasks,combinatorics,constructive algorithms,interactive,math" "This is an interactive problem.Ayush devised yet another scheme to set the password of his lock. The lock has n slots where each slot can hold any non-negative integer. The password P is a sequence of n integers, i-th element of which goes into the i-th slot of the lock.To set the password, Ayush comes up with an array A of n integers each in the range [0,263\xe2\x88\x921]. He then sets the i-th element of P as the bitwise OR of all integers in the array except Ai.You need to guess the password. To make a query, you can choose a non-empty subset of indices of the array and ask the bitwise OR all elements of the array with index in this subset. You can ask no more than 13 queries." 2800
1365F "Swaps Again" "constructive algorithms,implementation,sortings" "Ayush, Ashish and Vivek are busy preparing a new problem for the next Codeforces round and need help checking if their test cases are valid.Each test case consists of an integer n and two arrays a and b, of size n. If after some (possibly zero) operations described below, array a can be transformed into array b, the input is said to be valid. Otherwise, it is invalid.An operation on array a is:   select an integer k (1\xe2\x89\xa4k\xe2\x89\xa4\xe2\x8c\x8an2\xe2\x8c\x8b)  swap the prefix of length k with the suffix of length k For example, if array a initially is {1,2,3,4,5,6}, after performing an operation with k=2, it is transformed into {5,6,3,4,1,2}.Given the set of test cases, help them determine if each one is valid or invalid." 2100
1365E "Maximum Subsequence Value" "brute force,constructive algorithms" "Ridhiman challenged Ashish to find the maximum valued subsequence of an array a of size n consisting of positive integers. The value of a non-empty subsequence of k elements of a is defined as \xe2\x88\x912i over all integers i\xe2\x89\xa50 such that at least max(1,k\xe2\x88\x922) elements of the subsequence have the i-th bit set in their binary representation (value x has the i-th bit set in its binary representation if \xe2\x8c\x8ax2i\xe2\x8c\x8bmod2 is equal to 1). Recall that b is a subsequence of a, if b can be obtained by deleting some(possibly zero) elements from a.Help Ashish find the maximum value he can get by choosing some subsequence of a." 1900
1365D "Solve The Maze" "constructive algorithms,dfs and similar,dsu,graphs,greedy,implementation,shortest paths" "Vivek has encountered a problem. He has a maze that can be represented as an n\xc3\x97m grid. Each of the grid cells may represent the following:  Empty \xe2\x80\x94 \'.\'  Wall \xe2\x80\x94 \'#\'  Good person  \xe2\x80\x94 \'G\'  Bad person \xe2\x80\x94 \'B\' The only escape from the maze is at cell (n,m).A person can move to a cell only if it shares a side with their current cell and does not contain a wall. Vivek wants to block some of the empty cells by replacing them with walls in such a way, that all the good people are able to escape, while none of the bad people are able to. A cell that initially contains \'G\' or \'B\' cannot be blocked and can be travelled through.Help him determine if there exists a way to replace some (zero or more) empty cells with walls to satisfy the above conditions.It is guaranteed that the cell (n,m) is empty. Vivek can also block this cell." 1700
1365C "Rotation Matching" "constructive algorithms,data structures,greedy,implementation" "After the mysterious disappearance of Ashish, his two favourite disciples Ishika and Hriday, were each left with one half of a secret message. These messages can each be represented by a permutation of size n. Let\'s call them a and b.Note that a permutation of n elements is a sequence of numbers a1,a2,\xe2\x80\xa6,an, in which every number from 1 to n appears exactly once. The message can be decoded by an arrangement of sequence a and b, such that the number of matching pairs of elements between them is maximum. A pair of elements ai and bj is said to match if:   i=j, that is, they are at the same index.  ai=bj His two disciples are allowed to perform the following operation any number of times:   choose a number k and cyclically shift one of the permutations to the left or right k times. A single cyclic shift to the left on any permutation c is an operation that sets c1:=c2,c2:=c3,\xe2\x80\xa6,cn:=c1 simultaneously. Likewise, a single cyclic shift to the right on any permutation c is an operation that sets c1:=cn,c2:=c1,\xe2\x80\xa6,cn:=cn\xe2\x88\x921 simultaneously.Help Ishika and Hriday find the maximum number of pairs of elements that match after performing the operation any (possibly zero) number of times." 1400
1365B "Trouble Sort" "constructive algorithms,implementation" "Ashish has n elements arranged in a line. These elements are represented by two integers ai \xe2\x80\x94 the value of the element and bi \xe2\x80\x94 the type of the element (there are only two possible types: 0 and 1). He wants to sort the elements in non-decreasing values of ai.He can perform the following operation any number of times:  Select any two elements i and j such that bi\xe2\x89\xa0bj and swap them. That is, he can only swap two elements of different types in one move. Tell him if he can sort the elements in non-decreasing values of ai after performing any number of operations." 1300
1365A "Matrix Game" games,greedy,implementation "Ashish and Vivek play a game on a matrix consisting of n rows and m columns, where they take turns claiming cells. Unclaimed cells are represented by 0, while claimed cells are represented by 1. The initial state of the matrix is given. There can be some claimed cells in the initial state.In each turn, a player must claim a cell. A cell may be claimed if it is unclaimed and does not share a row or column with any other already claimed cells. When a player is unable to make a move, he loses and the game ends.If Ashish and Vivek take turns to move and Ashish goes first, determine the winner of the game if both of them are playing optimally.Optimal play between two players means that both players choose the best possible strategy to achieve the best possible outcome for themselves." 1100
1364E X-OR "bitmasks,constructive algorithms,divide and conquer,interactive,probabilities" "This is an interactive problem!Ehab has a hidden permutation p of length n consisting of the elements from 0 to n\xe2\x88\x921. You, for some reason, want to figure out the permutation. To do that, you can give Ehab 2 different indices i and j, and he\'ll reply with (pi|pj) where | is the bitwise-or operation.Ehab has just enough free time to answer 4269 questions, and while he\'s OK with answering that many questions, he\'s too lazy to play your silly games, so he\'ll fix the permutation beforehand and will not change it depending on your queries. Can you guess the permutation?" 2700
1364D "Ehab\'s Last Corollary" "constructive algorithms,dfs and similar,graphs,greedy,implementation,trees" "Given a connected undirected graph with n vertices and an integer k, you have to either:  either find an independent set that has exactly \xe2\x8c\x88k2\xe2\x8c\x89 vertices. or find a simple cycle of length at most k. An independent set is a set of vertices such that no two of them are connected by an edge. A simple cycle is a cycle that doesn\'t contain any vertex twice. I have a proof that for any input you can always solve at least one of these problems, but it\'s left as an exercise for the reader." 2100
1364C "Ehab and Prefix MEXs" "brute force,constructive algorithms,greedy" "Given an array a of length n, find another array, b, of length n such that:  for each i (1\xe2\x89\xa4i\xe2\x89\xa4n) MEX({b1, b2, \xe2\x80\xa6, bi})=ai. The MEX of a set of integers is the smallest non-negative integer that doesn\'t belong to this set.If such array doesn\'t exist, determine this." 1600
1364B "Most socially-distanced subsequence" "greedy,two pointers" "Given a permutation p of length n, find its subsequence s1, s2, \xe2\x80\xa6, sk of length at least 2 such that:  |s1\xe2\x88\x92s2|+|s2\xe2\x88\x92s3|+\xe2\x80\xa6+|sk\xe2\x88\x921\xe2\x88\x92sk| is as big as possible over all subsequences of p with length at least 2.  Among all such subsequences, choose the one whose length, k, is as small as possible. If multiple subsequences satisfy these conditions, you are allowed to find any of them.A sequence a is a subsequence of an array b if a can be obtained from b by deleting some (possibly, zero or all) elements.A permutation of length n is an array of length n in which every element from 1 to n occurs exactly once." 1300
1364A XXXXX "brute force,data structures,number theory,two pointers" "Ehab loves number theory, but for some reason he hates the number x. Given an array a, find the length of its longest subarray such that the sum of its elements isn\'t divisible by x, or determine that such subarray doesn\'t exist.An array a is a subarray of an array b if a can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 1200
1363F "Rotating Substrings" dp,strings "You are given two strings s and t, each of length n and consisting of lowercase Latin alphabets. You want to make s equal to t. You can perform the following operation on s any number of times to achieve it \xe2\x80\x94   Choose any substring of s and rotate it clockwise once, that is, if the selected substring is s[l,l+1...r], then it becomes s[r,l,l+1...r\xe2\x88\x921]. All the remaining characters of s stay in their position. For example, on rotating the substring [2,4] , string ""abcde"" becomes ""adbce"". A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.Find the minimum number of operations required to convert s to t, or determine that it\'s impossible." 2600
1363E "Tree Shuffling" "dfs and similar,dp,greedy,trees" "Ashish has a tree consisting of n nodes numbered 1 to n rooted at node 1. The i-th node in the tree has a cost ai, and binary digit bi is written in it. He wants to have binary digit ci written in the i-th node in the end.To achieve this, he can perform the following operation any number of times:   Select any k nodes from the subtree of any node u, and shuffle the digits in these nodes as he wishes, incurring a cost of k\xe2\x8b\x85au. Here, he can choose k ranging from 1 to the size of the subtree of u. He wants to perform the operations in such a way that every node finally has the digit corresponding to its target.Help him find the minimum total cost he needs to spend so that after all the operations, every node u has digit cu written in it, or determine that it is impossible." 2000
1363D "Guess The Maximums" "binary search,implementation,interactive,math" "This is an interactive problem.Ayush devised a new scheme to set the password of his lock. The lock has k slots where each slot can hold integers from 1 to n. The password P is a sequence of k integers each in the range [1,n], i-th element of which goes into the i-th slot of the lock.To set the password of his lock, Ayush comes up with an array A of n integers each in the range [1,n] (not necessarily distinct). He then picks k non-empty mutually disjoint subsets of indices S1,S2,...,Sk (Si\xe2\x88\xa9i\xe2\x89\xa0jSj=\xe2\x88\x85) and sets his password as Pi=maxj\xe2\x88\x89SiA[j]. In other words, the i-th integer in the password is equal to the maximum over all elements of A whose indices do not belong to Si.You are given the subsets of indices chosen by Ayush. You need to guess the password. To make a query, you can choose a non-empty subset of indices of the array and ask the maximum of all elements of the array with index in this subset. You can ask no more than 12 queries." 2100
1363C "Game On Leaves" games,trees "Ayush and Ashish play a game on an unrooted tree consisting of n nodes numbered 1 to n. Players make the following move in turns:   Select any leaf node in the tree and remove it together with any edge which has this node as one of its endpoints. A leaf node is a node with degree less than or equal to 1. A tree is a connected undirected graph without cycles.There is a special node numbered x. The player who removes this node wins the game. Ayush moves first. Determine the winner of the game if each player plays optimally." 1600
1363B "Subsequence Hate" implementation,strings "Shubham has a binary string s. A binary string is a string containing only characters ""0"" and ""1"".He can perform the following operation on the string any amount of times:   Select an index of the string, and flip the character at that index. This means, if the character was ""0"", it becomes ""1"", and vice versa. A string is called good if it does not contain ""010"" or ""101"" as a subsequence  \xe2\x80\x94 for instance, ""1001"" contains ""101"" as a subsequence, hence it is not a good string, while ""1000"" doesn\'t contain neither ""010"" nor ""101"" as subsequences, so it is a good string.What is the minimum number of operations he will have to perform, so that the string becomes good? It can be shown that with these operations we can make any string good.A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters." 1400
1363A "Odd Selection" "brute force,implementation,math" "Shubham has an array a of size n, and wants to select exactly x elements from it, such that their sum is odd. These elements do not have to be consecutive. The elements of the array are not guaranteed to be distinct.Tell him whether he can do so." 1200
1362C "Johnny and Another Rating Drop" bitmasks,greedy,math "The last contest held on Johnny\'s favorite competitive programming platform has been received rather positively. However, Johnny\'s rating has dropped again! He thinks that the presented tasks are lovely, but don\'t show the truth about competitors\' skills.The boy is now looking at the ratings of consecutive participants written in a binary system. He thinks that the more such ratings differ, the more unfair is that such people are next to each other. He defines the difference between two numbers as the number of bit positions, where one number has zero, and another has one (we suppose that numbers are padded with leading zeros to the same length). For example, the difference of 5=1012 and 14=11102 equals to 3, since 0101 and 1110 differ in 3 positions. Johnny defines the unfairness of the contest as the sum of such differences counted for neighboring participants.Johnny has just sent you the rating sequence and wants you to find the unfairness of the competition. You have noticed that you\'ve got a sequence of consecutive integers from 0 to n. That\'s strange, but the boy stubbornly says that everything is right. So help him and find the desired unfairness for received numbers." 1400
1362B "Johnny and His Hobbies" "bitmasks,brute force" "Among Johnny\'s numerous hobbies, there are two seemingly harmless ones: applying bitwise operations and sneaking into his dad\'s office. As it is usually the case with small children, Johnny is unaware that combining these two activities can get him in a lot of trouble.There is a set S containing very important numbers on his dad\'s desk. The minute Johnny heard about it, he decided that it\'s a good idea to choose a positive integer k and replace each element s of the set S with s\xe2\x8a\x95k (\xe2\x8a\x95 denotes the exclusive or operation). Help him choose such k that Johnny\'s dad will not see any difference after his son is done playing (i.e. Johnny will get the same set as before playing). It is possible that no such number exists. It is also possible that there are many of them. In such a case, output the smallest one. Note that the order of elements in a set doesn\'t matter, i.e. set {1,2,3} equals to set {2,1,3}.Formally, find the smallest positive integer k such that {s\xe2\x8a\x95k|s\xe2\x88\x88S}=S or report that there is no such number.For example, if S={1,3,4} and k=2, new set will be equal to {3,1,6}. If S={0,1,2,3} and k=1, after playing set will stay the same." 1200
1362A "Johnny and Ancient Computer" implementation "Johnny has recently found an ancient, broken computer. The machine has only one register, which allows one to put in there one variable. Then in one operation, you can shift its bits left or right by at most three positions. The right shift is forbidden if it cuts off some ones. So, in fact, in one operation, you can multiply or divide your number by 2, 4 or 8, and division is only allowed if the number is divisible by the chosen divisor. Formally, if the register contains a positive integer x, in one operation it can be replaced by one of the following:   x\xe2\x8b\x852  x\xe2\x8b\x854  x\xe2\x8b\x858  x/2, if x is divisible by 2  x/4, if x is divisible by 4  x/8, if x is divisible by 8 For example, if x=6, in one operation it can be replaced by 12, 24, 48 or 3. Value 6 isn\'t divisible by 4 or 8, so there\'re only four variants of replacement.Now Johnny wonders how many operations he needs to perform if he puts a in the register and wants to get b at the end." 1000
1361F "Johnny and New Toy" "data structures,implementation,math" "Johnny has a new toy. As you may guess, it is a little bit extraordinary. The toy is a permutation P of numbers from 1 to n, written in one row next to each other. For each i from 1 to n\xe2\x88\x921 between Pi and Pi+1 there is a weight Wi written, and those weights form a permutation of numbers from 1 to n\xe2\x88\x921. There are also extra weights W0=Wn=0.The instruction defines subsegment [L,R] as good if WL\xe2\x88\x921<Wi and WR<Wi for any i in {L,L+1,\xe2\x80\xa6,R\xe2\x88\x921}. For such subsegment it also defines WM as minimum of set {WL,WL+1,\xe2\x80\xa6,WR\xe2\x88\x921}. Now the fun begins. In one move, the player can choose one of the good subsegments, cut it into [L,M] and [M+1,R] and swap the two parts. More precisely, before one move the chosen subsegment of our toy looks like: WL\xe2\x88\x921,PL,WL,\xe2\x80\xa6,WM\xe2\x88\x921,PM,WM,PM+1,WM+1,\xe2\x80\xa6,WR\xe2\x88\x921,PR,WR and afterwards it looks like this: WL\xe2\x88\x921,PM+1,WM+1,\xe2\x80\xa6,WR\xe2\x88\x921,PR,WM,PL,WL,\xe2\x80\xa6,WM\xe2\x88\x921,PM,WR Such a move can be performed multiple times (possibly zero), and the goal is to achieve the minimum number of inversions in P. Johnny\'s younger sister Megan thinks that the rules are too complicated, so she wants to test her brother by choosing some pair of indices X and Y, and swapping PX and PY (X might be equal Y). After each sister\'s swap, Johnny wonders, what is the minimal number of inversions that he can achieve, starting with current P and making legal moves?You can assume that the input is generated randomly. P and W were chosen independently and equiprobably over all permutations; also, Megan\'s requests were chosen independently and equiprobably over all pairs of indices." 3300
1361E "James and the Chase" "dfs and similar,graphs,probabilities,trees" "James Bond has a new plan for catching his enemy. There are some cities and directed roads between them, such that it is possible to travel between any two cities using these roads. When the enemy appears in some city, Bond knows her next destination but has no idea which path she will choose to move there. The city a is called interesting, if for each city b, there is exactly one simple path from a to b. By a simple path, we understand a sequence of distinct cities, such that for every two neighboring cities, there exists a directed road from the first to the second city. Bond\'s enemy is the mistress of escapes, so only the chase started in an interesting city gives the possibility of catching her. James wants to arrange his people in such cities. However, if there are not enough interesting cities, the whole action doesn\'t make sense since Bond\'s people may wait too long for the enemy.You are responsible for finding all the interesting cities or saying that there is not enough of them. By not enough, James means strictly less than 20% of all cities." 3000
1361D "Johnny and James" greedy,implementation,math,trees "James Bond, Johnny\'s favorite secret agent, has a new mission. There are n enemy bases, each of them is described by its coordinates so that we can think about them as points in the Cartesian plane. The bases can communicate with each other, sending a signal, which is the ray directed from the chosen point to the origin or in the opposite direction. The exception is the central base, which lies at the origin and can send a signal in any direction. When some two bases want to communicate, there are two possible scenarios. If they lie on the same line with the origin, one of them can send a signal directly to the other one. Otherwise, the signal is sent from the first base to the central, and then the central sends it to the second base. We denote the distance between two bases as the total Euclidean distance that a signal sent between them has to travel.Bond can damage all but some k bases, which he can choose arbitrarily. A damaged base can\'t send or receive the direct signal but still can pass it between two working bases. In particular, James can damage the central base, and the signal can still be sent between any two undamaged bases as before, so the distance between them remains the same. What is the maximal sum of the distances between all pairs of remaining bases that 007 can achieve by damaging exactly n\xe2\x88\x92k of them?" 2900
1361C "Johnny and Megan\'s Necklace" "binary search,bitmasks,constructive algorithms,dfs and similar,dsu,graphs" "Johnny\'s younger sister Megan had a birthday recently. Her brother has bought her a box signed as ""Your beautiful necklace \xe2\x80\x94 do it yourself!"". It contains many necklace parts and some magic glue. The necklace part is a chain connecting two pearls. Color of each pearl can be defined by a non-negative integer. The magic glue allows Megan to merge two pearls (possibly from the same necklace part) into one. The beauty of a connection of pearls in colors uu and vv is defined as follows: let 2k2k be the greatest power of two dividing u\xe2\x8a\x95vu\xe2\x8a\x95v \xe2\x80\x94 exclusive or of uu and vv. Then the beauty equals kk. If u=vu=v, you may assume that beauty is equal to 2020.Each pearl can be combined with another at most once. Merging two parts of a necklace connects them. Using the glue multiple times, Megan can finally build the necklace, which is a cycle made from connected necklace parts (so every pearl in the necklace is combined with precisely one other pearl in it). The beauty of such a necklace is the minimum beauty of a single connection in it. The girl wants to use all available necklace parts to build exactly one necklace consisting of all of them with the largest possible beauty. Help her!" 2500
1361B "Johnny and Grandmaster" greedy,implementation,math,sortings "Johnny has just found the new, great tutorial: ""How to become a grandmaster?"". The tutorial tells many strange and unexpected for Johnny things, such as you have to be patient or that very important is solving many harder and harder problems. The boy has found an online judge with tasks divided by topics they cover. He has picked pki problems from i-th category (p is his favorite number). He wants to solve them in two weeks (the patience condition is too hard for Johnny, so for simplicity, he looks only at easy tasks, which can be solved in such a period). Now our future grandmaster has to decide which topics to cover first and which the second week. Help him assign topics in such a way, that workload is balanced.Formally, given n numbers pki, the boy wants to divide them into two disjoint sets, minimizing the absolute difference between sums of numbers in each set. Find the minimal absolute difference. Output the result modulo 109+7." 1900
1361A "Johnny and Contribution" "constructive algorithms,graphs,greedy,sortings" "Today Johnny wants to increase his contribution. His plan assumes writing n blogs. One blog covers one topic, but one topic can be covered by many blogs. Moreover, some blogs have references to each other. Each pair of blogs that are connected by a reference has to cover different topics because otherwise, the readers can notice that they are split just for more contribution. Set of blogs and bidirectional references between some pairs of them is called blogs network.There are n different topics, numbered from 1 to n sorted by Johnny\'s knowledge. The structure of the blogs network is already prepared. Now Johnny has to write the blogs in some order. He is lazy, so each time before writing a blog, he looks at it\'s already written neighbors (the blogs referenced to current one) and chooses the topic with the smallest number which is not covered by neighbors. It\'s easy to see that this strategy will always allow him to choose a topic because there are at most n\xe2\x88\x921 neighbors.For example, if already written neighbors of the current blog have topics number 1, 3, 1, 5, and 2, Johnny will choose the topic number 4 for the current blog, because topics number 1, 2 and 3 are already covered by neighbors and topic number 4 isn\'t covered.As a good friend, you have done some research and predicted the best topic for each blog. Can you tell Johnny, in which order he has to write the blogs, so that his strategy produces the topic assignment chosen by you?" 1700
1360H "Binary Median" "binary search,bitmasks,brute force,constructive algorithms" "Consider all binary strings of length m (1\xe2\x89\xa4m\xe2\x89\xa460). A binary string is a string that consists of the characters 0 and 1 only. For example, 0110 is a binary string, and 012aba is not. Obviously, there are exactly 2m such strings in total.The string s is lexicographically smaller than the string t (both have the same length m) if in the first position i from the left in which they differ, we have s[i]<t[i]. This is exactly the way strings are compared in dictionaries and in most modern programming languages when comparing them in a standard way. For example, the string 01011 is lexicographically smaller than the string 01100, because the first two characters are the same, and the third character in the first string is less than that in the second.We remove from this set n (1\xe2\x89\xa4n\xe2\x89\xa4min(2m\xe2\x88\x921,100)) distinct binary strings a1,a2,\xe2\x80\xa6,an, each of length m. Thus, the set will have k=2m\xe2\x88\x92n strings. Sort all strings of the resulting set in lexicographical ascending order (as in the dictionary).We number all the strings after sorting from 0 to k\xe2\x88\x921. Print the string whose index is \xe2\x8c\x8ak\xe2\x88\x9212\xe2\x8c\x8b (such an element is called median), where \xe2\x8c\x8ax\xe2\x8c\x8b is the rounding of the number down to the nearest integer.For example, if n=3, m=3 and a=[010, 111, 001], then after removing the strings ai and sorting, the result will take the form: [000, 011, 100, 101, 110]. Thus, the desired median is 100." 2100
1360G "A/B Matrix" "constructive algorithms,greedy,math" "You are given four positive integers n, m, a, b (1\xe2\x89\xa4b\xe2\x89\xa4n\xe2\x89\xa450; 1\xe2\x89\xa4a\xe2\x89\xa4m\xe2\x89\xa450). Find any such rectangular matrix of size n\xc3\x97m that satisfies all of the following conditions:  each row of the matrix contains exactly a ones;  each column of the matrix contains exactly b ones;  all other elements are zeros. If the desired matrix does not exist, indicate this.For example, for n=3, m=6, a=2, b=1, there exists a matrix satisfying the conditions above:|010001100100001010|" 1900
1360F Spy-string "bitmasks,brute force,constructive algorithms,dp,hashing,strings" "You are given n strings a1,a2,\xe2\x80\xa6,an: all of them have the same length m. The strings consist of lowercase English letters.Find any string s of length m such that each of the given n strings differs from s in at most one position. Formally, for each given string ai, there is no more than one position j such that ai[j]\xe2\x89\xa0s[j].Note that the desired string s may be equal to one of the given strings ai, or it may differ from all the given strings.For example, if you have the strings abac and zbab, then the answer to the problem might be the string abab, which differs from the first only by the last character, and from the second only by the first." 1700
1360E Polygon "dp,graphs,implementation,shortest paths" "Polygon is not only the best platform for developing problems but also a square matrix with side n, initially filled with the character 0.On the polygon, military training was held. The soldiers placed a cannon above each cell in the first row and a cannon to the left of each cell in the first column. Thus, exactly 2n cannons were placed.  Initial polygon for n=4. Cannons shoot character 1. At any moment of time, no more than one cannon is shooting. When a 1 flies out of a cannon, it flies forward (in the direction of the shot) until it collides with a polygon border or another 1. After that, it takes the cell in which it was before the collision and remains there. Take a look at the examples for better understanding.More formally:   if a cannon stands in the row i, to the left of the first column, and shoots with a 1, then the 1 starts its flight from the cell (i,1) and ends in some cell (i,j);  if a cannon stands in the column j, above the first row, and shoots with a 1, then the 1 starts its flight from the cell (1,j) and ends in some cell (i,j). For example, consider the following sequence of shots:   1. Shoot the cannon in the row 2.                         2. Shoot the cannon in the row 2.                         3. Shoot the cannon in column 3. You have a report from the military training on your desk. This report is a square matrix with side length n consisting of 0 and 1. You wonder if the training actually happened. In other words, is there a sequence of shots such that, after the training, you get the given matrix?Each cannon can make an arbitrary number of shots. Before the training, each cell of the polygon contains 0." 1300
1360D "Buying Shovels" "math,number theory" "Polycarp wants to buy exactly n shovels. The shop sells packages with shovels. The store has k types of packages: the package of the i-th type consists of exactly i shovels (1\xe2\x89\xa4i\xe2\x89\xa4k). The store has an infinite number of packages of each type.Polycarp wants to choose one type of packages and then buy several (one or more) packages of this type. What is the smallest number of packages Polycarp will have to buy to get exactly n shovels?For example, if n=8 and k=7, then Polycarp will buy 2 packages of 4 shovels.Help Polycarp find the minimum number of packages that he needs to buy, given that he:   will buy exactly n shovels in total;  the sizes of all packages he will buy are all the same and the number of shovels in each package is an integer from 1 to k, inclusive." 1300
1360C "Similar Pairs" "constructive algorithms,graph matchings,greedy,sortings" "We call two numbers x and y similar if they have the same parity (the same remainder when divided by 2), or if |x\xe2\x88\x92y|=1. For example, in each of the pairs (2,6), (4,3), (11,7), the numbers are similar to each other, and in the pairs (1,4), (3,12), they are not.You are given an array a of n (n is even) positive integers. Check if there is such a partition of the array into pairs that each element of the array belongs to exactly one pair and the numbers in each pair are similar to each other.For example, for the array a=[11,14,16,12], there is a partition into pairs (11,12) and (14,16). The numbers in the first pair are similar because they differ by one, and in the second pair because they are both even." 1100
1360B "Honest Coach" greedy,sortings "There are n athletes in front of you. Athletes are numbered from 1 to n from left to right. You know the strength of each athlete \xe2\x80\x94 the athlete number i has the strength si.You want to split all athletes into two teams. Each team must have at least one athlete, and each athlete must be exactly in one team.You want the strongest athlete from the first team to differ as little as possible from the weakest athlete from the second team. Formally, you want to split the athletes into two teams A and B so that the value |max(A)\xe2\x88\x92min(B)| is as small as possible, where max(A) is the maximum strength of an athlete from team A, and min(B) is the minimum strength of an athlete from team B.For example, if n=5 and the strength of the athletes is s=[3,1,2,6,4], then one of the possible split into teams is:   first team: A=[1,2,4],  second team: B=[3,6]. In this case, the value |max(A)\xe2\x88\x92min(B)| will be equal to |4\xe2\x88\x923|=1. This example illustrates one of the ways of optimal split into two teams.Print the minimum value |max(A)\xe2\x88\x92min(B)|." 800
1360A "Minimal Square" greedy,math "Find the minimum area of a square land on which you can place two identical rectangular a\xc3\x97b houses. The sides of the houses should be parallel to the sides of the desired square land.Formally,   You are given two identical rectangles with side lengths a and b (1\xe2\x89\xa4a,b\xe2\x89\xa4100) \xe2\x80\x94 positive integers (you are given just the sizes, but not their positions).  Find the square of the minimum area that contains both given rectangles. Rectangles can be rotated (both or just one), moved, but the sides of the rectangles should be parallel to the sides of the desired square. Two rectangles can touch each other (side or corner), but cannot intersect. Rectangles can also touch the sides of the square but must be completely inside it. You can rotate the rectangles. Take a look at the examples for a better understanding.  The picture shows a square that contains red and green rectangles." 800
1359F "RC Kaboom Show" "binary search,brute force,data structures,geometry,math" "You know, it\'s hard to conduct a show with lots of participants and spectators at the same place nowadays. Still, you are not giving up on your dream to make a car crash showcase! You decided to replace the real cars with remote controlled ones, call the event ""Remote Control Kaboom Show"" and stream everything online.For the preparation you arranged an arena \xe2\x80\x94 an infinite 2D-field. You also bought n remote controlled cars and set them up on the arena. Unfortunately, the cars you bought can only go forward without turning left, right or around. So you additionally put the cars in the direction you want them to go.To be formal, for each car i (1\xe2\x89\xa4i\xe2\x89\xa4n) you chose its initial position (xi,yi) and a direction vector (dxi,dyi). Moreover, each car has a constant speed si units per second. So after car i is launched, it stars moving from (xi,yi) in the direction (dxi,dyi) with constant speed si.The goal of the show is to create a car collision as fast as possible! You noted that launching every car at the beginning of the show often fails to produce any collisions at all. Thus, you plan to launch the i-th car at some moment ti. You haven\'t chosen ti, that\'s yet to be decided. Note that it\'s not necessary for ti to be integer and ti is allowed to be equal to tj for any i,j.The show starts at time 0. The show ends when two cars i and j (i\xe2\x89\xa0j) collide (i.\xe2\x80\x89e. come to the same coordinate at the same time). The duration of the show is the time between the start and the end.What\'s the fastest crash you can arrange by choosing all ti? If it\'s possible to arrange a crash then print the shortest possible duration of the show. Otherwise, report that it\'s impossible." 2900
1359E "Modular Stability" "combinatorics,math,number theory" "We define xmody as the remainder of division of x by y (% operator in C++ or Java, mod operator in Pascal).Let\'s call an array of positive integers [a1,a2,\xe2\x80\xa6,ak] stable if for every permutation p of integers from 1 to k, and for every non-negative integer x, the following condition is met: (((xmoda1)moda2)\xe2\x80\xa6modak\xe2\x88\x921)modak=(((xmodap1)modap2)\xe2\x80\xa6modapk\xe2\x88\x921)modapk That is, for each non-negative integer x, the value of (((xmoda1)moda2)\xe2\x80\xa6modak\xe2\x88\x921)modak does not change if we reorder the elements of the array a.For two given integers n and k, calculate the number of stable arrays [a1,a2,\xe2\x80\xa6,ak] such that 1\xe2\x89\xa4a1<a2<\xe2\x8b\xaf<ak\xe2\x89\xa4n." 2000
1359D "Yet Another Yet Another Task" "data structures,dp,implementation,two pointers" "Alice and Bob are playing yet another card game. This time the rules are the following. There are n cards lying in a row in front of them. The i-th card has value ai. First, Alice chooses a non-empty consecutive segment of cards [l;r] (l\xe2\x89\xa4r). After that Bob removes a single card j from that segment (l\xe2\x89\xa4j\xe2\x89\xa4r). The score of the game is the total value of the remaining cards on the segment (al+al+1+\xe2\x8b\xaf+aj\xe2\x88\x921+aj+1+\xe2\x8b\xaf+ar\xe2\x88\x921+ar). In particular, if Alice chooses a segment with just one element, then the score after Bob removes the only card is 0.Alice wants to make the score as big as possible. Bob takes such a card that the score is as small as possible.What segment should Alice choose so that the score is maximum possible? Output the maximum score." 2000
1359C "Mixing Water" "binary search,math" "There are two infinite sources of water:  hot water of temperature h;  cold water of temperature c (c<h). You perform the following procedure of alternating moves:  take one cup of the hot water and pour it into an infinitely deep barrel;  take one cup of the cold water and pour it into an infinitely deep barrel;  take one cup of the hot water \xe2\x80\xa6  and so on \xe2\x80\xa6 Note that you always start with the cup of hot water.The barrel is initially empty. You have to pour at least one cup into the barrel. The water temperature in the barrel is an average of the temperatures of the poured cups.You want to achieve a temperature as close as possible to t. So if the temperature in the barrel is tb, then the absolute difference of tb and t (|tb\xe2\x88\x92t|) should be as small as possible.How many cups should you pour into the barrel, so that the temperature in it is as close as possible to t? If there are multiple answers with the minimum absolute difference, then print the smallest of them." 1700
1359B "New Theatre Square" "brute force,dp,greedy,implementation,two pointers" "You might have remembered Theatre square from the problem 1A. Now it\'s finally getting repaved.The square still has a rectangular shape of n\xc3\x97m meters. However, the picture is about to get more complicated now. Let ai,j be the j-th square in the i-th row of the pavement.You are given the picture of the squares:  if ai,j= ""*"", then the j-th square in the i-th row should be black;  if ai,j= ""."", then the j-th square in the i-th row should be white. The black squares are paved already. You have to pave the white squares. There are two options for pavement tiles:  1\xc3\x971 tiles \xe2\x80\x94 each tile costs x burles and covers exactly 1 square;  1\xc3\x972 tiles \xe2\x80\x94 each tile costs y burles and covers exactly 2 adjacent squares of the same row. Note that you are not allowed to rotate these tiles or cut them into 1\xc3\x971 tiles. You should cover all the white squares, no two tiles should overlap and no black squares should be covered by tiles.What is the smallest total price of the tiles needed to cover all the white squares?" 1000
1359A "Berland Poker" "brute force,greedy,math" "The game of Berland poker is played with a deck of n cards, m of which are jokers. k players play this game (n is divisible by k).At the beginning of the game, each player takes nk cards from the deck (so each card is taken by exactly one player). The player who has the maximum number of jokers is the winner, and he gets the number of points equal to x\xe2\x88\x92y, where x is the number of jokers in the winner\'s hand, and y is the maximum number of jokers among all other players. If there are two or more players with maximum number of jokers, all of them are winners and they get 0 points.Here are some examples:  n=8, m=3, k=2. If one player gets 3 jokers and 1 plain card, and another player gets 0 jokers and 4 plain cards, then the first player is the winner and gets 3\xe2\x88\x920=3 points;  n=4, m=2, k=4. Two players get plain cards, and the other two players get jokers, so both of them are winners and get 0 points;  n=9, m=6, k=3. If the first player gets 3 jokers, the second player gets 1 joker and 2 plain cards, and the third player gets 2 jokers and 1 plain card, then the first player is the winner, and he gets 3\xe2\x88\x922=1 point;  n=42, m=0, k=7. Since there are no jokers, everyone gets 0 jokers, everyone is a winner, and everyone gets 0 points. Given n, m and k, calculate the maximum number of points a player can get for winning the game." 1000
1358F "Tasty Cookie" "binary search,constructive algorithms,greedy,implementation" "Oh, no!The coronavirus has caught you, and now you\'re sitting in a dark cellar, with tied legs (but not hands). You have a delicious cookie, a laptop in front of you, and your ideal development environment is open. The coronavirus convinces you to solve the following problem.You are given two arrays A and B of size n. You can do operations of two types with array A:   Reverse array A. That is the array [A1, A2, \xe2\x80\xa6, An] transformes into [An, An\xe2\x88\x921, \xe2\x80\xa6, A1].  Replace A with an array of its prefix sums. That is, the array [A1, A2, \xe2\x80\xa6, An] goes to [A1, (A1+A2), \xe2\x80\xa6, (A1+A2+\xe2\x80\xa6+An)]. You need to understand if you can get an array B from the array A. If it is possible, you will have to restore the order of these operations by minimizing the number of operations of the second type. Fortunately, the coronavirus is good today, so he has allowed you not to restore actions if the minimum number of second type operations is more than 2\xe2\x8b\x85105. But coronavirus resents you, so if you restore the answer, the total number of operations should not exceed 5\xe2\x8b\x85105.Solve this problem and get the cookie, or the coronavirus will extend the quarantine for five years and make the whole economy collapse!" 2700
1358E "Are You Fired?" "constructive algorithms,data structures,greedy,implementation" "Levian works as an accountant in a large company. Levian knows how much the company has earned in each of the n consecutive months \xe2\x80\x94 in the i-th month the company had income equal to ai (positive income means profit, negative income means loss, zero income means no change). Because of the general self-isolation, the first \xe2\x8c\x88n2\xe2\x8c\x89 months income might have been completely unstable, but then everything stabilized and for the last \xe2\x8c\x8an2\xe2\x8c\x8b months the income was the same.Levian decided to tell the directors n\xe2\x88\x92k+1 numbers \xe2\x80\x94 the total income of the company for each k consecutive months. In other words, for each i between 1 and n\xe2\x88\x92k+1 he will say the value ai+ai+1+\xe2\x80\xa6+ai+k\xe2\x88\x921. For example, if a=[\xe2\x88\x921,0,1,2,2] and k=3 he will say the numbers 0,3,5.Unfortunately, if at least one total income reported by Levian is not a profit (income \xe2\x89\xa40), the directors will get angry and fire the failed accountant.Save Levian\'s career: find any such k, that for each k months in a row the company had made a profit, or report that it is impossible." 2400
1358D "The Best Vacation" "binary search,brute force,greedy,implementation,two pointers" "You\'ve been in love with Coronavirus-chan for a long time, but you didn\'t know where she lived until now. And just now you found out that she lives in a faraway place called Naha. You immediately decided to take a vacation and visit Coronavirus-chan. Your vacation lasts exactly x days and that\'s the exact number of days you will spend visiting your friend. You will spend exactly x consecutive (successive) days visiting Coronavirus-chan.They use a very unusual calendar in Naha: there are n months in a year, i-th month lasts exactly di days. Days in the i-th month are numbered from 1 to di. There are no leap years in Naha.The mood of Coronavirus-chan (and, accordingly, her desire to hug you) depends on the number of the day in a month. In particular, you get j hugs if you visit Coronavirus-chan on the j-th day of the month.You know about this feature of your friend and want to plan your trip to get as many hugs as possible (and then maybe you can win the heart of Coronavirus-chan). Please note that your trip should not necessarily begin and end in the same year." 1900
1358C "Celex Update" math "During the quarantine, Sicromoft has more free time to create the new functions in ""Celex-2021"". The developers made a new function GAZ-GIZ, which infinitely fills an infinite table to the right and down from the upper left corner as follows:   The cell with coordinates (x,y) is at the intersection of x-th row and y-th column. Upper left cell (1,1) contains an integer 1.The developers of the SUM function don\'t sleep either. Because of the boredom, they teamed up with the developers of the RAND function, so they added the ability to calculate the sum on an arbitrary path from one cell to another, moving down or right. Formally, from the cell (x,y) in one step you can move to the cell (x+1,y) or (x,y+1). After another Dinwows update, Levian started to study ""Celex-2021"" (because he wants to be an accountant!). After filling in the table with the GAZ-GIZ function, he asked you to calculate the quantity of possible different amounts on the path from a given cell (x1,y1) to another given cell (x2,y2), if you can only move one cell down or right.Formally, consider all the paths from the cell (x1,y1) to cell (x2,y2) such that each next cell in the path is located either to the down or to the right of the previous one. Calculate the number of different sums of elements for all such paths." 1600
1358B "Maria Breaks the Self-isolation" greedy,sortings "Maria is the most active old lady in her house. She was tired of sitting at home. She decided to organize a ceremony against the coronavirus.She has n friends who are also grannies (Maria is not included in this number). The i-th granny is ready to attend the ceremony, provided that at the time of her appearance in the courtyard there will be at least ai other grannies there. Note that grannies can come into the courtyard at the same time. Formally, the granny i agrees to come if the number of other grannies who came earlier or at the same time with her is greater than or equal to ai.Grannies gather in the courtyard like that.  Initially, only Maria is in the courtyard (that is, the initial number of grannies in the courtyard is 1). All the remaining n grannies are still sitting at home. On each step Maria selects a subset of grannies, none of whom have yet to enter the courtyard. She promises each of them that at the time of her appearance there will be at least ai other grannies (including Maria) in the courtyard. Maria can call several grannies at once. In this case, the selected grannies will go out into the courtyard at the same moment of time. She cannot deceive grannies, that is, the situation when the i-th granny in the moment of appearing in the courtyard, finds that now there are strictly less than ai other grannies (except herself, but including Maria), is prohibited. Please note that if several grannies appeared in the yard at the same time, then each of them sees others at the time of appearance. Your task is to find what maximum number of grannies (including herself) Maria can collect in the courtyard for the ceremony. After all, the more people in one place during quarantine, the more effective the ceremony!Consider an example: if n=6 and a=[1,5,4,5,1,9], then:  at the first step Maria can call grannies with numbers 1 and 5, each of them will see two grannies at the moment of going out into the yard (note that a1=1\xe2\x89\xa42 and a5=1\xe2\x89\xa42);  at the second step, Maria can call grannies with numbers 2, 3 and 4, each of them will see five grannies at the moment of going out into the yard (note that a2=5\xe2\x89\xa45, a3=4\xe2\x89\xa45 and a4=5\xe2\x89\xa45);  the 6-th granny cannot be called into the yard  \xe2\x80\x94 therefore, the answer is 6 (Maria herself and another 5 grannies)." 1000
1358A "Park Lighting" greedy,math "Due to the coronavirus pandemic, city authorities obligated citizens to keep a social distance. The mayor of the city Semyon wants to light up Gluharniki park so that people could see each other even at night to keep the social distance.The park is a rectangular table with n rows and m columns, where the cells of the table are squares, and the boundaries between the cells are streets. External borders are also streets. Every street has length 1. For example, park with n=m=2 has 12 streets.You were assigned to develop a plan for lighting the park. You can put lanterns in the middle of the streets. The lamp lights two squares near it (or only one square if it stands on the border of the park).  The park sizes are: n=4, m=5. The lighted squares are marked yellow. Please note that all streets have length 1. Lanterns are placed in the middle of the streets. In the picture not all the squares are lit. Semyon wants to spend the least possible amount of money on lighting but also wants people throughout the park to keep a social distance. So he asks you to find the minimum number of lanterns that are required to light all the squares." 800
1357E2 "Root of quantum Fourier transform" NA "Implement an operation that is equivalent to the operation QFT1/P, where QFT is the quantum Fourier transform. In other words, your operation, applied P times, should have the same effect as applying QFT. You can implement the required transformation up to a global phase.Your operation should take the following inputs:  an integer P (2\xe2\x89\xa4P\xe2\x89\xa48).  a register of type LittleEndian - a wrapper type for an array of qubits that encodes an unsigned integer in little-endian format, with the least significant bit written first (corresponding to the array element with index 0). (If you need to, you can convert it to an array type using unwrap operator: let qubitArray = inputRegister!;.) The register will contain at most 7 qubits. The ""output"" of your solution is the state in which it left the input qubits.Your code should have the following signature (note that your operation should have Adjoint and Controlled variants defined for it; is Adj+Ctl in the operation signature will generate them automatically based on your code):namespace Solution {    open Microsoft.Quantum.Arithmetic;    open Microsoft.Quantum.Intrinsic;    operation Solve (p : Int, inputRegister : LittleEndian) : Unit is Adj+Ctl {        // your code here    }}You can learn more about QFT in this kata. You are allowed to take advantage of library operations, including QFTLE." -999
1357E1 "Power of quantum Fourier transform" NA "Implement an operation that is equivalent to the operation QFTP, where QFT is the quantum Fourier transform.Your operation should take the following inputs:  an integer P (2\xe2\x89\xa4P\xe2\x89\xa42.1\xe2\x8b\x85106).  a register of type LittleEndian - a wrapper type for an array of qubits that encodes an unsigned integer in little-endian format, with the least significant bit written first (corresponding to the array element with index 0). (If you need to, you can convert it to an array type using unwrap operator: let qubitArray = inputRegister!;) The ""output"" of your solution is the state in which it left the input qubits.Your code should have the following signature (note that your operation should have Adjoint and Controlled variants defined for it; is Adj+Ctl in the operation signature will generate them automatically based on your code):namespace Solution {    open Microsoft.Quantum.Arithmetic;    open Microsoft.Quantum.Intrinsic;    operation Solve (p : Int, inputRegister : LittleEndian) : Unit is Adj+Ctl {        // your code here    }}You can learn more about QFT in this kata. You are allowed to take advantage of library operations, including QFTLE which implements the necessary transform in the first power." -999
1357D5 "Quantum Classification - Dataset 7" NA "This problem is identical to the problem D1 in every aspect except the training dataset. Please refer to that problem for the full problem statement." -999
1357D4 "Quantum Classification - Dataset 6" NA "This problem is identical to the problem D1 in every aspect except the training dataset. Please refer to that problem for the full problem statement." -999
1357D3 "Quantum Classification - Dataset 5" NA "This problem is identical to the problem D1 in every aspect except the training dataset. Please refer to that problem for the full problem statement." -999
1357D2 "Quantum Classification - Dataset 4" NA "This problem is identical to the problem D1 in every aspect except the training dataset. Please refer to that problem for the full problem statement." -999
1357D1 "Quantum Classification - Dataset 3" NA "You are given a training dataset, in which each entry is a features vector (an array of 2 real numbers) and a label 0 or 1 indicating the class to which this vector belongs.Your goal is to use this dataset to train a quantum classification model that will accurately classify a validation dataset - a different dataset generated using the same data distribution as the training one. The error rate of classifying the validation dataset using your model (the percentage of incorrectly classified samples) should be less than 5%.  The quantum classification library that will use your model to classify the data is documented here.  This tutorial has an end-to-end example of training a model using this library as a Python notebook.  The warmup round editorial discusses solving easier problems features in the warmup round.  You can find the exact implementation of the testing harness for the D problems of this round, including the preprocessing methods, here.  You can find examples of training a model and using it for classification here." -999
1357C2 "Prepare superposition of basis states with the same parity" NA "You are given N qubits in the state |0...0\xe2\x9f\xa9, and an integer parity\xe2\x88\x88{0,1}. Your task is to prepare an equal superposition of all basis states that have the given parity of the number of 1s in their binary notation, i.e., the basis states that have an even number of 1s if parity=0 or the basis states that have an odd number of 1s if parity=1.For example, for N=2 the required state would be   1\xe2\x88\x9a2(|00\xe2\x9f\xa9+|11\xe2\x9f\xa9) if parity=0.  1\xe2\x88\x9a2(|01\xe2\x9f\xa9+|10\xe2\x9f\xa9) if parity=1. You are not allowed to use any gates except the Pauli gates (X, Y and Z), the Hadamard gate and the controlled versions of those (you are allowed to use multiple qubits as controls in the controlled versions of gates). However, you are allowed to use measurements.You have to implement an operation which takes an array of N qubits and an integer as an input and has no output. The ""output"" of your solution is the state in which it left the input qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (qs : Qubit[], parity : Int) : Unit {        // your code here    }}" -999
1357C1 "Prepare superposition of basis states with 0s" NA "You are given N qubits in the state |0...0\xe2\x9f\xa9. Your task is to prepare an equal superposition of all basis states that have one or more 0 in them.For example, for N=2 the required state would be 1\xe2\x88\x9a3(|00\xe2\x9f\xa9+|01\xe2\x9f\xa9+|10\xe2\x9f\xa9).You are not allowed to use any gates except the Pauli gates (X, Y and Z), the Hadamard gate and the controlled versions of those (you are allowed to use multiple qubits as controls in the controlled versions of gates). However, you are allowed to use measurements.You have to implement an operation which takes an array of N qubits as an input and has no output. The ""output"" of your solution is the state in which it left the input qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}" -999
1357B2 """Is the number divisible by 3?"" oracle" NA "Implement a quantum oracle on N qubits which checks whether the input bit string is a little-endian notation of a number that is divisible by 3. Your operation should take the following inputs:  an array of N\xe2\x89\xa48 qubits ""inputs"" in an arbitrary state.  a qubit ""output"" in an arbitrary state. Your operation should perform a unitary transformation on those qubits that can be described by its effect on the basis states: if ""inputs"" is in the basis state |x\xe2\x9f\xa9 and ""output"" is in the basis state |y\xe2\x9f\xa9, the result of applying the operation should be |x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9, where f(x)=1 if the integer represented by the bit string x is divisible by 3, and 0 otherwise.For example, if the qubits passed to your operation are in the state 1\xe2\x88\x9a2(|110\xe2\x9f\xa9+|001\xe2\x9f\xa9)x\xe2\x8a\x97|0\xe2\x9f\xa9y=1\xe2\x88\x9a2(|3\xe2\x9f\xa9+|4\xe2\x9f\xa9)x\xe2\x8a\x97|0\xe2\x9f\xa9y, the state of the system after applying the operation should be 1\xe2\x88\x9a2(|3\xe2\x9f\xa9x\xe2\x8a\x97|1\xe2\x9f\xa9y+|4\xe2\x9f\xa9x|0\xe2\x9f\xa9y)=1\xe2\x88\x9a2(|110\xe2\x9f\xa9x\xe2\x8a\x97|1\xe2\x9f\xa9y+|001\xe2\x9f\xa9x|0\xe2\x9f\xa9y).Your code should have the following signature (note that your operation should have Adjoint and Controlled variants defined for it; is Adj+Ctl in the operation signature will generate them automatically based on your code):namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (inputs : Qubit[], output : Qubit) : Unit is Adj+Ctl {        // your code here    }}Your code is not allowed to use measurements or arbitrary rotation gates. This operation can be implemented using just the X gate and its controlled variants (possibly with multiple qubits as controls)." -999
1357B1 """Is the bit string balanced?"" oracle" NA "Implement a quantum oracle on N qubits which checks whether the input bit string is balanced, i.e., whether it has exactly N2 zeros and N2 ones in it. Your operation should take the following inputs:  an array of N\xe2\x89\xa410 qubits ""inputs"" in an arbitrary state. N will be an even number.  a qubit ""output"" in an arbitrary state. Your operation should perform a unitary transformation on those qubits that can be described by its effect on the basis states: if ""inputs"" is in the basis state |x\xe2\x9f\xa9 and ""output"" is in the basis state |y\xe2\x9f\xa9, the result of applying the operation should be |x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9, where f(x)=1 if the bit string x has the same number of zeros and ones in it, and 0 otherwise.For example, if the qubits passed to your operation are in the state 1\xe2\x88\x9a2(|01\xe2\x9f\xa9+|00\xe2\x9f\xa9)x\xe2\x8a\x97|0\xe2\x9f\xa9y, the state of the system after applying the operation should be 1\xe2\x88\x9a2(|01\xe2\x9f\xa9x\xe2\x8a\x97|1\xe2\x9f\xa9y+|00\xe2\x9f\xa9x|0\xe2\x9f\xa9y).Your code should have the following signature (note that your operation should have Adjoint and Controlled variants defined for it; is Adj+Ctl in the operation signature will generate them automatically based on your code):namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (inputs : Qubit[], output : Qubit) : Unit is Adj+Ctl {        // your code here    }}Your code is not allowed to use measurements or arbitrary rotation gates. This operation can be implemented using just the X gate and its controlled variants (possibly with multiple qubits as controls)." -999
1357A7 "Distinguish Y, XZ, -Y and -XZ" NA "You are given an operation that implements a single-qubit unitary transformation: either the Y gate (possibly with an extra global phase of \xe2\x88\x921) or the sequence of Pauli Z and Pauli X gates (the Z gate applied first and the X gate applied second; possibly with an extra global phase of \xe2\x88\x921). The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return  0 if it was the Y gate,  1 if it was the \xe2\x88\x92XZ gate,  2 if it was the \xe2\x88\x92Y gate,  3 if it was the XZ gate. You are allowed to apply the given operation and its adjoint/controlled variants at most three times.You have to implement an operation which takes a single-qubit operation as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit => Unit is Adj+Ctl)) : Int {        // your code here    }}" -999
1357A6 "Distinguish four Pauli gates" NA "You are given an operation that implements a single-qubit unitary transformation: either the identity (I gate) or one of the Pauli gates (X, Y or Z gate). The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return  0 if it was the I gate,  1 if it was the X gate,  2 if it was the Y gate,  3 if it was the Z gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly once.You have to implement an operation which takes a single-qubit operation as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit => Unit is Adj+Ctl)) : Int {        // your code here    }}" -999
1357A5 "Distinguish Rz(\xce\xb8) from Ry(\xce\xb8)" NA "You are given an angle \xce\xb8 (in radians, 0.01\xcf\x80\xe2\x89\xa4\xce\xb8\xe2\x89\xa40.99\xcf\x80) and an operation that implements a single-qubit unitary transformation: either the Rz(\xce\xb8) gate or the Ry(\xce\xb8) gate. The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the Rz(\xce\xb8) gate or 1 if it was the Ry(\xce\xb8) gate. You are allowed to apply the given operation and its adjoint/controlled variants as many times as you need (within the time limit).You have to implement an operation which takes a floating-point number and a single-qubit operation as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (theta : Double, unitary : (Qubit => Unit is Adj+Ctl)) : Int {        // your code here    }}" -999
1357A4 "Distinguish Rz from R1" NA "You are given an operation that implements a single-qubit unitary transformation: either the Rz gate or the R1 gate. The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the Rz gate or 1 if it was the R1 gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly once (you can pass to it any rotation angle that you choose).You have to implement an operation which takes a single-qubit operation unitary as an input and returns an integer. The operation unitary will accept two parameters (similarly to Rz and R1 intrinsic gates): the first parameter is the rotation angle and the second parameter is the qubit to which the rotation is applied. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : ((Double, Qubit) => Unit is Adj+Ctl)) : Int {        // your code here    }}" -999
1357A3 "Distinguish H from X" NA "You are given an operation that implements a single-qubit unitary transformation: either the H gate or the X gate. The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the H gate or 1 if it was the X gate. You are allowed to apply the given operation and its adjoint/controlled variants at most twice.You have to implement an operation which takes a single-qubit operation as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit => Unit is Adj+Ctl)) : Int {        // your code here    }}" -999
1357A2 "Distinguish I, CNOTs and SWAP" NA "You are given an operation that implements a two-qubit unitary transformation: either the identity (I \xe2\x8a\x97 I gate), the CNOT gate (either with the first qubit as control and the second qubit as target or vice versa) or the SWAP gate. The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return   0 if it was the I \xe2\x8a\x97 I gate,  1 if it was the CNOT12 gate,  2 if it was the CNOT21 gate,  3 if it was the SWAP gate. You are allowed to apply the given operation and its adjoint/controlled variants at most twice.You have to implement an operation which takes a two-qubit operation unitary as an input and returns an integer. The operation unitary will accept an array of qubits as input, but it will fail if the array is empty or has one or more than two qubits. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit[] => Unit is Adj+Ctl)) : Int {        // your code here    }}" -999
1357A1 "Figure out direction of CNOT" NA "You are given an operation that implements a two-qubit unitary transformation: either the CNOT gate with the first qubit as control and the second qubit as target (CNOT12), or the CNOT gate with the second qubit as control and the first qubit as target (CNOT21). The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the CNOT12 gate or 1 if it was the CNOT21 gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly once.You have to implement an operation which takes a two-qubit operation unitary as an input and returns an integer. The operation unitary will accept an array of qubits as input, but it will fail if the array is empty or has one or more than two qubits. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit[] => Unit is Adj+Ctl)) : Int {        // your code here    }}" -999
1356D2 "Quantum Classification - 2" "*special problem" "This problem statement is exactly the same as in the problem ""Quantum Classification - 1""; the only difference is the training dataset used (and the model you need to train on it).You are given a training dataset, in which each entry is a features vector (an array of 2 real numbers) and a label 0 or 1 indicating the class to which this vector belongs.Your goal is to use this dataset to train a quantum classification model that will accurately classify a validation dataset - a different dataset generated using the same data distribution as the training one. The error rate of classifying the validation dataset using your model (the percentage of incorrectly classified samples) should be less than 5   The quantum classification library that will use your model to classify the data is documented here.  This tutorial has an end-to-end example of training a model using this library as a Python notebook.  You can find examples of training a model and using it for classification here." -999
1356D1 "Quantum Classification - 1" "*special problem" "You are given a training dataset, in which each entry is a features vector (an array of 2 real numbers) and a label 0 or 1 indicating the class to which this vector belongs.Your goal is to use this dataset to train a quantum classification model that will accurately classify a validation dataset - a different dataset generated using the same data distribution as the training one. The error rate of classifying the validation dataset using your model (the percentage of incorrectly classified samples) should be less than 5   The quantum classification library that will use your model to classify the data is documented here.  This tutorial has an end-to-end example of training a model using this library as a Python notebook.  You can find examples of training a model and using it for classification here." -999
1356C "Prepare state |01\xe2\x9f\xa9 + |10\xe2\x9f\xa9 + |11\xe2\x9f\xa9" "*special problem" "You are given two qubits in state |00\xe2\x9f\xa9. Your task is to prepare the following state on them:1\xe2\x88\x9a3(|01\xe2\x9f\xa9+|10\xe2\x9f\xa9+|11\xe2\x9f\xa9)This task is very similar to problem A1 of the Winter 2019 contest, but this time you are not allowed to use any gates except the Pauli gates (X, Y and Z), the Hadamard gate and the controlled versions of those. However, you are allowed to use measurements.You have to implement an operation which takes an array of 2 qubits as an input and has no output. The ""output"" of your solution is the state in which it left the input qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}" -999
1356B2 Decrement "*special problem" "Implement a unitary operation on a register of N qubits that decrements the number written in the register modulo 2N.Your operation should take a register of type LittleEndian - an array of qubits that encodes an unsigned integer in little-endian format, with the least significant bit written first (corresponding to the array element with index 0). The ""output"" of your solution is the state in which it left the input qubits.For example, if the qubits passed to your operation are in the state 1\xe2\x88\x9a2(|00\xe2\x9f\xa9+|01\xe2\x9f\xa9)=1\xe2\x88\x9a2(|0\xe2\x9f\xa9+|2\xe2\x9f\xa9), they should be transformed to the state 1\xe2\x88\x9a2(|(0\xe2\x88\x921)mod22\xe2\x9f\xa9+|(2\xe2\x88\x921)mod22\xe2\x9f\xa9)=1\xe2\x88\x9a2(|3\xe2\x9f\xa9+|1\xe2\x9f\xa9)=1\xe2\x88\x9a2(|11\xe2\x9f\xa9+|10\xe2\x9f\xa9).Your code should have the following signature (note that your operation should have Adjoint and Controlled variants defined for it; is Adj+Ctl in the operation signature will generate them automatically based on your code):namespace Solution {    open Microsoft.Quantum.Arithmetic;    open Microsoft.Quantum.Intrinsic;    operation Solve (register : LittleEndian) : Unit is Adj+Ctl {        // your code here    }}Your code is not allowed to use measurements or arbitrary rotation gates (so, for example, using the library operation IncrementByInteger will cause runtime error). This operation can be implemented using just the X gate and its controlled variants." -999
1356B1 Increment "*special problem" "Implement a unitary operation on a register of N qubits that increments the number written in the register modulo 2N.Your operation should take a register of type LittleEndian - an array of qubits that encodes an unsigned integer in little-endian format, with the least significant bit written first (corresponding to the array element with index 0). The ""output"" of your solution is the state in which it left the input qubits.For example, if the qubits passed to your operation are in the state 1\xe2\x88\x9a2(|11\xe2\x9f\xa9+|10\xe2\x9f\xa9)=1\xe2\x88\x9a2(|3\xe2\x9f\xa9+|1\xe2\x9f\xa9), they should be transformed to the state 1\xe2\x88\x9a2(|(3+1)mod22\xe2\x9f\xa9+|(1+1)mod22\xe2\x9f\xa9)=1\xe2\x88\x9a2(|0\xe2\x9f\xa9+|2\xe2\x9f\xa9)=1\xe2\x88\x9a2(|00\xe2\x9f\xa9+|01\xe2\x9f\xa9).Your code should have the following signature (note that your operation should have Adjoint and Controlled variants defined for it; is Adj+Ctl in the operation signature will generate them automatically based on your code):namespace Solution {    open Microsoft.Quantum.Arithmetic;    open Microsoft.Quantum.Intrinsic;    operation Solve (register : LittleEndian) : Unit is Adj+Ctl {        // your code here    }}Your code is not allowed to use measurements or arbitrary rotation gates (so, for example, using the library operation IncrementByInteger will cause runtime error). This operation can be implemented using just the X gate and its controlled variants." -999
1356A5 "Distinguish Z from -Z" "*special problem" "You are given an operation that implements a single-qubit unitary transformation: either the Z gate or the -Z gate (i.e., the \xe2\x88\x92|0\xe2\x9f\xa9\xe2\x9f\xa80|+|1\xe2\x9f\xa9\xe2\x9f\xa81| gate: (\xe2\x88\x92Z)(\xce\xb1|0\xe2\x9f\xa9+\xce\xb2|1\xe2\x9f\xa9)=\xe2\x88\x92\xce\xb1|0\xe2\x9f\xa9+\xce\xb2|1\xe2\x9f\xa9). The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the Z gate or 1 if it was the -Z gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly once.You have to implement an operation which takes a single-qubit operation as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit => Unit is Adj+Ctl)) : Int {        // your code here    }}" -999
1356A4 "Distinguish I \xe2\x8a\x97 X from CNOT" "*special problem" "You are given an operation that implements a two-qubit unitary transformation: either I\xe2\x8a\x97X (the X gate applied to the second qubit and no effect on the first qubit) or the CNOT gate with the first qubit as control and the second qubit as target. The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was I\xe2\x8a\x97X or 1 if it was the CNOT gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly once.You have to implement an operation which takes a two-qubit operation unitary as an input and returns an integer. The operation unitary will accept an array of qubits as input, but it will fail if the array is empty or has one or more than two qubits. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit[] => Unit is Adj+Ctl)) : Int {        // your code here    }}" -999
1356A3 "Distinguish Z from S" "*special problem" "You are given an operation that implements a single-qubit unitary transformation: either the Z gate or the S gate. The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the Z gate or 1 if it was the S gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly twice.You have to implement an operation which takes a single-qubit operation as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit => Unit is Adj+Ctl)) : Int {        // your code here    }}" -999
1356A2 "Distinguish I from Z" "*special problem" "You are given an operation that implements a single-qubit unitary transformation: either the identity (I gate) or the Z gate. The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the I gate or 1 if it was the Z gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly once.You have to implement an operation which takes a single-qubit operation as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit => Unit is Adj+Ctl)) : Int {        // your code here    }}" -999
1356A1 "Distinguish I from X" "*special problem" "You are given an operation that implements a single-qubit unitary transformation: either the identity (I gate) or the X gate. The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the I gate or 1 if it was the X gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly once.You have to implement an operation which takes a single-qubit operation as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit => Unit is Adj+Ctl)) : Int {        // your code here    }}" -999
1355F "Guess Divisors Count" "constructive algorithms,interactive,number theory" "This is an interactive problem.We have hidden an integer 1\xe2\x89\xa4X\xe2\x89\xa4109. You don\'t have to guess this number. You have to find the number of divisors of this number, and you don\'t even have to find the exact number: your answer will be considered correct if its absolute error is not greater than 7 or its relative error is not greater than 0.5. More formally, let your answer be ans and the number of divisors of X be d, then your answer will be considered correct if at least one of the two following conditions is true: |ans\xe2\x88\x92d|\xe2\x89\xa47; 12\xe2\x89\xa4ansd\xe2\x89\xa42.You can make at most 22 queries. One query consists of one integer 1\xe2\x89\xa4Q\xe2\x89\xa41018. In response, you will get gcd(X,Q) \xe2\x80\x94 the greatest common divisor of X and Q.The number X is fixed before all queries. In other words, interactor is not adaptive.Let\'s call the process of guessing the number of divisors of number X a game. In one test you will have to play T independent games, that is, guess the number of divisors T times for T independent values of X." 2600
1355E "Restorer Distance" "binary search,greedy,math,sortings,ternary search" "You have to restore the wall. The wall consists of N pillars of bricks, the height of the i-th pillar is initially equal to hi, the height is measured in number of bricks. After the restoration all the N pillars should have equal heights.You are allowed the following operations: put a brick on top of one pillar, the cost of this operation is A; remove a brick from the top of one non-empty pillar, the cost of this operation is R; move a brick from the top of one non-empty pillar to the top of another pillar, the cost of this operation is M.You cannot create additional pillars or ignore some of pre-existing pillars even if their height becomes 0.What is the minimal total cost of restoration, in other words, what is the minimal total cost to make all the pillars of equal height?" 2100
1355D "Game With Array" "constructive algorithms,math" "Petya and Vasya are competing with each other in a new interesting game as they always do.At the beginning of the game Petya has to come up with an array of N positive integers. Sum of all elements in his array should be equal to S. Then Petya has to select an integer K such that 0\xe2\x89\xa4K\xe2\x89\xa4S.In order to win, Vasya has to find a non-empty subarray in Petya\'s array such that the sum of all selected elements equals to either K or S\xe2\x88\x92K. Otherwise Vasya loses.You are given integers N and S. You should determine if Petya can win, considering Vasya plays optimally. If Petya can win, help him to do that." 1400
1355C "Count Triangles" "binary search,implementation,math,two pointers" "Like any unknown mathematician, Yuri has favourite numbers: A, B, C, and D, where A\xe2\x89\xa4B\xe2\x89\xa4C\xe2\x89\xa4D. Yuri also likes triangles and once he thought: how many non-degenerate triangles with integer sides x, y, and z exist, such that A\xe2\x89\xa4x\xe2\x89\xa4B\xe2\x89\xa4y\xe2\x89\xa4C\xe2\x89\xa4z\xe2\x89\xa4D holds?Yuri is preparing problems for a new contest now, so he is very busy. That\'s why he asked you to calculate the number of triangles with described property.The triangle is called non-degenerate if and only if its vertices are not collinear." 1800
1355B "Young Explorers" dp,greedy,sortings "Young wilderness explorers set off to their first expedition led by senior explorer Russell. Explorers went into a forest, set up a camp and decided to split into groups to explore as much interesting locations as possible. Russell was trying to form groups, but ran into some difficulties...Most of the young explorers are inexperienced, and sending them alone would be a mistake. Even Russell himself became senior explorer not long ago. Each of young explorers has a positive integer parameter ei \xe2\x80\x94 his inexperience. Russell decided that an explorer with inexperience e can only join the group of e or more people.Now Russell needs to figure out how many groups he can organize. It\'s not necessary to include every explorer in one of the groups: some can stay in the camp. Russell is worried about this expedition, so he asked you to help him." 1200
1355A "Sequence with Digits" "brute force,implementation,math" "Let\'s define the following recurrence: an+1=an+minDigit(an)\xe2\x8b\x85maxDigit(an).Here minDigit(x) and maxDigit(x) are the minimal and maximal digits in the decimal representation of x without leading zeroes. For examples refer to notes.Your task is calculate aK for given a1 and K." 1200
1354G "Find a Gift" "binary search,interactive,probabilities" "This is an interactive problem. Don\'t forget to flush output after printing queries using cout.flush() or fflush(stdout) in C++ or similar functions in other programming languages.There are n gift boxes in a row, numbered from 1 to n from left to right. It\'s known that exactly k of them contain valuable gifts \xe2\x80\x94 other boxes contain just lucky stones. All boxes look the same and differ only in weight. All boxes with stones have the same weight and are strictly heavier than boxes with valuable items. But valuable gifts may be different, so the boxes with valuable items may have different weights.You can ask no more than 50 queries (printing an answer doesn\'t count). By each query you can compare total weights of two non-intersecting subsets of boxes a1,a2,\xe2\x80\xa6,aka and b1,b2,\xe2\x80\xa6,bkb. In return you\'ll get one of four results:  FIRST, if subset a1,a2,\xe2\x80\xa6,aka is strictly heavier;  SECOND, if subset b1,b2,\xe2\x80\xa6,bkb is strictly heavier;  EQUAL, if subsets have equal total weights;  WASTED, if the query is incorrect or the limit of queries is exceeded. Using such queries (or, maybe, intuition) find the box with a valuable gift with the minimum index." 2600
1354F "Summoning Minions" "constructive algorithms,dp,flows,graph matchings,greedy,sortings" "Polycarp plays a computer game. In this game, the players summon armies of magical minions, which then fight each other.Polycarp can summon n different minions. The initial power level of the i-th minion is ai, and when it is summoned, all previously summoned minions\' power levels are increased by bi. The minions can be summoned in any order.Unfortunately, Polycarp cannot have more than k minions under his control. To get rid of unwanted minions after summoning them, he may destroy them. Each minion can be summoned (and destroyed) only once.Polycarp\'s goal is to summon the strongest possible army. Formally, he wants to maximize the sum of power levels of all minions under his control (those which are summoned and not destroyed).Help Polycarp to make up a plan of actions to summon the strongest possible army!" 2500
1354E "Graph Coloring" "dfs and similar,dp,graphs" "You are given an undirected graph without self-loops or multiple edges which consists of n vertices and m edges. Also you are given three integers n1, n2 and n3.Can you label each vertex with one of three numbers 1, 2 or 3 in such way, that:   Each vertex should be labeled by exactly one number 1, 2 or 3;  The total number of vertices with label 1 should be equal to n1;  The total number of vertices with label 2 should be equal to n2;  The total number of vertices with label 3 should be equal to n3;  |colu\xe2\x88\x92colv|=1 for each edge (u,v), where colx is the label of vertex x. If there are multiple valid labelings, print any of them." 2100
1354D Multiset "binary search,data structures" "Note that the memory limit is unusual.You are given a multiset consisting of n integers. You have to process queries of two types:  add integer k into the multiset;  find the k-th order statistics in the multiset and remove it. k-th order statistics in the multiset is the k-th element in the sorted list of all elements of the multiset. For example, if the multiset contains elements 1, 4, 2, 1, 4, 5, 7, and k=3, then you have to find the 3-rd element in [1,1,2,4,4,5,7], which is 2. If you try to delete an element which occurs multiple times in the multiset, only one occurence is removed. After processing all queries, print any number belonging to the multiset, or say that it is empty." 1900
1354C2 "Not So Simple Polygon Embedding" "binary search,brute force,geometry,math" "The statement of this problem is the same as the statement of problem C1. The only difference is that, in problem C1, n is always even, and in C2, n is always odd.You are given a regular polygon with 2\xe2\x8b\x85n vertices (it\'s convex and has equal sides and equal angles) and all its sides have length 1. Let\'s name it as 2n-gon.Your task is to find the square of the minimum size such that you can embed 2n-gon in the square. Embedding 2n-gon in the square means that you need to place 2n-gon in the square in such way that each point which lies inside or on a border of 2n-gon should also lie inside or on a border of the square.You can rotate 2n-gon and/or the square." 2000
1354C1 "Simple Polygon Embedding" "binary search,geometry,math,ternary search" "The statement of this problem is the same as the statement of problem C2. The only difference is that, in problem C1, n is always even, and in C2, n is always odd.You are given a regular polygon with 2\xe2\x8b\x85n vertices (it\'s convex and has equal sides and equal angles) and all its sides have length 1. Let\'s name it as 2n-gon.Your task is to find the square of the minimum size such that you can embed 2n-gon in the square. Embedding 2n-gon in the square means that you need to place 2n-gon in the square in such way that each point which lies inside or on a border of 2n-gon should also lie inside or on a border of the square.You can rotate 2n-gon and/or the square." 1400
1354B "Ternary String" "binary search,dp,implementation,two pointers" "You are given a string s such that each its character is either 1, 2, or 3. You have to choose the shortest contiguous substring of s such that it contains each of these three characters at least once.A contiguous substring of string s is a string that can be obtained from s by removing some (possibly zero) characters from the beginning of s and some (possibly zero) characters from the end of s." 1200
1354A "Alarm Clock" math "Polycarp has spent the entire day preparing problems for you. Now he has to sleep for at least a minutes to feel refreshed.Polycarp can only wake up by hearing the sound of his alarm. So he has just fallen asleep and his first alarm goes off in b minutes.Every time Polycarp wakes up, he decides if he wants to sleep for some more time or not. If he\'s slept for less than a minutes in total, then he sets his alarm to go off in c minutes after it is reset and spends d minutes to fall asleep again. Otherwise, he gets out of his bed and proceeds with the day.If the alarm goes off while Polycarp is falling asleep, then he resets his alarm to go off in another c minutes and tries to fall asleep for d minutes again.You just want to find out when will Polycarp get out of his bed or report that it will never happen.Please check out the notes for some explanations of the example." 900
1353F "Decreasing Heights" "brute force,dp" "You are playing one famous sandbox game with the three-dimensional world. The map of the world can be represented as a matrix of size n\xc3\x97m, where the height of the cell (i,j) is ai,j.You are in the cell (1,1) right now and want to get in the cell (n,m). You can move only down (from the cell (i,j) to the cell (i+1,j)) or right (from the cell (i,j) to the cell (i,j+1)). There is an additional restriction: if the height of the current cell is x then you can move only to the cell with height x+1.Before the first move you can perform several operations. During one operation, you can decrease the height of any cell by one. I.e. you choose some cell (i,j) and assign (set) ai,j:=ai,j\xe2\x88\x921. Note that you can make heights less than or equal to zero. Also note that you can decrease the height of the cell (1,1).Your task is to find the minimum number of operations you have to perform to obtain at least one suitable path from the cell (1,1) to the cell (n,m). It is guaranteed that the answer exists.You have to answer t independent test cases." 2200
1353E "K-periodic Garland" "brute force,dp,greedy" "You are given a garland consisting of n lamps. States of the lamps are represented by the string s of length n. The i-th character of the string si equals \'0\' if the i-th lamp is turned off or \'1\' if the i-th lamp is turned on. You are also given a positive integer k.In one move, you can choose one lamp and change its state (i.e. turn it on if it is turned off and vice versa).The garland is called k-periodic if the distance between each pair of adjacent turned on lamps is exactly k. Consider the case k=3. Then garlands ""00010010"", ""1001001"", ""00010"" and ""0"" are good but garlands ""00101001"", ""1000001"" and ""01001100"" are not. Note that the garland is not cyclic, i.e. the first turned on lamp is not going after the last turned on lamp and vice versa.Your task is to find the minimum number of moves you need to make to obtain k-periodic garland from the given one.You have to answer t independent test cases." 1900
1353D "Constructing the Array" "constructive algorithms,data structures,sortings" "You are given an array a of length n consisting of zeros. You perform n actions with this array: during the i-th action, the following sequence of operations appears:  Choose the maximum by length subarray (continuous subsegment) consisting only of zeros, among all such segments choose the leftmost one;  Let this segment be [l;r]. If r\xe2\x88\x92l+1 is odd (not divisible by 2) then assign (set) a[l+r2]:=i (where i is the number of the current action), otherwise (if r\xe2\x88\x92l+1 is even) assign (set) a[l+r\xe2\x88\x9212]:=i. Consider the array a of length 5 (initially a=[0,0,0,0,0]). Then it changes as follows:  Firstly, we choose the segment [1;5] and assign a[3]:=1, so a becomes [0,0,1,0,0];  then we choose the segment [1;2] and assign a[1]:=2, so a becomes [2,0,1,0,0];  then we choose the segment [4;5] and assign a[4]:=3, so a becomes [2,0,1,3,0];  then we choose the segment [2;2] and assign a[2]:=4, so a becomes [2,4,1,3,0];  and at last we choose the segment [5;5] and assign a[5]:=5, so a becomes [2,4,1,3,5]. Your task is to find the array a of length n after performing all n actions. Note that the answer exists and unique.You have to answer t independent test cases." 1600
1353C "Board Moves" math "You are given a board of size n\xc3\x97n, where n is odd (not divisible by 2). Initially, each cell of the board contains one figure.In one move, you can select exactly one figure presented in some cell and move it to one of the cells sharing a side or a corner with the current cell, i.e. from the cell (i,j) you can move the figure to cells:   (i\xe2\x88\x921,j\xe2\x88\x921);  (i\xe2\x88\x921,j);  (i\xe2\x88\x921,j+1);  (i,j\xe2\x88\x921);  (i,j+1);  (i+1,j\xe2\x88\x921);  (i+1,j);  (i+1,j+1); Of course, you can not move figures to cells out of the board. It is allowed that after a move there will be several figures in one cell.Your task is to find the minimum number of moves needed to get all the figures into one cell (i.e. n2\xe2\x88\x921 cells should contain 0 figures and one cell should contain n2 figures).You have to answer t independent test cases." 1000
1353B "Two Arrays And Swaps" greedy,sortings "You are given two arrays a and b both consisting of n positive (greater than zero) integers. You are also given an integer k.In one move, you can choose two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) and swap ai and bj (i.e. ai becomes bj and vice versa). Note that i and j can be equal or different (in particular, swap a2 with b2 or swap a3 and b9 both are acceptable moves).Your task is to find the maximum possible sum you can obtain in the array a if you can do no more than (i.e. at most) k such moves (swaps).You have to answer t independent test cases." 800
1353A "Most Unstable Array" "constructive algorithms,greedy,math" "You are given two integers n and m. You have to construct the array a of length n consisting of non-negative integers (i.e. integers greater than or equal to zero) such that the sum of elements of this array is exactly m and the value n\xe2\x88\x921\xe2\x88\x91i=1|ai\xe2\x88\x92ai+1| is the maximum possible. Recall that |x| is the absolute value of x.In other words, you have to maximize the sum of absolute differences between adjacent (consecutive) elements. For example, if the array a=[1,3,2,5,5,0] then the value above for this array is |1\xe2\x88\x923|+|3\xe2\x88\x922|+|2\xe2\x88\x925|+|5\xe2\x88\x925|+|5\xe2\x88\x920|=2+1+3+0+5=11. Note that this example doesn\'t show the optimal answer but it shows how the required value for some array is calculated.You have to answer t independent test cases." 800
1352G "Special Permutation" "constructive algorithms" "A permutation of length n is an array p=[p1,p2,\xe2\x80\xa6,pn], which contains every integer from 1 to n (inclusive) and, moreover, each number appears exactly once. For example, p=[3,1,4,2,5] is a permutation of length 5.For a given number n (n\xe2\x89\xa52), find a permutation p in which absolute difference (that is, the absolute value of difference) of any two neighboring (adjacent) elements is between 2 and 4, inclusive. Formally, find such permutation p that 2\xe2\x89\xa4|pi\xe2\x88\x92pi+1|\xe2\x89\xa44 for each i (1\xe2\x89\xa4i<n).Print any such permutation for the given integer n or determine that it does not exist." 1600
1352F "Binary String Reconstruction" "constructive algorithms,dfs and similar,math" "For some binary string s (i.e. each character si is either \'0\' or \'1\'), all pairs of consecutive (adjacent) characters were written. In other words, all substrings of length 2 were written. For each pair (substring of length 2), the number of \'1\' (ones) in it was calculated.You are given three numbers:  n0 \xe2\x80\x94 the number of such pairs of consecutive characters (substrings) where the number of ones equals 0;  n1 \xe2\x80\x94 the number of such pairs of consecutive characters (substrings) where the number of ones equals 1;  n2 \xe2\x80\x94 the number of such pairs of consecutive characters (substrings) where the number of ones equals 2. For example, for the string s=""1110011110"", the following substrings would be written: ""11"", ""11"", ""10"", ""00"", ""01"", ""11"", ""11"", ""11"", ""10"". Thus, n0=1, n1=3, n2=5.Your task is to restore any suitable binary string s from the given values n0,n1,n2. It is guaranteed that at least one of the numbers n0,n1,n2 is greater than 0. Also, it is guaranteed that a solution exists." 1500
1352E "Special Elements" "brute force,implementation,two pointers" "Pay attention to the non-standard memory limit in this problem.In order to cut off efficient solutions from inefficient ones in this problem, the time limit is rather strict. Prefer to use compiled statically typed languages (e.g. C++). If you use Python, then submit solutions on PyPy. Try to write an efficient solution.The array a=[a1,a2,\xe2\x80\xa6,an] (1\xe2\x89\xa4ai\xe2\x89\xa4n) is given. Its element ai is called special if there exists a pair of indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n) such that ai=al+al+1+\xe2\x80\xa6+ar. In other words, an element is called special if it can be represented as the sum of two or more consecutive elements of an array (no matter if they are special or not).Print the number of special elements of the given array a.For example, if n=9 and a=[3,1,4,1,5,9,2,6,5], then the answer is 5:  a3=4 is a special element, since a3=4=a1+a2=3+1;  a5=5 is a special element, since a5=5=a2+a3=1+4;  a6=9 is a special element, since a6=9=a1+a2+a3+a4=3+1+4+1;  a8=6 is a special element, since a8=6=a2+a3+a4=1+4+1;  a9=5 is a special element, since a9=5=a2+a3=1+4. Please note that some of the elements of the array a may be equal \xe2\x80\x94 if several elements are equal and special, then all of them should be counted in the answer." 1500
1352D "Alice, Bob and Candies" implementation "There are n candies in a row, they are numbered from left to right from 1 to n. The size of the i-th candy is ai.Alice and Bob play an interesting and tasty game: they eat candy. Alice will eat candy from left to right, and Bob \xe2\x80\x94 from right to left. The game ends if all the candies are eaten.The process consists of moves. During a move, the player eats one or more sweets from her/his side (Alice eats from the left, Bob \xe2\x80\x94 from the right).Alice makes the first move. During the first move, she will eat 1 candy (its size is a1). Then, each successive move the players alternate \xe2\x80\x94 that is, Bob makes the second move, then Alice, then again Bob and so on.On each move, a player counts the total size of candies eaten during the current move. Once this number becomes strictly greater than the total size of candies eaten by the other player on their previous move, the current player stops eating and the move ends. In other words, on a move, a player eats the smallest possible number of candies such that the sum of the sizes of candies eaten on this move is strictly greater than the sum of the sizes of candies that the other player ate on the previous move. If there are not enough candies to make a move this way, then the player eats up all the remaining candies and the game ends.For example, if n=11 and a=[3,1,4,1,5,9,2,6,5,3,5], then:  move 1: Alice eats one candy of size 3 and the sequence of candies becomes [1,4,1,5,9,2,6,5,3,5].  move 2: Alice ate 3 on the previous move, which means Bob must eat 4 or more. Bob eats one candy of size 5 and the sequence of candies becomes [1,4,1,5,9,2,6,5,3].  move 3: Bob ate 5 on the previous move, which means Alice must eat 6 or more. Alice eats three candies with the total size of 1+4+1=6 and the sequence of candies becomes [5,9,2,6,5,3].  move 4: Alice ate 6 on the previous move, which means Bob must eat 7 or more. Bob eats two candies with the total size of 3+5=8 and the sequence of candies becomes [5,9,2,6].  move 5: Bob ate 8 on the previous move, which means Alice must eat 9 or more. Alice eats two candies with the total size of 5+9=14 and the sequence of candies becomes [2,6].  move 6 (the last): Alice ate 14 on the previous move, which means Bob must eat 15 or more. It is impossible, so Bob eats the two remaining candies and the game ends. Print the number of moves in the game and two numbers:  a \xe2\x80\x94 the total size of all sweets eaten by Alice during the game;  b \xe2\x80\x94 the total size of all sweets eaten by Bob during the game." 1300
1352C "K-th Not Divisible by n" "binary search,math" "You are given two positive integers n and k. Print the k-th positive integer that is not divisible by n.For example, if n=3, and k=7, then all numbers that are not divisible by 3 are: 1,2,4,5,7,8,10,11,13\xe2\x80\xa6. The 7-th number among them is 10." 1200
1352B "Same Parity Summands" "constructive algorithms,math" "You are given two positive integers n (1\xe2\x89\xa4n\xe2\x89\xa4109) and k (1\xe2\x89\xa4k\xe2\x89\xa4100). Represent the number n as the sum of k positive integers of the same parity (have the same remainder when divided by 2).In other words, find a1,a2,\xe2\x80\xa6,ak such that all ai>0, n=a1+a2+\xe2\x80\xa6+ak and either all ai are even or all ai are odd at the same time.If such a representation does not exist, then report it." 1200
1352A "Sum of Round Numbers" implementation,math "A positive (strictly greater than zero) integer is called round if it is of the form d00...0. In other words, a positive integer is round if all its digits except the leftmost (most significant) are equal to zero. In particular, all numbers from 1 to 9 (inclusive) are round.For example, the following numbers are round: 4000, 1, 9, 800, 90. The following numbers are not round: 110, 707, 222, 1001.You are given a positive integer n (1\xe2\x89\xa4n\xe2\x89\xa4104). Represent the number n as a sum of round numbers using the minimum number of summands (addends). In other words, you need to represent the given number n as a sum of the least number of terms, each of which is a round number." 800
1351C Skier "data structures,implementation" "Skier rides on a snowy field. Its movements can be described by a string of characters \'S\', \'N\', \'W\', \'E\' (which correspond to 1 meter movement in the south, north, west or east direction respectively).It is known that if he moves along a previously unvisited segment of a path (i.e. this segment of the path is visited the first time), then the time of such movement is 5 seconds. If he rolls along previously visited segment of a path (i.e., this segment of the path has been covered by his path before), then it takes 1 second.Find the skier\'s time to roll all the path." 1400
1351B Square? "brute force,implementation,math" "Vasya claims that he had a paper square. He cut it into two rectangular parts using one vertical or horizontal cut. Then Vasya informed you the dimensions of these two rectangular parts. You need to check whether Vasya originally had a square. In other words, check if it is possible to make a square using two given rectangles." 900
1351A "A+B (Trial Problem)" implementation "You are given two integers a and b. Print a+b." 800
1350B "Orac and Models" "dp,math,number theory" "There are n models in the shop numbered from 1 to n, with sizes s1,s2,\xe2\x80\xa6,sn.Orac will buy some of the models and will arrange them in the order of increasing numbers (i.e. indices, but not sizes).Orac thinks that the obtained arrangement is beatiful, if for any two adjacent models with indices ij and ij+1 (note that ij<ij+1, because Orac arranged them properly), ij+1 is divisible by ij and sij<sij+1.For example, for 6 models with sizes {3,6,7,7,7,7}, he can buy models with indices 1, 2, and 6, and the obtained arrangement will be beautiful. Also, note that the arrangement with exactly one model is also considered beautiful.Orac wants to know the maximum number of models that he can buy, and he may ask you these queries many times." 1400
1350A "Orac and Factors" math "Orac is studying number theory, and he is interested in the properties of divisors.For two positive integers a and b, a is a divisor of b if and only if there exists an integer c, such that a\xe2\x8b\x85c=b.For n\xe2\x89\xa52, we will denote as f(n) the smallest positive divisor of n, except 1.For example, f(7)=7,f(10)=2,f(35)=5.For the fixed integer n, Orac decided to add f(n) to n. For example, if he had an integer n=5, the new value of n will be equal to 10. And if he had an integer n=6, n will be changed to 8.Orac loved it so much, so he decided to repeat this operation several times.Now, for two positive integers n and k, Orac asked you to add f(n) to n exactly k times (note that n will change after each operation, so f(n) may change too) and tell him the final value of n.For example, if Orac gives you n=5 and k=2, at first you should add f(5)=5 to n=5, so your new value of n will be equal to n=10, after that, you should add f(10)=2 to 10, so your new (and the final!) value of n will be equal to 12.Orac may ask you these queries many times." 900
1349F2 "Slime and Sequences (Hard Version)" dp,fft,math "Note that the only differences between easy and hard versions are the constraints on n and the time limit. You can make hacks only if all versions are solved.Slime is interested in sequences. He defined good positive integer sequences p of length n as follows: For each k>1 that presents in p, there should be at least one pair of indices i,j, such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n, pi=k\xe2\x88\x921 and pj=k.For the given integer n, the set of all good sequences of length n is sn. For the fixed integer k and the sequence p, let fp(k) be the number of times that k appears in p. For each k from 1 to n, Slime wants to know the following value:(\xe2\x88\x91p\xe2\x88\x88snfp(k)) mod 998244353" 3500
1349F1 "Slime and Sequences (Easy Version)" dp,fft,math "Note that the only differences between easy and hard versions are the constraints on n and the time limit. You can make hacks only if all versions are solved.Slime is interested in sequences. He defined good positive integer sequences p of length n as follows: For each k>1 that presents in p, there should be at least one pair of indices i,j, such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n, pi=k\xe2\x88\x921 and pj=k.For the given integer n, the set of all good sequences of length n is sn. For the fixed integer k and the sequence p, let fp(k) be the number of times that k appears in p. For each k from 1 to n, Slime wants to know the following value:(\xe2\x88\x91p\xe2\x88\x88snfp(k)) mod 998244353" 3100
1349E "Slime and Hats" "constructive algorithms,dp,greedy" "Slime and Orac are holding a turn-based game. In a big room, there are n players sitting on the chairs, looking forward to a column and each of them is given a number: player 1 sits in the front of the column, player 2 sits directly behind him; player 3 sits directly behind player 2, and so on; player n sits directly behind player n\xe2\x88\x921. Each player wears a hat that is either black or white. As each player faces forward, player i knows the color of player j\'s hat if and only if i is larger than j.At the start of each turn, Orac will tell whether there exists a player wearing a black hat in the room.After Orac speaks, if the player can uniquely identify the color of his hat, he will put his hat on the chair, stand up and leave the room. All players are smart, so if it is possible to understand the color of their hat using the obtained information during this and previous rounds, they will understand it. In each turn, all players who know the color of their hats will leave at the same time in this turn, which means a player can only leave in the next turn if he gets to know the color of his hat only after someone left the room at this turn.Note that when the player needs to leave, he will put the hat on the chair before leaving, so the players ahead of him still cannot see his hat. The i-th player will know who exactly left the room among players 1,2,\xe2\x80\xa6,i\xe2\x88\x921, and how many players among i+1,i+2,\xe2\x80\xa6,n have left the room.Slime stands outdoor. He watches the players walking out and records the numbers of the players and the time they get out. Unfortunately, Slime is so careless that he has only recorded some of the data, and this given data is in the format ""player x leaves in the y-th round"".Slime asked you to tell him the color of each player\'s hat. If there are multiple solutions, you can find any of them." 3500
1349D "Slime and Biscuits" math,probabilities "Slime and his n friends are at a party. Slime has designed a game for his friends to play.At the beginning of the game, the i-th player has ai biscuits. At each second, Slime will choose a biscuit randomly uniformly among all a1+a2+\xe2\x80\xa6+an biscuits, and the owner of this biscuit will give it to a random uniform player among n\xe2\x88\x921 players except himself. The game stops when one person will have all the biscuits.As the host of the party, Slime wants to know the expected value of the time that the game will last, to hold the next activity on time.For convenience, as the answer can be represented as a rational number pq for coprime p and q, you need to find the value of (p\xe2\x8b\x85q\xe2\x88\x921)mod998244353. You can prove that qmod998244353\xe2\x89\xa00." 3200
1349C "Orac and Game of Life" "dfs and similar,graphs,implementation,shortest paths" "Please notice the unusual memory limit of this problem.Orac likes games. Recently he came up with the new game, ""Game of Life"".You should play this game on a black and white grid with n rows and m columns. Each cell is either black or white.For each iteration of the game (the initial iteration is 0), the color of each cell will change under the following rules: If there are no adjacent cells with the same color as this cell on the current iteration, the color of it on the next iteration will be the same. Otherwise, the color of the cell on the next iteration will be different.Two cells are adjacent if they have a mutual edge.Now Orac has set an initial situation, and he wants to know for the cell (i,j) (in i-th row and j-th column), what will be its color at the iteration p. He may ask you these questions several times." 2000
1349B "Orac and Medians" "constructive algorithms,greedy,math" "Slime has a sequence of positive integers a1,a2,\xe2\x80\xa6,an.In one operation Orac can choose an arbitrary subsegment [l\xe2\x80\xa6r] of this sequence and replace all values al,al+1,\xe2\x80\xa6,ar to the value of median of {al,al+1,\xe2\x80\xa6,ar}.In this problem, for the integer multiset s, the median of s is equal to the \xe2\x8c\x8a|s|+12\xe2\x8c\x8b-th smallest number in it. For example, the median of {1,4,4,6,5} is 4, and the median of {1,7,5,8} is 5.Slime wants Orac to make a1=a2=\xe2\x80\xa6=an=k using these operations.Orac thinks that it is impossible, and he does not want to waste his time, so he decided to ask you if it is possible to satisfy the Slime\'s requirement, he may ask you these questions several times." 2000
1349A "Orac and LCM" "data structures,math,number theory" "For the multiset of positive integers s={s1,s2,\xe2\x80\xa6,sk}, define the Greatest Common Divisor (GCD) and Least Common Multiple (LCM) of s as follow: gcd(s) is the maximum positive integer x, such that all integers in s are divisible on x. lcm(s) is the minimum positive integer x, that divisible on all integers from s.For example, gcd({8,12})=4,gcd({12,18,6})=6 and lcm({4,6})=12. Note that for any positive integer x, gcd({x})=lcm({x})=x.Orac has a sequence a with length n. He come up with the multiset t={lcm({ai,aj}) | i<j}, and asked you to find the value of gcd(t) for him. In other words, you need to calculate the GCD of LCMs of all pairs of elements in the given sequence." 1600
1348F "Phoenix and Memory" "data structures,dfs and similar,graphs,greedy" "Phoenix is trying to take a photo of his n friends with labels 1,2,\xe2\x80\xa6,n who are lined up in a row in a special order. But before he can take the photo, his friends get distracted by a duck and mess up their order.Now, Phoenix must restore the order but he doesn\'t remember completely! He only remembers that the i-th friend from the left had a label between ai and bi inclusive. Does there exist a unique way to order his friends based of his memory?" 2600
1348E "Phoenix and Berries" "brute force,dp,greedy,math" "Phoenix is picking berries in his backyard. There are n shrubs, and each shrub has ai red berries and bi blue berries.Each basket can contain k berries. But, Phoenix has decided that each basket may only contain berries from the same shrub or berries of the same color (red or blue). In other words, all berries in a basket must be from the same shrub or/and have the same color.For example, if there are two shrubs with 5 red and 2 blue berries in the first shrub and 2 red and 1 blue berries in the second shrub then Phoenix can fill 2 baskets of capacity 4 completely:   the first basket will contain 3 red and 1 blue berries from the first shrub;  the second basket will contain the 2 remaining red berries from the first shrub and 2 red berries from the second shrub. Help Phoenix determine the maximum number of baskets he can fill completely!" 2400
1348D "Phoenix and Science" "binary search,constructive algorithms,greedy,implementation,math" "Phoenix has decided to become a scientist! He is currently investigating the growth of bacteria.Initially, on day 1, there is one bacterium with mass 1.Every day, some number of bacteria will split (possibly zero or all). When a bacterium of mass m splits, it becomes two bacteria of mass m2 each. For example, a bacterium of mass 3 can split into two bacteria of mass 1.5.Also, every night, the mass of every bacteria will increase by one.Phoenix is wondering if it is possible for the total mass of all the bacteria to be exactly n. If it is possible, he is interested in the way to obtain that mass using the minimum possible number of nights. Help him become the best scientist!" 1900
1348C "Phoenix and Distribution" "constructive algorithms,greedy,sortings,strings" "Phoenix has a string s consisting of lowercase Latin letters. He wants to distribute all the letters of his string into k non-empty strings a1,a2,\xe2\x80\xa6,ak such that every letter of s goes to exactly one of the strings ai. The strings ai do not need to be substrings of s. Phoenix can distribute letters of s and rearrange the letters within each string ai however he wants.For example, if s= baba and k=2, Phoenix may distribute the letters of his string in many ways, such as:   ba and ba  a and abb  ab and ab  aa and bb But these ways are invalid:   baa and ba  b and ba  baba and empty string (ai should be non-empty) Phoenix wants to distribute the letters of his string s into k strings a1,a2,\xe2\x80\xa6,ak to minimize the lexicographically maximum string among them, i. e. minimize max(a1,a2,\xe2\x80\xa6,ak). Help him find the optimal distribution and print the minimal possible value of max(a1,a2,\xe2\x80\xa6,ak).String x is lexicographically less than string y if either x is a prefix of y and x\xe2\x89\xa0y, or there exists an index i (1\xe2\x89\xa4i\xe2\x89\xa4min(|x|,|y|)) such that xi < yi and for every j (1\xe2\x89\xa4j<i) xj=yj. Here |x| denotes the length of the string x." 1600
1348B "Phoenix and Beauty" "constructive algorithms,data structures,greedy,sortings" "Phoenix loves beautiful arrays. An array is beautiful if all its subarrays of length k have the same sum. A subarray of an array is any sequence of consecutive elements.Phoenix currently has an array a of length n. He wants to insert some number of integers, possibly zero, into his array such that it becomes beautiful. The inserted integers must be between 1 and n inclusive. Integers may be inserted anywhere (even before the first or after the last element), and he is not trying to minimize the number of inserted integers." 1400
1348A "Phoenix and Balance" greedy,math "Phoenix has n coins with weights 21,22,\xe2\x80\xa6,2n. He knows that n is even.He wants to split the coins into two piles such that each pile has exactly n2 coins and the difference of weights between the two piles is minimized. Formally, let a denote the sum of weights in the first pile, and b denote the sum of weights in the second pile. Help Phoenix minimize |a\xe2\x88\x92b|, the absolute value of a\xe2\x88\x92b." 800
1346I "Pac-Man 2.0" "*special problem,dp" "Polycarp is developing a new version of an old video game ""Pac-Man"". Though he really enjoyed playing the original game, he didn\'t like some aspects of it, so he decided to alter the rules a bit.In Polycarp\'s version, you play as Pac-Man and you have to collect pellets scattered over the game world while avoiding dangerous ghosts (no difference from the original yet). Polycarp didn\'t like the fact that there was no escape from the ghosts in the original, so, in his version, the game world is divided into n safe zones with m one-directional pathways between them \xe2\x80\x94 and it is guaranteed that Pac-Man can reach any safe zone from any other. Since safe zones are safe, the ghosts cannot attack Pac-Man while it is there, it is in danger only while traversing the pathways. Pac-Man starts the game in the safe zone s.All pellets are scattered over the safe zones; initially, the i-th safe zone contains ai pellets (and if Pac-Man is in a safe zone, it may freely collect all the pellets in it). The pellets disappear after being collected, but after the last pellet in the game world is collected, new pellets spawn in the safe zones in the same quantity as before (ai new pellets spawn in the i-th zone). The pellets can be respawned any number of times, so the game is essentially infinite.Polycarp has already determined the structure of the game world and the number of pellets in each safe zone. Now he is trying to find out if the game is difficult enough. There are q goals in the game, the i-th goal is to collect at least Ci pellets from the beginning of the game. Polycarp denotes the difficulty of the i-th goal as the minimum number of times the player has to traverse a one-directional pathway in order to collect Ci pellets (since only traversing a pathway puts Pac-Man in danger). If some pathway is traversed multiple times while Pac-Man is collecting the pellets, it is included in the answer the same number of times.Help Polycarp to calculate the difficulty of each goal!" 2900
1346H "Game with Segments" "*special problem,data structures,games" "Alice and Bob are playing a game (yet again).They have two sequences of segments of the coordinate axis: a sequence of n initial segments: [l1,r1], [l2,r2], ..., [ln,rn], and a sequence of m terminal segments: [L1,R1], [L2,R2], ..., [Lm,Rm]. At the beginning of the game, they choose one of the initial segments and set it as the current segment.Alice and Bob make alternating moves: Alice makes the first move, Bob makes the second move, Alice makes the third one, and so on. During each move, the current player must shrink the current segment either by increasing its left endpoint by 1, or by decreasing its right endpoint by 1. So, if the current segment is [cl,cr], it becomes either [cl+1,cr], or [cl,cr\xe2\x88\x921].If at the beginning of the game or after Bob\'s move the current segment coincides with one of the terminal segments, Bob wins. If the current segment becomes degenerate (cl=cr), and Bob hasn\'t won yet, Alice wins. If the current segment coincides with one of the terminal segments after Alice\'s move, nothing happens \xe2\x80\x94 the game continues.Both players play optimally \xe2\x80\x94 if they can win, they always use a strategy that leads them to victory in the minimum number of turns, and if they cannot win, they try to prolong the game, using the strategy allowing them to make the maximum possible number of moves until their defeat.For each of the initial segments you have to determine who will win the game if this segment is chosen as the current segment at the beginning of the game. If Bob wins, you also have to calculate the number of moves Alice will make before her defeat." 2700
1346G "Two IP Cameras" "*special problem,math,number theory" "You have two IP cameras of the same model. Each camera can take photos starting from some moment of time with a fixed period. You can freely choose the starting moment but you can choose the period only as one of k values p1,p2,\xe2\x80\xa6,pk which are chosen by the camera\'s manufacturer.You have n moments of interest x1,x2,\xe2\x80\xa6,xn. You\'d like to configure both cameras in such a way that at least one camera will take a photo in each of these moments. Configuring the camera means setting the moment when it takes the first photo and the gap between two consecutive photos (which should be one of the values p1,p2,\xe2\x80\xa6,pk). It\'s not a problem for you that cameras can take photos at other moments of time \xe2\x80\x94 you only care about moments of interest." 2300
1346F "Dune II: Battle For Arrakis" "*special problem,data structures,greedy,math" "You\'re at the last mission in one very old and very popular strategy game Dune II: Battle For Arrakis. The map of the mission can be represented as a rectangular matrix of size n\xc3\x97m. Initially, there are ai,j units of your army in the cell (i,j).You want to prepare for the final battle, so you want to move all your army into exactly one cell of the map (i.e. nm\xe2\x88\x921 cells should contain 0 units of the army and the remaining cell should contain the entire army).To do this, you can do some (possibly, zero) number of moves. During one move, you can select exactly one unit from some cell and move it to one of the adjacent by side cells. I.e. from the cell (i,j) you can move the unit to cells:  (i\xe2\x88\x921,j);  (i,j\xe2\x88\x921);  (i+1,j);  (i,j+1). Of course, you want to move all your army into exactly one cell as fast as possible. So, you want to know the minimum number of moves you need to do that.And, of course, life goes on, so the situation on the map changes. There are q updates, the i-th update is denoted by three integers x,y,z. This update affects the army in the cell (x,y): after this update, the number of units in the cell (x,y) becomes z (i.e. you replace ax,y with z).Also, you want to determine, for each i, the minimum number of moves needed to move your entire army into exactly one cell with the first i updates applied to the initial map. In other words, the map after the i-th update equals the initial map with the first i updates applied to it." 2000
1346E "Magic Tricks" "*special problem,dp,graphs" "Masha is going to participate in a talent show conducted by the university she studies at. She wants to impress the audience with lots of different magic tricks!For one of her tricks, she uses n sponge balls, one of which is a special one. First, she arranges the balls in a row in such a way that the special ball is put on position k (positions are numbered from 1 to n from left to right). After that, she performs m swaps: during the i-th swap, she chooses the ball on position xi and the ball on position yi, and swaps them.Since Masha is a magician, she fakes some of her actions to trick the audience \xe2\x80\x94 when she starts performing a swap, she may fake it, so it is not performed (but it looks like it is performed for the audience). There are no constraints on which swaps Masha should fake or should actually perform \xe2\x80\x94 for example, she may fake all of the swaps, or even not fake anything at all.For the trick to work perfectly, the special ball should end up on a specific position \xe2\x80\x94 Masha has not decided yet, which position is perfect. Since faking swaps is difficult, for each position she wants to know the minimum number of swaps she has to fake so that the special ball ends up there. Unfortunately, Masha is a magician, neither a mathematician nor a programmer. So she needs your help in calculating what she wants!" 1700
1346D "Constructing the Dungeon" "*special problem,graphs,greedy" "Polycarp is developing an RPG game where the main character fights monsters and searches for treasure in dungeons. Now Polycarp is making one of the dungeons the character can explore.The dungeon consists of n rooms connected by m two-way tunnels, and it is possible to reach every room from every other room using tunnels. The rooms are guarded by monsters (the number of monsters in the i-th room is ai), and the tunnels contain gold coins (the number of coins in the i-th tunnel is wi). The i-th two-way tunnel connects rooms vi and ui.Polycarp has already fixed the number of coins in each tunnel (the values of wi are already known), and now he tries to place the monsters in the rooms (the values of ai are not known yet). Polycarp wants to choose the number of monsters in each room in such a way that the following two conditions are met:  the number of coins for the tunnel connecting the rooms x and y should be equal to the minimum of ax and ay. That is, for each tunnel i, wi=min(avi,aui);  the number of monsters in the dungeon is as small as possible. That is, the value of a1+a2+\xe2\x8b\xaf+an is minimum possible. Help Polycarp to choose the values a1, a2, ..., an, or tell him that it is impossible and he has to change something in his dungeon plan." 1600
1346C "Spring Cleaning" "*special problem,greedy,sortings" "Tanya wants to organize her bookcase. There are n bookshelves in the bookcase, the i-th bookshelf contains ai books on it. Tanya will be satisfied if each bookshelf contains no more than k books.Tanya can do one of the two following operations to achieve her goal:   Choose exactly one bookshelf and put all the books from it in the storage room (i.\xe2\x80\x89e. choose some i and assign ai:=0). During this operation she spends x seconds.  Take all books from all n bookshelves and distribute them between all n bookshelves evenly (the definition of the term is given below). During this operation she spends y seconds. Consider the sequence a of n integers. Then its even distribution is such a sequence b of n integers that the sum of b equals the sum of a and the value max(b)\xe2\x88\x92min(b) is the minimum possible.For example, if the array a=[5,4,3] then its even distribution is b=[4,4,4]. If a=[1,2,3,4] then its even distribution is b=[2,3,3,2] (or any permutation of this array).Your task is to find the minimum number of seconds Tanya has to spend to obtain the bookcase with no more than k books on each bookshelf." 1600
1346B "Boot Camp" "*special problem,greedy" "Berland State University (BSU) is conducting a programming boot camp. The boot camp will last for n days, and the BSU lecturers are planning to give some number of lectures during these days.Some days of the boot camp are already planned as excursion days, and no lectures should be held during these days. To make sure the participants don\'t get too tired of learning to program, the number of lectures for each day should not exceed k1, and the number of lectures for each pair of consecutive days should not exceed k2.Can you calculate the maximum number of lectures that can be conducted during the boot camp? Formally, find the maximum integer m such that it is possible to choose n non-negative integers c1, c2, ..., cn (where ci is the number of lectures held during day i) so that:  c1+c2+\xe2\x8b\xaf+cn=m;  for each excursion day d, cd=0;  for each day i, ci\xe2\x89\xa4k1;  for each pair of consecutive days (i,i+1), ci+ci+1\xe2\x89\xa4k2. Note that there might be some non-excursion days without lectures (i.\xe2\x80\x89e., it is possible that ci=0 even if i is not an excursion day)." 1400
1346A "Color Revolution" "*special problem,math" "Hmm, how long has it been since the last color revolution? 5 years?! It\'s totally the time to make a new one!So the general idea is the following. Division 1 should have n1 participants. Division 2 should have n2 and be exactly k times bigger than division 1 (n2=k\xe2\x8b\x85n1). Division 3 should have n3=k\xe2\x8b\x85n2 participants. Finally, division 4 should have n4=k\xe2\x8b\x85n3 participants.There are n participants on Codeforces in total. So n1+n2+n3+n4 should be exactly equal to n.You know the values of n and k. You also know that n and k are chosen in such a way that there exist values n1,n2,n3 and n4 such that all the conditions are satisfied.What will be the number of participants in each division (n1,n2,n3 and n4) after the revolution?" 1000
1345B "Card Constructions" "binary search,brute force,dp,math" "A card pyramid of height 1 is constructed by resting two cards against each other. For h>1, a card pyramid of height h is constructed by placing a card pyramid of height h\xe2\x88\x921 onto a base. A base consists of h pyramids of height 1, and h\xe2\x88\x921 cards on top. For example, card pyramids of heights 1, 2, and 3 look as follows:  You start with n cards and build the tallest pyramid that you can. If there are some cards remaining, you build the tallest pyramid possible with the remaining cards. You repeat this process until it is impossible to build another pyramid. In the end, how many pyramids will you have constructed?" 1100
1345A "Puzzle Pieces" math "You are given a special jigsaw puzzle consisting of n\xe2\x8b\x85m identical pieces. Every piece has three tabs and one blank, as pictured below.  The jigsaw puzzle is considered solved if the following conditions hold:  The pieces are arranged into a grid with n rows and m columns.  For any two pieces that share an edge in the grid, a tab of one piece fits perfectly into a blank of the other piece. Through rotation and translation of the pieces, determine if it is possible to solve the jigsaw puzzle." 800
1344F "Piet\'s Palette" matrices "Piet Mondrian is an artist most famous for his minimalist works, consisting only of the four colors red, yellow, blue, and white. Most people attribute this to his style, but the truth is that his paint behaves in a very strange way where mixing two primary colors only produces another primary color!  A lesser known piece, entitled ""Pretentious rectangles"" A sequence of primary colors (red, yellow, blue) is mixed as follows. While there are at least two colors, look at the first two. If they are distinct, replace them with the missing color. If they are the same, remove them from the sequence. In the end, if there is one color, that is the resulting color. Otherwise, if the sequence is empty, we say the resulting color is white. Here are two example mixings:       Piet has a color palette with cells numbered from 1 to n. Each cell contains a primary color or is empty. Piet is very secretive, and will not share his palette with you, so you do not know what colors belong to each cell.However, he did perform k operations. There are four kinds of operations:   In a mix operation, Piet chooses a subset of cells and mixes their colors together in some order. The order is not necessarily by increasing indexes. He records the resulting color. Empty cells are skipped over, having no effect on the mixing process. The mixing does not change the color values stored in the cells.  In a RY operation, Piet chooses a subset of cells. Any red cells in this subset become yellow, and any yellow cells in this subset become red. Blue and empty cells remain unchanged.  In a RB operation, Piet chooses a subset of cells. Any red cells in this subset become blue, and any blue cells in this subset become red. Yellow and empty cells remain unchanged.  In a YB operation, Piet chooses a subset of cells. Any yellow cells in this subset become blue, and any blue cells in this subset become yellow. Red and empty cells remain unchanged. Piet only tells you the list of operations he performs in chronological order, the indexes involved, and the resulting color of each mix operation. For each mix operation, you also know the order in which the cells are mixed. Given this information, determine the color of each cell in the initial palette. That is, you should find one possible state of the palette (before any operations were performed), or say that the described situation is impossible." 3200
1344E "Train Tracks" "data structures,trees" "That\'s right. I\'m a Purdue student, and I shamelessly wrote a problem about trains.There are n stations and m trains. The stations are connected by n\xe2\x88\x921 one-directional railroads that form a tree rooted at station 1. All railroads are pointed in the direction from the root station 1 to the leaves. A railroad connects a station u to a station v, and has a distance d, meaning it takes d time to travel from u to v. Each station with at least one outgoing railroad has a switch that determines the child station an incoming train will be directed toward. For example, it might look like this:  Here, stations 1 and 3 have switches directed toward stations 2 and 4, respectively. Initially, no trains are at any station. Train i will enter station 1 at time ti. Every unit of time, starting at time 1, the following two steps happen:  You can switch at most one station to point to a different child station. A switch change takes effect before step 2.  For every train that is on a station u, it is directed toward the station v indicated by u\'s switch. So, if the railroad from u to v has distance d, the train will enter station v in d units of time from now. Every train has a destination station si. When it enters si, it will stop there permanently. If at some point the train is going in the wrong direction, so that it will never be able to reach si no matter where the switches point, it will immediately explode.Find the latest possible time of the first explosion if you change switches optimally, or determine that you can direct every train to its destination so that no explosion occurs. Also, find the minimum number of times you need to change a switch to achieve this." 3100
1344D "R\xc3\xa9sum\xc3\xa9 Review" "binary search,greedy,math" "Uh oh! Applications to tech companies are due soon, and you\'ve been procrastinating by doing contests instead! (Let\'s pretend for now that it is actually possible to get a job in these uncertain times.)You have completed many programming projects. In fact, there are exactly n types of programming projects, and you have completed ai projects of type i. Your r\xc3\xa9sum\xc3\xa9 has limited space, but you want to carefully choose them in such a way that maximizes your chances of getting hired.You want to include several projects of the same type to emphasize your expertise, but you also don\'t want to include so many that the low-quality projects start slipping in. Specifically, you determine the following quantity to be a good indicator of your chances of getting hired:f(b1,\xe2\x80\xa6,bn)=n\xe2\x88\x91i=1bi(ai\xe2\x88\x92b2i).Here, bi denotes the number of projects of type i you include in your r\xc3\xa9sum\xc3\xa9. Of course, you cannot include more projects than you have completed, so you require 0\xe2\x89\xa4bi\xe2\x89\xa4ai for all i.Your r\xc3\xa9sum\xc3\xa9 only has enough room for k projects, and you will absolutely not be hired if your r\xc3\xa9sum\xc3\xa9 has empty space, so you require n\xe2\x88\x91i=1bi=k.Find values for b1,\xe2\x80\xa6,bn that maximize the value of f(b1,\xe2\x80\xa6,bn) while satisfying the above two constraints." 2700
1344C "Quantifier Question" "dfs and similar,dp,graphs,math" "Logical quantifiers are very useful tools for expressing claims about a set. For this problem, let\'s focus on the set of real numbers specifically. The set of real numbers includes zero and negatives. There are two kinds of quantifiers: universal (\xe2\x88\x80) and existential (\xe2\x88\x83). You can read more about them here.The universal quantifier is used to make a claim that a statement holds for all real numbers. For example:  \xe2\x88\x80x,x<100 is read as: for all real numbers x, x is less than 100. This statement is false.  \xe2\x88\x80x,x>x\xe2\x88\x921 is read as: for all real numbers x, x is greater than x\xe2\x88\x921. This statement is true. The existential quantifier is used to make a claim that there exists some real number for which the statement holds. For example:  \xe2\x88\x83x,x<100 is read as: there exists a real number x such that x is less than 100. This statement is true.  \xe2\x88\x83x,x>x\xe2\x88\x921 is read as: there exists a real number x such that x is greater than x\xe2\x88\x921. This statement is true. Moreover, these quantifiers can be nested. For example:  \xe2\x88\x80x,\xe2\x88\x83y,x<y is read as: for all real numbers x, there exists a real number y such that x is less than y. This statement is true since for every x, there exists y=x+1.  \xe2\x88\x83y,\xe2\x88\x80x,x<y is read as: there exists a real number y such that for all real numbers x, x is less than y. This statement is false because it claims that there is a maximum real number: a number y larger than every x. Note that the order of variables and quantifiers is important for the meaning and veracity of a statement.There are n variables x1,x2,\xe2\x80\xa6,xn, and you are given some formula of the form f(x1,\xe2\x80\xa6,xn):=(xj1<xk1)\xe2\x88\xa7(xj2<xk2)\xe2\x88\xa7\xe2\x8b\xaf\xe2\x88\xa7(xjm<xkm),where \xe2\x88\xa7 denotes logical AND. That is, f(x1,\xe2\x80\xa6,xn) is true if every inequality xji<xki holds. Otherwise, if at least one inequality does not hold, then f(x1,\xe2\x80\xa6,xn) is false.Your task is to assign quantifiers Q1,\xe2\x80\xa6,Qn to either universal (\xe2\x88\x80) or existential (\xe2\x88\x83) so that the statement Q1x1,Q2x2,\xe2\x80\xa6,Qnxn,f(x1,\xe2\x80\xa6,xn)is true, and the number of universal quantifiers is maximized, or determine that the statement is false for every possible assignment of quantifiers.Note that the order the variables appear in the statement is fixed. For example, if f(x1,x2):=(x1<x2) then you are not allowed to make x2 appear first and use the statement \xe2\x88\x80x2,\xe2\x88\x83x1,x1<x2. If you assign Q1=\xe2\x88\x83 and Q2=\xe2\x88\x80, it will only be interpreted as \xe2\x88\x83x1,\xe2\x88\x80x2,x1<x2." 2600
1344B "Monopole Magnets" "constructive algorithms,dfs and similar,dsu,graphs" "A monopole magnet is a magnet that only has one pole, either north or south. They don\'t actually exist since real magnets have two poles, but this is a programming contest problem, so we don\'t care.There is an n\xc3\x97m grid. Initially, you may place some north magnets and some south magnets into the cells. You are allowed to place as many magnets as you like, even multiple in the same cell.An operation is performed as follows. Choose a north magnet and a south magnet to activate. If they are in the same row or the same column and they occupy different cells, then the north magnet moves one unit closer to the south magnet. Otherwise, if they occupy the same cell or do not share a row or column, then nothing changes. Note that the south magnets are immovable.Each cell of the grid is colored black or white. Let\'s consider ways to place magnets in the cells so that the following conditions are met.  There is at least one south magnet in every row and every column.  If a cell is colored black, then it is possible for a north magnet to occupy this cell after some sequence of operations from the initial placement.  If a cell is colored white, then it is impossible for a north magnet to occupy this cell after some sequence of operations from the initial placement. Determine if it is possible to place magnets such that these conditions are met. If it is possible, find the minimum number of north magnets required (there are no requirements on the number of south magnets)." 2000
1344A "Hilbert\'s Hotel" "math,number theory,sortings" "Hilbert\'s Hotel is a very unusual hotel since the number of rooms is infinite! In fact, there is exactly one room for every integer, including zero and negative integers. Even stranger, the hotel is currently at full capacity, meaning there is exactly one guest in every room. The hotel\'s manager, David Hilbert himself, decides he wants to shuffle the guests around because he thinks this will create a vacancy (a room without a guest).For any integer k and positive integer n, let kmodn denote the remainder when k is divided by n. More formally, r=kmodn is the smallest non-negative integer such that k\xe2\x88\x92r is divisible by n. It always holds that 0\xe2\x89\xa4kmodn\xe2\x89\xa4n\xe2\x88\x921. For example, 100mod12=4 and (\xe2\x88\x921337)mod3=1.Then the shuffling works as follows. There is an array of n integers a0,a1,\xe2\x80\xa6,an\xe2\x88\x921. Then for each integer k, the guest in room k is moved to room number k+akmodn.After this shuffling process, determine if there is still exactly one guest assigned to each room. That is, there are no vacancies or rooms with multiple guests." 1600
1343F "Restore the Permutation by Sorted Segments" "brute force,constructive algorithms,data structures,greedy,implementation" "We guessed a permutation p consisting of n integers. The permutation of length n is the array of length n where each element from 1 to n appears exactly once. This permutation is a secret for you.For each position r from 2 to n we chose some other index l (l<r) and gave you the segment pl,pl+1,\xe2\x80\xa6,pr in sorted order (i.e. we rearranged the elements of this segment in a way that the elements of this segment are sorted). Thus, you are given exactly n\xe2\x88\x921 segments of the initial permutation but elements inside each segment are sorted. The segments are given to you in random order.For example, if the secret permutation is p=[3,1,4,6,2,5] then the possible given set of segments can be:  [2,5,6]  [4,6]  [1,3,4]  [1,3]  [1,2,4,6] Your task is to find any suitable permutation (i.e. any permutation corresponding to the given input data). It is guaranteed that the input data corresponds to some permutation (i.e. such permutation exists).You have to answer t independent test cases." 2400
1343E "Weights Distributing" "brute force,graphs,greedy,shortest paths,sortings" "You are given an undirected unweighted graph consisting of n vertices and m edges (which represents the map of Bertown) and the array of prices p of length m. It is guaranteed that there is a path between each pair of vertices (districts).Mike has planned a trip from the vertex (district) a to the vertex (district) b and then from the vertex (district) b to the vertex (district) c. He can visit the same district twice or more. But there is one issue: authorities of the city want to set a price for using the road so if someone goes along the road then he should pay the price corresponding to this road (he pays each time he goes along the road). The list of prices that will be used p is ready and they just want to distribute it between all roads in the town in such a way that each price from the array corresponds to exactly one road.You are a good friend of Mike (and suddenly a mayor of Bertown) and want to help him to make his trip as cheap as possible. So, your task is to distribute prices between roads in such a way that if Mike chooses the optimal path then the price of the trip is the minimum possible. Note that you cannot rearrange prices after the start of the trip.You have to answer t independent test cases." 2100
1343D "Constant Palindrome Sum" "brute force,data structures,greedy,two pointers" "You are given an array a consisting of n integers (it is guaranteed that n is even, i.e. divisible by 2). All ai does not exceed some integer k.Your task is to replace the minimum number of elements (replacement is the following operation: choose some index i from 1 to n and replace ai with some integer in range [1;k]) to satisfy the following conditions:  after all replacements, all ai are positive integers not greater than k;  for all i from 1 to n2 the following equation is true: ai+an\xe2\x88\x92i+1=x, where x should be the same for all n2 pairs of elements. You have to answer t independent test cases." 1700
1343C "Alternating Subsequence" "dp,greedy,two pointers" "Recall that the sequence b is a a subsequence of the sequence a if b can be derived from a by removing zero or more elements without changing the order of the remaining elements. For example, if a=[1,2,1,3,1,2,1], then possible subsequences are: [1,1,1,1], [3] and [1,2,1,3,1,2,1], but not [3,2,3] and [1,1,1,1,2].You are given a sequence a consisting of n positive and negative elements (there is no zeros in the sequence).Your task is to choose maximum by size (length) alternating subsequence of the given sequence (i.e. the sign of each next element is the opposite from the sign of the current element, like positive-negative-positive and so on or negative-positive-negative and so on). Among all such subsequences, you have to choose one which has the maximum sum of elements.In other words, if the maximum length of alternating subsequence is k then your task is to find the maximum sum of elements of some alternating subsequence of length k.You have to answer t independent test cases." 1200
1343B "Balanced Array" "constructive algorithms,math" "You are given a positive integer n, it is guaranteed that n is even (i.e. divisible by 2).You want to construct the array a of length n such that:   The first n2 elements of a are even (divisible by 2);  the second n2 elements of a are odd (not divisible by 2);  all elements of a are distinct and positive;  the sum of the first half equals to the sum of the second half (n2\xe2\x88\x91i=1ai=n\xe2\x88\x91i=n2+1ai). If there are multiple answers, you can print any. It is not guaranteed that the answer exists.You have to answer t independent test cases." 800
1343A Candies "brute force,math" "Recently Vova found n candy wrappers. He remembers that he bought x candies during the first day, 2x candies during the second day, 4x candies during the third day, \xe2\x80\xa6, 2k\xe2\x88\x921x candies during the k-th day. But there is an issue: Vova remembers neither x nor k but he is sure that x and k are positive integers and k>1.Vova will be satisfied if you tell him any positive integer x so there is an integer k>1 that x+2x+4x+\xe2\x8b\xaf+2k\xe2\x88\x921x=n. It is guaranteed that at least one solution exists. Note that k>1.You have to answer t independent test cases." 900
1342F "Make It Ascending" "bitmasks,brute force,dp" "You are given an array a consisting of n elements. You may apply several operations (possibly zero) to it.During each operation, you choose two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n; i\xe2\x89\xa0j), increase aj by ai, and remove the i-th element from the array (so the indices of all elements to the right to it decrease by 1, and n also decreases by 1).Your goal is to make the array a strictly ascending. That is, the condition a1<a2<\xe2\x8b\xaf<an should hold (where n is the resulting size of the array).Calculate the minimum number of actions required to make the array strictly ascending." 3000
1342E "Placing Rooks" combinatorics,fft,math "Calculate the number of ways to place n rooks on n\xc3\x97n chessboard so that both following conditions are met:  each empty cell is under attack;  exactly k pairs of rooks attack each other. An empty cell is under attack if there is at least one rook in the same row or at least one rook in the same column. Two rooks attack each other if they share the same row or column, and there are no other rooks between them. For example, there are only two pairs of rooks that attack each other in the following picture:  One of the ways to place the rooks for n=3 and k=2 Two ways to place the rooks are considered different if there exists at least one cell which is empty in one of the ways but contains a rook in another way.The answer might be large, so print it modulo 998244353." 2300
1342D "Multiple Testcases" "binary search,constructive algorithms,data structures,greedy,sortings,two pointers" "So you decided to hold a contest on Codeforces. You prepared the problems: statements, solutions, checkers, validators, tests... Suddenly, your coordinator asks you to change all your tests to multiple testcases in the easiest problem!Initially, each test in that problem is just an array. The maximum size of an array is k. For simplicity, the contents of arrays don\'t matter. You have n tests \xe2\x80\x94 the i-th test is an array of size mi (1\xe2\x89\xa4mi\xe2\x89\xa4k).Your coordinator asks you to distribute all of your arrays into multiple testcases. Each testcase can include multiple arrays. However, each testcase should include no more than c1 arrays of size greater than or equal to 1 (\xe2\x89\xa51), no more than c2 arrays of size greater than or equal to 2, \xe2\x80\xa6, no more than ck arrays of size greater than or equal to k. Also, c1\xe2\x89\xa5c2\xe2\x89\xa5\xe2\x8b\xaf\xe2\x89\xa5ck.So now your goal is to create the new testcases in such a way that:   each of the initial arrays appears in exactly one testcase;  for each testcase the given conditions hold;  the number of testcases is minimum possible. Print the minimum possible number of testcases you can achieve and the sizes of arrays included in each testcase." 1900
1342C "Yet Another Counting Problem" "math,number theory" "You are given two integers a and b, and q queries. The i-th query consists of two numbers li and ri, and the answer to it is the number of integers x such that li\xe2\x89\xa4x\xe2\x89\xa4ri, and ((xmoda)modb)\xe2\x89\xa0((xmodb)moda). Calculate the answer for each query.Recall that ymodz is the remainder of the division of y by z. For example, 5mod3=2, 7mod8=7, 9mod4=1, 9mod9=0." 1600
1342B "Binary Period" "constructive algorithms,strings" "Let\'s say string s has period k if si=si+k for all i from 1 to |s|\xe2\x88\x92k (|s| means length of string s) and k is the minimum positive integer with this property.Some examples of a period: for s=""0101"" the period is k=2, for s=""0000"" the period is k=1, for s=""010"" the period is k=2, for s=""0011"" the period is k=4.You are given string t consisting only of 0\'s and 1\'s and you need to find such string s that:  String s consists only of 0\'s and 1\'s;  The length of s doesn\'t exceed 2\xe2\x8b\x85|t|;  String t is a subsequence of string s;  String s has smallest possible period among all strings that meet conditions 1\xe2\x80\x943. Let us recall that t is a subsequence of s if t can be derived from s by deleting zero or more elements (any) without changing the order of the remaining elements. For example, t=""011"" is a subsequence of s=""10101""." 1100
1342A "Road To Zero" greedy,math "You are given two integers x and y. You can perform two types of operations:   Pay a dollars and increase or decrease any of these integers by 1. For example, if x=0 and y=7 there are four possible outcomes after this operation:   x=0, y=6;  x=0, y=8;  x=\xe2\x88\x921, y=7;  x=1, y=7.   Pay b dollars and increase or decrease both integers by 1. For example, if x=0 and y=7 there are two possible outcomes after this operation:   x=\xe2\x88\x921, y=6;  x=1, y=8.  Your goal is to make both given integers equal zero simultaneously, i.e. x=y=0. There are no other requirements. In particular, it is possible to move from x=1, y=0 to x=y=0.Calculate the minimum amount of dollars you have to spend on it." 1000
1341B "Nastya and Door" greedy,implementation "On February 14 Denis decided to give Valentine to Nastya and did not come up with anything better than to draw a huge red heart on the door of the length k (k\xe2\x89\xa53). Nastya was very confused by this present, so she decided to break the door, throwing it on the mountains.Mountains are described by a sequence of heights a1,a2,\xe2\x80\xa6,an in order from left to right (k\xe2\x89\xa4n). It is guaranteed that neighboring heights are not equal to each other (that is, ai\xe2\x89\xa0ai+1 for all i from 1 to n\xe2\x88\x921).Peaks of mountains on the segment [l,r] (from l to r) are called indexes i such that l<i<r, ai\xe2\x88\x921<ai and ai>ai+1. It is worth noting that the boundary indexes l and r for the segment are not peaks. For example, if n=8 and a=[3,1,4,1,5,9,2,6], then the segment [1,8] has only two peaks (with indexes 3 and 6), and there are no peaks on the segment [3,6].To break the door, Nastya throws it to a segment [l,l+k\xe2\x88\x921] of consecutive mountains of length k (1\xe2\x89\xa4l\xe2\x89\xa4n\xe2\x88\x92k+1). When the door touches the peaks of the mountains, it breaks into two parts, after that these parts will continue to fall in different halves and also break into pieces when touching the peaks of the mountains, and so on. Formally, the number of parts that the door will break into will be equal to p+1, where p is the number of peaks on the segment [l,l+k\xe2\x88\x921].Nastya wants to break it into as many pieces as possible. Help her choose such a segment of mountains [l,l+k\xe2\x88\x921] that the number of peaks on it is maximum. If there are several optimal segments, Nastya wants to find one for which the value l is minimal.Formally, you need to choose a segment of mountains [l,l+k\xe2\x88\x921] that has the maximum number of peaks. Among all such segments, you need to find the segment that has the minimum possible value l." 1300
1341A "Nastya and Rice" math "Nastya just made a huge mistake and dropped a whole package of rice on the floor. Mom will come soon. If she sees this, then Nastya will be punished.In total, Nastya dropped n grains. Nastya read that each grain weighs some integer number of grams from a\xe2\x88\x92b to a+b, inclusive (numbers a and b are known), and the whole package of n grains weighs from c\xe2\x88\x92d to c+d grams, inclusive (numbers c and d are known). The weight of the package is the sum of the weights of all n grains in it.Help Nastya understand if this information can be correct. In other words, check whether each grain can have such a mass that the i-th grain weighs some integer number xi (a\xe2\x88\x92b\xe2\x89\xa4xi\xe2\x89\xa4a+b), and in total they weigh from c\xe2\x88\x92d to c+d, inclusive (c\xe2\x88\x92d\xe2\x89\xa4n\xe2\x88\x91i=1xi\xe2\x89\xa4c+d)." 900
1340F "Nastya and CBS" "brute force,data structures,hashing" "Nastya is a competitive programmer, but she is only studying now. Recently, Denis told her about the way to check if the string is correct bracket sequence. After that, unexpectedly, Nastya came up with a much more complex problem that Denis couldn\'t solve. Can you solve it? A string s is given. It consists of k kinds of pairs of brackets. Each bracket has the form t  \xe2\x80\x94 it is an integer, such that 1\xe2\x89\xa4|t|\xe2\x89\xa4k. If the bracket has a form t, then:   If t>0, then it\'s an opening bracket of the type t.  If t<0, then it\'s a closing bracket of the type \xe2\x88\x92t. Thus, there are k types of pairs of brackets in total. The queries need to be answered:   Replace the bracket at position i with the bracket of the form t.  Check if the substring from the l-th to r-th position (including) is the correct bracket sequence.  Recall the definition of the correct bracket sequence:   An empty sequence is correct.   If A and B are two correct bracket sequences, then their concatenation ""A B"" is also correct bracket sequence.   If A is the correct bracket sequence, c (1\xe2\x89\xa4c\xe2\x89\xa4k) is a type of brackets, then the sequence ""c A \xe2\x88\x92c"" is also correct bracket sequence." 3300
1340E "Nastya and Bees" graphs,interactive,probabilities "Unfortunately, a mistake was found in the proof of the author\'s solution to this problem. Currently, we don\'t know the absolutely correct solution. However, you can solve this task, but if your solution passes all the tests, it is not guaranteed to be correct. If your solution has passed all the tests and you are sure that it is correct, you can write to one of the contest authors about it. Surely you all read the book ""Alice in Wonderland"". In this task, Nastya got to the country of Three strange Bees. The bees are strange because their honeycombs are pentagonal. Nastya got there illegally, so she wants bees not to catch her. Help the bees punish the intruder! This is an interactive problem.A beehive is a connected undirected graph where bees and Nastya can move along the edges. A graph satisfies two properties:   The degree of any of its vertex is no more than 3.  For each edge, there exists a cycle of length not greater than 5 passing through this edge.  There are three bees and Nastya. You play for bees. Firstly, you choose the vertices where you put the bees. Then Nastya chooses another vertex in which she will initially appear. One move is first moving the bees, then Nastya, in turn:   For each of your bees, you can either move each one along some edge from the vertex they are currently staying or leave it in place.  Then Nastya will necessarily move along some edge of the graph from the vertex she is currently staying/. You win if at least one of the bees and Nastya are in the same vertex at any time of the game.If this situation does not occur after n moves, then you lose.Several bees can be in the same vertex." 3000
1340D "Nastya and Time Machine" "constructive algorithms,dfs and similar,graphs,trees" "Denis came to Nastya and discovered that she was not happy to see him... There is only one chance that she can become happy. Denis wants to buy all things that Nastya likes so she will certainly agree to talk to him. The map of the city where they live has a lot of squares, some of which are connected by roads. There is exactly one way between each pair of squares which does not visit any vertex twice. It turns out that the graph of the city is a tree.Denis is located at vertex 1 at the time 0. He wants to visit every vertex at least once and get back as soon as possible.Denis can walk one road in 1 time. Unfortunately, the city is so large that it will take a very long time to visit all squares. Therefore, Denis took a desperate step. He pulled out his pocket time machine, which he constructed in his basement. With its help, Denis can change the time to any non-negative time, which is less than the current time.But the time machine has one feature. If the hero finds himself in the same place and at the same time twice, there will be an explosion of universal proportions and Nastya will stay unhappy. Therefore, Denis asks you to find him a route using a time machine that he will get around all squares and will return to the first and at the same time the maximum time in which he visited any square will be minimal.Formally, Denis\'s route can be represented as a sequence of pairs: {v1,t1},{v2,t2},{v3,t3},\xe2\x80\xa6,{vk,tk}, where vi is number of square, and ti is time in which the boy is now.The following conditions must be met:  The route starts on square 1 at time 0, i.e. v1=1,t1=0 and ends on the square 1, i.e. vk=1.  All transitions are divided into two types:   Being in the square change the time: {vi,ti}\xe2\x86\x92{vi+1,ti+1}:vi+1=vi,0\xe2\x89\xa4ti+1<ti.  Walk along one of the roads: {vi,ti}\xe2\x86\x92{vi+1,ti+1}. Herewith, vi and vi+1 are connected by road, and ti+1=ti+1   All pairs {vi,ti} must be different.  All squares are among v1,v2,\xe2\x80\xa6,vk. You need to find a route such that the maximum time in any square will be minimal, that is, the route for which max(t1,t2,\xe2\x80\xa6,tk) will be the minimum possible." 2600
1340C "Nastya and Unexpected Guest" "dfs and similar,dp,graphs,shortest paths" "If the girl doesn\'t go to Denis, then Denis will go to the girl. Using this rule, the young man left home, bought flowers and went to Nastya. On the way from Denis\'s house to the girl\'s house is a road of n lines. This road can\'t be always crossed in one green light. Foreseeing this, the good mayor decided to place safety islands in some parts of the road. Each safety island is located after a line, as well as at the beginning and at the end of the road. Pedestrians can relax on them, gain strength and wait for a green light.Denis came to the edge of the road exactly at the moment when the green light turned on. The boy knows that the traffic light first lights up g seconds green, and then r seconds red, then again g seconds green and so on.Formally, the road can be represented as a segment [0,n]. Initially, Denis is at point 0. His task is to get to point n in the shortest possible time.He knows many different integers d1,d2,\xe2\x80\xa6,dm, where 0\xe2\x89\xa4di\xe2\x89\xa4n  \xe2\x80\x94 are the coordinates of points, in which the safety islands are located. Only at one of these points, the boy can be at a time when the red light is on.Unfortunately, Denis isn\'t always able to control himself because of the excitement, so some restrictions are imposed:  He must always move while the green light is on because it\'s difficult to stand when so beautiful girl is waiting for you. Denis can change his position by \xc2\xb11 in 1 second. While doing so, he must always stay inside the segment [0,n].  He can change his direction only on the safety islands (because it is safe). This means that if in the previous second the boy changed his position by +1 and he walked on a safety island, then he can change his position by \xc2\xb11. Otherwise, he can change his position only by +1. Similarly, if in the previous second he changed his position by \xe2\x88\x921, on a safety island he can change position by \xc2\xb11, and at any other point by \xe2\x88\x921.  At the moment when the red light is on, the boy must be on one of the safety islands. He can continue moving in any direction when the green light is on. Denis has crossed the road as soon as his coordinate becomes equal to n.This task was not so simple, because it\'s possible that it is impossible to cross the road. Since Denis has all thoughts about his love, he couldn\'t solve this problem and asked us to help him. Find the minimal possible time for which he can cross the road according to these rules, or find that it is impossible to do." 2400
1340B "Nastya and Scoreboard" bitmasks,dp,graphs,greedy "Denis, after buying flowers and sweets (you will learn about this story in the next task), went to a date with Nastya to ask her to become a couple. Now, they are sitting in the cafe and finally... Denis asks her to be together, but ... Nastya doesn\'t give any answer. The poor boy was very upset because of that. He was so sad that he punched some kind of scoreboard with numbers. The numbers are displayed in the same way as on an electronic clock: each digit position consists of 7 segments, which can be turned on or off to display different numbers. The picture shows how all 10 decimal digits are displayed:   After the punch, some segments stopped working, that is, some segments might stop glowing if they glowed earlier. But Denis remembered how many sticks were glowing and how many are glowing now. Denis broke exactly k segments and he knows which sticks are working now. Denis came up with the question: what is the maximum possible number that can appear on the board if you turn on exactly k sticks (which are off now)? It is allowed that the number includes leading zeros." 1700
1340A "Nastya and Strange Generator" "brute force,data structures,greedy,implementation" "Denis was very sad after Nastya rejected him. So he decided to walk through the gateways to have some fun. And luck smiled at him! When he entered the first courtyard, he met a strange man who was selling something. Denis bought a mysterious item and it was... Random permutation generator! Denis could not believed his luck.When he arrived home, he began to study how his generator works and learned the algorithm. The process of generating a permutation consists of n steps. At the i-th step, a place is chosen for the number i (1\xe2\x89\xa4i\xe2\x89\xa4n). The position for the number i is defined as follows:  For all j from 1 to n, we calculate rj  \xe2\x80\x94 the minimum index such that j\xe2\x89\xa4rj\xe2\x89\xa4n, and the position rj is not yet occupied in the permutation. If there are no such positions, then we assume that the value of rj is not defined.  For all t from 1 to n, we calculate countt  \xe2\x80\x94 the number of positions 1\xe2\x89\xa4j\xe2\x89\xa4n such that rj is defined and rj=t.  Consider the positions that are still not occupied by permutation and among those we consider the positions for which the value in the count array is maximum.  The generator selects one of these positions for the number i. The generator can choose any position. Let\'s have a look at the operation of the algorithm in the following example:  Let n=5 and the algorithm has already arranged the numbers 1,2,3 in the permutation. Consider how the generator will choose a position for the number 4:  The values of r will be r=[3,3,3,4,\xc3\x97], where \xc3\x97 means an indefinite value.  Then the count values will be count=[0,0,3,1,0].  There are only two unoccupied positions in the permutation: 3 and 4. The value in the count array for position 3 is 3, for position 4 it is 1.  The maximum value is reached only for position 3, so the algorithm will uniquely select this position for number 4. Satisfied with his purchase, Denis went home. For several days without a break, he generated permutations. He believes that he can come up with random permutations no worse than a generator. After that, he wrote out the first permutation that came to mind p1,p2,\xe2\x80\xa6,pn and decided to find out if it could be obtained as a result of the generator.Unfortunately, this task was too difficult for him, and he asked you for help. It is necessary to define whether the written permutation could be obtained using the described algorithm if the generator always selects the position Denis needs." 1500
1339B "Sorted Adjacent Differences" "constructive algorithms,sortings" "You have array of n numbers a1,a2,\xe2\x80\xa6,an. Rearrange these numbers to satisfy |a1\xe2\x88\x92a2|\xe2\x89\xa4|a2\xe2\x88\x92a3|\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4|an\xe2\x88\x921\xe2\x88\x92an|, where |x| denotes absolute value of x. It\'s always possible to find such rearrangement.Note that all numbers in a are not necessarily different. In other words, some numbers of a may be same.You have to answer independent t test cases." 1200
1339A "Filling Diamonds" "brute force,dp,implementation,math" "You have integer n. Calculate how many ways are there to fully cover belt-like area of 4n\xe2\x88\x922 triangles with diamond shapes. Diamond shape consists of two triangles. You can move, rotate or flip the shape, but you cannot scale it. 2 coverings are different if some 2 triangles are covered by the same diamond shape in one of them and by different diamond shapes in the other one.Please look at pictures below for better understanding.  On the left you can see the diamond shape you will use, and on the right you can see the area you want to fill. These are the figures of the area you want to fill for n=1,2,3,4. You have to answer t independent test cases." 900
1338E JYPnation graphs "Due to the success of TWICE, JYP Entertainment has earned countless money and emerged as the biggest entertainment firm by market capitalization. Therefore, the boss, JYP, has decided to create a new nation and has appointed you to provide a design diagram.The new nation consists of n cities and some roads between them. JYP has given some restrictions:  To guarantee efficiency while avoiding chaos, for any 2 different cities A and B, there is exactly one road between them, and it is one-directional. There are no roads connecting a city to itself.  The logo of rivaling companies should not appear in the plan, that is, there does not exist 4 distinct cities A,B,C,D , such that the following configuration occurs.   JYP has given criteria for your diagram. For two cities A,B, let dis(A,B) be the smallest number of roads you have to go through to get from A to B. If it is not possible to walk from A to B, dis(A,B)=614n. Then, the efficiency value is defined to be the sum of dis(A,B) for all ordered pairs of distinct cities (A,B).Note that dis(A,B) doesn\'t have to be equal to dis(B,A).You have drawn a design diagram that satisfies JYP\'s restrictions. Find the sum of dis(A,B) over all ordered pairs of cities (A,B) with A\xe2\x89\xa0B.Note that the input is given in compressed form. But even though it is compressed, you\'d better use fast input." 3500
1338D "Nested Rubber Bands" "constructive algorithms,dfs and similar,dp,math,trees" "You have a tree of n vertices. You are going to convert this tree into n rubber bands on infinitely large plane. Conversion rule follows:  For every pair of vertices a and b, rubber bands a and b should intersect if and only if there is an edge exists between a and b in the tree.  Shape of rubber bands must be a simple loop. In other words, rubber band is a loop which doesn\'t self-intersect. Now let\'s define following things:   Rubber band a includes rubber band b, if and only if rubber band b is in rubber band a\'s area, and they don\'t intersect each other.  Sequence of rubber bands a1,a2,\xe2\x80\xa6,ak (k\xe2\x89\xa52) are nested, if and only if for all i (2\xe2\x89\xa4i\xe2\x89\xa4k), ai\xe2\x88\x921 includes ai.   This is an example of conversion. Note that rubber bands 5 and 6 are nested. It can be proved that is it possible to make a conversion and sequence of nested rubber bands under given constraints.What is the maximum length of sequence of nested rubber bands can be obtained from given tree? Find and print it." 2700
1338C "Perfect Triples" "bitmasks,brute force,constructive algorithms,divide and conquer,math" "Consider the infinite sequence s of positive integers, created by repeating the following steps:  Find the lexicographically smallest triple of positive integers (a,b,c) such that   a\xe2\x8a\x95b\xe2\x8a\x95c=0, where \xe2\x8a\x95 denotes the bitwise XOR operation.  a, b, c are not in s.  Here triple of integers (a1,b1,c1) is considered to be lexicographically smaller than triple (a2,b2,c2) if sequence [a1,b1,c1] is lexicographically smaller than sequence [a2,b2,c2].  Append a, b, c to s in this order.  Go back to the first step. You have integer n. Find the n-th element of s.You have to answer t independent test cases.A sequence a is lexicographically smaller than a sequence b if in the first position where a and b differ, the sequence a has a smaller element than the corresponding element in b." 2200
1338B "Edge Weight Assignment" "bitmasks,constructive algorithms,dfs and similar,greedy,math,trees" "You have unweighted tree of n vertices. You have to assign a positive weight to each edge so that the following condition would hold:  For every two different leaves v1 and v2 of this tree, bitwise XOR of weights of all edges on the simple path between v1 and v2 has to be equal to 0. Note that you can put very large positive integers (like 10(1010)).It\'s guaranteed that such assignment always exists under given constraints. Now let\'s define f as the number of distinct weights in assignment.  In this example, assignment is valid, because bitwise XOR of all edge weights between every pair of leaves is 0. f value is 2 here, because there are 2 distinct edge weights(4 and 5). In this example, assignment is invalid, because bitwise XOR of all edge weights between vertex 1 and vertex 6 (3,4,5,4) is not 0. What are the minimum and the maximum possible values of f for the given tree? Find and print both." 1800
1338A "Powered Addition" greedy,math "You have an array a of length n. For every positive integer x you are going to perform the following operation during the x-th second:  Select some distinct indices i1,i2,\xe2\x80\xa6,ik which are between 1 and n inclusive, and add 2x\xe2\x88\x921 to each corresponding position of a. Formally, aij:=aij+2x\xe2\x88\x921 for j=1,2,\xe2\x80\xa6,k. Note that you are allowed to not select any indices at all. You have to make a nondecreasing as fast as possible. Find the smallest number T such that you can make the array nondecreasing after at most T seconds.Array a is nondecreasing if and only if a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an.You have to answer t independent test cases." 1500
1337B "Kana and Dragon Quest game" greedy,implementation,math "Kana was just an ordinary high school girl before a talent scout discovered her. Then, she became an idol. But different from the stereotype, she is also a gameholic. One day Kana gets interested in a new adventure game called Dragon Quest. In this game, her quest is to beat a dragon. The dragon has a hit point of x initially. When its hit point goes to 0 or under 0, it will be defeated. In order to defeat the dragon, Kana can cast the two following types of spells.  Void Absorption Assume that the dragon\'s current hit point is h, after casting this spell its hit point will become \xe2\x8c\x8ah2\xe2\x8c\x8b+10. Here \xe2\x8c\x8ah2\xe2\x8c\x8b denotes h divided by two, rounded down. Lightning Strike This spell will decrease the dragon\'s hit point by 10. Assume that the dragon\'s current hit point is h, after casting this spell its hit point will be lowered to h\xe2\x88\x9210.Due to some reasons Kana can only cast no more than n Void Absorptions and m Lightning Strikes. She can cast the spells in any order and doesn\'t have to cast all the spells. Kana isn\'t good at math, so you are going to help her to find out whether it is possible to defeat the dragon." 900
1337A "Ichihime and Triangle" "constructive algorithms,math" "Ichihime is the current priestess of the Mahjong Soul Temple. She claims to be human, despite her cat ears.These days the temple is holding a math contest. Usually, Ichihime lacks interest in these things, but this time the prize for the winner is her favorite \xe2\x80\x94 cookies. Ichihime decides to attend the contest. Now she is solving the following problem. You are given four positive integers a, b, c, d, such that a\xe2\x89\xa4b\xe2\x89\xa4c\xe2\x89\xa4d. Your task is to find three integers x, y, z, satisfying the following conditions: a\xe2\x89\xa4x\xe2\x89\xa4b. b\xe2\x89\xa4y\xe2\x89\xa4c. c\xe2\x89\xa4z\xe2\x89\xa4d. There exists a triangle with a positive non-zero area and the lengths of its three sides are x, y, and z.Ichihime desires to get the cookie, but the problem seems too hard for her. Can you help her?" 800
1336F Journey "data structures,divide and conquer,graphs,trees" "In the wilds far beyond lies the Land of Sacredness, which can be viewed as a tree  \xe2\x80\x94 connected undirected graph consisting of n nodes and n\xe2\x88\x921 edges. The nodes are numbered from 1 to n. There are m travelers attracted by its prosperity and beauty. Thereupon, they set off their journey on this land. The i-th traveler will travel along the shortest path from si to ti. In doing so, they will go through all edges in the shortest path from si to ti, which is unique in the tree.During their journey, the travelers will acquaint themselves with the others. Some may even become friends. To be specific, the i-th traveler and the j-th traveler will become friends if and only if there are at least k edges that both the i-th traveler and the j-th traveler will go through. Your task is to find out the number of pairs of travelers (i,j) satisfying the following conditions:   1\xe2\x89\xa4i<j\xe2\x89\xa4m.  the i-th traveler and the j-th traveler will become friends." 3500
1336E2 "Chiori and Doll Picking (hard version)" "bitmasks,brute force,combinatorics,math" "This is the hard version of the problem. The only difference between easy and hard versions is the constraint of m. You can make hacks only if both versions are solved.Chiori loves dolls and now she is going to decorate her bedroom! As a doll collector, Chiori has got n dolls. The i-th doll has a non-negative integer value ai (ai<2m, m is given). Chiori wants to pick some (maybe zero) dolls for the decoration, so there are 2n different picking ways.Let x be the bitwise-xor-sum of values of dolls Chiori picks (in case Chiori picks no dolls x=0). The value of this picking way is equal to the number of 1-bits in the binary representation of x. More formally, it is also equal to the number of indices 0\xe2\x89\xa4i<m, such that \xe2\x8c\x8ax2i\xe2\x8c\x8b is odd.Tell her the number of picking ways with value i for each integer i from 0 to m. Due to the answers can be very huge, print them by modulo 998244353." 3500
1336E1 "Chiori and Doll Picking (easy version)" "bitmasks,brute force,combinatorics,math" "This is the easy version of the problem. The only difference between easy and hard versions is the constraint of m. You can make hacks only if both versions are solved.Chiori loves dolls and now she is going to decorate her bedroom! As a doll collector, Chiori has got n dolls. The i-th doll has a non-negative integer value ai (ai<2m, m is given). Chiori wants to pick some (maybe zero) dolls for the decoration, so there are 2n different picking ways.Let x be the bitwise-xor-sum of values of dolls Chiori picks (in case Chiori picks no dolls x=0). The value of this picking way is equal to the number of 1-bits in the binary representation of x. More formally, it is also equal to the number of indices 0\xe2\x89\xa4i<m, such that \xe2\x8c\x8ax2i\xe2\x8c\x8b is odd.Tell her the number of picking ways with value i for each integer i from 0 to m. Due to the answers can be very huge, print them by modulo 998244353." 2700
1336D "Yui and Mahjong Set" "constructive algorithms,interactive" "This is an interactive problem.Yui is a girl who enjoys playing Mahjong. She has a mysterious set which consists of tiles (this set can be empty). Each tile has an integer value between 1 and n, and at most n tiles in the set have the same value. So the set can contain at most n2 tiles.You want to figure out which values are on the tiles. But Yui is shy, she prefers to play a guessing game with you.Let\'s call a set consisting of three tiles triplet if their values are the same. For example, {2,2,2} is a triplet, but {2,3,3} is not.Let\'s call a set consisting of three tiles straight if their values are consecutive integers. For example, {2,3,4} is a straight, but {1,3,5} is not.At first, Yui gives you the number of triplet subsets and straight subsets of the initial set respectively. After that, you can insert a tile with an integer value between 1 and n into the set at most n times. Every time you insert a tile, you will get the number of triplet subsets and straight subsets of the current set as well.Note that two tiles with the same value are treated different. In other words, in the set {1,1,2,2,3} you can find 4 subsets {1,2,3}.Try to guess the number of tiles in the initial set with value i for all integers i from 1 to n." 3200
1336C "Kaavi and Magic Spell" dp,strings "Kaavi, the mysterious fortune teller, deeply believes that one\'s fate is inevitable and unavoidable. Of course, she makes her living by predicting others\' future. While doing divination, Kaavi believes that magic spells can provide great power for her to see the future.  Kaavi has a string T of length m and all the strings with the prefix T are magic spells. Kaavi also has a string S of length n and an empty string A.During the divination, Kaavi needs to perform a sequence of operations. There are two different operations: Delete the first character of S and add it at the front of A. Delete the first character of S and add it at the back of A.Kaavi can perform no more than n operations. To finish the divination, she wants to know the number of different operation sequences to make A a magic spell (i.e. with the prefix T). As her assistant, can you help her? The answer might be huge, so Kaavi only needs to know the answer modulo 998244353.Two operation sequences are considered different if they are different in length or there exists an i that their i-th operation is different. A substring is a contiguous sequence of characters within a string. A prefix of a string S is a substring of S that occurs at the beginning of S." 2200
1336B "Xenia and Colorful Gems" "binary search,greedy,math,sortings,two pointers" "Xenia is a girl being born a noble. Due to the inflexibility and harshness of her family, Xenia has to find some ways to amuse herself. Recently Xenia has bought nr red gems, ng green gems and nb blue gems. Each of the gems has a weight.Now, she is going to pick three gems.Xenia loves colorful things, so she will pick exactly one gem of each color.Xenia loves balance, so she will try to pick gems with little difference in weight.Specifically, supposing the weights of the picked gems are x, y and z, Xenia wants to find the minimum value of (x\xe2\x88\x92y)2+(y\xe2\x88\x92z)2+(z\xe2\x88\x92x)2. As her dear friend, can you help her?" 1700
1336A "Linova and Kingdom" "dfs and similar,dp,greedy,sortings,trees" "Writing light novels is the most important thing in Linova\'s life. Last night, Linova dreamed about a fantastic kingdom. She began to write a light novel for the kingdom as soon as she woke up, and of course, she is the queen of it. There are n cities and n\xe2\x88\x921 two-way roads connecting pairs of cities in the kingdom. From any city, you can reach any other city by walking through some roads. The cities are numbered from 1 to n, and the city 1 is the capital of the kingdom. So, the kingdom has a tree structure.As the queen, Linova plans to choose exactly k cities developing industry, while the other cities will develop tourism. The capital also can be either industrial or tourism city.A meeting is held in the capital once a year. To attend the meeting, each industry city sends an envoy. All envoys will follow the shortest path from the departure city to the capital (which is unique).Traveling in tourism cities is pleasant. For each envoy, his happiness is equal to the number of tourism cities on his path.In order to be a queen loved by people, Linova wants to choose k cities which can maximize the sum of happinesses of all envoys. Can you calculate the maximum sum for her?" 1600
1335F "Robots on a Grid" "data structures,dfs and similar,dsu,graphs,greedy,matrices" "There is a rectangular grid of size n\xc3\x97m. Each cell of the grid is colored black (\'0\') or white (\'1\'). The color of the cell (i,j) is ci,j. You are also given a map of directions: for each cell, there is a direction si,j which is one of the four characters \'U\', \'R\', \'D\' and \'L\'.  If si,j is \'U\' then there is a transition from the cell (i,j) to the cell (i\xe2\x88\x921,j);  if si,j is \'R\' then there is a transition from the cell (i,j) to the cell (i,j+1);  if si,j is \'D\' then there is a transition from the cell (i,j) to the cell (i+1,j);  if si,j is \'L\' then there is a transition from the cell (i,j) to the cell (i,j\xe2\x88\x921). It is guaranteed that the top row doesn\'t contain characters \'U\', the bottom row doesn\'t contain characters \'D\', the leftmost column doesn\'t contain characters \'L\' and the rightmost column doesn\'t contain characters \'R\'.You want to place some robots in this field (at most one robot in a cell). The following conditions should be satisfied.  Firstly, each robot should move every time (i.e. it cannot skip the move). During one move each robot goes to the adjacent cell depending on the current direction.  Secondly, you have to place robots in such a way that there is no move before which two different robots occupy the same cell (it also means that you cannot place two robots in the same cell). I.e. if the grid is ""RL"" (one row, two columns, colors does not matter there) then you can place two robots in cells (1,1) and (1,2), but if the grid is ""RLL"" then you cannot place robots in cells (1,1) and (1,3) because during the first second both robots will occupy the cell (1,2). The robots make an infinite number of moves.Your task is to place the maximum number of robots to satisfy all the conditions described above and among all such ways, you have to choose one where the number of black cells occupied by robots before all movements is the maximum possible. Note that you can place robots only before all movements.You have to answer t independent test cases." 2200
1335E2 "Three Blocks Palindrome (hard version)" "brute force,data structures,dp,two pointers" "The only difference between easy and hard versions is constraints.You are given a sequence a consisting of n positive integers.Let\'s define a three blocks palindrome as the sequence, consisting of at most two distinct elements (let these elements are a and b, a can be equal b) and is as follows: [a,a,\xe2\x80\xa6,a\xe2\x8f\x9fx,b,b,\xe2\x80\xa6,b\xe2\x8f\x9fy,a,a,\xe2\x80\xa6,a\xe2\x8f\x9fx]. There x,y are integers greater than or equal to 0. For example, sequences [], [2], [1,1], [1,2,1], [1,2,2,1] and [1,1,2,1,1] are three block palindromes but [1,2,3,2,1], [1,2,1,2,1] and [1,2] are not.Your task is to choose the maximum by length subsequence of a that is a three blocks palindrome.You have to answer t independent test cases.Recall that the sequence t is a a subsequence of the sequence s if t can be derived from s by removing zero or more elements without changing the order of the remaining elements. For example, if s=[1,2,1,3,1,2,1], then possible subsequences are: [1,1,1,1], [3] and [1,2,1,3,1,2,1], but not [3,2,3] and [1,1,1,1,2]." 1800
1335E1 "Three Blocks Palindrome (easy version)" "binary search,brute force,data structures,dp,two pointers" "The only difference between easy and hard versions is constraints.You are given a sequence a consisting of n positive integers.Let\'s define a three blocks palindrome as the sequence, consisting of at most two distinct elements (let these elements are a and b, a can be equal b) and is as follows: [a,a,\xe2\x80\xa6,a\xe2\x8f\x9fx,b,b,\xe2\x80\xa6,b\xe2\x8f\x9fy,a,a,\xe2\x80\xa6,a\xe2\x8f\x9fx]. There x,y are integers greater than or equal to 0. For example, sequences [], [2], [1,1], [1,2,1], [1,2,2,1] and [1,1,2,1,1] are three block palindromes but [1,2,3,2,1], [1,2,1,2,1] and [1,2] are not.Your task is to choose the maximum by length subsequence of a that is a three blocks palindrome.You have to answer t independent test cases.Recall that the sequence t is a a subsequence of the sequence s if t can be derived from s by removing zero or more elements without changing the order of the remaining elements. For example, if s=[1,2,1,3,1,2,1], then possible subsequences are: [1,1,1,1], [3] and [1,2,1,3,1,2,1], but not [3,2,3] and [1,1,1,1,2]." 1700
1335D Anti-Sudoku "constructive algorithms,implementation" "You are given a correct solution of the sudoku puzzle. If you don\'t know what is the sudoku, you can read about it here.The picture showing the correct sudoku solution:Blocks are bordered with bold black color.Your task is to change at most 9 elements of this field (i.e. choose some 1\xe2\x89\xa4i,j\xe2\x89\xa49 and change the number at the position (i,j) to any other number in range [1;9]) to make it anti-sudoku. The anti-sudoku is the 9\xc3\x979 field, in which:  Any number in this field is in range [1;9];  each row contains at least two equal elements;  each column contains at least two equal elements;  each 3\xc3\x973 block (you can read what is the block in the link above) contains at least two equal elements. It is guaranteed that the answer exists.You have to answer t independent test cases." 1300
1335C "Two Teams Composing" "binary search,greedy,implementation,sortings" "You have n students under your control and you have to compose exactly two teams consisting of some subset of your students. Each student had his own skill, the i-th student skill is denoted by an integer ai (different students can have the same skills).So, about the teams. Firstly, these two teams should have the same size. Two more constraints:  The first team should consist of students with distinct skills (i.e. all skills in the first team are unique).  The second team should consist of students with the same skills (i.e. all skills in the second team are equal). Note that it is permissible that some student of the first team has the same skill as a student of the second team.Consider some examples (skills are given):  [1,2,3], [4,4] is not a good pair of teams because sizes should be the same;  [1,1,2], [3,3,3] is not a good pair of teams because the first team should not contain students with the same skills;  [1,2,3], [3,4,4] is not a good pair of teams because the second team should contain students with the same skills;  [1,2,3], [3,3,3] is a good pair of teams;  [5], [6] is a good pair of teams. Your task is to find the maximum possible size x for which it is possible to compose a valid pair of teams, where each team size is x (skills in the first team needed to be unique, skills in the second team should be the same between them). A student cannot be part of more than one team.You have to answer t independent test cases." 1100
1335B "Construct the String" "constructive algorithms" "You are given three positive integers n, a and b. You have to construct a string s of length n consisting of lowercase Latin letters such that each substring of length a has exactly b distinct letters. It is guaranteed that the answer exists.You have to answer t independent test cases.Recall that the substring s[l\xe2\x80\xa6r] is the string sl,sl+1,\xe2\x80\xa6,sr and its length is r\xe2\x88\x92l+1. In this problem you are only interested in substrings of length a." 900
1335A "Candies and Two Sisters" math "There are two sisters Alice and Betty. You have n candies. You want to distribute these n candies between two sisters in such a way that:  Alice will get a (a>0) candies;  Betty will get b (b>0) candies;  each sister will get some integer number of candies;  Alice will get a greater amount of candies than Betty (i.e. a>b);  all the candies will be given to one of two sisters (i.e. a+b=n). Your task is to calculate the number of ways to distribute exactly n candies between sisters in a way described above. Candies are indistinguishable.Formally, find the number of ways to represent n as the sum of n=a+b, where a and b are positive integers and a>b.You have to answer t independent test cases." 800
1334G "Substring Search" "bitmasks,brute force,fft" "You are given a permutation p consisting of exactly 26 integers from 1 to 26 (since it is a permutation, each integer from 1 to 26 occurs in p exactly once) and two strings s and t consisting of lowercase Latin letters.A substring t\xe2\x80\xb2 of string t is an occurence of string s if the following conditions are met:  |t\xe2\x80\xb2|=|s|;  for each i\xe2\x88\x88[1,|s|], either si=t\xe2\x80\xb2i, or pidx(si)=idx(t\xe2\x80\xb2i), where idx(c) is the index of character c in Latin alphabet (idx(a)=1, idx(b)=2, idx(z)=26). For example, if p1=2, p2=3, p3=1, s=abc, t=abcaaba, then three substrings of t are occurences of s (they are t\xe2\x80\xb2=abc, t\xe2\x80\xb2=bca and t\xe2\x80\xb2=aba).For each substring of t having length equal to |s|, check if it is an occurence of s." 2900
1334F "Strange Function" "binary search,data structures,dp,greedy" "Let\'s denote the following function f. This function takes an array a of length n and returns an array. Initially the result is an empty array. For each integer i from 1 to n we add element ai to the end of the resulting array if it is greater than all previous elements (more formally, if ai>max1\xe2\x89\xa4j<iaj). Some examples of the function f:  if a=[3,1,2,7,7,3,6,7,8] then f(a)=[3,7,8];  if a=[1] then f(a)=[1];  if a=[4,1,1,2,3] then f(a)=[4];  if a=[1,3,1,2,6,8,7,7,4,11,10] then f(a)=[1,3,6,8,11]. You are given two arrays: array a1,a2,\xe2\x80\xa6,an and array b1,b2,\xe2\x80\xa6,bm. You can delete some elements of array a (possibly zero). To delete the element ai, you have to pay pi coins (the value of pi can be negative, then you get |pi| coins, if you delete this element). Calculate the minimum number of coins (possibly negative) you have to spend for fulfilling equality f(a)=b." 2500
1334E "Divisor Paths" "combinatorics,graphs,greedy,math,number theory" "You are given a positive integer D. Let\'s build the following graph from it:   each vertex is a divisor of D (not necessarily prime, 1 and D itself are also included);  two vertices x and y (x>y) have an undirected edge between them if x is divisible by y and xy is a prime;  the weight of an edge is the number of divisors of x that are not divisors of y. For example, here is the graph for D=12:   Edge (4,12) has weight 3 because 12 has divisors [1,2,3,4,6,12] and 4 has divisors [1,2,4]. Thus, there are 3 divisors of 12 that are not divisors of 4 \xe2\x80\x94 [3,6,12].There is no edge between 3 and 2 because 3 is not divisible by 2. There is no edge between 12 and 3 because 123=4 is not a prime.Let the length of the path between some vertices v and u in the graph be the total weight of edges on it. For example, path [(1,2),(2,6),(6,12),(12,4),(4,2),(2,6)] has length 1+2+2+3+1+2=11. The empty path has length 0.So the shortest path between two vertices v and u is the path that has the minimal possible length.Two paths a and b are different if there is either a different number of edges in them or there is a position i such that ai and bi are different edges.You are given q queries of the following form:   v u \xe2\x80\x94 calculate the number of the shortest paths between vertices v and u. The answer for each query might be large so print it modulo 998244353." 2200
1334D "Minimum Euler Cycle" "constructive algorithms,graphs,greedy,implementation" "You are given a complete directed graph Kn with n vertices: each pair of vertices u\xe2\x89\xa0v in Kn have both directed edges (u,v) and (v,u); there are no self-loops.You should find such a cycle in Kn that visits every directed edge exactly once (allowing for revisiting vertices).We can write such cycle as a list of n(n\xe2\x88\x921)+1 vertices v1,v2,v3,\xe2\x80\xa6,vn(n\xe2\x88\x921)\xe2\x88\x921,vn(n\xe2\x88\x921),vn(n\xe2\x88\x921)+1=v1 \xe2\x80\x94 a visiting order, where each (vi,vi+1) occurs exactly once.Find the lexicographically smallest such cycle. It\'s not hard to prove that the cycle always exists.Since the answer can be too large print its [l,r] segment, in other words, vl,vl+1,\xe2\x80\xa6,vr." 1800
1334C "Circle of Monsters" "brute force,constructive algorithms,greedy,math" "You are playing another computer game, and now you have to slay n monsters. These monsters are standing in a circle, numbered clockwise from 1 to n. Initially, the i-th monster has ai health.You may shoot the monsters to kill them. Each shot requires exactly one bullet and decreases the health of the targeted monster by 1 (deals 1 damage to it). Furthermore, when the health of some monster i becomes 0 or less than 0, it dies and explodes, dealing bi damage to the next monster (monster i+1, if i<n, or monster 1, if i=n). If the next monster is already dead, then nothing happens. If the explosion kills the next monster, it explodes too, damaging the monster after it and possibly triggering another explosion, and so on.You have to calculate the minimum number of bullets you have to fire to kill all n monsters in the circle." 1600
1334B "Middle Class" greedy,sortings "Many years ago Berland was a small country where only n people lived. Each person had some savings: the i-th one had ai burles.The government considered a person as wealthy if he had at least x burles. To increase the number of wealthy people Berland decided to carry out several reforms. Each reform looked like that:   the government chooses some subset of people (maybe all of them);  the government takes all savings from the chosen people and redistributes the savings among the chosen people equally. For example, consider the savings as list [5,1,2,1]: if the government chose the 1-st and the 3-rd persons then it, at first, will take all 5+2=7 burles and after that will return 3.5 burles to the chosen people. As a result, the savings will become [3.5,1,3.5,1].A lot of data was lost from that time, so we don\'t know how many reforms were implemented and to whom. All we can do is ask you to calculate the maximum possible number of wealthy people after several (maybe zero) reforms." 1100
1334A "Level Statistics" implementation,math "Polycarp has recently created a new level in this cool new game Berlio Maker 85 and uploaded it online. Now players from all over the world can try his level.All levels in this game have two stats to them: the number of plays and the number of clears. So when a player attempts the level, the number of plays increases by 1. If he manages to finish the level successfully then the number of clears increases by 1 as well. Note that both of the statistics update at the same time (so if the player finishes the level successfully then the number of plays will increase at the same time as the number of clears).Polycarp is very excited about his level, so he keeps peeking at the stats to know how hard his level turns out to be.So he peeked at the stats n times and wrote down n pairs of integers \xe2\x80\x94 (p1,c1),(p2,c2),\xe2\x80\xa6,(pn,cn), where pi is the number of plays at the i-th moment of time and ci is the number of clears at the same moment of time. The stats are given in chronological order (i.e. the order of given pairs is exactly the same as Polycarp has written down).Between two consecutive moments of time Polycarp peeked at the stats many players (but possibly zero) could attempt the level.Finally, Polycarp wonders if he hasn\'t messed up any records and all the pairs are correct. If there could exist such a sequence of plays (and clears, respectively) that the stats were exactly as Polycarp has written down, then he considers his records correct.Help him to check the correctness of his records.For your convenience you have to answer multiple independent test cases." 1200
1333F "Kate and imperfection" "greedy,implementation,math,number theory,sortings,two pointers" "Kate has a set S of n integers {1,\xe2\x80\xa6,n}. She thinks that imperfection of a subset M\xe2\x8a\x86S is equal to the maximum of gcd(a,b) over all pairs (a,b) such that both a and b are in M and a\xe2\x89\xa0b. Kate is a very neat girl and for each k\xe2\x88\x88{2,\xe2\x80\xa6,n} she wants to find a subset that has the smallest imperfection among all subsets in S of size k. There can be more than one subset with the smallest imperfection and the same size, but you don\'t need to worry about it. Kate wants to find all the subsets herself, but she needs your help to find the smallest possible imperfection for each size k, will name it Ik. Please, help Kate to find I2, I3, ..., In." 2200
