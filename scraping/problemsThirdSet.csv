2037G "Natlan Exploring" "combinatorics,dp,math,number theory" "You are exploring the stunning region of Natlan! This region consists of n cities, and each city is rated with an attractiveness ai. A directed edge exists from City i to City j if and only if i<j and gcd(ai,aj)\xe2\x89\xa01, where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y.Starting from City 1, your task is to determine the total number of distinct paths you can take to reach City n, modulo 998244353. Two paths are different if and only if the set of cities visited is different." -999
2037F "Ardent Flames" "binary search,data structures,sortings,two pointers" "You have obtained the new limited event character Xilonen. You decide to use her in combat.There are n enemies in a line. The i\'th enemy from the left has health hi and is currently at position xi. Xilonen has an attack damage of m, and you are ready to defeat the enemies with her.Xilonen has a powerful ""ground stomp"" attack. Before you perform any attacks, you select an integer p and position Xilonen there (p can be any integer position, including a position with an enemy currently). Afterwards, for each attack, she deals m damage to an enemy at position p (if there are any), m\xe2\x88\x921 damage to enemies at positions p\xe2\x88\x921 and p+1, m\xe2\x88\x922 damage to enemies at positions p\xe2\x88\x922 and p+2, and so on. Enemies that are at least a distance of m away from Xilonen take no damage from attacks.Formally, if there is an enemy at position x, she will deal max(0,m\xe2\x88\x92|p\xe2\x88\x92x|) damage to that enemy each hit. Note that you may not choose a different p for different attacks. Over all possible p, output the minimum number of attacks Xilonen must perform to defeat at least k enemies. If it is impossible to find a p such that eventually at least k enemies will be defeated, output \xe2\x88\x921 instead. Note that an enemy is considered to be defeated if its health reaches 0 or below." -999
2037E "Kachina\'s Favorite Binary String" "greedy,interactive,two pointers" "This is an interactive problem.Kachina challenges you to guess her favorite binary string\xe2\x88\x97 s of length n. She defines f(l,r) as the number of subsequences\xe2\x80\xa0 of 01 in slsl+1\xe2\x80\xa6sr. Two subsequences are considered different if they are formed by deleting characters from different positions in the original string, even if the resulting subsequences consist of the same characters.To determine s, you can ask her some questions. In each question, you can choose two indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n) and ask her for the value of f(l,r).Determine and output s after asking Kachina no more than n questions. However, it may be the case that s is impossible to be determined. In this case, you would need to report IMPOSSIBLE instead.Formally, s is impossible to be determined if after asking n questions, there are always multiple possible strings for s, regardless of what questions are asked. Note that if you report IMPOSSIBLE when there exists a sequence of at most n queries that will uniquely determine the binary string, you will get the Wrong Answer verdict.\xe2\x88\x97A binary string only contains characters 0 and 1.\xe2\x80\xa0A sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) elements. For example, subsequences of 1011101 are 0, 1, 11111, 0111, but not 000 nor 11100." -999
2037D "Sharky Surfing" "data structures,greedy,two pointers" "Mualani loves surfing on her sharky surfboard!Mualani\'s surf path can be modeled by a number line. She starts at position 1, and the path ends at position L. When she is at position x with a jump power of k, she can jump to any integer position in the interval [x,x+k]. Initially, her jump power is 1. However, her surf path isn\'t completely smooth. There are n hurdles on her path. Each hurdle is represented by an interval [l,r], meaning she cannot jump to any position in the interval [l,r]. There are also m power-ups at certain positions on the path. Power-up i is located at position xi and has a value of vi. When Mualani is at position xi, she has the option to collect the power-up to increase her jump power by vi. There may be multiple power-ups at the same position. When she is at a position with some power-ups, she may choose to take or ignore each individual power-up. No power-up is in the interval of any hurdle.What is the minimum number of power-ups she must collect to reach position L to finish the path? If it is not possible to finish the surf path, output \xe2\x88\x921." -999
2037C "Superultra\'s Favorite Permutation" "constructive algorithms,greedy,math,number theory" "Superultra, a little red panda, desperately wants primogems. In his dreams, a voice tells him that he must solve the following task to obtain a lifetime supply of primogems. Help Superultra!Construct a permutation\xe2\x88\x97 p of length n such that pi+pi+1 is composite\xe2\x80\xa0 over all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. If it\'s not possible, output \xe2\x88\x921.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).\xe2\x80\xa0An integer x is composite if it has at least one other divisor besides 1 and x. For example, 4 is composite because 2 is a divisor." -999
2037B "Intercepted Inputs" "brute force,implementation" "To help you prepare for your upcoming Codeforces contest, Citlali set a grid problem and is trying to give you a n by m grid through your input stream. Specifically, your input stream should contain the following:  The first line contains two integers n and m \xe2\x80\x94 the dimensions of the grid.  The following n lines contain m integers each \xe2\x80\x94 the values of the grid. However, someone has intercepted your input stream, shuffled all given integers, and put them all on one line! Now, there are k integers all on one line, and you don\'t know where each integer originally belongs. Instead of asking Citlali to resend the input, you decide to determine the values of n and m yourself.Output any possible value of n and m that Citlali could have provided." -999
2037A Twice implementation "Kinich wakes up to the start of a new day. He turns on his phone, checks his mailbox, and finds a mysterious present. He decides to unbox the present.Kinich unboxes an array a with n integers. Initially, Kinich\'s score is 0. He will perform the following operation any number of times:  Select two indices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) such that neither i nor j has been chosen in any previous operation and ai=aj. Then, add 1 to his score. Output the maximum score Kinich can achieve after performing the aforementioned operation any number of times." -999
2036G "Library of Magic" "binary search,constructive algorithms,divide and conquer,interactive,math,number theory" "This is an interactive problem.The Department of Supernatural Phenomena at the Oxenfurt Academy has opened the Library of Magic, which contains the works of the greatest sorcerers of Redania \xe2\x80\x94 n (3\xe2\x89\xa4n\xe2\x89\xa41018) types of books, numbered from 1 to n. Each book\'s type number is indicated on its spine. Moreover, each type of book is stored in the library in exactly two copies! And you have been appointed as the librarian.One night, you wake up to a strange noise and see a creature leaving the building through a window. Three thick tomes of different colors were sticking out of the mysterious thief\'s backpack. Before you start searching for them, you decide to compute the numbers a, b, and c written on the spines of these books. All three numbers are distinct.So, you have an unordered set of tomes, which includes one tome with each of the pairwise distinct numbers a, b, and c, and two tomes for all numbers from 1 to n, except for a, b, and c. You want to find these values a, b, and c.Since you are not working in a simple library, but in the Library of Magic, you can only use one spell in the form of a query to check the presence of books in their place:   ""xor l r"" \xe2\x80\x94 Bitwise XOR query with parameters l and r. Let k be the number of such tomes in the library whose numbers are greater than or equal to l and less than or equal to r. You will receive the result of the computation v1\xe2\x8a\x95v2\xe2\x8a\x95...\xe2\x8a\x95vk, where v1...vk are the numbers on the spines of these tomes, and \xe2\x8a\x95 denotes the operation of bitwise exclusive OR. Since your magical abilities as a librarian are severely limited, you can make no more than 150 queries." 2200
2036F "XORificator 3000" "bitmasks,dp,number theory,two pointers" "Alice has been giving gifts to Bob for many years, and she knows that what he enjoys the most is performing bitwise XOR of interesting integers. Bob considers a positive integer x to be interesting if it satisfies x\xe2\x89\xa2k(mod2i). Therefore, this year for his birthday, she gifted him a super-powerful ""XORificator 3000"", the latest model.Bob was very pleased with the gift, as it allowed him to instantly compute the XOR of all interesting integers in any range from l to r, inclusive. After all, what else does a person need for happiness? Unfortunately, the device was so powerful that at one point it performed XOR with itself and disappeared. Bob was very upset, and to cheer him up, Alice asked you to write your version of the ""XORificator""." 1900
2036E "Reverse the Rivers" "binary search,constructive algorithms,data structures,greedy" "A conspiracy of ancient sages, who decided to redirect rivers for their own convenience, has put the world on the brink. But before implementing their grand plan, they decided to carefully think through their strategy \xe2\x80\x94 that\'s what sages do.There are n countries, each with exactly k regions. For the j-th region of the i-th country, they calculated the value ai,j, which reflects the amount of water in it.The sages intend to create channels between the j-th region of the i-th country and the j-th region of the (i+1)-th country for all 1\xe2\x89\xa4i\xe2\x89\xa4(n\xe2\x88\x921) and for all 1\xe2\x89\xa4j\xe2\x89\xa4k. Since all n countries are on a large slope, water flows towards the country with the highest number. According to the sages\' predictions, after the channel system is created, the new value of the j-th region of the i-th country will be bi,j=a1,j|a2,j|...|ai,j, where | denotes the bitwise ""OR"" operation.After the redistribution of water, the sages aim to choose the most suitable country for living, so they will send you q queries for consideration.Each query will contain m requirements. Each requirement contains three parameters: the region number r, the sign o (either ""<"" or "">""), and the value c. If o = ""<"", then in the r-th region of the country you choose, the new value must be strictly less than the limit c, and if o = "">"", it must be strictly greater.In other words, the chosen country i must satisfy all m requirements. If in the current requirement o = ""<"", then it must hold that bi,r<c, and if o = "">"", then bi,r>c.In response to each query, you should output a single integer \xe2\x80\x94 the number of the suitable country. If there are multiple such countries, output the smallest one. If no such country exists, output \xe2\x88\x921." 1600
2036D "I Love 1543" "brute force,implementation,matrices" "One morning, Polycarp woke up and realized that 1543 is the most favorite number in his life.The first thing that Polycarp saw that day as soon as he opened his eyes was a large wall carpet of size n by m cells; n and m are even integers. Each cell contains one of the digits from 0 to 9.Polycarp became curious about how many times the number 1543 would appear in all layers\xe2\x88\x97 of the carpet when traversed clockwise.\xe2\x88\x97The first layer of a carpet of size n\xc3\x97m is defined as a closed strip of length 2\xe2\x8b\x85(n+m\xe2\x88\x922) and thickness of 1 element, surrounding its outer part. Each subsequent layer is defined as the first layer of the carpet obtained by removing all previous layers from the original carpet." 1300
2036C "Anya and 1100" "brute force,implementation" "While rummaging through things in a distant drawer, Anya found a beautiful string s consisting only of zeros and ones.Now she wants to make it even more beautiful by performing q operations on it.Each operation is described by two integers i (1\xe2\x89\xa4i\xe2\x89\xa4|s|) and v (v\xe2\x88\x88{0,1}) and means that the i-th character of the string is assigned the value v (that is, the assignment si=v is performed).But Anya loves the number 1100, so after each query, she asks you to tell her whether the substring ""1100"" is present in her string (i.e. there exist such 1\xe2\x89\xa4i\xe2\x89\xa4|s|\xe2\x88\x923 that sisi+1si+2si+3=1100)." 1100
2036B Startup greedy,sortings "Arseniy came up with another business plan \xe2\x80\x94 to sell soda from a vending machine! For this, he purchased a machine with n shelves, as well as k bottles, where the i-th bottle is characterized by the brand index bi and the cost ci. You can place any number of bottles on each shelf, but all bottles on the same shelf must be of the same brand.Arseniy knows that all the bottles he puts on the shelves of the machine will be sold. Therefore, he asked you to calculate the maximum amount he can earn." 800
2036A Quintomania implementation "Boris Notkin composes melodies. He represents them as a sequence of notes, where each note is encoded as an integer from 0 to 127 inclusive. The interval between two notes a and b is equal to |a\xe2\x88\x92b| semitones.Boris considers a melody perfect if the interval between each two adjacent notes is either 5 semitones or 7 semitones.After composing his latest melodies, he enthusiastically shows you his collection of works. Help Boris Notkin understand whether his melodies are perfect." 800
2035H "Peak Productivity Forces" "constructive algorithms" "I\'m peakly productive and this is deep.You are given two permutations\xe2\x88\x97 a and b, both of length n.You can perform the following three-step operation on permutation a:  Choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n). Cyclic shift a1,a2,\xe2\x80\xa6,ai\xe2\x88\x921 by 1 to the right. If you had chosen i=1, then this range doesn\'t exist, and you cyclic shift nothing. Cyclic shift ai+1,ai+2,\xe2\x80\xa6,an by 1 to the right. If you had chosen i=n, then this range doesn\'t exist, and you cyclic shift nothing.After the operation, a1,a2,\xe2\x80\xa6,ai\xe2\x88\x922,ai\xe2\x88\x921,ai,ai+1,ai+2,\xe2\x80\xa6,an\xe2\x88\x921,an is transformed into ai\xe2\x88\x921,a1,\xe2\x80\xa6,ai\xe2\x88\x923,ai\xe2\x88\x922,ai,an,ai+1,\xe2\x80\xa6,an\xe2\x88\x922,an\xe2\x88\x921.Here are some examples of operations done on the identity permutation [1,2,3,4,5,6,7] of length 7:   If we choose i=3, it will become [2,1,3,7,4,5,6].  If we choose i=1, it will become [1,7,2,3,4,5,6].  If we choose i=7, it will become [6,1,2,3,4,5,7].  Notably, position i is not shifted. Find a construction using at most 2n operations to make a equal to b or print \xe2\x88\x921 if it is impossible. The number of operations does not need to be minimized. It can be shown that if it is possible to make a equal to b, it is possible to do this within 2n operations. \xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 3500
2035G2 "Go Learn! (Hard Version)" "divide and conquer,dp" "The differences between the easy and hard versions are the constraints on n and the sum of n. In this version, n\xe2\x89\xa43\xe2\x8b\x85105 and the sum of n does not exceed 106. You can only make hacks if both versions are solved. Well, well, well, let\'s see how Bessie is managing her finances. She seems to be in the trenches! Fortunately, she is applying for a job at Moogle to resolve this issue. Moogle interviews require intensive knowledge of obscure algorithms and complex data structures, but Bessie received a tip-off from an LGM on exactly what she has to go learn.Bessie wrote the following code to binary search for a certain element k in a possibly unsorted array [a1,a2,\xe2\x80\xa6,an] with n elements.let l = 1let h = nwhile l < h:  let m = floor((l + h) / 2)  if a[m] < k:    l = m + 1  else:    h = mreturn lBessie submitted her code to Farmer John\'s problem with m (1\xe2\x89\xa4m\xe2\x89\xa4n) tests. The i-th test is of the form (xi,ki) (1\xe2\x89\xa4x,k\xe2\x89\xa4n). It is guaranteed all the xi are distinct and all the ki are distinct.Test i is correct if the following hold:  The xi-th element in the array is ki.  If Bessie calls the binary search as shown in the above code for ki, it will return xi. It might not be possible for all m tests to be correct on the same array, so Farmer John will remove some of them so Bessie can AC. Let r be the minimum of tests removed so that there exists an array [a1,a2,\xe2\x80\xa6,an] with 1\xe2\x89\xa4ai\xe2\x89\xa4n so that all remaining tests are correct. In addition to finding r, Farmer John wants you to count the number of arrays [a1,a2,\xe2\x80\xa6,an] with 1\xe2\x89\xa4ai\xe2\x89\xa4n such that there exists a way to remove exactly r tests so that all the remaining tests are correct. Since this number may be very large, please find it modulo 998244353." 3500
2035G1 "Go Learn! (Easy Version)" dp,trees "The differences between the easy and hard versions are the constraints on n and the sum of n. In this version, n\xe2\x89\xa43000 and the sum of n does not exceed 104. You can only make hacks if both versions are solved. Well, well, well, let\'s see how Bessie is managing her finances. She seems to be in the trenches! Fortunately, she is applying for a job at Moogle to resolve this issue. Moogle interviews require intensive knowledge of obscure algorithms and complex data structures, but Bessie received a tip-off from an LGM on exactly what she has to go learn.Bessie wrote the following code to binary search for a certain element k in a possibly unsorted array [a1,a2,\xe2\x80\xa6,an] with n elements.let l = 1let h = nwhile l < h:  let m = floor((l + h) / 2)  if a[m] < k:    l = m + 1  else:    h = mreturn lBessie submitted her code to Farmer John\'s problem with m (1\xe2\x89\xa4m\xe2\x89\xa4n) tests. The i-th test is of the form (xi,ki) (1\xe2\x89\xa4x,k\xe2\x89\xa4n). It is guaranteed all the xi are distinct and all the ki are distinct.Test i is correct if the following hold:  The xi-th element in the array is ki.  If Bessie calls the binary search as shown in the above code for ki, it will return xi. It might not be possible for all m tests to be correct on the same array, so Farmer John will remove some of them so Bessie can AC. Let r be the minimum of tests removed so that there exists an array [a1,a2,\xe2\x80\xa6,an] with 1\xe2\x89\xa4ai\xe2\x89\xa4n so that all remaining tests are correct. In addition to finding r, Farmer John wants you to count the number of arrays [a1,a2,\xe2\x80\xa6,an] with 1\xe2\x89\xa4ai\xe2\x89\xa4n such that there exists a way to remove exactly r tests so that all the remaining tests are correct. Since this number may be very large, please find it modulo 998244353." 3300
2035F "Tree Operations" "binary search,brute force,dfs and similar,dp,trees" "This really says a lot about our society.One day, a turtle gives you a tree with n nodes rooted at node x. Each node has an initial nonnegative value; the i-th node has starting value ai.You want to make the values of all nodes equal to 0. To do so, you will perform a series of operations on the tree, where each operation will be performed on a certain node. Define an operation on node u as choosing a single node in u\'s subtree\xe2\x88\x97 and incrementing or decrementing its value by 1. The order in which operations are performed on nodes is as follows:  For 1\xe2\x89\xa4i\xe2\x89\xa4n, the i-th operation will be performed on node i.  For i>n, the i-th operation will be performed on the same node as operation i\xe2\x88\x92n. More formally, the i-th operation will be performed on the (((i\xe2\x88\x921)modn)+1)-th node.\xe2\x80\xa0Note that you cannot skip over operations; that is, you cannot perform the i-th operation without first performing operations 1,2,\xe2\x80\xa6,i\xe2\x88\x921.Find the minimum number of operations you must perform before you can make the values of all nodes equal to 0, assuming you pick operations optimally. If it\'s impossible to make the values of all nodes equal to 0 after finite operations, output \xe2\x88\x921.\xe2\x88\x97The subtree of a node u is the set of nodes for which u lies on the shortest path from this node to the root, including u itself.\xe2\x80\xa0Here, amodb denotes the remainder from dividing a by b." 2500
2035E Monster "binary search,brute force,constructive algorithms,greedy,implementation,math,ternary search" "Man, this Genshin boss is so hard. Good thing they have a top-up of 6 coins for only $4.99. I should be careful and spend no more than I need to, lest my mom catches me...You are fighting a monster with z health using a weapon with d damage. Initially, d=0. You can perform the following operations.  Increase d \xe2\x80\x94 the damage of your weapon by 1, costing x coins.  Attack the monster, dealing d damage and costing y coins. You cannot perform the first operation for more than k times in a row.Find the minimum number of coins needed to defeat the monster by dealing at least z damage." 2300
2035D "Yet Another Real Number Problem" "binary search,data structures,divide and conquer,greedy,implementation,math" "Three r there are\'s in strawberry.You are given an array b of length m. You can perform the following operation any number of times (possibly zero):   Choose two distinct indices i and j where 1\xe2\x89\xa4i<j\xe2\x89\xa4m and bi is even, divide bi by 2 and multiply bj by 2.  Your task is to maximize the sum of the array after performing any number of such operations. Since it could be large, output this sum modulo 109+7.Since this problem is too easy, you are given an array a of length n and need to solve the problem for each prefix of a.In other words, denoting the maximum sum of b after performing any number of such operations as f(b), you need to output f([a1]), f([a1,a2]), \xe2\x80\xa6, f([a1,a2,\xe2\x80\xa6,an]) modulo 109+7 respectively." 1800
2035C "Alya and Permutation" "bitmasks,constructive algorithms,math" "Alya has been given a hard problem. Unfortunately, she is too busy running for student council. Please solve this problem for her.Given an integer n, construct a permutation p of integers 1,2,\xe2\x80\xa6,n that maximizes the value of k (which is initially 0) after the following process.Perform n operations, on the i-th operation (i=1,2,\xe2\x80\xa6,n),  If i is odd, k=k&pi, where & denotes the bitwise AND operation.  If i is even, k=k|pi, where | denotes the bitwise OR operation." 1400
2035B "Everyone Loves Tres" "constructive algorithms,greedy,math,number theory" "There are 3 heroes and 3 villains, so 6 people in total.Given a positive integer n. Find the smallest integer whose decimal representation has length n and consists only of 3s and 6s such that it is divisible by both 33 and 66. If no such integer exists, print \xe2\x88\x921." 900
2035A Sliding implementation,math "Red was ejected. They were not the imposter.There are n rows of m people. Let the position in the r-th row and the c-th column be denoted by (r,c). Number each person starting from 1 in row-major order, i.e., the person numbered (r\xe2\x88\x921)\xe2\x8b\x85m+c is initially at (r,c).The person at (r,c) decides to leave. To fill the gap, let the person who left be numbered i. Each person numbered j>i will move to the position where the person numbered j\xe2\x88\x921 is initially at. The following diagram illustrates the case where n=2, m=3, r=1, and c=2.   Calculate the sum of the Manhattan distances of each person\'s movement. If a person was initially at (r0,c0) and then moved to (r1,c1), the Manhattan distance is |r0\xe2\x88\x92r1|+|c0\xe2\x88\x92c1|." 800
2033G "Sakurako and Chefir" "data structures,dfs and similar,dp,greedy,trees" "Given a tree with n vertices rooted at vertex 1. While walking through it with her cat Chefir, Sakurako got distracted, and Chefir ran away.To help Sakurako, Kosuke recorded his q guesses. In the i-th guess, he assumes that Chefir got lost at vertex vi and had ki stamina.Also, for each guess, Kosuke assumes that Chefir could move along the edges an arbitrary number of times:  from vertex a to vertex b, if a is an ancestor\xe2\x88\x97 of b, the stamina will not change;  from vertex a to vertex b, if a is not an ancestor of b, then Chefir\'s stamina decreases by 1. If Chefir\'s stamina is 0, he cannot make a move of the second type.For each assumption, your task is to find the distance to the farthest vertex that Chefir could reach from vertex vi, having ki stamina.\xe2\x88\x97Vertex a is an ancestor of vertex b if the shortest path from b to the root passes through a." 2200
2033F "Kosuke\'s Sloth" "brute force,math,number theory" "Kosuke is too lazy. He will not give you any legend, just the task:Fibonacci numbers are defined as follows:  f(1)=f(2)=1.  f(n)=f(n\xe2\x88\x921)+f(n\xe2\x88\x922) (3\xe2\x89\xa4n)  We denote G(n,k) as an index of the n-th Fibonacci number that is divisible by k. For given n and k, compute G(n,k).As this number can be too big, output it by modulo 109+7.For example: G(3,2)=9 because the 3-rd Fibonacci number that is divisible by 2 is 34. [1,1,2,3,5,8,13,21,34]." 1800
2033E "Sakurako, Kosuke, and the Permutation" "brute force,data structures,dfs and similar,dsu,graphs,greedy,math" "Sakurako\'s exams are over, and she did excellently. As a reward, she received a permutation p. Kosuke was not entirely satisfied because he failed one exam and did not receive a gift. He decided to sneak into her room (thanks to the code for her lock) and spoil the permutation so that it becomes simple.A permutation p is considered simple if for every i (1\xe2\x89\xa4i\xe2\x89\xa4n) one of the following conditions holds:  pi=i  ppi=i For example, the permutations [1,2,3,4], [5,2,4,3,1], and [2,1] are simple, while [2,3,1] and [5,2,1,4,3] are not.In one operation, Kosuke can choose indices i,j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) and swap the elements pi and pj.Sakurako is about to return home. Your task is to calculate the minimum number of operations that Kosuke needs to perform to make the permutation simple." 1400
2033D "Kousuke\'s Assignment" "data structures,dp,dsu,greedy,math" "After a trip with Sakurako, Kousuke was very scared because he forgot about his programming assignment. In this assignment, the teacher gave him an array a of n integers and asked him to calculate the number of non-overlapping segments of the array a, such that each segment is considered beautiful.A segment [l,r] is considered beautiful if al+al+1+\xe2\x8b\xaf+ar\xe2\x88\x921+ar=0.For a fixed array a, your task is to compute the maximum number of non-overlapping beautiful segments." 1300
2033C "Sakurako\'s Field Trip" "dp,greedy,two pointers" "Even in university, students need to relax. That is why Sakurakos teacher decided to go on a field trip. It is known that all of the students will be walking in one line. The student with index i has some topic of interest which is described as ai. As a teacher, you want to minimise the disturbance of the line of students.The disturbance of the line is defined as the number of neighbouring people with the same topic of interest. In other words, disturbance is the number of indices j (1\xe2\x89\xa4j<n) such that aj=aj+1.In order to do this, you can choose index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and swap students at positions i and n\xe2\x88\x92i+1. You can perform any number of swaps.Your task is to determine the minimal amount of disturbance that you can achieve by doing the operation described above any number of times." 1400
2033B "Sakurako and Water" "brute force,constructive algorithms,greedy" "During her journey with Kosuke, Sakurako and Kosuke found a valley that can be represented as a matrix of size n\xc3\x97n, where at the intersection of the i-th row and the j-th column is a mountain with a height of ai,j. If ai,j<0, then there is a lake there.Kosuke is very afraid of water, so Sakurako needs to help him:  With her magic, she can select a square area of mountains and increase the height of each mountain on the main diagonal of that area by exactly one. More formally, she can choose a submatrix with the upper left corner located at (i,j) and the lower right corner at (p,q), such that p\xe2\x88\x92i=q\xe2\x88\x92j. She can then add one to each element at the intersection of the (i+k)-th row and the (j+k)-th column, for all k such that 0\xe2\x89\xa4k\xe2\x89\xa4p\xe2\x88\x92i.Determine the minimum number of times Sakurako must use her magic so that there are no lakes." 900
2033A "Sakurako and Kosuke" "constructive algorithms,implementation,math" "Sakurako and Kosuke decided to play some games with a dot on a coordinate line. The dot is currently located in position x=0. They will be taking turns, and Sakurako will be the one to start. On the i-th move, the current player will move the dot in some direction by 2\xe2\x8b\x85i\xe2\x88\x921 units. Sakurako will always be moving the dot in the negative direction, whereas Kosuke will always move it in the positive direction. In other words, the following will happen:  Sakurako will change the position of the dot by \xe2\x88\x921, x=\xe2\x88\x921 now  Kosuke will change the position of the dot by 3, x=2 now  Sakurako will change the position of the dot by \xe2\x88\x925, x=\xe2\x88\x923 now  \xe2\x8b\xaf They will keep on playing while the absolute value of the coordinate of the dot does not exceed n. More formally, the game continues while \xe2\x88\x92n\xe2\x89\xa4x\xe2\x89\xa4n. It can be proven that the game will always end.Your task is to determine who will be the one who makes the last turn." 800
2032F Peanuts combinatorics,dp,games,math "Having the magical beanstalk, Jack has been gathering a lot of peanuts lately. Eventually, he has obtained n pockets of peanuts, conveniently numbered 1 to n from left to right. The i-th pocket has ai peanuts.Jack and his childhood friend Alice decide to play a game around the peanuts. First, Alice divides the pockets into some boxes; each box will have a non-zero number of consecutive pockets, and each pocket will, obviously, belong to exactly one box. At the same time, Alice does not change the order of the boxes, that is, the boxes are numbered in ascending order of the indices of the pockets in them.After that, Alice and Jack will take turns alternately, with Alice going first.At each turn, the current player will remove a positive number of peanuts from exactly one pocket which belongs to the leftmost non-empty box (i.e., the leftmost box containing at least one non-empty pocket). In other words, if we number the boxes from left to right, then each player can only pick peanuts from the pocket in the j-th box (j\xe2\x89\xa52) only if the (j\xe2\x88\x921)-th box has no peanuts left. The player who cannot make a valid move loses.Alice is sure she will win since she has the advantage of dividing the pockets into boxes herself. Thus, she wanted to know how many ways there are for her to divide the peanuts into boxes at the start of the game so that she will win, assuming both players play optimally. Can you help her with the calculation?As the result can be very large, output it modulo 998244353." 2700
2032E Balanced "constructive algorithms,data structures,greedy,implementation,math" "You are given a cyclic array a with n elements, where n is odd. In each operation, you can do the following:  Choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n and increase ai\xe2\x88\x921 by 1, ai by 2, and ai+1 by 1. The element before the first element is the last element because this is a cyclic array. A cyclic array is called balanced if all its elements are equal to each other.Find any sequence of operations to make this cyclic array balanced or determine that it is impossible. Please note that you do not have to minimize the number of operations." 2400
2032D Genokraken "constructive algorithms,data structures,graphs,greedy,implementation,interactive,trees,two pointers" "This is an interactive problem.Upon clearing the Waterside Area, Gretel has found a monster named Genokraken, and she\'s keeping it contained for her scientific studies.The monster\'s nerve system can be structured as a tree\xe2\x80\xa0 of n nodes (really, everything should stop resembling trees all the time\xe2\x80\xa6), numbered from 0 to n\xe2\x88\x921, with node 0 as the root.Gretel\'s objective is to learn the exact structure of the monster\'s nerve system \xe2\x80\x94 more specifically, she wants to know the values p1,p2,\xe2\x80\xa6,pn\xe2\x88\x921 of the tree, where pi (0\xe2\x89\xa4pi<i) is the direct parent node of node i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).She doesn\'t know exactly how the nodes are placed, but she knows a few convenient facts:  If we remove root node 0 and all adjacent edges, this tree will turn into a forest consisting of only paths\xe2\x80\xa1. Each node that was initially adjacent to the node 0 will be the end of some path.  The nodes are indexed in a way that if 1\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4n\xe2\x88\x921, then px\xe2\x89\xa4py.  Node 1 has exactly two adjacent nodes (including the node 0).  The tree in this picture does not satisfy the condition, because if we remove node 0, then node 2 (which was initially adjacent to the node 0) will not be the end of the path 4\xe2\x88\x922\xe2\x88\x925.The tree in this picture does not satisfy the condition, because p3\xe2\x89\xa4p4 must hold.The tree in this picture does not satisfy the condition, because node 1 has only one adjacent node. Gretel can make queries to the containment cell:  ""? a b"" (1\xe2\x89\xa4a,b<n, a\xe2\x89\xa0b) \xe2\x80\x94 the cell will check if the simple path between nodes a and b contains the node 0. However, to avoid unexpected consequences by overstimulating the creature, Gretel wants to query at most 2n\xe2\x88\x926 times. Though Gretel is gifted, she can\'t do everything all at once, so can you give her a helping hand?\xe2\x80\xa0A tree is a connected graph where every pair of distinct nodes has exactly one simple path connecting them.\xe2\x80\xa1A path is a tree whose vertices can be listed in the order v1,v2,\xe2\x80\xa6,vk such that the edges are (vi,vi+1) (1\xe2\x89\xa4i<k)." 1800
2032C Trinity "binary search,math,sortings,two pointers" "You are given an array a of n elements a1,a2,\xe2\x80\xa6,an.You can perform the following operation any number (possibly 0) of times:  Choose two integers i and j, where 1\xe2\x89\xa4i,j\xe2\x89\xa4n, and assign ai:=aj. Find the minimum number of operations required to make the array a satisfy the condition:  For every pairwise distinct triplet of indices (x,y,z) (1\xe2\x89\xa4x,y,z\xe2\x89\xa4n, x\xe2\x89\xa0y, y\xe2\x89\xa0z, x\xe2\x89\xa0z), there exists a non-degenerate triangle with side lengths ax, ay and az, i.e. ax+ay>az, ay+az>ax and az+ax>ay." 1400
2032B Medians "constructive algorithms,greedy,implementation,math" "You are given an array a=[1,2,\xe2\x80\xa6,n], where n is odd, and an integer k.Your task is to choose an odd positive integer m and to split a into m subarrays\xe2\x80\xa0 b1,b2,\xe2\x80\xa6,bm such that:  Each element of the array a belongs to exactly one subarray.  For all 1\xe2\x89\xa4i\xe2\x89\xa4m, |bi| is odd, i.e., the length of each subarray is odd.  median([median(b1),median(b2),\xe2\x80\xa6,median(bm)])=k, i.e., the median\xe2\x80\xa1 of the array of medians of all subarrays must equal k. median(c) denotes the median of the array c. \xe2\x80\xa0A subarray of the array a of length n is the array [al,al+1,\xe2\x80\xa6,ar] for some integers 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n.\xe2\x80\xa1A median of the array of odd length is the middle element after the array is sorted in non-decreasing order. For example: median([1,2,5,4,3])=3, median([3,2,1])=2, median([2,1,2,1,2,2,2])=2." 1100
2032A Circuit "greedy,implementation,math,number theory" "Alice has just crafted a circuit with n lights and 2n switches. Each component (a light or a switch) has two states: on or off. The lights and switches are arranged in a way that:  Each light is connected to exactly two switches.  Each switch is connected to exactly one light. It\'s unknown which light each switch is connected to.  When all switches are off, all lights are also off.  If a switch is toggled (from on to off, or vice versa), the state of the light connected to it will also toggle. Alice brings the circuit, which shows only the states of the 2n switches, to her sister Iris and gives her a riddle: what is the minimum and maximum number of lights that can be turned on?Knowing her little sister\'s antics too well, Iris takes no more than a second to give Alice a correct answer. Can you do the same?" 800
2031F "Penchick and Even Medians" "binary search,constructive algorithms,interactive,probabilities" "This is an interactive problem. Returning from a restful vacation on Australia\'s Gold Coast, Penchick forgot to bring home gifts for his pet duck Duong Canh! But perhaps a beautiful problem crafted through deep thought on the scenic beaches could be the perfect souvenir.There is a hidden permutation\xe2\x88\x97 p of length n, where n is even. You are allowed to make the following query:  Choose a subsequence\xe2\x80\xa0 of the permutation p with even length 4\xe2\x89\xa4k\xe2\x89\xa4n. The interactor will return the value of the two medians\xe2\x80\xa1 in the chosen subsequence. Find the index of the two medians in permutation p using at most 80 queries.Note that the interactor is non-adaptive. This means that the permutation p is fixed at the beginning and will not change based on your queries.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array). \xe2\x80\xa0A sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) element from arbitrary positions. \xe2\x80\xa1The two medians of an array a with even length k are defined as the k2-th and (k2+1)-th smallest element in the array (1-indexed)." -999
2031E "Penchick and Chloe\'s Trees" "binary search,constructive algorithms,data structures,dfs and similar,dp,greedy,math,sortings,trees" "With just a few hours left until Penchick and Chloe leave for Singapore, they could hardly wait to see the towering trees at the Singapore Botanic Gardens! Attempting to contain their excitement, Penchick crafted a rooted tree to keep Chloe and himself busy.Penchick has a rooted tree\xe2\x88\x97 consisting of n vertices, numbered from 1 to n, with vertex 1 as the root, and Chloe can select a non-negative integer d to create a perfect binary tree\xe2\x80\xa0 of depth d.Since Penchick and Chloe are good friends, Chloe wants her tree to be isomorphic\xe2\x80\xa1 to Penchick\'s tree. To meet this condition, Chloe can perform the following operation on her own tree any number of times:  Select an edge (u,v), where u is the parent of v.  Remove vertex v and all the edges connected to v, then connect all of v\'s previous children directly to u. In particular, doing an operation on an edge (u,v) where v is a leaf will delete vertex v without adding any new edges.Since constructing a perfect binary tree can be time-consuming, Chloe wants to choose the minimum d such that a perfect binary tree of depth d can be made isomorphic to Penchick\'s tree using the above operation. Note that she can\'t change the roots of the trees.\xe2\x88\x97A tree is a connected graph without cycles.  A rooted tree is a tree where one vertex is special and called the root.  The parent of vertex v is the first vertex on the simple path from v to the root. The root has no parent.  A child of vertex v is any vertex u for which v is the parent.  A leaf is any vertex without children. \xe2\x80\xa0A full binary tree is rooted tree, in which each node has 0 or 2 children.  A perfect binary tree is a full binary tree in which every leaf is at the same distance from the root. The depth of such a tree is the distance from the root to a leaf.\xe2\x80\xa1Two rooted trees, rooted at r1 and r2 respectively, are considered isomorphic if there exists a permutation p of the vertices such that an edge (u,v) exists in the first tree if and only if the edge (pu,pv) exists in the second tree, and pr1=r2." -999
2031D "Penchick and Desert Rabbit" "binary search,data structures,dfs and similar,dp,greedy,two pointers" "Dedicated to pushing himself to his limits, Penchick challenged himself to survive the midday sun in the Arabian Desert!While trekking along a linear oasis, Penchick spots a desert rabbit preparing to jump along a line of palm trees. There are n trees, each with a height denoted by ai.The rabbit can jump from the i-th tree to the j-th tree if exactly one of the following conditions is true:  j<i and aj>ai: the rabbit can jump backward to a taller tree.  j>i and aj<ai: the rabbit can jump forward to a shorter tree. For each i from 1 to n, determine the maximum height among all trees that the rabbit can reach if it starts from the i-th tree." -999
2031C "Penchick and BBQ Buns" "constructive algorithms,math,number theory" "Penchick loves two things: square numbers and Hong Kong-style BBQ buns! For his birthday, Kohane wants to combine them with a gift: n BBQ buns arranged from left to right. There are 106 available fillings of BBQ buns, numbered from 1 to 106. To ensure that Penchick would love this gift, Kohane has a few goals:  No filling is used exactly once; that is, each filling must either not appear at all or appear at least twice.  For any two buns i and j that have the same filling, the distance between them, which is |i\xe2\x88\x92j|, must be a perfect square\xe2\x88\x97. Help Kohane find a valid way to choose the filling of the buns, or determine if it is impossible to satisfy her goals! If there are multiple solutions, print any of them.\xe2\x88\x97A positive integer x is a perfect square if there exists a positive integer y such that x=y2. For example, 49 and 1 are perfect squares because 49=72 and 1=12 respectively. On the other hand, 5 is not a perfect square as no integer squared equals 5" -999
2031B "Penchick and Satay Sticks" "brute force,greedy,sortings" "Penchick and his friend Kohane are touring Indonesia, and their next stop is in Surabaya!In the bustling food stalls of Surabaya, Kohane bought n satay sticks and arranged them in a line, with the i-th satay stick having length pi. It is given that p is a permutation\xe2\x88\x97 of length n.Penchick wants to sort the satay sticks in increasing order of length, so that pi=i for each 1\xe2\x89\xa4i\xe2\x89\xa4n. For fun, they created a rule: they can only swap neighboring satay sticks whose lengths differ by exactly 1. Formally, they can perform the following operation any number of times (including zero):  Select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) such that |pi+1\xe2\x88\x92pi|=1;  Swap pi and pi+1. Determine whether it is possible to sort the permutation p, thus the satay sticks, by performing the above operation.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." -999
2031A "Penchick and Modern Monument" "constructive algorithms,dp,greedy,math" "Amidst skyscrapers in the bustling metropolis of Metro Manila, the newest Noiph mall in the Philippines has just been completed! The construction manager, Penchick, ordered a state-of-the-art monument to be built with n pillars. The heights of the monument\'s pillars can be represented as an array h of n positive integers, where hi represents the height of the i-th pillar for all i between 1 and n.Penchick wants the heights of the pillars to be in non-decreasing order, i.e. hi\xe2\x89\xa4hi+1 for all i between 1 and n\xe2\x88\x921. However, due to confusion, the monument was built such that the heights of the pillars are in non-increasing order instead, i.e. hi\xe2\x89\xa5hi+1 for all i between 1 and n\xe2\x88\x921.Luckily, Penchick can modify the monument and do the following operation on the pillars as many times as necessary:  Modify the height of a pillar to any positive integer. Formally, choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n and a positive integer x. Then, assign hi:=x. Help Penchick determine the minimum number of operations needed to make the heights of the monument\'s pillars non-decreasing." -999
2030G2 "The Destruction of the Universe (Hard Version)" combinatorics,math "This is the hard version of the problem. In this version, n\xe2\x89\xa4106. You can only make hacks if both versions of the problem are solved.Orangutans are powerful beings\xe2\x80\x94so powerful that they only need 1 unit of time to destroy every vulnerable planet in the universe!There are n planets in the universe. Each planet has an interval of vulnerability [l,r], during which it will be exposed to destruction by orangutans. Orangutans can also expand the interval of vulnerability of any planet by 1 unit.Specifically, suppose the expansion is performed on planet p with interval of vulnerability [lp,rp]. Then, the resulting interval of vulnerability may be either [lp\xe2\x88\x921,rp] or [lp,rp+1].Given a set of planets, orangutans can destroy all planets if the intervals of vulnerability of all planets in the set intersect at least one common point. Let the score of such a set denote the minimum number of expansions that must be performed.Orangutans are interested in the sum of scores of all non-empty subsets of the planets in the universe. As the answer can be large, output it modulo 998244353." 3100
2030G1 "The Destruction of the Universe (Easy Version)" combinatorics,greedy,math "This is the easy version of the problem. In this version, n\xe2\x89\xa45000. You can only make hacks if both versions of the problem are solved.Orangutans are powerful beings\xe2\x80\x94so powerful that they only need 1 unit of time to destroy every vulnerable planet in the universe!There are n planets in the universe. Each planet has an interval of vulnerability [l,r], during which it will be exposed to destruction by orangutans. Orangutans can also expand the interval of vulnerability of any planet by 1 unit.Specifically, suppose the expansion is performed on planet p with interval of vulnerability [lp,rp]. Then, the resulting interval of vulnerability may be either [lp\xe2\x88\x921,rp] or [lp,rp+1].Given a set of planets, orangutans can destroy all planets if the intervals of vulnerability of all planets in the set intersect at least one common point. Let the score of such a set denote the minimum number of expansions that must be performed.Orangutans are interested in the sum of scores of all non-empty subsets of the planets in the universe. As the answer can be large, output it modulo 998244353." 2900
2030F "Orangutan Approved Subarrays" "binary search,data structures,dp,greedy,implementation,two pointers" "Suppose you have an array b. Initially, you also have a set S that contains all distinct elements of b. The array b is called orangutan-approved if it can be emptied by repeatedly performing the following operation:   In one operation, select indices l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|b|) such that v=bl=bl+1=\xe2\x80\xa6=br and v is present in S. Remove v from S, and simultaneously remove all bi such that l\xe2\x89\xa4i\xe2\x89\xa4r. Then, reindex the elements br+1,br+2,\xe2\x80\xa6 as bl,bl+1,\xe2\x80\xa6 accordingly. You are given an array a of length n and q queries. Each query consists of two indices l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), and you need to determine whether or not the subarray al,al+1,\xe2\x80\xa6,ar is orangutan-approved." 2400
2030E "MEXimize the Score" "combinatorics,data structures,dp,greedy,implementation,math" "Suppose we partition the elements of an array b into any number k of non-empty multisets S1,S2,\xe2\x80\xa6,Sk, where k is an arbitrary positive integer. Define the score of b as the maximum value of MEX(S1)\xe2\x88\x97+MEX(S2)+\xe2\x80\xa6+MEX(Sk) over all possible partitions of b for any integer k.Envy is given an array a of size n. Since he knows that calculating the score of a is too easy for you, he instead asks you to calculate the sum of scores of all 2n\xe2\x88\x921 non-empty subsequences of a.\xe2\x80\xa0 Since this answer may be large, please output it modulo 998244353.\xe2\x88\x97MEX of a collection of integers c1,c2,\xe2\x80\xa6,ck is defined as the smallest non-negative integer x that does not occur in the collection c. For example, MEX([0,1,2,2])=3 and MEX([1,2,2])=0\xe2\x80\xa0A sequence x is a subsequence of a sequence y if x can be obtained from y by deleting several (possibly, zero or all) elements." 2200
2030D "QED\'s Favorite Permutation" "data structures,implementation,sortings" "QED is given a permutation\xe2\x88\x97 p of length n. He also has a string s of length n containing only characters L and R. QED only likes permutations that are sorted in non-decreasing order. To sort p, he can select any of the following operations and perform them any number of times:  Choose an index i such that si=L. Then, swap pi and pi\xe2\x88\x921. It is guaranteed that s1\xe2\x89\xa0L.  Choose an index i such that si=R. Then, swap pi and pi+1. It is guaranteed that sn\xe2\x89\xa0R. He is also given q queries. In each query, he selects an index i and changes si from L to R (or from R to L). Note that the changes are persistent. After each query, he asks you if it is possible to sort p in non-decreasing order by performing the aforementioned operations any number of times. Note that before answering each query, the permutation p is reset to its original form.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1700
2030C "A TRUE Battle" "brute force,games,greedy" "Alice and Bob are playing a game. There is a list of n booleans, each of which is either true or false, given as a binary string \xe2\x88\x97 of length n (where 1 represents true, and 0 represents false). Initially, there are no operators between the booleans.Alice and Bob will take alternate turns placing and or or between the booleans, with Alice going first. Thus, the game will consist of n\xe2\x88\x921 turns since there are n booleans. Alice aims for the final statement to evaluate to true, while Bob aims for it to evaluate to false. Given the list of boolean values, determine whether Alice will win if both players play optimally.To evaluate the final expression, repeatedly perform the following steps until the statement consists of a single true or false:   If the statement contains an and operator, choose any one and replace the subexpression surrounding it with its evaluation.  Otherwise, the statement contains an or operator. Choose any one and replace the subexpression surrounding the or with its evaluation.  For example, the expression true or false and false is evaluated as true or (false and false) = true or false = true. It can be shown that the result of any compound statement is unique.\xe2\x88\x97A binary string is a string that only consists of characters 0 and 1" 1100
2030B "Minimise Oneness" "combinatorics,constructive algorithms,games,math" "For an arbitrary binary string t\xe2\x88\x97, let f(t) be the number of non-empty subsequences\xe2\x80\xa0 of t that contain only 0, and let g(t) be the number of non-empty subsequences of t that contain at least one 1. Note that for f(t) and for g(t), each subsequence is counted as many times as it appears in t. E.g., f(000)=7,g(100)=4.We define the oneness of the binary string t to be |f(t)\xe2\x88\x92g(t)|, where for an arbitrary integer z, |z| represents the absolute value of z.You are given a positive integer n. Find a binary string s of length n such that its oneness is as small as possible. If there are multiple strings, you can print any of them.\xe2\x88\x97A binary string is a string that only consists of characters 0 and 1.\xe2\x80\xa0A sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) elements. For example, subsequences of 1011101 are 0, 1, 11111, 0111, but not 000 nor 11100." 800
2030A "A Gift From Orangutan" "constructive algorithms,greedy,math,sortings" "While exploring the jungle, you have bumped into a rare orangutan with a bow tie! You shake hands with the orangutan and offer him some food and water. In return...The orangutan has gifted you an array a of length n. Using a, you will construct two arrays b and c, both containing n elements, in the following manner:  bi=min(a1,a2,\xe2\x80\xa6,ai) for each 1\xe2\x89\xa4i\xe2\x89\xa4n.  ci=max(a1,a2,\xe2\x80\xa6,ai) for each 1\xe2\x89\xa4i\xe2\x89\xa4n. Define the score of a as \xe2\x88\x91ni=1ci\xe2\x88\x92bi (i.e. the sum of ci\xe2\x88\x92bi over all 1\xe2\x89\xa4i\xe2\x89\xa4n). Before you calculate the score, you can shuffle the elements of a however you want.Find the maximum score that you can get if you shuffle the elements of a optimally." 800
2029I "Variance Challenge" flows,graphs,greedy "Kevin has recently learned the definition of variance. For an array a of length n, the variance of a is defined as follows:  Let x=1nn\xe2\x88\x91i=1ai, i.e., x is the mean of the array a;  Then, the variance of a is V(a)=1nn\xe2\x88\x91i=1(ai\xe2\x88\x92x)2. Now, Kevin gives you an array a consisting of n integers, as well as an integer k. You can perform the following operation on a:  Select an interval [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), then for each l\xe2\x89\xa4i\xe2\x89\xa4r, increase ai by k. For each 1\xe2\x89\xa4p\xe2\x89\xa4m, you have to find the minimum possible variance of a after exactly p operations are performed, independently for each p.For simplicity, you only need to output the answers multiplied by n2. It can be proven that the results are always integers." 3400
2029H "Message Spread" "bitmasks,brute force,combinatorics,dp" "Given is an undirected graph with n vertices and m edges. Each edge connects two vertices (u,v) and has a probability of pq of appearing each day.Initially, vertex 1 has a message. At the end of the day, a vertex has a message if and only if itself or at least one of the vertices adjacent to it had the message the day before. Note that each day, each edge chooses its appearance independently.Calculate the expected number of days before all the vertices have the message, modulo 998244353." 3500
2029G "Balanced Problem" "data structures,dp" "There is an array a consisting of n integers. Initially, all elements of a are equal to 0.Kevin can perform several operations on the array. Each operation is one of the following two types: Prefix addition \xe2\x80\x94 Kevin first selects an index x (1\xe2\x89\xa4x\xe2\x89\xa4n), and then for each 1\xe2\x89\xa4j\xe2\x89\xa4x, increases aj by 1;  Suffix addition \xe2\x80\x94 Kevin first selects an index x (1\xe2\x89\xa4x\xe2\x89\xa4n), and then for each x\xe2\x89\xa4j\xe2\x89\xa4n, increases aj by 1.In the country of KDOI, people think that the integer v is balanced. Thus, Iris gives Kevin an array c consisting of n integers and defines the beauty of the array a as follows: Initially, set b=0;  For each 1\xe2\x89\xa4i\xe2\x89\xa4n, if ai=v, add ci to b;  The beauty of a is the final value of b.Kevin wants to maximize the beauty of a after all the operations. However, he had already performed m operations when he was sleepy. Now, he can perform an arbitrary number (possibly zero) of new operations.You have to help Kevin find the maximum possible beauty if he optimally performs the new operations.However, to make sure that you are not just rolling the dice, Kevin gives you an integer V, and you need to solve the problem for each 1\xe2\x89\xa4v\xe2\x89\xa4V." 3000
2029F "Palindrome Everywhere" "constructive algorithms,graphs,greedy" "You are given a cycle with n vertices numbered from 0 to n\xe2\x88\x921. For each 0\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, there is an undirected edge between vertex i and vertex ((i+1)modn) with the color ci (ci=R or B).Determine whether the following condition holds for every pair of vertices (i,j) (0\xe2\x89\xa4i<j\xe2\x89\xa4n\xe2\x88\x921): There exists a palindrome route between vertex i and vertex j. Note that the route may not be simple. Formally, there must exist a sequence p=[p0,p1,p2,\xe2\x80\xa6,pm] such that: p0=i, pm=j;  For each 0\xe2\x89\xa4x\xe2\x89\xa4m\xe2\x88\x921, either px+1=(px+1)modn or px+1=(px\xe2\x88\x921)modn;  For each 0\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4m\xe2\x88\x921 satisfying x+y=m\xe2\x88\x921, the edge between px and px+1 has the same color as the edge between py and py+1." 2500
2029E "Common Generator" "brute force,constructive algorithms,math,number theory" "For two integers x and y (x,y\xe2\x89\xa52), we will say that x is a generator of y if and only if x can be transformed to y by performing the following operation some number of times (possibly zero):  Choose a divisor d (d\xe2\x89\xa52) of x, then increase x by d. For example,   3 is a generator of 8 since we can perform the following operations: 3d=3\xe2\x86\x926d=2\xe2\x86\x928;  4 is a generator of 10 since we can perform the following operations: 4d=4\xe2\x86\x928d=2\xe2\x86\x9210;  5 is not a generator of 6 since we cannot transform 5 into 6 with the operation above. Now, Kevin gives you an array a consisting of n pairwise distinct integers (ai\xe2\x89\xa52).You have to find an integer x\xe2\x89\xa52 such that for each 1\xe2\x89\xa4i\xe2\x89\xa4n, x is a generator of ai, or determine that such an integer does not exist." 2100
2029D "Cool Graph" "constructive algorithms,data structures,dfs and similar,dsu,graphs,greedy,trees" "You are given an undirected graph with n vertices and m edges.You can perform the following operation at most 2\xe2\x8b\x85max(n,m) times:  Choose three distinct vertices a, b, and c, then for each of the edges (a,b), (b,c), and (c,a), do the following:   If the edge does not exist, add it. On the contrary, if it exists, remove it.  A graph is called cool if and only if one of the following holds:  The graph has no edges, or  The graph is a tree. You have to make the graph cool by performing the above operations. Note that you can use at most 2\xe2\x8b\x85max(n,m) operations.It can be shown that there always exists at least one solution." 1900
2029C "New Rating" "binary search,data structures,dp,greedy" "Hello, Codeforces Forcescode! Kevin used to be a participant of Codeforces. Recently, the KDOI Team has developed a new Online Judge called Forcescode. Kevin has participated in n contests on Forcescode. In the i-th contest, his performance rating is ai.Now he has hacked into the backend of Forcescode and will select an interval [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), then skip all of the contests in this interval. After that, his rating will be recalculated in the following way:  Initially, his rating is x=0;  For each 1\xe2\x89\xa4i\xe2\x89\xa4n, after the i-th contest,   If l\xe2\x89\xa4i\xe2\x89\xa4r, this contest will be skipped, and the rating will remain unchanged;  Otherwise, his rating will be updated according to the following rules:   If ai>x, his rating x will increase by 1;  If ai=x, his rating x will remain unchanged;  If ai<x, his rating x will decrease by 1.   You have to help Kevin to find his maximum possible rating after the recalculation if he chooses the interval [l,r] optimally. Note that Kevin has to skip at least one contest." 1700
2029B Replacement "constructive algorithms,games,strings" "You have a binary string\xe2\x88\x97 s of length n, and Iris gives you another binary string r of length n\xe2\x88\x921.Iris is going to play a game with you. During the game, you will perform n\xe2\x88\x921 operations on s. In the i-th operation (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921):  First, you choose an index k such that 1\xe2\x89\xa4k\xe2\x89\xa4|s|\xe2\x88\x921 and sk\xe2\x89\xa0sk+1. If it is impossible to choose such an index, you lose;  Then, you replace sksk+1 with ri. Note that this decreases the length of s by 1. If all the n\xe2\x88\x921 operations are performed successfully, you win.Determine whether it is possible for you to win this game.\xe2\x88\x97A binary string is a string where each character is either 0 or 1." 1100
2029A Set greedy,math "You are given a positive integer k and a set S of all integers from l to r (inclusive).You can perform the following two-step operation any number of times (possibly zero): First, choose a number x from the set S, such that there are at least k multiples of x in S (including x itself);  Then, remove x from S (note that nothing else is removed).Find the maximum possible number of operations that can be performed." 800
2028F "Alice\'s Adventures in Addition" "bitmasks,brute force,dp,implementation" "Note that the memory limit is unusual.The Cheshire Cat has a riddle for Alice: given n integers a1,a2,\xe2\x80\xa6,an and a target m, is there a way to insert + and \xc3\x97 into the circles of the expression a1\xe2\x88\x98a2\xe2\x88\x98\xe2\x8b\xaf\xe2\x88\x98an=m to make it true? We follow the usual order of operations: \xc3\x97 is done before +.Although Alice is excellent at chess, she is not good at math. Please help her so she can find a way out of Wonderland!" 2700
2028E "Alice\'s Adventures in the Rabbit Hole" "combinatorics,dfs and similar,dp,games,greedy,math,probabilities,trees" "Alice is at the bottom of the rabbit hole! The rabbit hole can be modeled as a tree\xe2\x88\x97 which has an exit at vertex 1, and Alice starts at some vertex v. She wants to get out of the hole, but unfortunately, the Queen of Hearts has ordered her execution. Each minute, a fair coin is flipped. If it lands heads, Alice gets to move to an adjacent vertex of her current location, and otherwise, the Queen of Hearts gets to pull Alice to an adjacent vertex of the Queen\'s choosing. If Alice ever ends up on any of the non-root leaves\xe2\x80\xa0 of the tree, Alice loses.Assuming both of them move optimally, compute the probability that Alice manages to escape for every single starting vertex 1\xe2\x89\xa4v\xe2\x89\xa4n. Since these probabilities can be very small, output them modulo 998244353.Formally, let M=998244353. It can be shown that the exact answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM). \xe2\x88\x97A tree is a connected simple graph which has n vertices and n\xe2\x88\x921 edges.\xe2\x80\xa0A leaf is a vertex that is connected to exactly one edge." 2300
2028D "Alice\'s Adventures in Cards" "constructive algorithms,data structures,dp,graphs,greedy,implementation,ternary search" "Alice is playing cards with the Queen of Hearts, King of Hearts, and Jack of Hearts. There are n different types of cards in their card game. Alice currently has a card of type 1 and needs a card of type n to escape Wonderland. The other players have one of each kind of card.In this card game, Alice can trade cards with the three other players. Each player has different preferences for the n types of cards, which can be described by permutations\xe2\x88\x97 q, k, and j for the Queen, King, and Jack, respectively. A player values card a more than card b if for their permutation p, pa>pb. Then, this player is willing to trade card b to Alice in exchange for card a. Alice\'s preferences are straightforward: she values card a more than card b if a>b, and she will also only trade according to these preferences.Determine if Alice can trade up from card 1 to card n subject to these preferences, and if it is possible, give a possible set of trades to do it.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2000
2028C "Alice\'s Adventures in Cutting Cake" "binary search,dp,greedy,two pointers" "Alice is at the Mad Hatter\'s tea party! There is a long sheet cake made up of n sections with tastiness values a1,a2,\xe2\x80\xa6,an. There are m creatures at the tea party, excluding Alice. Alice will cut the cake into m+1 pieces. Formally, she will partition the cake into m+1 subarrays, where each subarray consists of some number of adjacent sections. The tastiness of a piece is the sum of tastiness of its sections. Afterwards, she will divvy these m+1 pieces up among the m creatures and herself (her piece can be empty). However, each of the m creatures will only be happy when the tastiness of its piece is v or more.Alice wants to make sure every creature is happy. Limited by this condition, she also wants to maximize the tastiness of her own piece. Can you help Alice find the maximum tastiness her piece can have? If there is no way to make sure every creature is happy, output \xe2\x88\x921." 1600
2028B "Alice\'s Adventures in Permuting" "binary search,implementation,math" "Alice mixed up the words transmutation and permutation! She has an array a specified via three integers n, b, c: the array a has length n and is given via ai=b\xe2\x8b\x85(i\xe2\x88\x921)+c for 1\xe2\x89\xa4i\xe2\x89\xa4n. For example, if n=3, b=2, and c=1, then a=[2\xe2\x8b\x850+1,2\xe2\x8b\x851+1,2\xe2\x8b\x852+1]=[1,3,5].Now, Alice really enjoys permutations of [0,\xe2\x80\xa6,n\xe2\x88\x921]\xe2\x88\x97 and would like to transform a into a permutation. In one operation, Alice replaces the maximum element of a with the MEX\xe2\x80\xa0 of a. If there are multiple maximum elements in a, Alice chooses the leftmost one to replace.Can you help Alice figure out how many operations she has to do for a to become a permutation for the first time? If it is impossible, you should report it.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 0 to n\xe2\x88\x921 in arbitrary order. Please note, this is slightly different from the usual definition of a permutation. For example, [1,2,0,4,3] is a permutation, but [0,1,1] is not a permutation (1 appears twice in the array), and [0,2,3] is also not a permutation (n=3 but there is 3 in the array).\xe2\x80\xa0The MEX of an array is the smallest non-negative integer that does not belong to the array. For example, the MEX of [0,3,1,3] is 2 and the MEX of [5] is 0." 1400
2028A "Alice\'s Adventures in \'\'Chess\'\'" "brute force,implementation,math" "Alice is trying to meet up with the Red Queen in the countryside! Right now, Alice is at position (0,0), and the Red Queen is at position (a,b). Alice can only move in the four cardinal directions (north, east, south, west). More formally, if Alice is at the point (x,y), she will do one of the following:   go north (represented by N), moving to (x,y+1);  go east (represented by E), moving to (x+1,y);  go south (represented by S), moving to (x,y\xe2\x88\x921); or  go west (represented by W), moving to (x\xe2\x88\x921,y). Alice\'s movements are predetermined. She has a string s representing a sequence of moves that she performs from left to right. Once she reaches the end of the sequence, she repeats the same pattern of moves forever.Can you help Alice figure out if she will ever meet the Red Queen?" 900
2027E2 "Bit Game (Hard Version)" bitmasks,dp,math "This is the hard version of this problem. The only difference is that you need to output the number of choices of games where Bob wins in this version, where the number of stones in each pile are not fixed. You must solve both versions to be able to hack.Alice and Bob are playing a familiar game where they take turns removing stones from n piles. Initially, there are xi stones in the i-th pile, and it has an associated value ai. A player can take d stones away from the i-th pile if and only if both of the following conditions are met:   1\xe2\x89\xa4d\xe2\x89\xa4ai, and  x&d=d, where x is the current number of stones in the i-th pile and & denotes the bitwise AND operation. The player who cannot make a move loses, and Alice goes first.You\'re given the ai values of each pile, but the number of stones in the i-th pile has not been determined yet. For the i-th pile, xi can be any integer between 1 and bi, inclusive. That is, you can choose an array x1,x2,\xe2\x80\xa6,xn such that the condition 1\xe2\x89\xa4xi\xe2\x89\xa4bi is satisfied for all piles. Your task is to count the number of games where Bob wins if both players play optimally. Two games are considered different if the number of stones in any pile is different, i.e., the arrays of x differ in at least one position.Since the answer can be very large, please output the result modulo 109+7." 3100
2027E1 "Bit Game (Easy Version)" "bitmasks,brute force,games,math" "This is the easy version of this problem. The only difference is that you need to output the winner of the game in this version, and the number of stones in each pile are fixed. You must solve both versions to be able to hack.Alice and Bob are playing a familiar game where they take turns removing stones from n piles. Initially, there are xi stones in the i-th pile, and it has an associated value ai. A player can take d stones away from the i-th pile if and only if both of the following conditions are met:   1\xe2\x89\xa4d\xe2\x89\xa4ai, and  x&d=d, where x is the current number of stones in the i-th pile and & denotes the bitwise AND operation. The player who cannot make a move loses, and Alice goes first.You\'re given the ai and xi values for each pile, please determine who will win the game if both players play optimally." 2800
2027D2 "The Endspeaker (Hard Version)" "binary search,data structures,dp,greedy,implementation,two pointers" "This is the hard version of this problem. The only difference is that you need to also output the number of optimal sequences in this version. You must solve both versions to be able to hack.You\'re given an array a of length n, and an array b of length m (bi>bi+1 for all 1\xe2\x89\xa4i<m). Initially, the value of k is 1. Your aim is to make the array a empty by performing one of these two operations repeatedly:  Type 1 \xe2\x80\x94 If the value of k is less than m and the array a is not empty, you can increase the value of k by 1. This does not incur any cost.  Type 2 \xe2\x80\x94 You remove a non-empty prefix of array a, such that its sum does not exceed bk. This incurs a cost of m\xe2\x88\x92k. You need to minimize the total cost of the operations to make array a empty. If it\'s impossible to do this through any sequence of operations, output \xe2\x88\x921. Otherwise, output the minimum total cost of the operations, and the number of sequences of operations which yield this minimum cost modulo 109+7. Two sequences of operations are considered different if you choose a different type of operation at any step, or the size of the removed prefix is different at any step." 2200
2027D1 "The Endspeaker (Easy Version)" "binary search,dp,graphs,greedy,implementation,two pointers" "This is the easy version of this problem. The only difference is that you only need to output the minimum total cost of operations in this version. You must solve both versions to be able to hack.You\'re given an array a of length n, and an array b of length m (bi>bi+1 for all 1\xe2\x89\xa4i<m). Initially, the value of k is 1. Your aim is to make the array a empty by performing one of these two operations repeatedly:  Type 1 \xe2\x80\x94 If the value of k is less than m and the array a is not empty, you can increase the value of k by 1. This does not incur any cost.  Type 2 \xe2\x80\x94 You remove a non-empty prefix of array a, such that its sum does not exceed bk. This incurs a cost of m\xe2\x88\x92k. You need to minimize the total cost of the operations to make array a empty. If it\'s impossible to do this through any sequence of operations, output \xe2\x88\x921. Otherwise, output the minimum total cost of the operations." 1700
2027C "Add Zeros" "brute force,data structures,dfs and similar,dp,graphs,greedy" "You\'re given an array a initially containing n integers. In one operation, you must do the following:  Choose a position i such that 1<i\xe2\x89\xa4|a| and ai=|a|+1\xe2\x88\x92i, where |a| is the current size of the array.  Append i\xe2\x88\x921 zeros onto the end of a. After performing this operation as many times as you want, what is the maximum possible length of the array a?" 1500
2027B "Stalin Sort" "brute force,greedy" "Stalin Sort is a humorous sorting algorithm designed to eliminate elements which are out of place instead of bothering to sort them properly, lending itself to an O(n) time complexity.It goes as follows: starting from the second element in the array, if it is strictly smaller than the previous element (ignoring those which have already been deleted), then delete it. Continue iterating through the array until it is sorted in non-decreasing order. For example, the array [1,4,2,3,6,5,5,7,7] becomes [1,4,6,7,7] after a Stalin Sort.We define an array as vulnerable if you can sort it in non-increasing order by repeatedly applying a Stalin Sort to any of its subarrays\xe2\x88\x97, as many times as is needed.Given an array a of n integers, determine the minimum number of integers which must be removed from the array to make it vulnerable.\xe2\x88\x97An array a is a subarray of an array b if a can be obtained from b by the deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 1100
2027A "Rectangle Arrangement" geometry,implementation,math "You are coloring an infinite square grid, in which all cells are initially white. To do this, you are given n stamps. Each stamp is a rectangle of width wi and height hi.You will use each stamp exactly once to color a rectangle of the same size as the stamp on the grid in black. You cannot rotate the stamp, and for each cell, the stamp must either cover it fully or not cover it at all. You can use the stamp at any position on the grid, even if some or all of the cells covered by the stamping area are already black.What is the minimum sum of the perimeters of the connected regions of black squares you can obtain after all the stamps have been used?" 800
2026F "Bermart Ice Cream" "data structures,dfs and similar,divide and conquer,dp,implementation,trees" "In the Bermart chain of stores, a variety of ice cream is sold. Each type of ice cream has two parameters: price and tastiness.Initially, there is one store numbered 1, which sells nothing. You have to process q queries of the following types:   1 x \xe2\x80\x94 a new store opens, that sells the same types of ice cream as store x. It receives the minimum available positive index. The order of the types of ice cream in the new store is the same as in store x.  2 x p t \xe2\x80\x94 a type of ice cream with price p and tastiness t becomes available in store x.  3 x \xe2\x80\x94 a type of ice cream that was available the longest (appeared the earliest) in store x is removed.  4 x p \xe2\x80\x94 for store x, find the maximum total tastiness of a subset of types of ice cream that are sold there, such that the total price does not exceed p (each type can be used in the subset no more than once)." 2700
2026E "Best Subsequence" "bitmasks,dfs and similar,flows,graph matchings,graphs" "Given an integer array a of size n.Let\'s define the value of the array as its size minus the number of set bits in the bitwise OR of all elements of the array.For example, for the array [1,0,1,2], the bitwise OR is 3 (which contains 2 set bits), and the value of the array is 4\xe2\x88\x922=2.Your task is to calculate the maximum possible value of some subsequence of the given array." 2500
2026D "Sums of Segments" "binary search,data structures,dp,implementation,math" "You are given a sequence of integers [a1,a2,\xe2\x80\xa6,an]. Let s(l,r) be the sum of elements from al to ar (i.\xe2\x80\x89e. s(l,r)=r\xe2\x88\x91i=lai).Let\'s construct another sequence b of size n(n+1)2 as follows: b=[s(1,1),s(1,2),\xe2\x80\xa6,s(1,n),s(2,2),s(2,3),\xe2\x80\xa6,s(2,n),s(3,3),\xe2\x80\xa6,s(n,n)].For example, if a=[1,2,5,10], then b=[1,3,8,18,2,7,17,5,15,10].You are given q queries. During the i-th query, you are given two integers li and ri, and you have to calculate ri\xe2\x88\x91j=libj." 1900
2026C "Action Figures" "binary search,brute force,constructive algorithms,data structures,greedy,implementation" "There is a shop that sells action figures near Monocarp\'s house. A new set of action figures will be released shortly; this set contains n figures, the i-th figure costs i coins and is available for purchase from day i to day n.For each of the n days, Monocarp knows whether he can visit the shop.Every time Monocarp visits the shop, he can buy any number of action figures which are sold in the shop (of course, he cannot buy an action figure that is not yet available for purchase). If Monocarp buys at least two figures during the same day, he gets a discount equal to the cost of the most expensive figure he buys (in other words, he gets the most expensive of the figures he buys for free). Monocarp wants to buy exactly one 1-st figure, one 2-nd figure, ..., one n-th figure from the set. He cannot buy the same figure twice. What is the minimum amount of money he has to spend?" 1500
2026B "Black Cells" "binary search,brute force,constructive algorithms,greedy" "You are given a strip divided into cells, numbered from left to right from 0 to 1018. Initially, all cells are white.You can perform the following operation: choose two white cells i and j, such that i\xe2\x89\xa0j and |i\xe2\x88\x92j|\xe2\x89\xa4k, and paint them black.A list a is given. All cells from this list must be painted black. Additionally, at most one cell that is not in this list can also be painted black. Your task is to determine the minimum value of k for which this is possible." 1300
2026A "Perpendicular Segments" "constructive algorithms,geometry,greedy,math" "You are given a coordinate plane and three integers X, Y, and K. Find two line segments AB and CD such that   the coordinates of points A, B, C, and D are integers;  0\xe2\x89\xa4Ax,Bx,Cx,Dx\xe2\x89\xa4X and 0\xe2\x89\xa4Ay,By,Cy,Dy\xe2\x89\xa4Y;  the length of segment AB is at least K;  the length of segment CD is at least K;  segments AB and CD are perpendicular: if you draw lines that contain AB and CD, they will cross at a right angle. Note that it\'s not necessary for segments to intersect. Segments are perpendicular as long as the lines they induce are perpendicular." 900
2025G "Variable Damage" "data structures,flows" "Monocarp is gathering an army to fight a dragon in a videogame.The army consists of two parts: the heroes and the defensive artifacts. Each hero has one parameter \xe2\x80\x94 his health. Each defensive artifact also has one parameter \xe2\x80\x94 its durability.Before the battle begins, Monocarp distributes artifacts to the heroes so that each hero receives at most one artifact.The battle consists of rounds that proceed as follows:   first, the dragon deals damage equal to 1a+b (a real number without rounding) to each hero, where a is the number of heroes alive and b is the number of active artifacts;  after that, all heroes with health 0 or less die;  finally, some artifacts are deactivated. An artifact with durability x is deactivated when one of the following occurs: the hero holding the artifact either dies or receives x total damage (from the start of the battle). If an artifact is not held by any hero, it is inactive from the beginning of the battle. The battle ends when there are no heroes left alive.Initially, the army is empty. There are q queries: add a hero with health x or an artifact with durability y to the army. After each query, determine the maximum number of rounds that Monocarp can survive if he distributes the artifacts optimally." 3000
2025F "Choose Your Queries" "constructive algorithms,dfs and similar,dp,graphs,greedy,trees" "You are given an array a, consisting of n integers (numbered from 1 to n). Initially, they are all zeroes.You have to process q queries. The i-th query consists of two different integers xi and yi. During the i-th query, you have to choose an integer p (which is either xi or yi) and an integer d (which is either 1 or \xe2\x88\x921), and assign ap=ap+d.After each query, every element of a should be a non-negative integer.Process all queries in such a way that the sum of all elements of a after the last query is the minimum possible." 2700
2025E "Card Game" combinatorics,dp,fft,greedy,math "In the most popular card game in Berland, a deck of n\xc3\x97m cards is used. Each card has two parameters: suit and rank. Suits in the game are numbered from 1 to n, and ranks are numbered from 1 to m. There is exactly one card in the deck for each combination of suit and rank.A card with suit a and rank b can beat a card with suit c and rank d in one of two cases:   a=1, c\xe2\x89\xa01 (a card of suit 1 can beat a card of any other suit);  a=c, b>d (a card can beat any other card of the same suit but of a lower rank). Two players play the game. Before the game starts, they receive exactly half of the deck each. The first player wins if for every card of the second player, he can choose his card that can beat it, and there is no card that is chosen twice (i.\xe2\x80\x89e. there exists a matching of the first player\'s cards with the second player\'s cards such that in each pair the first player\'s card beats the second player\'s card). Otherwise, the second player wins.Your task is to calculate the number of ways to distribute the cards so that the first player wins. Two ways are considered different if there exists a card such that in one way it belongs to the first player and in the other way it belongs to the second player. The number of ways can be very large, so print it modulo 998244353." 2200
2025D "Attribute Checks" "brute force,data structures,dp,implementation,math,two pointers" "Imagine a game where you play as a character that has two attributes: ""Strength"" and ""Intelligence"", that are at zero level initially.During the game, you\'ll acquire m attribute points that allow you to increase your attribute levels \xe2\x80\x94 one point will increase one of the attributes by one level. But sometimes, you\'ll encounter a so-called ""Attribute Checks"": if your corresponding attribute is high enough, you\'ll pass it; otherwise, you\'ll fail it.Spending some time, you finally prepared a list which contains records of all points you got and all checks you\'ve met. And now you\'re wondering: what is the maximum number of attribute checks you can pass in a single run if you\'d spend points wisely?Note that you can\'t change the order of records." 1800
2025C "New Game" "binary search,brute force,greedy,implementation,sortings,two pointers" "There\'s a new game Monocarp wants to play. The game uses a deck of n cards, where the i-th card has exactly one integer ai written on it.At the beginning of the game, on the first turn, Monocarp can take any card from the deck. During each subsequent turn, Monocarp can take exactly one card that has either the same number as on the card taken on the previous turn or a number that is one greater than the number on the card taken on the previous turn.In other words, if on the previous turn Monocarp took a card with the number x, then on the current turn he can take either a card with the number x or a card with the number x+1. Monocarp can take any card which meets that condition, regardless of its position in the deck.After Monocarp takes a card on the current turn, it is removed from the deck.According to the rules of the game, the number of distinct numbers written on the cards that Monocarp has taken must not exceed k.If, after a turn, Monocarp cannot take a card without violating the described rules, the game ends.Your task is to determine the maximum number of cards that Monocarp can take from the deck during the game, given that on the first turn he can take any card from the deck." 1300
2025B "Binomial Coefficients, Kind Of" combinatorics,dp,math "Recently, akshiM met a task that needed binomial coefficients to solve. He wrote a code he usually does that looked like this:    for (int n = 0; n < N; n++) { // loop over n from 0 to N-1 (inclusive)        C[n][0] = 1;        C[n][n] = 1;        for (int k = 1; k < n; k++) // loop over k from 1 to n-1 (inclusive)            C[n][k] = C[n][k - 1] + C[n - 1][k - 1];    }Unfortunately, he made an error, since the right formula is the following:            C[n][k] = C[n - 1][k] + C[n - 1][k - 1]But his team member keblidA is interested in values that were produced using the wrong formula. Please help him to calculate these coefficients for t various pairs (ni,ki). Note that they should be calculated according to the first (wrong) formula.Since values C[ni][ki] may be too large, print them modulo 109+7." 1100
2025A "Two Screens" "binary search,greedy,strings,two pointers" "There are two screens which can display sequences of uppercase Latin letters. Initially, both screens display nothing.In one second, you can do one of the following two actions:  choose a screen and an uppercase Latin letter, and append that letter to the end of the sequence displayed on that screen;  choose a screen and copy the sequence from it to the other screen, overwriting the sequence that was displayed on the other screen. You have to calculate the minimum number of seconds you have to spend so that the first screen displays the sequence s, and the second screen displays the sequence t." 800
2024B "Buying Lemonade" "binary search,constructive algorithms,sortings" "There is a vending machine that sells lemonade. The machine has a total of n slots. You know that initially, the i-th slot contains ai cans of lemonade. There are also n buttons on the machine, each button corresponds to a slot, with exactly one button corresponding to each slot. Unfortunately, the labels on the buttons have worn off, so you do not know which button corresponds to which slot.When you press the button corresponding to the i-th slot, one of two events occurs: If there is a can of lemonade in the i-th slot, it will drop out and you will take it. At this point, the number of cans in the i-th slot decreases by 1. If there are no cans of lemonade left in the i-th slot, nothing will drop out. After pressing, the can drops out so quickly that it is impossible to track from which slot it fell. The contents of the slots are hidden from your view, so you cannot see how many cans are left in each slot. The only thing you know is the initial number of cans in the slots: a1,a2,\xe2\x80\xa6,an.Determine the minimum number of button presses needed to guarantee that you receive at least k cans of lemonade.Note that you can adapt your strategy during the button presses based on whether you received a can or not. It is guaranteed that there are at least k cans of lemonade in total in the machine. In other words, k\xe2\x89\xa4a1+a2+\xe2\x80\xa6+an." 1100
2024A "Profitable Interest Rate" greedy,math "Alice has a coins. She can open a bank deposit called ""Profitable"", but the minimum amount required to open this deposit is b coins.There is also a deposit called ""Unprofitable"", which can be opened with any amount of coins. Alice noticed that if she opens the ""Unprofitable"" deposit with x coins, the minimum amount required to open the ""Profitable"" deposit decreases by 2x coins. However, these coins cannot later be deposited into the ""Profitable"" deposit.Help Alice determine the maximum number of coins she can deposit into the ""Profitable"" deposit if she first deposits some amount of coins (possibly 0) into the ""Unprofitable"" deposit. If Alice can never open the ""Profitable"" deposit, output 0." 800
2023F "Hills and Pits" "data structures,greedy,math,matrices" "In a desert city with a hilly landscape, the city hall decided to level the road surface by purchasing a dump truck. The road is divided into n sections, numbered from 1 to n from left to right. The height of the surface in the i-th section is equal to ai. If the height of the i-th section is greater than 0, then the dump truck must take sand from the i-th section of the road, and if the height of the i-th section is less than 0, the dump truck must fill the pit in the i-th section of the road with sand. It is guaranteed that the initial heights are not equal to 0.When the dump truck is in the i-th section of the road, it can either take away x units of sand, in which case the height of the surface in the i-th section will decrease by x, or it can fill in x units of sand (provided that it currently has at least x units of sand in its bed), in which case the height of the surface in the i-th section of the road will increase by x.The dump truck can start its journey from any section of the road. Moving to an adjacent section on the left or right takes 1 minute, and the time for loading and unloading sand can be neglected. The dump truck has an infinite capacity and is initially empty.You need to find the minimum time required for the dump truck to level the sand so that the height in each section becomes equal to 0. Note that after all movements, the dump truck may still have sand left in its bed. You need to solve this problem independently for the segments numbered from li to ri. Sand outside the segment cannot be used." 3500
2023E "Tree of Life" dp,greedy,trees "In the heart of an ancient kingdom grows the legendary Tree of Life \xe2\x80\x94 the only one of its kind and the source of magical power for the entire world. The tree consists of n nodes. Each node of this tree is a magical source, connected to other such sources through magical channels (edges). In total, there are n\xe2\x88\x921 channels in the tree, with the i-th channel connecting nodes vi and ui. Moreover, there exists a unique simple path through the channels between any two nodes in the tree.However, the magical energy flowing through these channels must be balanced; otherwise, the power of the Tree of Life may disrupt the natural order and cause catastrophic consequences. The sages of the kingdom discovered that when two magical channels converge at a single node, a dangerous ""magical resonance vibration"" occurs between them. To protect the Tree of Life and maintain its balance, it is necessary to select several paths and perform special rituals along them. A path is a sequence of distinct nodes v1,v2,\xe2\x80\xa6,vk, where each pair of adjacent nodes vi and vi+1 is connected by a channel. When the sages perform a ritual along such a path, the resonance vibration between the channels (vi,vi+1) and (vi+1,vi+2) is blocked for each 1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x922.The sages\' task is to select the minimum number of paths and perform rituals along them to block all resonance vibrations. This means that for every pair of channels emanating from a single node, there must exist at least one selected path that contains both of these channels.Help the sages find the minimum number of such paths so that the magical balance of the Tree of Life is preserved, and its power continues to nourish the entire world!" 3300
2023D "Many Games" "brute force,dp,greedy,math,probabilities" "Recently, you received a rare ticket to the only casino in the world where you can actually earn something, and you want to take full advantage of this opportunity.The conditions in this casino are as follows:   There are a total of n games in the casino.  You can play each game at most once.  Each game is characterized by two parameters: pi (1\xe2\x89\xa4pi\xe2\x89\xa4100) and wi \xe2\x80\x94 the probability of winning the game in percentage and the winnings for a win.  If you lose in any game you decide to play, you will receive nothing at all (even for the games you won). You need to choose a set of games in advance that you will play in such a way as to maximize the expected value of your winnings.In this case, if you choose to play the games with indices i1<i2<\xe2\x80\xa6<ik, you will win in all of them with a probability of k\xe2\x88\x8fj=1pij100, and in that case, your winnings will be equal to k\xe2\x88\x91j=1wij.That is, the expected value of your winnings will be (k\xe2\x88\x8fj=1pij100)\xe2\x8b\x85(k\xe2\x88\x91j=1wij).To avoid going bankrupt, the casino owners have limited the expected value of winnings for each individual game. Thus, for all i (1\xe2\x89\xa4i\xe2\x89\xa4n), it holds that wi\xe2\x8b\x85pi\xe2\x89\xa42\xe2\x8b\x85105.Your task is to find the maximum expected value of winnings that can be obtained by choosing some set of games in the casino." 2900
2023C C+K+S "constructive algorithms,dfs and similar,graphs,greedy,hashing,implementation,strings" "You are given two strongly connected\xe2\x80\xa0 directed graphs, each with exactly n vertices, but possibly different numbers of edges. Upon closer inspection, you noticed an important feature \xe2\x80\x94 the length of any cycle in these graphs is divisible by k.Each of the 2n vertices belongs to exactly one of two types: incoming or outgoing. For each vertex, its type is known to you.You need to determine whether it is possible to draw exactly n directed edges between the source graphs such that the following four conditions are met:   The ends of any added edge lie in different graphs.  From each outgoing vertex, exactly one added edge originates.  Into each incoming vertex, exactly one added edge enters.  In the resulting graph, the length of any cycle is divisible by k. \xe2\x80\xa0A strongly connected graph is a graph in which there is a path from every vertex to every other vertex." 2400
2023B Skipping "binary search,dp,graphs,shortest paths" "It is already the year 3024, ideas for problems have long run out, and the olympiad now takes place in a modified individual format. The olympiad consists of n problems, numbered from 1 to n. The i-th problem has its own score ai and a certain parameter bi (1\xe2\x89\xa4bi\xe2\x89\xa4n).Initially, the testing system gives the participant the first problem. When the participant is given the i-th problem, they have two options:   They can submit the problem and receive ai points;  They can skip the problem, in which case they will never be able to submit it. Then, the testing system selects the next problem for the participant from problems with indices j, such that:   If he submitted the i-th problem, it looks at problems with indices j<i;  If he skipped the i-th problem, it looks at problems with indices j\xe2\x89\xa4bi. Among these problems, it selects the problem with the maximum index that it has not previously given to the participant (he has neither submitted nor skipped it before). If there is no such problem, then the competition for the participant ends, and their result is equal to the sum of points for all submitted problems. In particular, if the participant submits the first problem, then the competition for them ends. Note that the participant receives each problem at most once.Prokhor has prepared thoroughly for the olympiad, and now he can submit any problem. Help him determine the maximum number of points he can achieve." 1700
2023A "Concatenation of Arrays" "constructive algorithms,greedy,math,sortings" "You are given n arrays a1, \xe2\x80\xa6, an. The length of each array is two. Thus, ai=[ai,1,ai,2]. You need to concatenate the arrays into a single array of length 2n such that the number of inversions\xe2\x80\xa0 in the resulting array is minimized. Note that you do not need to count the actual number of inversions.More formally, you need to choose a permutation\xe2\x80\xa1 p of length n, so that the array b=[ap1,1,ap1,2,ap2,1,ap2,2,\xe2\x80\xa6,apn,1,apn,2] contains as few inversions as possible.\xe2\x80\xa0The number of inversions in an array c is the number of pairs of indices i and j such that i<j and ci>cj.\xe2\x80\xa1A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1300
2022E2 "Billetes MX (Hard Version)" "binary search,combinatorics,data structures,dsu,graphs" "This is the hard version of the problem. In this version, it is guaranteed that q\xe2\x89\xa4105. You can make hacks only if both versions of the problem are solved.An integer grid A with p rows and q columns is called beautiful if:   All elements of the grid are integers between 0 and 230\xe2\x88\x921, and  For any subgrid, the XOR of the values at the corners is equal to 0. Formally, for any four integers i1, i2, j1, j2 (1\xe2\x89\xa4i1<i2\xe2\x89\xa4p; 1\xe2\x89\xa4j1<j2\xe2\x89\xa4q), Ai1,j1\xe2\x8a\x95Ai1,j2\xe2\x8a\x95Ai2,j1\xe2\x8a\x95Ai2,j2=0, where \xe2\x8a\x95 denotes the bitwise XOR operation. There is a partially filled integer grid G with n rows and m columns where only k cells are filled. Polycarp wants to know how many ways he can assign integers to the unfilled cells so that the grid is beautiful.However, Monocarp thinks that this problem is too easy. Therefore, he will perform q updates on the grid. In each update, he will choose an unfilled cell and assign an integer to it. Note that these updates are persistent. That is, changes made to the grid will apply when processing future updates.For each of the q+1 states of the grid, the initial state and after each of the q queries, determine the number of ways Polycarp can assign integers to the unfilled cells so that the grid is beautiful. Since this number can be very large, you are only required to output their values modulo 109+7." 2600
2022E1 "Billetes MX (Easy Version)" "2-sat,binary search,combinatorics,constructive algorithms,dfs and similar,dsu,graphs" "This is the easy version of the problem. In this version, it is guaranteed that q=0. You can make hacks only if both versions of the problem are solved.An integer grid A with p rows and q columns is called beautiful if:   All elements of the grid are integers between 0 and 230\xe2\x88\x921, and  For any subgrid, the XOR of the values at the corners is equal to 0. Formally, for any four integers i1, i2, j1, j2 (1\xe2\x89\xa4i1<i2\xe2\x89\xa4p; 1\xe2\x89\xa4j1<j2\xe2\x89\xa4q), Ai1,j1\xe2\x8a\x95Ai1,j2\xe2\x8a\x95Ai2,j1\xe2\x8a\x95Ai2,j2=0, where \xe2\x8a\x95 denotes the bitwise XOR operation. There is a partially filled integer grid G with n rows and m columns where only k cells are filled. Polycarp wants to know how many ways he can assign integers to the unfilled cells so that the grid is beautiful.However, Monocarp thinks that this problem is too easy. Therefore, he will perform q updates on the grid. In each update, he will choose an unfilled cell and assign an integer to it. Note that these updates are persistent. That is, changes made to the grid will apply when processing future updates.For each of the q+1 states of the grid, the initial state and after each of the q queries, determine the number of ways Polycarp can assign integers to the unfilled cells so that the grid is beautiful. Since this number can be very large, you are only required to output their values modulo 109+7." 2500
2022D2 "Asesino (Hard Version)" "constructive algorithms,dp,interactive" "This is the hard version of the problem. In this version, you must use the minimum number of queries possible. You can make hacks only if both versions of the problem are solved.This is an interactive problem.It is a tradition in Mexico\'s national IOI trainings to play the game ""Asesino"", which is similar to ""Among Us"" or ""Mafia"".Today, n players, numbered from 1 to n, will play ""Asesino"" with the following three roles:  Knight: a Knight is someone who always tells the truth.  Knave: a Knave is someone who always lies.  Impostor: an Impostor is someone everybody thinks is a Knight, but is secretly a Knave. Each player will be assigned a role in the game. There will be exactly one Impostor but there can be any (possible zero) number of Knights and Knaves.As the game moderator, you have accidentally forgotten the roles of everyone, but you need to determine the player who is the Impostor.To determine the Impostor, you will ask some questions. In each question, you will pick two players i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n; i\xe2\x89\xa0j) and ask if player i thinks that player j is a Knight. The results of the question is shown in the table below. KnightKnaveImpostorKnightYesNoYesKnaveNoYesNoImpostorNoYes\xe2\x80\x94 The response of the cell in row a and column b is the result of asking a question when i has role a and j has row b. For example, the ""Yes"" in the top right cell belongs to row ""Knight"" and column ""Impostor"", so it is the response when i is a Knight and j is an Impostor. Find the Impostor in the minimum number of queries possible. That is, let f(n) be the minimum integer such that for n players, there exists a strategy that can determine the Impostor using at most f(n) questions. Then, you should use at most f(n) questions to determine the Impostor.Note: the grader is adaptive: the roles of the players are not fixed in the beginning and may change depending on your questions. However, it is guaranteed that there exists an assignment of roles that is consistent with all previously asked questions under the constraints of this problem." 2700
2022D1 "Asesino (Easy Version)" "binary search,brute force,constructive algorithms,implementation,interactive" "This is the easy version of the problem. In this version, you can ask at most n+69 questions. You can make hacks only if both versions of the problem are solved.This is an interactive problem.It is a tradition in Mexico\'s national IOI trainings to play the game ""Asesino"", which is similar to ""Among Us"" or ""Mafia"".Today, n players, numbered from 1 to n, will play ""Asesino"" with the following three roles:  Knight: a Knight is someone who always tells the truth.  Knave: a Knave is someone who always lies.  Impostor: an Impostor is someone everybody thinks is a Knight, but is secretly a Knave. Each player will be assigned a role in the game. There will be exactly one Impostor but there can be any (possible zero) number of Knights and Knaves.As the game moderator, you have accidentally forgotten the roles of everyone, but you need to determine the player who is the Impostor.To determine the Impostor, you will ask some questions. In each question, you will pick two players i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n; i\xe2\x89\xa0j) and ask if player i thinks that player j is a Knight. The results of the question is shown in the table below. KnightKnaveImpostorKnightYesNoYesKnaveNoYesNoImpostorNoYes\xe2\x80\x94 The response of the cell in row a and column b is the result of asking a question when i has role a and j has row b. For example, the ""Yes"" in the top right cell belongs to row ""Knight"" and column ""Impostor"", so it is the response when i is a Knight and j is an Impostor. Find the Impostor in at most n+69 questions.Note: the grader is adaptive: the roles of the players are not fixed in the beginning and may change depending on your questions. However, it is guaranteed that there exists an assignment of roles that is consistent with all previously asked questions under the constraints of this problem." 1900
2022C Gerrymandering dp,implementation "We all steal a little bit. But I have only one hand, while my adversaries have two.\xc3\x81lvaro Obreg\xc3\xb3n\xc3\x81lvaro and Jos\xc3\xa9 are the only candidates running for the presidency of Tepito, a rectangular grid of 2 rows and n columns, where each cell represents a house. It is guaranteed that n is a multiple of 3.Under the voting system of Tepito, the grid will be split into districts, which consist of any 3 houses that are connected\xe2\x88\x97. Each house will belong to exactly one district.Each district will cast a single vote. The district will vote for \xc3\x81lvaro or Jos\xc3\xa9 respectively if at least 2 houses in that district select them. Therefore, a total of 2n3 votes will be cast.As \xc3\x81lvaro is the current president, he knows exactly which candidate each house will select. If \xc3\x81lvaro divides the houses into districts optimally, determine the maximum number of votes he can get.\xe2\x88\x97A set of cells is connected if there is a path between any 2 cells that requires moving only up, down, left and right through cells in the set." 1800
2022B "Kar Salesman" "binary search,greedy,math" "Karel is a salesman in a car dealership. The dealership has n different models of cars. There are ai cars of the i-th model. Karel is an excellent salesperson and can convince customers to buy up to x cars (of Karel\'s choice), as long as the cars are from different models.Determine the minimum number of customers Karel has to bring in to sell all the cars." 1300
2022A "Bus to P\xc3\xa9njamo" "constructive algorithms,greedy,implementation,math" "Ya vamos llegando a P\xc3\xa9eeenjamoo \xe2\x99\xab\xe2\x99\xab\xe2\x99\xab  There are n families travelling to P\xc3\xa9njamo to witness Mexico\'s largest-ever ""walking a chicken on a leash"" marathon. The i-th family has ai family members. All families will travel using a single bus consisting of r rows with 2 seats each.A person is considered happy if:   Another family member is seated in the same row as them, or  They are sitting alone in their row (with an empty seat next to them). Determine the maximum number of happy people in an optimal seating arrangement. Note that everyone must be seated in the bus.It is guaranteed that all family members will fit on the bus. Formally, it is guaranteed that n\xe2\x88\x91i=1ai\xe2\x89\xa42r." 800
