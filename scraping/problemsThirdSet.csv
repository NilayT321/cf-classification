2021E3 "Digital Village (Extreme Version)" "data structures,dfs and similar,dp,dsu,graphs,greedy,math,trees" "This is the extreme version of the problem. In the three versions, the constraints on n and m are different. You can make hacks only if all the versions of the problem are solved.Pak Chanek is setting up internet connections for the village of Khuntien. The village can be represented as a connected simple graph with n houses and m internet cables connecting house ui and house vi, each with a latency of wi.There are p houses that require internet. Pak Chanek can install servers in at most k of the houses. The houses that need internet will then be connected to one of the servers. However, since each cable has its latency, the latency experienced by house si requiring internet will be the maximum latency of the cables between that house and the server it is connected to.For each k=1,2,\xe2\x80\xa6,n, help Pak Chanek determine the minimum total latency that can be achieved for all the houses requiring internet." 2800
2021E2 "Digital Village (Hard Version)" "data structures,dp,dsu,graphs,math,trees" "This is the hard version of the problem. In the three versions, the constraints on n and m are different. You can make hacks only if all the versions of the problem are solved.Pak Chanek is setting up internet connections for the village of Khuntien. The village can be represented as a connected simple graph with n houses and m internet cables connecting house ui and house vi, each with a latency of wi.There are p houses that require internet. Pak Chanek can install servers in at most k of the houses. The houses that need internet will then be connected to one of the servers. However, since each cable has its latency, the latency experienced by house si requiring internet will be the maximum latency of the cables between that house and the server it is connected to.For each k=1,2,\xe2\x80\xa6,n, help Pak Chanek determine the minimum total latency that can be achieved for all the houses requiring internet." 2500
2021E1 "Digital Village (Easy Version)" "brute force,data structures,dfs and similar,dp,dsu,fft,graphs,greedy,implementation,math,trees" "This is the easy version of the problem. In the three versions, the constraints on n and m are different. You can make hacks only if all the versions of the problem are solved.Pak Chanek is setting up internet connections for the village of Khuntien. The village can be represented as a connected simple graph with n houses and m internet cables connecting house ui and house vi, each with a latency of wi.There are p houses that require internet. Pak Chanek can install servers in at most k of the houses. The houses that need internet will then be connected to one of the servers. However, since each cable has its latency, the latency experienced by house si requiring internet will be the maximum latency of the cables between that house and the server it is connected to.For each k=1,2,\xe2\x80\xa6,n, help Pak Chanek determine the minimum total latency that can be achieved for all the houses requiring internet." 2300
2021D "Boss, Thirsty" dp,greedy,implementation "Pak Chanek has a friend who runs a drink stall in a canteen. His friend will sell drinks for n days, numbered from day 1 to day n. There are also m types of drinks, numbered from 1 to m.The profit gained from selling a drink on a particular day can vary. On day i, the projected profit from selling drink of type j is Ai,j. Note that Ai,j can be negative, meaning that selling the drink would actually incur a loss.Pak Chanek wants to help his friend plan the sales over the n days. On day i, Pak Chanek must choose to sell at least one type of drink. Furthermore, the types of drinks sold on a single day must form a subarray. In other words, in each day, Pak Chanek will select i and j such that 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4m. Then all types of drinks between i and j (inclusive) will be sold.However, to ensure that customers from the previous day keep returning, the selection of drink types sold on day i (i>1) must meet the following conditions:  At least one drink type sold on day i must also have been sold on day i\xe2\x88\x921.  At least one drink type sold on day i must not have been sold on day i\xe2\x88\x921. The daily profit is the sum of the profits from all drink types sold on that day. The total profit from the sales plan is the sum of the profits over n days. What is the maximum total profit that can be achieved if Pak Chanek plans the sales optimally?" 2500
2021C2 "Adjust The Presentation (Hard Version)" "constructive algorithms,data structures,greedy,implementation,sortings" "This is the hard version of the problem. In the two versions, the constraints on q and the time limit are different. In this version, 0\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x85105. You can make hacks only if all the versions of the problem are solved.A team consisting of n members, numbered from 1 to n, is set to present a slide show at a large meeting. The slide show contains m slides.There is an array a of length n. Initially, the members are standing in a line in the order of a1,a2,\xe2\x80\xa6,an from front to back. The slide show will be presented in order from slide 1 to slide m. Each section will be presented by the member at the front of the line. After each slide is presented, you can move the member at the front of the line to any position in the lineup (without changing the order of the rest of the members). For example, suppose the line of members is [3,1,2,4]. After member 3 presents the current slide, you can change the line of members into either [3,1,2,4], [1,3,2,4], [1,2,3,4] or [1,2,4,3].There is also an array b of length m. The slide show is considered good if it is possible to make member bi present slide i for all i from 1 to m under these constraints.However, your annoying boss wants to make q updates to the array b. In the i-th update, he will choose a slide si and a member ti and set bsi:=ti. Note that these updates are persistent, that is changes made to the array b will apply when processing future updates.For each of the q+1 states of array b, the initial state and after each of the q updates, determine if the slideshow is good." 1900
2021C1 "Adjust The Presentation (Easy Version)" "constructive algorithms,greedy" "This is the easy version of the problem. In the two versions, the constraints on q and the time limit are different. In this version, q=0. You can make hacks only if all the versions of the problem are solved.A team consisting of n members, numbered from 1 to n, is set to present a slide show at a large meeting. The slide show contains m slides.There is an array a of length n. Initially, the members are standing in a line in the order of a1,a2,\xe2\x80\xa6,an from front to back. The slide show will be presented in order from slide 1 to slide m. Each section will be presented by the member at the front of the line. After each slide is presented, you can move the member at the front of the line to any position in the lineup (without changing the order of the rest of the members). For example, suppose the line of members is [3,1,2,4]. After member 3 presents the current slide, you can change the line of members into either [3,1,2,4], [1,3,2,4], [1,2,3,4] or [1,2,4,3].There is also an array b of length m. The slide show is considered good if it is possible to make member bi present slide i for all i from 1 to m under these constraints.However, your annoying boss wants to make q updates to the array b. In the i-th update, he will choose a slide si and a member ti and set bsi:=ti. Note that these updates are persistent, that is changes made to the array b will apply when processing future updates.For each of the q+1 states of array b, the initial state and after each of the q updates, determine if the slideshow is good." 1300
2021B "Maximize Mex" "brute force,greedy,math,number theory" "You are given an array a of n positive integers and an integer x. You can do the following two-step operation any (possibly zero) number of times:   Choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n).  Increase ai by x, in other words ai:=ai+x. Find the maximum value of the MEX of a if you perform the operations optimally.The MEX (minimum excluded value) of an array is the smallest non-negative integer that is not in the array. For example:   The MEX of [2,2,1] is 0 because 0 is not in the array.  The MEX of [3,1,0,1] is 2 because 0 and 1 are in the array but 2 is not.  The MEX of [0,3,1,2] is 4 because 0, 1, 2 and 3 are in the array but 4 is not." 1200
2021A "Meaning Mean" "data structures,greedy,math,sortings" "Pak Chanek has an array a of n positive integers. Since he is currently learning how to calculate the floored average of two numbers, he wants to practice it on his array a.While the array a has at least two elements, Pak Chanek will perform the following three-step operation:   Pick two different indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4|a|; i\xe2\x89\xa0j), note that |a| denotes the current size of the array a.  Append \xe2\x8c\x8aai+aj2\xe2\x8c\x8b\xe2\x88\x97 to the end of the array.  Remove elements ai and aj from the array and concatenate the remaining parts of the array. For example, suppose that a=[5,4,3,2,1,1]. If we choose i=1 and j=5, the resulting array will be a=[4,3,2,1,3]. If we choose i=4 and j=3, the resulting array will be a=[5,4,1,1,2].After all operations, the array will consist of a single element x. Find the maximum possible value of x if Pak Chanek performs the operations optimally.\xe2\x88\x97\xe2\x8c\x8ax\xe2\x8c\x8b denotes the floor function of x, which is the greatest integer that is less than or equal to x. For example, \xe2\x8c\x8a6\xe2\x8c\x8b=6, \xe2\x8c\x8a2.5\xe2\x8c\x8b=2, \xe2\x8c\x8a\xe2\x88\x923.6\xe2\x8c\x8b=\xe2\x88\x924 and \xe2\x8c\x8a\xcf\x80\xe2\x8c\x8b=3" 800
2020F "Count Leaves" "dp,math,number theory" "Let n and d be positive integers. We build the the divisor tree Tn,d as follows:  The root of the tree is a node marked with number n. This is the 0-th layer of the tree.  For each i from 0 to d\xe2\x88\x921, for each vertex of the i-th layer, do the following. If the current vertex is marked with x, create its children and mark them with all possible distinct divisors\xe2\x80\xa0 of x. These children will be in the (i+1)-st layer.  The vertices on the d-th layer are the leaves of the tree. For example, T6,2 (the divisor tree for n=6 and d=2) looks like this:  Define f(n,d) as the number of leaves in Tn,d.Given integers n, k, and d, please compute n\xe2\x88\x91i=1f(ik,d), modulo 109+7.\xe2\x80\xa0 In this problem, we say that an integer y is a divisor of x if y\xe2\x89\xa51 and there exists an integer z such that x=y\xe2\x8b\x85z." 2900
2020E "Expected Power" bitmasks,dp,math,probabilities "You are given an array of n integers a1,a2,\xe2\x80\xa6,an. You are also given an array p1,p2,\xe2\x80\xa6,pn.Let S denote the random multiset (i. e., it may contain equal elements) constructed as follows:  Initially, S is empty.  For each i from 1 to n, insert ai into S with probability pi104. Note that each element is inserted independently. Denote f(S) as the bitwise XOR of all elements of S. Please calculate the expected value of (f(S))2. Output the answer modulo 109+7.Formally, let M=109+7. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 2000
2020D "Connect the Dots" "brute force,dp,dsu,graphs,math,trees" "One fine evening, Alice sat down to play the classic game ""Connect the Dots"", but with a twist.To play the game, Alice draws a straight line and marks n points on it, indexed from 1 to n. Initially, there are no arcs between the points, so they are all disjoint. After that, Alice performs m operations of the following type:  She picks three integers ai, di (1\xe2\x89\xa4di\xe2\x89\xa410), and ki.  She selects points ai,ai+di,ai+2di,ai+3di,\xe2\x80\xa6,ai+ki\xe2\x8b\x85di and connects each pair of these points with arcs. After performing all m operations, she wants to know the number of connected components\xe2\x80\xa0 these points form. Please help her find this number.\xe2\x80\xa0 Two points are said to be in one connected component if there is a path between them via several (possibly zero) arcs and other points." 1800
2020C "Bitwise Balancing" "bitmasks,hashing,implementation,math,schedules,ternary search" "You are given three non-negative integers b, c, and d.Please find a non-negative integer a\xe2\x88\x88[0,261] such that (a|b)\xe2\x88\x92(a&c)=d, where | and & denote the bitwise OR operation and the bitwise AND operation, respectively.If such an a exists, print its value. If there is no solution, print a single integer \xe2\x88\x921. If there are multiple solutions, print any of them." 1400
2020B "Brightness Begins" "binary search,math" "Imagine you have n light bulbs numbered 1,2,\xe2\x80\xa6,n. Initially, all bulbs are on. To flip the state of a bulb means to turn it off if it used to be on, and to turn it on otherwise.Next, you do the following:  for each i=1,2,\xe2\x80\xa6,n, flip the state of all bulbs j such that j is divisible by i\xe2\x80\xa0. After performing all operations, there will be several bulbs that are still on. Your goal is to make this number exactly k.Find the smallest suitable n such that after performing the operations there will be exactly k bulbs on. We can show that an answer always exists.\xe2\x80\xa0 An integer x is divisible by y if there exists an integer z such that x=y\xe2\x8b\x85z." 1200
2020A "Find Minimum Operations" "bitmasks,brute force,greedy,math,number theory" "You are given two integers n and k.In one operation, you can subtract any power of k from n. Formally, in one operation, you can replace n by (n\xe2\x88\x92kx) for any non-negative integer x.Find the minimum number of operations required to make n equal to 0." 800
2019B "All Pairs Segments" implementation,math "Shirobon - FOX\xe2\xa0\x80You are given n points on the x axis, at increasing positive integer coordinates x1<x2<\xe2\x80\xa6<xn.For each pair (i,j) with 1\xe2\x89\xa4i<j\xe2\x89\xa4n, you draw the segment [xi,xj]. The segments are closed, i.e., a segment [a,b] contains the points a,a+1,\xe2\x80\xa6,b.You are given q queries. In the i-th query, you are given a positive integer ki, and you have to determine how many points with integer coordinates are contained in exactly ki segments." 1200
2019A "Max Plus Size" "brute force,dp,greedy" "EnV - Dynasty\xe2\xa0\x80You are given an array a1,a2,\xe2\x80\xa6,an of positive integers.You can color some elements of the array red, but there cannot be two adjacent red elements (i.e., for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, at least one of ai and ai+1 must not be red).Your score is the maximum value of a red element plus the number of red elements. Find the maximum score you can get." 800
2018F3 "Speedbreaker Counting (Hard Version)" dp,greedy,math "NightHawk22 - Isolation\xe2\xa0\x80This is the hard version of the problem. In the three versions, the constraints on n and the time limit are different. You can make hacks only if all the versions of the problem are solved.This is the statement of Problem D1B:  There are n cities in a row, numbered 1,2,\xe2\x80\xa6,n left to right.  At time 1, you conquer exactly one city, called the starting city.  At time 2,3,\xe2\x80\xa6,n, you can choose a city adjacent to the ones conquered so far and conquer it. You win if, for each i, you conquer city i at a time no later than ai. A winning strategy may or may not exist, also depending on the starting city. How many starting cities allow you to win? For each 0\xe2\x89\xa4k\xe2\x89\xa4n, count the number of arrays of positive integers a1,a2,\xe2\x80\xa6,an such that  1\xe2\x89\xa4ai\xe2\x89\xa4n for each 1\xe2\x89\xa4i\xe2\x89\xa4n;  the answer to Problem D1B is k. The answer can be very large, so you have to calculate it modulo a given prime p." 3100
2018F2 "Speedbreaker Counting (Medium Version)" dp,greedy,math "NightHawk22 - Isolation\xe2\xa0\x80This is the medium version of the problem. In the three versions, the constraints on n and the time limit are different. You can make hacks only if all the versions of the problem are solved.This is the statement of Problem D1B:  There are n cities in a row, numbered 1,2,\xe2\x80\xa6,n left to right.  At time 1, you conquer exactly one city, called the starting city.  At time 2,3,\xe2\x80\xa6,n, you can choose a city adjacent to the ones conquered so far and conquer it. You win if, for each i, you conquer city i at a time no later than ai. A winning strategy may or may not exist, also depending on the starting city. How many starting cities allow you to win? For each 0\xe2\x89\xa4k\xe2\x89\xa4n, count the number of arrays of positive integers a1,a2,\xe2\x80\xa6,an such that  1\xe2\x89\xa4ai\xe2\x89\xa4n for each 1\xe2\x89\xa4i\xe2\x89\xa4n;  the answer to Problem D1B is k. The answer can be very large, so you have to calculate it modulo a given prime p." 3000
2018F1 "Speedbreaker Counting (Easy Version)" combinatorics,dp,greedy,math "NightHawk22 - Isolation\xe2\xa0\x80This is the easy version of the problem. In the three versions, the constraints on n and the time limit are different. You can make hacks only if all the versions of the problem are solved.This is the statement of Problem D1B:  There are n cities in a row, numbered 1,2,\xe2\x80\xa6,n left to right.  At time 1, you conquer exactly one city, called the starting city.  At time 2,3,\xe2\x80\xa6,n, you can choose a city adjacent to the ones conquered so far and conquer it. You win if, for each i, you conquer city i at a time no later than ai. A winning strategy may or may not exist, also depending on the starting city. How many starting cities allow you to win? For each 0\xe2\x89\xa4k\xe2\x89\xa4n, count the number of arrays of positive integers a1,a2,\xe2\x80\xa6,an such that  1\xe2\x89\xa4ai\xe2\x89\xa4n for each 1\xe2\x89\xa4i\xe2\x89\xa4n;  the answer to Problem D1B is k. The answer can be very large, so you have to calculate it modulo a given prime p." 2900
2018E2 "Complex Segments (Hard Version)" "binary search,data structures,divide and conquer,dsu,greedy,math,sortings" "Ken Arai - COMPLEX\xe2\xa0\x80This is the hard version of the problem. In this version, the constraints on n and the time limit are higher. You can make hacks only if both versions of the problem are solved.A set of (closed) segments is complex if it can be partitioned into some subsets such that   all the subsets have the same size; and  a pair of segments intersects if and only if the two segments are in the same subset. You are given n segments [l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn]. Find the maximum size of a complex subset of these segments." 3400
2018E1 "Complex Segments (Easy Version)" "binary search,data structures,divide and conquer,dsu,greedy,math,sortings" "Ken Arai - COMPLEX\xe2\xa0\x80This is the easy version of the problem. In this version, the constraints on n and the time limit are lower. You can make hacks only if both versions of the problem are solved.A set of (closed) segments is complex if it can be partitioned into some subsets such that   all the subsets have the same size; and  a pair of segments intersects if and only if the two segments are in the same subset. You are given n segments [l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn]. Find the maximum size of a complex subset of these segments." 3300
2018D "Max Plus Min Plus Size" "data structures,dp,dsu,greedy,implementation,matrices,sortings" "EnV - The Dusty Dragon Tavern\xe2\xa0\x80You are given an array a1,a2,\xe2\x80\xa6,an of positive integers.You can color some elements of the array red, but there cannot be two adjacent red elements (i.e., for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, at least one of ai and ai+1 must not be red).Your score is the maximum value of a red element, plus the minimum value of a red element, plus the number of red elements. Find the maximum score you can get." 2200
2018C "Tree Pruning" "brute force,dfs and similar,greedy,sortings,trees" "t+pazolite, ginkiha, Hommarju - Paved Garden\xe2\xa0\x80You are given a tree with n nodes, rooted at node 1. In this problem, a leaf is a non-root node with degree 1.In one operation, you can remove a leaf and the edge adjacent to it (possibly, new leaves appear). What is the minimum number of operations that you have to perform to get a tree, also rooted at node 1, where all the leaves are at the same distance from the root?" 1700
2018B Speedbreaker "binary search,data structures,dp,greedy,implementation,two pointers" "Djjaner - Speedbreaker\xe2\xa0\x80There are n cities in a row, numbered 1,2,\xe2\x80\xa6,n left to right.  At time 1, you conquer exactly one city, called the starting city.  At time 2,3,\xe2\x80\xa6,n, you can choose a city adjacent to the ones conquered so far and conquer it. You win if, for each i, you conquer city i at a time no later than ai. A winning strategy may or may not exist, also depending on the starting city. How many starting cities allow you to win?" 1900
2018A "Cards Partition" "2-sat,brute force,greedy,implementation,math" "DJ Genki vs Gram - Einherjar Joker\xe2\xa0\x80You have some cards. An integer between 1 and n is written on each card: specifically, for each i from 1 to n, you have ai cards which have the number i written on them.There is also a shop which contains unlimited cards of each type. You have k coins, so you can buy at most k new cards in total, and the cards you buy can contain any integer between 1 and n, inclusive.After buying the new cards, you must partition all your cards into decks, according to the following rules:   all the decks must have the same size;  there are no pairs of cards with the same value in the same deck. Find the maximum possible size of a deck after buying cards and partitioning them optimally." 1600
2014H "Robin Hood Archery" "data structures,divide and conquer,greedy,hashing" "At such times archery was always the main sport of the day, for the Nottinghamshire yeomen were the best hand at the longbow in all merry England, but this year the Sheriff hesitated...Sheriff of Nottingham has organized a tournament in archery. It\'s the final round and Robin Hood is playing against Sheriff!There are n targets in a row numbered from 1 to n. When a player shoots target i, their score increases by ai and the target i is destroyed. The game consists of turns and players alternate between whose turn it is. Robin Hood always starts the game, then Sheriff and so on. The game continues until all targets are destroyed. Both players start with score 0.At the end of the game, the player with most score wins and the other player loses. If both players have the same score, it\'s a tie and no one wins or loses. In each turn, the player can shoot any target that wasn\'t shot before. Both play optimally to get the most score possible.Sheriff of Nottingham has a suspicion that he might lose the game! This cannot happen, you must help Sheriff. Sheriff will pose q queries, each specifying l and r. This means that the game would be played only with targets l,l+1,\xe2\x80\xa6,r, as others would be removed by Sheriff before the game starts.For each query l, r, determine whether the Sheriff can not lose the game when only considering the targets l,l+1,\xe2\x80\xa6,r." 1900
2014G "Milky Days" "brute force,data structures,greedy,implementation" "What is done is done, and the spoilt milk cannot be helped.Little John is as little as night is day \xe2\x80\x94 he was known to be a giant, at possibly 2.1 metres tall. It has everything to do with his love for milk.His dairy diary has n entries, showing that he acquired ai pints of fresh milk on day di. Milk declines in freshness with time and stays drinkable for a maximum of k days. In other words, fresh milk acquired on day di will be drinkable between days di and di+k\xe2\x88\x921 inclusive.Every day, Little John drinks drinkable milk, up to a maximum of m pints. In other words, if there are less than m pints of milk, he will drink them all and not be satisfied; if there are at least m pints of milk, he will drink exactly m pints and be satisfied, and it\'s a milk satisfaction day.Little John always drinks the freshest drinkable milk first.Determine the number of milk satisfaction days for Little John." 2200
2014F "Sheriff\'s Defense" "dfs and similar,dp,greedy,trees" """Why, master,"" quoth Little John, taking the bags and weighing them in his hand, ""here is the chink of gold.""The folk hero Robin Hood has been troubling Sheriff of Nottingham greatly. Sheriff knows that Robin Hood is about to attack his camps and he wants to be prepared.Sheriff of Nottingham built the camps with strategy in mind and thus there are exactly n camps numbered from 1 to n and n\xe2\x88\x921 trails, each connecting two camps. Any camp can be reached from any other camp. Each camp i has initially ai gold. As it is now, all camps would be destroyed by Robin. Sheriff can strengthen a camp by subtracting exactly c gold from each of its neighboring camps and use it to build better defenses for that camp. Strengthening a camp doesn\'t change its gold, only its neighbors\' gold. A camp can have negative gold. After Robin Hood\'s attack, all camps that have been strengthened survive the attack, all others are destroyed.What\'s the maximum gold Sheriff can keep in his surviving camps after Robin Hood\'s attack if he strengthens his camps optimally? Camp a is neighboring camp b if and only if there exists a trail connecting a and b. Only strengthened camps count towards the answer, as others are destroyed." 2000
2014E "Rendez-vous de Marian et Robin" "dfs and similar,graphs,shortest paths" "In the humble act of meeting, joy doth unfold like a flower in bloom.Absence makes the heart grow fonder. Marian sold her last ware at the Market at the same time Robin finished training at the Major Oak. They couldn\'t wait to meet, so they both start without delay.The travel network is represented as n vertices numbered from 1 to n and m edges. The i-th edge connects vertices ui and vi, and takes wi seconds to travel (all wi are even). Marian starts at vertex 1 (Market) and Robin starts at vertex n (Major Oak).In addition, h of the n vertices each has a single horse available. Both Marian and Robin are capable riders, and could mount horses in no time (i.e. in 0 seconds). Travel times are halved when riding. Once mounted, a horse lasts the remainder of the travel. Meeting must take place on a vertex (i.e. not on an edge). Either could choose to wait on any vertex.Output the earliest time Robin and Marian can meet. If vertices 1 and n are disconnected, output \xe2\x88\x921 as the meeting is cancelled." 1800
2014D "Robert Hood and Mrs Hood" "brute force,data structures,greedy,sortings" "Impress thy brother, yet fret not thy mother.Robin\'s brother and mother are visiting, and Robin gets to choose the start day for each visitor.All days are numbered from 1 to n. Visitors stay for d continuous days, all of those d days must be between day 1 and n inclusive.Robin has a total of k risky \'jobs\' planned. The i-th job takes place between days li and ri inclusive, for 1\xe2\x89\xa4i\xe2\x89\xa4k. If a job takes place on any of the d days, the visit overlaps with this job (the length of overlap is unimportant).Robin wants his brother\'s visit to overlap with the maximum number of distinct jobs, and his mother\'s the minimum.Find suitable start days for the visits of Robin\'s brother and mother. If there are multiple suitable days, choose the earliest one." 1400
2014C "Robin Hood in Town" "binary search,greedy,math" "In Sherwood, we judge a man not by his wealth, but by his merit.Look around, the rich are getting richer, and the poor are getting poorer. We need to take from the rich and give to the poor. We need Robin Hood!There are n people living in the town. Just now, the wealth of the i-th person was ai gold. But guess what? The richest person has found an extra pot of gold! More formally, find an aj=max(a1,a2,\xe2\x80\xa6,an), change aj to aj+x, where x is a non-negative integer number of gold found in the pot. If there are multiple maxima, it can be any one of them.A person is unhappy if their wealth is strictly less than half of the average wealth\xe2\x88\x97. If strictly more than half of the total population n are unhappy, Robin Hood will appear by popular demand.Determine the minimum value of x for Robin Hood to appear, or output \xe2\x88\x921 if it is impossible.\xe2\x88\x97The average wealth is defined as the total wealth divided by the total population n, that is, \xe2\x88\x91ain, the result is a real number." 1100
2014B "Robin Hood and the Major Oak" math "In Sherwood, the trees are our shelter, and we are all children of the forest.The Major Oak in Sherwood is known for its majestic foliage, which provided shelter to Robin Hood and his band of merry men and women.The Major Oak grows ii new leaves in the i-th year. It starts with 1 leaf in year 1.Leaves last for k years on the tree. In other words, leaves grown in year i last between years i and i+k\xe2\x88\x921 inclusive.Robin considers even numbers lucky. Help Robin determine whether the Major Oak will have an even number of leaves in year n." 800
2014A "Robin Helps" greedy,implementation "There is a little bit of the outlaw in everyone, and a little bit of the hero too.The heroic outlaw Robin Hood is famous for taking from the rich and giving to the poor.Robin encounters n people starting from the 1-st and ending with the n-th. The i-th person has ai gold. If ai\xe2\x89\xa5k, Robin will take all ai gold, and if ai=0, Robin will give 1 gold if he has any. Robin starts with 0 gold.Find out how many people Robin gives gold to." 800
2013F2 "Game in Tree (Hard Version)" "binary search,data structures,trees" "This is the hard version of the problem. In this version, it is not guaranteed that u=v. You can make hacks only if both versions of the problem are solved.Alice and Bob are playing a fun game on a tree. This game is played on a tree with n vertices, numbered from 1 to n. Recall that a tree with n vertices is an undirected connected graph with n\xe2\x88\x921 edges.Alice and Bob take turns, with Alice going first. Each player starts at some vertex.On their turn, a player must move from the current vertex to a neighboring vertex that has not yet been visited by anyone. The first player who cannot make a move loses.You are given two vertices u and v. Represent the simple path from vertex u to v as an array p1,p2,p3,\xe2\x80\xa6,pm, where p1=u, pm=v, and there is an edge between pi and pi+1 for all i (1\xe2\x89\xa4i<m).You need to determine the winner of the game if Alice starts at vertex 1 and Bob starts at vertex pj for each j (where 1\xe2\x89\xa4j\xe2\x89\xa4m)." 3500
2013F1 "Game in Tree (Easy Version)" "binary search,brute force,data structures,dp,games,greedy,implementation,trees" "This is the easy version of the problem. In this version, u=v. You can make hacks only if both versions of the problem are solved.Alice and Bob are playing a fun game on a tree. This game is played on a tree with n vertices, numbered from 1 to n. Recall that a tree with n vertices is an undirected connected graph with n\xe2\x88\x921 edges.Alice and Bob take turns, with Alice going first. Each player starts at some vertex.On their turn, a player must move from the current vertex to a neighboring vertex that has not yet been visited by anyone. The first player who cannot make a move loses.You are given two vertices u and v. Represent the simple path from vertex u to v as an array p1,p2,p3,\xe2\x80\xa6,pm, where p1=u, pm=v, and there is an edge between pi and pi+1 for all i (1\xe2\x89\xa4i<m).You need to determine the winner of the game if Alice starts at vertex 1 and Bob starts at vertex pj for each j (where 1\xe2\x89\xa4j\xe2\x89\xa4m)." 2700
2013E "Prefix GCD" "brute force,dp,greedy,math,number theory" "Since Mansur is tired of making legends, there will be no legends for this task.You are given an array of positive integer numbers a1,a2,\xe2\x80\xa6,an. The elements of the array can be rearranged in any order. You need to find the smallest possible value of the expression gcd(a1)+gcd(a1,a2)+\xe2\x80\xa6+gcd(a1,a2,\xe2\x80\xa6,an), where gcd(a1,a2,\xe2\x80\xa6,an) denotes the greatest common divisor (GCD) of a1,a2,\xe2\x80\xa6,an." 2200
2013D "Minimize the Difference" "binary search,greedy" "Zhan, tired after the contest, gave the only task that he did not solve during the contest to his friend, Sungat. However, he could not solve it either, so we ask you to try to solve this problem.You are given an array a1,a2,\xe2\x80\xa6,an of length n. We can perform any number (possibly, zero) of operations on the array.In one operation, we choose a position i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) and perform the following action:   ai:=ai\xe2\x88\x921, and ai+1:=ai+1+1. Find the minimum possible value of max(a1,a2,\xe2\x80\xa6,an)\xe2\x88\x92min(a1,a2,\xe2\x80\xa6,an)." 1900
2013C "Password Cracking" "constructive algorithms,interactive,strings" "Dimash learned that Mansur wrote something very unpleasant about him to a friend, so he decided to find out his password at all costs and discover what exactly he wrote.Believing in the strength of his password, Mansur stated that his password \xe2\x80\x94 is a binary string of length n. He is also ready to answer Dimash\'s questions of the following type:Dimash says a binary string t, and Mansur replies whether it is true that t is a substring of his password.Help Dimash find out the password in no more than 2n operations; otherwise, Mansur will understand the trick and stop communicating with him." 1400
2013B "Battle for Survive" "constructive algorithms,greedy,math" "Eralim, being the mafia boss, manages a group of n fighters. Fighter i has a rating of ai.Eralim arranges a tournament of n\xe2\x88\x921 battles, in each of which two not yet eliminated fighters i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) are chosen, and as a result of the battle, fighter i is eliminated from the tournament, and the rating of fighter j is reduced by the rating of fighter i. That is, aj is decreased by ai. Note that fighter j\'s rating can become negative. The fighters indexes do not change.Eralim wants to know what maximum rating the last remaining fighter can preserve if he chooses the battles optimally." 900
2013A "Zhan\'s Blender" "constructive algorithms,math" "Today, a club fair was held at ""NSPhM"". In order to advertise his pastry club, Zhan decided to demonstrate the power of his blender.To demonstrate the power of his blender, Zhan has n fruits.The blender can mix up to x fruits per second.In each second, Zhan can put up to y fruits into the blender. After that, the blender will blend min(x,c) fruits, where c is the number of fruits inside the blender. After blending, blended fruits are removed from the blender.Help Zhan determine the minimum amount of time required for Zhan to blend all fruits." 800
2011I "Stack and Queue" "*special problem,data structures,divide and conquer" "There are 2 queues of patients at the doors of two doctors. The first doctor sees patients in the usual order of the queue \xe2\x80\x94 whoever arrived first will be seen first. The second doctor does the opposite \xe2\x80\x94 he sees those who arrived last first. Thus, there is a queue for the first doctor and a stack for the second doctor. A patient can be in both the queue and the stack. Each patient is characterized by the time their visit to the doctor will take (the time is the same for both doctors).When the appointments begin, the doctors will see patients in the order of the queue and stack, respectively. As soon as a doctor finishes with one patient, he will call the next one.But there is one problem: if a patient is in both the queue and the stack, and he is called to one doctor first and then to the other, while he has not yet finished with the first one, confusion will arise. It is allowed for a patient to go to the second doctor at the exact moment he finishes with the first doctor.The current configuration of the queue and stack is called good if the doctors can see all the patients without any confusion arising.Initially, both the queue and the stack are empty. There are three types of queries:   add patient x to the queue;  add patient x to the stack;  patient x, who was in the queue, realizes he is in the wrong place and moves to the stack; however, he moves to the position in the stack as if he had entered the stack at the moment of the query when he entered the queue. It is guaranteed that after each query, each patient is no more than once in the queue and no more than once in the stack.After each query, you need to determine if the current configuration is good." -999
2011H "Strange Matrix" "*special problem,graphs,greedy" "You are given a matrix a of size n\xc3\x97m, consisting of integers from 0 to 31 inclusive.Let\'s call the matrix strange if for every two distinct rows i and j, both of the following conditions hold:   for every set of k indices (x1,x2,\xe2\x80\xa6,xk), where 1\xe2\x89\xa4x1<x2<\xe2\x8b\xaf<xk\xe2\x89\xa4m, the equality ai,x1&aj,x1&ai,x2&aj,x2&\xe2\x8b\xaf&ai,xk&aj,xk=0 holds (where & \xe2\x80\x94 bitwise AND of two numbers);  for every set of k indices (x1,x2,\xe2\x80\xa6,xk), where 1\xe2\x89\xa4x1<x2<\xe2\x8b\xaf<xk\xe2\x89\xa4m, the equality ai,x1|aj,x1|ai,x2|aj,x2|\xe2\x8b\xaf|ai,xk|aj,xk=31 holds (where | \xe2\x80\x94 bitwise OR of two numbers). You can perform the following operation any number of times: take any row of the matrix and a number y from 0 to 31 inclusive; then apply the bitwise XOR with the number y to all elements of the selected row. The cost of such an operation is equal to y.Your task is to calculate the minimum cost to make the matrix strange, or report that it is impossible." -999
2011G "Removal of a Permutation" "*special problem" "You are given a permutation p of length n.You can perform operations of two types:   mark all positions i such that 1\xe2\x89\xa4i<n and pi<pi+1, and simultaneously remove the elements at these positions;  mark all positions i such that 2\xe2\x89\xa4i\xe2\x89\xa4n and pi\xe2\x88\x921>pi, and simultaneously remove the elements at these positions. For each integer from 1 to (n\xe2\x88\x921), calculate the minimum number of operations required to remove that integer from the permutation." -999
2011F "Good Subarray" "*special problem,data structures,greedy" "You are given an integer array a of size n.Let\'s call an array good if it can be obtained using the following algorithm: create an array consisting of any single integer; and then perform the following operation an arbitrary number of times: choose an element from the already existing array (let\'s call it x) and add x, (x\xe2\x88\x921), or (x+1) to the end of the array.For example, the arrays [1,2,1], [5] and [3,2,1,4] are good, while [2,4] and [3,1,2] are not.Your task is to count the number of good contiguous subarrays of the array a. Two subarrays that have the same elements but are in different positions of the array a are considered different." -999
2011E "Rock-Paper-Scissors Bot" "*special problem,greedy,strings" "Rock-Paper-Scissors is a game for two players. It is played in rounds. During each round, every player chooses one of three moves: Rock, Paper, or Scissors. Depending on the chosen moves, the following happens:  if one player chooses Rock and the other player chooses Paper, the player who chooses Paper wins and gets a point;  if one player chooses Scissors and the other player chooses Paper, the player who chooses Scissors wins and gets a point;  if one player chooses Scissors and the other player chooses Rock, the player who chooses Rock wins and gets a point;  and if both players choose the same move, nobody wins and nobody gets a point. Monocarp decided to play against a bot. During the game, Monocarp noticed that the bot\'s behavior is very predictable:   in the first round, it chooses Rock;  in every round except the first, it chooses the move that beats the opponent\'s move in the previous round (for example, if in the previous round its opponent played Scissors, then the bot chooses Rock now). Monocarp has a favorite string s, consisting of the characters R, P, and/or S. Monocarp decided to play a series of rounds against the bot. However, he wants both of the following conditions to be met:   the final score is in favor of Monocarp (i.\xe2\x80\x89e., the number of rounds he won is strictly greater than the number of rounds the bot won);  the string s appears as a contiguous substring in the sequence of the bot\'s moves (where R denotes Rock, P denotes Paper, and S denotes Scissors). Help Monocarp and calculate the minimum number of rounds he needs to play against the bot to satisfy both of the aforementioned conditions." -999
2011D "Among Wolves" "*special problem" "In a game you started playing recently, there is a field that can be represented as a rectangular grid. The field has 2 rows and n columns \xe2\x80\x94 2n cells in total.Some cells are empty, but some are occupied by wolves. In the beginning of the game, you have one sheep in some cell, and you\'d like to save it from wolves.Wolves will attack you at night, so you still have some time for preparation. You have two ways to deal with wolves:   You pay h coins to hunters and choose a cell occupied by a wolf. Hunters will clear the cell, eradicating the wolf in it.  You pay b coins to builders and choose an empty cell. Builders will dig a trench in the chosen cell that wolves can\'t cross.  You can use both methods mentioned above any number of times and in any order.Let\'s say that a wolf can reach the sheep if there is a path that starts at the wolf\'s cell and finishes at the sheep\'s cell. This path shouldn\'t contain any cells with trenches, and each two consecutive cells in the path should be neighbors (share a side).What is the minimum total amount of money you should pay to ensure that none of the wolves can reach the sheep?" -999
2011C "Split the Expression" "*special problem" "You are given a string s of the form <block of digits>+<block of digits>+...+<block of digits>. Every block of digits consists of at least 2 and at most 13 digits; every digit is from 1 to 9.You have to split this string into expressions of the form <integer>+<integer>. Every expression must be a contiguous part of the given string, and every character of the given string must belong to exactly one expression. For example, if you have a string 123+456+789+555, then:  you are allowed to split it into 123+4, 56+7 and 89+555;  you are not allowed to split it into 123+456 and +789+555, since the second part begins with a + sign;  you are not allowed to split it into 123+4, 56+7, 8 and 9+555, since the third part does not contain a + sign;  you are not allowed to split it into 123+456+78 and 9+555, since the first part contains two + signs. Among all allowed ways to split the string, find one which maximizes the sum of results of all expressions you get, and print this sum." -999
2011B Shuffle "*special problem" "Yes, this is another one of those constructive permutation problems.You are given an integer n. You have to construct a permutation p of size n, i.\xe2\x80\x89e. an array of n integers, where every integer from 1 to n appears exactly once.Every pair of adjacent elements in the permutation (pi and pi+1) must meet the following condition:  if one of them is divisible by the other, the condition pi<pi+1 must hold;  otherwise, the condition pi>pi+1 must hold." -999
2011A "Problem Solving" "*special problem" "Jane has decided to solve a list of n problems on Codeforces. The i-th problem in her list has difficulty di, and the last problem in the list is the hardest one (for every problem j<n, dj<dn).Jane\'s problem-solving skill is some integer x (unknown to you). If a problem\'s difficulty is greater than x, then Jane cannot solve it, otherwise she can solve it.Jane has solved all problems form the list, except for the last one \xe2\x80\x94 she found out that it was too difficult for her. Can you uniquely determine the value of x \xe2\x80\x94 Jane\'s problem solving skill?" -999
2010C2 "Message Transmission Error (hard version)" "hashing,string suffix structures,strings,two pointers" "This is a more difficult version of the problem. It differs from the easy one only by the constraints.At the Berland State University, the local network between servers does not always operate without errors. When transmitting two identical messages consecutively, an error may occur, resulting in the two messages merging into one. In this merging, the end of the first message coincides with the beginning of the second. Of course, the merging can only occur at identical characters. The length of the merging must be a positive number less than the length of the message text.For example, when transmitting two messages ""abrakadabra"" consecutively, it is possible that it will be transmitted with the described type of error, resulting in a message like ""abrakadabrabrakadabra"" or ""abrakadabrakadabra\' (in the first case, the merging occurred at one character, and in the second case, at four).Given the received message t, determine if it is possible that this is the result of an error of the described type in the operation of the local network, and if so, determine a possible value of s.A situation where two messages completely overlap each other should not be considered an error. For example, if the received message is ""abcd"", it should be considered that there is no error in it. Similarly, simply appending one message after another is not a sign of an error. For instance, if the received message is ""abcabc"", it should also be considered that there is no error in it." 1700
2010C1 "Message Transmission Error (easy version)" "brute force,strings" "This is a simplified version of the problem. It differs from the difficult one only in its constraints.At the Berland State University, the local network between servers does not always operate without errors. When transmitting two identical messages consecutively, an error may occur, resulting in the two messages merging into one. In this merging, the end of the first message coincides with the beginning of the second. Of course, the merging can only occur at identical characters. The length of the merging must be a positive number less than the length of the message text.For example, when transmitting two messages ""abrakadabra"" consecutively, it is possible that it will be transmitted with the described type of error, resulting in a message like ""abrakadabrabrakadabra"" or ""abrakadabrakadabra\' (in the first case, the merging occurred at one character, and in the second case, at four).Given the received message t, determine if it is possible that this is the result of an error of the described type in the operation of the local network, and if so, determine a possible value of s.A situation where two messages completely overlap each other should not be considered an error. For example, if the received message is ""abcd"", it should be considered that there is no error in it. Similarly, simply appending one message after another is not a sign of an error. For instance, if the received message is ""abcabc"", it should also be considered that there is no error in it." 1400
2010B "Three Brothers" "brute force,implementation,math" "Three brothers agreed to meet. Let\'s number the brothers as follows: the oldest brother is number 1, the middle brother is number 2, and the youngest brother is number 3.When it was time for the meeting, one of the brothers was late. Given the numbers of the two brothers who arrived on time, you need to determine the number of the brother who was late." 800
2010A "Alternating Sum of Numbers" "brute force,implementation,math" "You are given a sequence of integers. Output the alternating sum of this sequence. In other words, output a1\xe2\x88\x92a2+a3\xe2\x88\x92a4+a5\xe2\x88\x92\xe2\x80\xa6. That is, the signs of plus and minus alternate, starting with a plus." 800
2009G3 "Yunli\'s Subarray Queries (extreme version)" "data structures,dp,implementation" "This is the extreme version of the problem. In this version, the output of each query is different from the easy and hard versions. It is also guaranteed that r\xe2\x89\xa5l+k\xe2\x88\x921 for all queries.For an arbitrary array b, Yunli can perform the following operation any number of times:  Select an index i. Set bi=x where x is any integer she desires (x is not limited to the interval [1,n]). Denote f(b) as the minimum number of operations she needs to perform until there exists a consecutive subarray\xe2\x88\x97 of length at least k in b.Yunli is given an array a of size n and asks you q queries. In each query, you must output \xe2\x88\x91r\xe2\x88\x92k+1i=l\xe2\x88\x91rj=i+k\xe2\x88\x921f([ai,ai+1,\xe2\x80\xa6,aj]).\xe2\x88\x97If there exists a consecutive subarray of length k that starts at index i (1\xe2\x89\xa4i\xe2\x89\xa4|b|\xe2\x88\x92k+1), then bj=bj\xe2\x88\x921+1 for all i<j\xe2\x89\xa4i+k\xe2\x88\x921." 2700
2009G2 "Yunli\'s Subarray Queries (hard version)" "binary search,data structures,dp" "This is the hard version of the problem. In this version, it is guaranteed that r\xe2\x89\xa5l+k\xe2\x88\x921 for all queries.For an arbitrary array b, Yunli can perform the following operation any number of times:  Select an index i. Set bi=x where x is any integer she desires (x is not limited to the interval [1,n]). Denote f(b) as the minimum number of operations she needs to perform until there exists a consecutive subarray\xe2\x88\x97 of length at least k in b.Yunli is given an array a of size n and asks you q queries. In each query, you must output \xe2\x88\x91rj=l+k\xe2\x88\x921f([al,al+1,\xe2\x80\xa6,aj]).\xe2\x88\x97If there exists a consecutive subarray of length k that starts at index i (1\xe2\x89\xa4i\xe2\x89\xa4|b|\xe2\x88\x92k+1), then bj=bj\xe2\x88\x921+1 for all i<j\xe2\x89\xa4i+k\xe2\x88\x921." 2200
2009G1 "Yunli\'s Subarray Queries (easy version)" "binary search,data structures,two pointers" "This is the easy version of the problem. In this version, it is guaranteed that r=l+k\xe2\x88\x921 for all queries.For an arbitrary array b, Yunli can perform the following operation any number of times:  Select an index i. Set bi=x where x is any integer she desires (x is not limited to the interval [1,n]). Denote f(b) as the minimum number of operations she needs to perform until there exists a consecutive subarray\xe2\x88\x97 of length at least k in b.Yunli is given an array a of size n and asks you q queries. In each query, you must output \xe2\x88\x91rj=l+k\xe2\x88\x921f([al,al+1,\xe2\x80\xa6,aj]). Note that in this version, you are only required to output f([al,al+1,\xe2\x80\xa6,al+k\xe2\x88\x921]).\xe2\x88\x97If there exists a consecutive subarray of length k that starts at index i (1\xe2\x89\xa4i\xe2\x89\xa4|b|\xe2\x88\x92k+1), then bj=bj\xe2\x88\x921+1 for all i<j\xe2\x89\xa4i+k\xe2\x88\x921." 1900
2009F "Firefly\'s Queries" "bitmasks,data structures,flows,math" "Firefly is given an array a of length n. Let ci denote the i\'th cyclic shift\xe2\x88\x97 of a. She creates a new array b such that b=c1+c2+\xe2\x8b\xaf+cn where + represents concatenation\xe2\x80\xa0. Then, she asks you q queries. For each query, output the sum of all elements in the subarray of b that starts from the l-th element and ends at the r-th element, inclusive of both ends.\xe2\x88\x97The x-th (1\xe2\x89\xa4x\xe2\x89\xa4n) cyclic shift of the array a is ax,ax+1\xe2\x80\xa6an,a1,a2\xe2\x80\xa6ax\xe2\x88\x921. Note that the 1-st shift is the initial a.\xe2\x80\xa0The concatenation of two arrays p and q of length n (in other words, p+q) is p1,p2,...,pn,q1,q2,...,qn." 1700
2009E "Klee\'s SUPER DUPER LARGE Array!!!" "binary search,math,ternary search" "Klee has an array a of length n containing integers [k,k+1,...,k+n\xe2\x88\x921] in that order. Klee wants to choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that x=|a1+a2+\xe2\x8b\xaf+ai\xe2\x88\x92ai+1\xe2\x88\x92\xe2\x8b\xaf\xe2\x88\x92an| is minimized. Note that for an arbitrary integer z, |z| represents the absolute value of z. Output the minimum possible value of x." 1400
2009D "Satyam and Counting" geometry,math "Satyam is given n distinct points on the 2D coordinate plane. It is guaranteed that 0\xe2\x89\xa4yi\xe2\x89\xa41 for all given points (xi,yi). How many different nondegenerate right triangles\xe2\x88\x97 can be formed from choosing three different points as its vertices?Two triangles a and b are different if there is a point v such that v is a vertex of a but not a vertex of b.\xe2\x88\x97A nondegenerate right triangle has positive area and an interior 90\xe2\x88\x98 angle." 1400
2009C "The Legend of Freya the Frog" implementation,math "Freya the Frog is traveling on the 2D coordinate plane. She is currently at point (0,0) and wants to go to point (x,y). In one move, she chooses an integer d such that 0\xe2\x89\xa4d\xe2\x89\xa4k and jumps d spots forward in the direction she is facing. Initially, she is facing the positive x direction. After every move, she will alternate between facing the positive x direction and the positive y direction (i.e., she will face the positive y direction on her second move, the positive x direction on her third move, and so on). What is the minimum amount of moves she must perform to land on point (x,y)?" 1100
2009B osu!mania "brute force,implementation" "You are playing your favorite rhythm game, osu!mania. The layout of your beatmap consists of n rows and 4 columns. Because notes at the bottom are closer, you will process the bottommost row first and the topmost row last. Each row will contain exactly one note, represented as a \'#\'.For each note 1,2,\xe2\x80\xa6,n, in the order of processing, output the column in which the note appears." 800
2009A Minimize! "brute force,math" "You are given two integers a and b (a\xe2\x89\xa4b). Over all possible integer values of c (a\xe2\x89\xa4c\xe2\x89\xa4b), find the minimum value of (c\xe2\x88\x92a)+(b\xe2\x88\x92c)." 800
2008H "Sakurako\'s Test" "binary search,brute force,greedy,math,number theory" "Sakurako will soon take a test. The test can be described as an array of integers n and a task on it:Given an integer x, Sakurako can perform the following operation any number of times:  Choose an integer i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that ai\xe2\x89\xa5x;  Change the value of ai to ai\xe2\x88\x92x. Using this operation any number of times, she must find the minimum possible median\xe2\x88\x97 of the array a.Sakurako knows the array but does not know the integer x. Someone let it slip that one of the q values of x will be in the next test, so Sakurako is asking you what the answer is for each such x.\xe2\x88\x97The median of an array of length n is the element that stands in the middle of the sorted array (at the n+22-th position for even n, and at the n+12-th for odd)" 2100
2008G "Sakurako\'s Task" "binary search,greedy,math,number theory" "Sakurako has prepared a task for you:She gives you an array of n integers and allows you to choose i and j such that i\xe2\x89\xa0j and ai\xe2\x89\xa5aj, and then assign ai=ai\xe2\x88\x92aj or ai=ai+aj. You can perform this operation any number of times for any i and j, as long as they satisfy the conditions.Sakurako asks you what is the maximum possible value of mexk\xe2\x88\x97 of the array after any number of operations.\xe2\x88\x97mexk is the k-th non-negative integer that is absent in the array. For example, mex1({1,2,3})=0, since 0 is the first element that is not in the array, and mex2({0,2,4})=3, since 3 is the second element that is not in the array." 1800
2008F "Sakurako\'s Box" "combinatorics,math,number theory" "Sakurako has a box with n balls. Each ball has it\'s value. She wants to bet with her friend that if the friend randomly picks two balls from the box (it could be two distinct balls, but they may have the same value), the product of their values will be the same as the number that Sakurako guessed.Since Sakurako has a PhD in probability, she knows that the best number to pick is the expected value, but she forgot how to calculate it. Help Sakurako and find the expected value of the product of two elements from the array.It can be shown that the expected value has the form PQ, where P and Q are non-negative integers, and Q\xe2\x89\xa00. Report the value of P\xe2\x8b\x85Q\xe2\x88\x921(mod109+7)." 1400
2008E "Alternating String" "brute force,data structures,dp,greedy,implementation,strings" "Sakurako really loves alternating strings. She calls a string s of lowercase Latin letters an alternating string if characters in the even positions are the same, if characters in the odd positions are the same, and the length of the string is even.For example, the strings \'abab\' and \'gg\' are alternating, while the strings \'aba\' and \'ggwp\' are not.As a good friend, you decided to gift such a string, but you couldn\'t find one. Luckily, you can perform two types of operations on the string:   Choose an index i and delete the i-th character from the string, which will reduce the length of the string by 1. This type of operation can be performed no more than 1 time;  Choose an index i and replace si with any other letter. Since you are in a hurry, you need to determine the minimum number of operations required to make the string an alternating one." 1500
2008D "Sakurako\'s Hobby" dp,dsu,graphs,math "For a certain permutation p\xe2\x88\x97 Sakurako calls an integer j reachable from an integer i if it is possible to make i equal to j by assigning i=pi a certain number of times.If p=[3,5,6,1,2,4], then, for example, 4 is reachable from 1, because: i=1 \xe2\x86\x92 i=p1=3 \xe2\x86\x92 i=p3=6 \xe2\x86\x92 i=p6=4. Now i=4, so 4 is reachable from 1.Each number in the permutation is colored either black or white.Sakurako defines the function F(i) as the number of black integers that are reachable from i.Sakurako is interested in F(i) for each 1\xe2\x89\xa4i\xe2\x89\xa4n, but calculating all values becomes very difficult, so she asks you, as her good friend, to compute this.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (the number 2 appears twice in the array), and [1,3,4] is also not a permutation (n=3, but the array contains 4)." 1100
2008C "Longest Good Array" "binary search,brute force,math" "Today, Sakurako was studying arrays. An array a of length n is considered good if and only if:  the array a is increasing, meaning ai\xe2\x88\x921<ai for all 2\xe2\x89\xa4i\xe2\x89\xa4n;  the differences between adjacent elements are increasing, meaning ai\xe2\x88\x92ai\xe2\x88\x921<ai+1\xe2\x88\x92ai for all 2\xe2\x89\xa4i<n. Sakurako has come up with boundaries l and r and wants to construct a good array of maximum length, where l\xe2\x89\xa4ai\xe2\x89\xa4r for all ai.Help Sakurako find the maximum length of a good array for the given l and r." 800
2008B "Square or Not" "brute force,math,strings" "A beautiful binary matrix is a matrix that has ones on its edges and zeros inside.  Examples of four beautiful binary matrices. Today, Sakurako was playing with a beautiful binary matrix of size r\xc3\x97c and created a binary string s by writing down all the rows of the matrix, starting from the first and ending with the r-th. More formally, the element from the matrix in the i-th row and j-th column corresponds to the ((i\xe2\x88\x921)\xe2\x88\x97c+j)-th element of the string.You need to check whether the beautiful matrix from which the string s was obtained could be squared. In other words, you need to check whether the string s could have been build from a square beautiful binary matrix (i.e., one where r=c)." 800
2008A "Sakurako\'s Exam" "brute force,constructive algorithms,greedy,math" "Today, Sakurako has a math exam. The teacher gave the array, consisting of a ones and b twos.In an array, Sakurako must place either a \'+\' or a \'-\' in front of each element so that the sum of all elements in the array equals 0.Sakurako is not sure if it is possible to solve this problem, so determine whether there is a way to assign signs such that the sum of all elements in the array equals 0." 800
2007C "Dora and C++" "math,number theory" "Dora has just learned the programming language C++!However, she has completely misunderstood the meaning of C++. She considers it as two kinds of adding operations on the array c with n elements. Dora has two integers a and b. In one operation, she can choose one of the following things to do.  Choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n, and increase ci by a.  Choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n, and increase ci by b. Note that a and b are constants, and they can be the same.Let\'s define a range of array d as max(di)\xe2\x88\x92min(di). For instance, the range of the array [1,2,3,4] is 4\xe2\x88\x921=3, the range of the array [5,2,8,2,2,1] is 8\xe2\x88\x921=7, and the range of the array [3,3,3] is 3\xe2\x88\x923=0.After any number of operations (possibly, 0), Dora calculates the range of the new array. You need to help Dora minimize this value, but since Dora loves exploring all by herself, you only need to tell her the minimized value." 1500
2007B "Index and Maximum Value" "data structures,greedy" "After receiving yet another integer array a1,a2,\xe2\x80\xa6,an at her birthday party, Index decides to perform some operations on it.Formally, there are m operations that she is going to perform in order. Each of them belongs to one of the two types:  + l r. Given two integers l and r, for all 1\xe2\x89\xa4i\xe2\x89\xa4n such that l\xe2\x89\xa4ai\xe2\x89\xa4r, set ai:=ai+1.  - l r. Given two integers l and r, for all 1\xe2\x89\xa4i\xe2\x89\xa4n such that l\xe2\x89\xa4ai\xe2\x89\xa4r, set ai:=ai\xe2\x88\x921. For example, if the initial array a=[7,1,3,4,3], after performing the operation + 2 4, the array a=[7,1,4,5,4]. Then, after performing the operation - 1 10, the array a=[6,0,3,4,3].Index is curious about the maximum value in the array a. Please help her find it after each of the m operations." 900
2007A "Dora\'s Set" "greedy,math,number theory" "Dora has a set s containing integers. In the beginning, she will put all integers in [l,r] into the set s. That is, an integer x is initially contained in the set if and only if l\xe2\x89\xa4x\xe2\x89\xa4r. Then she allows you to perform the following operations:  Select three distinct integers a, b, and c from the set s, such that gcd(a,b)=gcd(b,c)=gcd(a,c)=1\xe2\x80\xa0.  Then, remove these three integers from the set s. What is the maximum number of operations you can perform?\xe2\x80\xa0Recall that gcd(x,y) means the greatest common divisor of integers x and y." 800
2006F "Dora\'s Paint" "brute force,combinatorics,constructive algorithms,graphs,implementation" "Sadly, Dora poured the paint when painting the class mural. Dora considers the mural as the matrix b of size n\xc3\x97n. Initially, bi,j=0 for all 1\xe2\x89\xa4i,j\xe2\x89\xa4n.Dora has only two brushes which have two different colors. In one operation, she can paint the matrix with one of two brushes:  The first brush has color 1 on it and can paint one column of the matrix. That is, Dora chooses 1\xe2\x89\xa4j\xe2\x89\xa4n and makes bi,j:=1 for all 1\xe2\x89\xa4i\xe2\x89\xa4n;  The second brush has color 2 on it and can paint one row of the matrix. That is, Dora chooses 1\xe2\x89\xa4i\xe2\x89\xa4n and makes bi,j:=2 for all 1\xe2\x89\xa4j\xe2\x89\xa4n. Dora paints the matrix so that the resulting matrix b contains only 1 and 2.For a matrix b, let f(b) denote the minimum number of operations needed to turn the initial matrix (containing only 0) into b. The beauty of a matrix b is the number of ways to paint the initial matrix in exactly f(b) operations to turn it into b. If there\'s no way to turn the initial matrix into b, the beauty of b is 0.However, Dora made a uniformly random mistake; there\'s exactly one element different in the matrix a given to you from the real matrix b. That is, there is exactly one pair (i,j) such that ai,j=3\xe2\x88\x92bi,j.Please help Dora compute the expected beauty of the real matrix b modulo 998244353 (all possible n2 mistakes have equal probability).Since the size of the matrix is too large, Dora will only tell you the positions of m elements of color 1, and the remaining n2\xe2\x88\x92m elements have color 2." 3500
2006E "Iris\'s Full Binary Tree" "brute force,data structures,dfs and similar,trees" "Iris likes full binary trees.Let\'s define the depth of a rooted tree as the maximum number of vertices on the simple paths from some vertex to the root. A full binary tree of depth d is a binary tree of depth d with exactly 2d\xe2\x88\x921 vertices.Iris calls a tree a d-binary tree if some vertices and edges can be added to it to make it a full binary tree of depth d. Note that any vertex can be chosen as the root of a full binary tree.Since performing operations on large trees is difficult, she defines the binary depth of a tree as the minimum d satisfying that the tree is d-binary. Specifically, if there is no integer d\xe2\x89\xa51 such that the tree is d-binary, the binary depth of the tree is \xe2\x88\x921.Iris now has a tree consisting of only vertex 1. She wants to add n\xe2\x88\x921 more vertices to form a larger tree. She will add the vertices one by one. When she adds vertex i (2\xe2\x89\xa4i\xe2\x89\xa4n), she\'ll give you an integer pi (1\xe2\x89\xa4pi<i), and add a new edge connecting vertices i and pi.Iris wants to ask you the binary depth of the tree formed by the first i vertices for each 1\xe2\x89\xa4i\xe2\x89\xa4n. Can you tell her the answer?" 3100
2006D "Iris and Adjacent Products" "data structures,greedy,implementation,math" "Iris has just learned multiplication in her Maths lessons. However, since her brain is unable to withstand too complex calculations, she could not multiply two integers with the product greater than k together. Otherwise, her brain may explode!Her teacher sets a difficult task every day as her daily summer holiday homework. Now she is given an array a consisting of n elements, and she needs to calculate the product of each two adjacent elements (that is, a1\xe2\x8b\x85a2, a2\xe2\x8b\x85a3, and so on). Iris wants her brain to work safely, and in order to do that, she would like to modify the array a in such a way that ai\xe2\x8b\x85ai+1\xe2\x89\xa4k holds for every 1\xe2\x89\xa4i<n. There are two types of operations she can perform:  She can rearrange the elements of the array a in an arbitrary way. She can select an arbitrary element of the array a and change its value to an arbitrary integer from 1 to k. Iris wants to minimize the number of operations of type 2 that she uses.However, that\'s completely not the end of the summer holiday! Summer holiday lasts for q days, and on the i-th day, Iris is asked to solve the Math homework for the subarray bli,bli+1,\xe2\x80\xa6,bri. Help Iris and tell her the minimum number of type 2 operations she needs to perform for each day. Note that the operations are independent for each day, i.e. the array b is not changed." 2600
2006C "Eri and Expanded Sets" "data structures,divide and conquer,math,number theory,two pointers" "Let there be a set that contains distinct positive integers. To expand the set to contain as many integers as possible, Eri can choose two integers x\xe2\x89\xa0y from the set such that their average x+y2 is still a positive integer and isn\'t contained in the set, and add it to the set. The integers x and y remain in the set.Let\'s call the set of integers consecutive if, after the elements are sorted, the difference between any pair of adjacent elements is 1. For example, sets {2}, {2,5,4,3}, {5,6,8,7} are consecutive, while {2,4,5,6}, {9,7} are not.Eri likes consecutive sets. Suppose there is an array b, then Eri puts all elements in b into the set. If after a finite number of operations described above, the set can become consecutive, the array b will be called brilliant.Note that if the same integer appears in the array multiple times, we only put it into the set once, as a set always contains distinct positive integers.Eri has an array a of n positive integers. Please help him to count the number of pairs of integers (l,r) such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and the subarray al,al+1,\xe2\x80\xa6,ar is brilliant." 2300
2006B "Iris and the Tree" "brute force,data structures,dfs and similar,dsu,math,trees" "Given a rooted tree with the root at vertex 1. For any vertex i (1<i\xe2\x89\xa4n) in the tree, there is an edge connecting vertices i and pi (1\xe2\x89\xa4pi<i), with a weight equal to ti.Iris does not know the values of ti, but she knows that n\xe2\x88\x91i=2ti=w and each of the ti is a non-negative integer.The vertices of the tree are numbered in a special way: the numbers of the vertices in each subtree are consecutive integers. In other words, the vertices of the tree are numbered in the order of a depth-first search.  The tree in this picture satisfies the condition. For example, in the subtree of vertex 2, the vertex numbers are 2,3,4,5, which are consecutive integers.   The tree in this picture does not satisfy the condition, as in the subtree of vertex 2, the vertex numbers 2 and 4 are not consecutive integers. We define dist(u,v) as the length of the simple path between vertices u and v in the tree.Next, there will be n\xe2\x88\x921 events:  Iris is given integers x and y, indicating that tx=y. After each event, Iris wants to know the maximum possible value of dist(i,imodn+1) independently for each i (1\xe2\x89\xa4i\xe2\x89\xa4n). She only needs to know the sum of these n values. Please help Iris quickly get the answers.Note that when calculating the maximum possible values of dist(i,imodn+1) and dist(j,jmodn+1) for i\xe2\x89\xa0j, the unknown edge weights may be different." 1800
2006A "Iris and Game on the Tree" "constructive algorithms,dfs and similar,games,graphs,greedy,trees" "Iris has a tree rooted at vertex 1. Each vertex has a value of 0 or 1.Let\'s consider a leaf of the tree (the vertex 1 is never considered a leaf) and define its weight. Construct a string formed by the values of the vertices on the path starting at the root and ending in this leaf. Then the weight of the leaf is the difference between the number of occurrences of 10 and 01 substrings in it.Take the following tree as an example. Green vertices have a value of 1 while white vertices have a value of 0.   Let\'s calculate the weight of the leaf 5: the formed string is 10110. The number of occurrences of substring 10 is 2, the number of occurrences of substring 01 is 1, so the difference is 2\xe2\x88\x921=1. Let\'s calculate the weight of the leaf 6: the formed string is 101. The number of occurrences of substring 10 is 1, the number of occurrences of substring 01 is 1, so the difference is 1\xe2\x88\x921=0.The score of a tree is defined as the number of leaves with non-zero weight in the tree.But the values of some vertices haven\'t been decided and will be given to you as ?. Filling the blanks would be so boring, so Iris is going to invite Dora to play a game. On each turn, one of the girls chooses any of the remaining vertices with value ? and changes its value to 0 or 1, with Iris going first. The game continues until there are no vertices with value ? left in the tree. Iris aims to maximize the score of the tree, while Dora aims to minimize that.Assuming that both girls play optimally, please determine the final score of the tree." 1700
2005E2 "Subtangle Game (Hard Version)" "data structures,dp,games,greedy,implementation" "This is the hard version of the problem. The differences between the two versions are the constraints on all the variables. You can make hacks only if both versions of the problem are solved.Tsovak and Narek are playing a game. They have an array a and a matrix b of integers with n rows and m columns, numbered from 1. The cell in the i-th row and the j-th column is (i,j).They are looking for the elements of a in turns; Tsovak starts first. Each time a player looks for a cell in the matrix containing the current element of a (Tsovak looks for the first, then Narek looks for the second, etc.). Let\'s say a player has chosen the cell (r,c). The next player has to choose his cell in the submatrix starting at (r+1,c+1) and ending in (n,m) (the submatrix can be empty if r=n or c=m). If a player cannot find such a cell (or the remaining submatrix is empty) or the array ends (the previous player has chosen the last element), then he loses.Your task is to determine the winner if the players play optimally.Note: since the input is large, you may need to optimize input/output for this problem.For example, in C++, it is enough to use the following lines at the start of the main() function: int main() {    ios_base::sync_with_stdio(false);    cin.tie(NULL); cout.tie(NULL);}" 2500
2005E1 "Subtangle Game (Easy Version)" dp,games,greedy,implementation "This is the easy version of the problem. The differences between the two versions are the constraints on all the variables. You can make hacks only if both versions of the problem are solved.Tsovak and Narek are playing a game. They have an array a and a matrix b of integers with n rows and m columns, numbered from 1. The cell in the i-th row and the j-th column is (i,j).They are looking for the elements of a in turns; Tsovak starts first. Each time a player looks for a cell in the matrix containing the current element of a (Tsovak looks for the first, then Narek looks for the second, etc.). Let\'s say a player has chosen the cell (r,c). The next player has to choose his cell in the submatrix starting at (r+1,c+1) and ending in (n,m) (the submatrix can be empty if r=n or c=m). If a player cannot find such a cell (or the remaining submatrix is empty) or the array ends (the previous player has chosen the last element), then he loses.Your task is to determine the winner if the players play optimally." 2100
2005D "Alter the GCD" "binary search,brute force,data structures,divide and conquer,implementation,number theory" "You are given two arrays a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn.You must perform the following operation exactly once:  choose any indices l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n;  swap ai and bi for all i such that l\xe2\x89\xa4i\xe2\x89\xa4r. Find the maximum possible value of gcd(a1,a2,\xe2\x80\xa6,an)+gcd(b1,b2,\xe2\x80\xa6,bn) after performing the operation exactly once. Also find the number of distinct pairs (l,r) which achieve the maximum value." 2400
2005C "Lazy Narek" dp,implementation,strings "Narek is too lazy to create the third problem of this contest. His friend Artur suggests that he should use ChatGPT. ChatGPT creates n problems, each consisting of m letters, so Narek has n strings. To make the problem harder, he combines the problems by selecting some of the n strings possibly none and concatenating them without altering their order. His chance of solving the problem is defined as scoren\xe2\x88\x92scorec, where scoren is Narek\'s score and scorec is ChatGPT\'s score.Narek calculates scoren by examining the selected string (he moves from left to right). He initially searches for the letter ""n"", followed by ""a"", ""r"", ""e"", and ""k"". Upon finding all occurrences of these letters, he increments scoren by 5 and resumes searching for ""n"" again (he doesn\'t go back, and he just continues from where he left off). After Narek finishes, ChatGPT scans through the array and increments scorec by 1 for each letter ""n"", ""a"", ""r"", ""e"", or ""k"" that Narek fails to utilize (note that if Narek fails to complete the last occurrence by finding all of the 5 letters, then all of the letters he used are counted in ChatGPT\'s score scorec, and Narek doesn\'t get any points if he doesn\'t finish finding all the 5 letters).Narek aims to maximize the value of scoren\xe2\x88\x92scorec by selecting the most optimal subset of the initial strings." 1800
2005B2 "The Strict Teacher (Hard Version)" "binary search,greedy,math,sortings" "This is the hard version of the problem. The only differences between the two versions are the constraints on m and q. In this version, m,q\xe2\x89\xa4105. You can make hacks only if both versions of the problem are solved.Narek and Tsovak were busy preparing this round, so they have not managed to do their homework and decided to steal David\'s homework. Their strict teacher noticed that David has no homework and now wants to punish him. She hires other teachers to help her catch David. And now m teachers together are chasing him. Luckily, the classroom is big, so David has many places to hide.The classroom can be represented as a one-dimensional line with cells from 1 to n, inclusive.At the start, all m teachers and David are in distinct cells. Then they make moves. During each move   David goes to an adjacent cell or stays at the current one.  Then, each of the m teachers simultaneously goes to an adjacent cell or stays at the current one. This continues until David is caught. David is caught if any of the teachers (possibly more than one) is located in the same cell as David. Everyone sees others\' moves, so they all act optimally.Your task is to find how many moves it will take for the teachers to catch David if they all act optimally.Acting optimally means the student makes his moves in a way that maximizes the number of moves the teachers need to catch him; and the teachers coordinate with each other to make their moves in a way that minimizes the number of moves they need to catch the student.Also, as Narek and Tsovak think this task is easy, they decided to give you q queries on David\'s position." 1200
2005B1 "The Strict Teacher (Easy Version)" greedy,math,sortings "This is the easy version of the problem. The only differences between the two versions are the constraints on m and q. In this version, m=2 and q=1. You can make hacks only if both versions of the problem are solved.Narek and Tsovak were busy preparing this round, so they have not managed to do their homework and decided to steal David\'s homework. Their strict teacher noticed that David has no homework and now wants to punish him. She hires other teachers to help her catch David. And now m teachers together are chasing him. Luckily, the classroom is big, so David has many places to hide.The classroom can be represented as a one-dimensional line with cells from 1 to n, inclusive.At the start, all m teachers and David are in distinct cells. Then they make moves. During each move   David goes to an adjacent cell or stays at the current one.  Then, each of the m teachers simultaneously goes to an adjacent cell or stays at the current one. This continues until David is caught. David is caught if any of the teachers (possibly more than one) is located in the same cell as David. Everyone sees others\' moves, so they all act optimally.Your task is to find how many moves it will take for the teachers to catch David if they all act optimally.Acting optimally means the student makes his moves in a way that maximizes the number of moves the teachers need to catch him; and the teachers coordinate with each other to make their moves in a way that minimizes the number of moves they need to catch the student.Also, as Narek and Tsovak think this task is easy, they decided to give you q queries on David\'s position. Note: this is the easy version, and you are given only one query." 1000
2005A "Simple Palindrome" "combinatorics,constructive algorithms,greedy,math" "Narek has to spend 2 hours with some 2-year-old kids at the kindergarten. He wants to teach them competitive programming, and their first lesson is about palindromes.Narek found out that the kids only know the vowels of the English alphabet (the letters a, e, i, o, and u), so Narek needs to make a string that consists of vowels only. After making the string, he\'ll ask the kids to count the number of subsequences that are palindromes. Narek wants to keep it simple, so he\'s looking for a string such that the amount of palindrome subsequences is minimal.Help Narek find a string of length n, consisting of lowercase English vowels only (letters a, e, i, o, and u), which minimizes the amount of palindrome\xe2\x80\xa0 subsequences\xe2\x80\xa1 in it.\xe2\x80\xa0 A string is called a palindrome if it reads the same from left to right and from right to left.\xe2\x80\xa1 String t is a subsequence of string s if t can be obtained from s by removing several (possibly, zero or all) characters from s and concatenating the remaining ones, without changing their order. For example, odocs is a subsequence of codeforces." 900
2004G "Substring Compression" "data structures,dp,matrices" "Let\'s define the operation of compressing a string t, consisting of at least 2 digits from 1 to 9, as follows:   split it into an even number of non-empty substrings \xe2\x80\x94 let these substrings be t1,t2,\xe2\x80\xa6,tm (so, t=t1+t2+\xe2\x8b\xaf+tm, where + is the concatenation operation);  write the string t2 t1 times, then the string t4 t3 times, and so on. For example, for a string ""12345"", one could do the following: split it into (""1"", ""23"", ""4"", ""5""), and write ""235555"".Let the function f(t) for a string t return the minimum length of the string that can be obtained as a result of that process.You are given a string s, consisting of n digits from 1 to 9, and an integer k. Calculate the value of the function f for all contiguous substrings of s of length exactly k." 3200
2004F "Make a Palindrome" "binary search,brute force,data structures,greedy,math" "You are given an array a consisting of n integers.Let the function f(b) return the minimum number of operations needed to make an array b a palindrome. The operations you can make are:  choose two adjacent elements bi and bi+1, remove them, and replace them with a single element equal to (bi+bi+1);  or choose an element bi>1, remove it, and replace it with two positive integers x and y (x>0 and y>0) such that x+y=bi. For example, from an array b=[2,1,3], you can obtain the following arrays in one operation: [1,1,1,3], [2,1,1,2], [3,3], [2,4], or [2,1,2,1].Calculate (\xe2\x88\x911\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4nf(a[l..r])), where a[l..r] is the subarray of a from index l to index r, inclusive. In other words, find the sum of the values of the function f for all subarrays of the array a." 2600
2004E "Not a Nim Problem" "brute force,games,math,number theory" "Two players, Alice and Bob, are playing a game. They have n piles of stones, with the i-th pile initially containing ai stones.On their turn, a player can choose any pile of stones and take any positive number of stones from it, with one condition:  let the current number of stones in the pile be x. It is not allowed to take from the pile a number of stones y such that the greatest common divisor of x and y is not equal to 1. The player who cannot make a move loses. Both players play optimally (that is, if a player has a strategy that allows them to win, no matter how the opponent responds, they will win). Alice goes first.Determine who will win." 2100
2004D "Colored Portals" "binary search,brute force,data structures,graphs,greedy,implementation,shortest paths" "There are n cities located on a straight line. The cities are numbered from 1 to n.Portals are used to move between cities. There are 4 colors of portals: blue, green, red, and yellow. Each city has portals of two different colors. You can move from city i to city j if they have portals of the same color (for example, you can move between a ""blue-red"" city and a ""blue-green"" city). This movement costs |i\xe2\x88\x92j| coins.Your task is to answer q independent queries: calculate the minimum cost to move from city x to city y." 1600
2004C "Splitting Items" games,greedy,sortings "Alice and Bob have n items they\'d like to split between them, so they decided to play a game. All items have a cost, and the i-th item costs ai. Players move in turns starting from Alice.In each turn, the player chooses one of the remaining items and takes it. The game goes on until no items are left.Let\'s say that A is the total cost of items taken by Alice and B is the total cost of Bob\'s items. The resulting score of the game then will be equal to A\xe2\x88\x92B.Alice wants to maximize the score, while Bob wants to minimize it. Both Alice and Bob will play optimally.But the game will take place tomorrow, so today Bob can modify the costs a little. He can increase the costs ai of several (possibly none or all) items by an integer value (possibly, by the same value or by different values for each item). However, the total increase must be less than or equal to k. Otherwise, Alice may suspect something. Note that Bob can\'t decrease costs, only increase.What is the minimum possible score Bob can achieve?" 1100
2004B "Game with Doors" "brute force,greedy" "There are 100 rooms arranged in a row and 99 doors between them; the i-th door connects rooms i and i+1. Each door can be either locked or unlocked. Initially, all doors are unlocked.We say that room x is reachable from room y if all doors between them are unlocked.You know that:   Alice is in some room from the segment [l,r];  Bob is in some room from the segment [L,R];  Alice and Bob are in different rooms. However, you don\'t know the exact rooms they are in.You don\'t want Alice and Bob to be able to reach each other, so you are going to lock some doors to prevent that. What\'s the smallest number of doors you have to lock so that Alice and Bob cannot meet, regardless of their starting positions inside the given segments?" 1000
2004A "Closest Point" implementation,math "Consider a set of points on a line. The distance between two points i and j is |i\xe2\x88\x92j|.The point i from the set is the closest to the point j from the set, if there is no other point k in the set such that the distance from j to k is strictly less than the distance from j to i. In other words, all other points from the set have distance to j greater or equal to |i\xe2\x88\x92j|.For example, consider a set of points {1,3,5,8}:  for the point 1, the closest point is 3 (other points have distance greater than |1\xe2\x88\x923|=2);  for the point 3, there are two closest points: 1 and 5;  for the point 5, the closest point is 3 (but not 8, since its distance is greater than |3\xe2\x88\x925|);  for the point 8, the closest point is 5. You are given a set of points. You have to add an integer point into this set in such a way that it is different from every existing point in the set, and it becomes the closest point to every point in the set. Is it possible?" 800
2003F "Turtle and Three Sequences" "brute force,data structures,dp,greedy,math,probabilities,two pointers" "Piggy gives Turtle three sequences a1,a2,\xe2\x80\xa6,an, b1,b2,\xe2\x80\xa6,bn, and c1,c2,\xe2\x80\xa6,cn.Turtle will choose a subsequence of 1,2,\xe2\x80\xa6,n of length m, let it be p1,p2,\xe2\x80\xa6,pm. The subsequence should satisfy the following conditions:  ap1\xe2\x89\xa4ap2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4apm;  All bpi for all indices i are pairwise distinct, i.e., there don\'t exist two different indices i, j such that bpi=bpj. Help him find the maximum value of m\xe2\x88\x91i=1cpi, or tell him that it is impossible to choose a subsequence of length m that satisfies the conditions above.Recall that a sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) elements." 2800
2003E2 "Turtle and Inversions (Hard Version)" "brute force,data structures,divide and conquer,dp,greedy,math,two pointers" "This is a hard version of this problem. The differences between the versions are the constraint on m and ri<li+1 holds for each i from 1 to m\xe2\x88\x921 in the easy version. You can make hacks only if both versions of the problem are solved.Turtle gives you m intervals [l1,r1],[l2,r2],\xe2\x80\xa6,[lm,rm]. He thinks that a permutation p is interesting if there exists an integer ki for every interval (li\xe2\x89\xa4ki<ri), and if he lets ai=kimaxj=lipj,bi=riminj=ki+1pj for every integer i from 1 to m, the following condition holds:mmaxi=1ai<mmini=1biTurtle wants you to calculate the maximum number of inversions of all interesting permutations of length n, or tell him if there is no interesting permutation.An inversion of a permutation p is a pair of integers (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) such that pi>pj." 2700
2003E1 "Turtle and Inversions (Easy Version)" "brute force,divide and conquer,dp,greedy,math" "This is an easy version of this problem. The differences between the versions are the constraint on m and ri<li+1 holds for each i from 1 to m\xe2\x88\x921 in the easy version. You can make hacks only if both versions of the problem are solved.Turtle gives you m intervals [l1,r1],[l2,r2],\xe2\x80\xa6,[lm,rm]. He thinks that a permutation p is interesting if there exists an integer ki for every interval (li\xe2\x89\xa4ki<ri), and if he lets ai=kimaxj=lipj,bi=riminj=ki+1pj for every integer i from 1 to m, the following condition holds:mmaxi=1ai<mmini=1biTurtle wants you to calculate the maximum number of inversions of all interesting permutations of length n, or tell him if there is no interesting permutation.An inversion of a permutation p is a pair of integers (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) such that pi>pj." 2600
2003D2 "Turtle and a MEX Problem (Hard Version)" "dfs and similar,dp,graphs,greedy,implementation,math" "The two versions are different problems. In this version of the problem, you can\'t choose the same integer twice or more. You can make hacks only if both versions are solved.One day, Turtle was playing with n sequences. Let the length of the i-th sequence be li. Then the i-th sequence was ai,1,ai,2,\xe2\x80\xa6,ai,li.Piggy gave Turtle a problem to solve when Turtle was playing. The statement of the problem was:  There was a non-negative integer x at first. Turtle would perform an arbitrary number (possibly zero) of operations on the integer.  In each operation, Turtle could choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n and i wasn\'t chosen before, and set x to mex\xe2\x80\xa0(x,ai,1,ai,2,\xe2\x80\xa6,ai,li).  Turtle was asked to find the answer, which was the maximum value of x after performing an arbitrary number of operations. Turtle solved the above problem without difficulty. He defined f(k) as the answer to the above problem when the initial value of x was k.Then Piggy gave Turtle a non-negative integer m and asked Turtle to find the value of m\xe2\x88\x91i=0f(i) (i.e., the value of f(0)+f(1)+\xe2\x80\xa6+f(m)). Unfortunately, he couldn\'t solve this problem. Please help him!\xe2\x80\xa0mex(c1,c2,\xe2\x80\xa6,ck) is defined as the smallest non-negative integer x which does not occur in the sequence c. For example, mex(2,2,0,3) is 1, mex(1,2) is 0." 2100
2003D1 "Turtle and a MEX Problem (Easy Version)" greedy,math "The two versions are different problems. In this version of the problem, you can choose the same integer twice or more. You can make hacks only if both versions are solved.One day, Turtle was playing with n sequences. Let the length of the i-th sequence be li. Then the i-th sequence was ai,1,ai,2,\xe2\x80\xa6,ai,li.Piggy gave Turtle a problem to solve when Turtle was playing. The statement of the problem was:  There was a non-negative integer x at first. Turtle would perform an arbitrary number (possibly zero) of operations on the integer.  In each operation, Turtle could choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n, and set x to mex\xe2\x80\xa0(x,ai,1,ai,2,\xe2\x80\xa6,ai,li).  Turtle was asked to find the answer, which was the maximum value of x after performing an arbitrary number of operations. Turtle solved the above problem without difficulty. He defined f(k) as the answer to the above problem when the initial value of x was k.Then Piggy gave Turtle a non-negative integer m and asked Turtle to find the value of m\xe2\x88\x91i=0f(i) (i.e., the value of f(0)+f(1)+\xe2\x80\xa6+f(m)). Unfortunately, he couldn\'t solve this problem. Please help him!\xe2\x80\xa0mex(c1,c2,\xe2\x80\xa6,ck) is defined as the smallest non-negative integer x which does not occur in the sequence c. For example, mex(2,2,0,3) is 1, mex(1,2) is 0." 1500
2003C "Turtle and Good Pairs" "constructive algorithms,greedy,sortings,strings" "Turtle gives you a string s, consisting of lowercase Latin letters.Turtle considers a pair of integers (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) to be a pleasant pair if and only if there exists an integer k such that i\xe2\x89\xa4k<j and both of the following two conditions hold:  sk\xe2\x89\xa0sk+1;  sk\xe2\x89\xa0si or sk+1\xe2\x89\xa0sj. Besides, Turtle considers a pair of integers (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) to be a good pair if and only if si=sj or (i,j) is a pleasant pair.Turtle wants to reorder the string s so that the number of good pairs is maximized. Please help him!" 1200
2003B "Turtle and Piggy Are Playing a Game 2" games,greedy,sortings "Turtle and Piggy are playing a game on a sequence. They are given a sequence a1,a2,\xe2\x80\xa6,an, and Turtle goes first. Turtle and Piggy alternate in turns (so, Turtle does the first turn, Piggy does the second, Turtle does the third, etc.).The game goes as follows:  Let the current length of the sequence be m. If m=1, the game ends.  If the game does not end and it\'s Turtle\'s turn, then Turtle must choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4m\xe2\x88\x921, set ai to max(ai,ai+1), and remove ai+1.  If the game does not end and it\'s Piggy\'s turn, then Piggy must choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4m\xe2\x88\x921, set ai to min(ai,ai+1), and remove ai+1. Turtle wants to maximize the value of a1 in the end, while Piggy wants to minimize the value of a1 in the end. Find the value of a1 in the end if both players play optimally.You can refer to notes for further clarification." 800
