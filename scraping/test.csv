2037G "Natlan Exploring" "combinatorics,dp,math,number theory" "You are exploring the stunning region of Natlan! This region consists of n cities, and each city is rated with an attractiveness ai. A directed edge exists from City i to City j if and only if i<j and gcd(ai,aj)\xe2\x89\xa01, where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y.Starting from City 1, your task is to determine the total number of distinct paths you can take to reach City n, modulo 998244353. Two paths are different if and only if the set of cities visited is different." -999 1706B "Making Towers" dp,greedy,math "You have a sequence of n colored blocks. The color of the i-th block is ci, an integer between 1 and n.You will place the blocks down in sequence on an infinite coordinate grid in the following way.   Initially, you place block 1 at (0,0).  For 2\xe2\x89\xa4i\xe2\x89\xa4n, if the (i\xe2\x88\x921)-th block is placed at position (x,y), then the i-th block can be placed at one of positions (x+1,y), (x\xe2\x88\x921,y), (x,y+1) (but not at position (x,y\xe2\x88\x921)), as long no previous block was placed at that position. A tower is formed by s blocks such that they are placed at positions (x,y),(x,y+1),\xe2\x80\xa6,(x,y+s\xe2\x88\x921) for some position (x,y) and integer s. The size of the tower is s, the number of blocks in it. A tower of color r is a tower such that all blocks in it have the color r.For each color r from 1 to n, solve the following problem independently:   Find the maximum size of a tower of color r that you can form by placing down the blocks according to the rules." 1100 1333E "Road to 1600" "brute force,constructive algorithms" "Egor wants to achieve a rating of 1600 points on the well-known chess portal ChessForces and he needs your help!Before you start solving the problem, Egor wants to remind you how the chess pieces move. Chess rook moves along straight lines up and down, left and right, as many squares as it wants. And when it wants, it can stop. The queen walks in all directions vertically and diagonally at any distance. You can see the examples below.  To reach the goal, Egor should research the next topic:There is an N\xc3\x97N board. Each cell of the board has a number from 1 to N2 in it and numbers in all cells are distinct.In the beginning, some chess figure stands in the cell with the number 1. Note that this cell is already considered as visited. After that every move is determined by the following rules:   Among all not visited yet cells to which the figure can get in one move, it goes to the cell that has minimal number. If all accessible cells were already visited and some cells are not yet visited, then the figure is teleported to the not visited cell that has minimal number. If this step happens, the piece pays a fee of 1 vun. If all cells are already visited, the process is stopped. Egor should find an N\xc3\x97N board on which the rook pays strictly less vuns than the queen during the round with this numbering. Help him to find such N\xc3\x97N numbered board, or tell that it doesn\'t exist." 2400 92105 Labyrinth-5 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200 696C PLEASE combinatorics,dp,implementation,math,matrices "As we all know Barney\'s job is ""PLEASE"" and he has not much to do at work. That\'s why he started playing ""cups and key"". In this game there are three identical cups arranged in a line from left to right. Initially key to Barney\'s heart is under the middle cup.  Then at one turn Barney swaps the cup in the middle with any of other two cups randomly (he choses each with equal probability), so the chosen cup becomes the middle one. Game lasts n turns and Barney independently choses a cup to swap with the middle one within each turn, and the key always remains in the cup it was at the start.After n-th turn Barney asks a girl to guess which cup contains the key. The girl points to the middle one but Barney was distracted while making turns and doesn\'t know if the key is under the middle cup. That\'s why he asked you to tell him the probability that girl guessed right.Number n of game turns can be extremely large, that\'s why Barney did not give it to you. Instead he gave you an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak such that   in other words, n is multiplication of all elements of the given array.Because of precision difficulties, Barney asked you to tell him the answer as an irreducible fraction. In other words you need to find it as a fraction p\xe2\x80\x89/\xe2\x80\x89q such that , where  is the greatest common divisor. Since p and q can be extremely large, you only need to find the remainders of dividing each of them by 109\xe2\x80\x89+\xe2\x80\x897.Please note that we want  of p and q to be 1, not  of their remainders after dividing by 109\xe2\x80\x89+\xe2\x80\x897." 2000 1873F "Money Trees" "binary search,greedy,math,two pointers" "Luca is in front of a row of n trees. The i-th tree has ai fruit and height hi.He wants to choose a contiguous subarray of the array [hl,hl+1,\xe2\x80\xa6,hr] such that for each i (l\xe2\x89\xa4i<r), hi is divisible\xe2\x80\xa0 by hi+1. He will collect all the fruit from each of the trees in the subarray (that is, he will collect al+al+1+\xe2\x8b\xaf+ar fruits). However, if he collects more than k fruits in total, he will get caught. What is the maximum length of a subarray Luca can choose so he doesn\'t get caught?\xe2\x80\xa0 x is divisible by y if the ratio xy is an integer." 1300 1725H "Hot Black Hot White" "constructive algorithms,math" "One day, you are accepted as being Dr. Chanek\'s assistant. The first task given by Dr. Chanek to you is to take care and store his magical stones.Dr. Chanek has N magical stones with N being an even number. Those magical stones are numbered from 1 to N. Magical stone i has a strength of Ai. A magical stone can be painted with two colours, namely the colour black or the colour white. You are tasked to paint the magical stones with the colour black or white and store the magical stones into a magic box with a magic coefficient Z (0\xe2\x89\xa4Z\xe2\x89\xa42). The painting of the magical stones must be done in a way such that there are N2 black magical stones and N2 white magical stones.Define concat(x,y) for two integers x and y as the result of concatenating the digits of x to the left of y in their decimal representation without changing the order. As an example, concat(10,24) will result in 1024.For a magic box with a magic coefficient Z, magical stone i will react with magical stone j if the colours of both stones are different and concat(Ai,Aj)\xc3\x97concat(Aj,Ai)+Ai\xc3\x97Aj\xe2\x89\xa1Zmod3. A magical stone that is reacting will be very hot and dangerous. Because of that, you must colour the magical stones and determine the magic coefficient Z of the magic box in a way such that there is no magical stone that reacts, or report if it is impossible." 1800 1525D Armchairs "dp,flows,graph matchings,greedy" "There are n armchairs, numbered from 1 to n from left to right. Some armchairs are occupied by people (at most one person per armchair), others are not. The number of occupied armchairs is not greater than n2.For some reason, you would like to tell people to move from their armchairs to some other ones. If the i-th armchair is occupied by someone and the j-th armchair is not, you can tell the person sitting in the i-th armchair to move to the j-th armchair. The time it takes a person to move from the i-th armchair to the j-th one is |i\xe2\x88\x92j| minutes. You may perform this operation any number of times, but these operations must be done sequentially, i.\xe2\x80\x89e. you cannot tell a person to move until the person you asked to move in the last operation has finished moving to their destination armchair.You want to achieve the following situation: every seat that was initially occupied must be free. What is the minimum time you need to do it?" 1137D "Cooperative Game" "constructive algorithms,interactive,number theory" "This is an interactive problem.Misha likes to play cooperative games with incomplete information. Today he suggested ten his friends to play a cooperative game ""Lake"".Misha has already come up with a field for the upcoming game. The field for this game is a directed graph consisting of two parts. The first part is a road along the coast of the lake which is a cycle of c vertices. The second part is a path from home to the lake which is a chain of t vertices, and there is an edge from the last vertex of this chain to the vertex of the road along the coast which has the most beautiful view of the lake, also known as the finish vertex. Misha decided to keep the field secret, so nobody knows neither t nor c.  Note that each vertex of the field has exactly one outgoing edge and all the vertices except the home vertex and the finish vertex have exactly one ingoing edge. The home vertex has no incoming edges, the finish vertex has two incoming edges.At the beginning of the game pieces of all the ten players, indexed with consecutive integers from 0 to 9, are at the home vertex. After that on each turn some of the players can ask Misha to simultaneously move their pieces along the corresponding edges. Misha will not answer more than q such queries. After each move Misha will tell players whose pieces are at the same vertices and whose pieces are at different vertices.The goal of the game is to move all the pieces to the finish vertex. Misha\'s friends have no idea how to win in such a game without knowledge of c, t and q, but luckily they are your friends. Help them: coordinate their actions to win the game. Misha has drawn such a field that 1\xe2\x89\xa4t,c, (t+c)\xe2\x89\xa41000 and q=3\xe2\x8b\x85(t+c)." 450A "Jzzhu and Children" implementation "There are n children in Jzzhu\'s school. Jzzhu is going to give some candies to them. Let\'s number all the children from 1 to n. The i-th child wants to get at least ai candies.Jzzhu asks children to line up. Initially, the i-th child stands at the i-th place of the line. Then Jzzhu start distribution of the candies. He follows the algorithm:  Give m candies to the first child of the line.  If this child still haven\'t got enough candies, then the child goes to the end of the line, else the child go home.  Repeat the first two steps while the line is not empty. Consider all the children in the order they go home. Jzzhu wants to know, which child will be the last in this order?" 1000 201A "Clear Symmetry" "constructive algorithms,dp,math" "Consider some square matrix A with side n consisting of zeros and ones. There are n rows numbered from 1 to n from top to bottom and n columns numbered from 1 to n from left to right in this matrix. We\'ll denote the element of the matrix which is located at the intersection of the i-row and the j-th column as Ai,\xe2\x80\x89j.Let\'s call matrix A clear if no two cells containing ones have a common side.Let\'s call matrix A symmetrical if it matches the matrices formed from it by a horizontal and/or a vertical reflection. Formally, for each pair (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) both of the following conditions must be met: Ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89An\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j and Ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89Ai,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891.Let\'s define the sharpness of matrix A as the number of ones in it.Given integer x, your task is to find the smallest positive integer n such that there exists a clear symmetrical matrix A with side n and sharpness x." 1700
2037E "Kachina\'s Favorite Binary String" "greedy,interactive,two pointers" "This is an interactive problem.Kachina challenges you to guess her favorite binary string\xe2\x88\x97 s of length n. She defines f(l,r) as the number of subsequences\xe2\x80\xa0 of 01 in slsl+1\xe2\x80\xa6sr. Two subsequences are considered different if they are formed by deleting characters from different positions in the original string, even if the resulting subsequences consist of the same characters.To determine s, you can ask her some questions. In each question, you can choose two indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n) and ask her for the value of f(l,r).Determine and output s after asking Kachina no more than n questions. However, it may be the case that s is impossible to be determined. In this case, you would need to report IMPOSSIBLE instead.Formally, s is impossible to be determined if after asking n questions, there are always multiple possible strings for s, regardless of what questions are asked. Note that if you report IMPOSSIBLE when there exists a sequence of at most n queries that will uniquely determine the binary string, you will get the Wrong Answer verdict.\xe2\x88\x97A binary string only contains characters 0 and 1.\xe2\x80\xa0A sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) elements. For example, subsequences of 1011101 are 0, 1, 11111, 0111, but not 000 nor 11100." -999.0                                                
2036G "Library of Magic" "binary search,constructive algorithms,divide and conquer,interactive,math,number theory" "This is an interactive problem.The Department of Supernatural Phenomena at the Oxenfurt Academy has opened the Library of Magic, which contains the works of the greatest sorcerers of Redania \xe2\x80\x94 n (3\xe2\x89\xa4n\xe2\x89\xa41018) types of books, numbered from 1 to n. Each book\'s type number is indicated on its spine. Moreover, each type of book is stored in the library in exactly two copies! And you have been appointed as the librarian.One night, you wake up to a strange noise and see a creature leaving the building through a window. Three thick tomes of different colors were sticking out of the mysterious thief\'s backpack. Before you start searching for them, you decide to compute the numbers a, b, and c written on the spines of these books. All three numbers are distinct.So, you have an unordered set of tomes, which includes one tome with each of the pairwise distinct numbers a, b, and c, and two tomes for all numbers from 1 to n, except for a, b, and c. You want to find these values a, b, and c.Since you are not working in a simple library, but in the Library of Magic, you can only use one spell in the form of a query to check the presence of books in their place:   ""xor l r"" \xe2\x80\x94 Bitwise XOR query with parameters l and r. Let k be the number of such tomes in the library whose numbers are greater than or equal to l and less than or equal to r. You will receive the result of the computation v1\xe2\x8a\x95v2\xe2\x8a\x95...\xe2\x8a\x95vk, where v1...vk are the numbers on the spines of these tomes, and \xe2\x8a\x95 denotes the operation of bitwise exclusive OR. Since your magical abilities as a librarian are severely limited, you can make no more than 150 queries." 2200.0                                                
2035A Sliding implementation,math "Red was ejected. They were not the imposter.There are n rows of m people. Let the position in the r-th row and the c-th column be denoted by (r,c). Number each person starting from 1 in row-major order, i.e., the person numbered (r\xe2\x88\x921)\xe2\x8b\x85m+c is initially at (r,c).The person at (r,c) decides to leave. To fill the gap, let the person who left be numbered i. Each person numbered j>i will move to the position where the person numbered j\xe2\x88\x921 is initially at. The following diagram illustrates the case where n=2, m=3, r=1, and c=2.   Calculate the sum of the Manhattan distances of each person\'s movement. If a person was initially at (r0,c0) and then moved to (r1,c1), the Manhattan distance is |r0\xe2\x88\x92r1|+|c0\xe2\x88\x92c1|." 800.0                                                
2032E Balanced "constructive algorithms,data structures,greedy,implementation,math" "You are given a cyclic array a with n elements, where n is odd. In each operation, you can do the following:  Choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n and increase ai\xe2\x88\x921 by 1, ai by 2, and ai+1 by 1. The element before the first element is the last element because this is a cyclic array. A cyclic array is called balanced if all its elements are equal to each other.Find any sequence of operations to make this cyclic array balanced or determine that it is impossible. Please note that you do not have to minimize the number of operations." 2400.0                                                
2030C "A TRUE Battle" "brute force,games,greedy" "Alice and Bob are playing a game. There is a list of n booleans, each of which is either true or false, given as a binary string \xe2\x88\x97 of length n (where 1 represents true, and 0 represents false). Initially, there are no operators between the booleans.Alice and Bob will take alternate turns placing and or or between the booleans, with Alice going first. Thus, the game will consist of n\xe2\x88\x921 turns since there are n booleans. Alice aims for the final statement to evaluate to true, while Bob aims for it to evaluate to false. Given the list of boolean values, determine whether Alice will win if both players play optimally.To evaluate the final expression, repeatedly perform the following steps until the statement consists of a single true or false:   If the statement contains an and operator, choose any one and replace the subexpression surrounding it with its evaluation.  Otherwise, the statement contains an or operator. Choose any one and replace the subexpression surrounding the or with its evaluation.  For example, the expression true or false and false is evaluated as true or (false and false) = true or false = true. It can be shown that the result of any compound statement is unique.\xe2\x88\x97A binary string is a string that only consists of characters 0 and 1" 1100.0                                                
2028A "Alice\'s Adventures in \'\'Chess\'\'" "brute force,implementation,math" "Alice is trying to meet up with the Red Queen in the countryside! Right now, Alice is at position (0,0), and the Red Queen is at position (a,b). Alice can only move in the four cardinal directions (north, east, south, west). More formally, if Alice is at the point (x,y), she will do one of the following:   go north (represented by N), moving to (x,y+1);  go east (represented by E), moving to (x+1,y);  go south (represented by S), moving to (x,y\xe2\x88\x921); or  go west (represented by W), moving to (x\xe2\x88\x921,y). Alice\'s movements are predetermined. She has a string s representing a sequence of moves that she performs from left to right. Once she reaches the end of the sequence, she repeats the same pattern of moves forever.Can you help Alice figure out if she will ever meet the Red Queen?" 900.0                                                
2027D2 "The Endspeaker (Hard Version)" "binary search,data structures,dp,greedy,implementation,two pointers" "This is the hard version of this problem. The only difference is that you need to also output the number of optimal sequences in this version. You must solve both versions to be able to hack.You\'re given an array a of length n, and an array b of length m (bi>bi+1 for all 1\xe2\x89\xa4i<m). Initially, the value of k is 1. Your aim is to make the array a empty by performing one of these two operations repeatedly:  Type 1 \xe2\x80\x94 If the value of k is less than m and the array a is not empty, you can increase the value of k by 1. This does not incur any cost.  Type 2 \xe2\x80\x94 You remove a non-empty prefix of array a, such that its sum does not exceed bk. This incurs a cost of m\xe2\x88\x92k. You need to minimize the total cost of the operations to make array a empty. If it\'s impossible to do this through any sequence of operations, output \xe2\x88\x921. Otherwise, output the minimum total cost of the operations, and the number of sequences of operations which yield this minimum cost modulo 109+7. Two sequences of operations are considered different if you choose a different type of operation at any step, or the size of the removed prefix is different at any step." 2200.0                                                
2026D "Sums of Segments" "binary search,data structures,dp,implementation,math" "You are given a sequence of integers [a1,a2,\xe2\x80\xa6,an]. Let s(l,r) be the sum of elements from al to ar (i.\xe2\x80\x89e. s(l,r)=r\xe2\x88\x91i=lai).Let\'s construct another sequence b of size n(n+1)2 as follows: b=[s(1,1),s(1,2),\xe2\x80\xa6,s(1,n),s(2,2),s(2,3),\xe2\x80\xa6,s(2,n),s(3,3),\xe2\x80\xa6,s(n,n)].For example, if a=[1,2,5,10], then b=[1,3,8,18,2,7,17,5,15,10].You are given q queries. During the i-th query, you are given two integers li and ri, and you have to calculate ri\xe2\x88\x91j=libj." 1900.0                                                
2025B "Binomial Coefficients, Kind Of" combinatorics,dp,math "Recently, akshiM met a task that needed binomial coefficients to solve. He wrote a code he usually does that looked like this:    for (int n = 0; n < N; n++) { // loop over n from 0 to N-1 (inclusive)        C[n][0] = 1;        C[n][n] = 1;        for (int k = 1; k < n; k++) // loop over k from 1 to n-1 (inclusive)            C[n][k] = C[n][k - 1] + C[n - 1][k - 1];    }Unfortunately, he made an error, since the right formula is the following:            C[n][k] = C[n - 1][k] + C[n - 1][k - 1]But his team member keblidA is interested in values that were produced using the wrong formula. Please help him to calculate these coefficients for t various pairs (ni,ki). Note that they should be calculated according to the first (wrong) formula.Since values C[ni][ki] may be too large, print them modulo 109+7." 1100.0                                                
2023C C+K+S "constructive algorithms,dfs and similar,graphs,greedy,hashing,implementation,strings" "You are given two strongly connected\xe2\x80\xa0 directed graphs, each with exactly n vertices, but possibly different numbers of edges. Upon closer inspection, you noticed an important feature \xe2\x80\x94 the length of any cycle in these graphs is divisible by k.Each of the 2n vertices belongs to exactly one of two types: incoming or outgoing. For each vertex, its type is known to you.You need to determine whether it is possible to draw exactly n directed edges between the source graphs such that the following four conditions are met:   The ends of any added edge lie in different graphs.  From each outgoing vertex, exactly one added edge originates.  Into each incoming vertex, exactly one added edge enters.  In the resulting graph, the length of any cycle is divisible by k. \xe2\x80\xa0A strongly connected graph is a graph in which there is a path from every vertex to every other vertex." 2400.0                                                
2023B Skipping "binary search,dp,graphs,shortest paths" "It is already the year 3024, ideas for problems have long run out, and the olympiad now takes place in a modified individual format. The olympiad consists of n problems, numbered from 1 to n. The i-th problem has its own score ai and a certain parameter bi (1\xe2\x89\xa4bi\xe2\x89\xa4n).Initially, the testing system gives the participant the first problem. When the participant is given the i-th problem, they have two options:   They can submit the problem and receive ai points;  They can skip the problem, in which case they will never be able to submit it. Then, the testing system selects the next problem for the participant from problems with indices j, such that:   If he submitted the i-th problem, it looks at problems with indices j<i;  If he skipped the i-th problem, it looks at problems with indices j\xe2\x89\xa4bi. Among these problems, it selects the problem with the maximum index that it has not previously given to the participant (he has neither submitted nor skipped it before). If there is no such problem, then the competition for the participant ends, and their result is equal to the sum of points for all submitted problems. In particular, if the participant submits the first problem, then the competition for them ends. Note that the participant receives each problem at most once.Prokhor has prepared thoroughly for the olympiad, and now he can submit any problem. Help him determine the maximum number of points he can achieve." 1700.0                                                
2019B "All Pairs Segments" implementation,math "Shirobon - FOX\xe2\xa0\x80You are given n points on the x axis, at increasing positive integer coordinates x1<x2<\xe2\x80\xa6<xn.For each pair (i,j) with 1\xe2\x89\xa4i<j\xe2\x89\xa4n, you draw the segment [xi,xj]. The segments are closed, i.e., a segment [a,b] contains the points a,a+1,\xe2\x80\xa6,b.You are given q queries. In the i-th query, you are given a positive integer ki, and you have to determine how many points with integer coordinates are contained in exactly ki segments." 1200.0                                                
2018C "Tree Pruning" "brute force,dfs and similar,greedy,sortings,trees" "t+pazolite, ginkiha, Hommarju - Paved Garden\xe2\xa0\x80You are given a tree with n nodes, rooted at node 1. In this problem, a leaf is a non-root node with degree 1.In one operation, you can remove a leaf and the edge adjacent to it (possibly, new leaves appear). What is the minimum number of operations that you have to perform to get a tree, also rooted at node 1, where all the leaves are at the same distance from the root?" 1700.0                                                
2014G "Milky Days" "brute force,data structures,greedy,implementation" "What is done is done, and the spoilt milk cannot be helped.Little John is as little as night is day \xe2\x80\x94 he was known to be a giant, at possibly 2.1 metres tall. It has everything to do with his love for milk.His dairy diary has n entries, showing that he acquired ai pints of fresh milk on day di. Milk declines in freshness with time and stays drinkable for a maximum of k days. In other words, fresh milk acquired on day di will be drinkable between days di and di+k\xe2\x88\x921 inclusive.Every day, Little John drinks drinkable milk, up to a maximum of m pints. In other words, if there are less than m pints of milk, he will drink them all and not be satisfied; if there are at least m pints of milk, he will drink exactly m pints and be satisfied, and it\'s a milk satisfaction day.Little John always drinks the freshest drinkable milk first.Determine the number of milk satisfaction days for Little John." 2200.0                                                
2013C "Password Cracking" "constructive algorithms,interactive,strings" "Dimash learned that Mansur wrote something very unpleasant about him to a friend, so he decided to find out his password at all costs and discover what exactly he wrote.Believing in the strength of his password, Mansur stated that his password \xe2\x80\x94 is a binary string of length n. He is also ready to answer Dimash\'s questions of the following type:Dimash says a binary string t, and Mansur replies whether it is true that t is a substring of his password.Help Dimash find out the password in no more than 2n operations; otherwise, Mansur will understand the trick and stop communicating with him." 1400.0                                                
2011D "Among Wolves" "*special problem" "In a game you started playing recently, there is a field that can be represented as a rectangular grid. The field has 2 rows and n columns \xe2\x80\x94 2n cells in total.Some cells are empty, but some are occupied by wolves. In the beginning of the game, you have one sheep in some cell, and you\'d like to save it from wolves.Wolves will attack you at night, so you still have some time for preparation. You have two ways to deal with wolves:   You pay h coins to hunters and choose a cell occupied by a wolf. Hunters will clear the cell, eradicating the wolf in it.  You pay b coins to builders and choose an empty cell. Builders will dig a trench in the chosen cell that wolves can\'t cross.  You can use both methods mentioned above any number of times and in any order.Let\'s say that a wolf can reach the sheep if there is a path that starts at the wolf\'s cell and finishes at the sheep\'s cell. This path shouldn\'t contain any cells with trenches, and each two consecutive cells in the path should be neighbors (share a side).What is the minimum total amount of money you should pay to ensure that none of the wolves can reach the sheep?" -999.0                                                
2010C2 "Message Transmission Error (hard version)" "hashing,string suffix structures,strings,two pointers" "This is a more difficult version of the problem. It differs from the easy one only by the constraints.At the Berland State University, the local network between servers does not always operate without errors. When transmitting two identical messages consecutively, an error may occur, resulting in the two messages merging into one. In this merging, the end of the first message coincides with the beginning of the second. Of course, the merging can only occur at identical characters. The length of the merging must be a positive number less than the length of the message text.For example, when transmitting two messages ""abrakadabra"" consecutively, it is possible that it will be transmitted with the described type of error, resulting in a message like ""abrakadabrabrakadabra"" or ""abrakadabrakadabra\' (in the first case, the merging occurred at one character, and in the second case, at four).Given the received message t, determine if it is possible that this is the result of an error of the described type in the operation of the local network, and if so, determine a possible value of s.A situation where two messages completely overlap each other should not be considered an error. For example, if the received message is ""abcd"", it should be considered that there is no error in it. Similarly, simply appending one message after another is not a sign of an error. For instance, if the received message is ""abcabc"", it should also be considered that there is no error in it." 1700.0                                                
2009G3 "Yunli\'s Subarray Queries (extreme version)" "data structures,dp,implementation" "This is the extreme version of the problem. In this version, the output of each query is different from the easy and hard versions. It is also guaranteed that r\xe2\x89\xa5l+k\xe2\x88\x921 for all queries.For an arbitrary array b, Yunli can perform the following operation any number of times:  Select an index i. Set bi=x where x is any integer she desires (x is not limited to the interval [1,n]). Denote f(b) as the minimum number of operations she needs to perform until there exists a consecutive subarray\xe2\x88\x97 of length at least k in b.Yunli is given an array a of size n and asks you q queries. In each query, you must output \xe2\x88\x91r\xe2\x88\x92k+1i=l\xe2\x88\x91rj=i+k\xe2\x88\x921f([ai,ai+1,\xe2\x80\xa6,aj]).\xe2\x88\x97If there exists a consecutive subarray of length k that starts at index i (1\xe2\x89\xa4i\xe2\x89\xa4|b|\xe2\x88\x92k+1), then bj=bj\xe2\x88\x921+1 for all i<j\xe2\x89\xa4i+k\xe2\x88\x921." 2700.0                                                
2009A Minimize! "brute force,math" "You are given two integers a and b (a\xe2\x89\xa4b). Over all possible integer values of c (a\xe2\x89\xa4c\xe2\x89\xa4b), find the minimum value of (c\xe2\x88\x92a)+(b\xe2\x88\x92c)." 800.0                                                
2008G "Sakurako\'s Task" "binary search,greedy,math,number theory" "Sakurako has prepared a task for you:She gives you an array of n integers and allows you to choose i and j such that i\xe2\x89\xa0j and ai\xe2\x89\xa5aj, and then assign ai=ai\xe2\x88\x92aj or ai=ai+aj. You can perform this operation any number of times for any i and j, as long as they satisfy the conditions.Sakurako asks you what is the maximum possible value of mexk\xe2\x88\x97 of the array after any number of operations.\xe2\x88\x97mexk is the k-th non-negative integer that is absent in the array. For example, mex1({1,2,3})=0, since 0 is the first element that is not in the array, and mex2({0,2,4})=3, since 3 is the second element that is not in the array." 1800.0                                                
2007B "Index and Maximum Value" "data structures,greedy" "After receiving yet another integer array a1,a2,\xe2\x80\xa6,an at her birthday party, Index decides to perform some operations on it.Formally, there are m operations that she is going to perform in order. Each of them belongs to one of the two types:  + l r. Given two integers l and r, for all 1\xe2\x89\xa4i\xe2\x89\xa4n such that l\xe2\x89\xa4ai\xe2\x89\xa4r, set ai:=ai+1.  - l r. Given two integers l and r, for all 1\xe2\x89\xa4i\xe2\x89\xa4n such that l\xe2\x89\xa4ai\xe2\x89\xa4r, set ai:=ai\xe2\x88\x921. For example, if the initial array a=[7,1,3,4,3], after performing the operation + 2 4, the array a=[7,1,4,5,4]. Then, after performing the operation - 1 10, the array a=[6,0,3,4,3].Index is curious about the maximum value in the array a. Please help her find it after each of the m operations." 900.0                                                
2006F "Dora\'s Paint" "brute force,combinatorics,constructive algorithms,graphs,implementation" "Sadly, Dora poured the paint when painting the class mural. Dora considers the mural as the matrix b of size n\xc3\x97n. Initially, bi,j=0 for all 1\xe2\x89\xa4i,j\xe2\x89\xa4n.Dora has only two brushes which have two different colors. In one operation, she can paint the matrix with one of two brushes:  The first brush has color 1 on it and can paint one column of the matrix. That is, Dora chooses 1\xe2\x89\xa4j\xe2\x89\xa4n and makes bi,j:=1 for all 1\xe2\x89\xa4i\xe2\x89\xa4n;  The second brush has color 2 on it and can paint one row of the matrix. That is, Dora chooses 1\xe2\x89\xa4i\xe2\x89\xa4n and makes bi,j:=2 for all 1\xe2\x89\xa4j\xe2\x89\xa4n. Dora paints the matrix so that the resulting matrix b contains only 1 and 2.For a matrix b, let f(b) denote the minimum number of operations needed to turn the initial matrix (containing only 0) into b. The beauty of a matrix b is the number of ways to paint the initial matrix in exactly f(b) operations to turn it into b. If there\'s no way to turn the initial matrix into b, the beauty of b is 0.However, Dora made a uniformly random mistake; there\'s exactly one element different in the matrix a given to you from the real matrix b. That is, there is exactly one pair (i,j) such that ai,j=3\xe2\x88\x92bi,j.Please help Dora compute the expected beauty of the real matrix b modulo 998244353 (all possible n2 mistakes have equal probability).Since the size of the matrix is too large, Dora will only tell you the positions of m elements of color 1, and the remaining n2\xe2\x88\x92m elements have color 2." 3500.0                                                
2006C "Eri and Expanded Sets" "data structures,divide and conquer,math,number theory,two pointers" "Let there be a set that contains distinct positive integers. To expand the set to contain as many integers as possible, Eri can choose two integers x\xe2\x89\xa0y from the set such that their average x+y2 is still a positive integer and isn\'t contained in the set, and add it to the set. The integers x and y remain in the set.Let\'s call the set of integers consecutive if, after the elements are sorted, the difference between any pair of adjacent elements is 1. For example, sets {2}, {2,5,4,3}, {5,6,8,7} are consecutive, while {2,4,5,6}, {9,7} are not.Eri likes consecutive sets. Suppose there is an array b, then Eri puts all elements in b into the set. If after a finite number of operations described above, the set can become consecutive, the array b will be called brilliant.Note that if the same integer appears in the array multiple times, we only put it into the set once, as a set always contains distinct positive integers.Eri has an array a of n positive integers. Please help him to count the number of pairs of integers (l,r) such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and the subarray al,al+1,\xe2\x80\xa6,ar is brilliant." 2300.0                                                
2005D "Alter the GCD" "binary search,brute force,data structures,divide and conquer,implementation,number theory" "You are given two arrays a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn.You must perform the following operation exactly once:  choose any indices l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n;  swap ai and bi for all i such that l\xe2\x89\xa4i\xe2\x89\xa4r. Find the maximum possible value of gcd(a1,a2,\xe2\x80\xa6,an)+gcd(b1,b2,\xe2\x80\xa6,bn) after performing the operation exactly once. Also find the number of distinct pairs (l,r) which achieve the maximum value." 2400.0                                                
2004G "Substring Compression" "data structures,dp,matrices" "Let\'s define the operation of compressing a string t, consisting of at least 2 digits from 1 to 9, as follows:   split it into an even number of non-empty substrings \xe2\x80\x94 let these substrings be t1,t2,\xe2\x80\xa6,tm (so, t=t1+t2+\xe2\x8b\xaf+tm, where + is the concatenation operation);  write the string t2 t1 times, then the string t4 t3 times, and so on. For example, for a string ""12345"", one could do the following: split it into (""1"", ""23"", ""4"", ""5""), and write ""235555"".Let the function f(t) for a string t return the minimum length of the string that can be obtained as a result of that process.You are given a string s, consisting of n digits from 1 to 9, and an integer k. Calculate the value of the function f for all contiguous substrings of s of length exactly k." 3200.0                                                
2003C "Turtle and Good Pairs" "constructive algorithms,greedy,sortings,strings" "Turtle gives you a string s, consisting of lowercase Latin letters.Turtle considers a pair of integers (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) to be a pleasant pair if and only if there exists an integer k such that i\xe2\x89\xa4k<j and both of the following two conditions hold:  sk\xe2\x89\xa0sk+1;  sk\xe2\x89\xa0si or sk+1\xe2\x89\xa0sj. Besides, Turtle considers a pair of integers (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) to be a good pair if and only if si=sj or (i,j) is a pleasant pair.Turtle wants to reorder the string s so that the number of good pairs is maximized. Please help him!" 1200.0                                                
2001E2 "Deterministic Heap (Hard Version)" combinatorics,dp,trees "This is the hard version of the problem. The difference between the two versions is the definition of deterministic max-heap, time limit, and constraints on n and t. You can make hacks only if both versions of the problem are solved.Consider a perfect binary tree with size 2n\xe2\x88\x921, with nodes numbered from 1 to 2n\xe2\x88\x921 and rooted at 1. For each vertex v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921\xe2\x88\x921), vertex 2v is its left child and vertex 2v+1 is its right child. Each node v also has a value av assigned to it.Define the operation pop as follows:  initialize variable v as 1;  repeat the following process until vertex v is a leaf (i.e. until 2n\xe2\x88\x921\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921);   among the children of v, choose the one with the larger value on it and denote such vertex as x; if the values on them are equal (i.e. a2v=a2v+1), you can choose any of them;  assign ax to av (i.e. av:=ax);  assign x to v (i.e. v:=x);   assign \xe2\x88\x921 to av (i.e. av:=\xe2\x88\x921). Then we say the pop operation is deterministic if there is a unique way to do such operation. In other words, a2v\xe2\x89\xa0a2v+1 would hold whenever choosing between them.A binary tree is called a max-heap if for every vertex v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921\xe2\x88\x921), both av\xe2\x89\xa5a2v and av\xe2\x89\xa5a2v+1 hold.A max-heap is deterministic if the pop operation is deterministic to the heap when we do it for the first and the second time.Initially, av:=0 for every vertex v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921), and your goal is to count the number of different deterministic max-heaps produced by applying the following operation add exactly k times:  Choose an integer v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921) and, for every vertex x on the path between 1 and v, add 1 to ax. Two heaps are considered different if there is a node which has different values in the heaps. Since the answer might be large, print it modulo p." 2900.0                                                
2001C "Guess The Tree" "binary search,brute force,dfs and similar,divide and conquer,dsu,greedy,interactive,trees" "This is an interactive problem.Misuki has chosen a secret tree with n nodes, indexed from 1 to n, and asked you to guess it by using queries of the following type:   ""? a b"" \xe2\x80\x94 Misuki will tell you which node x minimizes |d(a,x)\xe2\x88\x92d(b,x)|, where d(x,y) is the distance between nodes x and y. If more than one such node exists, Misuki will tell you the one which minimizes d(a,x). Find out the structure of Misuki\'s secret tree using at most 15n queries!" 1500.0                                                
2000C "Numeric String Template" "data structures,strings" "Kristina has an array a, called a template, consisting of n integers. She also has m strings, each consisting only of lowercase Latin letters. The strings are numbered from 1 to m. She wants to check which strings match the template.A string s is considered to match the template if all of the following conditions are simultaneously satisfied:  The length of the string s is equal to the number of elements in the array a. The same numbers from a correspond to the same symbols from s. So, if ai=aj, then si=sj for (1\xe2\x89\xa4i,j\xe2\x89\xa4n). The same symbols from s correspond to the same numbers from a. So, if si=sj, then ai=aj for (1\xe2\x89\xa4i,j\xe2\x89\xa4n). In other words, there must be a one-to-one correspondence between the characters of the string and the elements of the array.For example, if a = [3,5,2,1,3], then the string ""abfda"" matches the template, while the string ""afbfa"" does not, since the character ""f"" corresponds to both numbers 1 and 5." 1000.0                                                
1999A "A+B Again?" implementation,math "Given a two-digit positive integer n, find the sum of its digits." 800.0                                                
1997A "Strong Password" "brute force,implementation,strings" "Monocarp\'s current password on Codeforces is a string s, consisting of lowercase Latin letters. Monocarp thinks that his current password is too weak, so he wants to insert exactly one lowercase Latin letter into the password to make it stronger. Monocarp can choose any letter and insert it anywhere, even before the first character or after the last character.Monocarp thinks that the password\'s strength is proportional to the time it takes him to type the password. The time it takes to type the password is calculated as follows:  the time to type the first character is 2 seconds;  for each character other than the first, the time it takes to type it is 1 second if it is the same as the previous character, or 2 seconds otherwise. For example, the time it takes to type the password abacaba is 14; the time it takes to type the password a is 2; the time it takes to type the password aaabacc is 11.You have to help Monocarp \xe2\x80\x94 insert a lowercase Latin letter into his password so that the resulting password takes the maximum possible amount of time to type." 800.0                                                
1996E Decode "combinatorics,data structures,implementation,math" "In a desperate attempt to obtain your waifu favorite character, you have hacked into the source code of the game. After days of struggling, you finally find the binary string that encodes the gacha system of the game. In order to decode it, you must first solve the following problem. You are given a binary string s of length n. For each pair of integers (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), count the number of pairs (x,y) (l\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4r) such that the amount of 0 equals the amount of 1 in the substring sxsx+1...sy. Output the sum of counts over all possible (l,r) modulo 109+7." 1600.0                                                
1996C Sort dp,greedy,sortings,strings "You are given two strings a and b of length n. Then, you are (forced against your will) to answer q queries.For each query, you are given a range bounded by l and r. In one operation, you can choose an integer i (l\xe2\x89\xa4i\xe2\x89\xa4r) and set ai=x where x is any character you desire. Output the minimum number of operations you must perform such that sorted(a[l..r])=sorted(b[l..r]). The operations you perform on one query does not affect other queries.For an arbitrary string c, sorted(c[l..r]) denotes the substring consisting of characters cl,cl+1,...,cr sorted in lexicographical order." 1200.0                                                
1995A Diagonals "brute force,greedy,implementation,math" "Vitaly503 is given a checkered board with a side of n and k chips. He realized that all these k chips need to be placed on the cells of the board (no more than one chip can be placed on a single cell).Let\'s denote the cell in the i-th row and j-th column as (i,j). A diagonal is the set of cells for which the value i+j is the same. For example, cells (3,1), (2,2), and (1,3) lie on the same diagonal, but (1,2) and (2,3) do not. A diagonal is called occupied if it contains at least one chip. Determine what is the minimum possible number of occupied diagonals among all placements of k chips." 800.0                                                
1991G "Grid Reset" "constructive algorithms,greedy,implementation" "You are given a grid consisting of n rows and m columns, where each cell is initially white. Additionally, you are given an integer k, where 1\xe2\x89\xa4k\xe2\x89\xa4min(n,m).You will process q operations of two types:   H (horizontal operation) \xe2\x80\x94 You choose a 1\xc3\x97k rectangle completely within the grid, where all cells in this rectangle are white. Then, all cells in this rectangle are changed to black.  V (vertical operation) \xe2\x80\x94 You choose a k\xc3\x971 rectangle completely within the grid, where all cells in this rectangle are white. Then, all cells in this rectangle are changed to black. After each operation, if any rows or columns become completely black, all cells in these rows and columns are simultaneously reset to white. Specifically, if all cells in the row and column a cell is contained in become black, all cells in both the row and column will be reset to white.Choose the rectangles in a way that you can perform all given operations, or determine that it is impossible." 2700.0                                                
1991E "Coloring Game" "constructive algorithms,dfs and similar,games,graphs,greedy,interactive" "This is an interactive problem.Consider an undirected connected graph consisting of n vertices and m edges. Each vertex can be colored with one of three colors: 1, 2, or 3. Initially, all vertices are uncolored.Alice and Bob are playing a game consisting of n rounds. In each round, the following two-step process happens:   Alice chooses two different colors.  Bob chooses an uncolored vertex and colors it with one of the two colors chosen by Alice. Alice wins if there exists an edge connecting two vertices of the same color. Otherwise, Bob wins.You are given the graph. Your task is to decide which player you wish to play as and win the game." 1900.0                                                
1988A "Split the Multiset" "brute force,greedy,implementation,math" "A multiset is a set of numbers in which there can be equal elements, and the order of the numbers does not matter. For example, {2,2,4} is a multiset.You have a multiset S. Initially, the multiset contains only one positive integer n. That is, S={n}. Additionally, there is a given positive integer k.In one operation, you can select any positive integer u in S and remove one copy of u from S. Then, insert no more than k positive integers into S so that the sum of all inserted integers is equal to u.Find the minimum number of operations to make S contain n ones." 900.0                                                
1987F1 "Interesting Problem (Easy Version)" dp "This is the easy version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if both versions of the problem are solved.You are given an array of integers a of length n. In one operation, you will perform the following two-step process:   Choose an index i such that 1\xe2\x89\xa4i<|a| and ai=i.  Remove ai and ai+1 from the array and concatenate the remaining parts. Find the maximum number of times that you can perform the operation above." 2500.0                                                
1986G1 "Permutation Problem (Simple Version)" "binary search,brute force,combinatorics,data structures,math,number theory" "This is a simple version of the problem. The only difference is that in this version n\xe2\x89\xa4105 and the sum of n for all sets of input data does not exceed 105.You are given a permutation p of length n. Calculate the number of index pairs 1\xe2\x89\xa4i<j\xe2\x89\xa4n such that pi\xe2\x8b\x85pj is divisible by i\xe2\x8b\x85j without remainder.A permutation is a sequence of n integers, where each integer from 1 to n occurs exactly once. For example, [1], [3,5,2,1,4], [1,3,2] are permutations, while [2,3,2], [4,3,1], [0] are not." 2200.0                                                
1985D "Manhattan Circle" implementation,math "Given a n by m grid consisting of \'.\' and \'#\' characters, there exists a whole manhattan circle on the grid. The top left corner of the grid has coordinates (1,1), and the bottom right corner has coordinates (n,m).Point (a,b) belongs to the manhattan circle centered at (h,k) if |h\xe2\x88\x92a|+|k\xe2\x88\x92b|<r, where r is a positive constant.On the grid, the set of points that are part of the manhattan circle is marked as \'#\'. Find the coordinates of the center of the circle." 900.0                                                
1984C1 "Magnitude (Easy Version)" dp,greedy,math "The two versions of the problem are different. You may want to read both versions. You can make hacks only if both versions are solved.You are given an array a of length n. Start with c=0. Then, for each i from 1 to n (in increasing order) do exactly one of the following:   Option 1: set c to c+ai.  Option 2: set c to |c+ai|, where |x| is the absolute value of x. Let the maximum final value of c after the procedure described above be equal to k. Find k." 1300.0                                                
1983A "Array Divisibility" "constructive algorithms,math" "An array of integers a1,a2,\xe2\x8b\xaf,an is beautiful subject to an integer k if it satisfies the following:   The sum of aj over all j such that j is a multiple of k and 1\xe2\x89\xa4j\xe2\x89\xa4n, itself, is a multiple of k.  More formally, if \xe2\x88\x91k|jaj is divisible by k for all 1\xe2\x89\xa4j\xe2\x89\xa4n then the array a is beautiful subject to k. Here, the notation k|j means k divides j, that is, j is a multiple of k.  Given n, find an array of positive nonzero integers, with each element less than or equal to 105 that is beautiful subject to all 1\xe2\x89\xa4k\xe2\x89\xa4n.It can be shown that an answer always exists." 800.0                                                
1982E "Number of k-good subarrays" "bitmasks,brute force,combinatorics,divide and conquer,dp,math,meet-in-the-middle" "Let bit(x) denote the number of ones in the binary representation of a non-negative integer x.A subarray of an array is called k-good if it consists only of numbers with no more than k ones in their binary representation, i.e., a subarray (l,r) of array a is good if for any i such that l\xe2\x89\xa4i\xe2\x89\xa4r condition bit(ai)\xe2\x89\xa4k is satisfied.You are given an array a of length n, consisting of consecutive non-negative integers starting from 0, i.e., ai=i for 0\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 (in 0-based indexing). You need to count the number of k-good subarrays in this array.As the answer can be very large, output it modulo 109+7." 2300.0                                                
1982A Soccer greedy,implementation,math,sortings "Dima loves watching soccer. In such a game, the score on the scoreboard is represented as x : y, where x is the number of goals of the first team, and y is the number of goals of the second team. At any given time, only one team can score a goal, so the score x : y can change to either (x+1) : y, or x : (y+1).While watching a soccer game, Dima was distracted by very important matters, and after some time, he returned to watching the game. Dima remembers the score right before he was distracted, and the score right after he returned. Given these two scores, he wonders the following question. Is it possible that, while Dima was not watching the game, the teams never had an equal score?It is guaranteed that at neither of the two time points Dima remembers the teams had equal scores. However, it is possible that the score did not change during his absence.Help Dima and answer the question!" 800.0                                                
1980F2 "Field Division (hard version)" math,sortings "This is a hard version of the problem; it differs from the easy version only by the question. The easy version only needs you to print whether some values are non-zero or not. The hard version needs you to print the exact values.Alice and Bob are dividing the field. The field is a rectangle of size n\xc3\x97m (2\xe2\x89\xa4n,m\xe2\x89\xa4109); the rows are numbered from 1 to n from top to bottom, and the columns are numbered from 1 to m from left to right. The cell at the intersection of row r and column c is denoted as (r,c).Bob has k (2\xe2\x89\xa4k\xe2\x89\xa42\xe2\x8b\x85105) fountains, all of them are located in different cells of the field. Alice is responsible for dividing the field, but she must meet several conditions:  To divide the field, Alice will start her path in any free (without a fountain) cell on the left or top side of the field and will move, each time moving to the adjacent cell down or right. Her path will end on the right or bottom side of the field.  Alice\'s path will divide the field into two parts \xe2\x80\x94 one part will belong to Alice (this part includes the cells of her path), the other part \xe2\x80\x94 to Bob.  Alice will own the part that includes the cell (n,1).  Bob will own the part that includes the cell (1,m). Alice wants to divide the field in such a way as to get as many cells as possible.Bob wants to keep ownership of all the fountains, but he can give one of them to Alice. First, output the integer \xce\xb1 \xe2\x80\x94 the maximum possible size of Alice\'s plot, if Bob does not give her any fountain (i.e., all fountains will remain on Bob\'s plot).Then output k non-negative integers a1,a2,\xe2\x80\xa6,ak, where ai is a value such that after Bob gives Alice the i-th fountain, the maximum size of her plot will be \xce\xb1+ai." 2400.0                                                
1980B "Choosing Cubes" sortings,sortings "Dmitry has n cubes, numbered from left to right from 1 to n. The cube with index f is his favorite.Dmitry threw all the cubes on the table, and the i-th cube showed the value ai (1\xe2\x89\xa4ai\xe2\x89\xa4100). After that, he arranged the cubes in non-increasing order of their values, from largest to smallest. If two cubes show the same value, they can go in any order.After sorting, Dmitry removed the first k cubes. Then he became interested in whether he removed his favorite cube (note that its position could have changed after sorting).For example, if n=5, f=2, a=[4,3,3,2,3] (the favorite cube is highlighted in green), and k=2, the following could have happened:  After sorting a=[4,3,3,3,2], since the favorite cube ended up in the second position, it will be removed.  After sorting a=[4,3,3,3,2], since the favorite cube ended up in the third position, it will not be removed." 800.0                                                
1978C "Manhattan Permutations" "constructive algorithms,data structures,greedy,implementation,math" "Let\'s call the Manhattan value of a permutation\xe2\x80\xa0 p the value of the expression |p1\xe2\x88\x921|+|p2\xe2\x88\x922|+\xe2\x80\xa6+|pn\xe2\x88\x92n|.For example, for the permutation [1,2,3], the Manhattan value is |1\xe2\x88\x921|+|2\xe2\x88\x922|+|3\xe2\x88\x923|=0, and for the permutation [3,1,2], the Manhattan value is |3\xe2\x88\x921|+|1\xe2\x88\x922|+|2\xe2\x88\x923|=2+1+1=4.You are given integers n and k. Find a permutation p of length n such that its Manhattan value is equal to k, or determine that no such permutation exists.\xe2\x80\xa0A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1300.0                                                
1977B "Binary Colouring" "bitmasks,constructive algorithms,greedy,math" "You are given a positive integer x. Find any array of integers a0,a1,\xe2\x80\xa6,an\xe2\x88\x921 for which the following holds:   1\xe2\x89\xa4n\xe2\x89\xa432,  ai is 1, 0, or \xe2\x88\x921 for all 0\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921,  x=n\xe2\x88\x921\xe2\x88\x91i=0ai\xe2\x8b\x852i,  There does not exist an index 0\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922 such that both ai\xe2\x89\xa00 and ai+1\xe2\x89\xa00. It can be proven that under the constraints of the problem, a valid array always exists." 1100.0                                                
1976A "Verify Password" implementation,sortings,strings "Monocarp is working on his new site, and the current challenge is to make the users pick strong passwords.Monocarp decided that strong passwords should satisfy the following conditions:   password should consist only of lowercase Latin letters and digits;  there should be no digit that comes after a letter (so, after each letter, there is either another letter or the string ends);  all digits should be sorted in the non-decreasing order;  all letters should be sorted in the non-decreasing order. Note that it\'s allowed for the password to have only letters or only digits.Monocarp managed to implement the first condition, but he struggles with the remaining ones. Can you help him to verify the passwords?" 800.0                                                
1973D "Cat, Fox and Maximum Array Split" "brute force,interactive,math" "This is an interactive problem.Fox gave Cat two positive integers n and k. She has a hidden array a1,\xe2\x80\xa6,an of length n, such that 1\xe2\x89\xa4ai\xe2\x89\xa4n for every i. Now they are going to play the following game:For any two integers l,r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, define f(l,r)=(r\xe2\x88\x92l+1)\xe2\x8b\x85rmaxx=lax. In other words, f(l,r) is equal to the maximum of the subarray al,\xe2\x80\xa6,ar multiplied by its size.Cat can ask Fox at most 2n questions about the array. He will tell her two integers l and x (1\xe2\x89\xa4l\xe2\x89\xa4n,1\xe2\x89\xa4x\xe2\x89\xa4109), and she will tell him one integer p as the answer \xe2\x80\x94 the smallest positive integer r such that f(l,r)=x, or n+1 if no such r exists.Now, Cat needs to find the largest value m such that there exists a sequence c1,\xe2\x80\xa6,ck\xe2\x88\x921 such that 1\xe2\x89\xa4c1<\xe2\x80\xa6<ck\xe2\x88\x921<n and f(1,c1)=f(c1+1,c2)=\xe2\x80\xa6=f(ck\xe2\x88\x921+1,n)=m. If no such m exists, he should indicate this and take \xe2\x88\x921 as the answer. Note that for k=1, m is always equal to f(1,n).In other words, the goal is to find the largest m such that you can split the array into exactly k subarrays (k is the constant given to you in the beginning of the interaction) so that all the subarrays have the product of their length and their maximum equal to m, or determine that no such m exists. Every element should belong in exactly one of the subarrays.Cat doesn\'t know what he should do, so he asked you to play the game for him." 2400.0                                                
1972B "Coin Games" games "There are n coins on the table forming a circle, and each coin is either facing up or facing down. Alice and Bob take turns to play the following game, and Alice goes first.In each operation, the player chooses a facing-up coin, removes the coin, and flips the two coins that are adjacent to it. If (before the operation) there are only two coins left, then one will be removed and the other won\'t be flipped (as it would be flipped twice). If (before the operation) there is only one coin left, no coins will be flipped. If (before the operation) there are no facing-up coins, the player loses.Decide who will win the game if they both play optimally. It can be proved that the game will end in a finite number of operations, and one of them will win." 900.0                                                
1971G XOUR "data structures,dsu,sortings" "You are given an array a consisting of n nonnegative integers. You can swap the elements at positions i and j if ai XOR aj<4, where XOR is the bitwise XOR operation.Find the lexicographically smallest array that can be made with any number of swaps.An array x is lexicographically smaller than an array y if in the first position where x and y differ, xi<yi." 1700.0                                                
1971F "Circle Perimeter" "binary search,brute force,dfs and similar,geometry,implementation,math" "Given an integer r, find the number of lattice points that have a Euclidean distance from (0,0) greater than or equal to r but strictly less than r+1.A lattice point is a point with integer coordinates. The Euclidean distance from (0,0) to the point (x,y) is \xe2\x88\x9ax2+y2." 1600.0                                                
1971C "Clock and Strings" implementation "There is a clock labeled with the numbers 1 through 12 in clockwise order, as shown below. In this example, (a,b,c,d)=(2,9,10,6), and the strings intersect. Alice and Bob have four distinct integers a, b, c, d not more than 12. Alice ties a red string connecting a and b, and Bob ties a blue string connecting c and d. Do the strings intersect? (The strings are straight line segments.)" 900.0                                                
1970C2 "Game on Tree (Medium)" "dfs and similar,dp,games,trees" "This is the medium version of the problem. The difference in this version is that t=1 and we work on trees.Ron and Hermione are playing a game on a tree of n nodes that are initially inactive. The game consists of t rounds, each of which starts with a stone on exactly one node, which is considered as activated. A move consists of picking an inactive neighbor of the node with a stone on it and moving the stone there (thus activating this neighbor). Ron makes the first move, after which he alternates with Hermione until no valid move is available. The player that cannot make a move loses the round. If both players play optimally, who wins each round of this game? Note that all the rounds are played with the same tree; only the starting node changes. Moreover, after each round, all active nodes are considered inactive again." 1700.0                                                
1968B Prefiquence "greedy,two pointers" "You are given two binary strings a and b. A binary string is a string consisting of the characters \'0\' and \'1\'.Your task is to determine the maximum possible number k such that a prefix of string a of length k is a subsequence of string b.A sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) elements." 800.0                                                
1967F "Next and Prev" "brute force,data structures,implementation" "Let p1,\xe2\x80\xa6,pn be a permutation of [1,\xe2\x80\xa6,n].Let the q-subsequence of p be a permutation of [1,q], whose elements are in the same relative order as in p1,\xe2\x80\xa6,pn. That is, we extract all elements not exceeding q together from p in the original order, and they make the q-subsequence of p.For a given array a, let pre(i) be the largest value satisfying pre(i)<i and apre(i)>ai. If it does not exist, let pre(i)=\xe2\x88\x9210100. Let nxt(i) be the smallest value satisfying nxt(i)>i and anxt(i)>ai. If it does not exist, let nxt(i)=10100.For each q such that 1\xe2\x89\xa4q\xe2\x89\xa4n, let a1,\xe2\x80\xa6,aq be the q-subsequence of p. For each i such that 1\xe2\x89\xa4i\xe2\x89\xa4q, pre(i) and nxt(i) will be calculated as defined. Then, you will be given some integer values of x, and for each of them you have to calculate q\xe2\x88\x91i=1min(nxt(i)\xe2\x88\x92pre(i),x)." 3200.0                                                
1967B1 "Reverse Card (Easy Version)" "brute force,math,number theory" "The two versions are different problems. You may want to read both versions. You can make hacks only if both versions are solved.You are given two positive integers n, m.Calculate the number of ordered pairs (a,b) satisfying the following conditions:  1\xe2\x89\xa4a\xe2\x89\xa4n, 1\xe2\x89\xa4b\xe2\x89\xa4m;  a+b is a multiple of b\xe2\x8b\x85gcd(a,b)." 1400.0                                                
1958A 1-3-5 "*special problem,dp" "In Berland, coins of worth 1, 3 and 5 burles are commonly used (burles are local currency).Eva has to pay exactly n burles in a shop. She has an infinite amount of coins of all three types. However, she doesn\'t like to pay using coins worth 1 burle \xe2\x80\x94 she thinks they are the most convenient to use.Help Eva to calculate the minimum number of coins worth 1 burle she has to use, if she has to pay exactly n burles. Note that she can spend any number of coins worth 3 and/or 5 burles." 1100.0                                                
1956D "Nene and the Mex Operator" "bitmasks,brute force,constructive algorithms,divide and conquer,dp,greedy,implementation,math" "Nene gave you an array of integers a1,a2,\xe2\x80\xa6,an of length n.You can perform the following operation no more than 5\xe2\x8b\x85105 times (possibly zero):  Choose two integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, compute x as MEX({al,al+1,\xe2\x80\xa6,ar}), and simultaneously set al:=x,al+1:=x,\xe2\x80\xa6,ar:=x. Here, MEX of a set of integers {c1,c2,\xe2\x80\xa6,ck} is defined as the smallest non-negative integer m which does not occur in the set c.Your goal is to maximize the sum of the elements of the array a. Find the maximum sum and construct a sequence of operations that achieves this sum. Note that you don\'t need to minimize the number of operations in this sequence, you only should use no more than 5\xe2\x8b\x85105 operations in your solution." 2000.0                                                
1952I "Dark Matter" bitmasks,geometry "View the statement as a PDF." -999.0                                                
1952E "Sweep Line" combinatorics,games,math "Be careful not to make a mistake. You might have to start all over again.\xe2\x80\x94 Someone, probably" -999.0                                                
1950B Upscaling implementation "You are given an integer n. Output a 2n\xc3\x972n checkerboard made of 2\xc3\x972 squares alternating \'#\' and \'.\', with the top-left cell being \'#\'.  The picture above shows the answers for n=1,2,3,4." 800.0                                                
1949H "Division Avoidance" greedy,math "A newly discovered organism can be represented as a set of cells on an infinite grid. There is a coordinate system on the grid such that each cell has two integer coordinates x and y. A cell with coordinates x=a and y=b will be denoted as (a,b).Initially, the organism consists of a single cell (0,0). Then zero or more divisions can happen. In one division, a cell (a,b) is removed and replaced by two cells (a+1,b) and (a,b+1).For example, after the first division, the organism always consists of two cells (1,0) and (0,1), and after the second division, it is either the three cells (2,0), (1,1) and (0,1), or the three cells (1,0), (1,1) and (0,2).A division of a cell (a,b) can only happen if the cells (a+1,b) and (a,b+1) are not yet part of the organism. For example, the cell (1,0) cannot divide if the organism currently consists of the three cells (1,0), (1,1) and (0,2), since the cell (1,1) that would be one of the results of this division is already part of the organism.You are given a set of forbidden cells (ci,di). Is it possible for the organism to contain none of those cells after zero or more divisions?" 3100.0                                                
1949D "Funny or Scary?" "constructive algorithms" "You are designing a new video game. It has n scenarios, which the player may play in any order, but each scenario must be played exactly once. When a player switches from a scenario to another scenario, the game shows a specially crafted transition video to make it all feel part of one big story. This video is specific to a pair of scenarios, but not to their order, in other words, the video playing when switching from scenario a to scenario b is the same as the video playing when switching from scenario b to scenario a. Therefore, you need to create n(n\xe2\x88\x921)2 different transition videos, one for each possible pair of different scenarios.Each transition video can be either funny or scary. It is boring to see too many funny videos or too many scary videos in a row. Therefore, your goal is to create the videos in such a way that no matter in which order does the player approach the scenarios, they will never see more than \xe2\x8c\x883n4\xe2\x8c\x89 transition videos of the same type in a row.You have already come up with ideas for at most \xe2\x8c\x8an2\xe2\x8c\x8b of the transition videos, and therefore already know if those will be funny or scary. Now you need to choose funny or scary for all other transition videos in such a way that the above requirement is satisfied." 2600.0                                                
1949C "Annual Ants\' Gathering" "dfs and similar,dp,greedy,trees" "Deep within a forest lies an ancient tree, home to nn ants living in nn tiny houses, indexed from 11 to nn, connected by the branches of the tree.  Once a year, all the ants need to gather to watch the EUC. For this, all ants move along the n\xe2\x88\x921n\xe2\x88\x921 branches of the tree they live on to meet at the home of one ant.However, this year the ants could not agree on where to meet and need your help to gather up. You can tell all the ants currently at house uu to move to house vv if there is a branch directly connecting those two houses. However, the ants ignore your command if there are fewer ants gathered in house vv than in house uu, i.e., if it would be easier for the ants from house vv to move. This even holds true if no ant at all is currently in house vv. You can give this kind of commands as many times as you want.Is it possible for you to gather all the ants in a single house?" 1900.0                                                
1948G "MST with Matching" "bitmasks,brute force,dsu,graph matchings,trees" "You are given an undirected connected graph on n vertices. Each edge of this graph has a weight; the weight of the edge connecting vertices i and j is wi,j (or wi,j=0 if there is no edge between i and j). All weights are positive integers.You are also given a positive integer c.You have to build a spanning tree of this graph; i.\xe2\x80\x89e. choose exactly (n\xe2\x88\x921) edges of this graph in such a way that every vertex can be reached from every other vertex by traversing some of the chosen edges. The cost of the spanning tree is the sum of two values:  the sum of weights of all chosen edges;  the maximum matching in the spanning tree (i.\xe2\x80\x89e. the maximum size of a set of edges such that they all belong to the chosen spanning tree, and no vertex has more than one incident edge in this set), multiplied by the given integer c. Find any spanning tree with the minimum cost. Since the graph is connected, there exists at least one spanning tree." 3100.0                                                
1946F "Nobody is needed" "2-sat,data structures,dfs and similar,dp" "Oleg received a permutation a of length n as a birthday present.Oleg\'s friend Nechipor asks Oleg q questions, each question is characterized by two numbers l and r, in response to the question Oleg must say the number of sets of indices (t1,t2,\xe2\x80\xa6,tk) of any length k\xe2\x89\xa51 such that:   l\xe2\x89\xa4ti\xe2\x89\xa4r for each i from 1 to k.  ti<ti+1 for each i from 1 to k\xe2\x88\x921.  ati+1 is divisible by ati for each i from 1 to k\xe2\x88\x921. Help Oleg and answer all of Nechipor\'s questions." 2500.0                                                
1946D "Birthday Gift" "bitmasks,brute force,constructive algorithms,greedy,implementation" "Yarik\'s birthday is coming soon, and Mark decided to give him an array a of length n.Mark knows that Yarik loves bitwise operations very much, and he also has a favorite number x, so Mark wants to find the maximum number k such that it is possible to select pairs of numbers [l1,r1], [l2,r2], \xe2\x80\xa6 [lk,rk], such that:   l1=1.  rk=n.  li\xe2\x89\xa4ri for all i from 1 to k.  ri+1=li+1 for all i from 1 to k\xe2\x88\x921.  (al1\xe2\x8a\x95al1+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar1)|(al2\xe2\x8a\x95al2+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar2)|\xe2\x80\xa6|(alk\xe2\x8a\x95alk+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ark)\xe2\x89\xa4x, where \xe2\x8a\x95 denotes the operation of bitwise XOR, and | denotes the operation of bitwise OR. If such k does not exist, then output \xe2\x88\x921." 1900.0                                                
1945G "Cook and Porridge" "binary search,constructive algorithms,data structures,implementation" "Finally, lunchtime!n schoolchildren have lined up in a long queue at the cook\'s tent for porridge. The cook will be serving porridge for D minutes. The schoolchild standing in the i-th position in the queue has a priority of ki and eats one portion of porridge in si minutes.At the beginning of each minute of the break, the cook serves the first schoolchild in the queue one portion of porridge, after which the schoolchild goes to eat their portion. If the i-th schoolchild is served a portion at the beginning of the x-th minute, then they will return to the queue at the end of the (x+si)-th minute.When the i-th schoolchild returns to the queue, the schoolchildren at the end of the queue whose priority is strictly lower than that of the i-th schoolchild must let them pass. Thus, they will stand in the queue behind the last schoolchild whose priority is not lower than their own. That is, behind the last schoolchild j with kj\xe2\x89\xa5ki. If there is no such schoolchild in the queue, the i-th schoolchild will stand at the front of the queue.If several schoolchildren return at the same time, they will return to the queue in ascending order of their si.For example, if n=3, D=3, k=[2,3,2], and s=[2,1,3], the serving will occur as follows:  At the beginning of minute 1, the students in the queue are [1,2,3], and student 1 is served porridge;  at the beginning of minute 2, the students in the queue are [2,3], and student 2 is served porridge;  at the beginning of minute 3, the student in the queue is [3], and student 3 is served porridge;  at the end of minute 3, student 2 returns to the queue, and the queue becomes [2];  at the end of minute 3, student 1 returns to the queue, and the queue becomes [2,1], as his priority is lower. Determine the minimum number of minutes after the start of the break that each schoolchild will receive porridge at least once, or report that this will not happen within D minutes." 2500.0                                                
1945B Fireworks "math,number theory" "One of the days of the hike coincided with a holiday, so in the evening at the camp, it was decided to arrange a festive fireworks display. For this purpose, the organizers of the hike bought two installations for launching fireworks and a huge number of shells for launching.Both installations are turned on simultaneously. The first installation launches fireworks every a minutes (i.e., after a,2\xe2\x8b\x85a,3\xe2\x8b\x85a,\xe2\x80\xa6 minutes after launch). The second installation launches fireworks every b minutes (i.e., after b,2\xe2\x8b\x85b,3\xe2\x8b\x85b,\xe2\x80\xa6 minutes after launch).Each firework is visible in the sky for m+1 minutes after launch, i.e., if a firework was launched after x minutes after the installations were turned on, it will be visible every minute from x to x+m, inclusive. If one firework was launched m minutes after another, both fireworks will be visible for one minute.What is the maximum number of fireworks that could be seen in the sky at the same time?" 900.0                                                
1943D2 "Counting Is Fun (Hard Version)" combinatorics,dp "This is the hard version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if both versions of the problem are solved.An array b of m non-negative integers is said to be good if all the elements of b can be made equal to 0 using the following operation some (possibly, zero) times:   Select two distinct indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4m) and subtract 1 from all bi such that l\xe2\x89\xa4i\xe2\x89\xa4r. You are given two positive integers n, k and a prime number p.Over all (k+1)n arrays of length n such that 0\xe2\x89\xa4ai\xe2\x89\xa4k for all 1\xe2\x89\xa4i\xe2\x89\xa4n, count the number of good arrays.Since the number might be too large, you are only required to find it modulo p." 2800.0                                                
1943B "Non-Palindromic Substring" hashing,implementation,math,strings "A string t is said to be k-good if there exists at least one substring\xe2\x80\xa0 of length k which is not a palindrome\xe2\x80\xa1. Let f(t) denote the sum of all values of k such that the string t is k-good.You are given a string s of length n. You will have to answer q of the following queries:  Given l and r (l<r), find the value of f(slsl+1\xe2\x80\xa6sr). \xe2\x80\xa0 A substring of a string z is a contiguous segment of characters from z. For example, ""defor"", ""code"" and ""o"" are all substrings of ""codeforces"" while ""codes"" and ""aaa"" are not.\xe2\x80\xa1 A palindrome is a string that reads the same backwards as forwards. For example, the strings ""z"", ""aa"" and ""tacocat"" are palindromes while ""codeforces"" and ""ab"" are not." 2000.0                                                
1943A "MEX Game 1" games,greedy "Alice and Bob play yet another game on an array a of size n. Alice starts with an empty array c. Both players take turns playing, with Alice starting first.On Alice\'s turn, she picks one element from a, appends that element to c, and then deletes it from a.On Bob\'s turn, he picks one element from a, and then deletes it from a. The game ends when the array a is empty. Game\'s score is defined to be the MEX\xe2\x80\xa0 of c. Alice wants to maximize the score while Bob wants to minimize it. Find game\'s final score if both players play optimally.\xe2\x80\xa0 The MEX (minimum excludant) of an array of integers is defined as the smallest non-negative integer which does not occur in the array. For example:   The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0, 1, 2 and 3 belong to the array, but 4 does not." 1300.0                                                
1942H "Farmer John\'s Favorite Intern" "data structures,dp,flows,trees" "Peaches...\xe2\xa0\x80Ruby just won an internship position at Farmer John\'s farm by winning a coding competition! As the newly recruited intern, Ruby is tasked with maintaining Farmer John\'s peach tree, a tree consisting of n nodes rooted at node 1. Each node initially contains ai=0 peaches, and there are two types of events that can happen:   Growth event at some node x: Ruby must choose either the parent of x or any node in the subtree of x and increase the amount of peaches it contains by one.  Harvest event at some node x: Ruby must choose a single node that is in the subtree of x and decrease the amount of peaches it contains by one. Note that this is not the same set of nodes as the growth event.  Note that the subtree of x includes the node x as well.Ruby is also given an array b of length n. The peach tree is deemed healthy if ai\xe2\x89\xa5bi for every node i.Ruby is asked to perform q operations of two types:   1 x v \xe2\x80\x94 Perform v growth events on node x. Ruby does not have to choose the same node to increase in every growth event.  2 x v \xe2\x80\x94 Perform v harvest events on node x. Ruby does not have to choose the same node to decrease in every harvest event. For every prefix of operations, Ruby asks you to find if she can perform these operations in some order such that the resulting peach tree (at the end of these operations) is healthy. Note that Ruby can\'t perform a harvest event that makes any ai negative.Every prefix is independent, meaning that for a given operation, Ruby may choose different nodes to perform events on for every prefix that contains that operation." 3500.0                                                
1942B "Bessie and MEX" "constructive algorithms,math" "MOOO! - Doja Cat\xe2\xa0\x80Farmer John has a permutation p1,p2,\xe2\x80\xa6,pn, where every integer from 0 to n\xe2\x88\x921 occurs exactly once. He gives Bessie an array a of length n and challenges her to construct p based on a. The array a is constructed so that ai = MEX(p1,p2,\xe2\x80\xa6,pi)\xe2\x88\x92pi, where the MEX of an array is the minimum non-negative integer that does not appear in that array. For example, MEX(1,2,3)=0 and MEX(3,1,0)=2.Help Bessie construct any valid permutation p that satisfies a. The input is given in such a way that at least one valid p exists. If there are multiple possible p, it is enough to print one of them." 1100.0                                                
1941E "Rudolf and k Bridges" "binary search,data structures,dp,two pointers" "Bernard loves visiting Rudolf, but he is always running late. The problem is that Bernard has to cross the river on a ferry. Rudolf decided to help his friend solve this problem.The river is a grid of n rows and m columns. The intersection of the i-th row and the j-th column contains the number ai,j \xe2\x80\x94 the depth in the corresponding cell. All cells in the first and last columns correspond to the river banks, so the depth for them is 0.  The river may look like this. Rudolf can choose the row (i,1),(i,2),\xe2\x80\xa6,(i,m) and build a bridge over it. In each cell of the row, he can install a support for the bridge. The cost of installing a support in the cell (i,j) is ai,j+1. Supports must be installed so that the following conditions are met:  A support must be installed in cell (i,1);  A support must be installed in cell (i,m);  The distance between any pair of adjacent supports must be no more than d. The distance between supports (i,j1) and (i,j2) is |j1\xe2\x88\x92j2|\xe2\x88\x921. Building just one bridge is boring. Therefore, Rudolf decided to build k bridges on consecutive rows of the river, that is, to choose some i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k+1) and independently build a bridge on each of the rows i,i+1,\xe2\x80\xa6,i+k\xe2\x88\x921. Help Rudolf minimize the total cost of installing supports." 1600.0                                                
1933F "Turtle Mission: Robot and the Earthquake" "dfs and similar,dp,graphs,shortest paths" "The world is a grid with n rows and m columns. The rows are numbered 0,1,\xe2\x80\xa6,n\xe2\x88\x921, while the columns are numbered 0,1,\xe2\x80\xa6,m\xe2\x88\x921. In this world, the columns are cyclic (i.e. the top and the bottom cells in each column are adjacent). The cell on the i-th row and the j-th column (0\xe2\x89\xa4i<n,0\xe2\x89\xa4j<m) is denoted as (i,j). At time 0, the cell (i,j) (where 0\xe2\x89\xa4i<n,0\xe2\x89\xa4j<m) contains either a rock or nothing. The state of cell (i,j) can be described using the integer ai,j:   If ai,j=1, there is a rock at (i,j).  If ai,j=0, there is nothing at (i,j). As a result of aftershocks from the earthquake, the columns follow tectonic plate movements: each column moves cyclically upwards at a velocity of 1 cell per unit of time. Formally, for some 0\xe2\x89\xa4i<n,0\xe2\x89\xa4j<m, if (i,j) contains a rock at the moment, it will move from (i,j) to (i\xe2\x88\x921,j) (or to (n\xe2\x88\x921,j) if i=0). The robot called RT is initially positioned at (0,0). It has to go to (n\xe2\x88\x921,m\xe2\x88\x921) to carry out an earthquake rescue operation (to the bottom rightmost cell). The earthquake doesn\'t change the position of the robot, they only change the position of rocks in the world.Let RT\'s current position be (x,y) (0\xe2\x89\xa4x<n,0\xe2\x89\xa4y<m), it can perform the following operations:   Go one cell cyclically upwards, i.e. from (x,y) to ((x+n\xe2\x88\x921)modn,y) using 1 unit of time.  Go one cell cyclically downwards, i.e. (x,y) to ((x+1)modn,y) using 1 unit of time.  Go one cell to the right, i.e. (x,y) to (x,y+1) using 1 unit of time. (RT may perform this operation only if y<m\xe2\x88\x921.) Note that RT cannot go left using the operations nor can he stay at a position.Unfortunately, RT will explode upon colliding with a rock. As such, when RT is at (x,y) and there is a rock at ((x+1)modn,y) or ((x+2)modn,y), RT cannot move down or it will be hit by the rock.   Similarly, if y+1<m and there is a rock at ((x+1)modn,y+1), RT cannot move right or it will be hit by the rock.  However, it is worth noting that if there is a rock at (xmodn,y+1) and ((x+1)modn,y), RT can still move right safely.  Find the minimum amount of time RT needs to reach (n\xe2\x88\x921,m\xe2\x88\x921) without colliding with any rocks. If it is impossible to do so, output \xe2\x88\x921." 2100.0                                                
1933D "Turtle Tenacity: Continual Mods" "constructive algorithms,greedy,math,number theory,sortings" "Given an array a1,a2,\xe2\x80\xa6,an, determine whether it is possible to rearrange its elements into b1,b2,\xe2\x80\xa6,bn, such that b1modb2mod\xe2\x80\xa6modbn\xe2\x89\xa00.Here xmody denotes the remainder from dividing x by y. Also, the modulo operations are calculated from left to right. That is, xmodymodz=(xmody)modz. For example, 2024mod1000mod8=(2024mod1000)mod8=24mod8=0." 1200.0                                                
1932C LR-remainders "brute force,data structures,implementation,math,two pointers" "You are given an array a of length n, a positive integer m, and a string of commands of length n. Each command is either the character \'L\' or the character \'R\'.Process all n commands in the order they are written in the string s. Processing a command is done as follows:  First, output the remainder of the product of all elements of the array a when divided by m.  Then, if the command is \'L\', remove the leftmost element from the array a, if the command is \'R\', remove the rightmost element from the array a. Note that after each move, the length of the array a decreases by 1, and after processing all commands, it will be empty.Write a program that will process all commands in the order they are written in the string s (from left to right)." 1400.0                                                
1930H "Interactive Mex Tree" "constructive algorithms,dfs and similar,interactive,trees" "This is an interactive problem.Alice has a tree T consisting of n nodes, numbered from 1 to n. Alice will show T to Bob. After observing T, Bob needs to tell Alice two permutations p1 and p2 of [1,2,\xe2\x80\xa6,n].Then, Alice will play q rounds of the following game.  Alice will create an array a that is a permutation of [0,1,\xe2\x80\xa6,n\xe2\x88\x921]. The value of node v will be av.  Alice will choose two nodes u and v (1\xe2\x89\xa4u,v\xe2\x89\xa4n, u\xe2\x89\xa0v) of T and tell them to Bob. Bob will need to find the MEX\xe2\x80\xa0 of the values on the unique simple path between nodes u and v.  To find this value, Bob can ask Alice at most 5 queries. In each query, Bob should give three integers t, l and r to Alice such that t is either 1 or 2, and 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. Alice will then tell Bob the value equal to rmini=la[pt,i]. Note that all rounds are independent of each other. In particular, the values of a, u and v can be different in different rounds.Bob is puzzled as he only knows the HLD solution, which requires O(log(n)) queries per round. So he needs your help to win the game. \xe2\x80\xa0 The MEX (minimum excludant) of a collection of integers c1,c2,\xe2\x80\xa6,ck is defined as the smallest non-negative integer x which does not occur in the collection c." 3300.0                                                
1929D "Sasha and a Walk in the City" combinatorics,dp,math,trees "Sasha wants to take a walk with his girlfriend in the city. The city consists of n intersections, numbered from 1 to n. Some of them are connected by roads, and from any intersection, there is exactly one simple path\xe2\x80\xa0 to any other intersection. In other words, the intersections and the roads between them form a tree.Some of the intersections are considered dangerous. Since it is unsafe to walk alone in the city, Sasha does not want to visit three or more dangerous intersections during the walk.Sasha calls a set of intersections good if the following condition is satisfied: If in the city only the intersections contained in this set are dangerous, then any simple path in the city contains no more than two dangerous intersections.However, Sasha does not know which intersections are dangerous, so he is interested in the number of different good sets of intersections in the city. Since this number can be very large, output it modulo 998244353.\xe2\x80\xa0A simple path is a path that passes through each intersection at most once." 1900.0                                                
1928A "Rectangle Cutting" geometry,math "Bob has a rectangle of size a\xc3\x97b. He tries to cut this rectangle into two rectangles with integer sides by making a cut parallel to one of the sides of the original rectangle. Then Bob tries to form some other rectangle from the two resulting rectangles, and he can rotate and move these two rectangles as he wishes.Note that if two rectangles differ only by a 90\xe2\x88\x98 rotation, they are considered the same. For example, the rectangles 6\xc3\x974 and 4\xc3\x976 are considered the same.Thus, from the 2\xc3\x976 rectangle, another rectangle can be formed, because it can be cut into two 2\xc3\x973 rectangles, and then these two rectangles can be used to form the 4\xc3\x973 rectangle, which is different from the 2\xc3\x976 rectangle.  However, from the 2\xc3\x971 rectangle, another rectangle cannot be formed, because it can only be cut into two rectangles of 1\xc3\x971, and from these, only the 1\xc3\x972 and 2\xc3\x971 rectangles can be formed, which are considered the same.  Help Bob determine if he can obtain some other rectangle, or if he is just wasting his time." 800.0                                                
1927G "Paint Charges" "data structures,dp,greedy,math" "A horizontal grid strip of n cells is given. In the i-th cell, there is a paint charge of size ai. This charge can be:  either used to the left \xe2\x80\x94 then all cells to the left at a distance less than ai (from max(i\xe2\x88\x92ai+1,1) to i inclusive) will be painted,  or used to the right \xe2\x80\x94 then all cells to the right at a distance less than ai (from i to min(i+ai\xe2\x88\x921,n) inclusive) will be painted,  or not used at all. Note that a charge can be used no more than once (that is, it cannot be used simultaneously to the left and to the right). It is allowed for a cell to be painted more than once.What is the minimum number of times a charge needs to be used to paint all the cells of the strip?" 2300.0                                                
1925B "A Balanced Problemset?" "brute force,greedy,math,number theory" "Jay managed to create a problem of difficulty x and decided to make it the second problem for Codeforces Round #921. But Yash fears that this problem will make the contest highly unbalanced, and the coordinator will reject it. So, he decided to break it up into a problemset of n sub-problems such that the difficulties of all the sub-problems are a positive integer and their sum is equal to x. The coordinator, Aleksey, defines the balance of a problemset as the GCD of the difficulties of all sub-problems in the problemset. Find the maximum balance that Yash can achieve if he chooses the difficulties of the sub-problems optimally." 1200.0                                                
1925A "We Got Everything Covered!" "constructive algorithms,greedy,strings" "You are given two positive integers n and k. Your task is to find a string s such that all possible strings of length n that can be formed using the first k lowercase English alphabets occur as a subsequence of s. If there are multiple answers, print the one with the smallest length. If there are still multiple answers, you may print any of them.Note: A string a is called a subsequence of another string b if a can be obtained by deleting some (possibly zero) characters from b without changing the order of the remaining characters." 800.0                                                
1924A "Did We Get Everything Covered?" "constructive algorithms,dp,greedy,shortest paths,strings" "You are given two integers n and k along with a string s.Your task is to check whether all possible strings of length n that can be formed using the first k lowercase English alphabets occur as a subsequence of s. If the answer is NO, you also need to print a string of length n that can be formed using the first k lowercase English alphabets which does not occur as a subsequence of s.If there are multiple answers, you may print any of them.Note: A string a is called a subsequence of another string b if a can be obtained by deleting some (possibly zero) characters from b without changing the order of the remaining characters." 1500.0                                                
1923F Shrink-Reverse "binary search,brute force,greedy,hashing,implementation,string suffix structures,strings" "You are given a binary string s of length n (a string consisting of n characters, and each character is either 0 or 1).Let\'s look at s as at a binary representation of some integer, and name that integer as the value of string s. For example, the value of 000 is 0, the value of 01101 is 13, ""100000"" is 32 and so on.You can perform at most k operations on s. Each operation should have one of the two following types:   SWAP: choose two indices i<j in s and swap si with sj;  SHRINK-REVERSE: delete all leading zeroes from s and reverse s.  For example, after you perform SHRINK-REVERSE on 000101100, you\'ll get 001101.What is the minimum value of s you can achieve by performing at most k operations on s?" 2800.0                                                
1922F "Replace on Segment" "dp,graph matchings" "You are given an array a1,a2,\xe2\x80\xa6,an, where each element is an integer from 1 to x.You can perform the following operation with it any number of times:  choose three integers l, r and k such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4k\xe2\x89\xa4x and each element ai such that l\xe2\x89\xa4i\xe2\x89\xa4r is different from k. Then, for each i\xe2\x88\x88[l,r], replace ai with k. In other words, you choose a subsegment of the array and an integer from 1 to x which does not appear in that subsegment, and replace every element in the subsegment with that chosen integer.Your goal is to make all elements in the array equal. What is the minimum number of operations that you have to perform?" 2500.0                                                
1922E "Increasing Subsequences" "bitmasks,constructive algorithms,divide and conquer,greedy,math" "Let\'s recall that an increasing subsequence of the array a is a sequence that can be obtained from it by removing some elements without changing the order of the remaining elements, and the remaining elements are strictly increasing (i.\xe2\x80\x89e ab1<ab2<\xe2\x8b\xaf<abk and b1<b2<\xe2\x8b\xaf<bk). Note that an empty subsequence is also increasing.You are given a positive integer X. Your task is to find an array of integers of length at most 200, such that it has exactly X increasing subsequences, or report that there is no such array. If there are several answers, you can print any of them.If two subsequences consist of the same elements, but correspond to different positions in the array, they are considered different (for example, the array [2,2] has two different subsequences equal to [2])." 1800.0                                                
1922A "Tricky Template" "constructive algorithms,implementation,strings" "You are given an integer n and three strings a,b,c, each consisting of n lowercase Latin letters.Let a template be a string t consisting of n lowercase and/or uppercase Latin letters. The string s matches the template t if the following conditions hold for all i from 1 to n:   if the i-th letter of the template is lowercase, then si must be the same as ti;  if the i-th letter of the template is uppercase, then si must be different from the lowercase version of ti. For example, if there is a letter \'A\' in the template, you cannot use the letter \'a\' in the corresponding position of the string. Accordingly, the string doesn\'t match the template if the condition doesn\'t hold for at least one i.Determine whether there exists a template t such that the strings a and b match it, while the string c does not." 800.0                                                
1920F1 "Smooth Sailing (Easy Version)" "binary search,brute force,data structures,dfs and similar,dsu,graphs,shortest paths" "The only difference between the two versions of this problem is the constraint on q. You can make hacks only if both versions of the problem are solved.Thomas is sailing around an island surrounded by the ocean. The ocean and island can be represented by a grid with n rows and m columns. The rows are numbered from 1 to n from top to bottom, and the columns are numbered from 1 to m from left to right. The position of a cell at row r and column c can be represented as (r,c). Below is an example of a valid grid.  Example of a valid grid There are three types of cells: island, ocean and underwater volcano. Cells representing the island are marked with a \'#\', cells representing the ocean are marked with a \'.\', and cells representing an underwater volcano are marked with a \'v\'. It is guaranteed that there is at least one island cell and at least one underwater volcano cell. It is also guaranteed that the set of all island cells forms a single connected component\xe2\x80\xa0 and the set of all ocean cells and underwater volcano cells forms a single connected component. Additionally, it is guaranteed that there are no island cells at the edge of the grid (that is, at row 1, at row n, at column 1, and at column m).Define a round trip starting from cell (x,y) as a path Thomas takes which satisfies the following conditions:  The path starts and ends at (x,y).  If Thomas is at cell (i,j), he can go to cells (i+1,j), (i\xe2\x88\x921,j), (i,j\xe2\x88\x921), and (i,j+1) as long as the destination cell is an ocean cell or an underwater volcano cell and is still inside the grid. Note that it is allowed for Thomas to visit the same cell multiple times in the same round trip.  The path must go around the island and fully encircle it. Some path p fully encircles the island if it is impossible to go from an island cell to a cell on the grid border by only traveling to adjacent on a side or diagonal cells without visiting a cell on path p. In the image below, the path starting from (2,2), going to (1,3), and going back to (2,2) the other way does not fully encircle the island and is not considered a round trip.   Example of a path that does not fully encircle the island The safety of a round trip is the minimum Manhattan distance\xe2\x80\xa1 from a cell on the round trip to an underwater volcano (note that the presence of island cells does not impact this distance).You have q queries. A query can be represented as (x,y) and for every query, you want to find the maximum safety of a round trip starting from (x,y). It is guaranteed that (x,y) is an ocean cell or an underwater volcano cell.\xe2\x80\xa0A set of cells forms a single connected component if from any cell of this set it is possible to reach any other cell of this set by moving only through the cells of this set, each time going to a cell with a common side.\xe2\x80\xa1Manhattan distance between cells (r1,c1) and (r2,c2) is equal to |r1\xe2\x88\x92r2|+|c1\xe2\x88\x92c2|." 2500.0                                                
1920B "Summation Game" games,greedy,math,sortings "Alice and Bob are playing a game. They have an array a1,a2,\xe2\x80\xa6,an. The game consists of two steps:  First, Alice will remove at most k elements from the array.  Second, Bob will multiply at most x elements of the array by \xe2\x88\x921. Alice wants to maximize the sum of elements of the array while Bob wants to minimize it. Find the sum of elements of the array after the game if both players play optimally." 1100.0                                                
1913F "Palindromic Problem" "binary search,data structures,hashing,string suffix structures,strings" "You are given a string s of length n, consisting of lowercase Latin letters.You are allowed to replace at most one character in the string with an arbitrary lowercase Latin letter.Print the lexicographically minimal string that can be obtained from the original string and contains the maximum number of palindromes as substrings. Note that if a palindrome appears more than once as a substring, it is counted the same number of times it appears.The string a is lexicographically smaller than the string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b are different, the string a contains a letter that appears earlier in the alphabet than the corresponding letter in b." 2800.0                                                
1913B "Swap and Delete" strings "You are given a binary string s (a string consisting only of 0-s and 1-s).You can perform two types of operations on s:   delete one character from s. This operation costs 1 coin;  swap any pair of characters in s. This operation is free (costs 0 coins). You can perform these operations any number of times and in any order.Let\'s name a string you\'ve got after performing operations above as t. The string t is good if for each i from 1 to |t| ti\xe2\x89\xa0si (|t| is the length of the string t). The empty string is always good. Note that you are comparing the resulting string t with the initial string s.What is the minimum total cost to make the string t good?" 1000.0                                                
1909H "Parallel Swaps Sort" "constructive algorithms,data structures" "Dubmood - Keygen 8\xe2\xa0\x80You are given a permutation p1,p2,\xe2\x80\xa6,pn of [1,2,\xe2\x80\xa6,n]. You can perform the following operation some (possibly 0) times:  choose a subarray [l,r] of even length;  swap al, al+1;  swap al+2, al+3 (if l+3\xe2\x89\xa4r);  \xe2\x80\xa6  swap ar\xe2\x88\x921, ar. Sort the permutation in at most 106 operations. You do not need to minimize the number of operations." 3500.0                                                
1909F1 "Small Permutation Problem (Easy Version)" "brute force,combinatorics,dp,math" "Andy Tunstall - MiniBoss\xe2\xa0\x80In the easy version, the ai are in the range [0,n]; in the hard version, the ai are in the range [\xe2\x88\x921,n] and the definition of good permutation is slightly different. You can make hacks only if all versions of the problem are solved.You are given an integer n and an array a1,a2\xe2\x80\xa6,an of integers in the range [0,n].A permutation p1,p2,\xe2\x80\xa6,pn of [1,2,\xe2\x80\xa6,n] is good if, for each i, the following condition is true:   the number of values \xe2\x89\xa4i in [p1,p2,\xe2\x80\xa6,pi] is exactly ai. Count the good permutations of [1,2,\xe2\x80\xa6,n], modulo 998244353." 2200.0                                                
1909D "Split Plus K" "greedy,math,number theory" "eliteLAQ - Desert Ruins\xe2\xa0\x80There are n positive integers a1,a2,\xe2\x80\xa6,an on a blackboard. You are also given a positive integer k. You can perform the following operation some (possibly 0) times:  choose a number x on the blackboard;  erase one occurrence of x;  write two positive integers y, z such that y+z=x+k on the blackboard. Is it possible to make all the numbers on the blackboard equal? If yes, what is the minimum number of operations you need?" 1900.0                                                
1907E "Good Triples" "brute force,combinatorics,number theory" "Given a non-negative integer number n (n\xe2\x89\xa50). Let\'s say a triple of non-negative integers (a,b,c) is good if a+b+c=n, and digsum(a)+digsum(b)+digsum(c)=digsum(n), where digsum(x) is the sum of digits of number x.For example, if n=26, then the pair (4,12,10) is good, because 4+12+10=26, and (4)+(1+2)+(1+0)=(2+6).Your task is to find the number of good triples for the given number n. The order of the numbers in a triple matters. For example, the triples (4,12,10) and (10,12,4) are two different triples." 1600.0                                                
1907B YetnotherrokenKeoard "data structures,implementation,strings" "Polycarp has a problem \xe2\x80\x94 his laptop keyboard is broken.Now, when he presses the \'b\' key, it acts like an unusual backspace: it deletes the last (rightmost) lowercase letter in the typed string. If there are no lowercase letters in the typed string, then the press is completely ignored.Similarly, when he presses the \'B\' key, it deletes the last (rightmost) uppercase letter in the typed string. If there are no uppercase letters in the typed string, then the press is completely ignored.In both cases, the letters \'b\' and \'B\' are not added to the typed string when these keys are pressed.Consider an example where the sequence of key presses was ""ARaBbbitBaby"". In this case, the typed string will change as follows: """" A\xe2\x86\x92 ""A"" R\xe2\x86\x92 ""AR"" a\xe2\x86\x92 ""ARa"" B\xe2\x86\x92 ""Aa"" b\xe2\x86\x92 ""A"" b\xe2\x86\x92 ""A"" i\xe2\x86\x92 ""Ai"" t\xe2\x86\x92 ""Ait"" B\xe2\x86\x92 ""it"" a\xe2\x86\x92 ""ita"" b\xe2\x86\x92 ""it"" y\xe2\x86\x92 ""ity"".Given a sequence of pressed keys, output the typed string after processing all key presses." 1000.0                                                
1906M "Triangle Construction" greedy,math "You are given a regular N-sided polygon. Label one arbitrary side as side 1, then label the next sides in clockwise order as side 2, 3, \xe2\x80\xa6, N. There are Ai special points on side i. These points are positioned such that side i is divided into Ai+1 segments with equal length.For instance, suppose that you have a regular 4-sided polygon, i.e., a square. The following illustration shows how the special points are located within each side when A=[3,1,4,6]. The uppermost side is labelled as side 1.  You want to create as many non-degenerate triangles as possible while satisfying the following requirements. Each triangle consists of 3 distinct special points (not necessarily from different sides) as its corners. Each special point can only become the corner of at most 1 triangle. All triangles must not intersect with each other.Determine the maximum number of non-degenerate triangles that you can create.A triangle is non-degenerate if it has a positive area." 1700.0                                                
1906K "Deck-Building Game" "divide and conquer,math" "You are playing a deck-building game with your friend. There are N cards, numbered from 1 to N. Card i has the value of Ai.You want to build two decks; one for you and one for your friend. A card cannot be inside both decks, and it is allowed to not use all N cards. It is also allowed for a deck to be empty, i.e. does not contain any cards.The power of a deck is represented as the bitwise XOR of the value of the cards in the deck. The power of an empty deck is 0.The game is balanced if both decks have the same power.Determine the number of ways to build two decks such that the game is balanced. Two ways are considered different if one of the decks contains at least one different card. Since the answer can be very large, calculate the answer modulo 998244353." 2500.0                                                
1906E "Merge Not Sort" "constructive algorithms,dp" "You are currently researching the Merge Sort algorithm. Merge Sort is a sorting algorithm that is based on the principle of Divide and Conquer. It works by dividing an array into two subarrays of equal length, sorting each subarrays, then merging the sorted subarrays back together to form the final sorted array.You are particularly interested in the merging routine. Common merge implementation will combine two subarrays by iteratively comparing their first elements, and move the smaller one to a new merged array. More precisely, the merge algorithm can be presented by the following pseudocode.    Merge(A[1..N], B[1..N]):        C = []        i = 1        j = 1        while i <= N AND j <= N:            if A[i] < B[j]:                append A[i] to C                i = i + 1            else:                append B[j] to C                j = j + 1         while i <= N:            append A[i] to C            i = i + 1         while j <= N:            append B[j] to C            j = j + 1         return CDuring your research, you are keen to understand the behaviour of the merge algorithm when arrays A and B are not necessarily sorted. For example, if A=[3,1,6] and B=[4,5,2], then Merge(A,B)=[3,1,4,5,2,6].To further increase the understanding of the merge algorithm, you decided to work on the following problem. You are given an array C of length 2\xe2\x8b\x85N such that it is a permutation of 1 to 2\xe2\x8b\x85N. Construct any two arrays A and B of the same length N, such that Merge(A,B)=C, or determine if it is impossible to do so." 1900.0                                                
1906C "Cursed Game" interactive "You found an antique box in your warehouse and decided to open it. The moment you open the box, it traps you into a cursed game where you are playing against a demon. The game consists of 333 rounds and you have to win all rounds in order to escape. The demon also gives you 999 coins that you can use throughout all rounds.Note that in this problem, denote cell (r,c) of a grid as the cell in row r and column c of the grid.Before the start of each round, the demon will prepare a secret paper, which can be represented as a grid with 3 rows and 3 columns, both numbered from 1 to 3. The demon will secretly put a hole in one or more cells, and you are not aware which cells have a hole in it. Then, the round starts with the demon giving you an odd integer N (3\xe2\x89\xa4N\xe2\x89\xa433).Within each round, you can ask the demon several queries, each costing you one coin. For each query, you are allowed to give the demon your paper, which can be represented as a grid with N rows and N columns, both numbered from 1 to N. Each cell is coloured either black or white by you.For each of your query, the demon will calculate a binary result grid with N\xe2\x88\x922 rows and N\xe2\x88\x922 columns, both numbered from 1 to N\xe2\x88\x922. The value on cell (r,c) of the result grid is filled as follows.  The demon will put the secret paper on top of your paper such that the cell (r+i\xe2\x88\x921,c+j\xe2\x88\x921) of your paper aligns with the cell (i,j) of the secret paper, for 1\xe2\x89\xa4i,j\xe2\x89\xa43.  The demon can only see the colour of the cell in your paper if the corresponding cell in the secret paper has a hole in it.  The value on cell (r,c) of the result grid is 1 if there is an odd number of black cells that it can see through the holes, or 0 otherwise. You win the round if the result grid consists of only the values 1. Otherwise, the demon will give you the result grid as a feedback, and the round continues.If you have spent all the coins and still did not win all the rounds, then you will be trapped forever. Escape the cursed game!" 3000.0                                                
1905C "Largest Subsequence" greedy,strings "Given is a string s of length n. In one operation you can select the lexicographically largest\xe2\x80\xa0 subsequence of string s and cyclic shift it to the right\xe2\x80\xa1. Your task is to calculate the minimum number of operations it would take for s to become sorted, or report that it never reaches a sorted state.\xe2\x80\xa0A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; In the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b.\xe2\x80\xa1By cyclic shifting the string t1t2\xe2\x80\xa6tm to the right, we get the string tmt1\xe2\x80\xa6tm\xe2\x88\x921." 1400.0                                                
1905A "Constructive Problems" "constructive algorithms,math" "Gridlandia has been hit by flooding and now has to reconstruct all of it\'s cities. Gridlandia can be described by an n\xc3\x97m matrix.Initially, all of its cities are in economic collapse. The government can choose to rebuild certain cities. Additionally, any collapsed city which has at least one vertically neighboring rebuilt city and at least one horizontally neighboring rebuilt city can ask for aid from them and become rebuilt without help from the government. More formally, collapsed city positioned in (i,j) can become rebuilt if both of the following conditions are satisfied:  At least one of cities with positions (i+1,j) and (i\xe2\x88\x921,j) is rebuilt;  At least one of cities with positions (i,j+1) and (i,j\xe2\x88\x921) is rebuilt. If the city is located on the border of the matrix and has only one horizontally or vertically neighbouring city, then we consider only that city.   Illustration of two possible ways cities can be rebuilt by adjacent aid. White cells are collapsed cities, yellow cells are initially rebuilt cities (either by the government or adjacent aid), and orange cells are rebuilt cities after adjacent aid. The government wants to know the minimum number of cities it has to rebuild such that after some time all the cities can be rebuild." 800.0                                                
1903F Babysitting "2-sat,binary search,data structures,graphs,trees" "Theofanis wants to play video games, however he should also take care of his sister. Since Theofanis is a CS major, he found a way to do both. He will install some cameras in his house in order to make sure his sister is okay.His house is an undirected graph with n nodes and m edges. His sister likes to play at the edges of the graph, so he has to install a camera to at least one endpoint of every edge of the graph. Theofanis wants to find a vertex cover that maximizes the minimum difference between indices of the chosen nodes.More formally, let a1,a2,\xe2\x80\xa6,ak be a vertex cover of the graph. Let the minimum difference between indices of the chosen nodes be the minimum |ai\xe2\x88\x92aj| (where i\xe2\x89\xa0j) out of the nodes that you chose. If k=1 then we assume that the minimum difference between indices of the chosen nodes is n. Can you find the maximum possible minimum difference between indices of the chosen nodes over all vertex covers?" 2500.0                                                
1901E "Compressed Tree" "dfs and similar,dp,graphs,greedy,sortings,trees" "You are given a tree consisting of n vertices. A number is written on each vertex; the number on vertex i is equal to ai.You can perform the following operation any number of times (possibly zero):   choose a vertex which has at most 1 incident edge and remove this vertex from the tree. Note that you can delete all vertices.After all operations are done, you\'re compressing the tree. The compression process is done as follows. While there is a vertex having exactly 2 incident edges in the tree, perform the following operation:   delete this vertex, connect its neighbors with an edge. It can be shown that if there are multiple ways to choose a vertex to delete during the compression process, the resulting tree is still the same.Your task is to calculate the maximum possible sum of numbers written on vertices after applying the aforementioned operation any number of times, and then compressing the tree." 2200.0                                                
1901D "Yet Another Monster Fight" "binary search,dp,greedy,implementation,math" "Vasya is a sorcerer that fights monsters. Again. There are n monsters standing in a row, the amount of health points of the i-th monster is ai.Vasya is a very powerful sorcerer who knows many overpowered spells. In this fight, he decided to use a chain lightning spell to defeat all the monsters. Let\'s see how this spell works.Firstly, Vasya chooses an index i of some monster (1\xe2\x89\xa4i\xe2\x89\xa4n) and the initial power of the spell x. Then the spell hits monsters exactly n times, one hit per monster. The first target of the spell is always the monster i. For every target except for the first one, the chain lightning will choose a random monster who was not hit by the spell and is adjacent to one of the monsters that already was hit. So, each monster will be hit exactly once. The first monster hit by the spell receives x damage, the second monster receives (x\xe2\x88\x921) damage, the third receives (x\xe2\x88\x922) damage, and so on.Vasya wants to show how powerful he is, so he wants to kill all the monsters with a single chain lightning spell. The monster is considered dead if the damage he received is not less than the amount of its health points. On the other hand, Vasya wants to show he doesn\'t care that much, so he wants to choose the minimum initial power of the spell x such that it kills all monsters, no matter which monster (among those who can get hit) gets hit on each step.Of course, Vasya is a sorcerer, but the amount of calculations required to determine the optimal spell setup is way above his possibilities, so you have to help him find the minimum spell power required to kill all the monsters.Note that Vasya chooses the initial target and the power of the spell, other things should be considered random and Vasya wants to kill all the monsters even in the worst possible scenario." 1700.0                                                
1901C "Add, Divide and Floor" "constructive algorithms,greedy,math" "You are given an integer array a1,a2,\xe2\x80\xa6,an (0\xe2\x89\xa4ai\xe2\x89\xa4109). In one operation, you can choose an integer x (0\xe2\x89\xa4x\xe2\x89\xa41018) and replace ai with \xe2\x8c\x8aai+x2\xe2\x8c\x8b (\xe2\x8c\x8ay\xe2\x8c\x8b denotes rounding y down to the nearest integer) for all i from 1 to n. Pay attention to the fact that all elements of the array are affected on each operation. Print the smallest number of operations required to make all elements of the array equal.If the number of operations is less than or equal to n, then print the chosen x for each operation. If there are multiple answers, print any of them." 1400.0                                                
1900E "Transitive Graph" "dfs and similar,dp,dsu,graphs,implementation" "You are given a directed graph G with n vertices and m edges between them.Initially, graph H is the same as graph G. Then you decided to perform the following actions:   If there exists a triple of vertices a, b, c of H, such that there is an edge from a to b and an edge from b to c, but there is no edge from a to c, add an edge from a to c.  Repeat the previous step as long as there are such triples. Note that the number of edges in H can be up to n2 after performing the actions.You also wrote some values on vertices of graph H. More precisely, vertex i has the value of ai written on it.Consider a simple path consisting of k distinct vertices with indexes v1,v2,\xe2\x80\xa6,vk. The length of such a path is k. The value of that path is defined as \xe2\x88\x91ki=1avi.A simple path is considered the longest if there is no other simple path in the graph with greater length.Among all the longest simple paths in H, find the one with the smallest value." 2100.0                                                
1899E "Queue Sort" greedy,implementation,sortings "Vlad found an array a of n integers and decided to sort it in non-decreasing order.To do this, Vlad can apply the following operation any number of times:  Extract the first element of the array and insert it at the end;  Swap that element with the previous one until it becomes the first or until it becomes strictly greater than the previous one. Note that both actions are part of the operation, and for one operation, you must apply both actions.For example, if you apply the operation to the array [4,3,1,2,6,4], it will change as follows: [4,3,1,2,6,4]; [3,1,2,6,4,4]; [3,1,2,6,4,4]; [3,1,2,4,6,4].Vlad doesn\'t have time to perform all the operations, so he asks you to determine the minimum number of operations required to sort the array or report that it is impossible." 1300.0                                                
1896D "Ones and Twos" "binary search,data structures,divide and conquer,math,two pointers" "You are given a 1-indexed array a of length n where each element is 1 or 2.Process q queries of the following two types:   ""1 s"": check if there exists a subarray\xe2\x80\xa0 of a whose sum equals to s.  ""2 i v"": change ai to v. \xe2\x80\xa0 An array b is a subarray of an array a if b can be obtained from a by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end. In particular, an array is a subarray of itself." 1700.0                                                
1893A "Anonymous Informant" "brute force,dfs and similar,graphs,implementation" "You are given an array b1,b2,\xe2\x80\xa6,bn.An anonymous informant has told you that the array b was obtained as follows: initially, there existed an array a1,a2,\xe2\x80\xa6,an, after which the following two-component operation was performed k times: A fixed point\xe2\x80\xa0 x of the array a was chosen. Then, the array a was cyclically shifted to the left\xe2\x80\xa1 exactly x times.As a result of k such operations, the array b1,b2,\xe2\x80\xa6,bn was obtained. You want to check if the words of the anonymous informant can be true or if they are guaranteed to be false.\xe2\x80\xa0A number x is called a fixed point of the array a1,a2,\xe2\x80\xa6,an if 1\xe2\x89\xa4x\xe2\x89\xa4n and ax=x.\xe2\x80\xa1A cyclic left shift of the array a1,a2,\xe2\x80\xa6,an is the array a2,\xe2\x80\xa6,an,a1." 1400.0                                                
1891B "Deja Vu" "brute force,math,sortings" "You are given an array a of length n, consisting of positive integers, and an array x of length q, also consisting of positive integers.There are q modification. On the i-th modification (1\xe2\x89\xa4i\xe2\x89\xa4q), for each j (1\xe2\x89\xa4j\xe2\x89\xa4n), such that aj is divisible by 2xi, you add 2xi\xe2\x88\x921 to aj. Note that xi (1\xe2\x89\xa4xi\xe2\x89\xa430) is a positive integer not exceeding 30.After all modification queries, you need to output the final array." 1100.0                                                
1887E "Good Colorings" "binary search,constructive algorithms,graphs,interactive" "Alice suggested Bob to play a game. Bob didn\'t like this idea, but he couldn\'t refuse Alice, so he asked you to write a program that would play instead of him.The game starts with Alice taking out a grid sheet of size n\xc3\x97nn\xc3\x97n, the cells of which are initially not colored. After that she colors some 2n2n cells with colors 1,2,\xe2\x80\xa6,2n1,2,\xe2\x80\xa6,2n, respectively, and informs Bob about these cells.In one move, Bob can point to a cell that has not been colored yet and ask Alice to color that cell. Alice colors that cell with one of the 2n2n colors of her choice, informing Bob of the chosen color. Bob can make no more than 1010 moves, after which he needs to find a good set of four cells.A set of four cells is considered good if the following conditions are met:  All the cells in the set are colored;  No two cells in the set are colored with the same color;  The centers of the cells form a rectangle with sides parallel to the grid lines." 3100.0                                                
1884B "Haunted House" "binary search,greedy,math,two pointers" "You are given a number in binary representation consisting of exactly n bits, possibly, with leading zeroes. For example, for n=5 the number 6 will be given as 00110, and for n=4 the number 9 will be given as 1001.Let\'s fix some integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n. In one operation you can swap any two adjacent bits in the binary representation. Your goal is to find the smallest number of operations you are required to perform to make the number divisible by 2i, or say that it is impossible.Please note that for each 1\xe2\x89\xa4i\xe2\x89\xa4n you are solving the problem independently." 1100.0                                                
1883A Morning math "You are given a four-digit pin code consisting of digits from 0 to 9 that needs to be entered. Initially, the cursor points to the digit 1. In one second, you can perform exactly one of the following two actions: Press the cursor to display the current digit, Move the cursor to any adjacent digit.  The image above shows the device you are using to enter the pin code. For example, for the digit 5, the adjacent digits are 4 and 6, and for the digit 0, there is only one adjacent digit, 9.Determine the minimum number of seconds required to enter the given four-digit pin code." 800.0                                                
1882D "Tree XOR" "bitmasks,dfs and similar,dp,greedy,trees" "You are given a tree with n vertices labeled from 1 to n. An integer ai is written on vertex i for i=1,2,\xe2\x80\xa6,n. You want to make all ai equal by performing some (possibly, zero) spells.Suppose you root the tree at some vertex. On each spell, you can select any vertex v and any non-negative integer c. Then for all vertices i in the subtree\xe2\x80\xa0 of v, replace ai with ai\xe2\x8a\x95c. The cost of this spell is s\xe2\x8b\x85c, where s is the number of vertices in the subtree. Here \xe2\x8a\x95 denotes the bitwise XOR operation.Let mr be the minimum possible total cost required to make all ai equal, if vertex r is chosen as the root of the tree. Find m1,m2,\xe2\x80\xa6,mn.\xe2\x80\xa0 Suppose vertex r is chosen as the root of the tree. Then vertex i belongs to the subtree of v if the simple path from i to r contains v." 1900.0                                                
1879F "Last Man Standing" "brute force,data structures,number theory" "There are n heroes in a videogame. Each hero has some health value h and initial armor value a. Let the current value of armor be acur, initially equal to a.When x points of damage are inflicted on a hero, the following happens: if x<acur, then x gets subtracted from acur; otherwise, 1 gets subtracted from h and acur gets assigned back to a.In the start of the game, you choose the value x (an integer strictly greater than 0, arbitrarily large). Then you keep attacking all heroes in rounds: in one round, you inflict x points of damage to all alive heroes. A hero dies when his health becomes 0. The game ends when all heroes are dead.The last hero to die earns the number of points, equal to the number of rounds he was the only hero alive. The other heroes get 0 points. In particular, if the last round ends with multiple heroes dying, then every hero gets 0 points.The game is played for every possible x (from 1 to infinity). The points are reset between the games. What\'s the maximum number of points each hero has had?" 2800.0                                                
1879B "Chips on the Board" "constructive algorithms,greedy" "You are given a board of size n\xc3\x97n (n rows and n colums) and two arrays of positive integers a and b of size n.Your task is to place the chips on this board so that the following condition is satisfied for every cell (i,j):  there exists at least one chip in the same column or in the same row as the cell (i,j). I.\xe2\x80\x89e. there exists a cell (x,y) such that there is a chip in that cell, and either x=i or y=j (or both). The cost of putting a chip in the cell (i,j) is equal to ai+bj. For example, for n=3, a=[1,4,1] and b=[3,2,2]. One of the possible chip placements is as follows:  White squares are empty The total cost of that placement is (1+3)+(1+2)+(1+2)=10.Calculate the minimum possible total cost of putting chips according to the rules above." 900.0                                                
1878G "wxhtzdy ORO Tree" "binary search,bitmasks,brute force,data structures,dfs and similar,implementation,trees" "After (finally) qualifying for the IOI 2023, wxhtzdy was very happy, so he decided to do what most competitive programmers do: trying to guess the problems that will be on IOI. During this process, he accidentally made a problem, which he thought was really cool.You are given a tree (a connected acyclic graph) with n vertices and n\xe2\x88\x921 edges. Vertex i (1\xe2\x89\xa4i\xe2\x89\xa4n) has a value ai. Lets\' define g(u,v) as the bitwise or of the values of all vertices on the shortest path from u to v. For example, let\'s say that we want to calculate g(3,4), on the tree from the first test case in the example. On the path from 3 to 4 are vertices 3, 1, 4. Then, g(3,4)=a3 | a1 | a4 (here, | represents the bitwise OR operation).Also, you are given q queries, and each query looks like this:You are given x and y. Let\'s consider all vertices z such that z is on the shortest path from x to y (inclusive).Lets define the niceness of a vertex z as the sum of the number of non-zero bits in g(x,z) and the number of non-zero bits in g(y,z). You need to find the maximum niceness among all vertices z on the shortest path from x to y.Since his brain is really tired after solving an output only problem on SIO (he had to do it to qualify for the IOI), he wants your help with this problem." 2300.0                                                
1878E "Iva & Pav" "binary search,bitmasks,data structures,greedy" "Iva and Pav are a famous Serbian competitive programming couple. In Serbia, they call Pav ""papuca"" and that\'s why he will make all of Iva\'s wishes come true.Iva gave Pav an array a of n elements.Let\'s define f(l,r)=al & al+1 &\xe2\x80\xa6& ar (here & denotes the bitwise AND operation). Note that f(l,r) is not defined when l>r.Iva also gave Pav q queries.Each query consists of 2 numbers, k and l, and she wants Pav to find the largest index r (l\xe2\x89\xa4r\xe2\x89\xa4n), such that f(l,r)\xe2\x89\xa5k. Pav wants to solve this problem fast because he doesn\'t want to upset Iva. He needs your help." 1400.0                                                
1877A "Goals of Victory" math "There are n teams in a football tournament. Each pair of teams match up once. After every match, Pak Chanek receives two integers as the result of the match, the number of goals the two teams score during the match. The efficiency of a team is equal to the total number of goals the team scores in each of its matches minus the total number of goals scored by the opponent in each of its matches.After the tournament ends, Pak Dengklek counts the efficiency of every team. Turns out that he forgot about the efficiency of one of the teams. Given the efficiency of n\xe2\x88\x921 teams a1,a2,a3,\xe2\x80\xa6,an\xe2\x88\x921. What is the efficiency of the missing team? It can be shown that the efficiency of the missing team can be uniquely determined." 800.0                                                
1876G Clubstep "binary search,brute force,data structures,greedy,trees" "There is an extremely hard video game that is one of Chaneka\'s favourite video games. One of the hardest levels in the game is called Clubstep. Clubstep consists of n parts, numbered from 1 to n. Chaneka has practised the level a good amount, so currently, her familiarity value with each part i is ai.After this, Chaneka can do several (possibly zero) attempts on Clubstep. In each attempt, she dies on one of the n parts. If an attempt dies on part p, that means it only successfully passes through every part k for all 1\xe2\x89\xa4k\xe2\x89\xa4p\xe2\x88\x921 and it does not reach any part k for all p+1\xe2\x89\xa4k\xe2\x89\xa4n. An attempt that dies on part p takes p seconds.It is known that Chaneka improves much more on the part she dies on than anything else. It is also known that during an attempt, Chaneka does not get to practise that much on the parts she does not reach. So, the effect of an attempt that dies on part p is as follows:   Chaneka\'s familiarity value with part p increases by 2.  Chaneka\'s familiarity value with each part k for all 1\xe2\x89\xa4k\xe2\x89\xa4p\xe2\x88\x921 increases by 1.  There will be q questions. For the j-th question, you are given three integers lj, rj, and xj. Then, you are asked to find out the minimum time (in seconds) for Chaneka to make it such that the familiarity value for every part p (lj\xe2\x89\xa4p\xe2\x89\xa4rj) is at least xj.Note that each question is independent, so the attempt Chaneka does on a question does not affect the familiarity values of any other questions." 3500.0                                                
1876C Autosynthesis "constructive algorithms,dfs and similar,graphs,greedy,sortings" "Chaneka writes down an array a of n positive integer elements. Initially, all elements are not circled. In one operation, Chaneka can circle an element. It is possible to circle the same element more than once.After doing all operations, Chaneka makes a sequence r consisting of all uncircled elements of a following the order of their indices.Chaneka also makes another sequence p such that its length is equal to the number of operations performed and pi is the index of the element that is circled in the i-th operation.Chaneka wants to do several operations such that sequence r is equal to sequence p. Help her achieve this, or report if it is impossible! Note that if there are multiple solutions, you can print any of them." 2100.0                                                
1874G "Jellyfish and Inscryption" dp "Jellyfish loves playing a game called ""Inscryption"" which is played on a directed acyclic graph with n vertices and m edges. All edges a\xe2\x86\x92b satisfy a<b.You need to move from vertex 1 to vertex n along the directed edges, and then fight with the final boss.You will collect cards and props in the process.Each card has two attributes: HP and damage. If a card\'s HP is a and its damage is b, then the power of the card is a\xc3\x97b.Each prop has only one attribute: power.In addition to vertex 1 and vertex n, there are some vertices that trigger special events. The special events are:  You will get a card with a HP, and b damage.  If you have at least one card, choose one of your cards and increase its HP by x.  If you have at least one card, choose one of your cards and increase its damage by y.  You will get a prop with w power. When you get to vertex n, you can choose at most one of your cards and multiply its damage by 109.The final boss is very strong, so you want to maximize the sum of the power of all your cards and props. Find the maximum possible sum of power of all your cards and props if you play the game optimally." 3500.0                                                
1874B "Jellyfish and Math" "bitmasks,brute force,dfs and similar,dp,graphs,shortest paths" "Jellyfish is given the non-negative integers a, b, c, d and m. Initially (x,y)=(a,b). Jellyfish wants to do several operations so that (x,y)=(c,d).For each operation, she can do one of the following:  x:=x&y,  x:=x|y,  y:=x\xe2\x8a\x95y,  y:=y\xe2\x8a\x95m. Here & denotes the bitwise AND operation, | denotes the bitwise OR operation and \xe2\x8a\x95 denotes the bitwise XOR operation.Now Jellyfish asks you for the minimum number of operations such that (x,y)=(c,d)." 2400.0                                                
2037B "Intercepted Inputs" "brute force,implementation" "To help you prepare for your upcoming Codeforces contest, Citlali set a grid problem and is trying to give you a n by m grid through your input stream. Specifically, your input stream should contain the following:  The first line contains two integers n and m \xe2\x80\x94 the dimensions of the grid.  The following n lines contain m integers each \xe2\x80\x94 the values of the grid. However, someone has intercepted your input stream, shuffled all given integers, and put them all on one line! Now, there are k integers all on one line, and you don\'t know where each integer originally belongs. Instead of asking Citlali to resend the input, you decide to determine the values of n and m yourself.Output any possible value of n and m that Citlali could have provided." -999.0                                                
2037A Twice implementation "Kinich wakes up to the start of a new day. He turns on his phone, checks his mailbox, and finds a mysterious present. He decides to unbox the present.Kinich unboxes an array a with n integers. Initially, Kinich\'s score is 0. He will perform the following operation any number of times:  Select two indices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) such that neither i nor j has been chosen in any previous operation and ai=aj. Then, add 1 to his score. Output the maximum score Kinich can achieve after performing the aforementioned operation any number of times." -999.0                                                
2036F "XORificator 3000" "bitmasks,dp,number theory,two pointers" "Alice has been giving gifts to Bob for many years, and she knows that what he enjoys the most is performing bitwise XOR of interesting integers. Bob considers a positive integer x to be interesting if it satisfies x\xe2\x89\xa2k(mod2i). Therefore, this year for his birthday, she gifted him a super-powerful ""XORificator 3000"", the latest model.Bob was very pleased with the gift, as it allowed him to instantly compute the XOR of all interesting integers in any range from l to r, inclusive. After all, what else does a person need for happiness? Unfortunately, the device was so powerful that at one point it performed XOR with itself and disappeared. Bob was very upset, and to cheer him up, Alice asked you to write your version of the ""XORificator""." 1900.0                                                
2036A Quintomania implementation "Boris Notkin composes melodies. He represents them as a sequence of notes, where each note is encoded as an integer from 0 to 127 inclusive. The interval between two notes a and b is equal to |a\xe2\x88\x92b| semitones.Boris considers a melody perfect if the interval between each two adjacent notes is either 5 semitones or 7 semitones.After composing his latest melodies, he enthusiastically shows you his collection of works. Help Boris Notkin understand whether his melodies are perfect." 800.0                                                
2035G1 "Go Learn! (Easy Version)" dp,trees "The differences between the easy and hard versions are the constraints on n and the sum of n. In this version, n\xe2\x89\xa43000 and the sum of n does not exceed 104. You can only make hacks if both versions are solved. Well, well, well, let\'s see how Bessie is managing her finances. She seems to be in the trenches! Fortunately, she is applying for a job at Moogle to resolve this issue. Moogle interviews require intensive knowledge of obscure algorithms and complex data structures, but Bessie received a tip-off from an LGM on exactly what she has to go learn.Bessie wrote the following code to binary search for a certain element k in a possibly unsorted array [a1,a2,\xe2\x80\xa6,an] with n elements.let l = 1let h = nwhile l < h:  let m = floor((l + h) / 2)  if a[m] < k:    l = m + 1  else:    h = mreturn lBessie submitted her code to Farmer John\'s problem with m (1\xe2\x89\xa4m\xe2\x89\xa4n) tests. The i-th test is of the form (xi,ki) (1\xe2\x89\xa4x,k\xe2\x89\xa4n). It is guaranteed all the xi are distinct and all the ki are distinct.Test i is correct if the following hold:  The xi-th element in the array is ki.  If Bessie calls the binary search as shown in the above code for ki, it will return xi. It might not be possible for all m tests to be correct on the same array, so Farmer John will remove some of them so Bessie can AC. Let r be the minimum of tests removed so that there exists an array [a1,a2,\xe2\x80\xa6,an] with 1\xe2\x89\xa4ai\xe2\x89\xa4n so that all remaining tests are correct. In addition to finding r, Farmer John wants you to count the number of arrays [a1,a2,\xe2\x80\xa6,an] with 1\xe2\x89\xa4ai\xe2\x89\xa4n such that there exists a way to remove exactly r tests so that all the remaining tests are correct. Since this number may be very large, please find it modulo 998244353." 3300.0                                                
2035D "Yet Another Real Number Problem" "binary search,data structures,divide and conquer,greedy,implementation,math" "Three r there are\'s in strawberry.You are given an array b of length m. You can perform the following operation any number of times (possibly zero):   Choose two distinct indices i and j where 1\xe2\x89\xa4i<j\xe2\x89\xa4m and bi is even, divide bi by 2 and multiply bj by 2.  Your task is to maximize the sum of the array after performing any number of such operations. Since it could be large, output this sum modulo 109+7.Since this problem is too easy, you are given an array a of length n and need to solve the problem for each prefix of a.In other words, denoting the maximum sum of b after performing any number of such operations as f(b), you need to output f([a1]), f([a1,a2]), \xe2\x80\xa6, f([a1,a2,\xe2\x80\xa6,an]) modulo 109+7 respectively." 1800.0                                                
2033D "Kousuke\'s Assignment" "data structures,dp,dsu,greedy,math" "After a trip with Sakurako, Kousuke was very scared because he forgot about his programming assignment. In this assignment, the teacher gave him an array a of n integers and asked him to calculate the number of non-overlapping segments of the array a, such that each segment is considered beautiful.A segment [l,r] is considered beautiful if al+al+1+\xe2\x8b\xaf+ar\xe2\x88\x921+ar=0.For a fixed array a, your task is to compute the maximum number of non-overlapping beautiful segments." 1300.0                                                
2031C "Penchick and BBQ Buns" "constructive algorithms,math,number theory" "Penchick loves two things: square numbers and Hong Kong-style BBQ buns! For his birthday, Kohane wants to combine them with a gift: n BBQ buns arranged from left to right. There are 106 available fillings of BBQ buns, numbered from 1 to 106. To ensure that Penchick would love this gift, Kohane has a few goals:  No filling is used exactly once; that is, each filling must either not appear at all or appear at least twice.  For any two buns i and j that have the same filling, the distance between them, which is |i\xe2\x88\x92j|, must be a perfect square\xe2\x88\x97. Help Kohane find a valid way to choose the filling of the buns, or determine if it is impossible to satisfy her goals! If there are multiple solutions, print any of them.\xe2\x88\x97A positive integer x is a perfect square if there exists a positive integer y such that x=y2. For example, 49 and 1 are perfect squares because 49=72 and 1=12 respectively. On the other hand, 5 is not a perfect square as no integer squared equals 5" -999.0                                                
2030A "A Gift From Orangutan" "constructive algorithms,greedy,math,sortings" "While exploring the jungle, you have bumped into a rare orangutan with a bow tie! You shake hands with the orangutan and offer him some food and water. In return...The orangutan has gifted you an array a of length n. Using a, you will construct two arrays b and c, both containing n elements, in the following manner:  bi=min(a1,a2,\xe2\x80\xa6,ai) for each 1\xe2\x89\xa4i\xe2\x89\xa4n.  ci=max(a1,a2,\xe2\x80\xa6,ai) for each 1\xe2\x89\xa4i\xe2\x89\xa4n. Define the score of a as \xe2\x88\x91ni=1ci\xe2\x88\x92bi (i.e. the sum of ci\xe2\x88\x92bi over all 1\xe2\x89\xa4i\xe2\x89\xa4n). Before you calculate the score, you can shuffle the elements of a however you want.Find the maximum score that you can get if you shuffle the elements of a optimally." 800.0                                                
2029C "New Rating" "binary search,data structures,dp,greedy" "Hello, Codeforces Forcescode! Kevin used to be a participant of Codeforces. Recently, the KDOI Team has developed a new Online Judge called Forcescode. Kevin has participated in n contests on Forcescode. In the i-th contest, his performance rating is ai.Now he has hacked into the backend of Forcescode and will select an interval [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), then skip all of the contests in this interval. After that, his rating will be recalculated in the following way:  Initially, his rating is x=0;  For each 1\xe2\x89\xa4i\xe2\x89\xa4n, after the i-th contest,   If l\xe2\x89\xa4i\xe2\x89\xa4r, this contest will be skipped, and the rating will remain unchanged;  Otherwise, his rating will be updated according to the following rules:   If ai>x, his rating x will increase by 1;  If ai=x, his rating x will remain unchanged;  If ai<x, his rating x will decrease by 1.   You have to help Kevin to find his maximum possible rating after the recalculation if he chooses the interval [l,r] optimally. Note that Kevin has to skip at least one contest." 1700.0                                                
2025F "Choose Your Queries" "constructive algorithms,dfs and similar,dp,graphs,greedy,trees" "You are given an array a, consisting of n integers (numbered from 1 to n). Initially, they are all zeroes.You have to process q queries. The i-th query consists of two different integers xi and yi. During the i-th query, you have to choose an integer p (which is either xi or yi) and an integer d (which is either 1 or \xe2\x88\x921), and assign ap=ap+d.After each query, every element of a should be a non-negative integer.Process all queries in such a way that the sum of all elements of a after the last query is the minimum possible." 2700.0                                                
2023B Skipping "binary search,dp,graphs,shortest paths" "It is already the year 3024, ideas for problems have long run out, and the olympiad now takes place in a modified individual format. The olympiad consists of n problems, numbered from 1 to n. The i-th problem has its own score ai and a certain parameter bi (1\xe2\x89\xa4bi\xe2\x89\xa4n).Initially, the testing system gives the participant the first problem. When the participant is given the i-th problem, they have two options:   They can submit the problem and receive ai points;  They can skip the problem, in which case they will never be able to submit it. Then, the testing system selects the next problem for the participant from problems with indices j, such that:   If he submitted the i-th problem, it looks at problems with indices j<i;  If he skipped the i-th problem, it looks at problems with indices j\xe2\x89\xa4bi. Among these problems, it selects the problem with the maximum index that it has not previously given to the participant (he has neither submitted nor skipped it before). If there is no such problem, then the competition for the participant ends, and their result is equal to the sum of points for all submitted problems. In particular, if the participant submits the first problem, then the competition for them ends. Note that the participant receives each problem at most once.Prokhor has prepared thoroughly for the olympiad, and now he can submit any problem. Help him determine the maximum number of points he can achieve." 1700.0                                                
2022E1 "Billetes MX (Easy Version)" "2-sat,binary search,combinatorics,constructive algorithms,dfs and similar,dsu,graphs" "This is the easy version of the problem. In this version, it is guaranteed that q=0. You can make hacks only if both versions of the problem are solved.An integer grid A with p rows and q columns is called beautiful if:   All elements of the grid are integers between 0 and 230\xe2\x88\x921, and  For any subgrid, the XOR of the values at the corners is equal to 0. Formally, for any four integers i1, i2, j1, j2 (1\xe2\x89\xa4i1<i2\xe2\x89\xa4p; 1\xe2\x89\xa4j1<j2\xe2\x89\xa4q), Ai1,j1\xe2\x8a\x95Ai1,j2\xe2\x8a\x95Ai2,j1\xe2\x8a\x95Ai2,j2=0, where \xe2\x8a\x95 denotes the bitwise XOR operation. There is a partially filled integer grid G with n rows and m columns where only k cells are filled. Polycarp wants to know how many ways he can assign integers to the unfilled cells so that the grid is beautiful.However, Monocarp thinks that this problem is too easy. Therefore, he will perform q updates on the grid. In each update, he will choose an unfilled cell and assign an integer to it. Note that these updates are persistent. That is, changes made to the grid will apply when processing future updates.For each of the q+1 states of the grid, the initial state and after each of the q queries, determine the number of ways Polycarp can assign integers to the unfilled cells so that the grid is beautiful. Since this number can be very large, you are only required to output their values modulo 109+7." 2500.0                                                
2021E3 "Digital Village (Extreme Version)" "data structures,dfs and similar,dp,dsu,graphs,greedy,math,trees" "This is the extreme version of the problem. In the three versions, the constraints on n and m are different. You can make hacks only if all the versions of the problem are solved.Pak Chanek is setting up internet connections for the village of Khuntien. The village can be represented as a connected simple graph with n houses and m internet cables connecting house ui and house vi, each with a latency of wi.There are p houses that require internet. Pak Chanek can install servers in at most k of the houses. The houses that need internet will then be connected to one of the servers. However, since each cable has its latency, the latency experienced by house si requiring internet will be the maximum latency of the cables between that house and the server it is connected to.For each k=1,2,\xe2\x80\xa6,n, help Pak Chanek determine the minimum total latency that can be achieved for all the houses requiring internet." 2800.0                                                
2018B Speedbreaker "binary search,data structures,dp,greedy,implementation,two pointers" "Djjaner - Speedbreaker\xe2\xa0\x80There are n cities in a row, numbered 1,2,\xe2\x80\xa6,n left to right.  At time 1, you conquer exactly one city, called the starting city.  At time 2,3,\xe2\x80\xa6,n, you can choose a city adjacent to the ones conquered so far and conquer it. You win if, for each i, you conquer city i at a time no later than ai. A winning strategy may or may not exist, also depending on the starting city. How many starting cities allow you to win?" 1900.0                                                
2013A "Zhan\'s Blender" "constructive algorithms,math" "Today, a club fair was held at ""NSPhM"". In order to advertise his pastry club, Zhan decided to demonstrate the power of his blender.To demonstrate the power of his blender, Zhan has n fruits.The blender can mix up to x fruits per second.In each second, Zhan can put up to y fruits into the blender. After that, the blender will blend min(x,c) fruits, where c is the number of fruits inside the blender. After blending, blended fruits are removed from the blender.Help Zhan determine the minimum amount of time required for Zhan to blend all fruits." 800.0                                                
2011B Shuffle "*special problem" "Yes, this is another one of those constructive permutation problems.You are given an integer n. You have to construct a permutation p of size n, i.\xe2\x80\x89e. an array of n integers, where every integer from 1 to n appears exactly once.Every pair of adjacent elements in the permutation (pi and pi+1) must meet the following condition:  if one of them is divisible by the other, the condition pi<pi+1 must hold;  otherwise, the condition pi>pi+1 must hold." -999.0                                                
2010B "Three Brothers" "brute force,implementation,math" "Three brothers agreed to meet. Let\'s number the brothers as follows: the oldest brother is number 1, the middle brother is number 2, and the youngest brother is number 3.When it was time for the meeting, one of the brothers was late. Given the numbers of the two brothers who arrived on time, you need to determine the number of the brother who was late." 800.0                                                
2010A "Alternating Sum of Numbers" "brute force,implementation,math" "You are given a sequence of integers. Output the alternating sum of this sequence. In other words, output a1\xe2\x88\x92a2+a3\xe2\x88\x92a4+a5\xe2\x88\x92\xe2\x80\xa6. That is, the signs of plus and minus alternate, starting with a plus." 800.0                                                
2008C "Longest Good Array" "binary search,brute force,math" "Today, Sakurako was studying arrays. An array a of length n is considered good if and only if:  the array a is increasing, meaning ai\xe2\x88\x921<ai for all 2\xe2\x89\xa4i\xe2\x89\xa4n;  the differences between adjacent elements are increasing, meaning ai\xe2\x88\x92ai\xe2\x88\x921<ai+1\xe2\x88\x92ai for all 2\xe2\x89\xa4i<n. Sakurako has come up with boundaries l and r and wants to construct a good array of maximum length, where l\xe2\x89\xa4ai\xe2\x89\xa4r for all ai.Help Sakurako find the maximum length of a good array for the given l and r." 800.0                                                
2006E "Iris\'s Full Binary Tree" "brute force,data structures,dfs and similar,trees" "Iris likes full binary trees.Let\'s define the depth of a rooted tree as the maximum number of vertices on the simple paths from some vertex to the root. A full binary tree of depth d is a binary tree of depth d with exactly 2d\xe2\x88\x921 vertices.Iris calls a tree a d-binary tree if some vertices and edges can be added to it to make it a full binary tree of depth d. Note that any vertex can be chosen as the root of a full binary tree.Since performing operations on large trees is difficult, she defines the binary depth of a tree as the minimum d satisfying that the tree is d-binary. Specifically, if there is no integer d\xe2\x89\xa51 such that the tree is d-binary, the binary depth of the tree is \xe2\x88\x921.Iris now has a tree consisting of only vertex 1. She wants to add n\xe2\x88\x921 more vertices to form a larger tree. She will add the vertices one by one. When she adds vertex i (2\xe2\x89\xa4i\xe2\x89\xa4n), she\'ll give you an integer pi (1\xe2\x89\xa4pi<i), and add a new edge connecting vertices i and pi.Iris wants to ask you the binary depth of the tree formed by the first i vertices for each 1\xe2\x89\xa4i\xe2\x89\xa4n. Can you tell her the answer?" 3100.0                                                
2005B2 "The Strict Teacher (Hard Version)" "binary search,greedy,math,sortings" "This is the hard version of the problem. The only differences between the two versions are the constraints on m and q. In this version, m,q\xe2\x89\xa4105. You can make hacks only if both versions of the problem are solved.Narek and Tsovak were busy preparing this round, so they have not managed to do their homework and decided to steal David\'s homework. Their strict teacher noticed that David has no homework and now wants to punish him. She hires other teachers to help her catch David. And now m teachers together are chasing him. Luckily, the classroom is big, so David has many places to hide.The classroom can be represented as a one-dimensional line with cells from 1 to n, inclusive.At the start, all m teachers and David are in distinct cells. Then they make moves. During each move   David goes to an adjacent cell or stays at the current one.  Then, each of the m teachers simultaneously goes to an adjacent cell or stays at the current one. This continues until David is caught. David is caught if any of the teachers (possibly more than one) is located in the same cell as David. Everyone sees others\' moves, so they all act optimally.Your task is to find how many moves it will take for the teachers to catch David if they all act optimally.Acting optimally means the student makes his moves in a way that maximizes the number of moves the teachers need to catch him; and the teachers coordinate with each other to make their moves in a way that minimizes the number of moves they need to catch the student.Also, as Narek and Tsovak think this task is easy, they decided to give you q queries on David\'s position." 1200.0                                                
2004E "Not a Nim Problem" "brute force,games,math,number theory" "Two players, Alice and Bob, are playing a game. They have n piles of stones, with the i-th pile initially containing ai stones.On their turn, a player can choose any pile of stones and take any positive number of stones from it, with one condition:  let the current number of stones in the pile be x. It is not allowed to take from the pile a number of stones y such that the greatest common divisor of x and y is not equal to 1. The player who cannot make a move loses. Both players play optimally (that is, if a player has a strategy that allows them to win, no matter how the opponent responds, they will win). Alice goes first.Determine who will win." 2100.0                                                
2003D2 "Turtle and a MEX Problem (Hard Version)" "dfs and similar,dp,graphs,greedy,implementation,math" "The two versions are different problems. In this version of the problem, you can\'t choose the same integer twice or more. You can make hacks only if both versions are solved.One day, Turtle was playing with n sequences. Let the length of the i-th sequence be li. Then the i-th sequence was ai,1,ai,2,\xe2\x80\xa6,ai,li.Piggy gave Turtle a problem to solve when Turtle was playing. The statement of the problem was:  There was a non-negative integer x at first. Turtle would perform an arbitrary number (possibly zero) of operations on the integer.  In each operation, Turtle could choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n and i wasn\'t chosen before, and set x to mex\xe2\x80\xa0(x,ai,1,ai,2,\xe2\x80\xa6,ai,li).  Turtle was asked to find the answer, which was the maximum value of x after performing an arbitrary number of operations. Turtle solved the above problem without difficulty. He defined f(k) as the answer to the above problem when the initial value of x was k.Then Piggy gave Turtle a non-negative integer m and asked Turtle to find the value of m\xe2\x88\x91i=0f(i) (i.e., the value of f(0)+f(1)+\xe2\x80\xa6+f(m)). Unfortunately, he couldn\'t solve this problem. Please help him!\xe2\x80\xa0mex(c1,c2,\xe2\x80\xa6,ck) is defined as the smallest non-negative integer x which does not occur in the sequence c. For example, mex(2,2,0,3) is 1, mex(1,2) is 0." 2100.0                                                
2002F1 "Court Blue (Easy Version)" "brute force,dfs and similar,dp,math,number theory" "This is the easy version of the problem. In this version, n=m and the time limit is lower. You can make hacks only if both versions of the problem are solved.In the court of the Blue King, Lelle and Flamm are having a performance match. The match consists of several rounds. In each round, either Lelle or Flamm wins.Let WL and WF denote the number of wins of Lelle and Flamm, respectively. The Blue King considers a match to be successful if and only if:  after every round, gcd(WL,WF)\xe2\x89\xa41;  at the end of the match, WL\xe2\x89\xa4n,WF\xe2\x89\xa4m. Note that gcd(0,x)=gcd(x,0)=x for every non-negative integer x.Lelle and Flamm can decide to stop the match whenever they want, and the final score of the performance is l\xe2\x8b\x85WL+f\xe2\x8b\x85WF.Please help Lelle and Flamm coordinate their wins and losses such that the performance is successful, and the total score of the performance is maximized." 2600.0                                                
2002E "Cosmic Rays" "brute force,data structures,dp" "Given an array of integers s1,s2,\xe2\x80\xa6,sl, every second, cosmic rays will cause all si such that i=1 or si\xe2\x89\xa0si\xe2\x88\x921 to be deleted simultaneously, and the remaining parts will be concatenated together in order to form the new array s1,s2,\xe2\x80\xa6,sl\xe2\x80\xb2.Define the strength of an array as the number of seconds it takes to become empty.You are given an array of integers compressed in the form of n pairs that describe the array left to right. Each pair (ai,bi) represents ai copies of bi, i.e. bi,bi,\xe2\x8b\xaf,bi\xe2\x8f\x9fai times.For each i=1,2,\xe2\x80\xa6,n, please find the strength of the sequence described by the first i pairs." 2300.0                                                
2000H "Ksyusha and the Loaded Set" "binary search,brute force,data structures,implementation" "Ksyusha decided to start a game development company. To stand out among competitors and achieve success, she decided to write her own game engine. The engine must support a set initially consisting of n distinct integers a1,a2,\xe2\x80\xa6,an.The set will undergo m operations sequentially. The operations can be of the following types:   Insert element x into the set;  Remove element x from the set;  Report the k-load of the set. The k-load of the set is defined as the minimum positive integer d such that the integers d,d+1,\xe2\x80\xa6,d+(k\xe2\x88\x921) do not appear in this set. For example, the 3-load of the set {3,4,6,11} is 7, since the integers 7,8,9 are absent from the set, and no smaller value fits.Ksyusha is busy with management tasks, so you will have to write the engine. Implement efficient support for the described operations." 2200.0                                                
1999C Showering greedy,implementation "As a computer science student, Alex faces a hard challenge \xe2\x80\x94 showering. He tries to shower daily, but despite his best efforts there are always challenges. He takes s minutes to shower and a day only has m minutes! He already has n tasks planned for the day. Task i is represented as an interval (li, ri), which means that Alex is busy and can not take a shower in that time interval (at any point in time strictly between li and ri). No two tasks overlap.Given all n time intervals, will Alex be able to shower that day? In other words, will Alex have a free time interval of length at least s? In the first test case, Alex can shower for the first 3 minutes of the day and not miss any of the tasks." 800.0                                                
1998C "Perform Operations to Maximize Score" "binary search,brute force,constructive algorithms,greedy,implementation" "I see satyam343. I\'m shaking. Please more median problems this time. I love those. Please satyam343 we believe in you.\xe2\x80\x94 satyam343\'s biggest fanYou are given an array a of length n and an integer k. You are also given a binary array b of length n. You can perform the following operation at most k times:   Select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that bi=1. Set ai=ai+1 (i.e., increase ai by 1). Your score is defined to be nmaxi=1(ai+median(ci)), where ci denotes the array of length n\xe2\x88\x921 that you get by deleting ai from a. In other words, your score is the maximum value of ai+median(ci) over all i from 1 to n.Find the maximum score that you can achieve if you perform the operations optimally.For an arbitrary array p, median(p) is defined as the \xe2\x8c\x8a|p|+12\xe2\x8c\x8b-th smallest element of p. For example, median([3,2,1,3])=2 and median([6,2,4,5,1])=4." 1900.0                                                
1996C Sort dp,greedy,sortings,strings "You are given two strings a and b of length n. Then, you are (forced against your will) to answer q queries.For each query, you are given a range bounded by l and r. In one operation, you can choose an integer i (l\xe2\x89\xa4i\xe2\x89\xa4r) and set ai=x where x is any character you desire. Output the minimum number of operations you must perform such that sorted(a[l..r])=sorted(b[l..r]). The operations you perform on one query does not affect other queries.For an arbitrary string c, sorted(c[l..r]) denotes the substring consisting of characters cl,cl+1,...,cr sorted in lexicographical order." 1200.0                                                
1996B Scale greedy,implementation "Tina has a square grid with n rows and n columns. Each cell in the grid is either 0 or 1. Tina wants to reduce the grid by a factor of k (k is a divisor of n). To do this, Tina splits the grid into k\xc3\x97k nonoverlapping blocks of cells such that every cell belongs to exactly one block.Tina then replaces each block of cells with a single cell equal to the value of the cells in the block. It is guaranteed that every cell in the same block has the same value. For example, the following demonstration shows a grid being reduced by factor of 3. Original grid 000111000111000111111000111000111000  Reduced grid 0110 Help Tina reduce the grid by a factor of k." 800.0                                                
1995D Cases "bitmasks,brute force,dp,strings" "You\'re a linguist studying a mysterious ancient language. You know that   Its words consist only of the first c letters of the Latin alphabet.  Each word has a case which can be unambiguously determined by its last letter (different letters correspond to different cases). For example, words ""ABACABA"" and ""ABA"" (if they exist) have the same case in this language because they both have the same ending \'A\', whereas ""ALICE"" and ""BOB"" have different cases. If the language does not have a case corresponding to some letter, it means that the word cannot end with this letter.  The length of each word is k or less. You have a single text written in this language. Unfortunately, as the language is really ancient, spaces between words are missing and all letters are uppercase. You wonder what is the minimum number of cases the language can have. Can you find this out?" 2300.0                                                
1994D "Funny Game" "constructive algorithms,dsu,graphs,greedy,math,number theory,trees" "Vanya has a graph with n vertices (numbered from 1 to n) and an array a of n integers; initially, there are no edges in the graph. Vanya got bored, and to have fun, he decided to perform n\xe2\x88\x921 operations.Operation number x (operations are numbered in order starting from 1) is as follows:  Choose 2 different numbers 1\xe2\x89\xa4u,v\xe2\x89\xa4n, such that |au\xe2\x88\x92av| is divisible by x.  Add an undirected edge between vertices u and v to the graph. Help Vanya get a connected\xe2\x88\x97 graph using the n\xe2\x88\x921 operations, or determine that it is impossible.\xe2\x88\x97A graph is called connected if it is possible to reach any vertex from any other by moving along the edges." 1900.0                                                
1993A "Question Marks" greedy,implementation "Tim is doing a test consisting of 4n questions; each question has 4 options: \'A\', \'B\', \'C\', and \'D\'. For each option, there are exactly n correct answers corresponding to that option \xe2\x80\x94 meaning there are n questions with the answer \'A\', n questions with the answer \'B\', n questions with the answer \'C\', and n questions with the answer \'D\'.For each question, Tim wrote his answer on the answer sheet. If he could not figure out the answer, he would leave a question mark \'?\' for that question.You are given his answer sheet of 4n characters. What is the maximum number of correct answers Tim can get?" 800.0                                                
1992D "Test of Love" dp,greedy,implementation "ErnKor is ready to do anything for Julen, even to swim through crocodile-infested swamps. We decided to test this love. ErnKor will have to swim across a river with a width of 1 meter and a length of n meters.The river is very cold. Therefore, in total (that is, throughout the entire swim from 0 to n+1) ErnKor can swim in the water for no more than k meters. For the sake of humanity, we have added not only crocodiles to the river, but also logs on which he can jump. Our test is as follows:Initially, ErnKor is on the left bank and needs to reach the right bank. They are located at the 0 and n+1 meters respectively. The river can be represented as n segments, each with a length of 1 meter. Each segment contains either a log \'L\', a crocodile \'C\', or just water \'W\'. ErnKor can move as follows:   If he is on the surface (i.e., on the bank or on a log), he can jump forward for no more than m (1\xe2\x89\xa4m\xe2\x89\xa410) meters (he can jump on the bank, on a log, or in the water).  If he is in the water, he can only swim to the next river segment (or to the bank if he is at the n-th meter).  ErnKor cannot land in a segment with a crocodile in any way. Determine if ErnKor can reach the right bank." 1200.0                                                
1991I "Grid Game" "constructive algorithms,games,graph matchings,greedy,interactive" "This is an interactive problem.You are given a grid with n rows and m columns. You need to fill each cell with a unique integer from 1 to n\xe2\x8b\x85m.After filling the grid, you will play a game on this grid against the interactor. Players take turns selecting one of the previously unselected cells from the grid, with the interactor going first.On the first turn, the interactor can choose any cell from the grid. After that, any chosen cell must be orthogonally adjacent to at least one previously selected cell. Two cells are considered orthogonally adjacent if they share an edge. The game continues until all cells have been selected.Your goal is to let the sum of numbers in the cells selected by you be strictly less than the sum of numbers in the cells selected by the interactor." 3500.0                                                
1991H "Prime Split Game" "bitmasks,dp,fft,games,math,number theory" "Alice and Bob are playing a game with n piles of stones, where the i-th pile has ai stones. Players take turns making moves, with Alice going first.On each move, the player does the following three-step process:   Choose an integer k (1\xe2\x89\xa4k\xe2\x89\xa4n2). Note that the value of k can be different for different moves.  Remove k piles of stones.  Choose another k piles of stones and split each pile into two piles. The number of stones in each new pile must be a prime number. The player who is unable to make a move loses.Determine who will win if both players play optimally." 3300.0                                                
1990D "Grid Puzzle" "bitmasks,brute force,dp,greedy,implementation" "You are given an array a of size n.There is an n\xc3\x97n grid. In the i-th row, the first ai cells are black and the other cells are white. In other words, note (i,j) as the cell in the i-th row and j-th column, cells (i,1),(i,2),\xe2\x80\xa6,(i,ai) are black, and cells (i,ai+1),\xe2\x80\xa6,(i,n) are white.You can do the following operations any number of times in any order:   Dye a 2\xc3\x972 subgrid white;  Dye a whole row white. Note you can not dye a whole column white. Find the minimum number of operations to dye all cells white." 1800.0                                                
1987F2 "Interesting Problem (Hard Version)" dp "This is the hard version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if both versions of the problem are solved.You are given an array of integers a of length n. In one operation, you will perform the following two-step process:   Choose an index i such that 1\xe2\x89\xa4i<|a| and ai=i.  Remove ai and ai+1 from the array and concatenate the remaining parts. Find the maximum number of times that you can perform the operation above." 2600.0                                                
1987A "Upload More RAM" greedy,math "Oh no, the ForceCodes servers are running out of memory! Luckily, you can help them out by uploading some of your RAM!You want to upload n GBs of RAM. Every second, you will upload either 0 or 1 GB of RAM. However, there is a restriction on your network speed: in any k consecutive seconds, you can upload only at most 1 GB of RAM in total.Find the minimum number of seconds needed to upload n GBs of RAM!" 800.0                                                
1980G "Yasya and the Mysterious Tree" "bitmasks,data structures,dfs and similar,graphs,greedy,strings,trees" "Yasya was walking in the forest and accidentally found a tree with n vertices. A tree is a connected undirected graph with no cycles.Next to the tree, the girl found an ancient manuscript with m queries written on it. The queries can be of two types.The first type of query is described by the integer y. The weight of each edge in the tree is replaced by the bitwise exclusive OR of the weight of that edge and the integer y.The second type is described by the vertex v and the integer x. Yasya chooses a vertex u (1\xe2\x89\xa4u\xe2\x89\xa4n, u\xe2\x89\xa0v) and mentally draws a bidirectional edge of weight x from v to u in the tree.Then Yasya finds a simple cycle in the resulting graph and calculates the bitwise exclusive OR of all the edges in it. She wants to choose a vertex u such that the calculated value is maximum. This calculated value will be the answer to the query. It can be shown that such a cycle exists and is unique under the given constraints (independent of the choice of u). If an edge between v and u already existed, a simple cycle is the path v\xe2\x86\x92u\xe2\x86\x92v.Note that the second type of query is performed mentally, meaning the tree does not change in any way after it.Help Yasya answer all the queries." 2300.0                                                
1980F2 "Field Division (hard version)" math,sortings "This is a hard version of the problem; it differs from the easy version only by the question. The easy version only needs you to print whether some values are non-zero or not. The hard version needs you to print the exact values.Alice and Bob are dividing the field. The field is a rectangle of size n\xc3\x97m (2\xe2\x89\xa4n,m\xe2\x89\xa4109); the rows are numbered from 1 to n from top to bottom, and the columns are numbered from 1 to m from left to right. The cell at the intersection of row r and column c is denoted as (r,c).Bob has k (2\xe2\x89\xa4k\xe2\x89\xa42\xe2\x8b\x85105) fountains, all of them are located in different cells of the field. Alice is responsible for dividing the field, but she must meet several conditions:  To divide the field, Alice will start her path in any free (without a fountain) cell on the left or top side of the field and will move, each time moving to the adjacent cell down or right. Her path will end on the right or bottom side of the field.  Alice\'s path will divide the field into two parts \xe2\x80\x94 one part will belong to Alice (this part includes the cells of her path), the other part \xe2\x80\x94 to Bob.  Alice will own the part that includes the cell (n,1).  Bob will own the part that includes the cell (1,m). Alice wants to divide the field in such a way as to get as many cells as possible.Bob wants to keep ownership of all the fountains, but he can give one of them to Alice. First, output the integer \xce\xb1 \xe2\x80\x94 the maximum possible size of Alice\'s plot, if Bob does not give her any fountain (i.e., all fountains will remain on Bob\'s plot).Then output k non-negative integers a1,a2,\xe2\x80\xa6,ak, where ai is a value such that after Bob gives Alice the i-th fountain, the maximum size of her plot will be \xce\xb1+ai." 2400.0                                                
1979B "XOR Sequences" bitmasks,greedy "You are given two distinct non-negative integers x and y. Consider two infinite sequences a1,a2,a3,\xe2\x80\xa6 and b1,b2,b3,\xe2\x80\xa6, where  an=n\xe2\x8a\x95x;  bn=n\xe2\x8a\x95y. Here, x\xe2\x8a\x95y denotes the bitwise XOR operation of integers x and y.For example, with x=6, the first 8 elements of sequence a will look as follows: [7,4,5,2,3,0,1,14,\xe2\x80\xa6]. Note that the indices of elements start with 1.Your task is to find the length of the longest common subsegment\xe2\x80\xa0 of sequences a and b. In other words, find the maximum integer m such that ai=bj,ai+1=bj+1,\xe2\x80\xa6,ai+m\xe2\x88\x921=bj+m\xe2\x88\x921 for some i,j\xe2\x89\xa51.\xe2\x80\xa0A subsegment of sequence p is a sequence pl,pl+1,\xe2\x80\xa6,pr, where 1\xe2\x89\xa4l\xe2\x89\xa4r." 1000.0                                                
1976A "Verify Password" implementation,sortings,strings "Monocarp is working on his new site, and the current challenge is to make the users pick strong passwords.Monocarp decided that strong passwords should satisfy the following conditions:   password should consist only of lowercase Latin letters and digits;  there should be no digit that comes after a letter (so, after each letter, there is either another letter or the string ends);  all digits should be sorted in the non-decreasing order;  all letters should be sorted in the non-decreasing order. Note that it\'s allowed for the password to have only letters or only digits.Monocarp managed to implement the first condition, but he struggles with the remaining ones. Can you help him to verify the passwords?" 800.0                                                
1974C "Beautiful Triple Pairs" "combinatorics,data structures" "Polycarp was given an array a of n integers. He really likes triples of numbers, so for each j (1\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x922) he wrote down a triple of elements [aj,aj+1,aj+2].Polycarp considers a pair of triples b and c beautiful if they differ in exactly one position, that is, one of the following conditions is satisfied:  b1\xe2\x89\xa0c1 and b2=c2 and b3=c3;  b1=c1 and b2\xe2\x89\xa0c2 and b3=c3;  b1=c1 and b2=c2 and b3\xe2\x89\xa0c3. Find the number of beautiful pairs of triples among the written triples [aj,aj+1,aj+2]." 1400.0                                                
1971F "Circle Perimeter" "binary search,brute force,dfs and similar,geometry,implementation,math" "Given an integer r, find the number of lattice points that have a Euclidean distance from (0,0) greater than or equal to r but strictly less than r+1.A lattice point is a point with integer coordinates. The Euclidean distance from (0,0) to the point (x,y) is \xe2\x88\x9ax2+y2." 1600.0                                                
1970G2 "Min-Fund Prison (Medium)" "brute force,dfs and similar,dp,graphs,trees" "In the medium version, 2\xe2\x89\xa4\xe2\x88\x91n\xe2\x89\xa4300 and 1\xe2\x89\xa4\xe2\x88\x91m\xe2\x89\xa4300After a worker\'s strike organized by the Dementors asking for equal rights, the prison of Azkaban has suffered some damage. After settling the spirits, the Ministry of Magic is looking to renovate the prison to ensure that the Dementors are kept in check. The prison consists of n prison cells and m bi-directional corridors. The ith corridor is from cells ui to vi. A subset of these cells S is called a complex if any cell in S is reachable from any other cell in S. Formally, a subset of cells S is a complex if x and y are reachable from each other for all x,y\xe2\x88\x88S, using only cells from S on the way. The funding required for a complex S consisting of k cells is defined as k2.As part of your Intro to Magical Interior Design course at Hogwarts, you have been tasked with designing the prison. The Ministry of Magic has asked that you divide the prison into 2 complexes with exactly one corridor connecting them, so that the Dementors can\'t organize union meetings. For this purpose, you are allowed to build bi-directional corridors. The funding required to build a corridor between any 2 cells is c. Due to budget cuts and the ongoing fight against the Death Eaters, you must find the minimum total funding required to divide the prison as per the Ministry\'s requirements or \xe2\x88\x921 if no division is possible.Note: The total funding is the sum of the funding required for the 2 complexes and the corridors built. If after the division, the two complexes have x and y cells respectively and you have built a total of a corridors, the total funding will be x2+y2+c\xc3\x97a. Note that x+y=n." 2200.0                                                
1970G1 "Min-Fund Prison (Easy)" "dfs and similar,trees" "In the easy version, m=n\xe2\x88\x921 and there exists a path between u and v for all u,v (1\xe2\x89\xa4u,v\xe2\x89\xa4n).After a worker\'s strike organized by the Dementors asking for equal rights, the prison of Azkaban has suffered some damage. After settling the spirits, the Ministry of Magic is looking to renovate the prison to ensure that the Dementors are kept in check. The prison consists of n prison cells and m bi-directional corridors. The ith corridor is from cells ui to vi. A subset of these cells S is called a complex if any cell in S is reachable from any other cell in S. Formally, a subset of cells S is a complex if x and y are reachable from each other for all x,y\xe2\x88\x88S, using only cells from S on the way. The funding required for a complex S consisting of k cells is defined as k2.As part of your Intro to Magical Interior Design course at Hogwarts, you have been tasked with designing the prison. The Ministry of Magic has asked that you divide the prison into 2 complexes with exactly one corridor connecting them, so that the Dementors can\'t organize union meetings. For this purpose, you are allowed to build bi-directional corridors. The funding required to build a corridor between any 2 cells is c. Due to budget cuts and the ongoing fight against the Death Eaters, you must find the minimum total funding required to divide the prison as per the Ministry\'s requirements or \xe2\x88\x921 if no division is possible.Note: The total funding is the sum of the funding required for the 2 complexes and the corridors built. If after the division, the two complexes have x and y cells respectively and you have built a total of a corridors, the total funding will be x2+y2+c\xc3\x97a. Note that x+y=n." 1900.0                                                
1970E1 "Trails (Easy)" dp "Harry Potter is hiking in the Alps surrounding Lake Geneva. In this area there are m cabins, numbered 1 to m. Each cabin is connected, with one or more trails, to a central meeting point next to the lake. Each trail is either short or long. Cabin i is connected with si short trails and li long trails to the lake.Each day, Harry walks a trail from the cabin where he currently is to Lake Geneva, and then from there he walks a trail to any of the m cabins (including the one he started in). However, as he has to finish the hike in a day, at least one of the two trails has to be short.How many possible combinations of trails can Harry take if he starts in cabin 1 and walks for n days?Give the answer modulo 109+7." 1800.0                                                
1970B3 "Exact Neighbours (Hard)" "constructive algorithms" "After some recent attacks on Hogwarts Castle by the Death Eaters, the Order of the Phoenix has decided to station n members in Hogsmead Village. The houses will be situated on a picturesque n\xc3\x97n square field. Each wizard will have their own house, and every house will belong to some wizard. Each house will take up the space of one square.However, as you might know wizards are very superstitious. During the weekends, each wizard i will want to visit the house that is exactly ai (0\xe2\x89\xa4ai\xe2\x89\xa4n) away from their own house. The roads in the village are built horizontally and vertically, so the distance between points (xi,yi) and (xj,yj) on the n\xc3\x97n field is |xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|. The wizards know and trust each other, so one wizard can visit another wizard\'s house when the second wizard is away. The houses to be built will be big enough for all n wizards to simultaneously visit any house.Apart from that, each wizard is mandated to have a view of the Hogwarts Castle in the north and the Forbidden Forest in the south, so the house of no other wizard should block the view. In terms of the village, it means that in each column of the n\xc3\x97n field, there can be at most one house, i.e. if the i-th house has coordinates (xi,yi), then xi\xe2\x89\xa0xj for all i\xe2\x89\xa0j.The Order of the Phoenix doesn\'t yet know if it is possible to place n houses in such a way that will satisfy the visit and view requirements of all n wizards, so they are asking for your help in designing such a plan.If it is possible to have a correct placement, where for the i-th wizard there is a house that is ai away from it and the house of the i-th wizard is the only house in their column, output YES, the position of houses for each wizard, and to the house of which wizard should each wizard go during the weekends.If it is impossible to have a correct placement, output NO." 2300.0                                                
1970A3 "Balanced Unshuffle (Hard)" "constructive algorithms,trees" "The only difference with the medium version is the maximum length of the input.A parentheses sequence is a string consisting of characters ""("" and "")"", for example ""(()(("".A balanced parentheses sequence is a parentheses sequence which can become a valid mathematical expression after inserting numbers and operations into it, for example ""(()(()))"".The balance of a parentheses sequence is defined as the number of opening parentheses ""("" minus the number of closing parentheses "")"". For example, the balance of the sequence ""(()(("" is 3.A balanced parentheses sequence can also be defined as a parentheses sequence with balance 0 such that each of its prefixes has a non-negative balance.We define the balanced shuffle operation that takes a parentheses sequence and returns a parentheses sequence as follows: first, for every character of the input sequence, we compute the balance of the prefix of the sequence before that character and write those down in a table together with the positions of the characters in the input sequence, for example:Prefix balance01212321Position12345678Character(()(()))Then, we sort the columns of this table in increasing order of prefix balance, breaking ties in decreasing order of position. In the above example, we get:Prefix balance01112223Position18427536Character()(()())The last row of this table forms another parentheses sequence, in this case ""()(()())"". This sequence is called the result of applying the balanced shuffle operation to the input sequence, or in short just the balanced shuffle of the input sequence.Surprisingly, it turns out that the balanced shuffle of any balanced parentheses sequence is always another balanced parentheses sequence (we will omit the proof for brevity). Even more surprisingly, the balanced shuffles of two different balanced parentheses sequences are always different, therefore the balanced shuffle operation is a bijection on the set of balanced parentheses sequences of any given length (we will omit this proof, too).You are given a balanced parentheses sequence. Find its preimage: the balanced parentheses sequence the balanced shuffle of which is equal to the given sequence." 2400.0                                                
1968G2 "Division + LCP (hard version)" "binary search,brute force,data structures,dp,hashing,math,string suffix structures,strings" "This is the hard version of the problem. In this version l\xe2\x89\xa4r.You are given a string s. For a fixed k, consider a division of s into exactly k continuous substrings w1,\xe2\x80\xa6,wk. Let fk be the maximal possible LCP(w1,\xe2\x80\xa6,wk) among all divisions.LCP(w1,\xe2\x80\xa6,wm) is the length of the Longest Common Prefix of the strings w1,\xe2\x80\xa6,wm.For example, if s=abababcab and k=4, a possible division is abababcab. The LCP(ab,ab,abc,ab) is 2, since ab is the Longest Common Prefix of those four strings. Note that each substring consists of a continuous segment of characters and each character belongs to exactly one substring.Your task is to find fl,fl+1,\xe2\x80\xa6,fr." 2200.0                                                
1967E1 "Again Counting Arrays (Easy Version)" combinatorics,dp,fft,math "This is the easy version of the problem. The differences between the two versions are the constraints on n,m,b0 and the time limit. You can make hacks only if both versions are solved.Little R has counted many sets before, and now she decides to count arrays.Little R thinks an array b0,\xe2\x80\xa6,bn consisting of non-negative integers is continuous if and only if, for each i such that 1\xe2\x89\xa4i\xe2\x89\xa4n, |bi\xe2\x88\x92bi\xe2\x88\x921|=1 is satisfied. She likes continuity, so she only wants to generate continuous arrays.If Little R is given b0 and a1,\xe2\x80\xa6,an, she will try to generate a non-negative continuous array b, which has no similarity with a. More formally, for all 1\xe2\x89\xa4i\xe2\x89\xa4n, ai\xe2\x89\xa0bi holds.However, Little R does not have any array a. Instead, she gives you n, m and b0. She wants to count the different integer arrays a1,\xe2\x80\xa6,an satisfying:  1\xe2\x89\xa4ai\xe2\x89\xa4m;  At least one non-negative continuous array b0,\xe2\x80\xa6,bn can be generated. Note that bi\xe2\x89\xa50, but the bi can be arbitrarily large.Since the actual answer may be enormous, please just tell her the answer modulo 998244353." 3100.0                                                
1956F "Nene and the Passing Game" "constructive algorithms,data structures,dsu,graphs,sortings" "Nene is training her team as a basketball coach. Nene\'s team consists of n players, numbered from 1 to n. The i-th player has an arm interval [li,ri]. Two players i and j (i\xe2\x89\xa0j) can pass the ball to each other if and only if |i\xe2\x88\x92j|\xe2\x88\x88[li+lj,ri+rj] (here, |x| denotes the absolute value of x).Nene wants to test the cooperation ability of these players. In order to do this, she will hold several rounds of assessment.  In each round, Nene will select a sequence of players p1,p2,\xe2\x80\xa6,pm such that players pi and pi+1 can pass the ball to each other for all 1\xe2\x89\xa4i<m. The length of the sequence m can be chosen by Nene. Each player can appear in the sequence p1,p2,\xe2\x80\xa6,pm multiple times or not appear in it at all.  Then, Nene will throw a ball to player p1, player p1 will pass the ball to player p2 and so on... Player pm will throw a ball away from the basketball court so it can no longer be used. As a coach, Nene wants each of n players to appear in at least one round of assessment. Since Nene has to go on a date after school, Nene wants you to calculate the minimum number of rounds of assessment needed to complete the task." 3000.0                                                
1956A "Nene\'s Game" "binary search,brute force,data structures,games,greedy" "Nene invented a new game based on an increasing sequence of integers a1,a2,\xe2\x80\xa6,ak.In this game, initially n players are lined up in a row. In each of the rounds of this game, the following happens:  Nene finds the a1-th, a2-th, \xe2\x80\xa6, ak-th players in a row. They are kicked out of the game simultaneously. If the i-th player in a row should be kicked out, but there are fewer than i players in a row, they are skipped. Once no one is kicked out of the game in some round, all the players that are still in the game are declared as winners.For example, consider the game with a=[3,5] and n=5 players. Let the players be named player A, player B, \xe2\x80\xa6, player E in the order they are lined up initially. Then,   Before the first round, players are lined up as ABCDE. Nene finds the 3-rd and the 5-th players in a row. These are players C and E. They are kicked out in the first round.  Now players are lined up as ABD. Nene finds the 3-rd and the 5-th players in a row. The 3-rd player is player D and there is no 5-th player in a row. Thus, only player D is kicked out in the second round.  In the third round, no one is kicked out of the game, so the game ends after this round.  Players A and B are declared as the winners. Nene has not yet decided how many people would join the game initially. Nene gave you q integers n1,n2,\xe2\x80\xa6,nq and you should answer the following question for each 1\xe2\x89\xa4i\xe2\x89\xa4q independently:  How many people would be declared as winners if there are ni players in the game initially?" 800.0                                                
1952I "Dark Matter" bitmasks,geometry "View the statement as a PDF." -999.0                                                
1952A "Are You a Robot, Again?" strings  -999.0                                                
1951E "No Palindromes" "brute force,constructive algorithms,divide and conquer,greedy,hashing,implementation,math,strings" "Christopher Tin ft. Soweto Gospel Choir - Baba Yetu\xe0\xb6\x9eYou are given a string s consisting of lowercase Latin characters. You need to partition\xe2\x80\xa0 this string into some substrings, such that each substring is not a palindrome\xe2\x80\xa1.\xe2\x80\xa0 A partition of a string s is an ordered sequence of some k strings t1,t2,\xe2\x80\xa6,tk, such that t1+t2+\xe2\x80\xa6+tk=s, where + here represents the concatenation operation.\xe2\x80\xa1 A string s is considered a palindrome if it reads the same backwards as forwards. For example, racecar, abccba, and a are palindromes, but ab, dokibird, and kurosanji are not." 2000.0                                                
1951B "Battle Cows" "binary search,data structures,greedy" "The HU - Shireg Shireg\xe0\xb6\x9eThere are n cows participating in a coding tournament. Cow i has a Cowdeforces rating of ai (all distinct), and is initially in position i. The tournament consists of n\xe2\x88\x921 matches as follows:   The first match is between the cow in position 1 and the cow in position 2.  Subsequently, each match i is between the cow in position i+1 and the winner of match i\xe2\x88\x921.  In each match, the cow with the higher Cowdeforces rating wins and proceeds to the next match. You are the owner of cow k. For you, winning the tournament is not important; rather, you want your cow to win in as many matches as possible. As an acquaintance of the tournament organizers, you can ask them to swap the position of your cow with another cow only once, or you can choose to do nothing.Find the maximum number of wins your cow can achieve." 1200.0                                                
1950G "Shuffling Songs" "bitmasks,dfs and similar,dp,graphs,hashing,implementation,strings" "Vladislav has a playlist consisting of n songs, numbered from 1 to n. Song i has genre gi and writer wi. He wants to make a playlist in such a way that every pair of adjacent songs either have the same writer or are from the same genre (or both). He calls such a playlist exciting. Both gi and wi are strings of length no more than 104.It might not always be possible to make an exciting playlist using all the songs, so the shuffling process occurs in two steps. First, some amount (possibly zero) of the songs are removed, and then the remaining songs in the playlist are rearranged to make it exciting.Since Vladislav doesn\'t like when songs get removed from his playlist, he wants the making playlist to perform as few removals as possible. Help him find the minimum number of removals that need to be performed in order to be able to rearrange the rest of the songs to make the playlist exciting." 1900.0                                                
1948E "Clique Partition" "brute force,constructive algorithms,graphs,greedy,implementation" "You are given two integers, n and k. There is a graph on n vertices, numbered from 1 to n, which initially has no edges.You have to assign each vertex an integer; let ai be the integer on the vertex i. All ai should be distinct integers from 1 to n.After assigning integers, for every pair of vertices (i,j), you add an edge between them if |i\xe2\x88\x92j|+|ai\xe2\x88\x92aj|\xe2\x89\xa4k.Your goal is to create a graph which can be partitioned into the minimum possible (for the given values of n and k) number of cliques. Each vertex of the graph should belong to exactly one clique. Recall that a clique is a set of vertices such that every pair of vertices in it are connected with an edge.Since BledDest hasn\'t really brushed his programming skills up, he can\'t solve the problem ""given a graph, partition it into the minimum number of cliques"". So we also ask you to print the partition itself." 2100.0                                                
1945E "Binary Search" "binary search,constructive algorithms,greedy" "Anton got bored during the hike and wanted to solve something. He asked Kirill if he had any new problems, and of course, Kirill had one.You are given a permutation p of size n, and a number x that needs to be found. A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).You decided that you are a cool programmer, so you will use an advanced algorithm for the search \xe2\x80\x94 binary search. However, you forgot that for binary search, the array must be sorted.You did not give up and decided to apply this algorithm anyway, and in order to get the correct answer, you can perform the following operation no more than 2 times before running the algorithm: choose the indices i, j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) and swap the elements at positions i and j.After that, the binary search is performed. At the beginning of the algorithm, two variables l=1 and r=n+1 are declared. Then the following loop is executed:  If r\xe2\x88\x92l=1, end the loop  m=\xe2\x8c\x8ar+l2\xe2\x8c\x8b  If pm\xe2\x89\xa4x, assign l=m, otherwise r=m. The goal is to rearrange the numbers in the permutation before the algorithm so that after the algorithm is executed, pl is equal to x. It can be shown that 2 operations are always sufficient." 1700.0                                                
1943E2 "MEX Game 2 (Hard Version)" "binary search,greedy,two pointers" "This is the hard version of the problem. The only difference between the two versions is the constraint on t, m and the sum of m. You can make hacks only if both versions of the problem are solved.Alice and Bob play yet another game on an array a of size n. Alice starts with an empty array c. Both players take turns playing, with Alice starting first.On Alice\'s turn, she picks one element from a, appends that element to c, and then deletes it from a.On Bob\'s turn, he picks at most k elements from a, and then deletes it from a. The game ends when the array a is empty. Alice\'s score is defined to be the MEX\xe2\x80\xa0 of c. Alice wants to maximize her score while Bob wants to minimize it. Find Alice\'s final score if both players play optimally.The array will be given in compressed format. Instead of giving the elements present in the array, we will be giving their frequencies. Formally, you will be given m, the maximum element in the array, and then m+1 integers f0,f1,\xe2\x80\xa6,fm, where fi represents the number of times i occurs in the array a.\xe2\x80\xa0 The MEX (minimum excludant) of an array of integers is defined as the smallest non-negative integer which does not occur in the array. For example:   The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0, 1, 2 and 3 belong to the array, but 4 does not." 3300.0                                                
1943D1 "Counting Is Fun (Easy Version)" "brute force,combinatorics,dp,math" "This is the easy version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if both versions of the problem are solved.An array b of m non-negative integers is said to be good if all the elements of b can be made equal to 0 using the following operation some (possibly, zero) times:   Select two distinct indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4m) and subtract 1 from all bi such that l\xe2\x89\xa4i\xe2\x89\xa4r. You are given two positive integers n, k and a prime number p.Over all (k+1)n arrays of length n such that 0\xe2\x89\xa4ai\xe2\x89\xa4k for all 1\xe2\x89\xa4i\xe2\x89\xa4n, count the number of good arrays.Since the number might be too large, you are only required to find it modulo p." 2400.0                                                
1942F "Farmer John\'s Favorite Function" "brute force,data structures,implementation,math" "\xce\xa9\xce\xa9PARTS - Camellia\xe2\xa0\x80Farmer John has an array a of length n. He also has a function f with the following recurrence:   f(1)=\xe2\x88\x9aa1;  For all i>1, f(i)=\xe2\x88\x9af(i\xe2\x88\x921)+ai. Note that f(i) is not necessarily an integer.He plans to do q updates to the array. Each update, he gives you two integers k and x and he wants you to set ak=x. After each update, he wants to know \xe2\x8c\x8af(n)\xe2\x8c\x8b, where \xe2\x8c\x8at\xe2\x8c\x8b denotes the value of t rounded down to the nearest integer." 2700.0                                                
1941A "Rudolf and the Ticket" "brute force,math" "Rudolf is going to visit Bernard, and he decided to take the metro to get to him. The ticket can be purchased at a machine that accepts exactly two coins, the sum of which does not exceed k.Rudolf has two pockets with coins. In the left pocket, there are n coins with denominations b1,b2,\xe2\x80\xa6,bn. In the right pocket, there are m coins with denominations c1,c2,\xe2\x80\xa6,cm. He wants to choose exactly one coin from the left pocket and exactly one coin from the right pocket (two coins in total).Help Rudolf determine how many ways there are to select indices f and s such that bf+cs\xe2\x89\xa4k." 800.0                                                
1937B "Binary Path" dp,greedy,implementation "You are given a 2\xc3\x97n grid filled with zeros and ones. Let the number at the intersection of the i-th row and the j-th column be aij.There is a grasshopper at the top-left cell (1,1) that can only jump one cell right or downwards. It wants to reach the bottom-right cell (2,n). Consider the binary string of length n+1 consisting of numbers written in cells of the path without changing their order.Your goal is to:   Find the lexicographically smallest\xe2\x80\xa0 string you can attain by choosing any available path;  Find the number of paths that yield this lexicographically smallest string. \xe2\x80\xa0 If two strings s and t have the same length, then s is lexicographically smaller than t if and only if in the first position where s and t differ, the string s has a smaller element than the corresponding element in t." 1300.0                                                
1936A "Bitwise Operation Wizard" "bitmasks,constructive algorithms,greedy,interactive,math" "This is an interactive problem.There is a secret sequence p0,p1,\xe2\x80\xa6,pn\xe2\x88\x921, which is a permutation of {0,1,\xe2\x80\xa6,n\xe2\x88\x921}.You need to find any two indices i and j such that pi\xe2\x8a\x95pj is maximized, where \xe2\x8a\x95 denotes the bitwise XOR operation.To do this, you can ask queries. Each query has the following form: you pick arbitrary indices a, b, c, and d (0\xe2\x89\xa4a,b,c,d<n). Next, the jury calculates x=(pa\xe2\x88\xa3pb) and y=(pc\xe2\x88\xa3pd), where | denotes the bitwise OR operation. Finally, you receive the result of comparison between x and y. In other words, you are told if x<y, x>y, or x=y.Please find any two indices i and j (0\xe2\x89\xa4i,j<n) such that pi\xe2\x8a\x95pj is maximum among all such pairs, using at most 3n queries. If there are multiple pairs of indices satisfying the condition, you may output any one of them." 1700.0                                                
1935D "Exam in MAC" "binary search,combinatorics,implementation,math" "The Master\'s Assistance Center has announced an entrance exam, which consists of the following.The candidate is given a set s of size n and some strange integer c. For this set, it is needed to calculate the number of pairs of integers (x,y) such that 0\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4c, x+y is not contained in the set s, and also y\xe2\x88\x92x is not contained in the set s.Your friend wants to enter the Center. Help him pass the exam!" 1800.0                                                
1935B "Informatics in MAC" "constructive algorithms" "In the Master\'s Assistance Center, Nyam-Nyam was given a homework assignment in informatics.There is an array a of length n, and you want to divide it into k>1 subsegments\xe2\x80\xa0 in such a way that the MEX\xe2\x80\xa1 on each subsegment is equal to the same integer.Help Nyam-Nyam find any suitable division, or determine that it does not exist.\xe2\x80\xa0A division of an array into k subsegments is defined as k pairs of integers (l1,r1),(l2,r2),\xe2\x80\xa6,(lk,rk) such that li\xe2\x89\xa4ri and for each 1\xe2\x89\xa4j\xe2\x89\xa4k\xe2\x88\x921, lj+1=rj+1, and also l1=1 and rk=n. These pairs represent the subsegments themselves.\xe2\x80\xa1MEX of an array is the smallest non-negative integer that does not belong to the array.For example:   MEX of the array [2,2,1] is 0, because 0 does not belong to the array.  MEX of the array [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  MEX of the array [0,3,1,2] is 4, because 0, 1, 2, and 3 belong to the array, but 4 does not." 1200.0                                                
1933F "Turtle Mission: Robot and the Earthquake" "dfs and similar,dp,graphs,shortest paths" "The world is a grid with n rows and m columns. The rows are numbered 0,1,\xe2\x80\xa6,n\xe2\x88\x921, while the columns are numbered 0,1,\xe2\x80\xa6,m\xe2\x88\x921. In this world, the columns are cyclic (i.e. the top and the bottom cells in each column are adjacent). The cell on the i-th row and the j-th column (0\xe2\x89\xa4i<n,0\xe2\x89\xa4j<m) is denoted as (i,j). At time 0, the cell (i,j) (where 0\xe2\x89\xa4i<n,0\xe2\x89\xa4j<m) contains either a rock or nothing. The state of cell (i,j) can be described using the integer ai,j:   If ai,j=1, there is a rock at (i,j).  If ai,j=0, there is nothing at (i,j). As a result of aftershocks from the earthquake, the columns follow tectonic plate movements: each column moves cyclically upwards at a velocity of 1 cell per unit of time. Formally, for some 0\xe2\x89\xa4i<n,0\xe2\x89\xa4j<m, if (i,j) contains a rock at the moment, it will move from (i,j) to (i\xe2\x88\x921,j) (or to (n\xe2\x88\x921,j) if i=0). The robot called RT is initially positioned at (0,0). It has to go to (n\xe2\x88\x921,m\xe2\x88\x921) to carry out an earthquake rescue operation (to the bottom rightmost cell). The earthquake doesn\'t change the position of the robot, they only change the position of rocks in the world.Let RT\'s current position be (x,y) (0\xe2\x89\xa4x<n,0\xe2\x89\xa4y<m), it can perform the following operations:   Go one cell cyclically upwards, i.e. from (x,y) to ((x+n\xe2\x88\x921)modn,y) using 1 unit of time.  Go one cell cyclically downwards, i.e. (x,y) to ((x+1)modn,y) using 1 unit of time.  Go one cell to the right, i.e. (x,y) to (x,y+1) using 1 unit of time. (RT may perform this operation only if y<m\xe2\x88\x921.) Note that RT cannot go left using the operations nor can he stay at a position.Unfortunately, RT will explode upon colliding with a rock. As such, when RT is at (x,y) and there is a rock at ((x+1)modn,y) or ((x+2)modn,y), RT cannot move down or it will be hit by the rock.   Similarly, if y+1<m and there is a rock at ((x+1)modn,y+1), RT cannot move right or it will be hit by the rock.  However, it is worth noting that if there is a rock at (xmodn,y+1) and ((x+1)modn,y), RT can still move right safely.  Find the minimum amount of time RT needs to reach (n\xe2\x88\x921,m\xe2\x88\x921) without colliding with any rocks. If it is impossible to do so, output \xe2\x88\x921." 2100.0                                                
1930D2 "Sum over all Substrings (Hard Version)" "bitmasks,divide and conquer,dp,dsu,greedy,implementation,strings" "This is the hard version of the problem. The only difference between the two versions is the constraint on t and n. You can make hacks only if both versions of the problem are solved.For a binary\xe2\x80\xa0 pattern p and a binary string q, both of length m, q is called p-good if for every i (1\xe2\x89\xa4i\xe2\x89\xa4m), there exist indices l and r such that:   1\xe2\x89\xa4l\xe2\x89\xa4i\xe2\x89\xa4r\xe2\x89\xa4m, and  pi is a mode\xe2\x80\xa1 of the string qlql+1\xe2\x80\xa6qr. For a pattern p, let f(p) be the minimum possible number of 1s in a p-good binary string (of the same length as the pattern).You are given a binary string s of size n. Find n\xe2\x88\x91i=1n\xe2\x88\x91j=if(sisi+1\xe2\x80\xa6sj). In other words, you need to sum the values of f over all n(n+1)2 substrings of s.\xe2\x80\xa0 A binary pattern is a string that only consists of characters 0 and 1.\xe2\x80\xa1 Character c is a mode of string t of length m if the number of occurrences of c in t is at least \xe2\x8c\x88m2\xe2\x8c\x89. For example, 0 is a mode of 010, 1 is not a mode of 010, and both 0 and 1 are modes of 011010." 2100.0                                                
1929F "Sasha and the Wedding Binary Search Tree" "brute force,combinatorics,data structures,dfs and similar,math,trees" "Having overcome all the difficulties and hardships, Sasha finally decided to marry his girlfriend. To do this, he needs to give her an engagement ring. However, his girlfriend does not like such romantic gestures, but she does like binary search trees\xe2\x80\xa0. So Sasha decided to give her such a tree.After spending a lot of time on wedding websites for programmers, he found the perfect binary search tree with the root at vertex 1. In this tree, the value at vertex v is equal to valv.But after some time, he forgot the values in some vertices. Trying to remember the found tree, Sasha wondered \xe2\x80\x94 how many binary search trees could he have found on the website, if it is known that the values in all vertices are integers in the segment [1,C]. Since this number can be very large, output it modulo 998244353.\xe2\x80\xa0A binary search tree is a rooted binary tree in which for any vertex x, the following property holds: the values of all vertices in the left subtree of vertex x (if it exists) are less than or equal to the value at vertex x, and the values of all vertices in the right subtree of vertex x (if it exists) are greater than or equal to the value at vertex x." 2300.0                                                
1929C "Sasha and the Casino" "binary search,brute force,constructive algorithms,games,greedy,math" "Sasha decided to give his girlfriend the best handbag, but unfortunately for Sasha, it is very expensive. Therefore, Sasha wants to earn it. After looking at earning tips on the internet, he decided to go to the casino.Sasha knows that the casino operates under the following rules. If Sasha places a bet of y coins (where y is a positive integer), then in case of winning, he will receive y\xe2\x8b\x85k coins (i.e., his number of coins will increase by y\xe2\x8b\x85(k\xe2\x88\x921)). And in case of losing, he will lose the entire bet amount (i.e., his number of coins will decrease by y).Note that the bet amount must always be a positive (>0) integer and cannot exceed Sasha\'s current number of coins.Sasha also knows that there is a promotion at the casino: he cannot lose more than x times in a row.Initially, Sasha has a coins. He wonders whether he can place bets such that he is guaranteed to win any number of coins. In other words, is it true that for any integer n, Sasha can make bets so that for any outcome that does not contradict the rules described above, at some moment of time he will have at least n coins." 1400.0                                                
1927F Microcycle "data structures,dfs and similar,dsu,graphs,greedy,implementation,sortings,trees" "Given an undirected weighted graph with n vertices and m edges. There is at most one edge between each pair of vertices in the graph, and the graph does not contain loops (edges from a vertex to itself). The graph is not necessarily connected.A cycle in the graph is called simple if it doesn\'t pass through the same vertex twice and doesn\'t contain the same edge twice.Find any simple cycle in this graph in which the weight of the lightest edge is minimal." 1900.0                                                
1927C "Choose the Different Ones!" "brute force,greedy,math" "Given an array a of n integers, an array b of m integers, and an even number k.Your task is to determine whether it is possible to choose exactly k2 elements from both arrays in such a way that among the chosen elements, every integer from 1 to k is included.For example:  If a=[2,3,8,5,6,5], b=[1,3,4,10,5], k=6, then it is possible to choose elements with values 2,3,6 from array a and elements with values 1,4,5 from array b. In this case, all numbers from 1 to k=6 will be included among the chosen elements. If a=[2,3,4,5,6,5], b=[1,3,8,10,3], k=6, then it is not possible to choose elements in the required way. Note that you are not required to find a way to choose the elements \xe2\x80\x94 your program should only check whether it is possible to choose the elements in the required way." 1000.0                                                
1927A "Make it White" greedy,strings "You have a horizontal strip of n cells. Each cell is either white or black.You can choose a continuous segment of cells once and paint them all white. After this action, all the black cells in this segment will become white, and the white ones will remain white.What is the minimum length of the segment that needs to be painted white in order for all n cells to become white?" 800.0                                                
1926F "Vlad and Avoiding X" "bitmasks,brute force,dfs and similar,dp,implementation" "Vladislav has a grid of size 7\xc3\x977, where each cell is colored black or white. In one operation, he can choose any cell and change its color (black \xe2\x86\x94 white).Find the minimum number of operations required to ensure that there are no black cells with four diagonal neighbors also being black. The left image shows that initially there are two black cells violating the condition. By flipping one cell, the grid will work." 2200.0                                                
1923E "Count Paths" "data structures,dfs and similar,dp,dsu,graphs,trees" "You are given a tree, consisting of n vertices, numbered from 1 to n. Every vertex is colored in some color, denoted by an integer from 1 to n.A simple path of the tree is called beautiful if:   it consists of at least 2 vertices;  the first and the last vertices of the path have the same color;  no other vertex on the path has the same color as the first vertex. Count the number of the beautiful simple paths of the tree. Note that paths are considered undirected (i. e. the path from x to y is the same as the path from y to x)." 2000.0                                                
1922F "Replace on Segment" "dp,graph matchings" "You are given an array a1,a2,\xe2\x80\xa6,an, where each element is an integer from 1 to x.You can perform the following operation with it any number of times:  choose three integers l, r and k such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4k\xe2\x89\xa4x and each element ai such that l\xe2\x89\xa4i\xe2\x89\xa4r is different from k. Then, for each i\xe2\x88\x88[l,r], replace ai with k. In other words, you choose a subsegment of the array and an integer from 1 to x which does not appear in that subsegment, and replace every element in the subsegment with that chosen integer.Your goal is to make all elements in the array equal. What is the minimum number of operations that you have to perform?" 2500.0                                                
1921F "Sum of Progression" "brute force,data structures,dp,implementation,math" "You are given an array a of n numbers. There are also q queries of the form s,d,k.For each query q, find the sum of elements as+as+d\xe2\x8b\x852+\xe2\x8b\xaf+as+d\xe2\x8b\x85(k\xe2\x88\x921)\xe2\x8b\x85k. In other words, for each query, it is necessary to find the sum of k elements of the array with indices starting from the s-th, taking steps of size d, multiplying it by the serial number of the element in the resulting sequence." 1900.0                                                
1921D "Very Different Array" "data structures,greedy,sortings,two pointers" "Petya has an array ai of n integers. His brother Vasya became envious and decided to make his own array of n integers.To do this, he found m integers bi (m\xe2\x89\xa5n), and now he wants to choose some n integers of them and arrange them in a certain order to obtain an array ci of length n.To avoid being similar to his brother, Vasya wants to make his array as different as possible from Petya\'s array. Specifically, he wants the total difference D=\xe2\x88\x91ni=1|ai\xe2\x88\x92ci| to be as large as possible.Help Vasya find the maximum difference D he can obtain." 1100.0                                                
1920F2 "Smooth Sailing (Hard Version)" "binary search,data structures,dsu,geometry,graphs,trees" "The only difference between the two versions of this problem is the constraint on q. You can make hacks only if both versions of the problem are solved.Thomas is sailing around an island surrounded by the ocean. The ocean and island can be represented by a grid with n rows and m columns. The rows are numbered from 1 to n from top to bottom, and the columns are numbered from 1 to m from left to right. The position of a cell at row r and column c can be represented as (r,c). Below is an example of a valid grid.  Example of a valid grid There are three types of cells: island, ocean and underwater volcano. Cells representing the island are marked with a \'#\', cells representing the ocean are marked with a \'.\', and cells representing an underwater volcano are marked with a \'v\'. It is guaranteed that there is at least one island cell and at least one underwater volcano cell. It is also guaranteed that the set of all island cells forms a single connected component\xe2\x80\xa0 and the set of all ocean cells and underwater volcano cells forms a single connected component. Additionally, it is guaranteed that there are no island cells at the edge of the grid (that is, at row 1, at row n, at column 1, and at column m).Define a round trip starting from cell (x,y) as a path Thomas takes which satisfies the following conditions:  The path starts and ends at (x,y).  If Thomas is at cell (i,j), he can go to cells (i+1,j), (i\xe2\x88\x921,j), (i,j\xe2\x88\x921), and (i,j+1) as long as the destination cell is an ocean cell or an underwater volcano cell and is still inside the grid. Note that it is allowed for Thomas to visit the same cell multiple times in the same round trip.  The path must go around the island and fully encircle it. Some path p fully encircles the island if it is impossible to go from an island cell to a cell on the grid border by only traveling to adjacent on a side or diagonal cells without visiting a cell on path p. In the image below, the path starting from (2,2), going to (1,3), and going back to (2,2) the other way does not fully encircle the island and is not considered a round trip.   Example of a path that does not fully encircle the island The safety of a round trip is the minimum Manhattan distance\xe2\x80\xa1 from a cell on the round trip to an underwater volcano (note that the presence of island cells does not impact this distance).You have q queries. A query can be represented as (x,y) and for every query, you want to find the maximum safety of a round trip starting from (x,y). It is guaranteed that (x,y) is an ocean cell or an underwater volcano cell.\xe2\x80\xa0A set of cells forms a single connected component if from any cell of this set it is possible to reach any other cell of this set by moving only through the cells of this set, each time going to a cell with a common side.\xe2\x80\xa1Manhattan distance between cells (r1,c1) and (r2,c2) is equal to |r1\xe2\x88\x92r2|+|c1\xe2\x88\x92c2|." 3000.0                                                
1920D "Array Repetition" "binary search,brute force,dsu,implementation,math" "Jayden has an array a which is initially empty. There are n operations of two types he must perform in the given order.  Jayden appends an integer x (1\xe2\x89\xa4x\xe2\x89\xa4n) to the end of array a.  Jayden appends x copies of array a to the end of array a. In other words, array a becomes [a,a,\xe2\x80\xa6,a\xe2\x8f\x9fx]. It is guaranteed that he has done at least one operation of the first type before this. Jayden has q queries. For each query, you must tell him the k-th element of array a. The elements of the array are numbered from 1." 1900.0                                                
1919E "Counting Prefixes" "combinatorics,constructive algorithms,dp,implementation,math" "There is a hidden array a of size n consisting of only 1 and \xe2\x88\x921. Let p be the prefix sums of array a. More formally, p is an array of length n defined as pi=a1+a2+\xe2\x80\xa6+ai. Afterwards, array p is sorted in non-decreasing order. For example, if a=[1,\xe2\x88\x921,\xe2\x88\x921,1,1], then p=[1,0,\xe2\x88\x921,0,1] before sorting and p=[\xe2\x88\x921,0,0,1,1] after sorting.You are given the prefix sum array p after sorting, but you do not know what array a is. Your task is to count the number of initial arrays a such that the above process results in the given sorted prefix sum array p. As this number can be large, you are only required to find it modulo 998244353." 2600.0                                                
1918B "Minimize Inversions" "constructive algorithms,data structures,greedy,implementation,sortings" "You are given two permutations a and b of length n. A permutation is an array of n elements from 1 to n where all elements are distinct. For example, an array [2,1,3] is a permutation, but [0,1] and [1,3,1] aren\'t.You can (as many times as you want) choose two indices i and j, then swap ai with aj and bi with bj simultaneously. You hate inversions, so you want to minimize the total number of inversions in both permutations.An inversion in a permutation p is a pair of indices (i,j) such that i<j and pi>pj. For example, if p=[3,1,4,2,5] then there are 3 inversions in it (the pairs of indices are (1,2), (1,4) and (3,4))." 900.0                                                
1916H2 "Matrix Rank (Hard Version)" "combinatorics,dp,math,matrices,string suffix structures" "This is the hard version of the problem. The only differences between the two versions of this problem are the constraints on k. You can make hacks only if all versions of the problem are solved.You are given integers n, p and k. p is guaranteed to be a prime number. For each r from 0 to k, find the number of n\xc3\x97n matrices A of the field\xe2\x80\xa0 of integers modulo p such that the rank\xe2\x80\xa1 of A is exactly r. Since these values are big, you are only required to output them modulo 998244353.\xe2\x80\xa0 https://en.wikipedia.org/wiki/Field_(mathematics)\xe2\x80\xa1 https://en.wikipedia.org/wiki/Rank_(linear_algebra)" 2700.0                                                
1916D "Mathematical Problem" "brute force,constructive algorithms,geometry,math" "The mathematicians of the 31st lyceum were given the following task:You are given an odd number n, and you need to find n different numbers that are squares of integers. But it\'s not that simple. Each number should have a length of n (and should not have leading zeros), and the multiset of digits of all the numbers should be the same. For example, for 234 and 432, and 11223 and 32211, the multisets of digits are the same, but for 123 and 112233, they are not.The mathematicians couldn\'t solve this problem. Can you?" 1700.0                                                
1916C "Training Before the Olympiad" "constructive algorithms,games,greedy,implementation,math" "Masha and Olya have an important team olympiad coming up soon. In honor of this, Masha, for warm-up, suggested playing a game with Olya:There is an array a of size n. Masha goes first, and the players take turns. Each move is described by the following sequence of actions:\xe2\x88\x99 If the size of the array is 1, the game ends.\xe2\x88\x99 The player who is currently playing chooses two different indices i, j (1\xe2\x89\xa4i,j\xe2\x89\xa4|a|), and performs the following operation \xe2\x80\x94 removes ai and aj from the array and adds to the array a number equal to \xe2\x8c\x8aai+aj2\xe2\x8c\x8b\xe2\x8b\x852. In other words, first divides the sum of the numbers ai, aj by 2 rounding down, and then multiplies the result by 2.Masha aims to maximize the final number, while Olya aims to minimize it.Masha and Olya decided to play on each non-empty prefix of the initial array a, and asked for your help.For each k=1,2,\xe2\x80\xa6,n, answer the following question. Let only the first k elements of the array a be present in the game, with indices 1,2,\xe2\x80\xa6,k respectively. What number will remain at the end with optimal play by both players?" 1200.0                                                
1915G Bicycles "graphs,greedy,implementation,shortest paths,sortings" "All of Slavic\'s friends are planning to travel from the place where they live to a party using their bikes. And they all have a bike except Slavic. There are n cities through which they can travel. They all live in the city 1 and want to go to the party located in the city n. The map of cities can be seen as an undirected graph with n nodes and m edges. Edge i connects cities ui and vi and has a length of wi.Slavic doesn\'t have a bike, but what he has is money. Every city has exactly one bike for sale. The bike in the i-th city has a slowness factor of si. Once Slavic buys a bike, he can use it whenever to travel from the city he is currently in to any neighboring city, by taking wi\xe2\x8b\x85sj time, considering he is traversing edge i using a bike j he owns.Slavic can buy as many bikes as he wants as money isn\'t a problem for him. Since Slavic hates traveling by bike, he wants to get from his place to the party in the shortest amount of time possible. And, since his informatics skills are quite rusty, he asks you for help.What\'s the shortest amount of time required for Slavic to travel from city 1 to city n? Slavic can\'t travel without a bike. It is guaranteed that it is possible for Slavic to travel from city 1 to any other city." 1800.0                                                
1914G2 "Light Bulbs (Hard Version)" "combinatorics,data structures,dfs and similar,dp,graphs,hashing" "The easy and hard versions of this problem differ only in the constraints on n. In the hard version, the sum of values of n over all test cases does not exceed 2\xe2\x8b\x85105. Furthermore, there are no additional constraints on the value of n in a single test case.There are 2n light bulbs arranged in a row. Each light bulb has a color from 1 to n (exactly two light bulbs for each color).Initially, all light bulbs are turned off. You choose a set of light bulbs S that you initially turn on. After that, you can perform the following operations in any order any number of times:  choose two light bulbs i and j of the same color, exactly one of which is on, and turn on the second one;  choose three light bulbs i,j,k, such that both light bulbs i and k are on and have the same color, and the light bulb j is between them (i<j<k), and turn on the light bulb j. You want to choose a set of light bulbs S that you initially turn on in such a way that by performing the described operations, you can ensure that all light bulbs are turned on.Calculate two numbers:  the minimum size of the set S that you initially turn on;  the number of sets S of minimum size (taken modulo 998244353)." 2300.0                                                
1914F "Programming Competition" "dfs and similar,dp,graph matchings,greedy,trees" "BerSoft is the biggest IT corporation in Berland. There are n employees at BerSoft company, numbered from 1 to n. The first employee is the head of the company, and he does not have any superiors. Every other employee i has exactly one direct superior pi.Employee x is considered to be a superior (direct or indirect) of employee y if one of the following conditions holds:   employee x is the direct superior of employee y;  employee x is a superior of the direct superior of employee y. The structure of BerSoft is organized in such a way that the head of the company is superior of every employee.A programming competition is going to be held soon. Two-person teams should be created for this purpose. However, if one employee in a team is the superior of another, they are uncomfortable together. So, teams of two people should be created so that no one is the superior of the other. Note that no employee can participate in more than one team.Your task is to calculate the maximum possible number of teams according to the aforementioned rules." 1900.0                                                
1914B "Preparing for the Contest" "constructive algorithms,math" "Monocarp is practicing for a big contest. He plans to solve n problems to make sure he\'s prepared. Each of these problems has a difficulty level: the first problem has a difficulty level of 1, the second problem has a difficulty level of 2, and so on, until the last (n-th) problem, which has a difficulty level of n.Monocarp will choose some order in which he is going to solve all n problems. Whenever he solves a problem which is more difficult than the last problem he solved, he gets excited because he feels like he\'s progressing. He doesn\'t get excited when he solves the first problem in his chosen order.For example, if Monocarp solves the problems in the order [3,5_,4,1,6_,2], he gets excited twice (the corresponding problems are underlined).Monocarp wants to get excited exactly k times during his practicing session. Help him to choose the order in which he has to solve the problems!" 800.0                                                
1913A "Rating Increase" implementation "Monocarp is a great solver of adhoc problems. Recently, he participated in an Educational Codeforces Round, and gained rating!Monocarp knew that, before the round, his rating was a. After the round, it increased to b (b>a). He wrote both values one after another to not forget them.However, he wrote them so close to each other, that he can\'t tell now where the first value ends and the second value starts.Please, help him find some values a and b such that:   neither of them has a leading zero;  both of them are strictly greater than 0;  b>a;  they produce the given value ab when written one after another. If there are multiple answers, you can print any of them." 800.0                                                
1910C "Poisonous Swamp" "*special problem,*special problem,implementation,implementation" "The first location in the brand new critically acclaimed fantasy action RPG ""Ancient Staff"" is a poisonous swamp. The swamp has some lily pads growing in it. It can be represented as a 2\xc3\x97n grid (2 rows and n columns), where each cell is either empty or has a lily pad in it.There are exactly n lily pads in a swamp \xe2\x80\x94 one in each column. A frog is sitting on top of every lily pad. In one move, every frog must jump to an adjacent by a side cell.After the move, no frog can be outside the grid and no two frogs can share the same lily pad. Two frogs from adjacent cells can\'t jump towards each other (i.e. swap cells).If a frog jumps to a lily pad, it survives. Otherwise, it falls into a poisonous swamp and gets devoured by an eldritch creature living on its bottom.You can choose the direction each frogs jumps at. Determine the maximum number of frogs that can survive after one move." 1600.0                                                
1907G Lights "brute force,constructive algorithms,dfs and similar,graphs,greedy,implementation" "In the end of the day, Anna needs to turn off the lights in the office. There are n lights and n light switches, but their operation scheme is really strange. The switch i changes the state of light i, but it also changes the state of some other light ai (change the state means that if the light was on, it goes off and vice versa).Help Anna to turn all the lights off using minimal number of switches, or say it is impossible." 2200.0                                                
1907D "Jumping Through Segments" "binary search,constructive algorithms" "Polycarp is designing a level for a game. The level consists of n segments on the number line, where the i-th segment starts at the point with coordinate li and ends at the point with coordinate ri.The player starts the level at the point with coordinate 0. In one move, they can move to any point that is within a distance of no more than k. After their i-th move, the player must land within the i-th segment, that is, at a coordinate x such that li\xe2\x89\xa4x\xe2\x89\xa4ri. This means:  After the first move, they must be inside the first segment (from l1 to r1);  After the second move, they must be inside the second segment (from l2 to r2);  ...  After the n-th move, they must be inside the n-th segment (from ln to rn). The level is considered completed if the player reaches the n-th segment, following the rules described above. After some thought, Polycarp realized that it is impossible to complete the level with some values of k.Polycarp does not want the level to be too easy, so he asks you to determine the minimum integer k with which it is possible to complete the level." 1400.0                                                
1906G "Grid Game 2" "games,number theory" "You are playing ""Grid Game 2"" with your friend. There is a grid with 109 rows (numbered from 1 to 109) and 109 columns (numbered from 1 to 109). The cell at row r and column c is denoted as (r,c).Each cell can have a colour of either black or white. Initially, there are exactly N black cells (numbered from 1 to N). Black cell i is located at (Ri,Ci). The rest of the cells are white.You and your friend will alternately take turn playing on this grid, and you are playing in the first turn. In one turn, a player will choose a black cell (r,c), then toggle cells (r\xe2\x88\x92x,c\xe2\x88\x92y) for all 0\xe2\x89\xa4x,y<min(r,c). If a cell is toggled, then the cell becomes black if it was a white cell, and the cell becomes white if it was a black cell.For example, the following illustration shows how the grid changes after a player chooses a black cell (5,4) in their turn.  A player who is unable to play on their turn, i.e. no remaining black cells, loses the game, and the opposing player wins the game. If you and your friend are playing optimally, determine who will win the game." 2900.0                                                
1906E "Merge Not Sort" "constructive algorithms,dp" "You are currently researching the Merge Sort algorithm. Merge Sort is a sorting algorithm that is based on the principle of Divide and Conquer. It works by dividing an array into two subarrays of equal length, sorting each subarrays, then merging the sorted subarrays back together to form the final sorted array.You are particularly interested in the merging routine. Common merge implementation will combine two subarrays by iteratively comparing their first elements, and move the smaller one to a new merged array. More precisely, the merge algorithm can be presented by the following pseudocode.    Merge(A[1..N], B[1..N]):        C = []        i = 1        j = 1        while i <= N AND j <= N:            if A[i] < B[j]:                append A[i] to C                i = i + 1            else:                append B[j] to C                j = j + 1         while i <= N:            append A[i] to C            i = i + 1         while j <= N:            append B[j] to C            j = j + 1         return CDuring your research, you are keen to understand the behaviour of the merge algorithm when arrays A and B are not necessarily sorted. For example, if A=[3,1,6] and B=[4,5,2], then Merge(A,B)=[3,1,4,5,2,6].To further increase the understanding of the merge algorithm, you decided to work on the following problem. You are given an array C of length 2\xe2\x8b\x85N such that it is a permutation of 1 to 2\xe2\x8b\x85N. Construct any two arrays A and B of the same length N, such that Merge(A,B)=C, or determine if it is impossible to do so." 1900.0                                                
1904A Forked! "brute force,implementation" "Lunchbox is done with playing chess! His queen and king just got forked again!In chess, a fork is when a knight attacks two pieces of higher value, commonly the king and the queen. Lunchbox knows that knights can be tricky, and in the version of chess that he is playing, knights are even trickier: instead of moving 1 tile in one direction and 2 tiles in the other, knights in Lunchbox\'s modified game move a tiles in one direction and b tiles in the other.Lunchbox is playing chess on an infinite chessboard which contains all cells (x,y) where x and y are (possibly negative) integers. Lunchbox\'s king and queen are placed on cells (xK,yK) and (xQ,yQ) respectively. Find the number of positions such that if a knight was placed on that cell, it would attack both the king and queen." 900.0                                                
1896D "Ones and Twos" "binary search,data structures,divide and conquer,math,two pointers" "You are given a 1-indexed array a of length n where each element is 1 or 2.Process q queries of the following two types:   ""1 s"": check if there exists a subarray\xe2\x80\xa0 of a whose sum equals to s.  ""2 i v"": change ai to v. \xe2\x80\xa0 An array b is a subarray of an array a if b can be obtained from a by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end. In particular, an array is a subarray of itself." 1700.0                                                
1896B "AB Flipping" "greedy,strings,two pointers" "You are given a string s of length n consisting of characters A and B. You are allowed to do the following operation:  Choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 such that si=A and si+1=B. Then, swap si and si+1. You are only allowed to do the operation at most once for each index 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. However, you can do it in any order you want. Find the maximum number of operations that you can carry out." 900.0                                                
1895A "Treasure Chest" math "Monocarp has found a treasure map. The map represents the treasure location as an OX axis. Monocarp is at 0, the treasure chest is at x, the key to the chest is at y.Obviously, Monocarp wants to open the chest. He can perform the following actions:   go 1 to the left or 1 to the right (spending 1 second);  pick the key or the chest up if he is in the same point as that object (spending 0 seconds);  put the chest down in his current point (spending 0 seconds);  open the chest if he\'s in the same point as the chest and has picked the key up (spending 0 seconds). Monocarp can carry the chest, but the chest is pretty heavy. He knows that he can carry it for at most k seconds in total (putting it down and picking it back up doesn\'t reset his stamina).What\'s the smallest time required for Monocarp to open the chest?" 800.0                                                
1887F "Minimum Segments" "constructive algorithms" "You had a sequence a1,a2,\xe2\x80\xa6,an consisting of integers from 1 to n, not necessarily distinct. For some unknown reason, you decided to calculate the following characteristic of the sequence:   Let ri (1\xe2\x89\xa4i\xe2\x89\xa4n) be the smallest j\xe2\x89\xa5i such that on the subsegment ai,ai+1,\xe2\x80\xa6,aj all distinct numbers from the sequence a appear. More formally, for any k\xe2\x88\x88[1,n], there exists l\xe2\x88\x88[i,j] such that ak=al. If such j does not exist, ri is considered to be equal to n+1.  The characteristic of the sequence a is defined as the sequence r1,r2,\xe2\x80\xa6,rn.  Unfortunately, the sequence a got lost, but you still have its characteristic r. You want to reconstruct any sequence a that matches the characteristic, or determine that there is an error in the characteristic and such a sequence does not exist." 3400.0                                                
1884B "Haunted House" "binary search,greedy,math,two pointers" "You are given a number in binary representation consisting of exactly n bits, possibly, with leading zeroes. For example, for n=5 the number 6 will be given as 00110, and for n=4 the number 9 will be given as 1001.Let\'s fix some integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n. In one operation you can swap any two adjacent bits in the binary representation. Your goal is to find the smallest number of operations you are required to perform to make the number divisible by 2i, or say that it is impossible.Please note that for each 1\xe2\x89\xa4i\xe2\x89\xa4n you are solving the problem independently." 1100.0                                                
1884A "Simple Design" "brute force,greedy,math" "A positive integer is called k-beautiful, if the digit sum of the decimal representation of this number is divisible by k\xe2\x80\xa0. For example, 9272 is 5-beautiful, since the digit sum of 9272 is 9+2+7+2=20.You are given two integers x and k. Please find the smallest integer y\xe2\x89\xa5x which is k-beautiful.\xe2\x80\xa0 An integer n is divisible by k if there exists an integer m such that n=k\xe2\x8b\x85m." 800.0                                                
1881G "Anya and the Mysterious String" "binary search,data structures" "Anya received a string s of length n brought from Rome. The string s consists of lowercase Latin letters and at first glance does not raise any suspicions. An instruction was attached to the string.Start of the instruction.A palindrome is a string that reads the same from left to right and right to left. For example, the strings ""anna"", ""aboba"", ""level"" are palindromes, while the strings ""gorilla"", ""banan"", ""off"" are not.A substring [l\xe2\x80\xa6r] of string s is a string slsl+1\xe2\x80\xa6sr\xe2\x88\x921sr. For example, the substring [4\xe2\x80\xa66] of the string ""generation"" is the string ""era"".A string is called beautiful if it does not contain a substring of length at least two that is a palindrome. For example, the strings ""fox"", ""abcdef"", and ""yioy"" are beautiful, while the strings ""xyxx"", ""yikjkitrb"" are not.When an integer x is added to the character si, it is replaced x times with the next character in the alphabet, with ""z"" being replaced by ""a"".When an integer x is added to the substring [l,r] of string s, it becomes the string s1s2\xe2\x80\xa6sl\xe2\x88\x921(sl+x)(sl+1+x)\xe2\x80\xa6(sr\xe2\x88\x921+x)(sr+x)sr+1\xe2\x80\xa6sn. For example, when the substring [2,4] of the string ""abazaba"" is added with the number 6, the resulting string is ""ahgfaba"".End of the instruction.After reading the instruction, Anya resigned herself to the fact that she has to answer m queries. The queries can be of two types:  Add the number x to the substring [l\xe2\x80\xa6r] of string s.  Determine whether the substring [l\xe2\x80\xa6r] of string s is beautiful." 2000.0                                                
1881B "Three Threadlets" math "Once upon a time, bartender Decim found three threadlets and a pair of scissors.In one operation, Decim chooses any threadlet and cuts it into two threadlets, whose lengths are positive integers and their sum is equal to the length of the threadlet being cut.For example, he can cut a threadlet of length 5 into threadlets of lengths 2 and 3, but he cannot cut it into threadlets of lengths 2.5 and 2.5, or lengths 0 and 5, or lengths 3 and 4.Decim can perform at most three operations. He is allowed to cut the threadlets obtained from previous cuts. Will he be able to make all the threadlets of equal length?" 900.0                                                
1879B "Chips on the Board" "constructive algorithms,greedy" "You are given a board of size n\xc3\x97n (n rows and n colums) and two arrays of positive integers a and b of size n.Your task is to place the chips on this board so that the following condition is satisfied for every cell (i,j):  there exists at least one chip in the same column or in the same row as the cell (i,j). I.\xe2\x80\x89e. there exists a cell (x,y) such that there is a chip in that cell, and either x=i or y=j (or both). The cost of putting a chip in the cell (i,j) is equal to ai+bj. For example, for n=3, a=[1,4,1] and b=[3,2,2]. One of the possible chip placements is as follows:  White squares are empty The total cost of that placement is (1+3)+(1+2)+(1+2)=10.Calculate the minimum possible total cost of putting chips according to the rules above." 900.0                                                
1878B "Aleksa and Stack" "constructive algorithms,math" "After the Serbian Informatics Olympiad, Aleksa was very sad, because he didn\'t win a medal (he didn\'t know stack), so Vasilije came to give him an easy problem, just to make his day better.Vasilije gave Aleksa a positive integer n (n\xe2\x89\xa53) and asked him to construct a strictly increasing array of size n of positive integers, such that   3\xe2\x8b\x85ai+2 is not divisible by ai+ai+1 for each i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922).  Note that a strictly increasing array a of size n is an array where ai<ai+1 for each i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).Since Aleksa thinks he is a bad programmer now, he asked you to help him find such an array." 800.0                                                
1876D Lexichromatography "combinatorics,dfs and similar,dsu,graphs,two pointers" "Pak Chanek loves his faculty, the Faculty of Computer Science, University of Indonesia (Fasilkom). He wants to play with the colours of the faculty\'s logo, blue and red.There is an array a consisting of n elements, element i has a value of ai. Pak Chanek wants to colour each element in the array blue or red such that these following conditions are satisfied:   If all blue elements are formed into a subsequence\xe2\x80\xa0 and so are all the red elements, the blue subsequence is strictly less than the red subsequence lexicographically\xe2\x80\xa1.  Array a does not have any subarray that is imbalanced. A subarray is imbalanced if and only if there is a value k such that the absolute difference between the number of blue elements with value k and the number of red elements with value k in this subarray is 2 or more.  Note that it is possible to colour every element of the array the same colour. How many different colourings satisfy all those conditions? Since the answer can be very big, print the answer modulo 998244353. Two colourings are different if and only if there is at least one element that is blue in one colouring, but red in the other.\xe2\x80\xa0 A subsequence of an array is a sequence that can be obtained from the array by deleting some elements (possibly none), without changing the order of the remaining elements.\xe2\x80\xa1 Let p and q be two different sequences. Sequence p is said to be lexicographically less than sequence q if and only if p is a prefix of q or there is an index i such that pj=qj holds for every 1\xe2\x89\xa4j<i, and pi<qi. In particular, an empty sequence is always lexicographically less than any non-empty sequence." 2500.0                                                
1876B "Effects of Anti Pimples" "combinatorics,number theory,sortings" "Chaneka has an array [a1,a2,\xe2\x80\xa6,an]. Initially, all elements are white. Chaneka will choose one or more different indices and colour the elements at those chosen indices black. Then, she will choose all white elements whose indices are multiples of the index of at least one black element and colour those elements green. After that, her score is the maximum value of ai out of all black and green elements.There are 2n\xe2\x88\x921 ways for Chaneka to choose the black indices. Find the sum of scores for all possible ways Chaneka can choose the black indices. Since the answer can be very big, print the answer modulo 998244353." 1500.0                                                
1874A "Jellyfish and Game" "brute force,games,greedy,implementation" "Jellyfish has n green apples with values a1,a2,\xe2\x80\xa6,an and Gellyfish has m green apples with values b1,b2,\xe2\x80\xa6,bm.They will play a game with k rounds. For i=1,2,\xe2\x80\xa6,k in this order, they will perform the following actions:   If i is odd, Jellyfish can choose to swap one of her apples with one of Gellyfish\'s apples or do nothing.  If i is even, Gellyfish can choose to swap one of his apples with one of Jellyfish\'s apples or do nothing. Both players want to maximize the sum of the values of their apples.Since you are one of the smartest people in the world, Jellyfish wants you to tell her the final sum of the value of her apples after all k rounds of the game. Assume that both Jellyfish and Gellyfish play optimally to maximize the sum of values of their apples." 1200.0                                                
     1704G "Mio and Lucky Array" "constructive algorithms,fft,math,strings" "Mio has an array a consisting of n integers, and an array b consisting of m integers. Mio can do the following operation to a:  Choose an integer i (1\xe2\x89\xa4i\xe2\x89\xa4n) that has not been chosen before, then add 1 to ai, subtract 2 from ai+1, add 3 to ai+2 an so on. Formally, the operation is to add (\xe2\x88\x921)j\xe2\x88\x92i\xe2\x8b\x85(j\xe2\x88\x92i+1) to aj for i\xe2\x89\xa4j\xe2\x89\xa4n.Mio wants to transform a so that it will contain b as a subarray. Could you answer her question, and provide a sequence of operations to do so, if it is possible?An array b is a subarray of an array a if b can be obtained from a by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 3500.0                                           
     1703G "Good Key, Bad Key" "bitmasks,brute force,dp,greedy,math" "There are n chests. The i-th chest contains ai coins. You need to open all n chests in order from chest 1 to chest n.There are two types of keys you can use to open a chest:   a good key, which costs k coins to use;  a bad key, which does not cost any coins, but will halve all the coins in each unopened chest, including the chest it is about to open. The halving operation will round down to the nearest integer for each chest halved. In other words using a bad key to open chest i will do ai=\xe2\x8c\x8aai2\xe2\x8c\x8b, ai+1=\xe2\x8c\x8aai+12\xe2\x8c\x8b,\xe2\x80\xa6,an=\xe2\x8c\x8aan2\xe2\x8c\x8b;  any key (both good and bad) breaks after a usage, that is, it is a one-time use. You need to use in total n keys, one for each chest. Initially, you have no coins and no keys. If you want to use a good key, then you need to buy it.During the process, you are allowed to go into debt; for example, if you have 1 coin, you are allowed to buy a good key worth k=3 coins, and your balance will become \xe2\x88\x922 coins.Find the maximum number of coins you can have after opening all n chests in order from chest 1 to chest n." 1600.0                                           
     1703A "YES or YES?" "brute force,implementation,strings" "There is a string s of length 3, consisting of uppercase and lowercase English letters. Check if it is equal to ""YES"" (without quotes), where each letter can be in any case. For example, ""yES"", ""Yes"", ""yes"" are all allowable." 800.0                                           
     1700E "Serega the Pirate" "brute force,constructive algorithms" "Little pirate Serega robbed a ship with puzzles of different kinds. Among all kinds, he liked only one, the hardest.A puzzle is a table of n rows and m columns, whose cells contain each number from 1 to n\xe2\x8b\x85m exactly once.To solve a puzzle, you have to find a sequence of cells in the table, such that any two consecutive cells are adjacent by the side in the table. The sequence can have arbitrary length and should visit each cell one or more times. For a cell containing the number i, denote the position of the first occurrence of this cell in the sequence as ti. The sequence solves the puzzle, if t1<t2<\xe2\x8b\xaf<tnm. In other words, the cell with number x should be first visited before the cell with number x+1 for each x.Let\'s call a puzzle solvable, if there exists at least one suitable sequence.In one move Serega can choose two arbitrary cells in the table (not necessarily adjacent by the side) and swap their numbers. He would like to know the minimum number of moves to make his puzzle solvable, but he is too impatient. Thus, please tell if the minimum number of moves is 0, 1, or at least 2. In the case, where 1 move is required, please also find the number of suitable cell pairs to swap." 2600.0                                           
     1698G "Long Binary String" "bitmasks,math,matrices,meet-in-the-middle,number theory" "There is a binary string t of length 10100, and initally all of its bits are 0. You are given a binary string s, and perform the following operation some times:   Select some substring of t, and replace it with its XOR with s.\xe2\x80\xa0  After several operations, the string t has exactly two bits 1; that is, there are exactly two distinct indices p and q such that the p-th and q-th bits of t are 1, and the rest of the bits are 0. Find the lexicographically largest\xe2\x80\xa1 string t satisfying these constraints, or report that no such string exists.\xe2\x80\xa0 Formally, choose an index i such that 0\xe2\x89\xa4i\xe2\x89\xa410100\xe2\x88\x92|s|. For all 1\xe2\x89\xa4j\xe2\x89\xa4|s|, if sj=1, then toggle ti+j. That is, if ti+j=0, set ti+j=1. Otherwise if ti+j=1, set ti+j=0.\xe2\x80\xa1 A binary string a is lexicographically larger than a binary string b of the same length if in the first position where a and b differ, the string a has a bit 1 and the corresponding bit in b is 0." 2900.0                                           
     1696F "Tree Recovery" "brute force,constructive algorithms,dfs and similar,dsu,graphs,trees" "Fishingprince loves trees. A tree is a connected undirected graph without cycles.Fishingprince has a tree of n vertices. The vertices are numbered 1 through n. Let d(x,y) denote the shortest distance on the tree from vertex x to vertex y, assuming that the length of each edge is 1.However, the tree was lost in an accident. Fortunately, Fishingprince still remembers some information about the tree. More specifically, for every triple of integers x,y,z (1\xe2\x89\xa4x<y\xe2\x89\xa4n, 1\xe2\x89\xa4z\xe2\x89\xa4n) he remembers whether d(x,z)=d(y,z) or not.Help him recover the structure of the tree, or report that no tree satisfying the constraints exists." 2600.0                                           
     1693C "Keshi in Search of AmShZ" "graphs,greedy,shortest paths" "AmShZ has traveled to Italy from Iran for the Thom Yorke concert. There are n cities in Italy indexed from 1 to n and m directed roads indexed from 1 to m. Initially, Keshi is located in the city 1 and wants to go to AmShZ\'s house in the city n. Since Keshi doesn\'t know the map of Italy, AmShZ helps him to see each other as soon as possible.In the beginning of each day, AmShZ can send one of the following two messages to Keshi: AmShZ sends the index of one road to Keshi as a blocked road. Then Keshi will understand that he should never use that road and he will remain in his current city for the day. AmShZ tells Keshi to move. Then, Keshi will randomly choose one of the cities reachable from his current city and move there. (city B is reachable from city A if there\'s an out-going road from city A to city B which hasn\'t become blocked yet). If there are no such cities, Keshi will remain in his current city.Note that AmShZ always knows Keshi\'s current location. AmShZ and Keshi want to find the smallest possible integer d for which they can make sure that they will see each other after at most d days. Help them find d." 2300.0                                           
     1691E "Number of Groups" "data structures,dfs and similar,dsu,graphs,greedy,sortings" "You are given n colored segments on the number line. Each segment is either colored red or blue. The i-th segment can be represented by a tuple (ci,li,ri). The segment contains all the points in the range [li,ri], inclusive, and its color denoted by ci:   if ci=0, it is a red segment;  if ci=1, it is a blue segment. We say that two segments of different colors are connected, if they share at least one common point. Two segments belong to the same group, if they are either connected directly, or through a sequence of directly connected segments. Find the number of groups of segments." 2300.0                                           
     1690E "Price Maximization" "binary search,greedy,math,two pointers" "A batch of n goods (n \xe2\x80\x94 an even number) is brought to the store, i-th of which has weight ai. Before selling the goods, they must be packed into packages. After packing, the following will be done:   There will be n2 packages, each package contains exactly two goods;  The weight of the package that contains goods with indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) is ai+aj. With this, the cost of a package of weight x is always \xe2\x8c\x8axk\xe2\x8c\x8b burles (rounded down), where k \xe2\x80\x94 a fixed and given value.Pack the goods to the packages so that the revenue from their sale is maximized. In other words, make such n2 pairs of given goods that the sum of the values \xe2\x8c\x8axik\xe2\x8c\x8b, where xi is the weight of the package number i (1\xe2\x89\xa4i\xe2\x89\xa4n2), is maximal.For example, let n=6,k=3, weights of goods a=[3,2,7,1,4,8]. Let\'s pack them into the following packages.   In the first package we will put the third and sixth goods. Its weight will be a3+a6=7+8=15. The cost of the package will be \xe2\x8c\x8a153\xe2\x8c\x8b=5 burles.  In the second package put the first and fifth goods, the weight is a1+a5=3+4=7. The cost of the package is \xe2\x8c\x8a73\xe2\x8c\x8b=2 burles.  In the third package put the second and fourth goods, the weight is a2+a4=2+1=3. The cost of the package is \xe2\x8c\x8a33\xe2\x8c\x8b=1 burle. With this packing, the total cost of all packs would be 5+2+1=8 burles." 1500.0                                           
     1689D "Lena and Matrix" "data structures,dp,geometry,shortest paths" "Lena is a beautiful girl who likes logical puzzles.As a gift for her birthday, Lena got a matrix puzzle!The matrix consists of n rows and m columns, and each cell is either black or white. The coordinates (i,j) denote the cell which belongs to the i-th row and j-th column for every 1\xe2\x89\xa4i\xe2\x89\xa4n and 1\xe2\x89\xa4j\xe2\x89\xa4m. To solve the puzzle, Lena has to choose a cell that minimizes the Manhattan distance to the farthest black cell from the chosen cell.More formally, let there be k\xe2\x89\xa51 black cells in the matrix with coordinates (xi,yi) for every 1\xe2\x89\xa4i\xe2\x89\xa4k. Lena should choose a cell (a,b) that minimizes kmaxi=1(|a\xe2\x88\x92xi|+|b\xe2\x88\x92yi|).As Lena has no skill, she asked you for help. Will you tell her the optimal cell to choose?" 1900.0                                           
     1688C "Manipulating History" "constructive algorithms,greedy,strings" "As a human, she can erase history of its entirety. As a Bai Ze (Hakutaku), she can create history out of nothingness.\xe2\x80\x94Perfect Memento in Strict SenseKeine has the ability to manipulate history. The history of Gensokyo is a string s of length 1 initially. To fix the chaos caused by Yukari, she needs to do the following operations n times, for the i-th time:  She chooses a non-empty substring t2i\xe2\x88\x921 of s. She replaces t2i\xe2\x88\x921 with a non-empty string, t2i. Note that the lengths of strings t2i\xe2\x88\x921 and t2i can be different.Note that if t2i\xe2\x88\x921 occurs more than once in s, exactly one of them will be replaced.For example, let s=""marisa"", t2i\xe2\x88\x921=""a"", and t2i=""z"". After the operation, s becomes ""mzrisa"" or ""marisz"".After n operations, Keine got the final string and an operation sequence t of length 2n. Just as Keine thinks she has finished, Yukari appears again and shuffles the order of t. Worse still, Keine forgets the initial history. Help Keine find the initial history of Gensokyo!Recall that a substring is a sequence of consecutive characters of the string. For example, for string ""abc"" its substrings are: ""ab"", ""c"", ""bc"" and some others. But the following strings are not its substring: ""ac"", ""cba"", ""acb"".HacksYou cannot make hacks in this problem." 1700.0                                           
     1684H "Hard Cut" "constructive algorithms,dfs and similar,divide and conquer,math" "You are given a binary string s. You have to cut it into any number of non-intersecting substrings, so that the sum of binary integers denoted by these substrings is a power of 2. Each element of s should be in exactly one substring." 3400.0                                           
     1682C "LIS or Reverse LIS?" "constructive algorithms,greedy,implementation,math" "You are given an array a of n positive integers. Let LIS(a) denote the length of longest strictly increasing subsequence of a. For example,  LIS([2,1_,1,3_]) = 2.  LIS([3_,5_,10_,20_]) = 4.  LIS([3,1_,2_,4_]) = 3.  We define array a\xe2\x80\xb2 as the array obtained after reversing the array a i.e. a\xe2\x80\xb2=[an,an\xe2\x88\x921,\xe2\x80\xa6,a1].The beauty of array a is defined as min(LIS(a),LIS(a\xe2\x80\xb2)).Your task is to determine the maximum possible beauty of the array a if you can rearrange the array a arbitrarily." 1400.0                                           
     1681A "Game with Cards" games,greedy "Alice and Bob play a game. Alice has n cards, the i-th of them has the integer ai written on it. Bob has m cards, the j-th of them has the integer bj written on it.On the first turn of the game, the first player chooses one of his/her cards and puts it on the table (plays it). On the second turn, the second player chooses one of his/her cards such that the integer on it is greater than the integer on the card played on the first turn, and plays it. On the third turn, the first player chooses one of his/her cards such that the integer on it is greater than the integer on the card played on the second turn, and plays it, and so on \xe2\x80\x94 the players take turns, and each player has to choose one of his/her cards with greater integer than the card played by the other player on the last turn.If some player cannot make a turn, he/she loses.For example, if Alice has 4 cards with numbers [10,5,3,8], and Bob has 3 cards with numbers [6,11,6], the game may go as follows:  Alice can choose any of her cards. She chooses the card with integer 5 and plays it.  Bob can choose any of his cards with number greater than 5. He chooses a card with integer 6 and plays it.  Alice can choose any of her cards with number greater than 6. She chooses the card with integer 10 and plays it.  Bob can choose any of his cards with number greater than 10. He chooses a card with integer 11 and plays it.  Alice can choose any of her cards with number greater than 11, but she has no such cards, so she loses. Both Alice and Bob play optimally (if a player is able to win the game no matter how the other player plays, the former player will definitely win the game).You have to answer two questions:  who wins if Alice is the first player?  who wins if Bob is the first player?" 800.0                                           
     1678B1 "Tokitsukaze and Good 01-String (easy version)" implementation "This is the easy version of the problem. The only difference between the two versions is that the harder version asks additionally for a minimum number of subsegments.Tokitsukaze has a binary string s of length n, consisting only of zeros and ones, n is even.Now Tokitsukaze divides s into the minimum number of contiguous subsegments, and for each subsegment, all bits in each subsegment are the same. After that, s is considered good if the lengths of all subsegments are even.For example, if s is ""11001111"", it will be divided into ""11"", ""00"" and ""1111"". Their lengths are 2, 2, 4 respectively, which are all even numbers, so ""11001111"" is good. Another example, if s is ""1110011000"", it will be divided into ""111"", ""00"", ""11"" and ""000"", and their lengths are 3, 2, 2, 3. Obviously, ""1110011000"" is not good.Tokitsukaze wants to make s good by changing the values of some positions in s. Specifically, she can perform the operation any number of times: change the value of si to \'0\' or \'1\'(1\xe2\x89\xa4i\xe2\x89\xa4n). Can you tell her the minimum number of operations to make s good?" 800.0                                           
     1677C "Tokitsukaze and Two Colorful Tapes" "constructive algorithms,dfs and similar,graphs,greedy" "Tokitsukaze has two colorful tapes. There are n distinct colors, numbered 1 through n, and each color appears exactly once on each of the two tapes. Denote the color of the i-th position of the first tape as cai, and the color of the i-th position of the second tape as cbi.Now Tokitsukaze wants to select each color an integer value from 1 to n, distinct for all the colors. After that she will put down the color values in each colored position on the tapes. Denote the number of the i-th position of the first tape as numai, and the number of the i-th position of the second tape as numbi.  For example, for the above picture, assuming that the color red has value x (1\xe2\x89\xa4x\xe2\x89\xa4n), it appears at the 1-st position of the first tape and the 3-rd position of the second tape, so numa1=numb3=x.Note that each color i from 1 to n should have a distinct value, and the same color which appears in both tapes has the same value. After labeling each color, the beauty of the two tapes is calculated as n\xe2\x88\x91i=1|numai\xe2\x88\x92numbi|.Please help Tokitsukaze to find the highest possible beauty." 1900.0                                           
     1676B "Equal Candies" greedy,math,sortings "There are n boxes with different quantities of candies in each of them. The i-th box has ai candies inside.You also have n friends that you want to give the candies to, so you decided to give each friend a box of candies. But, you don\'t want any friends to get upset so you decided to eat some (possibly none) candies from each box so that all boxes have the same quantity of candies in them. Note that you may eat a different number of candies from different boxes and you cannot add candies to any of the boxes.What\'s the minimum total number of candies you have to eat to satisfy the requirements?" 800.0                                           
     1676A Lucky? implementation "A ticket is a string consisting of six digits. A ticket is considered lucky if the sum of the first three digits is equal to the sum of the last three digits. Given a ticket, output if it is lucky or not. Note that a ticket can have leading zeroes." 800.0                                           
     1675D "Vertical Paths" graphs,implementation,trees "You are given a rooted tree consisting of n vertices. Vertices are numbered from 1 to n. Any vertex can be the root of a tree.A tree is a connected undirected graph without cycles. A rooted tree is a tree with a selected vertex, which is called the root.The tree is specified by an array of parents p containing n numbers: pi is a parent of the vertex with the index i. The parent of a vertex u is a vertex that is the next vertex on the shortest path from u to the root. For example, on the simple path from 5 to 3 (the root), the next vertex would be 1, so the parent of 5 is 1.The root has no parent, so for it, the value of pi is i (the root is the only vertex for which pi=i).Find such a set of paths that:  each vertex belongs to exactly one path, each path can contain one or more vertices;  in each path each next vertex \xe2\x80\x94 is a son of the current vertex (that is, paths always lead down \xe2\x80\x94 from parent to son);  number of paths is minimal. For example, if n=5 and p=[3,1,3,3,1], then the tree can be divided into three paths:   3\xe2\x86\x921\xe2\x86\x925 (path of 3 vertices),  4 (path of 1 vertices).  2 (path of 1 vertices).   Example of splitting a root tree into three paths for n=5, the root of the tree \xe2\x80\x94 node 3." 1300.0                                           
     1674G "Remove Directed Edges" "dfs and similar,dp,graphs" "You are given a directed acyclic graph, consisting of n vertices and m edges. The vertices are numbered from 1 to n. There are no multiple edges and self-loops.Let inv be the number of incoming edges (indegree) and outv be the number of outgoing edges (outdegree) of vertex v.You are asked to remove some edges from the graph. Let the new degrees be in\xe2\x80\xb2v and out\xe2\x80\xb2v.You are only allowed to remove the edges if the following conditions hold for every vertex v:   in\xe2\x80\xb2v<inv or in\xe2\x80\xb2v=inv=0;  out\xe2\x80\xb2v<outv or out\xe2\x80\xb2v=outv=0. Let\'s call a set of vertices S cute if for each pair of vertices v and u (v\xe2\x89\xa0u) such that v\xe2\x88\x88S and u\xe2\x88\x88S, there exists a path either from v to u or from u to v over the non-removed edges.What is the maximum possible size of a cute set S after you remove some edges from the graph and both indegrees and outdegrees of all vertices either decrease or remain equal to 0?" 2000.0                                           
     1672A "Log Chopping" games,implementation,math "There are n logs, the i-th log has a length of ai meters. Since chopping logs is tiring work, errorgorn and maomao90 have decided to play a game.errorgorn and maomao90 will take turns chopping the logs with errorgorn chopping first. On his turn, the player will pick a log and chop it into 2 pieces. If the length of the chosen log is x, and the lengths of the resulting pieces are y and z, then y and z have to be positive integers, and x=y+z must hold. For example, you can chop a log of length 3 into logs of lengths 2 and 1, but not into logs of lengths 3 and 0, 2 and 2, or 1.5 and 1.5.The player who is unable to make a chop will be the loser. Assuming that both errorgorn and maomao90 play optimally, who will be the winner?" 800.0                                           
     1670F "Jee, You See?" bitmasks,combinatorics,dp "During their training for the ICPC competitions, team ""Jee You See"" stumbled upon a very basic counting problem. After many ""Wrong answer"" verdicts, they finally decided to give up and destroy turn-off the PC. Now they want your help in up-solving the problem.You are given 4 integers n, l, r, and z. Count the number of arrays a of length n containing non-negative integers such that:  l\xe2\x89\xa4a1+a2+\xe2\x80\xa6+an\xe2\x89\xa4r, and  a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an=z, where \xe2\x8a\x95 denotes the bitwise XOR operation. Since the answer can be large, print it modulo 109+7." 2400.0                                           
     1670D "Very Suspicious" "binary search,brute force,geometry,greedy,implementation,math" "Sehr Sus is an infinite hexagonal grid as pictured below, controlled by MennaFadali, ZerooCool and Hosssam.They love equilateral triangles and want to create n equilateral triangles on the grid by adding some straight lines. The triangles must all be empty from the inside (in other words, no straight line or hexagon edge should pass through any of the triangles).You are allowed to add straight lines parallel to the edges of the hexagons. Given n, what is the minimum number of lines you need to add to create at least n equilateral triangles as described?  Adding two red lines results in two new yellow equilateral triangles." 1700.0                                           
     1667C "Half Queen Cover" "constructive algorithms,math" "You are given a board with n rows and n columns, numbered from 1 to n. The intersection of the a-th row and b-th column is denoted by (a,b).A half-queen attacks cells in the same row, same column, and on one diagonal. More formally, a half-queen on (a,b) attacks the cell (c,d) if a=c or b=d or a\xe2\x88\x92b=c\xe2\x88\x92d.  The blue cells are under attack.  What is the minimum number of half-queens that can be placed on that board so as to ensure that each square is attacked by at least one half-queen?Construct an optimal solution." 2400.0                                           
     1665B "Array Cloning Technique" "constructive algorithms,greedy,sortings" "You are given an array a of n integers. Initially there is only one copy of the given array.You can do operations of two types:  Choose any array and clone it. After that there is one more copy of the chosen array.  Swap two elements from any two copies (maybe in the same copy) on any positions. You need to find the minimal number of operations needed to obtain a copy where all elements are equal." 900.0                                           
     1662H Boundary "brute force,math" "Bethany would like to tile her bathroom. The bathroom has width w centimeters and length l centimeters. If Bethany simply used the basic tiles of size 1\xc3\x971 centimeters, she would use w\xe2\x8b\x85l of them. However, she has something different in mind.   On the interior of the floor she wants to use the 1\xc3\x971 tiles. She needs exactly (w\xe2\x88\x922)\xe2\x8b\x85(l\xe2\x88\x922) of these.  On the floor boundary she wants to use tiles of size 1\xc3\x97a for some positive integer a. The tiles can also be rotated by 90 degrees. For which values of a can Bethany tile the bathroom floor as described? Note that a can also be 1." -999.0                                           
     1662G "Gastronomic Event" dp,greedy,trees "SWERC organizers want to hold a gastronomic event.The location of the event is a building with n rooms connected by n\xe2\x88\x921 corridors (each corridor connects two rooms) so that it is possible to go from any room to any other room.In each room you have to set up the tasting of a typical Italian dish. You can choose from n typical Italian dishes rated from 1 to n depending on how good they are (n is the best possible rating). The n dishes have distinct ratings.You want to assign the n dishes to the n rooms so that the number of pleasing tours is maximal. A pleasing tour is a nonempty sequence of rooms so that:  Each room in the sequence is connected to the next one in the sequence by a corridor.  The ratings of the dishes in the rooms (in the order given by the sequence) are increasing.  If you assign the n dishes optimally, what is the maximum number of pleasing tours?" -999.0                                           
     1657C "Bracket Sequence Deletion" greedy,implementation "You are given a bracket sequence consisting of n characters \'(\' and/or )\'. You perform several operations with it.During one operation, you choose the shortest prefix of this string (some amount of first characters of the string) that is good and remove it from the string.The prefix is considered good if one of the following two conditions is satisfied:  this prefix is a regular bracket sequence;  this prefix is a palindrome of length at least two. A bracket sequence is called regular if it is possible to obtain a correct arithmetic expression by inserting characters \'+\' and \'1\' into this sequence. For example, sequences (())(), () and (()(())) are regular, while )(, (() and (()))( are not.The bracket sequence is called palindrome if it reads the same back and forth. For example, the bracket sequences )), (( and )(() are palindromes, while bracket sequences (), )( and ))( are not palindromes.You stop performing the operations when it\'s not possible to find a good prefix. Your task is to find the number of operations you will perform on the given string and the number of remaining characters in the string.You have to answer t independent test cases." 1200.0                                           
     1654H "Three Minimums" "combinatorics,constructive algorithms,divide and conquer,dp,fft,math" "Given a list of distinct values, we denote with first minimum, second minimum, and third minimum the three smallest values (in increasing order).A permutation p1,p2,\xe2\x80\xa6,pn is good if the following statement holds for all pairs (l,r) with 1\xe2\x89\xa4l<l+2\xe2\x89\xa4r\xe2\x89\xa4n.   If {pl,pr} are (not necessarily in this order) the first and second minimum of pl,pl+1,\xe2\x80\xa6,pr then the third minimum of pl,pl+1,\xe2\x80\xa6,pr is either pl+1 or pr\xe2\x88\x921. You are given an integer n and a string s of length m consisting of characters ""<"" and "">"".Count the number of good permutations p1,p2,\xe2\x80\xa6,pn such that, for all 1\xe2\x89\xa4i\xe2\x89\xa4m,   pi<pi+1 if si= ""<"";  pi>pi+1 if si= "">"".  As the result can be very large, you should print it modulo 998244353." 3500.0                                           
     1654E "Arithmetic Operations" "brute force,data structures,graphs,math" "You are given an array of integers a1,a2,\xe2\x80\xa6,an.You can do the following operation any number of times (possibly zero):   Choose any index i and set ai to any integer (positive, negative or 0). What is the minimum number of operations needed to turn a into an arithmetic progression? The array a is an arithmetic progression if ai+1\xe2\x88\x92ai=ai\xe2\x88\x92ai\xe2\x88\x921 for any 2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921." 2300.0                                           
     1654B "Prefix Removals" strings "You are given a string s consisting of lowercase letters of the English alphabet. You must perform the following algorithm on s:  Let x be the length of the longest prefix of s which occurs somewhere else in s as a contiguous substring (the other occurrence may also intersect the prefix). If x=0, break. Otherwise, remove the first x characters of s, and repeat. A prefix is a string consisting of several first letters of a given string, without any reorders. An empty prefix is also a valid prefix. For example, the string ""abcd"" has 5 prefixes: empty string, ""a"", ""ab"", ""abc"" and ""abcd"".For instance, if we perform the algorithm on s= ""abcabdc"",   Initially, ""ab"" is the longest prefix that also appears somewhere else as a substring in s, so s= ""cabdc"" after 1 operation.  Then, ""c"" is the longest prefix that also appears somewhere else as a substring in s, so s= ""abdc"" after 2 operations.  Now x=0 (because there are no non-empty prefixes of ""abdc"" that also appear somewhere else as a substring in s), so the algorithm terminates. Find the final state of the string after performing the algorithm." 800.0                                           
     1650B "DIV + MOD" math "Not so long ago, Vlad came up with an interesting function: fa(x)=\xe2\x8c\x8axa\xe2\x8c\x8b+xmoda, where \xe2\x8c\x8axa\xe2\x8c\x8b is xa, rounded down, xmoda \xe2\x80\x94 the remainder of the integer division of x by a.For example, with a=3 and x=11, the value f3(11)=\xe2\x8c\x8a113\xe2\x8c\x8b+11mod3=3+2=5.The number a is fixed and known to Vlad. Help Vlad find the maximum value of fa(x) if x can take any integer value from l to r inclusive (l\xe2\x89\xa4x\xe2\x89\xa4r)." 900.0                                           
     1650A "Deletions of Two Adjacent Letters" implementation,strings "The string s is given, the string length is odd number. The string consists of lowercase letters of the Latin alphabet.As long as the string length is greater than 1, the following operation can be performed on it: select any two adjacent letters in the string s and delete them from the string. For example, from the string ""lemma"" in one operation, you can get any of the four strings: ""mma"", ""lma"", ""lea"" or ""lem"" In particular, in one operation, the length of the string reduces by 2.Formally, let the string s have the form s=s1s2\xe2\x80\xa6sn (n>1). During one operation, you choose an arbitrary index i (1\xe2\x89\xa4i<n) and replace s=s1s2\xe2\x80\xa6si\xe2\x88\x921si+2\xe2\x80\xa6sn.For the given string s and the letter c, determine whether it is possible to make such a sequence of operations that in the end the equality s=c will be true? In other words, is there such a sequence of operations that the process will end with a string of length 1, which consists of the letter c?" 800.0                                           
     1648E "Air Reform" "data structures,dfs and similar,divide and conquer,dsu,graphs,implementation,trees" "Berland is a large country with developed airlines. In total, there are n cities in the country that are historically served by the Berlaflot airline. The airline operates bi-directional flights between m pairs of cities, i-th of them connects cities with numbers ai and bi and has a price ci for a flight in both directions.It is known that Berlaflot flights can be used to get from any city to any other (possibly with transfers), and the cost of any route that consists of several consequent flights is equal to the cost of the most expensive of them. More formally, the cost of the route from a city t1 to a city tk with (k\xe2\x88\x922) transfers using cities t2, t3, t4, \xe2\x80\xa6, tk\xe2\x88\x921 is equal to the maximum cost of flights from t1 to t2, from t2 to t3, from t3 to t4 and so on until the flight from tk\xe2\x88\x921 to tk. Of course, all these flights must be operated by Berlaflot.A new airline, S8 Airlines, has recently started operating in Berland. This airline provides bi-directional flights between all pairs of cities that are not connected by Berlaflot direct flights. Thus, between each pair of cities there is a flight of either Berlaflot or S8 Airlines.The cost of S8 Airlines flights is calculated as follows: for each pair of cities x and y that is connected by a S8 Airlines flight, the cost of this flight is equal to the minimum cost of the route between the cities x and y at Berlaflot according to the pricing described earlier.It is known that with the help of S8 Airlines flights you can get from any city to any other with possible transfers, and, similarly to Berlaflot, the cost of a route between any two cities that consists of several S8 Airlines flights is equal to the cost of the most expensive flight.Due to the increased competition with S8 Airlines, Berlaflot decided to introduce an air reform and change the costs of its flights. Namely, for the i-th of its flight between the cities ai and bi, Berlaflot wants to make the cost of this flight equal to the minimum cost of the route between the cities ai and bi at S8 Airlines. Help Berlaflot managers calculate new flight costs." 3200.0                                           
     1647E "Madoka and the Sixth-graders" "data structures,dfs and similar,greedy" "After the most stunning success with the fifth-graders, Madoka has been trusted with teaching the sixth-graders.There\'s n single-place desks in her classroom. At the very beginning Madoka decided that the student number bi (1\xe2\x89\xa4bi\xe2\x89\xa4n) will sit at the desk number i. Also there\'s an infinite line of students with numbers n+1,n+2,n+3,\xe2\x80\xa6 waiting at the door with the hope of being able to learn something from the Madoka herself. Pay attention that each student has his unique number.After each lesson, the following happens in sequence.   The student sitting at the desk i moves to the desk pi. All students move simultaneously.  If there is more than one student at a desk, the student with the lowest number keeps the place, and the others are removed from the class forever.  For all empty desks in ascending order, the student from the lowest number from the outside line occupies the desk. Note that in the end there is exactly one student at each desk again. It is guaranteed that the numbers p are such that at least one student is removed after each lesson. Check out the explanation to the first example for a better understanding.After several (possibly, zero) lessons the desk i is occupied by student ai. Given the values a1,a2,\xe2\x80\xa6,an and p1,p2,\xe2\x80\xa6,pn, find the lexicographically smallest suitable initial seating permutation b1,b2,\xe2\x80\xa6,bn.The permutation is an array of n different integers from 1 up to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not (2 occurs twice). [1,3,4] is not a permutation either (n=3 but there\'s 4 in the array).For two different permutations a and b of the same length, a is lexicographically less than b if in the first position where a and b differ, the permutation a has a smaller element than the corresponding element in b." 2500.0                                           
     1644F Basis "combinatorics,fft,math,number theory" "For an array of integers a, let\'s define |a| as the number of elements in it.Let\'s denote two functions: F(a,k) is a function that takes an array of integers a and a positive integer k. The result of this function is the array containing |a| first elements of the array that you get by replacing each element of a with exactly k copies of that element.For example, F([2,2,1,3,5,6,8],2) is calculated as follows: first, you replace each element of the array with 2 copies of it, so you obtain [2,2,2,2,1,1,3,3,5,5,6,6,8,8]. Then, you take the first 7 elements of the array you obtained, so the result of the function is [2,2,2,2,1,1,3]. G(a,x,y) is a function that takes an array of integers a and two different integers x and y. The result of this function is the array a with every element equal to x replaced by y, and every element equal to y replaced by x.For example, G([1,1,2,3,5],3,1)=[3,3,2,1,5].An array a is a parent of the array b if:  either there exists a positive integer k such that F(a,k)=b;  or there exist two different integers x and y such that G(a,x,y)=b. An array a is an ancestor of the array b if there exists a finite sequence of arrays c0,c1,\xe2\x80\xa6,cm (m\xe2\x89\xa50) such that c0 is a, cm is b, and for every i\xe2\x88\x88[1,m], ci\xe2\x88\x921 is a parent of ci.And now, the problem itself.You are given two integers n and k. Your goal is to construct a sequence of arrays s1,s2,\xe2\x80\xa6,sm in such a way that:  every array si contains exactly n elements, and all elements are integers from 1 to k;  for every array a consisting of exactly n integers from 1 to k, the sequence contains at least one array si such that si is an ancestor of a. Print the minimum number of arrays in such sequence." 2900.0                                           
     1644C "Increase Subarray Sums" "brute force,dp,greedy,implementation" "You are given an array a1,a2,\xe2\x80\xa6,an, consisting of n integers. You are also given an integer value x.Let f(k) be the maximum sum of a contiguous subarray of a after applying the following operation: add x to the elements on exactly k distinct positions. An empty subarray should also be considered, it has sum 0.Note that the subarray doesn\'t have to include all of the increased elements.Calculate the maximum value of f(k) for all k from 0 to n independently." 1400.0                                           
     1641F "Covering Circle" geometry "Sam started playing with round buckets in the sandbox, while also scattering pebbles. His mom decided to buy him a new bucket, so she needs to solve the following task.You are given n distinct points with integer coordinates A1,A2,\xe2\x80\xa6,An. All points were generated from the square [\xe2\x88\x92108,108]\xc3\x97[\xe2\x88\x92108,108] uniformly and independently.You are given positive integers k, l, such that k\xe2\x89\xa4l\xe2\x89\xa4n. You want to select a subsegment Ai,Ai+1,\xe2\x80\xa6,Ai+l\xe2\x88\x921 of the points array (for some 1\xe2\x89\xa4i\xe2\x89\xa4n+1\xe2\x88\x92l), and some circle on the plane, containing \xe2\x89\xa5k points of the selected subsegment (inside or on the border).What is the smallest possible radius of that circle?" 3500.0                                           
     1639D "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999.0                                           
     1637H "Minimize Inversions Number" "data structures,greedy,math,sortings" "You are given a permutation p of length n.You can choose any subsequence, remove it from the permutation, and insert it at the beginning of the permutation keeping the same order.For every k from 0 to n, find the minimal possible number of inversions in the permutation after you choose a subsequence of length exactly k." 3500.0                                           
     1632A ABC implementation "Recently, the students of School 179 have developed a unique algorithm, which takes in a binary string s as input. However, they soon found out that if some substring t of s is a palindrome of length greater than 1, the algorithm will work incorrectly. Can the students somehow reorder the characters of s so that the algorithm will work correctly on the string?A binary string is a string where each character is either 0 or 1.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.A palindrome is a string that reads the same backwards as forwards." 800.0                                           
     1631A "Min Max Swap" greedy "You are given two arrays a and b of n positive integers each. You can apply the following operation to them any number of times:  Select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and swap ai with bi (i. e. ai becomes bi and vice versa). Find the minimum possible value of max(a1,a2,\xe2\x80\xa6,an)\xe2\x8b\x85max(b1,b2,\xe2\x80\xa6,bn) you can get after applying such operation any number of times (possibly zero)." 800.0                                           
     1628B "Peculiar Movie Preferences" greedy,strings "Mihai plans to watch a movie. He only likes palindromic movies, so he wants to skip some (possibly zero) scenes to make the remaining parts of the movie palindromic.You are given a list s of n non-empty strings of length at most 3, representing the scenes of Mihai\'s movie.A subsequence of s is called awesome if it is non-empty and the concatenation of the strings in the subsequence, in order, is a palindrome.Can you help Mihai check if there is at least one awesome subsequence of s?A palindrome is a string that reads the same backward as forward, for example strings ""z"", ""aaa"", ""aba"", ""abccba"" are palindromes, but strings ""codeforces"", ""reality"", ""ab"" are not.A sequence a is a non-empty subsequence of a non-empty sequence b if a can be obtained from b by deletion of several (possibly zero, but not all) elements." 1700.0                                           
     1622C "Set or Decrease" "binary search,brute force,greedy,sortings" "You are given an integer array a1,a2,\xe2\x80\xa6,an and integer k.In one step you can   either choose some index i and decrease ai by one (make ai=ai\xe2\x88\x921);  or choose two indices i and j and set ai equal to aj (make ai=aj). What is the minimum number of steps you need to make the sum of array n\xe2\x88\x91i=1ai\xe2\x89\xa4k? (You are allowed to make values of array negative)." 1600.0                                           
     1622B "Berland Music" "data structures,greedy,math,sortings" "Berland Music is a music streaming service built specifically to support Berland local artist. Its developers are currently working on a song recommendation module.So imagine Monocarp got recommended n songs, numbered from 1 to n. The i-th song had its predicted rating equal to pi, where 1\xe2\x89\xa4pi\xe2\x89\xa4n and every integer from 1 to n appears exactly once. In other words, p is a permutation.After listening to each of them, Monocarp pressed either a like or a dislike button. Let his vote sequence be represented with a string s, such that si=0 means that he disliked the i-th song, and si=1 means that he liked it.Now the service has to re-evaluate the song ratings in such a way that:  the new ratings q1,q2,\xe2\x80\xa6,qn still form a permutation (1\xe2\x89\xa4qi\xe2\x89\xa4n; each integer from 1 to n appears exactly once);  every song that Monocarp liked should have a greater rating than every song that Monocarp disliked (formally, for all i,j such that si=1 and sj=0, qi>qj should hold). Among all valid permutations q find the one that has the smallest value of n\xe2\x88\x91i=1|pi\xe2\x88\x92qi|, where |x| is an absolute value of x.Print the permutation q1,q2,\xe2\x80\xa6,qn. If there are multiple answers, you can print any of them." 1000.0                                           
     1622A "Construct a Rectangle" geometry,math "There are three sticks with integer lengths l1,l2 and l3.You are asked to break exactly one of them into two pieces in such a way that:   both pieces have positive (strictly greater than 0) integer length;  the total length of the pieces is equal to the original length of the stick;  it\'s possible to construct a rectangle from the resulting four sticks such that each stick is used as exactly one of its sides. A square is also considered a rectangle.Determine if it\'s possible to do that." 800.0                                           
     1621A "Stable Arrangement of Rooks" "constructive algorithms" "You have an n\xc3\x97n chessboard and k rooks. Rows of this chessboard are numbered by integers from 1 to n from top to bottom and columns of this chessboard are numbered by integers from 1 to n from left to right. The cell (x,y) is the cell on the intersection of row x and collumn y for 1\xe2\x89\xa4x\xe2\x89\xa4n and 1\xe2\x89\xa4y\xe2\x89\xa4n.The arrangement of rooks on this board is called good, if no rook is beaten by another rook.A rook beats all the rooks that shares the same row or collumn with it.The good arrangement of rooks on this board is called not stable, if it is possible to move one rook to the adjacent cell so arrangement becomes not good. Otherwise, the good arrangement is stable. Here, adjacent cells are the cells that share a side.  Such arrangement of 3 rooks on the 4\xc3\x974 chessboard is good, but it is not stable: the rook from (1,1) can be moved to the adjacent cell (2,1) and rooks on cells (2,1) and (2,4) will beat each other. Please, find any stable arrangement of k rooks on the n\xc3\x97n chessboard or report that there is no such arrangement." 800.0                                           
     1618A "Polycarp and Sums of Subsequences" math,sortings "Polycarp had an array a of 3 positive integers. He wrote out the sums of all non-empty subsequences of this array, sorted them in non-decreasing order, and got an array b of 7 integers.For example, if a={1,4,3}, then Polycarp wrote out 1, 4, 3, 1+4=5, 1+3=4, 4+3=7, 1+4+3=8. After sorting, he got an array b={1,3,4,4,5,7,8}.Unfortunately, Polycarp lost the array a. He only has the array b left. Help him to restore the array a." 800.0                                           
     1617C "Paprika and Permutation" "binary search,greedy,math,sortings" "Paprika loves permutations. She has an array a1,a2,\xe2\x80\xa6,an. She wants to make the array a permutation of integers 1 to n.In order to achieve this goal, she can perform operations on the array. In each operation she can choose two integers i (1\xe2\x89\xa4i\xe2\x89\xa4n) and x (x>0), then perform ai:=aimodx (that is, replace ai by the remainder of ai divided by x). In different operations, the chosen i and x can be different.Determine the minimum number of operations needed to make the array a permutation of integers 1 to n. If it is impossible, output \xe2\x88\x921.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1300.0                                           
     1617B "GCD Problem" "brute force,constructive algorithms,math,number theory" "Given a positive integer n. Find three distinct positive integers a, b, c such that a+b+c=n and gcd(a,b)=c, where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y." 900.0                                           
     1616E "Lexicographically Small Enough" "brute force,data structures,greedy,strings" "You are given two strings s and t of equal length n. In one move, you can swap any two adjacent characters of the string s.You need to find the minimal number of operations you need to make string s lexicographically smaller than string t.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 2200.0                                           
     1616B "Mirror in the String" greedy,strings "You have a string s1s2\xe2\x80\xa6sn and you stand on the left of the string looking right. You want to choose an index k (1\xe2\x89\xa4k\xe2\x89\xa4n) and place a mirror after the k-th letter, so that what you see is s1s2\xe2\x80\xa6sksksk\xe2\x88\x921\xe2\x80\xa6s1. What is the lexicographically smallest string you can see?A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 1100.0                                           
     1615E "Purple Crayon" "data structures,dfs and similar,games,graphs,greedy,math,sortings,trees" "Two players, Red and Blue, are at it again, and this time they\'re playing with crayons! The mischievous duo is now vandalizing a rooted tree, by coloring the nodes while playing their favorite game.The game works as follows: there is a tree of size n, rooted at node 1, where each node is initially white. Red and Blue get one turn each. Red goes first. In Red\'s turn, he can do the following operation any number of times:   Pick any subtree of the rooted tree, and color every node in the subtree red.  However, to make the game fair, Red is only allowed to color k nodes of the tree. In other words, after Red\'s turn, at most k of the nodes can be colored red.Then, it\'s Blue\'s turn. Blue can do the following operation any number of times:   Pick any subtree of the rooted tree, and color every node in the subtree blue. However, he\'s not allowed to choose a subtree that contains a node already colored red, as that would make the node purple and no one likes purple crayon.  Note: there\'s no restriction on the number of nodes Blue can color, as long as he doesn\'t color a node that Red has already colored.After the two turns, the score of the game is determined as follows: let w be the number of white nodes, r be the number of red nodes, and b be the number of blue nodes. The score of the game is w\xe2\x8b\x85(r\xe2\x88\x92b).Red wants to maximize this score, and Blue wants to minimize it. If both players play optimally, what will the final score of the game be?" 2400.0                                           
     1613C "Poisoned Dagger" "binary search" "Monocarp is playing yet another computer game. In this game, his character has to kill a dragon. The battle with the dragon lasts 100500 seconds, during which Monocarp attacks the dragon with a poisoned dagger. The i-th attack is performed at the beginning of the ai-th second from the battle start. The dagger itself does not deal damage, but it applies a poison effect on the dragon, which deals 1 damage during each of the next k seconds (starting with the same second when the dragon was stabbed by the dagger). However, if the dragon has already been poisoned, then the dagger updates the poison effect (i.e. cancels the current poison effect and applies a new one).For example, suppose k=4, and Monocarp stabs the dragon during the seconds 2, 4 and 10. Then the poison effect is applied at the start of the 2-nd second and deals 1 damage during the 2-nd and 3-rd seconds; then, at the beginning of the 4-th second, the poison effect is reapplied, so it deals exactly 1 damage during the seconds 4, 5, 6 and 7; then, during the 10-th second, the poison effect is applied again, and it deals 1 damage during the seconds 10, 11, 12 and 13. In total, the dragon receives 10 damage.Monocarp knows that the dragon has h hit points, and if he deals at least h damage to the dragon during the battle \xe2\x80\x94 he slays the dragon. Monocarp has not decided on the strength of the poison he will use during the battle, so he wants to find the minimum possible value of k (the number of seconds the poison effect lasts) that is enough to deal at least h damage to the dragon." 1200.0                                           
     1613B "Absent Remainder" greedy,implementation,sortings "You are given a sequence a1,a2,\xe2\x80\xa6,an consisting of n pairwise distinct positive integers.Find \xe2\x8c\x8an2\xe2\x8c\x8b different pairs of integers x and y such that:   x\xe2\x89\xa0y;  x and y appear in a;  x mod y doesn\'t appear in a. Note that some x or y can belong to multiple pairs.\xe2\x8c\x8ax\xe2\x8c\x8b denotes the floor function \xe2\x80\x94 the largest integer less than or equal to x. x mod y denotes the remainder from dividing x by y.If there are multiple solutions, print any of them. It can be shown that at least one solution always exists." 1000.0                                           
     1610A "Anti Light\'s Cell Guessing" math "You are playing a game on a n\xc3\x97m grid, in which the computer has selected some cell (x,y) of the grid, and you have to determine which one. To do so, you will choose some k and some k cells (x1,y1),(x2,y2),\xe2\x80\xa6,(xk,yk), and give them to the computer. In response, you will get k numbers b1,b2,\xe2\x80\xa6bk, where bi is the manhattan distance from (xi,yi) to the hidden cell (x,y) (so you know which distance corresponds to which of k input cells). After receiving these b1,b2,\xe2\x80\xa6,bk, you have to be able to determine the hidden cell. What is the smallest k for which is it possible to always guess the hidden cell correctly, no matter what cell computer chooses?As a reminder, the manhattan distance between cells (a1,b1) and (a2,b2) is equal to |a1\xe2\x88\x92a2|+|b1\xe2\x88\x92b2|." 900.0                                           
     1605E "Array Equalizer" "binary search,greedy,implementation,math,number theory,sortings,two pointers" "Jeevan has two arrays a and b of size n. He is fond of performing weird operations on arrays. This time, he comes up with two types of operations:  Choose any i (1\xe2\x89\xa4i\xe2\x89\xa4n) and increment aj by 1 for every j which is a multiple of i and 1\xe2\x89\xa4j\xe2\x89\xa4n.  Choose any i (1\xe2\x89\xa4i\xe2\x89\xa4n) and decrement aj by 1 for every j which is a multiple of i and 1\xe2\x89\xa4j\xe2\x89\xa4n. He wants to convert array a into an array b using the minimum total number of operations. However, Jeevan seems to have forgotten the value of b1. So he makes some guesses. He will ask you q questions corresponding to his q guesses, the i-th of which is of the form:   If b1=xi, what is the minimum number of operations required to convert a to b? Help him by answering each question." 2400.0                                           
     1603D "Artistic Partition" "divide and conquer,dp,number theory" "For two positive integers l and r (l\xe2\x89\xa4r) let c(l,r) denote the number of integer pairs (i,j) such that l\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4r and gcd(i,j)\xe2\x89\xa5l. Here, gcd(i,j) is the greatest common divisor (GCD) of integers i and j.YouKn0wWho has two integers n and k where 1\xe2\x89\xa4k\xe2\x89\xa4n. Let f(n,k) denote the minimum of k\xe2\x88\x91i=1c(xi+1,xi+1) over all integer sequences 0=x1<x2<\xe2\x80\xa6<xk<xk+1=n.Help YouKn0wWho find f(n,k)." 3000.0                                           
     1599C "Bubble Strike" "combinatorics,math,probabilities,ternary search" "Little Johnny Bubbles enjoys spending hours in front of his computer playing video games. His favorite game is Bubble Strike, fast-paced bubble shooting online game for two players.Each game is set in one of the N maps, each having different terrain configuration. First phase of each game decides on which map the game will be played. The game system randomly selects three maps and shows them to the players. Each player must pick one of those three maps to be discarded. The game system then randomly selects one of the maps that were not picked by any of the players and starts the game.Johnny is deeply enthusiastic about the game and wants to spend some time studying maps, thus increasing chances to win games played on those maps. However, he also needs to do his homework, so he does not have time to study all the maps. That is why he asked himself the following question: ""What is the minimum number of maps I have to study, so that the probability to play one of those maps is at least P""?Can you help Johnny find the answer for this question? You can assume Johnny\'s opponents do not know him, and they will randomly pick maps." 2000.0                                           
     1599B "Restaurant Game"  "Alice and Bob always had hard time choosing restaurant for the dinner. Previously they performed Eenie Meenie Miney Mo game, but eventually as their restaurant list grew, they had to create a new game. This new game starts as they write restaurant names on N cards and align the cards in one line. Before the game begins, they both choose starting card and starting direction they are going to. They take turns in order one after another. After each turn, they move one card in their current direction. If they reach the end or beginning of the line of cards they change direction. Once they meet in a card, the card is marked for removal and is removed the first moment they both leave the card.  Example of how card is removed They repeat this process until there is only one restaurant card left. Since there are a lot of restaurant cards, they are bored to simulate this process over and over and need your help to determine the last card that remains. Can you help them?" 3100.0                                           
     1599A Weights "constructive algorithms,greedy,two pointers" "You are given an array A of length N weights of masses A1, A2...AN.\xe2\x80\xafNo two weights have the same mass. You can put every weight on one side of the balance (left or right).\xe2\x80\xafYou\xe2\x80\xafdon\'t have to put\xe2\x80\xafweights\xe2\x80\xafin order A1,...,AN.\xe2\x80\xafThere is also a\xe2\x80\xafstring S\xe2\x80\xafconsisting of characters ""L"" and ""R"",\xe2\x80\xafmeaning that after putting the\xe2\x80\xafi\xe2\x88\x92th\xe2\x80\xafweight (not Ai, but\xe2\x80\xafi\xe2\x88\x92th\xe2\x80\xafweight of your choice) left or right side of the balance should be heavier. Find the order of putting the weights on the balance such that rules of string S are satisfied.\xe2\x80\xaf" 2600.0                                           
     1598E Staircases "brute force,combinatorics,data structures,dfs and similar,dp,implementation,math" "You are given a matrix, consisting of n rows and m columns. The rows are numbered top to bottom, the columns are numbered left to right.Each cell of the matrix can be either free or locked.Let\'s call a path in the matrix a staircase if it:   starts and ends in the free cell;  visits only free cells;  has one of the two following structures:   the second cell is 1 to the right from the first one, the third cell is 1 to the bottom from the second one, the fourth cell is 1 to the right from the third one, and so on;  the second cell is 1 to the bottom from the first one, the third cell is 1 to the right from the second one, the fourth cell is 1 to the bottom from the third one, and so on.  In particular, a path, consisting of a single cell, is considered to be a staircase.Here are some examples of staircases:  Initially all the cells of the matrix are free.You have to process q queries, each of them flips the state of a single cell. So, if a cell is currently free, it makes it locked, and if a cell is currently locked, it makes it free.Print the number of different staircases after each query. Two staircases are considered different if there exists such a cell that appears in one path and doesn\'t appear in the other path." 2100.0                                           
     1598A "Computer Game" "brute force,dfs and similar,dp,implementation" "Monocarp is playing a computer game. Now he wants to complete the first level of this game.A level is a rectangular grid of 2 rows and n columns. Monocarp controls a character, which starts in cell (1,1) \xe2\x80\x94 at the intersection of the 1-st row and the 1-st column.Monocarp\'s character can move from one cell to another in one step if the cells are adjacent by side and/or corner. Formally, it is possible to move from cell (x1,y1) to cell (x2,y2) in one step if |x1\xe2\x88\x92x2|\xe2\x89\xa41 and |y1\xe2\x88\x92y2|\xe2\x89\xa41. Obviously, it is prohibited to go outside the grid.There are traps in some cells. If Monocarp\'s character finds himself in such a cell, he dies, and the game ends.To complete a level, Monocarp\'s character should reach cell (2,n) \xe2\x80\x94 at the intersection of row 2 and column n.Help Monocarp determine if it is possible to complete the level." 800.0                                           
     1593D2 "Half of Same" "brute force,math,number theory" "This problem is a complicated version of D1, but it has significant differences, so read the whole statement.Polycarp has an array of n (n is even) integers a1,a2,\xe2\x80\xa6,an. Polycarp conceived of a positive integer k. After that, Polycarp began performing the following operations on the array: take an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and reduce the number ai by k.After Polycarp performed some (possibly zero) number of such operations, it turned out that at least half of the numbers in the array became the same. Find the maximum k at which such a situation is possible, or print \xe2\x88\x921 if such a number can be arbitrarily large." 1900.0                                           
     1593D1 "All are Same" "math,number theory" "This problem is a simplified version of D2, but it has significant differences, so read the whole statement.Polycarp has an array of n (n is even) integers a1,a2,\xe2\x80\xa6,an. Polycarp conceived of a positive integer k. After that, Polycarp began performing the following operations on the array: take an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and reduce the number ai by k.After Polycarp performed some (possibly zero) number of such operations, it turned out that all numbers in the array became the same. Find the maximum k at which such a situation is possible, or print \xe2\x88\x921 if such a number can be arbitrarily large." 1100.0                                           
     1593C "Save More Mice" "binary search,greedy,greedy" "There are one cat, k mice, and one hole on a coordinate line. The cat is located at the point 0, the hole is located at the point n. All mice are located between the cat and the hole: the i-th mouse is located at the point xi (0<xi<n). At each point, many mice can be located.In one second, the following happens. First, exactly one mouse moves to the right by 1. If the mouse reaches the hole, it hides (i.e. the mouse will not any more move to any point and will not be eaten by the cat). Then (after that the mouse has finished its move) the cat moves to the right by 1. If at the new cat\'s position, some mice are located, the cat eats them (they will not be able to move after that). The actions are performed until any mouse hasn\'t been hidden or isn\'t eaten.In other words, the first move is made by a mouse. If the mouse has reached the hole, it\'s saved. Then the cat makes a move. The cat eats the mice located at the pointed the cat has reached (if the cat has reached the hole, it eats nobody).Each second, you can select a mouse that will make a move. What is the maximum number of mice that can reach the hole without being eaten?" 1000.0                                           
     1593B "Make it Divisible by 25" "dfs and similar,dp,greedy,math,math" "It is given a positive integer n. In 1 move, one can select any single digit and remove it (i.e. one selects some position in the number and removes the digit located at this position). The operation cannot be performed if only one digit remains. If the resulting number contains leading zeroes, they are automatically removed.E.g. if one removes from the number 32925 the 3-rd digit, the resulting number will be 3225. If one removes from the number 20099050 the first digit, the resulting number will be 99050 (the 2 zeroes going next to the first digit are automatically removed).What is the minimum number of steps to get a number such that it is divisible by 25 and positive? It is guaranteed that, for each n occurring in the input, the answer exists. It is guaranteed that the number n has no leading zeros." 900.0                                           
     1592D "Hemose in ICPC ?" "binary search,dfs and similar,implementation,interactive,math,number theory,trees" "This is an interactive problem!In the last regional contest Hemose, ZeyadKhattab and YahiaSherif \xe2\x80\x94 members of the team Carpe Diem \xe2\x80\x94 did not qualify to ICPC because of some unknown reasons. Hemose was very sad and had a bad day after the contest, but ZeyadKhattab is very wise and knows Hemose very well, and does not want to see him sad.Zeyad knows that Hemose loves tree problems, so he gave him a tree problem with a very special device.Hemose has a weighted tree with n nodes and n\xe2\x88\x921 edges. Unfortunately, Hemose doesn\'t remember the weights of edges.Let\'s define Dist(u,v) for u\xe2\x89\xa0v as the greatest common divisor of the weights of all edges on the path from node u to node v.Hemose has a special device. Hemose can give the device a set of nodes, and the device will return the largest Dist between any two nodes from the set. More formally, if Hemose gives the device a set S of nodes, the device will return the largest value of Dist(u,v) over all pairs (u,v) with u, v \xe2\x88\x88 S and u\xe2\x89\xa0v.Hemose can use this Device at most 12 times, and wants to find any two distinct nodes a, b, such that Dist(a,b) is maximum possible. Can you help him?" 2300.0                                           
     1583H "Omkar and Tours" "data structures,divide and conquer,sortings,trees" "Omkar is hosting tours of his country, Omkarland! There are n cities in Omkarland, and, rather curiously, there are exactly n\xe2\x88\x921 bidirectional roads connecting the cities to each other. It is guaranteed that you can reach any city from any other city through the road network.Every city has an enjoyment value e. Each road has a capacity c, denoting the maximum number of vehicles that can be on it, and an associated toll t. However, the toll system in Omkarland has an interesting quirk: if a vehicle travels on multiple roads on a single journey, they pay only the highest toll of any single road on which they traveled. (In other words, they pay maxt over all the roads on which they traveled.) If a vehicle traverses no roads, they pay 0 toll.Omkar has decided to host q tour groups. Each tour group consists of v vehicles starting at city x. (Keep in mind that a tour group with v vehicles can travel only on roads with capacity \xe2\x89\xa5v.) Being the tour organizer, Omkar wants his groups to have as much fun as they possibly can, but also must reimburse his groups for the tolls that they have to pay. Thus, for each tour group, Omkar wants to know two things: first, what is the enjoyment value of the city y with maximum enjoyment value that the tour group can reach from their starting city, and second, how much per vehicle will Omkar have to pay to reimburse the entire group for their trip from x to y? (This trip from x to y will always be on the shortest path from x to y.)In the case that there are multiple reachable cities with the maximum enjoyment value, Omkar will let his tour group choose which one they want to go to. Therefore, to prepare for all possible scenarios, he wants to know the amount of money per vehicle that he needs to guarantee that he can reimburse the group regardless of which city they choose." 3300.0                                           
     1583F "Defender of Childhood Dreams" "bitmasks,constructive algorithms,divide and conquer" "Even if you just leave them be, they will fall to pieces all by themselves. So, someone has to protect them, right?You find yourself playing with Teucer again in the city of Liyue. As you take the eccentric little kid around, you notice something interesting about the structure of the city.Liyue can be represented as a directed graph containing n nodes. Nodes are labeled from 1 to n. There is a directed edge from node a to node b if and only if a<b.A path between nodes a and b is defined as a sequence of edges such that you can start at a, travel along all of these edges in the corresponding direction, and end at b. The length of a path is defined by the number of edges. A rainbow path of length x is defined as a path in the graph such that there exists at least 2 distinct colors among the set of x edges.Teucer\'s favorite number is k. You are curious about the following scenario: If you were to label each edge with a color, what is the minimum number of colors needed to ensure that all paths of length k or longer are rainbow paths?Teucer wants to surprise his older brother with a map of Liyue. He also wants to know a valid coloring of edges that uses the minimum number of colors. Please help him with this task!" 2500.0                                           
     1583E "Moment of Bloom" "constructive algorithms,dfs and similar,graph matchings,graphs,greedy,trees" "She does her utmost to flawlessly carry out a person\'s last rites and preserve the world\'s balance of yin and yang.Hu Tao, being the little prankster she is, has tried to scare you with this graph problem! You are given a connected undirected graph of n nodes with m edges. You also have q queries. Each query consists of two nodes a and b.Initially, all edges in the graph have a weight of 0. For each query, you must choose a simple path starting from a and ending at b. Then you add 1 to every edge along this path. Determine if it\'s possible, after processing all q queries, for all edges in this graph to have an even weight. If so, output the choice of paths for each query. If it is not possible, determine the smallest number of extra queries you could add to make it possible. It can be shown that this number will not exceed 1018 under the given constraints.A simple path is defined as any path that does not visit a node more than once.An edge is said to have an even weight if its value is divisible by 2." 2200.0                                           
     1583A "Windblume Ode" "math,number theory" "A bow adorned with nameless flowers that bears the earnest hopes of an equally nameless person.You have obtained the elegant bow known as the Windblume Ode. Inscribed in the weapon is an array of n (n\xe2\x89\xa53) positive distinct integers (i.e. different, no duplicates are allowed).Find the largest subset (i.e. having the maximum number of elements) of this array such that its sum is a composite number. A positive integer x is called composite if there exists a positive integer y such that 1<y<x and x is divisible by y.If there are multiple subsets with this largest size with the composite sum, you can output any of them. It can be proven that under the constraints of the problem such a non-empty subset always exists." 800.0                                           
     1580F "Problems for Codeforces" combinatorics,fft,math "XYMXYM and CQXYM will prepare n problems for Codeforces. The difficulty of the problem i will be an integer ai, where ai\xe2\x89\xa50. The difficulty of the problems must satisfy ai+ai+1<m (1\xe2\x89\xa4i<n), and a1+an<m, where m is a fixed integer. XYMXYM wants to know how many plans of the difficulty of the problems there are modulo 998244353.Two plans of difficulty a and b are different only if there is an integer i (1\xe2\x89\xa4i\xe2\x89\xa4n) satisfying ai\xe2\x89\xa0bi." 3300.0                                           
     1579E2 "Array Optimization by Deque" "data structures,greedy" "In fact, the problems E1 and E2 do not have much in common. You should probably think of them as two separate problems.You are given an integer array a[1\xe2\x80\xa6n]=[a1,a2,\xe2\x80\xa6,an].Let us consider an empty deque (double-ended queue). A deque is a data structure that supports adding elements to both the beginning and the end. So, if there are elements [3,4,4] currently in the deque, adding an element 1 to the beginning will produce the sequence [1,3,4,4], and adding the same element to the end will produce [3,4,4,1].The elements of the array are sequentially added to the initially empty deque, starting with a1 and finishing with an. Before adding each element to the deque, you may choose whether to add it to the beginning or to the end.For example, if we consider an array a=[3,7,5,5], one of the possible sequences of actions looks like this:  1.add 3 to the beginning of the deque:deque has a sequence [3] in it; 2.add 7 to the end of the deque:deque has a sequence [3,7] in it; 3.add 5 to the end of the deque:deque has a sequence [3,7,5] in it; 4.add 5 to the beginning of the deque:deque has a sequence [5,3,7,5] in it;Find the minimal possible number of inversions in the deque after the whole array is processed. An inversion in sequence d is a pair of indices (i,j) such that i<j and di>dj. For example, the array d=[5,3,7,5] has exactly two inversions \xe2\x80\x94 (1,2) and (3,4), since d1=5>3=d2 and d3=7>5=d4." 1700.0                                           
     1579D "Productive Meeting" "constructive algorithms,graphs,greedy" "An important meeting is to be held and there are exactly n people invited. At any moment, any two people can step back and talk in private. The same two people can talk several (as many as they want) times per meeting.Each person has limited sociability. The sociability of the i-th person is a non-negative integer ai. This means that after exactly ai talks this person leaves the meeting (and does not talk to anyone else anymore). If ai=0, the i-th person leaves the meeting immediately after it starts.A meeting is considered most productive if the maximum possible number of talks took place during it.You are given an array of sociability a, determine which people should talk to each other so that the total number of talks is as large as possible." 1400.0                                           
     1579C Ticks greedy,implementation "Casimir has a rectangular piece of paper with a checkered field of size n\xc3\x97m. Initially, all cells of the field are white.Let us denote the cell with coordinates i vertically and j horizontally by (i,j). The upper left cell will be referred to as (1,1) and the lower right cell as (n,m).Casimir draws ticks of different sizes on the field. A tick of size d (d>0) with its center in cell (i,j) is drawn as follows:   First, the center cell (i,j) is painted black.  Then exactly d cells on the top-left diagonally to the center and exactly d cells on the top-right diagonally to the center are also painted black.  That is all the cells with coordinates (i\xe2\x88\x92h,j\xc2\xb1h) for all h between 0 and d are painted. In particular, a tick consists of 2d+1 black cells. An already painted cell will remain black if painted again. Below you can find an example of the 4\xc3\x979 box, with two ticks of sizes 2 and 3.  You are given a description of a checkered field of size n\xc3\x97m. Casimir claims that this field came about after he drew some (possibly 0) ticks on it. The ticks could be of different sizes, but the size of each tick is at least k (that is, d\xe2\x89\xa5k for all the ticks).Determine whether this field can indeed be obtained by drawing some (possibly none) ticks of sizes d\xe2\x89\xa5k or not." 1500.0                                           
     1579B "Shifting Sort" implementation,sortings "The new generation external memory contains an array of integers a[1\xe2\x80\xa6n]=[a1,a2,\xe2\x80\xa6,an].This type of memory does not support changing the value of an arbitrary element. Instead, it allows you to cut out any segment of the given array, cyclically shift (rotate) it by any offset and insert it back into the same place.Technically, each cyclic shift consists of two consecutive actions:   You may select arbitrary indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n) as the boundaries of the segment.  Then you replace the segment a[l\xe2\x80\xa6r] with it\'s cyclic shift to the left by an arbitrary offset d. The concept of a cyclic shift can be also explained by following relations: the sequence [1,4,1,3] is a cyclic shift of the sequence [3,1,4,1] to the left by the offset 1 and the sequence [4,1,3,1] is a cyclic shift of the sequence [3,1,4,1] to the left by the offset 2. For example, if a=[1,3,2,8,5], then choosing l=2, r=4 and d=2 yields a segment a[2\xe2\x80\xa64]=[3,2,8]. This segment is then shifted by the offset d=2 to the left, and you get a segment [8,3,2] which then takes the place of of the original elements of the segment. In the end you get a=[1,8,3,2,5].Sort the given array a using no more than n cyclic shifts of any of its segments. Note that you don\'t need to minimize the number of cyclic shifts. Any method that requires n or less cyclic shifts will be accepted." 1100.0                                           
     1579A "Casimir\'s String Solitaire" math,strings "Casimir has a string s which consists of capital Latin letters \'A\', \'B\', and \'C\' only. Each turn he can choose to do one of the two following actions:  he can either erase exactly one letter \'A\' and exactly one letter \'B\' from arbitrary places of the string (these letters don\'t have to be adjacent);  or he can erase exactly one letter \'B\' and exactly one letter \'C\' from arbitrary places in the string (these letters don\'t have to be adjacent). Therefore, each turn the length of the string is decreased exactly by 2. All turns are independent so for each turn, Casimir can choose any of two possible actions.For example, with s = ""ABCABC"" he can obtain a string s = ""ACBC"" in one turn (by erasing the first occurrence of \'B\' and the second occurrence of \'A\'). There are also many other options for a turn aside from this particular example.For a given string s determine whether there is a sequence of actions leading to an empty string. In other words, Casimir\'s goal is to erase all letters from the string. Is there a way to do this?" 800.0                                           
     1572A Book "binary search,brute force,data structures,dp,graphs,implementation,sortings" "You are given a book with n chapters.Each chapter has a specified list of other chapters that need to be understood in order to understand this chapter. To understand a chapter, you must read it after you understand every chapter on its required list.Currently you don\'t understand any of the chapters. You are going to read the book from the beginning till the end repeatedly until you understand the whole book. Note that if you read a chapter at a moment when you don\'t understand some of the required chapters, you don\'t understand this chapter.Determine how many times you will read the book to understand every chapter, or determine that you will never understand every chapter no matter how many times you read the book." 1800.0                                           
     1569D "Inconvenient Pairs" "binary search,data structures,implementation,sortings,two pointers" "There is a city that can be represented as a square grid with corner points in (0,0) and (106,106).The city has n vertical and m horizontal streets that goes across the whole city, i. e. the i-th vertical streets goes from (xi,0) to (xi,106) and the j-th horizontal street goes from (0,yj) to (106,yj). All streets are bidirectional. Borders of the city are streets as well.There are k persons staying on the streets: the p-th person at point (xp,yp) (so either xp equal to some xi or yp equal to some yj, or both).Let\'s say that a pair of persons form an inconvenient pair if the shortest path from one person to another going only by streets is strictly greater than the Manhattan distance between them.Calculate the number of inconvenient pairs of persons (pairs (x,y) and (y,x) are the same pair).Let\'s recall that Manhattan distance between points (x1,y1) and (x2,y2) is |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|." 1900.0                                           
     1566D2 "Seating Arrangements (hard version)" "data structures,greedy,implementation,sortings,two pointers" "It is the hard version of the problem. The only difference is that in this version 1\xe2\x89\xa4n\xe2\x89\xa4300.In the cinema seats can be represented as the table with n rows and m columns. The rows are numbered with integers from 1 to n. The seats in each row are numbered with consecutive integers from left to right: in the k-th row from m(k\xe2\x88\x921)+1 to mk for all rows 1\xe2\x89\xa4k\xe2\x89\xa4n. 12\xe2\x8b\xafm\xe2\x88\x921mm+1m+2\xe2\x8b\xaf2m\xe2\x88\x9212m2m+12m+2\xe2\x8b\xaf3m\xe2\x88\x9213m\xe2\x8b\xae\xe2\x8b\xae\xe2\x8b\xb1\xe2\x8b\xae\xe2\x8b\xaem(n\xe2\x88\x921)+1m(n\xe2\x88\x921)+2\xe2\x8b\xafnm\xe2\x88\x921nm The table with seats indices There are nm people who want to go to the cinema to watch a new film. They are numbered with integers from 1 to nm. You should give exactly one seat to each person.It is known, that in this cinema as lower seat index you have as better you can see everything happening on the screen. i-th person has the level of sight ai. Let\'s define si as the seat index, that will be given to i-th person. You want to give better places for people with lower sight levels, so for any two people i, j such that ai<aj it should be satisfied that si<sj.After you will give seats to all people they will start coming to their seats. In the order from 1 to nm, each person will enter the hall and sit in their seat. To get to their place, the person will go to their seat\'s row and start moving from the first seat in this row to theirs from left to right. While moving some places will be free, some will be occupied with people already seated. The inconvenience of the person is equal to the number of occupied seats he or she will go through.Let\'s consider an example: m=5, the person has the seat 4 in the first row, the seats 1, 3, 5 in the first row are already occupied, the seats 2 and 4 are free. The inconvenience of this person will be 2, because he will go through occupied seats 1 and 3.Find the minimal total inconvenience (the sum of inconveniences of all people), that is possible to have by giving places for all people (all conditions should be satisfied)." 1600.0                                           
     1566C "MAX-MEX Cut" "bitmasks,constructive algorithms,dp,greedy" "A binary string is a string that consists of characters 0 and 1. A bi-table is a table that has exactly two rows of equal length, each being a binary string.Let MEX of a bi-table be the smallest digit among 0, 1, or 2 that does not occur in the bi-table. For example, MEX for [00111010] is 2, because 0 and 1 occur in the bi-table at least once. MEX for [111111] is 0, because 0 and 2 do not occur in the bi-table, and 0<2.You are given a bi-table with n columns. You should cut it into any number of bi-tables (each consisting of consecutive columns) so that each column is in exactly one bi-table. It is possible to cut the bi-table into a single bi-table \xe2\x80\x94 the whole bi-table.What is the maximal sum of MEX of all resulting bi-tables can be?" 1000.0                                           
     1562D2 "Two Hundred Twenty One (hard version)" "data structures,math" "This is the hard version of the problem. The difference between the versions is that the hard version does require you to output the numbers of the rods to be removed. You can make hacks only if all versions of the problem are solved.Stitch likes experimenting with different machines with his friend Sparky. Today they built another machine.The main element of this machine are n rods arranged along one straight line and numbered from 1 to n inclusive. Each of these rods must carry an electric charge quantitatively equal to either 1 or \xe2\x88\x921 (otherwise the machine will not work). Another condition for this machine to work is that the sign-variable sum of the charge on all rods must be zero.More formally, the rods can be represented as an array of n numbers characterizing the charge: either 1 or \xe2\x88\x921. Then the condition must hold: a1\xe2\x88\x92a2+a3\xe2\x88\x92a4+\xe2\x80\xa6=0, or n\xe2\x88\x91i=1(\xe2\x88\x921)i\xe2\x88\x921\xe2\x8b\x85ai=0.Sparky charged all n rods with an electric current, but unfortunately it happened that the rods were not charged correctly (the sign-variable sum of the charge is not zero). The friends decided to leave only some of the rods in the machine. Sparky has q questions. In the ith question Sparky asks: if the machine consisted only of rods with numbers li to ri inclusive, what minimal number of rods could be removed from the machine so that the sign-variable sum of charges on the remaining ones would be zero? Also Sparky wants to know the numbers of these rods. Perhaps the friends got something wrong, and the sign-variable sum is already zero. In that case, you don\'t have to remove the rods at all.If the number of rods is zero, we will assume that the sign-variable sum of charges is zero, that is, we can always remove all rods.Help your friends and answer all of Sparky\'s questions!" 2200.0                                           
     1562A "The Miracle and the Sleeper" greedy,math "You are given two integers l and r, l\xe2\x89\xa4r. Find the largest possible value of amodb over all pairs (a,b) of integers for which r\xe2\x89\xa5a\xe2\x89\xa5b\xe2\x89\xa5l.As a reminder, amodb is a remainder we get when dividing a by b. For example, 26mod8=2." 800.0                                           
     1559E "Mocha and Stars" "combinatorics,dp,fft,math,number theory" "Mocha wants to be an astrologer. There are n stars which can be seen in Zhijiang, and the brightness of the i-th star is ai. Mocha considers that these n stars form a constellation, and she uses (a1,a2,\xe2\x80\xa6,an) to show its state. A state is called mathematical if all of the following three conditions are satisfied:  For all i (1\xe2\x89\xa4i\xe2\x89\xa4n), ai is an integer in the range [li,ri]. n\xe2\x88\x91i=1ai\xe2\x89\xa4m. gcd(a1,a2,\xe2\x80\xa6,an)=1. Here, gcd(a1,a2,\xe2\x80\xa6,an) denotes the greatest common divisor (GCD) of integers a1,a2,\xe2\x80\xa6,an.Mocha is wondering how many different mathematical states of this constellation exist. Because the answer may be large, you must find it modulo 998244353.Two states (a1,a2,\xe2\x80\xa6,an) and (b1,b2,\xe2\x80\xa6,bn) are considered different if there exists i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that ai\xe2\x89\xa0bi." 2200.0                                           
     1558A "Charmed by the Game" "brute force,math" "Alice and Borys are playing tennis.A tennis match consists of games. In each game, one of the players is serving and the other one is receiving.Players serve in turns: after a game where Alice is serving follows a game where Borys is serving, and vice versa.Each game ends with a victory of one of the players. If a game is won by the serving player, it\'s said that this player holds serve. If a game is won by the receiving player, it\'s said that this player breaks serve.It is known that Alice won a games and Borys won b games during the match. It is unknown who served first and who won which games.Find all values of k such that exactly k breaks could happen during the match between Alice and Borys in total." 1300.0                                           
     1557B "Moamen and k-subarrays" greedy,sortings "Moamen has an array of n distinct integers. He wants to sort that array in non-decreasing order by doing the following operations in order exactly once:  Split the array into exactly k non-empty subarrays such that each element belongs to exactly one subarray.  Reorder these subarrays arbitrary.  Merge the subarrays in their new order. A sequence a is a subarray of a sequence b if a can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end.Can you tell Moamen if there is a way to sort the array in non-decreasing order using the operations written above?" 1100.0                                           
     1553D Backspace "dp,greedy,strings,two pointers" "You are given two strings s and t, both consisting of lowercase English letters. You are going to type the string s character by character, from the first character to the last one.When typing a character, instead of pressing the button corresponding to it, you can press the ""Backspace"" button. It deletes the last character you have typed among those that aren\'t deleted yet (or does nothing if there are no characters in the current string). For example, if s is ""abcbd"" and you press Backspace instead of typing the first and the fourth characters, you will get the string ""bd"" (the first press of Backspace deletes no character, and the second press deletes the character \'c\'). Another example, if s is ""abcaa"" and you press Backspace instead of the last two letters, then the resulting text is ""a"".Your task is to determine whether you can obtain the string t, if you type the string s and press ""Backspace"" instead of typing several (maybe zero) characters of s." 1500.0                                           
     1552E "Colors and Intervals" "constructive algorithms,data structures,greedy,sortings" "The numbers 1,2,\xe2\x80\xa6,n\xe2\x8b\x85k are colored with n colors. These colors are indexed by 1,2,\xe2\x80\xa6,n. For each 1\xe2\x89\xa4i\xe2\x89\xa4n, there are exactly k numbers colored with color i.Let [a,b] denote the interval of integers between a and b inclusive, that is, the set {a,a+1,\xe2\x80\xa6,b}. You must choose n intervals [a1,b1],[a2,b2],\xe2\x80\xa6,[an,bn] such that:   for each 1\xe2\x89\xa4i\xe2\x89\xa4n, it holds 1\xe2\x89\xa4ai<bi\xe2\x89\xa4n\xe2\x8b\x85k;  for each 1\xe2\x89\xa4i\xe2\x89\xa4n, the numbers ai and bi are colored with color i;  each number 1\xe2\x89\xa4x\xe2\x89\xa4n\xe2\x8b\x85k belongs to at most \xe2\x8c\x88nk\xe2\x88\x921\xe2\x8c\x89 intervals. One can show that such a family of intervals always exists under the given constraints." 2300.0                                           
     1550A "Find The Array" greedy,math "Let\'s call an array a consisting of n positive (greater than 0) integers beautiful if the following condition is held for every i from 1 to n: either ai=1, or at least one of the numbers ai\xe2\x88\x921 and ai\xe2\x88\x922 exists in the array as well.For example:   the array [5,3,1] is beautiful: for a1, the number a1\xe2\x88\x922=3 exists in the array; for a2, the number a2\xe2\x88\x922=1 exists in the array; for a3, the condition a3=1 holds;  the array [1,2,2,2,2] is beautiful: for a1, the condition a1=1 holds; for every other number ai, the number ai\xe2\x88\x921=1 exists in the array;  the array [1,4] is not beautiful: for a2, neither a2\xe2\x88\x922=2 nor a2\xe2\x88\x921=3 exists in the array, and a2\xe2\x89\xa01;  the array [2] is not beautiful: for a1, neither a1\xe2\x88\x921=1 nor a1\xe2\x88\x922=0 exists in the array, and a1\xe2\x89\xa01;  the array [2,1,3] is beautiful: for a1, the number a1\xe2\x88\x921=1 exists in the array; for a2, the condition a2=1 holds; for a3, the number a3\xe2\x88\x922=1 exists in the array. You are given a positive integer s. Find the minimum possible size of a beautiful array with the sum of elements equal to s." 800.0                                           
     1547G "How Many Paths?" "dfs and similar,dp,graphs,trees" "You are given a directed graph G which can contain loops (edges from a vertex to itself). Multi-edges are absent in G which means that for all ordered pairs (u,v) exists at most one edge from u to v. Vertices are numbered from 1 to n.A path from u to v is a sequence of edges such that:  vertex u is the start of the first edge in the path;  vertex v is the end of the last edge in the path;  for all pairs of adjacent edges next edge starts at the vertex that the previous edge ends on. We will assume that the empty sequence of edges is a path from u to u.For each vertex v output one of four values:  0, if there are no paths from 1 to v;  1, if there is only one path from 1 to v;  2, if there is more than one path from 1 to v and the number of paths is finite;  \xe2\x88\x921, if the number of paths from 1 to v is infinite. Let\'s look at the example shown in the figure.  Then:  the answer for vertex 1 is 1: there is only one path from 1 to 1 (path with length 0);  the answer for vertex 2 is 0: there are no paths from 1 to 2;  the answer for vertex 3 is 1: there is only one path from 1 to 3 (it is the edge (1,3));  the answer for vertex 4 is 2: there are more than one paths from 1 to 4 and the number of paths are finite (two paths: [(1,3),(3,4)] and [(1,4)]);  the answer for vertex 5 is \xe2\x88\x921: the number of paths from 1 to 5 is infinite (the loop can be used in a path many times);  the answer for vertex 6 is \xe2\x88\x921: the number of paths from 1 to 6 is infinite (the loop can be used in a path many times)." 2100.0                                           
     1545B "AquaMoon and Chess" combinatorics,math "Cirno gave AquaMoon a chessboard of size 1\xc3\x97n. Its cells are numbered with integers from 1 to n from left to right. In the beginning, some of the cells are occupied with at most one pawn, and other cells are unoccupied.In each operation, AquaMoon can choose a cell i with a pawn, and do either of the following (if possible):   Move pawn from it to the (i+2)-th cell, if i+2\xe2\x89\xa4n and the (i+1)-th cell is occupied and the (i+2)-th cell is unoccupied.  Move pawn from it to the (i\xe2\x88\x922)-th cell, if i\xe2\x88\x922\xe2\x89\xa51 and the (i\xe2\x88\x921)-th cell is occupied and the (i\xe2\x88\x922)-th cell is unoccupied. You are given an initial state of the chessboard. AquaMoon wants to count the number of states reachable from the initial state with some sequence of operations. But she is not good at programming. Can you help her? As the answer can be large find it modulo 998244353." 1900.0                                           
     1540E "Tasty Dishes" math,matrices "Note that the memory limit is unusual.There are n chefs numbered 1,2,\xe2\x80\xa6,n that must prepare dishes for a king. Chef i has skill i and initially has a dish of tastiness ai where |ai|\xe2\x89\xa4i. Each chef has a list of other chefs that he is allowed to copy from. To stop chefs from learning bad habits, the king makes sure that chef i can only copy from chefs of larger skill.There are a sequence of days that pass during which the chefs can work on their dish. During each day, there are two stages during which a chef can change the tastiness of their dish.   At the beginning of each day, each chef can choose to work (or not work) on their own dish, thereby multiplying the tastiness of their dish of their skill (ai:=i\xe2\x8b\x85ai) (or doing nothing). After all chefs (who wanted) worked on their own dishes, each start observing the other chefs. In particular, for each chef j on chef i\'s list, chef i can choose to copy (or not copy) j\'s dish, thereby adding the tastiness of the j\'s dish to i\'s dish (ai:=ai+aj) (or doing nothing). It can be assumed that all copying occurs simultaneously. Namely, if chef i chooses to copy from chef j he will copy the tastiness of chef j\'s dish at the end of stage 1.All chefs work to maximize the tastiness of their own dish in order to please the king.Finally, you are given q queries. Each query is one of two types.  1 k l r \xe2\x80\x94 find the sum of tastiness al,al+1,\xe2\x80\xa6,ar after the k-th day. Because this value can be large, find it modulo 109+7.  2 i x \xe2\x80\x94 the king adds x tastiness to the i-th chef\'s dish before the 1-st day begins (ai:=ai+x). Note that, because the king wants to see tastier dishes, he only adds positive tastiness (x>0). Note that queries of type 1 are independent of each all other queries. Specifically, each query of type 1 is a scenario and does not change the initial tastiness ai of any dish for future queries. Note that queries of type 2 are cumulative and only change the initial tastiness ai of a dish. See notes for an example of queries." 3500.0                                           
     1540B "Tree Array" "brute force,combinatorics,dp,graphs,math,probabilities,trees" "You are given a tree consisting of n nodes. You generate an array from the tree by marking nodes one by one.Initially, when no nodes are marked, a node is equiprobably chosen and marked from the entire tree. After that, until all nodes are marked, a node is equiprobably chosen and marked from the set of unmarked nodes with at least one edge to a marked node. It can be shown that the process marks all nodes in the tree. The final array a is the list of the nodes\' labels in order of the time each node was marked.Find the expected number of inversions in the array that is generated by the tree and the aforementioned process.The number of inversions in an array a is the number of pairs of indices (i,j) such that i<j and ai>aj. For example, the array [4,1,3,2] contains 4 inversions: (1,2), (1,3), (1,4), (3,4)." 2300.0                                           
     1539E "Game with Cards" "binary search,constructive algorithms,data structures,dp,greedy,implementation" "The Alice\'s computer is broken, so she can\'t play her favorite card game now. To help Alice, Bob wants to answer n her questions. Initially, Bob holds one card with number 0 in the left hand and one in the right hand. In the i-th question, Alice asks Bob to replace a card in the left or right hand with a card with number ki (Bob chooses which of two cards he changes, Bob must replace exactly one card).After this action, Alice wants the numbers on the left and right cards to belong to given segments (segments for left and right cards can be different). Formally, let the number on the left card be x, and on the right card be y. Then after the i-th swap the following conditions must be satisfied: al,i\xe2\x89\xa4x\xe2\x89\xa4bl,i, and ar,i\xe2\x89\xa4y\xe2\x89\xa4br,i.Please determine if Bob can answer all requests. If it is possible, find a way to do it." 2500.0                                           
     1538G "Gift Set" "binary search,greedy,math,ternary search" "Polycarp has x of red and y of blue candies. Using them, he wants to make gift sets. Each gift set contains either a red candies and b blue candies, or a blue candies and b red candies. Any candy can belong to at most one gift set.Help Polycarp to find the largest number of gift sets he can create.For example, if x=10, y=12, a=5, and b=2, then Polycarp can make three gift sets:   In the first set there will be 5 red candies and 2 blue candies;  In the second set there will be 5 blue candies and 2 red candies;  In the third set will be 5 blue candies and 2 red candies. Note that in this example there is one red candy that Polycarp does not use in any gift set." 2100.0                                           
     1537B "Bad Boy" "constructive algorithms,greedy,math" "Riley is a very bad boy, but at the same time, he is a yo-yo master. So, he decided to use his yo-yo skills to annoy his friend Anton.Anton\'s room can be represented as a grid with n rows and m columns. Let (i,j) denote the cell in row i and column j. Anton is currently standing at position (i,j) in his room. To annoy Anton, Riley decided to throw exactly two yo-yos in cells of the room (they can be in the same cell).Because Anton doesn\'t like yo-yos thrown on the floor, he has to pick up both of them and return back to the initial position. The distance travelled by Anton is the shortest path that goes through the positions of both yo-yos and returns back to (i,j) by travelling only to adjacent by side cells. That is, if he is in cell (x,y) then he can travel to the cells (x+1,y), (x\xe2\x88\x921,y), (x,y+1) and (x,y\xe2\x88\x921) in one step (if a cell with those coordinates exists).Riley is wondering where he should throw these two yo-yos so that the distance travelled by Anton is maximized. But because he is very busy, he asked you to tell him." 900.0                                           
     1536A "Omkar and Bad Story" "brute force,constructive algorithms" "Omkar has received a message from Anton saying ""Your story for problem A is confusing. Just make a formal statement."" Because of this, Omkar gives you an array a=[a1,a2,\xe2\x80\xa6,an] of n distinct integers. An array b=[b1,b2,\xe2\x80\xa6,bk] is called nice if for any two distinct elements bi,bj of b, |bi\xe2\x88\x92bj| appears in b at least once. In addition, all elements in b must be distinct. Can you add several (maybe, 0) integers to a to create a nice array b of size at most 300? If a is already nice, you don\'t have to add any elements.For example, array [3,6,9] is nice, as |6\xe2\x88\x923|=|9\xe2\x88\x926|=3, which appears in the array, and |9\xe2\x88\x923|=6, which appears in the array, while array [4,2,0,6,9] is not nice, as |9\xe2\x88\x924|=5 is not present in the array.For integers x and y, |x\xe2\x88\x92y|=x\xe2\x88\x92y if x>y and |x\xe2\x88\x92y|=y\xe2\x88\x92x otherwise." 800.0                                           
     1534F1 "Falling Sand (Easy Version)" "dfs and similar,graphs,greedy" "This is the easy version of the problem. The difference between the versions is the constraints on aiai. You can make hacks only if all versions of the problem are solved.Little Dormi has recently received a puzzle from his friend and needs your help to solve it. The puzzle consists of an upright board with nn rows and mm columns of cells, some empty and some filled with blocks of sand, and mm non-negative integers a1,a2,\xe2\x80\xa6,ama1,a2,\xe2\x80\xa6,am (0\xe2\x89\xa4ai\xe2\x89\xa4n0\xe2\x89\xa4ai\xe2\x89\xa4n). In this version of the problem, aiai will be equal to the number of blocks of sand in column ii.When a cell filled with a block of sand is disturbed, the block of sand will fall from its cell to the sand counter at the bottom of the column (each column has a sand counter). While a block of sand is falling, other blocks of sand that are adjacent at any point to the falling block of sand will also be disturbed and start to fall. Specifically, a block of sand disturbed at a cell (i,j)(i,j) will pass through all cells below and including the cell (i,j)(i,j) within the column, disturbing all adjacent cells along the way. Here, the cells adjacent to a cell (i,j)(i,j) are defined as (i\xe2\x88\x921,j)(i\xe2\x88\x921,j), (i,j\xe2\x88\x921)(i,j\xe2\x88\x921), (i+1,j)(i+1,j), and (i,j+1)(i,j+1) (if they are within the grid). Note that the newly falling blocks can disturb other blocks.In one operation you are able to disturb any piece of sand. The puzzle is solved when there are at least aiai blocks of sand counted in the ii-th sand counter for each column from 11 to mm.You are now tasked with finding the minimum amount of operations in order to solve the puzzle. Note that Little Dormi will never give you a puzzle that is impossible to solve." 2500.0                                           
     1533G "Biome Map" "*special problem,constructive algorithms,dfs and similar,graphs" "Polycarp decided to generate a biome map for his game. A map is a matrix divided into cells 1\xc3\x971. Each cell of the map must contain one of the available biomes.Each biome is defined by two parameters: temperature (an integer from 1 to n) and humidity (an integer from 1 to m). But not for every temperature/humidity combination, a corresponding biome is available.The biome map should be generated according to the following rules:  each cell of the map belongs to exactly one biome;  each available biome has at least one cell on the map;  if two cells of the map are adjacent by the side and they belong to biomes with parameters (t1,h1) and (t2,h2), respectively, then the equality |t1\xe2\x88\x92t2|+|h1\xe2\x88\x92h2|=1 holds;  let the number of available biomes be equal to k, then the number of rows and columns of the map (separately) should not exceed k. Help Polycarp generate a biome map that meets all the conditions described above (or report that this is impossible)." -999.0                                           
     1529A "Eshag Loves Big Arrays" "constructive algorithms,greedy,math" "Eshag has an array a consisting of n integers.Eshag can perform the following operation any number of times: choose some subsequence of a and delete every element from it which is strictly larger than AVG, where AVG is the average of the numbers in the chosen subsequence.For example, if a=[1,4,3,2,4] and Eshag applies the operation to the subsequence containing a1, a2, a4 and a5, then he will delete those of these 4 elements which are larger than a1+a2+a4+a54=114, so after the operation, the array a will become a=[1,3,2].Your task is to find the maximum number of elements Eshag can delete from the array a by applying the operation described above some number (maybe, zero) times.A sequence b is a subsequence of an array c if b can be obtained from c by deletion of several (possibly, zero or all) elements." 800.0                                           
     1528D "It\'s a bird! No, it\'s a plane! No, it\'s AaParsa!" "constructive algorithms,graphs,shortest paths" "There are n cities in Shaazzzland, numbered from 0 to n\xe2\x88\x921. Ghaazzzland, the immortal enemy of Shaazzzland, is ruled by AaParsa.As the head of the Ghaazzzland\'s intelligence agency, AaParsa is carrying out the most important spying mission in Ghaazzzland\'s history on Shaazzzland.AaParsa has planted m transport cannons in the cities of Shaazzzland. The i-th cannon is planted in the city ai and is initially pointing at city bi.It is guaranteed that each of the n cities has at least one transport cannon planted inside it, and that no two cannons from the same city are initially pointing at the same city (that is, all pairs (ai,bi) are distinct).AaParsa used very advanced technology to build the cannons, the cannons rotate every second. In other words, if the i-th cannon is pointing towards the city x at some second, it will target the city (x+1)modn at the next second.As their name suggests, transport cannons are for transportation, specifically for human transport. If you use the i-th cannon to launch yourself towards the city that it\'s currently pointing at, you\'ll be airborne for ci seconds before reaching your target destination.If you still don\'t get it, using the i-th cannon at the s-th second (using which is only possible if you are currently in the city ai) will shoot you to the city (bi+s)modn and you\'ll land in there after ci seconds (so you\'ll be there in the (s+ci)-th second). Also note the cannon that you initially launched from will rotate every second but you obviously won\'t change direction while you are airborne. AaParsa wants to use the cannons for travelling between Shaazzzland\'s cities in his grand plan, and he can start travelling at second 0. For him to fully utilize them, he needs to know the minimum number of seconds required to reach city u from city v using the cannons for every pair of cities (u,v).Note that AaParsa can stay in a city for as long as he wants." 2500.0                                           
     1527E "Partition Game" "binary search,data structures,divide and conquer,dp" "You are given an array a of n integers. Define the cost of some array t as follows:cost(t)=\xe2\x88\x91x\xe2\x88\x88set(t)last(x)\xe2\x88\x92first(x), where set(t) is the set of all values in t without repetitions, first(x), and last(x) are the indices of the first and last occurrence of x in t, respectively. In other words, we compute the distance between the first and last occurrences for each distinct element and sum them up.You need to split the array a into k consecutive segments such that each element of a belongs to exactly one segment and the sum of the cost of individual segments is minimum." 2500.0                                           
     1526F "Median Queries" "constructive algorithms,interactive,probabilities" "This is an interactive problem.There is a secret permutation p (1-indexed) of numbers from 1 to n. More formally, for 1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4p[i]\xe2\x89\xa4n and for 1\xe2\x89\xa4i<j\xe2\x89\xa4n, p[i]\xe2\x89\xa0p[j]. It is known that p[1]<p[2].In 1 query, you give 3 distinct integers a,b,c (1\xe2\x89\xa4a,b,c\xe2\x89\xa4n), and receive the median of {|p[a]\xe2\x88\x92p[b]|,|p[b]\xe2\x88\x92p[c]|,|p[a]\xe2\x88\x92p[c]|}.In this case, the median is the 2-nd element (1-indexed) of the sequence when sorted in non-decreasing order. The median of {4,6,2} is 4 and the median of {0,123,33} is 33.Can you find the secret permutation in not more than 2n+420 queries?Note: the grader is not adaptive: the permutation is fixed before any queries are made." 3000.0                                           
     1526D "Kill Anton" "brute force,constructive algorithms,data structures,math,strings" "After rejecting 10100 data structure problems, Errorgorn is very angry at Anton and decided to kill him.Anton\'s DNA can be represented as a string a which only contains the characters ""ANTON"" (there are only 4 distinct characters). Errorgorn can change Anton\'s DNA into string b which must be a permutation of a. However, Anton\'s body can defend against this attack. In 1 second, his body can swap 2 adjacent characters of his DNA to transform it back to a. Anton\'s body is smart and will use the minimum number of moves.To maximize the chance of Anton dying, Errorgorn wants to change Anton\'s DNA the string that maximizes the time for Anton\'s body to revert his DNA. But since Errorgorn is busy making more data structure problems, he needs your help to find the best string B. Can you help him?" 2200.0                                           
     1526C1 "Potions (Easy Version)" "brute force,data structures,dp,greedy" "This is the easy version of the problem. The only difference is that in this version n\xe2\x89\xa42000. You can make hacks only if both versions of the problem are solved.There are n potions in a line, with potion 1 on the far left and potion n on the far right. Each potion will increase your health by ai when drunk. ai can be negative, meaning that potion will decrease will health.You start with 0 health and you will walk from left to right, from first potion to the last one. At each potion, you may choose to drink it or ignore it. You must ensure that your health is always non-negative.What is the largest number of potions you can drink?" 1500.0                                           
     1525E "Assimilation IV" "combinatorics,dp,math,probabilities,two pointers" "Monocarp is playing a game ""Assimilation IV"". In this game he manages a great empire: builds cities and conquers new lands.Monocarp\'s empire has n cities. In order to conquer new lands he plans to build one Monument in each city. The game is turn-based and, since Monocarp is still amateur, he builds exactly one Monument per turn.Monocarp has m points on the map he\'d like to control using the constructed Monuments. For each point he knows the distance between it and each city. Monuments work in the following way: when built in some city, a Monument controls all points at distance at most 1 to this city. Next turn, the Monument controls all points at distance at most 2, the turn after \xe2\x80\x94 at distance at most 3, and so on. Monocarp will build n Monuments in n turns and his empire will conquer all points that are controlled by at least one Monument.Monocarp can\'t figure out any strategy, so during each turn he will choose a city for a Monument randomly among all remaining cities (cities without Monuments). Monocarp wants to know how many points (among m of them) he will conquer at the end of turn number n. Help him to calculate the expected number of conquered points!" 2100.0                                           
          1332A "Exercising Walk" greedy,implementation,math "Alice has a cute cat. To keep her cat fit, Alice wants to design an exercising walk for her cat! Initially, Alice\'s cat is located in a cell (x,y) of an infinite grid. According to Alice\'s theory, cat needs to move:   exactly a steps left: from (u,v) to (u\xe2\x88\x921,v);  exactly b steps right: from (u,v) to (u+1,v);  exactly c steps down: from (u,v) to (u,v\xe2\x88\x921);  exactly d steps up: from (u,v) to (u,v+1). Note that the moves can be performed in an arbitrary order. For example, if the cat has to move 1 step left, 3 steps right and 2 steps down, then the walk right, down, left, right, right, down is valid.Alice, however, is worrying that her cat might get lost if it moves far away from her. So she hopes that her cat is always in the area [x1,x2]\xc3\x97[y1,y2], i.e. for every cat\'s position (u,v) of a walk x1\xe2\x89\xa4u\xe2\x89\xa4x2 and y1\xe2\x89\xa4v\xe2\x89\xa4y2 holds.Also, note that the cat can visit the same cell multiple times.Can you help Alice find out if there exists a walk satisfying her wishes?Formally, the walk should contain exactly a+b+c+d unit moves (a to the left, b to the right, c to the down, d to the up). Alice can do the moves in any order. Her current position (u,v) should always satisfy the constraints: x1\xe2\x89\xa4u\xe2\x89\xa4x2, y1\xe2\x89\xa4v\xe2\x89\xa4y2. The staring point is (x,y).You are required to answer t test cases independently." 1100.0                                      
          1331H "It\'s showtime" "*special problem" "You are given a mysterious language (codenamed ""UnknownX"") available in ""Custom Test"" tab. Find out what this language is, and use it to solve the following problem.You are given an integer input=1000\xe2\x88\x97n+mod (1\xe2\x89\xa4n,mod\xe2\x89\xa4999). Calculate double factorial of n modulo mod." -999.0                                      
          1331D Again? "*special problem,implementation" "InputThe only line of the input contains a 7-digit hexadecimal number. The first ""digit"" of the number is letter A, the rest of the ""digits"" are decimal digits 0-9.OutputOutput a single integer.ExamplesInputCopyA278832OutputCopy0InputCopyA089956OutputCopy0InputCopyA089957OutputCopy1InputCopyA144045OutputCopy1" -999.0                                      
          1330B "Dreamoon Likes Permutations" implementation,math "The sequence of m integers is called the permutation if it contains all integers from 1 to m exactly once. The number m is called the length of the permutation.Dreamoon has two permutations p1 and p2 of non-zero lengths l1 and l2.Now Dreamoon concatenates these two permutations into another sequence a of length l1+l2. First l1 elements of a is the permutation p1 and next l2 elements of a is the permutation p2. You are given the sequence a, and you need to find two permutations p1 and p2. If there are several possible ways to restore them, you should find all of them. (Note that it is also possible that there will be no ways.)" 1400.0                                      
          1327E "Count The Blocks" combinatorics,dp,math "You wrote down all integers from 0 to 10n\xe2\x88\x921, padding them with leading zeroes so their lengths are exactly n. For example, if n=3 then you wrote out 000, 001, ..., 998, 999.A block in an integer x is a consecutive segment of equal digits that cannot be extended to the left or to the right.For example, in the integer 00027734000 there are three blocks of length 1, one block of length 2 and two blocks of length 3.For all integers i from 1 to n count the number of blocks of length i among the written down integers.Since these integers may be too large, print them modulo 998244353." 1800.0                                      
          1326C "Permutation Partitions" combinatorics,greedy,math "You are given a permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n and an integer k, such that 1\xe2\x89\xa4k\xe2\x89\xa4n. A permutation means that every number from 1 to n is contained in p exactly once.Let\'s consider all partitions of this permutation into k disjoint segments. Formally, a partition is a set of segments {[l1,r1],[l2,r2],\xe2\x80\xa6,[lk,rk]}, such that:  1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n for all 1\xe2\x89\xa4i\xe2\x89\xa4k;  For all 1\xe2\x89\xa4j\xe2\x89\xa4n there exists exactly one segment [li,ri], such that li\xe2\x89\xa4j\xe2\x89\xa4ri. Two partitions are different if there exists a segment that lies in one partition but not the other.Let\'s calculate the partition value, defined as k\xe2\x88\x91i=1maxli\xe2\x89\xa4j\xe2\x89\xa4ripj, for all possible partitions of the permutation into k disjoint segments. Find the maximum possible partition value over all such partitions, and the number of partitions with this value. As the second value can be very large, you should find its remainder when divided by 998244353." 1300.0                                      
          1324B "Yet Another Palindrome Problem" "brute force,strings" "You are given an array a consisting of n integers.Your task is to determine if a has some subsequence of length at least 3 that is a palindrome.Recall that an array b is called a subsequence of the array a if b can be obtained by removing some (possibly, zero) elements from a (not necessarily consecutive) without changing the order of remaining elements. For example, [2], [1,2,1,3] and [2,3] are subsequences of [1,2,1,3], but [1,1,2] and [4] are not.Also, recall that a palindrome is an array that reads the same backward as forward. In other words, the array a of length n is the palindrome if ai=an\xe2\x88\x92i\xe2\x88\x921 for all i from 1 to n. For example, arrays [1234], [1,2,1], [1,3,2,2,3,1] and [10,100,10] are palindromes, but arrays [1,2] and [1,2,3,1] are not.You have to answer t independent test cases." 1100.0                                      
          1324A "Yet Another Tetris Problem" "implementation,number theory" "You are given some Tetris field consisting of n columns. The initial height of the i-th column of the field is ai blocks. On top of these columns you can place only figures of size 2\xc3\x971 (i.e. the height of this figure is 2 blocks and the width of this figure is 1 block). Note that you cannot rotate these figures.Your task is to say if you can clear the whole field by placing such figures.More formally, the problem can be described like this:The following process occurs while at least one ai is greater than 0:  You place one figure 2\xc3\x971 (choose some i from 1 to n and replace ai with ai+2);  then, while all ai are greater than zero, replace each ai with ai\xe2\x88\x921. And your task is to determine if it is possible to clear the whole field (i.e. finish the described process), choosing the places for new figures properly.You have to answer t independent test cases." 900.0                                      
          1322F "Assigning Fares" dp,trees "Mayor of city M. decided to launch several new metro lines during 2020. Since the city has a very limited budget, it was decided not to dig new tunnels but to use the existing underground network.The tunnel system of the city M. consists of n metro stations. The stations are connected with n\xe2\x88\x921 bidirectional tunnels. Between every two stations v and u there is exactly one simple path. Each metro line the mayor wants to create is a simple path between stations ai and bi. Metro lines can intersects freely, that is, they can share common stations or even common tunnels. However, it\'s not yet decided which of two directions each line will go. More precisely, between the stations ai and bi the trains will go either from ai to bi, or from bi to ai, but not simultaneously.The city M uses complicated faring rules. Each station is assigned with a positive integer ci \xe2\x80\x94 the fare zone of the station. The cost of travel from v to u is defined as cu\xe2\x88\x92cv roubles. Of course, such travel only allowed in case there is a metro line, the trains on which go from v to u. Mayor doesn\'t want to have any travels with a negative cost, so it was decided to assign directions of metro lines and station fare zones in such a way, that fare zones are strictly increasing during any travel on any metro line.Mayor wants firstly assign each station a fare zone and then choose a lines direction, such that all fare zones are increasing along any line. In connection with the approaching celebration of the day of the city, the mayor wants to assign fare zones so that the maximum ci will be as low as possible. Please help mayor to design a new assignment or determine if it\'s impossible to do. Please note that you only need to assign the fare zones optimally, you don\'t need to print lines\' directions. This way, you solution will be considered correct if there will be a way to assign directions of every metro line, so that the fare zones will be strictly increasing along any movement of the trains." 3500.0                                      
          1321C "Remove Adjacent" "brute force,constructive algorithms,greedy,strings" "You are given a string s consisting of lowercase Latin letters. Let the length of s be |s|. You may perform several operations on this string.In one operation, you can choose some index i and remove the i-th character of s (si) if at least one of its adjacent characters is the previous letter in the Latin alphabet for si. For example, the previous letter for b is a, the previous letter for s is r, the letter a has no previous letters. Note that after each removal the length of the string decreases by one. So, the index i should satisfy the condition 1\xe2\x89\xa4i\xe2\x89\xa4|s| during each operation.For the character si adjacent characters are si\xe2\x88\x921 and si+1. The first and the last characters of s both have only one adjacent character (unless |s|=1).Consider the following example. Let s= bacabcab.  During the first move, you can remove the first character s1= b because s2= a. Then the string becomes s= acabcab.  During the second move, you can remove the fifth character s5= c because s4= b. Then the string becomes s= acabab.  During the third move, you can remove the sixth character s6=\'b\' because s5= a. Then the string becomes s= acaba.  During the fourth move, the only character you can remove is s4= b, because s3= a (or s5= a). The string becomes s= acaa and you cannot do anything with it. Your task is to find the maximum possible number of characters you can remove if you choose the sequence of operations optimally." 1600.0                                      
          1320B "Navigation System" "dfs and similar,graphs,shortest paths" "The map of Bertown can be represented as a set of n intersections, numbered from 1 to n and connected by m one-way roads. It is possible to move along the roads from any intersection to any other intersection. The length of some path from one intersection to another is the number of roads that one has to traverse along the path. The shortest path from one intersection v to another intersection u is the path that starts in v, ends in u and has the minimum length among all such paths.Polycarp lives near the intersection s and works in a building near the intersection t. Every day he gets from s to t by car. Today he has chosen the following path to his workplace: p1, p2, ..., pk, where p1=s, pk=t, and all other elements of this sequence are the intermediate intersections, listed in the order Polycarp arrived at them. Polycarp never arrived at the same intersection twice, so all elements of this sequence are pairwise distinct. Note that you know Polycarp\'s path beforehand (it is fixed), and it is not necessarily one of the shortest paths from s to t.Polycarp\'s car has a complex navigation system installed in it. Let\'s describe how it works. When Polycarp starts his journey at the intersection s, the system chooses some shortest path from s to t and shows it to Polycarp. Let\'s denote the next intersection in the chosen path as v. If Polycarp chooses to drive along the road from s to v, then the navigator shows him the same shortest path (obviously, starting from v as soon as he arrives at this intersection). However, if Polycarp chooses to drive to another intersection w instead, the navigator rebuilds the path: as soon as Polycarp arrives at w, the navigation system chooses some shortest path from w to t and shows it to Polycarp. The same process continues until Polycarp arrives at t: if Polycarp moves along the road recommended by the system, it maintains the shortest path it has already built; but if Polycarp chooses some other path, the system rebuilds the path by the same rules.Here is an example. Suppose the map of Bertown looks as follows, and Polycarp drives along the path [1,2,3,4] (s=1, t=4): Check the picture by the link http://tk.codeforces.com/a.png   When Polycarp starts at 1, the system chooses some shortest path from 1 to 4. There is only one such path, it is [1,5,4];  Polycarp chooses to drive to 2, which is not along the path chosen by the system. When Polycarp arrives at 2, the navigator rebuilds the path by choosing some shortest path from 2 to 4, for example, [2,6,4] (note that it could choose [2,3,4]);  Polycarp chooses to drive to 3, which is not along the path chosen by the system. When Polycarp arrives at 3, the navigator rebuilds the path by choosing the only shortest path from 3 to 4, which is [3,4];  Polycarp arrives at 4 along the road chosen by the navigator, so the system does not have to rebuild anything. Overall, we get 2 rebuilds in this scenario. Note that if the system chose [2,3,4] instead of [2,6,4] during the second step, there would be only 1 rebuild (since Polycarp goes along the path, so the system maintains the path [3,4] during the third step).The example shows us that the number of rebuilds can differ even if the map of Bertown and the path chosen by Polycarp stays the same. Given this information (the map and Polycarp\'s path), can you determine the minimum and the maximum number of rebuilds that could have happened during the journey?" 1700.0                                      
          1316F "Battalion Strength" "data structures,divide and conquer,probabilities" "There are n officers in the Army of Byteland. Each officer has some power associated with him. The power of the i-th officer is denoted by pi. As the war is fast approaching, the General would like to know the strength of the army.The strength of an army is calculated in a strange way in Byteland. The General selects a random subset of officers from these n officers and calls this subset a battalion.(All 2n subsets of the n officers can be chosen equally likely, including empty subset and the subset of all officers).The strength of a battalion is calculated in the following way:Let the powers of the chosen officers be a1,a2,\xe2\x80\xa6,ak, where a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4ak. The strength of this battalion is equal to a1a2+a2a3+\xe2\x8b\xaf+ak\xe2\x88\x921ak. (If the size of Battalion is \xe2\x89\xa41, then the strength of this battalion is 0).The strength of the army is equal to the expected value of the strength of the battalion.As the war is really long, the powers of officers may change. Precisely, there will be q changes. Each one of the form i x indicating that pi is changed to x.You need to find the strength of the army initially and after each of these q updates.Note that the changes are permanent.The strength should be found by modulo 109+7. Formally, let M=109+7. It can be shown that the answer can be expressed as an irreducible fraction p/q, where p and q are integers and q\xe2\x89\xa20modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1pmodM)." 2800.0                                      
          1312E "Array Shrinking" dp,greedy "You are given an array a1,a2,\xe2\x80\xa6,an. You can perform the following operation any number of times:  Choose a pair of two neighboring equal elements ai=ai+1 (if there is at least one such pair).  Replace them by one element with value ai+1. After each such operation, the length of the array will decrease by one (and elements are renumerated accordingly). What is the minimum possible length of the array a you can get?" 2100.0                                      
          1307F "Cow and Vacation" "dfs and similar,dsu,trees" "Bessie is planning a vacation! In Cow-lifornia, there are n cities, with n\xe2\x88\x921 bidirectional roads connecting them. It is guaranteed that one can reach any city from any other city. Bessie is considering v possible vacation plans, with the i-th one consisting of a start city ai and destination city bi.It is known that only r of the cities have rest stops. Bessie gets tired easily, and cannot travel across more than k consecutive roads without resting. In fact, she is so desperate to rest that she may travel through the same city multiple times in order to do so.For each of the vacation plans, does there exist a way for Bessie to travel from the starting city to the destination city?" 3300.0                                      
          1307A "Cow and Haybales" greedy,implementation "The USA Construction Operation (USACO) recently ordered Farmer John to arrange a row of n haybale piles on the farm. The i-th pile contains ai haybales. However, Farmer John has just left for vacation, leaving Bessie all on her own. Every day, Bessie the naughty cow can choose to move one haybale in any pile to an adjacent pile. Formally, in one day she can choose any two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that |i\xe2\x88\x92j|=1 and ai>0 and apply ai=ai\xe2\x88\x921, aj=aj+1. She may also decide to not do anything on some days because she is lazy.Bessie wants to maximize the number of haybales in pile 1 (i.e. to maximize a1), and she only has d days to do so before Farmer John returns. Help her find the maximum number of haybales that may be in pile 1 if she acts optimally!" 800.0                                      
          1305F "Kuroni and the Punishment" "math,number theory,probabilities" "Kuroni is very angry at the other setters for using him as a theme! As a punishment, he forced them to solve the following problem:You have an array a consisting of n positive integers. An operation consists of choosing an element and either adding 1 to it or subtracting 1 from it, such that the element remains positive. We say the array is good if the greatest common divisor of all its elements is not 1. Find the minimum number of operations needed to make the array good.Unable to match Kuroni\'s intellect, the setters failed to solve the problem. Help them escape from Kuroni\'s punishment!" 2500.0                                      
          1304E "1-Trees and Queries" "data structures,dfs and similar,shortest paths,trees" "Gildong was hiking a mountain, walking by millions of trees. Inspired by them, he suddenly came up with an interesting idea for trees in data structures: What if we add another edge in a tree?Then he found that such tree-like graphs are called 1-trees. Since Gildong was bored of solving too many tree problems, he wanted to see if similar techniques in trees can be used in 1-trees as well. Instead of solving it by himself, he\'s going to test you by providing queries on 1-trees.First, he\'ll provide you a tree (not 1-tree) with n vertices, then he will ask you q queries. Each query contains 5 integers: x, y, a, b, and k. This means you\'re asked to determine if there exists a path from vertex a to b that contains exactly k edges after adding a bidirectional edge between vertices x and y. A path can contain the same vertices and same edges multiple times. All queries are independent of each other; i.e. the added edge in a query is removed in the next query." 2000.0                                      
          1303G "Sum of Prefix Sums" "data structures,divide and conquer,geometry,trees" "We define the sum of prefix sums of an array [s1,s2,\xe2\x80\xa6,sk] as s1+(s1+s2)+(s1+s2+s3)+\xe2\x8b\xaf+(s1+s2+\xe2\x8b\xaf+sk).You are given a tree consisting of n vertices. Each vertex i has an integer ai written on it. We define the value of the simple path from vertex u to vertex v as follows: consider all vertices appearing on the path from u to v, write down all the numbers written on these vertices in the order they appear on the path, and compute the sum of prefix sums of the resulting sequence.Your task is to calculate the maximum value over all paths in the tree." 2700.0                                      
          1303A "Erasing Zeroes" implementation,strings "You are given a string s. Each character is either 0 or 1.You want all 1\'s in the string to form a contiguous subsegment. For example, if the string is 0, 1, 00111 or 01111100, then all 1\'s form a contiguous subsegment, and if the string is 0101, 100001 or 11111111111101, then this condition is not met.You may erase some (possibly none) 0\'s from the string. What is the minimum number of 0\'s that you have to erase?" 800.0                                      
          1302J "Keep talking and nobody explodes -- hard"  "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543You have the safe lock which consists of 100 decimal digits. If you rotate some digit, it increases by one, except 9 which becomes 0.Initially, the lock contains number x. To unlock the safe you must do the following operations in order (and be careful, don\'t mix up if and else statements).If digit 39 is odd, rotate digit 39 by 9 times, else rotate digit 37 by 1 times. If digit 24 is odd, rotate digit 24 by 1 times, else rotate digit 76 by 3 times. If sum of digits 13 and 91 is greater than 10, rotate digit 14 by 6 times, else rotate digit 34 by 8 times. If digit 87 is odd, rotate digit 87 by 7 times, else rotate digit 22 by 9 times. If digit 79 is greater than digit 15, rotate digit 74 by 7 times, else rotate digit 84 by 6 times. If sum of digits 26 and 66 is greater than 9, rotate digit 31 by 7 times, else rotate digit 95 by 4 times. If sum of digits 53 and 1 is greater than 8, rotate digit 66 by 1 times, else rotate digit 94 by 6 times. If digit 41 is greater than digit 29, rotate digit 67 by 5 times, else rotate digit 41 by 9 times. If sum of digits 79 and 20 is greater than 10, rotate digit 18 by 2 times, else rotate digit 72 by 9 times. If sum of digits 14 and 24 is greater than 10, rotate digit 64 by 2 times, else rotate digit 84 by 2 times. If digit 16 is greater than digit 34, rotate digit 81 by 5 times, else rotate digit 15 by 2 times. If sum of digits 48 and 65 is greater than 9, rotate digit 57 by 2 times, else rotate digit 28 by 5 times. If digit 81 is odd, rotate digit 81 by 5 times, else rotate digit 25 by 4 times. If digit 70 is odd, rotate digit 70 by 9 times, else rotate digit 93 by 3 times. If sum of digits 92 and 49 is greater than 9, rotate digit 81 by 2 times, else rotate digit 42 by 3 times. If digit 96 is greater than digit 20, rotate digit 45 by 4 times, else rotate digit 45 by 1 times. If digit 91 is greater than digit 21, rotate digit 60 by 3 times, else rotate digit 72 by 1 times. If digit 89 is greater than digit 7, rotate digit 98 by 9 times, else rotate digit 52 by 7 times. If digit 38 is greater than digit 97, rotate digit 92 by 6 times, else rotate digit 35 by 4 times. If digit 96 is greater than digit 99, rotate digit 42 by 4 times, else rotate digit 40 by 9 times. If digit 86 is odd, rotate digit 86 by 1 times, else rotate digit 14 by 3 times. If digit 23 is odd, rotate digit 23 by 5 times, else rotate digit 55 by 9 times. If digit 79 is odd, rotate digit 79 by 1 times, else rotate digit 29 by 8 times. If digit 4 is greater than digit 91, rotate digit 98 by 8 times, else rotate digit 69 by 4 times. If digit 93 is greater than digit 24, rotate digit 75 by 9 times, else rotate digit 95 by 3 times. If sum of digits 32 and 50 is greater than 10, rotate digit 91 by 3 times, else rotate digit 1 by 5 times. If digit 81 is greater than digit 31, rotate digit 86 by 7 times, else rotate digit 67 by 5 times. If digit 83 is greater than digit 86, rotate digit 48 by 7 times, else rotate digit 2 by 6 times. If digit 20 is greater than digit 88, rotate digit 9 by 2 times, else rotate digit 99 by 4 times. If digit 14 is odd, rotate digit 14 by 5 times, else rotate digit 97 by 7 times. If digit 38 is greater than digit 14, rotate digit 48 by 2 times, else rotate digit 81 by 5 times. If digit 92 is greater than digit 74, rotate digit 92 by 1 times, else rotate digit 50 by 9 times. If digit 76 is greater than digit 89, rotate digit 68 by 6 times, else rotate digit 69 by 5 times. If digit 2 is greater than digit 28, rotate digit 75 by 1 times, else rotate digit 89 by 1 times. If digit 67 is odd, rotate digit 67 by 9 times, else rotate digit 49 by 1 times. If digit 23 is odd, rotate digit 23 by 1 times, else rotate digit 59 by 3 times. If digit 81 is odd, rotate digit 81 by 9 times, else rotate digit 9 by 4 times. If sum of digits 92 and 82 is greater than 9, rotate digit 81 by 2 times, else rotate digit 91 by 5 times. If sum of digits 42 and 48 is greater than 9, rotate digit 35 by 8 times, else rotate digit 59 by 6 times. If digit 55 is odd, rotate digit 55 by 9 times, else rotate digit 61 by 6 times. If digit 83 is odd, rotate digit 83 by 5 times, else rotate digit 85 by 4 times. If digit 96 is odd, rotate digit 96 by 1 times, else rotate digit 72 by 4 times. If digit 17 is odd, rotate digit 17 by 1 times, else rotate digit 28 by 3 times. If digit 85 is greater than digit 74, rotate digit 37 by 3 times, else rotate digit 10 by 3 times. If sum of digits 50 and 67 is greater than 9, rotate digit 85 by 9 times, else rotate digit 42 by 4 times. If sum of digits 11 and 43 is greater than 10, rotate digit 56 by 7 times, else rotate digit 50 by 7 times. If sum of digits 95 and 64 is greater than 9, rotate digit 95 by 4 times, else rotate digit 95 by 9 times. If sum of digits 21 and 16 is greater than 9, rotate digit 87 by 3 times, else rotate digit 30 by 1 times. If digit 91 is odd, rotate digit 91 by 1 times, else rotate digit 77 by 1 times. If digit 95 is greater than digit 82, rotate digit 53 by 2 times, else rotate digit 100 by 5 times. If sum of digits 88 and 66 is greater than 10, rotate digit 34 by 4 times, else rotate digit 57 by 4 times. If digit 73 is greater than digit 84, rotate digit 52 by 3 times, else rotate digit 42 by 9 times. If digit 66 is greater than digit 38, rotate digit 94 by 7 times, else rotate digit 78 by 7 times. If digit 23 is greater than digit 12, rotate digit 78 by 2 times, else rotate digit 62 by 8 times. If digit 13 is greater than digit 9, rotate digit 42 by 7 times, else rotate digit 1 by 9 times. If digit 43 is greater than digit 29, rotate digit 20 by 2 times, else rotate digit 47 by 2 times. If sum of digits 100 and 51 is greater than 8, rotate digit 10 by 6 times, else rotate digit 89 by 1 times. If digit 19 is greater than digit 37, rotate digit 26 by 7 times, else rotate digit 30 by 8 times. If digit 73 is greater than digit 25, rotate digit 77 by 3 times, else rotate digit 41 by 1 times. If sum of digits 67 and 96 is greater than 10, rotate digit 47 by 6 times, else rotate digit 33 by 5 times. If digit 11 is greater than digit 10, rotate digit 33 by 3 times, else rotate digit 4 by 3 times. If digit 85 is odd, rotate digit 85 by 7 times, else rotate digit 37 by 9 times. If digit 14 is odd, rotate digit 14 by 1 times, else rotate digit 28 by 4 times. If sum of digits 30 and 18 is greater than 8, rotate digit 93 by 5 times, else rotate digit 68 by 1 times. If sum of digits 54 and 72 is greater than 8, rotate digit 88 by 8 times, else rotate digit 25 by 8 times. If digit 72 is odd, rotate digit 72 by 5 times, else rotate digit 10 by 3 times. If digit 15 is odd, rotate digit 15 by 3 times, else rotate digit 68 by 1 times. If sum of digits 81 and 31 is greater than 9, rotate digit 2 by 5 times, else rotate digit 35 by 1 times. If digit 57 is odd, rotate digit 57 by 1 times, else rotate digit 25 by 9 times. If sum of digits 75 and 51 is greater than 9, rotate digit 73 by 8 times, else rotate digit 49 by 1 times. If sum of digits 81 and 61 is greater than 10, rotate digit 61 by 3 times, else rotate digit 88 by 1 times. If digit 60 is odd, rotate digit 60 by 1 times, else rotate digit 31 by 2 times. If digit 93 is odd, rotate digit 93 by 5 times, else rotate digit 50 by 1 times. If sum of digits 19 and 82 is greater than 9, rotate digit 48 by 7 times, else rotate digit 88 by 8 times. If digit 45 is odd, rotate digit 45 by 7 times, else rotate digit 100 by 1 times. If digit 46 is greater than digit 71, rotate digit 28 by 8 times, else rotate digit 37 by 6 times. If digit 79 is odd, rotate digit 79 by 5 times, else rotate digit 10 by 1 times. If digit 19 is greater than digit 95, rotate digit 76 by 9 times, else rotate digit 95 by 8 times. If digit 49 is odd, rotate digit 49 by 5 times, else rotate digit 66 by 3 times. If digit 62 is odd, rotate digit 62 by 1 times, else rotate digit 26 by 8 times. If digit 67 is greater than digit 33, rotate digit 27 by 8 times, else rotate digit 96 by 2 times. If sum of digits 73 and 15 is greater than 8, rotate digit 98 by 6 times, else rotate digit 11 by 6 times. If digit 63 is greater than digit 42, rotate digit 66 by 1 times, else rotate digit 58 by 2 times. If digit 41 is odd, rotate digit 41 by 9 times, else rotate digit 99 by 5 times. If digit 93 is odd, rotate digit 93 by 5 times, else rotate digit 53 by 1 times. If digit 46 is odd, rotate digit 46 by 3 times, else rotate digit 64 by 4 times. If sum of digits 99 and 64 is greater than 10, rotate digit 72 by 9 times, else rotate digit 51 by 5 times. If digit 75 is greater than digit 23, rotate digit 89 by 2 times, else rotate digit 76 by 7 times. If digit 6 is odd, rotate digit 6 by 1 times, else rotate digit 44 by 6 times. If digit 58 is odd, rotate digit 58 by 3 times, else rotate digit 49 by 9 times. If digit 5 is greater than digit 13, rotate digit 46 by 9 times, else rotate digit 21 by 7 times. If sum of digits 44 and 94 is greater than 9, rotate digit 36 by 4 times, else rotate digit 15 by 3 times. If sum of digits 52 and 43 is greater than 8, rotate digit 29 by 8 times, else rotate digit 72 by 6 times. If sum of digits 87 and 48 is greater than 9, rotate digit 61 by 8 times, else rotate digit 14 by 3 times. If digit 81 is odd, rotate digit 81 by 7 times, else rotate digit 64 by 2 times. If digit 88 is odd, rotate digit 88 by 7 times, else rotate digit 53 by 9 times. If sum of digits 86 and 78 is greater than 10, rotate digit 96 by 7 times, else rotate digit 79 by 1 times. If digit 20 is odd, rotate digit 20 by 7 times, else rotate digit 2 by 7 times. If digit 77 is greater than digit 80, rotate digit 60 by 5 times, else rotate digit 38 by 8 times. If digit 65 is odd, rotate digit 65 by 1 times, else rotate digit 85 by 3 times." -999.0                                      
          1302G "Keep talking and nobody explodes -- medium"  "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543You have the safe lock which consists of 5 decimal digits. If you rotate some digit, it increases by one, except 9 which becomes 0.Initially, the lock contains number x. To unlock the safe you must do the following operations in order (and be careful, don\'t mix up if and else statements).If sum of digits on positions 3 and 4 is greater than 10, rotate digit on position 2 by 9 times, else rotate digit on position 5 by 4 times.If digit on position 3 is greater than digit on position 5, rotate digit on position 2 by 4 times, else rotate digit on position 4 by 6 times.If digit on position 5 is greater than digit on position 3, rotate digit on position 2 by 1 times, else rotate digit on position 1 by 7 times.If sum of digits on positions 4 and 1 is greater than 8, rotate digit on position 2 by 7 times, else rotate digit on position 3 by 3 times.If digit on position 4 is greater than digit on position 1, rotate digit on position 2 by 3 times, else rotate digit on position 3 by 2 times.If sum of digits on positions 1 and 2 is greater than 9, rotate digit on position 3 by 6 times, else rotate digit on position 5 by 3 times.If digit on position 3 is greater than digit on position 2, rotate digit on position 1 by 2 times, else rotate digit on position 4 by 5 times.If digit on position 5 is greater than digit on position 3, rotate digit on position 2 by 1 times, else rotate digit on position 4 by 5 times.If sum of digits on positions 5 and 1 is greater than 10, rotate digit on position 4 by 7 times, else rotate digit on position 3 by 5 times.If sum of digits on positions 5 and 4 is greater than 9, rotate digit on position 3 by 9 times, else rotate digit on position 2 by 4 times.If sum of digits on positions 3 and 1 is greater than 8, rotate digit on position 2 by 8 times, else rotate digit on position 4 by 4 times.If digit on position 5 is greater than digit on position 2, rotate digit on position 1 by 5 times, else rotate digit on position 3 by 8 times.If sum of digits on positions 1 and 4 is greater than 10, rotate digit on position 3 by 4 times, else rotate digit on position 5 by 1 times.If digit on position 3 is greater than digit on position 5, rotate digit on position 2 by 1 times, else rotate digit on position 1 by 6 times.If sum of digits on positions 1 and 5 is greater than 9, rotate digit on position 3 by 3 times, else rotate digit on position 2 by 1 times.If digit on position 5 is greater than digit on position 1, rotate digit on position 4 by 8 times, else rotate digit on position 2 by 1 times.If digit on position 4 is greater than digit on position 1, rotate digit on position 3 by 4 times, else rotate digit on position 5 by 4 times.If sum of digits on positions 3 and 1 is greater than 8, rotate digit on position 5 by 3 times, else rotate digit on position 2 by 6 times.If digit on position 3 is greater than digit on position 4, rotate digit on position 2 by 3 times, else rotate digit on position 1 by 5 times.If digit on position 5 is greater than digit on position 4, rotate digit on position 2 by 7 times, else rotate digit on position 3 by 8 times.If digit on position 2 is greater than digit on position 4, rotate digit on position 5 by 9 times, else rotate digit on position 1 by 4 times.If sum of digits on positions 3 and 5 is greater than 10, rotate digit on position 4 by 1 times, else rotate digit on position 2 by 5 times.If digit on position 4 is greater than digit on position 1, rotate digit on position 3 by 9 times, else rotate digit on position 2 by 9 times.If digit on position 5 is greater than digit on position 3, rotate digit on position 2 by 4 times, else rotate digit on position 1 by 6 times.If sum of digits on positions 3 and 4 is greater than 9, rotate digit on position 5 by 8 times, else rotate digit on position 2 by 5 times.If sum of digits on positions 3 and 4 is greater than 10, rotate digit on position 5 by 2 times, else rotate digit on position 1 by 5 times.If sum of digits on positions 5 and 4 is greater than 9, rotate digit on position 3 by 3 times, else rotate digit on position 1 by 8 times.If digit on position 5 is greater than digit on position 2, rotate digit on position 1 by 4 times, else rotate digit on position 3 by 8 times.If digit on position 3 is greater than digit on position 1, rotate digit on position 5 by 6 times, else rotate digit on position 2 by 6 times.If digit on position 4 is greater than digit on position 5, rotate digit on position 1 by 6 times, else rotate digit on position 3 by 1 times.If sum of digits on positions 3 and 5 is greater than 10, rotate digit on position 2 by 5 times, else rotate digit on position 1 by 7 times.If sum of digits on positions 5 and 2 is greater than 9, rotate digit on position 4 by 9 times, else rotate digit on position 3 by 5 times.If sum of digits on positions 2 and 4 is greater than 10, rotate digit on position 3 by 1 times, else rotate digit on position 1 by 2 times.If digit on position 3 is greater than digit on position 4, rotate digit on position 5 by 7 times, else rotate digit on position 2 by 1 times.If digit on position 2 is greater than digit on position 5, rotate digit on position 1 by 6 times, else rotate digit on position 4 by 2 times.If digit on position 2 is greater than digit on position 1, rotate digit on position 5 by 3 times, else rotate digit on position 4 by 4 times.If digit on position 5 is greater than digit on position 4, rotate digit on position 3 by 9 times, else rotate digit on position 1 by 9 times.If digit on position 1 is greater than digit on position 5, rotate digit on position 4 by 6 times, else rotate digit on position 2 by 5 times.If sum of digits on positions 1 and 5 is greater than 10, rotate digit on position 3 by 7 times, else rotate digit on position 2 by 4 times.If sum of digits on positions 2 and 1 is greater than 9, rotate digit on position 3 by 7 times, else rotate digit on position 5 by 4 times." -999.0                                      
          1301F "Super Jaber" "dfs and similar,graphs,implementation,shortest paths" "Jaber is a superhero in a large country that can be described as a grid with n rows and m columns, where every cell in that grid contains a different city.Jaber gave every city in that country a specific color between 1 and k. In one second he can go from the current city to any of the cities adjacent by the side or to any city with the same color as the current city color.Jaber has to do q missions. In every mission he will be in the city at row r1 and column c1, and he should help someone in the city at row r2 and column c2.Jaber wants your help to tell him the minimum possible time to go from the starting city to the finishing city for every mission." 2600.0                                      
          1299E "So Mean" interactive,math "This problem is interactive.We have hidden a permutation p1,p2,\xe2\x80\xa6,pn of numbers from 1 to n from you, where n is even. You can try to guess it using the following queries:? k a1 a2 \xe2\x80\xa6 ak.In response, you will learn if the average of elements with indexes a1,a2,\xe2\x80\xa6,ak is an integer. In other words, you will receive 1 if pa1+pa2+\xe2\x8b\xaf+pakk is integer, and 0 otherwise. You have to guess the permutation. You can ask not more than 18n queries.Note that permutations [p1,p2,\xe2\x80\xa6,pk] and [n+1\xe2\x88\x92p1,n+1\xe2\x88\x92p2,\xe2\x80\xa6,n+1\xe2\x88\x92pk] are indistinguishable. Therefore, you are guaranteed that p1\xe2\x89\xa4n2.Note that the permutation p is fixed before the start of the interaction and doesn\'t depend on your queries. In other words, interactor is not adaptive.Note that you don\'t have to minimize the number of queries." 3400.0                                      
          1294F "Three Paths on a Tree" "dfs and similar,dp,greedy,trees" "You are given an unweighted tree with n vertices. Recall that a tree is a connected undirected graph without cycles.Your task is to choose three distinct vertices a,b,c on this tree such that the number of edges which belong to at least one of the simple paths between a and b, b and c, or a and c is the maximum possible. See the notes section for a better understanding.The simple path is the path that visits each vertex at most once." 2000.0                                      
          1294D "MEX maximizing" "data structures,greedy,implementation,math" "Recall that MEX of an array is a minimum non-negative integer that does not belong to the array. Examples:  for the array [0,0,1,0,2] MEX equals to 3 because numbers 0,1 and 2 are presented in the array and 3 is the minimum non-negative integer not presented in the array;  for the array [1,2,3,4] MEX equals to 0 because 0 is the minimum non-negative integer not presented in the array;  for the array [0,1,4,3] MEX equals to 2 because 2 is the minimum non-negative integer not presented in the array. You are given an empty array a=[] (in other words, a zero-length array). You are also given a positive integer x.You are also given q queries. The j-th query consists of one integer yj and means that you have to append one element yj to the array. The array length increases by 1 after a query.In one move, you can choose any index i and set ai:=ai+x or ai:=ai\xe2\x88\x92x (i.e. increase or decrease any element of the array by x). The only restriction is that ai cannot become negative. Since initially the array is empty, you can perform moves only after the first query.You have to maximize the MEX (minimum excluded) of the array if you can perform any number of such operations (you can even perform the operation multiple times with one element).You have to find the answer after each of q queries (i.e. the j-th answer corresponds to the array of length j).Operations are discarded before each query. I.e. the array a after the j-th query equals to [y1,y2,\xe2\x80\xa6,yj]." 1600.0                                      
          1294C "Product of Three Numbers" "greedy,math,number theory" "You are given one integer number n. Find three distinct integers a,b,c such that 2\xe2\x89\xa4a,b,c and a\xe2\x8b\x85b\xe2\x8b\x85c=n or say that it is impossible to do it.If there are several answers, you can print any.You have to answer t independent test cases." 1300.0                                      
          1288B "Yet Another Meme Problem" math "You are given two integers A and B, calculate the number of pairs (a,b) such that 1\xe2\x89\xa4a\xe2\x89\xa4A, 1\xe2\x89\xa4b\xe2\x89\xa4B, and the equation a\xe2\x8b\x85b+a+b=conc(a,b) is true; conc(a,b) is the concatenation of a and b (for example, conc(12,23)=1223, conc(100,11)=10011). a and b should not contain leading zeroes." 1100.0                                      
          1285B "Just Eat It!" dp,greedy,implementation "Today, Yasser and Adel are at the shop buying cupcakes. There are n cupcake types, arranged from 1 to n on the shelf, and there are infinitely many of each type. The tastiness of a cupcake of type i is an integer ai. There are both tasty and nasty cupcakes, so the tastiness can be positive, zero or negative.Yasser, of course, wants to try them all, so he will buy exactly one cupcake of each type.On the other hand, Adel will choose some segment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) that does not include all of cupcakes (he can\'t choose [l,r]=[1,n]) and buy exactly one cupcake of each of types l,l+1,\xe2\x80\xa6,r.After that they will compare the total tastiness of the cupcakes each of them have bought. Yasser will be happy if the total tastiness of cupcakes he buys is strictly greater than the total tastiness of cupcakes Adel buys regardless of Adel\'s choice.For example, let the tastinesses of the cupcakes be [7,4,\xe2\x88\x921]. Yasser will buy all of them, the total tastiness will be 7+4\xe2\x88\x921=10. Adel can choose segments [7],[4],[\xe2\x88\x921],[7,4] or [4,\xe2\x88\x921], their total tastinesses are 7,4,\xe2\x88\x921,11 and 3, respectively. Adel can choose segment with tastiness 11, and as 10 is not strictly greater than 11, Yasser won\'t be happy :(Find out if Yasser will be happy after visiting the shop." 1300.0                                      
          1285A "Mezo Playing Zoma" math "Today, Mezo is playing a game. Zoma, a character in that game, is initially at position x=0. Mezo starts sending n commands to Zoma. There are two possible commands:  \'L\' (Left) sets the position x:=x\xe2\x88\x921;  \'R\' (Right) sets the position x:=x+1. Unfortunately, Mezo\'s controller malfunctions sometimes. Some commands are sent successfully and some are ignored. If the command is ignored then the position x doesn\'t change and Mezo simply proceeds to the next command.For example, if Mezo sends commands ""LRLR"", then here are some possible outcomes (underlined commands are sent successfully):   ""LRLR"" \xe2\x80\x94 Zoma moves to the left, to the right, to the left again and to the right for the final time, ending up at position 0;  ""LRLR"" \xe2\x80\x94 Zoma recieves no commands, doesn\'t move at all and ends up at position 0 as well;  ""LRLR"" \xe2\x80\x94 Zoma moves to the left, then to the left again and ends up in position \xe2\x88\x922. Mezo doesn\'t know which commands will be sent successfully beforehand. Thus, he wants to know how many different positions may Zoma end up at." 800.0                                      
          1282B2 "K for the Price of One (Hard Version)" dp,greedy,sortings "This is the hard version of this problem. The only difference is the constraint on k \xe2\x80\x94 the number of gifts in the offer. In this version: 2\xe2\x89\xa4k\xe2\x89\xa4n.Vasya came to the store to buy goods for his friends for the New Year. It turned out that he was very lucky \xe2\x80\x94 today the offer ""k of goods for the price of one"" is held in store.Using this offer, Vasya can buy exactly k of any goods, paying only for the most expensive of them. Vasya decided to take this opportunity and buy as many goods as possible for his friends with the money he has.More formally, for each good, its price is determined by ai \xe2\x80\x94 the number of coins it costs. Initially, Vasya has p coins. He wants to buy the maximum number of goods. Vasya can perform one of the following operations as many times as necessary:  Vasya can buy one good with the index i if he currently has enough coins (i.e p\xe2\x89\xa5ai). After buying this good, the number of Vasya\'s coins will decrease by ai, (i.e it becomes p:=p\xe2\x88\x92ai).  Vasya can buy a good with the index i, and also choose exactly k\xe2\x88\x921 goods, the price of which does not exceed ai, if he currently has enough coins (i.e p\xe2\x89\xa5ai). Thus, he buys all these k goods, and his number of coins decreases by ai (i.e it becomes p:=p\xe2\x88\x92ai). Please note that each good can be bought no more than once.For example, if the store now has n=5 goods worth a1=2,a2=4,a3=3,a4=5,a5=7, respectively, k=2, and Vasya has 6 coins, then he can buy 3 goods. A good with the index 1 will be bought by Vasya without using the offer and he will pay 2 coins. Goods with the indices 2 and 3 Vasya will buy using the offer and he will pay 4 coins. It can be proved that Vasya can not buy more goods with six coins.Help Vasya to find out the maximum number of goods he can buy." 1600.0                                      
          1280F "Intergalactic Sliding Puzzle" "combinatorics,constructive algorithms,math" "You are an intergalactic surgeon and you have an alien patient. For the purposes of this problem, we can and we will model this patient\'s body using a 2\xc3\x97(2k+1) rectangular grid. The alien has 4k+1 distinct organs, numbered 1 to 4k+1.In healthy such aliens, the organs are arranged in a particular way. For example, here is how the organs of a healthy such alien would be positioned, when viewed from the top, for k=4:  Here, the E represents empty space. In general, the first row contains organs 1 to 2k+1 (in that order from left to right), and the second row contains organs 2k+2 to 4k+1 (in that order from left to right) and then empty space right after. Your patient\'s organs are complete, and inside their body, but they somehow got shuffled around! Your job, as an intergalactic surgeon, is to put everything back in its correct position. All organs of the alien must be in its body during the entire procedure. This means that at any point during the procedure, there is exactly one cell (in the grid) that is empty. In addition, you can only move organs around by doing one of the following things:  You can switch the positions of the empty space E with any organ to its immediate left or to its immediate right (if they exist). In reality, you do this by sliding the organ in question to the empty space;  You can switch the positions of the empty space E with any organ to its immediate top or its immediate bottom (if they exist) only if the empty space is on the leftmost column, rightmost column or in the centermost column. Again, you do this by sliding the organ in question to the empty space. Your job is to figure out a sequence of moves you must do during the surgical procedure in order to place back all 4k+1 internal organs of your patient in the correct cells. If it is impossible to do so, you must say so." 3400.0                                      
          1280E "Kirchhoff\'s Current Loss" math "Your friend Kirchhoff is shocked with the current state of electronics design.""Ohmygosh! Watt is wrong with the field? All these circuits are inefficient! There\'s so much capacity for improvement. The electrical engineers must not conduct their classes very well. It\'s absolutely revolting"" he said.The negativity just keeps flowing out of him, but even after complaining so many times he still hasn\'t lepton the chance to directly change anything.""These circuits have too much total resistance. Wire they designed this way? It\'s just causing a massive loss of resistors! Their entire field could conserve so much money if they just maximized the potential of their designs. Why can\'t they just try alternative ideas?""The frequency of his protests about the electrical engineering department hertz your soul, so you have decided to take charge and help them yourself. You plan to create a program that will optimize the circuits while keeping the same circuit layout and maintaining the same effective resistance.A circuit has two endpoints, and is associated with a certain constant, RR, called its effective resistance. The circuits we\'ll consider will be formed from individual resistors joined together in series or in parallel, forming more complex circuits. The following image illustrates combining circuits in series or parallel.   According to your friend Kirchhoff, the effective resistance can be calculated quite easily when joining circuits this way:  When joining kk circuits in series with effective resistances R1,R2,\xe2\x80\xa6,RkR1,R2,\xe2\x80\xa6,Rk, the effective resistance RR of the resulting circuit is the sum R=R1+R2+\xe2\x80\xa6+Rk.R=R1+R2+\xe2\x80\xa6+Rk.  When joining kk circuits in parallel with effective resistances R1,R2,\xe2\x80\xa6,RkR1,R2,\xe2\x80\xa6,Rk, the effective resistance RR of the resulting circuit is found by solving for RR in 1R=1R1+1R2+\xe2\x80\xa6+1Rk,1R=1R1+1R2+\xe2\x80\xa6+1Rk, assuming all Ri>0Ri>0; if at least one Ri=0Ri=0, then the effective resistance of the whole circuit is simply R=0R=0. Circuits will be represented by strings. Individual resistors are represented by an asterisk, ""*"". For more complex circuits, suppose s1,s2,\xe2\x80\xa6,sks1,s2,\xe2\x80\xa6,sk represent k\xe2\x89\xa52k\xe2\x89\xa52 circuits. Then:  ""(s1s1 S s2s2 S \xe2\x80\xa6\xe2\x80\xa6 S sksk)"" represents their series circuit;  ""(s1s1 P s2s2 P \xe2\x80\xa6\xe2\x80\xa6 P sksk)"" represents their parallel circuit. For example, ""(* P (* S *) P *)"" represents the following circuit:  Given a circuit, your task is to assign the resistances of the individual resistors such that they satisfy the following requirements:  Each individual resistor has a nonnegative integer resistance value;  The effective resistance of the whole circuit is rr;  The sum of the resistances of the individual resistors is minimized. If there are nn individual resistors, then you need to output the list r1,r2,\xe2\x80\xa6,rnr1,r2,\xe2\x80\xa6,rn (0\xe2\x89\xa4ri0\xe2\x89\xa4ri, and riri is an integer), where riri is the resistance assigned to the ii-th individual resistor that appears in the input (from left to right). If it is impossible to accomplish the task, you must say so as well.If it is possible, then it is guaranteed that the minimum sum of resistances is at most 10181018." 2900.0                                      
          1280A "Cut and Paste" implementation,math "We start with a string s consisting only of the digits 1, 2, or 3. The length of s is denoted by |s|. For each i from 1 to |s|, the i-th character of s is denoted by si. There is one cursor. The cursor\'s location \xe2\x84\x93 is denoted by an integer in {0,\xe2\x80\xa6,|s|}, with the following meaning:   If \xe2\x84\x93=0, then the cursor is located before the first character of s.  If \xe2\x84\x93=|s|, then the cursor is located right after the last character of s.  If 0<\xe2\x84\x93<|s|, then the cursor is located between s\xe2\x84\x93 and s\xe2\x84\x93+1. We denote by sleft the string to the left of the cursor and sright the string to the right of the cursor. We also have a string c, which we call our clipboard, which starts out as empty. There are three types of actions:  The Move action. Move the cursor one step to the right. This increments \xe2\x84\x93 once.  The Cut action. Set c\xe2\x86\x90sright, then set s\xe2\x86\x90sleft.  The Paste action. Append the value of c to the end of the string s. Note that this doesn\'t modify c. The cursor initially starts at \xe2\x84\x93=0. Then, we perform the following procedure:  Perform the Move action once.  Perform the Cut action once.  Perform the Paste action s\xe2\x84\x93 times.  If \xe2\x84\x93=x, stop. Otherwise, return to step 1. You\'re given the initial string s and the integer x. What is the length of s when the procedure stops? Since this value may be very large, only find it modulo 109+7. It is guaranteed that \xe2\x84\x93\xe2\x89\xa4|s| at any time." 1700.0                                      
          1279C "Stack of Presents" "data structures,implementation" "Santa has to send presents to the kids. He has a large stack of n presents, numbered from 1 to n; the topmost present has number a1, the next present is a2, and so on; the bottom present has number an. All numbers are distinct.Santa has a list of m distinct presents he has to send: b1, b2, ..., bm. He will send them in the order they appear in the list.To send a present, Santa has to find it in the stack by removing all presents above it, taking this present and returning all removed presents on top of the stack. So, if there are k presents above the present Santa wants to send, it takes him 2k+1 seconds to do it. Fortunately, Santa can speed the whole process up \xe2\x80\x94 when he returns the presents to the stack, he may reorder them as he wishes (only those which were above the present he wanted to take; the presents below cannot be affected in any way).What is the minimum time required to send all of the presents, provided that Santa knows the whole list of presents he has to send and reorders the presents optimally? Santa cannot change the order of presents or interact with the stack of presents in any other way.Your program has to answer t different test cases." 1400.0                                      
          1276E "Four Stones" "constructive algorithms" "There are four stones on an infinite line in integer coordinates a1,a2,a3,a4. The goal is to have the stones in coordinates b1,b2,b3,b4. The order of the stones does not matter, that is, a stone from any position ai can end up in at any position bj, provided there is a required number of stones in each position (that is, if a coordinate x appears k times among numbers b1,\xe2\x80\xa6,b4, there should be exactly k stones at x in the end).We are allowed to move stones with the following operation: choose two stones at distinct positions x and y with at least one stone each, and move one stone from x to 2y\xe2\x88\x92x. In other words, the operation moves a stone to a symmetric position relative to some other stone. At any moment it is allowed to have any number of stones at the same position.Find any sequence of operations that achieves the goal, or determine that it is impossible. The sequence does not have to be shortest, but it may contain at most 1000 operations." 3500.0                                      
          1275C "#define \xd0\x97\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb0 B ..." "*special problem" "\xd0\x9a\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xc2\xab\xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5\xc2\xbb \xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd0\xb2\xd0\xbd\xd0\xbe \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd0\xb5\xd1\x82 \xd1\x8f\xd0\xb7\xd1\x8b\xd0\xba\xd0\xb8 C/C++ \xd0\xb4\xd0\xbb\xd1\x8f \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xb2\xd0\xb8\xd0\xb6\xd0\xba\xd0\xbe\xd0\xb2. \xd0\xa1\xd1\x82\xd0\xb0\xd1\x80\xd1\x88\xd0\xb8\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x87\xd0\xb8\xd0\xba \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xe2\x80\x94 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xbe\xd0\xb9 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c \xd1\x8f\xd0\xb7\xd1\x8b\xd0\xba\xd0\xb0 C, \xd0\xb2\xd0\xb5\xd0\xb4\xd1\x8c \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xb2 \xd0\xbd\xd0\xb5\xd0\xbc \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c\xd1\x8e \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd1\x80\xd1\x8b\xd1\x82\xd1\x8c \xd0\xbf\xd0\xbe\xd1\x82\xd0\xb5\xd0\xbd\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb Define-Oriented Programming. \xd0\x92 \xd1\x8f\xd0\xb7\xd1\x8b\xd0\xba\xd0\xb5 C \xd0\xb4\xd0\xb8\xd1\x80\xd0\xb5\xd0\xba\xd1\x82\xd0\xb8\xd0\xb2\xd0\xb0 #define \xd0\xbf\xd0\xbe\xd0\xb7\xd0\xb2\xd0\xbe\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82 \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd1\x83\xd1\x8e \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 \xd0\xba\xd1\x83\xd1\x81\xd0\xba\xd0\xb0 \xd0\xba\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb2 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb5 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd1\x8b. \xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb9 v \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x80\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xbe 11 (\xd0\xb2 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x83\xd1\x8e v \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x88\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x80\xd0\xb5\xd0\xb7\xd1\x83\xd0\xbb\xd1\x8c\xd1\x82\xd0\xb0\xd1\x82 \xd0\xb2\xd1\x8b\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f 3+4\xe2\x8b\x852).#define add(x) + x#define mul(y) * yint v = 3 add(4) mul(2);\xd0\x9d\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xbe \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb0\xd0\xbb \xd0\xbd\xd0\xb5\xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd1\x83\xd1\x8e \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd1\x83, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xb0\xd1\x8f \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbd\xd1\x8f\xd0\xb5\xd1\x82 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x81\xd0\xb8\xd0\xb2 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xbe\xd0\xb9 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd1\x8b. \xd0\x9f\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd0\xb0 \xd0\xb2\xd1\x8b\xd0\xb3\xd0\xbb\xd1\x8f\xd0\xb4\xd0\xb8\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc:#define A0(x) x,#define A1(x) A0(x) A0(x + 1) A0(x + 3) A0(x + 4)#define A2(x) A1(x) A1(x + 1) A1(x + 3) A1(x + 4)#define A3(x) A2(x) A2(x + 1) A2(x + 3) A2(x + 4)#define A4(x) A3(x) A3(x + 1) A3(x + 3) A3(x + 4)...#define A24(x) A23(x) A23(x + 1) A23(x + 3) A23(x + 4)#define A25(x) A24(x) A24(x + 1) A24(x + 3) A24(x + 4)const long long values[1125899906842624] = { A25(0) };\xd0\x9a \xd1\x81\xd0\xbe\xd0\xb6\xd0\xb0\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8e, \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd0\xb0 \xd0\xbd\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb8\xd0\xbb\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x81\xd0\xb8\xd0\xbb\xd1\x83 \xd0\xbd\xd0\xb5\xd1\x81\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd1\x88\xd0\xb5\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xb0 \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd1\x8c\xd1\x8e\xd1\x82\xd0\xb5\xd1\x80\xd0\xb0, \xd0\xbd\xd0\xbe \xd0\xb5\xd0\xbc\xd1\x83 \xd0\xbe\xd1\x87\xd0\xb5\xd0\xbd\xd1\x8c \xd0\xb8\xd0\xbd\xd1\x82\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x82\xd1\x8c, \xd0\xba\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb0\xd0\xbb\xd0\xb8 \xd0\xb1\xd1\x8b \xd0\xb2 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x81\xd0\xb8\xd0\xb2\xd0\xb5 values, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb1\xd1\x8b \xd0\xb5\xd0\xbc\xd1\x83 \xd1\x83\xd0\xb4\xd0\xb0\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c \xd1\x81\xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb8\xd0\xbb\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xbf\xd1\x83\xd1\x81\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd1\x83. \xd0\x9f\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb5\xd0\xbc\xd1\x83 \xd1\x8d\xd1\x82\xd0\xbe \xd1\x83\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x82\xd1\x8c." -999.0                                      
          1275B "Code Review" "*special problem" "\xd0\xa3 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4\xd1\x8b \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xb2\xd0\xb8\xd0\xb6\xd0\xba\xd0\xbe\xd0\xb2 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xbe\xd0\xb1\xd1\x89\xd0\xb8\xd0\xb9 \xd1\x87\xd0\xb0\xd1\x82. \xd0\x9f\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xb2 \xd1\x80\xd0\xb5\xd0\xbf\xd0\xbe\xd0\xb7\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xb8\xd0\xb9, \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd1\x80 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xb8\xd1\x81\xd1\x8b\xd0\xbb\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb2 \xd1\x87\xd0\xb0\xd1\x82 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x81 \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8 \xd1\x80\xd0\xb5\xd0\xb2\xd1\x8c\xd1\x8e. \xd0\x94\xd0\xbb\xd1\x8f \xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbe\xd1\x82\xd0\xba\xd0\xbb\xd0\xbe\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb8\xd0\xbb \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x87\xd0\xb8\xd0\xba, \xd0\xbd\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xb2\xd1\x88\xd0\xb8\xd0\xb9 \xd1\x83\xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8\xd0\xb5 \xd0\xb2 \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8.\xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd1\x82\xd0\xb5\xd0\xbc, \xd0\xba\xd0\xb0\xd0\xba \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xbe\xd0\xb2\xd1\x83\xd1\x8e \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xba\xd1\x83 \xd0\xbd\xd0\xb0 \xd1\x80\xd0\xb5\xd0\xb2\xd1\x8c\xd1\x8e, \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x87\xd0\xb8\xd0\xba \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd1\x80\xd0\xb5\xd0\xb2\xd1\x8c\xd1\x8e \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xbe\xd0\xba, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb5\xd1\x89\xd0\xb5 \xd0\xbd\xd0\xb8\xd0\xba\xd0\xb5\xd0\xbc \xd0\xbd\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbd\xd1\x8b (\xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xe2\x80\x94 \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd \xd0\xbd\xd0\xb5 \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xba\xd0\xb8) \xd0\xb8 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xbe\xd0\xb2\xd1\x83\xd1\x8e \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xba\xd1\x83.\xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd \xd0\xbb\xd0\xbe\xd0\xb3 \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xbe\xd0\xba \xd0\xbd\xd0\xb0 \xd1\x80\xd0\xb5\xd0\xb2\xd1\x8c\xd1\x8e \xd1\x81 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0 \xd0\xbf\xd0\xbe\xd1\x8f\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x87\xd0\xb0\xd1\x82\xd0\xb0 \xd0\xb2 \xd1\x85\xd1\x80\xd0\xbe\xd0\xbd\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5. \xd0\x9d\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd1\x8b, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xbd\xd0\xb8\xd0\xba\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb8\xd0\xbb." -999.0                                      
          1275A "\xd0\xa1\xd0\xba\xd1\x80\xd1\x8b\xd1\x82\xd1\x8b\xd0\xb9 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3" "*special problem" "\xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd \xd0\xb3\xd1\x80\xd0\xb0\xd1\x84 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd0\xb5\xd0\xb9 VK. \xd0\x9d\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xbe \xd1\x83 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9 \xd0\xbf\xd0\xbe\xd1\x8f\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0\xd1\x81\xd1\x8c \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd1\x81\xd0\xba\xd1\x80\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd0\xb5\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xbe\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb3\xd1\x80\xd0\xb0\xd1\x84\xd0\xb0. \xd0\x94\xd0\xbb\xd1\x8f \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb3\xd1\x80\xd0\xb0\xd1\x84\xd0\xb0 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd0\xb5\xd0\xb9 \xd0\xbd\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd1\x81\xd0\xba\xd1\x80\xd1\x8b\xd1\x82\xd1\x8b\xd0\xb5 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb6\xd0\xb5\xd1\x81\xd0\xba\xd0\xb8\xd0\xb5 \xd1\x81\xd0\xb2\xd1\x8f\xd0\xb7\xd0\xb8, \xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x82\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5 \xd1\x81\xd0\xb8\xd1\x82\xd1\x83\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8, \xd0\xba\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c u \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd1\x8c\xd1\x8f\xd1\x85 \xd1\x83 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f v, \xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c v \xd0\xbd\xd0\xb5 \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd1\x8c\xd1\x8f\xd1\x85 \xd1\x83 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f u." -999.0                                      
          1272E "Nearest Opposite Parity" "dfs and similar,graphs,shortest paths" "You are given an array a consisting of n integers. In one move, you can jump from the position i to the position i\xe2\x88\x92ai (if 1\xe2\x89\xa4i\xe2\x88\x92ai) or to the position i+ai (if i+ai\xe2\x89\xa4n).For each position i from 1 to n you want to know the minimum the number of moves required to reach any position j such that aj has the opposite parity from ai (i.e. if ai is odd then aj has to be even and vice versa)." 1900.0                                      
          1272C "Yet Another Broken Keyboard" combinatorics,dp,implementation "Recently, Norge found a string s=s1s2\xe2\x80\xa6sn consisting of n lowercase Latin letters. As an exercise to improve his typing speed, he decided to type all substrings of the string s. Yes, all n(n+1)2 of them!A substring of s is a non-empty string x=s[a\xe2\x80\xa6b]=sasa+1\xe2\x80\xa6sb (1\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa4n). For example, ""auto"" and ""ton"" are substrings of ""automaton"".Shortly after the start of the exercise, Norge realized that his keyboard was broken, namely, he could use only k Latin letters c1,c2,\xe2\x80\xa6,ck out of 26.After that, Norge became interested in how many substrings of the string s he could still type using his broken keyboard. Help him to find this number." 1200.0                                      
          1270I "Xor on Figures" "constructive algorithms,fft,math" "There is given an integer k and a grid 2k\xc3\x972k with some numbers written in its cells, cell (i,j) initially contains number aij. Grid is considered to be a torus, that is, the cell to the right of (i,2k) is (i,1), the cell below the (2k,i) is (1,i) There is also given a lattice figure F, consisting of t cells, where t is odd. F doesn\'t have to be connected.We can perform the following operation: place F at some position on the grid. (Only translations are allowed, rotations and reflections are prohibited). Now choose any nonnegative integer p. After that, for each cell (i,j), covered by F, replace aij by aij\xe2\x8a\x95p, where \xe2\x8a\x95 denotes the bitwise XOR operation.More formally, let F be given by cells (x1,y1),(x2,y2),\xe2\x80\xa6,(xt,yt). Then you can do the following operation: choose any x,y with 1\xe2\x89\xa4x,y\xe2\x89\xa42k, any nonnegative integer p, and for every i from 1 to n replace number in the cell (((x+xi\xe2\x88\x921)mod2k)+1,((y+yi\xe2\x88\x921)mod2k)+1) with a((x+xi\xe2\x88\x921)mod2k)+1,((y+yi\xe2\x88\x921)mod2k)+1\xe2\x8a\x95p.Our goal is to make all the numbers equal to 0. Can we achieve it? If we can, find the smallest number of operations in which it is possible to do this." 3500.0                                      
          1270C "Make Good" "bitmasks,constructive algorithms,math" "Let\'s call an array a1,a2,\xe2\x80\xa6,am of nonnegative integer numbers good if a1+a2+\xe2\x8b\xaf+am=2\xe2\x8b\x85(a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x8b\xaf\xe2\x8a\x95am), where \xe2\x8a\x95 denotes the bitwise XOR operation.For example, array [1,2,3,6] is good, as 1+2+3+6=12=2\xe2\x8b\x856=2\xe2\x8b\x85(1\xe2\x8a\x952\xe2\x8a\x953\xe2\x8a\x956). At the same time, array [1,2,1,3] isn\'t good, as 1+2+1+3=7\xe2\x89\xa02\xe2\x8b\x851=2\xe2\x8b\x85(1\xe2\x8a\x952\xe2\x8a\x951\xe2\x8a\x953).You are given an array of length n: a1,a2,\xe2\x80\xa6,an. Append at most 3 elements to it to make it good. Appended elements don\'t have to be different. It can be shown that the solution always exists under the given constraints. If there are different solutions, you are allowed to output any of them. Note that you don\'t have to minimize the number of added elements!. So, if an array is good already you are allowed to not append elements." 1400.0                                      
          1270B "Interesting Subarray" "constructive algorithms,greedy,math" "For an array a of integers let\'s denote its maximal element as max(a), and minimal as min(a). We will call an array a of k integers interesting if max(a)\xe2\x88\x92min(a)\xe2\x89\xa5k. For example, array [1,3,4,3] isn\'t interesting as max(a)\xe2\x88\x92min(a)=4\xe2\x88\x921=3<4 while array [7,3,0,4,3] is as max(a)\xe2\x88\x92min(a)=7\xe2\x88\x920=7\xe2\x89\xa55.You are given an array a of n integers. Find some interesting nonempty subarray of a, or tell that it doesn\'t exist.An array b is a subarray of an array a if b can be obtained from a by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end. In particular, an array is a subarray of itself." 1200.0                                      
          1260D "A Game with Traps" "binary search,dp,greedy,sortings" "You are playing a computer game, where you lead a party of m soldiers. Each soldier is characterised by his agility ai.The level you are trying to get through can be represented as a straight line segment from point 0 (where you and your squad is initially located) to point n+1 (where the boss is located).The level is filled with k traps. Each trap is represented by three numbers li, ri and di. li is the location of the trap, and di is the danger level of the trap: whenever a soldier with agility lower than di steps on a trap (that is, moves to the point li), he gets instantly killed. Fortunately, you can disarm traps: if you move to the point ri, you disarm this trap, and it no longer poses any danger to your soldiers. Traps don\'t affect you, only your soldiers.You have t seconds to complete the level \xe2\x80\x94 that is, to bring some soldiers from your squad to the boss. Before the level starts, you choose which soldiers will be coming with you, and which soldiers won\'t be. After that, you have to bring all of the chosen soldiers to the boss. To do so, you may perform the following actions:  if your location is x, you may move to x+1 or x\xe2\x88\x921. This action consumes one second;  if your location is x and the location of your squad is x, you may move to x+1 or to x\xe2\x88\x921 with your squad in one second. You may not perform this action if it puts some soldier in danger (i.\xe2\x80\x89e. the point your squad is moving into contains a non-disarmed trap with di greater than agility of some soldier from the squad). This action consumes one second;  if your location is x and there is a trap i with ri=x, you may disarm this trap. This action is done instantly (it consumes no time). Note that after each action both your coordinate and the coordinate of your squad should be integers.You have to choose the maximum number of soldiers such that they all can be brought from the point 0 to the point n+1 (where the boss waits) in no more than t seconds." 1900.0                                      
          1256F "Equalizing Two Strings" "constructive algorithms,sortings,strings" "You are given two strings s and t both of length n and both consisting of lowercase Latin letters.In one move, you can choose any length len from 1 to n and perform the following operation:   Choose any contiguous substring of the string s of length len and reverse it;  at the same time choose any contiguous substring of the string t of length len and reverse it as well. Note that during one move you reverse exactly one substring of the string s and exactly one substring of the string t.Also note that borders of substrings you reverse in s and in t can be different, the only restriction is that you reverse the substrings of equal length. For example, if len=3 and n=5, you can reverse s[1\xe2\x80\xa63] and t[3\xe2\x80\xa65], s[2\xe2\x80\xa64] and t[2\xe2\x80\xa64], but not s[1\xe2\x80\xa63] and t[1\xe2\x80\xa62].Your task is to say if it is possible to make strings s and t equal after some (possibly, empty) sequence of moves.You have to answer q independent test cases." 2000.0                                      
          1255A "Changing Volume" math "Bob watches TV every day. He always sets the volume of his TV to b. However, today he is angry to find out someone has changed the volume to a. Of course, Bob has a remote control that can change the volume.There are six buttons (\xe2\x88\x925,\xe2\x88\x922,\xe2\x88\x921,+1,+2,+5) on the control, which in one press can either increase or decrease the current volume by 1, 2, or 5. The volume can be arbitrarily large, but can never be negative. In other words, Bob cannot press the button if it causes the volume to be lower than 0.As Bob is so angry, he wants to change the volume to b using as few button presses as possible. However, he forgets how to do such simple calculations, so he asks you for help. Write a program that given a and b, finds the minimum number of presses to change the TV volume from a to b." 800.0                                      
          1253F "Cheap Robot" "binary search,dsu,graphs,shortest paths,trees" "You\'re given a simple, undirected, connected, weighted graph with n nodes and m edges.Nodes are numbered from 1 to n. There are exactly k centrals (recharge points), which are nodes 1,2,\xe2\x80\xa6,k.We consider a robot moving into this graph, with a battery of capacity c, not fixed by the constructor yet. At any time, the battery contains an integer amount x of energy between 0 and c inclusive.Traversing an edge of weight wi is possible only if x\xe2\x89\xa5wi, and costs wi energy points (x:=x\xe2\x88\x92wi).Moreover, when the robot reaches a central, its battery is entirely recharged (x:=c).You\'re given q independent missions, the i-th mission requires to move the robot from central ai to central bi.For each mission, you should tell the minimum capacity required to acheive it." 2500.0                                      
          1252I "Mission Possible"  "Allen, a government secret service, has been assigned to infiltrate a mafia secret base to uncover crucial information regarding the mafia\'s operations.The secret base is a rectangular bounded by (xL,yL), (xL,yR), (xR,yL), and (xR,yR) in a Cartesian coordinate system where xL<xR and yL<yR. There are N sensors placed inside the secret base. The ith sensor is located at (xi,yi) and has an effective sensing radius of ri which can detect any person who is strictly within the radius of ri from (xi,yi). In other words, the ith sensor can detect a person at location (xa,ya) if and only if the Euclidean distance of (xi,yi) and (xa,ya) is strictly less than ri. It is also known that the Euclidean distance of any two sensors i and j is strictly larger than ri+rj. Note that the Euclidean distance of two points, (xa,ya) and (xb,yb), is \xe2\x88\x9a|xa\xe2\x88\x92xb|2+|ya\xe2\x88\x92yb|2.Allen begins his infiltration mission at location (xs,ys), and his target is located at (xt,yt). Allen has the power to run extremely fast in a straight line while he needs to spend extra time to change his running trajectory (to adjust his footing). Although he is a fast runner, he still needs to make sure that none of the sensors detect him while he is running, i.e. there is no point in his running trajectory which is strictly within a sensor effective sensing radius.Let P={(xp1,yp1),\xe2\x80\xa6,(xp|P|,yp|P|)} be the set of locations where Allen changes his running trajectory, thus, Allen\'s running trajectory with P is (xs,ys)\xe2\x86\x92(xp1,yp1)\xe2\x86\x92\xe2\x8b\xaf\xe2\x86\x92(xp|P|,yp|P|)\xe2\x86\x92(xt,yt) where (xa,ya)\xe2\x86\x92(xb,yb) implies that Allen is running from (xa,ya) to (xb,yb) in a straight line. The set P is feasible if and only if with P, Allen is not detected by any sensor and is not running out of the secret base (although, Allen is allowed to run along the secret base perimeter). Note that xp and yp, (xp,yp)\xe2\x88\x88P, are not necessarily integers; they can be real numbers.Your task in this problem is to find any one feasible P which contains no more than 1000 points." 3000.0                                      
          1252H "Twin Buildings" greedy,implementation "As you might already know, space has always been a problem in ICPC Jakarta. To cope with this, ICPC Jakarta is planning to build two new buildings. These buildings should have a shape of a rectangle of the same size. Now, their problem is to find land to build the buildings.There are N lands available for sale. The ith land has a rectangular shape of size Li\xc3\x97Wi. For a good feng shui, the building\'s side should be parallel to the land\'s sides.One way is to build the two buildings on two different lands, one on each land (not necessarily with the same orientation). A building of size A\xc3\x97B can be build on the ith land if and only if at least one of the following is satisfied:   A\xe2\x89\xa4Li and B\xe2\x89\xa4Wi, or  A\xe2\x89\xa4Wi and B\xe2\x89\xa4Li.  Alternatively, it is also possible to build two buildings of A\xc3\x97B on the ith land with the same orientation. Formally, it is possible to build two buildings of A\xc3\x97B on the ith land if and only if at least one of the following is satisfied:   A\xc3\x972\xe2\x89\xa4Li and B\xe2\x89\xa4Wi, or  A\xc3\x972\xe2\x89\xa4Wi and B\xe2\x89\xa4Li, or  A\xe2\x89\xa4Li and B\xc3\x972\xe2\x89\xa4Wi, or  A\xe2\x89\xa4Wi and B\xc3\x972\xe2\x89\xa4Li. Your task in this problem is to help ICPC Jakarta to figure out the largest possible buildings they can build given N available lands. Note that ICPC Jakarta has to build two buildings of A\xc3\x97B; output the largest possible for A\xc3\x97B." 1800.0                                      
          1252C "Even Path" "data structures,implementation" "Pathfinding is a task of finding a route between two points. It often appears in many problems. For example, in a GPS navigation software where a driver can query for a suggested route, or in a robot motion planning where it should find a valid sequence of movements to do some tasks, or in a simple maze solver where it should find a valid path from one point to another point. This problem is related to solving a maze.The maze considered in this problem is in the form of a matrix of integers A of N\xc3\x97N. The value of each cell is generated from a given array R and C of N integers each. Specifically, the value on the ith row and jth column, cell (i,j), is equal to Ri+Cj. Note that all indexes in this problem are from 1 to N.A path in this maze is defined as a sequence of cells (r1,c1),(r2,c2),\xe2\x80\xa6,(rk,ck) such that |ri\xe2\x88\x92ri+1|+|ci\xe2\x88\x92ci+1|=1 for all 1\xe2\x89\xa4i<k. In other words, each adjacent cell differs only by 1 row or only by 1 column. An even path in this maze is defined as a path in which all the cells in the path contain only even numbers.Given a tuple \xe2\x9f\xa8ra,ca,rb,cb\xe2\x9f\xa9 as a query, your task is to determine whether there exists an even path from cell (ra,ca) to cell (rb,cb). To simplify the problem, it is guaranteed that both cell (ra,ca) and cell (rb,cb) contain even numbers.For example, let N=5, R={6,2,7,8,3}, and C={3,4,8,5,1}. The following figure depicts the matrix A of 5\xc3\x975 which is generated from the given array R and C.  Let us consider several queries:   \xe2\x9f\xa82,2,1,3\xe2\x9f\xa9: There is an even path from cell (2,2) to cell (1,3), e.g., (2,2),(2,3),(1,3). Of course, (2,2),(1,2),(1,3) is also a valid even path.  \xe2\x9f\xa84,2,4,3\xe2\x9f\xa9: There is an even path from cell (4,2) to cell (4,3), namely (4,2),(4,3).  \xe2\x9f\xa85,1,3,4\xe2\x9f\xa9: There is no even path from cell (5,1) to cell (3,4). Observe that the only two neighboring cells of (5,1) are cell (5,2) and cell (4,1), and both of them contain odd numbers (7 and 11, respectively), thus, there cannot be any even path originating from cell (5,1)." 1600.0                                      
          1251E2 "Voting (Hard Version)" "binary search,data structures,greedy" "The only difference between easy and hard versions is constraints.Now elections are held in Berland and you want to win them. More precisely, you want everyone to vote for you.There are n voters, and two ways to convince each of them to vote for you. The first way to convince the i-th voter is to pay him pi coins. The second way is to make mi other voters vote for you, and the i-th voter will vote for free.Moreover, the process of such voting takes place in several steps. For example, if there are five voters with m1=1, m2=2, m3=2, m4=4, m5=5, then you can buy the vote of the fifth voter, and eventually everyone will vote for you. Set of people voting for you will change as follows: 5\xe2\x86\x921,5\xe2\x86\x921,2,3,5\xe2\x86\x921,2,3,4,5.Calculate the minimum number of coins you have to spend so that everyone votes for you." 2400.0                                      
          1251E1 "Voting (Easy Version)" "data structures,dp,greedy" "The only difference between easy and hard versions is constraints.Now elections are held in Berland and you want to win them. More precisely, you want everyone to vote for you.There are n voters, and two ways to convince each of them to vote for you. The first way to convince the i-th voter is to pay him pi coins. The second way is to make mi other voters vote for you, and the i-th voter will vote for free.Moreover, the process of such voting takes place in several steps. For example, if there are five voters with m1=1, m2=2, m3=2, m4=4, m5=5, then you can buy the vote of the fifth voter, and eventually everyone will vote for you. Set of people voting for you will change as follows: 5\xe2\x86\x921,5\xe2\x86\x921,2,3,5\xe2\x86\x921,2,3,4,5.Calculate the minimum number of coins you have to spend so that everyone votes for you." 2300.0                                      
          1251C "Minimize The Integer" "greedy,two pointers" "You are given a huge integer a consisting of n digits (n is between 1 and 3\xe2\x8b\x85105, inclusive). It may contain leading zeros.You can swap two digits on adjacent (neighboring) positions if the swapping digits are of different parity (that is, they have different remainders when divided by 2). For example, if a=032867235 you can get the following integers in a single operation:   302867235 if you swap the first and the second digits;  023867235 if you swap the second and the third digits;  032876235 if you swap the fifth and the sixth digits;  032862735 if you swap the sixth and the seventh digits;  032867325 if you swap the seventh and the eighth digits. Note, that you can\'t swap digits on positions 2 and 4 because the positions are not adjacent. Also, you can\'t swap digits on positions 3 and 4 because the digits have the same parity.You can perform any number (possibly, zero) of such operations.Find the minimum integer you can obtain.Note that the resulting integer also may contain leading zeros." 1600.0                                      
          1250K Projectors flows,graphs "There are n lectures and m seminars to be conducted today at the Faculty of Approximate Sciences. The i-th lecture starts at ai and ends at bi (formally, time of the lecture spans an interval [ai,bi), the right bound is exclusive). The j-th seminar starts at pj and ends at qj (similarly, time of the seminar spans an interval [pj,qj), the right bound is exclusive).There are x HD-projectors numbered from 1 to x and y ordinary projectors numbered from x+1 to x+y available at the faculty. Projectors should be distributed in such a way that:  an HD-projector is used in each lecture;  some projector (ordinary or HD) is used in each seminar;  a projector (ordinary or HD) can only be used in one event at the same moment of time;  if a projector is selected for an event, it is used there for the whole duration of the event;  a projector can be reused in some following event, if it starts not earlier than current event finishes. You are to find such distribution of projectors, if it exists.Again, note that the right bound of the event\'s time range is not inclusive: if some event starts exactly when another event finishes, the projector can be reused (suppose that it is instantly transported to the location of the event)." 3100.0                                      
          1250D "Conference Problem" dp "A large-scale conference on unnatural sciences is going to be held soon in Berland! In total, n scientists from all around the world have applied. All of them have indicated a time segment when they will attend the conference: two integers li, ri \xe2\x80\x94 day of arrival and day of departure.Also, some of the scientists have indicated their country, while some preferred not to. So, each scientist also has a value ci, where:  ci>0, if the scientist is coming from country ci (all countries are numbered from 1 to 200);  ci=0, if the scientist preferred to not indicate the country. Everyone knows that it is interesting and useful to chat with representatives of other countries! A participant of the conference will be upset if she will not meet people from other countries during the stay. It is possible to meet people during all time of stay, including the day of arrival and the day of departure.Conference organizers need to be ready for the worst! They are interested in the largest number x, that it is possible that among all people attending the conference exactly x will be upset.Help the organizers to find the maximum number of upset scientists." 3000.0                                      
          1249D2 "Too Many Segments (hard version)" "data structures,greedy,sortings" "The only difference between easy and hard versions is constraints.You are given n segments on the coordinate axis OX. Segments can intersect, lie inside each other and even coincide. The i-th segment is [li;ri] (li\xe2\x89\xa4ri) and it covers all integer points j such that li\xe2\x89\xa4j\xe2\x89\xa4ri.The integer point is called bad if it is covered by strictly more than k segments.Your task is to remove the minimum number of segments so that there are no bad points at all." 1800.0                                      
          1248D1 "The World Is Just a Programming Task (Easy Version)" "brute force,dp,greedy,implementation" "This is an easier version of the problem. In this version, n\xe2\x89\xa4500.Vasya is an experienced developer of programming competitions\' problems. As all great minds at some time, Vasya faced a creative crisis. To improve the situation, Petya gifted him a string consisting of opening and closing brackets only. Petya believes, that the beauty of the bracket string is a number of its cyclical shifts, which form a correct bracket sequence.To digress from his problems, Vasya decided to select two positions of the string (not necessarily distinct) and swap characters located at this positions with each other. Vasya will apply this operation exactly once. He is curious what is the maximum possible beauty he can achieve this way. Please help him.We remind that bracket sequence s is called correct if:   s is empty;  s is equal to ""(t)"", where t is correct bracket sequence;  s is equal to t1t2, i.e. concatenation of t1 and t2, where t1 and t2 are correct bracket sequences. For example, ""(()())"", ""()"" are correct, while "")("" and ""())"" are not.The cyclical shift of the string s of length n by k (0\xe2\x89\xa4k<n) is a string formed by a concatenation of the last k symbols of the string s with the first n\xe2\x88\x92k symbols of string s. For example, the cyclical shift of string ""(())()"" by 2 equals ""()(())"".Cyclical shifts i and j are considered different, if i\xe2\x89\xa0j." 2000.0                                      
          1240F Football graphs "There are n football teams in the world. The Main Football Organization (MFO) wants to host at most m games. MFO wants the i-th game to be played between the teams ai and bi in one of the k stadiums. Let sij be the numbers of games the i-th team played in the j-th stadium. MFO does not want a team to have much more games in one stadium than in the others. Therefore, for each team i, the absolute difference between the maximum and minimum among si1,si2,\xe2\x80\xa6,sik should not exceed 2.Each team has wi \xe2\x80\x94 the amount of money MFO will earn for each game of the i-th team. If the i-th team plays l games, MFO will earn wi\xe2\x8b\x85l.MFO needs to find what games in what stadiums they need to host in order to earn as much money as possible, not violating the rule they set.However, this problem is too complicated for MFO. Therefore, they are asking you to help them." 3100.0                                      
          1239F "Swiper, no swiping!" graphs,implementation "I\'m the Map, I\'m the Map! I\'m the MAP!!!MapIn anticipation of new adventures Boots wanted to do a good deed. After discussion with the Map and Backpack, they decided to gift Dora a connected graph. After a long search, Boots chose t graph\'s variants, which Dora might like. However fox Swiper wants to spoil his plan.The Swiper knows, that Dora now is only able to count up to 3, so he has came up with a following idea. He wants to steal some non-empty set of vertices, so that the Dora won\'t notice the loss. He has decided to steal some non-empty set of vertices, so that after deletion of the stolen vertices and edges adjacent to them, every remaining vertex wouldn\'t change it\'s degree modulo 3. The degree of a vertex is the number of edges it is adjacent to. It would\'ve been suspicious to steal all the vertices, so Swiper needs another plan.Boots are sure, that the crime can not be allowed. However they are afraid, that they won\'t be able to handle this alone. So Boots decided to ask for your help. Please determine for every graph\'s variant whether the Swiper can perform the theft or not." 3400.0                                      
          1239B "The World Is Just a Programming Task (Hard Version)" implementation "This is a harder version of the problem. In this version, n\xe2\x89\xa4300000.Vasya is an experienced developer of programming competitions\' problems. As all great minds at some time, Vasya faced a creative crisis. To improve the situation, Petya gifted him a string consisting of opening and closing brackets only. Petya believes, that the beauty of the bracket string is a number of its cyclical shifts, which form a correct bracket sequence.To digress from his problems, Vasya decided to select two positions of the string (not necessarily distinct) and swap characters located at this positions with each other. Vasya will apply this operation exactly once. He is curious what is the maximum possible beauty he can achieve this way. Please help him.We remind that bracket sequence s is called correct if:   s is empty;  s is equal to ""(t)"", where t is correct bracket sequence;  s is equal to t1t2, i.e. concatenation of t1 and t2, where t1 and t2 are correct bracket sequences. For example, ""(()())"", ""()"" are correct, while "")("" and ""())"" are not.The cyclical shift of the string s of length n by k (0\xe2\x89\xa4k<n) is a string formed by a concatenation of the last k symbols of the string s with the first n\xe2\x88\x92k symbols of string s. For example, the cyclical shift of string ""(())()"" by 2 equals ""()(())"".Cyclical shifts i and j are considered different, if i\xe2\x89\xa0j." 2500.0                                      
          1238E "Keyboard Purchase" bitmasks,dp "You have a password which you often type \xe2\x80\x94 a string s of length n. Every character of this string is one of the first m lowercase Latin letters.Since you spend a lot of time typing it, you want to buy a new keyboard.A keyboard is a permutation of the first m Latin letters. For example, if m=3, then there are six possible keyboards: abc, acb, bac, bca, cab and cba.Since you type your password with one finger, you need to spend time moving your finger from one password character to the next. The time to move from character si to character si+1 is equal to the distance between these characters on keyboard. The total time you have to spend typing the password with a keyboard is called the slowness of this keyboard.More formaly, the slowness of keyboard is equal to n\xe2\x88\x91i=2|possi\xe2\x88\x921\xe2\x88\x92possi|, where posx is position of letter x in keyboard.For example, if s is aacabc and the keyboard is bac, then the total time of typing this password is |posa\xe2\x88\x92posa|+|posa\xe2\x88\x92posc|+|posc\xe2\x88\x92posa|+|posa\xe2\x88\x92posb|+|posb\xe2\x88\x92posc| = |2\xe2\x88\x922|+|2\xe2\x88\x923|+|3\xe2\x88\x922|+|2\xe2\x88\x921|+|1\xe2\x88\x923| = 0+1+1+1+2=5.Before buying a new keyboard you want to know the minimum possible slowness that the keyboard can have." 2200.0                                      
          1238D AB-string "binary search,combinatorics,dp,strings" "The string t1t2\xe2\x80\xa6tk is good if each letter of this string belongs to at least one palindrome of length greater than 1.A palindrome is a string that reads the same backward as forward. For example, the strings A, BAB, ABBA, BAABBBAAB are palindromes, but the strings AB, ABBBAA, BBBA are not.Here are some examples of good strings:   t = AABBB (letters t1, t2 belong to palindrome t1\xe2\x80\xa6t2 and letters t3, t4, t5 belong to palindrome t3\xe2\x80\xa6t5);  t = ABAA (letters t1, t2, t3 belong to palindrome t1\xe2\x80\xa6t3 and letter t4 belongs to palindrome t3\xe2\x80\xa6t4);  t = AAAAA (all letters belong to palindrome t1\xe2\x80\xa6t5); You are given a string s of length n, consisting of only letters A and B.You have to calculate the number of good substrings of string s." 1900.0                                      
          1237C2 "Balanced Removals (Harder)" "binary search,constructive algorithms,divide and conquer,greedy,implementation,sortings" "This is a harder version of the problem. In this version, n\xe2\x89\xa450000.There are n distinct points in three-dimensional space numbered from 1 to n. The i-th point has coordinates (xi,yi,zi). The number of points n is even.You\'d like to remove all n points using a sequence of n2 snaps. In one snap, you can remove any two points a and b that have not been removed yet and form a perfectly balanced pair. A pair of points a and b is perfectly balanced if no other point c (that has not been removed yet) lies within the axis-aligned minimum bounding box of points a and b.Formally, point c lies within the axis-aligned minimum bounding box of points a and b if and only if min(xa,xb)\xe2\x89\xa4xc\xe2\x89\xa4max(xa,xb), min(ya,yb)\xe2\x89\xa4yc\xe2\x89\xa4max(ya,yb), and min(za,zb)\xe2\x89\xa4zc\xe2\x89\xa4max(za,zb). Note that the bounding box might be degenerate. Find a way to remove all points in n2 snaps." 1900.0                                      
          1237C1 "Balanced Removals (Easier)" "constructive algorithms,geometry,greedy" "This is an easier version of the problem. In this version, n\xe2\x89\xa42000.There are n distinct points in three-dimensional space numbered from 1 to n. The i-th point has coordinates (xi,yi,zi). The number of points n is even.You\'d like to remove all n points using a sequence of n2 snaps. In one snap, you can remove any two points a and b that have not been removed yet and form a perfectly balanced pair. A pair of points a and b is perfectly balanced if no other point c (that has not been removed yet) lies within the axis-aligned minimum bounding box of points a and b.Formally, point c lies within the axis-aligned minimum bounding box of points a and b if and only if min(xa,xb)\xe2\x89\xa4xc\xe2\x89\xa4max(xa,xb), min(ya,yb)\xe2\x89\xa4yc\xe2\x89\xa4max(ya,yb), and min(za,zb)\xe2\x89\xa4zc\xe2\x89\xa4max(za,zb). Note that the bounding box might be degenerate. Find a way to remove all points in n2 snaps." 1700.0                                      
          1236C Labs "constructive algorithms,greedy,implementation" "In order to do some research, n2 labs are built on different heights of a mountain. Let\'s enumerate them with integers from 1 to n2, such that the lab with the number 1 is at the lowest place, the lab with the number 2 is at the second-lowest place, \xe2\x80\xa6, the lab with the number n2 is at the highest place.To transport water between the labs, pipes are built between every pair of labs. A pipe can transport at most one unit of water at a time from the lab with the number u to the lab with the number v if u>v.Now the labs need to be divided into n groups, each group should contain exactly n labs. The labs from different groups can transport water to each other. The sum of units of water that can be sent from a group A to a group B is equal to the number of pairs of labs (u,v) such that the lab with the number u is from the group A, the lab with the number v is from the group B and u>v. Let\'s denote this value as f(A,B) (i.e. f(A,B) is the sum of units of water that can be sent from a group A to a group B).For example, if n=3 and there are 3 groups X, Y and Z: X={1,5,6},Y={2,4,9} and Z={3,7,8}. In this case, the values of f are equal to:  f(X,Y)=4 because of 5\xe2\x86\x922, 5\xe2\x86\x924, 6\xe2\x86\x922, 6\xe2\x86\x924,  f(X,Z)=2 because of 5\xe2\x86\x923, 6\xe2\x86\x923,  f(Y,X)=5 because of 2\xe2\x86\x921, 4\xe2\x86\x921, 9\xe2\x86\x921, 9\xe2\x86\x925, 9\xe2\x86\x926,  f(Y,Z)=4 because of 4\xe2\x86\x923, 9\xe2\x86\x923, 9\xe2\x86\x927, 9\xe2\x86\x928,  f(Z,X)=7 because of 3\xe2\x86\x921, 7\xe2\x86\x921, 7\xe2\x86\x925, 7\xe2\x86\x926, 8\xe2\x86\x921, 8\xe2\x86\x925, 8\xe2\x86\x926,  f(Z,Y)=5 because of 3\xe2\x86\x922, 7\xe2\x86\x922, 7\xe2\x86\x924, 8\xe2\x86\x922, 8\xe2\x86\x924. Please, divide labs into n groups with size n, such that the value minf(A,B) over all possible pairs of groups A and B (A\xe2\x89\xa0B) is maximal.In other words, divide labs into n groups with size n, such that minimum number of the sum of units of water that can be transported from a group A to a group B for every pair of different groups A and B (A\xe2\x89\xa0B) as big as possible.Note, that the example above doesn\'t demonstrate an optimal division, but it demonstrates how to calculate the values f for some division.If there are many optimal divisions, you can find any." 1300.0                                      
          1236A Stones "brute force,greedy,math" "Alice is playing with some stones.Now there are three numbered heaps of stones. The first of them contains a stones, the second of them contains b stones and the third of them contains c stones.Each time she can do one of two operations:  take one stone from the first heap and two stones from the second heap (this operation can be done only if the first heap contains at least one stone and the second heap contains at least two stones);  take one stone from the second heap and two stones from the third heap (this operation can be done only if the second heap contains at least one stone and the third heap contains at least two stones). She wants to get the maximum number of stones, but she doesn\'t know what to do. Initially, she has 0 stones. Can you help her?" 800.0                                      
          1234B2 "Social Network (hard version)" "data structures,implementation" "The only difference between easy and hard versions are constraints on n and k.You are messaging in one of the popular social networks via your smartphone. Your smartphone can show at most k most recent conversations with your friends. Initially, the screen is empty (i.e. the number of displayed conversations equals 0).Each conversation is between you and some of your friends. There is at most one conversation with any of your friends. So each conversation is uniquely defined by your friend.You (suddenly!) have the ability to see the future. You know that during the day you will receive n messages, the i-th message will be received from the friend with ID idi (1\xe2\x89\xa4idi\xe2\x89\xa4109).If you receive a message from idi in the conversation which is currently displayed on the smartphone then nothing happens: the conversations of the screen do not change and do not change their order, you read the message and continue waiting for new messages.Otherwise (i.e. if there is no conversation with idi on the screen):  Firstly, if the number of conversations displayed on the screen is k, the last conversation (which has the position k) is removed from the screen.  Now the number of conversations on the screen is guaranteed to be less than k and the conversation with the friend idi is not displayed on the screen.  The conversation with the friend idi appears on the first (the topmost) position on the screen and all the other displayed conversations are shifted one position down. Your task is to find the list of conversations (in the order they are displayed on the screen) after processing all n messages." 1300.0                                      
          1234B1 "Social Network (easy version)" implementation "The only difference between easy and hard versions are constraints on n and k.You are messaging in one of the popular social networks via your smartphone. Your smartphone can show at most k most recent conversations with your friends. Initially, the screen is empty (i.e. the number of displayed conversations equals 0).Each conversation is between you and some of your friends. There is at most one conversation with any of your friends. So each conversation is uniquely defined by your friend.You (suddenly!) have the ability to see the future. You know that during the day you will receive n messages, the i-th message will be received from the friend with ID idi (1\xe2\x89\xa4idi\xe2\x89\xa4109).If you receive a message from idi in the conversation which is currently displayed on the smartphone then nothing happens: the conversations of the screen do not change and do not change their order, you read the message and continue waiting for new messages.Otherwise (i.e. if there is no conversation with idi on the screen):  Firstly, if the number of conversations displayed on the screen is k, the last conversation (which has the position k) is removed from the screen.  Now the number of conversations on the screen is guaranteed to be less than k and the conversation with the friend idi is not displayed on the screen.  The conversation with the friend idi appears on the first (the topmost) position on the screen and all the other displayed conversations are shifted one position down. Your task is to find the list of conversations (in the order they are displayed on the screen) after processing all n messages." 1000.0                                      
          1227E "Arson In Berland Forest" "binary search,graphs,graphs,shortest paths" "The Berland Forest can be represented as an infinite cell plane. Every cell contains a tree. That is, contained before the recent events.A destructive fire raged through the Forest, and several trees were damaged by it. Precisely speaking, you have a n\xc3\x97m rectangle map which represents the damaged part of the Forest. The damaged trees were marked as ""X"" while the remaining ones were marked as ""."". You are sure that all burnt trees are shown on the map. All the trees outside the map are undamaged.The firemen quickly extinguished the fire, and now they are investigating the cause of it. The main version is that there was an arson: at some moment of time (let\'s consider it as 0) some trees were set on fire. At the beginning of minute 0, only the trees that were set on fire initially were burning. At the end of each minute, the fire spread from every burning tree to each of 8 neighboring trees. At the beginning of minute T, the fire was extinguished.The firemen want to find the arsonists as quickly as possible. The problem is, they know neither the value of T (how long the fire has been raging) nor the coordinates of the trees that were initially set on fire. They want you to find the maximum value of T (to know how far could the arsonists escape) and a possible set of trees that could be initially set on fire.Note that you\'d like to maximize value T but the set of trees can be arbitrary." 2200.0                                      
          1225F "Tree Factory" "constructive algorithms,greedy,trees" "Bytelandian Tree Factory produces trees for all kinds of industrial applications. You have been tasked with optimizing the production of a certain type of tree for an especially large and important order.The tree in question is a rooted tree with n vertices labelled with distinct integers from 0 to n\xe2\x88\x921. The vertex labelled 0 is the root of the tree, and for any non-root vertex v the label of its parent p(v) is less than the label of v.All trees at the factory are made from bamboo blanks. A bamboo is a rooted tree such that each vertex has exactly one child, except for a single leaf vertex with no children. The vertices of a bamboo blank can be labelled arbitrarily before its processing is started.To process a bamboo into another tree a single type of operation can be made: choose an arbitrary non-root vertex v such that its parent p(v) is not a root either. The operation consists of changing the parent of v to its parent\'s parent p(p(v)). Note that parents of all other vertices remain unchanged, in particular, the subtree of v does not change.Efficiency is crucial, hence you have to minimize the number of operations to make the desired tree from a bamboo blank. Construct any optimal sequence of operations to produce the desired tree.Note that the labelling of the resulting tree has to coincide with the labelling of the desired tree. Formally, the labels of the roots have to be equal, and for non-root vertices with the same label the labels of their parents should be the same.It is guaranteed that for any test present in this problem an answer exists, and further, an optimal sequence contains at most 106 operations. Note that any hack that does not meet these conditions will be invalid." 2500.0                                      
          1225C p-binary "bitmasks,brute force,math" "Vasya will fancy any number as long as it is an integer power of two. Petya, on the other hand, is very conservative and only likes a single integer p (which may be positive, negative, or zero). To combine their tastes, they invented p-binary numbers of the form 2x+p, where x is a non-negative integer.For example, some \xe2\x88\x929-binary (""minus nine"" binary) numbers are: \xe2\x88\x928 (minus eight), 7 and 1015 (\xe2\x88\x928=20\xe2\x88\x929, 7=24\xe2\x88\x929, 1015=210\xe2\x88\x929).The boys now use p-binary numbers to represent everything. They now face a problem: given a positive integer n, what\'s the smallest number of p-binary numbers (not necessarily distinct) they need to represent n as their sum? It may be possible that representation is impossible altogether. Help them solve this problem.For example, if p=0 we can represent 7 as 20+21+22.And if p=\xe2\x88\x929 we can represent 7 as one number (24\xe2\x88\x929).Note that negative p-binary numbers are allowed to be in the sum (see the Notes section for an example)." 1600.0                                      
          1221G "Graph And Numbers" "bitmasks,brute force,combinatorics,dp,meet-in-the-middle" "You are given an undirected graph with n vertices and m edges. You have to write a number on each vertex of this graph, each number should be either 0 or 1. After that, you write a number on each edge equal to the sum of numbers on vertices incident to that edge.You have to choose the numbers you will write on the vertices so that there is at least one edge with 0 written on it, at least one edge with 1 and at least one edge with 2. How many ways are there to do it? Two ways to choose numbers are different if there exists at least one vertex which has different numbers written on it in these two ways." 2900.0                                      
          1218G "Alpha planetary system" "constructive algorithms,graphs,shortest paths" "Three planets X, Y and Z within the Alpha planetary system are inhabited with an advanced civilization. The spaceports of these planets are connected by interplanetary space shuttles. The flight scheduler should decide between 1, 2 and 3 return flights for every existing space shuttle connection. Since the residents of Alpha are strong opponents of the symmetry, there is a strict rule that any two of the spaceports connected by a shuttle must have a different number of flights. For every pair of connected spaceports, your goal is to propose a number 1, 2 or 3 for each shuttle flight, so that for every two connected spaceports the overall number of flights differs. You may assume that:1) Every planet has at least one spaceport 2) There exist only shuttle flights between spaceports of different planets 3) For every two spaceports there is a series of shuttle flights enabling traveling between them4) Spaceports are not connected by more than one shuttle" 3000.0                                      
          1217E "Sum Queries?" "data structures,greedy,implementation,math" "Let\'s define a balanced multiset the following way. Write down the sum of all elements of the multiset in its decimal representation. For each position of that number check if the multiset includes at least one element such that the digit of the element and the digit of the sum at that position are the same. If that holds for every position, then the multiset is balanced. Otherwise it\'s unbalanced.For example, multiset {20,300,10001}{20,300,10001} is balanced and multiset {20,310,10001}{20,310,10001} is unbalanced:   The red digits mark the elements and the positions for which these elements have the same digit as the sum. The sum of the first multiset is 1032110321, every position has the digit required. The sum of the second multiset is 1033110331 and the second-to-last digit doesn\'t appear in any number, thus making the multiset unbalanced.You are given an array a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an, consisting of nn integers.You are asked to perform some queries on it. The queries can be of two types:  1 i x1 i x \xe2\x80\x94 replace aiai with the value xx;  2 l r2 l r \xe2\x80\x94 find the unbalanced subset of the multiset of the numbers al,al+1,\xe2\x80\xa6,aral,al+1,\xe2\x80\xa6,ar with the minimum sum, or report that no unbalanced subset exists. Note that the empty multiset is balanced.For each query of the second type print the lowest sum of the unbalanced subset. Print -1 if no unbalanced subset exists." 2300.0                                      
          1214H "Tiles Placement" "constructive algorithms,dfs and similar,trees" "The new pedestrian zone in Moscow city center consists of nn squares connected with each other by n\xe2\x88\x921n\xe2\x88\x921 footpaths. We define a simple path as a sequence of squares such that no square appears in this sequence twice and any two adjacent squares in this sequence are directly connected with a footpath. The size of a simple path is the number of squares in it. The footpaths are designed in a such a way that there is exactly one simple path between any pair of different squares.During preparations for Moscow City Day the city council decided to renew ground tiles on all nn squares. There are kk tile types of different colors, numbered from 11 to kk. For each square exactly one tile type must be selected and then used to cover this square surface. To make walking through the city center more fascinating, it was decided to select tiles types for each square in such a way that any possible simple path of size exactly kk contains squares with all kk possible tile colors.You need to find out whether it is possible to place the tiles this way or not." 2800.0                                      
          1214F Employment greedy,sortings "Two large companies ""Cecsi"" and ""Poca Pola"" are fighting against each other for a long time. In order to overcome their competitor, ""Poca Pola"" started a super secret project, for which it has total n vacancies in all of their offices. After many tests and interviews n candidates were selected and the only thing left was their employment.Because all candidates have the same skills, it doesn\'t matter where each of them will work. That is why the company decided to distribute candidates between workplaces so that the total distance between home and workplace over all candidates is minimal.It is well known that Earth is round, so it can be described as a circle, and all m cities on Earth can be described as points on this circle. All cities are enumerated from 1 to m so that for each i (1\xe2\x89\xa4i\xe2\x89\xa4m\xe2\x88\x921) cities with indexes i and i+1 are neighbors and cities with indexes 1 and m are neighbors as well. People can move only along the circle. The distance between any two cities equals to minimal number of transitions between neighboring cities you have to perform to get from one city to another. In particular, the distance between the city and itself equals 0.The ""Poca Pola"" vacancies are located at offices in cities a1,a2,\xe2\x80\xa6,an. The candidates live in cities b1,b2,\xe2\x80\xa6,bn. It is possible that some vacancies are located in the same cities and some candidates live in the same cities. The ""Poca Pola"" managers are too busy with super secret project, so you were asked to help ""Poca Pola"" to distribute candidates between workplaces, so that the sum of the distance between home and workplace over all candidates is minimum possible." 2700.0                                      
          1214A "Optimal Currency Exchange" "brute force,math" "Andrew was very excited to participate in Olympiad of Metropolises. Days flew by quickly, and Andrew is already at the airport, ready to go home. He has n rubles left, and would like to exchange them to euro and dollar bills. Andrew can mix dollar bills and euro bills in whatever way he wants. The price of one dollar is d rubles, and one euro costs e rubles.Recall that there exist the following dollar bills: 1, 2, 5, 10, 20, 50, 100, and the following euro bills \xe2\x80\x94 5, 10, 20, 50, 100, 200 (note that, in this problem we do not consider the 500 euro bill, it is hard to find such bills in the currency exchange points). Andrew can buy any combination of bills, and his goal is to minimize the total number of rubles he will have after the exchange.Help him \xe2\x80\x94 write a program that given integers n, e and d, finds the minimum number of rubles Andrew can get after buying dollar and euro bills." 1400.0                                      
          1213D2 "Equalizing by Division (hard version)" "brute force,math,sortings" "The only difference between easy and hard versions is the number of elements in the array.You are given an array a consisting of n integers. In one move you can choose any ai and divide it by 2 rounding down (in other words, in one move you can set ai:=\xe2\x8c\x8aai2\xe2\x8c\x8b).You can perform such an operation any (possibly, zero) number of times with any ai.Your task is to calculate the minimum possible number of operations required to obtain at least k equal numbers in the array.Don\'t forget that it is possible to have ai=0 after some operations, thus the answer always exists." 1600.0                                      
          1210C "Kamil and Making a Stream" "math,number theory,trees" "Kamil likes streaming the competitive programming videos. His MeTube channel has recently reached 100100 million subscribers. In order to celebrate this, he posted a video with an interesting problem he couldn\'t solve yet. Can you help him?You\'re given a tree \xe2\x80\x94 a connected undirected graph consisting of nn vertices connected by n\xe2\x88\x921n\xe2\x88\x921 edges. The tree is rooted at vertex 11. A vertex uu is called an ancestor of vv if it lies on the shortest path between the root and vv. In particular, a vertex is an ancestor of itself.Each vertex vv is assigned its beauty xvxv \xe2\x80\x94 a non-negative integer not larger than 10121012. This allows us to define the beauty of a path. Let uu be an ancestor of vv. Then we define the beauty f(u,v)f(u,v) as the greatest common divisor of the beauties of all vertices on the shortest path between uu and vv. Formally, if u=t1,t2,t3,\xe2\x80\xa6,tk=vu=t1,t2,t3,\xe2\x80\xa6,tk=v are the vertices on the shortest path between uu and vv, then f(u,v)=gcd(xt1,xt2,\xe2\x80\xa6,xtk)f(u,v)=gcd(xt1,xt2,\xe2\x80\xa6,xtk). Here, gcdgcd denotes the greatest common divisor of a set of numbers. In particular, f(u,u)=gcd(xu)=xuf(u,u)=gcd(xu)=xu.Your task is to find the sum\xe2\x88\x91u is an ancestor of vf(u,v).\xe2\x88\x91u is an ancestor of vf(u,v).As the result might be too large, please output it modulo 109+7109+7.Note that for each yy, gcd(0,y)=gcd(y,0)=ygcd(0,y)=gcd(y,0)=y. In particular, gcd(0,0)=0gcd(0,0)=0." 2000.0                                      
          1209H "Moving Walkways" "data structures,greedy,math" "Airports often use moving walkways to help you walking big distances faster. Each such walkway has some speed that effectively increases your speed. You can stand on such a walkway and let it move you, or you could also walk and then your effective speed is your walking speed plus walkway\'s speed.Limak wants to get from point 0 to point L on a straight line. There are n disjoint walkways in between. The i-th walkway is described by two integers xi and yi and a real value si. The i-th walkway starts at xi, ends at yi and has speed si. Every walkway is located inside the segment [0,L] and no two walkways have positive intersection. However, they can touch by endpoints.Limak needs to decide how to distribute his energy. For example, it might make more sense to stand somewhere (or to walk slowly) to then have a lot of energy to walk faster.Limak\'s initial energy is 0 and it must never drop below that value. At any moment, he can walk with any speed v in the interval [0,2] and it will cost him v energy per second, but he continuously recovers energy with speed of 1 energy per second. So, when he walks with speed v, his energy increases by (1\xe2\x88\x92v). Note that negative value would mean losing energy.In particular, he can walk with speed 1 and this won\'t change his energy at all, while walking with speed 0.77 effectively gives him 0.23 energy per second.Limak can choose his speed arbitrarily (any real value in interval [0,2]) at every moment of time (including the moments when he is located on non-integer positions). Everything is continuous (non-discrete).What is the fastest time Limak can get from 0 to L?" 3300.0                                      
          1207F "Remainder Problem" "brute force,data structures,implementation" "You are given an array a consisting of 500000 integers (numbered from 1 to 500000). Initially all elements of a are zero.You have to process two types of queries to this array:  1 x y \xe2\x80\x94 increase ax by y;  2 x y \xe2\x80\x94 compute \xe2\x88\x91i\xe2\x88\x88R(x,y)ai, where R(x,y) is the set of all integers from 1 to 500000 which have remainder y modulo x. Can you process all the queries?" 2100.0                                      
          1205B "Shortest Cycle" "bitmasks,brute force,graphs,shortest paths" "You are given n integer numbers a1,a2,\xe2\x80\xa6,an. Consider graph on n nodes, in which nodes i, j (i\xe2\x89\xa0j) are connected if and only if, ai AND aj\xe2\x89\xa00, where AND denotes the bitwise AND operation.Find the length of the shortest cycle in this graph or determine that it doesn\'t have cycles at all." 1900.0                                      
          1202C "You Are Given a WASD-string..." "brute force,data structures,dp,greedy,implementation,math,strings" "You have a string s \xe2\x80\x94 a sequence of commands for your toy robot. The robot is placed in some cell of a rectangular grid. He can perform four commands:  \'W\' \xe2\x80\x94 move one cell up;  \'S\' \xe2\x80\x94 move one cell down;  \'A\' \xe2\x80\x94 move one cell left;  \'D\' \xe2\x80\x94 move one cell right. Let Grid(s) be the grid of minimum possible area such that there is a position in the grid where you can place the robot in such a way that it will not fall from the grid while running the sequence of commands s. For example, if s=DSAWWAW then Grid(s) is the 4\xc3\x973 grid:  you can place the robot in the cell (3,2);  the robot performs the command \'D\' and moves to (3,3);  the robot performs the command \'S\' and moves to (4,3);  the robot performs the command \'A\' and moves to (4,2);  the robot performs the command \'W\' and moves to (3,2);  the robot performs the command \'W\' and moves to (2,2);  the robot performs the command \'A\' and moves to (2,1);  the robot performs the command \'W\' and moves to (1,1).   You have 4 extra letters: one \'W\', one \'A\', one \'S\', one \'D\'. You\'d like to insert at most one of these letters in any position of sequence s to minimize the area of Grid(s).What is the minimum area of Grid(s) you can achieve?" 2100.0                                      
          1201E1 "Knightmare (easy)" "graphs,interactive,shortest paths" "This problem only differs from the next problem in constraints.This is an interactive problem.Alice and Bob are playing a game on the chessboard of size n\xc3\x97m where n and m are even. The rows are numbered from 1 to n and the columns are numbered from 1 to m. There are two knights on the chessboard. A white one initially is on the position (x1,y1), while the black one is on the position (x2,y2). Alice will choose one of the knights to play with, and Bob will use the other one.The Alice and Bob will play in turns and whoever controls the white knight starts the game. During a turn, the player must move their knight adhering the chess rules. That is, if the knight is currently on the position (x,y), it can be moved to any of those positions (as long as they are inside the chessboard): (x+1,y+2), (x+1,y\xe2\x88\x922), (x\xe2\x88\x921,y+2), (x\xe2\x88\x921,y\xe2\x88\x922),(x+2,y+1), (x+2,y\xe2\x88\x921), (x\xe2\x88\x922,y+1), (x\xe2\x88\x922,y\xe2\x88\x921). We all know that knights are strongest in the middle of the board. Both knight have a single position they want to reach:   the owner of the white knight wins if it captures the black knight or if the white knight is at (n/2,m/2) and this position is not under attack of the black knight at this moment;  The owner of the black knight wins if it captures the white knight or if the black knight is at (n/2+1,m/2) and this position is not under attack of the white knight at this moment. Formally, the player who captures the other knight wins. The player who is at its target square ((n/2,m/2) for white, (n/2+1,m/2) for black) and this position is not under opponent\'s attack, also wins.A position is under attack of a knight if it can move into this position. Capturing a knight means that a player moves their knight to the cell where the opponent\'s knight is.If Alice made 350 moves and nobody won, the game is a draw.Alice is unsure in her chess skills, so she asks you for a help. Choose a knight and win the game for her. It can be shown, that Alice always has a winning strategy." 2900.0                                      
          1200F "Graph Traveler" "brute force,data structures,dfs and similar,dp,graphs,implementation,math,number theory" "Gildong is experimenting with an interesting machine Graph Traveler. In Graph Traveler, there is a directed graph consisting of n vertices numbered from 1 to n. The i-th vertex has mi outgoing edges that are labeled as ei[0], ei[1], \xe2\x80\xa6, ei[mi\xe2\x88\x921], each representing the destination vertex of the edge. The graph can have multiple edges and self-loops. The i-th vertex also has an integer ki written on itself.A travel on this graph works as follows.   Gildong chooses a vertex to start from, and an integer to start with. Set the variable c to this integer.  After arriving at the vertex i, or when Gildong begins the travel at some vertex i, add ki to c.  The next vertex is ei[x] where x is an integer 0\xe2\x89\xa4x\xe2\x89\xa4mi\xe2\x88\x921 satisfying x\xe2\x89\xa1c(modmi). Go to the next vertex and go back to step 2. It\'s obvious that a travel never ends, since the 2nd and the 3rd step will be repeated endlessly.For example, assume that Gildong starts at vertex 1 with c=5, and m1=2, e1[0]=1, e1[1]=2, k1=\xe2\x88\x923. Right after he starts at vertex 1, c becomes 2. Since the only integer x (0\xe2\x89\xa4x\xe2\x89\xa41) where x\xe2\x89\xa1c(modmi) is 0, Gildong goes to vertex e1[0]=1. After arriving at vertex 1 again, c becomes \xe2\x88\x921. The only integer x satisfying the conditions is 1, so he goes to vertex e1[1]=2, and so on.Since Gildong is quite inquisitive, he\'s going to ask you q queries. He wants to know how many distinct vertices will be visited infinitely many times, if he starts the travel from a certain vertex with a certain value of c. Note that you should not count the vertices that will be visited only finite times." 2300.0                                      
          1200E "Compress Words" "brute force,hashing,implementation,string suffix structures,strings" "Amugae has a sentence consisting of n words. He want to compress this sentence into one word. Amugae doesn\'t like repetitions, so when he merges two words into one word, he removes the longest prefix of the second word that coincides with a suffix of the first word. For example, he merges ""sample"" and ""please"" into ""samplease"".Amugae will merge his sentence left to right (i.e. first merge the first two words, then merge the result with the third word and so on). Write a program that prints the compressed word after the merging process ends." 2000.0                                      
          1196E "Connected Component on a Chessboard" "constructive algorithms,implementation" "You are given two integers b and w. You have a chessboard of size 109\xc3\x97109 with the top left cell at (1;1), the cell (1;1) is painted white.Your task is to find a connected component on this chessboard that contains exactly b black cells and exactly w white cells. Two cells are called connected if they share a side (i.e. for the cell (x,y) there are at most four connected cells: (x\xe2\x88\x921,y),(x+1,y),(x,y\xe2\x88\x921),(x,y+1)). A set of cells is called a connected component if for every pair of cells C1 and C2 from this set, there exists a sequence of cells c1, c2, ..., ck such that c1=C1, ck=C2, all ci from 1 to k are belong to this set of cells and for every i\xe2\x88\x88[1,k\xe2\x88\x921], cells ci and ci+1 are connected.Obviously, it can be impossible to find such component. In this case print ""NO"". Otherwise, print ""YES"" and any suitable connected component.You have to answer q independent queries." 1800.0                                      
          1195D2 "Submarine in the Rybinsk Sea (hard edition)" "combinatorics,math,number theory" "This problem differs from the previous one only in the absence of the constraint on the equal length of all numbers a1,a2,\xe2\x80\xa6,an.A team of SIS students is going to make a trip on a submarine. Their target is an ancient treasure in a sunken ship lying on the bottom of the Great Rybinsk sea. Unfortunately, the students don\'t know the coordinates of the ship, so they asked Meshanya (who is a hereditary mage) to help them. He agreed to help them, but only if they solve his problem.Let\'s denote a function that alternates digits of two numbers f(a1a2\xe2\x80\xa6ap\xe2\x88\x921ap,b1b2\xe2\x80\xa6bq\xe2\x88\x921bq), where a1\xe2\x80\xa6ap and b1\xe2\x80\xa6bq are digits of two integers written in the decimal notation without leading zeros.In other words, the function f(x,y) alternately shuffles the digits of the numbers x and y by writing them from the lowest digits to the older ones, starting with the number y. The result of the function is also built from right to left (that is, from the lower digits to the older ones). If the digits of one of the arguments have ended, then the remaining digits of the other argument are written out. Familiarize with examples and formal definitions of the function below.For example: f(1111,2222)=12121212 f(7777,888)=7787878 f(33,44444)=4443434 f(555,6)=5556 f(111,2222)=2121212Formally,  if p\xe2\x89\xa5q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=a1a2\xe2\x80\xa6ap\xe2\x88\x92q+1b1ap\xe2\x88\x92q+2b2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq;  if p<q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=b1b2\xe2\x80\xa6bq\xe2\x88\x92pa1bq\xe2\x88\x92p+1a2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq. Mishanya gives you an array consisting of n integers ai, your task is to help students to calculate \xe2\x88\x91ni=1\xe2\x88\x91nj=1f(ai,aj) modulo 998244353." 1800.0                                      
          1194D "1-2-K Game" games,math "Alice and Bob play a game. There is a paper strip which is divided into n\xe2\x80\x89+\xe2\x80\x891 cells numbered from left to right starting from 0. There is a chip placed in the n-th cell (the last one).Players take turns, Alice is first. Each player during his or her turn has to move the chip 1, 2 or k cells to the left (so, if the chip is currently in the cell i, the player can move it into cell i\xe2\x80\x89-\xe2\x80\x891, i\xe2\x80\x89-\xe2\x80\x892 or i\xe2\x80\x89-\xe2\x80\x89k). The chip should not leave the borders of the paper strip: it is impossible, for example, to move it k cells to the left if the current cell has number i\xe2\x80\x89<\xe2\x80\x89k. The player who can\'t make a move loses the game.Who wins if both participants play optimally?Alice and Bob would like to play several games, so you should determine the winner in each game." 1700.0                                      
          1193A "Amusement Park" "*special problem,dp,math" "You have been hired to supervise the project of a new amusement park. The park will have a special gimmick: directed slides that can get customers from one attraction to another quickly and in an entertaining way.The park owner has given you the current project: a list of planned attractions and a list of slides that should be built between them. However, him being a businessman, he casually envisioned the impossible: among other things, he projected a slide coming from the Haunted Castle to the Roller Coaster, another from the Roller Coaster to the Drop Tower, and a third from the Drop Tower to the Haunted Castle. As the slides can only go downhill, it is evident why this is a problem. You don\'t have the luxury of ignoring the laws of physics when building the park, so you have to request changes in the project. Maybe he would accept reversing the slide between the Drop Tower and the Haunted Castle?Formally:   The project is a list of attractions and a list of directed slides. Each slide starts at one attraction and ends at another attraction.  A proposal is obtained from the project by reversing the directions of some slides (possibly none or all of them).  A proposal is legal if there is a way to assign an elevation to each attraction in such a way that every slide goes downhill.  The cost of a proposal is the number of slides whose directions were reversed. For a given project, find and report the sum of costs all legal proposals. Since this number may be large, output it modulo 998,244,353." -999.0                                      
          1190F "Tokitsukaze and Powers" "number theory,probabilities" "Tokitsukaze is playing a room escape game designed by SkywalkerT. In this game, she needs to find out hidden clues in the room to reveal a way to escape.After a while, she realizes that the only way to run away is to open the digital door lock since she accidentally went into a secret compartment and found some clues, which can be interpreted as:  Only when you enter n possible different passwords can you open the door;  Passwords must be integers ranged from 0 to (m\xe2\x88\x921);  A password cannot be x (0\xe2\x89\xa4x<m) if x and m are not coprime (i.e. x and m have some common divisor greater than 1);  A password cannot be x (0\xe2\x89\xa4x<m) if there exist non-negative integers e and k such that pe=km+x, where p is a secret integer;  Any integer that doesn\'t break the above rules can be a password;  Several integers are hidden in the room, but only one of them can be p. Fortunately, she finds that n and m are recorded in the lock. However, what makes Tokitsukaze frustrated is that she doesn\'t do well in math. Now that she has found an integer that is suspected to be p, she wants you to help her find out n possible passwords, or determine the integer cannot be p." 3400.0                                      
          1184E2 "Daleks\' Invasion (medium)" "dfs and similar,graphs,shortest paths,trees" "After a successful field test, Heidi is considering deploying a trap along some Corridor, possibly not the first one. She wants to avoid meeting the Daleks inside the Time Vortex, so for abundance of caution she considers placing the traps only along those Corridors that are not going to be used according to the current Daleks\' plan \xe2\x80\x93 which is to use a minimum spanning tree of Corridors. Heidi knows that all energy requirements for different Corridors are now different, and that the Daleks have a single unique plan which they are intending to use.Your task is to calculate the number Emax(c), which is defined in the same way as in the easy version \xe2\x80\x93 i.e., the largest e\xe2\x89\xa4109 such that if we changed the energy of corridor c to e, the Daleks might use it \xe2\x80\x93 but now for every corridor that Heidi considers." 2100.0                                      
          1182E "Product Oriented Recurrence" "dp,math,matrices,number theory" "Let fx=c2x\xe2\x88\x926\xe2\x8b\x85fx\xe2\x88\x921\xe2\x8b\x85fx\xe2\x88\x922\xe2\x8b\x85fx\xe2\x88\x923 for x\xe2\x89\xa54.You have given integers n, f1, f2, f3, and c. Find fnmod(109+7)." 2300.0                                      
          1180A "Alex and a Rhombus" dp,implementation,math "While playing with geometric figures Alex has accidentally invented a concept of a n-th order rhombus in a cell grid.A 1-st order rhombus is just a square 1\xc3\x971 (i.e just a cell).A n-th order rhombus for all n\xe2\x89\xa52 one obtains from a n\xe2\x88\x921-th order rhombus adding all cells which have a common side with it to it (look at the picture to understand it better).  Alex asks you to compute the number of cells in a n-th order rhombus." 800.0                                      
          1179A "Valeriy and Deque" "data structures,implementation" "Recently, on the course of algorithms and data structures, Valeriy learned how to use a deque. He built a deque filled with n elements. The i-th element is ai (i = 1,2,\xe2\x80\xa6,n). He gradually takes the first two leftmost elements from the deque (let\'s call them A and B, respectively), and then does the following: if A>B, he writes A to the beginning and writes B to the end of the deque, otherwise, he writes to the beginning B, and A writes to the end of the deque. We call this sequence of actions an operation.For example, if deque was [2,3,4,5,1], on the operation he will write B=3 to the beginning and A=2 to the end, so he will get [3,4,5,1,2].The teacher of the course, seeing Valeriy, who was passionate about his work, approached him and gave him q queries. Each query consists of the singular number mj (j=1,2,\xe2\x80\xa6,q). It is required for each query to answer which two elements he will pull out on the mj-th operation.Note that the queries are independent and for each query the numbers A and B should be printed in the order in which they will be pulled out of the deque.Deque is a data structure representing a list of elements where insertion of new elements or deletion of existing elements can be made from both sides." 1500.0                                      
          1177B "Digits Sequence (Hard Edition)" "binary search,divide and conquer,implementation" "Let\'s write all the positive integer numbers one after another from 1 without any delimiters (i.e. as a single string). It will be the infinite sequence starting with 123456789101112131415161718192021222324252627282930313233343536...Your task is to print the k-th digit of this sequence." 1800.0                                      
          1175B "Catch Overflow!" "data structures,expression parsing,implementation" "You are given a function f written in some basic language. The function accepts an integer value, which is immediately written into some variable x. x is an integer variable and can be assigned values from 0 to 232\xe2\x88\x921. The function contains three types of commands:  for n \xe2\x80\x94 for loop;  end \xe2\x80\x94 every command between ""for n"" and corresponding ""end"" is executed n times;  add \xe2\x80\x94 adds 1 to x. After the execution of these commands, value of x is returned.Every ""for n"" is matched with ""end"", thus the function is guaranteed to be valid. ""for n"" can be immediately followed by ""end"".""add"" command can be outside of any for loops.Notice that ""add"" commands might overflow the value of x! It means that the value of x becomes greater than 232\xe2\x88\x921 after some ""add"" command. Now you run f(0) and wonder if the resulting value of x is correct or some overflow made it incorrect.If overflow happened then output ""OVERFLOW!!!"", otherwise print the resulting value of x." 1600.0                                      
          1174A "Ehab Fails to Be Thanos" "constructive algorithms,greedy,sortings" "You\'re given an array a of length 2n. Is it possible to reorder it in such way so that the sum of the first n elements isn\'t equal to the sum of the last n elements?" 1000.0                                      
          1172F "Nauuo and Bug" "data structures" "Nauuo is a girl who loves coding.One day she was solving a problem which requires to calculate a sum of some numbers modulo p.She wrote the following code and got the verdict ""Wrong answer"".She soon discovered the bug \xe2\x80\x94 the ModAdd function only worked for numbers in the range [0,p), but the numbers in the problem may be out of the range. She was curious about the wrong function, so she wanted to know the result of it.However, the original code worked too slow, so she asked you to help her.You are given an array a1,a2,\xe2\x80\xa6,an and a number p. Nauuo will make m queries, in each query, you are given l and r, and you have to calculate the results of Sum(a,l,r,p). You can see the definition of the Sum function in the pseudocode above.Note that the integers won\'t overflow in the code above." 3300.0                                      
          1168D "Anagram Paths" dp,implementation,trees "Toad Ilya has a rooted binary tree with vertex 1 being the root. A tree is a connected graph without cycles. A tree is rooted if one vertex is selected and called the root. A vertex u is a child of a vertex v if u and v are connected by an edge and v is closer to the root than u. A leaf is a non-root vertex that has no children.In the tree Ilya has each vertex has at most two children, and each edge has some character written on it. The character can be a lowercase English letter or the question mark \'?\'.Ilya will q times update the tree a bit. Each update will replace exactly one character on some edge. After each update Ilya needs to find if the tree is anagrammable and if yes, find its anagramnity for each letter. Well, that\'s difficult to explain, but we\'ll try.To start with, a string a is an anagram of a string b if it is possible to rearrange letters in a (without changing the letters itself) so that it becomes b. For example, the string ""fortyfive"" is an anagram of the string ""overfifty"", but the string ""aabb"" is not an anagram of the string ""bbba"".Consider a path from the root of the tree to a leaf. The characters on the edges on this path form a string, we say that this string is associated with this leaf. The tree is anagrammable if and only if it is possible to replace each question mark with a lowercase English letter so that for all pair of leaves the associated strings for these leaves are anagrams of each other.If the tree is anagrammable, then its anagramnity for the letter c is the maximum possible number of letters c in a string associated with some leaf in a valid replacement of all question marks.Please after each update find if the tree is anagrammable and if yes, find the \xe2\x88\x91f(c)\xe2\x8b\x85ind(c) for all letters c, where f(c) is the anagramnity for the letter c, and ind(x) is the index of this letter in the alphabet (ind(""a"")=1, ind(""b"")=2, ..., ind(""z"")=26)." 3000.0                                      
          1166C "A Tale of Two Lands" "binary search,sortings,two pointers" "The legend of the foundation of Vectorland talks of two integers x and y. Centuries ago, the array king placed two markers at points |x| and |y| on the number line and conquered all the land in between (including the endpoints), which he declared to be Arrayland. Many years later, the vector king placed markers at points |x\xe2\x88\x92y| and |x+y| and conquered all the land in between (including the endpoints), which he declared to be Vectorland. He did so in such a way that the land of Arrayland was completely inside (including the endpoints) the land of Vectorland.Here |z| denotes the absolute value of z.Now, Jose is stuck on a question of his history exam: ""What are the values of x and y?"" Jose doesn\'t know the answer, but he believes he has narrowed the possible answers down to n integers a1,a2,\xe2\x80\xa6,an. Now, he wants to know the number of unordered pairs formed by two different elements from these n integers such that the legend could be true if x and y were equal to these two values. Note that it is possible that Jose is wrong, and that no pairs could possibly make the legend true." 1500.0                                      
          1165B "Polycarp Training" "data structures,greedy,sortings" "Polycarp wants to train before another programming competition. During the first day of his training he should solve exactly 1 problem, during the second day \xe2\x80\x94 exactly 2 problems, during the third day \xe2\x80\x94 exactly 3 problems, and so on. During the k-th day he should solve k problems.Polycarp has a list of n contests, the i-th contest consists of ai problems. During each day Polycarp has to choose exactly one of the contests he didn\'t solve yet and solve it. He solves exactly k problems from this contest. Other problems are discarded from it. If there are no contests consisting of at least k problems that Polycarp didn\'t solve yet during the k-th day, then Polycarp stops his training.How many days Polycarp can train if he chooses the contests optimally?" 1000.0                                      
          1165A Remainder implementation,math "You are given a huge decimal number consisting of n digits. It is guaranteed that this number has no leading zeros. Each digit of this number is either 0 or 1.You may perform several (possibly zero) operations with this number. During each operation you are allowed to change any digit of your number; you may change 0 to 1 or 1 to 0. It is possible that after some operation you can obtain a number with leading zeroes, but it does not matter for this problem.You are also given two integers 0\xe2\x89\xa4y<x<n. Your task is to calculate the minimum number of operations you should perform to obtain the number that has remainder 10y modulo 10x. In other words, the obtained number should have remainder 10y when divided by 10x." 1100.0                                      
          1162B "Double Matrix" "brute force,greedy" "You are given two n\xc3\x97m matrices containing integers. A sequence of integers is strictly increasing if each next number is greater than the previous one. A row is strictly increasing if all numbers from left to right are strictly increasing. A column is strictly increasing if all numbers from top to bottom are strictly increasing. A matrix is increasing if all rows are strictly increasing and all columns are strictly increasing. For example, the matrix [91011111214] is increasing because each individual row and column is strictly increasing. On the other hand, the matrix [1123] is not increasing because the first row is not strictly increasing.Let a position in the i-th row (from top) and j-th column (from left) in a matrix be denoted as (i,j). In one operation, you can choose any two numbers i and j and swap the number located in (i,j) in the first matrix with the number in (i,j) in the second matrix. In other words, you can swap two numbers in different matrices if they are located in the corresponding positions.You would like to make both matrices increasing by performing some number of operations (possibly none). Determine if it is possible to do this. If it is, print ""Possible"", otherwise, print ""Impossible""." 1400.0                                      
          1159B "Expansion coefficient of the array" implementation,math "Let\'s call an array of non-negative integers a1,a2,\xe2\x80\xa6,an a k-extension for some non-negative integer k if for all possible pairs of indices 1\xe2\x89\xa4i,j\xe2\x89\xa4n the inequality k\xe2\x8b\x85|i\xe2\x88\x92j|\xe2\x89\xa4min(ai,aj) is satisfied. The expansion coefficient of the array a is the maximal integer k such that the array a is a k-extension. Any array is a 0-expansion, so the expansion coefficient always exists.You are given an array of non-negative integers a1,a2,\xe2\x80\xa6,an. Find its expansion coefficient." 1300.0                                      
          1156G Optimizer graphs,greedy,hashing,implementation "Let\'s analyze a program written on some strange programming language. The variables in this language have names consisting of 1 to 4 characters, and each character is a lowercase or an uppercase Latin letter, or a digit. There is an extra constraint that the first character should not be a digit.There are four types of operations in the program, each denoted by one of the characters: $, ^, # or &.Each line of the program has one of the following formats:   <lvalue>=<rvalue>, where <lvalue> and <rvalue> are valid variable names;  <lvalue>=<arg1><op><arg2>, where <lvalue>, <arg1> and <arg2> are valid variable names, and <op> is an operation character. The program is executed line-by-line, and the result of execution is stored in a variable having the name res. If res is never assigned in the program, then the result will be equal to the value of res before running the program.Two programs are called equivalent if no matter which operations do characters $, ^, # and & denote (but, obviously, performing the same operation on the same arguments gives the same result) and which values do variables have before execution of program, the value of res after running the first program is equal to the value of res after running the second program (the programs are executed independently).You are given a program consisting of n lines. Your task is to write a program consisting of minimum possible number of lines that is equivalent to the program you are given." 2700.0                                      
          1156D 0-1-Tree "dfs and similar,divide and conquer,dp,dsu,trees" "You are given a tree (an undirected connected acyclic graph) consisting of n vertices and n\xe2\x88\x921 edges. A number is written on each edge, each number is either 0 (let\'s call such edges 0-edges) or 1 (those are 1-edges).Let\'s call an ordered pair of vertices (x,y) (x\xe2\x89\xa0y) valid if, while traversing the simple path from x to y, we never go through a 0-edge after going through a 1-edge. Your task is to calculate the number of valid pairs in the tree." 2200.0                                      
          1155B "Game with Telephone Numbers" games,greedy,implementation "A telephone number is a sequence of exactly 11 digits such that its first digit is 8.Vasya and Petya are playing a game. Initially they have a string s of length n (n is odd) consisting of digits. Vasya makes the first move, then players alternate turns. In one move the player must choose a character and erase it from the current string. For example, if the current string 1121, after the player\'s move it may be 112, 111 or 121. The game ends when the length of string s becomes 11. If the resulting string is a telephone number, Vasya wins, otherwise Petya wins.You have to determine if Vasya has a winning strategy (that is, if Vasya can win the game no matter which characters Petya chooses during his moves)." 1200.0                                      
          1154G "Minimum Possible LCM" "brute force,greedy,math,number theory" "You are given an array a consisting of n integers a1,a2,\xe2\x80\xa6,an.Your problem is to find such pair of indices i,j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) that lcm(ai,aj) is minimum possible.lcm(x,y) is the least common multiple of x and y (minimum positive number such that both x and y are divisors of this number)." 2200.0                                      
          1153A "Serval and Bus" "brute force,math" "It is raining heavily. But this is the first day for Serval, who just became 3 years old, to go to the kindergarten. Unfortunately, he lives far from kindergarten, and his father is too busy to drive him there. The only choice for this poor little boy is to wait for a bus on this rainy day. Under such circumstances, the poor boy will use the first bus he sees no matter where it goes. If several buses come at the same time, he will choose one randomly.Serval will go to the bus station at time t, and there are n bus routes which stop at this station. For the i-th bus route, the first bus arrives at time si minutes, and each bus of this route comes di minutes later than the previous one.As Serval\'s best friend, you wonder which bus route will he get on. If several buses arrive at the same time, you can print any of them." 1000.0                                      
          1151B "Dima and a Bad XOR" "bitmasks,brute force,constructive algorithms,dp" "Student Dima from Kremland has a matrix a of size n\xc3\x97m filled with non-negative integers.He wants to select exactly one integer from each row of the matrix so that the bitwise exclusive OR of the selected integers is strictly greater than zero. Help him!Formally, he wants to choose an integers sequence c1,c2,\xe2\x80\xa6,cn (1\xe2\x89\xa4cj\xe2\x89\xa4m) so that the inequality a1,c1\xe2\x8a\x95a2,c2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an,cn>0 holds, where ai,j is the matrix element from the i-th row and the j-th column.Here x\xe2\x8a\x95y denotes the bitwise XOR operation of integers x and y." 1600.0                                      
          1149D "Abandoning Roads" "brute force,dp,graphs,greedy" "Codefortia is a small island country located somewhere in the West Pacific. It consists of n settlements connected by m bidirectional gravel roads. Curiously enough, the beliefs of the inhabitants require the time needed to pass each road to be equal either to a or b seconds. It\'s guaranteed that one can go between any pair of settlements by following a sequence of roads.Codefortia was recently struck by the financial crisis. Therefore, the king decided to abandon some of the roads so that:  it will be possible to travel between each pair of cities using the remaining roads only,  the sum of times required to pass each remaining road will be minimum possible (in other words, remaining roads must form minimum spanning tree, using the time to pass the road as its weight),  among all the plans minimizing the sum of times above, the time required to travel between the king\'s residence (in settlement 1) and the parliament house (in settlement p) using the remaining roads only will be minimum possible. The king, however, forgot where the parliament house was. For each settlement p=1,2,\xe2\x80\xa6,n, can you tell what is the minimum time required to travel between the king\'s residence and the parliament house (located in settlement p) after some roads are abandoned?" 3000.0                                      
          1148G "Gold Experience" "constructive algorithms,graphs,math,number theory,probabilities" "Consider an undirected graph G with n vertices. There is a value ai in each vertex.Two vertices i and j are connected with an edge if and only if gcd(ai,aj)>1, where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y.Consider a set of vertices. Let\'s call a vertex in this set fair if it is connected with an edge with all other vertices in this set.You need to find a set of k vertices (where k is a given integer, 2\xe2\x8b\x85k\xe2\x89\xa4n) where all vertices are fair or all vertices are not fair. One can show that such a set always exists." 3300.0                                      
          1147D "Palindrome XOR" "dfs and similar,graphs" "You are given a string s consisting of characters ""1"", ""0"", and ""?"". The first character of s is guaranteed to be ""1"". Let m be the number of characters in s.Count the number of ways we can choose a pair of integers a,b that satisfies the following:   1\xe2\x89\xa4a<b<2m  When written without leading zeros, the base-2 representations of a and b are both palindromes.  The base-2 representation of bitwise XOR of a and b matches the pattern s. We say that t matches s if the lengths of t and s are the same and for every i, the i-th character of t is equal to the i-th character of s, or the i-th character of s is ""?"". Compute this count modulo 998244353." 2400.0                                      
          1146E "Hot is Cold" "bitmasks,data structures,divide and conquer,implementation" "You are given an array of n integers a1,a2,\xe2\x80\xa6,an.You will perform q operations. In the i-th operation, you have a symbol si which is either ""<"" or "">"" and a number xi.You make a new array b such that bj=\xe2\x88\x92aj if ajsixi and bj=aj otherwise (i.e. if si is \'>\', then all aj>xi will be flipped). After doing all these replacements, a is set to be b.You want to know what your final array looks like after all operations." 2400.0                                      
          1145D "Pigeon d\'Or" implementation "From ""ftying rats"" to urban saniwation workers - can synthetic biology tronsform how we think of pigeons? The upiquitous pigeon has long been viewed as vermin - spleading disease, scavenging through trush, and defecating in populous urban spases. Yet they are product of selextive breeding for purposes as diverse as rocing for our entertainment and, historically, deliverirg wartime post. Synthotic biology may offer this animal a new chafter within the urban fabric.Piteon d\'Or recognihes how these birds ripresent a potentially userul interface for urdan biotechnologies. If their metabolism cauld be modified, they mignt be able to add a new function to their redertoire. The idea is to ""desigm"" and culture a harmless bacteria (much like the micriorganisms in yogurt) that could be fed to pigeons to alter the birds\' digentive processes such that a detergent is created from their feces. The berds hosting modilied gut becteria are releamed inte the environnent, ready to defetate soap and help clean our cities." -999.0                                      
          1145B "Kanban Numbers" "brute force" "InputThe input contains a single integer a (1\xe2\x89\xa4a\xe2\x89\xa499).OutputOutput ""YES"" or ""NO"".ExamplesInputCopy5OutputCopyYESInputCopy13OutputCopyNOInputCopy24OutputCopyNOInputCopy46OutputCopyYES" -999.0                                      
          1144G "Two Merged Sequences" dp,greedy "Two integer sequences existed initially, one of them was strictly increasing, and another one \xe2\x80\x94 strictly decreasing.Strictly increasing sequence is a sequence of integers [x1<x2<\xe2\x8b\xaf<xk]. And strictly decreasing sequence is a sequence of integers [y1>y2>\xe2\x8b\xaf>yl]. Note that the empty sequence and the sequence consisting of one element can be considered as increasing or decreasing.Elements of increasing sequence were inserted between elements of the decreasing one (and, possibly, before its first element and after its last element) without changing the order. For example, sequences [1,3,4] and [10,4,2] can produce the following resulting sequences: [10,1,3,4,2,4], [1,3,4,10,4,2]. The following sequence cannot be the result of these insertions: [1,10,4,4,3,2] because the order of elements in the increasing sequence was changed.Let the obtained sequence be a. This sequence a is given in the input. Your task is to find any two suitable initial sequences. One of them should be strictly increasing, and another one \xe2\x80\x94 strictly decreasing. Note that the empty sequence and the sequence consisting of one element can be considered as increasing or decreasing.If there is a contradiction in the input and it is impossible to split the given sequence a into one increasing sequence and one decreasing sequence, print ""NO""." 2400.0                                      
          1144B "Parity Alternated Deletions" greedy,implementation,sortings "Polycarp has an array a consisting of n integers.He wants to play a game with this array. The game consists of several moves. On the first move he chooses any element and deletes it (after the first move the array contains n\xe2\x88\x921 elements). For each of the next moves he chooses any element with the only restriction: its parity should differ from the parity of the element deleted on the previous move. In other words, he alternates parities (even-odd-even-odd-... or odd-even-odd-even-...) of the removed elements. Polycarp stops if he can\'t make a move.Formally:   If it is the first move, he chooses any element and deletes it;  If it is the second or any next move:   if the last deleted element was odd, Polycarp chooses any even element and deletes it;  if the last deleted element was even, Polycarp chooses any odd element and deletes it.   If after some move Polycarp cannot make a move, the game ends. Polycarp\'s goal is to minimize the sum of non-deleted elements of the array after end of the game. If Polycarp can delete the whole array, then the sum of non-deleted elements is zero.Help Polycarp find this value." 900.0                                      
          1143B Nirvana "brute force,math,number theory" "Kurt reaches nirvana when he finds the product of all the digits of some positive integer. Greater value of the product makes the nirvana deeper.Help Kurt find the maximum possible product of digits among all integers from 1 to n." 1200.0                                      
          1140F "Extending Set of Points" "data structures,divide and conquer,dsu" "For a given set of two-dimensional points S, let\'s denote its extension E(S) as the result of the following algorithm:Create another set of two-dimensional points R, which is initially equal to S. Then, while there exist four numbers x1, y1, x2 and y2 such that (x1,y1)\xe2\x88\x88R, (x1,y2)\xe2\x88\x88R, (x2,y1)\xe2\x88\x88R and (x2,y2)\xe2\x88\x89R, add (x2,y2) to R. When it is impossible to find such four integers, let R be the result of the algorithm.Now for the problem itself. You are given a set of two-dimensional points S, which is initially empty. You have to process two types of queries: add some point to S, or remove some point from it. After each query you have to compute the size of E(S)." 2600.0                                      
          1140D "Minimum Triangulation" dp,greedy,math "You are given a regular polygon with n vertices labeled from 1 to n in counter-clockwise order. The triangulation of a given polygon is a set of triangles such that each vertex of each triangle is a vertex of the initial polygon, there is no pair of triangles such that their intersection has non-zero area, and the total area of all triangles is equal to the area of the given polygon. The weight of a triangulation is the sum of weigths of triangles it consists of, where the weight of a triagle is denoted as the product of labels of its vertices.Calculate the minimum weight among all triangulations of the polygon." 1200.0                                      
          1140C Playlist "brute force,data structures,sortings" "You have a playlist consisting of n songs. The i-th song is characterized by two numbers ti and bi \xe2\x80\x94 its length and beauty respectively. The pleasure of listening to set of songs is equal to the total length of the songs in the set multiplied by the minimum beauty among them. For example, the pleasure of listening to a set of 3 songs having lengths [5,7,4] and beauty values [11,14,6] is equal to (5+7+4)\xe2\x8b\x856=96.You need to choose at most k songs from your playlist, so the pleasure of listening to the set of these songs them is maximum possible." 1600.0                                      
          1139E "Maximize Mex" "flows,graph matchings,graphs" "There are n students and m clubs in a college. The clubs are numbered from 1 to m. Each student has a potential pi and is a member of the club with index ci. Initially, each student is a member of exactly one club. A technical fest starts in the college, and it will run for the next d days. There is a coding competition every day in the technical fest. Every day, in the morning, exactly one student of the college leaves their club. Once a student leaves their club, they will never join any club again. Every day, in the afternoon, the director of the college will select one student from each club (in case some club has no members, nobody is selected from that club) to form a team for this day\'s coding competition. The strength of a team is the mex of potentials of the students in the team. The director wants to know the maximum possible strength of the team for each of the coming d days. Thus, every day the director chooses such team, that the team strength is maximized.The mex of the multiset S is the smallest non-negative integer that is not present in S. For example, the mex of the {0,1,1,2,4,5,9} is 3, the mex of {1,2,3} is 0 and the mex of \xe2\x88\x85 (empty set) is 0." 2400.0                                      
          1138A "Sushi for Two" "binary search,greedy,implementation" "Arkady invited Anna for a dinner to a sushi restaurant. The restaurant is a bit unusual: it offers n pieces of sushi aligned in a row, and a customer has to choose a continuous subsegment of these sushi to buy.The pieces of sushi are of two types: either with tuna or with eel. Let\'s denote the type of the i-th from the left sushi as ti, where ti=1 means it is with tuna, and ti=2 means it is with eel.Arkady does not like tuna, Anna does not like eel. Arkady wants to choose such a continuous subsegment of sushi that it has equal number of sushi of each type and each half of the subsegment has only sushi of one type. For example, subsegment [2,2,2,1,1,1] is valid, but subsegment [1,2,1,2,1,2] is not, because both halves contain both types of sushi.Find the length of the longest continuous subsegment of sushi Arkady can buy." 900.0                                      
               92104 Labyrinth-4  "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200.0                                 
               92103 Labyrinth-3  "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200.0                                 
               92101 Labyrinth-1  "You have a robot in a two-dimensional labyrinth which consists of N\xe2\x80\x89\xc3\x97\xe2\x80\x89M cells. Some pairs of cells adjacent by side are separated by a wall or a door. The labyrinth itself is separated from the outside with walls around it. Some labyrinth cells are the exits. In order to leave the labyrinth the robot should reach any exit. There are keys in some cells. Any key can open any door but after the door is opened the key stays in the lock. Thus every key can be used only once. There are no labyrinth cells that contain both a key and an exit. Also there can not be both a wall and a door between the pair of adjacent cells.Your need to write a program in abc language (see the language description below) that will lead the robot to one of the exits. Lets numerate the labyrinth rows from 0 to N\xe2\x80\x89-\xe2\x80\x891 top to bottom and the columns \xe2\x80\x93 from 0 to M\xe2\x80\x89-\xe2\x80\x891 left to right.In abc language the following primary commands are available:  move-DIR \xe2\x80\x93 move to the adjacent cell in the  direction. down increases the number of the row by 1, right increases the number of the column by 1. In case there\xe2\x80\x99s a wall or a closed door in this direction, nothing\xe2\x80\x99s happening.  open-DIR \xe2\x80\x93 open the door between the current cell and the adjacent one in DIR direction. In case there isn\xe2\x80\x99t any door in this direction or it\xe2\x80\x99s already been opened or the robot doesn\xe2\x80\x99t have a key, nothing\xe2\x80\x99s happening. take \xe2\x80\x93 take the key in the current cell. In case there isn\xe2\x80\x99t any key or the robot has already picked it up, nothing\xe2\x80\x99s happening. The robot is able to carry any number of keys. terminate \xe2\x80\x93 terminate the program. This command is not obligatory to use. In case it\xe2\x80\x99s absent the command is added at the end of the program automatically. Also, there are the following control commands in abc language:   for-N OPS end \xe2\x80\x93 repeat the sequence of the OPS commands N times, 0\xe2\x80\x89<\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89100000. Each loop counter check counts as a command fulfilled by the robot.  if-ok  OPS1  else  OPS2  endif \xe2\x80\x93 carries out the sequence of the OPS1 commands, if the previous command of moving, taking the key or opening the door was successful, otherwise the sequence of the OPS2 commands is being carried out. Should there be no previous command run, the sequence OPS1 will be carried out. If-ok check counts as a command fulfilled by the robot.  break \xe2\x80\x93 stops the current for loop.  continue \xe2\x80\x93 finishes the current for loop iterations. Note that the control and the primary commands can be fit into each other arbitrarily.The robot will fulfill your commands sequentially until it exits the labyrinth, or it runs out of the commands, or the terminate command is run, or the quantity of the fulfilled commands exceeds the bound number 5\xc2\xb7106.In abc language each command is a separate word and should be separated from other commands with at least one space symbol.You should write a program that prints the sequence of commands leading the robot out of the labyrinth. Of course, as you are a good programmer, you should optimize these sequence.The number of the non-space symbols in the sequence should not exceed 107. If you succeed in finding the way out of the labyrinth i you\xe2\x80\x99ll be granted the number of points equal to:  where:   Wi \xe2\x80\x93 labyrinth\xe2\x80\x99s weight, some fixed constant.  Gi \xe2\x80\x93 number of robots moves.  Oi \xe2\x80\x93 number of fulfilled commands. Note that this number includes commands like take executed in the cells with no key, as well as opening commands applied to the already opened doors.  Li \xe2\x80\x93 sequence length in symbols, excluding space symbols and line breaks.  Q\xe2\x80\x89=\xe2\x80\x8910\xc2\xb7N\xc2\xb7M. In case your sequence doesn\xe2\x80\x99t lead the robot to the exit you\xe2\x80\x99ll be granted 0 points. Your programs result will be the sum of all Si. You should maximize this total sum.All labyrinths will be known and available to you. You can download the archive with labyrinths by any of the given links, password to extract files is aimtechiscool:  https://drive.google.com/file/d/1dkIBfW_Gy6c3FJtXjMXZPMsGKRyn3pzp  https://www.dropbox.com/s/77jrplnjgmviiwt/aimmaze.zip?dl=0  https://yadi.sk/d/JNXDLeH63RzaCi In order to make local testing of your programs more convenient, the program calculating your results (checker) and the labyrinth visualizer will be available. This program is written in python3 programming language, that\xe2\x80\x99s why you\xe2\x80\x99re going to need python3 interpreter, as well as pillow library, which you can install with the following command pip3 install pillow. pip3 is a utility program for python3 package (library) installation. It will be installed automatically with the python3 interpreter.Example command to run checker and visualizer: python3 aimmaze.py maze.in robot.abc --image maze.png. The checker can be run separately of visualization: python3 aimmaze.py maze.in robot.abc. Flag --output-log will let you see the information of robots each step: python3 aimmaze.py maze.in robot.abc --output-log. Note python3 can be installed as python on your computer.To adjust image settings, you can edit constants at the beginning of the program aimmaze.py." 3200.0                                 
               920E "Connected Components?" "data structures,dfs and similar,dsu,graphs" "You are given an undirected graph consisting of n vertices and  edges. Instead of giving you the edges that exist in the graph, we give you m unordered pairs (x,\xe2\x80\x89y) such that there is no edge between x and y, and if some pair of vertices is not listed in the input, then there is an edge between these vertices.You have to find the number of connected components in the graph and the size of each component. A connected component is a set of vertices X such that for every two vertices from this set there exists at least one path in the graph connecting these vertices, but adding any other vertex to X violates this rule." 2100.0                                 
               920D Tanks dp,greedy,implementation "Petya sometimes has to water his field. To water the field, Petya needs a tank with exactly V ml of water.Petya has got N tanks, i-th of them initially containing ai ml of water. The tanks are really large, any of them can contain any amount of water (no matter how large this amount is).Also Petya has got a scoop that can contain up to K ml of water (initially the scoop is empty). This scoop can be used to get some water from some tank, and after that pour it all into some tank (it is impossible to get water from multiple tanks without pouring it, or leave some water in the scoop when pouring it). When Petya tries to get some water from a tank, he gets min(v,\xe2\x80\x89K) water, where v is the current volume of water in the tank.Is it possible to obtain a tank with exactly V ml of water using these operations? If it is possible, print a sequence of operations that allows to do it. If there are multiple ways to obtain needed amount of water in some tank, print any of them." 2400.0                                 
               915A Garden implementation "Luba thinks about watering her garden. The garden can be represented as a segment of length k. Luba has got n buckets, the i-th bucket allows her to water some continuous subsegment of garden of length exactly ai each hour. Luba can\'t water any parts of the garden that were already watered, also she can\'t water the ground outside the garden.Luba has to choose one of the buckets in order to water the garden as fast as possible (as mentioned above, each hour she will water some continuous subsegment of length ai if she chooses the i-th bucket). Help her to determine the minimum number of hours she has to spend watering the garden. It is guaranteed that Luba can always choose a bucket so it is possible water the garden.See the examples for better understanding." 900.0                                 
               906E Reverses "dp,string suffix structures,strings" "Hurricane came to Berland and to suburbs Stringsvill. You are going to it to check if it\'s all right with you favorite string. Hurrinace broke it a bit by reversing some of its non-intersecting substrings. You have a photo of this string before hurricane and you want to restore it to original state using reversing minimum possible number of its substrings and find out which substrings you should reverse.You are given a string s \xe2\x80\x94 original state of your string and string t \xe2\x80\x94 state of the string after hurricane. You should select k non-intersecting substrings of t in such a way that after reverse of these substrings string will be equal s and k is minimum possible." 3300.0                                 
               906D "Power Tower" "chinese remainder theorem,math,number theory" "Priests of the Quetzalcoatl cult want to build a tower to represent a power of their god. Tower is usually made of power-charged rocks. It is built with the help of rare magic by levitating the current top of tower and adding rocks at its bottom. If top, which is built from k\xe2\x80\x89-\xe2\x80\x891 rocks, possesses power p and we want to add the rock charged with power wk then value of power of a new tower will be {wk}p. Rocks are added from the last to the first. That is for sequence w1,\xe2\x80\x89...,\xe2\x80\x89wm value of power will beAfter tower is built, its power may be extremely large. But still priests want to get some information about it, namely they want to know a number called cumulative power which is the true value of power taken modulo m. Priests have n rocks numbered from 1 to n. They ask you to calculate which value of cumulative power will the tower possess if they will build it from rocks numbered l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r." 2700.0                                 
               900C "Remove Extra One" "brute force,data structures,math" "You are given a permutation p of length n. Remove one element from permutation to make the number of records the maximum possible.We remind that in a sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak the element ai is a record if for every integer j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89i) the following holds: aj\xe2\x80\x89<\xe2\x80\x89ai." 1700.0                                 
               900B "Position in Fraction" "math,number theory" "You have a fraction . You need to find the first occurrence of digit c into decimal notation of the fraction after decimal point." 1300.0                                 
               898A Rounding implementation,math "Vasya has a non-negative integer n. He wants to round it to nearest integer, which ends up with 0. If n already ends up with 0, Vasya considers it already rounded.For example, if n\xe2\x80\x89=\xe2\x80\x894722 answer is 4720. If n\xe2\x80\x89=\xe2\x80\x895 Vasya can round it to 0 or to 10. Both ways are correct.For given n find out to which integer will Vasya round it." 800.0                                 
               896E "Welcome home, Chtholly" "data structures,dsu" "\xe2\x80\x94 I... I survived.\xe2\x80\x94 Welcome home, Chtholly.\xe2\x80\x94 I kept my promise...\xe2\x80\x94 I made it... I really made it!After several days of fighting, Chtholly Nota Seniorious miraculously returned from the fierce battle.As promised, Willem is now baking butter cake for her.However, although Willem is skilled in making dessert, he rarely bakes butter cake.This time, Willem made a big mistake \xe2\x80\x94 he accidentally broke the oven!Fortunately, Chtholly decided to help him.Willem puts n cakes on a roll, cakes are numbered from 1 to n, the i-th cake needs ai seconds of baking.Willem needs Chtholly to do m operations to bake the cakes.Operation 1: 1 l r xWillem asks Chtholly to check each cake in the range [l,\xe2\x80\x89r], if the cake needs to be baked for more than x seconds, he would bake it for x seconds and put it back in its place. More precisely, for every i in range [l,\xe2\x80\x89r], if ai is strictly more than x, ai becomes equal ai\xe2\x80\x89-\xe2\x80\x89x.Operation 2: 2 l r xWillem asks Chtholly to count the number of cakes in the range [l,\xe2\x80\x89r] that needs to be cooked for exactly x seconds. More formally you should find number of such i in range [l,\xe2\x80\x89r], that ai\xe2\x80\x89=\xe2\x80\x89x." 3100.0                                 
               895D "String Mark" combinatorics,math,strings "At the Byteland State University marks are strings of the same length. Mark x is considered better than y if string y is lexicographically smaller than x.Recently at the BSU was an important test work on which Vasya recived the mark a. It is very hard for the teacher to remember the exact mark of every student, but he knows the mark b, such that every student recieved mark strictly smaller than b.Vasya isn\'t satisfied with his mark so he decided to improve it. He can swap characters in the string corresponding to his mark as many times as he like. Now he want to know only the number of different ways to improve his mark so that his teacher didn\'t notice something suspicious.More formally: you are given two strings a, b of the same length and you need to figure out the number of different strings c such that:1) c can be obtained from a by swapping some characters, in other words c is a permutation of a.2) String a is lexicographically smaller than c.3) String c is lexicographically smaller than b.For two strings x and y of the same length it is true that x is lexicographically smaller than y if there exists such i, that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89xi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89yi\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89xi\xe2\x80\x89<\xe2\x80\x89yi.Since the answer can be very large, you need to find answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2100.0                                 
               895A "Pizza Separation" "brute force,implementation" "Students Vasya and Petya are studying at the BSU (Byteland State University). At one of the breaks they decided to order a pizza. In this problem pizza is a circle of some radius. The pizza was delivered already cut into n pieces. The i-th piece is a sector of angle equal to ai. Vasya and Petya want to divide all pieces of pizza into two continuous sectors in such way that the difference between angles of these sectors is minimal. Sector angle is sum of angles of all pieces in it. Pay attention, that one of sectors can be empty." 1200.0                                 
               893E "Counting Arrays" "combinatorics,dp,math,number theory" "You are given two positive integer numbers x and y. An array F is called an y-factorization of x iff the following conditions are met:  There are y elements in F, and all of them are integer numbers;  . You have to count the number of pairwise distinct arrays that are y-factorizations of x. Two arrays A and B are considered different iff there exists at least one index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y) such that Ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89Bi. Since the answer can be very large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2000.0                                 
               893B "Beautiful Divisors" "brute force,implementation" "Recently Luba learned about a special kind of numbers that she calls beautiful numbers. The number is called beautiful iff its binary representation consists of k\xe2\x80\x89+\xe2\x80\x891 consecutive ones, and then k consecutive zeroes.Some examples of beautiful numbers:   12 (110);  1102 (610);  11110002 (12010);  1111100002 (49610). More formally, the number is beautiful iff there exists some positive integer k such that the number is equal to (2k\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89*\xe2\x80\x89(2k\xe2\x80\x89-\xe2\x80\x891).Luba has got an integer number n, and she wants to find its greatest beautiful divisor. Help her to find it!" 1000.0                                 
               891B Gluttony "constructive algorithms,greedy" "You are given an array a with n distinct integers. Construct an array b by permuting a such that for every non-empty subset of indices S\xe2\x80\x89=\xe2\x80\x89{x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk} (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 0\xe2\x80\x89<\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n) the sums of elements on that positions in a and b are different, i. e." 2000.0                                 
               888G Xor-MST "bitmasks,constructive algorithms,data structures" "You are given a complete undirected graph with n vertices. A number ai is assigned to each vertex, and the weight of an edge between vertices i and j is equal to ai\xe2\x80\x89xor\xe2\x80\x89aj.Calculate the weight of the minimum spanning tree in this graph." 2300.0                                 
               886D "Restoration of string" "constructive algorithms,graphs,implementation" "A substring of some string is called the most frequent, if the number of its occurrences is not less than number of occurrences of any other substring.You are given a set of strings. A string (not necessarily from this set) is called good if all elements of the set are the most frequent substrings of this string. Restore the non-empty good string with minimum length. If several such strings exist, restore lexicographically minimum string. If there are no good strings, print ""NO"" (without quotes).A substring of a string is a contiguous subsequence of letters in the string. For example, ""ab"", ""c"", ""abc"" are substrings of string ""abc"", while ""ac"" is not a substring of that string.The number of occurrences of a substring in a string is the number of starting positions in the string where the substring occurs. These occurrences could overlap.String a is lexicographically smaller than string b, if a is a prefix of b, or a has a smaller letter at the first position where a and b differ." 2000.0                                 
               884A "Book Reading" implementation "Recently Luba bought a very interesting book. She knows that it will take t seconds to read the book. Luba wants to finish reading as fast as she can.But she has some work to do in each of n next days. The number of seconds that Luba has to spend working during i-th day is ai. If some free time remains, she can spend it on reading.Help Luba to determine the minimum number of day when she finishes reading.It is guaranteed that the answer doesn\'t exceed n.Remember that there are 86400 seconds in a day." 800.0                                 
               878A "Short Program" "bitmasks,constructive algorithms" "Petya learned a new programming language CALPAS. A program in this language always takes one non-negative integer and returns one non-negative integer as well.In the language, there are only three commands: apply a bitwise operation AND, OR or XOR with a given constant to the current integer. A program can contain an arbitrary sequence of these operations with arbitrary constants from 0 to 1023. When the program is run, all operations are applied (in the given order) to the argument and in the end the result integer is returned.Petya wrote a program in this language, but it turned out to be too long. Write a program in CALPAS that does the same thing as the Petya\'s program, and consists of no more than 5 lines. Your program should return the same integer as Petya\'s program for all arguments from 0 to 1023." 1600.0                                 
               877B "Nikita and string" "brute force,dp" "One day Nikita found the string containing letters ""a"" and ""b"" only. Nikita thinks that string is beautiful if it can be cut into 3 strings (possibly empty) without changing the order of the letters, where the 1-st and the 3-rd one contain only letters ""a"" and the 2-nd contains only letters ""b"".Nikita wants to make the string beautiful by removing some (possibly none) of its characters, but without changing their order. What is the maximum length of the string he can get?" 1500.0                                 
               877A "Alex and broken contest" implementation,strings "One day Alex was creating a contest about his friends, but accidentally deleted it. Fortunately, all the problems were saved, but now he needs to find them among other problems.But there are too many problems, to do it manually. Alex asks you to write a program, which will determine if a problem is from this contest by its name.It is known, that problem is from this contest if and only if its name contains one of Alex\'s friends\' name exactly once. His friends\' names are ""Danil"", ""Olya"", ""Slava"", ""Ann"" and ""Nikita"".Names are case sensitive." 1100.0                                 
               876A "Trip For Meal" math "Winnie-the-Pooh likes honey very much! That is why he decided to visit his friends. Winnie has got three best friends: Rabbit, Owl and Eeyore, each of them lives in his own house. There are winding paths between each pair of houses. The length of a path between Rabbit\'s and Owl\'s houses is a meters, between Rabbit\'s and Eeyore\'s house is b meters, between Owl\'s and Eeyore\'s house is c meters.For enjoying his life and singing merry songs Winnie-the-Pooh should have a meal n times a day. Now he is in the Rabbit\'s house and has a meal for the first time. Each time when in the friend\'s house where Winnie is now the supply of honey is about to end, Winnie leaves that house. If Winnie has not had a meal the required amount of times, he comes out from the house and goes to someone else of his two friends. For this he chooses one of two adjacent paths, arrives to the house on the other end and visits his friend. You may assume that when Winnie is eating in one of his friend\'s house, the supply of honey in other friend\'s houses recover (most probably, they go to the supply store).Winnie-the-Pooh does not like physical activity. He wants to have a meal n times, traveling minimum possible distance. Help him to find this distance." 900.0                                 
               869A "The Artful Expedient" "brute force,implementation" "Rock... Paper!After Karen have found the deterministic winning (losing?) strategy for rock-paper-scissors, her brother, Koyomi, comes up with a new game as a substitute. The game works as follows.A positive integer n is decided first. Both Koyomi and Karen independently choose n distinct positive integers, denoted by x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn and y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn respectively. They reveal their sequences, and repeat until all of 2n integers become distinct, which is the only final state to be kept and considered.Then they count the number of ordered pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that the value xi xor yj equals to one of the 2n integers. Here xor means the bitwise exclusive or operation on two integers, and is denoted by operators ^ and/or xor in most programming languages.Karen claims a win if the number of such pairs is even, and Koyomi does otherwise. And you\'re here to help determine the winner of their latest game." 1100.0                                 
               865A "Save the problem!" "constructive algorithms" "Attention: we lost all the test cases for this problem, so instead of solving the problem, we need you to generate test cases. We\'re going to give you the answer, and you need to print a test case that produces the given answer. The original problem is in the following paragraph.People don\'t use cash as often as they used to. Having a credit card solves some of the hassles of cash, such as having to receive change when you can\'t form the exact amount of money needed to purchase an item. Typically cashiers will give you as few coins as possible in change, but they don\'t have to. For example, if your change is 30 cents, a cashier could give you a 5 cent piece and a 25 cent piece, or they could give you three 10 cent pieces, or ten 1 cent pieces, two 5 cent pieces, and one 10 cent piece. Altogether there are 18 different ways to make 30 cents using only 1 cent pieces, 5 cent pieces, 10 cent pieces, and 25 cent pieces. Two ways are considered different if they contain a different number of at least one type of coin. Given the denominations of the coins and an amount of change to be made, how many different ways are there to make change?As we mentioned before, we lost all the test cases for this problem, so we\'re actually going to give you the number of ways, and want you to produce a test case for which the number of ways is the given number. There could be many ways to achieve this (we guarantee there\'s always at least one), so you can print any, as long as it meets the constraints described below." 1400.0                                 
               864C Bus greedy,implementation,math "A bus moves along the coordinate line Ox from the point x\xe2\x80\x89=\xe2\x80\x890 to the point x\xe2\x80\x89=\xe2\x80\x89a. After starting from the point x\xe2\x80\x89=\xe2\x80\x890, it reaches the point x\xe2\x80\x89=\xe2\x80\x89a, immediately turns back and then moves to the point x\xe2\x80\x89=\xe2\x80\x890. After returning to the point x\xe2\x80\x89=\xe2\x80\x890 it immediately goes back to the point x\xe2\x80\x89=\xe2\x80\x89a and so on. Thus, the bus moves from x\xe2\x80\x89=\xe2\x80\x890 to x\xe2\x80\x89=\xe2\x80\x89a and back. Moving from the point x\xe2\x80\x89=\xe2\x80\x890 to x\xe2\x80\x89=\xe2\x80\x89a or from the point x\xe2\x80\x89=\xe2\x80\x89a to x\xe2\x80\x89=\xe2\x80\x890 is called a bus journey. In total, the bus must make k journeys.The petrol tank of the bus can hold b liters of gasoline. To pass a single unit of distance the bus needs to spend exactly one liter of gasoline. The bus starts its first journey with a full petrol tank.There is a gas station in point x\xe2\x80\x89=\xe2\x80\x89f. This point is between points x\xe2\x80\x89=\xe2\x80\x890 and x\xe2\x80\x89=\xe2\x80\x89a. There are no other gas stations on the bus route. While passing by a gas station in either direction the bus can stop and completely refuel its tank. Thus, after stopping to refuel the tank will contain b liters of gasoline.What is the minimum number of times the bus needs to refuel at the point x\xe2\x80\x89=\xe2\x80\x89f to make k journeys? The first journey starts in the point x\xe2\x80\x89=\xe2\x80\x890." 1500.0                                 
               864B "Polycarp and Letters" "brute force,implementation,strings" "Polycarp loves lowercase letters and dislikes uppercase ones. Once he got a string s consisting only of lowercase and uppercase Latin letters.Let A be a set of positions in the string. Let\'s call it pretty if following conditions are met:  letters on positions from A in the string are all distinct and lowercase;  there are no uppercase letters in the string which are situated between positions from A (i.e. there is no such j that s[j] is an uppercase letter, and a1\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89a2 for some a1 and a2 from A). Write a program that will determine the maximum number of elements in a pretty set of positions." 1000.0                                 
               863G "Graphic Settings"  "Recently Ivan bought a new computer. Excited, he unpacked it and installed his favourite game. With his old computer Ivan had to choose the worst possible graphic settings (because otherwise the framerate would be really low), but now he wants to check, maybe his new computer can perform well even with the best possible graphics?There are m graphics parameters in the game. i-th parameter can be set to any positive integer from 1 to ai, and initially is set to bi (bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai). So there are  different combinations of parameters. Ivan can increase or decrease any of these parameters by 1; after that the game will be restarted with new parameters (and Ivan will have the opportunity to check chosen combination of parameters).Ivan wants to try all p possible combinations. Also he wants to return to the initial settings after trying all combinations, because he thinks that initial settings can be somehow best suited for his hardware. But Ivan doesn\'t really want to make a lot of restarts.So he wants you to tell the following:  If there exists a way to make exactly p changes (each change either decreases or increases some parameter by 1) to try all possible combinations and return to initial combination, then Ivan wants to know this way.  Otherwise, if there exists a way to make exactly p\xe2\x80\x89-\xe2\x80\x891 changes to try all possible combinations (including the initial one), then Ivan wants to know this way. Help Ivan by showing him the way to change parameters!" 3200.0                                 
               862D "Mahmoud and Ehab and the binary string" "binary search,divide and conquer,interactive" "Mahmoud and Ehab are in the fourth stage now.Dr. Evil has a hidden binary string of length n. He guarantees that there is at least one \'0\' symbol and at least one \'1\' symbol in it. Now he wants Mahmoud and Ehab to find a position of any \'0\' symbol and any \'1\' symbol. In order to do this, Mahmoud and Ehab can ask Dr. Evil up to 15 questions. They tell Dr. Evil some binary string of length n, and Dr. Evil tells the Hamming distance between these two strings. Hamming distance between 2 binary strings of the same length is the number of positions in which they have different symbols. You can find the definition of Hamming distance in the notes section below.Help Mahmoud and Ehab find these two positions.You will get Wrong Answer verdict if   Your queries doesn\'t satisfy interaction protocol described below.  You ask strictly more than 15 questions and your program terminated after exceeding queries limit. Please note, that you can do up to 15 ask queries and one answer query.  Your final answer is not correct.  You will get Idleness Limit Exceeded if you don\'t print anything or if you forget to flush the output, including for the final answer (more info about flushing output below).If you exceed the maximum number of queries, You should terminate with 0, In this case you\'ll get Wrong Answer, If you don\'t terminate you may receive any verdict because you\'ll be reading from a closed stream ." 2000.0                                 
               862B "Mahmoud and Ehab and the bipartiteness" "dfs and similar,graphs,trees" "Mahmoud and Ehab continue their adventures! As everybody in the evil land knows, Dr. Evil likes bipartite graphs, especially trees.A tree is a connected acyclic graph. A bipartite graph is a graph, whose vertices can be partitioned into 2 sets in such a way, that for each edge (u,\xe2\x80\x89v) that belongs to the graph, u and v belong to different sets. You can find more formal definitions of a tree and a bipartite graph in the notes section below.Dr. Evil gave Mahmoud and Ehab a tree consisting of n nodes and asked them to add edges to it in such a way, that the graph is still bipartite. Besides, after adding these edges the graph should be simple (doesn\'t contain loops or multiple edges). What is the maximum number of edges they can add?A loop is an edge, which connects a node with itself. Graph doesn\'t contain multiple edges when for each pair of nodes there is no more than one edge between them. A cycle and a loop aren\'t the same ." 1300.0                                 
               860E "Arkady and a Nobody-men" "data structures,dfs and similar,trees" "Arkady words in a large company. There are n employees working in a system of a strict hierarchy. Namely, each employee, with an exception of the CEO, has exactly one immediate manager. The CEO is a manager (through a chain of immediate managers) of all employees.Each employee has an integer rank. The CEO has rank equal to 1, each other employee has rank equal to the rank of his immediate manager plus 1.Arkady has a good post in the company, however, he feels that he is nobody in the company\'s structure, and there are a lot of people who can replace him. He introduced the value of replaceability. Consider an employee a and an employee b, the latter being manager of a (not necessarily immediate). Then the replaceability r(a,\xe2\x80\x89b) of a with respect to b is the number of subordinates (not necessarily immediate) of the manager b, whose rank is not greater than the rank of a. Apart from replaceability, Arkady introduced the value of negligibility. The negligibility za of employee a equals the sum of his replaceabilities with respect to all his managers, i.e. , where the sum is taken over all his managers b.Arkady is interested not only in negligibility of himself, but also in negligibility of all employees in the company. Find the negligibility of each employee for Arkady." 2700.0                                 
               859G "Circle of Numbers" math "n evenly spaced points have been marked around the edge of a circle. There is a number written at each point. You choose a positive real number k. Then you may repeatedly select a set of 2 or more points which are evenly spaced, and either increase all numbers at points in the set by k or decrease all numbers at points in the set by k. You would like to eventually end up with all numbers equal to 0. Is it possible?A set of 2 points is considered evenly spaced if they are diametrically opposed, and a set of 3 or more points is considered evenly spaced if they form a regular polygon." 3000.0                                 
               858F "Wizard\'s Tour" "constructive algorithms,dfs and similar,graphs" "All Berland residents are waiting for an unprecedented tour of wizard in his Blue Helicopter over the cities of Berland!It is well-known that there are n cities in Berland, some pairs of which are connected by bidirectional roads. Each pair of cities is connected by no more than one road. It is not guaranteed that the road network is connected, i.e. it is possible that you can\'t reach some city from some other.The tour will contain several episodes. In each of the episodes:  the wizard will disembark at some city x from the Helicopter;  he will give a performance and show a movie for free at the city x;  he will drive to some neighboring city y using a road;  he will give a performance and show a movie for free at the city y;  he will drive to some neighboring to y city z;  he will give a performance and show a movie for free at the city z;  he will embark the Helicopter and fly away from the city z. It is known that the wizard doesn\'t like to use roads, so he agrees to use each road at most once (regardless of direction). In other words, for road between a and b he only can drive once from a to b, or drive once from b to a, or do not use this road at all.The wizards wants to plan as many episodes as possible without violation the above rules. Help the wizard!Please note that the wizard can visit the same city multiple times, the restriction is on roads only." 2300.0                                 
               858D "Polycarp\'s phone book" "data structures,implementation,sortings" "There are n phone numbers in Polycarp\'s contacts on his phone. Each number is a 9-digit integer, starting with a digit different from 0. All the numbers are distinct.There is the latest version of Berdroid OS installed on Polycarp\'s phone. If some number is entered, is shows up all the numbers in the contacts for which there is a substring equal to the entered sequence of digits. For example, is there are three phone numbers in Polycarp\'s contacts: 123456789, 100000000 and 100123456, then:  if he enters 00 two numbers will show up: 100000000 and 100123456,  if he enters 123 two numbers will show up 123456789 and 100123456,  if he enters 01 there will be only one number 100123456. For each of the phone numbers in Polycarp\'s contacts, find the minimum in length sequence of digits such that if Polycarp enters this sequence, Berdroid shows this only phone number." 1600.0                                 
               856D "Masha and Cactus" dp,trees "Masha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree.Recall that tree is a connected undirected graph that has no cycles. Cactus is a connected undirected graph such that each vertex belongs to at most one cycle.Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and the beauty of this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus. Beauty of the resulting cactus is sum of beauties of all added edges. Help Masha find out what maximum beauty of the resulting cactus she can achieve." 2400.0                                 
               856A "Set Theory" "brute force,constructive algorithms" "Masha and Grisha like studying sets of positive integers.One day Grisha has written a set A containing n different integers ai on a blackboard. Now he asks Masha to create a set B containing n different integers bj such that all n2 integers that can be obtained by summing up ai and bj for all possible pairs of i and j are different.Both Masha and Grisha don\'t like big numbers, so all numbers in A are from 1 to 106, and all numbers in B must also be in the same range.Help Masha to create the set B that satisfies Grisha\'s requirement." 1600.0                                 
               853C Boredom "data structures" "Ilya is sitting in a waiting area of Metropolis airport and is bored of looking at time table that shows again and again that his plane is delayed. So he took out a sheet of paper and decided to solve some problems.First Ilya has drawn a grid of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n and marked n squares on it, such that no two marked squares share the same row or the same column. He calls a rectangle on a grid with sides parallel to grid sides beautiful if exactly two of its corner squares are marked. There are exactly n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89/\xe2\x80\x892 beautiful rectangles.Ilya has chosen q query rectangles on a grid with sides parallel to grid sides (not necessarily beautiful ones), and for each of those rectangles he wants to find its beauty degree. Beauty degree of a rectangle is the number of beautiful rectangles that share at least one square with the given one.Now Ilya thinks that he might not have enough time to solve the problem till the departure of his flight. You are given the description of marked cells and the query rectangles, help Ilya find the beauty degree of each of the query rectangles." 2100.0                                 
               852I Dating "brute force,dfs and similar,graphs,trees" "This story is happening in a town named BubbleLand. There are n houses in BubbleLand. In each of these n houses lives a boy or a girl. People there really love numbers and everyone has their favorite number f. That means that the boy or girl that lives in the i-th house has favorite number equal to fi.The houses are numerated with numbers 1 to n.The houses are connected with n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads and you can travel from any house to any other house in the town. There is exactly one path between every pair of houses.A new dating had agency opened their offices in this mysterious town and the citizens were very excited. They immediately sent q questions to the agency and each question was of the following format:   a b \xe2\x80\x94 asking how many ways are there to choose a couple (boy and girl) that have the same favorite number and live in one of the houses on the unique path from house a to house b. Help the dating agency to answer the questions and grow their business." 2300.0                                 
               846C "Four Segments" "brute force,data structures,dp" "You are given an array of n integer numbers. Let sum(l,\xe2\x80\x89r) be the sum of all numbers on positions from l to r non-inclusive (l-th element is counted, r-th element is not counted). For indices l and r holds 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Indices in array are numbered from 0. For example, if a\xe2\x80\x89=\xe2\x80\x89[\xe2\x80\x89-\xe2\x80\x895,\xe2\x80\x893,\xe2\x80\x899,\xe2\x80\x894], then sum(0,\xe2\x80\x891)\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x895, sum(0,\xe2\x80\x892)\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892, sum(1,\xe2\x80\x894)\xe2\x80\x89=\xe2\x80\x8916 and sum(i,\xe2\x80\x89i)\xe2\x80\x89=\xe2\x80\x890 for each i from 0 to 4.Choose the indices of three delimiters delim0, delim1, delim2 (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89delim0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89delim1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89delim2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and divide the array in such a way that the value of res\xe2\x80\x89=\xe2\x80\x89sum(0,\xe2\x80\x89delim0) - sum(delim0,\xe2\x80\x89delim1) + sum(delim1,\xe2\x80\x89delim2) - sum(delim2,\xe2\x80\x89n) is maximal. Note that some of the expressions sum(l,\xe2\x80\x89r) can correspond to empty segments (if l\xe2\x80\x89=\xe2\x80\x89r for some segment)." 1800.0                                 
               843A "Sorting by Subsequences" "dfs and similar,dsu,implementation,math,sortings" "You are given a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an consisting of different integers. It is required to split this sequence into the maximum number of subsequences such that after sorting integers in each of them in increasing order, the total sequence also will be sorted in increasing order.Sorting integers in a subsequence is a process such that the numbers included in a subsequence are ordered in increasing order, and the numbers which are not included in a subsequence don\'t change their places.Every element of the sequence must appear in exactly one subsequence." 1400.0                                 
               840B "Leha and another game about graph" "constructive algorithms,data structures,dfs and similar,dp,graphs" "Leha plays a computer game, where is on each level is given a connected graph with n vertices and m edges. Graph can contain multiple edges, but can not contain self loops. Each vertex has an integer di, which can be equal to 0, 1 or \xe2\x80\x89-\xe2\x80\x891. To pass the level, he needs to find a \xc2\xabgood\xc2\xbb subset of edges of the graph or say, that it doesn\'t exist. Subset is called \xc2\xabgood\xc2\xbb, if by by leaving only edges from this subset in the original graph, we obtain the following: for every vertex i, di\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891 or it\'s degree modulo 2 is equal to di. Leha wants to pass the game as soon as possible and ask you to help him. In case of multiple correct answers, print any of them." 2100.0                                 
               839C Journey "dfs and similar,dp,graphs,probabilities,trees" "There are n cities and n\xe2\x80\x89-\xe2\x80\x891 roads in the Seven Kingdoms, each road connects two cities and we can reach any city from any other by the roads.Theon and Yara Greyjoy are on a horse in the first city, they are starting traveling through the roads. But the weather is foggy, so they can\xe2\x80\x99t see where the horse brings them. When the horse reaches a city (including the first one), it goes to one of the cities connected to the current city. But it is a strange horse, it only goes to cities in which they weren\'t before. In each such city, the horse goes with equal probabilities and it stops when there are no such cities. Let the length of each road be 1. The journey starts in the city 1. What is the expected length (expected value of length) of their journey? You can read about expected (average) value by the link https://en.wikipedia.org/wiki/Expected_value." 1500.0                                 
               838F "Expected Earnings"  "You are playing a game with a bag of red and black balls. Initially, you are told that the bag has n balls total. In addition, you are also told that the bag has probability pi\xe2\x80\x89/\xe2\x80\x89106 of containing exactly i red balls.You now would like to buy balls from this bag. You really like the color red, so red balls are worth a unit of 1, while black balls are worth nothing. To buy a ball, if there are still balls in the bag, you pay a cost c with 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891, and draw a ball randomly from the bag. You can choose to stop buying at any point (and you can even choose to not buy anything at all).Given that you buy optimally to maximize the expected profit (i.e. # red balls - cost needed to obtain them), print the maximum expected profit." 2800.0                                 
               838B "Diverging Directions" "data structures,dfs and similar,trees" "You are given a directed weighted graph with n nodes and 2n\xe2\x80\x89-\xe2\x80\x892 edges. The nodes are labeled from 1 to n, while the edges are labeled from 1 to 2n\xe2\x80\x89-\xe2\x80\x892. The graph\'s edges can be split into two parts.  The first n\xe2\x80\x89-\xe2\x80\x891 edges will form a rooted spanning tree, with node 1 as the root. All these edges will point away from the root.  The last n\xe2\x80\x89-\xe2\x80\x891 edges will be from node i to node 1, for all 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. You are given q queries. There are two types of queries  1 i w: Change the weight of the i-th edge to w  2 u v: Print the length of the shortest path between nodes u to v Given these queries, print the shortest path lengths." 2100.0                                 
               837E "Vasya\'s Function" "binary search,implementation,math" "Vasya is studying number theory. He has denoted a function f(a,\xe2\x80\x89b) such that:  f(a,\xe2\x80\x890)\xe2\x80\x89=\xe2\x80\x890;  f(a,\xe2\x80\x89b)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89f(a,\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89gcd(a,\xe2\x80\x89b)), where gcd(a,\xe2\x80\x89b) is the greatest common divisor of a and b. Vasya has two numbers x and y, and he wants to calculate f(x,\xe2\x80\x89y). He tried to do it by himself, but found out that calculating this function the way he wants to do that might take very long time. So he decided to ask you to implement a program that will calculate this function swiftly." 2100.0                                 
               833B "The Bakery" "binary search,data structures,divide and conquer,dp,two pointers" "Some time ago Slastyona the Sweetmaid decided to open her own bakery! She bought required ingredients and a wonder-oven which can bake several types of cakes, and opened the bakery.Soon the expenses started to overcome the income, so Slastyona decided to study the sweets market. She learned it\'s profitable to pack cakes in boxes, and that the more distinct cake types a box contains (let\'s denote this number as the value of the box), the higher price it has.She needs to change the production technology! The problem is that the oven chooses the cake types on its own and Slastyona can\'t affect it. However, she knows the types and order of n cakes the oven is going to bake today. Slastyona has to pack exactly k boxes with cakes today, and she has to put in each box several (at least one) cakes the oven produced one right after another (in other words, she has to put in a box a continuous segment of cakes).Slastyona wants to maximize the total value of all boxes with cakes. Help her determine this maximum possible total value." 2200.0                                 
               832D "Misha, Grisha and Underground" "dfs and similar,graphs,trees" "Misha and Grisha are funny boys, so they like to use new underground. The underground has n stations connected with n\xe2\x80\x89-\xe2\x80\x891 routes so that each route connects two stations, and it is possible to reach every station from any other.The boys decided to have fun and came up with a plan. Namely, in some day in the morning Misha will ride the underground from station s to station f by the shortest path, and will draw with aerosol an ugly text ""Misha was here"" on every station he will pass through (including s and f). After that on the same day at evening Grisha will ride from station t to station f by the shortest path and will count stations with Misha\'s text. After that at night the underground workers will wash the texts out, because the underground should be clean. The boys have already chosen three stations a, b and c for each of several following days, one of them should be station s on that day, another should be station f, and the remaining should be station t. They became interested how they should choose these stations s, f, t so that the number Grisha will count is as large as possible. They asked you for help." 1900.0                                 
               831C "Jury Marks" "brute force,constructive algorithms" "Polycarp watched TV-show where k jury members one by one rated a participant by adding him a certain number of points (may be negative, i. e. points were subtracted). Initially the participant had some score, and each the marks were one by one added to his score. It is known that the i-th jury member gave ai points.Polycarp does not remember how many points the participant had before this k marks were given, but he remembers that among the scores announced after each of the k judges rated the participant there were n (n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) values b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn (it is guaranteed that all values bj are distinct). It is possible that Polycarp remembers not all of the scores announced, i. e. n\xe2\x80\x89<\xe2\x80\x89k. Note that the initial score wasn\'t announced.Your task is to determine the number of options for the score the participant could have before the judges rated the participant." 1700.0                                 
               828A "Restaurant Tables" implementation "In a small restaurant there are a tables for one person and b tables for two persons. It it known that n groups of people come today, each consisting of one or two people. If a group consist of one person, it is seated at a vacant one-seater table. If there are none of them, it is seated at a vacant two-seater table. If there are none of them, it is seated at a two-seater table occupied by single person. If there are still none of them, the restaurant denies service to this group.If a group consist of two people, it is seated at a vacant two-seater table. If there are none of them, the restaurant denies service to this group.You are given a chronological order of groups coming. You are to determine the total number of people the restaurant denies service to." 1200.0                                 
               825F "String Compression" "dp,hashing,string suffix structures,strings" "Ivan wants to write a letter to his friend. The letter is a string s consisting of lowercase Latin letters.Unfortunately, when Ivan started writing the letter, he realised that it is very long and writing the whole letter may take extremely long time. So he wants to write the compressed version of string s instead of the string itself.The compressed version of string s is a sequence of strings c1,\xe2\x80\x89s1,\xe2\x80\x89c2,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89ck,\xe2\x80\x89sk, where ci is the decimal representation of number ai (without any leading zeroes) and si is some string consisting of lowercase Latin letters. If Ivan writes string s1 exactly a1 times, then string s2 exactly a2 times, and so on, the result will be string s.The length of a compressed version is |c1|\xe2\x80\x89+\xe2\x80\x89|s1|\xe2\x80\x89+\xe2\x80\x89|c2|\xe2\x80\x89+\xe2\x80\x89|s2|... |ck|\xe2\x80\x89+\xe2\x80\x89|sk|. Among all compressed versions Ivan wants to choose a version such that its length is minimum possible. Help Ivan to determine minimum possible length." 2400.0                                 
               825C "Multi-judge Solving" greedy,implementation "Makes solves problems on Decoforces and lots of other different online judges. Each problem is denoted by its difficulty \xe2\x80\x94 a positive integer number. Difficulties are measured the same across all the judges (the problem with difficulty d on Decoforces is as hard as the problem with difficulty d on any other judge). Makes has chosen n problems to solve on Decoforces with difficulties a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. He can solve these problems in arbitrary order. Though he can solve problem i with difficulty ai only if he had already solved some problem with difficulty  (no matter on what online judge was it).Before starting this chosen list of problems, Makes has already solved problems with maximum difficulty k.With given conditions it\'s easy to see that Makes sometimes can\'t solve all the chosen problems, no matter what order he chooses. So he wants to solve some problems on other judges to finish solving problems from his list. For every positive integer y there exist some problem with difficulty y on at least one judge besides Decoforces.Makes can solve problems on any judge at any time, it isn\'t necessary to do problems from the chosen list one right after another.Makes doesn\'t have too much free time, so he asked you to calculate the minimum number of problems he should solve on other judges in order to solve all the chosen problems from Decoforces." 1600.0                                 
               822C "Hacker, pack your bags!" "binary search,greedy,implementation,sortings" "It\'s well known that the best way to distract from something is to do one\'s favourite thing. Job is such a thing for Leha.So the hacker began to work hard in order to get rid of boredom. It means that Leha began to hack computers all over the world. For such zeal boss gave the hacker a vacation of exactly x days. You know the majority of people prefer to go somewhere for a vacation, so Leha immediately went to the travel agency. There he found out that n vouchers left. i-th voucher is characterized by three integers li, ri, costi \xe2\x80\x94 day of departure from Vi\xc4\x8dkopolis, day of arriving back in Vi\xc4\x8dkopolis and cost of the voucher correspondingly. The duration of the i-th voucher is a value ri\xe2\x80\x89-\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891.At the same time Leha wants to split his own vocation into two parts. Besides he wants to spend as little money as possible. Formally Leha wants to choose exactly two vouchers i and j (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) so that they don\'t intersect, sum of their durations is exactly x and their total cost is as minimal as possible. Two vouchers i and j don\'t intersect if only at least one of the following conditions is fulfilled: ri\xe2\x80\x89<\xe2\x80\x89lj or rj\xe2\x80\x89<\xe2\x80\x89li.Help Leha to choose the necessary vouchers!" 1600.0                                 
               822A "I\'m bored with life" "implementation,math,number theory" "Holidays have finished. Thanks to the help of the hacker Leha, Noora managed to enter the university of her dreams which is located in a town Pavlopolis. It\'s well known that universities provide students with dormitory for the period of university studies. Consequently Noora had to leave Vi\xc4\x8dkopolis and move to Pavlopolis. Thus Leha was left completely alone in a quiet town Vi\xc4\x8dkopolis. He almost even fell into a depression from boredom!Leha came up with a task for himself to relax a little. He chooses two integers A and B and then calculates the greatest common divisor of integers ""A factorial"" and ""B factorial"". Formally the hacker wants to find out GCD(A!,\xe2\x80\x89B!). It\'s well known that the factorial of an integer x is a product of all positive integers less than or equal to x. Thus x!\xe2\x80\x89=\xe2\x80\x891\xc2\xb72\xc2\xb73\xc2\xb7...\xc2\xb7(x\xe2\x80\x89-\xe2\x80\x891)\xc2\xb7x. For example 4!\xe2\x80\x89=\xe2\x80\x891\xc2\xb72\xc2\xb73\xc2\xb74\xe2\x80\x89=\xe2\x80\x8924. Recall that GCD(x,\xe2\x80\x89y) is the largest positive integer q that divides (without a remainder) both x and y.Leha has learned how to solve this task very effective. You are able to cope with it not worse, aren\'t you?" 800.0                                 
               818B "Permutation Game" implementation "n children are standing in a circle and playing a game. Children\'s numbers in clockwise order form a permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of length n. It is an integer sequence such that each integer from 1 to n appears exactly once in it.The game consists of m steps. On each step the current leader with index i counts out ai people in clockwise order, starting from the next person. The last one to be pointed at by the leader becomes the new leader.You are given numbers l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lm \xe2\x80\x94 indices of leaders in the beginning of each step. Child with number l1 is the first leader in the game. Write a program which will restore a possible permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. If there are multiple solutions then print any of them. If there is no solution then print -1." 1600.0                                 
               814A "An abandoned sentiment from past" "constructive algorithms,greedy,implementation,sortings" "A few years ago, Hitagi encountered a giant crab, who stole the whole of her body weight. Ever since, she tried to avoid contact with others, for fear that this secret might be noticed.To get rid of the oddity and recover her weight, a special integer sequence is needed. Hitagi\'s sequence has been broken for a long time, but now Kaiki provides an opportunity.Hitagi\'s sequence a has a length of n. Lost elements in it are denoted by zeros. Kaiki provides another sequence b, whose length k equals the number of lost elements in a (i.e. the number of zeros). Hitagi is to replace each zero in a with an element from b so that each element in b should be used exactly once. Hitagi knows, however, that, apart from 0, no integer occurs in a and b more than once in total.If the resulting sequence is not an increasing sequence, then it has the power to recover Hitagi from the oddity. You are to determine whether this is possible, or Kaiki\'s sequence is just another fake. In other words, you should detect whether it is possible to replace each zero in a with an integer from b so that each integer from b is used exactly once, and the resulting sequence is not increasing." 900.0                                 
               811D "Vladik and Favorite Game" "constructive algorithms,dfs and similar,graphs,interactive" "This is an interactive problem.Vladik has favorite game, in which he plays all his free time.Game field could be represented as n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix which consists of cells of three types:   \xc2\xab.\xc2\xbb \xe2\x80\x94 normal cell, player can visit it.  \xc2\xabF\xc2\xbb \xe2\x80\x94 finish cell, player has to finish his way there to win. There is exactly one cell of this type.  \xc2\xab*\xc2\xbb \xe2\x80\x94 dangerous cell, if player comes to this cell, he loses. Initially player is located in the left top cell with coordinates (1,\xe2\x80\x891). Player has access to 4 buttons ""U"", ""D"", ""L"", ""R"", each of them move player up, down, left and right directions respectively.But it\xe2\x80\x99s not that easy! Sometimes friends play game and change functions of buttons. Function of buttons ""L"" and ""R"" could have been swapped, also functions of buttons ""U"" and ""D"" could have been swapped. Note that functions of buttons can be changed only at the beginning of the game.Help Vladik win the game!" 2100.0                                 
               811B "Vladik and Complicated Book" implementation,sortings "Vladik had started reading a complicated book about algorithms containing n pages. To improve understanding of what is written, his friends advised him to read pages in some order given by permutation P\xe2\x80\x89=\xe2\x80\x89[p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn], where pi denotes the number of page that should be read i-th in turn.Sometimes Vladik\xe2\x80\x99s mom sorted some subsegment of permutation P from position l to position r inclusive, because she loves the order. For every of such sorting Vladik knows number x \xe2\x80\x94 what index of page in permutation he should read. He is wondered if the page, which he will read after sorting, has changed. In other words, has px changed? After every sorting Vladik return permutation to initial state, so you can assume that each sorting is independent from each other." 1200.0                                 
               809D "Hitchhiking in the Baltic States" "data structures,dp" "Leha and Noora decided to go on a trip in the Baltic States. As you know from the previous problem, Leha has lost his car on the parking of the restaurant. Unfortunately, requests to the watchman didn\'t helped hacker find the car, so friends decided to go hitchhiking.In total, they intended to visit n towns. However it turned out that sights in i-th town are open for visitors only on days from li to ri.What to do? Leha proposed to choose for each town i a day, when they will visit this town, i.e any integer xi in interval [li,\xe2\x80\x89ri]. After that Noora choses some subsequence of towns id1,\xe2\x80\x89id2,\xe2\x80\x89...,\xe2\x80\x89idk, which friends are going to visit, that at first they are strictly increasing, i.e idi\xe2\x80\x89<\xe2\x80\x89idi\xe2\x80\x89+\xe2\x80\x891 is for all integers i from 1 to k\xe2\x80\x89-\xe2\x80\x891, but also the dates of the friends visits are strictly increasing, i.e xidi\xe2\x80\x89<\xe2\x80\x89xidi\xe2\x80\x89+\xe2\x80\x891 is true for all integers i from 1 to k\xe2\x80\x89-\xe2\x80\x891.Please help Leha and Noora in choosing such xi for each town i, and such subsequence of towns id1,\xe2\x80\x89id2,\xe2\x80\x89...,\xe2\x80\x89idk, so that friends can visit maximal number of towns.You may assume, that Leha and Noora can start the trip any day." 2900.0                                 
               804E "The same permutation" "constructive algorithms" "Seyyed and MoJaK are friends of Sajjad. Sajjad likes a permutation. Seyyed wants to change the permutation in a way that Sajjad won\'t like it. Seyyed thinks more swaps yield more probability to do that, so he makes MoJaK to perform a swap between every pair of positions (i,\xe2\x80\x89j), where i\xe2\x80\x89<\xe2\x80\x89j, exactly once. MoJaK doesn\'t like to upset Sajjad.Given the permutation, determine whether it is possible to swap all pairs of positions so that the permutation stays the same. If it is possible find how to do that." 3100.0                                 
               802O "April Fools\' Problem (hard)" "binary search,data structures,flows" "The plans for HC2 are rather far-fetched: we are just over 500 000 days away from HC2 3387, for example, and accordingly we are planning to have a couple hundred thousand problems in that edition (we hope that programming contests will become wildly more popular). The marmots need to get to work, and they could use a good plan..." 2900.0                                 
               802M "April Fools\' Problem (easy)" greedy,sortings "The marmots have prepared a very easy problem for this year\'s HC2 \xe2\x80\x93 this one. It involves numbers n, k and a sequence of n positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. They also came up with a beautiful and riveting story for the problem statement. It explains what the input means, what the program should output, and it also reads like a good criminal.However I, Heidi, will have none of that. As my joke for today, I am removing the story from the statement and replacing it with these two unhelpful paragraphs. Now solve the problem, fools!" 1200.0                                 
               802H "Fake News (medium)" "constructive algorithms,strings" "Thanks to your help, Heidi is confident that no one can fool her. She has now decided to post some fake news on the HC2 Facebook page. However, she wants to be able to communicate to the HC2 committee that the post is fake, using some secret phrase hidden in the post as a subsequence. To make this method foolproof, she wants the phrase to appear n times in the post. She is asking you to design a post (string) s and a hidden phrase p such that p appears in s as a subsequence exactly n times." 2200.0                                 
               798D "Mike and distribution" "constructive algorithms,sortings" "Mike has always been thinking about the harshness of social inequality. He\'s so obsessed with it that sometimes it even affects him while solving problems. At the moment, Mike has two sequences of positive integers A\xe2\x80\x89=\xe2\x80\x89[a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an] and B\xe2\x80\x89=\xe2\x80\x89[b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn] of length n each which he uses to ask people some quite peculiar questions.To test you on how good are you at spotting inequality in life, he wants you to find an ""unfair"" subset of the original sequence. To be more precise, he wants you to select k numbers P\xe2\x80\x89=\xe2\x80\x89[p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk] such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k and elements in P are distinct. Sequence P will represent indices of elements that you\'ll select from both sequences. He calls such a subset P ""unfair"" if and only if the following conditions are satisfied: 2\xc2\xb7(ap1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89apk) is greater than the sum of all elements from sequence A, and 2\xc2\xb7(bp1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89bpk) is greater than the sum of all elements from the sequence B. Also, k should be smaller or equal to  because it will be to easy to find sequence P if he allowed you to select too many elements!Mike guarantees you that a solution will always exist given the conditions described above, so please help him satisfy his curiosity!" 2400.0                                 
               798A "Mike and palindrome" "brute force,constructive algorithms,strings" "Mike has a string s consisting of only lowercase English letters. He wants to change exactly one character from the string so that the resulting one is a palindrome. A palindrome is a string that reads the same backward as forward, for example strings ""z"", ""aaa"", ""aba"", ""abccba"" are palindromes, but strings ""codeforces"", ""reality"", ""ab"" are not." 1000.0                                 
               797F "Mice and Holes" "data structures,dp,greedy,sortings" "One day Masha came home and noticed n mice in the corridor of her flat. Of course, she shouted loudly, so scared mice started to run to the holes in the corridor.The corridor can be represeted as a numeric axis with n mice and m holes on it. ith mouse is at the coordinate xi, and jth hole \xe2\x80\x94 at coordinate pj. jth hole has enough room for cj mice, so not more than cj mice can enter this hole.What is the minimum sum of distances that mice have to go through so that they all can hide in the holes? If ith mouse goes to the hole j, then its distance is |xi\xe2\x80\x89-\xe2\x80\x89pj|.Print the minimum sum of distances." 2600.0                                 
               796F "Sequence Recovery" "bitmasks,data structures,greedy" "Zane once had a good sequence a consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an \xe2\x80\x94 but he has lost it.A sequence is said to be good if and only if all of its integers are non-negative and do not exceed 109 in value.  However, Zane remembers having played around with his sequence by applying m operations to it.There are two types of operations:1. Find the maximum value of integers with indices i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r, given l and r.2. Assign d as the value of the integer with index k, given k and d.After he finished playing, he restored his sequence to the state it was before any operations were applied. That is, sequence a was no longer affected by the applied type 2 operations. Then, he lost his sequence at some time between now and then.Fortunately, Zane remembers all the operations and the order he applied them to his sequence, along with the distinct results of all type 1 operations. Moreover, among all good sequences that would produce the same results when the same operations are applied in the same order, he knows that his sequence a has the greatest cuteness.We define cuteness of a sequence as the bitwise OR result of all integers in such sequence. For example, the cuteness of Zane\'s sequence a is a1 OR a2 OR ... OR an.Zane understands that it might not be possible to recover exactly the lost sequence given his information, so he would be happy to get any good sequence b consisting of n integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn that:1. would give the same results when the same operations are applied in the same order, and2. has the same cuteness as that of Zane\'s original sequence a.If there is such a sequence, find it. Otherwise, it means that Zane must have remembered something incorrectly, which is possible." 2800.0                                 
               794D "Labelling Cities" "dfs and similar,graphs,hashing" "Oleg the bank client lives in Bankopolia. There are n cities in Bankopolia and some pair of cities are connected directly by bi-directional roads. The cities are numbered from 1 to n. There are a total of m roads in Bankopolia, the i-th road connects cities ui and vi. It is guaranteed that from each city it is possible to travel to any other city using some of the roads.Oleg wants to give a label to each city. Suppose the label of city i is equal to xi. Then, it must hold that for all pairs of cities (u,\xe2\x80\x89v) the condition |xu\xe2\x80\x89-\xe2\x80\x89xv|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 holds if and only if there is a road connecting u and v.Oleg wonders if such a labeling is possible. Find an example of such labeling if the task is possible and state that it is impossible otherwise." 2400.0                                 
               788D "Finding lines" "constructive algorithms,divide and conquer,interactive" "After some programming contest Roma decided to try himself in tourism. His home country Uzhlyandia is a Cartesian plane. He wants to walk along each of the Main Straight Lines in Uzhlyandia. It is known that each of these lines is a straight line parallel to one of the axes (i.e. it is described with the equation x\xe2\x80\x89=\xe2\x80\x89a or y\xe2\x80\x89=\xe2\x80\x89a, where a is integer called the coordinate of this line).Roma lost his own map, so he should find out the coordinates of all lines at first. Uncle Anton agreed to help him, using the following rules:   Initially Roma doesn\'t know the number of vertical and horizontal lines and their coordinates;  Roma can announce integer coordinates of some point in Uzhlandia, and Anton then will tell him the minimum among the distances from the chosen point to each of the lines. However, since the coordinates of the lines don\'t exceed 108 by absolute value, Roma can\'t choose a point with coordinates exceeding 108 by absolute value. Uncle Anton is in a hurry to the UOI (Uzhlandian Olympiad in Informatics), so he can only answer no more than 3\xc2\xb7105 questions.The problem is that Roma doesn\'t know how to find out the coordinates of the lines. Write a program that plays Roma\'s role and finds the coordinates." 3000.0                                 
               788A "Functions again" "dp,two pointers" "Something happened in Uzhlyandia again... There are riots on the streets... Famous Uzhlyandian superheroes Shean the Sheep and Stas the Giraffe were called in order to save the situation. Upon the arriving, they found that citizens are worried about maximum values of the Main Uzhlyandian Function f, which is defined as follows:In the above formula, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n must hold, where n is the size of the Main Uzhlyandian Array a, and |x| means absolute value of x. But the heroes skipped their math lessons in school, so they asked you for help. Help them calculate the maximum value of f among all possible values of l and r for the given array a." 1600.0                                 
               786C "Till I Collapse" "data structures,divide and conquer" "Rick and Morty want to find MR. PBH and they can\'t do it alone. So they need of Mr. Meeseeks. They Have generated n Mr. Meeseeks, standing in a line numbered from 1 to n. Each of them has his own color. i-th Mr. Meeseeks\' color is ai. Rick and Morty are gathering their army and they want to divide Mr. Meeseeks into some squads. They don\'t want their squads to be too colorful, so each squad should have Mr. Meeseeks of at most k different colors. Also each squad should be a continuous subarray of Mr. Meeseeks in the line. Meaning that for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89e\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, if Mr. Meeseeks number i and Mr. Meeseeks number j are in the same squad then Mr. Meeseeks number e should be in that same squad.  Also, each squad needs its own presidio, and building a presidio needs money, so they want the total number of squads to be minimized.Rick and Morty haven\'t finalized the exact value of k, so in order to choose it, for each k between 1 and n (inclusive) need to know the minimum number of presidios needed." 2400.0                                 
               784A "Numbers Joke" "*special problem" "InputThe input contains a single integer a (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8930).OutputOutput a single integer.ExampleInputCopy3OutputCopy27" 1700.0                                 
               778C "Peterson Polyglot" "brute force,dfs and similar,dsu,hashing,strings,trees" "Peterson loves to learn new languages, but his favorite hobby is making new ones. Language is a set of words, and word is a sequence of lowercase Latin letters.Peterson makes new language every morning. It is difficult task to store the whole language, so Peterson have invented new data structure for storing his languages which is called broom. Broom is rooted tree with edges marked with letters. Initially broom is represented by the only vertex \xe2\x80\x94 the root of the broom. When Peterson wants to add new word to the language he stands at the root and processes the letters of new word one by one. Consider that Peterson stands at the vertex u. If there is an edge from u marked with current letter, Peterson goes through this edge. Otherwise Peterson adds new edge from u to the new vertex v, marks it with the current letter and goes through the new edge. Size of broom is the number of vertices in it.In the evening after working day Peterson can\'t understand the language he made this morning. It is too difficult for bored Peterson and he tries to make it simpler. Simplification of the language is the process of erasing some letters from some words of this language. Formally, Peterson takes some positive integer p and erases p-th letter from all the words of this language having length at least p. Letters in words are indexed starting by 1. Peterson considers that simplification should change at least one word, i.e. there has to be at least one word of length at least p. Peterson tries to make his language as simple as possible, so he wants to choose p such that the size of the broom for his simplified language is as small as possible.Peterson is pretty annoyed with this task so he asks you for help. Write a program to find the smallest possible size of the broom and integer p." 2500.0                                 
               776C "Molly\'s Chemicals" "binary search,brute force,data structures,implementation,math" "Molly Hooper has n different kinds of chemicals arranged in a line. Each of the chemicals has an affection value, The i-th of them has affection value ai.Molly wants Sherlock to fall in love with her. She intends to do this by mixing a contiguous segment of chemicals together to make a love potion with total affection value as a non-negative integer power of k. Total affection value of a continuous segment of chemicals is the sum of affection values of each chemical in that segment.Help her to do so in finding the total number of such segments." 1800.0                                 
               776A "A Serial Killer" "brute force,implementation,strings" "Our beloved detective, Sherlock is currently trying to catch a serial killer who kills a person each day. Using his powers of deduction, he came to know that the killer has a strategy for selecting his next victim.The killer starts with two potential victims on his first day, selects one of these two, kills selected victim and replaces him with a new person. He repeats this procedure each day. This way, each day he has two potential victims to choose from. Sherlock knows the initial two potential victims. Also, he knows the murder that happened on a particular day and the new person who replaced this victim.You need to help him get all the pairs of potential victims at each day so that Sherlock can observe some pattern." 900.0                                 
               773F "Test Data Generation" "combinatorics,divide and conquer,dp,fft,math,number theory" "Test data generation is not an easy task! Often, generating big random test cases is not enough to ensure thorough testing of solutions for correctness.For example, consider a problem from an old Codeforces round. Its input format looks roughly as follows:The first line contains a single integer n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89maxn) \xe2\x80\x94 the size of the set. The second line contains n distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89maxa) \xe2\x80\x94 the elements of the set in increasing order.If you don\'t pay attention to the problem solution, it looks fairly easy to generate a good test case for this problem. Let n\xe2\x80\x89=\xe2\x80\x89maxn, take random distinct ai from 1 to maxa, sort them... Soon you understand that it\'s not that easy.Here is the actual problem solution. Let g be the greatest common divisor of a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Let x\xe2\x80\x89=\xe2\x80\x89an\xe2\x80\x89/\xe2\x80\x89g\xe2\x80\x89-\xe2\x80\x89n. Then the correct solution outputs ""Alice"" if x is odd, and ""Bob"" if x is even.Consider two wrong solutions to this problem which differ from the correct one only in the formula for calculating x.The first wrong solution calculates x as x\xe2\x80\x89=\xe2\x80\x89an\xe2\x80\x89/\xe2\x80\x89g (without subtracting n).The second wrong solution calculates x as x\xe2\x80\x89=\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x89n (without dividing by g).A test case is interesting if it makes both wrong solutions output an incorrect answer.Given maxn, maxa and q, find the number of interesting test cases satisfying the constraints, and output it modulo q." 3400.0                                 
               767D "Cartons of milk" "binary search,data structures,greedy,sortings,two pointers" "Olya likes milk very much. She drinks k cartons of milk each day if she has at least k and drinks all of them if she doesn\'t. But there\'s an issue \xe2\x80\x94 expiration dates. Each carton has a date after which you can\'t drink it (you still can drink it exactly at the date written on the carton). Due to this, if Olya\'s fridge contains a carton past its expiry date, she throws it away.Olya hates throwing out cartons, so when she drinks a carton, she chooses the one which expires the fastest. It\'s easy to understand that this strategy minimizes the amount of cartons thrown out and lets her avoid it if it\'s even possible.  Milk. Best before: 20.02.2017. The main issue Olya has is the one of buying new cartons. Currently, there are n cartons of milk in Olya\'s fridge, for each one an expiration date is known (how soon does it expire, measured in days). In the shop that Olya visited there are m cartons, and the expiration date is known for each of those cartons as well.Find the maximum number of cartons Olya can buy so that she wouldn\'t have to throw away any cartons. Assume that Olya drank no cartons today." 2100.0                                 
               766E "Mahmoud and a xor trip" "bitmasks,constructive algorithms,data structures,dfs and similar,dp,math,trees" "Mahmoud and Ehab live in a country with n cities numbered from 1 to n and connected by n\xe2\x80\x89-\xe2\x80\x891 undirected roads. It\'s guaranteed that you can reach any city from any other using these roads. Each city has a number ai attached to it.We define the distance from city x to city y as the xor of numbers attached to the cities on the path from x to y (including both x and y). In other words if values attached to the cities on the path from x to y form an array p of length l then the distance between them is , where  is bitwise xor operation.Mahmoud and Ehab want to choose two cities and make a journey from one to another. The index of the start city is always less than or equal to the index of the finish city (they may start and finish in the same city and in this case the distance equals the number attached to that city). They can\'t determine the two cities so they try every city as a start and every city with greater index as a finish. They want to know the total distance between all pairs of cities." 2100.0                                 
               766A "Mahmoud and Longest Uncommon Subsequence" "constructive algorithms,strings" "While Mahmoud and Ehab were practicing for IOI, they found a problem which name was Longest common subsequence. They solved it, and then Ehab challenged Mahmoud with another problem.Given two strings a and b, find the length of their longest uncommon subsequence, which is the longest string that is a subsequence of one of them and not a subsequence of the other.A subsequence of some string is a sequence of characters that appears in the same order in the string, The appearances don\'t have to be consecutive, for example, strings ""ac"", ""bc"", ""abc"" and ""a"" are subsequences of string ""abc"" while strings ""abbc"" and ""acb"" are not. The empty string is a subsequence of any string. Any string is a subsequence of itself." 1000.0                                 
               765C "Table Tennis Game 2" math "Misha and Vanya have played several table tennis sets. Each set consists of several serves, each serve is won by one of the players, he receives one point and the loser receives nothing. Once one of the players scores exactly k points, the score is reset and a new set begins.Across all the sets Misha scored a points in total, and Vanya scored b points. Given this information, determine the maximum number of sets they could have played, or that the situation is impossible.Note that the game consisted of several complete sets." 1200.0                                 
               763C "Timofey and remoduling" "brute force,implementation,math,number theory" "Little Timofey likes integers a lot. Unfortunately, he is very young and can\'t work with very big integers, so he does all the operations modulo his favorite prime m. Also, Timofey likes to look for arithmetical progressions everywhere.One of his birthday presents was a sequence of distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Timofey wants to know whether he can rearrange the elements of the sequence so that is will be an arithmetical progression modulo m, or not.Arithmetical progression modulo m of length n with first element x and difference d is sequence of integers x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89d,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x892d,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89(n\xe2\x80\x89-\xe2\x80\x891)\xc2\xb7d, each taken modulo m." 2600.0                                 
               758E "Broken Tree" "dfs and similar,dp,graphs,greedy,trees" "You are given a tree that has n vertices, which are numbered from 1 to n, where the vertex number one is the root. Each edge has weight wi and strength pi.Botanist Innokentiy, who is the only member of the jury of the Olympiad in Informatics, doesn\'t like broken trees. The tree is broken if there is such an edge the strength of which is less than the sum of weight of subtree\'s edges to which it leads.It is allowed to reduce weight of any edge by arbitrary integer value, but then the strength of its edge is reduced by the same value. It means if the weight of the edge is 10, and the strength is 12, then by the reducing the weight by 7 its weight will equal 3, and the strength will equal 5. It is not allowed to increase the weight of the edge.Your task is to get the tree, which is not broken, by reducing the weight of edges of the given tree, and also all edged should have the positive weight, moreover, the total weight of all edges should be as large as possible.It is obvious that the strength of edges can not be negative, however it can equal zero if the weight of the subtree equals zero." 2600.0                                 
               757A "Gotta Catch Em\' All!" implementation "Bash wants to become a Pokemon master one day. Although he liked a lot of Pokemon, he has always been fascinated by Bulbasaur the most. Soon, things started getting serious and his fascination turned into an obsession. Since he is too young to go out and catch Bulbasaur, he came up with his own way of catching a Bulbasaur.Each day, he takes the front page of the newspaper. He cuts out the letters one at a time, from anywhere on the front page of the newspaper to form the word ""Bulbasaur"" (without quotes) and sticks it on his wall. Bash is very particular about case \xe2\x80\x94 the first letter of ""Bulbasaur"" must be upper case and the rest must be lower case. By doing this he thinks he has caught one Bulbasaur. He then repeats this step on the left over part of the newspaper. He keeps doing this until it is not possible to form the word ""Bulbasaur"" from the newspaper.Given the text on the front page of the newspaper, can you tell how many Bulbasaurs he will catch today?Note: uppercase and lowercase letters are considered different." 1000.0                                 
               755F "PolandBall and Gifts" bitmasks,dp,greedy "It\'s Christmas time! PolandBall and his friends will be giving themselves gifts. There are n Balls overall. Each Ball has someone for whom he should bring a present according to some permutation p, pi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i for all i.Unfortunately, Balls are quite clumsy. We know earlier that exactly k of them will forget to bring their gift. A Ball number i will get his present if the following two constraints will hold:   Ball number i will bring the present he should give.  Ball x such that px\xe2\x80\x89=\xe2\x80\x89i will bring his present. What is minimum and maximum possible number of kids who will not get their present if exactly k Balls will forget theirs?" 2600.0                                 
               755A "PolandBall and Hypothesis" "brute force,graphs,math,number theory" "PolandBall is a young, clever Ball. He is interested in prime numbers. He has stated a following hypothesis: ""There exists such a positive integer n that for each positive integer m number n\xc2\xb7m\xe2\x80\x89+\xe2\x80\x891 is a prime number"".Unfortunately, PolandBall is not experienced yet and doesn\'t know that his hypothesis is incorrect. Could you prove it wrong? Write a program that finds a counterexample for any n." 800.0                                 
               750C "New Year and Rating" "binary search,greedy,math" "Every Codeforces user has rating, described with one integer, possibly negative or zero. Users are divided into two divisions. The first division is for users with rating 1900 or higher. Those with rating 1899 or lower belong to the second division. In every contest, according to one\'s performance, his or her rating changes by some value, possibly negative or zero.Limak competed in n contests in the year 2016. He remembers that in the i-th contest he competed in the division di (i.e. he belonged to this division just before the start of this contest) and his rating changed by ci just after the contest. Note that negative ci denotes the loss of rating.What is the maximum possible rating Limak can have right now, after all n contests? If his rating may be arbitrarily big, print ""Infinity"". If there is no scenario matching the given information, print ""Impossible""." 1600.0                                 
               749D "Leaving Auction" "binary search,data structures" "There are n people taking part in auction today. The rules of auction are classical. There were n bids made, though it\'s not guaranteed they were from different people. It might happen that some people made no bids at all.Each bid is define by two integers (ai,\xe2\x80\x89bi), where ai is the index of the person, who made this bid and bi is its size. Bids are given in chronological order, meaning bi\xe2\x80\x89<\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x891 for all i\xe2\x80\x89<\xe2\x80\x89n. Moreover, participant never makes two bids in a row (no one updates his own bid), i.e. ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 for all i\xe2\x80\x89<\xe2\x80\x89n.Now you are curious with the following question: who (and which bid) will win the auction if some participants were absent? Consider that if someone was absent, all his bids are just removed and no new bids are added.Note, that if during this imaginary exclusion of some participants it happens that some of the remaining participants makes a bid twice (or more times) in a row, only first of these bids is counted. For better understanding take a look at the samples.You have several questions in your mind, compute the answer for each of them." 2000.0                                 
               747F "Igor and Interesting Numbers" "brute force,combinatorics,dp,math" "Igor likes hexadecimal notation and considers positive integer in the hexadecimal notation interesting if each digit and each letter in it appears no more than t times. For example, if t\xe2\x80\x89=\xe2\x80\x893, then integers 13a13322, aaa, abcdef0123456789 are interesting, but numbers aaaa, abababab and 1000000 are not interesting.Your task is to find the k-th smallest interesting for Igor integer in the hexadecimal notation. The integer should not contain leading zeros." 2500.0                                 
               743E "Vladik and cards" "binary search,bitmasks,brute force,dp" "Vladik was bored on his way home and decided to play the following game. He took n cards and put them in a row in front of himself. Every card has a positive integer number not exceeding 8 written on it. He decided to find the longest subsequence of cards which satisfies the following conditions:  the number of occurrences of each number from 1 to 8 in the subsequence doesn\'t differ by more then 1 from the number of occurrences of any other number. Formally, if there are ck cards with number k on them in the subsequence, than for all pairs of integers  the condition |ci\xe2\x80\x89-\xe2\x80\x89cj|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 must hold.  if there is at least one card with number x on it in the subsequence, then all cards with number x in this subsequence must form a continuous segment in it (but not necessarily a continuous segment in the original sequence). For example, the subsequence [1,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x892] satisfies this condition while the subsequence [1,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x891] doesn\'t. Note that [1,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x892] doesn\'t satisfy the first condition. Please help Vladik to find the length of the longest subsequence that satisfies both conditions." 2200.0                                 
               740B "Alyona and flowers" "constructive algorithms" "Little Alyona is celebrating Happy Birthday! Her mother has an array of n flowers. Each flower has some mood, the mood of i-th flower is ai. The mood can be positive, zero or negative.Let\'s define a subarray as a segment of consecutive flowers. The mother suggested some set of subarrays. Alyona wants to choose several of the subarrays suggested by her mother. After that, each of the flowers will add to the girl\'s happiness its mood multiplied by the number of chosen subarrays the flower is in.For example, consider the case when the mother has 5 flowers, and their moods are equal to 1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x894. Suppose the mother suggested subarrays (1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892), (3,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x894), (1,\xe2\x80\x893), (1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893). Then if the girl chooses the third and the fourth subarrays then:   the first flower adds 1\xc2\xb71\xe2\x80\x89=\xe2\x80\x891 to the girl\'s happiness, because he is in one of chosen subarrays,  the second flower adds (\xe2\x80\x89-\xe2\x80\x892)\xc2\xb71\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892, because he is in one of chosen subarrays,  the third flower adds 1\xc2\xb72\xe2\x80\x89=\xe2\x80\x892, because he is in two of chosen subarrays,  the fourth flower adds 3\xc2\xb72\xe2\x80\x89=\xe2\x80\x896, because he is in two of chosen subarrays,  the fifth flower adds (\xe2\x80\x89-\xe2\x80\x894)\xc2\xb70\xe2\x80\x89=\xe2\x80\x890, because he is in no chosen subarrays. Thus, in total 1\xe2\x80\x89+\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x892)\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x896\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89=\xe2\x80\x897 is added to the girl\'s happiness. Alyona wants to choose such subarrays from those suggested by the mother that the value added to her happiness would be as large as possible. Help her do this!Alyona can choose any number of the subarrays, even 0 or all suggested by her mother." 1200.0                                 
               739C "Alyona and towers" "data structures" "Alyona has built n towers by putting small cubes some on the top of others. Each cube has size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x891. A tower is a non-zero amount of cubes standing on the top of each other. The towers are next to each other, forming a row.Sometimes Alyona chooses some segment towers, and put on the top of each tower several cubes. Formally, Alyouna chooses some segment of towers from li to ri and adds di cubes on the top of them.Let the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an be the heights of the towers from left to right. Let\'s call as a segment of towers al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar a hill if the following condition holds: there is integer k (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) such that al\xe2\x80\x89<\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ak\xe2\x80\x89>\xe2\x80\x89ak\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89ak\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89>\xe2\x80\x89...\xe2\x80\x89>\xe2\x80\x89ar.After each addition of di cubes on the top of the towers from li to ri, Alyona wants to know the maximum width among all hills. The width of a hill is the number of towers in it." 2500.0                                 
               737F "Dirty plates" "constructive algorithms,math" "After one of celebrations there is a stack of dirty plates in Nikita\'s kitchen. Nikita has to wash them and put into a dryer. In dryer, the plates should be also placed in a stack also, and the plates sizes should increase down up. The sizes of all plates are distinct.Nikita has no so much free space, specifically, he has a place for only one more stack of plates. Therefore, he can perform only such two operations:   Take any number of plates from 1 to a from the top of the dirty stack, wash them and put them to the intermediate stack.  Take any number of plates from 1 to b from the top of the intermediate stack and put them to the stack in the dryer. Note that after performing each of the operations, the plates are put in the same order as they were before the operation.You are given the sizes of the plates s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn in the down up order in the dirty stack, and integers a and b. All the sizes are distinct. Write a program that determines whether or not Nikita can put the plates in increasing down up order in the dryer. If he is able to do so, the program should find some sequence of operations (not necessary optimal) to achieve it." 3300.0                                 
               735D Taxes "math,number theory" "Mr. Funt now lives in a country with a very specific tax laws. The total income of mr. Funt during this year is equal to n (n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892) burles and the amount of tax he has to pay is calculated as the maximum divisor of n (not equal to n, of course). For example, if n\xe2\x80\x89=\xe2\x80\x896 then Funt has to pay 3 burles, while for n\xe2\x80\x89=\xe2\x80\x8925 he needs to pay 5 and if n\xe2\x80\x89=\xe2\x80\x892 he pays only 1 burle.As mr. Funt is a very opportunistic person he wants to cheat a bit. In particular, he wants to split the initial n in several parts n1\xe2\x80\x89+\xe2\x80\x89n2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89nk\xe2\x80\x89=\xe2\x80\x89n (here k is arbitrary, even k\xe2\x80\x89=\xe2\x80\x891 is allowed) and pay the taxes for each part separately. He can\'t make some part equal to 1 because it will reveal him. So, the condition ni\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 should hold for all i from 1 to k.Ostap Bender wonders, how many money Funt has to pay (i.e. minimal) if he chooses and optimal way to split n in parts." 1600.0                                 
               735C "Tennis Championship" "combinatorics,constructive algorithms,greedy,math" "Famous Brazil city Rio de Janeiro holds a tennis tournament and Ostap Bender doesn\'t want to miss this event. There will be n players participating, and the tournament will follow knockout rules from the very first game. That means, that if someone loses a game he leaves the tournament immediately.Organizers are still arranging tournament grid (i.e. the order games will happen and who is going to play with whom) but they have already fixed one rule: two players can play against each other only if the number of games one of them has already played differs by no more than one from the number of games the other one has already played. Of course, both players had to win all their games in order to continue participating in the tournament.Tournament hasn\'t started yet so the audience is a bit bored. Ostap decided to find out what is the maximum number of games the winner of the tournament can take part in (assuming the rule above is used). However, it is unlikely he can deal with this problem without your help." 1600.0                                 
               735A "Ostap and Grasshopper" implementation,strings "On the way to Rio de Janeiro Ostap kills time playing with a grasshopper he took with him in a special box. Ostap builds a line of length n such that some cells of this line are empty and some contain obstacles. Then, he places his grasshopper to one of the empty cells and a small insect in another empty cell. The grasshopper wants to eat the insect.Ostap knows that grasshopper is able to jump to any empty cell that is exactly k cells away from the current (to the left or to the right). Note that it doesn\'t matter whether intermediate cells are empty or not as the grasshopper makes a jump over them. For example, if k\xe2\x80\x89=\xe2\x80\x891 the grasshopper can jump to a neighboring cell only, and if k\xe2\x80\x89=\xe2\x80\x892 the grasshopper can jump over a single cell.Your goal is to determine whether there is a sequence of jumps such that grasshopper will get from his initial position to the cell with an insect." 800.0                                 
               732F "Tourist Reform" "dfs and similar,graphs" "Berland is a tourist country! At least, it can become such \xe2\x80\x94 the government of Berland is confident about this. There are n cities in Berland, some pairs of which are connected by two-ways roads. Each road connects two different cities. In Berland there are no roads which connect the same pair of cities. It is possible to get from any city to any other city using given two-ways roads. According to the reform each road will become one-way. It will be oriented to one of two directions.To maximize the tourist attraction of Berland, after the reform for each city i the value ri will be calculated. It will equal to the number of cities x for which there is an oriented path from the city i to the city x. In other words, ri will equal the number of cities which can be reached from the city i by roads. The government is sure that tourist\'s attention will be focused on the minimum value of ri.Help the government of Berland make the reform to maximize the minimum of ri." 2300.0                                 
               732E Sockets greedy,sortings "The ICM ACPC World Finals is coming! Unfortunately, the organizers of the competition were so busy preparing tasks that totally missed an important technical point \xe2\x80\x94 the organization of electricity supplement for all the participants workstations.There are n computers for participants, the i-th of which has power equal to positive integer pi. At the same time there are m sockets available, the j-th of which has power euqal to positive integer sj. It is possible to connect the i-th computer to the j-th socket if and only if their powers are the same: pi\xe2\x80\x89=\xe2\x80\x89sj. It is allowed to connect no more than one computer to one socket. Thus, if the powers of all computers and sockets are distinct, then no computer can be connected to any of the sockets. In order to fix the situation professor Puch Williams urgently ordered a wagon of adapters \xe2\x80\x94 power splitters. Each adapter has one plug and one socket with a voltage divider between them. After plugging an adapter to a socket with power x, the power on the adapter\'s socket becomes equal to , it means that it is equal to the socket\'s power divided by two with rounding up, for example  and .Each adapter can be used only once. It is possible to connect several adapters in a chain plugging the first to a socket. For example, if two adapters are plugged one after enother to a socket with power 10, it becomes possible to connect one computer with power 3 to this socket.The organizers should install adapters so that it will be possible to supply with electricity the maximum number of computers c at the same time. If there are several possible connection configurations, they want to find the one that uses the minimum number of adapters u to connect c computers.Help organizers calculate the maximum number of connected computers c and the minimum number of adapters u needed for this.The wagon of adapters contains enough of them to do the task. It is guaranteed that it\'s possible to connect at least one computer." 2100.0                                 
               731C Socks "dfs and similar,dsu,graphs,greedy" "Arseniy is already grown-up and independent. His mother decided to leave him alone for m days and left on a vacation. She have prepared a lot of food, left some money and washed all Arseniy\'s clothes. Ten minutes before her leave she realized that it would be also useful to prepare instruction of which particular clothes to wear on each of the days she will be absent. Arseniy\'s family is a bit weird so all the clothes is enumerated. For example, each of Arseniy\'s n socks is assigned a unique integer from 1 to n. Thus, the only thing his mother had to do was to write down two integers li and ri for each of the days \xe2\x80\x94 the indices of socks to wear on the day i (obviously, li stands for the left foot and ri for the right). Each sock is painted in one of k colors.When mother already left Arseniy noticed that according to instruction he would wear the socks of different colors on some days. Of course, that is a terrible mistake cause by a rush. Arseniy is a smart boy, and, by some magical coincidence, he posses k jars with the paint \xe2\x80\x94 one for each of k colors.Arseniy wants to repaint some of the socks in such a way, that for each of m days he can follow the mother\'s instructions and wear the socks of the same color. As he is going to be very busy these days he will have no time to change the colors of any socks so he has to finalize the colors now.The new computer game Bota-3 was just realised and Arseniy can\'t wait to play it. What is the minimum number of socks that need their color to be changed in order to make it possible to follow mother\'s instructions and wear the socks of the same color during each of m days." 1600.0                                 
               729A "Interview with Oleg" implementation,strings "Polycarp has interviewed Oleg and has written the interview down without punctuation marks and spaces to save time. Thus, the interview is now a string s consisting of n lowercase English letters.There is a filler word ogo in Oleg\'s speech. All words that can be obtained from ogo by adding go several times to the end of it are also considered to be fillers. For example, the words ogo, ogogo, ogogogo are fillers, but the words go, og, ogog, ogogog and oggo are not fillers.The fillers have maximal size, for example, for ogogoo speech we can\'t consider ogo a filler and goo as a normal phrase. We should consider ogogo as a filler here.To print the interview, Polycarp has to replace each of the fillers with three asterisks. Note that a filler word is replaced with exactly three asterisks regardless of its length.Polycarp has dealt with this problem in no time. Can you do the same? The clock is ticking!" 900.0                                 
               727F "Polycarp\'s problems" "binary search,dp,greedy" "Polycarp is an experienced participant in Codehorses programming contests. Now he wants to become a problemsetter.He sent to the coordinator a set of n problems. Each problem has it\'s quality, the quality of the i-th problem is ai (ai can be positive, negative or equal to zero). The problems are ordered by expected difficulty, but the difficulty is not related to the quality in any way. The easiest problem has index 1, the hardest problem has index n.The coordinator\'s mood is equal to q now. After reading a problem, the mood changes by it\'s quality. It means that after the coordinator reads a problem with quality b, the value b is added to his mood. The coordinator always reads problems one by one from the easiest to the hardest, it\'s impossible to change the order of the problems.If after reading some problem the coordinator\'s mood becomes negative, he immediately stops reading and rejects the problemset.Polycarp wants to remove the minimum number of problems from his problemset to make the coordinator\'s mood non-negative at any moment of time. Polycarp is not sure about the current coordinator\'s mood, but he has m guesses ""the current coordinator\'s mood q\xe2\x80\x89=\xe2\x80\x89bi"".For each of m guesses, find the minimum number of problems Polycarp needs to remove so that the coordinator\'s mood will always be greater or equal to 0 while he reads problems from the easiest of the remaining problems to the hardest." 2300.0                                 
               725G "Messages on a Tree"  "Alice and Bob are well-known for sending messages to each other. This time you have a rooted tree with Bob standing in the root node and copies of Alice standing in each of the other vertices. The root node has number 0, the rest are numbered 1 through n.At some moments of time some copies of Alice want to send a message to Bob and receive an answer. We will call this copy the initiator. The process of sending a message contains several steps:   The initiator sends the message to the person standing in the parent node and begins waiting for the answer.  When some copy of Alice receives a message from some of her children nodes, she sends the message to the person standing in the parent node and begins waiting for the answer.  When Bob receives a message from some of his child nodes, he immediately sends the answer to the child node where the message came from.  When some copy of Alice (except for initiator) receives an answer she is waiting for, she immediately sends it to the child vertex where the message came from.  When the initiator receives the answer she is waiting for, she doesn\'t send it to anybody.  There is a special case: a copy of Alice can\'t wait for two answers at the same time, so if some copy of Alice receives a message from her child node while she already waits for some answer, she rejects the message and sends a message saying this back to the child node where the message came from. Then the copy of Alice in the child vertex processes this answer as if it was from Bob.  The process of sending a message to a parent node or to a child node is instant but a receiver (a parent or a child) gets a message after 1 second. If some copy of Alice receives several messages from child nodes at the same moment while she isn\'t waiting for an answer, she processes the message from the initiator with the smallest number and rejects all the rest. If some copy of Alice receives messages from children nodes and also receives the answer she is waiting for at the same instant, then Alice first processes the answer, then immediately continue as normal with the incoming messages.You are given the moments of time when some copy of Alice becomes the initiator and sends a message to Bob. For each message, find the moment of time when the answer (either from Bob or some copy of Alice) will be received by the initiator.You can assume that if Alice wants to send a message (i.e. become the initiator) while waiting for some answer, she immediately rejects the message and receives an answer from herself in no time." 3300.0                                 
               725F "Family Photos" games,greedy "Alice and Bonnie are sisters, but they don\'t like each other very much. So when some old family photos were found in the attic, they started to argue about who should receive which photos. In the end, they decided that they would take turns picking photos. Alice goes first.There are n stacks of photos. Each stack contains exactly two photos. In each turn, a player may take only a photo from the top of one of the stacks.Each photo is described by two non-negative integers a and b, indicating that it is worth a units of happiness to Alice and b units of happiness to Bonnie. Values of a and b might differ for different photos.It\'s allowed to pass instead of taking a photo. The game ends when all photos are taken or both players pass consecutively.The players don\'t act to maximize their own happiness. Instead, each player acts to maximize the amount by which her happiness exceeds her sister\'s. Assuming both players play optimal, find the difference between Alice\'s and Bonnie\'s happiness. That is, if there\'s a perfectly-played game such that Alice has x happiness and Bonnie has y happiness at the end, you should print x\xe2\x80\x89-\xe2\x80\x89y." 2900.0                                 
               724F "Uniformly Branched Trees" combinatorics,dp,trees "A tree is a connected graph without cycles.Two trees, consisting of n vertices each, are called isomorphic if there exists a permutation p:\xe2\x80\x89{1,\xe2\x80\x89...,\xe2\x80\x89n}\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89{1,\xe2\x80\x89...,\xe2\x80\x89n} such that the edge (u,\xe2\x80\x89v) is present in the first tree if and only if the edge (pu,\xe2\x80\x89pv) is present in the second tree.Vertex of the tree is called internal if its degree is greater than or equal to two.Count the number of different non-isomorphic trees, consisting of n vertices, such that the degree of each internal vertex is exactly d. Print the answer over the given prime modulo mod." 2700.0                                 
               724D "Dense Subsequence" "data structures,greedy,strings" "You are given a string s, consisting of lowercase English letters, and the integer m.One should choose some symbols from the given string so that any contiguous subsegment of length m has at least one selected symbol. Note that here we choose positions of symbols, not the symbols themselves.Then one uses the chosen symbols to form a new string. All symbols from the chosen position should be used, but we are allowed to rearrange them in any order.Formally, we choose a subsequence of indices 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89it\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|. The selected sequence must meet the following condition: for every j such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891, there must be at least one selected index that belongs to the segment [j,\xe2\x80\x89 j\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891], i.e. there should exist a k from 1 to t, such that j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891.Then we take any permutation p of the selected indices and form a new string sip1sip2... sipt.Find the lexicographically smallest string, that can be obtained using this procedure." 1900.0                                 
               722C "Destroying Array" "data structures,dsu" "You are given an array consisting of n non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.You are going to destroy integers in the array one by one. Thus, you are given the permutation of integers from 1 to n defining the order elements of the array are destroyed.After each element is destroyed you have to find out the segment of the array, such that it contains no destroyed elements and the sum of its elements is maximum possible. The sum of elements in the empty segment is considered to be 0." 1600.0                                 
               717H "Pokermon League challenge" math,probabilities "Welcome to the world of Pokermon, yellow little mouse-like creatures, who absolutely love playing poker! Yeah, right\xe2\x80\xa6 In the ensuing Pokermon League, there are n registered Pokermon trainers, and t existing trainer teams each of which belongs to one of two conferences. Since there is a lot of jealousy between trainers, there are e pairs of trainers who hate each other. Their hate is mutual, there are no identical pairs among these, and no trainer hates himself (the world of Pokermon is a joyful place!). Each trainer has a wish-list of length li of teams he\xe2\x80\x99d like to join.Your task is to divide players into teams and the teams into two conferences, so that:   each trainer belongs to exactly one team;   no team is in both conferences;   total hate between conferences is at least e\xe2\x80\x89/\xe2\x80\x892;   every trainer is in a team from his wish-list. Total hate between conferences is calculated as the number of pairs of trainers from teams from different conferences who hate each other." 2400.0                                 
               713E "Sonya Partymaker" "binary search,dp" "Owl Sonya decided to become a partymaker. To train for this role she gather all her owl friends in the country house. There are m chairs located in a circle and consequently numbered with integers from 1 to m. Thus, chairs i and i\xe2\x80\x89+\xe2\x80\x891 are neighbouring for all i from 1 to m\xe2\x80\x89-\xe2\x80\x891. Chairs 1 and m are also neighbouring. Some chairs are occupied by her friends. There are n friends in total. No two friends occupy the same chair. Rules are the following:  Each participant removes from the game the chair he is currently sitting on.  Each of the participants choose a direction that she will follow: clockwise (indices increase, from m goes to 1) and counter-clockwise (indices decrease, from 1 goes to m). This direction may coincide or be different for any pair of owls.  Each turn all guests move one step in the chosen directions. If some guest move to the position with a chair there, he removes this chair from the game.  Game ends if there are no more chairs left in the game. Owls are very busy and want to get rid of the game as soon as possible. They cooperate to pick the direction. Your goal is to find the minimum number o moves required to finish the game." 3300.0                                 
               713D "Animals and Puzzle" "binary search,data structures" "Owl Sonya gave a huge lake puzzle of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m to hedgehog Filya as a birthday present. Friends immediately started to assemble the puzzle, but some parts of it turned out to be empty \xe2\x80\x94 there was no picture on them. Parts with picture on it are denoted by 1, while empty parts are denoted by 0. Rows of the puzzle are numbered from top to bottom with integers from 1 to n, while columns are numbered from left to right with integers from 1 to m.Animals decided to complete the picture and play with it, as it might be even more fun! Owl and hedgehog ask each other some queries. Each query is provided by four integers x1, y1, x2, y2 which define the rectangle, where (x1,\xe2\x80\x89y1) stands for the coordinates of the up left cell of the rectangle, while (x2,\xe2\x80\x89y2) stands for the coordinates of the bottom right cell. The answer to the query is the size of the maximum square consisting of picture parts only (only parts denoted by 1) and located fully inside the query rectangle.Help Sonya and Filya answer t queries." 2700.0                                 
               713B "Searching Rectangles" "binary search,constructive algorithms,interactive" "Filya just learned new geometry object \xe2\x80\x94 rectangle. He is given a field consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89n unit cells. Rows are numbered from bottom to top with integer from 1 to n. Columns are numbered from left to right with integers from 1 to n. Cell, located at the intersection of the row r and column c is denoted as (r,\xe2\x80\x89c). Filya has painted two rectangles, such that their sides are parallel to coordinate axes and each cell lies fully inside or fully outside each of them. Moreover, no cell lies in both rectangles.Later, hedgehog Filya became interested in the location of his rectangles but was unable to find the sheet of paper they were painted on. They were taken by Sonya and now she wants to play a little game with Filya. He tells her a query rectangle and she replies with the number of initial rectangles that lie fully inside the given query rectangle. The query rectangle should match the same conditions as initial rectangles. Rectangle lies fully inside the query if each o its cells lies inside the query.Filya knows Sonya really well, so is sure that if he asks more than 200 questions she will stop to reply." 2200.0                                 
               706E "Working routine" "data structures,implementation" "Vasiliy finally got to work, where there is a huge amount of tasks waiting for him. Vasiliy is given a matrix consisting of n rows and m columns and q tasks. Each task is to swap two submatrices of the given matrix.For each task Vasiliy knows six integers ai, bi, ci, di, hi, wi, where ai is the index of the row where the top-left corner of the first rectangle is located, bi is the index of its column, ci is the index of the row of the top-left corner of the second rectangle, di is the index of its column, hi is the height of the rectangle and wi is its width.It\'s guaranteed that two rectangles in one query do not overlap and do not touch, that is, no cell belongs to both rectangles, and no two cells belonging to different rectangles share a side. However, rectangles are allowed to share an angle.Vasiliy wants to know how the matrix will look like after all tasks are performed." 2500.0                                 
               706D "Vasiliy\'s Multiset" "binary search,bitmasks,data structures,trees" "Author has gone out of the stories about Vasiliy, so here is just a formal task description.You are given q queries and a multiset A, initially containing only integer 0. There are three types of queries:  ""+ x"" \xe2\x80\x94 add integer x to multiset A. ""- x"" \xe2\x80\x94 erase one occurrence of integer x from multiset A. It\'s guaranteed that at least one x is present in the multiset A before this query. ""? x"" \xe2\x80\x94 you are given integer x and need to compute the value , i.e. the maximum value of bitwise exclusive OR (also know as XOR) of integer x and some integer y from the multiset A.Multiset is a set, where equal elements are allowed." 1800.0                                 
               706C "Hard problem" dp,strings "Vasiliy is fond of solving different tasks. Today he found one he wasn\'t able to solve himself, so he asks you to help.Vasiliy is given n strings consisting of lowercase English letters. He wants them to be sorted in lexicographical order (as in the dictionary), but he is not allowed to swap any of them. The only operation he is allowed to do is to reverse any of them (first character becomes last, second becomes one before last and so on).To reverse the i-th string Vasiliy has to spent ci units of energy. He is interested in the minimum amount of energy he has to spent in order to have strings sorted in lexicographical order.String A is lexicographically smaller than string B if it is shorter than B (|A|\xe2\x80\x89<\xe2\x80\x89|B|) and is its prefix, or if none of them is a prefix of the other and at the first position where they differ character in A is smaller than the character in B.For the purpose of this problem, two equal strings nearby do not break the condition of sequence being sorted lexicographically." 1600.0                                 
               704D "Captain America" flows,greedy "Steve Rogers is fascinated with new vibranium shields S.H.I.E.L.D gave him. They\'re all uncolored. There are n shields in total, the i-th shield is located at point (xi,\xe2\x80\x89yi) of the coordinate plane. It\'s possible that two or more shields share the same location.Steve wants to paint all these shields. He paints each shield in either red or blue. Painting a shield in red costs r dollars while painting it in blue costs b dollars.Additionally, there are m constraints Steve wants to be satisfied. The i-th constraint is provided by three integers ti, li and di:  If ti\xe2\x80\x89=\xe2\x80\x891, then the absolute difference between the number of red and blue shields on line x\xe2\x80\x89=\xe2\x80\x89li should not exceed di.  If ti\xe2\x80\x89=\xe2\x80\x892, then the absolute difference between the number of red and blue shields on line y\xe2\x80\x89=\xe2\x80\x89li should not exceed di. Steve gave you the task of finding the painting that satisfies all the condition and the total cost is minimum." 3100.0                                 
               703C "Chris and Road" geometry,implementation "And while Mishka is enjoying her trip...Chris is a little brown bear. No one knows, where and when he met Mishka, but for a long time they are together (excluding her current trip). However, best friends are important too. John is Chris\' best friend.Once walking with his friend, John gave Chris the following problem:At the infinite horizontal road of width w, bounded by lines y\xe2\x80\x89=\xe2\x80\x890 and y\xe2\x80\x89=\xe2\x80\x89w, there is a bus moving, presented as a convex polygon of n vertices. The bus moves continuously with a constant speed of v in a straight Ox line in direction of decreasing x coordinates, thus in time only x coordinates of its points are changing. Formally, after time t each of x coordinates of its points will be decreased by vt.There is a pedestrian in the point (0,\xe2\x80\x890), who can move only by a vertical pedestrian crossing, presented as a segment connecting points (0,\xe2\x80\x890) and (0,\xe2\x80\x89w) with any speed not exceeding u. Thus the pedestrian can move only in a straight line Oy in any direction with any speed not exceeding u and not leaving the road borders. The pedestrian can instantly change his speed, thus, for example, he can stop instantly.Please look at the sample note picture for better understanding.We consider the pedestrian is hit by the bus, if at any moment the point he is located in lies strictly inside the bus polygon (this means that if the point lies on the polygon vertex or on its edge, the pedestrian is not hit by the bus).You are given the bus position at the moment 0. Please help Chris determine minimum amount of time the pedestrian needs to cross the road and reach the point (0,\xe2\x80\x89w) and not to be hit by the bus." 2100.0                                 
               702E "Analysis of Pathes in Functional Graph" "data structures,graphs" "You are given a functional graph. It is a directed graph, in which from each vertex goes exactly one arc. The vertices are numerated from 0 to n\xe2\x80\x89-\xe2\x80\x891.Graph is given as the array f0,\xe2\x80\x89f1,\xe2\x80\x89...,\xe2\x80\x89fn\xe2\x80\x89-\xe2\x80\x891, where fi \xe2\x80\x94 the number of vertex to which goes the only arc from the vertex i. Besides you are given array with weights of the arcs w0,\xe2\x80\x89w1,\xe2\x80\x89...,\xe2\x80\x89wn\xe2\x80\x89-\xe2\x80\x891, where wi \xe2\x80\x94 the arc weight from i to fi.  The graph from the first sample test. Also you are given the integer k (the length of the path) and you need to find for each vertex two numbers si and mi, where:  si \xe2\x80\x94 the sum of the weights of all arcs of the path with length equals to k which starts from the vertex i;  mi \xe2\x80\x94 the minimal weight from all arcs on the path with length k which starts from the vertex i. The length of the path is the number of arcs on this path." 2100.0                                 
               700D "Huffman Coding on Segment" "data structures,greedy" "Alice wants to send an important message to Bob. Message a\xe2\x80\x89=\xe2\x80\x89(a1,\xe2\x80\x89...,\xe2\x80\x89an) is a sequence of positive integers (characters).To compress the message Alice wants to use binary Huffman coding. We recall that binary Huffman code, or binary prefix code is a function f, that maps each letter that appears in the string to some binary string (that is, string consisting of characters \'0\' and \'1\' only) such that for each pair of different characters ai and aj string f(ai) is not a prefix of f(aj) (and vice versa). The result of the encoding of the message a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is the concatenation of the encoding of each character, that is the string f(a1)f(a2)... f(an). Huffman codes are very useful, as the compressed message can be easily and uniquely decompressed, if the function f is given. Code is usually chosen in order to minimize the total length of the compressed message, i.e. the length of the string f(a1)f(a2)... f(an).Because of security issues Alice doesn\'t want to send the whole message. Instead, she picks some substrings of the message and wants to send them separately. For each of the given substrings ali... ari she wants to know the minimum possible length of the Huffman coding. Help her solve this problem." 3100.0                                 
               700A "As Fast As Possible" "binary search,math" "On vacations n pupils decided to go on excursion and gather all together. They need to overcome the path with the length l meters. Each of the pupils will go with the speed equal to v1. To get to the excursion quickly, it was decided to rent a bus, which has seats for k people (it means that it can\'t fit more than k people at the same time) and the speed equal to v2. In order to avoid seasick, each of the pupils want to get into the bus no more than once.Determine the minimum time required for all n pupils to reach the place of excursion. Consider that the embarkation and disembarkation of passengers, as well as the reversal of the bus, take place immediately and this time can be neglected." 1900.0                                 
               699B "One Bomb" implementation "You are given a description of a depot. It is a rectangular checkered field of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m size. Each cell in a field can be empty (""."") or it can be occupied by a wall (""*""). You have one bomb. If you lay the bomb at the cell (x,\xe2\x80\x89y), then after triggering it will wipe out all walls in the row x and all walls in the column y.You are to determine if it is possible to wipe out all walls in the depot by placing and triggering exactly one bomb. The bomb can be laid both in an empty cell or in a cell occupied by a wall." 1400.0                                 
               698F "Coprime Permutation" "combinatorics,number theory" "Two positive integers are coprime if and only if they don\'t have a common divisor greater than 1.Some bear doesn\'t want to tell Radewoosh how to solve some algorithmic problem. So, Radewoosh is going to break into that bear\'s safe with solutions. To pass through the door, he must enter a permutation of numbers 1 through n. The door opens if and only if an entered permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn satisfies:In other words, two different elements are coprime if and only if their indices are coprime. Some elements of a permutation may be already fixed. In how many ways can Radewoosh fill the remaining gaps so that the door will open? Print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 3000.0                                 
               698A Vacations dp "Vasya has n days of vacations! So he decided to improve his IT skills and do sport. Vasya knows the following information about each of this n days: whether that gym opened and whether a contest was carried out in the Internet on that day. For the i-th day there are four options:  on this day the gym is closed and the contest is not carried out;  on this day the gym is closed and the contest is carried out;  on this day the gym is open and the contest is not carried out;  on this day the gym is open and the contest is carried out. On each of days Vasya can either have a rest or write the contest (if it is carried out on this day), or do sport (if the gym is open on this day).Find the minimum number of days on which Vasya will have a rest (it means, he will not do sport and write the contest at the same time). The only limitation that Vasya has \xe2\x80\x94 he does not want to do the same activity on two consecutive days: it means, he will not do sport on two consecutive days, and write the contest on two consecutive days." 1400.0                                 
                    690E2 "Photographs (II)"  "Zombies seem to have become much more intelligent lately \xe2\x80\x93 a few have somehow wandered into the base through the automatic gate. Heidi has had to beef up security, and a new gate has been installed. Unfortunately, now the questions being asked are more complicated, and even humans have trouble answering them. Can you still program the robot army to do this reliably?The new questions are of the following form: a grayscale photograph has been divided into several horizontal pieces, which have been arbitrarily rearranged. The task is to assemble the original image back from these pieces (somewhat like in a jigsaw puzzle). To further delay the zombies, significant Gaussian-distributed noise has been added to the image." 2600.0                            
                    690C3 "Brain Network (hard)" trees "Breaking news from zombie neurology! It turns out that \xe2\x80\x93 contrary to previous beliefs \xe2\x80\x93 every zombie is born with a single brain, and only later it evolves into a complicated brain structure. In fact, whenever a zombie consumes a brain, a new brain appears in its nervous system and gets immediately connected to one of the already existing brains using a single brain connector. Researchers are now interested in monitoring the brain latency of a zombie. Your task is to write a program which, given a history of evolution of a zombie\'s nervous system, computes its brain latency at every stage." 2200.0                            
                    690A1 "Collective Mindsets (easy)"  "Tonight is brain dinner night and all zombies will gather together to scarf down some delicious brains. The artful Heidi plans to crash the party, incognito, disguised as one of them. Her objective is to get away with at least one brain, so she can analyze the zombies\' mindset back home and gain a strategic advantage.They will be N guests tonight: N\xe2\x80\x89-\xe2\x80\x891 real zombies and a fake one, our Heidi. The living-dead love hierarchies as much as they love brains: each one has a unique rank in the range 1 to N\xe2\x80\x89-\xe2\x80\x891, and Heidi, who still appears slightly different from the others, is attributed the highest rank, N. Tonight there will be a chest with brains on display and every attendee sees how many there are. These will then be split among the attendees according to the following procedure:The zombie of the highest rank makes a suggestion on who gets how many brains (every brain is an indivisible entity). A vote follows. If at least half of the attendees accept the offer, the brains are shared in the suggested way and the feast begins. But if majority is not reached, then the highest-ranked zombie is killed, and the next zombie in hierarchy has to make a suggestion. If he is killed too, then the third highest-ranked makes one, etc. (It\'s enough to have exactly half of the votes \xe2\x80\x93 in case of a tie, the vote of the highest-ranked alive zombie counts twice, and he will of course vote in favor of his own suggestion in order to stay alive.)You should know that zombies are very greedy and sly, and they know this too \xe2\x80\x93 basically all zombie brains are alike. Consequently, a zombie will never accept an offer which is suboptimal for him. That is, if an offer is not strictly better than a potential later offer, he will vote against it. And make no mistake: while zombies may normally seem rather dull, tonight their intellects are perfect. Each zombie\'s priorities for tonight are, in descending order:   survive the event (they experienced death already once and know it is no fun),  get as many brains as possible. Heidi goes first and must make an offer which at least half of the attendees will accept, and which allocates at least one brain for Heidi herself.What is the smallest number of brains that have to be in the chest for this to be possible?" 1100.0                            
                    687C "The Values You Can Make" dp "Pari wants to buy an expensive chocolate from Arya. She has n coins, the value of the i-th coin is ci. The price of the chocolate is k, so Pari will take a subset of her coins with sum equal to k and give it to Arya.Looking at her coins, a question came to her mind: after giving the coins to Arya, what values does Arya can make with them? She is jealous and she doesn\'t want Arya to make a lot of values. So she wants to know all the values x, such that Arya will be able to make x using some subset of coins with the sum k.Formally, Pari wants to know the values x such that there exists a subset of coins with the sum k such that some subset of this subset has the sum x, i.e. there is exists some way to pay for the chocolate, such that Arya will be able to make the sum x using these coins." 1900.0                            
                    686A "Free Ice Cream" "constructive algorithms,implementation" "After their adventure with the magic mirror Kay and Gerda have returned home and sometimes give free ice cream to kids in the summer.At the start of the day they have x ice cream packs. Since the ice cream is free, people start standing in the queue before Kay and Gerda\'s house even in the night. Each person in the queue wants either to take several ice cream packs for himself and his friends or to give several ice cream packs to Kay and Gerda (carriers that bring ice cream have to stand in the same queue).If a carrier with d ice cream packs comes to the house, then Kay and Gerda take all his packs. If a child who wants to take d ice cream packs comes to the house, then Kay and Gerda will give him d packs if they have enough ice cream, otherwise the child will get no ice cream at all and will leave in distress.Kay wants to find the amount of ice cream they will have after all people will leave from the queue, and Gerda wants to find the number of distressed kids." 800.0                            
                    685D "Kay and Eternity" "brute force,implementation,sortings" "Snow Queen told Kay to form a word ""eternity"" using pieces of ice. Kay is eager to deal with the task, because he will then become free, and Snow Queen will give him all the world and a pair of skates.Behind the palace of the Snow Queen there is an infinite field consisting of cells. There are n pieces of ice spread over the field, each piece occupying exactly one cell and no two pieces occupying the same cell. To estimate the difficulty of the task Kay looks at some squares of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k cells, with corners located at the corners of the cells and sides parallel to coordinate axis and counts the number of pieces of the ice inside them.This method gives an estimation of the difficulty of some part of the field. However, Kay also wants to estimate the total difficulty, so he came up with the following criteria: for each x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) he wants to count the number of squares of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k, such that there are exactly x pieces of the ice inside.Please, help Kay estimate the difficulty of the task given by the Snow Queen." 2600.0                            
                    685B "Kay and Snowflake" "data structures,dfs and similar,dp,trees" "After the piece of a devilish mirror hit the Kay\'s eye, he is no longer interested in the beauty of the roses. Now he likes to watch snowflakes.Once upon a time, he found a huge snowflake that has a form of the tree (connected acyclic graph) consisting of n nodes. The root of tree has index 1. Kay is very interested in the structure of this tree.After doing some research he formed q queries he is interested in. The i-th query asks to find a centroid of the subtree of the node vi. Your goal is to answer all queries.Subtree of a node is a part of tree consisting of this node and all it\'s descendants (direct or not). In other words, subtree of node v is formed by nodes u, such that node v is present on the path from u to root.Centroid of a tree (or a subtree) is a node, such that if we erase it from the tree, the maximum size of the connected component will be at least two times smaller than the size of the initial tree (or a subtree)." 1900.0                            
                    683J "The Hero with Bombs" "*special problem" "In a new computer game you need to help the hero to get out of the maze, which is a rectangular field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. The hero is located in one of the cells of this field. He knows where the exit of the maze is, and he wants to reach it.In one move, the hero can either move to the next cell (i.e. the cell which has a common side with the current cell) if it is free, or plant a bomb on the cell where he is, or skip the move and do nothing. A planted bomb explodes after three moves, that is, after the hero makes 3 more actions but does not have time to make the fourth (all three types of moves described above are considered as actions).The explosion destroys the obstacles in all the cells which have at least one common point with this cell (i.e. in all the cells sharing with the bomb cell a corner or a side). The explosion must not hurt the cell with the exit or the cell with the hero. The hero can not go beyond the boundaries of the maze.Your task is to determine the sequence of hero\'s actions to reach the exit. Note that you haven\'t to minimize the length of the sequence. The only restriction \xe2\x80\x94 the length of the resulting sequence should not exceed 100,000 symbols." 3000.0                            
                    683F "Reformat the String" "*special problem" "In this problem you are given a string s consisting of uppercase and lowercase Latin letters, spaces, dots and commas. Your task is to correct the formatting of this string by removing and inserting spaces, as well as changing the case of the letters.After formatting, the resulting string must meet the following requirements:  the string must not start with a space;  there should be exactly one space between any two consecutive words;  there should be a Latin letter immediately before a dot or a comma, and there should be a space immediately after a dot or a comma in the case that there is a word after that dot or comma, otherwise that dot or comma must be the last character in the string;  all letters must be lowercase, except all first letters in the first words of the sentences, they must be capitalized. The first word of a sentence is a word that is either the first word of the string or a word after a dot. It is guaranteed that there is at least one letter in the given string between any two punctuation marks (commas and dots are punctuation marks). There is at least one letter before the leftmost punctuation mark." 1800.0                            
                    680A "Bear and Five Cards" "constructive algorithms,implementation" "A little bear Limak plays a game. He has five cards. There is one number written on each card. Each number is a positive integer.Limak can discard (throw out) some cards. His goal is to minimize the sum of numbers written on remaining (not discarded) cards.He is allowed to at most once discard two or three cards with the same number. Of course, he won\'t discard cards if it\'s impossible to choose two or three cards with the same number.Given five numbers written on cards, cay you find the minimum sum of numbers on remaining cards?" 800.0                            
                    677D "Vanya and Treasure" "data structures,dp,graphs,shortest paths" "Vanya is in the palace that can be represented as a grid n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each room contains a single chest, an the room located in the i-th row and j-th columns contains the chest of type aij. Each chest of type x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89-\xe2\x80\x891 contains a key that can open any chest of type x\xe2\x80\x89+\xe2\x80\x891, and all chests of type 1 are not locked. There is exactly one chest of type p and it contains a treasure.Vanya starts in cell (1,\xe2\x80\x891) (top left corner). What is the minimum total distance Vanya has to walk in order to get the treasure? Consider the distance between cell (r1,\xe2\x80\x89c1) (the cell in the row r1 and column c1) and (r2,\xe2\x80\x89c2) is equal to |r1\xe2\x80\x89-\xe2\x80\x89r2|\xe2\x80\x89+\xe2\x80\x89|c1\xe2\x80\x89-\xe2\x80\x89c2|." 2300.0                            
                    662B "Graph Coloring" "dfs and similar,graphs" "You are given an undirected graph that consists of n vertices and m edges. Initially, each edge is colored either red or blue. Each turn a player picks a single vertex and switches the color of all edges incident to it. That is, all red edges with an endpoint in this vertex change the color to blue, while all blue edges with an endpoint in this vertex change the color to red.Find the minimum possible number of moves required to make the colors of all edges equal." 2200.0                            
                    656D "Rosetta Problem" "*special problem" "++++++++[>+>++>+++>++++>+++++>++++++>+++++++>++++++++>+++++++++>++++++++++>+++++++++++>++++++++++++>+++++++++++++>++++++++++++++>+++++++++++++++>++++++++++++++++<<<<<<<<<<<<<<<<-]>>>>>>>>>>.<<<<<<<<<<>>>>>>>>>>>>>>++.--<<<<<<<<<<<<<<>>>>>>>>>>>>>+.-<<<<<<<<<<<<<>>>>>>>>>>>>>>--.++<<<<<<<<<<<<<<>>>>>>>>>>>>>>>----.++++<<<<<<<<<<<<<<<>>>>.<<<<>>>>>>>>>>>>>>--.++<<<<<<<<<<<<<<>>>>>>>>>>>>>>>---.+++<<<<<<<<<<<<<<<>>>>>>>>>>>>>>---.+++<<<<<<<<<<<<<<>>>>>>>>>>>>++.--<<<<<<<<<<<<>>>>>>>>>>>>>---.+++<<<<<<<<<<<<<>>>>>>>>>>>>>>++.--<<<<<<<<<<<<<<.DCBA:^!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONMLKJIHdcbD`Y^]\\UZYRv9876543210/.-,+*)(\'&%$#""!~}|{zyxwvutsrqponm+*)(\'&%$#cya`=^]\\[ZYXWVUTSRQPONMLKJfe^cba`_X]VzTYRv98TSRQ3ONMLEi,+*)(\'&%$#""!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSonPlkjchg`ed]#DCBA@?>=<;:9876543OHGLKDIHGFE>b%$#""!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONMibafedcba`_X|?>Z<XWVUTSRKo\\ v34*8+6+,78+9*3+,93+9*5+,28+9*1+,55+9*4+,23*6*2*,91,@,+7*9*25,*48,+3*9+38,+<>62*9*2+,34*9*3+,66+9*8+,52*9*7+,75+9*8+,92+9*6+,48+9*3+,43*9*2+,84*,26*9*3^" 2100.0                            
                    653G "Move by Prime" "combinatorics,math,number theory" "Pussycat Sonya has an array consisting of n positive integers. There are 2n possible subsequences of the array. For each subsequence she counts the minimum number of operations to make all its elements equal. Each operation must be one of two:  Choose some element of the subsequence and multiply it by some prime number.  Choose some element of the subsequence and divide it by some prime number. The chosen element must be divisible by the chosen prime number. What is the sum of minimum number of operations for all 2n possible subsequences? Find and print this sum modulo 109\xe2\x80\x89+\xe2\x80\x897." 3100.0                            
                    653D "Delivery Bears" "binary search,flows,graphs" "Niwel is a little golden bear. As everyone knows, bears live in forests, but Niwel got tired of seeing all the trees so he decided to move to the city.In the city, Niwel took on a job managing bears to deliver goods. The city that he lives in can be represented as a directed graph with n nodes and m edges. Each edge has a weight capacity. A delivery consists of a bear carrying weights with their bear hands on a simple path from node 1 to node n. The total weight that travels across a particular edge must not exceed the weight capacity of that edge.Niwel has exactly x bears. In the interest of fairness, no bear can rest, and the weight that each bear carries must be exactly the same. However, each bear may take different paths if they like.Niwel would like to determine, what is the maximum amount of weight he can deliver (it\'s the sum of weights carried by bears). Find the maximum weight." 2200.0                            
                    652E "Pursuit For Artifacts" "dfs and similar,dsu,graphs,trees" "Johnny is playing a well-known computer game. The game are in some country, where the player can freely travel, pass quests and gain an experience.In that country there are n islands and m bridges between them, so you can travel from any island to any other. In the middle of some bridges are lying ancient powerful artifacts. Johnny is not interested in artifacts, but he can get some money by selling some artifact.At the start Johnny is in the island a and the artifact-dealer is in the island b (possibly they are on the same island). Johnny wants to find some artifact, come to the dealer and sell it. The only difficulty is that bridges are too old and destroying right after passing over them. Johnnie\'s character can\'t swim, fly and teleport, so the problem became too difficult.Note that Johnny can\'t pass the half of the bridge, collect the artifact and return to the same island. Determine if Johnny can find some artifact and sell it." 2300.0                            
                    650C "Table Compression" "dfs and similar,dp,dsu,graphs,greedy" "Little Petya is now fond of data compression algorithms. He has already studied gz, bz, zip algorithms and many others. Inspired by the new knowledge, Petya is now developing the new compression algorithm which he wants to name dis.Petya decided to compress tables. He is given a table a consisting of n rows and m columns that is filled with positive integers. He wants to build the table a\' consisting of positive integers such that the relative order of the elements in each row and each column remains the same. That is, if in some row i of the initial table ai,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89ai,\xe2\x80\x89k, then in the resulting table a\'i,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89a\'i,\xe2\x80\x89k, and if ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89ai,\xe2\x80\x89k then a\'i,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89a\'i,\xe2\x80\x89k. Similarly, if in some column j of the initial table ai,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89ap,\xe2\x80\x89j then in compressed table a\'i,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89a\'p,\xe2\x80\x89j and if ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89ap,\xe2\x80\x89j then a\'i,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89a\'p,\xe2\x80\x89j. Because large values require more space to store them, the maximum value in a\' should be as small as possible.Petya is good in theory, however, he needs your help to implement the algorithm." 2200.0                            
                    649E \xd0\x90\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81 "binary search,data structures,greedy,sortings" "\xd0\x92\xd0\xb4\xd0\xbe\xd0\xbb\xd1\x8c \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb8 \xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd1\x82 n \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2. \xd0\x94\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82 \xd1\x81\xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd1\x83\xd1\x8e, \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0\xd0\xbc\xd0\xb8 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xb1\xd1\x80\xd0\xb5\xd1\x87\xd1\x8c, \xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd1\x8f \xd0\xb8\xd1\x85 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb0\xd0\xbc\xd0\xb8.\xd0\x92\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb0 \xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd0\xb9, \xd0\xb1\xd0\xbb\xd0\xb0\xd0\xb3\xd0\xbe\xd0\xb4\xd0\xb0\xd1\x80\xd1\x8f \xd0\xbc\xd0\xbe\xd0\xb1\xd0\xb8\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8e, \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd1\x83 xi, \xd0\xb2 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb9 \xd1\x82\xd0\xbe\xd1\x82 \xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82. \xd0\x9a\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd0\xbe\xd0\xbd \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5 di, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb5 i-\xd0\xb9 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb5\xd1\x85\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5. \xd0\xa2\xd0\xb0\xd0\xba\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, i-\xd0\xb9 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba \xd0\xbf\xd0\xbb\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xb8\xd0\xb7 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb0 \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 xi\xe2\x80\x89+\xe2\x80\x89di. \xd0\xa2\xd0\xb5\xd0\xbf\xd0\xb5\xd1\x80\xd1\x8c \xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd0\xb9 \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xba\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xbe\xd0\xbd \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xb2\xd0\xb5\xd0\xb7\xd1\x91\xd1\x82, \xd0\xb0 \xd0\xba\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82 \xd0\xbf\xd1\x8b\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd1\x83 \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb8.\xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd0\xb9 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb, \xd1\x87\xd1\x82\xd0\xbe \xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe\xd0\xb4\xd0\xbd\xd1\x8f \xd0\xbe\xd0\xbd \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd1\x85\xd0\xbe\xd1\x80\xd0\xbe\xd1\x88\xd0\xbe \xd0\xb7\xd0\xb0\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c, \xd0\xbf\xd0\xbe\xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb2\xd0\xb5\xd0\xb7\xd1\x82\xd0\xb8 \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 a \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2. \xd0\x92 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xbf\xd0\xb0\xd1\x80\xd0\xba\xd0\xb5 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd1\x8b \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x8b\xd1\x85 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xbe\xd0\xb2. \xd0\xa7\xd0\xb5\xd0\xbc \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5, \xd1\x82\xd0\xb5\xd0\xbc \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb6\xd0\xb5 \xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82 \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xb0\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb4\xd0\xb0.\xd0\x9f\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd1\x8e \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd1\x81\xd0\xba\xd0\xb8\xd1\x85 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd0\xbe \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb7\xd0\xba\xd0\xb8 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe a \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2. \xd0\x9d\xd0\xb8 \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5 \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5, \xd1\x87\xd0\xb5\xd0\xbc \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd1\x81\xd0\xba\xd0\xb8\xd1\x85 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5. \xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd0\xb9 \xd1\x81\xd0\xb0\xd0\xbc \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd0\xba\xd1\x80\xd0\xb5\xd1\x82\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xb8\xd0\xb7 a \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xbe\xd0\xbd \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb2\xd0\xb5\xd0\xb7\xd1\x91\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5.\xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe (\xd0\xbe\xd1\x82 \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb8\xd1\x85 \xd0\xba\xd0\xbe\xd0\xbe\xd1\x80\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd1\x82 \xd0\xba \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xbc) \xd0\xb8 \xd0\xbd\xd0\xb0\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xbf\xd1\x83\xd1\x82\xd1\x8c \xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb5\xd0\xb5 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbb\xd0\xb5\xd0\xb2\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd1\x89\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9-\xd1\x82\xd0\xbe \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xb2\xd1\x8b\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xb8\xd0\xb7 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb0, \xd0\xb0 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xbe\xd0\xb9\xd1\x82\xd0\xb8, \xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd1\x81\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd0\xb7\xd0\xbe\xd0\xb9\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xb8\xd0\xb7 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb0, \xd0\xb0 \xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbc \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb9 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba \xd1\x81\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb7\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81." 2100.0                            
                    649D "\xd0\x94\xd0\xb5\xd1\x84\xd1\x80\xd0\xb0\xd0\xb3\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0\xd1\x86\xd0\xb8\xd1\x8f \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd0\xb8" "constructive algorithms,greedy,implementation" "\xd0\x9f\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd1\x8c \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd1\x8c\xd1\x8e\xd1\x82\xd0\xb5\xd1\x80\xd0\xb0 \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82 \xd0\xb8\xd0\xb7 n \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb5\xd0\xba, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb2\xd1\x8b\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb5\xd0\xbd\xd1\x8b \xd0\xb2 \xd1\x80\xd1\x8f\xd0\xb4. \xd0\x9f\xd1\x80\xd0\xbe\xd0\xbd\xd1\x83\xd0\xbc\xd0\xb5\xd1\x80\xd1\x83\xd0\xb5\xd0\xbc \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb8 \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe n \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe. \xd0\x9f\xd1\x80\xd0\xbe \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x83\xd1\x8e \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd1\x83 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe, \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xbd\xd0\xb0 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xbc\xd1\x83-\xd0\xbb\xd0\xb8\xd0\xb1\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd1\x83 (\xd0\xb2 \xd1\x82\xd0\xb0\xd0\xba\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xb5\xd0\xbd \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xbe\xd0\xbd\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82).\xd0\x94\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd0\xb0 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb0\xd1\x89\xd0\xb8\xd0\xb5 \xd0\xb5\xd0\xbc\xd1\x83 \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd1\x8e\xd1\x82 \xd0\xb2 \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd0\xb8 \xd0\xbd\xd0\xb5\xd0\xbf\xd1\x80\xd0\xb5\xd1\x80\xd1\x8b\xd0\xb2\xd0\xbd\xd1\x8b\xd0\xb9 \xd1\x83\xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xbe\xd0\xba. \xd0\xa1 \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xbe\xd1\x89\xd1\x8c\xd1\x8e \xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb9 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xb0 \xc2\xab\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xb8\xd0\xb7 \xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x82\xd0\xbe\xd0\xb9 \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb8 \xd0\xb2 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83\xd1\x8e, \xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x82\xd1\x83\xd1\x8e \xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd1\x80\xd1\x8c \xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9\xc2\xbb \xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb0\xd1\x89\xd0\xb8\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd0\xb0\xd0\xbc \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd0\xb5 \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd0\xb8 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd1\x8c\xd1\x8e\xd1\x82\xd0\xb5\xd1\x80\xd0\xb0. \xd0\x94\xd1\x80\xd1\x83\xd0\xb3\xd0\xb8\xd0\xbc\xd0\xb8 \xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbc\xd0\xb8, \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xb0\xd1\x8f \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb0 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xbd\xd0\xb0 \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0\xd0\xb3\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb5\xd0\xb5 (\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x82\xd1\x8c \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xb9 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80) \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x82\xd0\xbe\xd0\xb9.\xd0\x92\xd0\xb0\xd0\xbc \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb9 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbf\xd0\xb8\xd1\x81\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb8\xd0\xb7 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd1\x83\xd1\x8e, \xd1\x81 \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xbe\xd1\x89\xd1\x8c\xd1\x8e \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8\xd1\x87\xd1\x8c \xd0\xbe\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb9. \xd0\x94\xd0\xbe\xd0\xbf\xd1\x83\xd1\x81\xd1\x82\xd0\xb8\xd0\xbc\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbe\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xbe\xd0\xba \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb5\xd0\xba \xd0\xb2 \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd0\xb8 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd0\xbe\xd0\xb2 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xb4\xd0\xb5\xd1\x84\xd1\x80\xd0\xb0\xd0\xb3\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8, \xd0\xbd\xd0\xbe \xd0\xbe\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xbe\xd0\xba \xd1\x81\xd0\xb0\xd0\xbc\xd0\xb8\xd1\x85 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd0\xbe\xd0\xb2 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xb1\xd0\xb5\xd0\xb7 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9. \xd0\xad\xd1\x82\xd0\xbe \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb8\xd1\x82, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb2\xd1\x81\xd0\xb5 \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb8, \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb0\xd1\x89\xd0\xb8\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd1\x83 i, \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbb\xd0\xb8\xd1\x81\xd1\x8c \xd0\xb2 \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd0\xb8 \xd1\x80\xd0\xb0\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb5\xd0\xba \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd0\xb0 j, \xd1\x82\xd0\xbe \xd0\xb8 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9 \xd1\x8d\xd1\x82\xd0\xbe \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb5 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbd\xd1\x8f\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f.\xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd0\xbe\xd0\xb2 \xd1\x83\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b, \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb0 \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x82\xd0\xb0 \xd0\xba\xd0\xb0\xd0\xba\xd0\xb8\xd0\xbc-\xd0\xbb\xd0\xb8\xd0\xb1\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd0\xbe\xd0\xbc." 1600.0                            
                    649A "\xd0\x9b\xd1\x8e\xd0\xb1\xd0\xb8\xd0\xbc\xd1\x8b\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0 \xd0\x9f\xd0\xbe\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0\xd1\x80\xd0\xbf\xd0\xb0" "constructive algorithms,implementation" "\xd0\x9f\xd0\xbe\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0\xd1\x80\xd0\xbf \xd0\xbc\xd0\xb5\xd1\x87\xd1\x82\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd0\xbc \xd0\xb8 \xd1\x84\xd0\xb0\xd0\xbd\xd0\xb0\xd1\x82\xd0\xb5\xd0\xb5\xd1\x82 \xd0\xbe\xd1\x82 \xd1\x81\xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xb9 \xd0\xb4\xd0\xb2\xd0\xbe\xd0\xb9\xd0\xba\xd0\xb8. \xd0\xa1\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb8 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb \xd0\xb5\xd0\xbc\xd1\x83 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xbd\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd1\x82\xd0\xbe, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb5 \xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd1\x83\xd1\x8e \xd1\x81\xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0 2. \xd0\x9f\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd1\x85 \xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an \xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 r \xe2\x80\x94 \xd0\xbc\xd0\xb0\xd0\xba\xd1\x81\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x83\xd1\x8e \xd1\x81\xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0 2, \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x83\xd1\x8e \xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe \xd0\xb8\xd0\xb7 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8. \xd0\x9a\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb ai, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xb5\xd0\xbb\xd1\x8f\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 r." 1000.0                            
                    648B "\xd0\xa1\xd0\xbe\xd0\xb1\xd0\xb5\xd1\x80\xd0\xb8 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb" "constructive algorithms,sortings" "\xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd0\xba\xd1\x83\xd0\xbf\xd0\xb8\xd0\xbb \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb, \xd1\x83 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xbe n \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xba. \xd0\x9a\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xb0\xd1\x8f \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xba\xd0\xb0 \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82 \xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb5\xd0\xb9, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd1\x81\xd0\xbe\xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd1\x8f\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3 \xd1\x81 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc. \xd0\x9a\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xb0\xd1\x8f \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd1\x8c \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd0\xb7\xd0\xb2\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd1\x8b, \xd0\xbd\xd0\xbe \xd0\xb3\xd0\xb0\xd1\x80\xd0\xb0\xd0\xbd\xd1\x82\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 2n \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb5\xd0\xb9 \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c n \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xba \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd1\x8b. \xd0\x9f\xd1\x80\xd0\xb8 \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xba\xd0\xb8 \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xb2\xd0\xb5 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd1\x81\xd0\xbe\xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb5\xd0\xbd\xd1\x8b \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3 \xd1\x81 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc. \xd0\x98\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xba\xd0\xb8 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb0 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xbd\xd1\x8b, \xd0\xb0 \xd0\xb2\xd0\xb0\xd0\xbc \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd1\x8b \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd1\x8b 2n \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb5\xd0\xb9 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd0\xb7\xd0\xb2\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5.\xd0\x9f\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\x92\xd0\xb0\xd1\x81\xd0\xb5 \xd1\x81\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xba\xd0\xb8 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xbe\xd0\xbd\xd0\xb8 \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd1\x8b, \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb1\xd0\xb8\xd0\xb2 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 2n \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbd\xd0\xb0 \xd0\xbf\xd0\xb0\xd1\x80\xd1\x8b \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc. \xd0\x9a\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xb0\xd1\x8f \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xba\xd0\xb0 \xd0\xbe\xd0\xb1\xd1\x8f\xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xbd\xd0\xb0 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb5\xd0\xb9, \xd0\xbd\xd0\xb5 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb5\xd1\x88\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd0\xba \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xba\xd1\x83 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd1\x8c." 800.0                            
                    645E "Intellectual Inquiry" dp,greedy,strings "After getting kicked out of her reporting job for not knowing the alphabet, Bessie has decided to attend school at the Fillet and Eggs Eater Academy. She has been making good progress with her studies and now knows the first k English letters.Each morning, Bessie travels to school along a sidewalk consisting of m\xe2\x80\x89+\xe2\x80\x89n tiles. In order to help Bessie review, Mr. Moozing has labeled each of the first m sidewalk tiles with one of the first k lowercase English letters, spelling out a string t. Mr. Moozing, impressed by Bessie\'s extensive knowledge of farm animals, plans to let her finish labeling the last n tiles of the sidewalk by herself.Consider the resulting string s (|s|\xe2\x80\x89=\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x89n) consisting of letters labeled on tiles in order from home to school. For any sequence of indices p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pq we can define subsequence of the string s as string sp1sp2... spq. Two subsequences are considered to be distinct if they differ as strings. Bessie wants to label the remaining part of the sidewalk such that the number of distinct subsequences of tiles is maximum possible. However, since Bessie hasn\'t even finished learning the alphabet, she needs your help!Note that empty subsequence also counts." 2200.0                            
                    645B "Mischievous Mess Makers" greedy,math "It is a balmy spring afternoon, and Farmer John\'s n cows are ruminating about link-cut cacti in their stalls. The cows, labeled 1 through n, are arranged so that the i-th cow occupies the i-th stall from the left. However, Elsie, after realizing that she will forever live in the shadows beyond Bessie\'s limelight, has formed the Mischievous Mess Makers and is plotting to disrupt this beautiful pastoral rhythm. While Farmer John takes his k minute long nap, Elsie and the Mess Makers plan to repeatedly choose two distinct stalls and swap the cows occupying those stalls, making no more than one swap each minute.Being the meticulous pranksters that they are, the Mischievous Mess Makers would like to know the maximum messiness attainable in the k minutes that they have. We denote as pi the label of the cow in the i-th stall. The messiness of an arrangement of cows is defined as the number of pairs (i,\xe2\x80\x89j) such that i\xe2\x80\x89<\xe2\x80\x89j and pi\xe2\x80\x89>\xe2\x80\x89pj." 1200.0                            
                    638A "Home Numbers" "*special problem,constructive algorithms,math" "The main street of Berland is a straight line with n houses built along it (n is an even number). The houses are located at both sides of the street. The houses with odd numbers are at one side of the street and are numbered from 1 to n\xe2\x80\x89-\xe2\x80\x891 in the order from the beginning of the street to the end (in the picture: from left to right). The houses with even numbers are at the other side of the street and are numbered from 2 to n in the order from the end of the street to its beginning (in the picture: from right to left). The corresponding houses with even and odd numbers are strictly opposite each other, that is, house 1 is opposite house n, house 3 is opposite house n\xe2\x80\x89-\xe2\x80\x892, house 5 is opposite house n\xe2\x80\x89-\xe2\x80\x894 and so on.  Vasya needs to get to house number a as quickly as possible. He starts driving from the beginning of the street and drives his car to house a. To get from the beginning of the street to houses number 1 and n, he spends exactly 1 second. He also spends exactly one second to drive the distance between two neighbouring houses. Vasya can park at any side of the road, so the distance between the beginning of the street at the houses that stand opposite one another should be considered the same.Your task is: find the minimum time Vasya needs to reach house a." 1100.0                            
                    632E "Thief in a Shop" "divide and conquer,dp,fft,math" "A thief made his way to a shop.As usual he has his lucky knapsack with him. The knapsack can contain k objects. There are n kinds of products in the shop and an infinite number of products of each kind. The cost of one product of kind i is ai.The thief is greedy, so he will take exactly k products (it\'s possible for some kinds to take several products of that kind).Find all the possible total costs of products the thief can nick into his knapsack." 2400.0                            
                    632B "Alice, Bob, Two Teams" "brute force,constructive algorithms" "Alice and Bob are playing a game. The game involves splitting up game pieces into two teams. There are n pieces, and the i-th piece has a strength pi.The way to split up game pieces is split into several steps:  First, Alice will split the pieces into two different groups A and B. This can be seen as writing the assignment of teams of a piece in an n character string, where each character is A or B.  Bob will then choose an arbitrary prefix or suffix of the string, and flip each character in that suffix (i.e. change A to B and B to A). He can do this step at most once.  Alice will get all the pieces marked A and Bob will get all the pieces marked B. The strength of a player is then the sum of strengths of the pieces in the group.Given Alice\'s initial split into two teams, help Bob determine an optimal strategy. Return the maximum strength he can achieve." 1400.0                            
                    632A "Grandma Laura and Apples"  "Grandma Laura came to the market to sell some apples. During the day she sold all the apples she had. But grandma is old, so she forgot how many apples she had brought to the market.She precisely remembers she had n buyers and each of them bought exactly half of the apples she had at the moment of the purchase and also she gave a half of an apple to some of them as a gift (if the number of apples at the moment of purchase was odd), until she sold all the apples she had.So each buyer took some integral positive number of apples, but maybe he didn\'t pay for a half of an apple (if the number of apples at the moment of the purchase was odd).For each buyer grandma remembers if she gave a half of an apple as a gift or not. The cost of an apple is p (the number p is even).Print the total money grandma should have at the end of the day to check if some buyers cheated her." 1200.0                            
                    631D Messenger "data structures,hashing,implementation,string suffix structures,strings" "Each employee of the ""Blake Techologies"" company uses a special messaging app ""Blake Messenger"". All the stuff likes this app and uses it constantly. However, some important futures are missing. For example, many users want to be able to search through the message history. It was already announced that the new feature will appear in the nearest update, when developers faced some troubles that only you may help them to solve.All the messages are represented as a strings consisting of only lowercase English letters. In order to reduce the network load strings are represented in the special compressed form. Compression algorithm works as follows: string is represented as a concatenation of n blocks, each block containing only equal characters. One block may be described as a pair (li,\xe2\x80\x89ci), where li is the length of the i-th block and ci is the corresponding letter. Thus, the string s may be written as the sequence of pairs .Your task is to write the program, that given two compressed string t and s finds all occurrences of s in t. Developers know that there may be many such occurrences, so they only ask you to find the number of them. Note that p is the starting position of some occurrence of s in t if and only if tptp\xe2\x80\x89+\xe2\x80\x891...tp\xe2\x80\x89+\xe2\x80\x89|s|\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89s, where ti is the i-th character of string t.Note that the way to represent the string in compressed form may not be unique. For example string ""aaaa"" may be given as , , ..." 2100.0                            
                    630Q Pyramids geometry,math "IT City administration has no rest because of the fame of the Pyramids in Egypt. There is a project of construction of pyramid complex near the city in the place called Emerald Walley. The distinction of the complex is that its pyramids will be not only quadrangular as in Egypt but also triangular and pentagonal. Of course the amount of the city budget funds for the construction depends on the pyramids\' volume. Your task is to calculate the volume of the pilot project consisting of three pyramids \xe2\x80\x94 one triangular, one quadrangular and one pentagonal.The first pyramid has equilateral triangle as its base, and all 6 edges of the pyramid have equal length. The second pyramid has a square as its base and all 8 edges of the pyramid have equal length. The third pyramid has a regular pentagon as its base and all 10 edges of the pyramid have equal length." 1700.0                            
                    630M Turn geometry,math "Vasya started working in a machine vision company of IT City. Vasya\'s team creates software and hardware for identification of people by their face.One of the project\'s know-how is a camera rotating around its optical axis on shooting. People see an eye-catching gadget \xe2\x80\x94 a rotating camera \xe2\x80\x94 come up to it to see it better, look into it. And the camera takes their photo at that time. What could be better for high quality identification?But not everything is so simple. The pictures from camera appear rotated too (on clockwise camera rotation frame the content becomes rotated counter-clockwise). But the identification algorithm can work only with faces that are just slightly deviated from vertical.Vasya was entrusted to correct the situation \xe2\x80\x94 to rotate a captured image so that image would be minimally deviated from vertical. Requirements were severe. Firstly, the picture should be rotated only on angle divisible by 90 degrees to not lose a bit of information about the image. Secondly, the frames from the camera are so huge and FPS is so big that adequate rotation speed is provided by hardware FPGA solution only. And this solution can rotate only by 90 degrees clockwise. Of course, one can apply 90 degrees turn several times but for the sake of performance the number of turns should be minimized.Help Vasya implement the program that by the given rotation angle of the camera can determine the minimum number of 90 degrees clockwise turns necessary to get a picture in which up direction deviation from vertical is minimum.The next figure contains frames taken from an unrotated camera, then from rotated 90 degrees clockwise, then from rotated 90 degrees counter-clockwise. Arrows show direction to ""true up"".  The next figure shows 90 degrees clockwise turn by FPGA hardware." 1800.0                            
                    630J Divisibility "math,number theory" "IT City company developing computer games invented a new way to reward its employees. After a new game release users start buying it actively, and the company tracks the number of sales with precision to each transaction. Every time when the next number of sales is divisible by all numbers from 2 to 10 every developer of this game gets a small bonus.A game designer Petya knows that the company is just about to release a new game that was partly developed by him. On the basis of his experience he predicts that n people will buy the game during the first month. Now Petya wants to determine how many times he will get the bonus. Help him to know it." 1100.0                            
                    627E Orchestra "two pointers" "Paul is at the orchestra. The string section is arranged in an r\xe2\x80\x89\xc3\x97\xe2\x80\x89c rectangular grid and is filled with violinists with the exception of n violists. Paul really likes violas, so he would like to take a picture including at least k of them. Paul can take a picture of any axis-parallel rectangle in the orchestra. Count the number of possible pictures that Paul can take.Two pictures are considered to be different if the coordinates of corresponding rectangles are different." 3000.0                            
                    623C "Electric Charges" "binary search,dp" "Programmer Sasha is a student at MIPT (Moscow Institute of Physics and Technology) and he needs to make a laboratory work to pass his finals.A laboratory unit is a plane with standard coordinate axes marked on it. Physicists from Moscow Institute of Physics and Technology charged the axes by large electric charges: axis X is positive and axis Y is negative.Experienced laboratory worker marked n points with integer coordinates (xi,\xe2\x80\x89yi) on the plane and stopped the time. Sasha should use ""atomic tweezers"" to place elementary particles in these points. He has an unlimited number of electrons (negatively charged elementary particles) and protons (positively charged elementary particles). He can put either an electron or a proton at each marked point. As soon as all marked points are filled with particles, laboratory worker will turn on the time again and the particles will come in motion and after some time they will stabilize in equilibrium. The objective of the laboratory work is to arrange the particles in such a way, that the diameter of the resulting state (the maximum distance between the pairs of points of the set) is as small as possible.Since Sasha is a programmer, he naively thinks that all the particles will simply ""fall"" into their projections on the corresponding axes: electrons will fall on axis X, while protons will fall on axis Y. As we are programmers too, we will consider the same model as Sasha. That is, a particle gets from point (x,\xe2\x80\x89y) to point (x,\xe2\x80\x890) if it is an electron and to point (0,\xe2\x80\x89y) if it is a proton.As the laboratory has high background radiation and Sasha takes care of his laptop, he did not take it with him, and now he can\'t write a program that computes the minimum possible diameter of the resulting set. Therefore, you will have to do it for him.Print a square of the minimum possible diameter of the set." 2900.0                            
                    622F "The Sum of the k-th Powers" math "There are well-known formulas: , , . Also mathematicians found similar formulas for higher degrees.Find the value of the sum  modulo 109\xe2\x80\x89+\xe2\x80\x897 (so you should find the remainder after dividing the answer by the value 109\xe2\x80\x89+\xe2\x80\x897)." 2600.0                            
                    621D "Rat Kwesh and Cheese" "brute force,constructive algorithms,math" "Wet Shark asked Rat Kwesh to generate three positive real numbers x, y and z, from 0.1 to 200.0, inclusive. Wet Krash wants to impress Wet Shark, so all generated numbers will have exactly one digit after the decimal point.Wet Shark knows Rat Kwesh will want a lot of cheese. So he will give the Rat an opportunity to earn a lot of cheese. He will hand the three numbers x, y and z to Rat Kwesh, and Rat Kwesh will pick one of the these twelve options:  a1\xe2\x80\x89=\xe2\x80\x89xyz;  a2\xe2\x80\x89=\xe2\x80\x89xzy;  a3\xe2\x80\x89=\xe2\x80\x89(xy)z;  a4\xe2\x80\x89=\xe2\x80\x89(xz)y;  a5\xe2\x80\x89=\xe2\x80\x89yxz;  a6\xe2\x80\x89=\xe2\x80\x89yzx;  a7\xe2\x80\x89=\xe2\x80\x89(yx)z;  a8\xe2\x80\x89=\xe2\x80\x89(yz)x;  a9\xe2\x80\x89=\xe2\x80\x89zxy;  a10\xe2\x80\x89=\xe2\x80\x89zyx;  a11\xe2\x80\x89=\xe2\x80\x89(zx)y;  a12\xe2\x80\x89=\xe2\x80\x89(zy)x. Let m be the maximum of all the ai, and c be the smallest index (from 1 to 12) such that ac\xe2\x80\x89=\xe2\x80\x89m. Rat\'s goal is to find that c, and he asks you to help him. Rat Kwesh wants to see how much cheese he gets, so he you will have to print the expression corresponding to that ac." 2400.0                            
                    618G "Combining Slimes" dp,math,matrices,probabilities "Your friend recently gave you some slimes for your birthday. You have a very large amount of slimes with value 1 and 2, and you decide to invent a game using these slimes.You initialize a row with n empty spaces. You also choose a number p to be used in the game. Then, you will perform the following steps while the last space is empty.   With probability , you will choose a slime with value 1, and with probability , you will choose a slime with value 2. You place the chosen slime on the last space of the board.  You will push the slime to the left as far as possible. If it encounters another slime, and they have the same value v, you will merge the slimes together to create a single slime with value v\xe2\x80\x89+\xe2\x80\x891. This continues on until the slime reaches the end of the board, or encounters a slime with a different value than itself. You have played the game a few times, but have gotten bored of it. You are now wondering, what is the expected sum of all values of the slimes on the board after you finish the game." 3300.0                            
                    618C Constellation geometry,implementation "Cat Noku has obtained a map of the night sky. On this map, he found a constellation with n stars numbered from 1 to n. For each i, the i-th star is located at coordinates (xi,\xe2\x80\x89yi). No two stars are located at the same position.In the evening Noku is going to take a look at the night sky. He would like to find three distinct stars and form a triangle. The triangle must have positive area. In addition, all other stars must lie strictly outside of this triangle. He is having trouble finding the answer and would like your help. Your job is to find the indices of three stars that would form a triangle that satisfies all the conditions. It is guaranteed that there is no line such that all stars lie on that line. It can be proven that if the previous condition is satisfied, there exists a solution to this problem." 1600.0                            
                    617D Polyline "constructive algorithms,implementation" "There are three points marked on the coordinate plane. The goal is to make a simple polyline, without self-intersections and self-touches, such that it passes through all these points. Also, the polyline must consist of only segments parallel to the coordinate axes. You are to find the minimum number of segments this polyline may consist of." 1700.0                            
                    617A Elephant math "An elephant decided to visit his friend. It turned out that the elephant\'s house is located at point 0 and his friend\'s house is located at point x(x\xe2\x80\x89>\xe2\x80\x890) of the coordinate line. In one step the elephant can move 1, 2, 3, 4 or 5 positions forward. Determine, what is the minimum number of steps he need to make in order to get to his friend\'s house." 800.0                            
                    613B Skills "binary search,brute force,dp,greedy,sortings,two pointers" "Lesha plays the recently published new version of the legendary game hacknet. In this version character skill mechanism was introduced. Now, each player character has exactly n skills. Each skill is represented by a non-negative integer ai \xe2\x80\x94 the current skill level. All skills have the same maximum level A.Along with the skills, global ranking of all players was added. Players are ranked according to the so-called Force. The Force of a player is the sum of the following values:  The number of skills that a character has perfected (i.e., such that ai\xe2\x80\x89=\xe2\x80\x89A), multiplied by coefficient cf. The minimum skill level among all skills (min ai), multiplied by coefficient cm. Now Lesha has m hacknetian currency units, which he is willing to spend. Each currency unit can increase the current level of any skill by 1 (if it\'s not equal to A yet). Help him spend his money in order to achieve the maximum possible value of the Force." 1900.0                            
                    611E "New Year and Three Musketeers" "data structures,greedy,sortings" "Do you know the story about the three musketeers? Anyway, you must help them now.Richelimakieu is a cardinal in the city of Bearis. He found three brave warriors and called them the three musketeers. Athos has strength a, Borthos strength b, and Caramis has strength c.The year 2015 is almost over and there are still n criminals to be defeated. The i-th criminal has strength ti. It\'s hard to defeat strong criminals \xe2\x80\x94 maybe musketeers will have to fight together to achieve it.Richelimakieu will coordinate musketeers\' actions. In each hour each musketeer can either do nothing or be assigned to one criminal. Two or three musketeers can be assigned to the same criminal and then their strengths are summed up. A criminal can be defeated in exactly one hour (also if two or three musketeers fight him). Richelimakieu can\'t allow the situation where a criminal has strength bigger than the sum of strengths of musketeers fighting him \xe2\x80\x94 a criminal would win then!In other words, there are three ways to defeat a criminal.  A musketeer of the strength x in one hour can defeat a criminal of the strength not greater than x. So, for example Athos in one hour can defeat criminal i only if ti\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a.  Two musketeers can fight together and in one hour defeat a criminal of the strength not greater than the sum of strengths of these two musketeers. So, for example Athos and Caramis in one hour can defeat criminal i only if ti\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x89c. Note that the third remaining musketeer can either do nothing or fight some other criminal.  Similarly, all three musketeers can fight together and in one hour defeat a criminal of the strength not greater than the sum of musketeers\' strengths, i.e. ti\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x89c. Richelimakieu doesn\'t want musketeers to fight during the New Year\'s Eve. Thus, he must coordinate their actions in order to minimize the number of hours till all criminals will be defeated.Find the minimum number of hours to defeat all criminals. If musketeers can\'t defeat them all then print ""-1"" (without the quotes) instead." 2400.0                            
                    610C "Harmony Analysis" "constructive algorithms" "The semester is already ending, so Danil made an effort and decided to visit a lesson on harmony analysis to know how does the professor look like, at least. Danil was very bored on this lesson until the teacher gave the group a simple task: find 4 vectors in 4-dimensional space, such that every coordinate of every vector is 1 or \xe2\x80\x89-\xe2\x80\x891 and any two vectors are orthogonal. Just as a reminder, two vectors in n-dimensional space are considered to be orthogonal if and only if their scalar product is equal to zero, that is: .Danil quickly managed to come up with the solution for this problem and the teacher noticed that the problem can be solved in a more general case for 2k vectors in 2k-dimensinoal space. When Danil came home, he quickly came up with the solution for this problem. Can you cope with it?" 1800.0                            
                    610B "Vika and Squares" "constructive algorithms,implementation" "Vika has n jars with paints of distinct colors. All the jars are numbered from 1 to n and the i-th jar contains ai liters of paint of color i.Vika also has an infinitely long rectangular piece of paper of width 1, consisting of squares of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891. Squares are numbered 1, 2, 3 and so on. Vika decided that she will start painting squares one by one from left to right, starting from the square number 1 and some arbitrary color. If the square was painted in color x, then the next square will be painted in color x\xe2\x80\x89+\xe2\x80\x891. In case of x\xe2\x80\x89=\xe2\x80\x89n, next square is painted in color 1. If there is no more paint of the color Vika wants to use now, then she stops.Square is always painted in only one color, and it takes exactly 1 liter of paint. Your task is to calculate the maximum number of squares that might be painted, if Vika chooses right color to paint the first square." 1300.0                            
                    608A "Saitama Destroys Hotel" implementation,math "Saitama accidentally destroyed a hotel again. To repay the hotel company, Genos has volunteered to operate an elevator in one of its other hotels. The elevator is special \xe2\x80\x94 it starts on the top floor, can only move down, and has infinite capacity. Floors are numbered from 0 to s and elevator initially starts on floor s at time 0.The elevator takes exactly 1 second to move down exactly 1 floor and negligible time to pick up passengers. Genos is given a list detailing when and on which floor passengers arrive. Please determine how long in seconds it will take Genos to bring all passengers to floor 0." 1000.0                            
                    605D "Board Game" "data structures,dfs and similar" "You are playing a board card game. In this game the player has two characteristics, x and y \xe2\x80\x94 the white magic skill and the black magic skill, respectively. There are n spell cards lying on the table, each of them has four characteristics, ai, bi, ci and di. In one move a player can pick one of the cards and cast the spell written on it, but only if first two of it\'s characteristics meet the requirement ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x and bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y, i.e. if the player has enough magic skill to cast this spell. However, after casting the spell the characteristics of a player change and become equal to x\xe2\x80\x89=\xe2\x80\x89ci and y\xe2\x80\x89=\xe2\x80\x89di.At the beginning of the game both characteristics of a player are equal to zero. The goal of the game is to cast the n-th spell. Your task is to make it in as few moves as possible. You are allowed to use spell in any order and any number of times (for example, you may not use some spells at all)." 2500.0                            
                    605A "Sorting Railway Cars" "constructive algorithms,greedy" "An infinitely long railway has a train consisting of n cars, numbered from 1 to n (the numbers of all the cars are distinct) and positioned in arbitrary order. David Blaine wants to sort the railway cars in the order of increasing numbers. In one move he can make one of the cars disappear from its place and teleport it either to the beginning of the train, or to the end of the train, at his desire. What is the minimum number of actions David Blaine needs to perform in order to sort the train?" 1600.0                            
                    599E "Sandy and Nuts" bitmasks,dp,trees "Rooted tree is a connected graph without any simple cycles with one vertex selected as a root. In this problem the vertex number 1 will always serve as a root.Lowest common ancestor of two vertices u and v is the farthest from the root vertex that lies on both the path from u to the root and on path from v to the root. We will denote it as LCA(u,\xe2\x80\x89v).Sandy had a rooted tree consisting of n vertices that she used to store her nuts. Unfortunately, the underwater storm broke her tree and she doesn\'t remember all it\'s edges. She only managed to restore m edges of the initial tree and q triples ai, bi and ci, for which she supposes LCA(ai,\xe2\x80\x89bi)\xe2\x80\x89=\xe2\x80\x89ci.Help Sandy count the number of trees of size n with vertex 1 as a root, that match all the information she remembered. If she made a mess and there are no such trees then print 0. Two rooted trees are considered to be distinct if there exists an edge that occur in one of them and doesn\'t occur in the other one." 2600.0                            
                    598C "Nearest vectors" geometry,sortings "You are given the set of vectors on the plane, each of them starting at the origin. Your task is to find a pair of vectors with the minimal non-oriented angle between them.Non-oriented angle is non-negative value, minimal between clockwise and counterclockwise direction angles. Non-oriented angle is always between 0 and \xcf\x80. For example, opposite directions vectors have angle equals to \xcf\x80." 2300.0                            
                    597C Subsequences "data structures,dp" "For the given sequence with n different elements find the number of increasing subsequences with k\xe2\x80\x89+\xe2\x80\x891 elements. It is guaranteed that the answer is not greater than 8\xc2\xb71018." 1900.0                            
                    596C "Wilbur and Points" combinatorics,greedy,sortings "Wilbur is playing with a set of n points on the coordinate plane. All points have non-negative integer coordinates. Moreover, if some point (x, y) belongs to the set, then all points (x\', y\'), such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\'\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\'\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y also belong to this set.Now Wilbur wants to number the points in the set he has, that is assign them distinct integer numbers from 1 to n. In order to make the numbering aesthetically pleasing, Wilbur imposes the condition that if some point (x, y) gets number i, then all (x\',y\') from the set, such that x\'\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89x and y\'\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89y must be assigned a number not less than i. For example, for a set of four points (0, 0), (0, 1), (1, 0) and (1, 1), there are two aesthetically pleasing numberings. One is 1, 2, 3, 4 and another one is 1, 3, 2, 4.Wilbur\'s friend comes along and challenges Wilbur. For any point he defines it\'s special value as s(x,\xe2\x80\x89y)\xe2\x80\x89=\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89x. Now he gives Wilbur some w1, w2,..., wn, and asks him to find an aesthetically pleasing numbering of the points in the set, such that the point that gets number i has it\'s special value equal to wi, that is s(xi,\xe2\x80\x89yi)\xe2\x80\x89=\xe2\x80\x89yi\xe2\x80\x89-\xe2\x80\x89xi\xe2\x80\x89=\xe2\x80\x89wi.Now Wilbur asks you to help him with this challenge." 1700.0                            
                    585E "Present for Vitalik the Philatelist" "combinatorics,math,number theory" "Vitalik the philatelist has a birthday today!As he is a regular customer in a stamp store called \'Robin Bobin\', the store management decided to make him a gift.Vitalik wants to buy one stamp and the store will give him a non-empty set of the remaining stamps, such that the greatest common divisor (GCD) of the price of the stamps they give to him is more than one. If the GCD of prices of the purchased stamp and prices of present stamps set will be equal to 1, then Vitalik will leave the store completely happy.The store management asks you to count the number of different situations in which Vitalik will leave the store completely happy. Since the required number of situations can be very large, you need to find the remainder of this number modulo 109\xe2\x80\x89+\xe2\x80\x897. The situations are different if the stamps purchased by Vitalik are different, or if one of the present sets contains a stamp that the other present does not contain." 2900.0                            
                    582C "Superior Periodic Subarrays" "number theory" "You are given an infinite periodic array a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89... with the period of length n. Formally, . A periodic subarray (l,\xe2\x80\x89s) (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s\xe2\x80\x89<\xe2\x80\x89n) of array a is an infinite periodic array with a period of length s that is a subsegment of array a, starting with position l.A periodic subarray (l,\xe2\x80\x89s) is superior, if when attaching it to the array a, starting from index l, any element of the subarray is larger than or equal to the corresponding element of array a. An example of attaching is given on the figure (top \xe2\x80\x94 infinite array a, bottom \xe2\x80\x94 its periodic subarray (l,\xe2\x80\x89s)):  Find the number of distinct pairs (l,\xe2\x80\x89s), corresponding to the superior periodic arrays." 2400.0                            
                    581D "Three Logos" "bitmasks,brute force,constructive algorithms,geometry,implementation,math" "Three companies decided to order a billboard with pictures of their logos. A billboard is a big square board. A logo of each company is a rectangle of a non-zero area. Advertisers will put up the ad only if it is possible to place all three logos on the billboard so that they do not overlap and the billboard has no empty space left. When you put a logo on the billboard, you should rotate it so that the sides were parallel to the sides of the billboard.Your task is to determine if it is possible to put the logos of all the three companies on some square billboard without breaking any of the described rules." 1700.0                            
                    579B "Finding Team Member" "brute force,implementation,sortings" "There is a programing contest named SnakeUp, 2n people want to compete for it. In order to attend this contest, people need to form teams of exactly two people. You are given the strength of each possible combination of two people. All the values of the strengths are distinct.Every contestant hopes that he can find a teammate so that their team\xe2\x80\x99s strength is as high as possible. That is, a contestant will form a team with highest strength possible by choosing a teammate from ones who are willing to be a teammate with him/her. More formally, two people A and B may form a team if each of them is the best possible teammate (among the contestants that remain unpaired) for the other one. Can you determine who will be each person\xe2\x80\x99s teammate?" 1300.0                            
                    576E "Painting Edges" "binary search,data structures" "Note the unusual memory limit for this problem.You are given an undirected graph consisting of n vertices and m edges. The vertices are numbered with integers from 1 to n, the edges are numbered with integers from 1 to m. Each edge can be unpainted or be painted in one of the k colors, which are numbered with integers from 1 to k. Initially, none of the edges is painted in any of the colors.You get queries of the form ""Repaint edge ei to color ci"". At any time the graph formed by the edges of the same color must be bipartite. If after the repaint this condition is violated, then the query is considered to be invalid and edge ei keeps its color. Otherwise, edge ei is repainted in color ci, and the query is considered to valid.Recall that the graph is called bipartite if the set of its vertices can be divided into two parts so that no edge connected vertices of the same parts.For example, suppose you are given a triangle graph, that is a graph with three vertices and edges (1,\xe2\x80\x892), (2,\xe2\x80\x893) and (3,\xe2\x80\x891). Suppose that the first two edges are painted color 1, and the third one is painted color 2. Then the query of ""repaint the third edge in color 1"" will be incorrect because after its execution the graph formed by the edges of color 1 will not be bipartite. On the other hand, it is possible to repaint the second edge in color 2.You receive q queries. For each query, you should either apply it, and report that the query is valid, or report that the query is invalid." 3300.0                            
                    575H Bots "combinatorics,dp,math,number theory" "Sasha and Ira are two best friends. But they aren\xe2\x80\x99t just friends, they are software engineers and experts in artificial intelligence. They are developing an algorithm for two bots playing a two-player game. The game is cooperative and turn based. In each turn, one of the players makes a move (it doesn\xe2\x80\x99t matter which player, it\'s possible that players turns do not alternate). Algorithm for bots that Sasha and Ira are developing works by keeping track of the state the game is in. Each time either bot makes a move, the state changes. And, since the game is very dynamic, it will never go back to the state it was already in at any point in the past.Sasha and Ira are perfectionists and want their algorithm to have an optimal winning strategy. They have noticed that in the optimal winning strategy, both bots make exactly N moves each. But, in order to find the optimal strategy, their algorithm needs to analyze all possible states of the game (they haven\xe2\x80\x99t learned about alpha-beta pruning yet) and pick the best sequence of moves.They are worried about the efficiency of their algorithm and are wondering what is the total number of states of the game that need to be analyzed?" 1800.0                            
                    573A "Bear and Poker" "implementation,math,number theory" "Limak is an old brown bear. He often plays poker with his friends. Today they went to a casino. There are n players (including Limak himself) and right now all of them have bids on the table. i-th of them has bid with size ai dollars.Each player can double his bid any number of times and triple his bid any number of times. The casino has a great jackpot for making all bids equal. Is it possible that Limak and his friends will win a jackpot?" 1300.0                            
                    570C Replacement "constructive algorithms,data structures,implementation" "Daniel has a string s, consisting of lowercase English letters and period signs (characters \'.\'). Let\'s define the operation of replacement as the following sequence of steps: find a substring "".."" (two consecutive periods) in string s, of all occurrences of the substring let\'s choose the first one, and replace this substring with string ""."". In other words, during the replacement operation, the first two consecutive periods are replaced by one. If string s contains no two consecutive periods, then nothing happens.Let\'s define f(s) as the minimum number of operations of replacement to perform, so that the string does not have any two consecutive periods left.You need to process m queries, the i-th results in that the character at position xi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of string s is assigned value ci. After each operation you have to calculate and output the value of f(s).Help Daniel to process all queries." 1600.0                            
                    568D "Sign Posts" "brute force,geometry,math" "One Khanate had a lot of roads and very little wood. Riding along the roads was inconvenient, because the roads did not have road signs indicating the direction to important cities.The Han decided that it\'s time to fix the issue, and ordered to put signs on every road. The Minister of Transport has to do that, but he has only k signs. Help the minister to solve his problem, otherwise the poor guy can lose not only his position, but also his head.More formally, every road in the Khanate is a line on the Oxy plane, given by an equation of the form Ax\xe2\x80\x89+\xe2\x80\x89By\xe2\x80\x89+\xe2\x80\x89C\xe2\x80\x89=\xe2\x80\x890 (A and B are not equal to 0 at the same time). You are required to determine whether you can put signs in at most k points so that each road had at least one sign installed." 2800.0                            
                    568B "Symmetric and Transitive" combinatorics,dp,math "Little Johnny has recently learned about set theory. Now he is studying binary relations. You\'ve probably heard the term ""equivalence relation"". These relations are very important in many areas of mathematics. For example, the equality of the two numbers is an equivalence relation.A set \xcf\x81 of pairs (a,\xe2\x80\x89b) of elements of some set A is called a binary relation on set A. For two elements a and b of the set A we say that they are in relation \xcf\x81, if pair , in this case we use a notation .Binary relation is equivalence relation, if: It is reflexive (for any a it is true that ); It is symmetric (for any a, b it is true that if , then ); It is transitive (if  and , than ).Little Johnny is not completely a fool and he noticed that the first condition is not necessary! Here is his ""proof"":Take any two elements, a and b. If , then  (according to property (2)), which means  (according to property (3)).It\'s very simple, isn\'t it? However, you noticed that Johnny\'s ""proof"" is wrong, and decided to show him a lot of examples that prove him wrong.Here\'s your task: count the number of binary relations over a set of size n such that they are symmetric, transitive, but not an equivalence relations (i.e. they are not reflexive).Since their number may be very large (not 0, according to Little Johnny), print the remainder of integer division of this number by 109\xe2\x80\x89+\xe2\x80\x897." 1900.0                            
                    559C "Gerald and Giant Chess" "combinatorics,dp,math,number theory" "Giant chess is quite common in Geraldion. We will not delve into the rules of the game, we\'ll just say that the game takes place on an h\xe2\x80\x89\xc3\x97\xe2\x80\x89w field, and it is painted in two colors, but not like in chess. Almost all cells of the field are white and only some of them are black. Currently Gerald is finishing a game of giant chess against his friend Pollard. Gerald has almost won, and the only thing he needs to win is to bring the pawn from the upper left corner of the board, where it is now standing, to the lower right corner. Gerald is so confident of victory that he became interested, in how many ways can he win?The pawn, which Gerald has got left can go in two ways: one cell down or one cell to the right. In addition, it can not go to the black cells, otherwise the Gerald still loses. There are no other pawns or pieces left on the field, so that, according to the rules of giant chess Gerald moves his pawn until the game is over, and Pollard is just watching this process." 2200.0                            
                    559B "Equivalent Strings" "divide and conquer,hashing,sortings,strings" "Today on a lecture about strings Gerald learned a new definition of string equivalency. Two strings a and b of equal length are called equivalent in one of the two cases:   They are equal.  If we split string a into two halves of the same size a1 and a2, and string b into two halves of the same size b1 and b2, then one of the following is correct:   a1 is equivalent to b1, and a2 is equivalent to b2  a1 is equivalent to b2, and a2 is equivalent to b1  As a home task, the teacher gave two strings to his students and asked to determine if they are equivalent.Gerald has already completed this home task. Now it\'s your turn!" 1700.0                            
                    555D "Case of a Top Secret" "binary search,implementation,math" "Andrewid the Android is a galaxy-famous detective. Now he is busy with a top secret case, the details of which are not subject to disclosure.However, he needs help conducting one of the investigative experiment. There are n pegs put on a plane, they are numbered from 1 to n, the coordinates of the i-th of them are (xi,\xe2\x80\x890). Then, we tie to the bottom of one of the pegs a weight on a tight rope of length l (thus, its coordinates will be equal to (xi,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89l), where i is the number of the used peg). Then the weight is pushed to the right, so that it starts to rotate counterclockwise. At the same time, if the weight during rotation touches some of the other pegs, it then begins to rotate around that peg. Suppose that each peg itself is very thin and does not affect the rope length while weight is rotating around it.  More formally, if at some moment the segment of the rope contains one or more pegs in addition to the peg around which the weight is rotating, the weight will then rotate around the farthermost one of them on a shorter segment of a rope. In particular, if the segment of the rope touches some peg by its endpoint, it is considered that the weight starts to rotate around that peg on a segment of the rope of length 0.At some moment the weight will begin to rotate around some peg, without affecting the rest of the pegs. Andrewid interested in determining the number of this peg.Andrewid prepared m queries containing initial conditions for pushing the weight, help him to determine for each of them, around what peg the weight will eventually rotate." 2500.0                            
                    555A "Case of Matryoshkas" implementation "Andrewid the Android is a galaxy-famous detective. He is now investigating the case of vandalism at the exhibition of contemporary art.The main exhibit is a construction of n matryoshka dolls that can be nested one into another. The matryoshka dolls are numbered from 1 to n. A matryoshka with a smaller number can be nested in a matryoshka with a higher number, two matryoshkas can not be directly nested in the same doll, but there may be chain nestings, for example, 1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x892\xe2\x80\x89\xe2\x86\x92\xe2\x80\x894\xe2\x80\x89\xe2\x86\x92\xe2\x80\x895. In one second, you can perform one of the two following operations:  Having a matryoshka a that isn\'t nested in any other matryoshka and a matryoshka b, such that b doesn\'t contain any other matryoshka and is not nested in any other matryoshka, you may put a in b;  Having a matryoshka a directly contained in matryoshka b, such that b is not nested in any other matryoshka, you may get a out of b. According to the modern aesthetic norms the matryoshka dolls on display were assembled in a specific configuration, i.e. as several separate chains of nested matryoshkas, but the criminal, following the mysterious plan, took out all the dolls and assembled them into a single large chain (1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x892\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89n). In order to continue the investigation Andrewid needs to know in what minimum time it is possible to perform this action." 1500.0                            
                    553E "Kyoya and Train" dp,fft,graphs,math,probabilities "Kyoya Ootori wants to take the train to get to school. There are n train stations and m one-way train lines going between various stations. Kyoya is currently at train station 1, and the school is at station n. To take a train, he must pay for a ticket, and the train also takes a certain amount of time. However, the trains are not perfect and take random amounts of time to arrive at their destination. If Kyoya arrives at school strictly after t time units, he will have to pay a fine of x.Each train line is described by a ticket price, and a probability distribution on the time the train takes. More formally, train line i has ticket cost ci, and a probability distribution pi,\xe2\x80\x89k which denotes the probability that this train will take k time units for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t. Amounts of time that each of the trains used by Kyouya takes are mutually independent random values (moreover, if Kyoya travels along the same train more than once, it is possible for the train to take different amounts of time and those amounts are also independent one from another). Kyoya wants to get to school by spending the least amount of money in expectation (for the ticket price plus possible fine for being late). Of course, Kyoya has an optimal plan for how to get to school, and every time he arrives at a train station, he may recalculate his plan based on how much time he has remaining. What is the expected cost that Kyoya will pay to get to school if he moves optimally?" 3200.0                            
                    550B "Preparing Olympiad" "bitmasks,brute force" "You have n problems. You have estimated the difficulty of the i-th one as integer ci. Now you want to prepare a problemset for a contest, using some of the problems you\'ve made.A problemset for the contest must consist of at least two problems. You think that the total difficulty of the problems of the contest must be at least l and at most r. Also, you think that the difference between difficulties of the easiest and the hardest of the chosen problems must be at least x.Find the number of ways to choose a problemset for the contest." 1400.0                            
                    549G "Happy Line" "constructive algorithms,greedy,sortings" "Do you like summer? Residents of Berland do. They especially love eating ice cream in the hot summer. So this summer day a large queue of n Berland residents lined up in front of the ice cream stall. We know that each of them has a certain amount of berland dollars with them. The residents of Berland are nice people, so each person agrees to swap places with the person right behind him for just 1 dollar. More formally, if person a stands just behind person b, then person a can pay person b 1 dollar, then a and b get swapped. Of course, if person a has zero dollars, he can not swap places with person b.Residents of Berland are strange people. In particular, they get upset when there is someone with a strictly smaller sum of money in the line in front of them.Can you help the residents of Berland form such order in the line so that they were all happy? A happy resident is the one who stands first in the line or the one in front of who another resident stands with not less number of dollars. Note that the people of Berland are people of honor and they agree to swap places only in the manner described above." 2200.0                            
                    548A "Mike and Fax" "brute force,implementation,strings" "While Mike was walking in the subway, all the stuff in his back-bag dropped on the ground. There were several fax messages among them. He concatenated these strings in some order and now he has string s.  He is not sure if this is his own back-bag or someone else\'s. He remembered that there were exactly k messages in his own bag, each was a palindrome string and all those strings had the same length.He asked you to help him and tell him if he has worn his own back-bag. Check if the given string s is a concatenation of k palindromes of the same length." 1100.0                            
                    547D "Mike and Fish" "constructive algorithms,dfs and similar,graphs" "As everyone knows, bears love fish. But Mike is a strange bear; He hates fish! The even more strange thing about him is he has an infinite number of blue and red fish.   He has marked n distinct points in the plane. i-th point is point (xi,\xe2\x80\x89yi). He wants to put exactly one fish in each of these points such that the difference between the number of red fish and the blue fish on each horizontal or vertical line is at most 1.He can\'t find a way to perform that! Please help him." 2600.0                            
                    546E "Soldier and Traveling" flows,graphs,math "In the country there are n cities and m bidirectional roads between them. Each city has an army. Army of the i-th city consists of ai soldiers. Now soldiers roam. After roaming each soldier has to either stay in his city or to go to the one of neighboring cities by at moving along at most one road.Check if is it possible that after roaming there will be exactly bi soldiers in the i-th city." 2100.0                            
                    545C Woodcutters dp,greedy "Little Susie listens to fairy tales before bed every day. Today\'s fairy tale was about wood cutters and the little girl immediately started imagining the choppers cutting wood. She imagined the situation that is described below.There are n trees located along the road at points with coordinates x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. Each tree has its height hi. Woodcutters can cut down a tree and fell it to the left or to the right. After that it occupies one of the segments [xi\xe2\x80\x89-\xe2\x80\x89hi,\xe2\x80\x89xi] or [xi;xi\xe2\x80\x89+\xe2\x80\x89hi]. The tree that is not cut down occupies a single point with coordinate xi. Woodcutters can fell a tree if the segment to be occupied by the fallen tree doesn\'t contain any occupied point. The woodcutters want to process as many trees as possible, so Susie wonders, what is the maximum number of trees to fell." 1500.0                            
                    544B "Sea and Islands" "constructive algorithms,implementation" "A map of some object is a rectangular field consisting of n rows and n columns. Each cell is initially occupied by the sea but you can cover some some cells of the map with sand so that exactly k islands appear on the map. We will call a set of sand cells to be island if it is possible to get from each of them to each of them by moving only through sand cells and by moving from a cell only to a side-adjacent cell. The cells are called to be side-adjacent if they share a vertical or horizontal side. It is easy to see that islands do not share cells (otherwise they together form a bigger island).Find a way to cover some cells with sand so that exactly k islands appear on the n\xe2\x80\x89\xc3\x97\xe2\x80\x89n map, or determine that no such way exists." 1400.0                            
                    542D "Superhero\'s Job" "dfs and similar,dp,hashing,math,number theory" "It\'s tough to be a superhero. And it\'s twice as tough to resist the supervillain who is cool at math. Suppose that you\'re an ordinary Batman in an ordinary city of Gotham. Your enemy Joker mined the building of the city administration and you only have several minutes to neutralize the charge. To do that you should enter the cancel code on the bomb control panel.However, that mad man decided to give you a hint. This morning the mayor found a playing card under his pillow. There was a line written on the card:The bomb has a note saying ""J(x)\xe2\x80\x89=\xe2\x80\x89A"", where A is some positive integer. You suspect that the cancel code is some integer x that meets the equation J(x)\xe2\x80\x89=\xe2\x80\x89A. Now in order to decide whether you should neutralize the bomb or run for your life, you\'ve got to count how many distinct positive integers x meet this equation." 2600.0                            
                    538D "Weird Chess" "brute force,constructive algorithms,implementation" "Igor has been into chess for a long time and now he is sick of the game by the ordinary rules. He is going to think of new rules of the game and become world famous.Igor\'s chessboard is a square of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. Igor decided that simple rules guarantee success, that\'s why his game will have only one type of pieces. Besides, all pieces in his game are of the same color. The possible moves of a piece are described by a set of shift vectors. The next passage contains a formal description of available moves.Let the rows of the board be numbered from top to bottom and the columns be numbered from left to right from 1 to n. Let\'s assign to each square a pair of integers (x,\xe2\x80\x89y) \xe2\x80\x94 the number of the corresponding column and row. Each of the possible moves of the piece is defined by a pair of integers (dx,\xe2\x80\x89dy); using this move, the piece moves from the field (x,\xe2\x80\x89y) to the field (x\xe2\x80\x89+\xe2\x80\x89dx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89dy). You can perform the move if the cell (x\xe2\x80\x89+\xe2\x80\x89dx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89dy) is within the boundaries of the board and doesn\'t contain another piece. Pieces that stand on the cells other than (x,\xe2\x80\x89y) and (x\xe2\x80\x89+\xe2\x80\x89dx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89dy) are not important when considering the possibility of making the given move (for example, like when a knight moves in usual chess).Igor offers you to find out what moves his chess piece can make. He placed several pieces on the board and for each unoccupied square he told you whether it is attacked by any present piece (i.e. whether some of the pieces on the field can move to that cell). Restore a possible set of shift vectors of the piece, or else determine that Igor has made a mistake and such situation is impossible for any set of shift vectors." 1800.0                            
                    536E "Tavas on the Path" "data structures,divide and conquer,trees" "Tavas lives in Tavaspolis. Tavaspolis has n cities numbered from 1 to n connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. There exists a path between any two cities. Also each road has a length.  Tavas\' favorite strings are binary strings (they contain only 0 and 1). For any binary string like s\xe2\x80\x89=\xe2\x80\x89s1s2... sk, T(s) is its Goodness. T(s) can be calculated as follows:Consider there are exactly m blocks of 1s in this string (a block of 1s in s is a maximal consecutive substring of s that only contains 1) with lengths x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xm.Define  where f is a given sequence (if m\xe2\x80\x89=\xe2\x80\x890, then T(s)\xe2\x80\x89=\xe2\x80\x890).Tavas loves queries. He asks you to answer q queries. In each query he gives you numbers v,\xe2\x80\x89u,\xe2\x80\x89l and you should print following number:Consider the roads on the path from city v to city u: e1,\xe2\x80\x89e2,\xe2\x80\x89...,\xe2\x80\x89ex.Build the binary string b of length x such that: bi\xe2\x80\x89=\xe2\x80\x891 if and only if l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w(ei) where w(e) is the length of road e.You should print T(b) for this query." 3100.0                            
                    534E "Berland Local Positioning System" "constructive algorithms,greedy,hashing,implementation" "In Berland a bus travels along the main street of the capital. The street begins from the main square and looks like a very long segment. There are n bus stops located along the street, the i-th of them is located at the distance ai from the central square, all distances are distinct, the stops are numbered in the order of increasing distance from the square, that is, ai\xe2\x80\x89<\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891. The bus starts its journey from the first stop, it passes stops 2, 3 and so on. It reaches the stop number n, turns around and goes in the opposite direction to stop 1, passing all the intermediate stops in the reverse order. After that, it again starts to move towards stop n. During the day, the bus runs non-stop on this route.The bus is equipped with the Berland local positioning system. When the bus passes a stop, the system notes down its number.One of the key features of the system is that it can respond to the queries about the distance covered by the bus for the parts of its path between some pair of stops. A special module of the system takes the input with the information about a set of stops on a segment of the path, a stop number occurs in the set as many times as the bus drove past it. This module returns the length of the traveled segment of the path (or -1 if it is impossible to determine the length uniquely). The operation of the module is complicated by the fact that stop numbers occur in the request not in the order they were visited but in the non-decreasing order.For example, if the number of stops is 6, and the part of the bus path starts at the bus stop number 5, ends at the stop number 3 and passes the stops as follows: , then the request about this segment of the path will have form: 3,\xe2\x80\x894,\xe2\x80\x895,\xe2\x80\x895,\xe2\x80\x896. If the bus on the segment of the path from stop 5 to stop 3 has time to drive past the 1-th stop (i.e., if we consider a segment that ends with the second visit to stop 3 on the way from 5), then the request will have form: 1,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895,\xe2\x80\x895,\xe2\x80\x896.You will have to repeat the Berland programmers achievement and implement this function." 2400.0                            
                    534D Handshakes "binary search,constructive algorithms,data structures,greedy" "On February, 30th n students came in the Center for Training Olympiad Programmers (CTOP) of the Berland State University. They came one by one, one after another. Each of them went in, and before sitting down at his desk, greeted with those who were present in the room by shaking hands. Each of the students who came in stayed in CTOP until the end of the day and never left.At any time any three students could join together and start participating in a team contest, which lasted until the end of the day. The team did not distract from the contest for a minute, so when another student came in and greeted those who were present, he did not shake hands with the members of the contest writing team. Each team consisted of exactly three students, and each student could not become a member of more than one team. Different teams could start writing contest at different times.Given how many present people shook the hands of each student, get a possible order in which the students could have come to CTOP. If such an order does not exist, then print that this is impossible.Please note that some students could work independently until the end of the day, without participating in a team contest." 1900.0                            
                    533E "Correcting Mistakes" "constructive algorithms,dp,greedy,hashing,strings,two pointers" "Analyzing the mistakes people make while typing search queries is a complex and an interesting work. As there is no guaranteed way to determine what the user originally meant by typing some query, we have to use different sorts of heuristics.Polycarp needed to write a code that could, given two words, check whether they could have been obtained from the same word as a result of typos. Polycarpus suggested that the most common typo is skipping exactly one letter as you type a word.Implement a program that can, given two distinct words S and T of the same length n determine how many words W of length n\xe2\x80\x89+\xe2\x80\x891 are there with such property that you can transform W into both S, and T by deleting exactly one character. Words S and T consist of lowercase English letters. Word W also should consist of lowercase English letters." 1800.0                            
                    530I "Different variables" "*special problem" "N variables X1,\xe2\x80\x89...,\xe2\x80\x89XN can have positive integer values. You are given K constraints for these value that look like ""the values of variables Xi1,\xe2\x80\x89Xi2,\xe2\x80\x89...,\xe2\x80\x89XiM are different"". Among all possible lists of values of these variables that satisfy these constraints select the ones which have minimum possible max(Xi). Output lexicographically least of these lists." 2500.0                            
                    530E "Sum and product" "*special problem" "You are given integers N and D. Find N positive integers x1...xN such that the difference of their product and their sum equals D." 1700.0                            
                    527A "Playing with Paper" implementation,math "One day Vasya was sitting on a not so interesting Maths lesson and making an origami from a rectangular a mm \xe2\x80\x89\xc3\x97\xe2\x80\x89 b mm sheet of paper (a\xe2\x80\x89>\xe2\x80\x89b). Usually the first step in making an origami is making a square piece of paper from the rectangular sheet by folding the sheet along the bisector of the right angle, and cutting the excess part.  After making a paper ship from the square piece, Vasya looked on the remaining (a\xe2\x80\x89-\xe2\x80\x89b) mm \xe2\x80\x89\xc3\x97\xe2\x80\x89 b mm strip of paper. He got the idea to use this strip of paper in the same way to make an origami, and then use the remainder (if it exists) and so on. At the moment when he is left with a square piece of paper, he will make the last ship from it and stop.Can you determine how many ships Vasya will make during the lesson?" 1100.0                            
                    526G "Spiders Evil Plan" greedy,trees "Spiders are Om Nom\'s old enemies. They love eating candies as much as he does and that\'s why they keep trying to keep the monster away from his favorite candies. They came up with an evil plan to trap Om Nom.  Let\'s consider a rope structure consisting of n nodes and n\xe2\x80\x89-\xe2\x80\x891 ropes connecting the nodes. The structure is connected, thus, the ropes and the nodes form a tree. Each rope of the formed structure is associated with its length. A candy is tied to node x of the structure. Om Nom really wants to eat this candy.The y spiders are trying to stop him from doing it. They decided to entangle the candy and some part of the structure into a web, thus attaching the candy to as large as possible part of the rope structure. Each spider can use his web to cover all ropes on the path between two arbitrary nodes a and b. Thus, y spiders can cover the set of ropes which is a union of y paths in the given tree. These y paths can arbitrarily intersect each other. The spiders want the following conditions to be hold:  the node containing the candy is adjacent to at least one rope covered with a web  the ropes covered with the web form a connected structure (what\'s the idea of covering with a web the ropes that are not connected with the candy?)  the total length of the ropes covered with web is as large as possible The spiders haven\'t yet decided to what node of the structure they will tie the candy and how many spiders will cover the structure with web, so they asked you to help them. Help them calculate the optimal plan for multiple values of x and y." 3300.0                            
                    526D "Om Nom and Necklace" "hashing,string suffix structures,strings" "One day Om Nom found a thread with n beads of different colors. He decided to cut the first several beads from this thread to make a bead necklace and present it to his girlfriend Om Nelly.  Om Nom knows that his girlfriend loves beautiful patterns. That\'s why he wants the beads on the necklace to form a regular pattern. A sequence of beads S is regular if it can be represented as S\xe2\x80\x89=\xe2\x80\x89A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89+\xe2\x80\x89A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89+\xe2\x80\x89A\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89+\xe2\x80\x89A, where A and B are some bead sequences, ""\xe2\x80\x89+\xe2\x80\x89"" is the concatenation of sequences, there are exactly 2k\xe2\x80\x89+\xe2\x80\x891 summands in this sum, among which there are k\xe2\x80\x89+\xe2\x80\x891 ""A"" summands and k ""B"" summands that follow in alternating order. Om Nelly knows that her friend is an eager mathematician, so she doesn\'t mind if A or B is an empty sequence.Help Om Nom determine in which ways he can cut off the first several beads from the found thread (at least one; probably, all) so that they form a regular pattern. When Om Nom cuts off the beads, he doesn\'t change their order." 2200.0                            
                    524D "Social Network" "greedy,two pointers" "Polycarpus got an internship in one well-known social network. His test task is to count the number of unique users who have visited a social network during the day. Polycarpus was provided with information on all user requests for this time period. For each query, we know its time... and nothing else, because Polycarpus has already accidentally removed the user IDs corresponding to the requests from the database. Thus, it is now impossible to determine whether any two requests are made by the same person or by different people.But wait, something is still known, because that day a record was achieved \xe2\x80\x94 M simultaneous users online! In addition, Polycarpus believes that if a user made a request at second s, then he was online for T seconds after that, that is, at seconds s, s\xe2\x80\x89+\xe2\x80\x891, s\xe2\x80\x89+\xe2\x80\x892, ..., s\xe2\x80\x89+\xe2\x80\x89T\xe2\x80\x89-\xe2\x80\x891. So, the user\'s time online can be calculated as the union of time intervals of the form [s,\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89T\xe2\x80\x89-\xe2\x80\x891] over all times s of requests from him.Guided by these thoughts, Polycarpus wants to assign a user ID to each request so that:  the number of different users online did not exceed M at any moment,  at some second the number of distinct users online reached value M,  the total number of users (the number of distinct identifiers) was as much as possible. Help Polycarpus cope with the test." 2100.0                            
                    522C "Chicken or Fish?" greedy "Polycarp is flying in the airplane. Finally, it is his favorite time \xe2\x80\x94 the lunchtime. The BerAvia company stewardess is giving food consecutively to all the passengers from the 1-th one to the last one. Polycarp is sitting on seat m, that means, he will be the m-th person to get food.The flight menu has k dishes in total and when Polycarp boarded the flight, he had time to count the number of portions of each dish on board. Thus, he knows values a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak, where ai is the number of portions of the i-th dish.The stewardess has already given food to m\xe2\x80\x89-\xe2\x80\x891 passengers, gave Polycarp a polite smile and asked him what he would prefer. That\'s when Polycarp realized that they might have run out of some dishes by that moment. For some of the m\xe2\x80\x89-\xe2\x80\x891 passengers ahead of him, he noticed what dishes they were given. Besides, he\'s heard some strange mumbling from some of the m\xe2\x80\x89-\xe2\x80\x891 passengers ahead of him, similar to phrase \'I\'m disappointed\'. That happened when a passenger asked for some dish but the stewardess gave him a polite smile and said that they had run out of that dish. In that case the passenger needed to choose some other dish that was available. If Polycarp heard no more sounds from a passenger, that meant that the passenger chose his dish at the first try.Help Polycarp to find out for each dish: whether they could have run out of the dish by the moment Polyarp was served or that dish was definitely available." 2100.0                            
                    521E "Cycling City" "dfs and similar,graphs" "You are organizing a cycling race on the streets of the city. The city contains n junctions, some pairs of them are connected by roads; on each road you can move in any direction. No two roads connect the same pair of intersections, and no road connects the intersection with itself.You want the race to be open to both professional athletes and beginner cyclists, and that\'s why you will organize the race in three nominations: easy, moderate and difficult; each participant will choose the more suitable nomination. For each nomination you must choose the route \xe2\x80\x94 the chain of junctions, consecutively connected by roads. Routes must meet the following conditions: all three routes should start at the same intersection, and finish at the same intersection (place of start and finish can\'t be the same); to avoid collisions, no two routes can have common junctions (except for the common start and finish), and can not go along the same road (irrespective of the driving direction on the road for those two routes); no route must pass twice through the same intersection or visit the same road twice (irrespective of the driving direction on the road for the first and second time of visit).Preparing for the competition is about to begin, and you need to determine the routes of the race as quickly as possible. The length of the routes is not important, it is only important that all the given requirements were met." 3100.0                            
                    519E "A and B and Lecture Rooms" "binary search,data structures,dfs and similar,dp,trees" "A and B are preparing themselves for programming contests.The University where A and B study is a set of rooms connected by corridors. Overall, the University has n rooms connected by n\xe2\x80\x89-\xe2\x80\x891 corridors so that you can get from any room to any other one by moving along the corridors. The rooms are numbered from 1 to n.Every day \xd0\x90 and B write contests in some rooms of their university, and after each contest they gather together in the same room and discuss problems. A and B want the distance from the rooms where problems are discussed to the rooms where contests are written to be equal. The distance between two rooms is the number of edges on the shortest path between them.As they write contests in new rooms every day, they asked you to help them find the number of possible rooms to discuss problems for each of the following m days." 2100.0                            
                    518A "Vitaly and Strings" "constructive algorithms,strings" "Vitaly is a diligent student who never missed a lesson in his five years of studying in the university. He always does his homework on time and passes his exams in time. During the last lesson the teacher has provided two strings s and t to Vitaly. The strings have the same length, they consist of lowercase English letters, string s is lexicographically smaller than string t. Vitaly wondered if there is such string that is lexicographically larger than string s and at the same is lexicographically smaller than string t. This string should also consist of lowercase English letters and have the length equal to the lengths of strings s and t. Let\'s help Vitaly solve this easy problem!" 1600.0                            
                    515E "Drazil and Park" "data structures" "Drazil is a monkey. He lives in a circular park. There are n trees around the park. The distance between the i-th tree and (i\xe2\x80\x89+\xe2\x80\x891)-st trees is di, the distance between the n-th tree and the first tree is dn. The height of the i-th tree is hi.Drazil starts each day with the morning run. The morning run consists of the following steps:  Drazil chooses two different trees  He starts with climbing up the first tree  Then he climbs down the first tree, runs around the park (in one of two possible directions) to the second tree, and climbs on it  Then he finally climbs down the second tree. But there are always children playing around some consecutive trees. Drazil can\'t stand children, so he can\'t choose the trees close to children. He even can\'t stay close to those trees.If the two trees Drazil chooses are x-th and y-th, we can estimate the energy the morning run takes to him as 2(hx\xe2\x80\x89+\xe2\x80\x89hy)\xe2\x80\x89+\xe2\x80\x89dist(x,\xe2\x80\x89y). Since there are children on exactly one of two arcs connecting x and y, the distance dist(x,\xe2\x80\x89y) between trees x and y is uniquely defined.Now, you know that on the i-th day children play between ai-th tree and bi-th tree. More formally, if ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi, children play around the trees with indices from range [ai,\xe2\x80\x89bi], otherwise they play around the trees with indices from .Please help Drazil to determine which two trees he should choose in order to consume the most energy (since he wants to become fit and cool-looking monkey) and report the resulting amount of energy for each day." 2300.0                            
                    514D "R2D2 and Droid Army" "binary search,data structures,two pointers" "An army of n droids is lined up in one row. Each droid is described by m integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am, where ai is the number of details of the i-th type in this droid\'s mechanism. R2-D2 wants to destroy the sequence of consecutive droids of maximum length. He has m weapons, the i-th weapon can affect all the droids in the army by destroying one detail of the i-th type (if the droid doesn\'t have details of this type, nothing happens to it). A droid is considered to be destroyed when all of its details are destroyed. R2-D2 can make at most k shots. How many shots from the weapon of what type should R2-D2 make to destroy the sequence of consecutive droids of maximum length?" 2000.0                            
                    513G3 "Inversions problem" dp "You are given a permutation of n numbers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. We perform k operations of the following type: choose uniformly at random two indices l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) and reverse the order of the elements pl,\xe2\x80\x89pl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89pr. Your task is to find the expected value of the number of inversions in the resulting permutation." 3100.0                            
                    513F2 Scaygerboss flows "Cthulhu decided to catch Scaygerboss. Scaygerboss found it out and is trying to hide in a pack of his scaygers. Each scayger except Scaygerboss is either a male or a female. Scaygerboss\'s gender is ""other"".Scaygers are scattered on a two-dimensional map divided into cells. A scayger looks nerdy and loveable if it is staying in the same cell with exactly one scayger of a gender that is different from its own gender. Cthulhu will not be able to catch Scaygerboss if all the scaygers on the map look nerdy and loveable.The scaygers can move around at different speeds. For each scayger, we are given the time it takes this scayger to move from a cell to an adjacent cell. Cells are adjacent if they share a common side. At any point of time, each cell that does not contain an obstacle can be occupied by an arbitrary number of scaygers. Scaygers cannot move to cells with obstacles.Calculate minimal time in order to make all scaygers look nerdy and loveable if they move optimally toward this goal." 2800.0                            
                    513D1 "Constrained Tree" "dfs and similar" "You need to find a binary tree of size n that satisfies a given set of c constraints. Suppose that the nodes of the unknown binary tree are labeled using a pre-order traversal starting with 1. For the i-th constraint you are given two labels, ai and bi and a direction, left or right. In case of left direction, bi is an element of the subtree rooted at ai\'s left child. Similarly in the case of right direction bi is an element of the subtree rooted at ai\'s right child." 2400.0                            
                    513A Game "constructive algorithms,math" "Two players play a simple game. Each player is provided with a box with balls. First player\'s box contains exactly n1 balls and second player\'s box contains exactly n2 balls. In one move first player can take from 1 to k1 balls from his box and throw them away. Similarly, the second player can take from 1 to k2 balls from his box in his move. Players alternate turns and the first player starts the game. The one who can\'t make a move loses. Your task is to determine who wins if both players play optimally." 800.0                            
                    510A "Fox And Snake" implementation "Fox Ciel starts to learn programming. The first task is drawing a fox! However, that turns out to be too hard for a beginner, so she decides to draw a snake instead.A snake is a pattern on a n by m table. Denote c-th cell of r-th row as (r,\xe2\x80\x89c). The tail of the snake is located at (1,\xe2\x80\x891), then it\'s body extends to (1,\xe2\x80\x89m), then goes down 2 rows to (3,\xe2\x80\x89m), then goes left to (3,\xe2\x80\x891) and so on.Your task is to draw this snake for Fox Ciel: the empty cells should be represented as dot characters (\'.\') and the snake cells should be filled with number signs (\'#\').Consider sample tests in order to understand the snake pattern." 800.0                            
                    509E "Pretty Song" math,strings "When Sasha was studying in the seventh grade, he started listening to music a lot. In order to evaluate which songs he likes more, he introduced the notion of the song\'s prettiness. The title of the song is a word consisting of uppercase Latin letters. The prettiness of the song is the prettiness of its title.Let\'s define the simple prettiness of a word as the ratio of the number of vowels in the word to the number of all letters in the word.Let\'s define the prettiness of a word as the sum of simple prettiness of all the substrings of the word.More formally, let\'s define the function vowel(c) which is equal to 1, if c is a vowel, and to 0 otherwise. Let si be the i-th character of string s, and si..j be the substring of word s, staring at the i-th character and ending at the j-th character (sisi\xe2\x80\x89+\xe2\x80\x891... sj, i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j).Then the simple prettiness of s is defined by the formula:The prettiness of s equals Find the prettiness of the given song title.We assume that the vowels are I,\xe2\x80\x89E,\xe2\x80\x89A,\xe2\x80\x89O,\xe2\x80\x89U,\xe2\x80\x89Y." 2000.0                            
                    509B "Painting Pebbles" "constructive algorithms,greedy,implementation" "There are n piles of pebbles on the table, the i-th pile contains ai pebbles. Your task is to paint each pebble using one of the k given colors so that for each color c and any two piles i and j the difference between the number of pebbles of color c in pile i and number of pebbles of color c in pile j is at most one.In other words, let\'s say that bi,\xe2\x80\x89c is the number of pebbles of color c in the i-th pile. Then for any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n the following condition must be satisfied |bi,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x89bj,\xe2\x80\x89c|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891. It isn\'t necessary to use all k colors: if color c hasn\'t been used in pile i, then bi,\xe2\x80\x89c is considered to be zero." 1300.0                            
                    499A "Watching a movie" greedy,implementation "You have decided to watch the best moments of some movie. There are two buttons on your player:   Watch the current minute of the movie. By pressing this button, you watch the current minute of the movie and the player automatically proceeds to the next minute of the movie.  Skip exactly x minutes of the movie (x is some fixed positive integer). If the player is now at the t-th minute of the movie, then as a result of pressing this button, it proceeds to the minute (t\xe2\x80\x89+\xe2\x80\x89x). Initially the movie is turned on in the player on the first minute, and you want to watch exactly n best moments of the movie, the i-th best moment starts at the li-th minute and ends at the ri-th minute (more formally, the i-th best moment consists of minutes: li,\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ri). Determine, what is the minimum number of minutes of the movie you have to watch if you want to watch all the best moments?" 1000.0                            
                    496C "Removing Columns" "brute force,constructive algorithms,implementation" "You are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular table consisting of lower case English letters. In one operation you can completely remove one column from the table. The remaining parts are combined forming a new table. For example, after removing the second column from the tableabcdedfghijk we obtain the table:acdefghjk A table is called good if its rows are ordered from top to bottom lexicographically, i.e. each row is lexicographically no larger than the following one. Determine the minimum number of operations of removing a column needed to make a given table good." 1500.0                            
                    493E "Vasya and Polynomial" math "Vasya is studying in the last class of school and soon he will take exams. He decided to study polynomials. Polynomial is a function P(x)\xe2\x80\x89=\xe2\x80\x89a0\xe2\x80\x89+\xe2\x80\x89a1x1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89anxn. Numbers ai are called coefficients of a polynomial, non-negative integer n is called a degree of a polynomial.Vasya has made a bet with his friends that he can solve any problem with polynomials. They suggested him the problem: ""Determine how many polynomials P(x) exist with integer non-negative coefficients so that , and , where  and b are given positive integers""? Vasya does not like losing bets, but he has no idea how to solve this task, so please help him to solve the problem." 2800.0                            
                    492A "Vanya and Cubes" implementation "Vanya got n cubes. He decided to build a pyramid from them. Vanya wants to build the pyramid as follows: the top level of the pyramid must consist of 1 cube, the second level must consist of 1\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x893 cubes, the third level must have 1\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x896 cubes, and so on. Thus, the i-th level of the pyramid must have 1\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89(i\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89i cubes.Vanya wants to know what is the maximum height of the pyramid that he can make using the given cubes." 800.0                            
                    490E "Restoring Increasing Sequence" "binary search,brute force,greedy,implementation" "Peter wrote on the board a strictly increasing sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Then Vasil replaced some digits in the numbers of this sequence by question marks. Thus, each question mark corresponds to exactly one lost digit.Restore the the original sequence knowing digits remaining on the board." 2000.0                            
                    487E Tourists "data structures,dfs and similar,graphs,trees" "There are n cities in Cyberland, numbered from 1 to n, connected by m bidirectional roads. The j-th road connects city aj and bj.For tourists, souvenirs are sold in every city of Cyberland. In particular, city i sell it at a price of wi.Now there are q queries for you to handle. There are two types of queries: ""C a w"": The price in city a is changed to w. ""A a b"": Now a tourist will travel from city a to b. He will choose a route, he also doesn\'t want to visit a city twice. He will buy souvenirs at the city where the souvenirs are the cheapest (possibly exactly at city a or b). You should output the minimum possible price that he can buy the souvenirs during his travel.More formally, we can define routes as follow: A route is a sequence of cities [x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk], where k is a certain positive integer. For any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k,\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89xj. For any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k, there is a road connecting xi and xi\xe2\x80\x89+\xe2\x80\x891. The minimum price of the route is min(wx1,\xe2\x80\x89wx2,\xe2\x80\x89...,\xe2\x80\x89wxk). The required answer is the minimum value of the minimum prices of all valid routes from a to b." 3200.0                            
                    487C "Prefix Product Sequence" "constructive algorithms,math,number theory" "Consider a sequence [a1,\xe2\x80\x89a2,\xe2\x80\x89... ,\xe2\x80\x89an]. Define its prefix product sequence .Now given n, find a permutation of [1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n], such that its prefix product sequence is a permutation of [0,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891]." 2300.0                            
                    486C "Palindrome Transformation" "brute force,greedy,implementation" "Nam is playing with a string on his computer. The string consists of n lowercase English letters. It is meaningless, so Nam decided to make the string more beautiful, that is to make it be a palindrome by using 4 arrow keys: left, right, up, down.There is a cursor pointing at some symbol of the string. Suppose that cursor is at position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, the string uses 1-based indexing) now. Left and right arrow keys are used to move cursor around the string. The string is cyclic, that means that when Nam presses left arrow key, the cursor will move to position i\xe2\x80\x89-\xe2\x80\x891 if i\xe2\x80\x89>\xe2\x80\x891 or to the end of the string (i. e. position n) otherwise. The same holds when he presses the right arrow key (if i\xe2\x80\x89=\xe2\x80\x89n, the cursor appears at the beginning of the string).When Nam presses up arrow key, the letter which the text cursor is pointing to will change to the next letter in English alphabet (assuming that alphabet is also cyclic, i. e. after \'z\' follows \'a\'). The same holds when he presses the down arrow key.Initially, the text cursor is at position p. Because Nam has a lot homework to do, he wants to complete this as fast as possible. Can you help him by calculating the minimum number of arrow keys presses to make the string to be a palindrome?" 1700.0                            
                    476D "Dreamoon and Sets" "constructive algorithms,greedy,math" "Dreamoon likes to play with sets, integers and .  is defined as the largest positive integer that divides both a and b.Let S be a set of exactly four distinct integers greater than 0. Define S to be of rank k if and only if for all pairs of distinct elements si, sj from S, .Given k and n, Dreamoon wants to make up n sets of rank k using integers from 1 to m such that no integer is used in two different sets (of course you can leave some integers without use). Calculate the minimum m that makes it possible and print one possible solution." 1900.0                            
                    475F Meta-universe "data structures" "Consider infinite grid of unit cells. Some of those cells are planets. Meta-universe M\xe2\x80\x89=\xe2\x80\x89{p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk} is a set of planets. Suppose there is an infinite row or column with following two properties: 1) it doesn\'t contain any planet pi of meta-universe M on it; 2) there are planets of M located on both sides from this row or column. In this case we can turn the meta-universe M into two non-empty meta-universes M1 and M2 containing planets that are located on respective sides of this row or column. A meta-universe which can\'t be split using operation above is called a universe. We perform such operations until all meta-universes turn to universes.Given positions of the planets in the original meta-universe, find the number of universes that are result of described process. It can be proved that each universe is uniquely identified not depending from order of splitting." 2900.0                            
                    474C "Captain Marmot" "brute force,geometry" "Captain Marmot wants to prepare a huge and important battle against his enemy, Captain Snake. For this battle he has n regiments, each consisting of 4 moles.Initially, each mole i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894n) is placed at some position (xi,\xe2\x80\x89yi) in the Cartesian plane. Captain Marmot wants to move some moles to make the regiments compact, if it\'s possible.Each mole i has a home placed at the position (ai,\xe2\x80\x89bi). Moving this mole one time means rotating his position point (xi,\xe2\x80\x89yi) 90 degrees counter-clockwise around it\'s home point (ai,\xe2\x80\x89bi).A regiment is compact only if the position points of the 4 moles form a square with non-zero area.Help Captain Marmot to find out for each regiment the minimal number of moves required to make that regiment compact, if it\'s possible." 2000.0                            
                    472C "Design Tutorial: Make It Nondeterministic" greedy "A way to make a new task is to make it nondeterministic or probabilistic. For example, the hard task of Topcoder SRM 595, Constellation, is the probabilistic version of a convex hull.Let\'s try to make a new task. Firstly we will use the following task. There are n people, sort them by their name. It is just an ordinary sorting problem, but we can make it more interesting by adding nondeterministic element. There are n people, each person will use either his/her first name or last name as a handle. Can the lexicographical order of the handles be exactly equal to the given permutation p?More formally, if we denote the handle of the i-th person as hi, then the following condition must hold: ." 1400.0                            
                    470H "Array Sorting" "*special problem" "Sorting arrays is traditionally associated with high-level languages. How hard can it be in FALSE? Sort the given array in non-descending order." 2300.0                            
                    470F "Pairwise Sums" "*special problem" "You are given an array of n integers. For each element output the sum of itself and the previous element. For the first element, output the sum of the first and the last elements of the array." 2300.0                            
                    470C Eval "*special problem" "You are given a simple arithmetic expression of the form a?b, where a and b are integer constants, and ? can be one of the following operations: \'+\' (addition), \'-\' (subtraction), \'*\' (multiplication), \'/\' (integer division) or \'%\' (modulo operation).Output the result of evaluation of this expression." 1900.0                            
                    466B "Wonder Room" "brute force,math" "The start of the new academic year brought about the problem of accommodation students into dormitories. One of such dormitories has a a\xe2\x80\x89\xc3\x97\xe2\x80\x89b square meter wonder room. The caretaker wants to accommodate exactly n students there. But the law says that there must be at least 6 square meters per student in a room (that is, the room for n students must have the area of at least 6n square meters). The caretaker can enlarge any (possibly both) side of the room by an arbitrary positive integer of meters. Help him change the room so as all n students could live in it and the total area of the room was as small as possible." 2000.0                            
                    464E "The Classic Problem" "data structures,graphs,shortest paths" "You are given a weighted undirected graph on n vertices and m edges. Find the shortest path from vertex s to vertex t or else state that such path doesn\'t exist." 3000.0                            
                    464C "Substitutes in Number" dp "Andrew and Eugene are playing a game. Initially, Andrew has string s, consisting of digits. Eugene sends Andrew multiple queries of type ""di\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89ti"", that means ""replace all digits di in string s with substrings equal to ti"". For example, if s\xe2\x80\x89=\xe2\x80\x89123123, then query ""2\xe2\x80\x89\xe2\x86\x92\xe2\x80\x8900"" transforms s to 10031003, and query ""3\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89"" (""replace 3 by an empty string"") transforms it to s\xe2\x80\x89=\xe2\x80\x891212. After all the queries Eugene asks Andrew to find the remainder after division of number with decimal representation equal to s by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). When you represent s as a decimal number, please ignore the leading zeroes; also if s is an empty string, then it\'s assumed that the number equals to zero.Andrew got tired of processing Eugene\'s requests manually and he asked you to write a program for that. Help him!" 2100.0                            
                    457F "An easy problem about trees" dp,games,greedy,trees "Pieguy and Piegirl are playing a game. They have a rooted binary tree, that has a property that each node is either a leaf or has exactly two children. Each leaf has a number associated with it.On his/her turn a player can choose any two leafs that share their immediate parent, remove them, and associate either of their values with their parent, that now became a leaf (the player decides which of the two values to associate). The game ends when only one node (the one that was the root of the tree) is left.Pieguy goes first, and his goal is to maximize the value that will be associated with the root when the game ends. Piegirl wants to minimize that value. Assuming that both players are playing optimally, what number will be associated with the root when the game ends?" 3200.0                            
                    457E "Flow Optimality" "constructive algorithms,flows,math" "There is a computer network consisting of n nodes numbered 1 through n. There are links in the network that connect pairs of nodes. A pair of nodes may have multiple links between them, but no node has a link to itself.Each link supports unlimited bandwidth (in either direction), however a link may only transmit in a single direction at any given time. The cost of sending data across a link is proportional to the square of the bandwidth. Specifically, each link has a positive weight, and the cost of sending data across the link is the weight times the square of the bandwidth.The network is connected (there is a series of links from any node to any other node), and furthermore designed to remain connected in the event of any single node failure.You needed to send data from node 1 to node n at a bandwidth of some positive number k. That is, you wish to assign a bandwidth to each link so that the bandwidth into a node minus the bandwidth out of a node is \xe2\x80\x89-\xe2\x80\x89k for node 1, k for node n, and 0 for all other nodes. The individual bandwidths do not need to be integers.Wishing to minimize the total cost, you drew a diagram of the network, then gave the task to an intern to solve. The intern claimed to have solved the task and written the optimal bandwidths on your diagram, but then spilled coffee on it, rendering much of it unreadable (including parts of the original diagram, and the value of k).From the information available, determine if the intern\'s solution may have been optimal. That is, determine if there exists a valid network, total bandwidth, and optimal solution which is a superset of the given information. Furthermore, determine the efficiency of the intern\'s solution (if possible), where efficiency is defined as total cost divided by total bandwidth." 3000.0                            
                    454A "Little Pony and Crystal Mine" implementation "Twilight Sparkle once got a crystal from the Crystal Mine. A crystal of size n (n is odd; n\xe2\x80\x89>\xe2\x80\x891) is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix with a diamond inscribed into it.You are given an odd integer n. You need to draw a crystal of size n. The diamond cells of the matrix should be represented by character ""D"". All other cells of the matrix should be represented by character ""*"". Look at the examples to understand what you need to draw." 800.0                            
                    453C "Little Pony and Summer Sun Celebration" "constructive algorithms,dfs and similar,graphs" "Twilight Sparkle learnt that the evil Nightmare Moon would return during the upcoming Summer Sun Celebration after one thousand years of imprisonment on the moon. She tried to warn her mentor Princess Celestia, but the princess ignored her and sent her to Ponyville to check on the preparations for the celebration.  Twilight Sparkle wanted to track the path of Nightmare Moon. Unfortunately, she didn\'t know the exact path. What she knew is the parity of the number of times that each place Nightmare Moon visited. Can you help Twilight Sparkle to restore any path that is consistent with this information?Ponyville can be represented as an undirected graph (vertices are places, edges are roads between places) without self-loops and multi-edges. The path can start and end at any place (also it can be empty). Each place can be visited multiple times. The path must not visit more than 4n places." 2200.0                            
                    453B "Little Pony and Harmony Chest" "bitmasks,brute force,dp" "Princess Twilight went to Celestia and Luna\'s old castle to research the chest from the Elements of Harmony.  A sequence of positive integers bi is harmony if and only if for every two elements of the sequence their greatest common divisor equals 1. According to an ancient book, the key of the chest is a harmony sequence bi which minimizes the following expression:You are given sequence ai, help Princess Twilight to find the key." 2000.0                            
                         1873E "Building an Aquarium" "binary search,sortings" "You love fish, that\'s why you have decided to build an aquarium. You have a piece of coral made of nn columns, the ii-th of which is aiai units tall. Afterwards, you will build a tank around the coral as follows:   Pick an integer h\xe2\x89\xa51h\xe2\x89\xa51 \xe2\x80\x94 the height of the tank. Build walls of height hh on either side of the tank.  Then, fill the tank up with water so that the height of each column is hh, unless the coral is taller than hh; then no water should be added to this column.  For example, with a=[3,1,2,4,6,2,5]a=[3,1,2,4,6,2,5] and a height of h=4h=4, you will end up using a total of w=8w=8 units of water, as shown.    You can use at most xx units of water to fill up the tank, but you want to build the biggest tank possible. What is the largest value of hh you can select?" 1100.0                       
                         1873C "Target Practice" implementation,math "A 10\xc3\x9710 target is made out of five ""rings"" as shown. Each ring has a different point value: the outermost ring \xe2\x80\x94 1 point, the next ring \xe2\x80\x94 2 points, ..., the center ring \xe2\x80\x94 5 points.  Vlad fired several arrows at the target. Help him determine how many points he got." 800.0                       
                         1870B "Friendly Arrays" bitmasks,greedy,math "You are given two arrays of integers \xe2\x80\x94 a1,\xe2\x80\xa6,an of length n, and b1,\xe2\x80\xa6,bm of length m. You can choose any element bj from array b (1\xe2\x89\xa4j\xe2\x89\xa4m), and for all 1\xe2\x89\xa4i\xe2\x89\xa4n perform ai=ai|bj. You can perform any number of such operations.After all the operations, the value of x=a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an will be calculated. Find the minimum and maximum values of x that could be obtained after performing any set of operations.Above, | is the bitwise OR operation, and \xe2\x8a\x95 is the bitwise XOR operation." 1200.0                       
                         1868B1 "Candy Party (Easy Version)" "bitmasks,constructive algorithms,graphs,greedy,implementation,math" "This is the easy version of the problem. The only difference is that in this version everyone must give candies to exactly one person and receive candies from exactly one person. Note that a submission cannot pass both versions of the problem at the same time. You can make hacks only if both versions of the problem are solved.After Zhongkao examination, Daniel and his friends are going to have a party. Everyone will come with some candies.There will be n people at the party. Initially, the i-th person has ai candies. During the party, they will swap their candies. To do this, they will line up in an arbitrary order and everyone will do the following exactly once:  Choose an integer p (1\xe2\x89\xa4p\xe2\x89\xa4n) and a non-negative integer x, then give his 2x candies to the p-th person. Note that one cannot give more candies than currently he has (he might receive candies from someone else before) and he cannot give candies to himself. Daniel likes fairness, so he will be happy if and only if everyone receives candies from exactly one person. Meanwhile, his friend Tom likes average, so he will be happy if and only if all the people have the same number of candies after all swaps.Determine whether there exists a way to swap candies, so that both Daniel and Tom will be happy after the swaps." 1700.0                       
                         1867D "Cyclic Operations" "brute force,constructive algorithms,dfs and similar,graphs,greedy,implementation" "Egor has an array a of length n, initially consisting of zeros. However, he wanted to turn it into another array b of length n.Since Egor doesn\'t take easy paths, only the following operation can be used (possibly zero or several times):  choose an array l of length k (1\xe2\x89\xa4li\xe2\x89\xa4n, all li are distinct) and change each element ali to l(i%k)+1 (1\xe2\x89\xa4i\xe2\x89\xa4k). He became interested in whether it is possible to get the array b using only these operations. Since Egor is still a beginner programmer, he asked you to help him solve this problem.The operation % means taking the remainder, that is, a%b is equal to the remainder of dividing the number a by the number b." 1800.0                       
                         1866I "Imagination Castle" "dp,games,two pointers" "Given a chessboard of size N\xc3\x97M (N rows and M columns). Each row is numbered from 1 to N from top to bottom and each column is numbered from 1 to M from left to right. The tile in row r and column c is denoted as (r,c). There exists K distinct special tiles on the chessboard with the i-th special tile being tile (Xi,Yi). It is guaranteed that tile (1,1) is not a special tile.A new chess piece has been invented, which is the castle. The castle moves similarly to a rook in regular chess, but slightly differently. In one move, a castle that is on some tile can only move to another tile in the same row or in the same column, but only in the right direction or the down direction. Formally, in one move, the castle on tile (r,c) can only move to tile (r\xe2\x80\xb2,c\xe2\x80\xb2) if and only if one of the following two conditions is satisfied:   r\xe2\x80\xb2=r and c\xe2\x80\xb2>c.  c\xe2\x80\xb2=c and r\xe2\x80\xb2>r. Chaneka and Bhinneka will play a game. In the beginning of the game, there is a castle in tile (1,1). The two players will play alternatingly with Chaneka going first. In one turn, the player on that turn must move the castle following the movement rules of the castle.If a player moves the castle to a special tile on her turn, then that player wins the game and the game ends. If on a turn, the castle cannot be moved, the player on that turn loses and the game ends.Given the size of the board and the locations of each special tile. Determine the winner of this game if Chaneka and Bhinneka plays optimally." 2300.0                       
                         1866C "Completely Searching for Inversions" "dfs and similar,dp,graphs" "Pak Chanek has a directed acyclic graph (a directed graph that does not have any cycles) containing N vertices. Vertex i has Si edges directed away from that vertex. The j-th edge of vertex i that is directed away from it, is directed towards vertex Li,j and has an integer Wi,j (0\xe2\x89\xa4Wi,j\xe2\x89\xa41). Another information about the graph is that the graph is shaped in such a way such that each vertex can be reached from vertex 1 via zero or more directed edges.Pak Chanek has an array Z that is initially empty.Pak Chanek defines the function dfs as follows:// dfs from vertex ivoid dfs(int i) {    // iterate each edge of vertex i that is directed away from it    for(int j = 1; j <= S[i]; j++) {        Z.push_back(W[i][j]); // add the integer in the edge to the end of Z        dfs(L[i][j]); // recurse to the next vertex    }}Note that the function does not keep track of which vertices have been visited, so each vertex can be processed more than once.Let\'s say Pak Chanek does dfs(1) once. After that, Pak Chanek will get an array Z containing some elements 0 or 1. Define an inversion in array Z as a pair of indices (x,y) (x<y) such that Zx>Zy. How many different inversions in Z are there if Pak Chanek does dfs(1) once? Since the answer can be very big, output the answer modulo 998244353." 1900.0                       
                         1864H "Asterism Stream" dp,math,matrices "Bogocubic is playing a game with amenotiomoi. First, Bogocubic fixed an integer n, and then he gave amenotiomoi an integer x which is initially equal to 1.In one move amenotiomoi performs one of the following operations with the same probability:  increase x by 1;  multiply x by 2. Bogocubic wants to find the expected number of moves amenotiomoi has to do to make x greater than or equal to n. Help him find this number modulo 998244353.Formally, let M=998244353. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer y that 0\xe2\x89\xa4y<M and y\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 3200.0                       
                         1863F "Divide, XOR, and Conquer" bitmasks,dp,math "You are given an array of n integers a1,a2,\xe2\x80\xa6,an.In one operation you split the array into two parts: a non-empty prefix and a non-empty suffix. The value of each part is the bitwise XOR of all elements in it. Next, discard the part with the smaller value. If both parts have equal values, you can choose which one to discard. Replace the array with the remaining part.The operations are being performed until the length of the array becomes 1. For each i (1\xe2\x89\xa4i\xe2\x89\xa4n), determine whether it is possible to achieve the state when only the i-th element (with respect to the original numbering) remains.Formally, you have two numbers l and r, initially l=1 and r=n. The current state of the array is [al,al+1,\xe2\x80\xa6,ar].As long as l<r, you apply the following operation:   Choose an arbitrary k from the set {l,l+1,\xe2\x80\xa6,r\xe2\x88\x921}. Denote x=al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ak and y=ak+1\xe2\x8a\x95ak+2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar, where \xe2\x8a\x95 denotes the bitwise XOR operation.  If x<y, set l=k+1.  If x>y, set r=k.  If x=y, either set l=k+1, or set r=k. For each i (1\xe2\x89\xa4i\xe2\x89\xa4n), determine whether it is possible to achieve l=r=i." 2600.0                       
                         1863C "MEX Repetition" implementation,math "You are given an array a1,a2,\xe2\x80\xa6,an of pairwise distinct integers from 0 to n. Consider the following operation:  consecutively for each i from 1 to n in this order, replace ai with MEX(a1,a2,\xe2\x80\xa6,an). Here MEX of a collection of integers c1,c2,\xe2\x80\xa6,cm is defined as the smallest non-negative integer x which does not occur in the collection c. For example, MEX(0,2,2,1,4)=3 and MEX(1,2)=0.Print the array after applying k such operations." 1100.0                       
                         1862A "Gift Carpet" dp,greedy,implementation,strings "Recently, Tema and Vika celebrated Family Day. Their friend Arina gave them a carpet, which can be represented as an n\xe2\x8b\x85m table of lowercase Latin letters.Vika hasn\'t seen the gift yet, but Tema knows what kind of carpets she likes. Vika will like the carpet if she can read her name on. She reads column by column from left to right and chooses one or zero letters from current column.Formally, the girl will like the carpet if it is possible to select four distinct columns in order from left to right such that the first column contains ""v"", the second one contains ""i"", the third one contains ""k"", and the fourth one contains ""a"".Help Tema understand in advance whether Vika will like Arina\'s gift." 800.0                       
                         1860F "Evaluate RBS" "data structures,geometry,implementation,math,sortings" "You are given 2n tuples of values (a,b,c), where a and b are positive integers and c is a bracket \'(\' or \')\'. Exactly n tuples have c=\'(\' and the other n tuples have c= \')\'.You are asked to choose two positive values x and y (x>0 and y>0; not necessarily integers) and sort the tuples in the increasing value of a\xe2\x8b\x85x+b\xe2\x8b\x85y. If several tuples have the same value, you can place them in any order among themselves.Is it possible to choose such x and y that taking brackets c from the tuples in the resulting order produces a regular bracket sequence?A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence." 2900.0                       
                         1859D "Andrey and Escape from Capygrad" "binary search,data structures,dp,dsu,greedy,sortings" "An incident occurred in Capygrad, the capital of Tyagoland, where all the capybaras in the city went crazy and started throwing mandarins. Andrey was forced to escape from the city as far as possible, using portals.Tyagoland is represented by a number line, and the city of Capygrad is located at point 0. There are n portals all over Tyagoland, each of which is characterised by four integers li, ri, ai and bi (1\xe2\x89\xa4li\xe2\x89\xa4ai\xe2\x89\xa4bi\xe2\x89\xa4ri\xe2\x89\xa4109). Note that the segment [ai,bi] is contained in the segment [li,ri].If Andrey is on the segment [li,ri], then the portal can teleport him to any point on the segment [ai,bi]. Andrey has a pass that allows him to use the portals an unlimited number of times.Andrey thinks that the point x is on the segment [l,r] if the inequality l\xe2\x89\xa4x\xe2\x89\xa4r is satisfied.Andrey has q options for where to start his escape, each option is characterized by a single integer xi \xe2\x80\x94 the starting position of the escape. He wants to escape from Capygrad as far as possible (to the point with the maximum possible coordinate). Help Andrey determine how far he could escape from Capygrad, starting at each of the q positions." 1800.0                       
                         1857D "Strong Vertices" math,sortings,trees "Given two arrays a and b, both of length n. Elements of both arrays indexed from 1 to n. You are constructing a directed graph, where edge from u to v (u\xe2\x89\xa0v) exists if au\xe2\x88\x92av\xe2\x89\xa5bu\xe2\x88\x92bv.A vertex V is called strong if there exists a path from V to all other vertices.A path in a directed graph is a chain of several vertices, connected by edges, such that moving from the vertex u, along the directions of the edges, the vertex v can be reached.Your task is to find all strong vertices.For example, if a=[3,1,2,4] and b=[4,3,2,1], the graph will look like this:   The graph has only one strong vertex with number 4" 1300.0                       
                         1857C "Assembly via Minimums" greedy,sortings "Sasha has an array a of n integers. He got bored and for all i, j (i<j), he wrote down the minimum value of ai and aj. He obtained a new array b of size n\xe2\x8b\x85(n\xe2\x88\x921)2.For example, if a= [2,3,5,1], he would write [min(2,3),min(2,5),min(2,1),min(3,5),min(3,1),min(5,1)] = [2,2,1,3,1,1].Then, he randomly shuffled all the elements of the array b.Unfortunately, he forgot the array a, and your task is to restore any possible array a from which the array b could have been obtained.The elements of array a should be in the range [\xe2\x88\x92109,109]." 1200.0                       
                         1853B Fibonaccharsis "binary search,brute force,math" "Ntarsis has received two integers n and k for his birthday. He wonders how many fibonacci-like sequences of length k can be formed with n as the k-th element of the sequence. A sequence of non-decreasing non-negative integers is considered fibonacci-like if fi=fi\xe2\x88\x921+fi\xe2\x88\x922 for all i>2, where fi denotes the i-th element in the sequence. Note that f1 and f2 can be arbitrary.For example, sequences such as [4,5,9,14] and [0,1,1] are considered fibonacci-like sequences, while [0,0,0,1,1], [1,2,1,3], and [\xe2\x88\x921,\xe2\x88\x921,\xe2\x88\x922] are not: the first two do not always satisfy fi=fi\xe2\x88\x921+fi\xe2\x88\x922, the latter does not satisfy that the elements are non-negative.Impress Ntarsis by helping him with this task." 1200.0                       
                         1851G "Vlad and the Mountains" "binary search,data structures,dsu,graphs,implementation,sortings,trees,two pointers" "Vlad decided to go on a trip to the mountains. He plans to move between n mountains, some of which are connected by roads. The i-th mountain has a height of hi.If there is a road between mountains i and j, Vlad can move from mountain i to mountain j by spending hj\xe2\x88\x92hi units of energy. If his energy drops below zero during the transition, he will not be able to move from mountain i to mountain j. Note that hj\xe2\x88\x92hi can be negative and then the energy will be restored.Vlad wants to consider different route options, so he asks you to answer the following queries: is it possible to construct some route starting at mountain a and ending at mountain b, given that he initially has e units of energy?" 2000.0                       
                         1850D "Balanced Round" "brute force,greedy,implementation,sortings" "You are the author of a Codeforces round and have prepared n problems you are going to set, problem i having difficulty ai. You will do the following process:   remove some (possibly zero) problems from the list;  rearrange the remaining problems in any order you wish. A round is considered balanced if and only if the absolute difference between the difficulty of any two consecutive problems is at most k (less or equal than k).What is the minimum number of problems you have to remove so that an arrangement of problems is balanced?" 900.0                       
                         1850B "Ten Words of Wisdom" implementation,sortings "In the game show ""Ten Words of Wisdom"", there are n participants numbered from 1 to n, each of whom submits one response. The i-th response is ai words long and has quality bi. No two responses have the same quality, and at least one response has length at most 10.The winner of the show is the response which has the highest quality out of all responses that are not longer than 10 words. Which response is the winner?" 800.0                       
                         1849F "XOR Partition" "binary search,bitmasks,data structures,divide and conquer,greedy,trees" "For a set of integers S, let\'s define its cost as the minimum value of x\xe2\x8a\x95y among all pairs of different integers from the set (here, \xe2\x8a\x95 denotes bitwise XOR). If there are less than two elements in the set, its cost is equal to 230.You are given a set of integers {a1,a2,\xe2\x80\xa6,an}. You have to partition it into two sets S1 and S2 in such a way that every element of the given set belongs to exactly one of these two sets. The value of the partition is the minimum among the costs of S1 and S2.Find the partition with the maximum possible value." 2700.0                       
                         1847C "Vampiric Powers, anyone?" "bitmasks,brute force,dp,greedy" "DIO knows that the Stardust Crusaders have determined his location and will be coming to fight him. To foil their plans he decides to send out some Stand users to fight them. Initially, he summoned n Stand users with him, the i-th one having a strength of ai. Using his vampiric powers, he can do the following as many times as he wishes:  Let the current number of Stand users be m.  DIO chooses an index i (1\xe2\x89\xa4i\xe2\x89\xa4m).  Then he summons a new Stand user, with index m+1 and strength given by: am+1=ai\xe2\x8a\x95ai+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95am,where the operator \xe2\x8a\x95 denotes the bitwise XOR operation.  Now, the number of Stand users becomes m+1. Unfortunately for DIO, by using Hermit Purple\'s divination powers, the Crusaders know that he is plotting this, and they also know the strengths of the original Stand users. Help the Crusaders find the maximum possible strength of a Stand user among all possible ways that DIO can summon." 1400.0                       
                         1846G "Rudolf and CodeVid-23" "bitmasks,dp,graphs,greedy,shortest paths" "A new virus called ""CodeVid-23"" has spread among programmers. Rudolf, being a programmer, was not able to avoid it.There are n symptoms numbered from 1 to n that can appear when infected. Initially, Rudolf has some of them. He went to the pharmacy and bought m medicines.For each medicine, the number of days it needs to be taken is known, and the set of symptoms it removes. Unfortunately, medicines often have side effects. Therefore, for each medicine, the set of symptoms that appear when taking it is also known.After reading the instructions, Rudolf realized that taking more than one medicine at a time is very unhealthy.Rudolph wants to be healed as soon as possible. Therefore, he asks you to calculate the minimum number of days to remove all symptoms, or to say that it is impossible." 1900.0                       
                         1846F "Rudolph and Mimic" "constructive algorithms,implementation,interactive" "This is an interactive task.Rudolph is a scientist who studies alien life forms. There is a room in front of Rudolph with n different objects scattered around. Among the objects there is exactly one amazing creature \xe2\x80\x94 a mimic that can turn into any object. He has already disguised himself in this room and Rudolph needs to find him by experiment.The experiment takes place in several stages. At each stage, the following happens: Rudolf looks at all the objects in the room and writes down their types. The type of each object is indicated by a number; there can be several objects of the same type. After inspecting, Rudolph can point to an object that he thinks is a mimic. After that, the experiment ends. Rudolph only has one try, so if he is unsure of the mimic\'s position, he does the next step instead. Rudolf can remove any number of objects from the room (possibly zero). Then Rudolf leaves the room and at this time all objects, including the mimic, are mixed with each other, their order is changed, and the mimic can transform into any other object (even one that is not in the room). After this, Rudolf returns to the room and repeats the stage. The mimic may not change appearance, but it can not remain a same object for more than two stages in a row.Rudolf\'s task is to detect mimic in no more than five stages." 1800.0                       
                         1846E2 "Rudolf and Snowflakes (hard version)" "binary search,brute force,implementation,math" "This is the hard version of the problem. The only difference is that in this version n\xe2\x89\xa41018.One winter morning, Rudolf was looking thoughtfully out the window, watching the falling snowflakes. He quickly noticed a certain symmetry in the configuration of the snowflakes. And like a true mathematician, Rudolf came up with a mathematical model of a snowflake.He defined a snowflake as an undirected graph constructed according to the following rules:   Initially, the graph has only one vertex.  Then, more vertices are added to the graph. The initial vertex is connected by edges to k new vertices (k>1).  Each vertex that is connected to only one other vertex is connected by edges to k more new vertices. This step should be done at least once. The smallest possible snowflake for k=4 is shown in the figure.  After some mathematical research, Rudolf realized that such snowflakes may not have any number of vertices. Help Rudolf check whether a snowflake with n vertices can exist." 1800.0                       
                         1846B "Rudolph and Tic-Tac-Toe" "brute force,implementation,strings" "Rudolph invented the game of tic-tac-toe for three players. It has classic rules, except for the third player who plays with pluses. Rudolf has a 3\xc3\x973 field  \xe2\x80\x94 the result of the completed game. Each field cell contains either a cross, or a nought, or a plus sign, or nothing. The game is won by the player who makes a horizontal, vertical or diagonal row of 3\'s of their symbols.Rudolph wants to find the result of the game. Either exactly one of the three players won or it ended in a draw. It is guaranteed that multiple players cannot win at the same time." 800.0                       
                         1844H "Multiple of Three Cycles" "combinatorics,data structures,dp,dsu,math" "An array a1,\xe2\x80\xa6,an of length n is initially all blank. There are n updates where one entry of a is updated to some number, such that a becomes a permutation of 1,2,\xe2\x80\xa6,n after all the updates.After each update, find the number of ways (modulo 998244353) to fill in the remaining blank entries of a so that a becomes a permutation of 1,2,\xe2\x80\xa6,n and all cycle lengths in a are multiples of 3.A permutation of 1,2,\xe2\x80\xa6,n is an array of length n consisting of n distinct integers from 1 to n in arbitrary order. A cycle in a permutation a is a sequence of pairwise distinct integers (i1,\xe2\x80\xa6,ik) such that i2=ai1,i3=ai2,\xe2\x80\xa6,ik=aik\xe2\x88\x921,i1=aik. The length of this cycle is the number k, which is a multiple of 3 if and only if k\xe2\x89\xa10(mod3)." 3400.0                       
                         1844G "Tree Weights" "bitmasks,constructive algorithms,data structures,dfs and similar,implementation,math,matrices,number theory,trees" "You are given a tree with n nodes labelled 1,2,\xe2\x80\xa6,n. The i-th edge connects nodes ui and vi and has an unknown positive integer weight wi. To help you figure out these weights, you are also given the distance di between the nodes i and i+1 for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 (the sum of the weights of the edges on the simple path between the nodes i and i+1 in the tree).Find the weight of each edge. If there are multiple solutions, print any of them. If there are no weights wi consistent with the information, print a single integer \xe2\x88\x921." 3000.0                       
                         1842E "Tenzing and Triangle" "data structures,dp,geometry,greedy,math" "There are n pairwise-distinct points and a line x+y=k on a two-dimensional plane. The i-th point is at (xi,yi). All points have non-negative coordinates and are strictly below the line. Alternatively, 0\xe2\x89\xa4xi,yi,xi+yi<k.Tenzing wants to erase all the points. He can perform the following two operations:  Draw triangle: Tenzing will choose two non-negative integers a, b that satisfy a+b<k, then all points inside the triangle formed by lines x=a, y=b and x+y=k will be erased. It can be shown that this triangle is an isosceles right triangle. Let the side lengths of the triangle be l, l and \xe2\x88\x9a2l respectively. Then, the cost of this operation is l\xe2\x8b\x85A.The blue area of the following picture describes the triangle with a=1,b=1 with cost =1\xe2\x8b\x85A.   Erase a specific point: Tenzing will choose an integer i that satisfies 1\xe2\x89\xa4i\xe2\x89\xa4n and erase the point i. The cost of this operation is ci.Help Tenzing find the minimum cost to erase all of the points." 2300.0                       
                         1842D "Tenzing and His Animal Friends" "constructive algorithms,graphs,greedy" "Tell a story about me and my animal friends.Tenzing has n animal friends. He numbers them from 1 to n.One day Tenzing wants to play with his animal friends. To do so, Tenzing will host several games.In one game, he will choose a set S which is a subset of {1,2,3,...,n} and choose an integer t. Then, he will play the game with the animals in S for t minutes.But there are some restrictions:   Tenzing loves friend 1 very much, so 1 must be an element of S.  Tenzing doesn\'t like friend n, so n must not be an element of S.  There are m additional restrictions. The i-th special restriction is described by integers ui, vi and yi, suppose x is the total time that exactly one of ui and vi is playing with Tenzing. Tenzing must ensure that x is less or equal to yi. Otherwise, there will be unhappiness. Tenzing wants to know the maximum total time that he can play with his animal friends. Please find out the maximum total time that Tenzing can play with his animal friends and a way to organize the games that achieves this maximum total time, or report that he can play with his animal friends for an infinite amount of time. Also, Tenzing does not want to host so many games, so he will host at most n2 games." 1900.0                       
                         1841E "Fill the Matrix" "data structures,greedy,math" "There is a square matrix, consisting of n rows and n columns of cells, both numbered from 1 to n. The cells are colored white or black. Cells from 1 to ai are black, and cells from ai+1 to n are white, in the i-th column.You want to place m integers in the matrix, from 1 to m. There are two rules:   each cell should contain at most one integer;  black cells should not contain integers. The beauty of the matrix is the number of such j that j+1 is written in the same row, in the next column as j (in the neighbouring cell to the right).What\'s the maximum possible beauty of the matrix?" 2200.0                       
                         1841D "Pairs of Segments" "data structures,greedy,sortings,two pointers" "Two segments [l1,r1] and [l2,r2] intersect if there exists at least one x such that l1\xe2\x89\xa4x\xe2\x89\xa4r1 and l2\xe2\x89\xa4x\xe2\x89\xa4r2.An array of segments [[l1,r1],[l2,r2],\xe2\x80\xa6,[lk,rk]] is called beautiful if k is even, and is possible to split the elements of this array into k2 pairs in such a way that:  every element of the array belongs to exactly one of the pairs;  segments in each pair intersect with each other;  segments in different pairs do not intersect. For example, the array [[2,4],[9,12],[2,4],[7,7],[10,13],[6,8]] is beautiful, since it is possible to form 3 pairs as follows:  the first element of the array (segment [2,4]) and the third element of the array (segment [2,4]);  the second element of the array (segment [9,12]) and the fifth element of the array (segment [10,13]);  the fourth element of the array (segment [7,7]) and the sixth element of the array (segment [6,8]). As you can see, the segments in each pair intersect, and no segments from different pairs intersect.You are given an array of n segments [[l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn]]. You have to remove the minimum possible number of elements from this array so that the resulting array is beautiful." 2000.0                       
                         1840C "Ski Resort" "combinatorics,math,two pointers" "Dima Vatrushin is a math teacher at school. He was sent on vacation for n days for his good work. Dima has long dreamed of going to a ski resort, so he wants to allocate several consecutive days and go skiing. Since the vacation requires careful preparation, he will only go for at least k days.You are given an array a containing the weather forecast at the resort. That is, on the i-th day, the temperature will be ai degrees.Dima was born in Siberia, so he can go on vacation only if the temperature does not rise above q degrees throughout the vacation.Unfortunately, Dima was so absorbed in abstract algebra that he forgot how to count. He asks you to help him and count the number of ways to choose vacation dates at the resort." 1000.0                       
                         1839C "Insert Zero and Invert Prefix" "constructive algorithms" "You have a sequence a1,a2,\xe2\x80\xa6,an of length n, each element of which is either 0 or 1, and a sequence b, which is initially empty.You are going to perform n operations. On each of them you will increase the length of b by 1.  On the i-th operation you choose an integer p between 0 and i\xe2\x88\x921. You insert 0 in the sequence b on position p+1 (after the first p elements), and then you invert the first p elements of b. More formally: let\'s denote the sequence b before the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) operation as b1,b2,\xe2\x80\xa6,bi\xe2\x88\x921. On the i-th operation you choose an integer p between 0 and i\xe2\x88\x921 and replace b with \xc2\xafb1,\xc2\xafb2,\xe2\x80\xa6,\xc2\xafbp,0,bp+1,bp+2,\xe2\x80\xa6,bi\xe2\x88\x921. Here, \xc2\xafx denotes the binary inversion. Hence, \xc2\xaf0=1 and \xc2\xaf1=0. You can find examples of operations in the Notes section.Determine if there exists a sequence of operations that makes b equal to a. If such sequence of operations exists, find it." 1300.0                       
                         1838E "Count Supersequences" combinatorics,dp,math "You are given an array a of n integers, where all elements ai lie in the range [1,k]. How many different arrays b of m integers, where all elements bi lie in the range [1,k], contain a as a subsequence? Two arrays are considered different if they differ in at least one position.A sequence x is a subsequence of a sequence y if x can be obtained from y by the deletion of several (possibly, zero or all) elements.Since the answer may be large, print it modulo 109+7." 2500.0                       
                         1838A "Blackboard List" "constructive algorithms,math" "Two integers were written on a blackboard. After that, the following step was carried out n\xe2\x88\x922 times:  Select any two integers on the board, and write the absolute value of their difference on the board. After this process was complete, the list of n integers was shuffled. You are given the final list. Recover one of the initial two numbers. You do not need to recover the other one.You are guaranteed that the input can be generated using the above process." 800.0                       
                         1837D "Bracket Coloring" "constructive algorithms,greedy" "A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example:  the bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)"");  the bracket sequences "")("", ""("" and "")"" are not. A bracket sequence is called beautiful if one of the following conditions is satisfied:  it is a regular bracket sequence;  if the order of the characters in this sequence is reversed, it becomes a regular bracket sequence. For example, the bracket sequences ""()()"", ""(())"", "")))((("", ""))()(("" are beautiful.You are given a bracket sequence s. You have to color it in such a way that:  every bracket is colored into one color;  for every color, there is at least one bracket colored into that color;  for every color, if you write down the sequence of brackets having that color in the order they appear, you will get a beautiful bracket sequence. Color the given bracket sequence s into the minimum number of colors according to these constraints, or report that it is impossible." 1400.0                       
                         1835B Lottery "binary search,brute force,greedy,math,two pointers" "n people indexed with integers from 1 to n came to take part in a lottery. Each received a ticket with an integer from 0 to m.In a lottery, one integer called target is drawn uniformly from 0 to m. k tickets (or less, if there are not enough participants) with the closest numbers to the target are declared the winners. In case of a draw, a ticket belonging to the person with a smaller index is declared a winner.Bytek decided to take part in the lottery. He knows the values on the tickets of all previous participants. He can pick whatever value he wants on his ticket, but unfortunately, as he is the last one to receive it, he is indexed with an integer n+1. Bytek wants to win the lottery. Thus, he wants to know what he should pick to maximize the chance of winning. He wants to know the smallest integer in case there are many such integers. Your task is to find it and calculate his chance of winning." 2500.0                       
                         1833G "Ksyusha and Chinchilla" "constructive algorithms,dfs and similar,dp,dsu,greedy,implementation,trees" "Ksyusha has a pet chinchilla, a tree on n vertices and huge scissors. A tree is a connected graph without cycles. During a boring physics lesson Ksyusha thought about how to entertain her pet.Chinchillas like to play with branches. A branch is a tree of 3 vertices.  The branch looks like this. A cut is the removal of some (not yet cut) edge in the tree. Ksyusha has plenty of free time, so she can afford to make enough cuts so that the tree splits into branches. In other words, after several (possibly zero) cuts, each vertex must belong to exactly one branch.Help Ksyusha choose the edges to be cut or tell that it is impossible." 1800.0                       
                         1833C "Vlad Building Beautiful Array" greedy,math "Vlad was given an array a of n positive integers. Now he wants to build a beautiful array b of length n from it.Vlad considers an array beautiful if all the numbers in it are positive and have the same parity. That is, all numbers in the beautiful array are greater than zero and are either all even or all odd.To build the array b, Vlad can assign each bi either the value ai or ai\xe2\x88\x92aj, where any j from 1 to n can be chosen.To avoid trying to do the impossible, Vlad asks you to determine whether it is possible to build a beautiful array b of length n using his array a." 800.0                       
                         1831B "Array merging" "constructive algorithms,greedy" "You are given two arrays a and b both of length n.You will merge\xe2\x80\xa0 these arrays forming another array c of length 2\xe2\x8b\x85n. You have to find the maximum length of a subarray consisting of equal values across all arrays c that could be obtained.\xe2\x80\xa0 A merge of two arrays results in an array c composed by successively taking the first element of either array (as long as that array is nonempty) and removing it. After this step, the element is appended to the back of c. We repeat this operation as long as we can (i.e. at least one array is nonempty)." 1000.0                       
                         1830F "The Third Grace" "data structures,dp" "You are given n intervals and m points on the number line. The i-th intervals covers coordinates [li,ri] and the i-th point is on coordinate i and has coefficient pi.Initially, all points are not activated. You should choose a subset of the m points to activate. For each of n interval, we define its cost as:   0, if there are no activated points in the interval;  the coefficient of the activated point with the largest coordinate within it, otherwise. Your task is to maximize the sum of the costs of all intervals by choosing which points to activate." 3200.0                       
                         1829C "Mr. Perfectly Fine" bitmasks,greedy,implementation "Victor wants to become ""Mr. Perfectly Fine"". For that, he needs to acquire a certain set of skills. More precisely, he has 2 skills he needs to acquire. Victor has n books. Reading book i takes him mi minutes and will give him some (possibly none) of the required two skills, represented by a binary string of length 2.What is the minimum amount of time required so that Victor acquires all of the two skills?" 800.0                       
                         1828B "Permutation Swap" "math,number theory" "You are given an unsorted permutation p1,p2,\xe2\x80\xa6,pn. To sort the permutation, you choose a constant k (k\xe2\x89\xa51) and do some operations on the permutation. In one operation, you can choose two integers i, j (1\xe2\x89\xa4j<i\xe2\x89\xa4n) such that i\xe2\x88\x92j=k, then swap pi and pj.What is the maximum value of k that you can choose to sort the given permutation?A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).An unsorted permutation p is a permutation such that there is at least one position i that satisfies pi\xe2\x89\xa0i." 900.0                       
                         1827F "Copium Permutation" "constructive algorithms,data structures,greedy" "You are given a permutation a1,a2,\xe2\x80\xa6,an of the first n positive integers. A subarray [l,r] is called copium if we can rearrange it so that it becomes a sequence of consecutive integers, or more formally, if max(al,al+1,\xe2\x80\xa6,ar)\xe2\x88\x92min(al,al+1,\xe2\x80\xa6,ar)=r\xe2\x88\x92l For each k in the range [0,n], print out the maximum number of copium subarrays of a over all ways of rearranging the last n\xe2\x88\x92k elements of a." 3500.0                       
                         1827A "Counting Orders" "combinatorics,math,sortings,two pointers" "You are given two arrays a and b each consisting of n integers. All elements of a are pairwise distinct.Find the number of ways to reorder a such that ai>bi for all 1\xe2\x89\xa4i\xe2\x89\xa4n, modulo 109+7.Two ways of reordering are considered different if the resulting arrays are different." 1100.0                       
                         1824E "LuoTianyi and Cartridge" "data structures,trees" "LuoTianyi is watching the anime Made in Abyss. She finds that making a Cartridge is interesting. To describe the process of making a Cartridge more clearly, she abstracts the original problem and gives you the following problem.You are given a tree T consisting of n vertices. Each vertex has values ai and bi and each edge has values cj and dj.Now you are aim to build a tree T\xe2\x80\xb2 as follows:  First, select p vertices from T (p is a number chosen by yourself) as the vertex set S\xe2\x80\xb2 of T\xe2\x80\xb2.  Next, select p\xe2\x88\x921 edges from T one by one (you cannot select one edge more than once).  May you have chosen the j-th edge connects vertices xj and yj with values (cj,dj), then you can choose two vertices u and v in S\xe2\x80\xb2 that satisfy the edge (xj,yj) is contained in the simple path from u to v in T, and link u and v in T\xe2\x80\xb2 by the edge with values (cj,dj) (u and v shouldn\'t be contained in one connected component before in T\xe2\x80\xb2).   A tree with three vertices, min(A,C)=1,B+D=7, the cost is 7.   Selected vertices 2 and 3 as S\xe2\x80\xb2, used the edge (1,2) with cj=2 and dj=1 to link this vertices, now min(A,C)=2,B+D=4, the cost is 8. Let A be the minimum of values ai in T\xe2\x80\xb2 and C be the minimum of values ci in T\xe2\x80\xb2. Let B be the sum of bi in T\xe2\x80\xb2 and D be the sum of values di in T\xe2\x80\xb2. Let min(A,C)\xe2\x8b\x85(B+D) be the cost of T\xe2\x80\xb2. You need to find the maximum possible cost of T\xe2\x80\xb2." 3500.0                       
                         1823E "Removing Graph" "brute force,dp,games,graphs,math" "Alice and Bob are playing a game on a graph. They have an undirected graph without self-loops and multiple edges. All vertices of the graph have degree equal to 2. The graph may consist of several components. Note that if such graph has n vertices, it will have exactly n edges.Alice and Bob take turn. Alice goes first. In each turn, the player can choose k (l\xe2\x89\xa4k\xe2\x89\xa4r; l<r) vertices that form a connected subgraph and erase these vertices from the graph, including all incident edges.The player who can\'t make a step loses.For example, suppose they are playing on the given graph with given l=2 and r=3:  A valid vertex set for Alice to choose at the first move is one of the following:   {1,2}  {1,3}  {2,3}  {4,5}  {4,6}  {5,6}  {1,2,3}  {4,5,6}  Suppose, Alice chooses subgraph {4,6}.Then a valid vertex set for Bob to choose at the first move is one of the following:   {1,2}  {1,3}  {2,3}  {1,2,3}  Suppose, Bob chooses subgraph {1,2,3}.Alice can\'t make a move, so she loses.You are given a graph of size n and integers l and r. Who will win if both Alice and Bob play optimally." 2500.0                       
                         1823A A-characteristic "combinatorics,constructive algorithms,math" "Consider an array a1,a2,\xe2\x80\xa6,an consisting of numbers 1 and \xe2\x88\x921. Define A-characteristic of this array as a number of pairs of indices 1\xe2\x89\xa4i<j\xe2\x89\xa4n, such that ai\xe2\x8b\x85aj=1.Find any array a with given length n with A-characteristic equal to the given value k." 800.0                       
                         1822C "Bun Lover" math "Tema loves cinnabon rolls \xe2\x80\x94 buns with cinnabon and chocolate in the shape of a ""snail"".Cinnabon rolls come in different sizes and are square when viewed from above. The most delicious part of a roll is the chocolate, which is poured in a thin layer over the cinnabon roll in the form of a spiral and around the bun, as in the following picture:  Cinnabon rolls of sizes 4, 5, 6 For a cinnabon roll of size n, the length of the outer side of the square is n, and the length of the shortest vertical chocolate segment in the central part is one.Formally, the bun consists of two dough spirals separated by chocolate. A cinnabon roll of size n+1 is obtained from a cinnabon roll of size n by wrapping each of the dough spirals around the cinnabon roll for another layer.It is important that a cinnabon roll of size n is defined in a unique way.Tema is interested in how much chocolate is in his cinnabon roll of size n. Since Tema has long stopped buying small cinnabon rolls, it is guaranteed that n\xe2\x89\xa54.Answer this non-obvious question by calculating the total length of the chocolate layer." 800.0                       
                         1822A "TubeTube Feed" "brute force,implementation" "Mushroom Filippov cooked himself a meal and while having his lunch, he decided to watch a video on TubeTube. He can not spend more than t seconds for lunch, so he asks you for help with the selection of video.The TubeTube feed is a list of n videos, indexed from 1 to n. The i-th video lasts ai seconds and has an entertainment value bi. Initially, the feed is opened on the first video, and Mushroom can skip to the next video in 1 second (if the next video exists). Mushroom can skip videos any number of times (including zero).Help Mushroom choose one video that he can open and watch in t seconds. If there are several of them, he wants to choose the most entertaining one. Print the index of any appropriate video, or \xe2\x88\x921 if there is no such." 800.0                       
                         1821E "Rearrange Brackets" "brute force,dp,greedy,sortings,strings" "A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example:  bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)"");  bracket sequences "")("", ""("" and "")"" are not. You are given a regular bracket sequence. In one move, you can remove a pair of adjacent brackets such that the left one is an opening bracket and the right one is a closing bracket. Then concatenate the resulting parts without changing the order. The cost of this move is the number of brackets to the right of the right bracket of this pair.The cost of the regular bracket sequence is the smallest total cost of the moves required to make the sequence empty.Actually, you are not removing any brackets. Instead, you are given a regular bracket sequence and an integer k. You can perform the following operation at most k times:   extract some bracket from the sequence and insert it back at any position (between any two brackets, at the start or at the end; possibly, at the same place it was before). After all operations are performed, the bracket sequence has to be regular. What is the smallest possible cost of the resulting regular bracket sequence?" 2100.0                       
                         1821D "Black Cells" "binary search,brute force,greedy,math" "You are playing with a really long strip consisting of 1018 white cells, numbered from left to right as 0, 1, 2 and so on. You are controlling a special pointer that is initially in cell 0. Also, you have a ""Shift"" button you can press and hold.In one move, you can do one of three actions:   move the pointer to the right (from cell x to cell x+1);  press and hold the ""Shift"" button;  release the ""Shift"" button: the moment you release ""Shift"", all cells that were visited while ""Shift"" was pressed are colored in black.  (Of course, you can\'t press Shift if you already hold it. Similarly, you can\'t release Shift if you haven\'t pressed it.)Your goal is to color at least k cells, but there is a restriction: you are given n segments [li,ri] \xe2\x80\x94 you can color cells only inside these segments, i. e. you can color the cell x if and only if li\xe2\x89\xa4x\xe2\x89\xa4ri for some i.What is the minimum number of moves you need to make in order to color at least k cells black?" 1900.0                       
                         1819E "Roads in E City" interactive,math,probabilities,trees "This is an interactive problem.As is well known, the city ""E"" has never had its roads repaired in its a thousand and a half years old history. And only recently the city administration repaired some of them.It is known that in total in the city ""E"" there are n intersections and m roads, which can be used in both directions, numbered with integers from 1 to m. The i-th road connects intersections with numbers ai and bi.Among all m roads, some subset of the roads has been repaired, but you do not know which one. The only information you could get from the city\'s road services is that you can get from any intersection to any other intersection by driving only on the roads that have been repaired.You are a young entrepreneur, and decided to organize a delivery service of fresh raw meat in the city ""E"" (in this city such meat is called ""steaks"", it is very popular among the locals). You have already recruited a staff of couriers, but the couriers are willing to travel only on repaired roads. Now you have to find out which roads have already been repaired.The city administration has given you the city for a period of time, so you can make different queries of one of three types:  Block the road with the number x. In this case, movement on the road for couriers will be forbidden. Initially all roads are unblocked. Unblock the road with the number x. In this case, couriers will be able to move on the road x if it is repaired. Try to deliver the order to the intersection with the number y. In this case, one of your couriers will start moving from intersection with number s you don\'t know and deliver the order to intersection with number y if there is a path on unblocked repaired roads from intersection s to intersection y. It is guaranteed that intersection s will be chosen beforehand. Unfortunately, the city is placed at your complete disposal for a short period of time, so you can make no more than 100\xe2\x8b\x85m requests." 3200.0                       
                         1817F "Entangled Substrings" "string suffix structures,strings" "Quantum entanglement is when two particles link together in a certain way no matter how far apart they are in space.You are given a string s. A pair of its non-empty substrings (a,b) is called entangled if there is a (possibly empty) link string c such that:  Every occurrence of a in s is immediately followed by cb;  Every occurrence of b in s is immediately preceded by ac. In other words, a and b occur in s only as substrings of acb. Compute the total number of entangled pairs of substrings of s.A string a is a substring of a string b if a can be obtained from b by the deletion of several (possibly zero or all) characters from the beginning and several (possibly zero or all) characters from the end." 3500.0                       
                         1814F "Communication Towers" "brute force,divide and conquer,dsu" "There are n communication towers, numbered from 1 to n, and m bidirectional wires between them. Each tower has a certain set of frequencies that it accepts, the i-th of them accepts frequencies from li to ri.Let\'s say that a tower b is accessible from a tower a, if there exists a frequency x and a sequence of towers a=v1,v2,\xe2\x80\xa6,vk=b, where consecutive towers in the sequence are directly connected by a wire, and each of them accepts frequency x. Note that accessibility is not transitive, i.\xe2\x80\x89e if b is accessible from a and c is accessible from b, then c may not be accessible from a.Your task is to determine the towers that are accessible from the 1-st tower." 2700.0                       
                         1814D "Balancing Weapons" "binary search,brute force,data structures,math,two pointers" "You\'ve got a job in a game studio that developed an online shooter, and your first big task is to help to balance weapons. The game has n weapons: the i-th gun has an integer fire rate fi and an integer damage per bullet di. The i-th gun\'s total firepower is equal to pi=fi\xe2\x8b\x85di.You have to modify the values di of some guns in such a way that the new values di will still be integers, and the firepower of all guns will become balanced. Given an integer k, the guns are said to be balanced if max1\xe2\x89\xa4i\xe2\x89\xa4npi\xe2\x88\x92min1\xe2\x89\xa4i\xe2\x89\xa4npi\xe2\x89\xa4k.Since gamers that play your game don\'t like big changes, you need to change the values di for the minimum possible number of guns. What is the minimum number of guns for which you have to change these values to make the guns balanced?Note that the new values di must be integers greater than 0." 2500.0                       
                         1814B "Long Legs" "brute force,math" "A robot is placed in a cell (0,0) of an infinite grid. This robot has adjustable length legs. Initially, its legs have length 1.Let the robot currently be in the cell (x,y) and have legs of length m. In one move, it can perform one of the following three actions:   jump into the cell (x+m,y);  jump into the cell (x,y+m);  increase the length of the legs by 1, i.\xe2\x80\x89e. set it to m+1. What\'s the smallest number of moves robot has to make to reach a cell (a,b)?" 1700.0                       
                         1812B "Was it Rated?" "*special problem,*special problem,*special problem,brute force,implementation" "InputThe only line of the input contains a single integer n (1\xe2\x89\xa4n\xe2\x89\xa425).ExamplesInputCopy1OutputCopyYESInputCopy15OutputCopyNO" -999.0                       
                         1810G "The Maximum Prefix" dp "You\'re going to generate an array a with a length of at most n, where each ai equals either 1 or \xe2\x88\x921.You generate this array in the following way.   First, you choose some integer k (1\xe2\x89\xa4k\xe2\x89\xa4n), which decides the length of a.  Then, for each i (1\xe2\x89\xa4i\xe2\x89\xa4k), you set ai=1 with probability pi, otherwise set ai=\xe2\x88\x921 (with probability 1\xe2\x88\x92pi). After the array is generated, you calculate si=a1+a2+a3+\xe2\x80\xa6+ai. Specially, s0=0. Then you let S equal to kmaxi=0si. That is, S is the maximum prefix sum of the array a.You are given n+1 integers h0,h1,\xe2\x80\xa6,hn. The score of an array a with maximum prefix sum S is hS. Now, for each k, you want to know the expected score for an array of length k modulo 109+7." 3200.0                       
                         1810D "Climbing the Tree" "binary search,math" "The snails are climbing a tree. The tree height is h meters, and snails start at position 0.Each snail has two attributes a and b (a>b). Starting from the 1-st day, one snail climbs the tree like this: during the daylight hours of the day, he climbs up a meters; during the night, the snail rests, and he slides down b meters. If on the n-th day, the snail reaches position h for the first time (that is, the top of the tree), he will finish climbing, and we say that the snail spends n days climbing the tree. Note that on the last day of climbing, the snail doesn\'t necessarily climb up a meters, in case his distance to the top is smaller than a.Unfortunately, you don\'t know the exact tree height h at first, but you know that h is a positive integer. There are q events of two kinds.  Event of type 1: a snail with attributes a, b comes and claims that he spent n days climbing the tree. If this message contradicts previously adopted information (i. e. there is no tree for which all previously adopted statements and this one are true), ignore it. Otherwise, adopt it. Event of type 2: a snail with attributes a, b comes and asks you how many days he will spend if he climbs the tree. You can only give the answer based on the information you have adopted so far. If you cannot determine the answer precisely, report that. You need to deal with all the events in order." 1700.0                       
                         1810A "Beautiful Sequence" "brute force,greedy" "A sequence of m integers a1,a2,\xe2\x80\xa6,am is good, if and only if there exists at least one i (1\xe2\x89\xa4i\xe2\x89\xa4m) such that ai=i. For example, [3,2,3] is a good sequence, since a2=2, a3=3, while [3,1,1] is not a good sequence, since there is no i such that ai=i.A sequence a is beautiful, if and only if there exists at least one subsequence of a satisfying that this subsequence is good. For example, [4,3,2] is a beautiful sequence, since its subsequence [4,2] is good, while [5,3,4] is not a beautiful sequence.A sequence b is a subsequence of a sequence a if b can be obtained from a by the deletion of several (possibly, zero or all) elements. Now you are given a sequence, check whether it is beautiful or not." 800.0                       
                         1809G Prediction combinatorics,dp,math "Consider a tournament with n participants. The rating of the i-th participant is ai.The tournament will be organized as follows. First of all, organizers will assign each participant an index from 1 to n. All indices will be unique. Let pi be the participant who gets the index i.Then, n\xe2\x88\x921 games will be held. In the first game, participants p1 and p2 will play. In the second game, the winner of the first game will play against p3. In the third game, the winner of the second game will play against p4, and so on \xe2\x80\x94 in the last game, the winner of the (n\xe2\x88\x922)-th game will play against pn.Monocarp wants to predict the results of all n\xe2\x88\x921 games (of course, he will do the prediction only after the indices of the participants are assigned). He knows for sure that, when two participants with ratings x and y play, and |x\xe2\x88\x92y|>k, the participant with the higher rating wins. But if |x\xe2\x88\x92y|\xe2\x89\xa4k, any of the two participants may win.Among all n! ways to assign the indices to participants, calculate the number of ways to do this so that Monocarp can predict the results of all n\xe2\x88\x921 games. Since the answer can be large, print it modulo 998244353." 2800.0                       
                         1809A Garland implementation "You have a garland consisting of 4 colored light bulbs, the color of the i-th light bulb is si.Initially, all the light bulbs are turned off. Your task is to turn all the light bulbs on. You can perform the following operation any number of times: select a light bulb and switch its state (turn it on if it was off, and turn it off if it was on). The only restriction on the above operation is that you can apply the operation to a light bulb only if the previous operation was applied to a light bulb of a different color (the first operation can be applied to any light bulb).Calculate the minimum number of operations to turn all the light bulbs on, or report that this is impossible." 800.0                       
                         1807D "Odd Queries" "data structures,implementation" "You have an array a1,a2,\xe2\x80\xa6,an. Answer q queries of the following form:   If we change all elements in the range al,al+1,\xe2\x80\xa6,ar of the array to k, will the sum of the entire array be odd?  Note that queries are independent and do not affect future queries." 900.0                       
                         1806A "Walking Master" geometry,greedy,math "YunQian is standing on an infinite plane with the Cartesian coordinate system on it. In one move, she can move to the diagonally adjacent point on the top right or the adjacent point on the left.That is, if she is standing on point (x,y), she can either move to point (x+1,y+1) or point (x\xe2\x88\x921,y).YunQian initially stands at point (a,b) and wants to move to point (c,d). Find the minimum number of moves she needs to make or declare that it is impossible." 800.0                       
                         1805E "There Should Be a Lot of Maximums" "brute force,data structures,dfs and similar,dp,trees,two pointers" "You are given a tree (a connected graph without cycles). Each vertex of the tree contains an integer. Let\'s define the MAD (maximum double) parameter of the tree as the maximum integer that occurs in the vertices of the tree at least 2 times. If no number occurs in the tree more than once, then we assume MAD=0.Note that if you remove an edge from the tree, it splits into two trees. Let\'s compute the MAD parameters of the two trees and take the maximum of the two values. Let the result be the value of the deleted edge.For each edge, find its value. Note that we don\'t actually delete any edges from the tree, the values are to be found independently." 2300.0                       
                         1805A "We Need the Zero" "bitmasks,brute force" "There is an array a consisting of non-negative integers. You can choose an integer x and denote bi=ai\xe2\x8a\x95x for all 1\xe2\x89\xa4i\xe2\x89\xa4n, where \xe2\x8a\x95 denotes the bitwise XOR operation. Is it possible to choose such a number x that the value of the expression b1\xe2\x8a\x95b2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95bn equals 0?It can be shown that if a valid number x exists, then there also exists x such that (0\xe2\x89\xa4x<28)." 800.0                       
                         1804F "Approximate Diameter" "binary search,divide and conquer,graphs,shortest paths" "Jack has a graph of n vertices and m edges. All edges are bidirectional and of unit length. The graph is connected, i. e. there exists a path between any two of its vertices. There can be more than one edge connecting the same pair of vertices. The graph can contain self-loops, i. e. edges connecting a node to itself.The distance between vertices u and v is denoted as \xcf\x81(u,v) and equals the minimum possible number of edges on a path between u and v. The diameter of graph G is defined as the maximum possible distance between some pair of its vertices. We denote it as d(G). In other words, d(G)=max1\xe2\x89\xa4u,v\xe2\x89\xa4n\xcf\x81(u,v).Jack plans to consecutively apply q updates to his graph. Each update adds exactly one edge to the graph. Denote as Gi the graph after exactly i updates are made. Jack wants to calculate q+1 values d(G0),d(G1),d(G2),\xe2\x80\xa6,d(Gq).However, Jack suspects that finding the exact diameters of q+1 graphs might be a difficult task, so he is fine with approximate answers that differ from the correct answers no more than twice. Formally, Jack wants to find a sequence of positive integers a0,a1,a2,\xe2\x80\xa6,aq such that \xe2\x8c\x88d(Gi)2\xe2\x8c\x89\xe2\x89\xa4ai\xe2\x89\xa42\xe2\x8b\x85d(Gi) for each i.HacksYou cannot make hacks in this problem." 2700.0                       
                         1804C "Pull Your Luck" "brute force,greedy,math,number theory" "While James is gone on business, Vesper takes her time and explores what the legendary Casino Royale has to offer to people who are fond of competitive programming.Her attention was grabbed by the very new ""Pull Your Luck"" roulette which functions in a pretty peculiar way. The roulette\'s wheel consists of n sectors number from 0 to n\xe2\x88\x921. There is no ball and the winning sector is determined by a static arrow pointing to one of the sectors. Sectors\' indexes go in the natural order and the wheel always spins in the direction of indexes increment. That means that sector i+1 goes right after sector i for all i from 0 to n\xe2\x88\x922, and sector 0 goes right after sector n\xe2\x88\x921.After a bet is made, the player is allowed to pull the triggering handle herself and cause the wheel to spin. If the player\'s initial pull is made with the force equal to positive integer f, the wheel will spin for f seconds. During the first second it will advance f sectors, the next second it will advance f\xe2\x88\x921 sectors, then f\xe2\x88\x922 sectors, and so on until it comes to a complete stop. After the wheel comes to a complete stop, the sector which the arrow is pointing to is the winning one.The roulette\'s arrow currently points at sector x. Vesper knows that she can pull the handle with any integer force from 1 to p inclusive. Note that it is not allowed to pull the handle with force 0, i. e. not pull it all. The biggest prize is awarded if the winning sector is 0. Now Vesper wonders if she can make sector 0 win by pulling the triggering handle exactly once?" 1500.0                       
                         1800F "Dasha and Nightmares" bitmasks,hashing,meet-in-the-middle,strings "Dasha, an excellent student, is studying at the best mathematical lyceum in the country. Recently, a mysterious stranger brought n words consisting of small latin letters s1,s2,\xe2\x80\xa6,sn to the lyceum. Since that day, Dasha has been tormented by nightmares.Consider some pair of integers \xe2\x9f\xa8i,j\xe2\x9f\xa9 (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n). A nightmare is a string for which it is true:  It is obtained by concatenation sisj;  Its length is odd;  The number of different letters in it is exactly 25;  The number of occurrences of each letter that is in the word is odd. For example, if si= ""abcdefg"" and sj= ""ijklmnopqrstuvwxyz"", the pair \xe2\x9f\xa8i,j\xe2\x9f\xa9 creates a nightmare.Dasha will stop having nightmares if she counts their number. There are too many nightmares, so Dasha needs your help. Count the number of different nightmares.Nightmares are called different if the corresponding pairs \xe2\x9f\xa8i,j\xe2\x9f\xa9 are different. The pairs \xe2\x9f\xa8i1,j1\xe2\x9f\xa9 and \xe2\x9f\xa8i2,j2\xe2\x9f\xa9 are called different if i1\xe2\x89\xa0i2 or j1\xe2\x89\xa0j2." 1900.0                       
                         1799D1 "Hot Start Up (easy version)" dp "This is an easy version of the problem. The constraints of t, n, k are the only difference between versions.You have a device with two CPUs. You also have k programs, numbered 1 through k, that you can run on the CPUs. The i-th program (1\xe2\x89\xa4i\xe2\x89\xa4k) takes coldi seconds to run on some CPU. However, if the last program we ran on this CPU was also program i, it only takes hoti seconds (hoti\xe2\x89\xa4coldi). Note that this only applies if we run program i multiple times consecutively  \xe2\x80\x94 if we run program i, then some different program, then program i again, it will take coldi seconds the second time.You are given a sequence a1,a2,\xe2\x80\xa6,an of length n, consisting of integers from 1 to k. You need to use your device to run programs a1,a2,\xe2\x80\xa6,an in sequence. For all 2\xe2\x89\xa4i\xe2\x89\xa4n, you cannot start running program ai until program ai\xe2\x88\x921 has completed.Find the minimum amount of time needed to run all programs a1,a2,\xe2\x80\xa6,an in sequence." 1900.0                       
                         1798E "Multitest Generator" "brute force,dp" "Let\'s call an array b1,b2,\xe2\x80\xa6,bm a test if b1=m\xe2\x88\x921.Let\'s call an array b1,b2,\xe2\x80\xa6,bm a multitest if the array b2,b3,\xe2\x80\xa6,bm can be split into b1 non-empty subarrays so that each of these subarrays is a test. Note that each element of the array must be included in exactly one subarray, and the subarrays must consist of consecutive elements.Let\'s define the function f from the array b1,b2,\xe2\x80\xa6,bm as the minimum number of operations of the form ""Replace any bi with any non-negative integer x"", which needs to be done so that the array b1,b2,\xe2\x80\xa6,bm becomes a multitest.You are given an array of positive integers a1,a2,\xe2\x80\xa6,an. For each i from 1 to n\xe2\x88\x921, find f([ai,ai+1,\xe2\x80\xa6,an]).Below are some examples of tests and multitests.   Tests: [1_,5], [2_,2,2], [3_,4,1,1], [5_,0,0,0,0,0], [7_,1,2,3,4,5,6,7], [0_]. These arrays are tests since their first element (underlined) is equal to the length of the array minus one.  Multitests: [1,1_,1_], [2,3_,0,0,1_,1_,12_], [3,2_,2,7_,1_,1_,3_,4,4,4_], [4,0__,3_,1,7,9_,4_,2,0,0,9_,1_,777_]. Underlined are the subarrays after the split, and double underlined are the first elements of each subarray." 2300.0                       
                         1798C "Candy Store" "greedy,math,number theory" "The store sells n types of candies with numbers from 1 to n. One candy of type i costs bi coins. In total, there are ai candies of type i in the store.You need to pack all available candies in packs, each pack should contain only one type of candies. Formally, for each type of candy i you need to choose the integer di, denoting the number of type i candies in one pack, so that ai is divided without remainder by di.Then the cost of one pack of candies of type i will be equal to bi\xe2\x8b\x85di. Let\'s denote this cost by ci, that is, ci=bi\xe2\x8b\x85di.After packaging, packs will be placed on the shelf. Consider the cost of the packs placed on the shelf, in order c1,c2,\xe2\x80\xa6,cn. Price tags will be used to describe costs of the packs. One price tag can describe the cost of all packs from l to r inclusive if cl=cl+1=\xe2\x80\xa6=cr. Each of the packs from 1 to n must be described by at least one price tag. For example, if c1,\xe2\x80\xa6,cn=[4,4,2,4,4], to describe all the packs, a 3 price tags will be enough, the first price tag describes the packs 1,2, the second: 3, the third: 4,5.You are given the integers a1,b1,a2,b2,\xe2\x80\xa6,an,bn. Your task is to choose integers di so that ai is divisible by di for all i, and the required number of price tags to describe the values of c1,c2,\xe2\x80\xa6,cn is the minimum possible.For a better understanding of the statement, look at the illustration of the first test case of the first test:  Let\'s repeat the meaning of the notation used in the problem:ai \xe2\x80\x94 the number of candies of type i available in the store.bi \xe2\x80\x94 the cost of one candy of type i.di \xe2\x80\x94 the number of candies of type i in one pack.ci \xe2\x80\x94 the cost of one pack of candies of type i is expressed by the formula ci=bi\xe2\x8b\x85di." 1700.0                       
                         1798B "Three Sevens" "brute force,data structures,greedy,implementation" "Lottery ""Three Sevens"" was held for m days. On day i, ni people with the numbers ai,1,\xe2\x80\xa6,ai,ni participated in the lottery.It is known that in each of the m days, only one winner was selected from the lottery participants. The lottery winner on day i was not allowed to participate in the lottery in the days from i+1 to m.Unfortunately, the information about the lottery winners has been lost. You need to find any possible list of lottery winners on days from 1 to m or determine that no solution exists." 1000.0                       
                         1794C "Scoring Subsequences" "binary search,greedy,math,two pointers" "The score of a sequence [s1,s2,\xe2\x80\xa6,sd] is defined as s1\xe2\x8b\x85s2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85sdd!, where d!=1\xe2\x8b\x852\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85d. In particular, the score of an empty sequence is 1.For a sequence [s1,s2,\xe2\x80\xa6,sd], let m be the maximum score among all its subsequences. Its cost is defined as the maximum length of a subsequence with a score of m.You are given a non-decreasing sequence [a1,a2,\xe2\x80\xa6,an] of integers of length n. In other words, the condition a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an is satisfied. For each k=1,2,\xe2\x80\xa6,n, find the cost of the sequence [a1,a2,\xe2\x80\xa6,ak]. A sequence x is a subsequence of a sequence y if x can be obtained from y by deletion of several (possibly, zero or all) elements." 1300.0                       
                         1794A "Prefix and Suffix Array" strings "Marcos loves strings a lot, so he has a favorite string s consisting of lowercase English letters. For this string, he wrote down all its non-empty prefixes and suffixes (except for s) on a piece of paper in arbitrary order. You see all these strings and wonder if Marcos\' favorite string is a palindrome or not. So, your task is to decide whether s is a palindrome by just looking at the piece of paper.A string a is a prefix of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the end.A string a is a suffix of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning.A palindrome is a string that reads the same backward as forward, for example, strings ""gg"", ""ioi"", ""abba"", ""icpci"" are palindromes, but strings ""codeforces"", ""abcd"", ""alt"" are not." 800.0                       
                         1792A GamingForces greedy,sortings "Monocarp is playing a computer game. He\'s going to kill n monsters, the i-th of them has hi health.Monocarp\'s character has two spells, either of which he can cast an arbitrary number of times (possibly, zero) and in an arbitrary order:   choose exactly two alive monsters and decrease their health by 1;  choose a single monster and kill it. When a monster\'s health becomes 0, it dies.What\'s the minimum number of spell casts Monocarp should perform in order to kill all monsters?" 800.0                       
                         1791G2 "Teleporters (Hard Version)" "binary search,greedy,sortings" "The only difference between the easy and hard versions are the locations you can teleport to.Consider the points 0,1,\xe2\x80\xa6,n+1 on the number line. There is a teleporter located on each of the points 1,2,\xe2\x80\xa6,n. At point i, you can do the following:  Move left one unit: it costs 1 coin.  Move right one unit: it costs 1 coin.  Use a teleporter at point i, if it exists: it costs ai coins. As a result, you can choose whether to teleport to point 0 or point n+1. Once you use a teleporter, you can\'t use it again. You have c coins, and you start at point 0. What\'s the most number of teleporters you can use?" 1900.0                       
                         1790A "Polycarp and the Day of Pi" implementation,math,strings "On March 14, the day of the number \xcf\x80 is celebrated all over the world. This is a very important mathematical constant equal to the ratio of the circumference of a circle to its diameter.Polycarp was told at school that the number \xcf\x80 is irrational, therefore it has an infinite number of digits in decimal notation. He wanted to prepare for the Day of the number \xcf\x80 by memorizing this number as accurately as possible.Polycarp wrote out all the digits that he managed to remember. For example, if Polycarp remembered \xcf\x80 as 3.1415, he wrote out 31415.Polycarp was in a hurry and could have made a mistake, so you decided to check how many first digits of the number \xcf\x80 Polycarp actually remembers correctly." 800.0                       
                         1783B "Matrix of Differences" "constructive algorithms,math" "For a square matrix of integers of size n\xc3\x97n, let\'s define its beauty as follows: for each pair of side-adjacent elements x and y, write out the number |x\xe2\x88\x92y|, and then find the number of different numbers among them.For example, for the matrix (1342) the numbers we consider are |1\xe2\x88\x923|=2, |1\xe2\x88\x924|=3, |3\xe2\x88\x922|=1 and |4\xe2\x88\x922|=2; there are 3 different numbers among them (2, 3 and 1), which means that its beauty is equal to 3.You are given an integer n. You have to find a matrix of size n\xc3\x97n, where each integer from 1 to n2 occurs exactly once, such that its beauty is the maximum possible among all such matrices." 1100.0                       
                         1778F "Maximizing Root" "dfs and similar,dp,graphs,math,number theory,trees" "You are given a rooted tree consisting of n vertices numbered from 1 to n. Vertex 1 is the root of the tree. Each vertex has an integer value. The value of i-th vertex is ai. You can do the following operation at most k times.  Choose a vertex v that has not been chosen before and an integer x such that x is a common divisor of the values of all vertices of the subtree of v. Multiply by x the value of each vertex in the subtree of v. What is the maximum possible value of the root node 1 after at most k operations? Formally, you have to maximize the value of a1.A tree is a connected undirected graph without cycles. A rooted tree is a tree with a selected vertex, which is called the root. The subtree of a node u is the set of all nodes y such that the simple path from y to the root passes through u. Note that u is in the subtree of u." 2600.0                       
                         1778D "Flexible String Revisit" combinatorics,dp,math,probabilities "You are given two binary strings a and b of length n. In each move, the string a is modified in the following way.  An index i (1\xe2\x89\xa4i\xe2\x89\xa4n) is chosen uniformly at random. The character ai will be flipped. That is, if ai is 0, it becomes 1, and if ai is 1, it becomes 0. What is the expected number of moves required to make both strings equal for the first time?A binary string is a string, in which the character is either 0 or 1." 2100.0                       
                         1778C "Flexible String" "bitmasks,brute force,strings" "You have a string a and a string b. Both of the strings have length n. There are at most 10 different characters in the string a. You also have a set Q. Initially, the set Q is empty. You can apply the following operation on the string a any number of times:  Choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and a lowercase English letter c. Add ai to the set Q and then replace ai with c. For example, Let the string a be ""abecca"". We can do the following operations:   In the first operation, if you choose i=3 and c=x, the character a3=e will be added to the set Q. So, the set Q will be {e}, and the string a will be ""abx_cca"". In the second operation, if you choose i=6 and c=s, the character a6=a will be added to the set Q. So, the set Q will be {e,a}, and the string a will be ""abxccs_"". You can apply any number of operations on a, but in the end, the set Q should contain at most k different characters. Under this constraint, you have to maximize the number of integer pairs (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that a[l,r]=b[l,r]. Here, s[l,r] means the substring of string s starting at index l (inclusively) and ending at index r (inclusively)." 1600.0                       
                         1778B "The Forbidden Permutation" greedy,math "You are given a permutation p of length n, an array of m distinct integers a1,a2,\xe2\x80\xa6,am (1\xe2\x89\xa4ai\xe2\x89\xa4n), and an integer d.Let pos(x) be the index of x in the permutation p. The array a is not good if   pos(ai)<pos(ai+1)\xe2\x89\xa4pos(ai)+d for all 1\xe2\x89\xa4i<m. For example, with the permutation p=[4,2,1,3,6,5] and d=2:   a=[2,3,6] is a not good array.  a=[2,6,5] is good because pos(a1)=2, pos(a2)=5, so the condition pos(a2)\xe2\x89\xa4pos(a1)+d is not satisfied.  a=[1,6,3] is good because pos(a2)=5, pos(a3)=4, so the condition pos(a2)<pos(a3) is not satisfied. In one move, you can swap two adjacent elements of the permutation p. What is the minimum number of moves needed such that the array a becomes good? It can be shown that there always exists a sequence of moves so that the array a becomes good.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3, but there is 4 in the array)." 1300.0                       
                         1776F "Train Splitting" "constructive algorithms,graphs,greedy" "There are n big cities in Italy, and there are m train routes between pairs of cities. Each route connects two different cities bidirectionally. Moreover, using the trains one can reach every city starting from any other city.Right now, all the routes are operated by the government-owned Italian Carriage Passenger Company, but the government wants to privatize the routes. The government does not want to give too much power to a single company, but it also does not want to make people buy a lot of different subscriptions. Also, it would like to give a fair chance to all companies. In order to formalize all these wishes, the following model was proposed.There will be k\xe2\x89\xa52 private companies indexed by 1,2,\xe2\x80\xa6,k. Each train route will be operated by exactly one of the k companies. Then:  For any company, there should exist two cities such that it is impossible to reach one from the other using only routes operated by that company.  On the other hand, for any two companies, it should be possible to reach every city from any other city using only routes operated by these two companies. Find a plan satisfying all these criteria. It can be shown that a viable plan always exists. Please note that you can choose the number k and you do not have to minimize or maximize it." 1700.0                       
                         1776C "Library game" games,greedy,interactive,sortings "Alessia and Bernardo are discovering the world of competitive programming through the books of their university library.The library consists of m sections numbered from 1 to m. Each section contains only books dedicated to a particular subject and different sections correspond to different subjects. In order to prevent the students from wandering in the library, the university has established a system of passes. Each pass has a length y associated to it and allows access to an interval of y consecutive sections in the library. During a visit, the student must choose exactly one book from one of these sections and leave the library. Each pass can be used only once.At the moment Alessia and Bernardo have n passes of lengths x1,x2,\xe2\x80\xa6,xn. They have different opinions on the best way to improve: Alessia thinks that it is important to study many different topics, while Bernardo believes that it is important to study deeply at least one topic. So, Alessia wants to use the n passes to get n books on distinct topics, while Bernardo would like to get at least two books on the same topic.They have reached the following agreement: for each of the following n days, Alessia will choose a pass of length y among those which are still available and an interval of y sections in the library, and Bernardo will go into the library and will take exactly one book from one of those sections.Can Bernardo manage to get at least two books on the same subject, or will Alessia be able to avoid it?You should decide whether you want to be Alessia or Bernardo, and you have to fulfill the goal of your chosen character. The judge will impersonate the other character. Note that, even if at some moment Bernardo has already taken two books on the same subject, the interaction should go on until the end of the n days." 2500.0                       
                         1775B "Gardener and the Array" "bitmasks,constructive algorithms" "The gardener Kazimir Kazimirovich has an array of n integers c1,c2,\xe2\x80\xa6,cn.He wants to check if there are two different subsequences a and b of the original array, for which f(a)=f(b), where f(x) is the bitwise OR of all of the numbers in the sequence x.A sequence q is a subsequence of p if q can be obtained from p by deleting several (possibly none or all) elements.Two subsequences are considered different if the sets of indexes of their elements in the original sequence are different, that is, the values of the elements are not considered when comparing the subsequences." 1300.0                       
                         1774G "Segment Covering" "brute force,combinatorics,constructive algorithms,data structures,dp,trees" "ChthollyNotaSeniorious gives DataStructures a number axis with m distinct segments on it. Let f(l,r) be the number of ways to choose an even number of segments such that the union of them is exactly [l,r], and g(l,r) be the number of ways to choose an odd number of segments such that the union of them is exactly [l,r].ChthollyNotaSeniorious asked DataStructures q questions. In each query, ChthollyNotaSeniorious will give DataStructures two numbers l,r, and now he wishes that you can help him find the value f(l,r)\xe2\x88\x92g(l,r) modulo 998244353 so that he wouldn\'t let her down." 3200.0                       
                         1774F1 "Magician and Pigs (Easy Version)" "brute force,data structures,implementation" "This is the easy version of the problem. The only difference between the two versions is the constraint on n and x. You can make hacks only if both versions of the problem are solved.Little09 has been interested in magic for a long time, and it\'s so lucky that he meets a magician! The magician will perform n operations, each of them is one of the following three: 1 x: Create a pig with x Health Points.  2 x: Reduce the Health Point of all living pigs by x.  3: Repeat all previous operations. Formally, assuming that this is the i-th operation in the operation sequence, perform the first i\xe2\x88\x921 operations (including ""Repeat"" operations involved) in turn.A pig will die when its Health Point is less than or equal to 0. Little09 wants to know how many living pigs there are after all the operations. Please, print the answer modulo 998244353." 2400.0                       
                         1774B Coloring "constructive algorithms,greedy,math" "Cirno_9baka has a paper tape with n cells in a row on it. As he thinks that the blank paper tape is too dull, he wants to paint these cells with m kinds of colors. For some aesthetic reasons, he thinks that the i-th color must be used exactly ai times, and for every k consecutive cells, their colors have to be distinct. Help Cirno_9baka to figure out if there is such a way to paint the cells." 1500.0                       
                         1771F "Hossam and Range Minimum Query" "binary search,bitmasks,data structures,hashing,probabilities,strings,trees" "Hossam gives you a sequence of integers a1,a2,\xe2\x80\xa6,an of length n. Moreover, he will give you q queries of type (l,r). For each query, consider the elements al,al+1,\xe2\x80\xa6,ar. Hossam wants to know the smallest number in this sequence, such that it occurs in this sequence an odd number of times.You need to compute the answer for each query before process the next query." 2500.0                       
                         1769D2 "\xd0\x98\xd0\xb3\xd1\x80\xd0\xb0 \xd0\xb2 \xd0\x94\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 II" "*special problem,brute force" "\xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb8 \xd0\xbd\xd0\xb0\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0\xd1\x8e\xd1\x82 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xb1\xd0\xb5\xd0\xb4\xd1\x83, \xd0\xbd\xd0\xbe \xd0\xb8 \xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xbf\xd1\x82\xd0\xb8\xd0\xbc\xd0\xb8\xd0\xb7\xd0\xb0\xd1\x86\xd0\xb8\xd1\x8e \xd1\x80\xd0\xb5\xd0\xb7\xd1\x83\xd0\xbb\xd1\x8c\xd1\x82\xd0\xb0\xd1\x82\xd0\xb0 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xbd\xd0\xb8\xd1\x85. \xd0\x92\xd0\xb2\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd0\xbd\xd1\x8f\xd1\x82\xd0\xb8\xd0\xb5 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd1\x8b \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0, \xd0\xb8 \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 13 \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xbe\xd0\xb2 \xd1\x81 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xbc\xd0\xb8 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f\xd0\xbc\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd1\x8b.\xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd0\x91\xd0\xbe\xd0\xb1 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb\xd0\xb8 \xd1\x81\xd1\x8b\xd0\xb3\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x83\xd1\x8e \xd0\xb8\xd0\xb3\xd1\x80\xd1\x83 \xc2\xab\xd0\x94\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0\xc2\xbb. \xd0\x9f\xd0\xbe\xd0\xb6\xd0\xb0\xd0\xbb\xd1\x83\xd0\xb9\xd1\x81\xd1\x82\xd0\xb0, \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd1\x83 \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbe\xd1\x82\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2\xd0\xb0\xd0\xbc.\xd0\x94\xd0\xbb\xd1\x8f \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb4\xd0\xb0\xd1\x80\xd1\x82\xd0\xbd\xd0\xb0\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb8\xd0\xb7 36 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xe2\x80\x94 \xd0\xbf\xd0\xbe \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 (\xd0\xbe\xd1\x82 \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xbe \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0) \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd1\x91\xd1\x85 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb5\xd0\xb9 (\xd1\x82\xd1\x80\xd0\xb5\xd1\x84\xd1\x8b, \xd0\xb1\xd1\x83\xd0\xb1\xd0\xbd\xd1\x8b, \xd0\xbf\xd0\xb8\xd0\xba\xd0\xb8 \xd0\xb8 \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb8). \xd0\x9a\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xbf\xd0\xbe \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd1\x83 \xd0\xbe\xd1\x82 \xd0\xbc\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x88\xd0\xb5\xd0\xb9 \xd0\xba \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x88\xd0\xb5\xd0\xb9 \xd0\xb8\xd0\xb4\xd1\x83\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc: \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0, \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0, \xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb5\xd1\x82, \xd0\xb4\xd0\xb0\xd0\xbc\xd0\xb0, \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c, \xd1\x82\xd1\x83\xd0\xb7.\xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x88\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd0\xb8 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb4\xd0\xb0\xd1\x91\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe 18 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82. \xd0\x9a\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbf\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd1\x91\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0\xd0\xbc. \xd0\x92\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb9 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8.\xd0\x98\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb8 \xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x82 \xd0\xbf\xd0\xbe \xd0\xbe\xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb8. \xd0\xa5\xd0\xbe\xd0\xb4 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xbe\xd0\xb2:   \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8;  \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd1\x83, \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd1\x83 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd1\x83 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb8\xd1\x86\xd1\x83 \xd0\xb2\xd1\x8b\xd1\x88\xd0\xb5;  \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd1\x83, \xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb5\xd1\x82\xd0\xb0, \xd0\xb4\xd0\xb0\xd0\xbc\xd1\x83, \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd0\xb8\xd0\xbb\xd0\xb8 \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb8\xd1\x86\xd1\x83 \xd0\xbd\xd0\xb8\xd0\xb6\xd0\xb5. \xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 \xd0\xbf\xd0\xb8\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb2 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd1\x84 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd1\x84, \xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0 \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd0\xb9 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd0\xb9.\xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbd\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8, \xd1\x82\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd0\xba \xd1\x81\xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xbd\xd0\xb8\xd0\xba\xd1\x83. \xd0\x9e\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5: \xd0\xbd\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x8f \xd0\xbf\xd1\x80\xd0\xbe\xd0\xbf\xd1\x83\xd1\x81\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe \xd1\x82\xd0\xb0\xd0\xba \xe2\x80\x94 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xba\xd0\xbe\xd1\x80\xd1\x80\xd0\xb5\xd0\xba\xd1\x82\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe.\xd0\x9f\xd0\xbe\xd0\xbc\xd0\xb8\xd0\xbc\xd0\xbe \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba \xd1\x81\xd1\x82\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb8\xd0\xb7\xd0\xb1\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb2 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5, \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd0\x91\xd0\xbe\xd0\xb1 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f\xd1\x82, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x86\xd0\xb5 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xd1\x83 \xd0\xb8\xd1\x85 \xd1\x81\xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c \xd0\xba\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5, \xd0\xb0 \xd0\xb2 \xd0\xb8\xd1\x85 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xe2\x80\x94 \xd0\xba\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb5. \xd0\x9d\xd0\xb0\xd0\xbf\xd0\xbe\xd0\xbc\xd0\xbd\xd0\xb8\xd0\xbc, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xba\xd0\xb0\xd0\xbd\xd1\x87\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd0\xba\xd0\xb0\xd0\xba \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xb8\xd0\xb7 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbd\xd1\x8e\xd1\x8e \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8.\xd0\xa0\xd0\xb5\xd0\xb7\xd1\x83\xd0\xbb\xd1\x8c\xd1\x82\xd0\xb0\xd1\x82\xd0\xbe\xd0\xbc \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xbd\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xb2\xd1\x91\xd0\xbc \xd1\x81\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xba\xd1\x83\xd0\xbf\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7 \xd0\xb8\xd0\xbd\xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8 \xd0\xbe \xd1\x82\xd0\xbe\xd0\xbc, \xd0\xba\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xbe\xd0\xbf\xd1\x82\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb5, \xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xbe \xd1\x82\xd0\xbe\xd0\xbc, \xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xd1\x83 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb2\xd1\x88\xd0\xb5\xd0\xb3\xd0\xbe.\xd0\x9f\xd1\x83\xd1\x81\xd1\x82\xd1\x8c \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd0\x91\xd0\xbe\xd0\xb1 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xb2\xd0\xb7\xd1\x8f\xd0\xbb\xd0\xb8 \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb8 18 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9, \xd0\xbd\xd0\xbe \xd0\xb5\xd1\x89\xd1\x91 \xd0\xbd\xd0\xb5 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb\xd0\xb8, \xd0\xba\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc. \xd0\x92\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xb2\xd1\x91\xd0\xbc \xd0\xb0\xd0\xb1\xd1\x81\xd0\xbe\xd0\xbb\xd1\x8e\xd1\x82\xd0\xbd\xd1\x83\xd1\x8e \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd1\x80\xd0\xb5\xd0\xb7\xd1\x83\xd0\xbb\xd1\x8c\xd1\x82\xd0\xb0\xd1\x82\xd0\xb0\xd0\xbc\xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xb2 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0, \xd0\xb8 \xd0\xb2 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\x91\xd0\xbe\xd0\xb1.\xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb2 \xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb8\xd1\x85 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd1\x8f\xd1\x85 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\x91\xd0\xbe\xd0\xb1, \xd0\xbd\xd0\xbe \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5 \xd1\x83 \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd1\x8b \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f 6 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x86\xd0\xb5 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b, \xd0\xb0 \xd0\xb2\xd0\xbe \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc \xe2\x80\x94 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe 2, \xd1\x82\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd1\x80\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xb0 4. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb6\xd0\xb5 \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd1\x83 \xd0\x91\xd0\xbe\xd0\xb1\xd0\xb0 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f 5 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5, \xd0\xb0 \xd0\xb2\xd0\xbe \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\x91\xd0\xbe\xd0\xb1 \xd0\xb8 \xd1\x83 \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd1\x8b \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f 3 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5, \xd1\x82\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd1\x80\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xb0 8.\xd0\xa0\xd0\xb5\xd0\xb1\xd1\x8f\xd1\x82\xd0\xb0 \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f\xd1\x82 \xd1\x83\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x82\xd1\x8c, \xd0\xbd\xd0\xb0\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb1\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xbe\xd0\xb2. \xd0\x9f\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xbc\xd1\x83 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd1\x83 k\xe2\x89\xa413 \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb8\xd0\xbc \xd0\xbd\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5 k \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xbe\xd0\xb2, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd1\x8b \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 \xd0\xbd\xd0\xb8\xd1\x85 \xe2\x80\x94 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0." 2200.0                       
                         1767F "Two Subtrees" "data structures,trees" "You are given a rooted tree consisting of n vertices. The vertex 1 is the root. Each vertex has an integer written on it; this integer is vali for the vertex i.You are given q queries to the tree. The i-th query is represented by two vertices, ui and vi. To answer the query, consider all vertices w that lie in the subtree of ui or vi (if a vertex is in both subtrees, it is counted twice). For all vertices in these two subtrees, list all integers written on them, and find the integer with the maximum number of occurrences. If there are multiple integers with maximum number of occurrences, the minimum among them is the answer." 3100.0                       
                         1766F MCF flows "You are given a graph consisting of n vertices and m directed arcs. The i-th arc goes from the vertex xi to the vertex yi, has capacity ci and weight wi. No arc goes into the vertex 1, and no arc goes from the vertex n. There are no cycles of negative weight in the graph (it is impossible to travel from any vertex to itself in such a way that the total weight of all arcs you go through is negative).You have to assign each arc a flow (an integer between 0 and its capacity, inclusive). For every vertex except 1 and n, the total flow on the arcs going to this vertex must be equal to the total flow on the arcs going from that vertex. Let the flow on the i-th arc be fi, then the cost of the flow is equal to m\xe2\x88\x91i=1fiwi. You have to find a flow which minimizes the cost.Sounds classical, right? Well, we have some additional constraints on the flow on every edge:  if ci is even, fi must be even;  if ci is odd, fi must be odd. Can you solve this problem?" 2800.0                       
                         1766B Notepad# implementation "You want to type the string s, consisting of n lowercase Latin letters, using your favorite text editor Notepad#.Notepad# supports two kinds of operations:   append any letter to the end of the string;  copy a continuous substring of an already typed string and paste this substring to the end of the string. Can you type string s in strictly less than n operations?" 1000.0                       
                         1765J "Hero to Zero" "graph matchings,math" "There are no heroes in this problem. I guess we should have named it ""To Zero"".You are given two arrays a and b, each of these arrays contains n non-negative integers.Let c be a matrix of size n\xc3\x97n such that ci,j=|ai\xe2\x88\x92bj| for every i\xe2\x88\x88[1,n] and every j\xe2\x88\x88[1,n].Your goal is to transform the matrix c so that it becomes the zero matrix, i.\xe2\x80\x89e. a matrix where every element is exactly 0. In order to do so, you may perform the following operations any number of times, in any order:  choose an integer i, then decrease ci,j by 1 for every j\xe2\x88\x88[1,n] (i.\xe2\x80\x89e. decrease all elements in the i-th row by 1). In order to perform this operation, you pay 1 coin;  choose an integer j, then decrease ci,j by 1 for every i\xe2\x88\x88[1,n] (i.\xe2\x80\x89e. decrease all elements in the j-th column by 1). In order to perform this operation, you pay 1 coin;  choose two integers i and j, then decrease ci,j by 1. In order to perform this operation, you pay 1 coin;  choose an integer i, then increase ci,j by 1 for every j\xe2\x88\x88[1,n] (i.\xe2\x80\x89e. increase all elements in the i-th row by 1). When you perform this operation, you receive 1 coin;  choose an integer j, then increase ci,j by 1 for every i\xe2\x88\x88[1,n] (i.\xe2\x80\x89e. increase all elements in the j-th column by 1). When you perform this operation, you receive 1 coin. You have to calculate the minimum number of coins required to transform the matrix c into the zero matrix. Note that all elements of c should be equal to 0 simultaneously after the operations." 2900.0                       
                         1765F "Chemistry Lab" dp,geometry,probabilities "Monocarp is planning on opening a chemistry lab. During the first month, he\'s going to distribute solutions of a certain acid.First, he will sign some contracts with a local chemistry factory. Each contract provides Monocarp with an unlimited supply of some solution of the same acid. The factory provides n contract options, numbered from 1 to n. The i-th solution has a concentration of xi%, the contract costs wi burles, and Monocarp will be able to sell it for ci burles per liter. Monocarp is expecting k customers during the first month. Each customer will buy a liter of a y%-solution, where y is a real number chosen uniformly at random from 0 to 100 independently for each customer. More formally, the probability of number y being less than or equal to some t is P(y\xe2\x89\xa4t)=t100.Monocarp can mix the solution that he signed the contracts with the factory for, at any ratio. More formally, if he has contracts for m solutions with concentrations x1,x2,\xe2\x80\xa6,xm, then, for these solutions, he picks their volumes a1,a2,\xe2\x80\xa6,am so that m\xe2\x88\x91i=1ai=1 (exactly 1 since each customer wants exactly one liter of a certain solution).The concentration of the resulting solution is m\xe2\x88\x91i=1xi\xe2\x8b\x85ai. The price of the resulting solution is m\xe2\x88\x91i=1ci\xe2\x8b\x85ai.If Monocarp can obtain a solution of concentration y%, then he will do it while maximizing its price (the cost for the customer). Otherwise, the customer leaves without buying anything, and the price is considered equal to 0.Monocarp wants to sign some contracts with a factory (possibly, none or all of them) so that the expected profit is maximized \xe2\x80\x94 the expected total price of the sold solutions for all k customers minus the total cost of signing the contracts from the factory.Print the maximum expected profit Monocarp can achieve." 2200.0                       
                         1764H "Doremy\'s Paint 2" "data structures" "Doremy has nn buckets of paint which is represented by an array aa of length nn. Bucket ii contains paint with color aiai. Initially, ai=iai=i.Doremy has mm segments [li,ri][li,ri] (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n). Each segment describes an operation. Operation ii is performed as follows:   For each jj such that li<j\xe2\x89\xa4rili<j\xe2\x89\xa4ri, set aj:=aliaj:=ali. Doremy also selects an integer kk. She wants to know for each integer xx from 00 to m\xe2\x88\x921m\xe2\x88\x921, the number of distinct colors in the array after performing operations xmodm+1,(x+1)modm+1,\xe2\x80\xa6,(x+k\xe2\x88\x921)modm+1xmodm+1,(x+1)modm+1,\xe2\x80\xa6,(x+k\xe2\x88\x921)modm+1. Can you help her calculate these values? Note that for each xx individually we start from the initial array and perform only the given kk operations in the given order." 3400.0                       
                         1762G "Unequal Adjacent Elements" "constructive algorithms,sortings" "You are given an array a consisting of n positive integers. Find any permutation p of [1,2,\xe2\x80\xa6,n] such that:  pi\xe2\x88\x922<pi for all i, where 3\xe2\x89\xa4i\xe2\x89\xa4n, and  api\xe2\x88\x921\xe2\x89\xa0api for all i, where 2\xe2\x89\xa4i\xe2\x89\xa4n. Or report that no such permutation exists." 3100.0                       
                         1762E "Tree Sum" combinatorics,math,trees "Let us call an edge-weighted tree with n vertices numbered from 1 to n good if the weight of each edge is either 1 or \xe2\x88\x921 and for each vertex i, the product of the edge weights of all edges having i as one endpoint is \xe2\x88\x921.You are given a positive integer n. There are nn\xe2\x88\x922\xe2\x8b\x852n\xe2\x88\x921 distinct\xe2\x80\xa0 edge-weighted trees with n vertices numbered from 1 to n such that each edge is either 1 or \xe2\x88\x921. Your task is to find the sum of d(1,n)\xe2\x80\xa1 of all such trees that are good. Since the answer can be quite large, you only need to find it modulo 998244353.\xe2\x80\xa0 Two trees are considered to be distinct if either:   there exists two vertices such that there is an edge between them in one of the trees, and not in the other.  there exists two vertices such that there is an edge between them in both trees but the weight of the edge between them in one tree is different from the one in the other tree. Note that by Cayley\'s formula, the number of trees on n labeled vertices is nn\xe2\x88\x922. Since we have n\xe2\x88\x921 edges, there are 2n\xe2\x88\x921 possible assignment of weights(weight can either be 1 or \xe2\x88\x921). That is why total number of distinct edge-weighted tree is nn\xe2\x88\x922\xe2\x8b\x852n\xe2\x88\x921.\xe2\x80\xa1 d(u,v) denotes the sum of the weight of all edges on the unique simple path from u to v." 2600.0                       
                         1761D "Carry Bit" combinatorics,math "Let f(x,y) be the number of carries of x+y in binary (i. e. f(x,y)=g(x)+g(y)\xe2\x88\x92g(x+y), where g(x) is the number of ones in the binary representation of x).Given two integers n and k, find the number of ordered pairs (a,b) such that 0\xe2\x89\xa4a,b<2n, and f(a,b) equals k. Note that for a\xe2\x89\xa0b, (a,b) and (b,a) are considered as two different pairs. As this number may be large, output it modulo 109+7." 2100.0                       
                         1759E "The Humanoid" "brute force,dp,sortings" "There are n astronauts working on some space station. An astronaut with the number i (1\xe2\x89\xa4i\xe2\x89\xa4n) has power ai.An evil humanoid has made his way to this space station. The power of this humanoid is equal to h. Also, the humanoid took with him two green serums and one blue serum.In one second , a humanoid can do any of three actions:  to absorb an astronaut with power strictly less humanoid power;  to use green serum, if there is still one left;  to use blue serum, if there is still one left. When an astronaut with power ai is absorbed, this astronaut disappears, and power of the humanoid increases by \xe2\x8c\x8aai2\xe2\x8c\x8b, that is, an integer part of ai2. For example, if a humanoid absorbs an astronaut with power 4, its power increases by 2, and if a humanoid absorbs an astronaut with power 7, its power increases by 3.After using the green serum, this serum disappears, and the power of the humanoid doubles, so it increases by 2 times.After using the blue serum, this serum disappears, and the power of the humanoid triples, so it increases by 3 times.The humanoid is wondering what the maximum number of astronauts he will be able to absorb if he acts optimally." 1500.0                       
                         1758E "Tick, Tock" "combinatorics,dfs and similar,dsu,graphs" "Tannhaus, the clockmaker in the town of Winden, makes mysterious clocks that measure time in h hours numbered from 0 to h\xe2\x88\x921. One day, he decided to make a puzzle with these clocks. The puzzle consists of an n\xc3\x97m grid of clocks, and each clock always displays some hour exactly (that is, it doesn\'t lie between two hours). In one move, he can choose any row or column and shift all clocks in that row or column one hour forward\xe2\x80\xa0.The grid of clocks is called solvable if it is possible to make all the clocks display the same time.While building his puzzle, Tannhaus suddenly got worried that it might not be possible to make the grid solvable. Some cells of the grid have clocks already displaying a certain initial time, while the rest of the cells are empty.Given the partially completed grid of clocks, find the number of ways\xe2\x80\xa1 to assign clocks in the empty cells so that the grid is solvable. The answer can be enormous, so compute it modulo 109+7.\xe2\x80\xa0 If a clock currently displays hour t and is shifted one hour forward, then the clock will instead display hour (t+1)modh.\xe2\x80\xa1 Two assignments are different if there exists some cell with a clock that displays a different time in both arrangements." 2500.0                       
                         1754A "Technical Support" greedy "You work in the quality control department of technical support for a large company. Your job is to make sure all client issues have been resolved.Today you need to check a copy of a dialog between a client and a technical support manager. According to the rules of work, each message of the client must be followed by one or several messages, which are the answer of a support manager. However, sometimes clients ask questions so quickly that some of the manager\'s answers to old questions appear after the client has asked some new questions.Due to the privacy policy, the full text of messages is not available to you, only the order of messages is visible, as well as the type of each message: a customer question or a response from the technical support manager. It is guaranteed that the dialog begins with the question of the client.You have to determine, if this dialog may correspond to the rules of work described above, or the rules are certainly breached." 800.0                       
                         1753E "N Machines" "binary search,brute force,greedy" "You have been invited as a production process optimization specialist to some very large company. The company has n machines at its factory, standing one behind another in the production chain. Each machine can be described in one of the following two ways: (+, ai) or (\xe2\x88\x97, ai).If a workpiece with the value x is supplied to the machine of kind (+, ai), then the output workpiece has value x+ai.If a workpiece with the value x is supplied to the machine of kind (\xe2\x88\x97, ai), then the output workpiece has value x\xe2\x8b\x85ai.The whole production process is as follows. The workpiece with the value 1 is supplied to the first machine, then the workpiece obtained after the operation of the first machine is supplied to the second machine, then the workpiece obtained after the operation of the second machine is supplied to the third machine, and so on. The company is not doing very well, so now the value of the resulting product does not exceed 2\xe2\x8b\x85109.The directors of the company are not satisfied with the efficiency of the production process and have given you a budget of b coins to optimize it.To optimize production you can change the order of machines in the chain. Namely, by spending p coins, you can take any machine of kind (+, ai) and move it to any place in the chain without changing the order of other machines. Also, by spending m coins, you can take any machine of kind (\xe2\x88\x97, ai) and move it to any place in the chain.What is the maximum value of the resulting product that can be achieved if the total cost of movements that are made should not exceed b coins?" 3300.0                       
                         1753D "The Beach" "constructive algorithms,dfs and similar,graphs,shortest paths" "Andrew loves the sea. That\'s why, at the height of the summer season, he decided to go to the beach, taking a sunbed with him to sunbathe.The beach is a rectangular field with n rows and m columns. Some cells of the beach are free, some have roads, stones, shops and other non-movable objects. Some of two adjacent along the side cells can have sunbeds located either horizontally or vertically.Andrew hopes to put his sunbed somewhere, but that\'s a bad luck, there may no longer be free places for him! That\'s why Andrew asked you to help him to find a free place for his sunbed. Andrew\'s sunbed also should be places on two adjacent cells. If there are no two adjacent free cells, then in order to free some place for a sunbed, you will have to disturb other tourists. You can do the following actions:  Come to some sunbed and, after causing p units of discomfort to its owner, lift the sunbed by one of its sides and rotate it by 90 degrees. One half of the sunbed must remain in the same cell and another half of the sunbed must move to the free cell. At the same time, anything could be on the way of a sunbed during the rotation .  Rotation of the sunbed by 90 degrees around cell (1,2).  Come to some sunbed and, after causing q units of discomfort to its owner, shift the sunbed along its long side by one cell. One half of the sunbed must move to the place of another, and another \xe2\x80\x94 to the free cell.  Shift of the sunbed by one cell to the right. In any moment each sunbed occupies two adjacent free cells. You cannot move more than one sunbed at a time.Help Andrew to free a space for his sunbed, causing the minimum possible number of units of discomfort to other tourists, or detect that it is impossible." 2400.0                       
                         1750C "Complementary XOR" "constructive algorithms,implementation" "You have two binary strings a and b of length n. You would like to make all the elements of both strings equal to 0. Unfortunately, you can modify the contents of these strings using only the following operation:  You choose two indices l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n);  For every i that respects l\xe2\x89\xa4i\xe2\x89\xa4r, change ai to the opposite. That is, ai:=1\xe2\x88\x92ai;  For every i that respects either 1\xe2\x89\xa4i<l or r<i\xe2\x89\xa4n, change bi to the opposite. That is, bi:=1\xe2\x88\x92bi. Your task is to determine if this is possible, and if it is, to find such an appropriate chain of operations. The number of operations should not exceed n+5. It can be proven that if such chain of operations exists, one exists with at most n+5 operations." 1400.0                       
                         1749D "Counting Arrays" "combinatorics,dp,math,number theory" "Consider an array a of length n with elements numbered from 1 to n. It is possible to remove the i-th element of a if gcd(ai,i)=1, where gcd denotes the greatest common divisor. After an element is removed, the elements to the right are shifted to the left by one position.An array b with n integers such that 1\xe2\x89\xa4bi\xe2\x89\xa4n\xe2\x88\x92i+1 is a removal sequence for the array a if it is possible to remove all elements of a, if you remove the b1-th element, then the b2-th, ..., then the bn-th element. For example, let a=[42,314]:  [1,1] is a removal sequence: when you remove the 1-st element of the array, the condition gcd(42,1)=1 holds, and the array becomes [314]; when you remove the 1-st element again, the condition gcd(314,1)=1 holds, and the array becomes empty.  [2,1] is not a removal sequence: when you try to remove the 2-nd element, the condition gcd(314,2)=1 is false. An array is ambiguous if it has at least two removal sequences. For example, the array [1,2,5] is ambiguous: it has removal sequences [3,1,1] and [1,2,1]. The array [42,314] is not ambiguous: the only removal sequence it has is [1,1].You are given two integers n and m. You have to calculate the number of ambiguous arrays a such that the length of a is from 1 to n and each ai is an integer from 1 to m." 1900.0                       
                         1749B "Death\'s Blessing" greedy "You are playing a computer game. To pass the current level, you have to kill a big horde of monsters. In this horde, there are n monsters standing in the row, numbered from 1 to n. The i-th monster has ai health and a special ""Death\'s Blessing"" spell of strength bi attached to it.You are going to kill all of them one by one. It takes exactly h seconds to kill a monster with health h.When the i-th monster dies, it casts its spell that increases the health of its neighbors by bi (the neighbors of the j-th monster in the row are the monsters on places j\xe2\x88\x921 and j+1. The first and the last monsters have only one neighbor each).After each monster is killed, the row shrinks, so its former neighbors become adjacent to each other (so if one of them dies, the other one is affected by its spell). For example, imagine a situation with 4 monsters with health a=[2,6,7,3] and spells b=[3,6,0,5]. One of the ways to get rid of the monsters is shown below:  26736 s\xe2\x86\x92813313 s\xe2\x86\x92838 s\xe2\x86\x9266 s\xe2\x86\x92{}3605305355 The first row represents the health of each monster, the second one \xe2\x80\x94 the power of the spells. As a result, we can kill all monsters in 6+13+8+6 = 33 seconds. Note that it\'s only an example and may not be the fastest way to get rid of the monsters.What is the minimum time required to kill all monsters in the row?" 900.0                       
                         1748D ConstructOR "bitmasks,chinese remainder theorem,combinatorics,constructive algorithms,math,number theory" "You are given three integers a, b, and d. Your task is to find any integer x which satisfies all of the following conditions, or determine that no such integers exist:  0\xe2\x89\xa4x<260;  a|x is divisible by d;  b|x is divisible by d. Here, | denotes the bitwise OR operation." 2100.0                       
                         1748A "The Ultimate Square" math "You have n rectangular wooden blocks, which are numbered from 1 to n. The i-th block is 1 unit high and \xe2\x8c\x88i2\xe2\x8c\x89 units long.Here, \xe2\x8c\x88x2\xe2\x8c\x89 denotes the result of division of x by 2, rounded up. For example, \xe2\x8c\x8842\xe2\x8c\x89=2 and \xe2\x8c\x8852\xe2\x8c\x89=\xe2\x8c\x882.5\xe2\x8c\x89=3.For example, if n=5, then the blocks have the following sizes: 1\xc3\x971, 1\xc3\x971, 1\xc3\x972, 1\xc3\x972, 1\xc3\x973.  The available blocks for n=5 Find the maximum possible side length of a square you can create using these blocks, without rotating any of them. Note that you don\'t have to use all of the blocks.  One of the ways to create 3\xc3\x973 square using blocks 1 through 5" 800.0                       
                         1744B "Even-Odd Increments" implementation,math "You are given n of integers a1,a2,\xe2\x80\xa6,an. Process q queries of two types: query of the form ""0 xj"": add the value xj to all even elements of the array a, query of the form ""1 xj"": add the value xj to all odd elements of the array a.Note that when processing the query, we look specifically at the odd/even value of ai, not its index.After processing each query, print the sum of the elements of the array a.Please note that the answer for some test cases won\'t fit into 32-bit integer type, so you should use at least 64-bit integer type in your programming language (like long long for C++)." 800.0                       
                         1740H "MEX Tree Manipulation" "data structures,trees" "Given a rooted tree, define the value of vertex u in the tree recursively as the MEX\xe2\x80\xa0 of the values of its children. Note that it is only the children, not all of its descendants. In particular, the value of a leaf is 0.Pak Chanek has a rooted tree that initially only contains a single vertex with index 1, which is the root. Pak Chanek is going to do q queries. In the i-th query, Pak Chanek is given an integer xi. Pak Chanek needs to add a new vertex with index i+1 as the child of vertex xi. After adding the new vertex, Pak Chanek needs to recalculate the values of all vertices and report the sum of the values of all vertices in the current tree.\xe2\x80\xa0 The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For example, the MEX of [0,1,1,2,6,7] is 3 and the MEX of [6,9] is 0." 3300.0                       
                         1737G "Ela Takes Dancing Class" "binary search,data structures" "DTL engineers love partying in the weekend. Ela does, too! Unfortunately, she didn\'t know how to dance yet. Therefore, she decided to take a dancing class.There are n students in the dancing class, including Ela. In the final project, n students will participate in a choreography described below.n students are positioned on the positive side of the Ox-axis. The i-th dancer is located at ai>0. Some dancers will change positions during the dance (we\'ll call them movable dancers), and others will stay in the same place during a choreography (we\'ll call them immovable dancers). We distinguish the dancers using a binary string s of length n: if si equals \'1\', then the i-th dancer is movable, otherwise the i-th dancer is immovable.Let\'s call the ""positive energy value"" of the choreography d>0. The dancers will perform ""movements"" based on this value.Each minute after the dance begins, the movable dancer with the smallest x-coordinate will start moving to the right and initiate a ""movement"". At the beginning of the movement, the dancer\'s energy level will be initiated equally to the positive energy value of the choreography, which is d. Each time they move from some y to y+1, the energy level will be decreased by 1. At some point, the dancer might meet other fellow dancers in the same coordinates. If it happens, then the energy level of the dancer will be increased by 1. A dancer will stop moving to the right when his energy level reaches 0, and he doesn\'t share a position with another dancer.The dancers are very well-trained, and each ""movement"" will end before the next minute begins.To show her understanding of this choreography, Ela has to answer q queries, each consisting of two integers k and m. The answer to this query is the coordinate of the m-th dancer of both types from the left at k-th minute after the choreography begins. In other words, denote xk,1,xk,2,\xe2\x80\xa6,xk,n as the sorted coordinates of the dancers at k-th minute from the beginning, you need to print xk,m." 3500.0                       
                         1735E "House Planning" "constructive algorithms,data structures,graph matchings,greedy" "There are n houses in your city arranged on an axis at points h1,h2,\xe2\x80\xa6,hn. You want to build a new house for yourself and consider two options where to place it: points p1 and p2.As you like visiting friends, you have calculated in advance the distances from both options to all existing houses. More formally, you have calculated two arrays d1, d2: di,j=|pi\xe2\x88\x92hj|, where |x| defines the absolute value of x.After a long time of inactivity you have forgotten the locations of the houses h and the options p1, p2. But your diary still keeps two arrays \xe2\x80\x94 d1, d2, whose authenticity you doubt. Also, the values inside each array could be shuffled, so values at the same positions of d1 and d2 may correspond to different houses. Pay attention, that values from one array could not get to another, in other words, all values in the array d1 correspond the distances from p1 to the houses, and in the array d2  \xe2\x80\x94 from p2 to the houses.Also pay attention, that the locations of the houses hi and the considered options pj could match. For example, the next locations are correct: h={1,0,3,3}, p={1,1}, that could correspond to already shuffled d1={0,2,1,2}, d2={2,2,1,0}.Check whether there are locations of houses h and considered points p1, p2, for which the founded arrays of distances would be correct. If it is possible, find appropriate locations of houses and considered options." 2400.0                       
                         1734D "Slime Escape" "data structures,dp,greedy,two pointers" "You are playing a game called Slime Escape. The game takes place on a number line. Initially, there are n slimes. For all positive integers i where 1\xe2\x89\xa4i\xe2\x89\xa4n, the i-th slime is located at position i and has health ai. You are controlling the slime at position k. There are two escapes located at positions 0 and n+1. Your goal is to reach any one of the two escapes by performing any number of game moves.In one game move, you move your slime to the left or right by one position. However, if there is another slime in the new position, you must absorb it. When absorbing a slime, the health of your slime would be increased by the health of the absorbed slime, then the absorbed slime would be removed from the game.Note that some slimes might have negative health, so your health would decrease when absorbing such slimes. You lose the game immediately if your slime has negative health at any moment during the game.Can you reach one of two escapes by performing any number of game moves, without ever losing the game?" 1800.0                       
                         1732D2 "Balance (Hard version)" "brute force,data structures,number theory" "This is the hard version of the problem. The only difference is that in this version there are remove queries.Initially you have a set containing one element \xe2\x80\x94 0. You need to handle q queries of the following types:+ x \xe2\x80\x94 add the integer x to the set. It is guaranteed that this integer is not contained in the set; - x \xe2\x80\x94 remove the integer x from the set. It is guaranteed that this integer is contained in the set; ? k \xe2\x80\x94 find the k-mex of the set. In our problem, we define the k-mex of a set of integers as the smallest non-negative integer x that is divisible by k and which is not contained in the set." 2400.0                       
                         1732C2 "Sheikh (Hard Version)" "binary search,bitmasks,brute force,greedy,implementation,two pointers" "This is the hard version of the problem. The only difference is that in this version q=n.You are given an array of integers a1,a2,\xe2\x80\xa6,an.The cost of a subsegment of the array [l,r], 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, is the value f(l,r)=sum(l,r)\xe2\x88\x92xor(l,r), where sum(l,r)=al+al+1+\xe2\x80\xa6+ar, and xor(l,r)=al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar (\xe2\x8a\x95 stands for bitwise XOR).You will have q queries. Each query is given by a pair of numbers Li, Ri, where 1\xe2\x89\xa4Li\xe2\x89\xa4Ri\xe2\x89\xa4n. You need to find the subsegment [l,r], Li\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4Ri, with maximum value f(l,r). If there are several answers, then among them you need to find a subsegment with the minimum length, that is, the minimum value of r\xe2\x88\x92l+1." 2100.0                       
                         1731D "Valiant\'s New Map" "binary search,brute force,data structures,dp,two pointers" "Game studio ""DbZ Games"" wants to introduce another map in their popular game ""Valiant"". This time, the map named ""Panvel"" will be based on the city of Mumbai.Mumbai can be represented as n\xc3\x97m cellular grid. Each cell (i,j) (1\xe2\x89\xa4i\xe2\x89\xa4n; 1\xe2\x89\xa4j\xe2\x89\xa4m) of the grid is occupied by a cuboid building of height ai,j.This time, DbZ Games want to make a map that has perfect vertical gameplay. That\'s why they want to choose an l\xc3\x97l square inside Mumbai, such that each building inside the square has a height of at least l.Can you help DbZ Games find such a square of the maximum possible size l?" 1700.0                       
                         1730F "Almost Sorted" "bitmasks,data structures,dp" "You are given a permutation p of length n and a positive integer k. Consider a permutation q of length n such that for any integers i and j, where 1\xe2\x89\xa4i<j\xe2\x89\xa4n, we have pqi\xe2\x89\xa4pqj+k.Find the minimum possible number of inversions in a permutation q.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).An inversion in a permutation a is a pair of indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that i<j, but ai>aj." 2700.0                       
                         1730C "Minimum Notation" "data structures,greedy,math,sortings" "You have a string s consisting of digits from 0 to 9 inclusive. You can perform the following operation any (possibly zero) number of times:   You can choose a position i and delete a digit d on the i-th position. Then insert the digit min(d+1,9) on any position (at the beginning, at the end or in between any two adjacent digits). What is the lexicographically smallest string you can get by performing these operations?A string a is lexicographically smaller than a string b of the same length if and only if the following holds:   in the first position where a and b differ, the string a has a smaller digit than the corresponding digit in b." 1200.0                       
                         1726F "Late For Work (submissions are not allowed)" "data structures,greedy,schedules,shortest paths" "This problem was copied by the author from another online platform. Codeforces strongly condemns this action and therefore further submissions to this problem are not accepted.Debajyoti has a very important meeting to attend and he is already very late. Harsh, his driver, needs to take Debajyoti to the destination for the meeting as fast as possible.Harsh needs to pick up Debajyoti from his home and take him to the destination so that Debajyoti can attend the meeting in time. A straight road with n traffic lights connects the home and the destination for the interview. The traffic lights are numbered in order from 1 to n.Each traffic light cycles after t seconds. The i-th traffic light is green (in which case Harsh can cross the traffic light) for the first gi seconds, and red (in which case Harsh must wait for the light to turn green) for the remaining (t\xe2\x88\x92gi) seconds, after which the pattern repeats. Each light\'s cycle repeats indefinitely and initially, the i-th light is ci seconds into its cycle (a light with ci=0 has just turned green). In the case that Harsh arrives at a light at the same time it changes colour, he will obey the new colour. Formally, the i-th traffic light is green from [0,gi) and red from [gi,t) (after which it repeats the cycle). The i-th traffic light is initially at the ci-th second of its cycle.From the i-th traffic light, exactly di seconds are required to travel to the next traffic light (that is to the (i+1)-th light). Debajyoti\'s home is located just before the first light and Debajyoti drops for the interview as soon as he passes the n-th light. In other words, no time is required to reach the first light from Debajyoti\'s home or to reach the interview centre from the n-th light.Harsh does not know how much longer it will take for Debajyoti to get ready. While waiting, he wonders what is the minimum possible amount of time he will spend driving provided he starts the moment Debajyoti arrives, which can be anywhere between 0 to \xe2\x88\x9e seconds from now. Can you tell Harsh the minimum possible amount of time he needs to spend on the road?Please note that Harsh can only start or stop driving at integer moments of time." 2900.0                       
                         1726E "Almost Perfect" combinatorics,fft,math "A permutation p of length n is called almost perfect if for all integer 1\xe2\x89\xa4i\xe2\x89\xa4n, it holds that |pi\xe2\x88\x92p\xe2\x88\x921i|\xe2\x89\xa41, where p\xe2\x88\x921 is the inverse permutation of p (i.e. p\xe2\x88\x921k1=k2 if and only if pk2=k1).Count the number of almost perfect permutations of length n modulo 998244353." 2400.0                       
                         1726C "Jatayu\'s Balanced Bracket Sequence" "data structures,dsu,graphs,greedy" "Last summer, Feluda gifted Lalmohan-Babu a balanced bracket sequence ss of length 2n2n.Topshe was bored during his summer vacations, and hence he decided to draw an undirected graph of 2n2n vertices using the balanced bracket sequence ss. For any two distinct vertices ii and jj (1\xe2\x89\xa4i<j\xe2\x89\xa42n1\xe2\x89\xa4i<j\xe2\x89\xa42n), Topshe draws an edge (undirected and unweighted) between these two nodes if and only if the subsegment s[i\xe2\x80\xa6j]s[i\xe2\x80\xa6j] forms a balanced bracket sequence.Determine the number of connected components in Topshe\'s graph.See the Notes section for definitions of the underlined terms." 1300.0                       
                         1725K "Kingdom of Criticism" "data structures,dsu" "Pak Chanek is visiting a kingdom that earned a nickname ""Kingdom of Criticism"" because of how often its residents criticise each aspect of the kingdom. One aspect that is often criticised is the heights of the buildings. The kingdom has N buildings. Initially, building i has a height of Ai units.At any point in time, the residents can give a new criticism, namely they currently do not like buildings with heights between l and r units inclusive for some two integers l and r. It is known that r\xe2\x88\x92l is always odd.In 1 minute, the kingdom\'s construction team can increase or decrease the height of any building by 1 unit as long as the height still becomes a positive number. Each time they receive the current criticism from the residents, the kingdom\'s construction team makes it so that there are no buildings with heights between l and r units inclusive in the minimum time possible. It can be obtained that there is only one way to do this. Note that the construction team only cares about the current criticism from the residents. All previous criticisms are forgotten.There will be Q queries that you must solve. Each query is one of the three following possibilities:   1 k w: The kingdom\'s construction team changes the height of building k to be w units (1\xe2\x89\xa4k\xe2\x89\xa4N, 1\xe2\x89\xa4w\xe2\x89\xa4109).  2 k: The kingdom\'s construction team wants you to find the height of building k (1\xe2\x89\xa4k\xe2\x89\xa4N).  3 l r: The residents currently do not like buildings with heights between l and r units inclusive (2\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4109\xe2\x88\x921, r\xe2\x88\x92l is odd). Note that each change in height still persists to the next queries." 2500.0                       
                              1720A "Burenka Plays with Fractions" "math,number theory" "Burenka came to kindergarden. This kindergarten is quite strange, so each kid there receives two fractions (ab and cd) with integer numerators and denominators. Then children are commanded to play with their fractions.Burenka is a clever kid, so she noticed that when she claps once, she can multiply numerator or denominator of one of her two fractions by any integer of her choice (but she can\'t multiply denominators by 0). Now she wants know the minimal number of claps to make her fractions equal (by value). Please help her and find the required number of claps!" 900.0                  
                              1716B "Permutation Chain" "constructive algorithms,math" "A permutation of length n is a sequence of integers from 1 to n such that each integer appears in it exactly once.Let the fixedness of a permutation p be the number of fixed points in it \xe2\x80\x94 the number of positions j such that pj=j, where pj is the j-th element of the permutation p.You are asked to build a sequence of permutations a1,a2,\xe2\x80\xa6, starting from the identity permutation (permutation a1=[1,2,\xe2\x80\xa6,n]). Let\'s call it a permutation chain. Thus, ai is the i-th permutation of length n.For every i from 2 onwards, the permutation ai should be obtained from the permutation ai\xe2\x88\x921 by swapping any two elements in it (not necessarily neighboring). The fixedness of the permutation ai should be strictly lower than the fixedness of the permutation ai\xe2\x88\x921.Consider some chains for n=3:  a1=[1,2,3], a2=[1,3,2] \xe2\x80\x94 that is a valid chain of length 2. From a1 to a2, the elements on positions 2 and 3 get swapped, the fixedness decrease from 3 to 1.  a1=[2,1,3], a2=[3,1,2] \xe2\x80\x94 that is not a valid chain. The first permutation should always be [1,2,3] for n=3.  a1=[1,2,3], a2=[1,3,2], a3=[1,2,3] \xe2\x80\x94 that is not a valid chain. From a2 to a3, the elements on positions 2 and 3 get swapped but the fixedness increase from 1 to 3.  a1=[1,2,3], a2=[3,2,1], a3=[3,1,2] \xe2\x80\x94 that is a valid chain of length 3. From a1 to a2, the elements on positions 1 and 3 get swapped, the fixedness decrease from 3 to 1. From a2 to a3, the elements on positions 2 and 3 get swapped, the fixedness decrease from 1 to 0. Find the longest permutation chain. If there are multiple longest answers, print any of them." 800.0                  
                              1714D "Color with Occurrences" "brute force,data structures,dp,greedy,strings" "You are given some text t and a set of n strings s1,s2,\xe2\x80\xa6,sn. In one step, you can choose any occurrence of any string si in the text t and color the corresponding characters of the text in red. For example, if t=bababa and s1=ba, s2=aba, you can get t=bababa, t=bababa or t=bababa in one step.You want to color all the letters of the text t in red. When you color a letter in red again, it stays red.In the example above, three steps are enough:  Let\'s color t[2\xe2\x80\xa64]=s2=aba in red, we get t=bababa;  Let\'s color t[1\xe2\x80\xa62]=s1=ba in red, we get t=bababa;  Let\'s color t[4\xe2\x80\xa66]=s2=aba in red, we get t=bababa. Each string si can be applied any number of times (or not at all). Occurrences for coloring can intersect arbitrarily.Determine the minimum number of steps needed to color all letters t in red and how to do it. If it is impossible to color all letters of the text t in red, output -1." 1600.0                  
                              1714C "Minimum  Varied Number" greedy "Find the minimum number with the given sum of digits s such that all digits in it are distinct (i.e. all digits are unique).For example, if s=20, then the answer is 389. This is the minimum number in which all digits are different and the sum of the digits is 20 (3+8+9=20).For the given s print the required number." 800.0                  
                              1713D "Tournament Countdown" "constructive algorithms,greedy,interactive,number theory,probabilities" "This is an interactive problem.There was a tournament consisting of 2n contestants. The 1-st contestant competed with the 2-nd, the 3-rd competed with the 4-th, and so on. After that, the winner of the first match competed with the winner of second match, etc. The tournament ended when there was only one contestant left, who was declared the winner of the tournament. Such a tournament scheme is known as the single-elimination tournament.You don\'t know the results, but you want to find the winner of the tournament. In one query, you select two integers a and b, which are the indices of two contestants. The jury will return 1 if a won more matches than b, 2 if b won more matches than a, or 0 if their number of wins was equal.Find the winner in no more than \xe2\x8c\x8813\xe2\x8b\x852n+1\xe2\x8c\x89 queries. Here \xe2\x8c\x88x\xe2\x8c\x89 denotes the value of x rounded up to the nearest integer.Note that the tournament is long over, meaning that the results are fixed and do not depend on your queries." 1800.0                  
                              1711A "Perfect Permutation" "constructive algorithms" "You are given a positive integer n.The weight of a permutation p1,p2,\xe2\x80\xa6,pn is the number of indices 1\xe2\x89\xa4i\xe2\x89\xa4n such that i divides pi. Find a permutation p1,p2,\xe2\x80\xa6,pn with the minimum possible weight (among all permutations of length n).A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 800.0                  
                              1710E "Two Arrays" "binary search,games,graph matchings" "You are given two arrays of integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bm. Alice and Bob are going to play a game. Alice moves first and they take turns making a move.They play on a grid of size n\xc3\x97m (a grid with n rows and m columns). Initially, there is a rook positioned on the first row and first column of the grid.During her/his move, a player can do one of the following two operations:  Move the rook to a different cell on the same row or the same column of the current cell. A player cannot move the rook to a cell that has been visited 1000 times before (i.e., the rook can stay in a certain cell at most 1000 times during the entire game). Note that the starting cell is considered to be visited once at the beginning of the game. End the game immediately with a score of ar+bc, where (r,c) is the current cell (i.e., the rook is on the r-th row and c-th column). Bob wants to maximize the score while Alice wants to minimize it. If they both play this game optimally, what is the final score of the game?" 2400.0                  
                              1708B "Difference of GCDs" "constructive algorithms,math" "You are given three integers n, l, and r. You need to construct an array a1,a2,\xe2\x80\xa6,an (l\xe2\x89\xa4ai\xe2\x89\xa4r) such that gcd(i,ai) are all distinct or report there\'s no solution.Here gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y." 1100.0                  
                                  1600.0 1523C "Compression and Expansion" "brute force,data structures,greedy,implementation,trees" "William is a huge fan of planning ahead. That is why he starts his morning routine by creating a nested list of upcoming errands.A valid nested list is any list which can be created from a list with one item ""1"" by applying some operations. Each operation inserts a new item into the list, on a new line, just after one of existing items a1.a2.a3.\xe2\x8b\xaf.ak and can be one of two types:   Add an item a1.a2.a3.\xe2\x8b\xaf.ak.1 (starting a list of a deeper level), or  Add an item a1.a2.a3.\xe2\x8b\xaf.(ak+1) (continuing the current level).  Operation can only be applied if the list does not contain two identical items afterwards. And also, if we consider every item as a sequence of numbers, then the sequence of items should always remain increasing in lexicographical order. Examples of valid and invalid lists that are shown in the picture can found in the ""Notes"" section.When William decided to save a Word document with the list of his errands he accidentally hit a completely different keyboard shortcut from the ""Ctrl-S"" he wanted to hit. It\'s not known exactly what shortcut he pressed but after triggering it all items in the list were replaced by a single number: the last number originally written in the item number.William wants you to help him restore a fitting original nested list."              
                                  800.0 1523A "Game of Life" implementation "William really likes the cellular automaton called ""Game of Life"" so he decided to make his own version. For simplicity, William decided to define his cellular automaton on an array containing n cells, with each cell either being alive or dead.Evolution of the array in William\'s cellular automaton occurs iteratively in the following way:  If the element is dead and it has exactly 1 alive neighbor in the current state of the array, then on the next iteration it will become alive. For an element at index i the neighbors would be elements with indices i\xe2\x88\x921 and i+1. If there is no element at that index, it is considered to be a dead neighbor.  William is a humane person so all alive elements stay alive. Check the note section for examples of the evolution.You are given some initial state of all elements and you need to help William find the state of the array after m iterations of evolution."              
                                  2500.0 1521D "Nastia Plays with a Tree" "constructive algorithms,data structures,dfs and similar,dp,dsu,greedy,implementation,trees" "Nastia has an unweighted tree with n vertices and wants to play with it!The girl will perform the following operation with her tree, as long as she needs:  Remove any existing edge.  Add an edge between any pair of vertices. What is the minimum number of operations Nastia needs to get a bamboo from a tree? A bamboo is a tree in which no node has a degree greater than 2."              
                                  1000.0 1520C "Not Adjacent Matrix" "constructive algorithms" "We will consider the numbers a and b as adjacent if they differ by exactly one, that is, |a\xe2\x88\x92b|=1.We will consider cells of a square matrix n\xc3\x97n as adjacent if they have a common side, that is, for cell (r,c) cells (r,c\xe2\x88\x921), (r,c+1), (r\xe2\x88\x921,c) and (r+1,c) are adjacent to it.For a given number n, construct a square matrix n\xc3\x97n such that:   Each integer from 1 to n2 occurs in this matrix exactly once;  If (r1,c1) and (r2,c2) are adjacent cells, then the numbers written in them must not be adjacent."              
                                  2700.0 1519E "Off by One" "constructive algorithms,dfs and similar,geometry,graphs,sortings,trees" "There are n points on an infinite plane. The i-th point has coordinates (xi,yi) such that xi>0 and yi>0. The coordinates are not necessarily integer.In one move you perform the following operations:   choose two points a and b (a\xe2\x89\xa0b);  move point a from (xa,ya) to either (xa+1,ya) or (xa,ya+1);  move point b from (xb,yb) to either (xb+1,yb) or (xb,yb+1);  remove points a and b. However, the move can only be performed if there exists a line that passes through the new coordinates of a, new coordinates of b and (0,0). Otherwise, the move can\'t be performed and the points stay at their original coordinates (xa,ya) and (xb,yb), respectively.The numeration of points does not change after some points are removed. Once the points are removed, they can\'t be chosen in any later moves. Note that you have to move both points during the move, you can\'t leave them at their original coordinates.What is the maximum number of moves you can perform? What are these moves?If there are multiple answers, you can print any of them."              
                                  800.0 1517A "Sum of 2050" greedy,math "A number is called 2050-number if it is 2050, 20500, ..., (2050\xe2\x8b\x8510k for integer k\xe2\x89\xa50).Given a number n, you are asked to represent n as the sum of some (not necessarily distinct) 2050-numbers. Compute the minimum number of 2050-numbers required for that."              
                                  1700.0 1516C "Baby Ehab Partitions Again" "bitmasks,constructive algorithms,dp,math" "Baby Ehab was toying around with arrays. He has an array a of length n. He defines an array to be good if there\'s no way to partition it into 2 subsequences such that the sum of the elements in the first is equal to the sum of the elements in the second. Now he wants to remove the minimum number of elements in a so that it becomes a good array. Can you help him?A sequence b is a subsequence of an array a if b can be obtained from a by deleting some (possibly zero or all) elements. A partitioning of an array is a way to divide it into 2 subsequences such that every element belongs to exactly one subsequence, so you must use all the elements, and you can\'t share any elements."              
                                  1500.0 1516B "AGAGA XOOORRR" "bitmasks,brute force,dp,greedy" "Baby Ehab is known for his love for a certain operation. He has an array a of length n, and he decided to keep doing the following operation on it:   he picks 2 adjacent elements; he then removes them and places a single integer in their place: their bitwise XOR. Note that the length of the array decreases by one. Now he asks you if he can make all elements of the array equal. Since babies like to make your life harder, he requires that you leave at least 2 elements remaining."              
                                  2200.0 1515E "Phoenix and Computers" combinatorics,dp,math "There are n computers in a row, all originally off, and Phoenix wants to turn all of them on. He will manually turn on computers one at a time. At any point, if computer i\xe2\x88\x921 and computer i+1 are both on, computer i (2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) will turn on automatically if it is not already on. Note that Phoenix cannot manually turn on a computer that already turned on automatically.If we only consider the sequence of computers that Phoenix turns on manually, how many ways can he turn on all the computers? Two sequences are distinct if either the set of computers turned on manually is distinct, or the order of computers turned on manually is distinct. Since this number may be large, please print it modulo M."              
                                  800.0 1515A "Phoenix and Gold" "constructive algorithms,greedy,math" "Phoenix has collected n pieces of gold, and he wants to weigh them together so he can feel rich. The i-th piece of gold has weight wi. All weights are distinct. He will put his n pieces of gold on a weight scale, one piece at a time. The scale has an unusual defect: if the total weight on it is exactly x, it will explode. Can he put all n gold pieces onto the scale in some order, without the scale exploding during the process? If so, help him find some possible order. Formally, rearrange the array w so that for each i (1\xe2\x89\xa4i\xe2\x89\xa4n), i\xe2\x88\x91j=1wj\xe2\x89\xa0x."              
                                  800.0 1514A "Perfectly Imperfect Array" "math,number theory" "Given an array a of length n, tell us whether it has a non-empty subsequence such that the product of its elements is not a perfect square.A sequence b is a subsequence of an array a if b can be obtained from a by deleting some (possibly zero) elements."              
                                  800.0 1512B "Almost Rectangle" implementation "There is a square field of size n\xc3\x97n in which two cells are marked. These cells can be in the same row or column.You are to mark two more cells so that they are the corners of a rectangle with sides parallel to the coordinate axes.For example, if n=4 and a rectangular field looks like this (there are asterisks in the marked cells):..\xe2\x88\x97.....\xe2\x88\x97.......Then you can mark two more cells as follows\xe2\x88\x97.\xe2\x88\x97.....\xe2\x88\x97.\xe2\x88\x97.....If there are several possible solutions, then print any of them."              
                                  800.0 1509A "Average Height" "constructive algorithms" "Sayaka Saeki is a member of the student council, which has n other members (excluding Sayaka). The i-th member has a height of ai millimeters.It\'s the end of the school year and Sayaka wants to take a picture of all other members of the student council. Being the hard-working and perfectionist girl as she is, she wants to arrange all the members in a line such that the amount of photogenic consecutive pairs of members is as large as possible.A pair of two consecutive members u and v on a line is considered photogenic if their average height is an integer, i.e. au+av2 is an integer.Help Sayaka arrange the other members to maximize the number of photogenic consecutive pairs."              
                                  3500.0 1508F "Optimal Encoding" "brute force,data structures" "Touko\'s favorite sequence of numbers is a permutation a1,a2,\xe2\x80\xa6,an of 1,2,\xe2\x80\xa6,n, and she wants some collection of permutations that are similar to her favorite permutation.She has a collection of q intervals of the form [li,ri] with 1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n. To create permutations that are similar to her favorite permutation, she coined the following definition:  A permutation b1,b2,\xe2\x80\xa6,bn allows an interval [l\xe2\x80\xb2,r\xe2\x80\xb2] to holds its shape if for any pair of integers (x,y) such that l\xe2\x80\xb2\xe2\x89\xa4x<y\xe2\x89\xa4r\xe2\x80\xb2, we have bx<by if and only if ax<ay.  A permutation b1,b2,\xe2\x80\xa6,bn is k-similar if b allows all intervals [li,ri] for all 1\xe2\x89\xa4i\xe2\x89\xa4k to hold their shapes. Yuu wants to figure out all k-similar permutations for Touko, but it turns out this is a very hard task; instead, Yuu will encode the set of all k-similar permutations with directed acylic graphs (DAG). Yuu also coined the following definitions for herself:  A permutation b1,b2,\xe2\x80\xa6,bn satisfies a DAG G\xe2\x80\xb2 if for all edge u\xe2\x86\x92v in G\xe2\x80\xb2, we must have bu<bv.  A k-encoding is a DAG Gk on the set of vertices 1,2,\xe2\x80\xa6,n such that a permutation b1,b2,\xe2\x80\xa6,bn satisfies Gk if and only if b is k-similar. Since Yuu is free today, she wants to figure out the minimum number of edges among all k-encodings for each k from 1 to q."              
                                  2500.0 1508C "Complete the MST" "bitmasks,brute force,data structures,dfs and similar,dsu,graphs,greedy,trees" "As a teacher, Riko Hakozaki often needs to help her students with problems from various subjects. Today, she is asked a programming task which goes as follows.You are given an undirected complete graph with n nodes, where some edges are pre-assigned with a positive weight while the rest aren\'t. You need to assign all unassigned edges with non-negative weights so that in the resulting fully-assigned complete graph the XOR sum of all weights would be equal to 0.Define the ugliness of a fully-assigned complete graph the weight of its minimum spanning tree, where the weight of a spanning tree equals the sum of weights of its edges. You need to assign the weights so that the ugliness of the resulting graph is as small as possible.As a reminder, an undirected complete graph with n nodes contains all edges (u,v) with 1\xe2\x89\xa4u<v\xe2\x89\xa4n; such a graph has n(n\xe2\x88\x921)2 edges.She is not sure how to solve this problem, so she asks you to solve it for her."              
                                  2000.0 1506G "Maximize the Remaining String" "brute force,data structures,dp,greedy,strings" "You are given a string s, consisting of lowercase Latin letters. While there is at least one character in the string s that is repeated at least twice, you perform the following operation:   you choose the index i (1\xe2\x89\xa4i\xe2\x89\xa4|s|) such that the character at position i occurs at least two times in the string s, and delete the character at position i, that is, replace s with s1s2\xe2\x80\xa6si\xe2\x88\x921si+1si+2\xe2\x80\xa6sn. For example, if s=""codeforces"", then you can apply the following sequence of operations:   i=6\xe2\x87\x92s=""codefrces"";  i=1\xe2\x87\x92s=""odefrces"";  i=7\xe2\x87\x92s=""odefrcs""; Given a given string s, find the lexicographically maximum string that can be obtained after applying a certain sequence of operations after which all characters in the string become unique.A string a of length n is lexicographically less than a string b of length m, if:   there is an index i (1\xe2\x89\xa4i\xe2\x89\xa4min(n,m)) such that the first i\xe2\x88\x921 characters of the strings a and b are the same, and the i-th character of the string a is less than i-th character of string b;  or the first min(n,m) characters in the strings a and b are the same and n<m. For example, the string a=""aezakmi"" is lexicographically less than the string b=""aezus""."              
                                  2000.0 1506F "Triangular Paths" "constructive algorithms,graphs,math,shortest paths,sortings" "Consider an infinite triangle made up of layers. Let\'s number the layers, starting from one, from the top of the triangle (from top to bottom). The k-th layer of the triangle contains k points, numbered from left to right. Each point of an infinite triangle is described by a pair of numbers (r,c) (1\xe2\x89\xa4c\xe2\x89\xa4r), where r is the number of the layer, and c is the number of the point in the layer. From each point (r,c) there are two directed edges to the points (r+1,c) and (r+1,c+1), but only one of the edges is activated. If r+c is even, then the edge to the point (r+1,c) is activated, otherwise the edge to the point (r+1,c+1) is activated. Look at the picture for a better understanding.  Activated edges are colored in black. Non-activated edges are colored in gray. From the point (r1,c1) it is possible to reach the point (r2,c2), if there is a path between them only from activated edges. For example, in the picture above, there is a path from (1,1) to (3,2), but there is no path from (2,1) to (1,1).Initially, you are at the point (1,1). For each turn, you can:   Replace activated edge for point (r,c). That is if the edge to the point (r+1,c) is activated, then instead of it, the edge to the point (r+1,c+1) becomes activated, otherwise if the edge to the point (r+1,c+1), then instead if it, the edge to the point (r+1,c) becomes activated. This action increases the cost of the path by 1;  Move from the current point to another by following the activated edge. This action does not increase the cost of the path. You are given a sequence of n points of an infinite triangle (r1,c1),(r2,c2),\xe2\x80\xa6,(rn,cn). Find the minimum cost path from (1,1), passing through all n points in arbitrary order."              
                                  1800.0 1505D "Xenolith? Hippodrome?" "*special problem,number theory" "InputThe input contains two integers N, M (1\xe2\x89\xa4N\xe2\x89\xa41024,2\xe2\x89\xa4M\xe2\x89\xa416), separated by a single space.OutputOutput ""YES"" or ""NO"".ExamplesInputCopy2 3OutputCopyYESInputCopy3 2OutputCopyNOInputCopy33 16OutputCopyYESInputCopy26 5OutputCopyNO"              
                                  900.0 1505A "Is it rated - 2" "*special problem,implementation,interactive" "InteractionThis is an interactive problem. You need to read participants\' queries from standard input and print your responses to standard output. You don\'t know the number of queries upfront, so you\'ll need to process them as you get them; you\'ll know you\'re done once you reach the end of the file.In each query, you will be asked the question, written in one line. You have to answer it correctly, patiently and without any display of emotions. Your response is case-insensitive.Please make sure to use the stream flushing operation after each response in order not to leave part of your output in some buffer.ExampleInputCopyIs it rated?Is it rated?Is it rated?OutputCopyNONONO"              
                                  3500.0 1500F "Cupboards Jumps" dp "In the house where Krosh used to live, he had n cupboards standing in a line, the i-th cupboard had the height of hi. Krosh moved recently, but he wasn\'t able to move the cupboards with him. Now he wants to buy n new cupboards so that they look as similar to old ones as possible.Krosh does not remember the exact heights of the cupboards, but for every three consecutive cupboards he remembers the height difference between the tallest and the shortest of them. In other words, if the cupboards\' heights were h1,h2,\xe2\x80\xa6,hn, then Krosh remembers the values wi=max(hi,hi+1,hi+2)\xe2\x88\x92min(hi,hi+1,hi+2) for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922.Krosh wants to buy such n cupboards that all the values wi remain the same. Help him determine the required cupboards\' heights, or determine that he remembers something incorrectly and there is no suitable sequence of heights."              
                                  1200.0 1497C1 "k-LCM (easy version)" "constructive algorithms,math" "It is the easy version of the problem. The only difference is that in this version k=3.You are given a positive integer n. Find k positive integers a1,a2,\xe2\x80\xa6,ak, such that:  a1+a2+\xe2\x80\xa6+ak=n  LCM(a1,a2,\xe2\x80\xa6,ak)\xe2\x89\xa4n2 Here LCM is the least common multiple of numbers a1,a2,\xe2\x80\xa6,ak.We can show that for given constraints the answer always exists."              
                                  3300.0 1495F Squares "constructive algorithms,data structures,dp,graphs,trees" "There are n squares drawn from left to right on the floor. The i-th square has three integers pi,ai,bi, written on it. The sequence p1,p2,\xe2\x80\xa6,pn forms a permutation.Each round you will start from the leftmost square 1 and jump to the right. If you are now on the i-th square, you can do one of the following two operations:  Jump to the i+1-th square and pay the cost ai. If i=n, then you can end the round and pay the cost ai.  Jump to the j-th square and pay the cost bi, where j is the leftmost square that satisfies j>i,pj>pi. If there is no such j then you can end the round and pay the cost bi. There are q rounds in the game. To make the game more difficult, you need to maintain a square set S (initially it is empty). You must pass through these squares during the round (other squares can also be passed through). The square set S for the i-th round is obtained by adding or removing a square from the square set for the (i\xe2\x88\x921)-th round. For each round find the minimum cost you should pay to end it."              
                                  1900.0 1495B "Let\'s Go Hiking" games,greedy "On a weekend, Qingshan suggests that she and her friend Daniel go hiking. Unfortunately, they are busy high school students, so they can only go hiking on scratch paper.A permutation p is written from left to right on the paper. First Qingshan chooses an integer index x (1\xe2\x89\xa4x\xe2\x89\xa4n) and tells it to Daniel. After that, Daniel chooses another integer index y (1\xe2\x89\xa4y\xe2\x89\xa4n, y\xe2\x89\xa0x).The game progresses turn by turn and as usual, Qingshan moves first. The rules follow:   If it is Qingshan\'s turn, Qingshan must change x to such an index x\xe2\x80\xb2 that 1\xe2\x89\xa4x\xe2\x80\xb2\xe2\x89\xa4n, |x\xe2\x80\xb2\xe2\x88\x92x|=1, x\xe2\x80\xb2\xe2\x89\xa0y, and px\xe2\x80\xb2<px at the same time.  If it is Daniel\'s turn, Daniel must change y to such an index y\xe2\x80\xb2 that 1\xe2\x89\xa4y\xe2\x80\xb2\xe2\x89\xa4n, |y\xe2\x80\xb2\xe2\x88\x92y|=1, y\xe2\x80\xb2\xe2\x89\xa0x, and py\xe2\x80\xb2>py at the same time. The person who can\'t make her or his move loses, and the other wins. You, as Qingshan\'s fan, are asked to calculate the number of possible x to make Qingshan win in the case both players play optimally."              
                                  2000.0 1493C "K-beautiful Strings" "binary search,brute force,constructive algorithms,greedy,strings" "You are given a string s consisting of lowercase English letters and a number k. Let\'s call a string consisting of lowercase English letters beautiful if the number of occurrences of each letter in that string is divisible by k. You are asked to find the lexicographically smallest beautiful string of length n, which is lexicographically greater or equal to string s. If such a string does not exist, output \xe2\x88\x921.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b."              
                                  1300.0 1493B "Planet Lapituletti" "brute force,implementation" "The time on the planet Lapituletti goes the same way it goes on Earth but a day lasts h hours and each hour lasts m minutes. The inhabitants of that planet use digital clocks similar to earth ones. Clocks display time in a format HH:MM (the number of hours in decimal is displayed first, then (after the colon) follows the number of minutes in decimal; the number of minutes and hours is written with leading zeros if needed to form a two-digit number). Hours are numbered from 0 to h\xe2\x88\x921 and minutes are numbered from 0 to m\xe2\x88\x921.  That\'s how the digits are displayed on the clock. Please note that digit 1 is placed in the middle of its position. A standard mirror is in use on the planet Lapituletti. Inhabitants often look at the reflection of the digital clocks in the mirror and feel happy when what you see on the reflected clocks is a valid time (that means that you see valid digits in the reflection and this time can be seen on the normal clocks at some moment of a day).The image of the clocks in the mirror is reflected against a vertical axis.  The reflection is not a valid time.The reflection is a valid time with h=24, m=60. However, for example, if h=10, m=60, then the reflection is not a valid time. An inhabitant of the planet Lapituletti begins to look at a mirrored image of the clocks at some time moment s and wants to know the nearest future time moment (which can possibly happen on the next day), when the reflected clock time is valid.It can be shown that with any h, m, s such a moment exists. If the reflected time is correct at the moment the inhabitant began to look at the clock, that moment is considered the nearest.You are asked to solve the problem for several test cases."              
                                  2400.0 1491E Fib-tree "brute force,dfs and similar,divide and conquer,number theory,trees" "Let Fk denote the k-th term of Fibonacci sequence, defined as below: F0=F1=1 for any integer n\xe2\x89\xa50, Fn+2=Fn+1+FnYou are given a tree with n vertices. Recall that a tree is a connected undirected graph without cycles.We call a tree a Fib-tree, if its number of vertices equals Fk for some k, and at least one of the following conditions holds: The tree consists of only 1 vertex; You can divide it into two Fib-trees by removing some edge of the tree. Determine whether the given tree is a Fib-tree or not."              
                                  1800.0 1491D "Zookeeper and The Infinite Zoo" "bitmasks,constructive algorithms,dp,greedy,math" "There is a new attraction in Singapore Zoo: The Infinite Zoo.The Infinite Zoo can be represented by a graph with an infinite number of vertices labeled 1,2,3,\xe2\x80\xa6. There is a directed edge from vertex u to vertex u+v if and only if u&v=v, where & denotes the bitwise AND operation. There are no other edges in the graph.Zookeeper has q queries. In the i-th query she will ask you if she can travel from vertex ui to vertex vi by going through directed edges."              
                                  1400.0 1490E "Accidental Victory" "binary search,data structures,greedy" "A championship is held in Berland, in which n players participate. The player with the number i has ai (ai\xe2\x89\xa51) tokens.The championship consists of n\xe2\x88\x921 games, which are played according to the following rules:  in each game, two random players with non-zero tokens are selected;  the player with more tokens is considered the winner of the game (in case of a tie, the winner is chosen randomly);  the winning player takes all of the loser\'s tokens; The last player with non-zero tokens is the winner of the championship.All random decisions that are made during the championship are made equally probable and independently.For example, if n=4, a=[1,2,4,3], then one of the options for the game (there could be other options) is:   during the first game, the first and fourth players were selected. The fourth player has more tokens, so he takes the first player\'s tokens. Now a=[0,2,4,4];  during the second game, the fourth and third players were selected. They have the same number of tokens, but in a random way, the third player is the winner. Now a=[0,2,8,0];  during the third game, the second and third players were selected. The third player has more tokens, so he takes the second player\'s tokens. Now a=[0,0,10,0];  the third player is declared the winner of the championship. Championship winners will receive personalized prizes. Therefore, the judges want to know in advance which players have a chance of winning, i.e have a non-zero probability of winning the championship. You have been asked to find all such players."              
                                  2900.0 1487F Ones "dp,greedy,shortest paths" "You are given a positive (greater than zero) integer n.You have to represent n as the sum of integers (possibly negative) consisting only of ones (digits \'1\'). For example, 24=11+11+1+1 and 102=111\xe2\x88\x9211+1+1. Among all possible representations, you have to find the one that uses the minimum number of ones in total."              
                                  800.0 1487A Arena implementation,sortings "n heroes fight against each other in the Arena. Initially, the i-th hero has level ai.Each minute, a fight between two different heroes occurs. These heroes can be chosen arbitrarily (it\'s even possible that it is the same two heroes that were fighting during the last minute).When two heroes of equal levels fight, nobody wins the fight. When two heroes of different levels fight, the one with the higher level wins, and his level increases by 1.The winner of the tournament is the first hero that wins in at least 100500 fights (note that it\'s possible that the tournament lasts forever if no hero wins this number of fights, then there is no winner). A possible winner is a hero such that there exists a sequence of fights that this hero becomes the winner of the tournament.Calculate the number of possible winners among n heroes."              
                                  1600.0 1486C1 "Guessing the Greatest (easy version)" "binary search,interactive" "The only difference between the easy and the hard version is the limit to the number of queries.This is an interactive problem.There is an array a of n different numbers. In one query you can ask the position of the second maximum element in a subsegment a[l..r]. Find the position of the maximum element in the array in no more than 40 queries.A subsegment a[l..r] is all the elements al,al+1,...,ar. After asking this subsegment you will be given the position of the second maximum from this subsegment in the whole array."              
                                  800.0 1481A "Space Navigation" greedy,strings "You were dreaming that you are traveling to a planet named Planetforces on your personal spaceship. Unfortunately, its piloting system was corrupted and now you need to fix it in order to reach Planetforces.  Space can be represented as the XY plane. You are starting at point (0,0), and Planetforces is located in point (px,py).The piloting system of your spaceship follows its list of orders which can be represented as a string s. The system reads s from left to right. Suppose you are at point (x,y) and current order is si:   if si=U, you move to (x,y+1);  if si=D, you move to (x,y\xe2\x88\x921);  if si=R, you move to (x+1,y);  if si=L, you move to (x\xe2\x88\x921,y). Since string s could be corrupted, there is a possibility that you won\'t reach Planetforces in the end. Fortunately, you can delete some orders from s but you can\'t change their positions.Can you delete several orders (possibly, zero) from s in such a way, that you\'ll reach Planetforces after the system processes all orders?"              
                                  2100.0 1479B2 "Painting the Array II" "constructive algorithms,data structures,dp,greedy,implementation" "The only difference between the two versions is that this version asks the minimal possible answer.Homer likes arrays a lot. Today he is painting an array a1,a2,\xe2\x80\xa6,an with two kinds of colors, white and black. A painting assignment for a1,a2,\xe2\x80\xa6,an is described by an array b1,b2,\xe2\x80\xa6,bn that bi indicates the color of ai (0 for white and 1 for black).According to a painting assignment b1,b2,\xe2\x80\xa6,bn, the array a is split into two new arrays a(0) and a(1), where a(0) is the sub-sequence of all white elements in a and a(1) is the sub-sequence of all black elements in a. For example, if a=[1,2,3,4,5,6] and b=[0,1,0,1,0,0], then a(0)=[1,3,5,6] and a(1)=[2,4].The number of segments in an array c1,c2,\xe2\x80\xa6,ck, denoted seg(c), is the number of elements if we merge all adjacent elements with the same value in c. For example, the number of segments in [1,1,2,2,3,3,3,2] is 4, because the array will become [1,2,3,2] after merging adjacent elements with the same value. Especially, the number of segments in an empty array is 0.Homer wants to find a painting assignment b, according to which the number of segments in both a(0) and a(1), i.e. seg(a(0))+seg(a(1)), is as small as possible. Find this number."              
                                  3300.0 1477E "Nezzar and Tournaments" "data structures,greedy" "In the famous Oh-Suit-United tournament, two teams are playing against each other for the grand prize of precious pepper points.The first team consists of n players, and the second team consists of m players. Each player has a potential: the potential of the i-th player in the first team is ai, and the potential of the i-th player in the second team is bi.In the tournament, all players will be on the stage in some order. There will be a scoring device, initially assigned to an integer k, which will be used to value the performance of all players.The scores for all players will be assigned in the order they appear on the stage. Let the potential of the current player be x, and the potential of the previous player be y (y equals x for the first player). Then, x\xe2\x88\x92y is added to the value in the scoring device, Afterwards, if the value in the scoring device becomes negative, the value will be reset to 0. Lastly, the player\'s score is assigned to the current value on the scoring device. The score of a team is the sum of the scores of all its members.As an insane fan of the first team, Nezzar desperately wants the biggest win for the first team. He now wonders what is the maximum difference between scores of the first team and the second team.Formally, let the score of the first team be scoref and the score of the second team be scores. Nezzar wants to find the maximum value of scoref\xe2\x88\x92scores over all possible orders of players on the stage.However, situation often changes and there are q events that will happen. There are three types of events:  1 pos x \xe2\x80\x94 change apos to x;  2 pos x \xe2\x80\x94 change bpos to x;  3 x \xe2\x80\x94 tournament is held with k=x and Nezzar wants you to compute the maximum value of scoref\xe2\x88\x92scores. Can you help Nezzar to answer the queries of the third type?"              
                                  2800.0 1477D "Nezzar and Hidden Permutations" "constructive algorithms,dfs and similar,graphs" "Nezzar designs a brand new game ""Hidden Permutations"" and shares it with his best friend, Nanako.At the beginning of the game, Nanako and Nezzar both know integers n and m. The game goes in the following way:  Firstly, Nezzar hides two permutations p1,p2,\xe2\x80\xa6,pn and q1,q2,\xe2\x80\xa6,qn of integers from 1 to n, and Nanako secretly selects m unordered pairs (l1,r1),(l2,r2),\xe2\x80\xa6,(lm,rm);  After that, Nanako sends his chosen pairs to Nezzar;  On receiving those m unordered pairs, Nezzar checks if there exists 1\xe2\x89\xa4i\xe2\x89\xa4m, such that (pli\xe2\x88\x92pri) and (qli\xe2\x88\x92qri) have different signs. If so, Nezzar instantly loses the game and gets a score of \xe2\x88\x921. Otherwise, the score Nezzar gets is equal to the number of indices 1\xe2\x89\xa4i\xe2\x89\xa4n such that pi\xe2\x89\xa0qi. However, Nezzar accidentally knows Nanako\'s unordered pairs and decides to take advantage of them. Please help Nezzar find out two permutations p and q such that the score is maximized."              
                                  1900.0 1477B "Nezzar and Binary String" "data structures,greedy" "Nezzar has a binary string s of length n that he wants to share with his best friend, Nanako. Nanako will spend q days inspecting the binary string. At the same time, Nezzar wants to change the string s into string f during these q days, because it looks better.It is known that Nanako loves consistency so much. On the i-th day, Nanako will inspect a segment of string s from position li to position ri inclusive. If the segment contains both characters \'0\' and \'1\', Nanako becomes unhappy and throws away the string.After this inspection, at the i-th night, Nezzar can secretly change strictly less than half of the characters in the segment from li to ri inclusive, otherwise the change will be too obvious.Now Nezzar wonders, if it is possible to avoid Nanako being unhappy and at the same time have the string become equal to the string f at the end of these q days and nights."              
                                  1800.0 1477A "Nezzar and Board" "constructive algorithms,math,number theory" "n distinct integers x1,x2,\xe2\x80\xa6,xn are written on the board. Nezzar can perform the following operation multiple times.  Select two integers x,y (not necessarily distinct) on the board, and write down 2x\xe2\x88\x92y. Note that you don\'t remove selected numbers. Now, Nezzar wonders if it is possible to have his favorite number k on the board after applying above operation multiple times."              
                                  1900.0 1475F "Unusual Matrix" "2-sat,brute force,constructive algorithms" "You are given two binary square matrices a and b of size n\xc3\x97n. A matrix is called binary if each of its elements is equal to 0 or 1. You can do the following operations on the matrix a arbitrary number of times (0 or more):   vertical xor. You choose the number j (1\xe2\x89\xa4j\xe2\x89\xa4n) and for all i (1\xe2\x89\xa4i\xe2\x89\xa4n) do the following: ai,j:=ai,j\xe2\x8a\x951 (\xe2\x8a\x95 \xe2\x80\x94 is the operation xor (exclusive or)).  horizontal xor. You choose the number i (1\xe2\x89\xa4i\xe2\x89\xa4n) and for all j (1\xe2\x89\xa4j\xe2\x89\xa4n) do the following: ai,j:=ai,j\xe2\x8a\x951. Note that the elements of the a matrix change after each operation.For example, if n=3 and the matrix a is: (110001110) Then the following sequence of operations shows an example of transformations:   vertical xor, j=1. a=(010101010)  horizontal xor, i=2. a=(010010010)  vertical xor, j=2. a=(000000000) Check if there is a sequence of operations such that the matrix a becomes equal to the matrix b."              
                                  1800.0 1475D "Cleaning the Phone" "binary search,dp,sortings,two pointers" "Polycarp often uses his smartphone. He has already installed n applications on it. Application with number i takes up ai units of memory.Polycarp wants to free at least m units of memory (by removing some applications).Of course, some applications are more important to Polycarp than others. He came up with the following scoring system \xe2\x80\x94 he assigned an integer bi to each application:   bi=1 \xe2\x80\x94 regular application;  bi=2 \xe2\x80\x94 important application. According to this rating system, his phone has b1+b2+\xe2\x80\xa6+bn convenience points.Polycarp believes that if he removes applications with numbers i1,i2,\xe2\x80\xa6,ik, then he will free ai1+ai2+\xe2\x80\xa6+aik units of memory and lose bi1+bi2+\xe2\x80\xa6+bik convenience points.For example, if n=5, m=7, a=[5,3,2,1,4], b=[2,1,1,2,1], then Polycarp can uninstall the following application sets (not all options are listed below):   applications with numbers 1,4 and 5. In this case, it will free a1+a4+a5=10 units of memory and lose b1+b4+b5=5 convenience points;  applications with numbers 1 and 3. In this case, it will free a1+a3=7 units of memory and lose b1+b3=3 convenience points.  applications with numbers 2 and 5. In this case, it will free a2+a5=7 memory units and lose b2+b5=2 convenience points. Help Polycarp, choose a set of applications, such that if removing them will free at least m units of memory and lose the minimum number of convenience points, or indicate that such a set does not exist."              
                                  2800.0 1473G Tiles combinatorics,dp,fft,math "Consider a road consisting of several rows. Each row is divided into several rectangular tiles, and all tiles in the same row are equal. The first row contains exactly one rectangular tile. Look at the picture below which shows how the tiles are arranged.The road is constructed as follows:   the first row consists of 1 tile;  then a1 rows follow; each of these rows contains 1 tile greater than the previous row;  then b1 rows follow; each of these rows contains 1 tile less than the previous row;  then a2 rows follow; each of these rows contains 1 tile greater than the previous row;  then b2 rows follow; each of these rows contains 1 tile less than the previous row;  ...  then an rows follow; each of these rows contains 1 tile greater than the previous row;  then bn rows follow; each of these rows contains 1 tile less than the previous row.   An example of the road with n=2, a1=4, b1=2, a2=2, b2=3. Rows are arranged from left to right. You start from the only tile in the first row and want to reach the last row (any tile of it). From your current tile, you can move to any tile in the next row which touches your current tile.Calculate the number of different paths from the first row to the last row. Since it can be large, print it modulo 998244353."              
                                  1000.0 1473B "String LCM" "brute force,math,number theory,strings" "Let\'s define a multiplication operation between a string a and a positive integer x: a\xe2\x8b\x85x is the string that is a result of writing x copies of a one after another. For example, ""abc"" \xe2\x8b\x85 2 = ""abcabc"", ""a"" \xe2\x8b\x85 5 = ""aaaaa"".A string a is divisible by another string b if there exists an integer x such that b\xe2\x8b\x85x=a. For example, ""abababab"" is divisible by ""ab"", but is not divisible by ""ababab"" or ""aa"".LCM of two strings s and t (defined as LCM(s,t)) is the shortest non-empty string that is divisible by both s and t.You are given two strings s and t. Find LCM(s,t) or report that it does not exist. It can be shown that if LCM(s,t) exists, it is unique."              
                                  1200.0 1472D "Even-Odd Game" dp,games,greedy,sortings "During their New Year holidays, Alice and Bob play the following game using an array a of n integers:   Players take turns, Alice moves first.  Each turn a player chooses any element and removes it from the array.  If Alice chooses even value, then she adds it to her score. If the chosen value is odd, Alice\'s score does not change.  Similarly, if Bob chooses odd value, then he adds it to his score. If the chosen value is even, then Bob\'s score does not change. If there are no numbers left in the array, then the game ends. The player with the highest score wins. If the scores of the players are equal, then a draw is declared.For example, if n=4 and a=[5,2,7,3], then the game could go as follows (there are other options):   On the first move, Alice chooses 2 and get two points. Her score is now 2. The array a is now [5,7,3].  On the second move, Bob chooses 5 and get five points. His score is now 5. The array a is now [7,3].  On the third move, Alice chooses 7 and get no points. Her score is now 2. The array a is now [3].  On the last move, Bob chooses 3 and get three points. His score is now 8. The array a is empty now.  Since Bob has more points at the end of the game, he is the winner. You want to find out who will win if both players play optimally. Note that there may be duplicate numbers in the array."              
                                  800.0 1472B "Fair Division" dp,greedy,math "Alice and Bob received n candies from their parents. Each candy weighs either 1 gram or 2 grams. Now they want to divide all candies among themselves fairly so that the total weight of Alice\'s candies is equal to the total weight of Bob\'s candies.Check if they can do that.Note that candies are not allowed to be cut in half."              
                                  2200.0 1470D "Strange Housing" "constructive algorithms,dfs and similar,graph matchings,graphs,greedy" "Students of Winter Informatics School are going to live in a set of houses connected by underground passages. Teachers are also going to live in some of these houses, but they can not be accommodated randomly. For safety reasons, the following must hold:  All passages between two houses will be closed, if there are no teachers in both of them. All other passages will stay open.  It should be possible to travel between any two houses using the underground passages that are open.  Teachers should not live in houses, directly connected by a passage. Please help the organizers to choose the houses where teachers will live to satisfy the safety requirements or determine that it is impossible."              
                                  1000.0 1469B "Red and Blue" dp,greedy "Monocarp had a sequence a consisting of n+m integers a1,a2,\xe2\x80\xa6,an+m. He painted the elements into two colors, red and blue; n elements were painted red, all other m elements were painted blue.After painting the elements, he has written two sequences r1,r2,\xe2\x80\xa6,rn and b1,b2,\xe2\x80\xa6,bm. The sequence r consisted of all red elements of a in the order they appeared in a; similarly, the sequence b consisted of all blue elements of a in the order they appeared in a as well.Unfortunately, the original sequence was lost, and Monocarp only has the sequences r and b. He wants to restore the original sequence. In case there are multiple ways to restore it, he wants to choose a way to restore that maximizes the value of f(a)=max(0,a1,(a1+a2),(a1+a2+a3),\xe2\x80\xa6,(a1+a2+a3+\xe2\x8b\xaf+an+m))Help Monocarp to calculate the maximum possible value of f(a)."              
                                  1400.0 1468C Berpizza "data structures,implementation" "Monocarp and Polycarp are working as waiters in Berpizza, a pizzeria located near the center of Bertown. Since they are waiters, their job is to serve the customers, but they choose whom they serve first differently.At the start of the working day, there are no customers at the Berpizza. They come there one by one. When a customer comes into the pizzeria, she sits and waits for Monocarp or Polycarp to serve her. Monocarp has been working in Berpizza for just two weeks, so whenever he serves a customer, he simply chooses the one who came to Berpizza first, and serves that customer. On the other hand, Polycarp is an experienced waiter at Berpizza, and he knows which customers are going to spend a lot of money at the pizzeria (and which aren\'t) as soon as he sees them. For each customer, Polycarp estimates the amount of money this customer can spend, and when he serves a customer, he chooses the one that is expected to leave the most money at Berpizza (in case there are several such customers, he chooses the one who came first among them). Obviously, no customer can be served twice, so Monocarp and Polycarp choose which customer to serve only among those who haven\'t been served yet.When the number of customers gets really high, it becomes difficult for both Monocarp and Polycarp to choose the customer they are going to serve. Your task is to write a program that makes these choices for them. Formally, your program should be able to process three types of queries:  1 m \xe2\x80\x94 a customer comes to Berpizza, and Polycarp estimates the amount of money that they will spend as m;  2 \xe2\x80\x94 Monocarp serves a customer which came to the pizzeria first;  3 \xe2\x80\x94 Polycarp serves a customer which is expected to spend the largest amount of money at the pizzeria (if there are several such customers, the one that came to the pizzeria first is chosen). For each query of types 2 and 3, report the number of the customer who was served (the customers are numbered in the order they come to the pizzeria, starting from 1)."              
                                  2100.0 1466F "Euclid\'s nightmare" "bitmasks,dfs and similar,dsu,graphs,greedy,math,sortings" "You may know that Euclid was a mathematician. Well, as it turns out, Morpheus knew it too. So when he wanted to play a mean trick on Euclid, he sent him an appropriate nightmare. In his bad dream Euclid has a set S of n m-dimensional vectors over the Z2 field and can perform vector addition on them. In other words he has vectors with m coordinates, each one equal either 0 or 1. Vector addition is defined as follows: let u+v=w, then wi=(ui+vi)mod2. Euclid can sum any subset of S and archive another m-dimensional vector over Z2. In particular, he can sum together an empty subset; in such a case, the resulting vector has all coordinates equal 0.Let T be the set of all the vectors that can be written as a sum of some vectors from S. Now Euclid wonders the size of T and whether he can use only a subset S\xe2\x80\xb2 of S to obtain all the vectors from T. As it is usually the case in such scenarios, he will not wake up until he figures this out. So far, things are looking rather grim for the philosopher. But there is hope, as he noticed that all vectors in S have at most 2 coordinates equal 1. Help Euclid and calculate |T|, the number of m-dimensional vectors over Z2 that can be written as a sum of some vectors from S. As it can be quite large, calculate it modulo 109+7. You should also find S\xe2\x80\xb2, the smallest such subset of S, that all vectors in T can be written as a sum of vectors from S\xe2\x80\xb2. In case there are multiple such sets with a minimal number of elements, output the lexicographically smallest one with respect to the order in which their elements are given in the input. Consider sets A and B such that |A|=|B|. Let a1,a2,\xe2\x80\xa6a|A| and b1,b2,\xe2\x80\xa6b|B| be increasing arrays of indices elements of A and B correspondingly. A is lexicographically smaller than B iff there exists such i that aj=bj for all j<i and ai<bi."              
                                  1800.0 1466E "Apollo versus Pan" "bitmasks,brute force,math" "Only a few know that Pan and Apollo weren\'t only battling for the title of the GOAT musician. A few millenniums later, they also challenged each other in math (or rather in fast calculations). The task they got to solve is the following:Let x1,x2,\xe2\x80\xa6,xn be the sequence of n non-negative integers. Find this value: n\xe2\x88\x91i=1n\xe2\x88\x91j=1n\xe2\x88\x91k=1(xi&xj)\xe2\x8b\x85(xj|xk)Here & denotes the bitwise and, and | denotes the bitwise or.Pan and Apollo could solve this in a few seconds. Can you do it too? For convenience, find the answer modulo 109+7."              
                                  800.0 1466B "Last minute enhancements" dp,greedy "Athenaeus has just finished creating his latest musical composition and will present it tomorrow to the people of Athens. Unfortunately, the melody is rather dull and highly likely won\'t be met with a warm reception. His song consists of n notes, which we will treat as positive integers. The diversity of a song is the number of different notes it contains. As a patron of music, Euterpe watches over composers and guides them throughout the process of creating new melodies. She decided to help Athenaeus by changing his song to make it more diverse.Being a minor goddess, she cannot arbitrarily change the song. Instead, for each of the n notes in the song, she can either leave it as it is or increase it by 1.Given the song as a sequence of integers describing the notes, find out the maximal, achievable diversity."              
                                  2400.0 1463E "Plan of Lectures" "constructive algorithms,dfs and similar,dsu,graphs,implementation,sortings,trees" "Ivan is a programming teacher. During the academic year, he plans to give n lectures on n different topics. Each topic should be used in exactly one lecture. Ivan wants to choose which topic will he explain during the 1-st, 2-nd, ..., n-th lecture \xe2\x80\x94 formally, he wants to choose some permutation of integers from 1 to n (let\'s call this permutation q). qi is the index of the topic Ivan will explain during the i-th lecture.For each topic (except exactly one), there exists a prerequisite topic (for the topic i, the prerequisite topic is pi). Ivan cannot give a lecture on a topic before giving a lecture on its prerequisite topic. There exists at least one valid ordering of topics according to these prerequisite constraints.Ordering the topics correctly can help students understand the lectures better. Ivan has k special pairs of topics (xi,yi) such that he knows that the students will understand the yi-th topic better if the lecture on it is conducted right after the lecture on the xi-th topic. Ivan wants to satisfy the constraints on every such pair, that is, for every i\xe2\x88\x88[1,k], there should exist some j\xe2\x88\x88[1,n\xe2\x88\x921] such that qj=xi and qj+1=yi.Now Ivan wants to know if there exists an ordering of topics that satisfies all these constraints, and if at least one exists, find any of them."              
                                  2200.0 1461E "Water Level" "brute force,graphs,greedy,implementation,math" "In recent years John has very successfully settled at his new job at the office. But John doesn\'t like to idly sit around while his code is compiling, so he immediately found himself an interesting distraction. The point of his distraction was to maintain a water level in the water cooler used by other zebras.  Originally the cooler contained exactly k liters of water. John decided that the amount of water must always be at least l liters of water but no more than r liters. John will stay at the office for exactly t days. He knows that each day exactly x liters of water will be used by his colleagues. At the beginning of each day he can add exactly y liters of water to the cooler, but at any point in time the amount of water in the cooler must be in the range [l,r].Now John wants to find out whether he will be able to maintain the water level at the necessary level for t days. Help him answer this question!"              
                                  3100.0 1458D "Flip and Reverse" "data structures,graphs,greedy" "You are given a string s of 0\'s and 1\'s. You are allowed to perform the following operation: choose a non-empty contiguous substring of s that contains an equal number of 0\'s and 1\'s; flip all characters in the substring, that is, replace all 0\'s with 1\'s, and vice versa; reverse the substring. For example, consider s = 00111011, and the following operation: Choose the first six characters as the substring to act upon: 00111011. Note that the number of 0\'s and 1\'s are equal, so this is a legal choice. Choosing substrings 0, 110, or the entire string would not be possible. Flip all characters in the substring: 11000111. Reverse the substring: 10001111.  Find the lexicographically smallest string that can be obtained from s after zero or more operations."              
                                  2900.0 1455G "Forbidden Value" "data structures,dp" "Polycarp is editing a complicated computer program. First, variable x is declared and assigned to 0. Then there are instructions of two types:   set y v \xe2\x80\x94 assign x a value y or spend v burles to remove that instruction (thus, not reassign x);  if y \xe2\x80\xa6 end block \xe2\x80\x94 execute instructions inside the if block if the value of x is y and ignore the block otherwise. if blocks can contain set instructions and other if blocks inside them.However, when the value of x gets assigned to s, the computer breaks and immediately catches fire. Polycarp wants to prevent that from happening and spend as few burles as possible.What is the minimum amount of burles he can spend on removing set instructions to never assign x to s?"              
                                  1600.0 1455D "Sequence and Swaps" dp,greedy,sortings "You are given a sequence a consisting of n integers a1,a2,\xe2\x80\xa6,an, and an integer x. Your task is to make the sequence a sorted (it is considered sorted if the condition a1\xe2\x89\xa4a2\xe2\x89\xa4a3\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4an holds).To make the sequence sorted, you may perform the following operation any number of times you want (possibly zero): choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n and ai>x, and swap the values of ai and x.For example, if a=[0,2,3,5,4], x=1, the following sequence of operations is possible:  choose i=2 (it is possible since a2>x), then a=[0,1,3,5,4], x=2;  choose i=3 (it is possible since a3>x), then a=[0,1,2,5,4], x=3;  choose i=4 (it is possible since a4>x), then a=[0,1,2,3,4], x=5. Calculate the minimum number of operations you have to perform so that a becomes sorted, or report that it is impossible."              
                                  2700.0 1453F "Even Harder" dp "Gildong is now developing a puzzle game. The puzzle consists of n platforms numbered from 1 to n. The player plays the game as a character that can stand on each platform and the goal of the game is to move the character from the 1-st platform to the n-th platform.The i-th platform is labeled with an integer ai (0\xe2\x89\xa4ai\xe2\x89\xa4n\xe2\x88\x92i). When the character is standing on the i-th platform, the player can move the character to any of the j-th platforms where i+1\xe2\x89\xa4j\xe2\x89\xa4i+ai. If the character is on the i-th platform where ai=0 and i\xe2\x89\xa0n, the player loses the game.Since Gildong thinks the current game is not hard enough, he wants to make it even harder. He wants to change some (possibly zero) labels to 0 so that there remains exactly one way to win. He wants to modify the game as little as possible, so he\'s asking you to find the minimum number of platforms that should have their labels changed. Two ways are different if and only if there exists a platform the character gets to in one way but not in the other way."              
                                  1900.0 1453D Checkpoints "brute force,constructive algorithms,greedy,math,probabilities" "Gildong is developing a game consisting of n stages numbered from 1 to n. The player starts the game from the 1-st stage and should beat the stages in increasing order of the stage number. The player wins the game after beating the n-th stage.There is at most one checkpoint on each stage, and there is always a checkpoint on the 1-st stage. At the beginning of the game, only the checkpoint on the 1-st stage is activated, and all other checkpoints are deactivated. When the player gets to the i-th stage that has a checkpoint, that checkpoint is activated.For each try of a stage, the player can either beat the stage or fail the stage. If they beat the i-th stage, the player is moved to the i+1-st stage. If they fail the i-th stage, the player is moved to the most recent checkpoint they activated, and they have to beat the stages after that checkpoint again.For example, assume that n=4 and the checkpoints are on the 1-st and 3-rd stages. The player starts at the 1-st stage. If they fail on the 1-st stage, they need to retry the 1-st stage because the checkpoint on the 1-st stage is the most recent checkpoint they activated. If the player beats the 1-st stage, they\'re moved to the 2-nd stage. If they fail it, they\'re sent back to the 1-st stage again. If they beat both the 1-st stage and the 2-nd stage, they get to the 3-rd stage and the checkpoint on the 3-rd stage is activated. Now whenever they fail on the 3-rd stage, or the 4-th stage after beating the 3-rd stage, they\'re sent back to the 3-rd stage. If they beat both the 3-rd stage and the 4-th stage, they win the game.Gildong is going to build the stages to have equal difficulty. He wants you to find any series of stages and checkpoints using at most 2000 stages, where the expected number of tries over all stages is exactly k, for a player whose probability of beating each stage is exactly 12."              
                                  2700.0 1452G "Game On Tree" "data structures,dfs and similar,greedy,trees" "Alice and Bob are playing a game. They have a tree consisting of n vertices. Initially, Bob has k chips, the i-th chip is located in the vertex ai (all these vertices are unique). Before the game starts, Alice will place a chip into one of the vertices of the tree.The game consists of turns. Each turn, the following events happen (sequentially, exactly in the following order):  Alice either moves her chip to an adjacent vertex or doesn\'t move it;  for each Bob\'s chip, he either moves it to an adjacent vertex or doesn\'t move it. Note that this choice is done independently for each chip. The game ends when Alice\'s chip shares the same vertex with one (or multiple) of Bob\'s chips. Note that Bob\'s chips may share the same vertex, even though they are in different vertices at the beginning of the game.Alice wants to maximize the number of turns, Bob wants to minimize it. If the game ends in the middle of some turn (Alice moves her chip to a vertex that contains one or multiple Bob\'s chips), this turn is counted.For each vertex, calculate the number of turns the game will last if Alice places her chip in that vertex."              
                                  1600.0 1452D "Radio Towers" combinatorics,dp,math "There are n+2 towns located on a coordinate line, numbered from 0 to n+1. The i-th town is located at the point i.You build a radio tower in each of the towns 1,2,\xe2\x80\xa6,n with probability 12 (these events are independent). After that, you want to set the signal power on each tower to some integer from 1 to n (signal powers are not necessarily the same, but also not necessarily different). The signal from a tower located in a town i with signal power p reaches every city c such that |c\xe2\x88\x92i|<p.After building the towers, you want to choose signal powers in such a way that:  towns 0 and n+1 don\'t get any signal from the radio towers;  towns 1,2,\xe2\x80\xa6,n get signal from exactly one radio tower each. For example, if n=5, and you have built the towers in towns 2, 4 and 5, you may set the signal power of the tower in town 2 to 2, and the signal power of the towers in towns 4 and 5 to 1. That way, towns 0 and n+1 don\'t get the signal from any tower, towns 1, 2 and 3 get the signal from the tower in town 2, town 4 gets the signal from the tower in town 4, and town 5 gets the signal from the tower in town 5.Calculate the probability that, after building the towers, you will have a way to set signal powers to meet all constraints."              
                                  1400.0 1451C "String Equality" dp,greedy,hashing,implementation,strings "Ashish has two strings a and b, each of length n, and an integer k. The strings only contain lowercase English letters.He wants to convert string a into string b by performing some (possibly zero) operations on a.In one move, he can either   choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) and swap ai and ai+1, or  choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k+1) and if ai,ai+1,\xe2\x80\xa6,ai+k\xe2\x88\x921 are all equal to some character c (c\xe2\x89\xa0 \'z\'), replace each one with the next character (c+1), that is, \'a\' is replaced by \'b\', \'b\' is replaced by \'c\' and so on. Note that he can perform any number of operations, and the operations can only be performed on string a. Help Ashish determine if it is possible to convert string a into b after performing some (possibly zero) operations on it."              
                                  800.0 1451A "Subtract or Divide" greedy,math "Ridbit starts with an integer n.In one move, he can perform one of the following operations:   divide n by one of its proper divisors, or  subtract 1 from n if n is greater than 1. A proper divisor is a divisor of a number, excluding itself. For example, 1, 2, 4, 5, and 10 are proper divisors of 20, but 20 itself is not.What is the minimum number of moves Ridbit is required to make to reduce n to 1?"              
                                  1800.0 1450D "Rating Compression" "binary search,data structures,greedy,implementation,two pointers" "On the competitive programming platform CodeCook, every person has a rating graph described by an array of integers a of length n. You are now updating the infrastructure, so you\'ve created a program to compress these graphs.The program works as follows. Given an integer parameter k, the program takes the minimum of each contiguous subarray of length k in a.More formally, for an array a of length n and an integer k, define the k-compression array of a as an array b of length n\xe2\x88\x92k+1, such that bj=minj\xe2\x89\xa4i\xe2\x89\xa4j+k\xe2\x88\x921aiFor example, the 3-compression array of [1,3,4,5,2] is [min{1,3,4},min{3,4,5},min{4,5,2}]=[1,3,2].A permutation of length m is an array consisting of m distinct integers from 1 to m in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (m=3 but there is 4 in the array).A k-compression array will make CodeCook users happy if it will be a permutation. Given an array a, determine for all 1\xe2\x89\xa4k\xe2\x89\xa4n if CodeCook users will be happy after a k-compression of this array or not."              
                                  3500.0 1444E "Finding the Vertex" "brute force,dfs and similar,dp,interactive,trees" "This is an interactive problem.You are given a tree \xe2\x80\x94 connected undirected graph without cycles. One vertex of the tree is special, and you have to find which one. You can ask questions in the following form: given an edge of the tree, which endpoint is closer to the special vertex, meaning which endpoint\'s shortest path to the special vertex contains fewer edges. You have to find the special vertex by asking the minimum number of questions in the worst case for a given tree.Please note that the special vertex might not be fixed by the interactor in advance: it might change the vertex to any other one, with the requirement of being consistent with the previously given answers."              
                                  3000.0 1442E "Black, White and Grey Tree" "binary search,constructive algorithms,dfs and similar,dp,greedy,trees" "You are given a tree with each vertex coloured white, black or grey. You can remove elements from the tree by selecting a subset of vertices in a single connected component and removing them and their adjacent edges from the graph. The only restriction is that you are not allowed to select a subset containing a white and a black vertex at once.What is the minimum number of removals necessary to remove all vertices from the tree?"              
                                  800.0 1440A "Buy the String" implementation,math "You are given four integers n, c0, c1 and h and a binary string s of length n.A binary string is a string consisting of characters 0 and 1.You can change any character of the string s (the string should be still binary after the change). You should pay h coins for each change.After some changes (possibly zero) you want to buy the string. To buy the string you should buy all its characters. To buy the character 0 you should pay c0 coins, to buy the character 1 you should pay c1 coins.Find the minimum number of coins needed to buy the string."              
                                  2600.0 1439B "Graph Subset Problem" "constructive algorithms,data structures,graphs" "You are given an undirected graph with n vertices and m edges. Also, you are given an integer k.Find either a clique of size k or a non-empty subset of vertices such that each vertex of this subset has at least k neighbors in the subset. If there are no such cliques and subsets report about it.A subset of vertices is called a clique of size k if its size is k and there exists an edge between every two vertices from the subset. A vertex is called a neighbor of the other vertex if there exists an edge between them."              
                                  1500.0 1439A1 "Binary Table (Easy Version)" "constructive algorithms,implementation" "This is the easy version of the problem. The difference between the versions is in the number of possible operations that can be made. You can make hacks if and only if you solved both versions of the problem.You are given a binary table of size n\xc3\x97m. This table consists of symbols 0 and 1.You can make such operation: select 3 different cells that belong to one 2\xc3\x972 square and change the symbols in these cells (change 0 to 1 and 1 to 0).Your task is to make all symbols in the table equal to 0. You are allowed to make at most 3nm operations. You don\'t need to minimize the number of operations.It can be proved that it is always possible."              
                                  2200.0 1437E "Make It Increasing" "binary search,constructive algorithms,data structures,dp,implementation" "You are given an array of n integers a1, a2, ..., an, and a set b of k distinct integers from 1 to n.In one operation, you may choose two integers i and x (1\xe2\x89\xa4i\xe2\x89\xa4n, x can be any integer) and assign ai:=x. This operation can be done only if i does not belong to the set b.Calculate the minimum number of operations you should perform so the array a is increasing (that is, a1<a2<a3<\xe2\x8b\xaf<an), or report that it is impossible."              
                                  1600.0 1431C "Black Friday" "*special problem,implementation" "There is a local shop in your area getting prepared for the great holiday of Black Friday. There are n items with prices p1,p2,\xe2\x80\xa6,pn on the display. They are ordered by price, so p1\xe2\x89\xa4p2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4pn.The shop has a prechosen discount value k. The Black Friday discount is applied in the following way: for a single purchase of x items, you get the cheapest \xe2\x8c\x8axk\xe2\x8c\x8b items of them for free (\xe2\x8c\x8axk\xe2\x8c\x8b is x divided by k rounded down to the nearest integer). You can include each item in your purchase no more than once.For example, if there are items with prices [1,1,2,2,2,3,4,5,6] in the shop, and you buy items with prices [1,2,2,4,5], and k=2, then you get the cheapest \xe2\x8c\x8a52\xe2\x8c\x8b=2 for free. They are items with prices 1 and 2.So you, being the naive customer, don\'t care about how much money you spend. However, you want the total price of the items you get for free to be as large as possible.What is the maximum total price of the items you can get for free on a single purchase?"              
                                  3300.0 1427G "One Billion Shades of Grey" flows,graphs "You have to paint with shades of grey the tiles of an n\xc3\x97n wall. The wall has n rows of tiles, each with n tiles.The tiles on the boundary of the wall (i.e., on the first row, last row, first column and last column) are already painted and you shall not change their color. All the other tiles are not painted. Some of the tiles are broken, you shall not paint those tiles. It is guaranteed that the tiles on the boundary are not broken.You shall paint all the non-broken tiles that are not already painted. When you paint a tile you can choose from 109 shades of grey, indexed from 1 to 109. You can paint multiple tiles with the same shade. Formally, painting the wall is equivalent to assigning a shade (an integer between 1 and 109) to each non-broken tile that is not already painted.The contrast between two tiles is the absolute value of the difference between the shades of the two tiles. The total contrast of the wall is the sum of the contrast of all the pairs of adjacent non-broken tiles (two tiles are adjacent if they share a side).Compute the minimum possible total contrast of the wall."              
                                  2000.0 1427C "The Hard Work of Paparazzi" dp "You are a paparazzi working in Manhattan.Manhattan has r south-to-north streets, denoted by numbers 1,2,\xe2\x80\xa6,r in order from west to east, and r west-to-east streets, denoted by numbers 1,2,\xe2\x80\xa6,r in order from south to north. Each of the r south-to-north streets intersects each of the r west-to-east streets; the intersection between the x-th south-to-north street and the y-th west-to-east street is denoted by (x,y). In order to move from the intersection (x,y) to the intersection (x\xe2\x80\xb2,y\xe2\x80\xb2) you need |x\xe2\x88\x92x\xe2\x80\xb2|+|y\xe2\x88\x92y\xe2\x80\xb2| minutes.You know about the presence of n celebrities in the city and you want to take photos of as many of them as possible. More precisely, for each i=1,\xe2\x80\xa6,n, you know that the i-th celebrity will be at the intersection (xi,yi) in exactly ti minutes from now (and he will stay there for a very short time, so you may take a photo of him only if at the ti-th minute from now you are at the intersection (xi,yi)). You are very good at your job, so you are able to take photos instantaneously. You know that ti<ti+1 for any i=1,2,\xe2\x80\xa6,n\xe2\x88\x921.Currently you are at your office, which is located at the intersection (1,1). If you plan your working day optimally, what is the maximum number of celebrities you can take a photo of?"              
                                  1400.0 1427B "Chess Cheater" greedy,implementation,sortings "You like playing chess tournaments online.In your last tournament you played n games. For the sake of this problem, each chess game is either won or lost (no draws). When you lose a game you get 0 points. When you win you get 1 or 2 points: if you have won also the previous game you get 2 points, otherwise you get 1 point. If you win the very first game of the tournament you get 1 point (since there is not a ""previous game"").The outcomes of the n games are represented by a string s of length n: the i-th character of s is W if you have won the i-th game, while it is L if you have lost the i-th game.After the tournament, you notice a bug on the website that allows you to change the outcome of at most k of your games (meaning that at most k times you can change some symbol L to W, or W to L). Since your only goal is to improve your chess rating, you decide to cheat and use the bug.Compute the maximum score you can get by cheating in the optimal way."              
                                  1500.0 1426D "Non-zero Segments" "constructive algorithms,data structures,greedy,sortings" "Kolya got an integer array a1,a2,\xe2\x80\xa6,an. The array can contain both positive and negative integers, but Kolya doesn\'t like 0, so the array doesn\'t contain any zeros.Kolya doesn\'t like that the sum of some subsegments of his array can be 0. The subsegment is some consecutive segment of elements of the array. You have to help Kolya and change his array in such a way that it doesn\'t contain any subsegments with the sum 0. To reach this goal, you can insert any integers between any pair of adjacent elements of the array (integers can be really any: positive, negative, 0, any by absolute value, even such a huge that they can\'t be represented in most standard programming languages).Your task is to find the minimum number of integers you have to insert into Kolya\'s array in such a way that the resulting array doesn\'t contain any subsegments with the sum 0."              
                                  1400.0 1425F "Flamingoes of Mystery" interactive "This is an interactive problem. You have to use a flush operation right after printing each line. For example, in C++ you should use the function fflush(stdout), in Java \xe2\x80\x94 System.out.flush(), in Pascal \xe2\x80\x94 flush(output) and in Python \xe2\x80\x94 sys.stdout.flush().Mr. Chanek wants to buy a flamingo to accompany his chickens on his farm. Before going to the pet shop, Mr. Chanek stops at an animal festival to have fun. It turns out there is a carnival game with a flamingo as the prize.There are N mysterious cages, which are numbered from 1 to N. Cage i has Ai (0\xe2\x89\xa4Ai\xe2\x89\xa4103) flamingoes inside (1\xe2\x89\xa4i\xe2\x89\xa4N). However, the game master keeps the number of flamingoes inside a secret. To win the flamingo, Mr. Chanek must guess the number of flamingoes in each cage.Coincidentally, Mr. Chanek has N coins. Each coin can be used to ask once, what is the total number of flamingoes inside cages numbered L to R inclusive? With L<R."              
                                  2200.0 1425E "Excitation of Atoms" greedy,implementation "Mr. Chanek is currently participating in a science fair that is popular in town. He finds an exciting puzzle in the fair and wants to solve it.There are N atoms numbered from 1 to N. These atoms are especially quirky. Initially, each atom is in normal state. Each atom can be in an excited. Exciting atom i requires Di energy. When atom i is excited, it will give Ai energy. You can excite any number of atoms (including zero).These atoms also form a peculiar one-way bond. For each i, (1\xe2\x89\xa4i<N), if atom i is excited, atom Ei will also be excited at no cost. Initially, Ei = i+1. Note that atom N cannot form a bond to any atom.Mr. Chanek must change exactly K bonds. Exactly K times, Mr. Chanek chooses an atom i, (1\xe2\x89\xa4i<N) and changes Ei to a different value other than i and the current Ei. Note that an atom\'s bond can remain unchanged or changed more than once. Help Mr. Chanek determine the maximum energy that he can achieve!note: You must first change exactly K bonds before you can start exciting atoms."              
                                  2200.0 1424M "Ancient Language" graphs,sortings "While exploring the old caves, researchers found a book, or more precisely, a stash of mixed pages from a book. Luckily, all of the original pages are present and each page contains its number. Therefore, the researchers can reconstruct the book.After taking a deeper look into the contents of these pages, linguists think that this may be some kind of dictionary. What\'s interesting is that this ancient civilization used an alphabet which is a subset of the English alphabet, however, the order of these letters in the alphabet is not like the one in the English language.Given the contents of pages that researchers have found, your task is to reconstruct the alphabet of this ancient civilization using the provided pages from the dictionary."              
                                  3500.0 1423G "Growing flowers" "data structures" "Sarah has always been a lover of nature, and a couple of years ago she saved up enough money to travel the world and explore all the things built by nature over its lifetime on earth. During this time she visited some truly special places which were left untouched for centuries, from watching icebergs in freezing weather to scuba-diving in oceans and admiring the sea life, residing unseen. These experiences were enhanced with breathtaking views built by mountains over time and left there for visitors to see for years on end. Over time, all these expeditions took a toll on Sarah and culminated in her decision to settle down in the suburbs and live a quiet life. However, as Sarah\'s love for nature never faded, she started growing flowers in her garden in an attempt to stay connected with nature. At the beginning she planted only blue orchids, but over time she started using different flower types to add variety to her collection of flowers. This collection of flowers can be represented as an array of N flowers and the i-th of them has a type associated with it, denoted as Ai. Each resident, passing by her collection and limited by the width of his view, can only see K contiguous flowers at each moment in time. To see the whole collection, the resident will look at the first K contiguous flowers A1,A2,...,AK, then shift his view by one flower and look at the next section of K contiguous flowers A2,A3,...,AK+1 and so on until they scan the whole collection, ending with section AN\xe2\x88\x92K+1,...,AN\xe2\x88\x921,AN.Each resident determines the beautiness of a section of K flowers as the number of distinct flower types in that section. Furthermore, the beautiness of the whole collection is calculated by summing the beautiness values of each contiguous section. Formally, beautiness Bi of a section starting at the i-th position is calculated as Bi=distinct(Ai,Ai+1,...,Ai+K\xe2\x88\x921), and beautiness of the collection B is calculated as B=B1+B2+...+BN\xe2\x88\x92K+1.In addition, as Sarah wants to keep her collection of flowers have a fresh feel, she can also pick two points L and R, dispose flowers between those two points and plant new flowers, all of them being the same type.You will be given Q queries and each of those queries will be of the following two types:   You will be given three integers L,R,X describing that Sarah has planted flowers of type X between positions L and R inclusive. Formally collection is changed such that A[i]=X for all i in range [L..R].  You will be given integer K, width of the resident\'s view and you have to determine the beautiness value B resident has associated with the collection For each query of second type print the result \xe2\x80\x93 beautiness B of the collection."              
                                  2500.0 1420E "Battle Lemmings" dp,greedy "A lighthouse keeper Peter commands an army of n battle lemmings. He ordered his army to stand in a line and numbered the lemmings from 1 to n from left to right. Some of the lemmings hold shields. Each lemming cannot hold more than one shield.The more protected Peter\'s army is, the better. To calculate the protection of the army, he finds the number of protected pairs of lemmings, that is such pairs that both lemmings in the pair don\'t hold a shield, but there is a lemming with a shield between them.Now it\'s time to prepare for defence and increase the protection of the army. To do this, Peter can give orders. He chooses a lemming with a shield and gives him one of the two orders:   give the shield to the left neighbor if it exists and doesn\'t have a shield;  give the shield to the right neighbor if it exists and doesn\'t have a shield. In one second Peter can give exactly one order.It\'s not clear how much time Peter has before the defence. So he decided to determine the maximal value of army protection for each k from 0 to n(n\xe2\x88\x921)2, if he gives no more that k orders. Help Peter to calculate it!"              
                                  900.0 1420A "Cubes Sorting" math,sortings "For god\'s sake, you\'re boxes with legs! It is literally your only purpose! Walking onto buttons! How can you not do the one thing you were designed for?Oh, that\'s funny, is it? Oh it\'s funny? Because we\'ve been at this for twelve hours and you haven\'t solved it either, so I don\'t know why you\'re laughing. You\'ve got one hour! Solve it!  Wheatley decided to try to make a test chamber. He made a nice test chamber, but there was only one detail absent \xe2\x80\x94 cubes.For completing the chamber Wheatley needs n cubes. i-th cube has a volume ai.Wheatley has to place cubes in such a way that they would be sorted in a non-decreasing order by their volume. Formally, for each i>1, ai\xe2\x88\x921\xe2\x89\xa4ai must hold.To achieve his goal, Wheatley can exchange two neighbouring cubes. It means that for any i>1 you can exchange cubes on positions i\xe2\x88\x921 and i.But there is a problem: Wheatley is very impatient. If Wheatley needs more than n\xe2\x8b\x85(n\xe2\x88\x921)2\xe2\x88\x921 exchange operations, he won\'t do this boring work.Wheatly wants to know: can cubes be sorted under this conditions?"              
                                  2100.0 1419E Decryption "constructive algorithms,implementation,math,number theory" "An agent called Cypher is decrypting a message, that contains a composite number n. All divisors of n, which are greater than 1, are placed in a circle. Cypher can choose the initial order of numbers in the circle.In one move Cypher can choose two adjacent numbers in a circle and insert their least common multiple between them. He can do that move as many times as needed.A message is decrypted, if every two adjacent numbers are not coprime. Note that for such constraints it\'s always possible to decrypt the message.Find the minimal number of moves that Cypher should do to decrypt the message, and show the initial order of numbers in the circle for that."              
                                  900.0 1419A "Digit Game" games,greedy,implementation "Everyone knows that agents in Valorant decide, who will play as attackers, and who will play as defenders. To do that Raze and Breach decided to play t matches of a digit game...In each of t matches of the digit game, a positive integer is generated. It consists of n digits. The digits of this integer are numerated from 1 to n from the highest-order digit to the lowest-order digit. After this integer is announced, the match starts.Agents play in turns. Raze starts. In one turn an agent can choose any unmarked digit and mark it. Raze can choose digits on odd positions, but can not choose digits on even positions. Breach can choose digits on even positions, but can not choose digits on odd positions. The match ends, when there is only one unmarked digit left. If the single last digit is odd, then Raze wins, else Breach wins.It can be proved, that before the end of the match (for every initial integer with n digits) each agent has an ability to make a turn, i.e. there is at least one unmarked digit, that stands on a position of required parity.For each of t matches find out, which agent wins, if both of them want to win and play optimally."              
                                  3000.0 1418F "Equal Product" "data structures,math,number theory,two pointers" "You are given four integers n, m, l and r.Let\'s name a tuple (x1,y1,x2,y2) as good if:   1\xe2\x89\xa4x1<x2\xe2\x89\xa4n;  1\xe2\x89\xa4y2<y1\xe2\x89\xa4m;  x1\xe2\x8b\x85y1=x2\xe2\x8b\x85y2;  l\xe2\x89\xa4x1\xe2\x8b\x85y1\xe2\x89\xa4r. Find any good tuple for each x1 from 1 to n inclusive."              
                                  3300.0 1416F "Showing Off" "flows,graph matchings,greedy,implementation" "Another dull quarantine day was going by when BThero decided to start researching matrices of size n\xc3\x97m. The rows are numerated 1 through n from top to bottom, and the columns are numerated 1 through m from left to right. The cell in the i-th row and j-th column is denoted as (i,j).For each cell (i,j) BThero had two values:   The cost of the cell, which is a single positive integer.  The direction of the cell, which is one of characters L, R, D, U. Those characters correspond to transitions to adjacent cells (i,j\xe2\x88\x921), (i,j+1), (i+1,j) or (i\xe2\x88\x921,j), respectively. No transition pointed outside of the matrix. Let us call a cell (i2,j2) reachable from (i1,j1), if, starting from (i1,j1) and repeatedly moving to the adjacent cell according to our current direction, we will, sooner or later, visit (i2,j2). BThero decided to create another matrix from the existing two. For a cell (i,j), let us denote Si,j as a set of all reachable cells from it (including (i,j) itself). Then, the value at the cell (i,j) in the new matrix will be equal to the sum of costs of all cells in Si,j. After quickly computing the new matrix, BThero immediately sent it to his friends. However, he did not save any of the initial matrices! Help him to restore any two valid matrices, which produce the current one."              
                                  3200.0 1416E Split "binary search,data structures,dp,greedy" "One day, BThero decided to play around with arrays and came up with the following problem:You are given an array a, which consists of n positive integers. The array is numerated 1 through n. You execute the following procedure exactly once:  You create a new array b which consists of 2n positive integers, where for each 1\xe2\x89\xa4i\xe2\x89\xa4n the condition b2i\xe2\x88\x921+b2i=ai holds. For example, for the array a=[6,8,2] you can create b=[2,4,4,4,1,1].  You merge consecutive equal numbers in b. For example, b=[2,4,4,4,1,1] becomes b=[2,4,1]. Find and print the minimum possible value of |b| (size of b) which can be achieved at the end of the procedure. It can be shown that under the given constraints there is at least one way to construct b."              
                                  2900.0 1415F "Cakes for Clones" dp "You live on a number line. You are initially (at time moment t=0) located at point x=0. There are n events of the following type: at time ti a small cake appears at coordinate xi. To collect this cake, you have to be at this coordinate at this point, otherwise the cake spoils immediately. No two cakes appear at the same time and no two cakes appear at the same coordinate.You can move with the speed of 1 length unit per one time unit. Also, at any moment you can create a clone of yourself at the same point where you are located. The clone can\'t move, but it will collect the cakes appearing at this position for you. The clone disappears when you create another clone. If the new clone is created at time moment t, the old clone can collect the cakes that appear before or at the time moment t, and the new clone can collect the cakes that appear at or after time moment t.Can you collect all the cakes (by yourself or with the help of clones)?"              
                                  1700.0 1413D Shurikens "data structures,greedy,implementation" "Tenten runs a weapon shop for ninjas. Today she is willing to sell n shurikens which cost 1, 2, ..., n ryo (local currency). During a day, Tenten will place the shurikens onto the showcase, which is empty at the beginning of the day. Her job is fairly simple: sometimes Tenten places another shuriken (from the available shurikens) on the showcase, and sometimes a ninja comes in and buys a shuriken from the showcase. Since ninjas are thrifty, they always buy the cheapest shuriken from the showcase.Tenten keeps a record for all events, and she ends up with a list of the following types of records:  + means that she placed another shuriken on the showcase;  - x means that the shuriken of price x was bought. Today was a lucky day, and all shurikens were bought. Now Tenten wonders if her list is consistent, and what could be a possible order of placing the shurikens on the showcase. Help her to find this out!"              
                                  2300.0 1411E "Poman Numbers" bitmasks,greedy,math,strings "You\'ve got a string S consisting of n lowercase English letters from your friend. It turned out that this is a number written in poman numerals. The poman numeral system is long forgotten. All that\'s left is the algorithm to transform number from poman numerals to the numeral system familiar to us. Characters of S are numbered from 1 to n from left to right. Let\'s denote the value of S as f(S), it is defined as follows:   If |S|>1, an arbitrary integer m (1\xe2\x89\xa4m<|S|) is chosen, and it is defined that f(S)=\xe2\x88\x92f(S[1,m])+f(S[m+1,|S|]), where S[l,r] denotes the substring of S from the l-th to the r-th position, inclusively.  Otherwise S=c, where c is some English letter. Then f(S)=2pos(c), where pos(c) is the position of letter c in the alphabet (pos(a)=0, pos(z)=25). Note that m is chosen independently on each step.Your friend thinks it is possible to get f(S)=T by choosing the right m on every step. Is he right?"              
                                  2400.0 1408E "Avoid Rainbow Cycles" "data structures,dsu,graphs,greedy,sortings,trees" "You are given m sets of integers A1,A2,\xe2\x80\xa6,Am; elements of these sets are integers between 1 and n, inclusive.There are two arrays of positive integers a1,a2,\xe2\x80\xa6,am and b1,b2,\xe2\x80\xa6,bn. In one operation you can delete an element j from the set Ai and pay ai+bj coins for that.You can make several (maybe none) operations (some sets can become empty).After that, you will make an edge-colored undirected graph consisting of n vertices. For each set Ai you will add an edge (x,y) with color i for all x,y\xe2\x88\x88Ai and x<y. Some pairs of vertices can be connected with more than one edge, but such edges have different colors.You call a cycle i1\xe2\x86\x92e1\xe2\x86\x92i2\xe2\x86\x92e2\xe2\x86\x92\xe2\x80\xa6\xe2\x86\x92ik\xe2\x86\x92ek\xe2\x86\x92i1 (ej is some edge connecting vertices ij and ij+1 in this graph) rainbow if all edges on it have different colors.Find the minimum number of coins you should pay to get a graph without rainbow cycles."              
                                  1200.0 1406B "Maximum Product" "brute force,dp,greedy,implementation,sortings" "You are given an array of integers a1,a2,\xe2\x80\xa6,an. Find the maximum possible value of aiajakalat among all five indices (i,j,k,l,t) (i<j<k<l<t)."              
                                  900.0 1406A "Subset Mex" greedy,implementation,math "Given a set of integers (it can contain equal elements).You have to split it into two subsets A and B (both of them can contain equal elements or be empty). You have to maximize the value of mex(A)+mex(B).Here mex of a set denotes the smallest non-negative integer that doesn\'t exist in the set. For example:   mex({1,4,0,2,2,1})=3  mex({3,3,2,1,3,0,0})=4  mex(\xe2\x88\x85)=0 (mex for empty set) The set is splitted into two subsets A and B if for any integer number x the number of occurrences of x into this set is equal to the sum of the number of occurrences of x into A and the number of occurrences of x into B."              
                                  2300.0 1404C "Fixed Point Removal" "binary search,constructive algorithms,data structures,greedy,two pointers" "Let a1,\xe2\x80\xa6,an be an array of n positive integers. In one operation, you can choose an index i such that ai=i, and remove ai from the array (after the removal, the remaining parts are concatenated).The weight of a is defined as the maximum number of elements you can remove.You must answer q independent queries (x,y): after replacing the x first elements of a and the y last elements of a by n+1 (making them impossible to remove), what would be the weight of a?"              
                                  1800.0 1402A "Fancy Fence" "*special problem,data structures,dsu,implementation,math,sortings" "Everybody knows that Bal\xc3\xa1zs has the fanciest fence in the whole town. It\'s built up from N fancy sections. The sections are rectangles standing closely next to each other on the ground. The ith section has integer height hi and integer width wi.  We are looking for fancy rectangles on this fancy fence.  A rectangle is fancy if:   its sides are either horizontal or vertical and have integer lengths  the distance between the rectangle and the ground is integer  the distance between the rectangle and the left side of the first section is integer  it\'s lying completely on sections  What is the number of fancy rectangles?  This number can be very big, so we are interested in it modulo 109+7."              
                                  2100.0 1393D "Rarity and New Dress" "dfs and similar,dp,implementation,shortest paths" "Carousel Boutique is busy again! Rarity has decided to visit the pony ball and she surely needs a new dress, because going out in the same dress several times is a sign of bad manners. First of all, she needs a dress pattern, which she is going to cut out from the rectangular piece of the multicolored fabric.The piece of the multicolored fabric consists of n\xc3\x97m separate square scraps. Since Rarity likes dresses in style, a dress pattern must only include scraps sharing the same color. A dress pattern must be the square, and since Rarity is fond of rhombuses, the sides of a pattern must form a 45\xe2\x88\x98 angle with sides of a piece of fabric (that way it will be resembling the traditional picture of a rhombus).Examples of proper dress patterns:  Examples of improper dress patterns:  The first one consists of multi-colored scraps, the second one goes beyond the bounds of the piece of fabric, the third one is not a square with sides forming a 45\xe2\x88\x98 angle with sides of the piece of fabric.Rarity wonders how many ways to cut out a dress pattern that satisfies all the conditions that do exist. Please help her and satisfy her curiosity so she can continue working on her new masterpiece!"              
                                  1700.0 1393C "Pinkie Pie Eats Patty-cakes" "constructive algorithms,greedy,math,sortings" "Pinkie Pie has bought a bag of patty-cakes with different fillings! But it appeared that not all patty-cakes differ from one another with filling. In other words, the bag contains some patty-cakes with the same filling.Pinkie Pie eats the patty-cakes one-by-one. She likes having fun so she decided not to simply eat the patty-cakes but to try not to eat the patty-cakes with the same filling way too often. To achieve this she wants the minimum distance between the eaten with the same filling to be the largest possible. Herein Pinkie Pie called the distance between two patty-cakes the number of eaten patty-cakes strictly between them.Pinkie Pie can eat the patty-cakes in any order. She is impatient about eating all the patty-cakes up so she asks you to help her to count the greatest minimum distance between the eaten patty-cakes with the same filling amongst all possible orders of eating!Pinkie Pie is going to buy more bags of patty-cakes so she asks you to solve this problem for several bags!"              
                                  1400.0 1393B "Applejack and Storages" "constructive algorithms,data structures,greedy,implementation" "This year in Equestria was a year of plenty, so Applejack has decided to build some new apple storages. According to the advice of the farm designers, she chose to build two storages with non-zero area: one in the shape of a square and another one in the shape of a rectangle (which possibly can be a square as well).Applejack will build the storages using planks, she is going to spend exactly one plank on each side of the storage. She can get planks from her friend\'s company. Initially, the company storehouse has n planks, Applejack knows their lengths. The company keeps working so it receives orders and orders the planks itself. Applejack\'s friend can provide her with information about each operation. For convenience, he will give her information according to the following format:  + x: the storehouse received a plank with length x  \xe2\x88\x92 x: one plank with length x was removed from the storehouse (it is guaranteed that the storehouse had some planks with length x). Applejack is still unsure about when she is going to order the planks so she wants to know if she can order the planks to build rectangular and square storages out of them after every event at the storehouse. Applejack is busy collecting apples and she has completely no time to do the calculations so she asked you for help!We remind you that all four sides of a square are equal, and a rectangle has two pairs of equal sides."              
                                  2600.0 1389F "Bicolored Segments" "data structures,dp,graph matchings,sortings" "You are given n segments [l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn]. Each segment has one of two colors: the i-th segment\'s color is ti.Let\'s call a pair of segments i and j bad if the following two conditions are met:  ti\xe2\x89\xa0tj;  the segments [li,ri] and [lj,rj] intersect, embed or touch, i.\xe2\x80\x89e. there exists an integer x such that x\xe2\x88\x88[li,ri] and x\xe2\x88\x88[lj,rj]. Calculate the maximum number of segments that can be selected from the given ones, so that there is no bad pair among the selected ones."              
                                  1500.0 1389C "Good String" "brute force,dp,greedy,two pointers" "Let\'s call left cyclic shift of some string t1t2t3\xe2\x80\xa6tn\xe2\x88\x921tn as string t2t3\xe2\x80\xa6tn\xe2\x88\x921tnt1.Analogically, let\'s call right cyclic shift of string t as string tnt1t2t3\xe2\x80\xa6tn\xe2\x88\x921.Let\'s say string t is good if its left cyclic shift is equal to its right cyclic shift.You are given string s which consists of digits 0\xe2\x80\x939.What is the minimum number of characters you need to erase from s to make it good?"              
                                  2100.0 1387A Graph "*special problem,binary search,dfs and similar,dp,math,ternary search" "You are given an undirected graph where each edge has one of two colors: black or red.Your task is to assign a real number to each node so that:   for each black edge the sum of values at its endpoints is 1;  for each red edge the sum of values at its endpoints is 2;  the sum of the absolute values of all assigned numbers is the smallest possible. Otherwise, if it is not possible, report that there is no feasible assignment of the numbers."              
                                  2800.0 1386C Joker "*special problem,bitmasks,data structures,divide and conquer,dsu" "Joker returns to Gotham City to execute another evil plan. In Gotham City, there are N street junctions (numbered from 1 to N) and M streets (numbered from 1 to M). Each street connects two distinct junctions, and two junctions are connected by at most one street.For his evil plan, Joker needs to use an odd number of streets that together form a cycle. That is, for a junction S and an even positive integer k, there is a sequence of junctions S,s1,\xe2\x80\xa6,sk,S such that there are streets connecting (a) S and s1, (b) sk and S, and (c) si\xe2\x88\x921 and si for each i=2,\xe2\x80\xa6,k.However, the police are controlling the streets of Gotham City. On each day i, they monitor a different subset of all streets with consecutive numbers j: li\xe2\x89\xa4j\xe2\x89\xa4ri. These monitored streets cannot be a part of Joker\'s plan, of course. Unfortunately for the police, Joker has spies within the Gotham City Police Department; they tell him which streets are monitored on which day. Now Joker wants to find out, for some given number of days, whether he can execute his evil plan. On such a day there must be a cycle of streets, consisting of an odd number of streets which are not monitored on that day."              
                                  1700.0 1383A "String Transformation 1" "dsu,graphs,greedy,sortings,strings,trees,two pointers" "Note that the only difference between String Transformation 1 and String Transformation 2 is in the move Koa does. In this version the letter y Koa selects must be strictly greater alphabetically than x (read statement for better understanding). You can make hacks in these problems independently.Koa the Koala has two strings A and B of the same length n (|A|=|B|=n) consisting of the first 20 lowercase English alphabet letters (ie. from a to t).In one move Koa:  selects some subset of positions p1,p2,\xe2\x80\xa6,pk (k\xe2\x89\xa51;1\xe2\x89\xa4pi\xe2\x89\xa4n;pi\xe2\x89\xa0pj if i\xe2\x89\xa0j) of A such that Ap1=Ap2=\xe2\x80\xa6=Apk=x (ie. all letters on this positions are equal to some letter x).  selects a letter y (from the first 20 lowercase letters in English alphabet) such that y>x (ie. letter y is strictly greater alphabetically than x).  sets each letter in positions p1,p2,\xe2\x80\xa6,pk to letter y. More formally: for each i (1\xe2\x89\xa4i\xe2\x89\xa4k) Koa sets Api=y. Note that you can only modify letters in string A.Koa wants to know the smallest number of moves she has to do to make strings equal to each other (A=B) or to determine that there is no way to make them equal. Help her!"              
                                  3000.0 1381D "The Majestic Brown Tree Snake" "dfs and similar,dp,greedy,trees,two pointers" "There is an undirected tree of n vertices, connected by n\xe2\x88\x921 bidirectional edges. There is also a snake stuck inside of this tree. Its head is at vertex a and its tail is at vertex b. The snake\'s body occupies all vertices on the unique simple path between a and b.The snake wants to know if it can reverse itself  \xe2\x80\x94 that is, to move its head to where its tail started, and its tail to where its head started. Unfortunately, the snake\'s movements are restricted to the tree\'s structure.In an operation, the snake can move its head to an adjacent vertex not currently occupied by the snake. When it does this, the tail moves one vertex closer to the head, so that the length of the snake remains unchanged. Similarly, the snake can also move its tail to an adjacent vertex not currently occupied by the snake. When it does this, the head moves one unit closer to the tail.  Let\'s denote a snake position by (h,t), where h is the index of the vertex with the snake\'s head, t is the index of the vertex with the snake\'s tail. This snake can reverse itself with the movements (4,7)\xe2\x86\x92(5,1)\xe2\x86\x92(4,2)\xe2\x86\x92(1,3)\xe2\x86\x92(7,2)\xe2\x86\x92(8,1)\xe2\x86\x92(7,4). Determine if it is possible to reverse the snake with some sequence of operations."              
                                  1300.0 1381A1 "Prefix Flip (Easy Version)" "constructive algorithms,data structures,strings" "This is the easy version of the problem. The difference between the versions is the constraint on n and the required number of operations. You can make hacks only if all versions of the problem are solved.There are two binary strings a and b of length n (a binary string is a string consisting of symbols 0 and 1). In an operation, you select a prefix of a, and simultaneously invert the bits in the prefix (0 changes to 1 and 1 changes to 0) and reverse the order of the bits in the prefix.For example, if a=001011 and you select the prefix of length 3, it becomes 011011. Then if you select the entire string, it becomes 001001.Your task is to transform the string a into b in at most 3n operations. It can be proved that it is always possible."              
                                  2600.0 1380F "Strange Addition" "data structures,dp,matrices" "Let a and b be some non-negative integers. Let\'s define strange addition of a and b as following:  write down the numbers one under another and align them by their least significant digit;  add them up digit by digit and concatenate the respective sums together. Assume that both numbers have an infinite number of leading zeros.For example, let\'s take a look at a strange addition of numbers 3248 and 908:  You are given a string c, consisting of n digits from 0 to 9. You are also given m updates of form:   x d \xe2\x80\x94 replace the digit at the x-th position of c with a digit d. Note that string c might have leading zeros at any point of time.After each update print the number of pairs (a,b) such that both a and b are non-negative integers and the result of a strange addition of a and b is equal to c.Note that the numbers of pairs can be quite large, so print them modulo 998244353."              
                                  2300.0 1379D "New Passenger Trams" "binary search,brute force,data structures,sortings,two pointers" "There are many freight trains departing from Kirnes planet every day. One day on that planet consists of h hours, and each hour consists of m minutes, where m is an even number. Currently, there are n freight trains, and they depart every day at the same time: i-th train departs at hi hours and mi minutes.The government decided to add passenger trams as well: they plan to add a regular tram service with half-hour intervals. It means that the first tram of the day must depart at 0 hours and t minutes, where 0\xe2\x89\xa4t<m2, the second tram departs m2 minutes after the first one and so on. This schedule allows exactly two passenger trams per hour, which is a great improvement.To allow passengers to board the tram safely, the tram must arrive k minutes before. During the time when passengers are boarding the tram, no freight train can depart from the planet. However, freight trains are allowed to depart at the very moment when the boarding starts, as well as at the moment when the passenger tram departs. Note that, if the first passenger tram departs at 0 hours and t minutes, where t<k, then the freight trains can not depart during the last k\xe2\x88\x92t minutes of the day.  A schematic picture of the correct way to run passenger trams. Here h=2 (therefore, the number of passenger trams is 2h=4), the number of freight trains is n=6. The passenger trams are marked in red (note that the spaces between them are the same). The freight trains are marked in blue. Time segments of length k before each passenger tram are highlighted in red. Note that there are no freight trains inside these segments. Unfortunately, it might not be possible to satisfy the requirements of the government without canceling some of the freight trains. Please help the government find the optimal value of t to minimize the number of canceled freight trains in case all passenger trams depart according to schedule."              
                                  1600.0 1373D "Maximum Sum on Even Positions" "divide and conquer,dp,greedy,implementation" "You are given an array a consisting of n integers. Indices of the array start from zero (i.\xe2\x80\x89e. the first element is a0, the second one is a1, and so on).You can reverse at most one subarray (continuous subsegment) of this array. Recall that the subarray of a with borders l and r is a[l;r]=al,al+1,\xe2\x80\xa6,ar.Your task is to reverse such a subarray that the sum of elements on even positions of the resulting array is maximized (i.\xe2\x80\x89e. the sum of elements a0,a2,\xe2\x80\xa6,a2k for integer k=\xe2\x8c\x8an\xe2\x88\x9212\xe2\x8c\x8b should be maximum possible).You have to answer t independent test cases."              
                                  800.0 1370A "Maximum GCD" "greedy,implementation,math,number theory" "Let\'s consider all integers in the range from 1 to n (inclusive).Among all pairs of distinct integers in this range, find the maximum possible greatest common divisor of integers in pair. Formally, find the maximum value of gcd(a,b), where 1\xe2\x89\xa4a<b\xe2\x89\xa4n.The greatest common divisor, gcd(a,b), of two positive integers a and b is the biggest integer that is a divisor of both a and b."              
                                  1500.0 1368B "Codeforces Subsequences" "brute force,constructive algorithms,greedy,math,strings" "Karl likes Codeforces and subsequences. He wants to find a string of lowercase English letters that contains at least k subsequences codeforces. Out of all possible strings, Karl wants to find a shortest one.Formally, a codeforces subsequence of a string s is a subset of ten characters of s that read codeforces from left to right. For example, codeforces contains codeforces a single time, while codeforcesisawesome contains codeforces four times: codeforcesisawesome, codeforcesisawesome, codeforcesisawesome, codeforcesisawesome.Help Karl find any shortest string that contains at least k codeforces subsequences."              
                                  800.0 1368A C+= "brute force,greedy,implementation,math" "Leo has developed a new programming language C+=. In C+=, integer variables can only be changed with a ""+="" operation that adds the right-hand side value to the left-hand side variable. For example, performing ""a += b"" when a = 2, b = 3 changes the value of a to 5 (the value of b does not change).In a prototype program Leo has two integer variables a and b, initialized with some positive values. He can perform any number of operations ""a += b"" or ""b += a"". Leo wants to test handling large integers, so he wants to make the value of either a or b strictly greater than a given value n. What is the smallest number of operations he has to perform?"              
                                  2400.0 1367F2 "Flying Sort (Hard Version)" "binary search,data structures,dp,greedy,sortings,two pointers" "This is a hard version of the problem. In this version, the given array can contain equal elements and the constraints on n are greater than in the easy version of the problem.You are given an array a of n integers (the given array can contain equal elements). You can perform the following operations on array elements:  choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and move the element a[i] to the begin of the array;  choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and move the element a[i] to the end of the array. For example, if n=5, a=[4,7,2,2,9], then the following sequence of operations can be performed:   after performing the operation of the first type to the second element, the array a will become [7,4,2,2,9];  after performing the operation of the second type to the second element, the array a will become [7,2,2,9,4]. You can perform operations of any type any number of times in any order.Find the minimum total number of operations of the first and second type that will make the a array sorted in non-decreasing order. In other words, what is the minimum number of operations must be performed so the array satisfies the inequalities a[1]\xe2\x89\xa4a[2]\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4a[n]."              
                                  2100.0 1367F1 "Flying Sort (Easy Version)" "dp,greedy,two pointers" "This is an easy version of the problem. In this version, all numbers in the given array are distinct and the constraints on n are less than in the hard version of the problem.You are given an array a of n integers (there are no equals elements in the array). You can perform the following operations on array elements:  choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and move the element a[i] to the begin of the array;  choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and move the element a[i] to the end of the array. For example, if n=5, a=[4,7,2,3,9], then the following sequence of operations can be performed:   after performing the operation of the first type to the second element, the array a will become [7,4,2,3,9];  after performing the operation of the second type to the second element, the array a will become [7,2,3,9,4]. You can perform operations of any type any number of times in any order.Find the minimum total number of operations of the first and second type that will make the a array sorted in non-decreasing order. In other words, what is the minimum number of operations that must be performed so the array satisfies the inequalities a[1]\xe2\x89\xa4a[2]\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4a[n]."              
                                  2700.0 1366G "Construct the String" "data structures,dp,strings" "Let\'s denote the function f(s) that takes a string s consisting of lowercase Latin letters and dots, and returns a string consisting of lowercase Latin letters as follows:  let r be an empty string;  process the characters of s from left to right. For each character c, do the following: if c is a lowercase Latin letter, append c at the end of the string r; otherwise, delete the last character from r (if r is empty before deleting the last character \xe2\x80\x94 the function crashes);  return r as the result of the function. You are given two strings s and t. You have to delete the minimum possible number of characters from s so that f(s)=t (and the function does not crash). Note that you aren\'t allowed to insert new characters into s or reorder the existing ones."              
                                  1200.0 1363A "Odd Selection" "brute force,implementation,math" "Shubham has an array a of size n, and wants to select exactly x elements from it, such that their sum is odd. These elements do not have to be consecutive. The elements of the array are not guaranteed to be distinct.Tell him whether he can do so."              
                                  3300.0 1361F "Johnny and New Toy" "data structures,implementation,math" "Johnny has a new toy. As you may guess, it is a little bit extraordinary. The toy is a permutation P of numbers from 1 to n, written in one row next to each other. For each i from 1 to n\xe2\x88\x921 between Pi and Pi+1 there is a weight Wi written, and those weights form a permutation of numbers from 1 to n\xe2\x88\x921. There are also extra weights W0=Wn=0.The instruction defines subsegment [L,R] as good if WL\xe2\x88\x921<Wi and WR<Wi for any i in {L,L+1,\xe2\x80\xa6,R\xe2\x88\x921}. For such subsegment it also defines WM as minimum of set {WL,WL+1,\xe2\x80\xa6,WR\xe2\x88\x921}. Now the fun begins. In one move, the player can choose one of the good subsegments, cut it into [L,M] and [M+1,R] and swap the two parts. More precisely, before one move the chosen subsegment of our toy looks like: WL\xe2\x88\x921,PL,WL,\xe2\x80\xa6,WM\xe2\x88\x921,PM,WM,PM+1,WM+1,\xe2\x80\xa6,WR\xe2\x88\x921,PR,WR and afterwards it looks like this: WL\xe2\x88\x921,PM+1,WM+1,\xe2\x80\xa6,WR\xe2\x88\x921,PR,WM,PL,WL,\xe2\x80\xa6,WM\xe2\x88\x921,PM,WR Such a move can be performed multiple times (possibly zero), and the goal is to achieve the minimum number of inversions in P. Johnny\'s younger sister Megan thinks that the rules are too complicated, so she wants to test her brother by choosing some pair of indices X and Y, and swapping PX and PY (X might be equal Y). After each sister\'s swap, Johnny wonders, what is the minimal number of inversions that he can achieve, starting with current P and making legal moves?You can assume that the input is generated randomly. P and W were chosen independently and equiprobably over all permutations; also, Megan\'s requests were chosen independently and equiprobably over all pairs of indices."              
                                  3000.0 1361E "James and the Chase" "dfs and similar,graphs,probabilities,trees" "James Bond has a new plan for catching his enemy. There are some cities and directed roads between them, such that it is possible to travel between any two cities using these roads. When the enemy appears in some city, Bond knows her next destination but has no idea which path she will choose to move there. The city a is called interesting, if for each city b, there is exactly one simple path from a to b. By a simple path, we understand a sequence of distinct cities, such that for every two neighboring cities, there exists a directed road from the first to the second city. Bond\'s enemy is the mistress of escapes, so only the chase started in an interesting city gives the possibility of catching her. James wants to arrange his people in such cities. However, if there are not enough interesting cities, the whole action doesn\'t make sense since Bond\'s people may wait too long for the enemy.You are responsible for finding all the interesting cities or saying that there is not enough of them. By not enough, James means strictly less than 20% of all cities."              
                                  1700.0 1361A "Johnny and Contribution" "constructive algorithms,graphs,greedy,sortings" "Today Johnny wants to increase his contribution. His plan assumes writing n blogs. One blog covers one topic, but one topic can be covered by many blogs. Moreover, some blogs have references to each other. Each pair of blogs that are connected by a reference has to cover different topics because otherwise, the readers can notice that they are split just for more contribution. Set of blogs and bidirectional references between some pairs of them is called blogs network.There are n different topics, numbered from 1 to n sorted by Johnny\'s knowledge. The structure of the blogs network is already prepared. Now Johnny has to write the blogs in some order. He is lazy, so each time before writing a blog, he looks at it\'s already written neighbors (the blogs referenced to current one) and chooses the topic with the smallest number which is not covered by neighbors. It\'s easy to see that this strategy will always allow him to choose a topic because there are at most n\xe2\x88\x921 neighbors.For example, if already written neighbors of the current blog have topics number 1, 3, 1, 5, and 2, Johnny will choose the topic number 4 for the current blog, because topics number 1, 2 and 3 are already covered by neighbors and topic number 4 isn\'t covered.As a good friend, you have done some research and predicted the best topic for each blog. Can you tell Johnny, in which order he has to write the blogs, so that his strategy produces the topic assignment chosen by you?"              
                                  2900.0 1359F "RC Kaboom Show" "binary search,brute force,data structures,geometry,math" "You know, it\'s hard to conduct a show with lots of participants and spectators at the same place nowadays. Still, you are not giving up on your dream to make a car crash showcase! You decided to replace the real cars with remote controlled ones, call the event ""Remote Control Kaboom Show"" and stream everything online.For the preparation you arranged an arena \xe2\x80\x94 an infinite 2D-field. You also bought n remote controlled cars and set them up on the arena. Unfortunately, the cars you bought can only go forward without turning left, right or around. So you additionally put the cars in the direction you want them to go.To be formal, for each car i (1\xe2\x89\xa4i\xe2\x89\xa4n) you chose its initial position (xi,yi) and a direction vector (dxi,dyi). Moreover, each car has a constant speed si units per second. So after car i is launched, it stars moving from (xi,yi) in the direction (dxi,dyi) with constant speed si.The goal of the show is to create a car collision as fast as possible! You noted that launching every car at the beginning of the show often fails to produce any collisions at all. Thus, you plan to launch the i-th car at some moment ti. You haven\'t chosen ti, that\'s yet to be decided. Note that it\'s not necessary for ti to be integer and ti is allowed to be equal to tj for any i,j.The show starts at time 0. The show ends when two cars i and j (i\xe2\x89\xa0j) collide (i.\xe2\x80\x89e. come to the same coordinate at the same time). The duration of the show is the time between the start and the end.What\'s the fastest crash you can arrange by choosing all ti? If it\'s possible to arrange a crash then print the shortest possible duration of the show. Otherwise, report that it\'s impossible."              
                                  2000.0 1359D "Yet Another Yet Another Task" "data structures,dp,implementation,two pointers" "Alice and Bob are playing yet another card game. This time the rules are the following. There are n cards lying in a row in front of them. The i-th card has value ai. First, Alice chooses a non-empty consecutive segment of cards [l;r] (l\xe2\x89\xa4r). After that Bob removes a single card j from that segment (l\xe2\x89\xa4j\xe2\x89\xa4r). The score of the game is the total value of the remaining cards on the segment (al+al+1+\xe2\x8b\xaf+aj\xe2\x88\x921+aj+1+\xe2\x8b\xaf+ar\xe2\x88\x921+ar). In particular, if Alice chooses a segment with just one element, then the score after Bob removes the only card is 0.Alice wants to make the score as big as possible. Bob takes such a card that the score is as small as possible.What segment should Alice choose so that the score is maximum possible? Output the maximum score."              
                                  1000.0 1359A "Berland Poker" "brute force,greedy,math" "The game of Berland poker is played with a deck of n cards, m of which are jokers. k players play this game (n is divisible by k).At the beginning of the game, each player takes nk cards from the deck (so each card is taken by exactly one player). The player who has the maximum number of jokers is the winner, and he gets the number of points equal to x\xe2\x88\x92y, where x is the number of jokers in the winner\'s hand, and y is the maximum number of jokers among all other players. If there are two or more players with maximum number of jokers, all of them are winners and they get 0 points.Here are some examples:  n=8, m=3, k=2. If one player gets 3 jokers and 1 plain card, and another player gets 0 jokers and 4 plain cards, then the first player is the winner and gets 3\xe2\x88\x920=3 points;  n=4, m=2, k=4. Two players get plain cards, and the other two players get jokers, so both of them are winners and get 0 points;  n=9, m=6, k=3. If the first player gets 3 jokers, the second player gets 1 joker and 2 plain cards, and the third player gets 2 jokers and 1 plain card, then the first player is the winner, and he gets 3\xe2\x88\x922=1 point;  n=42, m=0, k=7. Since there are no jokers, everyone gets 0 jokers, everyone is a winner, and everyone gets 0 points. Given n, m and k, calculate the maximum number of points a player can get for winning the game."              
                                  -999.0 1356A5 "Distinguish Z from -Z" "*special problem" "You are given an operation that implements a single-qubit unitary transformation: either the Z gate or the -Z gate (i.e., the \xe2\x88\x92|0\xe2\x9f\xa9\xe2\x9f\xa80|+|1\xe2\x9f\xa9\xe2\x9f\xa81| gate: (\xe2\x88\x92Z)(\xce\xb1|0\xe2\x9f\xa9+\xce\xb2|1\xe2\x9f\xa9)=\xe2\x88\x92\xce\xb1|0\xe2\x9f\xa9+\xce\xb2|1\xe2\x9f\xa9). The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the Z gate or 1 if it was the -Z gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly once.You have to implement an operation which takes a single-qubit operation as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit => Unit is Adj+Ctl)) : Int {        // your code here    }}"              
                                  -999.0 1356A3 "Distinguish Z from S" "*special problem" "You are given an operation that implements a single-qubit unitary transformation: either the Z gate or the S gate. The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the Z gate or 1 if it was the S gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly twice.You have to implement an operation which takes a single-qubit operation as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit => Unit is Adj+Ctl)) : Int {        // your code here    }}"              
                                  2100.0 1355E "Restorer Distance" "binary search,greedy,math,sortings,ternary search" "You have to restore the wall. The wall consists of N pillars of bricks, the height of the i-th pillar is initially equal to hi, the height is measured in number of bricks. After the restoration all the N pillars should have equal heights.You are allowed the following operations: put a brick on top of one pillar, the cost of this operation is A; remove a brick from the top of one non-empty pillar, the cost of this operation is R; move a brick from the top of one non-empty pillar to the top of another pillar, the cost of this operation is M.You cannot create additional pillars or ignore some of pre-existing pillars even if their height becomes 0.What is the minimal total cost of restoration, in other words, what is the minimal total cost to make all the pillars of equal height?"              
                                  2500.0 1354F "Summoning Minions" "constructive algorithms,dp,flows,graph matchings,greedy,sortings" "Polycarp plays a computer game. In this game, the players summon armies of magical minions, which then fight each other.Polycarp can summon n different minions. The initial power level of the i-th minion is ai, and when it is summoned, all previously summoned minions\' power levels are increased by bi. The minions can be summoned in any order.Unfortunately, Polycarp cannot have more than k minions under his control. To get rid of unwanted minions after summoning them, he may destroy them. Each minion can be summoned (and destroyed) only once.Polycarp\'s goal is to summon the strongest possible army. Formally, he wants to maximize the sum of power levels of all minions under his control (those which are summoned and not destroyed).Help Polycarp to make up a plan of actions to summon the strongest possible army!"              
                                  900.0 1354A "Alarm Clock" math "Polycarp has spent the entire day preparing problems for you. Now he has to sleep for at least a minutes to feel refreshed.Polycarp can only wake up by hearing the sound of his alarm. So he has just fallen asleep and his first alarm goes off in b minutes.Every time Polycarp wakes up, he decides if he wants to sleep for some more time or not. If he\'s slept for less than a minutes in total, then he sets his alarm to go off in c minutes after it is reset and spends d minutes to fall asleep again. Otherwise, he gets out of his bed and proceeds with the day.If the alarm goes off while Polycarp is falling asleep, then he resets his alarm to go off in another c minutes and tries to fall asleep for d minutes again.You just want to find out when will Polycarp get out of his bed or report that it will never happen.Please check out the notes for some explanations of the example."              
                                  1000.0 1353C "Board Moves" math "You are given a board of size n\xc3\x97n, where n is odd (not divisible by 2). Initially, each cell of the board contains one figure.In one move, you can select exactly one figure presented in some cell and move it to one of the cells sharing a side or a corner with the current cell, i.e. from the cell (i,j) you can move the figure to cells:   (i\xe2\x88\x921,j\xe2\x88\x921);  (i\xe2\x88\x921,j);  (i\xe2\x88\x921,j+1);  (i,j\xe2\x88\x921);  (i,j+1);  (i+1,j\xe2\x88\x921);  (i+1,j);  (i+1,j+1); Of course, you can not move figures to cells out of the board. It is allowed that after a move there will be several figures in one cell.Your task is to find the minimum number of moves needed to get all the figures into one cell (i.e. n2\xe2\x88\x921 cells should contain 0 figures and one cell should contain n2 figures).You have to answer t independent test cases."              
                                  3200.0 1349D "Slime and Biscuits" math,probabilities "Slime and his n friends are at a party. Slime has designed a game for his friends to play.At the beginning of the game, the i-th player has ai biscuits. At each second, Slime will choose a biscuit randomly uniformly among all a1+a2+\xe2\x80\xa6+an biscuits, and the owner of this biscuit will give it to a random uniform player among n\xe2\x88\x921 players except himself. The game stops when one person will have all the biscuits.As the host of the party, Slime wants to know the expected value of the time that the game will last, to hold the next activity on time.For convenience, as the answer can be represented as a rational number pq for coprime p and q, you need to find the value of (p\xe2\x8b\x85q\xe2\x88\x921)mod998244353. You can prove that qmod998244353\xe2\x89\xa00."              
                                  1600.0 1348C "Phoenix and Distribution" "constructive algorithms,greedy,sortings,strings" "Phoenix has a string s consisting of lowercase Latin letters. He wants to distribute all the letters of his string into k non-empty strings a1,a2,\xe2\x80\xa6,ak such that every letter of s goes to exactly one of the strings ai. The strings ai do not need to be substrings of s. Phoenix can distribute letters of s and rearrange the letters within each string ai however he wants.For example, if s= baba and k=2, Phoenix may distribute the letters of his string in many ways, such as:   ba and ba  a and abb  ab and ab  aa and bb But these ways are invalid:   baa and ba  b and ba  baba and empty string (ai should be non-empty) Phoenix wants to distribute the letters of his string s into k strings a1,a2,\xe2\x80\xa6,ak to minimize the lexicographically maximum string among them, i. e. minimize max(a1,a2,\xe2\x80\xa6,ak). Help him find the optimal distribution and print the minimal possible value of max(a1,a2,\xe2\x80\xa6,ak).String x is lexicographically less than string y if either x is a prefix of y and x\xe2\x89\xa0y, or there exists an index i (1\xe2\x89\xa4i\xe2\x89\xa4min(|x|,|y|)) such that xi < yi and for every j (1\xe2\x89\xa4j<i) xj=yj. Here |x| denotes the length of the string x."              
                                  1100.0 1345B "Card Constructions" "binary search,brute force,dp,math" "A card pyramid of height 1 is constructed by resting two cards against each other. For h>1, a card pyramid of height h is constructed by placing a card pyramid of height h\xe2\x88\x921 onto a base. A base consists of h pyramids of height 1, and h\xe2\x88\x921 cards on top. For example, card pyramids of heights 1, 2, and 3 look as follows:  You start with n cards and build the tallest pyramid that you can. If there are some cards remaining, you build the tallest pyramid possible with the remaining cards. You repeat this process until it is impossible to build another pyramid. In the end, how many pyramids will you have constructed?"              
                                  800.0 1345A "Puzzle Pieces" math "You are given a special jigsaw puzzle consisting of n\xe2\x8b\x85m identical pieces. Every piece has three tabs and one blank, as pictured below.  The jigsaw puzzle is considered solved if the following conditions hold:  The pieces are arranged into a grid with n rows and m columns.  For any two pieces that share an edge in the grid, a tab of one piece fits perfectly into a blank of the other piece. Through rotation and translation of the pieces, determine if it is possible to solve the jigsaw puzzle."              
                                  2700.0 1344D "R\xc3\xa9sum\xc3\xa9 Review" "binary search,greedy,math" "Uh oh! Applications to tech companies are due soon, and you\'ve been procrastinating by doing contests instead! (Let\'s pretend for now that it is actually possible to get a job in these uncertain times.)You have completed many programming projects. In fact, there are exactly n types of programming projects, and you have completed ai projects of type i. Your r\xc3\xa9sum\xc3\xa9 has limited space, but you want to carefully choose them in such a way that maximizes your chances of getting hired.You want to include several projects of the same type to emphasize your expertise, but you also don\'t want to include so many that the low-quality projects start slipping in. Specifically, you determine the following quantity to be a good indicator of your chances of getting hired:f(b1,\xe2\x80\xa6,bn)=n\xe2\x88\x91i=1bi(ai\xe2\x88\x92b2i).Here, bi denotes the number of projects of type i you include in your r\xc3\xa9sum\xc3\xa9. Of course, you cannot include more projects than you have completed, so you require 0\xe2\x89\xa4bi\xe2\x89\xa4ai for all i.Your r\xc3\xa9sum\xc3\xa9 only has enough room for k projects, and you will absolutely not be hired if your r\xc3\xa9sum\xc3\xa9 has empty space, so you require n\xe2\x88\x91i=1bi=k.Find values for b1,\xe2\x80\xa6,bn that maximize the value of f(b1,\xe2\x80\xa6,bn) while satisfying the above two constraints."              
                                  2600.0 1344C "Quantifier Question" "dfs and similar,dp,graphs,math" "Logical quantifiers are very useful tools for expressing claims about a set. For this problem, let\'s focus on the set of real numbers specifically. The set of real numbers includes zero and negatives. There are two kinds of quantifiers: universal (\xe2\x88\x80) and existential (\xe2\x88\x83). You can read more about them here.The universal quantifier is used to make a claim that a statement holds for all real numbers. For example:  \xe2\x88\x80x,x<100 is read as: for all real numbers x, x is less than 100. This statement is false.  \xe2\x88\x80x,x>x\xe2\x88\x921 is read as: for all real numbers x, x is greater than x\xe2\x88\x921. This statement is true. The existential quantifier is used to make a claim that there exists some real number for which the statement holds. For example:  \xe2\x88\x83x,x<100 is read as: there exists a real number x such that x is less than 100. This statement is true.  \xe2\x88\x83x,x>x\xe2\x88\x921 is read as: there exists a real number x such that x is greater than x\xe2\x88\x921. This statement is true. Moreover, these quantifiers can be nested. For example:  \xe2\x88\x80x,\xe2\x88\x83y,x<y is read as: for all real numbers x, there exists a real number y such that x is less than y. This statement is true since for every x, there exists y=x+1.  \xe2\x88\x83y,\xe2\x88\x80x,x<y is read as: there exists a real number y such that for all real numbers x, x is less than y. This statement is false because it claims that there is a maximum real number: a number y larger than every x. Note that the order of variables and quantifiers is important for the meaning and veracity of a statement.There are n variables x1,x2,\xe2\x80\xa6,xn, and you are given some formula of the form f(x1,\xe2\x80\xa6,xn):=(xj1<xk1)\xe2\x88\xa7(xj2<xk2)\xe2\x88\xa7\xe2\x8b\xaf\xe2\x88\xa7(xjm<xkm),where \xe2\x88\xa7 denotes logical AND. That is, f(x1,\xe2\x80\xa6,xn) is true if every inequality xji<xki holds. Otherwise, if at least one inequality does not hold, then f(x1,\xe2\x80\xa6,xn) is false.Your task is to assign quantifiers Q1,\xe2\x80\xa6,Qn to either universal (\xe2\x88\x80) or existential (\xe2\x88\x83) so that the statement Q1x1,Q2x2,\xe2\x80\xa6,Qnxn,f(x1,\xe2\x80\xa6,xn)is true, and the number of universal quantifiers is maximized, or determine that the statement is false for every possible assignment of quantifiers.Note that the order the variables appear in the statement is fixed. For example, if f(x1,x2):=(x1<x2) then you are not allowed to make x2 appear first and use the statement \xe2\x88\x80x2,\xe2\x88\x83x1,x1<x2. If you assign Q1=\xe2\x88\x83 and Q2=\xe2\x88\x80, it will only be interpreted as \xe2\x88\x83x1,\xe2\x88\x80x2,x1<x2."              
                                  1900.0 1342D "Multiple Testcases" "binary search,constructive algorithms,data structures,greedy,sortings,two pointers" "So you decided to hold a contest on Codeforces. You prepared the problems: statements, solutions, checkers, validators, tests... Suddenly, your coordinator asks you to change all your tests to multiple testcases in the easiest problem!Initially, each test in that problem is just an array. The maximum size of an array is k. For simplicity, the contents of arrays don\'t matter. You have n tests \xe2\x80\x94 the i-th test is an array of size mi (1\xe2\x89\xa4mi\xe2\x89\xa4k).Your coordinator asks you to distribute all of your arrays into multiple testcases. Each testcase can include multiple arrays. However, each testcase should include no more than c1 arrays of size greater than or equal to 1 (\xe2\x89\xa51), no more than c2 arrays of size greater than or equal to 2, \xe2\x80\xa6, no more than ck arrays of size greater than or equal to k. Also, c1\xe2\x89\xa5c2\xe2\x89\xa5\xe2\x8b\xaf\xe2\x89\xa5ck.So now your goal is to create the new testcases in such a way that:   each of the initial arrays appears in exactly one testcase;  for each testcase the given conditions hold;  the number of testcases is minimum possible. Print the minimum possible number of testcases you can achieve and the sizes of arrays included in each testcase."              
                                  1000.0 1342A "Road To Zero" greedy,math "You are given two integers x and y. You can perform two types of operations:   Pay a dollars and increase or decrease any of these integers by 1. For example, if x=0 and y=7 there are four possible outcomes after this operation:   x=0, y=6;  x=0, y=8;  x=\xe2\x88\x921, y=7;  x=1, y=7.   Pay b dollars and increase or decrease both integers by 1. For example, if x=0 and y=7 there are two possible outcomes after this operation:   x=\xe2\x88\x921, y=6;  x=1, y=8.  Your goal is to make both given integers equal zero simultaneously, i.e. x=y=0. There are no other requirements. In particular, it is possible to move from x=1, y=0 to x=y=0.Calculate the minimum amount of dollars you have to spend on it."              
                                  800.0 1337A "Ichihime and Triangle" "constructive algorithms,math" "Ichihime is the current priestess of the Mahjong Soul Temple. She claims to be human, despite her cat ears.These days the temple is holding a math contest. Usually, Ichihime lacks interest in these things, but this time the prize for the winner is her favorite \xe2\x80\x94 cookies. Ichihime decides to attend the contest. Now she is solving the following problem. You are given four positive integers a, b, c, d, such that a\xe2\x89\xa4b\xe2\x89\xa4c\xe2\x89\xa4d. Your task is to find three integers x, y, z, satisfying the following conditions: a\xe2\x89\xa4x\xe2\x89\xa4b. b\xe2\x89\xa4y\xe2\x89\xa4c. c\xe2\x89\xa4z\xe2\x89\xa4d. There exists a triangle with a positive non-zero area and the lengths of its three sides are x, y, and z.Ichihime desires to get the cookie, but the problem seems too hard for her. Can you help her?"              
                                  3500.0 1336F Journey "data structures,divide and conquer,graphs,trees" "In the wilds far beyond lies the Land of Sacredness, which can be viewed as a tree  \xe2\x80\x94 connected undirected graph consisting of n nodes and n\xe2\x88\x921 edges. The nodes are numbered from 1 to n. There are m travelers attracted by its prosperity and beauty. Thereupon, they set off their journey on this land. The i-th traveler will travel along the shortest path from si to ti. In doing so, they will go through all edges in the shortest path from si to ti, which is unique in the tree.During their journey, the travelers will acquaint themselves with the others. Some may even become friends. To be specific, the i-th traveler and the j-th traveler will become friends if and only if there are at least k edges that both the i-th traveler and the j-th traveler will go through. Your task is to find out the number of pairs of travelers (i,j) satisfying the following conditions:   1\xe2\x89\xa4i<j\xe2\x89\xa4m.  the i-th traveler and the j-th traveler will become friends."              
                                  3500.0 1336E2 "Chiori and Doll Picking (hard version)" "bitmasks,brute force,combinatorics,math" "This is the hard version of the problem. The only difference between easy and hard versions is the constraint of m. You can make hacks only if both versions are solved.Chiori loves dolls and now she is going to decorate her bedroom! As a doll collector, Chiori has got n dolls. The i-th doll has a non-negative integer value ai (ai<2m, m is given). Chiori wants to pick some (maybe zero) dolls for the decoration, so there are 2n different picking ways.Let x be the bitwise-xor-sum of values of dolls Chiori picks (in case Chiori picks no dolls x=0). The value of this picking way is equal to the number of 1-bits in the binary representation of x. More formally, it is also equal to the number of indices 0\xe2\x89\xa4i<m, such that \xe2\x8c\x8ax2i\xe2\x8c\x8b is odd.Tell her the number of picking ways with value i for each integer i from 0 to m. Due to the answers can be very huge, print them by modulo 998244353."              
                                  2200.0 1335F "Robots on a Grid" "data structures,dfs and similar,dsu,graphs,greedy,matrices" "There is a rectangular grid of size n\xc3\x97m. Each cell of the grid is colored black (\'0\') or white (\'1\'). The color of the cell (i,j) is ci,j. You are also given a map of directions: for each cell, there is a direction si,j which is one of the four characters \'U\', \'R\', \'D\' and \'L\'.  If si,j is \'U\' then there is a transition from the cell (i,j) to the cell (i\xe2\x88\x921,j);  if si,j is \'R\' then there is a transition from the cell (i,j) to the cell (i,j+1);  if si,j is \'D\' then there is a transition from the cell (i,j) to the cell (i+1,j);  if si,j is \'L\' then there is a transition from the cell (i,j) to the cell (i,j\xe2\x88\x921). It is guaranteed that the top row doesn\'t contain characters \'U\', the bottom row doesn\'t contain characters \'D\', the leftmost column doesn\'t contain characters \'L\' and the rightmost column doesn\'t contain characters \'R\'.You want to place some robots in this field (at most one robot in a cell). The following conditions should be satisfied.  Firstly, each robot should move every time (i.e. it cannot skip the move). During one move each robot goes to the adjacent cell depending on the current direction.  Secondly, you have to place robots in such a way that there is no move before which two different robots occupy the same cell (it also means that you cannot place two robots in the same cell). I.e. if the grid is ""RL"" (one row, two columns, colors does not matter there) then you can place two robots in cells (1,1) and (1,2), but if the grid is ""RLL"" then you cannot place robots in cells (1,1) and (1,3) because during the first second both robots will occupy the cell (1,2). The robots make an infinite number of moves.Your task is to place the maximum number of robots to satisfy all the conditions described above and among all such ways, you have to choose one where the number of black cells occupied by robots before all movements is the maximum possible. Note that you can place robots only before all movements.You have to answer t independent test cases."              
                                  1300.0 1335D Anti-Sudoku "constructive algorithms,implementation" "You are given a correct solution of the sudoku puzzle. If you don\'t know what is the sudoku, you can read about it here.The picture showing the correct sudoku solution:Blocks are bordered with bold black color.Your task is to change at most 9 elements of this field (i.e. choose some 1\xe2\x89\xa4i,j\xe2\x89\xa49 and change the number at the position (i,j) to any other number in range [1;9]) to make it anti-sudoku. The anti-sudoku is the 9\xc3\x979 field, in which:  Any number in this field is in range [1;9];  each row contains at least two equal elements;  each column contains at least two equal elements;  each 3\xc3\x973 block (you can read what is the block in the link above) contains at least two equal elements. It is guaranteed that the answer exists.You have to answer t independent test cases."              
                                  800.0 1335A "Candies and Two Sisters" math "There are two sisters Alice and Betty. You have n candies. You want to distribute these n candies between two sisters in such a way that:  Alice will get a (a>0) candies;  Betty will get b (b>0) candies;  each sister will get some integer number of candies;  Alice will get a greater amount of candies than Betty (i.e. a>b);  all the candies will be given to one of two sisters (i.e. a+b=n). Your task is to calculate the number of ways to distribute exactly n candies between sisters in a way described above. Candies are indistinguishable.Formally, find the number of ways to represent n as the sum of n=a+b, where a and b are positive integers and a>b.You have to answer t independent test cases."              
                                  1100.0 1334B "Middle Class" greedy,sortings "Many years ago Berland was a small country where only n people lived. Each person had some savings: the i-th one had ai burles.The government considered a person as wealthy if he had at least x burles. To increase the number of wealthy people Berland decided to carry out several reforms. Each reform looked like that:   the government chooses some subset of people (maybe all of them);  the government takes all savings from the chosen people and redistributes the savings among the chosen people equally. For example, consider the savings as list [5,1,2,1]: if the government chose the 1-st and the 3-rd persons then it, at first, will take all 5+2=7 burles and after that will return 3.5 burles to the chosen people. As a result, the savings will become [3.5,1,3.5,1].A lot of data was lost from that time, so we don\'t know how many reforms were implemented and to whom. All we can do is ask you to calculate the maximum possible number of wealthy people after several (maybe zero) reforms."              
              1600.0                         1137A Skyscrapers implementation,sortings "Dora loves adventures quite a lot. During some journey she encountered an amazing city, which is formed by n streets along the Eastern direction and m streets across the Southern direction. Naturally, this city has nm intersections. At any intersection of i-th Eastern street and j-th Southern street there is a monumental skyscraper. Dora instantly became curious and decided to explore the heights of the city buildings.When Dora passes through the intersection of the i-th Eastern and j-th Southern street she examines those two streets. After Dora learns the heights of all the skyscrapers on those two streets she wonders: how one should reassign heights to the skyscrapers on those two streets, so that the maximum height would be as small as possible and the result of comparing the heights of any two skyscrapers on one street wouldn\'t change.Formally, on every of nm intersections Dora solves an independent problem. She sees n+m\xe2\x88\x921 skyscrapers and for each of them she knows its real height. Moreover, any two heights can be compared to get a result ""greater"", ""smaller"" or ""equal"". Now Dora wants to select some integer x and assign every skyscraper a height from 1 to x. When assigning heights, Dora wants to preserve the relative order of the skyscrapers in both streets. That is, the result of any comparison of heights of two skyscrapers in the current Eastern street shouldn\'t change and the result of any comparison of heights of two skyscrapers in current Southern street shouldn\'t change as well. Note that skyscrapers located on the Southern street are not compared with skyscrapers located on the Eastern street only. However, the skyscraper located at the streets intersection can be compared with both Southern and Eastern skyscrapers. For every intersection Dora wants to independently calculate the minimum possible x.For example, if the intersection and the two streets corresponding to it look as follows:  Then it is optimal to replace the heights of the skyscrapers as follows (note that all comparisons ""less"", ""equal"", ""greater"" inside the Eastern street and inside the Southern street are preserved)  The largest used number is 5, hence the answer for this intersection would be 5.Help Dora to compute the answers for each intersection."          
              900.0                         1132B Discounts greedy,sortings "You came to a local shop and want to buy some chocolate bars. There are n bars in the shop, i-th of them costs ai coins (and you want to buy all of them).You have m different coupons that allow you to buy chocolate bars. i-th coupon allows you to buy qi chocolate bars while you have to pay only for the qi\xe2\x88\x921 most expensive ones (so, the cheapest bar of those qi bars is for free).You can use only one coupon; if you use coupon i, you have to choose qi bars and buy them using the coupon, and buy all the remaining n\xe2\x88\x92qi bars without any discounts.To decide which coupon to choose, you want to know what will be the minimum total amount of money you have to pay if you use one of the coupons optimally."          
              1100.0                         1132A "Regular Bracket Sequence" greedy,implementation "A string is called bracket sequence if it does not contain any characters other than ""("" and "")"". A bracket sequence is called regular if it it is possible to obtain correct arithmetic expression by inserting characters ""+"" and ""1"" into this sequence. For example, """", ""(())"" and ""()()"" are regular bracket sequences; ""))"" and "")(("" are bracket sequences (but not regular ones), and ""(a)"" and ""(1)+(1)"" are not bracket sequences at all.You have a number of strings; each string is a bracket sequence of length 2. So, overall you have cnt1 strings ""(("", cnt2 strings ""()"", cnt3 strings "")("" and cnt4 strings ""))"". You want to write all these strings in some order, one after another; after that, you will get a long bracket sequence of length 2(cnt1+cnt2+cnt3+cnt4). You wonder: is it possible to choose some order of the strings you have such that you will get a regular bracket sequence? Note that you may not remove any characters or strings, and you may not add anything either."          
              3100.0                         1120F "Secret Letters" "data structures,dp,greedy" "Little W and Little P decided to send letters to each other regarding the most important events during a day. There are n events during a day: at time moment ti something happens to the person pi (pi is either W or P, denoting Little W and Little P, respectively), so he needs to immediately send a letter to the other person. They can send a letter using one of the two ways:  Ask Friendly O to deliver the letter directly. Friendly O takes d acorns for each letter. Leave the letter at Wise R\'s den. Wise R values free space, so he takes c\xe2\x8b\x85T acorns for storing a letter for a time segment of length T. The recipient can take a letter from Wise R either when he leaves his own letter at Wise R\'s den, or at time moment tn+1, when everybody comes to Wise R for a tea. It is not possible to take a letter from Wise R\'s den at other time moments. The friends can store as many letters at Wise R\'s den as they want, paying for each one separately. Help the friends determine the minimum possible total cost of sending all letters."          
              1200.0                         1118B "Tanya and Candies" implementation "Tanya has n candies numbered from 1 to n. The i-th candy has the weight ai.She plans to eat exactly n\xe2\x88\x921 candies and give the remaining candy to her dad. Tanya eats candies in order of increasing their numbers, exactly one candy per day.Your task is to find the number of such candies i (let\'s call these candies good) that if dad gets the i-th candy then the sum of weights of candies Tanya eats in even days will be equal to the sum of weights of candies Tanya eats in odd days. Note that at first, she will give the candy, after it she will eat the remaining candies one by one.For example, n=4 and weights are [1,4,3,3]. Consider all possible cases to give a candy to dad:  Tanya gives the 1-st candy to dad (a1=1), the remaining candies are [4,3,3]. She will eat a2=4 in the first day, a3=3 in the second day, a4=3 in the third day. So in odd days she will eat 4+3=7 and in even days she will eat 3. Since 7\xe2\x89\xa03 this case shouldn\'t be counted to the answer (this candy isn\'t good).  Tanya gives the 2-nd candy to dad (a2=4), the remaining candies are [1,3,3]. She will eat a1=1 in the first day, a3=3 in the second day, a4=3 in the third day. So in odd days she will eat 1+3=4 and in even days she will eat 3. Since 4\xe2\x89\xa03 this case shouldn\'t be counted to the answer (this candy isn\'t good).  Tanya gives the 3-rd candy to dad (a3=3), the remaining candies are [1,4,3]. She will eat a1=1 in the first day, a2=4 in the second day, a4=3 in the third day. So in odd days she will eat 1+3=4 and in even days she will eat 4. Since 4=4 this case should be counted to the answer (this candy is good).  Tanya gives the 4-th candy to dad (a4=3), the remaining candies are [1,4,3]. She will eat a1=1 in the first day, a2=4 in the second day, a3=3 in the third day. So in odd days she will eat 1+3=4 and in even days she will eat 4. Since 4=4 this case should be counted to the answer (this candy is good). In total there 2 cases which should counted (these candies are good), so the answer is 2."          
              -999.0                         1116D4 "TIE fighter"  "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N which has non-zero elements in the following positions: the central 2x2 sub-matrix, the diagonals of the top right and bottom left square sub-matrices of size 2N\xe2\x88\x921\xe2\x88\x921 that do not overlap with the central 2x2 sub-matrix, the anti-diagonals of the top left and bottom right square sub-matrices of size 2N\xe2\x88\x921\xe2\x88\x921 that do not overlap with the central 2x2 sub-matrix.For example, for N=3 the matrix of the operation should have the following shape:..X..X...X....X.X......X...XX......XX...X......X.X....X...X..X..Here X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation."          
              -999.0                         1116D1 "Block diagonal matrix"  "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N which has 2x2 blocks of non-zero elements on the main diagonal and zero elements everywhere else.For example, for N=3 the matrix of the operation should have the following shape:XX......XX........XX......XX........XX......XX........XX......XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation."          
              -999.0                         1116C3 "``Is the number of ones divisible by 3?\'\' oracle"  "Implement a quantum oracle on N qubits which checks whether the number of bits equal to 1 in the input vector \xe2\x86\x92x is divisible by 3 (i.e., implements the function f(\xe2\x86\x92x)=1 if the number of xi=1 in \xe2\x86\x92x is divisible by 3, and 0 otherwise).You have to implement an operation which takes the following inputs: an array of N (1\xe2\x89\xa4N\xe2\x89\xa49) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits. Note that the input register x has to remain unchanged after applying the operation.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}Note: the operation has to have an adjoint specified for it; adjoint auto means that the adjoint will be generated automatically. For details on adjoint, see Operation Declarations.You are not allowed to use measurements in your operation."          
              -999.0                         1116B2 "Not A, not B or not C?"  "You are given a qubit which is guaranteed to be in one of the following states: |A\xe2\x9f\xa9=1\xe2\x88\x9a2(|0\xe2\x9f\xa9+|1\xe2\x9f\xa9), |B\xe2\x9f\xa9=1\xe2\x88\x9a2(|0\xe2\x9f\xa9+\xcf\x89|1\xe2\x9f\xa9), or |C\xe2\x9f\xa9=1\xe2\x88\x9a2(|0\xe2\x9f\xa9+\xcf\x892|1\xe2\x9f\xa9), where \xcf\x89=e2i\xcf\x80/3.These states are not orthogonal, and thus can not be distinguished perfectly. Your task is to figure out in which state the qubit is not. More formally: If the qubit was in state |A\xe2\x9f\xa9, you have to return 1 or 2. If the qubit was in state |B\xe2\x9f\xa9, you have to return 0 or 2. If the qubit was in state |C\xe2\x9f\xa9, you have to return 0 or 1. In other words, return 0 if you\'re sure the qubit was not in state |A\xe2\x9f\xa9, return 1 if you\'re sure the qubit was not in state |B\xe2\x9f\xa9, and return 2 if you\'re sure the qubit was not in state |C\xe2\x9f\xa9.Your solution will be called 1000 times, each time the state of the qubit will be chosen as |A\xe2\x9f\xa9, |B\xe2\x9f\xa9 or |C\xe2\x9f\xa9 with equal probability. The state of the qubit after the operations does not matter.You have to implement an operation which takes a qubit as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (q : Qubit) : Int {        // your code here    }}"          
              -999.0                         1116A2 "Generate equal superposition of four basis states"  "You are given N qubits in the zero state |0...0\xe2\x9f\xa9. You are also given four distinct bit vectors which describe four different basis states on N qubits |\xcf\x88i\xe2\x9f\xa9.Your task is to generate a state which is an equal superposition of the given basis states:|S\xe2\x9f\xa9=12(|\xcf\x880\xe2\x9f\xa9+|\xcf\x881\xe2\x9f\xa9+|\xcf\x882\xe2\x9f\xa9+|\xcf\x883\xe2\x9f\xa9)You have to implement an operation which takes the following inputs: an array of N (2\xe2\x89\xa4N\xe2\x89\xa416) qubits, a two-dimensional array of Boolean values bits representing the basis states |\xcf\x88i\xe2\x9f\xa9. bits will have exactly 4 elements, each of bits[i] describing the basis state |\xcf\x88i\xe2\x9f\xa9. Each of bits[i] will have N elements, bits[i][j] giving the state of qubit j in the basis state |\xcf\x88i\xe2\x9f\xa9. Bit values true and false corresponding to |1\xe2\x9f\xa9 and |0\xe2\x9f\xa9 states, respectively; for example, for N=2 an array [false, true] will represent the basis state |01\xe2\x9f\xa9. Each pair of bits[i] and bits[j] will differ in at least one position for i\xe2\x89\xa0j.The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[], bits : Bool[][]) : Unit {        // your code here    }}"          
              -999.0                         1116A1 "Generate state |00\xe2\x9f\xa9 + |01\xe2\x9f\xa9 + |10\xe2\x9f\xa9"  "You are given two qubits in state |00\xe2\x9f\xa9. Your task is to create the following state on them:1\xe2\x88\x9a3(|00\xe2\x9f\xa9+|01\xe2\x9f\xa9+|10\xe2\x9f\xa9)You have to implement an operation which takes an array of 2 qubits as an input and has no output. The ""output"" of your solution is the state in which it left the input qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}"          
              3500.0                         1110H "Modest Substrings" dp,strings "You are given two integers l and r.Let\'s call an integer x modest, if l\xe2\x89\xa4x\xe2\x89\xa4r.Find a string of length n, consisting of digits, which has the largest possible number of substrings, which make a modest integer. Substring having leading zeros are not counted. If there are many answers, find lexicographically smallest one.If some number occurs multiple times as a substring, then in the counting of the number of modest substrings it is counted multiple times as well."          
              2800.0                         1109C "Sasha and a Patient Friend" "binary search,data structures,implementation" "Fedya and Sasha are friends, that\'s why Sasha knows everything about Fedya.Fedya keeps his patience in an infinitely large bowl. But, unlike the bowl, Fedya\'s patience isn\'t infinite, that is why let v be the number of liters of Fedya\'s patience, and, as soon as v becomes equal to 0, the bowl will burst immediately. There is one tap in the bowl which pumps s liters of patience per second. Notice that s can be negative, in that case, the tap pumps out the patience. Sasha can do different things, so he is able to change the tap\'s speed. All actions that Sasha does can be represented as q queries. There are three types of queries:  ""1 t s""  \xe2\x80\x94 add a new event, means that starting from the t-th second the tap\'s speed will be equal to s.  ""2 t""  \xe2\x80\x94 delete the event which happens at the t-th second. It is guaranteed that such event exists.  ""3 l r v"" \xe2\x80\x94 Sasha wonders: if you take all the events for which l\xe2\x89\xa4t\xe2\x89\xa4r and simulate changes of Fedya\'s patience from the very beginning of the l-th second till the very beginning of the r-th second inclusive (the initial volume of patience, at the beginning of the l-th second, equals to v liters) then when will be the moment when the bowl will burst. If that does not happen, then the answer will be \xe2\x88\x921. Since Sasha does not want to check what will happen when Fedya\'s patience ends, and he has already come up with the queries, he is asking you to help him and find the answer for each query of the 3-rd type.It is guaranteed that at any moment of time, there won\'t be two events which happen at the same second."          
              2600.0                         1107F "Vasya and Endless Credits" "dp,flows,graph matchings,graphs,sortings" "Vasya wants to buy himself a nice new car. Unfortunately, he lacks some money. Currently he has exactly 0 burles.However, the local bank has n credit offers. Each offer can be described with three numbers ai, bi and ki. Offers are numbered from 1 to n. If Vasya takes the i-th offer, then the bank gives him ai burles at the beginning of the month and then Vasya pays bank bi burles at the end of each month for the next ki months (including the month he activated the offer). Vasya can take the offers any order he wants.Each month Vasya can take no more than one credit offer. Also each credit offer can not be used more than once. Several credits can be active at the same time. It implies that Vasya pays bank the sum of bi over all the i of active credits at the end of each month.Vasya wants to buy a car in the middle of some month. He just takes all the money he currently has and buys the car of that exact price.Vasya don\'t really care what he\'ll have to pay the bank back after he buys a car. He just goes out of the country on his car so that the bank can\'t find him anymore.What is the maximum price that car can have?"          
              1500.0                         1105C "Ayoub and Lost Array" combinatorics,dp,math "Ayoub had an array a of integers of size n and this array had two interesting properties:   All the integers in the array were between l and r (inclusive).  The sum of all the elements was divisible by 3. Unfortunately, Ayoub has lost his array, but he remembers the size of the array n and the numbers l and r, so he asked you to find the number of ways to restore the array. Since the answer could be very large, print it modulo 109+7 (i.e. the remainder when dividing by 109+7). In case there are no satisfying arrays (Ayoub has a wrong memory), print 0."          
              1400.0                         1103A "Grid game" "constructive algorithms,implementation" "You are given a 4x4 grid. You play a game \xe2\x80\x94 there is a sequence of tiles, each of them is either 2x1 or 1x2. Your task is to consequently place all tiles from the given sequence in the grid. When tile is placed, each cell which is located in fully occupied row or column is deleted (cells are deleted at the same time independently). You can place tile in the grid at any position, the only condition is that tiles (and tile parts) should not overlap. Your goal is to proceed all given figures and avoid crossing at any time."          
              1700.0                         1102E "Monotonic Renumeration" combinatorics,sortings "You are given an array a consisting of n integers. Let\'s denote monotonic renumeration of array a as an array b consisting of n integers such that all of the following conditions are met:  b1=0;  for every pair of indices i and j such that 1\xe2\x89\xa4i,j\xe2\x89\xa4n, if ai=aj, then bi=bj (note that if ai\xe2\x89\xa0aj, it is still possible that bi=bj);  for every index i\xe2\x88\x88[1,n\xe2\x88\x921] either bi=bi+1 or bi+1=bi+1. For example, if a=[1,2,1,2,3], then two possible monotonic renumerations of a are b=[0,0,0,0,0] and b=[0,0,0,0,1].Your task is to calculate the number of different monotonic renumerations of a. The answer may be large, so print it modulo 998244353."          
              2300.0                         1101G "(Zero XOR Subset)-less" math,matrices "You are given an array a1,a2,\xe2\x80\xa6,an of integer numbers.Your task is to divide the array into the maximum number of segments in such a way that:  each element is contained in exactly one segment;  each segment contains at least one element;  there doesn\'t exist a non-empty subset of segments such that bitwise XOR of the numbers from them is equal to 0. Print the maximum number of segments the array can be divided into. Print -1 if no suitable division exists."          
              3400.0                         1097H "Mateusz and an Infinite Sequence" "bitmasks,brute force,dp,strings" "A Thue-Morse-Radecki-Mateusz sequence (Thorse-Radewoosh sequence in short) is an infinite sequence constructed from a finite sequence gen of length d and an integer m, obtained in the following sequence of steps:  In the beginning, we define the one-element sequence M0=(0). In the k-th step, k\xe2\x89\xa51, we define the sequence Mk to be the concatenation of the d copies of Mk\xe2\x88\x921. However, each of them is altered slightly \xe2\x80\x94 in the i-th of them (1\xe2\x89\xa4i\xe2\x89\xa4d), each element x is changed to (x+geni)(modm). For instance, if we pick gen=(0,1,2) and m=4:   M0=(0),  M1=(0,1,2),  M2=(0,1,2,1,2,3,2,3,0),  M3=(0,1,2,1,2,3,2,3,0,1,2,3,2,3,0,3,0,1,2,3,0,3,0,1,0,1,2), and so on. As you can see, as long as the first element of gen is 0, each consecutive step produces a sequence whose prefix is the sequence generated in the previous step. Therefore, we can define the infinite Thorse-Radewoosh sequence M\xe2\x88\x9e as the sequence obtained by applying the step above indefinitely. For the parameters above, M\xe2\x88\x9e=(0,1,2,1,2,3,2,3,0,1,2,3,2,3,0,3,0,1,\xe2\x80\xa6).Mateusz picked a sequence gen and an integer m, and used them to obtain a Thorse-Radewoosh sequence M\xe2\x88\x9e. He then picked two integers l, r, and wrote down a subsequence of this sequence A:=((M\xe2\x88\x9e)l,(M\xe2\x88\x9e)l+1,\xe2\x80\xa6,(M\xe2\x88\x9e)r).Note that we use the 1-based indexing both for M\xe2\x88\x9e and A.Mateusz has his favorite sequence B with length n, and would like to see how large it is compared to A. Let\'s say that B majorizes sequence X of length n (let\'s denote it as B\xe2\x89\xa5X) if and only if for all i\xe2\x88\x88{1,2,\xe2\x80\xa6,n}, we have Bi\xe2\x89\xa5Xi.He now asks himself how many integers x in the range [1,|A|\xe2\x88\x92n+1] there are such that B\xe2\x89\xa5(Ax,Ax+1,Ax+2,\xe2\x80\xa6,Ax+n\xe2\x88\x921). As both sequences were huge, answering the question using only his pen and paper turned out to be too time-consuming. Can you help him automate his research?"          
              2200.0                         1097D "Makoto and a Blackboard" "dp,math,number theory,probabilities" "Makoto has a big blackboard with a positive integer n written on it. He will perform the following action exactly k times:Suppose the number currently written on the blackboard is v. He will randomly pick one of the divisors of v (possibly 1 and v) and replace v with this divisor. As Makoto uses his famous random number generator (RNG) and as he always uses 58 as his generator seed, each divisor is guaranteed to be chosen with equal probability.He now wonders what is the expected value of the number written on the blackboard after k steps.It can be shown that this value can be represented as PQ where P and Q are coprime integers and Q\xe2\x89\xa20(mod109+7). Print the value of P\xe2\x8b\x85Q\xe2\x88\x921 modulo 109+7."          
              1900.0                         1095F "Make It Connected" dsu,graphs,greedy "You are given an undirected graph consisting of n vertices. A number is written on each vertex; the number on vertex i is ai. Initially there are no edges in the graph.You may add some edges to this graph, but you have to pay for them. The cost of adding an edge between vertices x and y is ax+ay coins. There are also m special offers, each of them is denoted by three numbers x, y and w, and means that you can add an edge connecting vertices x and y and pay w coins for it. You don\'t have to use special offers: if there is a pair of vertices x and y that has a special offer associated with it, you still may connect these two vertices paying ax+ay coins for it.What is the minimum number of coins you have to spend to make the graph connected? Recall that a graph is connected if it\'s possible to get from any vertex to any other vertex using only the edges belonging to this graph."          
              1700.0                         1093D "Beautiful Graph" "dfs and similar,graphs" "You are given an undirected unweighted graph consisting of n vertices and m edges.You have to write a number on each vertex of the graph. Each number should be 1, 2 or 3. The graph becomes beautiful if for each edge the sum of numbers on vertices connected by this edge is odd.Calculate the number of possible ways to write numbers 1, 2 and 3 on vertices so the graph becomes beautiful. Since this number may be large, print it modulo 998244353.Note that you have to write exactly one number on each vertex.The graph does not have any self-loops or multiple edges."          
              1200.0                         1091B "New Year and the Treasure Geolocation" "brute force,constructive algorithms,greedy,implementation" "Bob is a pirate looking for the greatest treasure the world has ever seen. The treasure is located at the point T, which coordinates to be found out.Bob travelled around the world and collected clues of the treasure location at n obelisks. These clues were in an ancient language, and he has only decrypted them at home. Since he does not know which clue belongs to which obelisk, finding the treasure might pose a challenge. Can you help him?As everyone knows, the world is a two-dimensional plane. The i-th obelisk is at integer coordinates (xi,yi). The j-th clue consists of 2 integers (aj,bj) and belongs to the obelisk pj, where p is some (unknown) permutation on n elements. It means that the treasure is located at T=(xpj+aj,ypj+bj). This point T is the same for all clues.In other words, each clue belongs to exactly one of the obelisks, and each obelisk has exactly one clue that belongs to it. A clue represents the vector from the obelisk to the treasure. The clues must be distributed among the obelisks in such a way that they all point to the same position of the treasure.Your task is to find the coordinates of the treasure. If there are multiple solutions, you may print any of them.Note that you don\'t need to find the permutation. Permutations are used only in order to explain the problem."          
              2400.0                         1090C "New Year Presents" "constructive algorithms,data structures" "Santa has prepared boxes with presents for n kids, one box for each kid. There are m kinds of presents: balloons, sweets, chocolate bars, toy cars... A child would be disappointed to receive two presents of the same kind, so all kinds of presents in one box are distinct.Having packed all the presents, Santa realized that different boxes can contain different number of presents. It would be unfair to the children, so he decided to move some presents between boxes, and make their sizes similar. After all movements, the difference between the maximal and the minimal number of presents in a box must be as small as possible. All presents in each box should still be distinct. Santa wants to finish the job as fast as possible, so he wants to minimize the number of movements required to complete the task.Given the sets of presents in each box, find the shortest sequence of movements of presents between boxes that minimizes the difference of sizes of the smallest and the largest box, and keeps all presents in each box distinct."          
              1000.0                         1088B "Ehab and subtraction" implementation,sortings "You\'re given an array a. You should repeat the following operation k times: find the minimum non-zero element in the array, print it, and then subtract it from all the non-zero elements of the array. If all the elements are 0s, just print 0."          
              2900.0                         1085G "Beautiful Matrix" "combinatorics,data structures,dp" "Petya collects beautiful matrix.A matrix of size n\xc3\x97n is beautiful if:   All elements of the matrix are integers between 1 and n;  For every row of the matrix, all elements of this row are different;  For every pair of vertically adjacent elements, these elements are different. Today Petya bought a beautiful matrix a of size n\xc3\x97n, and now he wants to determine its rarity.The rarity of the matrix is its index in the list of beautiful matrices of size n\xc3\x97n, sorted in lexicographical order. Matrix comparison is done row by row. (The index of lexicographically smallest matrix is zero).Since the number of beautiful matrices may be huge, Petya wants you to calculate the rarity of the matrix a modulo 998244353."          
              1200.0                         1084B "Kvass and the Fair Nut" greedy,implementation "The Fair Nut likes kvass very much. On his birthday parents presented him n kegs of kvass. There are vi liters of kvass in the i-th keg. Each keg has a lever. You can pour your glass by exactly 1 liter pulling this lever. The Fair Nut likes this drink very much, so he wants to pour his glass by s liters of kvass. But he wants to do it, so kvass level in the least keg is as much as possible.Help him find out how much kvass can be in the least keg or define it\'s not possible to pour his glass by s liters of kvass."          
              3300.0                         1083F "The Fair Nut and Amusing Xor" "data structures" "The Fair Nut has two arrays a and b, consisting of n numbers. He found them so long ago that no one knows when they came to him.The Fair Nut often changes numbers in his arrays. He also is interested in how similar a and b are after every modification.Let\'s denote similarity of two arrays as the minimum number of operations to apply to make arrays equal (every operation can be applied for both arrays). If it is impossible, similarity will be equal \xe2\x88\x921.Per one operation you can choose a subarray with length k (k is fixed), and change every element ai, which belongs to the chosen subarray, to ai\xe2\x8a\x95x (x can be chosen), where \xe2\x8a\x95 denotes the bitwise XOR operation. Nut has already calculated the similarity of the arrays after every modification. Can you do it?Note that you just need to calculate those values, that is you do not need to apply any operations."          
              2400.0                         1083E "The Fair Nut and Rectangles" "data structures,dp,geometry" "The Fair Nut got stacked in planar world. He should solve this task to get out.You are given n rectangles with vertexes in (0,0), (xi,0), (xi,yi), (0,yi). For each rectangle, you are also given a number ai. Choose some of them that the area of union minus sum of ai of the chosen ones is maximum.It is guaranteed that there are no nested rectangles.Nut has no idea how to find the answer, so he asked for your help."          
              2900.0                         1083C "Max Mex" "data structures,trees" "Once Grisha found a tree (connected graph without cycles) with a root in node 1.But this tree was not just a tree. A permutation p of integers from 0 to n\xe2\x88\x921 is written in nodes, a number pi is written in node i.As Grisha likes to invent some strange and interesting problems for himself, but not always can solve them, you need to help him deal with two types of queries on this tree.Let\'s define a function MEX(S), where S is a set of non-negative integers, as a smallest non-negative integer that is not included in this set.Let l be a simple path in this tree. So let\'s define indices of nodes which lie on l as u1, u2, \xe2\x80\xa6, uk. Define V(l) as a set {pu1, pu2, \xe2\x80\xa6 , puk}. Then queries are:   For two nodes i and j, swap pi and pj.  Find the maximum value of MEX(V(l)) in all possible l."          
              2000.0                         1083B "The Fair Nut and Strings" greedy,strings "Recently, the Fair Nut has written k strings of length n, consisting of letters ""a"" and ""b"". He calculated c \xe2\x80\x94 the number of strings that are prefixes of at least one of the written strings. Every string was counted only one time.Then, he lost his sheet with strings. He remembers that all written strings were lexicographically not smaller than string s and not bigger than string t. He is interested: what is the maximum value of c that he could get.A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b."          
              1500.0                         1081B "Farewell Party" "constructive algorithms,implementation" "Chouti and his classmates are going to the university soon. To say goodbye to each other, the class has planned a big farewell party in which classmates, teachers and parents sang and danced.Chouti remembered that n persons took part in that party. To make the party funnier, each person wore one hat among n kinds of weird hats numbered 1,2,\xe2\x80\xa6n. It is possible that several persons wore hats of the same kind. Some kinds of hats can remain unclaimed by anyone.After the party, the i-th person said that there were ai persons wearing a hat differing from his own.It has been some days, so Chouti forgot all about others\' hats, but he is curious about that. Let bi be the number of hat type the i-th person was wearing, Chouti wants you to find any possible b1,b2,\xe2\x80\xa6,bn that doesn\'t contradict with any person\'s statement. Because some persons might have a poor memory, there could be no solution at all."          
              2100.0                         1077F2 "Pictures with Kittens (hard version)" "data structures,dp" "The only difference between easy and hard versions is the constraints.Vova likes pictures with kittens. The news feed in the social network he uses can be represented as an array of n consecutive pictures (with kittens, of course). Vova likes all these pictures, but some are more beautiful than the others: the i-th picture has beauty ai.Vova wants to repost exactly x pictures in such a way that:   each segment of the news feed of at least k consecutive pictures has at least one picture reposted by Vova;  the sum of beauty values of reposted pictures is maximum possible. For example, if k=1 then Vova has to repost all the pictures in the news feed. If k=2 then Vova can skip some pictures, but between every pair of consecutive pictures Vova has to repost at least one of them.Your task is to calculate the maximum possible sum of values of reposted pictures if Vova follows conditions described above, or say that there is no way to satisfy all conditions."          
              2500.0                         1073F "Choosing Two Paths" "dfs and similar,dp,greedy,trees" "You are given an undirected unweighted tree consisting of n vertices.An undirected tree is a connected undirected graph with n\xe2\x88\x921 edges.Your task is to choose two pairs of vertices of this tree (all the chosen vertices should be distinct) (x1,y1) and (x2,y2) in such a way that neither x1 nor y1 belong to the simple path from x2 to y2 and vice versa (neither x2 nor y2 should not belong to the simple path from x1 to y1).It is guaranteed that it is possible to choose such pairs for the given tree.Among all possible ways to choose such pairs you have to choose one with the maximum number of common vertices between paths from x1 to y1 and from x2 to y2. And among all such pairs you have to choose one with the maximum total length of these two paths.It is guaranteed that the answer with at least two common vertices exists for the given tree.The length of the path is the number of edges in it.The simple path is the path that visits each vertex at most once."          
              1000.0                         1073A "Diverse Substring" implementation,strings "You are given a string s, consisting of n lowercase Latin letters.A substring of string s is a continuous segment of letters from s. For example, ""defor"" is a substring of ""codeforces"" and ""fors"" is not. The length of the substring is the number of letters in it.Let\'s call some string of length n diverse if and only if there is no letter to appear strictly more than n2 times. For example, strings ""abc"" and ""iltlml"" are diverse and strings ""aab"" and ""zz"" are not.Your task is to find any diverse substring of string s or report that there is none. Note that it is not required to maximize or minimize the length of the resulting substring."          
              3500.0                         1071E "Rain Protection" "binary search,geometry" "A lot of people dream of convertibles (also often called cabriolets). Some of convertibles, however, don\'t have roof at all, and are vulnerable to rain. This is why Melon Ask, the famous inventor, decided to create a rain protection mechanism for convertibles.The workplace of the mechanism is a part of plane just above the driver. Its functional part consists of two rails with sliding endpoints of a piece of stretching rope. For the sake of simplicity we can consider this as a pair of parallel segments in a plane with the rope segment, whose endpoints we are free to choose as any points on these rails segments.  The algorithmic part of the mechanism detects each particular raindrop and predicts when and where it reaches the plane. At this exact moment the rope segment must contain the raindrop point (so the rope adsorbs the raindrop).You are given the initial position of the rope endpoints and all information about raindrops. You are to choose the minimal possible speed v of the endpoints sliding (both endpoints can slide in any direction along their segments independently of each other) in such a way that it is possible to catch all raindrops moving both endpoints with speed not greater than v, or find out that it\'s impossible no matter how high the speed is."          
              2300.0                         1070G "Monsters and Potions" "brute force,dp,greedy,implementation" "Polycarp is an introvert person. In fact he is so much of an introvert that he plays ""Monsters and Potions"" board game alone. The board of the game is a row of n cells. The cells are numbered from 1 to n from left to right. There are three types of cells: a cell containing a single monster, a cell containing a single potion or a blank cell (it contains neither a monster nor a potion).Polycarp has m tokens representing heroes fighting monsters, which are initially located in the blank cells s1,s2,\xe2\x80\xa6,sm. Polycarp\'s task is to choose a single cell (rally point) and one by one move all the heroes into this cell. A rally point can be a cell of any of three types.After Policarp selects a rally point, he picks a hero and orders him to move directly to the point. Once that hero reaches the point, Polycarp picks another hero and orders him also to go to the point. And so forth, until all the heroes reach the rally point cell. While going to the point, a hero can not deviate from the direct route or take a step back. A hero just moves cell by cell in the direction of the point until he reaches it. It is possible that multiple heroes are simultaneously in the same cell.Initially the i-th hero has hi hit points (HP). Monsters also have HP, different monsters might have different HP. And potions also have HP, different potions might have different HP.If a hero steps into a cell which is blank (i.e. doesn\'t contain a monster/potion), hero\'s HP does not change.If a hero steps into a cell containing a monster, then the hero and the monster fight. If monster\'s HP is strictly higher than hero\'s HP, then the monster wins and Polycarp loses the whole game. If hero\'s HP is greater or equal to monster\'s HP, then the hero wins and monster\'s HP is subtracted from hero\'s HP. I.e. the hero survives if his HP drops to zero, but dies (and Polycarp looses) if his HP becomes negative due to a fight. If a hero wins a fight with a monster, then the monster disappears, and the cell becomes blank.If a hero steps into a cell containing a potion, then the hero drinks the potion immediately. As a result, potion\'s HP is added to hero\'s HP, the potion disappears, and the cell becomes blank.Obviously, Polycarp wants to win the game. It means that he must choose such rally point and the order in which heroes move, that every hero reaches the rally point and survives. I.e. Polycarp loses if a hero reaches rally point but is killed by a monster at the same time. Polycarp can use any of n cells as a rally point \xe2\x80\x94 initially it can contain a monster, a potion, or be a blank cell with or without a hero in it.Help Polycarp write a program to choose a rally point and the order in which heroes move."          
              1300.0                         1065B "Vasya and Isolated Vertices" "constructive algorithms,graphs" "Vasya has got an undirected graph consisting of n vertices and m edges. This graph doesn\'t contain any self-loops or multiple edges. Self-loop is an edge connecting a vertex to itself. Multiple edges are a pair of edges such that they connect the same pair of vertices. Since the graph is undirected, the pair of edges (1,2) and (2,1) is considered to be multiple edges. Isolated vertex of the graph is a vertex such that there is no edge connecting this vertex to any other vertex.Vasya wants to know the minimum and maximum possible number of isolated vertices in an undirected graph consisting of n vertices and m edges."          
              3400.0                         1060G "Balls and Pockets" "data structures" "There is a strip with an infinite number of cells. Cells are numbered starting with 0. Initially the cell i contains a ball with the number i.There are n pockets located at cells a1,\xe2\x80\xa6,an. Each cell contains at most one pocket.Filtering is the following sequence of operations: All pockets at cells a1,\xe2\x80\xa6,an open simultaneously, which makes balls currently located at those cells disappear. After the balls disappear, the pockets close again. For each cell i from 0 to \xe2\x88\x9e, if the cell i contains a ball, we move that ball to the free cell j with the lowest number. If there is no free cell j<i, the ball stays at the cell i.Note that after each filtering operation each cell will still contain exactly one ball.For example, let the cells 1, 3 and 4 contain pockets. The initial configuration of balls is shown below (underscores display the cells with pockets): 0 1 2 3 4 5 6 7 8 9 ... After opening and closing the pockets, balls 1, 3 and 4 disappear: 0   2     5 6 7 8 9 ... After moving all the balls to the left, the configuration looks like this: 0 2 5 6 7 8 9 10 11 12 ... Another filtering repetition results in the following: 0 5 8 9 10 11 12 13 14 15 ... You have to answer m questions. The i-th of these questions is ""what is the number of the ball located at the cell xi after ki repetitions of the filtering operation?"""          
              1100.0                         1060B "Maximum Sum of Digits" greedy "You are given a positive integer n.Let S(x) be sum of digits in base 10 representation of x, for example, S(123)=1+2+3=6, S(0)=0.Your task is to find two integers a,b, such that 0\xe2\x89\xa4a,b\xe2\x89\xa4n, a+b=n and S(a)+S(b) is the largest possible among all such pairs."          
              2500.0                         1056F "Write The Contest" "binary search,dp,math" "Polycarp, Arkady\'s friend, prepares to the programming competition and decides to write a contest. The contest consists of n problems and lasts for T minutes. Each of the problems is defined by two positive integers ai and pi \xe2\x80\x94 its difficulty and the score awarded by its solution.Polycarp\'s experience suggests that his skill level is defined with positive real value s, and initially s=1.0. To solve the i-th problem Polycarp needs ai/s minutes.Polycarp loves to watch series, and before solving each of the problems he will definitely watch one episode. After Polycarp watches an episode, his skill decreases by 10%, that is skill level s decreases to 0.9s. Each episode takes exactly 10 minutes to watch. When Polycarp decides to solve some problem, he firstly has to watch one episode, and only then he starts solving the problem without breaks for ai/s minutes, where s is his current skill level. In calculation of ai/s no rounding is performed, only division of integer value ai by real value s happens.Also, Polycarp can train for some time. If he trains for t minutes, he increases his skill by C\xe2\x8b\x85t, where C is some given positive real constant. Polycarp can train only before solving any problem (and before watching series). Duration of the training can be arbitrary real value.Polycarp is interested: what is the largest score he can get in the contest? It is allowed to solve problems in any order, while training is only allowed before solving the first problem."          
              1600.0                         1056D "Decorate Apple Tree" "constructive algorithms,dfs and similar,dp,graphs,greedy,sortings,trees" "There is one apple tree in Arkady\'s garden. It can be represented as a set of junctions connected with branches so that there is only one way to reach any junctions from any other one using branches. The junctions are enumerated from 1 to n, the junction 1 is called the root.A subtree of a junction v is a set of junctions u such that the path from u to the root must pass through v. Note that v itself is included in a subtree of v.A leaf is such a junction that its subtree contains exactly one junction.The New Year is coming, so Arkady wants to decorate the tree. He will put a light bulb of some color on each leaf junction and then count the number happy junctions. A happy junction is such a junction t that all light bulbs in the subtree of t have different colors.Arkady is interested in the following question: for each k from 1 to n, what is the minimum number of different colors needed to make the number of happy junctions be greater than or equal to k?"          
              800.0                         1056A "Determine Line" implementation "Arkady\'s morning seemed to be straight of his nightmare. He overslept through the whole morning and, still half-asleep, got into the tram that arrived the first. Some time after, leaving the tram, he realized that he was not sure about the line number of the tram he was in.During his ride, Arkady woke up several times and each time he saw the tram stopping at some stop. For each stop he knows which lines of tram stop there. Given this information, can you help Arkady determine what are the possible lines of the tram he was in?"          
              1700.0                         1051D Bicolorings bitmasks,dp "You are given a grid, consisting of 2 rows and n columns. Each cell of this grid should be colored either black or white.Two cells are considered neighbours if they have a common border and share the same color. Two cells A and B belong to the same component if they are neighbours, or if there is a neighbour of A that belongs to the same component with B.Let\'s call some bicoloring beautiful if it has exactly k components.Count the number of beautiful bicolorings. The number can be big enough, so print the answer modulo 998244353."          
              1200.0                         1051A "Vasya And Password" greedy,implementation,strings "Vasya came up with a password to register for EatForces \xe2\x80\x94 a string s. The password in EatForces should be a string, consisting of lowercase and uppercase Latin letters and digits.But since EatForces takes care of the security of its users, user passwords must contain at least one digit, at least one uppercase Latin letter and at least one lowercase Latin letter. For example, the passwords ""abaCABA12"", ""Z7q"" and ""3R24m"" are valid, and the passwords ""qwerty"", ""qwerty12345"" and ""Password"" are not. A substring of string s is a string x=slsl+1\xe2\x80\xa6sl+len\xe2\x88\x921(1\xe2\x89\xa4l\xe2\x89\xa4|s|,0\xe2\x89\xa4len\xe2\x89\xa4|s|\xe2\x88\x92l+1). len is the length of the substring. Note that the empty string is also considered a substring of s, it has the length 0.Vasya\'s password, however, may come too weak for the security settings of EatForces. He likes his password, so he wants to replace some its substring with another string of the same length in order to satisfy the above conditions. This operation should be performed exactly once, and the chosen string should have the minimal possible length.Note that the length of s should not change after the replacement of the substring, and the string itself should contain only lowercase and uppercase Latin letters and digits."          
              3200.0                         1045E "Ancient civilizations" "constructive algorithms,geometry" "On the surface of a newly discovered planet, which we model by a plane, explorers found remains of two different civilizations in various locations. They would like to learn more about those civilizations and to explore the area they need to build roads between some of locations. But as always, there are some restrictions:   Every two locations of the same civilization are connected by a unique path of roads  No two locations from different civilizations may have road between them (explorers don\'t want to accidentally mix civilizations they are currently exploring)  Roads must be straight line segments  Since intersections are expensive to build, they don\'t want any two roads to intersect (that is, only common point for any two roads may be at some of locations) Obviously all locations are different points in the plane, but explorers found out one more interesting information that may help you \xe2\x80\x93 no three locations lie on the same line!Help explorers and find a solution for their problem, or report it is impossible."          
              2500.0                         1043F "Make It One" "bitmasks,combinatorics,dp,math,number theory,shortest paths" "Janusz is a businessman. He owns a company ""Januszex"", which produces games for teenagers. Last hit of Januszex was a cool one-person game ""Make it one"". The player is given a sequence of n integers ai.It is allowed to select any subset of them, and the score is equal to the greatest common divisor of selected elements. The goal is to take as little elements as it is possible, getting the score 1. Now Janusz wonders, for given sequence, how much elements should the player choose?"          
              1900.0                         1043E "Train Hard, Win Easy" "constructive algorithms,greedy,math,sortings" "Zibi is a competitive programming coach. There are n competitors who want to be prepared well. The training contests are quite unusual \xe2\x80\x93 there are two people in a team, two problems, and each competitor will code exactly one of them. Of course, people in one team will code different problems.Rules of scoring also aren\'t typical. The first problem is always an implementation problem: you have to implement some well-known algorithm very fast and the time of your typing is rated. The second one is an awful geometry task and you just have to get it accepted in reasonable time. Here the length and difficulty of your code are important. After that, Zibi will give some penalty points (possibly negative) for each solution and the final score of the team is the sum of them (the less the score is, the better).We know that the i-th competitor will always have score xi when he codes the first task and yi when he codes the second task. We can assume, that all competitors know each other\'s skills and during the contest distribute the problems in the way that minimizes their final score. Remember that each person codes exactly one problem in a contest.Zibi wants all competitors to write a contest with each other. However, there are m pairs of people who really don\'t like to cooperate and they definitely won\'t write a contest together. Still, the coach is going to conduct trainings for all possible pairs of people, such that the people in pair don\'t hate each other. The coach is interested for each participant, what will be his or her sum of scores of all teams he trained in?"          
              1000.0                         1041B "Buying a TV Set" math "Monocarp has decided to buy a new TV set and hang it on the wall in his flat. The wall has enough free space so Monocarp can buy a TV set with screen width not greater than a and screen height not greater than b. Monocarp is also used to TV sets with a certain aspect ratio: formally, if the width of the screen is w, and the height of the screen is h, then the following condition should be met: wh=xy.There are many different TV sets in the shop. Monocarp is sure that for any pair of positive integers w and h there is a TV set with screen width w and height h in the shop.Monocarp isn\'t ready to choose the exact TV set he is going to buy. Firstly he wants to determine the optimal screen resolution. He has decided to try all possible variants of screen size. But he must count the number of pairs of positive integers w and h, beforehand, such that (w\xe2\x89\xa4a), (h\xe2\x89\xa4b) and (wh=xy).In other words, Monocarp wants to determine the number of TV sets having aspect ratio xy, screen width not exceeding a, and screen height not exceeding b. Two TV sets are considered different if they have different screen width or different screen height."          
              800.0                         1038A Equality implementation,strings "You are given a string s of length n, which consists only of the first k letters of the Latin alphabet. All letters in string s are uppercase.A subsequence of string s is a string that can be derived from s by deleting some of its symbols without changing the order of the remaining symbols. For example, ""ADE"" and ""BD"" are subsequences of ""ABCDE"", but ""DEA"" is not.A subsequence of s called good if the number of occurences of each of the first k letters of the alphabet is the same.Find the length of the longest good subsequence of s."          
              2200.0                         1034B "Little C Loves 3 II" "brute force,constructive algorithms,flows,graph matchings" "Little C loves number \xc2\xab3\xc2\xbb very much. He loves all things about it.Now he is playing a game on a chessboard of size n\xc3\x97m. The cell in the x-th row and in the y-th column is called (x,y). Initially, The chessboard is empty. Each time, he places two chessmen on two different empty cells, the Manhattan distance between which is exactly 3. The Manhattan distance between two cells (xi,yi) and (xj,yj) is defined as |xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|.He want to place as many chessmen as possible on the chessboard. Please help him find the maximum number of chessmen he can place."          
              2800.0                         1033E "Hidden Bipartite Graph" "binary search,constructive algorithms,dfs and similar,graphs,interactive" "Bob has a simple undirected connected graph (without self-loops and multiple edges). He wants to learn whether his graph is bipartite (that is, you can paint all vertices of the graph into two colors so that there is no edge connecting two vertices of the same color) or not. As he is not very good at programming, he asked Alice for help. He does not want to disclose his graph to Alice, but he agreed that Alice can ask him some questions about the graph.The only question that Alice can ask is the following: she sends s \xe2\x80\x94 a subset of vertices of the original graph. Bob answers with the number of edges that have both endpoints in s. Since he doesn\'t want Alice to learn too much about the graph, he allows her to ask no more than 20000 questions. Furthermore, he suspects that Alice might introduce false messages to their communication channel, so when Alice finally tells him whether the graph is bipartite or not, she also needs to provide a proof \xe2\x80\x94 either the partitions themselves or a cycle of odd length.Your task is to help Alice to construct the queries, find whether the graph is bipartite."          
              1000.0                         1033A "King Escape" "dfs and similar,graphs,implementation" "Alice and Bob are playing chess on a huge chessboard with dimensions n\xc3\x97n. Alice has a single piece left \xe2\x80\x94 a queen, located at (ax,ay), while Bob has only the king standing at (bx,by). Alice thinks that as her queen is dominating the chessboard, victory is hers. But Bob has made a devious plan to seize the victory for himself \xe2\x80\x94 he needs to march his king to (cx,cy) in order to claim the victory for himself. As Alice is distracted by her sense of superiority, she no longer moves any pieces around, and it is only Bob who makes any turns.Bob will win if he can move his king from (bx,by) to (cx,cy) without ever getting in check. Remember that a king can move to any of the 8 adjacent squares. A king is in check if it is on the same rank (i.e. row), file (i.e. column), or diagonal as the enemy queen. Find whether Bob can win or not."          
              1900.0                         1032D "Barcelonian Distance" geometry,implementation "In this problem we consider a very simplified model of Barcelona city.Barcelona can be represented as a plane with streets of kind x=c and y=c for every integer c (that is, the rectangular grid). However, there is a detail which makes Barcelona different from Manhattan. There is an avenue called Avinguda Diagonal which can be represented as a the set of points (x,y) for which ax+by+c=0.One can walk along streets, including the avenue. You are given two integer points A and B somewhere in Barcelona. Find the minimal possible distance one needs to travel to get to B from A."          
              900.0                         1032A "Kitchen Utensils"  "The king\'s birthday dinner was attended by k guests. The dinner was quite a success: every person has eaten several dishes (though the number of dishes was the same for every person) and every dish was served alongside with a new set of kitchen utensils.All types of utensils in the kingdom are numbered from 1 to 100. It is known that every set of utensils is the same and consist of different types of utensils, although every particular type may appear in the set at most once. For example, a valid set of utensils can be composed of one fork, one spoon and one knife.After the dinner was over and the guests were dismissed, the king wondered what minimum possible number of utensils could be stolen. Unfortunately, the king has forgotten how many dishes have been served for every guest but he knows the list of all the utensils left after the dinner. Your task is to find the minimum possible number of stolen utensils."          
              800.0                         1030A "In Search of an Easy Problem" implementation "When preparing a tournament, Codeforces coordinators try treir best to make the first problem as easy as possible. This time the coordinator had chosen some problem and asked n people about their opinions. Each person answered whether this problem is easy or hard.If at least one of these n people has answered that the problem is hard, the coordinator decides to change the problem. For the given responses, check if the problem is easy enough."          
              2000.0                         1029F "Multicolored Markers" "binary search,brute force,math,number theory" "There is an infinite board of square tiles. Initially all tiles are white.Vova has a red marker and a blue marker. Red marker can color a tiles. Blue marker can color b tiles. If some tile isn\'t white then you can\'t use marker of any color on it. Each marker must be drained completely, so at the end there should be exactly a red tiles and exactly b blue tiles across the board.Vova wants to color such a set of tiles that:  they would form a rectangle, consisting of exactly a+b colored tiles;  all tiles of at least one color would also form a rectangle. Here are some examples of correct colorings:  Here are some examples of incorrect colorings:  Among all correct colorings Vova wants to choose the one with the minimal perimeter. What is the minimal perimeter Vova can obtain?It is guaranteed that there exists at least one correct coloring."          
              2100.0                         1028D "Order book" "combinatorics,data structures,greedy" "Let\'s consider a simplified version of order book of some stock. The order book is a list of orders (offers) from people that want to buy or sell one unit of the stock, each order is described by direction (BUY or SELL) and price.At every moment of time, every SELL offer has higher price than every BUY offer. In this problem no two ever existed orders will have the same price.The lowest-price SELL order and the highest-price BUY order are called the best offers, marked with black frames on the picture below.  The presented order book says that someone wants to sell the product at price 12 and it\'s the best SELL offer because the other two have higher prices. The best BUY offer has price 10. There are two possible actions in this orderbook:  Somebody adds a new order of some direction with some price. Somebody accepts the best possible SELL or BUY offer (makes a deal). It\'s impossible to accept not the best SELL or BUY offer (to make a deal at worse price). After someone accepts the offer, it is removed from the orderbook forever.It is allowed to add new BUY order only with prices less than the best SELL offer (if you want to buy stock for higher price, then instead of adding an order you should accept the best SELL offer). Similarly, one couldn\'t add a new SELL order with price less or equal to the best BUY offer. For example, you can\'t add a new offer ""SELL 20"" if there is already an offer ""BUY 20"" or ""BUY 25"" \xe2\x80\x94 in this case you just accept the best BUY offer.You have a damaged order book log (in the beginning the are no orders in book). Every action has one of the two types: ""ADD p"" denotes adding a new order with price p and unknown direction. The order must not contradict with orders still not removed from the order book.  ""ACCEPT p"" denotes accepting an existing best offer with price p and unknown direction.The directions of all actions are lost. Information from the log isn\'t always enough to determine these directions. Count the number of ways to correctly restore all ADD action directions so that all the described conditions are satisfied at any moment. Since the answer could be large, output it modulo 109+7. If it is impossible to correctly restore directions, then output 0."          
              2600.0                         1027G "X-mouse in the Campus" "bitmasks,math,number theory" "The campus has m rooms numbered from 0 to m\xe2\x88\x921. Also the x-mouse lives in the campus. The x-mouse is not just a mouse: each second x-mouse moves from room i to the room i\xe2\x8b\x85xmodm (in fact, it teleports from one room to another since it doesn\'t visit any intermediate room). Starting position of the x-mouse is unknown.You are responsible to catch the x-mouse in the campus, so you are guessing about minimum possible number of traps (one trap in one room) you need to place. You are sure that if the x-mouse enters a trapped room, it immediately gets caught.And the only observation you made is GCD(x,m)=1."          
              2100.0                         1025D "Recovering BST" "brute force,dp,math,number theory,trees" "Dima the hamster enjoys nibbling different things: cages, sticks, bad problemsetters and even trees!Recently he found a binary search tree and instinctively nibbled all of its edges, hence messing up the vertices. Dima knows that if Andrew, who has been thoroughly assembling the tree for a long time, comes home and sees his creation demolished, he\'ll get extremely upset. To not let that happen, Dima has to recover the binary search tree. Luckily, he noticed that any two vertices connected by a direct edge had their greatest common divisor value exceed 1.Help Dima construct such a binary search tree or determine that it\'s impossible. The definition and properties of a binary search tree can be found here."          
              1600.0                         1025C "Plasticine zebra" "constructive algorithms,implementation" "Is there anything better than going to the zoo after a tiresome week at work? No wonder Grisha feels the same while spending the entire weekend accompanied by pretty striped zebras. Inspired by this adventure and an accidentally found plasticine pack (represented as a sequence of black and white stripes), Grisha now wants to select several consequent (contiguous) pieces of alternating colors to create a zebra. Let\'s call the number of selected pieces the length of the zebra.Before assembling the zebra Grisha can make the following operation 0 or more times. He splits the sequence in some place into two parts, then reverses each of them and sticks them together again. For example, if Grisha has pieces in the order ""bwbbw"" (here \'b\' denotes a black strip, and \'w\' denotes a white strip), then he can split the sequence as bw|bbw (here the vertical bar represents the cut), reverse both parts and obtain ""wbwbb"".Determine the maximum possible length of the zebra that Grisha can produce."          
              1700.0                         1023D "Array Restoration" "constructive algorithms,data structures" "Initially there was an array a consisting of n integers. Positions in it are numbered from 1 to n.Exactly q queries were performed on the array. During the i-th query some segment (li,ri) (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n) was selected and values of elements on positions from li to ri inclusive got changed to i. The order of the queries couldn\'t be changed and all q queries were applied. It is also known that every position from 1 to n got covered by at least one segment.We could have offered you the problem about checking if some given array (consisting of n integers with values from 1 to q) can be obtained by the aforementioned queries. However, we decided that it will come too easy for you.So the enhancement we introduced to it is the following. Some set of positions (possibly empty) in this array is selected and values of elements on these positions are set to 0.Your task is to check if this array can be obtained by the aforementioned queries. Also if it can be obtained then restore this array.If there are multiple possible arrays then print any of them."          
              2700.0                         1019D "Large Triangle" "binary search,geometry,sortings" "There is a strange peculiarity: if you connect the cities of Rostov, Taganrog and Shakhty, peculiarly, you get a triangle\xc2\xabUnbelievable But True\xc2\xbbStudents from many different parts of Russia and abroad come to Summer Informatics School. You marked the hometowns of the SIS participants on a map.Now you decided to prepare an interesting infographic based on this map. The first thing you chose to do is to find three cities on this map, such that they form a triangle with area S."          
              1700.0                         1019A Elections "brute force,greedy" "As you know, majority of students and teachers of Summer Informatics School live in Berland for the most part of the year. Since corruption there is quite widespread, the following story is not uncommon.Elections are coming. You know the number of voters and the number of parties \xe2\x80\x94 n and m respectively. For each voter you know the party he is going to vote for. However, he can easily change his vote given a certain amount of money. In particular, if you give i-th voter ci bytecoins you can ask him to vote for any other party you choose.The United Party of Berland has decided to perform a statistical study \xe2\x80\x94 you need to calculate the minimum number of bytecoins the Party needs to spend to ensure its victory. In order for a party to win the elections, it needs to receive strictly more votes than any other party."          
              2400.0                         1016E "Rest In The Shades" "binary search,geometry" "There is a light source on the plane. This source is so small that it can be represented as point. The light source is moving from point (a,sy) to the (b,sy) (sy<0) with speed equal to 1 unit per second. The trajectory of this light source is a straight segment connecting these two points. There is also a fence on OX axis represented as n segments (li,ri) (so the actual coordinates of endpoints of each segment are (li,0) and (ri,0)). The point (x,y) is in the shade if segment connecting (x,y) and the current position of the light source intersects or touches with any segment of the fence.  You are given q points. For each point calculate total time of this point being in the shade, while the light source is moving from (a,sy) to the (b,sy)."          
              1900.0                         1015E2 "Stars Drawing (Hard Edition)" "binary search,dp,greedy" "A star is a figure of the following type: an asterisk character \'*\' in the center of the figure and four rays (to the left, right, top, bottom) of the same positive length. The size of a star is the length of its rays. The size of a star must be a positive number (i.e. rays of length 0 are not allowed).Let\'s consider empty cells are denoted by \'.\', then the following figures are stars:  The leftmost figure is a star of size 1, the middle figure is a star of size 2 and the rightmost figure is a star of size 3. You are given a rectangular grid of size n\xc3\x97m consisting only of asterisks \'*\' and periods (dots) \'.\'. Rows are numbered from 1 to n, columns are numbered from 1 to m. Your task is to draw this grid using any number of stars or find out that it is impossible. Stars can intersect, overlap or even coincide with each other. The number of stars in the output can\'t exceed n\xe2\x8b\x85m. Each star should be completely inside the grid. You can use stars of same and arbitrary sizes.In this problem, you do not need to minimize the number of stars. Just find any way to draw the given grid with at most n\xe2\x8b\x85m stars."          
              1200.0                         1015B "Obtaining the String" implementation "You are given two strings s and t. Both strings have length n and consist of lowercase Latin letters. The characters in the strings are numbered from 1 to n.You can successively perform the following move any number of times (possibly, zero):  swap any two adjacent (neighboring) characters of s (i.e. for any i={1,2,\xe2\x80\xa6,n\xe2\x88\x921} you can swap si and si+1). You can\'t apply a move to the string t. The moves are applied to the string s one after another.Your task is to obtain the string t from the string s. Find any way to do it with at most 104 such moves.You do not have to minimize the number of moves, just find any sequence of moves of length 104 or less to transform s into t."          
              1200.0                         1013B And greedy "There is an array with n elements a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and the number x.In one operation you can select some i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and replace element ai with ai\xe2\x80\x89&\xe2\x80\x89x, where & denotes the bitwise and operation.You want the array to have at least two equal elements after applying some operations (possibly, none). In other words, there should be at least two distinct indices i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j such that ai\xe2\x80\x89=\xe2\x80\x89aj. Determine whether it is possible to achieve and, if possible, the minimal number of operations to apply."          
              1900.0                         1012B "Chemical table" "constructive algorithms,dfs and similar,dsu,graphs,matrices" "Innopolis University scientists continue to investigate the periodic table. There are n\xc2\xb7m known elements and they form a periodic table: a rectangle with n rows and m columns. Each element can be described by its coordinates (r,\xe2\x80\x89c) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) in the table.Recently scientists discovered that for every four different elements in this table that form a rectangle with sides parallel to the sides of the table, if they have samples of three of the four elements, they can produce a sample of the fourth element using nuclear fusion. So if we have elements in positions (r1,\xe2\x80\x89c1), (r1,\xe2\x80\x89c2), (r2,\xe2\x80\x89c1), where r1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89r2 and c1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89c2, then we can produce element (r2,\xe2\x80\x89c2).  Samples used in fusion are not wasted and can be used again in future fusions. Newly crafted elements also can be used in future fusions.Innopolis University scientists already have samples of q elements. They want to obtain samples of all n\xc2\xb7m elements. To achieve that, they will purchase some samples from other laboratories and then produce all remaining elements using an arbitrary number of nuclear fusions in some order. Help them to find the minimal number of elements they need to purchase."          
              1500.0                         1012A "Photo of The Sky" "brute force,implementation,math,sortings" "Pavel made a photo of his favourite stars in the sky. His camera takes a photo of all points of the sky that belong to some rectangle with sides parallel to the coordinate axes.Strictly speaking, it makes a photo of all points with coordinates (x,y), such that x1\xe2\x89\xa4x\xe2\x89\xa4x2 and y1\xe2\x89\xa4y\xe2\x89\xa4y2, where (x1,y1) and (x2,y2) are coordinates of the left bottom and the right top corners of the rectangle being photographed. The area of this rectangle can be zero.After taking the photo, Pavel wrote down coordinates of n of his favourite stars which appeared in the photo. These points are not necessarily distinct, there can be multiple stars in the same point of the sky.Pavel has lost his camera recently and wants to buy a similar one. Specifically, he wants to know the dimensions of the photo he took earlier. Unfortunately, the photo is also lost. His notes are also of not much help; numbers are written in random order all over his notepad, so it\'s impossible to tell which numbers specify coordinates of which points.Pavel asked you to help him to determine what are the possible dimensions of the photo according to his notes. As there are multiple possible answers, find the dimensions with the minimal possible area of the rectangle."          
              3200.0                         1007D Ants "2-sat,data structures,trees" "There is a tree with n vertices. There are also m ants living on it. Each ant has its own color. The i-th ant has two favorite pairs of vertices: (ai,bi) and (ci,di). You need to tell if it is possible to paint the edges of the tree in m colors so that every ant will be able to walk between vertices from one of its favorite pairs using only edges of his color; if it is possible, you need to print which pair every ant should use."          
              1600.0                         1003D "Coins and Queries" greedy "Polycarp has n coins, the value of the i-th coin is ai. It is guaranteed that all the values are integer powers of 2 (i.e. ai=2d for some non-negative integer number d).Polycarp wants to know answers on q queries. The j-th query is described as integer number bj. The answer to the query is the minimum number of coins that is necessary to obtain the value bj using some subset of coins (Polycarp can use only coins he has). If Polycarp can\'t obtain the value bj, the answer to the j-th query is -1.The queries are independent (the answer on the query doesn\'t affect Polycarp\'s coins)."          
              1900.0                         1000D "Yet Another Problem On a Subsequence" combinatorics,dp "The sequence of integers a1,a2,\xe2\x80\xa6,ak is called a good array if a1=k\xe2\x88\x921 and a1>0. For example, the sequences [3,\xe2\x88\x921,44,0],[1,\xe2\x88\x9299] are good arrays, and the sequences [3,7,8],[2,5,4,1],[0] \xe2\x80\x94 are not.A sequence of integers is called good if it can be divided into a positive number of good arrays. Each good array should be a subsegment of sequence and each element of the sequence should belong to exactly one array. For example, the sequences [2,\xe2\x88\x923,0,1,4], [1,2,3,\xe2\x88\x923,\xe2\x88\x929,4] are good, and the sequences [2,\xe2\x88\x923,0,1], [1,2,3,\xe2\x88\x923\xe2\x88\x929,4,1] \xe2\x80\x94 are not.For a given sequence of numbers, count the number of its subsequences that are good sequences, and print the number of such subsequences modulo 998244353."          
              2000.0                         999F "Cards and Joy" dp "There are n players sitting at the card table. Each player has a favorite number. The favorite number of the j-th player is fj.There are k\xe2\x8b\x85n cards on the table. Each card contains a single integer: the i-th card contains number ci. Also, you are given a sequence h1,h2,\xe2\x80\xa6,hk. Its meaning will be explained below.The players have to distribute all the cards in such a way that each of them will hold exactly k cards. After all the cards are distributed, each player counts the number of cards he has that contains his favorite number. The joy level of a player equals ht if the player holds t cards containing his favorite number. If a player gets no cards with his favorite number (i.e., t=0), his joy level is 0.Print the maximum possible total joy levels of the players after the cards are distributed. Note that the sequence h1,\xe2\x80\xa6,hk is the same for all the players."          
              2900.0                         997D "Cycles in product" "combinatorics,divide and conquer,trees" "Consider a tree (that is, an undirected connected graph without loops) T1 and a tree T2. Let\'s define their cartesian product T1\xc3\x97T2 in a following way.Let V be the set of vertices in T1 and U be the set of vertices in T2.Then the set of vertices of graph T1\xc3\x97T2 is V\xc3\x97U, that is, a set of ordered pairs of vertices, where the first vertex in pair is from V and the second \xe2\x80\x94 from U.Let\'s draw the following edges: Between (v,u1) and (v,u2) there is an undirected edge, if u1 and u2 are adjacent in U.  Similarly, between (v1,u) and (v2,u) there is an undirected edge, if v1 and v2 are adjacent in V. Please see the notes section for the pictures of products of trees in the sample tests.Let\'s examine the graph T1\xc3\x97T2. How much cycles (not necessarily simple) of length k it contains? Since this number can be very large, print it modulo 998244353.The sequence of vertices w1, w2, ..., wk, where wi\xe2\x88\x88V\xc3\x97U called cycle, if any neighboring vertices are adjacent and w1 is adjacent to wk. Cycles that differ only by the cyclic shift or direction of traversal are still considered different."          
              1800.0                         991E "Bus Number" "brute force,combinatorics,math" "This night wasn\'t easy on Vasya. His favorite team lost, and he didn\'t find himself victorious either \xe2\x80\x94 although he played perfectly, his teammates let him down every time. He had to win at least one more time, but the losestreak only grew longer and longer... It\'s no wonder he didn\'t get any sleep this night at all.In the morning, Vasya was waiting the bus to the university on the bus stop. Vasya\'s thoughts were hazy and so he couldn\'t remember the right bus\' number quite right and got onto the bus with the number n.In the bus, Vasya thought that he could get the order of the digits in the number of the bus wrong. Futhermore, he could ""see"" some digits several times, but the digits he saw were definitely in the real number of the bus. For example, if Vasya saw the number 2028, it could mean that the real bus number could be 2028, 8022, 2820 or just 820. However, numbers 80, 22208, 52 definitely couldn\'t be the number of the bus. Also, real bus number couldn\'t start with the digit 0, this meaning that, for example, number 082 couldn\'t be the real bus number too.Given n, determine the total number of possible bus number variants."          
              900.0                         991B "Getting an A" greedy,sortings "Translator\'s note: in Russia\'s most widespread grading system, there are four grades: 5, 4, 3, 2, the higher the better, roughly corresponding to A, B, C and F respectively in American grading system.The term is coming to an end and students start thinking about their grades. Today, a professor told his students that the grades for his course would be given out automatically  \xe2\x80\x94 he would calculate the simple average (arithmetic mean) of all grades given out for lab works this term and round to the nearest integer. The rounding would be done in favour of the student \xe2\x80\x94 4.5 would be rounded up to 5 (as in example 3), but 4.4 would be rounded down to 4.This does not bode well for Vasya who didn\'t think those lab works would influence anything, so he may receive a grade worse than 5 (maybe even the dreaded 2). However, the professor allowed him to redo some of his works of Vasya\'s choosing to increase his average grade. Vasya wants to redo as as few lab works as possible in order to get 5 for the course. Of course, Vasya will get 5 for the lab works he chooses to redo.Help Vasya \xe2\x80\x94 calculate the minimum amount of lab works Vasya has to redo."          
              1700.0                         990D "Graph And Its Complement" "constructive algorithms,graphs,implementation" "Given three numbers n,a,b. You need to find an adjacency matrix of such an undirected graph that the number of components in it is equal to a, and the number of components in its complement is b. The matrix must be symmetric, and all digits on the main diagonal must be zeroes.In an undirected graph loops (edges from a vertex to itself) are not allowed. It can be at most one edge between a pair of vertices.The adjacency matrix of an undirected graph is a square matrix of size n consisting only of ""0"" and ""1"", where n is the number of vertices of the graph and the i-th row and the i-th column correspond to the i-th vertex of the graph. The cell (i,j) of the adjacency matrix contains 1 if and only if the i-th and j-th vertices in the graph are connected by an edge.A connected component is a set of vertices X such that for every two vertices from this set there exists at least one path in the graph connecting this pair of vertices, but adding any other vertex to X violates this rule.The complement or inverse of a graph G is a graph H on the same vertices such that two distinct vertices of H are adjacent if and only if they are not adjacent in G."          
              1500.0                         990C "Bracket Sequences Concatenation Problem" implementation "A bracket sequence is a string containing only characters ""("" and "")"".A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, bracket sequences ""()()"", ""(())"" are regular (the resulting expressions are: ""(1)+(1)"", ""((1+1)+1)""), and "")("" and ""("" are not.You are given n bracket sequences s1,s2,\xe2\x80\xa6,sn. Calculate the number of pairs i,j(1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that the bracket sequence si+sj is a regular bracket sequence. Operation + means concatenation i.e. ""()("" + "")()"" = ""()()()"".If si+sj and sj+si are regular bracket sequences and i\xe2\x89\xa0j, then both pairs (i,j) and (j,i) must be counted in the answer. Also, if si+si is a regular bracket sequence, the pair (i,i) must be counted in the answer."          
              2700.0                         989E "A Trance of Nightfall" dp,geometry,matrices,probabilities "The cool breeze blows gently, the flowing water ripples steadily.""Flowing and passing like this, the water isn\'t gone ultimately; Waxing and waning like that, the moon doesn\'t shrink or grow eventually.""""Everything is transient in a way and perennial in another.""Kanno doesn\'t seem to make much sense out of Mino\'s isolated words, but maybe it\'s time that they enjoy the gentle breeze and the night sky \xe2\x80\x94 the inexhaustible gifts from nature.Gazing into the sky of stars, Kanno indulges in a night\'s tranquil dreams. There is a set S of n points on a coordinate plane.Kanno starts from a point P that can be chosen on the plane. P is not added to S if it doesn\'t belong to S. Then the following sequence of operations (altogether called a move) is repeated several times, in the given order:  Choose a line l such that it passes through at least two elements in S and passes through Kanno\'s current position. If there are multiple such lines, one is chosen equiprobably.  Move to one of the points that belong to S and lie on l. The destination is chosen equiprobably among all possible ones, including Kanno\'s current position (if it does belong to S). There are q queries each consisting of two integers (ti,mi). For each query, you\'re to help Kanno maximize the probability of the stopping position being the ti-th element in S after mi moves with a proper selection of P, and output this maximum probability. Note that according to rule 1, P should belong to at least one line that passes through at least two points from S."          
              900.0                         989A "A Blend of Springtime" implementation,strings "When the curtains are opened, a canvas unfolds outside. Kanno marvels at all the blonde colours along the riverside \xe2\x80\x94 not tangerines, but blossoms instead.""What a pity it\'s already late spring,"" sighs Mino with regret, ""one more drizzling night and they\'d be gone.""""But these blends are at their best, aren\'t they?"" Absorbed in the landscape, Kanno remains optimistic. The landscape can be expressed as a row of consecutive cells, each of which either contains a flower of colour amber or buff or canary yellow, or is empty.When a flower withers, it disappears from the cell that it originally belonged to, and it spreads petals of its colour in its two neighbouring cells (or outside the field if the cell is on the side of the landscape). In case petals fall outside the given cells, they simply become invisible.You are to help Kanno determine whether it\'s possible that after some (possibly none or all) flowers shed their petals, at least one of the cells contains all three colours, considering both petals and flowers. Note that flowers can wither in arbitrary order."          
              2100.0                         988E "Divisibility by 25" "brute force,greedy" "You are given an integer n from 1 to 1018 without leading zeroes.In one move you can swap any two adjacent digits in the given number in such a way that the resulting number will not contain leading zeroes. In other words, after each move the number you have cannot contain any leading zeroes.What is the minimum number of moves you have to make to obtain a number that is divisible by 25? Print -1 if it is impossible to obtain a number that is divisible by 25."          
              3300.0                         986F "Oppa Funcan Style Remastered" "graphs,math,number theory,shortest paths" "Surely you have seen insane videos by South Korean rapper PSY, such as ""Gangnam Style"", ""Gentleman"" and ""Daddy"". You might also hear that PSY has been recording video ""Oppa Funcan Style"" two years ago (unfortunately we couldn\'t find it on the internet). We will remind you what this hit looked like (you can find original description here):On the ground there are n platforms, which are numbered with integers from 1 to n, on i-th platform there is a dancer with number i. Further, every second all the dancers standing on the platform with number i jump to the platform with the number f(i). The moving rule f is selected in advance and is not changed throughout the clip.The duration of the clip was k seconds and the rule f was chosen in such a way that after k seconds all dancers were in their initial positions (i.e. the i-th dancer stood on the platform with the number i). That allowed to loop the clip and collect even more likes.PSY knows that enhanced versions of old artworks become more and more popular every day. So he decided to release a remastered-version of his video.In his case ""enhanced version"" means even more insanity, so the number of platforms can be up to 1018! But the video director said that if some dancer stays on the same platform all the time, then the viewer will get bored and will turn off the video immediately. Therefore, for all x from 1 to n f(x)\xe2\x89\xa0x must hold.Big part of classic video\'s success was in that looping, so in the remastered version all dancers should return to their initial positions in the end of the clip as well.PSY hasn\'t decided on the exact number of platforms and video duration yet, so he asks you to check if there is a good rule f for different options."          
              1100.0                         984B Minesweeper implementation "One day Alex decided to remember childhood when computers were not too powerful and lots of people played only default games. Alex enjoyed playing Minesweeper that time. He imagined that he saved world from bombs planted by terrorists, but he rarely won.Alex has grown up since then, so he easily wins the most difficult levels. This quickly bored him, and he thought: what if the computer gave him invalid fields in the childhood and Alex could not win because of it?He needs your help to check it.A Minesweeper field is a rectangle n\xc3\x97m, where each cell is either empty, or contains a digit from 1 to 8, or a bomb. The field is valid if for each cell:   if there is a digit k in the cell, then exactly k neighboring cells have bombs.  if the cell is empty, then all neighboring cells have no bombs. Two cells are neighbors if they have a common side or a corner (i. e. a cell has at most 8 neighboring cells)."          
              2800.0                         983E "NN country" "binary search,data structures,trees" "In the NN country, there are nn cities, numbered from 11 to nn, and n\xe2\x88\x921n\xe2\x88\x921 roads, connecting them. There is a roads path between any two cities.There are mm bidirectional bus routes between cities. Buses drive between two cities taking the shortest path with stops in every city they drive through. Travelling by bus, you can travel from any stop on the route to any other. You can travel between cities only by bus.You are interested in qq questions: is it possible to get from one city to another and what is the minimum number of buses you need to use for it?"          
              1700.0                         983A "Finite or not?" implementation,math "You are given several queries. Each query consists of three integers p, q and b. You need to answer whether the result of p/q in notation with base b is a finite fraction.A fraction in notation with base b is finite if it contains finite number of numerals after the decimal point. It is also possible that a fraction has zero numerals after the decimal point."          
              2500.0                         981G "Magic multisets" "data structures" "In the School of Magic in Dirtpolis a lot of interesting objects are studied on Computer Science lessons.Consider, for example, the magic multiset. If you try to add an integer to it that is already presented in the multiset, each element in the multiset duplicates. For example, if you try to add the integer 2 to the multiset {1,2,3,3}, you will get {1,1,2,2,3,3,3,3}. If you try to add an integer that is not presented in the multiset, it is simply added to it. For example, if you try to add the integer 4 to the multiset {1,2,3,3}, you will get {1,2,3,3,4}.Also consider an array of n initially empty magic multisets, enumerated from 1 to n.You are to answer q queries of the form ""add an integer x to all multisets with indices l,l+1,\xe2\x80\xa6,r"" and ""compute the sum of sizes of multisets with indices l,l+1,\xe2\x80\xa6,r"". The answers for the second type queries can be large, so print the answers modulo 998244353."          
              2400.0                         979E "Kuro and Topological Parity" dp "Kuro has recently won the ""Most intelligent cat ever"" contest. The three friends then decided to go to Katie\'s home to celebrate Kuro\'s winning. After a big meal, they took a small break then started playing games.Kuro challenged Katie to create a game with only a white paper, a pencil, a pair of scissors and a lot of arrows (you can assume that the number of arrows is infinite). Immediately, Katie came up with the game called Topological Parity.The paper is divided into n pieces enumerated from 1 to n. Shiro has painted some pieces with some color. Specifically, the i-th piece has color ci where ci=0 defines black color, ci=1 defines white color and ci=\xe2\x88\x921 means that the piece hasn\'t been colored yet.The rules of the game is simple. Players must put some arrows between some pairs of different pieces in such a way that for each arrow, the number in the piece it starts from is less than the number of the piece it ends at. Also, two different pieces can only be connected by at most one arrow. After that the players must choose the color (0 or 1) for each of the unpainted pieces. The score of a valid way of putting the arrows and coloring pieces is defined as the number of paths of pieces of alternating colors. For example, [1\xe2\x86\x920\xe2\x86\x921\xe2\x86\x920], [0\xe2\x86\x921\xe2\x86\x920\xe2\x86\x921], [1], [0] are valid paths and will be counted. You can only travel from piece x to piece y if and only if there is an arrow from x to y.But Kuro is not fun yet. He loves parity. Let\'s call his favorite parity p where p=0 stands for ""even"" and p=1 stands for ""odd"". He wants to put the arrows and choose colors in such a way that the score has the parity of p.It seems like there will be so many ways which satisfy Kuro. He wants to count the number of them but this could be a very large number. Let\'s help him with his problem, but print it modulo 109+7."          
              2200.0                         979D "Kuro and GCD and XOR and SUM" "binary search,bitmasks,brute force,data structures,dp,dsu,greedy,math,number theory,strings,trees" "Kuro is currently playing an educational game about numbers. The game focuses on the greatest common divisor (GCD), the XOR value, and the sum of two numbers. Kuro loves the game so much that he solves levels by levels day by day.Sadly, he\'s going on a vacation for a day, and he isn\'t able to continue his solving streak on his own. As Katie is a reliable person, Kuro kindly asked her to come to his house on this day to play the game for him.Initally, there is an empty array a. The game consists of q tasks of two types. The first type asks Katie to add a number ui to a. The second type asks Katie to find a number v existing in a such that ki\xe2\x88\xa3GCD(xi,v), xi+v\xe2\x89\xa4si, and xi\xe2\x8a\x95v is maximized, where \xe2\x8a\x95 denotes the bitwise XOR operation, GCD(c,d) denotes the greatest common divisor of integers c and d, and y\xe2\x88\xa3x means x is divisible by y, or report -1 if no such numbers are found.Since you are a programmer, Katie needs you to automatically and accurately perform the tasks in the game to satisfy her dear friend Kuro. Let\'s help her!"          
              800.0                         978A "Remove Duplicates" implementation "Petya has an array a consisting of n integers. He wants to remove duplicate (equal) elements.Petya wants to leave only the rightmost entry (occurrence) for each element of the array. The relative order of the remaining unique elements should not be changed."          
              900.0                         977B Two-gram implementation,strings "Two-gram is an ordered pair (i.e. string of length two) of capital Latin letters. For example, ""AZ"", ""AA"", ""ZA"" \xe2\x80\x94 three distinct two-grams.You are given a string s consisting of n capital Latin letters. Your task is to find any two-gram contained in the given string as a substring (i.e. two consecutive characters of the string) maximal number of times. For example, for string s = ""BBAABBBA"" the answer is two-gram ""BB"", which contained in s three times. In other words, find any most frequent two-gram.Note that occurrences of the two-gram can overlap with each other."          
              2100.0                         976E "Well played!" greedy,sortings "Recently Max has got himself into popular CCG ""BrainStone"". As ""BrainStone"" is a pretty intellectual game, Max has to solve numerous hard problems during the gameplay. Here is one of them:Max owns n creatures, i-th of them can be described with two numbers \xe2\x80\x94 its health hpi and its damage dmgi. Max also has two types of spells in stock:  Doubles health of the creature (hpi := hpi\xc2\xb72);  Assigns value of health of the creature to its damage (dmgi := hpi). Spell of first type can be used no more than a times in total, of the second type \xe2\x80\x94 no more than b times in total. Spell can be used on a certain creature multiple times. Spells can be used in arbitrary order. It isn\'t necessary to use all the spells.Max is really busy preparing for his final exams, so he asks you to determine what is the maximal total damage of all creatures he can achieve if he uses spells in most optimal way."          
              2500.0                         976D "Degree Set" "constructive algorithms,graphs,implementation" "You are given a sequence of n positive integers d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dn (d1\xe2\x80\x89<\xe2\x80\x89d2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89dn). Your task is to construct an undirected graph such that:  there are exactly dn\xe2\x80\x89+\xe2\x80\x891 vertices;  there are no self-loops;  there are no multiple edges;  there are no more than 106 edges;  its degree set is equal to d. Vertices should be numbered 1 through (dn\xe2\x80\x89+\xe2\x80\x891).Degree sequence is an array a with length equal to the number of vertices in a graph such that ai is the number of vertices adjacent to i-th vertex.Degree set is a sorted in increasing order sequence of all distinct values from the degree sequence.It is guaranteed that there exists such a graph that all the conditions hold, and it contains no more than 106 edges.Print the resulting graph."          
              1500.0                         976C "Nested Segments" greedy,implementation,sortings "You are given a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of one-dimensional segments numbered 1 through n. Your task is to find two distinct indices i and j such that segment ai lies within segment aj.Segment [l1,\xe2\x80\x89r1] lies within segment [l2,\xe2\x80\x89r2] iff l1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89l2 and r1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2.Print indices i and j. If there are multiple answers, print any of them. If no answer exists, print -1 -1."          
              1800.0                         963A "Alternating Sum" "math,number theory" "You are given two integers a and b. Moreover, you are given a sequence s0,s1,\xe2\x80\xa6,sn. All values in s are integers 1 or \xe2\x88\x921. It\'s known that sequence is k-periodic and k divides n+1. In other words, for each k\xe2\x89\xa4i\xe2\x89\xa4n it\'s satisfied that si=si\xe2\x88\x92k.Find out the non-negative remainder of division of n\xe2\x88\x91i=0sian\xe2\x88\x92ibi by 109+9.Note that the modulo is unusual!"          
              2200.0                         962E "Byteland, Berland and Disputed Cities" "constructive algorithms,greedy" "The cities of Byteland and Berland are located on the axis Ox. In addition, on this axis there are also disputed cities, which belong to each of the countries in their opinion. Thus, on the line Ox there are three types of cities:  the cities of Byteland,  the cities of Berland,  disputed cities. Recently, the project BNET has been launched \xe2\x80\x94 a computer network of a new generation. Now the task of the both countries is to connect the cities so that the network of this country is connected.The countries agreed to connect the pairs of cities with BNET cables in such a way that:  If you look at the only cities of Byteland and the disputed cities, then in the resulting set of cities, any city should be reachable from any other one by one or more cables,  If you look at the only cities of Berland and the disputed cities, then in the resulting set of cities, any city should be reachable from any other one by one or more cables. Thus, it is necessary to choose a set of pairs of cities to connect by cables in such a way that both conditions are satisfied simultaneously. Cables allow bi-directional data transfer. Each cable connects exactly two distinct cities.The cost of laying a cable from one city to another is equal to the distance between them. Find the minimum total cost of laying a set of cables so that two subsets of cities (Byteland and disputed cities, Berland and disputed cities) are connected.Each city is a point on the line Ox. It is technically possible to connect the cities a and b with a cable so that the city c (a<c<b) is not connected to this cable, where a, b and c are simultaneously coordinates of the cities a, b and c."          
              900.0                         961A Tetris implementation "You are given a following process. There is a platform with n columns. 1\xc3\x971 squares are appearing one after another in some columns on this platform. If there are no squares in the column, a square will occupy the bottom row. Otherwise a square will appear at the top of the highest square of this column. When all of the n columns have at least one square in them, the bottom row is being removed. You will receive 1 point for this, and all the squares left will fall down one row. You task is to calculate the amount of points you will receive."          
              1900.0                         959D "Mahmoud and Ehab and another array construction task" "constructive algorithms,greedy,math,number theory" "Mahmoud has an array a consisting of n integers. He asked Ehab to find another array b of the same length such that:  b is lexicographically greater than or equal to a.  bi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892.  b is pairwise coprime: for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, bi and bj are coprime, i. e. GCD(bi,\xe2\x80\x89bj)\xe2\x80\x89=\xe2\x80\x891, where GCD(w,\xe2\x80\x89z) is the greatest common divisor of w and z. Ehab wants to choose a special array so he wants the lexicographically minimal array between all the variants. Can you find it?An array x is lexicographically greater than an array y if there exists an index i such than xi\xe2\x80\x89>\xe2\x80\x89yi and xj\xe2\x80\x89=\xe2\x80\x89yj for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89i. An array x is equal to an array y if xi\xe2\x80\x89=\xe2\x80\x89yi for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n."          
              1200.0                         959B "Mahmoud and Ehab and the message" dsu,greedy,implementation "Mahmoud wants to send a message to his friend Ehab. Their language consists of n words numbered from 1 to n. Some words have the same meaning so there are k groups of words such that all the words in some group have the same meaning.Mahmoud knows that the i-th word can be sent with cost ai. For each word in his message, Mahmoud can either replace it with another word of the same meaning or leave it as it is. Can you help Mahmoud determine the minimum cost of sending the message?The cost of sending the message is the sum of the costs of sending every word in it."          
              2000.0                         958C2 "Encryption (medium)" dp "Heidi has now broken the first level of encryption of the Death Star plans, and is staring at the screen presenting her with the description of the next code she has to enter. It looks surprisingly similar to the first one \xe2\x80\x93 seems like the Empire engineers were quite lazy...Heidi is once again given a sequence A, but now she is also given two integers k and p. She needs to find out what the encryption key S is.Let X be a sequence of integers, and p a positive integer. We define the score of X to be the sum of the elements of X modulo p.Heidi is given a sequence A that consists of N integers, and also given integers k and p. Her goal is to split A into k part such that:   Each part contains at least 1 element of A, and each part consists of contiguous elements of A.  No two parts overlap.  The total sum S of the scores of those parts is maximized. Output the sum S \xe2\x80\x93 the encryption code."          
              2100.0                         954F "Runner\'s Problem" dp,matrices,sortings "You are running through a rectangular field. This field can be represented as a matrix with 3 rows and m columns. (i,\xe2\x80\x89j) denotes a cell belonging to i-th row and j-th column.You start in (2,\xe2\x80\x891) and have to end your path in (2,\xe2\x80\x89m). From the cell (i,\xe2\x80\x89j) you may advance to:  (i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 only if i\xe2\x80\x89>\xe2\x80\x891,  (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891), or  (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 only if i\xe2\x80\x89<\xe2\x80\x893. However, there are n obstacles blocking your path. k-th obstacle is denoted by three integers ak, lk and rk, and it forbids entering any cell (ak,\xe2\x80\x89j) such that lk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rk.You have to calculate the number of different paths from (2,\xe2\x80\x891) to (2,\xe2\x80\x89m), and print it modulo 109\xe2\x80\x89+\xe2\x80\x897."          
              2400.0                         952F "2 + 2 != 4"  "One very experienced problem writer decided to prepare a problem for April Fools Day contest. The task was very simple - given an arithmetic expression, return the result of evaluating this expression. However, looks like there is a bug in the reference solution..."          
              1100.0                         950B "Intercepted Message" greedy,implementation "Hacker Zhorik wants to decipher two secret messages he intercepted yesterday. Yeah message is a sequence of encrypted blocks, each of them consists of several bytes of information.Zhorik knows that each of the messages is an archive containing one or more files. Zhorik knows how each of these archives was transferred through the network: if an archive consists of k files of sizes l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lk bytes, then the i-th file is split to one or more blocks bi,\xe2\x80\x891,\xe2\x80\x89bi,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89bi,\xe2\x80\x89mi (here the total length of the blocks bi,\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89bi,\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89bi,\xe2\x80\x89mi is equal to the length of the file li), and after that all blocks are transferred through the network, maintaining the order of files in the archive.Zhorik thinks that the two messages contain the same archive, because their total lengths are equal. However, each file can be split in blocks in different ways in the two messages.You are given the lengths of blocks in each of the two messages. Help Zhorik to determine what is the maximum number of files could be in the archive, if the Zhorik\'s assumption is correct."          
              800.0                         950A "Left-handers, Right-handers and Ambidexters" implementation,math "You are at a water bowling training. There are l people who play with their left hand, r people, who play with their right hand, and a ambidexters, who can play with left or right hand.The coach decided to form a team of even number of players, exactly half of the players should play with their right hand, and exactly half of the players should play with their left hand. One player should use only on of his hands.Ambidexters play as well with their right hand as with their left hand. In the team, an ambidexter can play with their left hand, or with their right hand.Please find the maximum possible size of the team, where equal number of players use their left and right hands, respectively."          
              2200.0                         946E "Largest Beautiful Number" greedy,implementation "Yes, that\'s another problem with definition of ""beautiful"" numbers.Let\'s call a positive integer x beautiful if its decimal representation without leading zeroes contains even number of digits, and there exists a permutation of this representation which is palindromic. For example, 4242 is a beautiful number, since it contains 4 digits, and there exists a palindromic permutation 2442.Given a positive integer s, find the largest beautiful number which is less than s."          
              2400.0                         939F Cutlet "data structures,dp" "Arkady wants to have a dinner. He has just returned from a shop where he has bought a semifinished cutlet. He only needs to fry it. The cutlet should be fried for 2n seconds, in particular, it should be fried for n seconds on one side and n seconds on the other side. Arkady has already got a frying pan and turn on fire, but understood that maybe he won\'t be able to flip the cutlet exactly after n seconds after the beginning of cooking.Arkady is too busy with sorting sticker packs in his favorite messenger and can flip the cutlet only in some periods of time. Namely, there are k periods of time in which he can do it, the i-th of them is an interval of time from li seconds after he starts cooking till ri seconds, inclusive. Arkady decided that it\'s not required to flip the cutlet exactly in the middle of cooking, instead, he will flip it several times in such a way that the cutlet will be fried exactly n seconds on one side and n seconds on the other side in total.Help Arkady and find out if it\'s possible for him to cook the cutlet, if he is able to flip the cutlet only in given periods of time; and if yes, find the minimum number of flips he needs to cook the cutlet."          
              1600.0                         939C "Convenient For Everybody" "binary search,two pointers" "In distant future on Earth day lasts for n hours and that\'s why there are n timezones. Local times in adjacent timezones differ by one hour. For describing local time, hours numbers from 1 to n are used, i.e. there is no time ""0 hours"", instead of it ""n hours"" is used. When local time in the 1-st timezone is 1 hour, local time in the i-th timezone is i hours.Some online programming contests platform wants to conduct a contest that lasts for an hour in such a way that its beginning coincides with beginning of some hour (in all time zones). The platform knows, that there are ai people from i-th timezone who want to participate in the contest. Each person will participate if and only if the contest starts no earlier than s hours 00 minutes local time and ends not later than f hours 00 minutes local time. Values s and f are equal for all time zones. If the contest starts at f hours 00 minutes local time, the person won\'t participate in it.Help platform select such an hour, that the number of people who will participate in the contest is maximum."          
              1600.0                         932C "Permutation Cycle" "brute force,constructive algorithms" "For a permutation P[1... N] of integers from 1 to N, function f is defined as follows:  Let g(i) be the minimum positive integer j such that f(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89i. We can show such j always exists.For given N,\xe2\x80\x89A,\xe2\x80\x89B, find a permutation P of integers from 1 to N such that for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N, g(i) equals either A or B."          
              1900.0                         926E "Merge Equal Elements" "constructive algorithms,data structures" "You are given a sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. While possible, you perform the following operation: find a pair of equal consecutive elements. If there are more than one such pair, find the leftmost (with the smallest indices of elements). If the two integers are equal to x, delete both and insert a single integer x\xe2\x80\x89+\xe2\x80\x891 on their place. This way the number of elements in the sequence is decreased by 1 on each step. You stop performing the operation when there is no pair of equal consecutive elements.For example, if the initial sequence is [5,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x892], then after the first operation you get [5,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x892], after the second \xe2\x80\x94 [5,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x892], after the third \xe2\x80\x94 [5,\xe2\x80\x893,\xe2\x80\x893], and finally after the fourth you get [5,\xe2\x80\x894]. After that there are no equal consecutive elements left in the sequence, so you stop the process.Determine the final sequence after you stop performing the operation."          
              2500.0                         923D "Picking Strings" "constructive algorithms,implementation,strings" "Alice has a string consisting of characters \'A\', \'B\' and \'C\'. Bob can use the following transitions on any substring of our string in any order any number of times:   A  BC  B  AC  C  AB  AAA  empty string Note that a substring is one or more consecutive characters. For given queries, determine whether it is possible to obtain the target string from source."          
              1600.0                         922C "Cave Painting" "brute force,number theory" "Imp is watching a documentary about cave painting.  Some numbers, carved in chaotic order, immediately attracted his attention. Imp rapidly proposed a guess that they are the remainders of division of a number n by all integers i from 1 to k. Unfortunately, there are too many integers to analyze for Imp.Imp wants you to check whether all these remainders are distinct. Formally, he wants to check, if all , 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k, are distinct, i. e. there is no such pair (i,\xe2\x80\x89j) that:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k,  , where  is the remainder of division x by y."          
              3200.0                         92108 Labyrinth-8  "See the problem statement here: http://codeforces.com/contest/921/problem/01."          
              3200.0                         92107 Labyrinth-7  "See the problem statement here: http://codeforces.com/contest/921/problem/01."          
                                           449E "Jzzhu and Squares" "dp,math,number theory" "Jzzhu has two integers, n and m. He calls an integer point (x,\xe2\x80\x89y) of a plane special if 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. Jzzhu defines a unit square as a square with corners at points (x,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), where x and y are some integers.Let\'s look at all the squares (their sides not necessarily parallel to the coordinate axes) with corners at the special points. For each such square Jzzhu paints a dot in every unit square that is fully inside it. After that some unit squares can contain several dots. Now Jzzhu wonders, how many dots he has painted on the plane. Find this number modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2900.0     
                                           447B "DZY Loves Strings" greedy,implementation "DZY loves collecting special strings which only contain lowercase letters. For each lowercase letter c DZY knows its value wc. For each special string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (|s| is the length of the string) he represents its value with a function f(s), where Now DZY has a string s. He wants to insert k lowercase letters into this string in order to get the largest possible value of the resulting string. Can you help him calculate the largest possible value he could get?" 1000.0     
                                           446E "DZY Loves Bridges" math,matrices "DZY owns 2m islands near his home, numbered from 1 to 2m. He loves building bridges to connect the islands. Every bridge he builds takes one day\'s time to walk across.DZY has a strange rule of building the bridges. For every pair of islands u,\xe2\x80\x89v (u\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89v), he has built 2k different bridges connecting them, where  (a|b means b is divisible by a). These bridges are bidirectional.Also, DZY has built some bridges connecting his home with the islands. Specifically, there are ai different bridges from his home to the i-th island. These are one-way bridges, so after he leaves his home he will never come back.DZY decides to go to the islands for sightseeing. At first he is at home. He chooses and walks across one of the bridges connecting with his home, and arrives at some island. After that, he will spend t day(s) on the islands. Each day, he can choose to stay and rest, or to walk to another island across the bridge. It is allowed to stay at an island for more than one day. It\'s also allowed to cross one bridge more than once.Suppose that right after the t-th day DZY stands at the i-th island. Let ans[i] be the number of ways for DZY to reach the i-th island after t-th day. Your task is to calculate ans[i] for each i modulo 1051131." 3100.0     
                                           443A "Anton and Letters" "constructive algorithms,implementation" "Recently, Anton has found a set. The set consists of small English letters. Anton carefully wrote out all the letters from the set in one line, separated by a comma. He also added an opening curved bracket at the beginning of the line and a closing curved bracket at the end of the line. Unfortunately, from time to time Anton would forget writing some letter and write it again. He asks you to count the total number of distinct letters in his set." 800.0     
                                           442E "Gena and Second Distance" geometry "Gena doesn\'t like geometry, so he asks you to solve this problem for him.A rectangle with sides parallel to coordinate axes contains n dots. Let\'s consider some point of the plane. Let\'s count the distances from this point to the given n points. Let\'s sort these numbers in the non-decreasing order. We\'ll call the beauty of the point the second element of this array. If there are two mimimum elements in this array, the beaty will be equal to this minimum.Find the maximum beauty of a point inside the given rectangle." 3100.0     
                                           439E "Devu and Birthday Celebration" combinatorics,dp,math "Today is Devu\'s birthday. For celebrating the occasion, he bought n sweets from the nearby market. He has invited his f friends. He would like to distribute the sweets among them. As he is a nice guy and the occasion is great, he doesn\'t want any friend to be sad, so he would ensure to give at least one sweet to each friend. He wants to celebrate it in a unique style, so he would like to ensure following condition for the distribution of sweets. Assume that he has distributed n sweets to his friends such that ith friend is given ai sweets. He wants to make sure that there should not be any positive integer x\xe2\x80\x89>\xe2\x80\x891, which divides every ai.Please find the number of ways he can distribute sweets to his friends in the required way. Note that the order of distribution is important, for example [1, 2] and [2, 1] are distinct distributions. As the answer could be very large, output answer modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).To make the problem more interesting, you are given q queries. Each query contains an n, f pair. For each query please output the required number of ways modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2100.0     
                                           436B "Om Nom and Spiders" implementation,math "Om Nom really likes candies and doesn\'t like spiders as they frequently steal candies. One day Om Nom fancied a walk in a park. Unfortunately, the park has some spiders and Om Nom doesn\'t want to see them at all.  The park can be represented as a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m field. The park has k spiders, each spider at time 0 is at some cell of the field. The spiders move all the time, and each spider always moves in one of the four directions (left, right, down, up). In a unit of time, a spider crawls from his cell to the side-adjacent cell in the corresponding direction. If there is no cell in the given direction, then the spider leaves the park. The spiders do not interfere with each other as they move. Specifically, one cell can have multiple spiders at the same time.Om Nom isn\'t yet sure where to start his walk from but he definitely wants:  to start walking at time 0 at an upper row cell of the field (it is guaranteed that the cells in this row do not contain any spiders);  to walk by moving down the field towards the lowest row (the walk ends when Om Nom leaves the boundaries of the park). We know that Om Nom moves by jumping. One jump takes one time unit and transports the little monster from his cell to either a side-adjacent cell on the lower row or outside the park boundaries.Each time Om Nom lands in a cell he sees all the spiders that have come to that cell at this moment of time. Om Nom wants to choose the optimal cell to start the walk from. That\'s why he wonders: for each possible starting cell, how many spiders will he see during the walk if he starts from this cell? Help him and calculate the required value for each possible starting cell." 1400.0     
                                           435C Cardiogram implementation "In this problem, your task is to use ASCII graphics to paint a cardiogram. A cardiogram is a polyline with the following corners:That is, a cardiogram is fully defined by a sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.Your task is to paint a cardiogram by given sequence ai." 1600.0     
                                           434D "Nanami\'s Power Plant" flows "Nanami likes playing games, and is also really good at it. This day she was playing a new game which involved operating a power plant. Nanami\'s job is to control the generators in the plant and produce maximum output.There are n generators in the plant. Each generator should be set to a generating level. Generating level is an integer (possibly zero or negative), the generating level of the i-th generator should be between li and ri (both inclusive). The output of a generator can be calculated using a certain quadratic function f(x), where x is the generating level of the generator. Each generator has its own function, the function of the i-th generator is denoted as fi(x).However, there are m further restrictions to the generators. Let the generating level of the i-th generator be xi. Each restriction is of the form xu\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xv\xe2\x80\x89+\xe2\x80\x89d, where u and v are IDs of two different generators and d is an integer.Nanami found the game tedious but giving up is against her creed. So she decided to have a program written to calculate the answer for her (the maximum total output of generators). Somehow, this became your job." 2900.0     
                                           433C "Ryouko\'s Memory Note" implementation,math,sortings "Ryouko is an extremely forgetful girl, she could even forget something that has just happened. So in order to remember, she takes a notebook with her, called Ryouko\'s Memory Note. She writes what she sees and what she hears on the notebook, and the notebook became her memory.Though Ryouko is forgetful, she is also born with superb analyzing abilities. However, analyzing depends greatly on gathered information, in other words, memory. So she has to shuffle through her notebook whenever she needs to analyze, which is tough work.Ryouko\'s notebook consists of n pages, numbered from 1 to n. To make life (and this problem) easier, we consider that to turn from page x to page y, |x\xe2\x80\x89-\xe2\x80\x89y| pages should be turned. During analyzing, Ryouko needs m pieces of information, the i-th piece of information is on page ai. Information must be read from the notebook in order, so the total number of pages that Ryouko needs to turn is .Ryouko wants to decrease the number of pages that need to be turned. In order to achieve this, she can merge two pages of her notebook. If Ryouko merges page x to page y, she would copy all the information on page x to y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), and consequently, all elements in sequence a that was x would become y. Note that x can be equal to y, in which case no changes take place.Please tell Ryouko the minimum number of pages that she needs to turn. Note she can apply the described operation at most once before the reading. Note that the answer can exceed 32-bit integers." 1800.0     
                                           432E "Square Tiling" "constructive algorithms,greedy" "You have an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle table, its cells are not initially painted. Your task is to paint all cells of the table. The resulting picture should be a tiling of the table with squares. More formally:  each cell must be painted some color (the colors are marked by uppercase Latin letters);  we will assume that two cells of the table are connected if they are of the same color and share a side; each connected region of the table must form a square. Given n and m, find lexicographically minimum coloring of the table that meets the described properties." 2300.0     
                                           432C "Prime Swaps" greedy,sortings "You have an array a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n], containing distinct integers from 1 to n. Your task is to sort this array in increasing order with the following operation (you may need to apply it multiple times):  choose two indexes, i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; (j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) is a prime number);  swap the elements on positions i and j; in other words, you are allowed to apply the following sequence of assignments: tmp\xe2\x80\x89=\xe2\x80\x89a[i],\xe2\x80\x89a[i]\xe2\x80\x89=\xe2\x80\x89a[j],\xe2\x80\x89a[j]\xe2\x80\x89=\xe2\x80\x89tmp (tmp is a temporary variable). You do not need to minimize the number of used operations. However, you need to make sure that there are at most 5n operations." 1800.0     
                                           429E "Points and Segments" graphs "Iahub isn\'t well prepared on geometry problems, but he heard that this year there will be a lot of geometry problems on the IOI selection camp. Scared, Iahub locked himself in the basement and started thinking of new problems of this kind. One of them is the following.Iahub wants to draw n distinct segments [li,\xe2\x80\x89ri] on the OX axis. He can draw each segment with either red or blue. The drawing is good if and only if the following requirement is met: for each point x of the OX axis consider all the segments that contains point x; suppose, that rx red segments and bx blue segments contain point x; for each point x inequality |rx\xe2\x80\x89-\xe2\x80\x89bx|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 must be satisfied.A segment [l,\xe2\x80\x89r] contains a point x if and only if l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r.Iahub gives you the starting and ending points of all the segments. You have to find any good drawing for him." 3000.0     
                                           425A "Sereja and Swaps" "brute force,sortings" "As usual, Sereja has array a, its elements are integers: a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n]. Let\'s introduce notation:A swap operation is the following sequence of actions:  choose two indexes i,\xe2\x80\x89j (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j);  perform assignments tmp\xe2\x80\x89=\xe2\x80\x89a[i],\xe2\x80\x89a[i]\xe2\x80\x89=\xe2\x80\x89a[j],\xe2\x80\x89a[j]\xe2\x80\x89=\xe2\x80\x89tmp. What maximum value of function m(a) can Sereja get if he is allowed to perform at most k swap operations?" 1500.0     
                                           421A "Pasha and Hamsters" "constructive algorithms,implementation" "Pasha has two hamsters: Arthur and Alexander. Pasha put n apples in front of them. Pasha knows which apples Arthur likes. Similarly, Pasha knows which apples Alexander likes. Pasha doesn\'t want any conflict between the hamsters (as they may like the same apple), so he decided to distribute the apples between the hamsters on his own. He is going to give some apples to Arthur and some apples to Alexander. It doesn\'t matter how many apples each hamster gets but it is important that each hamster gets only the apples he likes. It is possible that somebody doesn\'t get any apples.Help Pasha distribute all the apples between the hamsters. Note that Pasha wants to distribute all the apples, not just some of them." 800.0     
                                           420E "Playing the ball" geometry "A coder cannot sit and code all day. Sometimes it is a good idea to rise from the desk, have a rest, have small talk with colleagues and even play. The coders of the F company have their favorite ball game.Let\'s imagine the game on the plane with a cartesian coordinate system. The point (0, 0) contains the player who chooses an arbitrary direction and throws a ball in that direction. The ball hits the plane at distance d from the player\'s original position and continues flying in the same direction. After the ball hits the plane for the first time, it flies on and hits the plane again at distance 2\xc2\xb7d from the player\'s original position and so on (it continue flying in the chosen direction and hitting the plane after each d units). All coders in the F company are strong, so the ball flies infinitely far away.The plane has n circles painted on it. If a ball hits the plane and hits a circle that is painted on the plane (including its border), then the player gets one point. The ball can hit multiple circles at once and get one point for each of them (if the ball hits some circle x times during the move, the player also gets x points). Count the maximum number of points a player can get if he throws a ball in the arbitrary direction. Note that the direction may have real cooridinates." 2600.0     
                                           415A "Mashmokh and Lights" implementation "Mashmokh works in a factory. At the end of each day he must turn off all of the lights. The lights on the factory are indexed from 1 to n. There are n buttons in Mashmokh\'s room indexed from 1 to n as well. If Mashmokh pushes button with index i, then each light with index not less than i that is still turned on turns off.Mashmokh is not very clever. So instead of pushing the first button he pushes some of the buttons randomly each night. He pushed m distinct buttons b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm (the buttons were pushed consecutively in the given order) this night. Now he wants to know for each light the index of the button that turned this light off. Please note that the index of button bi is actually bi, not i.Please, help Mashmokh, print these indices." 900.0     
                                           413D 2048 bitmasks,dp "The programmers from the R2 company love playing 2048. One day, they decided to invent their own simplified version of this game \xe2\x80\x94 2k on a stripe.Imagine an infinite in one direction stripe, consisting of unit squares (the side of each square is equal to the height of the stripe). Each square can either be empty or contain some number.Initially, all squares are empty. Then at infinity one of the unit squares number 2 or 4 appears. Then the player presses a button once, and the appeared number begins to move towards the beginning of the stripe. Let\'s assume that some number x moves to the beginning of the stripe, then it will stop if:  it either gets in the first square of the stripe;  or it is in the square that is preceded by a square with number y (y\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x). But if number x at some point of time gets to the square with the same number then both numbers add to each other and result in 2x. The new number 2x continues moving to the beginning of the stripe by the same rules. After the final stop of the number moving process, the infinity gets a new number 2 or 4 and the process repeats. Read the notes to the test samples to better understand the moving strategy.I guess you\'ve understood that the game progress fully depends on the order in which numbers 2 and 4 appear. Let\'s look at some sequence of numbers 2 and 4 in the game. We assume that the sequence is winning if it results in at least one square getting the number greater or equal than 2k. The goal of the game is to make up a winning sequence of n numbers. But not everything is so simple, some numbers in the sequence are identified beforehand. You are given a sequence consisting of numbers 0, 2, 4. Count how many ways there are to replace each 0 of the sequence with 2 or 4 to get a winning sequence." 2000.0     
                                           413B "Spyke Chatting" implementation "The R2 company has n employees working for it. The work involves constant exchange of ideas, sharing the stories of success and upcoming challenging. For that, R2 uses a famous instant messaging program Spyke.R2 has m Spyke chats just to discuss all sorts of issues. In each chat, some group of employees exchanges messages daily. An employee can simultaneously talk in multiple chats. If some employee is in the k-th chat, he can write messages to this chat and receive notifications about messages from this chat. If an employee writes a message in the chat, all other participants of the chat receive a message notification.The R2 company is conducting an audit. Now the specialists study effective communication between the employees. For this purpose, they have a chat log and the description of chat structure. You, as one of audit specialists, are commissioned to write a program that will use this data to determine the total number of message notifications received by each employee." 1300.0     
                                           413A "Data Recovery" implementation "Not so long ago company R2 bought company R1 and consequently, all its developments in the field of multicore processors. Now the R2 laboratory is testing one of the R1 processors.The testing goes in n steps, at each step the processor gets some instructions, and then its temperature is measured. The head engineer in R2 is keeping a report record on the work of the processor: he writes down the minimum and the maximum measured temperature in his notebook. His assistant had to write down all temperatures into his notebook, but (for unknown reasons) he recorded only m.The next day, the engineer\'s assistant filed in a report with all the m temperatures. However, the chief engineer doubts that the assistant wrote down everything correctly (naturally, the chief engineer doesn\'t doubt his notes). So he asked you to help him. Given numbers n, m, min, max and the list of m temperatures determine whether you can upgrade the set of m temperatures to the set of n temperatures (that is add n\xe2\x80\x89-\xe2\x80\x89m temperatures), so that the minimum temperature was min and the maximum one was max." 1200.0     
                                           409E Dome "*special problem"  1800.0     
                                           406D "Hill Climbing" "dfs and similar,geometry,trees" "This problem has nothing to do with Little Chris. It is about hill climbers instead (and Chris definitely isn\'t one).There are n hills arranged on a line, each in the form of a vertical line segment with one endpoint on the ground. The hills are numbered with numbers from 1 to n from left to right. The i-th hill stands at position xi with its top at height yi. For every two hills a and b, if the top of hill a can be seen from the top of hill b, their tops are connected by a rope. Formally, the tops of two hills are connected if the segment connecting their top points does not intersect or touch any of the other hill segments. Using these ropes, the hill climbers can move from hill to hill.There are m teams of climbers, each composed of exactly two members. The first and the second climbers of the i-th team are located at the top of the ai-th and bi-th hills, respectively. They want to meet together at the top of some hill. Now, each of two climbers move according to the following process:  if a climber is at the top of the hill where the other climber is already located or will come eventually, the former climber stays at this hill;  otherwise, the climber picks a hill to the right of his current hill that is reachable by a rope and is the rightmost possible, climbs this hill and continues the process (the climber can also climb a hill whose top is lower than the top of his current hill).   For each team of climbers, determine the number of the meeting hill for this pair!" 2200.0     
                                           405E "Graph Cutting" "dfs and similar,graphs" "Little Chris is participating in a graph cutting contest. He\'s a pro. The time has come to test his skills to the fullest.Chris is given a simple undirected connected graph with n vertices (numbered from 1 to n) and m edges. The problem is to cut it into edge-distinct paths of length 2. Formally, Chris has to partition all edges of the graph into pairs in such a way that the edges in a single pair are adjacent and each edge must be contained in exactly one pair.For example, the figure shows a way Chris can cut a graph. The first sample test contains the description of this graph.  You are given a chance to compete with Chris. Find a way to cut the given graph or determine that it is impossible!" 2300.0     
                                           405C "Unusual Product" implementation,math "Little Chris is a huge fan of linear algebra. This time he has been given a homework about the unusual square of a square matrix.The dot product of two integer number vectors x and y of size n is the sum of the products of the corresponding components of the vectors. The unusual square of an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square matrix A is defined as the sum of n dot products. The i-th of them is the dot product of the i-th row vector and the i-th column vector in the matrix A.Fortunately for Chris, he has to work only in GF(2)! This means that all operations (addition, multiplication) are calculated modulo 2. In fact, the matrix A is binary: each element of A is either 0 or 1. For example, consider the following matrix A:  The unusual square of A is equal to (1\xc2\xb71\xe2\x80\x89+\xe2\x80\x891\xc2\xb70\xe2\x80\x89+\xe2\x80\x891\xc2\xb71)\xe2\x80\x89+\xe2\x80\x89(0\xc2\xb71\xe2\x80\x89+\xe2\x80\x891\xc2\xb71\xe2\x80\x89+\xe2\x80\x891\xc2\xb70)\xe2\x80\x89+\xe2\x80\x89(1\xc2\xb71\xe2\x80\x89+\xe2\x80\x890\xc2\xb71\xe2\x80\x89+\xe2\x80\x890\xc2\xb70)\xe2\x80\x89=\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x890.However, there is much more to the homework. Chris has to process q queries; each query can be one of the following:   given a row index i, flip all the values in the i-th row in A;  given a column index i, flip all the values in the i-th column in A;  find the unusual square of A. To flip a bit value w means to change it to 1\xe2\x80\x89-\xe2\x80\x89w, i.e., 1 changes to 0 and 0 changes to 1.Given the initial matrix A, output the answers for each query of the third type! Can you solve Chris\'s homework?" 1600.0     
                                           405A "Gravity Flip" greedy,implementation,sortings "Little Chris is bored during his physics lessons (too easy), so he has built a toy box to keep himself occupied. The box is special, since it has the ability to change gravity.There are n columns of toy cubes in the box arranged in a line. The i-th column contains ai cubes. At first, the gravity in the box is pulling the cubes downwards. When Chris switches the gravity, it begins to pull all the cubes to the right side of the box. The figure shows the initial and final configurations of the cubes in the box: the cubes that have changed their position are highlighted with orange.  Given the initial configuration of the toy cubes in the box, find the amounts of cubes in each of the n columns after the gravity switch!" 900.0     
                                           402D "Upgrading Array" "dp,greedy,math,number theory" "You have an array of positive integers a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n] and a set of bad prime numbers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. The prime numbers that do not occur in the set b are considered good. The beauty of array a is the sum , where function f(s) is determined as follows:  f(1)\xe2\x80\x89=\xe2\x80\x890;  Let\'s assume that p is the minimum prime divisor of s. If p is a good prime, then , otherwise . You are allowed to perform an arbitrary (probably zero) number of operations to improve array a. The operation of improvement is the following sequence of actions:  Choose some number r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and calculate the value g = GCD(a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[r]).  Apply the assignments: , , ..., . What is the maximum beauty of the array you can get?" 1800.0     
                                           402B "Trees in a Row" "brute force,implementation" "The Queen of England has n trees growing in a row in her garden. At that, the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) tree from the left has height ai meters. Today the Queen decided to update the scenery of her garden. She wants the trees\' heights to meet the condition: for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89=\xe2\x80\x89k, where k is the number the Queen chose.Unfortunately, the royal gardener is not a machine and he cannot fulfill the desire of the Queen instantly! In one minute, the gardener can either decrease the height of a tree to any positive integer height or increase the height of a tree to any positive integer height. How should the royal gardener act to fulfill a whim of Her Majesty in the minimum number of minutes?" 1400.0     
                                           401A "Vanya and Cards" implementation,math "Vanya loves playing. He even has a special set of cards to play with. Each card has a single integer. The number on the card can be positive, negative and can even be equal to zero. The only limit is, the number on each card doesn\'t exceed x in the absolute value.Natasha doesn\'t like when Vanya spends a long time playing, so she hid all of his cards. Vanya became sad and started looking for the cards but he only found n of them. Vanya loves the balance, so he wants the sum of all numbers on found cards equal to zero. On the other hand, he got very tired of looking for cards. Help the boy and say what is the minimum number of cards does he need to find to make the sum equal to zero?You can assume that initially Vanya had infinitely many cards with each integer number from \xe2\x80\x89-\xe2\x80\x89x to x." 800.0     
                                           397A "On Segment\'s Own Points" implementation "Our old friend Alexey has finally entered the University of City N \xe2\x80\x94 the Berland capital. Alexey expected his father to get him a place to live in but his father said it was high time for Alexey to practice some financial independence. So, Alexey is living in a dorm. The dorm has exactly one straight dryer \xe2\x80\x94 a 100 centimeter long rope to hang clothes on. The dryer has got a coordinate system installed: the leftmost end of the dryer has coordinate 0, and the opposite end has coordinate 100. Overall, the university has n students. Dean\'s office allows i-th student to use the segment (li,\xe2\x80\x89ri) of the dryer. However, the dean\'s office actions are contradictory and now one part of the dryer can belong to multiple students!Alexey don\'t like when someone touch his clothes. That\'s why he want make it impossible to someone clothes touch his ones. So Alexey wonders: what is the total length of the parts of the dryer that he may use in a such way that clothes of the others (n\xe2\x80\x89-\xe2\x80\x891) students aren\'t drying there. Help him! Note that Alexey, as the most respected student, has number 1." -999.0     
                                           392C "Yet Another Number Sequence" combinatorics,math,matrices "Everyone knows what the Fibonacci sequence is. This sequence can be defined by the recurrence relation: F1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89F2\xe2\x80\x89=\xe2\x80\x892,\xe2\x80\x89Fi\xe2\x80\x89=\xe2\x80\x89Fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89Fi\xe2\x80\x89-\xe2\x80\x892 (i\xe2\x80\x89>\xe2\x80\x892).We\'ll define a new number sequence Ai(k) by the formula: Ai(k)\xe2\x80\x89=\xe2\x80\x89Fi\xe2\x80\x89\xc3\x97\xe2\x80\x89ik (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891).In this problem, your task is to calculate the following sum: A1(k)\xe2\x80\x89+\xe2\x80\x89A2(k)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89An(k). The answer can be very large, so print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." -999.0     
                                           391F2 "Stock Trading" greedy "This problem consists of three subproblems: for solving subproblem F1 you will receive 8 points, for solving subproblem F2 you will receive 15 points, and for solving subproblem F3 you will receive 10 points.Manao has developed a model to predict the stock price of a company over the next n days and wants to design a profit-maximizing trading algorithm to make use of these predictions. Unfortunately, Manao\'s trading account has the following restrictions:   It only allows owning either zero or one shares of stock at a time;  It only allows buying or selling a share of this stock once per day;  It allows a maximum of k buy orders over the next n days; For the purposes of this problem, we define a trade to a be the act of buying one share of stock on day i, then holding the stock until some day j\xe2\x80\x89>\xe2\x80\x89i at which point the share is sold. To restate the above constraints, Manao is permitted to make at most k non-overlapping trades during the course of an n-day trading period for which Manao\'s model has predictions about the stock price.Even though these restrictions limit the amount of profit Manao can make compared to what would be achievable with an unlimited number of trades or the ability to hold more than one share at a time, Manao still has the potential to make a lot of money because Manao\'s model perfectly predicts the daily price of the stock. For example, using this model, Manao could wait until the price is low, then buy one share and hold until the price reaches a high value, then sell for a profit, and repeat this process up to k times until n days have passed.Nevertheless, Manao is not satisfied by having a merely good trading algorithm, and wants to develop an optimal strategy for trading subject to these constraints. Help Manao achieve this goal by writing a program that will determine when to buy and sell stock to achieve the greatest possible profit during the n-day trading period subject to the above constraints." -999.0     
                                           391D1 Supercollider "brute force" "This problem consists of two subproblems: for solving subproblem D1 you will receive 3 points, and for solving subproblem D2 you will receive 16 points.Manao is the chief architect involved in planning a new supercollider. He has to identify a plot of land where the largest possible supercollider can be built. The supercollider he is building requires four-way orthogonal collisions of particles traveling at the same speed, so it will consist of four accelerating chambers and be shaped like a plus sign (i.e., +). Each of the four accelerating chambers must be the same length and must be aligned with the Earth\'s magnetic field (parallel or orthogonal) to minimize interference.The accelerating chambers need to be laid down across long flat stretches of land to keep costs under control. Thus, Manao has already commissioned a topographical study that has identified all possible maximal length tracts of land available for building accelerating chambers that are either parallel or orthogonal to the Earth\'s magnetic field. To build the largest possible supercollider, Manao must identify the largest symmetric plus shape from among these candidate tracts. That is, he must find the two tracts of land that form an axis-aligned plus shape with the largest distance from the center of the plus to the tip of the shortest of the four arms of the plus. Note that the collider need not use the entire length of the tracts identified (see the example in the notes)." -999.0     
                                           388E "Fox and Meteor Shower" geometry "There is a meteor shower on the sky and there are n meteors. The sky can be viewed as a 2D Euclid Plane and the meteor is point on this plane. Fox Ciel looks at the sky. She finds out that the orbit of each meteor is a straight line, and each meteor has a constant velocity. Now Ciel wants to know: what is the maximum number of meteors such that any pair met at the same position at a certain time? Note that the time is not limited and can be also negative. The meteors will never collide when they appear at the same position at the same time." 3100.0     
                                           387D "George and Interesting Graph" "graph matchings" "George loves graphs. Most of all, he loves interesting graphs. We will assume that a directed graph is interesting, if it meets the following criteria:   The graph doesn\'t contain any multiple arcs;  There is vertex v (we\'ll call her the center), such that for any vertex of graph u, the graph contains arcs (u,\xe2\x80\x89v) and (v,\xe2\x80\x89u). Please note that the graph also contains loop (v,\xe2\x80\x89v).  The outdegree of all vertexes except for the center equals two and the indegree of all vertexes except for the center equals two. The outdegree of vertex u is the number of arcs that go out of u, the indegree of vertex u is the number of arcs that go in u. Please note that the graph can contain loops. However, not everything\'s that simple. George got a directed graph of n vertices and m arcs as a present. The graph didn\'t have any multiple arcs. As George loves interesting graphs, he wants to slightly alter the presented graph and transform it into an interesting one. In one alteration he can either remove an arbitrary existing arc from the graph or add an arbitrary arc to the graph. George wonders: what is the minimum number of changes that he needs to obtain an interesting graph from the graph he\'s got as a present? Help George and find the answer to the question." 2200.0     
                                           387C "George and Number" greedy,implementation "George is a cat, so he really likes to play. Most of all he likes to play with his array of positive integers b. During the game, George modifies the array by using special changes. Let\'s mark George\'s current array as b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89b|b| (record |b| denotes the current length of the array). Then one change is a sequence of actions:   Choose two distinct indexes i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|b|; i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j), such that bi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89bj.  Get number v\xe2\x80\x89=\xe2\x80\x89concat(bi,\xe2\x80\x89bj), where concat(x,\xe2\x80\x89y) is a number obtained by adding number y to the end of the decimal record of number x. For example, concat(500,\xe2\x80\x8910)\xe2\x80\x89=\xe2\x80\x8950010, concat(2,\xe2\x80\x892)\xe2\x80\x89=\xe2\x80\x8922.  Add number v to the end of the array. The length of the array will increase by one.  Remove from the array numbers with indexes i and j. The length of the array will decrease by two, and elements of the array will become re-numbered from 1 to current length of the array. George played for a long time with his array b and received from array b an array consisting of exactly one number p. Now George wants to know: what is the maximum number of elements array b could contain originally? Help him find this number. Note that originally the array could contain only positive integers." 1700.0     
                                           386B "Fly, freebies, fly!" "binary search,brute force,implementation" "Everyone loves a freebie. Especially students.It is well-known that if in the night before exam a student opens window, opens the student\'s record-book and shouts loudly three times ""Fly, freebie, fly!"" \xe2\x80\x94 then flown freebie helps him to pass the upcoming exam.In the night before the exam on mathematical analysis n students living in dormitory shouted treasured words. The i-th student made a sacrament at the time ti, where ti is the number of seconds elapsed since the beginning of the night.It is known that the freebie is a capricious and willful lady. That night the freebie was near dormitory only for T seconds. Therefore, if for two students their sacrament times differ for more than T, then the freebie didn\'t visit at least one of them.Since all students are optimists, they really want to know what is the maximal number of students visited by the freebie can be." 1400.0     
                                           383E Vowels "combinatorics,divide and conquer,dp" "Iahubina is tired of so many complicated languages, so she decided to invent a new, simple language. She already made a dictionary consisting of n 3-words. A 3-word is a sequence of exactly 3 lowercase letters of the first 24 letters of the English alphabet (a to x). She decided that some of the letters are vowels, and all the others are consonants. The whole language is based on a simple rule: any word that contains at least one vowel is correct.Iahubina forgot which letters are the vowels, and wants to find some possible correct sets of vowels. She asks Iahub questions. In each question, she will give Iahub a set of letters considered vowels (in this question). For each question she wants to know how many words of the dictionary are correct, considering the given set of vowels.Iahubina wants to know the xor of the squared answers to all the possible questions. There are 224 different questions, they are all subsets of the set of the first 24 letters of the English alphabet. Help Iahub find that number." 2700.0     
                                           382E "Ksenia and Combinatorics" combinatorics,dp "Ksenia has her winter exams. Today she is learning combinatorics. Here\'s one of the problems she needs to learn to solve.How many distinct trees are there consisting of n vertices, each with the following properties:  the tree is marked, that is, the vertices of the tree are numbered from 1 to n;  each vertex of the tree is connected with at most three other vertices, and at the same moment the vertex with number 1 is connected with at most two other vertices;  the size of the tree\'s maximum matching equals k. Two trees are considered distinct if there are such two vertices u and v, that in one tree they are connected by an edge and in the other tree they are not.Help Ksenia solve the problem for the given n and k. As the answer to the problem can be very huge you should output it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2600.0     
                                           380E "Sereja and Dividing" "data structures" "Let\'s assume that we have a sequence of doubles a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89a|a| and a double variable x. You are allowed to perform the following two-staged operation:  choose an index of the sequence element i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|a|);  consecutively perform assignments: . Let\'s use function g(a,\xe2\x80\x89x) to represent the largest value that can be obtained from variable x, using the described operation any number of times and sequence a.Sereja has sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89b|b|. Help Sereja calculate sum: . Record [bi,\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89bj] represents a sequence containing the elements in brackets in the given order. To avoid problems with precision, please, print the required sum divided by |b|2." 2600.0     
                                           380C "Sereja and Brackets" "data structures,schedules" "Sereja has a bracket sequence s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn, or, in other words, a string s of length n, consisting of characters ""("" and "")"".Sereja needs to answer m queries, each of them is described by two integers li,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The answer to the i-th query is the length of the maximum correct bracket subsequence of sequence sli,\xe2\x80\x89sli\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sri. Help Sereja answer all queries.You can find the definitions for a subsequence and a correct bracket sequence in the notes." 2000.0     
                                           378A "Playing with Dice" "brute force" "Two players are playing a game. First each of them writes an integer from 1 to 6, and then a dice is thrown. The player whose written number got closer to the number on the dice wins. If both payers have the same difference, it\'s a draw.The first player wrote number a, the second player wrote number b. How many ways to throw a dice are there, at which the first player wins, or there is a draw, or the second player wins?" 800.0     
                                           375D "Tree and Queries" "data structures,dfs and similar,trees" "You have a rooted tree consisting of n vertices. Each vertex of the tree has some color. We will assume that the tree vertices are numbered by integers from 1 to n. Then we represent the color of vertex v as cv. The tree root is a vertex with number 1.In this problem you need to answer to m queries. Each query is described by two integers vj,\xe2\x80\x89kj. The answer to query vj,\xe2\x80\x89kj is the number of such colors of vertices x, that the subtree of vertex vj contains at least kj vertices of color x.You can find the definition of a rooted tree by the following link: http://en.wikipedia.org/wiki/Tree_(graph_theory)." 2400.0     
                                           374D "Inna and Sequence" "binary search,data structures,dp,trees" "Dima\'s spent much time thinking what present to give to Inna and gave her an empty sequence w. Now they want to fill sequence w with numbers zero and one. For that, they decided to play an amusing game. Before the game begins, Dima chooses m integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89am). Then Inna and Dima start playing, that is, adding numbers to sequence w. Each new number they choose is added to the end of the sequence. At some moments of time Dima feels that the game is going to end too soon (and he wants to play with Inna as long as possible), so he hits a table hard with his fist. At that the a1-th, a2-th, a3-th, ..., ak-th numbers from the beginning simultaneously fall out of the sequence (the sequence gets k numbers less). Here k is such maximum number that value ak doesn\'t exceed the current length of the sequence. If number a1 is larger than the current length of w, then nothing falls out of the sequence.You are given the chronological sequence of events in the game. Each event is either adding a number to the end of sequence w or Dima\'s hit on the table. Calculate the sequence w after all these events happen." 2000.0     
                                           374A "Inna and Pink Pony" greedy,implementation "Dima and Inna are doing so great! At the moment, Inna is sitting on the magic lawn playing with a pink pony. Dima wanted to play too. He brought an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m chessboard, a very tasty candy and two numbers a and b.Dima put the chessboard in front of Inna and placed the candy in position (i,\xe2\x80\x89j) on the board. The boy said he would give the candy if it reaches one of the corner cells of the board. He\'s got one more condition. There can only be actions of the following types:  move the candy from position (x,\xe2\x80\x89y) on the board to position (x\xe2\x80\x89-\xe2\x80\x89a,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89b);  move the candy from position (x,\xe2\x80\x89y) on the board to position (x\xe2\x80\x89+\xe2\x80\x89a,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89b);  move the candy from position (x,\xe2\x80\x89y) on the board to position (x\xe2\x80\x89-\xe2\x80\x89a,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89b);  move the candy from position (x,\xe2\x80\x89y) on the board to position (x\xe2\x80\x89+\xe2\x80\x89a,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89b). Naturally, Dima doesn\'t allow to move the candy beyond the chessboard borders.Inna and the pony started shifting the candy around the board. They wonder what is the minimum number of allowed actions that they need to perform to move the candy from the initial position (i,\xe2\x80\x89j) to one of the chessboard corners. Help them cope with the task!" 2000.0     
                                           372B "Counting Rectangles is Fun" "brute force,divide and conquer,dp" "There is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular grid, each cell of the grid contains a single integer: zero or one. Let\'s call the cell on the i-th row and the j-th column as (i,\xe2\x80\x89j).Let\'s define a ""rectangle"" as four integers a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Rectangle denotes a set of cells of the grid {(x,\xe2\x80\x89y) :\xe2\x80\x89 a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c,\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d}. Let\'s define a ""good rectangle"" as a rectangle that includes only the cells with zeros.You should answer the following q queries: calculate the number of good rectangles all of which cells are in the given rectangle." 1900.0     
                                           371B "Fox Dividing Cheese" "math,number theory" "Two little greedy bears have found two pieces of cheese in the forest of weight a and b grams, correspondingly. The bears are so greedy that they are ready to fight for the larger piece. That\'s where the fox comes in and starts the dialog: ""Little bears, wait a little, I want to make your pieces equal"" ""Come off it fox, how are you going to do that?"", the curious bears asked. ""It\'s easy"", said the fox. ""If the mass of a certain piece is divisible by two, then I can eat exactly a half of the piece. If the mass of a certain piece is divisible by three, then I can eat exactly two-thirds, and if the mass is divisible by five, then I can eat four-fifths. I\'ll eat a little here and there and make the pieces equal"". The little bears realize that the fox\'s proposal contains a catch. But at the same time they realize that they can not make the two pieces equal themselves. So they agreed to her proposal, but on one condition: the fox should make the pieces equal as quickly as possible. Find the minimum number of operations the fox needs to make pieces equal." 1300.0     
                                           370B "Berland Bingo" implementation "Lately, a national version of a bingo game has become very popular in Berland. There are n players playing the game, each player has a card with numbers. The numbers on each card are distinct, but distinct cards can have equal numbers. The card of the i-th player contains mi numbers.During the game the host takes numbered balls one by one from a bag. He reads the number aloud in a high and clear voice and then puts the ball away. All participants cross out the number if it occurs on their cards. The person who crosses out all numbers from his card first, wins. If multiple people cross out all numbers from their cards at the same time, there are no winners in the game. At the beginning of the game the bag contains 100 balls numbered 1 through 100, the numbers of all balls are distinct.You are given the cards for each player. Write a program that determines whether a player can win the game at the most favorable for him scenario or not." 1300.0     
                                           368B "Sereja and Suffixes" "data structures,dp" "Sereja has an array a, consisting of n integers a1, a2, ..., an. The boy cannot sit and do nothing, he decided to study an array. Sereja took a piece of paper and wrote out m integers l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lm (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). For each number li he wants to know how many distinct numbers are staying on the positions li, li\xe2\x80\x89+\xe2\x80\x891, ..., n. Formally, he want to find the number of distinct numbers among ali,\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89an.?Sereja wrote out the necessary array elements but the array was so large and the boy was so pressed for time. Help him, find the answer for the described question for each li." 1100.0     
                                           366B "Dima and To-do List" "brute force,implementation" "You helped Dima to have a great weekend, but it\'s time to work. Naturally, Dima, as all other men who have girlfriends, does everything wrong.Inna and Dima are now in one room. Inna tells Dima off for everything he does in her presence. After Inna tells him off for something, she goes to another room, walks there in circles muttering about how useless her sweetheart is. During that time Dima has time to peacefully complete k\xe2\x80\x89-\xe2\x80\x891 tasks. Then Inna returns and tells Dima off for the next task he does in her presence and goes to another room again. It continues until Dima is through with his tasks.Overall, Dima has n tasks to do, each task has a unique number from 1 to n. Dima loves order, so he does tasks consecutively, starting from some task. For example, if Dima has 6 tasks to do in total, then, if he starts from the 5-th task, the order is like that: first Dima does the 5-th task, then the 6-th one, then the 1-st one, then the 2-nd one, then the 3-rd one, then the 4-th one.Inna tells Dima off (only lovingly and appropriately!) so often and systematically that he\'s very well learned the power with which she tells him off for each task. Help Dima choose the first task so that in total he gets told off with as little power as possible." 1200.0     
                                           363E "Two Circles" "brute force,data structures,implementation" "Let\'s assume that we are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table filled by integers. We\'ll mark a cell in the i-th row and j-th column as (i,\xe2\x80\x89j). Thus, (1,\xe2\x80\x891) is the upper left cell of the table and (n,\xe2\x80\x89m) is the lower right cell. We\'ll assume that a circle of radius r with the center in cell (i0,\xe2\x80\x89j0) is a set of such cells (i,\xe2\x80\x89j) that . We\'ll consider only the circles that do not go beyond the limits of the table, that is, for which r\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89r and r\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x89r.    A circle of radius 3 with the center at (4,\xe2\x80\x895). Find two such non-intersecting circles of the given radius r that the sum of numbers in the cells that belong to these circles is maximum. Two circles intersect if there is a cell that belongs to both circles. As there can be more than one way to choose a pair of circles with the maximum sum, we will also be interested in the number of such pairs. Calculate the number of unordered pairs of circles, for instance, a pair of circles of radius 2 with centers at (3,\xe2\x80\x894) and (7,\xe2\x80\x897) is the same pair as the pair of circles of radius 2 with centers at (7,\xe2\x80\x897) and (3,\xe2\x80\x894)." 2500.0     
                                           362A "Two Semiknights Meet" greedy,math "A boy Petya loves chess very much. He even came up with a chess piece of his own, a semiknight. The semiknight can move in any of these four directions: 2 squares forward and 2 squares to the right, 2 squares forward and 2 squares to the left, 2 squares backward and 2 to the right and 2 squares backward and 2 to the left. Naturally, the semiknight cannot move beyond the limits of the chessboard.Petya put two semiknights on a standard chessboard. Petya simultaneously moves with both semiknights. The squares are rather large, so after some move the semiknights can meet, that is, they can end up in the same square. After the meeting the semiknights can move on, so it is possible that they meet again. Petya wonders if there is such sequence of moves when the semiknights meet. Petya considers some squares bad. That is, they do not suit for the meeting. The semiknights can move through these squares but their meetings in these squares don\'t count.Petya prepared multiple chess boards. Help Petya find out whether the semiknights can meet on some good square for each board.Please see the test case analysis." 1500.0     
                                           361A "Levko and Table" "constructive algorithms,implementation" "Levko loves tables that consist of n rows and n columns very much. He especially loves beautiful tables. A table is beautiful to Levko if the sum of elements in each row and column of the table equals k.Unfortunately, he doesn\'t know any such table. Your task is to help him to find at least one of them." 800.0     
                                           356E "Xenia and String Problem" "dp,hashing,implementation,string suffix structures,strings" "Xenia the coder went to The Olympiad of Informatics and got a string problem. Unfortunately, Xenia isn\'t fabulous in string algorithms. Help her solve the problem.String s is a sequence of characters s1s2... s|s|, where record |s| shows the length of the string. Substring s[i... j] of string s is string sisi\xe2\x80\x89+\xe2\x80\x891... sj.String s is a Gray string, if it meets the conditions:  the length of string |s| is odd;  character  occurs exactly once in the string;  either |s|\xe2\x80\x89=\xe2\x80\x891, or substrings  and  are the same and are Gray strings. For example, strings ""abacaba"", ""xzx"", ""g"" are Gray strings and strings ""aaa"", ""xz"", ""abaxcbc"" are not.The beauty of string p is the sum of the squares of the lengths of all substrings of string p that are Gray strings. In other words, consider all pairs of values i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|). If substring p[i... j] is a Gray string, you should add (j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891)2 to the beauty.Xenia has got string t consisting of lowercase English letters. She is allowed to replace at most one letter of the string by any other English letter. The task is to get a string of maximum beauty." 3000.0     
                                           356B "Xenia and Hamming" implementation,math "Xenia is an amateur programmer. Today on the IT lesson she learned about the Hamming distance.The Hamming distance between two strings s\xe2\x80\x89=\xe2\x80\x89s1s2... sn and t\xe2\x80\x89=\xe2\x80\x89t1t2... tn of equal length n is value . Record [si\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ti] is the Iverson notation and represents the following: if si\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ti, it is one, otherwise \xe2\x80\x94 zero.Now Xenia wants to calculate the Hamming distance between two long strings a and b. The first string a is the concatenation of n copies of string x, that is, . The second string b is the concatenation of m copies of string y. Help Xenia, calculate the required Hamming distance, given n,\xe2\x80\x89x,\xe2\x80\x89m,\xe2\x80\x89y." 1900.0     
                                           353D Queue "constructive algorithms,dp" "There are n schoolchildren, boys and girls, lined up in the school canteen in front of the bun stall. The buns aren\'t ready yet and the line is undergoing some changes.Each second all boys that stand right in front of girls, simultaneously swap places with the girls (so that the girls could go closer to the beginning of the line). In other words, if at some time the i-th position has a boy and the (i\xe2\x80\x89+\xe2\x80\x891)-th position has a girl, then in a second, the i-th position will have a girl and the (i\xe2\x80\x89+\xe2\x80\x891)-th one will have a boy.Let\'s take an example of a line of four people: a boy, a boy, a girl, a girl (from the beginning to the end of the line). Next second the line will look like that: a boy, a girl, a boy, a girl. Next second it will be a girl, a boy, a girl, a boy. Next second it will be a girl, a girl, a boy, a boy. The line won\'t change any more.Your task is: given the arrangement of the children in the line to determine the time needed to move all girls in front of boys (in the example above it takes 3 seconds). Baking buns takes a lot of time, so no one leaves the line until the line stops changing." 2000.0     
                                           351B "Jeff and Furik" combinatorics,dp,probabilities "Jeff has become friends with Furik. Now these two are going to play one quite amusing game.At the beginning of the game Jeff takes a piece of paper and writes down a permutation consisting of n numbers: p1, p2, ..., pn. Then the guys take turns to make moves, Jeff moves first. During his move, Jeff chooses two adjacent permutation elements and then the boy swaps them. During his move, Furic tosses a coin and if the coin shows ""heads"" he chooses a random pair of adjacent elements with indexes i and i\xe2\x80\x89+\xe2\x80\x891, for which an inequality pi\xe2\x80\x89>\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891 holds, and swaps them. But if the coin shows ""tails"", Furik chooses a random pair of adjacent elements with indexes i and i\xe2\x80\x89+\xe2\x80\x891, for which the inequality pi\xe2\x80\x89<\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891 holds, and swaps them. If the coin shows ""heads"" or ""tails"" and Furik has multiple ways of adjacent pairs to take, then he uniformly takes one of the pairs. If Furik doesn\'t have any pair to take, he tosses a coin one more time. The game ends when the permutation is sorted in the increasing order.Jeff wants the game to finish as quickly as possible (that is, he wants both players to make as few moves as possible). Help Jeff find the minimum mathematical expectation of the number of moves in the game if he moves optimally well.You can consider that the coin shows the heads (or tails) with the probability of 50 percent." 1900.0     
                                           350A TL "brute force,greedy,implementation" "Valera wanted to prepare a Codesecrof round. He\'s already got one problem and he wants to set a time limit (TL) on it.Valera has written n correct solutions. For each correct solution, he knows its running time (in seconds). Valera has also wrote m wrong solutions and for each wrong solution he knows its running time (in seconds).Let\'s suppose that Valera will set v seconds TL in the problem. Then we can say that a solution passes the system testing if its running time is at most v seconds. We can also say that a solution passes the system testing with some ""extra"" time if for its running time, a seconds, an inequality 2a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v holds.As a result, Valera decided to set v seconds TL, that the following conditions are met:  v is a positive integer;  all correct solutions pass the system testing;  at least one correct solution passes the system testing with some ""extra"" time;  all wrong solutions do not pass the system testing;  value v is minimum among all TLs, for which points 1, 2, 3, 4 hold. Help Valera and find the most suitable TL or else state that such TL doesn\'t exist." 1200.0     
                                           348C "Subset Sums" "brute force,data structures" "You are given an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and m sets S1,\xe2\x80\x89S2,\xe2\x80\x89...,\xe2\x80\x89Sm of indices of elements of this array. Let\'s denote Sk\xe2\x80\x89=\xe2\x80\x89{Sk,\xe2\x80\x89i} (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|Sk|). In other words, Sk,\xe2\x80\x89i is some element from set Sk.In this problem you have to answer q queries of the two types:  Find the sum of elements with indices from set Sk: . The query format is ""? k"".  Add number x to all elements at indices from set Sk: aSk,\xe2\x80\x89i is replaced by aSk,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x89x for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|Sk|). The query format is ""+ k x"". After each first type query print the required sum." 2500.0     
                                           348B "Apple Tree" "dfs and similar,number theory,trees" "You are given a rooted tree with n vertices. In each leaf vertex there\'s a single integer \xe2\x80\x94 the number of apples in this vertex. The weight of a subtree is the sum of all numbers in this subtree leaves. For instance, the weight of a subtree that corresponds to some leaf is the number written in the leaf.A tree is balanced if for every vertex v of the tree all its subtrees, corresponding to the children of vertex v, are of equal weight. Count the minimum number of apples that you need to remove from the tree (specifically, from some of its leaves) in order to make the tree balanced. Notice that you can always achieve the goal by just removing all apples." 2100.0     
                                           346B "Lucky Common Subsequence" dp,strings "In mathematics, a subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements. For example, the sequence BDF is a subsequence of ABCDEF. A substring of a string is a continuous subsequence of the string. For example, BCD is a substring of ABCDEF.You are given two strings s1, s2 and another string called virus. Your task is to find the longest common subsequence of s1 and s2, such that it doesn\'t contain virus as a substring." 2000.0     
                                           345C "Counting Fridays" "*special problem" "Judging from the previous problem, Friday the 13th really doesn\'t treat you well, so you start thinking about how to minimize its impact on your life. You are a passionate participant of programming contests, so various competitions are an important part of your schedule. Naturally, you\'d like as few of them to be spoiled as possible.A friendly admin leaked to you the list of dates on which the contests will be held for several years ahead. Check how many of them happen to take place on Friday the 13th of any month." 2000.0     
                                           343D "Water Tree" "data structures,dfs and similar,graphs,trees" "Mad scientist Mike has constructed a rooted tree, which consists of n vertices. Each vertex is a reservoir which can be either empty or filled with water.The vertices of the tree are numbered from 1 to n with the root at vertex 1. For each vertex, the reservoirs of its children are located below the reservoir of this vertex, and the vertex is connected with each of the children by a pipe through which water can flow downwards.Mike wants to do the following operations with the tree:   Fill vertex v with water. Then v and all its children are filled with water.  Empty vertex v. Then v and all its ancestors are emptied.  Determine whether vertex v is filled with water at the moment.  Initially all vertices of the tree are empty.Mike has already compiled a full list of operations that he wants to perform in order. Before experimenting with the tree Mike decided to run the list through a simulation. Help Mike determine what results will he get after performing all the operations." 2100.0     
                                           343C "Read Time" "binary search,greedy,two pointers" "Mad scientist Mike does not use slow hard disks. His modification of a hard drive has not one, but n different heads that can read data in parallel.When viewed from the side, Mike\'s hard drive is an endless array of tracks. The tracks of the array are numbered from left to right with integers, starting with 1. In the initial state the i-th reading head is above the track number hi. For each of the reading heads, the hard drive\'s firmware can move the head exactly one track to the right or to the left, or leave it on the current track. During the operation each head\'s movement does not affect the movement of the other heads: the heads can change their relative order; there can be multiple reading heads above any of the tracks. A track is considered read if at least one head has visited this track. In particular, all of the tracks numbered h1, h2, ..., hn have been read at the beginning of the operation.  Mike needs to read the data on m distinct tracks with numbers p1, p2, ..., pm. Determine the minimum time the hard drive firmware needs to move the heads and read all the given tracks. Note that an arbitrary number of other tracks can also be read." 1900.0     
                                           342E "Xenia and Tree" "data structures,divide and conquer,trees" "Xenia the programmer has a tree consisting of n nodes. We will consider the tree nodes indexed from 1 to n. We will also consider the first node to be initially painted red, and the other nodes \xe2\x80\x94 to be painted blue.The distance between two tree nodes v and u is the number of edges in the shortest path between v and u.Xenia needs to learn how to quickly execute queries of two types:  paint a specified blue node in red;  calculate which red node is the closest to the given one and print the shortest distance to the closest red node. Your task is to write a program which will execute the described queries." 2400.0     
                                           336C "Vasily the Bear and Sequence" "brute force,greedy,implementation,number theory" "Vasily the bear has got a sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Vasily the Bear wants to write out several numbers on a piece of paper so that the beauty of the numbers he wrote out was maximum. The beauty of the written out numbers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk is such maximum non-negative integer v, that number b1 and b2 and ... and bk is divisible by number 2v without a remainder. If such number v doesn\'t exist (that is, for any non-negative integer v, number b1 and b2 and ... and bk is divisible by 2v without a remainder), the beauty of the written out numbers equals -1. Tell the bear which numbers he should write out so that the beauty of the written out numbers is maximum. If there are multiple ways to write out the numbers, you need to choose the one where the bear writes out as many numbers as possible.Here expression x and y means applying the bitwise AND operation to numbers x and y. In programming languages C++ and Java this operation is represented by ""&"", in Pascal \xe2\x80\x94 by ""and""." 1800.0     
                                           336B "Vasily the Bear and Fly" math "One beautiful day Vasily the bear painted 2m circles of the same radius R on a coordinate plane. Circles with numbers from 1 to m had centers at points (2R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x890), (4R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x890), ..., (2Rm\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x890), respectively. Circles with numbers from m\xe2\x80\x89+\xe2\x80\x891 to 2m had centers at points (2R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x892R), (4R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x892R), ..., (2Rm\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x892R), respectively. Naturally, the bear painted the circles for a simple experiment with a fly. The experiment continued for m2 days. Each day of the experiment got its own unique number from 0 to m2\xe2\x80\x89-\xe2\x80\x891, inclusive. On the day number i the following things happened:   The fly arrived at the coordinate plane at the center of the circle with number  ( is the result of dividing number x by number y, rounded down to an integer).  The fly went along the coordinate plane to the center of the circle number  ( is the remainder after dividing number x by number y). The bear noticed that the fly went from the center of circle v to the center of circle u along the shortest path with all points lying on the border or inside at least one of the 2m circles. After the fly reached the center of circle u, it flew away in an unknown direction. Help Vasily, count the average distance the fly went along the coordinate plane during each of these m2 days." 1900.0     
                                           335D "Rectangles and Square" "brute force,dp" "You are given n rectangles, labeled 1 through n. The corners of rectangles have integer coordinates and their edges are parallel to the Ox and Oy axes. The rectangles may touch each other, but they do not overlap (that is, there are no points that belong to the interior of more than one rectangle).Your task is to determine if there\'s a non-empty subset of the rectangles that forms a square. That is, determine if there exists a subset of the rectangles and some square for which every point that belongs to the interior or the border of that square belongs to the interior or the border of at least one of the rectangles in the subset, and every point that belongs to the interior or the border of at least one rectangle in the subset belongs to the interior or the border of that square." 2400.0     
                                           335B Palindrome "constructive algorithms,dp" "Given a string s, determine if it contains any palindrome of length exactly 100 as a subsequence. If it has any, print any one of them. If it doesn\'t have any, print a palindrome that is a subsequence of s and is as long as possible." 1900.0     
                                           334A "Candy Bags" implementation "Gerald has n younger brothers and their number happens to be even. One day he bought n2 candy bags. One bag has one candy, one bag has two candies, one bag has three candies and so on. In fact, for each integer k from 1 to n2 he has exactly one bag with k candies. Help him give n bags of candies to each brother so that all brothers got the same number of candies." 1000.0     
                                           333E "Summer Earnings" "binary search,bitmasks,brute force,geometry,sortings" "Many schoolchildren look for a job for the summer, and one day, when Gerald was still a schoolboy, he also decided to work in the summer. But as Gerald was quite an unusual schoolboy, he found quite unusual work. A certain Company agreed to pay him a certain sum of money if he draws them three identical circles on a plane. The circles must not interfere with each other (but they may touch each other). He can choose the centers of the circles only from the n options granted by the Company. He is free to choose the radius of the circles himself (all three radiuses must be equal), but please note that the larger the radius is, the more he gets paid. Help Gerald earn as much as possible." 2500.0     
                                           325E "The Red Button" "combinatorics,dfs and similar,dsu,graphs,greedy" "Piegirl found the red button. You have one last chance to change the inevitable end.The circuit under the button consists of n nodes, numbered from 0 to n - 1. In order to deactivate the button, the n nodes must be disarmed in a particular order. Node 0 must be disarmed first. After disarming node i, the next node to be disarmed must be either node (2\xc2\xb7i) modulo n or node (2\xc2\xb7i)\xe2\x80\x89+\xe2\x80\x891 modulo n. The last node to be disarmed must be node 0. Node 0 must be disarmed twice, but all other nodes must be disarmed exactly once. Your task is to find any such order and print it. If there is no such order, print -1." 2800.0     
                                           325A "Square and Rectangles" implementation "You are given n rectangles. The corners of rectangles have integer coordinates and their edges are parallel to the Ox and Oy axes. The rectangles may touch each other, but they do not overlap (that is, there are no points that belong to the interior of more than one rectangle). Your task is to determine if the rectangles form a square. In other words, determine if the set of points inside or on the border of at least one rectangle is precisely equal to the set of points inside or on the border of some square." 1500.0     
                                           321D "Ciel and Flipboard" dp,greedy,math "Fox Ciel has a board with n rows and n columns, there is one integer in each cell.It\'s known that n is an odd number, so let\'s introduce . Fox Ciel can do the following operation many times: she choose a sub-board with size x rows and x columns, then all numbers in it will be multiplied by -1.Return the maximal sum of numbers in the board that she can get by these operations." 2900.0     
                                           316A1 "Special Task" greedy "Special Agent Smart Beaver works in a secret research department of ABBYY. He\'s been working there for a long time and is satisfied with his job, as it allows him to eat out in the best restaurants and order the most expensive and exotic wood types there. The content special agent has got an important task: to get the latest research by British scientists on the English Language. These developments are encoded and stored in a large safe. The Beaver\'s teeth are strong enough, so the authorities assured that upon arriving at the place the beaver won\'t have any problems with opening the safe.And he finishes his aspen sprig and leaves for this important task. Of course, the Beaver arrived at the location without any problems, but alas. He can\'t open the safe with his strong and big teeth. At this point, the Smart Beaver get a call from the headquarters and learns that opening the safe with the teeth is not necessary, as a reliable source has sent the following information: the safe code consists of digits and has no leading zeroes. There also is a special hint, which can be used to open the safe. The hint is string s with the following structure:  if si = ""?"", then the digit that goes i-th in the safe code can be anything (between 0 to 9, inclusively);  if si is a digit (between 0 to 9, inclusively), then it means that there is digit si on position i in code;  if the string contains letters from ""A"" to ""J"", then all positions with the same letters must contain the same digits and the positions with distinct letters must contain distinct digits.  The length of the safe code coincides with the length of the hint. For example, hint ""?JGJ9"" has such matching safe code variants: ""51919"", ""55959"", ""12329"", ""93539"" and so on, and has wrong variants such as: ""56669"", ""00111"", ""03539"" and ""13666"".After receiving such information, the authorities change the plan and ask the special agents to work quietly and gently and not to try to open the safe by mechanical means, and try to find the password using the given hint.At a special agent school the Smart Beaver was the fastest in his platoon finding codes for such safes, but now he is not in that shape: the years take their toll ... Help him to determine the number of possible variants of the code to the safe, matching the given hint. After receiving this information, and knowing his own speed of entering codes, the Smart Beaver will be able to determine whether he will have time for tonight\'s show ""Beavers are on the trail"" on his favorite TV channel, or he should work for a sleepless night..." 1100.0     
                                           313E "Ilya and Two Numbers" "constructive algorithms,data structures,dsu,greedy" "Ilya has recently taken up archaeology. He\'s recently found two numbers, written in the m-based notation. Each of the found numbers consisted of exactly n digits. Ilya immediately started looking for information about those numbers. He learned that the numbers are part of a cyphered code and the one who can decypher it can get the greatest treasure.After considerable research Ilya understood that to decypher the code, he should do the following:  Rearrange digits in the first number in some manner. Similarly, rearrange digits in the second number in some manner. As a result of this operation, the numbers can get leading zeroes.  Add numbers, digit by digit, modulo m. In other words, we need to get the third number of length n, each digit of the number is the sum of the respective numbers of the found numbers. For example, suppose there are two numbers recorded in the ternary notation, 001210 and 012111, then if you add them to each other digit by digit modulo 3, you will get number 010021.  The key to the code is the maximum possible number that can be obtained in the previous step. Help Ilya, find the key to the code." 2300.0     
                                           306B Optimizer "data structures,greedy,sortings" "A process RAM is a sequence of bytes that are indexed from 1 to n. Polycarpus\'s program contains such instructions as ""memset"", that is, the operations of filling memory cells on a segment with some value. The details are: the code only contains m instructions that look like ""set13 a_i l_i"". Instruction i fills a continuous memory segment of length li, starting from cell number ai, (that it cells with numbers ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89li\xe2\x80\x89-\xe2\x80\x891) with values 13.In Polycarpus\'s code, the optimizer\'s task is to remove the maximum number of instructions from his code in such a way that the remaining instructions set value 13 in all the memory bytes that got this value from the code before the optimization. Also, the value 13 should be set only in the memory bytes that got this value from the code before the optimization. Your task is to implement the optimizer for such program." 2100.0     
                                           305E "Playing with String" games "Two people play the following string game. Initially the players have got some string s. The players move in turns, the player who cannot make a move loses. Before the game began, the string is written on a piece of paper, one letter per cell.  An example of the initial situation at s = ""abacaba"" A player\'s move is the sequence of actions:  The player chooses one of the available pieces of paper with some string written on it. Let\'s denote it is t. Note that initially, only one piece of paper is available.  The player chooses in the string t\xe2\x80\x89=\xe2\x80\x89t1t2... t|t| character in position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|t|) such that for some positive integer l (0\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89-\xe2\x80\x89l; i\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|t|) the following equations hold: ti\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891, ti\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x892, ..., ti\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89=\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x89l.  Player cuts the cell with the chosen character. As a result of the operation, he gets three new pieces of paper, the first one will contain string t1t2... ti\xe2\x80\x89-\xe2\x80\x891, the second one will contain a string consisting of a single character ti, the third one contains string ti\xe2\x80\x89+\xe2\x80\x891ti\xe2\x80\x89+\xe2\x80\x892... t|t|.   An example of making action (i\xe2\x80\x89=\xe2\x80\x894) with string s = \xc2\xababacaba\xc2\xbb Your task is to determine the winner provided that both players play optimally well. If the first player wins, find the position of character that is optimal to cut in his first move. If there are multiple positions, print the minimal possible one." 2300.0     
                                           301A "Yaroslav and Sequence" "constructive algorithms" "Yaroslav has an array, consisting of (2\xc2\xb7n\xe2\x80\x89-\xe2\x80\x891) integers. In a single operation Yaroslav can change the sign of exactly n elements in the array. In other words, in one operation Yaroslav can select exactly n array elements, and multiply each of them by -1.Yaroslav is now wondering: what maximum sum of array elements can be obtained if it is allowed to perform any number of described operations?Help Yaroslav." 1800.0     
                                           298B Sail "brute force,greedy,implementation" "The polar bears are going fishing. They plan to sail from (sx,\xe2\x80\x89sy) to (ex,\xe2\x80\x89ey). However, the boat can only sail by wind. At each second, the wind blows in one of these directions: east, south, west or north. Assume the boat is currently at (x,\xe2\x80\x89y).  If the wind blows to the east, the boat will move to (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y).  If the wind blows to the south, the boat will move to (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891).  If the wind blows to the west, the boat will move to (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y).  If the wind blows to the north, the boat will move to (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891). Alternatively, they can hold the boat by the anchor. In this case, the boat stays at (x,\xe2\x80\x89y). Given the wind direction for t seconds, what is the earliest time they sail to (ex,\xe2\x80\x89ey)?" 1200.0     
                                           295B "Greg and Graph" "dp,graphs,shortest paths" "Greg has a weighed directed graph, consisting of n vertices. In this graph any pair of distinct vertices has an edge between them in both directions. Greg loves playing with the graph and now he has invented a new game:  The game consists of n steps.  On the i-th step Greg removes vertex number xi from the graph. As Greg removes a vertex, he also removes all the edges that go in and out of this vertex.  Before executing each step, Greg wants to know the sum of lengths of the shortest paths between all pairs of the remaining vertices. The shortest path can go through any remaining vertex. In other words, if we assume that d(i,\xe2\x80\x89v,\xe2\x80\x89u) is the shortest path between vertices v and u in the graph that formed before deleting vertex xi, then Greg wants to know the value of the following sum: . Help Greg, print the value of the required sum before each step." 1700.0     
                                           295A "Greg and Array" "data structures,implementation" "Greg has an array a\xe2\x80\x89=\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and m operations. Each operation looks as: li, ri, di, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). To apply operation i to the array means to increase all array elements with numbers li,\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ri by value di.Greg wrote down k queries on a piece of paper. Each query has the following form: xi, yi, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). That means that one should apply operations with numbers xi,\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89yi to the array.Now Greg is wondering, what the array a will be after all the queries are executed. Help Greg." 1400.0     
                                           292C "Beautiful IP Addresses" "brute force" "The problem uses a simplified TCP/IP address model, please read the statement carefully.An IP address is a 32-bit integer, represented as a group of four decimal 8-bit integers (without leading zeroes), separated by commas. For example, record 0.255.1.123 shows a correct IP address and records 0.256.1.123 and 0.255.1.01 do not. In the given problem an arbitrary group of four 8-bit integers is a correct IP address.Our hero Polycarpus still works as a system administrator in some large corporation. He likes beautiful IP addresses. To check if some IP address is beautiful, he should do the following:  write out in a line four 8-bit numbers of the IP address, without the commas;  check if the resulting string is a palindrome. Let us remind you that a palindrome is a string that reads the same from right to left and from left to right.For example, IP addresses 12.102.20.121 and 0.3.14.130 are beautiful (as strings ""1210220121"" and ""0314130"" are palindromes), and IP addresses 1.20.20.1 and 100.4.4.1 are not.Polycarpus wants to find all beautiful IP addresses that have the given set of digits. Each digit from the set must occur in the IP address at least once. IP address must not contain any other digits. Help him to cope with this difficult task." 2000.0     
                                           292A SMSC implementation "Some large corporation where Polycarpus works has its own short message service center (SMSC). The center\'s task is to send all sorts of crucial information. Polycarpus decided to check the efficiency of the SMSC. For that, he asked to give him the statistics of the performance of the SMSC for some period of time. In the end, Polycarpus got a list of n tasks that went to the SMSC of the corporation. Each task was described by the time it was received by the SMSC and the number of text messages to send. More formally, the i-th task was described by two integers ti and ci \xe2\x80\x94 the receiving time (the second) and the number of the text messages, correspondingly.Polycarpus knows that the SMSC cannot send more than one text message per second. The SMSC uses a queue to organize its work. Consider a time moment x, the SMSC work at that moment as follows:  If at the time moment x the queue is not empty, then SMSC sends one message from the queue (SMSC gets the message from the head of the queue). Otherwise it doesn\'t send messages at the time moment x.  If at the time moment x SMSC receives a task, then it adds to the queue all the messages from this task (SMSC adds messages to the tail of the queue). Note, that the messages from the task cannot be send at time moment x. That\'s because the decision about sending message or not is made at point 1 before adding these messages to the queue. Given the information about all n tasks, Polycarpus wants to count two values: the time when the last text message was sent and the maximum size of the queue at some time. Help him count these two characteristics he needs to evaluate the efficiency of the SMSC." 1100.0     
                                           290A "Mysterious strings" "*special problem,implementation" "InputThe input contains a single integer a (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8940).OutputOutput a single string.ExamplesInputCopy2OutputCopyAdamsInputCopy8OutputCopyVan BurenInputCopy29OutputCopyHarding" 1400.0     
                                           286B Shifting implementation "John Doe has found the beautiful permutation formula.Let\'s take permutation p\xe2\x80\x89=\xe2\x80\x89p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. Let\'s define transformation f of this permutation: where k (k\xe2\x80\x89>\xe2\x80\x891) is an integer, the transformation parameter, r is such maximum integer that rk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. If rk\xe2\x80\x89=\xe2\x80\x89n, then elements prk\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89prk\xe2\x80\x89+\xe2\x80\x892 and so on are omitted. In other words, the described transformation of permutation p cyclically shifts to the left each consecutive block of length k and the last block with the length equal to the remainder after dividing n by k. John Doe thinks that permutation f(f( ... f(p\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n],\xe2\x80\x892) ... ,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891),\xe2\x80\x89n) is beautiful. Unfortunately, he cannot quickly find the beautiful permutation he\'s interested in. That\'s why he asked you to help him.Your task is to find a beautiful permutation for the given n. For clarifications, see the notes to the third sample." 2200.0     
                                           284A "Cows and Primitive Roots" "implementation,math,number theory" "The cows have just learned what a primitive root is! Given a prime p, a primitive root  is an integer x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89p) such that none of integers x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89x2\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89xp\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x891 are divisible by p, but xp\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x891 is. Unfortunately, computing primitive roots can be time consuming, so the cows need your help. Given a prime p, help the cows find the number of primitive roots ." 1400.0     
                                           283B "Cow Program" "dfs and similar,dp,graphs" "Farmer John has just given the cows a program to play with! The program contains two integer variables, x and y, and performs the following operations on a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of positive integers:  Initially, x\xe2\x80\x89=\xe2\x80\x891 and y\xe2\x80\x89=\xe2\x80\x890. If, after any step, x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x890 or x\xe2\x80\x89>\xe2\x80\x89n, the program immediately terminates.  The program increases both x and y by a value equal to ax simultaneously.  The program now increases y by ax while decreasing x by ax.  The program executes steps 2 and 3 (first step 2, then step 3) repeatedly until it terminates (it may never terminate). So, the sequence of executed steps may start with: step 2, step 3, step 2, step 3, step 2 and so on. The cows are not very good at arithmetic though, and they want to see how the program works. Please help them!You are given the sequence a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89an. Suppose for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) we run the program on the sequence i,\xe2\x80\x89a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89an. For each such run output the final value of y if the program terminates or -1 if it does not terminate." 1700.0     
                                           282A Bit++ implementation "The classic programming language of Bitland is Bit++. This language is so peculiar and complicated.The language is that peculiar as it has exactly one variable, called x. Also, there are two operations:  Operation ++ increases the value of variable x by 1.  Operation -- decreases the value of variable x by 1. A statement in language Bit++ is a sequence, consisting of exactly one operation and one variable x. The statement is written without spaces, that is, it can only contain characters ""+"", ""-"", ""X"". Executing a statement means applying the operation it contains.A programme in Bit++ is a sequence of statements, each of them needs to be executed. Executing a programme means executing all the statements it contains.You\'re given a programme in language Bit++. The initial value of x is 0. Execute the programme and find its final value (the value of the variable when this programme is executed)." 800.0     
                                           279C Ladder "dp,implementation,two pointers" "You\'ve got an array, consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Also, you\'ve got m queries, the i-th query is described by two integers li,\xe2\x80\x89ri. Numbers li,\xe2\x80\x89ri define a subsegment of the original array, that is, the sequence of numbers ali,\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89ari. For each query you should check whether the corresponding segment is a ladder. A ladder is a sequence of integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk, such that it first doesn\'t decrease, then doesn\'t increase. In other words, there is such integer x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), that the following inequation fulfills: b1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bx\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89bx\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89bx\xe2\x80\x89+\xe2\x80\x892...\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89bk. Note that the non-decreasing and the non-increasing sequences are also considered ladders." 1700.0     
                                           275B "Convex Shape" "constructive algorithms,implementation" "Consider an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid. Initially all the cells of the grid are colored white. Lenny has painted some of the cells (at least one) black. We call a painted grid convex if one can walk from any black cell to any another black cell using a path of side-adjacent black cells changing his direction at most once during the path. In the figure below, the left grid is convex while the right one is not convex, because there exist two cells which need more than one time to change direction in their path.  You\'re given a painted grid in the input. Tell Lenny if the grid is convex or not." 1700.0     
                                           274E "Mirror Room" "data structures,implementation" "Imagine an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid with some blocked cells. The top left cell in the grid has coordinates (1,\xe2\x80\x891) and the bottom right cell has coordinates (n,\xe2\x80\x89m). There are k blocked cells in the grid and others are empty. You flash a laser beam from the center of an empty cell (xs,\xe2\x80\x89ys) in one of the diagonal directions (i.e. north-east, north-west, south-east or south-west). If the beam hits a blocked cell or the border of the grid it will reflect. The behavior of the beam reflection in different situations is depicted in the figure below.   After a while the beam enters an infinite cycle. Count the number of empty cells that the beam goes through at least once. We consider that the beam goes through cell if it goes through its center." 3000.0     
                                           272D "Dima and Two Sequences" combinatorics,math,sortings "Little Dima has two sequences of points with integer coordinates: sequence (a1,\xe2\x80\x891),\xe2\x80\x89(a2,\xe2\x80\x892),\xe2\x80\x89...,\xe2\x80\x89(an,\xe2\x80\x89n) and sequence (b1,\xe2\x80\x891),\xe2\x80\x89(b2,\xe2\x80\x892),\xe2\x80\x89...,\xe2\x80\x89(bn,\xe2\x80\x89n).Now Dima wants to count the number of distinct sequences of points of length 2\xc2\xb7n that can be assembled from these sequences, such that the x-coordinates of points in the assembled sequence will not decrease. Help him with that. Note that each element of the initial sequences should be used exactly once in the assembled sequence.Dima considers two assembled sequences (p1,\xe2\x80\x89q1),\xe2\x80\x89(p2,\xe2\x80\x89q2),\xe2\x80\x89...,\xe2\x80\x89(p2\xc2\xb7n,\xe2\x80\x89q2\xc2\xb7n) and (x1,\xe2\x80\x89y1),\xe2\x80\x89(x2,\xe2\x80\x89y2),\xe2\x80\x89...,\xe2\x80\x89(x2\xc2\xb7n,\xe2\x80\x89y2\xc2\xb7n) distinct, if there is such i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7n), that (pi,\xe2\x80\x89qi)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89(xi,\xe2\x80\x89yi).As the answer can be rather large, print the remainder from dividing the answer by number m." 1600.0     
                                           271D "Good Substrings" "data structures,strings" "You\'ve got string s, consisting of small English letters. Some of the English letters are good, the rest are bad.A substring s[l...r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89s1s2...s|s| (where |s| is the length of string s) is string \xe2\x80\x89slsl\xe2\x80\x89+\xe2\x80\x891...sr.The substring s[l...r] is good, if among the letters \xe2\x80\x89sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr there are at most k bad ones (look at the sample\'s explanation to understand it more clear).Your task is to find the number of distinct good substrings of the given string s. Two substrings s[x...y] and s[p...q] are considered distinct if their content is different, i.e. s[x...y]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s[p...q]." 1800.0     
                                           268A Games "brute force" "Manao works on a sports TV. He\'s spent much time watching the football games of some country. After a while he began to notice different patterns. For example, each team has two sets of uniforms: home uniform and guest uniform. When a team plays a game at home, the players put on the home uniform. When a team plays as a guest on somebody else\'s stadium, the players put on the guest uniform. The only exception to that rule is: when the home uniform color of the host team matches the guests\' uniform, the host team puts on its guest uniform as well. For each team the color of the home and guest uniform is different.There are n teams taking part in the national championship. The championship consists of n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x891) games: each team invites each other team to its stadium. At this point Manao wondered: how many times during the championship is a host team going to put on the guest uniform? Note that the order of the games does not affect this number.You know the colors of the home and guest uniform for each team. For simplicity, the colors are numbered by integers in such a way that no two distinct colors have the same number. Help Manao find the answer to his question." 800.0     
                                           267B Dominoes "dfs and similar,graphs" "You have a set of dominoes. Each domino is a rectangular tile with a line dividing its face into two square ends. Can you put all dominoes in a line one by one from left to right so that any two dominoes touched with the sides that had the same number of points? You can rotate the dominoes, changing the left and the right side (domino ""1-4"" turns into ""4-1"")." 2000.0     
                                           266E "More Queries to Array..." "data structures,math" "You\'ve got an array, consisting of n integers: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to quickly run the queries of two types: Assign value x to all elements from l to r inclusive. After such query the values of the elements of array al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar become equal to x. Calculate and print sum , where k doesn\'t exceed 5. As the value of the sum can be rather large, you should print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2500.0     
                                           266A "Stones on the Table" implementation "There are n stones on the table in a row, each of them can be red, green or blue. Count the minimum number of stones to take from the table so that any two neighboring stones had different colors. Stones in a row are considered neighboring if there are no other stones between them." 800.0     
                                           261E "Maxim and Calculator" "brute force,dp,two pointers" "Maxim has got a calculator. The calculator has two integer cells. Initially, the first cell contains number 1, and the second cell contains number 0. In one move you can perform one of the following operations:  Let\'s assume that at the current time the first cell contains number a, and the second cell contains number b. Write to the second cell number b\xe2\x80\x89+\xe2\x80\x891;  Let\'s assume that at the current time the first cell contains number a, and the second cell contains number b. Write to the first cell number a\xc2\xb7b. Maxim is wondering, how many integers x (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are there, such that we can write the number x to the first cell of the calculator, having performed at most p moves." 2800.0     
                                           261C "Maxim and Matrix" "constructive algorithms,dp,math" "Maxim loves to fill in a matrix in a special manner. Here is a pseudocode of filling in a matrix of size (m\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89\xc3\x97\xe2\x80\x89(m\xe2\x80\x89+\xe2\x80\x891):Maxim asks you to count, how many numbers m (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) are there, such that the sum of values in the cells in the row number m\xe2\x80\x89+\xe2\x80\x891 of the resulting matrix equals t.Expression (x xor y) means applying the operation of bitwise excluding ""OR"" to numbers x and y. The given operation exists in all modern programming languages. For example, in languages C++ and Java it is represented by character ""^"", in Pascal \xe2\x80\x94 by ""xor""." 2000.0     
                                           260D "Black and White Tree" "constructive algorithms,dsu,graphs,greedy,trees" "The board has got a painted tree graph, consisting of n nodes. Let us remind you that a non-directed graph is called a tree if it is connected and doesn\'t contain any cycles.Each node of the graph is painted black or white in such a manner that there aren\'t two nodes of the same color, connected by an edge. Each edge contains its value written on it as a non-negative integer.A bad boy Vasya came up to the board and wrote number sv near each node v \xe2\x80\x94 the sum of values of all edges that are incident to this node. Then Vasya removed the edges and their values from the board.Your task is to restore the original tree by the node colors and numbers sv." 2100.0     
                                           258E "Little Elephant and Tree" "data structures,dfs and similar,trees" "The Little Elephant loves trees very much, he especially loves root trees.He\'s got a tree consisting of n nodes (the nodes are numbered from 1 to n), with root at node number 1. Each node of the tree contains some list of numbers which initially is empty. The Little Elephant wants to apply m operations. On the i-th operation (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) he first adds number i to lists of all nodes of a subtree with the root in node number ai, and then he adds number i to lists of all nodes of the subtree with root in node bi.After applying all operations the Little Elephant wants to count for each node i number ci \xe2\x80\x94 the number of integers j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; j\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i), such that the lists of the i-th and the j-th nodes contain at least one common number.Help the Little Elephant, count numbers ci for him." 2400.0     
                                           255B "Code Parsing" implementation "Little Vitaly loves different algorithms. Today he has invented a new algorithm just for you. Vitaly\'s algorithm works with string s, consisting of characters ""x"" and ""y"", and uses two following operations at runtime:  Find two consecutive characters in the string, such that the first of them equals ""y"", and the second one equals ""x"" and swap them. If there are several suitable pairs of characters, we choose the pair of characters that is located closer to the beginning of the string.  Find in the string two consecutive characters, such that the first of them equals ""x"" and the second one equals ""y"". Remove these characters from the string. If there are several suitable pairs of characters, we choose the pair of characters that is located closer to the beginning of the string. The input for the new algorithm is string s, and the algorithm works as follows:  If you can apply at least one of the described operations to the string, go to step 2 of the algorithm. Otherwise, stop executing the algorithm and print the current string.  If you can apply operation 1, then apply it. Otherwise, apply operation 2. After you apply the operation, go to step 1 of the algorithm. Now Vitaly wonders, what is going to be printed as the result of the algorithm\'s work, if the input receives string s." 1200.0     
                                           254E Dormitory dp,implementation "Student Vasya came to study in Berland State University from the country, so he is living in a dormitory. A semester has n days, and in each of those days his parents send him some food. In the morning of the i-th day he receives ai kilograms of food that can be eaten on that day and on the next one (then the food goes bad and becomes unfit for consumption).Every day Vasya eats v kilograms of food. It is known that Vasya\'s parents do not allow him to starve, so there always is enough food for Vasya. Vasya has m friends who sometimes live with him. Let\'s index the friends from 1 to m. Friend number j lives with Vasya from day lj to day rj, inclusive. Also, the j-th friend requires fj kilograms of food per day. Usually Vasya\'s friends eat in the canteen, but sometimes generous Vasya feeds some of them. Every day Vasya can feed some friends who live with him this day (or may feed nobody).Every time Vasya feeds his friend, he gives him as much food as the friend needs for the day, and Vasya\'s popularity rating at the University increases by one. Vasya cannot feed the same friend multiple times in one day. In addition, he knows that eating habits must be regular, so he always eats v kilograms of food per day.Vasya wants so choose whom he will feed each day of the semester to make his rating as high as possible. Originally Vasya\'s rating is 0 because he is a freshman." 2100.0     
                                           254C Anagram greedy,strings "String x is an anagram of string y, if we can rearrange the letters in string x and get exact string y. For example, strings ""DOG"" and ""GOD"" are anagrams, so are strings ""BABA"" and ""AABB"", but strings ""ABBAC"" and ""CAABA"" are not.You are given two strings s and t of the same length, consisting of uppercase English letters. You need to get the anagram of string t from string s. You are permitted to perform the replacing operation: every operation is replacing some character from the string s by any other character. Get the anagram of string t in the least number of replacing operations. If you can get multiple anagrams of string t in the least number of operations, get the lexicographically minimal one.The lexicographic order of strings is the familiar to us ""dictionary"" order. Formally, the string p of length n is lexicographically smaller than string q of the same length, if p1\xe2\x80\x89=\xe2\x80\x89q1, p2\xe2\x80\x89=\xe2\x80\x89q2, ..., pk\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89qk\xe2\x80\x89-\xe2\x80\x891, pk\xe2\x80\x89<\xe2\x80\x89qk for some k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Here characters in the strings are numbered from 1. The characters of the strings are compared in the alphabetic order." 1800.0     
                                           251D "Two Sets" bitmasks,math "Little Petya likes numbers a lot. Recently his mother has presented him a collection of n non-negative integers. There\'s only one thing Petya likes more than numbers: playing with little Masha. He immediately decided to give a part of his new collection to her. To make the game even more interesting, Petya decided to give Masha such collection of numbers for which the following conditions fulfill:  Let\'s introduce x1 to denote the xor of all numbers Petya has got left; and let\'s introduce x2 to denote the xor of all numbers he gave to Masha. Value (x1\xe2\x80\x89+\xe2\x80\x89x2) must be as large as possible.  If there are multiple ways to divide the collection so that the previous condition fulfilled, then Petya minimizes the value x1. The xor operation is a bitwise excluding ""OR"", that is denoted as ""xor"" in the Pascal language and ""^"" in C/C++/Java.Help Petya divide the collection as described above. If there are multiple suitable ways to divide it, find any of them. Please note that after Petya gives a part of his numbers to Masha, he may have no numbers left. The reverse situation is also possible, when Petya gives nothing to Masha. In both cases we must assume that the xor of an empty set of numbers equals 0." 2700.0     
                                           250C "Movie Critics" greedy "A film festival is coming up in the city N. The festival will last for exactly n days and each day will have a premiere of exactly one film. Each film has a genre \xe2\x80\x94 an integer from 1 to k.On the i-th day the festival will show a movie of genre ai. We know that a movie of each of k genres occurs in the festival programme at least once. In other words, each integer from 1 to k occurs in the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an at least once.Valentine is a movie critic. He wants to watch some movies of the festival and then describe his impressions on his site.As any creative person, Valentine is very susceptive. After he watched the movie of a certain genre, Valentine forms the mood he preserves until he watches the next movie. If the genre of the next movie is the same, it does not change Valentine\'s mood. If the genres are different, Valentine\'s mood changes according to the new genre and Valentine has a stress.Valentine can\'t watch all n movies, so he decided to exclude from his to-watch list movies of one of the genres. In other words, Valentine is going to choose exactly one of the k genres and will skip all the movies of this genre. He is sure to visit other movies.Valentine wants to choose such genre x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), that the total number of after-movie stresses (after all movies of genre x are excluded) were minimum." 1600.0     
                                           248B "Chilly Willy" "math,number theory" "Chilly Willy loves playing with numbers. He only knows prime numbers that are digits yet. These numbers are 2, 3, 5 and 7. But Willy grew rather bored of such numbers, so he came up with a few games that were connected with them.Chilly Willy wants to find the minimum number of length n, such that it is simultaneously divisible by all numbers Willy already knows (2, 3, 5 and 7). Help him with that.A number\'s length is the number of digits in its decimal representation without leading zeros." 1400.0     
                                           246B "Increase and Decrease" greedy,math "Polycarpus has an array, consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Polycarpus likes it when numbers in an array match. That\'s why he wants the array to have as many equal numbers as possible. For that Polycarpus performs the following operation multiple times:  he chooses two elements of the array ai, aj (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j);  he simultaneously increases number ai by 1 and decreases number aj by 1, that is, executes ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 and aj\xe2\x80\x89=\xe2\x80\x89aj\xe2\x80\x89-\xe2\x80\x891. The given operation changes exactly two distinct array elements. Polycarpus can apply the described operation an infinite number of times. Now he wants to know what maximum number of equal array elements he can get if he performs an arbitrary number of such operation. Help Polycarpus." 1300.0     
                                           246A "Buggy Sorting" "constructive algorithms,greedy,sortings" "Little boy Valera studies an algorithm of sorting an integer array. After studying the theory, he went on to the practical tasks. As a result, he wrote a program that sorts an array of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an in the non-decreasing order. The pseudocode of the program, written by Valera, is given below. The input of the program gets number n and array a.loop integer variable i from 1 to n\xe2\x80\x89-\xe2\x80\x891    loop integer variable j from i to n\xe2\x80\x89-\xe2\x80\x891        if (aj\xe2\x80\x89>\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x891), then swap the values of elements aj and aj\xe2\x80\x89+\xe2\x80\x891But Valera could have made a mistake, because he hasn\'t yet fully learned the sorting algorithm. If Valera made a mistake in his program, you need to give a counter-example that makes his program work improperly (that is, the example that makes the program sort the array not in the non-decreasing order). If such example for the given value of n doesn\'t exist, print -1." 900.0     
                                           245H "Queries for Number of Palindromes" dp,hashing,strings "You\'ve got a string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| of length |s|, consisting of lowercase English letters. There also are q queries, each query is described by two integers li,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|). The answer to the query is the number of substrings of string s[li... ri], which are palindromes.String s[l... r]\xe2\x80\x89=\xe2\x80\x89slsl\xe2\x80\x89+\xe2\x80\x891... sr (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) is a substring of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s|.String t is called a palindrome, if it reads the same from left to right and from right to left. Formally, if t\xe2\x80\x89=\xe2\x80\x89t1t2... t|t|\xe2\x80\x89=\xe2\x80\x89t|t|t|t|\xe2\x80\x89-\xe2\x80\x891... t1." 1800.0     
                                           235E "Number Challenge" "combinatorics,dp,implementation,math,number theory" "Let\'s denote d(n) as the number of divisors of a positive integer n. You are given three integers a, b and c. Your task is to calculate the following sum:Find the sum modulo 1073741824 (230)." 2600.0     
                                           234A "Lefthanders and Righthanders" implementation "One fine October day a mathematics teacher Vasily Petrov went to a class and saw there n pupils who sat at the  desks, two people at each desk. Vasily quickly realized that number n is even. Like all true mathematicians, Vasily has all students numbered from 1 to n.But Vasily Petrov did not like the way the children were seated at the desks. According to him, the students whose numbers differ by 1, can not sit together, as they talk to each other all the time, distract others and misbehave.On the other hand, if a righthanded student sits at the left end of the desk and a lefthanded student sits at the right end of the desk, they hit elbows all the time and distract each other. In other cases, the students who sit at the same desk, do not interfere with each other.Vasily knows very well which students are lefthanders and which ones are righthanders, and he asks you to come up with any order that meets these two uncomplicated conditions (students do not talk to each other and do not bump their elbows). It is guaranteed that the input is such that at least one way to seat the students always exists." 1200.0     
                                           232D Fence "binary search,data structures,string suffix structures" "John Doe has a crooked fence, consisting of n rectangular planks, lined up from the left to the right: the plank that goes i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) (from left to right) has width 1 and height hi. We will assume that the plank that goes i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) (from left to right) has index i.A piece of the fence from l to r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is a sequence of planks of wood with indices from l to r inclusive, that is, planks with indices l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r. The width of the piece of the fence from l to r is value r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891.Two pieces of the fence from l1 to r1 and from l2 to r2 are called matching, if the following conditions hold:  the pieces do not intersect, that is, there isn\'t a single plank, such that it occurs in both pieces of the fence;  the pieces are of the same width;  for all i (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1\xe2\x80\x89-\xe2\x80\x89l1) the following condition holds: hl1\xe2\x80\x89+\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x89hl2\xe2\x80\x89+\xe2\x80\x89i\xe2\x80\x89=\xe2\x80\x89hl1\xe2\x80\x89+\xe2\x80\x89hl2. John chose a few pieces of the fence and now wants to know how many distinct matching pieces are for each of them. Two pieces of the fence are distinct if there is a plank, which belongs to one of them and does not belong to the other one." 2900.0     
                                           232A Cycles "binary search,constructive algorithms,graphs,greedy" "John Doe started thinking about graphs. After some thought he decided that he wants to paint an undirected graph, containing exactly k cycles of length 3. A cycle of length 3 is an unordered group of three distinct graph vertices a, b and c, such that each pair of them is connected by a graph edge. John has been painting for long, but he has not been a success. Help him find such graph. Note that the number of vertices there shouldn\'t exceed 100, or else John will have problems painting it." 1600.0     
                                           229B Planets "binary search,data structures,graphs,shortest paths" "Goa\'uld Apophis captured Jack O\'Neill\'s team again! Jack himself was able to escape, but by that time Apophis\'s ship had already jumped to hyperspace. But Jack knows on what planet will Apophis land. In order to save his friends, Jack must repeatedly go through stargates to get to this planet.Overall the galaxy has n planets, indexed with numbers from 1 to n. Jack is on the planet with index 1, and Apophis will land on the planet with index n. Jack can move between some pairs of planets through stargates (he can move in both directions); the transfer takes a positive, and, perhaps, for different pairs of planets unequal number of seconds. Jack begins his journey at time 0.It can be that other travellers are arriving to the planet where Jack is currently located. In this case, Jack has to wait for exactly 1 second before he can use the stargate. That is, if at time t another traveller arrives to the planet, Jack can only pass through the stargate at time t\xe2\x80\x89+\xe2\x80\x891, unless there are more travellers arriving at time t\xe2\x80\x89+\xe2\x80\x891 to the same planet.Knowing the information about travel times between the planets, and the times when Jack would not be able to use the stargate on particular planets, determine the minimum time in which he can get to the planet with index n." 1700.0     
                                           228A "Is your horseshoe on the other hoof?" implementation "Valera the Horse is going to the party with friends. He has been following the fashion trends for a while, and he knows that it is very popular to wear all horseshoes of different color. Valera has got four horseshoes left from the last year, but maybe some of them have the same color. In this case he needs to go to the store and buy some few more horseshoes, not to lose face in front of his stylish comrades.Fortunately, the store sells horseshoes of all colors under the sun and Valera has enough money to buy any four of them. However, in order to save the money, he would like to spend as little money as possible, so you need to help Valera and determine what is the minimum number of horseshoes he needs to buy to wear four horseshoes of different colors to a party." 800.0     
                                           226B "Naughty Stone Piles" greedy "There are n piles of stones of sizes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an lying on the table in front of you.During one move you can take one pile and add it to the other. As you add pile i to pile j, the size of pile j increases by the current size of pile i, and pile i stops existing. The cost of the adding operation equals the size of the added pile.Your task is to determine the minimum cost at which you can gather all stones in one pile. To add some challenge, the stone piles built up conspiracy and decided that each pile will let you add to it not more than k times (after that it can only be added to another pile). Moreover, the piles decided to puzzle you completely and told you q variants (not necessarily distinct) of what k might equal. Your task is to find the minimum cost for each of q variants." 1900.0     
                                           225B "Well-known Numbers" "binary search,greedy,number theory" "Numbers k-bonacci (k is integer, k\xe2\x80\x89>\xe2\x80\x891) are a generalization of Fibonacci numbers and are determined as follows:  F(k,\xe2\x80\x89n)\xe2\x80\x89=\xe2\x80\x890, for integer n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89<\xe2\x80\x89k;  F(k,\xe2\x80\x89k)\xe2\x80\x89=\xe2\x80\x891;  F(k,\xe2\x80\x89n)\xe2\x80\x89=\xe2\x80\x89F(k,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89F(k,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89F(k,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k), for integer n, n\xe2\x80\x89>\xe2\x80\x89k. Note that we determine the k-bonacci numbers, F(k,\xe2\x80\x89n), only for integer values of n and k.You\'ve got a number s, represent it as a sum of several (at least two) distinct k-bonacci numbers." 1600.0     
                                           225A "Dice Tower" "constructive algorithms,greedy" "A dice is a cube, its faces contain distinct integers from 1 to 6 as black points. The sum of numbers at the opposite dice faces always equals 7. Please note that there are only two dice (these dices are mirror of each other) that satisfy the given constraints (both of them are shown on the picture on the left).  Alice and Bob play dice. Alice has built a tower from n dice. We know that in this tower the adjacent dice contact with faces with distinct numbers. Bob wants to uniquely identify the numbers written on the faces of all dice, from which the tower is built. Unfortunately, Bob is looking at the tower from the face, and so he does not see all the numbers on the faces. Bob sees the number on the top of the tower and the numbers on the two adjacent sides (on the right side of the picture shown what Bob sees).Help Bob, tell whether it is possible to uniquely identify the numbers on the faces of all the dice in the tower, or not." 1100.0     
                                           221A "Little Elephant and Function" implementation,math "The Little Elephant enjoys recursive functions.This time he enjoys the sorting function. Let a is a permutation of an integers from 1 to n, inclusive, and ai denotes the i-th element of the permutation. The Little Elephant\'s recursive function f(x), that sorts the first x permutation\'s elements, works as follows:  If x\xe2\x80\x89=\xe2\x80\x891, exit the function.  Otherwise, call f(x\xe2\x80\x89-\xe2\x80\x891), and then make swap(ax\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89ax) (swap the x-th and (x\xe2\x80\x89-\xe2\x80\x891)-th elements of a). The Little Elephant\'s teacher believes that this function does not work correctly. But that-be do not get an F, the Little Elephant wants to show the performance of its function. Help him, find a permutation of numbers from 1 to n, such that after performing the Little Elephant\'s function (that is call f(n)), the permutation will be sorted in ascending order." 1000.0     
                                           220B "Little Elephant and Array" "constructive algorithms,data structures" "The Little Elephant loves playing with arrays. He has array a, consisting of n positive integers, indexed from 1 to n. Let\'s denote the number with index i as ai. Additionally the Little Elephant has m queries to the array, each query is characterised by a pair of integers lj and rj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). For each query lj,\xe2\x80\x89rj the Little Elephant has to count, how many numbers x exist, such that number x occurs exactly x times among numbers alj,\xe2\x80\x89alj\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89arj.Help the Little Elephant to count the answers to all queries." 1800.0     
                                           218B Airport implementation "Lolek and Bolek are about to travel abroad by plane. The local airport has a special ""Choose Your Plane"" offer. The offer\'s conditions are as follows:  it is up to a passenger to choose a plane to fly on;  if the chosen plane has x (x\xe2\x80\x89>\xe2\x80\x890) empty seats at the given moment, then the ticket for such a plane costs x zlotys (units of Polish currency). The only ticket office of the airport already has a queue of n passengers in front of it. Lolek and Bolek have not stood in the queue yet, but they are already wondering what is the maximum and the minimum number of zlotys the airport administration can earn if all n passengers buy tickets according to the conditions of this offer?The passengers buy tickets in turn, the first person in the queue goes first, then goes the second one, and so on up to n-th person." 1100.0     
                                           218A "Mountain Scenery" "brute force,constructive algorithms,implementation" "Little Bolek has found a picture with n mountain peaks painted on it. The n painted peaks are represented by a non-closed polyline, consisting of 2n segments. The segments go through 2n\xe2\x80\x89+\xe2\x80\x891 points with coordinates (1,\xe2\x80\x89y1), (2,\xe2\x80\x89y2), ..., (2n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y2n\xe2\x80\x89+\xe2\x80\x891), with the i-th segment connecting the point (i,\xe2\x80\x89yi) and the point (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891). For any even i (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n) the following condition holds: yi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89yi and yi\xe2\x80\x89>\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891. We shall call a vertex of a polyline with an even x coordinate a mountain peak.   The figure to the left shows the initial picture, the figure to the right shows what the picture looks like after Bolek\'s actions. The affected peaks are marked red, k = 2.  Bolek fancied a little mischief. He chose exactly k mountain peaks, rubbed out the segments that went through those peaks and increased each peak\'s height by one (that is, he increased the y coordinate of the corresponding points). Then he painted the missing segments to get a new picture of mountain peaks. Let us denote the points through which the new polyline passes on Bolek\'s new picture as (1,\xe2\x80\x89r1), (2,\xe2\x80\x89r2), ..., (2n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89r2n\xe2\x80\x89+\xe2\x80\x891).Given Bolek\'s final picture, restore the initial one." 1100.0     
                                           216D "Spider\'s Web" "binary search,sortings,two pointers" "Paw the Spider is making a web. Web-making is a real art, Paw has been learning to do it his whole life. Let\'s consider the structure of the web.  There are n main threads going from the center of the web. All main threads are located in one plane and divide it into n equal infinite sectors. The sectors are indexed from 1 to n in the clockwise direction. Sectors i and i\xe2\x80\x89+\xe2\x80\x891 are adjacent for every i, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n. In addition, sectors 1 and n are also adjacent.Some sectors have bridge threads. Each bridge connects the two main threads that make up this sector. The points at which the bridge is attached to the main threads will be called attachment points. Both attachment points of a bridge are at the same distance from the center of the web. At each attachment point exactly one bridge is attached. The bridges are adjacent if they are in the same sector, and there are no other bridges between them.A cell of the web is a trapezoid, which is located in one of the sectors and is bounded by two main threads and two adjacent bridges. You can see that the sides of the cell may have the attachment points of bridges from adjacent sectors. If the number of attachment points on one side of the cell is not equal to the number of attachment points on the other side, it creates an imbalance of pulling forces on this cell and this may eventually destroy the entire web. We\'ll call such a cell unstable. The perfect web does not contain unstable cells.Unstable cells are marked red in the figure. Stable cells are marked green.Paw the Spider isn\'t a skillful webmaker yet, he is only learning to make perfect webs. Help Paw to determine the number of unstable cells in the web he has just spun." 1700.0     
                                           214B Hometask "brute force,constructive algorithms,greedy,math" "Furik loves math lessons very much, so he doesn\'t attend them, unlike Rubik. But now Furik wants to get a good mark for math. For that Ms. Ivanova, his math teacher, gave him a new task. Furik solved the task immediately. Can you?You are given a set of digits, your task is to find the maximum integer that you can make from these digits. The made number must be divisible by 2, 3, 5 without a residue. It is permitted to use not all digits from the set, it is forbidden to use leading zeroes.Each digit is allowed to occur in the number the same number of times it occurs in the set." 1600.0     
                                           212E "IT Restaurants" "dfs and similar,dp,trees" "\xd0\xa1ity N. has a huge problem with roads, food and IT-infrastructure. In total the city has n junctions, some pairs of them are connected by bidirectional roads. The road network consists of n\xe2\x80\x89-\xe2\x80\x891 roads, you can get from any junction to any other one by these roads. Yes, you\'re right \xe2\x80\x94 the road network forms an undirected tree.Recently, the Mayor came up with a way that eliminates the problems with the food and the IT-infrastructure at the same time! He decided to put at the city junctions restaurants of two well-known cafe networks for IT professionals: ""iMac D0naldz"" and ""Burger Bing"". Since the network owners are not friends, it is strictly prohibited to place two restaurants of different networks on neighboring junctions. There are other requirements. Here\'s the full list:  each junction must have at most one restaurant;  each restaurant belongs either to ""iMac D0naldz"", or to ""Burger Bing"";  each network should build at least one restaurant;  there is no pair of junctions that are connected by a road and contains restaurants of different networks. The Mayor is going to take a large tax from each restaurant, so he is interested in making the total number of the restaurants as large as possible.Help the Mayor to analyze the situation. Find all such pairs of (a,\xe2\x80\x89b) that a restaurants can belong to ""iMac D0naldz"", b restaurants can belong to ""Burger Bing"", and the sum of a\xe2\x80\x89+\xe2\x80\x89b is as large as possible." 1500.0     
                                           208E "Blood Cousins" "binary search,data structures,dfs and similar,trees" "Polycarpus got hold of a family relationship tree. The tree describes family relationships of n people, numbered 1 through n. Each person in the tree has no more than one parent.Let\'s call person a a 1-ancestor of person b, if a is the parent of b.Let\'s call person a a k-ancestor (k\xe2\x80\x89>\xe2\x80\x891) of person b, if person b has a 1-ancestor, and a is a (k\xe2\x80\x89-\xe2\x80\x891)-ancestor of b\'s 1-ancestor. Family relationships don\'t form cycles in the found tree. In other words, there is no person who is his own ancestor, directly or indirectly (that is, who is an x-ancestor for himself, for some x, x\xe2\x80\x89>\xe2\x80\x890).Let\'s call two people x and y (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y) p-th cousins (p\xe2\x80\x89>\xe2\x80\x890), if there is person z, who is a p-ancestor of x and a p-ancestor of y.Polycarpus wonders how many counsins and what kinds of them everybody has. He took a piece of paper and wrote m pairs of integers vi, pi. Help him to calculate the number of pi-th cousins that person vi has, for each pair vi, pi." 2100.0     
                                           208A Dubstep strings "Vasya works as a DJ in the best Berland nightclub, and he often uses dubstep music in his performance. Recently, he has decided to take a couple of old songs and make dubstep remixes from them.Let\'s assume that a song consists of some number of words. To make the dubstep remix of this song, Vasya inserts a certain number of words ""WUB"" before the first word of the song (the number may be zero), after the last word (the number may be zero), and between words (at least one between any pair of neighbouring words), and then the boy glues together all the words, including ""WUB"", in one string and plays the song at the club.For example, a song with words ""I AM X"" can transform into a dubstep remix as ""WUBWUBIWUBAMWUBWUBX"" and cannot transform into ""WUBWUBIAMWUBX"".Recently, Petya has heard Vasya\'s new dubstep track, but since he isn\'t into modern music, he decided to find out what was the initial song that Vasya remixed. Help Petya restore the original song." 900.0     
                                           207D8 "The Beaver\'s Problem - 3"  "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 2300.0     
                                           207D3 "The Beaver\'s Problem - 3"  "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 2000.0     
                                           204D "Little Elephant and Retro Strings" dp "The Little Elephant has found a ragged old black-and-white string s on the attic.The characters of string s are numbered from the left to the right from 1 to |s|, where |s| is the length of the string. Let\'s denote the i-th character of string s as si. As the string is black-and-white, each character of the string is either letter ""B"", or letter ""W"". Unfortunately, the string is very old and some characters are damaged. The damaged positions are denoted as ""X"".The Little Elephant in determined to restore the string and hang it on the wall. For that he needs to replace each character ""X"" by a ""B"" or a ""W"". The string must look good on the wall, so it must be beautiful. The Little Elephant considers a string beautiful if it has two non-intersecting substrings of a given length k, such that the left one fully consists of characters ""B"", and the right one fully consists of characters ""W"". More formally, there are four integers a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|; b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89d\xe2\x80\x89-\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89k) such that si = ""B"" (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) and sj = ""W"" (c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d). Help the Little Elephant find the number of different beautiful strings he can obtain from string s. Two strings are considered different if there is such position, where the character in the first string differs from the corresponding character in the second string. If this string doesn\'t contain characters \xc2\xabX\xc2\xbb and it is already beautiful \xe2\x80\x94 the answer is 1.As the answer can be rather large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2400.0     
                                           204A "Little Elephant and Interval" "binary search,combinatorics,dp" "The Little Elephant very much loves sums on intervals.This time he has a pair of integers l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). The Little Elephant has to find the number of such integers x (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), that the first digit of integer x equals the last one (in decimal notation). For example, such numbers as 101, 477474 or 9 will be included in the answer and 47, 253 or 1020 will not.Help him and count the number of described numbers x for a given pair l and r." 1500.0     
                                           203D "Hit Ball" geometry,implementation,math "When Valera was playing football on a stadium, it suddenly began to rain. Valera hid in the corridor under the grandstand not to get wet. However, the desire to play was so great that he decided to train his hitting the ball right in this corridor. Valera went back far enough, put the ball and hit it. The ball bounced off the walls, the ceiling and the floor corridor and finally hit the exit door. As the ball was wet, it left a spot on the door. Now Valera wants to know the coordinates for this spot.Let\'s describe the event more formally. The ball will be considered a point in space. The door of the corridor will be considered a rectangle located on plane xOz, such that the lower left corner of the door is located at point (0,\xe2\x80\x890,\xe2\x80\x890), and the upper right corner is located at point (a,\xe2\x80\x890,\xe2\x80\x89b) . The corridor will be considered as a rectangular parallelepiped, infinite in the direction of increasing coordinates of y. In this corridor the floor will be considered as plane xOy, and the ceiling as plane, parallel to xOy and passing through point (a,\xe2\x80\x890,\xe2\x80\x89b). We will also assume that one of the walls is plane yOz, and the other wall is plane, parallel to yOz and passing through point (a,\xe2\x80\x890,\xe2\x80\x89b).We\'ll say that the ball hit the door when its coordinate y was equal to 0. Thus the coordinates of the spot are point (x0,\xe2\x80\x890,\xe2\x80\x89z0), where 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x890\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89z0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b. To hit the ball, Valera steps away from the door at distance m and puts the ball in the center of the corridor at point . After the hit the ball flies at speed (vx,\xe2\x80\x89vy,\xe2\x80\x89vz). This means that if the ball has coordinates (x,\xe2\x80\x89y,\xe2\x80\x89z), then after one second it will have coordinates (x\xe2\x80\x89+\xe2\x80\x89vx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89vy,\xe2\x80\x89z\xe2\x80\x89+\xe2\x80\x89vz).See image in notes for clarification.When the ball collides with the ceiling, the floor or a wall of the corridor, it bounces off in accordance with the laws of reflection (the angle of incidence equals the angle of reflection). In the problem we consider the ideal physical model, so we can assume that there is no air resistance, friction force, or any loss of energy." 1700.0     
                                                198B "Jumping on Walls" "shortest paths" "Vasya plays a computer game with ninjas. At this stage Vasya\'s ninja should get out of a deep canyon.The canyon consists of two vertical parallel walls, their height is n meters. Let\'s imagine that we split these walls into 1 meter-long areas and number them with positive integers from 1 to n from bottom to top. Some areas are safe and the ninja can climb them. Others are spiky and ninja can\'t be there. Let\'s call such areas dangerous.Initially the ninja is on the lower area of the left wall. He can use each second to perform one of the following actions:   climb one area up;  climb one area down;  jump to the opposite wall. That gets the ninja to the area that is exactly k meters higher than the area he jumped from. More formally, if before the jump the ninja is located at area x of one wall, then after the jump he is located at area x\xe2\x80\x89+\xe2\x80\x89k of the other wall. If at some point of time the ninja tries to get to an area with a number larger than n, then we can assume that the ninja got out of the canyon.The canyon gets flooded and each second the water level raises one meter. Initially the water level is at the lower border of the first area. Ninja cannot be on the area covered by water. We can assume that the ninja and the water ""move in turns"" \xe2\x80\x94 first the ninja performs some action, then the water raises for one meter, then the ninja performs one more action and so on.The level is considered completed if the ninja manages to get out of the canyon.After several failed attempts Vasya started to doubt whether it is possible to complete the level at all. Help him answer the question." 1400.0
                                                198A "About Bacteria" implementation,math "Qwerty the Ranger took up a government job and arrived on planet Mars. He should stay in the secret lab and conduct some experiments on bacteria that have funny and abnormal properties. The job isn\'t difficult, but the salary is high.At the beginning of the first experiment there is a single bacterium in the test tube. Every second each bacterium in the test tube divides itself into k bacteria. After that some abnormal effects create b more bacteria in the test tube. Thus, if at the beginning of some second the test tube had x bacteria, then at the end of the second it will have kx\xe2\x80\x89+\xe2\x80\x89b bacteria.The experiment showed that after n seconds there were exactly z bacteria and the experiment ended at this point.For the second experiment Qwerty is going to sterilize the test tube and put there t bacteria. He hasn\'t started the experiment yet but he already wonders, how many seconds he will need to grow at least z bacteria. The ranger thinks that the bacteria will divide by the same rule as in the first experiment. Help Qwerty and find the minimum number of seconds needed to get a tube with at least z bacteria in the second experiment." 1700.0
                                                196B "Infinite Maze" "dfs and similar,graphs" "We\'ve got a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m-cell maze. Each cell is either passable, or is a wall (impassable). A little boy found the maze and cyclically tiled a plane with it so that the plane became an infinite maze. Now on this plane cell (x,\xe2\x80\x89y) is a wall if and only if cell  is a wall.In this problem  is a remainder of dividing number a by number b.The little boy stood at some cell on the plane and he wondered whether he can walk infinitely far away from his starting position. From cell (x,\xe2\x80\x89y) he can go to one of the following cells: (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y) and (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), provided that the cell he goes to is not a wall." 2000.0
                                                196A "Lexicographically Maximum Subsequence" greedy,strings "You\'ve got string s, consisting of only lowercase English letters. Find its lexicographically maximum subsequence.We\'ll call a non-empty string s[p1p2... pk]\xe2\x80\x89=\xe2\x80\x89sp1sp2... spk(1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) a subsequence of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s|.String x\xe2\x80\x89=\xe2\x80\x89x1x2... x|x| is lexicographically larger than string y\xe2\x80\x89=\xe2\x80\x89y1y2... y|y|, if either |x|\xe2\x80\x89>\xe2\x80\x89|y| and x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89x|y|\xe2\x80\x89=\xe2\x80\x89y|y|, or exists such number r (r\xe2\x80\x89<\xe2\x80\x89|x|,\xe2\x80\x89r\xe2\x80\x89<\xe2\x80\x89|y|), that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xr\xe2\x80\x89=\xe2\x80\x89yr and xr\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89yr\xe2\x80\x89+\xe2\x80\x891. Characters in lines are compared like their ASCII codes." 1100.0
                                                193D "Two Segments" "data structures" "Nick has some permutation consisting of p integers from 1 to n. A segment [l,\xe2\x80\x89r] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) is a set of elements pi satisfying l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r.Nick calls a pair of segments [a0,\xe2\x80\x89a1] and [b0,\xe2\x80\x89b1] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89<\xe2\x80\x89b0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) good if all their (a1\xe2\x80\x89-\xe2\x80\x89a0\xe2\x80\x89+\xe2\x80\x89b1\xe2\x80\x89-\xe2\x80\x89b0\xe2\x80\x89+\xe2\x80\x892) elements, when sorted in ascending order, form an arithmetic progression with a difference of 1. That is, when they sorted in ascending order, the elements are in the form {x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891}, for some x and m.Your task is to find the number of distinct pairs of good segments in the given permutation. Two pairs of segments are considered distinct if the sets of elements contained in these pairs of segments are distinct. For example, any segment [l,\xe2\x80\x89r] (l\xe2\x80\x89<\xe2\x80\x89r) can be represented as a pair of segments, as [l,\xe2\x80\x89i] and [i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89r] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). As all these pairs consist of the same set of elements, they are considered identical.See the notes accompanying the sample tests for clarification." 2900.0
                                                191E "Thwarting Demonstrations" "binary search,data structures,trees" "It is dark times in Berland. Berlyand opposition, funded from a neighboring state, has organized a demonstration in Berland capital Bertown. Through the work of intelligence we know that the demonstrations are planned to last for k days.Fortunately, Berland has a special police unit, which can save the country. It has exactly n soldiers numbered from 1 to n. Berland general, the commander of the detachment, must schedule the detachment\'s work in these difficult k days. In each of these days, the general must send a certain number of police officers to disperse riots. Since the detachment is large and the general is not very smart, he can only select a set of all soldiers numbered from l to r, inclusive, where l and r are selected arbitrarily.Now the general has exactly two problems. First, he cannot send the same group twice \xe2\x80\x94 then soldiers get bored and they rebel. Second, not all soldiers are equally reliable. Every soldier has a reliability of ai. The reliability of the detachment is counted as the sum of reliabilities of soldiers in it. The reliability of a single soldier can be negative, then when you include him in the detachment, he will only spoil things. The general is distinguished by his great greed and shortsightedness, so each day he sends to the dissolution the most reliable group of soldiers possible (that is, of all the groups that have not been sent yet).The Berland Government has decided to know what would be the minimum reliability of the detachment, sent to disperse the demonstrations during these k days. The general himself can not cope with such a difficult task. Help him to not embarrass himself in front of his superiors!" 2200.0
                                                191D "Metro Scheme" graphs,greedy "Berland is very concerned with privacy, so almost all plans and blueprints are secret. However, a spy of the neighboring state managed to steal the Bertown subway scheme.The Bertown Subway has n stations, numbered from 1 to n, and m bidirectional tunnels connecting them. All Bertown Subway consists of lines. To be more precise, there are two types of lines: circular and radial.A radial line is a sequence of stations v1,\xe2\x80\x89...,\xe2\x80\x89vk (k\xe2\x80\x89>\xe2\x80\x891), where stations vi and vi\xe2\x80\x89+\xe2\x80\x891 (i\xe2\x80\x89<\xe2\x80\x89k) are connected by a tunnel and no station occurs in the line more than once (vi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89vj for i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j).A loop line is a series of stations, v1,\xe2\x80\x89...,\xe2\x80\x89vk (k\xe2\x80\x89>\xe2\x80\x892), where stations vi \xd0\xb8 vi\xe2\x80\x89+\xe2\x80\x891 are connected by a tunnel. In addition, stations v1 and vk are also connected by a tunnel. No station is occurs in the loop line more than once.Note that a single station can be passed by any number of lines.According to Berland standards, there can\'t be more than one tunnel between two stations and each tunnel belongs to exactly one line. Naturally, each line has at least one tunnel. Between any two stations there is the way along the subway tunnels. In addition, in terms of graph theory, a subway is a vertex cactus: if we consider the subway as a graph in which the stations are the vertexes and the edges are tunnels, then each vertex lies on no more than one simple cycle.Unfortunately, scheme, stolen by the spy, had only the stations and the tunnels. It was impossible to determine to which line every tunnel corresponds. But to sabotage successfully, the spy needs to know what minimum and maximum number of lines may be in the Bertown subway.Help him!" 2700.0
                                                188H Stack "*special problem,expression parsing,implementation" "In this problem we\'ll use a stack which supports two types of operations:  Push a given number on the stack.  Pop two numbers from the stack, perform a given operation (addition or multiplication) on them and push the result on the stack. You are given a string which describes the sequence of operations to be performed on the stack. i-th character corresponds to i-th operation:  If i-th character is a digit, push the corresponding number on the stack.  If i-th character is \xc2\xab+\xc2\xbb or \xc2\xab*\xc2\xbb, perform the corresponding operation. Initially the stack is empty. Output the topmost number on the stack after executing all given operations." 1800.0
                                                188B "A + Reverse B" "*special problem,implementation" "You are given numbers a and b. Calculate the sum of a and reverse of b. A reverse of a number is a number which contains the same digits in reverse order. For example, reverse of 230 is 32, and reverse of 0 is 0." 1300.0
                                                183A Headquarters "constructive algorithms,math" "Sensation, sensation in the two-dimensional kingdom! The police have caught a highly dangerous outlaw, member of the notorious ""Pihters"" gang. The law department states that the outlaw was driving from the gang\'s headquarters in his car when he crashed into an ice cream stall. The stall, the car, and the headquarters each occupies exactly one point on the two-dimensional kingdom.The outlaw\'s car was equipped with a GPS transmitter. The transmitter showed that the car made exactly n movements on its way from the headquarters to the stall. A movement can move the car from point (x,\xe2\x80\x89y) to one of these four points: to point (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y) which we will mark by letter ""L"", to point (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y) \xe2\x80\x94 ""R"", to point (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) \xe2\x80\x94 ""D"", to point (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 ""U"".The GPS transmitter is very inaccurate and it doesn\'t preserve the exact sequence of the car\'s movements. Instead, it keeps records of the car\'s possible movements. Each record is a string of one of these types: ""UL"", ""UR"", ""DL"", ""DR"" or ""ULDR"". Each such string means that the car made a single movement corresponding to one of the characters of the string. For example, string ""UL"" means that the car moved either ""U"", or ""L"".You\'ve received the journal with the outlaw\'s possible movements from the headquarters to the stall. The journal records are given in a chronological order. Given that the ice-cream stall is located at point (0,\xe2\x80\x890), your task is to print the number of different points that can contain the gang headquarters (that is, the number of different possible locations of the car\'s origin)." 1700.0
                                                180F "Mathematical Analysis Rocks!" "constructive algorithms,implementation,math" "Students of group 199 have written their lectures dismally. Now an exam on Mathematical Analysis is approaching and something has to be done asap (that is, quickly). Let\'s number the students of the group from 1 to n. Each student i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) has a best friend p[i] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p[i]\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). In fact, each student is a best friend of exactly one student. In other words, all p[i] are different. It is possible that the group also has some really ""special individuals"" for who i\xe2\x80\x89=\xe2\x80\x89p[i].Each student wrote exactly one notebook of lecture notes. We know that the students agreed to act by the following algorithm:   on the first day of revising each student studies his own Mathematical Analysis notes,  in the morning of each following day each student gives the notebook to his best friend and takes a notebook from the student who calls him the best friend. Thus, on the second day the student p[i] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) studies the i-th student\'s notes, on the third day the notes go to student p[p[i]] and so on. Due to some characteristics of the boys\' friendship (see paragraph 1), each day each student has exactly one notebook to study.You are given two sequences that describe the situation on the third and fourth days of revising:  a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai means the student who gets the i-th student\'s notebook on the third day of revising;  b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, where bi means the student who gets the i-th student\'s notebook on the fourth day of revising. You do not know array p, that is you do not know who is the best friend to who. Write a program that finds p by the given sequences a and b." 1200.0
                                                178F1 "Representative Sampling"  "The Smart Beaver from ABBYY has a long history of cooperating with the ""Institute of Cytology and Genetics"". Recently, the Institute staff challenged the Beaver with a new problem. The problem is as follows.There is a collection of n proteins (not necessarily distinct). Each protein is a string consisting of lowercase Latin letters. The problem that the scientists offered to the Beaver is to select a subcollection of size k from the initial collection of proteins so that the representativity of the selected subset of proteins is maximum possible.The Smart Beaver from ABBYY did some research and came to the conclusion that the representativity of a collection of proteins can be evaluated by a single number, which is simply calculated. Let\'s suppose we have a collection {a1,\xe2\x80\x89...,\xe2\x80\x89ak} consisting of k strings describing proteins. The representativity of this collection is the following value: where f(x,\xe2\x80\x89y) is the length of the longest common prefix of strings x and y; for example, f(""abc"", ""abd"")\xe2\x80\x89=\xe2\x80\x892, and f(""ab"", ""bcd"")\xe2\x80\x89=\xe2\x80\x890.Thus, the representativity of collection of proteins {""abc"", ""abd"", ""abe""} equals 6, and the representativity of collection {""aaa"", ""ba"", ""ba""} equals 2.Having discovered that, the Smart Beaver from ABBYY asked the Cup contestants to write a program that selects, from the given collection of proteins, a subcollection of size k which has the largest possible value of representativity. Help him to solve this problem!" 1800.0
                                                178E1 "The Beaver\'s Problem - 2"  "Offering the ABBYY Cup participants a problem written by the Smart Beaver is becoming a tradition. He proposed the following problem.You are given a monochrome image, that is, an image that is composed of two colors (black and white). The image is given in raster form, that is, as a matrix of pixels\' colors, and the matrix\'s size coincides with the size of the image.The white color on the given image corresponds to the background. Also, the image contains several black geometric shapes. It is known that the image can contain only two types of shapes: squares and circles. Your task is to count the number of circles and the number of squares which the given image contains.The squares on the image can be rotated arbitrarily. In addition, the image can possibly contain some noise arranged as follows: each pixel of the original image can change its color to the opposite with the probability of 20%.   An example of an image that has no noise and the sides of the squares are parallel to the coordinate axes (two circles and three squares).     An example of an image that has no noise and the squares are rotated arbitrarily (two circles and three squares).     An example of an image that has noise and the squares are rotated arbitrarily (one circle and three squares)." 1900.0
                                                178A2 "Educational Game" greedy "The Smart Beaver from ABBYY began to develop a new educational game for children. The rules of the game are fairly simple and are described below.The playing field is a sequence of n non-negative integers ai numbered from 1 to n. The goal of the game is to make numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak (i.e. some prefix of the sequence) equal to zero for some fixed k (k\xe2\x80\x89<\xe2\x80\x89n), and this should be done in the smallest possible number of moves.One move is choosing an integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that ai\xe2\x80\x89>\xe2\x80\x890 and an integer t (t\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) such that i\xe2\x80\x89+\xe2\x80\x892t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. After the values of i and t have been selected, the value of ai is decreased by 1, and the value of ai\xe2\x80\x89+\xe2\x80\x892t is increased by 1. For example, let n\xe2\x80\x89=\xe2\x80\x894 and a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892), then it is possible to make move i\xe2\x80\x89=\xe2\x80\x893, t\xe2\x80\x89=\xe2\x80\x890 and get a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x893) or to make move i\xe2\x80\x89=\xe2\x80\x891, t\xe2\x80\x89=\xe2\x80\x891 and get a\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x890,\xe2\x80\x892,\xe2\x80\x892) (the only possible other move is i\xe2\x80\x89=\xe2\x80\x891, t\xe2\x80\x89=\xe2\x80\x890).You are given n and the initial sequence ai. The task is to calculate the minimum number of moves needed to make the first k elements of the original sequence equal to zero for each possible k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n)." 1000.0
                                                177D2 "Encrypting Messages" "data structures" "The Smart Beaver from ABBYY invented a new message encryption method and now wants to check its performance. Checking it manually is long and tiresome, so he decided to ask the ABBYY Cup contestants for help.A message is a sequence of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Encryption uses a key which is a sequence of m integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm (m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). All numbers from the message and from the key belong to the interval from 0 to c\xe2\x80\x89-\xe2\x80\x891, inclusive, and all the calculations are performed modulo c.Encryption is performed in n\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891 steps. On the first step we add to each number a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. On the second step we add to each number a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89am\xe2\x80\x89+\xe2\x80\x891 (changed on the previous step) a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. And so on: on step number i we add to each number ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891 a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. The result of the encryption is the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an after n\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891 steps.Help the Beaver to write a program that will encrypt messages in the described manner." 1500.0
                                                177D1 "Encrypting Messages" "brute force" "The Smart Beaver from ABBYY invented a new message encryption method and now wants to check its performance. Checking it manually is long and tiresome, so he decided to ask the ABBYY Cup contestants for help.A message is a sequence of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Encryption uses a key which is a sequence of m integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm (m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). All numbers from the message and from the key belong to the interval from 0 to c\xe2\x80\x89-\xe2\x80\x891, inclusive, and all the calculations are performed modulo c.Encryption is performed in n\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891 steps. On the first step we add to each number a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. On the second step we add to each number a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89am\xe2\x80\x89+\xe2\x80\x891 (changed on the previous step) a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. And so on: on step number i we add to each number ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891 a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. The result of the encryption is the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an after n\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891 steps.Help the Beaver to write a program that will encrypt messages in the described manner." 1200.0
                                                176C "Playing with Superglue" "combinatorics,constructive algorithms" "Two players play a game. The game is played on a rectangular board with n\xe2\x80\x89\xc3\x97\xe2\x80\x89m squares. At the beginning of the game two different squares of the board have two chips. The first player\'s goal is to shift the chips to the same square. The second player aims to stop the first one with a tube of superglue.We\'ll describe the rules of the game in more detail.The players move in turns. The first player begins.With every move the first player chooses one of his unglued chips, and shifts it one square to the left, to the right, up or down. It is not allowed to move a chip beyond the board edge. At the beginning of a turn some squares of the board may be covered with a glue. The first player can move the chip to such square, in this case the chip gets tightly glued and cannot move any longer.At each move the second player selects one of the free squares (which do not contain a chip or a glue) and covers it with superglue. The glue dries long and squares covered with it remain sticky up to the end of the game.If, after some move of the first player both chips are in the same square, then the first player wins. If the first player cannot make a move (both of his chips are glued), then the second player wins. Note that the situation where the second player cannot make a move is impossible \xe2\x80\x94 he can always spread the glue on the square from which the first player has just moved the chip.We will further clarify the case where both chips are glued and are in the same square. In this case the first player wins as the game ends as soon as both chips are in the same square, and the condition of the loss (the inability to move) does not arise.You know the board sizes and the positions of the two chips on it. At the beginning of the game all board squares are glue-free. Find out who wins if the players play optimally." 2000.0
                                                176B "Word Cut" dp "Let\'s consider one interesting word game. In this game you should transform one word into another through special operations. Let\'s say we have word w, let\'s split this word into two non-empty parts x and y so, that w\xe2\x80\x89=\xe2\x80\x89xy. A split operation is transforming word w\xe2\x80\x89=\xe2\x80\x89xy into word u\xe2\x80\x89=\xe2\x80\x89yx. For example, a split operation can transform word ""wordcut"" into word ""cutword"".You are given two words start and end. Count in how many ways we can transform word start into word end, if we apply exactly k split operations consecutively to word start. Two ways are considered different if the sequences of applied operations differ. Two operation sequences are different if exists such number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), that in the i-th operation of the first sequence the word splits into parts x and y, in the i-th operation of the second sequence the word splits into parts a and b, and additionally x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89a holds." 1700.0
                                                175E "Power Defence" "brute force,dp,geometry,greedy" "Vasya plays the Power Defence. He must pass the last level of the game. In order to do this he must kill the Main Villain, who moves in a straight line at speed 1 meter per second from the point (\xe2\x80\x89-\xe2\x80\x89\xe2\x88\x9e,\xe2\x80\x890) to the point (\xe2\x80\x89+\xe2\x80\x89\xe2\x88\x9e,\xe2\x80\x890) of the game world. In the points (x,\xe2\x80\x891) and (x,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891), where x is an integer number, Vasya can build towers of three types: fire-tower, electric-tower or freezing-tower. However, it is not allowed to build two towers at the same point. Towers of each type have a certain action radius and the value of damage per second (except freezing-tower). If at some point the Main Villain is in the range of action of k freezing towers then his speed is decreased by k\xe2\x80\x89+\xe2\x80\x891 times.The allowed number of towers of each type is known. It is necessary to determine the maximum possible damage we can inflict on the Main Villain.All distances in the problem are given in meters. The size of the Main Villain and the towers are so small, that they can be considered as points on the plane. The Main Villain is in the action radius of a tower if the distance between him and tower is less than or equal to the action radius of the tower." 2600.0
                                                175C "Geometry Horse" "greedy,implementation,sortings,two pointers" "Vasya plays the Geometry Horse.The game goal is to destroy geometric figures of the game world. A certain number of points is given for destroying each figure depending on the figure type and the current factor value. There are n types of geometric figures. The number of figures of type ki and figure cost ci is known for each figure type. A player gets ci\xc2\xb7f  points for destroying one figure of type i, where f is the current factor. The factor value can be an integer number from 1 to t\xe2\x80\x89+\xe2\x80\x891, inclusive. At the beginning of the game the factor value is equal to 1. The factor is set to i\xe2\x80\x89+\xe2\x80\x891 after destruction of pi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t) figures, so the (pi\xe2\x80\x89+\xe2\x80\x891)-th figure to be destroyed is considered with factor equal to i\xe2\x80\x89+\xe2\x80\x891.Your task is to determine the maximum number of points Vasya can get after he destroys all figures. Take into account that Vasya is so tough that he can destroy figures in any order chosen by him." 1600.0
                                                173C "Spiral Maximum" "brute force,dp" "Let\'s consider a k\xe2\x80\x89\xc3\x97\xe2\x80\x89k square, divided into unit squares. Please note that k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x893 and is odd. We\'ll paint squares starting from the upper left square in the following order: first we move to the right, then down, then to the left, then up, then to the right again and so on. We finish moving in some direction in one of two cases: either we\'ve reached the square\'s border or the square following after the next square is already painted. We finish painting at the moment when we cannot move in any direction and paint a square. The figure that consists of the painted squares is a spiral.   The figure shows examples of spirals for k\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x895,\xe2\x80\x897,\xe2\x80\x899.  You have an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table, each of its cells contains a number. Let\'s consider all possible spirals, formed by the table cells. It means that we consider all spirals of any size that don\'t go beyond the borders of the table. Let\'s find the sum of the numbers of the cells that form the spiral. You have to find the maximum of those values among all spirals." 1900.0
                                                167A "Wizards and Trolleybuses" implementation,math "In some country live wizards. They love to ride trolleybuses.A city in this country has a trolleybus depot with n trolleybuses. Every day the trolleybuses leave the depot, one by one and go to the final station. The final station is at a distance of d meters from the depot. We know for the i-th trolleybus that it leaves at the moment of time ti seconds, can go at a speed of no greater than vi meters per second, and accelerate with an acceleration no greater than a meters per second squared. A trolleybus can decelerate as quickly as you want (magic!). It can change its acceleration as fast as you want, as well. Note that the maximum acceleration is the same for all trolleys.Despite the magic the trolleys are still powered by an electric circuit and cannot overtake each other (the wires are to blame, of course). If a trolleybus catches up with another one, they go together one right after the other until they arrive at the final station. Also, the drivers are driving so as to arrive at the final station as quickly as possible.You, as head of the trolleybuses\' fans\' club, are to determine for each trolley the minimum time by which it can reach the final station. At the time of arrival at the destination station the trolleybus does not necessarily have zero speed. When a trolley is leaving the depot, its speed is considered equal to zero. From the point of view of physics, the trolleybuses can be considered as material points, and also we should ignore the impact on the speed of a trolley bus by everything, except for the acceleration and deceleration provided by the engine." 1600.0
                                                164E "Polycarpus and Tasks"  "Polycarpus has many tasks. Each task is characterized by three integers li, ri and ti. Three integers (li,\xe2\x80\x89ri,\xe2\x80\x89ti) mean that to perform task i, one needs to choose an integer si (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89si; si\xe2\x80\x89+\xe2\x80\x89ti\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri), then the task will be carried out continuously for ti units of time, starting at time si and up to time si\xe2\x80\x89+\xe2\x80\x89ti\xe2\x80\x89-\xe2\x80\x891, inclusive. In other words, a task is performed for a continuous period of time lasting ti, should be started no earlier than li, and completed no later than ri.Polycarpus\'s tasks have a surprising property: for any task j,\xe2\x80\x89k (with j\xe2\x80\x89<\xe2\x80\x89k) lj\xe2\x80\x89<\xe2\x80\x89lk and rj\xe2\x80\x89<\xe2\x80\x89rk.Let\'s suppose there is an ordered set of tasks A, containing |A| tasks. We\'ll assume that aj\xe2\x80\x89=\xe2\x80\x89(lj,\xe2\x80\x89rj,\xe2\x80\x89tj) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|A|). Also, we\'ll assume that the tasks are ordered by increasing lj with the increase in number.Let\'s consider the following recursive function f, whose argument is an ordered set of tasks A, and the result is an integer. The function f(A) is defined by the greedy algorithm, which is described below in a pseudo-language of programming.  Step 1. , ans\xe2\x80\x89=\xe2\x80\x890.  Step 2. We consider all tasks in the order of increasing of their numbers in the set A. Lets define the current task counter i\xe2\x80\x89=\xe2\x80\x890.  Step 3. Consider the next task: i\xe2\x80\x89=\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891. If i\xe2\x80\x89>\xe2\x80\x89|A| fulfilled, then go to the 8 step.  Step 4. If you can get the task done starting at time si = max(ans\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89li), then do the task i: si = max(ans\xe2\x80\x89+\xe2\x80\x891, li), ans\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x89ti\xe2\x80\x89-\xe2\x80\x891, . Go to the next task (step 3).  Step 5. Otherwise, find such task , that first, task ai can be done at time si = max, and secondly, the value of  is positive and takes the maximum value among all bk that satisfy the first condition. If you can choose multiple tasks as bk, choose the one with the maximum number in set A.  Step 6. If you managed to choose task bk, then , . Go to the next task (step 3).  Step 7. If you didn\'t manage to choose task bk, then skip task i. Go to the next task (step 3).  Step 8. Return ans as a result of executing f(A). Polycarpus got entangled in all these formulas and definitions, so he asked you to simulate the execution of the function f, calculate the value of f(A)." 3100.0
                                                164D "Minimum Diameter" "binary search,brute force" "You are given n points on the plane. You need to delete exactly k of them (k\xe2\x80\x89<\xe2\x80\x89n) so that the diameter of the set of the remaining n\xe2\x80\x89-\xe2\x80\x89k points were as small as possible. The diameter of a set of points is the maximum pairwise distance between the points of the set. The diameter of a one point set equals zero." 3100.0
                                                164C "Machine Programming" flows,graphs "One remarkable day company ""X"" received k machines. And they were not simple machines, they were mechanical programmers! This was the last unsuccessful step before switching to android programmers, but that\'s another story.The company has now n tasks, for each of them we know the start time of its execution si, the duration of its execution ti, and the company profit from its completion ci. Any machine can perform any task, exactly one at a time. If a machine has started to perform the task, it is busy at all moments of time from si to si\xe2\x80\x89+\xe2\x80\x89ti\xe2\x80\x89-\xe2\x80\x891, inclusive, and it cannot switch to another task.You are required to select a set of tasks which can be done with these k machines, and which will bring the maximum total profit." 2400.0
                                                163E e-Government "data structures,dfs and similar,dp,strings,trees" "The best programmers of Embezzland compete to develop a part of the project called ""e-Government"" \xe2\x80\x94 the system of automated statistic collecting and press analysis.We know that any of the k citizens can become a member of the Embezzland government. The citizens\' surnames are a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak. All surnames are different. Initially all k citizens from this list are members of the government. The system should support the following options:  Include citizen ai to the government.  Exclude citizen ai from the government.  Given a newspaper article text, calculate how politicized it is. To do this, for every active government member the system counts the number of times his surname occurs in the text as a substring. All occurrences are taken into consideration, including the intersecting ones. The degree of politicization of a text is defined as the sum of these values for all active government members. Implement this system." 2800.0
                                                163B Lemmings "binary search" "As you know, lemmings like jumping. For the next spectacular group jump n lemmings gathered near a high rock with k comfortable ledges on it. The first ledge is situated at the height of h meters, the second one is at the height of 2h meters, and so on (the i-th ledge is at the height of i\xc2\xb7h meters). The lemmings are going to jump at sunset, and there\'s not much time left.Each lemming is characterized by its climbing speed of vi meters per minute and its weight mi. This means that the i-th lemming can climb to the j-th ledge in  minutes.To make the jump beautiful, heavier lemmings should jump from higher ledges: if a lemming of weight mi jumps from ledge i, and a lemming of weight mj jumps from ledge j (for i\xe2\x80\x89<\xe2\x80\x89j), then the inequation mi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89mj should be fulfilled.Since there are n lemmings and only k ledges (k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), the k lemmings that will take part in the jump need to be chosen. The chosen lemmings should be distributed on the ledges from 1 to k, one lemming per ledge. The lemmings are to be arranged in the order of non-decreasing weight with the increasing height of the ledge. In addition, each lemming should have enough time to get to his ledge, that is, the time of his climb should not exceed t minutes. The lemmings climb to their ledges all at the same time and they do not interfere with each other.Find the way to arrange the lemmings\' jump so that time t is minimized." 2000.0
                                                162I "Truncatable primes" "*special problem" "A truncatable prime is a prime number which contains no zeros in decimal notation and all its suffixes are primes. 1 is considered to be not a prime.You are given a positive integer n. Figure out whether it is a truncatable prime." 2000.0
                                                162F "Factorial zeros" "*special problem" "You are given a positive integer n. Output the number of trailing zeros in n! (n! denotes a product of integers between 1 and n, inclusive)." 1800.0
                                                160C "Find Pair" implementation,math,sortings "You\'ve got another problem dealing with arrays. Let\'s consider an arbitrary sequence containing n (not necessarily different) integers a1, a2, ..., an. We are interested in all possible pairs of numbers (ai, aj), (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). In other words, let\'s consider all n2 pairs of numbers, picked from the given array.For example, in sequence a\xe2\x80\x89=\xe2\x80\x89{3,\xe2\x80\x891,\xe2\x80\x895} are 9 pairs of numbers: (3,\xe2\x80\x893),\xe2\x80\x89(3,\xe2\x80\x891),\xe2\x80\x89(3,\xe2\x80\x895),\xe2\x80\x89(1,\xe2\x80\x893),\xe2\x80\x89(1,\xe2\x80\x891),\xe2\x80\x89(1,\xe2\x80\x895),\xe2\x80\x89(5,\xe2\x80\x893),\xe2\x80\x89(5,\xe2\x80\x891),\xe2\x80\x89(5,\xe2\x80\x895).Let\'s sort all resulting pairs lexicographically by non-decreasing. Let us remind you that pair (p1, q1) is lexicographically less than pair (p2, q2) only if either p1 < p2, or p1 = p2 and q1 < q2.Then the sequence, mentioned above, will be sorted like that: (1,\xe2\x80\x891),\xe2\x80\x89(1,\xe2\x80\x893),\xe2\x80\x89(1,\xe2\x80\x895),\xe2\x80\x89(3,\xe2\x80\x891),\xe2\x80\x89(3,\xe2\x80\x893),\xe2\x80\x89(3,\xe2\x80\x895),\xe2\x80\x89(5,\xe2\x80\x891),\xe2\x80\x89(5,\xe2\x80\x893),\xe2\x80\x89(5,\xe2\x80\x895)Let\'s number all the pair in the sorted list from 1 to n2. Your task is formulated like this: you should find the k-th pair in the ordered list of all possible pairs of the array you\'ve been given." 1700.0
                                                160B "Unlucky Ticket" greedy,sortings "Each of you probably has your personal experience of riding public transportation and buying tickets. After a person buys a ticket (which traditionally has an even number of digits), he usually checks whether the ticket is lucky. Let us remind you that a ticket is lucky if the sum of digits in its first half matches the sum of digits in its second half.But of course, not every ticket can be lucky. Far from it! Moreover, sometimes one look at a ticket can be enough to say right away that the ticket is not lucky. So, let\'s consider the following unluckiness criterion that can definitely determine an unlucky ticket. We\'ll say that a ticket is definitely unlucky if each digit from the first half corresponds to some digit from the second half so that each digit from the first half is strictly less than the corresponding digit from the second one or each digit from the first half is strictly more than the corresponding digit from the second one. Each digit should be used exactly once in the comparisons. In other words, there is such bijective correspondence between the digits of the first and the second half of the ticket, that either each digit of the first half turns out strictly less than the corresponding digit of the second half or each digit of the first half turns out strictly more than the corresponding digit from the second half.For example, ticket 2421 meets the following unluckiness criterion and will not be considered lucky (the sought correspondence is 2\xe2\x80\x89>\xe2\x80\x891 and 4\xe2\x80\x89>\xe2\x80\x892), ticket 0135 also meets the criterion (the sought correspondence is 0\xe2\x80\x89<\xe2\x80\x893 and 1\xe2\x80\x89<\xe2\x80\x895), and ticket 3754 does not meet the criterion. You have a ticket in your hands, it contains 2n digits. Your task is to check whether it meets the unluckiness criterion." 1100.0
                                                160A Twins greedy,sortings "Imagine that you have a twin brother or sister. Having another person that looks exactly like you seems very unusual. It\'s hard to say if having something of an alter ego is good or bad. And if you do have a twin, then you very well know what it\'s like.Now let\'s imagine a typical morning in your family. You haven\'t woken up yet, and Mom is already going to work. She has been so hasty that she has nearly forgotten to leave the two of her darling children some money to buy lunches in the school cafeteria. She fished in the purse and found some number of coins, or to be exact, n coins of arbitrary values a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. But as Mom was running out of time, she didn\'t split the coins for you two. So she scribbled a note asking you to split the money equally.As you woke up, you found Mom\'s coins and read her note. ""But why split the money equally?"" \xe2\x80\x94 you thought. After all, your twin is sleeping and he won\'t know anything. So you decided to act like that: pick for yourself some subset of coins so that the sum of values of your coins is strictly larger than the sum of values of the remaining coins that your twin will have. However, you correctly thought that if you take too many coins, the twin will suspect the deception. So, you\'ve decided to stick to the following strategy to avoid suspicions: you take the minimum number of coins, whose sum of values is strictly more than the sum of values of the remaining coins. On this basis, determine what minimum number of coins you need to take to divide them in the described manner." 900.0
                                                159C "String Manipulation 1.0" "*special problem,binary search,brute force,data structures,strings" "One popular website developed an unusual username editing procedure. One can change the username only by deleting some characters from it: to change the current name s, a user can pick number p and character c and delete the p-th occurrence of character c from the name. After the user changed his name, he can\'t undo the change.For example, one can change name ""arca"" by removing the second occurrence of character ""a"" to get ""arc"". Polycarpus learned that some user initially registered under nickname t, where t is a concatenation of k copies of string s. Also, Polycarpus knows the sequence of this user\'s name changes. Help Polycarpus figure out the user\'s final name." 1400.0
                                                157B Trace geometry,sortings "One day, as Sherlock Holmes was tracking down one very important criminal, he found a wonderful painting on the wall. This wall could be represented as a plane. The painting had several concentric circles that divided the wall into several parts. Some parts were painted red and all the other were painted blue. Besides, any two neighboring parts were painted different colors, that is, the red and the blue color were alternating, i. e. followed one after the other. The outer area of the wall (the area that lied outside all circles) was painted blue. Help Sherlock Holmes determine the total area of red parts of the wall.Let us remind you that two circles are called concentric if their centers coincide. Several circles are called concentric if any two of them are concentric." 1000.0
                                                156E "Mrs. Hudson\'s Pancakes" "brute force,dp" "Mrs. Hudson hasn\'t made her famous pancakes for quite a while and finally she decided to make them again. She has learned m new recipes recently and she can\'t wait to try them. Those recipes are based on n special spices. Mrs. Hudson has these spices in the kitchen lying in jars numbered with integers from 0 to n\xe2\x80\x89-\xe2\x80\x891 (each spice lies in an individual jar). Each jar also has the price of the corresponding spice inscribed \xe2\x80\x94 some integer ai.We know three values for the i-th pancake recipe: di, si, ci. Here di and ci are integers, and si is the pattern of some integer written in the numeral system with radix di. The pattern contains digits, Latin letters (to denote digits larger than nine) and question marks. Number x in the di-base numeral system matches the pattern si, if we can replace question marks in the pattern with digits and letters so that we obtain number x (leading zeroes aren\'t taken into consideration when performing the comparison). More formally: each question mark should be replaced by exactly one digit or exactly one letter. If after we replace all question marks we get a number with leading zeroes, we can delete these zeroes. For example, number 40A9875 in the 11-base numeral system matches the pattern ""??4??987?"", and number 4A9875 does not.To make the pancakes by the i-th recipe, Mrs. Hudson should take all jars with numbers whose representation in the di-base numeral system matches the pattern si. The control number of the recipe (zi) is defined as the sum of number ci and the product of prices of all taken jars. More formally:  (where j is all such numbers whose representation in the di-base numeral system matches the pattern si).Mrs. Hudson isn\'t as interested in the control numbers as she is in their minimum prime divisors. Your task is: for each recipe i find the minimum prime divisor of number zi. If this divisor exceeds 100, then you do not have to find it, print -1." 3000.0
                                                153C "Caesar Cipher" "*special problem" "Caesar cipher is one of the simplest encryption techniques. To transform the original message into encrypted one using key k, one has to replace each letter with a letter which is k positions later in the alphabet (if this takes the position beyond Z, the rest of it is counted from the start of the alphabet). In a more formal way, if letters of the alphabet are enumerated starting with 0, the result of encryption for character x will be  (26 is the number of letters in the Latin alphabet).You are given the original message and the encryption key k. Output the resulting cipher." 2200.0
                                                152C "Pocket Book" combinatorics "One day little Vasya found mom\'s pocket book. The book had n names of her friends and unusually enough, each name was exactly m letters long. Let\'s number the names from 1 to n in the order in which they are written.As mom wasn\'t home, Vasya decided to play with names: he chose three integers i, j, k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m), then he took names number i and j and swapped their prefixes of length k. For example, if we take names ""CBDAD"" and ""AABRD"" and swap their prefixes with the length of 3, the result will be names ""AABAD"" and ""CBDRD"".You wonder how many different names Vasya can write instead of name number 1, if Vasya is allowed to perform any number of the described actions. As Vasya performs each action, he chooses numbers i, j, k independently from the previous moves and his choice is based entirely on his will. The sought number can be very large, so you should only find it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1400.0
                                                151B "Phone Numbers" implementation,strings "Winters are just damn freezing cold in Nvodsk! That\'s why a group of n friends prefers to take a taxi, order a pizza and call girls. The phone numbers in the city consist of three pairs of digits (for example, 12-34-56). Each friend has a phonebook of size si (that\'s the number of phone numbers). We know that taxi numbers consist of six identical digits (for example, 22-22-22), the numbers of pizza deliveries should necessarily be decreasing sequences of six different digits (for example, 98-73-21), all other numbers are the girls\' numbers.You are given your friends\' phone books. Calculate which friend is best to go to when you are interested in each of those things (who has maximal number of phone numbers of each type). If the phone book of one person contains some number two times, you should count it twice. That is, each number should be taken into consideration the number of times it occurs in the phone book." 1200.0
                                                151A "Soft Drinking" implementation,math "This winter is so cold in Nvodsk! A group of n friends decided to buy k bottles of a soft drink called ""Take-It-Light"" to warm up a bit. Each bottle has l milliliters of the drink. Also they bought c limes and cut each of them into d slices. After that they found p grams of salt.To make a toast, each friend needs nl milliliters of the drink, a slice of lime and np grams of salt. The friends want to make as many toasts as they can, provided they all drink the same amount. How many toasts can each friend make?" 800.0
                                                149E "Martian Strings" "string suffix structures,strings" "During the study of the Martians Petya clearly understood that the Martians are absolutely lazy. They like to sleep and don\'t like to wake up. Imagine a Martian who has exactly n eyes located in a row and numbered from the left to the right from 1 to n. When a Martian sleeps, he puts a patch on each eye (so that the Martian morning doesn\'t wake him up). The inner side of each patch has an uppercase Latin letter. So, when a Martian wakes up and opens all his eyes he sees a string s consisting of uppercase Latin letters. The string\'s length is n. ""Ding dong!"" \xe2\x80\x94 the alarm goes off. A Martian has already woken up but he hasn\'t opened any of his eyes. He feels that today is going to be a hard day, so he wants to open his eyes and see something good. The Martian considers only m Martian words beautiful. Besides, it is hard for him to open all eyes at once so early in the morning. So he opens two non-overlapping segments of consecutive eyes. More formally, the Martian chooses four numbers a, b, c, d, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and opens all eyes with numbers i such that a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b or c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d. After the Martian opens the eyes he needs, he reads all the visible characters from the left to the right and thus, he sees some word.Let\'s consider all different words the Martian can see in the morning. Your task is to find out how many beautiful words are among them." 2300.0
                                                148E Porcelain dp "During her tantrums the princess usually smashes some collectable porcelain. Every furious shriek is accompanied with one item smashed.The collection of porcelain is arranged neatly on n shelves. Within each shelf the items are placed in one row, so that one can access only the outermost items \xe2\x80\x94 the leftmost or the rightmost item, not the ones in the middle of the shelf. Once an item is taken, the next item on that side of the shelf can be accessed (see example). Once an item is taken, it can\'t be returned to the shelves.You are given the values of all items. Your task is to find the maximal damage the princess\' tantrum of m shrieks can inflict on the collection of porcelain." 1900.0
                                                148D "Bag of mice" dp,games,math,probabilities "The dragon and the princess are arguing about what to do on the New Year\'s Eve. The dragon suggests flying to the mountains to watch fairies dancing in the moonlight, while the princess thinks they should just go to bed early. They are desperate to come to an amicable agreement, so they decide to leave this up to chance.They take turns drawing a mouse from a bag which initially contains w white and b black mice. The person who is the first to draw a white mouse wins. After each mouse drawn by the dragon the rest of mice in the bag panic, and one of them jumps out of the bag itself (the princess draws her mice carefully and doesn\'t scare other mice). Princess draws first. What is the probability of the princess winning?If there are no more mice in the bag and nobody has drawn a white mouse, the dragon wins. Mice which jump out of the bag themselves are not considered to be drawn (do not define the winner). Once a mouse has left the bag, it never returns to it. Every mouse is drawn from the bag with the same probability as every other one, and every mouse jumps out of the bag with the same probability as every other one." 1800.0
                                                145D "Lucky Pair" "combinatorics,data structures,implementation" "Petya loves lucky numbers very much. Everybody knows that lucky numbers are positive integers whose decimal record contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya has an array a of n integers. The numbers in the array are numbered starting from 1. Unfortunately, Petya has been misbehaving and so, his parents don\'t allow him play with arrays that have many lucky numbers. It is guaranteed that no more than 1000 elements in the array a are lucky numbers. Petya needs to find the number of pairs of non-intersecting segments [l1;r1] and [l2;r2] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1\xe2\x80\x89<\xe2\x80\x89l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, all four numbers are integers) such that there\'s no such lucky number that occurs simultaneously in the subarray a[l1..r1] and in the subarray a[l2..r2]. Help Petya count the number of such pairs." 2900.0
                                                145C "Lucky Subsequence" combinatorics,dp,math "Petya loves lucky numbers very much. Everybody knows that lucky numbers are positive integers whose decimal record contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya has sequence a consisting of n integers.The subsequence of the sequence a is such subsequence that can be obtained from a by removing zero or more of its elements.Two sequences are considered different if index sets of numbers included in them are different. That is, the values \xe2\x80\x8bof the elements \xe2\x80\x8bdo not matter in the comparison of subsequences. In particular, any sequence of length n has exactly 2n different subsequences (including an empty subsequence).A subsequence is considered lucky if it has a length exactly k and does not contain two identical lucky numbers (unlucky numbers can be repeated any number of times).Help Petya find the number of different lucky subsequences of the sequence a. As Petya\'s parents don\'t let him play with large numbers, you should print the result modulo prime number 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2100.0
                                                141B Hopscotch geometry,math "So nearly half of the winter is over and Maria is dreaming about summer. She\'s fed up with skates and sleds, she was dreaming about Hopscotch all night long. It\'s a very popular children\'s game. The game field, the court, looks as is shown in the figure (all blocks are square and are numbered from bottom to top, blocks in the same row are numbered from left to right). Let us describe the hopscotch with numbers that denote the number of squares in the row, staring from the lowest one: 1-1-2-1-2-1-2-(1-2)..., where then the period is repeated (1-2).  The coordinate system is defined as shown in the figure. Side of all the squares are equal and have length a.Maria is a very smart and clever girl, and she is concerned with quite serious issues: if she throws a stone into a point with coordinates (x,\xe2\x80\x89y), then will she hit some square? If the answer is positive, you are also required to determine the number of the square.It is believed that the stone has fallen into the square if it is located strictly inside it. In other words a stone that has fallen on the square border is not considered a to hit a square." 1400.0
                                                140C "New Year Snowmen" "binary search,data structures,greedy" "As meticulous Gerald sets the table and caring Alexander sends the postcards, Sergey makes snowmen. Each showman should consist of three snowballs: a big one, a medium one and a small one. Sergey\'s twins help him: they\'ve already made n snowballs with radii equal to r1, r2, ..., rn. To make a snowman, one needs any three snowballs whose radii are pairwise different. For example, the balls with radii 1, 2 and 3 can be used to make a snowman but 2, 2, 3 or 2, 2, 2 cannot. Help Sergey and his twins to determine what maximum number of snowmen they can make from those snowballs." 1800.0
                                                137B Permutation greedy """Hey, it\'s homework time"" \xe2\x80\x94 thought Polycarpus and of course he started with his favourite subject, IT. Polycarpus managed to solve all tasks but for the last one in 20 minutes. However, as he failed to solve the last task after some considerable time, the boy asked you to help him.The sequence of n integers is called a permutation if it contains all integers from 1 to n exactly once.You are given an arbitrary sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an containing n integers. Each integer is not less than 1 and not greater than 5000. Determine what minimum number of elements Polycarpus needs to change to get a permutation (he should not delete or add numbers). In a single change he can modify any single sequence element (i. e. replace it with another integer)." 1000.0
                                                137A "Postcards and photos" implementation "Polycarpus has postcards and photos hung in a row on the wall. He decided to put them away to the closet and hang on the wall a famous painter\'s picture. Polycarpus does it like that: he goes from the left to the right and removes the objects consecutively. As Polycarpus doesn\'t want any mix-ups to happen, he will not carry in his hands objects of two different types. In other words, Polycarpus can\'t carry both postcards and photos simultaneously. Sometimes he goes to the closet and puts the objects there, thus leaving his hands free. Polycarpus must put all the postcards and photos to the closet. He cannot skip objects. What minimum number of times he should visit the closet if he cannot carry more than 5 items?" 900.0
                                                132D "Constants in the language of Shakespeare" "constructive algorithms,dp,greedy" "Shakespeare is a widely known esoteric programming language in which programs look like plays by Shakespeare, and numbers are given by combinations of ornate epithets. In this problem we will have a closer look at the way the numbers are described in Shakespeare.Each constant in Shakespeare is created from non-negative powers of 2 using arithmetic operations. For simplicity we\'ll allow only addition and subtraction and will look for a representation of the given number which requires a minimal number of operations.You are given an integer n. You have to represent it as n\xe2\x80\x89=\xe2\x80\x89a1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89am, where each of ai is a non-negative power of 2, possibly multiplied by -1. Find a representation which minimizes the value of m." 2100.0
                                                128D Numbers "constructive algorithms,implementation" "One day Anna got the following task at school: to arrange several numbers in a circle so that any two neighboring numbers differs exactly by 1. Anna was given several numbers and arranged them in a circle to fulfill the task. Then she wanted to check if she had arranged the numbers correctly, but at this point her younger sister Maria came and shuffled all numbers. Anna got sick with anger but what\'s done is done and the results of her work had been destroyed. But please tell Anna: could she have hypothetically completed the task using all those given numbers?" 2000.0
                                                124B Permutations "brute force,combinatorics,implementation" "You are given n k-digit integers. You have to rearrange the digits in the integers so that the difference between the largest and the smallest number was minimum. Digits should be rearranged by the same rule in all integers." 1400.0
                                                124A "The number of positions" math "Petr stands in line of n people, but he doesn\'t know exactly which position he occupies. He can say that there are no less than a people standing in front of him and no more than b people standing behind him. Find the number of different positions Petr can occupy." 1000.0
                                                120I "Luck is in Numbers" greedy "Vasya has been collecting transport tickets for quite a while now. His collection contains several thousands of tram, trolleybus and bus tickets. Vasya is already fed up with the traditional definition of what a lucky ticket is. Thus, he\'s looking for new perspectives on that. Besides, Vasya cannot understand why all tickets are only divided into lucky and unlucky ones. He thinks that all tickets are lucky but in different degrees. Having given the matter some thought, Vasya worked out the definition of a ticket\'s degree of luckiness. Let a ticket consist of 2n digits. Let\'s regard each digit as written as is shown on the picture:  You have seen such digits on electronic clocks: seven segments are used to show digits. Each segment can either be colored or not. The colored segments form a digit. Vasya regards the digits as written in this very way and takes the right half of the ticket and puts it one the left one, so that the first digit coincides with the n\xe2\x80\x89+\xe2\x80\x891-th one, the second digit coincides with the n\xe2\x80\x89+\xe2\x80\x892-th one, ..., the n-th digit coincides with the 2n-th one. For each pair of digits, put one on another, he counts the number of segments colored in both digits and summarizes the resulting numbers. The resulting value is called the degree of luckiness of a ticket. For example, the degree of luckiness of ticket 03 equals four and the degree of luckiness of ticket 2345 equals six.You are given the number of a ticket containing 2n digits. Your task is to find among the tickets whose number exceeds the number of this ticket but also consists of 2n digits such ticket, whose degree of luckiness exceeds the degrees of luckiness of the given ticket. Moreover, if there are several such tickets, you should only choose the one with the smallest number." 2200.0
                                                120B "Quiz League" implementation "A team quiz game called ""What? Where? When?"" is very popular in Berland. The game is centered on two teams competing. They are the team of six Experts versus the team of the Audience. A person from the audience asks a question and the experts are allowed a minute on brainstorming and finding the right answer to the question. All it takes to answer a typical question is general knowledge and common logic. The question sent be the audience are in envelops lain out in a circle on a round table. Each envelop is marked by the name of the asker\'s town. Each question is positioned in a separate sector. In the centre of the table is a spinning arrow. Thus, the table rather resembles a roulette table with no ball but with a spinning arrow instead. The host sets off the spinning arrow to choose a question for the experts: when the arrow stops spinning, the question it is pointing at is chosen. If the arrow points at the question that has already been asked, the host chooses the next unanswered question in the clockwise direction. Your task is to determine which will be the number of the next asked question if the arrow points at sector number k." 1100.0
                                                119A "Epic Game" implementation "Simon and Antisimon play a game. Initially each player receives one fixed positive integer that doesn\'t change throughout the game. Simon receives number a and Antisimon receives number b. They also have a heap of n stones. The players take turns to make a move and Simon starts. During a move a player should take from the heap the number of stones equal to the greatest common divisor of the fixed number he has received and the number of stones left in the heap. A player loses when he cannot take the required number of stones (i. e. the heap has strictly less stones left than one needs to take). Your task is to determine by the given a, b and n who wins the game." 800.0
                                                117D "Not Quick Transformation" "divide and conquer,math" "Let a be an array consisting of n numbers. The array\'s elements are numbered from 1 to n, even is an array consisting of the numerals whose numbers are even in a (eveni\xe2\x80\x89=\xe2\x80\x89a2i, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), odd is an array consisting of the numberals whose numbers are odd in \xd0\xb0 (oddi\xe2\x80\x89=\xe2\x80\x89a2i\xe2\x80\x89-\xe2\x80\x891, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Then let\'s define the transformation of array F(a) in the following manner:  if n\xe2\x80\x89>\xe2\x80\x891, F(a)\xe2\x80\x89=\xe2\x80\x89F(odd)\xe2\x80\x89+\xe2\x80\x89F(even), where operation ""\xe2\x80\x89+\xe2\x80\x89"" stands for the arrays\' concatenation (joining together)  if n\xe2\x80\x89=\xe2\x80\x891, F(a)\xe2\x80\x89=\xe2\x80\x89a Let a be an array consisting of n numbers 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n. Then b is the result of applying the transformation to the array a (so b\xe2\x80\x89=\xe2\x80\x89F(a)). You are given m queries (l,\xe2\x80\x89r,\xe2\x80\x89u,\xe2\x80\x89v). Your task is to find for each query the sum of numbers bi, such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and u\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v. You should print the query results modulo mod." 2500.0
                                                117B "Very Interesting Game" "brute force,number theory" "In a very ancient country the following game was popular. Two people play the game. Initially first player writes a string s1, consisting of exactly nine digits and representing a number that does not exceed a. After that second player looks at s1 and writes a string s2, consisting of exactly nine digits and representing a number that does not exceed b. Here a and b are some given constants, s1 and s2 are chosen by the players. The strings are allowed to contain leading zeroes.If a number obtained by the concatenation (joining together) of strings s1 and s2 is divisible by mod, then the second player wins. Otherwise the first player wins. You are given numbers a, b, mod. Your task is to determine who wins if both players play in the optimal manner. If the first player wins, you are also required to find the lexicographically minimum winning move." 1800.0
                                                113E Sleeping combinatorics,implementation,math "One day Vasya was lying in bed watching his electronic clock to fall asleep quicker.Vasya lives in a strange country, where days have h hours, and every hour has m minutes. Clock shows time in decimal number system, in format H:M, where the string H always has a fixed length equal to the number of digits in the decimal representation of number h\xe2\x80\x89-\xe2\x80\x891. To achieve this, leading zeros are added if necessary. The string M has a similar format, and its length is always equal to the number of digits in the decimal representation of number m\xe2\x80\x89-\xe2\x80\x891. For example, if h\xe2\x80\x89=\xe2\x80\x8917, m\xe2\x80\x89=\xe2\x80\x891000, then time equal to 13 hours and 75 minutes will be displayed as ""13:075"".Vasya had been watching the clock from h1 hours m1 minutes to h2 hours m2 minutes inclusive, and then he fell asleep. Now he asks you to count how many times he saw the moment at which at least k digits changed on the clock simultaneously.For example, when switching 04:19 \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 04:20 two digits change. When switching 23:59 \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 00:00, four digits change.Consider that Vasya has been watching the clock for strictly less than one day. Note that the last time Vasya saw on the clock before falling asleep was ""h2:m2"". That is, Vasya didn\'t see the moment at which time ""h2:m2"" switched to the next value." 2700.0
                                                113D Museum math,matrices,probabilities "One day as Petya and his friend Vasya were having one of their numerous trips, they decided to visit a museum castle. The museum has a specific shape: it consists of n rooms connected with m corridors so that one can access any room from any other one.After the two friends had a little walk around the museum, they decided to split and watch the pieces of art each of them found interesting. They agreed to meet in one of the rooms at six p.m. However, they forgot one quite essential thing: they didn\'t specify the place to meet and when the time came, they started to rush about the museum looking for each other (they couldn\'t call each other as roaming made a call\'s cost skyrocket).Yet, even despite the whole rush, they couldn\'t get enough of the pieces of art, that\'s why each of them has the following strategy: each minute he make a decision where to go \xe2\x80\x94 with probability pi he doesn\'t move to any other place during this minute (i.e. he stays in the room). With probability 1\xe2\x80\x89-\xe2\x80\x89pi he equiprobably choose one of the adjacent rooms and went there along the corridor. Here i is the ordinal number of the current room. Building was expensive in ancient times, that\'s why each corridor connected two different rooms, and any two rooms had no more than one corridor between them. The boys act simultaneously. As the corridors are dark, it is impossible to meet there; however, one can walk along the corridors in both directions (besides, the two boys can be going through the same corridor simultaneously without meeting). The boys act like that until they meet each other. More formally, the two friends meet when at some moment of time both of them decided to appear in the same room.For each room find the probability that the boys will meet there considering that at 6 p.m. they are positioned in rooms a and b correspondingly." 2700.0
                                                113C "Double Happiness" "brute force,math,number theory" "On the math lesson a teacher asked each pupil to come up with his own lucky numbers. As a fan of number theory Peter chose prime numbers. Bob was more original. He said that number t is his lucky number, if it can be represented as: t\xe2\x80\x89=\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89b2,\xe2\x80\x89 where a,\xe2\x80\x89b are arbitrary positive integers.Now, the boys decided to find out how many days of the interval [l,\xe2\x80\x89r] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are suitable for pair programming. They decided that the day i (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) is suitable for pair programming if and only if the number i is lucky for Peter and lucky for Bob at the same time. Help the boys to find the number of such days." 2200.0
                                                111D "Petya and Coloring" combinatorics,dp "Little Petya loves counting. He wants to count the number of ways to paint a rectangular checkered board of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m (n rows, m columns) in k colors. Besides, the coloring should have the following property: for any vertical line that passes along the grid lines and divides the board in two non-empty parts the number of distinct colors in both these parts should be the same. Help Petya to count these colorings." 2300.0
                                                111B "Petya and Divisors" "binary search,data structures,number theory" "Little Petya loves looking for numbers\' divisors. One day Petya came across the following problem:You are given n queries in the form ""xi yi"". For each query Petya should count how many divisors of number xi divide none of the numbers xi\xe2\x80\x89-\xe2\x80\x89yi,\xe2\x80\x89xi\xe2\x80\x89-\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89xi\xe2\x80\x89-\xe2\x80\x891. Help him." 1900.0
                                                108A "Palindromic Times" implementation,strings "Tattah is asleep if and only if Tattah is attending a lecture. This is a well-known formula among Tattah\'s colleagues.On a Wednesday afternoon, Tattah was attending Professor HH\'s lecture. At 12:21, right before falling asleep, he was staring at the digital watch around Saher\'s wrist. He noticed that the digits on the clock were the same when read from both directions i.e. a palindrome.In his sleep, he started dreaming about such rare moments of the day when the time displayed on a digital clock is a palindrome. As soon as he woke up, he felt destined to write a program that finds the next such moment.However, he still hasn\'t mastered the skill of programming while sleeping, so your task is to help him." 1000.0
                                                106E "Space Rescuers" "geometry,ternary search" "The Galaxy contains n planets, there are many different living creatures inhabiting each planet. And each creature can get into troubles! Space rescuers know it perfectly well and they are always ready to help anyone who really needs help. All you need to do is call for them. Now the space rescuers plan to build the largest in the history of the Galaxy rescue station; however, the rescue station\'s location is yet to be determined. As some cases are real emergencies, the rescuers want to find such a point in the Galaxy from which it would be possible to get to the remotest planet in the minimum possible time. In other words, the rescuers need such point in the space that the distance between it and the planet remotest from it was minimal (if we compare this point with all other possible points in the space). Unfortunately, the rescuers can\'t sole this problem.As the planets are quite remote from each other, they can be considered as points in Euclidean three-dimensional space. The distance between points (xi,\xe2\x80\x89yi,\xe2\x80\x89zi) and (xj,\xe2\x80\x89yj,\xe2\x80\x89zj) can be calculated by the formula . The rescue station can be positioned in any point in the space. It can also coincide with some planet. Galaxy is in danger! Save the space rescuers and find the required point for them." 2100.0
                                                106D "Treasure Island" "brute force,implementation" "Our brave travelers reached an island where pirates had buried treasure. However as the ship was about to moor, the captain found out that some rat ate a piece of the treasure map.The treasure map can be represented as a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size. Each cell stands for an islands\' square (the square\'s side length equals to a mile). Some cells stand for the sea and they are impenetrable. All other cells are penetrable (i.e. available) and some of them contain local sights. For example, the large tree on the hills or the cave in the rocks.Besides, the map also has a set of k instructions. Each instruction is in the following form:""Walk n miles in the y direction""The possible directions are: north, south, east, and west. If you follow these instructions carefully (you should fulfill all of them, one by one) then you should reach exactly the place where treasures are buried. Unfortunately the captain doesn\'t know the place where to start fulfilling the instructions \xe2\x80\x94 as that very piece of the map was lost. But the captain very well remembers that the place contained some local sight. Besides, the captain knows that the whole way goes through the island\'s penetrable squares.The captain wants to know which sights are worth checking. He asks you to help him with that." 1700.0
                                                106C Buns dp "Lavrenty, a baker, is going to make several buns with stuffings and sell them.Lavrenty has n grams of dough as well as m different stuffing types. The stuffing types are numerated from 1 to m. Lavrenty knows that he has ai grams left of the i-th stuffing. It takes exactly bi grams of stuffing i and ci grams of dough to cook a bun with the i-th stuffing. Such bun can be sold for di tugriks.Also he can make buns without stuffings. Each of such buns requires c0 grams of dough and it can be sold for d0 tugriks. So Lavrenty can cook any number of buns with different stuffings or without it unless he runs out of dough and the stuffings. Lavrenty throws away all excess material left after baking.Find the maximum number of tugriks Lavrenty can earn." 1700.0
                                                102A Clothes "brute force" "A little boy Gerald entered a clothes shop and found out something very unpleasant: not all clothes turns out to match. For example, Gerald noticed that he looks rather ridiculous in a smoking suit and a baseball cap.Overall the shop sells n clothing items, and exactly m pairs of clothing items match. Each item has its price, represented by an integer number of rubles. Gerald wants to buy three clothing items so that they matched each other. Besides, he wants to spend as little money as possible. Find the least possible sum he can spend." 1200.0
                                                101E "Candies and Stones" "divide and conquer,dp" "Little Gerald and his coach Mike play an interesting game. At the beginning of the game there is a pile consisting of n candies and a pile consisting of m stones. Gerald and Mike move in turns, Mike goes first. During his move Mike checks how many candies and stones Gerald has eaten. Let Gerald eat a candies and b stones. Then Mike awards Gerald f(a,\xe2\x80\x89b) prize points. Gerald during his move either eats a candy from the pile of candies or a stone from the pile of stones. As Mike sees that Gerald has eaten everything apart one candy and one stone, he awards points for the last time and the game ends. Gerald is not allowed to eat all the candies, and he is not allowed to eat all the stones too. Tell Gerald how to play to get the largest possible number of points: it is required to find one of the possible optimal playing strategies for Gerald." 2500.0
                                                101A Homework greedy "Once when Gerald studied in the first year at school, his teacher gave the class the following homework. She offered the students a string consisting of n small Latin letters; the task was to learn the way the letters that the string contains are written. However, as Gerald is too lazy, he has no desire whatsoever to learn those letters. That\'s why he decided to lose some part of the string (not necessarily a connected part). The lost part can consist of any number of segments of any length, at any distance from each other. However, Gerald knows that if he loses more than k characters, it will be very suspicious. Find the least number of distinct characters that can remain in the string after no more than k characters are deleted. You also have to find any possible way to delete the characters." 1200.0
                                                99A "Help Far Away Kingdom" strings "In a far away kingdom lived the King, the Prince, the Shoemaker, the Dressmaker and many other citizens. They lived happily until great trouble came into the Kingdom. The ACMers settled there.Most damage those strange creatures inflicted upon the kingdom was that they loved high precision numbers. As a result, the Kingdom healers had already had three appointments with the merchants who were asked to sell, say, exactly 0.273549107 beer barrels. To deal with the problem somehow, the King issued an order obliging rounding up all numbers to the closest integer to simplify calculations. Specifically, the order went like this: If a number\'s integer part does not end with digit 9 and its fractional part is strictly less than 0.5, then the rounded up number coincides with the number\xe2\x80\x99s integer part.  If a number\'s integer part does not end with digit 9 and its fractional part is not less than 0.5, the rounded up number is obtained if we add 1 to the last digit of the number\xe2\x80\x99s integer part. If the number\xe2\x80\x99s integer part ends with digit 9, to round up the numbers one should go to Vasilisa the Wise. In the whole Kingdom she is the only one who can perform the tricky operation of carrying into the next position. Merchants found the algorithm very sophisticated and they asked you (the ACMers) to help them. Can you write a program that would perform the rounding according to the King\xe2\x80\x99s order?" 800.0
                                                94B Friends graphs,implementation,math "One day Igor K. stopped programming and took up math. One late autumn evening he was sitting at a table reading a book and thinking about something. The following statement caught his attention: ""Among any six people there are either three pairwise acquainted people or three pairwise unacquainted people""Igor just couldn\'t get why the required minimum is 6 people. ""Well, that\'s the same for five people, too!"" \xe2\x80\x94 he kept on repeating in his mind. \xe2\x80\x94 ""Let\'s take, say, Max, Ilya, Vova \xe2\x80\x94 here, they all know each other! And now let\'s add Dima and Oleg to Vova \xe2\x80\x94 none of them is acquainted with each other! Now, that math is just rubbish!""Igor K. took 5 friends of his and wrote down who of them is friends with whom. Now he wants to check whether it is true for the five people that among them there are either three pairwise acquainted or three pairwise not acquainted people." 1300.0
                                                89B "Widget Library" "dp,expression parsing,graphs,implementation" "Vasya writes his own library for building graphical user interface. Vasya called his creation VTK (VasyaToolKit). One of the interesting aspects of this library is that widgets are packed in each other. A widget is some element of graphical interface. Each widget has width and height, and occupies some rectangle on the screen. Any widget in Vasya\'s library is of type Widget. For simplicity we will identify the widget and its type. Types HBox and VBox are derivatives of type Widget, so they also are types Widget. Widgets HBox and VBox are special. They can store other widgets. Both those widgets can use the pack() method to pack directly in itself some other widget. Widgets of types HBox and VBox can store several other widgets, even several equal widgets \xe2\x80\x94 they will simply appear several times. As a result of using the method pack() only the link to the packed widget is saved, that is when the packed widget is changed, its image in the widget, into which it is packed, will also change. We shall assume that the widget a is packed in the widget b if there exists a chain of widgets a\xe2\x80\x89=\xe2\x80\x89c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89ck\xe2\x80\x89=\xe2\x80\x89b, k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892, for which ci is packed directly to ci\xe2\x80\x89+\xe2\x80\x891 for any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k. In Vasya\'s library the situation when the widget a is packed in the widget a (that is, in itself) is not allowed. If you try to pack the widgets into each other in this manner immediately results in an error.Also, the widgets HBox and VBox have parameters border and spacing, which are determined by the methods set_border() and set_spacing() respectively. By default both of these options equal 0.    The picture above shows how the widgets are packed into HBox and VBox. At that HBox and VBox automatically change their size depending on the size of packed widgets. As for HBox and VBox, they only differ in that in HBox the widgets are packed horizontally and in VBox \xe2\x80\x94 vertically. The parameter spacing sets the distance between adjacent widgets, and border \xe2\x80\x94 a frame around all packed widgets of the desired width. Packed widgets are placed exactly in the order in which the pack() method was called for them. If within HBox or VBox there are no packed widgets, their sizes are equal to 0\xe2\x80\x89\xc3\x97\xe2\x80\x890, regardless of the options border and spacing. The construction of all the widgets is performed using a scripting language VasyaScript. The description of the language can be found in the input data. For the final verification of the code Vasya asks you to write a program that calculates the sizes of all the widgets on the source code in the language of VasyaScript." 2300.0
                                                88B Keyboard implementation "Vasya learns to type. He has an unusual keyboard at his disposal: it is rectangular and it has n rows of keys containing m keys in each row. Besides, the keys are of two types. Some of the keys have lowercase Latin letters on them and some of the keys work like the ""Shift"" key on standard keyboards, that is, they make lowercase letters uppercase.Vasya can press one or two keys with one hand. However, he can only press two keys if the Euclidean distance between the centers of the keys does not exceed x. The keys are considered as squares with a side equal to 1. There are no empty spaces between neighbouring keys.Vasya is a very lazy boy, that\'s why he tries to type with one hand as he eats chips with his other one. However, it is possible that some symbol can\'t be typed with one hand only, because the distance between it and the closest ""Shift"" key is strictly larger than x. In this case he will have to use his other hand. Having typed the symbol, Vasya returns other hand back to the chips.You are given Vasya\'s keyboard and the text. Count the minimum number of times Vasya will have to use the other hand." 1500.0
                                                87C "Interesting Game" dp,games,math "Two best friends Serozha and Gena play a game.Initially there is one pile consisting of n stones on the table. During one move one pile should be taken and divided into an arbitrary number of piles consisting of a1\xe2\x80\x89>\xe2\x80\x89a2\xe2\x80\x89>\xe2\x80\x89...\xe2\x80\x89>\xe2\x80\x89ak\xe2\x80\x89>\xe2\x80\x890 stones. The piles should meet the condition a1\xe2\x80\x89-\xe2\x80\x89a2\xe2\x80\x89=\xe2\x80\x89a2\xe2\x80\x89-\xe2\x80\x89a3\xe2\x80\x89=\xe2\x80\x89...\xe2\x80\x89=\xe2\x80\x89ak\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89ak\xe2\x80\x89=\xe2\x80\x891. Naturally, the number of piles k should be no less than two.The friends play in turns. The player who cannot make a move loses. Serozha makes the first move. Who will win if both players play in the optimal way?" 2000.0
                                                86E "Long sequence" "brute force,math,matrices" "A sequence a0,\xe2\x80\x89a1,\xe2\x80\x89... is called a recurrent binary sequence, if each term ai (i\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x89...) is equal to 0 or 1 and there exist coefficients  such that an\xe2\x80\x89=\xe2\x80\x89c1\xc2\xb7an\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89c2\xc2\xb7an\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ck\xc2\xb7an\xe2\x80\x89-\xe2\x80\x89k (mod 2),\xe2\x80\x89 for all n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89k. Assume that not all of ci are zeros.Note that such a sequence can be uniquely recovered from any k-tuple {as,\xe2\x80\x89as\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89as\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891} and so it is periodic. Moreover, if a k-tuple contains only zeros, then the sequence contains only zeros, so this case is not very interesting. Otherwise the minimal period of the sequence is not greater than 2k\xe2\x80\x89-\xe2\x80\x891, as k-tuple determines next element, and there are 2k\xe2\x80\x89-\xe2\x80\x891 non-zero k-tuples. Let us call a sequence long if its minimal period is exactly 2k\xe2\x80\x89-\xe2\x80\x891. Your task is to find a long sequence for a given k, if there is any." 2700.0
                                                86D "Powerful array" "data structures,implementation,math,two pointers" "An array of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is given. Let us consider its arbitrary subarray al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891...,\xe2\x80\x89ar, where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. For every positive integer s denote by Ks the number of occurrences of s into the subarray. We call the power of the subarray the sum of products Ks\xc2\xb7Ks\xc2\xb7s for every positive integer s. The sum contains only finite number of nonzero summands as the number of different values in the array is indeed finite.You should calculate the power of t given subarrays." 2200.0
                                                86C "Genetic engineering" "dp,string suffix structures,trees" """Multidimensional spaces are completely out of style these days, unlike genetics problems"" \xe2\x80\x94 thought physicist Woll and changed his subject of study to bioinformatics. Analysing results of sequencing he faced the following problem concerning DNA sequences. We will further think of a DNA sequence as an arbitrary string of uppercase letters ""A"", ""C"", ""G"" and ""T"" (of course, this is a simplified interpretation).Let w be a long DNA sequence and s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sm \xe2\x80\x94 collection of short DNA sequences. Let us say that the collection filters w iff w can be covered with the sequences from the collection. Certainly, substrings corresponding to the different positions of the string may intersect or even cover each other. More formally: denote by |w| the length of w, let symbols of w be numbered from 1 to |w|. Then for each position i in w there exist pair of indices l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|w|) such that the substring w[l ... r] equals one of the elements s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sm of the collection.Woll wants to calculate the number of DNA sequences of a given length filtered by a given collection, but he doesn\'t know how to deal with it. Help him! Your task is to find the number of different DNA sequences of length n filtered by the collection {si}.Answer may appear very large, so output it modulo 1000000009." 2500.0
                                                82E Corridor geometry "Consider a house plan. Let the house be represented by an infinite horizontal strip defined by the inequality \xe2\x80\x89-\xe2\x80\x89h\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89h. Strictly outside the house there are two light sources at the points (0,\xe2\x80\x89f) and (0,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89f). Windows are located in the walls, the windows are represented by segments on the lines y\xe2\x80\x89=\xe2\x80\x89h and y\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89h. Also, the windows are arranged symmetrically about the line y\xe2\x80\x89=\xe2\x80\x890.Your task is to find the area of the floor at the home, which will be lighted by the sources of light." 2600.0
                                                82C "General Mobilization" "data structures,dfs and similar,sortings" "The Berland Kingdom is a set of n cities connected with each other with n\xe2\x80\x89-\xe2\x80\x891 railways. Each road connects exactly two different cities. The capital is located in city 1. For each city there is a way to get from there to the capital by rail.In the i-th city there is a soldier division number i, each division is characterized by a number of ai. It represents the priority, the smaller the number, the higher the priority of this division. All values of ai are different.One day the Berland King Berl Great declared a general mobilization, and for that, each division should arrive in the capital. Every day from every city except the capital a train departs. So there are exactly n\xe2\x80\x89-\xe2\x80\x891 departing trains each day. Each train moves toward the capital and finishes movement on the opposite endpoint of the railway on the next day. It has some finite capacity of cj, expressed in the maximum number of divisions, which this train can transport in one go. Each train moves in the direction of reducing the distance to the capital. So each train passes exactly one railway moving from a city to the neighboring (where it stops) toward the capital.In the first place among the divisions that are in the city, division with the smallest number of ai get on the train, then with the next smallest and so on, until either the train is full or all the divisions are be loaded. So it is possible for a division to stay in a city for a several days.The duration of train\'s progress from one city to another is always equal to 1 day. All divisions start moving at the same time and end up in the capital, from where they don\'t go anywhere else any more. Each division moves along a simple path from its city to the capital, regardless of how much time this journey will take.Your goal is to find for each division, in how many days it will arrive to the capital of Berland. The countdown begins from day 0." 2000.0
                                                81C "Average Score" greedy,math,sortings "After the educational reform Polycarp studies only two subjects at school, Safety Studies and PE (Physical Education). During the long months of the fourth term, he received n marks in them. When teachers wrote a mark in the journal, they didn\'t write in what subject the mark was for, they just wrote the mark.Now it\'s time to show the journal to his strict parents. Polycarp knows that recently at the Parent Meeting the parents were told that he received a Safety Studies marks and b PE marks (a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89=\xe2\x80\x89n). Now Polycarp wants to write a subject\'s name in front of each mark so that:   there are exactly a Safety Studies marks,  there are exactly b PE marks,  the total average score in both subjects is maximum. An average subject grade is the sum of all marks in it, divided by the number of them. Of course, the division is performed in real numbers without rounding up or down. Polycarp aims to maximize the x1\xe2\x80\x89+\xe2\x80\x89x2, where x1 is the average score in the first subject (Safety Studies), and x2 is the average score in the second one (Physical Education)." 1700.0
                                                80A "Panoramix\'s Prediction" "brute force" "A prime number is a number which has exactly two distinct divisors: one and itself. For example, numbers 2, 7, 3 are prime, and 1, 6, 4 are not.The next prime number after x is the smallest prime number greater than x. For example, the next prime number after 2 is 3, and the next prime number after 3 is 5. Note that there is exactly one next prime number after each number. So 5 is not the next prime number for 2.One cold April morning Panoramix predicted that soon Kakofonix will break free from his straitjacket, and this will be a black day for the residents of the Gallic countryside.Panoramix\'s prophecy tells that if some day Asterix and Obelix beat exactly x Roman soldiers, where x is a prime number, and next day they beat exactly y Roman soldiers, where y is the next prime number after x, then it\'s time to wait for Armageddon, for nothing can shut Kakofonix up while he sings his infernal song.Yesterday the Gauls beat n Roman soldiers and it turned out that the number n was prime! Today their victims were a troop of m Romans (m\xe2\x80\x89>\xe2\x80\x89n). Determine whether the Gauls should wait for the black day after today\'s victory of Asterix and Obelix?" 800.0
                                                78B "Easter Eggs" "constructive algorithms,implementation" "The Easter Rabbit laid n eggs in a circle and is about to paint them. Each egg should be painted one color out of 7: red, orange, yellow, green, blue, indigo or violet. Also, the following conditions should be satisfied:  Each of the seven colors should be used to paint at least one egg.  Any four eggs lying sequentially should be painted different colors. Help the Easter Rabbit paint the eggs in the required manner. We know that it is always possible." 1200.0
                                                76D "Plus and xor" dp,greedy,math "Bitwise exclusive OR (or bitwise addition modulo two) is a binary operation which is equivalent to applying logical exclusive OR to every pair of bits located on the same positions in binary notation of operands. In other words, a binary digit of the result is equal to 1 if and only if bits on the respective positions in the operands are different.For example, if X\xe2\x80\x89=\xe2\x80\x8910910\xe2\x80\x89=\xe2\x80\x8911011012, Y\xe2\x80\x89=\xe2\x80\x894110\xe2\x80\x89=\xe2\x80\x891010012, then:  X xor Y \xe2\x80\x89=\xe2\x80\x89 6810 \xe2\x80\x89=\xe2\x80\x89 10001002. Write a program, which takes two non-negative integers A and B as an input and finds two non-negative integers X and Y, which satisfy the following conditions:   A\xe2\x80\x89=\xe2\x80\x89X\xe2\x80\x89+\xe2\x80\x89Y  B \xe2\x80\x89=\xe2\x80\x89 X xor Y, where xor is bitwise exclusive or.  X is the smallest number among all numbers for which the first two conditions are true." 1700.0
                                                75B "Facetook Priority Wall" "expression parsing,implementation,strings" "Facetook is a well known social network website, and it will launch a new feature called Facetook Priority Wall. This feature will sort all posts from your friends according to the priority factor (it will be described).This priority factor will be affected by three types of actions:   1. ""X posted on Y\'s wall"" (15 points),  2. ""X commented on Y\'s post"" (10 points),  3. ""X likes Y\'s post"" (5 points). X and Y will be two distinct names. And each action will increase the priority factor between X and Y (and vice versa) by the above value of points (the priority factor between X and Y is the same as the priority factor between Y and X).You will be given n actions with the above format (without the action number and the number of points), and you have to print all the distinct names in these actions sorted according to the priority factor with you." 1500.0
                                                72I "Goofy Numbers" "*special problem,implementation" "The non-negative integer a is a divisor of the non-negative integer b if and only if there exists a positive integer c such that a\xe2\x80\x89\xc3\x97\xe2\x80\x89c\xe2\x80\x89=\xe2\x80\x89b. Some numbers are really interesting. Commander Surena defines some interesting properties for non-negative integers:  An integer is happy if it is divisible by at least one of its digits and not by all of them.  An integer is happier if it is divisible by all of its digits.  An integer is upset if it\'s divisible by none of its digits. Surena asks you to find out if a given number is happy, happier or upset." 1500.0
                                                72G "Fibonacci army" "*special problem,dp" "King Cambyses loves Fibonacci numbers. He has several armies. Today he wants to make a new army for himself and he wants the number of men in this army to be the n-th Fibonacci number.Given n you should find n-th Fibonacci number. The set of Fibonacci numbers start with f0\xe2\x80\x89=\xe2\x80\x89f1\xe2\x80\x89=\xe2\x80\x891 and for each i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892, fi\xe2\x80\x89=\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x892." 1000.0
                                                72B INI-file "*special problem,implementation" "The INI file format is a de facto standard for configuration files. INI files are simple text files with a basic structure. They are commonly associated with Microsoft Windows, but are also used on other platforms.Each line in INI-file stands for key-value mapping or defines new section. A key-value line has a format ""key=value"",where key \xe2\x80\x94 is the name of some property, and value \xe2\x80\x94 it\'s value. It is possible that it will be spaces from the both sides of key and/or value, the spaces should be ignored.A section line has a format ""[section]"". It means that all key-value lines after it define properties of the specified section. Of cause, the following section line changes the current section. A section line may have spaces around any of brackets.Also you should ignore comment lines \xe2\x80\x94 the first non-space character of comment line is "";"".You task is to write the program which will format given INI-file in a special way:   first, print key-value lines which do not belong to any section;  print all the sections in the lexicographical (alphabetical) order of their names;  inside each of two previous items, order key-value lines lexicographically by ""key"";  if there are more than one key-value lines with the same key inside a single section (or outside any sections), leave only one line (which appears later in the input data);  remove all redundant spaces and lines." 2200.0
                                                71C "Round Table Knights" "dp,math,number theory" "There are n knights sitting at the Round Table at an equal distance from each other. Each of them is either in a good or in a bad mood.Merlin, the wizard predicted to King Arthur that the next month will turn out to be particularly fortunate if the regular polygon can be found. On all vertices of the polygon knights in a good mood should be located. Otherwise, the next month will bring misfortunes.A convex polygon is regular if all its sides have same length and all his angles are equal. In this problem we consider only regular polygons with at least 3 vertices, i. e. only nondegenerated.On a picture below some examples of such polygons are present. Green points mean knights in a good mood. Red points mean ones in a bad mood.  King Arthur knows the knights\' moods. Help him find out if the next month will be fortunate or not." 1600.0
                                                69E Subsegments "data structures,implementation" "Programmer Sasha has recently begun to study data structures. His coach Stas told him to solve the problem of finding a minimum on the segment of the array in , which Sasha coped with. For Sasha not to think that he had learned all, Stas gave him a new task. For each segment of the fixed length Sasha must find the maximum element of those that occur on the given segment exactly once. Help Sasha solve this problem." 1800.0
                                                66D "Petya and His Friends" "constructive algorithms,math,number theory" "Little Petya has a birthday soon. Due this wonderful event, Petya\'s friends decided to give him sweets. The total number of Petya\'s friends equals to n.Let us remind you the definition of the greatest common divisor: GCD(a1,\xe2\x80\x89...,\xe2\x80\x89ak)\xe2\x80\x89=\xe2\x80\x89d, where d represents such a maximal positive number that each ai (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) is evenly divisible by d. At that, we assume that all ai\'s are greater than zero.Knowing that Petya is keen on programming, his friends has agreed beforehand that the 1-st friend gives a1 sweets, the 2-nd one gives a2 sweets, ..., the n-th one gives an sweets. At the same time, for any i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) they want the GCD(ai,\xe2\x80\x89aj) not to be equal to 1. However, they also want the following condition to be satisfied: GCD(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an)\xe2\x80\x89=\xe2\x80\x891. One more: all the ai should be distinct.Help the friends to choose the suitable numbers a1,\xe2\x80\x89...,\xe2\x80\x89an." 1700.0
                                                65E "Harry Potter and Moving Staircases" "dfs and similar,implementation" "Harry Potter lost his Invisibility Cloak, running from the school caretaker Filch. Finding an invisible object is not an easy task. Fortunately, Harry has friends who are willing to help. Hermione Granger had read ""The Invisibility Cloaks, and Everything about Them"", as well as six volumes of ""The Encyclopedia of Quick Search of Shortest Paths in Graphs, Network Flows, the Maximal Increasing Subsequences and Other Magical Objects"". She has already developed a search algorithm for the invisibility cloak in complex dynamic systems (Hogwarts is one of them).Hogwarts consists of n floors, numbered by integers from 1 to n. Some pairs of floors are connected by staircases. The staircases may change its position, moving exactly one end. Formally the situation is like this: if a staircase connects the floors a and b, then in one move it may modify its position so as to connect the floors a and c or b and c, where c is any floor different from a and b. Under no circumstances the staircase can connect a floor with itself. At the same time there can be multiple stairs between a pair of floors.Initially, Harry is on the floor with the number 1. He does not remember on what floor he has lost the cloak and wants to look for it on each of the floors. Therefore, his goal is to visit each of n floors at least once. Harry can visit the floors in any order and finish the searching at any floor.Nowadays the staircases move quite rarely. However, Ron and Hermione are willing to put a spell on any of them to help Harry find the cloak. To cause less suspicion, the three friends plan to move the staircases one by one, and no more than once for each staircase. In between shifting the staircases Harry will be able to move about the floors, reachable at the moment from the staircases, and look for his Invisibility Cloak. It is assumed that during all this time the staircases will not move spontaneously.Help the three friends to compose a searching plan. If there are several variants to solve the problem, any valid option (not necessarily the optimal one) will be accepted." 2900.0
                                                61B "Hard Work" strings "After the contest in comparing numbers, Shapur\'s teacher found out that he is a real genius and that no one could possibly do the calculations faster than him even using a super computer!Some days before the contest, the teacher took a very simple-looking exam and all his n students took part in the exam. The teacher gave them 3 strings and asked them to concatenate them. Concatenating strings means to put them in some arbitrary order one after the other. For example from concatenating Alireza and Amir we can get to AlirezaAmir or AmirAlireza depending on the order of concatenation.Unfortunately enough, the teacher forgot to ask students to concatenate their strings in a pre-defined order so each student did it the way he/she liked.Now the teacher knows that Shapur is such a fast-calculating genius boy and asks him to correct the students\' papers.Shapur is not good at doing such a time-taking task. He rather likes to finish up with it as soon as possible and take his time to solve 3-SAT in polynomial time. Moreover, the teacher has given some advice that Shapur has to follow. Here\'s what the teacher said:   As I expect you know, the strings I gave to my students (including you) contained only lowercase and uppercase Persian Mikhi-Script letters. These letters are too much like Latin letters, so to make your task much harder I converted all the initial strings and all of the students\' answers to Latin.  As latin alphabet has much less characters than Mikhi-Script, I added three odd-looking characters to the answers, these include ""-"", "";"" and ""_"". These characters are my own invention of course! And I call them Signs.  The length of all initial strings was less than or equal to 100 and the lengths of my students\' answers are less than or equal to 600  My son, not all students are genius as you are. It is quite possible that they make minor mistakes changing case of some characters. For example they may write ALiReZaAmIR instead of AlirezaAmir. Don\'t be picky and ignore these mistakes.  Those signs which I previously talked to you about are not important. You can ignore them, since many students are in the mood for adding extra signs or forgetting about a sign. So something like Iran;;-- is the same as --;IRAN  You should indicate for any of my students if his answer was right or wrong. Do this by writing ""WA"" for Wrong answer or ""ACC"" for a correct answer.  I should remind you that none of the strings (initial strings or answers) are empty.  Finally, do these as soon as possible. You have less than 2 hours to complete this." 1300.0
                                                61A "Ultra-Fast Mathematician" implementation "Shapur was an extremely gifted student. He was great at everything including Combinatorics, Algebra, Number Theory, Geometry, Calculus, etc. He was not only smart but extraordinarily fast! He could manage to sum 1018 numbers in a single second.One day in 230 AD Shapur was trying to find out if any one can possibly do calculations faster than him. As a result he made a very great contest and asked every one to come and take part.In his contest he gave the contestants many different pairs of numbers. Each number is made from digits 0 or 1. The contestants should write a new number corresponding to the given pair of numbers. The rule is simple: The i-th digit of the answer is 1 if and only if the i-th digit of the two given numbers differ. In the other case the i-th digit of the answer is 0.Shapur made many numbers and first tried his own speed. He saw that he can perform these operations on numbers of length \xe2\x88\x9e (length of a number is number of digits in it) in a glance! He always gives correct answers so he expects the contestants to give correct answers, too. He is a good fellow so he won\'t give anyone very big numbers and he always gives one person numbers of same length.Now you are going to take part in Shapur\'s contest. See if you are faster and more accurate." 800.0
                                                60C "Mushroom Strife" "brute force,dfs and similar" "Pasha and Akim were making a forest map \xe2\x80\x94 the lawns were the graph\'s vertexes and the roads joining the lawns were its edges. They decided to encode the number of laughy mushrooms on every lawn in the following way: on every edge between two lawns they wrote two numbers, the greatest common divisor (GCD) and the least common multiple (LCM) of the number of mushrooms on these lawns. But one day Pasha and Akim had an argument about the laughy mushrooms and tore the map. Pasha was left with just some part of it, containing only m roads. Your task is to help Pasha \xe2\x80\x94 use the map he has to restore the number of mushrooms on every lawn. As the result is not necessarily unique, help Pasha to restore any one or report that such arrangement of mushrooms does not exist. It is guaranteed that the numbers on the roads on the initial map were no less that 1 and did not exceed 106." 2100.0
                                                59E "Shortest Path" "graphs,shortest paths" "In Ancient Berland there were n cities and m two-way roads of equal length. The cities are numbered with integers from 1 to n inclusively. According to an ancient superstition, if a traveller visits three cities ai, bi, ci in row, without visiting other cities between them, a great disaster awaits him. Overall there are k such city triplets. Each triplet is ordered, which means that, for example, you are allowed to visit the cities in the following order: ai, ci, bi. Vasya wants to get from the city 1 to the city n and not fulfil the superstition. Find out which minimal number of roads he should take. Also you are required to find one of his possible path routes." 2000.0
                                                59D "Team Arrangement" "constructive algorithms,greedy,implementation" "Recently personal training sessions have finished in the Berland State University Olympiad Programmer Training Centre. By the results of these training sessions teams are composed for the oncoming team contest season. Each team consists of three people. All the students of the Centre possess numbers from 1 to 3n, and all the teams possess numbers from 1 to n. The splitting of students into teams is performed in the following manner: while there are people who are not part of a team, a person with the best total score is chosen among them (the captain of a new team), this person chooses for himself two teammates from those who is left according to his list of priorities. The list of every person\'s priorities is represented as a permutation from the rest of 3n\xe2\x80\x89-\xe2\x80\x891 students who attend the centre, besides himself.You are given the results of personal training sessions which are a permutation of numbers from 1 to 3n, where the i-th number is the number of student who has won the i-th place. No two students share a place. You are also given the arrangement of the already formed teams in the order in which they has been created. Your task is to determine the list of priorities for the student number k. If there are several priority lists, choose the lexicographically minimal one." 2000.0
                                                59B "Fortune Telling" "implementation,number theory" "Marina loves Sasha. But she keeps wondering whether Sasha loves her. Of course, the best way to know it is fortune telling. There are many ways of telling fortune, but Marina has picked the easiest one. She takes in her hand one or several camomiles and tears off the petals one by one. After each petal she pronounces alternatively ""Loves"" and ""Doesn\'t love"", at that Marina always starts with ""Loves"". There are n camomiles growing in the field, possessing the numbers of petals equal to a1,\xe2\x80\x89a2,\xe2\x80\x89... an. Marina wants to pick a bouquet with the maximal possible total number of petals so that the result would still be ""Loves"". Help her do that; find the maximal number of petals possible in the bouquet." 1200.0
                                                55A "Flea travel" implementation,math "A flea is sitting at one of the n hassocks, arranged in a circle, at the moment. After minute number k the flea jumps through k\xe2\x80\x89-\xe2\x80\x891 hasso\xd1\x81ks (clockwise). For example, after the first minute the flea jumps to the neighboring hassock. You should answer: will the flea visit all the hassocks or not. We assume that flea has infinitely much time for this jumping." 1200.0
                                                47C Crossword implementation "Vasya trains to compose crossword puzzles. He can only compose crosswords of a very simpl\xd0\xb5 type so far. All of them consist of exactly six words; the words can be read only from top to bottom vertically and from the left to the right horizontally. The words are arranged in the form of a rectangular ""eight"" or infinity sign, not necessarily symmetrical.The top-left corner of the crossword coincides with the top-left corner of the rectangle. The same thing is correct for the right-bottom corners. The crossword can\'t degrade, i.e. it always has exactly four blank areas, two of which are surrounded by letters. Look into the output for the samples for clarification.Help Vasya \xe2\x80\x94 compose a crossword of the described type using the given six words. It is allowed to use the words in any order." 2000.0
                                                47A "Triangular numbers" "brute force,math" "A triangular number is the number of dots in an equilateral triangle uniformly filled with dots. For example, three dots can be arranged in a triangle; thus three is a triangular number. The n-th triangular number is the number of dots in a triangle with n dots on a side. . You can learn more about these numbers from Wikipedia (http://en.wikipedia.org/wiki/Triangular_number).Your task is to find out if a given integer is a triangular number." 800.0
                                                45C "Dancing Lessons" "data structures" "There are n people taking dancing lessons. Every person is characterized by his/her dancing skill ai. At the beginning of the lesson they line up from left to right. While there is at least one couple of a boy and a girl in the line, the following process is repeated: the boy and girl who stand next to each other, having the minimal difference in dancing skills start to dance. If there are several such couples, the one first from the left starts to dance. After a couple leaves to dance, the line closes again, i.e. as a result the line is always continuous. The difference in dancing skills is understood as the absolute value of difference of ai variable. Your task is to find out what pairs and in what order will start dancing." 1900.0
                                                41A Translation implementation,strings "The translation from the Berland language into the Birland language is not an easy task. Those languages are very similar: a Berlandish word differs from a Birlandish word with the same meaning a little: it is spelled (and pronounced) reversely. For example, a Berlandish word code corresponds to a Birlandish word edoc. However, making a mistake during the ""translation"" is easy. Vasya translated the word s from Berlandish into Birlandish as t. Help him: find out if he translated the word correctly." 800.0
                                                39I Tram  "In a Berland city S*** there is a tram engine house and only one tram. Three people work in the house \xe2\x80\x94 the tram driver, the conductor and the head of the engine house. The tram used to leave the engine house every morning and drove along his loop route. The tram needed exactly c minutes to complete the route. The head of the engine house controlled the tram\xe2\x80\x99s movement, going outside every c minutes when the tram drove by the engine house, and the head left the driver without a bonus if he was even one second late.It used to be so. Afterwards the Berland Federal Budget gave money to make more tramlines in S***, and, as it sometimes happens, the means were used as it was planned. The tramlines were rebuilt and as a result they turned into a huge network. The previous loop route may have been destroyed. S*** has n crossroads and now m tramlines that links the pairs of crossroads. The traffic in Berland is one way so the tram can move along each tramline only in one direction. There may be several tramlines between two crossroads, which go same way or opposite ways. Every tramline links two different crossroads and for each crossroad there is at least one outgoing tramline.So, the tramlines were built but for some reason nobody gave a thought to increasing the number of trams in S***! The tram continued to ride alone but now the driver had an excellent opportunity to get rid of the unending control of the engine house head. For now due to the tramline network he could choose the route freely! Now at every crossroad the driver can arbitrarily choose the way he can go. The tram may even go to the parts of S*** from where it cannot return due to one way traffic. The driver is not afraid of the challenge: at night, when the city is asleep, he can return to the engine house safely, driving along the tramlines in the opposite direction.The city people were rejoicing for some of the had been waiting for the tram to appear on their streets for several years. However, the driver\xe2\x80\x99s behavior enraged the engine house head. Now he tries to carry out an insidious plan of installing cameras to look after the rebellious tram.The plan goes as follows. The head of the engine house wants to install cameras at some crossroads, to choose a period of time t and every t minutes turn away from the favourite TV show to check where the tram is. Also the head of the engine house wants at all moments of time, divisible by t, and only at such moments the tram to appear on a crossroad under a camera. There must be a camera on the crossroad by the engine house to prevent possible terrorist attacks on the engine house head. Among all the possible plans the engine house head chooses the plan with the largest possible value of t (as he hates being distracted from his favourite TV show but he has to). If such a plan is not unique, pick the plan that requires the minimal possible number of cameras. Find such a plan." 2500.0
                                                39G "Inverse Function" implementation "Petya wrote a programme on C++ that calculated a very interesting function f(n). Petya ran the program with a certain value of n and went to the kitchen to have some tea. The history has no records concerning how long the program had been working. By the time Petya returned, it had completed the calculations and had the result. However while Petya was drinking tea, a sly virus managed to destroy the input file so that Petya can\'t figure out for which value of n the program was run. Help Petya, carry out the inverse function!Mostly, the program consists of a function in C++ with the following simplified syntax:  function ::= int f(int n) {operatorSequence} operatorSequence ::= operator | operator operatorSequence operator ::= return arithmExpr; | if (logicalExpr) return arithmExpr; logicalExpr ::= arithmExpr\xe2\x80\x89>\xe2\x80\x89arithmExpr | arithmExpr\xe2\x80\x89<\xe2\x80\x89arithmExpr | arithmExpr == arithmExpr arithmExpr ::= sum sum ::= product | sum\xe2\x80\x89+\xe2\x80\x89product | sum\xe2\x80\x89-\xe2\x80\x89product product ::= multiplier | product\xe2\x80\x89*\xe2\x80\x89multiplier | product\xe2\x80\x89/\xe2\x80\x89multiplier multiplier ::= n | number | f(arithmExpr) number ::= 0|1|2|... |32767 The whitespaces in a operatorSequence are optional.Thus, we have a function, in which body there are two kinds of operators. There is the operator ""return arithmExpr;"" that returns the value of the expression as the value of the function, and there is the conditional operator ""if (logicalExpr) return arithmExpr;"" that returns the value of the arithmetical expression when and only when the logical expression is true. Guaranteed that no other constructions of C++ language \xe2\x80\x94 cycles, assignment operators, nested conditional operators etc, and other variables except the n parameter are used in the function. All the constants are integers in the interval [0..32767].The operators are performed sequentially. After the function has returned a value other operators in the sequence are not performed. Arithmetical expressions are performed taking into consideration the standard priority of the operations. It means that first all the products that are part of the sum are calculated. During the calculation of the products the operations of multiplying and division are performed from the left to the right. Then the summands are summed, and the addition and the subtraction are also performed from the left to the right. Operations "">"" (more), ""<"" (less) and ""=="" (equals) also have standard meanings.Now you\'ve got to pay close attention! The program is compiled with the help of 15-bit Berland C++ compiler invented by a Berland company BerSoft, that\'s why arithmetical operations are performed in a non-standard way. Addition, subtraction and multiplication are performed modulo 32768 (if the result of subtraction is negative, then 32768 is added to it until the number belongs to the interval [0..32767]). Division ""/"" is a usual integer division where the remainder is omitted.Examples of arithmetical operations: Guaranteed that for all values of n from 0 to 32767 the given function is performed correctly. That means that:1. Division by 0 never occures.2. When performing a function for the value n\xe2\x80\x89=\xe2\x80\x89N recursive calls of the function f may occur only for the parameter value of 0,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89N\xe2\x80\x89-\xe2\x80\x891. Consequently, the program never has an infinite recursion.3. As the result of the sequence of the operators, the function always returns a value.We have to mention that due to all the limitations the value returned by the function f is independent from either global variables or the order of performing the calculations of arithmetical expressions as part of the logical one, or from anything else except the value of n parameter. That\'s why the f function can be regarded as a function in its mathematical sense, i.e. as a unique correspondence between any value of n from the interval [0..32767] and a value of f(n) from the same interval.Given the value of f(n), and you should find n. If the suitable n value is not unique, you should find the maximal one (from the interval [0..32767])." 2400.0
                                                39A "C*++ Calculations" "expression parsing,greedy" "C*++ language is quite similar to C++. The similarity manifests itself in the fact that the programs written in C*++ sometimes behave unpredictably and lead to absolutely unexpected effects. For example, let\'s imagine an arithmetic expression in C*++ that looks like this (expression is the main term):  expression ::= summand | expression\xe2\x80\x89+\xe2\x80\x89summand | expression\xe2\x80\x89-\xe2\x80\x89summand  summand ::= increment | coefficient*increment  increment ::= a++ | ++a  coefficient ::= 0|1|2|...|1000 For example, ""5*a++-3*++a+a++"" is a valid expression in C*++.Thus, we have a sum consisting of several summands divided by signs ""+"" or ""-"". Every summand is an expression ""a++"" or ""++a"" multiplied by some integer coefficient. If the coefficient is omitted, it is suggested being equal to 1.The calculation of such sum in C*++ goes the following way. First all the summands are calculated one after another, then they are summed by the usual arithmetic rules. If the summand contains ""a++"", then during the calculation first the value of the ""a"" variable is multiplied by the coefficient, then value of ""a"" is increased by 1. If the summand contains ""++a"", then the actions on it are performed in the reverse order: first ""a"" is increased by 1, then \xe2\x80\x94 multiplied by the coefficient.The summands may be calculated in any order, that\'s why sometimes the result of the calculation is completely unpredictable! Your task is to find its largest possible value." 2000.0
                                                38C Blinds "brute force" "The blinds are known to consist of opaque horizontal stripes that can be rotated thus regulating the amount of light flowing in the room. There are n blind stripes with the width of 1 in the factory warehouse for blind production. The problem is that all of them are spare details from different orders, that is, they may not have the same length (it is even possible for them to have different lengths)Every stripe can be cut into two or more parts. The cuttings are made perpendicularly to the side along which the length is measured. Thus the cuttings do not change the width of a stripe but each of the resulting pieces has a lesser length (the sum of which is equal to the length of the initial stripe)After all the cuttings the blinds are constructed through consecutive joining of several parts, similar in length, along sides, along which length is measured. Also, apart from the resulting pieces an initial stripe can be used as a blind if it hasn\'t been cut. It is forbidden to construct blinds in any other way.Thus, if the blinds consist of k pieces each d in length, then they are of form of a rectangle of k\xe2\x80\x89\xc3\x97\xe2\x80\x89d bourlemeters. Your task is to find for what window possessing the largest possible area the blinds can be made from the given stripes if on technical grounds it is forbidden to use pieces shorter than l bourlemeter. The window is of form of a rectangle with side lengths as positive integers." 1400.0
                                                36B Fractal implementation "Ever since Kalevitch, a famous Berland abstractionist, heard of fractals, he made them the main topic of his canvases. Every morning the artist takes a piece of graph paper and starts with making a model of his future canvas. He takes a square as big as n\xe2\x80\x89\xc3\x97\xe2\x80\x89n squares and paints some of them black. Then he takes a clean square piece of paper and paints the fractal using the following algorithm: Step 1. The paper is divided into n2 identical squares and some of them are painted black according to the model.Step 2. Every square that remains white is divided into n2 smaller squares and some of them are painted black according to the model.Every following step repeats step 2.  Unfortunately, this tiresome work demands too much time from the painting genius. Kalevitch has been dreaming of making the process automatic to move to making 3D or even 4D fractals." 1600.0
                                                35A "Shell Game" implementation "Today the \xc2\xabZ\xc2\xbb city residents enjoy a shell game competition. The residents are gathered on the main square to watch the breath-taking performance. The performer puts 3 non-transparent cups upside down in a row. Then he openly puts a small ball under one of the cups and starts to shuffle the cups around very quickly so that on the whole he makes exactly 3 shuffles. After that the spectators have exactly one attempt to guess in which cup they think the ball is and if the answer is correct they get a prize. Maybe you can try to find the ball too?" 1000.0
                                                31C Schedule implementation "At the beginning of the new semester there is new schedule in the Berland State University. According to this schedule, n groups have lessons at the room 31. For each group the starting time of the lesson and the finishing time of the lesson are known. It has turned out that it is impossible to hold all lessons, because for some groups periods of their lessons intersect. If at some moment of time one groups finishes it\'s lesson, and the other group starts the lesson, their lessons don\'t intersect.The dean wants to cancel the lesson in one group so that no two time periods of lessons of the remaining groups intersect. You are to find all ways to do that." 1700.0
                                                30E "Tricky and Clever Password" "binary search,constructive algorithms,data structures,greedy,hashing,strings" "In his very young years the hero of our story, king Copa, decided that his private data was hidden not enough securely, what is unacceptable for the king. That\'s why he invented tricky and clever password (later he learned that his password is a palindrome of odd length), and coded all his data using it. Copa is afraid to forget his password, so he decided to write it on a piece of paper. He is aware that it is insecure to keep password in such way, so he decided to cipher it the following way: he cut x characters from the start of his password and from the end of it (x can be 0, and 2x is strictly less than the password length). He obtained 3 parts of the password. Let\'s call it prefix, middle and suffix correspondingly, both prefix and suffix having equal length and middle always having odd length. From these parts he made a string A\xe2\x80\x89+\xe2\x80\x89prefix\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89+\xe2\x80\x89middle\xe2\x80\x89+\xe2\x80\x89C\xe2\x80\x89+\xe2\x80\x89suffix, where A, B and C are some (possibly empty) strings invented by Copa, and \xc2\xab\xe2\x80\x89+\xe2\x80\x89\xc2\xbb means concatenation.Many years have passed, and just yesterday the king Copa found the piece of paper where his ciphered password was written. The password, as well as the strings A, B and C, was completely forgotten by Copa, so he asks you to find a password of maximum possible length, which could be invented, ciphered and written by Copa." 2800.0
                                                27B Tournament "bitmasks,brute force,dfs and similar,greedy" "The tournament \xc2\xabSleepyhead-2010\xc2\xbb in the rapid falling asleep has just finished in Berland. n best participants from the country have participated in it. The tournament consists of games, each of them is a match between two participants. n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89/\xe2\x80\x892 games were played during the tournament, and each participant had a match with each other participant. The rules of the game are quite simple \xe2\x80\x94 the participant who falls asleep first wins. The secretary made a record of each game in the form \xc2\xabxi yi\xc2\xbb, where xi and yi are the numbers of participants. The first number in each pair is a winner (i.e. xi is a winner and yi is a loser). There is no draws.Recently researches form the \xc2\xabInstitute Of Sleep\xc2\xbb have found that every person is characterized by a value pj \xe2\x80\x94 the speed of falling asleep. The person who has lower speed wins. Every person has its own value pj, constant during the life. It is known that all participants of the tournament have distinct speeds of falling asleep. Also it was found that the secretary made records about all the games except one. You are to find the result of the missing game." 1300.0
                                                23D Tetragon geometry,math "You\'re given the centers of three equal sides of a strictly convex tetragon. Your task is to restore the initial tetragon." 2600.0
                                                23A "You\'re Given a String..." "brute force,greedy" "You\'re given a string of lower-case Latin letters. Your task is to find the length of its longest substring that can be met in the string at least twice. These occurrences can overlap (see sample test 2)." 1200.0
                                                22C "System Administrator" graphs "Bob got a job as a system administrator in X corporation. His first task was to connect n servers with the help of m two-way direct connection so that it becomes possible to transmit data from one server to any other server via these connections. Each direct connection has to link two different servers, each pair of servers should have at most one direct connection. Y corporation, a business rival of X corporation, made Bob an offer that he couldn\'t refuse: Bob was asked to connect the servers in such a way, that when server with index v fails, the transmission of data between some other two servers becomes impossible, i.e. the system stops being connected. Help Bob connect the servers." 1700.0
                                                21D "Traveling Graph" "bitmasks,graph matchings,graphs" "You are given undirected weighted graph. Find the length of the shortest cycle which starts from the vertex 1 and passes throught all the edges at least once. Graph may contain multiply edges between a pair of vertices and loops (edges from the vertex to itself)." 2400.0
                                                19C "Deletion of Repeats" "greedy,hashing,string suffix structures" "Once Bob saw a string. It contained so many different letters, that the letters were marked by numbers, but at the same time each letter could be met in the string at most 10 times. Bob didn\'t like that string, because it contained repeats: a repeat of length x is such a substring of length 2x, that its first half coincides character by character with its second half. Bob started deleting all the repeats from the string. He does it as follows: while it\'s possible, Bob takes the shortest repeat, if it is not unique, he takes the leftmost one, and deletes its left half and everything that is to the left of this repeat.You\'re given the string seen by Bob. Find out, what it will look like after Bob deletes all the repeats in the way described above." 2200.0
                                                19B "Checkout Assistant" dp "Bob came to a cash & carry store, put n items into his trolley, and went to the checkout counter to pay. Each item is described by its price ci and time ti in seconds that a checkout assistant spends on this item. While the checkout assistant is occupied with some item, Bob can steal some other items from his trolley. To steal one item Bob needs exactly 1 second. What is the minimum amount of money that Bob will have to pay to the checkout assistant? Remember, please, that it is Bob, who determines the order of items for the checkout assistant." 1900.0
                                                18E "Flag 2" dp "According to a new ISO standard, a flag of every country should have, strangely enough, a chequered field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, each square should be wholly painted one of 26 colours. The following restrictions are set:   In each row at most two different colours can be used.  No two adjacent squares can be painted the same colour. Pay attention, please, that in one column more than two different colours can be used.Berland\'s government took a decision to introduce changes into their country\'s flag in accordance with the new standard, at the same time they want these changes to be minimal. By the given description of Berland\'s flag you should find out the minimum amount of squares that need to be painted different colour to make the flag meet the new ISO standard. You are as well to build one of the possible variants of the new Berland\'s flag." 2000.0
                                                18D "Seller Bob" "brute force,dp,greedy" "Last year Bob earned by selling memory sticks. During each of n days of his work one of the two following events took place:   A customer came to Bob and asked to sell him a 2x MB memory stick. If Bob had such a stick, he sold it and got 2x berllars.  Bob won some programming competition and got a 2x MB memory stick as a prize. Bob could choose whether to present this memory stick to one of his friends, or keep it. Bob never kept more than one memory stick, as he feared to mix up their capacities, and deceive a customer unintentionally. It is also known that for each memory stick capacity there was at most one customer, who wanted to buy that memory stick. Now, knowing all the customers\' demands and all the prizes won at programming competitions during the last n days, Bob wants to know, how much money he could have earned, if he had acted optimally." 2000.0
                                                17A "Noldbach problem" "brute force,math,number theory" "Nick is interested in prime numbers. Once he read about Goldbach problem. It states that every even integer greater than 2 can be expressed as the sum of two primes. That got Nick\'s attention and he decided to invent a problem of his own and call it Noldbach problem. Since Nick is interested only in prime numbers, Noldbach problem states that at least k prime numbers from 2 to n inclusively can be expressed as the sum of three integer numbers: two neighboring prime numbers and 1. For example, 19 = 7 + 11 + 1, or 13 = 5 + 7 + 1.Two prime numbers are called neighboring if there are no other prime numbers between them.You are to help Nick, and find out if he is right or wrong." 1000.0
                                                14A Letter implementation "A boy Bob likes to draw. Not long ago he bought a rectangular graph (checked) sheet with n rows and m columns. Bob shaded some of the squares on the sheet. Having seen his masterpiece, he decided to share it with his elder brother, who lives in Flatland. Now Bob has to send his picture by post, but because of the world economic crisis and high oil prices, he wants to send his creation, but to spend as little money as possible. For each sent square of paper (no matter whether it is shaded or not) Bob has to pay 3.14 burles. Please, help Bob cut out of his masterpiece a rectangle of the minimum cost, that will contain all the shaded squares. The rectangle\'s sides should be parallel to the sheet\'s sides." 800.0
                                                13B "Letter A" geometry,implementation "Little Petya learns how to write. The teacher gave pupils the task to write the letter A on the sheet of paper. It is required to check whether Petya really had written the letter A.You are given three segments on the plane. They form the letter A if the following conditions hold:  Two segments have common endpoint (lets call these segments first and second), while the third segment connects two points on the different segments.  The angle between the first and the second segments is greater than 0 and do not exceed 90 degrees.  The third segment divides each of the first two segments in proportion not less than 1\xe2\x80\x89/\xe2\x80\x894 (i.e. the ratio of the length of the shortest part to the length of the longest part is not less than 1\xe2\x80\x89/\xe2\x80\x894)." 2000.0
                                                12D Ball "data structures,sortings" "N ladies attend the ball in the King\'s palace. Every lady can be described with three values: beauty, intellect and richness. King\'s Master of Ceremonies knows that ladies are very special creatures. If some lady understands that there is other lady at the ball which is more beautiful, smarter and more rich, she can jump out of the window. He knows values of all ladies and wants to find out how many probable self-murderers will be on the ball. Lets denote beauty of the i-th lady by Bi, her intellect by Ii and her richness by Ri. Then i-th lady is a probable self-murderer if there is some j-th lady that Bi\xe2\x80\x89<\xe2\x80\x89Bj,\xe2\x80\x89Ii\xe2\x80\x89<\xe2\x80\x89Ij,\xe2\x80\x89Ri\xe2\x80\x89<\xe2\x80\x89Rj. Find the number of probable self-murderers." 2400.0
                                                11E "Forward, march!" "binary search,dp,greedy" "Jack has become a soldier now. Unfortunately, he has trouble with the drill. Instead of marching beginning with the left foot and then changing legs with each step, as ordered, he keeps repeating a sequence of steps, in which he sometimes makes the wrong steps or \xe2\x80\x94 horror of horrors! \xe2\x80\x94 stops for a while. For example, if Jack uses the sequence \'right, left, break\', when the sergeant yells: \'Left! Right! Left! Right! Left! Right!\', Jack first makes a step with the right foot, then one with the left foot, then he is confused and stops for a moment, then again - this time according to the order - starts with the right foot, then uses the left foot, then - to the sergeant\'s irritation - he stops to catch his breath, to incorrectly start with the right foot again... Marching this way, Jack will make the step that he is supposed to in the given moment in only one third of cases.When the officers convinced him he should do something about it, Jack decided to modify the basic sequence of steps that he repeats. However, in order not to get too tired, he has decided that the only thing he\'ll do is adding any number of breaks in any positions of the original sequence (a break corresponds to stopping for the duration of one step). Of course, Jack can\'t make a step on the same foot twice in a row, if there is no pause between these steps. It is, however, not impossible that the sequence of steps he used so far is incorrect (it would explain a lot, actually).Help Private Jack! Given the sequence of steps he keeps repeating, calculate the maximal percentage of time that he can spend marching correctly after adding some breaks to his scheme." 2800.0
                                                8C "Looking for Order" bitmasks,dp "Girl Lena likes it when everything is in order, and looks for order everywhere. Once she was getting ready for the University and noticed that the room was in a mess \xe2\x80\x94 all the objects from her handbag were thrown about the room. Of course, she wanted to put them back into her handbag. The problem is that the girl cannot carry more than two objects at a time, and cannot move the handbag. Also, if he has taken an object, she cannot put it anywhere except her handbag \xe2\x80\x94 her inherent sense of order does not let her do so.You are given the coordinates of the handbag and the coordinates of the objects in some \xd0\xa1artesian coordinate system. It is known that the girl covers the distance between any two objects in the time equal to the squared length of the segment between the points of the objects. It is also known that initially the coordinates of the girl and the handbag are the same. You are asked to find such an order of actions, that the girl can put all the objects back into her handbag in a minimum time period." 2000.0
                                                7A "Kalevitch and Chess" "brute force,constructive algorithms" "A famous Berland\'s painter Kalevitch likes to shock the public. One of his last obsessions is chess. For more than a thousand years people have been playing this old game on uninteresting, monotonous boards. Kalevitch decided to put an end to this tradition and to introduce a new attitude to chessboards.As before, the chessboard is a square-checkered board with the squares arranged in a 8\xe2\x80\x89\xc3\x97\xe2\x80\x898 grid, each square is painted black or white. Kalevitch suggests that chessboards should be painted in the following manner: there should be chosen a horizontal or a vertical line of 8 squares (i.e. a row or a column), and painted black. Initially the whole chessboard is white, and it can be painted in the above described way one or more times. It is allowed to paint a square many times, but after the first time it does not change its colour any more and remains black. Kalevitch paints chessboards neatly, and it is impossible to judge by an individual square if it was painted with a vertical or a horizontal stroke.Kalevitch hopes that such chessboards will gain popularity, and he will be commissioned to paint chessboards, which will help him ensure a comfortable old age. The clients will inform him what chessboard they want to have, and the painter will paint a white chessboard meeting the client\'s requirements.It goes without saying that in such business one should economize on everything \xe2\x80\x94 for each commission he wants to know the minimum amount of strokes that he has to paint to fulfill the client\'s needs. You are asked to help Kalevitch with this task." 1100.0
                                                6C "Alice, Bob and Chocolate" "greedy,two pointers" "Alice and Bob like games. And now they are ready to start a new game. They have placed n chocolate bars in a line. Alice starts to eat chocolate bars one by one from left to right, and Bob \xe2\x80\x94 from right to left. For each chocololate bar the time, needed for the player to consume it, is known (Alice and Bob eat them with equal speed). When the player consumes a chocolate bar, he immediately starts with another. It is not allowed to eat two chocolate bars at the same time, to leave the bar unfinished and to make pauses. If both players start to eat the same bar simultaneously, Bob leaves it to Alice as a true gentleman.How many bars each of the players will consume?" 1200.0
                                                5D "Follow Traffic Rules" implementation,math "Everybody knows that the capital of Berland is connected to Bercouver (the Olympic capital) by a direct road. To improve the road\'s traffic capacity, there was placed just one traffic sign, limiting the maximum speed. Traffic signs in Berland are a bit peculiar, because they limit the speed only at that point on the road where they are placed. Right after passing the sign it is allowed to drive at any speed.It is known that the car of an average Berland citizen has the acceleration (deceleration) speed of a km/h2, and has maximum speed of v km/h. The road has the length of l km, and the speed sign, limiting the speed to w km/h, is placed d km (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89<\xe2\x80\x89l) away from the capital of Berland. The car has a zero speed at the beginning of the journey. Find the minimum time that an average Berland citizen will need to get from the capital to Bercouver, if he drives at the optimal speed.The car can enter Bercouver at any speed." 2100.0
                                                1C "Ancient Berland Circus" geometry,math "Nowadays all circuses in Berland have a round arena with diameter 13 meters, but in the past things were different.In Ancient Berland arenas in circuses were shaped as a regular (equiangular) polygon, the size and the number of angles could vary from one circus to another. In each corner of the arena there was a special pillar, and the rope strung between the pillars marked the arena edges.Recently the scientists from Berland have discovered the remains of the ancient circus arena. They found only three pillars, the others were destroyed by the time.You are given the coordinates of these three pillars. Find out what is the smallest area that the arena could have." 2100.0
                                                1A "Theatre Square" math "Theatre Square in the capital city of Berland has a rectangular shape with the size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m meters. On the occasion of the city\'s anniversary, a decision was taken to pave the Square with square granite flagstones. Each flagstone is of the size a\xe2\x80\x89\xc3\x97\xe2\x80\x89a.What is the least number of flagstones needed to pave the Square? It\'s allowed to cover the surface larger than the Theatre Square, but the Square has to be covered. It\'s not allowed to break the flagstones. The sides of flagstones should be parallel to the sides of the Square." 1000.0
     1705C "Mark and His Unfinished Essay" "brute force,implementation" "One night, Mark realized that there is an essay due tomorrow. He hasn\'t written anything yet, so Mark decided to randomly copy-paste substrings from the prompt to make the essay.More formally, the prompt is a string s of initial length n. Mark will perform the copy-pasting operation c times. Each operation is described by two integers l and r, which means that Mark will append letters slsl+1\xe2\x80\xa6sr to the end of string s. Note that the length of s increases after this operation.Of course, Mark needs to be able to see what has been written. After copying, Mark will ask q queries: given an integer k, determine the k-th letter of the final string s." 1400.0                                           
     1702D "Not a Cheap String" greedy "Let s be a string of lowercase Latin letters. Its price is the sum of the indices of letters (an integer between 1 and 26) that are included in it. For example, the price of the string abca is 1+2+3+1=7.The string w and the integer p are given. Remove the minimal number of letters from w so that its price becomes less than or equal to p and print the resulting string. Note that the resulting string may be empty. You can delete arbitrary letters, they do not have to go in a row. If the price of a given string w is less than or equal to p, then nothing needs to be deleted and w must be output.Note that when you delete a letter from w, the order of the remaining letters is preserved. For example, if you delete the letter e from the string test, you get tst." 1000.0                                           
     1700D "River Locks" "binary search,dp,greedy,math" "Recently in Divanovo, a huge river locks system was built. There are now n locks, the i-th of them has the volume of vi liters, so that it can contain any amount of water between 0 and vi liters. Each lock has a pipe attached to it. When the pipe is open, 1 liter of water enters the lock every second.The locks system is built in a way to immediately transfer all water exceeding the volume of the lock i to the lock i+1. If the lock i+1 is also full, water will be transferred further. Water exceeding the volume of the last lock pours out to the river.   The picture illustrates 5 locks with two open pipes at locks 1 and 3. Because locks 1, 3, and 4 are already filled, effectively the water goes to locks 2 and 5. Note that the volume of the i-th lock may be greater than the volume of the i+1-th lock.To make all locks work, you need to completely fill each one of them. The mayor of Divanovo is interested in q independent queries. For each query, suppose that initially all locks are empty and all pipes are closed. Then, some pipes are opened simultaneously. For the j-th query the mayor asks you to calculate the minimum number of pipes to open so that all locks are filled no later than after tj seconds.Please help the mayor to solve this tricky problem and answer his queries." 1900.0                                           
     1700C "Helping the Nature" "constructive algorithms,data structures,greedy" "Little Leon lives in the forest. He has recently noticed that some trees near his favourite path are withering, while the other ones are overhydrated so he decided to learn how to control the level of the soil moisture to save the trees.There are n trees growing near the path, the current levels of moisture of each tree are denoted by the array a1,a2,\xe2\x80\xa6,an. Leon has learned three abilities which will help him to dry and water the soil.  Choose a position i and decrease the level of moisture of the trees 1,2,\xe2\x80\xa6,i by 1.  Choose a position i and decrease the level of moisture of the trees i,i+1,\xe2\x80\xa6,n by 1.  Increase the level of moisture of all trees by 1. Leon wants to know the minimum number of actions he needs to perform to make the moisture of each tree equal to 0." 1700.0                                           
     1700A "Optimal Path" "constructive algorithms,greedy,math" "You are given a table a of size n\xc3\x97m. We will consider the table rows numbered from top to bottom from 1 to n, and the columns numbered from left to right from 1 to m. We will denote a cell that is in the i-th row and in the j-th column as (i,j). In the cell (i,j) there is written a number (i\xe2\x88\x921)\xe2\x8b\x85m+j, that is aij=(i\xe2\x88\x921)\xe2\x8b\x85m+j.A turtle initially stands in the cell (1,1) and it wants to come to the cell (n,m). From the cell (i,j) it can in one step go to one of the cells (i+1,j) or (i,j+1), if it exists. A path is a sequence of cells in which for every two adjacent in the sequence cells the following satisfies: the turtle can reach from the first cell to the second cell in one step. A cost of a path is the sum of numbers that are written in the cells of the path.  For example, with n=2 and m=3 the table will look as shown above. The turtle can take the following path: (1,1)\xe2\x86\x92(1,2)\xe2\x86\x92(1,3)\xe2\x86\x92(2,3). The cost of such way is equal to a11+a12+a13+a23=12. On the other hand, the paths (1,1)\xe2\x86\x92(1,2)\xe2\x86\x92(2,2)\xe2\x86\x92(2,1) and (1,1)\xe2\x86\x92(1,3) are incorrect, because in the first path the turtle can\'t make a step (2,2)\xe2\x86\x92(2,1), and in the second path it can\'t make a step (1,1)\xe2\x86\x92(1,3).You are asked to tell the turtle a minimal possible cost of a path from the cell (1,1) to the cell (n,m). Please note that the cells (1,1) and (n,m) are a part of the way." 800.0                                           
     1693E "Outermost Maximums" "data structures,greedy" "Yeri has an array of n+2 non-negative integers : a0,a1,...,an,an+1.We know that a0=an+1=0.She wants to make all the elements of a equal to zero in the minimum number of operations.In one operation she can do one of the following:  Choose the leftmost maximum element and change it to the maximum of the elements on its left. Choose the rightmost maximum element and change it to the maximum of the elements on its right.Help her find the minimum number of operations needed to make all elements of a equal to zero." 3400.0                                           
     1693D "Decinc Dividing" "brute force,data structures,divide and conquer,dp,greedy" "Let\'s call an array a of m integers a1,a2,\xe2\x80\xa6,am Decinc if a can be made increasing by removing a decreasing subsequence (possibly empty) from it. For example, if a=[3,2,4,1,5], we can remove the decreasing subsequence [a1,a4] from a and obtain a=[2,4,5], which is increasing.You are given a permutation p of numbers from 1 to n. Find the number of pairs of integers (l,r) with 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n such that p[l\xe2\x80\xa6r] (the subarray of p from l to r) is a Decinc array." 2800.0                                           
     1693C "Keshi in Search of AmShZ" "graphs,greedy,shortest paths" "AmShZ has traveled to Italy from Iran for the Thom Yorke concert. There are n cities in Italy indexed from 1 to n and m directed roads indexed from 1 to m. Initially, Keshi is located in the city 1 and wants to go to AmShZ\'s house in the city n. Since Keshi doesn\'t know the map of Italy, AmShZ helps him to see each other as soon as possible.In the beginning of each day, AmShZ can send one of the following two messages to Keshi: AmShZ sends the index of one road to Keshi as a blocked road. Then Keshi will understand that he should never use that road and he will remain in his current city for the day. AmShZ tells Keshi to move. Then, Keshi will randomly choose one of the cities reachable from his current city and move there. (city B is reachable from city A if there\'s an out-going road from city A to city B which hasn\'t become blocked yet). If there are no such cities, Keshi will remain in his current city.Note that AmShZ always knows Keshi\'s current location. AmShZ and Keshi want to find the smallest possible integer d for which they can make sure that they will see each other after at most d days. Help them find d." 2300.0                                           
     1690F "Shifting String" "graphs,math,number theory,strings" "Polycarp found the string s and the permutation p. Their lengths turned out to be the same and equal to n.A permutation of n elements \xe2\x80\x94 is an array of length n, in which every integer from 1 to n occurs exactly once. For example, [1,2,3] and [4,3,5,1,2] are permutations, but [1,2,4], [4,3,2,1,2] and [0,1,2] are not.In one operation he can multiply s by p, so he replaces s with string new, in which for any i from 1 to n it is true that newi=spi. For example, with s=wmbe and p=[3,1,4,2], after operation the string will turn to s=s3s1s4s2=bwem.Polycarp wondered after how many operations the string would become equal to its initial value for the first time. Since it may take too long, he asks for your help in this matter.It can be proved that the required number of operations always exists. It can be very large, so use a 64-bit integer type." 1700.0                                           
     1689A "Lex String" "brute force,greedy,implementation,sortings,two pointers" "Kuznecov likes art, poetry, and music. And strings consisting of lowercase English letters.Recently, Kuznecov has found two strings, a and b, of lengths n and m respectively. They consist of lowercase English letters and no character is contained in both strings. Let another string c be initially empty. Kuznecov can do the following two types of operations:  Choose any character from the string a, remove it from a, and add it to the end of c.  Choose any character from the string b, remove it from b, and add it to the end of c. But, he can not do more than k operations of the same type in a row. He must perform operations until either a or b becomes empty. What is the lexicographically smallest possible value of c after he finishes?A string x is lexicographically smaller than a string y if and only if one of the following holds: x is a prefix of y, but x\xe2\x89\xa0y;  in the first position where x and y differ, the string x has a letter that appears earlier in the alphabet than the corresponding letter in y." 800.0                                           
     1687A "The Enchanted Forest" "brute force,greedy" "The enchanted forest got its name from the magical mushrooms growing here. They may cause illusions and generally should not be approached.\xe2\x80\x94Perfect Memento in Strict SenseMarisa comes to pick mushrooms in the Enchanted Forest. The Enchanted forest can be represented by n points on the X-axis numbered 1 through n. Before Marisa started, her friend, Patchouli, used magic to detect the initial number of mushroom on each point, represented by a1,a2,\xe2\x80\xa6,an.Marisa can start out at any point in the forest on minute 0. Each minute, the followings happen in order:  She moves from point x to y (|x\xe2\x88\x92y|\xe2\x89\xa41, possibly y=x).  She collects all mushrooms on point y.  A new mushroom appears on each point in the forest. Note that she cannot collect mushrooms on minute 0.Now, Marisa wants to know the maximum number of mushrooms she can pick after k minutes." 1600.0                                           
     1685B Linguistics greedy,implementation,sortings,strings "Alina has discovered a weird language, which contains only 4 words: A, B, AB, BA. It also turned out that there are no spaces in this language: a sentence is written by just concatenating its words into a single string.Alina has found one such sentence s and she is curious: is it possible that it consists of precisely a words A, b words B, c words AB, and d words BA?In other words, determine, if it\'s possible to concatenate these a+b+c+d words in some order so that the resulting string is s. Each of the a+b+c+d words must be used exactly once in the concatenation, but you can choose the order in which they are concatenated." 2000.0                                           
     1684A "Digit Minimization" "constructive algorithms,games,math,strings" "There is an integer n without zeros in its decimal representation. Alice and Bob are playing a game with this integer. Alice starts first. They play the game in turns.On her turn, Alice must swap any two digits of the integer that are on different positions. Bob on his turn always removes the last digit of the integer. The game ends when there is only one digit left.You have to find the smallest integer Alice can get in the end, if she plays optimally." 800.0                                           
     1682F MCMF? "data structures,flows,graphs,greedy,sortings,two pointers" "You are given two integer arrays a and b (bi\xe2\x89\xa00 and |bi|\xe2\x89\xa4109). Array a is sorted in non-decreasing order.The cost of a subarray a[l:r] is defined as follows:If r\xe2\x88\x91j=lbj\xe2\x89\xa00, then the cost is not defined.Otherwise: Construct a bipartite flow graph with r\xe2\x88\x92l+1 vertices, labeled from l to r, with all vertices having bi<0 on the left and those with bi>0 on right. For each i,j such that l\xe2\x89\xa4i,j\xe2\x89\xa4r, bi<0 and bj>0, draw an edge from i to j with infinite capacity and cost of unit flow as |ai\xe2\x88\x92aj|. Add two more vertices: source S and sink T. For each i such that l\xe2\x89\xa4i\xe2\x89\xa4r and bi<0, add an edge from S to i with cost 0 and capacity |bi|. For each i such that l\xe2\x89\xa4i\xe2\x89\xa4r and bi>0, add an edge from i to T with cost 0 and capacity |bi|. The cost of the subarray is then defined as the minimum cost of maximum flow from S to T.You are given q queries in the form of two integers l and r. You have to compute the cost of subarray a[l:r] for each query, modulo 109+7.If you don\'t know what the minimum cost of maximum flow means, read here." 2700.0                                           
     1681B "Card Trick" implementation,math "Monocarp has just learned a new card trick, and can\'t wait to present it to you. He shows you the entire deck of n cards. You see that the values of cards from the topmost to the bottommost are integers a1,a2,\xe2\x80\xa6,an, and all values are different.Then he asks you to shuffle the deck m times. With the j-th shuffle, you should take bj topmost cards and move them under the remaining (n\xe2\x88\x92bj) cards without changing the order.And then, using some magic, Monocarp tells you the topmost card of the deck. However, you are not really buying that magic. You tell him that you know the topmost card yourself. Can you surprise Monocarp and tell him the topmost card before he shows it?" 800.0                                           
     1681A "Game with Cards" games,greedy "Alice and Bob play a game. Alice has n cards, the i-th of them has the integer ai written on it. Bob has m cards, the j-th of them has the integer bj written on it.On the first turn of the game, the first player chooses one of his/her cards and puts it on the table (plays it). On the second turn, the second player chooses one of his/her cards such that the integer on it is greater than the integer on the card played on the first turn, and plays it. On the third turn, the first player chooses one of his/her cards such that the integer on it is greater than the integer on the card played on the second turn, and plays it, and so on \xe2\x80\x94 the players take turns, and each player has to choose one of his/her cards with greater integer than the card played by the other player on the last turn.If some player cannot make a turn, he/she loses.For example, if Alice has 4 cards with numbers [10,5,3,8], and Bob has 3 cards with numbers [6,11,6], the game may go as follows:  Alice can choose any of her cards. She chooses the card with integer 5 and plays it.  Bob can choose any of his cards with number greater than 5. He chooses a card with integer 6 and plays it.  Alice can choose any of her cards with number greater than 6. She chooses the card with integer 10 and plays it.  Bob can choose any of his cards with number greater than 10. He chooses a card with integer 11 and plays it.  Alice can choose any of her cards with number greater than 11, but she has no such cards, so she loses. Both Alice and Bob play optimally (if a player is able to win the game no matter how the other player plays, the former player will definitely win the game).You have to answer two questions:  who wins if Alice is the first player?  who wins if Bob is the first player?" 800.0                                           
     1679D "Toss a Coin to Your Graph..." "binary search,dfs and similar,dp,graphs" "One day Masha was walking in the park and found a graph under a tree... Surprised? Did you think that this problem would have some logical and reasoned story? No way! So, the problem...Masha has an oriented graph which i-th vertex contains some positive integer ai. Initially Masha can put a coin at some vertex. In one operation she can move a coin placed in some vertex u to any other vertex v such that there is an oriented edge u\xe2\x86\x92v in the graph. Each time when the coin is placed in some vertex i, Masha write down an integer ai in her notebook (in particular, when Masha initially puts a coin at some vertex, she writes an integer written at this vertex in her notebook). Masha wants to make exactly k\xe2\x88\x921 operations in such way that the maximum number written in her notebook is as small as possible." 1900.0                                           
     1677B "Tokitsukaze and Meeting" "data structures,implementation,math" "Tokitsukaze is arranging a meeting. There are n rows and m columns of seats in the meeting hall.There are exactly n\xe2\x8b\x85m students attending the meeting, including several naughty students and several serious students. The students are numerated from 1 to n\xe2\x8b\x85m. The students will enter the meeting hall in order. When the i-th student enters the meeting hall, he will sit in the 1-st column of the 1-st row, and the students who are already seated will move back one seat. Specifically, the student sitting in the j-th (1\xe2\x89\xa4j\xe2\x89\xa4m\xe2\x88\x921) column of the i-th row will move to the (j+1)-th column of the i-th row, and the student sitting in m-th column of the i-th row will move to the 1-st column of the (i+1)-th row.For example, there is a meeting hall with 2 rows and 2 columns of seats shown as below:  There will be 4 students entering the meeting hall in order, represented as a binary string ""1100"", of which \'0\' represents naughty students and \'1\' represents serious students. The changes of seats in the meeting hall are as follows:  Denote a row or a column good if and only if there is at least one serious student in this row or column. Please predict the number of good rows and columns just after the i-th student enters the meeting hall, for all i." 1700.0                                           
     1674D "A-B-C Sort" "constructive algorithms,implementation,sortings" "You are given three arrays a, b and c. Initially, array a consists of n elements, arrays b and c are empty.You are performing the following algorithm that consists of two steps:   Step 1: while a is not empty, you take the last element from a and move it in the middle of array b. If b currently has odd length, you can choose: place the element from a to the left or to the right of the middle element of b. As a result, a becomes empty and b consists of n elements.  Step 2: while b is not empty, you take the middle element from b and move it to the end of array c. If b currently has even length, you can choose which of two middle elements to take. As a result, b becomes empty and c now consists of n elements.  Refer to the Note section for examples.Can you make array c sorted in non-decreasing order?" 1200.0                                           
     1674A "Number Transformation" "constructive algorithms,math" "You are given two integers x and y. You want to choose two strictly positive (greater than zero) integers a and b, and then apply the following operation to x exactly a times: replace x with b\xe2\x8b\x85x.You want to find two positive integers a and b such that x becomes equal to y after this process. If there are multiple possible pairs, you can choose any of them. If there is no such pair, report it.For example:   if x=3 and y=75, you may choose a=2 and b=5, so that x becomes equal to 3\xe2\x8b\x855\xe2\x8b\x855=75;  if x=100 and y=100, you may choose a=3 and b=1, so that x becomes equal to 100\xe2\x8b\x851\xe2\x8b\x851\xe2\x8b\x851=100;  if x=42 and y=13, there is no answer since you cannot decrease x with the given operations." 800.0                                           
     1672E notepad.exe "binary search,constructive algorithms,greedy,interactive" "This is an interactive problem.There are n words in a text editor. The i-th word has length li (1\xe2\x89\xa4li\xe2\x89\xa42000). The array l is hidden and only known by the grader. The text editor displays words in lines, splitting each two words in a line with at least one space. Note that a line does not have to end with a space. Let the height of the text editor refer to the number of lines used. For the given width, the text editor will display words in such a way that the height is minimized.More formally, suppose that the text editor has width w. Let a be an array of length k+1 where 1=a1<a2<\xe2\x80\xa6<ak+1=n+1. a is a valid array if for all 1\xe2\x89\xa4i\xe2\x89\xa4k, lai+1+lai+1+1+\xe2\x80\xa6+1+lai+1\xe2\x88\x921\xe2\x89\xa4w. Then the height of the text editor is the minimum k over all valid arrays.Note that if w<max(li), the text editor cannot display all the words properly and will crash, and the height of the text editor will be 0 instead.You can ask n+30 queries. In one query, you provide a width w. Then, the grader will return the height hw of the text editor when its width is w.Find the minimum area of the text editor, which is the minimum value of w\xe2\x8b\x85hw over all w for which hw\xe2\x89\xa00.The lengths are fixed in advance. In other words, the interactor is not adaptive." 2200.0                                           
     1672D "Cyclic Rotation" "constructive algorithms,greedy,implementation,two pointers" "There is an array a of length n. You may perform the following operation any number of times:  Choose two indices l and r where 1\xe2\x89\xa4l<r\xe2\x89\xa4n and al=ar. Then, set a[l\xe2\x80\xa6r]=[al+1,al+2,\xe2\x80\xa6,ar,al]. You are also given another array b of length n which is a permutation of a. Determine whether it is possible to transform array a into an array b using the above operation some number of times." 1700.0                                           
     1671D "Insert a Progression" "brute force,constructive algorithms,greedy" "You are given a sequence of n integers a1,a2,\xe2\x80\xa6,an. You are also given x integers 1,2,\xe2\x80\xa6,x.You are asked to insert each of the extra integers into the sequence a. Each integer can be inserted at the beginning of the sequence, at the end of the sequence, or between any elements of the sequence.The score of the resulting sequence a\xe2\x80\xb2 is the sum of absolute differences of adjacent elements in it (n+x\xe2\x88\x921\xe2\x88\x91i=1|a\xe2\x80\xb2i\xe2\x88\x92a\xe2\x80\xb2i+1|).What is the smallest possible score of the resulting sequence a\xe2\x80\xb2?" 1600.0                                           
     1671A "String Building" implementation "You are given a string s. You have to determine whether it is possible to build the string s out of strings aa, aaa, bb and/or bbb by concatenating them. You can use the strings aa, aaa, bb and/or bbb any number of times and in any order.For example:  aaaabbb can be built as aa + aa + bbb;  bbaaaaabbb can be built as bb + aaa + aa + bbb;  aaaaaa can be built as aa + aa + aa;  abab cannot be built from aa, aaa, bb and/or bbb." 800.0                                           
     1670D "Very Suspicious" "binary search,brute force,geometry,greedy,implementation,math" "Sehr Sus is an infinite hexagonal grid as pictured below, controlled by MennaFadali, ZerooCool and Hosssam.They love equilateral triangles and want to create n equilateral triangles on the grid by adding some straight lines. The triangles must all be empty from the inside (in other words, no straight line or hexagon edge should pass through any of the triangles).You are allowed to add straight lines parallel to the edges of the hexagons. Given n, what is the minimum number of lines you need to add to create at least n equilateral triangles as described?  Adding two red lines results in two new yellow equilateral triangles." 1700.0                                           
     1667C "Half Queen Cover" "constructive algorithms,math" "You are given a board with n rows and n columns, numbered from 1 to n. The intersection of the a-th row and b-th column is denoted by (a,b).A half-queen attacks cells in the same row, same column, and on one diagonal. More formally, a half-queen on (a,b) attacks the cell (c,d) if a=c or b=d or a\xe2\x88\x92b=c\xe2\x88\x92d.  The blue cells are under attack.  What is the minimum number of half-queens that can be placed on that board so as to ensure that each square is attacked by at least one half-queen?Construct an optimal solution." 2400.0                                           
     1667A "Make it Increasing" "brute force,greedy,math" "You are given an array a consisting of n positive integers, and an array b, with length n. Initially bi=0 for each 1\xe2\x89\xa4i\xe2\x89\xa4n.In one move you can choose an integer i (1\xe2\x89\xa4i\xe2\x89\xa4n), and add ai to bi or subtract ai from bi. What is the minimum number of moves needed to make b increasing (that is, every element is strictly greater than every element before it)?" 1300.0                                           
     1666K "Kingdom Partition" flows "The King is gone. After the King\'s rule, all the roads in the Kingdom are run down and need repair. Three of the King\'s children, Adrian, Beatrice and Cecilia, are dividing the Kingdom between themselves.Adrian and Beatrice do not like each other and do not plan to maintain any relations between themselves in the future. Cecilia is on good terms with both of them. Moreover, most of the Kingdom\'s workers support Cecilia, so she has better resources and more opportunity to repair the infrastructure and develop the economy. Cecilia proposes to partition the Kingdom into three districts: A (for Adrian), B (for Beatrice), and C (for Cecilia), and let Adrian and Beatrice to negotiate and choose any towns they want to be in their districts, and agree on how they want to partition the Kingdom into three districts.Adrian\'s castle is located in town a, and Beatrice\'s one is located in town b. So Adrian and Beatrice want their castles to be located in districts A and B, respectively. Cecilia doesn\'t have a castle, so district C can consist of no towns.There is an issue for Adrian and Beatrice. When they choose the towns, they will have to pay for the roads\' repair.The cost to repair the road of length l is 2l gold. However, Adrian and Beatrice don\'t have to bear all the repair costs. The repair cost for the road of length l that they bear depends on what towns it connects:  For a road between two towns inside district A, Adrian has to pay 2l gold;  For a road between two towns inside district B, Beatrice has to pay 2l gold;  For a road between towns from district A and district C, Adrian has to pay l gold, Cecilia bears the remaining cost;  For a road between towns from district B and district C, Beatrice has to pay l gold, Cecilia bears the remaining cost. The roads that connect towns from district A and district B won\'t be repaired, since Adrian and Beatrice are not planning to use them, so no one pays for them. Cecilia herself will repair the roads that connect the towns inside district C, so Adrian and Beatrice won\'t bear the cost of their repair either.Adrian and Beatrice want to minimize the total cost they spend on roads\' repair. Find the cheapest way for them to partition the Kingdom into three districts." 3200.0                                           
     1666A "Admissible Map"  "A map is a matrix consisting of symbols from the set of \'U\', \'L\', \'D\', and \'R\'.A map graph of a map matrix a is a directed graph with n\xe2\x8b\x85m vertices numbered as (i,j) (1\xe2\x89\xa4i\xe2\x89\xa4n;1\xe2\x89\xa4j\xe2\x89\xa4m), where n is the number of rows in the matrix, m is the number of columns in the matrix. The graph has n\xe2\x8b\x85m directed edges (i,j)\xe2\x86\x92(i+diai,j,j+djai,j), where (diU,djU)=(\xe2\x88\x921,0); (diL,djL)=(0,\xe2\x88\x921); (diD,djD)=(1,0); (diR,djR)=(0,1). A map graph is valid when all edges point to valid vertices in the graph.An admissible map is a map such that its map graph is valid and consists of a set of cycles.A description of a map a is a concatenation of all rows of the map \xe2\x80\x94 a string a1,1a1,2\xe2\x80\xa6a1,ma2,1\xe2\x80\xa6an,m.You are given a string s. Your task is to find how many substrings of this string can constitute a description of some admissible map. A substring of a string s1s2\xe2\x80\xa6sl of length l is defined by a pair of indices p and q (1\xe2\x89\xa4p\xe2\x89\xa4q\xe2\x89\xa4l) and is equal to spsp+1\xe2\x80\xa6sq. Two substrings of s are considered different when the pair of their indices (p,q) differs, even if they represent the same resulting string." 3300.0                                           
     1665B "Array Cloning Technique" "constructive algorithms,greedy,sortings" "You are given an array a of n integers. Initially there is only one copy of the given array.You can do operations of two types:  Choose any array and clone it. After that there is one more copy of the chosen array.  Swap two elements from any two copies (maybe in the same copy) on any positions. You need to find the minimal number of operations needed to obtain a copy where all elements are equal." 900.0                                           
     1662H Boundary "brute force,math" "Bethany would like to tile her bathroom. The bathroom has width w centimeters and length l centimeters. If Bethany simply used the basic tiles of size 1\xc3\x971 centimeters, she would use w\xe2\x8b\x85l of them. However, she has something different in mind.   On the interior of the floor she wants to use the 1\xc3\x971 tiles. She needs exactly (w\xe2\x88\x922)\xe2\x8b\x85(l\xe2\x88\x922) of these.  On the floor boundary she wants to use tiles of size 1\xc3\x97a for some positive integer a. The tiles can also be rotated by 90 degrees. For which values of a can Bethany tile the bathroom floor as described? Note that a can also be 1." -999.0                                           
     1662C "European Trip" dp,graphs,math,matrices "The map of Europe can be represented by a set of n cities, numbered from 1 through n, which are connected by m bidirectional roads, each of which connects two distinct cities. A trip of length k is a sequence of k+1 cities v1,v2,\xe2\x80\xa6,vk+1 such that there is a road connecting each consecutive pair vi, vi+1 of cities, for all 1\xe2\x89\xa4i\xe2\x89\xa4k. A special trip is a trip that does not use the same road twice in a row, i.e., a sequence of k+1 cities v1,v2,\xe2\x80\xa6,vk+1 such that it forms a trip and vi\xe2\x89\xa0vi+2, for all 1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x921.Given an integer k, compute the number of distinct special trips of length k which begin and end in the same city. Since the answer might be large, give the answer modulo 998244353." -999.0                                           
     1661E "Narrow Components" "brute force,data structures,dp,dsu,math,trees" "You are given a matrix a, consisting of 3 rows and n columns. Each cell of the matrix is either free or taken.A free cell y is reachable from a free cell x if at least one of these conditions hold:   x and y share a side;  there exists a free cell z such that z is reachable from x and y is reachable from z. A connected component is a set of free cells of the matrix such that all cells in it are reachable from one another, but adding any other free cell to the set violates this rule.You are asked q queries about the matrix. Each query is the following:   l r \xe2\x80\x94 count the number of connected components of the matrix, consisting of columns from l to r of the matrix a, inclusive. Print the answers to all queries." 2500.0                                           
     1660E "Matrix and Shifts" "brute force,constructive algorithms,greedy,implementation" "You are given a binary matrix A of size n\xc3\x97n. Rows are numbered from top to bottom from 1 to n, columns are numbered from left to right from 1 to n. The element located at the intersection of row i and column j is called Aij. Consider a set of 4 operations:  Cyclically shift all rows up. The row with index i will be written in place of the row i\xe2\x88\x921 (2\xe2\x89\xa4i\xe2\x89\xa4n), the row with index 1 will be written in place of the row n.  Cyclically shift all rows down. The row with index i will be written in place of the row i+1 (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), the row with index n will be written in place of the row 1.  Cyclically shift all columns to the left. The column with index j will be written in place of the column j\xe2\x88\x921 (2\xe2\x89\xa4j\xe2\x89\xa4n), the column with index 1 will be written in place of the column n.  Cyclically shift all columns to the right. The column with index j will be written in place of the column j+1 (1\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x921), the column with index n will be written in place of the column 1.   The 3\xc3\x973 matrix is shown on the left before the 3-rd operation is applied to it, on the right \xe2\x80\x94 after. You can perform an arbitrary (possibly zero) number of operations on the matrix; the operations can be performed in any order.After that, you can perform an arbitrary (possibly zero) number of new xor-operations:  Select any element Aij and assign it with new value Aij\xe2\x8a\x951. In other words, the value of (Aij+1)mod2 will have to be written into element Aij. Each application of this xor-operation costs one burl. Note that the 4 shift operations \xe2\x80\x94 are free. These 4 operations can only be performed before xor-operations are performed.Output the minimum number of burles you would have to pay to make the A matrix unitary. A unitary matrix is a matrix with ones on the main diagonal and the rest of its elements are zeros (that is, Aij=1 if i=j and Aij=0 otherwise)." 1600.0                                           
     1659E "AND-MEX Walk" "bitmasks,brute force,constructive algorithms,dfs and similar,dsu,graphs" "There is an undirected, connected graph with n vertices and m weighted edges. A walk from vertex u to vertex v is defined as a sequence of vertices p1,p2,\xe2\x80\xa6,pk (which are not necessarily distinct) starting with u and ending with v, such that pi and pi+1 are connected by an edge for 1\xe2\x89\xa4i<k.We define the length of a walk as follows: take the ordered sequence of edges and write down the weights on each of them in an array. Now, write down the bitwise AND of every nonempty prefix of this array. The length of the walk is the MEX of all these values.More formally, let us have [w1,w2,\xe2\x80\xa6,wk\xe2\x88\x921] where wi is the weight of the edge between pi and pi+1. Then the length of the walk is given by MEX({w1,w1&w2,\xe2\x80\xa6,w1&w2&\xe2\x80\xa6&wk\xe2\x88\x921}), where & denotes the bitwise AND operation.Now you must process q queries of the form u v. For each query, find the minimum possible length of a walk from u to v.The MEX (minimum excluded) of a set is the smallest non-negative integer that does not belong to the set. For instance:   The MEX of {2,1} is 0, because 0 does not belong to the set.  The MEX of {3,1,0} is 2, because 0 and 1 belong to the set, but 2 does not.  The MEX of {0,3,1,2} is 4 because 0, 1, 2 and 3 belong to the set, but 4 does not." 2200.0                                           
     1658C "Shinju and the Lost Permutation" "constructive algorithms,math" "Shinju loves permutations very much! Today, she has borrowed a permutation p from Juju to play with.The i-th cyclic shift of a permutation p is a transformation on the permutation such that p=[p1,p2,\xe2\x80\xa6,pn] will now become p=[pn\xe2\x88\x92i+1,\xe2\x80\xa6,pn,p1,p2,\xe2\x80\xa6,pn\xe2\x88\x92i].Let\'s define the power of permutation p as the number of distinct elements in the prefix maximums array b of the permutation. The prefix maximums array b is the array of length n such that bi=max(p1,p2,\xe2\x80\xa6,pi). For example, the power of [1,2,5,4,6,3] is 4 since b=[1,2,5,5,6,6] and there are 4 distinct elements in b.Unfortunately, Shinju has lost the permutation p! The only information she remembers is an array c, where ci is the power of the (i\xe2\x88\x921)-th cyclic shift of the permutation p. She\'s also not confident that she remembers it correctly, so she wants to know if her memory is good enough.Given the array c, determine if there exists a permutation p that is consistent with c. You do not have to construct the permutation p.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1700.0                                           
     1656C "Make Equal With Mod" "constructive algorithms,math,number theory,sortings" "You are given an array of n non-negative integers a1,a2,\xe2\x80\xa6,an. You can make the following operation: choose an integer x\xe2\x89\xa52 and replace each number of the array by the remainder when dividing that number by x, that is, for all 1\xe2\x89\xa4i\xe2\x89\xa4n set ai to aimodx.Determine if it is possible to make all the elements of the array equal by applying the operation zero or more times." 1200.0                                           
     1654D "Potion Brewing Class" "dfs and similar,math,number theory,trees" "Alice\'s potion making professor gave the following assignment to his students: brew a potion using n ingredients, such that the proportion of ingredient i in the final potion is ri>0 (and r1+r2+\xe2\x8b\xaf+rn=1).He forgot the recipe, and now all he remembers is a set of n\xe2\x88\x921 facts of the form, ""ingredients i and j should have a ratio of x to y"" (i.e., if ai and aj are the amounts of ingredient i and j in the potion respectively, then it must hold ai/aj=x/y), where x and y are positive integers. However, it is guaranteed that the set of facts he remembers is sufficient to uniquely determine the original values ri.He decided that he will allow the students to pass the class as long as they submit a potion which satisfies all of the n\xe2\x88\x921 requirements (there may be many such satisfactory potions), and contains a positive integer amount of each ingredient.Find the minimum total amount of ingredients needed to make a potion which passes the class. As the result can be very large, you should print the answer modulo 998244353." 2100.0                                           
     1654B "Prefix Removals" strings "You are given a string s consisting of lowercase letters of the English alphabet. You must perform the following algorithm on s:  Let x be the length of the longest prefix of s which occurs somewhere else in s as a contiguous substring (the other occurrence may also intersect the prefix). If x=0, break. Otherwise, remove the first x characters of s, and repeat. A prefix is a string consisting of several first letters of a given string, without any reorders. An empty prefix is also a valid prefix. For example, the string ""abcd"" has 5 prefixes: empty string, ""a"", ""ab"", ""abc"" and ""abcd"".For instance, if we perform the algorithm on s= ""abcabdc"",   Initially, ""ab"" is the longest prefix that also appears somewhere else as a substring in s, so s= ""cabdc"" after 1 operation.  Then, ""c"" is the longest prefix that also appears somewhere else as a substring in s, so s= ""abdc"" after 2 operations.  Now x=0 (because there are no non-empty prefixes of ""abdc"" that also appear somewhere else as a substring in s), so the algorithm terminates. Find the final state of the string after performing the algorithm." 800.0                                           
     1651B "Prove Him Wrong" "constructive algorithms,greedy" "Recently, your friend discovered one special operation on an integer array a:   Choose two indices i and j (i\xe2\x89\xa0j);  Set ai=aj=|ai\xe2\x88\x92aj|. After playing with this operation for a while, he came to the next conclusion:   For every array a of n integers, where 1\xe2\x89\xa4ai\xe2\x89\xa4109, you can find a pair of indices (i,j) such that the total sum of a will decrease after performing the operation. This statement sounds fishy to you, so you want to find a counterexample for a given integer n. Can you find such counterexample and prove him wrong?In other words, find an array a consisting of n integers a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4109) such that for all pairs of indices (i,j) performing the operation won\'t decrease the total sum (it will increase or not change the sum)." 800.0                                           
     1650A "Deletions of Two Adjacent Letters" implementation,strings "The string s is given, the string length is odd number. The string consists of lowercase letters of the Latin alphabet.As long as the string length is greater than 1, the following operation can be performed on it: select any two adjacent letters in the string s and delete them from the string. For example, from the string ""lemma"" in one operation, you can get any of the four strings: ""mma"", ""lma"", ""lea"" or ""lem"" In particular, in one operation, the length of the string reduces by 2.Formally, let the string s have the form s=s1s2\xe2\x80\xa6sn (n>1). During one operation, you choose an arbitrary index i (1\xe2\x89\xa4i<n) and replace s=s1s2\xe2\x80\xa6si\xe2\x88\x921si+2\xe2\x80\xa6sn.For the given string s and the letter c, determine whether it is possible to make such a sequence of operations that in the end the equality s=c will be true? In other words, is there such a sequence of operations that the process will end with a string of length 1, which consists of the letter c?" 800.0                                           
     1649A Game implementation "You are playing a very popular computer game. The next level consists of n consecutive locations, numbered from 1 to n, each of them containing either land or water. It is known that the first and last locations contain land, and for completing the level you have to move from the first location to the last. Also, if you become inside a location with water, you will die, so you can only move between locations with land.You can jump between adjacent locations for free, as well as no more than once jump from any location with land i to any location with land i+x, spending x coins (x\xe2\x89\xa50).Your task is to spend the minimum possible number of coins to move from the first location to the last one.Note that this is always possible since both the first and last locations are the land locations." 800.0                                           
     1648E "Air Reform" "data structures,dfs and similar,divide and conquer,dsu,graphs,implementation,trees" "Berland is a large country with developed airlines. In total, there are n cities in the country that are historically served by the Berlaflot airline. The airline operates bi-directional flights between m pairs of cities, i-th of them connects cities with numbers ai and bi and has a price ci for a flight in both directions.It is known that Berlaflot flights can be used to get from any city to any other (possibly with transfers), and the cost of any route that consists of several consequent flights is equal to the cost of the most expensive of them. More formally, the cost of the route from a city t1 to a city tk with (k\xe2\x88\x922) transfers using cities t2, t3, t4, \xe2\x80\xa6, tk\xe2\x88\x921 is equal to the maximum cost of flights from t1 to t2, from t2 to t3, from t3 to t4 and so on until the flight from tk\xe2\x88\x921 to tk. Of course, all these flights must be operated by Berlaflot.A new airline, S8 Airlines, has recently started operating in Berland. This airline provides bi-directional flights between all pairs of cities that are not connected by Berlaflot direct flights. Thus, between each pair of cities there is a flight of either Berlaflot or S8 Airlines.The cost of S8 Airlines flights is calculated as follows: for each pair of cities x and y that is connected by a S8 Airlines flight, the cost of this flight is equal to the minimum cost of the route between the cities x and y at Berlaflot according to the pricing described earlier.It is known that with the help of S8 Airlines flights you can get from any city to any other with possible transfers, and, similarly to Berlaflot, the cost of a route between any two cities that consists of several S8 Airlines flights is equal to the cost of the most expensive flight.Due to the increased competition with S8 Airlines, Berlaflot decided to introduce an air reform and change the costs of its flights. Namely, for the i-th of its flight between the cities ai and bi, Berlaflot wants to make the cost of this flight equal to the minimum cost of the route between the cities ai and bi at S8 Airlines. Help Berlaflot managers calculate new flight costs." 3200.0                                           
     1646C "Factorials and Powers of Two" "bitmasks,brute force,constructive algorithms,dp,math" "A number is called powerful if it is a power of two or a factorial. In other words, the number m is powerful if there exists a non-negative integer d such that m=2d or m=d!, where d!=1\xe2\x8b\x852\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85d (in particular, 0!=1). For example 1, 4, and 6 are powerful numbers, because 1=1!, 4=22, and 6=3! but 7, 10, or 18 are not.You are given a positive integer n. Find the minimum number k such that n can be represented as the sum of k distinct powerful numbers, or say that there is no such k." 1500.0                                           
     1646B "Quality vs Quantity" "brute force,constructive algorithms,greedy,sortings,two pointers" "You are given a sequence of n non-negative integers a1,a2,\xe2\x80\xa6,an. Initially, all the elements of the sequence are unpainted. You can paint each number Red_ or \xc2\xafBlue (but not both), or leave it unpainted. For a color c, Count(c) is the number of elements in the sequence painted with that color and Sum(c) is the sum of the elements in the sequence painted with that color.For example, if the given sequence is [2,8,6,3,1] and it is painted this way: [\xc2\xaf2,8,6_,\xc2\xaf3,1] (where 6 is painted red, 2 and 3 are painted blue, 1 and 8 are unpainted) then Sum(Red_)=6, Sum(\xc2\xafBlue)=2+3=5, Count(Red_)=1, and Count(\xc2\xafBlue)=2.Determine if it is possible to paint the sequence so that Sum(Red_)>Sum(\xc2\xafBlue) and Count(Red_)<Count(\xc2\xafBlue)." 800.0                                           
     1642B "Power Walking" greedy "Sam is a kindergartener, and there are n children in his group. He decided to create a team with some of his children to play ""brawl:go 2"".Sam has n power-ups, the i-th has type ai. A child\'s strength is equal to the number of different types among power-ups he has.For a team of size k, Sam will distribute all n power-ups to k children in such a way that each of the k children receives at least one power-up, and each power-up is given to someone.For each integer k from 1 to n, find the minimum sum of strengths of a team of k children Sam can get." 900.0                                           
     1641D "Two Arrays" "bitmasks,brute force,combinatorics,greedy,hashing,math,two pointers" "Sam changed his school and on the first biology lesson he got a very interesting task about genes.You are given n arrays, the i-th of them contains m different integers \xe2\x80\x94 ai,1,ai,2,\xe2\x80\xa6,ai,m. Also you are given an array of integers w of length n.Find the minimum value of wi+wj among all pairs of integers (i,j) (1\xe2\x89\xa4i,j\xe2\x89\xa4n), such that the numbers ai,1,ai,2,\xe2\x80\xa6,ai,m,aj,1,aj,2,\xe2\x80\xa6,aj,m are distinct." 2700.0                                           
     1639C "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999.0                                           
     1639B "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999.0                                           
     1639A "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999.0                                           
     1638B "Odd Swap Sort" "data structures,math,sortings" "You are given an array a1,a2,\xe2\x80\xa6,an. You can perform operations on the array. In each operation you can choose an integer i (1\xe2\x89\xa4i<n), and swap elements ai and ai+1 of the array, if ai+ai+1 is odd.Determine whether it can be sorted in non-decreasing order using this operation any number of times." 1100.0                                           
     1637H "Minimize Inversions Number" "data structures,greedy,math,sortings" "You are given a permutation p of length n.You can choose any subsequence, remove it from the permutation, and insert it at the beginning of the permutation keeping the same order.For every k from 0 to n, find the minimal possible number of inversions in the permutation after you choose a subsequence of length exactly k." 3500.0                                           
     1635A "Min Or Sum" bitmasks,greedy "You are given an array a of size n.You can perform the following operation on the array:   Choose two different integers i,j (1\xe2\x89\xa4i<j\xe2\x89\xa4n), replace ai with x and aj with y. In order not to break the array, ai|aj=x|y must be held, where | denotes the bitwise OR operation. Notice that x and y are non-negative integers. Please output the minimum sum of the array you can get after using the operation above any number of times." 800.0                                           
     1633B Minority greedy "You are given a string s, consisting only of characters \'0\' and \'1\'.You have to choose a contiguous substring of s and remove all occurrences of the character, which is a strict minority in it, from the substring.That is, if the amount of \'0\'s in the substring is strictly smaller than the amount of \'1\'s, remove all occurrences of \'0\' from the substring. If the amount of \'1\'s is strictly smaller than the amount of \'0\'s, remove all occurrences of \'1\'. If the amounts are the same, do nothing.You have to apply the operation exactly once. What is the maximum amount of characters that can be removed?" 800.0                                           
     1630F "Making It Bipartite" "flows,graph matchings,graphs,number theory" "You are given an undirected graph of n vertices indexed from 1 to n, where vertex i has a value ai assigned to it and all values ai are different. There is an edge between two vertices u and v if either au divides av or av divides au.Find the minimum number of vertices to remove such that the remaining graph is bipartite, when you remove a vertex you remove all the edges incident to it." 3400.0                                           
     1630D "Flipping Range" "constructive algorithms,dp,greedy,number theory" "You are given an array a of n integers and a set B of m positive integers such that 1\xe2\x89\xa4bi\xe2\x89\xa4\xe2\x8c\x8an2\xe2\x8c\x8b for 1\xe2\x89\xa4i\xe2\x89\xa4m, where bi is the i-th element of B. You can make the following operation on a:  Select some x such that x appears in B. Select an interval from array a of size x and multiply by \xe2\x88\x921 every element in the interval. Formally, select l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and r\xe2\x88\x92l+1=x, then assign ai:=\xe2\x88\x92ai for every i such that l\xe2\x89\xa4i\xe2\x89\xa4r. Consider the following example, let a=[0,6,\xe2\x88\x922,1,\xe2\x88\x924,5] and B={1,2}:  [0,6,\xe2\x88\x922,\xe2\x88\x921,4,5] is obtained after choosing size 2 and l=4, r=5. [0,6,2,\xe2\x88\x921,4,5] is obtained after choosing size 1 and l=3, r=3. Find the maximum n\xe2\x88\x91i=1ai you can get after applying such operation any number of times (possibly zero)." 2400.0                                           
     1629B "GCD Arrays" "greedy,math,number theory" "Consider the array a composed of all the integers in the range [l,r]. For example, if l=3 and r=7, then a=[3,4,5,6,7].Given l, r, and k, is it possible for gcd(a) to be greater than 1 after doing the following operation at most k times?   Choose 2 numbers from a.  Permanently remove one occurrence of each of them from the array.  Insert their product back into a. gcd(b) denotes the greatest common divisor (GCD) of the integers in b." 800.0                                           
     1628C "Grid Xor" "constructive algorithms,greedy,implementation,interactive,math" "Note: The XOR-sum of set {s1,s2,\xe2\x80\xa6,sm} is defined as s1\xe2\x8a\x95s2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95sm, where \xe2\x8a\x95 denotes the bitwise XOR operation.After almost winning IOI, Victor bought himself an n\xc3\x97n grid containing integers in each cell. n is an even integer. The integer in the cell in the i-th row and j-th column is ai,j.Sadly, Mihai stole the grid from Victor and told him he would return it with only one condition: Victor has to tell Mihai the XOR-sum of all the integers in the whole grid.Victor doesn\'t remember all the elements of the grid, but he remembers some information about it: For each cell, Victor remembers the XOR-sum of all its neighboring cells.Two cells are considered neighbors if they share an edge \xe2\x80\x94 in other words, for some integers 1\xe2\x89\xa4i,j,k,l\xe2\x89\xa4n, the cell in the i-th row and j-th column is a neighbor of the cell in the k-th row and l-th column if |i\xe2\x88\x92k|=1 and j=l, or if i=k and |j\xe2\x88\x92l|=1.To get his grid back, Victor is asking you for your help. Can you use the information Victor remembers to find the XOR-sum of the whole grid?It can be proven that the answer is unique." 2300.0                                           
     1628A "Meximum Array" "binary search,constructive algorithms,greedy,implementation,math,two pointers" "Mihai has just learned about the MEX concept and since he liked it so much, he decided to use it right away.Given an array a of n non-negative integers, Mihai wants to create a new array b that is formed in the following way:While a is not empty:   Choose an integer k (1\xe2\x89\xa4k\xe2\x89\xa4|a|).  Append the MEX of the first k numbers of the array a to the end of array b and erase them from the array a, shifting the positions of the remaining numbers in a. But, since Mihai loves big arrays as much as the MEX concept, he wants the new array b to be the lexicographically maximum. So, Mihai asks you to tell him what the maximum array b that can be created by constructing the array optimally is.An array x is lexicographically greater than an array y if in the first position where x and y differ xi>yi or if |x|>|y| and y is a prefix of x (where |x| denotes the size of the array x).The MEX of a set of non-negative integers is the minimal non-negative integer such that it is not in the set. For example, MEX({1,2,3}) =0 and MEX({0,1,2,4,5}) =3." 1400.0                                           
     1627C "Not Assigning" "constructive algorithms,dfs and similar,number theory,trees" "You are given a tree of n vertices numbered from 1 to n, with edges numbered from 1 to n\xe2\x88\x921. A tree is a connected undirected graph without cycles. You have to assign integer weights to each edge of the tree, such that the resultant graph is a prime tree.A prime tree is a tree where the weight of every path consisting of one or two edges is prime. A path should not visit any vertex twice. The weight of a path is the sum of edge weights on that path.Consider the graph below. It is a prime tree as the weight of every path of two or less edges is prime. For example, the following path of two edges: 2\xe2\x86\x921\xe2\x86\x923 has a weight of 11+2=13, which is prime. Similarly, the path of one edge: 4\xe2\x86\x923 has a weight of 5, which is also prime.  Print any valid assignment of weights such that the resultant tree is a prime tree. If there is no such assignment, then print \xe2\x88\x921. It can be proven that if a valid assignment exists, one exists with weights between 1 and 105 as well." 1400.0                                           
     1627A "Not Shading" "constructive algorithms,implementation" "There is a grid with n rows and m columns. Some cells are colored black, and the rest of the cells are colored white.In one operation, you can select some black cell and do exactly one of the following:   color all cells in its row black, or  color all cells in its column black. You are given two integers r and c. Find the minimum number of operations required to make the cell in row r and column c black, or determine that it is impossible." 800.0                                           
     1625A "Ancient Civilization" bitmasks,greedy,math "Martian scientists explore Ganymede, one of Jupiter\'s numerous moons. Recently, they have found ruins of an ancient civilization. The scientists brought to Mars some tablets with writings in a language unknown to science.They found out that the inhabitants of Ganymede used an alphabet consisting of two letters, and each word was exactly \xe2\x84\x93 letters long. So, the scientists decided to write each word of this language as an integer from 0 to 2\xe2\x84\x93\xe2\x88\x921 inclusively. The first letter of the alphabet corresponds to zero bit in this integer, and the second letter corresponds to one bit.The same word may have various forms in this language. Then, you need to restore the initial form. The process of doing it is described below.Denote the distance between two words as the amount of positions, in which these words differ. For example, the distance between 10012 and 11002 (in binary) is equal to two, as these words have different letters in the second and the fourth positions, counting from left to right. Further, denote the distance between words x and y as d(x,y).Let the word have n forms, the i-th of which is described with an integer xi. All the xi are not necessarily different, as two various forms of the word can be written the same. Consider some word y. Then, closeness of the word y is equal to the sum of distances to each of the word forms, i. e. the sum d(xi,y) over all 1\xe2\x89\xa4i\xe2\x89\xa4n.The initial form is the word y with minimal possible nearness.You need to help the scientists and write the program which finds the initial form of the word given all its known forms. Note that the initial form is not necessarily equal to any of the n given forms." 800.0                                           
     1624B "Make AP" implementation,math "Polycarp has 3 positive integers a, b and c. He can perform the following operation exactly once.  Choose a positive integer m and multiply exactly one of the integers a, b or c by m. Can Polycarp make it so that after performing the operation, the sequence of three numbers a, b, c (in this order) forms an arithmetic progression? Note that you cannot change the order of a, b and c.Formally, a sequence x1,x2,\xe2\x80\xa6,xn is called an arithmetic progression (AP) if there exists a number d (called ""common difference"") such that xi+1=xi+d for all i from 1 to n\xe2\x88\x921. In this problem, n=3.For example, the following sequences are AP: [5,10,15], [3,2,1], [1,1,1], and [13,10,7]. The following sequences are not AP: [1,2,4], [0,1,0] and [1,3,2].You need to answer t independent test cases." 900.0                                           
     1623A "Robot Cleaner" "brute force,implementation,math" "A robot cleaner is placed on the floor of a rectangle room, surrounded by walls. The floor consists of nn rows and mm columns. The rows of the floor are numbered from 11 to nn from top to bottom, and columns of the floor are numbered from 11 to mm from left to right. The cell on the intersection of the rr-th row and the cc-th column is denoted as (r,c)(r,c). The initial position of the robot is (rb,cb)(rb,cb).In one second, the robot moves by drdr rows and dcdc columns, that is, after one second, the robot moves from the cell (r,c)(r,c) to (r+dr,c+dc)(r+dr,c+dc). Initially dr=1dr=1, dc=1dc=1. If there is a vertical wall (the left or the right walls) in the movement direction, dcdc is reflected before the movement, so the new value of dcdc is \xe2\x88\x92dc\xe2\x88\x92dc. And if there is a horizontal wall (the upper or lower walls), drdr is reflected before the movement, so the new value of drdr is \xe2\x88\x92dr\xe2\x88\x92dr.Each second (including the moment before the robot starts moving), the robot cleans every cell lying in the same row or the same column as its position. There is only one dirty cell at (rd,cd)(rd,cd). The job of the robot is to clean that dirty cell.  Illustration for the first example. The blue arc is the robot. The red star is the target dirty cell. Each second the robot cleans a row and a column, denoted by yellow stripes. Given the floor size nn and mm, the robot\'s initial position (rb,cb)(rb,cb) and the dirty cell\'s position (rd,cd)(rd,cd), find the time for the robot to do its job." 800.0                                           
     1622B "Berland Music" "data structures,greedy,math,sortings" "Berland Music is a music streaming service built specifically to support Berland local artist. Its developers are currently working on a song recommendation module.So imagine Monocarp got recommended n songs, numbered from 1 to n. The i-th song had its predicted rating equal to pi, where 1\xe2\x89\xa4pi\xe2\x89\xa4n and every integer from 1 to n appears exactly once. In other words, p is a permutation.After listening to each of them, Monocarp pressed either a like or a dislike button. Let his vote sequence be represented with a string s, such that si=0 means that he disliked the i-th song, and si=1 means that he liked it.Now the service has to re-evaluate the song ratings in such a way that:  the new ratings q1,q2,\xe2\x80\xa6,qn still form a permutation (1\xe2\x89\xa4qi\xe2\x89\xa4n; each integer from 1 to n appears exactly once);  every song that Monocarp liked should have a greater rating than every song that Monocarp disliked (formally, for all i,j such that si=1 and sj=0, qi>qj should hold). Among all valid permutations q find the one that has the smallest value of n\xe2\x88\x91i=1|pi\xe2\x88\x92qi|, where |x| is an absolute value of x.Print the permutation q1,q2,\xe2\x80\xa6,qn. If there are multiple answers, you can print any of them." 1000.0                                           
     1621I "Two Sequences" "data structures,hashing,string suffix structures" "Consider an array of integers C=[c1,c2,\xe2\x80\xa6,cn] of length n. Let\'s build the sequence of arrays D0,D1,D2,\xe2\x80\xa6,Dn of length n+1 in the following way:  The first element of this sequence will be equals C: D0=C.  For each 1\xe2\x89\xa4i\xe2\x89\xa4n array Di will be constructed from Di\xe2\x88\x921 in the following way:   Let\'s find the lexicographically smallest subarray of Di\xe2\x88\x921 of length i. Then, the first n\xe2\x88\x92i elements of Di will be equals to the corresponding n\xe2\x88\x92i elements of array Di\xe2\x88\x921 and the last i elements of Di will be equals to the corresponding elements of the found subarray of length i.  Array x is subarray of array y, if x can be obtained by deletion of several (possibly, zero or all) elements from the beginning of y and several (possibly, zero or all) elements from the end of y.For array C let\'s denote array Dn as op(C).Alice has an array of integers A=[a1,a2,\xe2\x80\xa6,an] of length n. She will build the sequence of arrays B0,B1,\xe2\x80\xa6,Bn of length n+1 in the following way:  The first element of this sequence will be equals A: B0=A.  For each 1\xe2\x89\xa4i\xe2\x89\xa4n array Bi will be equals op(Bi\xe2\x88\x921), where op is the transformation described above. She will ask you q queries about elements of sequence of arrays B0,B1,\xe2\x80\xa6,Bn. Each query consists of two integers i and j, and the answer to this query is the value of the j-th element of array Bi." 3500.0                                           
     1621C "Hidden Permutations" "dfs and similar,interactive,math" "This is an interactive problem.The jury has a permutation p of length n and wants you to guess it. For this, the jury created another permutation q of length n. Initially, q is an identity permutation (qi=i for all i).You can ask queries to get qi for any i you want. After each query, the jury will change q in the following way:   At first, the jury will create a new permutation q\xe2\x80\xb2 of length n such that q\xe2\x80\xb2i=qpi for all i.  Then the jury will replace permutation q with pemutation q\xe2\x80\xb2. You can make no more than 2n queries in order to quess p." 1700.0                                           
     1620F "Bipartite Array" dp,greedy "You are given a permutation p consisting of n integers 1,2,\xe2\x80\xa6,n (a permutation is an array where each element from 1 to n occurs exactly once).Let\'s call an array a bipartite if the following undirected graph is bipartite:  the graph consists of n vertices;  two vertices i and j are connected by an edge if i<j and ai>aj. Your task is to find a bipartite array of integers a of size n, such that ai=pi or ai=\xe2\x88\x92pi, or report that no such array exists. If there are multiple answers, print any of them." 2800.0                                           
     1620D "Exact Change" "brute force,constructive algorithms,greedy" "One day, early in the morning, you decided to buy yourself a bag of chips in the nearby store. The store has chips of n different flavors. A bag of the i-th flavor costs ai burles.The store may run out of some flavors, so you\'ll decide which one to buy after arriving there. But there are two major flaws in this plan:   you have only coins of 1, 2 and 3 burles;  since it\'s morning, the store will ask you to pay in exact change, i. e. if you choose the i-th flavor, you\'ll have to pay exactly ai burles. Coins are heavy, so you\'d like to take the least possible number of coins in total. That\'s why you are wondering: what is the minimum total number of coins you should take with you, so you can buy a bag of chips of any flavor in exact change?" 2000.0                                           
     1620B "Triangles on a Rectangle" geometry,greedy,math "A rectangle with its opposite corners in (0,0) and (w,h) and sides parallel to the axes is drawn on a plane.You are given a list of lattice points such that each point lies on a side of a rectangle but not in its corner. Also, there are at least two points on every side of a rectangle.Your task is to choose three points in such a way that:   exactly two of them belong to the same side of a rectangle;  the area of a triangle formed by them is maximum possible. Print the doubled area of this triangle. It can be shown that the doubled area of any triangle formed by lattice points is always an integer." 1000.0                                           
     1619D "New Year\'s Problem" "binary search,greedy,sortings" "Vlad has n friends, for each of whom he wants to buy one gift for the New Year.There are m shops in the city, in each of which he can buy a gift for any of his friends. If the j-th friend (1\xe2\x89\xa4j\xe2\x89\xa4n) receives a gift bought in the shop with the number i (1\xe2\x89\xa4i\xe2\x89\xa4m), then the friend receives pij units of joy. The rectangular table pij is given in the input.Vlad has time to visit at most n\xe2\x88\x921 shops (where n is the number of friends). He chooses which shops he will visit and for which friends he will buy gifts in each of them.Let the j-th friend receive aj units of joy from Vlad\'s gift. Let\'s find the value \xce\xb1=min{a1,a2,\xe2\x80\xa6,an}. Vlad\'s goal is to buy gifts so that the value of \xce\xb1 is as large as possible. In other words, Vlad wants to maximize the minimum of the joys of his friends.For example, let m=2, n=2. Let the joy from the gifts that we can buy in the first shop: p11=1, p12=2, in the second shop: p21=3, p22=4.Then it is enough for Vlad to go only to the second shop and buy a gift for the first friend, bringing joy 3, and for the second \xe2\x80\x94 bringing joy 4. In this case, the value \xce\xb1 will be equal to min{3,4}=3Help Vlad choose gifts for his friends so that the value of \xce\xb1 is as high as possible. Please note that each friend must receive one gift. Vlad can visit at most n\xe2\x88\x921 shops (where n is the number of friends). In the shop, he can buy any number of gifts." 1800.0                                           
     1618A "Polycarp and Sums of Subsequences" math,sortings "Polycarp had an array a of 3 positive integers. He wrote out the sums of all non-empty subsequences of this array, sorted them in non-decreasing order, and got an array b of 7 integers.For example, if a={1,4,3}, then Polycarp wrote out 1, 4, 3, 1+4=5, 1+3=4, 4+3=7, 1+4+3=8. After sorting, he got an array b={1,3,4,4,5,7,8}.Unfortunately, Polycarp lost the array a. He only has the array b left. Help him to restore the array a." 800.0                                           
     1617D1 "Too Many Impostors (easy version)" "constructive algorithms,implementation,interactive" "This is an interactive problem. The only difference between the easy and hard version is the limit on number of questions.There are n players labelled from 1 to n. It is guaranteed that n is a multiple of 3.Among them, there are k impostors and n\xe2\x88\x92k crewmates. The number of impostors, k, is not given to you. It is guaranteed that n3<k<2n3.In each question, you can choose three distinct integers a, b, c (1\xe2\x89\xa4a,b,c\xe2\x89\xa4n) and ask: ""Among the players labelled a, b and c, are there more impostors or more crewmates?"" You will be given the integer 0 if there are more impostors than crewmates, and 1 otherwise.Find the number of impostors k and the indices of players that are impostors after asking at most 2n questions.The jury is adaptive, which means the indices of impostors may not be fixed beforehand and can depend on your questions. It is guaranteed that there is at least one set of impostors which fulfills the constraints and the answers to your questions at any time." 1800.0                                           
     1617C "Paprika and Permutation" "binary search,greedy,math,sortings" "Paprika loves permutations. She has an array a1,a2,\xe2\x80\xa6,an. She wants to make the array a permutation of integers 1 to n.In order to achieve this goal, she can perform operations on the array. In each operation she can choose two integers i (1\xe2\x89\xa4i\xe2\x89\xa4n) and x (x>0), then perform ai:=aimodx (that is, replace ai by the remainder of ai divided by x). In different operations, the chosen i and x can be different.Determine the minimum number of operations needed to make the array a permutation of integers 1 to n. If it is impossible, output \xe2\x88\x921.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1300.0                                           
     1616D "Keep the Average High" dp,greedy,math "You are given an array of integers a1,a2,\xe2\x80\xa6,an and an integer x.You need to select the maximum number of elements in the array, such that for every subsegment al,al+1,\xe2\x80\xa6,ar containing strictly more than one element (l<r), either:   At least one element on this subsegment is not selected, or  al+al+1+\xe2\x80\xa6+ar\xe2\x89\xa5x\xe2\x8b\x85(r\xe2\x88\x92l+1)." 2000.0                                           
     1613F "Tree Coloring" "combinatorics,divide and conquer,fft" "You are given a rooted tree consisting of n vertices numbered from 1 to n. The root of the tree is the vertex 1.You have to color all vertices of the tree into n colors (also numbered from 1 to n) so that there is exactly one vertex for each color. Let ci be the color of vertex i, and pi be the parent of vertex i in the rooted tree. The coloring is considered beautiful if there is no vertex k (k>1) such that ck=cpk\xe2\x88\x921, i.\xe2\x80\x89e. no vertex such that its color is less than the color of its parent by exactly 1.Calculate the number of beautiful colorings, and print it modulo 998244353." 2600.0                                           
     1613E "Crazy Robot" "dfs and similar,graphs" "There is a grid, consisting of n rows and m columns. Each cell of the grid is either free or blocked. One of the free cells contains a lab. All the cells beyond the borders of the grid are also blocked.A crazy robot has escaped from this lab. It is currently in some free cell of the grid. You can send one of the following commands to the robot: ""move right"", ""move down"", ""move left"" or ""move up"". Each command means moving to a neighbouring cell in the corresponding direction.However, as the robot is crazy, it will do anything except following the command. Upon receiving a command, it will choose a direction such that it differs from the one in command and the cell in that direction is not blocked. If there is such a direction, then it will move to a neighbouring cell in that direction. Otherwise, it will do nothing.We want to get the robot to the lab to get it fixed. For each free cell, determine if the robot can be forced to reach the lab starting in this cell. That is, after each step of the robot a command can be sent to a robot such that no matter what different directions the robot chooses, it will end up in a lab." 2000.0                                           
     1612G "Max Sum Array" "combinatorics,constructive algorithms,greedy,sortings" "You are given an array c=[c1,c2,\xe2\x80\xa6,cm]. An array a=[a1,a2,\xe2\x80\xa6,an] is constructed in such a way that it consists of integers 1,2,\xe2\x80\xa6,m, and for each i\xe2\x88\x88[1,m], there are exactly ci occurrences of integer i in a. So, the number of elements in a is exactly m\xe2\x88\x91i=1ci.Let\'s define for such array a the value f(a) as f(a)=\xe2\x88\x911\xe2\x89\xa4i<j\xe2\x89\xa4nai=ajj\xe2\x88\x92i.In other words, f(a) is the total sum of distances between all pairs of equal elements.Your task is to calculate the maximum possible value of f(a) and the number of arrays yielding the maximum possible value of f(a). Two arrays are considered different, if elements at some position differ." 2500.0                                           
     1612C "Chat Ban" "binary search,math" "You are a usual chat user on the most famous streaming platform. Of course, there are some moments when you just want to chill and spam something.More precisely, you want to spam the emote triangle of size k. It consists of 2k\xe2\x88\x921 messages. The first message consists of one emote, the second one \xe2\x80\x94 of two emotes, ..., the k-th one \xe2\x80\x94 of k emotes, the k+1-th one \xe2\x80\x94 of k\xe2\x88\x921 emotes, ..., and the last one \xe2\x80\x94 of one emote.For example, the emote triangle for k=3 consists of 5 messages:  Of course, most of the channels have auto moderation. Auto moderator of the current chat will ban you right after you spam at least x emotes in succession (you can assume you are the only user in the chat). Now you are interested \xe2\x80\x94 how many messages will you write before getting banned? Or maybe you will not get banned at all (i.e. will write all 2k\xe2\x88\x921 messages and complete your emote triangle successfully)? Note that if you get banned as a result of writing a message, this message is also counted.You have to answer t independent test cases." 1300.0                                           
     1611E2 "Escape The Maze (hard version)" "dfs and similar,dp,greedy,shortest paths,trees" "The only difference with E1 is the question of the problem.Vlad built a maze out of n rooms and n\xe2\x88\x921 bidirectional corridors. From any room u any other room v can be reached through a sequence of corridors. Thus, the room system forms an undirected tree.Vlad invited k friends to play a game with them.Vlad starts the game in the room 1 and wins if he reaches a room other than 1, into which exactly one corridor leads. Friends are placed in the maze: the friend with number i is in the room xi, and no two friends are in the same room (that is, xi\xe2\x89\xa0xj for all i\xe2\x89\xa0j). Friends win if one of them meets Vlad in any room or corridor before he wins.For one unit of time, each participant of the game can go through one corridor. All participants move at the same time. Participants may not move. Each room can fit all participants at the same time.Friends know the plan of a maze and intend to win. They don\'t want to waste too much energy. They ask you to determine if they can win and if they can, what minimum number of friends must remain in the maze so that they can always catch Vlad.In other words, you need to determine the size of the minimum (by the number of elements) subset of friends who can catch Vlad or say that such a subset does not exist." 1900.0                                           
     1610H "Squid Game" "data structures,dfs and similar,greedy,trees" "After watching the new over-rated series Squid Game, Mashtali and Soroush decided to hold their own Squid Games! Soroush agreed to be the host and will provide money for the winner\'s prize, and Mashtali became the Front Man!m players registered to play in the games to win the great prize, but when Mashtali found out how huge the winner\'s prize is going to be, he decided to kill eliminate all the players so he could take the money for himself!Here is how evil Mashtali is going to eliminate players:There is an unrooted tree with n vertices. Every player has 2 special vertices xi and yi.In one operation, Mashtali can choose any vertex v of the tree. Then, for each remaining player i he finds a vertex w on the simple path from xi to yi, which is the closest to v. If w\xe2\x89\xa0xi and w\xe2\x89\xa0yi, player i will be eliminated.Now Mashtali wondered: ""What is the minimum number of operations I should perform so that I can remove every player from the game and take the money for myself?""Since he was only thinking about the money, he couldn\'t solve the problem by himself and asked for your help!" 3100.0                                           
     1609G "A Stroll Around the Matrix" "data structures,greedy,math" "William has two arrays of numbers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bm. The arrays satisfy the conditions of being convex. Formally an array c of length k is considered convex if ci\xe2\x88\x92ci\xe2\x88\x921<ci+1\xe2\x88\x92ci for all i from 2 to k\xe2\x88\x921 and c1<c2.Throughout William\'s life he observed q changes of two types happening to the arrays:   Add the arithmetic progression d,d\xe2\x8b\x852,d\xe2\x8b\x853,\xe2\x80\xa6,d\xe2\x8b\x85k to the suffix of the array a of length k. The array after the change looks like this: [a1,a2,\xe2\x80\xa6,an\xe2\x88\x92k,an\xe2\x88\x92k+1+d,an\xe2\x88\x92k+2+d\xe2\x8b\x852,\xe2\x80\xa6,an+d\xe2\x8b\x85k].  The same operation, but for array b. After each change a matrix d is created from arrays a and b, of size n\xc3\x97m, where di,j=ai+bj. William wants to get from cell (1,1) to cell (n,m) of this matrix. From cell (x,y) he can only move to cells (x+1,y) and (x,y+1). The length of a path is calculated as the sum of numbers in cells visited by William, including the first and the last cells.After each change William wants you to help find out the minimal length of the path he could take." 3000.0                                           
     1609E "William The Oblivious" "bitmasks,data structures,dp,matrices" "Before becoming a successful trader William got a university degree. During his education an interesting situation happened, after which William started to listen to homework assignments much more attentively. What follows is a formal description of the homework assignment as William heard it:You are given a string s of length n only consisting of characters ""a"", ""b"" and ""c"". There are q queries of format (pos,c), meaning replacing the element of string s at position pos with character c. After each query you must output the minimal number of characters in the string, which have to be replaced, so that the string doesn\'t contain string ""abc"" as a subsequence. A valid replacement of a character is replacing it with ""a"", ""b"" or ""c"".A string x is said to be a subsequence of string y if x can be obtained from y by deleting some characters without changing the ordering of the remaining characters." 2400.0                                           
     1607C "Minimum Extraction" "brute force,sortings" "Yelisey has an array a of n integers.If a has length strictly greater than 1, then Yelisei can apply an operation called minimum extraction to it:   First, Yelisei finds the minimal number m in the array. If there are several identical minima, Yelisey can choose any of them.  Then the selected minimal element is removed from the array. After that, m is subtracted from each remaining element. Thus, after each operation, the length of the array is reduced by 1.For example, if a=[1,6,\xe2\x88\x924,\xe2\x88\x922,\xe2\x88\x924], then the minimum element in it is a3=\xe2\x88\x924, which means that after this operation the array will be equal to a=[1\xe2\x88\x92(\xe2\x88\x924),6\xe2\x88\x92(\xe2\x88\x924),\xe2\x88\x922\xe2\x88\x92(\xe2\x88\x924),\xe2\x88\x924\xe2\x88\x92(\xe2\x88\x924)]=[5,10,2,0].Since Yelisey likes big numbers, he wants the numbers in the array a to be as big as possible.Formally speaking, he wants to make the minimum of the numbers in array a to be maximal possible (i.e. he want to maximize a minimum). To do this, Yelisey can apply the minimum extraction operation to the array as many times as he wants (possibly, zero). Note that the operation cannot be applied to an array of length 1.Help him find what maximal value can the minimal element of the array have after applying several (possibly, zero) minimum extraction operations to the array." 1000.0                                           
     1607B "Odd Grasshopper" math "The grasshopper is located on the numeric axis at the point with coordinate x0.Having nothing else to do he starts jumping between integer points on the axis. Making a jump from a point with coordinate x with a distance d to the left moves the grasshopper to a point with a coordinate x\xe2\x88\x92d, while jumping to the right moves him to a point with a coordinate x+d.The grasshopper is very fond of positive integers, so for each integer i starting with 1 the following holds: exactly i minutes after the start he makes a jump with a distance of exactly i. So, in the first minutes he jumps by 1, then by 2, and so on.The direction of a jump is determined as follows: if the point where the grasshopper was before the jump has an even coordinate, the grasshopper jumps to the left, otherwise he jumps to the right.For example, if after 18 consecutive jumps he arrives at the point with a coordinate 7, he will jump by a distance of 19 to the right, since 7 is an odd number, and will end up at a point 7+19=26. Since 26 is an even number, the next jump the grasshopper will make to the left by a distance of 20, and it will move him to the point 26\xe2\x88\x9220=6.Find exactly which point the grasshopper will be at after exactly n jumps." 900.0                                           
     1607A "Linear Keyboard" implementation,strings "You are given a keyboard that consists of 26 keys. The keys are arranged sequentially in one row in a certain order. Each key corresponds to a unique lowercase Latin letter.You have to type the word s on this keyboard. It also consists only of lowercase Latin letters.To type a word, you need to type all its letters consecutively one by one. To type each letter you must position your hand exactly over the corresponding key and press it.Moving the hand between the keys takes time which is equal to the absolute value of the difference between positions of these keys (the keys are numbered from left to right). No time is spent on pressing the keys and on placing your hand over the first letter of the word.For example, consider a keyboard where the letters from \'a\' to \'z\' are arranged in consecutive alphabetical order. The letters \'h\', \'e\', \'l\' and \'o\' then are on the positions 8, 5, 12 and 15, respectively. Therefore, it will take |5\xe2\x88\x928|+|12\xe2\x88\x925|+|12\xe2\x88\x9212|+|15\xe2\x88\x9212|=13 units of time to type the word ""hello"". Determine how long it will take to print the word s." 800.0                                           
     1606B "Update Files" greedy,implementation,math "Berland State University has received a new update for the operating system. Initially it is installed only on the 1-st computer.Update files should be copied to all n computers. The computers are not connected to the internet, so the only way to transfer update files from one computer to another is to copy them using a patch cable (a cable connecting two computers directly). Only one patch cable can be connected to a computer at a time. Thus, from any computer where the update files are installed, they can be copied to some other computer in exactly one hour.Your task is to find the minimum number of hours required to copy the update files to all n computers if there are only k patch cables in Berland State University." 1100.0                                           
     1605F PalindORme combinatorics,dp "An integer array a of length n is said to be a PalindORme if (a1 | a2 | \xe2\x80\xa6 | ai)=(an\xe2\x88\x92i+1 | \xe2\x80\xa6 | an\xe2\x88\x921 | an) for all 1\xe2\x89\xa4i\xe2\x89\xa4n, where | denotes the bitwise OR operation.An integer array a of length n is considered to be good if its elements can be rearranged to form a PalindORme. Formally, array a is good if there exists a permutation p1,p2,\xe2\x80\xa6pn (an array where each integer from 1 to n appears exactly once) for which ap1,ap2,\xe2\x80\xa6apn is a PalindORme.Find the number of good arrays of length n, consisting only of integers in the range [0,2k\xe2\x88\x921], and print it modulo some prime m.Two arrays a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn are considered to be different if there exists any i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that ai\xe2\x89\xa0bi." 2900.0                                           
     1605E "Array Equalizer" "binary search,greedy,implementation,math,number theory,sortings,two pointers" "Jeevan has two arrays a and b of size n. He is fond of performing weird operations on arrays. This time, he comes up with two types of operations:  Choose any i (1\xe2\x89\xa4i\xe2\x89\xa4n) and increment aj by 1 for every j which is a multiple of i and 1\xe2\x89\xa4j\xe2\x89\xa4n.  Choose any i (1\xe2\x89\xa4i\xe2\x89\xa4n) and decrement aj by 1 for every j which is a multiple of i and 1\xe2\x89\xa4j\xe2\x89\xa4n. He wants to convert array a into an array b using the minimum total number of operations. However, Jeevan seems to have forgotten the value of b1. So he makes some guesses. He will ask you q questions corresponding to his q guesses, the i-th of which is of the form:   If b1=xi, what is the minimum number of operations required to convert a to b? Help him by answering each question." 2400.0                                           
     1605D Treelabeling "bitmasks,constructive algorithms,dfs and similar,games,greedy,implementation,trees" "Eikooc and Sushi play a game.The game is played on a tree having n nodes numbered 1 to n. Recall that a tree having n nodes is an undirected, connected graph with n\xe2\x88\x921 edges.They take turns alternately moving a token on the tree. Eikooc makes the first move, placing the token on any node of her choice. Sushi makes the next move, followed by Eikooc, followed by Sushi, and so on. In each turn after the first, a player must move the token to a node u such that   u is adjacent to the node v the token is currently on  u has not been visited before  u\xe2\x8a\x95v\xe2\x89\xa4min(u,v) Here x\xe2\x8a\x95y denotes the bitwise XOR operation on integers x and y.Both the players play optimally. The player who is unable to make a move loses.The following are examples which demonstrate the rules of the game.     Suppose Eikooc starts the game by placing the token at node 4. Sushi then moves the token to node 6, which is unvisited and adjacent to 4. It also holds that 6\xe2\x8a\x954=2\xe2\x89\xa4min(6,4). In the next turn, Eikooc moves the token to node 5, which is unvisited and adjacent to 6. It holds that 5\xe2\x8a\x956=3\xe2\x89\xa4min(5,6). Sushi has no more moves to play, so she loses.   Suppose Eikooc starts the game by placing the token at node 3. Sushi moves the token to node 2, which is unvisited and adjacent to 3. It also holds that 3\xe2\x8a\x952=1\xe2\x89\xa4min(3,2). Eikooc cannot move the token to node 6 since 6\xe2\x8a\x952=4\xe2\x89\xb0min(6,2). Since Eikooc has no moves to play, she loses. Before the game begins, Eikooc decides to sneakily relabel the nodes of the tree in her favour. Formally, a relabeling is a permutation p of length n (sequence of n integers wherein each integer from 1 to n occurs exactly once) where pi denotes the new numbering of node i.She wants to maximize the number of nodes she can choose in the first turn which will guarantee her a win. Help Eikooc find any relabeling which will help her do so." 2100.0                                           
     1603A "Di-visible Confusion" "constructive algorithms,math,number theory" "YouKn0wWho has an integer sequence a1,a2,\xe2\x80\xa6,an. He will perform the following operation until the sequence becomes empty: select an index i such that 1\xe2\x89\xa4i\xe2\x89\xa4|a| and ai is not divisible by (i+1), and erase this element from the sequence. Here |a| is the length of sequence a at the moment of operation. Note that the sequence a changes and the next operation is performed on this changed sequence.For example, if a=[3,5,4,5], then he can select i=2, because a2=5 is not divisible by i+1=3. After this operation the sequence is [3,4,5].Help YouKn0wWho determine if it is possible to erase the whole sequence using the aforementioned operation." 1300.0                                           
     1601C "Optimal Insertion" "data structures,divide and conquer,dp,greedy,sortings" "You are given two arrays of integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bm.You need to insert all elements of b into a in an arbitrary way. As a result you will get an array c1,c2,\xe2\x80\xa6,cn+m of size n+m.Note that you are not allowed to change the order of elements in a, while you can insert elements of b at arbitrary positions. They can be inserted at the beginning, between any elements of a, or at the end. Moreover, elements of b can appear in the resulting array in any order.What is the minimum possible number of inversions in the resulting array c? Recall that an inversion is a pair of indices (i,j) such that i<j and ci>cj." 2300.0                                           
     1599B "Restaurant Game"  "Alice and Bob always had hard time choosing restaurant for the dinner. Previously they performed Eenie Meenie Miney Mo game, but eventually as their restaurant list grew, they had to create a new game. This new game starts as they write restaurant names on N cards and align the cards in one line. Before the game begins, they both choose starting card and starting direction they are going to. They take turns in order one after another. After each turn, they move one card in their current direction. If they reach the end or beginning of the line of cards they change direction. Once they meet in a card, the card is marked for removal and is removed the first moment they both leave the card.  Example of how card is removed They repeat this process until there is only one restaurant card left. Since there are a lot of restaurant cards, they are bored to simulate this process over and over and need your help to determine the last card that remains. Can you help them?" 3100.0                                           
     1598E Staircases "brute force,combinatorics,data structures,dfs and similar,dp,implementation,math" "You are given a matrix, consisting of n rows and m columns. The rows are numbered top to bottom, the columns are numbered left to right.Each cell of the matrix can be either free or locked.Let\'s call a path in the matrix a staircase if it:   starts and ends in the free cell;  visits only free cells;  has one of the two following structures:   the second cell is 1 to the right from the first one, the third cell is 1 to the bottom from the second one, the fourth cell is 1 to the right from the third one, and so on;  the second cell is 1 to the bottom from the first one, the third cell is 1 to the right from the second one, the fourth cell is 1 to the bottom from the third one, and so on.  In particular, a path, consisting of a single cell, is considered to be a staircase.Here are some examples of staircases:  Initially all the cells of the matrix are free.You have to process q queries, each of them flips the state of a single cell. So, if a cell is currently free, it makes it locked, and if a cell is currently locked, it makes it free.Print the number of different staircases after each query. Two staircases are considered different if there exists such a cell that appears in one path and doesn\'t appear in the other path." 2100.0                                           
     1598A "Computer Game" "brute force,dfs and similar,dp,implementation" "Monocarp is playing a computer game. Now he wants to complete the first level of this game.A level is a rectangular grid of 2 rows and n columns. Monocarp controls a character, which starts in cell (1,1) \xe2\x80\x94 at the intersection of the 1-st row and the 1-st column.Monocarp\'s character can move from one cell to another in one step if the cells are adjacent by side and/or corner. Formally, it is possible to move from cell (x1,y1) to cell (x2,y2) in one step if |x1\xe2\x88\x92x2|\xe2\x89\xa41 and |y1\xe2\x88\x92y2|\xe2\x89\xa41. Obviously, it is prohibited to go outside the grid.There are traps in some cells. If Monocarp\'s character finds himself in such a cell, he dies, and the game ends.To complete a level, Monocarp\'s character should reach cell (2,n) \xe2\x80\x94 at the intersection of row 2 and column n.Help Monocarp determine if it is possible to complete the level." 800.0                                           
     1593D1 "All are Same" "math,number theory" "This problem is a simplified version of D2, but it has significant differences, so read the whole statement.Polycarp has an array of n (n is even) integers a1,a2,\xe2\x80\xa6,an. Polycarp conceived of a positive integer k. After that, Polycarp began performing the following operations on the array: take an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and reduce the number ai by k.After Polycarp performed some (possibly zero) number of such operations, it turned out that all numbers in the array became the same. Find the maximum k at which such a situation is possible, or print \xe2\x88\x921 if such a number can be arbitrarily large." 1100.0                                           
     1585E "Frequency Queries" "data structures,dfs and similar,trees" "Petya has a rooted tree with an integer written on each vertex. The vertex 1 is the root. You are to answer some questions about the tree.A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. The parent of a node v is the next vertex on the shortest path from v to the root.Each question is defined by three integers v, l, and k. To get the answer to the question, you need to perform the following steps:   First, write down the sequence of all integers written on the shortest path from the vertex v to the root (including those written in the v and the root).  Count the number of times each integer occurs. Remove all integers with less than l occurrences.  Replace the sequence, removing all duplicates and ordering the elements by the number of occurrences in the original list in increasing order. In case of a tie, you can choose the order of these elements arbitrary.  The answer to the question is the k-th number in the remaining sequence. Note that the answer is not always uniquely determined, because there could be several orderings. Also, it is possible that the length of the sequence on this step is less than k, in this case the answer is \xe2\x88\x921. For example, if the sequence of integers on the path from v to the root is [2,2,1,7,1,1,4,4,4,4], l=2 and k=2, then the answer is 1.Please answer all questions about the tree." 2400.0                                           
     1582D "Vupsen, Pupsen and 0" "constructive algorithms,math" "Vupsen and Pupsen were gifted an integer array. Since Vupsen doesn\'t like the number 0, he threw away all numbers equal to 0 from the array. As a result, he got an array a of length n.Pupsen, on the contrary, likes the number 0 and he got upset when he saw the array without zeroes. To cheer Pupsen up, Vupsen decided to come up with another array b of length n such that \xe2\x88\x91ni=1ai\xe2\x8b\x85bi=0. Since Vupsen doesn\'t like number 0, the array b must not contain numbers equal to 0. Also, the numbers in that array must not be huge, so the sum of their absolute values cannot exceed 109. Please help Vupsen to find any such array b!" 1600.0                                           
     1580E "Railway Construction" "brute force,constructive algorithms,data structures,graphs,shortest paths" "Because the railway system in Gensokyo is often congested, as an enthusiastic engineer, Kawasiro Nitori plans to construct more railway to ease the congestion.There are n stations numbered from 1 to n and m two-way railways in Gensokyo. Every two-way railway connects two different stations and has a positive integer length d. No two two-way railways connect the same two stations. Besides, it is possible to travel from any station to any other using those railways. Among these n stations, station 1 is the main station. You can get to any station from any other station using only two-way railways.Because of the technological limitation, Nitori can only construct one-way railways, whose length can be arbitrary positive integer. Constructing a one-way railway from station u will costs wu units of resources, no matter where the railway ends. To ease the congestion, Nitori plans that after construction there are at least two shortest paths from station 1 to any other station, and these two shortest paths do not pass the same station except station 1 and the terminal. Besides, Nitori also does not want to change the distance of the shortest path from station 1 to any other station.Due to various reasons, sometimes the cost of building a new railway will increase uncontrollably. There will be a total of q occurrences of this kind of incident, and the i-th event will add additional amount of xi to the cost of building a new railway from the station ki.To save resources, before all incidents and after each incident, Nitori wants you to help her calculate the minimal cost of railway construction." 3400.0                                           
     1579C Ticks greedy,implementation "Casimir has a rectangular piece of paper with a checkered field of size n\xc3\x97m. Initially, all cells of the field are white.Let us denote the cell with coordinates i vertically and j horizontally by (i,j). The upper left cell will be referred to as (1,1) and the lower right cell as (n,m).Casimir draws ticks of different sizes on the field. A tick of size d (d>0) with its center in cell (i,j) is drawn as follows:   First, the center cell (i,j) is painted black.  Then exactly d cells on the top-left diagonally to the center and exactly d cells on the top-right diagonally to the center are also painted black.  That is all the cells with coordinates (i\xe2\x88\x92h,j\xc2\xb1h) for all h between 0 and d are painted. In particular, a tick consists of 2d+1 black cells. An already painted cell will remain black if painted again. Below you can find an example of the 4\xc3\x979 box, with two ticks of sizes 2 and 3.  You are given a description of a checkered field of size n\xc3\x97m. Casimir claims that this field came about after he drew some (possibly 0) ticks on it. The ticks could be of different sizes, but the size of each tick is at least k (that is, d\xe2\x89\xa5k for all the ticks).Determine whether this field can indeed be obtained by drawing some (possibly none) ticks of sizes d\xe2\x89\xa5k or not." 1500.0                                           
     1578M "The Mind" "constructive algorithms,interactive,probabilities" "This is an interactive problem.In this problem, you need to come up with a strategy for a cooperative game. This game is played by two players. Each player receives 5 cards. Each card has a random integer between 1 and 100 on it. It is guaranteed that all numbers on cards are distinct.The goal of the game is to play a card with a minimal number on it out of all 10 cards dealt to the players before any other card. The problem is that each player can only see their own cards and cannot communicate with another player in any way.The game consists of 5 turns. During each turn, players simultaneously make a move. Each player can either play their smallest card or do nothing. If on some turn the smallest card is played, and no other card is played on or before that turn, players win. If two cards are played at the same turn or if after all 5 turns, no card is still played, players lose.Players cannot communicate, so a strategy for the game should only be based on 5 cards that the player has. You can describe a strategy as five numbers 0.0\xe2\x89\xa4pi\xe2\x89\xa41.0,\xe2\x88\x915i=1pi\xe2\x89\xa41, where pi \xe2\x80\x94 the probability of playing the player\'s smallest card in their hand on i-th turn. If you know the cards dealt to the players, and the strategies that players choose, you can compute the probability of winning by a simple formula. You will be given n=1000 randomly generated hands of 5 cards. You need to generate a strategy for each of the hands to maximize the probability of winning. After the judge program receives all n strategies, it generates all possible valid pairs of those hands (pairs which have the same numbers are discarded), and computes a probability of winning based on two strategies provided by your program. To ensure that answers for different hands are independent, you must output a strategy for a hand and flush the standard output before reading information about the next hand.If the average probability of winning a game is more than 85% over all valid pairs of hands, the test is considered passed. This problem contains the sample test and 20 randomly generated tests with n=1000." 2700.0                                           
     1575I "Illusions of the Desert" "data structures,trees" "Chanek Jones is back, helping his long-lost relative Indiana Jones, to find a secret treasure in a maze buried below a desert full of illusions.The map of the labyrinth forms a tree with n rooms numbered from 1 to n and n\xe2\x88\x921 tunnels connecting them such that it is possible to travel between each pair of rooms through several tunnels.The i-th room (1\xe2\x89\xa4i\xe2\x89\xa4n) has ai illusion rate. To go from the x-th room to the y-th room, there must exist a tunnel between x and y, and it takes max(|ax+ay|,|ax\xe2\x88\x92ay|) energy. |z| denotes the absolute value of z.To prevent grave robbers, the maze can change the illusion rate of any room in it. Chanek and Indiana would ask q queries.There are two types of queries to be done:  1 u c \xe2\x80\x94 The illusion rate of the x-th room is changed to c (1\xe2\x89\xa4u\xe2\x89\xa4n, 0\xe2\x89\xa4|c|\xe2\x89\xa4109).  2 u v \xe2\x80\x94 Chanek and Indiana ask you the minimum sum of energy needed to take the secret treasure at room v if they are initially at room u (1\xe2\x89\xa4u,v\xe2\x89\xa4n). Help them, so you can get a portion of the treasure!" 2300.0                                           
     1575B "Building an Amusement Park" "binary search,geometry" "Mr. Chanek lives in a city represented as a plane. He wants to build an amusement park in the shape of a circle of radius r. The circle must touch the origin (point (0,0)).There are n bird habitats that can be a photo spot for the tourists in the park. The i-th bird habitat is at point pi=(xi,yi). Find the minimum radius r of a park with at least k bird habitats inside. A point is considered to be inside the park if and only if the distance between pi and the center of the park is less than or equal to the radius of the park. Note that the center and the radius of the park do not need to be integers.In this problem, it is guaranteed that the given input always has a solution with r\xe2\x89\xa42\xe2\x8b\x85105." 2300.0                                           
     1575A "Another Sorting Problem" "data structures,sortings,strings" "Andi and Budi were given an assignment to tidy up their bookshelf of n books. Each book is represented by the book title \xe2\x80\x94 a string si numbered from 1 to n, each with length m. Andi really wants to sort the book lexicographically ascending, while Budi wants to sort it lexicographically descending.Settling their fight, they decided to combine their idea and sort it asc-desc-endingly, where the odd-indexed characters will be compared ascendingly, and the even-indexed characters will be compared descendingly.A string a occurs before a string b in asc-desc-ending order if and only if in the first position where a and b differ, the following holds:  if it is an odd position, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b;  if it is an even position, the string a has a letter that appears later in the alphabet than the corresponding letter in b." 1100.0                                           
     1574A "Regular Bracket Sequences" "constructive algorithms" "A bracket sequence is a string containing only characters ""("" and "")"". A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)""), and "")("", ""("" and "")"" are not.You are given an integer n. Your goal is to construct and print exactly n different regular bracket sequences of length 2n." 800.0                                           
     1573B Swaps greedy,math,sortings "You are given two arrays a and b of length n. Array a contains each odd integer from 1 to 2n in an arbitrary order, and array b contains each even integer from 1 to 2n in an arbitrary order.You can perform the following operation on those arrays:   choose one of the two arrays  pick an index i from 1 to n\xe2\x88\x921  swap the i-th and the (i+1)-th elements of the chosen array  Compute the minimum number of operations needed to make array a lexicographically smaller than array b.For two different arrays x and y of the same length n, we say that x is lexicographically smaller than y if in the first position where x and y differ, the array x has a smaller element than the corresponding element in y." 1400.0                                           
     1573A Countdown greedy "You are given a digital clock with n digits. Each digit shows an integer from 0 to 9, so the whole clock shows an integer from 0 to 10n\xe2\x88\x921. The clock will show leading zeroes if the number is smaller than 10n\xe2\x88\x921.You want the clock to show 0 with as few operations as possible. In an operation, you can do one of the following:   decrease the number on the clock by 1, or  swap two digits (you can choose which digits to swap, and they don\'t have to be adjacent). Your task is to determine the minimum number of operations needed to make the clock show 0." 800.0                                           
     1572B "Xor of 3" "brute force,constructive algorithms,greedy,two pointers" "You are given a sequence a of length n consisting of 0s and 1s.You can perform the following operation on this sequence:   Pick an index i from 1 to n\xe2\x88\x922 (inclusive).  Change all of ai, ai+1, ai+2 to ai\xe2\x8a\x95ai+1\xe2\x8a\x95ai+2 simultaneously, where \xe2\x8a\x95 denotes the bitwise XOR operation  Find a sequence of at most n operations that changes all elements of a to 0s or report that it\'s impossible.We can prove that if there exists a sequence of operations of any length that changes all elements of a to 0s, then there is also such a sequence of length not greater than n." 2500.0                                           
     1571J "Two Railroads" "*special problem" "There are n cities in Berland, and they are connected by two railroads \xe2\x80\x94 the Main railroad and the Auxiliary railroad. Each city has two railway stations, one connected to the Main railroad (called the Main station), and the other connected to the Auxiliary railroad.The railroads are identical in their structure. The Main railroad consists of n\xe2\x88\x921 railroad segments; the i-th railroad segment connects the Main station of the city i with the Main station of the city i+1. Similarly, the Auxiliary railroad consists of n\xe2\x88\x921 railroad segments; the i-th railroad segment connects the Auxiliary station of the city i with the Auxiliary station of the city i+1.These railroads are used to transfer different goods and resources from one city to another. In particular, the Ministry of Energetics is interested in using these railroads to transfer coal.The Ministry has estimated the following capabilities of the railroads:  for every i\xe2\x88\x88[1,n\xe2\x88\x921], at most ai tons of coal per day can be transferred from the Main station i to the Main station i+1 (only in this direction);  for every i\xe2\x88\x88[1,n\xe2\x88\x921], at most bi tons of coal per day can be transferred from the Auxiliary station i to the Auxiliary station i+1 (only in this direction);  for every i\xe2\x88\x88[1,n], at most ci tons of coal per day can be transferred from the Main station i to the Auxiliary station i, or in the opposite direction. To analyze the capacity of the whole railroad network, the Ministry requires a software that would process and answer queries of the following format:  calculate the maximum number of tons of coal that can be transferred per day from the Main station li to the Main station ri. Your task is to implement this software." 3000.0                                           
     1571H "Laser Beams" "*special problem,geometry,probabilities" "Ira is developing a computer game. This game features randomized generation and difficulty of levels. To achieve randomized difficulty, some enemies in each level are randomly replaced with stronger ones.To describe how do the levels in the game look, let\'s introduce a coordinate system in such a way that Ox axis goes from left to right, and Oy axis goes from bottom to top. A level is a rectangle with opposite corners in points (0,0) and (a,b). Each enemy\'s position is a point in this rectangle.As for now, Ira has implemented one type of enemy in the game, in two different versions \xe2\x80\x94 basic and upgraded. Both versions of enemies Ira has implemented fire laser rays in several directions:  basic enemies fire four laser rays in four directions: to the right (in the same direction as the vector (1,0)), to the left (in the same direction as the vector (\xe2\x88\x921,0)), up (in the same direction as the vector (0,1)), and down (in the same direction as the vector (0,\xe2\x88\x921));  upgraded enemies fire eight laser rays in eight directions: four directions listed for basic enemies, and four directions corresponding to vectors (1,1), (1,\xe2\x88\x921), (\xe2\x88\x921,1), (\xe2\x88\x921,\xe2\x88\x921). Laser rays pass through enemies and are blocked only by the borders of the level (sides of the rectangle that denotes the level). Enemies are unaffected by lasers.The level Ira is working on has n enemies. The i-th enemy is in the point (xi,yi), and it has a probability of pi to be upgraded (it\'s either upgraded with probability pi, or basic with probability 1\xe2\x88\x92pi). All these events are independent.Ira wants to estimate the expected difficulty. She considers that a good way to evaluate the difficulty of the level is to count the number of parts in which the level is divided by the laser rays. So, she wants to calculate the expected number of these parts.Help her to do the evaluation of the level!" 2900.0                                           
     1571G "A Battle Against a Dragon" "*special problem,data structures,dp" "A squad of n warriors is defending a castle from a dragon attack. There are m barricades between the castle and the dragon.The warriors are numbered from 1 to n. The i-th warrior knows ki attacks: the j-th of them deals ai,j damage to the dragon and can only be applied if there are exactly bi,j barricades between the castle and the dragon.The warriors make turns one after another, starting from warrior 1. After warrior n makes his turn, the total damage to the dragon is calculated. The i-th warrior performs exactly one of three possible moves in his turn:  destroys one barricade (if there are any left);  deploys one of his ki attacks;  skips a turn. The total damage is the sum of damages dealt by the warriors who chose to deploy their attacks in their turn. What is the maximum total damage the warriors can deal to the dragon?" 2500.0                                           
     1569D "Inconvenient Pairs" "binary search,data structures,implementation,sortings,two pointers" "There is a city that can be represented as a square grid with corner points in (0,0) and (106,106).The city has n vertical and m horizontal streets that goes across the whole city, i. e. the i-th vertical streets goes from (xi,0) to (xi,106) and the j-th horizontal street goes from (0,yj) to (106,yj). All streets are bidirectional. Borders of the city are streets as well.There are k persons staying on the streets: the p-th person at point (xp,yp) (so either xp equal to some xi or yp equal to some yj, or both).Let\'s say that a pair of persons form an inconvenient pair if the shortest path from one person to another going only by streets is strictly greater than the Manhattan distance between them.Calculate the number of inconvenient pairs of persons (pairs (x,y) and (y,x) are the same pair).Let\'s recall that Manhattan distance between points (x1,y1) and (x2,y2) is |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|." 1900.0                                           
     1569C "Jury Meeting" combinatorics,math "n people gathered to hold a jury meeting of the upcoming competition, the i-th member of the jury came up with ai tasks, which they want to share with each other.First, the jury decides on the order which they will follow while describing the tasks. Let that be a permutation p of numbers from 1 to n (an array of size n where each integer from 1 to n occurs exactly once).Then the discussion goes as follows:  If a jury member p1 has some tasks left to tell, then they tell one task to others. Otherwise, they are skipped.  If a jury member p2 has some tasks left to tell, then they tell one task to others. Otherwise, they are skipped.  ...  If a jury member pn has some tasks left to tell, then they tell one task to others. Otherwise, they are skipped.  If there are still members with tasks left, then the process repeats from the start. Otherwise, the discussion ends. A permutation p is nice if none of the jury members tell two or more of their own tasks in a row. Count the number of nice permutations. The answer may be really large, so print it modulo 998244353." 1500.0                                           
     1569A "Balanced Substring" implementation "You are given a string s, consisting of n letters, each letter is either \'a\' or \'b\'. The letters in the string are numbered from 1 to n.s[l;r] is a continuous substring of letters from index l to r of the string inclusive. A string is called balanced if the number of letters \'a\' in it is equal to the number of letters \'b\'. For example, strings ""baba"" and ""aabbab"" are balanced and strings ""aaab"" and ""b"" are not.Find any non-empty balanced substring s[l;r] of string s. Print its l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). If there is no such substring, then print \xe2\x88\x921 \xe2\x88\x921." 800.0                                           
     1566H Xor-quiz "constructive algorithms,dp,interactive,math,number theory" "This is an interactive problem.You are given two integers c and n. The jury has a randomly generated set A of distinct positive integers not greater than c (it is generated from all such possible sets with equal probability). The size of A is equal to n.Your task is to guess the set A. In order to guess it, you can ask at most \xe2\x8c\x880.65\xe2\x8b\x85c\xe2\x8c\x89 queries.In each query, you choose a single integer 1\xe2\x89\xa4x\xe2\x89\xa4c. As the answer to this query you will be given the bitwise xor sum of all y, such that y\xe2\x88\x88A and gcd(x,y)=1 (i.e. x and y are coprime). If there is no such y this xor sum is equal to 0.You can ask all queries at the beginning and you will receive the answers to all your queries. After that, you won\'t have the possibility to ask queries.You should find any set A\xe2\x80\xb2, such that |A\xe2\x80\xb2|=n and A\xe2\x80\xb2 and A have the same answers for all c possible queries." 3200.0                                           
     1566D2 "Seating Arrangements (hard version)" "data structures,greedy,implementation,sortings,two pointers" "It is the hard version of the problem. The only difference is that in this version 1\xe2\x89\xa4n\xe2\x89\xa4300.In the cinema seats can be represented as the table with n rows and m columns. The rows are numbered with integers from 1 to n. The seats in each row are numbered with consecutive integers from left to right: in the k-th row from m(k\xe2\x88\x921)+1 to mk for all rows 1\xe2\x89\xa4k\xe2\x89\xa4n. 12\xe2\x8b\xafm\xe2\x88\x921mm+1m+2\xe2\x8b\xaf2m\xe2\x88\x9212m2m+12m+2\xe2\x8b\xaf3m\xe2\x88\x9213m\xe2\x8b\xae\xe2\x8b\xae\xe2\x8b\xb1\xe2\x8b\xae\xe2\x8b\xaem(n\xe2\x88\x921)+1m(n\xe2\x88\x921)+2\xe2\x8b\xafnm\xe2\x88\x921nm The table with seats indices There are nm people who want to go to the cinema to watch a new film. They are numbered with integers from 1 to nm. You should give exactly one seat to each person.It is known, that in this cinema as lower seat index you have as better you can see everything happening on the screen. i-th person has the level of sight ai. Let\'s define si as the seat index, that will be given to i-th person. You want to give better places for people with lower sight levels, so for any two people i, j such that ai<aj it should be satisfied that si<sj.After you will give seats to all people they will start coming to their seats. In the order from 1 to nm, each person will enter the hall and sit in their seat. To get to their place, the person will go to their seat\'s row and start moving from the first seat in this row to theirs from left to right. While moving some places will be free, some will be occupied with people already seated. The inconvenience of the person is equal to the number of occupied seats he or she will go through.Let\'s consider an example: m=5, the person has the seat 4 in the first row, the seats 1, 3, 5 in the first row are already occupied, the seats 2 and 4 are free. The inconvenience of this person will be 2, because he will go through occupied seats 1 and 3.Find the minimal total inconvenience (the sum of inconveniences of all people), that is possible to have by giving places for all people (all conditions should be satisfied)." 1600.0                                           
     1566D1 "Seating Arrangements (easy version)" "data structures,greedy,sortings" "It is the easy version of the problem. The only difference is that in this version n=1.In the cinema seats can be represented as the table with n rows and m columns. The rows are numbered with integers from 1 to n. The seats in each row are numbered with consecutive integers from left to right: in the k-th row from m(k\xe2\x88\x921)+1 to mk for all rows 1\xe2\x89\xa4k\xe2\x89\xa4n. 12\xe2\x8b\xafm\xe2\x88\x921mm+1m+2\xe2\x8b\xaf2m\xe2\x88\x9212m2m+12m+2\xe2\x8b\xaf3m\xe2\x88\x9213m\xe2\x8b\xae\xe2\x8b\xae\xe2\x8b\xb1\xe2\x8b\xae\xe2\x8b\xaem(n\xe2\x88\x921)+1m(n\xe2\x88\x921)+2\xe2\x8b\xafnm\xe2\x88\x921nm The table with seats indices There are nm people who want to go to the cinema to watch a new film. They are numbered with integers from 1 to nm. You should give exactly one seat to each person.It is known, that in this cinema as lower seat index you have as better you can see everything happening on the screen. i-th person has the level of sight ai. Let\'s define si as the seat index, that will be given to i-th person. You want to give better places for people with lower sight levels, so for any two people i, j such that ai<aj it should be satisfied that si<sj.After you will give seats to all people they will start coming to their seats. In the order from 1 to nm, each person will enter the hall and sit in their seat. To get to their place, the person will go to their seat\'s row and start moving from the first seat in this row to theirs from left to right. While moving some places will be free, some will be occupied with people already seated. The inconvenience of the person is equal to the number of occupied seats he or she will go through.Let\'s consider an example: m=5, the person has the seat 4 in the first row, the seats 1, 3, 5 in the first row are already occupied, the seats 2 and 4 are free. The inconvenience of this person will be 2, because he will go through occupied seats 1 and 3.Find the minimal total inconvenience (the sum of inconveniences of all people), that is possible to have by giving places for all people (all conditions should be satisfied)." 1100.0                                           
     1561C "Deep Down Below" "binary search,greedy,sortings" "In a certain video game, the player controls a hero characterized by a single integer value: power. The hero will have to beat monsters that are also characterized by a single integer value: armor.On the current level, the hero is facing n caves. To pass the level, the hero must enter all the caves in some order, each cave exactly once, and exit every cave safe and sound. When the hero enters cave i, he will have to fight ki monsters in a row: first a monster with armor ai,1, then a monster with armor ai,2 and so on, finally, a monster with armor ai,ki.The hero can beat a monster if and only if the hero\'s power is strictly greater than the monster\'s armor. If the hero can\'t beat the monster he\'s fighting, the game ends and the player loses. Note that once the hero enters a cave, he can\'t exit it before he fights all the monsters in it, strictly in the given order.Each time the hero beats a monster, the hero\'s power increases by 1.Find the smallest possible power the hero must start the level with to be able to enter all the caves in some order and beat all the monsters." 1300.0                                           
     1557E "Assiut Chess" "brute force,constructive algorithms,interactive" "This is an interactive problem.ICPC Assiut Community decided to hold a unique chess contest, and you were chosen to control a queen and hunt down the hidden king, while a member of ICPC Assiut Community controls this king.You compete on an 8\xc3\x978 chessboard, the rows are numerated from top to bottom, and the columns are numerated left to right, and the cell in row x and column y is denoted as (x,y).In one turn you can move the queen to any of the squares on the same horizontal line, vertical line, or any of the diagonals. For example, if the queen was on square (4, 5), you can move to (q1, 5), (4, q1), (q1, 9\xe2\x88\x92q1), or (q2, q2+1) where (1\xe2\x89\xa4q1\xe2\x89\xa48, q1\xe2\x89\xa04, 1\xe2\x89\xa4q2\xe2\x89\xa47, q2\xe2\x89\xa04). Note that the queen cannot stay on its current cell.   In one turn, the king can move ""Right"", ""Left"", ""Up"", ""Down"", ""Down-Right"", ""Down-Left"", ""Up-Left"", or ""Up-Right"" such that he doesn\'t get out of the board. The king cannot move into a cell that is on the same row, column or diagonal with the queen (including the position of the queen itself). For example, if the king was on square (4, 5), he can move to (4+k1, 5+k2) where (\xe2\x88\x921\xe2\x89\xa4k1,k2\xe2\x89\xa41, (k1,k2)\xe2\x89\xa0(0,0)).   At the start of the game, you should place the queen at any location on the board, and this is done once per game. After that the king is secretly placed at any cell different from the queen\'s location. You do not know the position of the king. Then, the king and the queen take turns with the king moving first. The king moves to one of the possible directions (""Right"", ""Down"", ""Up-Left"", etc.), and you are only given the direction it moves to. After that, you should move your queen by declaring the square to which your queen will move. The game follows like this until you win the game or run out of moves.You win if the king has no valid moves. You lose if after 130 moves of the queen the king still has valid moves." 2800.0                                           
     1557A "Ezzat and Two Subsequences" "brute force,math,sortings" "Ezzat has an array of n integers (maybe negative). He wants to split it into two non-empty subsequences a and b, such that every element from the array belongs to exactly one subsequence, and the value of f(a)+f(b) is the maximum possible value, where f(x) is the average of the subsequence x. A sequence x is a subsequence of a sequence y if x can be obtained from y by deletion of several (possibly, zero or all) elements.The average of a subsequence is the sum of the numbers of this subsequence divided by the size of the subsequence.For example, the average of [1,5,6] is (1+5+6)/3=12/3=4, so f([1,5,6])=4." 800.0                                           
     1554E You "dfs and similar,dp,math,number theory" "You are given a tree with n nodes. As a reminder, a tree is a connected undirected graph without cycles.Let a1,a2,\xe2\x80\xa6,an be a sequence of integers. Perform the following operation exactly n times:   Select an unerased node u. Assign au:= number of unerased nodes adjacent to u. Then, erase the node u along with all edges that have it as an endpoint. For each integer k from 1 to n, find the number, modulo 998244353, of different sequences a1,a2,\xe2\x80\xa6,an that satisfy the following conditions:  it is possible to obtain a by performing the aforementioned operations exactly n times in some order.  gcd(a1,a2,\xe2\x80\xa6,an)=k. Here, gcd means the greatest common divisor of the elements in a." 2600.0                                           
     1553B "Reverse String" "brute force,dp,hashing,implementation,strings" "You have a string s and a chip, which you can place onto any character of this string. After placing the chip, you move it to the right several (maybe zero) times, i. e. you perform the following operation several times: if the current position of the chip is i, you move it to the position i+1. Of course, moving the chip to the right is impossible if it is already in the last position.After moving the chip to the right, you move it to the left several (maybe zero) times, i. e. you perform the following operation several times: if the current position of the chip is i, you move it to the position i\xe2\x88\x921. Of course, moving the chip to the left is impossible if it is already in the first position.When you place a chip or move it, you write down the character where the chip ends up after your action. For example, if s is abcdef, you place the chip onto the 3-rd character, move it to the right 2 times and then move it to the left 3 times, you write down the string cdedcb.You are given two strings s and t. Your task is to determine whether it\'s possible to perform the described operations with s so that you write down the string t as a result." 1300.0                                           
     1553A "Digits Sum" "math,number theory" "Let\'s define S(x) to be the sum of digits of number x written in decimal system. For example, S(5)=5, S(10)=1, S(322)=7.We will call an integer x interesting if S(x+1)<S(x). In each test you will be given one integer n. Your task is to calculate the number of integers x such that 1\xe2\x89\xa4x\xe2\x89\xa4n and x is interesting." 800.0                                           
     1547A "Shortest Path with Obstacle" implementation,math "There are three cells on an infinite 2-dimensional grid, labeled A, B, and F. Find the length of the shortest path from A to B if:   in one move you can go to any of the four adjacent cells sharing a side;  visiting the cell F is forbidden (it is an obstacle)." 800.0                                           
     1546A "AquaMoon and Two Arrays" "brute force,greedy" "AquaMoon and Cirno are playing an interesting game with arrays. Cirno has prepared two arrays a and b, both consist of n non-negative integers. AquaMoon can perform the following operation an arbitrary number of times (possibly zero):  She chooses two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n), then decreases the i-th element of array a by 1, and increases the j-th element of array a by 1. The resulting values at i-th and j-th index of array a are ai\xe2\x88\x921 and aj+1, respectively. Each element of array a must be non-negative after each operation. If i=j this operation doesn\'t change the array a. AquaMoon wants to make some operations to make arrays a and b equal. Two arrays a and b are considered equal if and only if ai=bi for all 1\xe2\x89\xa4i\xe2\x89\xa4n.Help AquaMoon to find a sequence of operations that will solve her problem or find, that it is impossible to make arrays a and b equal.Please note, that you don\'t have to minimize the number of operations." 800.0                                           
     1539F "Strange Array" "data structures,greedy,sortings" "Vasya has an array of n integers a1,a2,\xe2\x80\xa6,an. Vasya thinks that all numbers in his array are strange for some reason. To calculate how strange the i-th number is, Vasya created the following algorithm.He chooses a subsegment al,al+1,\xe2\x80\xa6,ar, such that 1\xe2\x89\xa4l\xe2\x89\xa4i\xe2\x89\xa4r\xe2\x89\xa4n, sort its elements in increasing order in his head (he can arrange equal elements arbitrary). After that he finds the center of the segment. The center of a segment is the element at position (l+r)/2, if the length of the segment is odd, and at position (l+r+1)/2 otherwise. Now Vasya finds the element that was at position i before the sorting, and calculates the distance between its current position and the center of the subsegment (the distance between the elements with indices j and k is |j\xe2\x88\x92k|).The strangeness of the number at position i is the maximum distance among all suitable choices of l and r. Vasya wants to calculate the strangeness of each number in his array. Help him to do it." 2600.0                                           
     1536B "Prinzessin der Verurteilung" "brute force,constructive algorithms,strings" "I, Fischl, Prinzessin der Verurteilung, descend upon this land by the call of fate an \xe2\x80\x94 Oh, you are also a traveler from another world? Very well, I grant you permission to travel with me.It is no surprise Fischl speaks with a strange choice of words. However, this time, not even Oz, her raven friend, can interpret her expressions! Maybe you can help us understand what this young princess is saying?You are given a string of n lowercase Latin letters, the word that Fischl just spoke. You think that the MEX of this string may help you find the meaning behind this message. The MEX of the string is defined as the shortest string that doesn\'t appear as a contiguous substring in the input. If multiple strings exist, the lexicographically smallest one is considered the MEX. Note that the empty substring does NOT count as a valid MEX.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b. A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.Find out what the MEX of the string is!" 1200.0                                           
     1535A "Fair Playoff" "brute force,implementation" "Four players participate in the playoff tournament. The tournament is held according to the following scheme: the first player will play with the second, and the third player with the fourth, then the winners of the pairs will play in the finals of the tournament.It is known that in a match between two players, the one whose skill is greater will win. The skill of the i-th player is equal to si and all skill levels are pairwise different (i.\xe2\x80\x89e. there are no two identical values in the array s).The tournament is called fair if the two players with the highest skills meet in the finals.Determine whether the given tournament is fair." 800.0                                           
     1534H "Lost Nodes" "constructive algorithms,dp,graphs,interactive,sortings,trees" "This is an interactive problem.As he qualified for IOI this year, Little Ericyi was given a gift from all his friends: a tree of n nodes!On the flight to IOI Little Ericyi was very bored, so he decided to play a game with Little Yvonne with his new tree. First, Little Yvonne selects two (not necessarily different) nodes a and b on the tree (without telling Ericyi), and then gives him a hint f (which is some node on the path from a to b).Then, Little Ericyi is able to ask the following question repeatedly: If I rooted the tree at node r (Ericyi gets to choose r), what would be the Lowest Common Ancestor of a and b?Little Ericyi\'s goal is to find the nodes a and b, and report them to Little Yvonne.However, Little Yvonne thought this game was too easy, so before he gives the hint f to Little Ericyi, he also wants him to first find the maximum number of queries required to determine a and b over all possibilities of a, b, and f assuming Little Ericyi plays optimally. Little Ericyi defines an optimal strategy as one that makes the minimum number of queries. Of course, once Little Ericyi replies with the maximum number of queries, Little Yvonne will only let him use that many queries in the game.The tree, a, b, and f are all fixed before the start of the game and do not change as queries are made." 3500.0                                           
     1534D "Lost Tree" "constructive algorithms,interactive,trees" "This is an interactive problem.Little Dormi was faced with an awkward problem at the carnival: he has to guess the edges of an unweighted tree of n nodes! The nodes of the tree are numbered from 1 to n.The game master only allows him to ask one type of question: Little Dormi picks a node r (1\xe2\x89\xa4r\xe2\x89\xa4n), and the game master will reply with an array d1,d2,\xe2\x80\xa6,dn, where di is the length of the shortest path from node r to i, for all 1\xe2\x89\xa4i\xe2\x89\xa4n.Additionally, to make the game unfair challenge Little Dormi the game master will allow at most \xe2\x8c\x88n2\xe2\x8c\x89 questions, where \xe2\x8c\x88x\xe2\x8c\x89 denotes the smallest integer greater than or equal to x.Faced with the stomach-churning possibility of not being able to guess the tree, Little Dormi needs your help to devise a winning strategy!Note that the game master creates the tree before the game starts, and does not change it during the game." 1800.0                                           
     1533G "Biome Map" "*special problem,constructive algorithms,dfs and similar,graphs" "Polycarp decided to generate a biome map for his game. A map is a matrix divided into cells 1\xc3\x971. Each cell of the map must contain one of the available biomes.Each biome is defined by two parameters: temperature (an integer from 1 to n) and humidity (an integer from 1 to m). But not for every temperature/humidity combination, a corresponding biome is available.The biome map should be generated according to the following rules:  each cell of the map belongs to exactly one biome;  each available biome has at least one cell on the map;  if two cells of the map are adjacent by the side and they belong to biomes with parameters (t1,h1) and (t2,h2), respectively, then the equality |t1\xe2\x88\x92t2|+|h1\xe2\x88\x92h2|=1 holds;  let the number of available biomes be equal to k, then the number of rows and columns of the map (separately) should not exceed k. Help Polycarp generate a biome map that meets all the conditions described above (or report that this is impossible)." -999.0                                           
     1533F "Binary String Partition" "*special problem,binary search,greedy" "Let\'s call a string t consisting of characters 0 and/or 1 beautiful, if either the number of occurrences of character 0 in this string does not exceed k, or the number of occurrences of characters 1 in this string does not exceed k (or both). For example, if k=3, the strings 101010, 111, 0, 00000, 1111111000 are beautiful, and the strings 1111110000, 01010101 are not beautiful.You are given a string s. You have to divide it into the minimum possible number of beautiful strings, i.\xe2\x80\x89e., find a sequence of strings t1,t2,\xe2\x80\xa6,tm such that every ti is beautiful, t1+t2+\xe2\x8b\xaf+tm=s (where + is the concatenation operator), and m is minimum possible.For every k from 1 to |s|, find the minimum possible number of strings such that s can be divided into them (i.\xe2\x80\x89e. the minimum possible m in the partition)." -999.0                                           
     1532E "Good Array" "*special problem" "Let\'s call an array good if there is an element in the array that equals to the sum of all other elements. For example, the array a=[1,3,3,7] is good because there is the element a4=7 which equals to the sum 1+3+3.You are given an array a consisting of n integers. Your task is to print all indices j of this array such that after removing the j-th element from the array it will be good (let\'s call such indices nice).For example, if a=[8,3,5,2], the nice indices are 1 and 4:   if you remove a1, the array will look like [3,5,2] and it is good;  if you remove a4, the array will look like [8,3,5] and it is good. You have to consider all removals independently, i.\xe2\x80\x89e. remove the element, check if the resulting array is good, and return the element into the array." -999.0                                           
     1532B "Frog Jumping" "*special problem,math" "A frog is currently at the point 0 on a coordinate axis Ox. It jumps by the following algorithm: the first jump is a units to the right, the second jump is b units to the left, the third jump is a units to the right, the fourth jump is b units to the left, and so on.Formally:   if the frog has jumped an even number of times (before the current jump), it jumps from its current position x to position x+a;  otherwise it jumps from its current position x to position x\xe2\x88\x92b. Your task is to calculate the position of the frog after k jumps.But... One more thing. You are watching t different frogs so you have to answer t independent queries." -999.0                                           
     1532A "A+B (Trial Problem)" "*special problem" "You are given two integers a and b. Print a+b." -999.0                                           
     1531C "\xd0\xa1\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80" "*special problem,constructive algorithms,dp" "\xd0\x92\xd1\x81\xd0\xb5 \xd0\xb3\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb2\xd1\x8f\xd1\x82\xd1\x81\xd1\x8f \xd0\xba VK Fest 2021! \xd0\x94\xd0\xbb\xd1\x8f \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb7\xd1\x80\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f\xd0\xbc \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xb0 \xd0\xbb\xd1\x83\xd1\x87\xd1\x88\xd0\xb5 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xbd\xd0\xb0 \xd0\xb3\xd0\xbb\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x86\xd0\xb5\xd0\xbd\xd0\xb0, \xd0\xbf\xd0\xbb\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80. \xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb5 \xd0\xbc\xd1\x8b \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd0\xbc \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd0\xbc\xd0\xb0\xd1\x82\xd1\x80\xd0\xb8\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x81\xd0\xb1\xd0\xbe\xd0\xba\xd1\x83 \xe2\x80\x94 \xd1\x81\xd1\x85\xd0\xb5\xd0\xbc\xd0\xb0\xd1\x82\xd0\xb8\xd1\x87\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xbd \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xbc\xd0\xb5\xd1\x82\xd1\x8c \xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd1\x83 \xd0\xbb\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd1\x8b \xd0\xb8\xd0\xb7 nn \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb2\xd1\x8b\xd1\x85 \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2. \xd0\x9b\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd0\xb0 \xe2\x80\x94 \xd1\x8d\xd1\x82\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xb1\xd0\xb0\xd1\x88\xd0\xb5\xd0\xbd \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2, \xd0\xb2\xd1\x8b\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2 \xd1\x80\xd1\x8f\xd0\xb4, \xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x8b \xd0\xb1\xd0\xb0\xd1\x88\xd0\xb5\xd0\xbd \xd0\xbd\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb7\xd1\x80\xd0\xb0\xd1\x81\xd1\x82\xd0\xb0\xd1\x8e\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe.\xd0\x9d\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb5\xd0\xbc \xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xbd\xd0\xba\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xb5\xd1\x82\xd1\x8c \xd1\x82\xd1\x80\xd0\xb8 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd1\x8b\xd0\xb5 \xd1\x84\xd0\xb8\xd0\xb3\xd1\x83\xd1\x80\xd1\x8b \xd0\xb8\xd0\xb7 1212 \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2. \xd0\x9f\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xb2\xd0\xb5 \xd1\x84\xd0\xb8\xd0\xb3\xd1\x83\xd1\x80\xd1\x8b \xe2\x80\x94 \xd0\xbb\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd1\x8b, \xd0\xb0 \xd1\x82\xd1\x80\xd0\xb5\xd1\x82\xd1\x8c\xd1\x8f \xe2\x80\x94 \xd0\xbd\xd0\xb5\xd1\x82.  \xd0\x98\xd0\xb7 \xd1\x8d\xd1\x81\xd1\x82\xd0\xb5\xd1\x82\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd0\xba\xd0\xb8\xd1\x85 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9 \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xbe \xd1\x80\xd0\xb5\xd1\x88\xd0\xb5\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd1\x81\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xbc. \xd0\xa4\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe, \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80 \xd0\xbd\xd0\xb0\xd0\xb7\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x81\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xbc, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xbe\xd1\x82\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x81\xd1\x85\xd0\xb5\xd0\xbc\xd1\x8b \xd0\xbe\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd0\xb9 x=yx=y \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x82\xd0\xbe\xd1\x82 \xd0\xb6\xd0\xb5 \xd1\x81\xd0\xb0\xd0\xbc\xd1\x8b\xd0\xb9 \xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xbd\xd0\xbe\xd0\xba (\xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xbe\xd1\x81\xd1\x8c xx \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe, \xd0\xb0 \xd0\xbe\xd1\x81\xd1\x8c yy \xe2\x80\x94 \xd1\x81\xd0\xbd\xd0\xb8\xd0\xb7\xd1\x83 \xd0\xb2\xd0\xb2\xd0\xb5\xd1\x80\xd1\x85). \xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb0\xd1\x8f \xd0\xbb\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd0\xb0 \xd0\xbd\xd0\xb0 \xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xbd\xd0\xba\xd0\xb5 \xd0\xb2\xd1\x8b\xd1\x88\xd0\xb5 \xe2\x80\x94 \xd1\x81\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd0\xb0\xd1\x8f, \xd0\xb0 \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xb0\xd1\x8f \xe2\x80\x94 \xd0\xbd\xd0\xb5\xd1\x82.  \xd0\x9a\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xbc\xd0\xb0\xd0\xba\xd1\x81\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xba\xd1\x82\xd0\xbd\xd1\x8b\xd0\xbc \xe2\x80\x94 \xd0\xb0 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe, \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd0\xb0 \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0, \xd0\xb2\xd0\xbd\xd1\x83\xd1\x82\xd1\x80\xd1\x8c \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xbd\xd0\xb0 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb5.\xd0\x9f\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xbc\xd1\x83 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd1\x83 nn \xd0\xbd\xd0\xb0\xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xb9\xd1\x82\xd0\xb5 \xd1\x81\xd1\x85\xd0\xb5\xd0\xbc\xd1\x83 \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80\xd0\xb0 \xd0\xb8\xd0\xb7 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe nn \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2, \xd1\x83\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xbb\xd0\xb5\xd1\x82\xd0\xb2\xd0\xbe\xd1\x80\xd1\x8f\xd1\x8e\xd1\x89\xd1\x83\xd1\x8e \xd0\xb2\xd1\x81\xd0\xb5\xd0\xbc \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x8f\xd0\xbc." -999.0                                           
     1528F "AmShZ Farm" combinatorics,fft,math "To AmShZ, all arrays are equal, but some arrays are more-equal than others. Specifically, the arrays consisting of n elements from 1 to n that can be turned into permutations of numbers from 1 to n by adding a non-negative integer to each element.Mashtali who wants to appear in every problem statement thinks that an array b consisting of k elements is compatible with a more-equal array a consisting of n elements if for each 1\xe2\x89\xa4i\xe2\x89\xa4k we have 1\xe2\x89\xa4bi\xe2\x89\xa4n and also ab1=ab2=\xe2\x80\xa6=abk.Find the number of pairs of arrays a and b such that a is a more-equal array consisting of n elements and b is an array compatible with a consisting of k elements modulo 998244353.Note that the elements of b are not necessarily distinct, same holds for a." 3300.0                                           
     1528D "It\'s a bird! No, it\'s a plane! No, it\'s AaParsa!" "constructive algorithms,graphs,shortest paths" "There are n cities in Shaazzzland, numbered from 0 to n\xe2\x88\x921. Ghaazzzland, the immortal enemy of Shaazzzland, is ruled by AaParsa.As the head of the Ghaazzzland\'s intelligence agency, AaParsa is carrying out the most important spying mission in Ghaazzzland\'s history on Shaazzzland.AaParsa has planted m transport cannons in the cities of Shaazzzland. The i-th cannon is planted in the city ai and is initially pointing at city bi.It is guaranteed that each of the n cities has at least one transport cannon planted inside it, and that no two cannons from the same city are initially pointing at the same city (that is, all pairs (ai,bi) are distinct).AaParsa used very advanced technology to build the cannons, the cannons rotate every second. In other words, if the i-th cannon is pointing towards the city x at some second, it will target the city (x+1)modn at the next second.As their name suggests, transport cannons are for transportation, specifically for human transport. If you use the i-th cannon to launch yourself towards the city that it\'s currently pointing at, you\'ll be airborne for ci seconds before reaching your target destination.If you still don\'t get it, using the i-th cannon at the s-th second (using which is only possible if you are currently in the city ai) will shoot you to the city (bi+s)modn and you\'ll land in there after ci seconds (so you\'ll be there in the (s+ci)-th second). Also note the cannon that you initially launched from will rotate every second but you obviously won\'t change direction while you are airborne. AaParsa wants to use the cannons for travelling between Shaazzzland\'s cities in his grand plan, and he can start travelling at second 0. For him to fully utilize them, he needs to know the minimum number of seconds required to reach city u from city v using the cannons for every pair of cities (u,v).Note that AaParsa can stay in a city for as long as he wants." 2500.0                                           
     1527B2 "Palindrome Game (hard version)" "constructive algorithms,games" "The only difference between the easy and hard versions is that the given string s in the easy version is initially a palindrome, this condition is not always true for the hard version.A palindrome is a string that reads the same left to right and right to left. For example, ""101101"" is a palindrome, while ""0101"" is not.Alice and Bob are playing a game on a string s of length n consisting of the characters \'0\' and \'1\'. Both players take alternate turns with Alice going first.In each turn, the player can perform one of the following operations:   Choose any i (1\xe2\x89\xa4i\xe2\x89\xa4n), where s[i]= \'0\' and change s[i] to \'1\'. Pay 1 dollar.  Reverse the whole string, pay 0 dollars. This operation is only allowed if the string is currently not a palindrome, and the last operation was not reverse. That is, if Alice reverses the string, then Bob can\'t reverse in the next move, and vice versa. Reversing a string means reordering its letters from the last to the first. For example, ""01001"" becomes ""10010"" after reversing.The game ends when every character of string becomes \'1\'. The player who spends minimum dollars till this point wins the game and it is a draw if both spend equal dollars. If both players play optimally, output whether Alice wins, Bob wins, or if it is a draw." 1900.0                                           
     1526E "Oolimry and Suffix Array" "combinatorics,constructive algorithms,math" "Once upon a time, Oolimry saw a suffix array. He wondered how many strings can produce this suffix array. More formally, given a suffix array of length n and having an alphabet size k, count the number of strings that produce such a suffix array. Let s be a string of length n. Then the i-th suffix of s is the substring s[i\xe2\x80\xa6n\xe2\x88\x921]. A suffix array is the array of integers that represent the starting indexes of all the suffixes of a given string, after the suffixes are sorted in the lexicographic order. For example, the suffix array of oolimry is [3,2,4,1,0,5,6] as the array of sorted suffixes is [imry,limry,mry,olimry,oolimry,ry,y]. A string x is lexicographically smaller than string y, if either x is a prefix of y (and x\xe2\x89\xa0y), or there exists such i that xi<yi, and for any 1\xe2\x89\xa4j<i , xj=yj." 2400.0                                           
     1526C2 "Potions (Hard Version)" "data structures,greedy" "This is the hard version of the problem. The only difference is that in this version n\xe2\x89\xa4200000. You can make hacks only if both versions of the problem are solved.There are n potions in a line, with potion 1 on the far left and potion n on the far right. Each potion will increase your health by ai when drunk. ai can be negative, meaning that potion will decrease will health.You start with 0 health and you will walk from left to right, from first potion to the last one. At each potion, you may choose to drink it or ignore it. You must ensure that your health is always non-negative.What is the largest number of potions you can drink?" 1600.0                                           
          1332A "Exercising Walk" greedy,implementation,math "Alice has a cute cat. To keep her cat fit, Alice wants to design an exercising walk for her cat! Initially, Alice\'s cat is located in a cell (x,y) of an infinite grid. According to Alice\'s theory, cat needs to move:   exactly a steps left: from (u,v) to (u\xe2\x88\x921,v);  exactly b steps right: from (u,v) to (u+1,v);  exactly c steps down: from (u,v) to (u,v\xe2\x88\x921);  exactly d steps up: from (u,v) to (u,v+1). Note that the moves can be performed in an arbitrary order. For example, if the cat has to move 1 step left, 3 steps right and 2 steps down, then the walk right, down, left, right, right, down is valid.Alice, however, is worrying that her cat might get lost if it moves far away from her. So she hopes that her cat is always in the area [x1,x2]\xc3\x97[y1,y2], i.e. for every cat\'s position (u,v) of a walk x1\xe2\x89\xa4u\xe2\x89\xa4x2 and y1\xe2\x89\xa4v\xe2\x89\xa4y2 holds.Also, note that the cat can visit the same cell multiple times.Can you help Alice find out if there exists a walk satisfying her wishes?Formally, the walk should contain exactly a+b+c+d unit moves (a to the left, b to the right, c to the down, d to the up). Alice can do the moves in any order. Her current position (u,v) should always satisfy the constraints: x1\xe2\x89\xa4u\xe2\x89\xa4x2, y1\xe2\x89\xa4v\xe2\x89\xa4y2. The staring point is (x,y).You are required to answer t test cases independently." 1100.0                                      
          1331H "It\'s showtime" "*special problem" "You are given a mysterious language (codenamed ""UnknownX"") available in ""Custom Test"" tab. Find out what this language is, and use it to solve the following problem.You are given an integer input=1000\xe2\x88\x97n+mod (1\xe2\x89\xa4n,mod\xe2\x89\xa4999). Calculate double factorial of n modulo mod." -999.0                                      
          1329E "Dreamoon Loves AA" "binary search,greedy" "There is a string of length n+1 of characters \'A\' and \'B\'. The first character and last character of the string are equal to \'A\'.You are given m indices p1,p2,\xe2\x80\xa6,pm (0-indexation) denoting the other indices of characters \'A\' in the string. Let\'s denote the minimum distance between two neighboring \'A\' as l, and maximum distance between neighboring \'A\' as r.For example, (l,r) of string ""ABBAABBBA"" is (1,4).And let\'s denote the balance degree of a string as the value of r\xe2\x88\x92l.Now Dreamoon wants to change exactly k characters from \'B\' to \'A\', and he wants to make the balance degree of the string as small as possible.Please calculate the required minimum possible value of balance degree." 3300.0                                      
          1329C "Drazil Likes Heap" "constructive algorithms,data structures,greedy,implementation" "Drazil likes heap very much. So he created a problem with heap:There is a max heap with a height h implemented on the array. The details of this heap are the following:This heap contains exactly 2h\xe2\x88\x921 distinct positive non-zero integers. All integers are distinct. These numbers are stored in the array a indexed from 1 to 2h\xe2\x88\x921. For any 1<i<2h, a[i]<a[\xe2\x8c\x8ai2\xe2\x8c\x8b].Now we want to reduce the height of this heap such that the height becomes g with exactly 2g\xe2\x88\x921 numbers in heap. To reduce the height, we should perform the following action 2h\xe2\x88\x922g times:Choose an index i, which contains an element and call the following function f in index i:Note that we suppose that if a[i]=0, then index i don\'t contain an element.After all operations, the remaining 2g\xe2\x88\x921 element must be located in indices from 1 to 2g\xe2\x88\x921. Now Drazil wonders what\'s the minimum possible sum of the remaining 2g\xe2\x88\x921 elements. Please find this sum and find a sequence of the function calls to achieve this value." 2400.0                                      
          1327A "Sum of Odd Integers" math "You are given two integers n and k. Your task is to find if n can be represented as a sum of k distinct positive odd (not divisible by 2) integers or not.You have to answer t independent test cases." 1100.0                                      
          1326D1 "Prefix-Suffix Palindrome (Easy version)" "hashing,string suffix structures,strings" "This is the easy version of the problem. The difference is the constraint on the sum of lengths of strings and the number of test cases. You can make hacks only if you solve all versions of this task.You are given a string s, consisting of lowercase English letters. Find the longest string, t, which satisfies the following conditions:   The length of t does not exceed the length of s.  t is a palindrome.  There exists two strings a and b (possibly empty), such that t=a+b ( ""+"" represents concatenation), and a is prefix of s while b is suffix of s." 1500.0                                      
          1325E "Ehab\'s REAL Number Theory Problem" "brute force,dfs and similar,graphs,number theory,shortest paths" "You are given an array a of length n that has a special condition: every element in this array has at most 7 divisors. Find the length of the shortest non-empty subsequence of this array product of whose elements is a perfect square.A sequence a is a subsequence of an array b if a can be obtained from b by deletion of several (possibly, zero or all) elements." 2600.0                                      
          1324E "Sleeping Schedule" dp,implementation "Vova had a pretty weird sleeping schedule. There are h hours in a day. Vova will sleep exactly n times. The i-th time he will sleep exactly after ai hours from the time he woke up. You can assume that Vova woke up exactly at the beginning of this story (the initial time is 0). Each time Vova sleeps exactly one day (in other words, h hours).Vova thinks that the i-th sleeping time is good if he starts to sleep between hours l and r inclusive.Vova can control himself and before the i-th time can choose between two options: go to sleep after ai hours or after ai\xe2\x88\x921 hours.Your task is to say the maximum number of good sleeping times Vova can obtain if he acts optimally." 1700.0                                      
          1324C "Frog Jumps" "binary search,data structures,dfs and similar,greedy,implementation" "There is a frog staying to the left of the string s=s1s2\xe2\x80\xa6sn consisting of n characters (to be more precise, the frog initially stays at the cell 0). Each character of s is either \'L\' or \'R\'. It means that if the frog is staying at the i-th cell and the i-th character is \'L\', the frog can jump only to the left. If the frog is staying at the i-th cell and the i-th character is \'R\', the frog can jump only to the right. The frog can jump only to the right from the cell 0.Note that the frog can jump into the same cell twice and can perform as many jumps as it needs.The frog wants to reach the n+1-th cell. The frog chooses some positive integer value d before the first jump (and cannot change it later) and jumps by no more than d cells at once. I.e. if the i-th character is \'L\' then the frog can jump to any cell in a range [max(0,i\xe2\x88\x92d);i\xe2\x88\x921], and if the i-th character is \'R\' then the frog can jump to any cell in a range [i+1;min(n+1;i+d)].The frog doesn\'t want to jump far, so your task is to find the minimum possible value of d such that the frog can reach the cell n+1 from the cell 0 if it can jump by no more than d cells at once. It is guaranteed that it is always possible to reach n+1 from 0.You have to answer t independent test cases." 1100.0                                      
          1321A "Contest for Robots" greedy "Polycarp is preparing the first programming contest for robots. There are n problems in it, and a lot of robots are going to participate in it. Each robot solving the problem i gets pi points, and the score of each robot in the competition is calculated as the sum of pi over all problems i solved by it. For each problem, pi is an integer not less than 1.Two corporations specializing in problem-solving robot manufacturing, ""Robo-Coder Inc."" and ""BionicSolver Industries"", are going to register two robots (one for each corporation) for participation as well. Polycarp knows the advantages and flaws of robots produced by these companies, so, for each problem, he knows precisely whether each robot will solve it during the competition. Knowing this, he can try predicting the results \xe2\x80\x94 or manipulating them. For some reason (which absolutely cannot involve bribing), Polycarp wants the ""Robo-Coder Inc."" robot to outperform the ""BionicSolver Industries"" robot in the competition. Polycarp wants to set the values of pi in such a way that the ""Robo-Coder Inc."" robot gets strictly more points than the ""BionicSolver Industries"" robot. However, if the values of pi will be large, it may look very suspicious \xe2\x80\x94 so Polycarp wants to minimize the maximum value of pi over all problems. Can you help Polycarp to determine the minimum possible upper bound on the number of points given for solving the problems?" 900.0                                      
          1320F "Blocks and Sensors" "brute force" "Polycarp plays a well-known computer game (we won\'t mention its name). Every object in this game consists of three-dimensional blocks \xe2\x80\x94 axis-aligned cubes of size 1\xc3\x971\xc3\x971. These blocks are unaffected by gravity, so they can float in the air without support. The blocks are placed in cells of size 1\xc3\x971\xc3\x971; each cell either contains exactly one block or is empty. Each cell is represented by its coordinates (x,y,z) (the cell with these coordinates is a cube with opposite corners in (x,y,z) and (x+1,y+1,z+1)) and its contents ax,y,z; if the cell is empty, then ax,y,z=0, otherwise ax,y,z is equal to the type of the block placed in it (the types are integers from 1 to 2\xe2\x8b\x85105).Polycarp has built a large structure consisting of blocks. This structure can be enclosed in an axis-aligned rectangular parallelepiped of size n\xc3\x97m\xc3\x97k, containing all cells (x,y,z) such that x\xe2\x88\x88[1,n], y\xe2\x88\x88[1,m], and z\xe2\x88\x88[1,k]. After that, Polycarp has installed 2nm+2nk+2mk sensors around this parallelepiped. A sensor is a special block that sends a ray in some direction and shows the type of the first block that was hit by this ray (except for other sensors). The sensors installed by Polycarp are adjacent to the borders of the parallelepiped, and the rays sent by them are parallel to one of the coordinate axes and directed inside the parallelepiped. More formally, the sensors can be divided into 6 types:  there are mk sensors of the first type; each such sensor is installed in (0,y,z), where y\xe2\x88\x88[1,m] and z\xe2\x88\x88[1,k], and it sends a ray that is parallel to the Ox axis and has the same direction;  there are mk sensors of the second type; each such sensor is installed in (n+1,y,z), where y\xe2\x88\x88[1,m] and z\xe2\x88\x88[1,k], and it sends a ray that is parallel to the Ox axis and has the opposite direction;  there are nk sensors of the third type; each such sensor is installed in (x,0,z), where x\xe2\x88\x88[1,n] and z\xe2\x88\x88[1,k], and it sends a ray that is parallel to the Oy axis and has the same direction;  there are nk sensors of the fourth type; each such sensor is installed in (x,m+1,z), where x\xe2\x88\x88[1,n] and z\xe2\x88\x88[1,k], and it sends a ray that is parallel to the Oy axis and has the opposite direction;  there are nm sensors of the fifth type; each such sensor is installed in (x,y,0), where x\xe2\x88\x88[1,n] and y\xe2\x88\x88[1,m], and it sends a ray that is parallel to the Oz axis and has the same direction;  finally, there are nm sensors of the sixth type; each such sensor is installed in (x,y,k+1), where x\xe2\x88\x88[1,n] and y\xe2\x88\x88[1,m], and it sends a ray that is parallel to the Oz axis and has the opposite direction. Polycarp has invited his friend Monocarp to play with him. Of course, as soon as Monocarp saw a large parallelepiped bounded by sensor blocks, he began to wonder what was inside of it. Polycarp didn\'t want to tell Monocarp the exact shape of the figure, so he provided Monocarp with the data from all sensors and told him to try guessing the contents of the parallelepiped by himself.After some hours of thinking, Monocarp has no clue about what\'s inside the sensor-bounded space. But he does not want to give up, so he decided to ask for help. Can you write a program that will analyze the sensor data and construct any figure that is consistent with it?" 3500.0                                      
          1320D "Reachable Strings" "data structures,hashing,strings" "In this problem, we will deal with binary strings. Each character of a binary string is either a 0 or a 1. We will also deal with substrings; recall that a substring is a contiguous subsequence of a string. We denote the substring of string s starting from the l-th character and ending with the r-th character as s[l\xe2\x80\xa6r]. The characters of each string are numbered from 1.We can perform several operations on the strings we consider. Each operation is to choose a substring of our string and replace it with another string. There are two possible types of operations: replace 011 with 110, or replace 110 with 011. For example, if we apply exactly one operation to the string 110011110, it can be transformed into 011011110, 110110110, or 110011011.Binary string a is considered reachable from binary string b if there exists a sequence s1, s2, ..., sk such that s1=a, sk=b, and for every i\xe2\x88\x88[1,k\xe2\x88\x921], si can be transformed into si+1 using exactly one operation. Note that k can be equal to 1, i.\xe2\x80\x89e., every string is reachable from itself.You are given a string t and q queries to it. Each query consists of three integers l1, l2 and len. To answer each query, you have to determine whether t[l1\xe2\x80\xa6l1+len\xe2\x88\x921] is reachable from t[l2\xe2\x80\xa6l2+len\xe2\x88\x921]." 2500.0                                      
          1320B "Navigation System" "dfs and similar,graphs,shortest paths" "The map of Bertown can be represented as a set of n intersections, numbered from 1 to n and connected by m one-way roads. It is possible to move along the roads from any intersection to any other intersection. The length of some path from one intersection to another is the number of roads that one has to traverse along the path. The shortest path from one intersection v to another intersection u is the path that starts in v, ends in u and has the minimum length among all such paths.Polycarp lives near the intersection s and works in a building near the intersection t. Every day he gets from s to t by car. Today he has chosen the following path to his workplace: p1, p2, ..., pk, where p1=s, pk=t, and all other elements of this sequence are the intermediate intersections, listed in the order Polycarp arrived at them. Polycarp never arrived at the same intersection twice, so all elements of this sequence are pairwise distinct. Note that you know Polycarp\'s path beforehand (it is fixed), and it is not necessarily one of the shortest paths from s to t.Polycarp\'s car has a complex navigation system installed in it. Let\'s describe how it works. When Polycarp starts his journey at the intersection s, the system chooses some shortest path from s to t and shows it to Polycarp. Let\'s denote the next intersection in the chosen path as v. If Polycarp chooses to drive along the road from s to v, then the navigator shows him the same shortest path (obviously, starting from v as soon as he arrives at this intersection). However, if Polycarp chooses to drive to another intersection w instead, the navigator rebuilds the path: as soon as Polycarp arrives at w, the navigation system chooses some shortest path from w to t and shows it to Polycarp. The same process continues until Polycarp arrives at t: if Polycarp moves along the road recommended by the system, it maintains the shortest path it has already built; but if Polycarp chooses some other path, the system rebuilds the path by the same rules.Here is an example. Suppose the map of Bertown looks as follows, and Polycarp drives along the path [1,2,3,4] (s=1, t=4): Check the picture by the link http://tk.codeforces.com/a.png   When Polycarp starts at 1, the system chooses some shortest path from 1 to 4. There is only one such path, it is [1,5,4];  Polycarp chooses to drive to 2, which is not along the path chosen by the system. When Polycarp arrives at 2, the navigator rebuilds the path by choosing some shortest path from 2 to 4, for example, [2,6,4] (note that it could choose [2,3,4]);  Polycarp chooses to drive to 3, which is not along the path chosen by the system. When Polycarp arrives at 3, the navigator rebuilds the path by choosing the only shortest path from 3 to 4, which is [3,4];  Polycarp arrives at 4 along the road chosen by the navigator, so the system does not have to rebuild anything. Overall, we get 2 rebuilds in this scenario. Note that if the system chose [2,3,4] instead of [2,6,4] during the second step, there would be only 1 rebuild (since Polycarp goes along the path, so the system maintains the path [3,4] during the third step).The example shows us that the number of rebuilds can differ even if the map of Bertown and the path chosen by Polycarp stays the same. Given this information (the map and Polycarp\'s path), can you determine the minimum and the maximum number of rebuilds that could have happened during the journey?" 1700.0                                      
          1316E "Team Building" bitmasks,dp,greedy,sortings "Alice, the president of club FCB, wants to build a team for the new volleyball tournament. The team should consist of p players playing in p different positions. She also recognizes the importance of audience support, so she wants to select k people as part of the audience.There are n people in Byteland. Alice needs to select exactly p players, one for each position, and exactly k members of the audience from this pool of n people. Her ultimate goal is to maximize the total strength of the club.The i-th of the n persons has an integer ai associated with him \xe2\x80\x94 the strength he adds to the club if he is selected as a member of the audience.For each person i and for each position j, Alice knows si,j  \xe2\x80\x94 the strength added by the i-th person to the club if he is selected to play in the j-th position.Each person can be selected at most once as a player or a member of the audience. You have to choose exactly one player for each position.Since Alice is busy, she needs you to help her find the maximum possible strength of the club that can be achieved by an optimal choice of players and the audience." 2300.0                                      
          1316B "String Modification" "brute force,constructive algorithms,implementation,sortings,strings" "Vasya has a string s of length n. He decides to make the following modification to the string:   Pick an integer k, (1\xe2\x89\xa4k\xe2\x89\xa4n).  For i from 1 to n\xe2\x88\x92k+1, reverse the substring s[i:i+k\xe2\x88\x921] of s. For example, if string s is qwer and k=2, below is the series of transformations the string goes through:   qwer (original string)  wqer (after reversing the first substring of length 2)  weqr (after reversing the second substring of length 2)  werq (after reversing the last substring of length 2)  Hence, the resulting string after modifying s with k=2 is werq. Vasya wants to choose a k such that the string obtained after the above-mentioned modification is lexicographically smallest possible among all choices of k. Among all such k, he wants to choose the smallest one. Since he is busy attending Felicity 2020, he asks for your help.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 1400.0                                      
          1316A "Grade Allocation" implementation "n students are taking an exam. The highest possible score at this exam is m. Let ai be the score of the i-th student. You have access to the school database which stores the results of all students.You can change each student\'s score as long as the following conditions are satisfied:   All scores are integers  0\xe2\x89\xa4ai\xe2\x89\xa4m  The average score of the class doesn\'t change. You are student 1 and you would like to maximize your own score.Find the highest possible score you can assign to yourself such that all conditions are satisfied." 800.0                                      
          1313B "Different Rules" "constructive algorithms,greedy,implementation,math" "Nikolay has only recently started in competitive programming, but already qualified to the finals of one prestigious olympiad. There going to be n participants, one of whom is Nikolay. Like any good olympiad, it consists of two rounds. Tired of the traditional rules, in which the participant who solved the largest number of problems wins, the organizers came up with different rules.Suppose in the first round participant A took x-th place and in the second round \xe2\x80\x94 y-th place. Then the total score of the participant A is sum x+y. The overall place of the participant A is the number of participants (including A) having their total score less than or equal to the total score of A. Note, that some participants may end up having a common overall place. It is also important to note, that in both the first and the second round there were no two participants tying at a common place. In other words, for every i from 1 to n exactly one participant took i-th place in first round and exactly one participant took i-th place in second round.Right after the end of the Olympiad, Nikolay was informed that he got x-th place in first round and y-th place in the second round. Nikolay doesn\'t know the results of other participants, yet he wonders what is the minimum and maximum place he can take, if we consider the most favorable and unfavorable outcome for him. Please help Nikolay to find the answer to this question." 1700.0                                      
          1313A "Fast Food Restaurant" "brute force,greedy,implementation" "Tired of boring office work, Denis decided to open a fast food restaurant.On the first day he made a portions of dumplings, b portions of cranberry juice and c pancakes with condensed milk.The peculiarity of Denis\'s restaurant is the procedure of ordering food. For each visitor Denis himself chooses a set of dishes that this visitor will receive. When doing so, Denis is guided by the following rules:  every visitor should receive at least one dish (dumplings, cranberry juice, pancakes with condensed milk are all considered to be dishes);  each visitor should receive no more than one portion of dumplings, no more than one portion of cranberry juice and no more than one pancake with condensed milk;  all visitors should receive different sets of dishes. What is the maximum number of visitors Denis can feed?" 900.0                                      
          1311D "Three Integers" "brute force,math" "You are given three integers a\xe2\x89\xa4b\xe2\x89\xa4c.In one move, you can add +1 or \xe2\x88\x921 to any of these integers (i.e. increase or decrease any number by one). You can perform such operation any (possibly, zero) number of times, you can even perform this operation several times with one number. Note that you cannot make non-positive numbers using such operations.You have to perform the minimum number of such operations in order to obtain three integers A\xe2\x89\xa4B\xe2\x89\xa4C such that B is divisible by A and C is divisible by B.You have to answer t independent test cases." 2000.0                                      
          1311B WeirdSort "dfs and similar,sortings" "You are given an array a of length n.You are also given a set of distinct positions p1,p2,\xe2\x80\xa6,pm, where 1\xe2\x89\xa4pi<n. The position pi means that you can swap elements a[pi] and a[pi+1]. You can apply this operation any number of times for each of the given positions.Your task is to determine if it is possible to sort the initial array in non-decreasing order (a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4an) using only allowed swaps.For example, if a=[3,2,1] and p=[1,2], then we can first swap elements a[2] and a[3] (because position 2 is contained in the given set p). We get the array a=[3,1,2]. Then we swap a[1] and a[2] (position 1 is also contained in p). We get the array a=[1,3,2]. Finally, we swap a[2] and a[3] again and get the array a=[1,2,3], sorted in non-decreasing order.You can see that if a=[4,1,2,3] and p=[3,2] then you cannot sort the array.You have to answer t independent test cases." 1200.0                                      
          1310E "Strange Function" dp "Let\'s define the function f of multiset a as the multiset of number of occurences of every number, that is present in a.E.g., f({5,5,1,2,5,2,3,3,9,5})={1,1,2,2,4}.Let\'s define fk(a), as applying f to array a k times: fk(a)=f(fk\xe2\x88\x921(a)),f0(a)=a. E.g., f2({5,5,1,2,5,2,3,3,9,5})={1,2,2}.You are given integers n,k and you are asked how many different values the function fk(a) can have, where a is arbitrary non-empty array with numbers of size no more than n. Print the answer modulo 998244353." 2900.0                                      
          1310B "Double Elimination" dp,implementation "The biggest event of the year \xe2\x80\x93 Cota 2 world championship ""The Innernational"" is right around the corner. 2n teams will compete in a double-elimination format (please, carefully read problem statement even if you know what is it) to identify the champion. Teams are numbered from 1 to 2n and will play games one-on-one. All teams start in the upper bracket.All upper bracket matches will be held played between teams that haven\'t lost any games yet. Teams are split into games by team numbers. Game winner advances in the next round of upper bracket, losers drop into the lower bracket.Lower bracket starts with 2n\xe2\x88\x921 teams that lost the first upper bracket game. Each lower bracket round consists of two games. In the first game of a round 2k teams play a game with each other (teams are split into games by team numbers). 2k\xe2\x88\x921 loosing teams are eliminated from the championship, 2k\xe2\x88\x921 winning teams are playing 2k\xe2\x88\x921 teams that got eliminated in this round of upper bracket (again, teams are split into games by team numbers). As a result of each round both upper and lower bracket have 2k\xe2\x88\x921 teams remaining. See example notes for better understanding.Single remaining team of upper bracket plays with single remaining team of lower bracket in grand-finals to identify championship winner.You are a fan of teams with numbers a1,a2,...,ak. You want the championship to have as many games with your favourite teams as possible. Luckily, you can affect results of every championship game the way you want. What\'s maximal possible number of championship games that include teams you\'re fan of?" 2500.0                                      
          1307A "Cow and Haybales" greedy,implementation "The USA Construction Operation (USACO) recently ordered Farmer John to arrange a row of n haybale piles on the farm. The i-th pile contains ai haybales. However, Farmer John has just left for vacation, leaving Bessie all on her own. Every day, Bessie the naughty cow can choose to move one haybale in any pile to an adjacent pile. Formally, in one day she can choose any two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that |i\xe2\x88\x92j|=1 and ai>0 and apply ai=ai\xe2\x88\x921, aj=aj+1. She may also decide to not do anything on some days because she is lazy.Bessie wants to maximize the number of haybales in pile 1 (i.e. to maximize a1), and she only has d days to do so before Farmer John returns. Help her find the maximum number of haybales that may be in pile 1 if she acts optimally!" 800.0                                      
          1304D "Shortest and Longest LIS" "constructive algorithms,graphs,greedy,two pointers" "Gildong recently learned how to find the longest increasing subsequence (LIS) in O(nlogn) time for a sequence of length n. He wants to test himself if he can implement it correctly, but he couldn\'t find any online judges that would do it (even though there are actually many of them). So instead he\'s going to make a quiz for you about making permutations of n distinct integers between 1 and n, inclusive, to test his code with your output.The quiz is as follows.Gildong provides a string of length n\xe2\x88\x921, consisting of characters \'<\' and \'>\' only. The i-th (1-indexed) character is the comparison result between the i-th element and the i+1-st element of the sequence. If the i-th character of the string is \'<\', then the i-th element of the sequence is less than the i+1-st element. If the i-th character of the string is \'>\', then the i-th element of the sequence is greater than the i+1-st element.He wants you to find two possible sequences (not necessarily distinct) consisting of n distinct integers between 1 and n, inclusive, each satisfying the comparison results, where the length of the LIS of the first sequence is minimum possible, and the length of the LIS of the second sequence is maximum possible." 1800.0                                      
          1303G "Sum of Prefix Sums" "data structures,divide and conquer,geometry,trees" "We define the sum of prefix sums of an array [s1,s2,\xe2\x80\xa6,sk] as s1+(s1+s2)+(s1+s2+s3)+\xe2\x8b\xaf+(s1+s2+\xe2\x8b\xaf+sk).You are given a tree consisting of n vertices. Each vertex i has an integer ai written on it. We define the value of the simple path from vertex u to vertex v as follows: consider all vertices appearing on the path from u to v, write down all the numbers written on these vertices in the order they appear on the path, and compute the sum of prefix sums of the resulting sequence.Your task is to calculate the maximum value over all paths in the tree." 2700.0                                      
          1303E "Erase Subsequences" dp,strings "You are given a string s. You can build new string p from s using the following operation no more than two times:   choose any subsequence si1,si2,\xe2\x80\xa6,sik where 1\xe2\x89\xa4i1<i2<\xe2\x8b\xaf<ik\xe2\x89\xa4|s|;  erase the chosen subsequence from s (s can become empty);  concatenate chosen subsequence to the right of the string p (in other words, p=p+si1si2\xe2\x80\xa6sik). Of course, initially the string p is empty. For example, let s=ababcd. At first, let\'s choose subsequence s1s4s5=abc \xe2\x80\x94 we will get s=bad and p=abc. At second, let\'s choose s1s2=ba \xe2\x80\x94 we will get s=d and p=abcba. So we can build abcba from ababcd.Can you build a given string t using the algorithm above?" 2200.0                                      
          1303D "Fill The Bag" bitmasks,greedy "You have a bag of size n. Also you have m boxes. The size of i-th box is ai, where each ai is an integer non-negative power of two.You can divide boxes into two parts of equal size. Your goal is to fill the bag completely.For example, if n=10 and a=[1,1,32] then you have to divide the box of size 32 into two parts of size 16, and then divide the box of size 16. So you can fill the bag with boxes of size 1, 1 and 8.Calculate the minimum number of divisions required to fill the bag of size n." 1900.0                                      
          1302F "Keep talking and nobody explodes -- easy" "bitmasks,brute force,expression parsing" "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543You have the safe lock which consists of 5 decimal digits. If you rotate some digit, it increases by one, except 9 which becomes 0.Initially, the lock contains number x. To unlock the safe you must do the following operations in order (and be careful, don\'t mix up if and else statements).If sum of digits on positions 1 and 4 is greater than 10, rotate digit on position 1 by 3 times, else rotate digit on position 4 by 8 times.If sum of digits on positions 3 and 2 is greater than 8, rotate digit on position 4 by 9 times, else rotate digit on position 5 by 8 times.If digit on position 3 is odd, rotate digit on position 3 by 3 times, else rotate digit on position 3 by 4 times.If digit on position 5 is greater than digit on position 2, rotate digit on position 4 by 1 times, else rotate digit on position 2 by 7 times.If digit on position 1 is odd, rotate digit on position 1 by 3 times, else rotate digit on position 3 by 5 times.If digit on position 4 is odd, rotate digit on position 4 by 7 times, else rotate digit on position 1 by 9 times.If digit on position 4 is greater than digit on position 1, rotate digit on position 4 by 9 times, else rotate digit on position 4 by 2 times.If digit on position 1 is greater than digit on position 3, rotate digit on position 2 by 1 times, else rotate digit on position 3 by 1 times.If digit on position 5 is greater than digit on position 3, rotate digit on position 4 by 5 times, else rotate digit on position 5 by 8 times.If sum of digits on positions 1 and 3 is greater than 8, rotate digit on position 4 by 5 times, else rotate digit on position 2 by 5 times.If digit on position 1 is greater than digit on position 4, rotate digit on position 4 by 3 times, else rotate digit on position 2 by 3 times.If sum of digits on positions 3 and 1 is greater than 9, rotate digit on position 2 by 9 times, else rotate digit on position 2 by 2 times.If sum of digits on positions 4 and 3 is greater than 10, rotate digit on position 4 by 7 times, else rotate digit on position 5 by 7 times.If digit on position 3 is greater than digit on position 2, rotate digit on position 3 by 2 times, else rotate digit on position 4 by 6 times.If digit on position 1 is greater than digit on position 3, rotate digit on position 1 by 9 times, else rotate digit on position 2 by 9 times.If digit on position 3 is odd, rotate digit on position 3 by 9 times, else rotate digit on position 1 by 5 times.If sum of digits on positions 3 and 5 is greater than 9, rotate digit on position 3 by 4 times, else rotate digit on position 3 by 9 times.If digit on position 3 is greater than digit on position 1, rotate digit on position 5 by 1 times, else rotate digit on position 5 by 7 times.If digit on position 1 is greater than digit on position 3, rotate digit on position 2 by 9 times, else rotate digit on position 4 by 6 times.If sum of digits on positions 2 and 3 is greater than 10, rotate digit on position 2 by 2 times, else rotate digit on position 3 by 6 times." -999.0                                      
          1302C "Segment tree or Fenwick?" "data structures" "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543You are given an array A of length n, initially filled with zeros. You need to process q queries to the array, each of one of the following types:   1 x y: you need to assign Ax=y;  2 l r: you need to print r\xe2\x88\x91i=lAi.  Furthermore, there are T independent tests you need to process." -999.0                                      
          1297C "Dream Team" "*special problem,greedy" "Polycarp is the project manager in the IT-company. Right now, he needs to choose developers for his team to start a new project. The company has n developers ""on the bench"" (i.e not involved in other projects). Polycarp assessed the skills of each of them: ai (\xe2\x88\x92104\xe2\x89\xa4ai\xe2\x89\xa4104) \xe2\x80\x94 an integer characteristic of the i-th developer. This value can be either positive, zero or even negative (some developers cause distractions).After Polycarp chooses a subset of developers for his team, the strength of the team will be determined by the sum of ai values for all selected developers.Polycarp fears that if he chooses a team in such a way that maximizes the sum of the characteristics of ai, other managers may find this unacceptable. For this reason, he plans to create such a team that the sum of the ai values for it is strictly less than the maximum possible value.Help Polycarp choose any team that:  the sum of the characteristics ai for all members of the selected team is strictly less than the maximum value that can be achieved by choosing the team in some other way  and at the same time, the sum of the characteristics of ai for all members of the selected team is the greatest possible. If, following the requirements above, you can select a team in several ways, then just find any of them. It\'s guaranteed that the sum of the characteristics in the desired subset is strictly positive (i.e. Polycarp can always choose a non-empty team)." -999.0                                      
          1297A "Likes Display" "*special problem,implementation" "Polycarp is working on the implementation of displaying likes on the Codehorses social network. The number of likes should be displayed in a format that will be easy to read by users. It was decided that for large numbers of likes the format should be like 123K (one hundred twenty-three thousand) or like 56M (fifty-six million).The following displaying strategy has been approved:  the number will be displayed either as an integer number from 0 to 999, or as a positive integer number of thousands (from 1K to 999K), or as a positive integer number of millions (from 1M on),  the specified exact number of likes n when displaying should be rounded to the nearest view from the case above (if rounding is ambiguous, it must be rounded up): for example, 1785 should be rounded to 2K instead of 1K, 4500000 should be rounded to 5M. Help Polycarp implement this part of the functionality: for a given non-negative integer number of likes n, print its view in the Codehorses interface." -999.0                                      
          1295F "Good Contest" combinatorics,dp,probabilities "An online contest will soon be held on ForceCoders, a large competitive programming platform. The authors have prepared n problems; and since the platform is very popular, 998244351 coder from all over the world is going to solve them.For each problem, the authors estimated the number of people who would solve it: for the i-th problem, the number of accepted solutions will be between li and ri, inclusive.The creator of ForceCoders uses different criteria to determine if the contest is good or bad. One of these criteria is the number of inversions in the problem order. An inversion is a pair of problems (x,y) such that x is located earlier in the contest (x<y), but the number of accepted solutions for y is strictly greater.Obviously, both the creator of ForceCoders and the authors of the contest want the contest to be good. Now they want to calculate the probability that there will be no inversions in the problem order, assuming that for each problem i, any integral number of accepted solutions for it (between li and ri) is equally probable, and all these numbers are independent." 2700.0                                      
          1295C "Obtain The String" dp,greedy,strings "You are given two strings s and t consisting of lowercase Latin letters. Also you have a string z which is initially empty. You want string z to be equal to string t. You can perform the following operation to achieve this: append any subsequence of s at the end of string z. A subsequence is a sequence that can be derived from the given sequence by deleting zero or more elements without changing the order of the remaining elements. For example, if z=ac, s=abcde, you may turn z into following strings in one operation:   z=acace (if we choose subsequence ace);  z=acbcd (if we choose subsequence bcd);  z=acbce (if we choose subsequence bce). Note that after this operation string s doesn\'t change.Calculate the minimum number of such operations to turn string z into string t." 1600.0                                      
          1293A "ConneR and the A.R.C. Markland-N" "binary search,brute force,implementation" "Sakuzyo - ImprintingA.R.C. Markland-N is a tall building with n floors numbered from 1 to n. Between each two adjacent floors in the building, there is a staircase connecting them.It\'s lunchtime for our sensei Colin ""ConneR"" Neumann Jr, and he\'s planning for a location to enjoy his meal.ConneR\'s office is at floor s of the building. On each floor (including floor s, of course), there is a restaurant offering meals. However, due to renovations being in progress, k of the restaurants are currently closed, and as a result, ConneR can\'t enjoy his lunch there.CooneR wants to reach a restaurant as quickly as possible to save time. What is the minimum number of staircases he needs to walk to reach a closest currently open restaurant.Please answer him quickly, and you might earn his praise and even enjoy the lunch with him in the elegant Neumanns\' way!" 1100.0                                      
          1291F "Coffee Varieties (easy version)" graphs,interactive "This is the easy version of the problem. You can find the hard version in the Div. 1 contest. Both versions only differ in the number of times you can ask your friend to taste coffee.This is an interactive problem.You\'re considering moving to another city, where one of your friends already lives. There are n caf\xc3\xa9s in this city, where n is a power of two. The i-th caf\xc3\xa9 produces a single variety of coffee ai. As you\'re a coffee-lover, before deciding to move or not, you want to know the number d of distinct varieties of coffees produced in this city.You don\'t know the values a1,\xe2\x80\xa6,an. Fortunately, your friend has a memory of size k, where k is a power of two.Once per day, you can ask him to taste a cup of coffee produced by the caf\xc3\xa9 c, and he will tell you if he tasted a similar coffee during the last k days.You can also ask him to take a medication that will reset his memory. He will forget all previous cups of coffee tasted. You can reset his memory at most 30 000 times.More formally, the memory of your friend is a queue S. Doing a query on caf\xc3\xa9 c will:   Tell you if ac is in S;  Add ac at the back of S;  If |S|>k, pop the front element of S. Doing a reset request will pop all elements out of S.Your friend can taste at most 2n2k cups of coffee in total. Find the diversity d (number of distinct values in the array a).Note that asking your friend to reset his memory does not count towards the number of times you ask your friend to taste a cup of coffee.In some test cases the behavior of the interactor is adaptive. It means that the array a may be not fixed before the start of the interaction and may depend on your queries. It is guaranteed that at any moment of the interaction, there is at least one array a consistent with all the answers given so far." 2800.0                                      
          1288B "Yet Another Meme Problem" math "You are given two integers A and B, calculate the number of pairs (a,b) such that 1\xe2\x89\xa4a\xe2\x89\xa4A, 1\xe2\x89\xa4b\xe2\x89\xa4B, and the equation a\xe2\x8b\x85b+a+b=conc(a,b) is true; conc(a,b) is the concatenation of a and b (for example, conc(12,23)=1223, conc(100,11)=10011). a and b should not contain leading zeroes." 1100.0                                      
          1288A Deadline "binary search,brute force,math,ternary search" "Adilbek was assigned to a special project. For Adilbek it means that he has n days to run a special program and provide its results. But there is a problem: the program needs to run for d days to calculate the results.Fortunately, Adilbek can optimize the program. If he spends x (x is a non-negative integer) days optimizing the program, he will make the program run in \xe2\x8c\x88dx+1\xe2\x8c\x89 days (\xe2\x8c\x88a\xe2\x8c\x89 is the ceiling function: \xe2\x8c\x882.4\xe2\x8c\x89=3, \xe2\x8c\x882\xe2\x8c\x89=2). The program cannot be run and optimized simultaneously, so the total number of days he will spend is equal to x+\xe2\x8c\x88dx+1\xe2\x8c\x89.Will Adilbek be able to provide the generated results in no more than n days?" 1100.0                                      
          1285C "Fadi and LCM" "brute force,math,number theory" "Today, Osama gave Fadi an integer X, and Fadi was wondering about the minimum possible value of max(a,b) such that LCM(a,b) equals X. Both a and b should be positive integers.LCM(a,b) is the smallest positive integer that is divisible by both a and b. For example, LCM(6,8)=24, LCM(4,12)=12, LCM(2,3)=6.Of course, Fadi immediately knew the answer. Can you be just like Fadi and find any such pair?" 1400.0                                      
          1285A "Mezo Playing Zoma" math "Today, Mezo is playing a game. Zoma, a character in that game, is initially at position x=0. Mezo starts sending n commands to Zoma. There are two possible commands:  \'L\' (Left) sets the position x:=x\xe2\x88\x921;  \'R\' (Right) sets the position x:=x+1. Unfortunately, Mezo\'s controller malfunctions sometimes. Some commands are sent successfully and some are ignored. If the command is ignored then the position x doesn\'t change and Mezo simply proceeds to the next command.For example, if Mezo sends commands ""LRLR"", then here are some possible outcomes (underlined commands are sent successfully):   ""LRLR"" \xe2\x80\x94 Zoma moves to the left, to the right, to the left again and to the right for the final time, ending up at position 0;  ""LRLR"" \xe2\x80\x94 Zoma recieves no commands, doesn\'t move at all and ends up at position 0 as well;  ""LRLR"" \xe2\x80\x94 Zoma moves to the left, then to the left again and ends up in position \xe2\x88\x922. Mezo doesn\'t know which commands will be sent successfully beforehand. Thus, he wants to know how many different positions may Zoma end up at." 800.0                                      
          1284B "New Year and Ascent Sequence" "binary search,combinatorics,data structures,dp,implementation,sortings" "A sequence a=[a1,a2,\xe2\x80\xa6,al] of length l has an ascent if there exists a pair of indices (i,j) such that 1\xe2\x89\xa4i<j\xe2\x89\xa4l and ai<aj. For example, the sequence [0,2,0,2,0] has an ascent because of the pair (1,4), but the sequence [4,3,3,3,1] doesn\'t have an ascent.Let\'s call a concatenation of sequences p and q the sequence that is obtained by writing down sequences p and q one right after another without changing the order. For example, the concatenation of the [0,2,0,2,0] and [4,3,3,3,1] is the sequence [0,2,0,2,0,4,3,3,3,1]. The concatenation of sequences p and q is denoted as p+q.Gyeonggeun thinks that sequences with ascents bring luck. Therefore, he wants to make many such sequences for the new year. Gyeonggeun has n sequences s1,s2,\xe2\x80\xa6,sn which may have different lengths. Gyeonggeun will consider all n2 pairs of sequences sx and sy (1\xe2\x89\xa4x,y\xe2\x89\xa4n), and will check if its concatenation sx+sy has an ascent. Note that he may select the same sequence twice, and the order of selection matters.Please count the number of pairs (x,y) of sequences s1,s2,\xe2\x80\xa6,sn whose concatenation sx+sy contains an ascent." 1400.0                                      
          1283E "New Year Parties" dp,greedy "Oh, New Year. The time to gather all your friends and reflect on the heartwarming events of the past year...n friends live in a city which can be represented as a number line. The i-th friend lives in a house with an integer coordinate xi. The i-th friend can come celebrate the New Year to the house with coordinate xi\xe2\x88\x921, xi+1 or stay at xi. Each friend is allowed to move no more than once.For all friends 1\xe2\x89\xa4xi\xe2\x89\xa4n holds, however, they can come to houses with coordinates 0 and n+1 (if their houses are at 1 or n, respectively).For example, let the initial positions be x=[1,2,4,4]. The final ones then can be [1,3,3,4], [0,2,3,3], [2,2,5,5], [2,1,3,5] and so on. The number of occupied houses is the number of distinct positions among the final ones.So all friends choose the moves they want to perform. After that the number of occupied houses is calculated. What is the minimum and the maximum number of occupied houses can there be?" 1800.0                                      
          1283D "Christmas Trees" "graphs,greedy,shortest paths" "There are n Christmas trees on an infinite number line. The i-th tree grows at the position xi. All xi are guaranteed to be distinct.Each integer point can be either occupied by the Christmas tree, by the human or not occupied at all. Non-integer points cannot be occupied by anything.There are m people who want to celebrate Christmas. Let y1,y2,\xe2\x80\xa6,ym be the positions of people (note that all values x1,x2,\xe2\x80\xa6,xn,y1,y2,\xe2\x80\xa6,ym should be distinct and all yj should be integer). You want to find such an arrangement of people that the value m\xe2\x88\x91j=1nmini=1|xi\xe2\x88\x92yj| is the minimum possible (in other words, the sum of distances to the nearest Christmas tree for all people should be minimized).In other words, let dj be the distance from the j-th human to the nearest Christmas tree (dj=nmini=1|yj\xe2\x88\x92xi|). Then you need to choose such positions y1,y2,\xe2\x80\xa6,ym that m\xe2\x88\x91j=1dj is the minimum possible." 1800.0                                      
          1282C "Petya and Exam" "greedy,sortings,two pointers" "Petya has come to the math exam and wants to solve as many problems as possible. He prepared and carefully studied the rules by which the exam passes.The exam consists of n problems that can be solved in T minutes. Thus, the exam begins at time 0 and ends at time T. Petya can leave the exam at any integer time from 0 to T, inclusive.All problems are divided into two types:   easy problems \xe2\x80\x94 Petya takes exactly a minutes to solve any easy problem;  hard problems \xe2\x80\x94 Petya takes exactly b minutes (b>a) to solve any hard problem. Thus, if Petya starts solving an easy problem at time x, then it will be solved at time x+a. Similarly, if at a time x Petya starts to solve a hard problem, then it will be solved at time x+b.For every problem, Petya knows if it is easy or hard. Also, for each problem is determined time ti (0\xe2\x89\xa4ti\xe2\x89\xa4T) at which it will become mandatory (required). If Petya leaves the exam at time s and there is such a problem i that ti\xe2\x89\xa4s and he didn\'t solve it, then he will receive 0 points for the whole exam. Otherwise (i.e if he has solved all such problems for which ti\xe2\x89\xa4s) he will receive a number of points equal to the number of solved problems. Note that leaving at time s Petya can have both ""mandatory"" and ""non-mandatory"" problems solved.For example, if n=2, T=5, a=2, b=3, the first problem is hard and t1=3 and the second problem is easy and t2=2. Then:  if he leaves at time s=0, then he will receive 0 points since he will not have time to solve any problems;  if he leaves at time s=1, he will receive 0 points since he will not have time to solve any problems;  if he leaves at time s=2, then he can get a 1 point by solving the problem with the number 2 (it must be solved in the range from 0 to 2);  if he leaves at time s=3, then he will receive 0 points since at this moment both problems will be mandatory, but he will not be able to solve both of them;  if he leaves at time s=4, then he will receive 0 points since at this moment both problems will be mandatory, but he will not be able to solve both of them;  if he leaves at time s=5, then he can get 2 points by solving all problems. Thus, the answer to this test is 2.Help Petya to determine the maximal number of points that he can receive, before leaving the exam." 1800.0                                      
          1282A "Temporarily unavailable" implementation,math "Polycarp lives on the coordinate axis Ox and travels from the point x=a to x=b. It moves uniformly rectilinearly at a speed of one unit of distance per minute.On the axis Ox at the point x=c the base station of the mobile operator is placed. It is known that the radius of its coverage is r. Thus, if Polycarp is at a distance less than or equal to r from the point x=c, then he is in the network coverage area, otherwise \xe2\x80\x94 no. The base station can be located both on the route of Polycarp and outside it.Print the time in minutes during which Polycarp will not be in the coverage area of the network, with a rectilinear uniform movement from x=a to x=b. His speed \xe2\x80\x94 one unit of distance per minute." 900.0                                      
          1281B "Azamon Web Services" greedy "Your friend Jeff Zebos has been trying to run his new online company, but it\'s not going very well. He\'s not getting a lot of sales on his website which he decided to call Azamon. His big problem, you think, is that he\'s not ranking high enough on the search engines. If only he could rename his products to have better names than his competitors, then he\'ll be at the top of the search results and will be a millionaire.After doing some research, you find out that search engines only sort their results lexicographically. If your friend could rename his products to lexicographically smaller strings than his competitor\'s, then he\'ll be at the top of the rankings!To make your strategy less obvious to his competitors, you decide to swap no more than two letters of the product names.Please help Jeff to find improved names for his products that are lexicographically smaller than his competitor\'s!Given the string s representing Jeff\'s product name and the string c representing his competitor\'s product name, find a way to swap at most one pair of characters in s (that is, find two distinct indices i and j and swap si and sj) such that the resulting new name becomes strictly lexicographically smaller than c, or determine that it is impossible.Note: String a is strictly lexicographically smaller than string b if and only if one of the following holds:  a is a proper prefix of b, that is, a is a prefix of b such that a\xe2\x89\xa0b;  There exists an integer 1\xe2\x89\xa4i\xe2\x89\xa4min(|a|,|b|) such that ai<bi and aj=bj for 1\xe2\x89\xa4j<i." 1600.0                                      
          1280F "Intergalactic Sliding Puzzle" "combinatorics,constructive algorithms,math" "You are an intergalactic surgeon and you have an alien patient. For the purposes of this problem, we can and we will model this patient\'s body using a 2\xc3\x97(2k+1) rectangular grid. The alien has 4k+1 distinct organs, numbered 1 to 4k+1.In healthy such aliens, the organs are arranged in a particular way. For example, here is how the organs of a healthy such alien would be positioned, when viewed from the top, for k=4:  Here, the E represents empty space. In general, the first row contains organs 1 to 2k+1 (in that order from left to right), and the second row contains organs 2k+2 to 4k+1 (in that order from left to right) and then empty space right after. Your patient\'s organs are complete, and inside their body, but they somehow got shuffled around! Your job, as an intergalactic surgeon, is to put everything back in its correct position. All organs of the alien must be in its body during the entire procedure. This means that at any point during the procedure, there is exactly one cell (in the grid) that is empty. In addition, you can only move organs around by doing one of the following things:  You can switch the positions of the empty space E with any organ to its immediate left or to its immediate right (if they exist). In reality, you do this by sliding the organ in question to the empty space;  You can switch the positions of the empty space E with any organ to its immediate top or its immediate bottom (if they exist) only if the empty space is on the leftmost column, rightmost column or in the centermost column. Again, you do this by sliding the organ in question to the empty space. Your job is to figure out a sequence of moves you must do during the surgical procedure in order to place back all 4k+1 internal organs of your patient in the correct cells. If it is impossible to do so, you must say so." 3400.0                                      
          1276D "Tree Elimination" dp,trees "Vasya has a tree with n vertices numbered from 1 to n, and n\xe2\x88\x921 edges numbered from 1 to n\xe2\x88\x921. Initially each vertex contains a token with the number of the vertex written on it.Vasya plays a game. He considers all edges of the tree by increasing of their indices. For every edge he acts as follows: If both endpoints of the edge contain a token, remove a token from one of the endpoints and write down its number. Otherwise, do nothing.The result of the game is the sequence of numbers Vasya has written down. Note that there may be many possible resulting sequences depending on the choice of endpoints when tokens are removed.Vasya has played for such a long time that he thinks he exhausted all possible resulting sequences he can obtain. He wants you to verify him by computing the number of distinct sequences modulo 998244353." 2900.0                                      
          1276A "As Simple as One and Two" dp,greedy "You are given a non-empty string s=s1s2\xe2\x80\xa6sn, which consists only of lowercase Latin letters. Polycarp does not like a string if it contains at least one string ""one"" or at least one string ""two"" (or both at the same time) as a substring. In other words, Polycarp does not like the string s if there is an integer j (1\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x922), that sjsj+1sj+2=""one"" or sjsj+1sj+2=""two"".For example:  Polycarp does not like strings ""oneee"", ""ontwow"", ""twone"" and ""oneonetwo"" (they all have at least one substring ""one"" or ""two""),  Polycarp likes strings ""oonnee"", ""twwwo"" and ""twnoe"" (they have no substrings ""one"" and ""two""). Polycarp wants to select a certain set of indices (positions) and remove all letters on these positions. All removals are made at the same time.For example, if the string looks like s=""onetwone"", then if Polycarp selects two indices 3 and 6, then ""onetwone"" will be selected and the result is ""ontwne"".What is the minimum number of indices (positions) that Polycarp needs to select to make the string liked? What should these positions be?" 1400.0                                      
          1268D "Invertation in Tournament" "brute force,divide and conquer,graphs,math" "You are given a tournament \xe2\x80\x94 complete directed graph.In one operation you can pick any vertex v and change the direction of all edges with v on one of the ends (i.e all edges u\xe2\x86\x92v change their orientation to v\xe2\x86\x92u and vice versa).You want to make the tournament strongly connected with the smallest possible number of such operations if it is possible. Also, if it is possible, you need to find the number of ways to make this number of operations to make graph strongly connected (two ways are different if for some i vertex that we chose on i-th operation in one way is different from vertex that we chose on i-th operation in another way). You only need to find this value modulo 998244353." 3200.0                                      
          1268A "Long Beautiful Integer" "constructive algorithms,greedy,implementation,strings" "You are given an integer x of n digits a1,a2,\xe2\x80\xa6,an, which make up its decimal notation in order from left to right.Also, you are given a positive integer k<n.Let\'s call integer b1,b2,\xe2\x80\xa6,bm beautiful if bi=bi+k for each i, such that 1\xe2\x89\xa4i\xe2\x89\xa4m\xe2\x88\x92k.You need to find the smallest beautiful integer y, such that y\xe2\x89\xa5x." 1700.0                                      
          1264C "Beautiful Mirrors with queries" "data structures,probabilities" "Creatnx has n mirrors, numbered from 1 to n. Every day, Creatnx asks exactly one mirror ""Am I beautiful?"". The i-th mirror will tell Creatnx that he is beautiful with probability pi100 for all 1\xe2\x89\xa4i\xe2\x89\xa4n.Some mirrors are called checkpoints. Initially, only the 1st mirror is a checkpoint. It remains a checkpoint all the time.Creatnx asks the mirrors one by one, starting from the 1-st mirror. Every day, if he asks i-th mirror, there are two possibilities:  The i-th mirror tells Creatnx that he is beautiful. In this case, if i=n Creatnx will stop and become happy, otherwise he will continue asking the i+1-th mirror next day;  In the other case, Creatnx will feel upset. The next day, Creatnx will start asking from the checkpoint with a maximal number that is less or equal to i. There are some changes occur over time: some mirrors become new checkpoints and some mirrors are no longer checkpoints. You are given q queries, each query is represented by an integer u: If the u-th mirror isn\'t a checkpoint then we set it as a checkpoint. Otherwise, the u-th mirror is no longer a checkpoint.After each query, you need to calculate the expected number of days until Creatnx becomes happy.Each of this numbers should be found by modulo 998244353. Formally, let M=998244353. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 2400.0                                      
          1256A "Payment Without Change" math "You have a coins of value n and b coins of value 1. You always pay in exact change, so you want to know if there exist such x and y that if you take x (0\xe2\x89\xa4x\xe2\x89\xa4a) coins of value n and y (0\xe2\x89\xa4y\xe2\x89\xa4b) coins of value 1, then the total value of taken coins will be S.You have to answer q independent test cases." 1000.0                                      
          1255A "Changing Volume" math "Bob watches TV every day. He always sets the volume of his TV to b. However, today he is angry to find out someone has changed the volume to a. Of course, Bob has a remote control that can change the volume.There are six buttons (\xe2\x88\x925,\xe2\x88\x922,\xe2\x88\x921,+1,+2,+5) on the control, which in one press can either increase or decrease the current volume by 1, 2, or 5. The volume can be arbitrarily large, but can never be negative. In other words, Bob cannot press the button if it causes the volume to be lower than 0.As Bob is so angry, he wants to change the volume to b using as few button presses as possible. However, he forgets how to do such simple calculations, so he asks you for help. Write a program that given a and b, finds the minimum number of presses to change the TV volume from a to b." 800.0                                      
          1251D "Salary Changing" "binary search,greedy,sortings" "You are the head of a large enterprise. n people work at you, and n is odd (i.\xe2\x80\x89e. n is not divisible by 2).You have to distribute salaries to your employees. Initially, you have s dollars for it, and the i-th employee should get a salary from li to ri dollars. You have to distribute salaries in such a way that the median salary is maximum possible.To find the median of a sequence of odd length, you have to sort it and take the element in the middle position after sorting. For example:  the median of the sequence [5,1,10,17,6] is 6,  the median of the sequence [1,2,1] is 1. It is guaranteed that you have enough money to pay the minimum salary, i.e l1+l2+\xe2\x8b\xaf+ln\xe2\x89\xa4s.Note that you don\'t have to spend all your s dollars on salaries.You have to answer t test cases." 1900.0                                      
          1250B "The Feast and the Bus" "brute force,constructive algorithms,greedy,math" "Employees of JebTrains are on their way to celebrate the 256-th day of the year! There are n employees and k teams in JebTrains. Each employee is a member of some (exactly one) team. All teams are numbered from 1 to k. You are given an array of numbers t1,t2,\xe2\x80\xa6,tn where ti is the i-th employee\'s team number.JebTrains is going to rent a single bus to get employees to the feast. The bus will take one or more rides. A bus can pick up an entire team or two entire teams. If three or more teams take a ride together they may start a new project which is considered unacceptable. It\'s prohibited to split a team, so all members of a team should take the same ride.It is possible to rent a bus of any capacity s. Such a bus can take up to s people on a single ride. The total cost of the rent is equal to s\xe2\x8b\x85r burles where r is the number of rides. Note that it\'s impossible to rent two or more buses.Help JebTrains to calculate the minimum cost of the rent, required to get all employees to the feast, fulfilling all the conditions above." 1800.0                                      
          1249C1 "Good Numbers (easy version)" "brute force,greedy,implementation" "The only difference between easy and hard versions is the maximum value of n.You are given a positive integer number n. You really love good numbers so you want to find the smallest good number greater than or equal to n.The positive integer is called good if it can be represented as a sum of distinct powers of 3 (i.e. no duplicates of powers of 3 are allowed).For example:  30 is a good number: 30=33+31,  1 is a good number: 1=30,  12 is a good number: 12=32+31,  but 2 is not a good number: you can\'t represent it as a sum of distinct powers of 3 (2=30+30),  19 is not a good number: you can\'t represent it as a sum of distinct powers of 3 (for example, the representations 19=32+32+30=32+31+31+31+30 are invalid),  20 is also not a good number: you can\'t represent it as a sum of distinct powers of 3 (for example, the representation 20=32+32+30+30 is invalid). Note, that there exist other representations of 19 and 20 as sums of powers of 3 but none of them consists of distinct powers of 3.For the given positive integer n find such smallest m (n\xe2\x89\xa4m) that m is a good number.You have to answer q independent queries." 1300.0                                      
          1249A "Yet Another Dividing into Teams" math "You are a coach of a group consisting of n students. The i-th student has programming skill ai. All students have distinct programming skills. You want to divide them into teams in such a way that:  No two students i and j such that |ai\xe2\x88\x92aj|=1 belong to the same team (i.e. skills of each pair of students in the same team have the difference strictly greater than 1);  the number of teams is the minimum possible. You have to answer q independent queries." 800.0                                      
          1238D AB-string "binary search,combinatorics,dp,strings" "The string t1t2\xe2\x80\xa6tk is good if each letter of this string belongs to at least one palindrome of length greater than 1.A palindrome is a string that reads the same backward as forward. For example, the strings A, BAB, ABBA, BAABBBAAB are palindromes, but the strings AB, ABBBAA, BBBA are not.Here are some examples of good strings:   t = AABBB (letters t1, t2 belong to palindrome t1\xe2\x80\xa6t2 and letters t3, t4, t5 belong to palindrome t3\xe2\x80\xa6t5);  t = ABAA (letters t1, t2, t3 belong to palindrome t1\xe2\x80\xa6t3 and letter t4 belongs to palindrome t3\xe2\x80\xa6t4);  t = AAAAA (all letters belong to palindrome t1\xe2\x80\xa6t5); You are given a string s of length n, consisting of only letters A and B.You have to calculate the number of good substrings of string s." 1900.0                                      
          1237C2 "Balanced Removals (Harder)" "binary search,constructive algorithms,divide and conquer,greedy,implementation,sortings" "This is a harder version of the problem. In this version, n\xe2\x89\xa450000.There are n distinct points in three-dimensional space numbered from 1 to n. The i-th point has coordinates (xi,yi,zi). The number of points n is even.You\'d like to remove all n points using a sequence of n2 snaps. In one snap, you can remove any two points a and b that have not been removed yet and form a perfectly balanced pair. A pair of points a and b is perfectly balanced if no other point c (that has not been removed yet) lies within the axis-aligned minimum bounding box of points a and b.Formally, point c lies within the axis-aligned minimum bounding box of points a and b if and only if min(xa,xb)\xe2\x89\xa4xc\xe2\x89\xa4max(xa,xb), min(ya,yb)\xe2\x89\xa4yc\xe2\x89\xa4max(ya,yb), and min(za,zb)\xe2\x89\xa4zc\xe2\x89\xa4max(za,zb). Note that the bounding box might be degenerate. Find a way to remove all points in n2 snaps." 1900.0                                      
          1236B "Alice and the List of Presents" combinatorics,math "Alice got many presents these days. So she decided to pack them into boxes and send them to her friends.There are n kinds of presents. Presents of one kind are identical (i.e. there is no way to distinguish two gifts of the same kind). Presents of different kinds are different (i.e. that is, two gifts of different kinds are distinguishable). The number of presents of each kind, that Alice has is very big, so we can consider Alice has an infinite number of gifts of each kind.Also, there are m boxes. All of them are for different people, so they are pairwise distinct (consider that the names of m friends are written on the boxes). For example, putting the first kind of present into the first box but not into the second box, is different from putting the first kind of present into the second box but not into the first box.Alice wants to pack presents with the following rules:  She won\'t pack more than one present of each kind into the same box, so each box should contain presents of different kinds (i.e. each box contains a subset of n kinds, empty boxes are allowed);  For each kind at least one present should be packed into some box. Now Alice wants to know how many different ways to pack the presents exists. Please, help her and calculate this number. Since the answer can be huge, output it by modulo 109+7.See examples and their notes for clarification." 1500.0                                      
          1234C Pipes dp,implementation "You are given a system of pipes. It consists of two rows, each row consists of n pipes. The top left pipe has the coordinates (1,1) and the bottom right \xe2\x80\x94 (2,n).There are six types of pipes: two types of straight pipes and four types of curved pipes. Here are the examples of all six types:  Types of pipes You can turn each of the given pipes 90 degrees clockwise or counterclockwise arbitrary (possibly, zero) number of times (so the types 1 and 2 can become each other and types 3,4,5,6 can become each other).You want to turn some pipes in a way that the water flow can start at (1,0) (to the left of the top left pipe), move to the pipe at (1,1), flow somehow by connected pipes to the pipe at (2,n) and flow right to (2,n+1).Pipes are connected if they are adjacent in the system and their ends are connected. Here are examples of connected pipes:  Examples of connected pipes Let\'s describe the problem using some example:  The first example input And its solution is below:   The first example answer As you can see, the water flow is the poorly drawn blue line. To obtain the answer, we need to turn the pipe at (1,2) 90 degrees clockwise, the pipe at (2,3) 90 degrees, the pipe at (1,6) 90 degrees, the pipe at (1,7) 180 degrees and the pipe at (2,7) 180 degrees. Then the flow of water can reach (2,n+1) from (1,0).You have to answer q independent queries." 1500.0                                      
          1230B "Ania and Minimizing" greedy,implementation "Ania has a large integer S. Its decimal representation has length n and doesn\'t contain any leading zeroes. Ania is allowed to change at most k digits of S. She wants to do it in such a way that S still won\'t contain any leading zeroes and it\'ll be minimal possible. What integer will Ania finish with?" 1000.0                                      
          1227F1 "Wrong Answer on test 233 (Easy Version)" dp "Your program fails again. This time it gets ""Wrong answer on test 233"".This is the easier version of the problem. In this version 1\xe2\x89\xa4n\xe2\x89\xa42000. You can hack this problem only if you solve and lock both problems.The problem is about a test containing n one-choice-questions. Each of the questions contains k options, and only one of them is correct. The answer to the i-th question is hi, and if your answer of the question i is hi, you earn 1 point, otherwise, you earn 0 points for this question. The values h1,h2,\xe2\x80\xa6,hn are known to you in this problem.However, you have a mistake in your program. It moves the answer clockwise! Consider all the n answers are written in a circle. Due to the mistake in your program, they are shifted by one cyclically.Formally, the mistake moves the answer for the question i to the question imodn+1. So it moves the answer for the question 1 to question 2, the answer for the question 2 to the question 3, ..., the answer for the question n to the question 1.We call all the n answers together an answer suit. There are kn possible answer suits in total.You\'re wondering, how many answer suits satisfy the following condition: after moving clockwise by 1, the total number of points of the new answer suit is strictly larger than the number of points of the old one. You need to find the answer modulo 998244353.For example, if n=5, and your answer suit is a=[1,2,3,4,5], it will submitted as a\xe2\x80\xb2=[5,1,2,3,4] because of a mistake. If the correct answer suit is h=[5,2,2,3,4], the answer suit a earns 1 point and the answer suite a\xe2\x80\xb2 earns 4 points. Since 4>1, the answer suit a=[1,2,3,4,5] should be counted." 2200.0                                      
          1225G "To Make 1" "bitmasks,constructive algorithms,dp,greedy,number theory" "There are n positive integers written on the blackboard. Also, a positive number k\xe2\x89\xa52 is chosen, and none of the numbers on the blackboard are divisible by k. In one operation, you can choose any two integers x and y, erase them and write one extra number f(x+y), where f(x) is equal to x if x is not divisible by k, otherwise f(x)=f(x/k).In the end, there will be a single number of the blackboard. Is it possible to make the final number equal to 1? If so, restore any sequence of operations to do so." 3100.0                                      
          1225C p-binary "bitmasks,brute force,math" "Vasya will fancy any number as long as it is an integer power of two. Petya, on the other hand, is very conservative and only likes a single integer p (which may be positive, negative, or zero). To combine their tastes, they invented p-binary numbers of the form 2x+p, where x is a non-negative integer.For example, some \xe2\x88\x929-binary (""minus nine"" binary) numbers are: \xe2\x88\x928 (minus eight), 7 and 1015 (\xe2\x88\x928=20\xe2\x88\x929, 7=24\xe2\x88\x929, 1015=210\xe2\x88\x929).The boys now use p-binary numbers to represent everything. They now face a problem: given a positive integer n, what\'s the smallest number of p-binary numbers (not necessarily distinct) they need to represent n as their sum? It may be possible that representation is impossible altogether. Help them solve this problem.For example, if p=0 we can represent 7 as 20+21+22.And if p=\xe2\x88\x929 we can represent 7 as one number (24\xe2\x88\x929).Note that negative p-binary numbers are allowed to be in the sum (see the Notes section for an example)." 1600.0                                      
          1223D "Sequence Sorting" "dp,greedy,two pointers" "You are given a sequence a1,a2,\xe2\x80\xa6,an, consisting of integers.You can apply the following operation to this sequence: choose some integer x and move all elements equal to x either to the beginning, or to the end of a. Note that you have to move all these elements in one direction in one operation.For example, if a=[2,1,3,1,1,3,2], you can get the following sequences in one operation (for convenience, denote elements equal to x as x-elements):   [1,1,1,2,3,3,2] if you move all 1-elements to the beginning;  [2,3,3,2,1,1,1] if you move all 1-elements to the end;  [2,2,1,3,1,1,3] if you move all 2-elements to the beginning;  [1,3,1,1,3,2,2] if you move all 2-elements to the end;  [3,3,2,1,1,1,2] if you move all 3-elements to the beginning;  [2,1,1,1,2,3,3] if you move all 3-elements to the end; You have to determine the minimum number of such operations so that the sequence a becomes sorted in non-descending order. Non-descending order means that for all i from 2 to n, the condition ai\xe2\x88\x921\xe2\x89\xa4ai is satisfied.Note that you have to answer q independent queries." 2000.0                                      
          1221F "Choose a Square" "binary search,data structures,sortings" "Petya recently found a game ""Choose a Square"". In this game, there are n points numbered from 1 to n on an infinite field. The i-th point has coordinates (xi,yi) and cost ci.You have to choose a square such that its sides are parallel to coordinate axes, the lower left and upper right corners belong to the line y=x, and all corners have integer coordinates.The score you get is the sum of costs of the points covered by the selected square minus the length of the side of the square. Note that the length of the side can be zero.Petya asks you to calculate the maximum possible score in the game that can be achieved by placing exactly one square." 2400.0                                      
          1221B Knights "constructive algorithms,greedy" "You are given a chess board with n rows and n columns. Initially all cells of the board are empty, and you have to put a white or a black knight into each cell of the board.A knight is a chess piece that can attack a piece in cell (x2, y2) from the cell (x1, y1) if one of the following conditions is met:  |x1\xe2\x88\x92x2|=2 and |y1\xe2\x88\x92y2|=1, or  |x1\xe2\x88\x92x2|=1 and |y1\xe2\x88\x92y2|=2. Here are some examples of which cells knight can attack. In each of the following pictures, if the knight is currently in the blue cell, it can attack all red cells (and only them).  A duel of knights is a pair of knights of different colors such that these knights attack each other. You have to put a knight (a white one or a black one) into each cell in such a way that the number of duels is maximum possible." 1100.0                                      
          1219C "Periodic integer number" implementation,strings "Alice became interested in periods of integer numbers. We say positive X integer number is periodic with length L if there exists positive integer number P with L digits such that X can be written as PPPP\xe2\x80\xa6P. For example:X=123123123 is periodic number with length L=3 and L=9X=42424242 is periodic number with length L=2,L=4 and L=8X=12345 is periodic number with length L=5For given positive period length L and positive integer number A, Alice wants to find smallest integer number X strictly greater than A that is periodic with length L." 1700.0                                      
          1218H "Function Composition" "dfs and similar" "We are definitely not going to bother you with another generic story when Alice finds about an array or when Alice and Bob play some stupid game. This time you\'ll get a simple, plain text.First, let us define several things. We define function F on the array A such that F(i,1)=A[i] and F(i,m)=A[F(i,m\xe2\x88\x921)] for m>1. In other words, value F(i,m) represents composition A[...A[i]] applied m times.You are given an array of length N with non-negative integers. You are expected to give an answer on Q queries. Each query consists of two numbers \xe2\x80\x93 m and y. For each query determine how many x exist such that F(x,m)=y." 2900.0                                      
          1218D "Xor Spanning Tree" "divide and conquer,fft,graphs" "In the galaxy far far away is the ancient interplanetary republic of Bubbleland, consisting of N planets. Between them, there are M bidirectional wormholes, each connecting a pair of planets. Bubbleland is a very centralized republic, having a capital planet Whiteplanet, from which any another planet can be reached using these wormholes. It is also guaranteed that no wormhole connects planet to itself and that no two different wormholes connect same pair of planets. We call a path that begins at one planet, visits other planets and each of them at most once and returns to starting point a tour. Interplanetary Safety Regulations guarantee that each planet belongs to at most one tour and that there are at most 42 tours.After many eons of usage, wormholes need to be repaired and each wormhole has the cost Wi which needs to be payed for reparation. Unfortunately, the Senate of Bubbleland is short on budget. Therefore, they have decided only to fix as many wormholes as they need in order to have all planets reachable from capital and to pay as little money as they have to for this repair. However the way in which the Senate calculates the cost is different. Cost of the set of reparations is binary xor of costs of each individual reparation, that is if reparations to be made have costs A1,A2,...,Ak, the cost of entire set is A1\xe2\x8a\x95A2\xe2\x8a\x95...\xe2\x8a\x95Ak.Now the Senate would like to know how much money do they have to pay and also the number of different ways to achieve that cost modulo 1000000007." 2400.0                                      
          1217D "Coloring Edges" "constructive algorithms,dfs and similar,graphs" "You are given a directed graph with n vertices and m directed edges without self-loops or multiple edges.Let\'s denote the k-coloring of a digraph as following: you color each edge in one of k colors. The k-coloring is good if and only if there no cycle formed by edges of same color.Find a good k-coloring of given digraph with minimum possible k." 2100.0                                      
          1216E2 "Numerical Sequence (hard version)" "binary search,math" "The only difference between the easy and the hard versions is the maximum value of k.You are given an infinite sequence of form ""112123123412345\xe2\x80\xa6"" which consist of blocks of all consecutive positive integers written one after another. The first block consists of all numbers from 1 to 1, the second one \xe2\x80\x94 from 1 to 2, the third one \xe2\x80\x94 from 1 to 3, \xe2\x80\xa6, the i-th block consists of all numbers from 1 to i. So the first 56 elements of the sequence are ""11212312341234512345612345671234567812345678912345678910"". Elements of the sequence are numbered from one. For example, the 1-st element of the sequence is 1, the 3-rd element of the sequence is 2, the 20-th element of the sequence is 5, the 38-th element is 2, the 56-th element of the sequence is 0.Your task is to answer q independent queries. In the i-th query you are given one integer ki. Calculate the digit at the position ki of the sequence." 2200.0                                      
          1216C "White Sheet" geometry,math "There is a white sheet of paper lying on a rectangle table. The sheet is a rectangle with its sides parallel to the sides of the table. If you will take a look from above and assume that the bottom left corner of the table has coordinates (0,0), and coordinate axes are left and bottom sides of the table, then the bottom left corner of the white sheet has coordinates (x1,y1), and the top right \xe2\x80\x94 (x2,y2).After that two black sheets of paper are placed on the table. Sides of both black sheets are also parallel to the sides of the table. Coordinates of the bottom left corner of the first black sheet are (x3,y3), and the top right \xe2\x80\x94 (x4,y4). Coordinates of the bottom left corner of the second black sheet are (x5,y5), and the top right \xe2\x80\x94 (x6,y6).   Example of three rectangles. Determine if some part of the white sheet can be seen from the above after the two black sheets are placed. The part of the white sheet can be seen if there is at least one point lying not strictly inside the white sheet and strictly outside of both black sheets." 1700.0                                      
          1216A Prefixes strings "Nikolay got a string s of even length n, which consists only of lowercase Latin letters \'a\' and \'b\'. Its positions are numbered from 1 to n.He wants to modify his string so that every its prefix of even length has an equal amount of letters \'a\' and \'b\'. To achieve that, Nikolay can perform the following operation arbitrary number of times (possibly, zero): choose some position in his string and replace the letter on this position with the other letter (i.e. replace \'a\' with \'b\' or replace \'b\' with \'a\'). Nikolay can use no letters except \'a\' and \'b\'.The prefix of string s of length l (1\xe2\x89\xa4l\xe2\x89\xa4n) is a string s[1..l].For example, for the string s=""abba"" there are two prefixes of the even length. The first is s[1\xe2\x80\xa62]=""ab"" and the second s[1\xe2\x80\xa64]=""abba"". Both of them have the same number of \'a\' and \'b\'.Your task is to calculate the minimum number of operations Nikolay has to perform with the string s to modify it so that every its prefix of even length has an equal amount of letters \'a\' and \'b\'." 800.0                                      
          1215F "Radio Stations" 2-sat "In addition to complaints about lighting, a lot of complaints about insufficient radio signal covering has been received by Bertown city hall recently. n complaints were sent to the mayor, all of which are suspiciosly similar to each other: in the i-th complaint, one of the radio fans has mentioned that the signals of two radio stations xi and yi are not covering some parts of the city, and demanded that the signal of at least one of these stations can be received in the whole city.Of cousre, the mayor of Bertown is currently working to satisfy these complaints. A new radio tower has been installed in Bertown, it can transmit a signal with any integer power from 1 to M (let\'s denote the signal power as f). The mayor has decided that he will choose a set of radio stations and establish a contract with every chosen station. To establish a contract with the i-th station, the following conditions should be met:  the signal power f should be not less than li, otherwise the signal of the i-th station won\'t cover the whole city;  the signal power f should be not greater than ri, otherwise the signal will be received by the residents of other towns which haven\'t established a contract with the i-th station. All this information was already enough for the mayor to realise that choosing the stations is hard. But after consulting with specialists, he learned that some stations the signals of some stations may interfere with each other: there are m pairs of stations (ui, vi) that use the same signal frequencies, and for each such pair it is impossible to establish contracts with both stations. If stations x and y use the same frequencies, and y and z use the same frequencies, it does not imply that x and z use the same frequencies.The mayor finds it really hard to analyze this situation, so he hired you to help him. You have to choose signal power f and a set of stations to establish contracts with such that:  all complaints are satisfied (formally, for every i\xe2\x88\x88[1,n] the city establishes a contract either with station xi, or with station yi);  no two chosen stations interfere with each other (formally, for every i\xe2\x88\x88[1,m] the city does not establish a contract either with station ui, or with station vi);  for each chosen station, the conditions on signal power are met (formally, for each chosen station i the condition li\xe2\x89\xa4f\xe2\x89\xa4ri is met)." 2700.0                                      
          1215A "Yellow Cards" greedy,implementation,math "The final match of the Berland Football Cup has been held recently. The referee has shown n yellow cards throughout the match. At the beginning of the match there were a1 players in the first team and a2 players in the second team.The rules of sending players off the game are a bit different in Berland football. If a player from the first team receives k1 yellow cards throughout the match, he can no longer participate in the match \xe2\x80\x94 he\'s sent off. And if a player from the second team receives k2 yellow cards, he\'s sent off. After a player leaves the match, he can no longer receive any yellow cards. Each of n yellow cards was shown to exactly one player. Even if all players from one team (or even from both teams) leave the match, the game still continues.The referee has lost his records on who has received each yellow card. Help him to determine the minimum and the maximum number of players that could have been thrown out of the game." 1000.0                                      
          1210A "Anadi and Domino" "brute force,graphs" "Anadi has a set of dominoes. Every domino has two parts, and each part contains some dots. For every aa and bb such that 1\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa461\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa46, there is exactly one domino with aa dots on one half and bb dots on the other half. The set contains exactly 2121 dominoes. Here is an exact illustration of his set:  Also, Anadi has an undirected graph without self-loops and multiple edges. He wants to choose some dominoes and place them on the edges of this graph. He can use at most one domino of each type. Each edge can fit at most one domino. It\'s not necessary to place a domino on each edge of the graph.When placing a domino on an edge, he also chooses its direction. In other words, one half of any placed domino must be directed toward one of the endpoints of the edge and the other half must be directed toward the other endpoint. There\'s a catch: if there are multiple halves of dominoes directed toward the same vertex, each of these halves must contain the same number of dots.How many dominoes at most can Anadi place on the edges of his graph?" 1700.0                                      
          1209G1 "Into Blocks (easy version)" "data structures,dsu,greedy,implementation,two pointers" "This is an easier version of the next problem. In this version, q=0.A sequence of integers is called nice if its elements are arranged in blocks like in [3,3,3,4,1,1]. Formally, if two elements are equal, everything in between must also be equal.Let\'s define difficulty of a sequence as a minimum possible number of elements to change to get a nice sequence. However, if you change at least one element of value x to value y, you must also change all other elements of value x into y as well. For example, for [3,3,1,3,2,1,2] it isn\'t allowed to change first 1 to 3 and second 1 to 2. You need to leave 1\'s untouched or change them to the same value.You are given a sequence of integers a1,a2,\xe2\x80\xa6,an and q updates.Each update is of form ""i x"" \xe2\x80\x94 change ai to x. Updates are not independent (the change stays for the future).Print the difficulty of the initial sequence and of the sequence after every update." 2000.0                                      
          1209E2 "Rotate Columns (hard version)" bitmasks,dp,greedy,sortings "This is a harder version of the problem. The difference is only in constraints.You are given a rectangular n\xc3\x97m matrix a. In one move you can choose any column and cyclically shift elements in this column. You can perform this operation as many times as you want (possibly zero). You can perform this operation to a column multiple times.After you are done with cyclical shifts, you compute for every row the maximal value in it. Suppose that for i-th row it is equal ri. What is the maximal possible value of r1+r2+\xe2\x80\xa6+rn?" 2500.0                                      
          1207E "XOR Guessing" bitmasks,interactive,math "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.The jury picked an integer x not less than 0 and not greater than 214\xe2\x88\x921. You have to guess this integer.To do so, you may ask no more than 2 queries. Each query should consist of 100 integer numbers a1, a2, ..., a100 (each integer should be not less than 0 and not greater than 214\xe2\x88\x921). In response to your query, the jury will pick one integer i (1\xe2\x89\xa4i\xe2\x89\xa4100) and tell you the value of ai\xe2\x8a\x95x (the bitwise XOR of ai and x). There is an additional constraint on the queries: all 200 integers you use in the queries should be distinct.It is guaranteed that the value of x is fixed beforehand in each test, but the choice of i in every query may depend on the integers you send." 1900.0                                      
          1207B "Square Filling" "constructive algorithms,greedy,implementation" "You are given two matrices A and B. Each matrix contains exactly n rows and m columns. Each element of A is either 0 or 1; each element of B is initially 0.You may perform some operations with matrix B. During each operation, you choose any submatrix of B having size 2\xc3\x972, and replace every element in the chosen submatrix with 1. In other words, you choose two integers x and y such that 1\xe2\x89\xa4x<n and 1\xe2\x89\xa4y<m, and then set Bx,y, Bx,y+1, Bx+1,y and Bx+1,y+1 to 1.Your goal is to make matrix B equal to matrix A. Two matrices A and B are equal if and only if every element of matrix A is equal to the corresponding element of matrix B.Is it possible to make these matrices equal? If it is, you have to come up with a sequence of operations that makes B equal to A. Note that you don\'t have to minimize the number of operations." 1200.0                                      
          1203D1 "Remove the Substring (easy version)" greedy,implementation "The only difference between easy and hard versions is the length of the string.You are given a string s and a string t, both consisting only of lowercase Latin letters. It is guaranteed that t can be obtained from s by removing some (possibly, zero) number of characters (not necessary contiguous) from s without changing order of remaining characters (in other words, it is guaranteed that t is a subsequence of s).For example, the strings ""test"", ""tst"", ""tt"", ""et"" and """" are subsequences of the string ""test"". But the strings ""tset"", ""se"", ""contest"" are not subsequences of the string ""test"".You want to remove some substring (contiguous subsequence) from s of maximum possible length such that after removing this substring t will remain a subsequence of s.If you want to remove the substring s[l;r] then the string s will be transformed to s1s2\xe2\x80\xa6sl\xe2\x88\x921sr+1sr+2\xe2\x80\xa6s|s|\xe2\x88\x921s|s| (where |s| is the length of s).Your task is to find the maximum possible length of the substring you can remove so that t is still a subsequence of s." 1600.0                                      
          1200D "White Lines" "brute force,data structures,dp,implementation,two pointers" "Gildong has bought a famous painting software cfpaint. The working screen of cfpaint is square-shaped consisting of n rows and n columns of square cells. The rows are numbered from 1 to n, from top to bottom, and the columns are numbered from 1 to n, from left to right. The position of a cell at row r and column c is represented as (r,c). There are only two colors for the cells in cfpaint \xe2\x80\x94 black and white.There is a tool named eraser in cfpaint. The eraser has an integer size k (1\xe2\x89\xa4k\xe2\x89\xa4n). To use the eraser, Gildong needs to click on a cell (i,j) where 1\xe2\x89\xa4i,j\xe2\x89\xa4n\xe2\x88\x92k+1. When a cell (i,j) is clicked, all of the cells (i\xe2\x80\xb2,j\xe2\x80\xb2) where i\xe2\x89\xa4i\xe2\x80\xb2\xe2\x89\xa4i+k\xe2\x88\x921 and j\xe2\x89\xa4j\xe2\x80\xb2\xe2\x89\xa4j+k\xe2\x88\x921 become white. In other words, a square with side equal to k cells and top left corner at (i,j) is colored white.A white line is a row or a column without any black cells.Gildong has worked with cfpaint for some time, so some of the cells (possibly zero or all) are currently black. He wants to know the maximum number of white lines after using the eraser exactly once. Help Gildong find the answer to his question." 1900.0                                      
          1200B "Block Adventure" dp,greedy "Gildong is playing a video game called Block Adventure. In Block Adventure, there are n columns of blocks in a row, and the columns are numbered from 1 to n. All blocks have equal heights. The height of the i-th column is represented as hi, which is the number of blocks stacked in the i-th column.Gildong plays the game as a character that can stand only on the top of the columns. At the beginning, the character is standing on the top of the 1-st column. The goal of the game is to move the character to the top of the n-th column.The character also has a bag that can hold infinitely many blocks. When the character is on the top of the i-th column, Gildong can take one of the following three actions as many times as he wants:   if there is at least one block on the column, remove one block from the top of the i-th column and put it in the bag;  if there is at least one block in the bag, take one block out of the bag and place it on the top of the i-th column;  if i<n and |hi\xe2\x88\x92hi+1|\xe2\x89\xa4k, move the character to the top of the i+1-st column. k is a non-negative integer given at the beginning of the game. Note that it is only possible to move to the next column. In actions of the first two types the character remains in the i-th column, and the value hi changes.The character initially has m blocks in the bag. Gildong wants to know if it is possible to win the game. Help Gildong find the answer to his question." 1200.0                                      
          1198D "Rectangle Painting 1" dp "There is a square grid of size n\xc3\x97n. Some cells are colored in black, all others are colored in white. In one operation you can select some rectangle and color all its cells in white. It costs max(h,w) to color a rectangle of size h\xc3\x97w. You are to make all cells white for minimum total cost." 2300.0                                      
          1198B "Welfare State" "binary search,brute force,data structures,sortings" "There is a country with n citizens. The i-th of them initially has ai money. The government strictly controls the wealth of its citizens. Whenever a citizen makes a purchase or earns some money, they must send a receipt to the social services mentioning the amount of money they currently have.Sometimes the government makes payouts to the poor: all citizens who have strictly less money than x are paid accordingly so that after the payout they have exactly x money. In this case the citizens don\'t send a receipt.You know the initial wealth of every citizen and the log of all events: receipts and payouts. Restore the amount of money each citizen has after all events." 1600.0                                      
          1196D1 "RGB Substring (easy version)" implementation "The only difference between easy and hard versions is the size of the input.You are given a string s consisting of n characters, each character is \'R\', \'G\' or \'B\'.You are also given an integer k. Your task is to change the minimum number of characters in the initial string s so that after the changes there will be a string of length k that is a substring of s, and is also a substring of the infinite string ""RGBRGBRGB ..."".A string a is a substring of string b if there exists a positive integer i such that a1=bi, a2=bi+1, a3=bi+2, ..., a|a|=bi+|a|\xe2\x88\x921. For example, strings ""GBRG"", ""B"", ""BR"" are substrings of the infinite string ""RGBRGBRGB ..."" while ""GR"", ""RGR"" and ""GGG"" are not.You have to answer q independent queries." 1500.0                                      
          1195D2 "Submarine in the Rybinsk Sea (hard edition)" "combinatorics,math,number theory" "This problem differs from the previous one only in the absence of the constraint on the equal length of all numbers a1,a2,\xe2\x80\xa6,an.A team of SIS students is going to make a trip on a submarine. Their target is an ancient treasure in a sunken ship lying on the bottom of the Great Rybinsk sea. Unfortunately, the students don\'t know the coordinates of the ship, so they asked Meshanya (who is a hereditary mage) to help them. He agreed to help them, but only if they solve his problem.Let\'s denote a function that alternates digits of two numbers f(a1a2\xe2\x80\xa6ap\xe2\x88\x921ap,b1b2\xe2\x80\xa6bq\xe2\x88\x921bq), where a1\xe2\x80\xa6ap and b1\xe2\x80\xa6bq are digits of two integers written in the decimal notation without leading zeros.In other words, the function f(x,y) alternately shuffles the digits of the numbers x and y by writing them from the lowest digits to the older ones, starting with the number y. The result of the function is also built from right to left (that is, from the lower digits to the older ones). If the digits of one of the arguments have ended, then the remaining digits of the other argument are written out. Familiarize with examples and formal definitions of the function below.For example: f(1111,2222)=12121212 f(7777,888)=7787878 f(33,44444)=4443434 f(555,6)=5556 f(111,2222)=2121212Formally,  if p\xe2\x89\xa5q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=a1a2\xe2\x80\xa6ap\xe2\x88\x92q+1b1ap\xe2\x88\x92q+2b2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq;  if p<q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=b1b2\xe2\x80\xa6bq\xe2\x88\x92pa1bq\xe2\x88\x92p+1a2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq. Mishanya gives you an array consisting of n integers ai, your task is to help students to calculate \xe2\x88\x91ni=1\xe2\x88\x91nj=1f(ai,aj) modulo 998244353." 1800.0                                      
          1195D1 "Submarine in the Rybinsk Sea (easy edition)" "combinatorics,math,number theory" "This problem differs from the next one only in the presence of the constraint on the equal length of all numbers a1,a2,\xe2\x80\xa6,an. Actually, this problem is a subtask of the problem D2 from the same contest and the solution of D2 solves this subtask too.A team of SIS students is going to make a trip on a submarine. Their target is an ancient treasure in a sunken ship lying on the bottom of the Great Rybinsk sea. Unfortunately, the students don\'t know the coordinates of the ship, so they asked Meshanya (who is a hereditary mage) to help them. He agreed to help them, but only if they solve his problem.Let\'s denote a function that alternates digits of two numbers f(a1a2\xe2\x80\xa6ap\xe2\x88\x921ap,b1b2\xe2\x80\xa6bq\xe2\x88\x921bq), where a1\xe2\x80\xa6ap and b1\xe2\x80\xa6bq are digits of two integers written in the decimal notation without leading zeros.In other words, the function f(x,y) alternately shuffles the digits of the numbers x and y by writing them from the lowest digits to the older ones, starting with the number y. The result of the function is also built from right to left (that is, from the lower digits to the older ones). If the digits of one of the arguments have ended, then the remaining digits of the other argument are written out. Familiarize with examples and formal definitions of the function below.For example: f(1111,2222)=12121212 f(7777,888)=7787878 f(33,44444)=4443434 f(555,6)=5556 f(111,2222)=2121212Formally,  if p\xe2\x89\xa5q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=a1a2\xe2\x80\xa6ap\xe2\x88\x92q+1b1ap\xe2\x88\x92q+2b2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq;  if p<q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=b1b2\xe2\x80\xa6bq\xe2\x88\x92pa1bq\xe2\x88\x92p+1a2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq. Mishanya gives you an array consisting of n integers ai. All numbers in this array are of equal length (that is, they consist of the same number of digits). Your task is to help students to calculate \xe2\x88\x91ni=1\xe2\x88\x91nj=1f(ai,aj) modulo 998244353." 1500.0                                      
          1192A "Building Skyscrapers" "*special problem" "We are going to build a new city: the Metropolis. The city is going to be built on an infinite square grid. The finished city will consist of n skyscrapers, each occupying a different cell of the grid. At any moment during the construction, the cells that currently do not contain a skyscraper are called empty.You are given the planned coordinates of the n skyscrapers. Your task is to find an order in which they can be built while satisfying the rules listed below.  The building crew has only one crane, so the Metropolis has to be constructed one skyscraper at a time.  The first skyscraper can be built anywhere on the grid.  Each subsequent skyscraper has to share a side or a corner with at least one of the previously built skyscrapers (so that it\'s easier to align the new skyscraper to the grid properly).  When building a skyscraper, there has to be a way to deliver material to the construction site from the outside of Metropolis by only moving it through empty cells that share a side. In other words, there should be a path of side-adjacent empty cells that connects the cell that will contain the skyscraper to some cell (r,c) with |r|>109 and/or |c|>109. If a solution exists, let\'s denote the numbers of skyscrapers in the order in which they should be built by s1,\xe2\x80\xa6,sn. There are two types of subtasks:Type 1: You may produce any valid order.Type 2: You must find the order that maximizes sn. Among those, you must find the one that maximizes sn\xe2\x88\x921. And so on. In other words, you must find the valid order of building for which the sequence (sn,sn\xe2\x88\x921,\xe2\x80\xa6,s1) is lexicographically largest." -999.0                                      
          1189A "Keanu Reeves" strings "After playing Neo in the legendary ""Matrix"" trilogy, Keanu Reeves started doubting himself: maybe we really live in virtual reality? To find if this is true, he needs to solve the following problem.Let\'s call a string consisting of only zeroes and ones good if it contains different numbers of zeroes and ones. For example, 1, 101, 0000 are good, while 01, 1001, and 111000 are not good.We are given a string s of length n consisting of only zeroes and ones. We need to cut s into minimal possible number of substrings s1,s2,\xe2\x80\xa6,sk such that all of them are good. More formally, we have to find minimal by number of strings sequence of good strings s1,s2,\xe2\x80\xa6,sk such that their concatenation (joining) equals s, i.e. s1+s2+\xe2\x8b\xaf+sk=s.For example, cuttings 110010 into 110 and 010 or into 11 and 0010 are valid, as 110, 010, 11, 0010 are all good, and we can\'t cut 110010 to the smaller number of substrings as 110010 isn\'t good itself. At the same time, cutting of 110010 into 1100 and 10 isn\'t valid as both strings aren\'t good. Also, cutting of 110010 into 1, 1, 0010 isn\'t valid, as it isn\'t minimal, even though all 3 strings are good.Can you help Keanu? We can show that the solution always exists. If there are multiple optimal answers, print any." 800.0                                      
          1188A1 "Add on a Tree" trees "Note that this is the first problem of the two similar problems. You can hack this problem only if you solve both problems.You are given a tree with n nodes. In the beginning, 0 is written on all edges. In one operation, you can choose any 2 distinct leaves u, v and any real number x and add x to values written on all edges on the simple path between u and v.For example, on the picture below you can see the result of applying two operations to the graph: adding 2 on the path from 7 to 6, and then adding \xe2\x88\x920.5 on the path from 4 to 5.   Is it true that for any configuration of real numbers written on edges, we can achieve it with a finite number of operations?Leaf is a node of a tree of degree 1. Simple path is a path that doesn\'t contain any node twice." 1600.0                                      
          1187F "Expected Square Beauty" dp,math,probabilities "Let x be an array of integers x=[x1,x2,\xe2\x80\xa6,xn]. Let\'s define B(x) as a minimal size of a partition of x into subsegments such that all elements in each subsegment are equal. For example, B([3,3,6,1,6,6,6])=4 using next partition: [3,3 | 6 | 1 | 6,6,6].Now you don\'t have any exact values of x, but you know that xi can be any integer value from [li,ri] (li\xe2\x89\xa4ri) uniformly at random. All xi are independent.Calculate expected value of (B(x))2, or E((B(x))2). It\'s guaranteed that the expected value can be represented as rational fraction PQ where (P,Q)=1, so print the value P\xe2\x8b\x85Q\xe2\x88\x921mod109+7." 2500.0                                      
          1185B "Email from Polycarp" implementation,strings "Methodius received an email from his friend Polycarp. However, Polycarp\'s keyboard is broken, so pressing a key on it once may cause the corresponding symbol to appear more than once (if you press a key on a regular keyboard, it prints exactly one symbol).For example, as a result of typing the word ""hello"", the following words could be printed: ""hello"", ""hhhhello"", ""hheeeellllooo"", but the following could not be printed: ""hell"", ""helo"", ""hhllllooo"".Note, that when you press a key, the corresponding symbol must appear (possibly, more than once). The keyboard is broken in a random manner, it means that pressing the same key you can get the different number of letters in the result.For each word in the letter, Methodius has guessed what word Polycarp actually wanted to write, but he is not sure about it, so he asks you to help him.You are given a list of pairs of words. For each pair, determine if the second word could be printed by typing the first one on Polycarp\'s keyboard." 1200.0                                      
          1185A Ropewalkers math "Polycarp decided to relax on his weekend and visited to the performance of famous ropewalkers: Agafon, Boniface and Konrad.The rope is straight and infinite in both directions. At the beginning of the performance, Agafon, Boniface and Konrad are located in positions a, b and c respectively. At the end of the performance, the distance between each pair of ropewalkers was at least d.Ropewalkers can walk on the rope. In one second, only one ropewalker can change his position. Every ropewalker can change his position exactly by 1 (i. e. shift by 1 to the left or right direction on the rope). Agafon, Boniface and Konrad can not move at the same time (Only one of them can move at each moment). Ropewalkers can be at the same positions at the same time and can ""walk past each other"".You should find the minimum duration (in seconds) of the performance. In other words, find the minimum number of seconds needed so that the distance between each pair of ropewalkers can be greater or equal to d.Ropewalkers can walk to negative coordinates, due to the rope is infinite to both sides." 800.0                                      
          1184C1 "Heidi and the Turing Test (Easy)" implementation "The Cybermen and the Daleks have long been the Doctor\'s main enemies. Everyone knows that both these species enjoy destroying everything they encounter. However, a little-known fact about them is that they both also love taking Turing tests!Heidi designed a series of increasingly difficult tasks for them to spend their time on, which would allow the Doctor enough time to save innocent lives!The funny part is that these tasks would be very easy for a human to solve.The first task is as follows. There are some points on the plane. All but one of them are on the boundary of an axis-aligned square (its sides are parallel to the axes). Identify that point." 1600.0                                      
          1184A3 "Heidi Learns Hashing (Hard)" "fft,math,number theory" "Now Heidi is ready to crack Madame Kovarian\'s hashing function.Madame Kovarian has a very strict set of rules for name changes. Two names can be interchanged only if using the following hashing function on them results in a collision. However, the hashing function is parametrized, so one can always find a set of parameters that causes such a collision. Heidi decided to exploit this to her advantage.Given two strings w1, w2 of equal length n consisting of lowercase English letters and an integer m.Consider the standard polynomial hashing function:Hp(w):=(\xe2\x88\x91|w|\xe2\x88\x921i=0wiri)mod(p)where p is some prime, and r is some number such that 2\xe2\x89\xa4r\xe2\x89\xa4p\xe2\x88\x922.The goal is to find r and a prime p (m\xe2\x89\xa4p\xe2\x89\xa4109) such that Hp(w1)=Hp(w2).Strings w1 and w2 are sampled independently at random from all strings of length n over lowercase English letters." 3100.0                                      
          1183A "Nearest Interesting Number" implementation "Polycarp knows that if the sum of the digits of a number is divisible by 3, then the number itself is divisible by 3. He assumes that the numbers, the sum of the digits of which is divisible by 4, are also somewhat interesting. Thus, he considers a positive integer n interesting if its sum of digits is divisible by 4.Help Polycarp find the nearest larger or equal interesting number for the given number a. That is, find the interesting number n such that n\xe2\x89\xa5a and n is minimal." 800.0                                      
          1181B "Split a Number" greedy,implementation,strings "Dima worked all day and wrote down on a long paper strip his favorite number n consisting of l digits. Unfortunately, the strip turned out to be so long that it didn\'t fit in the Dima\'s bookshelf.To solve the issue, Dima decided to split the strip into two non-empty parts so that each of them contains a positive integer without leading zeros. After that he will compute the sum of the two integers and write it down on a new strip.Dima wants the resulting integer to be as small as possible, because it increases the chances that the sum will fit it in the bookshelf. Help Dima decide what is the minimum sum he can obtain." 1500.0                                      
          1180A "Alex and a Rhombus" dp,implementation,math "While playing with geometric figures Alex has accidentally invented a concept of a n-th order rhombus in a cell grid.A 1-st order rhombus is just a square 1\xc3\x971 (i.e just a cell).A n-th order rhombus for all n\xe2\x89\xa52 one obtains from a n\xe2\x88\x921-th order rhombus adding all cells which have a common side with it to it (look at the picture to understand it better).  Alex asks you to compute the number of cells in a n-th order rhombus." 800.0                                      
          1174F "Ehab and the Big Finale" "constructive algorithms,divide and conquer,graphs,implementation,interactive,trees" "This is an interactive problem.You\'re given a tree consisting of n nodes, rooted at node 1. A tree is a connected graph with no cycles.We chose a hidden node x. In order to find this node, you can ask queries of two types:   d u (1\xe2\x89\xa4u\xe2\x89\xa4n). We will answer with the distance between nodes u and x. The distance between two nodes is the number of edges in the shortest path between them.  s u (1\xe2\x89\xa4u\xe2\x89\xa4n). We will answer with the second node on the path from u to x. However, there\'s a plot twist. If u is not an ancestor of x, you\'ll receive ""Wrong answer"" verdict! Node a is called an ancestor of node b if a\xe2\x89\xa0b and the shortest path from node 1 to node b passes through node a. Note that in this problem a node is not an ancestor of itself.Can you find x in no more than 36 queries? The hidden node is fixed in each test beforehand and does not depend on your queries." 2400.0                                      
          1169B Pairs graphs,implementation "Toad Ivan has m pairs of integers, each integer is between 1 and n, inclusive. The pairs are (a1,b1),(a2,b2),\xe2\x80\xa6,(am,bm). He asks you to check if there exist two integers x and y (1\xe2\x89\xa4x<y\xe2\x89\xa4n) such that in each given pair at least one integer is equal to x or y." 1500.0                                      
          1168C "And Reachability" bitmasks,dp "Toad Pimple has an array of integers a1,a2,\xe2\x80\xa6,an.We say that y is reachable from x if x<y and there exists an integer array p such that x=p1<p2<\xe2\x80\xa6<pk=y, and api&api+1>0 for all integers i such that 1\xe2\x89\xa4i<k.Here & denotes the bitwise AND operation.You are given q pairs of indices, check reachability for each of them." 2200.0                                      
          1168B "Good Triple" "brute force,two pointers" "Toad Rash has a binary string s. A binary string consists only of zeros and ones.Let n be the length of s.Rash needs to find the number of such pairs of integers l, r that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and there is at least one pair of integers x, k such that 1\xe2\x89\xa4x,k\xe2\x89\xa4n, l\xe2\x89\xa4x<x+2k\xe2\x89\xa4r, and sx=sx+k=sx+2k.Find this number of pairs for Rash." 1900.0                                      
          1154G "Minimum Possible LCM" "brute force,greedy,math,number theory" "You are given an array a consisting of n integers a1,a2,\xe2\x80\xa6,an.Your problem is to find such pair of indices i,j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) that lcm(ai,aj) is minimum possible.lcm(x,y) is the least common multiple of x and y (minimum positive number such that both x and y are divisors of this number)." 2200.0                                      
          1152C "Neko does Maths" "brute force,math,number theory" "Neko loves divisors. During the latest number theory lesson, he got an interesting exercise from his math teacher.Neko has two integers a and b. His goal is to find a non-negative integer k such that the least common multiple of a+k and b+k is the smallest possible. If there are multiple optimal integers k, he needs to choose the smallest one.Given his mathematical talent, Neko had no trouble getting Wrong Answer on this problem. Can you help him solve it?" 1800.0                                      
          1152B "Neko Performs Cat Furrier Transform" "bitmasks,constructive algorithms,dfs and similar,math" "Cat Furrier Transform is a popular algorithm among cat programmers to create longcats. As one of the greatest cat programmers ever exist, Neko wants to utilize this algorithm to create the perfect longcat.Assume that we have a cat with a number x. A perfect longcat is a cat with a number equal 2m\xe2\x88\x921 for some non-negative integer m. For example, the numbers 0, 1, 3, 7, 15 and so on are suitable for the perfect longcats.In the Cat Furrier Transform, the following operations can be performed on x:  (Operation A): you select any non-negative integer n and replace x with x\xe2\x8a\x95(2n\xe2\x88\x921), with \xe2\x8a\x95 being a bitwise XOR operator. (Operation B): replace x with x+1. The first applied operation must be of type A, the second of type B, the third of type A again, and so on. Formally, if we number operations from one in the order they are executed, then odd-numbered operations must be of type A and the even-numbered operations must be of type B.Neko wants to produce perfect longcats at industrial scale, thus for each cat Neko only wants to perform at most 40 operations. Can you help Neko writing a transformation plan?Note that it is not required to minimize the number of operations. You just need to use no more than 40 operations." 1300.0                                      
          1151A "Maxim and Biology" "brute force,strings" "Today in the scientific lyceum of the Kingdom of Kremland, there was a biology lesson. The topic of the lesson was the genomes. Let\'s call the genome the string ""ACTG"".Maxim was very boring to sit in class, so the teacher came up with a task for him: on a given string s consisting of uppercase letters and length of at least 4, you need to find the minimum number of operations that you need to apply, so that the genome appears in it as a substring. For one operation, you can replace any letter in the string s with the next or previous in the alphabet. For example, for the letter ""D"" the previous one will be ""C"", and the next \xe2\x80\x94 ""E"". In this problem, we assume that for the letter ""A"", the previous one will be the letter ""Z"", and the next one will be ""B"", and for the letter ""Z"", the previous one is the letter ""Y"", and the next one is the letter ""A"".Help Maxim solve the problem that the teacher gave him.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end." 1000.0                                      
          1149C "Tree Generator\xe2\x84\xa2" "data structures,implementation,trees" "Owl Pacino has always been into trees \xe2\x80\x94 unweighted rooted trees in particular. He loves determining the diameter of every tree he sees \xe2\x80\x94 that is, the maximum length of any simple path in the tree.Owl Pacino\'s owl friends decided to present him the Tree Generator\xe2\x84\xa2 \xe2\x80\x94 a powerful machine creating rooted trees from their descriptions. An nn-vertex rooted tree can be described by a bracket sequence of length 2(n\xe2\x88\x921)2(n\xe2\x88\x921) in the following way: find any walk starting and finishing in the root that traverses each edge exactly twice \xe2\x80\x94 once down the tree, and later up the tree. Then follow the path and write down ""("" (an opening parenthesis) if an edge is followed down the tree, and "")"" (a closing parenthesis) otherwise.The following figure shows sample rooted trees and their descriptions:  Owl wrote down the description of an nn-vertex rooted tree. Then, he rewrote the description qq times. However, each time he wrote a new description, he picked two different characters in the description he wrote the last time, swapped them and wrote down the resulting string. He always made sure that each written string was the description of a rooted tree.Pacino then used Tree Generator\xe2\x84\xa2 for each description he wrote down. What is the diameter of each constructed tree?" 2700.0                                      
          1149A "Prefix Sum Primes" "constructive algorithms,greedy,math,number theory" "We\'re giving away nice huge bags containing number tiles! A bag we want to present to you contains n tiles. Each of them has a single number written on it \xe2\x80\x94 either 1 or 2.However, there is one condition you must fulfill in order to receive the prize. You will need to put all the tiles from the bag in a sequence, in any order you wish. We will then compute the sums of all prefixes in the sequence, and then count how many of these sums are prime numbers. If you want to keep the prize, you will need to maximize the number of primes you get.Can you win the prize? Hurry up, the bags are waiting!" 1200.0                                      
          1145D "Pigeon d\'Or" implementation "From ""ftying rats"" to urban saniwation workers - can synthetic biology tronsform how we think of pigeons? The upiquitous pigeon has long been viewed as vermin - spleading disease, scavenging through trush, and defecating in populous urban spases. Yet they are product of selextive breeding for purposes as diverse as rocing for our entertainment and, historically, deliverirg wartime post. Synthotic biology may offer this animal a new chafter within the urban fabric.Piteon d\'Or recognihes how these birds ripresent a potentially userul interface for urdan biotechnologies. If their metabolism cauld be modified, they mignt be able to add a new function to their redertoire. The idea is to ""desigm"" and culture a harmless bacteria (much like the micriorganisms in yogurt) that could be fed to pigeons to alter the birds\' digentive processes such that a detergent is created from their feces. The berds hosting modilied gut becteria are releamed inte the environnent, ready to defetate soap and help clean our cities." -999.0                                      
          1145C "Mystery Circuit" "bitmasks,brute force"  -999.0                                      
          1144C "Two Shuffled Sequences" "constructive algorithms,sortings" "Two integer sequences existed initially \xe2\x80\x94 one of them was strictly increasing, and the other one \xe2\x80\x94 strictly decreasing.Strictly increasing sequence is a sequence of integers [x1<x2<\xe2\x8b\xaf<xk]. And strictly decreasing sequence is a sequence of integers [y1>y2>\xe2\x8b\xaf>yl]. Note that the empty sequence and the sequence consisting of one element can be considered as increasing or decreasing.They were merged into one sequence a. After that sequence a got shuffled. For example, some of the possible resulting sequences a for an increasing sequence [1,3,4] and a decreasing sequence [10,4,2] are sequences [1,2,3,4,4,10] or [4,2,1,10,4,3].This shuffled sequence a is given in the input.Your task is to find any two suitable initial sequences. One of them should be strictly increasing and the other one \xe2\x80\x94 strictly decreasing. Note that the empty sequence and the sequence consisting of one element can be considered as increasing or decreasing.If there is a contradiction in the input and it is impossible to split the given sequence a to increasing and decreasing sequences, print ""NO""." 1000.0                                      
          1143C Queen "dfs and similar,trees" "You are given a rooted tree with vertices numerated from 1 to n. A tree is a connected graph without cycles. A rooted tree has a special vertex named root.Ancestors of the vertex i are all vertices on the path from the root to the vertex i, except the vertex i itself. The parent of the vertex i is the nearest to the vertex i ancestor of i. Each vertex is a child of its parent. In the given tree the parent of the vertex i is the vertex pi. For the root, the value pi is \xe2\x88\x921.  An example of a tree with n=8, the root is vertex 5. The parent of the vertex 2 is vertex 3, the parent of the vertex 1 is vertex 5. The ancestors of the vertex 6 are vertices 4 and 5, the ancestors of the vertex 7 are vertices 8, 3 and 5 You noticed that some vertices do not respect others. In particular, if ci=1, then the vertex i does not respect any of its ancestors, and if ci=0, it respects all of them.You decided to delete vertices from the tree one by one. On each step you select such a non-root vertex that it does not respect its parent and none of its children respects it. If there are several such vertices, you select the one with the smallest number. When you delete this vertex v, all children of v become connected with the parent of v.  An example of deletion of the vertex 7. Once there are no vertices matching the criteria for deletion, you stop the process. Print the order in which you will delete the vertices. Note that this order is unique." 1400.0                                      
          1141E "Superhero Battle" math "A superhero fights with a monster. The battle consists of rounds, each of which lasts exactly n minutes. After a round ends, the next round starts immediately. This is repeated over and over again.Each round has the same scenario. It is described by a sequence of n numbers: d1,d2,\xe2\x80\xa6,dn (\xe2\x88\x92106\xe2\x89\xa4di\xe2\x89\xa4106). The i-th element means that monster\'s hp (hit points) changes by the value di during the i-th minute of each round. Formally, if before the i-th minute of a round the monster\'s hp is h, then after the i-th minute it changes to h:=h+di.The monster\'s initial hp is H. It means that before the battle the monster has H hit points. Print the first minute after which the monster dies. The monster dies if its hp is less than or equal to 0. Print -1 if the battle continues infinitely." 1700.0                                      
          1139E "Maximize Mex" "flows,graph matchings,graphs" "There are n students and m clubs in a college. The clubs are numbered from 1 to m. Each student has a potential pi and is a member of the club with index ci. Initially, each student is a member of exactly one club. A technical fest starts in the college, and it will run for the next d days. There is a coding competition every day in the technical fest. Every day, in the morning, exactly one student of the college leaves their club. Once a student leaves their club, they will never join any club again. Every day, in the afternoon, the director of the college will select one student from each club (in case some club has no members, nobody is selected from that club) to form a team for this day\'s coding competition. The strength of a team is the mex of potentials of the students in the team. The director wants to know the maximum possible strength of the team for each of the coming d days. Thus, every day the director chooses such team, that the team strength is maximized.The mex of the multiset S is the smallest non-negative integer that is not present in S. For example, the mex of the {0,1,1,2,4,5,9} is 3, the mex of {1,2,3} is 0 and the mex of \xe2\x88\x85 (empty set) is 0." 2400.0                                      
               919F "A Game With Numbers" "games,graphs,shortest paths" "Imagine that Alice is playing a card game with her friend Bob. They both have exactly 8 cards and there is an integer on each card, ranging from 0 to 4. In each round, Alice or Bob in turns choose two cards from different players, let them be a and b, where a is the number on the player\'s card, and b is the number on the opponent\'s card. It is necessary that a\xe2\x8b\x85b\xe2\x89\xa00. Then they calculate c=(a+b)mod5 and replace the number a with c. The player who ends up with numbers on all 8 cards being 0, wins.Now Alice wants to know who wins in some situations. She will give you her cards\' numbers, Bob\'s cards\' numbers and the person playing the first round. Your task is to determine who wins if both of them choose the best operation in their rounds." 2600.0                                 
               917E "Upside Down" "data structures,string suffix structures,strings,trees" "As we all know, Eleven has special abilities. Thus, Hopper convinced her to close the gate to the Upside Down World with her mind. Upside down monsters like to move between the worlds, so they are going to attack Hopper and Eleven in order to make them stop. The monsters live in the vines. The vines form a tree with n vertices, numbered from 1 through n. There\'s a lowercase English letter written in each tunnel (edge).  Upside down is a magical world. There are m types of monsters in upside down, numbered from 1 through m. Each type of monster has a special word that gives them powers. The special word of type i is si. There are q monsters in upside down. Each one is at a junction (vertex) and is going to some other junction. If monster of type k goes from junction i to junction j, the power it gains is the number of times it sees its special world (sk) consecutively in the tunnels. More formally: If f(i,\xe2\x80\x89j) is the string we get when we concatenate the letters written in the tunnels on the shortest path from i to j, then the power the monster gains is the number of occurrences of sk in f(i,\xe2\x80\x89j).Hopper and Eleven want to get prepared, so for each monster, they want to know the power the monster gains after moving." 3400.0                                 
               913D "Too Easy Problems" "binary search,brute force,data structures,greedy,sortings" "You are preparing for an exam on scheduling theory. The exam will last for exactly T milliseconds and will consist of n problems. You can either solve problem i in exactly ti milliseconds or ignore it and spend no time. You don\'t need time to rest after solving a problem, either.Unfortunately, your teacher considers some of the problems too easy for you. Thus, he assigned an integer ai to every problem i meaning that the problem i can bring you a point to the final score only in case you have solved no more than ai problems overall (including problem i).Formally, suppose you solve problems p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk during the exam. Then, your final score s will be equal to the number of values of j between 1 and k such that k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89apj.You have guessed that the real first problem of the exam is already in front of you. Therefore, you want to choose a set of problems to solve during the exam maximizing your final score in advance. Don\'t forget that the exam is limited in time, and you must have enough time to solve all chosen problems. If there exist different sets of problems leading to the maximum final score, any of them will do." 1800.0                                 
               911G "Mass Change Queries" "data structures" "You are given an array a consisting of n integers. You have to process q queries to this array; each query is given as four numbers l, r, x and y, denoting that for every i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and ai\xe2\x80\x89=\xe2\x80\x89x you have to set ai equal to y.Print the array after all queries are processed." 2500.0                                 
               911C "Three Garlands" "brute force,constructive algorithms" "Mishka is decorating the Christmas tree. He has got three garlands, and all of them will be put on the tree. After that Mishka will switch these garlands on.When a garland is switched on, it periodically changes its state \xe2\x80\x94 sometimes it is lit, sometimes not. Formally, if i-th garland is switched on during x-th second, then it is lit only during seconds x, x\xe2\x80\x89+\xe2\x80\x89ki, x\xe2\x80\x89+\xe2\x80\x892ki, x\xe2\x80\x89+\xe2\x80\x893ki and so on.Mishka wants to switch on the garlands in such a way that during each second after switching the garlands on there would be at least one lit garland. Formally, Mishka wants to choose three integers x1, x2 and x3 (not necessarily distinct) so that he will switch on the first garland during x1-th second, the second one \xe2\x80\x94 during x2-th second, and the third one \xe2\x80\x94 during x3-th second, respectively, and during each second starting from max(x1,\xe2\x80\x89x2,\xe2\x80\x89x3) at least one garland will be lit.Help Mishka by telling him if it is possible to do this!" 1400.0                                 
               909F AND-permutations "constructive algorithms" "Given an integer N, find two permutations:  Permutation p of numbers from 1 to N such that pi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i and pi\xe2\x80\x89&\xe2\x80\x89i\xe2\x80\x89=\xe2\x80\x890 for all i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89N.  Permutation q of numbers from 1 to N such that qi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i and qi\xe2\x80\x89&\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890 for all i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89N. & is the bitwise AND operation." 2500.0                                 
               909E Coprocessor "dfs and similar,dp,graphs,greedy" "You are given a program you want to execute as a set of tasks organized in a dependency graph. The dependency graph is a directed acyclic graph: each task can depend on results of one or several other tasks, and there are no directed circular dependencies between tasks. A task can only be executed if all tasks it depends on have already completed.Some of the tasks in the graph can only be executed on a coprocessor, and the rest can only be executed on the main processor. In one coprocessor call you can send it a set of tasks which can only be executed on it. For each task of the set, all tasks on which it depends must be either already completed or be included in the set. The main processor starts the program execution and gets the results of tasks executed on the coprocessor automatically.Find the minimal number of coprocessor calls which are necessary to execute the given program." 1900.0                                 
               908G "New Year and Original Order" dp,math "Let S(n) denote the number that represents the digits of n in sorted order. For example, S(1)\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89S(5)\xe2\x80\x89=\xe2\x80\x895,\xe2\x80\x89S(50394)\xe2\x80\x89=\xe2\x80\x893459,\xe2\x80\x89S(353535)\xe2\x80\x89=\xe2\x80\x89333555.Given a number X, compute  modulo 109\xe2\x80\x89+\xe2\x80\x897." 2800.0                                 
               908D "New Year and Arbitrary Arrangement" dp,math,probabilities "You are given three integers k, pa and pb.You will construct a sequence with the following algorithm: Initially, start with the empty sequence. Each second, you do the following. With probability pa\xe2\x80\x89/\xe2\x80\x89(pa\xe2\x80\x89+\xe2\x80\x89pb), add \'a\' to the end of the sequence. Otherwise (with probability pb\xe2\x80\x89/\xe2\x80\x89(pa\xe2\x80\x89+\xe2\x80\x89pb)), add \'b\' to the end of the sequence.You stop once there are at least k subsequences that form \'ab\'. Determine the expected number of times \'ab\' is a subsequence in the resulting sequence. It can be shown that this can be represented by P\xe2\x80\x89/\xe2\x80\x89Q, where P and Q are coprime integers, and . Print the value of ." 2200.0                                 
               906B "Seating of Students" "brute force,constructive algorithms,math" "Students went into a class to write a test and sat in some way. The teacher thought: ""Probably they sat in this order to copy works of each other. I need to rearrange them in such a way that students that were neighbors are not neighbors in a new seating.""The class can be represented as a matrix with n rows and m columns with a student in each cell. Two students are neighbors if cells in which they sit have a common side.Let\'s enumerate students from 1 to n\xc2\xb7m in order of rows. So a student who initially sits in the cell in row i and column j has a number (i\xe2\x80\x89-\xe2\x80\x891)\xc2\xb7m\xe2\x80\x89+\xe2\x80\x89j. You have to find a matrix with n rows and m columns in which all numbers from 1 to n\xc2\xb7m appear exactly once and adjacent numbers in the original matrix are not adjacent in it, or determine that there is no such matrix." 2200.0                                 
               901C "Bipartite Segments" "binary search,data structures,dfs and similar,dsu,graphs,two pointers" "You are given an undirected graph with n vertices. There are no edge-simple cycles with the even length in it. In other words, there are no cycles of even length that pass each edge at most once. Let\'s enumerate vertices from 1 to n. You have to answer q queries. Each query is described by a segment of vertices [l;\xe2\x80\x89r], and you have to count the number of its subsegments [x;\xe2\x80\x89y] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), such that if we delete all vertices except the segment of vertices [x;\xe2\x80\x89y] (including x and y) and edges between them, the resulting graph is bipartite." 2300.0                                 
               900C "Remove Extra One" "brute force,data structures,math" "You are given a permutation p of length n. Remove one element from permutation to make the number of records the maximum possible.We remind that in a sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak the element ai is a record if for every integer j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89i) the following holds: aj\xe2\x80\x89<\xe2\x80\x89ai." 1700.0                                 
               899F "Letters Removing" "data structures,strings" "Petya has a string of length n consisting of small and large English letters and digits.He performs m operations. Each operation is described with two integers l and r and a character c: Petya removes from the string all characters c on positions between l and r, inclusive. It\'s obvious that the length of the string remains the same or decreases after each operation.Find how the string will look like after Petya performs all m operations." 2100.0                                 
               899E "Segments Removal" "data structures,dsu,flows,implementation,two pointers" "Vasya has an array of integers of length n.Vasya performs the following operations on the array: on each step he finds the longest segment of consecutive equal integers (the leftmost, if there are several such segments) and removes it. For example, if Vasya\'s array is [13,\xe2\x80\x8913,\xe2\x80\x897,\xe2\x80\x897,\xe2\x80\x897,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x892], then after one operation it becomes [13,\xe2\x80\x8913,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x892].Compute the number of operations Vasya should make until the array becomes empty, i.e. Vasya removes all elements from it." 2000.0                                 
               898C "Phone Numbers" implementation,strings "Vasya has several phone books, in which he recorded the telephone numbers of his friends. Each of his friends can have one or several phone numbers.Vasya decided to organize information about the phone numbers of friends. You will be given n strings \xe2\x80\x94 all entries from Vasya\'s phone books. Each entry starts with a friend\'s name. Then follows the number of phone numbers in the current entry, and then the phone numbers themselves. It is possible that several identical phones are recorded in the same record.Vasya also believes that if the phone number a is a suffix of the phone number b (that is, the number b ends up with a), and both numbers are written by Vasya as the phone numbers of the same person, then a is recorded without the city code and it should not be taken into account.The task is to print organized information about the phone numbers of Vasya\'s friends. It is possible that two different people have the same number. If one person has two numbers x and y, and x is a suffix of y (that is, y ends in x), then you shouldn\'t print number x. If the number of a friend in the Vasya\'s phone books is recorded several times in the same format, it is necessary to take it into account exactly once.Read the examples to understand statement and format of the output better." 1400.0                                 
               897B "Chtholly\'s request" "brute force" "\xe2\x80\x94 Thanks a lot for today.\xe2\x80\x94 I experienced so many great things.\xe2\x80\x94 You gave me memories like dreams... But I have to leave now...\xe2\x80\x94 One last request, can you...\xe2\x80\x94 Help me solve a Codeforces problem?\xe2\x80\x94 ......\xe2\x80\x94 What?Chtholly has been thinking about a problem for days:If a number is palindrome and length of its decimal representation without leading zeros is even, we call it a zcy number. A number is palindrome means when written in decimal representation, it contains no leading zeros and reads the same forwards and backwards. For example 12321 and 1221 are palindromes and 123 and 12451 are not. Moreover, 1221 is zcy number and 12321 is not.Given integers k and p, calculate the sum of the k smallest zcy numbers and output this sum modulo p.Unfortunately, Willem isn\'t good at solving this kind of problems, so he asks you for help!" 1300.0                                 
               895A "Pizza Separation" "brute force,implementation" "Students Vasya and Petya are studying at the BSU (Byteland State University). At one of the breaks they decided to order a pizza. In this problem pizza is a circle of some radius. The pizza was delivered already cut into n pieces. The i-th piece is a sector of angle equal to ai. Vasya and Petya want to divide all pieces of pizza into two continuous sectors in such way that the difference between angles of these sectors is minimal. Sector angle is sum of angles of all pieces in it. Pay attention, that one of sectors can be empty." 1200.0                                 
               893F "Subtree Minimum Query" "data structures,trees" "You are given a rooted tree consisting of n vertices. Each vertex has a number written on it; number ai is written on vertex i.Let\'s denote d(i,\xe2\x80\x89j) as the distance between vertices i and j in the tree (that is, the number of edges in the shortest path from i to j). Also let\'s denote the k-blocked subtree of vertex x as the set of vertices y such that both these conditions are met:  x is an ancestor of y (every vertex is an ancestor of itself);  d(x,\xe2\x80\x89y)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k. You are given m queries to the tree. i-th query is represented by two numbers xi and ki, and the answer to this query is the minimum value of aj among such vertices j such that j belongs to ki-blocked subtree of xi.Write a program that would process these queries quickly!Note that the queries are given in a modified way." 2300.0                                 
               893B "Beautiful Divisors" "brute force,implementation" "Recently Luba learned about a special kind of numbers that she calls beautiful numbers. The number is called beautiful iff its binary representation consists of k\xe2\x80\x89+\xe2\x80\x891 consecutive ones, and then k consecutive zeroes.Some examples of beautiful numbers:   12 (110);  1102 (610);  11110002 (12010);  1111100002 (49610). More formally, the number is beautiful iff there exists some positive integer k such that the number is equal to (2k\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89*\xe2\x80\x89(2k\xe2\x80\x89-\xe2\x80\x891).Luba has got an integer number n, and she wants to find its greatest beautiful divisor. Help her to find it!" 1000.0                                 
               892A Greed greedy,implementation "Jafar has n cans of cola. Each can is described by two integers: remaining volume of cola ai and can\'s capacity bi (ai \xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89 bi).Jafar has decided to pour all remaining cola into just 2 cans, determine if he can do this or not!" 900.0                                 
               888D "Almost Identity Permutations" combinatorics,dp,math "A permutation p of size n is an array such that every integer from 1 to n occurs exactly once in this array.Let\'s call a permutation an almost identity permutation iff there exist at least n\xe2\x80\x89-\xe2\x80\x89k indices i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that pi\xe2\x80\x89=\xe2\x80\x89i.Your task is to count the number of almost identity permutations for given numbers n and k." 1600.0                                 
               886A "ACM ICPC" "brute force" "In a small but very proud high school it was decided to win ACM ICPC. This goal requires to compose as many teams of three as possible, but since there were only 6 students who wished to participate, the decision was to build exactly two teams.After practice competition, participant number i got a score of ai. Team score is defined as sum of scores of its participants. High school management is interested if it\'s possible to build two teams with equal scores. Your task is to answer that question." 1000.0                                 
               884F Anti-Palindromize flows,graphs,greedy "A string a of length m is called antipalindromic iff m is even, and for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89am\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891.Ivan has a string s consisting of n lowercase Latin letters; n is even. He wants to form some string t that will be an antipalindromic permutation of s. Also Ivan has denoted the beauty of index i as bi, and the beauty of t as the sum of bi among all indices i such that si\xe2\x80\x89=\xe2\x80\x89ti.Help Ivan to determine maximum possible beauty of t he can get." 2500.0                                 
               884D "Boxes And Balls" "data structures,greedy" "Ivan has n different boxes. The first of them contains some balls of n different colors.Ivan wants to play a strange game. He wants to distribute the balls into boxes in such a way that for every i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) i-th box will contain all balls with color i.In order to do this, Ivan will make some turns. Each turn he does the following:  Ivan chooses any non-empty box and takes all balls from this box;  Then Ivan chooses any k empty boxes (the box from the first step becomes empty, and Ivan is allowed to choose it), separates the balls he took on the previous step into k non-empty groups and puts each group into one of the boxes. He should put each group into a separate box. He can choose either k\xe2\x80\x89=\xe2\x80\x892 or k\xe2\x80\x89=\xe2\x80\x893. The penalty of the turn is the number of balls Ivan takes from the box during the first step of the turn. And penalty of the game is the total penalty of turns made by Ivan until he distributes all balls to corresponding boxes.Help Ivan to determine the minimum possible penalty of the game!" 2300.0                                 
               883M "Quadcopter Competition" greedy,math "Polycarp takes part in a quadcopter competition. According to the rules a flying robot should:  start the race from some point of a field,  go around the flag,  close cycle returning back to the starting point. Polycarp knows the coordinates of the starting point (x1,\xe2\x80\x89y1) and the coordinates of the point where the flag is situated (x2,\xe2\x80\x89y2). Polycarp\xe2\x80\x99s quadcopter can fly only parallel to the sides of the field each tick changing exactly one coordinate by 1. It means that in one tick the quadcopter can fly from the point (x,\xe2\x80\x89y) to any of four points: (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) or (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891).Thus the quadcopter path is a closed cycle starting and finishing in (x1,\xe2\x80\x89y1) and containing the point (x2,\xe2\x80\x89y2) strictly inside.  The picture corresponds to the first example: the starting (and finishing) point is in (1,\xe2\x80\x895) and the flag is in (5,\xe2\x80\x892). What is the minimal length of the quadcopter path?" 1100.0                                 
               883H "Palindromic Cut" "brute force,implementation,strings" "Kolya has a string s of length n consisting of lowercase and uppercase Latin letters and digits.He wants to rearrange the symbols in s and cut it into the minimum number of parts so that each part is a palindrome and all parts have the same lengths. A palindrome is a string which reads the same backward as forward, such as madam or racecar.Your task is to help Kolya and determine the minimum number of palindromes of equal lengths to cut s into, if it is allowed to rearrange letters in s before cuttings." 1800.0                                 
               877D "Olya and Energy Drinks" "data structures,dfs and similar,graphs,shortest paths" "Olya loves energy drinks. She loves them so much that her room is full of empty cans from energy drinks.Formally, her room can be represented as a field of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells, each cell of which is empty or littered with cans.Olya drank a lot of energy drink, so now she can run k meters per second. Each second she chooses one of the four directions (up, down, left or right) and runs from 1 to k meters in this direction. Of course, she can only run through empty cells.Now Olya needs to get from cell (x1,\xe2\x80\x89y1) to cell (x2,\xe2\x80\x89y2). How many seconds will it take her if she moves optimally?It\'s guaranteed that cells (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) are empty. These cells can coincide." 2100.0                                 
               875E "Delivery Club" "binary search,data structures,dp" "Petya and Vasya got employed as couriers. During the working day they are to deliver packages to n different points on the line. According to the company\'s internal rules, the delivery of packages must be carried out strictly in a certain order. Initially, Petya is at the point with the coordinate s1, Vasya is at the point with the coordinate s2, and the clients are at the points x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn in the order of the required visit.The guys agree in advance who of them will deliver the package to which of the customers, and then they act as follows. When the package for the i-th client is delivered, the one who delivers the package to the (i\xe2\x80\x89+\xe2\x80\x891)-st client is sent to the path (it can be the same person who went to the point xi, or the other). The friend who is not busy in delivering the current package, is standing still.To communicate with each other, the guys have got walkie-talkies. The walkie-talkies work rather poorly at great distances, so Petya and Vasya want to distribute the orders so that the maximum distance between them during the day is as low as possible. Help Petya and Vasya to minimize the maximum distance between them, observing all delivery rules." 2600.0                                 
               875A "Classroom Watch" "brute force,math" "Eighth-grader Vova is on duty today in the class. After classes, he went into the office to wash the board, and found on it the number n. He asked what is this number and the teacher of mathematics Inna Petrovna answered Vova that n is the answer to the arithmetic task for first-graders. In the textbook, a certain positive integer x was given. The task was to add x to the sum of the digits of the number x written in decimal numeral system.Since the number n on the board was small, Vova quickly guessed which x could be in the textbook. Now he wants to get a program which will search for arbitrary values of the number n for all suitable values of x or determine that such x does not exist. Write such a program for Vova." 1200.0                                 
               873C "Strange Game On Matrix" "greedy,two pointers" "Ivan is playing a strange game.He has a matrix a with n rows and m columns. Each element of the matrix is equal to either 0 or 1. Rows and columns are 1-indexed. Ivan can replace any number of ones in this matrix with zeroes. After that, his score in the game will be calculated as follows:  Initially Ivan\'s score is 0;  In each column, Ivan will find the topmost 1 (that is, if the current column is j, then he will find minimum i such that ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x891). If there are no 1\'s in the column, this column is skipped;  Ivan will look at the next min(k,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) elements in this column (starting from the element he found) and count the number of 1\'s among these elements. This number will be added to his score. Of course, Ivan wants to maximize his score in this strange game. Also he doesn\'t want to change many elements, so he will replace the minimum possible number of ones with zeroes. Help him to determine the maximum possible score he can get and the minimum possible number of replacements required to achieve that score." 1600.0                                 
               870D "Something with XOR Queries" "brute force,interactive,probabilities" "This is an interactive problem.Jury has hidden a permutation p of integers from 0 to n\xe2\x80\x89-\xe2\x80\x891. You know only the length n. Remind that in permutation all integers are distinct.Let b be the inverse permutation for p, i.e. pbi\xe2\x80\x89=\xe2\x80\x89i for all i. The only thing you can do is to ask xor of elements pi and bj, printing two indices i and j (not necessarily distinct). As a result of the query with indices i and j you\'ll get the value , where  denotes the xor operation. You can find the description of xor operation in notes.Note that some permutations can remain indistinguishable from the hidden one, even if you make all possible n2 queries. You have to compute the number of permutations indistinguishable from the hidden one, and print one of such permutations, making no more than 2n queries.The hidden permutation does not depend on your queries." 2000.0                                 
               869E "The Untended Antiquity" "data structures,hashing" "Adieu l\'ami.Koyomi is helping Oshino, an acquaintance of his, to take care of an open space around the abandoned Eikou Cram School building, Oshino\'s makeshift residence.The space is represented by a rectangular grid of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells, arranged into n rows and m columns. The c-th cell in the r-th row is denoted by (r,\xe2\x80\x89c).Oshino places and removes barriers around rectangular areas of cells. Specifically, an action denoted by ""1 r1 c1 r2 c2"" means Oshino\'s placing barriers around a rectangle with two corners being (r1,\xe2\x80\x89c1) and (r2,\xe2\x80\x89c2) and sides parallel to squares sides. Similarly, ""2 r1 c1 r2 c2"" means Oshino\'s removing barriers around the rectangle. Oshino ensures that no barriers staying on the ground share any common points, nor do they intersect with boundaries of the n\xe2\x80\x89\xc3\x97\xe2\x80\x89m area.Sometimes Koyomi tries to walk from one cell to another carefully without striding over barriers, in order to avoid damaging various items on the ground. ""3 r1 c1 r2 c2"" means that Koyomi tries to walk from (r1,\xe2\x80\x89c1) to (r2,\xe2\x80\x89c2) without crossing barriers.And you\'re here to tell Koyomi the feasibility of each of his attempts." 2400.0                                 
               868B "Race Against Time" implementation "Have you ever tried to explain to the coordinator, why it is eight hours to the contest and not a single problem has been prepared yet? Misha had. And this time he has a really strong excuse: he faced a space-time paradox! Space and time replaced each other.The entire universe turned into an enormous clock face with three hands \xe2\x80\x94 hour, minute, and second. Time froze, and clocks now show the time h hours, m minutes, s seconds.Last time Misha talked with the coordinator at t1 o\'clock, so now he stands on the number t1 on the clock face. The contest should be ready by t2 o\'clock. In the terms of paradox it means that Misha has to go to number t2 somehow. Note that he doesn\'t have to move forward only: in these circumstances time has no direction.Clock hands are very long, and Misha cannot get round them. He also cannot step over as it leads to the collapse of space-time. That is, if hour clock points 12 and Misha stands at 11 then he cannot move to 1 along the top arc. He has to follow all the way round the clock center (of course, if there are no other hands on his way).Given the hands\' positions, t1, and t2, find if Misha can prepare the contest on time (or should we say on space?). That is, find if he can move from t1 to t2 by the clock face." 1400.0                                 
               864A "Fair Game" implementation,sortings "Petya and Vasya decided to play a game. They have n cards (n is an even number). A single integer is written on each card.Before the game Petya will choose an integer and after that Vasya will choose another integer (different from the number that Petya chose). During the game each player takes all the cards with number he chose. For example, if Petya chose number 5 before the game he will take all cards on which 5 is written and if Vasya chose number 10 before the game he will take all cards on which 10 is written.The game is considered fair if Petya and Vasya can take all n cards, and the number of cards each player gets is the same.Determine whether Petya and Vasya can choose integer numbers before the game so that the game is fair." 1000.0                                 
               862E "Mahmoud and Ehab and the function" "binary search,data structures,sortings" "Dr. Evil is interested in math and functions, so he gave Mahmoud and Ehab array a of length n and array b of length m. He introduced a function f(j) which is defined for integers j, which satisfy 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x89n. Suppose, ci\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x89j. Then f(j)\xe2\x80\x89=\xe2\x80\x89|c1\xe2\x80\x89-\xe2\x80\x89c2\xe2\x80\x89+\xe2\x80\x89c3\xe2\x80\x89-\xe2\x80\x89c4... cn|. More formally, . Dr. Evil wants Mahmoud and Ehab to calculate the minimum value of this function over all valid j. They found it a bit easy, so Dr. Evil made their task harder. He will give them q update queries. During each update they should add an integer xi to all elements in a in range [li;ri] i.e. they should add xi to ali,\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89... ,\xe2\x80\x89ari and then they should calculate the minimum value of f(j) for all valid j.Please help Mahmoud and Ehab." 2100.0                                 
               862D "Mahmoud and Ehab and the binary string" "binary search,divide and conquer,interactive" "Mahmoud and Ehab are in the fourth stage now.Dr. Evil has a hidden binary string of length n. He guarantees that there is at least one \'0\' symbol and at least one \'1\' symbol in it. Now he wants Mahmoud and Ehab to find a position of any \'0\' symbol and any \'1\' symbol. In order to do this, Mahmoud and Ehab can ask Dr. Evil up to 15 questions. They tell Dr. Evil some binary string of length n, and Dr. Evil tells the Hamming distance between these two strings. Hamming distance between 2 binary strings of the same length is the number of positions in which they have different symbols. You can find the definition of Hamming distance in the notes section below.Help Mahmoud and Ehab find these two positions.You will get Wrong Answer verdict if   Your queries doesn\'t satisfy interaction protocol described below.  You ask strictly more than 15 questions and your program terminated after exceeding queries limit. Please note, that you can do up to 15 ask queries and one answer query.  Your final answer is not correct.  You will get Idleness Limit Exceeded if you don\'t print anything or if you forget to flush the output, including for the final answer (more info about flushing output below).If you exceed the maximum number of queries, You should terminate with 0, In this case you\'ll get Wrong Answer, If you don\'t terminate you may receive any verdict because you\'ll be reading from a closed stream ." 2000.0                                 
               859E "Desk Disorder" "combinatorics,dfs and similar,dsu,graphs,trees" "A new set of desks just arrived, and it\'s about time! Things were getting quite cramped in the office. You\'ve been put in charge of creating a new seating chart for the engineers. The desks are numbered, and you sent out a survey to the engineering team asking each engineer the number of the desk they currently sit at, and the number of the desk they would like to sit at (which may be the same as their current desk). Each engineer must either remain where they sit, or move to the desired seat they indicated in the survey. No two engineers currently sit at the same desk, nor may any two engineers sit at the same desk in the new seating arrangement.How many seating arrangements can you create that meet the specified requirements? The answer may be very large, so compute it modulo 1000000007\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897." 2100.0                                 
               858A k-rounding "brute force,math,number theory" "For a given positive integer n denote its k-rounding as the minimum positive integer x, such that x ends with k or more zeros in base 10 and is divisible by n.For example, 4-rounding of 375 is 375\xc2\xb780\xe2\x80\x89=\xe2\x80\x8930000. 30000 is the minimum integer such that it ends with 4 or more zeros and is divisible by 375.Write a program that will perform the k-rounding of n." 1100.0                                 
               856F "To Play or not to Play" greedy "Vasya and Petya are playing an online game. As most online games, it has hero progress system that allows players to gain experience that make their heroes stronger. Of course, Vasya would like to get as many experience points as possible. After careful study of experience points allocation, he found out that if he plays the game alone, he gets one experience point each second. However, if two players are playing together, and their current experience values differ by at most C points, they can boost their progress, and each of them gets 2 experience points each second.Since Vasya and Petya are middle school students, their parents don\'t allow them to play all the day around. Each of the friends has his own schedule: Vasya can only play during intervals [a1;b1],\xe2\x80\x89[a2;b2],\xe2\x80\x89...,\xe2\x80\x89[an;bn], and Petya can only play during intervals [c1;d1],\xe2\x80\x89[c2;d2],\xe2\x80\x89...,\xe2\x80\x89[cm;dm]. All time periods are given in seconds from the current moment. Vasya is good in math, so he has noticed that sometimes it can be profitable not to play alone, because experience difference could become too big, and progress would not be boosted even when played together.Now they would like to create such schedule of playing that Vasya\'s final experience was greatest possible. The current players experience is the same. Petya is not so concerned about his experience, so he is ready to cooperate and play when needed to maximize Vasya\'s experience." 3000.0                                 
               856A "Set Theory" "brute force,constructive algorithms" "Masha and Grisha like studying sets of positive integers.One day Grisha has written a set A containing n different integers ai on a blackboard. Now he asks Masha to create a set B containing n different integers bj such that all n2 integers that can be obtained by summing up ai and bj for all possible pairs of i and j are different.Both Masha and Grisha don\'t like big numbers, so all numbers in A are from 1 to 106, and all numbers in B must also be in the same range.Help Masha to create the set B that satisfies Grisha\'s requirement." 1600.0                                 
               855D "Rowena Ravenclaw\'s Diadem" trees "Harry, upon inquiring Helena Ravenclaw\'s ghost, came to know that she told Tom Riddle or You-know-who about Rowena Ravenclaw\'s diadem and that he stole it from her. Harry thought that Riddle would have assumed that he was the only one to discover the Room of Requirement and thus, would have hidden it there. So Harry is trying to get inside the Room of Requirement to destroy the diadem as he knows that it is a horcrux.But he has to answer a puzzle in order to enter the room. He is given n objects, numbered from 1 to n. Some of the objects have a parent object, that has a lesser number. Formally, object i may have a parent object parenti such that parenti\xe2\x80\x89<\xe2\x80\x89i.There is also a type associated with each parent relation, it can be either of type 1 or type 2. Type 1 relation means that the child object is like a special case of the parent object. Type 2 relation means that the second object is always a part of the first object and all its special cases.Note that if an object b is a special case of object a, and c is a special case of object b, then c is considered to be a special case of object a as well. The same holds for parts: if object b is a part of a, and object c is a part of b, then we say that object c is a part of a. Also note, that if object b is a part of a, and object c is a special case of a, then b is a part of c as well.An object is considered to be neither a part of itself nor a special case of itself.Now, Harry has to answer two type of queries:  1 u v: he needs to tell if object v is a special case of object u.  2 u v: he needs to tell if object v is a part of object u." 2500.0                                 
               855C "Helga Hufflepuff\'s Cup" dp,trees "Harry, Ron and Hermione have figured out that Helga Hufflepuff\'s cup is a horcrux. Through her encounter with Bellatrix Lestrange, Hermione came to know that the cup is present in Bellatrix\'s family vault in Gringott\'s Wizarding Bank. The Wizarding bank is in the form of a tree with total n vaults where each vault has some type, denoted by a number between 1 to m. A tree is an undirected connected graph with no cycles.The vaults with the highest security are of type k, and all vaults of type k have the highest security.There can be at most x vaults of highest security. Also, if a vault is of the highest security, its adjacent vaults are guaranteed to not be of the highest security and their type is guaranteed to be less than k.Harry wants to consider every possibility so that he can easily find the best path to reach Bellatrix\'s vault. So, you have to tell him, given the tree structure of Gringotts, the number of possible ways of giving each vault a type such that the above conditions hold." 2000.0                                 
               852E "Casinos and travel" dp "John has just bought a new car and is planning a journey around the country. Country has N cities, some of which are connected by bidirectional roads. There are N\xe2\x80\x89-\xe2\x80\x891 roads and every city is reachable from any other city. Cities are labeled from 1 to N.John first has to select from which city he will start his journey. After that, he spends one day in a city and then travels to a randomly choosen city which is directly connected to his current one and which he has not yet visited. He does this until he can\'t continue obeying these rules.To select the starting city, he calls his friend Jack for advice. Jack is also starting a big casino business and wants to open casinos in some of the cities (max 1 per city, maybe nowhere). Jack knows John well and he knows that if he visits a city with a casino, he will gamble exactly once before continuing his journey.He also knows that if John enters a casino in a good mood, he will leave it in a bad mood and vice versa. Since he is John\'s friend, he wants him to be in a good mood at the moment when he finishes his journey. John is in a good mood before starting the journey.In how many ways can Jack select a starting city for John and cities where he will build casinos such that no matter how John travels, he will be in a good mood at the end? Print answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2100.0                                 
               850A "Five Dimensional Points" "brute force,geometry,math" "You are given set of n points in 5-dimensional space. The points are labeled from 1 to n. No two points coincide.We will call point a bad if there are different points b and c, not equal to a, from the given set such that angle between vectors  and  is acute (i.e. strictly less than ). Otherwise, the point is called good.The angle between vectors  and  in 5-dimensional space is defined as , where  is the scalar product and  is length of .Given the list of points, print the indices of the good points in ascending order." 1700.0                                 
               848E "Days of Floral Colours" "combinatorics,divide and conquer,dp,fft,math" "The Floral Clock has been standing by the side of Mirror Lake for years. Though unable to keep time, it reminds people of the passage of time and the good old days.On the rim of the Floral Clock are 2n flowers, numbered from 1 to 2n clockwise, each of which has a colour among all n possible ones. For each colour, there are exactly two flowers with it, the distance between which either is less than or equal to 2, or equals n. Additionally, if flowers u and v are of the same colour, then flowers opposite to u and opposite to v should be of the same colour as well \xe2\x80\x94 symmetry is beautiful!Formally, the distance between two flowers is 1 plus the number of flowers on the minor arc (or semicircle) between them. Below is a possible arrangement with n\xe2\x80\x89=\xe2\x80\x896 that cover all possibilities.  The beauty of an arrangement is defined to be the product of the lengths of flower segments separated by all opposite flowers of the same colour. In other words, in order to compute the beauty, we remove from the circle all flowers that have the same colour as flowers opposite to them. Then, the beauty is the product of lengths of all remaining segments. Note that we include segments of length 0 in this product. If there are no flowers that have the same colour as flower opposite to them, the beauty equals 0. For instance, the beauty of the above arrangement equals 1\xe2\x80\x89\xc3\x97\xe2\x80\x893\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x899 \xe2\x80\x94 the segments are {2}, {4,\xe2\x80\x895,\xe2\x80\x896}, {8} and {10,\xe2\x80\x8911,\xe2\x80\x8912}.While keeping the constraints satisfied, there may be lots of different arrangements. Find out the sum of beauty over all possible arrangements, modulo 998\xe2\x80\x89244\xe2\x80\x89353. Two arrangements are considered different, if a pair (u,\xe2\x80\x89v) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n) exists such that flowers u and v are of the same colour in one of them, but not in the other." 3400.0                                 
               848B "Rooter\'s Song" "constructive algorithms,data structures,geometry,implementation,sortings,two pointers" "Wherever the destination is, whoever we meet, let\'s render this song together.On a Cartesian coordinate plane lies a rectangular stage of size w\xe2\x80\x89\xc3\x97\xe2\x80\x89h, represented by a rectangle with corners (0,\xe2\x80\x890), (w,\xe2\x80\x890), (w,\xe2\x80\x89h) and (0,\xe2\x80\x89h). It can be seen that no collisions will happen before one enters the stage.On the sides of the stage stand n dancers. The i-th of them falls into one of the following groups:   Vertical: stands at (xi,\xe2\x80\x890), moves in positive y direction (upwards);  Horizontal: stands at (0,\xe2\x80\x89yi), moves in positive x direction (rightwards).   According to choreography, the i-th dancer should stand still for the first ti milliseconds, and then start moving in the specified direction at 1 unit per millisecond, until another border is reached. It is guaranteed that no two dancers have the same group, position and waiting time at the same time.When two dancers collide (i.e. are on the same point at some time when both of them are moving), they immediately exchange their moving directions and go on.  Dancers stop when a border of the stage is reached. Find out every dancer\'s stopping position." 1900.0                                 
               847K "Travel Cards" greedy,implementation,sortings "In the evening Polycarp decided to analyze his today\'s travel expenses on public transport.The bus system in the capital of Berland is arranged in such a way that each bus runs along the route between two stops. Each bus has no intermediate stops. So each of the buses continuously runs along the route from one stop to the other and back. There is at most one bus running between a pair of stops.Polycarp made n trips on buses. About each trip the stop where he started the trip and the the stop where he finished are known. The trips follow in the chronological order in Polycarp\'s notes.It is known that one trip on any bus costs a burles. In case when passenger makes a transshipment the cost of trip decreases to b burles (b\xe2\x80\x89<\xe2\x80\x89a). A passenger makes a transshipment if the stop on which he boards the bus coincides with the stop where he left the previous bus. Obviously, the first trip can not be made with transshipment.For example, if Polycarp made three consecutive trips: ""BerBank""  ""University"", ""University""  ""BerMall"", ""University""  ""BerBank"", then he payed a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x89a\xe2\x80\x89=\xe2\x80\x892a\xe2\x80\x89+\xe2\x80\x89b burles. From the BerBank he arrived to the University, where he made transshipment to the other bus and departed to the BerMall. Then he walked to the University and returned to the BerBank by bus.Also Polycarp can buy no more than k travel cards. Each travel card costs f burles. The travel card for a single bus route makes free of charge any trip by this route (in both directions). Once purchased, a travel card can be used any number of times in any direction.What is the smallest amount of money Polycarp could have spent today if he can buy no more than k travel cards?" 1800.0                                 
               846E "Chemistry in Berland" "dfs and similar,greedy,trees" "Igor is a post-graduate student of chemistry faculty in Berland State University (BerSU). He needs to conduct a complicated experiment to write his thesis, but laboratory of BerSU doesn\'t contain all the materials required for this experiment.Fortunately, chemical laws allow material transformations (yes, chemistry in Berland differs from ours). But the rules of transformation are a bit strange.Berland chemists are aware of n materials, numbered in the order they were discovered. Each material can be transformed into some other material (or vice versa). Formally, for each i (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) there exist two numbers xi and ki that denote a possible transformation: ki kilograms of material xi can be transformed into 1 kilogram of material i, and 1 kilogram of material i can be transformed into 1 kilogram of material xi. Chemical processing equipment in BerSU allows only such transformation that the amount of resulting material is always an integer number of kilograms.For each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) Igor knows that the experiment requires ai kilograms of material i, and the laboratory contains bi kilograms of this material. Is it possible to conduct an experiment after transforming some materials (or none)?" 2300.0                                 
               845G "Shortest Path Problem?" "dfs and similar,graphs,math" "You are given an undirected graph with weighted edges. The length of some path between two vertices is the bitwise xor of weights of all edges belonging to this path (if some edge is traversed more than once, then it is included in bitwise xor the same number of times). You have to find the minimum length of path between vertex 1 and vertex n.Note that graph can contain multiple edges and loops. It is guaranteed that the graph is connected." 2300.0                                 
               842B "Gleb And Pizza" geometry "Gleb ordered pizza home. When the courier delivered the pizza, he was very upset, because several pieces of sausage lay on the crust, and he does not really like the crust.The pizza is a circle of radius r and center at the origin. Pizza consists of the main part \xe2\x80\x94 circle of radius r\xe2\x80\x89-\xe2\x80\x89d with center at the origin, and crust around the main part of the width d. Pieces of sausage are also circles. The radius of the i -th piece of the sausage is ri, and the center is given as a pair (xi, yi).Gleb asks you to help determine the number of pieces of sausage caught on the crust. A piece of sausage got on the crust, if it completely lies on the crust." 1100.0                                 
               838C "Future Failure" dp,games "Alice and Bob are playing a game with a string of characters, with Alice going first. The string consists n characters, each of which is one of the first k letters of the alphabet. On a player\xe2\x80\x99s turn, they can either arbitrarily permute the characters in the words, or delete exactly one character in the word (if there is at least one character). In addition, their resulting word cannot have appeared before throughout the entire game. The player unable to make a valid move loses the game.Given n,\xe2\x80\x89k,\xe2\x80\x89p, find the number of words with exactly n characters consisting of the first k letters of the alphabet such that Alice will win if both Alice and Bob play optimally. Return this number modulo the prime number p." 2800.0                                 
               837E "Vasya\'s Function" "binary search,implementation,math" "Vasya is studying number theory. He has denoted a function f(a,\xe2\x80\x89b) such that:  f(a,\xe2\x80\x890)\xe2\x80\x89=\xe2\x80\x890;  f(a,\xe2\x80\x89b)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89f(a,\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89gcd(a,\xe2\x80\x89b)), where gcd(a,\xe2\x80\x89b) is the greatest common divisor of a and b. Vasya has two numbers x and y, and he wants to calculate f(x,\xe2\x80\x89y). He tried to do it by himself, but found out that calculating this function the way he wants to do that might take very long time. So he decided to ask you to implement a program that will calculate this function swiftly." 2100.0                                 
               835B "The number on the board" greedy "Some natural number was written on the board. Its sum of digits was not less than k. But you were distracted a bit, and someone changed this number to n, replacing some digits with others. It\'s known that the length of the number didn\'t change.You have to find the minimum number of digits in which these two numbers can differ." 1100.0                                 
               834B "The Festive Evening" "data structures,implementation" "It\'s the end of July \xe2\x80\x93 the time when a festive evening is held at Jelly Castle! Guests from all over the kingdom gather here to discuss new trends in the world of confectionery. Yet some of the things discussed here are not supposed to be disclosed to the general public: the information can cause discord in the kingdom of Sweetland in case it turns out to reach the wrong hands. So it\'s a necessity to not let any uninvited guests in.There are 26 entrances in Jelly Castle, enumerated with uppercase English letters from A to Z. Because of security measures, each guest is known to be assigned an entrance he should enter the castle through. The door of each entrance is opened right before the first guest\'s arrival and closed right after the arrival of the last guest that should enter the castle through this entrance. No two guests can enter the castle simultaneously.For an entrance to be protected from possible intrusion, a candy guard should be assigned to it. There are k such guards in the castle, so if there are more than k opened doors, one of them is going to be left unguarded! Notice that a guard can\'t leave his post until the door he is assigned to is closed.Slastyona had a suspicion that there could be uninvited guests at the evening. She knows the order in which the invited guests entered the castle, and wants you to help her check whether there was a moment when more than k doors were opened." 1100.0                                 
               834A "The Useless Toy" implementation "Walking through the streets of Marshmallow City, Slastyona have spotted some merchants selling a kind of useless toy which is very popular nowadays \xe2\x80\x93 caramel spinner! Wanting to join the craze, she has immediately bought the strange contraption.Spinners in Sweetland have the form of V-shaped pieces of caramel. Each spinner can, well, spin around an invisible magic axis. At a specific point in time, a spinner can take 4 positions shown below (each one rotated 90 degrees relative to the previous, with the fourth one followed by the first one):  After the spinner was spun, it starts its rotation, which is described by a following algorithm: the spinner maintains its position for a second then majestically switches to the next position in clockwise or counter-clockwise order, depending on the direction the spinner was spun in.Slastyona managed to have spinner rotating for exactly n seconds. Being fascinated by elegance of the process, she completely forgot the direction the spinner was spun in! Lucky for her, she managed to recall the starting position, and wants to deduct the direction given the information she knows. Help her do this." 900.0                                 
               828A "Restaurant Tables" implementation "In a small restaurant there are a tables for one person and b tables for two persons. It it known that n groups of people come today, each consisting of one or two people. If a group consist of one person, it is seated at a vacant one-seater table. If there are none of them, it is seated at a vacant two-seater table. If there are none of them, it is seated at a two-seater table occupied by single person. If there are still none of them, the restaurant denies service to this group.If a group consist of two people, it is seated at a vacant two-seater table. If there are none of them, the restaurant denies service to this group.You are given a chronological order of groups coming. You are to determine the total number of people the restaurant denies service to." 1200.0                                 
               827A "String Reconstruction" "data structures,greedy,sortings,strings" "Ivan had string s consisting of small English letters. However, his friend Julia decided to make fun of him and hid the string s. Ivan preferred making a new string to finding the old one. Ivan knows some information about the string s. Namely, he remembers, that string ti occurs in string s at least ki times or more, he also remembers exactly ki positions where the string ti occurs in string s: these positions are xi,\xe2\x80\x891,\xe2\x80\x89xi,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89xi,\xe2\x80\x89ki. He remembers n such strings ti.You are to reconstruct lexicographically minimal string s such that it fits all the information Ivan remembers. Strings ti and string s consist of small English letters only." 1700.0                                 
               825G "Tree Queries" "dfs and similar,graphs,trees" "You are given a tree consisting of n vertices (numbered from 1 to n). Initially all vertices are white. You have to process q queries of two different types:  1 x \xe2\x80\x94 change the color of vertex x to black. It is guaranteed that the first query will be of this type.  2 x \xe2\x80\x94 for the vertex x, find the minimum index y such that the vertex with index y belongs to the simple path from x to some black vertex (a simple path never visits any vertex more than once). For each query of type 2 print the answer to it.Note that the queries are given in modified way." 2500.0                                 
               825B Five-In-a-Row "brute force,implementation" "Alice and Bob play 5-in-a-row game. They have a playing field of size 10\xe2\x80\x89\xc3\x97\xe2\x80\x8910. In turns they put either crosses or noughts, one at a time. Alice puts crosses and Bob puts noughts.In current match they have made some turns and now it\'s Alice\'s turn. She wonders if she can put cross in such empty cell that she wins immediately.Alice wins if some crosses in the field form line of length not smaller than 5. This line can be horizontal, vertical and diagonal." 1600.0                                 
               825A "Binary Protocol" implementation "Polycarp has just invented a new binary protocol for data transmission. He is encoding positive integer decimal number to binary string using following algorithm:  Each digit is represented with number of \'1\' characters equal to the value of that digit (for 0 it is zero ones).  Digits are written one by one in order corresponding to number and separated by single \'0\' character. Though Polycarp learnt how to encode the numbers, he has no idea how to decode them back. Help him calculate the decoded number." 1100.0                                 
               822B "Crossword solving" "brute force,implementation,strings" "Erelong Leha was bored by calculating of the greatest common divisor of two factorials. Therefore he decided to solve some crosswords. It\'s well known that it is a very interesting occupation though it can be very difficult from time to time. In the course of solving one of the crosswords, Leha had to solve a simple task. You are able to do it too, aren\'t you?Leha has two strings s and t. The hacker wants to change the string s at such way, that it can be found in t as a substring. All the changes should be the following: Leha chooses one position in the string s and replaces the symbol in this position with the question mark ""?"". The hacker is sure that the question mark in comparison can play the role of an arbitrary symbol. For example, if he gets string s=""ab?b"" as a result, it will appear in t=""aabrbb"" as a substring.Guaranteed that the length of the string s doesn\'t exceed the length of the string t. Help the hacker to replace in s as few symbols as possible so that the result of the replacements can be found in t as a substring. The symbol ""?"" should be considered equal to any other symbol." 1000.0                                 
               821C "Okabe and Boxes" "data structures,greedy,trees" "Okabe and Super Hacker Daru are stacking and removing boxes. There are n boxes numbered from 1 to n. Initially there are no boxes on the stack.Okabe, being a control freak, gives Daru 2n commands: n of which are to add a box to the top of the stack, and n of which are to remove a box from the top of the stack and throw it in the trash. Okabe wants Daru to throw away the boxes in the order from 1 to n. Of course, this means that it might be impossible for Daru to perform some of Okabe\'s remove commands, because the required box is not on the top of the stack.That\'s why Daru can decide to wait until Okabe looks away and then reorder the boxes in the stack in any way he wants. He can do it at any point of time between Okabe\'s commands, but he can\'t add or remove boxes while he does it.Tell Daru the minimum number of times he needs to reorder the boxes so that he can successfully complete all of Okabe\'s commands. It is guaranteed that every box is added before it is required to be removed." 1500.0                                 
               818A "Diplomas and Certificates" implementation,math "There are n students who have taken part in an olympiad. Now it\'s time to award the students.Some of them will receive diplomas, some wiil get certificates, and others won\'t receive anything. Students with diplomas and certificates are called winners. But there are some rules of counting the number of diplomas and certificates. The number of certificates must be exactly k times greater than the number of diplomas. The number of winners must not be greater than half of the number of all students (i.e. not be greater than half of n). It\'s possible that there are no winners.You have to identify the maximum possible number of winners, according to these rules. Also for this case you have to calculate the number of students with diplomas, the number of students with certificates and the number of students who are not winners." 800.0                                 
               815A "Karen and Game" "brute force,greedy,implementation" "On the way to school, Karen became fixated on the puzzle game on her phone!  The game is played as follows. In each level, you have a grid with n rows and m columns. Each cell originally contains the number 0.One move consists of choosing one row or column, and adding 1 to all of the cells in that row or column.To win the level, after all the moves, the number in the cell at the i-th row and j-th column should be equal to gi,\xe2\x80\x89j.Karen is stuck on one level, and wants to know a way to beat this level using the minimum number of moves. Please, help her with this task!" 1700.0                                 
               813C "The Tag Game" "dfs and similar,graphs" "Alice got tired of playing the tag game by the usual rules so she offered Bob a little modification to it. Now the game should be played on an undirected rooted tree of n vertices. Vertex 1 is the root of the tree.Alice starts at vertex 1 and Bob starts at vertex x (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x891). The moves are made in turns, Bob goes first. In one move one can either stay at the current vertex or travel to the neighbouring one.The game ends when Alice goes to the same vertex where Bob is standing. Alice wants to minimize the total number of moves and Bob wants to maximize it.You should write a program which will determine how many moves will the game last." 1700.0                                 
               812D "Sagheer and Kindergarten" "dfs and similar,graphs,implementation,trees" "Sagheer is working at a kindergarten. There are n children and m different toys. These children use well-defined protocols for playing with the toys:  Each child has a lovely set of toys that he loves to play with. He requests the toys one after another at distinct moments of time. A child starts playing if and only if he is granted all the toys in his lovely set. If a child starts playing, then sooner or later he gives the toys back. No child keeps the toys forever. Children request toys at distinct moments of time. No two children request a toy at the same time. If a child is granted a toy, he never gives it back until he finishes playing with his lovely set. If a child is not granted a toy, he waits until he is granted this toy. He can\'t request another toy while waiting. If two children are waiting for the same toy, then the child who requested it first will take the toy first.Children don\'t like to play with each other. That\'s why they never share toys. When a child requests a toy, then granting the toy to this child depends on whether the toy is free or not. If the toy is free, Sagheer will give it to the child. Otherwise, the child has to wait for it and can\'t request another toy.Children are smart and can detect if they have to wait forever before they get the toys they want. In such case they start crying. In other words, a crying set is a set of children in which each child is waiting for a toy that is kept by another child in the set.Now, we have reached a scenario where all the children made all the requests for their lovely sets, except for one child x that still has one last request for his lovely set. Some children are playing while others are waiting for a toy, but no child is crying, and no one has yet finished playing. If the child x is currently waiting for some toy, he makes his last request just after getting that toy. Otherwise, he makes the request right away. When child x will make his last request, how many children will start crying?You will be given the scenario and q independent queries. Each query will be of the form x y meaning that the last request of the child x is for the toy y. Your task is to help Sagheer find the size of the maximal crying set when child x makes his last request." 2700.0                                 
               812B "Sagheer, the Hausmeister" "bitmasks,brute force,dp" "Some people leave the lights at their workplaces on when they leave that is a waste of resources. As a hausmeister of DHBW, Sagheer waits till all students and professors leave the university building, then goes and turns all the lights off.The building consists of n floors with stairs at the left and the right sides. Each floor has m rooms on the same line with a corridor that connects the left and right stairs passing by all the rooms. In other words, the building can be represented as a rectangle with n rows and m\xe2\x80\x89+\xe2\x80\x892 columns, where the first and the last columns represent the stairs, and the m columns in the middle represent rooms.Sagheer is standing at the ground floor at the left stairs. He wants to turn all the lights off in such a way that he will not go upstairs until all lights in the floor he is standing at are off. Of course, Sagheer must visit a room to turn the light there off. It takes one minute for Sagheer to go to the next floor using stairs or to move from the current room/stairs to a neighboring room/stairs on the same floor. It takes no time for him to switch the light off in the room he is currently standing in. Help Sagheer find the minimum total time to turn off all the lights.Note that Sagheer does not have to go back to his starting position, and he does not have to visit rooms where the light is already switched off." 1600.0                                 
               811C "Vladik and Memorable Trip" dp,implementation "Vladik often travels by trains. He remembered some of his trips especially well and I would like to tell you about one of these trips:Vladik is at initial train station, and now n people (including Vladik) want to get on the train. They are already lined up in some order, and for each of them the city code ai is known (the code of the city in which they are going to).Train chief selects some number of disjoint segments of the original sequence of people (covering entire sequence by segments is not necessary). People who are in the same segment will be in the same train carriage. The segments are selected in such way that if at least one person travels to the city x, then all people who are going to city x should be in the same railway carriage. This means that they can\xe2\x80\x99t belong to different segments. Note, that all people who travel to the city x, either go to it and in the same railway carriage, or do not go anywhere at all.Comfort of a train trip with people on segment from position l to position r is equal to XOR of all distinct codes of cities for people on the segment from position l to position r. XOR operation also known as exclusive OR.Total comfort of a train trip is equal to sum of comfort for each segment.Help Vladik to know maximal possible total comfort." 1900.0                                 
               809D "Hitchhiking in the Baltic States" "data structures,dp" "Leha and Noora decided to go on a trip in the Baltic States. As you know from the previous problem, Leha has lost his car on the parking of the restaurant. Unfortunately, requests to the watchman didn\'t helped hacker find the car, so friends decided to go hitchhiking.In total, they intended to visit n towns. However it turned out that sights in i-th town are open for visitors only on days from li to ri.What to do? Leha proposed to choose for each town i a day, when they will visit this town, i.e any integer xi in interval [li,\xe2\x80\x89ri]. After that Noora choses some subsequence of towns id1,\xe2\x80\x89id2,\xe2\x80\x89...,\xe2\x80\x89idk, which friends are going to visit, that at first they are strictly increasing, i.e idi\xe2\x80\x89<\xe2\x80\x89idi\xe2\x80\x89+\xe2\x80\x891 is for all integers i from 1 to k\xe2\x80\x89-\xe2\x80\x891, but also the dates of the friends visits are strictly increasing, i.e xidi\xe2\x80\x89<\xe2\x80\x89xidi\xe2\x80\x89+\xe2\x80\x891 is true for all integers i from 1 to k\xe2\x80\x89-\xe2\x80\x891.Please help Leha and Noora in choosing such xi for each town i, and such subsequence of towns id1,\xe2\x80\x89id2,\xe2\x80\x89...,\xe2\x80\x89idk, so that friends can visit maximal number of towns.You may assume, that Leha and Noora can start the trip any day." 2900.0                                 
               808C "Tea Party" "constructive algorithms,greedy,sortings" "Polycarp invited all his friends to the tea party to celebrate the holiday. He has n cups, one for each of his n friends, with volumes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. His teapot stores w milliliters of tea (w\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an). Polycarp wants to pour tea in cups in such a way that:  Every cup will contain tea for at least half of its volume  Every cup will contain integer number of milliliters of tea  All the tea from the teapot will be poured into cups  All friends will be satisfied. Friend with cup i won\'t be satisfied, if there exists such cup j that cup i contains less tea than cup j but ai\xe2\x80\x89>\xe2\x80\x89aj.For each cup output how many milliliters of tea should be poured in it. If it\'s impossible to pour all the tea and satisfy all conditions then output -1." 1400.0                                 
               804D "Expected diameter of a tree" "binary search,brute force,dfs and similar,dp,sortings,trees" "Pasha is a good student and one of MoJaK\'s best friends. He always have a problem to think about. Today they had a talk about the following problem.We have a forest (acyclic undirected graph) with n vertices and m edges. There are q queries we should answer. In each query two vertices v and u are given. Let V be the set of vertices in the connected component of the graph that contains v, and U be the set of vertices in the connected component of the graph that contains u. Let\'s add an edge between some vertex  and some vertex in  and compute the value d of the resulting component. If the resulting component is a tree, the value d is the diameter of the component, and it is equal to -1 otherwise. What is the expected value of d, if we choose vertices a and b from the sets uniformly at random?Can you help Pasha to solve this problem?The diameter of the component is the maximum distance among some pair of vertices in the component. The distance between two vertices is the minimum number of edges on some path between the two vertices.Note that queries don\'t add edges to the initial forest." 2500.0                                 
               804C "Ice cream coloring" "constructive algorithms,dfs and similar,greedy" "Isart and Modsart were trying to solve an interesting problem when suddenly Kasra arrived. Breathless, he asked: ""Can you solve a problem I\'m stuck at all day?""We have a tree T with n vertices and m types of ice cream numerated from 1 to m. Each vertex i has a set of si types of ice cream. Vertices which have the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) type of ice cream form a connected subgraph. We build a new graph G with m vertices. We put an edge between the v-th and the u-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m, u\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89v) vertices in G if and only if there exists a vertex in T that has both the v-th and the u-th types of ice cream in its set. The problem is to paint the vertices of G with minimum possible number of colors in a way that no adjacent vertices have the same color.Please note that we consider that empty set of vertices form a connected subgraph in this problem.As usual, Modsart don\'t like to abandon the previous problem, so Isart wants you to solve the new problem." 2200.0                                 
               803B "Distances to Zero" "constructive algorithms" "You are given the array of integer numbers a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. For each element find the distance to the nearest zero (to the element which equals to zero). There is at least one zero element in the given array." 1200.0                                 
               802N "April Fools\' Problem (medium)" "binary search,flows,graphs" "The marmots need to prepare k problems for HC2 over n days. Each problem, once prepared, also has to be printed.The preparation of a problem on day i (at most one per day) costs ai CHF, and the printing of a problem on day i (also at most one per day) costs bi CHF. Of course, a problem cannot be printed before it has been prepared (but doing both on the same day is fine).What is the minimum cost of preparation and printing?" 2400.0                                 
               802G "Fake News (easy)" implementation,strings "As it\'s the first of April, Heidi is suspecting that the news she reads today are fake, and she does not want to look silly in front of all the contestants. She knows that a newspiece is fake if it contains heidi as a subsequence. Help Heidi assess whether the given piece is true, but please be discreet about it..." 800.0                                 
               802E "Marmots (medium)" math "Good job! Now that Heidi is able to distinguish between Poisson and uniform distributions, she is in a good position to actually estimate the populations.Can you help Heidi estimate each village\'s population?" 2200.0                                 
               801B "Valued Keys" "constructive algorithms,greedy,strings" "You found a mysterious function f. The function takes two strings s1 and s2. These strings must consist only of lowercase English letters, and must be the same length.The output of the function f is another string of the same length. The i-th character of the output is equal to the minimum of the i-th character of s1 and the i-th character of s2.For example, f(""ab"", ""ba"") = ""aa"", and f(""nzwzl"", ""zizez"") = ""niwel"".You found two strings x and y of the same length and consisting of only lowercase English letters. Find any string z such that f(x,\xe2\x80\x89z)\xe2\x80\x89=\xe2\x80\x89y, or print -1 if no such string z exists." 900.0                                 
               798A "Mike and palindrome" "brute force,constructive algorithms,strings" "Mike has a string s consisting of only lowercase English letters. He wants to change exactly one character from the string so that the resulting one is a palindrome. A palindrome is a string that reads the same backward as forward, for example strings ""z"", ""aaa"", ""aba"", ""abccba"" are palindromes, but strings ""codeforces"", ""reality"", ""ab"" are not." 1000.0                                 
               797D "Broken BST" "data structures,dfs and similar" "Let T be arbitrary binary tree \xe2\x80\x94 tree, every vertex of which has no more than two children. Given tree is rooted, so there exists only one vertex which doesn\'t have a parent \xe2\x80\x94 it\'s the root of a tree. Every vertex has an integer number written on it. Following algorithm is run on every value from the tree T:  Set pointer to the root of a tree.  Return success if the value in the current vertex is equal to the number you are looking for  Go to the left child of the vertex if the value in the current vertex is greater than the number you are looking for  Go to the right child of the vertex if the value in the current vertex is less than the number you are looking for  Return fail if you try to go to the vertex that doesn\'t exist Here is the pseudo-code of the described algorithm: bool find(TreeNode t, int x) {    if (t == null)        return false;    if (t.value == x)        return true;    if (x < t.value)        return find(t.left, x);    else        return find(t.right, x);}find(root, x);The described algorithm works correctly if the tree is binary search tree (i.e. for each node the values of left subtree are less than the value in the node, the values of right subtree are greater than the value in the node). But it can return invalid result if tree is not a binary search tree.Since the given tree is not necessarily a binary search tree, not all numbers can be found this way. Your task is to calculate, how many times the search will fail being running on every value from the tree.If the tree has multiple vertices with the same values on them then you should run algorithm on every one of them separately." 2100.0                                 
               794G "Replace All" combinatorics,dp,math "Igor the analyst is at work. He learned about a feature in his text editor called ""Replace All"". Igor is too bored at work and thus he came up with the following problem:Given two strings x and y which consist of the English letters \'A\' and \'B\' only, a pair of strings (s,\xe2\x80\x89t) is called good if: s and t consist of the characters \'0\' and \'1\' only. 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|,\xe2\x80\x89|t|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, where |z| denotes the length of string z, and n is a fixed positive integer. If we replace all occurrences of \'A\' in x and y with the string s, and replace all occurrences of \'B\' in x and y with the string t, then the two obtained from x and y strings are equal. For example, if x\xe2\x80\x89=\xe2\x80\x89AAB, y\xe2\x80\x89=\xe2\x80\x89BB and n\xe2\x80\x89=\xe2\x80\x894, then (01, 0101) is one of good pairs of strings, because both obtained after replacing strings are ""01010101"".The flexibility of a pair of strings x and y is the number of pairs of good strings (s,\xe2\x80\x89t). The pairs are ordered, for example the pairs (0, 1) and (1, 0) are different.You\'re given two strings c and d. They consist of characters \'A\', \'B\' and \'?\' only. Find the sum of flexibilities of all possible pairs of strings (c\',\xe2\x80\x89d\') such that c\' and d\' can be obtained from c and d respectively by replacing the question marks with either \'A\' or \'B\', modulo 109\xe2\x80\x89+\xe2\x80\x897." 3400.0                                 
               788D "Finding lines" "constructive algorithms,divide and conquer,interactive" "After some programming contest Roma decided to try himself in tourism. His home country Uzhlyandia is a Cartesian plane. He wants to walk along each of the Main Straight Lines in Uzhlyandia. It is known that each of these lines is a straight line parallel to one of the axes (i.e. it is described with the equation x\xe2\x80\x89=\xe2\x80\x89a or y\xe2\x80\x89=\xe2\x80\x89a, where a is integer called the coordinate of this line).Roma lost his own map, so he should find out the coordinates of all lines at first. Uncle Anton agreed to help him, using the following rules:   Initially Roma doesn\'t know the number of vertical and horizontal lines and their coordinates;  Roma can announce integer coordinates of some point in Uzhlandia, and Anton then will tell him the minimum among the distances from the chosen point to each of the lines. However, since the coordinates of the lines don\'t exceed 108 by absolute value, Roma can\'t choose a point with coordinates exceeding 108 by absolute value. Uncle Anton is in a hurry to the UOI (Uzhlandian Olympiad in Informatics), so he can only answer no more than 3\xc2\xb7105 questions.The problem is that Roma doesn\'t know how to find out the coordinates of the lines. Write a program that plays Roma\'s role and finds the coordinates." 3000.0                                 
               788C "The Great Mixing" "dfs and similar,graphs,shortest paths" "Sasha and Kolya decided to get drunk with Coke, again. This time they have k types of Coke. i-th type is characterised by its carbon dioxide concentration . Today, on the party in honour of Sergiy of Vancouver they decided to prepare a glass of Coke with carbon dioxide concentration . The drink should also be tasty, so the glass can contain only integer number of liters of each Coke type (some types can be not presented in the glass). Also, they want to minimize the total volume of Coke in the glass.Carbon dioxide concentration is defined as the volume of carbone dioxide in the Coke divided by the total volume of Coke. When you mix two Cokes, the volume of carbon dioxide sums up, and the total volume of Coke sums up as well.Help them, find the minimal natural number of liters needed to create a glass with carbon dioxide concentration . Assume that the friends have unlimited amount of each Coke type." 2300.0                                 
               780A "Andryusha and Socks" implementation "Andryusha is an orderly boy and likes to keep things in their place.Today he faced a problem to put his socks in the wardrobe. He has n distinct pairs of socks which are initially in a bag. The pairs are numbered from 1 to n. Andryusha wants to put paired socks together and put them in the wardrobe. He takes the socks one by one from the bag, and for each sock he looks whether the pair of this sock has been already took out of the bag, or not. If not (that means the pair of this sock is still in the bag), he puts the current socks on the table in front of him. Otherwise, he puts both socks from the pair to the wardrobe.Andryusha remembers the order in which he took the socks from the bag. Can you tell him what is the maximum number of socks that were on the table at the same time?" 800.0                                 
               777D "Cloud of Hashtags" "binary search,greedy,implementation,strings" "Vasya is an administrator of a public page of organization ""Mouse and keyboard"" and his everyday duty is to publish news from the world of competitive programming. For each news he also creates a list of hashtags to make searching for a particular topic more comfortable. For the purpose of this problem we define hashtag as a string consisting of lowercase English letters and exactly one symbol \'#\' located at the beginning of the string. The length of the hashtag is defined as the number of symbols in it without the symbol \'#\'.The head administrator of the page told Vasya that hashtags should go in lexicographical order (take a look at the notes section for the definition).Vasya is lazy so he doesn\'t want to actually change the order of hashtags in already published news. Instead, he decided to delete some suffixes (consecutive characters at the end of the string) of some of the hashtags. He is allowed to delete any number of characters, even the whole string except for the symbol \'#\'. Vasya wants to pick such a way to delete suffixes that the total number of deleted symbols is minimum possible. If there are several optimal solutions, he is fine with any of them." 1800.0                                 
               777C "Alyona and Spreadsheet" "binary search,data structures,dp,greedy,implementation,two pointers" "During the lesson small girl Alyona works with one famous spreadsheet computer program and learns how to edit tables.Now she has a table filled with integers. The table consists of n rows and m columns. By ai,\xe2\x80\x89j we will denote the integer located at the i-th row and the j-th column. We say that the table is sorted in non-decreasing order in the column j if ai,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891.Teacher gave Alyona k tasks. For each of the tasks two integers l and r are given and Alyona has to answer the following question: if one keeps the rows from l to r inclusive and deletes all others, will the table be sorted in non-decreasing order in at least one column? Formally, does there exist such j that ai,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j for all i from l to r\xe2\x80\x89-\xe2\x80\x891 inclusive.Alyona is too small to deal with this task and asks you to help!" 1600.0                                 
               774E "Big Number and Remainder" "*special problem,math,number theory" "Stepan has a very big positive integer.Let\'s consider all cyclic shifts of Stepan\'s integer (if we look at his integer like at a string) which are also integers (i.e. they do not have leading zeros). Let\'s call such shifts as good shifts. For example, for the integer 10203 the good shifts are the integer itself 10203 and integers 20310 and 31020.Stepan wants to know the minimum remainder of the division by the given number m among all good shifts. Your task is to determine the minimum remainder of the division by m." 2300.0                                 
               773C "Prairie Partition" "binary search,constructive algorithms,greedy,math" "It can be shown that any positive integer x can be uniquely represented as x\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x894\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x892k\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89r, where k and r are integers, k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890, 0\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892k. Let\'s call that representation prairie partition of x.For example, the prairie partitions of 12, 17, 7 and 1 are:  12\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x894\xe2\x80\x89+\xe2\x80\x895,17\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x894\xe2\x80\x89+\xe2\x80\x898\xe2\x80\x89+\xe2\x80\x892,7\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x894,1\xe2\x80\x89=\xe2\x80\x891. Alice took a sequence of positive integers (possibly with repeating elements), replaced every element with the sequence of summands in its prairie partition, arranged the resulting numbers in non-decreasing order and gave them to Borys. Now Borys wonders how many elements Alice\'s original sequence could contain. Find all possible options!" 2200.0                                 
               772C "Vulnerable Kerbals" "constructive algorithms,dp,graphs,math,number theory" "You are given an integer m, and a list of n distinct integers between 0 and m\xe2\x80\x89-\xe2\x80\x891.You would like to construct a sequence satisfying the properties:  Each element is an integer between 0 and m\xe2\x80\x89-\xe2\x80\x891, inclusive.  All prefix products of the sequence modulo m are distinct.  No prefix product modulo m appears as an element of the input list.  The length of the sequence is maximized. Construct any sequence satisfying the properties above." 2300.0                                 
               772B "Volatile Kite" geometry "You are given a convex polygon P with n distinct vertices p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. Vertex pi has coordinates (xi,\xe2\x80\x89yi) in the 2D plane. These vertices are listed in clockwise order.You can choose a real number D and move each vertex of the polygon a distance of at most D from their original positions.Find the maximum value of D such that no matter how you move the vertices, the polygon does not intersect itself and stays convex." 1800.0                                 
               770B "Maximize Sum of Digits" "*special problem,implementation,math" "Anton has the integer x. He is interested what positive integer, which doesn\'t exceed x, has the maximum sum of digits.Your task is to help Anton and to find the integer that interests him. If there are several such integers, determine the biggest of them." 1300.0                                 
               769D "k-Interesting Pairs Of Integers" "*special problem,bitmasks,brute force,meet-in-the-middle" "Vasya has the sequence consisting of n integers. Vasya consider the pair of integers x and y k-interesting, if their binary representation differs from each other exactly in k bits. For example, if k\xe2\x80\x89=\xe2\x80\x892, the pair of integers x\xe2\x80\x89=\xe2\x80\x895 and y\xe2\x80\x89=\xe2\x80\x893 is k-interesting, because their binary representation x=101 and y=011 differs exactly in two bits.Vasya wants to know how many pairs of indexes (i, j) are in his sequence so that i\xe2\x80\x89<\xe2\x80\x89j and the pair of integers ai and aj is k-interesting. Your task is to help Vasya and determine this number." 1700.0                                 
               769C "Cycle In Maze" "*special problem,dfs and similar,graphs,greedy,shortest paths" "The Robot is in a rectangular maze of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell of the maze is either empty or occupied by an obstacle. The Robot can move between neighboring cells on the side left (the symbol ""L""), right (the symbol ""R""), up (the symbol ""U"") or down (the symbol ""D""). The Robot can move to the cell only if it is empty. Initially, the Robot is in the empty cell.Your task is to find lexicographically minimal Robot\'s cycle with length exactly k, which begins and ends in the cell where the Robot was initially. It is allowed to the Robot to visit any cell many times (including starting).Consider that Robot\'s way is given as a line which consists of symbols ""L"", ""R"", ""U"" and ""D"". For example, if firstly the Robot goes down, then left, then right and up, it means that his way is written as ""DLRU"".In this task you don\'t need to minimize the length of the way. Find the minimum lexicographical (in alphabet order as in the dictionary) line which satisfies requirements above." 1700.0                                 
               768G "The Winds of Winter" "binary search,data structures" "Given a rooted tree with n nodes. The Night King removes exactly one node from the tree and all the edges associated with it. Doing this splits the tree and forms a forest. The node which is removed is not a part of the forest.The root of a tree in the forest is the node in that tree which does not have a parent. We define the strength of the forest as the size of largest tree in forest.Jon Snow wants to minimize the strength of the forest. To do this he can perform the following operation at most once.He removes the edge between a node and its parent and inserts a new edge between this node and any other node in forest such that the total number of trees in forest remain same.For each node v you need to find the minimum value of strength of the forest formed when node v is removed." 3300.0                                 
               768E "Game of Stones" bitmasks,dp,games "Sam has been teaching Jon the Game of Stones to sharpen his mind and help him devise a strategy to fight the white walkers. The rules of this game are quite simple:  The game starts with n piles of stones indexed from 1 to n. The i-th pile contains si stones. The players make their moves alternatively. A move is considered as removal of some number of stones from a pile. Removal of 0 stones does not count as a move. The player who is unable to make a move loses.Now Jon believes that he is ready for battle, but Sam does not think so. To prove his argument, Sam suggested that they play a modified version of the game.In this modified version, no move can be made more than once on a pile. For example, if 4 stones are removed from a pile, 4 stones cannot be removed from that pile again.Sam sets up the game and makes the first move. Jon believes that Sam is just trying to prevent him from going to battle. Jon wants to know if he can win if both play optimally." 2100.0                                 
               768B "Code For 1" "constructive algorithms,dfs and similar,divide and conquer" "Jon fought bravely to rescue the wildlings who were attacked by the white-walkers at Hardhome. On his arrival, Sam tells him that he wants to go to Oldtown to train at the Citadel to become a maester, so he can return and take the deceased Aemon\'s place as maester of Castle Black. Jon agrees to Sam\'s proposal and Sam sets off his journey to the Citadel. However becoming a trainee at the Citadel is not a cakewalk and hence the maesters at the Citadel gave Sam a problem to test his eligibility. Initially Sam has a list with a single element n. Then he has to perform certain operations on this list. In each operation Sam must remove any element x, such that x\xe2\x80\x89>\xe2\x80\x891, from the list and insert at the same position , ,  sequentially. He must continue with these operations until all the elements in the list are either 0 or 1.Now the masters want the total number of 1s in the range l to r (1-indexed). Sam wants to become a maester but unfortunately he cannot solve this problem. Can you help Sam to pass the eligibility test?" 1600.0                                 
               766C "Mahmoud and a Message" "brute force,dp,greedy,strings" "Mahmoud wrote a message s of length n. He wants to send it as a birthday present to his friend Moaz who likes strings. He wrote it on a magical paper but he was surprised because some characters disappeared while writing the string. That\'s because this magical paper doesn\'t allow character number i in the English alphabet to be written on it in a string of length more than ai. For example, if a1\xe2\x80\x89=\xe2\x80\x892 he can\'t write character \'a\' on this paper in a string of length 3 or more. String ""aa"" is allowed while string ""aaa"" is not.Mahmoud decided to split the message into some non-empty substrings so that he can write every substring on an independent magical paper and fulfill the condition. The sum of their lengths should be n and they shouldn\'t overlap. For example, if a1\xe2\x80\x89=\xe2\x80\x892 and he wants to send string ""aaa"", he can split it into ""a"" and ""aa"" and use 2 magical papers, or into ""a"", ""a"" and ""a"" and use 3 magical papers. He can\'t split it into ""aa"" and ""aa"" because the sum of their lengths is greater than n. He can split the message into single string if it fulfills the conditions.A substring of string s is a string that consists of some consecutive characters from string s, strings ""ab"", ""abc"" and ""b"" are substrings of string ""abc"", while strings ""acb"" and ""ac"" are not. Any string is a substring of itself.While Mahmoud was thinking of how to split the message, Ehab told him that there are many ways to split it. After that Mahmoud asked you three questions:   How many ways are there to split the string into substrings such that every substring fulfills the condition of the magical paper, the sum of their lengths is n and they don\'t overlap? Compute the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.  What is the maximum length of a substring that can appear in some valid splitting?  What is the minimum number of substrings the message can be spit in? Two ways are considered different, if the sets of split positions differ. For example, splitting ""aa|a"" and ""a|aa"" are considered different splittings of message ""aaa""." 1700.0                                 
               765G "Math, math everywhere" "brute force,dp,math,meet-in-the-middle,number theory" "If you have gone that far, you\'ll probably skip unnecessary legends anyway...You are given a binary string  and an integer . Find the number of integers k, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89N, such that for all i\xe2\x80\x89=\xe2\x80\x890, 1, ..., m\xe2\x80\x89-\xe2\x80\x891  Print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 3200.0                                 
               765D "Artsem and Saunders" "constructive algorithms,dsu,math" "Artsem has a friend Saunders from University of Chicago. Saunders presented him with the following problem.Let [n] denote the set {1,\xe2\x80\x89...,\xe2\x80\x89n}. We will also write f:\xe2\x80\x89[x]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[y] when a function f is defined in integer points 1, ..., x, and all its values are integers from 1 to y.Now then, you are given a function f:\xe2\x80\x89[n]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[n]. Your task is to find a positive integer m, and two functions g:\xe2\x80\x89[n]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[m], h:\xe2\x80\x89[m]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[n], such that g(h(x))\xe2\x80\x89=\xe2\x80\x89x for all , and h(g(x))\xe2\x80\x89=\xe2\x80\x89f(x) for all , or determine that finding these is impossible." 1700.0                                 
               764B "Timofey and cubes" "constructive algorithms,implementation" "Young Timofey has a birthday today! He got kit of n cubes as a birthday present from his parents. Every cube has a number ai, which is written on it. Timofey put all the cubes in a row and went to unpack other presents.In this time, Timofey\'s elder brother, Dima reordered the cubes using the following rule. Suppose the cubes are numbered from 1 to n in their order. Dima performs several steps, on step i he reverses the segment of cubes from i-th to (n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891)-th. He does this while i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891.After performing the operations Dima went away, being very proud of himself. When Timofey returned to his cubes, he understood that their order was changed. Help Timofey as fast as you can and save the holiday \xe2\x80\x94 restore the initial order of the cubes using information of their current location." 900.0                                 
               763D "Timofey and a flat tree" "data structures,graphs,hashing,shortest paths,trees" "Little Timofey has a big tree \xe2\x80\x94 an undirected connected graph with n vertices and no simple cycles. He likes to walk along it. His tree is flat so when he walks along it he sees it entirely. Quite naturally, when he stands on a vertex, he sees the tree as a rooted tree with the root in this vertex.Timofey assumes that the more non-isomorphic subtrees are there in the tree, the more beautiful the tree is. A subtree of a vertex is a subgraph containing this vertex and all its descendants. You should tell Timofey the vertex in which he should stand to see the most beautiful rooted tree.Subtrees of vertices u and v are isomorphic if the number of children of u equals the number of children of v, and their children can be arranged in such a way that the subtree of the first son of u is isomorphic to the subtree of the first son of v, the subtree of the second son of u is isomorphic to the subtree of the second son of v, and so on. In particular, subtrees consisting of single vertex are isomorphic to each other." 2900.0                                 
               757A "Gotta Catch Em\' All!" implementation "Bash wants to become a Pokemon master one day. Although he liked a lot of Pokemon, he has always been fascinated by Bulbasaur the most. Soon, things started getting serious and his fascination turned into an obsession. Since he is too young to go out and catch Bulbasaur, he came up with his own way of catching a Bulbasaur.Each day, he takes the front page of the newspaper. He cuts out the letters one at a time, from anywhere on the front page of the newspaper to form the word ""Bulbasaur"" (without quotes) and sticks it on his wall. Bash is very particular about case \xe2\x80\x94 the first letter of ""Bulbasaur"" must be upper case and the rest must be lower case. By doing this he thinks he has caught one Bulbasaur. He then repeats this step on the left over part of the newspaper. He keeps doing this until it is not possible to form the word ""Bulbasaur"" from the newspaper.Given the text on the front page of the newspaper, can you tell how many Bulbasaurs he will catch today?Note: uppercase and lowercase letters are considered different." 1000.0                                 
               756B "Travel Card" "binary search,dp" "A new innovative ticketing systems for public transport is introduced in Bytesburg. Now there is a single travel card for all transport. To make a trip a passenger scan his card and then he is charged according to the fare.The fare is constructed in the following manner. There are three types of tickets:   a ticket for one trip costs 20 byteland rubles,  a ticket for 90 minutes costs 50 byteland rubles,  a ticket for one day (1440 minutes) costs 120 byteland rubles. Note that a ticket for x minutes activated at time t can be used for trips started in time range from t to t\xe2\x80\x89+\xe2\x80\x89x\xe2\x80\x89-\xe2\x80\x891, inclusive. Assume that all trips take exactly one minute.To simplify the choice for the passenger, the system automatically chooses the optimal tickets. After each trip starts, the system analyses all the previous trips and the current trip and chooses a set of tickets for these trips with a minimum total cost. Let the minimum total cost of tickets to cover all trips from the first to the current is a, and the total sum charged before is b. Then the system charges the passenger the sum a\xe2\x80\x89-\xe2\x80\x89b.You have to write a program that, for given trips made by a passenger, calculates the sum the passenger is charged after each trip." 1600.0                                 
               755E "PolandBall and White-Red graph" "constructive algorithms,graphs,shortest paths" "PolandBall has an undirected simple graph consisting of n vertices. Unfortunately, it has no edges. The graph is very sad because of that. PolandBall wanted to make it happier, adding some red edges. Then, he will add white edges in every remaining place. Therefore, the final graph will be a clique in two colors: white and red. Colorfulness of the graph is a value min(dr,\xe2\x80\x89dw), where dr is the diameter of the red subgraph and dw is the diameter of white subgraph. The diameter of a graph is a largest value d such that shortest path between some pair of vertices in it is equal to d. If the graph is not connected, we consider its diameter to be -1.PolandBall wants the final graph to be as neat as possible. He wants the final colorfulness to be equal to k. Can you help him and find any graph which satisfies PolandBall\'s requests?" 2400.0                                 
               754A "Lesha and array splitting" "constructive algorithms,greedy,implementation" "One spring day on his way to university Lesha found an array A. Lesha likes to split arrays into several parts. This time Lesha decided to split the array A into several, possibly one, new arrays so that the sum of elements in each of the new arrays is not zero. One more condition is that if we place the new arrays one after another they will form the old array A.Lesha is tired now so he asked you to split the array. Help Lesha!" 1200.0                                 
               753C "Interactive Bulls and Cows (Hard)" "brute force,constructive algorithms,interactive" "The only difference from the previous problem is the constraint on the number of requests. In this problem your program should guess the answer doing at most 7 requests.This problem is a little bit unusual. Here you are to implement an interaction with a testing system. That means that you can make queries and get responses in the online mode. Please be sure to use the stream flushing operation after each query\'s output in order not to leave part of your output in some buffer. For example, in C++ you\'ve got to use the fflush(stdout) function, in Java \xe2\x80\x94 call System.out.flush(), and in Pascal \xe2\x80\x94 flush(output).Bulls and Cows (also known as Cows and Bulls or Pigs and Bulls or Bulls and Cleots) is an old code-breaking paper and pencil game for two players, predating the similar commercially marketed board game Mastermind.On a sheet of paper, the first player thinks a secret string. This string consists only of digits and has the length 4. The digits in the string must be all different, no two or more equal digits are allowed.Then the second player tries to guess his opponent\'s string. For every guess the first player gives the number of matches. If the matching digits are on their right positions, they are ""bulls"", if on different positions, they are ""cows"". Thus a response is a pair of numbers \xe2\x80\x94 the number of ""bulls"" and the number of ""cows"". A try can contain equal digits.More formally, let\'s the secret string is s and the second player are trying to guess it with a string x. The number of ""bulls"" is a number of such positions i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894) where s[i]\xe2\x80\x89=\xe2\x80\x89x[i]. The number of ""cows"" is a number of such digits c that s contains c in the position i (i.e. s[i]\xe2\x80\x89=\xe2\x80\x89c), x contains c, but x[i]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89c.For example, the secret string is ""0427"", the opponent\'s try is ""0724"", then the answer is 2 bulls and 2 cows (the bulls are ""0"" and ""2"", the cows are ""4"" and ""7""). If the secret string is ""0123"", the opponent\'s try is ""0330"", then the answer is 1 bull and 1 cow.In this problem you are to guess the string s that the system has chosen. You only know that the chosen string consists of 4 distinct digits.You can make queries to the testing system, each query is the output of a single 4-digit string. The answer to the query is the number of bulls and number of cows. If the system\'s response equals ""4 0"", that means the interaction with your problem is over and the program must terminate. That is possible for two reasons \xe2\x80\x94 the program either guessed the number x or made an invalid action (for example, printed letters instead of digits).Your program is allowed to do at most 7 queries.You can hack solutions of other participants providing a 4-digit string containing distinct digits \xe2\x80\x94 the secret string." 2500.0                                 
               753A "Santa Claus and Candies" dp,greedy,math "Santa Claus has n candies, he dreams to give them as gifts to children.What is the maximal number of children for whose he can give candies if Santa Claus want each kid should get distinct positive integer number of candies. Santa Class wants to give all n candies he has." 1000.0                                 
               747E Comments "dfs and similar,expression parsing,implementation,strings" "A rare article in the Internet is posted without a possibility to comment it. On a Polycarp\'s website each article has comments feed.Each comment on Polycarp\'s website is a non-empty string consisting of uppercase and lowercase letters of English alphabet. Comments have tree-like structure, that means each comment except root comments (comments of the highest level) has exactly one parent comment.When Polycarp wants to save comments to his hard drive he uses the following format. Each comment he writes in the following format:   at first, the text of the comment is written;  after that the number of comments is written, for which this comment is a parent comment (i. e. the number of the replies to this comments);  after that the comments for which this comment is a parent comment are written (the writing of these comments uses the same algorithm).  All elements in this format are separated by single comma. Similarly, the comments of the first level are separated by comma.For example, if the comments look like:  then the first comment is written as ""hello,2,ok,0,bye,0"", the second is written as ""test,0"", the third comment is written as ""one,1,two,2,a,0,b,0"". The whole comments feed is written as: ""hello,2,ok,0,bye,0,test,0,one,1,two,2,a,0,b,0"". For a given comments feed in the format specified above print the comments in a different format:   at first, print a integer d \xe2\x80\x94 the maximum depth of nesting comments;  after that print d lines, the i-th of them corresponds to nesting level i;  for the i-th row print comments of nesting level i in the order of their appearance in the Policarp\'s comments feed, separated by space." 1700.0                                 
               743B "Chloe and the sequence" "binary search,bitmasks,constructive algorithms,implementation" "Chloe, the same as Vladik, is a competitive programmer. She didn\'t have any problems to get to the olympiad like Vladik, but she was confused by the task proposed on the olympiad.Let\'s consider the following algorithm of generating a sequence of integers. Initially we have a sequence consisting of a single element equal to 1. Then we perform (n\xe2\x80\x89-\xe2\x80\x891) steps. On each step we take the sequence we\'ve got on the previous step, append it to the end of itself and insert in the middle the minimum positive integer we haven\'t used before. For example, we get the sequence [1,\xe2\x80\x892,\xe2\x80\x891] after the first step, the sequence [1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891] after the second step.The task is to find the value of the element with index k (the elements are numbered from 1) in the obtained sequence, i. e. after (n\xe2\x80\x89-\xe2\x80\x891) steps.Please help Chloe to solve the problem!" 1200.0                                 
               742A "Arpa\xe2\x80\x99s hard exam and Mehrdad\xe2\x80\x99s naive cheat" "implementation,math,number theory" "There exists an island called Arpa\xe2\x80\x99s land, some beautiful girls live there, as ugly ones do.Mehrdad wants to become minister of Arpa\xe2\x80\x99s land. Arpa has prepared an exam. Exam has only one question, given n, print the last digit of 1378n.   Mehrdad has become quite confused and wants you to help him. Please help, although it\'s a naive cheat." 1000.0                                 
               740A "Alyona and copybooks" "brute force,implementation" "Little girl Alyona is in a shop to buy some copybooks for school. She study four subjects so she wants to have equal number of copybooks for each of the subjects. There are three types of copybook\'s packs in the shop: it is possible to buy one copybook for a rubles, a pack of two copybooks for b rubles, and a pack of three copybooks for c rubles. Alyona already has n copybooks.What is the minimum amount of rubles she should pay to buy such number of copybooks k that n\xe2\x80\x89+\xe2\x80\x89k is divisible by 4? There are infinitely many packs of any type in the shop. Alyona can buy packs of different type in the same purchase." 1300.0                                 
               733F "Drivers Dissatisfaction" "data structures,dsu,graphs,trees" "In one kingdom there are n cities and m two-way roads. Each road connects a pair of cities, and for each road we know the level of drivers dissatisfaction \xe2\x80\x94 the value wi.For each road we know the value ci \xe2\x80\x94 how many lamziks we should spend to reduce the level of dissatisfaction with this road by one. Thus, to reduce the dissatisfaction with the i-th road by k, we should spend k\xc2\xb7ci lamziks. And it is allowed for the dissatisfaction to become zero or even negative.In accordance with the king\'s order, we need to choose n\xe2\x80\x89-\xe2\x80\x891 roads and make them the main roads. An important condition must hold: it should be possible to travel from any city to any other by the main roads.The road ministry has a budget of S lamziks for the reform. The ministry is going to spend this budget for repair of some roads (to reduce the dissatisfaction with them), and then to choose the n\xe2\x80\x89-\xe2\x80\x891 main roads.Help to spend the budget in such a way and then to choose the main roads so that the total dissatisfaction with the main roads will be as small as possible. The dissatisfaction with some roads can become negative. It is not necessary to spend whole budget S.It is guaranteed that it is possible to travel from any city to any other using existing roads. Each road in the kingdom is a two-way road." 2200.0                                 
               733A "Grasshopper And the String" implementation "One day, the Grasshopper was jumping on the lawn and found a piece of paper with a string. Grasshopper became interested what is the minimum jump ability he should have in order to be able to reach the far end of the string, jumping only on vowels of the English alphabet. Jump ability is the maximum possible length of his jump. Formally, consider that at the begginning the Grasshopper is located directly in front of the leftmost character of the string. His goal is to reach the position right after the rightmost character of the string. In one jump the Grasshopper could jump to the right any distance from 1 to the value of his jump ability.  The picture corresponds to the first example. The following letters are vowels: \'A\', \'E\', \'I\', \'O\', \'U\' and \'Y\'." 1000.0                                 
               731C Socks "dfs and similar,dsu,graphs,greedy" "Arseniy is already grown-up and independent. His mother decided to leave him alone for m days and left on a vacation. She have prepared a lot of food, left some money and washed all Arseniy\'s clothes. Ten minutes before her leave she realized that it would be also useful to prepare instruction of which particular clothes to wear on each of the days she will be absent. Arseniy\'s family is a bit weird so all the clothes is enumerated. For example, each of Arseniy\'s n socks is assigned a unique integer from 1 to n. Thus, the only thing his mother had to do was to write down two integers li and ri for each of the days \xe2\x80\x94 the indices of socks to wear on the day i (obviously, li stands for the left foot and ri for the right). Each sock is painted in one of k colors.When mother already left Arseniy noticed that according to instruction he would wear the socks of different colors on some days. Of course, that is a terrible mistake cause by a rush. Arseniy is a smart boy, and, by some magical coincidence, he posses k jars with the paint \xe2\x80\x94 one for each of k colors.Arseniy wants to repaint some of the socks in such a way, that for each of m days he can follow the mother\'s instructions and wear the socks of the same color. As he is going to be very busy these days he will have no time to change the colors of any socks so he has to finalize the colors now.The new computer game Bota-3 was just realised and Arseniy can\'t wait to play it. What is the minimum number of socks that need their color to be changed in order to make it possible to follow mother\'s instructions and wear the socks of the same color during each of m days." 1600.0                                 
               730C Bulmart "binary search,dfs and similar" "A new trade empire is rising in Berland. Bulmart, an emerging trade giant, decided to dominate the market of ... shovels! And now almost every city in Berland has a Bulmart store, and some cities even have several of them! The only problem is, at the moment sales are ... let\'s say a little below estimates. Some people even say that shovels retail market is too small for such a big company to make a profit. But the company management believes in the future of that market and seeks new ways to increase income. There are n cities in Berland connected with m bi-directional roads. All roads have equal lengths. It can happen that it is impossible to reach a city from another city using only roads. There is no road which connects a city to itself. Any pair of cities can be connected by at most one road.There are w Bulmart stores in Berland. Each of them is described by three numbers:   ci \xe2\x80\x94 the number of city where the i-th store is located (a city can have no stores at all or have several of them),  ki \xe2\x80\x94 the number of shovels in the i-th store,  pi \xe2\x80\x94 the price of a single shovel in the i-th store (in burles). The latest idea of the Bulmart management is to create a program which will help customers get shovels as fast as possible for affordable budget. Formally, the program has to find the minimum amount of time needed to deliver rj shovels to the customer in the city gj for the total cost of no more than aj burles. The delivery time between any two adjacent cities is equal to 1. If shovels are delivered from several cities, the delivery time is equal to the arrival time of the last package. The delivery itself is free of charge.The program needs to find answers to q such queries. Each query has to be processed independently from others, i.e. a query does not change number of shovels in stores for the next queries." 2100.0                                 
               730A "Toda 2" greedy,implementation "A group of n friends enjoys playing popular video game Toda 2. There is a rating system describing skill level of each player, initially the rating of the i-th friend is ri.The friends decided to take part in the championship as a team. But they should have equal ratings to be allowed to compose a single team consisting of all n friends. So the friends are faced with the problem: how to make all their ratings equal.One way to change ratings is to willingly lose in some matches. Friends can form a party consisting of two to five (but not more than n) friends and play a match in the game. When the party loses, the rating of each of its members decreases by 1. A rating can\'t become negative, so ri\xe2\x80\x89=\xe2\x80\x890 doesn\'t change after losing.The friends can take part in multiple matches, each time making a party from any subset of friends (but remember about constraints on party size: from 2 to 5 members).The friends want to make their ratings equal but as high as possible.Help the friends develop a strategy of losing the matches so that all their ratings become equal and the resulting rating is maximum possible." 1800.0                                 
               729E Subordinates "constructive algorithms,data structures,graphs,greedy,sortings" "There are n workers in a company, each of them has a unique id from 1 to n. Exaclty one of them is a chief, his id is s. Each worker except the chief has exactly one immediate superior.There was a request to each of the workers to tell how how many superiors (not only immediate). Worker\'s superiors are his immediate superior, the immediate superior of the his immediate superior, and so on. For example, if there are three workers in the company, from which the first is the chief, the second worker\'s immediate superior is the first, the third worker\'s immediate superior is the second, then the third worker has two superiors, one of them is immediate and one not immediate. The chief is a superior to all the workers except himself.Some of the workers were in a hurry and made a mistake. You are to find the minimum number of workers that could make a mistake." 1900.0                                 
               725F "Family Photos" games,greedy "Alice and Bonnie are sisters, but they don\'t like each other very much. So when some old family photos were found in the attic, they started to argue about who should receive which photos. In the end, they decided that they would take turns picking photos. Alice goes first.There are n stacks of photos. Each stack contains exactly two photos. In each turn, a player may take only a photo from the top of one of the stacks.Each photo is described by two non-negative integers a and b, indicating that it is worth a units of happiness to Alice and b units of happiness to Bonnie. Values of a and b might differ for different photos.It\'s allowed to pass instead of taking a photo. The game ends when all photos are taken or both players pass consecutively.The players don\'t act to maximize their own happiness. Instead, each player acts to maximize the amount by which her happiness exceeds her sister\'s. Assuming both players play optimal, find the difference between Alice\'s and Bonnie\'s happiness. That is, if there\'s a perfectly-played game such that Alice has x happiness and Bonnie has y happiness at the end, you should print x\xe2\x80\x89-\xe2\x80\x89y." 2900.0                                 
               724B "Batch Sort" "brute force,greedy,implementation,math" "You are given a table consisting of n rows and m columns.Numbers in each row form a permutation of integers from 1 to m.You are allowed to pick two elements in one row and swap them, but no more than once for each row. Also, no more than once you are allowed to pick two columns and swap them. Thus, you are allowed to perform from 0 to n\xe2\x80\x89+\xe2\x80\x891 actions in total. Operations can be performed in any order.You have to check whether it\'s possible to obtain the identity permutation 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89m in each row. In other words, check if one can perform some of the operation following the given rules and make each row sorted in increasing order." 1500.0                                 
               723E "One-Way Reform" "constructive algorithms,dfs and similar,flows,graphs,greedy" "There are n cities and m two-way roads in Berland, each road connects two cities. It is known that there is no more than one road connecting each pair of cities, and there is no road which connects the city with itself. It is possible that there is no way to get from one city to some other city using only these roads.The road minister decided to make a reform in Berland and to orient all roads in the country, i.e. to make each road one-way. The minister wants to maximize the number of cities, for which the number of roads that begins in the city equals to the number of roads that ends in it." 2200.0                                 
               722E "Research Rover" combinatorics,dp "Unfortunately, the formal description of the task turned out to be too long, so here is the legend.Research rover finally reached the surface of Mars and is ready to complete its mission. Unfortunately, due to the mistake in the navigation system design, the rover is located in the wrong place.The rover will operate on the grid consisting of n rows and m columns. We will define as (r,\xe2\x80\x89c) the cell located in the row r and column c. From each cell the rover is able to move to any cell that share a side with the current one.The rover is currently located at cell (1,\xe2\x80\x891) and has to move to the cell (n,\xe2\x80\x89m). It will randomly follow some shortest path between these two cells. Each possible way is chosen equiprobably.The cargo section of the rover contains the battery required to conduct the research. Initially, the battery charge is equal to s units of energy.Some of the cells contain anomaly. Each time the rover gets to the cell with anomaly, the battery looses half of its charge rounded down. Formally, if the charge was equal to x before the rover gets to the cell with anomaly, the charge will change to .While the rover picks a random shortest path to proceed, compute the expected value of the battery charge after it reaches cell (n,\xe2\x80\x89m). If the cells (1,\xe2\x80\x891) and (n,\xe2\x80\x89m) contain anomaly, they also affect the charge of the battery." 2900.0                                 
               720F "Array Covering" "data structures" "Misha has an array of integers of length n. He wants to choose k different continuous subarrays, so that each element of the array belongs to at least one of the chosen subarrays.Misha wants to choose the subarrays in such a way that if he calculated the sum of elements for each subarray, and then add up all these sums, the resulting value was maximum possible." 3100.0                                 
               720C Homework "constructive algorithms" "Today Peter has got an additional homework for tomorrow. The teacher has given three integers to him: n, m and k, and asked him to mark one or more squares on a square grid of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. The marked squares must form a connected figure, and there must be exactly k triples of marked squares that form an L-shaped tromino \xe2\x80\x94 all three squares are inside a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square.The set of squares forms a connected figure if it is possible to get from any square to any other one if you are allowed to move from a square to any adjacent by a common side square.Peter cannot fulfill the task, so he asks you for help. Help him to create such figure." 3100.0                                 
               720A "Closing ceremony" greedy "The closing ceremony of Squanch Code Cup is held in the big hall with n\xe2\x80\x89\xc3\x97\xe2\x80\x89m seats, arranged in n rows, m seats in a row. Each seat has two coordinates (x,\xe2\x80\x89y) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). There are two queues of people waiting to enter the hall: k people are standing at (0,\xe2\x80\x890) and n\xc2\xb7m\xe2\x80\x89-\xe2\x80\x89k people are standing at (0,\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891). Each person should have a ticket for a specific seat. If person p at (x,\xe2\x80\x89y) has ticket for seat (xp,\xe2\x80\x89yp) then he should walk |x\xe2\x80\x89-\xe2\x80\x89xp|\xe2\x80\x89+\xe2\x80\x89|y\xe2\x80\x89-\xe2\x80\x89yp| to get to his seat.Each person has a stamina \xe2\x80\x94 the maximum distance, that the person agrees to walk. You should find out if this is possible to distribute all n\xc2\xb7m tickets in such a way that each person has enough stamina to get to their seat." 2000.0                                 
               717I "Cowboy Beblop at his computer" geometry "Cowboy Beblop is a funny little boy who likes sitting at his computer. He somehow obtained two elastic hoops in the shape of 2D polygons, which are not necessarily convex. Since there\'s no gravity on his spaceship, the hoops are standing still in the air. Since the hoops are very elastic, Cowboy Beblop can stretch, rotate, translate or shorten their edges as much as he wants.For both hoops, you are given the number of their vertices, as well as the position of each vertex, defined by the X , Y and Z coordinates. The vertices are given in the order they\'re connected: the 1st\xe2\x80\xafvertex is connected to the 2nd, which is connected to the 3rd, etc., and the last vertex is connected to the first one. Two hoops are connected if it\'s impossible to pull them to infinity in different directions by manipulating their edges, without having their edges or vertices intersect at any point \xe2\x80\x93 just like when two links of a chain are connected. The polygons\' edges do not intersect or overlap. To make things easier, we say that two polygons are well-connected, if the edges of one polygon cross the area of the other polygon in two different directions (from the upper and lower sides of the plane defined by that polygon) a different number of times.Cowboy Beblop is fascinated with the hoops he has obtained and he would like to know whether they are well-connected or not. Since he\xe2\x80\x99s busy playing with his dog, Zwei, he\xe2\x80\x99d like you to figure it out for him. He promised you some sweets if you help him!" 2800.0                                 
               717A "Festival Organization" "combinatorics,math,number theory" "The Prodiggers are quite a cool band and for this reason, they have been the surprise guest at the ENTER festival for the past 80 years. At the beginning of their careers, they weren\xe2\x80\x99t so successful, so they had to spend time digging channels to earn money; hence the name. Anyway, they like to tour a lot and have surprising amounts of energy to do extremely long tours. However, they hate spending two consecutive days without having a concert, so they would like to avoid it.A tour is defined by a sequence of concerts and days-off. You need to count in how many ways The Prodiggers can select k different tours of the same length between l and r.For example if k\xe2\x80\x89=\xe2\x80\x892, l\xe2\x80\x89=\xe2\x80\x891 and r\xe2\x80\x89=\xe2\x80\x892, if we define concert day as {1} and day-off as {0}, here are all possible tours: {0}, {1}, {00}, {01}, {10}, {11}. But tour 00 can not be selected because it has 2 days-off in a row. Now, we need to count in how many ways we can select k\xe2\x80\x89=\xe2\x80\x892 tours of the same length in range [1;2]. Here they are: {0,1}; {01,10}; {01,11}; {10,11}.Since their schedule is quite busy, they want you to tell them in how many ways can do that, modulo 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007 (109\xe2\x80\x89+\xe2\x80\x897)." 2900.0                                 
               716A "Crazy Computer" implementation "ZS the Coder is coding on a crazy computer. If you don\'t type in a word for a c consecutive seconds, everything you typed disappear! More formally, if you typed a word at second a and then the next word at second b, then if b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c, just the new word is appended to other words on the screen. If b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89>\xe2\x80\x89c, then everything on the screen disappears and after that the word you have typed appears on the screen.For example, if c\xe2\x80\x89=\xe2\x80\x895 and you typed words at seconds 1,\xe2\x80\x893,\xe2\x80\x898,\xe2\x80\x8914,\xe2\x80\x8919,\xe2\x80\x8920 then at the second 8 there will be 3 words on the screen. After that, everything disappears at the second 13 because nothing was typed. At the seconds 14 and 19 another two words are typed, and finally, at the second 20, one more word is typed, and a total of 3 words remain on the screen.You\'re given the times when ZS the Coder typed the words. Determine how many words remain on the screen after he finished typing everything." 800.0                                 
               712A "Memory and Crow" implementation,math "There are n integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn written in a row. For all i from 1 to n, values ai are defined by the crows performing the following procedure:  The crow sets ai initially 0.  The crow then adds bi to ai, subtracts bi\xe2\x80\x89+\xe2\x80\x891, adds the bi\xe2\x80\x89+\xe2\x80\x892 number, and so on until the n\'th number. Thus, ai\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x893.... Memory gives you the values a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, and he now wants you to find the initial numbers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn written in the row? Can you do it?" 800.0                                 
               710A "King Moves" implementation "The only king stands on the standard chess board. You are given his position in format ""cd"", where c is the column from \'a\' to \'h\' and d is the row from \'1\' to \'8\'. Find the number of moves permitted for the king.Check the king\'s moves here https://en.wikipedia.org/wiki/King_(chess).  King moves from the position e4" 800.0                                 
               708D "Incorrect Flow" flows "At the entrance examination for the magistracy of the MSU Cyber-Mechanics Department Sasha got the question about Ford-Fulkerson algorithm. He knew the topic perfectly as he worked with it many times on programming competition. As the task for the question he was given a network with partially build flow that he had to use in order to demonstrate the workflow of the algorithm. He quickly finished to write the text and took a look at the problem only to understand that the given network is incorrect!Suppose you are given a directed graph G(V,\xe2\x80\x89E) with two special nodes s and t called source and sink. We denote as n the number of nodes in the graph, i.e. n\xe2\x80\x89=\xe2\x80\x89|V| and m stands for the number of directed edges in the graph, i.e. m\xe2\x80\x89=\xe2\x80\x89|E|. For the purpose of this problem we always consider node 1 to be the source and node n to be the sink. In addition, for each edge of the graph e we define the capacity function c(e) and flow function f(e). Function f(e) represents the correct flow if the following conditions are satisfied:  For each edge  the flow is non-negative and does not exceed capacity c(e), i.e. 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89f(e)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c(e).  For each node , that is not source or sink (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s and v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t) the sum of flows of all edges going in v is equal to the sum of the flows among all edges going out from v. In other words, there is no flow stuck in v. It was clear that as the exam was prepared last night and there are plenty of mistakes in the tasks. Sasha asked one of the professors to fix the network or give the correct task, but the reply was that the magistrate student should be able to fix the network himself. As the professor doesn\'t want the task to become easier, he asks Sasha to fix the network in a such way that the total number of changes is minimum possible. Sasha is not allowed to remove edges, add new ones or reverse the direction of existing edges. The only thing he is able to do is to change capacity function c(e) and flow function f(e). Moreover, all the values should remain non-negative integers. There is no requirement on the flow to be maximum in any sense.Find the minimum possible total change of the functions f(e) and c(e) that Sasha has to make in order to make the flow correct. The total change is defined as the sum of absolute differences, i.e. if new functions are f\xe2\x80\x89*\xe2\x80\x89(e) and c\xe2\x80\x89*\xe2\x80\x89(e), then the total change is ." 2900.0                                 
               708A "Letters Cyclic Shift" "constructive algorithms,greedy,implementation,strings" "You are given a non-empty string s consisting of lowercase English letters. You have to pick exactly one non-empty substring of s and shift all its letters \'z\'  \'y\'  \'x\'  \'b\'  \'a\'  \'z\'. In other words, each character is replaced with the previous character of English alphabet and \'a\' is replaced with \'z\'.What is the lexicographically minimum string that can be obtained from s by performing this shift exactly once?" 1200.0                                 
               707E Garlands "data structures" "Like all children, Alesha loves New Year celebration. During the celebration he and his whole family dress up the fir-tree. Like all children, Alesha likes to play with garlands \xe2\x80\x94 chains consisting of a lightbulbs.Alesha uses a grid field sized n\xe2\x80\x89\xc3\x97\xe2\x80\x89m for playing. The rows of the field are numbered from 1 to n from the top to the bottom and columns are numbered from 1 to m from the left to the right.Alesha has k garlands which he places at the field. He does so in the way such that each lightbulb of each garland lies in the center of some cell in the field, and each cell contains at most one lightbulb. Of course lightbulbs, which are neighbours in some garland, appears in cells neighbouring by a side.The example of garland placing.Each garland is turned off or turned on at any moment. If some garland is turned on then each of its lightbulbs is turned on, the same applies for garland turned off. Each lightbulb in the whole garland set is unique, and thus, being turned on, brings Alesha some pleasure, described by an integer value. Turned off lightbulbs don\'t bring Alesha any pleasure.Alesha can turn garlands on and off and wants to know the sum of pleasure value which the lightbulbs, placed in the centers of the cells in some rectangular part of the field, bring him. Initially all the garlands are turned on.Alesha is still very little and can\'t add big numbers. He extremely asks you to help him." 2400.0                                 
               706E "Working routine" "data structures,implementation" "Vasiliy finally got to work, where there is a huge amount of tasks waiting for him. Vasiliy is given a matrix consisting of n rows and m columns and q tasks. Each task is to swap two submatrices of the given matrix.For each task Vasiliy knows six integers ai, bi, ci, di, hi, wi, where ai is the index of the row where the top-left corner of the first rectangle is located, bi is the index of its column, ci is the index of the row of the top-left corner of the second rectangle, di is the index of its column, hi is the height of the rectangle and wi is its width.It\'s guaranteed that two rectangles in one query do not overlap and do not touch, that is, no cell belongs to both rectangles, and no two cells belonging to different rectangles share a side. However, rectangles are allowed to share an angle.Vasiliy wants to know how the matrix will look like after all tasks are performed." 2500.0                                 
               704E "Iron Man" "data structures,geometry,trees" "Tony Stark is playing a game with his suits (they have auto-pilot now). He lives in Malibu. Malibu has n junctions numbered from 1 to n, connected with n\xe2\x80\x89-\xe2\x80\x891 roads. One can get from a junction to any other junction using these roads (graph of Malibu forms a tree).Tony has m suits. There\'s a special plan for each suit. The i-th suit will appear at the moment of time ti in the junction vi, and will move to junction ui using the shortest path between vi and ui with the speed ci roads per second (passing a junctions takes no time), and vanishing immediately when arriving at ui (if it reaches ui in time q, it\'s available there at moment q, but not in further moments). Also, suits move continuously (for example if vi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ui, at time  it\'s in the middle of a road. Please note that if vi\xe2\x80\x89=\xe2\x80\x89ui it means the suit will be at junction number vi only at moment ti and then it vanishes. An explosion happens if at any moment of time two suits share the same exact location (it may be in a junction or somewhere on a road; while appearing, vanishing or moving).Your task is to tell Tony the moment of the the first explosion (if there will be any)." 3300.0                                 
               702E "Analysis of Pathes in Functional Graph" "data structures,graphs" "You are given a functional graph. It is a directed graph, in which from each vertex goes exactly one arc. The vertices are numerated from 0 to n\xe2\x80\x89-\xe2\x80\x891.Graph is given as the array f0,\xe2\x80\x89f1,\xe2\x80\x89...,\xe2\x80\x89fn\xe2\x80\x89-\xe2\x80\x891, where fi \xe2\x80\x94 the number of vertex to which goes the only arc from the vertex i. Besides you are given array with weights of the arcs w0,\xe2\x80\x89w1,\xe2\x80\x89...,\xe2\x80\x89wn\xe2\x80\x89-\xe2\x80\x891, where wi \xe2\x80\x94 the arc weight from i to fi.  The graph from the first sample test. Also you are given the integer k (the length of the path) and you need to find for each vertex two numbers si and mi, where:  si \xe2\x80\x94 the sum of the weights of all arcs of the path with length equals to k which starts from the vertex i;  mi \xe2\x80\x94 the minimal weight from all arcs on the path with length k which starts from the vertex i. The length of the path is the number of arcs on this path." 2100.0                                 
               698D "Limak and Shooting Points" "brute force,geometry,math" "Bearland is a dangerous place. Limak can\xe2\x80\x99t travel on foot. Instead, he has k magic teleportation stones. Each stone can be used at most once. The i-th stone allows to teleport to a point (axi,\xe2\x80\x89ayi). Limak can use stones in any order.There are n monsters in Bearland. The i-th of them stands at (mxi,\xe2\x80\x89myi).The given k\xe2\x80\x89+\xe2\x80\x89n points are pairwise distinct.After each teleportation, Limak can shoot an arrow in some direction. An arrow will hit the first monster in the chosen direction. Then, both an arrow and a monster disappear. It\xe2\x80\x99s dangerous to stay in one place for long, so Limak can shoot only one arrow from one place.A monster should be afraid if it\xe2\x80\x99s possible that Limak will hit it. How many monsters should be afraid of Limak?" 2600.0                                 
               696D Legen... "data structures,dp,matrices,strings" "Barney was hanging out with Nora for a while and now he thinks he may have feelings for her. Barney wants to send her a cheesy text message and wants to make her as happy as possible.  Initially, happiness level of Nora is 0. Nora loves some pickup lines like ""I\'m falling for you"" and stuff. Totally, she knows n pickup lines, each consisting only of lowercase English letters, also some of them may be equal (in writing, but different in pronouncing or meaning though). Every time Nora sees i-th pickup line as a consecutive subsequence of Barney\'s text message her happiness level increases by ai. These substrings may overlap, for example, Nora will see the pickup line aa twice and the pickup line ab once in text message aaab.Due to texting app limits, Barney\'s text may have up to l characters.Barney asked you to help him make Nora as much happy as possible, it\'s gonna be legen..." 2500.0                                 
                    691A "Fashion in Berland" implementation "According to rules of the Berland fashion, a jacket should be fastened by all the buttons except only one, but not necessarily it should be the last one. Also if the jacket has only one button, it should be fastened, so the jacket will not swinging open.You are given a jacket with n buttons. Determine if it is fastened in a right way." 1000.0                            
                    690E2 "Photographs (II)"  "Zombies seem to have become much more intelligent lately \xe2\x80\x93 a few have somehow wandered into the base through the automatic gate. Heidi has had to beef up security, and a new gate has been installed. Unfortunately, now the questions being asked are more complicated, and even humans have trouble answering them. Can you still program the robot army to do this reliably?The new questions are of the following form: a grayscale photograph has been divided into several horizontal pieces, which have been arbitrarily rearranged. The task is to assemble the original image back from these pieces (somewhat like in a jigsaw puzzle). To further delay the zombies, significant Gaussian-distributed noise has been added to the image." 2600.0                            
                    690E1 "Photographs (I)"  "The Human-Cow Confederation (HC2), led by Heidi, has built a base where people and cows can hide, guarded from zombie attacks. The entrance to the base is protected by an automated gate which performs a kind of a Turing test: it shows the entering creature a photograph and asks them whether the top and bottom halves of this photograph have been swapped or not. A person (or even a cow) will have no problem answering such questions; on the other hand, a zombie would just randomly smash one of the two buttons.The creature is asked a series of such questions. If at least 75% of them are answered correctly, the gate is unlocked; otherwise, a side door opens, beneath which a huge fan is spinning...Heidi is now building a robot army to fight the zombies, and she wants the robots to also be able to enter the base. You are tasked with programming them to distinguish the images. The first two images from the test set. The first picture has been rearranged, but not the second." 1800.0                            
                    689B "Mike and Shortcuts" "dfs and similar,graphs,greedy,shortest paths" "Recently, Mike was very busy with studying for exams and contests. Now he is going to chill a bit by doing some sight seeing in the city.City consists of n intersections numbered from 1 to n. Mike starts walking from his house located at the intersection number 1 and goes along some sequence of intersections. Walking from intersection number i to intersection j requires |i\xe2\x80\x89-\xe2\x80\x89j| units of energy. The total energy spent by Mike to visit a sequence of intersections p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk is equal to  units of energy.Of course, walking would be boring if there were no shortcuts. A shortcut is a special path that allows Mike walking from one intersection to another requiring only 1 unit of energy. There are exactly n shortcuts in Mike\'s city, the ith of them allows walking from intersection i to intersection ai (i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891) (but not in the opposite direction), thus there is exactly one shortcut starting at each intersection. Formally, if Mike chooses a sequence p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk then for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k satisfying pi\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89api and api\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89pi Mike will spend only 1 unit of energy instead of |pi\xe2\x80\x89-\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891| walking from the intersection pi to intersection pi\xe2\x80\x89+\xe2\x80\x891. For example, if Mike chooses a sequence p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2\xe2\x80\x89=\xe2\x80\x89ap1,\xe2\x80\x89p3\xe2\x80\x89=\xe2\x80\x89ap2,\xe2\x80\x89...,\xe2\x80\x89pk\xe2\x80\x89=\xe2\x80\x89apk\xe2\x80\x89-\xe2\x80\x891, he spends exactly k\xe2\x80\x89-\xe2\x80\x891 units of total energy walking around them.Before going on his adventure, Mike asks you to find the minimum amount of energy required to reach each of the intersections from his home. Formally, for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n Mike is interested in finding minimum possible total energy of some sequence p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk\xe2\x80\x89=\xe2\x80\x89i." 1600.0                            
                    688A Opponents implementation "Arya has n opponents in the school. Each day he will fight with all opponents who are present this day. His opponents have some fighting plan that guarantees they will win, but implementing this plan requires presence of them all. That means if one day at least one of Arya\'s opponents is absent at the school, then Arya will beat all present opponents. Otherwise, if all opponents are present, then they will beat Arya.For each opponent Arya knows his schedule \xe2\x80\x94 whether or not he is going to present on each particular day. Tell him the maximum number of consecutive days that he will beat all present opponents.Note, that if some day there are no opponents present, Arya still considers he beats all the present opponents." 800.0                            
                    685C "Optimal Point" "binary search,math" "When the river brought Gerda to the house of the Old Lady who Knew Magic, this lady decided to make Gerda her daughter. She wants Gerda to forget about Kay, so she puts all the roses from the garden underground.Mole, who lives in this garden, now can watch the roses without going up to the surface. Typical mole is blind, but this mole was granted as special vision by the Old Lady. He can watch any underground objects on any distance, even through the obstacles and other objects. However, the quality of the picture depends on the Manhattan distance to object being observed.Mole wants to find an optimal point to watch roses, that is such point with integer coordinates that the maximum Manhattan distance to the rose is minimum possible.As usual, he asks you to help.Manhattan distance between points (x1,\xe2\x80\x89 y1,\xe2\x80\x89 z1) and (x2,\xe2\x80\x89 y2,\xe2\x80\x89 z2) is defined as |x1\xe2\x80\x89-\xe2\x80\x89x2|\xe2\x80\x89+\xe2\x80\x89|y1\xe2\x80\x89-\xe2\x80\x89y2|\xe2\x80\x89+\xe2\x80\x89|z1\xe2\x80\x89-\xe2\x80\x89z2|." 2900.0                            
                    683G "The Fraction" "*special problem" "Periodic decimal fraction is usually written as: [entire_part.non-periodic_part (period)]. Any simple fraction can be represented as a periodic decimal fraction and vice versa. For example, the decimal fraction 0.2(45) corresponds to a fraction 27\xe2\x80\x89/\xe2\x80\x89110. Your task is to convert the periodic fraction to a simple periodic fraction." 1900.0                            
                    683B "The Teacher of Physical Education" "*special problem" "n pupils came to Physical Education lesson. We know the name and the height of each pupil. Your task is to help the teacher of Physical Education to line up all pupils in non-decreasing order of their heights." 1600.0                            
                    682A "Alyona and Numbers" "constructive algorithms,math,number theory" "After finishing eating her bun, Alyona came up with two integers n and m. She decided to write down two columns of integers \xe2\x80\x94 the first column containing integers from 1 to n and the second containing integers from 1 to m. Now the girl wants to count how many pairs of integers she can choose, one from the first column and the other from the second column, such that their sum is divisible by 5.Formally, Alyona wants to count the number of pairs of integers (x,\xe2\x80\x89y) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m and  equals 0.As usual, Alyona has some troubles and asks you to help." 1100.0                            
                    681D "Gifts by the List" "constructive algorithms,dfs and similar,graphs,trees" "Sasha lives in a big happy family. At the Man\'s Day all the men of the family gather to celebrate it following their own traditions. There are n men in Sasha\'s family, so let\'s number them with integers from 1 to n.Each man has at most one father but may have arbitrary number of sons.Man number A is considered to be the ancestor of the man number B if at least one of the following conditions is satisfied:   A\xe2\x80\x89=\xe2\x80\x89B;  the man number A is the father of the man number B;  there is a man number C, such that the man number A is his ancestor and the man number C is the father of the man number B. Of course, if the man number A is an ancestor of the man number B and A\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89B, then the man number B is not an ancestor of the man number A.The tradition of the Sasha\'s family is to give gifts at the Man\'s Day. Because giving gifts in a normal way is boring, each year the following happens.  A list of candidates is prepared, containing some (possibly all) of the n men in some order.  Each of the n men decides to give a gift.  In order to choose a person to give a gift to, man A looks through the list and picks the first man B in the list, such that B is an ancestor of A and gives him a gift. Note that according to definition it may happen that a person gives a gift to himself.  If there is no ancestor of a person in the list, he becomes sad and leaves the celebration without giving a gift to anyone. This year you have decided to help in organizing celebration and asked each of the n men, who do they want to give presents to (this person is chosen only among ancestors). Are you able to make a list of candidates, such that all the wishes will be satisfied if they give gifts according to the process described above?" 2000.0                            
                    677C "Vanya and Label" bitmasks,combinatorics,implementation,strings "While walking down the street Vanya saw a label ""Hide&Seek"". Because he is a programmer, he used & as a bitwise AND for these two words represented as a integers in base 64 and got new word. Now Vanya thinks of some string s and wants to know the number of pairs of words of length |s| (length of s), such that their bitwise AND is equal to s. As this number can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897.To represent the string as a number in numeral system with base 64 Vanya uses the following rules:  digits from \'0\' to \'9\' correspond to integers from 0 to 9;  letters from \'A\' to \'Z\' correspond to integers from 10 to 35;  letters from \'a\' to \'z\' correspond to integers from 36 to 61;  letter \'-\' correspond to integer 62;  letter \'_\' correspond to integer 63." 1500.0                            
                    676E "The Last Fight Between Human and AI" math "100 years have passed since the last victory of the man versus computer in Go. Technologies made a huge step forward and robots conquered the Earth! It\'s time for the final fight between human and robot that will decide the faith of the planet.The following game was chosen for the fights: initially there is a polynomial P(x)\xe2\x80\x89=\xe2\x80\x89anxn\xe2\x80\x89+\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891xn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89a1x\xe2\x80\x89+\xe2\x80\x89a0,\xe2\x80\x89 with yet undefined coefficients and the integer k. Players alternate their turns. At each turn, a player pick some index j, such that coefficient aj that stay near xj is not determined yet and sets it to any value (integer or real, positive or negative, 0 is also allowed). Computer moves first. The human will be declared the winner if and only if the resulting polynomial will be divisible by Q(x)\xe2\x80\x89=\xe2\x80\x89x\xe2\x80\x89-\xe2\x80\x89k.Polynomial P(x) is said to be divisible by polynomial Q(x) if there exists a representation P(x)\xe2\x80\x89=\xe2\x80\x89B(x)Q(x), where B(x) is also some polynomial.Some moves have been made already and now you wonder, is it true that human can guarantee the victory if he plays optimally?" 2400.0                            
                    671D "Roads in Yusland" "data structures,dp,greedy" "Mayor of Yusland just won the lottery and decided to spent money on something good for town. For example, repair all the roads in the town.Yusland consists of n intersections connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. One can travel from any intersection to any other intersection using only these roads.There is only one road repairing company in town, named ""RC company"". Company\'s center is located at the intersection 1. RC company doesn\'t repair roads you tell them. Instead, they have workers at some intersections, who can repair only some specific paths. The i-th worker can be paid ci coins and then he repairs all roads on a path from ui to some vi that lies on the path from ui to intersection 1. Mayor asks you to choose the cheapest way to hire some subset of workers in order to repair all the roads in Yusland. It\'s allowed that some roads will be repaired more than once.If it\'s impossible to repair all roads print \xe2\x80\x89-\xe2\x80\x891." 2900.0                            
                    670F "Restore a Number" "brute force,constructive algorithms,strings" "Vasya decided to pass a very large integer n to Kate. First, he wrote that number as a string, then he appended to the right integer k \xe2\x80\x94 the number of digits in n. Magically, all the numbers were shuffled in arbitrary order while this note was passed to Kate. The only thing that Vasya remembers, is a non-empty substring of n (a substring of n is a sequence of consecutive digits of the number n).Vasya knows that there may be more than one way to restore the number n. Your task is to find the smallest possible initial integer n. Note that decimal representation of number n contained no leading zeroes, except the case the integer n was equal to zero itself (in this case a single digit 0 was used)." 2300.0                            
                    670D2 "Magic Powder - 2" "binary search,implementation" "The term of this problem is the same as the previous one, the only exception \xe2\x80\x94 increased restrictions." 1500.0                            
                    665F "Four Divisors" "data structures,dp,math,number theory,sortings,two pointers" "If an integer a is divisible by another integer b, then b is called the divisor of a.For example: 12 has positive 6 divisors. They are 1, 2, 3, 4, 6 and 12.Let\xe2\x80\x99s define a function D(n) \xe2\x80\x94 number of integers between 1 and n (inclusive) which has exactly four positive divisors.Between 1 and 10 only the integers 6, 8 and 10 has exactly four positive divisors. So, D(10)\xe2\x80\x89=\xe2\x80\x893.You are given an integer n. You have to calculate D(n)." 2400.0                            
                    665E "Beautiful Subarrays" "data structures,divide and conquer,strings,trees" "One day, ZS the Coder wrote down an array of integers a\xe2\x80\x89with elements a1,\xe2\x80\x89\xe2\x80\x89a2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89an.A subarray of the array a is a sequence al,\xe2\x80\x89\xe2\x80\x89al\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89ar for some integers (l,\xe2\x80\x89\xe2\x80\x89r) such that 1\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89l\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89r\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89n. ZS the Coder thinks that a subarray of a is beautiful if the bitwise xor of all the elements in the subarray is at least k.Help ZS the Coder find the number of beautiful subarrays of a!" 2100.0                            
                    663A Rebus "constructive algorithms,expression parsing,greedy,math" "You are given a rebus of form ? + ? - ? + ? = n, consisting of only question marks, separated by arithmetic operation \'+\' and \'-\', equality and positive integer n. The goal is to replace each question mark with some positive integer from 1 to n, such that equality holds." 1800.0                            
                    660F "Bear and Bowling 4" "binary search,data structures,divide and conquer,geometry,ternary search" "Limak is an old brown bear. He often goes bowling with his friends. Today he feels really good and tries to beat his own record!For rolling a ball one gets a score \xe2\x80\x94 an integer (maybe negative) number of points. Score for the i-th roll is multiplied by i and scores are summed up. So, for k rolls with scores s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk, the total score is . The total score is 0 if there were no rolls.Limak made n rolls and got score ai for the i-th of them. He wants to maximize his total score and he came up with an interesting idea. He can say that some first rolls were only a warm-up, and that he wasn\'t focused during the last rolls. More formally, he can cancel any prefix and any suffix of the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. It is allowed to cancel all rolls, or to cancel none of them.The total score is calculated as if there were only non-canceled rolls. So, the first non-canceled roll has score multiplied by 1, the second one has score multiplied by 2, and so on, till the last non-canceled roll.What maximum total score can Limak get?" 2500.0                            
                    659F "Polycarp and Hay" "dfs and similar,dsu,graphs,greedy,sortings" "The farmer Polycarp has a warehouse with hay, which can be represented as an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular table, where n is the number of rows, and m is the number of columns in the table. Each cell of the table contains a haystack. The height in meters of the hay located in the i-th row and the j-th column is equal to an integer ai,\xe2\x80\x89j and coincides with the number of cubic meters of hay in the haystack, because all cells have the size of the base 1\xe2\x80\x89\xc3\x97\xe2\x80\x891. Polycarp has decided to tidy up in the warehouse by removing an arbitrary integer amount of cubic meters of hay from the top of each stack. You can take different amounts of hay from different haystacks. Besides, it is allowed not to touch a stack at all, or, on the contrary, to remove it completely. If a stack is completely removed, the corresponding cell becomes empty and no longer contains the stack.Polycarp wants the following requirements to hold after the reorganization:  the total amount of hay remaining in the warehouse must be equal to k,  the heights of all stacks (i.e., cells containing a non-zero amount of hay) should be the same,  the height of at least one stack must remain the same as it was,  for the stability of the remaining structure all the stacks should form one connected region. The two stacks are considered adjacent if they share a side in the table. The area is called connected if from any of the stack in the area you can get to any other stack in this area, moving only to adjacent stacks. In this case two adjacent stacks necessarily belong to the same area.Help Polycarp complete this challenging task or inform that it is impossible." 2000.0                            
                    652E "Pursuit For Artifacts" "dfs and similar,dsu,graphs,trees" "Johnny is playing a well-known computer game. The game are in some country, where the player can freely travel, pass quests and gain an experience.In that country there are n islands and m bridges between them, so you can travel from any island to any other. In the middle of some bridges are lying ancient powerful artifacts. Johnny is not interested in artifacts, but he can get some money by selling some artifact.At the start Johnny is in the island a and the artifact-dealer is in the island b (possibly they are on the same island). Johnny wants to find some artifact, come to the dealer and sell it. The only difficulty is that bridges are too old and destroying right after passing over them. Johnnie\'s character can\'t swim, fly and teleport, so the problem became too difficult.Note that Johnny can\'t pass the half of the bridge, collect the artifact and return to the same island. Determine if Johnny can find some artifact and sell it." 2300.0                            
                    649A "\xd0\x9b\xd1\x8e\xd0\xb1\xd0\xb8\xd0\xbc\xd1\x8b\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0 \xd0\x9f\xd0\xbe\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0\xd1\x80\xd0\xbf\xd0\xb0" "constructive algorithms,implementation" "\xd0\x9f\xd0\xbe\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0\xd1\x80\xd0\xbf \xd0\xbc\xd0\xb5\xd1\x87\xd1\x82\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd0\xbc \xd0\xb8 \xd1\x84\xd0\xb0\xd0\xbd\xd0\xb0\xd1\x82\xd0\xb5\xd0\xb5\xd1\x82 \xd0\xbe\xd1\x82 \xd1\x81\xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xb9 \xd0\xb4\xd0\xb2\xd0\xbe\xd0\xb9\xd0\xba\xd0\xb8. \xd0\xa1\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb8 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb \xd0\xb5\xd0\xbc\xd1\x83 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xbd\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd1\x82\xd0\xbe, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb5 \xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd1\x83\xd1\x8e \xd1\x81\xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0 2. \xd0\x9f\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd1\x85 \xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an \xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 r \xe2\x80\x94 \xd0\xbc\xd0\xb0\xd0\xba\xd1\x81\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x83\xd1\x8e \xd1\x81\xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0 2, \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x83\xd1\x8e \xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe \xd0\xb8\xd0\xb7 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8. \xd0\x9a\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb ai, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xb5\xd0\xbb\xd1\x8f\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 r." 1000.0                            
                    645F "Cowslip Collections" "combinatorics,math,number theory" "In an attempt to make peace with the Mischievious Mess Makers, Bessie and Farmer John are planning to plant some flower gardens to complement the lush, grassy fields of Bovinia. As any good horticulturist knows, each garden they plant must have the exact same arrangement of flowers. Initially, Farmer John has n different species of flowers he can plant, with ai flowers of the i-th species.On each of the next q days, Farmer John will receive a batch of flowers of a new species. On day j, he will receive cj flowers of the same species, but of a different species from those Farmer John already has. Farmer John, knowing the right balance between extravagance and minimalism, wants exactly k species of flowers to be used. Furthermore, to reduce waste, each flower of the k species Farmer John chooses must be planted in some garden. And each of the gardens must be identical; that is to say that each of the k chosen species should have an equal number of flowers in each garden. As Farmer John is a proponent of national equality, he would like to create the greatest number of gardens possible.After receiving flowers on each of these q days, Farmer John would like to know the sum, over all possible choices of k species, of the maximum number of gardens he could create. Since this could be a large number, you should output your result modulo 109\xe2\x80\x89+\xe2\x80\x897." 2500.0                            
                    643G "Choosing Ads" "data structures" "One social network developer recently suggested a new algorithm of choosing ads for users.There are n slots which advertisers can buy. It is possible to buy a segment of consecutive slots at once. The more slots you own, the bigger are the chances your ad will be shown to users.Every time it is needed to choose ads to show, some segment of slots is picked by a secret algorithm. Then some advertisers are chosen. The only restriction is that it should be guaranteed for advertisers which own at least p% of slots composing this segment that their ad will be shown.From the other side, users don\'t like ads. So it was decided to show no more than  ads at once. You are asked to develop a system to sell segments of slots and choose ads in accordance with the rules described above." 3200.0                            
                    643D "Bearish Fanpages"  "There is a social website with n fanpages, numbered 1 through n. There are also n companies, and the i-th company owns the i-th fanpage.Recently, the website created a feature called following. Each fanpage must choose exactly one other fanpage to follow.The website doesn\xe2\x80\x99t allow a situation where i follows j and at the same time j follows i. Also, a fanpage can\'t follow itself.Let\xe2\x80\x99s say that fanpage i follows some other fanpage j0. Also, let\xe2\x80\x99s say that i is followed by k other fanpages j1,\xe2\x80\x89j2,\xe2\x80\x89...,\xe2\x80\x89jk. Then, when people visit fanpage i they see ads from k\xe2\x80\x89+\xe2\x80\x892 distinct companies: i,\xe2\x80\x89j0,\xe2\x80\x89j1,\xe2\x80\x89...,\xe2\x80\x89jk. Exactly ti people subscribe (like) the i-th fanpage, and each of them will click exactly one add. For each of k\xe2\x80\x89+\xe2\x80\x891 companies j0,\xe2\x80\x89j1,\xe2\x80\x89...,\xe2\x80\x89jk, exactly  people will click their ad. Remaining  people will click an ad from company i (the owner of the fanpage).The total income of the company is equal to the number of people who click ads from this copmany.Limak and Radewoosh ask you for help. Initially, fanpage i follows fanpage fi. Your task is to handle q queries of three types:  1 i j \xe2\x80\x94 fanpage i follows fanpage j from now. It\'s guaranteed that i didn\'t follow j just before the query. Note an extra constraint for the number of queries of this type (below, in the Input section).  2 i \xe2\x80\x94 print the total income of the i-th company.  3 \xe2\x80\x94 print two integers: the smallest income of one company and the biggest income of one company." 2900.0                            
                    643B "Bear and Two Paths" "constructive algorithms,graphs" "Bearland has n cities, numbered 1 through n. Cities are connected via bidirectional roads. Each road connects two distinct cities. No two roads connect the same pair of cities.Bear Limak was once in a city a and he wanted to go to a city b. There was no direct connection so he decided to take a long walk, visiting each city exactly once. Formally:   There is no road between a and b.  There exists a sequence (path) of n distinct cities v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vn that v1\xe2\x80\x89=\xe2\x80\x89a, vn\xe2\x80\x89=\xe2\x80\x89b and there is a road between vi and vi\xe2\x80\x89+\xe2\x80\x891 for . On the other day, the similar thing happened. Limak wanted to travel between a city c and a city d. There is no road between them but there exists a sequence of n distinct cities u1,\xe2\x80\x89u2,\xe2\x80\x89...,\xe2\x80\x89un that u1\xe2\x80\x89=\xe2\x80\x89c, un\xe2\x80\x89=\xe2\x80\x89d and there is a road between ui and ui\xe2\x80\x89+\xe2\x80\x891 for .Also, Limak thinks that there are at most k roads in Bearland. He wonders whether he remembers everything correctly.Given n, k and four distinct cities a, b, c, d, can you find possible paths (v1,\xe2\x80\x89...,\xe2\x80\x89vn) and (u1,\xe2\x80\x89...,\xe2\x80\x89un) to satisfy all the given conditions? Find any solution or print -1 if it\'s impossible." 1600.0                            
                    641G "Little Artem and Graph"  "Little Artem is given a graph, constructed as follows: start with some k-clique, then add new vertices one by one, connecting them to k already existing vertices that form a k-clique.Artem wants to count the number of spanning trees in this graph modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300.0                            
                    641F "Little Artem and 2-SAT"  "Little Artem is a very smart programmer. He knows many different difficult algorithms. Recently he has mastered in 2-SAT one.In computer science, 2-satisfiability (abbreviated as 2-SAT) is the special case of the problem of determining whether a conjunction (logical AND) of disjunctions (logical OR) have a solution, in which all disjunctions consist of no more than two arguments (variables). For the purpose of this problem we consider only 2-SAT formulas where each disjunction consists of exactly two arguments.Consider the following 2-SAT problem as an example: . Note that there might be negations in 2-SAT formula (like for x1 and for x4).Artem now tries to solve as many problems with 2-SAT as possible. He found a very interesting one, which he can not solve yet. Of course, he asks you to help him. The problem is: given two 2-SAT formulas f and g, determine whether their sets of possible solutions are the same. Otherwise, find any variables assignment x such that f(x)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89g(x)." 3000.0                            
                    639A "Bear and Displayed Friends" implementation "Limak is a little polar bear. He loves connecting with other bears via social networks. He has n friends and his relation with the i-th of them is described by a unique integer ti. The bigger this value is, the better the friendship is. No two friends have the same value ti.Spring is starting and the Winter sleep is over for bears. Limak has just woken up and logged in. All his friends still sleep and thus none of them is online. Some (maybe all) of them will appear online in the next hours, one at a time.The system displays friends who are online. On the screen there is space to display at most k friends. If there are more than k friends online then the system displays only k best of them \xe2\x80\x94 those with biggest ti.Your task is to handle queries of two types:  ""1 id"" \xe2\x80\x94 Friend id becomes online. It\'s guaranteed that he wasn\'t online before.  ""2 id"" \xe2\x80\x94 Check whether friend id is displayed by the system. Print ""YES"" or ""NO"" in a separate line. Are you able to help Limak and answer all queries of the second type?" 1200.0                            
                    638B "Making Genome in Berland" "*special problem,dfs and similar,strings" "Berland scientists face a very important task - given the parts of short DNA fragments, restore the dinosaur DNA! The genome of a berland dinosaur has noting in common with the genome that we\'ve used to: it can have 26 distinct nucleotide types, a nucleotide of each type can occur at most once. If we assign distinct English letters to all nucleotides, then the genome of a Berland dinosaur will represent a non-empty string consisting of small English letters, such that each letter occurs in it at most once.Scientists have n genome fragments that are represented as substrings (non-empty sequences of consecutive nucleotides) of the sought genome.You face the following problem: help scientists restore the dinosaur genome. It is guaranteed that the input is not contradictory and at least one suitable line always exists. When the scientists found out that you are a strong programmer, they asked you in addition to choose the one with the minimum length. If there are multiple such strings, choose any string." 1500.0                            
                    637C "Promocodes with Mistakes" "*special problem,brute force,constructive algorithms,implementation" "During a New Year special offer the ""Sudislavl Bars"" offered n promo codes. Each promo code consists of exactly six digits and gives right to one free cocktail at the bar ""Mosquito Shelter"". Of course, all the promocodes differ.As the ""Mosquito Shelter"" opens only at 9, and partying in Sudislavl usually begins at as early as 6, many problems may arise as to how to type a promotional code without errors. It is necessary to calculate such maximum k, that the promotional code could be uniquely identified if it was typed with no more than k errors. At that, k\xe2\x80\x89=\xe2\x80\x890 means that the promotional codes must be entered exactly.A mistake in this problem should be considered as entering the wrong numbers. For example, value ""123465"" contains two errors relative to promocode ""123456"". Regardless of the number of errors the entered value consists of exactly six digits." 1400.0                            
                    632F "Magic Matrix" "brute force,divide and conquer,graphs,matrices,trees" "You\'re given a matrix A of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n.Let\'s call the matrix with nonnegative elements magic if it is symmetric (so aij\xe2\x80\x89=\xe2\x80\x89aji), aii\xe2\x80\x89=\xe2\x80\x890 and aij\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89max(aik,\xe2\x80\x89ajk) for all triples i,\xe2\x80\x89j,\xe2\x80\x89k. Note that i,\xe2\x80\x89j,\xe2\x80\x89k do not need to be distinct.Determine if the matrix is magic.As the input/output can reach very huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 2400.0                            
                    632B "Alice, Bob, Two Teams" "brute force,constructive algorithms" "Alice and Bob are playing a game. The game involves splitting up game pieces into two teams. There are n pieces, and the i-th piece has a strength pi.The way to split up game pieces is split into several steps:  First, Alice will split the pieces into two different groups A and B. This can be seen as writing the assignment of teams of a piece in an n character string, where each character is A or B.  Bob will then choose an arbitrary prefix or suffix of the string, and flip each character in that suffix (i.e. change A to B and B to A). He can do this step at most once.  Alice will get all the pieces marked A and Bob will get all the pieces marked B. The strength of a player is then the sum of strengths of the pieces in the group.Given Alice\'s initial split into two teams, help Bob determine an optimal strategy. Return the maximum strength he can achieve." 1400.0                            
                    631D Messenger "data structures,hashing,implementation,string suffix structures,strings" "Each employee of the ""Blake Techologies"" company uses a special messaging app ""Blake Messenger"". All the stuff likes this app and uses it constantly. However, some important futures are missing. For example, many users want to be able to search through the message history. It was already announced that the new feature will appear in the nearest update, when developers faced some troubles that only you may help them to solve.All the messages are represented as a strings consisting of only lowercase English letters. In order to reduce the network load strings are represented in the special compressed form. Compression algorithm works as follows: string is represented as a concatenation of n blocks, each block containing only equal characters. One block may be described as a pair (li,\xe2\x80\x89ci), where li is the length of the i-th block and ci is the corresponding letter. Thus, the string s may be written as the sequence of pairs .Your task is to write the program, that given two compressed string t and s finds all occurrences of s in t. Developers know that there may be many such occurrences, so they only ask you to find the number of them. Note that p is the starting position of some occurrence of s in t if and only if tptp\xe2\x80\x89+\xe2\x80\x891...tp\xe2\x80\x89+\xe2\x80\x89|s|\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89s, where ti is the i-th character of string t.Note that the way to represent the string in compressed form may not be unique. For example string ""aaaa"" may be given as , , ..." 2100.0                            
                    631C Report "data structures,sortings" "Each month Blake gets the report containing main economic indicators of the company ""Blake Technologies"". There are n commodities produced by the company. For each of them there is exactly one integer in the final report, that denotes corresponding revenue. Before the report gets to Blake, it passes through the hands of m managers. Each of them may reorder the elements in some order. Namely, the i-th manager either sorts first ri numbers in non-descending or non-ascending order and then passes the report to the manager i\xe2\x80\x89+\xe2\x80\x891, or directly to Blake (if this manager has number i\xe2\x80\x89=\xe2\x80\x89m).Employees of the ""Blake Technologies"" are preparing the report right now. You know the initial sequence ai of length n and the description of each manager, that is value ri and his favourite order. You are asked to speed up the process and determine how the final report will look like." 1700.0                            
                    631A Interview "brute force,implementation" "Blake is a CEO of a large company called ""Blake Technologies"". He loves his company very much and he thinks that his company should be the best. That is why every candidate needs to pass through the interview that consists of the following problem.We define function f(x,\xe2\x80\x89l,\xe2\x80\x89r) as a bitwise OR of integers xl,\xe2\x80\x89xl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89xr, where xi is the i-th element of the array x. You are given two arrays a and b of length n. You need to determine the maximum value of sum f(a,\xe2\x80\x89l,\xe2\x80\x89r)\xe2\x80\x89+\xe2\x80\x89f(b,\xe2\x80\x89l,\xe2\x80\x89r) among all possible 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 900.0                            
                    630P "Area of a Star" geometry "It was decided in IT City to distinguish successes of local IT companies by awards in the form of stars covered with gold from one side. To order the stars it is necessary to estimate order cost that depends on the area of gold-plating. Write a program that can calculate the area of a star.A ""star"" figure having n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x895 corners where n is a prime number is constructed the following way. On the circle of radius r n points are selected so that the distances between the adjacent ones are equal. Then every point is connected by a segment with two maximally distant points. All areas bounded by the segments parts are the figure parts." 2100.0                            
                    630L "Cracking the Code" implementation,math "The protection of a popular program developed by one of IT City companies is organized the following way. After installation it outputs a random five digit number which should be sent in SMS to a particular phone number. In response an SMS activation code arrives.A young hacker Vasya disassembled the program and found the algorithm that transforms the shown number into the activation code. Note: it is clear that Vasya is a law-abiding hacker, and made it for a noble purpose \xe2\x80\x94 to show the developer the imperfection of their protection.The found algorithm looks the following way. At first the digits of the number are shuffled in the following order <first digit><third digit><fifth digit><fourth digit><second digit>. For example the shuffle of 12345 should lead to 13542. On the second stage the number is raised to the fifth power. The result of the shuffle and exponentiation of the number 12345 is 455 422 043 125 550 171 232. The answer is the 5 last digits of this result. For the number 12345 the answer should be 71232.Vasya is going to write a keygen program implementing this algorithm. Can you do the same?" 1400.0                            
                    630A "Again Twenty Five!" "number theory" "The HR manager was disappointed again. The last applicant failed the interview the same way as 24 previous ones. ""Do I give such a hard task?"" \xe2\x80\x94 the HR manager thought. ""Just raise number 5 to the power of n and get last two digits of the number. Yes, of course, n can be rather big, and one cannot find the power using a calculator, but we need people who are able to think, not just follow the instructions.""Could you pass the interview in the machine vision company in IT City?" 800.0                            
                    627E Orchestra "two pointers" "Paul is at the orchestra. The string section is arranged in an r\xe2\x80\x89\xc3\x97\xe2\x80\x89c rectangular grid and is filled with violinists with the exception of n violists. Paul really likes violas, so he would like to take a picture including at least k of them. Paul can take a picture of any axis-parallel rectangle in the orchestra. Count the number of possible pictures that Paul can take.Two pictures are considered to be different if the coordinates of corresponding rectangles are different." 3000.0                            
                    626E "Simple Skewness" "binary search,math,ternary search" "Define the simple skewness of a collection of numbers to be the collection\'s mean minus its median. You are given a list of n (not necessarily distinct) integers. Find the non-empty subset (with repetition) with the maximum simple skewness.The mean of a collection is the average of its elements. The median of a collection is its middle element when all of its elements are sorted, or the average of its two middle elements if it has even size." 2400.0                            
                    623E "Transforming Sequence" combinatorics,dp,fft,math "Let\'s define the transformation P of a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an as b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, where bi\xe2\x80\x89=\xe2\x80\x89a1 | a2 | ... | ai for all i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, where | is the bitwise OR operation.Vasya consequently applies the transformation P to all sequences of length n consisting of integers from 1 to 2k\xe2\x80\x89-\xe2\x80\x891 inclusive. He wants to know how many of these sequences have such property that their transformation is a strictly increasing sequence. Help him to calculate this number modulo 109\xe2\x80\x89+\xe2\x80\x897." 3300.0                            
                    623D Birthday greedy,math,probabilities "A MIPT student named Misha has a birthday today, and he decided to celebrate it in his country house in suburban Moscow. n friends came by, and after a typical party they decided to play blind man\'s buff.The birthday boy gets blindfolded and the other players scatter around the house. The game is played in several rounds. In each round, Misha catches exactly one of his friends and has to guess who it is. The probability of catching the i-th friend does not change between rounds and is equal to pi percent (as we know, it is directly proportional to the amount of alcohol consumed by the i-th friend) and p1\xe2\x80\x89+\xe2\x80\x89p2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89pn\xe2\x80\x89=\xe2\x80\x89100 holds. Misha has no information about who he caught. After Misha makes an attempt to guess the caught person, the round ends. Even then, Misha isn\'t told whether he guessed correctly, and a new round begins.The game ends when Misha guesses every friend at least once, that is, there exists such set of rounds k1,\xe2\x80\x89k2,\xe2\x80\x89...,\xe2\x80\x89kn, that during round number ki Misha caught the i-th friend and guessed him. Misha wants to minimize the expectation of the number of rounds of the game. Despite the fact that at any point in the game Misha has no information about who he has already guessed, his friends are honest, and if they see that the condition for the end of the game is fulfilled, the game ends immediately. Find the expectation of the number of rounds in the game if Misha plays optimally." 2700.0                            
                    622F "The Sum of the k-th Powers" math "There are well-known formulas: , , . Also mathematicians found similar formulas for higher degrees.Find the value of the sum  modulo 109\xe2\x80\x89+\xe2\x80\x897 (so you should find the remainder after dividing the answer by the value 109\xe2\x80\x89+\xe2\x80\x897)." 2600.0                            
                    621E "Wet Shark and Blocks" dp,matrices "There are b blocks of digits. Each one consisting of the same n digits, which are given to you in the input. Wet Shark must choose exactly one digit from each block and concatenate all of those digits together to form one large integer. For example, if he chooses digit 1 from the first block and digit 2 from the second block, he gets the integer 12. Wet Shark then takes this number modulo x. Please, tell him how many ways he can choose one digit from each block so that he gets exactly k as the final result. As this number may be too large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897.Note, that the number of ways to choose some digit in the block is equal to the number of it\'s occurrences. For example, there are 3 ways to choose digit 5 from block 3 5 6 7 8 9 5 1 1 1 1 5." 2000.0                            
                    618D "Hamiltonian Spanning Tree" "dfs and similar,dp,graph matchings,greedy,trees" "A group of n cities is connected by a network of roads. There is an undirected road between every pair of cities, so there are  roads in total. It takes exactly y seconds to traverse any single road.A spanning tree is a set of roads containing exactly n\xe2\x80\x89-\xe2\x80\x891 roads such that it\'s possible to travel between any two cities using only these roads.Some spanning tree of the initial network was chosen. For every road in this tree the time one needs to traverse this road was changed from y to x seconds. Note that it\'s not guaranteed that x is smaller than y.You would like to travel through all the cities using the shortest path possible. Given n, x, y and a description of the spanning tree that was chosen, find the cost of the shortest path that starts in any city, ends in any city and visits all cities exactly once." 2200.0                            
                    616E "Sum of Remainders" "implementation,math,number theory" "Calculate the value of the sum: n mod 1 + n mod 2 + n mod 3 + ... + n mod m. As the result can be very large, you should print the value modulo 109\xe2\x80\x89+\xe2\x80\x897 (the remainder when divided by 109\xe2\x80\x89+\xe2\x80\x897).The modulo operator a mod b stands for the remainder after dividing a by b. For example 10 mod 3 = 1." 2200.0                            
                    615E Hexagons "binary search,implementation,math" "Ayrat is looking for the perfect code. He decided to start his search from an infinite field tiled by hexagons. For convenience the coordinate system is introduced, take a look at the picture to see how the coordinates of hexagon are defined:   Ayrat is searching through the field. He started at point (0,\xe2\x80\x890) and is moving along the spiral (see second picture). Sometimes he forgets where he is now. Help Ayrat determine his location after n moves." 2100.0                            
                    613B Skills "binary search,brute force,dp,greedy,sortings,two pointers" "Lesha plays the recently published new version of the legendary game hacknet. In this version character skill mechanism was introduced. Now, each player character has exactly n skills. Each skill is represented by a non-negative integer ai \xe2\x80\x94 the current skill level. All skills have the same maximum level A.Along with the skills, global ranking of all players was added. Players are ranked according to the so-called Force. The Force of a player is the sum of the following values:  The number of skills that a character has perfected (i.e., such that ai\xe2\x80\x89=\xe2\x80\x89A), multiplied by coefficient cf. The minimum skill level among all skills (min ai), multiplied by coefficient cm. Now Lesha has m hacknetian currency units, which he is willing to spend. Each currency unit can increase the current level of any skill by 1 (if it\'s not equal to A yet). Help him spend his money in order to achieve the maximum possible value of the Force." 1900.0                            
                    611A "New Year and Days" implementation "Today is Wednesday, the third day of the week. What\'s more interesting is that tomorrow is the last day of the year 2015.Limak is a little polar bear. He enjoyed this year a lot. Now, he is so eager to the coming year 2016.Limak wants to prove how responsible a bear he is. He is going to regularly save candies for the entire year 2016! He considers various saving plans. He can save one candy either on some fixed day of the week or on some fixed day of the month.Limak chose one particular plan. He isn\'t sure how many candies he will save in the 2016 with his plan. Please, calculate it and tell him." 900.0                            
                    610B "Vika and Squares" "constructive algorithms,implementation" "Vika has n jars with paints of distinct colors. All the jars are numbered from 1 to n and the i-th jar contains ai liters of paint of color i.Vika also has an infinitely long rectangular piece of paper of width 1, consisting of squares of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891. Squares are numbered 1, 2, 3 and so on. Vika decided that she will start painting squares one by one from left to right, starting from the square number 1 and some arbitrary color. If the square was painted in color x, then the next square will be painted in color x\xe2\x80\x89+\xe2\x80\x891. In case of x\xe2\x80\x89=\xe2\x80\x89n, next square is painted in color 1. If there is no more paint of the color Vika wants to use now, then she stops.Square is always painted in only one color, and it takes exactly 1 liter of paint. Your task is to calculate the maximum number of squares that might be painted, if Vika chooses right color to paint the first square." 1300.0                            
                    609A "USB Flash Drives" greedy,implementation,sortings "Sean is trying to save a large file to a USB flash drive. He has n USB flash drives with capacities equal to a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an megabytes. The file size is equal to m megabytes. Find the minimum number of USB flash drives needed to write Sean\'s file, if he can split the file between drives." 800.0                            
                    607D "Power Tree" "data structures,trees" "Genos and Saitama went shopping for Christmas trees. However, a different type of tree caught their attention, the exalted Power Tree. A Power Tree starts out as a single root vertex indexed 1. A Power Tree grows through a magical phenomenon known as an update. In an update, a single vertex is added to the tree as a child of some other vertex.Every vertex in the tree (the root and all the added vertices) has some value vi associated with it. The power of a vertex is defined as the strength of the multiset composed of the value associated with this vertex (vi) and the powers of its direct children. The strength of a multiset is defined as the sum of all elements in the multiset multiplied by the number of elements in it. Or in other words for some multiset S: Saitama knows the updates that will be performed on the tree, so he decided to test Genos by asking him queries about the tree during its growth cycle.An update is of the form 1 p v, and adds a new vertex with value v as a child of vertex p.A query is of the form 2 u, and asks for the power of vertex u.Please help Genos respond to these queries modulo 109\xe2\x80\x89+\xe2\x80\x897." 2600.0                            
                    605A "Sorting Railway Cars" "constructive algorithms,greedy" "An infinitely long railway has a train consisting of n cars, numbered from 1 to n (the numbers of all the cars are distinct) and positioned in arbitrary order. David Blaine wants to sort the railway cars in the order of increasing numbers. In one move he can make one of the cars disappear from its place and teleport it either to the beginning of the train, or to the end of the train, at his desire. What is the minimum number of actions David Blaine needs to perform in order to sort the train?" 1600.0                            
                    603B "Moodular Arithmetic" "combinatorics,dfs and similar,dsu,math,number theory" "As behooves any intelligent schoolboy, Kevin Sun is studying psycowlogy, cowculus, and cryptcowgraphy at the Bovinia State University (BGU) under Farmer Ivan. During his Mathematics of Olympiads (MoO) class, Kevin was confronted with a weird functional equation and needs your help. For two fixed integers k and p, where p is an odd prime number, the functional equation states that  for some function . (This equation should hold for any integer x in the range 0 to p\xe2\x80\x89-\xe2\x80\x891, inclusive.)It turns out that f can actually be many different functions. Instead of finding a solution, Kevin wants you to count the number of distinct functions f that satisfy this equation. Since the answer may be very large, you should print your result modulo 109\xe2\x80\x89+\xe2\x80\x897." 1800.0                            
                    602B "Approximating a Constant Range" "dp,implementation,two pointers" "When Xellos was doing a practice course in university, he once had to measure the intensity of an effect that slowly approached equilibrium. A good way to determine the equilibrium intensity would be choosing a sufficiently large number of consecutive data points that seems as constant as possible and taking their average. Of course, with the usual sizes of data, it\'s nothing challenging \xe2\x80\x94 but why not make a similar programming contest problem while we\'re at it?You\'re given a sequence of n data points a1,\xe2\x80\x89...,\xe2\x80\x89an. There aren\'t any big jumps between consecutive data points \xe2\x80\x94 for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n, it\'s guaranteed that |ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89ai|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891.A range [l,\xe2\x80\x89r] of data points is said to be almost constant if the difference between the largest and the smallest value in that range is at most 1. Formally, let M be the maximum and m the minimum value of ai for l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r; the range [l,\xe2\x80\x89r] is almost constant if M\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891.Find the length of the longest almost constant range." 1400.0                            
                    600E "Lomsat gelral" "data structures,dfs and similar,dsu,trees" "You are given a rooted tree with root in vertex 1. Each vertex is coloured in some colour.Let\'s call colour c dominating in the subtree of vertex v if there are no other colours that appear in the subtree of vertex v more times than colour c. So it\'s possible that two or more colours will be dominating in the subtree of some vertex.The subtree of vertex v is the vertex v and all other vertices that contains vertex v in each path to the root.For each vertex v find the sum of all dominating colours in the subtree of vertex v." 2300.0                            
                    598F "Cut Length" geometry "Given simple (without self-intersections) n-gon. It is not necessary convex. Also you are given m lines. For each line find the length of common part of the line and the n-gon.The boundary of n-gon belongs to polygon. It is possible that n-gon contains 180-degree angles." 2900.0                            
                    598D "Igor In the Museum" "dfs and similar,graphs,shortest paths" "Igor is in the museum and he wants to see as many pictures as possible.Museum can be represented as a rectangular field of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells. Each cell is either empty or impassable. Empty cells are marked with \'.\', impassable cells are marked with \'*\'. Every two adjacent cells of different types (one empty and one impassable) are divided by a wall containing one picture.At the beginning Igor is in some empty cell. At every moment he can move to any empty cell that share a side with the current one.For several starting positions you should calculate the maximum number of pictures that Igor can see. Igor is able to see the picture only if he is in the cell adjacent to the wall with this picture. Igor have a lot of time, so he will examine every picture he can see." 1700.0                            
                    597C Subsequences "data structures,dp" "For the given sequence with n different elements find the number of increasing subsequences with k\xe2\x80\x89+\xe2\x80\x891 elements. It is guaranteed that the answer is not greater than 8\xc2\xb71018." 1900.0                            
                    596C "Wilbur and Points" combinatorics,greedy,sortings "Wilbur is playing with a set of n points on the coordinate plane. All points have non-negative integer coordinates. Moreover, if some point (x, y) belongs to the set, then all points (x\', y\'), such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\'\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\'\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y also belong to this set.Now Wilbur wants to number the points in the set he has, that is assign them distinct integer numbers from 1 to n. In order to make the numbering aesthetically pleasing, Wilbur imposes the condition that if some point (x, y) gets number i, then all (x\',y\') from the set, such that x\'\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89x and y\'\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89y must be assigned a number not less than i. For example, for a set of four points (0, 0), (0, 1), (1, 0) and (1, 1), there are two aesthetically pleasing numberings. One is 1, 2, 3, 4 and another one is 1, 3, 2, 4.Wilbur\'s friend comes along and challenges Wilbur. For any point he defines it\'s special value as s(x,\xe2\x80\x89y)\xe2\x80\x89=\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89x. Now he gives Wilbur some w1, w2,..., wn, and asks him to find an aesthetically pleasing numbering of the points in the set, such that the point that gets number i has it\'s special value equal to wi, that is s(xi,\xe2\x80\x89yi)\xe2\x80\x89=\xe2\x80\x89yi\xe2\x80\x89-\xe2\x80\x89xi\xe2\x80\x89=\xe2\x80\x89wi.Now Wilbur asks you to help him with this challenge." 1700.0                            
                    596B "Wilbur and Array" greedy,implementation "Wilbur the pig is tinkering with arrays again. He has the array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an initially consisting of n zeros. At one step, he can choose any index i and either add 1 to all elements ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89... ,\xe2\x80\x89an or subtract 1 from all elements ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89an. His goal is to end up with the array b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn. Of course, Wilbur wants to achieve this goal in the minimum number of steps and asks you to compute this value." 1100.0                            
                    594B "Max and Bike" "binary search,geometry" "For months Maxim has been coming to work on his favorite bicycle. And quite recently he decided that he is ready to take part in a cyclists\' competitions.He knows that this year n competitions will take place. During the i-th competition the participant must as quickly as possible complete a ride along a straight line from point si to point fi (si\xe2\x80\x89<\xe2\x80\x89fi).Measuring time is a complex process related to usage of a special sensor and a time counter. Think of the front wheel of a bicycle as a circle of radius r. Let\'s neglect the thickness of a tire, the size of the sensor, and all physical effects. The sensor is placed on the rim of the wheel, that is, on some fixed point on a circle of radius r. After that the counter moves just like the chosen point of the circle, i.e. moves forward and rotates around the center of the circle.At the beginning each participant can choose any point bi, such that his bike is fully behind the starting line, that is, bi\xe2\x80\x89<\xe2\x80\x89si\xe2\x80\x89-\xe2\x80\x89r. After that, he starts the movement, instantly accelerates to his maximum speed and at time tsi, when the coordinate of the sensor is equal to the coordinate of the start, the time counter starts. The cyclist makes a complete ride, moving with his maximum speed and at the moment the sensor\'s coordinate is equal to the coordinate of the finish (moment of time tfi), the time counter deactivates and records the final time. Thus, the counter records that the participant made a complete ride in time tfi\xe2\x80\x89-\xe2\x80\x89tsi.  Maxim is good at math and he suspects that the total result doesn\'t only depend on his maximum speed v, but also on his choice of the initial point bi. Now Maxim is asking you to calculate for each of n competitions the minimum possible time that can be measured by the time counter. The radius of the wheel of his bike is equal to r." 2500.0                            
                    593C "Beautiful Function" "constructive algorithms,math" "Every day Ruslan tried to count sheep to fall asleep, but this didn\'t help. Now he has found a more interesting thing to do. First, he thinks of some set of circles on a plane, and then tries to choose a beautiful set of points, such that there is at least one point from the set inside or on the border of each of the imagined circles.Yesterday Ruslan tried to solve this problem for the case when the set of points is considered beautiful if it is given as (xt\xe2\x80\x89=\xe2\x80\x89f(t),\xe2\x80\x89yt\xe2\x80\x89=\xe2\x80\x89g(t)), where argument t takes all integer values from 0 to 50. Moreover, f(t) and g(t) should be correct functions.Assume that w(t) and h(t) are some correct functions, and c is an integer ranging from 0 to 50. The function s(t) is correct if it\'s obtained by one of the following rules:  s(t)\xe2\x80\x89=\xe2\x80\x89abs(w(t)), where abs(x) means taking the absolute value of a number x, i.e. |x|; s(t)\xe2\x80\x89=\xe2\x80\x89(w(t)\xe2\x80\x89+\xe2\x80\x89h(t)); s(t)\xe2\x80\x89=\xe2\x80\x89(w(t)\xe2\x80\x89-\xe2\x80\x89h(t)); s(t)\xe2\x80\x89=\xe2\x80\x89(w(t)\xe2\x80\x89*\xe2\x80\x89h(t)), where \xe2\x80\x89*\xe2\x80\x89 means multiplication, i.e. (w(t)\xc2\xb7h(t)); s(t)\xe2\x80\x89=\xe2\x80\x89c; s(t)\xe2\x80\x89=\xe2\x80\x89t;Yesterday Ruslan thought on and on, but he could not cope with the task. Now he asks you to write a program that computes the appropriate f(t) and g(t) for any set of at most 50 circles.In each of the functions f(t) and g(t) you are allowed to use no more than 50 multiplications. The length of any function should not exceed 100\xc2\xb7n characters. The function should not contain spaces.Ruslan can\'t keep big numbers in his memory, so you should choose f(t) and g(t), such that for all integer t from 0 to 50 value of f(t) and g(t) and all the intermediate calculations won\'t exceed 109 by their absolute value." 2200.0                            
                    587E "Duff as a Queen" "data structures" "Duff is the queen of her country, Andarz Gu. She\'s a competitive programming fan. That\'s why, when he saw her minister, Malek, free, she gave her a sequence consisting of n non-negative integers, a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and asked him to perform q queries for her on this sequence.  There are two types of queries:  given numbers l,\xe2\x80\x89r and k, Malek should perform  for each l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r (, bitwise exclusive OR of numbers a and b).  given numbers l and r Malek should tell her the score of sequence al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89... ,\xe2\x80\x89ar. Score of a sequence b1,\xe2\x80\x89...,\xe2\x80\x89bk is the number of its different Kheshtaks. A non-negative integer w is a Kheshtak of this sequence if and only if there exists a subsequence of b, let\'s denote it as bi1,\xe2\x80\x89bi2,\xe2\x80\x89... ,\xe2\x80\x89bix (possibly empty) such that  (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ix\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k). If this subsequence is empty, then w\xe2\x80\x89=\xe2\x80\x890.Unlike Duff, Malek is not a programmer. That\'s why he asked for your help. Please help him perform these queries." 2900.0                            
                    585A "Gennady the Dentist" "brute force,implementation" "Gennady is one of the best child dentists in Berland. Today n children got an appointment with him, they lined up in front of his office.All children love to cry loudly at the reception at the dentist. We enumerate the children with integers from 1 to n in the order they go in the line. Every child is associated with the value of his cofidence pi. The children take turns one after another to come into the office; each time the child that is the first in the line goes to the doctor.While Gennady treats the teeth of the i-th child, the child is crying with the volume of vi. At that the confidence of the first child in the line is reduced by the amount of vi, the second one \xe2\x80\x94 by value vi\xe2\x80\x89-\xe2\x80\x891, and so on. The children in the queue after the vi-th child almost do not hear the crying, so their confidence remains unchanged.If at any point in time the confidence of the j-th child is less than zero, he begins to cry with the volume of dj and leaves the line, running towards the exit, without going to the doctor\'s office. At this the confidence of all the children after the j-th one in the line is reduced by the amount of dj.All these events occur immediately one after the other in some order. Some cries may lead to other cries, causing a chain reaction. Once in the hallway it is quiet, the child, who is first in the line, goes into the doctor\'s office.Help Gennady the Dentist to determine the numbers of kids, whose teeth he will cure. Print their numbers in the chronological order." 1800.0                            
                    581C "Developing Skills" implementation,math,sortings "Petya loves computer games. Finally a game that he\'s been waiting for so long came out!The main character of this game has n different skills, each of which is characterized by an integer ai from 0 to 100. The higher the number ai is, the higher is the i-th skill of the character. The total rating of the character is calculated as the sum of the values \xe2\x80\x8b\xe2\x80\x8bof  for all i from 1 to n. The expression \xe2\x8c\x8a x\xe2\x8c\x8b denotes the result of rounding the number x down to the nearest integer.At the beginning of the game Petya got k improvement units as a bonus that he can use to increase the skills of his character and his total rating. One improvement unit can increase any skill of Petya\'s character by exactly one. For example, if a4\xe2\x80\x89=\xe2\x80\x8946, after using one imporvement unit to this skill, it becomes equal to 47. A hero\'s skill cannot rise higher more than 100. Thus, it is permissible that some of the units will remain unused.Your task is to determine the optimal way of using the improvement units so as to maximize the overall rating of the character. It is not necessary to use all the improvement units." 1400.0                            
                    579B "Finding Team Member" "brute force,implementation,sortings" "There is a programing contest named SnakeUp, 2n people want to compete for it. In order to attend this contest, people need to form teams of exactly two people. You are given the strength of each possible combination of two people. All the values of the strengths are distinct.Every contestant hopes that he can find a teammate so that their team\xe2\x80\x99s strength is as high as possible. That is, a contestant will form a team with highest strength possible by choosing a teammate from ones who are willing to be a teammate with him/her. More formally, two people A and B may form a team if each of them is the best possible teammate (among the contestants that remain unpaired) for the other one. Can you determine who will be each person\xe2\x80\x99s teammate?" 1300.0                            
                    576D "Flights for Regular Customers" dp,matrices "In the country there are exactly n cities numbered with positive integers from 1 to n. In each city there is an airport is located.Also, there is the only one airline, which makes m flights. Unfortunately, to use them, you need to be a regular customer of this company, namely, you have the opportunity to enjoy flight i from city ai to city bi only if you have already made at least di flights before that.Please note that flight i flies exactly from city ai to city bi. It can not be used to fly from city bi to city ai. An interesting fact is that there may possibly be recreational flights with a beautiful view of the sky, which begin and end in the same city.You need to get from city 1 to city n. Unfortunately, you\'ve never traveled by plane before. What minimum number of flights you have to perform in order to get to city n?Note that the same flight can be used multiple times." 2700.0                            
                    575C Party "bitmasks,brute force,graph matchings" "Note the unusual memory limit for the problem.People working in MDCS (Microsoft Development Center Serbia) like partying. They usually go to night clubs on Friday and Saturday.There are N people working in MDCS and there are N clubs in the city. Unfortunately, if there is more than one Microsoft employee in night club, level of coolness goes infinitely high and party is over, so club owners will never let more than one Microsoft employee enter their club in the same week (just to be sure).You are organizing night life for Microsoft employees and you have statistics about how much every employee likes Friday and Saturday parties for all clubs.You need to match people with clubs maximizing overall sum of their happiness (they are happy as much as they like the club), while half of people should go clubbing on Friday and the other half on Saturday." 2700.0                            
                    575A Fibonotci "data structures,math,matrices" "Fibonotci sequence is an integer recursive sequence defined by the recurrence relation  Fn\xe2\x80\x89=\xe2\x80\x89sn\xe2\x80\x89-\xe2\x80\x891\xc2\xb7Fn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89sn\xe2\x80\x89-\xe2\x80\x892\xc2\xb7Fn\xe2\x80\x89-\xe2\x80\x892  with  F0\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x89F1\xe2\x80\x89=\xe2\x80\x891 Sequence s is an infinite and almost cyclic sequence with a cycle of length N. A sequence s is called almost cyclic with a cycle of length N if , for i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89N, except for a finite number of values si, for which  (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89N).Following is an example of an almost cyclic sequence with a cycle of length 4:  s = (5,3,8,11,5,3,7,11,5,3,8,11,\xe2\x80\xa6) Notice that the only value of s for which the equality  does not hold is s6 (s6\xe2\x80\x89=\xe2\x80\x897 and s2\xe2\x80\x89=\xe2\x80\x898). You are given s0,\xe2\x80\x89s1,\xe2\x80\x89...sN\xe2\x80\x89-\xe2\x80\x891 and all the values of sequence s for which  (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89N).Find ." 2700.0                            
                    571E "Geometric Progressions" math "Geometric progression with the first element a and common ratio b is a sequence of numbers a,\xe2\x80\x89ab,\xe2\x80\x89ab2,\xe2\x80\x89ab3,\xe2\x80\x89....You are given n integer geometric progressions. Your task is to find the smallest integer x, that is the element of all the given progressions, or else state that such integer does not exist." 3200.0                            
                    571C "CNF 2" "constructive algorithms,dfs and similar,graphs,greedy" "\'In Boolean logic, a formula is in conjunctive normal form (CNF) or clausal normal form if it is a conjunction of clauses, where a clause is a disjunction of literals\' (cited from https://en.wikipedia.org/wiki/Conjunctive_normal_form)In the other words, CNF is a formula of type , where & represents a logical ""AND"" (conjunction),  represents a logical ""OR"" (disjunction), and vij are some boolean variables or their negations. Each statement in brackets is called a clause, and vij are called literals.You are given a CNF containing variables x1,\xe2\x80\x89...,\xe2\x80\x89xm and their negations. We know that each variable occurs in at most two clauses (with negation and without negation in total). Your task is to determine whether this CNF is satisfiable, that is, whether there are such values of variables where the CNF value is true. If CNF is satisfiable, then you also need to determine the values of the variables at which the CNF is true. It is guaranteed that each variable occurs at most once in each clause." 2500.0                            
                    568A "Primes or Palindromes?" "brute force,implementation,math,number theory" "Rikhail Mubinchik believes that the current definition of prime numbers is obsolete as they are too complex and unpredictable. A palindromic number is another matter. It is aesthetically pleasing, and it has a number of remarkable properties. Help Rikhail to convince the scientific community in this!Let us remind you that a number is called prime if it is integer larger than one, and is not divisible by any positive integer other than itself and one.Rikhail calls a number a palindromic if it is integer, positive, and its decimal representation without leading zeros is a palindrome, i.e. reads the same from left to right and right to left.One problem with prime numbers is that there are too many of them. Let\'s introduce the following notation: \xcf\x80(n) \xe2\x80\x94 the number of primes no larger than n, rub(n) \xe2\x80\x94 the number of palindromic numbers no larger than n. Rikhail wants to prove that there are a lot more primes than palindromic ones.He asked you to solve the following problem: for a given value of the coefficient A find the maximum n, such that \xcf\x80(n)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89A\xc2\xb7rub(n)." 1600.0                            
                    566C "Logistical Questions" "dfs and similar,divide and conquer,trees" "Some country consists of n cities, connected by a railroad network. The transport communication of the country is so advanced that the network consists of a minimum required number of (n\xe2\x80\x89-\xe2\x80\x891) bidirectional roads (in the other words, the graph of roads is a tree). The i-th road that directly connects cities ai and bi, has the length of li kilometers.The transport network is served by a state transporting company FRR (Fabulous Rail Roads). In order to simplify the price policy, it offers a single ride fare on the train. In order to follow the route of length t kilometers, you need to pay  burles. Note that it is forbidden to split a long route into short segments and pay them separately (a special railroad police, or RRP, controls that the law doesn\'t get violated).A Large Software Company decided to organize a programming tournament. Having conducted several online rounds, the company employees determined a list of finalists and sent it to the logistical department to find a place where to conduct finals. The Large Software Company can easily organize the tournament finals in any of the n cities of the country, so the the main factor in choosing the city for the last stage of the tournament is the total cost of buying tickets for all the finalists. We know that the i-th city of the country has wi cup finalists living there.Help the company employees find the city such that the total cost of travel of all the participants to it is minimum." 3000.0                            
                    558A "Lala Land and Apple Trees" "brute force,implementation,sortings" "Amr lives in Lala Land. Lala Land is a very beautiful country that is located on a coordinate line. Lala Land is famous with its apple trees growing everywhere.Lala Land has exactly n apple trees. Tree number i is located in a position xi and has ai apples growing on it. Amr wants to collect apples from the apple trees. Amr currently stands in x\xe2\x80\x89=\xe2\x80\x890 position. At the beginning, he can choose whether to go right or left. He\'ll continue in his direction until he meets an apple tree he didn\'t visit before. He\'ll take all of its apples and then reverse his direction, continue walking in this direction until he meets another apple tree he didn\'t visit before and so on. In the other words, Amr reverses his direction when visiting each new apple tree. Amr will stop collecting apples when there are no more trees he didn\'t visit in the direction he is facing.What is the maximum number of apples he can collect?" 1100.0                            
                    557A "Ilya and Diplomas" greedy,implementation,math "Soon a school Olympiad in Informatics will be held in Berland, n schoolchildren will participate there.At a meeting of the jury of the Olympiad it was decided that each of the n participants, depending on the results, will get a diploma of the first, second or third degree. Thus, each student will receive exactly one diploma.They also decided that there must be given at least min1 and at most max1 diplomas of the first degree, at least min2 and at most max2 diplomas of the second degree, and at least min3 and at most max3 diplomas of the third degree.After some discussion it was decided to choose from all the options of distributing diplomas satisfying these limitations the one that maximizes the number of participants who receive diplomas of the first degree. Of all these options they select the one which maximizes the number of the participants who receive diplomas of the second degree. If there are multiple of these options, they select the option that maximizes the number of diplomas of the third degree.Choosing the best option of distributing certificates was entrusted to Ilya, one of the best programmers of Berland. However, he found more important things to do, so it is your task now to choose the best option of distributing of diplomas, based on the described limitations.It is guaranteed that the described limitations are such that there is a way to choose such an option of distributing diplomas that all n participants of the Olympiad will receive a diploma of some degree." 1100.0                            
                    555B "Case of Fugitive" "data structures,greedy,sortings" "Andrewid the Android is a galaxy-famous detective. He is now chasing a criminal hiding on the planet Oxa-5, the planet almost fully covered with water.The only dry land there is an archipelago of n narrow islands located in a row. For more comfort let\'s represent them as non-intersecting segments on a straight line: island i has coordinates [li,\xe2\x80\x89ri], besides, ri\xe2\x80\x89<\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891 for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891.To reach the goal, Andrewid needs to place a bridge between each pair of adjacent islands. A bridge of length a can be placed between the i-th and the (i\xe2\x80\x89+\xe2\x80\x891)-th islads, if there are such coordinates of x and y, that li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri, li\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89+\xe2\x80\x891 and y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89=\xe2\x80\x89a. The detective was supplied with m bridges, each bridge can be used at most once. Help him determine whether the bridges he got are enough to connect each pair of adjacent islands." 2000.0                            
                    555A "Case of Matryoshkas" implementation "Andrewid the Android is a galaxy-famous detective. He is now investigating the case of vandalism at the exhibition of contemporary art.The main exhibit is a construction of n matryoshka dolls that can be nested one into another. The matryoshka dolls are numbered from 1 to n. A matryoshka with a smaller number can be nested in a matryoshka with a higher number, two matryoshkas can not be directly nested in the same doll, but there may be chain nestings, for example, 1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x892\xe2\x80\x89\xe2\x86\x92\xe2\x80\x894\xe2\x80\x89\xe2\x86\x92\xe2\x80\x895. In one second, you can perform one of the two following operations:  Having a matryoshka a that isn\'t nested in any other matryoshka and a matryoshka b, such that b doesn\'t contain any other matryoshka and is not nested in any other matryoshka, you may put a in b;  Having a matryoshka a directly contained in matryoshka b, such that b is not nested in any other matryoshka, you may get a out of b. According to the modern aesthetic norms the matryoshka dolls on display were assembled in a specific configuration, i.e. as several separate chains of nested matryoshkas, but the criminal, following the mysterious plan, took out all the dolls and assembled them into a single large chain (1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x892\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89n). In order to continue the investigation Andrewid needs to know in what minimum time it is possible to perform this action." 1500.0                            
                    553A "Kyoya and Colored Balls" combinatorics,dp,math "Kyoya Ootori has a bag with n colored balls that are colored with k different colors. The colors are labeled from 1 to k. Balls of the same color are indistinguishable. He draws balls from the bag one by one until the bag is empty. He noticed that he drew the last ball of color i before drawing the last ball of color i\xe2\x80\x89+\xe2\x80\x891 for all i from 1 to k\xe2\x80\x89-\xe2\x80\x891. Now he wonders how many different ways this can happen." 1500.0                            
                    552D "Vanya and Triangles" "brute force,combinatorics,data structures,geometry,math,sortings" "Vanya got bored and he painted n distinct points on the plane. After that he connected all the points pairwise and saw that as a result many triangles were formed with vertices in the painted points. He asks you to count the number of the formed triangles with the non-zero area." 1900.0                            
                    552A "Vanya and Table" implementation,math "Vanya has a table consisting of 100 rows, each row contains 100 cells. The rows are numbered by integers from 1 to 100 from bottom to top, the columns are numbered from 1 to 100 from left to right. In this table, Vanya chose n rectangles with sides that go along borders of squares (some rectangles probably occur multiple times). After that for each cell of the table he counted the number of rectangles it belongs to and wrote this number into it. Now he wants to find the sum of values in all cells of the table and as the table is too large, he asks you to help him find the result." 1000.0                            
                    550E "Brackets in Implications" "constructive algorithms,greedy,implementation,math" "Implication is a function of two logical arguments, its value is false if and only if the value of the first argument is true and the value of the second argument is false. Implication is written by using character \'\', and the arguments and the result of the implication are written as \'0\' (false) and \'1\' (true). According to the definition of the implication:   When a logical expression contains multiple implications, then when there are no brackets, it will be calculated from left to fight. For example,. When there are brackets, we first calculate the expression in brackets. For example,.For the given logical expression  determine if it is possible to place there brackets so that the value of a logical expression is false. If it is possible, your task is to find such an arrangement of brackets." 2200.0                            
                    549F "Yura and Developers" "data structures,divide and conquer" "Yura has a team of k developers and a list of n tasks numbered from 1 to n. Yura is going to choose some tasks to be done this week. Due to strange Looksery habits the numbers of chosen tasks should be a segment of consecutive integers containing no less than 2 numbers, i. e. a sequence of form l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r for some 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Every task i has an integer number ai associated with it denoting how many man-hours are required to complete the i-th task. Developers are not self-confident at all, and they are actually afraid of difficult tasks. Knowing that, Yura decided to pick up a hardest task (the one that takes the biggest number of man-hours to be completed, among several hardest tasks with same difficulty level he chooses arbitrary one) and complete it on his own. So, if tasks with numbers [l,\xe2\x80\x89r] are chosen then the developers are left with r\xe2\x80\x89-\xe2\x80\x89l tasks to be done by themselves. Every developer can spend any integer amount of hours over any task, but when they are done with the whole assignment there should be exactly ai man-hours spent over the i-th task. The last, but not the least problem with developers is that one gets angry if he works more than another developer. A set of tasks [l,\xe2\x80\x89r] is considered good if it is possible to find such a distribution of work that allows to complete all the tasks and to have every developer working for the same amount of time (amount of work performed by Yura doesn\'t matter for other workers as well as for him).For example, let\'s suppose that Yura have chosen tasks with following difficulties: a\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894], and he has three developers in his disposal. He takes the hardest fourth task to finish by himself, and the developers are left with tasks with difficulties [1,\xe2\x80\x892,\xe2\x80\x893]. If the first one spends an hour on the first task and an hour on the third one, the second developer spends two hours on the second task and the third developer spends two hours on the third task, then they are done, since every developer worked exactly for two hours and every task has been worked over for the required amount of time. As another example, if the first task required two hours instead of one to be completed then it would be impossible to assign the tasks in a way described above. Besides work, Yura is fond of problem solving. He wonders how many pairs (l,\xe2\x80\x89r) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) exists such that a segment [l,\xe2\x80\x89r] is good? Yura has already solved this problem, but he has no time to write the code. Please, help Yura and implement the solution for this problem." 2800.0                            
                    549D "Haar Features" greedy,implementation "The first algorithm for detecting a face on the image working in realtime was developed by Paul Viola and Michael Jones in 2001. A part of the algorithm is a procedure that computes Haar features. As part of this task, we consider a simplified model of this concept.Let\'s consider a rectangular image that is represented with a table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. The table elements are integers that specify the brightness of each pixel in the image.A feature also is a rectangular table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell of a feature is painted black or white.To calculate the value of the given feature at the given image, you must perform the following steps. First the table of the feature is put over the table of the image (without rotations or reflections), thus each pixel is entirely covered with either black or white cell. The value of a feature in the image is the value of W\xe2\x80\x89-\xe2\x80\x89B, where W is the total brightness of the pixels in the image, covered with white feature cells, and B is the total brightness of the pixels covered with black feature cells.Some examples of the most popular Haar features are given below.   Your task is to determine the number of operations that are required to calculate the feature by using the so-called prefix rectangles.A prefix rectangle is any rectangle on the image, the upper left corner of which coincides with the upper left corner of the image.You have a variable value, whose value is initially zero. In one operation you can count the sum of pixel values \xe2\x80\x8b\xe2\x80\x8bat any prefix rectangle, multiply it by any integer and add to variable value.You are given a feature. It is necessary to calculate the minimum number of operations required to calculate the values of this attribute at an arbitrary image. For a better understanding of the statement, read the explanation of the first sample." 1900.0                            
                    547A "Mike and Frog" "brute force,greedy,implementation,math" "Mike has a frog and a flower. His frog is named Xaniar and his flower is named Abol. Initially(at time 0), height of Xaniar is h1 and height of Abol is h2. Each second, Mike waters Abol and Xaniar.  So, if height of Xaniar is h1 and height of Abol is h2, after one second height of Xaniar will become  and height of Abol will become  where x1,\xe2\x80\x89y1,\xe2\x80\x89x2 and y2 are some integer numbers and  denotes the remainder of a modulo b.Mike is a competitive programmer fan. He wants to know the minimum time it takes until height of Xania is a1 and height of Abol is a2.Mike has asked you for your help. Calculate the minimum time or say it will never happen." 2200.0                            
                    546A "Soldier and Bananas" "brute force,implementation,math" "A soldier wants to buy w bananas in the shop. He has to pay k dollars for the first banana, 2k dollars for the second one and so on (in other words, he has to pay i\xc2\xb7k dollars for the i-th banana). He has n dollars. How many dollars does he have to borrow from his friend soldier to buy w bananas?" 800.0                            
                    543D "Road Improvement" dp,trees "The country has n cities and n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads, it is possible to get from every city to any other one if you move only along the roads. The cities are numbered with integers from 1 to n inclusive.All the roads are initially bad, but the government wants to improve the state of some roads. We will assume that the citizens are happy about road improvement if the path from the capital located in city x to any other city contains at most one bad road.Your task is \xe2\x80\x94 for every possible x determine the number of ways of improving the quality of some roads in order to meet the citizens\' condition. As those values can be rather large, you need to print each value modulo 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007 (109\xe2\x80\x89+\xe2\x80\x897)." 2300.0                            
                    535E "Tavas and Pashmaks" geometry,math "Tavas is a cheerleader in the new sports competition named ""Pashmaks"".  This competition consists of two part: swimming and then running. People will immediately start running R meters after they finished swimming exactly S meters. A winner is a such person that nobody else finishes running before him/her (there may be more than one winner).Before the match starts, Tavas knows that there are n competitors registered for the match. Also, he knows that i-th person\'s swimming speed is si meters per second and his/her running speed is ri meters per second. Unfortunately, he doesn\'t know the values of R and S, but he knows that they are real numbers greater than 0.As a cheerleader, Tavas wants to know who to cheer up. So, he wants to know all people that might win. We consider a competitor might win if and only if there are some values of R and S such that with these values, (s)he will be a winner.Tavas isn\'t really familiar with programming, so he asked you to help him." 2600.0                            
                    535D "Tavas and Malekas" "greedy,hashing,string suffix structures,strings" "Tavas is a strange creature. Usually ""zzz"" comes out of people\'s mouth while sleeping, but string s of length n comes out from Tavas\' mouth instead.  Today Tavas fell asleep in Malekas\' place. While he was sleeping, Malekas did a little process on s. Malekas has a favorite string p. He determined all positions x1\xe2\x80\x89<\xe2\x80\x89x2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89xk where p matches s. More formally, for each xi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) he condition sxisxi\xe2\x80\x89+\xe2\x80\x891... sxi\xe2\x80\x89+\xe2\x80\x89|p|\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89p is fullfilled.Then Malekas wrote down one of subsequences of x1,\xe2\x80\x89x2,\xe2\x80\x89... xk (possibly, he didn\'t write anything) on a piece of paper. Here a sequence b is a subsequence of sequence a if and only if we can turn a into b by removing some of its elements (maybe no one of them or all).After Tavas woke up, Malekas told him everything. He couldn\'t remember string s, but he knew that both p and s only contains lowercase English letters and also he had the subsequence he had written on that piece of paper.Tavas wonders, what is the number of possible values of s? He asked SaDDas, but he wasn\'t smart enough to solve this. So, Tavas asked you to calculate this number for him.Answer can be very large, so Tavas wants you to print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 1900.0                            
                    527C "Glass Carving" "binary search,data structures,implementation" "Leonid wants to become a glass carver (the person who creates beautiful artworks by cutting the glass). He already has a rectangular w mm \xe2\x80\x89\xc3\x97\xe2\x80\x89 h mm sheet of glass, a diamond glass cutter and lots of enthusiasm. What he lacks is understanding of what to carve and how.In order not to waste time, he decided to practice the technique of carving. To do this, he makes vertical and horizontal cuts through the entire sheet. This process results in making smaller rectangular fragments of glass. Leonid does not move the newly made glass fragments. In particular, a cut divides each fragment of glass that it goes through into smaller fragments.After each cut Leonid tries to determine what area the largest of the currently available glass fragments has. Since there appear more and more fragments, this question takes him more and more time and distracts him from the fascinating process.Leonid offers to divide the labor \xe2\x80\x94 he will cut glass, and you will calculate the area of the maximum fragment after each cut. Do you agree?" 1500.0                            
                    524C "The Art of Dealing with ATM" "binary search,sortings" "ATMs of a well-known bank of a small country are arranged so that they can not give any amount of money requested by the user. Due to the limited size of the bill dispenser (the device that is directly giving money from an ATM) and some peculiarities of the ATM structure, you can get at most k bills from it, and the bills may be of at most two distinct denominations.For example, if a country uses bills with denominations 10, 50, 100, 500, 1000 and 5000 burles, then at k\xe2\x80\x89=\xe2\x80\x8920 such ATM can give sums 100\xe2\x80\x89000 burles and 96\xe2\x80\x89000 burles, but it cannot give sums 99\xe2\x80\x89000 and 101\xe2\x80\x89000 burles.Let\'s suppose that the country uses bills of n distinct denominations, and the ATM that you are using has an unlimited number of bills of each type. You know that during the day you will need to withdraw a certain amount of cash q times. You know that when the ATM has multiple ways to give money, it chooses the one which requires the minimum number of bills, or displays an error message if it cannot be done. Determine the result of each of the q of requests for cash withdrawal." 1900.0                            
                    523A "Rotate, Flip and Zoom" "*special problem,implementation" "Polycarp is writing the prototype of a graphic editor. He has already made up his mind that the basic image transformations in his editor will be: rotate the image 90 degrees clockwise, flip the image horizontally (symmetry relative to the vertical line, that is, the right part of the image moves to the left, and vice versa) and zooming on the image. He is sure that that there is a large number of transformations that can be expressed through these three.He has recently stopped implementing all three transformations for monochrome images. To test this feature, he asked you to write a code that will consecutively perform three actions with a monochrome image: first it will rotate the image 90 degrees clockwise, then it will flip the image horizontally and finally, it will zoom in twice on the image (that is, it will double all the linear sizes).Implement this feature to help Polycarp test his editor." 1200.0                            
                    520E "Pluses everywhere" "combinatorics,dp,math,number theory" "Vasya is sitting on an extremely boring math class. To have fun, he took a piece of paper and wrote out n numbers on a single line. After that, Vasya began to write out different ways to put pluses (""+"") in the line between certain digits in the line so that the result was a correct arithmetic expression; formally, no two pluses in such a partition can stand together (between any two adjacent pluses there must be at least one digit), and no plus can stand at the beginning or the end of a line. For example, in the string 100500, ways 100500 (add no pluses), 1+00+500 or 10050+0 are correct, and ways 100++500, +1+0+0+5+0+0 or 100500+ are incorrect.The lesson was long, and Vasya has written all the correct ways to place exactly k pluses in a string of digits. At this point, he got caught having fun by a teacher and he was given the task to calculate the sum of all the resulting arithmetic expressions by the end of the lesson (when calculating the value of an expression the leading zeros should be ignored). As the answer can be large, Vasya is allowed to get only its remainder modulo 109\xe2\x80\x89+\xe2\x80\x897. Help him!" 2200.0                            
                    520B "Two Buttons" "dfs and similar,graphs,greedy,implementation,math,shortest paths" "Vasya has found a strange device. On the front panel of a device there are: a red button, a blue button and a display showing some positive integer. After clicking the red button, device multiplies the displayed number by two. After clicking the blue button, device subtracts one from the number on the display. If at some point the number stops being positive, the device breaks down. The display can show arbitrarily large numbers. Initially, the display shows number n.Bob wants to get number m on the display. What minimum number of clicks he has to make in order to achieve this result?" 1400.0                            
                    519E "A and B and Lecture Rooms" "binary search,data structures,dfs and similar,dp,trees" "A and B are preparing themselves for programming contests.The University where A and B study is a set of rooms connected by corridors. Overall, the University has n rooms connected by n\xe2\x80\x89-\xe2\x80\x891 corridors so that you can get from any room to any other one by moving along the corridors. The rooms are numbered from 1 to n.Every day \xd0\x90 and B write contests in some rooms of their university, and after each contest they gather together in the same room and discuss problems. A and B want the distance from the rooms where problems are discussed to the rooms where contests are written to be equal. The distance between two rooms is the number of edges on the shortest path between them.As they write contests in new rooms every day, they asked you to help them find the number of possible rooms to discuss problems for each of the following m days." 2100.0                            
                    518E "Arthur and Questions" "greedy,implementation,math,ternary search" "After bracket sequences Arthur took up number theory. He has got a new favorite sequence of length n (a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an), consisting of integers and integer k, not exceeding n.This sequence had the following property: if you write out the sums of all its segments consisting of k consecutive elements (a1 \xe2\x80\x89+\xe2\x80\x89 a2 ... \xe2\x80\x89+\xe2\x80\x89 ak,\xe2\x80\x89 a2 \xe2\x80\x89+\xe2\x80\x89 a3 \xe2\x80\x89+\xe2\x80\x89 ... \xe2\x80\x89+\xe2\x80\x89 ak\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89 ...,\xe2\x80\x89 an\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 \xe2\x80\x89+\xe2\x80\x89 an\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x892 \xe2\x80\x89+\xe2\x80\x89 ... \xe2\x80\x89+\xe2\x80\x89 an), then those numbers will form strictly increasing sequence.For example, for the following sample: n\xe2\x80\x89=\xe2\x80\x895,\xe2\x80\x89 k\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x89 a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x89 2,\xe2\x80\x89 4,\xe2\x80\x89 5,\xe2\x80\x89 6) the sequence of numbers will look as follows: (1 \xe2\x80\x89+\xe2\x80\x89 2 \xe2\x80\x89+\xe2\x80\x89 4,\xe2\x80\x89 2 \xe2\x80\x89+\xe2\x80\x89 4 \xe2\x80\x89+\xe2\x80\x89 5,\xe2\x80\x89 4 \xe2\x80\x89+\xe2\x80\x89 5 \xe2\x80\x89+\xe2\x80\x89 6) = (7,\xe2\x80\x89 11,\xe2\x80\x89 15), that means that sequence a meets the described property. Obviously the sequence of sums will have n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 elements.Somebody (we won\'t say who) replaced some numbers in Arthur\'s sequence by question marks (if this number is replaced, it is replaced by exactly one question mark). We need to restore the sequence so that it meets the required property and also minimize the sum |ai|, where |ai| is the absolute value of ai." 2200.0                            
                    518B "Tanya and Postcard" greedy,implementation,strings "Little Tanya decided to present her dad a postcard on his Birthday. She has already created a message \xe2\x80\x94 string s of length n, consisting of uppercase and lowercase English letters. Tanya can\'t write yet, so she found a newspaper and decided to cut out the letters and glue them into the postcard to achieve string s. The newspaper contains string t, consisting of uppercase and lowercase English letters. We know that the length of string t greater or equal to the length of the string s.The newspaper may possibly have too few of some letters needed to make the text and too many of some other letters. That\'s why Tanya wants to cut some n letters out of the newspaper and make a message of length exactly n, so that it looked as much as possible like s. If the letter in some position has correct value and correct letter case (in the string s and in the string that Tanya will make), then she shouts joyfully ""YAY!"", and if the letter in the given position has only the correct value but it is in the wrong case, then the girl says ""WHOOPS"".Tanya wants to make such message that lets her shout ""YAY!"" as much as possible. If there are multiple ways to do this, then her second priority is to maximize the number of times she says ""WHOOPS"". Your task is to help Tanya make the message." 1400.0                            
                    515D "Drazil and Tiles" "constructive algorithms,greedy" "Drazil created a following problem about putting 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 tiles into an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid:""There is a grid with some cells that are empty and some cells that are occupied. You should use 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 tiles to cover all empty cells and no two tiles should cover each other. And you should print a solution about how to do it.""But Drazil doesn\'t like to write special checking program for this task. His friend, Varda advised him: ""how about asking contestant only to print the solution when it exists and it is unique? Otherwise contestant may print \'Not unique\' "".Drazil found that the constraints for this task may be much larger than for the original task!Can you solve this new problem?Note that you should print \'Not unique\' either when there exists no solution or when there exists several different solutions for the original task." 2000.0                            
                    513F2 Scaygerboss flows "Cthulhu decided to catch Scaygerboss. Scaygerboss found it out and is trying to hide in a pack of his scaygers. Each scayger except Scaygerboss is either a male or a female. Scaygerboss\'s gender is ""other"".Scaygers are scattered on a two-dimensional map divided into cells. A scayger looks nerdy and loveable if it is staying in the same cell with exactly one scayger of a gender that is different from its own gender. Cthulhu will not be able to catch Scaygerboss if all the scaygers on the map look nerdy and loveable.The scaygers can move around at different speeds. For each scayger, we are given the time it takes this scayger to move from a cell to an adjacent cell. Cells are adjacent if they share a common side. At any point of time, each cell that does not contain an obstacle can be occupied by an arbitrary number of scaygers. Scaygers cannot move to cells with obstacles.Calculate minimal time in order to make all scaygers look nerdy and loveable if they move optimally toward this goal." 2800.0                            
                    513D2 "Constrained Tree" "constructive algorithms,data structures" "You need to find a binary tree of size n that satisfies a given set of c constraints. Suppose that the nodes of the unknown binary tree are labeled using a pre-order traversal starting with 1. For the i-th constraint you are given two labels, ai and bi and a direction, left or right. In case of left direction, bi is an element of the subtree rooted at ai\'s left child. Similarly in the case of right direction bi is an element of the subtree rooted at ai\'s right child." 2600.0                            
                    512D "Fox And Travelling" dp,trees "Fox Ciel is going to travel to New Foxland during this summer.New Foxland has n attractions that are linked by m undirected roads. Two attractions are called adjacent if they are linked by a road. Fox Ciel has k days to visit this city and each day she will visit exactly one attraction.There is one important rule in New Foxland: you can\'t visit an attraction if it has more than one adjacent attraction that you haven\'t visited yet.At the beginning Fox Ciel haven\'t visited any attraction. During her travelling she may move aribtrarly between attraction. After visiting attraction a, she may travel to any attraction b satisfying conditions above that hasn\'t been visited yet, even if it is not reachable from a by using the roads (Ciel uses boat for travelling between attractions, so it is possible). She wants to know how many different travelling plans she can make. Calculate this number modulo 109\xe2\x80\x89+\xe2\x80\x899 for every k from 0 to n since she hasn\'t decided for how many days she is visiting New Foxland." 2900.0                            
                    505E "Mr. Kitayuta vs. Bamboos" "binary search,greedy" "Mr. Kitayuta\'s garden is planted with n bamboos. (Bamboos are tall, fast-growing tropical plants with hollow stems.) At the moment, the height of the i-th bamboo is hi meters, and it grows ai meters at the end of each day. Actually, Mr. Kitayuta hates these bamboos. He once attempted to cut them down, but failed because their stems are too hard. Mr. Kitayuta have not given up, however. He has crafted Magical Hammer with his intelligence to drive them into the ground.He can use Magical Hammer at most k times during each day, due to his limited Magic Power. Each time he beat a bamboo with Magical Hammer, its height decreases by p meters. If the height would become negative by this change, it will become 0 meters instead (it does not disappear). In other words, if a bamboo whose height is h meters is beaten with Magical Hammer, its new height will be max(0,\xe2\x80\x89h\xe2\x80\x89-\xe2\x80\x89p) meters. It is possible to beat the same bamboo more than once in a day.Mr. Kitayuta will fight the bamboos for m days, starting today. His purpose is to minimize the height of the tallest bamboo after m days (that is, m iterations of ""Mr. Kitayuta beats the bamboos and then they grow""). Find the lowest possible height of the tallest bamboo after m days." 2900.0                            
                    505A "Mr. Kitayuta\'s Gift" "brute force,implementation,strings" "Mr. Kitayuta has kindly given you a string s consisting of lowercase English letters. You are asked to insert exactly one lowercase English letter into s to make it a palindrome. A palindrome is a string that reads the same forward and backward. For example, ""noon"", ""testset"" and ""a"" are all palindromes, while ""test"" and ""kitayuta"" are not.You can choose any lowercase English letter, and insert it to any position of s, possibly to the beginning or the end of s. You have to insert a letter even if the given string is already a palindrome.If it is possible to insert one lowercase English letter into s so that the resulting string will be a palindrome, print the string after the insertion. Otherwise, print ""NA"" (without quotes, case-sensitive). In case there is more than one palindrome that can be obtained, you are allowed to print any of them." 1100.0                            
                    504E "Misha and LCP on Tree" "binary search,dfs and similar,hashing,string suffix structures,trees" "Misha has a tree with characters written on the vertices. He can choose two vertices s and t of this tree and write down characters of vertices lying on a path from s to t. We\'ll say that such string corresponds to pair (s,\xe2\x80\x89t).Misha has m queries of type: you are given 4 vertices a, b, c, d; you need to find the largest common prefix of the strings that correspond to pairs (a,\xe2\x80\x89b) and (c,\xe2\x80\x89d). Your task is to help him." 3000.0                            
                    499A "Watching a movie" greedy,implementation "You have decided to watch the best moments of some movie. There are two buttons on your player:   Watch the current minute of the movie. By pressing this button, you watch the current minute of the movie and the player automatically proceeds to the next minute of the movie.  Skip exactly x minutes of the movie (x is some fixed positive integer). If the player is now at the t-th minute of the movie, then as a result of pressing this button, it proceeds to the minute (t\xe2\x80\x89+\xe2\x80\x89x). Initially the movie is turned on in the player on the first minute, and you want to watch exactly n best moments of the movie, the i-th best moment starts at the li-th minute and ends at the ri-th minute (more formally, the i-th best moment consists of minutes: li,\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ri). Determine, what is the minimum number of minutes of the movie you have to watch if you want to watch all the best moments?" 1000.0                            
                    496E "Distributing Parts" greedy,sortings "You are an assistant director in a new musical play. The play consists of n musical parts, each part must be performed by exactly one actor. After the casting the director chose m actors who can take part in the play. Your task is to assign the parts to actors. However, there are several limitations.First, each actor has a certain voice range and there are some parts that he cannot sing. Formally, there are two integers for each actor, ci and di (ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89di) \xe2\x80\x94 the pitch of the lowest and the highest note that the actor can sing. There also are two integers for each part \xe2\x80\x94 aj and bj (aj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bj) \xe2\x80\x94 the pitch of the lowest and the highest notes that are present in the part. The i-th actor can perform the j-th part if and only if ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89di, i.e. each note of the part is in the actor\'s voice range.According to the contract, the i-th actor can perform at most ki parts. Besides, you are allowed not to give any part to some actors (then they take part in crowd scenes).The rehearsal starts in two hours and you need to do the assignment quickly!" 2100.0                            
                    494C "Helping People" dp,probabilities "Malek is a rich man. He also is very generous. That\'s why he decided to split his money between poor people. A charity institute knows n poor people numbered from 1 to n. The institute gave Malek q recommendations. A recommendation is a segment of people like [l,\xe2\x80\x89r] which means the institute recommended that Malek gives one dollar to every person whose number is in this segment.However this charity has very odd rules about the recommendations. Because of those rules the recommendations are given in such a way that for every two recommendation [a,\xe2\x80\x89b] and [c,\xe2\x80\x89d] one of the following conditions holds:   The two segments are completely disjoint. More formally either a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d or c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89<\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b  One of the two segments are inside another. More formally either a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b or c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d. The goodness of a charity is the value of maximum money a person has after Malek finishes giving his money. The institute knows for each recommendation what is the probability that Malek will accept it. They want to know the expected value of goodness of this charity. So they asked you for help.You have been given the list of recommendations and for each recommendation the probability of it being accepted by Malek. You have also been given how much money each person initially has. You must find the expected value of goodness." 2600.0                            
                    492E "Vanya and Field" math "Vanya decided to walk in the field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. The field contains m apple trees, the i-th apple tree is at the cell with coordinates (xi,\xe2\x80\x89yi). Vanya moves towards vector (dx,\xe2\x80\x89dy). That means that if Vanya is now at the cell (x,\xe2\x80\x89y), then in a second he will be at cell . The following condition is satisfied for the vector: , where  is the largest integer that divides both a and b. Vanya ends his path when he reaches the square he has already visited. Vanya wonders, from what square of the field he should start his path to see as many apple trees as possible." 2000.0                            
                    489C "Given Length and Sum of Digits..." dp,greedy,implementation "You have a positive integer m and a non-negative integer s. Your task is to find the smallest and the largest of the numbers that have length m and sum of digits s. The required numbers should be non-negative integers written in the decimal base without leading zeroes." 1400.0                            
                    477E "Dreamoon and Notepad" "data structures" "Dreamoon has just created a document of hard problems using notepad.exe. The document consists of n lines of text, ai denotes the length of the i-th line. He now wants to know what is the fastest way to move the cursor around because the document is really long.Let (r,\xe2\x80\x89c) be a current cursor position, where r is row number and c is position of cursor in the row. We have 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ar.We can use following six operations in notepad.exe to move our cursor assuming the current cursor position is at (r,\xe2\x80\x89c):  up key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(max(r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891),\xe2\x80\x89min(anr,\xe2\x80\x89c))  down key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(min(r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89n),\xe2\x80\x89min(anr,\xe2\x80\x89c))  left key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x89max(0,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891))  right key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x89min(anr,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891))  HOME key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x890)  END key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x89ar) You\'re given the document description (n and sequence ai) and q queries from Dreamoon. Each query asks what minimal number of key presses is needed to move the cursor from (r1,\xe2\x80\x89c1) to (r2,\xe2\x80\x89c2)." 3100.0                            
                    474B Worms "binary search,implementation" "It is lunch time for Mole. His friend, Marmot, prepared him a nice game for lunch.Marmot brought Mole n ordered piles of worms such that i-th pile contains ai worms. He labeled all these worms with consecutive integers: worms in first pile are labeled with numbers 1 to a1, worms in second pile are labeled with numbers a1\xe2\x80\x89+\xe2\x80\x891 to a1\xe2\x80\x89+\xe2\x80\x89a2 and so on. See the example for a better understanding.Mole can\'t eat all the worms (Marmot brought a lot) and, as we all know, Mole is blind, so Marmot tells him the labels of the best juicy worms. Marmot will only give Mole a worm if Mole says correctly in which pile this worm is contained.Poor Mole asks for your help. For all juicy worms said by Marmot, tell Mole the correct answers." 1200.0                            
                    472D "Design Tutorial: Inverse the Problem" "dfs and similar,dsu,shortest paths,trees" "There is an easy way to obtain a new task from an old one called ""Inverse the problem"": we give an output of the original task, and ask to generate an input, such that solution to the original problem will produce the output we provided. The hard task of Topcoder Open 2014 Round 2C, InverseRMQ, is a good example.Now let\'s create a task this way. We will use the task: you are given a tree, please calculate the distance between any pair of its nodes. Yes, it is very easy, but the inverse version is a bit harder: you are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n distance matrix. Determine if it is the distance matrix of a weighted tree (all weights must be positive integers)." 1900.0                            
                    472A "Design Tutorial: Learn from Math" "math,number theory" "One way to create a task is to learn from math. You can generate some random math statement or modify some theorems to get something new and build a new task from that.For example, there is a statement called the ""Goldbach\'s conjecture"". It says: ""each even number no less than four can be expressed as the sum of two primes"". Let\'s modify it. How about a statement like that: ""each integer no less than 12 can be expressed as the sum of two composite numbers."" Not like the Goldbach\'s conjecture, I can prove this theorem.You are given an integer n no less than 12, express it as a sum of two composite numbers." 800.0                            
                    471E "MUH and Lots and Lots of Segments" "data structures,dsu" "Polar bears Menshykov and Uslada from the zoo of St. Petersburg and elephant Horace from the zoo of Kiev decided to do some painting. As they were trying to create their first masterpiece, they made a draft on a piece of paper. The draft consists of n segments. Each segment was either horizontal or vertical. Now the friends want to simplify the draft by deleting some segments or parts of segments so that the final masterpiece meets three conditions:  Horace wants to be able to paint the whole picture in one stroke: by putting the brush on the paper and never taking it off until the picture is ready. The brush can paint the same place multiple times. That\'s why all the remaining segments must form a single connected shape.  Menshykov wants the resulting shape to be simple. He defines a simple shape as a shape that doesn\'t contain any cycles.  Initially all the segment on the draft have integer startpoint and endpoint coordinates. Uslada doesn\'t like real coordinates and she wants this condition to be fulfilled after all the changes. As in other parts the draft is already beautiful, the friends decided to delete such parts of the draft that the sum of lengths of the remaining segments is as large as possible. Your task is to count this maximum sum of the lengths that remain after all the extra segments are removed." 2700.0                            
                    471A "MUH and Sticks" implementation "Two polar bears Menshykov and Uslada from the St.Petersburg zoo and elephant Horace from the Kiev zoo got six sticks to play with and assess the animals\' creativity. Menshykov, Uslada and Horace decided to make either an elephant or a bear from those sticks. They can make an animal from sticks in the following way:   Four sticks represent the animal\'s legs, these sticks should have the same length.  Two remaining sticks represent the animal\'s head and body. The bear\'s head stick must be shorter than the body stick. The elephant, however, has a long trunk, so his head stick must be as long as the body stick. Note that there are no limits on the relations between the leg sticks and the head and body sticks. Your task is to find out which animal can be made from the given stick set. The zoo keeper wants the sticks back after the game, so they must never be broken, even bears understand it." 1100.0                            
                    470G "Hamming Distance" "*special problem" "Hamming distance between two strings of equal length is the number of positions at which the corresponding symbols are different. You are given two strings; calculate the distance between them." 2300.0                            
                    469A "I Wanna Be the Guy" greedy,implementation "There is a game called ""I Wanna Be the Guy"", consisting of n levels. Little X and his friend Little Y are addicted to the game. Each of them wants to pass the whole game.Little X can pass only p levels of the game. And Little Y can pass only q levels of the game. You are given the indices of levels Little X can pass and the indices of levels Little Y can pass. Will Little X and Little Y pass the whole game, if they cooperate each other?" 800.0                            
                    468E Permanent "dp,graph matchings,math,meet-in-the-middle" "Little X has solved the #P-complete problem in polynomial time recently. So he gives this task to you. There is a special n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix A, you should calculate its permanent modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). The special property of matrix A is almost all its elements equal to 1. Only k elements have specified value.You can find the definition of permanent at the link: https://en.wikipedia.org/wiki/Permanent" 3100.0                            
                    464E "The Classic Problem" "data structures,graphs,shortest paths" "You are given a weighted undirected graph on n vertices and m edges. Find the shortest path from vertex s to vertex t or else state that such path doesn\'t exist." 3000.0                            
                    464D "World of Darkraft - 2" dp,probabilities "Roma found a new character in the game ""World of Darkraft - 2"". In this game the character fights monsters, finds the more and more advanced stuff that lets him fight stronger monsters.The character can equip himself with k distinct types of items. Power of each item depends on its level (positive integer number). Initially the character has one 1-level item of each of the k types.After the victory over the monster the character finds exactly one new randomly generated item. The generation process looks as follows. Firstly the type of the item is defined; each of the k types has the same probability. Then the level of the new item is defined. Let\'s assume that the level of player\'s item of the chosen type is equal to t at the moment. Level of the new item will be chosen uniformly among integers from segment [1; t\xe2\x80\x89+\xe2\x80\x891].From the new item and the current player\'s item of the same type Roma chooses the best one (i.e. the one with greater level) and equips it (if both of them has the same level Roma choses any). The remaining item is sold for coins. Roma sells an item of level x of any type for x coins.Help Roma determine the expected number of earned coins after the victory over n monsters." 2700.0                            
                    464C "Substitutes in Number" dp "Andrew and Eugene are playing a game. Initially, Andrew has string s, consisting of digits. Eugene sends Andrew multiple queries of type ""di\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89ti"", that means ""replace all digits di in string s with substrings equal to ti"". For example, if s\xe2\x80\x89=\xe2\x80\x89123123, then query ""2\xe2\x80\x89\xe2\x86\x92\xe2\x80\x8900"" transforms s to 10031003, and query ""3\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89"" (""replace 3 by an empty string"") transforms it to s\xe2\x80\x89=\xe2\x80\x891212. After all the queries Eugene asks Andrew to find the remainder after division of number with decimal representation equal to s by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). When you represent s as a decimal number, please ignore the leading zeroes; also if s is an empty string, then it\'s assumed that the number equals to zero.Andrew got tired of processing Eugene\'s requests manually and he asked you to write a program for that. Help him!" 2100.0                            
                    463A "Caisa and Sugar" "brute force,implementation" "Caisa is going to have a party and he needs to buy the ingredients for a big chocolate cake. For that he is going to the biggest supermarket in town.Unfortunately, he has just s dollars for sugar. But that\'s not a reason to be sad, because there are n types of sugar in the supermarket, maybe he able to buy one. But that\'s not all. The supermarket has very unusual exchange politics: instead of cents the sellers give sweets to a buyer as a change. Of course, the number of given sweets always doesn\'t exceed 99, because each seller maximizes the number of dollars in the change (100 cents can be replaced with a dollar).Caisa wants to buy only one type of sugar, also he wants to maximize the number of sweets in the change. What is the maximum number of sweets he can get? Note, that Caisa doesn\'t want to minimize the cost of the sugar, he only wants to get maximum number of sweets as change." 1200.0                            
                    457E "Flow Optimality" "constructive algorithms,flows,math" "There is a computer network consisting of n nodes numbered 1 through n. There are links in the network that connect pairs of nodes. A pair of nodes may have multiple links between them, but no node has a link to itself.Each link supports unlimited bandwidth (in either direction), however a link may only transmit in a single direction at any given time. The cost of sending data across a link is proportional to the square of the bandwidth. Specifically, each link has a positive weight, and the cost of sending data across the link is the weight times the square of the bandwidth.The network is connected (there is a series of links from any node to any other node), and furthermore designed to remain connected in the event of any single node failure.You needed to send data from node 1 to node n at a bandwidth of some positive number k. That is, you wish to assign a bandwidth to each link so that the bandwidth into a node minus the bandwidth out of a node is \xe2\x80\x89-\xe2\x80\x89k for node 1, k for node n, and 0 for all other nodes. The individual bandwidths do not need to be integers.Wishing to minimize the total cost, you drew a diagram of the network, then gave the task to an intern to solve. The intern claimed to have solved the task and written the optimal bandwidths on your diagram, but then spilled coffee on it, rendering much of it unreadable (including parts of the original diagram, and the value of k).From the information available, determine if the intern\'s solution may have been optimal. That is, determine if there exists a valid network, total bandwidth, and optimal solution which is a superset of the given information. Furthermore, determine the efficiency of the intern\'s solution (if possible), where efficiency is defined as total cost divided by total bandwidth." 3000.0                            
                    452A Eevee "brute force,implementation,strings" "You are solving the crossword problem K from IPSC 2014. You solved all the clues except for one: who does Eevee evolve into? You are not very into pokemons, but quick googling helped you find out, that Eevee can evolve into eight different pokemons: Vaporeon, Jolteon, Flareon, Espeon, Umbreon, Leafeon, Glaceon, and Sylveon.You know the length of the word in the crossword, and you already know some letters. Designers of the crossword made sure that the answer is unambiguous, so you can assume that exactly one pokemon out of the 8 that Eevee evolves into fits the length and the letters given. Your task is to find it." 1000.0                            
                         1872C "Non-coprime Split" "math,number theory" "You are given two integers l\xe2\x89\xa4r. You need to find positive integers a and b such that the following conditions are simultaneously satisfied: l\xe2\x89\xa4a+b\xe2\x89\xa4r gcd(a,b)\xe2\x89\xa01or report that they do not exist.gcd(a,b) denotes the greatest common divisor of numbers a and b. For example, gcd(6,9)=3, gcd(8,9)=1, gcd(4,2)=2." 1100.0                       
                         1872A "Two Vessels" "brute force,greedy,math" "You have two vessels with water. The first vessel contains a grams of water, and the second vessel contains b grams of water. Both vessels are very large and can hold any amount of water.You also have an empty cup that can hold up to c grams of water.In one move, you can scoop up to c grams of water from any vessel and pour it into the other vessel. Note that the mass of water poured in one move does not have to be an integer.What is the minimum number of moves required to make the masses of water in the vessels equal? Note that you cannot perform any actions other than the described moves." 800.0                       
                         1870E "Another MEX Problem" "bitmasks,brute force,dp,shortest paths" "You are given an array of integers a of size n. You can choose a set of non-overlapping subarrays of the given array (note that some elements may be not included in any subarray, this is allowed). For each selected subarray, calculate the MEX of its elements, and then calculate the bitwise XOR of all the obtained MEX values. What is the maximum bitwise XOR that can be obtained?The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:   The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0, 1, 2 and 3 belong to the array, but 4 does not." 2300.0                       
                         1869B "2D Traveling" "geometry,math,shortest paths,sortings" "Piggy lives on an infinite plane with the Cartesian coordinate system on it.There are n cities on the plane, numbered from 1 to n, and the first k cities are defined as major cities. The coordinates of the i-th city are (xi,yi).Piggy, as a well-experienced traveller, wants to have a relaxing trip after Zhongkao examination. Currently, he is in city a, and he wants to travel to city b by air. You can fly between any two cities, and you can visit several cities in any order while travelling, but the final destination must be city b.Because of active trade between major cities, it\'s possible to travel by plane between them for free. Formally, the price of an air ticket f(i,j) between two cities i and j is defined as follows:f(i,j)={0,if cities i and j are both major cities|xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|,otherwisePiggy doesn\'t want to save time, but he wants to save money. So you need to tell him the minimum value of the total cost of all air tickets if he can take any number of flights." 1100.0                       
                         1867E1 "Salyg1n and Array (simple version)" "constructive algorithms,interactive,math" "This is the simple version of the problem. The only difference between the versions is the limit on the number of queries. In this version, you can make no more than 100 queries. You can make hacks only if both versions of the problem are solved.This is an interactive problem!salyg1n has given you a positive integer k and wants to play a game with you. He has chosen an array of n integers a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4109). You must print a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an, where \xe2\x8a\x95 denotes the bitwise XOR operation. You can make queries of the following type:  ? i: in response to this query, you will receive ai\xe2\x8a\x95ai+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ai+k\xe2\x88\x921. Also, after this query, the subarray ai,ai+1,\xe2\x80\xa6,ai+k\xe2\x88\x921 will be reversed, i.e., the chosen array a will become: a1,a2,\xe2\x80\xa6ai\xe2\x88\x921,ai+k\xe2\x88\x921,ai+k\xe2\x88\x922,\xe2\x80\xa6,ai+1,ai,ai+k,\xe2\x80\xa6,an. You can make no more than 100 queries to answer the problem." 2000.0                       
                         1863I "Redundant Routes" "constructive algorithms,dp,trees" "You are given a tree with n vertices labeled 1,2,\xe2\x80\xa6,n. The length of a simple path in the tree is the number of vertices in it.You are to select a set of simple paths of length at least 2 each, but you cannot simultaneously select two distinct paths contained one in another. Find the largest possible size of such a set.Formally, a set S of vertices is called a route if it contains at least two vertices and coincides with the set of vertices of a simple path in the tree. A collection of distinct routes is called a timetable. A route S in a timetable T is called redundant if there is a different route S\xe2\x80\xb2\xe2\x88\x88T such that S\xe2\x8a\x82S\xe2\x80\xb2. A timetable is called efficient if it contains no redundant routes. Find the largest possible number of routes in an efficient timetable." 3500.0                       
                         1862F "Magic Will Save the World" "binary search,bitmasks,brute force,dp" "A portal of dark forces has opened at the border of worlds, and now the whole world is under a terrible threat. To close the portal and save the world, you need to defeat n monsters that emerge from the portal one after another.Only the sorceress Vika can handle this. She possesses two magical powers \xe2\x80\x94 water magic and fire magic. In one second, Vika can generate w units of water mana and f units of fire mana. She will need mana to cast spells. Initially Vika have 0 units of water mana and 0 units of fire mana.Each of the n monsters that emerge from the portal has its own strength, expressed as a positive integer. To defeat the i-th monster with strength si, Vika needs to cast a water spell or a fire spell of at least the same strength. In other words, Vika can spend at least si units of water mana on a water spell, or at least si units of fire mana on a fire spell.Vika can create and cast spells instantly. Vika can cast an unlimited number of spells every second as long she has enough mana for that.The sorceress wants to save the world as quickly as possible, so tell her how much time she will need." 1800.0                       
                         1862D "Ice Cream Balls" "binary search,combinatorics,constructive algorithms,math" "Tema decided to improve his ice cream making skills. He has already learned how to make ice cream in a cone using exactly two balls.Before his ice cream obsession, Tema was interested in mathematics. Therefore, he is curious about the minimum number of balls he needs to have in order to make exactly n different types of ice cream.There are plenty possible ice cream flavours: 1,2,3,\xe2\x80\xa6. Tema can make two-balls ice cream with any flavours (probably the same).Two ice creams are considered different if their sets of ball flavours are different. For example, {1,2}={2,1}, but {1,1}\xe2\x89\xa0{1,2}.For example, having the following ice cream balls: {1,1,2}, Tema can make only two types of ice cream: {1,1} and {1,2}.Note, that Tema do not need to make all the ice cream cones at the same time. This means that he making ice cream cones independently. Also in order to make a following cone {x,x} for some x, Tema needs at least 2 balls of type x.Help Tema answer this question. It can be shown that answer always exist." 1300.0                       
                         1862C "Flower City Fence" "binary search,data structures,implementation,sortings" "Anya lives in the Flower City. By order of the city mayor, she has to build a fence for herself.The fence consists of n planks, each with a height of ai meters. According to the order, the heights of the planks must not increase. In other words, it is true that ai\xe2\x89\xa5aj for all i<j.Anya became curious whether her fence is symmetrical with respect to the diagonal. In other words, will she get the same fence if she lays all the planks horizontally in the same order.For example, for n=5, a=[5,4,3,2,1], the fence is symmetrical. Because if all the planks are laid horizontally, the fence will be [5,4,3,2,1], as shown in the diagram.  On the left is the fence [5,4,3,2,1], on the right is the same fence laid horizontally But for n=3, a=[4,2,1], the fence is not symmetrical. Because if all the planks are laid horizontally, the fence will be [3,2,1,1], as shown in the diagram.  On the left is the fence [4,2,1], on the right is the same fence laid horizontally  Help Anya and determine whether her fence is symmetrical." 1100.0                       
                         1860E "Fast Travel Text Editor" "data structures,dfs and similar,graphs,shortest paths" "You are given a string s, consisting of lowercase Latin letters.There\'s a cursor, initially placed between two adjacent letters of the string. The cursor can\'t be placed before the first or after the last letter.In one move, you can perform one of three actions:   move a cursor one position to the left (if that doesn\'t place it before the first letter);  move a cursor one position to the right (if that doesn\'t place it after the last letter);  let x be the letter immediately to the left of the cursor, and y be the letter immediately to the right of the cursor. Choose any pair of adjacent letters in the string such that the left of them is x and the right of them is y, and move the cursor to the position between these two letters. You are asked m queries. In each query, you are given two integers f and t, which correspond to two valid positions of the cursor in the string. In response to the query, you have to calculate the minimum number of operations required to move the cursor from position f to position t." 2400.0                       
                         1858D "Trees and Segments" "brute force,data structures,dp,greedy,two pointers" "The teachers of the Summer Informatics School decided to plant n trees in a row, and it was decided to plant only oaks and firs. To do this, they made a plan, which can be represented as a binary string s of length n. If si=0, then the i-th tree in the row should be an oak, and if si=1, then the i-th tree in the row should be a fir.The day of tree planting is tomorrow, and the day after tomorrow an inspector will come to the School. The inspector loves nature very much, and he will evaluate the beauty of the row as follows:  First, he will calculate l0 as the maximum number of consecutive oaks in the row (the maximum substring consisting of zeros in the plan s). If there are no oaks in the row, then l0=0.  Then, he will calculate l1 as the maximum number of consecutive firs in the row (the maximum substring consisting of ones in the plan s). If there are no firs in the row, then l1=0.  Finally, he will calculate the beauty of the row as a\xe2\x8b\x85l0+l1 for some a \xe2\x80\x94 the inspector\'s favourite number. The teachers know the value of the parameter a, but for security reasons they cannot tell it to you. They only told you that a is an integer from 1 to n.Since the trees have not yet been planted, the teachers decided to change the type of no more than k trees to the opposite (i.e., change si from 0 to 1 or from 1 to 0 in the plan) in order to maximize the beauty of the row of trees according to the inspector.For each integer j from 1 to n answer the following question independently:   What is the maximum beauty of the row of trees that the teachers can achieve by changing the type of no more than k trees if the inspector\'s favourite number a is equal to j?" 2200.0                       
                         1858A Buttons games,greedy,math "Anna and Katie ended up in a secret laboratory.There are a+b+c buttons in the laboratory. It turned out that a buttons can only be pressed by Anna, b buttons can only be pressed by Katie, and c buttons can be pressed by either of them. Anna and Katie decided to play a game, taking turns pressing these buttons. Anna makes the first turn. Each button can be pressed at most once, so at some point, one of the girls will not be able to make her turn.The girl who cannot press a button loses. Determine who will win if both girls play optimally." 800.0                       
                         1857E "Power of Points" math,sortings "You are given n points with integer coordinates x1,\xe2\x80\xa6xn, which lie on a number line.For some integer s, we construct segments [s,x1], [s,x2], \xe2\x80\xa6, [s,xn]. Note that if xi<s, then the segment will look like [xi,s]. The segment [a,b] covers all integer points a,a+1,a+2,\xe2\x80\xa6,b.We define the power of a point p as the number of segments that intersect the point with coordinate p, denoted as fp.Your task is to compute 109\xe2\x88\x91p=1fp for each s\xe2\x88\x88{x1,\xe2\x80\xa6,xn}, i.e., the sum of fp for all integer points from 1 to 109.For example, if the initial coordinates are [1,2,5,7,1] and we choose s=5, then the segments will be: [1,5],[2,5],[5,5],[5,7],[1,5]. And the powers of the points will be: f1=2,f2=3,f3=3,f4=3,f5=5,f6=1,f7=1,f8=0,\xe2\x80\xa6,f109=0. Their sum is 2+3+3+3+5+1+1=18." 1500.0                       
                         1856D "More Wrong" "divide and conquer,interactive" "This is an interactive problem.The jury has hidden a permutation\xe2\x80\xa0 p of length n.In one query, you can pick two integers l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n) by paying (r\xe2\x88\x92l)2 coins. In return, you will be given the number of inversions\xe2\x80\xa1 in the subarray [pl,pl+1,\xe2\x80\xa6pr].Find the index of the maximum element in p by spending at most 5\xe2\x8b\x85n2 coins.Note: the grader is not adaptive: the permutation is fixed before any queries are made.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).\xe2\x80\xa1 The number of inversions in an array is the number of pairs of indices (i,j) such that i<j and ai>aj. For example, the array [10,2,6,3] contains 4 inversions. The inversions are (1,2),(1,3),(1,4), and (3,4)." 2100.0                       
                         1852E Rivalries "constructive algorithms,data structures,greedy" "Ntarsis has an array a of length n.The power of a subarray al\xe2\x80\xa6ar (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) is defined as:   The largest value x such that al\xe2\x80\xa6ar contains x and neither a1\xe2\x80\xa6al\xe2\x88\x921 nor ar+1\xe2\x80\xa6an contains x.  If no such x exists, the power is 0. Call an array b a rival to a if the following holds:   The length of both a and b are equal to some n.  Over all l,r where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, the power of al\xe2\x80\xa6ar equals the power of bl\xe2\x80\xa6br.  The elements of b are positive. Ntarsis wants you to find a rival b to a such that the sum of bi over 1\xe2\x89\xa4i\xe2\x89\xa4n is maximized. Help him with this task!" 3400.0                       
                         1851E "Nastya and Potions" "dfs and similar,dp,graphs,sortings" "Alchemist Nastya loves mixing potions. There are a total of n types of potions, and one potion of type i can be bought for ci coins.Any kind of potions can be obtained in no more than one way, by mixing from several others. The potions used in the mixing process will be consumed. Moreover, no potion can be obtained from itself through one or more mixing processes.As an experienced alchemist, Nastya has an unlimited supply of k types of potions p1,p2,\xe2\x80\xa6,pk, but she doesn\'t know which one she wants to obtain next. To decide, she asks you to find, for each 1\xe2\x89\xa4i\xe2\x89\xa4n, the minimum number of coins she needs to spend to obtain a potion of type i next." 1500.0                       
                         1850G "The Morning Star" "combinatorics,data structures,geometry,implementation,math,sortings" "A compass points directly toward the morning star. It can only point in one of eight directions: the four cardinal directions (N, S, E, W) or some combination (NW, NE, SW, SE). Otherwise, it will break.  The directions the compass can point. There are nn distinct points with integer coordinates on a plane. How many ways can you put a compass at one point and the morning star at another so that the compass does not break?" 1500.0                       
                         1849C "Binary String Copying" "binary search,brute force,data structures,hashing,strings" "You are given a string s consisting of n characters 0 and/or 1.You make m copies of this string, let the i-th copy be the string ti. Then you perform exactly one operation on each of the copies: for the i-th copy, you sort its substring [li;ri] (the substring from the li-th character to the ri-th character, both endpoints inclusive). Note that each operation affects only one copy, and each copy is affected by only one operation.Your task is to calculate the number of different strings among t1,t2,\xe2\x80\xa6,tm. Note that the initial string s should be counted only if at least one of the copies stays the same after the operation." 1600.0                       
                         1847A "The Man who became a God" greedy,sortings "Kars is tired and resentful of the narrow mindset of his village since they are content with staying where they are and are not trying to become the perfect life form. Being a top-notch inventor, Kars wishes to enhance his body and become the perfect life form. Unfortunately, n of the villagers have become suspicious of his ideas. The i-th villager has a suspicion of ai on him. Individually each villager is scared of Kars, so they form into groups to be more powerful.The power of the group of villagers from l to r be defined as f(l,r) where f(l,r)=|al\xe2\x88\x92al+1|+|al+1\xe2\x88\x92al+2|+\xe2\x80\xa6+|ar\xe2\x88\x921\xe2\x88\x92ar|.Here |x\xe2\x88\x92y| is the absolute value of x\xe2\x88\x92y. A group with only one villager has a power of 0.Kars wants to break the villagers into exactly k contiguous subgroups so that the sum of their power is minimized. Formally, he must find k\xe2\x88\x921 positive integers 1\xe2\x89\xa4r1<r2<\xe2\x80\xa6<rk\xe2\x88\x921<n such that f(1,r1)+f(r1+1,r2)+\xe2\x80\xa6+f(rk\xe2\x88\x921+1,n) is minimised. Help Kars in finding the minimum value of f(1,r1)+f(r1+1,r2)+\xe2\x80\xa6+f(rk\xe2\x88\x921+1,n)." 800.0                       
                         1846F "Rudolph and Mimic" "constructive algorithms,implementation,interactive" "This is an interactive task.Rudolph is a scientist who studies alien life forms. There is a room in front of Rudolph with n different objects scattered around. Among the objects there is exactly one amazing creature \xe2\x80\x94 a mimic that can turn into any object. He has already disguised himself in this room and Rudolph needs to find him by experiment.The experiment takes place in several stages. At each stage, the following happens: Rudolf looks at all the objects in the room and writes down their types. The type of each object is indicated by a number; there can be several objects of the same type. After inspecting, Rudolph can point to an object that he thinks is a mimic. After that, the experiment ends. Rudolph only has one try, so if he is unsure of the mimic\'s position, he does the next step instead. Rudolf can remove any number of objects from the room (possibly zero). Then Rudolf leaves the room and at this time all objects, including the mimic, are mixed with each other, their order is changed, and the mimic can transform into any other object (even one that is not in the room). After this, Rudolf returns to the room and repeats the stage. The mimic may not change appearance, but it can not remain a same object for more than two stages in a row.Rudolf\'s task is to detect mimic in no more than five stages." 1800.0                       
                         1846D "Rudolph and Christmas Tree" "constructive algorithms,geometry,math" "Rudolph drew a beautiful Christmas tree and decided to print the picture. However, the ink in the cartridge often runs out at the most inconvenient moment. Therefore, Rudolph wants to calculate in advance how much green ink he will need.The tree is a vertical trunk with identical triangular branches at different heights. The thickness of the trunk is negligible.Each branch is an isosceles triangle with base d and height h, whose base is perpendicular to the trunk. The triangles are arranged upward at an angle, and the trunk passes exactly in the middle. The base of the i-th triangle is located at a height of yi.The figure below shows an example of a tree with d=4,h=2 and three branches with bases at heights [1,4,5].  Help Rudolph calculate the total area of the tree branches." 1200.0                       
                         1843F2 "Omsk Metro (hard version)" "data structures,dfs and similar,divide and conquer,dp,math,trees" "This is the hard version of the problem. The only difference between the simple and hard versions is that in this version u can take any possible value.As is known, Omsk is the capital of Berland. Like any capital, Omsk has a well-developed metro system. The Omsk metro consists of a certain number of stations connected by tunnels, and between any two stations there is exactly one path that passes through each of the tunnels no more than once. In other words, the metro is a tree.To develop the metro and attract residents, the following system is used in Omsk. Each station has its own weight x\xe2\x88\x88{\xe2\x88\x921,1}. If the station has a weight of \xe2\x88\x921, then when the station is visited by an Omsk resident, a fee of 1 burle is charged. If the weight of the station is 1, then the Omsk resident is rewarded with 1 burle.Omsk Metro currently has only one station with number 1 and weight x=1. Every day, one of the following events occurs:  A new station with weight x is added to the station with number vi, and it is assigned a number that is one greater than the number of existing stations.  Alex, who lives in Omsk, wonders: is there a subsegment\xe2\x80\xa0 (possibly empty) of the path between vertices u and v such that, by traveling along it, exactly k burles can be earned (if k<0, this means that k burles will have to be spent on travel). In other words, Alex is interested in whether there is such a subsegment of the path that the sum of the weights of the vertices in it is equal to k. Note that the subsegment can be empty, and then the sum is equal to 0. You are a friend of Alex, so your task is to answer Alex\'s questions.\xe2\x80\xa0Subsegment \xe2\x80\x94 continuous sequence of elements." 2300.0                       
                         1842G "Tenzing and Random Operations" combinatorics,dp,math,probabilities "Yet another random problem.Tenzing has an array a of length n and an integer v.Tenzing will perform the following operation m times:  Choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n uniformly at random.  For all j such that i\xe2\x89\xa4j\xe2\x89\xa4n, set aj:=aj+v. Tenzing wants to know the expected value of \xe2\x88\x8fni=1ai after performing the m operations, modulo 109+7.Formally, let M=109+7. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output the integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 2800.0                       
                         1842F "Tenzing and Tree" "dfs and similar,greedy,shortest paths,sortings,trees" "Tenzing has an undirected tree of n vertices.Define the value of a tree with black and white vertices in the following way. The value of an edge is the absolute difference between the number of black nodes in the two components of the tree after deleting the edge. The value of the tree is the sum of values over all edges.For all k such that 0\xe2\x89\xa4k\xe2\x89\xa4n, Tenzing wants to know the maximum value of the tree when k vertices are painted black and n\xe2\x88\x92k vertices are painted white." 2500.0                       
                         1842B "Tenzing and Books" bitmasks,greedy,math "Tenzing received 3n books from his fans. The books are arranged in 3 stacks with n books in each stack. Each book has a non-negative integer difficulty rating.Tenzing wants to read some (possibly zero) books. At first, his knowledge is 0.To read the books, Tenzing will choose a non-empty stack, read the book on the top of the stack, and then discard the book. If Tenzing\'s knowledge is currently u, then his knowledge will become u|v after reading a book with difficulty rating v. Here | denotes the bitwise OR operation. Note that Tenzing can stop reading books whenever he wants.Tenzing\'s favourite number is x. Can you help Tenzing check if it is possible for his knowledge to become x?" 1100.0                       
                         1841E "Fill the Matrix" "data structures,greedy,math" "There is a square matrix, consisting of n rows and n columns of cells, both numbered from 1 to n. The cells are colored white or black. Cells from 1 to ai are black, and cells from ai+1 to n are white, in the i-th column.You want to place m integers in the matrix, from 1 to m. There are two rules:   each cell should contain at most one integer;  black cells should not contain integers. The beauty of the matrix is the number of such j that j+1 is written in the same row, in the next column as j (in the neighbouring cell to the right).What\'s the maximum possible beauty of the matrix?" 2200.0                       
                         1841B "Keep it Beautiful" implementation "The array [a1,a2,\xe2\x80\xa6,ak] is called beautiful if it is possible to remove several (maybe zero) elements from the beginning of the array and insert all these elements to the back of the array in the same order in such a way that the resulting array is sorted in non-descending order.In other words, the array [a1,a2,\xe2\x80\xa6,ak] is beautiful if there exists an integer i\xe2\x88\x88[0,k\xe2\x88\x921] such that the array [ai+1,ai+2,\xe2\x80\xa6,ak\xe2\x88\x921,ak,a1,a2,\xe2\x80\xa6,ai] is sorted in non-descending order.For example:  [3,7,7,9,2,3] is beautiful: we can remove four first elements and insert them to the back in the same order, and we get the array [2,3,3,7,7,9], which is sorted in non-descending order;  [1,2,3,4,5] is beautiful: we can remove zero first elements and insert them to the back, and we get the array [1,2,3,4,5], which is sorted in non-descending order;  [5,2,2,1] is not beautiful. Note that any array consisting of zero elements or one element is beautiful.You are given an array a, which is initially empty. You have to process q queries to it. During the i-th query, you will be given one integer xi, and you have to do the following:  if you can append the integer xi to the back of the array a so that the array a stays beautiful, you have to append it;  otherwise, do nothing. After each query, report whether you appended the given integer xi, or not." 1000.0                       
                         1839B Lamps greedy,sortings "You have n lamps, numbered by integers from 1 to n. Each lamp i has two integer parameters ai and bi.At each moment each lamp is in one of three states: it may be turned on, turned off, or broken.Initially all lamps are turned off. In one operation you can select one lamp that is turned off and turn it on (you can\'t turn on broken lamps). You receive bi points for turning lamp i on. The following happens after each performed operation:   Let\'s denote the number of lamps that are turned on as x (broken lamps do not count). All lamps i such that ai\xe2\x89\xa4x simultaneously break, whether they were turned on or off. Please note that broken lamps never count as turned on and that after a turned on lamp breaks, you still keep points received for turning it on.You can perform an arbitrary number of operations.Find the maximum number of points you can get." 1100.0                       
                         1838F "Stuck Conveyor" "binary search,constructive algorithms,interactive" "This is an interactive problem.There is an n by n grid of conveyor belts, in positions (1,1) through (n,n) of a coordinate plane. Every other square in the plane is empty. Each conveyor belt can be configured to move boxes up (\'^\'), down (\'v\'), left (\'<\'), or right (\'>\'). If a box moves onto an empty square, it stops moving.However, one of the n2 belts is stuck, and will always move boxes in the same direction, no matter how it is configured. Your goal is to perform a series of tests to determine which conveyor belt is stuck, and the direction in which it sends items.To achieve this, you can perform up to 25 tests. In each test, you assign a direction to all n2 belts, place a box on top of one of them, and then turn all of the conveyors on. One possible result of a query with n=4. In this case, the box starts at (2,2). If there were no stuck conveyor, it would end up at (5,4), but because of the stuck \'>\' conveyor at (3,3), it enters an infinite loop.The conveyors move the box around too quickly for you to see, so the only information you receive from a test is whether the box eventually stopped moving, and if so, the coordinates of its final position." 3000.0                       
                         1838A "Blackboard List" "constructive algorithms,math" "Two integers were written on a blackboard. After that, the following step was carried out n\xe2\x88\x922 times:  Select any two integers on the board, and write the absolute value of their difference on the board. After this process was complete, the list of n integers was shuffled. You are given the final list. Recover one of the initial two numbers. You do not need to recover the other one.You are guaranteed that the input can be generated using the above process." 800.0                       
                         1835B Lottery "binary search,brute force,greedy,math,two pointers" "n people indexed with integers from 1 to n came to take part in a lottery. Each received a ticket with an integer from 0 to m.In a lottery, one integer called target is drawn uniformly from 0 to m. k tickets (or less, if there are not enough participants) with the closest numbers to the target are declared the winners. In case of a draw, a ticket belonging to the person with a smaller index is declared a winner.Bytek decided to take part in the lottery. He knows the values on the tickets of all previous participants. He can pick whatever value he wants on his ticket, but unfortunately, as he is the last one to receive it, he is indexed with an integer n+1. Bytek wants to win the lottery. Thus, he wants to know what he should pick to maximize the chance of winning. He wants to know the smallest integer in case there are many such integers. Your task is to find it and calculate his chance of winning." 2500.0                       
                         1833D Flipper "brute force,constructive algorithms,greedy" "You are given a permutation p of length n.A permutation is an array consisting of n distinct integers from 1 to n in any order. For example, {2,3,1,5,4} is a permutation, while {1,2,2} is not (since 2 appears twice), and {1,3,4} is also not a permutation (as n=3, but the array contains 4).To the permutation p, you need to apply the following operation exactly once:  First you choose a segment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, a segment is a continuous sequence of numbers {pl,pl+1,\xe2\x80\xa6,pr\xe2\x88\x921,pr}) and reverse it. Reversing a segment means swapping pairs of numbers (pl,pr), (pl+1,pr\xe2\x88\x921), ..., (pl+i,pr\xe2\x88\x92i) (where l+i\xe2\x89\xa4r\xe2\x88\x92i).  Then you swap the prefix and suffix: [r+1,n] and [1,l\xe2\x88\x921] (note that these segments may be empty). For example, given n=5,p={2,3,1,5,4}, if you choose the segment [l=2,r=3], after reversing the segment p={2,1,3,5,4}, then you swap the segments [4,5] and [1,1]. Thus, p={5,4,1,3,2}. It can be shown that this is the maximum possible result for the given permutation.You need to output the lexicographically maximum permutation that can be obtained by applying the operation described exactly once.A permutation a is lexicographically greater than permutation b if there exists an i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that aj=bj for 1\xe2\x89\xa4j<i and ai>bi." 1400.0                       
                         1833A "Musical Puzzle" implementation,strings "Vlad decided to compose a melody on his guitar. Let\'s represent the melody as a sequence of notes corresponding to the characters \'a\', \'b\', \'c\', \'d\', \'e\', \'f\', and \'g\'.However, Vlad is not very experienced in playing the guitar and can only record exactly two notes at a time. Vlad wants to obtain the melody s, and to do this, he can merge the recorded melodies together. In this case, the last sound of the first melody must match the first sound of the second melody.For example, if Vlad recorded the melodies ""ab"" and ""ba"", he can merge them together and obtain the melody ""aba"", and then merge the result with ""ab"" to get ""abab"".Help Vlad determine the minimum number of melodies consisting of two notes that he needs to record in order to obtain the melody s." 800.0                       
                         1832C "Contrast Value" greedy,implementation "For an array of integers [a1,a2,\xe2\x80\xa6,an], let\'s call the value |a1\xe2\x88\x92a2|+|a2\xe2\x88\x92a3|+\xe2\x8b\xaf+|an\xe2\x88\x921\xe2\x88\x92an| the contrast of the array. Note that the contrast of an array of size 1 is equal to 0.You are given an array of integers a. Your task is to build an array of b in such a way that all the following conditions are met:  b is not empty, i.e there is at least one element;  b is a subsequence of a, i.e b can be produced by deleting some elements from a (maybe zero);  the contrast of b is equal to the contrast of a. What is the minimum possible size of the array b?" 1200.0                       
                         1832B "Maximum Sum" "brute force,sortings,two pointers" "You are given an array a1,a2,\xe2\x80\xa6,an, where all elements are different.You have to perform exactly k operations with it. During each operation, you do exactly one of the following two actions (you choose which to do yourself):  find two minimum elements in the array, and delete them;  find the maximum element in the array, and delete it. You have to calculate the maximum possible sum of elements in the resulting array." 1100.0                       
                         1830E "Bully Sort" "data structures,math" "On a permutation p of length n, we define a bully swap as follows:  Let i be the index of the largest element pi such that pi\xe2\x89\xa0i.  Let j be the index of the smallest element pj such that i<j.  Swap pi and pj. We define f(p) as the number of bully swaps we need to perform until p becomes sorted. Note that if p is the identity permutation, f(p)=0.You are given n and a permutation p of length n. You need to process the following q updates.In each update, you are given two integers x and y. You will swap px and py and then find the value of f(p).Note that the updates are persistent. Changes made to the permutation p will apply when processing future updates." 3500.0                       
                         1829E "The Lakes" "dfs and similar,dsu,graphs,implementation" "You are given an n\xc3\x97m grid a of non-negative integers. The value ai,j represents the depth of water at the i-th row and j-th column. A lake is a set of cells such that:  each cell in the set has ai,j>0, and  there exists a path between any pair of cells in the lake by going up, down, left, or right a number of times and without stepping on a cell with ai,j=0. The volume of a lake is the sum of depths of all the cells in the lake.Find the largest volume of a lake in the grid." 1100.0                       
                         1827D "Two Centroids" "data structures,dfs and similar,greedy,trees" "You are given a tree (an undirected connected acyclic graph) which initially only contains vertex 1. There will be several queries to the given tree. In the i-th query, vertex i+1 will appear and be connected to vertex pi (1\xe2\x89\xa4pi\xe2\x89\xa4i). After each query, please find out the least number of operations required to make the current tree has two centroids. In one operation, you can add one vertex and one edge to the tree such that it remains a tree.A vertex is called a centroid if its removal splits the tree into subtrees with at most \xe2\x8c\x8an2\xe2\x8c\x8b vertices each, with n as the number of vertices of the tree. For example, the centroid of the following tree is 3 because the biggest subtree after removing the centroid has 2 vertices.  In the next tree, vertex 1 and 2 are both centroids." 2800.0                       
                         1827C "Palindrome Partition" "binary search,brute force,data structures,dp,hashing,strings" "A substring is a continuous and non-empty segment of letters from a given string, without any reorders.An even palindrome is a string that reads the same backward as forward and has an even length. For example, strings ""zz"", ""abba"", ""abccba"" are even palindromes, but strings ""codeforces"", ""reality"", ""aba"", ""c"" are not.A beautiful string is an even palindrome or a string that can be partitioned into some smaller even palindromes.You are given a string s, consisting of n lowercase Latin letters. Count the number of beautiful substrings of s." 2600.0                       
                         1824D "LuoTianyi and the Function" "data structures" "LuoTianyi gives you an array a of n integers and the index begins from 1.Define g(i,j) as follows:  g(i,j) is the largest integer x that satisfies {ap:i\xe2\x89\xa4p\xe2\x89\xa4j}\xe2\x8a\x86{aq:x\xe2\x89\xa4q\xe2\x89\xa4j} while i\xe2\x89\xa4j;  and g(i,j)=0 while i>j. There are q queries. For each query you are given four integers l,r,x,y, you need to calculate r\xe2\x88\x91i=ly\xe2\x88\x91j=xg(i,j)." 3000.0                       
                         1823F "Random Walk" dp,graphs,math,probabilities,trees "You are given a tree consisting of n vertices and n\xe2\x88\x921 edges, and each vertex v has a counter c(v) assigned to it.Initially, there is a chip placed at vertex s and all counters, except c(s), are set to 0; c(s) is set to 1.Your goal is to place the chip at vertex t. You can achieve it by a series of moves. Suppose right now the chip is placed at the vertex v. In one move, you do the following:  choose one of neighbors to of vertex v uniformly at random (to is neighbor of v if and only if there is an edge {v,to} in the tree);  move the chip to vertex to and increase c(to) by 1; You\'ll repeat the move above until you reach the vertex t.For each vertex v calculate the expected value of c(v) modulo 998244353." 2600.0                       
                         1823E "Removing Graph" "brute force,dp,games,graphs,math" "Alice and Bob are playing a game on a graph. They have an undirected graph without self-loops and multiple edges. All vertices of the graph have degree equal to 2. The graph may consist of several components. Note that if such graph has n vertices, it will have exactly n edges.Alice and Bob take turn. Alice goes first. In each turn, the player can choose k (l\xe2\x89\xa4k\xe2\x89\xa4r; l<r) vertices that form a connected subgraph and erase these vertices from the graph, including all incident edges.The player who can\'t make a step loses.For example, suppose they are playing on the given graph with given l=2 and r=3:  A valid vertex set for Alice to choose at the first move is one of the following:   {1,2}  {1,3}  {2,3}  {4,5}  {4,6}  {5,6}  {1,2,3}  {4,5,6}  Suppose, Alice chooses subgraph {4,6}.Then a valid vertex set for Bob to choose at the first move is one of the following:   {1,2}  {1,3}  {2,3}  {1,2,3}  Suppose, Bob chooses subgraph {1,2,3}.Alice can\'t make a move, so she loses.You are given a graph of size n and integers l and r. Who will win if both Alice and Bob play optimally." 2500.0                       
                         1822G1 "Magic Triples (Easy Version)" "brute force,data structures,math,number theory" "This is the easy version of the problem. The only difference is that in this version, ai\xe2\x89\xa4106.For a given sequence of n integers a, a triple (i,j,k) is called magic if:   1\xe2\x89\xa4i,j,k\xe2\x89\xa4n.  i, j, k are pairwise distinct.  there exists a positive integer b such that ai\xe2\x8b\x85b=aj and aj\xe2\x8b\x85b=ak. Kolya received a sequence of integers a as a gift and now wants to count the number of magic triples for it. Help him with this task!Note that there are no constraints on the order of integers i, j and k." 1700.0                       
                         1822D Super-Permutation "constructive algorithms,math" "A permutation is a sequence n integers, where each integer from 1 to n appears exactly once. For example, [1], [3,5,2,1,4], [1,3,2] are permutations, while [2,3,2], [4,3,1], [0] are not.Given a permutation a, we construct an array b, where bi=(a1+a2+ \xe2\x80\xa6 +ai)modn.A permutation of numbers [a1,a2,\xe2\x80\xa6,an] is called a super-permutation if [b1+1,b2+1,\xe2\x80\xa6,bn+1] is also a permutation of length n.Grisha became interested whether a super-permutation of length n exists. Help him solve this non-trivial problem. Output any super-permutation of length n, if it exists. Otherwise, output \xe2\x88\x921." 1200.0                       
                         1822C "Bun Lover" math "Tema loves cinnabon rolls \xe2\x80\x94 buns with cinnabon and chocolate in the shape of a ""snail"".Cinnabon rolls come in different sizes and are square when viewed from above. The most delicious part of a roll is the chocolate, which is poured in a thin layer over the cinnabon roll in the form of a spiral and around the bun, as in the following picture:  Cinnabon rolls of sizes 4, 5, 6 For a cinnabon roll of size n, the length of the outer side of the square is n, and the length of the shortest vertical chocolate segment in the central part is one.Formally, the bun consists of two dough spirals separated by chocolate. A cinnabon roll of size n+1 is obtained from a cinnabon roll of size n by wrapping each of the dough spirals around the cinnabon roll for another layer.It is important that a cinnabon roll of size n is defined in a unique way.Tema is interested in how much chocolate is in his cinnabon roll of size n. Since Tema has long stopped buying small cinnabon rolls, it is guaranteed that n\xe2\x89\xa54.Answer this non-obvious question by calculating the total length of the chocolate layer." 800.0                       
                         1822A "TubeTube Feed" "brute force,implementation" "Mushroom Filippov cooked himself a meal and while having his lunch, he decided to watch a video on TubeTube. He can not spend more than t seconds for lunch, so he asks you for help with the selection of video.The TubeTube feed is a list of n videos, indexed from 1 to n. The i-th video lasts ai seconds and has an entertainment value bi. Initially, the feed is opened on the first video, and Mushroom can skip to the next video in 1 second (if the next video exists). Mushroom can skip videos any number of times (including zero).Help Mushroom choose one video that he can open and watch in t seconds. If there are several of them, he wants to choose the most entertaining one. Print the index of any appropriate video, or \xe2\x88\x921 if there is no such." 800.0                       
                         1819D "Misha and Apples" "brute force,data structures,dp,two pointers" "Schoolboy Misha got tired of doing sports programming, so he decided to quit everything and go to the magical forest to sell magic apples.His friend Danya came to the magical forest to visit Misha. What was his surprise when he found out that Misha found a lot of friends there, the same former sports programmers. And all of them, like Misha, have their own shop where they sell magic apples. To support his friends, who have changed their lives so drastically, he decided to buy up their entire assortment.The buying process works as follows: in total there are n stalls, numbered with integers from 1 to n, and m kinds of magic apples, numbered with integers from 1 to m. Each shop sells some number of kinds of apples. Danya visits all the shops in order of increasing number, starting with the first one. Upon entering the shop he buys one magic apple of each kind sold in that shop and puts them in his backpack.However, magical apples wouldn\'t be magical if they were all right. The point is that when two apples of the same type end up together in the backpack, all of the apples in it magically disappear. Importantly, the disappearance happens after Danya has put the apples in the backpack and left the shop.Upon returning home, Danya realized that somewhere in the forest he had managed to lose his backpack. Unfortunately, for some shops Danya had forgotten what assortment of apples there was. Remembering only for some shops, what kinds of magical apples were sold in them, he wants to know what is the maximum number of apples he could have in his backpack after all his purchases at best." 2800.0                       
                         1817A "Almost Increasing Subsequence" "binary search,data structures,greedy" "A sequence is almost-increasing if it does not contain three consecutive elements x,y,z such that x\xe2\x89\xa5y\xe2\x89\xa5z.You are given an array a1,a2,\xe2\x80\xa6,an and q queries.Each query consists of two integers 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. For each query, find the length of the longest almost-increasing subsequence of the subarray al,al+1,\xe2\x80\xa6,ar. A subsequence is a sequence that can be derived from the given sequence by deleting zero or more elements without changing the order of the remaining elements." 1500.0                       
                         1815F "OH NO1 (-2-3-4)" "constructive algorithms,graphs,math" "You are given an undirected graph with n vertices and 3m edges. The graph may contain multi-edges, but does not contain self-loops. The graph satisfies the following property: the given edges can be divided into m groups of 3, such that each group is a triangle.A triangle is defined as three edges (a,b), (b,c) and (c,a) for some three distinct vertices a,b,c (1\xe2\x89\xa4a,b,c\xe2\x89\xa4n).Initially, each vertex v has a non-negative integer weight av. For every edge (u,v) in the graph, you should perform the following operation exactly once:   Choose an integer x between 1 and 4. Then increase both au and av by x. After performing all operations, the following requirement should be satisfied: if u and v are connected by an edge, then au\xe2\x89\xa0av.It can be proven this is always possible under the constraints of the task. Output a way to do so, by outputting the choice of x for each edge. It is easy to see that the order of operations does not matter. If there are multiple valid answers, output any." 3500.0                       
                         1812J "Unmysterious Language" "*special problem,constructive algorithms,strings" "There is an unmysterious language. You should make a submission in this language, and the judge will read your submission to determine whether it is accepted.You can only submit in the Mysterious Language we have provided. You can view the judge\'s response by clicking the submission ID on the ""My Submissions"" page." -999.0                       
                         1812F Factorization "*special problem,number theory" "What is the largest prime factor of n?" -999.0                       
                         1810H "Last Number" combinatorics,math "You are given a multiset S. Initially, S={1,2,3,\xe2\x80\xa6,n}.You will perform the following operation n\xe2\x88\x921 times.  Choose the largest number Smax in S and the smallest number Smin in S. Remove the two numbers from S, and add Smax\xe2\x88\x92Smin into S. It\'s easy to show that there will be exactly one number left after n\xe2\x88\x921 operations. Output that number." 2900.0                       
                         1810B Candies "constructive algorithms,math,number theory" "This problem is about candy. Initially, you only have 1 candy, and you want to have exactly n candies.You can use the two following spells in any order at most 40 times in total.  Assume you have x candies now. If you use the first spell, then x candies become 2x\xe2\x88\x921 candies.  Assume you have x candies now. If you use the second spell, then x candies become 2x+1 candies. Construct a sequence of spells, such that after using them in order, you will have exactly n candies, or determine it\'s impossible." 800.0                       
                         1809B "Points on Plane" "binary search,greedy,math" "You are given a two-dimensional plane, and you need to place n chips on it. You can place a chip only at a point with integer coordinates. The cost of placing a chip at the point (x,y) is equal to |x|+|y| (where |a| is the absolute value of a).The cost of placing n chips is equal to the maximum among the costs of each chip.You need to place n chips on the plane in such a way that the Euclidean distance between each pair of chips is strictly greater than 1, and the cost is the minimum possible." 1000.0                       
                         1808E3 "Minibuses on Venus (hard version)" "brute force,combinatorics,dp,math" "This is the hard version of the problem. The only difference between the three versions is the constraints on n and k. You can make hacks only if all versions of the problem are solved.Maxim is a minibus driver on Venus.To ride on Maxim\'s minibus, you need a ticket. Each ticket has a number consisting of n digits. However, as we know, the residents of Venus use a numeral system with base k, rather than the decimal system. Therefore, the ticket number can be considered as a sequence of n integers from 0 to k\xe2\x88\x921, inclusive.The residents of Venus consider a ticket to be lucky if there is a digit on it that is equal to the sum of the remaining digits, modulo k. For example, if k=10, then the ticket 7135 is lucky because 7+1+5\xe2\x89\xa13(mod10). On the other hand, the ticket 7136 is not lucky because no digit is equal to the sum of the others modulo 10.Once, while on a trip, Maxim wondered: how many lucky tickets exist? At the same time, Maxim understands that this number can be very large, so he is interested only in the answer modulo some prime number m." 2800.0                       
                         1806F1 "GCD Master (easy version)" "greedy,math,number theory,sortings" "This is the easy version of the problem. The only difference between the two versions is the constraint on m. You can make hacks only if both versions of the problem are solved.You are given an array a of length n and two integers m and k. Each element in a satisfies 1\xe2\x89\xa4ai\xe2\x89\xa4m.In one operation, you choose two indices i and j such that 1\xe2\x89\xa4i<j\xe2\x89\xa4|a|, then append gcd(ai,aj) to the back of the array and delete ai and aj from the array. Note that the length of the array decreases by one after this operation.Find the maximum possible sum of the array after performing exactly k operations." 2900.0                       
                         1806C "Sequence Master" "brute force,constructive algorithms,math" "For some positive integer m, YunQian considers an array q of 2m (possibly negative) integers good, if and only if for every possible subsequence of q that has length m, the product of the m elements in the subsequence is equal to the sum of the m elements that are not in the subsequence. Formally, let U={1,2,\xe2\x80\xa6,2m}. For all sets S\xe2\x8a\x86U such that |S|=m, \xe2\x88\x8fi\xe2\x88\x88Sqi=\xe2\x88\x91i\xe2\x88\x88U\xe2\x88\x96Sqi.Define the distance between two arrays a and b both of length k to be k\xe2\x88\x91i=1|ai\xe2\x88\x92bi|.You are given a positive integer n and an array p of 2n integers.Find the minimum distance between p and q over all good arrays q of length 2n. It can be shown for all positive integers n, at least one good array exists. Note that you are not required to construct the array q that achieves this minimum distance." 1600.0                       
                         1804F "Approximate Diameter" "binary search,divide and conquer,graphs,shortest paths" "Jack has a graph of n vertices and m edges. All edges are bidirectional and of unit length. The graph is connected, i. e. there exists a path between any two of its vertices. There can be more than one edge connecting the same pair of vertices. The graph can contain self-loops, i. e. edges connecting a node to itself.The distance between vertices u and v is denoted as \xcf\x81(u,v) and equals the minimum possible number of edges on a path between u and v. The diameter of graph G is defined as the maximum possible distance between some pair of its vertices. We denote it as d(G). In other words, d(G)=max1\xe2\x89\xa4u,v\xe2\x89\xa4n\xcf\x81(u,v).Jack plans to consecutively apply q updates to his graph. Each update adds exactly one edge to the graph. Denote as Gi the graph after exactly i updates are made. Jack wants to calculate q+1 values d(G0),d(G1),d(G2),\xe2\x80\xa6,d(Gq).However, Jack suspects that finding the exact diameters of q+1 graphs might be a difficult task, so he is fine with approximate answers that differ from the correct answers no more than twice. Formally, Jack wants to find a sequence of positive integers a0,a1,a2,\xe2\x80\xa6,aq such that \xe2\x8c\x88d(Gi)2\xe2\x8c\x89\xe2\x89\xa4ai\xe2\x89\xa42\xe2\x8b\x85d(Gi) for each i.HacksYou cannot make hacks in this problem." 2700.0                       
                         1804B Vaccination greedy,implementation "Ethan runs a vaccination station to help people combat the seasonal flu. He analyses the historical data in order to develop an optimal strategy for vaccine usage.Consider there are n patients coming to the station on a particular day. The i-th patient comes at the moment ti. We know that each of these patients can be asked to wait for no more than w time moments. That means the i-th patient can get vaccine at moments ti,ti+1,\xe2\x80\xa6,ti+w.Vaccines come in packs, each pack consists of k doses. Each patient needs exactly one dose. Packs are stored in a special fridge. After a pack is taken out of the fridge and opened, it can no longer be put back. The lifetime of the vaccine outside the fridge is d moments of time. Thus, if the pack was taken out of the fridge and opened at moment x, its doses can be used to vaccinate patients at moments x,x+1,\xe2\x80\xa6,x+d. At moment x+d+1 all the remaining unused doses of this pack are thrown away.Assume that the vaccination station has enough staff to conduct an arbitrary number of operations at every moment of time. What is the minimum number of vaccine packs required to vaccinate all n patients?" 1000.0                       
                         1801A "The Very Beautiful Blanket" "bitmasks,constructive algorithms" "Kirill wants to weave the very beautiful blanket consisting of n\xc3\x97m of the same size square patches of some colors. He matched some non-negative integer to each color. Thus, in our problem, the blanket can be considered a B matrix of size n\xc3\x97m consisting of non-negative integers.Kirill considers that the blanket is very beautiful, if for each submatrix A of size 4\xc3\x974 of the matrix B is true: A11\xe2\x8a\x95A12\xe2\x8a\x95A21\xe2\x8a\x95A22=A33\xe2\x8a\x95A34\xe2\x8a\x95A43\xe2\x8a\x95A44, A13\xe2\x8a\x95A14\xe2\x8a\x95A23\xe2\x8a\x95A24=A31\xe2\x8a\x95A32\xe2\x8a\x95A41\xe2\x8a\x95A42,where \xe2\x8a\x95 means bitwise exclusive ORKirill asks you to help her weave a very beautiful blanket, and as colorful as possible!He gives you two integers n and m. Your task is to generate a matrix B of size n\xc3\x97m, which corresponds to a very beautiful blanket and in which the number of different numbers maximized." 1600.0                       
                         1800E1 "Unforgivable Curse (easy version)" "brute force,constructive algorithms,dsu,graphs,greedy,strings" "This is an easy version of the problem. In this version, k is always 3.The chief wizard of the Wizengamot once caught the evil wizard Drahyrt, but the evil wizard has returned and wants revenge on the chief wizard. So he stole spell s from his student Harry.The spell \xe2\x80\x94 is a n-length string of lowercase Latin letters.Drahyrt wants to replace spell with an unforgivable curse \xe2\x80\x94 string t.Drahyrt, using ancient magic, can swap letters at a distance k or k+1 in spell as many times as he wants. In this version of the problem, you can swap letters at a distance of 3 or 4. In other words, Drahyrt can change letters in positions i and j in spell s if |i\xe2\x88\x92j|=3 or |i\xe2\x88\x92j|=4.For example, if s= ""talant"" and t= ""atltna"", Drahyrt can act as follows:  swap the letters at positions 1 and 4 to get spell ""aaltnt"".  swap the letters at positions 2 and 6 to get spell ""atltna"". You are given spells s and t. Can Drahyrt change spell s to t?" 1400.0                       
                         1799D1 "Hot Start Up (easy version)" dp "This is an easy version of the problem. The constraints of t, n, k are the only difference between versions.You have a device with two CPUs. You also have k programs, numbered 1 through k, that you can run on the CPUs. The i-th program (1\xe2\x89\xa4i\xe2\x89\xa4k) takes coldi seconds to run on some CPU. However, if the last program we ran on this CPU was also program i, it only takes hoti seconds (hoti\xe2\x89\xa4coldi). Note that this only applies if we run program i multiple times consecutively  \xe2\x80\x94 if we run program i, then some different program, then program i again, it will take coldi seconds the second time.You are given a sequence a1,a2,\xe2\x80\xa6,an of length n, consisting of integers from 1 to k. You need to use your device to run programs a1,a2,\xe2\x80\xa6,an in sequence. For all 2\xe2\x89\xa4i\xe2\x89\xa4n, you cannot start running program ai until program ai\xe2\x88\x921 has completed.Find the minimum amount of time needed to run all programs a1,a2,\xe2\x80\xa6,an in sequence." 1900.0                       
                         1799A "Recent Actions" "data structures,greedy,implementation,math" "On Codeforces the ""Recent Actions"" field shows the last n posts with recent actions.Initially, there are posts 1,2,\xe2\x80\xa6,n in the field (this is in order from top to down). Also there are infinitely many posts not in the field, numbered with integers n+1,n+2,\xe2\x80\xa6.When recent action happens in the post p:  If it is in the ""Recent Actions"" field, it moves from its position to the top position.  Otherwise, it is added to the top position, and the post on the down position is removed from the ""Recent Actions"" field. You know, that the next m recent actions will happen in the posts p1,p2,\xe2\x80\xa6,pm (n+1\xe2\x89\xa4pi\xe2\x89\xa4n+m) in the moments of time 1,2,\xe2\x80\xa6,m. Note, that recent actions only happen with posts with numbers \xe2\x89\xa5n+1.For each post i (1\xe2\x89\xa4i\xe2\x89\xa4n), find the first time it will be removed from the ""Recent Actions"" field or say, that it won\'t be removed." 800.0                       
                         1796D "Maximum Subarray" "data structures,dp,greedy,two pointers" "You are given an array a1,a2,\xe2\x80\xa6,an, consisting of n integers. You are also given two integers k and x.You have to perform the following operation exactly once: add x to the elements on exactly k distinct positions, and subtract x from all the others.For example, if a=[2,\xe2\x88\x921,2,3], k=1, x=2, and we have picked the first element, then after the operation the array a=[4,\xe2\x88\x923,0,1].Let f(a) be the maximum possible sum of a subarray of a. The subarray of a is a contiguous part of the array a, i.\xe2\x80\x89e. the array ai,ai+1,\xe2\x80\xa6,aj for some 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n. An empty subarray should also be considered, it has sum 0.Let the array a\xe2\x80\xb2 be the array a after applying the aforementioned operation. Apply the operation in such a way that f(a\xe2\x80\xb2) is the maximum possible, and print the maximum possible value of f(a\xe2\x80\xb2)." 2000.0                       
                         1796B "Asterisk-Minor Template" implementation,strings "You are given two strings a and b, consisting of lowercase Latin letters.A template t is string, consisting of lowercase Latin letters and asterisks (character \'*\'). A template is called asterisk-minor if the number of asterisks in it is less than or equal to the number of letters in it.A string s is said to be matching a template t if you can replace each asterisk in t with a string of lowercase Latin letters (possibly, an empty string) so that it becomes equal to s.Find an asterisk-minor template such that both a and b match it, or report that such a template doesn\'t exist. If there are multiple answers, print any of them." 1000.0                       
                         1794A "Prefix and Suffix Array" strings "Marcos loves strings a lot, so he has a favorite string s consisting of lowercase English letters. For this string, he wrote down all its non-empty prefixes and suffixes (except for s) on a piece of paper in arbitrary order. You see all these strings and wonder if Marcos\' favorite string is a palindrome or not. So, your task is to decide whether s is a palindrome by just looking at the piece of paper.A string a is a prefix of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the end.A string a is a suffix of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning.A palindrome is a string that reads the same backward as forward, for example, strings ""gg"", ""ioi"", ""abba"", ""icpci"" are palindromes, but strings ""codeforces"", ""abcd"", ""alt"" are not." 800.0                       
                         1793C "Dora and Search" "constructive algorithms,data structures,two pointers" "As you know, the girl Dora is always looking for something. This time she was given a permutation, and she wants to find such a subsegment of it that none of the elements at its ends is either the minimum or the maximum of the entire subsegment. More formally, you are asked to find the numbers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that al\xe2\x89\xa0min(al,al+1,\xe2\x80\xa6,ar), al\xe2\x89\xa0max(al,al+1,\xe2\x80\xa6,ar) and ar\xe2\x89\xa0min(al,al+1,\xe2\x80\xa6,ar), ar\xe2\x89\xa0max(al,al+1,\xe2\x80\xa6,ar).A permutation of length n is an array consisting of n distinct integers from 1 to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 occurs twice in the array) and [1,3,4] is also not a permutation (n=3, but 4 is present in the array).Help Dora find such a subsegment, or tell her that such a subsegment does not exist." 1200.0                       
                         1791A "Codeforces Checking" implementation,strings "Given a lowercase Latin character (letter), check if it appears in the string codeforces." 800.0                       
                         1790C Premutation "brute force,implementation,math" "A sequence of n numbers is called permutation if it contains all integers from 1 to n exactly once. For example, the sequences [3,1,4,2], [1] and [2,1] are permutations, but [1,2,1], [0,1] and [1,3,4] \xe2\x80\x94 are not.Kristina had a permutation p of n elements. She wrote it on the whiteboard n times in such a way that:   while writing the permutation at the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) time she skipped the element pi  So, she wrote in total n sequences of length n\xe2\x88\x921 each.For example, suppose Kristina had a permutation p = [4,2,1,3] of length 4. Then she did the following:   Wrote the sequence [2,1,3], skipping the element p1=4 from the original permutation.  Wrote the sequence [4,1,3], skipping the element p2=2 from the original permutation.  Wrote the sequence [4,2,3], skipping the element p3=1 from the original permutation.  Wrote the sequence [4,2,1], skipping the element p4=3 from the original permutation. You know all n of sequences that have been written on the whiteboard, but you do not know the order in which they were written. They are given in arbitrary order. Reconstruct the original permutation from them.For example, if you know the sequences [4,2,1], [4,2,3], [2,1,3], [4,1,3], then the original permutation will be p = [4,2,1,3]." 1000.0                       
                         1788D "Moving Dots" "binary search,brute force,combinatorics,math,two pointers" "We play a game with n dots on a number line.The initial coordinate of the i-th dot is xi. These coordinates are distinct. Every dot starts moving simultaneously with the same constant speed.Each dot moves in the direction of the closest dot (different from itself) until it meets another dot. In the case of a tie, it goes to the left. Two dots meet if they are in the same coordinate, after that, they stop moving.After enough time, every dot stops moving. The result of a game is the number of distinct coordinates where the dots stop.Because this game is too easy, calculate the sum of results when we play the game for every subset of the given n dots that has at least two dots. As the result can be very large, print the sum modulo 109+7." 2000.0                       
                         1787G "Colorful Tree Again" "brute force,data structures,trees" "An edge-weighted tree of n nodes is given with each edge colored in some color. Each node of this tree can be blocked or unblocked, all nodes are unblocked initially.A simple path is a path in a graph that does not have repeating nodes. The length of a path is defined as the sum of weights of all edges on the path.A path is good when it is a simple path consisting of edges of the same color c, all edges of color c are on this path, and every node on the path is unblocked.You need to operate 2 kinds of queries:   block a node,  unblock a node. After each query, print the maximum length among all good paths. If there are no good paths, print 0." 3000.0                       
                         1787D "Game on Axis" "combinatorics,dfs and similar,dsu,graphs,implementation" "There are n points 1,2,\xe2\x80\xa6,n, each point i has a number ai on it. You\'re playing a game on them. Initially, you are at point 1. When you are at point i, take following steps:  If 1\xe2\x89\xa4i\xe2\x89\xa4n, go to i+ai,  Otherwise, the game ends. Before the game begins, you can choose two integers x and y satisfying 1\xe2\x89\xa4x\xe2\x89\xa4n, \xe2\x88\x92n\xe2\x89\xa4y\xe2\x89\xa4n and replace ax with y (set ax:=y). Find the number of distinct pairs (x,y) such that the game that you start after making the change ends in a finite number of steps.Notice that you do not have to satisfy ax\xe2\x89\xa0y." 1900.0                       
                         1784F "Minimums or Medians"  "Vika has a set of all consecutive positive integers from 1 to 2n, inclusive.Exactly k times Vika will choose and perform one of the following two actions:   take two smallest integers from her current set and remove them;  take two median integers from her current set and remove them. Recall that medians are the integers located exactly in the middle of the set if you write down its elements in increasing order. Note that Vika\'s set always has an even size, thus the pair of median integers is uniquely defined. For example, two median integers of the set {1,5,6,10,15,16,18,23} are 10 and 15.How many different sets can Vika obtain in the end, after k actions? Print this number modulo 998244353. Two sets are considered different if some integer belongs to one of them but not to the other." 3400.0                       
                         1783G "Weighed Tree Radius" "data structures,divide and conquer,implementation,trees" "You are given a tree of n vertices and n\xe2\x88\x921 edges. The i-th vertex has an initial weight ai.Let the distance dv(u) from vertex v to vertex u be the number of edges on the path from v to u. Note that dv(u)=du(v) and dv(v)=0.Let the weighted distance wv(u) from v to u be wv(u)=dv(u)+au. Note that wv(v)=av and wv(u)\xe2\x89\xa0wu(v) if au\xe2\x89\xa0av.Analogically to usual distance, let\'s define the eccentricity e(v) of vertex v as the greatest weighted distance from v to any other vertex (including v itself), or e(v)=max1\xe2\x89\xa4u\xe2\x89\xa4nwv(u).Finally, let\'s define the radius r of the tree as the minimum eccentricity of any vertex, or r=min1\xe2\x89\xa4v\xe2\x89\xa4ne(v).You need to perform m queries of the following form:   vj xj \xe2\x80\x94 assign avj=xj. After performing each query, print the radius r of the current tree." 2800.0                       
                         1783A "Make it Beautiful" "constructive algorithms,math,sortings" "An array a is called ugly if it contains at least one element which is equal to the sum of all elements before it. If the array is not ugly, it is beautiful.For example:  the array [6,3,9,6] is ugly: the element 9 is equal to 6+3;  the array [5,5,7] is ugly: the element 5 (the second one) is equal to 5;  the array [8,4,10,14] is beautiful: 8\xe2\x89\xa00, 4\xe2\x89\xa08, 10\xe2\x89\xa08+4, 14\xe2\x89\xa08+4+10, so there is no element which is equal to the sum of all elements before it. You are given an array a such that 1\xe2\x89\xa4a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4an\xe2\x89\xa4100. You have to reorder the elements of a in such a way that the resulting array is beautiful. Note that you are not allowed to insert new elements or erase existing ones, you can only change the order of elements of a. You are allowed to keep the array a unchanged, if it is beautiful." 800.0                       
                         1781D "Many Perfect Squares" "brute force,math,number theory" "You are given a set a1,a2,\xe2\x80\xa6,an of distinct positive integers.We define the squareness of an integer x as the number of perfect squares among the numbers a1+x,a2+x,\xe2\x80\xa6,an+x.Find the maximum squareness among all integers x between 0 and 1018, inclusive.Perfect squares are integers of the form t2, where t is a non-negative integer. The smallest perfect squares are 0,1,4,9,16,\xe2\x80\xa6." 1800.0                       
                         1779A "Hall of Fame" "constructive algorithms,greedy,strings" "Thalia is a Legendary Grandmaster in chess. She has n trophies in a line numbered from 1 to n (from left to right) and a lamp standing next to each of them (the lamps are numbered as the trophies).A lamp can be directed either to the left or to the right, and it illuminates all trophies in that direction (but not the one it is next to). More formally, Thalia has a string s consisting only of characters \'L\' and \'R\' which represents the lamps\' current directions. The lamp i illuminates:  trophies 1,2,\xe2\x80\xa6,i\xe2\x88\x921 if si is \'L\';  trophies i+1,i+2,\xe2\x80\xa6,n if si is \'R\'. She can perform the following operation at most once:  Choose an index i (1\xe2\x89\xa4i<n);  Swap the lamps i and i+1 (without changing their directions). That is, swap si with si+1. Thalia asked you to illuminate all her trophies (make each trophy illuminated by at least one lamp), or to tell her that it is impossible to do so. If it is possible, you can choose to perform an operation or to do nothing. Notice that lamps cannot change direction, it is only allowed to swap adjacent ones." 800.0                       
                         1778F "Maximizing Root" "dfs and similar,dp,graphs,math,number theory,trees" "You are given a rooted tree consisting of n vertices numbered from 1 to n. Vertex 1 is the root of the tree. Each vertex has an integer value. The value of i-th vertex is ai. You can do the following operation at most k times.  Choose a vertex v that has not been chosen before and an integer x such that x is a common divisor of the values of all vertices of the subtree of v. Multiply by x the value of each vertex in the subtree of v. What is the maximum possible value of the root node 1 after at most k operations? Formally, you have to maximize the value of a1.A tree is a connected undirected graph without cycles. A rooted tree is a tree with a selected vertex, which is called the root. The subtree of a node u is the set of all nodes y such that the simple path from y to the root passes through u. Note that u is in the subtree of u." 2600.0                       
                         1778A "Flip Flop Sum" greedy,implementation "You are given an array of n integers a1,a2,\xe2\x80\xa6,an. The integers are either 1 or \xe2\x88\x921. You have to perform the following operation exactly once on the array a:  Choose an index i (1\xe2\x89\xa4i<n) and flip the signs of ai and ai+1. Here, flipping the sign means \xe2\x88\x921 will be 1 and 1 will be \xe2\x88\x921. What is the maximum possible value of a1+a2+\xe2\x80\xa6+an after applying the above operation?" 800.0                       
                         1777B Emordnilap combinatorics,greedy,math "A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array). There are n!=n\xe2\x8b\x85(n\xe2\x88\x921)\xe2\x8b\x85(n\xe2\x88\x922)\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x851 different permutations of length n.Given a permutation p of n numbers, we create an array a consisting of 2n numbers, which is equal to p concatenated with its reverse. We then define the beauty of p as the number of inversions in a.The number of inversions in the array a is the number of pairs of indices i, j such that i<j and ai>aj.For example, for permutation p=[1,2], a would be [1,2,2,1]. The inversions in a are (2,4) and (3,4) (assuming 1-based indexing). Hence, the beauty of p is 2.Your task is to find the sum of beauties of all n! permutations of size n. Print the remainder we get when dividing this value by 1000000007 (109+7)." 900.0                       
                         1776H "Beppa and SwerChat" "two pointers" "Beppa and her circle of geek friends keep up to date on a group chat in the instant messaging app SwerChatTM.The group has n members, excluding Beppa. Each of those members has a unique ID between 1 and n. When a user opens a group chat, SwerChatTM displays the list of other members of that group, sorted by decreasing times of last seen online (so the member who opened the chat most recently is the first of the list). However, the times of last seen are not displayed.Today, Beppa has been busy all day: she has only opened the group chat twice, once at 9:00 and once at 22:00. Both times, she wrote down the list of members in the order they appeared at that time. Now she wonders: what is the minimum number of other members that must have been online at least once between 9:00 and 22:00?Beppa is sure that no two members are ever online at the same time and no members are online when Beppa opens the group chat at 9:00 and 22:00." 1300.0                       
                         1774H "Maximum Permutation" "constructive algorithms" "Ecrade bought a deck of cards numbered from 1 to n. Let the value of a permutation a of length n be n\xe2\x88\x92k+1mini=1 i+k\xe2\x88\x921\xe2\x88\x91j=iaj.Ecrade wants to find the most valuable one among all permutations of the cards. However, it seems a little difficult, so please help him!" 3500.0                       
                         1773J "Jumbled Trees" "constructive algorithms,math" "You are given an undirected connected graph with n vertices and m edges. Each edge has an associated counter, initially equal to 0. In one operation, you can choose an arbitrary spanning tree and add any value v to all edges of this spanning tree. Determine if it\'s possible to make every counter equal to its target value xi modulo prime p, and provide a sequence of operations that achieves it." 2900.0                       
                         1773F Football "constructive algorithms" "Scientists are researching an impact of football match results on the mood of football fans. They have a hypothesis that there is a correlation between the number of draws and fans\' desire to watch football matches in the future.In football, two teams play a match. The teams score goals throughout a match. A score ""x:y"" means that the team we observe scored x goals and conceded y goals. If x=y, then the match ends in a draw. If x>y, then the observed team wins, and if x<y, then it loses.To find out if there is a correlation, the scientists gathered information about the results of teams in lower leagues. The information they found is the number of matches played by the team (n), the number of goals scored in these matches (a), and the number of goals conceded in these matches (b). You are given this information for a single team. You are asked to calculate the minimum number of draws that could have happened during the team\'s matches and provide a list of match scores with the minimum number of draws." 800.0                       
                         1771E "Hossam and a Letter" "brute force,dp,implementation,two pointers" "Hossam bought a new piece of ground with length n and width m, he divided it into an n\xe2\x8b\x85m grid, each cell being of size 1\xc3\x971.Since Hossam\'s name starts with the letter \'H\', he decided to draw the capital letter \'H\' by building walls of size 1\xc3\x971 on some squares of the ground. Each square 1\xc3\x971 on the ground is assigned a quality degree: perfect, medium, or bad.The process of building walls to form up letter \'H\' has the following constraints:  The letter must consist of one horizontal and two vertical lines.  The vertical lines must not be in the same or neighboring columns.  The vertical lines must start in the same row and end in the same row (and thus have the same length).  The horizontal line should connect the vertical lines, but must not cross them.  The horizontal line can be in any row between the vertical lines (not only in the middle), except the top and the bottom one. (With the horizontal line in the top row the letter looks like \'n\', and in the bottom row like \'U\'.)  It is forbidden to build walls in cells of bad quality.  You can use at most one square of medium quality.  You can use any number of squares of perfect quality. Find the maximum number of walls that can be used to draw the letter \'H\'.Check the note for more clarification." 2500.0                       
                         1771C "Hossam and Trainees" "greedy,math,number theory" "Hossam has n trainees. He assigned a number ai for the i-th trainee. A pair of the i-th and j-th (i\xe2\x89\xa0j) trainees is called successful if there is an integer x (x\xe2\x89\xa52), such that x divides ai, and x divides aj.Hossam wants to know if there is a successful pair of trainees.Hossam is very tired now, so he asks you for your help!" 1600.0                       
                         1770F "Koxia and Sequence" "bitmasks,combinatorics,dp,math,number theory" "Mari has three integers n, x, and y.Call an array a of n non-negative integers good if it satisfies the following conditions:  a1+a2+\xe2\x80\xa6+an=x, and  a1|a2|\xe2\x80\xa6|an=y, where | denotes the bitwise OR operation. The score of a good array is the value of a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an, where \xe2\x8a\x95 denotes the bitwise XOR operation.Koxia wants you to find the total bitwise XOR of the scores of all good arrays. If there are no good arrays, output 0 instead." 3100.0                       
                         1766D "Lucky Chains" "math,number theory" "Let\'s name a pair of positive integers (x,y) lucky if the greatest common divisor of them is equal to 1 (gcd(x,y)=1).Let\'s define a chain induced by (x,y) as a sequence of pairs (x,y), (x+1,y+1), (x+2,y+2), \xe2\x80\xa6, (x+k,y+k) for some integer k\xe2\x89\xa50. The length of the chain is the number of pairs it consists of, or (k+1).Let\'s name such chain lucky if all pairs in the chain are lucky.You are given n pairs (xi,yi). Calculate for each pair the length of the longest lucky chain induced by this pair. Note that if (xi,yi) is not lucky itself, the chain will have the length 0." 1600.0                       
                         1766B Notepad# implementation "You want to type the string s, consisting of n lowercase Latin letters, using your favorite text editor Notepad#.Notepad# supports two kinds of operations:   append any letter to the end of the string;  copy a continuous substring of an already typed string and paste this substring to the end of the string. Can you type string s in strictly less than n operations?" 1000.0                       
                         1765I "Infinite Chess" "implementation,shortest paths" "The black king lives on a chess board with an infinite number of columns (files) and 8 rows (ranks). The columns are numbered with all integer numbers (including negative). The rows are numbered from 1 to 8.Initially, the black king is located on the starting square (xs,ys), and he needs to reach some target square (xt,yt). Unfortunately, there are also white pieces on the board, and they threaten the black king. After negotiations, the white pieces agreed to let the black king pass to the target square on the following conditions:  each turn, the black king makes a move according to the movement rules;  the black king cannot move to a square occupied by a white piece;  the black king cannot move to a square which is under attack by any white piece. A square is under attack if a white piece can reach it in one move according to the movement rules;  the white pieces never move. Help the black king find the minimum number of moves needed to reach the target square while not violating the conditions. The black king cannot leave the board at any time.The black king moves according to the movement rules below. Even though the white pieces never move, squares which they can reach in one move are considered to be under attack, so the black king cannot move into those squares.Below are the movement rules. Note that the pieces (except for the knight) cannot jump over other pieces.  a king moves exactly one square horizontally, vertically, or diagonally.  a rook moves any number of vacant squares horizontally or vertically.  a bishop moves any number of vacant squares diagonally.  a queen moves any number of vacant squares horizontally, vertically, or diagonally.  a knight moves to one of the nearest squares not on the same rank, file, or diagonal (this can be thought of as moving two squares horizontally then one square vertically, or moving one square horizontally then two squares vertically \xe2\x80\x94 i.\xe2\x80\x89e. in an ""L"" pattern). Knights are not blocked by other pieces, they can simply jump over them. There are no pawns on the board.   King and knight possible moves, respectively. Dotted line shows that knight can jump over other pieces.    Queen, bishop, and rook possible moves, respectively." 2800.0                       
                         1762G "Unequal Adjacent Elements" "constructive algorithms,sortings" "You are given an array a consisting of n positive integers. Find any permutation p of [1,2,\xe2\x80\xa6,n] such that:  pi\xe2\x88\x922<pi for all i, where 3\xe2\x89\xa4i\xe2\x89\xa4n, and  api\xe2\x88\x921\xe2\x89\xa0api for all i, where 2\xe2\x89\xa4i\xe2\x89\xa4n. Or report that no such permutation exists." 3100.0                       
                         1761A "Two Permutations" "brute force,constructive algorithms" "You are given three integers n, a, and b. Determine if there exist two permutations p and q of length n, for which the following conditions hold:  The length of the longest common prefix of p and q is a.  The length of the longest common suffix of p and q is b. A permutation of length n is an array containing each integer from 1 to n exactly once. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 800.0                       
                         1759C Thermostat "greedy,math,shortest paths" "Vlad came home and found out that someone had reconfigured the old thermostat to the temperature of a.The thermostat can only be set to a temperature from l to r inclusive, the temperature cannot change by less than x. Formally, in one operation you can reconfigure the thermostat from temperature a to temperature b if |a\xe2\x88\x92b|\xe2\x89\xa5x and l\xe2\x89\xa4b\xe2\x89\xa4r.You are given l, r, x, a and b. Find the minimum number of operations required to get temperature b from temperature a, or say that it is impossible." 1100.0                       
                         1758B "XOR = Average" "constructive algorithms" "You are given an integer n. Find a sequence of n integers a1,a2,\xe2\x80\xa6,an such that 1\xe2\x89\xa4ai\xe2\x89\xa4109 for all i and a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x8b\xaf\xe2\x8a\x95an=a1+a2+\xe2\x8b\xaf+ann, where \xe2\x8a\x95 represents the bitwise XOR.It can be proven that there exists a sequence of integers that satisfies all the conditions above." 900.0                       
                         1753A1 "Make Nonzero Sum (easy version)" "constructive algorithms,dp,greedy" "This is the easy version of the problem. The difference is that in this version the array can not contain zeros. You can make hacks only if both versions of the problem are solved.You are given an array [a1,a2,\xe2\x80\xa6an] consisting of integers \xe2\x88\x921 and 1. You have to build a partition of this array into the set of segments [l1,r1],[l2,r2],\xe2\x80\xa6,[lk,rk] with the following property:  Denote the alternating sum of all elements of the i-th segment as si: si = ali\xe2\x88\x92ali+1+ali+2\xe2\x88\x92ali+3+\xe2\x80\xa6\xc2\xb1ari. For example, the alternating sum of elements of segment [2,4] in array [1,0,\xe2\x88\x921,1,1] equals to 0\xe2\x88\x92(\xe2\x88\x921)+1=2.  The sum of si over all segments of partition should be equal to zero. Note that each si does not have to be equal to zero, this property is about sum of si over all segments of partition.The set of segments [l1,r1],[l2,r2],\xe2\x80\xa6,[lk,rk] is called a partition of the array a of length n if 1=l1\xe2\x89\xa4r1,l2\xe2\x89\xa4r2,\xe2\x80\xa6,lk\xe2\x89\xa4rk=n and ri+1=li+1 for all i=1,2,\xe2\x80\xa6k\xe2\x88\x921. In other words, each element of the array must belong to exactly one segment.You have to build a partition of the given array with properties described above or determine that such partition does not exist.Note that it is not required to minimize the number of segments in the partition." 1300.0                       
                         1748D ConstructOR "bitmasks,chinese remainder theorem,combinatorics,constructive algorithms,math,number theory" "You are given three integers a, b, and d. Your task is to find any integer x which satisfies all of the following conditions, or determine that no such integers exist:  0\xe2\x89\xa4x<260;  a|x is divisible by d;  b|x is divisible by d. Here, | denotes the bitwise OR operation." 2100.0                       
                         1748B "Diverse Substrings" "brute force,implementation,strings" "A non-empty digit string is diverse if the number of occurrences of each character in it doesn\'t exceed the number of distinct characters in it.For example:   string ""7"" is diverse because 7 appears in it 1 time and the number of distinct characters in it is 1;  string ""77"" is not diverse because 7 appears in it 2 times and the number of distinct characters in it is 1;  string ""1010"" is diverse because both 0 and 1 appear in it 2 times and the number of distinct characters in it is 2;  string ""6668"" is not diverse because 6 appears in it 3 times and the number of distinct characters in it is 2. You are given a string s of length n, consisting of only digits 0 to 9. Find how many of its n(n+1)2 substrings are diverse.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.Note that if the same diverse string appears in s multiple times, each occurrence should be counted independently. For example, there are two diverse substrings in ""77"" both equal to ""7"", so the answer for the string ""77"" is 2." 1400.0                       
                         1744C "Traffic Light" "binary search,implementation,two pointers" "You find yourself on an unusual crossroad with a weird traffic light. That traffic light has three possible colors: red (r), yellow (y), green (g). It is known that the traffic light repeats its colors every n seconds and at the i-th second the color si is on.That way, the order of the colors is described by a string. For example, if s=""rggry"", then the traffic light works as the following: red-green-green-red-yellow-red-green-green-red-yellow- ... and so on.More formally, you are given a string s1,s2,\xe2\x80\xa6,sn of length n. At the first second the color s1 is on, at the second \xe2\x80\x94 s2, ..., at the n-th second the color sn is on, at the n+1-st second the color s1 is on and so on.You need to cross the road and that can only be done when the green color is on. You know which color is on the traffic light at the moment, but you don\'t know the current moment of time. You need to find the minimum amount of time in which you are guaranteed to cross the road.You can assume that you cross the road immediately. For example, with s=""rggry"" and the current color r there are two options: either the green color will be on after 1 second, or after 3. That way, the answer is equal to 3 \xe2\x80\x94 that is the number of seconds that we are guaranteed to cross the road, if the current color is r." 1000.0                       
                         1743F "Intersection and Union" "data structures,dp,matrices,probabilities" "You are given n segments on the coordinate axis. The i-th segment is [li,ri]. Let\'s denote the set of all integer points belonging to the i-th segment as Si.Let A\xe2\x88\xaaB be the union of two sets A and B, A\xe2\x88\xa9B be the intersection of two sets A and B, and A\xe2\x8a\x95B be the symmetric difference of A and B (a set which contains all elements of A and all elements of B, except for the ones that belong to both sets).Let [op1,op2,\xe2\x80\xa6,opn\xe2\x88\x921] be an array where each element is either \xe2\x88\xaa, \xe2\x8a\x95, or \xe2\x88\xa9. Over all 3n\xe2\x88\x921 ways to choose this array, calculate the sum of the following values:|(((S1 op1 S2) op2 S3) op3 S4) \xe2\x80\xa6 opn\xe2\x88\x921 Sn|In this expression, |S| denotes the size of the set S." 2300.0                       
                         1743A Password "brute force,combinatorics,implementation,math" "Monocarp has forgotten the password to his mobile phone. The password consists of 4 digits from 0 to 9 (note that it can start with the digit 0).Monocarp remembers that his password had exactly two different digits, and each of these digits appeared exactly two times in the password. Monocarp also remembers some digits which were definitely not used in the password.You have to calculate the number of different sequences of 4 digits that could be the password for Monocarp\'s mobile phone (i.\xe2\x80\x89e. these sequences should meet all constraints on Monocarp\'s password)." 800.0                       
                         1742B Increasing greedy,implementation,sortings "You are given an array a of n positive integers. Determine if, by rearranging the elements, you can make the array strictly increasing. In other words, determine if it is possible to rearrange the elements such that a1<a2<\xe2\x8b\xaf<an holds." 800.0                       
                         1741E "Sending a Sequence Over the Network" dp "The sequence a is sent over the network as follows:  sequence a is split into segments (each element of the sequence belongs to exactly one segment, each segment is a group of consecutive elements of sequence);  for each segment, its length is written next to it, either to the left of it or to the right of it;  the resulting sequence b is sent over the network. For example, we needed to send the sequence a=[1,2,3,1,2,3]. Suppose it was split into segments as follows: [1]+[2,3,1]+[2,3]. Then we could have the following sequences:   b=[1,1,3,2,3,1,2,3,2],  b=[1,1,3,2,3,1,2,2,3],  b=[1,1,2,3,1,3,2,2,3],  b=[1,1,2,3,1,3,2,3,2]. If a different segmentation had been used, the sent sequence might have been different.The sequence b is given. Could the sequence b be sent over the network? In other words, is there such a sequence a that converting a to send it over the network could result in a sequence b?" 1600.0                       
                         1741C "Minimize the Thickness" "brute force,greedy,math,two pointers" "You are given a sequence a=[a1,a2,\xe2\x80\xa6,an] consisting of n positive integers.Let\'s call a group of consecutive elements a segment. Each segment is characterized by two indices: the index of its left end and the index of its right end. Denote by a[l,r] a segment of the sequence a with the left end in l and the right end in r, i.e. a[l,r]=[al,al+1,\xe2\x80\xa6,ar].For example, if a=[31,4,15,92,6,5], then a[2,5]=[4,15,92,6], a[5,5]=[6], a[1,6]=[31,4,15,92,6,5] are segments.We split the given sequence a into segments so that:   each element is in exactly one segment;  the sums of elements for all segments are equal. For example, if a = [55,45,30,30,40,100], then such a sequence can be split into three segments: a[1,2]=[55,45], a[3,5]=[30,30,40], a[6,6]=[100]. Each element belongs to exactly segment, the sum of the elements of each segment is 100.Let\'s define thickness of split as the length of the longest segment. For example, the thickness of the split from the example above is 3.Find the minimum thickness among all possible splits of the given sequence of a into segments in the required way." 1100.0                       
                         1741B "Funny Permutation" "constructive algorithms,math" "A sequence of n numbers is called permutation if it contains all numbers from 1 to n exactly once. For example, the sequences [3,1,4,2], [1] and [2,1] are permutations, but [1,2,1], [0,1] and [1,3,4] are not.For a given number n you need to make a permutation p such that two requirements are satisfied at the same time:  For each element pi, at least one of its neighbors has a value that differs from the value of pi by one. That is, for each element pi (1\xe2\x89\xa4i\xe2\x89\xa4n), at least one of its neighboring elements (standing to the left or right of pi) must be pi+1, or pi\xe2\x88\x921.  the permutation must have no fixed points. That is, for every i (1\xe2\x89\xa4i\xe2\x89\xa4n), pi\xe2\x89\xa0i must be satisfied. Let\'s call the permutation that satisfies these requirements funny.For example, let n=4. Then [4,3,1,2] is a funny permutation, since:   to the right of p1=4 is p2=p1\xe2\x88\x921=4\xe2\x88\x921=3;  to the left of p2=3 is p1=p2+1=3+1=4;  to the right of p3=1 is p4=p3+1=1+1=2;  to the left of p4=2 is p3=p4\xe2\x88\x921=2\xe2\x88\x921=1.  for all i is pi\xe2\x89\xa0i. For a given positive integer n, output any funny permutation of length n, or output -1 if funny permutation of length n does not exist." 800.0                       
                         1739A "Immobile Knight" implementation "There is a chess board of size n\xc3\x97m. The rows are numbered from 1 to n, the columns are numbered from 1 to m.Let\'s call a cell isolated if a knight placed in that cell can\'t move to any other cell on the board. Recall that a chess knight moves two cells in one direction and one cell in a perpendicular direction:   Find any isolated cell on the board. If there are no such cells, print any cell on the board." 800.0                       
                         1738H "Palindrome Addicts" "data structures,strings" "Your task is to maintain a queue consisting of lowercase English letters as follows:   ""push c"": insert a letter c at the back of the queue;  ""pop"": delete a letter from the front of the queue. Initially, the queue is empty. After each operation, you are asked to count the number of distinct palindromic substrings in the string that are obtained by concatenating the letters from the front to the back of the queue.Especially, the number of distinct palindromic substrings of the empty string is 0. A string s[1..n] of length n is palindromic if s[i]=s[n\xe2\x88\x92i+1] for every 1\xe2\x89\xa4i\xe2\x89\xa4n. The string s[l..r] is a substring of string s[1..n] for every 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. Two strings s[1..n] and t[1..m] are distinct, if at least one of the following holds.   n\xe2\x89\xa0m;  s[i]\xe2\x89\xa0t[i] for some 1\xe2\x89\xa4i\xe2\x89\xa4min{n,m}." 3300.0                       
                         1738G "Anti-Increasing Addicts" "constructive algorithms,dp,greedy,math" "You are given an n\xc3\x97n grid. We write (i,j) to denote the cell in the i-th row and j-th column. For each cell, you are told whether yon can delete it or not. Given an integer k, you are asked to delete exactly (n\xe2\x88\x92k+1)2 cells from the grid such that the following condition holds.   You cannot find k not deleted cells (x1,y1),(x2,y2),\xe2\x80\xa6,(xk,yk) that are strictly increasing, i.e., xi<xi+1 and yi<yi+1 for all 1\xe2\x89\xa4i<k.  Your task is to find a solution, or report that it is impossible." 2900.0                       
                         1737G "Ela Takes Dancing Class" "binary search,data structures" "DTL engineers love partying in the weekend. Ela does, too! Unfortunately, she didn\'t know how to dance yet. Therefore, she decided to take a dancing class.There are n students in the dancing class, including Ela. In the final project, n students will participate in a choreography described below.n students are positioned on the positive side of the Ox-axis. The i-th dancer is located at ai>0. Some dancers will change positions during the dance (we\'ll call them movable dancers), and others will stay in the same place during a choreography (we\'ll call them immovable dancers). We distinguish the dancers using a binary string s of length n: if si equals \'1\', then the i-th dancer is movable, otherwise the i-th dancer is immovable.Let\'s call the ""positive energy value"" of the choreography d>0. The dancers will perform ""movements"" based on this value.Each minute after the dance begins, the movable dancer with the smallest x-coordinate will start moving to the right and initiate a ""movement"". At the beginning of the movement, the dancer\'s energy level will be initiated equally to the positive energy value of the choreography, which is d. Each time they move from some y to y+1, the energy level will be decreased by 1. At some point, the dancer might meet other fellow dancers in the same coordinates. If it happens, then the energy level of the dancer will be increased by 1. A dancer will stop moving to the right when his energy level reaches 0, and he doesn\'t share a position with another dancer.The dancers are very well-trained, and each ""movement"" will end before the next minute begins.To show her understanding of this choreography, Ela has to answer q queries, each consisting of two integers k and m. The answer to this query is the coordinate of the m-th dancer of both types from the left at k-th minute after the choreography begins. In other words, denote xk,1,xk,2,\xe2\x80\xa6,xk,n as the sorted coordinates of the dancers at k-th minute from the beginning, you need to print xk,m." 3500.0                       
                         1736B "Playing with GCD" "math,number theory" "You are given an integer array a of length n. Does there exist an array b consisting of n+1 positive integers such that ai=gcd(bi,bi+1) for all i (1\xe2\x89\xa4i\xe2\x89\xa4n)? Note that gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y." 1200.0                       
                         1734F "Zeros and Ones" "bitmasks,divide and conquer,dp,math" "Let S be the Thue-Morse sequence. In other words, S is the 0-indexed binary string with infinite length that can be constructed as follows:   Initially, let S be ""0"".  Then, we perform the following operation infinitely many times: concatenate S with a copy of itself with flipped bits.For example, here are the first four iterations:  IterationS before iterationS before iteration with flipped bitsConcatenated S1010120110011030110100101101001401101001100101100110100110010110\xe2\x80\xa6\xe2\x80\xa6\xe2\x80\xa6\xe2\x80\xa6  You are given two positive integers n and m. Find the number of positions where the strings S0S1\xe2\x80\xa6Sm\xe2\x88\x921 and SnSn+1\xe2\x80\xa6Sn+m\xe2\x88\x921 are different." 2500.0                       
                         1734D "Slime Escape" "data structures,dp,greedy,two pointers" "You are playing a game called Slime Escape. The game takes place on a number line. Initially, there are n slimes. For all positive integers i where 1\xe2\x89\xa4i\xe2\x89\xa4n, the i-th slime is located at position i and has health ai. You are controlling the slime at position k. There are two escapes located at positions 0 and n+1. Your goal is to reach any one of the two escapes by performing any number of game moves.In one game move, you move your slime to the left or right by one position. However, if there is another slime in the new position, you must absorb it. When absorbing a slime, the health of your slime would be increased by the health of the absorbed slime, then the absorbed slime would be removed from the game.Note that some slimes might have negative health, so your health would decrease when absorbing such slimes. You lose the game immediately if your slime has negative health at any moment during the game.Can you reach one of two escapes by performing any number of game moves, without ever losing the game?" 1800.0                       
                         1733E Conveyor "constructive algorithms,dp,math" "There is a conveyor with 120 rows and 120 columns. Each row and column is numbered from 0 to 119, and the cell in i-th row and j-th column is denoted as (i,j). The top leftmost cell is (0,0). Each cell has a belt, and all belts are initially facing to the right.Initially, a slime ball is on the belt of (0,0), and other belts are empty. Every second, the state of the conveyor changes as follows:   All slime balls on the conveyor move one cell in the direction of the belt at the same time. If there is no cell in the moved position, the slime gets out of the conveyor, and if two slime balls move to the same cell, they merge into one.  All belts with slime ball in the previous second change direction at the same time: belts facing to the right become facing to the down, and vice versa.  A new slime ball is placed on cell (0,0). There are q queries, each being three integers t, x, and y. You have to find out if there is a slime at the cell (x,y) after t seconds from the start. Can you do it?" 2700.0                       
                         1733A "Consecutive Sum" greedy,sortings "You are given an array a with n integers. You can perform the following operation at most k times:  Choose two indices i and j, in which imodk=jmodk (1\xe2\x89\xa4i<j\xe2\x89\xa4n).  Swap ai and aj. After performing all operations, you have to select k consecutive elements, and the sum of the k elements becomes your score. Find the maximum score you can get.Here xmody denotes the remainder from dividing x by y." 800.0                       
                         1731F "Function Sum" "brute force,combinatorics,dp,fft,math" "Suppose you have an integer array a1,a2,\xe2\x80\xa6,an.Let lsl(i) be the number of indices j (1\xe2\x89\xa4j<i) such that aj<ai.Analogically, let grr(i) be the number of indices j (i<j\xe2\x89\xa4n) such that aj>ai.Let\'s name position i good in the array a if lsl(i)<grr(i).Finally, let\'s define a function f on array a f(a) as the sum of all ai such that i is good in a.Given two integers n and k, find the sum of f(a) over all arrays a of size n such that 1\xe2\x89\xa4ai\xe2\x89\xa4k for all 1\xe2\x89\xa4i\xe2\x89\xa4n modulo 998244353." 2500.0                       
                         1730F "Almost Sorted" "bitmasks,data structures,dp" "You are given a permutation p of length n and a positive integer k. Consider a permutation q of length n such that for any integers i and j, where 1\xe2\x89\xa4i<j\xe2\x89\xa4n, we have pqi\xe2\x89\xa4pqj+k.Find the minimum possible number of inversions in a permutation q.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).An inversion in a permutation a is a pair of indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that i<j, but ai>aj." 2700.0                       
                         1728G Illumination "binary search,bitmasks,brute force,combinatorics,dp,math,two pointers" "Consider a segment [0,d] of the coordinate line. There are n lanterns and m points of interest in this segment.For each lantern, you can choose its power \xe2\x80\x94 an integer between 0 and d (inclusive). A lantern with coordinate x illuminates the point of interest with coordinate y if |x\xe2\x88\x92y| is less than or equal to the power of the lantern.A way to choose the power values for all lanterns is considered valid if every point of interest is illuminated by at least one lantern.You have to process q queries. Each query is represented by one integer fi. To answer the i-th query, you have to:  add a lantern on coordinate fi;  calculate the number of valid ways to assign power values to all lanterns, and print it modulo 998244353;  remove the lantern you just added." 2700.0                       
                         1728F Fishermen "flows,graph matchings,greedy" "There are n fishermen who have just returned from a fishing trip. The i-th fisherman has caught a fish of size ai.The fishermen will choose some order in which they are going to tell the size of the fish they caught (the order is just a permutation of size n). However, they are not entirely honest, and they may ""increase"" the size of the fish they have caught.Formally, suppose the chosen order of the fishermen is [p1,p2,p3,\xe2\x80\xa6,pn]. Let bi be the value which the i-th fisherman in the order will tell to the other fishermen. The values bi are chosen as follows:  the first fisherman in the order just honestly tells the actual size of the fish he has caught, so b1=ap1;  every other fisherman wants to tell a value that is strictly greater than the value told by the previous fisherman, and is divisible by the size of the fish that the fisherman has caught. So, for i>1, bi is the smallest integer that is both strictly greater than bi\xe2\x88\x921 and divisible by api. For example, let n=7, a=[1,8,2,3,2,2,3]. If the chosen order is p=[1,6,7,5,3,2,4], then:  b1=ap1=1;  b2 is the smallest integer divisible by 2 and greater than 1, which is 2;  b3 is the smallest integer divisible by 3 and greater than 2, which is 3;  b4 is the smallest integer divisible by 2 and greater than 3, which is 4;  b5 is the smallest integer divisible by 2 and greater than 4, which is 6;  b6 is the smallest integer divisible by 8 and greater than 6, which is 8;  b7 is the smallest integer divisible by 3 and greater than 8, which is 9. You have to choose the order of fishermen in a way that yields the minimum possible n\xe2\x88\x91i=1bi." 3100.0                       
                         1725M "Moving Both Hands" "dp,graphs,shortest paths" "Pak Chanek is playing one of his favourite board games. In the game, there is a directed graph with N vertices and M edges. In the graph, edge i connects two different vertices Ui and Vi with a length of Wi. By using the i-th edge, something can move from Ui to Vi, but not from Vi to Ui.To play this game, initially Pak Chanek must place both of his hands onto two different vertices. In one move, he can move one of his hands to another vertex using an edge. To move a hand from vertex Ui to vertex Vi, Pak Chanek needs a time of Wi seconds. Note that Pak Chanek can only move one hand at a time. This game ends when both of Pak Chanek\'s hands are on the same vertex.Pak Chanek has several questions. For each p satisfying 2\xe2\x89\xa4p\xe2\x89\xa4N, you need to find the minimum time in seconds needed for Pak Chanek to end the game if initially Pak Chanek\'s left hand and right hand are placed on vertex 1 and vertex p, or report if it is impossible." 1800.0                       
                              1725D "Deducing Sortability" "binary search,bitmasks,math" "Let\'s say Pak Chanek has an array A consisting of N positive integers. Pak Chanek will do a number of operations. In each operation, Pak Chanek will do the following:   Choose an index p (1\xe2\x89\xa4p\xe2\x89\xa4N).  Let c be the number of operations that have been done on index p before this operation.  Decrease the value of Ap by 2c.  Multiply the value of Ap by 2. After each operation, all elements of A must be positive integers.An array A is said to be sortable if and only if Pak Chanek can do zero or more operations so that A1<A2<A3<A4<\xe2\x80\xa6<AN.Pak Chanek must find an array A that is sortable with length N such that A1+A2+A3+A4+\xe2\x80\xa6+AN is the minimum possible. If there are more than one possibilities, Pak Chanek must choose the array that is lexicographically minimum among them.Pak Chanek must solve the following things:   Pak Chanek must print the value of A1+A2+A3+A4+\xe2\x80\xa6+AN for that array.  Q questions will be given. For the i-th question, an integer Pi is given. Pak Chanek must print the value of APi. Help Pak Chanek solve the problem.Note: an array B of size N is said to be lexicographically smaller than an array C that is also of size N if and only if there exists an index i such that Bi<Ci and for each j<i, Bj=Cj." 2900.0                  
                              1722E "Counting Rectangles" "brute force,data structures,dp,implementation" "You have n rectangles, the i-th rectangle has height hi and width wi.You are asked q queries of the form hs ws hb wb. For each query output, the total area of rectangles you own that can fit a rectangle of height hs and width ws while also fitting in a rectangle of height hb and width wb. In other words, print \xe2\x88\x91hi\xe2\x8b\x85wi for i such that hs<hi<hb and ws<wi<wb. Please note, that if two rectangles have the same height or the same width, then they cannot fit inside each other. Also note that you cannot rotate rectangles.Please note that the answer for some test cases won\'t fit into 32-bit integer type, so you should use at least 64-bit integer type in your programming language (like long long for C++)." 1600.0                  
                              1721F "Matching Reduction" "brute force,constructive algorithms,dfs and similar,flows,graph matchings,graphs,interactive" "You are given a bipartite graph with n1 vertices in the first part, n2 vertices in the second part, and m edges. The maximum matching in this graph is the maximum possible (by size) subset of edges of this graph such that no vertex is incident to more than one chosen edge.You have to process two types of queries to this graph:  1 \xe2\x80\x94 remove the minimum possible number of vertices from this graph so that the size of the maximum matching gets reduced exactly by 1, and print the vertices that you have removed. Then, find any maximum matching in this graph and print the sum of indices of edges belonging to this matching;  2 \xe2\x80\x94 query of this type will be asked only after a query of type 1. As the answer to this query, you have to print the edges forming the maximum matching you have chosen in the previous query. Note that you should solve the problem in online mode. It means that you can\'t read the whole input at once. You can read each query only after writing the answer for the last query. Use functions fflush in C++ and BufferedWriter.flush in Java languages after each writing in your program." 2800.0                  
                              1720E "Misha and Paintings" "constructive algorithms,data structures,greedy,implementation,math" "Misha has a square n\xc3\x97n matrix, where the number in row i and column j is equal to ai,j. Misha wants to modify the matrix to contain exactly k distinct integers. To achieve this goal, Misha can perform the following operation zero or more times:  choose any square submatrix of the matrix (you choose (x1,y1), (x2,y2), such that x1\xe2\x89\xa4x2, y1\xe2\x89\xa4y2, x2\xe2\x88\x92x1=y2\xe2\x88\x92y1, then submatrix is a set of cells with coordinates (x,y), such that x1\xe2\x89\xa4x\xe2\x89\xa4x2, y1\xe2\x89\xa4y\xe2\x89\xa4y2),  choose an integer k, where 1\xe2\x89\xa4k\xe2\x89\xa4n2,  replace all integers in the submatrix with k. Please find the minimum number of operations that Misha needs to achieve his goal." 2700.0                  
                              1720D2 "Xor-Subsequence (hard version)" "bitmasks,data structures,dp,strings,trees" "It is the hard version of the problem. The only difference is that in this version ai\xe2\x89\xa4109.You are given an array of n integers a0,a1,a2,\xe2\x80\xa6an\xe2\x88\x921. Bryap wants to find the longest beautiful subsequence in the array.An array b=[b0,b1,\xe2\x80\xa6,bm\xe2\x88\x921], where 0\xe2\x89\xa4b0<b1<\xe2\x80\xa6<bm\xe2\x88\x921<n, is a subsequence of length m of the array a.Subsequence b=[b0,b1,\xe2\x80\xa6,bm\xe2\x88\x921] of length m is called beautiful, if the following condition holds:   For any p (0\xe2\x89\xa4p<m\xe2\x88\x921) holds: abp\xe2\x8a\x95bp+1<abp+1\xe2\x8a\x95bp. Here a\xe2\x8a\x95b denotes the bitwise XOR of a and b. For example, 2\xe2\x8a\x954=6 and 3\xe2\x8a\x951=2.Bryap is a simple person so he only wants to know the length of the longest such subsequence. Help Bryap and find the answer to his question." 2400.0                  
                              1720B "Interesting Sum" "brute force,data structures,greedy,math,sortings" "You are given an array a that contains n integers. You can choose any proper subsegment al,al+1,\xe2\x80\xa6,ar of this array, meaning you can choose any two integers 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, where r\xe2\x88\x92l+1<n. We define the beauty of a given subsegment as the value of the following expression:max(a1,a2,\xe2\x80\xa6,al\xe2\x88\x921,ar+1,ar+2,\xe2\x80\xa6,an)\xe2\x88\x92min(a1,a2,\xe2\x80\xa6,al\xe2\x88\x921,ar+1,ar+2,\xe2\x80\xa6,an)+max(al,\xe2\x80\xa6,ar)\xe2\x88\x92min(al,\xe2\x80\xa6,ar).Please find the maximum beauty among all proper subsegments." 800.0                  
                              1719C "Fighting Tournament" "binary search,data structures,implementation,two pointers" "Burenka is about to watch the most interesting sporting event of the year \xe2\x80\x94 a fighting tournament organized by her friend Tonya.n athletes participate in the tournament, numbered from 1 to n. Burenka determined the strength of the i-th athlete as an integer ai, where 1\xe2\x89\xa4ai\xe2\x89\xa4n. All the strength values are different, that is, the array a is a permutation of length n. We know that in a fight, if ai>aj, then the i-th participant always wins the j-th.The tournament goes like this: initially, all n athletes line up in ascending order of their ids, and then there are infinitely many fighting rounds. In each round there is exactly one fight: the first two people in line come out and fight. The winner goes back to the front of the line, and the loser goes to the back.Burenka decided to ask Tonya q questions. In each question, Burenka asks how many victories the i-th participant gets in the first k rounds of the competition for some given numbers i and k. Tonya is not very good at analytics, so he asks you to help him answer all the questions." 1400.0                  
                              1717F "Madoka and The First Session" "constructive algorithms,flows,graph matchings,graphs,implementation" "Oh no, on the first exam Madoka got this hard problem:Given integer n and m pairs of integers (vi,ui). Also there is an array b1,b2,\xe2\x80\xa6,bn, initially filled with zeros.Then for each index i, where 1\xe2\x89\xa4i\xe2\x89\xa4m, perform either bvi:=bvi\xe2\x88\x921 and bui:=bui+1, or bvi:=bvi+1 and bui:=bui\xe2\x88\x921. Note that exactly one of these operations should be performed for every i.Also there is an array s of length n consisting of 0 and 1. And there is an array a1,a2,\xe2\x80\xa6,an, where it is guaranteed, that if si=0 holds, then ai=0.Help Madoka and determine whenever it is possible to perform operations in such way that for every i, where si=1 it holds that ai=bi. If it possible you should also provide Madoka with a way to perform operations." 2500.0                  
                              1716F "Bags with Balls" "combinatorics,dp,math,number theory" "There are n bags, each bag contains m balls with numbers from 1 to m. For every i\xe2\x88\x88[1,m], there is exactly one ball with number i in each bag.You have to take exactly one ball from each bag (all bags are different, so, for example, taking the ball 1 from the first bag and the ball 2 from the second bag is not the same as taking the ball 2 from the first bag and the ball 1 from the second bag). After that, you calculate the number of balls with odd numbers among the ones you have taken. Let the number of these balls be F.Your task is to calculate the sum of Fk over all possible ways to take n balls, one from each bag." 2500.0                  
                              1716A "2-3 Moves" greedy,math "You are standing at the point 0 on a coordinate line. Your goal is to reach the point n. In one minute, you can move by 2 or by 3 to the left or to the right (i.\xe2\x80\x89e., if your current coordinate is x, it can become x\xe2\x88\x923, x\xe2\x88\x922, x+2 or x+3). Note that the new coordinate can become negative.Your task is to find the minimum number of minutes required to get from the point 0 to the point n.You have to answer t independent test cases." 800.0                  
                              1714F "Build a Tree and That Is It" "constructive algorithms,implementation,trees" "A tree is a connected undirected graph without cycles. Note that in this problem, we are talking about not rooted trees.You are given four positive integers n,d12,d23 and d31. Construct a tree such that:  it contains n vertices numbered from 1 to n,  the distance (length of the shortest path) from vertex 1 to vertex 2 is d12,  distance from vertex 2 to vertex 3 is d23,  the distance from vertex 3 to vertex 1 is d31. Output any tree that satisfies all the requirements above, or determine that no such tree exists." 1900.0                  
                              1709A "Three Doors" "brute force,greedy,implementation,math" "There are three doors in front of you, numbered from 1 to 3 from left to right. Each door has a lock on it, which can only be opened with a key with the same number on it as the number on the door.There are three keys \xe2\x80\x94 one for each door. Two of them are hidden behind the doors, so that there is no more than one key behind each door. So two doors have one key behind them, one door doesn\'t have a key behind it. To obtain a key hidden behind a door, you should first unlock that door. The remaining key is in your hands.Can you open all the doors?" 800.0                  
                                  800.0 1525A Potion-making "math,number theory" "You have an initially empty cauldron, and you want to brew a potion in it. The potion consists of two ingredients: magic essence and water. The potion you want to brew should contain exactly k % magic essence and (100\xe2\x88\x92k) % water.In one step, you can pour either one liter of magic essence or one liter of water into the cauldron. What is the minimum number of steps to brew a potion? You don\'t care about the total volume of the potion, only about the ratio between magic essence and water in it.A small reminder: if you pour e liters of essence and w liters of water (e+w>0) into the cauldron, then it contains ee+w\xe2\x8b\x85100 % (without rounding) magic essence and we+w\xe2\x8b\x85100 % water."              
                                  1000.0 1521A "Nastia and Nearly Good Numbers" "constructive algorithms,math,number theory" "Nastia has 2 positive integers A and B. She defines that:  The integer is good if it is divisible by A\xe2\x8b\x85B;  Otherwise, the integer is nearly good, if it is divisible by A. For example, if A=6 and B=4, the integers 24 and 72 are good, the integers 6, 660 and 12 are nearly good, the integers 16, 7 are neither good nor nearly good.Find 3 different positive integers x, y, and z such that exactly one of them is good and the other 2 are nearly good, and x+y=z."              
                                  3300.0 1517G "Starry Night Camping" "constructive algorithms,flows,graphs" "At the foot of Liyushan Mountain, n tents will be carefully arranged to provide accommodation for those who are willing to experience the joy of approaching nature, the tranquility of the night, and the bright starry sky.The i-th tent is located at the point of (xi,yi) and has a weight of wi. A tent is important if and only if both xi and yi are even. You need to remove some tents such that for each remaining important tent (x,y), there do not exist 3 other tents (x\xe2\x80\xb21,y\xe2\x80\xb21), (x\xe2\x80\xb22,y\xe2\x80\xb22) and (x\xe2\x80\xb23,y\xe2\x80\xb23) such that both conditions are true:   |x\xe2\x80\xb2j\xe2\x88\x92x|,|y\xe2\x80\xb2j\xe2\x88\x92y|\xe2\x89\xa41 for all j\xe2\x88\x88{1,2,3}, and  these four tents form a parallelogram (or a rectangle) and one of its sides is parallel to the x-axis. Please maximize the sum of the weights of the tents that are not removed. Print the maximum value."              
                                  1200.0 1517B "Morning Jogging" "constructive algorithms,greedy,sortings" "The 2050 volunteers are organizing the ""Run! Chase the Rising Sun"" activity. Starting on Apr 25 at 7:30 am, runners will complete the 6km trail around the Yunqi town.There are n+1 checkpoints on the trail. They are numbered by 0, 1, ..., n. A runner must start at checkpoint 0 and finish at checkpoint n. No checkpoint is skippable \xe2\x80\x94 he must run from checkpoint 0 to checkpoint 1, then from checkpoint 1 to checkpoint 2 and so on. Look at the picture in notes section for clarification.Between any two adjacent checkpoints, there are m different paths to choose. For any 1\xe2\x89\xa4i\xe2\x89\xa4n, to run from checkpoint i\xe2\x88\x921 to checkpoint i, a runner can choose exactly one from the m possible paths. The length of the j-th path between checkpoint i\xe2\x88\x921 and i is bi,j for any 1\xe2\x89\xa4j\xe2\x89\xa4m and 1\xe2\x89\xa4i\xe2\x89\xa4n.To test the trail, we have m runners. Each runner must run from the checkpoint 0 to the checkpoint n once, visiting all the checkpoints. Every path between every pair of adjacent checkpoints needs to be ran by exactly one runner. If a runner chooses the path of length li between checkpoint i\xe2\x88\x921 and i (1\xe2\x89\xa4i\xe2\x89\xa4n), his tiredness is nmini=1li, i. e. the minimum length of the paths he takes.Please arrange the paths of the m runners to minimize the sum of tiredness of them."              
                                  1700.0 1516C "Baby Ehab Partitions Again" "bitmasks,constructive algorithms,dp,math" "Baby Ehab was toying around with arrays. He has an array a of length n. He defines an array to be good if there\'s no way to partition it into 2 subsequences such that the sum of the elements in the first is equal to the sum of the elements in the second. Now he wants to remove the minimum number of elements in a so that it becomes a good array. Can you help him?A sequence b is a subsequence of an array a if b can be obtained from a by deleting some (possibly zero or all) elements. A partitioning of an array is a way to divide it into 2 subsequences such that every element belongs to exactly one subsequence, so you must use all the elements, and you can\'t share any elements."              
                                  1200.0 1514B "AND 0, Sum Big" bitmasks,combinatorics,math "Baby Badawy\'s first words were ""AND 0 SUM BIG"", so he decided to solve the following problem. Given two integers n and k, count the number of arrays of length n such that:  all its elements are integers between 0 and 2k\xe2\x88\x921 (inclusive);  the bitwise AND of all its elements is 0;  the sum of its elements is as large as possible. Since the answer can be very large, print its remainder when divided by 109+7."              
                                  1200.0 1510K "King\'s Task" "brute force,graphs,implementation" "The brave Knight came to the King and asked permission to marry the princess. The King knew that the Knight was brave, but he also wanted to know if he was smart enough. So he asked him to solve the following task.There is a permutation pi of numbers from 1 to 2n. You can make two types of operations.   Swap p1 and p2, p3 and p4, ..., p2n\xe2\x88\x921 and p2n.  Swap p1 and pn+1, p2 and pn+2, ..., pn and p2n. The task is to find the minimal number of operations required to sort the given permutation.The Knight was not that smart actually, but quite charming, so the princess asks you to help him to solve the King\'s task."              
                                  2800.0 1510F "Fiber Shape"  "Imagine a board with n pins put into it, the i-th pin is located at (xi,yi). For simplicity, we will restrict the problem to the case where the pins are placed in vertices of a convex polygon.Then, take a non-stretchable string of length l, and put it around all the pins. Place a pencil inside the string and draw a curve around the pins, trying to pull the string in every possible direction. The picture below shows an example of a string tied around the pins and pulled by a pencil (a point P).  Your task is to find an area inside this curve. Formally, for a given convex polygon S and a length l let\'s define a fiber shape F(S,l) as a set of points t such that the perimeter of the convex hull of S\xe2\x88\xaa{t} does not exceed l. Find an area of F(S,l)."              
                                  2000.0 1506G "Maximize the Remaining String" "brute force,data structures,dp,greedy,strings" "You are given a string s, consisting of lowercase Latin letters. While there is at least one character in the string s that is repeated at least twice, you perform the following operation:   you choose the index i (1\xe2\x89\xa4i\xe2\x89\xa4|s|) such that the character at position i occurs at least two times in the string s, and delete the character at position i, that is, replace s with s1s2\xe2\x80\xa6si\xe2\x88\x921si+1si+2\xe2\x80\xa6sn. For example, if s=""codeforces"", then you can apply the following sequence of operations:   i=6\xe2\x87\x92s=""codefrces"";  i=1\xe2\x87\x92s=""odefrces"";  i=7\xe2\x87\x92s=""odefrcs""; Given a given string s, find the lexicographically maximum string that can be obtained after applying a certain sequence of operations after which all characters in the string become unique.A string a of length n is lexicographically less than a string b of length m, if:   there is an index i (1\xe2\x89\xa4i\xe2\x89\xa4min(n,m)) such that the first i\xe2\x88\x921 characters of the strings a and b are the same, and the i-th character of the string a is less than i-th character of string b;  or the first min(n,m) characters in the strings a and b are the same and n<m. For example, the string a=""aezakmi"" is lexicographically less than the string b=""aezus""."              
                                  2000.0 1506F "Triangular Paths" "constructive algorithms,graphs,math,shortest paths,sortings" "Consider an infinite triangle made up of layers. Let\'s number the layers, starting from one, from the top of the triangle (from top to bottom). The k-th layer of the triangle contains k points, numbered from left to right. Each point of an infinite triangle is described by a pair of numbers (r,c) (1\xe2\x89\xa4c\xe2\x89\xa4r), where r is the number of the layer, and c is the number of the point in the layer. From each point (r,c) there are two directed edges to the points (r+1,c) and (r+1,c+1), but only one of the edges is activated. If r+c is even, then the edge to the point (r+1,c) is activated, otherwise the edge to the point (r+1,c+1) is activated. Look at the picture for a better understanding.  Activated edges are colored in black. Non-activated edges are colored in gray. From the point (r1,c1) it is possible to reach the point (r2,c2), if there is a path between them only from activated edges. For example, in the picture above, there is a path from (1,1) to (3,2), but there is no path from (2,1) to (1,1).Initially, you are at the point (1,1). For each turn, you can:   Replace activated edge for point (r,c). That is if the edge to the point (r+1,c) is activated, then instead of it, the edge to the point (r+1,c+1) becomes activated, otherwise if the edge to the point (r+1,c+1), then instead if it, the edge to the point (r+1,c) becomes activated. This action increases the cost of the path by 1;  Move from the current point to another by following the activated edge. This action does not increase the cost of the path. You are given a sequence of n points of an infinite triangle (r1,c1),(r2,c2),\xe2\x80\xa6,(rn,cn). Find the minimum cost path from (1,1), passing through all n points in arbitrary order."              
                                  1500.0 1506E "Restoring the Permutation" "constructive algorithms,implementation" "A permutation is a sequence of n integers from 1 to n, in which all numbers occur exactly once. For example, [1], [3,5,2,1,4], [1,3,2] are permutations, and [2,3,2], [4,3,1], [0] are not.Polycarp was presented with a permutation p of numbers from 1 to n. However, when Polycarp came home, he noticed that in his pocket, the permutation p had turned into an array q according to the following rule:   qi=max(p1,p2,\xe2\x80\xa6,pi). Now Polycarp wondered what lexicographically minimal and lexicographically maximal permutations could be presented to him.An array a of length n is lexicographically smaller than an array b of length n if there is an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that the first i\xe2\x88\x921 elements of arrays a and b are the same, and the i-th element of the array a is less than the i-th element of the array b. For example, the array a=[1,3,2,3] is lexicographically smaller than the array b=[1,3,4,2].For example, if n=7 and p=[3,2,4,1,7,5,6], then q=[3,3,4,4,7,7,7] and the following permutations could have been as p initially:   [3,1,4,2,7,5,6] (lexicographically minimal permutation);  [3,1,4,2,7,6,5];  [3,2,4,1,7,5,6];  [3,2,4,1,7,6,5] (lexicographically maximum permutation). For a given array q, find the lexicographically minimal and lexicographically maximal permutations that could have been originally presented to Polycarp."              
                                  1100.0 1506B "Partial Replacement" greedy,implementation "You are given a number k and a string s of length n, consisting of the characters \'.\' and \'*\'. You want to replace some of the \'*\' characters with \'x\' characters so that the following conditions are met:   The first character \'*\' in the original string should be replaced with \'x\';  The last character \'*\' in the original string should be replaced with \'x\';  The distance between two neighboring replaced characters \'x\' must not exceed k (more formally, if you replaced characters at positions i and j (i<j) and at positions [i+1,j\xe2\x88\x921] there is no ""x"" symbol, then j\xe2\x88\x92i must be no more than k). For example, if n=7, s=.**.*** and k=3, then the following strings will satisfy the conditions above:   .xx.*xx;  .x*.x*x;  .xx.xxx.  But, for example, the following strings will not meet the conditions:   .**.*xx (the first character \'*\' should be replaced with \'x\');  .x*.xx* (the last character \'*\' should be replaced with \'x\');  .x*.*xx (the distance between characters at positions 2 and 6 is greater than k=3). Given n, k, and s, find the minimum number of \'*\' characters that must be replaced with \'x\' in order to meet the above conditions."              
                                  1700.0 1503B 3-Coloring "constructive algorithms,games,interactive" "This is an interactive problem.Alice and Bob are playing a game. There is n\xc3\x97n grid, initially empty. We refer to the cell in row i and column j by (i,j) for 1\xe2\x89\xa4i,j\xe2\x89\xa4n. There is an infinite supply of tokens that come in 3 colors labelled 1, 2, and 3.The game proceeds with turns as follows. Each turn begins with Alice naming one of the three colors, let\'s call it a. Then, Bob chooses a color b\xe2\x89\xa0a, chooses an empty cell, and places a token of color b on that cell.We say that there is a conflict if there exist two adjacent cells containing tokens of the same color. Two cells are considered adjacent if they share a common edge.If at any moment there is a conflict, Alice wins. Otherwise, if n2 turns are completed (so that the grid becomes full) without any conflicts, Bob wins.We have a proof that Bob has a winning strategy. Play the game as Bob and win.The interactor is adaptive. That is, Alice\'s color choices can depend on Bob\'s previous moves."              
                                  3300.0 1500E "Subset Trick" "binary search,data structures" "Vanya invented an interesting trick with a set of integers.Let an illusionist have a set of positive integers S. He names a positive integer x. Then an audience volunteer must choose some subset (possibly, empty) of S without disclosing it to the illusionist. The volunteer tells the illusionist the size of the chosen subset. And here comes the trick: the illusionist guesses whether the sum of the subset elements does not exceed x. The sum of elements of an empty subset is considered to be 0.Vanya wants to prepare the trick for a public performance. He prepared some set of distinct positive integers S. Vasya wants the trick to be successful. He calls a positive number x unsuitable, if he can\'t be sure that the trick would be successful for every subset a viewer can choose.Vanya wants to count the number of unsuitable integers for the chosen set S.Vanya plans to try different sets S. He wants you to write a program that finds the number of unsuitable integers for the initial set S, and after each change to the set S. Vanya will make q changes to the set, and each change is one of the following two types:   add a new integer a to the set S, or  remove some integer a from the set S."              
                                  2500.0 1497D Genius "bitmasks,dp,graphs,number theory" "Please note the non-standard memory limit.There are n problems numbered with integers from 1 to n. i-th problem has the complexity ci=2i, tag tagi and score si.After solving the problem i it\'s allowed to solve problem j if and only if IQ<|ci\xe2\x88\x92cj| and tagi\xe2\x89\xa0tagj. After solving it your IQ changes and becomes IQ=|ci\xe2\x88\x92cj| and you gain |si\xe2\x88\x92sj| points.Any problem can be the first. You can solve problems in any order and as many times as you want.Initially your IQ=0. Find the maximum number of points that can be earned."              
                                  2600.0 1493F "Enchanted Matrix" "bitmasks,interactive,number theory" "This is an interactive problem.There exists a matrix a of size n\xc3\x97m (n rows and m columns), you know only numbers n and m. The rows of the matrix are numbered from 1 to n from top to bottom, and columns of the matrix are numbered from 1 to m from left to right. The cell on the intersection of the x-th row and the y-th column is denoted as (x,y).You are asked to find the number of pairs (r,c) (1\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4c\xe2\x89\xa4m, r is a divisor of n, c is a divisor of m) such that if we split the matrix into rectangles of size r\xc3\x97c (of height r rows and of width c columns, each cell belongs to exactly one rectangle), all those rectangles are pairwise equal.You can use queries of the following type:   ? h w i1 j1 i2 j2 (1\xe2\x89\xa4h\xe2\x89\xa4n, 1\xe2\x89\xa4w\xe2\x89\xa4m, 1\xe2\x89\xa4i1,i2\xe2\x89\xa4n, 1\xe2\x89\xa4j1,j2\xe2\x89\xa4m) \xe2\x80\x94 to check if non-overlapping subrectangles of height h rows and of width w columns of matrix a are equal or not. The upper left corner of the first rectangle is (i1,j1). The upper left corner of the second rectangle is (i2,j2). Subrectangles overlap, if they have at least one mutual cell. If the subrectangles in your query have incorrect coordinates (for example, they go beyond the boundaries of the matrix) or overlap, your solution will be considered incorrect. You can use at most 3\xe2\x8b\x85\xe2\x8c\x8alog2(n+m)\xe2\x8c\x8b queries. All elements of the matrix a are fixed before the start of your program and do not depend on your queries."              
                                  2800.0 1491G "Switch and Flip" "constructive algorithms,graphs,math" "There are n coins labeled from 1 to n. Initially, coin ci is on position i and is facing upwards ((c1,c2,\xe2\x80\xa6,cn) is a permutation of numbers from 1 to n). You can do some operations on these coins. In one operation, you can do the following:Choose 2 distinct indices i and j.Then, swap the coins on positions i and j.Then, flip both coins on positions i and j. (If they are initially faced up, they will be faced down after the operation and vice versa)Construct a sequence of at most n+1 operations such that after performing all these operations the coin i will be on position i at the end, facing up.Note that you do not need to minimize the number of operations."              
                                  800.0 1491A "K-th Largest Value" "brute force,greedy,implementation" "You are given an array a consisting of n integers. Initially all elements of a are either 0 or 1. You need to process q queries of two kinds:  1 x : Assign to ax the value 1\xe2\x88\x92ax.  2 k : Print the k-th largest value of the array. As a reminder, k-th largest value of the array b is defined as following: Sort the array in the non-increasing order, return k-th element from it. For example, the second largest element in array [0,1,0,1] is 1, as after sorting in non-increasing order it becomes [1,1,0,0], and the second element in this array is equal to 1."              
                                  1900.0 1490G "Old Floppy Drive" "binary search,data structures,math" "Polycarp was dismantling his attic and found an old floppy drive on it. A round disc was inserted into the drive with n integers written on it.Polycarp wrote the numbers from the disk into the a array. It turned out that the drive works according to the following algorithm:   the drive takes one positive number x as input and puts a pointer to the first element of the a array;  after that, the drive starts rotating the disk, every second moving the pointer to the next element, counting the sum of all the elements that have been under the pointer. Since the disk is round, in the a array, the last element is again followed by the first one;  as soon as the sum is at least x, the drive will shut down. Polycarp wants to learn more about the operation of the drive, but he has absolutely no free time. So he asked you m questions. To answer the i-th of them, you need to find how many seconds the drive will work if you give it xi as input. Please note that in some cases the drive can work infinitely.For example, if n=3,m=3, a=[1,\xe2\x88\x923,4] and x=[1,5,2], then the answers to the questions are as follows:   the answer to the first query is 0 because the drive initially points to the first item and the initial sum is 1.  the answer to the second query is 6, the drive will spin the disk completely twice and the amount becomes 1+(\xe2\x88\x923)+4+1+(\xe2\x88\x923)+4+1=5.  the answer to the third query is 2, the amount is 1+(\xe2\x88\x923)+4=2."              
                                  3100.0 1488J "Flower Shop" "*special problem,data structures,fft,math" "Your friend is running a flower shop. In order to be prepared for the next holidays (when, as usual, sales skyrocket) she asked you to write her a special program that will help to analyze the stocks she has.There are n different types of flowers she can order and each flower of the type i costs wi. The last holidays were a great success, she sold all flowers she had, so right now all her stocks are empty.From this point, she starts routine operations of ordering and selling flowers, while trying to analyze what she has at hand. All of this can be represented as m queries of three types:   ""1 i c"" \xe2\x80\x94 she bought c flowers of type i;  ""2 i c"" \xe2\x80\x94 she disposed of c flowers of type i;  ""3 l r k"" \xe2\x80\x94 how many variants of bouquets she can make using only flowers of types l,l+1,\xe2\x80\xa6,r with the total cost no more than k. For simplicity, you can think that a bouquet is a multiset of flowers, and two bouquets are different if they are different as multisets. The cost of a bouquet is the sum of all flowers it has. Help your friend and write the program that can process all these queries."              
                                  800.0 1487A Arena implementation,sortings "n heroes fight against each other in the Arena. Initially, the i-th hero has level ai.Each minute, a fight between two different heroes occurs. These heroes can be chosen arbitrarily (it\'s even possible that it is the same two heroes that were fighting during the last minute).When two heroes of equal levels fight, nobody wins the fight. When two heroes of different levels fight, the one with the higher level wins, and his level increases by 1.The winner of the tournament is the first hero that wins in at least 100500 fights (note that it\'s possible that the tournament lasts forever if no hero wins this number of fights, then there is no winner). A possible winner is a hero such that there exists a sequence of fights that this hero becomes the winner of the tournament.Calculate the number of possible winners among n heroes."              
                                  3400.0 1482H Exam "data structures,string suffix structures,trees" "This year a Chunin Selection Exam is held again in Konoha, and taking part in it are n ninjas named s1, s2, ..., sn. All names are distinct. One of the exam stages consists of fights between the participants. This year the rules determining the ninjas for each fight are the following: ninjas i and j fight against each other if the following conditions are held:  i\xe2\x89\xa0j;  sj is a substring of si;  there is no k except i and j that sj is a substring of sk, and sk is a substring of si. A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.Your task is to find out how many fights are going to take place this year."              
                                  2400.0 1482F "Useful Edges" "graphs,shortest paths" "You are given a weighted undirected graph on n vertices along with q triples (u,v,l), where in each triple u and v are vertices and l is a positive integer. An edge e is called useful if there is at least one triple (u,v,l) and a path (not necessarily simple) with the following properties:  u and v are the endpoints of this path,  e is one of the edges of this path,  the sum of weights of all edges on this path doesn\'t exceed l. Please print the number of useful edges in this graph."              
                                  1900.0 1482D Playlist "data structures,dsu,implementation,shortest paths" "Arkady has a playlist that initially consists of n songs, numerated from 1 to n in the order they appear in the playlist. Arkady starts listening to the songs in the playlist one by one, starting from song 1. The playlist is cycled, i. e. after listening to the last song, Arkady will continue listening from the beginning.Each song has a genre ai, which is a positive integer. Let Arkady finish listening to a song with genre y, and the genre of the next-to-last listened song be x. If gcd(x,y)=1, he deletes the last listened song (with genre y) from the playlist. After that he continues listening normally, skipping the deleted songs, and forgetting about songs he listened to before. In other words, after he deletes a song, he can\'t delete the next song immediately.Here gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y.For example, if the initial songs\' genres were [5,9,2,10,15], then the playlist is converted as follows: [5, 9, 2, 10, 15] \xe2\x86\x92 [5, 9, 2, 10, 15] \xe2\x86\x92 [5, 2, 10, 15] (because gcd(5,9)=1) \xe2\x86\x92 [5, 2, 10, 15] \xe2\x86\x92 [5, 2, 10, 15] \xe2\x86\x92 [5, 2, 10, 15] \xe2\x86\x92 [5, 2, 10, 15] \xe2\x86\x92 [5, 2, 10, 15] \xe2\x86\x92 [5, 10, 15] (because gcd(5,2)=1) \xe2\x86\x92 [5, 10, 15] \xe2\x86\x92 [5, 10, 15] \xe2\x86\x92 ... The bold numbers represent the two last played songs. Note that after a song is deleted, Arkady forgets that he listened to that and the previous songs.Given the initial playlist, please determine which songs are eventually deleted and the order these songs are deleted."              
                                  1300.0 1476B Inflation "binary search,brute force,greedy,math" "You have a statistic of price changes for one product represented as an array of n positive integers p0,p1,\xe2\x80\xa6,pn\xe2\x88\x921, where p0 is the initial price of the product and pi is how the price was increased during the i-th month.Using these price changes you are asked to calculate the inflation coefficients for each month as the ratio of current price increase pi to the price at the start of this month (p0+p1+\xe2\x8b\xaf+pi\xe2\x88\x921).Your boss said you clearly that the inflation coefficients must not exceed k %, so you decided to increase some values pi in such a way, that all pi remain integers and the inflation coefficients for each month don\'t exceed k %.You know, that the bigger changes \xe2\x80\x94 the more obvious cheating. That\'s why you need to minimize the total sum of changes.What\'s the minimum total sum of changes you need to make all inflation coefficients not more than k %?"              
                                  2200.0 1474D Cleaning "data structures,dp,greedy,math" "During cleaning the coast, Alice found n piles of stones. The i-th pile has ai stones.Piles i and i+1 are neighbouring for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. If pile i becomes empty, piles i\xe2\x88\x921 and i+1 doesn\'t become neighbouring.Alice is too lazy to remove these stones, so she asked you to take this duty. She allowed you to do only the following operation:   Select two neighboring piles and, if both of them are not empty, remove one stone from each of them. Alice understands that sometimes it\'s impossible to remove all stones with the given operation, so she allowed you to use the following superability:   Before the start of cleaning, you can select two neighboring piles and swap them. Determine, if it is possible to remove all stones using the superability not more than once."              
                                  3200.0 1470E "Strange Permutation" "binary search,combinatorics,data structures,dp,graphs,implementation,two pointers" "Alice had a permutation p1,p2,\xe2\x80\xa6,pn. Unfortunately, the permutation looked very boring, so she decided to change it and choose some non-overlapping subranges of this permutation and reverse them. The cost of reversing a single subrange [l,r] (elements from position l to position r, inclusive) is equal to r\xe2\x88\x92l, and the cost of the operation is the sum of costs of reversing individual subranges. Alice had an integer c in mind, so she only considered operations that cost no more than c.Then she got really bored, and decided to write down all the permutations that she could possibly obtain by performing exactly one operation on the initial permutation. Of course, Alice is very smart, so she wrote down each obtainable permutation exactly once (no matter in how many ways it can be obtained), and of course the list was sorted lexicographically.Now Bob would like to ask Alice some questions about her list. Each question is in the following form: what is the i-th number in the j-th permutation that Alice wrote down? Since Alice is too bored to answer these questions, she asked you to help her out."              
                                  2200.0 1470D "Strange Housing" "constructive algorithms,dfs and similar,graph matchings,graphs,greedy" "Students of Winter Informatics School are going to live in a set of houses connected by underground passages. Teachers are also going to live in some of these houses, but they can not be accommodated randomly. For safety reasons, the following must hold:  All passages between two houses will be closed, if there are no teachers in both of them. All other passages will stay open.  It should be possible to travel between any two houses using the underground passages that are open.  Teachers should not live in houses, directly connected by a passage. Please help the organizers to choose the houses where teachers will live to satisfy the safety requirements or determine that it is impossible."              
                                  2200.0 1468H "K and Medians" "constructive algorithms,greedy,math" "Let\'s denote the median of a sequence s with odd length as the value in the middle of s if we sort s in non-decreasing order. For example, let s=[1,2,5,7,2,3,12]. After sorting, we get sequence [1,2,2,3_,5,7,12], and the median is equal to 3.You have a sequence of n integers [1,2,\xe2\x80\xa6,n] and an odd integer k.In one step, you choose any k elements from the sequence and erase all chosen elements except their median. These elements do not have to go continuously (gaps are allowed between them).For example, if you have a sequence [1,2,3,4,5,6,7] (i.e. n=7) and k=3, then the following options for the first step are possible:  choose [1,2_,3]; 2 is their median, so it is not erased, and the resulting sequence is [2,4,5,6,7];  choose [2,4_,6]; 4 is their median, so it is not erased, and the resulting sequence is [1,3,4,5,7];  choose [1,6_,7]; 6 is their median, so it is not erased, and the resulting sequence is [2,3,4,5,6];  and several others. You can do zero or more steps. Can you get a sequence b1, b2, ..., bm after several steps?You\'ll be given t test cases. Solve each test case independently."              
                                  2900.0 1468B Bakery "data structures,dsu" "Monocarp would like to open a bakery in his local area. But, at first, he should figure out whether he can compete with other shops.Monocarp plans that the bakery will work for n days. On the i-th day, ai loaves of bread will be baked in the morning before the opening. At the end of the n-th day, Monocarp will sell all the remaining bread that wasn\'t sold earlier with a huge discount.Because of how bread is stored, the bakery seller sells the bread in the following order: firstly, he sells the loaves that were baked that morning; secondly, he sells the loaves that were baked the day before and weren\'t sold yet; then the loaves that were baked two days before and weren\'t sold yet, and so on. That\'s why some customers may buy a rather stale bread and will definitely spread negative rumors.Let\'s define loaf spoilage as the difference between the day it was baked and the day it was sold. Then the unattractiveness of the bakery will be equal to the maximum spoilage among all loaves of bread baked at the bakery.Suppose Monocarp\'s local area has consumer demand equal to k, it means that each day k customers will come to the bakery and each of them will ask for one loaf of bread (the loaves are sold according to the aforementioned order). If there is no bread left, then the person just doesn\'t buy anything. During the last day sale, all the remaining loaves will be sold (and they will still count in the calculation of the unattractiveness).Monocarp analyzed his competitors\' data and came up with m possible consumer demand values k1,k2,\xe2\x80\xa6,km, and now he\'d like to calculate the unattractiveness of the bakery for each value of demand. Can you help him?"              
                                  3300.0 1466H "Finding satisfactory solutions" combinatorics,dp,graphs,greedy,math "Getting so far in this contest is not an easy feat. By solving all the previous problems, you have impressed the gods greatly. Thus, they decided to spare you the story for this problem and grant a formal statement instead.Consider n agents. Each one of them initially has exactly one item, i-th agent has the item number i. We are interested in reassignments of these items among the agents. An assignment is valid iff each item is assigned to exactly one agent, and each agent is assigned exactly one item.Each agent has a preference over the items, which can be described by a permutation p of items sorted from the most to the least desirable. In other words, the agent prefers item i to item j iff i appears earlier in the permutation p. A preference profile is a list of n permutations of length n each, such that i-th permutation describes preferences of the i-th agent.It is possible that some of the agents are not happy with the assignment of items. A set of dissatisfied agents may choose not to cooperate with other agents. In such a case, they would exchange the items they possess initially (i-th item belongs to i-th agent) only between themselves. Agents from this group don\'t care about the satisfaction of agents outside of it. However, they need to exchange their items in such a way that will make at least one of them happier, and none of them less happy (in comparison to the given assignment).Formally, consider a valid assignment of items \xe2\x80\x94 A. Let A(i) denote the item assigned to i-th agent. Also, consider a subset of agents. Let S be the set of their indices. We will say this subset of agents is dissatisfied iff there exists a valid assignment B(i) such that:   For each i\xe2\x88\x88S, B(i)\xe2\x88\x88S.  No agent i\xe2\x88\x88S prefers A(i) to B(i) (no agent from the S is less happy).  At least one agent i\xe2\x88\x88S prefers B(i) to A(i) (at least one agent from the S is happier). An assignment is optimal if no subset of the agents is dissatisfied. Note that the empty subset cannot be dissatisfied. It can be proven that for each preference profile, there is precisely one optimal assignment.Example: Consider 3 agents with the following preference profile:   [2,1,3]  [1,2,3]  [1,3,2] And such an assignment:   First agent gets item 2  Second agent gets item 3.  Third agent gets item 1. See that the set of agents {1,2} is dissatisfied, because they can reassign their (initial) items in the following way:   First agent gets item 2.  Second agent gets item 1.  Third agent gets item 3. This reassignment will make the second agent happier and make no difference to the first agent. As a result, the third agent got an item that is worse for him, but this does not prevent the set {1,2} from being dissatisfied (he is not in this set).The following assignment would be optimal:   First agent gets item 2.  Second agent gets item 1.  Third agent gets item 3. Given an assignment A, calculate the number of distinct preference profiles for which assignment A is optimal. As the answer can be huge, output it modulo 109+7.Two preference profiles are different iff they assign different preference permutations to any agent."              
                                  2600.0 1466G "Song of the Sirens" "combinatorics,divide and conquer,hashing,math,string suffix structures,strings" "Whoso in ignorance draws near to them and hears the Sirens\' voice, he nevermore returns.Homer, OdysseyIn the times of Jason and the Argonauts, it was well known that sirens use the sound of their songs to lure sailors into their demise. Yet only a few knew that every time sirens call a sailor by his name, his will weakens, making him more vulnerable. For the purpose of this problem, both siren songs and names of the sailors will be represented as strings of lowercase English letters. The more times the sailor\'s name occurs as a contiguous substring of the song, the greater danger he is in.Jason found out that sirens can sing one of the n+1 songs, which have the following structure: let si (0\xe2\x89\xa4i\xe2\x89\xa4n) be the i-th song and t be a string of length n, then for every i<n: si+1=sitisi. In other words i+1-st song is the concatenation of i-th song, i-th letter (0-indexed) of t and the i-th song. Fortunately, he also knows s0 and t. Jason wonders how many times a sailor\'s name is mentioned in a particular song. Answer q queries: given the sailor\'s name (w) and the index of a song (i) output the number of occurrences of w in si as a substring. As this number can be quite large, output its remainder modulo 109+7."              
                                  1300.0 1459B "Move and Turn" dp,math "A robot is standing at the origin of the infinite two-dimensional plane. Each second the robot moves exactly 1 meter in one of the four cardinal directions: north, south, west, and east. For the first step the robot can choose any of the four directions, but then at the end of every second it has to turn 90 degrees left or right with respect to the direction it just moved in. For example, if the robot has just moved north or south, the next step it takes has to be either west or east, and vice versa.The robot makes exactly n steps from its starting position according to the rules above. How many different points can the robot arrive to at the end? The final orientation of the robot can be ignored."              
                                  3500.0 1456E XOR-ranges dp,greedy "Given integers c0,c1,\xe2\x80\xa6,ck\xe2\x88\x921 we can define the cost of a number 0\xe2\x89\xa4x<2k as p(x)=\xe2\x88\x91k\xe2\x88\x921i=0(\xe2\x8c\x8ax2i\xe2\x8c\x8bmod2)\xe2\x8b\x85ci. In other words, the cost of number x is the sum of ci over the bits of x which are equal to one.Let\'s define the cost of array a of length n\xe2\x89\xa52 with elements from [0,2k) as follows: cost(a)=\xe2\x88\x91n\xe2\x88\x921i=1p(ai\xe2\x8a\x95ai+1), where \xe2\x8a\x95 denotes bitwise exclusive OR operation.You have to construct an array of length n with minimal cost, given that each element should belong to the given segment: li\xe2\x89\xa4ai\xe2\x89\xa4ri."              
                                  800.0 1454B "Unique Bid Auction" implementation "There is a game called ""Unique Bid Auction"". You can read more about it here: https://en.wikipedia.org/wiki/Unique_bid_auction (though you don\'t have to do it to solve this problem).Let\'s simplify this game a bit. Formally, there are n participants, the i-th participant chose the number ai. The winner of the game is such a participant that the number he chose is unique (i. e. nobody else chose this number except him) and is minimal (i. e. among all unique values of a the minimum one is the winning one).Your task is to find the index of the participant who won the game (or -1 if there is no winner). Indexing is 1-based, i. e. the participants are numbered from 1 to n.You have to answer t independent test cases."              
                                  1900.0 1453D Checkpoints "brute force,constructive algorithms,greedy,math,probabilities" "Gildong is developing a game consisting of n stages numbered from 1 to n. The player starts the game from the 1-st stage and should beat the stages in increasing order of the stage number. The player wins the game after beating the n-th stage.There is at most one checkpoint on each stage, and there is always a checkpoint on the 1-st stage. At the beginning of the game, only the checkpoint on the 1-st stage is activated, and all other checkpoints are deactivated. When the player gets to the i-th stage that has a checkpoint, that checkpoint is activated.For each try of a stage, the player can either beat the stage or fail the stage. If they beat the i-th stage, the player is moved to the i+1-st stage. If they fail the i-th stage, the player is moved to the most recent checkpoint they activated, and they have to beat the stages after that checkpoint again.For example, assume that n=4 and the checkpoints are on the 1-st and 3-rd stages. The player starts at the 1-st stage. If they fail on the 1-st stage, they need to retry the 1-st stage because the checkpoint on the 1-st stage is the most recent checkpoint they activated. If the player beats the 1-st stage, they\'re moved to the 2-nd stage. If they fail it, they\'re sent back to the 1-st stage again. If they beat both the 1-st stage and the 2-nd stage, they get to the 3-rd stage and the checkpoint on the 3-rd stage is activated. Now whenever they fail on the 3-rd stage, or the 4-th stage after beating the 3-rd stage, they\'re sent back to the 3-rd stage. If they beat both the 3-rd stage and the 4-th stage, they win the game.Gildong is going to build the stages to have equal difficulty. He wants you to find any series of stages and checkpoints using at most 2000 stages, where the expected number of tries over all stages is exactly k, for a player whose probability of beating each stage is exactly 12."              
                                  1400.0 1452B "Toy Blocks" "binary search,greedy,math,sortings" "You are asked to watch your nephew who likes to play with toy blocks in a strange way.He has n boxes and the i-th box has ai blocks. His game consists of two steps:   he chooses an arbitrary box i;  he tries to move all blocks from the i-th box to other boxes.  If he can make the same number of blocks in each of n\xe2\x88\x921 other boxes then he will be happy, otherwise, will be sad. Note that your nephew can only move the blocks from the chosen box to the other boxes; he cannot move blocks from the other boxes.You don\'t want to make your nephew sad, so you decided to put several extra blocks into some boxes in such a way that no matter which box i he chooses he won\'t be sad. What is the minimum number of extra blocks you need to put?"              
                                  2000.0 1451E1 "Bitwise Queries (Easy Version)" "bitmasks,constructive algorithms,interactive,math" "The only difference between the easy and hard versions is the constraints on the number of queries.This is an interactive problem.Ridbit has a hidden array a of n integers which he wants Ashish to guess. Note that n is a power of two. Ashish is allowed to ask three different types of queries. They are of the form   AND i j: ask for the bitwise AND of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j)  OR i j: ask for the bitwise OR of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j)  XOR i j: ask for the bitwise XOR of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j) Can you help Ashish guess the elements of the array?In this version, each element takes a value in the range [0,n\xe2\x88\x921] (inclusive) and Ashish can ask no more than n+2 queries."              
                                  3000.0 1446D2 "Frequency Problem (Hard Version)" "data structures,greedy,two pointers" "This is the hard version of the problem. The difference between the versions is in the constraints on the array elements. You can make hacks only if all versions of the problem are solved.You are given an array [a1,a2,\xe2\x80\xa6,an]. Your goal is to find the length of the longest subarray of this array such that the most frequent value in it is not unique. In other words, you are looking for a subarray such that if the most frequent value occurs f times in this subarray, then at least 2 different values should occur exactly f times.An array c is a subarray of an array d if c can be obtained from d by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end."              
                                  1900.0 1444B "Divide and Sum" combinatorics,math,sortings "You are given an array a of length 2n. Consider a partition of array a into two subsequences p and q of length n each (each element of array a should be in exactly one subsequence: either in p or in q).Let\'s sort p in non-decreasing order, and q in non-increasing order, we can denote the sorted versions by x and y, respectively. Then the cost of a partition is defined as f(p,q)=\xe2\x88\x91ni=1|xi\xe2\x88\x92yi|.Find the sum of f(p,q) over all correct partitions of array a. Since the answer might be too big, print its remainder modulo 998244353."              
                                  2500.0 1438E "Yurii Can Do Everything" "binary search,bitmasks,brute force,constructive algorithms,divide and conquer,two pointers" "Yurii is sure he can do everything. Can he solve this task, though?He has an array a consisting of n positive integers. Let\'s call a subarray a[l...r] good if the following conditions are simultaneously satisfied:   l+1\xe2\x89\xa4r\xe2\x88\x921, i. e. the subarray has length at least 3;  (al\xe2\x8a\x95ar)=(al+1+al+2+\xe2\x80\xa6+ar\xe2\x88\x922+ar\xe2\x88\x921), where \xe2\x8a\x95 denotes the bitwise XOR operation. In other words, a subarray is good if the bitwise XOR of the two border elements is equal to the sum of the rest of the elements. Yurii wants to calculate the total number of good subarrays. What is it equal to?An array c is a subarray of an array d if c can be obtained from d by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end."              
                                  1600.0 1437D "Minimal Height Tree" "graphs,greedy,shortest paths,trees" "Monocarp had a tree which consisted of n vertices and was rooted at vertex 1. He decided to study BFS (Breadth-first search), so he ran BFS on his tree, starting from the root. BFS can be described by the following pseudocode:a = [] # the order in which vertices were processedq = Queue()q.put(1) # place the root at the end of the queuewhile not q.empty():    k = q.pop() # retrieve the first vertex from the queue    a.append(k) # append k to the end of the sequence in which vertices were visited    for y in g[k]: # g[k] is the list of all children of vertex k, sorted in ascending order        q.put(y)Monocarp was fascinated by BFS so much that, in the end, he lost his tree. Fortunately, he still has a sequence of vertices, in which order vertices were visited by the BFS algorithm (the array a from the pseudocode). Monocarp knows that each vertex was visited exactly once (since they were put and taken from the queue exactly once). Also, he knows that all children of each vertex were viewed in ascending order.Monocarp knows that there are many trees (in the general case) with the same visiting order a, so he doesn\'t hope to restore his tree. Monocarp is okay with any tree that has minimum height.The height of a tree is the maximum depth of the tree\'s vertices, and the depth of a vertex is the number of edges in the path from the root to it. For example, the depth of vertex 1 is 0, since it\'s the root, and the depth of all root\'s children are 1.Help Monocarp to find any tree with given visiting order a and minimum height."              
                                  2800.0 1436F "Sum Over Subsets" "combinatorics,math,number theory" "You are given a multiset S. Over all pairs of subsets A and B, such that:  B\xe2\x8a\x82A;  |B|=|A|\xe2\x88\x921;  greatest common divisor of all elements in A is equal to one; find the sum of \xe2\x88\x91x\xe2\x88\x88Ax\xe2\x8b\x85\xe2\x88\x91x\xe2\x88\x88Bx, modulo 998244353."              
                                  1300.0 1433E "Two Round Dances" combinatorics,math "One day, n people (n is an even number) met on a plaza and made two round dances, each round dance consists of exactly n2 people. Your task is to find the number of ways n people can make two round dances if each round dance consists of exactly n2 people. Each person should belong to exactly one of these two round dances.Round dance is a dance circle consisting of 1 or more people. Two round dances are indistinguishable (equal) if one can be transformed to another by choosing the first participant. For example, round dances [1,3,4,2], [4,2,1,3] and [2,1,3,4] are indistinguishable.For example, if n=2 then the number of ways is 1: one round dance consists of the first person and the second one of the second person.For example, if n=4 then the number of ways is 3. Possible options:  one round dance \xe2\x80\x94 [1,2], another \xe2\x80\x94 [3,4];  one round dance \xe2\x80\x94 [2,4], another \xe2\x80\x94 [3,1];  one round dance \xe2\x80\x94 [4,1], another \xe2\x80\x94 [3,2]. Your task is to find the number of ways n people can make two round dances if each round dance consists of exactly n2 people."              
                                  1200.0 1433D "Districts Connection" "constructive algorithms,dfs and similar" "There are n districts in the town, the i-th district belongs to the ai-th bandit gang. Initially, no districts are connected to each other.You are the mayor of the city and want to build n\xe2\x88\x921 two-way roads to connect all districts (two districts can be connected directly or through other connected districts).If two districts belonging to the same gang are connected directly with a road, this gang will revolt.You don\'t want this so your task is to build n\xe2\x88\x921 two-way roads in such a way that all districts are reachable from each other (possibly, using intermediate districts) and each pair of directly connected districts belong to different gangs, or determine that it is impossible to build n\xe2\x88\x921 roads to satisfy all the conditions.You have to answer t independent test cases."              
                                  800.0 1433B "Yet Another Bookshelf" greedy,implementation "There is a bookshelf which can fit n books. The i-th position of bookshelf is ai=1 if there is a book on this position and ai=0 otherwise. It is guaranteed that there is at least one book on the bookshelf.In one move, you can choose some contiguous segment [l;r] consisting of books (i.e. for each i from l to r the condition ai=1 holds) and:  Shift it to the right by 1: move the book at index i to i+1 for all l\xe2\x89\xa4i\xe2\x89\xa4r. This move can be done only if r+1\xe2\x89\xa4n and there is no book at the position r+1.  Shift it to the left by 1: move the book at index i to i\xe2\x88\x921 for all l\xe2\x89\xa4i\xe2\x89\xa4r. This move can be done only if l\xe2\x88\x921\xe2\x89\xa51 and there is no book at the position l\xe2\x88\x921. Your task is to find the minimum number of moves required to collect all the books on the shelf as a contiguous (consecutive) segment (i.e. the segment without any gaps).For example, for a=[0,0,1,0,1] there is a gap between books (a4=0 when a3=1 and a5=1), for a=[1,1,0] there are no gaps between books and for a=[0,0,0] there are also no gaps between books.You have to answer t independent test cases."              
                                  800.0 1430B Barrels greedy,implementation,sortings "You have n barrels lined up in a row, numbered from left to right from one. Initially, the i-th barrel contains ai liters of water.You can pour water from one barrel to another. In one act of pouring, you can choose two different barrels x and y (the x-th barrel shouldn\'t be empty) and pour any possible amount of water from barrel x to barrel y (possibly, all water). You may assume that barrels have infinite capacity, so you can pour any amount of water in each of them. Calculate the maximum possible difference between the maximum and the minimum amount of water in the barrels, if you can pour water at most k times.Some examples:   if you have four barrels, each containing 5 liters of water, and k=1, you may pour 5 liters from the second barrel into the fourth, so the amounts of water in the barrels are [5,0,5,10], and the difference between the maximum and the minimum is 10;  if all barrels are empty, you can\'t make any operation, so the difference between the maximum and the minimum amount is still 0."              
                                  3000.0 1428G2 "Lucky Numbers (Hard Version)" dp,greedy "This is the hard version of the problem. The only difference is in the constraint on q. You can make hacks only if all versions of the problem are solved.Zookeeper has been teaching his q sheep how to write and how to add. The i-th sheep has to write exactly k non-negative integers with the sum ni.Strangely, sheep have superstitions about digits and believe that the digits 3, 6, and 9 are lucky. To them, the fortune of a number depends on the decimal representation of the number; the fortune of a number is equal to the sum of fortunes of its digits, and the fortune of a digit depends on its value and position and can be described by the following table. For example, the number 319 has fortune F2+3F0.   Each sheep wants to maximize the sum of fortune among all its k written integers. Can you help them?"              
                                  2900.0 1428G1 "Lucky Numbers (Easy Version)" dp,greedy "This is the easy version of the problem. The only difference is that in this version q=1. You can make hacks only if all versions of the problem are solved.Zookeeper has been teaching his q sheep how to write and how to add. The i-th sheep has to write exactly k non-negative integers with the sum ni.Strangely, sheep have superstitions about digits and believe that the digits 3, 6, and 9 are lucky. To them, the fortune of a number depends on the decimal representation of the number; the fortune of a number is equal to the sum of fortunes of its digits, and the fortune of a digit depends on its value and position and can be described by the following table. For example, the number 319 has fortune F2+3F0.   Each sheep wants to maximize the sum of fortune among all its k written integers. Can you help them?"              
                                  2000.0 1427D "Unshuffling a Deck" "constructive algorithms,implementation" "You are given a deck of n cards numbered from 1 to n (not necessarily in this order in the deck). You have to sort the deck by repeating the following operation.   Choose 2\xe2\x89\xa4k\xe2\x89\xa4n and split the deck in k nonempty contiguous parts D1,D2,\xe2\x80\xa6,Dk (D1 contains the first |D1| cards of the deck, D2 contains the following |D2| cards and so on). Then reverse the order of the parts, transforming the deck into Dk,Dk\xe2\x88\x921,\xe2\x80\xa6,D2,D1 (so, the first |Dk| cards of the new deck are Dk, the following |Dk\xe2\x88\x921| cards are Dk\xe2\x88\x921 and so on). The internal order of each packet of cards Di is unchanged by the operation. You have to obtain a sorted deck (i.e., a deck where the first card is 1, the second is 2 and so on) performing at most n operations. It can be proven that it is always possible to sort the deck performing at most n operations.Examples of operation: The following are three examples of valid operations (on three decks with different sizes).   If the deck is [3 6 2 1 4 5 7] (so 3 is the first card and 7 is the last card), we may apply the operation with k=4 and D1=[3 6], D2=[2 1 4], D3=[5], D4=[7]. Doing so, the deck becomes [7 5 2 1 4 3 6].  If the deck is [3 1 2], we may apply the operation with k=3 and D1=[3], D2=[1], D3=[2]. Doing so, the deck becomes [2 1 3].  If the deck is [5 1 2 4 3 6], we may apply the operation with k=2 and D1=[5 1], D2=[2 4 3 6]. Doing so, the deck becomes [2 4 3 6 5 1]."              
                                  2600.0 1423L "Light switches" meet-in-the-middle "Nikola owns a large warehouse which is illuminated by N light bulbs, numbered 1 to N. At the exit of the warehouse, there are S light switches, numbered 1 to S. Each switch swaps the on/off state for some light bulbs, so if a light bulb is off, flipping the switch turns it on, and if the light bulb is on, flipping the switch turns it off.At the end of the day, Nikola wants to turn all the lights off. To achieve this, he will flip some of the light switches at the exit of the warehouse, but since Nikola is lazy, he wants to flip the _minimum_ number of switches required to turn all the lights off. Since Nikola was not able to calculate the minimum number of switches, he asked you to help him. During a period of D days, Nikola noted which light bulbs were off and which were on at the end of each day. He wants you to tell him the minimum number of switches he needed to flip to turn all the lights off for each of the D days or tell him that it\'s impossible."              
                                  2500.0 1423H Virus "data structures,divide and conquer,dsu,graphs" "In Bubbleland a group of special programming forces gets a top secret job to calculate the number of potentially infected people by a new unknown virus. The state has a population of n people and every day there is new information about new contacts between people. The job of special programming forces is to calculate how many contacts in the last k days a given person had. The new virus has an incubation period of k days, and after that time people consider as non-infectious. Because the new virus is an extremely dangerous, government mark as suspicious everybody who had direct or indirect contact in the last k days, independently of the order of contacts.This virus is very strange, and people can\'t get durable immunity.You need to help special programming forces to calculate the number of suspicious people for a given person (number of people who had contact with a given person).There are 3 given inputs on beginning n where n is population, q number of queries, k virus incubation time in days. Each query is one of three types:    (x, y) person x and person y met that day (x\xe2\x89\xa0y).   (z) return the number of people in contact with z, counting himself.   The end of the current day moves on to the next day."              
                                  2300.0 1422D "Returning Home" "graphs,shortest paths,sortings" "Yura has been walking for some time already and is planning to return home. He needs to get home as fast as possible. To do this, Yura can use the instant-movement locations around the city.Let\'s represent the city as an area of n\xc3\x97n square blocks. Yura needs to move from the block with coordinates (sx,sy) to the block with coordinates (fx,fy). In one minute Yura can move to any neighboring by side block; in other words, he can move in four directions. Also, there are m instant-movement locations in the city. Their coordinates are known to you and Yura. Yura can move to an instant-movement location in no time if he is located in a block with the same coordinate x or with the same coordinate y as the location.Help Yura to find the smallest time needed to get home."              
                                  2700.0 1421E "Swedish Heroes" "brute force,dp,implementation" "While playing yet another strategy game, Mans has recruited n Swedish heroes, whose powers which can be represented as an array a.Unfortunately, not all of those mighty heroes were created as capable as he wanted, so that he decided to do something about it. In order to accomplish his goal, he can pick two consecutive heroes, with powers ai and ai+1, remove them and insert a hero with power \xe2\x88\x92(ai+ai+1) back in the same position. For example if the array contains the elements [5,6,7,8], he can pick 6 and 7 and get [5,\xe2\x88\x92(6+7),8]=[5,\xe2\x88\x9213,8].After he will perform this operation n\xe2\x88\x921 times, Mans will end up having only one hero. He wants his power to be as big as possible. What\'s the largest possible power he can achieve?"              
                                  1100.0 1421B "Putting Bricks in the Wall" "constructive algorithms,implementation" "Pink Floyd are pulling a prank on Roger Waters. They know he doesn\'t like walls, he wants to be able to walk freely, so they are blocking him from exiting his room which can be seen as a grid.Roger Waters has a square grid of size n\xc3\x97n and he wants to traverse his grid from the upper left (1,1) corner to the lower right corner (n,n). Waters can move from a square to any other square adjacent by a side, as long as he is still in the grid. Also except for the cells (1,1) and (n,n) every cell has a value 0 or 1 in it.Before starting his traversal he will pick either a 0 or a 1 and will be able to only go to cells values in which are equal to the digit he chose. The starting and finishing cells (1,1) and (n,n) are exempt from this rule, he may go through them regardless of picked digit. Because of this the cell (1,1) takes value the letter \'S\' and the cell (n,n) takes value the letter \'F\'.For example, in the first example test case, he can go from (1,1) to (n,n) by using the zeroes on this path: (1,1), (2,1), (2,2), (2,3), (3,3), (3,4), (4,4)The rest of the band (Pink Floyd) wants Waters to not be able to do his traversal, so while he is not looking they will invert at most two cells in the grid (from 0 to 1 or vice versa). They are afraid they will not be quick enough and asked for your help in choosing the cells.  Note that you cannot invert cells (1,1) and (n,n).We can show that there always exists a solution for the given constraints.Also note that Waters will pick his digit of the traversal after the band has changed his grid, so he must not be able to reach (n,n) no matter what digit he picks."              
                                  800.0 1421A XORwice bitmasks,greedy,math "In order to celebrate Twice\'s 5th anniversary, Tzuyu and Sana decided to play a game.Tzuyu gave Sana two integers a and b and a really important quest.In order to complete the quest, Sana has to output the smallest possible value of (a\xe2\x8a\x95x) + (b\xe2\x8a\x95x) for any given x, where \xe2\x8a\x95 denotes the bitwise XOR operation."              
                                  2100.0 1420C2 "Pok\xc3\xa9mon Army (hard version)" "data structures,divide and conquer,dp,greedy,implementation" "This is the hard version of the problem. The difference between the versions is that the easy version has no swap operations. You can make hacks only if all versions of the problem are solved.Pikachu is a cute and friendly pok\xc3\xa9mon living in the wild pikachu herd.But it has become known recently that infamous team R wanted to steal all these pok\xc3\xa9mon! Pok\xc3\xa9mon trainer Andrew decided to help Pikachu to build a pok\xc3\xa9mon army to resist.First, Andrew counted all the pok\xc3\xa9mon \xe2\x80\x94 there were exactly n pikachu. The strength of the i-th pok\xc3\xa9mon is equal to ai, and all these numbers are distinct.As an army, Andrew can choose any non-empty subsequence of pokemons. In other words, Andrew chooses some array b from k indices such that 1\xe2\x89\xa4b1<b2<\xe2\x8b\xaf<bk\xe2\x89\xa4n, and his army will consist of pok\xc3\xa9mons with forces ab1,ab2,\xe2\x80\xa6,abk.The strength of the army is equal to the alternating sum of elements of the subsequence; that is, ab1\xe2\x88\x92ab2+ab3\xe2\x88\x92ab4+\xe2\x80\xa6.Andrew is experimenting with pok\xc3\xa9mon order. He performs q operations. In i-th operation Andrew swaps li-th and ri-th pok\xc3\xa9mon.Andrew wants to know the maximal stregth of the army he can achieve with the initial pok\xc3\xa9mon placement. He also needs to know the maximal strength after each operation.Help Andrew and the pok\xc3\xa9mon, or team R will realize their tricky plan!"              
                                  900.0 1419A "Digit Game" games,greedy,implementation "Everyone knows that agents in Valorant decide, who will play as attackers, and who will play as defenders. To do that Raze and Breach decided to play t matches of a digit game...In each of t matches of the digit game, a positive integer is generated. It consists of n digits. The digits of this integer are numerated from 1 to n from the highest-order digit to the lowest-order digit. After this integer is announced, the match starts.Agents play in turns. Raze starts. In one turn an agent can choose any unmarked digit and mark it. Raze can choose digits on odd positions, but can not choose digits on even positions. Breach can choose digits on even positions, but can not choose digits on odd positions. The match ends, when there is only one unmarked digit left. If the single last digit is odd, then Raze wins, else Breach wins.It can be proved, that before the end of the match (for every initial integer with n digits) each agent has an ability to make a turn, i.e. there is at least one unmarked digit, that stands on a position of required parity.For each of t matches find out, which agent wins, if both of them want to win and play optimally."              
                                  2500.0 1418G "Three Occurrences" "data structures,divide and conquer,hashing,two pointers" "You are given an array a consisting of n integers. We denote the subarray a[l..r] as the array [al,al+1,\xe2\x80\xa6,ar] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n).A subarray is considered good if every integer that occurs in this subarray occurs there exactly thrice. For example, the array [1,2,2,2,1,1,2,2,2] has three good subarrays:  a[1..6]=[1,2,2,2,1,1];  a[2..4]=[2,2,2];  a[7..9]=[2,2,2]. Calculate the number of good subarrays of the given array a."              
                                  3300.0 1416F "Showing Off" "flows,graph matchings,greedy,implementation" "Another dull quarantine day was going by when BThero decided to start researching matrices of size n\xc3\x97m. The rows are numerated 1 through n from top to bottom, and the columns are numerated 1 through m from left to right. The cell in the i-th row and j-th column is denoted as (i,j).For each cell (i,j) BThero had two values:   The cost of the cell, which is a single positive integer.  The direction of the cell, which is one of characters L, R, D, U. Those characters correspond to transitions to adjacent cells (i,j\xe2\x88\x921), (i,j+1), (i+1,j) or (i\xe2\x88\x921,j), respectively. No transition pointed outside of the matrix. Let us call a cell (i2,j2) reachable from (i1,j1), if, starting from (i1,j1) and repeatedly moving to the adjacent cell according to our current direction, we will, sooner or later, visit (i2,j2). BThero decided to create another matrix from the existing two. For a cell (i,j), let us denote Si,j as a set of all reachable cells from it (including (i,j) itself). Then, the value at the cell (i,j) in the new matrix will be equal to the sum of costs of all cells in Si,j. After quickly computing the new matrix, BThero immediately sent it to his friends. However, he did not save any of the initial matrices! Help him to restore any two valid matrices, which produce the current one."              
                                  1700.0 1413D Shurikens "data structures,greedy,implementation" "Tenten runs a weapon shop for ninjas. Today she is willing to sell n shurikens which cost 1, 2, ..., n ryo (local currency). During a day, Tenten will place the shurikens onto the showcase, which is empty at the beginning of the day. Her job is fairly simple: sometimes Tenten places another shuriken (from the available shurikens) on the showcase, and sometimes a ninja comes in and buys a shuriken from the showcase. Since ninjas are thrifty, they always buy the cheapest shuriken from the showcase.Tenten keeps a record for all events, and she ends up with a list of the following types of records:  + means that she placed another shuriken on the showcase;  - x means that the shuriken of price x was bought. Today was a lucky day, and all shurikens were bought. Now Tenten wonders if her list is consistent, and what could be a possible order of placing the shurikens on the showcase. Help her to find this out!"              
                                  1900.0 1413C "Perform Easily" "binary search,brute force,dp,implementation,sortings,two pointers" "After battling Shikamaru, Tayuya decided that her flute is too predictable, and replaced it with a guitar. The guitar has 6 strings and an infinite number of frets numbered from 1. Fretting the fret number j on the i-th string produces the note ai+j.Tayuya wants to play a melody of n notes. Each note can be played on different string-fret combination. The easiness of performance depends on the difference between the maximal and the minimal indices of used frets. The less this difference is, the easier it is to perform the technique. Please determine the minimal possible difference.For example, if a=[1,1,2,2,3,3], and the sequence of notes is 4,11,11,12,12,13,13 (corresponding to the second example), we can play the first note on the first string, and all the other notes on the sixth string. Then the maximal fret will be 10, the minimal one will be 3, and the answer is 10\xe2\x88\x923=7, as shown on the picture."              
                                  2100.0 1411D "Grime Zoo" "brute force,greedy,implementation,strings" "Currently, XXOC\'s rap is a string consisting of zeroes, ones, and question marks. Unfortunately, haters gonna hate. They will write x angry comments for every occurrence of subsequence 01 and y angry comments for every occurrence of subsequence 10. You should replace all the question marks with 0 or 1 in such a way that the number of angry comments would be as small as possible.String b is a subsequence of string a, if it can be obtained by removing some characters from a. Two occurrences of a subsequence are considered distinct if sets of positions of remaining characters are distinct."              
                                  2100.0 1409F "Subsequences of Length Two" dp,strings "You are given two strings s and t consisting of lowercase Latin letters. The length of t is 2 (i.e. this string consists only of two characters).In one move, you can choose any character of s and replace it with any lowercase Latin letter. More formally, you choose some i and replace si (the character at the position i) with some character from \'a\' to \'z\'.You want to do no more than k replacements in such a way that maximizes the number of occurrences of t in s as a subsequence.Recall that a subsequence is a sequence that can be derived from the given sequence by deleting zero or more elements without changing the order of the remaining elements."              
                                  1200.0 1409C "Yet Another Array Restoration" "brute force,math,number theory" "We have a secret array. You don\'t know this array and you have to restore it. However, you know some facts about this array:  The array consists of n distinct positive (greater than 0) integers.  The array contains two elements x and y (these elements are known for you) such that x<y.  If you sort the array in increasing order (such that a1<a2<\xe2\x80\xa6<an), differences between all adjacent (consecutive) elements are equal (i.e. a2\xe2\x88\x92a1=a3\xe2\x88\x92a2=\xe2\x80\xa6=an\xe2\x88\x92an\xe2\x88\x921). It can be proven that such an array always exists under the constraints given below.Among all possible arrays that satisfy the given conditions, we ask you to restore one which has the minimum possible maximum element. In other words, you have to minimize max(a1,a2,\xe2\x80\xa6,an).You have to answer t independent test cases."              
                                  1500.0 1408C "Discrete Acceleration" "binary search,dp,implementation,math,two pointers" "There is a road with length l meters. The start of the road has coordinate 0, the end of the road has coordinate l.There are two cars, the first standing at the start of the road and the second standing at the end of the road. They will start driving simultaneously. The first car will drive from the start to the end and the second car will drive from the end to the start.Initially, they will drive with a speed of 1 meter per second. There are n flags at different coordinates a1,a2,\xe2\x80\xa6,an. Each time when any of two cars drives through a flag, the speed of that car increases by 1 meter per second.Find how long will it take for cars to meet (to reach the same coordinate)."              
                                  2200.0 1407D "Discrete Centrifugal Jumps" "data structures,dp,graphs" "There are n beautiful skyscrapers in New York, the height of the i-th one is hi. Today some villains have set on fire first n\xe2\x88\x921 of them, and now the only safety building is n-th skyscraper.Let\'s call a jump from i-th skyscraper to j-th (i<j) discrete, if all skyscrapers between are strictly lower or higher than both of them. Formally, jump is discrete, if i<j and one of the following conditions satisfied:   i+1=j  max(hi+1,\xe2\x80\xa6,hj\xe2\x88\x921)<min(hi,hj)  max(hi,hj)<min(hi+1,\xe2\x80\xa6,hj\xe2\x88\x921). At the moment, Vasya is staying on the first skyscraper and wants to live a little longer, so his goal is to reach n-th skyscraper with minimal count of discrete jumps. Help him with calcualting this number."              
                                  1100.0 1407A Ahahahahahahahaha "constructive algorithms,math" "Alexandra has an even-length array a, consisting of 0s and 1s. The elements of the array are enumerated from 1 to n. She wants to remove at most n2 elements (where n \xe2\x80\x94 length of array) in the way that alternating sum of the array will be equal 0 (i.e. a1\xe2\x88\x92a2+a3\xe2\x88\x92a4+\xe2\x80\xa6=0). In other words, Alexandra wants sum of all elements at the odd positions and sum of all elements at the even positions to become equal. The elements that you remove don\'t have to be consecutive.For example, if she has a=[1,0,1,0,0,0] and she removes 2nd and 4th elements, a will become equal [1,1,0,0] and its alternating sum is 1\xe2\x88\x921+0\xe2\x88\x920=0.Help her!"              
                                  3200.0 1403C "Chess Rush" "*special problem,combinatorics,dp,implementation,math" "The mythic world of Chess Land is a rectangular grid of squares with R rows and C columns, R being greater than or equal to C. Its rows and columns are numbered from 1 to R and 1 to C, respectively. The inhabitants of Chess Land are usually mentioned as pieces in everyday language, and there are 5 specific types of them roaming the land: pawns, rooks, bishops, queens and kings. Contrary to popular belief, chivalry is long dead in Chess Land, so there are no knights to be found.Each piece is unique in the way it moves around from square to square: in one step,   a pawn can move one row forward (i.e. from row r to r+1), without changing columns;  a rook can move any number of columns left/right without changing rows OR move any number of rows forward/backward without changing columns;  a bishop can move to any square of the two diagonals intersecting at its currently occupied square;  a queen can move to any square where a rook or a bishop could move to from her position;  and a king can move to any of the 8 adjacent squares.  In the following figure, we marked by X the squares each piece can move to in a single step (here, the rows are numbered from bottom to top, and the columns from left to right).  Recently, Chess Land has become a dangerous place: pieces that are passing through the land can get captured unexpectedly by unknown forces and simply disappear. As a consequence, they would like to reach their destinations as fast (i.e. in as few moves) as possible, and they are also interested in the number of different ways it is possible for them to reach it, using the minimal number of steps \xe2\x80\x93 because more paths being available could mean lower chances of getting captured. Two paths are considered different if they differ in at least one visited square.For this problem, let us assume that pieces are entering Chess Land in a given column of row 1, and exit the land in a given column of row R. Your task is to answer Q questions: given the type of a piece, the column it enters row 1 and the column it must reach in row R in order to exit, compute the minimal number of moves it has to make in Chess Land, and the number of different ways it is able to do so."              
                                  2400.0 1403A "The Potion of Great Power" "*special problem,2-sat,binary search,data structures,graphs,interactive,sortings,two pointers" "Once upon a time, in the Land of the Shamans, everyone lived on the Sky-High Beanstalk. Each shaman had a unique identifying number i between 0 and N\xe2\x88\x921, and an altitude value Hi, representing how high he lived above ground level. The distance between two altitudes is the absolute value of their difference.All shamans lived together in peace, until one of them stole the formula of the world-famous Potion of Great Power. To cover his/her tracks, the Thief has put a Curse on the land: most inhabitants could no longer trust each other...Despite the very difficult circumstances, the Order of Good Investigators have gained the following information about the Curse:   When the Curse first takes effect, everyone stops trusting each other.   The Curse is unstable: at the end of each day (exactly at midnight), one pair of shamans will start or stop trusting each other.   Unfortunately, each shaman will only ever trust at most D others at any given time.  They have also reconstructed a log of who trusted whom: for each night they know which pair of shamans started/stopped trusting each other.They believe the Thief has whispered the formula to an Evil Shaman. To avoid detection, both of them visited the home of one of their (respective) trusted friends. During the visit, the Thief whispered the formula to the Evil Shaman through the window. (Note: this trusted friend did not have to be home at the time. In fact, it\'s even possible that they visited each other\'s houses \xe2\x80\x93 shamans are weird.)Fortunately, whispers only travel short distances, so the Order knows the two trusted friends visited (by the Thief and the Evil Shaman) must live very close to each other.They ask you to help with their investigation. They would like to test their suspicions: what if the Thief was x, the Evil Shaman was y, and the formula was whispered on day v? What is the smallest distance the whispered formula had to travel? That is, what is the minimum distance between the apartments of some shamans x\xe2\x80\xb2 and y\xe2\x80\xb2 (i.e. min(|Hx\xe2\x80\xb2\xe2\x88\x92Hy\xe2\x80\xb2|)), such that x\xe2\x80\xb2 was a trusted friend of x and y\xe2\x80\xb2 was a trusted friend of y on day v?They will share all their information with you, then ask you a number of questions. You need to answer each question immediately, before receiving the next one."              
                                  1500.0 1400C "Binary String Reconstruction" "2-sat,brute force,constructive algorithms,greedy" "Consider the following process. You have a binary string (a string where each character is either 0 or 1) w of length n and an integer x. You build a new binary string s consisting of n characters. The i-th character of s is chosen as follows:  if the character wi\xe2\x88\x92x exists and is equal to 1, then si is 1 (formally, if i>x and wi\xe2\x88\x92x= 1, then si= 1);  if the character wi+x exists and is equal to 1, then si is 1 (formally, if i+x\xe2\x89\xa4n and wi+x= 1, then si= 1);  if both of the aforementioned conditions are false, then si is 0. You are given the integer x and the resulting string s. Reconstruct the original string w."              
                                  800.0 1400A "String Similarity" "constructive algorithms,strings" "A binary string is a string where each character is either 0 or 1. Two binary strings a and b of equal length are similar, if they have the same character in some position (there exists an integer i such that ai=bi). For example:  10010 and 01111 are similar (they have the same character in position 4);  10010 and 11111 are similar;  111 and 111 are similar;  0110 and 1001 are not similar. You are given an integer n and a binary string s consisting of 2n\xe2\x88\x921 characters. Let\'s denote s[l..r] as the contiguous substring of s starting with l-th character and ending with r-th character (in other words, s[l..r]=slsl+1sl+2\xe2\x80\xa6sr).You have to construct a binary string w of length n which is similar to all of the following strings: s[1..n], s[2..n+1], s[3..n+2], ..., s[n..2n\xe2\x88\x921]."              
                                  2200.0 1398E "Two Types of Spells" "binary search,data structures,greedy,implementation,math,sortings" "Polycarp plays a computer game (yet again). In this game, he fights monsters using magic spells.There are two types of spells: fire spell of power x deals x damage to the monster, and lightning spell of power y deals y damage to the monster and doubles the damage of the next spell Polycarp casts. Each spell can be cast only once per battle, but Polycarp can cast them in any order.For example, suppose that Polycarp knows three spells: a fire spell of power 5, a lightning spell of power 1, and a lightning spell of power 8. There are 6 ways to choose the order in which he casts the spells:  first, second, third. This order deals 5+1+2\xe2\x8b\x858=22 damage;  first, third, second. This order deals 5+8+2\xe2\x8b\x851=15 damage;  second, first, third. This order deals 1+2\xe2\x8b\x855+8=19 damage;  second, third, first. This order deals 1+2\xe2\x8b\x858+2\xe2\x8b\x855=27 damage;  third, first, second. This order deals 8+2\xe2\x8b\x855+1=19 damage;  third, second, first. This order deals 8+2\xe2\x8b\x851+2\xe2\x8b\x855=20 damage. Initially, Polycarp knows 0 spells. His spell set changes n times, each time he either learns a new spell or forgets an already known one. After each change, calculate the maximum possible damage Polycarp may deal using the spells he knows."              
                                  1800.0 1398D "Colored Rectangles" dp,greedy,sortings "You are given three multisets of pairs of colored sticks:   R pairs of red sticks, the first pair has length r1, the second pair has length r2, \xe2\x80\xa6, the R-th pair has length rR;  G pairs of green sticks, the first pair has length g1, the second pair has length g2, \xe2\x80\xa6, the G-th pair has length gG;  B pairs of blue sticks, the first pair has length b1, the second pair has length b2, \xe2\x80\xa6, the B-th pair has length bB; You are constructing rectangles from these pairs of sticks with the following process:   take a pair of sticks of one color;  take a pair of sticks of another color different from the first one;  add the area of the resulting rectangle to the total area. Thus, you get such rectangles that their opposite sides are the same color and their adjacent sides are not the same color.Each pair of sticks can be used at most once, some pairs can be left unused. You are not allowed to split a pair into independent sticks.What is the maximum area you can achieve?"              
                                  2300.0 1396C "Monster Invaders" dp,greedy,implementation "Ziota found a video game called ""Monster Invaders"".Similar to every other shooting RPG game, ""Monster Invaders"" involves killing monsters and bosses with guns.For the sake of simplicity, we only consider two different types of monsters and three different types of guns.Namely, the two types of monsters are:   a normal monster with 1 hp.  a boss with 2 hp. And the three types of guns are:   Pistol, deals 1 hp in damage to one monster, r1 reloading time  Laser gun, deals 1 hp in damage to all the monsters in the current level (including the boss), r2 reloading time  AWP, instantly kills any monster, r3 reloading time The guns are initially not loaded, and the Ziota can only reload 1 gun at a time.The levels of the game can be considered as an array a1,a2,\xe2\x80\xa6,an, in which the i-th stage has ai normal monsters and 1 boss. Due to the nature of the game, Ziota cannot use the Pistol (the first type of gun) or AWP (the third type of gun) to shoot the boss before killing all of the ai normal monsters.If Ziota damages the boss but does not kill it immediately, he is forced to move out of the current level to an arbitrary adjacent level (adjacent levels of level i (1<i<n) are levels i\xe2\x88\x921 and i+1, the only adjacent level of level 1 is level 2, the only adjacent level of level n is level n\xe2\x88\x921). Ziota can also choose to move to an adjacent level at any time. Each move between adjacent levels are managed by portals with d teleportation time.In order not to disrupt the space-time continuum within the game, it is strictly forbidden to reload or shoot monsters during teleportation. Ziota starts the game at level 1. The objective of the game is rather simple, to kill all the bosses in all the levels. He is curious about the minimum time to finish the game (assuming it takes no time to shoot the monsters with a loaded gun and Ziota has infinite ammo on all the three guns). Please help him find this value."              
                                  1700.0 1392D "Omkar and Bed Wars" dp,greedy "Omkar is playing his favorite pixelated video game, Bed Wars! In Bed Wars, there are n players arranged in a circle, so that for all j such that 2\xe2\x89\xa4j\xe2\x89\xa4n, player j\xe2\x88\x921 is to the left of the player j, and player j is to the right of player j\xe2\x88\x921. Additionally, player n is to the left of player 1, and player 1 is to the right of player n.Currently, each player is attacking either the player to their left or the player to their right. This means that each player is currently being attacked by either 0, 1, or 2 other players. A key element of Bed Wars strategy is that if a player is being attacked by exactly 1 other player, then they should logically attack that player in response. If instead a player is being attacked by 0 or 2 other players, then Bed Wars strategy says that the player can logically attack either of the adjacent players.Unfortunately, it might be that some players in this game are not following Bed Wars strategy correctly. Omkar is aware of whom each player is currently attacking, and he can talk to any amount of the n players in the game to make them instead attack another player  \xe2\x80\x94 i. e. if they are currently attacking the player to their left, Omkar can convince them to instead attack the player to their right; if they are currently attacking the player to their right, Omkar can convince them to instead attack the player to their left. Omkar would like all players to be acting logically. Calculate the minimum amount of players that Omkar needs to talk to so that after all players he talked to (if any) have changed which player they are attacking, all players are acting logically according to Bed Wars strategy."              
                                  1500.0 1391C "Cyclic Permutations" combinatorics,dp,graphs,math "A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).Consider a permutation p of length n, we build a graph of size n using it as follows:   For every 1\xe2\x89\xa4i\xe2\x89\xa4n, find the largest j such that 1\xe2\x89\xa4j<i and pj>pi, and add an undirected edge between node i and node j  For every 1\xe2\x89\xa4i\xe2\x89\xa4n, find the smallest j such that i<j\xe2\x89\xa4n and pj>pi, and add an undirected edge between node i and node j In cases where no such j exists, we make no edges. Also, note that we make edges between the corresponding indices, not the values at those indices.For clarity, consider as an example n=4, and p=[3,1,4,2]; here, the edges of the graph are (1,3),(2,1),(2,3),(4,3).A permutation p is cyclic if the graph built using p has at least one simple cycle. Given n, find the number of cyclic permutations of length n. Since the number may be very large, output it modulo 109+7.Please refer to the Notes section for the formal definition of a simple cycle"              
                                  800.0 1391B "Fix You" "brute force,greedy,implementation" "Consider a conveyor belt represented using a grid consisting of n rows and m columns. The cell in the i-th row from the top and the j-th column from the left is labelled (i,j). Every cell, except (n,m), has a direction R (Right) or D (Down) assigned to it. If the cell (i,j) is assigned direction R, any luggage kept on that will move to the cell (i,j+1). Similarly, if the cell (i,j) is assigned direction D, any luggage kept on that will move to the cell (i+1,j). If at any moment, the luggage moves out of the grid, it is considered to be lost. There is a counter at the cell (n,m) from where all luggage is picked. A conveyor belt is called functional if and only if any luggage reaches the counter regardless of which cell it is placed in initially. More formally, for every cell (i,j), any luggage placed in this cell should eventually end up in the cell (n,m). This may not hold initially; you are, however, allowed to change the directions of some cells to make the conveyor belt functional. Please determine the minimum amount of cells you have to change.Please note that it is always possible to make any conveyor belt functional by changing the directions of some set of cells."              
                                  800.0 1391A Suborrays "constructive algorithms,math" "A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).For a positive integer n, we call a permutation p of length n good if the following condition holds for every pair i and j (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n) \xe2\x80\x94   (pi OR pi+1 OR \xe2\x80\xa6 OR pj\xe2\x88\x921 OR pj)\xe2\x89\xa5j\xe2\x88\x92i+1, where OR denotes the bitwise OR operation. In other words, a permutation p is good if for every subarray of p, the OR of all elements in it is not less than the number of elements in that subarray. Given a positive integer n, output any good permutation of length n. We can show that for the given constraints such a permutation always exists."              
                                  2200.0 1389E "Calendar Ambiguity" "math,number theory" "Berland year consists of m months with d days each. Months are numbered from 1 to m. Berland week consists of w days. The first day of the year is also the first day of the week. Note that the last week of the year might be shorter than w days.A pair (x,y) such that x<y is ambiguous if day x of month y is the same day of the week as day y of month x.Count the number of ambiguous pairs."              
                                  1500.0 1389C "Good String" "brute force,dp,greedy,two pointers" "Let\'s call left cyclic shift of some string t1t2t3\xe2\x80\xa6tn\xe2\x88\x921tn as string t2t3\xe2\x80\xa6tn\xe2\x88\x921tnt1.Analogically, let\'s call right cyclic shift of string t as string tnt1t2t3\xe2\x80\xa6tn\xe2\x88\x921.Let\'s say string t is good if its left cyclic shift is equal to its right cyclic shift.You are given string s which consists of digits 0\xe2\x80\x939.What is the minimum number of characters you need to erase from s to make it good?"              
                                  2000.0 1388D "Captain Flint and Treasure" "data structures,dfs and similar,graphs,greedy,implementation,trees" "Captain Fint is involved in another treasure hunt, but have found only one strange problem. The problem may be connected to the treasure\'s location or may not. That\'s why captain Flint decided to leave the solving the problem to his crew and offered an absurdly high reward: one day off. The problem itself sounds like this...There are two arrays a and b of length n. Initially, an ans is equal to 0 and the following operation is defined:   Choose position i (1\xe2\x89\xa4i\xe2\x89\xa4n);  Add ai to ans;  If bi\xe2\x89\xa0\xe2\x88\x921 then add ai to abi. What is the maximum ans you can get by performing the operation on each i (1\xe2\x89\xa4i\xe2\x89\xa4n) exactly once?Uncle Bogdan is eager to get the reward, so he is asking your help to find the optimal order of positions to perform the operation on them."              
                                  2800.0 1386C Joker "*special problem,bitmasks,data structures,divide and conquer,dsu" "Joker returns to Gotham City to execute another evil plan. In Gotham City, there are N street junctions (numbered from 1 to N) and M streets (numbered from 1 to M). Each street connects two distinct junctions, and two junctions are connected by at most one street.For his evil plan, Joker needs to use an odd number of streets that together form a cycle. That is, for a junction S and an even positive integer k, there is a sequence of junctions S,s1,\xe2\x80\xa6,sk,S such that there are streets connecting (a) S and s1, (b) sk and S, and (c) si\xe2\x88\x921 and si for each i=2,\xe2\x80\xa6,k.However, the police are controlling the streets of Gotham City. On each day i, they monitor a different subset of all streets with consecutive numbers j: li\xe2\x89\xa4j\xe2\x89\xa4ri. These monitored streets cannot be a part of Joker\'s plan, of course. Unfortunately for the police, Joker has spies within the Gotham City Police Department; they tell him which streets are monitored on which day. Now Joker wants to find out, for some given number of days, whether he can execute his evil plan. On such a day there must be a cycle of streets, consisting of an odd number of streets which are not monitored on that day."              
                                  2900.0 1386B Mixture "*special problem,data structures,geometry,math,sortings" "Serge, the chef of the famous restaurant ""Salt, Pepper & Garlic"" is trying to obtain his first Michelin star. He has been informed that a secret expert plans to visit his restaurant this evening.Even though the expert\'s name hasn\'t been disclosed, Serge is certain he knows which dish from the menu will be ordered as well as what the taste preferences of the expert are. Namely, the expert requires an extremely precise proportion of salt, pepper and garlic powder in his dish.Serge keeps a set of bottles with mixtures of salt, pepper and garlic powder on a special shelf in the kitchen. For each bottle, he knows the exact amount of each of the ingredients in kilograms. Serge can combine any number of bottled mixtures (or just use one of them directly) to get a mixture of particular proportions needed for a certain dish.Luckily, the absolute amount of a mixture that needs to be added to a dish is so small that you can assume that the amounts in the bottles will always be sufficient. However, the numeric values describing the proportions may be quite large.Serge would like to know whether it is possible to obtain the expert\'s favourite mixture from the available bottles, and if so\xe2\x80\x94what is the smallest possible number of bottles needed to achieve that.Furthermore, the set of bottles on the shelf may change over time as Serge receives new ones or lends his to other chefs. So he would like to answer this question after each such change.For example, assume that expert\'s favorite mixture is 1:1:1 and there are three bottles of mixtures on the shelf: MixtureSaltPepperGarlic powder110203023002001003121527 Amount of ingredient in the bottle, kg To obtain the desired mixture it is enough to use an equivalent amount of mixtures from bottles 1 and 2. If bottle 2 is removed, then it is no longer possible to obtain it.Write a program that helps Serge to solve this task!"              
                                  2700.0 1386A Colors "*special problem,binary search,constructive algorithms,interactive" "Linda likes to change her hair color from time to time, and would be pleased if her boyfriend Archie would notice the difference between the previous and the new color. Archie always comments on Linda\'s hair color if and only if he notices a difference \xe2\x80\x94 so Linda always knows whether Archie has spotted the difference or not.There is a new hair dye series in the market where all available colors are numbered by integers from 1 to N such that a smaller difference of the numerical values also means less visual difference.Linda assumes that for these series there should be some critical color difference C (1\xe2\x89\xa4C\xe2\x89\xa4N) for which Archie will notice color difference between the current color colornew and the previous color colorprev if |colornew\xe2\x88\x92colorprev|\xe2\x89\xa5C and will not if |colornew\xe2\x88\x92colorprev|<C.Now she has bought N sets of hair dye from the new series \xe2\x80\x94 one for each of the colors from 1 to N, and is ready to set up an experiment. Linda will change her hair color on a regular basis and will observe Archie\'s reaction \xe2\x80\x94 whether he will notice the color change or not. Since for the proper dye each set should be used completely, each hair color can be obtained no more than once.Before the experiment, Linda was using a dye from a different series which is not compatible with the new one, so for the clearness of the experiment Archie\'s reaction to the first used color is meaningless.Her aim is to find the precise value of C in a limited number of dyes. Write a program which finds the value of C by experimenting with the given N colors and observing Archie\'s reactions to color changes."              
                                  2800.0 1383E "Strange Operation" "combinatorics,data structures,dp" "Koa the Koala has a binary string s of length n. Koa can perform no more than n\xe2\x88\x921 (possibly zero) operations of the following form:In one operation Koa selects positions i and i+1 for some i with 1\xe2\x89\xa4i<|s| and sets si to max(si,si+1). Then Koa deletes position i+1 from s (after the removal, the remaining parts are concatenated).Note that after every operation the length of s decreases by 1.How many different binary strings can Koa obtain by doing no more than n\xe2\x88\x921 (possibly zero) operations modulo 109+7 (1000000007)?"              
                                  1100.0 1382B "Sequential Nim" dp,games "There are n piles of stones, where the i-th pile has ai stones. Two people play a game, where they take alternating turns removing stones.In a move, a player may remove a positive number of stones from the first non-empty pile (the pile with the minimal index, that has at least one stone). The first player who cannot make a move (because all piles are empty) loses the game. If both players play optimally, determine the winner of the game."              
                                  1700.0 1381A2 "Prefix Flip (Hard Version)" "constructive algorithms,data structures,implementation,strings,two pointers" "This is the hard version of the problem. The difference between the versions is the constraint on n and the required number of operations. You can make hacks only if all versions of the problem are solved.There are two binary strings a and b of length n (a binary string is a string consisting of symbols 0 and 1). In an operation, you select a prefix of a, and simultaneously invert the bits in the prefix (0 changes to 1 and 1 changes to 0) and reverse the order of the bits in the prefix.For example, if a=001011 and you select the prefix of length 3, it becomes 011011. Then if you select the entire string, it becomes 001001.Your task is to transform the string a into b in at most 2n operations. It can be proved that it is always possible."              
                                  1400.0 1380B "Universal Solution" greedy "Recently, you found a bot to play ""Rock paper scissors"" with. Unfortunately, the bot uses quite a simple algorithm to play: he has a string s=s1s2\xe2\x80\xa6sn of length n where each letter is either R, S or P.While initializing, the bot is choosing a starting index pos (1\xe2\x89\xa4pos\xe2\x89\xa4n), and then it can play any number of rounds. In the first round, he chooses ""Rock"", ""Scissors"" or ""Paper"" based on the value of spos:   if spos is equal to R the bot chooses ""Rock"";  if spos is equal to S the bot chooses ""Scissors"";  if spos is equal to P the bot chooses ""Paper""; In the second round, the bot\'s choice is based on the value of spos+1. In the third round \xe2\x80\x94 on spos+2 and so on. After sn the bot returns to s1 and continues his game.You plan to play n rounds and you\'ve already figured out the string s but still don\'t know what is the starting index pos. But since the bot\'s tactic is so boring, you\'ve decided to find n choices to each round to maximize the average number of wins.In other words, let\'s suggest your choices are c1c2\xe2\x80\xa6cn and if the bot starts from index pos then you\'ll win in win(pos) rounds. Find c1c2\xe2\x80\xa6cn such that win(1)+win(2)+\xe2\x8b\xaf+win(n)n is maximum possible."              
                                  3500.0 1375I "Cubic Lattice" "geometry,math,matrices,number theory" "A cubic lattice L in 3-dimensional euclidean space is a set of points defined in the following way: L={u\xe2\x8b\x85\xe2\x86\x92r1+v\xe2\x8b\x85\xe2\x86\x92r2+w\xe2\x8b\x85\xe2\x86\x92r3}u,v,w\xe2\x88\x88Z Where \xe2\x86\x92r1,\xe2\x86\x92r2,\xe2\x86\x92r3\xe2\x88\x88Z3 are some integer vectors such that:   \xe2\x86\x92r1, \xe2\x86\x92r2 and \xe2\x86\x92r3 are pairwise orthogonal: \xe2\x86\x92r1\xe2\x8b\x85\xe2\x86\x92r2=\xe2\x86\x92r1\xe2\x8b\x85\xe2\x86\x92r3=\xe2\x86\x92r2\xe2\x8b\x85\xe2\x86\x92r3=0 Where \xe2\x86\x92a\xe2\x8b\x85\xe2\x86\x92b is a dot product of vectors \xe2\x86\x92a and \xe2\x86\x92b.  \xe2\x86\x92r1, \xe2\x86\x92r2 and \xe2\x86\x92r3 all have the same length: |\xe2\x86\x92r1|=|\xe2\x86\x92r2|=|\xe2\x86\x92r3|=r  You\'re given a set A={\xe2\x86\x92a1,\xe2\x86\x92a2,\xe2\x80\xa6,\xe2\x86\x92an} of integer points, i-th point has coordinates ai=(xi;yi;zi). Let gi=gcd(xi,yi,zi). It is guaranteed that gcd(g1,g2,\xe2\x80\xa6,gn)=1.You have to find a cubic lattice L such that A\xe2\x8a\x82L and r is the maximum possible."              
                                  3300.0 1375H "Set Merging" "constructive algorithms,divide and conquer" "You are given a permutation a1,a2,\xe2\x80\xa6,an of numbers from 1 to n. Also, you have n sets S1,S2,\xe2\x80\xa6,Sn, where Si={ai}. Lastly, you have a variable cnt, representing the current number of sets. Initially, cnt=n.We define two kinds of functions on sets:f(S)=minu\xe2\x88\x88Su;g(S)=maxu\xe2\x88\x88Su.You can obtain a new set by merging two sets A and B, if they satisfy g(A)<f(B) (Notice that the old sets do not disappear).Formally, you can perform the following sequence of operations:cnt\xe2\x86\x90cnt+1;Scnt=Su\xe2\x88\xaaSv, you are free to choose u and v for which 1\xe2\x89\xa4u,v<cnt and which satisfy g(Su)<f(Sv).You are required to obtain some specific sets.There are q requirements, each of which contains two integers li,ri, which means that there must exist a set Ski (ki is the ID of the set, you should determine it) which equals {au\xe2\x88\xa3li\xe2\x89\xa4u\xe2\x89\xa4ri}, which is, the set consisting of all ai with indices between li and ri.In the end you must ensure that cnt\xe2\x89\xa42.2\xc3\x97106. Note that you don\'t have to minimize cnt. It is guaranteed that a solution under given constraints exists."              
                                  1600.0 1374E1 "Reading Books (easy version)" "data structures,greedy,sortings" "Easy and hard versions are actually different problems, so read statements of both problems completely and carefully.Summer vacation has started so Alice and Bob want to play and joy, but... Their mom doesn\'t think so. She says that they have to read some amount of books before all entertainments. Alice and Bob will read each book together to end this exercise faster.There are n books in the family library. The i-th book is described by three integers: ti \xe2\x80\x94 the amount of time Alice and Bob need to spend to read it, ai (equals 1 if Alice likes the i-th book and 0 if not), and bi (equals 1 if Bob likes the i-th book and 0 if not).So they need to choose some books from the given n books in such a way that:  Alice likes at least k books from the chosen set and Bob likes at least k books from the chosen set;  the total reading time of these books is minimized (they are children and want to play and joy as soon a possible). The set they choose is the same for both Alice an Bob (it\'s shared between them) and they read all books together, so the total reading time is the sum of ti over all books that are in the chosen set.Your task is to help them and find any suitable set of books or determine that it is impossible to find such a set."              
                                  2700.0 1372F "Omkar and Modes" "binary search,divide and conquer,interactive" "Ray lost his array and needs to find it by asking Omkar. Omkar is willing to disclose that the array has the following qualities:  The array has n (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105) elements.  Every element in the array ai is an integer in the range 1\xe2\x89\xa4ai\xe2\x89\xa4109.  The array is sorted in nondecreasing order. Ray is allowed to send Omkar a series of queries. A query consists of two integers, l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. Omkar will respond with two integers, x and f. x is the mode of the subarray from index l to index r inclusive. The mode of an array is defined by the number that appears the most frequently. If there are multiple numbers that appear the most number of times, the smallest such number is considered to be the mode. f is the amount of times that x appears in the queried subarray.The array has k (1\xe2\x89\xa4k\xe2\x89\xa4min(25000,n)) distinct elements. However, due to Ray\'s sins, Omkar will not tell Ray what k is. Ray is allowed to send at most 4k queries.Help Ray find his lost array."              
                                  1500.0 1372C "Omkar and Baseball" "constructive algorithms,math" "Patrick likes to play baseball, but sometimes he will spend so many hours hitting home runs that his mind starts to get foggy! Patrick is sure that his scores across n sessions follow the identity permutation (ie. in the first game he scores 1 point, in the second game he scores 2 points and so on). However, when he checks back to his record, he sees that all the numbers are mixed up! Define a special exchange as the following: choose any subarray of the scores and permute elements such that no element of subarray gets to the same position as it was before the exchange. For example, performing a special exchange on [1,2,3] can yield [3,1,2] but it cannot yield [3,2,1] since the 2 is in the same position. Given a permutation of n integers, please help Patrick find the minimum number of special exchanges needed to make the permutation sorted! It can be proved that under given constraints this number doesn\'t exceed 1018.An array a is a subarray of an array b if a can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end."              
                                  1300.0 1372B "Omkar and Last Class of Math" "greedy,math,number theory" "In Omkar\'s last class of math, he learned about the least common multiple, or LCM. LCM(a,b) is the smallest positive integer x which is divisible by both a and b.Omkar, having a laudably curious mind, immediately thought of a problem involving the LCM operation: given an integer n, find positive integers a and b such that a+b=n and LCM(a,b) is the minimum value possible.Can you help Omkar solve his ludicrously challenging math problem?"              
                                  2300.0 1371E2 "Asterism (Hard Version)" "binary search,combinatorics,dp,math,number theory,sortings" "This is the hard version of the problem. The difference between versions is the constraints on n and ai. You can make hacks only if all versions of the problem are solved.First, Aoi came up with the following idea for the competitive programming problem:Yuzu is a girl who collecting candies. Originally, she has x candies. There are also n enemies numbered with integers from 1 to n. Enemy i has ai candies.Yuzu is going to determine a permutation P. A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, {2,3,1,5,4} is a permutation, but {1,2,2} is not a permutation (2 appears twice in the array) and {1,3,4} is also not a permutation (because n=3 but there is the number 4 in the array).After that, she will do n duels with the enemies with the following rules:  If Yuzu has equal or more number of candies than enemy Pi, she wins the duel and gets 1 candy. Otherwise, she loses the duel and gets nothing.  The candy which Yuzu gets will be used in the next duels. Yuzu wants to win all duels. How many valid permutations P exist?This problem was easy and wasn\'t interesting for Akari, who is a friend of Aoi. And Akari made the following problem from the above idea:Let\'s define f(x) as the number of valid permutations for the integer x.You are given n, a and a prime number p\xe2\x89\xa4n. Let\'s call a positive integer x good, if the value f(x) is not divisible by p. Find all good integers x.Your task is to solve this problem made by Akari."              
                                  2400.0 1370F1 "The Hidden Pair (Easy Version)" "binary search,dfs and similar,graphs,interactive,shortest paths,trees" "Note that the only difference between the easy and hard version is the constraint on the number of queries. You can make hacks only if all versions of the problem are solved.This is an interactive problem.You are given a tree consisting of n nodes numbered with integers from 1 to n. Ayush and Ashish chose two secret distinct nodes in the tree. You need to find out both the nodes. You can make the following query:   Provide a list of nodes and you will receive a node from that list whose sum of distances to both the hidden nodes is minimal (if there are multiple such nodes in the list, you will receive any one of them). You will also get the sum of distances of that node to the hidden nodes. Recall that a tree is a connected graph without cycles. The distance between two nodes is defined as the number of edges in the simple path between them.More formally, let\'s define two hidden nodes as s and f. In one query you can provide the set of nodes {a1,a2,\xe2\x80\xa6,ac} of the tree. As a result, you will get two numbers ai and dist(ai,s)+dist(ai,f). The node ai is any node from the provided set, for which the number dist(ai,s)+dist(ai,f) is minimal.You can ask no more than 14 queries."              
                                  2100.0 1370E "Binary Subsequence Rotation" "binary search,constructive algorithms,data structures,greedy" "Naman has two binary strings s and t of length n (a binary string is a string which only consists of the characters ""0"" and ""1""). He wants to convert s into t using the following operation as few times as possible.In one operation, he can choose any subsequence of s and rotate it clockwise once.For example, if s=1110100, he can choose a subsequence corresponding to indices (1-based) {2,6,7} and rotate them clockwise. The resulting string would then be s=1010110.A string a is said to be a subsequence of string b if a can be obtained from b by deleting some characters without changing the ordering of the remaining characters.To perform a clockwise rotation on a sequence c of size k is to perform an operation which sets c1:=ck,c2:=c1,c3:=c2,\xe2\x80\xa6,ck:=ck\xe2\x88\x921 simultaneously.Determine the minimum number of operations Naman has to perform to convert s into t or say that it is impossible."              
                                  1400.0 1370C "Number Game" "games,math,number theory" "Ashishgup and FastestFinger play a game. They start with a number n and play in turns. In each turn, a player can make any one of the following moves:  Divide n by any of its odd divisors greater than 1.  Subtract 1 from n if n is greater than 1. Divisors of a number include the number itself.The player who is unable to make a move loses the game.Ashishgup moves first. Determine the winner of the game if both of them play optimally."              
                                  2700.0 1369F BareLee "dfs and similar,dp,games" "Lee is used to finish his stories in a stylish way, this time he barely failed it, but Ice Bear came and helped him. Lee is so grateful for it, so he decided to show Ice Bear his new game called ""Critic""...The game is a one versus one game. It has t rounds, each round has two integers si and ei (which are determined and are known before the game begins, si and ei may differ from round to round). The integer si is written on the board at the beginning of the corresponding round. The players will take turns. Each player will erase the number on the board (let\'s say it was a) and will choose to write either 2\xe2\x8b\x85a or a+1 instead. Whoever writes a number strictly greater than ei loses that round and the other one wins that round.Now Lee wants to play ""Critic"" against Ice Bear, for each round he has chosen the round\'s si and ei in advance. Lee will start the first round, the loser of each round will start the next round.The winner of the last round is the winner of the game, and the loser of the last round is the loser of the game.Determine if Lee can be the winner independent of Ice Bear\'s moves or not. Also, determine if Lee can be the loser independent of Ice Bear\'s moves or not."              
                                  2400.0 1369E DeadLee "data structures,dfs and similar,greedy,implementation,sortings" "Lee bought some food for dinner time, but Lee\'s friends eat dinner in a deadly way. Lee is so scared, he doesn\'t want to die, at least not before seeing Online IOI 2020...There are n different types of food and m Lee\'s best friends. Lee has wi plates of the i-th type of food and each friend has two different favorite types of food: the i-th friend\'s favorite types of food are xi and yi (xi\xe2\x89\xa0yi).Lee will start calling his friends one by one. Whoever is called will go to the kitchen and will try to eat one plate of each of his favorite food types. Each of the friends will go to the kitchen exactly once.The only problem is the following: if a friend will eat at least one plate of food (in total) then he will be harmless. But if there is nothing left for him to eat (neither xi nor yi), he will eat Lee instead \xc3\x97_\xc3\x97.Lee can choose the order of friends to call, so he\'d like to determine if he can survive dinner or not. Also, he\'d like to know the order itself."              
                                  1900.0 1369D TediousLee dp,graphs,greedy,math,trees "Lee tried so hard to make a good div.2 D problem to balance his recent contest, but it still doesn\'t feel good at all. Lee invented it so tediously slow that he managed to develop a phobia about div.2 D problem setting instead. And now he is hiding behind the bushes...Let\'s define a Rooted Dead Bush (RDB) of level n as a rooted tree constructed as described below.A rooted dead bush of level 1 is a single vertex. To construct an RDB of level i we, at first, construct an RDB of level i\xe2\x88\x921, then for each vertex u:   if u has no children then we will add a single child to it;  if u has one child then we will add two children to it;  if u has more than one child, then we will skip it.   Rooted Dead Bushes of level 1, 2 and 3. Let\'s define a claw as a rooted tree with four vertices: one root vertex (called also as center) with three children. It looks like a claw:  The center of the claw is the vertex with label 1. Lee has a Rooted Dead Bush of level n. Initially, all vertices of his RDB are green.In one move, he can choose a claw in his RDB, if all vertices in the claw are green and all vertices of the claw are children of its center, then he colors the claw\'s vertices in yellow.He\'d like to know the maximum number of yellow vertices he can achieve. Since the answer might be very large, print it modulo 109+7."              
                                  3300.0 1368H1 "Breadboard Capacity (easy version)" dp,flows,greedy "This is an easier version of the problem H without modification queries.Lester and Delbert work at an electronics company. They are currently working on a microchip component serving to connect two independent parts of a large supercomputer.The component is built on top of a breadboard \xe2\x80\x94 a grid-like base for a microchip. The breadboard has n rows and m columns, and each row-column intersection contains a node. Also, on each side of the breadboard there are ports that can be attached to adjacent nodes. Left and right side have n ports each, and top and bottom side have m ports each. Each of the ports is connected on the outside to one of the parts bridged by the breadboard, and is colored red or blue respectively.  Ports can be connected by wires going inside the breadboard. However, there are a few rules to follow: Each wire should connect a red port with a blue port, and each port should be connected to at most one wire. Each part of the wire should be horizontal or vertical, and turns are only possible at one of the nodes. To avoid interference, wires can not have common parts of non-zero length (but may have common nodes). Also, a wire can not cover the same segment of non-zero length twice.The capacity of the breadboard is the largest number of red-blue wire connections that can be made subject to the rules above. For example, the breadboard above has capacity 7, and one way to make seven connections is pictured below.  Up to this point statements of both versions are identical. Differences follow below.Given the current breadboard configuration, help Lester and Delbert find its capacity efficiently."              
                                  3200.0 1368G "Shifting Dominoes" "data structures,geometry,graphs,trees" "Bill likes to play with dominoes. He took an n\xc3\x97m board divided into equal square cells, and covered it with dominoes. Each domino covers two adjacent cells of the board either horizontally or vertically, and each cell is covered exactly once with a half of one domino (that is, there are no uncovered cells, and no two dominoes cover the same cell twice).After that Bill decided to play with the covered board and share some photos of it on social media. First, he removes exactly one domino from the board, freeing two of the cells. Next, he moves dominoes around. A domino can only be moved along the line parallel to its longer side. A move in the chosen direction is possible if the next cell in this direction is currently free. Bill doesn\'t want to lose track of what the original tiling looks like, so he makes sure that at any point each domino shares at least one cell with its original position.After removing a domino and making several (possibly, zero) moves Bill takes a photo of the board and posts it. However, with the amount of filters Bill is using, domino borders are not visible, so only the two free cells of the board can be identified. When the photo is posted, Bill reverts the board to its original state and starts the process again.Bill wants to post as many photos as possible, but he will not post any photo twice. How many distinct photos can he take? Recall that photos are different if the pairs of free cells in the photos are different."              
                                  2100.0 1365F "Swaps Again" "constructive algorithms,implementation,sortings" "Ayush, Ashish and Vivek are busy preparing a new problem for the next Codeforces round and need help checking if their test cases are valid.Each test case consists of an integer n and two arrays a and b, of size n. If after some (possibly zero) operations described below, array a can be transformed into array b, the input is said to be valid. Otherwise, it is invalid.An operation on array a is:   select an integer k (1\xe2\x89\xa4k\xe2\x89\xa4\xe2\x8c\x8an2\xe2\x8c\x8b)  swap the prefix of length k with the suffix of length k For example, if array a initially is {1,2,3,4,5,6}, after performing an operation with k=2, it is transformed into {5,6,3,4,1,2}.Given the set of test cases, help them determine if each one is valid or invalid."              
                                  1700.0 1365D "Solve The Maze" "constructive algorithms,dfs and similar,dsu,graphs,greedy,implementation,shortest paths" "Vivek has encountered a problem. He has a maze that can be represented as an n\xc3\x97m grid. Each of the grid cells may represent the following:  Empty \xe2\x80\x94 \'.\'  Wall \xe2\x80\x94 \'#\'  Good person  \xe2\x80\x94 \'G\'  Bad person \xe2\x80\x94 \'B\' The only escape from the maze is at cell (n,m).A person can move to a cell only if it shares a side with their current cell and does not contain a wall. Vivek wants to block some of the empty cells by replacing them with walls in such a way, that all the good people are able to escape, while none of the bad people are able to. A cell that initially contains \'G\' or \'B\' cannot be blocked and can be travelled through.Help him determine if there exists a way to replace some (zero or more) empty cells with walls to satisfy the above conditions.It is guaranteed that the cell (n,m) is empty. Vivek can also block this cell."              
                                  2100.0 1364D "Ehab\'s Last Corollary" "constructive algorithms,dfs and similar,graphs,greedy,implementation,trees" "Given a connected undirected graph with n vertices and an integer k, you have to either:  either find an independent set that has exactly \xe2\x8c\x88k2\xe2\x8c\x89 vertices. or find a simple cycle of length at most k. An independent set is a set of vertices such that no two of them are connected by an edge. A simple cycle is a cycle that doesn\'t contain any vertex twice. I have a proof that for any input you can always solve at least one of these problems, but it\'s left as an exercise for the reader."              
                                  1000.0 1362A "Johnny and Ancient Computer" implementation "Johnny has recently found an ancient, broken computer. The machine has only one register, which allows one to put in there one variable. Then in one operation, you can shift its bits left or right by at most three positions. The right shift is forbidden if it cuts off some ones. So, in fact, in one operation, you can multiply or divide your number by 2, 4 or 8, and division is only allowed if the number is divisible by the chosen divisor. Formally, if the register contains a positive integer x, in one operation it can be replaced by one of the following:   x\xe2\x8b\x852  x\xe2\x8b\x854  x\xe2\x8b\x858  x/2, if x is divisible by 2  x/4, if x is divisible by 4  x/8, if x is divisible by 8 For example, if x=6, in one operation it can be replaced by 12, 24, 48 or 3. Value 6 isn\'t divisible by 4 or 8, so there\'re only four variants of replacement.Now Johnny wonders how many operations he needs to perform if he puts a in the register and wants to get b at the end."              
                                  -999.0 1357D5 "Quantum Classification - Dataset 7"  "This problem is identical to the problem D1 in every aspect except the training dataset. Please refer to that problem for the full problem statement."              
                                  -999.0 1357B2 """Is the number divisible by 3?"" oracle"  "Implement a quantum oracle on N qubits which checks whether the input bit string is a little-endian notation of a number that is divisible by 3. Your operation should take the following inputs:  an array of N\xe2\x89\xa48 qubits ""inputs"" in an arbitrary state.  a qubit ""output"" in an arbitrary state. Your operation should perform a unitary transformation on those qubits that can be described by its effect on the basis states: if ""inputs"" is in the basis state |x\xe2\x9f\xa9 and ""output"" is in the basis state |y\xe2\x9f\xa9, the result of applying the operation should be |x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9, where f(x)=1 if the integer represented by the bit string x is divisible by 3, and 0 otherwise.For example, if the qubits passed to your operation are in the state 1\xe2\x88\x9a2(|110\xe2\x9f\xa9+|001\xe2\x9f\xa9)x\xe2\x8a\x97|0\xe2\x9f\xa9y=1\xe2\x88\x9a2(|3\xe2\x9f\xa9+|4\xe2\x9f\xa9)x\xe2\x8a\x97|0\xe2\x9f\xa9y, the state of the system after applying the operation should be 1\xe2\x88\x9a2(|3\xe2\x9f\xa9x\xe2\x8a\x97|1\xe2\x9f\xa9y+|4\xe2\x9f\xa9x|0\xe2\x9f\xa9y)=1\xe2\x88\x9a2(|110\xe2\x9f\xa9x\xe2\x8a\x97|1\xe2\x9f\xa9y+|001\xe2\x9f\xa9x|0\xe2\x9f\xa9y).Your code should have the following signature (note that your operation should have Adjoint and Controlled variants defined for it; is Adj+Ctl in the operation signature will generate them automatically based on your code):namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (inputs : Qubit[], output : Qubit) : Unit is Adj+Ctl {        // your code here    }}Your code is not allowed to use measurements or arbitrary rotation gates. This operation can be implemented using just the X gate and its controlled variants (possibly with multiple qubits as controls)."              
                                  -999.0 1357A1 "Figure out direction of CNOT"  "You are given an operation that implements a two-qubit unitary transformation: either the CNOT gate with the first qubit as control and the second qubit as target (CNOT12), or the CNOT gate with the second qubit as control and the first qubit as target (CNOT21). The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the CNOT12 gate or 1 if it was the CNOT21 gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly once.You have to implement an operation which takes a two-qubit operation unitary as an input and returns an integer. The operation unitary will accept an array of qubits as input, but it will fail if the array is empty or has one or more than two qubits. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit[] => Unit is Adj+Ctl)) : Int {        // your code here    }}"              
                                  -999.0 1356A2 "Distinguish I from Z" "*special problem" "You are given an operation that implements a single-qubit unitary transformation: either the identity (I gate) or the Z gate. The operation will have Adjoint and Controlled variants defined.Your task is to perform necessary operations and measurements to figure out which unitary it was and to return 0 if it was the I gate or 1 if it was the Z gate. You are allowed to apply the given operation and its adjoint/controlled variants exactly once.You have to implement an operation which takes a single-qubit operation as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (unitary : (Qubit => Unit is Adj+Ctl)) : Int {        // your code here    }}"              
                                  1800.0 1355C "Count Triangles" "binary search,implementation,math,two pointers" "Like any unknown mathematician, Yuri has favourite numbers: A, B, C, and D, where A\xe2\x89\xa4B\xe2\x89\xa4C\xe2\x89\xa4D. Yuri also likes triangles and once he thought: how many non-degenerate triangles with integer sides x, y, and z exist, such that A\xe2\x89\xa4x\xe2\x89\xa4B\xe2\x89\xa4y\xe2\x89\xa4C\xe2\x89\xa4z\xe2\x89\xa4D holds?Yuri is preparing problems for a new contest now, so he is very busy. That\'s why he asked you to calculate the number of triangles with described property.The triangle is called non-degenerate if and only if its vertices are not collinear."              
                                  2500.0 1354F "Summoning Minions" "constructive algorithms,dp,flows,graph matchings,greedy,sortings" "Polycarp plays a computer game. In this game, the players summon armies of magical minions, which then fight each other.Polycarp can summon n different minions. The initial power level of the i-th minion is ai, and when it is summoned, all previously summoned minions\' power levels are increased by bi. The minions can be summoned in any order.Unfortunately, Polycarp cannot have more than k minions under his control. To get rid of unwanted minions after summoning them, he may destroy them. Each minion can be summoned (and destroyed) only once.Polycarp\'s goal is to summon the strongest possible army. Formally, he wants to maximize the sum of power levels of all minions under his control (those which are summoned and not destroyed).Help Polycarp to make up a plan of actions to summon the strongest possible army!"              
                                  2200.0 1353F "Decreasing Heights" "brute force,dp" "You are playing one famous sandbox game with the three-dimensional world. The map of the world can be represented as a matrix of size n\xc3\x97m, where the height of the cell (i,j) is ai,j.You are in the cell (1,1) right now and want to get in the cell (n,m). You can move only down (from the cell (i,j) to the cell (i+1,j)) or right (from the cell (i,j) to the cell (i,j+1)). There is an additional restriction: if the height of the current cell is x then you can move only to the cell with height x+1.Before the first move you can perform several operations. During one operation, you can decrease the height of any cell by one. I.e. you choose some cell (i,j) and assign (set) ai,j:=ai,j\xe2\x88\x921. Note that you can make heights less than or equal to zero. Also note that you can decrease the height of the cell (1,1).Your task is to find the minimum number of operations you have to perform to obtain at least one suitable path from the cell (1,1) to the cell (n,m). It is guaranteed that the answer exists.You have to answer t independent test cases."              
                                  2000.0 1349B "Orac and Medians" "constructive algorithms,greedy,math" "Slime has a sequence of positive integers a1,a2,\xe2\x80\xa6,an.In one operation Orac can choose an arbitrary subsegment [l\xe2\x80\xa6r] of this sequence and replace all values al,al+1,\xe2\x80\xa6,ar to the value of median of {al,al+1,\xe2\x80\xa6,ar}.In this problem, for the integer multiset s, the median of s is equal to the \xe2\x8c\x8a|s|+12\xe2\x8c\x8b-th smallest number in it. For example, the median of {1,4,4,6,5} is 4, and the median of {1,7,5,8} is 5.Slime wants Orac to make a1=a2=\xe2\x80\xa6=an=k using these operations.Orac thinks that it is impossible, and he does not want to waste his time, so he decided to ask you if it is possible to satisfy the Slime\'s requirement, he may ask you these questions several times."              
                                  1600.0 1346C "Spring Cleaning" "*special problem,greedy,sortings" "Tanya wants to organize her bookcase. There are n bookshelves in the bookcase, the i-th bookshelf contains ai books on it. Tanya will be satisfied if each bookshelf contains no more than k books.Tanya can do one of the two following operations to achieve her goal:   Choose exactly one bookshelf and put all the books from it in the storage room (i.\xe2\x80\x89e. choose some i and assign ai:=0). During this operation she spends x seconds.  Take all books from all n bookshelves and distribute them between all n bookshelves evenly (the definition of the term is given below). During this operation she spends y seconds. Consider the sequence a of n integers. Then its even distribution is such a sequence b of n integers that the sum of b equals the sum of a and the value max(b)\xe2\x88\x92min(b) is the minimum possible.For example, if the array a=[5,4,3] then its even distribution is b=[4,4,4]. If a=[1,2,3,4] then its even distribution is b=[2,3,3,2] (or any permutation of this array).Your task is to find the minimum number of seconds Tanya has to spend to obtain the bookcase with no more than k books on each bookshelf."              
                                  2600.0 1344C "Quantifier Question" "dfs and similar,dp,graphs,math" "Logical quantifiers are very useful tools for expressing claims about a set. For this problem, let\'s focus on the set of real numbers specifically. The set of real numbers includes zero and negatives. There are two kinds of quantifiers: universal (\xe2\x88\x80) and existential (\xe2\x88\x83). You can read more about them here.The universal quantifier is used to make a claim that a statement holds for all real numbers. For example:  \xe2\x88\x80x,x<100 is read as: for all real numbers x, x is less than 100. This statement is false.  \xe2\x88\x80x,x>x\xe2\x88\x921 is read as: for all real numbers x, x is greater than x\xe2\x88\x921. This statement is true. The existential quantifier is used to make a claim that there exists some real number for which the statement holds. For example:  \xe2\x88\x83x,x<100 is read as: there exists a real number x such that x is less than 100. This statement is true.  \xe2\x88\x83x,x>x\xe2\x88\x921 is read as: there exists a real number x such that x is greater than x\xe2\x88\x921. This statement is true. Moreover, these quantifiers can be nested. For example:  \xe2\x88\x80x,\xe2\x88\x83y,x<y is read as: for all real numbers x, there exists a real number y such that x is less than y. This statement is true since for every x, there exists y=x+1.  \xe2\x88\x83y,\xe2\x88\x80x,x<y is read as: there exists a real number y such that for all real numbers x, x is less than y. This statement is false because it claims that there is a maximum real number: a number y larger than every x. Note that the order of variables and quantifiers is important for the meaning and veracity of a statement.There are n variables x1,x2,\xe2\x80\xa6,xn, and you are given some formula of the form f(x1,\xe2\x80\xa6,xn):=(xj1<xk1)\xe2\x88\xa7(xj2<xk2)\xe2\x88\xa7\xe2\x8b\xaf\xe2\x88\xa7(xjm<xkm),where \xe2\x88\xa7 denotes logical AND. That is, f(x1,\xe2\x80\xa6,xn) is true if every inequality xji<xki holds. Otherwise, if at least one inequality does not hold, then f(x1,\xe2\x80\xa6,xn) is false.Your task is to assign quantifiers Q1,\xe2\x80\xa6,Qn to either universal (\xe2\x88\x80) or existential (\xe2\x88\x83) so that the statement Q1x1,Q2x2,\xe2\x80\xa6,Qnxn,f(x1,\xe2\x80\xa6,xn)is true, and the number of universal quantifiers is maximized, or determine that the statement is false for every possible assignment of quantifiers.Note that the order the variables appear in the statement is fixed. For example, if f(x1,x2):=(x1<x2) then you are not allowed to make x2 appear first and use the statement \xe2\x88\x80x2,\xe2\x88\x83x1,x1<x2. If you assign Q1=\xe2\x88\x83 and Q2=\xe2\x88\x80, it will only be interpreted as \xe2\x88\x83x1,\xe2\x88\x80x2,x1<x2."              
                                  1200.0 1339B "Sorted Adjacent Differences" "constructive algorithms,sortings" "You have array of n numbers a1,a2,\xe2\x80\xa6,an. Rearrange these numbers to satisfy |a1\xe2\x88\x92a2|\xe2\x89\xa4|a2\xe2\x88\x92a3|\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4|an\xe2\x88\x921\xe2\x88\x92an|, where |x| denotes absolute value of x. It\'s always possible to find such rearrangement.Note that all numbers in a are not necessarily different. In other words, some numbers of a may be same.You have to answer independent t test cases."              
                                  900.0 1339A "Filling Diamonds" "brute force,dp,implementation,math" "You have integer n. Calculate how many ways are there to fully cover belt-like area of 4n\xe2\x88\x922 triangles with diamond shapes. Diamond shape consists of two triangles. You can move, rotate or flip the shape, but you cannot scale it. 2 coverings are different if some 2 triangles are covered by the same diamond shape in one of them and by different diamond shapes in the other one.Please look at pictures below for better understanding.  On the left you can see the diamond shape you will use, and on the right you can see the area you want to fill. These are the figures of the area you want to fill for n=1,2,3,4. You have to answer t independent test cases."              
                                  2700.0 1338D "Nested Rubber Bands" "constructive algorithms,dfs and similar,dp,math,trees" "You have a tree of n vertices. You are going to convert this tree into n rubber bands on infinitely large plane. Conversion rule follows:  For every pair of vertices a and b, rubber bands a and b should intersect if and only if there is an edge exists between a and b in the tree.  Shape of rubber bands must be a simple loop. In other words, rubber band is a loop which doesn\'t self-intersect. Now let\'s define following things:   Rubber band a includes rubber band b, if and only if rubber band b is in rubber band a\'s area, and they don\'t intersect each other.  Sequence of rubber bands a1,a2,\xe2\x80\xa6,ak (k\xe2\x89\xa52) are nested, if and only if for all i (2\xe2\x89\xa4i\xe2\x89\xa4k), ai\xe2\x88\x921 includes ai.   This is an example of conversion. Note that rubber bands 5 and 6 are nested. It can be proved that is it possible to make a conversion and sequence of nested rubber bands under given constraints.What is the maximum length of sequence of nested rubber bands can be obtained from given tree? Find and print it."              
                                  3500.0 1336F Journey "data structures,divide and conquer,graphs,trees" "In the wilds far beyond lies the Land of Sacredness, which can be viewed as a tree  \xe2\x80\x94 connected undirected graph consisting of n nodes and n\xe2\x88\x921 edges. The nodes are numbered from 1 to n. There are m travelers attracted by its prosperity and beauty. Thereupon, they set off their journey on this land. The i-th traveler will travel along the shortest path from si to ti. In doing so, they will go through all edges in the shortest path from si to ti, which is unique in the tree.During their journey, the travelers will acquaint themselves with the others. Some may even become friends. To be specific, the i-th traveler and the j-th traveler will become friends if and only if there are at least k edges that both the i-th traveler and the j-th traveler will go through. Your task is to find out the number of pairs of travelers (i,j) satisfying the following conditions:   1\xe2\x89\xa4i<j\xe2\x89\xa4m.  the i-th traveler and the j-th traveler will become friends."              
                                  1700.0 1336B "Xenia and Colorful Gems" "binary search,greedy,math,sortings,two pointers" "Xenia is a girl being born a noble. Due to the inflexibility and harshness of her family, Xenia has to find some ways to amuse herself. Recently Xenia has bought nr red gems, ng green gems and nb blue gems. Each of the gems has a weight.Now, she is going to pick three gems.Xenia loves colorful things, so she will pick exactly one gem of each color.Xenia loves balance, so she will try to pick gems with little difference in weight.Specifically, supposing the weights of the picked gems are x, y and z, Xenia wants to find the minimum value of (x\xe2\x88\x92y)2+(y\xe2\x88\x92z)2+(z\xe2\x88\x92x)2. As her dear friend, can you help her?"              
                                  2200.0 1333F "Kate and imperfection" "greedy,implementation,math,number theory,sortings,two pointers" "Kate has a set S of n integers {1,\xe2\x80\xa6,n}. She thinks that imperfection of a subset M\xe2\x8a\x86S is equal to the maximum of gcd(a,b) over all pairs (a,b) such that both a and b are in M and a\xe2\x89\xa0b. Kate is a very neat girl and for each k\xe2\x88\x88{2,\xe2\x80\xa6,n} she wants to find a subset that has the smallest imperfection among all subsets in S of size k. There can be more than one subset with the smallest imperfection and the same size, but you don\'t need to worry about it. Kate wants to find all the subsets herself, but she needs your help to find the smallest possible imperfection for each size k, will name it Ik. Please, help Kate to find I2, I3, ..., In."              
              2500.0                         1137C "Museums Tour" dp,graphs,implementation "In the country N, there are n cities connected by m one-way roads. Although this country seems unremarkable, there are two interesting facts about it. At first, a week lasts d days here. At second, there is exactly one museum in each city of the country N.Travel agency ""Open museums"" is developing a new program for tourists interested in museums. Agency\'s employees know which days each of the museums is open. The tour should start in the capital \xe2\x80\x94 the city number 1, and the first day of the tour must be on the first day of a week. Each day a tourist will be in some city, watching the exposition in its museum (in case museum is open today), and by the end of the day, the tour either ends or the tourist goes into another city connected by a road with the current one. The road system of N is designed in such a way that traveling by a road always takes one night and also all the roads are one-way. It\'s allowed to visit a city multiple times during the trip.You should develop such route for the trip that the number of distinct museums, possible to visit during it, is maximum."          
              2700.0                         1131G "Most Dangerous Shark" "data structures,dp,two pointers" "Semyon participates in the most prestigious competition of the world ocean for the title of the most dangerous shark. During this competition sharks compete in different subjects: speed swimming, masking, map navigation and many others. Now Semyon is taking part in \xc2\xabdestruction\xc2\xbb contest.During it, m dominoes are placed in front of the shark. All dominoes are on the same line, but the height of the dominoes may vary. The distance between adjacent dominoes is 1. Moreover, each Domino has its own cost value, expressed as an integer. The goal is to drop all the dominoes. To do this, the shark can push any domino to the left or to the right, and it will begin falling in this direction. If during the fall the domino touches other dominoes, they will also start falling in the same direction in which the original domino is falling, thus beginning a chain reaction, as a result of which many dominoes can fall. A falling domino touches another one, if and only if the distance between them was strictly less than the height of the falling domino, the dominoes do not necessarily have to be adjacent.Of course, any shark can easily drop all the dominoes in this way, so the goal is not to drop all the dominoes, but do it with a minimum cost. The cost of the destruction is the sum of the costs of dominoes that the shark needs to push to make all the dominoes fall.Simon has already won in the previous subjects, but is not smart enough to win in this one. Help Semyon and determine the minimum total cost of the dominoes he will have to push to make all the dominoes fall."          
              1400.0                         1131B Draw! greedy,implementation "You still have partial information about the score during the historic football match. You are given a set of pairs (ai,bi), indicating that at some point during the match the score was ""ai: bi"". It is known that if the current score is \xc2\xabx:y\xc2\xbb, then after the goal it will change to ""x+1:y"" or ""x:y+1"". What is the largest number of times a draw could appear on the scoreboard?The pairs ""ai:bi"" are given in chronological order (time increases), but you are given score only for some moments of time. The last pair corresponds to the end of the match."          
              1200.0                         1121B "Mike and Children" "brute force,implementation" "Mike decided to teach programming to children in an elementary school. He knows that it is not an easy task to interest children in that age to code. That is why he decided to give each child two sweets.Mike has n sweets with sizes a1,a2,\xe2\x80\xa6,an. All his sweets have different sizes. That is, there is no such pair (i,j) (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that i\xe2\x89\xa0j and ai=aj.Since Mike has taught for many years, he knows that if he gives two sweets with sizes ai and aj to one child and ak and ap to another, where (ai+aj)\xe2\x89\xa0(ak+ap), then a child who has a smaller sum of sizes will be upset. That is, if there are two children who have different sums of sweets, then one of them will be upset. Apparently, Mike does not want somebody to be upset. Mike wants to invite children giving each of them two sweets. Obviously, he can\'t give one sweet to two or more children. His goal is to invite as many children as he can. Since Mike is busy preparing to his first lecture in the elementary school, he is asking you to find the maximum number of children he can invite giving each of them two sweets in such way that nobody will be upset."          
              3400.0                         1119F "Niyaz and Small Degrees" "data structures,dp,trees" "Niyaz has a tree with n vertices numerated from 1 to n. A tree is a connected graph without cycles.Each edge in this tree has strictly positive integer weight. A degree of a vertex is the number of edges adjacent to this vertex.Niyaz does not like when vertices in the tree have too large degrees. For each x from 0 to (n\xe2\x88\x921), he wants to find the smallest total weight of a set of edges to be deleted so that degrees of all vertices become at most x."          
              1100.0                         1119A "Ilya and a Colorful Walk" greedy,implementation "Ilya lives in a beautiful city of Chordalsk.There are n houses on the street Ilya lives, they are numerated from 1 to n from left to right; the distance between every two neighboring houses is equal to 1 unit. The neighboring houses are 1 and 2, 2 and 3, ..., n\xe2\x88\x921 and n. The houses n and 1 are not neighboring.The houses are colored in colors c1,c2,\xe2\x80\xa6,cn so that the i-th house is colored in the color ci. Everyone knows that Chordalsk is not boring, so there are at least two houses colored in different colors.Ilya wants to select two houses i and j so that 1\xe2\x89\xa4i<j\xe2\x89\xa4n, and they have different colors: ci\xe2\x89\xa0cj. He will then walk from the house i to the house j the distance of (j\xe2\x88\x92i) units.Ilya loves long walks, so he wants to choose the houses so that the distance between them is the maximum possible.Help Ilya, find this maximum possible distance."          
              2700.0                         1118F2 "Tree Cutting (Hard Version)" "combinatorics,dfs and similar,dp,trees" "You are given an undirected tree of n vertices. Some vertices are colored one of the k colors, some are uncolored. It is guaranteed that the tree contains at least one vertex of each of the k colors. There might be no uncolored vertices.You choose a subset of exactly k\xe2\x88\x921 edges and remove it from the tree. Tree falls apart into k connected components. Let\'s call this subset of edges nice if none of the resulting components contain vertices of different colors.How many nice subsets of edges are there in the given tree? Two subsets are considered different if there is some edge that is present in one subset and absent in the other.The answer may be large, so print it modulo 998244353."          
              2500.0                         1117F "Crisp String" bitmasks,dp "You are given a string of length n. Each character is one of the first p lowercase Latin letters.You are also given a matrix A with binary values of size p\xc3\x97p. This matrix is symmetric (Aij=Aji). Aij=1 means that the string can have the i-th and j-th letters of Latin alphabet adjacent.Let\'s call the string crisp if all of the adjacent characters in it can be adjacent (have 1 in the corresponding cell of matrix A).You are allowed to do the following move. Choose any letter, remove all its occurrences and join the remaining parts of the string without changing their order. For example, removing letter \'a\' from ""abacaba"" will yield ""bcb"".The string you are given is crisp. The string should remain crisp after every move you make.You are allowed to do arbitrary number of moves (possible zero). What is the shortest resulting string you can obtain?"          
              -999.0                         1116D4 "TIE fighter"  "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N which has non-zero elements in the following positions: the central 2x2 sub-matrix, the diagonals of the top right and bottom left square sub-matrices of size 2N\xe2\x88\x921\xe2\x88\x921 that do not overlap with the central 2x2 sub-matrix, the anti-diagonals of the top left and bottom right square sub-matrices of size 2N\xe2\x88\x921\xe2\x88\x921 that do not overlap with the central 2x2 sub-matrix.For example, for N=3 the matrix of the operation should have the following shape:..X..X...X....X.X......X...XX......XX...X......X.X....X...X..X..Here X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation."          
              -999.0                         1116C3 "``Is the number of ones divisible by 3?\'\' oracle"  "Implement a quantum oracle on N qubits which checks whether the number of bits equal to 1 in the input vector \xe2\x86\x92x is divisible by 3 (i.e., implements the function f(\xe2\x86\x92x)=1 if the number of xi=1 in \xe2\x86\x92x is divisible by 3, and 0 otherwise).You have to implement an operation which takes the following inputs: an array of N (1\xe2\x89\xa4N\xe2\x89\xa49) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits. Note that the input register x has to remain unchanged after applying the operation.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}Note: the operation has to have an adjoint specified for it; adjoint auto means that the adjoint will be generated automatically. For details on adjoint, see Operation Declarations.You are not allowed to use measurements in your operation."          
              1100.0                         1115G1 "AND oracle" "*special problem" "Implement a quantum oracle on N qubits which implements the following function: f(\xe2\x86\x92x)=x0\xe2\x88\xa7x1\xe2\x88\xa7\xe2\x8b\xaf\xe2\x88\xa7xN\xe2\x88\x921You have to implement an operation which takes the following inputs: an array of N (1\xe2\x89\xa4N\xe2\x89\xa48) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}"          
              1500.0                         1114B "Yet Another Array Partitioning Task" "constructive algorithms,greedy,sortings" "An array b is called to be a subarray of a if it forms a continuous subsequence of a, that is, if it is equal to al, al+1, \xe2\x80\xa6, ar for some l,r.Suppose m is some known constant. For any array, having m or more elements, let\'s define it\'s beauty as the sum of m largest elements of that array. For example:   For array x=[4,3,1,5,2] and m=3, the 3 largest elements of x are 5, 4 and 3, so the beauty of x is 5+4+3=12. For array x=[10,10,10] and m=2, the beauty of x is 10+10=20.You are given an array a1,a2,\xe2\x80\xa6,an, the value of the said constant m and an integer k. Your need to split the array a into exactly k subarrays such that:  Each element from a belongs to exactly one subarray. Each subarray has at least m elements. The sum of all beauties of k subarrays is maximum possible."          
              1300.0                         1113B "Sasha and Magnetic Machines" "greedy,number theory" "One day Sasha visited the farmer 2D and his famous magnetic farm. On this farm, the crop grows due to the influence of a special magnetic field. Maintaining of the magnetic field is provided by n machines, and the power of the i-th machine is ai. This year 2D decided to cultivate a new culture, but what exactly he didn\'t say. For the successful growth of the new culture, it is necessary to slightly change the powers of the machines. 2D can at most once choose an arbitrary integer x, then choose one machine and reduce the power of its machine by x times, and at the same time increase the power of one another machine by x times (powers of all the machines must stay positive integers). Note that he may not do that if he wants. More formally, 2D can choose two such indices i and j, and one integer x such that x is a divisor of ai, and change powers as following: ai=aix, aj=aj\xe2\x8b\x85xSasha is very curious, that\'s why he wants to calculate the minimum total power the farmer can reach. There are too many machines, and Sasha can\'t cope with computations, help him!"          
              3500.0                         1110H "Modest Substrings" dp,strings "You are given two integers l and r.Let\'s call an integer x modest, if l\xe2\x89\xa4x\xe2\x89\xa4r.Find a string of length n, consisting of digits, which has the largest possible number of substrings, which make a modest integer. Substring having leading zeros are not counted. If there are many answers, find lexicographically smallest one.If some number occurs multiple times as a substring, then in the counting of the number of modest substrings it is counted multiple times as well."          
              2200.0                         1110E "Magic Stones" "constructive algorithms,math,sortings" "Grigory has n magic stones, conveniently numbered from 1 to n. The charge of the i-th stone is equal to ci.Sometimes Grigory gets bored and selects some inner stone (that is, some stone with index i, where 2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), and after that synchronizes it with neighboring stones. After that, the chosen stone loses its own charge, but acquires the charges from neighboring stones. In other words, its charge ci changes to c\xe2\x80\xb2i=ci+1+ci\xe2\x88\x921\xe2\x88\x92ci.Andrew, Grigory\'s friend, also has n stones with charges ti. Grigory is curious, whether there exists a sequence of zero or more synchronization operations, which transforms charges of Grigory\'s stones into charges of corresponding Andrew\'s stones, that is, changes ci into ti for all i?"          
              3200.0                         1109F "Sasha and Algorithm of Silence\'s Sounds" "data structures,trees" "One fine day Sasha went to the park for a walk. In the park, he saw that his favorite bench is occupied, and he had to sit down on the neighboring one. He sat down and began to listen to the silence. Suddenly, he got a question: what if in different parts of the park, the silence sounds in different ways? So it was. Let\'s divide the park into 1\xc3\x9711\xc3\x971 meter squares and call them cells, and numerate rows from 11 to nn from up to down, and columns from 11 to mm from left to right. And now, every cell can be described with a pair of two integers (x,y)(x,y), where xx \xe2\x80\x94 the number of the row, and yy \xe2\x80\x94 the number of the column. Sasha knows that the level of silence in the cell (i,j)(i,j) equals to fi,jfi,j, and all fi,jfi,j form a permutation of numbers from 11 to n\xe2\x8b\x85mn\xe2\x8b\x85m. Sasha decided to count, how many are there pleasant segments of silence?Let\'s take some segment [l\xe2\x80\xa6r][l\xe2\x80\xa6r]. Denote SS as the set of cells (i,j)(i,j) that l\xe2\x89\xa4fi,j\xe2\x89\xa4rl\xe2\x89\xa4fi,j\xe2\x89\xa4r. Then, the segment of silence [l\xe2\x80\xa6r][l\xe2\x80\xa6r] is pleasant if there is only one simple path between every pair of cells from SS (path can\'t contain cells, which are not in SS). In other words, set SS should look like a tree on a plain. Sasha has done this task pretty quickly, and called the algorithm \xe2\x80\x94 ""algorithm of silence\'s sounds"".Time passed, and the only thing left from the algorithm is a legend. To prove the truthfulness of this story, you have to help Sasha and to find the number of different pleasant segments of silence. Two segments [l1\xe2\x80\xa6r1][l1\xe2\x80\xa6r1], [l2\xe2\x80\xa6r2][l2\xe2\x80\xa6r2] are different, if l1\xe2\x89\xa0l2l1\xe2\x89\xa0l2 or r1\xe2\x89\xa0r2r1\xe2\x89\xa0r2 or both at the same time."          
              1300.0                         1108C "Nice Garland" "brute force,greedy,math" "You have a garland consisting of n lamps. Each lamp is colored red, green or blue. The color of the i-th lamp is si (\'R\', \'G\' and \'B\' \xe2\x80\x94 colors of lamps in the garland).You have to recolor some lamps in this garland (recoloring a lamp means changing its initial color to another) in such a way that the obtained garland is nice.A garland is called nice if any two lamps of the same color have distance divisible by three between them. I.e. if the obtained garland is t, then for each i,j such that ti=tj should be satisfied |i\xe2\x88\x92j| mod 3=0. The value |x| means absolute value of x, the operation x mod y means remainder of x when divided by y.For example, the following garlands are nice: ""RGBRGBRG"", ""GB"", ""R"", ""GRBGRBG"", ""BRGBRGB"". The following garlands are not nice: ""RR"", ""RGBG"".Among all ways to recolor the initial garland to make it nice you have to choose one with the minimum number of recolored lamps. If there are multiple optimal solutions, print any of them."          
              1100.0                         1108B "Divisors of Two Integers" "brute force,greedy,math,number theory" "Recently you have received two positive integer numbers x and y. You forgot them, but you remembered a shuffled list containing all divisors of x (including 1 and x) and all divisors of y (including 1 and y). If d is a divisor of both numbers x and y at the same time, there are two occurrences of d in the list.For example, if x=4 and y=6 then the given list can be any permutation of the list [1,2,4,1,2,3,6]. Some of the possible lists are: [1,1,2,4,6,3,2], [4,6,1,1,2,3,2] or [1,6,3,2,4,1,2].Your problem is to restore suitable positive integer numbers x and y that would yield the same list of divisors (possibly in different order).It is guaranteed that the answer exists, i.e. the given list of divisors corresponds to some positive integers x and y."          
              2400.0                         1107E "Vasya and Binary String" dp "Vasya has a string s of length n consisting only of digits 0 and 1. Also he has an array a of length n. Vasya performs the following operation until the string becomes empty: choose some consecutive substring of equal characters, erase it from the string and glue together the remaining parts (any of them can be empty). For example, if he erases substring 111 from string 111110 he will get the string 110. Vasya gets ax points for erasing substring of length x.Vasya wants to maximize his total points, so help him with this!"          
              1000.0                         1107B "Digital root" "math,number theory" "Today at the lesson of mathematics, Petya learns about the digital root.The digital root of a non-negative integer is the single digit value obtained by an iterative process of summing digits, on each iteration using the result from the previous iteration to compute a digit sum. The process continues until a single-digit number is reached. Let\'s denote the digital root of x as S(x). Then S(5)=5, S(38)=S(3+8=11)=S(1+1=2)=2, S(10)=S(1+0=1)=1.As a homework Petya got n tasks of the form: find k-th positive number whose digital root is x.Petya has already solved all the problems, but he doesn\'t know if it\'s right. Your task is to solve all n tasks from Petya\'s homework."          
              800.0                         1106A "Lunar New Year and Cross Counting" implementation "Lunar New Year is approaching, and you bought a matrix with lots of ""crosses"".This matrix M of size n\xc3\x97n contains only \'X\' and \'.\' (without quotes). The element in the i-th row and the j-th column (i,j) is defined as M(i,j), where 1\xe2\x89\xa4i,j\xe2\x89\xa4n. We define a cross appearing in the i-th row and the j-th column (1<i,j<n) if and only if M(i,j)=M(i\xe2\x88\x921,j\xe2\x88\x921)=M(i\xe2\x88\x921,j+1)=M(i+1,j\xe2\x88\x921)=M(i+1,j+1)= \'X\'.The following figure illustrates a cross appearing at position (2,2) in a 3\xc3\x973 matrix. X.X.X.X.X Your task is to find out the number of crosses in the given matrix M. Two crosses are different if and only if they appear in different rows or columns."          
              2000.0                         1102F "Elongated Matrix" "binary search,bitmasks,brute force,dp,graphs" "You are given a matrix a, consisting of n rows and m columns. Each cell contains an integer in it.You can change the order of rows arbitrarily (including leaving the initial order), but you can\'t change the order of cells in a row. After you pick some order of rows, you traverse the whole matrix the following way: firstly visit all cells of the first column from the top row to the bottom one, then the same for the second column and so on. During the traversal you write down the sequence of the numbers on the cells in the same order you visited them. Let that sequence be s1,s2,\xe2\x80\xa6,snm. The traversal is k-acceptable if for all i (1\xe2\x89\xa4i\xe2\x89\xa4nm\xe2\x88\x921) |si\xe2\x88\x92si+1|\xe2\x89\xa5k.Find the maximum integer k such that there exists some order of rows of matrix a that it produces a k-acceptable traversal."          
              1500.0                         1101E "Polycarp\'s New Job" implementation "Polycarp has recently got himself a new job. He now earns so much that his old wallet can\'t even store all the money he has.Berland bills somehow come in lots of different sizes. However, all of them are shaped as rectangles (possibly squares). All wallets are also produced in form of rectangles (possibly squares).A bill x\xc3\x97y fits into some wallet h\xc3\x97w if either x\xe2\x89\xa4h and y\xe2\x89\xa4w or y\xe2\x89\xa4h and x\xe2\x89\xa4w. Bills can overlap with each other in a wallet and an infinite amount of bills can fit into a wallet. That implies that all the bills Polycarp currently have fit into a wallet if every single one of them fits into it independently of the others.Now you are asked to perform the queries of two types:  + x y \xe2\x80\x94 Polycarp earns a bill of size x\xc3\x97y;  ? h w \xe2\x80\x94 Polycarp wants to check if all the bills he has earned to this moment fit into a wallet of size h\xc3\x97w. It is guaranteed that there is at least one query of type 1 before the first query of type 2 and that there is at least one query of type 2 in the input data.For each query of type 2 print ""YES"" if all the bills he has earned to this moment fit into a wallet of given size. Print ""NO"" otherwise."          
              800.0                         1099A Snowball implementation "Today\'s morning was exceptionally snowy. Meshanya decided to go outside and noticed a huge snowball rolling down the mountain! Luckily, there are two stones on that mountain.Initially, snowball is at height h and it has weight w. Each second the following sequence of events happens: snowball\'s weights increases by i, where i \xe2\x80\x94 is the current height of snowball, then snowball hits the stone (if it\'s present at the current height), then snowball moves one meter down. If the snowball reaches height zero, it stops.There are exactly two stones on the mountain. First stone has weight u1 and is located at height d1, the second one \xe2\x80\x94 u2 and d2 respectively. When the snowball hits either of two stones, it loses weight equal to the weight of that stone. If after this snowball has negative weight, then its weight becomes zero, but the snowball continues moving as before.  Find the weight of the snowball when it stops moving, that is, it reaches height 0."          
              800.0                         1095A "Repeating Cipher" implementation "Polycarp loves ciphers. He has invented his own cipher called repeating.Repeating cipher is used for strings. To encrypt the string s=s1s2\xe2\x80\xa6sm (1\xe2\x89\xa4m\xe2\x89\xa410), Polycarp uses the following algorithm:  he writes down s1 ones,  he writes down s2 twice,  he writes down s3 three times,  ...  he writes down sm m times. For example, if s=""bab"" the process is: ""b"" \xe2\x86\x92 ""baa"" \xe2\x86\x92 ""baabbb"". So the encrypted s=""bab"" is ""baabbb"".Given string t \xe2\x80\x94 the result of encryption of some string s. Your task is to decrypt it, i.\xe2\x80\x89e. find the string s."          
              2400.0                         1093F "Vasya and Array" dp "Vasya has got an array consisting of n integers, and two integers k and len in addition. All numbers in the array are either between 1 and k (inclusive), or equal to \xe2\x88\x921. The array is good if there is no segment of len consecutive equal numbers.Vasya will replace each \xe2\x88\x921 with some number from 1 to k (inclusive) in such a way that the resulting array is good. Tell him the number of ways to do this replacement. Since the answer may be large, print it modulo 998244353."          
              2600.0                         1091F "New Year and the Mallard Expedition" "constructive algorithms,greedy" "Bob is a duck. He wants to get to Alice\'s nest, so that those two can duck!  Duck is the ultimate animal! (Image courtesy of See Bang) The journey can be represented as a straight line, consisting of n segments. Bob is located to the left of the first segment, while Alice\'s nest is on the right of the last segment. Each segment has a length in meters, and also terrain type: grass, water or lava. Bob has three movement types: swimming, walking and flying. He can switch between them or change his direction at any point in time (even when he is located at a non-integer coordinate), and doing so doesn\'t require any extra time. Bob can swim only on the water, walk only on the grass and fly over any terrain. Flying one meter takes 1 second, swimming one meter takes 3 seconds, and finally walking one meter takes 5 seconds.Bob has a finite amount of energy, called stamina. Swimming and walking is relaxing for him, so he gains 1 stamina for every meter he walks or swims. On the other hand, flying is quite tiring, and he spends 1 stamina for every meter flown. Staying in place does not influence his stamina at all. Of course, his stamina can never become negative. Initially, his stamina is zero.What is the shortest possible time in which he can reach Alice\'s nest?"          
              3500.0                         1086F "Forest Fires" math "Berland forest was planted several decades ago in a formation of an infinite grid with a single tree in every cell. Now the trees are grown up and they form a pretty dense structure.So dense, actually, that the fire became a real danger for the forest. This season had been abnormally hot in Berland and some trees got caught on fire! The second fire started is considered the second 0. Every second fire lit up all intact neightbouring trees to every currently burning tree. The tree is neighbouring if it occupies adjacent by side or by corner cell. Luckily, after t seconds Berland fire department finally reached the location of fire and instantaneously extinguished it all.Now they want to calculate the destructive power of the fire. Let valx,y be the second the tree in cell (x,y) got caught on fire. The destructive power is the sum of valx,y over all (x,y) of burnt trees.Clearly, all the workers of fire department are firefighters, not programmers, thus they asked you to help them calculate the destructive power of the fire.The result can be rather big, so print it modulo 998244353."          
              2300.0                         1085E "Vasya and Templates" greedy,implementation,strings "Vasya owns three strings s , a and b, each of them consists only of first k Latin letters.Let a template be such a string of length k that each of the first k Latin letters appears in it exactly once (thus there are k! distinct templates). Application of template p to the string s is the replacement of each character in string s with pi, i is the index of this letter in the alphabet. For example, applying template ""bdca"" to a string ""aabccd"" yields string ""bbdcca"".Vasya wants to know if there exists such a template which yields a string lexicographically greater than or equal to string a and lexicographically less than or equal to string b after applying it to s.If there exist multiple suitable templates, print any of them.String a is lexicographically less than string b if there is some i (1\xe2\x89\xa4i\xe2\x89\xa4n) that ai<bi and for any j (1\xe2\x89\xa4j<i) aj=bj.You are required to answer t testcases independently."          
              1100.0                         1085B "Div Times Mod" math "Vasya likes to solve equations. Today he wants to solve (x div k)\xe2\x8b\x85(xmodk)=n, where div and mod stand for integer division and modulo operations (refer to the Notes below for exact definition). In this equation, k and n are positive integer parameters, and x is a positive integer unknown. If there are several solutions, Vasya wants to find the smallest possible x. Can you help him?"          
              2900.0                         1083C "Max Mex" "data structures,trees" "Once Grisha found a tree (connected graph without cycles) with a root in node 1.But this tree was not just a tree. A permutation p of integers from 0 to n\xe2\x88\x921 is written in nodes, a number pi is written in node i.As Grisha likes to invent some strange and interesting problems for himself, but not always can solve them, you need to help him deal with two types of queries on this tree.Let\'s define a function MEX(S), where S is a set of non-negative integers, as a smallest non-negative integer that is not included in this set.Let l be a simple path in this tree. So let\'s define indices of nodes which lie on l as u1, u2, \xe2\x80\xa6, uk. Define V(l) as a set {pu1, pu2, \xe2\x80\xa6 , puk}. Then queries are:   For two nodes i and j, swap pi and pj.  Find the maximum value of MEX(V(l)) in all possible l."          
              1800.0                         1082D "Maximum Diameter Graph" "constructive algorithms,graphs,implementation" "Graph constructive problems are back! This time the graph you are asked to build should match the following properties.The graph is connected if and only if there exists a path between every pair of vertices.The diameter (aka ""longest shortest path"") of a connected undirected graph is the maximum number of edges in the shortest path between any pair of its vertices.The degree of a vertex is the number of edges incident to it.Given a sequence of n integers a1,a2,\xe2\x80\xa6,an construct a connected undirected graph of n vertices such that:  the graph contains no self-loops and no multiple edges;  the degree di of the i-th vertex doesn\'t exceed ai (i.e. di\xe2\x89\xa4ai);  the diameter of the graph is maximum possible. Output the resulting graph or report that no solution exists."          
              3200.0                         1081G "Mergesort Strikes Back" math,probabilities "Chouti thought about his very first days in competitive programming. When he had just learned to write merge sort, he thought that the merge sort is too slow, so he restricted the maximum depth of recursion and modified the merge sort to the following:  Chouti found his idea dumb since obviously, this ""merge sort"" sometimes cannot sort the array correctly. However, Chouti is now starting to think of how good this ""merge sort"" is. Particularly, Chouti wants to know for a random permutation a of 1,2,\xe2\x80\xa6,n the expected number of inversions after calling MergeSort(a, 1, n, k).It can be proved that the expected number is rational. For the given prime q, suppose the answer can be denoted by ud where gcd(u,d)=1, you need to output an integer r satisfying 0\xe2\x89\xa4r<q and rd\xe2\x89\xa1u(modq). It can be proved that such r exists and is unique."          
              2600.0                         1081F "Tricky Interactor" "constructive algorithms,implementation,interactive" "This is an interactive problem.Chouti was tired of studying, so he opened the computer and started playing a puzzle game.Long long ago, the boy found a sequence s1,s2,\xe2\x80\xa6,sn of length n, kept by a tricky interactor. It consisted of 0s and 1s only and the number of 1s is t. The boy knows nothing about this sequence except n and t, but he can try to find it out with some queries with the interactor.We define an operation called flipping. Flipping [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) means for each x\xe2\x88\x88[l,r], changing sx to 1\xe2\x88\x92sx.In each query, the boy can give the interactor two integers l,r satisfying 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and the interactor will either flip [1,r] or [l,n] (both outcomes have the same probability and all decisions made by interactor are independent from each other, see Notes section for more details). The interactor will tell the current number of 1s after each operation. Note, that the sequence won\'t be restored after each operation.Help the boy to find the original sequence in no more than 10000 interactions.""Weird legend, dumb game."" he thought. However, after several tries, he is still stuck with it. Can you help him beat this game?"          
              1000.0                         1077B "Disturbed People" greedy "There is a house with n flats situated on the main street of Berlatov. Vova is watching this house every night. The house can be represented as an array of n integer numbers a1,a2,\xe2\x80\xa6,an, where ai=1 if in the i-th flat the light is on and ai=0 otherwise.Vova thinks that people in the i-th flats are disturbed and cannot sleep if and only if 1<i<n and ai\xe2\x88\x921=ai+1=1 and ai=0.Vova is concerned by the following question: what is the minimum number k such that if people from exactly k pairwise distinct flats will turn off the lights then nobody will be disturbed? Your task is to find this number k."          
              1900.0                         1076E "Vasya and a Tree" "data structures,trees" "Vasya has a tree consisting of n vertices with root in vertex 1. At first all vertices has 0 written on it.Let d(i,j) be the distance between vertices i and j, i.e. number of edges in the shortest path from i to j. Also, let\'s denote k-subtree of vertex x \xe2\x80\x94 set of vertices y such that next two conditions are met:   x is the ancestor of y (each vertex is the ancestor of itself);  d(x,y)\xe2\x89\xa4k. Vasya needs you to process m queries. The i-th query is a triple vi, di and xi. For each query Vasya adds value xi to each vertex from di-subtree of vi.Report to Vasya all values, written on vertices of the tree after processing all queries."          
              1800.0                         1076D "Edge Deletion" "graphs,greedy,shortest paths" "You are given an undirected connected weighted graph consisting of n vertices and m edges. Let\'s denote the length of the shortest path from vertex 1 to vertex i as di. You have to erase some edges of the graph so that at most k edges remain. Let\'s call a vertex i good if there still exists a path from 1 to i with length di after erasing the edges.Your goal is to erase the edges in such a way that the number of good vertices is maximized."          
              2500.0                         1073F "Choosing Two Paths" "dfs and similar,dp,greedy,trees" "You are given an undirected unweighted tree consisting of n vertices.An undirected tree is a connected undirected graph with n\xe2\x88\x921 edges.Your task is to choose two pairs of vertices of this tree (all the chosen vertices should be distinct) (x1,y1) and (x2,y2) in such a way that neither x1 nor y1 belong to the simple path from x2 to y2 and vice versa (neither x2 nor y2 should not belong to the simple path from x1 to y1).It is guaranteed that it is possible to choose such pairs for the given tree.Among all possible ways to choose such pairs you have to choose one with the maximum number of common vertices between paths from x1 to y1 and from x2 to y2. And among all such pairs you have to choose one with the maximum total length of these two paths.It is guaranteed that the answer with at least two common vertices exists for the given tree.The length of the path is the number of edges in it.The simple path is the path that visits each vertex at most once."          
              1100.0                         1070K "Video Posts" implementation "Polycarp took n videos, the duration of the i-th video is ai seconds. The videos are listed in the chronological order, i.e. the 1-st video is the earliest, the 2-nd video is the next, ..., the n-th video is the last.Now Polycarp wants to publish exactly k (1\xe2\x89\xa4k\xe2\x89\xa4n) posts in Instabram. Each video should be a part of a single post. The posts should preserve the chronological order, it means that the first post should contain one or more of the earliest videos, the second post should contain a block (one or more videos) going next and so on. In other words, if the number of videos in the j-th post is sj then:  s1+s2+\xe2\x8b\xaf+sk=n (si>0),  the first post contains the videos: 1,2,\xe2\x80\xa6,s1;  the second post contains the videos: s1+1,s1+2,\xe2\x80\xa6,s1+s2;  the third post contains the videos: s1+s2+1,s1+s2+2,\xe2\x80\xa6,s1+s2+s3;  ...  the k-th post contains videos: n\xe2\x88\x92sk+1,n\xe2\x88\x92sk+2,\xe2\x80\xa6,n. Polycarp is a perfectionist, he wants the total duration of videos in each post to be the same.Help Polycarp to find such positive integer values s1,s2,\xe2\x80\xa6,sk that satisfy all the conditions above."          
              1700.0                         1068C "Colored Rooks" "constructive algorithms,graphs" "Ivan is a novice painter. He has n dyes of different colors. He also knows exactly m pairs of colors which harmonize with each other.Ivan also enjoy playing chess. He has 5000 rooks. He wants to take k rooks, paint each of them in one of n colors and then place this k rooks on a chessboard of size 109\xc3\x97109.Let\'s call the set of rooks on the board connected if from any rook we can get to any other rook in this set moving only through cells with rooks from this set. Assume that rooks can jump over other rooks, in other words a rook can go to any cell which shares vertical and to any cell which shares horizontal.Ivan wants his arrangement of rooks to have following properties: For any color there is a rook of this color on a board; For any color the set of rooks of this color is connected; For any two different colors a b union of set of rooks of color a and set of rooks of color b is connected if and only if this two colors harmonize with each other.Please help Ivan find such an arrangement."          
              3100.0                         1067D "Computer Game" dp,greedy,math,probabilities "Ivan plays some computer game. There are n quests in the game. Each quest can be upgraded once, this increases the reward for its completion. Each quest has 3 parameters ai, bi, pi: reward for completing quest before upgrade, reward for completing quest after upgrade (ai<bi) and probability of successful completing the quest.Each second Ivan can try to complete one quest and he will succeed with probability pi. In case of success Ivan will get the reward and opportunity to upgrade any one quest (not necessary the one he just completed). In case of failure he gets nothing. Quests do not vanish after completing.Ivan has t seconds. He wants to maximize expected value of his total gain after t seconds. Help him to calculate this value."          
              1500.0                         1066B Heaters "greedy,two pointers" "Vova\'s house is an array consisting of n elements (yeah, this is the first problem, I think, where someone lives in the array). There are heaters in some positions of the array. The i-th element of the array is 1 if there is a heater in the position i, otherwise the i-th element of the array is 0.Each heater has a value r (r is the same for all heaters). This value means that the heater at the position pos can warm up all the elements in range [pos\xe2\x88\x92r+1;pos+r\xe2\x88\x921].Vova likes to walk through his house while he thinks, and he hates cold positions of his house. Vova wants to switch some of his heaters on in such a way that each element of his house will be warmed up by at least one heater. Vova\'s target is to warm up the whole house (all the elements of the array), i.e. if n=6, r=2 and heaters are at positions 2 and 5, then Vova can warm up the whole house if he switches all the heaters in the house on (then the first 3 elements will be warmed up by the first heater and the last 3 elements will be warmed up by the second heater).Initially, all the heaters are off.But from the other hand, Vova didn\'t like to pay much for the electricity. So he wants to switch the minimum number of heaters on in such a way that each element of his house is warmed up by at least one heater.Your task is to find this number of heaters or say that it is impossible to warm up the whole house."          
              1200.0                         1064B "Equations of Mathematical Magic" math "Colossal! \xe2\x80\x94 exclaimed Hawk-nose. \xe2\x80\x94 A programmer! That\'s exactly what we are looking for.Arkadi and Boris Strugatsky. Monday starts on SaturdayReading the book ""Equations of Mathematical Magic"" Roman Oira-Oira and Cristobal Junta found an interesting equation: a\xe2\x88\x92(a\xe2\x8a\x95x)\xe2\x88\x92x=0 for some given a, where \xe2\x8a\x95 stands for a bitwise exclusive or (XOR) of two integers (this operation is denoted as ^ or xor in many modern programming languages). Oira-Oira quickly found some x, which is the solution of the equation, but Cristobal Junta decided that Oira-Oira\'s result is not interesting enough, so he asked his colleague how many non-negative solutions of this equation exist. This task turned out to be too difficult for Oira-Oira, so he asks you to help."          
              2600.0                         1063D "Candies for Children" "brute force,math" "At the children\'s festival, children were dancing in a circle. When music stopped playing, the children were still standing in a circle. Then Lena remembered, that her parents gave her a candy box with exactly k candies ""Wilky May"". Lena is not a greedy person, so she decided to present all her candies to her friends in the circle. Lena knows, that some of her friends have a sweet tooth and others do not. Sweet tooth takes out of the box two candies, if the box has at least two candies, and otherwise takes one. The rest of Lena\'s friends always take exactly one candy from the box.Before starting to give candies, Lena step out of the circle, after that there were exactly n people remaining there. Lena numbered her friends in a clockwise order with positive integers starting with 1 in such a way that index 1 was assigned to her best friend Roma.Initially, Lena gave the box to the friend with number l, after that each friend (starting from friend number l) took candies from the box and passed the box to the next friend in clockwise order. The process ended with the friend number r taking the last candy (or two, who knows) and the empty box. Please note that it is possible that some of Lena\'s friends took candy from the box several times, that is, the box could have gone several full circles before becoming empty.Lena does not know which of her friends have a sweet tooth, but she is interested in the maximum possible number of friends that can have a sweet tooth. If the situation could not happen, and Lena have been proved wrong in her observations, please tell her about this."          
              2600.0                         1061E Politics flows,graphs "There are n cities in the country. Two candidates are fighting for the post of the President. The elections are set in the future, and both candidates have already planned how they are going to connect the cities with roads. Both plans will connect all cities using n\xe2\x88\x921 roads only. That is, each plan can be viewed as a tree. Both of the candidates had also specified their choice of the capital among n cities (x for the first candidate and y for the second candidate), which may or may not be same.Each city has a potential of building a port (one city can have at most one port). Building a port in i-th city brings ai amount of money. However, each candidate has his specific demands. The demands are of the form:   k x, which means that the candidate wants to build exactly x ports in the subtree of the k-th city of his tree (the tree is rooted at the capital of his choice). Find out the maximum revenue that can be gained while fulfilling all demands of both candidates, or print -1 if it is not possible to do.It is additionally guaranteed, that each candidate has specified the port demands for the capital of his choice."          
              1100.0                         1060B "Maximum Sum of Digits" greedy "You are given a positive integer n.Let S(x) be sum of digits in base 10 representation of x, for example, S(123)=1+2+3=6, S(0)=0.Your task is to find two integers a,b, such that 0\xe2\x89\xa4a,b\xe2\x89\xa4n, a+b=n and S(a)+S(b) is the largest possible among all such pairs."          
              2000.0                         1057C "Tanya and Colored Candies" "*special problem,dp" "There are n candy boxes in front of Tania. The boxes are arranged in a row from left to right, numbered from 1 to n. The i-th box contains ri candies, candies have the color ci (the color can take one of three values \xe2\x80\x8b\xe2\x80\x8b\xe2\x80\x94 red, green, or blue). All candies inside a single box have the same color (and it is equal to ci).Initially, Tanya is next to the box number s. Tanya can move to the neighbor box (that is, with a number that differs by one) or eat candies in the current box. Tanya eats candies instantly, but the movement takes one second.If Tanya eats candies from the box, then the box itself remains in place, but there is no more candies in it. In other words, Tanya always eats all the candies from the box and candies in the boxes are not refilled.It is known that Tanya cannot eat candies of the same color one after another (that is, the colors of candies in two consecutive boxes from which she eats candies are always different). In addition, Tanya\'s appetite is constantly growing, so in each next box from which she eats candies, there should be strictly more candies than in the previous one.Note that for the first box from which Tanya will eat candies, there are no restrictions on the color and number of candies.Tanya wants to eat at least k candies. What is the minimum number of seconds she will need? Remember that she eats candies instantly, and time is spent only on movements."          
              1400.0                         1057B DDoS "*special problem,brute force" "We get more and more news about DDoS-attacks of popular websites.Arseny is an admin and he thinks that a website is under a DDoS-attack if the total number of requests for a some period of time exceeds 100\xe2\x8b\x85t, where t \xe2\x80\x94 the number of seconds in this time segment. Arseny knows statistics on the number of requests per second since the server is booted. He knows the sequence r1,r2,\xe2\x80\xa6,rn, where ri \xe2\x80\x94 the number of requests in the i-th second after boot. Determine the length of the longest continuous period of time, which Arseny considers to be a DDoS-attack. A seeking time period should not go beyond the boundaries of the segment [1,n]."          
              800.0                         1056A "Determine Line" implementation "Arkady\'s morning seemed to be straight of his nightmare. He overslept through the whole morning and, still half-asleep, got into the tram that arrived the first. Some time after, leaving the tram, he realized that he was not sure about the line number of the tram he was in.During his ride, Arkady woke up several times and each time he saw the tram stopping at some stop. For each stop he knows which lines of tram stop there. Given this information, can you help Arkady determine what are the possible lines of the tram he was in?"          
              2400.0                         1054E "Chips Puzzle" "constructive algorithms,implementation,math" "Egor came up with a new chips puzzle and suggests you to play.The puzzle has the form of a table with n rows and m columns, each cell can contain several black or white chips placed in a row. Thus, the state of the cell can be described by a string consisting of characters \'0\' (a white chip) and \'1\' (a black chip), possibly empty, and the whole puzzle can be described as a table, where each cell is a string of zeros and ones. The task is to get from one state of the puzzle some other state.To do this, you can use the following operation.  select 2 different cells (x1,y1) and (x2,y2): the cells must be in the same row or in the same column of the table, and the string in the cell (x1,y1) must be non-empty;  in one operation you can move the last character of the string at the cell (x1,y1) to the beginning of the string at the cell (x2,y2). Egor came up with two states of the table for you: the initial state and the final one. It is guaranteed that the number of zeros and ones in the tables are the same. Your goal is with several operations get the final state from the initial state. Of course, Egor does not want the number of operations to be very large. Let\'s denote as s the number of characters in each of the tables (which are the same). Then you should use no more than 4\xe2\x8b\x85s operations."          
              1900.0                         1044B "Intersecting Subtrees" "dfs and similar,interactive,trees" "You are playing a strange game with Li Chen. You have a tree with n nodes drawn on a piece of paper. All nodes are unlabeled and distinguishable. Each of you independently labeled the vertices from 1 to n. Neither of you know the other\'s labelling of the tree.You and Li Chen each chose a subtree (i.e., a connected subgraph) in that tree. Your subtree consists of the vertices labeled x1,x2,\xe2\x80\xa6,xk1 in your labeling, Li Chen\'s subtree consists of the vertices labeled y1,y2,\xe2\x80\xa6,yk2 in his labeling. The values of x1,x2,\xe2\x80\xa6,xk1 and y1,y2,\xe2\x80\xa6,yk2 are known to both of you.   The picture shows two labelings of a possible tree: yours on the left and Li Chen\'s on the right. The selected trees are highlighted. There are two common nodes. You want to determine whether your subtrees have at least one common vertex. Luckily, your friend Andrew knows both labelings of the tree. You can ask Andrew at most 5 questions, each of which is in one of the following two forms:   A x: Andrew will look at vertex x in your labeling and tell you the number of this vertex in Li Chen\'s labeling.  B y: Andrew will look at vertex y in Li Chen\'s labeling and tell you the number of this vertex in your labeling. Determine whether the two subtrees have at least one common vertex after asking some questions. If there is at least one common vertex, determine one of your labels for any of the common vertices."          
              1900.0                         1043E "Train Hard, Win Easy" "constructive algorithms,greedy,math,sortings" "Zibi is a competitive programming coach. There are n competitors who want to be prepared well. The training contests are quite unusual \xe2\x80\x93 there are two people in a team, two problems, and each competitor will code exactly one of them. Of course, people in one team will code different problems.Rules of scoring also aren\'t typical. The first problem is always an implementation problem: you have to implement some well-known algorithm very fast and the time of your typing is rated. The second one is an awful geometry task and you just have to get it accepted in reasonable time. Here the length and difficulty of your code are important. After that, Zibi will give some penalty points (possibly negative) for each solution and the final score of the team is the sum of them (the less the score is, the better).We know that the i-th competitor will always have score xi when he codes the first task and yi when he codes the second task. We can assume, that all competitors know each other\'s skills and during the contest distribute the problems in the way that minimizes their final score. Remember that each person codes exactly one problem in a contest.Zibi wants all competitors to write a contest with each other. However, there are m pairs of people who really don\'t like to cooperate and they definitely won\'t write a contest together. Still, the coach is going to conduct trainings for all possible pairs of people, such that the people in pair don\'t hate each other. The coach is interested for each participant, what will be his or her sum of scores of all teams he trained in?"          
              1200.0                         1043B "Lost Array" implementation "Bajtek, known for his unusual gifts, recently got an integer array x0,x1,\xe2\x80\xa6,xk\xe2\x88\x921.Unfortunately, after a huge array-party with his extraordinary friends, he realized that he\'d lost it. After hours spent on searching for a new toy, Bajtek found on the arrays producer\'s website another array a of length n+1. As a formal description of a says, a0=0 and for all other i (1\xe2\x89\xa4i\xe2\x89\xa4n) ai=x(i\xe2\x88\x921)modk+ai\xe2\x88\x921, where pmodq denotes the remainder of division p by q.For example, if the x=[1,2,3] and n=5, then:  a0=0,  a1=x0mod3+a0=x0+0=1,  a2=x1mod3+a1=x1+1=3,  a3=x2mod3+a2=x2+3=6,  a4=x3mod3+a3=x0+6=7,  a5=x4mod3+a4=x1+7=9. So, if the x=[1,2,3] and n=5, then a=[0,1,3,6,7,9].Now the boy hopes that he will be able to restore x from a! Knowing that 1\xe2\x89\xa4k\xe2\x89\xa4n, help him and find all possible values of k \xe2\x80\x94 possible lengths of the lost array."          
              1800.0                         1042D "Petya and Array" "data structures,divide and conquer,two pointers" "Petya has an array a consisting of n integers. He has learned partial sums recently, and now he can calculate the sum of elements on any segment of the array really fast. The segment is a non-empty sequence of elements standing one next to another in the array.Now he wonders what is the number of segments in his array with the sum less than t. Help Petya to calculate this number.More formally, you are required to calculate the number of pairs l,r (l\xe2\x89\xa4r) such that al+al+1+\xe2\x8b\xaf+ar\xe2\x88\x921+ar<t."          
              800.0                         1038A Equality implementation,strings "You are given a string s of length n, which consists only of the first k letters of the Latin alphabet. All letters in string s are uppercase.A subsequence of string s is a string that can be derived from s by deleting some of its symbols without changing the order of the remaining symbols. For example, ""ADE"" and ""BD"" are subsequences of ""ABCDE"", but ""DEA"" is not.A subsequence of s called good if the number of occurences of each of the first k letters of the alphabet is the same.Find the length of the longest good subsequence of s."          
              2400.0                         1036E "Covered Points" "fft,geometry,number theory" "You are given n segments on a Cartesian plane. Each segment\'s endpoints have integer coordinates. Segments can intersect with each other. No two segments lie on the same line.Count the number of distinct points with integer coordinates, which are covered by at least one segment."          
              3500.0                         1034D "Intervals of Intervals" "binary search,data structures,two pointers" "Little D is a friend of Little C who loves intervals very much instead of number ""3"".Now he has n intervals on the number axis, the i-th of which is [ai,bi].Only the n intervals can not satisfy him. He defines the value of an interval of intervals [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, l and r are both integers) as the total length of the union of intervals from the l-th to the r-th.He wants to select exactly k different intervals of intervals such that the sum of their values is maximal. Please help him calculate the maximal sum."          
              1900.0                         1029D "Concatenated Multiples" implementation,math "You are given an array a, consisting of n positive integers.Let\'s call a concatenation of numbers x and y the number that is obtained by writing down numbers x and y one right after another without changing the order. For example, a concatenation of numbers 12 and 3456 is a number 123456.Count the number of ordered pairs of positions (i,j) (i\xe2\x89\xa0j) in array a such that the concatenation of ai and aj is divisible by k."          
              3000.0                         1028G "Guess the number" dp,interactive "This problem is interactive.You should guess hidden number x which is between 1 and M=10004205361450474, inclusive.You could use up to 5 queries.In each query, you can output an increasing sequence of k\xe2\x89\xa4x integers, each between 1 and M, inclusive, and you will obtain one of the following as an answer:  either the hidden number belongs to your query sequence, in this case you immediately win;  or you will be given where the hidden number is located with respect to your query sequence, that is, either it is less than all numbers from the sequence, greater than all numbers from the sequence, or you will be given such an i that the hidden number x is between the i-th and the (i+1)-st numbers of your sequence. See the interaction section for clarity.Be aware that the interactor is adaptive, i.e. the hidden number can depend on queries the solution makes. However, it is guaranteed that for any solution the interactor works non-distinguishable from the situation when the hidden number is fixed beforehand.Hacks are allowed only with fixed hidden number. A hack is represented by a single integer between 1 and M. In all pretests the hidden number is fixed as well."          
              2100.0                         1023E "Down or Right" "constructive algorithms,interactive,matrices" "This is an interactive problem.Bob lives in a square grid of size n\xc3\x97n, with rows numbered 1 through n from top to bottom, and columns numbered 1 through n from left to right. Every cell is either allowed or blocked, but you don\'t know the exact description of the grid. You are given only an integer n.Bob can move through allowed cells but only in some limited directions. When Bob is in an allowed cell in the grid, he can move down or right to an adjacent cell, if it is allowed.You can ask at most 4\xe2\x8b\x85n queries of form ""? r1 c1 r2 c2"" (1\xe2\x89\xa4r1\xe2\x89\xa4r2\xe2\x89\xa4n, 1\xe2\x89\xa4c1\xe2\x89\xa4c2\xe2\x89\xa4n). The answer will be ""YES"" if Bob can get from a cell (r1,c1) to a cell (r2,c2), and ""NO"" otherwise. In particular, if one of the two cells (or both) is a blocked cell then the answer is ""NO"" for sure. Since Bob doesn\'t like short trips, you can only ask queries with the manhattan distance between the two cells at least n\xe2\x88\x921, i.e. the following condition must be satisfied: (r2\xe2\x88\x92r1)+(c2\xe2\x88\x92c1)\xe2\x89\xa5n\xe2\x88\x921.It\'s guaranteed that Bob can get from the top-left corner (1,1) to the bottom-right corner (n,n) and your task is to find a way to do it. You should print the answer in form ""! S"" where S is a string of length 2\xe2\x8b\x85n\xe2\x88\x922 consisting of characters \'D\' and \'R\', denoting moves down and right respectively. The down move increases the first coordinate by 1, the right move increases the second coordinate by 1. If there are multiple solutions, any of them will be accepted. You should terminate immediately after printing the solution."          
              3200.0                         1019E "Raining season" "data structures,divide and conquer,trees" "By the year 3018, Summer Informatics School has greatly grown. Hotel \xc2\xabBerendeetronik\xc2\xbb has been chosen as a location of the school. The camp consists of n houses with n\xe2\x88\x921 pathways between them. It is possible to reach every house from each other using the pathways.Everything had been perfect until the rains started. The weather forecast promises that rains will continue for m days. A special squad of teachers was able to measure that the i-th pathway, connecting houses ui and vi, before the rain could be passed in bi seconds. Unfortunately, the rain erodes the roads, so with every day the time to pass the road will increase by ai seconds. In other words, on the t-th (from zero) day after the start of the rain, it will take ai\xe2\x8b\x85t+bi seconds to pass through this road.Unfortunately, despite all the efforts of teachers, even in the year 3018 not all the students are in their houses by midnight. As by midnight all students have to go to bed, it is important to find the maximal time between all the pairs of houses for each day, so every student would know the time when he has to run to his house.Find all the maximal times of paths between every pairs of houses after t=0, t=1, ..., t=m\xe2\x88\x921 days."          
              1200.0                         1011B "Planning The Expedition" "binary search,brute force,implementation" "Natasha is planning an expedition to Mars for n people. One of the important tasks is to provide food for each participant.The warehouse has m daily food packages. Each package has some food type ai.Each participant must eat exactly one food package each day. Due to extreme loads, each participant must eat the same food type throughout the expedition. Different participants may eat different (or the same) types of food.Formally, for each participant j Natasha should select his food type bj and each day j-th participant will eat one food package of type bj. The values bj for different participants may be different.What is the maximum possible number of days the expedition can last, following the requirements above?"          
              3400.0                         1010F Tree fft,graphs,trees "The Main Martian Tree grows on Mars. It is a binary tree (a rooted tree, with no more than two sons at each vertex) with n vertices, where the root vertex has the number 1. Its fruits are the Main Martian Fruits. It\'s summer now, so this tree does not have any fruit yet.Autumn is coming soon, and leaves and branches will begin to fall off the tree. It is clear, that if a vertex falls off the tree, then its entire subtree will fall off too. In addition, the root will remain on the tree. Formally: the tree will have some connected subset of vertices containing the root.After that, the fruits will grow on the tree (only at those vertices which remain). Exactly x fruits will grow in the root. The number of fruits in each remaining vertex will be not less than the sum of the numbers of fruits in the remaining sons of this vertex. It is allowed, that some vertices will not have any fruits.Natasha wondered how many tree configurations can be after the described changes. Since this number can be very large, output it modulo 998244353.Two configurations of the resulting tree are considered different if one of these two conditions is true: they have different subsets of remaining vertices; they have the same subset of remaining vertices, but there is a vertex in this subset where they have a different amount of fruits."          
              2300.0                         1009F "Dominant Indices" "data structures,dsu,trees" "You are given a rooted undirected tree consisting of n vertices. Vertex 1 is the root.Let\'s denote a depth array of vertex x as an infinite sequence [dx,0,dx,1,dx,2,\xe2\x80\xa6], where dx,i is the number of vertices y such that both conditions hold:  x is an ancestor of y;  the simple path from x to y traverses exactly i edges. The dominant index of a depth array of vertex x (or, shortly, the dominant index of vertex x) is an index j such that:  for every k<j, dx,k<dx,j;  for every k>j, dx,k\xe2\x89\xa4dx,j. For every vertex in the tree calculate its dominant index."          
              1600.0                         1006E "Military Problem" "dfs and similar,graphs,trees" "In this problem you will have to help Berland army with organizing their command delivery system.There are n officers in Berland army. The first officer is the commander of the army, and he does not have any superiors. Every other officer has exactly one direct superior. If officer a is the direct superior of officer b, then we also can say that officer b is a direct subordinate of officer a.Officer x is considered to be a subordinate (direct or indirect) of officer y if one of the following conditions holds:  officer y is the direct superior of officer x;  the direct superior of officer x is a subordinate of officer y. For example, on the picture below the subordinates of the officer 3 are: 5,6,7,8,9.The structure of Berland army is organized in such a way that every officer, except for the commander, is a subordinate of the commander of the army.Formally, let\'s represent Berland army as a tree consisting of n vertices, in which vertex u corresponds to officer u. The parent of vertex u corresponds to the direct superior of officer u. The root (which has index 1) corresponds to the commander of the army.Berland War Ministry has ordered you to give answers on q queries, the i-th query is given as (ui,ki), where ui is some officer, and ki is a positive integer.To process the i-th query imagine how a command from ui spreads to the subordinates of ui. Typical DFS (depth first search) algorithm is used here.Suppose the current officer is a and he spreads a command. Officer a chooses b \xe2\x80\x94 one of his direct subordinates (i.e. a child in the tree) who has not received this command yet. If there are many such direct subordinates, then a chooses the one having minimal index. Officer a gives a command to officer b. Afterwards, b uses exactly the same algorithm to spread the command to its subtree. After b finishes spreading the command, officer a chooses the next direct subordinate again (using the same strategy). When officer a cannot choose any direct subordinate who still hasn\'t received this command, officer a finishes spreading the command.Let\'s look at the following example:  If officer 1 spreads a command, officers receive it in the following order: [1,2,3,5,6,8,7,9,4].If officer 3 spreads a command, officers receive it in the following order: [3,5,6,8,7,9].If officer 7 spreads a command, officers receive it in the following order: [7,9].If officer 9 spreads a command, officers receive it in the following order: [9].To answer the i-th query (ui,ki), construct a sequence which describes the order in which officers will receive the command if the ui-th officer spreads it. Return the ki-th element of the constructed list or -1 if there are fewer than ki elements in it.You should process queries independently. A query doesn\'t affect the following queries."          
              2100.0                         1005F "Berland and the Shortest Paths" "brute force,dfs and similar,graphs,shortest paths" "There are n cities in Berland. Some pairs of cities are connected by roads. All roads are bidirectional. Each road connects two different cities. There is at most one road between a pair of cities. The cities are numbered from 1 to n.It is known that, from the capital (the city with the number 1), you can reach any other city by moving along the roads.The President of Berland plans to improve the country\'s road network. The budget is enough to repair exactly n\xe2\x88\x921 roads. The President plans to choose a set of n\xe2\x88\x921 roads such that:  it is possible to travel from the capital to any other city along the n\xe2\x88\x921 chosen roads,  if di is the number of roads needed to travel from the capital to city i, moving only along the n\xe2\x88\x921 chosen roads, then d1+d2+\xe2\x8b\xaf+dn is minimized (i.e. as minimal as possible). In other words, the set of n\xe2\x88\x921 roads should preserve the connectivity of the country, and the sum of distances from city 1 to all cities should be minimized (where you can only use the n\xe2\x88\x921 chosen roads).The president instructed the ministry to prepare k possible options to choose n\xe2\x88\x921 roads so that both conditions above are met.Write a program that will find k possible ways to choose roads for repair. If there are fewer than k ways, then the program should output all possible valid ways to choose roads."          
              2300.0                         1004D "Sonya and Matrix" "brute force,constructive algorithms,implementation" "Since Sonya has just learned the basics of matrices, she decided to play with them a little bit.Sonya imagined a new type of matrices that she called rhombic matrices. These matrices have exactly one zero, while all other cells have the Manhattan distance to the cell containing the zero. The cells with equal numbers have the form of a rhombus, that is why Sonya called this type so.The Manhattan distance between two cells (x1, y1) and (x2, y2) is defined as |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|. For example, the Manhattan distance between the cells (5,2) and (7,1) equals to |5\xe2\x88\x927|+|2\xe2\x88\x921|=3.  Example of a rhombic matrix. Note that rhombic matrices are uniquely defined by n, m, and the coordinates of the cell containing the zero.She drew a n\xc3\x97m rhombic matrix. She believes that you can not recreate the matrix if she gives you only the elements of this matrix in some arbitrary order (i.e., the sequence of n\xe2\x8b\x85m numbers). Note that Sonya will not give you n and m, so only the sequence of numbers in this matrix will be at your disposal.Write a program that finds such an n\xc3\x97m rhombic matrix whose elements are the same as the elements in the sequence in some order."          
              1600.0                         1003D "Coins and Queries" greedy "Polycarp has n coins, the value of the i-th coin is ai. It is guaranteed that all the values are integer powers of 2 (i.e. ai=2d for some non-negative integer number d).Polycarp wants to know answers on q queries. The j-th query is described as integer number bj. The answer to the query is the minimum number of coins that is necessary to obtain the value bj using some subset of coins (Polycarp can use only coins he has). If Polycarp can\'t obtain the value bj, the answer to the j-th query is -1.The queries are independent (the answer on the query doesn\'t affect Polycarp\'s coins)."          
              1600.0                         1002B3 "Distinguish four 2-qubit states"  "You are given 2 qubits which are guaranteed to be in one of the four orthogonal states:    Your task is to perform necessary operations and measurements to figure out which state it was and to return the index of that state (0 for , 1 for  etc.). The state of the qubits after the operations does not matter.You have to implement an operation which takes an array of 2 qubits as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Int    {        body        {            // your code here        }    }}"          
              1600.0                         1002B2 "Distinguish GHZ state and W state"  "You are given N qubits (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898) which are guaranteed to be in one of the two states:   state, or  state. Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was GHZ state or 1 if it was W state. The state of the qubits after the operations does not matter.You have to implement an operation which takes an array of N qubits as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Int    {        body        {            // your code here        }    }}"          
              1900.0                         1002A4 "Generate W state"  "You are given N\xe2\x80\x89=\xe2\x80\x892k qubits (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894) in zero state . Your task is to create a generalized W state on them. Generalized W state is an equal superposition of all basis states on N qubits that have Hamming weight equal to 1:For example, for N\xe2\x80\x89=\xe2\x80\x891, .You have to implement an operation which takes an array of N qubits as an input and has no output. The ""output"" of the operation is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : ()    {        body        {            // your code here        }    }}"          
              1700.0                         1001I "Deutsch-Jozsa algorithm" "*special problem" "You are given a quantum oracle - an operation on N\xe2\x80\x89+\xe2\x80\x891 qubits which implements a function . You are guaranteed that the function f implemented by the oracle is either constant (returns 0 on all inputs or 1 on all inputs) or balanced (returns 0 on exactly one half of the input domain and 1 on the other half).There are only two possible constant functions: f(x)\xe2\x80\x89=\xe2\x80\x890 and f(x)\xe2\x80\x89=\xe2\x80\x891. The functions implemented by oracles in the two previous problems (f(x)\xe2\x80\x89=\xe2\x80\x89xk and ) are examples of balanced functions.Your task is to figure out whether the function given by the oracle is constant. Your code is allowed to call the given oracle only once."          
              1300.0                         1001F "Distinguish multi-qubit basis states" "*special problem" "You are given N qubits which are guaranteed to be in one of two basis states on N qubits. You are also given two bitstrings bits0 and bits1 which describe these basis states.Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was the state described with bits0 or 1 if it was the state described with bits1. The state of the qubits after the operations does not matter."          
              2100.0                         1000E "We Need More Bosses" "dfs and similar,graphs,trees" "Your friend is developing a computer game. He has already decided how the game world should look like \xe2\x80\x94 it should consist of n locations connected by m two-way passages. The passages are designed in such a way that it should be possible to get from any location to any other location.Of course, some passages should be guarded by the monsters (if you just can go everywhere without any difficulties, then it\'s not fun, right?). Some crucial passages will be guarded by really fearsome monsters, requiring the hero to prepare for battle and designing his own tactics of defeating them (commonly these kinds of monsters are called bosses). And your friend wants you to help him place these bosses.The game will start in location s and end in location t, but these locations are not chosen yet. After choosing these locations, your friend will place a boss in each passage such that it is impossible to get from s to t without using this passage. Your friend wants to place as much bosses as possible (because more challenges means more fun, right?), so he asks you to help him determine the maximum possible number of bosses, considering that any location can be chosen as s or as t."          
              1200.0                         1000A "Codehorses T-shirts" greedy,implementation "Codehorses has just hosted the second Codehorses Cup. This year, the same as the previous one, organizers are giving T-shirts for the winners.The valid sizes of T-shirts are either ""M"" or from 0 to 3 ""X"" followed by ""S"" or ""L"". For example, sizes ""M"", ""XXS"", ""L"", ""XXXL"" are valid and ""XM"", ""Z"", ""XXXXL"" are not.There are n winners to the cup for both the previous year and the current year. Ksenia has a list with the T-shirt sizes printed for the last year cup and is yet to send the new list to the printing office. Organizers want to distribute the prizes as soon as possible, so now Ksenia is required not to write the whole list from the scratch but just make some changes to the list of the previous year. In one second she can choose arbitrary position in any word and replace its character with some uppercase Latin letter. Ksenia can\'t remove or add letters in any of the words.What is the minimal number of seconds Ksenia is required to spend to change the last year list to the current one?The lists are unordered. That means, two lists are considered equal if and only if the number of occurrences of any string is the same in both lists."          
              2000.0                         999E "Reachability from the Capital" "dfs and similar,graphs,greedy" "There are n cities and m roads in Berland. Each road connects a pair of cities. The roads in Berland are one-way.What is the minimum number of new roads that need to be built to make all the cities reachable from the capital?New roads will also be one-way."          
              1200.0                         999C "Alphabetic Removals" implementation "You are given a string s consisting of n lowercase Latin letters. Polycarp wants to remove exactly k characters (k\xe2\x89\xa4n) from the string s. Polycarp uses the following algorithm k times:  if there is at least one letter \'a\', remove the leftmost occurrence and stop the algorithm, otherwise go to next item;  if there is at least one letter \'b\', remove the leftmost occurrence and stop the algorithm, otherwise go to next item;  ...  remove the leftmost occurrence of the letter \'z\' and stop the algorithm. This algorithm removes a single letter from the string. Polycarp performs this algorithm exactly k times, thus removing exactly k characters.Help Polycarp find the resulting string."          
              1000.0                         998A Balloons "constructive algorithms,implementation" "There are quite a lot of ways to have fun with inflatable balloons. For example, you can fill them with water and see what happens.Grigory and Andrew have the same opinion. So, once upon a time, they went to the shop and bought n packets with inflatable balloons, where i-th of them has exactly ai balloons inside.They want to divide the balloons among themselves. In addition, there are several conditions to hold:  Do not rip the packets (both Grigory and Andrew should get unbroken packets);  Distribute all packets (every packet should be given to someone);  Give both Grigory and Andrew at least one packet;  To provide more fun, the total number of balloons in Grigory\'s packets should not be equal to the total number of balloons in Andrew\'s packets. Help them to divide the balloons or determine that it\'s impossible under these conditions."          
              3000.0                         997E "Good Subsegments" "data structures" "A permutation p of length n is a sequence p1,p2,\xe2\x80\xa6,pn consisting of n distinct integers, each of which from 1 to n (1\xe2\x89\xa4pi\xe2\x89\xa4n) .Let\'s call the subsegment [l,r] of the permutation good if all numbers from the minimum on it to the maximum on this subsegment occur among the numbers pl,pl+1,\xe2\x80\xa6,pr.For example, good segments of permutation [1,3,2,5,4] are:  [1,1],  [1,3],  [1,5],  [2,2],  [2,3],  [2,5],  [3,3],  [4,4],  [4,5],  [5,5]. You are given a permutation p1,p2,\xe2\x80\xa6,pn.You need to answer q queries of the form: find the number of good subsegments of the given segment of permutation.In other words, to answer one query, you need to calculate the number of good subsegments [x\xe2\x80\xa6y] for some given segment [l\xe2\x80\xa6r], such that l\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4r."          
              900.0                         989A "A Blend of Springtime" implementation,strings "When the curtains are opened, a canvas unfolds outside. Kanno marvels at all the blonde colours along the riverside \xe2\x80\x94 not tangerines, but blossoms instead.""What a pity it\'s already late spring,"" sighs Mino with regret, ""one more drizzling night and they\'d be gone.""""But these blends are at their best, aren\'t they?"" Absorbed in the landscape, Kanno remains optimistic. The landscape can be expressed as a row of consecutive cells, each of which either contains a flower of colour amber or buff or canary yellow, or is empty.When a flower withers, it disappears from the cell that it originally belonged to, and it spreads petals of its colour in its two neighbouring cells (or outside the field if the cell is on the side of the landscape). In case petals fall outside the given cells, they simply become invisible.You are to help Kanno determine whether it\'s possible that after some (possibly none or all) flowers shed their petals, at least one of the cells contains all three colours, considering both petals and flowers. Note that flowers can wither in arbitrary order."          
              3300.0                         983D "Arkady and Rectangles" "data structures" "Arkady has got an infinite plane painted in color 0. Then he draws n rectangles filled with paint with sides parallel to the Cartesian coordinate axes, one after another. The color of the i-th rectangle is i (rectangles are enumerated from 1 to n in the order he draws them). It is possible that new rectangles cover some of the previous ones completely or partially.Count the number of different colors on the plane after Arkady draws all the rectangles."          
              1000.0                         981B "Businessmen Problems" sortings "Two famous competing companies ChemForces and TopChemist decided to show their sets of recently discovered chemical elements on an exhibition. However they know that no element should be present in the sets of both companies.In order to avoid this representatives of both companies decided to make an agreement on the sets the companies should present. The sets should be chosen in the way that maximizes the total income of the companies.All elements are enumerated with integers. The ChemForces company has discovered n distinct chemical elements with indices a1,a2,\xe2\x80\xa6,an, and will get an income of xi Berland rubles if the i-th element from this list is in the set of this company.The TopChemist company discovered m distinct chemical elements with indices b1,b2,\xe2\x80\xa6,bm, and it will get an income of yj Berland rubles for including the j-th element from this list to its set.In other words, the first company can present any subset of elements from {a1,a2,\xe2\x80\xa6,an} (possibly empty subset), the second company can present any subset of elements from {b1,b2,\xe2\x80\xa6,bm} (possibly empty subset). There shouldn\'t be equal elements in the subsets.Help the representatives select the sets in such a way that no element is presented in both sets and the total income is the maximum possible."          
              1000.0                         978C Letters "binary search,implementation,two pointers" "There are n dormitories in Berland State University, they are numbered with integers from 1 to n. Each dormitory consists of rooms, there are ai rooms in i-th dormitory. The rooms in i-th dormitory are numbered from 1 to ai.A postman delivers letters. Sometimes there is no specific dormitory and room number in it on an envelope. Instead of it only a room number among all rooms of all n dormitories is written on an envelope. In this case, assume that all the rooms are numbered from 1 to a1+a2+\xe2\x8b\xaf+an and the rooms of the first dormitory go first, the rooms of the second dormitory go after them and so on.For example, in case n=2, a1=3 and a2=5 an envelope can have any integer from 1 to 8 written on it. If the number 7 is written on an envelope, it means that the letter should be delivered to the room number 4 of the second dormitory.For each of m letters by the room number among all n dormitories, determine the particular dormitory and the room number in a dormitory where this letter should be delivered."          
              1500.0                         976C "Nested Segments" greedy,implementation,sortings "You are given a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of one-dimensional segments numbered 1 through n. Your task is to find two distinct indices i and j such that segment ai lies within segment aj.Segment [l1,\xe2\x80\x89r1] lies within segment [l2,\xe2\x80\x89r2] iff l1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89l2 and r1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2.Print indices i and j. If there are multiple answers, print any of them. If no answer exists, print -1 -1."          
              800.0                         976A "Minimum Binary Number" implementation "String can be called correct if it consists of characters ""0"" and ""1"" and there are no redundant leading zeroes. Here are some examples: ""0"", ""10"", ""1001"".You are given a correct string s.You can perform two different operations on this string:   swap any pair of adjacent characters (for example, ""101""  ""110"");  replace ""11"" with ""1"" (for example, ""110""  ""10""). Let val(s) be such a number that s is its binary representation.Correct string a is less than some other correct string b iff val(a)\xe2\x80\x89<\xe2\x80\x89val(b).Your task is to find the minimum correct string that you can obtain from the given one using the operations described above. You can use these operations any number of times in any order (or even use no operations at all)."          
              2600.0                         975E "Hag\'s Khashba" geometry "Hag is a very talented person. He has always had an artist inside him but his father forced him to study mechanical engineering.Yesterday he spent all of his time cutting a giant piece of wood trying to make it look like a goose. Anyway, his dad found out that he was doing arts rather than studying mechanics and other boring subjects. He confronted Hag with the fact that he is a spoiled son that does not care about his future, and if he continues to do arts he will cut his 25 Lira monthly allowance.Hag is trying to prove to his dad that the wooden piece is a project for mechanics subject. He also told his dad that the wooden piece is a strictly convex polygon with nn vertices.Hag brought two pins and pinned the polygon with them in the 11-st and 22-nd vertices to the wall. His dad has qq queries to Hag of two types.   11 ff tt: pull a pin from the vertex ff, wait for the wooden polygon to rotate under the gravity force (if it will rotate) and stabilize. And then put the pin in vertex tt.  22 vv: answer what are the coordinates of the vertex vv. Please help Hag to answer his father\'s queries.You can assume that the wood that forms the polygon has uniform density and the polygon has a positive thickness, same in all points. After every query of the 1-st type Hag\'s dad tries to move the polygon a bit and watches it stabilize again."          
              1100.0                         975B Mancala "brute force,implementation" "Mancala is a game famous in the Middle East. It is played on a board that consists of 14 holes.   Initially, each hole has ai stones. When a player makes a move, he chooses a hole which contains a positive number of stones. He takes all the stones inside it and then redistributes these stones one by one in the next holes in a counter-clockwise direction.Note that the counter-clockwise order means if the player takes the stones from hole i, he will put one stone in the (i+1)-th hole, then in the (i+2)-th, etc. If he puts a stone in the 14-th hole, the next one will be put in the first hole.After the move, the player collects all the stones from holes that contain even number of stones. The number of stones collected by player is the score, according to Resli.Resli is a famous Mancala player. He wants to know the maximum score he can obtain after one move."          
              1100.0                         967A "Mind the Gap" implementation "These days Arkady works as an air traffic controller at a large airport. He controls a runway which is usually used for landings only. Thus, he has a schedule of planes that are landing in the nearest future, each landing lasts 1 minute.He was asked to insert one takeoff in the schedule. The takeoff takes 1 minute itself, but for safety reasons there should be a time space between the takeoff and any landing of at least s minutes from both sides.Find the earliest time when Arkady can insert the takeoff."          
              2000.0                         965C "Greedy Arkady" math "k people want to split n candies between them. Each candy should be given to exactly one of them or be thrown away.The people are numbered from 1 to k, and Arkady is the first of them. To split the candies, Arkady will choose an integer x and then give the first x candies to himself, the next x candies to the second person, the next x candies to the third person and so on in a cycle. The leftover (the remainder that is not divisible by x) will be thrown away.Arkady can\'t choose x greater than M as it is considered greedy. Also, he can\'t choose such a small x that some person will receive candies more than D times, as it is considered a slow splitting.Please find what is the maximum number of candies Arkady can receive by choosing some valid x."          
              800.0                         964A Splits math "Let\'s define a split of n as a nonincreasing sequence of positive integers, the sum of which is n. For example, the following sequences are splits of 8: [4,4], [3,3,2], [2,2,1,1,1,1], [5,2,1].The following sequences aren\'t splits of 8: [1,7], [5,4], [11,\xe2\x88\x923], [1,1,4,1,1].The weight of a split is the number of elements in the split that are equal to the first element. For example, the weight of the split [1,1,1,1,1] is 5, the weight of the split [5,5,3,3,3] is 2 and the weight of the split [9] equals 1.For a given n, find out the number of different weights of its splits."          
              1300.0                         962B "Students in Railway Carriage" "constructive algorithms,greedy,implementation" "There are n consecutive seat places in a railway carriage. Each place is either empty or occupied by a passenger.The university team for the Olympiad consists of a student-programmers and b student-athletes. Determine the largest number of students from all a+b students, which you can put in the railway carriage so that:  no student-programmer is sitting next to the student-programmer;  and no student-athlete is sitting next to the student-athlete. In the other words, there should not be two consecutive (adjacent) places where two student-athletes or two student-programmers are sitting.Consider that initially occupied seat places are occupied by jury members (who obviously are not students at all)."          
              1400.0                         961C Chessboard "bitmasks,brute force,implementation" "Magnus decided to play a classic chess game. Though what he saw in his locker shocked him! His favourite chessboard got broken into 4 pieces, each of size n by n, n is always odd. And what\'s even worse, some squares were of wrong color. j-th square of the i-th row of k-th piece of the board has color ak,\xe2\x80\x89i,\xe2\x80\x89j; 1 being black and 0 being white. Now Magnus wants to change color of some squares in such a way that he recolors minimum number of squares and obtained pieces form a valid chessboard. Every square has its color different to each of the neightbouring by side squares in a valid board. Its size should be 2n by 2n. You are allowed to move pieces but not allowed to rotate or flip them."          
              1700.0                         960C "Subsequence Counting" "bitmasks,constructive algorithms,greedy,implementation" "Pikachu had an array with him. He wrote down all the non-empty subsequences of the array on paper. Note that an array of size n has 2n\xe2\x80\x89-\xe2\x80\x891 non-empty subsequences in it. Pikachu being mischievous as he always is, removed all the subsequences in which Maximum_element_of_the_subsequence \xe2\x80\x89-\xe2\x80\x89 Minimum_element_of_subsequence \xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89dPikachu was finally left with X subsequences. However, he lost the initial array he had, and now is in serious trouble. He still remembers the numbers X and d. He now wants you to construct any such array which will satisfy the above conditions. All the numbers in the final array should be positive integers less than 1018. Note the number of elements in the output array should not be more than 104. If no answer is possible, print \xe2\x80\x89-\xe2\x80\x891."          
              1900.0                         959D "Mahmoud and Ehab and another array construction task" "constructive algorithms,greedy,math,number theory" "Mahmoud has an array a consisting of n integers. He asked Ehab to find another array b of the same length such that:  b is lexicographically greater than or equal to a.  bi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892.  b is pairwise coprime: for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, bi and bj are coprime, i. e. GCD(bi,\xe2\x80\x89bj)\xe2\x80\x89=\xe2\x80\x891, where GCD(w,\xe2\x80\x89z) is the greatest common divisor of w and z. Ehab wants to choose a special array so he wants the lexicographically minimal array between all the variants. Can you find it?An array x is lexicographically greater than an array y if there exists an index i such than xi\xe2\x80\x89>\xe2\x80\x89yi and xj\xe2\x80\x89=\xe2\x80\x89yj for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89i. An array x is equal to an array y if xi\xe2\x80\x89=\xe2\x80\x89yi for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n."          
              2600.0                         955D Scissors "brute force,strings" "Jenya has recently acquired quite a useful tool \xe2\x80\x94 k-scissors for cutting strings. They are generally used for cutting out two non-intersecting substrings of length k from an arbitrary string s (its length should be at least 2\xc2\xb7k in order to perform this operation) and concatenating them afterwards (preserving the initial order). For example, with the help of 2-scissors you can cut ab and de out of abcde and concatenate them into abde, but not ab and bc since they\'re intersecting.It\'s a nice idea to test this tool before using it in practice. After looking through the papers, Jenya came up with two strings s and t. His question is whether it is possible to apply his scissors to string s such that the resulting concatenation contains t as a substring?"          
              1700.0                         954C "Matrix Walk" implementation "There is a matrix A of size x\xe2\x80\x89\xc3\x97\xe2\x80\x89y filled with integers. For every ,  Ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89y(i\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89j. Obviously, every integer from [1..xy] occurs exactly once in this matrix. You have traversed some path in this matrix. Your path can be described as a sequence of visited cells a1, a2, ..., an denoting that you started in the cell containing the number a1, then moved to the cell with the number a2, and so on.From the cell located in i-th line and j-th column (we denote this cell as (i,\xe2\x80\x89j)) you can move into one of the following cells: (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j) \xe2\x80\x94 only if i\xe2\x80\x89<\xe2\x80\x89x;  (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 only if j\xe2\x80\x89<\xe2\x80\x89y;  (i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j) \xe2\x80\x94 only if i\xe2\x80\x89>\xe2\x80\x891;  (i,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891) \xe2\x80\x94 only if j\xe2\x80\x89>\xe2\x80\x891.Notice that making a move requires you to go to an adjacent cell. It is not allowed to stay in the same cell. You don\'t know x and y exactly, but you have to find any possible values for these numbers such that you could start in the cell containing the integer a1, then move to the cell containing a2 (in one step), then move to the cell containing a3 (also in one step) and so on. Can you choose x and y so that they don\'t contradict with your sequence of moves?"          
              900.0                         948A "Protect Sheep" "brute force,dfs and similar,graphs,implementation" "Bob is a farmer. He has a large pasture with many sheep. Recently, he has lost some of them due to wolf attacks. He thus decided to place some shepherd dogs in such a way that all his sheep are protected.The pasture is a rectangle consisting of R\xe2\x80\x89\xc3\x97\xe2\x80\x89C cells. Each cell is either empty, contains a sheep, a wolf or a dog. Sheep and dogs always stay in place, but wolves can roam freely around the pasture, by repeatedly moving to the left, right, up or down to a neighboring cell. When a wolf enters a cell with a sheep, it consumes it. However, no wolf can enter a cell with a dog.Initially there are no dogs. Place dogs onto the pasture in such a way that no wolf can reach any sheep, or determine that it is impossible. Note that since you have many dogs, you do not need to minimize their number."          
              2400.0                         946F "Fibonacci String Subsequences" combinatorics,dp,matrices "You are given a binary string s (each character of this string is either 0 or 1).Let\'s denote the cost of string t as the number of occurences of s in t. For example, if s is 11 and t is 111011, then the cost of t is 3.Let\'s also denote the Fibonacci strings sequence as follows: F(0) is 0; F(1) is 1; F(i)\xe2\x80\x89=\xe2\x80\x89F(i\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89F(i\xe2\x80\x89-\xe2\x80\x892) if i\xe2\x80\x89>\xe2\x80\x891, where \xe2\x80\x89+\xe2\x80\x89 means the concatenation of two strings.Your task is to calculate the sum of costs of all subsequences of the string F(x). Since answer may be large, calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897."          
              2000.0                         938D "Buy a Ticket" "data structures,graphs,shortest paths" "Musicians of a popular band ""Flayer"" have announced that they are going to ""make their exit"" with a world tour. Of course, they will visit Berland as well.There are n cities in Berland. People can travel between cities using two-directional train routes; there are exactly m routes, i-th route can be used to go from city vi to city ui (and from ui to vi), and it costs wi coins to use this route.Each city will be visited by ""Flayer"", and the cost of the concert ticket in i-th city is ai coins.You have friends in every city of Berland, and they, knowing about your programming skills, asked you to calculate the minimum possible number of coins they have to pay to visit the concert. For every city i you have to compute the minimum number of coins a person from city i has to spend to travel to some city j (or possibly stay in city i), attend a concert there, and return to city i (if j\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i).Formally, for every  you have to calculate , where d(i,\xe2\x80\x89j) is the minimum number of coins you have to spend to travel from city i to city j. If there is no way to reach city j from city i, then we consider d(i,\xe2\x80\x89j) to be infinitely large."          
              2100.0                         936B "Sleepy Game" "dfs and similar,dp,games,graphs" "Petya and Vasya arranged a game. The game runs by the following rules. Players have a directed graph consisting of n vertices and m edges. One of the vertices contains a chip. Initially the chip is located at vertex s. Players take turns moving the chip along some edge of the graph. Petya goes first. Player who can\'t move the chip loses. If the game lasts for 106 turns the draw is announced.Vasya was performing big laboratory work in ""Spelling and parts of speech"" at night before the game, so he fell asleep at the very beginning of the game. Petya decided to take the advantage of this situation and make both Petya\'s and Vasya\'s moves.Your task is to help Petya find out if he can win the game or at least draw a tie."          
              2600.0                         935F "Fafa and Array" "data structures,greedy" "Fafa has an array A of n positive integers, the function f(A) is defined as . He wants to do q queries of two types:  1\xe2\x80\x89l\xe2\x80\x89r\xe2\x80\x89x \xe2\x80\x94 find the maximum possible value of f(A), if x is to be added to one element in the range [l,\xe2\x80\x89\xe2\x80\x89r]. You can choose to which element to add x.  2\xe2\x80\x89l\xe2\x80\x89r\xe2\x80\x89x \xe2\x80\x94 increase all the elements in the range [l,\xe2\x80\x89\xe2\x80\x89r] by value x. Note that queries of type 1 don\'t affect the array elements."          
              1900.0                         935D "Fafa and Ancient Alphabet" math,probabilities "Ancient Egyptians are known to have used a large set of symbols  to write on the walls of the temples. Fafa and Fifa went to one of the temples and found two non-empty words S1 and S2 of equal lengths on the wall of temple written one below the other. Since this temple is very ancient, some symbols from the words were erased. The symbols in the set  have equal probability for being in the position of any erased symbol.Fifa challenged Fafa to calculate the probability that S1 is lexicographically greater than S2. Can you help Fafa with this task?You know that , i. e. there were m distinct characters in Egyptians\' alphabet, in this problem these characters are denoted by integers from 1 to m in alphabet order. A word x is lexicographically greater than a word y of the same length, if the words are same up to some position, and then the word x has a larger character, than the word y.We can prove that the probability equals to some fraction , where P and Q are coprime integers, and . Print as the answer the value , i. e. such a non-negative integer less than 109\xe2\x80\x89+\xe2\x80\x897, such that , where  means that a and b give the same remainders when divided by m."          
              900.0                         935B "Fafa and the Gates" implementation "Two neighboring kingdoms decided to build a wall between them with some gates to enable the citizens to go from one kingdom to another. Each time a citizen passes through a gate, he has to pay one silver coin.The world can be represented by the first quadrant of a plane and the wall is built along the identity line (i.e. the line with the equation x\xe2\x80\x89=\xe2\x80\x89y). Any point below the wall belongs to the first kingdom while any point above the wall belongs to the second kingdom. There is a gate at any integer point on the line (i.e. at points (0,\xe2\x80\x890), (1,\xe2\x80\x891), (2,\xe2\x80\x892), ...). The wall and the gates do not belong to any of the kingdoms. Fafa is at the gate at position (0,\xe2\x80\x890) and he wants to walk around in the two kingdoms. He knows the sequence S of moves he will do. This sequence is a string where each character represents a move. The two possible moves Fafa will do are \'U\' (move one step up, from (x,\xe2\x80\x89y) to (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891)) and \'R\' (move one step right, from (x,\xe2\x80\x89y) to (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y)). Fafa wants to know the number of silver coins he needs to pay to walk around the two kingdoms following the sequence S. Note that if Fafa visits a gate without moving from one kingdom to another, he pays no silver coins. Also assume that he doesn\'t pay at the gate at point (0,\xe2\x80\x890), i. e. he is initially on the side he needs."          
              1800.0                         933A "A Twisty Movement" dp "A dragon symbolizes wisdom, power and wealth. On Lunar New Year\'s Day, people model a dragon with bamboo strips and clothes, raise them with rods, and hold the rods high and low to resemble a flying dragon.A performer holding the rod low is represented by a 1, while one holding it high is represented by a 2. Thus, the line of performers can be represented by a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.Little Tommy is among them. He would like to choose an interval [l,\xe2\x80\x89r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), then reverse al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar so that the length of the longest non-decreasing subsequence of the new sequence is maximum.A non-decreasing subsequence is a sequence of indices p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk, such that p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pk and ap1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ap2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89apk. The length of the subsequence is k."          
              2500.0                         930D "Game with Tokens" "data structures,games,implementation" "Consider the following game for two players. There is one white token and some number of black tokens. Each token is placed on a plane in a point with integer coordinates x and y.The players take turn making moves, white starts. On each turn, a player moves all tokens of their color by 1 to up, down, left or right. Black player can choose directions for each token independently.After a turn of the white player the white token can not be in a point where a black token is located. There are no other constraints on locations of the tokens: positions of black tokens can coincide, after a turn of the black player and initially the white token can be in the same point with some black point. If at some moment the white player can\'t make a move, he loses. If the white player makes 10100500 moves, he wins.You are to solve the following problem. You are given initial positions of all black tokens. It is guaranteed that initially all these positions are distinct. In how many places can the white token be located initially so that if both players play optimally, the black player wins?"          
              1500.0                         930A "Peculiar apple-tree" "dfs and similar,graphs,trees" "In Arcady\'s garden there grows a peculiar apple-tree that fruits one time per year. Its peculiarity can be explained in following way: there are n inflorescences, numbered from 1 to n. Inflorescence number 1 is situated near base of tree and any other inflorescence with number i (i\xe2\x80\x89>\xe2\x80\x891) is situated at the top of branch, which bottom is pi-th inflorescence and pi\xe2\x80\x89<\xe2\x80\x89i.Once tree starts fruiting, there appears exactly one apple in each inflorescence. The same moment as apples appear, they start to roll down along branches to the very base of tree. Each second all apples, except ones in first inflorescence simultaneously roll down one branch closer to tree base, e.g. apple in a-th inflorescence gets to pa-th inflorescence. Apples that end up in first inflorescence are gathered by Arcady in exactly the same moment. Second peculiarity of this tree is that once two apples are in same inflorescence they annihilate. This happens with each pair of apples, e.g. if there are 5 apples in same inflorescence in same time, only one will not be annihilated and if there are 8 apples, all apples will be annihilated. Thus, there can be no more than one apple in each inflorescence in each moment of time.Help Arcady with counting number of apples he will be able to collect from first inflorescence during one harvest."          
              1600.0                         926D "Choose Place"  "A classroom in a school has six rows with 3 desks in each row. Two people can use the same desk: one sitting on the left and one sitting on the right. Some places are already occupied, and some places are vacant. Petya has just entered the class and wants to occupy the most convenient place. The conveniences of the places are shown on the picture:  Here, the desks in the top row are the closest to the blackboard, while the desks in the bottom row are the furthest from the blackboard.You are given a plan of the class, where \'*\' denotes an occupied place, \'.\' denotes a vacant place, and the aisles are denoted by \'-\'. Find any of the most convenient vacant places for Petya."          
              3100.0                         925F "Parametric Circulation" "binary search,flows" "Vova has recently learned what a circulaton in a graph is. Recall the definition: let G=(V,E) be a directed graph. A circulation f is such a collection of non-negative real numbers fe (e\xe2\x88\x88E), that for each vertex v\xe2\x88\x88V the following conservation condition holds:\xe2\x88\x91e\xe2\x88\x88\xce\xb4\xe2\x88\x92(v)fe=\xe2\x88\x91e\xe2\x88\x88\xce\xb4+(v)fewhere \xce\xb4+(v) is the set of edges that end in the vertex v, and \xce\xb4\xe2\x88\x92(v) is the set of edges that start in the vertex v. In other words, for each vertex the total incoming flow should be equal to the total outcoming flow.Let a lr-circulation be such a circulation f that for each edge the condition le\xe2\x89\xa4fe\xe2\x89\xa4re holds, where le and re for each edge e\xe2\x88\x88E are two non-negative real numbers denoting the lower and upper bounds on the value of the circulation on this edge e.Vova can\'t stop thinking about applications of a new topic. Right now he thinks about the following natural question: let the graph be fixed, and each value le and re be a linear function of a real variable t:le(t)=aet+be re(t)=cet+deNote that t is the same for all edges.Let t be chosen at random from uniform distribution on a segment [0,1]. What is the probability of existence of lr-circulation in the graph?"          
              2200.0                         925C "Big Secret" "constructive algorithms,math" "Vitya has learned that the answer for The Ultimate Question of Life, the Universe, and Everything is not the integer 54 42, but an increasing integer sequence a1,\xe2\x80\xa6,an. In order to not reveal the secret earlier than needed, Vitya encrypted the answer and obtained the sequence b1,\xe2\x80\xa6,bn using the following rules:  b1=a1; bi=ai\xe2\x8a\x95ai\xe2\x88\x921 for all i from 2 to n, where x\xe2\x8a\x95y is the bitwise XOR of x and y. It is easy to see that the original sequence can be obtained using the rule ai=b1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95bi.However, some time later Vitya discovered that the integers bi in the cypher got shuffled, and it can happen that when decrypted using the rule mentioned above, it can produce a sequence that is not increasing. In order to save his reputation in the scientific community, Vasya decided to find some permutation of integers bi so that the sequence ai=b1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95bi is strictly increasing. Help him find such a permutation or determine that it is impossible."          
              1800.0                         923C "Perfect Security" "data structures,greedy,strings,trees" "Alice has a very important message M consisting of some non-negative integers that she wants to keep secret from Eve. Alice knows that the only theoretically secure cipher is one-time pad. Alice generates a random key K of the length equal to the message\'s length. Alice computes the bitwise xor of each element of the message and the key (, where  denotes the bitwise XOR operation) and stores this encrypted message A. Alice is smart. Be like Alice.For example, Alice may have wanted to store a message M\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x8915,\xe2\x80\x899,\xe2\x80\x8918). She generated a key K\xe2\x80\x89=\xe2\x80\x89(16,\xe2\x80\x897,\xe2\x80\x896,\xe2\x80\x893). The encrypted message is thus A\xe2\x80\x89=\xe2\x80\x89(16,\xe2\x80\x898,\xe2\x80\x8915,\xe2\x80\x8917).Alice realised that she cannot store the key with the encrypted message. Alice sent her key K to Bob and deleted her own copy. Alice is smart. Really, be like Alice.Bob realised that the encrypted message is only secure as long as the key is secret. Bob thus randomly permuted the key before storing it. Bob thinks that this way, even if Eve gets both the encrypted message and the key, she will not be able to read the message. Bob is not smart. Don\'t be like Bob.In the above example, Bob may have, for instance, selected a permutation (3,\xe2\x80\x894,\xe2\x80\x891,\xe2\x80\x892) and stored the permuted key P\xe2\x80\x89=\xe2\x80\x89(6,\xe2\x80\x893,\xe2\x80\x8916,\xe2\x80\x897).One year has passed and Alice wants to decrypt her message. Only now Bob has realised that this is impossible. As he has permuted the key randomly, the message is lost forever. Did we mention that Bob isn\'t smart?Bob wants to salvage at least some information from the message. Since he is not so smart, he asks for your help. You know the encrypted message A and the permuted key P. What is the lexicographically smallest message that could have resulted in the given encrypted text?More precisely, for given A and P, find the lexicographically smallest message O, for which there exists a permutation \xcf\x80 such that  for every i.Note that the sequence S is lexicographically smaller than the sequence T, if there is an index i such that Si\xe2\x80\x89<\xe2\x80\x89Ti and for all j\xe2\x80\x89<\xe2\x80\x89i the condition Sj\xe2\x80\x89=\xe2\x80\x89Tj holds."          
              1600.0                         923B "Producing Snow" "binary search,data structures" "Alice likes snow a lot! Unfortunately, this year\'s winter is already over, and she can\'t expect to have any more of it. Bob has thus bought her a gift \xe2\x80\x94 a large snow maker. He plans to make some amount of snow every day. On day i he will make a pile of snow of volume Vi and put it in her garden.Each day, every pile will shrink a little due to melting. More precisely, when the temperature on a given day is Ti, each pile will reduce its volume by Ti. If this would reduce the volume of a pile to or below zero, it disappears forever. All snow piles are independent of each other. Note that the pile made on day i already loses part of its volume on the same day. In an extreme case, this may mean that there are no piles left at the end of a particular day.You are given the initial pile sizes and the temperature on each day. Determine the total volume of snow melted on each day."          
              1600.0                         922C "Cave Painting" "brute force,number theory" "Imp is watching a documentary about cave painting.  Some numbers, carved in chaotic order, immediately attracted his attention. Imp rapidly proposed a guess that they are the remainders of division of a number n by all integers i from 1 to k. Unfortunately, there are too many integers to analyze for Imp.Imp wants you to check whether all these remainders are distinct. Formally, he wants to check, if all , 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k, are distinct, i. e. there is no such pair (i,\xe2\x80\x89j) that:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k,  , where  is the remainder of division x by y."          
              3200.0                         92106 Labyrinth-6  "See the problem statement here: http://codeforces.com/contest/921/problem/01."          
                                           448D "Multiplication Table" "binary search,brute force" "Bizon the Champion isn\'t just charming, he also is very smart.While some of us were learning the multiplication table, Bizon the Champion had fun in his own manner. Bizon the Champion painted an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m multiplication table, where the element on the intersection of the i-th row and j-th column equals i\xc2\xb7j (the rows and columns of the table are numbered starting from 1). Then he was asked: what number in the table is the k-th largest number? Bizon the Champion always answered correctly and immediately. Can you repeat his success?Consider the given multiplication table. If you write out all n\xc2\xb7m numbers from the table in the non-decreasing order, then the k-th number you write out is called the k-th largest number." 1800.0     
                                           445B "DZY Loves Chemistry" "dfs and similar,dsu,greedy" "DZY loves chemistry, and he enjoys mixing chemicals.DZY has n chemicals, and m pairs of them will react. He wants to pour these chemicals into a test tube, and he needs to pour them in one by one, in any order. Let\'s consider the danger of a test tube. Danger of an empty test tube is 1. And every time when DZY pours a chemical, if there are already one or more chemicals in the test tube that can react with it, the danger of the test tube will be multiplied by 2. Otherwise the danger remains as it is.Find the maximum possible danger after pouring all the chemicals one by one in optimal order." 1400.0     
                                           442C "Artem and Array" "data structures,greedy" "Artem has an array of n positive integers. Artem decided to play with it. The game consists of n moves. Each move goes like this. Artem chooses some element of the array and removes it. For that, he gets min(a,\xe2\x80\x89b) points, where a and b are numbers that were adjacent with the removed number. If the number doesn\'t have an adjacent number to the left or right, Artem doesn\'t get any points. After the element is removed, the two parts of the array glue together resulting in the new array that Artem continues playing with. Borya wondered what maximum total number of points Artem can get as he plays this game." 2500.0     
                                           442B "Andrey and Problem" greedy,math,probabilities "Andrey needs one more problem to conduct a programming contest. He has n friends who are always willing to help. He can ask some of them to come up with a contest problem. Andrey knows one value for each of his fiends \xe2\x80\x94 the probability that this friend will come up with a problem if Andrey asks him.Help Andrey choose people to ask. As he needs only one problem, Andrey is going to be really upset if no one comes up with a problem or if he gets more than one problem from his friends. You need to choose such a set of people that maximizes the chances of Andrey not getting upset." 1800.0     
                                           442A "Borya and Hanabi" "bitmasks,brute force,implementation" "Have you ever played Hanabi? If not, then you\'ve got to try it out! This problem deals with a simplified version of the game.Overall, the game has 25 types of cards (5 distinct colors and 5 distinct values). Borya is holding n cards. The game is somewhat complicated by the fact that everybody sees Borya\'s cards except for Borya himself. Borya knows which cards he has but he knows nothing about the order they lie in. Note that Borya can have multiple identical cards (and for each of the 25 types of cards he knows exactly how many cards of this type he has).The aim of the other players is to achieve the state when Borya knows the color and number value of each of his cards. For that, other players can give him hints. The hints can be of two types: color hints and value hints. A color hint goes like that: a player names some color and points at all the cards of this color. Similarly goes the value hint. A player names some value and points at all the cards that contain the value.Determine what minimum number of hints the other players should make for Borya to be certain about each card\'s color and value." 1700.0     
                                           441D "Valera and Swaps" "constructive algorithms,dsu,graphs,implementation,math,string suffix structures" "A permutation p of length n is a sequence of distinct integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). A permutation is an identity permutation, if for any i the following equation holds pi\xe2\x80\x89=\xe2\x80\x89i. A swap (i,\xe2\x80\x89j) is the operation that swaps elements pi and pj in the permutation. Let\'s assume that f(p) is the minimum number of swaps that you need to make the permutation p an identity permutation. Valera wonders, how he can transform permutation p into any permutation q, such that f(q)\xe2\x80\x89=\xe2\x80\x89m, using the minimum number of swaps. Help him do that." 2100.0     
                                           441B "Valera and Fruits" greedy,implementation "Valera loves his garden, where n fruit trees grow.This year he will enjoy a great harvest! On the i-th tree bi fruit grow, they will ripen on a day number ai. Unfortunately, the fruit on the tree get withered, so they can only be collected on day ai and day ai\xe2\x80\x89+\xe2\x80\x891 (all fruits that are not collected in these two days, become unfit to eat).Valera is not very fast, but there are some positive points. Valera is ready to work every day. In one day, Valera can collect no more than v fruits. The fruits may be either from the same tree, or from different ones. What is the maximum amount of fruit Valera can collect for all time, if he operates optimally well?" 1400.0     
                                           437B "The Child and Set" bitmasks,greedy,implementation,sortings "At the children\'s day, the child came to Picks\'s house, and messed his house up. Picks was angry at him. A lot of important things were lost, in particular the favorite set of Picks.Fortunately, Picks remembers something about his set S:  its elements were distinct integers from 1 to limit;  the value of  was equal to sum; here lowbit(x) equals 2k where k is the position of the first one in the binary representation of x. For example, lowbit(100102)\xe2\x80\x89=\xe2\x80\x89102,\xe2\x80\x89lowbit(100012)\xe2\x80\x89=\xe2\x80\x8912,\xe2\x80\x89lowbit(100002)\xe2\x80\x89=\xe2\x80\x89100002 (binary representation). Can you help Picks and find any set S, that satisfies all the above conditions?" 1500.0     
                                           435E "Special Graph"  "In this problem you will need to deal with an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid graph. The graph\'s vertices are the nodes of the n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid. The graph\'s edges are all the sides and diagonals of the grid\'s unit squares.The figure below shows a 3\xe2\x80\x89\xc3\x97\xe2\x80\x895 graph. The black lines are the graph\'s edges, the colored circles are the graph\'s vertices. The vertices of the graph are painted on the picture for a reason: the coloring is a correct vertex coloring of the 3\xe2\x80\x89\xc3\x97\xe2\x80\x895 graph into four colors. A graph coloring is correct if and only if each vertex is painted and no two vertices connected by an edge are painted the same color.  You are given the size of the grid graph n\xe2\x80\x89\xc3\x97\xe2\x80\x89m and the colors of some of its vertices. Find any way how to paint the unpainted vertices of the graph in 4 colors to make the final coloring a correct vertex graph coloring. If there is no such correct vertex coloring, say that the answer doesn\'t exist." 2500.0     
                                           433C "Ryouko\'s Memory Note" implementation,math,sortings "Ryouko is an extremely forgetful girl, she could even forget something that has just happened. So in order to remember, she takes a notebook with her, called Ryouko\'s Memory Note. She writes what she sees and what she hears on the notebook, and the notebook became her memory.Though Ryouko is forgetful, she is also born with superb analyzing abilities. However, analyzing depends greatly on gathered information, in other words, memory. So she has to shuffle through her notebook whenever she needs to analyze, which is tough work.Ryouko\'s notebook consists of n pages, numbered from 1 to n. To make life (and this problem) easier, we consider that to turn from page x to page y, |x\xe2\x80\x89-\xe2\x80\x89y| pages should be turned. During analyzing, Ryouko needs m pieces of information, the i-th piece of information is on page ai. Information must be read from the notebook in order, so the total number of pages that Ryouko needs to turn is .Ryouko wants to decrease the number of pages that need to be turned. In order to achieve this, she can merge two pages of her notebook. If Ryouko merges page x to page y, she would copy all the information on page x to y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), and consequently, all elements in sequence a that was x would become y. Note that x can be equal to y, in which case no changes take place.Please tell Ryouko the minimum number of pages that she needs to turn. Note she can apply the described operation at most once before the reading. Note that the answer can exceed 32-bit integers." 1800.0     
                                           433B "Kuriyama Mirai\'s Stones" dp,implementation,sortings "Kuriyama Mirai has killed many monsters and got many (namely n) stones. She numbers the stones from 1 to n. The cost of the i-th stone is vi. Kuriyama Mirai wants to know something about these stones so she will ask you two kinds of questions:  She will tell you two numbers, l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), and you should tell her .  Let ui be the cost of the i-th cheapest stone (the cost that will be on the i-th place if we arrange all the stone costs in non-decreasing order). This time she will tell you two numbers, l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), and you should tell her . For every question you should give the correct answer, or Kuriyama Mirai will say ""fuyukai desu"" and then become unhappy." 1200.0     
                                           432A "Choosing Teams" greedy,implementation,sortings "The Saratov State University Olympiad Programmers Training Center (SSU OPTC) has n students. For each student you know the number of times he/she has participated in the ACM ICPC world programming championship. According to the ACM ICPC rules, each person can participate in the world championship at most 5 times.The head of the SSU OPTC is recently gathering teams to participate in the world championship. Each team must consist of exactly three people, at that, any person cannot be a member of two or more teams. What maximum number of teams can the head make if he wants each team to participate in the world championship with the same members at least k times?" 800.0     
                                           413D 2048 bitmasks,dp "The programmers from the R2 company love playing 2048. One day, they decided to invent their own simplified version of this game \xe2\x80\x94 2k on a stripe.Imagine an infinite in one direction stripe, consisting of unit squares (the side of each square is equal to the height of the stripe). Each square can either be empty or contain some number.Initially, all squares are empty. Then at infinity one of the unit squares number 2 or 4 appears. Then the player presses a button once, and the appeared number begins to move towards the beginning of the stripe. Let\'s assume that some number x moves to the beginning of the stripe, then it will stop if:  it either gets in the first square of the stripe;  or it is in the square that is preceded by a square with number y (y\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x). But if number x at some point of time gets to the square with the same number then both numbers add to each other and result in 2x. The new number 2x continues moving to the beginning of the stripe by the same rules. After the final stop of the number moving process, the infinity gets a new number 2 or 4 and the process repeats. Read the notes to the test samples to better understand the moving strategy.I guess you\'ve understood that the game progress fully depends on the order in which numbers 2 and 4 appear. Let\'s look at some sequence of numbers 2 and 4 in the game. We assume that the sequence is winning if it results in at least one square getting the number greater or equal than 2k. The goal of the game is to make up a winning sequence of n numbers. But not everything is so simple, some numbers in the sequence are identified beforehand. You are given a sequence consisting of numbers 0, 2, 4. Count how many ways there are to replace each 0 of the sequence with 2 or 4 to get a winning sequence." 2000.0     
                                           409G "On a plane" "*special problem,geometry" "InputThe first line contains a single integer n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891000) \xe2\x80\x94 the number of points on a plane.Each of the next n lines contains two real coordinates xi and yi of the  point, specified with exactly 2 fractional digits. All coordinates are between \xe2\x80\x89-\xe2\x80\x891000 and 1000, inclusive.OutputOutput a single real number \xce\xb8 \xe2\x80\x94 the answer to the problem statement. The absolute or relative error of your answer should be at most 10\xe2\x80\x89-\xe2\x80\x892.ExamplesInputCopy8-2.14 2.06-1.14 2.04-2.16 1.46-2.14 0.70-1.42 0.40-0.94 -0.48-1.42 -1.28-2.16 -1.62OutputCopy5.410InputCopy52.26 1.442.28 0.642.30 -0.301.58 0.663.24 0.66OutputCopy5.620InputCopy86.98 2.066.40 1.125.98 0.245.54 -0.607.16 0.307.82 1.248.34 0.248.74 -0.76OutputCopy5.480InputCopy510.44 2.0610.90 0.8011.48 -0.4812.06 0.7612.54 2.06OutputCopy6.040InputCopy816.94 2.4215.72 2.3814.82 1.5814.88 0.5015.76 -0.1616.86 -0.2017.00 0.8816.40 0.92OutputCopy6.040InputCopy720.62 3.0021.06 2.2821.56 1.3621.66 0.5621.64 -0.5222.14 2.3222.62 3.04OutputCopy6.720" 2200.0     
                                           409F 000001 "*special problem" "InputThe input contains a single integer a (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8964).OutputOutput a single integer.ExamplesInputCopy2OutputCopy1InputCopy4OutputCopy2InputCopy27OutputCopy5InputCopy42OutputCopy6" 1900.0     
                                           407E k-d-sequence "data structures" "We\'ll call a sequence of integers a good k-d sequence if we can add to it at most k numbers in such a way that after the sorting the sequence will be an arithmetic progression with difference d.You got hold of some sequence a, consisting of n integers. Your task is to find its longest contiguous subsegment, such that it is a good k-d sequence." 3100.0     
                                           407D "Largest Submatrix 3" dp,hashing "You are given matrix a of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, its elements are integers. We will assume that the rows of the matrix are numbered from top to bottom from 1 to n, the columns are numbered from left to right from 1 to m. We will denote the element on the intersecting of the i-th row and the j-th column as aij.We\'ll call submatrix i1,\xe2\x80\x89j1,\xe2\x80\x89i2,\xe2\x80\x89j2 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) such elements aij of the given matrix that i1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i2 AND j1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j2. We\'ll call the area of the submatrix number (i2\xe2\x80\x89-\xe2\x80\x89i1\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(j2\xe2\x80\x89-\xe2\x80\x89j1\xe2\x80\x89+\xe2\x80\x891). We\'ll call a submatrix inhomogeneous, if all its elements are distinct.Find the largest (in area) inhomogenous submatrix of the given matrix." 2700.0     
                                           407A Triangle "brute force,geometry,implementation,math" "There is a right triangle with legs of length a and b. Your task is to determine whether it is possible to locate the triangle on the plane in such a way that none of its sides is parallel to the coordinate axes. All the vertices must have integer coordinates. If there exists such a location, you have to output the appropriate coordinates of vertices." 1600.0     
                                           404B Marathon implementation,math "Valera takes part in the Berland Marathon. The marathon race starts at the stadium that can be represented on the plane as a square whose lower left corner is located at point with coordinates (0,\xe2\x80\x890) and the length of the side equals a meters. The sides of the square are parallel to coordinate axes.As the length of the marathon race is very long, Valera needs to have extra drink during the race. The coach gives Valera a bottle of drink each d meters of the path. We know that Valera starts at the point with coordinates (0,\xe2\x80\x890) and runs counter-clockwise. That is, when Valera covers a meters, he reaches the point with coordinates (a,\xe2\x80\x890). We also know that the length of the marathon race equals nd\xe2\x80\x89+\xe2\x80\x890.5 meters. Help Valera\'s coach determine where he should be located to help Valera. Specifically, determine the coordinates of Valera\'s positions when he covers d,\xe2\x80\x892\xc2\xb7d,\xe2\x80\x89...,\xe2\x80\x89n\xc2\xb7d meters." 1500.0     
                                           400B "Inna and New Matrix of Candies" "brute force,implementation,schedules" "Inna likes sweets and a game called the ""Candy Matrix"". Today, she came up with the new game ""Candy Matrix 2: Reload"".The field for the new game is a rectangle table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each line of the table contains one cell with a dwarf figurine, one cell with a candy, the other cells of the line are empty. The game lasts for several moves. During each move the player should choose all lines of the matrix where dwarf is not on the cell with candy and shout ""Let\'s go!"". After that, all the dwarves from the chosen lines start to simultaneously move to the right. During each second, each dwarf goes to the adjacent cell that is located to the right of its current cell. The movement continues until one of the following events occurs:  some dwarf in one of the chosen lines is located in the rightmost cell of his row;  some dwarf in the chosen lines is located in the cell with the candy. The point of the game is to transport all the dwarves to the candy cells.Inna is fabulous, as she came up with such an interesting game. But what about you? Your task is to play this game optimally well. Specifically, you should say by the given game field what minimum number of moves the player needs to reach the goal of the game." 1200.0     
                                           398B "Painting The Wall" dp,probabilities "User ainta decided to paint a wall. The wall consists of n2 tiles, that are arranged in an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table. Some tiles are painted, and the others are not. As he wants to paint it beautifully, he will follow the rules below.  Firstly user ainta looks at the wall. If there is at least one painted cell on each row and at least one painted cell on each column, he stops coloring. Otherwise, he goes to step 2.  User ainta choose any tile on the wall with uniform probability.  If the tile he has chosen is not painted, he paints the tile. Otherwise, he ignores it.  Then he takes a rest for one minute even if he doesn\'t paint the tile. And then ainta goes to step 1.   However ainta is worried if it would take too much time to finish this work. So he wants to calculate the expected time needed to paint the wall by the method above. Help him find the expected time. You can assume that choosing and painting any tile consumes no time at all." -999.0     
                                           394E "Lightbulb for Minister" geometry "The Minister for education is coming! Naturally, nobody wants to perform poorly in front of such a honored guest. However, two hours before the arrival it turned out that one of the classes has a malfunctioning lightbulb \xe2\x80\x94 for some reason it doesn\'t get enough energy. The solution was found quickly: all we\'ve got to do is to change the location of the lightbulb so that it got the maximum amount of energy.Everybody knows that the power of the lightbulb equals , where C is some constant value and ri is the Euclidean distance from the bulb to the i-th generator. Consequently, our task is to minimize . Of course, we know the positions of all generators.The bulb should be on the ceiling of the class. The ceiling of the class is in the form of a strictly convex m-gon (the class itself has the form of a right prism with a strictly convex m-gon at the bottom). Help to find the optimum location for the bulb. Assume that all generators are in the plane of the class ceiling. Consider that the plane of the class ceiling has some Cartesian coordinate system introduced." -999.0     
                                           391B "Word Folding" "brute force" "You will receive 5 points for solving this problem.Manao has invented a new operation on strings that is called folding. Each fold happens between a pair of consecutive letters and places the second part of the string above first part, running in the opposite direction and aligned to the position of the fold. Using this operation, Manao converts the string into a structure that has one more level than there were fold operations performed. See the following examples for clarity.We will denote the positions of folds with \'|\' characters. For example, the word ""ABRACADABRA"" written as ""AB|RACA|DAB|RA"" indicates that it has been folded three times: first, between the leftmost pair of \'B\' and \'R\' letters; second, between \'A\' and \'D\'; and third, between the rightmost pair of \'B\' and \'R\' letters. Here are several examples of folded strings:""ABCDEF|GHIJK"" |  ""A|BCDEFGHIJK"" |  ""AB|RACA|DAB|RA"" |  ""X|XXXXX|X|X|XXXXXX""               |                 |                   |       XXXXXX    KJIHG      |   KJIHGFEDCB    |      AR           |       X   ABCDEF      |            A    |     DAB           |       X               |                 |     ACAR          |       XXXXX               |                 |       AB          |           XOne last example for ""ABCD|EFGH|IJ|K"":  KIJHGFEABCDManao noticed that each folded string can be viewed as several piles of letters. For instance, in the previous example, there are four piles, which can be read as ""AHI"", ""BGJK"", ""CF"", and ""DE"" from bottom to top. Manao wonders what is the highest pile of identical letters he can build using fold operations on a given word. Note that the pile should not contain gaps and should start at the bottom level. For example, in the rightmost of the four examples above, none of the piles would be considered valid since each of them has gaps, starts above the bottom level, or both." -999.0     
                                           390A "Inna and Alarm Clock" implementation "Inna loves sleeping very much, so she needs n alarm clocks in total to wake up. Let\'s suppose that Inna\'s room is a 100\xe2\x80\x89\xc3\x97\xe2\x80\x89100 square with the lower left corner at point (0,\xe2\x80\x890) and with the upper right corner at point (100,\xe2\x80\x89100). Then the alarm clocks are points with integer coordinates in this square.The morning has come. All n alarm clocks in Inna\'s room are ringing, so Inna wants to turn them off. For that Inna has come up with an amusing game:  First Inna chooses a type of segments that she will use throughout the game. The segments can be either vertical or horizontal.  Then Inna makes multiple moves. In a single move, Inna can paint a segment of any length on the plane, she chooses its type at the beginning of the game (either vertical or horizontal), then all alarm clocks that are on this segment switch off. The game ends when all the alarm clocks are switched off. Inna is very sleepy, so she wants to get through the alarm clocks as soon as possible. Help her, find the minimum number of moves in the game that she needs to turn off all the alarm clocks!" -999.0     
                                           388D "Fox and Perfect Sets" math "Fox Ciel studies number theory.She thinks a non-empty set S contains non-negative integers is perfect if and only if for any  (a can be equal to b), . Where operation xor means exclusive or operation (http://en.wikipedia.org/wiki/Exclusive_or).Please calculate the number of perfect sets consisting of integers not greater than k. The answer can be very large, so print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2700.0     
                                           388C "Fox and Card Game" games,greedy,sortings "Fox Ciel is playing a card game with her friend Fox Jiro. There are n piles of cards on the table. And there is a positive integer on each card.The players take turns and Ciel takes the first turn. In Ciel\'s turn she takes a card from the top of any non-empty pile, and in Jiro\'s turn he takes a card from the bottom of any non-empty pile. Each player wants to maximize the total sum of the cards he took. The game ends when all piles become empty.Suppose Ciel and Jiro play optimally, what is the score of the game?" 2000.0     
                                           385E "Bear in the Field" math,matrices "Our bear\'s forest has a checkered field. The checkered field is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table, the rows are numbered from 1 to n from top to bottom, the columns are numbered from 1 to n from left to right. Let\'s denote a cell of the field on the intersection of row x and column y by record (x,\xe2\x80\x89y). Each cell of the field contains growing raspberry, at that, the cell (x,\xe2\x80\x89y) of the field contains x\xe2\x80\x89+\xe2\x80\x89y raspberry bushes.The bear came out to walk across the field. At the beginning of the walk his speed is (dx,\xe2\x80\x89dy). Then the bear spends exactly t seconds on the field. Each second the following takes place:  Let\'s suppose that at the current moment the bear is in cell (x,\xe2\x80\x89y).  First the bear eats the raspberry from all the bushes he has in the current cell. After the bear eats the raspberry from k bushes, he increases each component of his speed by k. In other words, if before eating the k bushes of raspberry his speed was (dx,\xe2\x80\x89dy), then after eating the berry his speed equals (dx\xe2\x80\x89+\xe2\x80\x89k,\xe2\x80\x89dy\xe2\x80\x89+\xe2\x80\x89k).  Let\'s denote the current speed of the bear (dx,\xe2\x80\x89dy) (it was increased after the previous step). Then the bear moves from cell (x,\xe2\x80\x89y) to cell (((x\xe2\x80\x89+\xe2\x80\x89dx\xe2\x80\x89-\xe2\x80\x891) mod n)\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89((y\xe2\x80\x89+\xe2\x80\x89dy\xe2\x80\x89-\xe2\x80\x891) mod n)\xe2\x80\x89+\xe2\x80\x891).  Then one additional raspberry bush grows in each cell of the field. You task is to predict the bear\'s actions. Find the cell he ends up in if he starts from cell (sx,\xe2\x80\x89sy). Assume that each bush has infinitely much raspberry and the bear will never eat all of it." 2300.0     
                                           385D "Bear and Floodlight" bitmasks,dp,geometry "One day a bear lived on the Oxy axis. He was afraid of the dark, so he couldn\'t move at night along the plane points that aren\'t lit. One day the bear wanted to have a night walk from his house at point (l,\xe2\x80\x890) to his friend\'s house at point (r,\xe2\x80\x890), along the segment of length (r\xe2\x80\x89-\xe2\x80\x89l). Of course, if he wants to make this walk, he needs each point of the segment to be lit. That\'s why the bear called his friend (and yes, in the middle of the night) asking for a very delicate favor.The Oxy axis contains n floodlights. Floodlight i is at point (xi,\xe2\x80\x89yi) and can light any angle of the plane as large as ai degree with vertex at point (xi,\xe2\x80\x89yi). The bear asked his friend to turn the floodlights so that he (the bear) could go as far away from his house as possible during the walking along the segment. His kind friend agreed to fulfill his request. And while he is at it, the bear wonders: what is the furthest he can go away from his house? Hep him and find this distance.Consider that the plane has no obstacles and no other light sources besides the floodlights. The bear\'s friend cannot turn the floodlights during the bear\'s walk. Assume that after all the floodlights are turned in the correct direction, the bear goes for a walk and his friend goes to bed." 2200.0     
                                           383E Vowels "combinatorics,divide and conquer,dp" "Iahubina is tired of so many complicated languages, so she decided to invent a new, simple language. She already made a dictionary consisting of n 3-words. A 3-word is a sequence of exactly 3 lowercase letters of the first 24 letters of the English alphabet (a to x). She decided that some of the letters are vowels, and all the others are consonants. The whole language is based on a simple rule: any word that contains at least one vowel is correct.Iahubina forgot which letters are the vowels, and wants to find some possible correct sets of vowels. She asks Iahub questions. In each question, she will give Iahub a set of letters considered vowels (in this question). For each question she wants to know how many words of the dictionary are correct, considering the given set of vowels.Iahubina wants to know the xor of the squared answers to all the possible questions. There are 224 different questions, they are all subsets of the set of the first 24 letters of the English alphabet. Help Iahub find that number." 2700.0     
                                           383B Volcanoes "binary search,implementation,sortings,two pointers" "Iahub got lost in a very big desert. The desert can be represented as a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square matrix, where each cell is a zone of the desert. The cell (i,\xe2\x80\x89j) represents the cell at row i and column j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Iahub can go from one cell (i,\xe2\x80\x89j) only down or right, that is to cells (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j) or (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891). Also, there are m cells that are occupied by volcanoes, which Iahub cannot enter. Iahub is initially at cell (1,\xe2\x80\x891) and he needs to travel to cell (n,\xe2\x80\x89n). Knowing that Iahub needs 1 second to travel from one cell to another, find the minimum time in which he can arrive in cell (n,\xe2\x80\x89n)." 2500.0     
                                           377B "Preparing for the Contest" "binary search,data structures,greedy,sortings" "Soon there will be held the world\'s largest programming contest, but the testing system still has m bugs. The contest organizer, a well-known university, has no choice but to attract university students to fix all the bugs. The university has n students able to perform such work. The students realize that they are the only hope of the organizers, so they don\'t want to work for free: the i-th student wants to get ci \'passes\' in his subjects (regardless of the volume of his work).Bugs, like students, are not the same: every bug is characterized by complexity aj, and every student has the level of his abilities bi. Student i can fix a bug j only if the level of his abilities is not less than the complexity of the bug: bi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89aj, and he does it in one day. Otherwise, the bug will have to be fixed by another student. Of course, no student can work on a few bugs in one day. All bugs are not dependent on each other, so they can be corrected in any order, and different students can work simultaneously.The university wants to fix all the bugs as quickly as possible, but giving the students the total of not more than s passes. Determine which students to use for that and come up with the schedule of work saying which student should fix which bug." 1900.0     
                                           374B "Inna and Nine" combinatorics,greedy "Inna loves digit 9 very much. That\'s why she asked Dima to write a small number consisting of nines. But Dima must have misunderstood her and he wrote a very large number a, consisting of digits from 1 to 9.Inna wants to slightly alter the number Dima wrote so that in the end the number contained as many digits nine as possible. In one move, Inna can choose two adjacent digits in a number which sum equals 9 and replace them by a single digit 9.For instance, Inna can alter number 14545181 like this: 14545181\xe2\x80\x89\xe2\x86\x92\xe2\x80\x891945181\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89194519\xe2\x80\x89\xe2\x86\x92\xe2\x80\x8919919. Also, she can use this method to transform number 14545181 into number 19991. Inna will not transform it into 149591 as she can get numbers 19919 and 19991 which contain more digits nine.Dima is a programmer so he wants to find out how many distinct numbers containing as many digits nine as possible Inna can get from the written number. Help him with this challenging task." 1500.0     
                                           373A "Collecting Beats is Fun" implementation "Cucumber boy is fan of Kyubeat, a famous music game.Kyubeat has 16 panels for playing arranged in 4\xe2\x80\x89\xc3\x97\xe2\x80\x894 table. When a panel lights up, he has to press that panel.Each panel has a timing to press (the preffered time when a player should press it), and Cucumber boy is able to press at most k panels in a time with his one hand. Cucumber boy is trying to press all panels in perfect timing, that is he wants to press each panel exactly in its preffered time. If he cannot press the panels with his two hands in perfect timing, his challenge to press all the panels in perfect timing will fail.You are given one scene of Kyubeat\'s panel from the music Cucumber boy is trying. Tell him is he able to press all the panels in perfect timing." 900.0     
                                           372D "Choosing Subtree is Fun" "binary search,data structures,dfs and similar,trees,two pointers" "There is a tree consisting of n vertices. The vertices are numbered from 1 to n.Let\'s define the length of an interval [l,\xe2\x80\x89r] as the value r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891. The score of a subtree of this tree is the maximum length of such an interval [l,\xe2\x80\x89r] that, the vertices with numbers l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r belong to the subtree.Considering all subtrees of the tree whose size is at most k, return the maximum score of the subtree. Note, that in this problem tree is not rooted, so a subtree \xe2\x80\x94 is an arbitrary connected subgraph of the tree." 2600.0     
                                           371D Vessels "data structures,dsu,implementation,trees" "There is a system of n vessels arranged one above the other as shown in the figure below. Assume that the vessels are numbered from 1 to n, in the order from the highest to the lowest, the volume of the i-th vessel is ai liters.  Initially, all the vessels are empty. In some vessels water is poured. All the water that overflows from the i-th vessel goes to the (i\xe2\x80\x89+\xe2\x80\x891)-th one. The liquid that overflows from the n-th vessel spills on the floor.Your task is to simulate pouring water into the vessels. To do this, you will need to handle two types of queries:  Add xi liters of water to the pi-th vessel;  Print the number of liters of water in the ki-th vessel. When you reply to the second request you can assume that all the water poured up to this point, has already overflown between the vessels." 1800.0     
                                           369C "Valera and Elections" "dfs and similar,graphs,trees" "The city Valera lives in is going to hold elections to the city Parliament.The city has n districts and n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. We know that from any district there is a path along the roads to any other district. Let\'s enumerate all districts in some way by integers from 1 to n, inclusive. Furthermore, for each road the residents decided if it is the problem road or not. A problem road is a road that needs to be repaired.There are n candidates running the elections. Let\'s enumerate all candidates in some way by integers from 1 to n, inclusive. If the candidate number i will be elected in the city Parliament, he will perform exactly one promise \xe2\x80\x94 to repair all problem roads on the way from the i-th district to the district 1, where the city Parliament is located.Help Valera and determine the subset of candidates such that if all candidates from the subset will be elected to the city Parliament, all problem roads in the city will be repaired. If there are several such subsets, you should choose the subset consisting of the minimum number of candidates." 1600.0     
                                           364D Ghd "brute force,math,probabilities" "John Doe offered his sister Jane Doe find the gcd of some set of numbers a.Gcd is a positive integer g, such that all number from the set are evenly divisible by g and there isn\'t such g\' (g\'\xe2\x80\x89>\xe2\x80\x89g), that all numbers of the set are evenly divisible by g\'.Unfortunately Jane couldn\'t cope with the task and John offered her to find the ghd of the same subset of numbers.Ghd is a positive integer g, such that at least half of numbers from the set are evenly divisible by g and there isn\'t such g\' (g\'\xe2\x80\x89>\xe2\x80\x89g) that at least half of the numbers from the set are evenly divisible by g\'.Jane coped with the task for two hours. Please try it, too." 2900.0     
                                           361A "Levko and Table" "constructive algorithms,implementation" "Levko loves tables that consist of n rows and n columns very much. He especially loves beautiful tables. A table is beautiful to Levko if the sum of elements in each row and column of the table equals k.Unfortunately, he doesn\'t know any such table. Your task is to help him to find at least one of them." 800.0     
                                           355A "Vasya and Digital Root" "constructive algorithms,implementation" "Vasya has recently found out what a digital root of a number is and he decided to share his knowledge with you.Let\'s assume that S(n) is the sum of digits of number n, for example, S(4098)\xe2\x80\x89=\xe2\x80\x894\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x899\xe2\x80\x89+\xe2\x80\x898\xe2\x80\x89=\xe2\x80\x8921. Then the digital root of number n equals to:   dr(n)\xe2\x80\x89=\xe2\x80\x89S(n), if S(n)\xe2\x80\x89<\xe2\x80\x8910;  dr(n)\xe2\x80\x89=\xe2\x80\x89dr(\xe2\x80\x89S(n)\xe2\x80\x89), if S(n)\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x8910. For example, dr(4098)\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89dr(21)\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x893.Vasya is afraid of large numbers, so the numbers he works with are at most 101000. For all such numbers, he has proved that dr(n)\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89S(\xe2\x80\x89S(\xe2\x80\x89S(\xe2\x80\x89S(n)\xe2\x80\x89)\xe2\x80\x89)\xe2\x80\x89) (n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89101000).Now Vasya wants to quickly find numbers with the given digital root. The problem is, he hasn\'t learned how to do that and he asked you to help him. You task is, given numbers k and d, find the number consisting of exactly k digits (the leading zeroes are not allowed), with digital root equal to d, or else state that such number does not exist." 1100.0     
                                           352A "Jeff and Digits" "brute force,implementation,math" "Jeff\'s got n cards, each card contains either digit 0, or digit 5. Jeff can choose several cards and put them in a line so that he gets some number. What is the largest possible number divisible by 90 Jeff can make from the cards he\'s got?Jeff must make the number without leading zero. At that, we assume that number 0 doesn\'t contain any leading zeroes. Jeff doesn\'t have to use all the cards." 1000.0     
                                           347A "Difference Row" "constructive algorithms,implementation,sortings" "You want to arrange n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an in some order in a row. Let\'s define the value of an arrangement as the sum of differences between all pairs of adjacent integers.More formally, let\'s denote some arrangement as a sequence of integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn, where sequence x is a permutation of sequence a. The value of such an arrangement is (x1\xe2\x80\x89-\xe2\x80\x89x2)\xe2\x80\x89+\xe2\x80\x89(x2\xe2\x80\x89-\xe2\x80\x89x3)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89(xn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89xn).Find the largest possible value of an arrangement. Then, output the lexicographically smallest sequence x that corresponds to an arrangement of the largest possible value." 1300.0     
                                           346B "Lucky Common Subsequence" dp,strings "In mathematics, a subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements. For example, the sequence BDF is a subsequence of ABCDEF. A substring of a string is a continuous subsequence of the string. For example, BCD is a substring of ABCDEF.You are given two strings s1, s2 and another string called virus. Your task is to find the longest common subsequence of s1 and s2, such that it doesn\'t contain virus as a substring." 2000.0     
                                           336B "Vasily the Bear and Fly" math "One beautiful day Vasily the bear painted 2m circles of the same radius R on a coordinate plane. Circles with numbers from 1 to m had centers at points (2R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x890), (4R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x890), ..., (2Rm\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x890), respectively. Circles with numbers from m\xe2\x80\x89+\xe2\x80\x891 to 2m had centers at points (2R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x892R), (4R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x892R), ..., (2Rm\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x892R), respectively. Naturally, the bear painted the circles for a simple experiment with a fly. The experiment continued for m2 days. Each day of the experiment got its own unique number from 0 to m2\xe2\x80\x89-\xe2\x80\x891, inclusive. On the day number i the following things happened:   The fly arrived at the coordinate plane at the center of the circle with number  ( is the result of dividing number x by number y, rounded down to an integer).  The fly went along the coordinate plane to the center of the circle number  ( is the remainder after dividing number x by number y). The bear noticed that the fly went from the center of circle v to the center of circle u along the shortest path with all points lying on the border or inside at least one of the 2m circles. After the fly reached the center of circle u, it flew away in an unknown direction. Help Vasily, count the average distance the fly went along the coordinate plane during each of these m2 days." 1900.0     
                                           332E "Binary Key" dp,greedy,implementation "Let\'s assume that p and q are strings of positive length, called the container and the key correspondingly, string q only consists of characters 0 and 1. Let\'s take a look at a simple algorithm that extracts message s from the given container p:i = 0;j = 0;s = <>;while i is less than the length of the string p{    if q[j] == 1, then add to the right of string s character p[i];    increase variables i, j by one;    if the value of the variable j equals the length of the string q, then j = 0; }In the given pseudocode i, j are integer variables, s is a string, \'=\' is an assignment operator, \'==\' is a comparison operation, \'[]\' is the operation of obtaining the string character with the preset index, \'<>\' is an empty string. We suppose that in all strings the characters are numbered starting from zero. We understand that implementing such algorithm is quite easy, so your task is going to be slightly different. You need to construct the lexicographically minimum key of length k, such that when it is used, the algorithm given above extracts message s from container p (otherwise find out that such key doesn\'t exist)." 2400.0     
                                           331D3 "Escaping on Beaveractor" "data structures,implementation,trees" "Don\'t put up with what you\'re sick of! The Smart Beaver decided to escape from the campus of Beaver Science Academy (BSA). BSA is a b\xe2\x80\x89\xc3\x97\xe2\x80\x89b square on a plane. Each point x,\xe2\x80\x89y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) belongs to BSA. To make the path quick and funny, the Beaver constructed a Beaveractor, an effective and comfortable types of transport.The campus obeys traffic rules: there are n arrows, parallel to the coordinate axes. The arrows do not intersect and do not touch each other. When the Beaveractor reaches some arrow, it turns in the arrow\'s direction and moves on until it either reaches the next arrow or gets outside the campus. The Beaveractor covers exactly one unit of space per one unit of time. You can assume that there are no obstacles to the Beaveractor.The BSA scientists want to transport the brand new Beaveractor to the ""Academic Tractor"" research institute and send the Smart Beaver to do his postgraduate studies and sharpen pencils. They have q plans, representing the Beaveractor\'s initial position (xi,\xe2\x80\x89yi), the initial motion vector wi and the time ti that have passed after the escape started.Your task is for each of the q plans to determine the Smart Beaver\'s position after the given time." 3000.0     
                                           331A1 "Oh Sweet Beaverette" "brute force,implementation" "\xe2\x80\x94 Oh my sweet Beaverette, would you fancy a walk along a wonderful woodland belt with me?   \xe2\x80\x94 Of course, my Smart Beaver! Let us enjoy the splendid view together. How about Friday night? At this point the Smart Beaver got rushing. Everything should be perfect by Friday, so he needed to prepare the belt to the upcoming walk. He needed to cut down several trees.Let\'s consider the woodland belt as a sequence of trees. Each tree i is described by the esthetic appeal ai \xe2\x80\x94 some trees are very esthetically pleasing, others are \'so-so\', and some trees are positively ugly!The Smart Beaver calculated that he needed the following effects to win the Beaverette\'s heart:   The first objective is to please the Beaverette: the sum of esthetic appeal of the remaining trees must be maximum possible;  the second objective is to surprise the Beaverette: the esthetic appeal of the first and the last trees in the resulting belt must be the same;  and of course, the walk should be successful: there must be at least two trees in the woodland belt left. Now help the Smart Beaver! Which trees does he need to cut down to win the Beaverette\'s heart?" 1400.0     
                                           325E "The Red Button" "combinatorics,dfs and similar,dsu,graphs,greedy" "Piegirl found the red button. You have one last chance to change the inevitable end.The circuit under the button consists of n nodes, numbered from 0 to n - 1. In order to deactivate the button, the n nodes must be disarmed in a particular order. Node 0 must be disarmed first. After disarming node i, the next node to be disarmed must be either node (2\xc2\xb7i) modulo n or node (2\xc2\xb7i)\xe2\x80\x89+\xe2\x80\x891 modulo n. The last node to be disarmed must be node 0. Node 0 must be disarmed twice, but all other nodes must be disarmed exactly once. Your task is to find any such order and print it. If there is no such order, print -1." 2800.0     
                                           325C "Monsters and Diamonds" "dfs and similar,graphs,shortest paths" "Piegirl has found a monster and a book about monsters and pies. When she is reading the book, she found out that there are n types of monsters, each with an ID between 1 and n. If you feed a pie to a monster, the monster will split into some number of monsters (possibly zero), and at least one colorful diamond. Monsters may be able to split in multiple ways.At the begining Piegirl has exactly one monster. She begins by feeding the monster a pie. She continues feeding pies to monsters until no more monsters are left. Then she collects all the diamonds that were created.You will be given a list of split rules describing the way in which the various monsters can split. Every monster can split in at least one way, and if a monster can split in multiple ways then each time when it splits Piegirl can choose the way it splits.For each monster, determine the smallest and the largest number of diamonds Piegirl can possibly collect, if initially she has a single instance of that monster. Piegirl has an unlimited supply of pies." 2600.0     
                                           325B "Stadium and Games" "binary search,math" "Daniel is organizing a football tournament. He has come up with the following tournament format:   In the first several (possibly zero) stages, while the number of teams is even, they split in pairs and play one game for each pair. At each stage the loser of each pair is eliminated (there are no draws). Such stages are held while the number of teams is even.  Eventually there will be an odd number of teams remaining. If there is one team remaining, it will be declared the winner, and the tournament ends. Otherwise each of the remaining teams will play with each other remaining team once in round robin tournament (if there are x teams, there will be  games), and the tournament ends. For example, if there were 20 teams initially, they would begin by playing 10 games. So, 10 teams would be eliminated, and the remaining 10 would play 5 games. Then the remaining 5 teams would play 10 games in a round robin tournament. In total there would be 10+5+10=25 games.Daniel has already booked the stadium for n games. Help him to determine how many teams he should invite so that the tournament needs exactly n games. You should print all possible numbers of teams that will yield exactly n games in ascending order, or -1 if there are no such numbers." 1800.0     
                                           321B "Ciel and Duel" dp,flows,greedy "Fox Ciel is playing a card game with her friend Jiro.Jiro has n cards, each one has two attributes: position (Attack or Defense) and strength. Fox Ciel has m cards, each one has these two attributes too. It\'s known that position of all Ciel\'s cards is Attack.Now is Ciel\'s battle phase, Ciel can do the following operation many times:  Choose one of her cards X. This card mustn\'t be chosen before.  If Jiro has no alive cards at that moment, he gets the damage equal to (X\'s strength). Otherwise, Ciel needs to choose one Jiro\'s alive card Y, then:   If Y\'s position is Attack, then (X\'s strength) \xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89 (Y\'s strength) must hold. After this attack, card Y dies, and Jiro gets the damage equal to (X\'s strength) - (Y\'s strength).  If Y\'s position is Defense, then (X\'s strength) \xe2\x80\x89>\xe2\x80\x89 (Y\'s strength) must hold. After this attack, card Y dies, but Jiro gets no damage.  Ciel can end her battle phase at any moment (so, she can use not all her cards). Help the Fox to calculate the maximal sum of damage Jiro can get." 1900.0     
                                           319A "Malek Dance Club" combinatorics,math "As a tradition, every year before IOI all the members of Natalia Fan Club are invited to Malek Dance Club to have a fun night together. Malek Dance Club has 2n members and coincidentally Natalia Fan Club also has 2n members. Each member of MDC is assigned a unique id i from 0 to 2n\xe2\x80\x89-\xe2\x80\x891. The same holds for each member of NFC.One of the parts of this tradition is one by one dance, where each member of MDC dances with a member of NFC. A dance pair is a pair of numbers (a,\xe2\x80\x89b) such that member a from MDC dances with member b from NFC.The complexity of a pairs\' assignment is the number of pairs of dancing pairs (a,\xe2\x80\x89b) and (c,\xe2\x80\x89d) such that a\xe2\x80\x89<\xe2\x80\x89c and b\xe2\x80\x89>\xe2\x80\x89d.You are given a binary number of length n named x. We know that member i from MDC dances with member  from NFC. Your task is to calculate the complexity of this assignment modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Expression  denotes applying \xc2\xabXOR\xc2\xbb to numbers x and y. This operation exists in all modern programming languages, for example, in C++ and Java it denotes as \xc2\xab^\xc2\xbb, in Pascal \xe2\x80\x94 \xc2\xabxor\xc2\xbb." 1600.0     
                                           314E "Sereja and Squares" dp "Sereja painted n points on the plane, point number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) has coordinates (i,\xe2\x80\x890). Then Sereja marked each point with a small or large English letter. Sereja don\'t like letter ""x"", so he didn\'t use it to mark points. Sereja thinks that the points are marked beautifully if the following conditions holds:  all points can be divided into pairs so that each point will belong to exactly one pair;  in each pair the point with the lesser abscissa will be marked with a small English letter and the point with the larger abscissa will be marked with the same large English letter;  if we built a square on each pair, the pair\'s points will be the square\'s opposite points and the segment between them will be the square\'s diagonal, then among the resulting squares there won\'t be any intersecting or touching ones. Little Petya erased some small and all large letters marking the points. Now Sereja wonders how many ways are there to return the removed letters so that the points were marked beautifully." 2900.0     
                                           313D "Ilya and Roads" dp "Everything is great about Ilya\'s city, except the roads. The thing is, the only ZooVille road is represented as n holes in a row. We will consider the holes numbered from 1 to n, from left to right.Ilya is really keep on helping his city. So, he wants to fix at least k holes (perharps he can fix more) on a single ZooVille road. The city has m building companies, the i-th company needs ci money units to fix a road segment containing holes with numbers of at least li and at most ri. The companies in ZooVille are very greedy, so, if they fix a segment containing some already fixed holes, they do not decrease the price for fixing the segment. Determine the minimum money Ilya will need to fix at least k holes." 2100.0     
                                           312B Archer math,probabilities "SmallR is an archer. SmallR is taking a match of archer with Zanoes. They try to shoot in the target in turns, and SmallR shoots first. The probability of shooting the target each time is  for SmallR while  for Zanoes. The one who shoots in the target first should be the winner.Output the probability that SmallR will win the match." 1300.0     
                                           306A Candies implementation "Polycarpus has got n candies and m friends (n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89m). He wants to make a New Year present with candies to each friend. Polycarpus is planning to present all candies and he wants to do this in the fairest (that is, most equal) manner. He wants to choose such ai, where ai is the number of candies in the i-th friend\'s present, that the maximum ai differs from the least ai as little as possible.For example, if n is divisible by m, then he is going to present the same number of candies to all his friends, that is, the maximum ai won\'t differ from the minimum one." 800.0     
                                           303E "Random Ranking" dp,math,probabilities "Imagine a real contest or exam of n participants. Every participant will get a particular score. We can predict the standings board more or less, if we do some statistics on their previous performance.  Let\'s say the score of the participants will be uniformly distributed in interval [li,\xe2\x80\x89ri] (the score can be a real number). Can you predict the standings board according to these data? In other words you should say for each participant the probability that he gets some fixed place in the scoreboard. The participants are sorted by increasing of their scores in the scoreboard. So, the participant with the largest score gets the last place." 3000.0     
                                           303A "Lucky Permutation Triple" "constructive algorithms,implementation,math" "Bike is interested in permutations. A permutation of length n is an integer sequence such that each integer from 0 to (n\xe2\x80\x89-\xe2\x80\x891) appears exactly once in it. For example, [0,\xe2\x80\x892,\xe2\x80\x891] is a permutation of length 3 while both [0,\xe2\x80\x892,\xe2\x80\x892] and [1,\xe2\x80\x892,\xe2\x80\x893] is not.A permutation triple of permutations of length n (a,\xe2\x80\x89b,\xe2\x80\x89c) is called a Lucky Permutation Triple if and only if . The sign ai denotes the i-th element of permutation a. The modular equality described above denotes that the remainders after dividing ai\xe2\x80\x89+\xe2\x80\x89bi by n and dividing ci by n are equal.Now, he has an integer n and wants to find a Lucky Permutation Triple. Could you please help him?" 1300.0     
                                           301D "Yaroslav and Divisors" "data structures" "Yaroslav has an array p\xe2\x80\x89=\xe2\x80\x89p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), consisting of n distinct integers. Also, he has m queries:  Query number i is represented as a pair of integers li, ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).  The answer to the query li,\xe2\x80\x89ri is the number of pairs of integers q, w (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q,\xe2\x80\x89w\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri) such that pq is the divisor of pw. Help Yaroslav, answer all his queries." 2200.0     
                                           301B "Yaroslav and Time" "binary search,graphs,shortest paths" "Yaroslav is playing a game called ""Time"". The game has a timer showing the lifespan he\'s got left. As soon as the timer shows 0, Yaroslav\'s character dies and the game ends. Also, the game has n clock stations, station number i is at point (xi,\xe2\x80\x89yi) of the plane. As the player visits station number i, he increases the current time on his timer by ai. The stations are for one-time use only, so if the player visits some station another time, the time on his timer won\'t grow.A player spends d\xc2\xb7dist time units to move between stations, where dist is the distance the player has covered and d is some constant. The distance between stations i and j is determined as |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|.Initially, the player is at station number 1, and the player has strictly more than zero and strictly less than one units of time. At station number 1 one unit of money can increase the time on the timer by one time unit (you can buy only integer number of time units).Now Yaroslav is wondering, how much money he needs to get to station n. Help Yaroslav. Consider the time to buy and to increase the timer value negligibly small." 2100.0     
                                           299A "Ksusha and Array" "brute force,number theory,sortings" "Ksusha is a beginner coder. Today she starts studying arrays. She has array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, consisting of n positive integers.Her university teacher gave her a task. Find such number in the array, that all array elements are divisible by it. Help her and find the number!" 1000.0     
                                           298B Sail "brute force,greedy,implementation" "The polar bears are going fishing. They plan to sail from (sx,\xe2\x80\x89sy) to (ex,\xe2\x80\x89ey). However, the boat can only sail by wind. At each second, the wind blows in one of these directions: east, south, west or north. Assume the boat is currently at (x,\xe2\x80\x89y).  If the wind blows to the east, the boat will move to (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y).  If the wind blows to the south, the boat will move to (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891).  If the wind blows to the west, the boat will move to (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y).  If the wind blows to the north, the boat will move to (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891). Alternatively, they can hold the boat by the anchor. In this case, the boat stays at (x,\xe2\x80\x89y). Given the wind direction for t seconds, what is the earliest time they sail to (ex,\xe2\x80\x89ey)?" 1200.0     
                                           297E "Mystic Carvings" "data structures" "The polar bears have discovered a gigantic circular piece of floating ice with some mystic carvings on it. There are n lines carved on the ice. Each line connects two points on the boundary of the ice (we call these points endpoints). The endpoints are numbered 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x892n counter-clockwise along the circumference. No two lines share an endpoint.Now a group of 6 polar bears (Alice, Bob, Carol, Dave, Eve, Frank) are going to build caves on the endpoints. Each polar bear would build a cave and live in it. No two polar bears can build a cave on the same endpoints. Alice and Bob is a pair of superstitious lovers. They believe the lines are carved by aliens (or humans, which are pretty much the same thing to polar bears), and have certain spiritual power. Therefore they want to build their caves on two endpoints which are connected by a line. The same for Carol and Dave, Eve and Frank.The distance between two caves X and Y is defined as one plus minimum number of other caves one need to pass through in order to travel from X to Y along the boundary of the ice (endpoints without caves are not counted).To ensure fairness, the distances between the three pairs of lovers have to be the same (that is, the distance between Alice and Bob, the distance between Carol and Dave, and the distance between Eve and Frank are the same).The figures below show two different configurations, where the dots on the circle are the endpoints. The configuration on the left is not valid. Although each pair of lovers (A and B, C and D, E and F) is connected a line, the distance requirement is not satisfied. The distance between A and B is 2 (one can go from A to B in the clockwise direction passing through F). The distance between E and F is also 2. However, the distance between C and D is 1 (one can go from C to D in the counter-clockwise direction without passing through any other caves). The configuration on the right is valid. All three pairs have the same distance 1.  Count the number of ways to build the caves under the requirements. Two configurations are considered the same if the same set of 6 endpoints are used." 3000.0     
                                           294D "Shaass and Painter Robot" "brute force,implementation,number theory" "Shaass thinks a kitchen with all white floor tiles is so boring. His kitchen floor is made of n\xc2\xb7m square tiles forming a n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle. Therefore he\'s decided to color some of the tiles in black so that the floor looks like a checkerboard, which is no two side-adjacent tiles should have the same color.Shaass wants to use a painter robot to color the tiles. In the beginning the robot is standing in a border tile (xs,\xe2\x80\x89ys) facing a diagonal direction (i.e. upper-left, upper-right, down-left or down-right). As the robot walks in the kitchen he paints every tile he passes even if it\'s painted before. Painting each tile consumes one unit of black paint. If at any moment the robot hits a wall of the kitchen he changes his direction according the reflection rules. Note that a tile gets painted when the robot enters the tile from another tile, in other words changing direction in the same tile doesn\'t lead to any painting. The first tile the robot is standing on, is also painted.The robot stops painting the first moment the floor is checkered. Given the dimensions of the kitchen and the position of the robot, find out the amount of paint the robot consumes before it stops painting the floor.Let\'s consider an examples depicted below.  If the robot starts at tile number 1 (the tile (1,\xe2\x80\x891)) of the left grid heading to down-right it\'ll pass tiles 1354236 and consumes 7 units of black paint on his way until he stops at tile number 6. But if it starts at tile number 1 in the right grid heading to down-right it will get stuck in a loop painting tiles 1, 2, and 3." 2500.0     
                                           293B "Distinct Paths" "brute force,combinatorics" "You have a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m-cell board. Some cells are already painted some of k colors. You need to paint each uncolored cell one of the k colors so that any path from the upper left square to the lower right one doesn\'t contain any two cells of the same color. The path can go only along side-adjacent cells and can only go down or right.Print the number of possible paintings modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2700.0     
                                           292C "Beautiful IP Addresses" "brute force" "The problem uses a simplified TCP/IP address model, please read the statement carefully.An IP address is a 32-bit integer, represented as a group of four decimal 8-bit integers (without leading zeroes), separated by commas. For example, record 0.255.1.123 shows a correct IP address and records 0.256.1.123 and 0.255.1.01 do not. In the given problem an arbitrary group of four 8-bit integers is a correct IP address.Our hero Polycarpus still works as a system administrator in some large corporation. He likes beautiful IP addresses. To check if some IP address is beautiful, he should do the following:  write out in a line four 8-bit numbers of the IP address, without the commas;  check if the resulting string is a palindrome. Let us remind you that a palindrome is a string that reads the same from right to left and from left to right.For example, IP addresses 12.102.20.121 and 0.3.14.130 are beautiful (as strings ""1210220121"" and ""0314130"" are palindromes), and IP addresses 1.20.20.1 and 100.4.4.1 are not.Polycarpus wants to find all beautiful IP addresses that have the given set of digits. Each digit from the set must occur in the IP address at least once. IP address must not contain any other digits. Help him to cope with this difficult task." 2000.0     
                                           291B "Command Line Arguments" "*special problem,implementation,strings" "The problem describes the properties of a command line. The description somehow resembles the one you usually see in real operating systems. However, there are differences in the behavior. Please make sure you\'ve read the statement attentively and use it as a formal document.In the Pindows operating system a strings are the lexemes of the command line \xe2\x80\x94 the first of them is understood as the name of the program to run and the following lexemes are its arguments. For example, as we execute the command "" run.exe one, two . "", we give four lexemes to the Pindows command line: ""run.exe"", ""one,"", ""two"", ""."". More formally, if we run a command that can be represented as string s (that has no quotes), then the command line lexemes are maximal by inclusion substrings of string s that contain no spaces.To send a string with spaces or an empty string as a command line lexeme, we can use double quotes. The block of characters that should be considered as one lexeme goes inside the quotes. Embedded quotes are prohibited \xe2\x80\x94 that is, for each occurrence of character """""" we should be able to say clearly that the quotes are opening or closing. For example, as we run the command """"run.exe o"" """" "" ne, "" two . "" "" "", we give six lexemes to the Pindows command line: ""run.exe o"", """" (an empty string), "" ne, "", ""two"", ""."", "" "" (a single space).It is guaranteed that each lexeme of the command line is either surrounded by spaces on both sides or touches the corresponding command border. One of its consequences is: the opening brackets are either the first character of the string or there is a space to the left of them.You have a string that consists of uppercase and lowercase English letters, digits, characters "".,?!"""" and spaces. It is guaranteed that this string is a correct OS Pindows command line string. Print all lexemes of this command line string. Consider the character """""" to be used only in order to denote a single block of characters into one command line lexeme. In particular, the consequence is that the given string has got an even number of such characters." 1300.0     
                                           290E HQ "*special problem,constructive algorithms" "The famous joke programming language HQ9+ has only 4 commands. In this problem we will explore its subset \xe2\x80\x94 a language called HQ..." 2500.0     
                                           290A "Mysterious strings" "*special problem,implementation" "InputThe input contains a single integer a (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8940).OutputOutput a single string.ExamplesInputCopy2OutputCopyAdamsInputCopy8OutputCopyVan BurenInputCopy29OutputCopyHarding" 1400.0     
                                           288A "Polo the Penguin and Strings" greedy "Little penguin Polo adores strings. But most of all he adores strings of length n.One day he wanted to find a string that meets the following conditions:  The string consists of n lowercase English letters (that is, the string\'s length equals n), exactly k of these letters are distinct.  No two neighbouring letters of a string coincide; that is, if we represent a string as s\xe2\x80\x89=\xe2\x80\x89s1s2... sn, then the following inequality holds, si\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x891(1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n).  Among all strings that meet points 1 and 2, the required string is lexicographically smallest. Help him find such string or state that such string doesn\'t exist.String x\xe2\x80\x89=\xe2\x80\x89x1x2... xp is lexicographically less than string y\xe2\x80\x89=\xe2\x80\x89y1y2... yq, if either p\xe2\x80\x89<\xe2\x80\x89q and x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xp\xe2\x80\x89=\xe2\x80\x89yp, or there is such number r (r\xe2\x80\x89<\xe2\x80\x89p,\xe2\x80\x89r\xe2\x80\x89<\xe2\x80\x89q), that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xr\xe2\x80\x89=\xe2\x80\x89yr and xr\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89yr\xe2\x80\x89+\xe2\x80\x891. The characters of the strings are compared by their ASCII codes." 1300.0     
                                           286C "Main Sequence" greedy,implementation "As you know, Vova has recently become a new shaman in the city of Ultima Thule. So, he has received the shaman knowledge about the correct bracket sequences. The shamans of Ultima Thule have been using lots of different types of brackets since prehistoric times. A bracket type is a positive integer. The shamans define a correct bracket sequence as follows:  An empty sequence is a correct bracket sequence.  If {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al} and {b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk} are correct bracket sequences, then sequence {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al,\xe2\x80\x89b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk} (their concatenation) also is a correct bracket sequence.  If {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al} \xe2\x80\x94 is a correct bracket sequence, then sequence  also is a correct bracket sequence, where v (v\xe2\x80\x89>\xe2\x80\x890) is an integer. For example, sequences {1,\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891} and {3,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x893} are correct bracket sequences, and {2,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x893} is not.Moreover, after Vova became a shaman, he learned the most important correct bracket sequence {x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn}, consisting of n integers. As sequence x is the most important, Vova decided to encrypt it just in case.Encrypting consists of two sequences. The first sequence {p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn} contains types of brackets, that is, pi\xe2\x80\x89=\xe2\x80\x89|xi| (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The second sequence {q1,\xe2\x80\x89q2,\xe2\x80\x89...,\xe2\x80\x89qt} contains t integers \xe2\x80\x94 some positions (possibly, not all of them), which had negative numbers in sequence {x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn}.Unfortunately, Vova forgot the main sequence. But he was lucky enough to keep the encryption: sequences {p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn} and {q1,\xe2\x80\x89q2,\xe2\x80\x89...,\xe2\x80\x89qt}. Help Vova restore sequence x by the encryption. If there are multiple sequences that correspond to the encryption, restore any of them. If there are no such sequences, you should tell so." 2100.0     
                                           285D "Permutation Sum" bitmasks,combinatorics,dp,implementation,meet-in-the-middle "Permutation p is an ordered set of integers p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers, each of them doesn\'t exceed n. We\'ll denote the i-th element of permutation p as pi. We\'ll call number n the size or the length of permutation p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn.Petya decided to introduce the sum operation on the set of permutations of length n. Let\'s assume that we are given two permutations of length n: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn. Petya calls the sum of permutations a and b such permutation c of length n, where ci\xe2\x80\x89=\xe2\x80\x89((ai\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x891) mod n)\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).Operation  means taking the remainder after dividing number x by number y.Obviously, not for all permutations a and b exists permutation c that is sum of a and b. That\'s why Petya got sad and asked you to do the following: given n, count the number of such pairs of permutations a and b of length n, that exists permutation c that is sum of a and b. The pair of permutations x,\xe2\x80\x89y (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y) and the pair of permutations y,\xe2\x80\x89x are considered distinct pairs.As the answer can be rather large, print the remainder after dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1900.0     
                                           285B "Find Marble" implementation "Petya and Vasya are playing a game. Petya\'s got n non-transparent glasses, standing in a row. The glasses\' positions are indexed with integers from 1 to n from left to right. Note that the positions are indexed but the glasses are not.First Petya puts a marble under the glass in position s. Then he performs some (possibly zero) shuffling operations. One shuffling operation means moving the glass from the first position to position p1, the glass from the second position to position p2 and so on. That is, a glass goes from position i to position pi. Consider all glasses are moving simultaneously during one shuffling operation. When the glasses are shuffled, the marble doesn\'t travel from one glass to another: it moves together with the glass it was initially been put in.After all shuffling operations Petya shows Vasya that the ball has moved to position t. Vasya\'s task is to say what minimum number of shuffling operations Petya has performed or determine that Petya has made a mistake and the marble could not have got from position s to position t." 1200.0     
                                           283C "Coin Troubles" dp "In the Isle of Guernsey there are n different types of coins. For each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), coin of type i is worth ai cents. It is possible that ai\xe2\x80\x89=\xe2\x80\x89aj for some i and j (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j). Bessie has some set of these coins totaling t cents. She tells Jessie q pairs of integers. For each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q), the pair bi,\xe2\x80\x89ci tells Jessie that Bessie has a strictly greater number of coins of type bi than coins of type ci. It is known that all bi are distinct and all ci are distinct. Help Jessie find the number of possible combinations of coins Bessie could have. Two combinations are considered different if there is some i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the number of coins Bessie has of type i is different in the two combinations. Since the answer can be very large, output it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). If there are no possible combinations of coins totaling t cents that satisfy Bessie\'s conditions, output 0." 2100.0     
                                           276E "Little Girl and Problem on Trees" "data structures,graphs,trees" "A little girl loves problems on trees very much. Here\'s one of them.A tree is an undirected connected graph, not containing cycles. The degree of node x in the tree is the number of nodes y of the tree, such that each of them is connected with node x by some edge of the tree. Let\'s consider a tree that consists of n nodes. We\'ll consider the tree\'s nodes indexed from 1 to n. The cosidered tree has the following property: each node except for node number 1 has the degree of at most 2.Initially, each node of the tree contains number 0. Your task is to quickly process the requests of two types:  Request of form: 0 v x d. In reply to the request you should add x to all numbers that are written in the nodes that are located at the distance of at most d from node v. The distance between two nodes is the number of edges on the shortest path between them.  Request of form: 1 v. In reply to the request you should print the current number that is written in node v." 2100.0     
                                           273E "Dima and Game" dp,games "Dima and Anya love playing different games. Now Dima has imagined a new game that he wants to play with Anya.Dima writes n pairs of integers on a piece of paper (li,\xe2\x80\x89ri) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89<\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p). Then players take turns. On his turn the player can do the following actions:  choose the number of the pair i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that ri\xe2\x80\x89-\xe2\x80\x89li\xe2\x80\x89>\xe2\x80\x892;  replace pair number i by pair  or by pair . Notation \xe2\x8c\x8ax\xe2\x8c\x8b means rounding down to the closest integer. The player who can\'t make a move loses.Of course, Dima wants Anya, who will move first, to win. That\'s why Dima should write out such n pairs of integers (li,\xe2\x80\x89ri) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89<\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p), that if both players play optimally well, the first one wins. Count the number of ways in which Dima can do it. Print the remainder after dividing the answer by number 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Two ways are considered distinct, if the ordered sequences of the written pairs are distinct." 2600.0     
                                           272B "Dima and Sequence" implementation,math "Dima got into number sequences. Now he\'s got sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, consisting of n positive integers. Also, Dima has got a function f(x), which can be defined with the following recurrence:  f(0)\xe2\x80\x89=\xe2\x80\x890;  f(2\xc2\xb7x)\xe2\x80\x89=\xe2\x80\x89f(x);  f(2\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89=\xe2\x80\x89f(x)\xe2\x80\x89+\xe2\x80\x891. Dima wonders, how many pairs of indexes (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) are there, such that f(ai)\xe2\x80\x89=\xe2\x80\x89f(aj). Help him, count the number of such pairs." 1400.0     
                                           270A "Fancy Fence" geometry,implementation,math "Emuskald needs a fence around his farm, but he is too lazy to build it himself. So he purchased a fence-building robot.He wants the fence to be a regular polygon. The robot builds the fence along a single path, but it can only make fence corners at a single angle a.Will the robot be able to build the fence Emuskald wants? In other words, is there a regular polygon which angles are equal to a?" 1100.0     
                                           269E "String Theory" geometry,math,strings "Emuskald is an innovative musician and always tries to push the boundaries of music production. Now he has come up with an idea for a revolutionary musical instrument \xe2\x80\x94 a rectangular harp.A rectangular harp is a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m consisting of n rows and m columns. The rows are numbered 1 to n from top to bottom. Similarly the columns are numbered 1 to m from left to right. String pins are spaced evenly across every side, one per unit. Thus there are n pins on the left and right sides of the harp and m pins on its top and bottom. The harp has exactly n\xe2\x80\x89+\xe2\x80\x89m different strings, each string connecting two different pins, each on a different side of the harp.Emuskald has ordered his apprentice to construct the first ever rectangular harp. However, he didn\'t mention that no two strings can cross, otherwise it would be impossible to play the harp. Two strings cross if the segments connecting their pins intersect. To fix the harp, Emuskald can perform operations of two types:   pick two different columns and swap their pins on each side of the harp, not changing the pins that connect each string;  pick two different rows and swap their pins on each side of the harp, not changing the pins that connect each string; In the following example, he can fix the harp by swapping two columns:   Help Emuskald complete his creation and find the permutations how the rows and columns of the harp need to be rearranged, or tell that it is impossible to do so. He can detach and reattach each string to its pins, so the physical layout of the strings doesn\'t matter." 3100.0     
                                           269D "Maximum Waterfall" "data structures,dp,graphs,sortings" "Emuskald was hired to design an artificial waterfall according to the latest trends in landscape architecture. A modern artificial waterfall consists of multiple horizontal panels affixed to a wide flat wall. The water flows down the top of the wall from panel to panel until it reaches the bottom of the wall.The wall has height t and has n panels on the wall. Each panel is a horizontal segment at height hi which begins at li and ends at ri. The i-th panel connects the points (li,\xe2\x80\x89hi) and (ri,\xe2\x80\x89hi) of the plane. The top of the wall can be considered a panel connecting the points (\xe2\x80\x89-\xe2\x80\x89109,\xe2\x80\x89t) and (109,\xe2\x80\x89t). Similarly, the bottom of the wall can be considered a panel connecting the points (\xe2\x80\x89-\xe2\x80\x89109,\xe2\x80\x890) and (109,\xe2\x80\x890). No two panels share a common point.Emuskald knows that for the waterfall to be aesthetically pleasing, it can flow from panel i to panel j () only if the following conditions hold:   max(li,\xe2\x80\x89lj)\xe2\x80\x89<\xe2\x80\x89min(ri,\xe2\x80\x89rj) (horizontal projections of the panels overlap);  hj\xe2\x80\x89<\xe2\x80\x89hi (panel j is below panel i);  there is no such panel k (hj\xe2\x80\x89<\xe2\x80\x89hk\xe2\x80\x89<\xe2\x80\x89hi) that the first two conditions hold for the pairs (i,\xe2\x80\x89k) and (k,\xe2\x80\x89j). Then the flow for  is equal to min(ri,\xe2\x80\x89rj)\xe2\x80\x89-\xe2\x80\x89max(li,\xe2\x80\x89lj), the length of their horizontal projection overlap.Emuskald has decided that in his waterfall the water will flow in a single path from top to bottom. If water flows to a panel (except the bottom of the wall), the water will fall further to exactly one lower panel. The total amount of water flow in the waterfall is then defined as the minimum horizontal projection overlap between two consecutive panels in the path of the waterfall. Formally:   the waterfall consists of a single path of panels ;  the flow of the waterfall is the minimum flow in the path .  To make a truly great waterfall Emuskald must maximize this water flow, but there are too many panels and he is having a hard time planning his creation. Below is an example of a waterfall Emuskald wants:  Help Emuskald maintain his reputation and find the value of the maximum possible water flow." 2600.0     
                                           268E Playlist math,probabilities,sortings "Manao\'s friends often send him new songs. He never listens to them right away. Instead, he compiles them into a playlist. When he feels that his mind is open to new music, he opens the playlist and starts to listen to the songs.Of course, there are some songs that Manao doesn\'t particuarly enjoy. To get more pleasure from the received songs, he invented the following procedure of listening to the playlist:  If after listening to some song Manao realizes that he liked it, then he remembers it and starts to listen to the next unlistened song.  If after listening to some song Manao realizes that he did not like it, he listens to all the songs he liked up to this point and then begins to listen to the next unlistened song. For example, if Manao has four songs in the playlist, A, B, C, D (in the corresponding order) and he is going to like songs A and C in the end, then the order of listening is the following:  Manao listens to A, he likes it, he remembers it.  Manao listens to B, he does not like it, so he listens to A, again.  Manao listens to C, he likes the song and he remembers it, too.  Manao listens to D, but does not enjoy it and re-listens to songs A and C. That is, in the end Manao listens to song A three times, to song C twice and songs B and D once. Note that if Manao once liked a song, he will never dislike it on a subsequent listening.Manao has received n songs: the i-th of them is li seconds long and Manao may like it with a probability of pi percents. The songs could get on Manao\'s playlist in any order, so Manao wants to know the maximum expected value of the number of seconds after which the listening process will be over, for all possible permutations of the songs in the playlist." 2100.0     
                                           267C "Berland Traffic" math,matrices "Berland traffic is very different from traffic in other countries. The capital of Berland consists of n junctions and m roads. Each road connects a pair of junctions. There can be multiple roads between a pair of junctions. For each road we know its capacity: value ci is the maximum number of cars that can drive along a road in any direction per a unit of time. For each road, the cars can drive along it in one of two direction. That it, the cars can\'t simultaneously move in both directions. A road\'s traffic is the number of cars that goes along it per a unit of time. For road (ai,\xe2\x80\x89bi) this value is negative, if the traffic moves from bi to ai. A road\'s traffic can be a non-integer number.The capital has two special junctions \xe2\x80\x94 the entrance to the city (junction 1) and the exit from the city (junction n). For all other junctions it is true that the traffic is not lost there. That is, for all junctions except for 1 and n the incoming traffic sum equals the outgoing traffic sum.Traffic has an unusual peculiarity in the capital of Berland \xe2\x80\x94 for any pair of junctions (x,\xe2\x80\x89y) the sum of traffics along any path from x to y doesn\'t change depending on the choice of the path. Such sum includes traffic along all roads on the path (possible with the ""minus"" sign, if the traffic along the road is directed against the direction of the road on the path from x to y).Your task is to find the largest traffic that can pass trough the city per one unit of time as well as the corresponding traffic for each road." 2700.0     
                                           266A "Stones on the Table" implementation "There are n stones on the table in a row, each of them can be red, green or blue. Count the minimum number of stones to take from the table so that any two neighboring stones had different colors. Stones in a row are considered neighboring if there are no other stones between them." 800.0     
                                           265B "Roadside Trees (Simplified Edition)" greedy,implementation "Squirrel Liss loves nuts. There are n trees (numbered 1 to n from west to east) along a street and there is a delicious nut on the top of each tree. The height of the tree i is hi. Liss wants to eat all nuts.Now Liss is on the root of the tree with the number 1. In one second Liss can perform one of the following actions:  Walk up or down one unit on a tree.  Eat a nut on the top of the current tree.  Jump to the next tree. In this action the height of Liss doesn\'t change. More formally, when Liss is at height h of the tree i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), she jumps to height h of the tree i\xe2\x80\x89+\xe2\x80\x891. This action can\'t be performed if h\xe2\x80\x89>\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891. Compute the minimal time (in seconds) required to eat all nuts." 1000.0     
                                           265A "Colorful Stones (Simplified Edition)" implementation "There is a sequence of colorful stones. The color of each stone is one of red, green, or blue. You are given a string s. The i-th (1-based) character of s represents the color of the i-th stone. If the character is ""R"", ""G"", or ""B"", the color of the corresponding stone is red, green, or blue, respectively.Initially Squirrel Liss is standing on the first stone. You perform instructions one or more times.Each instruction is one of the three types: ""RED"", ""GREEN"", or ""BLUE"". After an instruction c, if Liss is standing on a stone whose colors is c, Liss will move one stone forward, else she will not move.You are given a string t. The number of instructions is equal to the length of t, and the i-th character of t represents the i-th instruction.Calculate the final position of Liss (the number of the stone she is going to stand on in the end) after performing all the instructions, and print its 1-based position. It is guaranteed that Liss don\'t move out of the sequence." 800.0     
                                           264C "Choosing Balls" dp "There are n balls. They are arranged in a row. Each ball has a color (for convenience an integer) and an integer value. The color of the i-th ball is ci and the value of the i-th ball is vi.Squirrel Liss chooses some balls and makes a new sequence without changing the relative order of the balls. She wants to maximize the value of this sequence.The value of the sequence is defined as the sum of following values for each ball (where a and b are given constants):  If the ball is not in the beginning of the sequence and the color of the ball is same as previous ball\'s color, add (the value of the ball) \xe2\x80\x89\xc3\x97\xe2\x80\x89 a.  Otherwise, add (the value of the ball) \xe2\x80\x89\xc3\x97\xe2\x80\x89 b. You are given q queries. Each query contains two integers ai and bi. For each query find the maximal value of the sequence she can make when a\xe2\x80\x89=\xe2\x80\x89ai and b\xe2\x80\x89=\xe2\x80\x89bi.Note that the new sequence can be empty, and the value of an empty sequence is defined as zero." 2000.0     
                                           260E "Dividing Kingdom" "binary search,brute force,data structures" "A country called Flatland is an infinite two-dimensional plane. Flatland has n cities, each of them is a point on the plane.Flatland is ruled by king Circle IV. Circle IV has 9 sons. He wants to give each of his sons part of Flatland to rule. For that, he wants to draw four distinct straight lines, such that two of them are parallel to the Ox axis, and two others are parallel to the Oy axis. At that, no straight line can go through any city. Thus, Flatland will be divided into 9 parts, and each son will be given exactly one of these parts. Circle IV thought a little, evaluated his sons\' obedience and decided that the i-th son should get the part of Flatland that has exactly ai cities.Help Circle find such four straight lines that if we divide Flatland into 9 parts by these lines, the resulting parts can be given to the sons so that son number i got the part of Flatland which contains ai cities." 2500.0     
                                           258C "Little Elephant and LCM" "binary search,combinatorics,dp,math" "The Little Elephant loves the LCM (least common multiple) operation of a non-empty set of positive integers. The result of the LCM operation of k positive integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk is the minimum positive integer that is divisible by each of numbers xi.Let\'s assume that there is a sequence of integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn. Let\'s denote their LCMs as lcm(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn) and the maximum of them as max(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn). The Little Elephant considers a sequence b good, if lcm(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn)\xe2\x80\x89=\xe2\x80\x89max(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn).The Little Elephant has a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Help him find the number of good sequences of integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, such that for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) the following condition fulfills: 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai. As the answer can be rather large, print the remainder from dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000.0     
                                           257E "Greedy Elevator" "data structures,implementation" "The m-floor (m\xe2\x80\x89>\xe2\x80\x891) office of international corporation CodeForces has the advanced elevator control system established. It works as follows.All office floors are sequentially numbered with integers from 1 to m. At time t\xe2\x80\x89=\xe2\x80\x890, the elevator is on the first floor, the elevator is empty and nobody is waiting for the elevator on other floors. Next, at times ti (ti\xe2\x80\x89>\xe2\x80\x890) people come to the elevator. For simplicity, we assume that one person uses the elevator only once during the reported interval. For every person we know three parameters: the time at which the person comes to the elevator, the floor on which the person is initially, and the floor to which he wants to go.The movement of the elevator between the floors is as follows. At time t (t\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890, t is an integer) the elevator is always at some floor. First the elevator releases all people who are in the elevator and want to get to the current floor. Then it lets in all the people waiting for the elevator on this floor. If a person comes to the elevator exactly at time t, then he has enough time to get into it. We can assume that all of these actions (going in or out from the elevator) are made instantly. After that the elevator decides, which way to move and at time (t\xe2\x80\x89+\xe2\x80\x891) the elevator gets to the selected floor.The elevator selects the direction of moving by the following algorithm.   If the elevator is empty and at the current time no one is waiting for the elevator on any floor, then the elevator remains at the current floor.  Otherwise, let\'s assume that the elevator is on the floor number x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Then elevator calculates the directions\' ""priorities"" pup and pdown: pup is the sum of the number of people waiting for the elevator on the floors with numbers greater than x, and the number of people in the elevator, who want to get to the floors with the numbers greater than x; pdown is the sum of the number of people waiting for the elevator on the floors with numbers less than x, and the number of people in the elevator, who want to get to the floors with the numbers less than x. If pup\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89pdown, then the elevator goes one floor above the current one (that is, from floor x to floor x\xe2\x80\x89+\xe2\x80\x891), otherwise the elevator goes one floor below the current one (that is, from floor x to floor x\xe2\x80\x89-\xe2\x80\x891). Your task is to simulate the work of the elevator and for each person to tell the time when the elevator will get to the floor this person needs. Please note that the elevator is large enough to accommodate all the people at once." 2200.0     
                                           256E "Lucky Arrays" "data structures" "Little Maxim loves interesting problems. He decided to share one such problem with you. Initially there is an array a, consisting of n zeroes. The elements of the array are indexed, starting from 1. Then follow queries to change array a. Each query is characterized by two integers vi,\xe2\x80\x89ti. In the answer to the query we should make the vi-th array element equal ti (avi\xe2\x80\x89=\xe2\x80\x89ti; 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89vi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).Maxim thinks that some pairs of integers (x,\xe2\x80\x89y) are good and some are not. Maxim thinks that array a, consisting of n integers, is lucky, if for all integer i, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) the pair of integers (ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 is good. Note that the order of numbers in the pairs is important, that is, specifically, (1,\xe2\x80\x892)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89(2,\xe2\x80\x891).After each query to change array a Maxim wants to know, how many ways there are to replace all zeroes in array a with integers from one to three so as to make the resulting array (without zeroes) lucky. Of course, distinct zeroes can be replaced by distinct integers.Maxim told you the sequence of queries and all pairs of integers he considers lucky. Help Maxim, solve this problem for him." 2400.0     
                                           254E Dormitory dp,implementation "Student Vasya came to study in Berland State University from the country, so he is living in a dormitory. A semester has n days, and in each of those days his parents send him some food. In the morning of the i-th day he receives ai kilograms of food that can be eaten on that day and on the next one (then the food goes bad and becomes unfit for consumption).Every day Vasya eats v kilograms of food. It is known that Vasya\'s parents do not allow him to starve, so there always is enough food for Vasya. Vasya has m friends who sometimes live with him. Let\'s index the friends from 1 to m. Friend number j lives with Vasya from day lj to day rj, inclusive. Also, the j-th friend requires fj kilograms of food per day. Usually Vasya\'s friends eat in the canteen, but sometimes generous Vasya feeds some of them. Every day Vasya can feed some friends who live with him this day (or may feed nobody).Every time Vasya feeds his friend, he gives him as much food as the friend needs for the day, and Vasya\'s popularity rating at the University increases by one. Vasya cannot feed the same friend multiple times in one day. In addition, he knows that eating habits must be regular, so he always eats v kilograms of food per day.Vasya wants so choose whom he will feed each day of the semester to make his rating as high as possible. Originally Vasya\'s rating is 0 because he is a freshman." 2100.0     
                                           254B "Jury Size" "brute force,implementation" "In 2013, the writers of Berland State University should prepare problems for n Olympiads. We will assume that the Olympiads are numbered with consecutive integers from 1 to n. For each Olympiad we know how many members of the jury must be involved in its preparation, as well as the time required to prepare the problems for her. Namely, the Olympiad number i should be prepared by pi people for ti days, the preparation for the Olympiad should be a continuous period of time and end exactly one day before the Olympiad. On the day of the Olympiad the juries who have prepared it, already do not work on it.For example, if the Olympiad is held on December 9th and the preparation takes 7 people and 6 days, all seven members of the jury will work on the problems of the Olympiad from December, 3rd to December, 8th (the jury members won\'t be working on the problems of this Olympiad on December 9th, that is, some of them can start preparing problems for some other Olympiad). And if the Olympiad is held on November 3rd and requires 5 days of training, the members of the jury will work from October 29th to November 2nd.In order not to overload the jury the following rule was introduced: one member of the jury can not work on the same day on the tasks for different Olympiads. Write a program that determines what the minimum number of people must be part of the jury so that all Olympiads could be prepared in time." 1500.0     
                                           253E Printer "binary search,data structures,implementation,sortings" "Let\'s consider a network printer that functions like that. It starts working at time 0. In each second it can print one page of a text. At some moments of time the printer receives printing tasks. We know that a printer received n tasks. Let\'s number the tasks by consecutive integers from 1 to n. Then the task number i is characterised by three integers: ti is the time when the task came, si is the task\'s volume (in pages) and pi is the task\'s priority. The priorities of all tasks are distinct.When the printer receives a task, the task goes to the queue and remains there until all pages from this task are printed. The printer chooses a page to print each time when it either stops printing some page or when it is free and receives a new task. Among all tasks that are in the queue at this moment, the printer chooses the task with the highest priority and next second prints an unprinted page from this task. You can assume that a task goes to the queue immediately, that\'s why if a task has just arrived by time t, the printer can already choose it for printing.You are given full information about all tasks except for one: you don\'t know this task\'s priority. However, we know the time when the last page from this task was finished printing. Given this information, find the unknown priority value and determine the moments of time when the printer finished printing each task." 2200.0     
                                           253C "Text Editor" "data structures,dfs and similar,graphs,greedy,shortest paths" "Vasya is pressing the keys on the keyboard reluctantly, squeezing out his ideas on the classical epos depicted in Homer\'s Odysseus... How can he explain to his literature teacher that he isn\'t going to become a writer? In fact, he is going to become a programmer. So, he would take great pleasure in writing a program, but none \xe2\x80\x94 in writing a composition.As Vasya was fishing for a sentence in the dark pond of his imagination, he suddenly wondered: what is the least number of times he should push a key to shift the cursor from one position to another one?Let\'s describe his question more formally: to type a text, Vasya is using the text editor. He has already written n lines, the i-th line contains ai characters (including spaces). If some line contains k characters, then this line overall contains (k\xe2\x80\x89+\xe2\x80\x891) positions where the cursor can stand: before some character or after all characters (at the end of the line). Thus, the cursor\'s position is determined by a pair of integers (r,\xe2\x80\x89c), where r is the number of the line and c is the cursor\'s position in the line (the positions are indexed starting from one from the beginning of the line).Vasya doesn\'t use the mouse to move the cursor. He uses keys ""Up"", ""Down"", ""Right"" and ""Left"". When he pushes each of these keys, the cursor shifts in the needed direction. Let\'s assume that before the corresponding key is pressed, the cursor was located in the position (r,\xe2\x80\x89c), then Vasya pushed key: ""Up"": if the cursor was located in the first line (r\xe2\x80\x89=\xe2\x80\x891), then it does not move. Otherwise, it moves to the previous line (with number r\xe2\x80\x89-\xe2\x80\x891), to the same position. At that, if the previous line was short, that is, the cursor couldn\'t occupy position c there, the cursor moves to the last position of the line with number r\xe2\x80\x89-\xe2\x80\x891; ""Down"": if the cursor was located in the last line (r\xe2\x80\x89=\xe2\x80\x89n), then it does not move. Otherwise, it moves to the next line (with number r\xe2\x80\x89+\xe2\x80\x891), to the same position. At that, if the next line was short, that is, the cursor couldn\'t occupy position c there, the cursor moves to the last position of the line with number r\xe2\x80\x89+\xe2\x80\x891; ""Right"": if the cursor can move to the right in this line (c\xe2\x80\x89<\xe2\x80\x89ar\xe2\x80\x89+\xe2\x80\x891), then it moves to the right (to position c\xe2\x80\x89+\xe2\x80\x891). Otherwise, it is located at the end of the line and doesn\'t move anywhere when Vasya presses the ""Right"" key; ""Left"": if the cursor can move to the left in this line (c\xe2\x80\x89>\xe2\x80\x891), then it moves to the left (to position c\xe2\x80\x89-\xe2\x80\x891). Otherwise, it is located at the beginning of the line and doesn\'t move anywhere when Vasya presses the ""Left"" key.You\'ve got the number of lines in the text file and the number of characters, written in each line of this file. Find the least number of times Vasya should push the keys, described above, to shift the cursor from position (r1,\xe2\x80\x89c1) to position (r2,\xe2\x80\x89c2)." 1600.0     
                                           253B "Physics Practical" "binary search,dp,sortings,two pointers" "One day Vasya was on a physics practical, performing the task on measuring the capacitance. He followed the teacher\'s advice and did as much as n measurements, and recorded the results in the notebook. After that he was about to show the results to the teacher, but he remembered that at the last lesson, the teacher had made his friend Petya redo the experiment because the largest and the smallest results differed by more than two times. Vasya is lazy, and he does not want to redo the experiment. He wants to do the task and go home play computer games. So he decided to cheat: before Vasya shows the measurements to the teacher, he will erase some of them, so as to make the largest and the smallest results of the remaining measurements differ in no more than two times. In other words, if the remaining measurements have the smallest result x, and the largest result y, then the inequality y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7x must fulfill. Of course, to avoid the teacher\'s suspicion, Vasya wants to remove as few measurement results as possible from his notes.Help Vasya, find what minimum number of measurement results he will have to erase from his notes so that the largest and the smallest of the remaining results of the measurements differed in no more than two times." 1400.0     
                                           251D "Two Sets" bitmasks,math "Little Petya likes numbers a lot. Recently his mother has presented him a collection of n non-negative integers. There\'s only one thing Petya likes more than numbers: playing with little Masha. He immediately decided to give a part of his new collection to her. To make the game even more interesting, Petya decided to give Masha such collection of numbers for which the following conditions fulfill:  Let\'s introduce x1 to denote the xor of all numbers Petya has got left; and let\'s introduce x2 to denote the xor of all numbers he gave to Masha. Value (x1\xe2\x80\x89+\xe2\x80\x89x2) must be as large as possible.  If there are multiple ways to divide the collection so that the previous condition fulfilled, then Petya minimizes the value x1. The xor operation is a bitwise excluding ""OR"", that is denoted as ""xor"" in the Pascal language and ""^"" in C/C++/Java.Help Petya divide the collection as described above. If there are multiple suitable ways to divide it, find any of them. Please note that after Petya gives a part of his numbers to Masha, he may have no numbers left. The reverse situation is also possible, when Petya gives nothing to Masha. In both cases we must assume that the xor of an empty set of numbers equals 0." 2700.0     
                                           250D "Building Bridge" "geometry,ternary search,two pointers" "Two villages are separated by a river that flows from the north to the south. The villagers want to build a bridge across the river to make it easier to move across the villages.The river banks can be assumed to be vertical straight lines x\xe2\x80\x89=\xe2\x80\x89a and x\xe2\x80\x89=\xe2\x80\x89b (0\xe2\x80\x89<\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x89b).The west village lies in a steppe at point O\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x890). There are n pathways leading from the village to the river, they end at points Ai\xe2\x80\x89=\xe2\x80\x89(a,\xe2\x80\x89yi). The villagers there are plain and simple, so their pathways are straight segments as well.The east village has reserved and cunning people. Their village is in the forest on the east bank of the river, but its exact position is not clear. There are m twisted paths leading from this village to the river and ending at points Bi\xe2\x80\x89=\xe2\x80\x89(b,\xe2\x80\x89y\'i). The lengths of all these paths are known, the length of the path that leads from the eastern village to point Bi, equals li.The villagers want to choose exactly one point on the left bank of river Ai, exactly one point on the right bank Bj and connect them by a straight-line bridge so as to make the total distance between the villages (the sum of |OAi|\xe2\x80\x89+\xe2\x80\x89|AiBj|\xe2\x80\x89+\xe2\x80\x89lj, where |XY| is the Euclidean distance between points X and Y) were minimum. The Euclidean distance between points (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) equals .Help them and find the required pair of points." 1900.0     
                                           248A Cupboards implementation "One foggy Stockholm morning, Karlsson decided to snack on some jam in his friend Lillebror Svantenson\'s house. Fortunately for Karlsson, there wasn\'t anybody in his friend\'s house. Karlsson was not going to be hungry any longer, so he decided to get some food in the house.Karlsson\'s gaze immediately fell on n wooden cupboards, standing in the kitchen. He immediately realized that these cupboards have hidden jam stocks. Karlsson began to fly greedily around the kitchen, opening and closing the cupboards\' doors, grab and empty all the jars of jam that he could find.And now all jars of jam are empty, Karlsson has had enough and does not want to leave traces of his stay, so as not to let down his friend. Each of the cupboards has two doors: the left one and the right one. Karlsson remembers that when he rushed to the kitchen, all the cupboards\' left doors were in the same position (open or closed), similarly, all the cupboards\' right doors were in the same position (open or closed). Karlsson wants the doors to meet this condition as well by the time the family returns. Karlsson does not remember the position of all the left doors, also, he cannot remember the position of all the right doors. Therefore, it does not matter to him in what position will be all left or right doors. It is important to leave all the left doors in the same position, and all the right doors in the same position. For example, all the left doors may be closed, and all the right ones may be open.Karlsson needs one second to open or close a door of a cupboard. He understands that he has very little time before the family returns, so he wants to know the minimum number of seconds t, in which he is able to bring all the cupboard doors in the required position.Your task is to write a program that will determine the required number of seconds t." 800.0     
                                           245B "Internet Address" implementation,strings "Vasya is an active Internet user. One day he came across an Internet resource he liked, so he wrote its address in the notebook. We know that the address of the written resource has format: <protocol>://<domain>.ru[/<context>] where:  <protocol> can equal either ""http"" (without the quotes) or ""ftp"" (without the quotes),  <domain> is a non-empty string, consisting of lowercase English letters,  the /<context> part may not be present. If it is present, then <context> is a non-empty string, consisting of lowercase English letters. If string <context> isn\'t present in the address, then the additional character ""/"" isn\'t written. Thus, the address has either two characters ""/"" (the ones that go before the domain), or three (an extra one in front of the context).When the boy came home, he found out that the address he wrote in his notebook had no punctuation marks. Vasya must have been in a lot of hurry and didn\'t write characters "":"", ""/"", ""."".Help Vasya to restore the possible address of the recorded Internet resource." 1100.0     
                                           245A "System Administrator" implementation "Polycarpus is a system administrator. There are two servers under his strict guidance \xe2\x80\x94 a and b. To stay informed about the servers\' performance, Polycarpus executes commands ""ping a"" and ""ping b"". Each ping command sends exactly ten packets to the server specified in the argument of the command. Executing a program results in two integers x and y (x\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89=\xe2\x80\x8910; x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890). These numbers mean that x packets successfully reached the corresponding server through the network and y packets were lost.Today Polycarpus has performed overall n ping commands during his workday. Now for each server Polycarpus wants to know whether the server is ""alive"" or not. Polycarpus thinks that the server is ""alive"", if at least half of the packets that we send to this server reached it successfully along the network.Help Polycarpus, determine for each server, whether it is ""alive"" or not by the given commands and their results." 800.0     
                                           241B Friends "binary search,bitmasks,data structures,math" "You have n friends and you want to take m pictures of them. Exactly two of your friends should appear in each picture and no two pictures should contain the same pair of your friends. So if you have n\xe2\x80\x89=\xe2\x80\x893 friends you can take 3 different pictures, each containing a pair of your friends.Each of your friends has an attractiveness level which is specified by the integer number ai for the i-th friend. You know that the attractiveness of a picture containing the i-th and the j-th friends is equal to the exclusive-or (xor operation) of integers ai and aj.You want to take pictures in a way that the total sum of attractiveness of your pictures is maximized. You have to calculate this value. Since the result may not fit in a 32-bit integer number, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2700.0     
                                           237E "Build String" flows,graphs "You desperately need to build some string t. For that you\'ve got n more strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn. To build string t, you are allowed to perform exactly |t| (|t| is the length of string t) operations on these strings. Each operation looks like that:  choose any non-empty string from strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn;  choose an arbitrary character from the chosen string and write it on a piece of paper;  remove the chosen character from the chosen string. Note that after you perform the described operation, the total number of characters in strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn decreases by 1. We are assumed to build string t, if the characters, written on the piece of paper, in the order of performed operations form string t.There are other limitations, though. For each string si you know number ai \xe2\x80\x94 the maximum number of characters you are allowed to delete from string si. You also know that each operation that results in deleting a character from string si, costs i rubles. That is, an operation on string s1 is the cheapest (it costs 1 ruble), and the operation on string sn is the most expensive one (it costs n rubles).Your task is to count the minimum amount of money (in rubles) you will need to build string t by the given rules. Consider the cost of building string t to be the sum of prices of the operations you use." 2000.0     
                                           235E "Number Challenge" "combinatorics,dp,implementation,math,number theory" "Let\'s denote d(n) as the number of divisors of a positive integer n. You are given three integers a, b and c. Your task is to calculate the following sum:Find the sum modulo 1073741824 (230)." 2600.0     
                                           235B "Let\'s Play Osu!" dp,math,probabilities "You\'re playing a game called Osu! Here\'s a simplified version of it. There are n clicks in a game. For each click there are two outcomes: correct or bad. Let us denote correct as ""O"", bad as ""X"", then the whole play can be encoded as a sequence of n characters ""O"" and ""X"".Using the play sequence you can calculate the score for the play as follows: for every maximal consecutive ""O""s block, add the square of its length (the number of characters ""O"") to the score. For example, if your play can be encoded as ""OOXOOOXXOO"", then there\'s three maximal consecutive ""O""s block ""OO"", ""OOO"", ""OO"", so your score will be 22\xe2\x80\x89+\xe2\x80\x8932\xe2\x80\x89+\xe2\x80\x8922\xe2\x80\x89=\xe2\x80\x8917. If there are no correct clicks in a play then the score for the play equals to 0.You know that the probability to click the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) click correctly is pi. In other words, the i-th character in the play sequence has pi probability to be ""O"", 1\xe2\x80\x89-\xe2\x80\x89pi to be ""X"". You task is to calculate the expected score for your play." 2000.0     
                                           229C Triangles combinatorics,graphs,math "Alice and Bob don\'t play games anymore. Now they study properties of all sorts of graphs together. Alice invented the following task: she takes a complete undirected graph with n vertices, chooses some m edges and keeps them. Bob gets the  remaining edges.Alice and Bob are fond of ""triangles"" in graphs, that is, cycles of length 3. That\'s why they wonder: what total number of triangles is there in the two graphs formed by Alice and Bob\'s edges, correspondingly?" 1900.0     
                                           226B "Naughty Stone Piles" greedy "There are n piles of stones of sizes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an lying on the table in front of you.During one move you can take one pile and add it to the other. As you add pile i to pile j, the size of pile j increases by the current size of pile i, and pile i stops existing. The cost of the adding operation equals the size of the added pile.Your task is to determine the minimum cost at which you can gather all stones in one pile. To add some challenge, the stone piles built up conspiracy and decided that each pile will let you add to it not more than k times (after that it can only be added to another pile). Moreover, the piles decided to puzzle you completely and told you q variants (not necessarily distinct) of what k might equal. Your task is to find the minimum cost for each of q variants." 1900.0     
                                           219C "Color Stripe" "brute force,dp,greedy" "A colored stripe is represented by a horizontal row of n square cells, each cell is pained one of k colors. Your task is to repaint the minimum number of cells so that no two neighbouring cells are of the same color. You can use any color from 1 to k to repaint the cells." 1600.0     
                                           218B Airport implementation "Lolek and Bolek are about to travel abroad by plane. The local airport has a special ""Choose Your Plane"" offer. The offer\'s conditions are as follows:  it is up to a passenger to choose a plane to fly on;  if the chosen plane has x (x\xe2\x80\x89>\xe2\x80\x890) empty seats at the given moment, then the ticket for such a plane costs x zlotys (units of Polish currency). The only ticket office of the airport already has a queue of n passengers in front of it. Lolek and Bolek have not stood in the queue yet, but they are already wondering what is the maximum and the minimum number of zlotys the airport administration can earn if all n passengers buy tickets according to the conditions of this offer?The passengers buy tickets in turn, the first person in the queue goes first, then goes the second one, and so on up to n-th person." 1100.0     
                                           215C Crosses "brute force,implementation" "There is a board with a grid consisting of n rows and m columns, the rows are numbered from 1 from top to bottom and the columns are numbered from 1 from left to right. In this grid we will denote the cell that lies on row number i and column number j as (i,\xe2\x80\x89j).A group of six numbers (a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d,\xe2\x80\x89x0,\xe2\x80\x89y0), where 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d, is a cross, and there is a set of cells that are assigned to it. Cell (x,\xe2\x80\x89y) belongs to this set if at least one of two conditions are fulfilled:  |x0\xe2\x80\x89-\xe2\x80\x89x|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a and |y0\xe2\x80\x89-\xe2\x80\x89y|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b  |x0\xe2\x80\x89-\xe2\x80\x89x|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c and |y0\xe2\x80\x89-\xe2\x80\x89y|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d    The picture shows the cross (0,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x892,\xe2\x80\x893) on the grid 3\xe2\x80\x89\xc3\x97\xe2\x80\x894.  Your task is to find the number of different groups of six numbers, (a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d,\xe2\x80\x89x0,\xe2\x80\x89y0) that determine the crosses of an area equal to s, which are placed entirely on the grid. The cross is placed entirely on the grid, if any of its cells is in the range of the grid (that is for each cell (x,\xe2\x80\x89y) of the cross 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m holds). The area of the cross is the number of cells it has.Note that two crosses are considered distinct if the ordered groups of six numbers that denote them are distinct, even if these crosses coincide as sets of points." 2100.0     
                                           213C "Relay Race" dp "Furik and Rubik take part in a relay race. The race will be set up on a large square with the side of n meters. The given square is split into n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells (represented as unit squares), each cell has some number.At the beginning of the race Furik stands in a cell with coordinates (1,\xe2\x80\x891), and Rubik stands in a cell with coordinates (n,\xe2\x80\x89n). Right after the start Furik runs towards Rubik, besides, if Furik stands at a cell with coordinates (i,\xe2\x80\x89j), then he can move to cell (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j) or (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891). After Furik reaches Rubik, Rubik starts running from cell with coordinates (n,\xe2\x80\x89n) to cell with coordinates (1,\xe2\x80\x891). If Rubik stands in cell (i,\xe2\x80\x89j), then he can move to cell (i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j) or (i,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891). Neither Furik, nor Rubik are allowed to go beyond the boundaries of the field; if a player goes beyond the boundaries, he will be disqualified. To win the race, Furik and Rubik must earn as many points as possible. The number of points is the sum of numbers from the cells Furik and Rubik visited. Each cell counts only once in the sum.Print the maximum number of points Furik and Rubik can earn on the relay race." 2000.0     
                                           208E "Blood Cousins" "binary search,data structures,dfs and similar,trees" "Polycarpus got hold of a family relationship tree. The tree describes family relationships of n people, numbered 1 through n. Each person in the tree has no more than one parent.Let\'s call person a a 1-ancestor of person b, if a is the parent of b.Let\'s call person a a k-ancestor (k\xe2\x80\x89>\xe2\x80\x891) of person b, if person b has a 1-ancestor, and a is a (k\xe2\x80\x89-\xe2\x80\x891)-ancestor of b\'s 1-ancestor. Family relationships don\'t form cycles in the found tree. In other words, there is no person who is his own ancestor, directly or indirectly (that is, who is an x-ancestor for himself, for some x, x\xe2\x80\x89>\xe2\x80\x890).Let\'s call two people x and y (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y) p-th cousins (p\xe2\x80\x89>\xe2\x80\x890), if there is person z, who is a p-ancestor of x and a p-ancestor of y.Polycarpus wonders how many counsins and what kinds of them everybody has. He took a piece of paper and wrote m pairs of integers vi, pi. Help him to calculate the number of pi-th cousins that person vi has, for each pair vi, pi." 2100.0     
                                           207D9 "The Beaver\'s Problem - 3"  "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 1800.0     
                                           205A "Little Elephant and Rozdil" "brute force,implementation" "The Little Elephant loves Ukraine very much. Most of all he loves town Rozdol (ukr. ""Rozdil"").However, Rozdil is dangerous to settle, so the Little Elephant wants to go to some other town. The Little Elephant doesn\'t like to spend much time on travelling, so for his journey he will choose a town that needs minimum time to travel to. If there are multiple such cities, then the Little Elephant won\'t go anywhere.For each town except for Rozdil you know the time needed to travel to this town. Find the town the Little Elephant will go to or print ""Still Rozdil"", if he stays in Rozdil." 900.0     
                                           203B "Game on Paper" "brute force,implementation" "One not particularly beautiful evening Valera got very bored. To amuse himself a little bit, he found the following game.He took a checkered white square piece of paper, consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. After that, he started to paint the white cells black one after the other. In total he painted m different cells on the piece of paper. Since Valera was keen on everything square, he wondered, how many moves (i.e. times the boy paints a square black) he should make till a black square with side 3 can be found on the piece of paper. But Valera does not know the answer to this question, so he asks you to help him.Your task is to find the minimum number of moves, till the checkered piece of paper has at least one black square with side of 3. Otherwise determine that such move does not exist." 1300.0     
                                                199A "Hexadecimal\'s theorem" "brute force,constructive algorithms,implementation,number theory" "Recently, a chaotic virus Hexadecimal advanced a new theorem which will shake the Universe. She thinks that each Fibonacci number can be represented as sum of three not necessary different Fibonacci numbers.Let\'s remember how Fibonacci numbers can be calculated. F0\xe2\x80\x89=\xe2\x80\x890, F1\xe2\x80\x89=\xe2\x80\x891, and all the next numbers are Fi\xe2\x80\x89=\xe2\x80\x89Fi\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89Fi\xe2\x80\x89-\xe2\x80\x891.So, Fibonacci numbers make a sequence of numbers: 0, 1, 1, 2, 3, 5, 8, 13, ...If you haven\'t run away from the PC in fear, you have to help the virus. Your task is to divide given Fibonacci number n by three not necessary different Fibonacci numbers or say that it is impossible." 900.0
                                                198D "Cube Snake" "constructive algorithms" "You\'ve got an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cube, split into unit cubes. Your task is to number all unit cubes in this cube with positive integers from 1 to n3 so that:   each number was used as a cube\'s number exactly once;  for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n3, unit cubes with numbers i and i\xe2\x80\x89+\xe2\x80\x891 were neighbouring (that is, shared a side);  for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n there were at least two different subcubes with sizes i\xe2\x80\x89\xc3\x97\xe2\x80\x89i\xe2\x80\x89\xc3\x97\xe2\x80\x89i, made from unit cubes, which are numbered with consecutive numbers. That is, there are such two numbers x and y, that the unit cubes of the first subcube are numbered by numbers x, x\xe2\x80\x89+\xe2\x80\x891, ..., x\xe2\x80\x89+\xe2\x80\x89i3\xe2\x80\x89-\xe2\x80\x891, and the unit cubes of the second subcube are numbered by numbers y, y\xe2\x80\x89+\xe2\x80\x891, ..., y\xe2\x80\x89+\xe2\x80\x89i3\xe2\x80\x89-\xe2\x80\x891. Find and print the required numeration of unit cubes of the cube." 2700.0
                                                197A "Plate Game" "constructive algorithms,games,math" "You\'ve got a rectangular table with length a and width b and the infinite number of plates of radius r. Two players play the following game: they take turns to put the plates on the table so that the plates don\'t lie on each other (but they can touch each other), and so that any point on any plate is located within the table\'s border. During the game one cannot move the plates that already lie on the table. The player who cannot make another move loses. Determine which player wins, the one who moves first or the one who moves second, provided that both players play optimally well." 1600.0
                                                196E "Opening Portals" "dsu,graphs,shortest paths" "Pavel plays a famous computer game. A player is responsible for a whole country and he can travel there freely, complete quests and earn experience.This country has n cities connected by m bidirectional roads of different lengths so that it is possible to get from any city to any other one. There are portals in k of these cities. At the beginning of the game all portals are closed. When a player visits a portal city, the portal opens. Strange as it is, one can teleport from an open portal to an open one. The teleportation takes no time and that enables the player to travel quickly between rather remote regions of the country.At the beginning of the game Pavel is in city number 1. He wants to open all portals as quickly as possible. How much time will he need for that?" 2600.0
                                                196D "The Next Good String" "data structures,greedy,hashing,strings" "In problems on strings one often has to find a string with some particular properties. The problem authors were reluctant to waste time on thinking of a name for some string so they called it good. A string is good if it doesn\'t have palindrome substrings longer than or equal to d. You are given string s, consisting only of lowercase English letters. Find a good string t with length |s|, consisting of lowercase English letters, which is lexicographically larger than s. Of all such strings string t must be lexicographically minimum.We will call a non-empty string s[a ... b]\xe2\x80\x89=\xe2\x80\x89sasa\xe2\x80\x89+\xe2\x80\x891... sb (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) a substring of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s|.A non-empty string s\xe2\x80\x89=\xe2\x80\x89s1s2... sn is called a palindrome if for all i from 1 to n the following fulfills: si\xe2\x80\x89=\xe2\x80\x89sn\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891. In other words, palindrome read the same in both directions.String x\xe2\x80\x89=\xe2\x80\x89x1x2... x|x| is lexicographically larger than string y\xe2\x80\x89=\xe2\x80\x89y1y2... y|y|, if either |x|\xe2\x80\x89>\xe2\x80\x89|y| and x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89x|y|\xe2\x80\x89=\xe2\x80\x89y|y|, or there exists such number r (r\xe2\x80\x89<\xe2\x80\x89|x|,\xe2\x80\x89r\xe2\x80\x89<\xe2\x80\x89|y|), that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xr\xe2\x80\x89=\xe2\x80\x89yr and xr\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89yr\xe2\x80\x89+\xe2\x80\x891. Characters in such strings are compared like their ASCII codes." 2800.0
                                                191C "Fools and Roads" "data structures,dfs and similar,trees" "They say that Berland has exactly two problems, fools and roads. Besides, Berland has n cities, populated by the fools and connected by the roads. All Berland roads are bidirectional. As there are many fools in Berland, between each pair of cities there is a path (or else the fools would get upset). Also, between each pair of cities there is no more than one simple path (or else the fools would get lost). But that is not the end of Berland\'s special features. In this country fools sometimes visit each other and thus spoil the roads. The fools aren\'t very smart, so they always use only the simple paths.A simple path is the path which goes through every Berland city not more than once.The Berland government knows the paths which the fools use. Help the government count for each road, how many distinct fools can go on it.Note how the fools\' paths are given in the input." 1900.0
                                                188H Stack "*special problem,expression parsing,implementation" "In this problem we\'ll use a stack which supports two types of operations:  Push a given number on the stack.  Pop two numbers from the stack, perform a given operation (addition or multiplication) on them and push the result on the stack. You are given a string which describes the sequence of operations to be performed on the stack. i-th character corresponds to i-th operation:  If i-th character is a digit, push the corresponding number on the stack.  If i-th character is \xc2\xab+\xc2\xbb or \xc2\xab*\xc2\xbb, perform the corresponding operation. Initially the stack is empty. Output the topmost number on the stack after executing all given operations." 1800.0
                                                187A Permutations greedy "Happy PMP is freshman and he is learning about algorithmic problems. He enjoys playing algorithmic games a lot.One of the seniors gave Happy PMP a nice game. He is given two permutations of numbers 1 through n and is asked to convert the first one to the second. In one move he can remove the last number from the permutation of numbers and inserts it back in an arbitrary position. He can either insert last number between any two consecutive numbers, or he can place it at the beginning of the permutation.Happy PMP has an algorithm that solves the problem. But it is not fast enough. He wants to know the minimum number of moves to convert the first permutation to the second." 1500.0
                                                183E "Candy Shop" greedy "The prestigious Codeforces kindergarten consists of n kids, numbered 1 through n. Each of them are given allowance in rubles by their parents.Today, they are going to the most famous candy shop in the town. The shop sells candies in packages: for all i between 1 and m, inclusive, it sells a package containing exactly i candies. A candy costs one ruble, so a package containing x candies costs x rubles.The kids will purchase candies in turns, starting from kid 1. In a single turn, kid i will purchase one candy package. Due to the highly competitive nature of Codeforces kindergarten, during a turn, the number of candies contained in the package purchased by the kid will always be strictly greater than the number of candies contained in the package purchased by the kid in the preceding turn (an exception is in the first turn: the first kid may purchase any package). Then, the turn proceeds to kid i\xe2\x80\x89+\xe2\x80\x891, or to kid 1 if it was kid n\'s turn. This process can be ended at any time, but at the end of the purchase process, all the kids must have the same number of candy packages. Of course, the amount spent by each kid on the candies cannot exceed their allowance.You work at the candy shop and would like to prepare the candies for the kids. Print the maximum number of candies that can be sold by the candy shop to the kids. If the kids cannot purchase any candy (due to insufficient allowance), print 0." 2900.0
                                                183A Headquarters "constructive algorithms,math" "Sensation, sensation in the two-dimensional kingdom! The police have caught a highly dangerous outlaw, member of the notorious ""Pihters"" gang. The law department states that the outlaw was driving from the gang\'s headquarters in his car when he crashed into an ice cream stall. The stall, the car, and the headquarters each occupies exactly one point on the two-dimensional kingdom.The outlaw\'s car was equipped with a GPS transmitter. The transmitter showed that the car made exactly n movements on its way from the headquarters to the stall. A movement can move the car from point (x,\xe2\x80\x89y) to one of these four points: to point (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y) which we will mark by letter ""L"", to point (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y) \xe2\x80\x94 ""R"", to point (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) \xe2\x80\x94 ""D"", to point (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 ""U"".The GPS transmitter is very inaccurate and it doesn\'t preserve the exact sequence of the car\'s movements. Instead, it keeps records of the car\'s possible movements. Each record is a string of one of these types: ""UL"", ""UR"", ""DL"", ""DR"" or ""ULDR"". Each such string means that the car made a single movement corresponding to one of the characters of the string. For example, string ""UL"" means that the car moved either ""U"", or ""L"".You\'ve received the journal with the outlaw\'s possible movements from the headquarters to the stall. The journal records are given in a chronological order. Given that the ice-cream stall is located at point (0,\xe2\x80\x890), your task is to print the number of different points that can contain the gang headquarters (that is, the number of different possible locations of the car\'s origin)." 1700.0
                                                182B "Vasya\'s Calendar" implementation "Vasya lives in a strange world. The year has n months and the i-th month has ai days. Vasya got a New Year present \xe2\x80\x94 the clock that shows not only the time, but also the date.The clock\'s face can display any number from 1 to d. It is guaranteed that ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d for all i from 1 to n. The clock does not keep information about the current month, so when a new day comes, it simply increases the current day number by one. The clock cannot display number d\xe2\x80\x89+\xe2\x80\x891, so after day number d it shows day 1 (the current day counter resets). The mechanism of the clock allows you to increase the day number by one manually. When you execute this operation, day d is also followed by day 1.Vasya begins each day checking the day number on the clock. If the day number on the clock does not match the actual day number in the current month, then Vasya manually increases it by one. Vasya is persistent and repeats this operation until the day number on the clock matches the actual number of the current day in the current month.A year passed and Vasya wonders how many times he manually increased the day number by one, from the first day of the first month to the last day of the n-th month inclusive, considering that on the first day of the first month the clock display showed day 1." 1000.0
                                                178E3 "The Beaver\'s Problem - 2"  "Offering the ABBYY Cup participants a problem written by the Smart Beaver is becoming a tradition. He proposed the following problem.You are given a monochrome image, that is, an image that is composed of two colors (black and white). The image is given in raster form, that is, as a matrix of pixels\' colors, and the matrix\'s size coincides with the size of the image.The white color on the given image corresponds to the background. Also, the image contains several black geometric shapes. It is known that the image can contain only two types of shapes: squares and circles. Your task is to count the number of circles and the number of squares which the given image contains.The squares on the image can be rotated arbitrarily. In addition, the image can possibly contain some noise arranged as follows: each pixel of the original image can change its color to the opposite with the probability of 20%.   An example of an image that has no noise and the sides of the squares are parallel to the coordinate axes (two circles and three squares).     An example of an image that has no noise and the squares are rotated arbitrarily (two circles and three squares).     An example of an image that has noise and the squares are rotated arbitrarily (one circle and three squares)." 2300.0
                                                178E2 "The Beaver\'s Problem - 2"  "Offering the ABBYY Cup participants a problem written by the Smart Beaver is becoming a tradition. He proposed the following problem.You are given a monochrome image, that is, an image that is composed of two colors (black and white). The image is given in raster form, that is, as a matrix of pixels\' colors, and the matrix\'s size coincides with the size of the image.The white color on the given image corresponds to the background. Also, the image contains several black geometric shapes. It is known that the image can contain only two types of shapes: squares and circles. Your task is to count the number of circles and the number of squares which the given image contains.The squares on the image can be rotated arbitrarily. In addition, the image can possibly contain some noise arranged as follows: each pixel of the original image can change its color to the opposite with the probability of 20%.   An example of an image that has no noise and the sides of the squares are parallel to the coordinate axes (two circles and three squares).     An example of an image that has no noise and the squares are rotated arbitrarily (two circles and three squares).     An example of an image that has noise and the squares are rotated arbitrarily (one circle and three squares)." 2000.0
                                                178D1 "Magic Squares"  "The Smart Beaver from ABBYY loves puzzles. One of his favorite puzzles is the magic square. He has recently had an idea to automate the solution of this puzzle. The Beaver decided to offer this challenge to the ABBYY Cup contestants.The magic square is a matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n. The elements of this matrix are integers. The sum of numbers in each row of the matrix is equal to some number s. The sum of numbers in each column of the matrix is also equal to s. In addition, the sum of the elements on the main diagonal is equal to s and the sum of elements on the secondary diagonal is equal to s. Examples of magic squares are given in the following figure:   Magic squares  You are given a set of n2 integers ai. It is required to place these numbers into a square matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n so that they form a magic square. Note that each number must occur in the matrix exactly the same number of times as it occurs in the original set.It is guaranteed that a solution exists!" 1500.0
                                                178B2 "Greedy Merchants"  "In ABBYY a wonderful Smart Beaver lives. This time, he began to study history. When he read about the Roman Empire, he became interested in the life of merchants.The Roman Empire consisted of n cities numbered from 1 to n. It also had m bidirectional roads numbered from 1 to m. Each road connected two different cities. Any two cities were connected by no more than one road.We say that there is a path between cities c1 and c2 if there exists a finite sequence of cities t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tp (p\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) such that:  t1\xe2\x80\x89=\xe2\x80\x89c1  tp\xe2\x80\x89=\xe2\x80\x89c2  for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89p), cities ti and ti\xe2\x80\x89+\xe2\x80\x891 are connected by a road We know that there existed a path between any two cities in the Roman Empire.In the Empire k merchants lived numbered from 1 to k. For each merchant we know a pair of numbers si and li, where si is the number of the city where this merchant\'s warehouse is, and li is the number of the city where his shop is. The shop and the warehouse could be located in different cities, so the merchants had to deliver goods from the warehouse to the shop.Let\'s call a road important for the merchant if its destruction threatens to ruin the merchant, that is, without this road there is no path from the merchant\'s warehouse to his shop. Merchants in the Roman Empire are very greedy, so each merchant pays a tax (1 dinar) only for those roads which are important for him. In other words, each merchant pays di dinars of tax, where di (di\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) is the number of roads important for the i-th merchant.The tax collection day came in the Empire. The Smart Beaver from ABBYY is very curious by nature, so he decided to count how many dinars each merchant had paid that day. And now he needs your help." 1600.0
                                                178B1 "Greedy Merchants"  "In ABBYY a wonderful Smart Beaver lives. This time, he began to study history. When he read about the Roman Empire, he became interested in the life of merchants.The Roman Empire consisted of n cities numbered from 1 to n. It also had m bidirectional roads numbered from 1 to m. Each road connected two different cities. Any two cities were connected by no more than one road.We say that there is a path between cities c1 and c2 if there exists a finite sequence of cities t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tp (p\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) such that:  t1\xe2\x80\x89=\xe2\x80\x89c1  tp\xe2\x80\x89=\xe2\x80\x89c2  for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89p), cities ti and ti\xe2\x80\x89+\xe2\x80\x891 are connected by a road We know that there existed a path between any two cities in the Roman Empire.In the Empire k merchants lived numbered from 1 to k. For each merchant we know a pair of numbers si and li, where si is the number of the city where this merchant\'s warehouse is, and li is the number of the city where his shop is. The shop and the warehouse could be located in different cities, so the merchants had to deliver goods from the warehouse to the shop.Let\'s call a road important for the merchant if its destruction threatens to ruin the merchant, that is, without this road there is no path from the merchant\'s warehouse to his shop. Merchants in the Roman Empire are very greedy, so each merchant pays a tax (1 dinar) only for those roads which are important for him. In other words, each merchant pays di dinars of tax, where di (di\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) is the number of roads important for the i-th merchant.The tax collection day came in the Empire. The Smart Beaver from ABBYY is very curious by nature, so he decided to count how many dinars each merchant had paid that day. And now he needs your help." 1600.0
                                                178A1 "Educational Game"  "The Smart Beaver from ABBYY began to develop a new educational game for children. The rules of the game are fairly simple and are described below.The playing field is a sequence of n non-negative integers ai numbered from 1 to n. The goal of the game is to make numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak (i.e. some prefix of the sequence) equal to zero for some fixed k (k\xe2\x80\x89<\xe2\x80\x89n), and this should be done in the smallest possible number of moves.One move is choosing an integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that ai\xe2\x80\x89>\xe2\x80\x890 and an integer t (t\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) such that i\xe2\x80\x89+\xe2\x80\x892t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. After the values of i and t have been selected, the value of ai is decreased by 1, and the value of ai\xe2\x80\x89+\xe2\x80\x892t is increased by 1. For example, let n\xe2\x80\x89=\xe2\x80\x894 and a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892), then it is possible to make move i\xe2\x80\x89=\xe2\x80\x893, t\xe2\x80\x89=\xe2\x80\x890 and get a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x893) or to make move i\xe2\x80\x89=\xe2\x80\x891, t\xe2\x80\x89=\xe2\x80\x891 and get a\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x890,\xe2\x80\x892,\xe2\x80\x892) (the only possible other move is i\xe2\x80\x89=\xe2\x80\x891, t\xe2\x80\x89=\xe2\x80\x890).You are given n and the initial sequence ai. The task is to calculate the minimum number of moves needed to make the first k elements of the original sequence equal to zero for each possible k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n)." 1000.0
                                                177F1 "Script Generation"  "The Smart Beaver from ABBYY was offered a job of a screenwriter for the ongoing TV series. In particular, he needs to automate the hard decision: which main characters will get married by the end of the series.There are n single men and n single women among the main characters. An opinion poll showed that viewers like several couples, and a marriage of any of them will make the audience happy. The Smart Beaver formalized this fact as k triples of numbers (h,\xe2\x80\x89w,\xe2\x80\x89r), where h is the index of the man, w is the index of the woman, and r is the measure of the audience\'s delight in case of the marriage of this couple. The same poll showed that the marriage of any other couple will leave the audience indifferent, so the screenwriters decided not to include any such marriages in the plot.The script allows you to arrange several marriages between the heroes or not to arrange marriages at all. A subset of some of the k marriages is considered acceptable if each man and each woman is involved in at most one marriage of the subset (the series won\'t allow any divorces). The value of the acceptable set of marriages is the total delight the spectators will get from the marriages included in this set.Obviously, there is a finite number of acceptable sets, and they all describe some variants of the script. The screenwriters do not want to choose a set with maximum value \xe2\x80\x94 it would make the plot too predictable. So the Smart Beaver offers the following option: sort all the acceptable sets in increasing order of value and choose the t-th set from the sorted list. Thus, t\xe2\x80\x89=\xe2\x80\x891 corresponds to a plot without marriages, t\xe2\x80\x89=\xe2\x80\x892 \xe2\x80\x94 to a single marriage resulting in minimal delight for the audience, and so on.Help the Beaver to implement the algorithm for selecting the desired set." 1800.0
                                                177C1 Party "dfs and similar,dsu,graphs" "To celebrate the second ABBYY Cup tournament, the Smart Beaver decided to throw a party. The Beaver has a lot of acquaintances, some of them are friends with each other, and some of them dislike each other. To make party successful, the Smart Beaver wants to invite only those of his friends who are connected by friendship relations, and not to invite those who dislike each other. Both friendship and dislike are mutual feelings.More formally, for each invited person the following conditions should be fulfilled:   all his friends should also be invited to the party;  the party shouldn\'t have any people he dislikes;  all people who are invited to the party should be connected with him by friendship either directly or through a chain of common friends of arbitrary length. We\'ll say that people a1 and ap are connected through a chain of common friends if there exists a sequence of people a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89ap\xe2\x80\x89-\xe2\x80\x891 such that all pairs of people ai and ai\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89p) are friends. Help the Beaver find the maximum number of acquaintances he can invite." 1500.0
                                                177A1 "Good Matrix Elements" implementation "The Smart Beaver from ABBYY got hooked on square matrices. Now he is busy studying an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n size matrix, where n is odd. The Smart Beaver considers the following matrix elements good:    Elements of the main diagonal.   Elements of the secondary diagonal.   Elements of the ""middle"" row \xe2\x80\x94 the row which has exactly  rows above it and the same number of rows below it.   Elements of the ""middle"" column \xe2\x80\x94 the column that has exactly  columns to the left of it and the same number of columns to the right of it.    The figure shows a 5\xe2\x80\x89\xc3\x97\xe2\x80\x895 matrix.   The good elements are marked with green.  Help the Smart Beaver count the sum of good elements of the given matrix." 800.0
                                                175D "Plane of Tanks: Duel" "brute force,dp,math,probabilities" "Vasya plays the Plane of Tanks.Tanks are described with the following attributes:   the number of hit points;  the interval between two gun shots (the time required to recharge the gun);  the probability that the gun shot will not pierce armor of the enemy tank;  the damage to the enemy\'s tank. The gun damage is described with a segment [l,\xe2\x80\x89r], where l and r are integer numbers. The potential gun damage x is chosen with equal probability among all integer numbers of the segment [l,\xe2\x80\x89r]. If the shot pierces the armor of an enemy\'s tank then the enemy loses x hit points. If the number of hit points becomes non-positive then the enemy tank is considered destroyed. It is possible that the shot does not pierce the armor of a tank. In this case the number of hit points doesn\'t change. The probability that the armor will not be pierced is considered as the shooting tank attribute and does not depend on players\' behavior.The victory is near and there is only one enemy tank left. Vasya is ready for the battle \xe2\x80\x94 one more battle between the Good and the Evil is inevitable! Two enemies saw each other and each of them fired a shot at the same moment... The last battle has begun! Help Vasya to determine what is the probability that he will win the battle by destroying the enemy tank? If both tanks are destroyed (after simultaneous shots), then Vasya is considered a winner. You can assume that each player fires a shot just after the gun recharge and each tank has infinite number of ammo." 2400.0
                                                173A Rock-Paper-Scissors implementation,math "Nikephoros and Polycarpus play rock-paper-scissors. The loser gets pinched (not too severely!).Let us remind you the rules of this game. Rock-paper-scissors is played by two players. In each round the players choose one of three items independently from each other. They show the items with their hands: a rock, scissors or paper. The winner is determined by the following rules: the rock beats the scissors, the scissors beat the paper and the paper beats the rock. If the players choose the same item, the round finishes with a draw.Nikephoros and Polycarpus have played n rounds. In each round the winner gave the loser a friendly pinch and the loser ended up with a fresh and new red spot on his body. If the round finished in a draw, the players did nothing and just played on.Nikephoros turned out to have worked out the following strategy: before the game began, he chose some sequence of items A\xe2\x80\x89=\xe2\x80\x89(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am), and then he cyclically showed the items from this sequence, starting from the first one. Cyclically means that Nikephoros shows signs in the following order: a1, a2, ..., am, a1, a2, ..., am, a1, ... and so on. Polycarpus had a similar strategy, only he had his own sequence of items B\xe2\x80\x89=\xe2\x80\x89(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk).Determine the number of red spots on both players after they\'ve played n rounds of the game. You can consider that when the game began, the boys had no red spots on them." 1300.0
                                                172E BHTML+BCSS "*special problem,dfs and similar,expression parsing" "This problem is about imaginary languages BHTML and BCSS, which slightly resemble HTML and CSS. Read the problem statement carefully as the resemblance is rather slight and the problem uses very simplified analogs.You are given a BHTML document that resembles HTML but is much simpler. It is recorded as a sequence of opening and closing tags. A tag that looks like ""<tagname>"" is called an opening tag and a tag that looks like ""</tagname>"" is called a closing tag. Besides, there are self-closing tags that are written as ""<tagname/>"" and in this problem they are fully equivalent to ""<tagname></tagname>"". All tagnames in this problem are strings consisting of lowercase Latin letters with length from 1 to 10 characters. Tagnames of different tags may coincide.The document tags form a correct bracket sequence, that is, we can obtain an empty sequence from the given one using the following operations:   remove any self-closing tag ""<tagname/>"",  remove a pair of an opening and a closing tag that go consecutively (in this order) and have the same names. In other words, remove substring ""<tagname></tagname>"". For example, you may be given such document: ""<header><p><a/><b></b></p></header><footer></footer>"" but you may not be given documents ""<a>"", ""<a></b>"", ""</a><a>"" or ""<a><b></a></b>"".Obviously, for any opening tag there is the only matching closing one \xe2\x80\x94 each such pair is called an element. A self-closing tag also is an element. Let\'s consider that one element is nested inside another one, if tags of the first element are between tags of the second one. An element is not nested to itself. For instance, in the example above element ""b"" is nested in ""header"" and in ""p"", but it isn\'t nested in ""a"" and ""footer"", also it isn\'t nested to itself (""b""). Element ""header"" has three elements nested in it, and ""footer"" has zero.We need the BCSS rules to apply styles when displaying elements of the BHTML documents. Each rule is recorded as a subsequence of words ""x1 x2 ... xn"". This rule has effect over all such elements t, which satisfy both conditions from the list:  there is a sequence of nested elements with tagnames ""x1"", ""x2"", ..., ""xn"" (that is, the second element is nested in the first one, the third element is nested in the second one and so on),  this sequence ends with element t (i.e. tagname of element t equals ""xn""). For example, element ""b"" meets the conditions of the rule ""a b"" if for element ""b"" exists element ""a"" in which it is nested. Element ""c"" meets the conditions of the rule ""a b b c"", if three elements exist: ""a"", ""b"", ""b"", and in the chain ""a""-""b""-""b""-""c"" each following element is nested in the previous one.Given a BHTML document and a set of BCSS rules, write a program that determines the number of elements that meet the conditions of each rule." 2200.0
                                                172D "Calendar Reform" "*special problem,number theory" "Reforms have started in Berland again! At this time, the Parliament is discussing the reform of the calendar. To make the lives of citizens of Berland more varied, it was decided to change the calendar. As more and more people are complaining that ""the years fly by..."", it was decided that starting from the next year the number of days per year will begin to grow. So the coming year will have exactly a days, the next after coming year will have a\xe2\x80\x89+\xe2\x80\x891 days, the next one will have a\xe2\x80\x89+\xe2\x80\x892 days and so on. This schedule is planned for the coming n years (in the n-th year the length of the year will be equal a\xe2\x80\x89+\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891 day).No one has yet decided what will become of months. An MP Palevny made the following proposal.   The calendar for each month is comfortable to be printed on a square sheet of paper. We are proposed to make the number of days in each month be the square of some integer. The number of days per month should be the same for each month of any year, but may be different for different years.  The number of days in each year must be divisible by the number of days per month in this year. This rule ensures that the number of months in each year is an integer.  The number of days per month for each year must be chosen so as to save the maximum amount of paper to print the calendars. In other words, the number of days per month should be as much as possible. These rules provide an unambiguous method for choosing the number of days in each month for any given year length. For example, according to Palevny\'s proposition, a year that consists of 108 days will have three months, 36 days each. The year that consists of 99 days will have 11 months, 9 days each, and a year of 365 days will have 365 months, one day each.The proposal provoked heated discussion in the community, the famous mathematician Perelmanov quickly calculated that if the proposal is supported, then in a period of n years, beginning with the year that has a days, the country will spend p sheets of paper to print a set of calendars for these years. Perelmanov\'s calculations take into account the fact that the set will contain one calendar for each year and each month will be printed on a separate sheet.Repeat Perelmanov\'s achievement and print the required number p. You are given positive integers a and n. Perelmanov warns you that your program should not work longer than four seconds at the maximum test." 1500.0
                                                171G "Mysterious numbers - 2" "*special problem" "InputThe only line of input contains three integers a1,\xe2\x80\x89a2,\xe2\x80\x89a3 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89a3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8920), separated by spaces.OutputOutput a single integer.ExamplesInputCopy2 3 2OutputCopy5InputCopy13 14 1OutputCopy14InputCopy14 5 9OutputCopy464InputCopy17 18 3OutputCopy53" 1600.0
                                                171F ucyhf "*special problem,brute force,implementation,number theory" "qd ucyhf yi q fhycu dkcruh mxeiu huluhiu yi q tyvvuhudj fhycu dkcruh. oekh jqia yi je vydt jxu djx ucyhf." 1600.0
                                                171A "Mysterious numbers - 1" "*special problem,constructive algorithms" "InputThe input contains two integers a1,\xe2\x80\x89a2 (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89109), separated by a single space.OutputOutput a single integer.ExamplesInputCopy3 14OutputCopy44InputCopy27 12OutputCopy48InputCopy100 200OutputCopy102" 1200.0
                                                165C "Another Problem on Strings" "binary search,brute force,dp,math,strings,two pointers" "A string is binary, if it consists only of characters ""0"" and ""1"".String v is a substring of string w if it has a non-zero length and can be read starting from some position in string w. For example, string ""010"" has six substrings: ""0"", ""1"", ""0"", ""01"", ""10"", ""010"". Two substrings are considered different if their positions of occurrence are different. So, if some string occurs multiple times, we should consider it the number of times it occurs.You are given a binary string s. Your task is to find the number of its substrings, containing exactly k characters ""1""." 1600.0
                                                164D "Minimum Diameter" "binary search,brute force" "You are given n points on the plane. You need to delete exactly k of them (k\xe2\x80\x89<\xe2\x80\x89n) so that the diameter of the set of the remaining n\xe2\x80\x89-\xe2\x80\x89k points were as small as possible. The diameter of a set of points is the maximum pairwise distance between the points of the set. The diameter of a one point set equals zero." 3100.0
                                                163D "Large Refrigerator" "brute force" "Vasya wants to buy a new refrigerator. He believes that a refrigerator should be a rectangular parallelepiped with integer edge lengths. Vasya calculated that for daily use he will need a refrigerator with volume of at least V. Moreover, Vasya is a minimalist by nature, so the volume should be no more than V, either \xe2\x80\x94 why take up extra space in the apartment? Having made up his mind about the volume of the refrigerator, Vasya faced a new challenge \xe2\x80\x94 for a fixed volume of V the refrigerator must have the minimum surface area so that it is easier to clean.The volume and the surface area of a refrigerator with edges a, b, c are equal to V\xe2\x80\x89=\xe2\x80\x89abc and S\xe2\x80\x89=\xe2\x80\x892(ab\xe2\x80\x89+\xe2\x80\x89bc\xe2\x80\x89+\xe2\x80\x89ca), correspondingly.Given the volume V, help Vasya find the integer lengths for the refrigerator\'s edges a, b, c so that the refrigerator\'s volume equals V and its surface area S is minimized." 2900.0
                                                162H "Alternating case" "*special problem" "You are given a string consisting of alphabet letters. Convert it to alternating case: the letters on odd positions should be in uppercase, and the letters on even positions should be lowercase. The letters are numbered staring from 1." 1800.0
                                                162E HQ9+ "*special problem" "HQ9+ is a joke programming language which has only four one-character instructions: ""H"" prints ""Hello, World!"", ""Q"" prints the whole source code of the program itself (at each call), ""9"" prints the lyrics of ""99 Bottles of Beer"" song,  ""+"" increments the value stored in the internal accumulator.Instructions ""H"" and ""Q"" are case-sensitive and must be uppercase. The characters of the program which are not instructions are ignored.You are given a program written in HQ9+. You have to figure out whether executing this program will produce any output." 1800.0
                                                160D "Edges in MST" "dfs and similar,dsu,graphs,sortings" "You are given a connected weighted undirected graph without any loops and multiple edges. Let us remind you that a graph\'s spanning tree is defined as an acyclic connected subgraph of the given graph that includes all of the graph\'s vertexes. The weight of a tree is defined as the sum of weights of the edges that the given tree contains. The minimum spanning tree (MST) of a graph is defined as the graph\'s spanning tree having the minimum possible weight. For any connected graph obviously exists the minimum spanning tree, but in the general case, a graph\'s minimum spanning tree is not unique.Your task is to determine the following for each edge of the given graph: whether it is either included in any MST, or included at least in one MST, or not included in any MST." 2300.0
                                                154B Colliders "math,number theory" "By 2312 there were n Large Hadron Colliders in the inhabited part of the universe. Each of them corresponded to a single natural number from 1 to n. However, scientists did not know what activating several colliders simultaneously could cause, so the colliders were deactivated.In 2312 there was a startling discovery: a collider\'s activity is safe if and only if all numbers of activated colliders are pairwise relatively prime to each other (two numbers are relatively prime if their greatest common divisor equals 1)! If two colliders with relatively nonprime numbers are activated, it will cause a global collapse.Upon learning this, physicists rushed to turn the colliders on and off and carry out all sorts of experiments. To make sure than the scientists\' quickness doesn\'t end with big trouble, the Large Hadron Colliders\' Large Remote Control was created. You are commissioned to write the software for the remote (well, you do not expect anybody to operate it manually, do you?).Initially, all colliders are deactivated. Your program receives multiple requests of the form ""activate/deactivate the i-th collider"". The program should handle requests in the order of receiving them. The program should print the processed results in the format described below.To the request of ""+ i"" (that is, to activate the i-th collider), the program should print exactly one of the following responses:   ""Success"" if the activation was successful.  ""Already on"", if the i-th collider was already activated before the request.  ""Conflict with j"", if there is a conflict with the j-th collider (that is, the j-th collider is on, and numbers i and j are not relatively prime). In this case, the i-th collider shouldn\'t be activated. If a conflict occurs with several colliders simultaneously, you should print the number of any of them. The request of ""- i"" (that is, to deactivate the i-th collider), should receive one of the following responses from the program:   ""Success"", if the deactivation was successful.  ""Already off"", if the i-th collider was already deactivated before the request. You don\'t need to print quotes in the output of the responses to the requests." 1600.0
                                                153D "Date Change" "*special problem" "You are given a date in ""DD.MM.YYYY"" (""day.month.year"") format and a number of days shift you have to add to this date. Output the resulting date." 2000.0
                                                153A "A + B" "*special problem" "You are given two integers A and B. Calculate their sum and output it without leading zeros." 1600.0
                                                150A "Win or Freeze" "games,math,number theory" "You can\'t possibly imagine how cold our friends are this winter in Nvodsk! Two of them play the following game to warm up: initially a piece of paper has an integer q. During a move a player should write any integer number that is a non-trivial divisor of the last written number. Then he should run this number of circles around the hotel. Let us remind you that a number\'s divisor is called non-trivial if it is different from one and from the divided number itself. The first person who can\'t make a move wins as he continues to lie in his warm bed under three blankets while the other one keeps running. Determine which player wins considering that both players play optimally. If the first player wins, print any winning first move." 1400.0
                                                149A "Business trip" greedy,implementation,sortings "What joy! Petya\'s parents went on a business trip for the whole year and the playful kid is left all by himself. Petya got absolutely happy. He jumped on the bed and threw pillows all day long, until... Today Petya opened the cupboard and found a scary note there. His parents had left him with duties: he should water their favourite flower all year, each day, in the morning, in the afternoon and in the evening. ""Wait a second!"" \xe2\x80\x94 thought Petya. He know for a fact that if he fulfills the parents\' task in the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8912) month of the year, then the flower will grow by ai centimeters, and if he doesn\'t water the flower in the i-th month, then the flower won\'t grow this month. Petya also knows that try as he might, his parents won\'t believe that he has been watering the flower if it grows strictly less than by k centimeters. Help Petya choose the minimum number of months when he will water the flower, given that the flower should grow no less than by k centimeters." 900.0
                                                148D "Bag of mice" dp,games,math,probabilities "The dragon and the princess are arguing about what to do on the New Year\'s Eve. The dragon suggests flying to the mountains to watch fairies dancing in the moonlight, while the princess thinks they should just go to bed early. They are desperate to come to an amicable agreement, so they decide to leave this up to chance.They take turns drawing a mouse from a bag which initially contains w white and b black mice. The person who is the first to draw a white mouse wins. After each mouse drawn by the dragon the rest of mice in the bag panic, and one of them jumps out of the bag itself (the princess draws her mice carefully and doesn\'t scare other mice). Princess draws first. What is the probability of the princess winning?If there are no more mice in the bag and nobody has drawn a white mouse, the dragon wins. Mice which jump out of the bag themselves are not considered to be drawn (do not define the winner). Once a mouse has left the bag, it never returns to it. Every mouse is drawn from the bag with the same probability as every other one, and every mouse jumps out of the bag with the same probability as every other one." 1800.0
                                                146A "Lucky Ticket" implementation "Petya loves lucky numbers very much. Everybody knows that lucky numbers are positive integers whose decimal record contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya loves tickets very much. As we know, each ticket has a number that is a positive integer. Its length equals n (n is always even). Petya calls a ticket lucky if the ticket\'s number is a lucky number and the sum of digits in the first half (the sum of the first n\xe2\x80\x89/\xe2\x80\x892 digits) equals the sum of digits in the second half (the sum of the last n\xe2\x80\x89/\xe2\x80\x892 digits). Check if the given ticket is lucky." 800.0
                                                145E "Lucky Queries" "data structures" "Petya loves lucky numbers very much. Everybody knows that lucky numbers are positive integers whose decimal record contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya brought home string s with the length of n. The string only consists of lucky digits. The digits are numbered from the left to the right starting with 1. Now Petya should execute m queries of the following form:  switch l r \xe2\x80\x94 ""switch"" digits (i.e. replace them with their opposites) at all positions with indexes from l to r, inclusive: each digit 4 is replaced with 7 and each digit 7 is replaced with 4 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n);  count \xe2\x80\x94 find and print on the screen the length of the longest non-decreasing subsequence of string s. Subsequence of a string s is a string that can be obtained from s by removing zero or more of its elements. A string is called non-decreasing if each successive digit is not less than the previous one.Help Petya process the requests." 2400.0
                                                145B "Lucky Number 2" "constructive algorithms" "Petya loves lucky numbers very much. Everybody knows that lucky numbers are positive integers whose decimal record contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya loves long lucky numbers very much. He is interested in the minimum lucky number d that meets some condition. Let cnt(x) be the number of occurrences of number x in number d as a substring. For example, if d\xe2\x80\x89=\xe2\x80\x89747747, then cnt(4)\xe2\x80\x89=\xe2\x80\x892, cnt(7)\xe2\x80\x89=\xe2\x80\x894, cnt(47)\xe2\x80\x89=\xe2\x80\x892, cnt(74)\xe2\x80\x89=\xe2\x80\x892. Petya wants the following condition to fulfil simultaneously: cnt(4)\xe2\x80\x89=\xe2\x80\x89a1, cnt(7)\xe2\x80\x89=\xe2\x80\x89a2, cnt(47)\xe2\x80\x89=\xe2\x80\x89a3, cnt(74)\xe2\x80\x89=\xe2\x80\x89a4. Petya is not interested in the occurrences of other numbers. Help him cope with this task." 1800.0
                                                134B "Pairs of Numbers" "brute force,dfs and similar,math,number theory" "Let\'s assume that we have a pair of numbers (a,\xe2\x80\x89b). We can get a new pair (a\xe2\x80\x89+\xe2\x80\x89b,\xe2\x80\x89b) or (a,\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x89b) from the given pair in a single step.Let the initial pair of numbers be (1,1). Your task is to find number k, that is, the least number of steps needed to transform (1,1) into the pair where at least one number equals n." 1900.0
                                                132A "Turing Tape" implementation "INTERCAL is the oldest of esoteric programming languages. One of its many weird features is the method of character-based output, known as Turing Tape method. It converts an array of unsigned 8-bit integers into a sequence of characters to print, using the following method.The integers of the array are processed one by one, starting from the first. Processing i-th element of the array is done in three steps:1. The 8-bit binary notation of the ASCII-code of the previous printed character is reversed. When the first element of the array is processed, the result of this step is considered to be 0.2. The i-th element of the array is subtracted from the result of the previous step modulo 256.3. The binary notation of the result of the previous step is reversed again to produce ASCII-code of the i-th character to be printed.You are given the text printed using this method. Restore the array used to produce this text." 1300.0
                                                131C "The World is a Theatre" combinatorics,math "There are n boys and m girls attending a theatre club. To set a play ""The Big Bang Theory"", they need to choose a group containing exactly t actors containing no less than 4 boys and no less than one girl. How many ways are there to choose a group? Of course, the variants that only differ in the composition of the troupe are considered different.Perform all calculations in the 64-bit type: long long for \xd0\xa1/\xd0\xa1++, int64 for Delphi and long for Java." 1400.0
                                                130J "Date calculation" "*special problem" "In Gregorian calendar a typical year consists of 365 days and 12 months. The numbers of days in the months are: 31,\xe2\x80\x8928,\xe2\x80\x8931,\xe2\x80\x8930,\xe2\x80\x8931,\xe2\x80\x8930,\xe2\x80\x8931,\xe2\x80\x8931,\xe2\x80\x8930,\xe2\x80\x8931,\xe2\x80\x8930,\xe2\x80\x8931. If year index is divisible by 400, or divisible by 4 but not by 100, the year becomes leap year, with one extra day in the second month (the one which typically has 28 days).You are given the index of the year and the index of the day in the year. Find out the date of this day (day and month it will fall upon)." 1800.0
                                                130F "Prime factorization" "*special problem" "You are given an integer n. Output its prime factorization.If n\xe2\x80\x89=\xe2\x80\x89a1b1a2b2 ... akbk, where ak are prime numbers, the output of your program should look as follows: a1 a1 ... a1 a2 a2 ... a2 ... ak ak ... ak, where factors are ordered in non-decreasing order, and each factor ai is printed bi times." 1600.0
                                                123C Brackets combinatorics,dp,greedy "A two dimensional array is called a bracket array if each grid contains one of the two possible brackets \xe2\x80\x94 ""("" or "")"". A path through the two dimensional array cells is called monotonous if any two consecutive cells in the path are side-adjacent and each cell of the path is located below or to the right from the previous one. A two dimensional array whose size equals n\xe2\x80\x89\xc3\x97\xe2\x80\x89m is called a correct bracket array, if any string formed by writing out the brackets on some monotonous way from cell (1,\xe2\x80\x891) to cell (n,\xe2\x80\x89m) forms a correct bracket sequence. Let\'s define the operation of comparing two correct bracket arrays of equal size (a and b) like that. Let\'s consider a given two dimensional array of priorities (c) \xe2\x80\x94 a two dimensional array of same size, containing different integers from 1 to nm. Let\'s find such position (i,\xe2\x80\x89j) in the two dimensional array, that ai,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi,\xe2\x80\x89j. If there are several such positions, let\'s choose the one where number ci,\xe2\x80\x89j is minimum. If ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89""("", then a\xe2\x80\x89<\xe2\x80\x89b, otherwise a\xe2\x80\x89>\xe2\x80\x89b. If the position (i,\xe2\x80\x89j) is not found, then the arrays are considered equal.Your task is to find a k-th two dimensional correct bracket array. It is guaranteed that for the given sizes of n and m there will be no less than k two dimensional correct bracket arrays." 2300.0
                                                119E "Alternative Reality" geometry "In the year of 3000 travelling around parallel realities became a routine thing. However one has to take into consideration that travelling like that is highly dangerous as you never know beforehand where you\'re gonna get...Little Vasya, for instance, found himself in a gaming reality and now he has to successfully complete all levels of a very weird game to get back. The gaming reality is a three-dimensional space where n points are given. The game has m levels and at the beginning of the i-th level the player is positioned at some plane Qi that passes through the origin. On each level Vasya has to use special robots to construct and activate n powerful energy spheres of the equal radius with centers at the given points. The player chooses the radius of the spheres himself. The player has to spend R units of money to construct spheres whose radius equals R (consequently, one can construct spheres whose radius equals zero for free). Besides, once for each level a player can choose any point in space and release a laser ray from there, perpendicular to plane Qi (this action costs nothing). The ray can either be directed towards the plane or from the plane. The spheres that share at least one point with the ray will be immediately activated. The level is considered completed if the player has managed to activate all spheres. Note that the centers of the spheres are the same for all m levels but the spheres do not remain: the player should construct them anew on each new level.Help Vasya find out what minimum sum of money will be enough to complete each level." 2400.0
                                                119D "String Transformation" hashing,strings "Let s be a string whose length equals n. Its characters are numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891, i and j are integers, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89n. Let\'s define function f as follows:f(s,\xe2\x80\x89i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89s[i\xe2\x80\x89+\xe2\x80\x891... j\xe2\x80\x89-\xe2\x80\x891]\xe2\x80\x89+\xe2\x80\x89r(s[j... n\xe2\x80\x89-\xe2\x80\x891])\xe2\x80\x89+\xe2\x80\x89r(s[0... i]).Here s[p... q] is a substring of string s, that starts in position p and ends in position q (inclusive); ""+"" is the string concatenation operator; r(x) is a string resulting from writing the characters of the x string in the reverse order. If j\xe2\x80\x89=\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891, then the substring s[i\xe2\x80\x89+\xe2\x80\x891... j\xe2\x80\x89-\xe2\x80\x891] is considered empty.You are given two strings a and b. Find such values of i and j, that f(a,\xe2\x80\x89i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89b. Number i should be maximally possible. If for this i there exists several valid values of j, choose the minimal j." 2500.0
                                                117D "Not Quick Transformation" "divide and conquer,math" "Let a be an array consisting of n numbers. The array\'s elements are numbered from 1 to n, even is an array consisting of the numerals whose numbers are even in a (eveni\xe2\x80\x89=\xe2\x80\x89a2i, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), odd is an array consisting of the numberals whose numbers are odd in \xd0\xb0 (oddi\xe2\x80\x89=\xe2\x80\x89a2i\xe2\x80\x89-\xe2\x80\x891, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Then let\'s define the transformation of array F(a) in the following manner:  if n\xe2\x80\x89>\xe2\x80\x891, F(a)\xe2\x80\x89=\xe2\x80\x89F(odd)\xe2\x80\x89+\xe2\x80\x89F(even), where operation ""\xe2\x80\x89+\xe2\x80\x89"" stands for the arrays\' concatenation (joining together)  if n\xe2\x80\x89=\xe2\x80\x891, F(a)\xe2\x80\x89=\xe2\x80\x89a Let a be an array consisting of n numbers 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n. Then b is the result of applying the transformation to the array a (so b\xe2\x80\x89=\xe2\x80\x89F(a)). You are given m queries (l,\xe2\x80\x89r,\xe2\x80\x89u,\xe2\x80\x89v). Your task is to find for each query the sum of numbers bi, such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and u\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v. You should print the query results modulo mod." 2500.0
                                                110A "Nearly Lucky Number" implementation "Petya loves lucky numbers. We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Unfortunately, not all numbers are lucky. Petya calls a number nearly lucky if the number of lucky digits in it is a lucky number. He wonders whether number n is a nearly lucky number." 800.0
                                                109B "Lucky Probability" "brute force,probabilities" "Petya loves lucky numbers. We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya and his friend Vasya play an interesting game. Petya randomly chooses an integer p from the interval [pl,\xe2\x80\x89pr] and Vasya chooses an integer v from the interval [vl,\xe2\x80\x89vr] (also randomly). Both players choose their integers equiprobably. Find the probability that the interval [min(v,\xe2\x80\x89p),\xe2\x80\x89max(v,\xe2\x80\x89p)] contains exactly k lucky numbers." 1900.0
                                                105C "Item World" "brute force,implementation,sortings" "Each item in the game has a level. The higher the level is, the higher basic parameters the item has. We shall consider only the following basic parameters: attack (atk), defense (def) and resistance to different types of impact (res).Each item belongs to one class. In this problem we will only consider three of such classes: weapon, armor, orb.Besides, there\'s a whole new world hidden inside each item. We can increase an item\'s level travelling to its world. We can also capture the so-called residents in the Item WorldResidents are the creatures that live inside items. Each resident gives some bonus to the item in which it is currently located. We will only consider residents of types: gladiator (who improves the item\'s atk), sentry (who improves def) and physician (who improves res).Each item has the size parameter. The parameter limits the maximum number of residents that can live inside an item. We can move residents between items. Within one moment of time we can take some resident from an item and move it to some other item if it has a free place for a new resident. We cannot remove a resident from the items and leave outside \xe2\x80\x94 any of them should be inside of some item at any moment of time.Laharl has a certain number of items. He wants to move the residents between items so as to equip himself with weapon, armor and a defensive orb. The weapon\'s atk should be largest possible in the end. Among all equipping patterns containing weapon\'s maximum atk parameter we should choose the ones where the armor\xe2\x80\x99s def parameter is the largest possible. Among all such equipment patterns we should choose the one where the defensive orb would have the largest possible res parameter. Values of the parameters def and res of weapon, atk and res of armor and atk and def of orb are indifferent for Laharl.Find the optimal equipment pattern Laharl can get." 2200.0
                                                105A Transmigration implementation "In Disgaea as in most role-playing games, characters have skills that determine the character\'s ability to use certain weapons or spells. If the character does not have the necessary skill, he cannot use it. The skill level is represented as an integer that increases when you use this skill. Different character classes are characterized by different skills. Unfortunately, the skills that are uncommon for the given character\'s class are quite difficult to obtain. To avoid this limitation, there is the so-called transmigration. Transmigration is reincarnation of the character in a new creature. His soul shifts to a new body and retains part of his experience from the previous life. As a result of transmigration the new character gets all the skills of the old character and the skill levels are reduced according to the k coefficient (if the skill level was equal to x, then after transmigration it becomes equal to [kx], where [y] is the integral part of y). If some skill\'s levels are strictly less than 100, these skills are forgotten (the character does not have them any more). After that the new character also gains the skills that are specific for his class, but are new to him. The levels of those additional skills are set to 0. Thus, one can create a character with skills specific for completely different character classes via transmigrations. For example, creating a mage archer or a thief warrior is possible. You are suggested to solve the following problem: what skills will the character have after transmigration and what will the levels of those skills be?" 1700.0
                                                97A Domino "brute force,implementation" "Little Gennady was presented with a set of domino for his birthday. The set consists of 28 different dominoes of size 2\xe2\x80\x89\xc3\x97\xe2\x80\x891. Both halves of each domino contain one digit from 0 to 6. 0-0 0-1 0-2 0-3 0-4 0-5 0-61-1 1-2 1-3 1-4 1-5 1-62-2 2-3 2-4 2-5 2-63-3 3-4 3-5 3-64-4 4-5 4-65-5 5-66-6The figure that consists of 28 dominoes is called magic, if it can be fully covered with 14 non-intersecting squares of size 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 so that each square contained four equal numbers. Every time Gennady assembles a magic figure, some magic properties of the set appear \xe2\x80\x94 he wins the next contest. Gennady noticed that he can\'t assemble a figure that has already been assembled, otherwise someone else wins the contest.  Gennady chose a checked field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m and put there rectangular chips of sizes 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 and 2\xe2\x80\x89\xc3\x97\xe2\x80\x891. Each chip fully occupies exactly two neighboring squares of the field. Those chips do not overlap but they can touch each other. Overall the field has exactly 28 chips, equal to the number of dominoes in the set. Now Gennady wants to replace each chip with a domino so that a magic figure appeared as a result. Different chips should be replaced by different dominoes. Determine in what number of contests Gennady can win over at the given position of the chips. You are also required to find one of the possible ways of replacing chips with dominoes to win the next Codeforces round." 2400.0
                                                95B "Lucky Numbers" dp,greedy "Petya loves lucky numbers. Everybody knows that positive integers are lucky if their decimal representation doesn\'t contain digits other than 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Lucky number is super lucky if it\'s decimal representation contains equal amount of digits 4 and 7. For example, numbers 47, 7744, 474477 are super lucky and 4, 744, 467 are not.One day Petya came across a positive integer n. Help him to find the least super lucky number which is not less than n." 1800.0
                                                92B "Binary Number" greedy "Little walrus Fangy loves math very much. That\'s why when he is bored he plays with a number performing some operations.Fangy takes some positive integer x and wants to get a number one from it. While x is not equal to 1, Fangy repeats the following action: if x is odd, then he adds 1 to it, otherwise he divides x by 2. Fangy knows that for any positive integer number the process ends in finite time.How many actions should Fangy perform to get a number one from number x?" 1300.0
                                                91A "Newspaper Headline" greedy,strings "A newspaper is published in Walrusland. Its heading is s1, it consists of lowercase Latin letters. Fangy the little walrus wants to buy several such newspapers, cut out their headings, glue them one to another in order to get one big string. After that walrus erase several letters from this string in order to get a new word s2. It is considered that when Fangy erases some letter, there\'s no whitespace formed instead of the letter. That is, the string remains unbroken and it still only consists of lowercase Latin letters.For example, the heading is ""abc"". If we take two such headings and glue them one to the other one, we get ""abcabc"". If we erase the letters on positions 1 and 5, we get a word ""bcac"".Which least number of newspaper headings s1 will Fangy need to glue them, erase several letters and get word s2?" 1500.0
                                                89C "Chip Play" "brute force,data structures,implementation" "Let\'s consider the following game. We have a rectangular field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size. Some squares of the field contain chips.Each chip has an arrow painted on it. Thus, each chip on the field points in one of the following directions: up, down, left or right.The player may choose a chip and make a move with it.The move is the following sequence of actions. The chosen chip is marked as the current one. After that the player checks whether there are more chips in the same row (or in the same column) with the current one that are pointed by the arrow on the current chip. If there is at least one chip then the closest of them is marked as the new current chip and the former current chip is removed from the field. After that the check is repeated. This process can be repeated several times. If a new chip is not found, then the current chip is removed from the field and the player\'s move ends.By the end of a move the player receives several points equal to the number of the deleted chips.By the given initial chip arrangement determine the maximum number of points that a player can receive during one move. Also determine the number of such moves." 2300.0
                                                86E "Long sequence" "brute force,math,matrices" "A sequence a0,\xe2\x80\x89a1,\xe2\x80\x89... is called a recurrent binary sequence, if each term ai (i\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x89...) is equal to 0 or 1 and there exist coefficients  such that an\xe2\x80\x89=\xe2\x80\x89c1\xc2\xb7an\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89c2\xc2\xb7an\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ck\xc2\xb7an\xe2\x80\x89-\xe2\x80\x89k (mod 2),\xe2\x80\x89 for all n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89k. Assume that not all of ci are zeros.Note that such a sequence can be uniquely recovered from any k-tuple {as,\xe2\x80\x89as\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89as\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891} and so it is periodic. Moreover, if a k-tuple contains only zeros, then the sequence contains only zeros, so this case is not very interesting. Otherwise the minimal period of the sequence is not greater than 2k\xe2\x80\x89-\xe2\x80\x891, as k-tuple determines next element, and there are 2k\xe2\x80\x89-\xe2\x80\x891 non-zero k-tuples. Let us call a sequence long if its minimal period is exactly 2k\xe2\x80\x89-\xe2\x80\x891. Your task is to find a long sequence for a given k, if there is any." 2700.0
                                                86B "Tetris revisited" "constructive algorithms,graph matchings,greedy,math" "Physicist Woll likes to play one relaxing game in between his search of the theory of everything.Game interface consists of a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m playing field and a dashboard. Initially some cells of the playing field are filled while others are empty. Dashboard contains images of all various connected (we mean connectivity by side) figures of 2, 3, 4 and 5 cells, with all their rotations and reflections. Player can copy any figure from the dashboard and place it anywhere at the still empty cells of the playing field. Of course any figure can be used as many times as needed.Woll\'s aim is to fill the whole field in such a way that there are no empty cells left, and also... just have some fun.Every initially empty cell should be filled with exactly one cell of some figure. Every figure should be entirely inside the board.  In the picture black cells stand for initially filled cells of the field, and one-colour regions represent the figures." 2200.0
                                                85D "Sum of Medians" "binary search,brute force,data structures,implementation" "In one well-known algorithm of finding the k-th order statistics we should divide all elements into groups of five consecutive elements and find the median of each five. A median is called the middle element of a sorted array (it\'s the third largest element for a group of five). To increase the algorithm\'s performance speed on a modern video card, you should be able to find a sum of medians in each five of the array.A sum of medians of a sorted k-element set S\xe2\x80\x89=\xe2\x80\x89{a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak}, where a1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89<\xe2\x80\x89a3\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ak, will be understood by as The  operator stands for taking the remainder, that is  stands for the remainder of dividing x by y.To organize exercise testing quickly calculating the sum of medians for a changing set was needed." 2300.0
                                                85C "Petya and Tree" "binary search,dfs and similar,probabilities,sortings,trees" "One night, having had a hard day at work, Petya saw a nightmare. There was a binary search tree in the dream. But it was not the actual tree that scared Petya. The horrifying thing was that Petya couldn\'t search for elements in this tree. Petya tried many times to choose key and look for it in the tree, and each time he arrived at a wrong place. Petya has been racking his brains for long, choosing keys many times, but the result was no better. But the moment before Petya would start to despair, he had an epiphany: every time he was looking for keys, the tree didn\'t have the key, and occured exactly one mistake. ""That\'s not a problem!"", thought Petya. ""Why not count the expectation value of an element, which is found when I search for the key"". The moment he was about to do just that, however, Petya suddenly woke up.Thus, you are given a binary search tree, that is a tree containing some number written in the node. This number is called the node key. The number of children of every node of the tree is equal either to 0 or to 2. The nodes that have 0 children are called leaves and the nodes that have 2 children, are called inner. An inner node has the left child, that is the child whose key is less than the current node\'s key, and the right child, whose key is more than the current node\'s key. Also, a key of any node is strictly larger than all the keys of the left subtree of the node and strictly smaller than all the keys of the right subtree of the node.Also you are given a set of search keys, all of which are distinct and differ from the node keys contained in the tree. For each key from the set its search in the tree is realised. The search is arranged like this: initially we are located in the tree root, if the key of the current node is larger that our search key, then we move to the left child of the node, otherwise we go to the right child of the node and the process is repeated. As it is guaranteed that the search key is not contained in the tree, the search will always finish in some leaf. The key lying in the leaf is declared the search result.It is known for sure that during the search we make a mistake in comparing exactly once, that is we go the wrong way, but we won\'t make any mistakes later. All possible mistakes are equiprobable, that is we should consider all such searches where exactly one mistake occurs. Your task is to find the expectation (the average value) of the search result for every search key, considering that exactly one mistake occurs in the search. That is, for a set of paths containing exactly one mistake in the given key search, you should count the average value of keys containing in the leaves of those paths." 2200.0
                                                82B Sets "constructive algorithms,hashing,implementation" "Little Vasya likes very much to play with sets consisting of positive integers. To make the game more interesting, Vasya chose n non-empty sets in such a way, that no two of them have common elements.One day he wanted to show his friends just how interesting playing with numbers is. For that he wrote out all possible unions of two different sets on n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89/\xe2\x80\x892 pieces of paper. Then he shuffled the pieces of paper. He had written out the numbers in the unions in an arbitrary order.For example, if n\xe2\x80\x89=\xe2\x80\x894, and the actual sets have the following form {1,\xe2\x80\x893}, {5}, {2,\xe2\x80\x894}, {7}, then the number of set pairs equals to six. The six pieces of paper can contain the following numbers:   2,\xe2\x80\x897,\xe2\x80\x894.  1,\xe2\x80\x897,\xe2\x80\x893;  5,\xe2\x80\x894,\xe2\x80\x892;  1,\xe2\x80\x893,\xe2\x80\x895;  3,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x894;  5,\xe2\x80\x897. Then Vasya showed the pieces of paper to his friends, but kept the n sets secret from them. His friends managed to calculate which sets Vasya had thought of in the first place. And how about you, can you restore the sets by the given pieces of paper?" 1700.0
                                                79E "Security System" math "Fox Ciel safely returned to her castle, but there was something wrong with the security system of the castle: sensors attached in the castle were covering her.Ciel is at point (1,\xe2\x80\x891) of the castle now, and wants to move to point (n,\xe2\x80\x89n), which is the position of her room. By one step, Ciel can move from point (x,\xe2\x80\x89y) to either (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y) (rightward) or (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891) (upward).In her castle, c2 sensors are set at points (a\xe2\x80\x89+\xe2\x80\x89i,\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x89j) (for every integer i and j such that: 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89c,\xe2\x80\x890\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89c).Each sensor has a count value and decreases its count value every time Ciel moves. Initially, the count value of each sensor is t. Every time Ciel moves to point (x,\xe2\x80\x89y), the count value of a sensor at point (u,\xe2\x80\x89v) decreases by (|u\xe2\x80\x89-\xe2\x80\x89x|\xe2\x80\x89+\xe2\x80\x89|v\xe2\x80\x89-\xe2\x80\x89y|). When the count value of some sensor becomes strictly less than 0, the sensor will catch Ciel as a suspicious individual!Determine whether Ciel can move from (1,\xe2\x80\x891) to (n,\xe2\x80\x89n) without being caught by a sensor, and if it is possible, output her steps. Assume that Ciel can move to every point even if there is a censor on the point." 2900.0
                                                79B "Colorful Field" implementation,sortings "Fox Ciel saw a large field while she was on a bus. The field was a n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle divided into 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 cells. Some cells were wasteland, and other each cell contained crop plants: either carrots or kiwis or grapes. After seeing the field carefully, Ciel found that the crop plants of each cell were planted in following procedure:  Assume that the rows are numbered 1 to n from top to bottom and the columns are numbered 1 to m from left to right, and a cell in row i and column j is represented as (i,\xe2\x80\x89j).  First, each field is either cultivated or waste. Crop plants will be planted in the cultivated cells in the order of (1,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(1,\xe2\x80\x89m)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(2,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(2,\xe2\x80\x89m)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(n,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(n,\xe2\x80\x89m). Waste cells will be ignored.  Crop plants (either carrots or kiwis or grapes) will be planted in each cell one after another cyclically. Carrots will be planted in the first cell, then kiwis in the second one, grapes in the third one, carrots in the forth one, kiwis in the fifth one, and so on. The following figure will show you the example of this procedure. Here, a white square represents a cultivated cell, and a black square represents a waste cell.  Now she is wondering how to determine the crop plants in some certain cells." 1400.0
                                                77D "Domino Carpet" dp,implementation "...Mike the TV greets you again! Tired of the monotonous furniture? Sick of gray routine? Dreaming about dizzying changes in your humble abode? We have something to offer you! This domino carpet for only $99.99 will change your life! You can lay it on the floor, hang it on the wall or even on the ceiling! Among other things ... Having watched the commercial, virus Hexadecimal also wanted to get a Domino Carpet and wanted badly to be photographed in front of it. But of course, a virus will never consent to buying a licensed Carpet! So she ordered a truck of dominoes and decided to make such a Carpet herself. The original Domino Carpet is a field of squares n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size. Each square is half of a domino, and can be rotated either vertically or horizontally, independently from its neighbors. Vertically rotated domino halves look like this:    And horizontally rotated halves look like this:   Notice, that some halves looks the same in both rotations, but other halves differ.Dominoes bought by Hexadecimal are represented by uncuttable chips 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 in size, which can be laid either vertically or horizontally. If the chip is laid vertically, then both of it\'s halves should be laid vertically orientated; if the chip is laid horizontally, then both of it\'s halves should be laid horizontally.The samples of valid and invalid dominoes laid vertically and horizontally are:    Virus Hexadecimal assembles her own Domino Carpet so that the following conditions are satisfied:  each carpet square is covered by a domino chip, i.e. there are no empty squares;  all domino chips lie entirely within the carpet and don\'t overlap with each other;  if there is a horizontal domino chip with its left half in column j then there are no horizontal domino chips with their left halves in columns j\xe2\x80\x89-\xe2\x80\x891 or j\xe2\x80\x89+\xe2\x80\x891. Before starting to assemble her own Domino Carpet, the virus wants to know the number of ways to achieve the intended purpose modulo 109\xe2\x80\x89+\xe2\x80\x897.You can assume that the virus has an infinitely large number of dominoes of each type." 2300.0
                                                76E Points implementation,math "You are given N points on a plane. Write a program which will find the sum of squares of distances between all pairs of points." 1700.0
                                                75E "Ship\'s Shortest Path" "geometry,shortest paths" "You have got a new job, and it\'s very interesting, you are a ship captain. Your first task is to move your ship from one point to another point, and for sure you want to move it at the minimum cost.And it\'s well known that the shortest distance between any 2 points is the length of the line segment between these 2 points. But unfortunately there is an island in the sea, so sometimes you won\'t be able to move your ship in the line segment between the 2 points.You can only move to safe points. A point is called safe if it\'s on the line segment between the start and end points, or if it\'s on the island\'s edge.But you are too lucky, you have got some clever and strong workers and they can help you in your trip, they can help you move the ship in the sea and they will take 1 Egyptian pound for each moving unit in the sea, and they can carry the ship (yes, they are very strong) and walk on the island and they will take 2 Egyptian pounds for each moving unit in the island. The money which you will give to them will be divided between all workers, so the number of workers does not matter here.You can move your ship on the island edge, and it will be considered moving in the sea.Now you have a sea map, and you have to decide what is the minimum cost for your trip.Your starting point is (xStart, yStart), and the end point is (xEnd, yEnd), both points will be different.The island will be a convex polygon and there will be no more than 2 polygon points on the same line, also the starting and the end points won\'t be inside or on the boundary of the island. The points for the polygon will be given in the anti-clockwise order." 2400.0
                                                73D FreeDiv "dfs and similar,graphs,greedy" "Vasya plays FreeDiv. In this game he manages a huge state, which has n cities and m two-way roads between them. Unfortunately, not from every city you can reach any other one moving along these roads. Therefore Vasya decided to divide the state into provinces so that in every province, one could reach from every city all the cities of the province, but there are no roads between provinces. Unlike other turn-based strategies, in FreeDiv a player has the opportunity to build tunnels between cities. The tunnels are two-way roads along which one can move armies undetected by the enemy. However, no more than one tunnel can be connected to each city. As for Vasya, he wants to build a network of tunnels so that any pair of cities in his state were reachable by some path consisting of roads and a tunnels. But at that no more than k tunnels are connected to each province (otherwise, the province will be difficult to keep in case other provinces are captured by enemy armies).Vasya discovered that maybe he will not be able to build such a network for the current condition of the state. Maybe he\'ll have first to build several roads between cities in different provinces to merge the provinces. Your task is to determine the minimum number of roads Vasya needs to build so that it was possible to build the required network of tunnels in the resulting state." 2200.0
                                                73B "Need For Brake" "binary search,greedy,sortings" "Vasya plays the Need For Brake. He plays because he was presented with a new computer wheel for birthday! Now he is sure that he will win the first place in the championship in his favourite racing computer game! n racers take part in the championship, which consists of a number of races. After each race racers are arranged from place first to n-th (no two racers share the same place) and first m places are awarded. Racer gains bi points for i-th awarded place, which are added to total points, obtained by him for previous races. It is known that current summary score of racer i is ai points. In the final standings of championship all the racers will be sorted in descending order of points. Racers with an equal amount of points are sorted by increasing of the name in lexicographical order.Unfortunately, the championship has come to an end, and there is only one race left. Vasya decided to find out what the highest and lowest place he can take up as a result of the championship." 2000.0
                                                69B Bets greedy,implementation "In Chelyabinsk lives a much respected businessman Nikita with a strange nickname ""Boss"". Once Nikita decided to go with his friend Alex to the Summer Biathlon World Cup. Nikita, as a very important person, received a token which allows to place bets on each section no more than on one competitor.To begin with friends learned the rules: in the race there are n sections of equal length and m participants. The participants numbered from 1 to m. About each participant the following is known: li \xe2\x80\x94 the number of the starting section,  ri \xe2\x80\x94 the number of the finishing section (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri), ti \xe2\x80\x94 the time a biathlete needs to complete an section of the path, ci \xe2\x80\x94 the profit in roubles. If the i-th sportsman wins on one of the sections, the profit will be given to the man who had placed a bet on that sportsman. The i-th biathlete passes the sections from li to ri inclusive. The competitor runs the whole way in (ri\xe2\x80\x89-\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7ti time units. It takes him exactly ti time units to pass each section. In case of the athlete\'s victory on k sections the man who has betted on him receives k\xc2\xb7ci roubles.In each section the winner is determined independently as follows: if there is at least one biathlete running this in this section, then among all of them the winner is the one who has ran this section in minimum time (spent minimum time passing this section). In case of equality of times the athlete with the smaller index number wins. If there are no participants in this section, then the winner in this section in not determined. We have to say that in the summer biathlon all the participants are moving at a constant speed.We should also add that Nikita can bet on each section and on any contestant running in this section.Help the friends find the maximum possible profit." 1200.0
                                                68B "Energy exchange" "binary search" "It is well known that the planet suffers from the energy crisis. Little Petya doesn\'t like that and wants to save the world. For this purpose he needs every accumulator to contain the same amount of energy. Initially every accumulator has some amount of energy: the i-th accumulator has ai units of energy. Energy can be transferred from one accumulator to the other. Every time x units of energy are transferred (x is not necessarily an integer) k percent of it is lost. That is, if x units were transferred from one accumulator to the other, amount of energy in the first one decreased by x units and in other increased by  units.Your task is to help Petya find what maximum equal amount of energy can be stored in each accumulator after the transfers." 1600.0
                                                67A "Partial Teacher" dp,graphs,greedy,implementation "A teacher decides to give toffees to his students. He asks n students to stand in a queue. Since the teacher is very partial, he follows the following rule to distribute toffees.He looks at the first two students and gives more toffees to the student having higher marks than the other one. If they have the same marks they get the same number of toffees. The same procedure is followed for each pair of adjacent students starting from the first one to the last one.It is given that each student receives at least one toffee. You have to find the number of toffees given to each student by the teacher such that the total number of toffees is minimum." 1800.0
                                                66B "Petya and Countryside" "brute force,implementation" "Little Petya often travels to his grandmother in the countryside. The grandmother has a large garden, which can be represented as a rectangle 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n in size, when viewed from above. This rectangle is divided into n equal square sections. The garden is very unusual as each of the square sections possesses its own fixed height and due to the newest irrigation system we can create artificial rain above each section.Creating artificial rain is an expensive operation. That\'s why we limit ourselves to creating the artificial rain only above one section. At that, the water from each watered section will flow into its neighbouring sections if their height does not exceed the height of the section. That is, for example, the garden can be represented by a 1\xe2\x80\x89\xc3\x97\xe2\x80\x895 rectangle, where the section heights are equal to 4, 2, 3, 3, 2. Then if we create an artificial rain over any of the sections with the height of 3, the water will flow over all the sections, except the ones with the height of 4. See the illustration of this example at the picture:  As Petya is keen on programming, he decided to find such a section that if we create artificial rain above it, the number of watered sections will be maximal. Help him." 1100.0
                                                65A "Harry Potter and Three Spells" implementation,math "A long time ago (probably even in the first book), Nicholas Flamel, a great alchemist and the creator of the Philosopher\'s Stone, taught Harry Potter three useful spells. The first one allows you to convert a grams of sand into b grams of lead, the second one allows you to convert c grams of lead into d grams of gold and third one allows you to convert e grams of gold into f grams of sand. When Harry told his friends about these spells, Ron Weasley was amazed. After all, if they succeed in turning sand into lead, lead into gold, and then turning part of the gold into sand again and so on, then it will be possible to start with a small amount of sand and get huge amounts of gold! Even an infinite amount of gold! Hermione Granger, by contrast, was skeptical about that idea. She argues that according to the law of conservation of matter getting an infinite amount of matter, even using magic, is impossible. On the contrary, the amount of matter may even decrease during transformation, being converted to magical energy. Though Hermione\'s theory seems convincing, Ron won\'t believe her. As far as Ron is concerned, Hermione made up her law of conservation of matter to stop Harry and Ron wasting their time with this nonsense, and to make them go and do homework instead. That\'s why Ron has already collected a certain amount of sand for the experiments. A quarrel between the friends seems unavoidable...Help Harry to determine which one of his friends is right, and avoid the quarrel after all. To do this you have to figure out whether it is possible to get the amount of gold greater than any preassigned number from some finite amount of sand." 1800.0
                                                64H "Table Bowling" "*special problem,sortings" "Table bowling tournament participant completed the competition according to the given final standings table. The table is given as a sequence of lines, each line has a format ""name score"". Your task is to prepare another table consisting of lines in the form ""place name"". Sort participant by score (desc.) and by the name lexicographically in the case of a tie. Places are numerated from 1. If more than one participant has some score, all of them share the places and you should output something like ""12-14 john"".Please, look into the samples for clarification." 2300.0
                                                62E "World Evil" dp,flows "As a result of Pinky and Brain\'s mysterious experiments in the Large Hadron Collider some portals or black holes opened to the parallel dimension. And the World Evil has crept to the veil between their world and ours. Brain quickly evaluated the situation and he understood that the more evil tentacles creep out and become free, the higher is the possibility that Brain will rule the world.The collider\'s constriction is a rectangular grid rolled into a cylinder and consisting of n rows and m columns such as is shown in the picture below:  In this example n\xe2\x80\x89=\xe2\x80\x894, m\xe2\x80\x89=\xe2\x80\x895. Dotted lines are corridores that close each column to a ring, i. e. connect the n-th and the 1-th rows of the grid.In the leftmost column of the grid the portals are situated and the tentacles of the World Evil are ready to creep out from there. In the rightmost column the exit doors are located. The tentacles can only get out through those doors. The segments joining the nodes of the grid are corridors.Brain would be glad to let all the tentacles out but he faces a problem: the infinite number of tentacles can creep out of the portals, every tentacle possesses infinite length and some width and the volume of the corridors are, unfortunately, quite limited. Brain could approximately evaluate the maximal number of tentacles that will be able to crawl through every corridor.Now help the mice to determine the maximal number of tentacles of the World Evil that will crawl out of the Large Hadron Collider." 2700.0
                                                62D Wormhouse "dfs and similar,graphs" "Arnie the Worm has finished eating an apple house yet again and decided to move. He made up his mind on the plan, the way the rooms are located and how they are joined by corridors. He numbered all the rooms from 1 to n. All the corridors are bidirectional.Arnie wants the new house to look just like the previous one. That is, it should have exactly n rooms and, if a corridor from room i to room j existed in the old house, it should be built in the new one. We know that during the house constructing process Arnie starts to eat an apple starting from some room and only stops when he eats his way through all the corridors and returns to the starting room. It is also known that Arnie eats without stopping. That is, until Arnie finishes constructing the house, he is busy every moment of his time gnawing a new corridor. Arnie doesn\'t move along the already built corridors.However, gnawing out corridors in one and the same order any time you change a house is a very difficult activity. That\'s why Arnie, knowing the order in which the corridors were located in the previous house, wants to gnaw corridors in another order. It is represented as a list of rooms in the order in which they should be visited. The new list should be lexicographically smallest, but it also should be strictly lexicographically greater than the previous one. Help the worm." 2300.0
                                                57E Chess "math,shortest paths" "Brian the Rabbit adores chess. Not long ago he argued with Stewie the Rabbit that a knight is better than a king. To prove his point he tries to show that the knight is very fast but Stewie doesn\'t accept statements without evidence. He constructed an infinite chessboard for Brian, where he deleted several squares to add some more interest to the game. Brian only needs to count how many different board squares a knight standing on a square with coordinates of (0,\xe2\x80\x890) can reach in no more than k moves. Naturally, it is forbidden to move to the deleted squares.Brian doesn\'t very much like exact sciences himself and is not acquainted with programming, that\'s why he will hardly be able to get ahead of Stewie who has already started solving the problem. Help Brian to solve the problem faster than Stewie." 3000.0
                                                54E "Vacuum \xd0\xa1leaner" geometry "One winter evening the Hedgehog was relaxing at home in his cozy armchair and clicking through the TV channels. Stumbled on an issue of \xc2\xabTopShop\xc2\xbb, the Hedgehog was about to change the channel when all of a sudden he was stopped by an advertisement of a new wondrous invention.Actually, a vacuum cleaner was advertised there. It was called Marvellous Vacuum and it doesn\'t even need a human to operate it while it cleans! The vacuum cleaner can move around the flat on its own: it moves in some direction and if it hits an obstacle there, it automatically chooses a new direction. Sooner or later this vacuum cleaner will travel through all the room and clean it all. Having remembered how much time the Hedgehog spends every time on cleaning (surely, no less than a half of the day), he got eager to buy this wonder.However, the Hedgehog quickly understood that the cleaner has at least one weak point: it won\'t clean well in the room\'s corners because it often won\'t able to reach the corner due to its shape. To estimate how serious is this drawback in practice, the Hedgehog asked you to write for him the corresponding program.You will be given the cleaner\'s shape in the top view. We will consider only the cases when the vacuum cleaner is represented as a convex polygon. The room is some infinitely large rectangle. We consider one corner of this room and want to find such a rotation of the vacuum cleaner so that it, being pushed into this corner, will leave the minimum possible area in the corner uncovered." 2700.0
                                                54D "Writing a Song" "brute force,dp,strings" "One of the Hedgehog and his friend\'s favorite entertainments is to take some sentence or a song and replace half of the words (sometimes even all of them) with each other\'s names.The friend\'s birthday is approaching and the Hedgehog decided to make a special present to his friend: a very long song, where his name will be repeated many times. But try as he might, he can\'t write a decent song!The problem is that the Hedgehog has already decided how long the resulting sentence should be (i.e. how many letters it should contain) and in which positions in the sentence the friend\'s name should occur, and it must not occur in any other position in the sentence. Besides, the Hedgehog decided to limit himself to using only the first K letters of an English alphabet in this sentence (so it will be not even a sentence, but one long word).The resulting problem is indeed quite complicated, that\'s why the Hedgehog asks you to help him and write a program that will make the desired word by the given name P, the length N of the required word, the given positions of the occurrences of the name P in the desired word and the alphabet\'s size K. Note that the occurrences of the name can overlap with each other." 2100.0
                                                54B "Cutting Jigsaw Puzzle" hashing,implementation "The Hedgehog recently remembered one of his favorite childhood activities, \xe2\x80\x94 solving puzzles, and got into it with new vigor. He would sit day in, day out with his friend buried into thousands of tiny pieces of the picture, looking for the required items one by one.Soon the Hedgehog came up with a brilliant idea: instead of buying ready-made puzzles, one can take his own large piece of paper with some picture and cut it into many small rectangular pieces, then mix them and solve the resulting puzzle, trying to piece together the picture. The resulting task is even more challenging than the classic puzzle: now all the fragments have the same rectangular shape, and one can assemble the puzzle only relying on the picture drawn on the pieces.All puzzle pieces turn out to be of the same size X\xe2\x80\x89\xc3\x97\xe2\x80\x89Y, because the picture is cut first by horizontal cuts with the pitch of X, then with vertical cuts with the pitch of Y. If we denote the initial size of the picture as A\xe2\x80\x89\xc3\x97\xe2\x80\x89B, then A must be divisible by X and B must be divisible by Y (X and Y are integer numbers). However, not every such cutting of the picture will result in a good puzzle. The Hedgehog finds a puzzle good if no two pieces in it are the same (It is allowed to rotate the pieces when comparing them, but it is forbidden to turn them over). Your task is to count for a given picture the number of good puzzles that you can make from it, and also to find the puzzle with the minimal piece size." 1800.0
                                                52C "Circular RMQ" "data structures" "You are given circular array a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. There are two types of operations with it:   inc(lf,\xe2\x80\x89rg,\xe2\x80\x89v) \xe2\x80\x94 this operation increases each element on the segment [lf,\xe2\x80\x89rg] (inclusively) by v;  rmq(lf,\xe2\x80\x89rg) \xe2\x80\x94 this operation returns minimal value on the segment [lf,\xe2\x80\x89rg] (inclusively). Assume segments to be circular, so if n\xe2\x80\x89=\xe2\x80\x895 and lf\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x89rg\xe2\x80\x89=\xe2\x80\x891, it means the index sequence: 3,\xe2\x80\x894,\xe2\x80\x890,\xe2\x80\x891.Write program to process given sequence of operations." 2200.0
                                                51F Caterpillar "dfs and similar,dp,graphs,trees" "An undirected graph is called a caterpillar if it is a connected graph without cycles and it has such a path p that any vertex is located at a distance of at most 1 from the path p. The caterpillar can contain loops (edges from a vertex to itself) but cannot contain multiple (parallel) edges.The picture contains an example of a caterpillar:   You are given an undirected graph G. You are allowed to do a merging operations, each such operation merges two vertices into one vertex. For that two any vertices a and b (a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b) are chosen. These verteces are deleted together with their edges (which are incident to at least one of the vertices a or b) but a new vertex w is added together with edges (x,\xe2\x80\x89w) for each edge (a,\xe2\x80\x89w) and/or (b,\xe2\x80\x89w). If there was the edge (a,\xe2\x80\x89b) it transforms to the loop (w,\xe2\x80\x89w). The resulting graph (after the merging operation) may contain multiple (parallel) edges between pairs of vertices and loops. Let us note that this operation decreases the number of vertices of graph by 1 but leaves the number of edges in the graph unchanged.The merging operation can be informally described as a unity of two vertices of the graph into one with the natural transformation of the graph edges.You may apply this operation consecutively and make the given graph to be a caterpillar. Write a program that will print the minimal number of merging operations required to make the given graph a caterpillar." 2800.0
                                                50B "Choosing Symbol Pairs" strings "There is a given string S consisting of N symbols. Your task is to find the number of ordered pairs of integers i and j such that1. 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N2. S[i]\xe2\x80\x89=\xe2\x80\x89S[j], that is the i-th symbol of string S is equal to the j-th." 1500.0
                                                50A "Domino piling" greedy,math "You are given a rectangular board of M\xe2\x80\x89\xc3\x97\xe2\x80\x89N squares. Also you are given an unlimited number of standard domino pieces of 2\xe2\x80\x89\xc3\x97\xe2\x80\x891 squares. You are allowed to rotate the pieces. You are asked to place as many dominoes as possible on the board so as to meet the following conditions:1. Each domino completely covers two squares.2. No two dominoes overlap.3. Each domino lies entirely inside the board. It is allowed to touch the edges of the board.Find the maximum number of dominoes, which can be placed under these restrictions." 800.0
                                                49D Game "brute force,dp,implementation" "Vasya and Petya have invented a new game. Vasya takes a stripe consisting of 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n square and paints the squares black and white. After that Petya can start moves \xe2\x80\x94 during a move he may choose any two neighboring squares of one color and repaint these two squares any way he wants, perhaps in different colors. Petya can only repaint the squares in white and black colors. Petya\xe2\x80\x99s aim is to repaint the stripe so that no two neighboring squares were of one color. Help Petya, using the given initial coloring, find the minimum number of moves Petya needs to win." 1800.0
                                                49C Disposition "constructive algorithms,math" "Vasya bought the collected works of a well-known Berland poet Petya in n volumes. The volumes are numbered from 1 to n. He thinks that it does not do to arrange the book simply according to their order. Vasya wants to minimize the number of the disposition\xe2\x80\x99s divisors \xe2\x80\x94 the positive integers i such that for at least one j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is true both: j mod i\xe2\x80\x89=\xe2\x80\x890 and at the same time p(j) mod i\xe2\x80\x89=\xe2\x80\x890, where p(j) is the number of the tome that stands on the j-th place and mod is the operation of taking the division remainder. Naturally, one volume can occupy exactly one place and in one place can stand exactly one volume.Help Vasya \xe2\x80\x94 find the volume disposition with the minimum number of divisors." 1700.0
                                                47E Cannon "data structures,geometry,sortings" "Bertown is under siege! The attackers have blocked all the ways out and their cannon is bombarding the city. Fortunately, Berland intelligence managed to intercept the enemies\' shooting plan. Let\'s introduce the Cartesian system of coordinates, the origin of which coincides with the cannon\'s position, the Ox axis is directed rightwards in the city\'s direction, the Oy axis is directed upwards (to the sky). The cannon will make n more shots. The cannon balls\' initial speeds are the same in all the shots and are equal to V, so that every shot is characterized by only one number alphai which represents the angle at which the cannon fires. Due to the cannon\'s technical peculiarities this angle does not exceed 45 angles (\xcf\x80\xe2\x80\x89/\xe2\x80\x894). We disregard the cannon sizes and consider the firing made from the point (0,\xe2\x80\x890).The balls fly according to the known physical laws of a body thrown towards the horizon at an angle: vx(t)\xe2\x80\x89=\xe2\x80\x89V\xc2\xb7cos(alpha) vy(t)\xe2\x80\x89=\xe2\x80\x89V\xc2\xb7sin(alpha) \xe2\x80\x89\xe2\x80\x93\xe2\x80\x89 g\xc2\xb7t x(t)\xe2\x80\x89=\xe2\x80\x89V\xc2\xb7cos(alpha)\xc2\xb7t y(t)\xe2\x80\x89=\xe2\x80\x89V\xc2\xb7sin(alpha)\xc2\xb7t \xe2\x80\x89\xe2\x80\x93\xe2\x80\x89 g\xc2\xb7t2\xe2\x80\x89/\xe2\x80\x892Think of the acceleration of gravity g as equal to 9.8.Bertown defends m walls. The i-th wall is represented as a vertical segment (xi,\xe2\x80\x890)\xe2\x80\x89-\xe2\x80\x89(xi,\xe2\x80\x89yi). When a ball hits a wall, it gets stuck in it and doesn\'t fly on. If a ball doesn\'t hit any wall it falls on the ground (y\xe2\x80\x89=\xe2\x80\x890) and stops. If the ball exactly hits the point (xi,\xe2\x80\x89yi), it is considered stuck. Your task is to find for each ball the coordinates of the point where it will be located in the end." 2200.0
                                                47A "Triangular numbers" "brute force,math" "A triangular number is the number of dots in an equilateral triangle uniformly filled with dots. For example, three dots can be arranged in a triangle; thus three is a triangular number. The n-th triangular number is the number of dots in a triangle with n dots on a side. . You can learn more about these numbers from Wikipedia (http://en.wikipedia.org/wiki/Triangular_number).Your task is to find out if a given integer is a triangular number." 800.0
                                                45J "Planting Trees" "constructive algorithms" "Vasya is a Greencode wildlife preservation society proponent. One day he found an empty field nobody owned, divided it into n\xe2\x80\x89\xc3\x97\xe2\x80\x89m squares and decided to plant a forest there. Vasya will plant nm trees of all different heights from 1 to nm. For his forest to look more natural he wants any two trees growing in the side neighbouring squares to have the absolute value of difference in heights to be strictly more than 1. Help Vasya: make the plan of the forest planting for which this condition is fulfilled." 1800.0
                                                45D "Event Dates" greedy,meet-in-the-middle,sortings "On a history lesson the teacher asked Vasya to name the dates when n famous events took place. He doesn\'t remembers the exact dates but he remembers a segment of days [li,\xe2\x80\x89ri] (inclusive) on which the event could have taken place. However Vasya also remembers that there was at most one event in one day. Help him choose such n dates of famous events that will fulfill both conditions. It is guaranteed that it is possible." 1900.0
                                                44J Triminoes "constructive algorithms,greedy" "There are many interesting tasks on domino tilings. For example, an interesting fact is known. Let us take a standard chessboard (8\xe2\x80\x89\xc3\x97\xe2\x80\x898) and cut exactly two squares out of it. It turns out that the resulting board can always be tiled using dominoes 1\xe2\x80\x89\xc3\x97\xe2\x80\x892, if the two cut out squares are of the same color, otherwise it is impossible. Petya grew bored with dominoes, that\'s why he took a chessboard (not necessarily 8\xe2\x80\x89\xc3\x97\xe2\x80\x898), cut some squares out of it and tries to tile it using triminoes. Triminoes are reactangles 1\xe2\x80\x89\xc3\x97\xe2\x80\x893 (or 3\xe2\x80\x89\xc3\x97\xe2\x80\x891, because triminoes can be rotated freely), also the two extreme squares of a trimino are necessarily white and the square in the middle is black. The triminoes are allowed to put on the chessboard so that their squares matched the colors of the uncut squares of the chessboard, and also the colors must match: the black squares must be matched with the black ones only and the white ones \xe2\x80\x94 with the white squares. The triminoes must not protrude above the chessboard or overlap each other. All the uncut squares of the board must be covered with triminoes. Help Petya find out if it is possible to tile his board using triminos in the described way and print one of the variants of tiling." 2000.0
                                                41A Translation implementation,strings "The translation from the Berland language into the Birland language is not an easy task. Those languages are very similar: a Berlandish word differs from a Birlandish word with the same meaning a little: it is spelled (and pronounced) reversely. For example, a Berlandish word code corresponds to a Birlandish word edoc. However, making a mistake during the ""translation"" is easy. Vasya translated the word s from Berlandish into Birlandish as t. Help him: find out if he translated the word correctly." 800.0
                                                39J "Spelling Check" hashing,implementation,strings "Petya has noticed that when he types using a keyboard, he often presses extra buttons and adds extra letters to the words. Of course, the spell-checking system underlines the words for him and he has to click every word and choose the right variant. Petya got fed up with correcting his mistakes himself, that\xe2\x80\x99s why he decided to invent the function that will correct the words itself. Petya started from analyzing the case that happens to him most of the time, when all one needs is to delete one letter for the word to match a word from the dictionary. Thus, Petya faces one mini-task: he has a printed word and a word from the dictionary, and he should delete one letter from the first word to get the second one. And now the very non-trivial question that Petya faces is: which letter should he delete?" 1500.0
                                                39C "Moon Craters" dp,sortings "There are lots of theories concerning the origin of moon craters. Most scientists stick to the meteorite theory, which says that the craters were formed as a result of celestial bodies colliding with the Moon. The other version is that the craters were parts of volcanoes.An extraterrestrial intelligence research specialist professor Okulov (the namesake of the Okulov, the author of famous textbooks on programming) put forward an alternate hypothesis. Guess what kind of a hypothesis it was \xe2\x80\x93\xe2\x80\x93 sure, the one including extraterrestrial mind involvement. Now the professor is looking for proofs of his hypothesis.Professor has data from the moon robot that moves linearly in one direction along the Moon surface. The moon craters are circular in form with integer-valued radii. The moon robot records only the craters whose centers lay on his path and sends to the Earth the information on the distance from the centers of the craters to the initial point of its path and on the radii of the craters.According to the theory of professor Okulov two craters made by an extraterrestrial intelligence for the aims yet unknown either are fully enclosed one in the other or do not intersect at all. Internal or external tangency is acceptable. However the experimental data from the moon robot do not confirm this theory! Nevertheless, professor Okulov is hopeful. He perfectly understands that to create any logical theory one has to ignore some data that are wrong due to faulty measuring (or skillful disguise by the extraterrestrial intelligence that will be sooner or later found by professor Okulov!) That\xe2\x80\x99s why Okulov wants to choose among the available crater descriptions the largest set that would satisfy his theory." 2100.0
                                                38F "Smart Boy" dp,games,strings "Once Petya and Vasya invented a new game and called it ""Smart Boy"". They located a certain set of words \xe2\x80\x94 the dictionary \xe2\x80\x94 for the game. It is admissible for the dictionary to contain similar words. The rules of the game are as follows: first the first player chooses any letter (a word as long as 1) from any word from the dictionary and writes it down on a piece of paper. The second player adds some other letter to this one\'s initial or final position, thus making a word as long as 2, then it\'s the first player\'s turn again, he adds a letter in the beginning or in the end thus making a word as long as 3 and so on. But the player mustn\'t break one condition: the newly created word must be a substring of a word from a dictionary. The player who can\'t add a letter to the current word without breaking the condition loses.Also if by the end of a turn a certain string s is written on paper, then the player, whose turn it just has been, gets a number of points according to the formula:where    is a sequence number of symbol c in Latin alphabet, numbered starting from 1. For example, , and .   is the number of words from the dictionary where the line s occurs as a substring at least once. Your task is to learn who will win the game and what the final score will be. Every player plays optimally and most of all tries to win, then \xe2\x80\x94 to maximize the number of his points, then \xe2\x80\x94 to minimize the number of the points of the opponent." 2100.0
                                                37E "Trial for Chief" "graphs,greedy,shortest paths" "Having unraveled the Berland Dictionary, the scientists managed to read the notes of the chroniclers of that time. For example, they learned how the chief of the ancient Berland tribe was chosen.As soon as enough pretenders was picked, the following test took place among them: the chief of the tribe took a slab divided by horizontal and vertical stripes into identical squares (the slab consisted of N lines and M columns) and painted every square black or white. Then every pretender was given a slab of the same size but painted entirely white. Within a day a pretender could paint any side-linked set of the squares of the slab some color. The set is called linked if for any two squares belonging to the set there is a path belonging the set on which any two neighboring squares share a side. The aim of each pretender is to paint his slab in the exactly the same way as the chief\xe2\x80\x99s slab is painted. The one who paints a slab like that first becomes the new chief.Scientists found the slab painted by the ancient Berland tribe chief. Help them to determine the minimal amount of days needed to find a new chief if he had to paint his slab in the given way." 2600.0
                                                37C "Old Berland Language" "data structures,greedy,trees" "Berland scientists know that the Old Berland language had exactly n words. Those words had lengths of l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89ln letters. Every word consisted of two letters, 0 and 1. Ancient Berland people spoke quickly and didn\xe2\x80\x99t make pauses between the words, but at the same time they could always understand each other perfectly. It was possible because no word was a prefix of another one. The prefix of a string is considered to be one of its substrings that starts from the initial symbol.Help the scientists determine whether all the words of the Old Berland language can be reconstructed and if they can, output the words themselves." 1900.0
                                                35E Parade "data structures,sortings" "No Great Victory anniversary in Berland has ever passed without the war parade. This year is not an exception. That\xe2\x80\x99s why the preparations are on in full strength. Tanks are building a line, artillery mounts are ready to fire, soldiers are marching on the main square... And the air forces general Mr. Generalov is in trouble again. This year a lot of sky-scrapers have been built which makes it difficult for the airplanes to fly above the city. It was decided that the planes should fly strictly from south to north. Moreover, there must be no sky scraper on a plane\xe2\x80\x99s route, otherwise the anniversary will become a tragedy. The Ministry of Building gave the data on n sky scrapers (the rest of the buildings are rather small and will not be a problem to the planes). When looking at the city from south to north as a geometrical plane, the i-th building is a rectangle of height hi. Its westernmost point has the x-coordinate of li and the easternmost \xe2\x80\x94 of ri. The terrain of the area is plain so that all the buildings stand on one level. Your task as the Ministry of Defence\xe2\x80\x99s head programmer is to find an enveloping polyline using the data on the sky-scrapers. The polyline\xe2\x80\x99s properties are as follows:  If you look at the city from south to north as a plane, then any part of any building will be inside or on the boarder of the area that the polyline encloses together with the land surface.  The polyline starts and ends on the land level, i.e. at the height equal to 0.  The segments of the polyline are parallel to the coordinate axes, i.e. they can only be vertical or horizontal.  The polyline\xe2\x80\x99s vertices should have integer coordinates.  If you look at the city from south to north the polyline (together with the land surface) must enclose the minimum possible area.  The polyline must have the smallest length among all the polylines, enclosing the minimum possible area with the land.  The consecutive segments of the polyline must be perpendicular.    Picture to the second sample test (the enveloping polyline is marked on the right)." 2100.0
                                                34E Collisions "brute force,implementation,math" "On a number line there are n balls. At time moment 0 for each ball the following data is known: its coordinate xi, speed vi (possibly, negative) and weight mi. The radius of the balls can be ignored.The balls collide elastically, i.e. if two balls weighing m1 and m2 and with speeds v1 and v2 collide, their new speeds will be: .Your task is to find out, where each ball will be t seconds after." 2000.0
                                                33E Helper  "It\'s unbelievable, but an exam period has started at the OhWord University. It\'s even more unbelievable, that Valera got all the tests before the exam period for excellent work during the term. As now he\'s free, he wants to earn money by solving problems for his groupmates. He\'s made a list of subjects that he can help with. Having spoken with n of his groupmates, Valera found out the following information about them: what subject each of them passes, time of the exam and sum of money that each person is ready to pay for Valera\'s help.Having this data, Valera\'s decided to draw up a timetable, according to which he will solve problems for his groupmates. For sure, Valera can\'t solve problems round the clock, that\'s why he\'s found for himself an optimum order of day and plans to stick to it during the whole exam period. Valera assigned time segments for sleep, breakfast, lunch and dinner. The rest of the time he can work.Obviously, Valera can help a student with some subject, only if this subject is on the list. It happened, that all the students, to whom Valera spoke, have different, but one-type problems, that\'s why Valera can solve any problem of subject listi in ti minutes.Moreover, if Valera starts working at some problem, he can break off only for sleep or meals, but he can\'t start a new problem, not having finished the current one. Having solved the problem, Valera can send it instantly to the corresponding student via the Internet.If this student\'s exam hasn\'t started yet, he can make a crib, use it to pass the exam successfully, and pay Valera the promised sum. Since Valera has little time, he asks you to write a program that finds the order of solving problems, which can bring Valera maximum profit." 2600.0
                                                33B "String Problem" "shortest paths" "Boy Valera likes strings. And even more he likes them, when they are identical. That\'s why in his spare time Valera plays the following game. He takes any two strings, consisting of lower case Latin letters, and tries to make them identical. According to the game rules, with each move Valera can change one arbitrary character Ai in one of the strings into arbitrary character Bi, but he has to pay for every move a particular sum of money, equal to Wi. He is allowed to make as many moves as he needs. Since Valera is a very economical boy and never wastes his money, he asked you, an experienced programmer, to help him answer the question: what minimum amount of money should Valera have to get identical strings." 1800.0
                                                32D Constellation implementation "A star map in Berland is a checked field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m squares. In each square there is or there is not a star. The favourite constellation of all Berland\'s astronomers is the constellation of the Cross. This constellation can be formed by any 5 stars so, that for some integer x (radius of the constellation) the following is true:   the 2nd is on the same vertical line as the 1st, but x squares up  the 3rd is on the same vertical line as the 1st, but x squares down  the 4th is on the same horizontal line as the 1st, but x squares left  the 5th is on the same horizontal line as the 1st, but x squares right Such constellations can be very numerous, that\'s why they are numbered with integers from 1 on the following principle: when two constellations are compared, the one with a smaller radius gets a smaller index; if their radii are equal \xe2\x80\x94 the one, whose central star if higher than the central star of the other one; if their central stars are at the same level \xe2\x80\x94 the one, whose central star is to the left of the central star of the other one.Your task is to find the constellation with index k by the given Berland\'s star map." 1600.0
                                                30C "Shooting Gallery" dp,probabilities "One warm and sunny day king Copa decided to visit the shooting gallery, located at the Central Park, and try to win the main prize \xe2\x80\x94 big pink plush panda. The king is not good at shooting, so he invited you to help him.The shooting gallery is an infinite vertical plane with Cartesian coordinate system on it. The targets are points on this plane. Each target is described by it\'s coordinates xi, and yi, by the time of it\'s appearance ti and by the number pi, which gives the probability that Copa hits this target if he aims at it.A target appears and disappears instantly, so Copa can hit the target only if at the moment ti his gun sight aimed at (xi,\xe2\x80\x89yi). Speed of movement of the gun sight on the plane is equal to 1. Copa knows all the information about the targets beforehand (remember, he is a king!). He wants to play in the optimal way, which maximizes the expected value of the amount of hit targets. He can aim at any target at the moment 0." 1800.0
                                                30A Accounting "brute force,math" "A long time ago in some far country lived king Copa. After the recent king\'s reform, he got so large powers that started to keep the books by himself.The total income A of his kingdom during 0-th year is known, as well as the total income B during n-th year (these numbers can be negative \xe2\x80\x94 it means that there was a loss in the correspondent year). King wants to show financial stability. To do this, he needs to find common coefficient X \xe2\x80\x94 the coefficient of income growth during one year. This coefficient should satisfy the equation:A\xc2\xb7Xn\xe2\x80\x89=\xe2\x80\x89B.Surely, the king is not going to do this job by himself, and demands you to find such number X.It is necessary to point out that the fractional numbers are not used in kingdom\'s economy. That\'s why all input numbers as well as coefficient X must be integers. The number X may be zero or negative." 1400.0
                                                26B "Regular Bracket Sequence" greedy "A bracket sequence is called regular if it is possible to obtain correct arithmetic expression by inserting characters \xc2\xab+\xc2\xbb and \xc2\xab1\xc2\xbb into this sequence. For example, sequences \xc2\xab(())()\xc2\xbb, \xc2\xab()\xc2\xbb and \xc2\xab(()(()))\xc2\xbb are regular, while \xc2\xab)(\xc2\xbb, \xc2\xab(()\xc2\xbb and \xc2\xab(()))(\xc2\xbb are not.One day Johnny got bracket sequence. He decided to remove some of the brackets from it in order to obtain a regular bracket sequence. What is the maximum length of a regular bracket sequence which can be obtained?" 1400.0
                                                25C "Roads in Berland" "graphs,shortest paths" "There are n cities numbered from 1 to n in Berland. Some of them are connected by two-way roads. Each road has its own length \xe2\x80\x94 an integer number from 1 to 1000. It is known that from each city it is possible to get to any other city by existing roads. Also for each pair of cities it is known the shortest distance between them. Berland Government plans to build k new roads. For each of the planned road it is known its length, and what cities it will connect. To control the correctness of the construction of new roads, after the opening of another road Berland government wants to check the sum of the shortest distances between all pairs of cities. Help them \xe2\x80\x94 for a given matrix of shortest distances on the old roads and plans of all new roads, find out how the sum of the shortest distances between all pairs of cities changes after construction of each road." 1900.0
                                                24D "Broken robot" dp,math,probabilities "You received as a gift a very clever robot walking on a rectangular board. Unfortunately, you understood that it is broken and behaves rather strangely (randomly). The board consists of N rows and M columns of cells. The robot is initially at some cell on the i-th row and the j-th column. Then at every step the robot could go to some another cell. The aim is to go to the bottommost (N-th) row. The robot can stay at it\'s current cell, move to the left, move to the right, or move to the cell below the current. If the robot is in the leftmost column it cannot move to the left, and if it is in the rightmost column it cannot move to the right. At every step all possible moves are equally probable. Return the expected number of step to reach the bottommost row." 2400.0
                                                22E Scheme "dfs and similar,graphs,trees" "To learn as soon as possible the latest news about their favourite fundamentally new operating system, BolgenOS community from Nizhni Tagil decided to develop a scheme. According to this scheme a community member, who is the first to learn the news, calls some other member, the latter, in his turn, calls some third member, and so on; i.e. a person with index i got a person with index fi, to whom he has to call, if he learns the news. With time BolgenOS community members understood that their scheme doesn\'t work sometimes \xe2\x80\x94 there were cases when some members didn\'t learn the news at all. Now they want to supplement the scheme: they add into the scheme some instructions of type (xi,\xe2\x80\x89yi), which mean that person xi has to call person yi as well. What is the minimum amount of instructions that they need to add so, that at the end everyone learns the news, no matter who is the first to learn it?" 2300.0
                                                18A Triangle "brute force,geometry" "At a geometry lesson Bob learnt that a triangle is called right-angled if it is nondegenerate and one of its angles is right. Bob decided to draw such a triangle immediately: on a sheet of paper he drew three points with integer coordinates, and joined them with segments of straight lines, then he showed the triangle to Peter. Peter said that Bob\'s triangle is not right-angled, but is almost right-angled: the triangle itself is not right-angled, but it is possible to move one of the points exactly by distance 1 so, that all the coordinates remain integer, and the triangle become right-angled. Bob asks you to help him and find out if Peter tricks him. By the given coordinates of the triangle you should find out if it is right-angled, almost right-angled, or neither of these." 1500.0
                                                12B "Correct Solution?" implementation,sortings "One cold winter evening Alice and her older brother Bob was sitting at home near the fireplace and giving each other interesting problems to solve. When it was Alice\'s turn, she told the number n to Bob and said:\xe2\x80\x94Shuffle the digits in this number in order to obtain the smallest possible number without leading zeroes.\xe2\x80\x94No problem! \xe2\x80\x94 said Bob and immediately gave her an answer.Alice said a random number, so she doesn\'t know whether Bob\'s answer is correct. Help her to find this out, because impatient brother is waiting for the verdict." 1100.0
                                                7E "Defining Macros" "dp,expression parsing,implementation" "Most C/C++ programmers know about excellent opportunities that preprocessor #define directives give; but many know as well about the problems that can arise because of their careless use.In this problem we consider the following model of #define constructions (also called macros). Each macro has its name and value. The generic syntax for declaring a macro is the following:#define macro_name macro_valueAfter the macro has been declared, ""macro_name"" is replaced with ""macro_value"" each time it is met in the program (only the whole tokens can be replaced; i.e. ""macro_name"" is replaced only when it is surrounded by spaces or other non-alphabetic symbol). A ""macro_value"" within our model can only be an arithmetic expression consisting of variables, four arithmetic operations, brackets, and also the names of previously declared macros (in this case replacement is performed sequentially). The process of replacing macros with their values is called substitution.One of the main problems arising while using macros \xe2\x80\x94 the situation when as a result of substitution we get an arithmetic expression with the changed order of calculation because of different priorities of the operations.Let\'s consider the following example. Say, we declared such a #define construction:#define sum x + yand further in the program the expression ""2 * sum"" is calculated. After macro substitution is performed we get ""2 * x + y"", instead of intuitively expected ""2 * (x + y)"".Let\'s call the situation ""suspicious"", if after the macro substitution the order of calculation changes, falling outside the bounds of some macro. Thus, your task is to find out by the given set of #define definitions and the given expression if this expression is suspicious or not.Let\'s speak more formally. We should perform an ordinary macros substitution in the given expression. Moreover, we should perform a ""safe"" macros substitution in the expression, putting in brackets each macro value; after this, guided by arithmetic rules of brackets expansion, we can omit some of the brackets. If there exist a way to get an expression, absolutely coinciding with the expression that is the result of an ordinary substitution (character-by-character, but ignoring spaces), then this expression and the macros system are called correct, otherwise \xe2\x80\x94 suspicious.Note that we consider the ""/"" operation as the usual mathematical division, not the integer division like in C/C++. That\'s why, for example, in the expression ""a*(b/c)"" we can omit brackets to get the expression ""a*b/c""." 2600.0
